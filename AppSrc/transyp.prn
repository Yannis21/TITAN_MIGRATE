Compiling Program: C:\Vdf6\Develop\Empor\AppSrc\transyp.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>Use Workspc.pkg
30325>
30325>//  Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>
30341>>>
30341>>>Type PEWindowOptions
30341>>>  Field PEWindowOptions.StructSize As Word
30341>>>  Field PEWindowOptions.hasGroupTree As Word
30341>>>  Field PEWindowOptions.canDrillDown As Word
30341>>>  Field PEWindowOptions.hasNavigationControls As Word
30341>>>  Field PEWindowOptions.hasCancelButton As Word
30341>>>  Field PEWindowOptions.hasPrintButton As Word
30341>>>  Field PEWindowOptions.hasExportButton As Word
30341>>>  Field PEWindowOptions.hasZoomControl As Word
30341>>>  Field PEWindowOptions.hasCloseButton As Word
30341>>>  Field PEWindowOptions.hasProgressControls As Word
30341>>>  Field PEWindowOptions.hasSearchButton As Word
30341>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30341>>>  Field PEWindowOptions.hasRefreshButton As Word
30341>>>End_Type // PEWindowOptions
30341>>>
30341>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30342>>>
30342>>>Class CrystalReportSubSQL Is A CrystalReport
30343>>>
30343>>>    Procedure Construct_Object
30344>>>        Forward send Construct_Object
30346>>>        // Everything on except hasGroupTree by default
30346>>>        property integer hasGroupTree 0
30347>>>        property integer canDrillDown 1
30348>>>        property integer hasNavigationControls 1
30349>>>        property integer hasCancelButton 1
30350>>>        property integer hasPrintButton 1
30351>>>        property integer hasExportButton 1
30352>>>        property integer hasZoomControl 1
30353>>>        property integer hasCloseButton 1
30354>>>        property integer hasProgressControls 1
30355>>>        property integer hasSearchButton 1
30356>>>        property integer hasPrintSetupButton 1
30357>>>        property integer hasRefreshButton 1
30358>>>
30358>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30359>>>    End_Procedure // Construct_Object
30360>>>
30360>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30361>>>        Integer iPrintJob iResult
30362>>>        String sPEWindowOptions
30362>>>        Pointer pPeWindowOptions
30362>>>
30362>>>        Get PrintJob To iPrintJob
30363>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30364>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30365>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30366>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30367>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30368>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30369>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30370>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30371>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30372>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30373>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30374>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30375>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30376>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30377>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30378>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30379>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30381>>>    End_Procedure // OutputToWindow
30382>>>
30382>>>    Procedure Set TmpFileDir String aDir
30383>>>        String lsCurrWspc lsDir
30384>>>
30384>>>//        If (ghoWorkSpace <> 0) Begin
30384>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30384>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30384>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30384>>>//            Set Report_Data_Path to lsDir
30384>>>//        End
30384>>>    End_Procedure
30385>>>
30385>>>    Procedure DoWinQLReport
30386>>>        // This can be used when reports must be able to run in different data directories
30386>>>        Set TmpFileDir to "TmpFileDir"
30387>>>        Forward Send DoWinQLReport
30389>>>    End_Procedure
30390>>>
30390>>>
30390>>>    // This hook procedure is called after the print job has been opened.
30390>>>
30390>>>    Procedure OnInitializeReport000
30391>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30391>>>
30391>>>        Integer iTables iMax iCount iType
30392>>>        String  sLocation sLocation2 sPath DirSep
30392>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30392>>>
30392>>>//        Open Sysfile
30392>>>
30392>>>        String  sActualSQL
30392>>>        String  sActualTemp
30392>>>        String  sOldSQL
30392>>>        String  sOldTemp
30392>>>        String  sServerName
30392>>>        String  sDatabaseName
30392>>>        String  sUserID
30392>>>
30392>>>//        Move Sysfile.ActualSQL      to sActualSQL
30392>>>//        Move Sysfile.ActualTemp     to sActualTemp
30392>>>//        Move Sysfile.OldSQL         to sOldSQL
30392>>>//        Move Sysfile.OldTemp        to sOldTemp
30392>>>//        Move Sysfile.cServerName    to sServerName
30392>>>//        Move Sysfile.cDatabaseName  to sDatabaseName
30392>>>//        Move Sysfile.cUserID        to sUserID
30392>>>
30392>>> //       Move 'SMS'                 to sOldSQL
30392>>> //       Move 'C:\Dns_tmp\'         to sOldTemp
30392>>> //       Move 'SMSMET'        to sActualSQL      // Database
30392>>> //       Move 'C:\Dns_tmp\'         to sActualTemp
30392>>> //      Move 'SMSMET'        to sServerName    // ODBC
30392>>> //       Move 'SMSMET'        to sDatabaseName  // DataBase
30392>>>     //   Move 'sa'               to sUserID
30392>>>
30392>>>        Move 'SMS'                 to sOldSQL
30393>>>        Move 'C:\Dns_tmp\'         to sOldTemp
30394>>>        Move 'SMSTITAN'            to sActualSQL      // Database
30395>>>        Move 'C:\Dns_tmp\'         to sActualTemp
30396>>>        Move 'SMSTITAN'            to sServerName    // ODBC
30397>>>        Move 'SMSTITAN'            to sDatabaseName  // DataBase
30398>>>
30398>>>
30398>>>        Move (Trim(sActualSQL   )) to sActualSQL
30399>>>        Move (Trim(sActualTemp  )) to sActualTemp
30400>>>        Move (Trim(sOldSQL      )) to sOldSQL
30401>>>        Move (Trim(sOldTemp     )) to sOldTemp
30402>>>        Move (Trim(sServerName  )) to sServerName
30403>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30404>>>        Move (Trim(sUserID      )) to sUserID
30405>>>
30405>>>
30405>>>        Forward Send OnInitializeReport
30407>>>
30407>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30408>>>        Get NTables To iMax
30409>>>        Decrement iMax
30410>>>        Get Report_Data_Path                                    To sPath
30411>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30414>>>        For iCount From 0 To iMax
30420>>>>
30420>>>            Get NthTableLocation iCount         To sLocation
30421>>>            Get Report_Base_File_Name sLocation To sLocation2
30422>>>            Get NthTableDBType           iCount to iType
30423>>>
30423>>>            // An einai type 1 topiko
30423>>>            //               2=SQL
30423>>>            If (iType=2) Begin
30425>>>                If (sLocation contains sOldSQL) Begin
30427>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30428>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30429>>>                End
30429>>>>
30429>>>            End
30429>>>>
30429>>>            Else If (iType=1) Begin
30432>>>                If (sLocation contains sOldTemp) Begin
30434>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30435>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30436>>>                End
30436>>>>
30436>>>            End
30436>>>>
30436>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30437>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30438>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30439>>>        Loop // For iCount From 0 To iMax
30440>>>>
30440>>>
30440>>>    End_Procedure // OnInitializeReport
30441>>>
30441>>>
30441>>>//                Showln '--------------------------------------------------------'
30441>>>//                Showln iCount
30441>>>//                Showln sLocation
30441>>>//                Showln sPath
30441>>>//                Showln sLocation2
30441>>>//                Showln iType
30441>>>
30441>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30441>>>                  //Set Report_Data_Path to ''
30441>>>                  //Get NthTableDBType              iCount to iType
30441>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30441>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30441>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30441>>>                  //Get NthTableLocation iCount                 To sMyLocation
30441>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30441>>>                  //Showln sMyLocation
30441>>>                  //Set NthTableLocation            iCount To sMyLocation
30441>>>                //End
30441>>>
30441>>>
30441>>>
30441>>>    // This hook procedure is called just before a print job is closed.
30441>>>    Procedure OnDeInitializeReport
30442>>>        Forward Send OnDEInitializeReport
30444>>>    End_Procedure // OnDeInitializeReport
30445>>>
30445>>>    // This hook procedure is called just before a the print job is started.
30445>>>    Procedure OnStartPrinting
30446>>>        Forward Send OnStartPrinting
30448>>>    End_Procedure // OnStartPrinting
30449>>>
30449>>>    // This hook procedure is called just after a print job has finished.
30449>>>    Procedure OnStopPrinting
30450>>>        Forward Send OnStopPrinting
30452>>>    End_Procedure // OnStopPrinting
30453>>>
30453>>>
30453>>>End_Class // CrystalReportSubSQL
30454>>>
30454>Integer giWait_Obj
30454>
30454>// General Functions-Procedures and Variables
30454>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30454>>>
30454>>>        String  gs_Selected_Company_Code
30454>>>        String  gs_Selected_Branch_Code
30454>>>        Integer gi_Selected_Year
30454>>>        String gs_Selected_Year_Recr
30454>>>        String  gs_Module_Code
30454>>>
30454>>>
30454>>>//Open Currency
30454>>>//Function CurrDigits Global String asCurr Returns Integer
30454>>>//    Integer liDecX
30454>>>//    Clear Currency
30454>>>//    move asCurr to Currency.Currency_C_Code
30454>>>//    Find Eq Currency By Index.1
30454>>>//    move Currency.Currency_Dec to liDecX
30454>>>//    Function_Return liDecX
30454>>>//End_Function // CurrDigits
30454>>>
30454>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30456>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30458>>>
30458>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30459>>>    Move (Trim(asNomisma)) to asNomisma
30460>>>    Clear Nomisma
30461>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30464>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30466>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30467>>>>
30467>>>    Function_Return Nomisma.Dekadika
30468>>>End_Function //
30469>>>
30469>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30470>>>    String rVal
30471>>>    Integer iLength iInt
30471>>>    Move aiCode to rVal
30472>>>    Move (trim(rVal)) to rVal
30473>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30479>>>>
30479>>>        Move (Insert('0',rVal,1)) to rVal
30480>>>    Loop
30481>>>>
30481>>>    Function_Return rVal
30482>>>End_Function
30483>>>
30483>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30484>>>    String rVal
30485>>>    Integer iLength iInt ipos
30485>>>    Move aiCode to rVal
30486>>>    Move (trim(rVal)) to rVal
30487>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30488>>>    For iInt From 1 to ipos
30494>>>>
30494>>>        Move (Insert('0',rVal,1)) to rVal
30495>>>    Loop
30496>>>>
30496>>>    Function_Return rVal
30497>>>End_Function
30498>>>
30498>>>
30498>>>Open Year
INCLUDING FILE: YEAR.FD
30500>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30501>>>    Send aiMsg to Self
30502>>>End_Procedure
30503>>>
30503>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30504>>>    Integer liChanged
30505>>>
30505>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30508>>>    If (Not(Current_Record(aiYearDD))) Begin
30510>>>        Get Should_Save of aiPanel to liChanged
30511>>>        Send Clear to aiYearDD
30512>>>        Move gs_Selected_Company_Code to Year.Company_Code
30513>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30514>>>        Move gi_Selected_Year         to Year.Year_Year
30515>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30516>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30519>>>    End
30519>>>>
30519>>>End_Procedure
30520>>>
30520>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30521>>>    Integer liSrvr
30522>>>    String  lsCurrentYearRecr
30522>>>
30522>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30524>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30526>>>    End
30526>>>>
30526>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30527>>>    Get Server of aiPanel to liSrvr
30528>>>    // Respects Default values
30528>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30533>>>End_Procedure
30534>>>
30534>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30534>>>//                                                          Holds the current year rec0
30534>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30534>>>
30534>>>
30534>>>Function fiRefindYear Global Returns Integer
30535>>>    Clear Year
30536>>>    Move gs_Selected_Company_Code to Year.Company_Code
30537>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30538>>>    Move gi_Selected_Year         to Year.Year_Year
30539>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30540>>>>
30540>>>    Function_Return (Found = 0)
30541>>>End_Function //fiRefindYear
30542>>>
30542>>>Procedure DoRunApplication for Baseclass String sAppName
30543>>>    string sRuntime  lsStr
30544>>>
30544>>>    Append lsStr 'C:\Dns.bat ' sAppName
30546>>>    RunProgram Wait  lsStr
30547>>>
30547>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30547>>>//    append sRuntime "\dfrun " sAppName
30547>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30549>>>    runprogram background sRuntime
30550>>>End_procedure // DoRunApplication
30551>>>
30551>>>// Run the Editor
30551>>>Procedure DoRunEditor for Baseclass String asFile
30552>>>    string sRunPath lsWspcName
30553>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30554>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30557>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30557>>>    Move (Replace('.',asFile,'')) to asFile
30558>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30559>>>    send DoRunApplication sRunPath
30560>>>End_Procedure // DoRunEditor
30561>>>
30561>>>//--------------------------------------
30561>>>
30561>>>//start of global functions and procedures
30561>>>
30561>>>
30561>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30561>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30562>>>         String  lsTemp_Code1 lsTemp_Code2
30563>>>         Integer liCounter
30563>>>
30563>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30563>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30564>>>
30564>>>         //2.˜¤« ©«¨¦­ã
30564>>>         For liCounter From 1 to (Length(lsCode))
30570>>>>
30570>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30571>>>         Loop
30572>>>>
30572>>>
30572>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30572>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30573>>>
30573>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30573>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30574>>>
30574>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30574>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30580>>>>
30580>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30581>>>         Loop
30582>>>>
30582>>>
30582>>>         Function_Return (Trim(lsTemp_Code2))
30583>>>End_Function //gsffind_previous
30584>>>
30584>>>
30584>>>Function gifSystem_Check Returns Integer
30585>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30586>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30586>>>//       Clear Company
30586>>>//       Find Gt Company.Recnum
30586>>>//       While (Found = 1)
30586>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30586>>>//             Add Company.Company_NumGarticl to liS_Garticls
30586>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30586>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30586>>>//             Add Company.Company_NumGplan   to liS_GPlans
30586>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30586>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30586>>>//             Find Gt Company.Recnum
30586>>>//       Loop
30586>>>//
30586>>>//       Get_Attribute {attribute} [of {file-handle} ;
30586>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30586>>>//                        To {variable}
30586>>>//
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30586>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30586>>>//
30586>>>
30586>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30586>>>
30586>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30586>>>
30586>>>    Function_Return 0
30587>>>End_Function //gifSystem_Check
30588>>>
30588>>>/////////////////////////////////////////////////////////////////
30588>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30588>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30589>>>
30589>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30590>>>    Integer liInt liInteger iTimes iStart
30590>>>    Number  lnDecimals
30590>>>
30590>>>    Move (Integer(anValue))                                         to liInteger
30591>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30592>>>
30592>>>    Move liInteger              to lsAkeraios
30593>>>    Move lnDecimals             to lsDekadika
30594>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30595>>>    Move (Trim(lsDekadika))     to lsDekadika
30596>>>
30596>>>    Move (Length(lsAkeraios)) to iStart
30597>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30603>>>>
30603>>>        Insert "0" in lsAkeraios at 1
30605>>>    Loop
30606>>>>
30606>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30607>>>
30607>>>    Move (Length(lsDekadika)) to iStart
30608>>>    For iTimes From iStart to (aiLengthDekadika-1)
30614>>>>
30614>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30615>>>    Loop
30616>>>>
30616>>>    Move (Trim(lsDekadika)) to lsDekadika
30617>>>
30617>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30620>>>    Move '' to lsRetVal
30621>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30622>>>    Function_Return lsRetval
30623>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30624>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30624>>>
30624>>>Open Codemast
30626>>>
30626>>>
30626>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30627>>>         Clear Codemast
30628>>>         Move lsType  to Codemast.Type
30629>>>         Move lsValue to Codemast.Code
30630>>>         Find Eq Codemast by Index.1 //type+code
30631>>>>
30631>>>         Function_Return Codemast.Description
30632>>>End_Function //code_mast
30633>>>
30633>>>
30633>>>Open Branch
INCLUDING FILE: BRANCH.FD
30635>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30636>>>    String rVal
30637>>>    Integer iInt
30637>>>    Clear Branch
30638>>>    Move asCompany  to Branch.Company_Code
30639>>>    Move asBranch   to Branch.Branch_Code
30640>>>    Find Eq Branch by Index.1
30641>>>>
30641>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30644>>>    Move (Trim(asCompany))  to asCompany
30645>>>    Move (Trim(asBranch))   to asBranch
30646>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30650>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30654>>>    Move ''                                           to rVal
30655>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30656>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30657>>>    Move (Trim(rVal))                                 to rVal
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>Function fsgStripCodeFromID Global String asID Returns Integer
30661>>>      Integer iLen iPos iInt
30662>>>      If (Trim(asID)='') Function_Return 0
30665>>>      Move (Trim  (asID)) to asID
30666>>>      Move (Length(asID)) to iLen
30667>>>      For iInt From 1     to iLen
30673>>>>
30673>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30676>>>      Loop
30677>>>>
30677>>>      Function_Return (Right(asID,(iLen-iPos)))
30678>>>End_Function
30679>>>
30679>>>Function fsCityDescr Global Integer aiCityID Returns String
30680>>>    String rVal
30681>>>    Open Cities
INCLUDING FILE: CITIES.FD
30683>>>    Clear Cities
30684>>>    Move aiCityID to Cities.City_ID
30685>>>    Find Eq Cities By Index.1
30686>>>>
30686>>>    If (Found=1) Move Cities.City_descr to rVal
30689>>>    Else         Move '' to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30694>>>    Open Cities
30696>>>    Clear Cities
30697>>>    Move aiCityID to Cities.City_ID
30698>>>    Find Eq Cities By Index.1
30699>>>>
30699>>>    Function_Return Cities.Town_ID
30700>>>End_Function
30701>>>
30701>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30702>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30704>>>    Clear Towns
30705>>>    Move aiTownID to Towns.Town_ID
30706>>>    Find Eq Towns By Index.1
30707>>>>
30707>>>    Function_Return Towns.Country_ID
30708>>>End_Function
30709>>>
30709>>>Function fsTownDescr Global Integer aiTownID Returns String
30710>>>    String rVal
30711>>>    Open Towns
30713>>>    Clear Towns
30714>>>    Move aiTownID to Towns.Town_ID
30715>>>    Find Eq Towns By Index.1
30716>>>>
30716>>>    If (Found=1) Move Towns.Town_descr to rVal
30719>>>    Else         Move '' to rVal
30721>>>    Function_Return rVal
30722>>>End_Function
30723>>>
30723>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30724>>>    String rVal
30725>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30727>>>    Clear Country
30728>>>    Move aiCountryID to Country.Country_ID
30729>>>    Find Eq Country By Index.1
30730>>>>
30730>>>    If (Found=1) Move Country.Country_descr to rVal
30733>>>    Else         Move '' to rVal
30735>>>    Function_Return rVal
30736>>>End_Function
30737>>>
30737>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30738>>>    String rVal
30739>>>    Open Areas
INCLUDING FILE: AREAS.FD
30741>>>    Clear Areas
30742>>>    Move aiAreaID to Areas.Area_ID
30743>>>    Find Eq Areas By Index.1
30744>>>>
30744>>>    If (Found=1) Move Areas.Area_descr to rVal
30747>>>    Else         Move '' to rVal
30749>>>    Function_Return rVal
30750>>>End_Function
30751>>>
30751>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30752>>>    Local String rVal lsTmp lsOO lsLL
30753>>>    Local Number lnOO lnLL
30753>>>
30753>>>    Move '' to lsOO
30754>>>    Move '' to lsLL
30755>>>    Move '' to rVal
30756>>>
30756>>>    Move (Integer(anTime))                              to lnOO
30757>>>
30757>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30758>>>
30758>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30761>>>    Else         Move (String(lnOO))                    to lsOO
30763>>>    Move (Trim(lsOO))                                   to lsOO
30764>>>
30764>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30767>>>    Else         Move (String(lnLL))                    to lsLL
30769>>>    Move (Trim(lsLL))                                   to lsLL
30770>>>
30770>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30771>>>
30771>>>    Move (Trim(rVal)) to rVal
30772>>>
30772>>>    Function_Return rVal
30773>>>End_Function
30774>>>
30774>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30775>>>    Local Number rVal nOres nLepta
30776>>>    Move (Integer(aiMinutes/60))    to nOres
30777>>>    Move (    Mod(aiMinutes,60))    to nLepta
30778>>>    Move (nOres+(nLepta/100))       to rVal
30779>>>    Function_Return rVal
30780>>>End_Function
30781>>>
30781>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30782>>>    Local Integer rVal
30783>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30784>>>    Function_Return rVal
30785>>>End_Function
30786>>>
30786>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30787>>>    Local Integer rVal iMinStart iMinEnd
30788>>>
30788>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30791>>>
30791>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30792>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30793>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30794>>>    Function_Return rVal
30795>>>End_Function
30796>>>
30796>>>
30796>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30797>>>    Local Integer iTmp
30798>>>    Local Number  rVal
30798>>>
30798>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30801>>>
30801>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30802>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30803>>>    Function_Return rVal
30804>>>End_Function
30805>>>
30805>>>
30805>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30807>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30809>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30811>>>
30811>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30812>>>  Integer iExodos
30813>>>  Number nPoso nPct
30813>>>  Move 0 to nPoso
30814>>>  Move 0 to nPct
30815>>>  Move 0 to iExodos
30816>>>
30816>>>  Move (Trim(asItemCode)) to asItemCode
30817>>>  Move (Trim(asPromCode)) to asPromCode
30818>>>
30818>>>  // 1.Anazhthsh sto arxeio Witemcld
30818>>>  Clear Witemcld
30819>>>  Move asItemCode to Witemcld.Item_Code
30820>>>  Move asPromCode to Witemcld.Client_Code
30821>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30822>>>>
30822>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30826>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30828>>>          Move 1 to iExodos
30829>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30832>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30836>>>      End
30836>>>>
30836>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30837>>>>
30837>>>  Loop
30838>>>>
30838>>>  If (iExodos) Begin
30840>>>      If (nPoso) Function_Return nPoso
30843>>>      Else Function_Return nPct
30845>>>  End
30845>>>>
30845>>>
30845>>>  // 2.Anazhthsh sto arxeio Witemcl
30845>>>  Clear WitemCL
30846>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30847>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30848>>>  Find Eq WitemCL By Index.1
30849>>>>
30849>>>  If (Found=1) Function_Return WitemCL.Client_Price
30852>>>
30852>>>  Function_Return 0
30853>>>End_Function
30854>>>
30854>>>
30854>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30856>>>
30856>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30857>>>
30857>>>  Integer iExodos iCheckDeop
30858>>>  Number nPoso nPct
30858>>>
30858>>>  Move (Num_Arguments=7) to iCheckDeop
30859>>>
30859>>>  Move 0 to nPoso
30860>>>  Move 0 to nPct
30861>>>  Move 0 to iExodos
30862>>>
30862>>>  Move (Trim(asItemCode))                 to asItemCode
30863>>>  Move (Trim(asClientID))                 to asClientID
30864>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30865>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30866>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30869>>>
30869>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30869>>>  If (iCheckDeop) Begin
30871>>>      Clear btnordd
30872>>>      Move asClientID   to btnordd.vclient_id
30873>>>      Move asCNCode     to btnordd.vcn_code
30874>>>      Move asWitemxCode to btnordd.vitem
30875>>>      Move 0            to btnordd.vactive
30876>>>      Move adHmnia      to btnordd.arxh_date
30877>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30878>>>>
30878>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30880>>>          move btnordd.vprice to nPoso
30881>>>          If (nPoso) Function_Return nPoso
30884>>>      End
30884>>>>
30884>>>  End
30884>>>>
30884>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
30884>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30884>>> // Clear Witemcld
30884>>> // Move asItemCode to Witemcld.Item_Code
30884>>> // Move asClientID to Witemcld.Client_Code
30884>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
30884>>> //                      (Witemcld.Client_Code= asClientID) And ;
30884>>> //                      (iExodos=0))
30884>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30884>>> //         Move 1 to iExodos
30884>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30884>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30884>>> //     End
30884>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // Loop
30884>>> // If (iExodos) Begin
30884>>> //     If (nPoso) Function_Return nPoso
30884>>> //     Else Function_Return nPct
30884>>> // End
30884>>>
30884>>>
30884>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30884>>>  //Clear Witemxt
30884>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
30884>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30884>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
30884>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
30884>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
30884>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
30884>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
30884>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
30884>>>  //                     (iExodos=0))
30884>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30884>>>  //        Move 1 to iExodos
30884>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30884>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30884>>>  //    End
30884>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //Loop
30884>>>  //If (iExodos) Begin
30884>>>  //    If (nPoso) Function_Return nPoso
30884>>>  //    Else Function_Return nPct
30884>>>  //End
30884>>>
30884>>>
30884>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30884>>>  //Clear WitemCL
30884>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
30884>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
30884>>>  //Find Eq WitemCL By Index.1
30884>>>  //If (Found=1) Function_Return WitemCL.Client_Price
30884>>>
30884>>>  Function_Return 0
30885>>>End_Function
30886>>>
30886>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30887>>>    String sEnter
30888>>>    Move '' to sEnter
30889>>>    Move (Trim(asStr)) to asStr
30890>>>    Append sEnter (Character(13)) (Character(10))
30892>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30893>>>    Function_return (Trim(asStr))
30894>>>End_function
30895>>>
30895>>>
30895>>>//end   of global functions and procedures
30895>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30895>>>>>USE AllEntSc
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>Object Wait is a ModalPanelSub
30897>>>>>
30897>>>>>    //AB-StoreTopStart
30897>>>>>
30897>>>>>    // How to Use It
30897>>>>>    // Get the maximum position of the bar
30897>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30897>>>>>    //
30897>>>>>    // Set the maximum position of the bar
30897>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30897>>>>>    //
30897>>>>>    // Start Bar Progress from beginning
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30897>>>>>    //
30897>>>>>    // End Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30897>>>>>    //
30897>>>>>    // Update Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30897>>>>>    // When you want the update to be done for every i (this is slower)
30897>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30897>>>>>    //
30897>>>>>    // Display Buttons on the object
30897>>>>>    // Set Button_State of (Wait(Self)) to False/True
30897>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30897>>>>>    //
30897>>>>>    // Initialization of the Progress Bar
30897>>>>>    // Send Popup to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Deactivation of the Progress Bar
30897>>>>>    // Send Deactivate to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Message during the process
30897>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30897>>>>>    //
30897>>>>>    // Extra Info for button "Info >>"
30897>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30897>>>>>    // If sFile<>'' then reads the contents of the file
30897>>>>>    // Else Fills the Edit with the string of sDetail
30897>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30897>>>>>    //
30897>>>>>    // Remarks instead of Progress Bar
30897>>>>>    // Set Button_State of (Wait(Self))     to False
30897>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30897>>>>>    // Update During Process
30897>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30897>>>>>
30897>>>>>    //AB-StoreTopEnd
30897>>>>>
30897>>>>>    Set Exit_Application_Local_State to FALSE
30898>>>>>    Set Modal_State to FALSE
30899>>>>>    Set Popup_State to TRUE
30900>>>>>    Set Border_Style to Border_Thick
30901>>>>>    Set Minimize_Icon to FALSE
30902>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30903>>>>>    Set Size to 138 256
30904>>>>>
30904>>>>>    //AB-DDOStart
30904>>>>>
30904>>>>>
30904>>>>>    //AB-DDOEnd
30904>>>>>
30904>>>>>    Object WaitBar is a ProgressBarSub
30906>>>>>
30906>>>>>        //AB-StoreTopStart
30906>>>>>
30906>>>>>        //AB-StoreTopEnd
30906>>>>>
30906>>>>>        Set Size to 21 243
30907>>>>>        Set Location to 7 4
30908>>>>>
30908>>>>>        //AB-StoreStart
30908>>>>>        Send DoRegSize  self smTopRight
30909>>>>>        //AB-StoreEnd
30909>>>>>
30909>>>>>    End_Object
30910>>>>>
30910>>>>>    Object WaitText is a TextBoxSub
30912>>>>>
30912>>>>>        //AB-StoreTopStart
30912>>>>>
30912>>>>>        //AB-StoreTopEnd
30912>>>>>
30912>>>>>        Set Enabled_State to TRUE
30913>>>>>        Set Label to "Processing"
30914>>>>>        Set FontSize to 4 0
30915>>>>>        Set Size to 10 81
30916>>>>>        Set Location to 36 5
30917>>>>>
30917>>>>>        //AB-StoreStart
30917>>>>>
30917>>>>>        //AB-StoreEnd
30917>>>>>
30917>>>>>    End_Object
30918>>>>>
30918>>>>>    Object bnCancel is a ButtonSub
30920>>>>>
30920>>>>>        //AB-StoreTopStart
30920>>>>>
30920>>>>>        //AB-StoreTopEnd
30920>>>>>
30920>>>>>        Set Default_State to TRUE
30921>>>>>        Set Label to "OK"
30922>>>>>        Set Location to 34 143
30923>>>>>
30923>>>>>        //AB-StoreStart
30923>>>>>
30923>>>>>        Procedure OnClick
30925>>>>>             Send Deactivate to (Wait(Self))
30926>>>>>        End_Procedure
30927>>>>>
30927>>>>>        Send DoRegAlign self amTopRight
30928>>>>>        //AB-StoreEnd
30928>>>>>
30928>>>>>    End_Object
30929>>>>>
30929>>>>>    Object bnDetail is a ButtonSub
30931>>>>>
30931>>>>>        //AB-StoreTopStart
30931>>>>>
30931>>>>>        //AB-StoreTopEnd
30931>>>>>
30931>>>>>        Set Focus_Mode to Pointer_Only
30932>>>>>        Set Label to "Info >>"
30933>>>>>        Set Location to 34 197
30934>>>>>
30934>>>>>        //AB-StoreStart
30934>>>>>
30934>>>>>        Procedure OnClick
30936>>>>>            Delegate Send Show_Details False
30938>>>>>        End_Procedure
30939>>>>>
30939>>>>>        Send DoRegAlign self amTopRight
30940>>>>>        //AB-StoreEnd
30940>>>>>
30940>>>>>    End_Object
30941>>>>>
30941>>>>>    Object LineControlSub1 is a LineControlSub
30943>>>>>
30943>>>>>        //AB-StoreTopStart
30943>>>>>
30943>>>>>        //AB-StoreTopEnd
30943>>>>>
30943>>>>>        Set Size to 2 243
30944>>>>>        Set Location to 54 4
30945>>>>>
30945>>>>>        //AB-StoreStart
30945>>>>>
30945>>>>>        Send DoRegSize  self smTopRight
30946>>>>>        //AB-StoreEnd
30946>>>>>
30946>>>>>    End_Object
30947>>>>>
30947>>>>>    Object WaitEdit is a editSub
30949>>>>>
30949>>>>>        //AB-StoreTopStart
30949>>>>>
30949>>>>>        //AB-StoreTopEnd
30949>>>>>
30949>>>>>        Set Enabled_State to FALSE
30950>>>>>        Set Read_Only_State to TRUE
30951>>>>>        Set Size to 58 243
30952>>>>>        Set Location to 60 4
30953>>>>>        Set Color to clWhite
30954>>>>>
30954>>>>>        //AB-StoreStart
30954>>>>>
30954>>>>>        Send DoRegSize Self amBottomRight
30955>>>>>        Delegate Set Size to 66 256
30957>>>>>
30957>>>>>        //AB-StoreEnd
30957>>>>>
30957>>>>>    End_Object
30958>>>>>
30958>>>>>    Object oTxtAntiBar is a TextBoxSub
30960>>>>>        Set Enabled_State to TRUE
30961>>>>>        Set Visible_State to FALSE
30962>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30963>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30964>>>>>        Set Auto_Size_State to FALSE
30965>>>>>        Set FontWeight to 600
30966>>>>>        Set FontSize to 4 0
30967>>>>>        Set Size to 10 209
30968>>>>>        Set Location to 10 4
30969>>>>>        Set TextColor to clNavy
30970>>>>>    End_Object
30971>>>>>
30971>>>>>
30971>>>>>    //AB-StoreStart
30971>>>>>    Property Integer piWaitSize  Public (Size(Self))
30973>>>>>    Property Integer piPrevSize  Public (Size(Self))
30975>>>>>    Property Integer piState     Public False
30977>>>>>
30977>>>>>    Set Locate_Mode to Center_On_Screen
30978>>>>>    Set Destroy_Object_State to True
30979>>>>>
30979>>>>>    Procedure Show_Details Integer bAlways
30981>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30982>>>>>        Local String sLabel
30982>>>>>        Get Size                to liSize
30983>>>>>        Get piState             to bState
30984>>>>>        Get piWaitSize          to liOriSize
30985>>>>>        Move (Hi(liSize))       to hiSize
30986>>>>>        Move (Low(liSize))      to lowSize
30987>>>>>        Move (Hi(liOriSize))    to hiOriSize
30988>>>>>        If (bAlways) Begin
30990>>>>>            Set piState         to False
30991>>>>>            Move 0              to bState
30992>>>>>        End
30992>>>>>>
30992>>>>>        If bState Begin
30994>>>>>             Set Size to hiOriSize lowSize
30995>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30996>>>>>        End
30996>>>>>>
30996>>>>>        Else Begin
30997>>>>>             Set Size to 138 lowSize
30998>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30999>>>>>        End
30999>>>>>>
30999>>>>>        Set piState to (1-bState)
31000>>>>>    End_Procedure
31001>>>>>
31001>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31003>>>>>       If (bState) Begin
31005>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31008>>>>>       End
31008>>>>>>
31008>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31010>>>>>    End_Procedure
31011>>>>>
31011>>>>>    Procedure DoInitialize_WaitBar
31013>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31014>>>>>    End_Procedure
31015>>>>>
31015>>>>>    Procedure DoTerminate_WaitBar
31017>>>>>        Local Integer iMax
31018>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31019>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31020>>>>>    End_Procedure
31021>>>>>
31021>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31023>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31024>>>>>    End_Procedure
31025>>>>>
31025>>>>>    Function Bar_Maximum_Position Returns Integer
31027>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31028>>>>>    End_Function
31029>>>>>
31029>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31031>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31032>>>>>    End_Procedure
31033>>>>>
31033>>>>>    Function Bar_Minimum_Position Returns Integer
31035>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31036>>>>>    End_Function
31037>>>>>
31037>>>>>    Procedure Set Bar_Step_Value Integer iStep
31039>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31040>>>>>    End_Procedure
31041>>>>>
31041>>>>>    Function Bar_Step_Value Returns Integer
31043>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31044>>>>>    End_Function
31045>>>>>
31045>>>>>    Procedure Set Wait_Message String sMessage
31047>>>>>        Set Value of (WaitText(Self)) to sMessage
31048>>>>>    End_Procedure
31049>>>>>
31049>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31051>>>>>        Local Integer liEditId
31052>>>>>        Move (WaitEdit(Self)) to liEditId
31053>>>>>        If bInitData Send Delete_Data to liEditId
31056>>>>>        If sFile ne "" Begin
31058>>>>>           Send Read to liEditId sFile
31059>>>>>           Send Beginning_Of_Data to liEditId
31060>>>>>        End
31060>>>>>>
31060>>>>>        Else Begin
31061>>>>>           Send Insert to liEditId sDetail
31062>>>>>        End
31062>>>>>>
31062>>>>>    End_Procedure
31063>>>>>
31063>>>>>    Procedure OnResize
31065>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31066>>>>>        Get Size to liPrevSize
31067>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31068>>>>>        Forward Send OnResize
31070>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31071>>>>>        Move (Hi(liLoc)) to liHiLoc
31072>>>>>        Get piState to bState
31073>>>>>        Get Size to liSize
31074>>>>>        Move (Hi(liSize)) to liHiSize
31075>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31077>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31078>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31081>>>>>        End
31081>>>>>>
31081>>>>>        Else Begin
31082>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31083>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31086>>>>>        End
31086>>>>>>
31086>>>>>    End_Procedure
31087>>>>>
31087>>>>>    Procedure Set Button_State Integer bState
31089>>>>>        If bState Begin
31091>>>>>            Set Caption_Bar to True
31092>>>>>            Set Size to 66 256
31093>>>>>        End
31093>>>>>>
31093>>>>>        Else Begin
31094>>>>>            Set Caption_Bar to False
31095>>>>>            Set Size to 38 256
31096>>>>>        End
31096>>>>>>
31096>>>>>    End_Procedure
31097>>>>>
31097>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31099>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31100>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31101>>>>>        If (bState = 0) Begin
31103>>>>>            Set Size to 24 256
31104>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31105>>>>>        End
31105>>>>>>
31105>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31108>>>>>    End_Procedure
31109>>>>>
31109>>>>>    Procedure Deactivating integer search_mode Returns Integer
31111>>>>>        local integer rval
31112>>>>>        Forward Get MSG_Deactivating search_mode to rval
31114>>>>>        Set Modal_State of (Wait(Self)) to False
31115>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31116>>>>>        Procedure_Return rval
31117>>>>>    End_Procedure
31118>>>>>
31118>>>>>    Procedure UpdateWait String sMsg
31120>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31121>>>>>    End_Procedure
31122>>>>>
31122>>>>>
31122>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31124>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31125>>>>>    End_Procedure
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>    //AB-StoreEnd
31126>>>>>
31126>>>>>End_Object
31127>>>>>
31127>>>>>
31127>>>>>//AB-StoreStart
31127>>>>>
31127>>>>>//AB-StoreEnd
31127>>>>>
31127>>>>>//AB/ End_Object    // prj
31127>>>
31127>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31127>>>//AB/ Project Calendar
31127>>>//AB/ Object prj is a Lookup_Project
31127>>>//AB/     Set ProjectName to "Calendar"
31127>>>//AB/     Set ProjectFileName to "Calendar.sl"
31127>>>
31127>>>// Project Object Structure
31127>>>//   oCalendar is a dbModalPanel
31127>>>//     Container3d1 is a Container3d
31127>>>//       Grid2 is a Grid
31127>>>//       Textbox2 is a Textbox
31127>>>//       Textbox3 is a Textbox
31127>>>//       Textbox4 is a Textbox
31127>>>//       Textbox5 is a Textbox
31127>>>//       Textbox6 is a Textbox
31127>>>//       Textbox7 is a Textbox
31127>>>//       Textbox8 is a Textbox
31127>>>//       LineControl1 is a LineControl
31127>>>//       Container3d2 is a Container3d
31127>>>//         oRght is a BitmapContainer
31127>>>//         oLeft is a BitmapContainer
31127>>>//         oMonth is a Textbox
31127>>>//           oSelectMonth is a FloatingPopupMenu
31127>>>//         oYear is a Textbox
31127>>>//         oSelectYear is a Form
31127>>>//     BitmapContainer3 is a BitmapContainer
31127>>>//     oToday is a Textbox
31127>>>
31127>>>// Register all objects
31127>>>Register_Object BitmapContainer3
31127>>>Register_Object Container3d1
31127>>>Register_Object Container3d2
31127>>>Register_Object Grid2
31127>>>Register_Object LineControl1
31127>>>Register_Object oCalendar
31127>>>Register_Object oLeft
31127>>>Register_Object oMonth
31127>>>Register_Object oRght
31127>>>Register_Object oSelectMonth
31127>>>Register_Object oSelectYear
31127>>>Register_Object oToday
31127>>>Register_Object oYear
31127>>>Register_Object Textbox2
31127>>>Register_Object Textbox3
31127>>>Register_Object Textbox4
31127>>>Register_Object Textbox5
31127>>>Register_Object Textbox6
31127>>>Register_Object Textbox7
31127>>>Register_Object Textbox8
31127>>>
31127>>>
31127>>>
31127>>>//AB-StoreTopStart
31127>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31127>>>>>// **********************************************************************
31127>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31127>>>>>//
31127>>>>>// by Sture Andersen (sa1@vd.dk)
31127>>>>>//
31127>>>>>// The file contains a number of global functions for manipulating
31127>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31127>>>>>// This package is public domain.
31127>>>>>//
31127>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31127>>>>>// listing the functions and their use.
31127>>>>>//
31127>>>>>//
31127>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31127>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31127>>>>>//                         - Addition of popup_calendar to VDF.
31127>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31127>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31127>>>>>//         Thu  10-07-1997 - Fixes.
31127>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31127>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31127>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31127>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31127>>>>>//                           ItemSysdate added.
31127>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31127>>>>>//                           FieldSysdate added.
31127>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31127>>>>>//                           Module_Compile_Time added.
31127>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31127>>>>>//                           responds if entry_state of the calling object
31127>>>>>//                           is true (VDF version). (No apparent effect)
31127>>>>>//         Sat  28-03-1998 - Added the following functions:
31127>>>>>//                             TS_SysTime      TS_ExtractDate
31127>>>>>//                             TS_ExtractTime  TS_ConvertToString
31127>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31127>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31127>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31127>>>>>//                           Module_Start_Time added.
31127>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31127>>>>>//         Mon  12-10-1998 - Portuguese added
31127>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31127>>>>>//         Tue  29-12-1998 - Function DateAsString added
31127>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson
31127>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson (again)
31127>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31127>>>>>//                           class (Continue->TS_Continue and Pause->
31127>>>>>//                           TS_Pause)
31127>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31127>>>>>//                           added.
31127>>>>>//                         - Procedures DateCurrentSeparator and
31127>>>>>//                           DateCurrentFormat added.
31127>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31127>>>>>//                           Jan1st1000 and Jan1st100
31127>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31127>>>>>//                           to trap 3 digit years.
31127>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31127>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31127>>>>>//                         - Fixed error in TS_ConvertToString
31127>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31127>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31127>>>>>//                           from the calendar to forms with no form_margin.
31127>>>>>//         Tue  07-09-1999 - Added function DateAsText
31127>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31127>>>>>//                           in combination with y2k.
31127>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31127>>>>>//                         - Existing function DateAsString renamed to
31127>>>>>//                           DateToString.
31127>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31127>>>>>//                           would result in seeding the calendar on year 100.
31127>>>>>//                           This error was caused by the fact that VDF 4
31127>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31127>>>>>//                           command returns 03-01-100
31127>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31127>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31127>>>>>//
31127>>>>>// NOTE:  There is language dependent string constants in this file.
31127>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31127>>>>>//        norwegian, spanish, german and portuguese
31127>>>>>//
31127>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31127>>>>>//
31127>>>>>// ***********************************************************************
31127>>>>>
31127>>>>>Use ui
31127>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31127>>>>>>>// Use Language     // Default language setup
31127>>>>>>>// Sets default languange if not set by compiler command line
31127>>>>>>>
31127>>>>>>>define lng_dutch      for 131
31127>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_spanish    for 134
31127>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_english    for 144
31127>>>>>>>define lng_danish     for 145
31127>>>>>>>define lng_swedish    for 146
31127>>>>>>>define lng_norwegian  for 147
31127>>>>>>>define lng_Greek    for 148
31127>>>>>>>define lng_german     for 149
31127>>>>>>>define lng_portuguese for 155
31127>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>define lng_default for !@
31127>>>>>>>
31127>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31127>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31127>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31127>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31127>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31127>>>>>>>
31127>>>>>>>//  FOR_EX (extended FOR command)
31127>>>>>>>//  -----------------------------
31127>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31127>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31127>>>>>>>//> you need to do a decremental loop.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>//  DESKTOP_SECTION
31127>>>>>>>//  ---------------
31127>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31127>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31127>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>
31127>>>>>
31127>>>>>// Switches
31127>>>>>
31127>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31127>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31127>>>>>
31127>>>>> define t.calendar.year           for "Year"
31127>>>>> define t.calendar.month          for "Month"
31127>>>>> define t.calendar.day            for "Day"
31127>>>>> define t.calendar.week           for "Wk."
31127>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31127>>>>> define t.calendar.Monday         for "Monday"
31127>>>>> define t.calendar.Tuesday        for "Tuesday"
31127>>>>> define t.calendar.Wednesday      for "Wednesday"
31127>>>>> define t.calendar.Thursday       for "Thursday"
31127>>>>> define t.calendar.Friday         for "Friday"
31127>>>>> define t.calendar.Saturday       for "Saturday"
31127>>>>> define t.calendar.Sunday         for "Sunday"
31127>>>>> define t.calendar.January        for "January"
31127>>>>> define t.calendar.February       for "February"
31127>>>>> define t.calendar.March          for "March"
31127>>>>> define t.calendar.April          for "April"
31127>>>>> define t.calendar.May            for "May"
31127>>>>> define t.calendar.June           for "June"
31127>>>>> define t.calendar.July           for "July"
31127>>>>> define t.calendar.August         for "August"
31127>>>>> define t.calendar.September      for "September"
31127>>>>> define t.calendar.October        for "October"
31127>>>>> define t.calendar.November       for "November"
31127>>>>> define t.calendar.December       for "December"
31127>>>>> define t.calendar.ok             for "OK"
31127>>>>> define t.calendar.Cancel         for "Cancel"
31127>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31127>>>>>
31127>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31127>>>>>define Jan1st1900          for 693975
31127>>>>>define Jan1st2000          for 730500
31127>>>>>define Jan1st1000          for 365250
31127>>>>>define Jan1st105           for 38352
31127>>>>>define Jan1st100           for 36525
31127>>>>>
31127>>>>>enumeration_list // Date Segments
31127>>>>>  define DS_DAY
31127>>>>>  define DS_WEEK
31127>>>>>  define DS_MONTH
31127>>>>>  define DS_YEAR
31127>>>>>end_enumeration_list
31127>>>>>
31127>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31127>>>>>
31127>>>>>procedure DateDecompose global date date# //very internal!!
31128>>>>>  local integer pos1# pos2# format#
31129>>>>>  local string str# sep#
31129>>>>>  get_attribute DF_DATE_FORMAT to format#
31132>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31135>>>>>  character pos1# to sep#                  // end overload
31136>>>>>>
31136>>>>>  move date# to str#
31137>>>>>  replace sep# in str# with "$"
31139>>>>>  move strmark to pos1#
31140>>>>>  if [found] begin
31142>>>>>    replace sep# in str# with "$"
31144>>>>>    move strmark to pos2#
31145>>>>>  end
31145>>>>>>
31145>>>>>  else begin
31146>>>>>    move 0 to Dates$Year
31147>>>>>    move 0 to Dates$Month
31148>>>>>    move 0 to Dates$Day
31149>>>>>  end
31149>>>>>>
31149>>>>>  [ found] begin
31151>>>>>>
31151>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31155>>>>>    if format# eq DF_DATE_USA begin
31157>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31160>>>>>>
31160>>>>>          left str# to Dates$Month  (pos1#-1)
31162>>>>>>
31162>>>>>    end
31162>>>>>>
31162>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31166>>>>>
31166>>>>>    if format# eq DF_DATE_MILITARY begin
31168>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31171>>>>>>
31171>>>>>          left str# to Dates$Year   (pos1#-1)
31173>>>>>>
31173>>>>>    end
31173>>>>>>
31173>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31177>>>>>  end
31177>>>>>>
31177>>>>>end_procedure
31178>>>>>
31178>>>>>function DateCompose global integer day# integer month# integer year# returns date
31179>>>>>  local integer format#
31180>>>>>  local date date#
31180>>>>>  local string sep#
31180>>>>>  ifnot (day#*month#*year#) function_return 0
31183>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31186>>>>>  character format# to sep#                  // end overload
31187>>>>>>
31187>>>>>  get_attribute DF_DATE_FORMAT to format#
31190>>>>>  if day# gt 28 begin
31192>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31195>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31198>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31201>>>>>    send DateDecompose date#
31202>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31205>>>>>  end
31205>>>>>>
31205>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31208>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31211>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31212>>>>>end_function
31213>>>>>
31213>>>>>function DateFormatName global integer format# returns string
31214>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31217>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31220>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31223>>>>>end_function
31224>>>>>
31224>>>>>function DateCurrentSeparator global returns string
31225>>>>>  local integer rval#
31226>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31229>>>>>  function_return (character(rval#))
31230>>>>>end_function
31231>>>>>
31231>>>>>function DateCurrentFormat global returns integer
31232>>>>>  local integer rval#
31233>>>>>  get_attribute DF_DATE_FORMAT to rval#
31236>>>>>  function_return rval#
31237>>>>>end_function
31238>>>>>
31238>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31239>>>>>  local string rval# letter#
31240>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31243>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31246>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31249>>>>>  left t.calendar.year to letter# 1
31251>>>>>>
31251>>>>>  replace "1" in rval# with letter#
31253>>>>>  replace "1" in rval# with letter#
31255>>>>>  ifnot long# move "" to letter#
31258>>>>>  move (replaces("1",rval#,letter#)) to rval#
31259>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31260>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31261>>>>>  if sep# eq "" begin
31263>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31266>>>>>    character format# to sep#
31267>>>>>>
31267>>>>>  end
31267>>>>>>
31267>>>>>  move (replaces("4",rval#,sep#)) to rval#
31268>>>>>  function_return rval#
31269>>>>>end_function
31270>>>>>
31270>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31271>>>>>  local integer sep_len# day# month# year#
31272>>>>>  move (length(sep#)) to sep_len#
31273>>>>>  if four_digit_year# move 4 to four_digit_year#
31276>>>>>  else move 2 to four_digit_year#
31278>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31280>>>>>    move (mid(date#,2,1)) to day#
31281>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31282>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31283>>>>>  end
31283>>>>>>
31283>>>>>  if format# eq DF_DATE_USA begin // MDY
31285>>>>>    move (mid(date#,2,1)) to month#
31286>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31287>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31288>>>>>  end
31288>>>>>>
31288>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31290>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31291>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31292>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31293>>>>>  end
31293>>>>>>
31293>>>>>  function_return (DateCompose(day#,month#,year#))
31294>>>>>end_function
31295>>>>>
31295>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31296>>>>>  local string rval# day# month# year#
31297>>>>>  get Date2to4 date# to date#
31298>>>>>  if (integer(date#)) begin
31300>>>>>    send DateDecompose date#
31301>>>>>    move Dates$Day to day#
31302>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31306>>>>>    move Dates$Month to month#
31307>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31311>>>>>    move Dates$Year to year#
31312>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31315>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31318>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31321>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31324>>>>>  end
31324>>>>>>
31324>>>>>  function_return rval#
31325>>>>>end_function
31326>>>>>
31326>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31326>>>>>// Use function DateToString instead.
31326>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31327>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31328>>>>>end_function
31329>>>>>
31329>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31330>>>>>  if (date#=0) function_return 0
31333>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31336>>>>>  if (segment#<>DS_DAY) begin // months or years
31338>>>>>    send DateDecompose date#
31339>>>>>    if segment# eq DS_MONTH begin //months
31341>>>>>      move (Dates$Month+amount#) to Dates$Month
31342>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31345>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31346>>>>>    end //years:
31346>>>>>>
31346>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31349>>>>>  end
31349>>>>>>
31349>>>>>  else function_return (date#+amount#) //days
31351>>>>>end_function
31352>>>>>
31352>>>>>function DateSegment global date date# integer segment# returns integer
31353>>>>>  send DateDecompose date#
31354>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31357>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31360>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31363>>>>>end_function
31364>>>>>
31364>>>>>function DateToInteger global date date# returns integer
31365>>>>>  send DateDecompose date#
31366>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31367>>>>>end_function
31368>>>>>
31368>>>>>function FirstDayInMonth global date date# returns date
31369>>>>>  local integer month# year#
31370>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31371>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31372>>>>>  function_return (DateCompose(1,month#,year#))
31373>>>>>end_function
31374>>>>>
31374>>>>>function LastDayInMonth global date date# returns date
31375>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31376>>>>>  function_return (FirstDayInMonth(date#)-1)
31377>>>>>end_function
31378>>>>>
31378>>>>>function FirstDayInYear global date date# returns date
31379>>>>>  local integer year#
31380>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31381>>>>>  function_return (DateCompose(1,1,year#))
31382>>>>>end_function
31383>>>>>
31383>>>>>function LastDayInYear global date date# returns date
31384>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31385>>>>>  function_return (FirstDayInYear(date#)-1)
31386>>>>>end_function
31387>>>>>
31387>>>>>// Prior to 18/1-99 version of DateWeekNumber
31387>>>>>//function DateWeekNumber global date date# returns integer
31387>>>>>//  local integer week# first_wd# day_of_year# year#
31387>>>>>//  if (date#=0) function_return 0
31387>>>>>//  get Date2to4 date# to date#
31387>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31387>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31387>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31387>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31387>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31387>>>>>//  else move 0 to week#
31387>>>>>//  if first_wd# le 4 increment week#
31387>>>>>//  if week# gt 52 begin
31387>>>>>//    move 1 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  if week# eq 0 begin
31387>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31387>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31387>>>>>//    move 52 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  function_return week#
31387>>>>>//end_function
31387>>>>>
31387>>>>>function DateWeekNumber global date date# returns integer
31388>>>>>  local integer week# first_wd# day_of_year# year# wd#
31389>>>>>  if (date#=0) function_return 0
31392>>>>>  get Date2to4 date# to date#
31393>>>>>  // Leap-year test for actual or previous year
31393>>>>>  // Year# only used for selection between 52 and
31393>>>>>  // Therefore get year# from the first day of actual week
31393>>>>>  get DateDayNumber date# to wd#
31394>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31395>>>>>
31395>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31396>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31397>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31398>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31401>>>>>  else move 0 to week#
31403>>>>>  if first_wd# le 4 increment week#
31406>>>>>  if week# gt 52 begin
31408>>>>>    move 1 to week#
31409>>>>>    if first_wd# eq 4 move 53 to week#
31412>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31419>>>>>  end
31419>>>>>>
31419>>>>>  if week# eq 0 begin
31421>>>>>    // Week 52 or 53
31421>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31422>>>>>    move 52 to week#
31423>>>>>    if first_wd# eq 4 move 53 to week#
31426>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31433>>>>>  end
31433>>>>>>
31433>>>>>  function_return week#
31434>>>>>end_function
31435>>>>>
31435>>>>>function DayName global integer int# returns string
31436>>>>>  if int# eq 1 function_return t.calendar.Monday
31439>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31442>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31445>>>>>  if int# eq 4 function_return t.calendar.Thursday
31448>>>>>  if int# eq 5 function_return t.calendar.Friday
31451>>>>>  if int# eq 6 function_return t.calendar.Saturday
31454>>>>>  if int# eq 7 function_return t.calendar.Sunday
31457>>>>>  function_return ""
31458>>>>>end_function
31459>>>>>
31459>>>>>function DateDayNumber global date date# returns integer
31460>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31461>>>>>  get Date2to4 date# to date#
31462>>>>>  move date# to rval#
31463>>>>>  if rval# begin
31465>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31468>>>>>    move (rval#-((rval#/7)*7)) to rval#
31469>>>>>    if rval# eq 0 move 7 to rval#
31472>>>>>  end
31472>>>>>>
31472>>>>>  function_return rval#
31473>>>>>end_function
31474>>>>>
31474>>>>>function DateDayName global date date# returns string
31475>>>>>  function_return (DayName(DateDayNumber(date#)))
31476>>>>>end_function
31477>>>>>
31477>>>>>function YearMaxWeek global integer year# returns integer
31478>>>>>  local integer wk1# wk2#
31479>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31480>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31481>>>>>  function_return (wk1# max wk2#)
31482>>>>>end_function
31483>>>>>
31483>>>>>function WeekToDate global integer year# integer week# returns date
31484>>>>>  local date date#
31485>>>>>  move (DateCompose(1,1,year#)) to date#
31486>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31489>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31490>>>>>  function_return (week#-1*7+date#)
31491>>>>>end_function
31492>>>>>
31492>>>>>function MonthName global integer int# returns string
31493>>>>>  if int# eq  1 function_return t.calendar.January
31496>>>>>  if int# eq  2 function_return t.calendar.February
31499>>>>>  if int# eq  3 function_return t.calendar.March
31502>>>>>  if int# eq  4 function_return t.calendar.April
31505>>>>>  if int# eq  5 function_return t.calendar.May
31508>>>>>  if int# eq  6 function_return t.calendar.June
31511>>>>>  if int# eq  7 function_return t.calendar.July
31514>>>>>  if int# eq  8 function_return t.calendar.August
31517>>>>>  if int# eq  9 function_return t.calendar.September
31520>>>>>  if int# eq 10 function_return t.calendar.October
31523>>>>>  if int# eq 11 function_return t.calendar.November
31526>>>>>  if int# eq 12 function_return t.calendar.December
31529>>>>>  function_return ""
31530>>>>>end_function
31531>>>>>
31531>>>>>function DateMonthName global date date# returns string
31532>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31533>>>>>end_function
31534>>>>>
31534>>>>>function DateAsText global date date# string format# returns string
31535>>>>>  if date# eq 0 function_return ""
31538>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31539>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31540>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31541>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31542>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31543>>>>>  function_return format#
31544>>>>>end_function
31545>>>>>
31545>>>>>function Year2to4 global integer year# returns integer
31546>>>>>  local integer epoch_value#
31547>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31548>>>>>  if year# lt 100 begin
31550>>>>>    if year# gt epoch_value# function_return (year#+1900)
31553>>>>>    function_return (year#+2000)
31554>>>>>  end
31554>>>>>>
31554>>>>>  function_return year# // No conversion done!
31555>>>>>end_function
31556>>>>>
31556>>>>>function Date2to4 global date date# returns date
31557>>>>>  local integer epoch_value#
31558>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31559>>>>>  if date# gt 0 begin // Only if there is a date to convert
31561>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31563>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31566>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31567>>>>>    end
31567>>>>>>
31567>>>>>    function_return date# // No conversion done!
31568>>>>>  end
31568>>>>>>
31568>>>>>end_function
31569>>>>>
31569>>>>>function Date4to2 global date date# returns date
31570>>>>>  local integer epoch_value# year#
31571>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31572>>>>>  if date# gt 0 begin // Only if there is a date to convert
31574>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31575>>>>>    if year# ge 100 begin // Only then conversion is needed!
31577>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31579>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31582>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31584>>>>>      end
31584>>>>>>
31584>>>>>      else error 301 "Date is out of epoch range"
31586>>>>>    end
31586>>>>>>
31586>>>>>  end
31586>>>>>>
31586>>>>>  function_return date# // No conversion done!
31587>>>>>end_function
31588>>>>>
31588>>>>>function dSysDate global returns date
31589>>>>>  local date date#
31590>>>>>  sysdate4 date#
31591>>>>>  function_return date#
31592>>>>>end_function
31593>>>>>
31593>>>>>function iSysYear global returns integer
31594>>>>>  local date date#
31595>>>>>  sysdate4 date#
31596>>>>>  function_return (DateSegment(date#,DS_YEAR))
31597>>>>>end_function
31598>>>>>
31598>>>>>procedure ItemSysdate for desktop integer itm#
31599>>>>>  local date date#
31600>>>>>  get value item itm# to date#
31601>>>>>  if date# eq 0 begin
31603>>>>>    sysdate4 date#
31604>>>>>    set changed_value item itm# to date#
31605>>>>>  end
31605>>>>>>
31605>>>>>end_procedure
31606>>>>>
31606>>>>>procedure ItemDate2to4 for desktop integer itm#
31607>>>>>  local integer year#
31608>>>>>  local date date# new_date#
31608>>>>>  get value item itm# to date#
31609>>>>>
31609>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31610>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31613>>>>>  else move date# to new_date#
31615>>>>>
31615>>>>>  move (Date2to4(new_date#)) to new_date#
31616>>>>>  move (DateSegment(new_date#,3)) to year#
31617>>>>>  if (year#>99 and year#<1000) begin
31619>>>>>    error 15 // Illegal entry in this window
31620>>>>>>
31620>>>>>    procedure_return 1
31621>>>>>  end
31621>>>>>>
31621>>>>>  if new_date# ne date# set value item itm# to new_date#
31624>>>>>end_procedure
31625>>>>>
31625>>>>>procedure ItemYear2to4 for desktop integer itm#
31626>>>>>  local integer year# new_year#
31627>>>>>  get value item itm# to year#
31628>>>>>  if (year#>99 and year#<1000) begin
31630>>>>>    error 15 // Illegal entry in this window
31631>>>>>>
31631>>>>>    procedure_return 1
31632>>>>>  end
31632>>>>>>
31632>>>>>  move (Year2to4(year#)) to new_year#
31633>>>>>  if new_year# ne year# set value item itm# to new_year#
31636>>>>>end_procedure
31637>>>>>
31637>>>>> procedure FieldSysdate for DataDictionary integer fld#
31638>>>>>   local date date#
31639>>>>>   get field_current_value fld# to date#
31640>>>>>   if date# eq 0 begin
31642>>>>>     sysdate4 date#
31643>>>>>     set field_changed_value fld# to date#
31644>>>>>   end
31644>>>>>>
31644>>>>> end_procedure
31645>>>>>
31645>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31646>>>>>   local integer year#
31647>>>>>   local date date# new_date#
31647>>>>>   get field_current_value fld# to date#
31648>>>>>
31648>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31649>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31652>>>>>   else move date# to new_date#
31654>>>>>
31654>>>>>   move (Date2to4(new_date#)) to new_date#
31655>>>>>   move (DateSegment(new_date#,3)) to year#
31656>>>>>   if (year#>99 and year# <=999) begin
31658>>>>>     error 15 // Illegal entry in this window
31659>>>>>>
31659>>>>>     procedure_return 1
31660>>>>>   end
31660>>>>>>
31660>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31663>>>>> end_procedure
31664>>>>>
31664>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31665>>>>>   local integer year# new_year# changed#
31666>>>>>   get field_current_value fld# to year#
31667>>>>>   get field_changed_state fld# to changed#
31668>>>>>   if changed# begin
31670>>>>>     if (year#>99 and year#<1000) begin
31672>>>>>       error 15 // Illegal entry in this window
31673>>>>>>
31673>>>>>       procedure_return 1
31674>>>>>     end
31674>>>>>>
31674>>>>>     move (Year2to4(year#)) to new_year#
31675>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31678>>>>>   end
31678>>>>>>
31678>>>>> end_procedure
31679>>>>>
31679>>>>> function SysDate global returns date
31680>>>>>   function_return (dSysDate())
31681>>>>> end_function
31682>>>>>
31682>>>>>function sSysTime global returns string
31683>>>>>  local integer h# m# s#
31684>>>>>  sysdate4 h# h# m# s#
31688>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31689>>>>>end_function
31690>>>>>
31690>>>>>function TS_SysTime global returns number
31691>>>>>  local integer d# h# m# s#
31692>>>>>  sysdate4 d# h# m# s#
31696>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31697>>>>>end_function
31698>>>>>
31698>>>>>//> This function returns a TS value composed from the date and time
31698>>>>>//> passed to it. Note that the time variable must be of the format
31698>>>>>//> "hh:mm:ss".
31698>>>>>function TS_Compose global date date# string time# returns number
31699>>>>>  local integer h# m# s#
31700>>>>>  left time# to h# 2
31702>>>>>>
31702>>>>>  mid time# to m# 2 4
31705>>>>>>
31705>>>>>  mid time# to s# 2 7
31708>>>>>>
31708>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31709>>>>>end_function
31710>>>>>
31710>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31711>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31712>>>>>end_function
31713>>>>>
31713>>>>>function TS_ExtractDate global number time# returns date
31714>>>>>  function_return (time#/86400) // 86400=24*60*60
31715>>>>>end_function
31716>>>>>
31716>>>>>function TS_ExtractTime global number time# returns string
31717>>>>>  local integer h# m# s#
31718>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31719>>>>>  move (s#/3600) to h#
31720>>>>>  move (s#-(h#*3600)) to s#
31721>>>>>  move (s#/60) to m#
31722>>>>>  move (s#-(m#*60)) to s#
31723>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31724>>>>>end_function
31725>>>>>
31725>>>>>function TS_ConvertToString global number time# returns string
31726>>>>>  local date d#
31727>>>>>  move (TS_ExtractDate(time#)) to d#
31728>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31731>>>>>  else function_return (TS_ExtractTime(time#))
31733>>>>>end_function
31734>>>>>
31734>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31735>>>>>  local integer h# m#
31736>>>>>  move (ts#/3600) to h#
31737>>>>>  move (ts#-(h#*3600)) to ts#
31738>>>>>  move (ts#/60) to m#
31739>>>>>  move (ts#-(m#*60)) to ts#
31740>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31741>>>>>end_function
31742>>>>>
31742>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31742>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31743>>>>>  local integer obj2# itm2#
31744>>>>>  if num_arguments gt 3 begin
31746>>>>>    move tmp_obj2# to obj2#
31747>>>>>    move tmp_itm2# to itm2#
31748>>>>>  end
31748>>>>>>
31748>>>>>  else begin
31749>>>>>    move obj1# to obj2#
31750>>>>>    move (itm1#+1) to itm2#
31751>>>>>  end
31751>>>>>>
31751>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31752>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31753>>>>>end_procedure
31754>>>>>
31754>>>>>class TS_TimeEstimator is an array
31755>>>>>  procedure construct_object
31756>>>>>    forward send construct_object
31758>>>>>    set delegation_mode to delegate_to_parent
31759>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31760>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31761>>>>>    property number  pnLeft    public 0 // Number of seconds left
31762>>>>>    property number  pnStart   public 0
31763>>>>>    property number  pnPause   public 0
31764>>>>>    property number  pnPercent public 0
31765>>>>>    property integer piMin     public 0
31766>>>>>    property integer piMax     public 0
31767>>>>>  end_procedure
31768>>>>>
31768>>>>>  procedure TS_Start integer min# integer max#
31769>>>>>    set piMin to min#
31770>>>>>    set piMax to max#
31771>>>>>    set pnStart to (TS_SysTime())
31772>>>>>    set pnElapsed to 0
31773>>>>>    set pnPercent to 0
31774>>>>>  end_procedure
31775>>>>>
31775>>>>>  procedure TS_Calculate integer pos#
31776>>>>>    local integer min# max#
31777>>>>>    get piMin to min#
31778>>>>>    get piMax to max#
31779>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31780>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31781>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31782>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31783>>>>>  end_procedure
31784>>>>>
31784>>>>>  procedure TS_Pause
31785>>>>>    set pnPause to (TS_SysTime())
31786>>>>>  end_procedure
31787>>>>>
31787>>>>>  procedure TS_Continue
31788>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31789>>>>>  end_procedure
31790>>>>>end_class
31791>>>>>
31791>>>>>function TS_Module_Compile_Time global string path# returns number
31792>>>>>  local integer pos# day# month# year# seqeof# ch#
31793>>>>>  local string date# str# time#
31793>>>>>  move path# to str#
31794>>>>>  if str# ne "" begin
31796>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31797>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31798>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31800>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31802>>>>>    [ seqeof] move 1 to seqeof#
31803>>>>>    [~seqeof] move 0 to seqeof#
31804>>>>>    [~seqeof] readln str#
31805>>>>>    close_input channel ch#
31807>>>>>  end
31807>>>>>>
31807>>>>>  if seqeof# function_return 0
31810>>>>>  pos "," in str# to pos#
31812>>>>>>
31812>>>>>  move (mid(str#,18,pos#+2)) to str#
31813>>>>>  move (integer(mid(str#,2,4))) to day#
31814>>>>>  move (integer(mid(str#,2,1))) to month#
31815>>>>>  move (integer(mid(str#,2,7))) to year#
31816>>>>>  if year# eq 10 begin
31818>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31819>>>>>    move (mid(str#,8,11)) to str#
31820>>>>>  end
31820>>>>>>
31820>>>>>  else move (mid(str#,8,10)) to str#
31822>>>>>  move (DateCompose(day#,month#,year#)) to date#
31823>>>>>  move (Date2to4(date#)) to date#
31824>>>>>  pos ":" in str# to pos#
31826>>>>>>
31826>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31827>>>>>end_function
31828>>>>>
31828>>>>>string Dates$Module_Compile_Time
31828>>>>>move "" to Dates$Module_Compile_Time
31829>>>>>
31829>>>>>function Module_Compile_Date global returns date
31830>>>>>  local number ts#
31831>>>>>  local string str#
31831>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31832>>>>>  get TS_Module_Compile_Time str# to ts#
31833>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31834>>>>>  function_return (TS_ExtractDate(ts#))
31835>>>>>end_function
31836>>>>>
31836>>>>>function Module_Compile_Time global returns string
31837>>>>>  local date grb#
31838>>>>>  // Module_Compile_Date must be called before this one!
31838>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31841>>>>>  function_return Dates$Module_Compile_Time
31842>>>>>end_function
31843>>>>>
31843>>>>>date   Dates$ModuleStartDate
31843>>>>>string Dates$ModuleStartTime 8
31843>>>>>move (dSysDate()) to Dates$ModuleStartDate
31844>>>>>move (sSysTime()) to Dates$ModuleStartTime
31845>>>>>
31845>>>>>function Module_Start_Date global returns date
31846>>>>>  function_return Dates$ModuleStartDate
31847>>>>>end_function
31848>>>>>
31848>>>>>function Module_Start_Time global returns string
31849>>>>>  function_return Dates$ModuleStartTime
31850>>>>>end_function
31851>>>>>
31851>>>>> register_procedure NotifyPopupCalendarChange date date#
31851>>>>> register_procedure NotifyPopupCalendarSelect date date#
31851>>>>>  use dfAllent
31851>>>>>  class calendar.textbox is a textbox
31852>>>>>    procedure construct_object
31853>>>>>      forward send construct_object
31855>>>>>      Set Auto_Size_State To False
31856>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31857>>>>>    end_procedure
31858>>>>>  end_class
31859>>>>>
31859>>>>>  register_object btn1
31859>>>>>  register_object btn6
31859>>>>>
31859>>>>>  class calendar.button is a button
31860>>>>>
31860>>>>>    procedure construct_object
31861>>>>>      forward send construct_object
31863>>>>>      set size to 15 18
31864>>>>>      on_key kleftarrow   send prev_day
31865>>>>>      on_key krightarrow  send next_day
31866>>>>>      on_key kuparrow     send prev_week
31867>>>>>      on_key kdownarrow   send next_week
31868>>>>>      property date p_assigned_date public 0
31869>>>>>    end_procedure
31870>>>>>
31870>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31871>>>>>      send activate to (btn1(current_object))
31872>>>>>    end_procedure
31873>>>>>    procedure switch_back
31874>>>>>      send activate to (btn6(current_object))
31875>>>>>    end_procedure
31876>>>>>
31876>>>>>    procedure mouse_down
31877>>>>>      local integer current_object#
31878>>>>>      forward send mouse_down
31880>>>>>      move current_object to current_object#
31881>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31883>>>>>    end_procedure
31884>>>>>  end_class
31885>>>>>
31885>>>>>  desktop_section
31891>>>>>    object popup_calendar is a ModalPanel
31893>>>>>      set size to 160 250
31894>>>>>      property date    p_current_date  public 0
31896>>>>>      property integer p_current_year  public -1
31898>>>>>      property integer p_current_month public -1
31900>>>>>      property integer pExportState    public 1
31902>>>>>
31902>>>>>      on_key key_ctrl+key_pgup send prev_year
31903>>>>>      on_key key_ctrl+key_pgdn send next_year
31904>>>>>      on_key          key_pgup send prev_month
31905>>>>>      on_key          key_pgdn send next_month
31906>>>>>      on_key key_ctrl+key_d    send go_today
31907>>>>>      on_key kcancel           send cancel
31908>>>>>
31908>>>>>      object cont3d is a container3d
31910>>>>>        set location to 5 5
31911>>>>>        set size to 120 237
31912>>>>>        object textbox_year is a calendar.textbox
31914>>>>>          set location to 5 5
31915>>>>>          set size to 15 30
31916>>>>>          set border_style to border_staticedge
31917>>>>>          procedure display
31919>>>>>            set value to (p_current_year(current_object))
31920>>>>>          end_procedure
31921>>>>>        end_object
31922>>>>>        object dayname_header is a container3d
31924>>>>>          set location to 5 39
31925>>>>>          set size to 15 126
31926>>>>>          set border_style to border_staticedge
31927>>>>>          procedure initialize
31929>>>>>            local integer itm#
31930>>>>>            for itm# from 0 to 6
31936>>>>>>
31936>>>>>              object txt is a calendar.textbox
31938>>>>>                set size to 12 17
31939>>>>>                set location to 0 (itm#*17.6+1)
31940>>>>>                 set value to (left(DayName(itm#+1),3))
31941>>>>>              end_object
31942>>>>>            loop
31943>>>>>>
31943>>>>>          end_procedure
31944>>>>>          send initialize
31945>>>>>        end_object
31946>>>>>        object weeknumber_header is a container3d
31948>>>>>          set location to 24 5
31949>>>>>          set size     to 89 30
31950>>>>>          set border_style to border_staticedge
31951>>>>>          object obj_id_array is an array
31953>>>>>          end_object
31954>>>>>          procedure initialize
31956>>>>>            local integer itm# obj#
31957>>>>>            move (obj_id_array(current_object)) to obj#
31958>>>>>            for itm# from 0 to 5
31964>>>>>>
31964>>>>>              object txt is a textbox
31966>>>>>                set size to 15 30
31967>>>>>                set location to (itm#*15+1) 1
31968>>>>>                set value of obj# item (item_count(obj#)) to current_object
31969>>>>>              end_object
31970>>>>>            loop
31971>>>>>>
31971>>>>>          end_procedure
31972>>>>>          procedure display
31974>>>>>            local integer itm# obj#
31975>>>>>            local date date# last_date#
31975>>>>>            move (obj_id_array(current_object)) to obj#
31976>>>>>            get p_current_date to date#
31977>>>>>            move (FirstDayInMonth(date#)) to date#
31978>>>>>            move (LastDayInMonth(date#)) to last_date#
31979>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31980>>>>>            for itm# from 0 to 5
31986>>>>>>
31986>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31989>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31991>>>>>            loop
31992>>>>>>
31992>>>>>          end_procedure
31993>>>>>          send initialize
31994>>>>>        end_object
31995>>>>>        object days_grid is a container3d
31997>>>>>          set location to 23 39
31998>>>>>          set size     to 100 127
31999>>>>>          set border_style to border_none
32000>>>>>          object btn_array is an array
32002>>>>>          end_object
32003>>>>>          procedure initialize
32005>>>>>            local integer row# col# button_array#
32006>>>>>            move (btn_array(current_object)) to button_array#
32007>>>>>            for row# from 0 to 5
32013>>>>>>
32013>>>>>              for col# from 0 to 6
32019>>>>>>
32019>>>>>                object btn is a calendar.button
32021>>>>>                  set location to (row#*15) (col#*18)
32022>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32023>>>>>                  on_item "" send move_value_out_ok
32024>>>>>                end_object
32025>>>>>              loop
32026>>>>>>
32026>>>>>            loop
32027>>>>>>
32027>>>>>          end_procedure
32028>>>>>          send initialize
32029>>>>>
32029>>>>>          procedure display.iii integer itm# integer day# integer activate#
32031>>>>>            local integer obj# current_day#
32032>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32033>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32034>>>>>            if activate# begin
32036>>>>>              if day# eq current_day# send activate to obj#
32039>>>>>            end
32039>>>>>>
32039>>>>>            else begin
32040>>>>>              if day# begin
32042>>>>>                set value of obj# to day#
32043>>>>>                set visible_state of obj# to true
32044>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32045>>>>>              end
32045>>>>>>
32045>>>>>              else set visible_state of obj# to false
32047>>>>>            end
32047>>>>>>
32047>>>>>          end_procedure
32048>>>>>
32048>>>>>          procedure display integer activate#
32050>>>>>            local integer first_item# last_item# itm# day# date#
32051>>>>>            get p_current_date to date#
32052>>>>>            move (FirstDayInMonth(date#)) to date#
32053>>>>>            move (DateDayNumber(date#)-1) to first_item#
32054>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32055>>>>>            ifnot activate# begin
32057>>>>>              for itm# from 0 to (first_item#-1)
32063>>>>>>
32063>>>>>                send display.iii itm# 0 0
32064>>>>>              loop
32065>>>>>>
32065>>>>>            end
32065>>>>>>
32065>>>>>            move 1 to day#
32066>>>>>            for itm# from first_item# to last_item#
32072>>>>>>
32072>>>>>              send display.iii itm# day# activate#
32073>>>>>              increment day#
32074>>>>>            loop
32075>>>>>>
32075>>>>>            ifnot activate# begin
32077>>>>>              for itm# from (last_item#+1) to 41
32083>>>>>>
32083>>>>>                send display.iii itm# 0 0
32084>>>>>              loop
32085>>>>>>
32085>>>>>            end
32085>>>>>>
32085>>>>>          end_procedure
32086>>>>>        end_object
32087>>>>>        object txt_month is a calendar.textbox
32089>>>>>          set size to 12 27
32090>>>>>          set location to 25 185
32091>>>>>          set value to t.calendar.month
32092>>>>>        end_object
32093>>>>>        object btn1 is a button
32095>>>>>          set size to 12 12
32096>>>>>          set location to 40 185
32097>>>>>          on_item "" send prev_month
32098>>>>>          set bitmap to "prev.bmp"
32099>>>>>          procedure switch_back
32101>>>>>            send display_main
32102>>>>>          end_procedure
32103>>>>>        end_object
32104>>>>>        object btn2 is a button
32106>>>>>          set size to 12 12
32107>>>>>          set location to 40 200
32108>>>>>          on_item "" send next_month
32109>>>>>          set bitmap to "next.bmp"
32110>>>>>        end_object
32111>>>>>        object txt_year is a calendar.textbox
32113>>>>>          set size to 12 27
32114>>>>>          set location to 70 185
32115>>>>>          set value to t.calendar.year
32116>>>>>        end_object
32117>>>>>        object btn3 is a button
32119>>>>>          set size to 12 12
32120>>>>>          set location to 85 185
32121>>>>>          on_item "" send prev_year
32122>>>>>          set bitmap to "prev.bmp"
32123>>>>>        end_object
32124>>>>>        object btn4 is a button
32126>>>>>          set size to 12 12
32127>>>>>          set location to 85 200
32128>>>>>          on_item "" send next_year
32129>>>>>          set bitmap to "next.bmp"
32130>>>>>        end_object
32131>>>>>      end_object
32132>>>>>      object btn5 is a button
32134>>>>>        set size to 14 60
32135>>>>>        set location to 129 115
32136>>>>>        on_item t.calendar.ok send move_value_out_ok
32137>>>>>      end_object
32138>>>>>      object btn6 is a button
32140>>>>>        set size to 14 60
32141>>>>>        set location to 129 182
32142>>>>>        on_item t.calendar.cancel send cancel
32143>>>>>        procedure switch
32145>>>>>          send display_main
32146>>>>>        end_procedure
32147>>>>>      end_object
32148>>>>>      procedure next_year
32150>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32151>>>>>        send display_main
32152>>>>>      end_procedure
32153>>>>>      procedure prev_year
32155>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32156>>>>>        send display_main
32157>>>>>      end_procedure
32158>>>>>      procedure next_month
32160>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32161>>>>>        send display_main
32162>>>>>      end_procedure
32163>>>>>      procedure prev_month
32165>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32166>>>>>        send display_main
32167>>>>>      end_procedure
32168>>>>>      procedure next_week
32170>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32171>>>>>        send display_main
32172>>>>>      end_procedure
32173>>>>>      procedure prev_week
32175>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32176>>>>>        send display_main
32177>>>>>      end_procedure
32178>>>>>      procedure next_day
32180>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32181>>>>>        send display_main
32182>>>>>      end_procedure
32183>>>>>      procedure prev_day
32185>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32186>>>>>        send display_main
32187>>>>>      end_procedure
32188>>>>>      procedure go_today
32190>>>>>        local date date#
32191>>>>>        sysdate4 date#
32192>>>>>        set p_current_date to date#
32193>>>>>        send display_main
32194>>>>>      end_procedure
32195>>>>>      property integer invoking_object_id public 0
32197>>>>>      procedure OnChange date date#
32199>>>>>        local integer focus# dm#
32200>>>>>        get invoking_object_id to focus#
32201>>>>>        if focus# gt desktop begin
32203>>>>>          get delegation_mode of focus# to dm#
32204>>>>>          set delegation_mode of focus# to no_delegate_or_error
32205>>>>>          send NotifyPopupCalendarChange to focus# date#
32206>>>>>          set delegation_mode of focus# to dm#
32207>>>>>        end
32207>>>>>>
32207>>>>>      end_procedure
32208>>>>>      procedure display
32210>>>>>        local integer date# month# year#
32211>>>>>        get p_current_date to date#
32212>>>>>        send OnChange date#
32213>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32214>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32215>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32217>>>>>          set p_current_year to year#
32218>>>>>          set p_current_month to month#
32219>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32220>>>>>          send display to (textbox_year(cont3d(current_object)))
32221>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32222>>>>>          send display to (days_grid(cont3d(current_object))) 0
32223>>>>>        end
32223>>>>>>
32223>>>>>      end_procedure
32224>>>>>      procedure display_main
32226>>>>>        send display
32227>>>>>        send display to (days_grid(cont3d(current_object))) 1
32228>>>>>      end_procedure
32229>>>>>      procedure popup_no_export
32231>>>>>        set pExportState to false
32232>>>>>        send popup
32233>>>>>        set pExportState to true
32234>>>>>      end_procedure
32235>>>>>
32235>>>>>      procedure popup_group
32237>>>>>        local integer focus#
32238>>>>>        local date date#
32238>>>>>        move (focus(desktop)) to focus#
32239>>>>>        set invoking_object_id to focus#
32240>>>>>        get value of focus# item current to date#
32241>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32244>>>>>        move (Date2to4(date#)) to date#
32245>>>>>        set p_current_date to date#
32246>>>>>        send display
32247>>>>>        forward send popup_group
32249>>>>>        send display to (days_grid(cont3d(current_object))) 1
32250>>>>>      end_procedure
32251>>>>>
32251>>>>>      procedure move_value_out
32253>>>>>        local integer focus# dm# margin# datatype#
32254>>>>>        if (pExportState(current_object)) begin
32256>>>>>          get invoking_object_id to focus#
32257>>>>>          if focus# gt desktop begin
32259>>>>>            get delegation_mode of focus# to dm#
32260>>>>>            set delegation_mode of focus# to no_delegate_or_error
32261>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32262>>>>>            get form_margin of focus# item current to margin#
32263>>>>>            get form_datatype of focus# item current to datatype#
32264>>>>>            set delegation_mode of focus# to dm#
32265>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32268>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32270>>>>>            set item_changed_state of focus# item current to true
32271>>>>>          end
32271>>>>>>
32271>>>>>        end
32271>>>>>>
32271>>>>>      end_procedure
32272>>>>>
32272>>>>>      procedure move_value_out_ok
32274>>>>>        send move_value_out
32275>>>>>        send deactivate
32276>>>>>      end_procedure
32277>>>>>
32277>>>>>      procedure request_popup
32279>>>>>        local integer focus# type# dm#
32280>>>>>        move (focus(desktop)) to focus#
32281>>>>>        if focus# gt desktop begin
32283>>>>>          get delegation_mode of focus# to dm#
32284>>>>>          set delegation_mode of focus# to no_delegate_or_error
32285>>>>>          get form_datatype of focus# item current to type#
32286>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32289>>>>>          set delegation_mode of focus# to dm#
32290>>>>>        end
32290>>>>>>
32290>>>>>      end_procedure
32291>>>>>    end_object
32292>>>>>  end_desktop_section
32294>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32294>>>>>  // substitute would become negative (because located on the desktop). This
32294>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32294>>>>>  procedure request_popup_calendar for BaseClass
32295>>>>>    send request_popup to (popup_calendar(current_object))
32296>>>>>  end_procedure
32297>>>>>  procedure popup_calendar_no_export
32298>>>>>    send popup_no_export to (popup_calendar(current_object))
32299>>>>>  end_procedure
32300>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32300>>>>>  procedure Add_Calendar_tbButton integer oTb#
32301>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32302>>>>>  end_procedure
32303>>>>> function s.calendar returns integer // Backwards compatible!!
32304>>>>>   function_return (popup_calendar(current_object))
32305>>>>> end_function
32306>>>>>
32306>>>>>// Karl,
32306>>>>>// Structure is as follows,
32306>>>>>//
32306>>>>>// //put this code in the top portion of the view code or in the program
32306>>>>>// code.
32306>>>>>//
32306>>>>>// Type SystemTime
32306>>>>>//   field SystemTime.iYear As Word
32306>>>>>//   field SystemTime.iMonth As Word
32306>>>>>//   field SystemTime.iDayOfWeek As Word
32306>>>>>//   field SystemTime.iDay As Word
32306>>>>>//   field SystemTime.iHour As Word
32306>>>>>//   field SystemTime.iMinute As Word
32306>>>>>//   field SystemTime.iSecond As Word
32306>>>>>//   field SystemTime.iMilliseconds As Word
32306>>>>>// End_Type
32306>>>>>//
32306>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32306>>>>>//
32306>>>>>// //put this code in an onClick or wherever
32306>>>>>// procedure onclick
32306>>>>>//   local integer iRetVal
32306>>>>>//   local string TimeData
32306>>>>>//   local pointer GST
32306>>>>>//
32306>>>>>//   ZeroType SystemTime to TimeData
32306>>>>>//   getAddress from TimeData to GST
32306>>>>>//
32306>>>>>//   move (GetSystemTime(GST)) to iRetVal
32306>>>>>// end_procedure
32306>>>>>//
32306>>>>>// To extract the data from the Structure after calling the function use
32306>>>>>// the getbuff command as follows:
32306>>>>>//
32306>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32306>>>>>//
32306>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32306>>>>>//
32306>>>>>// OLIVER NELSON
32306>>>>>//
32306>>>>>//
32306>>>
32306>>>//AB-StoreTopEnd
32306>>>
32306>>>//AB-IgnoreStart
32306>>>
32306>>>Use DFAllEnt.pkg
32306>>>
32306>>>
32306>>>//AB-IgnoreEnd
32306>>>
32306>>>CD_Popup_Object oCalendar is a dbModalPanel
32325>>>
32325>>>    //AB-StoreTopStart
32325>>>    on_key kcancel           send cancel
32326>>>    //AB-StoreTopEnd
32326>>>
32326>>>    Set Border_Style to Border_Normal
32327>>>    Set Caption_Bar to FALSE
32328>>>    Set Label to "Ÿ­¢ àì, 2001"
32329>>>    Set Size to 98 123
32330>>>    Set Location to 10 22
32331>>>    Set Color to clWhite
32332>>>
32332>>>    //AB-DDOStart
32332>>>
32332>>>
32332>>>    //AB-DDOEnd
32332>>>
32332>>>    Object Container3d1 is a Container3d
32334>>>        Set Size to 88 135
32335>>>        Set Location to -2 -1
32336>>>        Set Color to clWhite
32337>>>        Set Border_Style to Border_None
32338>>>        Object Grid2 is a Grid
32340>>>
32340>>>            //AB-StoreTopStart
32340>>>            property date    p_current_date     public 0
32342>>>            property integer p_current_year     public -1
32344>>>            property integer p_current_month    public -1
32346>>>            property integer p_selected_day     public -1
32348>>>            property integer pExportState       public 1
32350>>>            property integer invoking_object_id public 0
32352>>>            
32352>>>            Set Border_Style To BORDER_NONE
32353>>>            Set header_visible_state To False
32354>>>            set select_mode to no_select
32355>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32356>>>            
32356>>>            on_key Key_F1 Send Help
32357>>>            on_key key_ctrl+key_pgup send prev_year
32358>>>            on_key key_ctrl+key_pgdn send next_year
32359>>>            on_key          key_pgup send prev_month
32360>>>            on_key          key_pgdn send next_month
32361>>>            on_key key_enter         send move_value_out
32362>>>            on_key key_ctrl+key_d    send go_today
32363>>>            
32363>>>            //AB-StoreTopEnd
32363>>>
32363>>>            Set Color to clWhite
32364>>>            Set CurrentCellColor to clWhite
32365>>>            Set CurrentCellTextColor to clWhite
32366>>>            Set Size to 61 145
32367>>>            Set Location to 30 1
32368>>>            Set Resize_Column_state to FALSE
32369>>>
32369>>>            Set Line_Width to 7 0
32370>>>
32370>>>            Set Form_Width    item 0 to 18
32371>>>            Set Header_Label  item 0 to "­"
32372>>>            
32372>>>            Set Form_Width    item 1 to 18
32373>>>            Set Header_Label  item 1 to "‚â"
32374>>>            
32374>>>            Set Form_Width    item 2 to 18
32375>>>            Set Header_Label  item 2 to "‘à"
32376>>>            
32376>>>            Set Form_Width    item 3 to 18
32377>>>            Set Header_Label  item 3 to "—â"
32378>>>            
32378>>>            Set Form_Width    item 4 to 18
32379>>>            Set Header_Label  item 4 to "â"
32380>>>            
32380>>>            Set Form_Width    item 5 to 18
32381>>>            Set Header_Label  item 5 to "‘¡"
32382>>>            
32382>>>            Set Form_Width    item 6 to 18
32383>>>            Set Header_Label  item 6 to "‚á"
32384>>>            
32384>>>
32384>>>            //AB-StoreStart
32384>>>            
32384>>>            procedure go_today
32386>>>                Date date#
32387>>>                sysdate4 date#
32388>>>                set p_current_date to date#
32389>>>                Send Update_Calendar
32390>>>            end_procedure
32391>>>            
32391>>>            procedure next_month
32393>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32394>>>                Send Update_Calendar
32395>>>            end_procedure
32396>>>            
32396>>>            procedure prev_month
32398>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32399>>>                Send Update_Calendar
32400>>>            end_procedure
32401>>>            
32401>>>            procedure next_year
32403>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32404>>>                Send Update_Calendar
32405>>>            end_procedure
32406>>>            
32406>>>            procedure prev_year
32408>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32409>>>                Send Update_Calendar
32410>>>            end_procedure
32411>>>            
32411>>>            Procedure Activate
32413>>>                Date date#
32414>>>                Forward Send Activate
32416>>>                Set current_item to (p_selected_day(Self))
32417>>>            End_Procedure
32418>>>            
32418>>>            Procedure Update_Calendar
32420>>>                Set Dynamic_Update_State To False
32421>>>                send Fill_List
32422>>>                Set Dynamic_Update_State To True
32423>>>                // Send Update_Label
32423>>>                Set current_item to (p_selected_day(Self))
32424>>>                Send Date_Changing to (oYear(Container3d2(self)))
32425>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32426>>>            End_Procedure
32427>>>            
32427>>>            Procedure Fill_List
32429>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32430>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32430>>>                Date dToday
32430>>>                Send Delete_Data
32431>>>            
32431>>>                Get p_current_date to date#
32432>>>            
32432>>>                SysDate4 dToday
32433>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32434>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32435>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32436>>>            
32436>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32437>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32438>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32439>>>                Set p_current_month To sel_month#
32440>>>                Set p_current_year To sel_year#
32441>>>            
32441>>>                move (FirstDayInMonth(date#)) to date#
32442>>>                move (DateDayNumber(date#)-1) to first_item#
32443>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32444>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32445>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32446>>>            
32446>>>                If (first_item# > 0) Begin
32448>>>                    Move (first_item#-1) to day#
32449>>>                    For iFor from 0 to (first_item#-1)
32455>>>>
32455>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32456>>>                        Set Entry_State Item iFor To False
32457>>>                        Set ItemTextColor Item iFor To clGray
32458>>>                        Decrement day#
32459>>>                    Loop
32460>>>>
32460>>>                End
32460>>>>
32460>>>            
32460>>>                Move 1 To day#
32461>>>                For iFor from first_item# to last_item#
32467>>>>
32467>>>                    Send Add_Item Msg_Move_Value_Out day#
32468>>>                    Set Entry_State Item iFor To False
32469>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32472>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32475>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32476>>>                    Set form_datatype item iFor To mask_numeric_window
32477>>>                    Set form_Mask item iFor To "## "
32478>>>                    Increment day#
32479>>>                Loop
32480>>>>
32480>>>            
32480>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32481>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32482>>>            
32482>>>                If (last_item# < 41) Begin
32484>>>                    Move 1 to day#
32485>>>                    For iFor from (last_item#+1) to 41
32491>>>>
32491>>>                        Send Add_Item msg_move_value_out day#
32492>>>                        Set Entry_State Item iFor To False
32493>>>                        Set ItemTextColor Item iFor To clGray
32494>>>                        Increment day#
32495>>>                    Loop
32496>>>>
32496>>>                End
32496>>>>
32496>>>            
32496>>>            End_Procedure
32497>>>            
32497>>>            Procedure Help
32499>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32500>>>            End_Procedure
32501>>>            
32501>>>            procedure mouse_click integer window integer char_pos
32503>>>                Send Move_Value_Out
32504>>>                forward send mouse_click window char_pos
32506>>>            end_procedure
32507>>>            
32507>>>            Procedure Move_Value_Out
32509>>>                Integer iYear iMonth iDay iItm
32510>>>                Date Date# next_date# prev_date#
32510>>>                Get Current_Item To iItm
32511>>>                If (pExportState(Self)) Begin
32513>>>                    Get Value Item iItm To iDay
32514>>>                    Get p_current_month to iMonth
32515>>>                    Get p_current_year  to iYear
32516>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32517>>>            
32517>>>                    If ((iItm>27)and(iDay<15)) Begin
32519>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32520>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32521>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32522>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32523>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32524>>>                    End
32524>>>>
32524>>>                    If ((iItm<7)and(iDay>20)) Begin
32526>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32527>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32528>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32529>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32530>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32531>>>                    End
32531>>>>
32531>>>            
32531>>>                    Send Export_Date date#
32532>>>                End
32532>>>>
32532>>>            End_Procedure
32533>>>            
32533>>>            Procedure Export_Date date date#
32535>>>                local integer focus# dm# margin# datatype#
32536>>>                get invoking_object_id to focus#
32537>>>            
32537>>>                if focus# gt desktop begin
32539>>>                     get delegation_mode of focus# to dm#
32540>>>                     set delegation_mode of focus# to no_delegate_or_error
32541>>>                     get form_margin of focus# item current to margin#
32542>>>                     get form_datatype of focus# item current to datatype#
32543>>>                     set delegation_mode of focus# to dm#
32544>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32547>>>                     else             set value of focus# item current to (Date4to2(date#))
32549>>>                     set item_changed_state of focus# item current to true
32550>>>                end
32550>>>>
32550>>>                Send Close_Calendar
32551>>>            End_Procedure
32552>>>            //AB-StoreEnd
32552>>>
32552>>>        End_Object    // Grid2
32553>>>
32553>>>        Object Textbox2 is a Textbox
32555>>>            Set Label to "­"
32556>>>            Set Auto_Size_State to FALSE
32557>>>            Set Transparent_State to TRUE
32558>>>            Set Color to clWhite
32559>>>            Set TextColor to clNavy
32560>>>            Set Location to 19 4
32561>>>            Set Size to 10 15
32562>>>
32562>>>            //AB-StoreStart
32562>>>                                        
32562>>>            Set Label To (left(t.calendar.Monday,2))
32563>>>            //AB-StoreEnd
32563>>>
32563>>>        End_Object    // Textbox2
32564>>>
32564>>>        Object Textbox3 is a Textbox
32566>>>            Set Label to "‚â"
32567>>>            Set Auto_Size_State to FALSE
32568>>>            Set Transparent_State to TRUE
32569>>>            Set Color to clWhite
32570>>>            Set TextColor to clNavy
32571>>>            Set Location to 19 22
32572>>>            Set Size to 10 12
32573>>>
32573>>>            //AB-StoreStart
32573>>>                                        
32573>>>            Set Label To (left(t.calendar.Tuesday,2))
32574>>>            //AB-StoreEnd
32574>>>
32574>>>        End_Object    // Textbox3
32575>>>
32575>>>        Object Textbox4 is a Textbox
32577>>>            Set Label to "‘à"
32578>>>            Set Auto_Size_State to FALSE
32579>>>            Set Transparent_State to TRUE
32580>>>            Set Color to clWhite
32581>>>            Set TextColor to clNavy
32582>>>            Set Location to 19 39
32583>>>            Set Size to 10 15
32584>>>
32584>>>            //AB-StoreStart
32584>>>                                        
32584>>>            Set Label To (left(t.calendar.Wednesday,2))
32585>>>            //AB-StoreEnd
32585>>>
32585>>>        End_Object    // Textbox4
32586>>>
32586>>>        Object Textbox5 is a Textbox
32588>>>            Set Label to "—â"
32589>>>            Set Auto_Size_State to FALSE
32590>>>            Set Transparent_State to TRUE
32591>>>            Set Color to clWhite
32592>>>            Set TextColor to clNavy
32593>>>            Set Location to 19 57
32594>>>            Set Size to 10 17
32595>>>
32595>>>            //AB-StoreStart
32595>>>                                        
32595>>>            Set Label To (left(t.calendar.Thursday,2))
32596>>>            //AB-StoreEnd
32596>>>
32596>>>        End_Object    // Textbox5
32597>>>
32597>>>        Object Textbox6 is a Textbox
32599>>>            Set Label to "â"
32600>>>            Set Auto_Size_State to FALSE
32601>>>            Set Transparent_State to TRUE
32602>>>            Set Color to clWhite
32603>>>            Set TextColor to clNavy
32604>>>            Set Location to 19 76
32605>>>            Set Size to 10 17
32606>>>
32606>>>            //AB-StoreStart
32606>>>                                        
32606>>>            Set Label To (left(t.calendar.Friday,2))
32607>>>            //AB-StoreEnd
32607>>>
32607>>>        End_Object    // Textbox6
32608>>>
32608>>>        Object Textbox7 is a Textbox
32610>>>            Set Label to "‘¡"
32611>>>            Set Auto_Size_State to FALSE
32612>>>            Set Transparent_State to TRUE
32613>>>            Set Color to clWhite
32614>>>            Set TextColor to clNavy
32615>>>            Set Location to 19 91
32616>>>            Set Size to 10 18
32617>>>
32617>>>            //AB-StoreStart
32617>>>                                        
32617>>>            Set Label To (left(t.calendar.Saturday,2))
32618>>>            //AB-StoreEnd
32618>>>
32618>>>        End_Object    // Textbox7
32619>>>
32619>>>        Object Textbox8 is a Textbox
32621>>>            Set Label to "‚á"
32622>>>            Set Auto_Size_State to FALSE
32623>>>            Set Transparent_State to TRUE
32624>>>            Set Color to clWhite
32625>>>            Set TextColor to clNavy
32626>>>            Set Location to 19 109
32627>>>            Set Size to 10 17
32628>>>
32628>>>            //AB-StoreStart
32628>>>                                        
32628>>>            Set Label To (left(t.calendar.Sunday,2))
32629>>>            //AB-StoreEnd
32629>>>
32629>>>        End_Object    // Textbox8
32630>>>
32630>>>        Object LineControl1 is a LineControl
32632>>>            Set Line_Style to lnSINGLE
32633>>>            Set Size to 1 116
32634>>>            Set Location to 28 4
32635>>>
32635>>>            //AB-StoreStart
32635>>>                                        
32635>>>            //AB-StoreEnd
32635>>>
32635>>>        End_Object    // LineControl1
32636>>>
32636>>>        Object Container3d2 is a Container3d
32638>>>            Set Size to 18 131
32639>>>            Set Location to 1 1
32640>>>            Set Color to clNavy
32641>>>            Set Border_Style to Border_None
32642>>>            Object oRght is a BitmapContainer
32644>>>                Set Size to 10 14
32645>>>                Set Location to 4 105
32646>>>                Set Bitmap to "rght.bmp"
32647>>>                Set Border_Style to Border_None
32648>>>
32648>>>                //AB-StoreStart
32648>>>                Procedure Mouse_Down
32650>>>                    Send Next_Month to Grid2
32651>>>                End_Procedure
32652>>>                //AB-StoreEnd
32652>>>
32652>>>            End_Object    // oRght
32653>>>
32653>>>            Object oLeft is a BitmapContainer
32655>>>                Set Size to 10 14
32656>>>                Set Location to 4 3
32657>>>                Set Bitmap to "lft.bmp"
32658>>>                Set Border_Style to Border_None
32659>>>
32659>>>                //AB-StoreStart
32659>>>                Procedure Mouse_Down
32661>>>                    Send Prev_Month to Grid2
32662>>>                End_Procedure
32663>>>                //AB-StoreEnd
32663>>>
32663>>>            End_Object    // oLeft
32664>>>
32664>>>            Object oMonth is a Textbox
32666>>>
32666>>>                //AB-StoreTopStart
32666>>>                Property integer piSelected_Month public 0
32668>>>                //AB-StoreTopEnd
32668>>>
32668>>>                Set Label to "January"
32669>>>                Set Auto_Size_State to FALSE
32670>>>                Set Transparent_State to TRUE
32671>>>                Set Color to clWhite
32672>>>                Set TextColor to clWhite
32673>>>                Set Location to 4 23
32674>>>                Set Size to 10 43
32675>>>                Set FontWeight to 800
32676>>>                Set Justification_Mode to jMode_Center
32677>>>
32677>>>                //AB-StoreStart
32677>>>                                    
32677>>>                Procedure Mouse_Down
32679>>>                    Integer iState
32680>>>                    Get Visible_State of oSelectYear to iState
32681>>>                    If (iState) Send OnKillFocus to oSelectYear
32684>>>                    Send Popup to oSelectMonth
32685>>>                End_Procedure
32686>>>                
32686>>>                Procedure pSelectJan
32688>>>                    Set Label to t.calendar.january
32689>>>                    Set piSelected_Month to 1
32690>>>                    Send Adjust_Calendar
32691>>>                End_Procedure
32692>>>                Procedure pSelectFeb
32694>>>                    Set Label to t.calendar.february
32695>>>                    Set piSelected_Month to 2
32696>>>                    Send Adjust_Calendar
32697>>>                End_Procedure
32698>>>                Procedure pSelectMar
32700>>>                    Set Label to t.calendar.march
32701>>>                    Set piSelected_Month to 3
32702>>>                    Send Adjust_Calendar
32703>>>                End_Procedure
32704>>>                Procedure pSelectApr
32706>>>                    Set Label to t.calendar.april
32707>>>                    Set piSelected_Month to 4
32708>>>                    Send Adjust_Calendar
32709>>>                End_Procedure
32710>>>                Procedure pSelectMay
32712>>>                    Set Label to t.calendar.may
32713>>>                    Set piSelected_Month to 5
32714>>>                    Send Adjust_Calendar
32715>>>                End_Procedure
32716>>>                Procedure pSelectJun
32718>>>                    Set Label to t.calendar.june
32719>>>                    Set piSelected_Month to 6
32720>>>                    Send Adjust_Calendar
32721>>>                End_Procedure
32722>>>                Procedure pSelectJul
32724>>>                    Set Label to t.calendar.july
32725>>>                    Set piSelected_Month to 7
32726>>>                    Send Adjust_Calendar
32727>>>                End_Procedure
32728>>>                Procedure pSelectAug
32730>>>                    Set Label to t.calendar.august
32731>>>                    Set piSelected_Month to 8
32732>>>                    Send Adjust_Calendar
32733>>>                End_Procedure
32734>>>                Procedure pSelectSep
32736>>>                    Set Label to t.calendar.september
32737>>>                    Set piSelected_Month to 9
32738>>>                    Send Adjust_Calendar
32739>>>                End_Procedure
32740>>>                Procedure pSelectOct
32742>>>                    Set Label to t.calendar.october
32743>>>                    Set piSelected_Month to 10
32744>>>                    Send Adjust_Calendar
32745>>>                End_Procedure
32746>>>                Procedure pSelectNov
32748>>>                    Set Label to t.calendar.november
32749>>>                    Set piSelected_Month to 11
32750>>>                    Send Adjust_Calendar
32751>>>                End_Procedure
32752>>>                Procedure pSelectDec
32754>>>                    Set Label to t.calendar.december
32755>>>                    Set piSelected_Month to 12
32756>>>                    Send Adjust_Calendar
32757>>>                End_Procedure
32758>>>                
32758>>>                Object oSelectMonth is a FloatingPopupMenu
32760>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32761>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32762>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32763>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32764>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32765>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32766>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32767>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32768>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32769>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32770>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32771>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32772>>>                End_Object
32773>>>                
32773>>>                Procedure Adjust_Calendar
32775>>>                    Date date#
32776>>>                    Integer iDay iMonth iYear iItm
32776>>>                    Set Visible_State to false
32777>>>                    Set Visible_State to true
32778>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32779>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32780>>>                    Get piSelected_Month to iMonth
32781>>>                    Get Label of oYear to iYear
32782>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32783>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32784>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32785>>>                End_Procedure
32786>>>                
32786>>>                Procedure Activating
32788>>>                    Forward Send Activating
32790>>>                    Send Date_Changing
32791>>>                End_Procedure
32792>>>                
32792>>>                Procedure Date_Changing
32794>>>                    Set Visible_State to false
32795>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32796>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32797>>>                    Set Visible_State to true
32798>>>                End_Procedure
32799>>>                
32799>>>                
32799>>>                //AB-StoreEnd
32799>>>
32799>>>            End_Object    // oMonth
32800>>>
32800>>>            Object oYear is a Textbox
32802>>>                Set Label to "2001"
32803>>>                Set Transparent_State to TRUE
32804>>>                Set Color to clWhite
32805>>>                Set TextColor to clWhite
32806>>>                Set Location to 4 77
32807>>>                Set Size to 10 18
32808>>>                Set FontWeight to 800
32809>>>
32809>>>                //AB-StoreStart
32809>>>                                                    
32809>>>                Procedure Mouse_Down
32811>>>                    String sVal
32812>>>                    Get Label to sVal
32813>>>                    Set Value of oSelectYear item 0 to sVal
32814>>>                    Set Visible_State of oSelectYear to True
32815>>>                    Send Activate to (oSelectYear(Self))
32816>>>                End_Procedure
32817>>>                
32817>>>                Procedure Activating
32819>>>                    Forward Send Activating
32821>>>                    Send Date_Changing
32822>>>                End_Procedure
32823>>>                
32823>>>                Procedure Date_Changing
32825>>>                    Set Visible_State to false
32826>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32827>>>                    Set Visible_State to true
32828>>>                End_Procedure
32829>>>                //AB-StoreEnd
32829>>>
32829>>>            End_Object    // oYear
32830>>>
32830>>>            Object oSelectYear is a Form
32832>>>
32832>>>                //AB-StoreTopStart
32832>>>                Set Visible_State To False
32833>>>                //AB-StoreTopEnd
32833>>>
32833>>>                Set Size to 10 24
32834>>>                Set Location to 4 75
32835>>>                Set Color to clWhite
32836>>>                Set TextColor to clNavy
32837>>>                Set Form_Border Item 0 to Border_Normal
32838>>>
32838>>>                //AB-StoreStart
32838>>>                                                    
32838>>>                On_Key Key_Enter Send OnKillFocus
32839>>>                On_Key Key_Escape Send OnKillFocus
32840>>>                
32840>>>                Procedure SetFontWeight
32842>>>                    Set Form_FontWeight item 0 to 800
32843>>>                End_Procedure
32844>>>                
32844>>>                Procedure OnKillFocus
32846>>>                    String sVal
32847>>>                    Integer iMonth iDay iYear iItm
32847>>>                    Date date#
32847>>>                    Get Value item 0 to sVal
32848>>>                    Set Visible_State of oYear to false
32849>>>                    Set Label of oYear to sVal
32850>>>                    Set Visible_State of oYear to true
32851>>>                    Set Visible_State to false
32852>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32853>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32854>>>                    Get piSelected_Month of oMonth to iMonth
32855>>>                    Get Value item 0 to iYear
32856>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32857>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32858>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32859>>>                End_Procedure
32860>>>                
32860>>>                Send SetFontWeight
32861>>>                //AB-StoreEnd
32861>>>
32861>>>            End_Object    // oSelectYear
32862>>>
32862>>>
32862>>>            //AB-StoreStart
32862>>>                            
32862>>>            Procedure Mouse_Down
32864>>>                Integer iState
32865>>>                Get Visible_State of oSelectYear to iState
32866>>>                If (iState) Send OnKillFocus to oSelectYear
32869>>>            End_Procedure
32870>>>            
32870>>>            //AB-StoreEnd
32870>>>
32870>>>        End_Object    // Container3d2
32871>>>
32871>>>
32871>>>        //AB-StoreStart
32871>>>                            
32871>>>        //AB-StoreEnd
32871>>>
32871>>>    End_Object    // Container3d1
32872>>>
32872>>>    Object BitmapContainer3 is a BitmapContainer
32874>>>        Set Size to 9 19
32875>>>        Set Location to 88 3
32876>>>        Set Color to clWhite
32877>>>        Set Bitmap to "cdate.bmp"
32878>>>        Set Border_Style to Border_None
32879>>>
32879>>>        //AB-StoreStart
32879>>>        Procedure Mouse_Down
32881>>>            Send go_today to (Grid2(Container3d1(Self)))
32882>>>            Send Adjust_Label to oToday
32883>>>        End_Procedure
32884>>>        //AB-StoreEnd
32884>>>
32884>>>    End_Object    // BitmapContainer3
32885>>>
32885>>>    Object oToday is a Textbox
32887>>>        Set Label to "Today: 01.01.2001"
32888>>>        Set Auto_Size_State to FALSE
32889>>>        Set Color to clWhite
32890>>>        Set Location to 88 22
32891>>>        Set Size to 8 73
32892>>>        Set FontWeight to 800
32893>>>
32893>>>        //AB-StoreStart
32893>>>        Procedure Mouse_Down
32895>>>            Send go_today to (Grid2(Container3d1(Self)))
32896>>>            Send Adjust_Label
32897>>>        End_Procedure
32898>>>        
32898>>>        Procedure Adjust_Label
32900>>>            date date#
32901>>>            SysDate4 date#
32902>>>            Set Visible_State To false
32903>>>            Set Label         to (t.calendar.today+": "+String(date#))
32904>>>            Set Visible_State To true
32905>>>        End_Procedure
32906>>>        
32906>>>        Procedure Activating
32908>>>            Forward Send Activating
32910>>>            Send Adjust_Label
32911>>>        End_Procedure
32912>>>        //AB-StoreEnd
32912>>>
32912>>>    End_Object    // oToday
32913>>>
32913>>>
32913>>>    //AB-StoreStart
32913>>>                
32913>>>    procedure popup
32915>>>        local integer focus# icItm iYear iMonth
32916>>>        local date date#
32916>>>        move (focus(desktop)) to focus#
32917>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32918>>>        get value of focus# item current to date#
32919>>>        ifnot (integer(date#)) sysdate date#
32922>>>        move (Date2to4(date#)) to date#
32923>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32924>>>        send fill_list to (Grid2(Container3d1(self)))
32925>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32926>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32927>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32928>>>        forward send popup
32930>>>    end_procedure
32931>>>    
32931>>>    Procedure Close_Calendar
32933>>>        Send Exit
32934>>>    End_Procedure
32935>>>    //AB-StoreEnd
32935>>>
32935>>>CD_End_Object    // oCalendar
32937>>>>
32937>>>
32937>>>
32937>>>//AB-StoreStart
32937>>>    
32937>>>    
32937>>>//AB-StoreEnd
32937>>>
32937>>>//AB/ End_Object    // prj
32937>Use Dates.Utl
32937>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
32937>>>// ===========================================================================
32937>>>//
32937>>>// The ROUND_NUMBER global function has been designed to return the rounded
32937>>>// value of a given 'numeric' argument at a specified rounding precision.
32937>>>//
32937>>>// ---------------------------------------------------------------------------
32937>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32937>>>// necessary calculations.  It uses a string handling technique instead.
32937>>>// ---------------------------------------------------------------------------
32937>>>//
32937>>>// The function requires two arguments, as follows:-
32937>>>//
32937>>>// (a) The numeric value to be rounded, where the range of valid values is
32937>>>//     +/- 99,999,999,999,999.99999999.
32937>>>//
32937>>>// (b) The rounding precision required.  This must be an integer value in the
32937>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32937>>>//     threshold value is substituted.
32937>>>//
32937>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32937>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32937>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32937>>>//     round progressively to the left of the decimal point (a frequent
32937>>>//     requirement in financial reporting).
32937>>>//
32937>>>// If the result of the rounding produces a value outside the valid numeric
32937>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32937>>>//
32937>>>// Assumptions:-  The only assumptions made have been that the range of
32937>>>// numeric values and the limit of eight decimal places are unlikely to change
32937>>>// in the forseeable future.
32937>>>//
32937>>>// Examples:-
32937>>>//
32937>>>//  1st Argument      2nd Argument   Return Value
32937>>>//  ------------      ------------   ------------
32937>>>//  123456.87654321         8         123456.87654321
32937>>>//  123456.87654321         2         123456.88
32937>>>// -123456.87654321         2        -123456.88
32937>>>//  123456.98765432         0         123457
32937>>>// -123456.98765432        -1        -123460
32937>>>//  123456.98765432        -2         123500
32937>>>//  123456.98765432        -3         123000
32937>>>//  987654                 -4         990000
32937>>>//  987654                 -5        1000000
32937>>>//  987654                 -6        1000000
32937>>>//  987654                 -7              0
32937>>>//
32937>>>// ===========================================================================
32937>>>
32937>>>
32937>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32938>>>
32938>>>  Local Number nAdj
32939>>>
32939>>>  Move 10000000000000 to nAdj
32940>>>
32940>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32940>>>
32940>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32943>>>
32943>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32943>>>
32943>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32946>>>
32946>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32946>>>
32946>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32947>>>
32947>>>End_Function
32948>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
32948>>>//AB/ Project Connect
32948>>>//AB/ Object prj is a Dialog_Project
32948>>>//AB/     Set ProjectName to "Connect"
32948>>>//AB/     Set ProjectFileName to "Connect.dg"
32948>>>
32948>>>// Project Object Structure
32948>>>//   Connect is a BasicPanelSub
32948>>>//     BitmapContainer1 is a BitmapContainerSub
32948>>>//     Textbox5 is a TextBoxSub
32948>>>//     ComboForm2 is a ComboFormSub
32948>>>//     Textbox6 is a TextBoxSub
32948>>>//     Form4 is a FormSub
32948>>>//     Textbox7 is a TextBoxSub
32948>>>//     Form5 is a FormSub
32948>>>//     Textbox8 is a TextBoxSub
32948>>>//     Form6 is a FormSub
32948>>>//     CheckBox1 is a CheckBoxSub
32948>>>//     oOK_bn is a ButtonSub
32948>>>//     oCancel_bn is a ButtonSub
32948>>>
32948>>>// Register all objects
32948>>>Register_Object BitmapContainer1
32948>>>Register_Object CheckBox1
32948>>>Register_Object ComboForm2
32948>>>Register_Object Connect
32948>>>Register_Object Form4
32948>>>Register_Object Form5
32948>>>Register_Object Form6
32948>>>Register_Object oCancel_bn
32948>>>Register_Object oOK_bn
32948>>>Register_Object Textbox5
32948>>>Register_Object Textbox6
32948>>>Register_Object Textbox7
32948>>>Register_Object Textbox8
32948>>>
32948>>>
32948>>>
32948>>>//AB-StoreTopStart
32948>>>
32948>>>///#INCLUDE
32948>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
32948>>>>>USE UI
32948>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
32948>>>>>// This command will issue a properly commands to define the FETCH attribute status
32948>>>>>// for file fields.
32948>>>>>//
32948>>>>>//------------------------------------------------------------------------------
32948>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SQL_FOR_ONEROW <file number>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
32948>>>>>// one ROW for each DataFlex FIND command issued
32948>>>>>// In this case the DBMS optimizer will generate a query with just one row
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------------------------------------------
32948>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
32948>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
32948>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
32948>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
32948>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------
32948>>>>>// SQL_SET <stmt>
32948>>>>>//
32948>>>>>//-----------------------------------------
32948>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
32948>>>>>//
32948>>>>>//------------
32948>>>>>// SQL_EXECUTE
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------
32948>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
32948>>>>>//
32948>>>>>// LOCK_TABLE will lock the entire table specified as an argument
32948>>>>>// This command will start a new transaction if it still wasn't done.
32948>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
32948>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
32948>>>>>// rows and then atualize their buffers
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------
32948>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
32948>>>>>//
32948>>>>>//-------------------------------
32948>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
32948>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
32948>>>>>//
32948>>>>>//-------------------------------------------------
32948>>>>>// OPEN_INT <DATAFLEX FILE NAME>
32948>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
32948>>>>>//
32948>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
32948>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
32948>>>>>// will issue a OPEN command
32948>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
32948>>>>>//
32948>>>>>//=========================================================================================================
32948>>>>>// SELECT STUFFS
32948>>>>>//--------------
32948>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
32948>>>>>//
32948>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
32948>>>>>//
32948>>>>>//
32948>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
32948>>>>>//
32948>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
32948>>>>>//
32948>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
32948>>>>>//
32948>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_COMMIT_STMT
32948>>>>>//
32948>>>>>// SQL_ROLLBACK_STMT
32948>>>>>//
32948>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
32948>>>>>//
32948>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------------------------------------------------------------------------------------
32948>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
32948>>>>>// Writes a message inside driver log trace file if this is activated
32948>>>>>//
32948>>>>>//-----------------------------------------------------
32948>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
32948>>>>>// Generating the INT file
32948>>>>>//
32948>>>>>// -----------------------
32948>>>>>// SQL_ERROR_MESSAGE <VAR>
32948>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
32948>>>>>
32948>>>>>
32948>>>>>//=======================================================================================
32948>>>>>// SQLFlex Commands
32948>>>>>//-----------------
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// SQLFlex_REVISION <VAR>
32948>>>>>// Retrieves SQLFlex revision
32948>>>>>//
32948>>>>>//-------------------------------------
32948>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
32948>>>>>// Sets current database
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// GET_DATABASE_NAME TO <VAR>
32948>>>>>// Gets name of current database
32948>>>>>//
32948>>>>>//----------------------------------
32948>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
32948>>>>>// Sets current schema name
32948>>>>>//
32948>>>>>//-------------------------
32948>>>>>// GET_SCHEMA_NAME TO <VAR>
32948>>>>>// Gets current schema name
32948>>>>>//
32948>>>>>//--------------------------------
32948>>>>>// SQL_USEDATABASE <DATABASE NAME>
32948>>>>>// Specifies the current Database
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// SET_CURRENT_SERVER TO <VAR>
32948>>>>>// Set the current logged server
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// GET_CURRENT_SERVER TO <VAR>
32948>>>>>// Retrieves the current logged server
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SET_HOST_NAME TO <HOST NAME>
32948>>>>>// Defines current host name
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// GET_HOST_NAME TO <VAR>
32948>>>>>// Retrieves the current host name
32948>>>>>//
32948>>>>>//---------------------------------------------------------------
32948>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
32948>>>>>// Specifies host name during login process
32948>>>>>//
32948>>>>>// SQL_CANCEL_QUERY_STMT
32948>>>>>//
32948>>>>>//========================================
32948>>>>>// SQL SERVER Stored Procedure Call engine
32948>>>>>//----------------------------------------
32948>>>>>//
32948>>>>>//
32948>>>>>
32948>>>>>//
32948>>>>>//--------------------------------------------------------------------------------------------------------------
32948>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
32948>>>>>//
32948>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
32948>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
32948>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// ORAFlex Commands
32948>>>>>//-----------------
32948>>>>>//----------------------------
32948>>>>>// ORAFlex_REVISION <VARIABLE>
32948>>>>>// Retrieves ORAFlex revision
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
32948>>>>>// Keeps all files opened even during a LOGOUT
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
32948>>>>>//
32948>>>>>//---------------------------------------------
32948>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the number of opened cursors
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
32948>>>>>// Activates Time stamp for date columns
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------------------------------------
32948>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// BUFFER save stuffs
32948>>>>>//-------------------
32948>>>>>
32948>>>>>//-------------------------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
32948>>>>>// Initialize the BUFFER buffer
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
32948>>>>>// Moves field buffer values to cache buffer
32948>>>>>//-------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
32948>>>>>// Save rows that remains in cache
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>
32948>>>//AB-StoreTopEnd
32948>>>
32948>>>//AB-IgnoreStart
32948>>>
32948>>>Use Panel.Sub
32948>>>Use Bitmap.Sub
32948>>>Use Txtbox.Sub
32948>>>Use Cmbfrm.Sub
32948>>>Use Form.Sub
32948>>>Use Chkbox.Sub
32948>>>Use Button.Sub
32948>>>
32948>>>
32948>>>//AB-IgnoreEnd
32948>>>
32948>>>Object Connect is a BasicPanelSub
32950>>>
32950>>>    //AB-StoreTopStart
32950>>>
32950>>>    //AB-StoreTopEnd
32950>>>
32950>>>    Set Sysmenu_Icon to FALSE
32951>>>    Set Minimize_Icon to FALSE
32952>>>    Set Label to "Login"
32953>>>    Set Size to 105 230
32954>>>    Set Location to 20 37
32955>>>
32955>>>    //AB-DDOStart
32955>>>
32955>>>
32955>>>    //AB-DDOEnd
32955>>>
32955>>>    Object BitmapContainer1 is a BitmapContainerSub
32957>>>        Set Size to 21 23
32958>>>        Set Location to 4 4
32959>>>        Set Bitmap to "Login1.bmp"
32960>>>        Set Border_Style to Border_None
32961>>>        Set Bitmap_Style to Bitmap_Center
32962>>>        Set Dialog_Caption to "Select a bitmap file"
32963>>>
32963>>>        //AB-StoreStart
32963>>>
32963>>>
32963>>>
32963>>>
32963>>>        //AB-StoreEnd
32963>>>
32963>>>    End_Object    // BitmapContainer1
32964>>>
32964>>>    Object Textbox5 is a TextBoxSub
32966>>>        Set Label to "Driver:"
32967>>>        Set FontSize to 4 0
32968>>>        Set Location to 6 34
32969>>>        Set Size to 13 40
32970>>>        Set TypeFace to "MS Sans Serif"
32971>>>        Set Enabled_State to TRUE
32972>>>    End_Object    // Textbox5
32973>>>
32973>>>    Object ComboForm2 is a ComboFormSub
32975>>>
32975>>>        //AB-StoreTopStart
32975>>>
32975>>>        Set CapsLock_State to True
32976>>>
32976>>>        //AB-StoreTopEnd
32976>>>
32976>>>        Set Size to 13 85
32977>>>        Set Location to 6 76
32978>>>        Set Label_Col_Offset to 2
32979>>>        Set Label_Justification_Mode to jMode_Right
32980>>>
32980>>>        //AB-StoreStart
32980>>>        Procedure Combo_Fill_List
32982>>>                Local String Availdrv## TempDrv##
32983>>>                Local Integer HowMany i p1## p2##
32983>>>
32983>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
32986>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
32989>>>                insert "WorkSpaces\" in AvailDrv## at 1
32991>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
32994>>>
32994>>>                Move Availdrv## to Tempdrv##
32995>>>                Repeat
32995>>>>
32995>>>                    Replace "|" in Tempdrv## With ""
32997>>>                    [Found] Increment HowMany
32998>>>                Until [Finderr]
33000>>>
33000>>>                Send Combo_add_Item ""
33001>>>
33001>>>                If HowMany lt 1 Begin
33003>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33006>>>                End
33006>>>>
33006>>>                Else Begin
33007>>>                    For i From 0 to HowMany
33013>>>>
33013>>>                        If i eq 0 Move 1 to p1##
33016>>>                        Else Begin
33017>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33018>>>                            Replace "|" in Availdrv## With ","
33020>>>                        End
33020>>>>
33020>>>                        Move ((Pos("|",Availdrv##))) to p2##
33021>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33022>>>                    Loop
33023>>>>
33023>>>                End
33023>>>>
33023>>>        End_Procedure
33024>>>
33024>>>        Set Allow_Blank_state to True
33025>>>
33025>>>
33025>>>
33025>>>        //AB-StoreEnd
33025>>>
33025>>>    End_Object    // ComboForm2
33026>>>
33026>>>    Object Textbox6 is a TextBoxSub
33028>>>        Set Label to "Server:"
33029>>>        Set FontSize to 4 0
33030>>>        Set Location to 22 34
33031>>>        Set Size to 13 40
33032>>>        Set TypeFace to "MS Sans Serif"
33033>>>        Set Enabled_State to TRUE
33034>>>    End_Object    // Textbox6
33035>>>
33035>>>    Object Form4 is a FormSub
33037>>>        Set Size to 13 93
33038>>>        Set Location to 22 76
33039>>>        Set Label_Col_Offset to 2
33040>>>        Set Label_Justification_Mode to jMode_Right
33041>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33042>>>    End_Object    // Form4
33043>>>
33043>>>    Object Textbox7 is a TextBoxSub
33045>>>        Set Label to "User Name:"
33046>>>        Set FontSize to 4 0
33047>>>        Set Location to 38 34
33048>>>        Set Size to 13 40
33049>>>        Set TypeFace to "MS Sans Serif"
33050>>>        Set Enabled_State to TRUE
33051>>>    End_Object    // Textbox7
33052>>>
33052>>>    Object Form5 is a FormSub
33054>>>        Set Size to 13 93
33055>>>        Set Location to 38 76
33056>>>        Set Label_Col_Offset to 2
33057>>>        Set Label_Justification_Mode to jMode_Right
33058>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33059>>>    End_Object    // Form5
33060>>>
33060>>>    Object Textbox8 is a TextBoxSub
33062>>>        Set Label to "Password:"
33063>>>        Set FontSize to 4 0
33064>>>        Set Location to 54 34
33065>>>        Set Size to 13 40
33066>>>        Set TypeFace to "MS Sans Serif"
33067>>>        Set Enabled_State to TRUE
33068>>>    End_Object    // Textbox8
33069>>>
33069>>>    Object Form6 is a FormSub
33071>>>        Set Size to 13 93
33072>>>        Set Location to 54 76
33073>>>        Set Label_Col_Offset to 2
33074>>>        Set Label_Justification_Mode to jMode_Right
33075>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33076>>>
33076>>>        //AB-StoreStart
33076>>>        Set Password_State Item 0 to True
33077>>>
33077>>>        //AB-StoreEnd
33077>>>
33077>>>    End_Object    // Form6
33078>>>
33078>>>    Object CheckBox1 is a CheckBoxSub
33080>>>        Set Label to "Save Password"
33081>>>        Set Size to 10 66
33082>>>        Set Location to 73 76
33083>>>        Set Status_Help to "Remember The Password at Next Login"
33084>>>    End_Object    // CheckBox1
33085>>>
33085>>>    Object oOK_bn is a ButtonSub
33087>>>        Set Label to "Co&nnect"
33088>>>        Set Default_State to TRUE
33089>>>        Set Bitmap to "mcr.bmp"
33090>>>        Set Size to 28 33
33091>>>        Set Location to 9 184
33092>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33093>>>
33093>>>        //AB-StoreStart
33093>>>        Procedure OnClick
33095>>>            Set LoginOk to True
33096>>>            Send Stop_Modal_ui
33097>>>        End_Procedure
33098>>>        Set Status_Help to "Connect"
33099>>>        //AB-StoreEnd
33099>>>
33099>>>    End_Object    // oOK_bn
33100>>>
33100>>>    Object oCancel_bn is a ButtonSub
33102>>>        Set Label to "&Cancel"
33103>>>        Set Bitmap to "exit2.bmp"
33104>>>        Set Size to 28 32
33105>>>        Set Location to 39 184
33106>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33107>>>
33107>>>        //AB-StoreStart
33107>>>
33107>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33108>>>
33108>>>        Procedure OnClick
33110>>>            Set LoginOk to False
33111>>>            Send Exit_Application to (Connect(Current_Object))
33112>>>        End_Procedure
33113>>>
33113>>>        Set Status_Help to "Close Application"
33114>>>
33114>>>
33114>>>        //AB-StoreEnd
33114>>>
33114>>>    End_Object    // oCancel_bn
33115>>>
33115>>>
33115>>>    //AB-StoreStart
33115>>>
33115>>>    Set Modal_State to True
33116>>>
33116>>>    // Now is WorkspaceAware
33116>>>
33116>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33117>>>    ON_KEY KSAVE_RECORD SEND OK
33118>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33119>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33120>>>
33120>>>    Set Locate_Mode to Center_On_Screen
33121>>>    Set Exit_Application_Local_State to False
33122>>>    Set Exit_MSG to Exit
33123>>>    Set Description_State to True
33124>>>
33124>>>    Property Integer LoginOk public false
33126>>>
33126>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33127>>>
33127>>>    Function Network_User_Name Returns String
33129>>>        Local String sName sLength
33130>>>        Local Pointer lpName_Addr lpLength_Addr
33130>>>        Local Integer iRetval
33130>>>
33130>>>        Movestr (Repeat (Character (0), 255)) To sName
33131>>>>
33131>>>        GetAddress Of sName To lpName_Addr
33132>>>        Movestr (DwordToBytes (255)) To sLength
33133>>>>
33133>>>        GetAddress Of sLength To lpLength_Addr
33134>>>
33134>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33135>>>>
33135>>>
33135>>>        If iRetval Eq 0 Function_Return (CString (sName))
33138>>>        Else Function_Return "User Unknown"
33140>>>    End_Function // Network_User_Name
33141>>>
33141>>>    Function fsCrypto String lsWay String lsOld Returns String
33143>>>        Local String lsNew lsTemp
33144>>>        Local Integer liCount
33144>>>           For liCount From 1 to (Length(lsOld))
33150>>>>
33150>>>               Mid lsOld to lsTemp 1 liCount
33153>>>>
33153>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33155>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33158>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33160>>>               End
33160>>>>
33160>>>               Else Begin
33161>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33163>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33166>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33168>>>                   End
33168>>>>
33168>>>               End
33168>>>>
33168>>>               Append lsNew lsTemp
33169>>>           Loop
33170>>>>
33170>>>        Function_Return (lsNew)
33171>>>    End_Function
33172>>>
33172>>>    Procedure Activating
33174>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33175>>>        Local String LastLogin## LoginSeq##
33175>>>        Local Integer SavePassword##
33175>>>
33175>>>        Forward Send Activating
33177>>>
33177>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33180>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33183>>>        insert "WorkSpaces\" in LastLogin## at 1
33185>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33188>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33191>>>
33191>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33194>>>        Else Move LoginSeq## to LoginDriver##
33196>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33199>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33202>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33205>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33208>>>
33208>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33210>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33211>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33212>>>        End
33212>>>>
33212>>>        Else Begin
33213>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33214>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33215>>>        End
33215>>>>
33215>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33216>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33217>>>        If (SavePassword##) Begin
33219>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33220>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33224>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33225>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33226>>>        End
33226>>>>
33226>>>    End_Procedure
33227>>>
33227>>>    Function LoginUser Returns Integer
33229>>>        Integer SavePassword## Size## PasswordOk
33230>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33230>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33230>>>        Integer liOpenCursors
33230>>>
33230>>>        Send Popup_Modal
33231>>>
33231>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33232>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33233>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33234>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33235>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33236>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33237>>>
33237>>>    //tolis 03/02/2004
33237>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33239>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33239>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33239>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33239>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33239>>>    //        send trap_error to (error_info_object(current_object)) 25000
33239>>>    //        send trap_error to (error_info_object(current_object)) 4255
33239>>>    //        send trap_error to (error_info_object(current_object)) 12293
33239>>>    //        If LastErr eq 25000 Begin
33239>>>    //            Error LastErr "Invalid Login Information"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 4255 Begin
33239>>>    //            Error LastErr "Invalid Driver Name"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 12293 Begin
33239>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33239>>>    //            Set LoginOk to False
33239>>>    //           Send Exit_Application
33239>>>    //      End
33239>>>            Set LoginOk to True
33240>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33240>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33240>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33240>>>    //        End
33240>>>        End
33240>>>>
33240>>>        Else Begin
33241>>>            Set LoginOk to True
33242>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33244>>>            Move "DATAFLEX" To LoginDriver##
33245>>>            Move "" to LoginServer##
33246>>>            File_Size Users to Size##
33249>>>            If Size## ne 0 Begin
33251>>>                 Clear Users
33252>>>                 Move LoginUSerId##   to Users.Login_Id
33253>>>                 Find eq Users by Index.1
33254>>>>
33254>>>                 [Finderr] Begin
33256>>>>
33256>>>                    Error 25000 "Unknown User"
33257>>>>
33257>>>                    Set LoginOk to False
33258>>>                    Get LoginOk to PasswordOk
33259>>>                    Function_Return PasswordOk
33260>>>                 End
33260>>>>
33260>>>                 [Found] Begin
33262>>>>
33262>>>                    If (LoginPassword## ne Users.Password) Begin
33264>>>                        Error 25000 "Invalid Password"
33265>>>>
33265>>>                        Set LoginOk to False
33266>>>                        Get LoginOk to PasswordOk
33267>>>                        Function_Return PasswordOk
33268>>>                    End
33268>>>>
33268>>>                    Else Move Users.Departm_Code to sDepartment
33270>>>                    Move (Trim(sDepartment)) to sDepartment
33271>>>                 End
33271>>>>
33271>>>            End
33271>>>>
33271>>>            Close Users
33272>>>
33272>>>
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>    //            Integer bFileExists
33272>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>    //            If (NOT(bFileExists)) Begin
33272>>>
33272>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33272>>>    //                If (bFileExists) Begin
33272>>>
33272>>>    ////                        If Size## ne 0 Begin
33272>>>
33272>>>    //                            Local String ss1 ss2 ss3 ss4
33272>>>    //                            Local String dd1 dd2 dd3 dd4
33272>>>    //                            Move '' to dd1
33272>>>    //                            Move '' to dd2
33272>>>    //                            Move '' to dd3
33272>>>    //                            Move '' to dd4
33272>>>
33272>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33272>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            While (Not(Seqeof))
33272>>>    //                                Move (Trim(ss1)) to ss1
33272>>>    //                                Move (Trim(ss2)) to ss2
33272>>>    //                                Move (Trim(ss3)) to ss3
33272>>>    //                                Move (Trim(ss4)) to ss4
33272>>>    //                                Append dd1 '"' ss1 '"'
33272>>>    //                                Append dd2 '"' ss2 '"'
33272>>>    //                                Append dd3 '"' ss3 '"'
33272>>>    //                                Append dd4 '"' ss4 '"'
33272>>>    //                                Login dd1 dd2 dd3 dd4
33272>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            Loop
33272>>>
33272>>>
33272>>>    ////                            // Only Filmnet Users Log on to SQL
33272>>>    ////                            If (sDepartment='FILMNET') Begin
33272>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33272>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            End
33272>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33272>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>
33272>>>    ////                        End
33272>>>    ////                        Else Begin
33272>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33272>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                        End
33272>>>
33272>>>
33272>>>    //                End
33272>>>
33272>>>    //            End
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>            //*Integer bFileExists
33272>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>            //*If (NOT(bFileExists)) Begin
33272>>>            //*    If Size## ne 0 Begin
33272>>>            //*        // Only Filmnet Users Log on to SQL
33272>>>            //*        If (sDepartment='FILMNET') Begin
33272>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*        End
33272>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*    End
33272>>>            //*    Else Begin
33272>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*    End
33272>>>            //*
33272>>>            //*End
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>        End
33272>>>>
33272>>>
33272>>>        Open Users
33274>>>        //Open "Users" as Users
33274>>>        File_Size Users to Size##
33277>>>        If Size## ne 0 Begin
33279>>>             Clear Users
33280>>>             Move LoginUSerId##   to Users.Login_Id
33281>>>             Find eq Users by Index.1
33282>>>>
33282>>>             [Finderr] Begin
33284>>>>
33284>>>                Error 25000 "Unknown User"
33285>>>>
33285>>>                Set LoginOk to False
33286>>>                Get LoginOk to PasswordOk
33287>>>                Function_Return PasswordOk
33288>>>             End
33288>>>>
33288>>>             [Found] Begin
33290>>>>
33290>>>                If (LoginPassword## ne Users.Password) Begin
33292>>>                    Error 25000 "Invalid Password"
33293>>>>
33293>>>                    Set LoginOk to False
33294>>>                    Get LoginOk to PasswordOk
33295>>>                    Function_Return PasswordOk
33296>>>                End
33296>>>>
33296>>>                Else Move Users.Departm_Code to sDepartment
33298>>>                Move (Trim(sDepartment)) to sDepartment
33299>>>             End
33299>>>>
33299>>>        End
33299>>>>
33299>>>        Close Users
33300>>>
33300>>>        Get LoginOk to PasswordOk
33301>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33305>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33308>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33311>>>        insert "WorkSpaces\" in LastLogin## at 1
33313>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33316>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33318>>>           If Not LoginDriver## in LoginSeq## Begin
33320>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33323>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33325>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33328>>>           End
33328>>>>
33328>>>        End
33328>>>>
33328>>>        Append LastLogin## "\" (Module_Name(Self))
33330>>>        Append LastLogin## "\LastLogin"
33331>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33334>>>
33334>>>        If "|" in LoginSeq## Begin
33336>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33340>>>        End
33340>>>>
33340>>>        Else Begin
33341>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33344>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33349>>>        End
33349>>>>
33349>>>        Left LoginSeq## to LoginSeq## 250
33351>>>>
33351>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33354>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33357>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33360>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33363>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33367>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33371>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33375>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33381>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33384>>>        If (SavePassword##) Begin
33386>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33387>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33390>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33391>>>        End
33391>>>>
33391>>>        Else Begin
33392>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33393>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33396>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33397>>>        End
33397>>>>
33397>>>
33397>>>        Function_Return PasswordOk
33398>>>    End_Function
33399>>>
33399>>>    Procedure Login For Desktop
33400>>>        Local Integer LoginPassword##
33401>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33402>>>        If Not LoginPassword## Send Exit_Application
33405>>>    End_Procedure
33406>>>
33406>>>    Function CheckLogin For Desktop Returns Integer
33407>>>        Local Integer LoginPassword##
33408>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33409>>>        Function_Return LoginPassword##
33410>>>    End_Function
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>    //AB-StoreEnd
33411>>>
33411>>>End_Object    // Connect
33412>>>
33412>>>
33412>>>//AB-StoreStart
33412>>>
33412>>>
33412>>>
33412>>>//AB-StoreEnd
33412>>>
33412>>>//AB/ End_Object    // prj
33412>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33412>>>
33412>>>
33412>>>Function Check_Afm Global String Afm_Num Returns Integer
33413>>>    Integer iii Num1 Num2
33414>>>
33414>>>    Move (Trim(Afm_Num)) To Afm_Num
33415>>>
33415>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33421>>>>
33421>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33424>>>    Loop
33425>>>>
33425>>>
33425>>>    Move (Right(Afm_Num,1)) to Num2
33426>>>
33426>>>    If (Length(Afm_Num)<>9) Function_Return 2
33429>>>
33429>>>    Move 0 to Num1
33430>>>
33430>>>    For iii From 1 to 8
33436>>>>
33436>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33437>>>    Loop
33438>>>>
33438>>>
33438>>>    Move (Mod(Num1,11)) to Num1
33439>>>    If (Num1=10) Move 0 to Num1
33442>>>
33442>>>    If (Num1=Num2)  Function_Return 0
33445>>>    Else            Function_Return 1
33447>>>End_Function
33448>>>
33448>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33448>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33450>>>open syscurxr
33452>>>open gplan
INCLUDING FILE: GPLAN.FD
33454>>>//open gplanl
33454>>>open iteml
INCLUDING FILE: ITEML.FD
33456>>>open cn
INCLUDING FILE: CN.FD
33458>>>open payresp
INCLUDING FILE: PAYRESP.FD
33460>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33462>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33464>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33466>>>open clients
INCLUDING FILE: CLIENTS.FD
33468>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33470>>>open wax
INCLUDING FILE: WAX.FD
33472>>>Function Check_log Global String slog Returns Integer
33473>>>    clear gplan
33474>>>    move syscurxr.company_code to gplan.company_code
33475>>>    move syscurxr.branch_code  to gplan.branch_code
33476>>>    move syscurxr.year_year    to gplan.year_year
33477>>>    move slog                  to gplan.gplan_code
33478>>>    find eq gplan by index.1
33479>>>>
33479>>>    if (found=1) function_return 0
33482>>>    else         function_return 1
33484>>>
33484>>>End_Function
33485>>>
33485>>>Function Check_last Global String slog Returns Integer
33486>>>    clear gplan
33487>>>    move syscurxr.company_code to gplan.company_code
33488>>>    move syscurxr.branch_code  to gplan.branch_code
33489>>>    move syscurxr.year_year    to gplan.year_year
33490>>>    move slog                  to gplan.gplan_code
33491>>>    find eq gplan by index.1
33492>>>>
33492>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33495>>>    else                                         Function_return 1
33497>>>
33497>>>End_Function
33498>>>
33498>>>Function fsgplandescr String slog Returns string
33499>>>    clear gplan
33500>>>    move syscurgl.company_code to gplan.company_code
33501>>>    move syscurgl.branch_code  to gplan.branch_code
33502>>>    move syscurgl.year_year    to gplan.year_year
33503>>>    move slog                  to gplan.gplan_code
33504>>>    find eq gplan by index.1
33505>>>>
33505>>>    if (found=1) function_return gplan.gplan_descr1
33508>>>    else         function_return ''
33510>>>
33510>>>End_Function
33511>>>
33511>>>//Function fsgplanperi String slog Returns string
33511>>>//    string sdescr
33511>>>//    clear gplanl
33511>>>//    move syscurgl.company_code to  gplanl.company_code
33511>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33511>>>//    move slog                  to  gplanl.gplan_code
33511>>>//    find eq gplanl by index.1
33511>>>//    if (found=1) begin
33511>>>//        move gplanl.gplan_descr1 to sdescr
33511>>>//        function_return sdescr
33511>>>//    end
33511>>>//    else         function_return ''
33511>>>//End_Function
33511>>>
33511>>>
33511>>>
33511>>>Function fsclient string code Returns string
33512>>>    string name
33513>>>    clear clients
33514>>>    move code to clients.client_id
33515>>>    find eq clients by index.6
33516>>>>
33516>>>    if (found) move clients.client_name to name
33519>>>    else       move '' to name
33521>>>    function_return name
33522>>>end_Function
33523>>>
33523>>>Function fspayresp string code Returns string
33524>>>    string name
33525>>>    clear payresp
33526>>>    move code to payresp.presp_id
33527>>>    find eq payresp by index.7
33528>>>>
33528>>>    if (found) move payresp.presp_name to name
33531>>>    else       move '' to name
33533>>>    function_return name
33534>>>end_Function
33535>>>
33535>>>Function fssalesmen string code Returns string
33536>>>    string name
33537>>>    clear salesmen
33538>>>    move code to salesmen.sls_id
33539>>>    find eq salesmen by index.4
33540>>>>
33540>>>    if (found) move salesmen.sls_name to name
33543>>>    else       move '' to name
33545>>>    function_return name
33546>>>end_Function
33547>>>
33547>>>Function fsconstrct string code Returns string
33548>>>    string name
33549>>>    clear constrct
33550>>>    move code to constrct.cnt_id
33551>>>    find eq constrct by index.5
33552>>>>
33552>>>    if (found) move constrct.cnt_name to name
33555>>>    else       move '' to name
33557>>>    function_return name
33558>>>end_Function
33559>>>
33559>>>Function fsmhxanik string code Returns string
33560>>>    string name
33561>>>    clear mhxanik
33562>>>    move code to mhxanik.mhx_id
33563>>>    find eq mhxanik by index.4
33564>>>>
33564>>>    if (found) move mhxanik.mhx_name to name
33567>>>    else       move '' to name
33569>>>    function_return name
33570>>>end_Function
33571>>>
33571>>>
33571>>>Function fsptyppar string code Returns string
33572>>>    string sdescr
33573>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33574>>>    move syscurxr.company_code to ptypparl.company_code
33575>>>    move syscurxr.branch_code  to ptypparl.branch_code
33576>>> //   move syscurxr.year_year    to ptypparl.year_year
33576>>>    move code                  to ptypparl.ptyppar_code
33577>>>    find eq ptypparl by index.1
33578>>>>
33578>>>    move ptypparl.ptyppar_descr to sdescr
33579>>>    function_return sdescr
33580>>>end_Function
33581>>>
33581>>>Function fsgplan string code Returns string
33582>>>    string sdescr
33583>>>    clear gplan
33584>>>    move syscurxr.company_code to gplan.company_code
33585>>>    move syscurxr.branch_code  to gplan.branch_code
33586>>>    move syscurxr.year_year    to gplan.year_year
33587>>>    move code                  to gplan.gplan_code
33588>>>    find eq gplan by index.1
33589>>>>
33589>>>    move gplan.gplan_descr1    to sdescr
33590>>>    function_return sdescr
33591>>>end_Function
33592>>>
33592>>>Function fsitem string scode Returns string
33593>>>    clear iteml
33594>>>    move scode to iteml.item_code
33595>>>    find eq iteml by index.5
33596>>>>
33596>>>    function_return iteml.item_descr
33597>>>end_Function
33598>>>
33598>>>Function fswax string srecr Returns string
33599>>>    clear wax
33600>>>    move srecr to wax.wax_recr
33601>>>    find eq wax by index.2
33602>>>>
33602>>>    function_return wax.wax_descr
33603>>>end_Function
33604>>>
33604>>>
33604>>>Function fswitemx string code Returns string
33605>>>    string name
33606>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33607>>>    move syscurxr.company_code to witemx.company_code
33608>>>    move syscurxr.branch_code  to witemx.branch_code
33609>>>    move syscurxr.year_year    to witemx.year_year
33610>>>    move code to witemx.witemx_code
33611>>>    find eq witemx by index.5
33612>>>>
33612>>>    move witemx.witemx_descr to name
33613>>>    function_return name
33614>>>end_Function
33615>>>
33615>>>Function fsCNDescr String asItem Returns String
33616>>>    Clear CN
33617>>>    move asItem to CN.CN_Code
33618>>>    Find Eq CN by Index.5
33619>>>>
33619>>>    Function_Return CN.CN_Descr
33620>>>End_Function
33621>>>
33621>>>Function fswtypkin String askin Returns String
33622>>>    Clear Wtypkin
33623>>>    move askin to Wtypkin.wtypkin_code
33624>>>    Find Eq wtypkin by Index.1
33625>>>>
33625>>>    Function_Return Wtypkin.wtypkin_descr
33626>>>End_Function
33627>>>
33627>>>Function FindGtypkinDescr Integer aiCode Returns String
33628>>>    String lsDescr
33629>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33630>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33631>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33632>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33633>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33634>>>    Find eq Gtypkin by Index.1
33635>>>>
33635>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33636>>>    Function_Return lsDescr
33637>>>End_Function // FindGtypkinDescr
33638>>>
33638>>>Function FindBtypkinDescr Integer aiCode Returns String
33639>>>    String lsDescr
33640>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33641>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33642>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33643>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33644>>>    Move aiCode                   to Btypkin.btypkin_Code
33645>>>    Find eq Btypkin by Index.1
33646>>>>
33646>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33647>>>    Function_Return lsDescr
33648>>>End_Function // FindGtypkinDescr
33649>>>
33649>>>
33649>Send Login
33650>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
33650>>>// Statement of purpose:
33650>>>// When using a reread command in VDF you will unfortunately lock many more
33650>>>// files than are necessary.  In order to only lock the files necessary I
33650>>>// use the following procedure to set all files to readonly, manually set
33650>>>// the files being worked on to (default) and then reset all back at the end.
33650>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
33650>>>
33650>>>// The original package is a contribution of another programmer whom I cannot
33650>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
33650>>>// with a non-default filemode will be set back to it's previous setting.
33650>>>
33650>>>Object FileModeArray Is An Array
33652>>>    // 0 = File Number
33652>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
33652>>>End_Object
33653>>>
33653>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
33654>>>    Integer iCounter hArray iExists
33655>>>    Move (FileModeArray(Self)) To hArray
33656>>>    For iCounter From 0 To 1000
33662>>>>
33662>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33663>>>        If (Not(iExists) Or (iExists = iFile)) Begin
33665>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
33666>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
33667>>>        End
33667>>>>
33667>>>        If (Not(iExists) Or (iExists = iFile)) Break
33670>>>    Loop
33671>>>>
33671>>>End_Procedure
33672>>>
33672>>>Procedure Clear_FileModeArray
33673>>>    Send Delete_Data To (FileModeArray(Self))
33674>>>End_Procedure
33675>>>
33675>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
33676>>>    Integer iCounter iExists iNonStandardFileMode hArray
33677>>>    Move (FileModeArray(Self)) To hArray
33678>>>    For iCounter From 0 To 1000
33684>>>>
33684>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33685>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
33688>>>        If (iExists = iFile) Begin
33690>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
33691>>>            Function_Return iNonStandardFileMode
33692>>>        End
33692>>>>
33692>>>    Loop
33693>>>>
33693>>>    Function_Return
33694>>>End_Function
33695>>>
33695>>>Procedure ChangeAllFileModes Integer iMode
33696>>>    Integer iFile iExistingFileMode iNonStandardFileMode
33697>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
33700>>>    Repeat
33700>>>>
33700>>>        // Get Each Opened File, One At A Time...
33700>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
33703>>>        If (Not(iFile)) Break
33706>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
33708>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
33711>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
33714>>>        End
33714>>>>
33714>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
33716>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
33717>>>        End
33717>>>>
33717>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
33722>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
33726>>>    Loop
33727>>>>
33727>>>End_Procedure
33728>>>
33728>>>// // Comment: Example Of Usage:
33728>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
33728>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
33728>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
33728>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
33728>>>//    Indicate Err False
33728>>>//    Begin_Transaction
33728>>>//
33728>>>//        Clear MyFile1
33728>>>//        Move 1 To MyFile1.Key
33728>>>//        Find EQ MyFile1 By Index.1
33728>>>//        Relate MyFile1
33728>>>//        Add MyFile2.Amount To MyFile1.Amount
33728>>>//        Saverecord MyFile1
33728>>>//        Saverecord MyFile2
33728>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
33728>>>//
33728>>>//    End_Transaction
33728>>>//    If (Err) Begin
33728>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
33728>>>//    End
33728>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
INCLUDING FILE: XRHSH.PKG
33728>>//------------------------------
33728>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33728>>>>//AB/ Project Select / Change Xrhsh
33728>>>>//AB/ Object prj is a Dialog_Project
33728>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33728>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33728>>>>
33728>>>>// Project Object Structure
33728>>>>//   oSelectYear is a dbModalPanelSub
33728>>>>//     Company_DD is a DataDictionary
33728>>>>//     Branch_DD is a DataDictionary
33728>>>>//     Year_DD is a DataDictionary
33728>>>>//     Company_Company_Code is a dbFormSub
33728>>>>//     Company_Company_Name is a dbFormSub
33728>>>>//     Branch_Branch_Code is a dbFormSub
33728>>>>//     Branch_Branch_Name is a dbFormSub
33728>>>>//     Year_Year_Year is a dbFormSub
33728>>>>//     Year_Year_Descr is a dbFormSub
33728>>>>//     Year_Year_Entrydate is a dbFormSub
33728>>>>//     oOk_bn is a ButtonSub
33728>>>>//     oCancel_bn is a ButtonSub
33728>>>>//     otxtCompany is a TextBoxSub
33728>>>>//     otxtBranch is a TextBoxSub
33728>>>>//     otxtYear is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     chkxr is a CheckBoxSub
33728>>>>
33728>>>>// Register all objects
33728>>>>Register_Object Branch_Branch_Code
33728>>>>Register_Object Branch_Branch_Name
33728>>>>Register_Object Branch_DD
33728>>>>Register_Object Company_Company_Code
33728>>>>Register_Object Company_Company_Name
33728>>>>Register_Object Company_DD
33728>>>>Register_Object chkxr
33728>>>>Register_Object oCancel_bn
33728>>>>Register_Object oOk_bn
33728>>>>Register_Object oSelectYear
33728>>>>Register_Object otxtBranch
33728>>>>Register_Object otxtCompany
33728>>>>Register_Object otxtWorkingDay
33728>>>>Register_Object otxtYear
33728>>>>Register_Object Year_DD
33728>>>>Register_Object Year_Year_Descr
33728>>>>Register_Object Year_Year_Entrydate
33728>>>>Register_Object Year_Year_Year
33728>>>>
33728>>>>
33728>>>>
33728>>>>//AB-StoreTopStart
33728>>>>
33728>>>>
33728>>>>
33728>>>>
33728>>>>       String  gs_selected_beto_site
33728>>>>
33728>>>>Open SysCurXR
33730>>>>Open Nomisma
33732>>>>
33732>>>>//AB-StoreTopEnd
33732>>>>
33732>>>>//AB-IgnoreStart
33732>>>>
33732>>>>Use DFAllEnt.pkg
33732>>>>Use dbForm.Sub
33732>>>>Use Button.Sub
33732>>>>Use Txtbox.Sub
33732>>>>Use Chkbox.Sub
33732>>>>
33732>>>>
33732>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33732>>>>>>//DDB-FileStart
33732>>>>>>//DDB-HeaderStart
33732>>>>>>
33732>>>>>>// File Name : COMPANY.DD
33732>>>>>>// Class Name: Company_DataDictionary
33732>>>>>>// Revision  : 62
33732>>>>>>// Version   : 2
33732>>>>>>
33732>>>>>>Use  Windows           // Basic Definitions
33732>>>>>>Use  DataDict          // DataDictionary Class Definition
33732>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33732>>>>>>
33732>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33734>>>>>>Open Branch
33736>>>>>>
33736>>>>>>//DDB-HeaderEnd
33736>>>>>>//DDB-ValidationStart
33736>>>>>>
33736>>>>>>Register_Object Company_Company_Doy_VT
33736>>>>>>Register_Object Company_Company_J_Code_VT
33736>>>>>>
33736>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33738>>>>>>    Set Type_Value        To "DOY"
33739>>>>>>    Set Allow_Blank_State To TRUE
33740>>>>>>    //DDB-ValidationCustomStart
33740>>>>>>    //DDB-ValidationCustomEnd
33740>>>>>>End_Object   // Company_Company_Doy_VT
33741>>>>>>
33741>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33743>>>>>>    Set Type_Value        To "JOB"
33744>>>>>>    Set Allow_Blank_State To TRUE
33745>>>>>>    //DDB-ValidationCustomStart
33745>>>>>>    //DDB-ValidationCustomEnd
33745>>>>>>End_Object   // Company_Company_J_Code_VT
33746>>>>>>//DDB-ValidationEnd
33746>>>>>>//DDB-SelectionStart
33746>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33746>>>>>>Register_Object sl001
33746>>>>>>//DDB-SelectionEnd
33746>>>>>> 
33746>>>>>>Class Company_DataDictionary  is a DataDictionary
33747>>>>>> 
33747>>>>>>    // Update:
33747>>>>>> 
33747>>>>>>    Procedure Update
33748>>>>>>        Forward Send Update
33750>>>>>>        move 'DOY' to company.doy_type
33751>>>>>>        move 'JOB' to company.jcode_type 
33752>>>>>>        // Insert Code Here
33752>>>>>>    End_Procedure   // Update
33753>>>>>> 
33753>>>>>>
33753>>>>>>    // Operation_Not_Allowed:
33753>>>>>>
33753>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33754>>>>>>        // Insert Code Here
33754>>>>>>        Case Begin
33754>>>>>>             Case (iError_Num = 1001)
33756>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33757>>>>>>>
33757>>>>>>             Case Break
33758>>>>>>
33758>>>>>>             Case Else
33758>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33760>>>>>>        Case End
33760>>>>>>    End_Procedure   // Operation_Not_Allowed
33761>>>>>>
33761>>>>>>
33761>>>>>>    // Validate_Save:
33761>>>>>>
33761>>>>>>    Function Validate_Save  Returns Integer
33762>>>>>>        Local Integer iReturnVal
33763>>>>>>        Forward Get Validate_Save  To iReturnVal
33765>>>>>>        If (Not(iReturnVal)) Begin
33767>>>>>>            // Insert Code Here
33767>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33770>>>>>>        End
33770>>>>>>>
33770>>>>>>        Function_Return iReturnVal
33771>>>>>>    End_Function   // Validate_Save
33772>>>>>>
33772>>>>>>
33772>>>>>>    // Define_Fields:
33772>>>>>>    // This procedure is used to set up all data-dictionary rules.
33772>>>>>>
33772>>>>>>    Procedure Define_Fields
33773>>>>>>        Forward Send Define_Fields
33775>>>>>>        //DDB-Generated-Code-Location
33775>>>>>>        //DDB-DefineFieldStart
33775>>>>>>
33775>>>>>>        Set Main_File            To Company.File_Number
33776>>>>>>        Set Cascade_Delete_State To FALSE
33777>>>>>>
33777>>>>>>
33777>>>>>>        // Child (Client) file structure................
33777>>>>>>        Send Add_Client_File  Branch.File_Number
33778>>>>>>
33778>>>>>>        // Field-based properties.......................
33778>>>>>>
33778>>>>>>        // Company.Company_Code
33778>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33779>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33780>>>>>>
33780>>>>>>        // Company.Company_Name
33780>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33781>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33782>>>>>>
33782>>>>>>        // Company.Company_Afm
33782>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33783>>>>>>
33783>>>>>>        // Company.Company_Addr
33783>>>>>>
33783>>>>>>        // Company.Company_Tk
33783>>>>>>
33783>>>>>>        // Company.Company_Poli
33783>>>>>>
33783>>>>>>        // Company.Company_Doy
33783>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33784>>>>>>
33784>>>>>>        // Company.Company_J_Code
33784>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33785>>>>>>
33785>>>>>>        // Company.Company_C_Code0
33785>>>>>>
33785>>>>>>        // Company.Company_C_Cod00
33785>>>>>>
33785>>>>>>        // Company.Company_C_Coder
33785>>>>>>
33785>>>>>>        // Company.Company_Tel
33785>>>>>>
33785>>>>>>        // Company.Company_Fax
33785>>>>>>
33785>>>>>>        // Company.Company_Email
33785>>>>>>
33785>>>>>>        // Company.Company_Resp
33785>>>>>>
33785>>>>>>        // Company.Company_Bitmap
33785>>>>>>
33785>>>>>>        // Company.Beto_Site
33785>>>>>>
33785>>>>>>        // Company.Logo
33785>>>>>>
33785>>>>>>        // Company.Doy_Type
33785>>>>>>
33785>>>>>>        // Company.Jcode_Type
33785>>>>>>
33785>>>>>>        // Company.Sap_Code
33785>>>>>>
33785>>>>>>        // Company.Sap_Path
33785>>>>>>
33785>>>>>>        //DDB-DefineFieldEnd
33785>>>>>>    End_Procedure    // Define_Fields
33786>>>>>>
33786>>>>>>    // Field_Defaults:
33786>>>>>>    // This procedure is used to establish default field values.
33786>>>>>>
33786>>>>>>    Procedure Field_Defaults
33787>>>>>>        Forward Send Field_Defaults
33789>>>>>>        //DDB-Generated-Code-Location
33789>>>>>>        //DDB-FieldDefaultStart
33789>>>>>>        //DDB-FieldDefaultEnd
33789>>>>>>    End_Procedure    // Field_Defaults
33790>>>>>>End_Class    // Company_DataDictionary
33791>>>>>>
33791>>>>>>//DDB-Selection-pkg-Start
33791>>>>>>
33791>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33791>>>>>>>>//AB/ Project sl001 : Etairies
33791>>>>>>>>//AB/     Object prj is a Lookup_Project
33791>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33791>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33791>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33791>>>>>>>>
33791>>>>>>>>// Project Object Structure
33791>>>>>>>>//   sl001 is a dbModalPanel
33791>>>>>>>>//     Company_DD is a DataDictionary
33791>>>>>>>>//     oSelList is a dbList
33791>>>>>>>>//     oOK_bn is a ButtonSub
33791>>>>>>>>//     oCancel_bn is a ButtonSub
33791>>>>>>>>//     oSearch_bn is a ButtonSub
33791>>>>>>>>
33791>>>>>>>>// Register all objects
33791>>>>>>>>Register_Object Company_DD
33791>>>>>>>>Register_Object oCancel_bn
33791>>>>>>>>Register_Object oOK_bn
33791>>>>>>>>Register_Object oSearch_bn
33791>>>>>>>>Register_Object oSelList
33791>>>>>>>>Register_Object sl001
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    //AB-IgnoreStart
33791>>>>>>>>
33791>>>>>>>>    Use DFAllEnt.pkg
33791>>>>>>>>    Use Button.Sub
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    Use COMPANY.DD
33791>>>>>>>>    
33791>>>>>>>>    //AB-IgnoreEnd
33791>>>>>>>>
33791>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33810>>>>>>>>        Set Label to "„«˜ ¨åœª"
33811>>>>>>>>        Set Size to 148 297
33812>>>>>>>>        Set Location to 12 27
33813>>>>>>>>
33813>>>>>>>>        //AB-DDOStart
33813>>>>>>>>
33813>>>>>>>>        Object Company_DD is a Company_DataDictionary
33815>>>>>>>>        End_Object    // Company_DD
33816>>>>>>>>
33816>>>>>>>>        Set Main_DD to (Company_DD(self))
33817>>>>>>>>        Set Server to (Company_DD(self))
33818>>>>>>>>
33818>>>>>>>>        //AB-DDOEnd
33818>>>>>>>>
33818>>>>>>>>        Object oSelList is a dbList
33820>>>>>>>>            Set Main_File to Company.File_Number
33821>>>>>>>>            Set Size to 105 280
33822>>>>>>>>            Set Location to 6 6
33823>>>>>>>>
33823>>>>>>>>            Begin_Row
33826>>>>>>>>                Entry_Item Company.Company_code
33827>>>>>>>>                Entry_Item Company.Company_name
33828>>>>>>>>                Entry_Item Company.Company_afm
33829>>>>>>>>            End_Row
33834>>>>>>>>
33834>>>>>>>>            Set Form_Width    item 0 to 42
33835>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33836>>>>>>>>            
33836>>>>>>>>            Set Form_Width    item 1 to 150
33837>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33838>>>>>>>>            
33838>>>>>>>>            Set Form_Width    item 2 to 80
33839>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33840>>>>>>>>            
33840>>>>>>>>        End_Object    // oSelList
33841>>>>>>>>
33841>>>>>>>>        Object oOK_bn is a ButtonSub
33843>>>>>>>>            Set Label to "&„§ ¢¦šã"
33844>>>>>>>>            Set Location to 115 126
33845>>>>>>>>
33845>>>>>>>>            //AB-StoreStart
33845>>>>>>>>            Procedure OnClick
33847>>>>>>>>                Send OK To (oSelList(current_object))
33848>>>>>>>>            End_Procedure
33849>>>>>>>>            //AB-StoreEnd
33849>>>>>>>>
33849>>>>>>>>        End_Object    // oOK_bn
33850>>>>>>>>
33850>>>>>>>>        Object oCancel_bn is a ButtonSub
33852>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33853>>>>>>>>            Set Location to 115 181
33854>>>>>>>>
33854>>>>>>>>            //AB-StoreStart
33854>>>>>>>>            Procedure OnClick
33856>>>>>>>>                Send Cancel To (oSelList(current_object))
33857>>>>>>>>            End_Procedure
33858>>>>>>>>            //AB-StoreEnd
33858>>>>>>>>
33858>>>>>>>>        End_Object    // oCancel_bn
33859>>>>>>>>
33859>>>>>>>>        Object oSearch_bn is a ButtonSub
33861>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33862>>>>>>>>            Set Location to 115 236
33863>>>>>>>>
33863>>>>>>>>            //AB-StoreStart
33863>>>>>>>>            Procedure OnClick
33865>>>>>>>>                Send Search To (oSelList(current_object))
33866>>>>>>>>            End_Procedure
33867>>>>>>>>            //AB-StoreEnd
33867>>>>>>>>
33867>>>>>>>>        End_Object    // oSearch_bn
33868>>>>>>>>
33868>>>>>>>>
33868>>>>>>>>        //AB-StoreStart
33868>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33869>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33870>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33871>>>>>>>>        //AB-StoreEnd
33871>>>>>>>>
33871>>>>>>>>    CD_End_Object    // sl001
33873>>>>>>>>>
33873>>>>>>>>
33873>>>>>>>>//AB/     End_Object    // prj
33873>>>>>>
33873>>>>>>//DDB-Selection-pkg-End
33873>>>>>>//DDB-FileEnd
33873>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33873>>>>>>//DDB-FileStart
33873>>>>>>//DDB-HeaderStart
33873>>>>>>
33873>>>>>>// File Name : BRANCH.DD
33873>>>>>>// Class Name: Branch_DataDictionary
33873>>>>>>// Revision  : 92
33873>>>>>>// Version   : 2
33873>>>>>>
33873>>>>>>Use  Windows           // Basic Definitions
33873>>>>>>Use  DataDict          // DataDictionary Class Definition
33873>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33873>>>>>>
33873>>>>>>Open Branch
33875>>>>>>Open Year
33877>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33879>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33881>>>>>>Open Company
33883>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33885>>>>>>
33885>>>>>>//DDB-HeaderEnd
33885>>>>>>//DDB-ValidationStart
33885>>>>>>
33885>>>>>>Register_Object Branch_Branch_Doy_VT
33885>>>>>>Register_Object Branch_Branch_C_Code0_VT
33885>>>>>>
33885>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33887>>>>>>    Set Type_Value        To "DOY"
33888>>>>>>    Set Validate_State    To FALSE
33889>>>>>>    Set Allow_Blank_State To TRUE
33890>>>>>>    //DDB-ValidationCustomStart
33890>>>>>>    //DDB-ValidationCustomEnd
33890>>>>>>End_Object   // Branch_Branch_Doy_VT
33891>>>>>>
33891>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33893>>>>>>    Set Type_Value        To ""
33894>>>>>>    Set Allow_Blank_State To TRUE
33895>>>>>>    //DDB-ValidationCustomStart
33895>>>>>>    //DDB-ValidationCustomEnd
33895>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33896>>>>>>//DDB-ValidationEnd
33896>>>>>>//DDB-SelectionStart
33896>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33896>>>>>>Register_Object SL002
33896>>>>>>//DDB-SelectionEnd
33896>>>>>>
33896>>>>>>Class Branch_DataDictionary  is a DataDictionary
33897>>>>>> 
33897>>>>>>    Procedure Save_Main_File
33898>>>>>>        Forward Send Save_Main_File
33900>>>>>>        // Insert Code Here
33900>>>>>>    End_Procedure   // Save_Main_File
33901>>>>>> 
33901>>>>>>    Procedure Creating
33902>>>>>>        Forward Send Creating
33904>>>>>>        // Insert Code Here
33904>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33905>>>>>>    End_Procedure   // Creating
33906>>>>>>
33906>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33907>>>>>>        // Insert Code Here
33907>>>>>>        Case Begin
33907>>>>>>             Case (iError_Num = 1001)
33909>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33910>>>>>>>
33910>>>>>>             Case Break
33911>>>>>>
33911>>>>>>             Case Else
33911>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33913>>>>>>        Case End
33913>>>>>>    End_Procedure   // Operation_Not_Allowed
33914>>>>>>
33914>>>>>>
33914>>>>>>    // Validate_Save:
33914>>>>>>
33914>>>>>>    Function Validate_Save  Returns Integer
33915>>>>>>        Local Integer iReturnVal
33916>>>>>>        Forward Get Validate_Save  To iReturnVal
33918>>>>>>        If (Not(iReturnVal)) Begin
33920>>>>>>            // Insert Code Here
33920>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33923>>>>>>        End
33923>>>>>>>
33923>>>>>>        Function_Return iReturnVal
33924>>>>>>    End_Function   // Validate_Save
33925>>>>>>
33925>>>>>>
33925>>>>>>    // Define_Fields:
33925>>>>>>    // This procedure is used to set up all data-dictionary rules.
33925>>>>>>
33925>>>>>>    Procedure Define_Fields
33926>>>>>>        Forward Send Define_Fields
33928>>>>>>        //DDB-Generated-Code-Location
33928>>>>>>        //DDB-DefineFieldStart
33928>>>>>>
33928>>>>>>        Set Main_File            To Branch.File_Number
33929>>>>>>        Set Cascade_Delete_State To FALSE
33930>>>>>>
33930>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33931>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33932>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33933>>>>>>
33933>>>>>>        // Child (Client) file structure................
33933>>>>>>        Send Add_Client_File  Year.File_Number
33934>>>>>>        Send Add_Client_File  Brzones.File_Number
33935>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33936>>>>>>
33936>>>>>>        // Parent (Server) file structure...............
33936>>>>>>        Send Add_Server_File  Company.File_Number
33937>>>>>>
33937>>>>>>        // External (System) file structure.............
33937>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33938>>>>>>
33938>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33941>>>>>>
33941>>>>>>        // Field-based properties.......................
33941>>>>>>
33941>>>>>>        // Branch.Company_Code
33941>>>>>>
33941>>>>>>        // Branch.Branch_Code
33941>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33942>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33943>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33944>>>>>>
33944>>>>>>        // Branch.Branch_Rec0
33944>>>>>>
33944>>>>>>        // Branch.Branch_Recr
33944>>>>>>
33944>>>>>>        // Branch.Branch_Name
33944>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33945>>>>>>
33945>>>>>>        // Branch.Branch_Afm
33945>>>>>>
33945>>>>>>        // Branch.Branch_Addr
33945>>>>>>
33945>>>>>>        // Branch.Branch_Tk
33945>>>>>>
33945>>>>>>        // Branch.Branch_Poli
33945>>>>>>
33945>>>>>>        // Branch.Branch_Doy
33945>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33946>>>>>>
33946>>>>>>        // Branch.Branch_J_Code
33946>>>>>>
33946>>>>>>        // Branch.Branch_C_Code0
33946>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Code00
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Coder
33947>>>>>>
33947>>>>>>        // Branch.Branch_Tel
33947>>>>>>
33947>>>>>>        // Branch.Branch_Fax
33947>>>>>>
33947>>>>>>        // Branch.Branch_Email
33947>>>>>>
33947>>>>>>        // Branch.Branch_Resp
33947>>>>>>
33947>>>>>>        // Branch.Branch_Bitmap
33947>>>>>>
33947>>>>>>        // Branch.Branch_Site
33947>>>>>>
33947>>>>>>        // Branch.Branch_Apoth
33947>>>>>>
33947>>>>>>        // Branch.Beto_Site
33947>>>>>>
33947>>>>>>        // Branch.Path_Exp
33947>>>>>>
33947>>>>>>        // Branch.Exp_Txtname
33947>>>>>>
33947>>>>>>        // Branch.Send_Phone
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Files
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Conf
33947>>>>>>
33947>>>>>>        // Branch.Tomeas_Code
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Retry
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Exit
33947>>>>>>
33947>>>>>>        // Branch.Ras_Name
33947>>>>>>
33947>>>>>>        // Branch.Ras_Passw
33947>>>>>>
33947>>>>>>        // Branch.Ras_Domain
33947>>>>>>
33947>>>>>>        // Branch.Last_Hmnia_Ekt
33947>>>>>>
33947>>>>>>        // Branch.Deop_Logo
33947>>>>>>
33947>>>>>>        // Branch.Entolh
33947>>>>>>
33947>>>>>>        // Branch.Paragogh
33947>>>>>>
33947>>>>>>        // Branch.Locked_Until
33947>>>>>>
33947>>>>>>        // Branch.Sap_Code
33947>>>>>>
33947>>>>>>        // Branch.Perioxh
33947>>>>>>
33947>>>>>>        // Branch.Egkatastash
33947>>>>>>
33947>>>>>>        // Branch.Date_Locked
33947>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
33948>>>>>>
33948>>>>>>        //DDB-DefineFieldEnd
33948>>>>>>    End_Procedure    // Define_Fields
33949>>>>>>
33949>>>>>>    // Field_Defaults:
33949>>>>>>    // This procedure is used to establish default field values.
33949>>>>>>
33949>>>>>>    Procedure Field_Defaults
33950>>>>>>        Forward Send Field_Defaults
33952>>>>>>        //DDB-Generated-Code-Location
33952>>>>>>        //DDB-FieldDefaultStart
33952>>>>>>        //DDB-FieldDefaultEnd
33952>>>>>>    End_Procedure    // Field_Defaults
33953>>>>>>End_Class    // Branch_DataDictionary
33954>>>>>>
33954>>>>>>//DDB-Selection-pkg-Start
33954>>>>>>
33954>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33954>>>>>>>>//AB/ Project SL002:Branch
33954>>>>>>>>//AB/ Object prj is a Lookup_Project
33954>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33954>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33954>>>>>>>>
33954>>>>>>>>// Project Object Structure
33954>>>>>>>>//   SL002 is a dbModalPanelSub
33954>>>>>>>>//     Company_DD is a DataDictionary
33954>>>>>>>>//     Branch_DD is a DataDictionary
33954>>>>>>>>//     oSelList is a dbListSub
33954>>>>>>>>//     oOK_bn is a ButtonSub
33954>>>>>>>>//     oCancel_bn is a ButtonSub
33954>>>>>>>>//     oSearch_bn is a ButtonSub
33954>>>>>>>>
33954>>>>>>>>// Register all objects
33954>>>>>>>>Register_Object Branch_DD
33954>>>>>>>>Register_Object Company_DD
33954>>>>>>>>Register_Object oCancel_bn
33954>>>>>>>>Register_Object oOK_bn
33954>>>>>>>>Register_Object oSearch_bn
33954>>>>>>>>Register_Object oSelList
33954>>>>>>>>Register_Object SL002
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreStart
33954>>>>>>>>
33954>>>>>>>>Use DFAllEnt.pkg
33954>>>>>>>>Use dbList.Sub
33954>>>>>>>>Use Button.Sub
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>Use COMPANY.DD
33954>>>>>>>>Use BRANCH.DD
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreEnd
33954>>>>>>>>
33954>>>>>>>>Object SL002 is a dbModalPanelSub
33956>>>>>>>>
33956>>>>>>>>    //AB-StoreTopStart
33956>>>>>>>>    Property String psFragmaCompanyCode  ""
33958>>>>>>>>    
33958>>>>>>>>    //AB-StoreTopEnd
33958>>>>>>>>
33958>>>>>>>>    Set Minimize_Icon to FALSE
33959>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33960>>>>>>>>    Set Size to 146 430
33961>>>>>>>>    Set Location to 4 5
33962>>>>>>>>    Set Exit_Application_Local_State to FALSE
33963>>>>>>>>    Set Modal_State to FALSE
33964>>>>>>>>
33964>>>>>>>>    //AB-DDOStart
33964>>>>>>>>
33964>>>>>>>>    Object Company_DD is a Company_DataDictionary
33966>>>>>>>>    End_Object    // Company_DD
33967>>>>>>>>
33967>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33969>>>>>>>>        Set DDO_Server to (Company_DD(self))
33970>>>>>>>>
33970>>>>>>>>        //AB-StoreStart
33970>>>>>>>>        Procedure OnConstrain
33972>>>>>>>>             String lsCompanyCode
33973>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33974>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33978>>>>>>>>        End_Procedure // OnConstrain
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        //AB-StoreEnd
33979>>>>>>>>
33979>>>>>>>>    End_Object    // Branch_DD
33980>>>>>>>>
33980>>>>>>>>    Set Main_DD to (Branch_DD(self))
33981>>>>>>>>    Set Server to (Branch_DD(self))
33982>>>>>>>>
33982>>>>>>>>    //AB-DDOEnd
33982>>>>>>>>
33982>>>>>>>>    Object oSelList is a dbListSub
33984>>>>>>>>        Set Main_File to Branch.File_Number
33985>>>>>>>>        Set Size to 105 415
33986>>>>>>>>        Set Location to 6 6
33987>>>>>>>>
33987>>>>>>>>        Begin_Row
33990>>>>>>>>            Entry_Item Branch.Branch_code
33991>>>>>>>>            Entry_Item Branch.Branch_name
33992>>>>>>>>            Entry_Item Company.Company_code
33993>>>>>>>>            Entry_Item Company.Company_name
33994>>>>>>>>            Entry_Item Branch.Beto_site
33995>>>>>>>>            Entry_Item Branch.Branch_recr
33996>>>>>>>>        End_Row
34001>>>>>>>>
34001>>>>>>>>        Set Form_Width    item 0 to 60
34002>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34003>>>>>>>>        
34003>>>>>>>>        Set Form_Width    item 1 to 128
34004>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34005>>>>>>>>        
34005>>>>>>>>        Set Form_Width    item 2 to 69
34006>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34007>>>>>>>>        
34007>>>>>>>>        Set Form_Width    item 3 to 109
34008>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34009>>>>>>>>        
34009>>>>>>>>        Set Form_Width    item 4 to 42
34010>>>>>>>>        Set Header_Label  item 4 to "Site"
34011>>>>>>>>        
34011>>>>>>>>        Set Form_Width    item 5 to 0
34012>>>>>>>>        Set Header_Label  item 5 to ""
34013>>>>>>>>        
34013>>>>>>>>
34013>>>>>>>>        //AB-StoreStart
34013>>>>>>>>                
34013>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34015>>>>>>>>        
34015>>>>>>>>        Procedure Store_Defaults
34017>>>>>>>>            forward send Store_Defaults
34019>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34020>>>>>>>>        end_Procedure // Store_Defaults
34021>>>>>>>>        
34021>>>>>>>>        Procedure Restore_Defaults
34023>>>>>>>>            forward send Restore_Defaults
34025>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34026>>>>>>>>        end_Procedure // Restore_Defaults
34027>>>>>>>>        
34027>>>>>>>>        Procedure Activating
34029>>>>>>>>            Forward Send Activating
34031>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34032>>>>>>>>        End_Procedure // Activating
34033>>>>>>>>        
34033>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34034>>>>>>>>        
34034>>>>>>>>        
34034>>>>>>>>        //AB-StoreEnd
34034>>>>>>>>
34034>>>>>>>>    End_Object    // oSelList
34035>>>>>>>>
34035>>>>>>>>    Object oOK_bn is a ButtonSub
34037>>>>>>>>        Set Label to "&„§ ¢¦šã"
34038>>>>>>>>        Set Location to 112 262
34039>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34040>>>>>>>>
34040>>>>>>>>        //AB-StoreStart
34040>>>>>>>>        Procedure OnClick
34042>>>>>>>>            Send OK To (oSelList(current_object))
34043>>>>>>>>        End_Procedure
34044>>>>>>>>        //AB-StoreEnd
34044>>>>>>>>
34044>>>>>>>>    End_Object    // oOK_bn
34045>>>>>>>>
34045>>>>>>>>    Object oCancel_bn is a ButtonSub
34047>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34048>>>>>>>>        Set Location to 112 317
34049>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34050>>>>>>>>
34050>>>>>>>>        //AB-StoreStart
34050>>>>>>>>        Procedure OnClick
34052>>>>>>>>            Send Cancel To (oSelList(current_object))
34053>>>>>>>>        End_Procedure
34054>>>>>>>>        //AB-StoreEnd
34054>>>>>>>>
34054>>>>>>>>    End_Object    // oCancel_bn
34055>>>>>>>>
34055>>>>>>>>    Object oSearch_bn is a ButtonSub
34057>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34058>>>>>>>>        Set Location to 112 372
34059>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34060>>>>>>>>
34060>>>>>>>>        //AB-StoreStart
34060>>>>>>>>        Procedure OnClick
34062>>>>>>>>            Send Search To (oSelList(current_object))
34063>>>>>>>>        End_Procedure
34064>>>>>>>>        //AB-StoreEnd
34064>>>>>>>>
34064>>>>>>>>    End_Object    // oSearch_bn
34065>>>>>>>>
34065>>>>>>>>
34065>>>>>>>>    //AB-StoreStart
34065>>>>>>>>    
34065>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34066>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34067>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    //AB-StoreEnd
34068>>>>>>>>
34068>>>>>>>>End_Object    // SL002
34069>>>>>>>>
34069>>>>>>>>//AB/ End_Object    // prj
34069>>>>>>
34069>>>>>>//DDB-Selection-pkg-End
34069>>>>>>//DDB-FileEnd
34069>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34069>>>>>>//DDB-FileStart
34069>>>>>>//DDB-HeaderStart
34069>>>>>>
34069>>>>>>// File Name : YEAR.DD
34069>>>>>>// Class Name: Year_DataDictionary
34069>>>>>>// Revision  : 119
34069>>>>>>// Version   : 2
34069>>>>>>
34069>>>>>>Use  Windows           // Basic Definitions
34069>>>>>>Use  DataDict          // DataDictionary Class Definition
34069>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34069>>>>>>
34069>>>>>>Open Year
34071>>>>>>Open Branch
34073>>>>>>Open Syscurxr
34075>>>>>>
34075>>>>>>//DDB-HeaderEnd
34075>>>>>>//DDB-ValidationStart
34075>>>>>>
34075>>>>>>Register_Object Year_Year_C_Code0_VT1
34075>>>>>>Register_Object Year_Year_C_Code00_VT1
34075>>>>>>Register_Object Year_Year_C_Coder_VT1
34075>>>>>>
34075>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34077>>>>>>    Set Type_Value        To "CURRENCY"
34078>>>>>>    //DDB-ValidationCustomStart
34078>>>>>>    //DDB-ValidationCustomEnd
34078>>>>>>End_Object   // Year_Year_C_Code0_VT1
34079>>>>>>
34079>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34081>>>>>>    Set Type_Value        To "CURRENCY"
34082>>>>>>    //DDB-ValidationCustomStart
34082>>>>>>    //DDB-ValidationCustomEnd
34082>>>>>>End_Object   // Year_Year_C_Code00_VT1
34083>>>>>>
34083>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34085>>>>>>    Set Type_Value        To "CURRENCY"
34086>>>>>>    //DDB-ValidationCustomStart
34086>>>>>>    //DDB-ValidationCustomEnd
34086>>>>>>End_Object   // Year_Year_C_Coder_VT1
34087>>>>>>//DDB-ValidationEnd
34087>>>>>>//DDB-SelectionStart
34087>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34087>>>>>>Register_Object SL003
34087>>>>>>//DDB-SelectionEnd
34087>>>>>>            
34087>>>>>>Class Year_DataDictionary  is a DataDictionary
34088>>>>>>    
34088>>>>>>    Procedure Creating
34089>>>>>>        Forward Send Creating
34091>>>>>>        // Insert Code Here
34091>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34092>>>>>>    End_Procedure   // Creating
34093>>>>>>
34093>>>>>>
34093>>>>>>    // Operation_Not_Allowed:
34093>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34094>>>>>>        // Insert Code Here
34094>>>>>>        Case Begin    
34094>>>>>>             Case (iError_Num = 1001)
34096>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34097>>>>>>>
34097>>>>>>             Case Break
34098>>>>>>             Case (iError_Num=1002)
34101>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34102>>>>>>>
34102>>>>>>             Case Break
34103>>>>>>             Case (iError_Num=1003)
34106>>>>>>                Error 1003 "DDC 053:Company Code=0"
34107>>>>>>>
34107>>>>>>             Case Break
34108>>>>>>             Case (iError_Num=1004)
34111>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34112>>>>>>>
34112>>>>>>             Case Break
34113>>>>>>             Case Else
34113>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34115>>>>>>        Case End
34115>>>>>>    End_Procedure   // Operation_Not_Allowed
34116>>>>>>
34116>>>>>>
34116>>>>>>    // Update:
34116>>>>>>    // Use this message to effect changes in related-to files. The
34116>>>>>>    // Backout message should be designed to reverse the effects of this
34116>>>>>>    // message. It is invoked while the database is locked.
34116>>>>>>
34116>>>>>>    Procedure Update
34117>>>>>>        Forward Send Update
34119>>>>>>        // Insert Code Here
34119>>>>>>        Move Company.Company_Code   to Year.Company_Code
34120>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34121>>>>>>        move branch.beto_site       to year.beto_site
34122>>>>>>
34122>>>>>>        //sos:parametrika apo sysfile?
34122>>>>>>       
34122>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34122>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>       // Else Begin
34122>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34122>>>>>>    End_Procedure   // Update
34123>>>>>>
34123>>>>>>    // Validate_Save:
34123>>>>>>
34123>>>>>>    Function Validate_Save  Returns Integer
34124>>>>>>        Local Integer iReturnVal
34125>>>>>>        Forward Get Validate_Save  To iReturnVal
34127>>>>>>        If (Not(iReturnVal)) Begin
34129>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34132>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34136>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34140>>>>>>        End
34140>>>>>>>
34140>>>>>>        Function_Return iReturnVal
34141>>>>>>    End_Function   // Validate_Save
34142>>>>>>
34142>>>>>>
34142>>>>>>    // Define_Fields:
34142>>>>>>    // This procedure is used to set up all data-dictionary rules.
34142>>>>>>
34142>>>>>>    Procedure Define_Fields
34143>>>>>>        Forward Send Define_Fields
34145>>>>>>        //DDB-Generated-Code-Location
34145>>>>>>        //DDB-DefineFieldStart
34145>>>>>>
34145>>>>>>        Set Main_File            To Year.File_Number
34146>>>>>>        Set Cascade_Delete_State To FALSE
34147>>>>>>
34147>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34148>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34149>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34150>>>>>>
34150>>>>>>        // Parent (Server) file structure...............
34150>>>>>>        Send Add_Server_File  Branch.File_Number
34151>>>>>>
34151>>>>>>        // External (System) file structure.............
34151>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34152>>>>>>
34152>>>>>>        // Field-based properties.......................
34152>>>>>>
34152>>>>>>        // Year.Company_Code
34152>>>>>>
34152>>>>>>        // Year.Branch_Code
34152>>>>>>
34152>>>>>>        // Year.Year_Year
34152>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34153>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34154>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34155>>>>>>
34155>>>>>>        // Year.Year_Recr
34155>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34156>>>>>>
34156>>>>>>        // Year.Branch_Recr
34156>>>>>>
34156>>>>>>        // Year.Year_Descr
34156>>>>>>
34156>>>>>>        // Year.Year_Isolfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Isolto
34156>>>>>>
34156>>>>>>        // Year.Year_Openfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Opento
34156>>>>>>
34156>>>>>>        // Year.Year_Entrydate
34156>>>>>>
34156>>>>>>        // Year.Year_Dateaa
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshto
34156>>>>>>
34156>>>>>>        // Year.Year_Myflimit
34156>>>>>>
34156>>>>>>        // Year.Year_Numgtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numgarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numgmove
34156>>>>>>
34156>>>>>>        // Year.Year_Numgplan
34156>>>>>>
34156>>>>>>        // Year.Year_Numgformat
34156>>>>>>
34156>>>>>>        // Year.Year_Numgthaa
34156>>>>>>
34156>>>>>>        // Year.Year_Numgopen
34156>>>>>>
34156>>>>>>        // Year.Year_Numbtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numbaxio
34156>>>>>>
34156>>>>>>        // Year.Year_Numbarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numbmove
34156>>>>>>
34156>>>>>>        // Year.Year_Delimiter
34156>>>>>>
34156>>>>>>        // Year.Year_Printer
34156>>>>>>
34156>>>>>>        // Year.Year_Valid_Char
34156>>>>>>
34156>>>>>>        // Year.Year_C_Code0
34156>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34157>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34158>>>>>>
34158>>>>>>        // Year.Year_C_Code00
34158>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34159>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34160>>>>>>
34160>>>>>>        // Year.Year_C_Coder
34160>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34161>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34162>>>>>>
34162>>>>>>        // Year.Beto_Site
34162>>>>>>
34162>>>>>>        // Year.Clients_Plafon
34162>>>>>>
34162>>>>>>        // Year.Payresp_Plafon
34162>>>>>>
34162>>>>>>        // Year.Clients_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Payresp_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Working
34162>>>>>>
34162>>>>>>        //DDB-DefineFieldEnd
34162>>>>>>
34162>>>>>>        Set Main_File            To Year.File_Number
34163>>>>>>        Set Cascade_Delete_State To FALSE
34164>>>>>>
34164>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34165>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34166>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34167>>>>>>
34167>>>>>>        // Child (Client) file structure................
34167>>>>>>
34167>>>>>>        // Parent (Server) file structure...............
34167>>>>>>        Send Add_Server_File  Branch.File_Number
34168>>>>>>
34168>>>>>>        // Field-based properties.......................
34168>>>>>>
34168>>>>>>        // Year.Company_Code
34168>>>>>>
34168>>>>>>        // Year.Branch_Code
34168>>>>>>
34168>>>>>>        // Year.Year_Year
34168>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34169>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34170>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34171>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34171>>>>>>
34171>>>>>>        // Year.Year_Descr
34171>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34172>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34173>>>>>>
34173>>>>>>        // Year.Year_C_Code0
34173>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34174>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34175>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34176>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34176>>>>>>
34176>>>>>>        // Year.Year_C_Code00
34176>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34177>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34178>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34179>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34179>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34179>>>>>>
34179>>>>>>        // Year.Year_C_Coder
34179>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34180>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34181>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34182>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34182>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34182>>>>>>
34182>>>>>>        // Year.Year_Isolfrom
34182>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34183>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34184>>>>>>
34184>>>>>>        // Year.Year_Isolto
34184>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34185>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34186>>>>>>
34186>>>>>>        // Year.Year_Openfrom
34186>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34187>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34188>>>>>>
34188>>>>>>        // Year.Year_Opento
34188>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34189>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34190>>>>>>
34190>>>>>>        // Year.Year_Entrydate
34190>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34191>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34192>>>>>>
34192>>>>>>        // Year.Year_Dateaa
34192>>>>>>
34192>>>>>>        // Year.Year_Xrhshfrom
34192>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34193>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34194>>>>>>
34194>>>>>>        // Year.Year_Xrhshto
34194>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34195>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34196>>>>>>
34196>>>>>>        // Year.Year_Myflimit
34196>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34197>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34198>>>>>>
34198>>>>>>        // Year.Year_Numgtypkin
34198>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34199>>>>>>
34199>>>>>>        // Year.Year_Numgarticl
34199>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34200>>>>>>
34200>>>>>>        // Year.Year_Numgmove
34200>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34201>>>>>>
34201>>>>>>        // Year.Year_Numgplan
34201>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34202>>>>>>
34202>>>>>>        // Year.Year_Numgformat
34202>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34203>>>>>>
34203>>>>>>        // Year.Year_Numgthaa
34203>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34204>>>>>>
34204>>>>>>        // Year.Year_Numgopen
34204>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34205>>>>>>
34205>>>>>>        // Year.Year_Numbaxio
34205>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34206>>>>>>
34206>>>>>>        // Year.Year_Numbarticl
34206>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34207>>>>>>
34207>>>>>>        // Year.Year_Numbmove
34207>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34208>>>>>>
34208>>>>>>        // Year.Year_Delimiter
34208>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34209>>>>>>
34209>>>>>>        // Year.Year_Printer
34209>>>>>>
34209>>>>>>        // Year.Year_Valid_Char
34209>>>>>>
34209>>>>>>    End_Procedure    // Define_Fields
34210>>>>>>
34210>>>>>>    // Field_Defaults:
34210>>>>>>    // This procedure is used to establish default field values.
34210>>>>>>
34210>>>>>>    Procedure Field_Defaults
34211>>>>>>        Forward Send Field_Defaults
34213>>>>>>        //DDB-Generated-Code-Location
34213>>>>>>        //DDB-FieldDefaultStart
34213>>>>>>        //DDB-FieldDefaultEnd
34213>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34214>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34215>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34216>>>>>>    End_Procedure    // Field_Defaults
34217>>>>>>
34217>>>>>>End_Class    // Year_DataDictionary
34218>>>>>>//DDB-Selection-pkg-Start
34218>>>>>>
34218>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34218>>>>>>>>//AB/ Project SL003:Year
34218>>>>>>>>//AB/ Object prj is a Lookup_Project
34218>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34218>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34218>>>>>>>>
34218>>>>>>>>// Project Object Structure
34218>>>>>>>>//   SL003 is a dbModalPanelSub
34218>>>>>>>>//     Company_DD is a DataDictionary
34218>>>>>>>>//     Branch_DD is a DataDictionary
34218>>>>>>>>//     Year_DD is a DataDictionary
34218>>>>>>>>//     oSelList is a dbListSub
34218>>>>>>>>//     oOK_bn is a ButtonSub
34218>>>>>>>>//     oCancel_bn is a ButtonSub
34218>>>>>>>>//     oSearch_bn is a ButtonSub
34218>>>>>>>>
34218>>>>>>>>// Register all objects
34218>>>>>>>>Register_Object Branch_DD
34218>>>>>>>>Register_Object Company_DD
34218>>>>>>>>Register_Object oCancel_bn
34218>>>>>>>>Register_Object oOK_bn
34218>>>>>>>>Register_Object oSearch_bn
34218>>>>>>>>Register_Object oSelList
34218>>>>>>>>Register_Object SL003
34218>>>>>>>>Register_Object Year_DD
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreStart
34218>>>>>>>>
34218>>>>>>>>Use DFAllEnt.pkg
34218>>>>>>>>Use dbList.Sub
34218>>>>>>>>Use Button.Sub
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>Use COMPANY.DD
34218>>>>>>>>Use BRANCH.DD
34218>>>>>>>>Use YEAR.DD
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreEnd
34218>>>>>>>>
34218>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34237>>>>>>>>
34237>>>>>>>>    //AB-StoreTopStart
34237>>>>>>>>    Property String psFragmaCompanyCode  ""
34239>>>>>>>>    Property String psFragmaBranchCode   ""
34241>>>>>>>>    property integer pifragmaactive public 0
34243>>>>>>>>    //AB-StoreTopEnd
34243>>>>>>>>
34243>>>>>>>>    Set Minimize_Icon to FALSE
34244>>>>>>>>    Set Label to "•¨ã©œ ª"
34245>>>>>>>>    Set Size to 149 449
34246>>>>>>>>    Set Location to 4 7
34247>>>>>>>>    Set Exit_Application_Local_State to FALSE
34248>>>>>>>>    Set Modal_State to FALSE
34249>>>>>>>>
34249>>>>>>>>    //AB-DDOStart
34249>>>>>>>>
34249>>>>>>>>    Object Company_DD is a Company_DataDictionary
34251>>>>>>>>    End_Object    // Company_DD
34252>>>>>>>>
34252>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34254>>>>>>>>        Set DDO_Server to (Company_DD(self))
34255>>>>>>>>    End_Object    // Branch_DD
34256>>>>>>>>
34256>>>>>>>>    Object Year_DD is a Year_DataDictionary
34258>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34259>>>>>>>>
34259>>>>>>>>        //AB-StoreStart
34259>>>>>>>>        Procedure OnConstrain
34261>>>>>>>>             String lsCompanyCode lsBranchCode
34262>>>>>>>>             integer iactive
34262>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34263>>>>>>>>             get pifragmaactive to iactive
34264>>>>>>>>             If (lsCompanyCode <> "") Begin
34266>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34267>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34269>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34273>>>>>>>>             End
34273>>>>>>>>>
34273>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34277>>>>>>>>        End_Procedure // OnConstrain
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        //AB-StoreEnd
34278>>>>>>>>
34278>>>>>>>>    End_Object    // Year_DD
34279>>>>>>>>
34279>>>>>>>>    Set Main_DD to (Year_DD(self))
34280>>>>>>>>    Set Server to (Year_DD(self))
34281>>>>>>>>
34281>>>>>>>>    //AB-DDOEnd
34281>>>>>>>>
34281>>>>>>>>    Object oSelList is a dbListSub
34283>>>>>>>>        Set Main_File to Year.File_Number
34284>>>>>>>>        Set Size to 105 433
34285>>>>>>>>        Set Location to 6 6
34286>>>>>>>>
34286>>>>>>>>        Begin_Row
34289>>>>>>>>            Entry_Item Year.Year_year
34290>>>>>>>>            Entry_Item Company.Company_code
34291>>>>>>>>            Entry_Item Company.Company_name
34292>>>>>>>>            Entry_Item Branch.Branch_code
34293>>>>>>>>            Entry_Item Branch.Branch_name
34294>>>>>>>>        End_Row
34299>>>>>>>>
34299>>>>>>>>        Set Form_Width    item 0 to 36
34300>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34301>>>>>>>>        
34301>>>>>>>>        Set Form_Width    item 1 to 71
34302>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34303>>>>>>>>        
34303>>>>>>>>        Set Form_Width    item 2 to 136
34304>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34305>>>>>>>>        
34305>>>>>>>>        Set Form_Width    item 3 to 73
34306>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34307>>>>>>>>        
34307>>>>>>>>        Set Form_Width    item 4 to 109
34308>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34309>>>>>>>>        
34309>>>>>>>>
34309>>>>>>>>        //AB-StoreStart
34309>>>>>>>>                                                
34309>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34311>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34313>>>>>>>>        
34313>>>>>>>>        Procedure Store_Defaults
34315>>>>>>>>            forward send Store_Defaults
34317>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34318>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34319>>>>>>>>        end_Procedure // Store_Defaults
34320>>>>>>>>        
34320>>>>>>>>        Procedure Restore_Defaults
34322>>>>>>>>            forward send Restore_Defaults
34324>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34325>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34326>>>>>>>>        end_Procedure // Restore_Defaults
34327>>>>>>>>        
34327>>>>>>>>        Procedure Activating
34329>>>>>>>>            Forward Send Activating
34331>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34332>>>>>>>>        End_Procedure // Activating
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        //AB-StoreEnd
34333>>>>>>>>
34333>>>>>>>>    End_Object    // oSelList
34334>>>>>>>>
34334>>>>>>>>    Object oOK_bn is a ButtonSub
34336>>>>>>>>        Set Label to "&„§ ¢¦šã"
34337>>>>>>>>        Set Location to 112 280
34338>>>>>>>>
34338>>>>>>>>        //AB-StoreStart
34338>>>>>>>>        Procedure OnClick
34340>>>>>>>>            Send OK To (oSelList(current_object))
34341>>>>>>>>        End_Procedure
34342>>>>>>>>        //AB-StoreEnd
34342>>>>>>>>
34342>>>>>>>>    End_Object    // oOK_bn
34343>>>>>>>>
34343>>>>>>>>    Object oCancel_bn is a ButtonSub
34345>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34346>>>>>>>>        Set Location to 112 335
34347>>>>>>>>
34347>>>>>>>>        //AB-StoreStart
34347>>>>>>>>        Procedure OnClick
34349>>>>>>>>            Send Cancel To (oSelList(current_object))
34350>>>>>>>>        End_Procedure
34351>>>>>>>>        //AB-StoreEnd
34351>>>>>>>>
34351>>>>>>>>    End_Object    // oCancel_bn
34352>>>>>>>>
34352>>>>>>>>    Object oSearch_bn is a ButtonSub
34354>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34355>>>>>>>>        Set Location to 112 390
34356>>>>>>>>
34356>>>>>>>>        //AB-StoreStart
34356>>>>>>>>        Procedure OnClick
34358>>>>>>>>            Send Search To (oSelList(current_object))
34359>>>>>>>>        End_Procedure
34360>>>>>>>>        //AB-StoreEnd
34360>>>>>>>>
34360>>>>>>>>    End_Object    // oSearch_bn
34361>>>>>>>>
34361>>>>>>>>
34361>>>>>>>>    //AB-StoreStart
34361>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34362>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34363>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    //AB-StoreEnd
34364>>>>>>>>
34364>>>>>>>>CD_End_Object    // SL003
34366>>>>>>>>>
34366>>>>>>>>
34366>>>>>>>>//AB/ End_Object    // prj
34366>>>>>>
34366>>>>>>//DDB-Selection-pkg-End
34366>>>>>>//DDB-FileEnd
34366>>>>
34366>>>>//AB-IgnoreEnd
34366>>>>
34366>>>>Object oSelectYear is a dbModalPanelSub
34368>>>>
34368>>>>    //AB-StoreTopStart
34368>>>>    
34368>>>>    Property String  psSelectedYearRecr  ''
34370>>>>    Property Integer piChangeState False
34372>>>>    
34372>>>>    //AB-StoreTopEnd
34372>>>>
34372>>>>    Set Minimize_Icon to FALSE
34373>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34374>>>>    Set Size to 111 372
34375>>>>    Set Location to 60 40
34376>>>>    Set Color to 12232306
34377>>>>
34377>>>>    //AB-DDOStart
34377>>>>
34377>>>>    Object Company_DD is a Company_DataDictionary
34379>>>>
34379>>>>        //AB-StoreStart
34379>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34380>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34381>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34382>>>>        
34382>>>>        
34382>>>>        
34382>>>>        //AB-StoreEnd
34382>>>>
34382>>>>    End_Object    // Company_DD
34383>>>>
34383>>>>    Object Branch_DD is a Branch_DataDictionary
34385>>>>        Set DDO_Server to (Company_DD(self))
34386>>>>
34386>>>>        //AB-StoreStart
34386>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34387>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34388>>>>        
34388>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34389>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34390>>>>        
34390>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34391>>>>        //AB-StoreEnd
34391>>>>
34391>>>>    End_Object    // Branch_DD
34392>>>>
34392>>>>    Object Year_DD is a Year_DataDictionary
34394>>>>        Set DDO_Server to (Branch_DD(self))
34395>>>>
34395>>>>        //AB-StoreStart
34395>>>>        
34395>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34396>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34397>>>>        
34397>>>>        Function Validate_Delete Returns Integer
34399>>>>            Function_Return 1
34400>>>>        End_Function
34401>>>>        
34401>>>>        //AB-StoreEnd
34401>>>>
34401>>>>    End_Object    // Year_DD
34402>>>>
34402>>>>    Set Main_DD to (Year_DD(self))
34403>>>>    Set Server to (Year_DD(self))
34404>>>>
34404>>>>    //AB-DDOEnd
34404>>>>
34404>>>>    Object Company_Company_Code is a dbFormSub
34406>>>>        Entry_Item Company.Company_code
34407>>>>        Set Size to 13 71
34408>>>>        Set Location to 9 112
34409>>>>        Set Color to 12232306
34410>>>>        Set Label_Col_Offset to 2
34411>>>>        Set Label_Justification_Mode to jMode_Right
34412>>>>        Set Prompt_Button_Mode to pb_PromptOn
34413>>>>        Set Auto_Clear_Deo_State to FALSE
34414>>>>        Set Enabled_State to FALSE
34415>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34416>>>>        Set Item_Shadow_State Item 0 to TRUE
34417>>>>        Set Shadow_State Item 0 to TRUE
34418>>>>
34418>>>>        //AB-StoreStart
34418>>>>        
34418>>>>        Set Prompt_Object to (sl001(Self))
34419>>>>        
34419>>>>        
34419>>>>        //AB-StoreEnd
34419>>>>
34419>>>>    End_Object    // Company_Company_Code
34420>>>>
34420>>>>    Object Company_Company_Name is a dbFormSub
34422>>>>        Entry_Item Company.Company_name
34423>>>>        Set Size to 13 168
34424>>>>        Set Location to 9 188
34425>>>>        Set Color to 12232306
34426>>>>        Set Label_Col_Offset to 2
34427>>>>        Set Label_Justification_Mode to jMode_Right
34428>>>>        Set Enabled_State to FALSE
34429>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34430>>>>        Set Item_Shadow_State Item 0 to TRUE
34431>>>>        Set Shadow_State Item 0 to TRUE
34432>>>>
34432>>>>        //AB-StoreStart
34432>>>>        
34432>>>>        //AB-StoreEnd
34432>>>>
34432>>>>    End_Object    // Company_Company_Name
34433>>>>
34433>>>>    Object Branch_Branch_Code is a dbFormSub
34435>>>>        Entry_Item Branch.Branch_code
34436>>>>        Set Size to 13 71
34437>>>>        Set Location to 23 112
34438>>>>        Set Color to 12232306
34439>>>>        Set Label_Col_Offset to 2
34440>>>>        Set Label_Justification_Mode to jMode_Right
34441>>>>        Set Prompt_Button_Mode to pb_PromptOn
34442>>>>        Set Auto_Clear_Deo_State to FALSE
34443>>>>        Set Enabled_State to FALSE
34444>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34445>>>>        Set Item_Shadow_State Item 0 to TRUE
34446>>>>        Set Shadow_State Item 0 to TRUE
34447>>>>
34447>>>>        //AB-StoreStart
34447>>>>        Set Prompt_Object to (sl002(Self))
34448>>>>        
34448>>>>        Procedure Prompt_CallBack Integer hPrompt
34450>>>>            string lsCompanyCode
34451>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34452>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34453>>>>        End_Procedure
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        //AB-StoreEnd
34454>>>>
34454>>>>    End_Object    // Branch_Branch_Code
34455>>>>
34455>>>>    Object Branch_Branch_Name is a dbFormSub
34457>>>>        Entry_Item Branch.Branch_name
34458>>>>        Set Size to 13 168
34459>>>>        Set Location to 23 188
34460>>>>        Set Color to 12232306
34461>>>>        Set Label_Justification_Mode to jMode_Right
34462>>>>        Set Enabled_State to FALSE
34463>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34464>>>>        Set Item_Shadow_State Item 0 to TRUE
34465>>>>        Set Shadow_State Item 0 to TRUE
34466>>>>
34466>>>>        //AB-StoreStart
34466>>>>        
34466>>>>        
34466>>>>        //AB-StoreEnd
34466>>>>
34466>>>>    End_Object    // Branch_Branch_Name
34467>>>>
34467>>>>    Object Year_Year_Year is a dbFormSub
34469>>>>        Entry_Item Year.Year_year
34470>>>>        Set Size to 13 71
34471>>>>        Set Location to 37 112
34472>>>>        Set Label_Col_Offset to 2
34473>>>>        Set Label_Justification_Mode to jMode_Right
34474>>>>        Set Prompt_Button_Mode to pb_PromptOn
34475>>>>        Set Auto_Clear_Deo_State to FALSE
34476>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34477>>>>
34477>>>>        //AB-StoreStart
34477>>>>        Set Prompt_Object to (sl003(Self))
34478>>>>        
34478>>>>        Procedure Prompt_CallBack Integer hPrompt
34480>>>>            String lsCompanyCode lsBranchCode
34481>>>>            integer icheck
34481>>>>            get checked_state of (chkxr(self)) to icheck
34482>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34483>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34484>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34485>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34486>>>>            set pifragmaactive      of hPrompt to icheck
34487>>>>        End_Procedure
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        //AB-StoreEnd
34488>>>>
34488>>>>    End_Object    // Year_Year_Year
34489>>>>
34489>>>>    Object Year_Year_Descr is a dbFormSub
34491>>>>        Entry_Item Year.Year_descr
34492>>>>        Set Size to 13 168
34493>>>>        Set Location to 37 188
34494>>>>        Set Color to 12232306
34495>>>>        Set Label_Col_Offset to 2
34496>>>>        Set Label_Justification_Mode to jMode_Right
34497>>>>        Set Enabled_State to FALSE
34498>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34499>>>>        Set Item_Shadow_State Item 0 to TRUE
34500>>>>        Set Shadow_State Item 0 to TRUE
34501>>>>
34501>>>>        //AB-StoreStart
34501>>>>        
34501>>>>        //AB-StoreEnd
34501>>>>
34501>>>>    End_Object    // Year_Year_Descr
34502>>>>
34502>>>>    Object Year_Year_Entrydate is a dbFormSub
34504>>>>        Entry_Item Year.Year_entrydate
34505>>>>        Set Size to 13 71
34506>>>>        Set Location to 52 112
34507>>>>        Set Label_Col_Offset to 2
34508>>>>        Set Label_Justification_Mode to jMode_Right
34509>>>>        Set Auto_Clear_Deo_State to FALSE
34510>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34511>>>>    End_Object    // Year_Year_Entrydate
34512>>>>
34512>>>>    Object oOk_bn is a ButtonSub
34514>>>>        Set Label to "€§¦›¦®ã (F2)"
34515>>>>        Set Size to 17 54
34516>>>>        Set Location to 74 188
34517>>>>        Set Form_FontHeight Item 0 to 14
34518>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34519>>>>
34519>>>>        //AB-StoreStart
34519>>>>        
34519>>>>        Procedure OnClick
34521>>>>            Delegate Send AcceptTheValues
34523>>>>        End_Procedure
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        //AB-StoreEnd
34524>>>>
34524>>>>    End_Object    // oOk_bn
34525>>>>
34525>>>>    Object oCancel_bn is a ButtonSub
34527>>>>        Set Label to "„¥¦›¦ª "
34528>>>>        Set Size to 17 54
34529>>>>        Set Location to 74 302
34530>>>>        Set Form_FontHeight Item 0 to 14
34531>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34532>>>>
34532>>>>        //AB-StoreStart
34532>>>>        
34532>>>>        Procedure OnClick
34534>>>>           Send Exit_Application to oSelectYear
34535>>>>        End_Procedure
34536>>>>        
34536>>>>        
34536>>>>        
34536>>>>        //AB-StoreEnd
34536>>>>
34536>>>>    End_Object    // oCancel_bn
34537>>>>
34537>>>>    Object otxtCompany is a TextBoxSub
34539>>>>        Set Label to "„«˜ ¨œå˜"
34540>>>>        Set Auto_Size_State to FALSE
34541>>>>        Set Color to 12232306
34542>>>>        Set FontSize to 14 8
34543>>>>        Set Location to 9 10
34544>>>>        Set Size to 10 35
34545>>>>        Set FontWeight to 600
34546>>>>        Set TypeFace to "MS Sans Serif"
34547>>>>        Set Enabled_State to TRUE
34548>>>>    End_Object    // otxtCompany
34549>>>>
34549>>>>    Object otxtBranch is a TextBoxSub
34551>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34552>>>>        Set Auto_Size_State to FALSE
34553>>>>        Set Color to 12232306
34554>>>>        Set FontSize to 14 8
34555>>>>        Set Location to 23 10
34556>>>>        Set Size to 10 63
34557>>>>        Set FontWeight to 600
34558>>>>        Set TypeFace to "MS Sans Serif"
34559>>>>        Set Enabled_State to TRUE
34560>>>>    End_Object    // otxtBranch
34561>>>>
34561>>>>    Object otxtYear is a TextBoxSub
34563>>>>        Set Label to "•¨ã©ž :          "
34564>>>>        Set Auto_Size_State to FALSE
34565>>>>        Set Color to 12232306
34566>>>>        Set FontSize to 14 8
34567>>>>        Set Location to 38 10
34568>>>>        Set Size to 10 40
34569>>>>        Set FontWeight to 600
34570>>>>        Set TypeFace to "MS Sans Serif"
34571>>>>        Set Enabled_State to TRUE
34572>>>>    End_Object    // otxtYear
34573>>>>
34573>>>>    Object otxtWorkingDay is a TextBoxSub
34575>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34576>>>>        Set Auto_Size_State to FALSE
34577>>>>        Set Color to 12232306
34578>>>>        Set FontSize to 14 8
34579>>>>        Set Location to 52 10
34580>>>>        Set Size to 10 63
34581>>>>        Set FontWeight to 600
34582>>>>        Set TypeFace to "MS Sans Serif"
34583>>>>        Set Enabled_State to TRUE
34584>>>>    End_Object    // otxtWorkingDay
34585>>>>
34585>>>>    Object otxtWorkingDay is a TextBoxSub
34587>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34588>>>>        Set Auto_Size_State to FALSE
34589>>>>        Set Color to 12232306
34590>>>>        Set FontSize to 14 8
34591>>>>        Set Location to 79 9
34592>>>>        Set Size to 10 63
34593>>>>        Set FontWeight to 600
34594>>>>        Set TypeFace to "MS Sans Serif"
34595>>>>        Set Enabled_State to TRUE
34596>>>>    End_Object    // otxtWorkingDay
34597>>>>
34597>>>>    Object chkxr is a CheckBoxSub
34599>>>>        Set Size to 13 22
34600>>>>        Set Location to 79 113
34601>>>>        Set Color to 12232306
34602>>>>    End_Object    // chkxr
34603>>>>
34603>>>>
34603>>>>    //AB-StoreStart
34603>>>>    
34603>>>>    On_Key Key_Ctrl+Key_X Send None
34604>>>>    On_Key Key_Alt+Key_X  Send None
34605>>>>    
34605>>>>    Function ifSelect_Xrhsh Returns String
34607>>>>        String  lsRecord_id
34608>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34609>>>>        send popup_modal
34610>>>>        Get psSelectedYearRecr to lsRecord_id
34611>>>>        Function_return lsRecord_Id
34612>>>>    End_Function
34613>>>>    
34613>>>>    Procedure AcceptTheValues
34615>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34616>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34616>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34616>>>>        Move Year_DD to liYearDD
34617>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34618>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34621>>>>        else begin
34622>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34623>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34624>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34627>>>>            else begin
34628>>>>                Move Company_DD to liCompanyDD
34629>>>>                Move Branch_DD  to liBranchDD
34630>>>>                Move Year_DD    to liYearDD
34631>>>>                send Request_Save to liYearDD
34632>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34633>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34634>>>>    
34634>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34635>>>>    
34635>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34636>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34637>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34638>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34639>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34640>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34641>>>>    
34641>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34642>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34643>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34644>>>>    
34644>>>>    
34644>>>>                Local String    sCode
34644>>>>                Local Integer   iBreak
34644>>>>                Move 0 to iBreak
34645>>>>                Clear Nomisma
34646>>>>                Find Gt Nomisma.Recnum
34647>>>>>
34647>>>>                While ((Found=1) And (iBreak=0))
34651>>>>                    If (Nomisma.Einai_Euro='1') Begin
34653>>>>                        Move 1 to iBreak
34654>>>>                        Move Nomisma.Nomisma_Code to sCode
34655>>>>                    End
34655>>>>>
34655>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34658>>>>                Loop
34659>>>>>
34659>>>>                Move (Trim(sCode)) to sCode
34660>>>>    
34660>>>>    
34660>>>>                Reread SysCurXR
34664>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34665>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34666>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34667>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34668>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34669>>>>                Move lsSite                     to SysCurXR.Branch_Site
34670>>>>    
34670>>>>                Move sCname                     to SysCurXR.Company_Name
34671>>>>                Move sBname                     to SysCurXR.Branch_Name
34672>>>>                Move sYname                     to SysCurXR.Year_Descr
34673>>>>    
34673>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34674>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34675>>>>    
34675>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34676>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34677>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34678>>>>    
34678>>>>                Move sCode                      to SysCurXR.Euro_Code
34679>>>>    
34679>>>>                Saverecord SysCurXR
34680>>>>                Unlock
34681>>>>>
34681>>>>    
34681>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34682>>>>                Set psSelectedYearRecr          to lsYearRecr
34683>>>>    
34683>>>>                Send Stop_Modal_ui
34684>>>>    
34684>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34685>>>>            End
34685>>>>>
34685>>>>        end
34685>>>>>
34685>>>>    End_Procedure
34686>>>>    
34686>>>>    Set Locate_Mode to Center_On_Screen
34687>>>>    
34687>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34688>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34689>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34690>>>>    
34690>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34691>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    //AB-StoreEnd
34692>>>>
34692>>>>End_Object    // oSelectYear
34693>>>>
34693>>>>
34693>>>>//AB-StoreStart
34693>>>>
34693>>>>
34693>>>>//AB-StoreEnd
34693>>>>
34693>>>>//AB/ End_Object    // prj
34693>>
34693>>Procedure Epelexe_Xrhsh
34694>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34695>>    String lsCompany lsBranch lsWhatXrhsh
34695>>    Move oSelectYear to liModalId
34696>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34697>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34700>>End_Procedure
34701>>
34701>>Procedure Allaxe_Xrhsh
34702>>    Integer rVal liModalId iID
34703>>    If (Close_All_Views(Self,True)=0) Begin
34705>>        Move oSelectYear to liModalId
34706>>        Send Epelexe_Xrhsh
34707>>    End
34707>>>
34707>>End_Procedure
34708>>
34708>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34709>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34710>>
34710>>Send Epelexe_Xrhsh
34711>>//------------------------------
34711>>
34711>Set Button_State    of (Wait(Self)) to False
34712>Set BarVisibleState of (Wait(Self)) to '' False
34713>Send Popup                          to (Wait(Self))
34714>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é §œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
34715>
34715>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34715>>>
34715>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34715>>>>>
34715>>>>>Open Users
34717>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34719>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34721>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34723>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34725>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34727>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34729>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34731>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34733>>>>>Open Oth
INCLUDING FILE: OTH.FD
34735>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34737>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34739>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34741>>>>>
34741>>>>>
34741>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34742>>>>>
34742>>>>>Function Network_User_Name Returns String
34743>>>>>    Local String sName sLength
34744>>>>>    Local Pointer lpName_Addr lpLength_Addr
34744>>>>>    Local Integer iRetval
34744>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34745>>>>>>
34745>>>>>    GetAddress Of sName To lpName_Addr
34746>>>>>    Movestr (DwordToBytes (255)) To sLength
34747>>>>>>
34747>>>>>    GetAddress Of sLength To lpLength_Addr
34748>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34749>>>>>>
34749>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34752>>>>>    Else Function_Return "User Unknown"
34754>>>>>End_Function // Network_User_Name
34755>>>>>
34755>>>>>Function fsGetOfficePath Global Returns String
34756>>>>>    String sRegistryKeyPath sRegOfficePath
34757>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34758>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34759>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34763>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34764>>>>>    If (sRegOfficePath='') Begin
34766>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34767>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34771>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34772>>>>>        If (sRegOfficePath='') Begin
34774>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34775>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34779>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34780>>>>>            If (sRegOfficePath='') Begin
34782>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34783>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34787>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34788>>>>>            End
34788>>>>>>
34788>>>>>        End
34788>>>>>>
34788>>>>>    End
34788>>>>>>
34788>>>>>    Function_Return sRegOfficePath
34789>>>>>End_Procedure
34790>>>>>
34790>>>>>
34790>>>>>Function fsGetLastDir Global Returns String
34791>>>>>    String sRegistryKeyPath sRegDir sUserName
34792>>>>>    Get Network_User_Name to sUserName
34793>>>>>
34793>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34796>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34799>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34801>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34803>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34804>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34805>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34808>>>>>    Function_Return sRegDir
34809>>>>>End_Procedure
34810>>>>>
34810>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34811>>>>>    String sRegistryKeyPath sRegDir sUserName
34812>>>>>    Get Network_User_Name to sUserName
34813>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34816>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34819>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34821>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34823>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34824>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34825>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34828>>>>>    Function_Return 0
34829>>>>>End_Procedure
34830>>>>>
34830>>>>>
34830>>>>>Function fsVresExt Global String asFileName Returns String
34831>>>>>    String rVal
34832>>>>>    Integer iPos iLen
34832>>>>>    Move (UpperCase(asFileName)) to asFileName
34833>>>>>    Move (Trim(asFileName)) to asFileName
34834>>>>>    Move 0 to iPos
34835>>>>>    For iLen from 1 to (length(asFileName))
34841>>>>>>
34841>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34844>>>>>    Loop
34845>>>>>>
34845>>>>>    If (Not(iPos)) Function_Return ''
34848>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34849>>>>>    Move (Trim(rVal)) to rVal
34850>>>>>    Function_Return rVal
34851>>>>>End_Function
34852>>>>>
34852>>>>>
34852>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34853>>>>>    Integer rVal iUser iGroup
34854>>>>>    String  sUser sRecr
34854>>>>>    Move (Trim(asViewName))     to asViewName
34855>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34856>>>>>
34856>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34858>>>>>        Get fsLoginUserID to sUser
34859>>>>>        Clear Users
34860>>>>>        Move sUser        to Users.Login_ID
34861>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34862>>>>>>
34862>>>>>        If (Found=1) Begin
34864>>>>>            Move Users.User_ID  to iUser
34865>>>>>            Move Users.Grp_ID   to iGroup
34866>>>>>            Clear GrpOth
34867>>>>>            Move iUser          to GrpOth.User_ID
34868>>>>>            Move asViewName     to GrpOth.View_Name
34869>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34870>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34871>>>>>>
34871>>>>>            If (Found=1) Begin
34873>>>>>                // rVal=1 ==> NO READ ALLOWED
34873>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34873>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34873>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34876>>>>>                Else Begin
34877>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34879>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34882>>>>>                        Else                        Move 2 to rVal
34884>>>>>                    End
34884>>>>>>
34884>>>>>                End
34884>>>>>>
34884>>>>>            End
34884>>>>>>
34884>>>>>            Else Begin
34885>>>>>                Clear GrpOth0
34886>>>>>                Move iGroup         to GrpOth0.Group_ID
34887>>>>>                Move asViewName     to GrpOth0.View_Name
34888>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34889>>>>>
34889>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34890>>>>>>
34890>>>>>                If (Found=1) Begin
34892>>>>>                    // rVal=1 ==> NO READ ALLOWED
34892>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34892>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34892>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34895>>>>>                    Else Begin
34896>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34898>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34901>>>>>                            Else                         Move 2 to rVal
34903>>>>>                        End
34903>>>>>>
34903>>>>>                    End
34903>>>>>>
34903>>>>>                End
34903>>>>>>
34903>>>>>                Else Move 0 to rVal
34905>>>>>            End
34905>>>>>>
34905>>>>>        End
34905>>>>>>
34905>>>>>        Else Move 0 to rVal
34907>>>>>    End
34907>>>>>>
34907>>>>>    Function_Return rVal
34908>>>>>End_Function
34909>>>>>
34909>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34910>>>>>    Integer rVal iUser iGroup
34911>>>>>    String  sUser sRecr
34911>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34913>>>>>        Get fsLoginUserID to sUser
34914>>>>>        Clear Users
34915>>>>>        Move sUser        to Users.Login_ID
34916>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34917>>>>>>
34917>>>>>        If (Found=1) Begin
34919>>>>>            Move Users.User_ID  to iUser
34920>>>>>            Move Users.Grp_ID   to iGroup
34921>>>>>            Clear Pedia
34922>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34923>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34924>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34925>>>>>>
34925>>>>>            If (Found=1) Begin
34927>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34928>>>>>                // Find Combination User/File/Field in GRPPEDIA
34928>>>>>                Clear GrpPedia
34929>>>>>                Move iUser                      to GrpPedia.User_ID
34930>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34931>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34932>>>>>>
34932>>>>>                If (Found=1) Begin
34934>>>>>                    // rVal=1 ==> NO READ ALLOWED
34934>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34934>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34934>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34937>>>>>                    Else Begin
34938>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34940>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34943>>>>>                            Else                            Move 2 to rVal
34945>>>>>                        End
34945>>>>>>
34945>>>>>                    End
34945>>>>>>
34945>>>>>                End
34945>>>>>>
34945>>>>>                Else Begin
34946>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34946>>>>>                    Clear GrpPed0
34947>>>>>                    Move iGroup         to GrpPed0.Group_ID
34948>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34949>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34950>>>>>>
34950>>>>>                    If (Found=1) Begin
34952>>>>>                        // rVal=1 ==> NO READ ALLOWED
34952>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34952>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34952>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34955>>>>>                        Else Begin
34956>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34958>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34961>>>>>                                Else                           Move 2 to rVal
34963>>>>>                            End
34963>>>>>>
34963>>>>>                        End
34963>>>>>>
34963>>>>>                    End
34963>>>>>>
34963>>>>>                End
34963>>>>>>
34963>>>>>            End
34963>>>>>>
34963>>>>>            Else Begin
34964>>>>>                Move 0 to rVal
34965>>>>>            End
34965>>>>>>
34965>>>>>        End
34965>>>>>>
34965>>>>>        Else Begin
34966>>>>>            Move 0 to rVal
34967>>>>>        End
34967>>>>>>
34967>>>>>    End
34967>>>>>>
34967>>>>>    Function_Return rVal
34968>>>>>End_Function
34969>>>>>
34969>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34970>>>>>    String rVal lsDirSep
34971>>>>>    Integer iPos iMet iLen iCnt
34971>>>>>    Move (Trim(asFullPath))                 To rVal
34972>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34973>>>>>    If (rVal Contains lsDirSep) Begin
34975>>>>>        Move (Length(rVal)) to iLen
34976>>>>>        Move iLen to iCnt
34977>>>>>        While iCnt Gt 0
34981>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34983>>>>>                If (iCnt=iLen) Function_Return asFullPath
34986>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34988>>>>>            End
34988>>>>>>
34988>>>>>            Decrement iCnt
34989>>>>>        End // While iCnt Gt 0
34990>>>>>>
34990>>>>>    End
34990>>>>>>
34990>>>>>    Else  Function_Return (Trim(asFullPath))
34992>>>>>    Function_Return rVal
34993>>>>>End_Function
34994>>>>>
34994>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34995>>>>>    String rVal lsDirSep
34996>>>>>    Integer iPos iMet iLen iCnt
34996>>>>>    Move (Trim(asFullPath))                 To rVal
34997>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34998>>>>>    If (rVal Contains lsDirSep) Begin
35000>>>>>        Move (Length(rVal)) to iLen
35001>>>>>        Move iLen to iCnt
35002>>>>>        While iCnt Gt 0
35006>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35009>>>>>            Decrement iCnt
35010>>>>>        End // While iCnt Gt 0
35011>>>>>>
35011>>>>>    End
35011>>>>>>
35011>>>>>    Function_Return rVal
35012>>>>>End_Function
35013>>>>>
35013>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35013>>>>>//    Local String rVal lsTmp lsOO lsLL
35013>>>>>//    Local Number lnOO lnLL
35013>>>>>
35013>>>>>//    Move '' to lsOO
35013>>>>>//    Move '' to lsLL
35013>>>>>//    Move '' to rVal
35013>>>>>
35013>>>>>//    Move (Integer(anTime))                              to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35013>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>
35013>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35013>>>>>
35013>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35013>>>>>//    Else         Move (String(lnOO))                    to lsOO
35013>>>>>//    Move (Trim(lsOO))                                   to lsOO
35013>>>>>
35013>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35013>>>>>//    Else         Move (String(lnLL))                    to lsLL
35013>>>>>//    Move (Trim(lsLL))                                   to lsLL
35013>>>>>
35013>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35013>>>>>
35013>>>>>//    Move (Trim(rVal)) to rVal
35013>>>>>
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35013>>>>>//    Local Number rVal nOres nLepta
35013>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35013>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35013>>>>>//    Move (nOres+(nLepta/100))       to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35013>>>>>//    Local Integer rVal
35013>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35013>>>>>//                                                                    Number anEndTime    ;
35013>>>>>//                                                                    Returns Integer
35013>>>>>//    Local Integer rVal iMinStart iMinEnd
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35013>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35013>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35013>>>>>//                                                                Number anEndTime    ;
35013>>>>>//                                                                Returns Number
35013>>>>>//    Local Integer iTmp
35013>>>>>//    Local Number  rVal
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35013>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>Function fsLoginUserID Global Returns String
35014>>>>>    Local String LastLogin# LoginUserid#
35015>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35018>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35021>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35023>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35026>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35029>>>>>    Trim LoginUserID# to LoginUserID#
35030>>>>>>
35030>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35033>>>>>    Function_Return LoginUserID#
35034>>>>>End_Function
35035>>>>>
35035>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35036>>>>>    Integer rVal
35037>>>>>    String  lsCurrentWksp
35037>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35040>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35043>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35045>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35045>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35045>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35048>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35051>>>>>    Function_Return rVal
35052>>>>>End_Function
35053>>>>>
35053>>>>>
35053>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35054>>>>>    String rVal lsCurrentWksp
35055>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35058>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35061>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35063>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35063>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35063>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35066>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35069>>>>>    Function_Return (Trim(rVal))
35070>>>>>End_Function
35071>>>>>
35071>>>>>
35071>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35072>>>>>    Integer rVal
35073>>>>>    String  lsCurrentWksp
35073>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35076>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35079>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35081>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35084>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35087>>>>>    Function_Return rVal
35088>>>>>End_Function
35089>>>>>
35089>>>>>
35089>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35090>>>>>    String rVal lsCurrentWksp
35091>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35094>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35097>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35099>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35102>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35105>>>>>    Function_Return (Trim(rVal))
35106>>>>>End_Function
35107>>>>>
35107>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35108>>>>>    Integer rVal
35109>>>>>    String  lsCurrentWksp
35109>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35112>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35115>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35117>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35120>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35123>>>>>    Function_Return rVal
35124>>>>>End_Function
35125>>>>>
35125>>>>>
35125>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35126>>>>>    String rVal lsCurrentWksp
35127>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35130>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35133>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35135>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35138>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35141>>>>>    Function_Return (Trim(rVal))
35142>>>>>End_Function
35143>>>>>
35143>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35144>>>>>    String rVal lsCurrentWksp
35145>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35148>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35151>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35153>>>>>    Append lsCurrentWksp "\FEM"
35154>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35157>>>>>    Function_Return (Trim(rVal))
35158>>>>>End_Function
35159>>>>>
35159>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35160>>>>>    String rVal lsCurrentWksp
35161>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35164>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35167>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35169>>>>>    Append lsCurrentWksp "\FEM"
35170>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35173>>>>>    Function_Return (Trim(rVal))
35174>>>>>End_Function
35175>>>>>
35175>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35176>>>>>    Integer rVal
35177>>>>>    String  lsCurrentWksp
35177>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35180>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35183>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35185>>>>>    Append lsCurrentWksp "\FEM"
35186>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35189>>>>>    Function_Return rVal
35190>>>>>End_Function
35191>>>>>
35191>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35192>>>>>    Integer rVal
35193>>>>>    String  lsCurrentWksp
35193>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35196>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35199>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35201>>>>>    Append lsCurrentWksp "\FEM"
35202>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35205>>>>>    Function_Return rVal
35206>>>>>End_Function
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>Function fig_Is_Admin Global Returns Integer
35208>>>>>    String sUser
35209>>>>>    Integer rVal
35209>>>>>    Get fsLoginUserID to sUser
35210>>>>>    Move (trim(sUser)) to sUser
35211>>>>>    Clear Users
35212>>>>>    Move sUser to Users.Login_ID
35213>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35214>>>>>>
35214>>>>>    Move Users.Admin_Rights to rVal
35215>>>>>    Function_Return rVal
35216>>>>>End_Function
35217>>>>>
35217>>>>>Function fig_The_User_Group Global Returns Integer
35218>>>>>    String sUser
35219>>>>>    Get fsLoginUserID   to sUser
35220>>>>>    Move (trim(sUser))  to sUser
35221>>>>>    Clear Users
35222>>>>>    Move sUser          to Users.Login_ID
35223>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35224>>>>>>
35224>>>>>    Clear UserGrps
35225>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35226>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35227>>>>>>
35227>>>>>    Function_Return UserGrps.Grp_ID
35228>>>>>End_Function
35229>>>>>
35229>>>>>Function fsg_The_User_Department Global Returns String
35230>>>>>    String sUser
35231>>>>>    Get fsLoginUserID   to sUser
35232>>>>>    Move (trim(sUser))  to sUser
35233>>>>>    Clear Users
35234>>>>>    Move sUser          to Users.Login_ID
35235>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35236>>>>>>
35236>>>>>    Clear Departm
35237>>>>>    Move Users.Departm_Code   to Departm.Code
35238>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35239>>>>>>
35239>>>>>    Function_Return Departm.Code
35240>>>>>End_Function
35241>>>>>
35241>>>>>
35241>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35242>>>>>    Integer rVal
35243>>>>>    Move (trim(asUser)) to asUser
35244>>>>>    Clear Users
35245>>>>>    Move asUser to Users.Login_ID
35246>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35247>>>>>>
35247>>>>>    Move Users.Admin_Rights to rVal
35248>>>>>    Function_Return rVal
35249>>>>>End_Function
35250>>>>>
35250>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35251>>>>>    Move (trim(asUser))  to asUser
35252>>>>>    Clear Users
35253>>>>>    Move asUser          to Users.Login_ID
35254>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35255>>>>>>
35255>>>>>    Clear UserGrps
35256>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35257>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35258>>>>>>
35258>>>>>    Function_Return UserGrps.Grp_ID
35259>>>>>End_Function
35260>>>>>
35260>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35261>>>>>    Move (trim(asUser))  to asUser
35262>>>>>    Clear Users
35263>>>>>    Move asUser          to Users.Login_ID
35264>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35265>>>>>>
35265>>>>>    Clear Departm
35266>>>>>    Move Users.Departm_Code   to Departm.Code
35267>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35268>>>>>>
35268>>>>>    Function_Return Departm.Code
35269>>>>>End_Function
35270>>>>>
35270>>>>>
35270>>>
35270>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35271>>>
35271>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35273>>>    Open Users
35275>>>    Open Views
INCLUDING FILE: VIEWS.FD
35277>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35279>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35281>>>    Open Arxeia
35283>>>    Open GrpArx
35285>>>
35285>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35286>>>        String  lsView lsLogin
35287>>>        Integer liUser  liViews iGroup
35287>>>
35287>>>        Move (fsLoginUserID())      to lsLogin
35288>>>        Move (Trim(ToOEM(asView)))  to lsView
35289>>>
35289>>>        //////  /////////////////////////////////////
35289>>>        Clear Users
35290>>>        Move lsLogin    to Users.Login_ID
35291>>>
35291>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35292>>>>
35292>>>        If (Found=1)  Begin
35294>>>            Move Users.User_ID  to liUser
35295>>>            Move Users.Grp_ID   to iGroup
35296>>>        End
35296>>>>
35296>>>        Else Function_Return 0
35298>>>
35298>>>        Clear Views
35299>>>        Move (Trim(lsView)) to Views.Menu_Name
35300>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35301>>>>
35301>>>        If (Found=1) Begin
35303>>>            Move Views.View_ID to liViews
35304>>>            Clear GrpViews
35305>>>            Move liUser    to GrpViews.User_ID
35306>>>            Move liViews   to GrpViews.View_ID
35307>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35308>>>>
35308>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35310>>>                Function_Return (GrpViews.Allow_Read<>'1')
35311>>>            End
35311>>>>
35311>>>            Else Begin
35312>>>                Clear GrpView0
35313>>>                Move iGroup    to GrpView0.Group_ID
35314>>>                Move liViews   to GrpView0.View_ID
35315>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35316>>>>
35316>>>                If (Found=1) Begin
35318>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35319>>>                End
35319>>>>
35319>>>                Else         Function_Return 0
35321>>>            End
35321>>>>
35321>>>        End
35321>>>>
35321>>>        Else Function_Return 0
35323>>>    End_Function
35324>>>
35324>>>//    Procedure Enhmerose_Views_File_In_Class
35324>>>//        Integer liCount liInt liLastNo
35324>>>//        String lsStr
35324>>>//        Get Item_Count to liCount
35324>>>//        // find last view_id
35324>>>//        Clear Views
35324>>>//        Move 9999 to Views.View_ID
35324>>>//        Find lt Views by index.1 // view_id
35324>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35324>>>//        Else            Move 0              to liLastNo
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Begin
35324>>>//                Clear Views
35324>>>//                Move lsStr to Views.Menu_Name
35324>>>//                Find eq Views by index.2 // Views.Menu_Name
35324>>>//                If (NOT(Found)) Begin
35324>>>//                    Add 1 to liLastNo
35324>>>//                    Move liLastNo to Views.View_ID
35324>>>//                    Saverecord Views
35324>>>//                End
35324>>>//            End
35324>>>//        Loop
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35324>>>//        Loop
35324>>>//    End_procedure
35324>>>
35324>>>    Procedure OnInitMenu
35325>>>        Integer liCount liInt liLastNo
35326>>>        String lsStr
35326>>>
35326>>>        Get Item_Count to liCount
35327>>>
35327>>>        // find last view_id
35327>>>        Clear Views
35328>>>        Move 9999 to Views.View_ID
35329>>>        Find lt Views by index.1 // view_id
35330>>>>
35330>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35333>>>        Else            Move 0              to liLastNo
35335>>>        For liInt From 0 to (liCount-1)
35341>>>>
35341>>>            Get Value item liInt to lsStr
35342>>>            Move (Trim(lsStr)) to lsStr
35343>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35345>>>                Clear Views
35346>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35347>>>                Find eq Views by index.2 // Views.Menu_Name
35348>>>>
35348>>>                If (NOT(Found)) Begin
35350>>>                    Add 1 to liLastNo
35351>>>                    Move liLastNo to Views.View_ID
35352>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35352>>>                    Saverecord Views
35353>>>                End
35353>>>>
35353>>>            End
35353>>>>
35353>>>        Loop
35354>>>>
35354>>>        For liInt From 0 to (liCount-1)
35360>>>>
35360>>>            Get Value item liInt to lsStr
35361>>>            Move (Trim(lsStr)) to lsStr
35362>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35363>>>        Loop
35364>>>>
35364>>>
35364>>>    End_procedure
35365>>>
35365>>>//    Procedure End_Construct_Object
35365>>>//        Forward Send End_Construct_Object
35365>>>//        Send Enhmerose_Views_File_In_Class
35365>>>//    End_Procedure
35365>>>
35365>>>End_Class //ButtonSub
35366>>>
35366>>>
35366>
35366>//------------------------------
35366>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
35366>>>//****************************************************************************
35366>>>//
35366>>>// $File name  : FlexOLE
35366>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
35366>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35366>>>// $Author     : JW, SF
35366>>>// $System     : DFOLE
35366>>>// Created     : 96-05-30 @ 18.12.51
35366>>>// $Last Rev   : 96-10-09 @ 14.59.35
35366>>>//
35366>>>// $Description
35366>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
35366>>>// Including all DLL interface declarations and DataFlex classes
35366>>>//
35366>>>// $Rev History
35366>>>//   96-05-30 File header created
35366>>>//
35366>>>//****************************************************************************
35366>>>
35366>>>USE DLL
35366>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
35366>>>>>//****************************************************************************
35366>>>>>//
35366>>>>>// $File name  : FOLE_API
35366>>>>>// $File title : API for FlexOLE
35366>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35366>>>>>// $Author     : JW, SF
35366>>>>>// $System     : FlexOLE
35366>>>>>// Created     : 96-05-30 @ 18.12.51
35366>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
35366>>>>>//
35366>>>>>// $Description
35366>>>>>//  DLL interface declarations
35366>>>>>//
35366>>>>>// $Rev History
35366>>>>>//   96-05-30 File header created
35366>>>>>//
35366>>>>>//****************************************************************************
35366>>>>>
35366>>>>>
35366>>>>>USE DLL
35366>>>>>
35366>>>>>// Global variable for OLE
35366>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
35366>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
35366>>>>>
35366>>>>>//Global integer for objectId
35366>>>>>Integer oOLEVariantId
35366>>>>>
35366>>>>>
35366>>>>>
35366>>>>>// Optional param for OLEVariant.
35366>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
35366>>>>>
35366>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
35366>>>>>// to signify that this parameter is optional and not specified.
35366>>>>>// It is only used internally, DON'T use it directly, see above constant.
35366>>>>>
35366>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
35366>>>>>
35366>>>>>// Null terminating for C strings
35366>>>>>
35366>>>>>// Alias data types
35366>>>>>                            // but since DataFlex has no substitute data type
35366>>>>>                            // it is internally casted back and forth
35366>>>>>                            // into an Integer
35366>>>>>                            // NOTE! Might be changed to a one char string
35366>>>>>
35366>>>>>
35366>>>>>
35366>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
35366>>>>>// It looks like we have to create these anyway (to compile cleanly)
35366>>>>>
35366>>>>>
35366>>>>>Type TP_OLEVariant
35366>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
35366>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
35366>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
35366>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
35366>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
35366>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
35366>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
35366>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
35366>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
35366>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
35366>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
35366>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
35366>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
35366>>>>>End_Type
35366>>>>>
35366>>>>>
35366>>>>>// VARIANT constants used with the vt field in an OLEVariant type
35366>>>>>
35366>>>>>
35366>>>>>
35366>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
35366>>>>>
35366>>>>>// Used to register the OCX event notification messages
35366>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
35367>>>>>
35367>>>>>// External functions providing access to DFOLECLN.DLL
35367>>>>>// These functions are normally not accessed directly, they are
35367>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
35367>>>>>
35367>>>>>//********DLL Interface OLE Auto General Functions************
35367>>>>>
35367>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
35368>>>>>
35368>>>>>
35368>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35369>>>>>
35369>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35370>>>>>
35370>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
35371>>>>>
35371>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35372>>>>>
35372>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35373>>>>>
35373>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
35374>>>>>
35374>>>>>//********DLL Interface OLE Auto Get Property Functions**************
35374>>>>>
35374>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35375>>>>>
35375>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35376>>>>>
35376>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35377>>>>>
35377>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35378>>>>>
35378>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35379>>>>>
35379>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
35380>>>>>
35380>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35381>>>>>
35381>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35382>>>>>
35382>>>>>
35382>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
35383>>>>>
35383>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
35384>>>>>
35384>>>>>
35384>>>>>//********DLL Interface OLE Auto Set Property Functions**************
35384>>>>>
35384>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
35385>>>>>
35385>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35386>>>>>
35386>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
35387>>>>>
35387>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
35388>>>>>
35388>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
35389>>>>>
35389>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
35390>>>>>
35390>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
35391>>>>>
35391>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
35392>>>>>
35392>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
35393>>>>>
35393>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35394>>>>>
35394>>>>>
35394>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
35394>>>>>
35394>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
35395>>>>>
35395>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
35396>>>>>
35396>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35397>>>>>
35397>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
35398>>>>>
35398>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
35399>>>>>
35399>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
35400>>>>>
35400>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
35401>>>>>
35401>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
35402>>>>>
35402>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
35403>>>>>
35403>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35404>>>>>
35404>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
35405>>>>>
35405>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
35405>>>>>
35405>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35406>>>>>
35406>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35407>>>>>
35407>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35408>>>>>
35408>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35409>>>>>
35409>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35410>>>>>
35410>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35411>>>>>
35411>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35412>>>>>
35412>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35413>>>>>
35413>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35414>>>>>
35414>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
35415>>>>>
35415>>>>>
35415>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
35416>>>>>
35416>>>>>//********DLL Interface OLE Control Functions*********************
35416>>>>>
35416>>>>>
35416>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
35417>>>>>
35417>>>>>
35417>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
35418>>>>>
35418>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
35419>>>>>
35419>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35420>>>>>
35420>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35421>>>>>
35421>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
35422>>>>>
35422>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35423>>>>>
35423>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35424>>>>>
35424>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35425>>>>>
35425>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35426>>>>>
35426>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
35427>>>>>
35427>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
35428>>>>>
35428>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
35429>>>>>
35429>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
35430>>>>>
35430>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
35431>>>>>
35431>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
35432>>>>>
35432>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
35433>>>>>
35433>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
35434>>>>>
35434>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
35435>>>>>
35435>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
35436>>>>>
35436>>>>>
35436>>>>>
35436>>>>>// This command is only used internaly and should NOT be used by the developer
35436>>>>>
35436>>>USE DFEXTCLM
35436>>>USE EXTFRM
35436>>>USE DBEXTFRM
35436>>>
35436>>>//**********
35436>>>//*** Error messages***
35436>>>//**********
35436>>>
35436>>>    Enum_List
35436>>>        Define OLE_SV_LANG
35436>>>        Define OLE_US_LANG
35436>>>    End_Enum_List
35436>>>
35436>>>    Define OLE_CURR_LANG For OLE_US_LANG
35436>>>
35436>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
35436>>>>
35436>>>
35436>>>
35436>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
35436>>>// tasks involved working with the OLEVariant.
35436>>>Class cOLEVariant is an array
35437>>>    Procedure Construct_Object
35438>>>        Forward Send Construct_Object
35440>>>        Local Integer iRetVal
35441>>>        Move (DFOleInit()) to iRetVal
35442>>>        Send OCXInit
35443>>>    End_Procedure
35444>>>
35444>>>    Procedure Destroy_Object
35445>>>        Local Integer iRetVal
35446>>>        Move (DFOleUninit()) to iRetVal
35447>>>        Forward Send Destroy_Object
35449>>>    End_Procedure
35450>>>
35450>>>    Procedure OCXInit
35451>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
35452>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
35453>>>    End_Procedure
35454>>>
35454>>>    Function GetType  OLEVariant var Returns DWORD
35455>>>        Local DWORD varVt
35456>>>        GetBuff from var at Variant.vt to varVt
35457>>>        Function_Return varVt
35458>>>    End_Function
35459>>>
35459>>>    Function GetShort OLEVariant var Returns Integer
35460>>>        Local Integer iVal
35461>>>        GetBuff from var at Variant.iVal to iVal
35462>>>        Function_Return iVal
35463>>>    End_Function
35464>>>
35464>>>    Function GetInteger OLEVariant var Returns Integer
35465>>>        Local Integer lVal
35466>>>        GetBuff from var at Variant.lVal to lVal
35467>>>        Function_Return lVal
35468>>>    End_Function
35469>>>
35469>>>    Function GetFloat OLEVariant var Returns OLEReal
35470>>>        Local OLEReal fltVal
35471>>>        GetBuff_String from var at Variant.fltVal to fltVal
35472>>>        Function_Return fltVal
35473>>>    End_Function
35474>>>
35474>>>    Function GetDouble OLEVariant var Returns OLEReal
35475>>>        Local OLEReal dblVal
35476>>>        GetBuff_String from var at Variant.dblVal to dblVal
35477>>>        Function_Return dblVal
35478>>>    End_Function
35479>>>
35479>>>    Function GetCurrency OLEVariant var Returns Number
35480>>>        Local Number cyVal
35481>>>        GetBuff_String from var at Variant.cyVal to cyVal
35482>>>        Function_Return cyVal
35483>>>    End_Function
35484>>>
35484>>>    Function GetDate OLEVariant var Returns Date
35485>>>        Local Date dtVal
35486>>>        GetBuff from var at Variant.dtVal to dtVal
35487>>>        Function_Return dtVal
35488>>>    End_Function
35489>>>
35489>>>    Function GetString OLEVariant var Returns String
35490>>>        Local String strVal
35491>>>        GetBuff_String from var at Variant.strVal to strVal
35492>>>        Function_Return strVal
35493>>>    End_Function
35494>>>
35494>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
35495>>>        Local LPDispatch dspVal
35496>>>        GetBuff from var at Variant.dspVal to dspVal
35497>>>        Function_Return dspVal
35498>>>    End_Function
35499>>>
35499>>>    Function GetOLEError OLEVariant var Returns OLEError
35500>>>        Local OLEError errVal
35501>>>        GetBuff from var at Variant.errVal to errVal
35502>>>        Function_Return errVal
35503>>>    End_Function
35504>>>
35504>>>    Function GetBool OLEVariant var Returns Bool
35505>>>        Local Bool blVal
35506>>>        GetBuff from var at Variant.blVal to blVal
35507>>>        Function_Return blVal
35508>>>    End_Function
35509>>>
35509>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
35510>>>        Local LPIUnknown uknVal
35511>>>        GetBuff from var at Variant.uknVal to uknVal
35512>>>        Function_Return uknVal
35513>>>    End_Function
35514>>>
35514>>>    Function GetUChar OLEVariant var Returns UChar
35515>>>        Local UChar ui1Val
35516>>>        GetBuff from var at Variant.ui1Val to ui1Val
35517>>>        Function_Return ui1Val
35518>>>    End_Function
35519>>>
35519>>>    Function GetValue OLEVariant var Returns String
35520>>>        Local DWORD vt
35521>>>        Local String retVal
35521>>>        Get GetType var to vt
35522>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
35525>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
35529>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
35533>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
35537>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
35541>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
35545>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
35549>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
35553>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
35557>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
35561>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
35565>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
35569>>>        Function_Return retVal
35570>>>    End_Function
35571>>>
35571>>>    Function PutValue DWORD vt String val Returns OLEVariant
35572>>>        Inst_OLEVariant var
35574>>>        Put vt to var at Variant.vt
35575>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
35578>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
35582>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
35586>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
35590>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
35594>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
35598>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
35602>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
35606>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
35610>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
35614>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
35618>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
35622>>>        Else begin
35623>>>            Put OLE_VT_ERROR to var at Variant.vt
35624>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
35625>>>        End
35625>>>>
35625>>>        Function_Return var
35626>>>    End_Function
35627>>>
35627>>>End_Class
35628>>>
35628>>>// The one and only cOLEVariant helper object
35628>>>Object oOLEVariant is a cOLEVariant
35630>>>        Move Current_Object to oOLEVariantId
35631>>>End_Object
35632>>>
35632>>>//Command so we get nicer code for the events, only used internally
35632>>>
35632>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
35632>>>
35632>>>// Command to both set the datatype and value to an OLEVariant
35632>>>
35632>>>
35632>>>// The OLE Base class, all OLE classes are derived from this class
35632>>>// Defines basic functionality and conversation with DLL interface
35632>>>
35632>>>Class cCOM_IDispatch is a Message
35633>>>
35633>>>    Procedure DefineCOM_IDispatch
35634>>>        Property String  progIdStr Public ""
35635>>>        Property Integer ClientId Public 0
35636>>>        Property Integer AutoAddRef Public 0
35637>>>    End_Procedure
35638>>>
35638>>>// GetProperty functions
35638>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
35639>>>        Local Integer lpropVal iClientId
35640>>>        Get clientId to iClientId
35641>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
35642>>>        Function_Return lpropVal
35643>>>    End_Function
35644>>>
35644>>>    Function GetShortProperty DWORD dwDispId returns Integer
35645>>>        Local Integer lpropVal iClientId
35646>>>        Get clientId to iClientId
35647>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
35648>>>        Function_Return lpropVal
35649>>>    End_Function
35650>>>
35650>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
35651>>>        Local BOOL lpropVal
35652>>>        Local Integer iClientId
35652>>>        Get clientId to iClientId
35653>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
35654>>>        Function_Return lpropVal
35655>>>    End_Function
35656>>>
35656>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
35657>>>        Local Number lpropVal
35658>>>        Local String lsProp
35658>>>        Local Integer iClientId iRetVal
35658>>>        Local Pointer llpsprop
35658>>>        Get clientId to iClientId
35659>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35660>>>        GetAddress of lsprop to llpsprop
35661>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35662>>>        Move lsProp to lpropVal
35663>>>        Function_Return lpropVal
35664>>>    End_Function
35665>>>
35665>>>    Function GetDateProperty DWORD dwDispId returns Date
35666>>>        Local Date lpropVal
35667>>>        Local Integer iClientId
35667>>>        Get clientId to iClientId
35668>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
35669>>>        Function_Return lpropVal
35670>>>    End_Function
35671>>>
35671>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
35672>>>        Local LPDispatch lpropVal
35673>>>        Local Integer iClientId
35673>>>        Get clientId to iClientId
35674>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
35675>>>        Function_Return lpropVal
35676>>>    End_Function
35677>>>
35677>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
35678>>>        Local OLEReal lpropVal
35679>>>        Local Integer iClientId iRetVal
35679>>>        Local String lsProp
35679>>>        Local Pointer llpsprop
35679>>>        Get clientId to iClientId
35680>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35681>>>        GetAddress of lsprop to llpsprop
35682>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35683>>>        Move lsProp to lpropVal
35684>>>        Function_Return lpropVal
35685>>>    End_Function
35686>>>
35686>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
35687>>>        Local OLEReal lpropVal
35688>>>        Local Integer iClientId iRetVal
35688>>>        Local String lsProp
35688>>>        Local Pointer llpsprop
35688>>>        Get clientId to iClientId
35689>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35690>>>        GetAddress of lsprop to llpsprop
35691>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35692>>>        Move lsProp to lpropVal
35693>>>        Function_Return lpropVal
35694>>>    End_Function
35695>>>
35695>>>    Function GetStringProperty DWORD dwDispId returns String
35696>>>        Local String lpropVal
35697>>>        Local Integer iClientId iRetVal
35697>>>        Local Pointer llppropVal
35697>>>        Get clientId to iClientId
35698>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
35699>>>        GetAddress of lpropVal to llppropval
35700>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35701>>>        Function_Return (CString(lpropVal))
35702>>>    End_Function
35703>>>
35703>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
35704>>>        Local OLEVariant lpropVal
35705>>>        Local Integer iClientId iRetVal
35705>>>        Local Pointer llppropVal
35705>>>        Get clientId to iClientId
35706>>>        ZeroType TP_OLEVariant to lpropVal
35707>>>        GetAddress of lpropVal to llppropval
35708>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35709>>>        Function_Return lpropVal
35710>>>    End_Function
35711>>>
35711>>>// SetProperty procedures
35711>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
35712>>>        Local Integer iClientId iRetVal
35713>>>        Get ClientId to iClientId
35714>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35715>>>    End_Procedure
35716>>>
35716>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
35717>>>        Local Integer iClientId iRetVal
35718>>>        Get ClientId to iClientId
35719>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35720>>>    End_Procedure
35721>>>
35721>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
35722>>>        Local Integer iClientId iRetVal
35723>>>        Get ClientId to iClientId
35724>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35725>>>    End_Procedure
35726>>>
35726>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
35727>>>        Local Integer iClientId iRetVal
35728>>>        Local String lsprop
35728>>>        Get ClientId to iClientId
35729>>>        Move lpropVal to lsprop
35730>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
35731>>>    End_Procedure
35732>>>
35732>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
35733>>>        Local Integer iClientId iRetVal
35734>>>        Get ClientId to iClientId
35735>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35736>>>    End_Procedure
35737>>>
35737>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
35738>>>        Local Integer iClientId iRetVal
35739>>>        Get ClientId to iClientId
35740>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35741>>>    End_Procedure
35742>>>
35742>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
35743>>>        Local Integer iClientId iRetVal
35744>>>        Local String lsprop
35744>>>        Get ClientId to iClientId
35745>>>        Move lpropVal to lsprop
35746>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
35747>>>    End_Procedure
35748>>>
35748>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
35749>>>        Local Integer iClientId iRetVal
35750>>>        Local String lsprop
35750>>>        Get ClientId to iClientId
35751>>>        Move lpropVal to lsprop
35752>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
35753>>>    End_Procedure
35754>>>
35754>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
35755>>>        Local Integer iClientId iRetVal
35756>>>        Get ClientId to iClientId
35757>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35758>>>    End_Procedure
35759>>>
35759>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
35760>>>        Local Integer iClientId iRetVal
35761>>>        Get ClientId to iClientId
35762>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
35765>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35766>>>    End_Procedure
35767>>>
35767>>>// Pre-Invoke functions
35767>>>    Procedure DeclareParams Integer nrOfParams
35768>>>        Local Integer iClientId iRetVal
35769>>>        Get ClientId to iCLientId
35770>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
35771>>>    End_Procedure
35772>>>
35772>>>    Procedure DefineIntegerParam Integer param
35773>>>        Local Integer iClientId iRetVal
35774>>>        Get ClientId to iClientId
35775>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
35776>>>    End_Procedure
35777>>>
35777>>>    Procedure DefineShortParam Integer param
35778>>>        Local Integer iClientId iRetVal
35779>>>        Get ClientId to iClientId
35780>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
35781>>>    End_Procedure
35782>>>
35782>>>    Procedure DefineBoolParam BOOL param
35783>>>        Local Integer iClientId iRetVal
35784>>>        Get ClientId to iClientId
35785>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
35786>>>    End_Procedure
35787>>>
35787>>>    Procedure DefineCurrencyParam Number param
35788>>>        Local Integer iClientId iRetVal
35789>>>        Local String lsparam
35789>>>        Get ClientId to iClientId
35790>>>        Move param to lsparam
35791>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
35792>>>    End_Procedure
35793>>>
35793>>>    Procedure DefineDateParam Date param
35794>>>        Local Integer iClientId iRetVal
35795>>>        Get ClientId to iClientId
35796>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
35797>>>    End_Procedure
35798>>>
35798>>>    Procedure DefineLPDispatchParam LPDispatch param
35799>>>        Local Integer iClientId iRetVal
35800>>>        Get ClientId to iClientId
35801>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
35802>>>    End_Procedure
35803>>>
35803>>>    Procedure DefineRealParam OLEReal param
35804>>>        Local Integer iClientId iRetVal
35805>>>        Local String lsparam
35805>>>        Get ClientId to iClientId
35806>>>        Move param to lsparam
35807>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
35808>>>    End_Procedure
35809>>>
35809>>>    Procedure DefineShortRealParam OLEReal param
35810>>>        Local Integer iClientId iRetVal
35811>>>        Local String lsparam
35811>>>        Get ClientId to iClientId
35812>>>        Move param to lsparam
35813>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
35814>>>    End_Procedure
35815>>>
35815>>>    Procedure DefineStringParam String param
35816>>>        Local Integer iClientId iRetVal
35817>>>        Get ClientId to iClientId
35818>>>        Append param OLENull
35819>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
35820>>>    End_Procedure
35821>>>
35821>>>    Procedure DefineOLEVariantParam OLEVariant param
35822>>>        Local Integer iClientId iRetVal
35823>>>        Get ClientId to iClientId
35824>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
35827>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
35828>>>    End_Procedure
35829>>>
35829>>>// Invoke functions
35829>>>    Procedure InvokeVoidFunction DWORD dwDispId
35830>>>        Local Integer iClientId iRetVal
35831>>>        Get ClientId to iClientId
35832>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
35833>>>    End_Procedure
35834>>>
35834>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
35835>>>        Local Integer iClientId iRetVal
35836>>>        Get ClientId to iClientId
35837>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
35838>>>        Function_Return iRetVal
35839>>>    End_Function
35840>>>
35840>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
35841>>>        Local Integer iClientId iRetVal
35842>>>        Get ClientId to iClientId
35843>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
35844>>>        Function_Return iRetVal
35845>>>    End_Function
35846>>>
35846>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
35847>>>        Local Integer iClientId iRetVal
35848>>>        Get ClientId to iClientId
35849>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
35850>>>        Function_Return iRetVal
35851>>>    End_Function
35852>>>
35852>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
35853>>>        Local Integer iClientId iRetVal
35854>>>        Local Number nRetVal
35854>>>        Local String sRetVal
35854>>>        Local Pointer psRetVal
35854>>>        Get ClientId to iClientId
35855>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35856>>>        GetAddress of sRetVal to psRetVal
35857>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35858>>>        Move sRetVal to nRetVal
35859>>>        Function_Return nRetVal
35860>>>    End_Function
35861>>>
35861>>>    Function InvokeDateFunction DWORD dwDispId returns Date
35862>>>        Local Integer iClientId
35863>>>        Local Date dRetVal
35863>>>        Get ClientId to iClientId
35864>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
35865>>>        Function_Return dRetVal
35866>>>    End_Function
35867>>>
35867>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
35868>>>        Local Integer iClientId
35869>>>        Local LPDispatch lpdRetVal
35869>>>        Get ClientId to iClientId
35870>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
35871>>>        Function_Return lpdRetVal
35872>>>    End_Function
35873>>>
35873>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
35874>>>        Local Integer iClientId iRetVal
35875>>>        Local OLEReal rRetVal
35875>>>        Local String sRetVal
35875>>>        Local Pointer psRetVal
35875>>>        Get ClientId to iClientId
35876>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35877>>>        GetAddress of sRetVal to psRetVal
35878>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35879>>>        Move sRetVal to rRetVal
35880>>>        Function_Return rRetVal
35881>>>    End_Function
35882>>>
35882>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
35883>>>        Local Integer iClientId iRetVal
35884>>>        Local OLEReal rRetVal
35884>>>        Local String sRetVal
35884>>>        Local Pointer psRetVal
35884>>>        Get ClientId to iClientId
35885>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35886>>>        GetAddress of sRetVal to psRetVal
35887>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35888>>>        Move sRetVal to rRetVal
35889>>>        Function_Return rRetVal
35890>>>    End_Function
35891>>>
35891>>>    Function InvokeStringFunction DWORD dwDispId returns String
35892>>>        Local Integer iClientId iRetVal
35893>>>        Local String sRetVal
35893>>>        Local Pointer psRetVal
35893>>>        Get ClientId to iClientId
35894>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35895>>>        GetAddress of sRetVal to psRetVal
35896>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35897>>>        Function_Return (CString(sRetVal))
35898>>>    End_Function
35899>>>
35899>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
35900>>>        Local Integer iClientId iRetVal
35901>>>        Local OLEVariant vRetVal
35901>>>        Local Pointer pvRetVal
35901>>>        Get ClientId to iClientId
35902>>>        ZeroType TP_OLEVariant to vRetVal
35903>>>        GetAddress of vRetVal to pvRetVal
35904>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
35905>>>        Function_Return vRetVal
35906>>>    End_Function
35907>>>
35907>>>
35907>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
35907>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
35908>>>        Local Integer iRetVal
35909>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
35910>>>        Function_Return iRetVal
35911>>>    End_Function
35912>>>
35912>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
35913>>>        Local Integer iRetVal
35914>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
35915>>>        Function_Return iRetVal
35916>>>    End_Function
35917>>>
35917>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
35918>>>        Local Bool iRetVal
35919>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
35920>>>        Function_Return iRetVal
35921>>>    End_Function
35922>>>
35922>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
35923>>>        Local Integer iretVal
35924>>>        Local Currency cRetVal
35924>>>        Local String destStr
35924>>>        Local Pointer pdestStr
35924>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35925>>>        GetAddress of destStr to pdestStr
35926>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
35927>>>        Move (CString(destStr)) to cRetVal
35928>>>        Function_Return cRetVal
35929>>>    End_Function
35930>>>
35930>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
35931>>>        Local Date dRetVal
35932>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
35933>>>        Function_Return dRetVal
35934>>>    End_Function
35935>>>
35935>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
35936>>>        Local LPDispatch lpRetVal
35937>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
35938>>>        Function_Return lpRetVal
35939>>>    End_Function
35940>>>
35940>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
35941>>>        Local Integer iretVal
35942>>>        Local OLEReal rRetVal
35942>>>        Local String destStr
35942>>>        Local Pointer pdestStr
35942>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35943>>>        GetAddress of destStr to pdestStr
35944>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
35945>>>        Move (CString(destStr)) to rRetVal
35946>>>        Function_Return rRetVal
35947>>>    End_Function
35948>>>
35948>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
35949>>>        Local Integer iretVal
35950>>>        Local ShortReal rRetVal
35950>>>        Local String destStr
35950>>>        Local Pointer pdestStr
35950>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35951>>>        GetAddress of destStr to pdestStr
35952>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
35953>>>        Move (CString(destStr)) to rRetVal
35954>>>        Function_Return rRetVal
35955>>>    End_Function
35956>>>
35956>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
35957>>>        Local Integer iretVal
35958>>>        Local String sRetVal
35958>>>        Local Pointer psRetVal
35958>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35959>>>        GetAddress of sRetVal to psRetVal
35960>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
35961>>>        Function_Return (CString(sRetVal))
35962>>>    End_Function
35963>>>
35963>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
35964>>>        Local Integer iretVal
35965>>>        Inst_OLEVariant vRetVal
35966>>>        Local Pointer pvRetVal
35966>>>        GetAddress of vRetVal to pvRetVal
35967>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
35968>>>        Function_Return vRetVal
35969>>>    End_Function
35970>>>
35970>>>End_Class
35971>>>
35971>>>
35971>>>// The OLE Automation base class,
35971>>>// which all automation classes are derived from
35971>>>
35971>>>Class Automation_Client is a cCOM_IDispatch
35972>>>    Procedure Construct_Object
35973>>>        Forward Send Construct_Object
35975>>>        Send DefineCOM_IDispatch
35976>>>        Local Integer iClientId
35977>>>        Move (CreateAutomationClient()) To iClientId
35978>>>        If iClientId Eq 0 Begin
35980>>>            Set ClientId to 0
35981>>>            Error 1002 DFOLEError1002
35982>>>>
35982>>>        End
35982>>>>
35982>>>        Else Set ClientId To iClientId
35984>>>        End_Procedure
35985>>>
35985>>>    Procedure Destroy_Object
35986>>>        Local Integer iRetVal iClientId
35987>>>        Get ClientId to iClientId
35988>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
35989>>>        Forward Send Destroy_Object
35991>>>    End_Procedure
35992>>>
35992>>>    Procedure CreateDispatch
35993>>>                Local Integer iRetVal
35994>>>                Local Integer iClientId
35994>>>        Local String sCLSID
35994>>>        Get progIdStr to sCLSID
35995>>>        Append sCLSID OLENull
35996>>>
35996>>>                Get clientId to iClientId
35997>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
35998>>>                If iRetVal Eq 0 Begin
36000>>>            Error 1000 DFOLEError1000
36001>>>>
36001>>>                End
36001>>>>
36001>>>        End_Procedure
36002>>>
36002>>>        Procedure AttachDispatch LPDispatch pdisp
36003>>>                Local Integer iRetVal
36004>>>                Local Integer iClientId
36004>>>                Local Integer bAutoAddRef
36004>>>                Get clientId to iClientId
36005>>>                Get AutoAddRef to bAutoAddRef
36006>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
36007>>>                If iRetVal Eq 0 Begin
36009>>>                Error 1001 DFOLEError1001
36010>>>>
36010>>>                End
36010>>>>
36010>>>    End_Procedure
36011>>>
36011>>>    Function AttachActiveObject Returns Bool
36012>>>                Local Bool bRetVal
36013>>>                Local Integer iClientId
36013>>>                Local String sCLSID
36013>>>                Get progIdStr to sCLSID
36014>>>                Append sCLSID OLENull
36015>>>                Get clientId to iClientId
36016>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
36017>>>                Function_Return bRetVal
36018>>>    End_Function
36019>>>
36019>>>    Procedure ReleaseDispatch
36020>>>        Local Integer iRetVal
36021>>>        Local Integer iClientId
36021>>>        Get clientId to iClientId
36022>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
36023>>>    End_Procedure
36024>>>
36024>>>    Function GetDispatch returns LPDispatch
36025>>>        Local LPDispatch retVal
36026>>>        Local Integer iClientId
36026>>>        Get clientId to iClientId
36027>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
36028>>>        Function_Return retVal
36029>>>    End_Function
36030>>>
36030>>>End_Class
36031>>>
36031>>>
36031>>>//     cCom_IDispatch  External_Class_Mixin
36031>>>//                 |       |    
36031>>>//                 |       cOCXNavigation_Mixin
36031>>>//                 |         |    
36031>>>//               cOCX_Client_Mixin
36031>>>//                        |    |
36031>>>//                        |    |
36031>>>// Form_External_Control  |    |   dbForm_External_Control
36031>>>//                 |      |    |        |  
36031>>>//                OCX_Client   dbOCX_Client
36031>>>
36031>>>
36031>>>
36031>>>// The focus navigation mixin class for ActiveX controls
36031>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
36032>>>    Import_Class_Protocol External_Class_Mixin
36033>>>    Register_Procedure WMDF_DFOCXNotifyEvent
36033>>>
36033>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
36034>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
36037>>>    End_Procedure
36038>>>
36038>>>    Procedure OCXFocusChange Integer lParam
36039>>>        If (lParam);            Send External_SetFocus
36042>>>        Else;            Send External_KillFocus
36044>>>    End_Procedure
36045>>>
36045>>>    //Provided just to cancel the External_Class_Mixin implementation
36045>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
36045>>>    Procedure Page_Object Integer state
36046>>>        Forward Send Page_Object state        
36048>>>    End_Procedure
36049>>>
36049>>>    Procedure Enable_Window integer iState
36050>>>      // Here we switch iState again, for backwards compatibility
36050>>>      Set OcxShadow_State to (Not(iState))
36051>>>    End_procedure
36052>>>
36052>>>End_Class
36053>>>
36053>>>
36053>>>//The standard OCX class mixin, it is the 
36053>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
36053>>>Class cOCX_Client_Mixin is a Mixin
36054>>>
36054>>>    Import_Class_Protocol cCOM_IDispatch
36055>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
36056>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
36056>>>
36056>>>    Procedure DefineOCX_Client
36057>>>        Send DefineCOM_IDispatch
36058>>>        Local Integer iClientId
36059>>>        Property integer Private.OCXShadowState Public 0
36060>>>        Property String  Private.OCXCaption Public ""
36061>>>        Property String  OCXLicense Public ""
36062>>>        Property String  OCXPropFile Public ""
36063>>>        Move (CreateOCXClient()) to iclientId
36064>>>                Set ClientId to iClientId
36065>>>        Send Use_Parent_Color
36066>>>    End_Procedure
36067>>>
36067>>>    Function OCXShadow_State Returns Integer
36068>>>        Local Integer bEnabled
36069>>>        Get Private.OCXShadowState to bEnabled
36070>>>        Function_Return bEnabled
36071>>>    End_Function
36072>>>
36072>>>    Procedure Set OCXShadow_State Integer bEnable
36073>>>        Local integer hWnd iSuccess iCLientId
36074>>>        Set Private.OCXShadowState to bEnable
36075>>>        Get clientId to iClientId
36076>>>        If bEnable;            Move (false) to bEnable
36079>>>        else;            Move (true) to bEnable
36081>>>        Get Window_Handle to hWnd
36082>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
36085>>>    End_Procedure
36086>>>
36086>>>    Procedure SetOCXCaption String sCaption
36087>>>        Local Integer iClientId iRetVal
36088>>>        Get ClientId to iClientId
36089>>>        Append sCaption OLENull
36090>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
36091>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
36094>>>        Else;            Set Private.OCXCaption to sCaption
36096>>>    End_Procedure
36097>>>
36097>>>    Function GetOCXCaption Returns String
36098>>>        Local Integer iClientId iRetVal
36099>>>        Local String destStr
36099>>>        Local Pointer lpDestStr
36099>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36100>>>        GetAddress of destStr to lpDestStr
36101>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
36102>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
36105>>>        Set Private.OCXCaption to (CString(destStr))
36106>>>        Function_Return (Private.OCXCaption(Current_Object))
36107>>>    End_Function
36108>>>
36108>>>    Procedure SET OCXCaption String sCaption
36109>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
36112>>>        Else;            Set Private.OCXCaption to sCaption
36114>>>    End_Procedure
36115>>>
36115>>>    Function OCXCaption Returns String
36116>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
36119>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
36121>>>    End_Procedure
36122>>>
36122>>>    // To avoid flickering during resize operations
36122>>>    Procedure Use_Parent_Color
36123>>>        Local Integer Clr Txtclr Backclr
36124>>>        Delegate Get Object_Color To Clr
36126>>>        Move (Hi(Clr)) To Txtclr
36127>>>        Move (Low(Clr)) To Backclr
36128>>>        Set Object_Color To Txtclr Backclr
36129>>>    End_Procedure
36130>>>
36130>>>    Procedure Page_Object integer iState
36131>>>        Forward Send Page_Object iState
36133>>>        If iState Eq (True) Send LoadOCX
36136>>>    End_Procedure
36137>>>
36137>>>    Procedure Remove_Object
36138>>>        Send UnloadOCX
36139>>>        Forward send Remove_Object
36141>>>    End_Procedure
36142>>>
36142>>>    Procedure LoadOCX
36143>>>        Local Pointer HWnd
36144>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
36144>>>        Local String sPrgId lic sCap sPropFile
36144>>>        Send PreCreateOCX
36145>>>        Get ClientId to iClientId
36146>>>        Get Window_Handle to hwnd
36147>>>        Get progIdStr to sPrgId
36148>>>        Append sPrgId OLENull
36149>>>        Get Private.OCXCaption To sCap
36150>>>        Append sCap OLENull
36151>>>        Get OCXLicense To Lic
36152>>>        Append Lic OLENull
36153>>>        Get OCXPropFile To sPropFile
36154>>>        Append sPropfile OLENull
36155>>>        Get Visible_State to iVisible
36156>>>        If (iVisible) Move WS_VISIBLE to dwSty
36159>>>        Else Move 0 to dwSty
36161>>>        Get Private.OCXShadowState to iShadow
36162>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
36165>>>        Move (dwSty ior WS_TABSTOP) to dwSty
36166>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
36167>>>        Send PostCreateOCX
36168>>>    End_Procedure
36169>>>
36169>>>    Procedure UnloadOCX
36170>>>        Local Integer iRetVal
36171>>>                Local Integer iClientId
36171>>>                Get ClientId to iClientId
36172>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
36173>>>    End_Procedure
36174>>>
36174>>>    //This procedure is triggered before the OCX control is created
36174>>>    Procedure PreCreateOCX
36175>>>    End_Procedure
36176>>>
36176>>>    //This procedure is triggered after the OCX control is created but
36176>>>    //before it's shown
36176>>>    Procedure PostCreateOCX
36177>>>    End_Procedure
36178>>>End_Class
36179>>>
36179>>>// The non data aware OCX class
36179>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
36179>>>Class OCX_Client is a FormExternalControl
36180>>>    Import_Class_Protocol cOCX_Client_Mixin
36181>>>
36181>>>    //These allows us to use the VDF standard 'Value' to get and set the
36181>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
36181>>>
36181>>>    Procedure Set ControlValue string sVal
36182>>>        Set OCXCaption to sVal
36183>>>    End_Procedure
36184>>>
36184>>>    Function Value Integer item_number Returns String
36185>>>        Function_Return (OCXCaption(Current_Object))
36186>>>    End_Function
36187>>>
36187>>>End_Class
36188>>>
36188>>>
36188>>>// The Data aware OCX class
36188>>>// Derive from this class if you want your ActiveX control to be data aware
36188>>>Class dbOCX_Client is a dbFormExternalControl
36189>>>    Import_Class_Protocol cOCX_Client_Mixin
36190>>>
36190>>>    Procedure DefinedbOCX_Client
36191>>>        Send DefineOCX_Client
36192>>>        Property String  Private.OCXdbValue public ""
36193>>>    End_Procedure
36194>>>
36194>>>    Procedure Set ControlValue string sVal
36195>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
36198>>>    End_Procedure
36199>>>
36199>>>    Function ControlValue Returns String
36200>>>        Function_Return (Private.OCXDbValue(Current_Object))
36201>>>    End_Function
36202>>>
36202>>>    //Triggered when the database value has changed,
36202>>>    // and the ActiveX control needs to be updated
36202>>>    //Override and perform necessary updating to the OCX
36202>>>    Procedure OnRefreshDbOcxValue String sVal
36203>>>    End_Procedure
36204>>>
36204>>>    //Should be called when the ActiveX control's value has changed,
36204>>>    // and the database value needs to be updated
36204>>>    Procedure UpdateDbOcxValue String sVal
36205>>>        Set Private.OCXdbValue to sVal
36206>>>        Send ControlValueChanged
36207>>>    End_Procedure
36208>>>
36208>>>End_Class
36209>>>
36209>>>
36209>>>// Command for common declarations of ActiveX control classes, only used internally
36209>>>
36209>>>
36209>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
36209>>>>>// OLEStdFont Charset Constants
36209>>>>>Enum_List
36209>>>>>        Define OLEANSI_CHARSET for 0 
36209>>>>>        Define OLEDEFAULT_CHARSET for 1
36209>>>>>        Define OLESYMBOL_CHARSET for 2
36209>>>>>End_Enum_List
36209>>>>>
36209>>>>>
36209>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
36209>>>>>// ProgId: 
36209>>>>>Class OLEFontMixin is a Automation_Client
36210>>>>>
36210>>>>>        Function StdFontName Returns String
36211>>>>>                Local String lpropVal
36212>>>>>                Get GetStringProperty 0 to lpropVal
36213>>>>>                Function_Return lpropVal
36214>>>>>        End_Function
36215>>>>>
36215>>>>>        Procedure SET StdFontName String lpropVal
36216>>>>>                Send SetStringProperty 0 lpropVal
36217>>>>>        End_Procedure
36218>>>>>
36218>>>>>        Function StdFontSize Returns Currency
36219>>>>>                Local Currency lpropVal
36220>>>>>                Get GetCurrencyProperty 2 to lpropVal
36221>>>>>                Function_Return lpropVal
36222>>>>>        End_Function
36223>>>>>
36223>>>>>        Procedure SET StdFontSize Currency lpropVal
36224>>>>>                Send SetCurrencyProperty 2 lpropVal
36225>>>>>        End_Procedure
36226>>>>>
36226>>>>>        Function StdFontBold Returns Bool
36227>>>>>                Local Bool lpropVal
36228>>>>>                Get GetBoolProperty 3 to lpropVal
36229>>>>>                Function_Return lpropVal
36230>>>>>        End_Function
36231>>>>>
36231>>>>>        Procedure SET StdFontBold Bool lpropVal
36232>>>>>                Send SetBoolProperty 3 lpropVal
36233>>>>>        End_Procedure
36234>>>>>
36234>>>>>        Function StdFontItalic Returns Bool
36235>>>>>                Local Bool lpropVal
36236>>>>>                Get GetBoolProperty 4 to lpropVal
36237>>>>>                Function_Return lpropVal
36238>>>>>        End_Function
36239>>>>>
36239>>>>>        Procedure SET StdFontItalic Bool lpropVal
36240>>>>>                Send SetBoolProperty 4 lpropVal
36241>>>>>        End_Procedure
36242>>>>>
36242>>>>>        Function StdFontUnderline Returns Bool
36243>>>>>                Local Bool lpropVal
36244>>>>>                Get GetBoolProperty 5 to lpropVal
36245>>>>>                Function_Return lpropVal
36246>>>>>        End_Function
36247>>>>>
36247>>>>>        Procedure SET StdFontUnderline Bool lpropVal
36248>>>>>                Send SetBoolProperty 5 lpropVal
36249>>>>>        End_Procedure
36250>>>>>
36250>>>>>        Function StdFontStrikethrough Returns Bool
36251>>>>>                Local Bool lpropVal
36252>>>>>                Get GetBoolProperty 6 to lpropVal
36253>>>>>                Function_Return lpropVal
36254>>>>>        End_Function
36255>>>>>
36255>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
36256>>>>>                Send SetBoolProperty 6 lpropVal
36257>>>>>        End_Procedure
36258>>>>>
36258>>>>>        Function StdFontWeight Returns Integer
36259>>>>>                Local Integer lpropVal
36260>>>>>                Get GetShortProperty 7 to lpropVal
36261>>>>>                Function_Return lpropVal
36262>>>>>        End_Function
36263>>>>>
36263>>>>>        Procedure SET StdFontWeight Integer lpropVal
36264>>>>>                Send SetShortProperty 7 lpropVal
36265>>>>>        End_Procedure
36266>>>>>
36266>>>>>        Function StdFontCharset Returns Integer
36267>>>>>                Local Integer lpropVal
36268>>>>>                Get GetShortProperty 8 to lpropVal
36269>>>>>                Function_Return lpropVal
36270>>>>>        End_Function
36271>>>>>
36271>>>>>        Procedure SET StdFontCharset Integer lpropVal
36272>>>>>                Send SetShortProperty 8 lpropVal
36273>>>>>        End_Procedure
36274>>>>>
36274>>>>>End_Class
36275>>>>>
36275>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
36275>>>>>// ProgId: StdFont
36275>>>>>// Number of impl.Types:1
36275>>>>>// Referenced class Font
36275>>>>>Class OLEStdFont is a Automation_Client
36276>>>>>        Import_Class_Protocol OLEFontMixin
36277>>>>>
36277>>>>>        Procedure Construct_Object
36278>>>>>                Forward Send Construct_Object
36280>>>>>                Set progIdStr to "StdFont"
36281>>>>>        End_Procedure
36282>>>>>End_Class
36283>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
36283>>>>>
36283>>>>>// Picture Type Constants
36283>>>>>//Enum_List
36283>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
36283>>>>>        Define OLEPICTYPE_NONE for 0 // None
36283>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
36283>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
36283>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
36283>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
36283>>>>>//End_Enum_List
36283>>>>>
36283>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
36283>>>>>// ProgId: 
36283>>>>>Class OLEPictureMixin is a Automation_Client
36284>>>>>
36284>>>>>        Function StdPictureHandle Returns OLE_HANDLE
36285>>>>>                Local OLE_HANDLE lpropVal
36286>>>>>                Get GetIntegerProperty 0 to lpropVal
36287>>>>>                Function_Return lpropVal
36288>>>>>        End_Function
36289>>>>>
36289>>>>>        Function StdPicturehPal Returns OLE_HANDLE
36290>>>>>                Local OLE_HANDLE lpropVal
36291>>>>>                Get GetIntegerProperty 2 to lpropVal
36292>>>>>                Function_Return lpropVal
36293>>>>>        End_Function
36294>>>>>
36294>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
36295>>>>>                Send SetIntegerProperty 2 lpropVal
36296>>>>>        End_Procedure
36297>>>>>
36297>>>>>        Function StdPictureType Returns Integer
36298>>>>>                Local Integer lpropVal
36299>>>>>                Get GetShortProperty 3 to lpropVal
36300>>>>>                Function_Return lpropVal
36301>>>>>        End_Function
36302>>>>>
36302>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
36303>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
36304>>>>>                Get GetIntegerProperty 4 to lpropVal
36305>>>>>                Function_Return lpropVal
36306>>>>>        End_Function
36307>>>>>
36307>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
36308>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
36309>>>>>                Get GetIntegerProperty 5 to lpropVal
36310>>>>>                Function_Return lpropVal
36311>>>>>        End_Function
36312>>>>>
36312>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
36313>>>>>                Send DeclareParams 10
36314>>>>>                Send DefineIntegerParam lhdc
36315>>>>>                Send DefineIntegerParam lx
36316>>>>>                Send DefineIntegerParam ly
36317>>>>>                Send DefineIntegerParam lcx
36318>>>>>                Send DefineIntegerParam lcy
36319>>>>>                Send DefineIntegerParam lxSrc
36320>>>>>                Send DefineIntegerParam lySrc
36321>>>>>                Send DefineIntegerParam lcxSrc
36322>>>>>                Send DefineIntegerParam lcySrc
36323>>>>>                Send DefineIntegerParam lprcWBounds
36324>>>>>                Send InvokeVoidFunction 6
36325>>>>>        End_Procedure 
36326>>>>>
36326>>>>>End_Class
36327>>>>>
36327>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
36327>>>>>// ProgId: StdPicture
36327>>>>>// Number of impl.Types:1
36327>>>>>// Referenced class Picture
36327>>>>>Class OLEStdPicture is a Automation_Client
36328>>>>>        Import_Class_Protocol OLEPictureMixin
36329>>>>>
36329>>>>>        Procedure Construct_Object
36330>>>>>                Forward Send Construct_Object
36332>>>>>                Set progIdStr to "StdPicture"
36333>>>>>        End_Procedure
36334>>>>>End_Class
36335>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
36335>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
36335>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
36335>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36335>>>
36335>>>//Enum_List
36335>>>    Define OLEdpdDesktop        for  0 // Desktop
36335>>>    Define OLEdpdControlPanel   for  1 // Control Panel
36335>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
36335>>>    Define OLEdpdMyComputer     for  3 // My Computer
36335>>>    Define OLEdpdFontDir        for  4 // Font Directory
36335>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
36335>>>    Define OLEdpdPrinters       for  6 // Printers
36335>>>    Define OLEdpdPrograms       for  7 // Programs
36335>>>    Define OLEdpdRecent         for  8 // Recent
36335>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
36335>>>    Define OLEdpdSendTo         for 10 // Send To
36335>>>    Define OLEdpdStartMenu      for 11 // Start Menu
36335>>>    Define OLEdpdStartUp        for 12 // Start Up
36335>>>    Define OLEdpdTemplates      for 13 // Templates
36335>>>    Define OLEdpdCustom         for 14 // Custom Root
36335>>>//End_Enum_List
36335>>>
36335>>>// Dispatch interface for DPDlg Control
36335>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
36335>>>// ProgId:
36335>>>Class OLE_DDPDlg is a Message
36336>>>
36336>>>        Function DPDlgBrowseForComputer Returns Bool
36337>>>                Local Bool lpropVal
36338>>>                Get GetBoolProperty 1 to lpropVal
36339>>>                Function_Return lpropVal
36340>>>        End_Function
36341>>>
36341>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
36342>>>                Send SetBoolProperty 1 lpropVal
36343>>>        End_Procedure
36344>>>
36344>>>        Function DPDlgBrowseForPrinter Returns Bool
36345>>>                Local Bool lpropVal
36346>>>                Get GetBoolProperty 2 to lpropVal
36347>>>                Function_Return lpropVal
36348>>>        End_Function
36349>>>
36349>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
36350>>>                Send SetBoolProperty 2 lpropVal
36351>>>        End_Procedure
36352>>>
36352>>>        Function DPDlgDontGoBelowDomain Returns Bool
36353>>>                Local Bool lpropVal
36354>>>                Get GetBoolProperty 3 to lpropVal
36355>>>                Function_Return lpropVal
36356>>>        End_Function
36357>>>
36357>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
36358>>>                Send SetBoolProperty 3 lpropVal
36359>>>        End_Procedure
36360>>>
36360>>>        Function DPDlgReturnFSAncestors Returns Bool
36361>>>                Local Bool lpropVal
36362>>>                Get GetBoolProperty 4 to lpropVal
36363>>>                Function_Return lpropVal
36364>>>        End_Function
36365>>>
36365>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
36366>>>                Send SetBoolProperty 4 lpropVal
36367>>>        End_Procedure
36368>>>
36368>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
36369>>>                Local Bool lpropVal
36370>>>                Get GetBoolProperty 5 to lpropVal
36371>>>                Function_Return lpropVal
36372>>>        End_Function
36373>>>
36373>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
36374>>>                Send SetBoolProperty 5 lpropVal
36375>>>        End_Procedure
36376>>>
36376>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
36377>>>                Local OLE_ROOTSHORT lpropVal
36378>>>                Get GetIntegerProperty 6 to lpropVal
36379>>>                Function_Return lpropVal
36380>>>        End_Function
36381>>>
36381>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
36382>>>                Send SetIntegerProperty 6 lpropVal
36383>>>        End_Procedure
36384>>>
36384>>>        Function DPDlghWnd Returns OLE_HANDLE
36385>>>                Local OLE_HANDLE lpropVal
36386>>>                Get GetIntegerProperty -515 to lpropVal
36387>>>                Function_Return lpropVal
36388>>>        End_Function
36389>>>
36389>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
36390>>>                Send SetIntegerProperty -515 lpropVal
36391>>>        End_Procedure
36392>>>
36392>>>        Function DPDlgIcon Returns LPDispatch
36393>>>                Local LPDispatch lpropVal
36394>>>                Get GetLPDispatchProperty 7 to lpropVal
36395>>>                Function_Return lpropVal
36396>>>        End_Function
36397>>>
36397>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
36398>>>                Send SetLPDispatchProperty 7 lpropVal
36399>>>        End_Procedure
36400>>>
36400>>>        Function DPDlgFolder Returns String
36401>>>                Local String lpropVal
36402>>>                Get GetStringProperty 8 to lpropVal
36403>>>                Function_Return lpropVal
36404>>>        End_Function
36405>>>
36405>>>        Procedure SET DPDlgFolder String lpropVal
36406>>>                Send SetStringProperty 8 lpropVal
36407>>>        End_Procedure
36408>>>
36408>>>        Function DPDlgCaption Returns String
36409>>>                Local String lpropVal
36410>>>                Get GetStringProperty -518 to lpropVal
36411>>>                Function_Return lpropVal
36412>>>        End_Function
36413>>>
36413>>>        Procedure SET DPDlgCaption String lpropVal
36414>>>                Send SetStringProperty -518 lpropVal
36415>>>        End_Procedure
36416>>>
36416>>>        Function DPDlg_Caption Returns String
36417>>>                Local String lpropVal
36418>>>                Get GetStringProperty 0 to lpropVal
36419>>>                Function_Return lpropVal
36420>>>        End_Function
36421>>>
36421>>>        Procedure SET DPDlg_Caption String lpropVal
36422>>>                Send SetStringProperty 0 lpropVal
36423>>>        End_Procedure
36424>>>
36424>>>        Function DPDlgPath Returns String
36425>>>                Local String lpropVal
36426>>>                Get GetStringProperty 9 to lpropVal
36427>>>                Function_Return lpropVal
36428>>>        End_Function
36429>>>
36429>>>        Procedure SET DPDlgPath String lpropVal
36430>>>                Send SetStringProperty 9 lpropVal
36431>>>        End_Procedure
36432>>>
36432>>>        Function DPDlgCustomRoot Returns String
36433>>>                Local String lpropVal
36434>>>                Get GetStringProperty 10 to lpropVal
36435>>>                Function_Return lpropVal
36436>>>        End_Function
36437>>>
36437>>>        Procedure SET DPDlgCustomRoot String lpropVal
36438>>>                Send SetStringProperty 10 lpropVal
36439>>>        End_Procedure
36440>>>
36440>>>        Function DPDlgShow Returns Bool
36441>>>                Local Bool lretVal
36442>>>                Get InvokeBoolFunction 11 to lretVal
36443>>>                Function_Return lretVal
36444>>>        End_Function
36445>>>
36445>>>        Procedure DPDlgAboutBox
36446>>>                Send InvokeVoidFunction -552
36447>>>        End_Procedure
36448>>>
36448>>>End_Class
36449>>>
36449>>>// Event interface for DPDlg Control
36449>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
36449>>>// ProgId:
36449>>>Class OLE_DDPDlgEvents is a Message
36450>>>
36450>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
36451>>>        End_Procedure
36452>>>
36452>>>End_Class
36453>>>
36453>>>// DPDlg Control
36453>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36453>>>// ProgId: DPDLG.DPDlgCtrl.1
36453>>>// Number of impl.Types:2
36453>>>// Referenced class _DDPDlg
36453>>>// Referenced class _DDPDlgEvents
36453>>>Class OLEDPDlg is a OCX_Client
36454>>>        Import_Class_Protocol OLE_DDPDlg
36455>>>        Import_Class_Protocol OLE_DDPDlgEvents
36456>>>
36456>>>        Procedure Construct_Object
36457>>>                Forward Send Construct_Object
36459>>>                Send DefineOCX_Client
36460>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36461>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36464>>>        End_Procedure
36465>>>
36465>>>        Procedure PreDPDlgFolderSelected Integer lParam
36466>>>                Local String lPath
36467>>>                Local Bool lAllow
36467>>>                Get GetEventStringParam lParam 0 to lPath
36468>>>                Get GetEventBoolParam lParam 1 to lAllow
36469>>>                Send OnDPDlgFolderSelected lPath lAllow
36470>>>        End_Procedure
36471>>>
36471>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36472>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36475>>>        End_Procedure
36476>>>End_Class
36477>>>
36477>>>// DPDlg Control
36477>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36477>>>// ProgId: DPDLG.DPDlgCtrl.1
36477>>>// Number of impl.Types:2
36477>>>// Referenced class _DDPDlg
36477>>>// Referenced class _DDPDlgEvents
36477>>>Class dbOLEDPDlg is a dbOCX_Client
36478>>>        Import_Class_Protocol OLE_DDPDlg
36479>>>        Import_Class_Protocol OLE_DDPDlgEvents
36480>>>
36480>>>        Procedure Construct_Object
36481>>>                Forward Send Construct_Object
36483>>>                Send DefineDbOCX_Client
36484>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36485>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36488>>>        End_Procedure
36489>>>
36489>>>        Procedure PreDPDlgFolderSelected Integer lParam
36490>>>                Local String lPath
36491>>>                Local Bool lAllow
36491>>>                Get GetEventStringParam lParam 0 to lPath
36492>>>                Get GetEventBoolParam lParam 1 to lAllow
36493>>>                Send OnDPDlgFolderSelected lPath lAllow
36494>>>        End_Procedure
36495>>>
36495>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36496>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36499>>>        End_Procedure
36500>>>End_Class
36501>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
36501>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
36501>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
36501>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36501>>>
36501>>>//Enum_List
36501>>>    Define OLERasActionNone         for 0 // No action
36501>>>    Define OLERasActionConnect      for 1 // Connect server
36501>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
36501>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
36501>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
36501>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
36501>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
36501>>>//End_Enum_List
36501>>>
36501>>>// IRasXCom Interface
36501>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
36501>>>// ProgId:
36501>>>Class OLEIRasXCom is a Automation_Client
36502>>>
36502>>>// Sets or returns the filename of the phonebook to use.
36502>>>        Function RasXComPhoneBook Returns String
36503>>>                Local String lpropVal
36504>>>                Get GetStringProperty 1 to lpropVal
36505>>>                Function_Return lpropVal
36506>>>        End_Function
36507>>>
36507>>>// Sets or returns the filename of the phonebook to use.
36507>>>        Procedure SET RasXComPhoneBook String lpropVal
36508>>>                Send SetStringProperty 1 lpropVal
36509>>>        End_Procedure
36510>>>
36510>>>// Sets or returns the phone number to dial.
36510>>>        Function RasXComPhoneNumber Returns String
36511>>>                Local String lpropVal
36512>>>                Get GetStringProperty 2 to lpropVal
36513>>>                Function_Return lpropVal
36514>>>        End_Function
36515>>>
36515>>>// Sets or returns the phone number to dial.
36515>>>        Procedure SET RasXComPhoneNumber String lpropVal
36516>>>                Send SetStringProperty 2 lpropVal
36517>>>        End_Procedure
36518>>>
36518>>>// Sets or returns the name to use when logging on.
36518>>>        Function RasXComLogonName Returns String
36519>>>                Local String lpropVal
36520>>>                Get GetStringProperty 3 to lpropVal
36521>>>                Function_Return lpropVal
36522>>>        End_Function
36523>>>
36523>>>// Sets or returns the name to use when logging on.
36523>>>        Procedure SET RasXComLogonName String lpropVal
36524>>>                Send SetStringProperty 3 lpropVal
36525>>>        End_Procedure
36526>>>
36526>>>// Sets or returns the password to use.
36526>>>        Function RasXComLogonPassword Returns String
36527>>>                Local String lpropVal
36528>>>                Get GetStringProperty 4 to lpropVal
36529>>>                Function_Return lpropVal
36530>>>        End_Function
36531>>>
36531>>>// Sets or returns the password to use.
36531>>>        Procedure SET RasXComLogonPassword String lpropVal
36532>>>                Send SetStringProperty 4 lpropVal
36533>>>        End_Procedure
36534>>>
36534>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36534>>>        Function RasXComCallbackNumber Returns String
36535>>>                Local String lpropVal
36536>>>                Get GetStringProperty 5 to lpropVal
36537>>>                Function_Return lpropVal
36538>>>        End_Function
36539>>>
36539>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36539>>>        Procedure SET RasXComCallbackNumber String lpropVal
36540>>>                Send SetStringProperty 5 lpropVal
36541>>>        End_Procedure
36542>>>
36542>>>// Sets or returns the name of the current phone book entry.
36542>>>        Function RasXComEntryName Returns String
36543>>>                Local String lpropVal
36544>>>                Get GetStringProperty 6 to lpropVal
36545>>>                Function_Return lpropVal
36546>>>        End_Function
36547>>>
36547>>>// Sets or returns the name of the current phone book entry.
36547>>>        Procedure SET RasXComEntryName String lpropVal
36548>>>                Send SetStringProperty 6 lpropVal
36549>>>        End_Procedure
36550>>>
36550>>>// Sets or returns the domain to use for user authentication.
36550>>>        Function RasXComDomain Returns String
36551>>>                Local String lpropVal
36552>>>                Get GetStringProperty 7 to lpropVal
36553>>>                Function_Return lpropVal
36554>>>        End_Function
36555>>>
36555>>>// Sets or returns the domain to use for user authentication.
36555>>>        Procedure SET RasXComDomain String lpropVal
36556>>>                Send SetStringProperty 7 lpropVal
36557>>>        End_Procedure
36558>>>
36558>>>// Determines if methods are blocking.
36558>>>        Function RasXComBlocking Returns Bool
36559>>>                Local Bool lpropVal
36560>>>                Get GetBoolProperty 8 to lpropVal
36561>>>                Function_Return lpropVal
36562>>>        End_Function
36563>>>
36563>>>// Determines if methods are blocking.
36563>>>        Procedure SET RasXComBlocking Bool lpropVal
36564>>>                Send SetBoolProperty 8 lpropVal
36565>>>        End_Procedure
36566>>>
36566>>>// Returns the version of the control.
36566>>>        Function RasXComVersion Returns String
36567>>>                Local String lpropVal
36568>>>                Get GetStringProperty 9 to lpropVal
36569>>>                Function_Return lpropVal
36570>>>        End_Function
36571>>>
36571>>>// Returns the number of names in the current phonebook.
36571>>>        Function RasXComEntryCount Returns Integer
36572>>>                Local Integer lpropVal
36573>>>                Get GetShortProperty 10 to lpropVal
36574>>>                Function_Return lpropVal
36575>>>        End_Function
36576>>>
36576>>>// Returns whether or not RAS services are available.
36576>>>        Function RasXComRASAvailable Returns Bool
36577>>>                Local Bool lpropVal
36578>>>                Get GetBoolProperty 11 to lpropVal
36579>>>                Function_Return lpropVal
36580>>>        End_Function
36581>>>
36581>>>// Holds the last error number reported.
36581>>>        Function RasXComLastError Returns Integer
36582>>>                Local Integer lpropVal
36583>>>                Get GetShortProperty 12 to lpropVal
36584>>>                Function_Return lpropVal
36585>>>        End_Function
36586>>>
36586>>>// Returns the last method executed.
36586>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
36587>>>                Local OLE_MethodsEnum lpropVal
36588>>>                Get GetIntegerProperty 13 to lpropVal
36589>>>                Function_Return lpropVal
36590>>>        End_Function
36591>>>
36591>>>// Holds a description of the last error number reported.
36591>>>        Function RasXComLastErrorString Returns String
36592>>>                Local String lpropVal
36593>>>                Get GetStringProperty 14 to lpropVal
36594>>>                Function_Return lpropVal
36595>>>        End_Function
36596>>>
36596>>>// The current state of the control.
36596>>>        Function RasXComState Returns Integer
36597>>>                Local Integer lpropVal
36598>>>                Get GetShortProperty 15 to lpropVal
36599>>>                Function_Return lpropVal
36600>>>        End_Function
36601>>>
36601>>>// A user-friendly version of the current state of the control.
36601>>>        Function RasXComStateString Returns String
36602>>>                Local String lpropVal
36603>>>                Get GetStringProperty 16 to lpropVal
36604>>>                Function_Return lpropVal
36605>>>        End_Function
36606>>>
36606>>>// Returns the RAS handle of a connection.
36606>>>        Function RasXComHandle Returns DWORD
36607>>>                Local DWORD lpropVal
36608>>>                Get GetIntegerProperty 17 to lpropVal
36609>>>                Function_Return lpropVal
36610>>>        End_Function
36611>>>
36611>>>// Returns whether or not a connection is active.
36611>>>        Function RasXComEntryConnected Returns Bool
36612>>>                Local Bool lpropVal
36613>>>                Get GetBoolProperty 18 to lpropVal
36614>>>                Function_Return lpropVal
36615>>>        End_Function
36616>>>
36616>>>// Returns the list of names in a phone book.
36616>>>        Function RasXComEntryList Integer lIndex Returns String
36617>>>                Local String lpropVal
36618>>>                Send DeclareParams 1
36619>>>                Send DefineShortParam lIndex
36620>>>                Get GetStringProperty 19 to lpropVal
36621>>>                Function_Return lpropVal
36622>>>        End_Function
36623>>>
36623>>>// Holds licensing information.
36623>>>        Function RasXComLicenseKey Returns String
36624>>>                Local String lpropVal
36625>>>                Get GetStringProperty 20 to lpropVal
36626>>>                Function_Return lpropVal
36627>>>        End_Function
36628>>>
36628>>>// Holds licensing information.
36628>>>        Procedure SET RasXComLicenseKey String lpropVal
36629>>>                Send SetStringProperty 20 lpropVal
36630>>>        End_Procedure
36631>>>
36631>>>// Connects to a server.
36631>>>        Procedure RasXComConnect
36632>>>                Send InvokeVoidFunction 22
36633>>>        End_Procedure
36634>>>
36634>>>// Disconnects (logs off) from the server.
36634>>>        Procedure RasXComDisconnect
36635>>>                Send InvokeVoidFunction 23
36636>>>        End_Procedure
36637>>>
36637>>>// Retrives an entry from the current phonebook.
36637>>>        Procedure RasXComGetEntry
36638>>>                Send InvokeVoidFunction 24
36639>>>        End_Procedure
36640>>>
36640>>>// Creates and entry in the current phone book.
36640>>>        Procedure RasXComCreateEntry
36641>>>                Send InvokeVoidFunction 25
36642>>>        End_Procedure
36643>>>
36643>>>// Allows the user to edit a RAS phone book entry.
36643>>>        Procedure RasXComEditEntry
36644>>>                Send InvokeVoidFunction 26
36645>>>        End_Procedure
36646>>>
36646>>>// Resets the component to its original state and re-loads the phone book.
36646>>>        Procedure RasXComRefresh
36647>>>                Send InvokeVoidFunction -550
36648>>>        End_Procedure
36649>>>
36649>>>// Displays About Box.
36649>>>        Procedure RasXComAbout
36650>>>                Send InvokeVoidFunction -552
36651>>>        End_Procedure
36652>>>
36652>>>// Allows object to unload without disconnecting the current connection.
36652>>>        Function RasXComDisconnectOnDestroy Returns Bool
36653>>>                Local Bool lpropVal
36654>>>                Get GetBoolProperty 28 to lpropVal
36655>>>                Function_Return lpropVal
36656>>>        End_Function
36657>>>
36657>>>// Allows object to unload without disconnecting the current connection.
36657>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
36658>>>                Send SetBoolProperty 28 lpropVal
36659>>>        End_Procedure
36660>>>
36660>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36660>>>        Function RasXComNotificationObject Returns LPDispatch
36661>>>                Local LPDispatch lpropVal
36662>>>                Get GetLPDispatchProperty 27 to lpropVal
36663>>>                Function_Return lpropVal
36664>>>        End_Function
36665>>>
36665>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36665>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
36666>>>                Send SetLPDispatchProperty 27 lpropVal
36667>>>        End_Procedure
36668>>>
36668>>>// Returns the version of the control.
36668>>>        Procedure SET RasXComVersion String lpropVal
36669>>>                Send SetStringProperty 9 lpropVal
36670>>>        End_Procedure
36671>>>
36671>>>End_Class
36672>>>
36672>>>// _IRasXComEvents Interface
36672>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
36672>>>// ProgId:
36672>>>Class OLE_IRasXComEvents is a Automation_Client
36673>>>
36673>>>// Fired when a method finishes.
36673>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36674>>>                Send DeclareParams 3
36675>>>                Send DefineIntegerParam lLastMethod
36676>>>                Send DefineShortParam lErrorCode
36677>>>                Send DefineStringParam lErrorString
36678>>>                Send InvokeVoidFunction 1
36679>>>        End_Procedure
36680>>>
36680>>>// Fired when the control's internal state changes.
36680>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
36681>>>                Send DeclareParams 2
36682>>>                Send DefineShortParam lNewState
36683>>>                Send DefineShortParam lOldState
36684>>>                Send InvokeVoidFunction 2
36685>>>        End_Procedure
36686>>>
36686>>>End_Class
36687>>>
36687>>>// RasXCom Class
36687>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
36687>>>// ProgId: Mabry.RasXCom.1
36687>>>// Number of impl.Types:2
36687>>>// Referenced class IRasXCom
36687>>>// Referenced class _IRasXComEvents
36687>>>Class OLERasXCom is a Automation_Client
36688>>>        Import_Class_Protocol OLEIRasXCom
36689>>>        Import_Class_Protocol OLE_IRasXComEvents
36690>>>
36690>>>        Procedure Construct_Object
36691>>>                Forward Send Construct_Object
36693>>>        Set progIdStr to "Mabry.RasXCom"
36694>>>        End_Procedure
36695>>>End_Class
36696>>>
36696>>>// IRasXComNotify Interface
36696>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
36696>>>// ProgId:
36696>>>Class OLEIRasXComNotify is a Automation_Client
36697>>>
36697>>>// Done
36697>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36698>>>                Send DeclareParams 4
36699>>>                Send DefineLPDispatchParam lPackageObject
36700>>>                Send DefineIntegerParam lLastMethod
36701>>>                Send DefineShortParam lErrorCode
36702>>>                Send DefineStringParam lErrorString
36703>>>                Send InvokeVoidFunction 1
36704>>>        End_Procedure
36705>>>
36705>>>// Fired when the control's internal state changes.
36705>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
36706>>>                Send DeclareParams 3
36707>>>                Send DefineLPDispatchParam lPackageObject
36708>>>                Send DefineShortParam lNewState
36709>>>                Send DefineShortParam lOldState
36710>>>                Send InvokeVoidFunction 2
36711>>>        End_Procedure
36712>>>
36712>>>End_Class
36713>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
36713>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
36713>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
36713>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36713>>>
36713>>>// Dispatch interface for xfind Control
36713>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
36713>>>// ProgId: 
36713>>>Class OLEIxfind is a Message
36714>>>
36714>>>        Procedure xfindAboutBox
36715>>>                Send InvokeVoidFunction -552
36716>>>        End_Procedure 
36717>>>
36717>>>        Function xfindSearchString Returns String
36718>>>                Local String lpropVal
36719>>>                Get GetStringProperty 6 to lpropVal
36720>>>                Function_Return lpropVal
36721>>>        End_Function
36722>>>
36722>>>        Procedure SET xfindSearchString String lpropVal
36723>>>                Send SetStringProperty 6 lpropVal
36724>>>        End_Procedure
36725>>>
36725>>>        Function xfindSearchFrom Returns String
36726>>>                Local String lpropVal
36727>>>                Get GetStringProperty 7 to lpropVal
36728>>>                Function_Return lpropVal
36729>>>        End_Function
36730>>>
36730>>>        Procedure SET xfindSearchFrom String lpropVal
36731>>>                Send SetStringProperty 7 lpropVal
36732>>>        End_Procedure
36733>>>
36733>>>        Function xfindSearchSubDirs Returns Bool
36734>>>                Local Bool lpropVal
36735>>>                Get GetBoolProperty 8 to lpropVal
36736>>>                Function_Return lpropVal
36737>>>        End_Function
36738>>>
36738>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
36739>>>                Send SetBoolProperty 8 lpropVal
36740>>>        End_Procedure
36741>>>
36741>>>        Procedure xfindStartSearching
36742>>>                Send InvokeVoidFunction 2
36743>>>        End_Procedure 
36744>>>
36744>>>        Function xfindIsSearching Returns Bool
36745>>>                Local Bool lpropVal
36746>>>                Get GetBoolProperty 5 to lpropVal
36747>>>                Function_Return lpropVal
36748>>>        End_Function
36749>>>
36749>>>        Procedure xfindAbortSearch
36750>>>                Send InvokeVoidFunction 9
36751>>>        End_Procedure 
36752>>>
36752>>>        Function xfindFileName Returns String
36753>>>                Local String lpropVal
36754>>>                Get GetStringProperty 3 to lpropVal
36755>>>                Function_Return lpropVal
36756>>>        End_Function
36757>>>
36757>>>        Function xfindFileSize Returns DWORD
36758>>>                Local DWORD lpropVal
36759>>>                Get GetIntegerProperty 4 to lpropVal
36760>>>                Function_Return lpropVal
36761>>>        End_Function
36762>>>
36762>>>End_Class
36763>>>
36763>>>// Events interface for xfind Control
36763>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
36763>>>// ProgId: 
36763>>>Class OLEIxfindEvents is a Message
36764>>>
36764>>>        Procedure OnxfindActivate
36765>>>        End_Procedure
36766>>>
36766>>>        Procedure OnxfindClick
36767>>>        End_Procedure
36768>>>
36768>>>        Procedure OnxfindCreate
36769>>>        End_Procedure
36770>>>
36770>>>        Procedure OnxfindDblClick
36771>>>        End_Procedure
36772>>>
36772>>>        Procedure OnxfindDestroy
36773>>>        End_Procedure
36774>>>
36774>>>        Procedure OnxfindDeactivate
36775>>>        End_Procedure
36776>>>
36776>>>        Procedure OnxfindKeyPress Integer lKey
36777>>>        End_Procedure
36778>>>
36778>>>        Procedure OnxfindPaint
36779>>>        End_Procedure
36780>>>
36780>>>        Procedure OnxfindFinishedSearch
36781>>>        End_Procedure
36782>>>
36782>>>        Procedure OnxfindFoundFile
36783>>>        End_Procedure
36784>>>
36784>>>End_Class
36785>>>
36785>>>// xfind Control
36785>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
36785>>>// ProgId: xfind10.xfind
36785>>>// Number of impl.Types:2
36785>>>// Referenced class Ixfind
36785>>>// Referenced class IxfindEvents
36785>>>Class OLExfind is a OCX_Client
36786>>>        Import_Class_Protocol OLEIxfind
36787>>>        Import_Class_Protocol OLEIxfindEvents
36788>>>
36788>>>        Procedure Construct_Object
36789>>>                Forward Send Construct_Object
36791>>>                Send DefineOCX_Client
36792>>>                Set progIdStr to "xfind10.xfind"
36793>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
36796>>>        End_Procedure
36797>>>
36797>>>        Procedure PrexfindKeyPress Integer lParam
36798>>>                Local Integer lKey
36799>>>                Get GetEventShortParam lParam 0 to lKey
36800>>>                Send OnxfindKeyPress lKey
36801>>>        End_Procedure
36802>>>
36802>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36803>>>                ON_EVENT 1 Fire OnxfindActivate
36806>>>                ON_EVENT 2 Fire OnxfindClick
36809>>>                ON_EVENT 3 Fire OnxfindCreate
36812>>>                ON_EVENT 5 Fire OnxfindDblClick
36815>>>                ON_EVENT 6 Fire OnxfindDestroy
36818>>>                ON_EVENT 7 Fire OnxfindDeactivate
36821>>>                ON_EVENT 11 Fire PrexfindKeyPress
36824>>>                ON_EVENT 16 Fire OnxfindPaint
36827>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
36830>>>                ON_EVENT 8 Fire OnxfindFoundFile
36833>>>        End_Procedure
36834>>>End_Class
36835>>>
36835>>>// xfind Control
36835>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
36835>>>// ProgId: xfind10.xfind
36835>>>// Number of impl.Types:2
36835>>>// Referenced class Ixfind
36835>>>// Referenced class IxfindEvents
36835>>>Class dbOLExfind is a dbOCX_Client
36836>>>        Import_Class_Protocol OLEIxfind
36837>>>        Import_Class_Protocol OLEIxfindEvents
36838>>>
36838>>>        Procedure Construct_Object
36839>>>                Forward Send Construct_Object
36841>>>                Send DefineDbOCX_Client
36842>>>                Set progIdStr to "xfind10.xfind"
36843>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
36846>>>        End_Procedure
36847>>>
36847>>>        Procedure PrexfindKeyPress Integer lParam
36848>>>                Local Integer lKey
36849>>>                Get GetEventShortParam lParam 0 to lKey
36850>>>                Send OnxfindKeyPress lKey
36851>>>        End_Procedure
36852>>>
36852>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36853>>>                ON_EVENT 1 Fire OnxfindActivate
36856>>>                ON_EVENT 2 Fire OnxfindClick
36859>>>                ON_EVENT 3 Fire OnxfindCreate
36862>>>                ON_EVENT 5 Fire OnxfindDblClick
36865>>>                ON_EVENT 6 Fire OnxfindDestroy
36868>>>                ON_EVENT 7 Fire OnxfindDeactivate
36871>>>                ON_EVENT 11 Fire PrexfindKeyPress
36874>>>                ON_EVENT 16 Fire OnxfindPaint
36877>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
36880>>>                ON_EVENT 8 Fire OnxfindFoundFile
36883>>>        End_Procedure
36884>>>End_Class
36885>Use EZFTP    // Ftp Package
INCLUDING FILE: EZFTP.PKG
36885>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\EZFTP.OCX
36885>>>// Generated by FlexOLE Class Generator Thursday, December 28, 2000 13:30:32
36885>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36885>>>
36885>>>// Dispatch interface for EZFTP Control
36885>>>// CLSID:{6580F765-7819-11CF-B86C-444553540000}
36885>>>// ProgId:
36885>>>Class OLE_DEZFTP is a Message
36886>>>
36886>>>        Function EZFTPRemoteAddress Returns String
36887>>>                Local String lpropVal
36888>>>                Get GetStringProperty 1 to lpropVal
36889>>>                Function_Return lpropVal
36890>>>        End_Function
36891>>>
36891>>>        Procedure SET EZFTPRemoteAddress String lpropVal
36892>>>                Send SetStringProperty 1 lpropVal
36893>>>        End_Procedure
36894>>>
36894>>>        Function EZFTPLocalFile Returns String
36895>>>                Local String lpropVal
36896>>>                Get GetStringProperty 2 to lpropVal
36897>>>                Function_Return lpropVal
36898>>>        End_Function
36899>>>
36899>>>        Procedure SET EZFTPLocalFile String lpropVal
36900>>>                Send SetStringProperty 2 lpropVal
36901>>>        End_Procedure
36902>>>
36902>>>        Function EZFTPRemoteFile Returns String
36903>>>                Local String lpropVal
36904>>>                Get GetStringProperty 3 to lpropVal
36905>>>                Function_Return lpropVal
36906>>>        End_Function
36907>>>
36907>>>        Procedure SET EZFTPRemoteFile String lpropVal
36908>>>                Send SetStringProperty 3 lpropVal
36909>>>        End_Procedure
36910>>>
36910>>>        Function EZFTPUserName Returns String
36911>>>                Local String lpropVal
36912>>>                Get GetStringProperty 4 to lpropVal
36913>>>                Function_Return lpropVal
36914>>>        End_Function
36915>>>
36915>>>        Procedure SET EZFTPUserName String lpropVal
36916>>>                Send SetStringProperty 4 lpropVal
36917>>>        End_Procedure
36918>>>
36918>>>        Function EZFTPPassword Returns String
36919>>>                Local String lpropVal
36920>>>                Get GetStringProperty 5 to lpropVal
36921>>>                Function_Return lpropVal
36922>>>        End_Function
36923>>>
36923>>>        Procedure SET EZFTPPassword String lpropVal
36924>>>                Send SetStringProperty 5 lpropVal
36925>>>        End_Procedure
36926>>>
36926>>>        Function EZFTPBinary Returns Bool
36927>>>                Local Bool lpropVal
36928>>>                Get GetBoolProperty 6 to lpropVal
36929>>>                Function_Return lpropVal
36930>>>        End_Function
36931>>>
36931>>>        Procedure SET EZFTPBinary Bool lpropVal
36932>>>                Send SetBoolProperty 6 lpropVal
36933>>>        End_Procedure
36934>>>
36934>>>        Function EZFTPRemoteDirectory Returns String
36935>>>                Local String lpropVal
36936>>>                Get GetStringProperty 9 to lpropVal
36937>>>                Function_Return lpropVal
36938>>>        End_Function
36939>>>
36939>>>        Procedure SET EZFTPRemoteDirectory String lpropVal
36940>>>                Send SetStringProperty 9 lpropVal
36941>>>        End_Procedure
36942>>>
36942>>>        Function EZFTPProfessionalEdition Returns Bool
36943>>>                Local Bool lpropVal
36944>>>                Get GetBoolProperty 10 to lpropVal
36945>>>                Function_Return lpropVal
36946>>>        End_Function
36947>>>
36947>>>        Procedure SET EZFTPProfessionalEdition Bool lpropVal
36948>>>                Send SetBoolProperty 10 lpropVal
36949>>>        End_Procedure
36950>>>
36950>>>        Function EZFTPUseCache Returns Bool
36951>>>                Local Bool lpropVal
36952>>>                Get GetBoolProperty 7 to lpropVal
36953>>>                Function_Return lpropVal
36954>>>        End_Function
36955>>>
36955>>>        Procedure SET EZFTPUseCache Bool lpropVal
36956>>>                Send SetBoolProperty 7 lpropVal
36957>>>        End_Procedure
36958>>>
36958>>>        Function EZFTPCancelTransfer Returns Bool
36959>>>                Local Bool lpropVal
36960>>>                Get GetBoolProperty 8 to lpropVal
36961>>>                Function_Return lpropVal
36962>>>        End_Function
36963>>>
36963>>>        Procedure SET EZFTPCancelTransfer Bool lpropVal
36964>>>                Send SetBoolProperty 8 lpropVal
36965>>>        End_Procedure
36966>>>
36966>>>        Procedure EZFTPConnect
36967>>>                Send InvokeVoidFunction 11
36968>>>        End_Procedure
36969>>>
36969>>>        Procedure EZFTPDisconnect
36970>>>                Send InvokeVoidFunction 12
36971>>>        End_Procedure
36972>>>
36972>>>        Procedure EZFTPGetFile
36973>>>                Send InvokeVoidFunction 13
36974>>>        End_Procedure
36975>>>
36975>>>        Procedure EZFTPPutFile
36976>>>                Send InvokeVoidFunction 14
36977>>>        End_Procedure
36978>>>
36978>>>        Procedure EZFTPDeleteFile String lFileName
36979>>>                Send DeclareParams 1
36980>>>                Send DefineStringParam lFileName
36981>>>                Send InvokeVoidFunction 15
36982>>>        End_Procedure
36983>>>
36983>>>        Procedure EZFTPRenameFile String lOldName String lNewName
36984>>>                Send DeclareParams 2
36985>>>                Send DefineStringParam lOldName
36986>>>                Send DefineStringParam lNewName
36987>>>                Send InvokeVoidFunction 16
36988>>>        End_Procedure
36989>>>
36989>>>        Procedure EZFTPMkDir String lDirectoryName
36990>>>                Send DeclareParams 1
36991>>>                Send DefineStringParam lDirectoryName
36992>>>                Send InvokeVoidFunction 17
36993>>>        End_Procedure
36994>>>
36994>>>        Procedure EZFTPRmDir String lDirectoryName
36995>>>                Send DeclareParams 1
36996>>>                Send DefineStringParam lDirectoryName
36997>>>                Send InvokeVoidFunction 18
36998>>>        End_Procedure
36999>>>
36999>>>        Procedure EZFTPGetDirectory String lFileName
37000>>>                Send DeclareParams 1
37001>>>                Send DefineStringParam lFileName
37002>>>                Send InvokeVoidFunction 19
37003>>>        End_Procedure
37004>>>
37004>>>        Procedure EZFTPAboutBox
37005>>>                Send InvokeVoidFunction -552
37006>>>        End_Procedure
37007>>>
37007>>>End_Class
37008>>>
37008>>>// Event interface for EZFTP Control
37008>>>// CLSID:{6580F766-7819-11CF-B86C-444553540000}
37008>>>// ProgId:
37008>>>Class OLE_DEZFTPEvents is a Message
37009>>>
37009>>>        Procedure OnEZFTPNextDirectoryEntry String lFileName DWORD lAttributes OLEReal lLength
37010>>>        End_Procedure
37011>>>
37011>>>        Procedure OnEZFTPTransferProgress DWORD lBytesTransferred DWORD lTotalBytes
37012>>>        End_Procedure
37013>>>
37013>>>End_Class
37014>>>
37014>>>// EZFTP Control
37014>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37014>>>// ProgId: EZFTP.EZFTPCtrl.1
37014>>>// Number of impl.Types:2
37014>>>// Referenced class _DEZFTP
37014>>>// Referenced class _DEZFTPEvents
37014>>>
37014>>>Class OLEEZFTP is a OCX_Client
37015>>>        Import_Class_Protocol OLE_DEZFTP
37016>>>        Import_Class_Protocol OLE_DEZFTPEvents
37017>>>
37017>>>        Procedure Construct_Object
37018>>>                Forward Send Construct_Object
37020>>>                Send DefineOCX_Client
37021>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37022>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37025>>>        End_Procedure
37026>>>
37026>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37027>>>                Local String lFileName
37028>>>                Local DWORD lAttributes
37028>>>                Local OLEReal lLength
37028>>>                Get GetEventStringParam lParam 0 to lFileName
37029>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37030>>>                Get GetEventRealParam lParam 2 to lLength
37031>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37032>>>        End_Procedure
37033>>>
37033>>>        Procedure PreEZFTPTransferProgress Integer lParam
37034>>>                Local DWORD lBytesTransferred
37035>>>                Local DWORD lTotalBytes
37035>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37036>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37037>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37038>>>        End_Procedure
37039>>>
37039>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37040>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37043>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37046>>>        End_Procedure
37047>>>End_Class
37048>>>
37048>>>// EZFTP Control
37048>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37048>>>// ProgId: EZFTP.EZFTPCtrl.1
37048>>>// Number of impl.Types:2
37048>>>// Referenced class _DEZFTP
37048>>>// Referenced class _DEZFTPEvents
37048>>>Class dbOLEEZFTP is a dbOCX_Client
37049>>>        Import_Class_Protocol OLE_DEZFTP
37050>>>        Import_Class_Protocol OLE_DEZFTPEvents
37051>>>
37051>>>        Procedure Construct_Object
37052>>>                Forward Send Construct_Object
37054>>>                Send DefineDbOCX_Client
37055>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37056>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37059>>>        End_Procedure
37060>>>
37060>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37061>>>                Local String lFileName
37062>>>                Local DWORD lAttributes
37062>>>                Local OLEReal lLength
37062>>>                Get GetEventStringParam lParam 0 to lFileName
37063>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37064>>>                Get GetEventRealParam lParam 2 to lLength
37065>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37066>>>        End_Procedure
37067>>>
37067>>>        Procedure PreEZFTPTransferProgress Integer lParam
37068>>>                Local DWORD lBytesTransferred
37069>>>                Local DWORD lTotalBytes
37069>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37070>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37071>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37072>>>        End_Procedure
37073>>>
37073>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37074>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37077>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37080>>>        End_Procedure
37081>>>End_Class
37082>Use dvFTP    // Ftp Package
INCLUDING FILE: DVFTP.PKG
37082>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37082>>>//             for Visual Dataflex
37082>>>//
37082>>>// Created by: Marcel J. Zwiebel
37082>>>//             Dataview - The Netherlands
37082>>>// E-mail    : marcel@dataview-sc.com
37082>>>// CIS id    : 100273,2473
37082>>>// Web URL   : http://www.dataview-sc.com
37082>>>//
37082>>>// Date      : 28/07/1997 
37082>>>
37082>>>Use Windows.pkg
37082>>>Use DLL.pkg
37082>>>
37082>>>// register external functions of the dvftp.dll
37082>>>
37082>>>
37082>>>// function   : dvInternetAttemptConnect
37082>>>//
37082>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37082>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37082>>>//              ISP, the standard dialup dialog box will be evoked.
37082>>>//                   
37082>>>// parameters : none
37082>>>//
37082>>>// returns    : integer - Is 0 (ok) or error-number.
37082>>>//
37082>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37083>>>
37083>>>
37083>>>// function   : dvInternetOpen
37083>>>//
37083>>>// description: Initializes the application's use of the WIN32 Internet functions.
37083>>>//
37083>>>// parameters : none
37083>>>//
37083>>>// returns    : integer - Is 0 (ok) or error-number.
37083>>>//
37083>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37084>>>
37084>>>
37084>>>// function   : dvInternetConnect
37084>>>//
37084>>>// description: Opens an FTP-session with a server.
37084>>>//
37084>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37084>>>//                                  an ip-number (for example: 145.58.31.4).
37084>>>//              string UserName   - Login-name for the server, can be empty for 
37084>>>//                                  "anonymous" login (default for most FTP servers).
37084>>>//              string Password   - Password for the server, can be empty for 
37084>>>//                                  "anonymous" login (default for most FTP servers).
37084>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37084>>>//                                  server, otherwise 0.
37084>>>//
37084>>>// returns    : integer - Is 0 (ok) or error-number.
37084>>>//
37084>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37085>>>
37085>>>
37085>>>// function   : dvFtpSetCurrentDirectory
37085>>>//
37085>>>// description: Changes to a different working directory on the FTP server.
37085>>>//
37085>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37085>>>//                                 This can be either a fully qualified path or a name 
37085>>>//                                 relative to the current directory. 
37085>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37085>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37085>>>//                                 translates the directory name separators to the appropriate 
37085>>>//                                 character before they are used. 
37085>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37085>>>//                                 current working directory (not all remote systems use a
37085>>>//                                 hierarchical naming scheme for directories).
37085>>>//
37085>>>// returns    : integer - Is 0 (ok) or error-number.
37085>>>//
37085>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37086>>>
37086>>>
37086>>>// function   : dvFtpGetCurrentDirectory
37086>>>//
37086>>>// description: Retrieves the current directory for the specified FTP session.
37086>>>//
37086>>>// parameters : none
37086>>>//
37086>>>// returns    : string - Name of the current directory.
37086>>>//
37086>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37087>>>
37087>>>
37087>>>// function   : dvFtpCreateDirectory
37087>>>//
37087>>>// description: Creates a new directory on the FTP server. 
37087>>>//
37087>>>// parameters : string Directory - The name of the directory to create on the remote system.
37087>>>//                                 This can be either a fully qualified path or a name 
37087>>>//                                 relative to the current directory. 
37087>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37087>>>//                                 directory separator for either name. dvFtpCreateDirectory
37087>>>//                                 translates the directory name separators to the appropriate 
37087>>>//                                 character before they are used. 
37087>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37087>>>//                                 current working directory (not all remote systems use a
37087>>>//                                 hierarchical naming scheme for directories).
37087>>>//
37087>>>// returns    : integer - Is 0 (ok) or error-number.
37087>>>//
37087>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37088>>>
37088>>>
37088>>>// function   : dvFtpRemoveDirectory
37088>>>//
37088>>>// description: Removes the specified directory on the FTP server. 
37088>>>//
37088>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37088>>>//                                 This can be either a fully qualified path or a name 
37088>>>//                                 relative to the current directory. 
37088>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37088>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37088>>>//                                 translates the directory name separators to the appropriate 
37088>>>//                                 character before they are used. 
37088>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37088>>>//                                 current working directory (not all remote systems use a
37088>>>//                                 hierarchical naming scheme for directories).
37088>>>//
37088>>>// returns    : integer - Is 0 (ok) or error-number.
37088>>>//
37088>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37089>>>
37089>>>
37089>>>// function   : dvFtpFindFirstFile
37089>>>//
37089>>>// description: Searches the specified directory of the given FTP session.
37089>>>//
37089>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37089>>>//                                  the FTP server's file system. If the string is empty the 
37089>>>//                                  first file in the current directory on the server will be 
37089>>>//                                  searched for. 
37089>>>//              integer UseCache  - Indicates using the local computer's cache.
37089>>>//                                  If the value is 0 then the the cache will be used. 
37089>>>//                                  If the value is 1 then a download of the requested file, 
37089>>>//                                  object, or directory listing from the origin server will be 
37089>>>//                                  forced, not from the cache.
37089>>>//
37089>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37089>>>//                       searched directory is empty the string "directory is empty" is returned.
37089>>>//
37089>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37090>>>
37090>>>
37090>>>// function   : dvFtpFindNextFile
37090>>>//
37090>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37090>>>//
37090>>>// parameters : none
37090>>>//
37090>>>// returns    : string - Name of the next file found or empty when no more files are found.
37090>>>//
37090>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37091>>>
37091>>>
37091>>>// function   : dvFtpDeleteFile
37091>>>//
37091>>>// description: Deletes a file stored on the FTP server. 
37091>>>//
37091>>>// parameters : string FileSelect - Name of the file to be deleted.
37091>>>//                                  Can be file names relative to the current directory. 
37091>>>//                                  A backslash (\) or forward slash (/) can be used as 
37091>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37091>>>//                                  directory name separators to the appropriate character 
37091>>>//                                  before they are used. 
37091>>>//
37091>>>// returns    : integer - Is 0 (ok) or error-number.
37091>>>//
37091>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37092>>>
37092>>>
37092>>>// function   : dvFtpRenameFile
37092>>>//
37092>>>// description: Renames a file stored on the FTP server. 
37092>>>//
37092>>>// parameters : string Existing - The name of the file that will have its name changed on the
37092>>>//                                remote FTP server. 
37092>>>//              string New      - The new name for the remote file. 
37092>>>//
37092>>>//                                Both names can be relative to the current directory. A backslash 
37092>>>//                                (\) or forward slash (/) can be used as the directory separator 
37092>>>//                                for either name. dvFtpRenameFile translates the directory name 
37092>>>//                                separators to the appropriate character before they are used. 
37092>>>//
37092>>>// returns    : integer - Is 0 (ok) or error-number.
37092>>>//
37092>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37093>>>
37093>>>
37093>>>// function   : dvFtpGetFile
37093>>>//
37093>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37093>>>//              creating a new local file in the process. 
37093>>>//
37093>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37093>>>//              string  NewFile      - The name of the file to create on the local system. 
37093>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37093>>>//                                     proceed if a local file of the specified name already exists. 
37093>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37093>>>//              integer FileType     - Indicates the transfer method.
37093>>>//                                     If the value is 0 then the function transfers the file using 
37093>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37093>>>//                                     information is converted to local equivalents. 
37093>>>//                                     If the value is 1 then the function transfers the file using 
37093>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37093>>>//                                     exactly as it exists with no changes. 
37093>>>//
37093>>>// returns    : integer - Is 0 (ok) or error-number.
37093>>>//
37093>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37094>>>
37094>>>
37094>>>// function   : dvFtpPutFile
37094>>>//
37094>>>// description: Stores a file on the FTP server. 
37094>>>//
37094>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37094>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37094>>>//              integer FileType      - Indicates the transfer method.
37094>>>//                                      If the value is 0 then the function transfers the 
37094>>>//                                      file as ASCII. 
37094>>>//                                      If the value is 1 then the function transfres the
37094>>>//                                      file as binary. 
37094>>>//
37094>>>// returns    : integer - Is 0 (ok) or error-number.
37094>>>//
37094>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37095>>>
37095>>>
37095>>>
37095>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37095>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37095>>>// some of the common information about files, such as file creation date and time, is not 
37095>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37095>>>// fill in unavailable information with a best guess based on available information. For example,
37095>>>// creation and last access dates will often be the same as the file's modification date.
37095>>>
37095>>>
37095>>>// function   : dvFtpFilename
37095>>>//
37095>>>// description: The name of the file. 
37095>>>//
37095>>>// parameters : none
37095>>>//
37095>>>// returns    : string - Name of the file
37095>>>//
37095>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37096>>>
37096>>>
37096>>>// function   : dvFtpAlternateFilename
37096>>>//
37096>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37096>>>//              filename format.
37096>>>//
37096>>>// parameters : none
37096>>>//
37096>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37096>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37096>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37096>>>//                       this function returns an empty string.
37096>>>//
37096>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37097>>>
37097>>>
37097>>>// function   : dvFtpFileCreated
37097>>>//              
37097>>>// description: The date/time the file was created in 24-hour format.
37097>>>//
37097>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37097>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37097>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37097>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37097>>>//
37097>>>// returns    : string - The file creation-date/time
37097>>>//
37097>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37098>>>
37098>>>
37098>>>// function   : dvFtpFileAccessed
37098>>>//              
37098>>>// description: The last date/time the file was accessed in 24-hour format.
37098>>>//
37098>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37098>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37098>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37098>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37098>>>//
37098>>>// returns    : string - The last file access-date/time
37098>>>//
37098>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37099>>>
37099>>>
37099>>>// function   : dvFtpFileWritten
37099>>>//              
37099>>>// description: The last date/time the file was written to in 24-hour format.
37099>>>//
37099>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37099>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37099>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37099>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37099>>>//
37099>>>// returns    : string - The last file written to-date/time
37099>>>//
37099>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37100>>>
37100>>>
37100>>>// function   : dvFtpFileSize
37100>>>//              
37100>>>// description: The size of the file in bytes.
37100>>>//
37100>>>// parameters : none
37100>>>//
37100>>>// returns    : integer - Filesize in bytes.
37100>>>//
37100>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37101>>>
37101>>>
37101>>>// function   : dvFtpIsDirectory
37101>>>//              
37101>>>// description: The file is an directory.
37101>>>//
37101>>>// parameters : none
37101>>>//
37101>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37101>>>//
37101>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37102>>>
37102>>>
37102>>>// function   : dvGetServerMsg
37102>>>//              
37102>>>// description: Gets the returned message from the FTP server (error-number will
37102>>>//              be 12003 "extended error").
37102>>>//
37102>>>// parameters : none
37102>>>//
37102>>>// returns    : string - Return message from the FTP server.
37102>>>//
37102>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37103>>>
37103>>>
37103>>>// error-numbers returned
37103>>>//
37103>>>// 12001  "out of handles"            
37103>>>// 12002  "timeout"
37103>>>// 12003  "extended error"
37103>>>// 12004  "internal error"            
37103>>>// 12005  "invalid url"               
37103>>>// 12006  "unrecognized scheme"       
37103>>>// 12007  "name not resolved"         
37103>>>// 12008  "protocol not found"        
37103>>>// 12009  "invalid option"            
37103>>>// 12010  "bad option length"         
37103>>>// 12011  "option not settable"      
37103>>>// 12012  "shutdown"                  
37103>>>// 12013  "incorrect user name"       
37103>>>// 12014  "incorrect password"
37103>>>// 12015  "login failure"             
37103>>>// 12016  "invalid operation"         
37103>>>// 12017  "operation cancelled"       
37103>>>// 12018  "incorrect handle type"     
37103>>>// 12019  "incorrect handle state"
37103>>>// 12020  "not proxy request"         
37103>>>// 12021  "registry value not found"
37103>>>// 12022  "bad registry parameter"    
37103>>>// 12023  "no direct access"          
37103>>>// 12024  "no context"                
37103>>>// 12025  "no callback"               
37103>>>// 12026  "request pending"           
37103>>>// 12027  "incorrect format"          
37103>>>// 12028  "item not found"            
37103>>>// 12029  "cannot connect"            
37103>>>// 12030  "connection aborted"        
37103>>>// 12031  "connection reset"          
37103>>>// 12032  "force retry"               
37103>>>// 12033  "invalid proxy request"     
37103>>>// 12034  "need ui"                   
37103>>>// 12036  "handle exists"             
37103>>>// 12037  "sec cert date invalid"     
37103>>>// 12038  "sec cert cn invalid"       
37103>>>// 12039  "http to https on redir"    
37103>>>// 12040  "https to http on_redir"    
37103>>>// 12041  "mixed security"            
37103>>>// 12042  "chg post is non secure"    
37103>>>// 12043  "post is non_secure"        
37103>>>// 12044  "client auth cert needed"   
37103>>>// 12045  "invalid ca"                
37103>>>// 12046  "client auth not setup"     
37103>>>// 12047  "async thread failed"       
37103>>>// 12048  "redirect scheme change"    
37103>>>// 12049  "dialog pending"            
37103>>>// 12050  "retry dialog"              
37103>>>// 12110  "ftp transfer in progress"  
37103>>>// 12111  "ftp dropped"               
37103>>>// 12112  "ftp no passive mode"       
37103>>>// 12157  "security channel error"    
37103>>>// 12158  "unable to cache file"      
37103>>>// 12159  "tcpip not installed"       
37103>>>// 12163  "disconnected"              
37103>>>// 12164  "server unreachable"        
37103>>>// 12165  "proxy server unreachable"  
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37103>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37103>>>//
37103>>>// Created by: Marcel J. Zwiebel
37103>>>//             Dataview - The Netherlands
37103>>>// E-mail    : marcel@dataview-sc.com
37103>>>// Web URL   : http://www.dataview-sc.com
37103>>>//
37103>>>// Date      : 03/24/1999
37103>>>
37103>>>Use Windows.pkg
37103>>>Use DLL.pkg 
37103>>>
37103>>>
37103>>>// register external functions of the dvdailer.dll
37103>>>
37103>>>
37103>>>// function   : dvInternetGetConnectedState
37103>>>//
37103>>>// description: Retrieves the connected state of the local system.
37103>>>//                   
37103>>>// parameters : none
37103>>>//
37103>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37103>>>//                              2 = the local system uses a local area network to connect to the Internet.
37103>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37103>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37103>>>//                              0 = there is no Internet connection.
37103>>>//
37103>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37104>>>
37104>>>
37104>>>// function   : dvInternetAutodial
37104>>>//
37104>>>// description: Automatically causes the modem to dial the default Internet connection.
37104>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37104>>>//                   
37104>>>// parameters : none
37104>>>//
37104>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37104>>>//
37104>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37105>>>
37105>>>
37105>>>// function   : dvInternetAutodialHangup
37105>>>//
37105>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37105>>>//                   
37105>>>// parameters : none
37105>>>//
37105>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37105>>>//
37105>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37106>>>
37106>>>
37106>>>// function   : dvInternetDial
37106>>>//
37106>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37106>>>//              Use the function dvInternetHangup to hangup this connection.
37106>>>//                   
37106>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37106>>>//
37106>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37106>>>//
37106>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37107>>>
37107>>>
37107>>>// function   : dvInternetHangup
37107>>>//
37107>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37107>>>//              
37107>>>// parameters : none
37107>>>//
37107>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37107>>>//
37107>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>//------------------------------
37108>
37108>
37108>//AB-StoreTopEnd
37108>
37108>
37108>Object Main is a Panelsub
37110>    Set Label To "TRANS DOMIKH YPOLOIPA ERMH"
37111>
37111>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
37114>>//************************************************************************
37114>>//
37114>>//* Copyright (c) 1997 Data Access Corporation, Miami Florida,
37114>>//* All rights reserved.
37114>>//* DataFlex is a registered trademark of Data Access Corporation.
37114>>//*
37114>>//*
37114>>//*  Module Name:
37114>>//*      FILE_PM.INC
37114>>//*
37114>>//*  Creator:
37114>>//*        LS, MAZ, JJT(changed for windaf)
37114>>//*
37114>>//*  Date:
37114>>//*      November 31, 1992
37114>>//*      10/28/94 03:17 pm - JJT windaf chagges
37114>>//*
37114>>//*  Purpose:
37114>>//*         package for creating generic record_pull_down object for entry
37114>>//*             object actions(assumed to be used as first pull down menu,
37114>>//*             hence EXIT option as last item)
37114>>//*
37114>>//*************************************************************************
37114>>// JJT - Modified to shadow items if not a DEO OR if no server
37114>>//*************************************************************************
37114>>
37114>>
37114>>Object oMyWinPrint is an DF_PRINTER
37116>>
37116>>    Procedure DFPrint
37118>>        Local Integer iRetVal
37119>>
37119>>        Get DFGetPrintDialogFlags To iRetVal
37120>>
37120>>        If iRetVal Begin
37122>>            Send DFPrintDoc
37123>>            Send DFClearDoc
37124>>        End
37124>>>
37124>>    End_Procedure
37125>>    Move Current_Object to WinPrintId
37126>>End_Object
37127>>
37127>>Register_Procedure Set piPropertiesObjectId
37127>>Register_Function piPropertiesObjectId Returns Integer
37127>>
37127>>Register_Function Close_All_Views Integer bWith_Confirmation Returns Integer
37127>>
37127>>DFCreate_Menu "&„šš¨˜­âª" File_Menu is a DEOPopupMenu
37131>>    On_Item "&€¡ç¨à©ž/Add\aF5" send Request_Clear
37132>>        Set Status_Help To '‰˜Ÿ˜¨åœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37133>>
37133>>    On_Item "&Super €¡ç¨à©ž\aCtrl+F5" send Request_Clear_All
37134>>        Set Status_Help To '‰˜Ÿ˜¨åœ  æ¢˜ «˜ ›œ›¦£â¤˜ ˜§æ «ž¤ æ¯ž'
37135>>
37135>>    On_Item "&ƒ ˜š¨˜­ã\aShift+F2" send Request_Delete
37136>>        Set Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37137>>
37137>>    On_Item "&€¤˜ã«ž©ž\aF9" send Find_GE
37138>>        Set Status_Help To '¨å©¡œ  £ á œšš¨˜­ã'
37139>>
37139>>    On_Item "&„§æ£œ¤¦\aF8" send Find_Next
37140>>        Set Status_Help To '¨å©¡œ  «ž¤ œ§æ£œ¤ž œšš¨˜­ã'
37141>>
37141>>    On_Item "&¨¦žš¦ç£œ¤¦\aF7" send Find_Previous
37142>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨¦žš¦ç£œ¤ž œšš¨˜­ã'
37143>>
37143>>    //On_Item "Super ˜¤˜ã«ž©ž\aShift+F9" send Superfind
37143>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž £ áª œšš¨˜­ãª'
37143>>
37143>>    //On_Item "Super œ§æ£œ¤¦\aShift+F8" send Superfind_Next
37143>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž œ§æ£œ¤žª œšš¨˜­ãª'
37143>>
37143>>    //On_Item "Super §¨¦žš¦ç£œ¤¦\aShift+F7" send Superfind_Previous
37143>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž §¨¦žš¦ç£œ¤žª œšš¨˜­ãª'
37143>>
37143>>    On_Item "&¨é«¦\aCtrl+Home" send Beginning_Of_Data
37144>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨é«ž œšš¨˜­ã'
37145>>
37145>>    On_Item "’œ&¢œ¬«˜å¦\aCtrl+End" send End_Of_Data
37146>>        Set Status_Help To '¨å©¡œ  «ž¤ «œ¢œ¬«˜¢å˜ œšš¨˜­ã'
37147>>
37147>>    On_Item "&„šš¨˜­ž\aF2" send Request_Save
37148>>        Set Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37149>>
37149>>    On_Item "" send NONE
37150>>
37150>>    //on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  Send Activate_oPrnSetup to (client_area(current_object))
37150>>    on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  send DFPrintSetup       to (oWinPrint(Self))
37151>>    Set Status_Help To "çŸ£ ©ž œ¡«ç§à©žª"
37152>>    on_item   "„¡«ç§à©ž           "  send DFPrint            to (oMyWinPrint(Self))
37153>>    Set Status_Help To "„¡«ç§à©ž œšš¨á­¦¬"
37154>>
37154>>    On_Item "" send NONE
37155>>
37155>>    On_Item "&ˆ› ¦«ž«œª\aAlt+I" send DoShowProperties to Self
37156>>    Set Status_Help To '‰˜Ÿ¦¨ ©£æª ˆ› ¦«ã«à¤ «žª œ­˜¨£¦šãª'
37157>>
37157>>    On_Item "" send NONE
37158>>
37158>>    On_Item "„&¥¦›¦ª\aAlt+F4" send Exit_Application to desktop
37159>>        Set Status_Help To 'š˜å¤œ  ˜§¦ «ž¤ œ­˜¨£¦šã'
37160>>
37160>>    Procedure DoShowProperties
37162>>        If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37165>>    End_Procedure
37166>>
37166>>    On_Key Key_Alt+Key_I Send DoShowProperties
37167>>
37167>>    //  When ever the menu [pulldown] is initialized, check/set
37167>>    //  the state of its items.
37167>>    //
37167>>    Procedure OnInitMenu
37169>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
37170>>        Local integer IsDeoControl lId liClId
37170>>        Get Focus to Obj#
37171>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37172>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
37175>>        If (isDeo AND Srvr) Begin
37177>>            // returns T if object in question is a DEO control object (i.e.
37177>>            // understands the data_file, data_field messages).
37177>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37178>>            Get Should_Save of Obj# to changed  // changed file?
37179>>            If IsDEOControl Begin
37181>>                Get data_file of Obj# to file#
37182>>                Get data_field of Obj# to field#
37183>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
37184>>            End
37184>>>
37184>>            Else ;                Move 1 to NoIndex
37186>>            Set Shadow_state item 0  to False
37187>>            Set Shadow_state item 1  to False
37188>>            Set Shadow_state item 2  to (Current_record(Srvr)=0)
37189>>            Set Shadow_state item 3  to NoIndex
37190>>            Set Shadow_state item 4  to NoIndex
37191>>            Set Shadow_state item 5  to NoIndex
37192>>            Set Shadow_state item 6  to NoIndex
37193>>            Set Shadow_state item 7  to NoIndex
37194>>            Set Shadow_state item 8  to (Should_Save(Srvr)=0)
37195>>         //   Set Shadow_state item 9  to NoIndex
37195>>         //   Set Shadow_state item 10  to NoIndex
37195>>         //   Set Shadow_state item 11 to NoIndex
37195>>         //   Set Shadow_state item 12 to (Should_Save(Srvr)=0)
37195>>        End
37195>>>
37195>>        Else Begin
37196>>            for itm from 0 to 8 //11
37202>>>
37202>>                set shadow_State item itm to TRUE
37203>>            Loop
37204>>>
37204>>        End
37204>>>
37204>>        Set Shadow_State Item 13 to (piPropertiesObjectId(Self)=0)
37205>>    End_Procedure
37206>>
37206>>    Register_Procedure Activate_oPrnSetup
37206>>
37206>>End_Pull_Down
37208>>Set Status_Help to "€¤˜ã«ž©ž, „šš¨˜­ã, ƒ ˜š¨˜­ã, €¡ç¨à©ž ›œ›¦£â¤à¤ ã â¥¦›¦ª ˜§¦ «ž¤ œ­˜¨£¦šã"
37209>
37209>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
37213>            On_Item "&gefyres:domikh2\aCtrl+1" Send Activate_gefyres2
37214>            On_Item "&gefyresdom:domikh3\aCtrl+2" Send Activate_Gefyres3
37215>            On_Item "&CN_DELET\aCtrl+3" Send Activate_CN_DELET
37216>        End_Pull_down
37218>        Set Status_Help To "Available Views"
37219>        
37219>        DFCreate_Menu "&Report" ReportPopupMenu is a ViewPopupMenu
37223>            On_Item "&Rmetafyp\aCtrl+4" Send Activate_rmetafyp
37224>        End_Pull_down
37226>        Set Status_Help To "Available Reports"
37227>        
INCLUDING FILE: NAVI_PM.INC
37227>>Use DFDEOMnu
37227>>
37227>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
37231>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
37232>>        Set Status_Help To  'Move to Next Area'
37233>>
37233>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
37234>>        Set Status_Help To  'Move to Previous Area'
37235>>
37235>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
37236>>        Set Status_Help To  'Move to Next View'
37237>>
37237>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
37238>>        Set Status_Help To  'Move to Previous View'
37239>>
37239>>    On_Item ""                          send none
37240>>
37240>>    On_Item "&List\aF4"               send Prompt
37241>>        Set Status_Help To  'Show Selection Lists'
37242>>
37242>>    On_Item "&Zoom\aAlt+F9"             send Zoom
37243>>        Set Status_Help To  'Show Zoom'
37244>>
37244>>    Procedure OnInitMenu
37246>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
37247>>        Get Focus to Obj#
37248>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37249>>        If IsDeo Begin
37251>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37252>>            If IsDeoControl Begin
37254>>                Get Prompt_Object of Obj# to Prmpt
37255>>                Get Zoom_Object of Obj# to zm
37256>>            End
37256>>>
37256>>            Set Shadow_state item 0  to False
37257>>            Set Shadow_state item 1  to False
37258>>            Set Shadow_state item 2  to False
37259>>            Set Shadow_state item 3  to False
37260>>            Set Shadow_state item 5  to (Prmpt=0)
37261>>            Set Shadow_state item 6  to (Zm=0)
37262>>        End
37262>>>
37262>>        Else Begin
37263>>            for itm from 0 to 6
37269>>>
37269>>                set shadow_State item itm to TRUE
37270>>            Loop
37271>>>
37271>>        End
37271>>>
37271>>    End_Procedure
37272>>
37272>>End_Pull_Down
37274>>Set Status_Help to "Navigation in different areas of the screen"
37275>>
INCLUDING FILE: WIN_PM.INC
37275>>DFCreate_Menu "&Window" Window_Menu
37279>>    Set select_mode to Multi_Select
37280>>    // normal number of items in pulldown (w/ no active views)
37280>>    property integer std_item_count public 0
37282>>
37282>>    DFCreate_Menu "&Preferences" Display_Options_Menu
37286>>        Set select_mode to Multi_Select
37287>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
37288>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
37289>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
37290>>
37290>>        //  When ever the menu [pulldown] is initialized, check/set
37290>>        //  the state of its items.
37290>>        //
37290>>        Procedure OnInitMenu
37292>>            local integer bState
37293>>
37293>>            Get ToolBar_State to bState
37294>>            Set Select_State Item 0 to bState
37295>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
37298>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
37300>>
37300>>            Get Statusbar_State to bState
37301>>            Set Select_State Item 1 to bState
37302>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
37305>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
37307>>
37307>>            Get Auto_Arrange_Icons_State to bState
37308>>            Set Select_State Item 2 to bState
37309>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
37312>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
37314>>
37314>>        End_procedure
37315>>
37315>>
37315>>    End_Pull_Down
37317>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
37318>>
37318>>    On_Item ""
37319>>
37319>>    On_Item "&Cascade" send Cascade_Windows                   To Self
37320>>        Set Status_Help                                       To ''
37321>>
37321>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
37322>>        Set Status_Help                                       To ''
37323>>
37323>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
37324>>        Set Status_Help                                       To ''
37325>>
37325>>    On_Item ""
37326>>
37326>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
37327>>        Set Status_Help                                       To ''
37328>>
37328>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
37329>>        Set Status_Help                                       To ''
37330>>
37330>>    On_Item ""
37331>>
37331>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
37332>>        Set Status_Help                                       To ''
37333>>
37333>>    // set this to the number of items in the menu with no views.
37333>>    Set Std_item_count to (item_count(current_object))
37334>>
37334>>    // add all active views to the end of the menu
37334>>    Procedure OnInitMenu
37336>>        local integer iStdCnt iNumCnt hVw hCl iCount
37337>>        Local string sLbl
37337>>        //*** Remove all old view items
37337>>        Get Item_count     to iNumCnt
37338>>        get Std_item_count to iStdCnt
37339>>        For iCount from 1  to (iNumCnt - iStdCnt)
37345>>>
37345>>            Send Delete_item iStdCnt
37346>>        Loop
37347>>>
37347>>
37347>>        Move iStdcnt to iNumCnt
37348>>        get Client_id to hCl // object id of client area
37349>>        If hCl Begin
37351>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
37352>>           While hVw
37356>>              if (Active_state(hVw)) Begin
37358>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
37360>>                    send add_item 0 ''
37361>>                    increment iNumCnt
37362>>                 end
37362>>>
37362>>                 Get Label of hVw to sLbl // caption bar (name) of view
37363>>                 // note that all views understand the message activate_view.
37363>>                 send add_item msg_activate_view sLbl // set message, value and destination
37364>>                 set aux_value item iNumcnt to hVw
37365>>                 // if this is the focus view, mark it.
37365>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
37368>>                 // create status help
37368>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
37369>>                 increment iNumCnt
37370>>              end
37370>>>
37370>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
37371>>           End
37372>>>
37372>>        End
37372>>>
37372>>    End_Procedure // OnInitMenu
37373>>
37373>>End_Pull_Down
37375>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
37376>>
37376>>
37376>>DFCreate_Menu "&Help" Help_Menu
37380>>    on_item "&Help Topic" send Help_on_topic
37381>>        Set Status_Help To "Search for help on a particular subject."
37382>>        on_item "" send NONE
37383>>    on_item "&Context Help"          send Extended_Help
37384>>        Set Status_Help To "Show Context sensitive help."
37385>>
37385>>    on_item "&Files Help"            send File_Help
37386>>        Set Status_Help To "Show Files help."
37387>>
37387>>    on_item "&Keys Help"             send Keys_Help
37388>>        Set Status_Help To "Show Keys help."
37389>>
37389>>    on_item "" send NONE
37390>>
37390>>    on_item "&How to Use Help"       send Help_For_Help
37391>>        Set Status_Help To "How to Use Help"
37392>>
37392>>    on_item "" send NONE
37393>>
37393>>    On_Item "&Tips of the Day" send Activate_TipOfDay
37394>>        Set Status_Help To "Tips of the Day"
37395>>
37395>>    on_item "" send NONE
37396>>
37396>>    On_item "About" Send Activate_About
37397>>        Set Status_Help To "System Information"
37398>>end_pull_down
37400>>Set Status_Help to "Access to the program's help subsystem"
37401>>
37401>>Register_Procedure Activate_TipOfDay
37401>>
37401>>
37401>    End_Menu
37403>
37403>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
37403>>>// 23/07/1998 SPY
37403>>>
37403>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
37403>>>>>//-------------------------------------------------------------------------
37403>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
37403>>>>>//
37403>>>>>//
37403>>>>>// 07/23/96 JJT - New Class names
37403>>>>>//-------------------------------------------------------------------------
37403>>>>>
37403>>>>>Use DfPanel // dfapp_buttonbar
37403>>>>>
37403>>>>>Class ToolBar is a AppToolBar
37404>>>>>
37404>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
37405>>>>>      Local integer rval MainObj#
37406>>>>>      Get Main_Panel_id to MainObj#
37407>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
37410>>>>>      Function_Return rVal
37411>>>>>    End_Function
37412>>>>>
37412>>>>>    Procedure Redirect_Button_Message integer Itm
37413>>>>>         Local integer Msg# Aux# rval Understood
37414>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
37417>>>>>         Get Message   item itm  to Msg#
37418>>>>>         Get Aux_Value item itm  to Aux#
37419>>>>>         If Msg# Begin
37421>>>>>           If Aux# eq 0 Begin
37423>>>>>              Get Focus to Aux#
37424>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
37425>>>>>              If Not Understood Move 0 to Aux#
37428>>>>>           End
37428>>>>>>
37428>>>>>           If Aux# Get Msg# of Aux# to rval
37431>>>>>           Procedure_return rval
37432>>>>>         end
37432>>>>>>
37432>>>>>    End_Procedure // Redirect_Message
37433>>>>>
37433>>>>>End_Class
37434>>>>>
37434>>>>>
37434>>>Use Dates.utl
37434>>>
37434>>>Register_Object CalendarEz
37434>>>Register_Procedure Activate_Sort_Vw
37434>>>Register_Procedure DoPrintScreen
37434>>>
37434>>>Procedure doPopupCalendar
37436>>>    Send request_popup to (Popup_calendar(Self))
37437>>>End_Procedure
37438>>>
37438>>>Procedure doRebuild
37440>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
37441>>>End_Procedure
37442>>>
37442>>>Procedure doExit_Application
37444>>>    send Exit_Application to desktop
37445>>>End_Procedure
37446>>>
37446>>>Procedure DoRefresh_Grids
37448>>>    Integer liObj
37449>>>    
37449>>>    Move (Focus(Desktop)) to liObj
37450>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
37453>>>End_Procedure
37454>>>
37454>>>Procedure DoPopupCalc
37456>>>    Runprogram background "Calc.exe"
37457>>>End_Procedure
37458>>>
37458>>>Procedure DoPopupSetup
37460>>>    string sRunPath
37461>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
37464>>>    append sRunPath "\dfparams"
37465>>>    send DoRunApplication sRunPath
37466>>>End_Procedure
37467>>>
37467>>>Object oMyWinPrint is an DF_PRINTER
37469>>>    Procedure DFPrint
37471>>>        Integer iRetVal
37472>>>        Get DFGetPrintDialogFlags To iRetVal
37473>>>        If iRetVal Begin
37475>>>            Send DFPrintDoc
37476>>>            Send DFClearDoc
37477>>>        End
37477>>>>
37477>>>    End_Procedure
37478>>>    Move Current_Object to WinPrintId
37479>>>End_Object
37480>>>
37480>>>
37480>>>Procedure DoPrint
37482>>>    Send DfPrint to (oMyWinPrint(Self))
37483>>>End_Procedure
37484>>>
37484>>>Procedure DoShowPropertiesPage
37486>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37489>>>End_Procedure
37490>>>
37490>>>   //  Button bar object.
37490>>>//
37490>>>Object Tool_Bar is a ToolBar     
37492>>>    
37492>>>    Property Integer piOutputDestination Public 0
37494>>>
37494>>>    Send ImageList_Add 'bgn.bmp'      // 0
37495>>>    Send ImageList_Add 'end.bmp'      // 1
37496>>>    Send ImageList_Add 'next.bmp'     // 2
37497>>>    Send ImageList_Add 'prev.bmp'     // 3
37498>>>    Send ImageList_Add 'clr.bmp'      // 4
37499>>>    Send ImageList_Add 'clra.bmp'     // 5
37500>>>    Send ImageList_Add 'calend.bmp'   // 6
37501>>>    Send ImageList_Add 'Abfile.bmp'   // 7
37502>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
37503>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
37504>>>    Send ImageList_Add 'Abup.bmp'     // 10
37505>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
37506>>>    Send ImageList_Add 'Save1.bmp'    // 12
37507>>>    Send ImageList_Add 'Exitm.bmp'    // 13
37508>>>    Send ImageList_Add 'include.bmp'  // 14
37509>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
37510>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
37511>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
37512>>>    Send ImageList_Add 'calc1.bmp'    // 18
37513>>>    Send ImageList_Add 'print_m0.bmp' // 19
37514>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
37515>>>    Send ImageList_Add 'vuur.bmp'     // 21
37516>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
37516>>>
37516>>>    send Add_button (ico_user+0) msg_beginning_of_data
37517>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
37518>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
37519>>>
37519>>>    send Add_button (ico_user+3) msg_find_previous
37520>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
37521>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
37522>>>
37522>>>    send Add_button (ico_user+10) msg_find_GE
37523>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
37524>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
37525>>>
37525>>>    send Add_button (ico_user+2) msg_find_next
37526>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
37527>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
37528>>>
37528>>>    send Add_button (ico_user+1) msg_end_of_data
37529>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
37530>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
37531>>>
37531>>>    send Add_space
37532>>>
37532>>>    send Add_button ico_std_find msg_prompt
37533>>>    Send Add_ToolTip "Šå©«˜ (F4)"
37534>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
37535>>>
37535>>>    send Add_button (ico_User+15) msg_zoom
37536>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
37537>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
37538>>>
37538>>>    send Add_button (ico_user+6) msg_doPopupCalendar
37539>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
37540>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
37541>>>
37541>>>    send Add_space
37542>>>
37542>>>    send Add_button (ico_user+4) msg_request_clear
37543>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
37544>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
37545>>>
37545>>>    send Add_button (ico_user+5) msg_request_clear_all
37546>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
37547>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
37548>>>
37548>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
37549>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
37550>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
37551>>>
37551>>>    send Add_space
37552>>>
37552>>>    send Add_button ico_std_filesave msg_request_save
37553>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
37554>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
37555>>>
37555>>>    send Add_button ico_std_delete msg_request_delete
37556>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
37557>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
37558>>>
37558>>>    send Add_button (ico_user+12) msg_request_save_no_clear
37559>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
37560>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
37561>>>
37561>>>    send Add_space
37562>>>
37562>>>    send Add_button ico_std_cut msg_cut
37563>>>    Send Add_ToolTip "€§¦¡¦§ã"
37564>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37565>>>
37565>>>    send Add_button ico_std_copy msg_copy
37566>>>    Send Add_ToolTip "€¤« š¨˜­ã"
37567>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37568>>>
37568>>>    send Add_button ico_std_paste msg_paste
37569>>>    Send Add_ToolTip "„ ©˜šàšã"
37570>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
37571>>>
37571>>>    //send Add_button (ico_user+19) msg_DoPrint
37571>>>    send Add_button ICO_STD_PRINT msg_DoPrint
37572>>>    Send Add_ToolTip "„¡«ç§à©ž"
37573>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
37574>>>
37574>>>    send Add_space              
37575>>>
37575>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
37575>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
37576>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
37577>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
37578>>>    
37578>>>    Object oOutputSelector Is A ComboFormSub
37580>>>       Set Entry_State Item 0 to FALSE
37581>>>       Set Combo_Sort_State to FALSE
37582>>>       Set GuiLocation to 1 480
37583>>>       Set Size to 14 55
37584>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
37585>>>       Set Focus_Mode to Pointer_Only
37586>>>       Set Skip_State to True
37587>>>       
37587>>>       Procedure Combo_Fill_List
37589>>>       
37589>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
37590>>>           Send Combo_Add_Item 'Clipboard'
37591>>>       
37591>>>       End_Procedure
37592>>>       
37592>>>       Procedure OnChange
37594>>>           String liValue
37595>>>           
37595>>>           Get Value Item 0 to liValue 
37596>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
37599>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
37603>>>       End_Procedure
37604>>>       
37604>>>    End_Object   // oReportSelector
37605>>>    
37605>>>    For WindowIndex from 1 to 12
37611>>>>
37611>>>        send Add_space              
37612>>>    Loop
37613>>>>
37613>>>
37613>>>    send Add_button (ico_user+7) msg_DoRebuild
37614>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
37615>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
37616>>>
37616>>>    send Add_button (ico_user+18) msg_DoPopupCalc
37617>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
37618>>>    Set  Status_Help To ""
37619>>>
37619>>>    send Add_button (ico_user+21) msg_DoPopupSetup
37620>>>    Send Add_ToolTip "Setup Client"
37621>>>    Set  Status_Help To "Machine Settings Network Parameter"
37622>>>
37622>>>    send Add_space
37623>>>
37623>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
37624>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
37625>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
37626>>>
37626>>>    send Add_button ico_std_help msg_Help_On_Topic
37627>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
37628>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
37629>>>
37629>>>    send Add_space
37630>>>
37630>>>    send Add_button (ico_user+13) msg_Exit_Application
37631>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
37632>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
37633>>>
37633>>>    Procedure DoPrintScreen
37635>>>        Integer iVoid aiWhereTo
37636>>>        
37636>>>        Get piOutputDestination to aiWhereTo
37637>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
37640>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
37644>>>    End_Procedure
37645>>>
37645>>>
37645>>>    Procedure Redirect_Button_Message integer Itm
37647>>>        Integer msg# liObj liCls
37648>>>        
37648>>>        Get Message   item itm  to Msg#
37649>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
37652>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
37656>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
37660>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
37664>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
37668>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
37672>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
37676>>>        Else Forward Send Redirect_Button_Message Itm
37679>>>    End_Procedure // Redirect_Message
37680>>>
37680>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
37682>>>        Integer hoClient
37683>>>        
37683>>>        Delegate Get Client_Id To hoClient
37685>>>        Delegate Set Client_Id To 0
37687>>>        //----Changes the Icon
37687>>>        //Set Toolbar_State To False
37687>>>        //Set Form_Image_Index Item iItem To iImageIndex
37687>>>        //Set Toolbar_State To True
37687>>>        //----Changes the Shadow_State
37687>>>        Set Shadow_State Item iItem To iImageIndex
37688>>>        Delegate Set Client_Id To hoClient
37690>>>    End_Procedure // DoChangeToolBarIcon
37691>>>
37691>>>    Procedure Page_Object Integer iState
37693>>>      Integer hoCurrentObject
37694>>>      
37694>>>      Forward Send Page_Object iState
37696>>>      Move (Self) to hoCurrentObject
37697>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
37698>>>    End_Procedure   // Page_Object
37699>>>
37699>>>    
37699>>>    Procedure Page Integer iState
37701>>>        Forward Send Page iState
37703>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
37704>>>        If iState Begin
37706>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
37706>>>        End
37706>>>>
37706>>>    End_Procedure
37707>>>    
37707>>>//    Object oToolBarTimer Is A DfTimer
37707>>>//        Procedure OnTimer
37707>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
37707>>>//           
37707>>>//           Get Focus To hoFocus
37707>>>//           If hoFocus Gt Desktop Begin
37707>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
37707>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
37707>>>//                //                    if it is a modal panel, this could throw up error messages.
37707>>>//                If (bIsModal = DfFalse) Begin
37707>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
37707>>>//                End
37707>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
37707>>>//                Move (Parent (Self)) To hoToolBar
37707>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
37707>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
37707>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
37707>>>//                End
37707>>>//           End
37707>>>//       End_Procedure // OnTimer
37707>>>//   End_Object // oToolBarTimer
37707>>>   
37707>>>End_Object
37708>>>
37708>>>
37708>    
37708>    Object Client_Area is a AppClientAreasub
37710>
37710>        //AB-ClientStoreTopStart
37710>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
37710>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
37710>        String Plhktro_SI   Plhktro_DC2     //condesed
37710>        String Plhktro_PAV                  //underline
37710>        String Plhktro_EEE  Plhktro_FFF     //emphasized
37710>        String Plhktro_GGG  Plhktro_HHH     //double strike
37710>        String Plhktro_WWW                  //expanded
37710>        string Plhktro_Q Plhktro_160
37710>        
37710>        External_Function32 MyScriptExec "ScriptExec" ScriptExecute.dll ;            String  ssFile  String  ssODBC Returns Integer
37711>        
37711>        Integer giviewid
37711>        String  gsviewname
37711>        
37711>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
37711>>>
37711>>>Open Sysfile
37713>>>Open UserGrps
37715>>>Open Users
37717>>>Open Views
37719>>>Open GrpViews
37721>>>Open Arxeia
37723>>>Open GrpArx
37725>>>Open GrpArx0
37727>>>Open GrpView0
37729>>>
37729>>>Use DD.Sub
37729>>>
37729>>>Class Datadictionary_Sec  Is A DatadictionarySub
37730>>>
37730>>>
37730>>>    Procedure Construct_Object
37731>>>        Forward Send Construct_Object
37733>>>        Property Integer cpiUpdate              0
37734>>>        Property Integer cpiBackout             0
37735>>>        Property Integer cpiEditing             0
37736>>>        Property Integer cpiFileNumber          0
37737>>>        Property String  cpsFileName            ''
37738>>>        Property String  cpsLoginID             ''
37739>>>        Property Integer cpiCannot_Read         0
37740>>>        Property Integer cpiCannot_Create       0
37741>>>        Property Integer cpiCannot_Delete       0
37742>>>        Property Integer cpiCannot_Edit         0
37743>>>        Property Integer piFN                   0
37744>>>    End_Procedure
37745>>>
37745>>>//    Procedure Save_Main_File
37745>>>//        If (Operation_Origin<>Self) Begin
37745>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
37745>>>//        End
37745>>>//        Forward Send Save_Main_File
37745>>>//    End_Procedure
37745>>>
37745>>>
37745>>>
37745>>>    Function Validate_Save Returns Integer
37746>>>        Integer rVal
37747>>>        Forward Get Validate_Save to rVal
37749>>>        If (Not(rVal)) Begin
37751>>>            Get cpiCannot_Read to rVal
37752>>>            If (Not(rVal)) Begin
37754>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
37755>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
37758>>>                Else                    Get cpiCannot_Create    to rVal
37760>>>            End
37760>>>>
37760>>>            If (rVal) Send Operation_Not_Allowed rVal
37763>>>        End
37763>>>>
37763>>>        Function_Return rVal
37764>>>    End_Function
37765>>>
37765>>>    Function Validate_Delete Returns Integer
37766>>>        Integer rVal
37767>>>        Forward Get Validate_Delete to rVal
37769>>>        If (Not(rVal)) Begin
37771>>>            Get cpiCannot_Read to rVal
37772>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
37775>>>            If (rVal) Send Operation_Not_Allowed rVal
37778>>>        End
37778>>>>
37778>>>        Function_Return rVal
37779>>>    End_Function
37780>>>
37780>>>    Procedure End_Construct_Object
37781>>>        Integer liSrv rVal
37782>>>        String lsStr
37782>>>        Forward Send End_Construct_Object
37784>>>        Get Main_File                                   To liSrv
37785>>>        Set cpiFileNumber                               To liSrv
37786>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
37789>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
37790>>>        Set cpsLoginID                                  To (fsLoginUserID())
37791>>>        Send Find_User_Rights
37792>>>        Set piFN to lisrv
37793>>>    End_Procedure
37794>>>
37794>>>    Procedure Find_User_Rights
37795>>>        String lsArxeio lsLogin
37796>>>        Integer liUser liArxeio iGroup
37796>>>
37796>>>        Get cpiFileNumber   to liArxeio
37797>>>        Get cpsFileName     to lsArxeio
37798>>>        Get cpsLoginID      to lsLogin
37799>>>
37799>>>        Clear Users
37800>>>        Move lsLogin    to Users.Login_ID
37801>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
37802>>>>
37802>>>        If (Found=1)  Begin
37804>>>            Move Users.User_ID  to liUser
37805>>>            Move Users.Grp_ID   to iGroup
37806>>>        End
37806>>>>
37806>>>        //Else Send Operation_Not_Allowed 9999
37806>>>
37806>>>        Clear Arxeia
37807>>>
37807>>>        Move liArxeio to Arxeia.Arxeio_ID
37808>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
37809>>>>
37809>>>
37809>>>        If (Found=1) Begin
37811>>>            Move Arxeia.Arxeio_ID to liArxeio
37812>>>
37812>>>            Clear GrpArx
37813>>>            Move liUser     to GrpArx.User_ID
37814>>>            Move liArxeio   to GrpArx.Arxeio_ID
37815>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
37816>>>>
37816>>>            If (Found=1) Begin
37818>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
37821>>>               Else                         Set cpiCannot_Read   to 10003
37823>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
37826>>>               Else                         Set cpiCannot_Create to 10000
37828>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
37831>>>               Else                         Set cpiCannot_Edit   to 10001
37833>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
37836>>>               Else                         Set cpiCannot_Delete to 10002
37838>>>            End
37838>>>>
37838>>>            Else Begin
37839>>>                Clear GrpArx0
37840>>>                Move iGroup   to GrpArx0.Group_ID
37841>>>                Move liArxeio to GrpArx0.Arxeio_ID
37842>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
37843>>>>
37843>>>                If (Found=1) Begin
37845>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
37848>>>                    Else                            Set cpiCannot_Read   to 20003
37850>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
37853>>>                    Else                            Set cpiCannot_Create to 20000
37855>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
37858>>>                    Else                            Set cpiCannot_Edit   to 20001
37860>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
37863>>>                    Else                            Set cpiCannot_Delete to 20002
37865>>>                End
37865>>>>
37865>>>                Else Begin
37866>>>                    Set cpiCannot_Read   to 0
37867>>>                    Set cpiCannot_Edit   to 0
37868>>>                    Set cpiCannot_Create to 0
37869>>>                    Set cpiCannot_Delete to 0
37870>>>                End
37870>>>>
37870>>>            End
37870>>>>
37870>>>        End
37870>>>>
37870>>>        Else Begin
37871>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
37871>>>            Set cpiCannot_Read   to 0
37872>>>            Set cpiCannot_Edit   to 0
37873>>>            Set cpiCannot_Create to 0
37874>>>            Set cpiCannot_Delete to 0
37875>>>        End
37875>>>>
37875>>>    End_Procedure
37876>>>
37876>>>    Procedure Clear_main_file
37877>>>        Forward Send Clear_main_file
37879>>>        Set cpiBackout to 0
37880>>>        Set cpiUpdate  to 0
37881>>>    End_Procedure
37882>>>
37882>>>    Procedure Update
37883>>>        Forward Send Update
37885>>>        Set cpiUpdate to 1
37886>>>    End_Procedure
37887>>>
37887>>>    Procedure Backout
37888>>>        Forward Send Backout
37890>>>        Set cpiBackout to 1
37891>>>    End_Procedure
37892>>>
37892>>>    Procedure OnConstrain
37893>>>        Integer rVal liSrv
37894>>>        Forward Send OnConstrain
37896>>>        Get cpiFileNumber  To liSrv
37897>>>        Move liSrv         To Filenumber
37898>>>        Get cpiCannot_Read to rVal
37899>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
37903>>>    End_Procedure
37904>>>
37904>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37905>>>        String sLektiko
37906>>>        Move '' to sLektiko
37907>>>
37907>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37910>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
37914>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37918>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37922>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37926>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
37930>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37934>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37938>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
37942>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
37946>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
37950>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
37954>>>
37954>>>             If iError_Num eq 10000 Error 10000 sLektiko
37957>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
37961>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
37965>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
37969>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
37973>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
37977>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
37981>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
37985>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
37989>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
37993>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
37997>>>
37997>>>        Else Forward Send Operation_Not_Allowed  iError_Num
38000>>>    End_Procedure   // Operation_Not_Allowed
38001>>>
38001>>>
38001>>>End_Class //Datadictionary_Sec
38002>        use dbviews.sub
INCLUDING FILE: DBVIEWS.SUB
38002>>>
38002>>>Class DbviewSubs Is A DbviewSub
38003>>>
38003>>>    Procedure Construct_Object
38004>>>        Integer iPos iCount
38005>>>        Forward Send Construct_Object
38007>>>
38007>>>        Property String     psMyViewName    Public ''
38008>>>        Property Integer    piMyViewID      Public  0
38009>>>
38009>>>        Get Name            to gsViewName
38010>>>        Get Object_ID       to giViewID
38011>>>
38011>>>        Move 0 to iPos
38012>>>        For iCount From 1 to (Length(gsViewName))
38018>>>>
38018>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
38021>>>        Loop
38022>>>>
38022>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
38023>>>        Move (Trim(gsViewName)) to gsViewName
38024>>>
38024>>>        Set psMyViewName    to (Trim(gsViewName))
38025>>>        Set piMyViewID      to giViewID
38026>>>
38026>>>    End_Procedure
38027>>>
38027>>>    Procedure End_Construct_Object
38028>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
38029>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
38029>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
38029>>>
38029>>>        Forward Send End_Construct_Object
38031>>>
38031>>>
38031>>>        Get psMyViewName        to gsViewName
38032>>>        Get piMyViewID          to giViewID
38033>>>        Get Label Of giViewID   to sViewLabel
38034>>>        Move (Trim(sViewLabel)) to sViewLabel
38035>>>
38035>>>        Clear Oth
38036>>>        Move gsViewName to Oth.View_Name
38037>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
38038>>>>
38038>>>        If (Not(Found)) Begin
38040>>>            Move sViewLabel to Oth.View_Label
38041>>>            Move giViewID    to Oth.View_ID
38042>>>            Saverecord Oth
38043>>>        End
38043>>>>
38043>>>
38043>>>    End_Procedure //End_Construct_Object
38044>>>
38044>>>End_Class //dbviewSubs
38045>>>
38045>>>
38045>        use dbforms.sub
INCLUDING FILE: DBFORMS.SUB
38045>>>
38045>>>Class dbFormSubs Is a dbFormSub
38046>>>
38046>>>//    Register_Procedure Set psMyViewName
38046>>>//    Register_Function      psMyViewName Returns String
38046>>>//    Register_Procedure Set piMyViewID
38046>>>//    Register_Function      piMyViewID   Returns Integer
38046>>>
38046>>>    Procedure End_Construct_Object
38047>>>        Integer iFileNumber iFieldNumber iServer
38048>>>        Integer iPos icount iColor iFieldStatus iFileNumber2
38048>>>        String  sStr sDbFormName sViewLabel
38048>>>
38048>>>        Forward Send End_Construct_Object
38050>>>
38050>>>        //If (SysRec.Scr_Fld_Lock='1') Begin
38050>>>
38050>>>            Get Name            to sDbFormName
38051>>>            Get psMyViewName    to gsViewName
38052>>>            Get piMyViewID      to giViewID
38053>>>
38053>>>            Move 0 to iPos
38054>>>            For iCount From 1 to (Length(sDbFormName))
38060>>>>
38060>>>                If (Mid(sDbFormName,1,iCount)='.') Move iCount to iPos
38063>>>            Loop
38064>>>>
38064>>>            Move (Right(sDbFormName,(Length(sDbFormName)-iPos))) to sDbFormName
38065>>>            Move (Trim(sDbFormName)) to sDbFormName
38066>>>
38066>>>            Move (Trim(gsViewName)) to gsViewName
38067>>>
38067>>>            Clear Oth
38068>>>            Move gsViewName to Oth.View_Name
38069>>>            Find eq Oth By Index.2 // Oth:Index.2:View_Name
38070>>>>
38070>>>            Move Oth.View_Label to sViewLabel
38071>>>            Move (Trim(sViewLabel)) to sViewLabel
38072>>>
38072>>>            Clear ViewFlds
38073>>>            Move gsViewName     to ViewFlds.View_Name
38074>>>            Move sDbFormName    to ViewFlds.Scr_Field_Name
38075>>>            Find eq ViewFlds By Index.1 // ViewFlds:Index.1:View_Name+Scr_Field_Name
38076>>>>
38076>>>            If (Not(Found)) Begin
38078>>>                Reread Sysrec
INCLUDING FILE: SYSREC.FD
38082>>>                Move (SysRec.Viewflds_Rec0+1) to ViewFlds.ViewFlds_Rec0
38083>>>                Move (SysRec.Viewflds_Rec0+1) to SysRec.ViewFlds_Rec0
38084>>>                Saverecord SysRec
38085>>>                UnLock
38086>>>>
38086>>>                Move sViewLabel to ViewFlds.View_Label
38087>>>                Saverecord ViewFlds
38088>>>            End
38088>>>>
38088>>>            Else If ((Trim(ViewFlds.View_Label)='') And (sViewLabel<>'')) Begin
38091>>>                Reread ViewFlds
38095>>>                Move sViewLabel to ViewFlds.View_Label
38096>>>                Saverecord ViewFlds
38097>>>                Unlock
38098>>>>
38098>>>            End
38098>>>>
38098>>>            Move (fiScreenFieldStatus(gsViewName,sDbFormName))  to iFieldStatus
38099>>>
38099>>>
38099>>>        // iFieldStatus=0 ==> EVERYTHING IS ALLOWED
38099>>>        // iFieldStatus=1 ==> NO READ ALLOWED
38099>>>        // iFieldStatus=2 ==> NO EDIT BUT CAN COPY
38099>>>        // iFieldStatus=3 ==> NO EDIT AND NO COPY
38099>>>        If (Not(iFieldStatus)) Begin
38101>>>            ////// Field is NORMAL ////////
38101>>>        End
38101>>>>
38101>>>        Else Begin
38102>>>            If (iFieldStatus=1) Begin
38104>>>                ////// Field is NO DISPLAY ////////
38104>>>                Set Enabled_State   Item 0 to False
38105>>>                Set Entry_State     Item 0 to False
38106>>>                Get Color                  to iColor
38107>>>                Set TextColor              to iColor
38108>>>            End
38108>>>>
38108>>>            Else Begin
38109>>>                If (iFieldStatus=2) Begin
38111>>>                    ////// Field is NO EDIT  /////////
38111>>>                    Get Server                                      to iServer
38112>>>                    Get Data_File   Item 0                          to iFileNumber
38113>>>                    If (iServer) Get piFN of iServer                to iFileNumber2
38116>>>
38116>>>                    // €¤ ¦ server œå¤˜  › ˜­¦¨œ« ¡æª ˜§¦ «¦¤ ˜¨ Ÿ£¦ «¦¬ datafile «¦¬ §œ› ¦¬
38116>>>                    // «¦«œ «¦ §œ›å¦ œå¤˜  £§˜£§áª ¡˜  «¦ Noput ›œ¤ §˜ œ  ¦§¦«œ ¡æ™¦¬£œ «¦ Enter
38116>>>                    If (iFileNumber=iFileNumber2)   Set Item_Option Item 0  to Noput True
38119>>>                    Else                            Set Item_Option Item 0  to NoEnter True
38121>>>                End
38121>>>>
38121>>>                Else Begin
38122>>>                    If (iFieldStatus=3) Begin
38124>>>                        ////// Field is NO EDIT AND NO COPY     /////////
38124>>>                        Set Enabled_State   Item 0 to False
38125>>>                        Set Entry_State     Item 0 to False
38126>>>                        Set Shadow_State    Item 0 to True
38127>>>                    End
38127>>>>
38127>>>                End
38127>>>>
38127>>>            End
38127>>>>
38127>>>        End
38127>>>>
38127>>>     End_Procedure
38128>>>
38128>>>End_Class //DbformSubs
38129>>>
38129>        
38129>        Use Stbarpsc.pkg
INCLUDING FILE: STBARPSC.PKG
38129>>>Use DFStatBr.pkg
38129>>>
38129>>>Class BasicPanelStatusBarSub is a BasicStatusBar
38130>>>
38130>>>    Procedure Construct_Object
38131>>>        Forward Send Construct_Object
38133>>>        Property Integer Status_Help_Item Public 0
38134>>>        Property Integer Menu_Simple_State public TRUE
38135>>>        Property Integer Menu_status_State public False
38136>>>        Property Integer Old_Simple_State  public false
38137>>>        Property String  Old_Status_Value  public ''
38138>>>        Set Attach_Parent_State To TRUE
38139>>>        Delegate Set StatusBar_id To Self
38141>>>    End_Procedure
38142>>>
38142>>>    Procedure SET Status_Help_Value String sHelp
38143>>>        Local Integer iPart
38144>>>        Get Status_Help_Item To iPart
38145>>>        Set Value item iPart To sHelp
38146>>>    End_Procedure
38147>>>
38147>>>    Function Status_Help_Value Returns String
38148>>>        Local Integer iPart
38149>>>        Local String sHelp
38149>>>        Get Status_Help_Item To iPart
38150>>>        Get Value item iPart To sHelp
38151>>>        Function_Return sHelp
38152>>>    End_Procedure
38153>>>
38153>>>    Procedure Initialize_Menu
38154>>>       Local integer iState OldState
38155>>>       If Not (Menu_Status_state(Self)) Begin
38157>>>          Get Simple_State to OldState
38158>>>          Set Old_Simple_State to OldState
38159>>>          If OldState   Set Old_Status_Value to (Simple_Value(Self))
38162>>>          Else          Set Old_Status_Value to (Status_Help_Value(Self))
38164>>>          Set Simple_State to (Menu_Simple_State(Self))
38165>>>          Set Menu_Status_State to TRUE
38166>>>       End
38166>>>>
38166>>>    End_Procedure
38167>>>
38167>>>    Procedure Exit_Menu
38168>>>       Local Integer OldState
38169>>>       Local String OldVal
38169>>>       If (Menu_Status_state(Self)) Begin
38171>>>          Get Old_Simple_State to OldState
38172>>>          Set Simple_State     to OldState
38173>>>          Get old_status_Value to oldVal
38174>>>          If OldState ;             Set Simple_Value to OldVal
38177>>>          Else ;             Set Status_Help_Value to OldVal
38179>>>          Set Menu_Status_State to FALSE
38180>>>       End
38180>>>>
38180>>>    End_Procedure // Exit_Menu
38181>>>
38181>>>    Procedure Show_Status_Help String sHelp
38182>>>        Local Integer iState
38183>>>        Get Simple_State to iState
38184>>>        If NOT iState Set Status_Help_Value To sHelp
38187>>>        Else          Set Simple_Value      To sHelp
38189>>>    End_Procedure
38190>>>
38190>>>    Function Current_Status_Help Returns String
38191>>>        Local Integer iState
38192>>>        Local String sHelp
38192>>>        Get Simple_State to iState
38193>>>        If NOT iState Get Status_Help_Value To sHelp
38196>>>        Else          Get Simple_Value      To sHelp
38198>>>        Function_Return sHelp
38199>>>    End_Function
38200>>>
38200>>>
38200>>>End_Class
38201>        
38201>        Open Nomisma
38203>        Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
38205>        
38205>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
38206>        
38206>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
38207>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
38207>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
38207>            String  sCode
38207>        
38207>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
38210>        
38210>            Clear Nomisma
38211>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
38212>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38213>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
38214>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
38215>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
38216>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
38217>            Move Nomisma.Dekadika       to iDekadika_Apo
38218>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
38218>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
38220>                If (adHmnia='') Sysdate            adHmnia
38223>                Move (Trim(asNomismaCodeApo))   to sCode
38224>                Clear Isotimia
38225>                Move sCode                      to Isotimia.Nomisma_Code
38226>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38227>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38228>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
38229>            End
38229>        
38229>            Clear Nomisma
38230>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
38231>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38232>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
38233>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
38234>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
38235>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
38236>            Move Nomisma.Dekadika       to iDekadika_Se
38237>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
38237>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
38239>                If (adHmnia='') Sysdate            adHmnia
38242>                Move (Trim(asNomismaCodeSe))    to sCode
38243>                Clear Isotimia
38244>                Move sCode                      to Isotimia.Nomisma_Code
38245>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38246>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38247>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
38248>            End
38248>        
38248>            Calc (anPoso/nApo_Euro_Isot) to rVal
38249>            Move (Round_Number(rVal,6)) to rVal
38250>            Calc (rVal*nSe_Euro_Isot) to rVal
38251>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
38252>        
38252>            Function_Return rVal
38253>        End_Function
38254>        
38254>        Register_Object oStatusBarSub
38254>        
38254>        Open Syscurxr
38256>        Open SysFile
38258>        Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38260>        Open Sysrecb
INCLUDING FILE: SYSRECB.FD
38262>        Open Sysrecw
INCLUDING FILE: SYSRECW.FD
38264>        
38264>        Procedure Reset_All_Files_Except_System
38266>            Local Integer File# Open# File_Number# liInt iMax iWait isSystem
38267>            Local String Physicalname# DisplayName# Logicalname# Rootname#
38267>            Move 0 To File#
38268>            Repeat
38268>              Get_Attribute Df_File_Next_Opened Of File# To File#
38271>              If (File#) Begin
38273>                Get_Attribute DF_FILE_IS_SYSTEM_FILE    Of File# To isSystem
38276>                If (NOT(isSystem)) Clear File#
38279>              End
38279>            Until File# Eq 0
38281>        End_Procedure
38282>        use v037.vw
INCLUDING FILE: V037.VW
38282>>>//AB/ Project V037:BAXIO
38282>>>//AB/ Object prj is a View_Project
38282>>>//AB/     Set ProjectName to "V037:BAXIO"
38282>>>//AB/     Set ProjectFileName to "V037.VW"
38282>>>
38282>>>// Project Object Structure
38282>>>//   VW037 is a dbViewSub
38282>>>//     Btypkin_DD is a DataDictionary
38282>>>//     Baxiokat_DD is a DataDictionary
38282>>>//     Barticl_DD is a DataDictionary
38282>>>//     Baxio_DD is a DataDictionary
38282>>>//     Syscurxr_DD is a DataDictionary
38282>>>//     Bmove_DD is a DataDictionary
38282>>>//     Baxiokat_Baxiokat_Code is a dbFormSub
38282>>>//     Baxiokat_Baxiokat_Descr is a dbFormSub
38282>>>//     Baxio_Baxio_Code is a dbFormSub
38282>>>//     Baxio_Baxio_Status is a dbFormSub
38282>>>//     Baxio_Baxio_Place is a dbFormSub
38282>>>//     dbTbDlgAxio is a dbTabDialogSub
38282>>>//       TP_Additional is a dbTabPage
38282>>>//         dbGrpObligate is a dbGroupSub
38282>>>//           Baxio_Baxio_Hmnial is a dbFormSub
38282>>>//           Baxio_Baxio_V4 is a dbFormSub
38282>>>//           Rate0 is a dbFormSub
38282>>>//           Rate00 is a dbFormSub
38282>>>//           RateR is a dbFormSub
38282>>>//           TextBoxSub3 is a TextBoxSub
38282>>>//           TextBoxSub4 is a TextBoxSub
38282>>>//           TextBoxSub5 is a TextBoxSub
38282>>>//           txtnom1 is a TextBoxSub
38282>>>//           txtnom2 is a TextBoxSub
38282>>>//           txtnom3 is a TextBoxSub
38282>>>//           Baxio_Baxio_C_Code2 is a dbFormSub
38282>>>//         dbGrpOptional is a dbGroupSub
38282>>>//           Baxio_Baxio_Ekdoths is a dbFormSub
38282>>>//           Baxio_Baxio_Ekdothse is a dbFormSub
38282>>>//           Baxio_Baxio_Sediatagh is a dbFormSub
38282>>>//           Baxio_Baxio_Sdiataghe is a dbFormSub
38282>>>//           Baxio_Baxio_Banka is a dbComboFormSub
38282>>>//           Baxio_Baxio_No is a dbFormSub
38282>>>//           Baxio_Baxio_From is a dbComboFormSub
38282>>>//           Baxio_Baxio_Topos is a dbComboFormSub
38282>>>//           Baxio_Baxio_Opistho is a dbEditSub
38282>>>//           TextBoxSub6 is a TextBoxSub
38282>>>//           TextBoxSub7 is a TextBoxSub
38282>>>//           TextBoxSub8 is a TextBoxSub
38282>>>//           TextBoxSub9 is a TextBoxSub
38282>>>//           TextBoxSub10 is a TextBoxSub
38282>>>//           TextBoxSub11 is a TextBoxSub
38282>>>//           TextBoxSub12 is a TextBoxSub
38282>>>//           Textbox3 is a Textbox
38282>>>//           Textbox4 is a Textbox
38282>>>//       TP_Status is a dbTabPage
38282>>>//         dbGrpEispraktea is a dbGroupSub
38282>>>//           Baxio_Baxio_Fbarticl is a dbFormSub
38282>>>//           Baxio_Baxio_Code_In is a dbFormSub
38282>>>//           Baxio_Baxio_Epon_In is a dbFormSub
38282>>>//           dbFrmHmnia is a dbFormSub
38282>>>//           dbFrmNo is a dbFormSub
38282>>>//           dbFrmGtypkin is a dbFormSub
38282>>>//           TextBoxSub18 is a TextBoxSub
38282>>>//           TextBoxSub19 is a TextBoxSub
38282>>>//           TextBoxSub24 is a TextBoxSub
38282>>>//           TextBoxSub27 is a TextBoxSub
38282>>>//           TextBoxSub30 is a TextBoxSub
38282>>>//         dbGrpPlhrotea is a dbGroupSub
38282>>>//           Baxio_Baxio_Lbarticl is a dbFormSub
38282>>>//           Baxio_Baxio_Code_Out is a dbFormSub
38282>>>//           Baxio_Baxio_Epon_Out is a dbFormSub
38282>>>//           dbFrmHmnia is a dbFormSub
38282>>>//           dbFrmNo is a dbFormSub
38282>>>//           dbFrmGtypkin is a dbFormSub
38282>>>//           TextBoxSub20 is a TextBoxSub
38282>>>//           TextBoxSub21 is a TextBoxSub
38282>>>//           TextBoxSub25 is a TextBoxSub
38282>>>//           TextBoxSub28 is a TextBoxSub
38282>>>//           TextBoxSub31 is a TextBoxSub
38282>>>//         dbGrpCurrentStat is a dbGroupSub
38282>>>//           Baxio_Baxio_Lcode is a dbFormSub
38282>>>//           Baxio_Baxio_Lepon is a dbFormSub
38282>>>//           Baxio_Baxio_Lpar is a dbFormSub
38282>>>//           dbFrmHmnia is a dbFormSub
38282>>>//           dbFrmNo is a dbFormSub
38282>>>//           dbFrmGtypkin is a dbFormSub
38282>>>//           TextBoxSub22 is a TextBoxSub
38282>>>//           TextBoxSub23 is a TextBoxSub
38282>>>//           TextBoxSub26 is a TextBoxSub
38282>>>//           TextBoxSub29 is a TextBoxSub
38282>>>//           TextBoxSub32 is a TextBoxSub
38282>>>//       TP_Bmove is a dbTabPage
38282>>>//         grdBmove is a dbGridSub
38282>>>//     dbGrpYear is a dbGroupSub
38282>>>//       Company_Company_Name is a dbFormSub
38282>>>//       Branch_Branch_Name is a dbFormSub
38282>>>//       Year_Year_Year is a dbFormSub
38282>>>//       otxtCompany is a TextBoxSub
38282>>>//       otxtBranch is a TextBoxSub
38282>>>//       otxtYear is a TextBoxSub
38282>>>//     TextBoxSub1 is a TextBoxSub
38282>>>//     TextBoxSub2 is a TextBoxSub
38282>>>//     TextBoxSub13 is a TextBoxSub
38282>>>//     TextBoxSub14 is a TextBoxSub
38282>>>
38282>>>// Register all objects
38282>>>Register_Object Barticl_DD
38282>>>Register_Object Baxio_Baxio_Banka
38282>>>Register_Object Baxio_Baxio_C_Code2
38282>>>Register_Object Baxio_Baxio_Code
38282>>>Register_Object Baxio_Baxio_Code_In
38282>>>Register_Object Baxio_Baxio_Code_Out
38282>>>Register_Object Baxio_Baxio_Ekdoths
38282>>>Register_Object Baxio_Baxio_Ekdothse
38282>>>Register_Object Baxio_Baxio_Epon_In
38282>>>Register_Object Baxio_Baxio_Epon_Out
38282>>>Register_Object Baxio_Baxio_Fbarticl
38282>>>Register_Object Baxio_Baxio_From
38282>>>Register_Object Baxio_Baxio_Hmnial
38282>>>Register_Object Baxio_Baxio_Lbarticl
38282>>>Register_Object Baxio_Baxio_Lcode
38282>>>Register_Object Baxio_Baxio_Lepon
38282>>>Register_Object Baxio_Baxio_Lpar
38282>>>Register_Object Baxio_Baxio_No
38282>>>Register_Object Baxio_Baxio_Opistho
38282>>>Register_Object Baxio_Baxio_Place
38282>>>Register_Object Baxio_Baxio_Sdiataghe
38282>>>Register_Object Baxio_Baxio_Sediatagh
38282>>>Register_Object Baxio_Baxio_Status
38282>>>Register_Object Baxio_Baxio_Topos
38282>>>Register_Object Baxio_Baxio_V4
38282>>>Register_Object Baxio_DD
38282>>>Register_Object Baxiokat_Baxiokat_Code
38282>>>Register_Object Baxiokat_Baxiokat_Descr
38282>>>Register_Object Baxiokat_DD
38282>>>Register_Object Bmove_DD
38282>>>Register_Object Branch_Branch_Name
38282>>>Register_Object Btypkin_DD
38282>>>Register_Object Company_Company_Name
38282>>>Register_Object dbFrmGtypkin
38282>>>Register_Object dbFrmHmnia
38282>>>Register_Object dbFrmNo
38282>>>Register_Object dbGrpCurrentStat
38282>>>Register_Object dbGrpEispraktea
38282>>>Register_Object dbGrpObligate
38282>>>Register_Object dbGrpOptional
38282>>>Register_Object dbGrpPlhrotea
38282>>>Register_Object dbGrpYear
38282>>>Register_Object dbTbDlgAxio
38282>>>Register_Object grdBmove
38282>>>Register_Object otxtBranch
38282>>>Register_Object otxtCompany
38282>>>Register_Object otxtYear
38282>>>Register_Object Rate0
38282>>>Register_Object Rate00
38282>>>Register_Object RateR
38282>>>Register_Object Syscurxr_DD
38282>>>Register_Object TextBoxSub1
38282>>>Register_Object TextBoxSub10
38282>>>Register_Object TextBoxSub11
38282>>>Register_Object TextBoxSub12
38282>>>Register_Object TextBoxSub13
38282>>>Register_Object TextBoxSub14
38282>>>Register_Object TextBoxSub18
38282>>>Register_Object TextBoxSub19
38282>>>Register_Object TextBoxSub2
38282>>>Register_Object TextBoxSub20
38282>>>Register_Object TextBoxSub21
38282>>>Register_Object TextBoxSub22
38282>>>Register_Object TextBoxSub23
38282>>>Register_Object TextBoxSub24
38282>>>Register_Object TextBoxSub25
38282>>>Register_Object TextBoxSub26
38282>>>Register_Object TextBoxSub27
38282>>>Register_Object TextBoxSub28
38282>>>Register_Object TextBoxSub29
38282>>>Register_Object TextBoxSub3
38282>>>Register_Object TextBoxSub30
38282>>>Register_Object TextBoxSub31
38282>>>Register_Object TextBoxSub32
38282>>>Register_Object TextBoxSub4
38282>>>Register_Object TextBoxSub5
38282>>>Register_Object TextBoxSub6
38282>>>Register_Object TextBoxSub7
38282>>>Register_Object TextBoxSub8
38282>>>Register_Object TextBoxSub9
38282>>>Register_Object Textbox3
38282>>>Register_Object Textbox4
38282>>>Register_Object TP_Additional
38282>>>Register_Object TP_Bmove
38282>>>Register_Object TP_Status
38282>>>Register_Object txtnom1
38282>>>Register_Object txtnom2
38282>>>Register_Object txtnom3
38282>>>Register_Object VW037
38282>>>Register_Object Year_Year_Year
38282>>>
38282>>>
38282>>>//AB/ AppBuild VIEW
38282>>>
38282>>>//AB-IgnoreStart
38282>>>
38282>>>Use dbView.Sub
38282>>>Use DFAllEnt.pkg
38282>>>Use dbForm.Sub
38282>>>Use dbTabdlg.Sub
38282>>>Use dbGroup.Sub
38282>>>Use Txtbox.Sub
38282>>>Use dbCmbfrm.Sub
38282>>>Use dbEdit.Sub
38282>>>Use dbGrid.Sub
38282>>>
38282>>>Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
38282>>>>>//DDB-FileStart
38282>>>>>//DDB-HeaderStart
38282>>>>>
38282>>>>>// File Name : BTYPKIN.DD
38282>>>>>// Class Name: Btypkin_DataDictionary
38282>>>>>// Revision  : 114
38282>>>>>// Version   : 2
38282>>>>>
38282>>>>>Use  Windows           // Basic Definitions
38282>>>>>Use  DataDict          // DataDictionary Class Definition
38282>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38282>>>>>
38282>>>>>Open Btypkin
38284>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
38286>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
38288>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
38290>>>>>Open Sysrecb
38292>>>>>
38292>>>>>//DDB-HeaderEnd
38292>>>>>//DDB-ValidationStart
38292>>>>>
38292>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
38292>>>>>
38292>>>>>Register_Object Bfile_VT
38292>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
38292>>>>>Use Baxio.pkg        // Bfile_VT
INCLUDING FILE: BAXIO.PKG
38292>>>>>>>// **************************************************************************
38292>>>>>>>// *Code Style   : Object                                                   *
38292>>>>>>>// *Name         : Baxio.vts                                                *
38292>>>>>>>// *Revision     : 1                                                        *
38292>>>>>>>// *Main File    :                                                          *
38292>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
38292>>>>>>>// *Creation Date: 01/09/99                                                 *
38292>>>>>>>// *Last Update  :                                                          *
38292>>>>>>>// *Author       : JA                                                       *
38292>>>>>>>// *Includes     :                                                          *
38292>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
38292>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
38292>>>>>>>// *             :                                                          *
38292>>>>>>>// *             :                                                          *
38292>>>>>>>// *Returns      :                                                          *
38292>>>>>>>// *             :                                                          *
38292>>>>>>>// *‰nown bugs   :                                                          *
38292>>>>>>>// *             :                                                          *
38292>>>>>>>// *Improvements :                                                          *
38292>>>>>>>// *             :                                                          *
38292>>>>>>>// *             :                                                          *
38292>>>>>>>// **************************************************************************
38292>>>>>>>// *                        A N A L Y S I S                                 *
38292>>>>>>>// **************************************************************************
38292>>>>>>>// *                                                                        *
38292>>>>>>>// **************************************************************************
38292>>>>>>>
38292>>>>>>>
38292>>>>>>>//Set Allow_Blank_State To TRUE
38292>>>>>>>
38292>>>>>>>//used by: 1. baxiokat.baxiokat_type
38292>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
38294>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
38295>>>>>>>       Procedure Fill_List
38297>>>>>>>                 Forward Send Fill_List
38299>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
38300>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
38301>>>>>>>       End_Procedure //fill_list
38302>>>>>>>End_Object   //Baxiokat_Type_VT
38303>>>>>>>
38303>>>>>>>
38303>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
38303>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
38303>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
38303>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
38303>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
38303>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
38305>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
38306>>>>>>>       Procedure Fill_List
38308>>>>>>>                 Forward Send Fill_List
38310>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
38311>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
38312>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
38313>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
38314>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
38315>>>>>>>
38315>>>>>>>       End_Procedure // fill_list
38316>>>>>>>End_Object   //Baxio_Status_VT1
38317>>>>>>>
38317>>>>>>>
38317>>>>>>>
38317>>>>>>>//used by: 1. btypkin.btypkin_anti1
38317>>>>>>>//         2. btypkin.btypkin_anti2
38317>>>>>>>//         3. baxio.baxio_file_in
38317>>>>>>>//         4. baxio.baxio_file_out
38317>>>>>>>//         5. baxio.baxio_lfile
38317>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
38319>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
38320>>>>>>>       Procedure Fill_List
38322>>>>>>>                 Forward Send Fill_List
38324>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
38325>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
38326>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
38327>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
38328>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
38329>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
38330>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
38331>>>>>>>       End_Procedure // fill_list
38332>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
38333>>>>>>>
38333>>>>>
38333>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
38335>>>>>
38335>>>>>    Procedure Fill_List
38337>>>>>        Forward Send Fill_List
38339>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
38340>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
38341>>>>>    End_Procedure    // Fill_List
38342>>>>>    //DDB-ValidationCustomStart
38342>>>>>    //DDB-ValidationCustomEnd
38342>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
38343>>>>>//DDB-ValidationEnd
38343>>>>>//DDB-SelectionStart
38343>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
38343>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
38343>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
38343>>>>>Register_Object SL031
38343>>>>>Register_Object sl007
38343>>>>>Register_Object sl007r
38343>>>>>//DDB-SelectionEnd
38343>>>>>
38343>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
38343>>>>>//Register_Object SL056 //¢å©«˜ vendor
38343>>>>>
38343>>>>>
38343>>>>>Open SysCurXr
38345>>>>>
38345>>>>>Open Barticl //©œ«á¨œ  prompt objects
38347>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38347>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38347>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38347>>>>>
38347>>>>>
38347>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
38347>>>>>//Use SL102.SL //¢å©«˜ customer
38347>>>>>//Use SL???.SL //¢å©«˜ vendor
38347>>>>>Use sl100.sl // Clients selection list
INCLUDING FILE: SL100.SL
38347>>>>>>>//AB/ Project SL100:PELATES
38347>>>>>>>//AB/     Object prj is a Lookup_Project
38347>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
38347>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
38347>>>>>>>
38347>>>>>>>// Project Object Structure
38347>>>>>>>//   sl100 is a dbModalPanelSub
38347>>>>>>>//     Clients_DD is a DataDictionary
38347>>>>>>>//     oSelList is a dbListSub
38347>>>>>>>//     oOK_bn is a ButtonSub
38347>>>>>>>//     oCancel_bn is a ButtonSub
38347>>>>>>>//     oSearch_bn is a ButtonSub
38347>>>>>>>
38347>>>>>>>// Register all objects
38347>>>>>>>Register_Object Clients_DD
38347>>>>>>>Register_Object oCancel_bn
38347>>>>>>>Register_Object oOK_bn
38347>>>>>>>Register_Object oSearch_bn
38347>>>>>>>Register_Object oSelList
38347>>>>>>>Register_Object sl100
38347>>>>>>>
38347>>>>>>>
38347>>>>>>>    //AB-IgnoreStart
38347>>>>>>>
38347>>>>>>>    Use DFAllEnt.pkg
38347>>>>>>>    Use dbList.Sub
38347>>>>>>>    Use Button.Sub
38347>>>>>>>
38347>>>>>>>
38347>>>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
38347>>>>>>>>>//DDB-FileStart
38347>>>>>>>>>//DDB-HeaderStart
38347>>>>>>>>>
38347>>>>>>>>>// File Name : CLIENTS.DD
38347>>>>>>>>>// Class Name: Clients_DataDictionary
38347>>>>>>>>>// Revision  : 241
38347>>>>>>>>>// Version   : 2
38347>>>>>>>>>
38347>>>>>>>>>Use  Windows           // Basic Definitions
38347>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38347>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38347>>>>>>>>>
38347>>>>>>>>>Open Clients
38349>>>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38351>>>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38353>>>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38355>>>>>>>>>Open Cn
38357>>>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38359>>>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38361>>>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38363>>>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38365>>>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38367>>>>>>>>>Open Cities
38369>>>>>>>>>Open Areas
38371>>>>>>>>>Open Payresp
38373>>>>>>>>>Open Syscurxr
38375>>>>>>>>>Open Sysrecc
38377>>>>>>>>>Open Ptypparl
38379>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
38381>>>>>>>>>Open Sysrecg
38383>>>>>>>>>
38383>>>>>>>>>//DDB-HeaderEnd
38383>>>>>>>>>//DDB-ValidationStart
38383>>>>>>>>>
38383>>>>>>>>>Register_Object Clients_Client_Doy_VT
38383>>>>>>>>>Register_Object Clients_Client_Job_VT
38383>>>>>>>>>Register_Object Clients_Client_Categfpa_VT
38383>>>>>>>>>Register_Object Clients_Client_Catjob_VT1
38383>>>>>>>>>Register_Object Clients_Client_Idiot_VT
38383>>>>>>>>>Register_Object Clients_Feregios_VT
38383>>>>>>>>>
38383>>>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38385>>>>>>>>>    Set Type_Value        To "DOY"
38386>>>>>>>>>    Set Validate_State    To FALSE
38387>>>>>>>>>    Set Allow_Blank_State To TRUE
38388>>>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
38389>>>>>>>>>    //DDB-ValidationCustomStart
38389>>>>>>>>>    //DDB-ValidationCustomEnd
38389>>>>>>>>>End_Object   // Clients_Client_Doy_VT
38390>>>>>>>>>
38390>>>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38392>>>>>>>>>    Set Type_Value        To "JOB"
38393>>>>>>>>>    Set Validate_State    To FALSE
38394>>>>>>>>>    Set Allow_Blank_State To TRUE
38395>>>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38396>>>>>>>>>    //DDB-ValidationCustomStart
38396>>>>>>>>>    //DDB-ValidationCustomEnd
38396>>>>>>>>>End_Object   // Clients_Client_Job_VT
38397>>>>>>>>>
38397>>>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38399>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38400>>>>>>>>>    Set Validate_State    To FALSE
38401>>>>>>>>>    Set Allow_Blank_State To TRUE
38402>>>>>>>>>    //DDB-ValidationCustomStart
38402>>>>>>>>>    //DDB-ValidationCustomEnd
38402>>>>>>>>>End_Object   // Clients_Client_Categfpa_VT
38403>>>>>>>>>
38403>>>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38405>>>>>>>>>    Set Type_Value        To "JOB"
38406>>>>>>>>>    Set Validate_State    To FALSE
38407>>>>>>>>>    Set Allow_Blank_State To TRUE
38408>>>>>>>>>    //DDB-ValidationCustomStart
38408>>>>>>>>>    //DDB-ValidationCustomEnd
38408>>>>>>>>>End_Object   // Clients_Client_Catjob_VT1
38409>>>>>>>>>
38409>>>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38411>>>>>>>>>    Set Type_Value        To "IDIOT"
38412>>>>>>>>>    Set Validate_State    To FALSE
38413>>>>>>>>>    Set Allow_Blank_State To TRUE
38414>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38415>>>>>>>>>    //DDB-ValidationCustomStart
38415>>>>>>>>>    //DDB-ValidationCustomEnd
38415>>>>>>>>>End_Object   // Clients_Client_Idiot_VT
38416>>>>>>>>>
38416>>>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38418>>>>>>>>>    Set Type_Value        To "FEREGIOS"
38419>>>>>>>>>    Set Allow_Blank_State To TRUE
38420>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38421>>>>>>>>>    //DDB-ValidationCustomStart
38421>>>>>>>>>    //DDB-ValidationCustomEnd
38421>>>>>>>>>End_Object   // Clients_Feregios_VT
38422>>>>>>>>>//DDB-ValidationEnd
38422>>>>>>>>>//DDB-SelectionStart
38422>>>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
38422>>>>>>>>>Register_Object sl100
38422>>>>>>>>>//DDB-SelectionEnd
38422>>>>>>>>>Open Sysfile
38424>>>>>>>>>open year
38426>>>>>>>>>
38426>>>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38427>>>>>>>>>
38427>>>>>>>>>    Procedure Construct_Object
38428>>>>>>>>>        Forward Send Construct_Object
38430>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
38431>>>>>>>>>        Property Integer piCheckPlaf        Public 0
38432>>>>>>>>>        //------------------------------------------------
38432>>>>>>>>>        // Properties gia na kraththoun oi palies times
38432>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
38432>>>>>>>>>        // einai 1     js 03/12/2007
38432>>>>>>>>>        //------------------------------------------------
38432>>>>>>>>>        Property Integer piCreateNew            Public  0
38433>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
38434>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
38435>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
38436>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
38437>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
38438>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
38439>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
38440>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
38441>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
38442>>>>>>>>>        //------------------------------------------------
38442>>>>>>>>>
38442>>>>>>>>>    End_Procedure
38443>>>>>>>>>
38443>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38444>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38446>>>>>>>>>        //------------------------------------------------
38446>>>>>>>>>        // Properties gia na kraththoun oi palies times
38446>>>>>>>>>        // ton pedion js 03/12/2007
38446>>>>>>>>>        //------------------------------------------------
38446>>>>>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
38447>>>>>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
38448>>>>>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
38449>>>>>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
38450>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
38451>>>>>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
38452>>>>>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
38453>>>>>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
38454>>>>>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
38455>>>>>>>>>        //------------------------------------------------
38455>>>>>>>>>     End_Procedure   // New_Current_Record
38456>>>>>>>>>
38456>>>>>>>>>
38456>>>>>>>>>    // Backout:
38456>>>>>>>>>    Procedure Backout
38457>>>>>>>>>        Forward Send Backout
38459>>>>>>>>>        // Insert Code Here
38459>>>>>>>>>    End_Procedure   // Backout
38460>>>>>>>>>
38460>>>>>>>>>    Procedure Delete_Main_File
38461>>>>>>>>>        //---------------------------------------------
38461>>>>>>>>>        // Auditing / Katagrafh allagon
38461>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38462>>>>>>>>>        Date    dDate  Shmer
38462>>>>>>>>>        Integer iMin iHour iSec iLen
38462>>>>>>>>>        Sysdate dDate iHour iMin iSec
38466>>>>>>>>>        Move iHour  to sHour
38467>>>>>>>>>        Move iMin   to sMin
38468>>>>>>>>>        Move iSec   to sSec
38469>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38473>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38477>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38481>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38482>>>>>>>>>
38482>>>>>>>>>        // Auditing / Diagrafh
38482>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38484>>>>>>>>>            Get fsLoginUserID to sUser
38485>>>>>>>>>            clear gmove
38486>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
38487>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
38488>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
38489>>>>>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
38490>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
38491>>>>>>>>>            move suser                  to gmove.gplan_code
38492>>>>>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
38493>>>>>>>>>            reread sysrecg
38497>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38498>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38499>>>>>>>>>            saverecord sysrecg
38500>>>>>>>>>            unlock
38501>>>>>>>>>>
38501>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38502>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38503>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
38504>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38505>>>>>>>>>
38505>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38506>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38507>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38508>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
38509>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38510>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38511>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38512>>>>>>>>>
38512>>>>>>>>>
38512>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
38513>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38514>>>>>>>>>            saverecord gmove
38515>>>>>>>>>        End
38515>>>>>>>>>>
38515>>>>>>>>>
38515>>>>>>>>>        Forward Send Delete_Main_File
38517>>>>>>>>>
38517>>>>>>>>>    End_Procedure
38518>>>>>>>>>
38518>>>>>>>>>
38518>>>>>>>>>    Procedure Update
38519>>>>>>>>>        Forward Send Update
38521>>>>>>>>>        // Insert Code Here
38521>>>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
38522>>>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
38523>>>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
38524>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38524>>>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
38525>>>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
38526>>>>>>>>>
38526>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
38526>>>>>>>>>
38526>>>>>>>>>        //betolink
38526>>>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
38527>>>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
38528>>>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
38529>>>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
38530>>>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
38531>>>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job             
38531>>>>>>>>>     
38531>>>>>>>>>     
38531>>>>>>>>>        //---------------------------------------------
38531>>>>>>>>>        // Auditing / Katagrafh allagon
38531>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38532>>>>>>>>>        Date    dDate  Shmer 
38532>>>>>>>>>        Integer iMin iHour iSec iLen
38532>>>>>>>>>        Sysdate dDate iHour iMin iSec 
38536>>>>>>>>>        Move iHour  to sHour
38537>>>>>>>>>        Move iMin   to sMin
38538>>>>>>>>>        Move iSec   to sSec
38539>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38543>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38547>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38551>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38552>>>>>>>>>        
38552>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
38552>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38554>>>>>>>>>            Get fsLoginUserID to sUser
38555>>>>>>>>>            If (piCreateNew(Self)=1) Begin
38557>>>>>>>>>                clear gmove
38558>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
38559>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
38560>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
38561>>>>>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
38562>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
38563>>>>>>>>>                move suser                  to gmove.gplan_code
38564>>>>>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
38565>>>>>>>>>                reread sysrecg
38569>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38570>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38571>>>>>>>>>                saverecord sysrecg
38572>>>>>>>>>                unlock
38573>>>>>>>>>>
38573>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38574>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38575>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38576>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38577>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
38578>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
38579>>>>>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr 
38580>>>>>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr  
38581>>>>>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
38582>>>>>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
38583>>>>>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
38584>>>>>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
38585>>>>>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
38586>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
38587>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
38588>>>>>>>>>                saverecord gmove
38589>>>>>>>>>                Set piCreateNew to 0
38590>>>>>>>>>            End
38590>>>>>>>>>>
38590>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38593>>>>>>>>>                Integer isChanged
38593>>>>>>>>>                Move 0 to isChanged
38594>>>>>>>>>                
38594>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
38597>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
38601>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
38605>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
38609>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
38613>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
38617>>>>>>>>>                
38617>>>>>>>>>                If (isChanged>0) Begin  
38619>>>>>>>>>                    clear gmove
38620>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
38621>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38622>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
38623>>>>>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
38624>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
38625>>>>>>>>>                    move suser                  to gmove.gplan_code
38626>>>>>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
38627>>>>>>>>>                    reread sysrecg
38631>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38632>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38633>>>>>>>>>                    saverecord sysrecg
38634>>>>>>>>>                    unlock
38635>>>>>>>>>>
38635>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38636>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38637>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38638>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38639>>>>>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr 
38640>>>>>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr  
38641>>>>>>>>>                    //--
38641>>>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
38642>>>>>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
38643>>>>>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
38644>>>>>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
38645>>>>>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
38646>>>>>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
38647>>>>>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
38648>>>>>>>>>                    //--
38648>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38649>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38650>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38651>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
38652>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38653>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38654>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38655>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
38656>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38657>>>>>>>>>                    saverecord gmove
38658>>>>>>>>>                    Set piCreateNew to 0
38659>>>>>>>>>                End
38659>>>>>>>>>>
38659>>>>>>>>>            End
38659>>>>>>>>>>
38659>>>>>>>>>        End
38659>>>>>>>>>>
38659>>>>>>>>>
38659>>>>>>>>>     
38659>>>>>>>>>    End_Procedure   // Update
38660>>>>>>>>>
38660>>>>>>>>>
38660>>>>>>>>>    Procedure Creating
38661>>>>>>>>>        date ddate iYes
38662>>>>>>>>>        Forward Send Creating
38664>>>>>>>>>        // Insert Code Here
38664>>>>>>>>>
38664>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
38665>>>>>>>>>        Move '1'                    to Clients.Client_Active
38666>>>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
38667>>>>>>>>>        sysdate4 ddate
38668>>>>>>>>>        move ddate                  to Clients.Client_Hmnia    
38669>>>>>>>>>        Set piCreateNew to 1
38670>>>>>>>>>    End_Procedure   // Creating
38671>>>>>>>>>
38671>>>>>>>>>    Function Validate_Save  Returns Integer
38672>>>>>>>>>        Integer iReturnVal iCheck iYes
38673>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38675>>>>>>>>>        If (Not(iReturnVal)) Begin
38677>>>>>>>>>
38677>>>>>>>>>            If (clients.is_eksoter <> '1') begin
38679>>>>>>>>>                If (Clients.Is_Xondr='1') Begin
38681>>>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
38683>>>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
38684>>>>>>>>>                        If (iCheck) Begin
38686>>>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
38689>>>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
38693>>>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
38697>>>>>>>>>                        End
38697>>>>>>>>>>
38697>>>>>>>>>                    End
38697>>>>>>>>>>
38697>>>>>>>>>                End
38697>>>>>>>>>>
38697>>>>>>>>>            End
38697>>>>>>>>>>
38697>>>>>>>>>
38697>>>>>>>>>            If (piCheckPlaf(Self)=1) Begin
38699>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
38701>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
38702>>>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
38705>>>>>>>>>                End
38705>>>>>>>>>>
38705>>>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
38708>>>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
38709>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38712>>>>>>>>>                End
38712>>>>>>>>>>
38712>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
38715>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
38716>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38719>>>>>>>>>                End
38719>>>>>>>>>>
38719>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
38722>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
38723>>>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
38726>>>>>>>>>                End
38726>>>>>>>>>>
38726>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
38728>>>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
38729>>>>>>>>>                End
38729>>>>>>>>>>
38729>>>>>>>>>            End
38729>>>>>>>>>>
38729>>>>>>>>>
38729>>>>>>>>>            If (iReturnVal) Begin
38731>>>>>>>>>                Send Operation_Not_Allowed iReturnVal
38732>>>>>>>>>            End
38732>>>>>>>>>>
38732>>>>>>>>>        End
38732>>>>>>>>>>
38732>>>>>>>>>        Function_Return iReturnVal
38733>>>>>>>>>    End_Function   // Validate_Save
38734>>>>>>>>>
38734>>>>>>>>>
38734>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38735>>>>>>>>>        String lsError_Message
38736>>>>>>>>>
38736>>>>>>>>>        Case Begin
38736>>>>>>>>>            Case (iError_Num = 4001)
38738>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38739>>>>>>>>>              Case Break
38740>>>>>>>>>            Case (iError_Num = 4002)
38743>>>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
38744>>>>>>>>>              Case Break
38745>>>>>>>>>            Case (iError_Num = 4003)
38748>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38749>>>>>>>>>              Case Break
38750>>>>>>>>>            Case (iError_Num = 4004)
38753>>>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
38754>>>>>>>>>              Case Break
38755>>>>>>>>>            Case (iError_Num = 4005)
38758>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
38759>>>>>>>>>              Case Break
38760>>>>>>>>>            Case (iError_Num = 4006)
38763>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
38764>>>>>>>>>              Case Break
38765>>>>>>>>>
38765>>>>>>>>>            Case Else
38765>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38767>>>>>>>>>        Case End
38767>>>>>>>>>
38767>>>>>>>>>        Error iError_Num lsError_Message
38768>>>>>>>>>>
38768>>>>>>>>>    End_Procedure // operation_not_allowed
38769>>>>>>>>>
38769>>>>>>>>>
38769>>>>>>>>>    // Define_Fields:
38769>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38769>>>>>>>>>
38769>>>>>>>>>    Procedure Define_Fields
38770>>>>>>>>>        Forward Send Define_Fields
38772>>>>>>>>>        //DDB-Generated-Code-Location
38772>>>>>>>>>        //DDB-DefineFieldStart
38772>>>>>>>>>
38772>>>>>>>>>        Set Main_File            To Clients.File_Number
38773>>>>>>>>>        Set Cascade_Delete_State To FALSE
38774>>>>>>>>>
38774>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38775>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38776>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38777>>>>>>>>>
38777>>>>>>>>>        // Child (Client) file structure................
38777>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38778>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38779>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38780>>>>>>>>>        Send Add_Client_File  Cn.File_Number
38781>>>>>>>>>        Send Add_Client_File  Particll.File_Number
38782>>>>>>>>>        Send Add_Client_File  Clnbank.File_Number
38783>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
38784>>>>>>>>>        Send Add_Client_File  Clorder.File_Number
38785>>>>>>>>>        Send Add_Client_File  Clitem.File_Number
38786>>>>>>>>>
38786>>>>>>>>>        // Parent (Server) file structure...............
38786>>>>>>>>>        Send Add_Server_File  Cities.File_Number
38787>>>>>>>>>        Send Add_Server_File  Areas.File_Number
38788>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
38789>>>>>>>>>
38789>>>>>>>>>        // External (System) file structure.............
38789>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38790>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38791>>>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
38792>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38793>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38794>>>>>>>>>
38794>>>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
38797>>>>>>>>>
38797>>>>>>>>>        // Field-based properties.......................
38797>>>>>>>>>
38797>>>>>>>>>        // Clients.Company_Code
38797>>>>>>>>>
38797>>>>>>>>>        // Clients.Branch_Code
38797>>>>>>>>>
38797>>>>>>>>>        // Clients.Year_Year
38797>>>>>>>>>
38797>>>>>>>>>        // Clients.Custprom_Code
38797>>>>>>>>>
38797>>>>>>>>>        // Clients.Client_Id
38797>>>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
38798>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
38799>>>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
38800>>>>>>>>>
38800>>>>>>>>>        // Clients.Client_Name
38800>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
38801>>>>>>>>>
38801>>>>>>>>>        // Clients.Client_Afm
38801>>>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
38802>>>>>>>>>
38802>>>>>>>>>        // Clients.Client_Rec0
38802>>>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
38803>>>>>>>>>
38803>>>>>>>>>        // Clients.Custprom_Recr
38803>>>>>>>>>
38803>>>>>>>>>        // Clients.Client_Recr
38803>>>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
38804>>>>>>>>>
38804>>>>>>>>>        // Clients.Last_Xreosh
38804>>>>>>>>>
38804>>>>>>>>>        // Clients.Last_Pistosh
38804>>>>>>>>>
38804>>>>>>>>>        // Clients.Last_Order
38804>>>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
38805>>>>>>>>>
38805>>>>>>>>>        // Clients.Client_Doy
38805>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
38806>>>>>>>>>
38806>>>>>>>>>        // Clients.Client_Address
38806>>>>>>>>>
38806>>>>>>>>>        // Clients.Client_City_Id
38806>>>>>>>>>
38806>>>>>>>>>        // Clients.Client_Area
38806>>>>>>>>>
38806>>>>>>>>>        // Clients.Client_Job
38806>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Respons
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Zipcode
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Phone
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Fax
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Mobile
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Aoh
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Email
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Class
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Details
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Sitew
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Codem
38807>>>>>>>>>
38807>>>>>>>>>        // Clients.Client_Categfpa
38807>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Fpa
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Public
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Sn
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Repm
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Active
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Reported
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Pelprom
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Lastupd
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Markexp
38808>>>>>>>>>
38808>>>>>>>>>        // Clients.Client_Catjob
38808>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Is_Promhtheyths
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Xreosh
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Pistosh
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Ypoloipo
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Plafon
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Overhead
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Client_Company
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Client_Repmatch
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Client_Hmnia
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Client_Presp
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Client_Locked
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Synolikh_Ofeilh
38809>>>>>>>>>
38809>>>>>>>>>        // Clients.Client_Idiot
38809>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Add_No
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Nomos
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Xora
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Polh_Recr
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Presp_Id
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Sum_Pct_Tpcl
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Is_Client
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Sysxetish
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Poso_Se_Apait
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Glcode
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Is_Eksoter
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Is_Xondr
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Orio_Syn_Ofeilh
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Posa_Apo_Dap
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Doybtm
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Posa_Apo_Parag
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Ptyppar
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Client_Seira
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Hpso
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Hpal
38810>>>>>>>>>
38810>>>>>>>>>        // Clients.Feregios
38810>>>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
38811>>>>>>>>>
38811>>>>>>>>>        // Clients.Diakin
38811>>>>>>>>>
38811>>>>>>>>>        // Clients.Status
38811>>>>>>>>>
38811>>>>>>>>>        // Clients.Anal
38811>>>>>>>>>
38811>>>>>>>>>        // Clients.Endoomil
38811>>>>>>>>>
38811>>>>>>>>>        // Clients.Npdd
38811>>>>>>>>>
38811>>>>>>>>>        // Clients.Sap_Hmnia
38811>>>>>>>>>
38811>>>>>>>>>        //DDB-DefineFieldEnd
38811>>>>>>>>>    End_Procedure    // Define_Fields
38812>>>>>>>>>
38812>>>>>>>>>    // Field_Defaults:
38812>>>>>>>>>    // This procedure is used to establish default field values.
38812>>>>>>>>>
38812>>>>>>>>>    Procedure Field_Defaults
38813>>>>>>>>>        Forward Send Field_Defaults
38815>>>>>>>>>        //DDB-Generated-Code-Location
38815>>>>>>>>>        //DDB-FieldDefaultStart
38815>>>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
38816>>>>>>>>>        //DDB-FieldDefaultEnd
38816>>>>>>>>>    End_Procedure    // Field_Defaults
38817>>>>>>>>>
38817>>>>>>>>>End_Class    // Clients_DataDictionary
38818>>>>>>>>>//DDB-Selection-pkg-Start
38818>>>>>>>>>
38818>>>>>>>>>Use sl100.SL         // sl100
38818>>>>>>>>>
38818>>>>>>>>>//DDB-Selection-pkg-End
38818>>>>>>>>>//DDB-FileEnd
38818>>>>>>>    
38818>>>>>>>    //AB-IgnoreEnd
38818>>>>>>>
38818>>>>>>>    Object sl100 is a dbModalPanelSub
38820>>>>>>>
38820>>>>>>>        //AB-StoreTopStart
38820>>>>>>>        
38820>>>>>>>        Property String     FragmaClient        Public ''
38822>>>>>>>        Property String     psIsPromhtheyths    Public ''
38824>>>>>>>        Property Integer    piMustConstrain     Public  0
38826>>>>>>>        Property String     psModule            Public ''
38828>>>>>>>        
38828>>>>>>>        //AB-StoreTopEnd
38828>>>>>>>
38828>>>>>>>        Set Label to "(Xlate(Label(Self)))"
38829>>>>>>>        Set Size to 252 509
38830>>>>>>>        Set Location to 4 5
38831>>>>>>>        Set Exit_Application_Local_State to FALSE
38832>>>>>>>        Set Modal_State to FALSE
38833>>>>>>>
38833>>>>>>>        //AB-DDOStart
38833>>>>>>>
38833>>>>>>>        Object Clients_DD is a Clients_DataDictionary
38835>>>>>>>
38835>>>>>>>            //AB-StoreTopStart
38835>>>>>>>                                                                    
38835>>>>>>>            //AB-StoreTopEnd
38835>>>>>>>
38835>>>>>>>
38835>>>>>>>            //AB-StoreStart
38835>>>>>>>                                                                    
38835>>>>>>>            Begin_Constraints
38837>>>>>>>                     If (psModule(Self)='01') BEGIN
38839>>>>>>>                        Constrain Clients.is_Client        Eq '1'
38841>>>>>>>                     end
38841>>>>>>>>
38841>>>>>>>                     Else If (psModule(Self)='02') begin
38844>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
38846>>>>>>>                     end
38846>>>>>>>>
38846>>>>>>>            End_Constraints
38849>>>>>>>            
38849>>>>>>>            
38849>>>>>>>            
38849>>>>>>>            
38849>>>>>>>            
38849>>>>>>>            //AB-StoreEnd
38849>>>>>>>
38849>>>>>>>        End_Object    // Clients_DD
38850>>>>>>>
38850>>>>>>>        Set Main_DD to (Clients_DD(self))
38851>>>>>>>        Set Server to (Clients_DD(self))
38852>>>>>>>
38852>>>>>>>        //AB-DDOEnd
38852>>>>>>>
38852>>>>>>>        Object oSelList is a dbListSub
38854>>>>>>>            Set Main_File to Clients.File_Number
38855>>>>>>>            Set Size to 204 496
38856>>>>>>>            Set Location to 7 5
38857>>>>>>>            Set Auto_Index_State to FALSE
38858>>>>>>>
38858>>>>>>>            Begin_Row
38861>>>>>>>                Entry_Item Clients.Client_id
38862>>>>>>>                Entry_Item Clients.Client_name
38863>>>>>>>                Entry_Item Clients.Client_afm
38864>>>>>>>                Entry_Item Clients.Last_xreosh
38865>>>>>>>                Entry_Item Clients.Last_pistosh
38866>>>>>>>                Entry_Item Clients.Client_codem
38867>>>>>>>                Entry_Item Clients.Is_client
38868>>>>>>>                Entry_Item Clients.Is_promhtheyths
38869>>>>>>>            End_Row
38874>>>>>>>
38874>>>>>>>            Set Form_Width    item 0 to 64
38875>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38876>>>>>>>            
38876>>>>>>>            Set Form_Width    item 1 to 133
38877>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38878>>>>>>>            
38878>>>>>>>            Set Form_Width    item 2 to 62
38879>>>>>>>            Set Header_Label  item 2 to "€”‹"
38880>>>>>>>            
38880>>>>>>>            Set Form_Width    item 3 to 60
38881>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
38882>>>>>>>            
38882>>>>>>>            Set Form_Width    item 4 to 60
38883>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
38884>>>>>>>            
38884>>>>>>>            Set Form_Width    item 5 to 59
38885>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
38886>>>>>>>            
38886>>>>>>>            Set Form_Width    item 6 to 26
38887>>>>>>>            Set Header_Label  item 6 to "œ¢"
38888>>>>>>>            Set Column_Checkbox_State  item 6 to True
38889>>>>>>>            
38889>>>>>>>            Set Form_Width    item 7 to 26
38890>>>>>>>            Set Header_Label  item 7 to "¨¦£"
38891>>>>>>>            Set Column_Checkbox_State  item 7 to True
38892>>>>>>>            
38892>>>>>>>
38892>>>>>>>            //AB-StoreStart
38892>>>>>>>            
38892>>>>>>>            //Property String StoreFragmaClient   Public ''
38892>>>>>>>            //Property String StorePsModule       Public ''
38892>>>>>>>            
38892>>>>>>>            //Procedure Store_Defaults
38892>>>>>>>            //    Forward Send Store_Defaults
38892>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
38892>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
38892>>>>>>>            //End_Procedure
38892>>>>>>>            
38892>>>>>>>            //Procedure ReStore_Defaults
38892>>>>>>>            //    Forward Send ReStore_Defaults
38892>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
38892>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
38892>>>>>>>            //End_Procedure
38892>>>>>>>            
38892>>>>>>>            Set Column_Option Item 6 to NoEnter True
38893>>>>>>>            Set Column_Option Item 7 to NoEnter True
38894>>>>>>>            
38894>>>>>>>            Procedure Activating
38896>>>>>>>                Forward Send Activating
38898>>>>>>>                Set Auto_Index_State to True
38899>>>>>>>            End_Procedure
38900>>>>>>>            
38900>>>>>>>            Procedure Activate
38902>>>>>>>                Send Rebuild_Constraints    to Clients_DD
38903>>>>>>>                If (FragmaClient(Self)<>'') Begin
38905>>>>>>>                    Clear Clients
38906>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
38907>>>>>>>                    Find Eq Clients By Index.6
38908>>>>>>>>
38908>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
38911>>>>>>>                End
38911>>>>>>>>
38911>>>>>>>                Forward Send Activate
38913>>>>>>>            End_procedure
38914>>>>>>>            
38914>>>>>>>            
38914>>>>>>>            
38914>>>>>>>            
38914>>>>>>>            
38914>>>>>>>            
38914>>>>>>>            //AB-StoreEnd
38914>>>>>>>
38914>>>>>>>        End_Object    // oSelList
38915>>>>>>>
38915>>>>>>>        Object oOK_bn is a ButtonSub
38917>>>>>>>            Set Label to "&„§ ¢¦šã"
38918>>>>>>>            Set Location to 218 341
38919>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38920>>>>>>>
38920>>>>>>>            //AB-StoreStart
38920>>>>>>>            Procedure OnClick
38922>>>>>>>                Send OK To (oSelList(current_object))
38923>>>>>>>            End_Procedure
38924>>>>>>>            //AB-StoreEnd
38924>>>>>>>
38924>>>>>>>        End_Object    // oOK_bn
38925>>>>>>>
38925>>>>>>>        Object oCancel_bn is a ButtonSub
38927>>>>>>>            Set Label to "&€¡ç¨à©ž"
38928>>>>>>>            Set Location to 218 396
38929>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38930>>>>>>>
38930>>>>>>>            //AB-StoreStart
38930>>>>>>>            Procedure OnClick
38932>>>>>>>                Send Cancel To (oSelList(current_object))
38933>>>>>>>            End_Procedure
38934>>>>>>>            //AB-StoreEnd
38934>>>>>>>
38934>>>>>>>        End_Object    // oCancel_bn
38935>>>>>>>
38935>>>>>>>        Object oSearch_bn is a ButtonSub
38937>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38938>>>>>>>            Set Location to 218 451
38939>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38940>>>>>>>
38940>>>>>>>            //AB-StoreStart
38940>>>>>>>            Procedure OnClick
38942>>>>>>>                Send Search To (oSelList(current_object))
38943>>>>>>>            End_Procedure
38944>>>>>>>            //AB-StoreEnd
38944>>>>>>>
38944>>>>>>>        End_Object    // oSearch_bn
38945>>>>>>>
38945>>>>>>>
38945>>>>>>>        //AB-StoreStart
38945>>>>>>>        
38945>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38946>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38947>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38948>>>>>>>        
38948>>>>>>>        Set Modal_State to True
38949>>>>>>>        Set Locate_Mode to Center_On_Screen
38950>>>>>>>        
38950>>>>>>>        
38950>>>>>>>        Procedure Activating Returns Integer
38952>>>>>>>            Integer rVal
38953>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
38956>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
38960>>>>>>>            Forward Get Msg_Activating to rVal
38962>>>>>>>            Procedure_Return rVal
38963>>>>>>>        End_procedure
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        
38964>>>>>>>        //AB-StoreEnd
38964>>>>>>>
38964>>>>>>>    End_Object    // sl100
38965>>>>>>>
38965>>>>>>>//AB/     End_Object    // prj
38965>>>>>
38965>>>>>//*********************************************************************************
38965>>>>>//*          A N A L Y S I S                                                      *
38965>>>>>//*********************************************************************************
38965>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
38965>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
38965>>>>>
38965>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
38965>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
38965>>>>>//                                                               Btypkin.Gplan_Code_Apo
38965>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
38965>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
38965>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
38965>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
38965>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
38965>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
38965>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
38965>>>>>
38965>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
38965>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
38965>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
38965>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
38965>>>>>
38965>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
38966>>>>>
38966>>>>>    Procedure Construct_Object
38967>>>>>              Forward Send Construct_Object
38969>>>>>
38969>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
38969>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
38969>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
38969>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
38969>>>>>              Property Integer piBarticl_dd  0
38970>>>>>              Property Integer piBmove_dd    0
38971>>>>>              Property Integer piBaxio_dd    0
38972>>>>>              Property Integer piBaxiokat_dd 0
38973>>>>>              Property Integer piMustNOTConstrain Public 0
38974>>>>>    End_Procedure   //construct_object
38975>>>>>
38975>>>>>//      //private
38975>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
38975>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
38975>>>>>//                                                                 Integer liField            ;
38975>>>>>//                                                                 Integer iMustConstrain     ;
38975>>>>>//                                                                 String  sPelProm
38975>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
38975>>>>>
38975>>>>>//                Move (sl100(Self)) to iPelListID
38975>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
38975>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
38975>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
38975>>>>>
38975>>>>>//                Get piBarticl_dd to liBarticl_dd
38975>>>>>//                If (liBarticl_dd <> 0);
38975>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
38975>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
38975>>>>>//                     Decrement iMax
38975>>>>>//                     For iCount from 0 to iMax
38975>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
38975>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
38975>>>>>//                         If (liTemp = liField);
38975>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
38975>>>>>//                            If (liPrompt_Object_id <> 0);
38975>>>>>//                               Begin
38975>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
38975>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
38975>>>>>//                                  If (iMustConstrain) Begin
38975>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
38975>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
38975>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
38975>>>>>//                                  End
38975>>>>>//                            End
38975>>>>>//                            Else Begin
38975>>>>>//                                Set Prompt_Object      of iDEO to 0
38975>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
38975>>>>>//                            End
38975>>>>>//                         End
38975>>>>>//                     Loop
38975>>>>>//                End
38975>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
38975>>>>>
38975>>>>>
38975>>>>>//    //private
38975>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
38975>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
38975>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
38975>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
38975>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
38975>>>>>//              Integer liBaxiokat_dd liBarticl_dd
38975>>>>>//              String lsBarticlCode1
38975>>>>>
38975>>>>>//            // btypkin_anti
38975>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
38975>>>>>//            // "0"  "Data Entry"
38975>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
38975>>>>>//            // "2"  "”¦¨â˜ª"
38975>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
38975>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
38975>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
38975>>>>>
38975>>>>>
38975>>>>>
38975>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
38975>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
38975>>>>>//              Case Begin
38975>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
38975>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
38975>>>>>//                   Case Break
38975>>>>>
38975>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
38975>>>>>//                   Case Break
38975>>>>>
38975>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
38975>>>>>//                   Case Break
38975>>>>>
38975>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
38975>>>>>//                   Case Break
38975>>>>>//              Case End
38975>>>>>
38975>>>>>//              Case Begin
38975>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
38975>>>>>//                   Case Break
38975>>>>>
38975>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
38975>>>>>//                   Case Break
38975>>>>>
38975>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
38975>>>>>//                   Case Break
38975>>>>>
38975>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
38975>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
38975>>>>>//                   Case Break
38975>>>>>//              Case End
38975>>>>>//    End_Procedure //private.exit_btypkin_code
38975>>>>>
38975>>>>>//    // New_Current_Record:
38975>>>>>
38975>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38975>>>>>//        Integer liBtypkinCodeFldNum
38975>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
38975>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
38975>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
38975>>>>>//        // Insert Code Here
38975>>>>>//    End_Procedure   // New_Current_Record
38975>>>>>
38975>>>>>
38975>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
38975>>>>>    //™) ˜¤áš¤à©ž properties
38975>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
38975>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
38975>>>>>    //œ) œ¤ž£â¨à©ž properties after
38975>>>>>    Procedure Update
38976>>>>>
38976>>>>>              Forward Send Update
38978>>>>>
38978>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
38978>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
38979>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
38980>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
38981>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
38982>>>>>
38982>>>>>              //™) ˜¤áš¤à©ž properties
38982>>>>>
38982>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
38982>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
38982>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
38982>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
38984>>>>>             // gts 02/12/04 oxi gia titana
38984>>>>>             //      Move "" to Btypkin.Gplan_Code_Apo1
38984>>>>>             //      Move "" to Btypkin.Gplan_Code_Eos1
38984>>>>>              End
38984>>>>>>
38984>>>>>
38984>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
38984>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
38984>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
38986>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
38987>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
38988>>>>>              End
38988>>>>>>
38988>>>>>
38988>>>>>              //š.3:gtypkin_rec0 (conditional)
38988>>>>>              Case Begin
38988>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
38990>>>>>//jsjsjs 24/01/2001
38990>>>>>//                         Clear Gtypkin
38990>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
38990>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
38990>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
38990>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
38990>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
38990>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
38990>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
38990>>>>>//jsjsjs 24/01/2001
38990>>>>>                   Case Break
38991>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
38991>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
38992>>>>>              Case End
38992>>>>>
38992>>>>>              //š.4:ctypkin_rec0 (conditional)
38992>>>>>              Case Begin
38992>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
38994>>>>>                         Clear Ctypkin
INCLUDING FILE: CTYPKIN.FD
38995>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
38996>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
38997>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
38998>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
38999>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
39000>>>>>>
39000>>>>>                         If (Found = 1) Begin
39002>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
39003>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
39004>>>>>                         End
39004>>>>>>
39004>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
39006>>>>>                   Case Break
39007>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
39007>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
39008>>>>>                         Move '' to Btypkin.Ctypkin_Recr
39009>>>>>              Case End
39009>>>>>
39009>>>>>              //š.5:vtypkin_rec0 (conditional)
39009>>>>>              Case Begin
39009>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
39011>>>>>                         //Clear Vtypkin
39011>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
39011>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
39011>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
39011>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
39011>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
39011>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
39011>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
39011>>>>>                   Case Break
39012>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
39012>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
39013>>>>>              Case End
39013>>>>>
39013>>>>>              //š.6:btypkin_l_hmnia (conditional)
39013>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
39016>>>>>
39016>>>>>
39016>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
39016>>>>>
39016>>>>>              //œ) œ¤ž£â¨à©ž properties after
39016>>>>>    End_Procedure //update
39017>>>>>
39017>>>>>    Procedure Creating
39018>>>>>              Forward Send Creating
39020>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
39020>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
39021>>>>>    End_Procedure //creating
39022>>>>>
39022>>>>>//    Procedure OnConstrain
39022>>>>>//        Set piMustNOTConstrain to True
39022>>>>>        
39022>>>>>//        If (piMustNOTConstrain(Self)) Begin
39022>>>>>//        End
39022>>>>>//        Else Begin
39022>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
39022>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
39022>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
39022>>>>>//        End
39022>>>>>//    End_Procedure
39022>>>>>
39022>>>>>
39022>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39023>>>>>              String lsError_Message
39024>>>>>              Case Begin
39024>>>>>                   //˜§æ validate save
39024>>>>>                   Case (iError_Num = 1001)
39026>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
39026>>>>>                        //to lsError_Message
39026>>>>>                   Case Break
39027>>>>>                   Case (iError_Num = 1100)
39030>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39031>>>>>                        Case Break
39032>>>>>
39032>>>>>                   //˜§æ validate delete
39032>>>>>                   Case (iError_Num = 2001)
39035>>>>>                        //Clear Codemast
39035>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
39035>>>>>                        //to lsError_Message
39035>>>>>                   Case Break
39036>>>>>                   Case (iError_Num = 2100)
39039>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39040>>>>>                        Case Break
39041>>>>>
39041>>>>>                   //˜§æ update
39041>>>>>                   Case (iError_Num = 3001)
39044>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39045>>>>>                   Case Break
39046>>>>>                   Case (iError_Num = 3002)
39049>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39050>>>>>                   Case Break
39051>>>>>                   Case (iError_Num = 3003)
39054>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39055>>>>>                   Case Break
39056>>>>>
39056>>>>>
39056>>>>>
39056>>>>>                   Case Else
39056>>>>>                        Forward Send Operation_Not_Allowed iError_Num
39058>>>>>              Case End
39058>>>>>
39058>>>>>              Error iError_Num lsError_Message
39059>>>>>>
39059>>>>>    End_Procedure // operation_not_allowed
39060>>>>>
39060>>>>>
39060>>>>>//    //1001:
39060>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
39060>>>>>//    Function Validate_Save Returns Integer
39060>>>>>//             Integer iReturnVal
39060>>>>>
39060>>>>>//             Forward Get Validate_Save to iReturnVal
39060>>>>>
39060>>>>>//             If (Not(iReturnVal));
39060>>>>>//             Begin
39060>>>>>//                  //1100:cby = globals
39060>>>>>//                  If ( ;
39060>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
39060>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
39060>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
39060>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
39060>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
39060>>>>>//             Function_Return iReturnVal
39060>>>>>//    End_Function   // validate_save
39060>>>>>
39060>>>>>
39060>>>>>//    //2001:
39060>>>>>//    Function Validate_Delete  Returns Integer
39060>>>>>//             Integer iReturnVal
39060>>>>>//             Forward Get Validate_Delete  To iReturnVal
39060>>>>>//             If (Not(iReturnVal));
39060>>>>>//             Begin
39060>>>>>
39060>>>>>//                  //2100:cby = globals
39060>>>>>//                  If ( ;
39060>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
39060>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
39060>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
39060>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
39060>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
39060>>>>>//             Function_Return iReturnVal
39060>>>>>//    End_Function   // Validate_Delete
39060>>>>>
39060>>>>>
39060>>>>>    Procedure Define_Fields
39061>>>>>        Forward Send Define_Fields
39063>>>>>        //DDB-Generated-Code-Location
39063>>>>>        //DDB-DefineFieldStart
39063>>>>>
39063>>>>>        Set Main_File            To Btypkin.File_Number
39064>>>>>        Set Cascade_Delete_State To FALSE
39065>>>>>
39065>>>>>
39065>>>>>        // Child (Client) file structure................
39065>>>>>        Send Add_Client_File  Bflagkin.File_Number
39066>>>>>        Send Add_Client_File  Bkinkat.File_Number
39067>>>>>        Send Add_Client_File  Barticl.File_Number
39068>>>>>
39068>>>>>        // External (System) file structure.............
39068>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39069>>>>>
39069>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
39072>>>>>
39072>>>>>        // Field-based properties.......................
39072>>>>>
39072>>>>>        // Btypkin.Company_Code
39072>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
39072>>>>>
39072>>>>>        // Btypkin.Branch_Code
39072>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
39072>>>>>
39072>>>>>        // Btypkin.Year_Year
39072>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
39072>>>>>
39072>>>>>        // Btypkin.Btypkin_Code
39072>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
39073>>>>>
39073>>>>>        // Btypkin.Btypkin_Rec0
39073>>>>>
39073>>>>>        // Btypkin.Btypkin_Recr
39073>>>>>
39073>>>>>        // Btypkin.Year_Recr
39073>>>>>
39073>>>>>        // Btypkin.Btypkin_Descr
39073>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
39074>>>>>
39074>>>>>        // Btypkin.Gtypkin_Code
39074>>>>>
39074>>>>>        // Btypkin.Ctypkin_Code
39074>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
39075>>>>>
39075>>>>>        // Btypkin.Vtypkin_Code
39075>>>>>
39075>>>>>        // Btypkin.Gtypkin_Rec0
39075>>>>>
39075>>>>>        // Btypkin.Ctypkin_Rec0
39075>>>>>
39075>>>>>        // Btypkin.Vtypkin_Rec0
39075>>>>>
39075>>>>>        // Btypkin.Btypkin_Anti1
39075>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
39076>>>>>
39076>>>>>        // Btypkin.Gplan_Code_Apo1
39076>>>>>
39076>>>>>        // Btypkin.Gplan_Code_Eos1
39076>>>>>
39076>>>>>        // Btypkin.Btypkin_Anti2
39076>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
39077>>>>>
39077>>>>>        // Btypkin.Gplan_Code_Apo2
39077>>>>>
39077>>>>>        // Btypkin.Gplan_Code_Eos2
39077>>>>>
39077>>>>>        // Btypkin.Bflagkin_Num
39077>>>>>
39077>>>>>        // Btypkin.Bkinkat_Num
39077>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
39077>>>>>
39077>>>>>        // Btypkin.Btypkin_Anti_Xp
39077>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
39078>>>>>
39078>>>>>        // Btypkin.Btypkin_Printer
39078>>>>>
39078>>>>>        // Btypkin.Btypkin_Pdescr
39078>>>>>
39078>>>>>        // Btypkin.Btypkin_Form
39078>>>>>
39078>>>>>        // Btypkin.Btypkin_L_No
39078>>>>>
39078>>>>>        // Btypkin.Btypkin_L_Hmnia
39078>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Seira
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Abr
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Flag01
39079>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Flag02
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Flag03
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Flag04
39079>>>>>
39079>>>>>        // Btypkin.Btypkin_Flag05
39079>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag06
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag07
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag08
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag09
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag10
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag11
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag12
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag13
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag14
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag15
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag16
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag17
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag18
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag19
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Flag20
39080>>>>>
39080>>>>>        // Btypkin.Btypkin_Sign
39080>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
39081>>>>>
39081>>>>>        // Btypkin.Ctypkin_Recr
39081>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
39082>>>>>
39082>>>>>        // Btypkin.Label
39082>>>>>
39082>>>>>        // Btypkin.Locked
39082>>>>>
39082>>>>>        // Btypkin.Locked_Date
39082>>>>>        Set Field_Mask_Type        Field Btypkin.Locked_Date To MASK_DATE_WINDOW
39083>>>>>
39083>>>>>        //DDB-DefineFieldEnd
39083>>>>>
39083>>>>>        Set Main_File            To Btypkin.File_Number
39084>>>>>        Set Cascade_Delete_State To FALSE
39085>>>>>
39085>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39086>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39087>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39088>>>>>
39088>>>>>        // Child (Client) file structure................
39088>>>>>        Send Add_Client_File  Bflagkin.File_Number
39089>>>>>        Send Add_Client_File  Barticl.File_Number
39090>>>>>        Send Add_Client_File  Bkinkat.File_Number
39091>>>>>
39091>>>>>        // External (System) file structure.............
39091>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39092>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
39092>>>>>
39092>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
39095>>>>>
39095>>>>>        // Field-based properties.......................
39095>>>>>
39095>>>>>        // Btypkin.Company_Code
39095>>>>>
39095>>>>>        // Btypkin.Branch_Code
39095>>>>>
39095>>>>>        // Btypkin.Year_Year
39095>>>>>
39095>>>>>        // Btypkin.Btypkin_Code
39095>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
39096>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
39097>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
39098>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
39099>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
39100>>>>>
39100>>>>>        // Btypkin.Btypkin_Rec0
39100>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
39101>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
39102>>>>>
39102>>>>>        // Btypkin.Year_Rec0
39102>>>>>
39102>>>>>        // Btypkin.Btypkin_Descr
39102>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
39103>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
39104>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
39105>>>>>
39105>>>>>        // Btypkin.Gtypkin_Code
39105>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
39106>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
39107>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
39107>>>>>
39107>>>>>        // Btypkin.Ctypkin_Code
39107>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
39108>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
39109>>>>>
39109>>>>>        // Btypkin.Vtypkin_Code
39109>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
39110>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
39111>>>>>
39111>>>>>        // Btypkin.Gtypkin_Rec0
39111>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
39112>>>>>
39112>>>>>        // Btypkin.Ctypkin_Rec0
39112>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
39113>>>>>
39113>>>>>        // Btypkin.Vtypkin_Rec0
39113>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
39114>>>>>
39114>>>>>        // Btypkin.Btypkin_Anti1
39114>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
39115>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
39116>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
39117>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
39118>>>>>
39118>>>>>        // Btypkin.Gplan_Code_Apo1
39118>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
39119>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
39120>>>>>
39120>>>>>        // Btypkin.Gplan_Code_Eos1
39120>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
39121>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
39122>>>>>
39122>>>>>        // Btypkin.Btypkin_Anti2
39122>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
39123>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
39124>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
39125>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
39126>>>>>
39126>>>>>        // Btypkin.Gplan_Code_Apo2
39126>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
39127>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
39128>>>>>
39128>>>>>        // Btypkin.Gplan_Code_Eos2
39128>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
39129>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
39130>>>>>
39130>>>>>        // Btypkin.Bflagkin_Num
39130>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
39131>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
39132>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
39133>>>>>
39133>>>>>        // Btypkin.Bkinkat_Num
39133>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
39134>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
39135>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
39136>>>>>
39136>>>>>        // Btypkin.Btypkin_Anti_Xp
39136>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
39137>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
39138>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
39139>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
39140>>>>>
39140>>>>>        // Btypkin.Btypkin_Printer
39140>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
39141>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
39142>>>>>
39142>>>>>        // Btypkin.Btypkin_Pdescr
39142>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
39143>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
39144>>>>>
39144>>>>>        // Btypkin.Btypkin_Form
39144>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
39145>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
39146>>>>>
39146>>>>>        // Btypkin.Btypkin_L_No
39146>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
39147>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
39148>>>>>        //Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
39148>>>>>
39148>>>>>        // Btypkin.Btypkin_L_Hmnia
39148>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
39149>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
39150>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
39151>>>>>
39151>>>>>        // Btypkin.Btypkin_Seira
39151>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
39152>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
39153>>>>>
39153>>>>>        // Btypkin.Btypkin_Abr
39153>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
39154>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
39155>>>>>
39155>>>>>        // Btypkin.Btypkin_Flag01
39155>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
39156>>>>>
39156>>>>>        // Btypkin.Btypkin_Flag02
39156>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
39157>>>>>
39157>>>>>        // Btypkin.Btypkin_Flag03
39157>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
39158>>>>>
39158>>>>>        // Btypkin.Btypkin_Flag04
39158>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
39159>>>>>
39159>>>>>        // Btypkin.Btypkin_Flag05
39159>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
39160>>>>>
39160>>>>>        // Btypkin.Btypkin_Flag06
39160>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
39161>>>>>
39161>>>>>        // Btypkin.Btypkin_Flag07
39161>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
39162>>>>>
39162>>>>>        // Btypkin.Btypkin_Flag08
39162>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
39163>>>>>
39163>>>>>        // Btypkin.Btypkin_Flag09
39163>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
39164>>>>>
39164>>>>>        // Btypkin.Btypkin_Flag10
39164>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
39165>>>>>
39165>>>>>        // Btypkin.Btypkin_Flag11
39165>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
39166>>>>>
39166>>>>>        // Btypkin.Btypkin_Flag12
39166>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
39167>>>>>
39167>>>>>        // Btypkin.Btypkin_Flag13
39167>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
39168>>>>>
39168>>>>>        // Btypkin.Btypkin_Flag14
39168>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
39169>>>>>
39169>>>>>        // Btypkin.Btypkin_Flag15
39169>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
39170>>>>>
39170>>>>>        // Btypkin.Btypkin_Flag16
39170>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
39171>>>>>
39171>>>>>        // Btypkin.Btypkin_Flag17
39171>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
39172>>>>>
39172>>>>>        // Btypkin.Btypkin_Flag18
39172>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
39173>>>>>
39173>>>>>        // Btypkin.Btypkin_Flag19
39173>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
39174>>>>>
39174>>>>>        // Btypkin.Btypkin_Flag20
39174>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
39175>>>>>
39175>>>>>    End_Procedure    // Define_Fields
39176>>>>>
39176>>>>>
39176>>>>>
39176>>>>>    // Field_Defaults:
39176>>>>>    // This procedure is used to establish default field values.
39176>>>>>
39176>>>>>    Procedure Field_Defaults
39177>>>>>        Forward Send Field_Defaults
39179>>>>>        //DDB-Generated-Code-Location
39179>>>>>        //DDB-FieldDefaultStart
39179>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
39180>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
39181>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
39182>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
39183>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
39184>>>>>        //DDB-FieldDefaultEnd
39184>>>>>    End_Procedure    // Field_Defaults
39185>>>>>End_Class    // Btypkin_DataDictionary
39186>>>>>//DDB-Selection-pkg-Start
39186>>>>>
39186>>>>>Use SL031.SL         // SL031
INCLUDING FILE: SL031.SL
39186>>>>>>>//AB/ Project SL031:BTYPKIN
39186>>>>>>>//AB/ Object prj is a Lookup_Project
39186>>>>>>>//AB/     Set ProjectName to "SL031:BTYPKIN"
39186>>>>>>>//AB/     Set ProjectFileName to "SL031.SL"
39186>>>>>>>
39186>>>>>>>// Project Object Structure
39186>>>>>>>//   SL031 is a dbModalPanelSub
39186>>>>>>>//     Btypkin_DD is a DataDictionary
39186>>>>>>>//     oSelList is a dbListSub
39186>>>>>>>//     oOK_bn is a ButtonSub
39186>>>>>>>//     oCancel_bn is a ButtonSub
39186>>>>>>>//     oSearch_bn is a ButtonSub
39186>>>>>>>
39186>>>>>>>// Register all objects
39186>>>>>>>Register_Object Btypkin_DD
39186>>>>>>>Register_Object oCancel_bn
39186>>>>>>>Register_Object oOK_bn
39186>>>>>>>Register_Object oSearch_bn
39186>>>>>>>Register_Object oSelList
39186>>>>>>>Register_Object SL031
39186>>>>>>>
39186>>>>>>>
39186>>>>>>>//AB-IgnoreStart
39186>>>>>>>
39186>>>>>>>Use DFAllEnt.pkg
39186>>>>>>>Use dbList.Sub
39186>>>>>>>Use Button.Sub
39186>>>>>>>
39186>>>>>>>
39186>>>>>>>Use BTYPKIN.DD
39186>>>>>>>
39186>>>>>>>//AB-IgnoreEnd
39186>>>>>>>
39186>>>>>>>CD_Popup_Object SL031 is a dbModalPanelSub
39205>>>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
39206>>>>>>>    Set Size to 213 506
39207>>>>>>>    Set Location to 4 5
39208>>>>>>>    Set Exit_Application_Local_State to FALSE
39209>>>>>>>    Set Modal_State to FALSE
39210>>>>>>>
39210>>>>>>>    //AB-DDOStart
39210>>>>>>>
39210>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
39212>>>>>>>    End_Object    // Btypkin_DD
39213>>>>>>>
39213>>>>>>>    Set Main_DD to (Btypkin_DD(self))
39214>>>>>>>    Set Server to (Btypkin_DD(self))
39215>>>>>>>
39215>>>>>>>    //AB-DDOEnd
39215>>>>>>>
39215>>>>>>>    Object oSelList is a dbListSub
39217>>>>>>>        Set Main_File to Btypkin.File_Number
39218>>>>>>>        Set Size to 173 491
39219>>>>>>>        Set Location to 3 6
39220>>>>>>>
39220>>>>>>>        Begin_Row
39223>>>>>>>            Entry_Item Btypkin.Btypkin_code
39224>>>>>>>            Entry_Item Btypkin.Btypkin_descr
39225>>>>>>>            Entry_Item Btypkin.Gtypkin_code
39226>>>>>>>            Entry_Item Btypkin.Ctypkin_code
39227>>>>>>>            Entry_Item Btypkin.Vtypkin_code
39228>>>>>>>            Entry_Item Btypkin.Btypkin_anti_xp
39229>>>>>>>            Entry_Item Btypkin.Locked
39230>>>>>>>        End_Row
39235>>>>>>>
39235>>>>>>>        Set Form_Width    item 0 to 39
39236>>>>>>>        Set Header_Label  item 0 to "‰å¤ž©ž"
39237>>>>>>>        
39237>>>>>>>        Set Form_Width    item 1 to 172
39238>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39239>>>>>>>        
39239>>>>>>>        Set Form_Width    item 2 to 46
39240>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž ‚Š"
39241>>>>>>>        
39241>>>>>>>        Set Form_Width    item 3 to 70
39242>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž œ¢˜«é¤        "
39243>>>>>>>        
39243>>>>>>>        Set Form_Width    item 4 to 53
39244>>>>>>>        Set Header_Label  item 4 to "‰å¤ž©ž ¨¦£."
39245>>>>>>>        
39245>>>>>>>        Set Form_Width    item 5 to 64
39246>>>>>>>        Set Header_Label  item 5 to "• ‘¬¤˜¢¢˜©¦£."
39247>>>>>>>        
39247>>>>>>>        Set Form_Width    item 6 to 42
39248>>>>>>>        Set Header_Label  item 6 to "‰¢œ ›à£â¤ž"
39249>>>>>>>        Set Column_Checkbox_State  item 6 to True
39250>>>>>>>        
39250>>>>>>>    End_Object    // oSelList
39251>>>>>>>
39251>>>>>>>    Object oOK_bn is a ButtonSub
39253>>>>>>>        Set Label to "&„§ ¢¦šã"
39254>>>>>>>        Set Location to 177 337
39255>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39256>>>>>>>
39256>>>>>>>        //AB-StoreStart
39256>>>>>>>        Procedure OnClick
39258>>>>>>>            Send OK To oSelList
39259>>>>>>>        End_Procedure
39260>>>>>>>        //AB-StoreEnd
39260>>>>>>>
39260>>>>>>>    End_Object    // oOK_bn
39261>>>>>>>
39261>>>>>>>    Object oCancel_bn is a ButtonSub
39263>>>>>>>        Set Label to "&€¡ç¨à©ž"
39264>>>>>>>        Set Location to 177 393
39265>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39266>>>>>>>
39266>>>>>>>        //AB-StoreStart
39266>>>>>>>        Procedure OnClick
39268>>>>>>>            Send Cancel To oSelList
39269>>>>>>>        End_Procedure
39270>>>>>>>        //AB-StoreEnd
39270>>>>>>>
39270>>>>>>>    End_Object    // oCancel_bn
39271>>>>>>>
39271>>>>>>>    Object oSearch_bn is a ButtonSub
39273>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39274>>>>>>>        Set Location to 177 447
39275>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39276>>>>>>>
39276>>>>>>>        //AB-StoreStart
39276>>>>>>>        Procedure OnClick
39278>>>>>>>            Send Search To oSelList
39279>>>>>>>        End_Procedure
39280>>>>>>>        //AB-StoreEnd
39280>>>>>>>
39280>>>>>>>    End_Object    // oSearch_bn
39281>>>>>>>
39281>>>>>>>
39281>>>>>>>    //AB-StoreStart
39281>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
39282>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
39283>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
39284>>>>>>>    
39284>>>>>>>    //AB-StoreEnd
39284>>>>>>>
39284>>>>>>>CD_End_Object    // SL031
39286>>>>>>>>
39286>>>>>>>
39286>>>>>>>//AB/ End_Object    // prj
39286>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
39286>>>>>>>//AB/ Project Ctypkin : sl007
39286>>>>>>>//AB/ Object prj is a Lookup_Project
39286>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
39286>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
39286>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39286>>>>>>>
39286>>>>>>>// Project Object Structure
39286>>>>>>>//   sl007 is a dbModalPanelSub
39286>>>>>>>//     Ctypkin_DD is a DataDictionary
39286>>>>>>>//     oSelList is a dbListSub
39286>>>>>>>//     oOK_bn is a ButtonSub
39286>>>>>>>//     oCancel_bn is a ButtonSub
39286>>>>>>>//     oSearch_bn is a ButtonSub
39286>>>>>>>
39286>>>>>>>// Register all objects
39286>>>>>>>Register_Object Ctypkin_DD
39286>>>>>>>Register_Object oCancel_bn
39286>>>>>>>Register_Object oOK_bn
39286>>>>>>>Register_Object oSearch_bn
39286>>>>>>>Register_Object oSelList
39286>>>>>>>Register_Object sl007
39286>>>>>>>
39286>>>>>>>
39286>>>>>>>//AB-IgnoreStart
39286>>>>>>>
39286>>>>>>>Use DFAllEnt.pkg
39286>>>>>>>Use dbList.Sub
39286>>>>>>>Use Button.Sub
39286>>>>>>>
39286>>>>>>>
39286>>>>>>>Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
39286>>>>>>>>>//DDB-FileStart
39286>>>>>>>>>//DDB-HeaderStart
39286>>>>>>>>>
39286>>>>>>>>>// File Name : CTYPKIN.DD
39286>>>>>>>>>// Class Name: Ctypkin_DataDictionary
39286>>>>>>>>>// Revision  : 70
39286>>>>>>>>>// Version   : 2
39286>>>>>>>>>
39286>>>>>>>>>Use  Windows           // Basic Definitions
39286>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39286>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39286>>>>>>>>>
39286>>>>>>>>>Open Ctypkin
39288>>>>>>>>>Open Cmoves
39290>>>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
39292>>>>>>>>>Open Ptypparl
39294>>>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
39296>>>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
39298>>>>>>>>>Open Cmovesa
39300>>>>>>>>>Open Sysrecc
39302>>>>>>>>>Open Syscurxr
39304>>>>>>>>>
39304>>>>>>>>>//DDB-HeaderEnd
39304>>>>>>>>>//DDB-ValidationStart
39304>>>>>>>>>
39304>>>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
39304>>>>>>>>>
39304>>>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
39306>>>>>>>>>    Set Type_Value        To "MODULE"
39307>>>>>>>>>    //DDB-ValidationCustomStart
39307>>>>>>>>>    //DDB-ValidationCustomEnd
39307>>>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
39308>>>>>>>>>//DDB-ValidationEnd
39308>>>>>>>>>//DDB-SelectionStart
39308>>>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
39308>>>>>>>>>Register_Object sl007
39308>>>>>>>>>//DDB-SelectionEnd
39308>>>>>>>>>
39308>>>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
39309>>>>>>>>>         
39309>>>>>>>>>    Procedure Construct_Object
39310>>>>>>>>>        Forward Send Construct_Object
39312>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
39313>>>>>>>>>    End_Procedure
39314>>>>>>>>>
39314>>>>>>>>>    Procedure Save_Main_File
39315>>>>>>>>>        If (Operation_Origin<>Self) Begin
39317>>>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
39320>>>>>>>>>        End
39320>>>>>>>>>>
39320>>>>>>>>>        Forward Send Save_Main_File
39322>>>>>>>>>    End_Procedure
39323>>>>>>>>>
39323>>>>>>>>>     Procedure Creating
39324>>>>>>>>>        Forward Send Creating
39326>>>>>>>>>        // Insert Code Here
39326>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
39327>>>>>>>>>    End_Procedure   // Creating
39328>>>>>>>>>
39328>>>>>>>>>
39328>>>>>>>>>    // Define_Fields:
39328>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39328>>>>>>>>>
39328>>>>>>>>>    Procedure Define_Fields
39329>>>>>>>>>        Forward Send Define_Fields
39331>>>>>>>>>        //DDB-Generated-Code-Location
39331>>>>>>>>>        //DDB-DefineFieldStart
39331>>>>>>>>>
39331>>>>>>>>>        Set Main_File            To Ctypkin.File_Number
39332>>>>>>>>>        Set Cascade_Delete_State To FALSE
39333>>>>>>>>>
39333>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39334>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39335>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39336>>>>>>>>>
39336>>>>>>>>>        // Child (Client) file structure................
39336>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
39337>>>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
39338>>>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
39339>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39340>>>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
39341>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
39342>>>>>>>>>
39342>>>>>>>>>        // External (System) file structure.............
39342>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39343>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39344>>>>>>>>>
39344>>>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
39347>>>>>>>>>
39347>>>>>>>>>        // Field-based properties.......................
39347>>>>>>>>>
39347>>>>>>>>>        // Ctypkin.Company_Code
39347>>>>>>>>>
39347>>>>>>>>>        // Ctypkin.Branch_Code
39347>>>>>>>>>
39347>>>>>>>>>        // Ctypkin.Year_Year
39347>>>>>>>>>
39347>>>>>>>>>        // Ctypkin.Ctypkin_Code
39347>>>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
39348>>>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
39349>>>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
39350>>>>>>>>>
39350>>>>>>>>>        // Ctypkin.Ctypkin_Rec0
39350>>>>>>>>>
39350>>>>>>>>>        // Ctypkin.Ctypkin_Recr
39350>>>>>>>>>
39350>>>>>>>>>        // Ctypkin.Year_Recr
39350>>>>>>>>>
39350>>>>>>>>>        // Ctypkin.Ctypkin_Descr
39350>>>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
39351>>>>>>>>>
39351>>>>>>>>>        // Ctypkin.Ctypkin_Anti
39351>>>>>>>>>
39351>>>>>>>>>        // Ctypkin.Ctypkin_Flags
39351>>>>>>>>>
39351>>>>>>>>>        // Ctypkin.Ctypkin_Module
39351>>>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
39352>>>>>>>>>
39352>>>>>>>>>        // Ctypkin.Open_Item
39352>>>>>>>>>
39352>>>>>>>>>        // Ctypkin.Check_Overhead
39352>>>>>>>>>
39352>>>>>>>>>        // Ctypkin.Max_Days_Sx_Par
39352>>>>>>>>>
39352>>>>>>>>>        // Ctypkin.Singular
39352>>>>>>>>>
39352>>>>>>>>>        // Ctypkin.Sub
39352>>>>>>>>>
39352>>>>>>>>>        // Ctypkin.Subreport
39352>>>>>>>>>
39352>>>>>>>>>        //DDB-DefineFieldEnd
39352>>>>>>>>>    End_Procedure    // Define_Fields
39353>>>>>>>>>
39353>>>>>>>>>    // Field_Defaults:
39353>>>>>>>>>    // This procedure is used to establish default field values.
39353>>>>>>>>>
39353>>>>>>>>>    Procedure Field_Defaults
39354>>>>>>>>>        Forward Send Field_Defaults
39356>>>>>>>>>        //DDB-Generated-Code-Location
39356>>>>>>>>>        //DDB-FieldDefaultStart
39356>>>>>>>>>        //DDB-FieldDefaultEnd
39356>>>>>>>>>    End_Procedure    // Field_Defaults
39357>>>>>>>>>
39357>>>>>>>>>End_Class    // Ctypkin_DataDictionary
39358>>>>>>>>>//DDB-Selection-pkg-Start
39358>>>>>>>>>
39358>>>>>>>>>Use sl007.SL         // sl007
39358>>>>>>>>>
39358>>>>>>>>>//DDB-Selection-pkg-End
39358>>>>>>>>>//DDB-FileEnd
39358>>>>>>>
39358>>>>>>>//AB-IgnoreEnd
39358>>>>>>>
39358>>>>>>>Object sl007 is a dbModalPanelSub
39360>>>>>>>
39360>>>>>>>    //AB-StoreTopStart
39360>>>>>>>    Property String psModule Public ''
39362>>>>>>>    
39362>>>>>>>    //AB-StoreTopEnd
39362>>>>>>>
39362>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
39363>>>>>>>    Set Size to 148 350
39364>>>>>>>    Set Location to 4 7
39365>>>>>>>    Set Exit_Application_Local_State to FALSE
39366>>>>>>>    Set Modal_State to FALSE
39367>>>>>>>
39367>>>>>>>    //AB-DDOStart
39367>>>>>>>
39367>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39369>>>>>>>
39369>>>>>>>        //AB-StoreStart
39369>>>>>>>                                
39369>>>>>>>        Begin_Constraints
39371>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
39375>>>>>>>        End_Constraints
39378>>>>>>>        
39378>>>>>>>        
39378>>>>>>>        
39378>>>>>>>        
39378>>>>>>>        //AB-StoreEnd
39378>>>>>>>
39378>>>>>>>    End_Object    // Ctypkin_DD
39379>>>>>>>
39379>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
39380>>>>>>>    Set Server to (Ctypkin_DD(self))
39381>>>>>>>
39381>>>>>>>    //AB-DDOEnd
39381>>>>>>>
39381>>>>>>>    Object oSelList is a dbListSub
39383>>>>>>>        Set Main_File to Ctypkin.File_Number
39384>>>>>>>        Set Size to 105 335
39385>>>>>>>        Set Location to 6 6
39386>>>>>>>
39386>>>>>>>        Begin_Row
39389>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
39390>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39391>>>>>>>        End_Row
39396>>>>>>>
39396>>>>>>>        Set Form_Width    item 0 to 71
39397>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
39398>>>>>>>        
39398>>>>>>>        Set Form_Width    item 1 to 255
39399>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
39400>>>>>>>        
39400>>>>>>>
39400>>>>>>>        //AB-StoreStart
39400>>>>>>>                    
39400>>>>>>>                    
39400>>>>>>>        Procedure Activate
39402>>>>>>>            Forward Send Activate
39404>>>>>>>            Send Beginning_Of_Data to oSelList True
39405>>>>>>>        End_Procedure
39406>>>>>>>        
39406>>>>>>>        
39406>>>>>>>        
39406>>>>>>>        
39406>>>>>>>        //AB-StoreEnd
39406>>>>>>>
39406>>>>>>>    End_Object    // oSelList
39407>>>>>>>
39407>>>>>>>    Object oOK_bn is a ButtonSub
39409>>>>>>>        Set Label to "&„§ ¢¦šã"
39410>>>>>>>        Set Location to 113 171
39411>>>>>>>
39411>>>>>>>        //AB-StoreStart
39411>>>>>>>        Procedure OnClick
39413>>>>>>>            Send OK To (oSelList(current_object))
39414>>>>>>>        End_Procedure
39415>>>>>>>        //AB-StoreEnd
39415>>>>>>>
39415>>>>>>>    End_Object    // oOK_bn
39416>>>>>>>
39416>>>>>>>    Object oCancel_bn is a ButtonSub
39418>>>>>>>        Set Label to "&€¡ç¨à©ž"
39419>>>>>>>        Set Location to 113 226
39420>>>>>>>
39420>>>>>>>        //AB-StoreStart
39420>>>>>>>        Procedure OnClick
39422>>>>>>>            Send Cancel To (oSelList(current_object))
39423>>>>>>>        End_Procedure
39424>>>>>>>        //AB-StoreEnd
39424>>>>>>>
39424>>>>>>>    End_Object    // oCancel_bn
39425>>>>>>>
39425>>>>>>>    Object oSearch_bn is a ButtonSub
39427>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39428>>>>>>>        Set Location to 113 281
39429>>>>>>>
39429>>>>>>>        //AB-StoreStart
39429>>>>>>>        Procedure OnClick
39431>>>>>>>            Send Search To (oSelList(current_object))
39432>>>>>>>        End_Procedure
39433>>>>>>>        //AB-StoreEnd
39433>>>>>>>
39433>>>>>>>    End_Object    // oSearch_bn
39434>>>>>>>
39434>>>>>>>
39434>>>>>>>    //AB-StoreStart
39434>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39435>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39436>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39437>>>>>>>    
39437>>>>>>>    Procedure Activate Returns Integer
39439>>>>>>>        Integer rVal
39440>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
39441>>>>>>>        Forward Get Msg_Activate to rVal
39443>>>>>>>        Procedure_Return rVal
39444>>>>>>>    End_Procedure
39445>>>>>>>    
39445>>>>>>>    //AB-StoreEnd
39445>>>>>>>
39445>>>>>>>End_Object    // sl007
39446>>>>>>>
39446>>>>>>>//AB/ End_Object    // prj
39446>>>>>Use sl007r.SL        // sl007r
INCLUDING FILE: SL007R.SL
39446>>>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
39446>>>>>>>//AB/     Object prj is a Lookup_Project
39446>>>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
39446>>>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
39446>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39446>>>>>>>
39446>>>>>>>// Project Object Structure
39446>>>>>>>//   sl007r is a dbModalPanelSub
39446>>>>>>>//     Ctypkin_DD is a DataDictionary
39446>>>>>>>//     oSelList is a dbListSub
39446>>>>>>>//     oOK_bn is a ButtonSub
39446>>>>>>>//     oCancel_bn is a ButtonSub
39446>>>>>>>//     oSearch_bn is a ButtonSub
39446>>>>>>>
39446>>>>>>>// Register all objects
39446>>>>>>>Register_Object Ctypkin_DD
39446>>>>>>>Register_Object oCancel_bn
39446>>>>>>>Register_Object oOK_bn
39446>>>>>>>Register_Object oSearch_bn
39446>>>>>>>Register_Object oSelList
39446>>>>>>>Register_Object sl007r
39446>>>>>>>
39446>>>>>>>
39446>>>>>>>    //AB-IgnoreStart
39446>>>>>>>
39446>>>>>>>    Use DFAllEnt.pkg
39446>>>>>>>    Use dbList.Sub
39446>>>>>>>    Use Button.Sub
39446>>>>>>>
39446>>>>>>>
39446>>>>>>>    Use CTYPKIN.DD
39446>>>>>>>    
39446>>>>>>>    //AB-IgnoreEnd
39446>>>>>>>
39446>>>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
39465>>>>>>>        Set Label to "Ctypkin"
39466>>>>>>>        Set Size to 148 480
39467>>>>>>>        Set Location to 12 16
39468>>>>>>>        Set Exit_Application_Local_State to FALSE
39469>>>>>>>        Set Modal_State to FALSE
39470>>>>>>>
39470>>>>>>>        //AB-DDOStart
39470>>>>>>>
39470>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39472>>>>>>>        End_Object    // Ctypkin_DD
39473>>>>>>>
39473>>>>>>>        Set Main_DD to (Ctypkin_DD(self))
39474>>>>>>>        Set Server to (Ctypkin_DD(self))
39475>>>>>>>
39475>>>>>>>        //AB-DDOEnd
39475>>>>>>>
39475>>>>>>>        Object oSelList is a dbListSub
39477>>>>>>>            Set Main_File to Ctypkin.File_Number
39478>>>>>>>            Set Size to 105 465
39479>>>>>>>            Set Location to 6 6
39480>>>>>>>
39480>>>>>>>            Begin_Row
39483>>>>>>>                Entry_Item Ctypkin.Ctypkin_recr
39484>>>>>>>                Entry_Item Ctypkin.Ctypkin_code
39485>>>>>>>                Entry_Item Ctypkin.Ctypkin_descr
39486>>>>>>>                Entry_Item Ctypkin.Ctypkin_anti
39487>>>>>>>            End_Row
39492>>>>>>>
39492>>>>>>>            Set Form_Width    item 0 to 72
39493>>>>>>>            Set Header_Label  item 0 to "RecR"
39494>>>>>>>            
39494>>>>>>>            Set Form_Width    item 1 to 58
39495>>>>>>>            Set Header_Label  item 1 to "Ctypkin code"
39496>>>>>>>            
39496>>>>>>>            Set Form_Width    item 2 to 209
39497>>>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
39498>>>>>>>            
39498>>>>>>>            Set Form_Width    item 3 to 120
39499>>>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
39500>>>>>>>            
39500>>>>>>>
39500>>>>>>>            //AB-StoreStart
39500>>>>>>>            
39500>>>>>>>            Set Column_Option Item 0 to Noenter True
39501>>>>>>>            
39501>>>>>>>            //AB-StoreEnd
39501>>>>>>>
39501>>>>>>>        End_Object    // oSelList
39502>>>>>>>
39502>>>>>>>        Object oOK_bn is a ButtonSub
39504>>>>>>>            set label to "&„§ ¢¦šã" 
39505>>>>>>>            Set Location to 114 312
39506>>>>>>>
39506>>>>>>>            //AB-StoreStart
39506>>>>>>>            Procedure OnClick
39508>>>>>>>                Send OK To (oSelList(current_object))
39509>>>>>>>            End_Procedure
39510>>>>>>>            //AB-StoreEnd
39510>>>>>>>
39510>>>>>>>        End_Object    // oOK_bn
39511>>>>>>>
39511>>>>>>>        Object oCancel_bn is a ButtonSub
39513>>>>>>>            set label to "&€¡ç¨à©ž" 
39514>>>>>>>            Set Location to 114 367
39515>>>>>>>
39515>>>>>>>            //AB-StoreStart
39515>>>>>>>            Procedure OnClick
39517>>>>>>>                Send Cancel To (oSelList(current_object))
39518>>>>>>>            End_Procedure
39519>>>>>>>            //AB-StoreEnd
39519>>>>>>>
39519>>>>>>>        End_Object    // oCancel_bn
39520>>>>>>>
39520>>>>>>>        Object oSearch_bn is a ButtonSub
39522>>>>>>>            set label to "€&¤˜ã«ž©ž" 
39523>>>>>>>            Set Location to 114 422
39524>>>>>>>
39524>>>>>>>            //AB-StoreStart
39524>>>>>>>            Procedure OnClick
39526>>>>>>>                Send Search To (oSelList(current_object))
39527>>>>>>>            End_Procedure
39528>>>>>>>            //AB-StoreEnd
39528>>>>>>>
39528>>>>>>>        End_Object    // oSearch_bn
39529>>>>>>>
39529>>>>>>>
39529>>>>>>>        //AB-StoreStart
39529>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39530>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39531>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39532>>>>>>>        //AB-StoreEnd
39532>>>>>>>
39532>>>>>>>    CD_End_Object    // sl007r
39534>>>>>>>>
39534>>>>>>>
39534>>>>>>>//AB/     End_Object    // prj
39534>>>>>
39534>>>>>//DDB-Selection-pkg-End
39534>>>>>//DDB-FileEnd
39534>>>Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
39534>>>>>//DDB-FileStart
39534>>>>>//DDB-HeaderStart
39534>>>>>
39534>>>>>// File Name : BAXIOKAT.DD
39534>>>>>// Class Name: Baxiokat_DataDictionary
39534>>>>>// Revision  : 45
39534>>>>>// Version   : 2
39534>>>>>
39534>>>>>Use  Windows           // Basic Definitions
39534>>>>>Use  DataDict          // DataDictionary Class Definition
39534>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39534>>>>>
39534>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
39536>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
39538>>>>>Open Bkinkat
39540>>>>>Open Tpclient
39542>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
39544>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
39546>>>>>Open Sysrecb
39548>>>>>
39548>>>>>//DDB-HeaderEnd
39548>>>>>//DDB-ValidationStart
39548>>>>>
39548>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
39548>>>>>
39548>>>>>Register_Object Baxiokat_Type_VT
39548>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
39548>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
39548>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
39548>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
39548>>>>>
39548>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
39550>>>>>
39550>>>>>    Procedure Fill_List
39552>>>>>        Forward Send Fill_List
39554>>>>>        Send Add_Table_Value  "0"  "Ž® "
39555>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
39556>>>>>    End_Procedure    // Fill_List
39557>>>>>    //DDB-ValidationCustomStart
39557>>>>>    //DDB-ValidationCustomEnd
39557>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
39558>>>>>
39558>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
39560>>>>>    Set Type_Value        To "BANK"
39561>>>>>    Set Allow_Blank_State To TRUE
39562>>>>>    //DDB-ValidationCustomStart
39562>>>>>    //DDB-ValidationCustomEnd
39562>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
39563>>>>>
39563>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
39565>>>>>    Set Allow_Blank_State To TRUE
39566>>>>>
39566>>>>>    Procedure Fill_List
39568>>>>>        Forward Send Fill_List
39570>>>>>        Send Add_Table_Value  "0"  ""
39571>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
39572>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
39573>>>>>    End_Procedure    // Fill_List
39574>>>>>    //DDB-ValidationCustomStart
39574>>>>>    //DDB-ValidationCustomEnd
39574>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
39575>>>>>//DDB-ValidationEnd
39575>>>>>//DDB-SelectionStart
39575>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
39575>>>>>Register_Object SL034
39575>>>>>//DDB-SelectionEnd
39575>>>>>
39575>>>>>Open Syscurxr
39577>>>>>Open Btypkin
39579>>>>>Open Bkinkat
39581>>>>>
39581>>>>>
39581>>>>>// Apo Baxio_DD
39581>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
39581>>>>>//
39581>>>>>
39581>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
39582>>>>>
39582>>>>>     Procedure Creating
39583>>>>>        Forward Send Creating
39585>>>>>        // Insert Code Here
39585>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
39586>>>>>    End_Procedure   // Creating
39587>>>>>
39587>>>>>     Procedure Construct_Object
39588>>>>>               Forward Send Construct_Object
39590>>>>>
39590>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
39590>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39590>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
39590>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
39590>>>>>               Property Integer piBarticl_dd  0
39591>>>>>               Property Integer piBmove_dd    0
39592>>>>>               Property Integer piBaxio_dd    0
39593>>>>>               Property Integer piBtypkin_dd 0
39594>>>>>     End_Procedure   //construct_object
39595>>>>>
39595>>>>>
39595>>>>>     //private
39595>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
39595>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
39595>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
39596>>>>>               String lsBaxio_C_Code_2
39597>>>>>        PROCEDURE_RETURN
39598>>>>>//jsjsjs 24/01/2001
39598>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
39598>>>>>
39598>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
39598>>>>>//jsjsjs 24/01/2001
39598>>>>>     End_Procedure //private.exit_baxiokat_code
39599>>>>>
39599>>>>>
39599>>>>>    //private
39599>>>>>    //¡˜¢œå«˜  ˜§æ:
39599>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
39599>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
39600>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
39601>>>>>
39601>>>>>        PROCEDURE_RETURN
39602>>>>>
39602>>>>>
39602>>>>>    End_Procedure //private.entry_gtypkin_code
39603>>>>>
39603>>>>>
39603>>>>>
39603>>>>>
39603>>>>>    Procedure Update
39604>>>>>          Forward Send Update
39606>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
39608>>>>>               Move "" to Baxiokat.Baxiokat_Bank
39609>>>>>               Move "" to Baxiokat.Baxiokat_Lno
39610>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
39611>>>>>          End
39611>>>>>>
39611>>>>>    End_Procedure
39612>>>>>
39612>>>>>
39612>>>>>    Procedure Define_Fields
39613>>>>>        Forward Send Define_Fields
39615>>>>>        //DDB-Generated-Code-Location
39615>>>>>        //DDB-DefineFieldStart
39615>>>>>
39615>>>>>        Set Main_File            To Baxiokat.File_Number
39616>>>>>        Set Cascade_Delete_State To FALSE
39617>>>>>
39617>>>>>
39617>>>>>        // Child (Client) file structure................
39617>>>>>        Send Add_Client_File  Baxio.File_Number
39618>>>>>        Send Add_Client_File  Bkinkat.File_Number
39619>>>>>        Send Add_Client_File  Tpclient.File_Number
39620>>>>>        Send Add_Client_File  Tperga.File_Number
39621>>>>>        Send Add_Client_File  Tparticl.File_Number
39622>>>>>
39622>>>>>        // External (System) file structure.............
39622>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39623>>>>>
39623>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
39626>>>>>
39626>>>>>        // Field-based properties.......................
39626>>>>>
39626>>>>>        // Baxiokat.Baxiokat_Code
39626>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
39627>>>>>
39627>>>>>        // Baxiokat.Baxiokat_Descr
39627>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
39628>>>>>
39628>>>>>        // Baxiokat.Baxiokat_Rec0
39628>>>>>
39628>>>>>        // Baxiokat.Baxiokat_Recr
39628>>>>>
39628>>>>>        // Baxiokat.Baxiokat_Type
39628>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
39629>>>>>
39629>>>>>        // Baxiokat.Baxio_Lcode
39629>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
39629>>>>>
39629>>>>>        // Baxiokat.Baxiokat_Yn5390
39629>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
39630>>>>>
39630>>>>>        // Baxiokat.Baxiokat_Bank
39630>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
39631>>>>>
39631>>>>>        // Baxiokat.Baxiokat_Lno
39631>>>>>
39631>>>>>        // Baxiokat.Baxiokat_Formul
39631>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
39632>>>>>
39632>>>>>        //DDB-DefineFieldEnd
39632>>>>>
39632>>>>>        Set Main_File            To Baxiokat.File_Number
39633>>>>>        Set Cascade_Delete_State To FALSE
39634>>>>>
39634>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39635>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39636>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39637>>>>>
39637>>>>>        // Child (Client) file structure................
39637>>>>>        Send Add_Client_File  Baxio.File_Number
39638>>>>>        Send Add_Client_File  Bkinkat.File_Number
39639>>>>>
39639>>>>>        // External (System) file structure.............
39639>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39640>>>>>
39640>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
39643>>>>>
39643>>>>>        // Field-based properties.......................
39643>>>>>
39643>>>>>        // Baxiokat.Baxiokat_Code
39643>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
39644>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
39645>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
39646>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
39647>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
39648>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
39649>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
39650>>>>>
39650>>>>>        // Baxiokat.Baxiokat_Descr
39650>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
39651>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
39652>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
39653>>>>>
39653>>>>>        // Baxiokat.Baxiokat_Rec0
39653>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
39654>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
39655>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
39656>>>>>
39656>>>>>        // Baxiokat.Baxiokat_Type
39656>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
39657>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
39658>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
39659>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
39660>>>>>
39660>>>>>        // Baxiokat.Baxio_Lcode
39660>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
39661>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
39662>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
39662>>>>>
39662>>>>>        // Baxiokat.Baxiokat_Yn5390
39662>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
39663>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
39664>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
39665>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
39666>>>>>
39666>>>>>        // Baxiokat.Baxiokat_Bank
39666>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
39667>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
39668>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
39669>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
39670>>>>>
39670>>>>>        // Baxiokat.Baxiokat_Lno
39670>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
39671>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
39672>>>>>
39672>>>>>        // Baxiokat.Baxiokat_Formul
39672>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
39673>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
39674>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
39675>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
39676>>>>>
39676>>>>>    End_Procedure    // Define_Fields
39677>>>>>
39677>>>>>
39677>>>>>    Procedure Field_Defaults
39678>>>>>        Forward Send Field_Defaults
39680>>>>>        //DDB-Generated-Code-Location
39680>>>>>        //DDB-FieldDefaultStart
39680>>>>>        //DDB-FieldDefaultEnd
39680>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
39681>>>>>    End_Procedure    // Field_Defaults
39682>>>>>
39682>>>>>End_Class    // Baxiokat_DataDictionary
39683>>>>>//DDB-Selection-pkg-Start
39683>>>>>
39683>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
39683>>>>>>>//AB/ Project SL034:BAXIOKAT
39683>>>>>>>//AB/ Object prj is a Lookup_Project
39683>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
39683>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
39683>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39683>>>>>>>
39683>>>>>>>// Project Object Structure
39683>>>>>>>//   SL034 is a dbModalPanelSub
39683>>>>>>>//     Baxiokat_DD is a DataDictionary
39683>>>>>>>//     oSelList is a dbListSub
39683>>>>>>>//     oOK_bn is a ButtonSub
39683>>>>>>>//     oCancel_bn is a ButtonSub
39683>>>>>>>//     oSearch_bn is a ButtonSub
39683>>>>>>>
39683>>>>>>>// Register all objects
39683>>>>>>>Register_Object Baxiokat_DD
39683>>>>>>>Register_Object oCancel_bn
39683>>>>>>>Register_Object oOK_bn
39683>>>>>>>Register_Object oSearch_bn
39683>>>>>>>Register_Object oSelList
39683>>>>>>>Register_Object SL034
39683>>>>>>>
39683>>>>>>>
39683>>>>>>>//AB-IgnoreStart
39683>>>>>>>
39683>>>>>>>Use DFAllEnt.pkg
39683>>>>>>>Use dbList.Sub
39683>>>>>>>Use Button.Sub
39683>>>>>>>
39683>>>>>>>
39683>>>>>>>Use BAXIOKAT.DD
39683>>>>>>>
39683>>>>>>>//AB-IgnoreEnd
39683>>>>>>>
39683>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
39702>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
39703>>>>>>>    Set Size to 206 347
39704>>>>>>>    Set Location to 4 5
39705>>>>>>>    Set Exit_Application_Local_State to FALSE
39706>>>>>>>    Set Modal_State to FALSE
39707>>>>>>>
39707>>>>>>>    //AB-DDOStart
39707>>>>>>>
39707>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
39709>>>>>>>    End_Object    // Baxiokat_DD
39710>>>>>>>
39710>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
39711>>>>>>>    Set Server to (Baxiokat_DD(self))
39712>>>>>>>
39712>>>>>>>    //AB-DDOEnd
39712>>>>>>>
39712>>>>>>>    Object oSelList is a dbListSub
39714>>>>>>>        Set Main_File to Baxiokat.File_Number
39715>>>>>>>        Set Size to 164 335
39716>>>>>>>        Set Location to 5 4
39717>>>>>>>
39717>>>>>>>        Begin_Row
39720>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
39721>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
39722>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
39723>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
39724>>>>>>>        End_Row
39729>>>>>>>
39729>>>>>>>        Set Form_Width    item 0 to 55
39730>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
39731>>>>>>>
39731>>>>>>>        Set Form_Width    item 1 to 172
39732>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
39733>>>>>>>
39733>>>>>>>        Set Form_Width    item 2 to 16
39734>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
39735>>>>>>>
39735>>>>>>>        Set Form_Width    item 3 to 83
39736>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
39737>>>>>>>
39737>>>>>>>    End_Object    // oSelList
39738>>>>>>>
39738>>>>>>>    Object oOK_bn is a ButtonSub
39740>>>>>>>        set label to "&„§ ¢¦šã" 
39741>>>>>>>        Set Location to 172 180
39742>>>>>>>
39742>>>>>>>        //AB-StoreStart
39742>>>>>>>        Procedure OnClick
39744>>>>>>>            Send OK To oSelList
39745>>>>>>>        End_Procedure
39746>>>>>>>        //AB-StoreEnd
39746>>>>>>>
39746>>>>>>>    End_Object    // oOK_bn
39747>>>>>>>
39747>>>>>>>    Object oCancel_bn is a ButtonSub
39749>>>>>>>        set label to "&€¡ç¨à©ž" 
39750>>>>>>>        Set Location to 172 234
39751>>>>>>>
39751>>>>>>>        //AB-StoreStart
39751>>>>>>>        Procedure OnClick
39753>>>>>>>            Send Cancel To oSelList
39754>>>>>>>        End_Procedure
39755>>>>>>>        //AB-StoreEnd
39755>>>>>>>
39755>>>>>>>    End_Object    // oCancel_bn
39756>>>>>>>
39756>>>>>>>    Object oSearch_bn is a ButtonSub
39758>>>>>>>        set label to "€&¤˜ã«ž©ž" 
39759>>>>>>>        Set Location to 172 289
39760>>>>>>>
39760>>>>>>>        //AB-StoreStart
39760>>>>>>>        Procedure OnClick
39762>>>>>>>            Send Search To oSelList
39763>>>>>>>        End_Procedure
39764>>>>>>>        //AB-StoreEnd
39764>>>>>>>
39764>>>>>>>    End_Object    // oSearch_bn
39765>>>>>>>
39765>>>>>>>
39765>>>>>>>    //AB-StoreStart
39765>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
39766>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
39767>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
39768>>>>>>>    //AB-StoreEnd
39768>>>>>>>
39768>>>>>>>CD_End_Object    // SL034
39770>>>>>>>>
39770>>>>>>>
39770>>>>>>>//AB/ End_Object    // prj
39770>>>>>
39770>>>>>//DDB-Selection-pkg-End
39770>>>>>//DDB-FileEnd
39770>>>Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
39770>>>>>//DDB-FileStart
39770>>>>>//DDB-HeaderStart
39770>>>>>
39770>>>>>// File Name : BARTICL.DD
39770>>>>>// Class Name: Barticl_DataDictionary
39770>>>>>// Revision  : 92
39770>>>>>// Version   : 2
39770>>>>>
39770>>>>>Use  Windows           // Basic Definitions
39770>>>>>Use  DataDict          // DataDictionary Class Definition
39770>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39770>>>>>
39770>>>>>Open Barticl
39772>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
39774>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
39776>>>>>Open Btypkin
39778>>>>>Open Sysrecb
39780>>>>>Open Cn
39782>>>>>
39782>>>>>//DDB-HeaderEnd
39782>>>>>//DDB-ValidationStart
39782>>>>>
39782>>>>>Register_Object Barticl_Barticl_M_Code_VT
39782>>>>>
39782>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
39784>>>>>    Set Type_Value        To "MODULE"
39785>>>>>    Set Allow_Blank_State To TRUE
39786>>>>>    //DDB-ValidationCustomStart
39786>>>>>    //DDB-ValidationCustomEnd
39786>>>>>End_Object   // Barticl_Barticl_M_Code_VT
39787>>>>>//DDB-ValidationEnd
39787>>>>>//DDB-SelectionStart
39787>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
39787>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
39787>>>>>Register_Object Barticl
39787>>>>>Register_Object sl041
39787>>>>>//DDB-SelectionEnd
39787>>>>>
39787>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
39788>>>>>
39788>>>>>    Procedure Shmera integer iField  Date dDate
39789>>>>>        Local Integer Changed
39790>>>>>        Get Field_Changed_State iField to Changed
39791>>>>>        If (Changed=0 AND dDate =0) Begin
39793>>>>>            SysDate4 dDate
39794>>>>>            Set Field_Default_Value iField to dDate
39795>>>>>        End
39795>>>>>>
39795>>>>>    End_Procedure   // Shmera
39796>>>>>
39796>>>>>    Procedure Save_Main_File
39797>>>>>        If (Barticl.Cn_Code<>'') Begin  
39799>>>>>            Clear Cn   
39800>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
39801>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code  
39802>>>>>>
39802>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
39803>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
39804>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
39805>>>>>        End
39805>>>>>>
39805>>>>>        Forward Send Save_Main_File
39807>>>>>    End_Procedure   // Save_Main_File
39808>>>>>
39808>>>>>      Procedure private.Initialize_Properties
39809>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
39809>>>>>                 Set psB_Btypkin_Recr    to ''
39810>>>>>                 Set pdB_Barticl_Hmnia   to 0
39811>>>>>                 Set piB_Barticl_No      to 0
39812>>>>>                 Set psB_Barticl_Code1   to ""
39813>>>>>
39813>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39814>>>>>                 Set piB_Garticl_No      to 0
39815>>>>>                 Set psB_Garticl_Aitiol  to ""
39816>>>>>
39816>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
39816>>>>>                 Set psA_Btypkin_Recr    to ''
39817>>>>>                 Set pdA_Barticl_Hmnia   to 0
39818>>>>>                 Set piA_Barticl_No      to 0
39819>>>>>                 Set psA_Barticl_Code1   to ""
39820>>>>>
39820>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39821>>>>>                 Set piA_Garticl_No      to 0
39822>>>>>                 Set psA_Garticl_Aitiol  to ""
39823>>>>>
39823>>>>>                 Set psB_Gplan_Code to ""
39824>>>>>                 Set psA_Gplan_Code to ""
39825>>>>>
39825>>>>>      End_Procedure //private.Initialize_Properties
39826>>>>>
39826>>>>>
39826>>>>>      Procedure Construct_Object
39827>>>>>                Forward Send Construct_Object
39829>>>>>
39829>>>>>                Property String  psA_Btypkin_Recr     ''
39830>>>>>                Property Date    pdA_Barticl_Hmnia    0
39831>>>>>                Property Integer piA_Barticl_No       0
39832>>>>>                Property String  psB_Barticl_Code1    ""
39833>>>>>
39833>>>>>                Property String  psB_Btypkin_Recr     ''
39834>>>>>                Property Date    pdB_Barticl_Hmnia    0
39835>>>>>                Property Integer piB_Barticl_No       0
39836>>>>>                Property String  psA_Barticl_Code1    ""
39837>>>>>
39837>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39838>>>>>                Property Integer piA_Garticl_No       0
39839>>>>>                Property String  psA_Garticl_Aitiol   ''
39840>>>>>
39840>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39841>>>>>                Property Integer piB_Garticl_No       0
39842>>>>>                Property String  psB_Garticl_Aitiol   ''
39843>>>>>
39843>>>>>
39843>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
39844>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39844>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
39844>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
39845>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39845>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
39845>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
39846>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39846>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
39846>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
39847>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39847>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
39847>>>>>
39847>>>>>                Property String  psB_Gplan_Code
39848>>>>>                Property String  psA_Gplan_Code
39849>>>>>
39849>>>>>
39849>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
39850>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
39850>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
39850>>>>>
39850>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
39851>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
39851>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
39852>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
39852>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
39853>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
39853>>>>>      End_Procedure   //construct_object
39854>>>>>
39854>>>>>      Procedure Update
39855>>>>>                Integer liBAxio_dd liBaxiokat_dd
39856>>>>>                Forward Send Update
39858>>>>>
39858>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
39858>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
39859>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
39860>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
39861>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
39862>>>>>
39862>>>>>
39862>>>>>                //™) ˜¤áš¤à©ž properties
39862>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
39863>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
39864>>>>>
39864>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
39864>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
39864>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
39865>>>>>
39865>>>>>                Case Begin
39865>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
39867>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
39868>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
39869>>>>>                      Case Break
39870>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
39873>>>>>                        Move ""                    to Barticl.Barticl_Code2
39874>>>>>                        Move ""                    to Barticl.Barticl_Epon2
39875>>>>>                      Case Break
39876>>>>>                Case End
39876>>>>>
39876>>>>>
39876>>>>>                Case Begin
39876>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
39878>>>>>                        Clear Clients
39879>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
39880>>>>>                        Find Eq Clients by Index.6 //Client_ID
39881>>>>>>
39881>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
39884>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
39886>>>>>                      Case Break
39887>>>>>                Case End
39887>>>>>
39887>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
39889>>>>>                      //master gplan rec0
39889>>>>>                      Case Begin
39889>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
39891>>>>>//jsjsjs 24/01/2001
39891>>>>>//                                Clear Gplan
39891>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
39891>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
39891>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
39891>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
39891>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
39891>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
39891>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
39891>>>>>//jsjsjs 24/01/2001
39891>>>>>                           Case Break
39892>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
39892>>>>>                                Move 0 to Barticl.Gplan_Mrec0
39893>>>>>                      Case End
39893>>>>>                End   //please check the logic
39893>>>>>>
39893>>>>>
39893>>>>>
39893>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
39893>>>>>
39893>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
39893>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
39894>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
39895>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
39896>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
39897>>>>>
39897>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39898>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
39899>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
39900>>>>>
39900>>>>>      End_Procedure   //update
39901>>>>>
39901>>>>>
39901>>>>>      Procedure Backout
39902>>>>>                Forward Send Backout
39904>>>>>
39904>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
39904>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
39905>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
39906>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
39907>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
39908>>>>>
39908>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39909>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
39910>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
39911>>>>>      End_Procedure   // backout
39912>>>>>
39912>>>>>
39912>>>>>      Procedure Creating
39913>>>>>                Forward Send Creating
39915>>>>>
39915>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39915>>>>>
39915>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
39916>>>>>
39916>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
39919>>>>>
39919>>>>>                //************************************************************************
39919>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
39919>>>>>                //************************************************************************
39919>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
39921>>>>>                      Add 1 to Btypkin.Btypkin_L_No
39922>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
39923>>>>>                     End
39923>>>>>>
39923>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
39924>>>>>                     End
39924>>>>>>
39924>>>>>                if ((btypkin.locked=1) and (barticl.barticl_hmnia ge btypkin.locked_date)) error 1966 '† ¡å¤ž©ž œå¤˜  ¡¢œ ›à£â¤ž' 
39927>>>>>                
39927>>>>>                move 1 to barticl.ekkremes
39928>>>>>                
39928>>>>>                
39928>>>>>                Set piCreated_Barticl to TRUE
39929>>>>>      End_Procedure //creating
39930>>>>>
39930>>>>>
39930>>>>>      Procedure Deleting
39931>>>>>                Forward Send Deleting
39933>>>>>
39933>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39933>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
39935>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
39936>>>>>                  // js 05/09/2002
39936>>>>>                  Saverecord Btypkin
39937>>>>>                End
39937>>>>>>
39937>>>>>      End_Procedure //deleting
39938>>>>>
39938>>>>>
39938>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
39939>>>>>                String lsError_Message
39940>>>>>                Case Begin
39940>>>>>                     //˜§æ validate save
39940>>>>>                     Case (iError_Num = 1001)
39942>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
39943>>>>>                     Case Break
39944>>>>>                     Case (iError_Num = 1002)
39947>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
39948>>>>>                     Case Break
39949>>>>>                     Case (iError_Num = 1003)
39952>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
39953>>>>>                     Case Break
39954>>>>>                     Case (iError_Num = 1004)
39957>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39958>>>>>                     Case Break
39959>>>>>                     Case (iError_Num = 1005)
39962>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39963>>>>>                     Case Break
39964>>>>>                     Case (iError_Num = 1006)
39967>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39968>>>>>                     Case Break
39969>>>>>                     Case (iError_Num = 1007)
39972>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
39973>>>>>                     Case Break
39974>>>>>                     Case (iError_Num = 1008)
39977>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
39978>>>>>                     Case Break
39979>>>>>                     Case (iError_Num = 1009)
39982>>>>>                          Clear Codemast
39983>>>>>                          Move "MODULE" to Codemast.Type
39984>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
39985>>>>>                          Find Eq Codemast by Index.1 //type+code
39986>>>>>>
39986>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
39987>>>>>                     Case Break
39988>>>>>                     Case (iError_Num = 1011)
39991>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
39992>>>>>                     Case Break
39993>>>>>                     Case (iError_Num = 1100)
39996>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39997>>>>>                          Case Break
39998>>>>>                     
39998>>>>>                     Case (iError_Num = 2100)
40001>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
40002>>>>>                          Case Break
40003>>>>>
40003>>>>>                   //˜§æ update
40003>>>>>                   Case (iError_Num = 3001)
40006>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
40007>>>>>                   Case Break
40008>>>>>                   Case (iError_Num = 3002)
40011>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
40012>>>>>                   Case Break
40013>>>>>                   Case (iError_Num = 3003)
40016>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
40017>>>>>                   Case Break
40018>>>>>
40018>>>>>                   Case (iError_Num = 1330)
40021>>>>>                          Move "DDC 036: €¨ Ÿ£æª .€.„. £ž›œ¤ ¡æª ã †£œ¨/¤å˜ .€.„. ¡œ¤ã" to lsError_Message
40022>>>>>                   Case Break
40023>>>>>
40023>>>>>                   Case (iError_Num = 1331)
40026>>>>>                          Move "DDC 036: †£œ¨/¤å˜ .€.„. ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
40027>>>>>                   Case Break
40028>>>>>
40028>>>>>                   Case (iError_Num = 1332)
40031>>>>>                          Move "DDC 036: †£œ¨/¤å˜ §˜¨˜©«˜« ¡¦ç ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
40032>>>>>                   Case Break
40033>>>>>
40033>>>>>                     Case Else
40033>>>>>                          Forward Send Operation_Not_Allowed iError_Num
40035>>>>>                Case End
40035>>>>>
40035>>>>>                Error iError_Num lsError_Message
40036>>>>>>
40036>>>>>      End_Procedure // operation_not_allowed
40037>>>>>
40037>>>>>      Function Validate_Save Returns Integer
40038>>>>>               Integer iReturnVal  
40039>>>>>               Date dShmera
40039>>>>>               Sysdate dShmera
40040>>>>>
40040>>>>>               Forward Get Validate_Save to iReturnVal
40042>>>>>               //Set piCreated_Barticl to 0
40042>>>>>
40042>>>>>               If (Not(iReturnVal));               Begin
40044>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
40044>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
40047>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
40050>>>>>
40050>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
40050>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
40053>>>>>                
40053>>>>>                
40053>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
40053>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
40056>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
40056>>>>>
40056>>>>>                //---------â¢œš®¦  create barticl record----------------------
40056>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
40056>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
40058>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
40058>>>>>>
40058>>>>>
40058>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
40058>>>>>                Else;                Begin //edit an existing record
40059>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
40059>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
40062>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
40062>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
40065>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
40065>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
40068>>>>>
40068>>>>>
40068>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
40068>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
40071>>>>>
40071>>>>>
40071>>>>>
40071>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
40071>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
40074>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
40074>>>>>>
40074>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
40077>>>>>
40077>>>>>               End //«â¢¦ª ¡é› ¡˜ validation         
40077>>>>>>
40077>>>>>               
40077>>>>>                If (sysfile.serial_number='1') Begin
40079>>>>>                    If ((Barticl.PAE_Arithm=0) Or (Barticl.PAE_Hmnia=""))   Send Operation_Not_Allowed 1330
40082>>>>>                    If (Barticl.PAE_Hmnia>dShmera)                          Send Operation_Not_Allowed 1331
40085>>>>>                End
40085>>>>>>
40085>>>>>
40085>>>>>                If (Barticl.Barticl_Hmnia>dShmera)                          Send Operation_Not_Allowed 1332
40088>>>>>               
40088>>>>>               Function_Return iReturnVal
40089>>>>>      End_Function   // validate_save
40090>>>>>
40090>>>>>
40090>>>>>      Function Validate_Delete  Returns Integer
40091>>>>>               Integer iReturnVal
40092>>>>>               Forward Get Validate_Delete  To iReturnVal
40094>>>>>               If (Not(iReturnVal));               Begin
40096>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
40099>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
40099>>>>>>
40099>>>>>               Function_Return iReturnVal
40100>>>>>      End_Function   // Validate_Delete
40101>>>>>
40101>>>>>
40101>>>>>
40101>>>>>      Procedure Request_Save
40102>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
40103>>>>>
40103>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
40104>>>>>
40104>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
40104>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
40104>>>>>               If ((Current_Record(Self)) = 0) Begin
40106>>>>>                    Forward Send Request_Save
40108>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
40109>>>>>                    Procedure_Return
40110>>>>>               End
40110>>>>>>
40110>>>>>
40110>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
40110>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
40110>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
40110>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
40110>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
40110>>>>>
40110>>>>>               BEGIN_TRANSACTION
40111>>>>>               Move Error_Object_ID to iErrorObj
40112>>>>>               Forward Send Request_Save
40114>>>>>
40114>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
40114>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
40115>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
40116>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
40117>>>>>
40117>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
40118>>>>>
40118>>>>>               END_TRANSACTION
40119>>>>>               Move iErrorObj to Error_Object_ID
40120>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
40121>>>>>
40121>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
40121>>>>>               Indicate Err False
40122>>>>>     End_Procedure   // request_save
40123>>>>>
40123>>>>>
40123>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
40123>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
40123>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
40123>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
40124>>>>>               Integer liBmove_dd
40125>>>>>
40125>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
40125>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
40125>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
40125>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
40125>>>>>
40125>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
40125>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
40126>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
40127>>>>>               Get piB_Barticl_No      to liB_Barticl_No
40128>>>>>
40128>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
40128>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
40129>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
40130>>>>>               Get piA_Barticl_No      to liA_Barticl_No
40131>>>>>
40131>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
40131>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
40131>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
40131>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
40133>>>>>                      Procedure_Return
40134>>>>>                     End
40134>>>>>>
40134>>>>>
40134>>>>>
40134>>>>>               //**************************************************************************
40134>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
40134>>>>>               //**************************************************************************
40134>>>>>               Get piBmove_dd           to liBmove_dd
40135>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
40136>>>>>               Send Rebuild_Constraints to Self
40137>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
40138>>>>>               Send Rebuild_Constraints to liBmove_dd
40139>>>>>
40139>>>>>               //**************************************************************************
40139>>>>>               //03.©á¨à©ž Bmove
40139>>>>>               //**************************************************************************
40139>>>>>               Send Clear to liBmove_dd
40140>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
40141>>>>>               While (Found=1)
40145>>>>>                      Send Request_Save to liBmove_dd
40146>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
40147>>>>>               Loop
40148>>>>>>
40148>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
40149>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
40149>>>>>     End_Procedure //private.transaction_cascade_update_bmove
40150>>>>>
40150>>>>>
40150>>>>>
40150>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
40150>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
40150>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
40150>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
40150>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
40151>>>>>
40151>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
40152>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
40152>>>>>
40152>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
40152>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
40152>>>>>
40152>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
40152>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
40153>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
40154>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
40155>>>>>
40155>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
40155>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
40156>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
40157>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
40158>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
40159>>>>>
40159>>>>>     End_Procedure //private.transaction_update_other_modules
40160>>>>>
40160>>>>>
40160>>>>>    Procedure Define_Fields
40161>>>>>        Forward Send Define_Fields
40163>>>>>        //DDB-Generated-Code-Location
40163>>>>>        //DDB-DefineFieldStart
40163>>>>>
40163>>>>>        Set Main_File            To Barticl.File_Number
40164>>>>>        Set Cascade_Delete_State To FALSE
40165>>>>>
40165>>>>>
40165>>>>>        // Child (Client) file structure................
40165>>>>>        Send Add_Client_File  Bmove.File_Number
40166>>>>>        Send Add_Client_File  Bsum.File_Number
40167>>>>>
40167>>>>>        // Parent (Server) file structure...............
40167>>>>>        Send Add_Server_File  Btypkin.File_Number
40168>>>>>
40168>>>>>        // External (System) file structure.............
40168>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
40169>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
40170>>>>>
40170>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
40173>>>>>
40173>>>>>        // Field-based properties.......................
40173>>>>>
40173>>>>>        // Barticl.Company_Code
40173>>>>>
40173>>>>>        // Barticl.Branch_Code
40173>>>>>
40173>>>>>        // Barticl.Year_Year
40173>>>>>
40173>>>>>        // Barticl.Btypkin_Code
40173>>>>>
40173>>>>>        // Barticl.Barticl_Hmnia
40173>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
40174>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
40175>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
40176>>>>>
40176>>>>>        // Barticl.Barticl_No
40176>>>>>
40176>>>>>        // Barticl.Barticl_Rec0
40176>>>>>
40176>>>>>        // Barticl.Barticl_Recr
40176>>>>>
40176>>>>>        // Barticl.Btypkin_Recr
40176>>>>>
40176>>>>>        // Barticl.Barticl_Code1
40176>>>>>
40176>>>>>        // Barticl.Barticl_Epon1
40176>>>>>
40176>>>>>        // Barticl.Barticl_Code2
40176>>>>>
40176>>>>>        // Barticl.Barticl_Epon2
40176>>>>>
40176>>>>>        // Barticl.Barticl_Aitiol
40176>>>>>
40176>>>>>        // Barticl.Barticl_Sv2
40176>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40176>>>>>
40176>>>>>        // Barticl.Barticl_Sv0
40176>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40176>>>>>
40176>>>>>        // Barticl.Barticl_Sv00
40176>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40176>>>>>
40176>>>>>        // Barticl.Barticl_Svr
40176>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40176>>>>>
40176>>>>>        // Barticl.Barticl_Lines
40176>>>>>
40176>>>>>        // Barticl.Barticl_Bmovela
40176>>>>>
40176>>>>>        // Barticl.Barticl_M_Code
40176>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
40177>>>>>
40177>>>>>        // Barticl.Garticl_Rec0
40177>>>>>
40177>>>>>        // Barticl.Carticl_Rec0
40177>>>>>
40177>>>>>        // Barticl.Varticl_Rec0
40177>>>>>
40177>>>>>        // Barticl.Gmove_Mrec0
40177>>>>>
40177>>>>>        // Barticl.Gplan_Mrec0
40177>>>>>
40177>>>>>        // Barticl.Client_Mrecr
40177>>>>>
40177>>>>>        // Barticl.Barticl_Ekleise
40177>>>>>
40177>>>>>        // Barticl.Cmoves_Recr
40177>>>>>
40177>>>>>        // Barticl.Isotimia
40177>>>>>
40177>>>>>        // Barticl.Cn_Code
40177>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
40178>>>>>
40178>>>>>        // Barticl.Cn_Descr
40178>>>>>
40178>>>>>        // Barticl.Cn_Recr
40178>>>>>
40178>>>>>        // Barticl.Sls_Id
40178>>>>>
40178>>>>>        // Barticl.Cnt_Id
40178>>>>>
40178>>>>>        // Barticl.Presp_Id
40178>>>>>
40178>>>>>        // Barticl.Se_Logik
40178>>>>>
40178>>>>>        // Barticl.Sxolia1
40178>>>>>
40178>>>>>        // Barticl.Sxolia2
40178>>>>>
40178>>>>>        // Barticl.Partl_Akyr_Recr
40178>>>>>
40178>>>>>        // Barticl.Ekkremes
40178>>>>>
40178>>>>>        // Barticl.Arith_Orist
40178>>>>>
40178>>>>>        // Barticl.Hmnia_Orist
40178>>>>>
40178>>>>>        // Barticl.Pae_Arithm
40178>>>>>
40178>>>>>        // Barticl.Pae_Hmnia
40178>>>>>
40178>>>>>        //DDB-DefineFieldEnd
40178>>>>>
40178>>>>>//        Set Main_File            To Barticl.File_Number
40178>>>>>
40178>>>>>//        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
40178>>>>>//        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
40178>>>>>//        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40178>>>>>
40178>>>>>//        // Child (Client) file structure................
40178>>>>>//        Send Add_Client_File  Bsum.File_Number
40178>>>>>//        Send Add_Client_File  Bmove.File_Number
40178>>>>>
40178>>>>>//        // Parent (Server) file structure...............
40178>>>>>//        Send Add_Server_File  Btypkin.File_Number
40178>>>>>
40178>>>>>//        // External (System) file structure.............
40178>>>>>//        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
40178>>>>>//        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
40178>>>>>
40178>>>>>//        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
40178>>>>>
40178>>>>>        // Field-based properties.......................
40178>>>>>
40178>>>>>        // Barticl.Company_Code
40178>>>>>
40178>>>>>        // Barticl.Branch_Code
40178>>>>>
40178>>>>>        // Barticl.Year_Year
40178>>>>>
40178>>>>>        // Barticl.Btypkin_Code
40178>>>>>
40178>>>>>        // Barticl.Barticl_Hmnia
40178>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
40179>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
40180>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
40181>>>>>
40181>>>>>        // Barticl.Barticl_No
40181>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
40182>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
40183>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
40184>>>>>
40184>>>>>        // Barticl.Barticl_Rec0
40184>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
40185>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
40186>>>>>
40186>>>>>        // Barticl.Btypkin_Rec0
40186>>>>>
40186>>>>>        // Barticl.Barticl_Code1
40186>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
40187>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
40188>>>>>
40188>>>>>        // Barticl.Barticl_Epon1
40188>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
40189>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
40190>>>>>
40190>>>>>        // Barticl.Barticl_Code2
40190>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
40191>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
40192>>>>>
40192>>>>>        // Barticl.Barticl_Epon2
40192>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
40193>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
40194>>>>>
40194>>>>>        // Barticl.Barticl_Aitiol
40194>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
40195>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
40196>>>>>
40196>>>>>        // Barticl.Barticl_Sv2
40196>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
40197>>>>>
40197>>>>>        // Barticl.Barticl_Sv0
40197>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
40198>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
40199>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
40200>>>>>
40200>>>>>        // Barticl.Barticl_Sv00
40200>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
40201>>>>>
40201>>>>>        // Barticl.Barticl_Svr
40201>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
40202>>>>>
40202>>>>>        // Barticl.Barticl_Lines
40202>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
40203>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
40204>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
40205>>>>>
40205>>>>>        // Barticl.Barticl_Bmovela
40205>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
40206>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
40207>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
40208>>>>>
40208>>>>>        // Barticl.Barticl_M_Code
40208>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
40209>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
40210>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
40211>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
40212>>>>>
40212>>>>>        // Barticl.Garticl_Rec0
40212>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
40213>>>>>
40213>>>>>        // Barticl.Carticl_Rec0
40213>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
40214>>>>>
40214>>>>>        // Barticl.Varticl_Rec0
40214>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
40215>>>>>
40215>>>>>        // Barticl.Gmove_Mrec0
40215>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
40216>>>>>
40216>>>>>        // Barticl.Gplan_Mrec0
40216>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
40217>>>>>
40217>>>>>    End_Procedure    // Define_Fields
40218>>>>>
40218>>>>>
40218>>>>>    Procedure Field_Defaults
40219>>>>>        Forward Send Field_Defaults
40221>>>>>        //DDB-Generated-Code-Location
40221>>>>>        //DDB-FieldDefaultStart
40221>>>>>        Set Field_Changed_Value   Field Barticl.Ekkremes To 1
40222>>>>>        //DDB-FieldDefaultEnd
40222>>>>>    End_Procedure    // Field_Defaults
40223>>>>>
40223>>>>>End_Class    // Barticl_DataDictionary
40224>>>>>//DDB-Selection-pkg-Start
40224>>>>>
40224>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
40224>>>>>>>//AB/ Project Barticl:Lookup
40224>>>>>>>//AB/ Object prj is a Lookup_Project
40224>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
40224>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
40224>>>>>>>
40224>>>>>>>// Project Object Structure
40224>>>>>>>//   Barticl is a dbModalPanelSub
40224>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
40224>>>>>>>//     Btypkin_DD is a DataDictionary
40224>>>>>>>//     Barticl_DD is a DataDictionary
40224>>>>>>>//     Country_DD is a DataDictionary
40224>>>>>>>//     Towns_DD is a DataDictionary
40224>>>>>>>//     Cities_DD is a DataDictionary
40224>>>>>>>//     Areas_DD is a DataDictionary
40224>>>>>>>//     Payresp_DD is a DataDictionary
40224>>>>>>>//     Clients_DD is a DataDictionary
40224>>>>>>>//     oSelList is a dbListSub
40224>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
40224>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
40224>>>>>>>//     Clients_Client_Name is a dbFormSub
40224>>>>>>>//     cSyDateForm1 is a cSyDateForm
40224>>>>>>>//     chkOpen is a CheckBoxSub
40224>>>>>>>//     ButtonSub1 is a ButtonSub
40224>>>>>>>//     oOK_bn is a ButtonSub
40224>>>>>>>//     oCancel_bn is a ButtonSub
40224>>>>>>>
40224>>>>>>>// Register all objects
40224>>>>>>>Register_Object Areas_DD
40224>>>>>>>Register_Object Barticl
40224>>>>>>>Register_Object Barticl_DD
40224>>>>>>>Register_Object Btypkin_Btypkin_Code
40224>>>>>>>Register_Object Btypkin_Btypkin_Descr
40224>>>>>>>Register_Object Btypkin_DD
40224>>>>>>>Register_Object Btypkin_DD2
40224>>>>>>>Register_Object ButtonSub1
40224>>>>>>>Register_Object Cities_DD
40224>>>>>>>Register_Object Clients_Client_Name
40224>>>>>>>Register_Object Clients_DD
40224>>>>>>>Register_Object Country_DD
40224>>>>>>>Register_Object chkOpen
40224>>>>>>>Register_Object cSyDateForm1
40224>>>>>>>Register_Object oCancel_bn
40224>>>>>>>Register_Object oOK_bn
40224>>>>>>>Register_Object oSelList
40224>>>>>>>Register_Object Payresp_DD
40224>>>>>>>Register_Object Towns_DD
40224>>>>>>>
40224>>>>>>>
40224>>>>>>>//AB-IgnoreStart
40224>>>>>>>
40224>>>>>>>Use DFAllEnt.pkg
40224>>>>>>>Use dbList.Sub
40224>>>>>>>Use dbForm.Sub
40224>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
40224>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
40224>>>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
40224>>>>>>>>>>>>>//AB/ Project Calendar Outlook
40224>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40224>>>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
40224>>>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>// Project Object Structure
40224>>>>>>>>>>>>>//   oCalendar is a BasicPanelSub
40224>>>>>>>>>>>>>//     Container3d1 is a Container3d
40224>>>>>>>>>>>>>//       Grid2 is a Grid
40224>>>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
40224>>>>>>>>>>>>>//       Textbox2 is a Textbox
40224>>>>>>>>>>>>>//       Textbox3 is a Textbox
40224>>>>>>>>>>>>>//       Textbox4 is a Textbox
40224>>>>>>>>>>>>>//       Textbox5 is a Textbox
40224>>>>>>>>>>>>>//       Textbox6 is a Textbox
40224>>>>>>>>>>>>>//       Textbox7 is a Textbox
40224>>>>>>>>>>>>>//       Textbox8 is a Textbox
40224>>>>>>>>>>>>>//       LineControl1 is a LineControl
40224>>>>>>>>>>>>>//       Container3d2 is a Container3d
40224>>>>>>>>>>>>>//         oRght is a BitmapContainer
40224>>>>>>>>>>>>>//         oLeft is a BitmapContainer
40224>>>>>>>>>>>>>//         oMonth is a Textbox
40224>>>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
40224>>>>>>>>>>>>>//         oCalendarYear is a Textbox
40224>>>>>>>>>>>>>//         oSelectCalendarYear is a Form
40224>>>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
40224>>>>>>>>>>>>>//     oToday is a Textbox
40224>>>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
40224>>>>>>>>>>>>>//     Help_Container is a Container3d
40224>>>>>>>>>>>>>//       Help_Info is a Edit
40224>>>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>// Register all objects
40224>>>>>>>>>>>>>Register_Object BitmapContainer3
40224>>>>>>>>>>>>>Register_Object Container3d1
40224>>>>>>>>>>>>>Register_Object Container3d2
40224>>>>>>>>>>>>>Register_Object cOutlookFloatingMenu
40224>>>>>>>>>>>>>Register_Object Grid2
40224>>>>>>>>>>>>>Register_Object Help_Container
40224>>>>>>>>>>>>>Register_Object Help_Info
40224>>>>>>>>>>>>>Register_Object HelpFloatingMenu
40224>>>>>>>>>>>>>Register_Object LineControl1
40224>>>>>>>>>>>>>Register_Object oCalendar
40224>>>>>>>>>>>>>Register_Object oCalendarYear
40224>>>>>>>>>>>>>Register_Object oCloseCalendar_bn
40224>>>>>>>>>>>>>Register_Object oLeft
40224>>>>>>>>>>>>>Register_Object oMonth
40224>>>>>>>>>>>>>Register_Object oRght
40224>>>>>>>>>>>>>Register_Object oSelectCalendarYear
40224>>>>>>>>>>>>>Register_Object oSelectMonth
40224>>>>>>>>>>>>>Register_Object oToday
40224>>>>>>>>>>>>>Register_Object Textbox2
40224>>>>>>>>>>>>>Register_Object Textbox3
40224>>>>>>>>>>>>>Register_Object Textbox4
40224>>>>>>>>>>>>>Register_Object Textbox5
40224>>>>>>>>>>>>>Register_Object Textbox6
40224>>>>>>>>>>>>>Register_Object Textbox7
40224>>>>>>>>>>>>>Register_Object Textbox8
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    //AB-StoreTopStart
40224>>>>>>>>>>>>>    Use dates.utl
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    //AB-StoreTopEnd
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    //AB-IgnoreStart
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    Use Panel.Sub
40224>>>>>>>>>>>>>    Use DFAllEnt.pkg
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    //AB-IgnoreEnd
40224>>>>>>>>>>>>>
40224>>>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
40226>>>>>>>>>>>>>        Set Border_Style to Border_Normal
40227>>>>>>>>>>>>>        Set Caption_Bar to FALSE
40228>>>>>>>>>>>>>        Set Label to "January, 2001"
40229>>>>>>>>>>>>>        Set Size to 98 123
40230>>>>>>>>>>>>>        Set Location to 10 22
40231>>>>>>>>>>>>>        Set Color to clWhite
40232>>>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
40233>>>>>>>>>>>>>        Set Popup_State to TRUE
40234>>>>>>>>>>>>>
40234>>>>>>>>>>>>>        //AB-DDOStart
40234>>>>>>>>>>>>>
40234>>>>>>>>>>>>>
40234>>>>>>>>>>>>>        //AB-DDOEnd
40234>>>>>>>>>>>>>
40234>>>>>>>>>>>>>        Object Container3d1 is a Container3d
40236>>>>>>>>>>>>>            Set Size to 88 135
40237>>>>>>>>>>>>>            Set Location to -2 -1
40238>>>>>>>>>>>>>            Set Color to clWhite
40239>>>>>>>>>>>>>            Set Border_Style to Border_None
40240>>>>>>>>>>>>>            Object Grid2 is a Grid
40242>>>>>>>>>>>>>
40242>>>>>>>>>>>>>                //AB-StoreTopStart
40242>>>>>>>>>>>>>                property date    p_current_date     0
40244>>>>>>>>>>>>>                property integer p_current_year     -1
40246>>>>>>>>>>>>>                property integer p_current_month    -1
40248>>>>>>>>>>>>>                property integer p_selected_day     -1
40250>>>>>>>>>>>>>                property integer pExportState       1
40252>>>>>>>>>>>>>                property integer invoking_object_id 0
40254>>>>>>>>>>>>>                Property integer piCurrentDayItem   -1
40256>>>>>>>>>>>>>
40256>>>>>>>>>>>>>                Set Border_Style To BORDER_NONE
40257>>>>>>>>>>>>>                Set header_visible_state To False
40258>>>>>>>>>>>>>                set select_mode to no_select
40259>>>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
40260>>>>>>>>>>>>>
40260>>>>>>>>>>>>>                on_key Key_F1 Send Help
40261>>>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
40262>>>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
40263>>>>>>>>>>>>>                on_key          key_pgup send prev_month
40264>>>>>>>>>>>>>                on_key          key_pgdn send next_month
40265>>>>>>>>>>>>>                on_key key_enter         send move_value_out
40266>>>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
40267>>>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
40268>>>>>>>>>>>>>
40268>>>>>>>>>>>>>                //AB-StoreTopEnd
40268>>>>>>>>>>>>>
40268>>>>>>>>>>>>>                Set Color to clWhite
40269>>>>>>>>>>>>>                Set CurrentCellColor to clWhite
40270>>>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
40271>>>>>>>>>>>>>                Set Size to 61 145
40272>>>>>>>>>>>>>                Set Location to 30 1
40273>>>>>>>>>>>>>                Set Resize_Column_state to FALSE
40274>>>>>>>>>>>>>
40274>>>>>>>>>>>>>                Set Line_Width to 7 0
40275>>>>>>>>>>>>>
40275>>>>>>>>>>>>>                Set Form_Width    item 0 to 18
40276>>>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
40277>>>>>>>>>>>>>
40277>>>>>>>>>>>>>                Set Form_Width    item 1 to 18
40278>>>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
40279>>>>>>>>>>>>>
40279>>>>>>>>>>>>>                Set Form_Width    item 2 to 18
40280>>>>>>>>>>>>>                Set Header_Label  item 2 to "We"
40281>>>>>>>>>>>>>
40281>>>>>>>>>>>>>                Set Form_Width    item 3 to 18
40282>>>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
40283>>>>>>>>>>>>>
40283>>>>>>>>>>>>>                Set Form_Width    item 4 to 18
40284>>>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
40285>>>>>>>>>>>>>
40285>>>>>>>>>>>>>                Set Form_Width    item 5 to 18
40286>>>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
40287>>>>>>>>>>>>>
40287>>>>>>>>>>>>>                Set Form_Width    item 6 to 18
40288>>>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
40289>>>>>>>>>>>>>
40289>>>>>>>>>>>>>
40289>>>>>>>>>>>>>                //AB-StoreStart
40289>>>>>>>>>>>>>
40289>>>>>>>>>>>>>                Procedure Change_Year
40291>>>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
40292>>>>>>>>>>>>>                End_Procedure // Change_Year
40293>>>>>>>>>>>>>
40293>>>>>>>>>>>>>                procedure go_today
40295>>>>>>>>>>>>>                    Date date#
40296>>>>>>>>>>>>>                    sysdate4 date#
40297>>>>>>>>>>>>>                    set p_current_date to date#
40298>>>>>>>>>>>>>                    Send Update_Calendar
40299>>>>>>>>>>>>>                end_procedure
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>                procedure next_month
40302>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
40303>>>>>>>>>>>>>                    Send Update_Calendar
40304>>>>>>>>>>>>>                end_procedure
40305>>>>>>>>>>>>>
40305>>>>>>>>>>>>>                procedure prev_month
40307>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
40308>>>>>>>>>>>>>                    Send Update_Calendar
40309>>>>>>>>>>>>>                end_procedure
40310>>>>>>>>>>>>>
40310>>>>>>>>>>>>>                procedure next_year
40312>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
40313>>>>>>>>>>>>>                    Send Update_Calendar
40314>>>>>>>>>>>>>                end_procedure
40315>>>>>>>>>>>>>
40315>>>>>>>>>>>>>                procedure prev_year
40317>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
40318>>>>>>>>>>>>>                    Send Update_Calendar
40319>>>>>>>>>>>>>                end_procedure
40320>>>>>>>>>>>>>
40320>>>>>>>>>>>>>                Procedure Activate
40322>>>>>>>>>>>>>                    Date date#
40323>>>>>>>>>>>>>                    Forward Send Activate
40325>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40326>>>>>>>>>>>>>                End_Procedure
40327>>>>>>>>>>>>>
40327>>>>>>>>>>>>>                Procedure Update_Calendar
40329>>>>>>>>>>>>>                    Set Dynamic_Update_State To False
40330>>>>>>>>>>>>>                    send Fill_List
40331>>>>>>>>>>>>>                    Set Dynamic_Update_State To True
40332>>>>>>>>>>>>>                    // Send Update_Label
40332>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40333>>>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
40334>>>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
40335>>>>>>>>>>>>>                End_Procedure
40336>>>>>>>>>>>>>
40336>>>>>>>>>>>>>                Procedure Fill_List
40338>>>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
40339>>>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
40339>>>>>>>>>>>>>                    Date dToday
40339>>>>>>>>>>>>>                    Send Delete_Data
40340>>>>>>>>>>>>>
40340>>>>>>>>>>>>>                    Get p_current_date to date#
40341>>>>>>>>>>>>>
40341>>>>>>>>>>>>>                    SysDate4 dToday
40342>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
40343>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
40344>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
40345>>>>>>>>>>>>>
40345>>>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
40346>>>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
40347>>>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
40348>>>>>>>>>>>>>                    Set p_current_month To sel_month#
40349>>>>>>>>>>>>>                    Set p_current_year To sel_year#
40350>>>>>>>>>>>>>
40350>>>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
40351>>>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
40352>>>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
40353>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
40354>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
40355>>>>>>>>>>>>>
40355>>>>>>>>>>>>>                    If (first_item# > 0) Begin
40357>>>>>>>>>>>>>                        Move (first_item#-1) to day#
40358>>>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
40364>>>>>>>>>>>>>>
40364>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
40365>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
40366>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40367>>>>>>>>>>>>>                            Decrement day#
40368>>>>>>>>>>>>>                        Loop
40369>>>>>>>>>>>>>>
40369>>>>>>>>>>>>>                    End
40369>>>>>>>>>>>>>>
40369>>>>>>>>>>>>>
40369>>>>>>>>>>>>>                    Move 1 To day#
40370>>>>>>>>>>>>>                    For iFor from first_item# to last_item#
40376>>>>>>>>>>>>>>
40376>>>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
40377>>>>>>>>>>>>>                        Set Entry_State Item iFor To False
40378>>>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
40380>>>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
40381>>>>>>>>>>>>>                            Set piCurrentDayItem to iFor
40382>>>>>>>>>>>>>                        End
40382>>>>>>>>>>>>>>
40382>>>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
40385>>>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
40386>>>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
40387>>>>>>>>>>>>>                        Set form_Mask item iFor To "## "
40388>>>>>>>>>>>>>                        Increment day#
40389>>>>>>>>>>>>>                    Loop
40390>>>>>>>>>>>>>>
40390>>>>>>>>>>>>>
40390>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
40391>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
40392>>>>>>>>>>>>>
40392>>>>>>>>>>>>>                    If (last_item# < 41) Begin
40394>>>>>>>>>>>>>                        Move 1 to day#
40395>>>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
40401>>>>>>>>>>>>>>
40401>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
40402>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
40403>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40404>>>>>>>>>>>>>                            Increment day#
40405>>>>>>>>>>>>>                        Loop
40406>>>>>>>>>>>>>>
40406>>>>>>>>>>>>>                    End
40406>>>>>>>>>>>>>>
40406>>>>>>>>>>>>>
40406>>>>>>>>>>>>>                End_Procedure
40407>>>>>>>>>>>>>
40407>>>>>>>>>>>>>                Procedure Help
40409>>>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
40409>>>>>>>>>>>>>                    Set Visible_State of Help_Container to True
40410>>>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
40411>>>>>>>>>>>>>                    Send Activate to Help_Container
40412>>>>>>>>>>>>>                End_Procedure
40413>>>>>>>>>>>>>
40413>>>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
40415>>>>>>>>>>>>>                    Send Move_Value_Out
40416>>>>>>>>>>>>>                    forward send mouse_click window char_pos
40418>>>>>>>>>>>>>                end_procedure
40419>>>>>>>>>>>>>
40419>>>>>>>>>>>>>                Procedure Move_Value_Out
40421>>>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
40422>>>>>>>>>>>>>                    Date Date# next_date# prev_date#
40422>>>>>>>>>>>>>                    Get Current_Item To iItm
40423>>>>>>>>>>>>>                    If (pExportState(Self)) Begin
40425>>>>>>>>>>>>>                        Get Value Item iItm To iDay
40426>>>>>>>>>>>>>                        Get p_current_month to iMonth
40427>>>>>>>>>>>>>                        Get p_current_year  to iYear
40428>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40429>>>>>>>>>>>>>
40429>>>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
40431>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
40432>>>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
40433>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
40434>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
40435>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40436>>>>>>>>>>>>>                        End
40436>>>>>>>>>>>>>>
40436>>>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
40438>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
40439>>>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
40440>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
40441>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
40442>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40443>>>>>>>>>>>>>                        End
40443>>>>>>>>>>>>>>
40443>>>>>>>>>>>>>
40443>>>>>>>>>>>>>                        Send Export_Date date#
40444>>>>>>>>>>>>>                    End
40444>>>>>>>>>>>>>>
40444>>>>>>>>>>>>>                End_Procedure
40445>>>>>>>>>>>>>
40445>>>>>>>>>>>>>                Procedure Export_Date date date#
40447>>>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
40448>>>>>>>>>>>>>                    get invoking_object_id to focus#
40449>>>>>>>>>>>>>
40449>>>>>>>>>>>>>                    if focus# gt desktop begin
40451>>>>>>>>>>>>>                         get delegation_mode of focus# to dm#
40452>>>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
40453>>>>>>>>>>>>>                         get form_margin of focus# item current to margin#
40454>>>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
40455>>>>>>>>>>>>>                         set delegation_mode of focus# to dm#
40456>>>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
40459>>>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
40461>>>>>>>>>>>>>                         set item_changed_state of focus# item current to true
40462>>>>>>>>>>>>>                    end
40462>>>>>>>>>>>>>>
40462>>>>>>>>>>>>>                    Send Close_Calendar
40463>>>>>>>>>>>>>                End_Procedure
40464>>>>>>>>>>>>>
40464>>>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
40466>>>>>>>>>>>>>
40466>>>>>>>>>>>>>                    Procedure Close_Calendar
40468>>>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
40469>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
40470>>>>>>>>>>>>>
40470>>>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
40471>>>>>>>>>>>>>                    Send Add_item msg_None             ""
40472>>>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
40473>>>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
40474>>>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
40475>>>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
40476>>>>>>>>>>>>>                    Send Add_item msg_None             ""
40477>>>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
40478>>>>>>>>>>>>>                    Send Add_item msg_None             ""
40479>>>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
40480>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40481>>>>>>>>>>>>>
40481>>>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
40482>>>>>>>>>>>>>
40482>>>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
40484>>>>>>>>>>>>>                    Integer new_item liMonth
40485>>>>>>>>>>>>>                    Date    ldSysdate
40485>>>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
40487>>>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
40489>>>>>>>>>>>>>                        If (new_item >= 0) Begin
40491>>>>>>>>>>>>>                            Sysdate4 ldSysdate
40492>>>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
40493>>>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
40496>>>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
40498>>>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
40501>>>>>>>>>>>>>                        End
40501>>>>>>>>>>>>>>
40501>>>>>>>>>>>>>                    End
40501>>>>>>>>>>>>>>
40501>>>>>>>>>>>>>                    procedure_return new_item
40502>>>>>>>>>>>>>                End_Procedure // Current_Item
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>                //AB-StoreEnd
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>            End_Object    // Grid2
40504>>>>>>>>>>>>>
40504>>>>>>>>>>>>>            Object Textbox2 is a Textbox
40506>>>>>>>>>>>>>                Set Label to "Mo"
40507>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40508>>>>>>>>>>>>>                Set Transparent_State to TRUE
40509>>>>>>>>>>>>>                Set Color to clWhite
40510>>>>>>>>>>>>>                Set TextColor to clNavy
40511>>>>>>>>>>>>>                Set Location to 19 4
40512>>>>>>>>>>>>>                Set Size to 10 15
40513>>>>>>>>>>>>>
40513>>>>>>>>>>>>>                //AB-StoreStart
40513>>>>>>>>>>>>>
40513>>>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
40514>>>>>>>>>>>>>                //AB-StoreEnd
40514>>>>>>>>>>>>>
40514>>>>>>>>>>>>>            End_Object    // Textbox2
40515>>>>>>>>>>>>>
40515>>>>>>>>>>>>>            Object Textbox3 is a Textbox
40517>>>>>>>>>>>>>                Set Label to "Tu"
40518>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40519>>>>>>>>>>>>>                Set Transparent_State to TRUE
40520>>>>>>>>>>>>>                Set Color to clWhite
40521>>>>>>>>>>>>>                Set TextColor to clNavy
40522>>>>>>>>>>>>>                Set Location to 19 22
40523>>>>>>>>>>>>>                Set Size to 10 12
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>                //AB-StoreStart
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
40525>>>>>>>>>>>>>                //AB-StoreEnd
40525>>>>>>>>>>>>>
40525>>>>>>>>>>>>>            End_Object    // Textbox3
40526>>>>>>>>>>>>>
40526>>>>>>>>>>>>>            Object Textbox4 is a Textbox
40528>>>>>>>>>>>>>                Set Label to "We"
40529>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40530>>>>>>>>>>>>>                Set Transparent_State to TRUE
40531>>>>>>>>>>>>>                Set Color to clWhite
40532>>>>>>>>>>>>>                Set TextColor to clNavy
40533>>>>>>>>>>>>>                Set Location to 19 39
40534>>>>>>>>>>>>>                Set Size to 10 15
40535>>>>>>>>>>>>>
40535>>>>>>>>>>>>>                //AB-StoreStart
40535>>>>>>>>>>>>>
40535>>>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
40536>>>>>>>>>>>>>                //AB-StoreEnd
40536>>>>>>>>>>>>>
40536>>>>>>>>>>>>>            End_Object    // Textbox4
40537>>>>>>>>>>>>>
40537>>>>>>>>>>>>>            Object Textbox5 is a Textbox
40539>>>>>>>>>>>>>                Set Label to "Th"
40540>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40541>>>>>>>>>>>>>                Set Transparent_State to TRUE
40542>>>>>>>>>>>>>                Set Color to clWhite
40543>>>>>>>>>>>>>                Set TextColor to clNavy
40544>>>>>>>>>>>>>                Set Location to 19 57
40545>>>>>>>>>>>>>                Set Size to 10 17
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>                //AB-StoreStart
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
40547>>>>>>>>>>>>>                //AB-StoreEnd
40547>>>>>>>>>>>>>
40547>>>>>>>>>>>>>            End_Object    // Textbox5
40548>>>>>>>>>>>>>
40548>>>>>>>>>>>>>            Object Textbox6 is a Textbox
40550>>>>>>>>>>>>>                Set Label to "Fr"
40551>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40552>>>>>>>>>>>>>                Set Transparent_State to TRUE
40553>>>>>>>>>>>>>                Set Color to clWhite
40554>>>>>>>>>>>>>                Set TextColor to clNavy
40555>>>>>>>>>>>>>                Set Location to 19 76
40556>>>>>>>>>>>>>                Set Size to 10 17
40557>>>>>>>>>>>>>
40557>>>>>>>>>>>>>                //AB-StoreStart
40557>>>>>>>>>>>>>
40557>>>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
40558>>>>>>>>>>>>>                //AB-StoreEnd
40558>>>>>>>>>>>>>
40558>>>>>>>>>>>>>            End_Object    // Textbox6
40559>>>>>>>>>>>>>
40559>>>>>>>>>>>>>            Object Textbox7 is a Textbox
40561>>>>>>>>>>>>>                Set Label to "Sa"
40562>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40563>>>>>>>>>>>>>                Set Transparent_State to TRUE
40564>>>>>>>>>>>>>                Set Color to clWhite
40565>>>>>>>>>>>>>                Set TextColor to clNavy
40566>>>>>>>>>>>>>                Set Location to 19 91
40567>>>>>>>>>>>>>                Set Size to 10 18
40568>>>>>>>>>>>>>
40568>>>>>>>>>>>>>                //AB-StoreStart
40568>>>>>>>>>>>>>
40568>>>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
40569>>>>>>>>>>>>>                //AB-StoreEnd
40569>>>>>>>>>>>>>
40569>>>>>>>>>>>>>            End_Object    // Textbox7
40570>>>>>>>>>>>>>
40570>>>>>>>>>>>>>            Object Textbox8 is a Textbox
40572>>>>>>>>>>>>>                Set Label to "Su"
40573>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40574>>>>>>>>>>>>>                Set Transparent_State to TRUE
40575>>>>>>>>>>>>>                Set Color to clWhite
40576>>>>>>>>>>>>>                Set TextColor to clNavy
40577>>>>>>>>>>>>>                Set Location to 19 109
40578>>>>>>>>>>>>>                Set Size to 10 17
40579>>>>>>>>>>>>>
40579>>>>>>>>>>>>>                //AB-StoreStart
40579>>>>>>>>>>>>>
40579>>>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
40580>>>>>>>>>>>>>                //AB-StoreEnd
40580>>>>>>>>>>>>>
40580>>>>>>>>>>>>>            End_Object    // Textbox8
40581>>>>>>>>>>>>>
40581>>>>>>>>>>>>>            Object LineControl1 is a LineControl
40583>>>>>>>>>>>>>                Set Line_Style to lnSINGLE
40584>>>>>>>>>>>>>                Set Size to 1 116
40585>>>>>>>>>>>>>                Set Location to 28 4
40586>>>>>>>>>>>>>
40586>>>>>>>>>>>>>                //AB-StoreStart
40586>>>>>>>>>>>>>
40586>>>>>>>>>>>>>                //AB-StoreEnd
40586>>>>>>>>>>>>>
40586>>>>>>>>>>>>>            End_Object    // LineControl1
40587>>>>>>>>>>>>>
40587>>>>>>>>>>>>>            Object Container3d2 is a Container3d
40589>>>>>>>>>>>>>                Set Size to 18 131
40590>>>>>>>>>>>>>                Set Location to 1 1
40591>>>>>>>>>>>>>                Set Color to clNavy
40592>>>>>>>>>>>>>                Set Border_Style to Border_None
40593>>>>>>>>>>>>>                Object oRght is a BitmapContainer
40595>>>>>>>>>>>>>                    Set Size to 10 14
40596>>>>>>>>>>>>>                    Set Location to 4 105
40597>>>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
40598>>>>>>>>>>>>>                    Set Border_Style to Border_None
40599>>>>>>>>>>>>>
40599>>>>>>>>>>>>>                    //AB-StoreStart
40599>>>>>>>>>>>>>                    Procedure Mouse_Down
40601>>>>>>>>>>>>>                        Send Next_Month to Grid2
40602>>>>>>>>>>>>>                    End_Procedure
40603>>>>>>>>>>>>>                    //AB-StoreEnd
40603>>>>>>>>>>>>>
40603>>>>>>>>>>>>>                End_Object    // oRght
40604>>>>>>>>>>>>>
40604>>>>>>>>>>>>>                Object oLeft is a BitmapContainer
40606>>>>>>>>>>>>>                    Set Size to 10 14
40607>>>>>>>>>>>>>                    Set Location to 4 3
40608>>>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
40609>>>>>>>>>>>>>                    Set Border_Style to Border_None
40610>>>>>>>>>>>>>
40610>>>>>>>>>>>>>                    //AB-StoreStart
40610>>>>>>>>>>>>>                    Procedure Mouse_Down
40612>>>>>>>>>>>>>                        Send Prev_Month to Grid2
40613>>>>>>>>>>>>>                    End_Procedure
40614>>>>>>>>>>>>>                    //AB-StoreEnd
40614>>>>>>>>>>>>>
40614>>>>>>>>>>>>>                End_Object    // oLeft
40615>>>>>>>>>>>>>
40615>>>>>>>>>>>>>                Object oMonth is a Textbox
40617>>>>>>>>>>>>>
40617>>>>>>>>>>>>>                    //AB-StoreTopStart
40617>>>>>>>>>>>>>                    Property integer piSelected_Month public 0
40619>>>>>>>>>>>>>                    //AB-StoreTopEnd
40619>>>>>>>>>>>>>
40619>>>>>>>>>>>>>                    Set Label to "January"
40620>>>>>>>>>>>>>                    Set Auto_Size_State to FALSE
40621>>>>>>>>>>>>>                    Set Transparent_State to TRUE
40622>>>>>>>>>>>>>                    Set Color to clWhite
40623>>>>>>>>>>>>>                    Set TextColor to clWhite
40624>>>>>>>>>>>>>                    Set Location to 4 19
40625>>>>>>>>>>>>>                    Set Size to 10 46
40626>>>>>>>>>>>>>                    Set FontWeight to 800
40627>>>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
40628>>>>>>>>>>>>>
40628>>>>>>>>>>>>>                    //AB-StoreStart
40628>>>>>>>>>>>>>
40628>>>>>>>>>>>>>                    Procedure Mouse_Down
40630>>>>>>>>>>>>>                        Integer iState
40631>>>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
40632>>>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
40635>>>>>>>>>>>>>                        Send Popup to oSelectMonth
40636>>>>>>>>>>>>>                    End_Procedure
40637>>>>>>>>>>>>>
40637>>>>>>>>>>>>>                    Procedure pSelectJan
40639>>>>>>>>>>>>>                        Set Label to t.calendar.january
40640>>>>>>>>>>>>>                        Set piSelected_Month to 1
40641>>>>>>>>>>>>>                        Send Adjust_Calendar
40642>>>>>>>>>>>>>                    End_Procedure
40643>>>>>>>>>>>>>                    Procedure pSelectFeb
40645>>>>>>>>>>>>>                        Set Label to t.calendar.february
40646>>>>>>>>>>>>>                        Set piSelected_Month to 2
40647>>>>>>>>>>>>>                        Send Adjust_Calendar
40648>>>>>>>>>>>>>                    End_Procedure
40649>>>>>>>>>>>>>                    Procedure pSelectMar
40651>>>>>>>>>>>>>                        Set Label to t.calendar.march
40652>>>>>>>>>>>>>                        Set piSelected_Month to 3
40653>>>>>>>>>>>>>                        Send Adjust_Calendar
40654>>>>>>>>>>>>>                    End_Procedure
40655>>>>>>>>>>>>>                    Procedure pSelectApr
40657>>>>>>>>>>>>>                        Set Label to t.calendar.april
40658>>>>>>>>>>>>>                        Set piSelected_Month to 4
40659>>>>>>>>>>>>>                        Send Adjust_Calendar
40660>>>>>>>>>>>>>                    End_Procedure
40661>>>>>>>>>>>>>                    Procedure pSelectMay
40663>>>>>>>>>>>>>                        Set Label to t.calendar.may
40664>>>>>>>>>>>>>                        Set piSelected_Month to 5
40665>>>>>>>>>>>>>                        Send Adjust_Calendar
40666>>>>>>>>>>>>>                    End_Procedure
40667>>>>>>>>>>>>>                    Procedure pSelectJun
40669>>>>>>>>>>>>>                        Set Label to t.calendar.june
40670>>>>>>>>>>>>>                        Set piSelected_Month to 6
40671>>>>>>>>>>>>>                        Send Adjust_Calendar
40672>>>>>>>>>>>>>                    End_Procedure
40673>>>>>>>>>>>>>                    Procedure pSelectJul
40675>>>>>>>>>>>>>                        Set Label to t.calendar.july
40676>>>>>>>>>>>>>                        Set piSelected_Month to 7
40677>>>>>>>>>>>>>                        Send Adjust_Calendar
40678>>>>>>>>>>>>>                    End_Procedure
40679>>>>>>>>>>>>>                    Procedure pSelectAug
40681>>>>>>>>>>>>>                        Set Label to t.calendar.august
40682>>>>>>>>>>>>>                        Set piSelected_Month to 8
40683>>>>>>>>>>>>>                        Send Adjust_Calendar
40684>>>>>>>>>>>>>                    End_Procedure
40685>>>>>>>>>>>>>                    Procedure pSelectSep
40687>>>>>>>>>>>>>                        Set Label to t.calendar.september
40688>>>>>>>>>>>>>                        Set piSelected_Month to 9
40689>>>>>>>>>>>>>                        Send Adjust_Calendar
40690>>>>>>>>>>>>>                    End_Procedure
40691>>>>>>>>>>>>>                    Procedure pSelectOct
40693>>>>>>>>>>>>>                        Set Label to t.calendar.october
40694>>>>>>>>>>>>>                        Set piSelected_Month to 10
40695>>>>>>>>>>>>>                        Send Adjust_Calendar
40696>>>>>>>>>>>>>                    End_Procedure
40697>>>>>>>>>>>>>                    Procedure pSelectNov
40699>>>>>>>>>>>>>                        Set Label to t.calendar.november
40700>>>>>>>>>>>>>                        Set piSelected_Month to 11
40701>>>>>>>>>>>>>                        Send Adjust_Calendar
40702>>>>>>>>>>>>>                    End_Procedure
40703>>>>>>>>>>>>>                    Procedure pSelectDec
40705>>>>>>>>>>>>>                        Set Label to t.calendar.december
40706>>>>>>>>>>>>>                        Set piSelected_Month to 12
40707>>>>>>>>>>>>>                        Send Adjust_Calendar
40708>>>>>>>>>>>>>                    End_Procedure
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
40711>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
40712>>>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
40713>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
40714>>>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
40715>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
40716>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
40717>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
40718>>>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
40719>>>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
40720>>>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
40721>>>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
40722>>>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
40723>>>>>>>>>>>>>                    End_Object
40724>>>>>>>>>>>>>
40724>>>>>>>>>>>>>                    Procedure Adjust_Calendar
40726>>>>>>>>>>>>>                        Date date#
40727>>>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
40727>>>>>>>>>>>>>                        Set Visible_State to false
40728>>>>>>>>>>>>>                        Set Visible_State to true
40729>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40730>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40731>>>>>>>>>>>>>                        Get piSelected_Month to iMonth
40732>>>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
40733>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40734>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40735>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40736>>>>>>>>>>>>>                    End_Procedure
40737>>>>>>>>>>>>>
40737>>>>>>>>>>>>>                    Procedure Activating
40739>>>>>>>>>>>>>                        Forward Send Activating
40741>>>>>>>>>>>>>                        Send Date_Changing
40742>>>>>>>>>>>>>                    End_Procedure
40743>>>>>>>>>>>>>
40743>>>>>>>>>>>>>                    Procedure Date_Changing
40745>>>>>>>>>>>>>                        Set Visible_State to false
40746>>>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
40747>>>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
40748>>>>>>>>>>>>>                        Set Visible_State to true
40749>>>>>>>>>>>>>                    End_Procedure
40750>>>>>>>>>>>>>
40750>>>>>>>>>>>>>
40750>>>>>>>>>>>>>
40750>>>>>>>>>>>>>                    //AB-StoreEnd
40750>>>>>>>>>>>>>
40750>>>>>>>>>>>>>                End_Object    // oMonth
40751>>>>>>>>>>>>>
40751>>>>>>>>>>>>>                Object oCalendarYear is a Textbox
40753>>>>>>>>>>>>>                    Set Label to "2001"
40754>>>>>>>>>>>>>                    Set Transparent_State to TRUE
40755>>>>>>>>>>>>>                    Set Color to clWhite
40756>>>>>>>>>>>>>                    Set TextColor to clWhite
40757>>>>>>>>>>>>>                    Set Location to 4 77
40758>>>>>>>>>>>>>                    Set Size to 10 18
40759>>>>>>>>>>>>>                    Set FontWeight to 800
40760>>>>>>>>>>>>>
40760>>>>>>>>>>>>>                    //AB-StoreStart
40760>>>>>>>>>>>>>
40760>>>>>>>>>>>>>                    Procedure Mouse_Down
40762>>>>>>>>>>>>>                        String sVal
40763>>>>>>>>>>>>>                        Get Label to sVal
40764>>>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
40765>>>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
40766>>>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
40767>>>>>>>>>>>>>                    End_Procedure
40768>>>>>>>>>>>>>
40768>>>>>>>>>>>>>                    Procedure Activating
40770>>>>>>>>>>>>>                        Forward Send Activating
40772>>>>>>>>>>>>>                        Send Date_Changing
40773>>>>>>>>>>>>>                    End_Procedure
40774>>>>>>>>>>>>>
40774>>>>>>>>>>>>>                    Procedure Date_Changing
40776>>>>>>>>>>>>>                        Set Visible_State to false
40777>>>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
40778>>>>>>>>>>>>>                        Set Visible_State to true
40779>>>>>>>>>>>>>                    End_Procedure
40780>>>>>>>>>>>>>
40780>>>>>>>>>>>>>                    //AB-StoreEnd
40780>>>>>>>>>>>>>
40780>>>>>>>>>>>>>                End_Object    // oCalendarYear
40781>>>>>>>>>>>>>
40781>>>>>>>>>>>>>                Object oSelectCalendarYear is a Form
40783>>>>>>>>>>>>>
40783>>>>>>>>>>>>>                    //AB-StoreTopStart
40783>>>>>>>>>>>>>                    Set Visible_State To False
40784>>>>>>>>>>>>>                    //AB-StoreTopEnd
40784>>>>>>>>>>>>>
40784>>>>>>>>>>>>>                    Set Size to 10 24
40785>>>>>>>>>>>>>                    Set Location to 4 75
40786>>>>>>>>>>>>>                    Set Color to clWhite
40787>>>>>>>>>>>>>                    Set TextColor to clNavy
40788>>>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
40789>>>>>>>>>>>>>
40789>>>>>>>>>>>>>                    //AB-StoreStart
40789>>>>>>>>>>>>>
40789>>>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
40790>>>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
40791>>>>>>>>>>>>>
40791>>>>>>>>>>>>>                    Procedure SetFontWeight
40793>>>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
40794>>>>>>>>>>>>>                    End_Procedure
40795>>>>>>>>>>>>>
40795>>>>>>>>>>>>>                    Procedure OnKillFocus
40797>>>>>>>>>>>>>                        String sVal
40798>>>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
40798>>>>>>>>>>>>>                        Date date#
40798>>>>>>>>>>>>>                        Get Value item 0 to sVal
40799>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
40800>>>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
40801>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
40802>>>>>>>>>>>>>                        Set Visible_State to false
40803>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40804>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40805>>>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
40806>>>>>>>>>>>>>                        Get Value item 0 to iYear
40807>>>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
40810>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40811>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40812>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40813>>>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
40814>>>>>>>>>>>>>                    End_Procedure
40815>>>>>>>>>>>>>
40815>>>>>>>>>>>>>                    Send SetFontWeight
40816>>>>>>>>>>>>>
40816>>>>>>>>>>>>>
40816>>>>>>>>>>>>>
40816>>>>>>>>>>>>>                    //AB-StoreEnd
40816>>>>>>>>>>>>>
40816>>>>>>>>>>>>>                End_Object    // oSelectCalendarYear
40817>>>>>>>>>>>>>
40817>>>>>>>>>>>>>
40817>>>>>>>>>>>>>                //AB-StoreStart
40817>>>>>>>>>>>>>
40817>>>>>>>>>>>>>                Procedure Mouse_Down
40819>>>>>>>>>>>>>                    Integer iState
40820>>>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
40821>>>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
40824>>>>>>>>>>>>>                End_Procedure
40825>>>>>>>>>>>>>
40825>>>>>>>>>>>>>
40825>>>>>>>>>>>>>                //AB-StoreEnd
40825>>>>>>>>>>>>>
40825>>>>>>>>>>>>>            End_Object    // Container3d2
40826>>>>>>>>>>>>>
40826>>>>>>>>>>>>>
40826>>>>>>>>>>>>>            //AB-StoreStart
40826>>>>>>>>>>>>>
40826>>>>>>>>>>>>>
40826>>>>>>>>>>>>>            //AB-StoreEnd
40826>>>>>>>>>>>>>
40826>>>>>>>>>>>>>        End_Object    // Container3d1
40827>>>>>>>>>>>>>
40827>>>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
40829>>>>>>>>>>>>>            Set Size to 9 19
40830>>>>>>>>>>>>>            Set Location to 88 3
40831>>>>>>>>>>>>>            Set Color to clWhite
40832>>>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
40833>>>>>>>>>>>>>            Set Border_Style to Border_None
40834>>>>>>>>>>>>>
40834>>>>>>>>>>>>>            //AB-StoreStart
40834>>>>>>>>>>>>>            Procedure Mouse_Down
40836>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40837>>>>>>>>>>>>>                Send Adjust_Label to oToday
40838>>>>>>>>>>>>>            End_Procedure
40839>>>>>>>>>>>>>            //AB-StoreEnd
40839>>>>>>>>>>>>>
40839>>>>>>>>>>>>>        End_Object    // BitmapContainer3
40840>>>>>>>>>>>>>
40840>>>>>>>>>>>>>        Object oToday is a Textbox
40842>>>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
40843>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
40844>>>>>>>>>>>>>            Set Color to clWhite
40845>>>>>>>>>>>>>            Set Location to 88 22
40846>>>>>>>>>>>>>            Set Size to 8 70
40847>>>>>>>>>>>>>            Set FontWeight to 800
40848>>>>>>>>>>>>>
40848>>>>>>>>>>>>>            //AB-StoreStart
40848>>>>>>>>>>>>>            Procedure Mouse_Down
40850>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40851>>>>>>>>>>>>>                Send Adjust_Label
40852>>>>>>>>>>>>>            End_Procedure
40853>>>>>>>>>>>>>
40853>>>>>>>>>>>>>            Procedure Adjust_Label
40855>>>>>>>>>>>>>                date date#
40856>>>>>>>>>>>>>                SysDate4 date#
40857>>>>>>>>>>>>>                Set Visible_State To false
40858>>>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
40859>>>>>>>>>>>>>                Set Visible_State To true
40860>>>>>>>>>>>>>            End_Procedure
40861>>>>>>>>>>>>>
40861>>>>>>>>>>>>>            Procedure Activating
40863>>>>>>>>>>>>>                Forward Send Activating
40865>>>>>>>>>>>>>                Send Adjust_Label
40866>>>>>>>>>>>>>            End_Procedure
40867>>>>>>>>>>>>>            //AB-StoreEnd
40867>>>>>>>>>>>>>
40867>>>>>>>>>>>>>        End_Object    // oToday
40868>>>>>>>>>>>>>
40868>>>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
40870>>>>>>>>>>>>>            Set Size to 9 10
40871>>>>>>>>>>>>>            Set Location to 88 112
40872>>>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
40873>>>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
40874>>>>>>>>>>>>>
40874>>>>>>>>>>>>>            //AB-StoreStart
40874>>>>>>>>>>>>>
40874>>>>>>>>>>>>>            Procedure Mouse_Up
40876>>>>>>>>>>>>>                Send Close_Calendar
40877>>>>>>>>>>>>>            End_Procedure // Mouse_Up
40878>>>>>>>>>>>>>
40878>>>>>>>>>>>>>
40878>>>>>>>>>>>>>
40878>>>>>>>>>>>>>
40878>>>>>>>>>>>>>            //AB-StoreEnd
40878>>>>>>>>>>>>>
40878>>>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
40879>>>>>>>>>>>>>
40879>>>>>>>>>>>>>
40879>>>>>>>>>>>>>        //AB-StoreStart
40879>>>>>>>>>>>>>
40879>>>>>>>>>>>>>        Set Block_Mouse_State to True
40880>>>>>>>>>>>>>        Set Popup_State to True
40881>>>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
40882>>>>>>>>>>>>>
40882>>>>>>>>>>>>>        procedure popup
40884>>>>>>>>>>>>>            local integer focus# icItm iYear iMonth
40885>>>>>>>>>>>>>            local date date#
40885>>>>>>>>>>>>>            move (focus(desktop)) to focus#
40886>>>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
40887>>>>>>>>>>>>>            get value of focus# item current to date#
40888>>>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
40891>>>>>>>>>>>>>            move (Date2to4(date#)) to date#
40892>>>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
40893>>>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
40894>>>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
40895>>>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
40896>>>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
40897>>>>>>>>>>>>>            forward send popup
40899>>>>>>>>>>>>>        end_procedure
40900>>>>>>>>>>>>>
40900>>>>>>>>>>>>>        Procedure Close_Calendar
40902>>>>>>>>>>>>>            Send Close_Panel
40903>>>>>>>>>>>>>        End_Procedure // Close_Calendar
40904>>>>>>>>>>>>>
40904>>>>>>>>>>>>>        Object Help_Container is a Container3d
40906>>>>>>>>>>>>>            Set Location to 0 0
40907>>>>>>>>>>>>>            Set Size     to 98 122
40908>>>>>>>>>>>>>            Set Visible_State to False
40909>>>>>>>>>>>>>            Set Enabled_State to False
40910>>>>>>>>>>>>>            Set Border_Style to Border_None
40911>>>>>>>>>>>>>            Set TextColor to clNavy
40912>>>>>>>>>>>>>
40912>>>>>>>>>>>>>            Object Help_Info is an Edit
40914>>>>>>>>>>>>>                Set Location to 0 0
40915>>>>>>>>>>>>>                Set Size     to 98 122
40916>>>>>>>>>>>>>                Set read_only_state to true
40917>>>>>>>>>>>>>                Set Border_Style to Border_None
40918>>>>>>>>>>>>>                Set scroll_bar_visible_state to False
40919>>>>>>>>>>>>>                Set FontWeight to 800
40920>>>>>>>>>>>>>
40920>>>>>>>>>>>>>                Procedure ReadHelpComments
40922>>>>>>>>>>>>>                    String lsFile
40923>>>>>>>>>>>>>
40923>>>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
40924>>>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
40927>>>>>>>>>>>>>                End_Procedure // ReadHelpComments
40928>>>>>>>>>>>>>
40928>>>>>>>>>>>>>                Procedure SetComments
40930>>>>>>>>>>>>>                    Send append_text "Help on Calendar"
40931>>>>>>>>>>>>>                    Send Insert ""
40932>>>>>>>>>>>>>                    Send Insert ""
40933>>>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
40934>>>>>>>>>>>>>                    Send Insert ""
40935>>>>>>>>>>>>>                    Send append_text "  - select date."
40936>>>>>>>>>>>>>                    Send Insert ""
40937>>>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
40938>>>>>>>>>>>>>                    Send Insert ""
40939>>>>>>>>>>>>>                    Send append_text "  - select month."
40940>>>>>>>>>>>>>                    Send Insert ""
40941>>>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
40942>>>>>>>>>>>>>                    Send Insert ""
40943>>>>>>>>>>>>>                    Send append_text "  - set current date."
40944>>>>>>>>>>>>>                    Send Insert ""
40945>>>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
40946>>>>>>>>>>>>>                    Send Insert ""
40947>>>>>>>>>>>>>                    Send append_text "  - Change year."
40948>>>>>>>>>>>>>                    Send Insert ""
40949>>>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
40950>>>>>>>>>>>>>                    Send Insert ""
40951>>>>>>>>>>>>>                    Send append_text "  - Select year."
40952>>>>>>>>>>>>>                End_procedure // SetComments
40953>>>>>>>>>>>>>
40953>>>>>>>>>>>>>                //Send SetComments
40953>>>>>>>>>>>>>                Set Color     to clWhite
40954>>>>>>>>>>>>>                Set TextColor to clNavy
40955>>>>>>>>>>>>>
40955>>>>>>>>>>>>>                Procedure OnSetFocus
40957>>>>>>>>>>>>>                    Send ReadHelpComments
40958>>>>>>>>>>>>>                End_Procedure
40959>>>>>>>>>>>>>
40959>>>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>                    Procedure Close_Help
40963>>>>>>>>>>>>>                        Send Close_Help to Help_Container
40964>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
40966>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40967>>>>>>>>>>>>>
40967>>>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
40969>>>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
40970>>>>>>>>>>>>>                End_Procedure // Mouse_Up2
40971>>>>>>>>>>>>>
40971>>>>>>>>>>>>>            End_Object
40972>>>>>>>>>>>>>
40972>>>>>>>>>>>>>            Procedure Close_Help
40974>>>>>>>>>>>>>                Send Delete_Data to Help_Info
40975>>>>>>>>>>>>>                Set Visible_State to False
40976>>>>>>>>>>>>>                Set Enabled_State to False
40977>>>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
40978>>>>>>>>>>>>>            End_Procedure // Close_Help
40979>>>>>>>>>>>>>
40979>>>>>>>>>>>>>            On_Key kCancel Send Close_Help
40980>>>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
40981>>>>>>>>>>>>>            On_Key kEnter  Send Close_Help
40982>>>>>>>>>>>>>        End_Object // Help_Info
40983>>>>>>>>>>>>>
40983>>>>>>>>>>>>>        on_key kcancel           send Close_Calendar
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>        //AB-StoreEnd
40984>>>>>>>>>>>>>
40984>>>>>>>>>>>>>    End_Object    // oCalendar
40985>>>>>>>>>>>>>
40985>>>>>>>>>>>>>
40985>>>>>>>>>>>>>    //AB-StoreStart
40985>>>>>>>>>>>>>
40985>>>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
40986>>>>>>>>>>>>>        Integer focus# type# dm#
40987>>>>>>>>>>>>>
40987>>>>>>>>>>>>>        move (focus(desktop)) to focus#
40988>>>>>>>>>>>>>        if focus# gt desktop begin
40990>>>>>>>>>>>>>          get delegation_mode of focus# to dm#
40991>>>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
40992>>>>>>>>>>>>>          get form_datatype of focus# item current to type#
40993>>>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
40996>>>>>>>>>>>>>          set delegation_mode of focus# to dm#
40997>>>>>>>>>>>>>        end
40997>>>>>>>>>>>>>>
40997>>>>>>>>>>>>>    End_Procedure
40998>>>>>>>>>>>>>
40998>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
40999>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
41000>>>>>>>>>>>>>
41000>>>>>>>>>>>>>
41000>>>>>>>>>>>>>    //AB-StoreEnd
41000>>>>>>>>>>>>>
41000>>>>>>>>>>>>>//AB/     End_Object    // prj
41000>>>>>>>>>>>Use Dates.Utl
41000>>>>>>>>>>>
41000>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
41000>>>>>>>>>>>   Define cDateToday        for "T"
41000>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
41000>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
41000>>>>>>>>>>>
41000>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
41001>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
41002>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
41003>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
41004>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
41005>>>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
41006>>>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
41007>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
41008>>>>>>>>>>>
41008>>>>>>>>>>>   Procedure DoAddOneDay
41009>>>>>>>>>>>        Integer rVal
41010>>>>>>>>>>>        Date dHmnia
41010>>>>>>>>>>>
41010>>>>>>>>>>>        Get Value Item 0 to dHmnia
41011>>>>>>>>>>>        Add 1 to dHmnia
41012>>>>>>>>>>>        Set Value Item 0 to dHmnia
41013>>>>>>>>>>>    End_Procedure // Add_One_Day
41014>>>>>>>>>>>
41014>>>>>>>>>>>    Procedure DoSubOneDay
41015>>>>>>>>>>>        Integer rVal
41016>>>>>>>>>>>        Date dHmnia
41016>>>>>>>>>>>
41016>>>>>>>>>>>        Get Value Item 0 to dHmnia
41017>>>>>>>>>>>        Sub 1 to dHmnia
41018>>>>>>>>>>>        Set Value Item 0 to dHmnia
41019>>>>>>>>>>>    End_Procedure // Add_One_Day
41020>>>>>>>>>>>
41020>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
41020>>>>>>>>>>>   Procedure Entering returns Integer
41021>>>>>>>>>>>      Integer iRetVal
41022>>>>>>>>>>>      Date    dOriginal
41022>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
41024>>>>>>>>>>>      If (iRetVal = 0) Begin
41026>>>>>>>>>>>         Send DoStoreOriginalDate
41027>>>>>>>>>>>      End
41027>>>>>>>>>>>>
41027>>>>>>>>>>>      Procedure_Return iRetVal
41028>>>>>>>>>>>   End_Procedure // Entering
41029>>>>>>>>>>>
41029>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
41029>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
41029>>>>>>>>>>>   Procedure Next
41030>>>>>>>>>>>      Send DoIntelliSenseDate
41031>>>>>>>>>>>      Forward Send Next
41033>>>>>>>>>>>   End_Procedure // Next
41034>>>>>>>>>>>
41034>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
41034>>>>>>>>>>>   Procedure DoStoreOriginalDate
41035>>>>>>>>>>>      Date    dOriginal
41036>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
41036>>>>>>>>>>>         Get Value Item 0 to dOriginal
41037>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
41038>>>>>>>>>>>      //End
41038>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
41039>>>>>>>>>>>
41039>>>>>>>>>>>   Procedure DoIntelliSenseDate
41040>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
41041>>>>>>>>>>>      Date    dCurrent dOriginal
41041>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
41041>>>>>>>>>>>
41041>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
41042>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
41043>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
41045>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
41048>>>>>>>>>>>
41048>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
41048>>>>>>>>>>>         // USA dates.
41048>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
41049>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
41050>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
41053>>>>>>>>>>>         Move (Character(iSep)) to sSep
41054>>>>>>>>>>>
41054>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
41054>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
41055>>>>>>>>>>>         Move (sSep+sSep) to sMask
41056>>>>>>>>>>>
41056>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
41056>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
41056>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
41056>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
41056>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
41058>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
41059>>>>>>>>>>>            Move sCurrent to iCurrent
41060>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
41062>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
41065>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
41067>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
41068>>>>>>>>>>>               End
41068>>>>>>>>>>>>
41068>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
41071>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
41072>>>>>>>>>>>               End
41072>>>>>>>>>>>>
41072>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
41075>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
41076>>>>>>>>>>>               End
41076>>>>>>>>>>>>
41076>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
41077>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
41077>>>>>>>>>>>>
41077>>>>>>>>>>>         End
41077>>>>>>>>>>>>
41077>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
41080>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
41083>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
41085>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
41086>>>>>>>>>>>            End
41086>>>>>>>>>>>>
41086>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
41089>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
41090>>>>>>>>>>>            End
41090>>>>>>>>>>>>
41090>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
41091>>>>>>>>>>>         End
41091>>>>>>>>>>>>
41091>>>>>>>>>>>      End
41091>>>>>>>>>>>>
41091>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
41092>>>>>>>>>>>
41092>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
41093>>>>>>>>>>>      Date dToday dTemp
41094>>>>>>>>>>>      Sysdate4 dToday
41095>>>>>>>>>>>
41095>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
41097>>>>>>>>>>>         Set Value to dToday
41098>>>>>>>>>>>      End
41098>>>>>>>>>>>>
41098>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
41101>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
41102>>>>>>>>>>>         Set Value to dTemp
41103>>>>>>>>>>>      End
41103>>>>>>>>>>>>
41103>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
41106>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
41107>>>>>>>>>>>         Set Value to dTemp
41108>>>>>>>>>>>      End
41108>>>>>>>>>>>>
41108>>>>>>>>>>>      Else Forward Send Key iKey
41111>>>>>>>>>>>   End_procedure
41112>>>>>>>>>>>
41112>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
41113>>>>>>>>>
41113>>>>>>>>>Class cSyDateForm Is A FormSub
41114>>>>>>>>>   Procedure Construct_Object
41115>>>>>>>>>      Forward Send Construct_Object
41117>>>>>>>>>
41117>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
41118>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
41119>>>>>>>>>
41119>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
41120>>>>>>>>>
41120>>>>>>>>>      On_Key kPrompt Send Prompt
41121>>>>>>>>>
41121>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
41122>>>>>>>>>      Set Status_Help   to cStatusHelp
41123>>>>>>>>>
41123>>>>>>>>>   End_Procedure // Construct_Object
41124>>>>>>>>>
41124>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
41125>>>>>>>>>
41125>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
41125>>>>>>>>>//      Integer iDatatype
41125>>>>>>>>>//
41125>>>>>>>>>//      If (iItem = Current) Begin
41125>>>>>>>>>//         Get Current_Item to iItem
41125>>>>>>>>>//      End
41125>>>>>>>>>//
41125>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
41125>>>>>>>>>//
41125>>>>>>>>>//      Function_Return iDatatype
41125>>>>>>>>>//   End_Function // Form_Datatype
41125>>>>>>>>>
41125>>>>>>>>>End_Class // cSyDateForm
41126>>>>>>>Use Chkbox.Sub
41126>>>>>>>Use Button.Sub
41126>>>>>>>
41126>>>>>>>
41126>>>>>>>Use BTYPKIN.DD
41126>>>>>>>Use BARTICL.DD
41126>>>>>>>Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
41126>>>>>>>>>//DDB-FileStart
41126>>>>>>>>>//DDB-HeaderStart
41126>>>>>>>>>
41126>>>>>>>>>// File Name : COUNTRY.DD
41126>>>>>>>>>// Class Name: Country_DataDictionary
41126>>>>>>>>>// Revision  : 3
41126>>>>>>>>>// Version   : 2
41126>>>>>>>>>
41126>>>>>>>>>Use  Windows           // Basic Definitions
41126>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41126>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41126>>>>>>>>>
41126>>>>>>>>>Open Country
41128>>>>>>>>>Open Towns
41130>>>>>>>>>
41130>>>>>>>>>//DDB-HeaderEnd
41130>>>>>>>>>//DDB-SelectionStart
41130>>>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
41130>>>>>>>>>Register_Object sl058
41130>>>>>>>>>//DDB-SelectionEnd
41130>>>>>>>>>
41130>>>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
41131>>>>>>>>>
41131>>>>>>>>>    // Define_Fields:
41131>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41131>>>>>>>>>
41131>>>>>>>>>    Procedure Define_Fields
41132>>>>>>>>>        Forward Send Define_Fields
41134>>>>>>>>>        //DDB-Generated-Code-Location
41134>>>>>>>>>        //DDB-DefineFieldStart
41134>>>>>>>>>
41134>>>>>>>>>        Set Main_File            To Country.File_Number
41135>>>>>>>>>        Set Cascade_Delete_State To FALSE
41136>>>>>>>>>
41136>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41137>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41138>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41139>>>>>>>>>
41139>>>>>>>>>        // Child (Client) file structure................
41139>>>>>>>>>        Send Add_Client_File  Towns.File_Number
41140>>>>>>>>>
41140>>>>>>>>>        // Field-based properties.......................
41140>>>>>>>>>
41140>>>>>>>>>        // Country.Country_Id
41140>>>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
41141>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
41142>>>>>>>>>
41142>>>>>>>>>        // Country.Country_Descr
41142>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
41143>>>>>>>>>
41143>>>>>>>>>        //DDB-DefineFieldEnd
41143>>>>>>>>>    End_Procedure    // Define_Fields
41144>>>>>>>>>
41144>>>>>>>>>    // Field_Defaults:
41144>>>>>>>>>    // This procedure is used to establish default field values.
41144>>>>>>>>>
41144>>>>>>>>>    Procedure Field_Defaults
41145>>>>>>>>>        Forward Send Field_Defaults
41147>>>>>>>>>        //DDB-Generated-Code-Location
41147>>>>>>>>>        //DDB-FieldDefaultStart
41147>>>>>>>>>        //DDB-FieldDefaultEnd
41147>>>>>>>>>    End_Procedure    // Field_Defaults
41148>>>>>>>>>
41148>>>>>>>>>End_Class    // Country_DataDictionary
41149>>>>>>>>>//DDB-Selection-pkg-Start
41149>>>>>>>>>
41149>>>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
41149>>>>>>>>>>>//AB/ Project sl058 : Countries - Xores
41149>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41149>>>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
41149>>>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
41149>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41149>>>>>>>>>>>
41149>>>>>>>>>>>// Project Object Structure
41149>>>>>>>>>>>//   sl058 is a dbModalPanelSub
41149>>>>>>>>>>>//     Country_DD is a DataDictionary
41149>>>>>>>>>>>//     oSelList is a dbListSub
41149>>>>>>>>>>>//     oOK_bn is a ButtonSub
41149>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41149>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41149>>>>>>>>>>>
41149>>>>>>>>>>>// Register all objects
41149>>>>>>>>>>>Register_Object Country_DD
41149>>>>>>>>>>>Register_Object oCancel_bn
41149>>>>>>>>>>>Register_Object oOK_bn
41149>>>>>>>>>>>Register_Object oSearch_bn
41149>>>>>>>>>>>Register_Object oSelList
41149>>>>>>>>>>>Register_Object sl058
41149>>>>>>>>>>>
41149>>>>>>>>>>>
41149>>>>>>>>>>>    //AB-IgnoreStart
41149>>>>>>>>>>>
41149>>>>>>>>>>>    Use DFAllEnt.pkg
41149>>>>>>>>>>>    Use dbList.Sub
41149>>>>>>>>>>>    Use Button.Sub
41149>>>>>>>>>>>
41149>>>>>>>>>>>
41149>>>>>>>>>>>    Use Country.DD
41149>>>>>>>>>>>    
41149>>>>>>>>>>>    //AB-IgnoreEnd
41149>>>>>>>>>>>
41149>>>>>>>>>>>    Object sl058 is a dbModalPanelSub
41151>>>>>>>>>>>        Set Label to "•é¨œª"
41152>>>>>>>>>>>        Set Size to 148 297
41153>>>>>>>>>>>        Set Location to 6 10
41154>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41155>>>>>>>>>>>        Set Modal_State to FALSE
41156>>>>>>>>>>>
41156>>>>>>>>>>>        //AB-DDOStart
41156>>>>>>>>>>>
41156>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
41158>>>>>>>>>>>        End_Object    // Country_DD
41159>>>>>>>>>>>
41159>>>>>>>>>>>        Set Main_DD to (Country_DD(self))
41160>>>>>>>>>>>        Set Server to (Country_DD(self))
41161>>>>>>>>>>>
41161>>>>>>>>>>>        //AB-DDOEnd
41161>>>>>>>>>>>
41161>>>>>>>>>>>        Object oSelList is a dbListSub
41163>>>>>>>>>>>            Set Main_File to Country.File_Number
41164>>>>>>>>>>>            Set Size to 105 280
41165>>>>>>>>>>>            Set Location to 6 6
41166>>>>>>>>>>>
41166>>>>>>>>>>>            Begin_Row
41169>>>>>>>>>>>                Entry_Item Country.Country_id
41170>>>>>>>>>>>                Entry_Item Country.Country_descr
41171>>>>>>>>>>>            End_Row
41176>>>>>>>>>>>
41176>>>>>>>>>>>            Set Form_Width    item 0 to 87
41177>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
41178>>>>>>>>>>>            
41178>>>>>>>>>>>            Set Form_Width    item 1 to 183
41179>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41180>>>>>>>>>>>            
41180>>>>>>>>>>>        End_Object    // oSelList
41181>>>>>>>>>>>
41181>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41183>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41184>>>>>>>>>>>            Set Location to 115 126
41185>>>>>>>>>>>
41185>>>>>>>>>>>            //AB-StoreStart
41185>>>>>>>>>>>            Procedure OnClick
41187>>>>>>>>>>>                Send OK To (oSelList(current_object))
41188>>>>>>>>>>>            End_Procedure
41189>>>>>>>>>>>            //AB-StoreEnd
41189>>>>>>>>>>>
41189>>>>>>>>>>>        End_Object    // oOK_bn
41190>>>>>>>>>>>
41190>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41192>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41193>>>>>>>>>>>            Set Location to 115 181
41194>>>>>>>>>>>
41194>>>>>>>>>>>            //AB-StoreStart
41194>>>>>>>>>>>            Procedure OnClick
41196>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41197>>>>>>>>>>>            End_Procedure
41198>>>>>>>>>>>            //AB-StoreEnd
41198>>>>>>>>>>>
41198>>>>>>>>>>>        End_Object    // oCancel_bn
41199>>>>>>>>>>>
41199>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41201>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41202>>>>>>>>>>>            Set Location to 115 236
41203>>>>>>>>>>>
41203>>>>>>>>>>>            //AB-StoreStart
41203>>>>>>>>>>>            Procedure OnClick
41205>>>>>>>>>>>                Send Search To (oSelList(current_object))
41206>>>>>>>>>>>            End_Procedure
41207>>>>>>>>>>>            //AB-StoreEnd
41207>>>>>>>>>>>
41207>>>>>>>>>>>        End_Object    // oSearch_bn
41208>>>>>>>>>>>
41208>>>>>>>>>>>
41208>>>>>>>>>>>        //AB-StoreStart
41208>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41209>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41210>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41211>>>>>>>>>>>        //AB-StoreEnd
41211>>>>>>>>>>>
41211>>>>>>>>>>>    End_Object    // sl058
41212>>>>>>>>>>>
41212>>>>>>>>>>>//AB/     End_Object    // prj
41212>>>>>>>>>
41212>>>>>>>>>//DDB-Selection-pkg-End
41212>>>>>>>>>//DDB-FileEnd
41212>>>>>>>Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
41212>>>>>>>>>//DDB-FileStart
41212>>>>>>>>>//DDB-HeaderStart
41212>>>>>>>>>
41212>>>>>>>>>// File Name : TOWNS.DD
41212>>>>>>>>>// Class Name: Towns_DataDictionary
41212>>>>>>>>>// Revision  : 8
41212>>>>>>>>>// Version   : 2
41212>>>>>>>>>
41212>>>>>>>>>Use  Windows           // Basic Definitions
41212>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41212>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41212>>>>>>>>>
41212>>>>>>>>>Open Towns
41214>>>>>>>>>Open Cities
41216>>>>>>>>>Open Country
41218>>>>>>>>>
41218>>>>>>>>>//DDB-HeaderEnd
41218>>>>>>>>>//DDB-SelectionStart
41218>>>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
41218>>>>>>>>>Register_Object sl057
41218>>>>>>>>>//DDB-SelectionEnd
41218>>>>>>>>>
41218>>>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
41219>>>>>>>>>
41219>>>>>>>>>    Procedure Save_Main_File
41220>>>>>>>>>        If (Operation_Origin<>Self) Begin
41222>>>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
41225>>>>>>>>>        End
41225>>>>>>>>>>
41225>>>>>>>>>        Forward Send Save_Main_File
41227>>>>>>>>>    End_Procedure
41228>>>>>>>>>
41228>>>>>>>>>
41228>>>>>>>>>    // Define_Fields:
41228>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41228>>>>>>>>>
41228>>>>>>>>>    Procedure Define_Fields
41229>>>>>>>>>        Forward Send Define_Fields
41231>>>>>>>>>        //DDB-Generated-Code-Location
41231>>>>>>>>>        //DDB-DefineFieldStart
41231>>>>>>>>>
41231>>>>>>>>>        Set Main_File            To Towns.File_Number
41232>>>>>>>>>        Set Cascade_Delete_State To FALSE
41233>>>>>>>>>
41233>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41234>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
41235>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
41236>>>>>>>>>
41236>>>>>>>>>        // Child (Client) file structure................
41236>>>>>>>>>        Send Add_Client_File  Cities.File_Number
41237>>>>>>>>>
41237>>>>>>>>>        // Parent (Server) file structure...............
41237>>>>>>>>>        Send Add_Server_File  Country.File_Number
41238>>>>>>>>>
41238>>>>>>>>>        // Field-based properties.......................
41238>>>>>>>>>
41238>>>>>>>>>        // Towns.Country_Id
41238>>>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
41239>>>>>>>>>
41239>>>>>>>>>        // Towns.Town_Id
41239>>>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
41240>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
41241>>>>>>>>>
41241>>>>>>>>>        // Towns.Town_Descr
41241>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
41242>>>>>>>>>
41242>>>>>>>>>        //DDB-DefineFieldEnd
41242>>>>>>>>>    End_Procedure    // Define_Fields
41243>>>>>>>>>
41243>>>>>>>>>    // Field_Defaults:
41243>>>>>>>>>    // This procedure is used to establish default field values.
41243>>>>>>>>>
41243>>>>>>>>>    Procedure Field_Defaults
41244>>>>>>>>>        Forward Send Field_Defaults
41246>>>>>>>>>        //DDB-Generated-Code-Location
41246>>>>>>>>>        //DDB-FieldDefaultStart
41246>>>>>>>>>        //DDB-FieldDefaultEnd
41246>>>>>>>>>    End_Procedure    // Field_Defaults
41247>>>>>>>>>
41247>>>>>>>>>End_Class    // Towns_DataDictionary
41248>>>>>>>>>//DDB-Selection-pkg-Start
41248>>>>>>>>>
41248>>>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
41248>>>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
41248>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41248>>>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
41248>>>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
41248>>>>>>>>>>>
41248>>>>>>>>>>>// Project Object Structure
41248>>>>>>>>>>>//   sl057 is a dbModalPanelSub
41248>>>>>>>>>>>//     Country_DD is a DataDictionary
41248>>>>>>>>>>>//     Towns_DD is a DataDictionary
41248>>>>>>>>>>>//     oSelList is a dbListSub
41248>>>>>>>>>>>//     oOK_bn is a ButtonSub
41248>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41248>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41248>>>>>>>>>>>
41248>>>>>>>>>>>// Register all objects
41248>>>>>>>>>>>Register_Object Country_DD
41248>>>>>>>>>>>Register_Object oCancel_bn
41248>>>>>>>>>>>Register_Object oOK_bn
41248>>>>>>>>>>>Register_Object oSearch_bn
41248>>>>>>>>>>>Register_Object oSelList
41248>>>>>>>>>>>Register_Object sl057
41248>>>>>>>>>>>Register_Object Towns_DD
41248>>>>>>>>>>>
41248>>>>>>>>>>>
41248>>>>>>>>>>>    //AB-IgnoreStart
41248>>>>>>>>>>>
41248>>>>>>>>>>>    Use DFAllEnt.pkg
41248>>>>>>>>>>>    Use dbList.Sub
41248>>>>>>>>>>>    Use Button.Sub
41248>>>>>>>>>>>
41248>>>>>>>>>>>
41248>>>>>>>>>>>    Use COUNTRY.DD
41248>>>>>>>>>>>    Use TOWNS.DD
41248>>>>>>>>>>>    
41248>>>>>>>>>>>    //AB-IgnoreEnd
41248>>>>>>>>>>>
41248>>>>>>>>>>>    Object sl057 is a dbModalPanelSub
41250>>>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
41251>>>>>>>>>>>        Set Size to 148 297
41252>>>>>>>>>>>        Set Location to 6 10
41253>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41254>>>>>>>>>>>        Set Modal_State to FALSE
41255>>>>>>>>>>>
41255>>>>>>>>>>>        //AB-DDOStart
41255>>>>>>>>>>>
41255>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
41257>>>>>>>>>>>        End_Object    // Country_DD
41258>>>>>>>>>>>
41258>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
41260>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
41261>>>>>>>>>>>        End_Object    // Towns_DD
41262>>>>>>>>>>>
41262>>>>>>>>>>>        Set Main_DD to (Towns_DD(self))
41263>>>>>>>>>>>        Set Server to (Towns_DD(self))
41264>>>>>>>>>>>
41264>>>>>>>>>>>        //AB-DDOEnd
41264>>>>>>>>>>>
41264>>>>>>>>>>>        Object oSelList is a dbListSub
41266>>>>>>>>>>>            Set Main_File to Towns.File_Number
41267>>>>>>>>>>>            Set Size to 105 280
41268>>>>>>>>>>>            Set Location to 6 6
41269>>>>>>>>>>>
41269>>>>>>>>>>>            Begin_Row
41272>>>>>>>>>>>                Entry_Item Towns.Town_id
41273>>>>>>>>>>>                Entry_Item Towns.Town_descr
41274>>>>>>>>>>>                Entry_Item Country.Country_descr
41275>>>>>>>>>>>            End_Row
41280>>>>>>>>>>>
41280>>>>>>>>>>>            Set Form_Width    item 0 to 43
41281>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
41282>>>>>>>>>>>            
41282>>>>>>>>>>>            Set Form_Width    item 1 to 137
41283>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41284>>>>>>>>>>>            
41284>>>>>>>>>>>            Set Form_Width    item 2 to 94
41285>>>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
41286>>>>>>>>>>>            
41286>>>>>>>>>>>        End_Object    // oSelList
41287>>>>>>>>>>>
41287>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41289>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41290>>>>>>>>>>>            Set Location to 115 126
41291>>>>>>>>>>>
41291>>>>>>>>>>>            //AB-StoreStart
41291>>>>>>>>>>>            Procedure OnClick
41293>>>>>>>>>>>                Send OK To (oSelList(current_object))
41294>>>>>>>>>>>            End_Procedure
41295>>>>>>>>>>>            //AB-StoreEnd
41295>>>>>>>>>>>
41295>>>>>>>>>>>        End_Object    // oOK_bn
41296>>>>>>>>>>>
41296>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41298>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41299>>>>>>>>>>>            Set Location to 115 181
41300>>>>>>>>>>>
41300>>>>>>>>>>>            //AB-StoreStart
41300>>>>>>>>>>>            Procedure OnClick
41302>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41303>>>>>>>>>>>            End_Procedure
41304>>>>>>>>>>>            //AB-StoreEnd
41304>>>>>>>>>>>
41304>>>>>>>>>>>        End_Object    // oCancel_bn
41305>>>>>>>>>>>
41305>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41307>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41308>>>>>>>>>>>            Set Location to 115 236
41309>>>>>>>>>>>
41309>>>>>>>>>>>            //AB-StoreStart
41309>>>>>>>>>>>            Procedure OnClick
41311>>>>>>>>>>>                Send Search To (oSelList(current_object))
41312>>>>>>>>>>>            End_Procedure
41313>>>>>>>>>>>            //AB-StoreEnd
41313>>>>>>>>>>>
41313>>>>>>>>>>>        End_Object    // oSearch_bn
41314>>>>>>>>>>>
41314>>>>>>>>>>>
41314>>>>>>>>>>>        //AB-StoreStart
41314>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41315>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41316>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41317>>>>>>>>>>>        //AB-StoreEnd
41317>>>>>>>>>>>
41317>>>>>>>>>>>    End_Object    // sl057
41318>>>>>>>>>>>
41318>>>>>>>>>>>//AB/     End_Object    // prj
41318>>>>>>>>>
41318>>>>>>>>>//DDB-Selection-pkg-End
41318>>>>>>>>>//DDB-FileEnd
41318>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
41318>>>>>>>>>//DDB-FileStart
41318>>>>>>>>>//DDB-HeaderStart
41318>>>>>>>>>
41318>>>>>>>>>// File Name : CITIES.DD
41318>>>>>>>>>// Class Name: Cities_DataDictionary
41318>>>>>>>>>// Revision  : 14
41318>>>>>>>>>// Version   : 2
41318>>>>>>>>>
41318>>>>>>>>>Use  Windows           // Basic Definitions
41318>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41318>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41318>>>>>>>>>
41318>>>>>>>>>Open Cities
41320>>>>>>>>>Open Clients
41322>>>>>>>>>Open Towns
41324>>>>>>>>>
41324>>>>>>>>>//DDB-HeaderEnd
41324>>>>>>>>>//DDB-SelectionStart
41324>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
41324>>>>>>>>>Register_Object sl198
41324>>>>>>>>>//DDB-SelectionEnd
41324>>>>>>>>>
41324>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
41325>>>>>>>>>
41325>>>>>>>>>    // Define_Fields:
41325>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41325>>>>>>>>>
41325>>>>>>>>>    Procedure Define_Fields
41326>>>>>>>>>        Forward Send Define_Fields
41328>>>>>>>>>        //DDB-Generated-Code-Location
41328>>>>>>>>>        //DDB-DefineFieldStart
41328>>>>>>>>>
41328>>>>>>>>>        Set Main_File            To Cities.File_Number
41329>>>>>>>>>        Set Cascade_Delete_State To FALSE
41330>>>>>>>>>
41330>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41331>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41332>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41333>>>>>>>>>
41333>>>>>>>>>        // Child (Client) file structure................
41333>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41334>>>>>>>>>
41334>>>>>>>>>        // Parent (Server) file structure...............
41334>>>>>>>>>        Send Add_Server_File  Towns.File_Number
41335>>>>>>>>>
41335>>>>>>>>>        // Field-based properties.......................
41335>>>>>>>>>
41335>>>>>>>>>        // Cities.City_Id
41335>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
41336>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
41337>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
41338>>>>>>>>>
41338>>>>>>>>>        // Cities.City_Descr
41338>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
41339>>>>>>>>>
41339>>>>>>>>>        // Cities.Town_Id
41339>>>>>>>>>
41339>>>>>>>>>        //DDB-DefineFieldEnd
41339>>>>>>>>>    End_Procedure    // Define_Fields
41340>>>>>>>>>
41340>>>>>>>>>    // Field_Defaults:
41340>>>>>>>>>    // This procedure is used to establish default field values.
41340>>>>>>>>>
41340>>>>>>>>>    Procedure Field_Defaults
41341>>>>>>>>>        Forward Send Field_Defaults
41343>>>>>>>>>        //DDB-Generated-Code-Location
41343>>>>>>>>>        //DDB-FieldDefaultStart
41343>>>>>>>>>        //DDB-FieldDefaultEnd
41343>>>>>>>>>    End_Procedure    // Field_Defaults
41344>>>>>>>>>
41344>>>>>>>>>End_Class    // Cities_DataDictionary
41345>>>>>>>>>//DDB-Selection-pkg-Start
41345>>>>>>>>>
41345>>>>>>>>>Use sl198.SL         // sl198
INCLUDING FILE: SL198.SL
41345>>>>>>>>>>>//AB/ Project sl198:cities
41345>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41345>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
41345>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
41345>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41345>>>>>>>>>>>
41345>>>>>>>>>>>// Project Object Structure
41345>>>>>>>>>>>//   sl198 is a dbModalPanelSub
41345>>>>>>>>>>>//     Cities_DD is a DataDictionary
41345>>>>>>>>>>>//     oSelList is a dbListSub
41345>>>>>>>>>>>//     oOK_bn is a ButtonSub
41345>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41345>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41345>>>>>>>>>>>
41345>>>>>>>>>>>// Register all objects
41345>>>>>>>>>>>Register_Object Cities_DD
41345>>>>>>>>>>>Register_Object oCancel_bn
41345>>>>>>>>>>>Register_Object oOK_bn
41345>>>>>>>>>>>Register_Object oSearch_bn
41345>>>>>>>>>>>Register_Object oSelList
41345>>>>>>>>>>>Register_Object sl198
41345>>>>>>>>>>>
41345>>>>>>>>>>>
41345>>>>>>>>>>>//AB-IgnoreStart
41345>>>>>>>>>>>
41345>>>>>>>>>>>Use DFAllEnt.pkg
41345>>>>>>>>>>>Use dbList.Sub
41345>>>>>>>>>>>Use Button.Sub
41345>>>>>>>>>>>
41345>>>>>>>>>>>
41345>>>>>>>>>>>Use CITIES.DD
41345>>>>>>>>>>>
41345>>>>>>>>>>>//AB-IgnoreEnd
41345>>>>>>>>>>>
41345>>>>>>>>>>>Object sl198 is a dbModalPanelSub
41347>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
41348>>>>>>>>>>>    Set Size to 148 297
41349>>>>>>>>>>>    Set Location to 4 5
41350>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41351>>>>>>>>>>>    Set Modal_State to FALSE
41352>>>>>>>>>>>
41352>>>>>>>>>>>    //AB-DDOStart
41352>>>>>>>>>>>
41352>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
41354>>>>>>>>>>>
41354>>>>>>>>>>>        //AB-StoreStart
41354>>>>>>>>>>>                
41354>>>>>>>>>>>                
41354>>>>>>>>>>>        //AB-StoreEnd
41354>>>>>>>>>>>
41354>>>>>>>>>>>    End_Object    // Cities_DD
41355>>>>>>>>>>>
41355>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
41356>>>>>>>>>>>    Set Server to (Cities_DD(self))
41357>>>>>>>>>>>
41357>>>>>>>>>>>    //AB-DDOEnd
41357>>>>>>>>>>>
41357>>>>>>>>>>>    Object oSelList is a dbListSub
41359>>>>>>>>>>>        Set Main_File to Cities.File_Number
41360>>>>>>>>>>>        Set Size to 105 280
41361>>>>>>>>>>>        Set Location to 6 6
41362>>>>>>>>>>>
41362>>>>>>>>>>>        Begin_Row
41365>>>>>>>>>>>            Entry_Item Cities.City_id
41366>>>>>>>>>>>            Entry_Item Cities.City_descr
41367>>>>>>>>>>>        End_Row
41372>>>>>>>>>>>
41372>>>>>>>>>>>        Set Form_Width    item 0 to 50
41373>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41374>>>>>>>>>>>        
41374>>>>>>>>>>>        Set Form_Width    item 1 to 221
41375>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
41376>>>>>>>>>>>        
41376>>>>>>>>>>>
41376>>>>>>>>>>>        //AB-StoreStart
41376>>>>>>>>>>>        
41376>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
41377>>>>>>>>>>>        
41377>>>>>>>>>>>        
41377>>>>>>>>>>>        
41377>>>>>>>>>>>        
41377>>>>>>>>>>>        
41377>>>>>>>>>>>        //AB-StoreEnd
41377>>>>>>>>>>>
41377>>>>>>>>>>>    End_Object    // oSelList
41378>>>>>>>>>>>
41378>>>>>>>>>>>    Object oOK_bn is a ButtonSub
41380>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41381>>>>>>>>>>>        Set Location to 115 126
41382>>>>>>>>>>>
41382>>>>>>>>>>>        //AB-StoreStart
41382>>>>>>>>>>>        Procedure OnClick
41384>>>>>>>>>>>            Send OK To (oSelList(current_object))
41385>>>>>>>>>>>        End_Procedure
41386>>>>>>>>>>>        //AB-StoreEnd
41386>>>>>>>>>>>
41386>>>>>>>>>>>    End_Object    // oOK_bn
41387>>>>>>>>>>>
41387>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
41389>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41390>>>>>>>>>>>        Set Location to 115 181
41391>>>>>>>>>>>
41391>>>>>>>>>>>        //AB-StoreStart
41391>>>>>>>>>>>        Procedure OnClick
41393>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41394>>>>>>>>>>>        End_Procedure
41395>>>>>>>>>>>        //AB-StoreEnd
41395>>>>>>>>>>>
41395>>>>>>>>>>>    End_Object    // oCancel_bn
41396>>>>>>>>>>>
41396>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
41398>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
41399>>>>>>>>>>>        Set Location to 115 236
41400>>>>>>>>>>>
41400>>>>>>>>>>>        //AB-StoreStart
41400>>>>>>>>>>>        Procedure OnClick
41402>>>>>>>>>>>            Send Search To (oSelList(current_object))
41403>>>>>>>>>>>        End_Procedure
41404>>>>>>>>>>>        //AB-StoreEnd
41404>>>>>>>>>>>
41404>>>>>>>>>>>    End_Object    // oSearch_bn
41405>>>>>>>>>>>
41405>>>>>>>>>>>
41405>>>>>>>>>>>    //AB-StoreStart
41405>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41406>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41407>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41408>>>>>>>>>>>    //AB-StoreEnd
41408>>>>>>>>>>>
41408>>>>>>>>>>>End_Object    // sl198
41409>>>>>>>>>>>
41409>>>>>>>>>>>//AB/ End_Object    // prj
41409>>>>>>>>>
41409>>>>>>>>>//DDB-Selection-pkg-End
41409>>>>>>>>>//DDB-FileEnd
41409>>>>>>>Use AREAS.DD
INCLUDING FILE: AREAS.DD
41409>>>>>>>>>//DDB-FileStart
41409>>>>>>>>>//DDB-HeaderStart
41409>>>>>>>>>
41409>>>>>>>>>// File Name : AREAS.DD
41409>>>>>>>>>// Class Name: Areas_DataDictionary
41409>>>>>>>>>// Revision  : 8
41409>>>>>>>>>// Version   : 2
41409>>>>>>>>>
41409>>>>>>>>>Use  Windows           // Basic Definitions
41409>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41409>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41409>>>>>>>>>
41409>>>>>>>>>Open Areas
41411>>>>>>>>>Open Clients
41413>>>>>>>>>
41413>>>>>>>>>//DDB-HeaderEnd
41413>>>>>>>>>//DDB-SelectionStart
41413>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41413>>>>>>>>>Register_Object sl197
41413>>>>>>>>>//DDB-SelectionEnd
41413>>>>>>>>>
41413>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
41414>>>>>>>>>
41414>>>>>>>>>    // Define_Fields:
41414>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41414>>>>>>>>>
41414>>>>>>>>>    Procedure Define_Fields
41415>>>>>>>>>        Forward Send Define_Fields
41417>>>>>>>>>        //DDB-Generated-Code-Location
41417>>>>>>>>>        //DDB-DefineFieldStart
41417>>>>>>>>>
41417>>>>>>>>>        Set Main_File            To Areas.File_Number
41418>>>>>>>>>        Set Cascade_Delete_State To FALSE
41419>>>>>>>>>
41419>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41420>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41421>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41422>>>>>>>>>
41422>>>>>>>>>        // Child (Client) file structure................
41422>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41423>>>>>>>>>
41423>>>>>>>>>        // Field-based properties.......................
41423>>>>>>>>>
41423>>>>>>>>>        // Areas.Area_Id
41423>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
41424>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
41425>>>>>>>>>
41425>>>>>>>>>        // Areas.Area_Descr
41425>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
41426>>>>>>>>>
41426>>>>>>>>>        // Areas.Area_Site
41426>>>>>>>>>
41426>>>>>>>>>        //DDB-DefineFieldEnd
41426>>>>>>>>>    End_Procedure    // Define_Fields
41427>>>>>>>>>
41427>>>>>>>>>    // Field_Defaults:
41427>>>>>>>>>    // This procedure is used to establish default field values.
41427>>>>>>>>>
41427>>>>>>>>>    Procedure Field_Defaults
41428>>>>>>>>>        Forward Send Field_Defaults
41430>>>>>>>>>        //DDB-Generated-Code-Location
41430>>>>>>>>>        //DDB-FieldDefaultStart
41430>>>>>>>>>        //DDB-FieldDefaultEnd
41430>>>>>>>>>    End_Procedure    // Field_Defaults
41431>>>>>>>>>
41431>>>>>>>>>End_Class    // Areas_DataDictionary
41432>>>>>>>>>//DDB-Selection-pkg-Start
41432>>>>>>>>>
41432>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
41432>>>>>>>>>>>//AB/ Project sl197:areas
41432>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41432>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
41432>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
41432>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41432>>>>>>>>>>>
41432>>>>>>>>>>>// Project Object Structure
41432>>>>>>>>>>>//   sl197 is a dbModalPanelSub
41432>>>>>>>>>>>//     Areas_DD is a DataDictionary
41432>>>>>>>>>>>//     oSelList is a dbListSub
41432>>>>>>>>>>>//     oOK_bn is a ButtonSub
41432>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41432>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41432>>>>>>>>>>>
41432>>>>>>>>>>>// Register all objects
41432>>>>>>>>>>>Register_Object Areas_DD
41432>>>>>>>>>>>Register_Object oCancel_bn
41432>>>>>>>>>>>Register_Object oOK_bn
41432>>>>>>>>>>>Register_Object oSearch_bn
41432>>>>>>>>>>>Register_Object oSelList
41432>>>>>>>>>>>Register_Object sl197
41432>>>>>>>>>>>
41432>>>>>>>>>>>
41432>>>>>>>>>>>    //AB-IgnoreStart
41432>>>>>>>>>>>
41432>>>>>>>>>>>    Use DFAllEnt.pkg
41432>>>>>>>>>>>    Use dbList.Sub
41432>>>>>>>>>>>    Use Button.Sub
41432>>>>>>>>>>>
41432>>>>>>>>>>>
41432>>>>>>>>>>>    Use AREAS.DD
41432>>>>>>>>>>>    
41432>>>>>>>>>>>    //AB-IgnoreEnd
41432>>>>>>>>>>>
41432>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
41434>>>>>>>>>>>
41434>>>>>>>>>>>        //AB-StoreTopStart
41434>>>>>>>>>>>                    
41434>>>>>>>>>>>        //AB-StoreTopEnd
41434>>>>>>>>>>>
41434>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
41435>>>>>>>>>>>        Set Size to 148 297
41436>>>>>>>>>>>        Set Location to 4 5
41437>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41438>>>>>>>>>>>        Set Modal_State to FALSE
41439>>>>>>>>>>>
41439>>>>>>>>>>>        //AB-DDOStart
41439>>>>>>>>>>>
41439>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
41441>>>>>>>>>>>
41441>>>>>>>>>>>            //AB-StoreStart
41441>>>>>>>>>>>                                    
41441>>>>>>>>>>>            //AB-StoreEnd
41441>>>>>>>>>>>
41441>>>>>>>>>>>        End_Object    // Areas_DD
41442>>>>>>>>>>>
41442>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
41443>>>>>>>>>>>        Set Server to (Areas_DD(self))
41444>>>>>>>>>>>
41444>>>>>>>>>>>        //AB-DDOEnd
41444>>>>>>>>>>>
41444>>>>>>>>>>>        Object oSelList is a dbListSub
41446>>>>>>>>>>>            Set Main_File to Areas.File_Number
41447>>>>>>>>>>>            Set Ordering to 2
41448>>>>>>>>>>>            Set Size to 105 280
41449>>>>>>>>>>>            Set Location to 5 5
41450>>>>>>>>>>>            Set Export_Item_State to TRUE
41451>>>>>>>>>>>
41451>>>>>>>>>>>            Begin_Row
41454>>>>>>>>>>>                Entry_Item Areas.Area_id
41455>>>>>>>>>>>                Entry_Item Areas.Area_descr
41456>>>>>>>>>>>                Entry_Item Areas.Area_site
41457>>>>>>>>>>>            End_Row
41462>>>>>>>>>>>
41462>>>>>>>>>>>            Set Form_Width    item 0 to 45
41463>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
41464>>>>>>>>>>>            
41464>>>>>>>>>>>            Set Form_Width    item 1 to 192
41465>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
41466>>>>>>>>>>>            
41466>>>>>>>>>>>            Set Form_Width    item 2 to 35
41467>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
41468>>>>>>>>>>>            
41468>>>>>>>>>>>
41468>>>>>>>>>>>            //AB-StoreStart
41468>>>>>>>>>>>            
41468>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
41469>>>>>>>>>>>            
41469>>>>>>>>>>>            
41469>>>>>>>>>>>            //AB-StoreEnd
41469>>>>>>>>>>>
41469>>>>>>>>>>>        End_Object    // oSelList
41470>>>>>>>>>>>
41470>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41472>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41473>>>>>>>>>>>            Set Location to 115 126
41474>>>>>>>>>>>
41474>>>>>>>>>>>            //AB-StoreStart
41474>>>>>>>>>>>            Procedure OnClick
41476>>>>>>>>>>>                Send OK To (oSelList(current_object))
41477>>>>>>>>>>>            End_Procedure
41478>>>>>>>>>>>            //AB-StoreEnd
41478>>>>>>>>>>>
41478>>>>>>>>>>>        End_Object    // oOK_bn
41479>>>>>>>>>>>
41479>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41481>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41482>>>>>>>>>>>            Set Location to 115 181
41483>>>>>>>>>>>
41483>>>>>>>>>>>            //AB-StoreStart
41483>>>>>>>>>>>            Procedure OnClick
41485>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41486>>>>>>>>>>>            End_Procedure
41487>>>>>>>>>>>            //AB-StoreEnd
41487>>>>>>>>>>>
41487>>>>>>>>>>>        End_Object    // oCancel_bn
41488>>>>>>>>>>>
41488>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41490>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41491>>>>>>>>>>>            Set Location to 115 236
41492>>>>>>>>>>>
41492>>>>>>>>>>>            //AB-StoreStart
41492>>>>>>>>>>>            Procedure OnClick
41494>>>>>>>>>>>                Send Search To (oSelList(current_object))
41495>>>>>>>>>>>            End_Procedure
41496>>>>>>>>>>>            //AB-StoreEnd
41496>>>>>>>>>>>
41496>>>>>>>>>>>        End_Object    // oSearch_bn
41497>>>>>>>>>>>
41497>>>>>>>>>>>
41497>>>>>>>>>>>        //AB-StoreStart
41497>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41498>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41499>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41500>>>>>>>>>>>        
41500>>>>>>>>>>>        
41500>>>>>>>>>>>        
41500>>>>>>>>>>>        
41500>>>>>>>>>>>        
41500>>>>>>>>>>>        //AB-StoreEnd
41500>>>>>>>>>>>
41500>>>>>>>>>>>    End_Object    // sl197
41501>>>>>>>>>>>
41501>>>>>>>>>>>//AB/     End_Object    // prj
41501>>>>>>>>>
41501>>>>>>>>>//DDB-Selection-pkg-End
41501>>>>>>>>>//DDB-FileEnd
41501>>>>>>>Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
41501>>>>>>>>>//DDB-FileStart
41501>>>>>>>>>//DDB-HeaderStart
41501>>>>>>>>>
41501>>>>>>>>>// File Name : PAYRESP.DD
41501>>>>>>>>>// Class Name: Payresp_DataDictionary
41501>>>>>>>>>// Revision  : 82
41501>>>>>>>>>// Version   : 2
41501>>>>>>>>>
41501>>>>>>>>>Use  Windows           // Basic Definitions
41501>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41501>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41501>>>>>>>>>
41501>>>>>>>>>Open Payresp
41503>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
41505>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
41507>>>>>>>>>Open Clients
41509>>>>>>>>>Open Sysrecc
41511>>>>>>>>>Open Gmove
41513>>>>>>>>>Open Sysrecg
41515>>>>>>>>>
41515>>>>>>>>>//DDB-HeaderEnd
41515>>>>>>>>>//DDB-ValidationStart
41515>>>>>>>>>
41515>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
41515>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
41515>>>>>>>>>Register_Object Payresp_Feregios_VT
41515>>>>>>>>>
41515>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
41517>>>>>>>>>    Set Type_Value        To "DOY"
41518>>>>>>>>>    Set Allow_Blank_State To TRUE
41519>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
41520>>>>>>>>>    //DDB-ValidationCustomStart
41520>>>>>>>>>    //DDB-ValidationCustomEnd
41520>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
41521>>>>>>>>>
41521>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
41523>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
41524>>>>>>>>>    Set Validate_State    To FALSE
41525>>>>>>>>>    Set Allow_Blank_State To TRUE
41526>>>>>>>>>    //DDB-ValidationCustomStart
41526>>>>>>>>>    //DDB-ValidationCustomEnd
41526>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
41527>>>>>>>>>
41527>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
41529>>>>>>>>>    Set Type_Value        To "FEREGIOS"
41530>>>>>>>>>    Set Allow_Blank_State To TRUE
41531>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
41532>>>>>>>>>    //DDB-ValidationCustomStart
41532>>>>>>>>>    //DDB-ValidationCustomEnd
41532>>>>>>>>>End_Object   // Payresp_Feregios_VT
41533>>>>>>>>>//DDB-ValidationEnd
41533>>>>>>>>>//DDB-SelectionStart
41533>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
41533>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41533>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41533>>>>>>>>>Register_Object sl111
41533>>>>>>>>>Register_Object sl198
41533>>>>>>>>>Register_Object sl197
41533>>>>>>>>>//DDB-SelectionEnd
41533>>>>>>>>>
41533>>>>>>>>>Open Year
41535>>>>>>>>>
41535>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
41536>>>>>>>>>
41536>>>>>>>>>    Procedure Construct_Object
41537>>>>>>>>>        Forward Send Construct_Object
41539>>>>>>>>>        Property Integer piCheckPlaf        Public 0
41540>>>>>>>>>        //------------------------------------------------
41540>>>>>>>>>        // Properties gia na kraththoun oi palies times
41540>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
41540>>>>>>>>>        // einai 1     js 03/12/2007
41540>>>>>>>>>        //------------------------------------------------
41540>>>>>>>>>        Property Integer piCreateNew            Public  0
41541>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
41542>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
41543>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
41544>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
41545>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
41546>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
41547>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
41548>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
41549>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
41550>>>>>>>>>        //------------------------------------------------
41550>>>>>>>>>
41550>>>>>>>>>    End_procedure
41551>>>>>>>>>
41551>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41552>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41554>>>>>>>>>        //------------------------------------------------
41554>>>>>>>>>        // Properties gia na kraththoun oi palies times
41554>>>>>>>>>        // ton pedion js 03/12/2007
41554>>>>>>>>>        //------------------------------------------------
41554>>>>>>>>>        Set psAud_Old_Pelaths      to Payresp.Presp_ID
41555>>>>>>>>>        Set psAud_Old_PelathsN     to Payresp.Presp_Name
41556>>>>>>>>>        Set psAud_Old_AFM          to Payresp.Presp_AFM
41557>>>>>>>>>        Set psAud_Old_DOY          to Payresp.Presp_Doy
41558>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Payresp.Presp_Doy))
41559>>>>>>>>>        Set piAud_Old_HPAL         to Payresp.Stoxos_IPAL
41560>>>>>>>>>        Set piAud_Old_HPSO         to Payresp.Stoxos_IPSO
41561>>>>>>>>>        Set psAud_Old_PartlRecr    to Payresp.Presp_Recr
41562>>>>>>>>>        Set psAud_Old_PmsRecr      to Payresp.Presp_Recr
41563>>>>>>>>>        //------------------------------------------------
41563>>>>>>>>>     End_Procedure   // New_Current_Record
41564>>>>>>>>>
41564>>>>>>>>>    Procedure Delete_Main_File
41565>>>>>>>>>        //---------------------------------------------
41565>>>>>>>>>        // Auditing / Katagrafh allagon
41565>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41566>>>>>>>>>        Date    dDate  Shmer
41566>>>>>>>>>        Integer iMin iHour iSec iLen
41566>>>>>>>>>        Sysdate dDate iHour iMin iSec
41570>>>>>>>>>        Move iHour  to sHour
41571>>>>>>>>>        Move iMin   to sMin
41572>>>>>>>>>        Move iSec   to sSec
41573>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41577>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41581>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41585>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41586>>>>>>>>>
41586>>>>>>>>>        // Auditing / Diagrafh
41586>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41588>>>>>>>>>            Get fsLoginUserID to sUser
41589>>>>>>>>>            clear gmove
41590>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
41591>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41592>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
41593>>>>>>>>>            move  3                     to gmove.gtypkin_code// Apo Clients
41594>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
41595>>>>>>>>>            move suser                  to gmove.gplan_code
41596>>>>>>>>>            move Payresp.Presp_Recr    to gmove.garticl_recr
41597>>>>>>>>>            reread sysrecg
41601>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41602>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41603>>>>>>>>>            saverecord sysrecg
41604>>>>>>>>>            unlock
41605>>>>>>>>>>
41605>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41606>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41607>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
41608>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41609>>>>>>>>>
41609>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41610>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41611>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
41612>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
41613>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
41614>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
41615>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
41616>>>>>>>>>
41616>>>>>>>>>
41616>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"     to gmove.gmove_aitiol
41617>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
41618>>>>>>>>>            saverecord gmove
41619>>>>>>>>>        End
41619>>>>>>>>>>
41619>>>>>>>>>        Forward Send Delete_Main_File
41621>>>>>>>>>
41621>>>>>>>>>    End_Procedure
41622>>>>>>>>>
41622>>>>>>>>>    Procedure Update
41623>>>>>>>>>        Forward Send Update
41625>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
41626>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
41627>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
41628>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
41628>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
41629>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
41630>>>>>>>>>
41630>>>>>>>>>        //betolink
41630>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
41631>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
41632>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
41633>>>>>>>>>
41633>>>>>>>>>        //---------------------------------------------
41633>>>>>>>>>        // Auditing / Katagrafh allagon
41633>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41634>>>>>>>>>        Date    dDate  Shmer
41634>>>>>>>>>        Integer iMin iHour iSec iLen
41634>>>>>>>>>        Sysdate dDate iHour iMin iSec
41638>>>>>>>>>        Move iHour  to sHour
41639>>>>>>>>>        Move iMin   to sMin
41640>>>>>>>>>        Move iSec   to sSec
41641>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41645>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41649>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41653>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41654>>>>>>>>>
41654>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41654>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41656>>>>>>>>>            Get fsLoginUserID to sUser
41657>>>>>>>>>            If (piCreateNew(Self)=1) Begin
41659>>>>>>>>>                clear gmove
41660>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
41661>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41662>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
41663>>>>>>>>>                move  3                     to gmove.gtypkin_code// Apo Clients
41664>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
41665>>>>>>>>>                move suser                  to gmove.gplan_code
41666>>>>>>>>>                move Payresp.Presp_Recr     to gmove.garticl_recr
41667>>>>>>>>>                reread sysrecg
41671>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41672>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41673>>>>>>>>>                saverecord sysrecg
41674>>>>>>>>>                unlock
41675>>>>>>>>>>
41675>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
41676>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41677>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41678>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41679>>>>>>>>>                Move Payresp.Presp_ID               to Gmove.Cur_ID
41680>>>>>>>>>                Move Payresp.Presp_Name             to Gmove.Cur_Name
41681>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
41682>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
41683>>>>>>>>>                Move Payresp.Presp_AFM              to Gmove.Cur_AFM
41684>>>>>>>>>                Move Payresp.Presp_DOY              to Gmove.Cur_DOY
41685>>>>>>>>>                Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
41686>>>>>>>>>                Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
41687>>>>>>>>>                Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
41688>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤" to Gmove.Gmove_Aitiol
41689>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
41690>>>>>>>>>                saverecord gmove
41691>>>>>>>>>                Set piCreateNew to 0
41692>>>>>>>>>            End
41692>>>>>>>>>>
41692>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41695>>>>>>>>>                Integer isChanged
41695>>>>>>>>>                Move 0 to isChanged
41696>>>>>>>>>                
41696>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Payresp.Presp_ID   ) Move 1 to isChanged
41699>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Payresp.Presp_Name ) Move 1 to isChanged
41703>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Payresp.Presp_AFM  ) Move 1 to isChanged
41707>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Payresp.Presp_DOY  ) Move 1 to isChanged
41711>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Payresp.Stoxos_IPAL) Move 1 to isChanged
41715>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Payresp.Stoxos_IPSO) Move 1 to isChanged
41719>>>>>>>>>                
41719>>>>>>>>>                If (isChanged>0) Begin  
41721>>>>>>>>>                    clear gmove
41722>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41723>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41724>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41725>>>>>>>>>                    move  3                     to gmove.gtypkin_code// Apo Clients
41726>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41727>>>>>>>>>                    move suser                  to gmove.gplan_code
41728>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
41729>>>>>>>>>                    reread sysrecg
41733>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41734>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41735>>>>>>>>>                    saverecord sysrecg
41736>>>>>>>>>                    unlock
41737>>>>>>>>>>
41737>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
41738>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41739>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41740>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41741>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
41742>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
41743>>>>>>>>>                    //--
41743>>>>>>>>>                    Move Payresp.Presp_ID               to Gmove.Cur_ID
41744>>>>>>>>>                    Move Payresp.Presp_Name             to Gmove.Cur_Name
41745>>>>>>>>>                    Move Payresp.Presp_AFM              to Gmove.Cur_AFM
41746>>>>>>>>>                    Move Payresp.Presp_DOY              to Gmove.Cur_DOY
41747>>>>>>>>>                    Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
41748>>>>>>>>>                    Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
41749>>>>>>>>>                    Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
41750>>>>>>>>>                    //--
41750>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41751>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41752>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
41753>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
41754>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
41755>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
41756>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
41757>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"  to gmove.gmove_aitiol
41758>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
41759>>>>>>>>>                    saverecord gmove
41760>>>>>>>>>                    Set piCreateNew to 0
41761>>>>>>>>>                End
41761>>>>>>>>>>
41761>>>>>>>>>            End
41761>>>>>>>>>>
41761>>>>>>>>>        End
41761>>>>>>>>>>
41761>>>>>>>>>
41761>>>>>>>>>    End_Procedure   // Update
41762>>>>>>>>>
41762>>>>>>>>>     Procedure Creating
41763>>>>>>>>>        Forward Send Creating
41765>>>>>>>>>        // Insert Code Here
41765>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
41766>>>>>>>>>        Move '1'                    to payresp.presp_Active
41767>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
41768>>>>>>>>>        clear year
41769>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
41770>>>>>>>>>        move syscurxr.company_code  to year.company_code
41771>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
41772>>>>>>>>>        find eq year by index.1
41773>>>>>>>>>>
41773>>>>>>>>>        if (found=1) begin
41775>>>>>>>>>            move year.payresp_plafon to payresp.plafon
41776>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
41777>>>>>>>>>        end
41777>>>>>>>>>>
41777>>>>>>>>>        Set piCreateNew to 1
41778>>>>>>>>>    End_Procedure   // Creating
41779>>>>>>>>>
41779>>>>>>>>>   Function Validate_Save  Returns Integer
41780>>>>>>>>>        Integer iReturnVal iCheck iYes
41781>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41783>>>>>>>>>        If (Not(iReturnVal)) Begin
41785>>>>>>>>>
41785>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
41787>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
41788>>>>>>>>>                If (iCheck) Begin
41790>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
41793>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
41797>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
41801>>>>>>>>>                End
41801>>>>>>>>>>
41801>>>>>>>>>            End
41801>>>>>>>>>>
41801>>>>>>>>>
41801>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
41803>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
41805>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
41806>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
41809>>>>>>>>>                End
41809>>>>>>>>>>
41809>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
41812>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
41813>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
41816>>>>>>>>>                End
41816>>>>>>>>>>
41816>>>>>>>>>           End
41816>>>>>>>>>>
41816>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41819>>>>>>>>>        End
41819>>>>>>>>>>
41819>>>>>>>>>        Function_Return iReturnVal
41820>>>>>>>>>    End_Function   // Validate_Save
41821>>>>>>>>>
41821>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
41822>>>>>>>>>        String lsError_Message
41823>>>>>>>>>        Case Begin
41823>>>>>>>>>            Case (iError_Num = 4001)
41825>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
41826>>>>>>>>>              Case Break
41827>>>>>>>>>            Case (iError_Num = 4002)
41830>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
41831>>>>>>>>>              Case Break
41832>>>>>>>>>            Case (iError_Num = 4003)
41835>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
41836>>>>>>>>>              Case Break
41837>>>>>>>>>            Case (iError_Num = 4004)
41840>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
41841>>>>>>>>>              Case Break
41842>>>>>>>>>            Case (iError_Num = 4005)
41845>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
41846>>>>>>>>>              Case Break
41847>>>>>>>>>            Case Else
41847>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
41849>>>>>>>>>        Case End
41849>>>>>>>>>        Error iError_Num lsError_Message
41850>>>>>>>>>>
41850>>>>>>>>>    End_Procedure // operation_not_allowed
41851>>>>>>>>>
41851>>>>>>>>>
41851>>>>>>>>>
41851>>>>>>>>>    Procedure Define_Fields
41852>>>>>>>>>        Forward Send Define_Fields
41854>>>>>>>>>        //DDB-Generated-Code-Location
41854>>>>>>>>>        //DDB-DefineFieldStart
41854>>>>>>>>>
41854>>>>>>>>>        Set Main_File            To Payresp.File_Number
41855>>>>>>>>>        Set Cascade_Delete_State To FALSE
41856>>>>>>>>>
41856>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41857>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41858>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41859>>>>>>>>>
41859>>>>>>>>>        // Child (Client) file structure................
41859>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
41860>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
41861>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41862>>>>>>>>>
41862>>>>>>>>>        // External (System) file structure.............
41862>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41863>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41864>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41865>>>>>>>>>
41865>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
41868>>>>>>>>>
41868>>>>>>>>>        // Field-based properties.......................
41868>>>>>>>>>
41868>>>>>>>>>        // Payresp.Company_Code
41868>>>>>>>>>
41868>>>>>>>>>        // Payresp.Branch_Code
41868>>>>>>>>>
41868>>>>>>>>>        // Payresp.Year_Year
41868>>>>>>>>>
41868>>>>>>>>>        // Payresp.Custprom_Code
41868>>>>>>>>>
41868>>>>>>>>>        // Payresp.Presp_Id
41868>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
41869>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
41870>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
41871>>>>>>>>>
41871>>>>>>>>>        // Payresp.Presp_Name
41871>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Presp_Afm
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Presp_Rec0
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Custprom_Recr
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Presp_Recr
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Last_Xreosh
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Last_Pistosh
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Last_Order
41872>>>>>>>>>
41872>>>>>>>>>        // Payresp.Presp_Doy
41872>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
41873>>>>>>>>>
41873>>>>>>>>>        // Payresp.Presp_Address
41873>>>>>>>>>
41873>>>>>>>>>        // Payresp.Presp_City_Id
41873>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
41874>>>>>>>>>
41874>>>>>>>>>        // Payresp.Presp_Area
41874>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Job
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Respons
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Zipcode
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Phone
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Fax
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Mobile
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Aoh
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Email
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Class
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Details
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Sitew
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Codem
41875>>>>>>>>>
41875>>>>>>>>>        // Payresp.Presp_Categfpa
41875>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Fpa
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Public
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Sn
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Repm
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Active
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Reported
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Pelprom
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Lastupd
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Markexp
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Catjob
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Is_Promhtheyths
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Xreosh
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Pistosh
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Ypoloipo
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Plafon
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Overhead
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Add_No
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Nomos
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Presp_Xora
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Polh_Recr
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Synolikh_Ofeilh
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Stoxos_Ipal
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Stoxos_Ipso
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Poso_Se_Apait
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Posa_Apo_Dap
41876>>>>>>>>>
41876>>>>>>>>>        // Payresp.Feregios
41876>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
41877>>>>>>>>>
41877>>>>>>>>>        //DDB-DefineFieldEnd
41877>>>>>>>>>    End_Procedure    // Define_Fields
41878>>>>>>>>>
41878>>>>>>>>>    // Field_Defaults:
41878>>>>>>>>>    // This procedure is used to establish default field values.
41878>>>>>>>>>
41878>>>>>>>>>    Procedure Field_Defaults
41879>>>>>>>>>        Forward Send Field_Defaults
41881>>>>>>>>>        //DDB-Generated-Code-Location
41881>>>>>>>>>        //DDB-FieldDefaultStart
41881>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
41882>>>>>>>>>        //DDB-FieldDefaultEnd
41882>>>>>>>>>    End_Procedure    // Field_Defaults
41883>>>>>>>>>
41883>>>>>>>>>End_Class    // Payresp_DataDictionary
41884>>>>>>>>>//DDB-Selection-pkg-Start
41884>>>>>>>>>
41884>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
41884>>>>>>>>>>>//AB/ Project sl111
41884>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41884>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
41884>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
41884>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41884>>>>>>>>>>>
41884>>>>>>>>>>>// Project Object Structure
41884>>>>>>>>>>>//   sl111 is a dbModalPanelSub
41884>>>>>>>>>>>//     Payresp_DD is a DataDictionary
41884>>>>>>>>>>>//     oSelList is a dbListSub
41884>>>>>>>>>>>//     oOK_bn is a ButtonSub
41884>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41884>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41884>>>>>>>>>>>
41884>>>>>>>>>>>// Register all objects
41884>>>>>>>>>>>Register_Object oCancel_bn
41884>>>>>>>>>>>Register_Object oOK_bn
41884>>>>>>>>>>>Register_Object oSearch_bn
41884>>>>>>>>>>>Register_Object oSelList
41884>>>>>>>>>>>Register_Object Payresp_DD
41884>>>>>>>>>>>Register_Object sl111
41884>>>>>>>>>>>
41884>>>>>>>>>>>
41884>>>>>>>>>>>//AB-IgnoreStart
41884>>>>>>>>>>>
41884>>>>>>>>>>>Use DFAllEnt.pkg
41884>>>>>>>>>>>Use dbList.Sub
41884>>>>>>>>>>>Use Button.Sub
41884>>>>>>>>>>>
41884>>>>>>>>>>>
41884>>>>>>>>>>>Use PAYRESP.DD
41884>>>>>>>>>>>
41884>>>>>>>>>>>//AB-IgnoreEnd
41884>>>>>>>>>>>
41884>>>>>>>>>>>Object sl111 is a dbModalPanelSub
41886>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
41887>>>>>>>>>>>    Set Size to 148 443
41888>>>>>>>>>>>    Set Location to 4 5
41889>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41890>>>>>>>>>>>    Set Modal_State to FALSE
41891>>>>>>>>>>>
41891>>>>>>>>>>>    //AB-DDOStart
41891>>>>>>>>>>>
41891>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
41893>>>>>>>>>>>    End_Object    // Payresp_DD
41894>>>>>>>>>>>
41894>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
41895>>>>>>>>>>>    Set Server to (Payresp_DD(self))
41896>>>>>>>>>>>
41896>>>>>>>>>>>    //AB-DDOEnd
41896>>>>>>>>>>>
41896>>>>>>>>>>>    Object oSelList is a dbListSub
41898>>>>>>>>>>>        Set Main_File to Payresp.File_Number
41899>>>>>>>>>>>        Set Size to 105 430
41900>>>>>>>>>>>        Set Location to 6 6
41901>>>>>>>>>>>
41901>>>>>>>>>>>        Begin_Row
41904>>>>>>>>>>>            Entry_Item Payresp.Presp_id
41905>>>>>>>>>>>            Entry_Item Payresp.Presp_name
41906>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
41907>>>>>>>>>>>            Entry_Item Payresp.Presp_address
41908>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
41909>>>>>>>>>>>        End_Row
41914>>>>>>>>>>>
41914>>>>>>>>>>>        Set Form_Width    item 0 to 60
41915>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41916>>>>>>>>>>>        
41916>>>>>>>>>>>        Set Form_Width    item 1 to 106
41917>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
41918>>>>>>>>>>>        
41918>>>>>>>>>>>        Set Form_Width    item 2 to 60
41919>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
41920>>>>>>>>>>>        
41920>>>>>>>>>>>        Set Form_Width    item 3 to 135
41921>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
41922>>>>>>>>>>>        
41922>>>>>>>>>>>        Set Form_Width    item 4 to 60
41923>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
41924>>>>>>>>>>>        
41924>>>>>>>>>>>    End_Object    // oSelList
41925>>>>>>>>>>>
41925>>>>>>>>>>>    Object oOK_bn is a ButtonSub
41927>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41928>>>>>>>>>>>        Set Location to 113 277
41929>>>>>>>>>>>
41929>>>>>>>>>>>        //AB-StoreStart
41929>>>>>>>>>>>        Procedure OnClick
41931>>>>>>>>>>>            Send OK To (oSelList(current_object))
41932>>>>>>>>>>>        End_Procedure
41933>>>>>>>>>>>        //AB-StoreEnd
41933>>>>>>>>>>>
41933>>>>>>>>>>>    End_Object    // oOK_bn
41934>>>>>>>>>>>
41934>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
41936>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41937>>>>>>>>>>>        Set Location to 113 332
41938>>>>>>>>>>>
41938>>>>>>>>>>>        //AB-StoreStart
41938>>>>>>>>>>>        Procedure OnClick
41940>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41941>>>>>>>>>>>        End_Procedure
41942>>>>>>>>>>>        //AB-StoreEnd
41942>>>>>>>>>>>
41942>>>>>>>>>>>    End_Object    // oCancel_bn
41943>>>>>>>>>>>
41943>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
41945>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
41946>>>>>>>>>>>        Set Location to 113 387
41947>>>>>>>>>>>
41947>>>>>>>>>>>        //AB-StoreStart
41947>>>>>>>>>>>        Procedure OnClick
41949>>>>>>>>>>>            Send Search To (oSelList(current_object))
41950>>>>>>>>>>>        End_Procedure
41951>>>>>>>>>>>        //AB-StoreEnd
41951>>>>>>>>>>>
41951>>>>>>>>>>>    End_Object    // oSearch_bn
41952>>>>>>>>>>>
41952>>>>>>>>>>>
41952>>>>>>>>>>>    //AB-StoreStart
41952>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41953>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41954>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41955>>>>>>>>>>>    //AB-StoreEnd
41955>>>>>>>>>>>
41955>>>>>>>>>>>End_Object    // sl111
41956>>>>>>>>>>>
41956>>>>>>>>>>>//AB/ End_Object    // prj
41956>>>>>>>>>Use sl198.sl         // sl198
41956>>>>>>>>>Use sl197.SL         // sl197
41956>>>>>>>>>
41956>>>>>>>>>//DDB-Selection-pkg-End
41956>>>>>>>>>//DDB-FileEnd
41956>>>>>>>Use CLIENTS.DD
41956>>>>>>>
41956>>>>>>>//AB-IgnoreEnd
41956>>>>>>>
41956>>>>>>>Object Barticl is a dbModalPanelSub
41958>>>>>>>
41958>>>>>>>    //AB-StoreTopStart
41958>>>>>>>                    
41958>>>>>>>    Property Integer    piWhat              Public  0
41960>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
41962>>>>>>>    Property Integer    piIsOpen            Public  0
41964>>>>>>>    Property String     FragmaClientID      Public ''
41966>>>>>>>    Property String     FragmaClientEpon    Public ''
41968>>>>>>>    Property Date       FragmaHmnia         Public ''
41970>>>>>>>    
41970>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
41972>>>>>>>    End_Object
41973>>>>>>>    
41973>>>>>>>    
41973>>>>>>>    //AB-StoreTopEnd
41973>>>>>>>
41973>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
41974>>>>>>>    Set Size to 289 519
41975>>>>>>>    Set Location to 2 5
41976>>>>>>>    Set Exit_Application_Local_State to FALSE
41977>>>>>>>    Set Modal_State to FALSE
41978>>>>>>>
41978>>>>>>>    //AB-DDOStart
41978>>>>>>>
41978>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
41980>>>>>>>    End_Object    // Btypkin_DD
41981>>>>>>>
41981>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
41983>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
41984>>>>>>>
41984>>>>>>>        //AB-StoreStart
41984>>>>>>>                                                
41984>>>>>>>        Begin_Constraints
41986>>>>>>>            Integer iTypkinCode iWhat isOpen
41987>>>>>>>            String  sClientID sClientEpon
41987>>>>>>>            Date    dHmnia
41987>>>>>>>        
41987>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
41988>>>>>>>            Get FragmaClientID      to sClientID
41989>>>>>>>            Get FragmaClientEpon    to sClientEpon
41990>>>>>>>            Get FragmaHmnia         to dHmnia
41991>>>>>>>            Get piIsOpen            to isOpen
41992>>>>>>>        
41992>>>>>>>            If (iTypkinCode<>'') Begin
41994>>>>>>>                If (sClientID<>'') Begin
41996>>>>>>>                    Set Ordering Of Barticl_DD to 8
41997>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
41997>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
41999>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42001>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42003>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
42005>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
42007>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
42011>>>>>>>                End
42011>>>>>>>>
42011>>>>>>>                Else Begin
42012>>>>>>>                    Set Ordering Of Barticl_DD to 11
42013>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
42013>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42015>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42017>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42019>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
42021>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
42025>>>>>>>                End
42025>>>>>>>>
42025>>>>>>>            End
42025>>>>>>>>
42025>>>>>>>            Else If (dHmnia<>'') Begin
42028>>>>>>>                Set Ordering Of Barticl_DD to 9
42029>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
42029>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42031>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42033>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42035>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
42037>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
42041>>>>>>>            End
42041>>>>>>>>
42041>>>>>>>            Else If (sClientID<>'') Begin
42044>>>>>>>                Set Ordering Of Barticl_DD to 8
42045>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
42045>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42047>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42049>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42051>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
42053>>>>>>>            End
42053>>>>>>>>
42053>>>>>>>            Else Begin
42054>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42056>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42058>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42060>>>>>>>            End
42060>>>>>>>>
42060>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
42064>>>>>>>        End_Constraints
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        
42067>>>>>>>        //AB-StoreEnd
42067>>>>>>>
42067>>>>>>>    End_Object    // Barticl_DD
42068>>>>>>>
42068>>>>>>>    Object Country_DD is a Country_DataDictionary
42070>>>>>>>    End_Object    // Country_DD
42071>>>>>>>
42071>>>>>>>    Object Towns_DD is a Towns_DataDictionary
42073>>>>>>>        Set DDO_Server to (Country_DD(self))
42074>>>>>>>    End_Object    // Towns_DD
42075>>>>>>>
42075>>>>>>>    Object Cities_DD is a Cities_DataDictionary
42077>>>>>>>        Set DDO_Server to (Towns_DD(self))
42078>>>>>>>    End_Object    // Cities_DD
42079>>>>>>>
42079>>>>>>>    Object Areas_DD is a Areas_DataDictionary
42081>>>>>>>    End_Object    // Areas_DD
42082>>>>>>>
42082>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
42084>>>>>>>    End_Object    // Payresp_DD
42085>>>>>>>
42085>>>>>>>    Object Clients_DD is a Clients_DataDictionary
42087>>>>>>>        Set DDO_Server to (Cities_DD(self))
42088>>>>>>>        Set DDO_Server to (Areas_DD(self))
42089>>>>>>>        Set DDO_Server to (Payresp_DD(self))
42090>>>>>>>    End_Object    // Clients_DD
42091>>>>>>>
42091>>>>>>>    Set Main_DD to (Barticl_DD(self))
42092>>>>>>>    Set Server to (Barticl_DD(self))
42093>>>>>>>
42093>>>>>>>    //AB-DDOEnd
42093>>>>>>>
42093>>>>>>>    Object oSelList is a dbListSub
42095>>>>>>>        Set Main_File to Barticl.File_Number
42096>>>>>>>        Set Size to 219 505
42097>>>>>>>        Set Location to 6 6
42098>>>>>>>
42098>>>>>>>        Begin_Row
42101>>>>>>>            Entry_Item Barticl.Barticl_no
42102>>>>>>>            Entry_Item Barticl.Arith_orist
42103>>>>>>>            Entry_Item Barticl.Barticl_hmnia
42104>>>>>>>            Entry_Item Btypkin.Btypkin_code
42105>>>>>>>            Entry_Item Btypkin.Btypkin_descr
42106>>>>>>>            Entry_Item Barticl.Barticl_code1
42107>>>>>>>            Entry_Item Barticl.Barticl_epon1
42108>>>>>>>            Entry_Item Barticl.Barticl_sv0
42109>>>>>>>            Entry_Item Barticl.Barticl_ekleise
42110>>>>>>>            Entry_Item Barticl.Isotimia
42111>>>>>>>        End_Row
42116>>>>>>>
42116>>>>>>>        Set Form_Width    item 0 to 47
42117>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
42118>>>>>>>        
42118>>>>>>>        Set Form_Width    item 1 to 47
42119>>>>>>>        Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
42120>>>>>>>        
42120>>>>>>>        Set Form_Width    item 2 to 48
42121>>>>>>>        Set Header_Label  item 2 to "†£œ¨/¤å˜"
42122>>>>>>>        
42122>>>>>>>        Set Form_Width    item 3 to 39
42123>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž"
42124>>>>>>>        
42124>>>>>>>        Set Form_Width    item 4 to 80
42125>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã"
42126>>>>>>>        
42126>>>>>>>        Set Form_Width    item 5 to 55
42127>>>>>>>        Set Header_Label  item 5 to "‘¬¤˜¢/¤¦ª"
42128>>>>>>>        
42128>>>>>>>        Set Form_Width    item 6 to 96
42129>>>>>>>        Set Header_Label  item 6 to "„§à¤¬£å˜"
42130>>>>>>>        
42130>>>>>>>        Set Form_Width    item 7 to 50
42131>>>>>>>        Set Header_Label  item 7 to "¦©æ"
42132>>>>>>>        
42132>>>>>>>        Set Form_Width    item 8 to 16
42133>>>>>>>        Set Header_Label  item 8 to "‰"
42134>>>>>>>        Set Column_Checkbox_State  item 8 to True
42135>>>>>>>        
42135>>>>>>>        Set Form_Width    item 9 to 22
42136>>>>>>>        Set Header_Label  item 9 to "„¡«."
42137>>>>>>>        Set Column_Checkbox_State  item 9 to True
42138>>>>>>>        
42138>>>>>>>
42138>>>>>>>        //AB-StoreStart
42138>>>>>>>        
42138>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
42138>>>>>>>        //Property String  StoreFragmaClientID    Public ''
42138>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
42138>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
42138>>>>>>>        
42138>>>>>>>        Procedure End_Construct_Object
42140>>>>>>>            Integer iDecimals
42141>>>>>>>            Forward Send End_Construct_Object
42143>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
42144>>>>>>>            Set Points Item 7 to iDecimals
42145>>>>>>>            Set Numeric_Mask Item 7 to 14 iDecimals ' ,*'
42146>>>>>>>        End_Procedure
42147>>>>>>>        
42147>>>>>>>        //Procedure Store_Defaults
42147>>>>>>>        //       Forward Send Store_Defaults
42147>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
42147>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
42147>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
42147>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
42147>>>>>>>        //End_Procedure
42147>>>>>>>        
42147>>>>>>>        //Procedure ReStore_Defaults
42147>>>>>>>        //       Forward Send ReStore_Defaults
42147>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
42147>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
42147>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
42147>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
42147>>>>>>>        //End_Procedure
42147>>>>>>>        
42147>>>>>>>        Procedure Activate
42149>>>>>>>            Send Keyaction to ButtonSub1
42150>>>>>>>            Forward Send Activate
42152>>>>>>>        End_procedure
42153>>>>>>>        
42153>>>>>>>        Procedure Activating
42155>>>>>>>            Forward Send Activating
42157>>>>>>>            Set Auto_Index_State to True
42158>>>>>>>        End_Procedure
42159>>>>>>>        
42159>>>>>>>        
42159>>>>>>>        //AB-StoreEnd
42159>>>>>>>
42159>>>>>>>    End_Object    // oSelList
42160>>>>>>>
42160>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
42162>>>>>>>        Entry_Item Btypkin.Btypkin_code
42163>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
42164>>>>>>>        Set Size to 13 49
42165>>>>>>>        Set Location to 229 84
42166>>>>>>>        Set Label_Col_Offset to 5
42167>>>>>>>        Set Label_Justification_Mode to jMode_Right
42168>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42169>>>>>>>
42169>>>>>>>        //AB-StoreStart
42169>>>>>>>                                                                                                                        
42169>>>>>>>        Set Server to (Btypkin_DD2(Self))
42170>>>>>>>        
42170>>>>>>>        Procedure Key Integer iKey
42172>>>>>>>            Integer iRetVal
42173>>>>>>>            Forward Send Key iKey
42175>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
42178>>>>>>>        End_Procedure
42179>>>>>>>        
42179>>>>>>>        
42179>>>>>>>        //AB-StoreEnd
42179>>>>>>>
42179>>>>>>>    End_Object    // Btypkin_Btypkin_Code
42180>>>>>>>
42180>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
42182>>>>>>>        Entry_Item Btypkin.Btypkin_descr
42183>>>>>>>        Set Size to 13 133
42184>>>>>>>        Set Location to 229 139
42185>>>>>>>        Set Color to clBtnFace
42186>>>>>>>        Set Label_Col_Offset to 2
42187>>>>>>>        Set Label_Justification_Mode to jMode_Right
42188>>>>>>>        Set Enabled_State to FALSE
42189>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42190>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
42191>>>>>>>        Set Shadow_State Item 0 to TRUE
42192>>>>>>>
42192>>>>>>>        //AB-StoreStart
42192>>>>>>>        Set Server to (Btypkin_DD2(Self))
42193>>>>>>>        
42193>>>>>>>        //AB-StoreEnd
42193>>>>>>>
42193>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
42194>>>>>>>
42194>>>>>>>    Object Clients_Client_Name is a dbFormSub
42196>>>>>>>        Entry_Item Clients.Client_name
42197>>>>>>>        Set Server to (Clients_DD(self))
42198>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
42199>>>>>>>        Set Size to 13 188
42200>>>>>>>        Set Location to 244 84
42201>>>>>>>        Set Label_Col_Offset to 5
42202>>>>>>>        Set Label_Justification_Mode to jMode_Right
42203>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42204>>>>>>>
42204>>>>>>>        //AB-StoreStart
42204>>>>>>>                                                                                                                        
42204>>>>>>>        Procedure Key Integer iKey
42206>>>>>>>            Integer iRetVal
42207>>>>>>>            Forward Send Key iKey
42209>>>>>>>            If (iKey=277) Send Clear to Clients_DD
42212>>>>>>>        End_Procedure
42213>>>>>>>        
42213>>>>>>>        //AB-StoreEnd
42213>>>>>>>
42213>>>>>>>    End_Object    // Clients_Client_Name
42214>>>>>>>
42214>>>>>>>    Object cSyDateForm1 is a cSyDateForm
42216>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
42217>>>>>>>        Set Size to 13 66
42218>>>>>>>        Set Location to 258 84
42219>>>>>>>        Set Label_Col_Offset to 5
42220>>>>>>>        Set Label_Justification_Mode to jMode_Right
42221>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
42222>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42223>>>>>>>
42223>>>>>>>        //AB-StoreStart
42223>>>>>>>                                                                                                                        
42223>>>>>>>        On_Key KClear Send ClearMe
42224>>>>>>>        
42224>>>>>>>        Procedure ClearMe
42226>>>>>>>            Set Value Item 0 to ''
42227>>>>>>>        End_Procedure
42228>>>>>>>        
42228>>>>>>>        //AB-StoreEnd
42228>>>>>>>
42228>>>>>>>    End_Object    // cSyDateForm1
42229>>>>>>>
42229>>>>>>>    Object chkOpen is a CheckBoxSub
42231>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
42232>>>>>>>        Set Size to 10 62
42233>>>>>>>        Set Location to 260 156
42234>>>>>>>    End_Object    // chkOpen
42235>>>>>>>
42235>>>>>>>    Object ButtonSub1 is a ButtonSub
42237>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
42238>>>>>>>        Set Size to 13 52
42239>>>>>>>        Set Location to 258 219
42240>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42241>>>>>>>
42241>>>>>>>        //AB-StoreStart
42241>>>>>>>                                                        
42241>>>>>>>        Procedure OnClick
42243>>>>>>>            String  sEpon sID
42244>>>>>>>            Integer iTypkin isOpen
42244>>>>>>>            Date    dHmnia
42244>>>>>>>        
42244>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
42245>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
42246>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
42247>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
42248>>>>>>>        
42248>>>>>>>            Get Checked_State Of chkOpen to isOpen
42249>>>>>>>        
42249>>>>>>>            Set FragmaTypkinCode    to iTypkin
42250>>>>>>>            Set FragmaClientID      to sID
42251>>>>>>>            Set FragmaClientEpon    to sEpon
42252>>>>>>>            Set FragmaHmnia         to dHmnia
42253>>>>>>>            Set piIsOpen            to isOpen
42254>>>>>>>        
42254>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
42255>>>>>>>            Send Beginning_Of_Data      to oSelList True
42256>>>>>>>        End_Procedure // OnClick
42257>>>>>>>        
42257>>>>>>>        
42257>>>>>>>        
42257>>>>>>>        //AB-StoreEnd
42257>>>>>>>
42257>>>>>>>    End_Object    // ButtonSub1
42258>>>>>>>
42258>>>>>>>    Object oOK_bn is a ButtonSub
42260>>>>>>>        Set Label to "&„§ ¢¦šã"
42261>>>>>>>        Set Size to 13 50
42262>>>>>>>        Set Location to 258 406
42263>>>>>>>        Set Focus_Mode to Pointer_Only
42264>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42265>>>>>>>
42265>>>>>>>        //AB-StoreStart
42265>>>>>>>        Procedure OnClick
42267>>>>>>>            Send OK To (oSelList(current_object))
42268>>>>>>>        End_Procedure
42269>>>>>>>        //AB-StoreEnd
42269>>>>>>>
42269>>>>>>>    End_Object    // oOK_bn
42270>>>>>>>
42270>>>>>>>    Object oCancel_bn is a ButtonSub
42272>>>>>>>        Set Label to "&€¡ç¨à©ž"
42273>>>>>>>        Set Size to 13 50
42274>>>>>>>        Set Location to 258 461
42275>>>>>>>        Set Focus_Mode to Pointer_Only
42276>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42277>>>>>>>
42277>>>>>>>        //AB-StoreStart
42277>>>>>>>        Procedure OnClick
42279>>>>>>>            Send Cancel To (oSelList(current_object))
42280>>>>>>>        End_Procedure
42281>>>>>>>        //AB-StoreEnd
42281>>>>>>>
42281>>>>>>>    End_Object    // oCancel_bn
42282>>>>>>>
42282>>>>>>>
42282>>>>>>>    //AB-StoreStart
42282>>>>>>>                    
42282>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42283>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42284>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42285>>>>>>>    
42285>>>>>>>    Set Modal_State to True
42286>>>>>>>    
42286>>>>>>>    Procedure Activate
42288>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
42290>>>>>>>            Send Clear to Btypkin_DD2
42291>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
42292>>>>>>>            Send Find to Btypkin_DD2 Eq 1
42293>>>>>>>        End
42293>>>>>>>>
42293>>>>>>>        Else Send Clear to Btypkin_DD2
42295>>>>>>>        If (FragmaClientID(Self)<>'') Begin
42297>>>>>>>            Send Clear to Clients_DD
42298>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
42299>>>>>>>            Send Find to Clients_DD Eq 6
42300>>>>>>>        End
42300>>>>>>>>
42300>>>>>>>        Else Send Clear to Clients_DD
42302>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
42305>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
42307>>>>>>>        Forward Send Activate
42309>>>>>>>    End_Procedure
42310>>>>>>>    
42310>>>>>>>    //AB-StoreEnd
42310>>>>>>>
42310>>>>>>>End_Object    // Barticl
42311>>>>>>>
42311>>>>>>>//AB/ End_Object    // prj
42311>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
42311>>>>>>>//AB/ Project CN : sl041
42311>>>>>>>//AB/     Object prj is a Lookup_Project
42311>>>>>>>//AB/         Set ProjectName to "CN : sl041"
42311>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
42311>>>>>>>//AB/         Set GenerateFileName to "NONAME"
42311>>>>>>>
42311>>>>>>>// Project Object Structure
42311>>>>>>>//   sl041 is a dbModalPanelSub
42311>>>>>>>//     Clients_DD is a DataDictionary
42311>>>>>>>//     Cn_DD is a DataDictionary
42311>>>>>>>//     oSelList is a dbListSub
42311>>>>>>>//     oOK_bn is a ButtonSub
42311>>>>>>>//     oCancel_bn is a ButtonSub
42311>>>>>>>//     oSearch_bn is a ButtonSub
42311>>>>>>>
42311>>>>>>>// Register all objects
42311>>>>>>>Register_Object Clients_DD
42311>>>>>>>Register_Object Cn_DD
42311>>>>>>>Register_Object oCancel_bn
42311>>>>>>>Register_Object oOK_bn
42311>>>>>>>Register_Object oSearch_bn
42311>>>>>>>Register_Object oSelList
42311>>>>>>>Register_Object sl041
42311>>>>>>>
42311>>>>>>>
42311>>>>>>>    //AB-IgnoreStart
42311>>>>>>>
42311>>>>>>>    Use DFAllEnt.pkg
42311>>>>>>>    Use dbList.Sub
42311>>>>>>>    Use Button.Sub
42311>>>>>>>
42311>>>>>>>
42311>>>>>>>    Use CLIENTS.DD
42311>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
42311>>>>>>>>>//DDB-FileStart
42311>>>>>>>>>//DDB-HeaderStart
42311>>>>>>>>>
42311>>>>>>>>>// File Name : CN.DD
42311>>>>>>>>>// Class Name: Cn_DataDictionary
42311>>>>>>>>>// Revision  : 99
42311>>>>>>>>>// Version   : 2
42311>>>>>>>>>
42311>>>>>>>>>Use  Windows           // Basic Definitions
42311>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42311>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42311>>>>>>>>>
42311>>>>>>>>>Open Cn
42313>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
42315>>>>>>>>>Open Tperga
42317>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
42319>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
42321>>>>>>>>>Open Clients
42323>>>>>>>>>Open Salesmen
42325>>>>>>>>>Open Mhxanik
42327>>>>>>>>>Open Constrct
42329>>>>>>>>>Open Sysrecc
42331>>>>>>>>>Open Syscurxr
42333>>>>>>>>>Open Gmove
42335>>>>>>>>>Open Sysrecg
42337>>>>>>>>>
42337>>>>>>>>>//DDB-HeaderEnd
42337>>>>>>>>>//DDB-ValidationStart
42337>>>>>>>>>
42337>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
42337>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
42337>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
42337>>>>>>>>>Register_Object Cn_Yesno_VT
42337>>>>>>>>>
42337>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
42339>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
42340>>>>>>>>>    Set Validate_State    To FALSE
42341>>>>>>>>>    Set Allow_Blank_State To TRUE
42342>>>>>>>>>    //DDB-ValidationCustomStart
42342>>>>>>>>>    //DDB-ValidationCustomEnd
42342>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
42343>>>>>>>>>
42343>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
42345>>>>>>>>>    Set Type_Value        To "FORTOSH"
42346>>>>>>>>>    Set Allow_Blank_State To TRUE
42347>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
42348>>>>>>>>>    //DDB-ValidationCustomStart
42348>>>>>>>>>    //DDB-ValidationCustomEnd
42348>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
42349>>>>>>>>>
42349>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
42351>>>>>>>>>    Set Type_Value        To "EIDOSCN"
42352>>>>>>>>>    Set Allow_Blank_State To TRUE
42353>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
42354>>>>>>>>>    //DDB-ValidationCustomStart
42354>>>>>>>>>    //DDB-ValidationCustomEnd
42354>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
42355>>>>>>>>>
42355>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
42357>>>>>>>>>    Set Type_Value        To "YESNO"
42358>>>>>>>>>    Set Allow_Blank_State To TRUE
42359>>>>>>>>>    //DDB-ValidationCustomStart
42359>>>>>>>>>    //DDB-ValidationCustomEnd
42359>>>>>>>>>End_Object   // Cn_Yesno_VT
42360>>>>>>>>>//DDB-ValidationEnd
42360>>>>>>>>>//DDB-SelectionStart
42360>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
42360>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
42360>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
42360>>>>>>>>>Register_Object sl041
42360>>>>>>>>>Register_Object sl198
42360>>>>>>>>>Register_Object sl197
42360>>>>>>>>>//DDB-SelectionEnd
42360>>>>>>>>>
42360>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
42361>>>>>>>>>
42361>>>>>>>>>
42361>>>>>>>>>    Procedure Construct_Object
42362>>>>>>>>>        Forward Send Construct_Object
42364>>>>>>>>>        //------------------------------------------------
42364>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42364>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
42364>>>>>>>>>        // einai 1     js 03/12/2007
42364>>>>>>>>>        //------------------------------------------------  
42364>>>>>>>>>        Property Integer piCreateNew            Public  0
42365>>>>>>>>>        Property String  psAud_Old_CN           Public ""
42366>>>>>>>>>        Property String  psAud_Old_CNAdd        Public ""
42367>>>>>>>>>        Property String  psAud_Old_Chem         Public ""
42368>>>>>>>>>        Property String  psAud_Old_CNRecr       Public ""
42369>>>>>>>>>        //------------------------------------------------
42369>>>>>>>>>
42369>>>>>>>>>    End_procedure
42370>>>>>>>>>
42370>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42371>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42373>>>>>>>>>        //------------------------------------------------
42373>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42373>>>>>>>>>        // ton pedion js 03/12/2007
42373>>>>>>>>>        //------------------------------------------------
42373>>>>>>>>>        Set psAud_Old_CN           to CN.CN_Code
42374>>>>>>>>>        Set psAud_Old_CNAdd        to CN.CN_Descr
42375>>>>>>>>>        Set psAud_Old_Chem         to CN.CN_VTicket
42376>>>>>>>>>        Set psAud_Old_CNRecr       to CN.CN_Recr
42377>>>>>>>>>        //------------------------------------------------
42377>>>>>>>>>     End_Procedure   // New_Current_Record
42378>>>>>>>>>
42378>>>>>>>>>    Procedure Delete_Main_File
42379>>>>>>>>>        //---------------------------------------------
42379>>>>>>>>>        // Auditing / Katagrafh allagon
42379>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42380>>>>>>>>>        Date    dDate  Shmer 
42380>>>>>>>>>        Integer iMin iHour iSec iLen
42380>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42384>>>>>>>>>        Move iHour  to sHour
42385>>>>>>>>>        Move iMin   to sMin
42386>>>>>>>>>        Move iSec   to sSec
42387>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42391>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42395>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42399>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42400>>>>>>>>>        
42400>>>>>>>>>        // Auditing / Diagrafh 
42400>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
42402>>>>>>>>>            Get fsLoginUserID to sUser
42403>>>>>>>>>            clear gmove
42404>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
42405>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
42406>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
42407>>>>>>>>>            move  4                     to gmove.gtypkin_code// Apo Clients
42408>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
42409>>>>>>>>>            move suser                  to gmove.gplan_code
42410>>>>>>>>>            move CN.CN_Recr             to gmove.garticl_recr
42411>>>>>>>>>            reread sysrecg
42415>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42416>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42417>>>>>>>>>            saverecord sysrecg
42418>>>>>>>>>            unlock
42419>>>>>>>>>>
42419>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
42420>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
42421>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
42422>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
42423>>>>>>>>>            
42423>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Partl_Recr          
42424>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Pms_Recr          
42425>>>>>>>>>
42425>>>>>>>>>            Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
42426>>>>>>>>>            Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
42427>>>>>>>>>            Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
42428>>>>>>>>>
42428>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
42429>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
42430>>>>>>>>>            saverecord gmove
42431>>>>>>>>>        End
42431>>>>>>>>>>
42431>>>>>>>>>        Forward Send Delete_Main_File
42433>>>>>>>>>
42433>>>>>>>>>    End_Procedure
42434>>>>>>>>>
42434>>>>>>>>>    Procedure Update
42435>>>>>>>>>        Forward Send Update
42437>>>>>>>>>        // Insert Code Here
42437>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
42438>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
42439>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
42440>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
42440>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
42441>>>>>>>>>
42441>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
42442>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
42443>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
42444>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
42445>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
42446>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
42447>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
42448>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
42449>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
42450>>>>>>>>>
42450>>>>>>>>>        //---------------------------------------------
42450>>>>>>>>>        // Auditing / Katagrafh allagon
42450>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42451>>>>>>>>>        Date    dDate  Shmer 
42451>>>>>>>>>        Integer iMin iHour iSec iLen
42451>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42455>>>>>>>>>        Move iHour  to sHour
42456>>>>>>>>>        Move iMin   to sMin
42457>>>>>>>>>        Move iSec   to sSec
42458>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42462>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42466>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42470>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42471>>>>>>>>>        
42471>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
42471>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
42473>>>>>>>>>            Get fsLoginUserID to sUser
42474>>>>>>>>>            If (piCreateNew(Self)=1) Begin
42476>>>>>>>>>                clear gmove
42477>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
42478>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
42479>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
42480>>>>>>>>>                move  4                     to gmove.gtypkin_code// Apo Clients
42481>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
42482>>>>>>>>>                move suser                  to gmove.gplan_code
42483>>>>>>>>>                move CN.CN_Recr             to gmove.garticl_recr
42484>>>>>>>>>                reread sysrecg
42488>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42489>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42490>>>>>>>>>                saverecord sysrecg
42491>>>>>>>>>                unlock
42492>>>>>>>>>>
42492>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
42493>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
42494>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
42495>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
42496>>>>>>>>>
42496>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Partl_Recr          
42497>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Pms_Recr          
42498>>>>>>>>>
42498>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
42499>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
42500>>>>>>>>>                Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
42501>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
42502>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
42503>>>>>>>>>                saverecord gmove
42504>>>>>>>>>                Set piCreateNew to 0
42505>>>>>>>>>            End
42505>>>>>>>>>>
42505>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
42508>>>>>>>>>                Integer isChanged
42508>>>>>>>>>                Move 0 to isChanged
42509>>>>>>>>>                
42509>>>>>>>>>                     If (psAud_Old_CN   (Self)<>CN.CN_Code   ) Move 1 to isChanged
42512>>>>>>>>>                Else If (psAud_Old_CNAdd(Self)<>CN.CN_Descr  ) Move 1 to isChanged
42516>>>>>>>>>                Else If (psAud_Old_Chem (Self)<>CN.CN_VTicket) Move 1 to isChanged
42520>>>>>>>>>                
42520>>>>>>>>>                If (isChanged>0) Begin  
42522>>>>>>>>>                    clear gmove
42523>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
42524>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
42525>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
42526>>>>>>>>>                    move  4                     to gmove.gtypkin_code// Apo Clients
42527>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
42528>>>>>>>>>                    move suser                  to gmove.gplan_code
42529>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
42530>>>>>>>>>                    reread sysrecg
42534>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42535>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42536>>>>>>>>>                    saverecord sysrecg
42537>>>>>>>>>                    unlock
42538>>>>>>>>>>
42538>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
42539>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
42540>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
42541>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
42542>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Partl_Recr          
42543>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Pms_Recr          
42544>>>>>>>>>                    //--                                
42544>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
42545>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
42546>>>>>>>>>                    Move CN.CN_VTicket                  to Gmove.Cur_CN_Prosth
42547>>>>>>>>>                    //--
42547>>>>>>>>>                    Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
42548>>>>>>>>>                    Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
42549>>>>>>>>>                    Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
42550>>>>>>>>>
42550>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
42551>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
42552>>>>>>>>>                    saverecord gmove
42553>>>>>>>>>                    Set piCreateNew to 0
42554>>>>>>>>>                End
42554>>>>>>>>>>
42554>>>>>>>>>            End
42554>>>>>>>>>>
42554>>>>>>>>>        End
42554>>>>>>>>>>
42554>>>>>>>>>
42554>>>>>>>>>
42554>>>>>>>>>    End_Procedure   // Update
42555>>>>>>>>>
42555>>>>>>>>>     Procedure Creating
42556>>>>>>>>>        Forward Send Creating
42558>>>>>>>>>        // Insert Code Here
42558>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
42559>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
42560>>>>>>>>>        Set piCreateNew to 1
42561>>>>>>>>>    End_Procedure   // Creating
42562>>>>>>>>>
42562>>>>>>>>>
42562>>>>>>>>>
42562>>>>>>>>>    // Define_Fields:
42562>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42562>>>>>>>>>
42562>>>>>>>>>    Procedure Define_Fields
42563>>>>>>>>>        Forward Send Define_Fields
42565>>>>>>>>>        //DDB-Generated-Code-Location
42565>>>>>>>>>        //DDB-DefineFieldStart
42565>>>>>>>>>
42565>>>>>>>>>        Set Main_File            To Cn.File_Number
42566>>>>>>>>>        Set Cascade_Delete_State To FALSE
42567>>>>>>>>>
42567>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42568>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42569>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42570>>>>>>>>>
42570>>>>>>>>>        // Child (Client) file structure................
42570>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
42571>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
42572>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
42573>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
42574>>>>>>>>>
42574>>>>>>>>>        // Parent (Server) file structure...............
42574>>>>>>>>>        Send Add_Server_File  Clients.File_Number
42575>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
42576>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
42577>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
42578>>>>>>>>>
42578>>>>>>>>>        // External (System) file structure.............
42578>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
42579>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
42580>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
42581>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
42582>>>>>>>>>
42582>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
42585>>>>>>>>>
42585>>>>>>>>>        // Field-based properties.......................
42585>>>>>>>>>
42585>>>>>>>>>        // Cn.Company_Code
42585>>>>>>>>>
42585>>>>>>>>>        // Cn.Branch_Code
42585>>>>>>>>>
42585>>>>>>>>>        // Cn.Year_Year
42585>>>>>>>>>
42585>>>>>>>>>        // Cn.Custprom_Code
42585>>>>>>>>>
42585>>>>>>>>>        // Cn.Client_Id
42585>>>>>>>>>
42585>>>>>>>>>        // Cn.Cn_Code
42585>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
42586>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
42587>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
42588>>>>>>>>>
42588>>>>>>>>>        // Cn.Client_Recr
42588>>>>>>>>>
42588>>>>>>>>>        // Cn.Cn_Rec0
42588>>>>>>>>>
42588>>>>>>>>>        // Cn.Cn_Recr
42588>>>>>>>>>
42588>>>>>>>>>        // Cn.Cn_Descr
42588>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
42589>>>>>>>>>
42589>>>>>>>>>        // Cn.Cn_Address
42589>>>>>>>>>
42589>>>>>>>>>        // Cn.Cn_Zipcode
42589>>>>>>>>>
42589>>>>>>>>>        // Cn.Cn_City
42589>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
42590>>>>>>>>>
42590>>>>>>>>>        // Cn.Cn_Area
42590>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_License
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Responsible
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Cnt_Recr
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Cnt_Id
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Phone
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Zone
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Sls_Recr
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Sls_Id
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Details
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Distance
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Pump
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Pumplicense
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Totalstats
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Analstats
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Coated
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Sitew
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Clientmatch
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Codematch
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Pumpid
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Clientid
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Sn
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Repmatch
42591>>>>>>>>>
42591>>>>>>>>>        // Cn.Cn_Active
42591>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Reported
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Lastupdated
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Markexp
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Vdetails
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Vticket
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Constraction_Id
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Presp_Id
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Presp_Recr
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Add_No
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Nomos
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Cn_Xora
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Polh_Recr
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Lic_Number
42592>>>>>>>>>
42592>>>>>>>>>        // Cn.Lic_Date
42592>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
42593>>>>>>>>>
42593>>>>>>>>>        // Cn.Lic_Lixi
42593>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
42594>>>>>>>>>
42594>>>>>>>>>        // Cn.Lic_Auth
42594>>>>>>>>>
42594>>>>>>>>>        // Cn.Cn_Start_Date
42594>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
42595>>>>>>>>>
42595>>>>>>>>>        // Cn.Cn_End_Date
42595>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
42596>>>>>>>>>
42596>>>>>>>>>        // Cn.Cn_Categfpa
42596>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
42597>>>>>>>>>
42597>>>>>>>>>        // Cn.Cn_Tpay
42597>>>>>>>>>
42597>>>>>>>>>        // Cn.Mhxanik_Id
42597>>>>>>>>>
42597>>>>>>>>>        // Cn.Sum_Pct_Tper
42597>>>>>>>>>
42597>>>>>>>>>        // Cn.Cn_M3
42597>>>>>>>>>
42597>>>>>>>>>        // Cn.Aa_Deop
42597>>>>>>>>>
42597>>>>>>>>>        // Cn.Hm_Tel_Fortio
42597>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
42598>>>>>>>>>
42598>>>>>>>>>        // Cn.Tel_Fortio_No
42598>>>>>>>>>
42598>>>>>>>>>        // Cn.Tropos_Metaf
42598>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
42599>>>>>>>>>
42599>>>>>>>>>        // Cn.Eidos_Cn
42599>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
42600>>>>>>>>>
42600>>>>>>>>>        // Cn.Polhths_Constr
42600>>>>>>>>>
42600>>>>>>>>>        // Cn.Polhths_Mhx
42600>>>>>>>>>
42600>>>>>>>>>        // Cn.Hm_Prot_Fortio
42600>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
42601>>>>>>>>>
42601>>>>>>>>>        // Cn.Mesoskyklos
42601>>>>>>>>>
42601>>>>>>>>>        // Cn.Diodia
42601>>>>>>>>>
42601>>>>>>>>>        // Cn.Yesno
42601>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
42602>>>>>>>>>
42602>>>>>>>>>        // Cn.Dateeggy
42602>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Branch
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Exfd1
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Exfd2
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Exfd3
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Exfd4
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Exfd5
42603>>>>>>>>>
42603>>>>>>>>>        // Cn.Cn_Exfd6
42603>>>>>>>>>
42603>>>>>>>>>        //DDB-DefineFieldEnd
42603>>>>>>>>>    End_Procedure    // Define_Fields
42604>>>>>>>>>
42604>>>>>>>>>    // Field_Defaults:
42604>>>>>>>>>    // This procedure is used to establish default field values.
42604>>>>>>>>>          
42604>>>>>>>>>    Procedure Field_Defaults
42605>>>>>>>>>        Forward Send Field_Defaults
42607>>>>>>>>>        //DDB-Generated-Code-Location
42607>>>>>>>>>        //DDB-FieldDefaultStart
42607>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
42608>>>>>>>>>        //DDB-FieldDefaultEnd
42608>>>>>>>>>    End_Procedure    // Field_Defaults
42609>>>>>>>>>
42609>>>>>>>>>End_Class    // Cn_DataDictionary
42610>>>>>>>>>//DDB-Selection-pkg-Start
42610>>>>>>>>>
42610>>>>>>>>>Use sl041.sl         // sl041
42610>>>>>>>>>Use sl198.sl         // sl198
42610>>>>>>>>>Use sl197.SL         // sl197
42610>>>>>>>>>
42610>>>>>>>>>//DDB-Selection-pkg-End
42610>>>>>>>>>//DDB-FileEnd
42610>>>>>>>    
42610>>>>>>>    //AB-IgnoreEnd
42610>>>>>>>
42610>>>>>>>    Object sl041 is a dbModalPanelSub
42612>>>>>>>
42612>>>>>>>        //AB-StoreTopStart
42612>>>>>>>        Property String FragmaClient_ID Public ''
42614>>>>>>>        
42614>>>>>>>        //AB-StoreTopEnd
42614>>>>>>>
42614>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
42615>>>>>>>        Set Size to 249 500
42616>>>>>>>        Set Location to 2 6
42617>>>>>>>        Set Exit_Application_Local_State to FALSE
42618>>>>>>>        Set Modal_State to FALSE
42619>>>>>>>
42619>>>>>>>        //AB-DDOStart
42619>>>>>>>
42619>>>>>>>        Object Clients_DD is a Clients_DataDictionary
42621>>>>>>>
42621>>>>>>>            //AB-StoreStart
42621>>>>>>>                                                                                                                                                                                                                                        
42621>>>>>>>                                                                                                                                                                                                                                        
42621>>>>>>>                                                                                                                                                                                                                                        
42621>>>>>>>            //AB-StoreEnd
42621>>>>>>>
42621>>>>>>>        End_Object    // Clients_DD
42622>>>>>>>
42622>>>>>>>        Object Cn_DD is a Cn_DataDictionary
42624>>>>>>>            Set DDO_Server to (Clients_DD(self))
42625>>>>>>>
42625>>>>>>>            //AB-StoreStart
42625>>>>>>>                                            
42625>>>>>>>            Begin_Constraints
42627>>>>>>>                String sID
42628>>>>>>>                Get FragmaClient_ID to sID
42629>>>>>>>                If (sID<>'') begin
42631>>>>>>>                    set ordering to 4
42632>>>>>>>                    Constrain CN.Client_ID eq sID
42634>>>>>>>                end
42634>>>>>>>>
42634>>>>>>>                ELSE SET ORDERING TO -1
42636>>>>>>>            End_Constraints
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            
42639>>>>>>>            //AB-StoreEnd
42639>>>>>>>
42639>>>>>>>        End_Object    // Cn_DD
42640>>>>>>>
42640>>>>>>>        Set Main_DD to (Cn_DD(self))
42641>>>>>>>        Set Server to (Cn_DD(self))
42642>>>>>>>
42642>>>>>>>        //AB-DDOEnd
42642>>>>>>>
42642>>>>>>>        Object oSelList is a dbListSub
42644>>>>>>>            Set Main_File to Cn.File_Number
42645>>>>>>>            Set Ordering to 4
42646>>>>>>>            Set Size to 209 481
42647>>>>>>>            Set Location to 6 6
42648>>>>>>>            Set Auto_Index_State to FALSE
42649>>>>>>>
42649>>>>>>>            Begin_Row
42652>>>>>>>                Entry_Item Cn.Cn_code
42653>>>>>>>                Entry_Item Cn.Cn_descr
42654>>>>>>>                Entry_Item Cn.Client_id
42655>>>>>>>                Entry_Item Clients.Client_name
42656>>>>>>>                Entry_Item Cn.Cn_active
42657>>>>>>>            End_Row
42662>>>>>>>
42662>>>>>>>            Set Form_Width    item 0 to 61
42663>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
42664>>>>>>>            
42664>>>>>>>            Set Form_Width    item 1 to 185
42665>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
42666>>>>>>>            
42666>>>>>>>            Set Form_Width    item 2 to 60
42667>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
42668>>>>>>>            
42668>>>>>>>            Set Form_Width    item 3 to 123
42669>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
42670>>>>>>>            
42670>>>>>>>            Set Form_Width    item 4 to 44
42671>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
42672>>>>>>>            Set Column_Checkbox_State  item 4 to True
42673>>>>>>>            
42673>>>>>>>
42673>>>>>>>            //AB-StoreStart
42673>>>>>>>                                            
42673>>>>>>>            Property String StoreFragmaClient_ID Public ''
42675>>>>>>>            
42675>>>>>>>            Procedure Store_Defaults
42677>>>>>>>                   Forward Send Store_Defaults
42679>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
42680>>>>>>>            End_Procedure
42681>>>>>>>            
42681>>>>>>>            Procedure ReStore_Defaults
42683>>>>>>>                   Forward Send ReStore_Defaults
42685>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
42686>>>>>>>            End_Procedure
42687>>>>>>>            
42687>>>>>>>            Procedure Activating Returns Integer
42689>>>>>>>                Integer rVal
42690>>>>>>>                Forward Get Msg_Activating to rVal
42692>>>>>>>                set auto_index_state to true
42693>>>>>>>                SET ORDERING TO -1
42694>>>>>>>                Procedure_Return rVal
42695>>>>>>>            End_Procedure
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            
42696>>>>>>>            //AB-StoreEnd
42696>>>>>>>
42696>>>>>>>        End_Object    // oSelList
42697>>>>>>>
42697>>>>>>>        Object oOK_bn is a ButtonSub
42699>>>>>>>            Set Label to "&„§ ¢¦šã"
42700>>>>>>>            Set Location to 219 327
42701>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42702>>>>>>>
42702>>>>>>>            //AB-StoreStart
42702>>>>>>>            Procedure OnClick
42704>>>>>>>                Send OK To (oSelList(current_object))
42705>>>>>>>            End_Procedure
42706>>>>>>>            //AB-StoreEnd
42706>>>>>>>
42706>>>>>>>        End_Object    // oOK_bn
42707>>>>>>>
42707>>>>>>>        Object oCancel_bn is a ButtonSub
42709>>>>>>>            Set Label to "&€¡ç¨à©ž"
42710>>>>>>>            Set Location to 219 383
42711>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42712>>>>>>>
42712>>>>>>>            //AB-StoreStart
42712>>>>>>>            Procedure OnClick
42714>>>>>>>                Send Cancel To (oSelList(current_object))
42715>>>>>>>            End_Procedure
42716>>>>>>>            //AB-StoreEnd
42716>>>>>>>
42716>>>>>>>        End_Object    // oCancel_bn
42717>>>>>>>
42717>>>>>>>        Object oSearch_bn is a ButtonSub
42719>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
42720>>>>>>>            Set Location to 219 437
42721>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42722>>>>>>>
42722>>>>>>>            //AB-StoreStart
42722>>>>>>>            Procedure OnClick
42724>>>>>>>                Send Search To (oSelList(current_object))
42725>>>>>>>            End_Procedure
42726>>>>>>>            //AB-StoreEnd
42726>>>>>>>
42726>>>>>>>        End_Object    // oSearch_bn
42727>>>>>>>
42727>>>>>>>
42727>>>>>>>        //AB-StoreStart
42727>>>>>>>                        
42727>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42728>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42729>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42730>>>>>>>        Set Modal_State to True
42731>>>>>>>        Procedure Activating Returns Integer
42733>>>>>>>            Integer rVal
42734>>>>>>>            Forward Get Msg_Activating to rVal
42736>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
42737>>>>>>>            Send Beginning_Of_Data to oSelList
42738>>>>>>>            Procedure_Return rVal
42739>>>>>>>        End_Procedure
42740>>>>>>>        
42740>>>>>>>        procedure page integer pagemode
42742>>>>>>>            forward send page pagemode
42744>>>>>>>            set location to 40,40
42745>>>>>>>        end_procedure
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        
42746>>>>>>>        //AB-StoreEnd
42746>>>>>>>
42746>>>>>>>    End_Object    // sl041
42747>>>>>>>
42747>>>>>>>//AB/     End_Object    // prj
42747>>>>>
42747>>>>>//DDB-Selection-pkg-End
42747>>>>>//DDB-FileEnd
42747>>>Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
42747>>>>>//DDB-FileStart
42747>>>>>//DDB-HeaderStart
42747>>>>>
42747>>>>>// File Name : BAXIO.DD
42747>>>>>// Class Name: Baxio_DataDictionary
42747>>>>>// Revision  : 112
42747>>>>>// Version   : 2
42747>>>>>
42747>>>>>Use  Windows           // Basic Definitions
42747>>>>>Use  DataDict          // DataDictionary Class Definition
42747>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42747>>>>>
42747>>>>>Open Baxio
42749>>>>>Open Bmove
42751>>>>>Open Baxiokat
42753>>>>>Open Sysrecb
42755>>>>>
42755>>>>>//DDB-HeaderEnd
42755>>>>>//DDB-ValidationStart
42755>>>>>
42755>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
42755>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
42755>>>>>
42755>>>>>Register_Object Baxio_Status_VT
42755>>>>>Register_Object Baxio_Baxio_Place_VT
42755>>>>>Register_Object Bfile_VT
42755>>>>>Register_Object Baxio_Baxio_Bank_VT
42755>>>>>Register_Object Baxio_Baxio_Banka_VT
42755>>>>>Register_Object Baxio_Baxio_From_VT
42755>>>>>Register_Object Baxio_Baxio_Topos_VT1
42755>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
42755>>>>>
42755>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
42757>>>>>    Set Type_Value        To "BAXIOPLACE"
42758>>>>>    //DDB-ValidationCustomStart
42758>>>>>    //DDB-ValidationCustomEnd
42758>>>>>End_Object   // Baxio_Baxio_Place_VT
42759>>>>>
42759>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
42761>>>>>    Set Type_Value        To "BANK"
42762>>>>>    Set Allow_Blank_State To TRUE
42763>>>>>    //DDB-ValidationCustomStart
42763>>>>>    //DDB-ValidationCustomEnd
42763>>>>>End_Object   // Baxio_Baxio_Bank_VT
42764>>>>>
42764>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
42766>>>>>    Set Type_Value        To "BANK"
42767>>>>>    Set Allow_Blank_State To TRUE
42768>>>>>    //DDB-ValidationCustomStart
42768>>>>>    //DDB-ValidationCustomEnd
42768>>>>>End_Object   // Baxio_Baxio_Banka_VT
42769>>>>>
42769>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
42771>>>>>    Set Allow_Blank_State To TRUE
42772>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
42773>>>>>
42773>>>>>    Procedure Fill_List
42775>>>>>        Forward Send Fill_List
42777>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
42778>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
42779>>>>>    End_Procedure    // Fill_List
42780>>>>>    //DDB-ValidationCustomStart
42780>>>>>    //DDB-ValidationCustomEnd
42780>>>>>End_Object   // Baxio_Baxio_From_VT
42781>>>>>
42781>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
42783>>>>>    Set Allow_Blank_State To TRUE
42784>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
42785>>>>>
42785>>>>>    Procedure Fill_List
42787>>>>>        Forward Send Fill_List
42789>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
42790>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
42791>>>>>    End_Procedure    // Fill_List
42792>>>>>    //DDB-ValidationCustomStart
42792>>>>>    //DDB-ValidationCustomEnd
42792>>>>>End_Object   // Baxio_Baxio_Topos_VT1
42793>>>>>//DDB-ValidationEnd
42793>>>>>//DDB-SelectionStart
42793>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
42793>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
42793>>>>>Register_Object SL037
42793>>>>>Register_Object slNomism
42793>>>>>//DDB-SelectionEnd
42793>>>>>
42793>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
42794>>>>>
42794>>>>>      Procedure Construct_Object
42795>>>>>                Forward Send Construct_Object
42797>>>>>
42797>>>>>                //btypkin related properties:
42797>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
42797>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
42797>>>>>                Property Integer piBtypkin_Flag03 0
42798>>>>>                Property Integer piBtypkin_Flag04 0
42799>>>>>                Property Integer pifromxrhsh      0
42800>>>>>
42800>>>>>                //baxio related properties:
42800>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
42800>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
42800>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
42800>>>>>                Property Integer piCreated_Baxio  0
42801>>>>>
42801>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
42801>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
42801>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
42801>>>>>                Property Number  pnB_Baxio_V2      0
42802>>>>>                Property Number  pnB_Baxio_V0      0
42803>>>>>                Property Number  pnB_Baxio_V00     0
42804>>>>>                Property Number  pnB_Baxio_Vr      0
42805>>>>>                Property String  psB_Baxio_C_Code2 ""
42806>>>>>                Property Integer piB_Baxio_Status  0
42807>>>>>                Property Integer piB_Baxio_Place   0
42808>>>>>
42808>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
42808>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
42808>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
42808>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
42808>>>>>                Property Integer piB_Baxiokat_Code 0
42809>>>>>                Property Integer piB_Year_Year     0
42810>>>>>                Property Integer piMustNOTConstrain Public 0
42811>>>>>      End_Procedure //construct_object
42812>>>>>
42812>>>>>
42812>>>>>
42812>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
42812>>>>>//                            Number anPoso           ;
42812>>>>>//                            String asNomismaCodeSe  ;
42812>>>>>//                            Date   adHmnia          ;
42812>>>>>//                            Number nIsotimia  Returns Number
42812>>>>>
42812>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
42812>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
42812>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
42812>>>>>
42812>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
42812>>>>>
42812>>>>>//        Clear Nomisma
42812>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
42812>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
42812>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
42812>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
42812>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
42812>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
42812>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
42812>>>>>
42812>>>>>//        Clear Nomisma
42812>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
42812>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
42812>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
42812>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
42812>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
42812>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
42812>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
42812>>>>>
42812>>>>>//        //05a. ??ÿ??? ? --> ??? 
42812>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
42812>>>>>//        Move (Round_Number(rVal,6)) to rVal
42812>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
42812>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
42812>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
42812>>>>>//        Function_Return rVal
42812>>>>>//    End_Function
42812>>>>>
42812>>>>>
42812>>>>>
42812>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
42812>>>>>      Function Default_Axio_C_Code2 Returns String
42813>>>>>               String lsBaxio_C_Code_2
42814>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
42814>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
42815>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
42816>>>>>      End_Function //default_axio_c_code2
42817>>>>>
42817>>>>>
42817>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
42817>>>>>      Procedure Convert_Axio_Values
42818>>>>>
42818>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
42819>>>>>
42819>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
42820>>>>>
42820>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
42821>>>>>
42821>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
42822>>>>>
42822>>>>>
42822>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
42822>>>>>//                                     Baxio.Baxio_V2,        ;
42822>>>>>//                                     SyscurXr.C_Code0,      ;
42822>>>>>//                                     Baxio.Baxio_HmniaE,    ;
42822>>>>>//                                     Baxio.Baxio_Rate0)     ;
42822>>>>>//                                    ) to Baxio.Baxio_V0
42822>>>>>//                If (liBtypkin_Flag03 = TRUE);
42822>>>>>//                     Begin
42822>>>>>//                      //˜¥å˜ 2-->00
42822>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
42822>>>>>//                                            Baxio.Baxio_V2,      ;
42822>>>>>//                                            SyscurXr.C_Code00,   ;
42822>>>>>//                                            Baxio.Baxio_HmniaE,  ;
42822>>>>>//                                            Baxio.Baxio_Rate00)  ;
42822>>>>>//                                          ) to Baxio.Baxio_V00
42822>>>>>//                     End
42822>>>>>//                Else Begin
42822>>>>>//                      Move 0            to Baxio.Baxio_V00
42822>>>>>//                     End
42822>>>>>//                If (liBtypkin_Flag04 = TRUE);
42822>>>>>//                     Begin
42822>>>>>//                      //˜¥å˜ 2-->r
42822>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
42822>>>>>//                                       Baxio.Baxio_V2,      ;
42822>>>>>//                                       SyscurXr.C_CodeR,    ;
42822>>>>>//                                       Baxio.Baxio_HmniaE,  ;
42822>>>>>//                                       Baxio.Baxio_RateR)   ;
42822>>>>>//                                      ) to Baxio.Baxio_VR
42822>>>>>//                     End
42822>>>>>//                Else Begin
42822>>>>>//                      Move 0            to Baxio.Baxio_VR
42822>>>>>//                     End
42822>>>>>      End_Procedure
42823>>>>>
42823>>>>>
42823>>>>>
42823>>>>>      Procedure Constrain
42824>>>>>                Forward Send Constrain
42826>>>>>                If (piMustNOTConstrain(Self)=1) Begin
42828>>>>>                End 
42828>>>>>>
42828>>>>>                else If (piMustNOTConstrain(Self)=2) Begin 
42831>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
42833>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
42835>>>>>                end    
42835>>>>>>
42835>>>>>                Else Begin
42836>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
42838>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
42840>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
42842>>>>>                End
42842>>>>>>
42842>>>>>      End_Procedure   //constrain
42843>>>>>
42843>>>>>
42843>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
42843>>>>>      //™) ˜¤áš¤à©ž properties
42843>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
42843>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
42843>>>>>      //œ) œ¤ž£â¨à©ž properties after
42843>>>>>      Procedure Update
42844>>>>>                Forward Send Update
42846>>>>>                
42846>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
42849>>>>>                
42849>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
42849>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
42850>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
42851>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
42852>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
42853>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
42854>>>>>
42854>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
42854>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
42854>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
42856>>>>>                     Move "" to Baxio.Baxio_Code_In
42857>>>>>                     Move "" to Baxio.Baxio_Epon_In
42858>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
42859>>>>>                End
42859>>>>>>
42859>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
42859>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
42860>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
42861>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
42862>>>>>
42862>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
42862>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
42864>>>>>                     Move (-1) to Baxio.Baxio_File_Out
42865>>>>>                     Move ""   to Baxio.Baxio_Code_Out
42866>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
42867>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
42868>>>>>
42868>>>>>                     Move (-1) to Baxio.Baxio_Lfile
42869>>>>>                     Move ""   to Baxio.Baxio_Lepon
42870>>>>>                     Move ""   to Baxio.Baxio_Lpar
42871>>>>>                End
42871>>>>>>
42871>>>>>      End_Procedure //update
42872>>>>>
42872>>>>>
42872>>>>>      Procedure Backout
42873>>>>>                Forward Send Backout
42875>>>>>
42875>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
42875>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
42876>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
42877>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
42878>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
42879>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
42880>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
42881>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
42882>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42883>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42884>>>>>      End_Procedure //backout
42885>>>>>
42885>>>>>
42885>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
42886>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
42888>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
42888>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
42889>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
42890>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
42891>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
42892>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
42893>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
42894>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42895>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42896>>>>>      End_Procedure //new_current_record
42897>>>>>
42897>>>>>
42897>>>>>      Procedure Creating
42898>>>>>                Forward Send Creating
42900>>>>>
42900>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
42900>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
42900>>>>>
42900>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
42900>>>>>                Add 1 to Baxiokat.Baxio_Lcode
42901>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
42902>>>>>
42902>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
42902>>>>>                //£â©à «žª update ©«¦ bmove
42902>>>>>                Set piCreated_Baxio to TRUE
42903>>>>>
42903>>>>>//
42903>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
42903>>>>>
42903>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
42904>>>>>
42904>>>>>      End_Procedure //creating
42905>>>>>
42905>>>>>
42905>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
42906>>>>>                String lsError_Message
42907>>>>>                Case Begin
42907>>>>>                     //˜§æ validate save
42907>>>>>                     Case (iError_Num = 1001)
42909>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
42910>>>>>                     Case Break
42911>>>>>                     Case (iError_Num = 1002)
42914>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42915>>>>>                     Case Break
42916>>>>>                     Case (iError_Num = 1003)
42919>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
42920>>>>>                     Case Break
42921>>>>>                     Case (iError_Num = 1004)
42924>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42925>>>>>                     Case Break
42926>>>>>                     Case (iError_Num = 1005)
42929>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42930>>>>>                     Case Break
42931>>>>>                     Case (iError_Num = 1006)
42934>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42935>>>>>                     Case Break
42936>>>>>
42936>>>>>                     Case (iError_Num = 1007)
42939>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42940>>>>>                     Case Break
42941>>>>>                     Case (iError_Num = 1008)
42944>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42945>>>>>                     Case Break
42946>>>>>                     Case (iError_Num = 1009)
42949>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42950>>>>>                     Case Break
42951>>>>>                     Case (iError_Num = 1010)
42954>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42955>>>>>                     Case Break
42956>>>>>                     Case (iError_Num = 1011)
42959>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42960>>>>>                     Case Break
42961>>>>>                     Case (iError_Num = 1012)
42964>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42965>>>>>                     Case Break
42966>>>>>                     Case (iError_Num = 1013)
42969>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
42970>>>>>                     Case Break
42971>>>>>
42971>>>>>                     Case (iError_Num = 1014)
42974>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
42975>>>>>                     Case Break
42976>>>>>                     Case (iError_Num = 1015)
42979>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
42980>>>>>                     Case Break
42981>>>>>                     Case (iError_Num = 1100)
42984>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
42985>>>>>                          Case Break
42986>>>>>
42986>>>>>                     //˜§æ validate delete
42986>>>>>                     Case (iError_Num = 2007)
42989>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42990>>>>>                     Case Break
42991>>>>>                     Case (iError_Num = 2100)
42994>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
42995>>>>>                          Case Break
42996>>>>>
42996>>>>>                     Case Else
42996>>>>>                          Forward Send Operation_Not_Allowed iError_Num
42998>>>>>                Case End
42998>>>>>
42998>>>>>                Error iError_Num lsError_Message
42999>>>>>>
42999>>>>>      End_Procedure // operation_not_allowed
43000>>>>>
43000>>>>>      //1001:baxio_hmnial > 0
43000>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
43000>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
43000>>>>>
43000>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
43000>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
43000>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
43000>>>>>
43000>>>>>
43000>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
43000>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
43000>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
43000>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
43000>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
43000>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
43000>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
43000>>>>>
43000>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
43000>>>>>
43000>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
43000>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
43000>>>>>      Function Validate_Save Returns Integer
43001>>>>>               Integer iReturnVal
43002>>>>>
43002>>>>>               Forward Get Validate_Save to iReturnVal
43004>>>>>
43004>>>>>               If (Not(iReturnVal));               Begin
43006>>>>>
43006>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
43006>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
43006>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
43008>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
43008>>>>>
43008>>>>>                      If (pifromxrhsh(Self)=0) Begin
43010>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
43013>>>>>                      End
43013>>>>>>
43013>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
43013>>>>>>
43013>>>>>
43013>>>>>
43013>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
43013>>>>>                Else;                Begin //edit an existing record
43014>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
43014>>>>>
43014>>>>>                      If (pifromxrhsh(Self)=0) Begin
43016>>>>>
43016>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
43019>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
43019>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
43022>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
43022>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
43025>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
43025>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
43028>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
43028>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
43031>>>>>
43031>>>>>                      End
43031>>>>>>
43031>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
43031>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
43031>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
43031>>>>>                        // anoigokleisei
43031>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
43031>>>>>//                      If (;
43031>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
43031>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
43031>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
43031>>>>>
43031>>>>>                      If (pifromxrhsh(Self)=0) Begin
43033>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
43033>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
43036>>>>>
43036>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
43036>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
43039>>>>>                      End
43039>>>>>>
43039>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
43039>>>>>>
43039>>>>>
43039>>>>>                //¢¦§¦å â¢œš®¦ 
43039>>>>>                //1001:baxio_hmnial > 0
43039>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
43042>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
43042>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
43045>>>>>                //1003:baxio_c_code2 <> ""
43045>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
43048>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
43048>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
43048>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
43048>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
43048>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
43048>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
43048>>>>>                //1100:cby = globals
43048>>>>>
43048>>>>>                If (pifromxrhsh(Self)=0) Begin
43050>>>>>
43050>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
43053>>>>>
43053>>>>>               End
43053>>>>>>
43053>>>>>
43053>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
43053>>>>>>
43053>>>>>               Function_Return iReturnVal
43054>>>>>      End_Function //validate_save
43055>>>>>
43055>>>>>
43055>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
43055>>>>>      Function Validate_Delete  Returns Integer
43056>>>>>               Integer iReturnVal
43057>>>>>               Forward Get Validate_Delete  To iReturnVal
43059>>>>>               If (Not(iReturnVal));               Begin
43061>>>>>
43061>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
43061>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
43064>>>>>
43064>>>>>                  //2100:cby = globals
43064>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
43067>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
43067>>>>>>
43067>>>>>               Function_Return iReturnVal
43068>>>>>      End_Function //validate_delete
43069>>>>>
43069>>>>>
43069>>>>>//------------------------------------------------------------------
43069>>>>>    Procedure Define_Fields
43070>>>>>        Forward Send Define_Fields
43072>>>>>        //DDB-Generated-Code-Location
43072>>>>>        //DDB-DefineFieldStart
43072>>>>>
43072>>>>>        Set Main_File            To Baxio.File_Number
43073>>>>>        Set Cascade_Delete_State To FALSE
43074>>>>>
43074>>>>>
43074>>>>>        // Child (Client) file structure................
43074>>>>>        Send Add_Client_File  Bmove.File_Number
43075>>>>>
43075>>>>>        // Parent (Server) file structure...............
43075>>>>>        Send Add_Server_File  Baxiokat.File_Number
43076>>>>>
43076>>>>>        // External (System) file structure.............
43076>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
43077>>>>>
43077>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
43080>>>>>
43080>>>>>        // Field-based properties.......................
43080>>>>>
43080>>>>>        // Baxio.Company_Code
43080>>>>>
43080>>>>>        // Baxio.Branch_Code
43080>>>>>
43080>>>>>        // Baxio.Year_Year
43080>>>>>
43080>>>>>        // Baxio.Baxiokat_Code
43080>>>>>
43080>>>>>        // Baxio.Baxio_Code
43080>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
43081>>>>>
43081>>>>>        // Baxio.Baxio_Rec0
43081>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
43082>>>>>
43082>>>>>        // Baxio.Year_Recr
43082>>>>>
43082>>>>>        // Baxio.Baxiokat_Recr
43082>>>>>
43082>>>>>        // Baxio.Baxio_Recr
43082>>>>>
43082>>>>>        // Baxio.Baxio_Status
43082>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
43083>>>>>
43083>>>>>        // Baxio.Baxio_Place
43083>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
43084>>>>>
43084>>>>>        // Baxio.Baxio_File_In
43084>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
43085>>>>>
43085>>>>>        // Baxio.Baxio_Code_In
43085>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
43085>>>>>
43085>>>>>        // Baxio.Baxio_Epon_In
43085>>>>>
43085>>>>>        // Baxio.Baxio_Fpar_In
43085>>>>>
43085>>>>>        // Baxio.Baxio_File_Out
43085>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
43086>>>>>
43086>>>>>        // Baxio.Baxio_Code_Out
43086>>>>>
43086>>>>>        // Baxio.Baxio_Epon_Out
43086>>>>>
43086>>>>>        // Baxio.Baxio_Fpar_Out
43086>>>>>
43086>>>>>        // Baxio.Baxio_Lfile
43086>>>>>
43086>>>>>        // Baxio.Baxio_Lcode
43086>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
43087>>>>>
43087>>>>>        // Baxio.Baxio_Lepon
43087>>>>>
43087>>>>>        // Baxio.Baxio_Lpar
43087>>>>>
43087>>>>>        // Baxio.Baxio_Bank00000
43087>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
43088>>>>>
43088>>>>>        // Baxio.Baxio_Hmniae
43088>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
43089>>>>>
43089>>>>>        // Baxio.Baxio_Hmniap000
43089>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
43090>>>>>
43090>>>>>        // Baxio.Baxio_Hmnial
43090>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
43090>>>>>
43090>>>>>        // Baxio.Baxio_Ekdoths
43090>>>>>
43090>>>>>        // Baxio.Baxio_Ekdothse
43090>>>>>
43090>>>>>        // Baxio.Baxio_Sediatagh
43090>>>>>
43090>>>>>        // Baxio.Baxio_Sdiataghe
43090>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
43091>>>>>
43091>>>>>        // Baxio.Baxio_Banka
43091>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
43092>>>>>
43092>>>>>        // Baxio.Baxio_Opistho
43092>>>>>
43092>>>>>        // Baxio.Baxio_No
43092>>>>>
43092>>>>>        // Baxio.Baxio_V2
43092>>>>>
43092>>>>>        // Baxio.Baxio_V0
43092>>>>>
43092>>>>>        // Baxio.Baxio_V00
43092>>>>>
43092>>>>>        // Baxio.Baxio_Vr
43092>>>>>
43092>>>>>        // Baxio.Baxio_Rate0
43092>>>>>
43092>>>>>        // Baxio.Baxio_Rate00
43092>>>>>
43092>>>>>        // Baxio.Baxio_Rater
43092>>>>>
43092>>>>>        // Baxio.Baxio_C_Code2
43092>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
43093>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
43094>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
43095>>>>>
43095>>>>>        // Baxio.Baxio_Lixi_Yyyy
43095>>>>>
43095>>>>>        // Baxio.Baxio_Lixi_Mm
43095>>>>>
43095>>>>>        // Baxio.Baxio_Lixi_Dd
43095>>>>>
43095>>>>>        // Baxio.Baxio_Bmove_Laa
43095>>>>>
43095>>>>>        // Baxio.Baxio_Desm
43095>>>>>
43095>>>>>        // Baxio.Baxio_From
43095>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
43096>>>>>
43096>>>>>        // Baxio.Baxio_Topos
43096>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
43097>>>>>
43097>>>>>        //DDB-DefineFieldEnd
43097>>>>>
43097>>>>>        Set Main_File            To Baxio.File_Number
43098>>>>>        Set Cascade_Delete_State To FALSE
43099>>>>>
43099>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43100>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43101>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43102>>>>>
43102>>>>>        // Child (Client) file structure................
43102>>>>>        Send Add_Client_File  Bmove.File_Number
43103>>>>>
43103>>>>>        // Parent (Server) file structure...............
43103>>>>>        Send Add_Server_File  Baxiokat.File_Number
43104>>>>>
43104>>>>>        // External (System) file structure.............
43104>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
43105>>>>>
43105>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
43108>>>>>
43108>>>>>        // Field-based properties.......................
43108>>>>>
43108>>>>>        // Baxio.Company_Code
43108>>>>>
43108>>>>>        // Baxio.Branch_Code
43108>>>>>
43108>>>>>        // Baxio.Year_Year
43108>>>>>
43108>>>>>        // Baxio.Baxiokat_Code
43108>>>>>
43108>>>>>        // Baxio.Baxio_Code
43108>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
43109>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
43110>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
43111>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
43112>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
43113>>>>>
43113>>>>>        // Baxio.Baxio_Rec0
43113>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
43114>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
43115>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
43116>>>>>
43116>>>>>        // Baxio.Year_Rec0
43116>>>>>
43116>>>>>        // Baxio.Baxiokat_Rec0
43116>>>>>
43116>>>>>        // Baxio.Baxio_Status
43116>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
43117>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
43118>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
43119>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
43120>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
43121>>>>>
43121>>>>>        // Baxio.Baxio_Place
43121>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
43122>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
43123>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
43124>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
43125>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
43126>>>>>
43126>>>>>        // Baxio.Baxio_File_In
43126>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
43127>>>>>
43127>>>>>        // Baxio.Baxio_Code_In
43127>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
43128>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
43129>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
43130>>>>>
43130>>>>>        // Baxio.Baxio_Epon_In
43130>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
43131>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
43132>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
43133>>>>>
43133>>>>>        // Baxio.Baxio_Fpar_In
43133>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
43134>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
43135>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
43136>>>>>
43136>>>>>        // Baxio.Baxio_File_Out
43136>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
43137>>>>>
43137>>>>>        // Baxio.Baxio_Code_Out
43137>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
43138>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
43139>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
43140>>>>>
43140>>>>>        // Baxio.Baxio_Epon_Out
43140>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
43141>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
43142>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
43143>>>>>
43143>>>>>        // Baxio.Baxio_Fpar_Out
43143>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
43144>>>>>
43144>>>>>        // Baxio.Baxio_Lfile
43144>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
43145>>>>>
43145>>>>>        // Baxio.Baxio_Lcode
43145>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
43146>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
43147>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
43148>>>>>
43148>>>>>        // Baxio.Baxio_Lepon
43148>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
43149>>>>>
43149>>>>>        // Baxio.Baxio_Lpar
43149>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
43150>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
43151>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
43152>>>>>
43152>>>>>        // Baxio.Baxio_Bank00000
43152>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
43153>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
43154>>>>>
43154>>>>>        // Baxio.Baxio_Hmniae
43154>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
43155>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
43156>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
43157>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
43158>>>>>
43158>>>>>        // Baxio.Baxio_Hmniap000
43158>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
43159>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
43160>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
43161>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
43162>>>>>
43162>>>>>        // Baxio.Baxio_Hmnial
43162>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
43163>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
43164>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
43165>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
43166>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
43167>>>>>
43167>>>>>        // Baxio.Baxio_Ekdoths
43167>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
43168>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
43169>>>>>
43169>>>>>        // Baxio.Baxio_Ekdothse
43169>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
43170>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
43171>>>>>
43171>>>>>        // Baxio.Baxio_Sediatagh
43171>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
43172>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
43173>>>>>
43173>>>>>        // Baxio.Baxio_Sdiataghe
43173>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
43174>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
43175>>>>>
43175>>>>>        // Baxio.Baxio_Banka
43175>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
43176>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
43177>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
43178>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
43179>>>>>
43179>>>>>        // Baxio.Baxio_Opistho
43179>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
43180>>>>>
43180>>>>>        // Baxio.Baxio_No
43180>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
43181>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
43182>>>>>
43182>>>>>        // Baxio.Baxio_V2
43182>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
43183>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
43184>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
43185>>>>>
43185>>>>>        // Baxio.Baxio_V0
43185>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
43186>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
43187>>>>>
43187>>>>>        // Baxio.Baxio_V00
43187>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
43188>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
43189>>>>>
43189>>>>>        // Baxio.Baxio_Vr
43189>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
43190>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
43191>>>>>
43191>>>>>        // Baxio.Baxio_Rate0
43191>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
43192>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
43193>>>>>
43193>>>>>        // Baxio.Baxio_Rate00
43193>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
43194>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
43195>>>>>
43195>>>>>        // Baxio.Baxio_Rater
43195>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
43196>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
43197>>>>>
43197>>>>>        // Baxio.Baxio_C_Code2
43197>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
43198>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
43199>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
43200>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
43201>>>>>
43201>>>>>        // Baxio.Baxio_Lixi_Yyyy
43201>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
43202>>>>>
43202>>>>>        // Baxio.Baxio_Lixi_Mm
43202>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
43203>>>>>
43203>>>>>        // Baxio.Baxio_Lixi_Dd
43203>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
43204>>>>>
43204>>>>>        // Baxio.Baxio_Bmove_Laa
43204>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
43205>>>>>
43205>>>>>    End_Procedure    // Define_Fields
43206>>>>>
43206>>>>>
43206>>>>>    Procedure Field_Defaults
43207>>>>>        Forward Send Field_Defaults
43209>>>>>        //DDB-Generated-Code-Location
43209>>>>>        //DDB-FieldDefaultStart
43209>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
43210>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
43211>>>>>        //DDB-FieldDefaultEnd
43211>>>>>    End_Procedure    // Field_Defaults
43212>>>>>
43212>>>>>End_Class    // Baxio_DataDictionary
43213>>>>>//DDB-Selection-pkg-Start
43213>>>>>
43213>>>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
43213>>>>>>>//AB/ Project SL037:BAXIO
43213>>>>>>>//AB/ Object prj is a Lookup_Project
43213>>>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
43213>>>>>>>//AB/     Set ProjectFileName to "SL037.SL"
43213>>>>>>>
43213>>>>>>>// Project Object Structure
43213>>>>>>>//   SL037 is a dbModalPanelSub
43213>>>>>>>//     Baxiokat_DD is a DataDictionary
43213>>>>>>>//     Baxio_DD is a DataDictionary
43213>>>>>>>//     oSelList is a dbListSub
43213>>>>>>>//     TextBoxSub1 is a TextBoxSub
43213>>>>>>>//     cSyDateForm1 is a cSyDateForm
43213>>>>>>>//     TextBoxSub2 is a TextBoxSub
43213>>>>>>>//     cSyDateForm2 is a cSyDateForm
43213>>>>>>>//     TextBoxSub4 is a TextBoxSub
43213>>>>>>>//     TextBoxSub5 is a TextBoxSub
43213>>>>>>>//     FormSub1 is a FormSub
43213>>>>>>>//     FormSub2 is a FormSub
43213>>>>>>>//     FormSub3 is a FormSub
43213>>>>>>>//     FormSub4 is a FormSub
43213>>>>>>>//     ButtonSub1 is a ButtonSub
43213>>>>>>>//     oOK_bn is a ButtonSub
43213>>>>>>>
43213>>>>>>>// Register all objects
43213>>>>>>>Register_Object Baxio_DD
43213>>>>>>>Register_Object Baxiokat_DD
43213>>>>>>>Register_Object ButtonSub1
43213>>>>>>>Register_Object cSyDateForm1
43213>>>>>>>Register_Object cSyDateForm2
43213>>>>>>>Register_Object FormSub1
43213>>>>>>>Register_Object FormSub2
43213>>>>>>>Register_Object FormSub3
43213>>>>>>>Register_Object FormSub4
43213>>>>>>>Register_Object oOK_bn
43213>>>>>>>Register_Object oSelList
43213>>>>>>>Register_Object SL037
43213>>>>>>>Register_Object TextBoxSub1
43213>>>>>>>Register_Object TextBoxSub2
43213>>>>>>>Register_Object TextBoxSub4
43213>>>>>>>Register_Object TextBoxSub5
43213>>>>>>>
43213>>>>>>>
43213>>>>>>>
43213>>>>>>>//AB-StoreTopStart
43213>>>>>>>    
43213>>>>>>>Use sl100.sl
43213>>>>>>>
43213>>>>>>>
43213>>>>>>>//AB-StoreTopEnd
43213>>>>>>>
43213>>>>>>>//AB-IgnoreStart
43213>>>>>>>
43213>>>>>>>Use DFAllEnt.pkg
43213>>>>>>>Use dbList.Sub
43213>>>>>>>Use Txtbox.Sub
43213>>>>>>>Use cSyDateForm.Pkg
43213>>>>>>>Use Form.Sub
43213>>>>>>>Use Button.Sub
43213>>>>>>>
43213>>>>>>>
43213>>>>>>>Use BAXIOKAT.DD
43213>>>>>>>Use BAXIO.DD
43213>>>>>>>
43213>>>>>>>//AB-IgnoreEnd
43213>>>>>>>
43213>>>>>>>Object SL037 is a dbModalPanelSub
43215>>>>>>>
43215>>>>>>>    //AB-StoreTopStart
43215>>>>>>>                        
43215>>>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
43217>>>>>>>    Property Integer piFragmaBaxiokatCode Public  0
43219>>>>>>>    Property Integer piFragmaBaxioStatus  Public  0
43221>>>>>>>    Property Integer piFragmaBaxioPlace   Public  0
43223>>>>>>>    Property string  psfragmaclient       Public ''
43225>>>>>>>    Property String  psFragmaBaxioStatus  Public ''
43227>>>>>>>    Property String  psEkdoths            Public ''
43229>>>>>>>    Property String  psApodekths          Public ''
43231>>>>>>>    Property Date pdApo                   Public ''
43233>>>>>>>    Property Date pdEos                   Public ''
43235>>>>>>>    
43235>>>>>>>    //AB-StoreTopEnd
43235>>>>>>>
43235>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
43236>>>>>>>    Set Size to 287 527
43237>>>>>>>    Set Location to 2 3
43238>>>>>>>    Set Exit_Application_Local_State to FALSE
43239>>>>>>>    Set Modal_State to FALSE
43240>>>>>>>
43240>>>>>>>    //AB-DDOStart
43240>>>>>>>
43240>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
43242>>>>>>>    End_Object    // Baxiokat_DD
43243>>>>>>>
43243>>>>>>>    Object Baxio_DD is a Baxio_DataDictionary
43245>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
43246>>>>>>>
43246>>>>>>>        //AB-StoreStart
43246>>>>>>>                                                    
43246>>>>>>>        Function fiIsOK Returns Integer
43248>>>>>>>            String lsBaxioStatus sclient
43249>>>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
43250>>>>>>>            Get psfragmaclient       to sclient
43251>>>>>>>            If (Trim(sClient)='') Begin
43253>>>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
43256>>>>>>>            End
43256>>>>>>>>
43256>>>>>>>            Else Begin
43257>>>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
43260>>>>>>>            End
43260>>>>>>>>
43260>>>>>>>            Function_Return 0
43261>>>>>>>        End_Function
43262>>>>>>>        
43262>>>>>>>        Procedure OnConstrain
43264>>>>>>>        
43264>>>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
43265>>>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
43265>>>>>>>            Date    dApo dEos
43265>>>>>>>        
43265>>>>>>>            Forward Send OnConstrain
43267>>>>>>>        
43267>>>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
43268>>>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
43269>>>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
43270>>>>>>>        
43270>>>>>>>            Get psApodekths             to sApodekths
43271>>>>>>>            Get psEkdoths               to sEkdoths
43272>>>>>>>            Get pdApo                   to dApo
43273>>>>>>>            Get pdEos                   to dEos
43274>>>>>>>        
43274>>>>>>>            If (liBaxioKatCode <> 0) Begin
43276>>>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
43278>>>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
43282>>>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
43285>>>>>>>            End
43285>>>>>>>>
43285>>>>>>>        
43285>>>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
43289>>>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
43293>>>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
43297>>>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
43301>>>>>>>        
43301>>>>>>>        End_Procedure // OnConstrain
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        
43302>>>>>>>        //AB-StoreEnd
43302>>>>>>>
43302>>>>>>>    End_Object    // Baxio_DD
43303>>>>>>>
43303>>>>>>>    Set Main_DD to (Baxio_DD(self))
43304>>>>>>>    Set Server to (Baxio_DD(self))
43305>>>>>>>
43305>>>>>>>    //AB-DDOEnd
43305>>>>>>>
43305>>>>>>>    Object oSelList is a dbListSub
43307>>>>>>>        Set Main_File to Baxio.File_Number
43308>>>>>>>        Set Size to 228 514
43309>>>>>>>        Set Location to 4 6
43310>>>>>>>
43310>>>>>>>        Begin_Row
43313>>>>>>>            Entry_Item Baxio.Baxio_code
43314>>>>>>>            Entry_Item Baxio.Baxio_epon_in
43315>>>>>>>            Entry_Item Baxio.Baxio_epon_out
43316>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
43317>>>>>>>            Entry_Item Baxio.Baxio_hmnial
43318>>>>>>>            Entry_Item Baxio.Baxio_v2
43319>>>>>>>            Entry_Item Baxio.Baxio_banka
43320>>>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
43321>>>>>>>            Entry_Item Baxio.Baxio_no
43322>>>>>>>        End_Row
43327>>>>>>>
43327>>>>>>>        Set Form_Width    item 0 to 41
43328>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
43329>>>>>>>        
43329>>>>>>>        Set Form_Width    item 1 to 98
43330>>>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
43331>>>>>>>        
43331>>>>>>>        Set Form_Width    item 2 to 94
43332>>>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
43333>>>>>>>        
43333>>>>>>>        Set Form_Width    item 3 to 75
43334>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
43335>>>>>>>        
43335>>>>>>>        Set Form_Width    item 4 to 47
43336>>>>>>>        Set Header_Label  item 4 to "Šã¥ž"
43337>>>>>>>        
43337>>>>>>>        Set Form_Width    item 5 to 48
43338>>>>>>>        Set Header_Label  item 5 to "¦©æ"
43339>>>>>>>        
43339>>>>>>>        Set Form_Width    item 6 to 12
43340>>>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
43341>>>>>>>        
43341>>>>>>>        Set Form_Width    item 7 to 42
43342>>>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
43343>>>>>>>        
43343>>>>>>>        Set Form_Width    item 8 to 53
43344>>>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
43345>>>>>>>        
43345>>>>>>>
43345>>>>>>>        //AB-StoreStart
43345>>>>>>>                
43345>>>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
43347>>>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
43349>>>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
43351>>>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
43353>>>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
43355>>>>>>>        
43355>>>>>>>        Procedure Store_Defaults
43357>>>>>>>            Forward Send Store_Defaults
43359>>>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
43360>>>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
43361>>>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
43362>>>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
43363>>>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
43364>>>>>>>        End_Procedure // Store_Defaults
43365>>>>>>>        
43365>>>>>>>        Procedure Restore_Defaults
43367>>>>>>>            Forward Send Restore_Defaults
43369>>>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
43370>>>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
43371>>>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
43372>>>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
43373>>>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
43374>>>>>>>        End_Procedure // Restore_Defaults
43375>>>>>>>        
43375>>>>>>>        Procedure Activating
43377>>>>>>>            Forward Send Activating
43379>>>>>>>         //   Set Auto_Index_State        to True
43379>>>>>>>            Send Rebuild_Constraints    to Baxio_DD
43380>>>>>>>        End_Procedure
43381>>>>>>>        
43381>>>>>>>        Procedure End_Construct_Object
43383>>>>>>>            Integer iDecs
43384>>>>>>>            Forward Send End_Construct_Object
43386>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
43387>>>>>>>            Set Points Item 5 to iDecs
43388>>>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
43389>>>>>>>        End_Procedure
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        
43390>>>>>>>        //AB-StoreEnd
43390>>>>>>>
43390>>>>>>>    End_Object    // oSelList
43391>>>>>>>
43391>>>>>>>    Object TextBoxSub1 is a TextBoxSub
43393>>>>>>>        Set Label to "Šã¥ž ˜§¦"
43394>>>>>>>        Set Location to 241 7
43395>>>>>>>        Set Size to 10 35
43396>>>>>>>        Set TypeFace to "MS Sans Serif"
43397>>>>>>>    End_Object    // TextBoxSub1
43398>>>>>>>
43398>>>>>>>    Object cSyDateForm1 is a cSyDateForm
43400>>>>>>>        Set Size to 13 66
43401>>>>>>>        Set Location to 240 45
43402>>>>>>>        Set Label_Col_Offset to 2
43403>>>>>>>        Set Label_Justification_Mode to jMode_Right
43404>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
43405>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43406>>>>>>>
43406>>>>>>>        //AB-StoreStart
43406>>>>>>>                                                    
43406>>>>>>>        Procedure Key Integer iKey
43408>>>>>>>            Integer iRetVal
43409>>>>>>>            Forward Send Key iKey
43411>>>>>>>            If (iKey=277) Begin
43413>>>>>>>                Set Value Item 0 to ''
43414>>>>>>>                //Send KeyAction to ButtonSub1
43414>>>>>>>            End
43414>>>>>>>>
43414>>>>>>>        End_Procedure
43415>>>>>>>        
43415>>>>>>>        
43415>>>>>>>        //AB-StoreEnd
43415>>>>>>>
43415>>>>>>>    End_Object    // cSyDateForm1
43416>>>>>>>
43416>>>>>>>    Object TextBoxSub2 is a TextBoxSub
43418>>>>>>>        Set Label to "Šã¥ž œàª"
43419>>>>>>>        Set Location to 258 7
43420>>>>>>>        Set Size to 10 35
43421>>>>>>>        Set TypeFace to "MS Sans Serif"
43422>>>>>>>    End_Object    // TextBoxSub2
43423>>>>>>>
43423>>>>>>>    Object cSyDateForm2 is a cSyDateForm
43425>>>>>>>        Set Size to 13 66
43426>>>>>>>        Set Location to 256 45
43427>>>>>>>        Set Label_Col_Offset to 2
43428>>>>>>>        Set Label_Justification_Mode to jMode_Right
43429>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
43430>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43431>>>>>>>
43431>>>>>>>        //AB-StoreStart
43431>>>>>>>                                                    
43431>>>>>>>        Procedure Key Integer iKey
43433>>>>>>>            Integer iRetVal
43434>>>>>>>            Forward Send Key iKey
43436>>>>>>>            If (iKey=277) Begin
43438>>>>>>>                Set Value Item 0 to ''
43439>>>>>>>                //Send KeyAction to ButtonSub1
43439>>>>>>>            End
43439>>>>>>>>
43439>>>>>>>        End_Procedure
43440>>>>>>>        
43440>>>>>>>        
43440>>>>>>>        //AB-StoreEnd
43440>>>>>>>
43440>>>>>>>    End_Object    // cSyDateForm2
43441>>>>>>>
43441>>>>>>>    Object TextBoxSub4 is a TextBoxSub
43443>>>>>>>        Set Label to "„¡›æ«žª"
43444>>>>>>>        Set Location to 241 118
43445>>>>>>>        Set Size to 10 33
43446>>>>>>>        Set TypeFace to "MS Sans Serif"
43447>>>>>>>    End_Object    // TextBoxSub4
43448>>>>>>>
43448>>>>>>>    Object TextBoxSub5 is a TextBoxSub
43450>>>>>>>        Set Label to "€§¦›â¡«žª"
43451>>>>>>>        Set Location to 258 118
43452>>>>>>>        Set Size to 10 39
43453>>>>>>>        Set TypeFace to "MS Sans Serif"
43454>>>>>>>    End_Object    // TextBoxSub5
43455>>>>>>>
43455>>>>>>>    Object FormSub1 is a FormSub
43457>>>>>>>        Set Size to 13 77
43458>>>>>>>        Set Location to 240 159
43459>>>>>>>        Set Label_Col_Offset to 2
43460>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43461>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43462>>>>>>>
43462>>>>>>>        //AB-StoreStart
43462>>>>>>>                                                    
43462>>>>>>>        Set Prompt_Object to (sl100(Self))
43463>>>>>>>        
43463>>>>>>>        Procedure OnChange
43465>>>>>>>            String s1
43466>>>>>>>            Get Value Item 0 to s1
43467>>>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
43468>>>>>>>            Set psEkdoths to s1
43469>>>>>>>        End_Procedure
43470>>>>>>>        
43470>>>>>>>        
43470>>>>>>>        
43470>>>>>>>        
43470>>>>>>>        
43470>>>>>>>        
43470>>>>>>>        
43470>>>>>>>        //AB-StoreEnd
43470>>>>>>>
43470>>>>>>>    End_Object    // FormSub1
43471>>>>>>>
43471>>>>>>>    Object FormSub2 is a FormSub
43473>>>>>>>        Set Size to 13 187
43474>>>>>>>        Set Location to 240 240
43475>>>>>>>        Set Color to clBtnFace
43476>>>>>>>        Set Label_Col_Offset to 2
43477>>>>>>>        Set Enabled_State to FALSE
43478>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43479>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43480>>>>>>>        Set Shadow_State Item 0 to TRUE
43481>>>>>>>    End_Object    // FormSub2
43482>>>>>>>
43482>>>>>>>    Object FormSub3 is a FormSub
43484>>>>>>>        Set Size to 13 77
43485>>>>>>>        Set Location to 256 159
43486>>>>>>>        Set Label_Col_Offset to 2
43487>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43488>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43489>>>>>>>
43489>>>>>>>        //AB-StoreStart
43489>>>>>>>                                                    
43489>>>>>>>        Set Prompt_Object to (sl100(Self))
43490>>>>>>>        
43490>>>>>>>        Procedure OnChange
43492>>>>>>>            String s1
43493>>>>>>>            Get Value Item 0 to s1
43494>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
43495>>>>>>>            Set psApodekths to s1
43496>>>>>>>        End_Procedure
43497>>>>>>>        
43497>>>>>>>        
43497>>>>>>>        
43497>>>>>>>        
43497>>>>>>>        
43497>>>>>>>        
43497>>>>>>>        
43497>>>>>>>        //AB-StoreEnd
43497>>>>>>>
43497>>>>>>>    End_Object    // FormSub3
43498>>>>>>>
43498>>>>>>>    Object FormSub4 is a FormSub
43500>>>>>>>        Set Size to 13 187
43501>>>>>>>        Set Location to 256 240
43502>>>>>>>        Set Color to clBtnFace
43503>>>>>>>        Set Label_Col_Offset to 2
43504>>>>>>>        Set Enabled_State to FALSE
43505>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43506>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43507>>>>>>>        Set Shadow_State Item 0 to TRUE
43508>>>>>>>    End_Object    // FormSub4
43509>>>>>>>
43509>>>>>>>    Object ButtonSub1 is a ButtonSub
43511>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
43512>>>>>>>        Set Size to 14 43
43513>>>>>>>        Set Location to 256 430
43514>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43515>>>>>>>
43515>>>>>>>        //AB-StoreStart
43515>>>>>>>                                                    
43515>>>>>>>        Procedure OnClick
43517>>>>>>>            Date dApo dEos
43518>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
43519>>>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
43520>>>>>>>            Set pdApo to dApo
43521>>>>>>>            Set pdEos to dEos
43522>>>>>>>            Send Rebuild_Constraints to Baxio_DD
43523>>>>>>>            Send Beginning_Of_Data to oSelList True
43524>>>>>>>        End_Procedure // OnClick
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        
43525>>>>>>>        //AB-StoreEnd
43525>>>>>>>
43525>>>>>>>    End_Object    // ButtonSub1
43526>>>>>>>
43526>>>>>>>    Object oOK_bn is a ButtonSub
43528>>>>>>>        Set Label to "&„§ ¢¦šã"
43529>>>>>>>        Set Size to 14 43
43530>>>>>>>        Set Location to 256 478
43531>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43532>>>>>>>
43532>>>>>>>        //AB-StoreStart
43532>>>>>>>        Procedure OnClick
43534>>>>>>>            Send OK To oSelList
43535>>>>>>>        End_Procedure
43536>>>>>>>        //AB-StoreEnd
43536>>>>>>>
43536>>>>>>>    End_Object    // oOK_bn
43537>>>>>>>
43537>>>>>>>
43537>>>>>>>    //AB-StoreStart
43537>>>>>>>                        
43537>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
43538>>>>>>>    
43538>>>>>>>    Procedure Request_Cancel
43540>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
43541>>>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
43542>>>>>>>        Set Value Of FormSub1     Item 0 to ''
43543>>>>>>>        Set Value Of FormSub2     Item 0 to ''
43544>>>>>>>        Forward Send Request_Cancel
43546>>>>>>>    End_Procedure
43547>>>>>>>    
43547>>>>>>>    
43547>>>>>>>    
43547>>>>>>>    
43547>>>>>>>    
43547>>>>>>>    //AB-StoreEnd
43547>>>>>>>
43547>>>>>>>End_Object    // SL037
43548>>>>>>>
43548>>>>>>>
43548>>>>>>>//AB-StoreStart
43548>>>>>>>    
43548>>>>>>>//AB-StoreEnd
43548>>>>>>>
43548>>>>>>>//AB/ End_Object    // prj
43548>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
43548>>>>>>>//AB/ Project slNomism
43548>>>>>>>//AB/ Object prj is a Lookup_Project
43548>>>>>>>//AB/     Set ProjectName to "slNomism"
43548>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
43548>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43548>>>>>>>
43548>>>>>>>// Project Object Structure
43548>>>>>>>//   slNomism is a dbModalPanelSub
43548>>>>>>>//     Nomisma_DD is a DataDictionary
43548>>>>>>>//     oSelList is a dbListSub
43548>>>>>>>//     oOK_bn is a ButtonSub
43548>>>>>>>//     oSearch_bn is a ButtonSub
43548>>>>>>>
43548>>>>>>>// Register all objects
43548>>>>>>>Register_Object Nomisma_DD
43548>>>>>>>Register_Object oOK_bn
43548>>>>>>>Register_Object oSearch_bn
43548>>>>>>>Register_Object oSelList
43548>>>>>>>Register_Object slNomism
43548>>>>>>>
43548>>>>>>>
43548>>>>>>>//AB-IgnoreStart
43548>>>>>>>
43548>>>>>>>Use DFAllEnt.pkg
43548>>>>>>>Use dbList.Sub
43548>>>>>>>Use Button.Sub
43548>>>>>>>
43548>>>>>>>
43548>>>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
43548>>>>>>>>>//DDB-FileStart
43548>>>>>>>>>//DDB-HeaderStart
43548>>>>>>>>>
43548>>>>>>>>>// File Name : NOMISMA.DD
43548>>>>>>>>>// Class Name: Nomisma_DataDictionary
43548>>>>>>>>>// Revision  : 52
43548>>>>>>>>>// Version   : 2
43548>>>>>>>>>
43548>>>>>>>>>Use  Windows           // Basic Definitions
43548>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43548>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43548>>>>>>>>>
43548>>>>>>>>>Open Nomisma
43550>>>>>>>>>Open Isotimia
43552>>>>>>>>>Open Particle
43554>>>>>>>>>
43554>>>>>>>>>//DDB-HeaderEnd
43554>>>>>>>>>//DDB-ValidationStart
43554>>>>>>>>>
43554>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
43554>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
43554>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
43554>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
43554>>>>>>>>>
43554>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
43556>>>>>>>>>
43556>>>>>>>>>    Procedure Fill_List
43558>>>>>>>>>        Forward Send Fill_List
43560>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
43561>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
43562>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
43563>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
43564>>>>>>>>>    End_Procedure    // Fill_List
43565>>>>>>>>>    //DDB-ValidationCustomStart
43565>>>>>>>>>    //DDB-ValidationCustomEnd
43565>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
43566>>>>>>>>>
43566>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
43568>>>>>>>>>
43568>>>>>>>>>    Procedure Fill_List
43570>>>>>>>>>        Forward Send Fill_List
43572>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
43573>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
43574>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
43575>>>>>>>>>    End_Procedure    // Fill_List
43576>>>>>>>>>    //DDB-ValidationCustomStart
43576>>>>>>>>>    //DDB-ValidationCustomEnd
43576>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
43577>>>>>>>>>
43577>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
43579>>>>>>>>>
43579>>>>>>>>>    Procedure Fill_List
43581>>>>>>>>>        Forward Send Fill_List
43583>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
43584>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
43585>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
43586>>>>>>>>>    End_Procedure    // Fill_List
43587>>>>>>>>>    //DDB-ValidationCustomStart
43587>>>>>>>>>    //DDB-ValidationCustomEnd
43587>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
43588>>>>>>>>>
43588>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
43590>>>>>>>>>
43590>>>>>>>>>    Procedure Fill_List
43592>>>>>>>>>        Forward Send Fill_List
43594>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
43595>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
43596>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
43597>>>>>>>>>    End_Procedure    // Fill_List
43598>>>>>>>>>    //DDB-ValidationCustomStart
43598>>>>>>>>>    //DDB-ValidationCustomEnd
43598>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
43599>>>>>>>>>//DDB-ValidationEnd
43599>>>>>>>>>//DDB-SelectionStart
43599>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
43599>>>>>>>>>Register_Object sl059
43599>>>>>>>>>//DDB-SelectionEnd
43599>>>>>>>>>
43599>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
43600>>>>>>>>>
43600>>>>>>>>>    Procedure Construct_Object
43601>>>>>>>>>        Forward Send Construct_Object
43603>>>>>>>>>        Property String psOldCode Public ''
43604>>>>>>>>>    End_procedure
43605>>>>>>>>>
43605>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43606>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43608>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
43609>>>>>>>>>    End_Procedure   // New_Current_Record
43610>>>>>>>>>
43610>>>>>>>>>    Procedure Save_Main_File
43611>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
43614>>>>>>>>>        Forward Send Save_Main_File
43616>>>>>>>>>    End_Procedure   // Save_Main_File
43617>>>>>>>>>
43617>>>>>>>>>    Function Validate_Save  Returns Integer
43618>>>>>>>>>        Local Integer iReturnVal 
43619>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
43621>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
43623>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
43626>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
43630>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
43633>>>>>>>>>            End
43633>>>>>>>>>>
43633>>>>>>>>>        Function_Return iReturnVal
43634>>>>>>>>>    End_Function   // Validate_Save
43635>>>>>>>>>
43635>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
43636>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
43639>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
43643>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
43643>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
43646>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
43647>>>>>>>>>
43647>>>>>>>>>    Procedure Update
43648>>>>>>>>>        Forward Send Update
43650>>>>>>>>>        // Insert Code Here
43650>>>>>>>>>        SYSDATE NOMISMA.LUP
43651>>>>>>>>>    End_Procedure   // Update
43652>>>>>>>>>
43652>>>>>>>>>    Procedure Creating
43653>>>>>>>>>        Forward Send Creating
43655>>>>>>>>>        // Insert Code Here
43655>>>>>>>>>        SYSDATE NOMISMA.FUP
43656>>>>>>>>>    End_Procedure   // Creating
43657>>>>>>>>>
43657>>>>>>>>>    // Define_Fields:
43657>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43657>>>>>>>>>
43657>>>>>>>>>    Procedure Define_Fields
43658>>>>>>>>>        Forward Send Define_Fields
43660>>>>>>>>>        //DDB-Generated-Code-Location
43660>>>>>>>>>        //DDB-DefineFieldStart
43660>>>>>>>>>
43660>>>>>>>>>        Set Main_File            To Nomisma.File_Number
43661>>>>>>>>>        Set Cascade_Delete_State To FALSE
43662>>>>>>>>>
43662>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43663>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43664>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43665>>>>>>>>>
43665>>>>>>>>>        // Child (Client) file structure................
43665>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
43666>>>>>>>>>        Send Add_Client_File  Particle.File_Number
43667>>>>>>>>>
43667>>>>>>>>>        // Field-based properties.......................
43667>>>>>>>>>
43667>>>>>>>>>        // Nomisma.Nomisma_Code
43667>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
43668>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
43669>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
43670>>>>>>>>>
43670>>>>>>>>>        // Nomisma.Nomisma_Descr
43670>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
43671>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
43672>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
43673>>>>>>>>>
43673>>>>>>>>>        // Nomisma.Nomisma_Short
43673>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
43674>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
43675>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Dekadika
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Fup
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Lup
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Euro_Zone
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Einai_Drx
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Einai_Euro
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Monades
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Kl_Isot_Euro
43676>>>>>>>>>
43676>>>>>>>>>        // Nomisma.Nomisma_Type
43676>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
43677>>>>>>>>>
43677>>>>>>>>>        // Nomisma.Nomisma_Sign0
43677>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
43678>>>>>>>>>
43678>>>>>>>>>        // Nomisma.Nomisma_Sign00
43678>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
43679>>>>>>>>>
43679>>>>>>>>>        // Nomisma.Nomisma_Signr
43679>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
43680>>>>>>>>>
43680>>>>>>>>>        //DDB-DefineFieldEnd
43680>>>>>>>>>    End_Procedure    // Define_Fields
43681>>>>>>>>>
43681>>>>>>>>>    // Field_Defaults:
43681>>>>>>>>>    // This procedure is used to establish default field values.
43681>>>>>>>>>
43681>>>>>>>>>    Procedure Field_Defaults
43682>>>>>>>>>        Forward Send Field_Defaults
43684>>>>>>>>>        //DDB-Generated-Code-Location
43684>>>>>>>>>        //DDB-FieldDefaultStart
43684>>>>>>>>>        //DDB-FieldDefaultEnd
43684>>>>>>>>>    End_Procedure    // Field_Defaults
43685>>>>>>>>>
43685>>>>>>>>>End_Class    // Nomisma_DataDictionary
43686>>>>>>>>>//DDB-Selection-pkg-Start
43686>>>>>>>>>
43686>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
43686>>>>>>>>>>>//AB/ Project sl059
43686>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
43686>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
43686>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
43686>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
43686>>>>>>>>>>>
43686>>>>>>>>>>>    //AB-IgnoreStart
43686>>>>>>>>>>>
43686>>>>>>>>>>>
43686>>>>>>>>>>>
43686>>>>>>>>>>>
43686>>>>>>>>>>>    Use NOMISMA.DD
43686>>>>>>>>>>>
43686>>>>>>>>>>>    //AB-IgnoreEnd
43686>>>>>>>>>>>
43686>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
43705>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
43706>>>>>>>>>>>        Set Modal_State to FALSE
43707>>>>>>>>>>>        Set Popup_State to FALSE
43708>>>>>>>>>>>        Set Minimize_Icon to FALSE
43709>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
43710>>>>>>>>>>>        Set Size to 148 295
43711>>>>>>>>>>>        Set Location to 4 5
43712>>>>>>>>>>>
43712>>>>>>>>>>>        //AB-DDOStart
43712>>>>>>>>>>>
43712>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
43714>>>>>>>>>>>        End_Object    // Nomisma_DD
43715>>>>>>>>>>>
43715>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
43716>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
43717>>>>>>>>>>>
43717>>>>>>>>>>>        //AB-DDOEnd
43717>>>>>>>>>>>
43717>>>>>>>>>>>        Object oSelList is a dbListSub
43719>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
43720>>>>>>>>>>>            Set Size to 105 278
43721>>>>>>>>>>>            Set Location to 6 6
43722>>>>>>>>>>>
43722>>>>>>>>>>>            Begin_Row
43725>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
43726>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
43727>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
43728>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
43729>>>>>>>>>>>            End_Row
43734>>>>>>>>>>>
43734>>>>>>>>>>>            Set Form_Width    item 0 to 45
43735>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
43736>>>>>>>>>>>
43736>>>>>>>>>>>            Set Form_Width    item 1 to 115
43737>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
43738>>>>>>>>>>>
43738>>>>>>>>>>>            Set Form_Width    item 2 to 58
43739>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
43740>>>>>>>>>>>
43740>>>>>>>>>>>            Set Form_Width    item 3 to 54
43741>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
43742>>>>>>>>>>>
43742>>>>>>>>>>>        End_Object    // oSelList
43743>>>>>>>>>>>
43743>>>>>>>>>>>        Object oOK_bn is a ButtonSub
43745>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
43746>>>>>>>>>>>            Set Location to 113 124
43747>>>>>>>>>>>
43747>>>>>>>>>>>            //AB-StoreStart
43747>>>>>>>>>>>            Procedure OnClick
43749>>>>>>>>>>>                Send OK To (oSelList(current_object))
43750>>>>>>>>>>>            End_Procedure
43751>>>>>>>>>>>            //AB-StoreEnd
43751>>>>>>>>>>>
43751>>>>>>>>>>>        End_Object    // oOK_bn
43752>>>>>>>>>>>
43752>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
43754>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
43755>>>>>>>>>>>            Set Location to 113 179
43756>>>>>>>>>>>
43756>>>>>>>>>>>            //AB-StoreStart
43756>>>>>>>>>>>            Procedure OnClick
43758>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
43759>>>>>>>>>>>            End_Procedure
43760>>>>>>>>>>>            //AB-StoreEnd
43760>>>>>>>>>>>
43760>>>>>>>>>>>        End_Object    // oCancel_bn
43761>>>>>>>>>>>
43761>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
43763>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
43764>>>>>>>>>>>            Set Location to 113 234
43765>>>>>>>>>>>
43765>>>>>>>>>>>            //AB-StoreStart
43765>>>>>>>>>>>            Procedure OnClick
43767>>>>>>>>>>>                Send Search To (oSelList(current_object))
43768>>>>>>>>>>>            End_Procedure
43769>>>>>>>>>>>            //AB-StoreEnd
43769>>>>>>>>>>>
43769>>>>>>>>>>>        End_Object    // oSearch_bn
43770>>>>>>>>>>>
43770>>>>>>>>>>>
43770>>>>>>>>>>>        //AB-StoreStart
43770>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43771>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43772>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43773>>>>>>>>>>>        //AB-StoreEnd
43773>>>>>>>>>>>
43773>>>>>>>>>>>    CD_End_Object    // sl059
43775>>>>>>>>>>>>
43775>>>>>>>>>>>
43775>>>>>>>>>>>//AB/     End_Object    // prj
43775>>>>>>>>>
43775>>>>>>>>>//DDB-Selection-pkg-End
43775>>>>>>>>>//DDB-FileEnd
43775>>>>>>>
43775>>>>>>>//AB-IgnoreEnd
43775>>>>>>>
43775>>>>>>>Object slNomism is a dbModalPanelSub
43777>>>>>>>
43777>>>>>>>    //AB-StoreTopStart
43777>>>>>>>    
43777>>>>>>>    
43777>>>>>>>    
43777>>>>>>>    //AB-StoreTopEnd
43777>>>>>>>
43777>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
43778>>>>>>>    Set Size to 175 397
43779>>>>>>>    Set Location to 5 7
43780>>>>>>>    Set Exit_Application_Local_State to FALSE
43781>>>>>>>    Set Modal_State to FALSE
43782>>>>>>>
43782>>>>>>>    //AB-DDOStart
43782>>>>>>>
43782>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
43784>>>>>>>    End_Object    // Nomisma_DD
43785>>>>>>>
43785>>>>>>>    Set Main_DD to (Nomisma_DD(self))
43786>>>>>>>    Set Server to (Nomisma_DD(self))
43787>>>>>>>
43787>>>>>>>    //AB-DDOEnd
43787>>>>>>>
43787>>>>>>>    Object oSelList is a dbListSub
43789>>>>>>>        Set Main_File to Nomisma.File_Number
43790>>>>>>>        Set Size to 130 382
43791>>>>>>>        Set Location to 6 6
43792>>>>>>>
43792>>>>>>>        Begin_Row
43795>>>>>>>            Entry_Item Nomisma.Nomisma_code
43796>>>>>>>            Entry_Item Nomisma.Nomisma_descr
43797>>>>>>>            Entry_Item Nomisma.Dekadika
43798>>>>>>>            Entry_Item Nomisma.Euro_zone
43799>>>>>>>            Entry_Item Nomisma.Einai_drx
43800>>>>>>>            Entry_Item Nomisma.Einai_euro
43801>>>>>>>        End_Row
43806>>>>>>>
43806>>>>>>>        Set Form_Width    item 0 to 49
43807>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
43808>>>>>>>        
43808>>>>>>>        Set Form_Width    item 1 to 115
43809>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43810>>>>>>>        
43810>>>>>>>        Set Form_Width    item 2 to 47
43811>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
43812>>>>>>>        
43812>>>>>>>        Set Form_Width    item 3 to 55
43813>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
43814>>>>>>>        Set Column_Checkbox_State  item 3 to True
43815>>>>>>>        
43815>>>>>>>        Set Form_Width    item 4 to 55
43816>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
43817>>>>>>>        Set Column_Checkbox_State  item 4 to True
43818>>>>>>>        
43818>>>>>>>        Set Form_Width    item 5 to 55
43819>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
43820>>>>>>>        Set Column_Checkbox_State  item 5 to True
43821>>>>>>>        
43821>>>>>>>
43821>>>>>>>        //AB-StoreStart
43821>>>>>>>        
43821>>>>>>>        //AB-StoreEnd
43821>>>>>>>
43821>>>>>>>    End_Object    // oSelList
43822>>>>>>>
43822>>>>>>>    Object oOK_bn is a ButtonSub
43824>>>>>>>        Set Label to "&„§ ¢¦šã"
43825>>>>>>>        Set Location to 140 279
43826>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43827>>>>>>>
43827>>>>>>>        //AB-StoreStart
43827>>>>>>>        Procedure OnClick
43829>>>>>>>            Send OK To (oSelList(current_object))
43830>>>>>>>        End_Procedure
43831>>>>>>>        //AB-StoreEnd
43831>>>>>>>
43831>>>>>>>    End_Object    // oOK_bn
43832>>>>>>>
43832>>>>>>>    Object oSearch_bn is a ButtonSub
43834>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43835>>>>>>>        Set Location to 140 339
43836>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43837>>>>>>>
43837>>>>>>>        //AB-StoreStart
43837>>>>>>>        
43837>>>>>>>        Procedure OnClick
43839>>>>>>>            Send Search To (oSelList(current_object))
43840>>>>>>>        End_Procedure
43841>>>>>>>        
43841>>>>>>>        
43841>>>>>>>        Set Visible_State to False
43842>>>>>>>        Set Enabled_State to False
43843>>>>>>>        //AB-StoreEnd
43843>>>>>>>
43843>>>>>>>    End_Object    // oSearch_bn
43844>>>>>>>
43844>>>>>>>
43844>>>>>>>    //AB-StoreStart
43844>>>>>>>    
43844>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43845>>>>>>>    
43845>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
43846>>>>>>>    
43846>>>>>>>    
43846>>>>>>>    
43846>>>>>>>    
43846>>>>>>>    //AB-StoreEnd
43846>>>>>>>
43846>>>>>>>End_Object    // slNomism
43847>>>>>>>
43847>>>>>>>//AB/ End_Object    // prj
43847>>>>>
43847>>>>>//DDB-Selection-pkg-End
43847>>>>>//DDB-FileEnd
43847>>>Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
43847>>>>>//DDB-FileStart
43847>>>>>//DDB-HeaderStart
43847>>>>>
43847>>>>>// File Name : SYSCURXR.DD
43847>>>>>// Class Name: Syscurxr_DataDictionary
43847>>>>>// Revision  : 8
43847>>>>>// Version   : 2
43847>>>>>
43847>>>>>Use  Windows           // Basic Definitions
43847>>>>>Use  DataDict          // DataDictionary Class Definition
43847>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43847>>>>>
43847>>>>>Open Syscurxr
43849>>>>>
43849>>>>>//DDB-HeaderEnd
43849>>>>>
43849>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
43850>>>>>
43850>>>>>    // Define_Fields:
43850>>>>>    // This procedure is used to set up all data-dictionary rules.
43850>>>>>
43850>>>>>    Procedure Define_Fields
43851>>>>>        Forward Send Define_Fields
43853>>>>>        //DDB-Generated-Code-Location
43853>>>>>        //DDB-DefineFieldStart
43853>>>>>
43853>>>>>        Set Main_File            To Syscurxr.File_Number
43854>>>>>
43854>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43855>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43856>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43857>>>>>
43857>>>>>        // Field-based properties.......................
43857>>>>>
43857>>>>>        // Syscurxr.Company_Code
43857>>>>>
43857>>>>>        // Syscurxr.Branch_Code
43857>>>>>
43857>>>>>        // Syscurxr.Year_Year
43857>>>>>
43857>>>>>        // Syscurxr.Branch_Site
43857>>>>>
43857>>>>>        // Syscurxr.Year_Recr
43857>>>>>
43857>>>>>        // Syscurxr.Company_Name
43857>>>>>
43857>>>>>        // Syscurxr.Branch_Name
43857>>>>>
43857>>>>>        // Syscurxr.Year_Descr
43857>>>>>
43857>>>>>        // Syscurxr.C_Code0
43857>>>>>
43857>>>>>        // Syscurxr.C_Code00
43857>>>>>
43857>>>>>        // Syscurxr.C_Coder
43857>>>>>
43857>>>>>        // Syscurxr.Year_Xrhshfrom
43857>>>>>
43857>>>>>        // Syscurxr.Year_Xrhshto
43857>>>>>
43857>>>>>        // Syscurxr.Beto_Site
43857>>>>>
43857>>>>>        // Syscurxr.Euro_Code
43857>>>>>
43857>>>>>        //DDB-DefineFieldEnd
43857>>>>>    End_Procedure    // Define_Fields
43858>>>>>
43858>>>>>    // Field_Defaults:
43858>>>>>    // This procedure is used to establish default field values.
43858>>>>>
43858>>>>>    Procedure Field_Defaults
43859>>>>>        Forward Send Field_Defaults
43861>>>>>        //DDB-Generated-Code-Location
43861>>>>>        //DDB-FieldDefaultStart
43861>>>>>        //DDB-FieldDefaultEnd
43861>>>>>    End_Procedure    // Field_Defaults
43862>>>>>
43862>>>>>End_Class    // Syscurxr_DataDictionary
43863>>>>>//DDB-FileEnd
43863>>>Use BMOVE.DD
INCLUDING FILE: BMOVE.DD
43863>>>>>//DDB-FileStart
43863>>>>>//DDB-HeaderStart
43863>>>>>
43863>>>>>// File Name : BMOVE.DD
43863>>>>>// Class Name: Bmove_DataDictionary
43863>>>>>// Revision  : 49
43863>>>>>// Version   : 2
43863>>>>>
43863>>>>>Use  Windows           // Basic Definitions
43863>>>>>Use  DataDict          // DataDictionary Class Definition
43863>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43863>>>>>
43863>>>>>Open Bmove
43865>>>>>Open Barticl
43867>>>>>Open Baxio
43869>>>>>Open Sysrecb
43871>>>>>Open Bkinkat
43873>>>>>Open Bsum
43875>>>>>
43875>>>>>//DDB-HeaderEnd
43875>>>>>
43875>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
43875>>>>>      //  ˜§¦          ©œ
43875>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43875>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
43875>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
43875>>>>>
43875>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43875>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43875>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
43875>>>>>
43875>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43875>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43875>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
43875>>>>>
43875>>>>>
43875>>>>>Open SysCurXr
43877>>>>>Open Baxiokat
43879>>>>>Open Btypkin
43881>>>>>Open Bkinkat
43883>>>>>Open Baxio
43885>>>>>
43885>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
43886>>>>>
43886>>>>>      Procedure Construct_Object
43887>>>>>                Forward Send Construct_Object
43889>>>>>
43889>>>>>                Property Integer piCan_Create_Baxio (FALSE)
43890>>>>>
43890>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
43890>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
43890>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
43890>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
43890>>>>>                Property Integer piBarticl_dd        0
43891>>>>>                Property Integer piBaxio_dd          0
43892>>>>>                Property Integer piBtypkin_dd        0
43893>>>>>                Property Integer piBaxiokat_dd       0
43894>>>>>                Property Integer piBaxio_Status_From 0
43895>>>>>                Property Integer piBaxio_Status_To   0
43896>>>>>
43896>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
43897>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
43897>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
43897>>>>>
43897>>>>>                Property Integer piB_Baxio_Status  0
43898>>>>>                Property Integer piA_Baxio_Status  0
43899>>>>>
43899>>>>>                //19 §˜¢˜ âª « £âª
43899>>>>>                Property  Integer piB_Garticl_Rec0           0
43900>>>>>                Property  Integer piB_Gtypkin_Rec0           0
43901>>>>>                Property  Date    pdB_Garticl_Hmnia          0
43902>>>>>                Property  Integer piB_Garticl_No             0
43903>>>>>                Property  String  psB_Garticl_C_Code2        0
43904>>>>>                Property  Number  pnB_Garticl_Rate0          0
43905>>>>>                Property  Number  pnB_Garticl_Rate00         0
43906>>>>>                Property  Number  pnB_Garticl_RateR          0
43907>>>>>                Property  String  psB_Garticl_Aitiol         0
43908>>>>>
43908>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
43909>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
43910>>>>>                Property  Number  pnB_Gmove_Master_X2        0
43911>>>>>                Property  Number  pnB_Gmove_Master_P2        0
43912>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
43913>>>>>
43913>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
43914>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
43915>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
43916>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
43917>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
43918>>>>>
43918>>>>>                //19 ¤âœª « £âª
43918>>>>>                Property  Integer piA_Garticl_Rec0           0
43919>>>>>                Property  Integer piA_Gtypkin_Rec0           0
43920>>>>>                Property  Date    pdA_Garticl_Hmnia          0
43921>>>>>                Property  Integer piA_Garticl_No             0
43922>>>>>                Property  String  psA_Garticl_C_Code2        0
43923>>>>>                Property  Number  pnA_Garticl_Rate0          0
43924>>>>>                Property  Number  pnA_Garticl_Rate00         0
43925>>>>>                Property  Number  pnA_Garticl_RateR          0
43926>>>>>                Property  String  psA_Garticl_Aitiol         0
43927>>>>>
43927>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
43928>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
43929>>>>>                Property  Number  pnA_Gmove_Master_X2        0
43930>>>>>                Property  Number  pnA_Gmove_Master_P2        0
43931>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
43932>>>>>
43932>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
43933>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
43934>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
43935>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
43936>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
43937>>>>>
43937>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
43938>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
43938>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
43939>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
43939>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
43940>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
43940>>>>>
43940>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
43940>>>>>                Property Integer  piF_Garticl_Rec0           0
43941>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
43942>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
43943>>>>>
43943>>>>>                Property Integer  piUpdate                   0
43944>>>>>                Property Integer  piBackout                  0
43945>>>>>
43945>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
43945>>>>>                Property String   psB_Barticl_Recr           ''
43946>>>>>                Property String   psB_Baxiokat_Recr          ''
43947>>>>>                Property Number   pnB_Baxio_V2               0
43948>>>>>                Property Number   pnB_Baxio_V0               0
43949>>>>>                Property Number   pnB_Baxio_V00              0
43950>>>>>                Property Number   pnB_Baxio_VR               0
43951>>>>>
43951>>>>>                Property String   psA_Barticl_Recr           ''
43952>>>>>                Property String   psA_Baxiokat_Recr          ''
43953>>>>>                Property Number   pnA_Baxio_V2               0
43954>>>>>                Property Number   pnA_Baxio_V0               0
43955>>>>>                Property Number   pnA_Baxio_V00              0
43956>>>>>                Property Number   pnA_Baxio_VR               0
43957>>>>>
43957>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
43957>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
43958>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
43959>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
43960>>>>>
43960>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
43961>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
43962>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
43963>>>>>
43963>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43964>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43965>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43966>>>>>
43966>>>>>                Property Integer    piMustNotConstrain      0
43967>>>>>
43967>>>>>
43967>>>>>      End_Procedure   //construct_object
43968>>>>>
43968>>>>>
43968>>>>>
43968>>>>>      //****************************************************************************************
43968>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
43968>>>>>      //****************************************************************************************
43968>>>>>
43968>>>>>
43968>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
43968>>>>>      //¡˜  transaction is enabled !
43968>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
43968>>>>>      //¡˜¢œå «ž¤ private.update_bsum
43968>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
43968>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
43968>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
43968>>>>>
43968>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
43968>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
43968>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
43968>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
43968>>>>>      Procedure private.Trexe Returns Integer
43969>>>>>                Integer liBackout liUpdate
43970>>>>>
43970>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
43970>>>>>                Number  lnB_Baxio_V2
43970>>>>>                Number  lnB_Baxio_V0
43970>>>>>                Number  lnB_Baxio_V00
43970>>>>>                Number  lnB_Baxio_VR
43970>>>>>
43970>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
43970>>>>>                Number  lnA_Baxio_V2
43970>>>>>                Number  lnA_Baxio_V0
43970>>>>>                Number  lnA_Baxio_V00
43970>>>>>                Number  lnA_Baxio_VR
43970>>>>>
43970>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
43970>>>>>                Get piBackout to liBackout
43971>>>>>                Get piUpdate  to liUpdate
43972>>>>>
43972>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
43972>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
43974>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
43975>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
43975>>>>>                     End
43975>>>>>>
43975>>>>>
43975>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
43975>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
43976>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
43977>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
43978>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
43979>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
43980>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
43981>>>>>
43981>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
43981>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
43982>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
43983>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
43984>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
43985>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
43986>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
43987>>>>>
43987>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
43987>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
43987>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
43987>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
43987>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
43989>>>>>                       Procedure_Return
43990>>>>>                      End
43990>>>>>>
43990>>>>>
43990>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
43990>>>>>                If (liBackout = 1);                Begin
43992>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
43993>>>>>                End //if (libackout = 1)
43993>>>>>>
43993>>>>>
43993>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
43993>>>>>                If (liUpdate = 1);                Begin
43995>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
43996>>>>>                End //if (liupdate = 1)
43996>>>>>>
43996>>>>>      End_Procedure //private.trexe
43997>>>>>
43997>>>>>
43997>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
43997>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
43997>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
43998>>>>>
43998>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
43999>>>>>
43999>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
43999>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
44002>>>>>
44002>>>>>                //**************************************************************************
44002>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
44002>>>>>                //**************************************************************************
44002>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
44004>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
44005>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
44005>>>>>                     End
44005>>>>>>
44005>>>>>                Move (lnV2  * liSign) to lnV2
44006>>>>>                Move (lnV0  * liSign) to lnV0
44007>>>>>                Move (lnV00 * liSign) to lnV00
44008>>>>>                Move (lnVR  * liSign) to lnVR
44009>>>>>
44009>>>>>                //**************************************************************************
44009>>>>>                //02.œ¤ž£â¨à©ž bsum
44009>>>>>                //**************************************************************************
44009>>>>>
44009>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
44009>>>>>                Clear Bsum
44010>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
44011>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
44012>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
44013>>>>>>
44013>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
44015>>>>>
44015>>>>>                      // jsjsjs 27/01/2001
44015>>>>>                      Add 1 to SysrecB.Bsum_Rec0
44016>>>>>                      Saverecord SysrecB
44017>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
44018>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
44019>>>>>
44019>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
44019>>>>>                      //Saverecord SysrecB
44019>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
44019>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
44019>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
44019>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
44019>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
44020>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
44021>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
44021>>>>>>
44021>>>>>
44021>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
44021>>>>>
44021>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
44021>>>>>
44021>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
44023>>>>>                     Delete Bsum
44024>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
44025>>>>>                End
44025>>>>>>
44025>>>>>                Else;                Begin
44026>>>>>                     Add lnV2  to Bsum.Bsum_SV2
44027>>>>>                     Add lnV0  to Bsum.Bsum_SV0
44028>>>>>                     Add lnV00 to Bsum.Bsum_SV00
44029>>>>>                     Add lnVR  to Bsum.Bsum_SVR
44030>>>>>                     Saverecord Bsum
44031>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
44032>>>>>                End
44032>>>>>>
44032>>>>>
44032>>>>>      End_Procedure //private.update_bsum
44033>>>>>      //****************************************************************************************
44033>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
44033>>>>>      //****************************************************************************************
44033>>>>>
44033>>>>>
44033>>>>>      //private
44033>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
44033>>>>>      Procedure private.Initialize_Properties
44034>>>>>                Integer liBarticl_dd liBaxio_dd
44035>>>>>
44035>>>>>                //barticl related properties
44035>>>>>                Get piBarticl_dd to liBarticl_dd
44036>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
44038>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
44039>>>>>                End
44039>>>>>>
44039>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
44041>>>>>
44041>>>>>                //baxio   related properties
44041>>>>>                Get piBaxio_dd to liBaxio_dd
44042>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
44044>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
44045>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
44046>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
44047>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
44048>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
44049>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
44050>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
44051>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
44052>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
44053>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
44054>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
44055>>>>>                End
44055>>>>>>
44055>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
44057>>>>>
44057>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
44058>>>>>
44058>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
44058>>>>>                Set piB_Garticl_Rec0         to 0
44059>>>>>                Set piB_Gtypkin_Rec0         to 0
44060>>>>>                Set pdB_Garticl_Hmnia        to 0
44061>>>>>                Set piB_Garticl_No           to 0
44062>>>>>                Set psB_Garticl_C_Code2      to 0
44063>>>>>                Set pnB_Garticl_Rate0        to 0
44064>>>>>                Set pnB_Garticl_Rate00       to 0
44065>>>>>                Set pnB_Garticl_RateR        to 0
44066>>>>>                Set psB_Garticl_Aitiol       to 0
44067>>>>>
44067>>>>>                Set piB_Gmove_Master_Rec0    to 0
44068>>>>>                Set piB_Gplan_Master_Rec0    to 0
44069>>>>>                Set pnB_Gmove_Master_X2      to 0
44070>>>>>                Set pnB_Gmove_Master_P2      to 0
44071>>>>>                Set psB_Gmove_Master_Aitiol  to 0
44072>>>>>
44072>>>>>                Set piB_Gmove_Slave_Rec0     to 0
44073>>>>>                Set piB_Gplan_Slave_Rec0     to 0
44074>>>>>                Set pnB_Gmove_Slave_X2       to 0
44075>>>>>                Set pnB_Gmove_Slave_P2       to 0
44076>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
44077>>>>>
44077>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
44077>>>>>                Set piA_Garticl_Rec0         to 0
44078>>>>>                Set piA_Gtypkin_Rec0         to 0
44079>>>>>                Set pdA_Garticl_Hmnia        to 0
44080>>>>>                Set piA_Garticl_No           to 0
44081>>>>>                Set psA_Garticl_C_Code2      to 0
44082>>>>>                Set pnA_Garticl_Rate0        to 0
44083>>>>>                Set pnA_Garticl_Rate00       to 0
44084>>>>>                Set pnA_Garticl_RateR        to 0
44085>>>>>                Set psA_Garticl_Aitiol       to 0
44086>>>>>
44086>>>>>                Set piA_Gmove_Master_Rec0    to 0
44087>>>>>                Set piA_Gplan_Master_Rec0    to 0
44088>>>>>                Set pnA_Gmove_Master_X2      to 0
44089>>>>>                Set pnA_Gmove_Master_P2      to 0
44090>>>>>                Set psA_Gmove_Master_Aitiol  to 0
44091>>>>>
44091>>>>>                Set piA_Gmove_Slave_Rec0     to 0
44092>>>>>                Set piA_Gplan_Slave_Rec0     to 0
44093>>>>>                Set pnA_Gmove_Slave_X2       to 0
44094>>>>>                Set pnA_Gmove_Slave_P2       to 0
44095>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
44096>>>>>
44096>>>>>                Set piBaxio_Status_From      to 0
44097>>>>>                Set piBaxio_Status_To        to 0
44098>>>>>
44098>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
44098>>>>>                Set piF_Garticl_Rec0         to 0
44099>>>>>                Set piF_Gmove_Master_Rec0    to 0
44100>>>>>                Set piF_Gmove_Slave_Rec0     to 0
44101>>>>>
44101>>>>>                Set piUpdate                 to 0
44102>>>>>                Set piBackout                to 0
44103>>>>>
44103>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
44103>>>>>                Set psB_Barticl_Recr         to ''
44104>>>>>                Set psB_Baxiokat_Recr        to ''
44105>>>>>                Set pnB_Baxio_V2             to 0
44106>>>>>                Set pnB_Baxio_V0             to 0
44107>>>>>                Set pnB_Baxio_V00            to 0
44108>>>>>                Set pnB_Baxio_VR             to 0
44109>>>>>
44109>>>>>                Set psA_Barticl_Recr         to ''
44110>>>>>                Set psA_Baxiokat_Recr        to ''
44111>>>>>                Set pnA_Baxio_V2             to 0
44112>>>>>                Set pnA_Baxio_V0             to 0
44113>>>>>                Set pnA_Baxio_V00            to 0
44114>>>>>                Set pnA_Baxio_VR             to 0
44115>>>>>
44115>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
44115>>>>>                Set  piGarticl_Delete         to  0
44116>>>>>                Set  piGarticl_Edit           to  0
44117>>>>>                Set  piGarticl_Create         to  0
44118>>>>>
44118>>>>>                Set  piMaster_Gmove_Delete    to  0
44119>>>>>                Set  piMaster_Gmove_Edit      to  0
44120>>>>>                Set  piMaster_Gmove_Create    to  0
44121>>>>>
44121>>>>>                Set  piSlave_Gmove_Delete     to  0
44122>>>>>                Set  piSlave_Gmove_Edit       to  0
44123>>>>>                Set  piSlave_Gmove_Create     to  0
44124>>>>>      End_Procedure //private.Initialize_Properties
44125>>>>>
44125>>>>>
44125>>>>>      //private
44125>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
44125>>>>>      Procedure private.Creating_Barticl
44126>>>>>      End_Procedure //private.creating_barticl
44127>>>>>
44127>>>>>
44127>>>>>      //private
44127>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
44127>>>>>      Procedure private.Creating_Baxio
44128>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
44129>>>>>
44129>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
44129>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
44129>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
44129>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
44129>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
44129>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
44129>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
44129>>>>>                Case Begin
44129>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
44129>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
44131>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
44132>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
44133>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
44134>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
44135>>>>>
44135>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
44136>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
44137>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
44138>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
44139>>>>>                     Case Break
44140>>>>>
44140>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
44140>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
44143>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
44144>>>>>                          Move ""                      to Baxio.Baxio_Code_In
44145>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
44146>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
44147>>>>>
44147>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
44148>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
44149>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
44150>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
44151>>>>>                     Case Break
44152>>>>>
44152>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
44152>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
44153>>>>>                Case End
44153>>>>>
44153>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
44156>>>>>                Move barticl.barticl_hmnia  to baxio.baxio_hmniae
44157>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
44157>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
44158>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
44161>>>>>      End_Procedure //private.creating_baxio
44162>>>>>
44162>>>>>
44162>>>>>//      //private
44162>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
44162>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
44162>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
44162>>>>>//                                          String lsBaxiokat_Recr;
44162>>>>>//                                          Returns Integer
44162>>>>>//               Clear Bsum
44162>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
44162>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
44162>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
44162>>>>>//               Function_Return Bsum.Gmove_Srec0
44162>>>>>//      End_Function //private.fibsum_gmove_srec0
44162>>>>>
44162>>>>>
44162>>>>>      //private
44162>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
44162>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
44162>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
44163>>>>>               Clear Bkinkat
44164>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
44165>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
44166>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
44167>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
44168>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
44169>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
44170>>>>>>
44170>>>>>               If (Found = 0) Begin
44172>>>>>                               Set piBaxio_Status_From to (-1)
44173>>>>>                               Set piBaxio_Status_To   to (-1)
44174>>>>>                               Function_Return 0
44175>>>>>                              End
44175>>>>>>
44175>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
44176>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
44177>>>>>
44177>>>>>
44177>>>>>               Function_Return Bkinkat.Baxiokat_Code
44178>>>>>      End_Function //private.fibkinkat_baxiokat_code
44179>>>>>
44179>>>>>
44179>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
44179>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
44179>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
44180>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
44182>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
44183>>>>>>
44183>>>>>                      Procedure_Return
44184>>>>>                     End
44184>>>>>>
44184>>>>>
44184>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
44184>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
44185>>>>>
44185>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
44185>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
44186>>>>>
44186>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
44186>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
44187>>>>>
44187>>>>>                //¤æ£ ©£˜ reporting
44187>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
44188>>>>>      End_Procedure //private.adjust_balances
44189>>>>>
44189>>>>>
44189>>>>>
44189>>>>>
44189>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
44189>>>>>      //£œ æ¢˜ «˜ ddo id's
44189>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
44189>>>>>      Procedure End_Construct_Object
44190>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
44191>>>>>
44191>>>>>                Forward Send End_Construct_Object
44193>>>>>
44193>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
44194>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
44195>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
44196>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
44197>>>>>
44197>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
44197>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
44197>>>>>
44197>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
44197>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
44197>>>>>
44197>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
44197>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
44197>>>>>
44197>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
44197>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
44200>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
44203>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
44206>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
44209>>>>>
44209>>>>>                //properties › ¡á «¦¬
44209>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
44209>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
44209>>>>>                Set piBarticl_dd                  to liBarticl_dd
44210>>>>>                Set piBaxio_dd                    to liBaxio_dd
44211>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
44212>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
44213>>>>>
44213>>>>>                //properties «¦¬ btypkin
44213>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
44214>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
44215>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
44216>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
44217>>>>>
44217>>>>>                //properties «¦¬ baxiokat
44217>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
44218>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
44219>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
44220>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
44221>>>>>
44221>>>>>                //properties «¦¬ barticl
44221>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
44222>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
44223>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
44224>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
44225>>>>>
44225>>>>>      End_Procedure   //end_construct_object
44226>>>>>
44226>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
44226>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
44226>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
44226>>>>>      Procedure Constrain
44227>>>>>            Forward Send Constrain
44229>>>>>            If (piMustNotConstrain(Self)=2) Begin
44231>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
44233>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
44235>>>>>            End
44235>>>>>>
44235>>>>>            Else Begin
44236>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
44238>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
44240>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
44242>>>>>            End
44242>>>>>>
44242>>>>>      End_Procedure   //constrain
44243>>>>>
44243>>>>>
44243>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
44243>>>>>      //™) ˜¤áš¤à©ž properties
44243>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
44243>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
44243>>>>>      //œ) œ¤ž£â¨à©ž properties after
44243>>>>>      Procedure Update
44244>>>>>                Integer liTemp
44245>>>>>                Integer liBarticl_dd      liBaxio_dd
44245>>>>>                Integer liCreated_Barticl liCreated_Baxio
44245>>>>>                String  lsGplan_Slave_Code
44245>>>>>
44245>>>>>                Forward Send Update
44247>>>>>
44247>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
44247>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
44247>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
44247>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
44248>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
44251>>>>>
44251>>>>>
44251>>>>>                //***********************************************************
44251>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
44251>>>>>                //***********************************************************
44251>>>>>
44251>>>>>
44251>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
44251>>>>>                Get piBarticl_dd to liBarticl_dd
44252>>>>>                Get piBaxio_dd   to liBaxio_dd
44253>>>>>
44253>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
44253>>>>>                If (liBarticl_dd <> 0);                Begin
44255>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
44256>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
44259>>>>>                End
44259>>>>>>
44259>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
44261>>>>>
44261>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
44261>>>>>                If (liBaxio_dd   <> 0);                Begin
44263>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
44264>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
44267>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
44268>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
44269>>>>>                End
44269>>>>>>
44269>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
44271>>>>>
44271>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
44271>>>>>//                //***************************************************************************
44271>>>>>//                //============================================================================
44271>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
44271>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
44271>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
44271>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
44271>>>>>//                //***************************************************************************
44271>>>>>//                //============================================================================
44271>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
44271>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
44271>>>>>
44271>>>>>                Send Convert_Axio_Values to liBaxio_dd
44272>>>>>
44272>>>>>
44272>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
44272>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
44273>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
44274>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
44275>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
44276>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
44277>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
44278>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
44279>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
44280>>>>>
44280>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
44281>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
44282>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
44283>>>>>
44283>>>>>
44283>>>>>                //™) ˜¤áš¤à©ž properties
44283>>>>>
44283>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
44283>>>>>
44283>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44283>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
44283>>>>>                //     previous §œ›å˜ «¦¬ bmove,
44283>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
44283>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
44284>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
44285>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
44286>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
44287>>>>>
44287>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44287>>>>>
44287>>>>>// ----------------------------------------------------------------------------
44287>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
44287>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
44287>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
44287>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
44287>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
44287>>>>>//                  ola ta _Out pedia
44287>>>>>
44287>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
44287>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
44287>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
44287>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44287>>>>>
44287>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
44289>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
44291>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
44292>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
44293>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
44294>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44295>>>>>                    End
44295>>>>>>
44295>>>>>                    Else Begin
44296>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
44297>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
44298>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
44299>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44300>>>>>                    End
44300>>>>>>
44300>>>>>                End
44300>>>>>>
44300>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
44303>>>>>                    // js 24/02/2002 PARATHRHSEIS
44303>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
44303>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
44303>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
44303>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
44303>>>>>                    // me Lcode h update tou Baxio_DD
44303>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
44303>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
44303>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
44303>>>>>
44303>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
44303>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
44303>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
44303>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
44303>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
44303>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
44303>>>>>                    // js 24/02/2002 Parathrhseis
44303>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
44304>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
44305>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
44306>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44307>>>>>                End
44307>>>>>>
44307>>>>>
44307>>>>>// ----------------------------------------------------------------------------
44307>>>>>
44307>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44307>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
44307>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
44307>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
44309>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
44310>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
44311>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
44312>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
44313>>>>>                End
44313>>>>>>
44313>>>>>
44313>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
44313>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44314>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44315>>>>>
44315>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
44315>>>>>//                Case Begin
44315>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
44315>>>>>////jsjsjs 24/01/2001
44315>>>>>////                          Clear Gplan
44315>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
44315>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
44315>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
44315>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
44315>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
44315>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
44315>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
44315>>>>>////jsjsjs 24/01/2001
44315>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
44315>>>>>
44315>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
44315>>>>>//                     Case Break
44315>>>>>
44315>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
44315>>>>>//                     Case Break
44315>>>>>
44315>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
44315>>>>>//                          Move 0 to Bmove.Gplan_SRec0
44315>>>>>//                Case End
44315>>>>>
44315>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
44315>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
44316>>>>>
44316>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
44316>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
44316>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
44316>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
44316>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
44316>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
44316>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
44316>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
44316>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
44316>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
44316>>>>>
44316>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
44316>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
44316>>>>>
44316>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
44316>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
44316>>>>>
44316>>>>>                Case Begin
44316>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
44318>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44318>>>>>//                          Set pnA_Gmove_Master_P2 to 0
44318>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
44318>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44318>>>>>                     Case Break
44319>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
44322>>>>>//                          Set pnA_Gmove_Master_X2 to 0
44322>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44322>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44322>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
44322>>>>>                     Case Break
44323>>>>>                     Case Else
44323>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
44324>>>>>>
44324>>>>>                Case End
44324>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
44324>>>>>
44324>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
44324>>>>>//                                                                            Barticl.Barticl_Rec0,;
44324>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
44324>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
44324>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
44324>>>>>
44324>>>>>                Set piUpdate to 1
44325>>>>>
44325>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
44325>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
44326>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
44327>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
44328>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
44329>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
44330>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
44331>>>>>
44331>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
44331>>>>>//                If (Barticl.Garticl_Rec0 = 0);
44331>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
44331>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
44331>>>>>//                     Set  piGarticl_Create         to  1
44331>>>>>//                     Set  piMaster_Gmove_Create    to  1
44331>>>>>//                End
44331>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
44331>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
44331>>>>>      End_Procedure   //update
44332>>>>>
44332>>>>>
44332>>>>>      Procedure Backout
44333>>>>>                Forward Send Backout
44335>>>>>
44335>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
44335>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
44336>>>>>
44336>>>>>
44336>>>>>
44336>>>>>                //******************************
44336>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
44336>>>>>                //******************************
44336>>>>>
44336>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
44336>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
44336>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
44336>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
44336>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
44336>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
44336>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
44336>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
44336>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
44336>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
44336>>>>>
44336>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
44336>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
44336>>>>>
44336>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
44336>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
44336>>>>>
44336>>>>>                Case Begin
44336>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
44338>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44338>>>>>//                          Set pnB_Gmove_Master_P2 to 0
44338>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
44338>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44338>>>>>                     Case Break
44339>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
44342>>>>>//                          Set pnB_Gmove_Master_X2 to 0
44342>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44342>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44342>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
44342>>>>>                     Case Break
44343>>>>>                     Case Else
44343>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
44344>>>>>>
44344>>>>>                Case End
44344>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
44344>>>>>
44344>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
44344>>>>>//                                                                            Barticl.Barticl_Rec0,;
44344>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
44344>>>>>
44344>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
44344>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
44344>>>>>
44344>>>>>                Set piBackout to 1
44345>>>>>
44345>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
44345>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
44346>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
44347>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
44348>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
44349>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
44350>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
44351>>>>>
44351>>>>>
44351>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
44351>>>>>//                Case Begin
44351>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
44351>>>>>//                           Set  piGarticl_Delete         to  1
44351>>>>>//                           Set  piMaster_Gmove_Delete    to  1
44351>>>>>//                     Case Break
44351>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
44351>>>>>//                           Set  piGarticl_Edit           to  1
44351>>>>>//                           Set  piMaster_Gmove_Edit      to  1
44351>>>>>//                     Case Break
44351>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
44351>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
44351>>>>>//                     Case Break
44351>>>>>//                Case End
44351>>>>>
44351>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
44351>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
44351>>>>>/////////////////////Case Break
44351>>>>>      End_Procedure   // backout
44352>>>>>
44352>>>>>
44352>>>>>      Procedure Creating
44353>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
44354>>>>>
44354>>>>>                Forward Send Creating
44356>>>>>
44356>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
44357>>>>>
44357>>>>>
44357>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
44357>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
44357>>>>>
44357>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
44357>>>>>                Add 1 to Barticl.Barticl_Lines
44358>>>>>
44358>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
44358>>>>>                Add 1 to Barticl.Barticl_BmoveLa
44359>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
44360>>>>>
44360>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
44360>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
44361>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
44362>>>>>
44362>>>>>                //pourqua ??????
44362>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
44363>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
44364>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
44364>>>>>      End_Procedure //creating
44365>>>>>
44365>>>>>
44365>>>>>      Procedure Deleting
44366>>>>>                Integer liTemp
44367>>>>>
44367>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
44367>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
44367>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
44367>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
44367>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
44367>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
44367>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
44367>>>>>                //«¦¬ barticl.
44367>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
44367>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
44367>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
44369>>>>>                     Get Validate_Delete to liTemp
44370>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
44373>>>>>                End
44373>>>>>>
44373>>>>>
44373>>>>>                Forward Send Deleting
44375>>>>>
44375>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
44375>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
44376>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
44379>>>>>
44379>>>>>
44379>>>>>                //***********************************************************
44379>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
44379>>>>>                //***********************************************************
44379>>>>>
44379>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
44379>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
44379>>>>>
44379>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
44379>>>>>                Sub 1 from Barticl.Barticl_Lines
44380>>>>>
44380>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
44380>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
44383>>>>>
44383>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
44383>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
44386>>>>>
44386>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
44386>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
44386>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
44386>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44387>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44388>>>>>
44388>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
44388>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44388>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
44388>>>>>                //     «˜ ¡¨˜«áà ©«˜
44388>>>>>                //     previous §œ›å˜ «¦¬ bmove,
44388>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
44388>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
44389>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
44390>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
44391>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
44392>>>>>
44392>>>>>                // js 05/09/2002
44392>>>>>                Saverecord Barticl
44393>>>>>                Saverecord Baxio
44394>>>>>
44394>>>>>      End_Procedure //deleting
44395>>>>>
44395>>>>>
44395>>>>>      Procedure Save_Main_File
44396>>>>>                Forward Send Save_Main_File
44398>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
44399>>>>>      End_Procedure//save_main_file
44400>>>>>
44400>>>>>
44400>>>>>      Procedure Delete_Main_File
44401>>>>>                Integer liTemp
44402>>>>>
44402>>>>>                Forward Send Delete_Main_File
44404>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
44405>>>>>
44405>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
44405>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
44405>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
44405>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
44407>>>>>
44407>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
44407>>>>>                     //jsjsjs 26/01/2001
44407>>>>>                     //Sub 1 from Year.Year_NumBaxio
44407>>>>>
44407>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
44407>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
44410>>>>>
44410>>>>>                     Delete Baxio
44411>>>>>                End
44411>>>>>>
44411>>>>>      End_Procedure //delete_main_file
44412>>>>>
44412>>>>>
44412>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
44413>>>>>                String lsError_Message
44414>>>>>                Case Begin
44414>>>>>                     //˜§æ validate save
44414>>>>>                     Case (iError_Num = 5555)
44416>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
44417>>>>>                     Case Break
44418>>>>>                     Case (iError_Num = 1001)
44421>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
44422>>>>>                     Case Break
44423>>>>>                     Case (iError_Num = 1004)
44426>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
44427>>>>>                     Case Break
44428>>>>>                     Case (iError_Num = 1005)
44431>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
44432>>>>>                     Case Break
44433>>>>>                     Case (iError_Num = 1006)
44436>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
44437>>>>>                     Case Break
44438>>>>>                     Case (iError_Num = 1100)
44441>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
44442>>>>>                     Case Break
44443>>>>>
44443>>>>>                     //˜§æ validate delete
44443>>>>>                     Case (iError_Num = 2001)
44446>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
44447>>>>>                     Case Break
44448>>>>>                     Case (iError_Num = 2100)
44451>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
44452>>>>>                     Case Break
44453>>>>>
44453>>>>>                     //˜§æ update
44453>>>>>                     Case (iError_Num = 3001)
44456>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
44457>>>>>                     Case Break
44458>>>>>                     Case (iError_Num = 3002)
44461>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
44462>>>>>                     Case Break
44463>>>>>
44463>>>>>                     //˜§æ deleting
44463>>>>>                     Case (iError_Num = 4002)
44466>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
44467>>>>>                     Case Break
44468>>>>>
44468>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
44468>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
44471>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44472>>>>>                     Case Break
44473>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
44476>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44477>>>>>                     Case Break
44478>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
44481>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44482>>>>>                     Case Break
44483>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
44486>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44487>>>>>                     Case Break
44488>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
44491>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44492>>>>>                     Case Break
44493>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
44496>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44497>>>>>                     Case Break
44498>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
44501>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44502>>>>>                     Case Break
44503>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
44506>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44507>>>>>                     Case Break
44508>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
44511>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44512>>>>>                     Case Break
44513>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
44516>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44517>>>>>                     Case Break
44518>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
44521>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44522>>>>>                     Case Break
44523>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
44526>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44527>>>>>                     Case Break
44528>>>>>
44528>>>>>                     //˜§æ private.trexe (save+delete main file)
44528>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
44531>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
44532>>>>>                     Case Break
44533>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
44536>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
44537>>>>>                     Case Break
44538>>>>>
44538>>>>>                     Case Else
44538>>>>>                          Forward Send Operation_Not_Allowed iError_Num
44540>>>>>                Case End
44540>>>>>
44540>>>>>                Error iError_Num lsError_Message
44541>>>>>>
44541>>>>>      End_Procedure // operation_not_allowed
44542>>>>>
44542>>>>>
44542>>>>>
44542>>>>>
44542>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
44542>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
44542>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
44542>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
44542>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
44542>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
44542>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
44542>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
44542>>>>>     //1007
44542>>>>>     //1008
44542>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
44542>>>>>      Function Validate_Save Returns Integer
44543>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
44544>>>>>
44544>>>>>               Forward Get Validate_Save to iReturnVal
44546>>>>>
44546>>>>>               If (Not(iReturnVal));               Begin
44548>>>>>
44548>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
44548>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
44548>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
44548>>>>>//                End
44548>>>>>
44548>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
44548>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
44550>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
44550>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
44550>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
44550>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
44550>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
44550>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
44552>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
44555>>>>>                      End
44555>>>>>>
44555>>>>>                      Else;                      Begin
44556>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
44559>>>>>                      End
44559>>>>>>
44559>>>>>
44559>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
44559>>>>>                      //If (Not(;
44559>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
44559>>>>>                      //   )) Send Operation_Not_Allowed 1002
44559>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
44559>>>>>>
44559>>>>>
44559>>>>>
44559>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
44559>>>>>                Else;                Begin //edit an existing record
44560>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
44560>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
44563>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
44563>>>>>>
44563>>>>>
44563>>>>>/////////////// js 07/08/2001  07-08-2001
44563>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
44563>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
44563>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
44563>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
44563>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
44563>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
44563>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
44563>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
44563>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
44563>>>>>/////////////// js 07/08/2001  07-08-2001
44563>>>>>
44563>>>>>
44563>>>>>
44563>>>>>
44563>>>>>                //1100:cby = globals
44563>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
44566>>>>>
44566>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
44566>>>>>>
44566>>>>>               Function_Return iReturnVal
44567>>>>>      End_Function //validate_save
44568>>>>>
44568>>>>>
44568>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
44568>>>>>      Function Validate_Delete  Returns Integer
44569>>>>>               Integer iReturnVal
44570>>>>>               Forward Get Validate_Delete  To iReturnVal
44572>>>>>               If (Not(iReturnVal));               Begin
44574>>>>>
44574>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
44574>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
44577>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
44580>>>>>
44580>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
44580>>>>>>
44580>>>>>               Function_Return iReturnVal
44581>>>>>      End_Function //validate_delete
44582>>>>>
44582>>>>>
44582>>>>>      Procedure Request_Save
44583>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
44584>>>>>                String  lsBtypkin_Recr
44584>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
44584>>>>>                Send private.Initialize_Properties
44585>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
44585>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
44586>>>>>
44586>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
44586>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
44587>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
44588>>>>>
44588>>>>>                Clear Bkinkat
44589>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
44590>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
44591>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
44592>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
44593>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
44594>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
44595>>>>>>
44595>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
44597>>>>>                                Send Operation_Not_Allowed 3002
44598>>>>>                               End
44598>>>>>>
44598>>>>>
44598>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
44600>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
44601>>>>>                      Set piCan_Create_Baxio                                 to TRUE
44602>>>>>                     End
44602>>>>>>
44602>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
44603>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
44604>>>>>                      Set piCan_Create_Baxio                                 to FALSE
44605>>>>>                     End
44605>>>>>>
44605>>>>>
44605>>>>>                Forward Send Request_Save
44607>>>>>
44607>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
44607>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
44608>>>>>                Set Smart_Filemode_State to True
44609>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
44609>>>>>                Send private.Initialize_Properties
44610>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
44610>>>>>                Indicate Err False
44611>>>>>      End_Procedure //request_save
44612>>>>>
44612>>>>>
44612>>>>>      Procedure Request_Delete
44613>>>>>                Integer iErrorObj
44614>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
44615>>>>>                Forward Send Request_Delete
44617>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
44618>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
44618>>>>>                Indicate Err False
44619>>>>>      End_Procedure   //request_delete
44620>>>>>
44620>>>>>
44620>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
44620>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
44620>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
44620>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
44620>>>>>//      Procedure private.Transaction_Update_Other_Modules
44620>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
44620>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
44620>>>>>
44620>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
44620>>>>>//                String lsBaxiokat_Recr
44620>>>>>
44620>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
44620>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
44620>>>>>
44620>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
44620>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
44620>>>>>
44620>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
44620>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
44620>>>>>
44620>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
44620>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
44620>>>>>
44620>>>>>
44620>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
44620>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
44620>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
44620>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
44620>>>>>
44620>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
44620>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
44620>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
44620>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
44620>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
44620>>>>>
44620>>>>>
44620>>>>>//                //                                                  s  l  a  v  e  = bsum
44620>>>>>//                //                                        edit        create        delete
44620>>>>>//                //                                       -----        ------        ------
44620>>>>>//                // master garticl + gmove     edit         x            x              x
44620>>>>>//                //                            create                    x
44620>>>>>//                //                            delete                                   x
44620>>>>>//                // slave  gmove               edit         x            x              x
44620>>>>>//                //                            create                    x
44620>>>>>//                //                            delete                                   x
44620>>>>>
44620>>>>>
44620>>>>>//                If (;
44620>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
44620>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
44620>>>>>//                   );
44620>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
44620>>>>>//                //***************************************************************************
44620>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
44620>>>>>//                //***************************************************************************
44620>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
44620>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
44620>>>>>
44620>>>>>//// jsjsjs 24/01/2001
44620>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
44620>>>>>////                                                                                    liFlag02;
44620>>>>>////                                                                                    liFlag03;
44620>>>>>////                                                                                    liFlag04;
44620>>>>>////                                                                                    liFlag05
44620>>>>>//// jsjsjs 24/01/2001
44620>>>>>
44620>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
44620>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
44620>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
44620>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
44620>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
44620>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
44620>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
44620>>>>>
44620>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
44620>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
44620>>>>>//                Clear Barticl
44620>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
44620>>>>>//                Find Eq Barticl.Recnum
44620>>>>>//                If (Found = 0);
44620>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
44620>>>>>//                      Send Operation_Not_Allowed 5001
44620>>>>>//                End
44620>>>>>
44620>>>>>//                //=======================================================================
44620>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
44620>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
44620>>>>>//                If ((piUpdate(Self)) = TRUE);
44620>>>>>//                Begin
44620>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
44620>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
44620>>>>>//                     Clear Bsum
44620>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
44620>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
44620>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
44620>>>>>//                     If (Found=0);
44620>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
44620>>>>>//                           Send Operation_Not_Allowed 5002
44620>>>>>//                     End
44620>>>>>
44620>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
44620>>>>>//                     Case Begin
44620>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
44620>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
44620>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
44620>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
44620>>>>>//                               If (;
44620>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
44620>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
44620>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
44620>>>>>//                               If (;
44620>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
44620>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
44620>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
44620>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
44620>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
44620>>>>>//                               Saverecord Barticl
44620>>>>>//                          Case Break
44620>>>>>
44620>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
44620>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
44620>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
44620>>>>>//                          Case Else
44620>>>>>//                               If (;
44620>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
44620>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
44620>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
44620>>>>>//                               If (;
44620>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
44620>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
44620>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
44620>>>>>//                          Case Break
44620>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
44620>>>>>
44620>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
44620>>>>>//                     Case Begin
44620>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
44620>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
44620>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
44620>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
44620>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
44620>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
44620>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
44620>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
44620>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
44620>>>>>//                               Saverecord Bsum
44620>>>>>//                          Case Break
44620>>>>>
44620>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
44620>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
44620>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
44620>>>>>//                          Case Else
44620>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
44620>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
44620>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
44620>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
44620>>>>>//                          Case Break
44620>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
44620>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
44620>>>>>//                //=======================================================================
44620>>>>>
44620>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
44620>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
44620>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
44620>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
44620>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
44620>>>>>//                Begin
44620>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
44620>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
44620>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
44620>>>>>//                     If (;
44620>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
44620>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
44620>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
44620>>>>>//                     If (;
44620>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
44620>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
44620>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
44620>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
44620>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
44620>>>>>//                     Saverecord Barticl
44620>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
44620>>>>>//                //****************************************************************************
44620>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
44620>>>>>//                //****************************************************************************
44620>>>>>//                End //if (liMust_Update_Gl > 0) and ...
44620>>>>>
44620>>>>>
44620>>>>>
44620>>>>>//                If (liMust_Update_CUSTOMER > 0);
44620>>>>>//                Begin
44620>>>>>//                //****************************************************************************
44620>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
44620>>>>>//                //****************************************************************************
44620>>>>>//                //****************************************************************************
44620>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
44620>>>>>//                //****************************************************************************
44620>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
44620>>>>>
44620>>>>>
44620>>>>>
44620>>>>>//                If (liMust_Update_VENDOR  > 0);
44620>>>>>//                Begin
44620>>>>>//                //****************************************************************************
44620>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
44620>>>>>//                //****************************************************************************
44620>>>>>//                //****************************************************************************
44620>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
44620>>>>>//                //****************************************************************************
44620>>>>>//                End //if (liMust_Update_VENDOR > 0)
44620>>>>>
44620>>>>>//      End_Procedure //private.transaction_update_other_modules
44620>>>>>
44620>>>>>
44620>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
44620>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
44620>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
44620>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
44620>>>>>
44620>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
44620>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
44620>>>>>
44620>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
44620>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
44620>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
44620>>>>>
44620>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
44620>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
44620>>>>>
44620>>>>>
44620>>>>>               //Forward Send Request_Save
44620>>>>>
44620>>>>>
44620>>>>>
44620>>>>>
44620>>>>>
44620>>>>>//--------------------------------------------------------------------------------
44620>>>>>    Procedure Define_Fields
44621>>>>>        Forward Send Define_Fields
44623>>>>>        //DDB-Generated-Code-Location
44623>>>>>        //DDB-DefineFieldStart
44623>>>>>
44623>>>>>        Set Main_File            To Bmove.File_Number
44624>>>>>        Set Cascade_Delete_State To FALSE
44625>>>>>
44625>>>>>
44625>>>>>        // Parent (Server) file structure...............
44625>>>>>        Send Add_Server_File  Barticl.File_Number
44626>>>>>        Send Add_Server_File  Baxio.File_Number
44627>>>>>
44627>>>>>        // External (System) file structure.............
44627>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
44628>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
44629>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
44630>>>>>
44630>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
44633>>>>>
44633>>>>>        // Field-based properties.......................
44633>>>>>
44633>>>>>        // Bmove.Company_Code
44633>>>>>
44633>>>>>        // Bmove.Branch_Code
44633>>>>>
44633>>>>>        // Bmove.Year_Year
44633>>>>>
44633>>>>>        // Bmove.Btypkin_Code
44633>>>>>
44633>>>>>        // Bmove.Barticl_Hmnia
44633>>>>>
44633>>>>>        // Bmove.Barticl_No
44633>>>>>
44633>>>>>        // Bmove.Baxio_Code
44633>>>>>
44633>>>>>        // Bmove.Barticl_Recr
44633>>>>>
44633>>>>>        // Bmove.Baxio_Recr
44633>>>>>
44633>>>>>        // Bmove.Bmove_Rec0
44633>>>>>
44633>>>>>        // Bmove.Bmove_Recr
44633>>>>>
44633>>>>>        // Bmove.Bmove_Aa
44633>>>>>
44633>>>>>        // Bmove.Baxio_Aa
44633>>>>>
44633>>>>>        // Bmove.Gplan_Srec0
44633>>>>>
44633>>>>>        // Bmove.Baxio_Pfile
44633>>>>>
44633>>>>>        // Bmove.Baxio_Pcode
44633>>>>>
44633>>>>>        // Bmove.Baxio_Pepon
44633>>>>>
44633>>>>>        // Bmove.Baxio_Ppar
44633>>>>>
44633>>>>>        // Bmove.Btypkin_Recr
44633>>>>>
44633>>>>>        // Bmove.Sls_Id
44633>>>>>
44633>>>>>        // Bmove.Cnt_Id
44633>>>>>
44633>>>>>        // Bmove.Presp_Id
44633>>>>>
44633>>>>>        // Bmove.Bmove_M_Code
44633>>>>>
44633>>>>>        // Bmove.Cmoves_Recr
44633>>>>>
44633>>>>>        // Bmove.Exei_Enhmerosei
44633>>>>>
44633>>>>>        // Bmove.Hmnia_Enhmeros
44633>>>>>
44633>>>>>        //DDB-DefineFieldEnd
44633>>>>>
44633>>>>>        Set Main_File            To Bmove.File_Number
44634>>>>>        Set Cascade_Delete_State To FALSE
44635>>>>>
44635>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
44636>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
44637>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44638>>>>>
44638>>>>>        // Parent (Server) file structure...............
44638>>>>>        Send Add_Server_File  Baxio.File_Number
44639>>>>>        Send Add_Server_File  Barticl.File_Number
44640>>>>>
44640>>>>>        // External (System) file structure.............
44640>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
44641>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
44642>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
44643>>>>>
44643>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
44646>>>>>
44646>>>>>        // Field-based properties.......................
44646>>>>>
44646>>>>>        // Bmove.Company_Code
44646>>>>>
44646>>>>>        // Bmove.Branch_Code
44646>>>>>
44646>>>>>        // Bmove.Year_Year
44646>>>>>
44646>>>>>        // Bmove.Btypkin_Code
44646>>>>>
44646>>>>>        // Bmove.Barticl_Hmnia
44646>>>>>
44646>>>>>        // Bmove.Barticl_No
44646>>>>>
44646>>>>>        // Bmove.Barticl_Rec0
44646>>>>>
44646>>>>>        // Bmove.Baxio_Rec0
44646>>>>>
44646>>>>>        // Bmove.Bmove_Rec0
44646>>>>>
44646>>>>>        // Bmove.Bmove_Aa
44646>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
44647>>>>>
44647>>>>>        // Bmove.Baxio_Aa
44647>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
44648>>>>>
44648>>>>>        // Bmove.Gplan_Srec0
44648>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
44649>>>>>
44649>>>>>        // Bmove.Baxio_Pfile
44649>>>>>
44649>>>>>        // Bmove.Baxio_Pcode
44649>>>>>
44649>>>>>        // Bmove.Baxio_Pepon
44649>>>>>
44649>>>>>        // Bmove.Baxio_Ppar
44649>>>>>
44649>>>>>    End_Procedure    // Define_Fields
44650>>>>>
44650>>>>>
44650>>>>>    Procedure Field_Defaults
44651>>>>>        Forward Send Field_Defaults
44653>>>>>        //DDB-Generated-Code-Location
44653>>>>>        //DDB-FieldDefaultStart
44653>>>>>        //DDB-FieldDefaultEnd
44653>>>>>    End_Procedure    // Field_Defaults
44654>>>>>
44654>>>>>End_Class    // Bmove_DataDictionary
44655>>>>>//DDB-FileEnd
44655>>>
44655>>>//AB-IgnoreEnd
44655>>>
44655>>>ACTIVATE_VIEW Activate_VW037 FOR VW037
44659>>>
44659>>>Object VW037 is a dbViewSub
44661>>>
44661>>>    //AB-StoreTopStart
44661>>>                                    
44661>>>    //AB-StoreTopEnd
44661>>>
44661>>>    Set Label to "V037:€¥ æš¨˜­˜"
44662>>>    Set Size to 278 515
44663>>>    Set Location to 0 5
44664>>>
44664>>>    //AB-DDOStart
44664>>>
44664>>>    Object Btypkin_DD is a Btypkin_DataDictionary
44666>>>
44666>>>        //AB-StoreStart
44666>>>                                                                                                                                                                                        
44666>>>        Set Field_Prompt_Object Field Btypkin.Btypkin_Code to None
44667>>>        
44667>>>        
44667>>>        
44667>>>        //AB-StoreEnd
44667>>>
44667>>>    End_Object    // Btypkin_DD
44668>>>
44668>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
44670>>>
44670>>>        //AB-StoreStart
44670>>>                                                                                                                                                                                        
44670>>>        Set Field_Options Field Baxiokat.Baxiokat_Code  to DD_Clear_Field_Options DD_Required
44671>>>        
44671>>>        Set Foreign_Field_Options DD_IndexField         to DD_Clear_Field_Options DD_FindReq
44672>>>        Set Foreign_Field_Options DD_KeyField           to DD_Clear_Field_Options DD_FindReq
44673>>>        
44673>>>        
44673>>>        //AB-StoreEnd
44673>>>
44673>>>    End_Object    // Baxiokat_DD
44674>>>
44674>>>    Object Barticl_DD is a Barticl_DataDictionary
44676>>>        Set DDO_Server to (Btypkin_DD(self))
44677>>>
44677>>>        //AB-StoreStart
44677>>>                                                                                                                                                                                        
44677>>>        Set Field_Prompt_Object Field Barticl.Barticl_Hmnia to None
44678>>>        Set Field_Prompt_Object Field Barticl.Barticl_No    to None
44679>>>        
44679>>>        //AB-StoreEnd
44679>>>
44679>>>    End_Object    // Barticl_DD
44680>>>
44680>>>    Object Baxio_DD is a Baxio_DataDictionary
44682>>>        Set DDO_Server to (Baxiokat_DD(self))
44683>>>
44683>>>        //AB-StoreStart
44683>>>        set pimustnotconstrain to 2
44684>>>        Function Validate_Save Returns Integer
44686>>>            Integer rVal
44687>>>            Forward Get Validate_Save to rVal
44689>>>            If (Not(rval)) If (Not(Current_Record(Self))) Move 1 to rVal
44694>>>            Function_Return rVal
44695>>>        End_Procedure // Validate_Save
44696>>>        
44696>>>        
44696>>>        // AYTA ENERGOPOIOYNTAI MONO GIA KOZANH KAI APENERGOPOIOYME THN
44696>>>        // VALIDATE_SAVE APO PANO
44696>>>        // GIA NA MPORESEI NA DIAGRAPSEI 2PLO PERASMENA SOMATA
44696>>>        // APO 2PLH METAFORA AXIOGRAFON STHN ALLAGH THS XRHSHS
44696>>>        //Function Validate_Delete  Returns Integer
44696>>>        //       Integer iReturnVal
44696>>>        //       Function_Return iReturnVal
44696>>>        //End_Function //validate_delete
44696>>>        
44696>>>        //Procedure Request_Save
44696>>>        //End_Procedure
44696>>>        
44696>>>        
44696>>>        
44696>>>        
44696>>>        
44696>>>        
44696>>>        
44696>>>        //AB-StoreEnd
44696>>>
44696>>>    End_Object    // Baxio_DD
44697>>>
44697>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
44699>>>    End_Object    // Syscurxr_DD
44700>>>
44700>>>    Object Bmove_DD is a Bmove_DataDictionary
44702>>>        Set DDO_Server to (Barticl_DD(self))
44703>>>        Set DDO_Server to (Baxio_DD(self))
44704>>>        Set Constrain_File to Baxio.File_Number
44705>>>
44705>>>        //AB-StoreStart
44705>>>        set pimustnotconstrain to 2
44706>>>        Set Ordering to 4
44707>>>        
44707>>>        Function Validate_Save Returns Integer
44709>>>            Function_Return 1
44710>>>        End_Procedure // Validate_Save
44711>>>        
44711>>>        Function Validate_Delete  Returns Integer
44713>>>            Function_Return 1
44714>>>        End_Function // Validate_Delete
44715>>>        
44715>>>        
44715>>>        
44715>>>        
44715>>>        
44715>>>        
44715>>>        //AB-StoreEnd
44715>>>
44715>>>    End_Object    // Bmove_DD
44716>>>
44716>>>    Set Main_DD to (Baxio_DD(self))
44717>>>    Set Server to (Baxio_DD(self))
44718>>>
44718>>>    //AB-DDOEnd
44718>>>
44718>>>    Object Baxiokat_Baxiokat_Code is a dbFormSub
44720>>>        Entry_Item Baxiokat.Baxiokat_code
44721>>>        Set Size to 13 42
44722>>>        Set Location to 36 41
44723>>>        Set Label_Col_Offset to 35
44724>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44725>>>    End_Object    // Baxiokat_Baxiokat_Code
44726>>>
44726>>>    Object Baxiokat_Baxiokat_Descr is a dbFormSub
44728>>>        Entry_Item Baxiokat.Baxiokat_descr
44729>>>        Set Size to 13 182
44730>>>        Set Location to 36 86
44731>>>        Set Label_Col_Offset to 2
44732>>>        Set Label_Justification_Mode to jMode_Right
44733>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44734>>>    End_Object    // Baxiokat_Baxiokat_Descr
44735>>>
44735>>>    Object Baxio_Baxio_Code is a dbFormSub
44737>>>        Entry_Item Baxio.Baxio_code
44738>>>        Set Size to 13 116
44739>>>        Set Location to 50 41
44740>>>        Set Label_Col_Offset to 35
44741>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44742>>>
44742>>>        //AB-StoreStart
44742>>>                                                                                                                                                                                        
44742>>>        Procedure Prompt_Callback Integer hPrompt
44744>>>            Integer liBaxiokatCode
44745>>>            Get Field_Current_Value of Baxiokat_DD Field Baxiokat.Baxiokat_Code to liBaxiokatCode
44746>>>            Set piFragmaBaxiokatCode of hPrompt to liBaxiokatCode
44747>>>            Set Auto_Index_State of hPrompt to False
44748>>>        End_Procedure // Prompt_Callback
44749>>>        
44749>>>        
44749>>>        
44749>>>        
44749>>>        
44749>>>        
44749>>>        //AB-StoreEnd
44749>>>
44749>>>    End_Object    // Baxio_Baxio_Code
44750>>>
44750>>>    Object Baxio_Baxio_Status is a dbFormSub
44752>>>
44752>>>        //AB-StoreTopStart
44752>>>                                                                                                                                                                                        
44752>>>        Function Show_Status_Descr Returns String
44754>>>            Integer iValue iSrv iField iObj liStatusId
44755>>>            String sDesc sVal
44755>>>            If (Current_Record(Baxio_DD(Self))) Begin
44757>>>                Get Server of Baxio_Baxio_Status to iSrv
44758>>>                Get_FieldNumber Baxio.Baxio_Status to iField
44759>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Status to sVal
44760>>>                Move Baxio_Status_VT to iObj
44761>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
44764>>>                Function_Return sDesc
44765>>>            End
44765>>>>
44765>>>        End_Function // Show_Status_Descr
44766>>>        
44766>>>        //AB-StoreTopEnd
44766>>>
44766>>>        Entry_Item (Show_Status_Descr(Self))
44767>>>        Set Size to 13 116
44768>>>        Set Location to 36 340
44769>>>        Set Label_Col_Offset to 50
44770>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44771>>>
44771>>>        //AB-StoreStart
44771>>>                                                                                                                                                                                        
44771>>>                                                                                                                                                                                        
44771>>>        //AB-StoreEnd
44771>>>
44771>>>    End_Object    // Baxio_Baxio_Status
44772>>>
44772>>>    Object Baxio_Baxio_Place is a dbFormSub
44774>>>
44774>>>        //AB-StoreTopStart
44774>>>                                                                                                                                                                                        
44774>>>        Function Show_Place_Descr Returns String
44776>>>            Integer iValue iSrv iField iObj liStatusId
44777>>>            String sDesc sVal
44777>>>            If (Current_Record(Baxio_DD(Self))) Begin
44779>>>                Get Server of Baxio_Baxio_Place to iSrv
44780>>>                Get_FieldNumber Baxio.Baxio_Place to iField
44781>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Place to sVal
44782>>>                Move Baxio_Baxio_Place_VT to iObj
44783>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
44786>>>                Function_Return sDesc
44787>>>            End
44787>>>>
44787>>>        End_Function // Show_Place_Descr
44788>>>        
44788>>>        //AB-StoreTopEnd
44788>>>
44788>>>        Entry_Item (Show_Place_Descr(Self))
44789>>>        Set Size to 13 116
44790>>>        Set Location to 50 340
44791>>>        Set Label_Col_Offset to 50
44792>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44793>>>
44793>>>        //AB-StoreStart
44793>>>                                                                                                                                                                                        
44793>>>                                                                                                                                                                                        
44793>>>                                                                                                                                                                                        
44793>>>                                                                                                                                                                                        
44793>>>                                                                                                                                                                                        
44793>>>                                                                                                                                                                                        
44793>>>        //AB-StoreEnd
44793>>>
44793>>>    End_Object    // Baxio_Baxio_Place
44794>>>
44794>>>    Object dbTbDlgAxio is a dbTabDialogSub
44796>>>        Set Size to 191 507
44797>>>        Set Location to 70 2
44798>>>        Object TP_Additional is a dbTabPage
44800>>>            Set Label to "¨æ©Ÿœ«˜"
44801>>>            Object dbGrpObligate is a dbGroupSub
44803>>>                Set Label to "“§¦®¨œà« ¡á ‘«¦ ®œå˜"
44804>>>                Set Size to 60 492
44805>>>                Set Location to 3 4
44806>>>                Set TextColor to clNavy
44807>>>                Object Baxio_Baxio_Hmnial is a dbFormSub
44809>>>                    Entry_Item Baxio.Baxio_hmnial
44810>>>                    Set Size to 13 66
44811>>>                    Set Location to 10 82
44812>>>                    Set Label_Col_Offset to 70
44813>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44814>>>                End_Object    // Baxio_Baxio_Hmnial
44815>>>
44815>>>                Object Baxio_Baxio_V4 is a dbFormSub
44817>>>                    Entry_Item Baxio.Baxio_v2
44818>>>                    Set Size to 13 66
44819>>>                    Set Location to 40 82
44820>>>                    Set Label_Col_Offset to 70
44821>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44822>>>
44822>>>                    //AB-StoreStart
44822>>>                                                                                                                                                                                                                                                                                                                                                                                                                
44822>>>                    //Set Points Item 0 to 0
44822>>>                    //Set Numeric_Mask Item 0 to 14  0 ' ,*'
44822>>>                    
44822>>>                    Procedure End_Construct_Object
44824>>>                        Integer iDecimals
44825>>>                        Forward Send End_Construct_Object
44827>>>                        Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
44828>>>                        Set Points Item 0 to iDecimals
44829>>>                        Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
44830>>>                    End_Procedure
44831>>>                    
44831>>>                    
44831>>>                    //AB-StoreEnd
44831>>>
44831>>>                End_Object    // Baxio_Baxio_V4
44832>>>
44832>>>                Object Rate0 is a dbFormSub
44834>>>                    Entry_Item Baxio.Baxio_rate0
44835>>>                    Set Size to 13 46
44836>>>                    Set Location to 11 440
44837>>>                    Set Label_Col_Offset to 35
44838>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44839>>>
44839>>>                    //AB-StoreStart
44839>>>                                                                                                                                                                                                                                                                                                                                                                                                                
44839>>>                    Set Points Item 0 to 0
44840>>>                    Set Visible_State to False
44841>>>                    Set Enabled_State to False
44842>>>                    
44842>>>                    
44842>>>                    
44842>>>                    //AB-StoreEnd
44842>>>
44842>>>                End_Object    // Rate0
44843>>>
44843>>>                Object Rate00 is a dbFormSub
44845>>>                    Entry_Item Baxio.Baxio_rate00
44846>>>                    Set Size to 13 46
44847>>>                    Set Location to 26 440
44848>>>                    Set Label_Col_Offset to 35
44849>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44850>>>
44850>>>                    //AB-StoreStart
44850>>>                                                                                                                                                                                                                                                                                                                                                                                                                
44850>>>                    Set Points Item 0 to 2
44851>>>                    Set Visible_State to False
44852>>>                    Set Enabled_State to False
44853>>>                    
44853>>>                    //AB-StoreEnd
44853>>>
44853>>>                End_Object    // Rate00
44854>>>
44854>>>                Object RateR is a dbFormSub
44856>>>                    Entry_Item Baxio.Baxio_rater
44857>>>                    Set Size to 13 46
44858>>>                    Set Location to 41 440
44859>>>                    Set Label_Col_Offset to 35
44860>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44861>>>
44861>>>                    //AB-StoreStart
44861>>>                                                                                                                                                                                                                                                                                                                                                                                                                
44861>>>                    Set Points Item 0 to 2
44862>>>                    Set Visible_State to False
44863>>>                    Set Enabled_State to False
44864>>>                    
44864>>>                    
44864>>>                    //AB-StoreEnd
44864>>>
44864>>>                End_Object    // RateR
44865>>>
44865>>>                Object TextBoxSub3 is a TextBoxSub
44867>>>                    Set Label to "†£/¤å˜ Šã¥žª"
44868>>>                    Set Location to 11 18
44869>>>                    Set Size to 10 57
44870>>>                    Set TypeFace to "MS Sans Serif"
44871>>>                End_Object    // TextBoxSub3
44872>>>
44872>>>                Object TextBoxSub4 is a TextBoxSub
44874>>>                    Set Label to "Œæ£ ©£˜"
44875>>>                    Set Location to 24 18
44876>>>                    Set Size to 10 32
44877>>>                    Set TypeFace to "MS Sans Serif"
44878>>>                End_Object    // TextBoxSub4
44879>>>
44879>>>                Object TextBoxSub5 is a TextBoxSub
44881>>>                    Set Label to "¦©æ"
44882>>>                    Set Location to 39 18
44883>>>                    Set Size to 10 32
44884>>>                    Set TypeFace to "MS Sans Serif"
44885>>>                End_Object    // TextBoxSub5
44886>>>
44886>>>                Object txtnom1 is a TextBoxSub
44888>>>                    Set Label to "ˆ©¦« £å˜1"
44889>>>                    Set Location to 13 405
44890>>>                    Set Size to 10 31
44891>>>                    Set TypeFace to "MS Sans Serif"
44892>>>
44892>>>                    //AB-StoreStart
44892>>>                    Set Visible_State to False
44893>>>                    
44893>>>                    //AB-StoreEnd
44893>>>
44893>>>                End_Object    // txtnom1
44894>>>
44894>>>                Object txtnom2 is a TextBoxSub
44896>>>                    Set Label to "ˆ©¦« £å˜2"
44897>>>                    Set Location to 28 405
44898>>>                    Set Size to 10 31
44899>>>                    Set TypeFace to "MS Sans Serif"
44900>>>
44900>>>                    //AB-StoreStart
44900>>>                    Set Visible_State to False
44901>>>                    
44901>>>                    //AB-StoreEnd
44901>>>
44901>>>                End_Object    // txtnom2
44902>>>
44902>>>                Object txtnom3 is a TextBoxSub
44904>>>                    Set Label to "ˆ©¦« £å˜3"
44905>>>                    Set Location to 43 405
44906>>>                    Set Size to 10 31
44907>>>                    Set TypeFace to "MS Sans Serif"
44908>>>
44908>>>                    //AB-StoreStart
44908>>>                    Set Visible_State to False
44909>>>                    
44909>>>                    //AB-StoreEnd
44909>>>
44909>>>                End_Object    // txtnom3
44910>>>
44910>>>                Object Baxio_Baxio_C_Code2 is a dbFormSub
44912>>>
44912>>>                    //AB-StoreTopStart
44912>>>                    //Procedure Set_The_Decimal_Points
44912>>>                    //    Integer iContID
44912>>>                    //    String  sCode sPartlRecr
44912>>>                    //    date    dHmnia
44912>>>                    
44912>>>                    //    Move (dbGrpObligate(TP_Additional(dbtbDlgAxio(Self)))) to iContID
44912>>>                    
44912>>>                    //    Get Field_Current_Value Of Baxio_DD Field Baxio.Baxio_Sc_Code2 to sCode
44912>>>                    //    Move (Trim(sCode))  to sCode
44912>>>                    
44912>>>                    //    Clear Nomisma
44912>>>                    //    Move sCode to Nomisma.Nomisma_Code
44912>>>                    //    Find eq Nomisma by Index.1
44912>>>                    //    Set Points          Of (Axia(iContID)) Item  0 to Nomisma.Dekadika
44912>>>                    //    Set Numeric_Mask    Of (Axia(iContID)) Item  0 to 12 Nomisma.Dekadika "*,"
44912>>>                    
44912>>>                    //    Get Label Of (TxtNom1(iContID)) Item 0 to sCode
44912>>>                    //    Move (Trim(sCode))  to sCode
44912>>>                    //    Clear Nomisma
44912>>>                    //    Move sCode to Nomisma.Nomisma_Code
44912>>>                    //    Find eq Nomisma by Index.1
44912>>>                    //    Set Points          Of (X0(iContID)) Item  0 to Nomisma.Dekadika
44912>>>                    //    Set Points          Of (P0(iContID)) Item  0 to Nomisma.Dekadika
44912>>>                    //    Set Numeric_Mask Of (X0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
44912>>>                    //    Set Numeric_Mask Of (P0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
44912>>>                    
44912>>>                    //    Get Label Of (TxtNom2(iContID)) Item 0 to sCode
44912>>>                    //    Move (Trim(sCode))  to sCode
44912>>>                    //    Clear Nomisma
44912>>>                    //    Move sCode to Nomisma.Nomisma_Code
44912>>>                    //    Find eq Nomisma by Index.1
44912>>>                    //    Set Points          Of (X00(iContID)) Item  0 to Nomisma.Dekadika
44912>>>                    //    Set Numeric_Mask Of (X00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
44912>>>                    //    Set Points          Of (P00(iContID)) Item  0 to Nomisma.Dekadika
44912>>>                    //    Set Numeric_Mask Of (P00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
44912>>>                    
44912>>>                    //    Get Label Of (TxtNom3(iContID)) Item 0 to sCode
44912>>>                    //    Move (Trim(sCode))  to sCode
44912>>>                    //    Clear Nomisma
44912>>>                    //    Move sCode to Nomisma.Nomisma_Code
44912>>>                    //    Find eq Nomisma by Index.1
44912>>>                    //    Set Points          Of (X1(iContID)) Item  0 to     Nomisma.Dekadika
44912>>>                    //    Set Numeric_Mask Of (X1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
44912>>>                    //    Set Points          Of (P1(iContID)) Item  0 to     Nomisma.Dekadika
44912>>>                    //    Set Numeric_Mask Of (P1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
44912>>>                    //End_procedure
44912>>>                    
44912>>>                    
44912>>>                    //AB-StoreTopEnd
44912>>>
44912>>>                    Entry_Item Baxio.Baxio_c_code2
44913>>>                    Set Size to 13 66
44914>>>                    Set Location to 25 82
44915>>>                    Set Label_Col_Offset to 2
44916>>>                    Set Label_Justification_Mode to jMode_Right
44917>>>                    Set Prompt_Button_Mode to pb_PromptOff
44918>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44919>>>
44919>>>                    //AB-StoreStart
44919>>>                                                                                                                                                                                                                                                                                                                                                                                                                
44919>>>                    //Procedure OnChange
44919>>>                    //    Send Set_The_Decimal_Points
44919>>>                    //End_Procedure
44919>>>                    
44919>>>                    
44919>>>                    //AB-StoreEnd
44919>>>
44919>>>                End_Object    // Baxio_Baxio_C_Code2
44920>>>
44920>>>
44920>>>                //AB-StoreStart
44920>>>                
44920>>>                //AB-StoreEnd
44920>>>
44920>>>            End_Object    // dbGrpObligate
44921>>>
44921>>>            Object dbGrpOptional is a dbGroupSub
44923>>>                Set Label to "¨¦˜ ¨œ« ¡á ‘«¦ ®œå˜"
44924>>>                Set Size to 106 492
44925>>>                Set Location to 65 4
44926>>>                Set TextColor to clNavy
44927>>>                Object Baxio_Baxio_Ekdoths is a dbFormSub
44929>>>                    Entry_Item Baxio.Baxio_ekdoths
44930>>>                    Set Size to 13 126
44931>>>                    Set Location to 10 81
44932>>>                    Set Label_Col_Offset to 70
44933>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44934>>>                End_Object    // Baxio_Baxio_Ekdoths
44935>>>
44935>>>                Object Baxio_Baxio_Ekdothse is a dbFormSub
44937>>>                    Entry_Item Baxio.Baxio_ekdothse
44938>>>                    Set Size to 13 208
44939>>>                    Set Location to 10 264
44940>>>                    Set Label_Col_Offset to 35
44941>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44942>>>                End_Object    // Baxio_Baxio_Ekdothse
44943>>>
44943>>>                Object Baxio_Baxio_Sediatagh is a dbFormSub
44945>>>                    Entry_Item Baxio.Baxio_sediatagh
44946>>>                    Set Size to 13 126
44947>>>                    Set Location to 26 81
44948>>>                    Set Label_Col_Offset to 70
44949>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44950>>>                End_Object    // Baxio_Baxio_Sediatagh
44951>>>
44951>>>                Object Baxio_Baxio_Sdiataghe is a dbFormSub
44953>>>                    Entry_Item Baxio.Baxio_sdiataghe
44954>>>                    Set Size to 13 208
44955>>>                    Set Location to 26 264
44956>>>                    Set Label_Col_Offset to 35
44957>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44958>>>                End_Object    // Baxio_Baxio_Sdiataghe
44959>>>
44959>>>                Object Baxio_Baxio_Banka is a dbComboFormSub
44961>>>                    Entry_Item Baxio.Baxio_banka
44962>>>                    Set Size to 13 126
44963>>>                    Set Location to 40 81
44964>>>                    Set Label_Col_Offset to 70
44965>>>                End_Object    // Baxio_Baxio_Banka
44966>>>
44966>>>                Object Baxio_Baxio_No is a dbFormSub
44968>>>                    Entry_Item Baxio.Baxio_no
44969>>>                    Set Size to 13 126
44970>>>                    Set Location to 55 81
44971>>>                    Set Label_Col_Offset to 70
44972>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44973>>>                End_Object    // Baxio_Baxio_No
44974>>>
44974>>>                Object Baxio_Baxio_From is a dbComboFormSub
44976>>>                    Entry_Item Baxio.Baxio_from
44977>>>                    Set Size to 13 54
44978>>>                    Set Location to 70 81
44979>>>                    Set Label_Col_Offset to 2
44980>>>
44980>>>                    //AB-StoreStart
44980>>>                                                                                                                                                                                                                        
44980>>>                    Procedure Combo_Fill_List
44982>>>                        Send Combo_Add_Item  "ˆ›å¦¬" "0"
44983>>>                        Send Combo_Add_Item  "’¨å«¦¬" "1"
44984>>>                    End_Procedure
44985>>>                    
44985>>>                    
44985>>>                    
44985>>>                    
44985>>>                    
44985>>>                    
44985>>>                    //AB-StoreEnd
44985>>>
44985>>>                End_Object    // Baxio_Baxio_From
44986>>>
44986>>>                Object Baxio_Baxio_Topos is a dbComboFormSub
44988>>>                    Entry_Item Baxio.Baxio_topos
44989>>>                    Set Size to 13 54
44990>>>                    Set Location to 84 81
44991>>>                    Set Label_Col_Offset to 2
44992>>>
44992>>>                    //AB-StoreStart
44992>>>                    Procedure Combo_Fill_List
44994>>>                        Send Combo_Add_Item  "€«« ¡ãª" "0"
44995>>>                        Send Combo_Add_Item  "„§˜¨®å˜ª" "1"
44996>>>                    End_Procedure
44997>>>                    
44997>>>                    
44997>>>                    
44997>>>                    
44997>>>                    
44997>>>                    
44997>>>                    //AB-StoreEnd
44997>>>
44997>>>                End_Object    // Baxio_Baxio_Topos
44998>>>
44998>>>                Object Baxio_Baxio_Opistho is a dbEditSub
45000>>>                    Entry_Item Baxio.Baxio_opistho
45001>>>                    Set Size to 48 211
45002>>>                    Set Location to 50 263
45003>>>                End_Object    // Baxio_Baxio_Opistho
45004>>>
45004>>>                Object TextBoxSub6 is a TextBoxSub
45006>>>                    Set Label to "€¨® ¡æª „¡›æ«žª:"
45007>>>                    Set Location to 11 10
45008>>>                    Set Size to 10 63
45009>>>                    Set TypeFace to "MS Sans Serif"
45010>>>                End_Object    // TextBoxSub6
45011>>>
45011>>>                Object TextBoxSub7 is a TextBoxSub
45013>>>                    Set Label to "‘œ ƒ ˜«˜šã:"
45014>>>                    Set Location to 25 10
45015>>>                    Set Size to 10 56
45016>>>                    Set TypeFace to "MS Sans Serif"
45017>>>                End_Object    // TextBoxSub7
45018>>>
45018>>>                Object TextBoxSub8 is a TextBoxSub
45020>>>                    Set Label to "’¨á§œ˜"
45021>>>                    Set Location to 40 10
45022>>>                    Set Size to 10 35
45023>>>                    Set TypeFace to "MS Sans Serif"
45024>>>                End_Object    // TextBoxSub8
45025>>>
45025>>>                Object TextBoxSub9 is a TextBoxSub
45027>>>                    Set Label to "€¨ Ÿ£æª"
45028>>>                    Set Location to 55 10
45029>>>                    Set Size to 10 47
45030>>>                    Set TypeFace to "MS Sans Serif"
45031>>>                End_Object    // TextBoxSub9
45032>>>
45032>>>                Object TextBoxSub10 is a TextBoxSub
45034>>>                    Set Label to "„§à¤¬£å˜"
45035>>>                    Set Location to 12 224
45036>>>                    Set Size to 10 36
45037>>>                    Set TypeFace to "MS Sans Serif"
45038>>>                End_Object    // TextBoxSub10
45039>>>
45039>>>                Object TextBoxSub11 is a TextBoxSub
45041>>>                    Set Label to "„§à¤¬£å˜"
45042>>>                    Set Location to 28 224
45043>>>                    Set Size to 10 36
45044>>>                    Set TypeFace to "MS Sans Serif"
45045>>>                End_Object    // TextBoxSub11
45046>>>
45046>>>                Object TextBoxSub12 is a TextBoxSub
45048>>>                    Set Label to "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
45049>>>                    Set Location to 41 265
45050>>>                    Set Size to 10 79
45051>>>                    Set TypeFace to "MS Sans Serif"
45052>>>                End_Object    // TextBoxSub12
45053>>>
45053>>>                Object Textbox3 is a Textbox
45055>>>                    Set Label to "ˆ›å¦¬/’¨å«¦¬"
45056>>>                    Set Location to 71 10
45057>>>                    Set Size to 10 46
45058>>>                    Set TypeFace to "MS Sans Serif"
45059>>>                End_Object    // Textbox3
45060>>>
45060>>>                Object Textbox4 is a Textbox
45062>>>                    Set Label to "€«« ¡ãª/„§˜¨®å˜ª"
45063>>>                    Set Location to 86 10
45064>>>                    Set Size to 10 63
45065>>>                    Set TypeFace to "MS Sans Serif"
45066>>>                End_Object    // Textbox4
45067>>>
45067>>>            End_Object    // dbGrpOptional
45068>>>
45068>>>
45068>>>            //AB-StoreStart
45068>>>            set label to "‘«â¢œ®¦ª/‘é£˜ €¥ ¦š¨á­¦¬"
45069>>>            
45069>>>            //AB-StoreEnd
45069>>>
45069>>>        End_Object    // TP_Additional
45070>>>
45070>>>        Object TP_Status is a dbTabPage
45072>>>            Set Label to "‰˜«á©«˜©ž"
45073>>>            Object dbGrpEispraktea is a dbGroupSub
45075>>>                Set Label to "„ ©§¨˜¡«â˜"
45076>>>                Set Size to 44 493
45077>>>                Set Location to 4 3
45078>>>                Set TextColor to clNavy
45079>>>                Object Baxio_Baxio_Fbarticl is a dbFormSub
45081>>>
45081>>>                    //AB-StoreTopStart
45081>>>                    Procedure Find_Barticls
45083>>>                        Integer liBarticlRec0 liWhichBarticl
45084>>>                        Date ldHmnia
45084>>>                        String liNo liBtypkin
45084>>>                    
45084>>>                        Move Barticl.Barticl_Rec0 to liBarticlRec0
45085>>>                    
45085>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_In to liWhichBarticl
45086>>>                        If (liWhichBarticl <> 0) Begin
45088>>>                            Clear Barticl
45089>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
45090>>>                            Find eq Barticl by Index.2
45091>>>>
45091>>>                            [Found] Begin
45093>>>>
45093>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
45094>>>                                Move Barticl.Barticl_No      to liNo
45095>>>                                Move Barticl.Btypkin_Code    to liBtypkin
45096>>>                            End
45096>>>>
45096>>>                        End
45096>>>>
45096>>>                        Set Value of dbfrmHmnia   Item 0 to ldHmnia
45097>>>                        Set Value of dbfrmNo      Item 0 to liNo
45098>>>                        Set Value of dbfrmGtypkin Item 0 to liBtypkin
45099>>>                    
45099>>>                        Move "" to ldHmnia
45100>>>                        Move "" to liNo
45101>>>                        Move "" to liBtypkin
45102>>>                    
45102>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_Out to liWhichBarticl
45103>>>                        If (liWhichBarticl <> 0) Begin
45105>>>                            Clear Barticl
45106>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
45107>>>                            Find eq Barticl by Index.2
45108>>>>
45108>>>                            [Found] Begin
45110>>>>
45110>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
45111>>>                                Move Barticl.Barticl_No      to liNo
45112>>>                                Move Barticl.Btypkin_Code    to liBtypkin
45113>>>                            End
45113>>>>
45113>>>                        End
45113>>>>
45113>>>                        Set Value of (dbfrmHmnia(dbGrpPlhrotea(Self)))   Item 0 to ldHmnia
45114>>>                        Set Value of (dbfrmNo(dbGrpPlhrotea(Self)))      Item 0 to liNo
45115>>>                        Set Value of (dbfrmGtypkin(dbGrpPlhrotea(Self))) Item 0 to liBtypkin
45116>>>                    
45116>>>                        Move "" to ldHmnia
45117>>>                        Move "" to liNo
45118>>>                        Move "" to liBtypkin
45119>>>                    
45119>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Lpar to liWhichBarticl
45120>>>                        If (liWhichBarticl <> 0) Begin
45122>>>                            Clear Barticl
45123>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
45124>>>                            Find eq Barticl by Index.2
45125>>>>
45125>>>                            [Found] Begin
45127>>>>
45127>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
45128>>>                                Move Barticl.Barticl_No      to liNo
45129>>>                                Move Barticl.Btypkin_Code    to liBtypkin
45130>>>                            End
45130>>>>
45130>>>                        End
45130>>>>
45130>>>                        Set Value of (dbfrmHmnia(dbGrpCurrentStat(Self)))   Item 0 to ldHmnia
45131>>>                        Set Value of (dbfrmNo(dbGrpCurrentStat(Self)))      Item 0 to liNo
45132>>>                        Set Value of (dbfrmGtypkin(dbGrpCurrentStat(Self))) Item 0 to liBtypkin
45133>>>                    
45133>>>                        Clear Barticl
45134>>>                        Move liBarticlRec0 to Barticl.Barticl_Rec0
45135>>>                        Find eq Barticl by Index.2
45136>>>>
45136>>>                    End_Procedure
45137>>>                    
45137>>>                    //AB-StoreTopEnd
45137>>>
45137>>>                    Entry_Item Baxio.Baxio_fpar_in
45138>>>                    Set Size to 13 90
45139>>>                    Set Location to 10 109
45140>>>                    Set Label_Col_Offset to 90
45141>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45142>>>
45142>>>                    //AB-StoreStart
45142>>>                                                                                                                                                                                                                                                                                                                                                                                                                
45142>>>                    Procedure Refresh Integer iMode
45144>>>                        Forward Send Refresh iMode
45146>>>                        Send Find_Barticls
45147>>>                    End_Procedure // Refresh
45148>>>                    
45148>>>                    
45148>>>                    
45148>>>                    
45148>>>                    
45148>>>                    //AB-StoreEnd
45148>>>
45148>>>                End_Object    // Baxio_Baxio_Fbarticl
45149>>>
45149>>>                Object Baxio_Baxio_Code_In is a dbFormSub
45151>>>                    Entry_Item Baxio.Baxio_code_in
45152>>>                    Set Size to 13 126
45153>>>                    Set Location to 24 109
45154>>>                    Set Label_Col_Offset to 90
45155>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45156>>>                End_Object    // Baxio_Baxio_Code_In
45157>>>
45157>>>                Object Baxio_Baxio_Epon_In is a dbFormSub
45159>>>                    Entry_Item Baxio.Baxio_epon_in
45160>>>                    Set Size to 13 192
45161>>>                    Set Location to 24 283
45162>>>                    Set Color to clBtnFace
45163>>>                    Set Label_Col_Offset to 40
45164>>>                    Set Enabled_State to FALSE
45165>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45166>>>                    Set Item_Shadow_State Item 0 to TRUE
45167>>>                    Set Shadow_State Item 0 to TRUE
45168>>>                End_Object    // Baxio_Baxio_Epon_In
45169>>>
45169>>>                Object dbFrmHmnia is a dbFormSub
45171>>>                    Set Size to 13 65
45172>>>                    Set Location to 10 231
45173>>>                    Set Color to clBtnFace
45174>>>                    Set Label_Col_Offset to 2
45175>>>                    Set Label_Justification_Mode to jMode_Right
45176>>>                    Set Enabled_State to FALSE
45177>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45178>>>                    Set Item_Shadow_State Item 0 to TRUE
45179>>>                    Set Shadow_State Item 0 to TRUE
45180>>>                End_Object    // dbFrmHmnia
45181>>>
45181>>>                Object dbFrmNo is a dbFormSub
45183>>>                    Set Size to 13 65
45184>>>                    Set Location to 10 318
45185>>>                    Set Color to clBtnFace
45186>>>                    Set Label_Col_Offset to 2
45187>>>                    Set Label_Justification_Mode to jMode_Right
45188>>>                    Set Enabled_State to FALSE
45189>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45190>>>                    Set Item_Shadow_State Item 0 to TRUE
45191>>>                    Set Shadow_State Item 0 to TRUE
45192>>>                End_Object    // dbFrmNo
45193>>>
45193>>>                Object dbFrmGtypkin is a dbFormSub
45195>>>                    Set Label to "‰å¤ž©ž"
45196>>>                    Set Size to 13 57
45197>>>                    Set Location to 10 418
45198>>>                    Set Color to clBtnFace
45199>>>                    Set Label_Col_Offset to 2
45200>>>                    Set Label_Justification_Mode to jMode_Right
45201>>>                    Set Enabled_State to FALSE
45202>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45203>>>                    Set Item_Shadow_State Item 0 to TRUE
45204>>>                    Set Shadow_State Item 0 to TRUE
45205>>>                End_Object    // dbFrmGtypkin
45206>>>
45206>>>                Object TextBoxSub18 is a TextBoxSub
45208>>>                    Set Label to "˜¨/¡æ ˜¨˜¢˜™ãª:"
45209>>>                    Set Location to 12 18
45210>>>                    Set Size to 10 69
45211>>>                    Set TypeFace to "MS Sans Serif"
45212>>>                End_Object    // TextBoxSub18
45213>>>
45213>>>                Object TextBoxSub19 is a TextBoxSub
45215>>>                    Set Label to "˜¨˜¢ã­Ÿž¡œ ˜§æ:"
45216>>>                    Set Location to 25 18
45217>>>                    Set Size to 10 67
45218>>>                    Set TypeFace to "MS Sans Serif"
45219>>>                End_Object    // TextBoxSub19
45220>>>
45220>>>                Object TextBoxSub24 is a TextBoxSub
45222>>>                    Set Label to "†£-¤å˜"
45223>>>                    Set Location to 12 201
45224>>>                    Set Size to 10 26
45225>>>                    Set TypeFace to "MS Sans Serif"
45226>>>                End_Object    // TextBoxSub24
45227>>>
45227>>>                Object TextBoxSub27 is a TextBoxSub
45229>>>                    Set Label to "„§à¤¬£å˜"
45230>>>                    Set Location to 26 239
45231>>>                    Set Size to 10 39
45232>>>                    Set TypeFace to "MS Sans Serif"
45233>>>                End_Object    // TextBoxSub27
45234>>>
45234>>>                Object TextBoxSub30 is a TextBoxSub
45236>>>                    Set Label to "Œ¦:"
45237>>>                    Set Location to 11 298
45238>>>                    Set Size to 10 15
45239>>>                    Set TypeFace to "MS Sans Serif"
45240>>>                End_Object    // TextBoxSub30
45241>>>
45241>>>            End_Object    // dbGrpEispraktea
45242>>>
45242>>>            Object dbGrpPlhrotea is a dbGroupSub
45244>>>                Set Label to "„ ©§¨˜¡«â˜/¢ž¨à«â˜"
45245>>>                Set Size to 44 493
45246>>>                Set Location to 51 3
45247>>>                Set TextColor to clNavy
45248>>>                Object Baxio_Baxio_Lbarticl is a dbFormSub
45250>>>                    Entry_Item Baxio.Baxio_fpar_out
45251>>>                    Set Size to 13 90
45252>>>                    Set Location to 10 109
45253>>>                    Set Label_Col_Offset to 90
45254>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45255>>>                End_Object    // Baxio_Baxio_Lbarticl
45256>>>
45256>>>                Object Baxio_Baxio_Code_Out is a dbFormSub
45258>>>                    Entry_Item Baxio.Baxio_code_out
45259>>>                    Set Size to 13 126
45260>>>                    Set Location to 25 109
45261>>>                    Set Label_Col_Offset to 90
45262>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45263>>>                End_Object    // Baxio_Baxio_Code_Out
45264>>>
45264>>>                Object Baxio_Baxio_Epon_Out is a dbFormSub
45266>>>                    Entry_Item Baxio.Baxio_epon_out
45267>>>                    Set Size to 13 192
45268>>>                    Set Location to 25 283
45269>>>                    Set Color to clBtnFace
45270>>>                    Set Label_Col_Offset to 40
45271>>>                    Set Enabled_State to FALSE
45272>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45273>>>                    Set Item_Shadow_State Item 0 to TRUE
45274>>>                    Set Shadow_State Item 0 to TRUE
45275>>>                End_Object    // Baxio_Baxio_Epon_Out
45276>>>
45276>>>                Object dbFrmHmnia is a dbFormSub
45278>>>                    Set Size to 13 65
45279>>>                    Set Location to 10 231
45280>>>                    Set Color to clBtnFace
45281>>>                    Set Label_Col_Offset to 2
45282>>>                    Set Label_Justification_Mode to jMode_Right
45283>>>                    Set Enabled_State to FALSE
45284>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45285>>>                    Set Item_Shadow_State Item 0 to TRUE
45286>>>                    Set Shadow_State Item 0 to TRUE
45287>>>                End_Object    // dbFrmHmnia
45288>>>
45288>>>                Object dbFrmNo is a dbFormSub
45290>>>                    Set Size to 13 65
45291>>>                    Set Location to 10 318
45292>>>                    Set Color to clBtnFace
45293>>>                    Set Label_Col_Offset to 2
45294>>>                    Set Label_Justification_Mode to jMode_Right
45295>>>                    Set Enabled_State to FALSE
45296>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45297>>>                    Set Item_Shadow_State Item 0 to TRUE
45298>>>                    Set Shadow_State Item 0 to TRUE
45299>>>                End_Object    // dbFrmNo
45300>>>
45300>>>                Object dbFrmGtypkin is a dbFormSub
45302>>>                    Set Label to "‰å¤ž©ž"
45303>>>                    Set Size to 13 57
45304>>>                    Set Location to 10 418
45305>>>                    Set Color to clBtnFace
45306>>>                    Set Label_Col_Offset to 2
45307>>>                    Set Label_Justification_Mode to jMode_Right
45308>>>                    Set Enabled_State to FALSE
45309>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45310>>>                    Set Item_Shadow_State Item 0 to TRUE
45311>>>                    Set Shadow_State Item 0 to TRUE
45312>>>                End_Object    // dbFrmGtypkin
45313>>>
45313>>>                Object TextBoxSub20 is a TextBoxSub
45315>>>                    Set Label to "˜¨/¡æ ˜¨á›¦©žª:"
45316>>>                    Set Location to 10 19
45317>>>                    Set Size to 10 71
45318>>>                    Set TypeFace to "MS Sans Serif"
45319>>>                End_Object    // TextBoxSub20
45320>>>
45320>>>                Object TextBoxSub21 is a TextBoxSub
45322>>>                    Set Label to "¨é«¦ª ˜¨˜¢ã§«žª:"
45323>>>                    Set Location to 24 19
45324>>>                    Set Size to 10 78
45325>>>                    Set TypeFace to "MS Sans Serif"
45326>>>                End_Object    // TextBoxSub21
45327>>>
45327>>>                Object TextBoxSub25 is a TextBoxSub
45329>>>                    Set Label to "†£-¤å˜"
45330>>>                    Set Location to 10 201
45331>>>                    Set Size to 10 26
45332>>>                    Set TypeFace to "MS Sans Serif"
45333>>>                End_Object    // TextBoxSub25
45334>>>
45334>>>                Object TextBoxSub28 is a TextBoxSub
45336>>>                    Set Label to "„§à¤¬£å˜"
45337>>>                    Set Location to 27 237
45338>>>                    Set Size to 10 41
45339>>>                    Set TypeFace to "MS Sans Serif"
45340>>>                End_Object    // TextBoxSub28
45341>>>
45341>>>                Object TextBoxSub31 is a TextBoxSub
45343>>>                    Set Label to "Œ¦:"
45344>>>                    Set Location to 12 298
45345>>>                    Set Size to 9 15
45346>>>                    Set TypeFace to "MS Sans Serif"
45347>>>                End_Object    // TextBoxSub31
45348>>>
45348>>>            End_Object    // dbGrpPlhrotea
45349>>>
45349>>>            Object dbGrpCurrentStat is a dbGroupSub
45351>>>                Set Label to "’¨â®¦¬©˜ ‰˜«á©«˜©ž"
45352>>>                Set Size to 44 493
45353>>>                Set Location to 98 3
45354>>>                Set TextColor to clNavy
45355>>>                Object Baxio_Baxio_Lcode is a dbFormSub
45357>>>                    Entry_Item Baxio.Baxio_lcode
45358>>>                    Set Size to 13 126
45359>>>                    Set Location to 24 109
45360>>>                    Set Label_Col_Offset to 90
45361>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45362>>>                End_Object    // Baxio_Baxio_Lcode
45363>>>
45363>>>                Object Baxio_Baxio_Lepon is a dbFormSub
45365>>>                    Entry_Item Baxio.Baxio_lepon
45366>>>                    Set Size to 13 192
45367>>>                    Set Location to 24 283
45368>>>                    Set Color to clBtnFace
45369>>>                    Set Label_Col_Offset to 40
45370>>>                    Set Enabled_State to FALSE
45371>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45372>>>                    Set Item_Shadow_State Item 0 to TRUE
45373>>>                    Set Shadow_State Item 0 to TRUE
45374>>>                End_Object    // Baxio_Baxio_Lepon
45375>>>
45375>>>                Object Baxio_Baxio_Lpar is a dbFormSub
45377>>>                    Entry_Item Baxio.Baxio_lpar
45378>>>                    Set Size to 13 90
45379>>>                    Set Location to 9 109
45380>>>                    Set Label_Col_Offset to 90
45381>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45382>>>                End_Object    // Baxio_Baxio_Lpar
45383>>>
45383>>>                Object dbFrmHmnia is a dbFormSub
45385>>>                    Set Size to 13 65
45386>>>                    Set Location to 10 231
45387>>>                    Set Color to clBtnFace
45388>>>                    Set Label_Col_Offset to 2
45389>>>                    Set Label_Justification_Mode to jMode_Right
45390>>>                    Set Enabled_State to FALSE
45391>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45392>>>                    Set Item_Shadow_State Item 0 to TRUE
45393>>>                    Set Shadow_State Item 0 to TRUE
45394>>>                End_Object    // dbFrmHmnia
45395>>>
45395>>>                Object dbFrmNo is a dbFormSub
45397>>>                    Set Size to 13 65
45398>>>                    Set Location to 10 318
45399>>>                    Set Color to clBtnFace
45400>>>                    Set Label_Col_Offset to 2
45401>>>                    Set Label_Justification_Mode to jMode_Right
45402>>>                    Set Enabled_State to FALSE
45403>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45404>>>                    Set Item_Shadow_State Item 0 to TRUE
45405>>>                    Set Shadow_State Item 0 to TRUE
45406>>>                End_Object    // dbFrmNo
45407>>>
45407>>>                Object dbFrmGtypkin is a dbFormSub
45409>>>                    Set Label to "‰å¤ž©ž"
45410>>>                    Set Size to 13 57
45411>>>                    Set Location to 10 418
45412>>>                    Set Color to clBtnFace
45413>>>                    Set Label_Col_Offset to 2
45414>>>                    Set Label_Justification_Mode to jMode_Right
45415>>>                    Set Enabled_State to FALSE
45416>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45417>>>                    Set Item_Shadow_State Item 0 to TRUE
45418>>>                    Set Shadow_State Item 0 to TRUE
45419>>>                End_Object    // dbFrmGtypkin
45420>>>
45420>>>                Object TextBoxSub22 is a TextBoxSub
45422>>>                    Set Label to "’œ¢œ¬«˜å¦ ˜¨/¡æ:"
45423>>>                    Set Location to 11 13
45424>>>                    Set Size to 10 68
45425>>>                    Set TypeFace to "MS Sans Serif"
45426>>>                End_Object    // TextBoxSub22
45427>>>
45427>>>                Object TextBoxSub23 is a TextBoxSub
45429>>>                    Set Label to "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª:"
45430>>>                    Set Location to 24 13
45431>>>                    Set Size to 10 90
45432>>>                    Set TypeFace to "MS Sans Serif"
45433>>>                End_Object    // TextBoxSub23
45434>>>
45434>>>                Object TextBoxSub26 is a TextBoxSub
45436>>>                    Set Label to "†£-¤å˜"
45437>>>                    Set Location to 11 200
45438>>>                    Set Size to 10 27
45439>>>                    Set TypeFace to "MS Sans Serif"
45440>>>                End_Object    // TextBoxSub26
45441>>>
45441>>>                Object TextBoxSub29 is a TextBoxSub
45443>>>                    Set Label to "„§à¤¬£å˜"
45444>>>                    Set Location to 26 239
45445>>>                    Set Size to 10 40
45446>>>                    Set TypeFace to "MS Sans Serif"
45447>>>                End_Object    // TextBoxSub29
45448>>>
45448>>>                Object TextBoxSub32 is a TextBoxSub
45450>>>                    Set Label to "Œ¦:"
45451>>>                    Set Location to 11 297
45452>>>                    Set Size to 10 15
45453>>>                    Set TypeFace to "MS Sans Serif"
45454>>>                End_Object    // TextBoxSub32
45455>>>
45455>>>            End_Object    // dbGrpCurrentStat
45456>>>
45456>>>
45456>>>            //AB-StoreStart
45456>>>            set label to "Š¦ §á ‘«¦ ®œå˜"
45457>>>            
45457>>>            //AB-StoreEnd
45457>>>
45457>>>        End_Object    // TP_Status
45458>>>
45458>>>        Object TP_Bmove is a dbTabPage
45460>>>            Set Label to "‰å¤ž©ž"
45461>>>            Object grdBmove is a dbGridSub
45463>>>                Set Main_File to Bmove.File_Number
45464>>>                Set Server to (Bmove_DD(self))
45465>>>                Set Ordering to 4
45466>>>                Set Size to 159 489
45467>>>                Set Location to 7 5
45468>>>                Set Wrap_State to TRUE
45469>>>                Set Read_Only_State to TRUE
45470>>>
45470>>>                Begin_Row
45473>>>                    Entry_Item Btypkin.Btypkin_code
45474>>>                    Entry_Item Btypkin.Btypkin_descr
45475>>>                    Entry_Item Barticl.Barticl_hmnia
45476>>>                    Entry_Item Barticl.Barticl_no
45477>>>                    Entry_Item Barticl.Barticl_code1
45478>>>                    Entry_Item Barticl.Barticl_code2
45479>>>                End_Row
45484>>>
45484>>>                Set Form_Width    item 0 to 38
45485>>>                Set Header_Label  item 0 to "‰å¤ž©ž"
45486>>>                
45486>>>                Set Form_Width    item 1 to 197
45487>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45488>>>                
45488>>>                Set Form_Width    item 2 to 45
45489>>>                Set Header_Label  item 2 to "†£-¤å˜"
45490>>>                
45490>>>                Set Form_Width    item 3 to 45
45491>>>                Set Header_Label  item 3 to "€¨ Ÿ£æª"
45492>>>                
45492>>>                Set Form_Width    item 4 to 82
45493>>>                Set Header_Label  item 4 to "‘¬¤˜¢¢˜©©æ£œ¤¦ª"
45494>>>                
45494>>>                Set Form_Width    item 5 to 76
45495>>>                Set Header_Label  item 5 to "˜¨˜¢ã§«žª"
45496>>>                
45496>>>
45496>>>                //AB-StoreStart
45496>>>                
45496>>>                Procedure Set Col_Entry_State Integer iItem Integer iState
45498>>>                    Integer liPrototype
45499>>>                    Get Prototype_Object to liPrototype
45500>>>                    Set Entry_State of liPrototype Item iItem to iState
45501>>>                End_Procedure // Col_Entry_State
45502>>>                
45502>>>                Set Col_Entry_State to 0 False
45503>>>                Set Col_Entry_State to 1 False
45504>>>                Set Col_Entry_State to 2 False
45505>>>                Set Col_Entry_State to 3 False
45506>>>                Set Col_Entry_State to 4 False
45507>>>                Set Col_Entry_State to 5 False
45508>>>                
45508>>>                Procedure Mouse_Up Integer aiWindow Integer iChar_Pos
45510>>>                End_Procedure // Mouse_Up
45511>>>                
45511>>>                
45511>>>                Procedure Request_Clear_All
45513>>>                End_Procedure // Request_Clear_All
45514>>>                
45514>>>                
45514>>>                //AB-StoreEnd
45514>>>
45514>>>            End_Object    // grdBmove
45515>>>
45515>>>
45515>>>            //AB-StoreStart
45515>>>            set label to "‰ ¤ã©œ ª    "
45516>>>            //AB-StoreEnd
45516>>>
45516>>>        End_Object    // TP_Bmove
45517>>>
45517>>>    End_Object    // dbTbDlgAxio
45518>>>
45518>>>    Object dbGrpYear is a dbGroupSub
45520>>>        Set Size to 26 505
45521>>>        Set Location to 2 3
45522>>>        Object Company_Company_Name is a dbFormSub
45524>>>            Entry_Item Syscurxr.Company_name
45525>>>            Set Server to (Syscurxr_DD(self))
45526>>>            Set Size to 13 139
45527>>>            Set Location to 9 47
45528>>>            Set Color to clBtnFace
45529>>>            Set Label_Col_Offset to 2
45530>>>            Set Label_Justification_Mode to jMode_Right
45531>>>            Set Enabled_State to FALSE
45532>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45533>>>            Set Item_Shadow_State Item 0 to TRUE
45534>>>            Set Shadow_State Item 0 to TRUE
45535>>>        End_Object    // Company_Company_Name
45536>>>
45536>>>        Object Branch_Branch_Name is a dbFormSub
45538>>>            Entry_Item Syscurxr.Branch_name
45539>>>            Set Server to (Syscurxr_DD(self))
45540>>>            Set Size to 13 141
45541>>>            Set Location to 9 241
45542>>>            Set Color to clBtnFace
45543>>>            Set Label_Col_Offset to 2
45544>>>            Set Label_Justification_Mode to jMode_Right
45545>>>            Set Enabled_State to FALSE
45546>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45547>>>            Set Item_Shadow_State Item 0 to TRUE
45548>>>            Set Shadow_State Item 0 to TRUE
45549>>>        End_Object    // Branch_Branch_Name
45550>>>
45550>>>        Object Year_Year_Year is a dbFormSub
45552>>>            Entry_Item Syscurxr.Year_year
45553>>>            Set Server to (Syscurxr_DD(self))
45554>>>            Set Size to 13 61
45555>>>            Set Location to 9 440
45556>>>            Set Color to clBtnFace
45557>>>            Set Label_Col_Offset to 2
45558>>>            Set Label_Justification_Mode to jMode_Right
45559>>>            Set Enabled_State to FALSE
45560>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45561>>>            Set Item_Shadow_State Item 0 to TRUE
45562>>>            Set Shadow_State Item 0 to TRUE
45563>>>
45563>>>            //AB-StoreStart
45563>>>                                                                                                                                                                                                                                                                
45563>>>                                                                                                                                                                                                                                                                
45563>>>                                                                                                                                                                                                                                                                
45563>>>            //AB-StoreEnd
45563>>>
45563>>>        End_Object    // Year_Year_Year
45564>>>
45564>>>        Object otxtCompany is a TextBoxSub
45566>>>            Set Label to "„«˜ ¨œå˜"
45567>>>            Set Auto_Size_State to FALSE
45568>>>            Set TextColor to clNavy
45569>>>            Set FontSize to 4 0
45570>>>            Set Location to 10 8
45571>>>            Set Size to 10 31
45572>>>            Set FontWeight to 800
45573>>>            Set Justification_Mode to jMode_Right
45574>>>            Set TypeFace to "MS Sans Serif"
45575>>>            Set Enabled_State to TRUE
45576>>>        End_Object    // otxtCompany
45577>>>
45577>>>        Object otxtBranch is a TextBoxSub
45579>>>            Set Label to "“§¦¡/£˜ :"
45580>>>            Set Auto_Size_State to FALSE
45581>>>            Set TextColor to clNavy
45582>>>            Set FontSize to 4 0
45583>>>            Set Location to 10 200
45584>>>            Set Size to 10 31
45585>>>            Set FontWeight to 800
45586>>>            Set Justification_Mode to jMode_Right
45587>>>            Set TypeFace to "MS Sans Serif"
45588>>>            Set Enabled_State to TRUE
45589>>>        End_Object    // otxtBranch
45590>>>
45590>>>        Object otxtYear is a TextBoxSub
45592>>>            Set Label to "•¨ã©ž :          "
45593>>>            Set Auto_Size_State to FALSE
45594>>>            Set TextColor to clNavy
45595>>>            Set FontSize to 4 0
45596>>>            Set Location to 10 408
45597>>>            Set Size to 10 24
45598>>>            Set FontWeight to 800
45599>>>            Set Justification_Mode to jMode_Right
45600>>>            Set TypeFace to "MS Sans Serif"
45601>>>            Set Enabled_State to TRUE
45602>>>        End_Object    // otxtYear
45603>>>
45603>>>    End_Object    // dbGrpYear
45604>>>
45604>>>    Object TextBoxSub1 is a TextBoxSub
45606>>>        Set Label to "„å›¦ª"
45607>>>        Set Location to 36 5
45608>>>        Set Size to 10 35
45609>>>        Set TypeFace to "MS Sans Serif"
45610>>>    End_Object    // TextBoxSub1
45611>>>
45611>>>    Object TextBoxSub2 is a TextBoxSub
45613>>>        Set Label to "‰à› ¡æª"
45614>>>        Set Location to 49 5
45615>>>        Set Size to 10 33
45616>>>        Set TypeFace to "MS Sans Serif"
45617>>>    End_Object    // TextBoxSub2
45618>>>
45618>>>    Object TextBoxSub13 is a TextBoxSub
45620>>>        Set Label to "‰˜«á©«˜©ž"
45621>>>        Set Location to 37 285
45622>>>        Set Size to 10 51
45623>>>        Set TypeFace to "MS Sans Serif"
45624>>>    End_Object    // TextBoxSub13
45625>>>
45625>>>    Object TextBoxSub14 is a TextBoxSub
45627>>>        Set Label to "¨å©¡œ«˜ "
45628>>>        Set Location to 49 285
45629>>>        Set Size to 12 39
45630>>>        Set TypeFace to "MS Sans Serif"
45631>>>    End_Object    // TextBoxSub14
45632>>>
45632>>>
45632>>>    //AB-StoreStart
45632>>>                                    
45632>>>                                    
45632>>>    //AB-StoreEnd
45632>>>
45632>>>End_Object    // VW037
45633>>>
45633>>>//AB/ End_Object    // prj
INCLUDING FILE: FEM.PKG
45633>>///////////////////////////////////////////////
45633>>// Ginetai #Include sto Program //
45633>>///////////////////////////////////////////////
45633>>Use Idiotht.pkg
45633>>
45633>>Integer igC
45633>>String  sgC sgFull sgRootDir sgDevicePath
45633>>Move 0 to igC
45634>>
45634>>Move (fsReadRegistryFEMRootDir   ()) To sgRootDir
45635>>Move (fsReadRegistryFEMDevicePath()) To sgDevicePath
45636>>
45636>>// An den yparxoun ta settings sto registry (apo Setup Egkatastashs)
45636>>// Tote ta ftiaxnoume me ex orismou C:\FEM_ROOT\ & C:\FEM_ROOT\Device_File1.dat
45636>>// mesa apo tis 2 parakato functions (sto Idiotht.pkg)
45636>>If (Trim(sgRootDir)   ='') Get fiWriteRegistryFEMRootDir    to iGC
45639>>If (Trim(sgDevicePath)='') Get fiWriteRegistryFEMDevicePath to iGC
45642>>//
45642>>
45642>>// ** START ** Function ths forologikhs ektypotikhs mhxanhs
45642>>External_Function32 FSL_Command "FSL_Command" rapidsign.dll;                    String  sBaseDir    ;                    String  sCommand    ;                    String  sDevFile    ;                    String  sParam1     ;                    String  sParam2     ;                    Returns Integer
45643>>
45643>>External_Function32 FSL_SignDocument "FSL_SignDocument" rapidsign.dll;                    String  sDevFile    ;                    String  sParam      ;                    String  sResult     ;                    Returns Integer
45644>>// ** END ** Function ths forologikhs ektypotikhs mhxanhs
45644>>
45644>>
45644>>// ** START ** Gemisma global string me escape xarakthron gia afairesh tous apo to ascii ths forologikhs
45644>>Move '' to sgC
45645>>For igC From 1 to 254
45651>>>
45651>>    If ((igC<32) Or ((igC>175) And (igC<224)) Or (igC>240)) Begin
45653>>        Move (Append(sgC,Character(igC))) to sgC
45654>>    End
45654>>>
45654>>Loop
45655>>>
45655>>// ** END ** Gemisma escape xarakthron gia afairesh tous apo to ascii ths forologikhs
45655>>
45655>>
45655>>Function fiEtoimaseTaAscii Returns Integer
45657>>    Integer iFileExist iii iii2 isOK
45658>>    String  sLine sLine2 sLetter sLetter2
45658>>    // 1. Check if file was outputed (C:\##Parast.txt)
45658>>    Get Get_File_Exists 'C:\##Parast.txt' to iFileExist
45659>>    If (Not(iFileExist)) Function_Return 12556
45662>>
45662>>    // 2. Check if file is outputed but empty
45662>>    Direct_Input Channel 7 "C:\##Parast.txt"
45664>>    If (Seqeof) Begin
45666>>        Close_Input Channel 7
45668>>        Function_Return 12557
45669>>    End
45669>>>
45669>>
45669>>    // 3. Strip file from escape sequences
45669>>    Direct_Output Channel 9 "C:\##Parast0.txt"
45671>>    Repeat
45671>>>
45671>>        Readln Channel 7 sLine
45673>>        For iii From 1 to (Length(sgC))
45679>>>
45679>>            Move (Replaces((Mid(sgC,1,iii)),sLine,' ')) to sLine
45680>>        Loop
45681>>>
45681>>        Writeln Channel 9 sLine
45684>>    Until (Seqeof)
45686>>    Close_Input Channel 7
45688>>    Close_Output Channel 9
45690>>
45690>>    // 4. Check if new ascii without escape
45690>>    //    sequences is outputed (C:\##Parast0.txt)
45690>>    Get Get_File_Exists 'C:\##Parast0.txt' to iFileExist
45691>>    If (Not(iFileExist)) Function_Return 12558
45694>>
45694>>    // 5. Check if new file is outputed but empty
45694>>    Direct_Input Channel 7 "C:\##Parast0.txt"
45696>>    If (Seqeof) Begin
45698>>        Close_Input Channel 7
45700>>        Function_Return 12559
45701>>    End
45701>>>
45701>>
45701>>    // 6. Convert file to ELOT
45701>>    Direct_Output Channel 9 "C:\##Parast1.txt"
45703>>    Repeat
45703>>>
45703>>        Readln Channel 7        sLine
45705>>        Move (ToAnsi(sLine)) to sLine2
45706>>        Writeln Channel 9       sLine2
45709>>    Until (Seqeof)
45711>>    Close_Input  Channel 7
45713>>    Close_Output Channel 9
45715>>
45715>>    // 7. Check if converted ELOT ascii is outputed (C:\##Parast1.txt)
45715>>    Get Get_File_Exists 'C:\##Parast1.txt' to iFileExist
45716>>    If (Not(iFileExist)) Function_Return 12560
45719>>
45719>>    // 8. Check if converted ELOT ascii is NOT Empty
45719>>    Direct_Input Channel 7 "C:\##Parast1.txt"
45721>>    If (Seqeof) Begin
45723>>        Close_Output Channel 7
45725>>        Function_Return 12561
45726>>    End
45726>>>
45726>>    Close_Output Channel 7
45728>>
45728>>    Function_Return 1 // Everything OK
45729>>End_function
45730>>
45730>>Function fiPareYpografh Returns String
45732>>    Integer iFileExist iii iii2 isOK
45733>>    String  sLine sLine2 sLetter sLetter2
45733>>    Move 0 to isOK
45734>>
45734>>    Move (FSL_Command(sgRootDir,'SIGN',sgDevicePath ,'C:\##Parast1.txt','C:\##Signature.txt')) to isOK
45735>>    If (isOK<>0) Function_Return ''
45738>>
45738>>    Direct_Input Channel 7 'C:\##Signature.txt'
45740>>    If (Seqeof) Function_Return '12562'
45743>>    Readln Channel 7 sLine
45745>>    Move (Trim(sLine)) to sLine
45746>>    If (Length(sLine)<>77) Function_Return '12563'
45749>>
45749>>    EraseFile "C:\##Parast*.txt"
45750>>>
45750>>    EraseFile "C:\##Signature.txt"
45751>>>
45751>>
45751>>    Function_return (Trim(sLine))
45752>>End_function
45753>>
45753>>Function fiVgaleZ Returns Integer
45755>>    Integer isOK
45756>>    Move 0 to isOK
45757>>    Move (FSL_Command(sgRootDir,'Z',sgDevicePath ,'','')) to isOK
45758>>    Function_return isOK
45759>>    // 0= ok
45759>>End_function
45760>>
45760>>Function fiShowCTL Returns Integer
45762>>    Integer isOK
45763>>    Move 0 to isOK
45764>>    Move (FSL_Command(sgRootDir,'CTL',sgDevicePath ,'','')) to isOK
45765>>    Function_return isOK
45766>>    // 0= ok
45766>>End_function
45767>>
45767>>Use RptVwFem.Sub
INCLUDING FILE: RPTVWFEM.SUB
45767>>>>Use DFRptvw.pkg
45767>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
45767>>>>>>
45767>>>>>>Use Windows
45767>>>>>>Use DfPanel
45767>>>>>>Use EnClient
45767>>>>>>Use DFNav_mx
45767>>>>>>Use dfConfrm
45767>>>>>>Use dfRptVw
45767>>>>>>Use DFGSINI
45767>>>>>>
45767>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
45768>>>>>>    Import_Class_Protocol Entry_Client
45769>>>>>>    //  Defeat the activating augmentation for auto-locate
45769>>>>>>    Procedure Activating Returns Integer
45770>>>>>>      local integer RVal
45771>>>>>>      forward get MSG_activating to rVal
45773>>>>>>      Procedure_Return rVal
45774>>>>>>    End_Procedure
45775>>>>>>End_Class // dbReportAppClient_
45776>>>>>>
45776>>>>>>Class dbReportAppView_ is a dbReportAppClient_
45777>>>>>>  import_Class_protocol entry_view_Client
45778>>>>>>End_Class // dbReportAppView_
45779>>>>>>
45779>>>>>>
45779>>>>>>Class dbReportView is a dbReportAppView_
45780>>>>>>
45780>>>>>>     Procedure Construct_Object
45781>>>>>>      Forward Send Construct_Object No_Image
45783>>>>>>      Send Define_DFNavigation  // GUI navigate changes
45784>>>>>>      // dialog views get activated as popup objects.
45784>>>>>>      set Dso_Detach_Mode to Detach_Always
45785>>>>>>
45785>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
45786>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
45787>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
45788>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
45789>>>>>>      //
45789>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
45789>>>>>>      // is out of the question...
45789>>>>>>      Set Minimize_Icon To False
45790>>>>>>      Set Maximize_Icon To False
45791>>>>>>   End_Procedure // Construct_Object
45792>>>>>>
45792>>>>>>   Procedure Request_Delete
45793>>>>>>   End_Procedure // request_delete
45794>>>>>>
45794>>>>>>   Procedure Request_Save
45795>>>>>>   End_Procedure // request_save
45796>>>>>>
45796>>>>>>   Function Exit_Application_Check Returns Integer
45797>>>>>>     Function_return 0
45798>>>>>>   End_Function
45799>>>>>>
45799>>>>>>   Import_Class_Protocol DFNavigate_Mixin
45800>>>>>>
45800>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
45800>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
45800>>>>>>  //  send a DEO message. DEO clients set this true
45800>>>>>>  Function DEO_Object Returns integer
45801>>>>>>    Function_Return 1
45802>>>>>>  End_Function // DEO_Object
45803>>>>>>
45803>>>>>>  //
45803>>>>>>  //  Activate message for views that:
45803>>>>>>  //  1. restores the view if it is minimized
45803>>>>>>  //  2. Maintains the current scope's focus.
45803>>>>>>  //
45803>>>>>>  Procedure Activate_current_scope
45804>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
45807>>>>>>    Set Current_Scope to Current_Object
45808>>>>>>  End_Procedure // Activate_current_scope
45809>>>>>>
45809>>>>>>  //  Pass full object name - return the relative name
45809>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
45809>>>>>>  Function Local_Object_name string nm returns string
45810>>>>>>     local integer ps
45811>>>>>>     Repeat
45811>>>>>>>
45811>>>>>>       pos "." in nm to ps
45813>>>>>>>
45813>>>>>>       If ps eq 0 function_return nm
45816>>>>>>       increment ps
45817>>>>>>       Mid Nm to Nm 255 ps
45820>>>>>>>
45820>>>>>>     Loop
45821>>>>>>>
45821>>>>>>  end_function
45822>>>>>>
45822>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
45822>>>>>>  Function Parse_Complex string sVal returns integer
45823>>>>>>     Local integer ps
45824>>>>>>     Pos "," in sVal to ps
45826>>>>>>>
45826>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
45829>>>>>>  End_Function // Parse_Complex
45830>>>>>>
45830>>>>>>  // Convert a complex integer to a string "hi,Low"
45830>>>>>>  //
45830>>>>>>  Function Complex_to_String integer i1 returns string
45831>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
45832>>>>>>  End_function
45833>>>>>>
45833>>>>>>
45833>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
45833>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
45833>>>>>>  // sense to clutter up the registry with this kind of nonsense.
45833>>>>>>  ////
45833>>>>>>  ////  Save View information to dfwin.ini file. Save as:
45833>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
45833>>>>>>  ////     Leaving room for growth here.
45833>>>>>>  ////
45833>>>>>>  Procedure Save_Environment
45834>>>>>>  //   Local String nm Vn st
45834>>>>>>  //   Local Integer H
45834>>>>>>  //
45834>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
45834>>>>>>  //   Move (Uppercase(trim(st))) to st
45834>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
45834>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
45834>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
45834>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
45834>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
45834>>>>>>  //     // button).
45834>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
45834>>>>>>  //
45834>>>>>>  //       Get Name to Vn // full name of object
45834>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
45834>>>>>>  //       Get GUILocation to H             // complex location
45834>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
45834>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
45834>>>>>>  //     End
45834>>>>>>  //   End
45834>>>>>>  //
45834>>>>>>  End_Procedure
45835>>>>>>  //
45835>>>>>>  //// Augment to check for view string in .INI. Currently, if found
45835>>>>>>  //// set the location
45835>>>>>>  ////
45835>>>>>>  Procedure Load_Environment
45836>>>>>>  //   Local String nm Vn Lc
45836>>>>>>  //   Local Integer H ps
45836>>>>>>  //   // see above for reasoning on this
45836>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
45836>>>>>>  //     Get Name to Vn
45836>>>>>>  //     Get Local_Object_Name Vn to Vn
45836>>>>>>  //     Get System_Profile_String Vn to Nm
45836>>>>>>  //     IF Nm ne '' Begin
45836>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
45836>>>>>>  //        If Ps Begin
45836>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
45836>>>>>>  //           Pos " " in Lc to ps
45836>>>>>>  //           if Ps left lc to lc (ps-1)
45836>>>>>>  //           Get Parse_Complex lc to H
45836>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
45836>>>>>>  //           Send Adjust_Logicals
45836>>>>>>  //        End
45836>>>>>>  //     End
45836>>>>>>  //   End
45836>>>>>>  End_Procedure
45837>>>>>>
45837>>>>>>  Function View_Changed returns Integer
45838>>>>>>     Local Integer Changed
45839>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
45841>>>>>>     Function_Return Changed
45842>>>>>>  End_Function
45843>>>>>>
45843>>>>>>  Procedure Notify_Exit_Application
45844>>>>>>    Send Save_Environment
45845>>>>>>  End_procedure
45846>>>>>>
45846>>>>>>  Procedure End_Construct_Object
45847>>>>>>     Send Load_Environment
45848>>>>>>     //Send Define_SysMenu
45848>>>>>>     Forward Send End_Construct_Object
45850>>>>>>  End_Procedure // End_Construct_Object
45851>>>>>>
45851>>>>>>  Procedure Close_Client
45852>>>>>>     Send Exit_Function
45853>>>>>>  End_Procedure
45854>>>>>>
45854>>>>>>  Procedure Entering_Scope returns Integer
45855>>>>>>     Local Integer rVal
45856>>>>>>     Forward Get MSG_Entering_Scope to rVal
45858>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
45861>>>>>>  End_Procedure
45862>>>>>>
45862>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
45863>>>>>>     Local Integer rVal
45864>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
45866>>>>>>     If not rVal Send Show_View_Name ''
45869>>>>>>  End_Procedure
45870>>>>>>
45870>>>>>>  Procedure Show_view_Name string sHelp
45871>>>>>>     Local Integer rVal Id
45872>>>>>>     Get Statusbar_id to id
45873>>>>>>     If Id Send Show_View_Name to Id sHelp
45876>>>>>>  End_Procedure
45877>>>>>>
45877>>>>>>  Function Should_Save_Recursive returns integer
45878>>>>>>    Function_return (View_Changed(Current_Object))
45879>>>>>>  End_Function
45880>>>>>>
45880>>>>>>End_Class // dbReportView
45881>>>>
45881>>>>Use RptVW.Sub
INCLUDING FILE: RPTVW.SUB
45881>>>>>>Use DFRptvw.pkg
45881>>>>>>Use dbRptvw.pkg
45881>>>>>>
45881>>>>>>Class ReportViewSub is a ReportView
45882>>>>>>
45882>>>>>>    Procedure Construct_Object
45883>>>>>>        Forward Send Construct_Object
45885>>>>>>        Property Integer Server 0
45886>>>>>>    End_Procedure // Construct_Object
45887>>>>>>
45887>>>>>>    Procedure Page Integer PageMode
45888>>>>>>        Integer hWnd
45889>>>>>>        Forward Send Page PageMode
45891>>>>>>        Get Window_Handle to hWnd
45892>>>>>>        If (hWnd) Begin
45894>>>>>>            Send GreekSysMenu
45895>>>>>>        End
45895>>>>>>>
45895>>>>>>    End_Procedure
45896>>>>>>
45896>>>>>>    Procedure Close_Panel
45897>>>>>>        Local Integer liScope
45898>>>>>>        Move (Prior_Scope(Desktop)) To liScope
45899>>>>>>        Move (Scope_Focus(liScope)) To liScope
45900>>>>>>        Forward Send Close_Panel
45902>>>>>>        Send Activate To liScope
45903>>>>>>    End_Procedure // Close_Panel
45904>>>>>>
45904>>>>>>End_Class
45905>>>>>>
45905>>>>>>Class dbReportViewSub is a dbReportView
45906>>>>>>
45906>>>>>>    Procedure Construct_Object
45907>>>>>>        Forward Send Construct_Object
45909>>>>>>        Property Integer Server 0
45910>>>>>>    End_Procedure // Construct_Object
45911>>>>>>
45911>>>>>>    Procedure Page Integer PageMode
45912>>>>>>        Integer hWnd
45913>>>>>>        Forward Send Page PageMode
45915>>>>>>        Get Window_Handle to hWnd
45916>>>>>>        If (hWnd) Begin
45918>>>>>>            Send GreekSysMenu
45919>>>>>>        End
45919>>>>>>>
45919>>>>>>    End_Procedure
45920>>>>>>
45920>>>>>>    Procedure Close_Panel
45921>>>>>>        Local Integer liScope
45922>>>>>>        Move (Prior_Scope(Desktop)) To liScope
45923>>>>>>        Move (Scope_Focus(liScope)) To liScope
45924>>>>>>        Forward Send Close_Panel
45926>>>>>>        Send Activate To liScope
45927>>>>>>    End_Procedure // Close_Panel
45928>>>>>>End_Class
45929>>>>>>
45929>>>>
45929>>>>Class ReportViewFEMSub is a ReportViewSub    
45930>>>>
45930>>>>    Procedure Construct_Object
45931>>>>        Forward Send Construct_Object
45933>>>>
45933>>>>        Property Integer    piIsReportCancelled     Public  0
45934>>>>        Property Integer    piAsciiOrPrinter        Public  0
45935>>>>    
45935>>>>    End_Procedure
45936>>>>    
45936>>>>
45936>>>>// ‡˜ â§¨œ§œ ž procedure ˜¬«ž
45936>>>>//
45936>>>>//    Procedure StartReport
45936>>>>//        send Gemise_Escape_Characters
45936>>>>//        String Whme_APO sRecr
45936>>>>//        integer wnees wclose
45936>>>>//        Local Integer iOutputDevice
45936>>>>//        Local String  FileName
45936>>>>//        local integer inew_state
45936>>>>//        Get Output_Device_Mode To iOutputDevice
45936>>>>//        get new_state to inew_state
45936>>>>//        set piprinter to 0
45936>>>>//        //?????????????????????????????????????????????
45936>>>>//        Get Output_Device_Mode To iOutputDevice
45936>>>>
45936>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
45936>>>>//            Set piAsciiOrPrinter    to 0
45936>>>>//            Make_Temp_File "TXT" FileName
45936>>>>//            Move (".\" - FileName)  To FileName
45936>>>>//            Set Output_Device_Name  To FileName
45936>>>>//        End
45936>>>>//        Else Begin
45936>>>>
45936>>>>//            If (Sysfile.Use_Sql_Reports='1') Begin
45936>>>>//                If (piAsciiOrPrinter(Self)=0) Error 7000 'ƒœ¤ ©œ«á¨˜«œ «¦ piAsciiOrPrinter\n(ƒœ¤ §¨¦©› ¦¨å©«ž¡œ ˜¤ ˜­¦¨á ASCII ã „¡«¬§à«ã)'
45936>>>>//            End
45936>>>>
45936>>>>//            Get psRecr Of TIMOLOGIO_BasicReport to sRecr
45936>>>>//            Move (Trim(sRecr)) to sRecr
45936>>>>
45936>>>>//            If (sRecr='') Error 7003 'ƒœ¤ ¬§á¨®œ  Recr š ˜ «¦ §˜¨˜©«˜« ¡æ'
45936>>>>
45936>>>>//            Clear Particle
45936>>>>//            Move sRecr to Particle.Partl_Recr
45936>>>>//            Find Eq Particle by index.2
45936>>>>//            If (Not(Found)) Error 7001 'ƒœ¤ ™¨âŸž¡œ «¦ §˜¨˜©«˜« ¡æ'
45936>>>>
45936>>>>//            Clear Pseira
45936>>>>//            Move SyscurXr.Company_Code  to Pseira.Company_Code
45936>>>>//            Move SyscurXr.Branch_Code   to Pseira.Branch_Code
45936>>>>//            Move Particle.Ptyppar_Code  to Pseira.Ptyppar_Code
45936>>>>//            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
45936>>>>//            Find Eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+Ptyppar_Code+Pseira_Seira
45936>>>>//            If (Not(Found)) Error 7002 'ƒœ¤ ™¨âŸž¡œ ž ©œ ¨á'
45936>>>>
45936>>>>//            If (piAsciiOrPrinter(Self)=1) Begin
45936>>>>//                // 1= Output ©œ Ascii
45936>>>>//                Set Output_Device_Name  To 'C:\##Parast.txt'
45936>>>>//            End
45936>>>>//            Else If (piAsciiOrPrinter(Self)=2) Begin
45936>>>>//                // 2= Output ©œ Printer
45936>>>>//                Set Output_Device_Name  To Pseira.Pseira_Printer
45936>>>>//            End
45936>>>>//            Else Error 7004 '’¦ Flag piAsciiOrPrinter ›œ¤ œå¤˜  ©à©«æ'
45936>>>>//        End
45936>>>>
45936>>>>//        Send Run_Report  //record
45936>>>>
45936>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
45936>>>>//            RunProgram background "notepad" FileName
45936>>>>//            EraseFile FileName
45936>>>>//        End
45936>>>>
45936>>>>//    End_Procedure   // StartReport
45936>>>>
45936>>>>
45936>>>>End_Class
45937>>>>
45937>>>>Class dbReportViewFEMSub is a dbReportViewSub
45938>>>>    Procedure Construct_Object
45939>>>>        Forward Send Construct_Object
45941>>>>
45941>>>>        Property Integer    piIsReportCancelled     Public  0
45942>>>>        Property Integer    piAsciiOrPrinter        Public  0
45943>>>>    
45943>>>>    End_Procedure
45944>>>>End_Class
45945>>>>
45945>>Use BasrpFem.Sub
INCLUDING FILE: BASRPFEM.SUB
45945>>>>Use Dfrpt.pkg
45945>>>>
45945>>>>Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
45945>>>>>>Use Dfrpt.pkg
45945>>>>>>
45945>>>>>>Class BasicReportSub is a BasicReport
45946>>>>>>
45946>>>>>>    Procedure Start_Log
45947>>>>>>        Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
45948>>>>>>    End_Procedure // Start_Log
45949>>>>>>
45949>>>>>>    Procedure End_Log
45950>>>>>>        Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
45951>>>>>>    End_Procedure // End_Log
45952>>>>>>
45952>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
45953>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
45954>>>>>>    End_Procedure // Error_Log_Status
45955>>>>>>
45955>>>>>>    Procedure Update_Status_Page
45956>>>>>>        If (Page_End(Current_Object)) EQ 0 ;             Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
45959>>>>>>        Else Send Update_Status ("Page: "   + String(Page_Count(Current_Object)))
45961>>>>>>    End_Procedure // Update_Status_Page
45962>>>>>>
45962>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
45963>>>>>>        If (Display_Error_State(Self)) Send End_Status
45966>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45967>>>>>>>
45967>>>>>>    End_procedure
45968>>>>>>
45968>>>>>>    Function Report_Interrupt Returns Integer
45969>>>>>>        Integer rVal
45970>>>>>>        String Mess
45970>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
45973>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
45975>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
45976>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45979>>>>>>        Function_Return (Rval=MBR_YES)
45980>>>>>>    End_Function  // Report_Interrupt
45981>>>>>>
45981>>>>>>
45981>>>>>>    Procedure Initialize_Output_Device
45982>>>>>>        string sopenpath
45983>>>>>>        get_attribute Df_Open_path to sopenpath
45986>>>>>>        set_attribute Df_Open_path to ""
45989>>>>>>        Direct_Output (Output_Device(current_Object))
45990>>>>>>        Set_Attribute DF_open_path to sopenpath
45993>>>>>>    End_procedure
45994>>>>>>End_Class // BasicReportSub
45995>>>>>>
45995>>>>>>Class WinReportSub is a WinReport
45996>>>>>>
45996>>>>>>    Procedure Start_Log
45997>>>>>>        Send Log_Status ("Start Report:"+Report_Title(Current_Object))
45998>>>>>>    End_Procedure // Start_Log
45999>>>>>>
45999>>>>>>    Procedure End_Log
46000>>>>>>        Send Log_Status ("End Report:  " + Report_Title(Current_Object))
46001>>>>>>    End_Procedure // End_Log
46002>>>>>>
46002>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
46003>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
46004>>>>>>    End_Procedure // Error_Log_Status
46005>>>>>>
46005>>>>>>    Procedure Update_Status_Page
46006>>>>>>        If (Page_End(Current_Object)) EQ 0 ;            Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
46009>>>>>>        Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
46011>>>>>>    End_Procedure // Update_Status_Page
46012>>>>>>
46012>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
46013>>>>>>        If (Display_Error_State(Self)) Send End_Status
46016>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46017>>>>>>>
46017>>>>>>    End_procedure
46018>>>>>>
46018>>>>>>    Function Report_Interrupt Returns Integer
46019>>>>>>        Integer rVal
46020>>>>>>        String Mess
46020>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46023>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46025>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46026>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46029>>>>>>        Function_Return (Rval=MBR_YES)
46030>>>>>>    End_Function  // Report_Interrupt
46031>>>>>>
46031>>>>>>    Procedure Initialize_Output_Device
46032>>>>>>        string sopenpath
46033>>>>>>        get_attribute Df_Open_path to sopenpath
46036>>>>>>        set_attribute Df_Open_path to ""
46039>>>>>>        Direct_Output (Output_Device(current_Object))
46040>>>>>>        Set_Attribute DF_open_path to sopenpath
46043>>>>>>    End_procedure
46044>>>>>>
46044>>>>>>End_Class // WinReportSub
46045>>>>>>
46045>>>>
46045>>>>Class BasicReportFemSub is a BasicReportSub
46046>>>>
46046>>>>    Function Starting_Main_Report Returns Integer
46047>>>>        Integer   iRetVal iindexr14_1
46048>>>>        Forward Get Starting_Main_Report to iRetval
46050>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
46053>>>>        Function_Return iRetval
46054>>>>    End_Function
46055>>>>
46055>>>>    Procedure Ending_Report
46056>>>>        Integer isCancelled
46057>>>>        Get Cancelled_State         to isCancelled
46058>>>>        //If Already with error do not touch
46058>>>>        If (Report_View_Id(Self)) Begin
46060>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
46062>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
46063>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
46064>>>>>
46064>>>>            End
46064>>>>>
46064>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
46066>>>>        End
46066>>>>>
46066>>>>        Forward Send Ending_Report
46068>>>>    End_Procedure
46069>>>>
46069>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
46070>>>>        If (Display_Error_State(Self)) Send End_Status
46073>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
46074>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46075>>>>>
46075>>>>    End_procedure
46076>>>>
46076>>>>    Function Report_Interrupt Returns Integer
46077>>>>        Integer rVal
46078>>>>        String Mess
46078>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46081>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46083>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46084>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46087>>>>        Function_Return (Rval=MBR_YES)
46088>>>>    End_Function  // Report_Interrupt
46089>>>>
46089>>>>
46089>>>>
46089>>>>End_Class
46090>>>>
46090>>>>Class WinReportFEMSub is a WinReportSUB
46091>>>>
46091>>>>    Function Starting_Main_Report Returns Integer
46092>>>>        Integer   iRetVal iindexr14_1
46093>>>>        Forward Get Starting_Main_Report to iRetval
46095>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
46098>>>>        Function_Return iRetval
46099>>>>    End_Function
46100>>>>
46100>>>>    Procedure Ending_Report
46101>>>>        Integer isCancelled
46102>>>>        Get Cancelled_State         to isCancelled
46103>>>>        //If Already with error do not touch
46103>>>>        If (Report_View_Id(Self)) Begin
46105>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
46107>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
46108>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
46109>>>>>
46109>>>>            End
46109>>>>>
46109>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
46111>>>>        End
46111>>>>>
46111>>>>        Forward Send Ending_Report
46113>>>>    End_Procedure
46114>>>>
46114>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
46115>>>>        If (Display_Error_State(Self)) Send End_Status
46118>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
46119>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46120>>>>>
46120>>>>    End_procedure  
46121>>>>
46121>>>>    Function Report_Interrupt Returns Integer
46122>>>>        Integer rVal
46123>>>>        String Mess
46123>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46126>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46128>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46129>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46132>>>>        Function_Return (Rval=MBR_YES)
46133>>>>    End_Function  // Report_Interrupt
46134>>>>
46134>>>>End_Class
46135>>>>
46135>>
46135>        
46135>        //AB-ClientStoreTopEnd
46135>
46135>        //  Include all views
46135>        Use Gefyres2.VW                                                                     
INCLUDING FILE: GEFYRES2.VW
46135>>>//AB/ Project gefyres:domikh2
46135>>>//AB/ Object prj is a View_Project
46135>>>//AB/     Set ProjectName to "gefyres:domikh2"
46135>>>//AB/     Set ProjectFileName to "Gefyres2.VW"
46135>>>
46135>>>// Project Object Structure
46135>>>//   gefyres2 is a dbViewSub
46135>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
46135>>>//     Country_DD is a Country_DataDictionary
46135>>>//     Towns_DD is a Towns_DataDictionary
46135>>>//     Cities_DD is a Cities_DataDictionary
46135>>>//     Payresp_DD is a Payresp_DataDictionary
46135>>>//     Constrct_DD is a Constrct_DataDictionary
46135>>>//     Salesmen_DD is a Salesmen_DataDictionary
46135>>>//     Mhxanik_DD is a Mhxanik_DataDictionary
46135>>>//     Areas_DD is a Areas_DataDictionary
46135>>>//     Btypkin_DD is a Btypkin_DataDictionary
46135>>>//     Baxiokat_DD is a Baxiokat_DataDictionary
46135>>>//     Barticl_DD is a Barticl_DataDictionary
46135>>>//     Bsum_DD is a Bsum_DataDictionary
46135>>>//     Baxio_DD is a Baxio_DataDictionary
46135>>>//     Syscurxr_DD is a Syscurxr_DataDictionary
46135>>>//     Sysrecc_DD is a Sysrecc_DataDictionary
46135>>>//     Clients_DD is a Clients_DataDictionary
46135>>>//     Cn_DD is a Cn_DataDictionary
46135>>>//     Tperga_DD is a Tperga_DataDictionary
46135>>>//     Bmove_DD is a Bmove_DataDictionary
46135>>>//     Cmoves_DD is a Cmoves_DataDictionary
46135>>>//     Btnordh_DD is a Btnordh_DataDictionary
46135>>>//     Btnordd_DD is a Btnordd_DataDictionary
46135>>>//     frmFileName is a FormSub
46135>>>//     Frmdate is a FormSub
46135>>>//     ButtonSub1 is a ButtonSub
46135>>>//     TextBoxSub1 is a TextBoxSub
46135>>>//     oOpenFile is a OpenDialog
46135>>>//     TextBoxSub3 is a TextBoxSub
46135>>>
46135>>>// Register all objects
46135>>>Register_Object Areas_DD
46135>>>Register_Object Barticl_DD
46135>>>Register_Object Baxio_DD
46135>>>Register_Object Baxiokat_DD
46135>>>Register_Object Bmove_DD
46135>>>Register_Object Bsum_DD
46135>>>Register_Object Btnordd_DD
46135>>>Register_Object Btnordh_DD
46135>>>Register_Object Btypkin_DD
46135>>>Register_Object ButtonSub1
46135>>>Register_Object Cities_DD
46135>>>Register_Object Clients_DD
46135>>>Register_Object Cmoves_DD
46135>>>Register_Object Cn_DD
46135>>>Register_Object Constrct_DD
46135>>>Register_Object Country_DD
46135>>>Register_Object Ctypkin_DD
46135>>>Register_Object Frmdate
46135>>>Register_Object frmFileName
46135>>>Register_Object gefyres2
46135>>>Register_Object Mhxanik_DD
46135>>>Register_Object oOpenFile
46135>>>Register_Object Payresp_DD
46135>>>Register_Object Salesmen_DD
46135>>>Register_Object Syscurxr_DD
46135>>>Register_Object Sysrecc_DD
46135>>>Register_Object TextBoxSub1
46135>>>Register_Object TextBoxSub3
46135>>>Register_Object Towns_DD
46135>>>Register_Object Tperga_DD
46135>>>
46135>>>
46135>>>//AB/ AppBuild VIEW
46135>>>
46135>>>
46135>>>//AB-StoreTopStart
46135>>>                                    
46135>>>Use sl041.sl
46135>>>
46135>>>Use bpEnCmv3.dg // Business Process Finilizing Barticle
INCLUDING FILE: BPENCMV3.DG
46135>>>>>//AB/ Project bpencmv3
46135>>>>>//AB/     Object prj is a Dialog_Project
46135>>>>>//AB/         Set ProjectName to "bpencmv3"
46135>>>>>//AB/         Set ProjectFileName to "bpencmv3.DG"
46135>>>>>
46135>>>>>// Project Object Structure
46135>>>>>//   bpencmv3 is a BusinessProcessSub
46135>>>>>//     Ctypkin_DD is a DataDictionary
46135>>>>>//     Country_DD is a DataDictionary
46135>>>>>//     Towns_DD is a DataDictionary
46135>>>>>//     Cities_DD is a DataDictionary
46135>>>>>//     Payresp_DD is a DataDictionary
46135>>>>>//     Areas_DD is a DataDictionary
46135>>>>>//     Clients_DD is a DataDictionary
46135>>>>>//     Cmoves_DD is a DataDictionary
46135>>>>>//     Cflagkin_DD is a DataDictionary
46135>>>>>//     Btypkin_DD is a DataDictionary
46135>>>>>//     Baxiokat_DD is a DataDictionary
46135>>>>>//     Barticl_DD is a DataDictionary
46135>>>>>//     Baxio_DD is a DataDictionary
46135>>>>>//     Bmove_DD is a DataDictionary
46135>>>>>//     Nomisma_DD is a DataDictionary
46135>>>>>
46135>>>>>// Register all objects
46135>>>>>Register_Object Areas_DD
46135>>>>>Register_Object Barticl_DD
46135>>>>>Register_Object Baxio_DD
46135>>>>>Register_Object Baxiokat_DD
46135>>>>>Register_Object Bmove_DD
46135>>>>>Register_Object Btypkin_DD
46135>>>>>Register_Object bpencmv3
46135>>>>>Register_Object Cflagkin_DD
46135>>>>>Register_Object Cities_DD
46135>>>>>Register_Object Clients_DD
46135>>>>>Register_Object Cmoves_DD
46135>>>>>Register_Object Country_DD
46135>>>>>Register_Object Ctypkin_DD
46135>>>>>Register_Object Nomisma_DD
46135>>>>>Register_Object Payresp_DD
46135>>>>>Register_Object Towns_DD
46135>>>>>
46135>>>>>
46135>>>>>
46135>>>>>    //AB-StoreTopStart
46135>>>>>
46135>>>>>
46135>>>>>    //AB-StoreTopEnd
46135>>>>>
46135>>>>>    //AB-IgnoreStart
46135>>>>>
46135>>>>>    Use Bproces.Sub
46135>>>>>    Use DFAllEnt.pkg
46135>>>>>
46135>>>>>
46135>>>>>    Use CTYPKIN.DD
46135>>>>>    Use COUNTRY.DD
46135>>>>>    Use TOWNS.DD
46135>>>>>    Use CITIES.DD
46135>>>>>    Use PAYRESP.DD
46135>>>>>    Use AREAS.DD
46135>>>>>    Use CLIENTS.DD
46135>>>>>    Use CMOVES.DD
INCLUDING FILE: CMOVES.DD
46135>>>>>>>//DDB-FileStart
46135>>>>>>>//DDB-HeaderStart
46135>>>>>>>
46135>>>>>>>// File Name : CMOVES.DD
46135>>>>>>>// Class Name: Cmoves_DataDictionary
46135>>>>>>>// Revision  : 148
46135>>>>>>>// Version   : 2
46135>>>>>>>
46135>>>>>>>Use  Windows           // Basic Definitions
46135>>>>>>>Use  DataDict          // DataDictionary Class Definition
46135>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46135>>>>>>>
46135>>>>>>>Open Cmoves
46137>>>>>>>Open Copen
INCLUDING FILE: COPEN.FD
46139>>>>>>>Open Ctypkin
46141>>>>>>>Open Clients
46143>>>>>>>Open Sysrecc
46145>>>>>>>Open Syscurxr
46147>>>>>>>
46147>>>>>>>//DDB-HeaderEnd
46147>>>>>>>//DDB-SelectionStart
46147>>>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
46147>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
46147>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46147>>>>>>>Register_Object sl006
46147>>>>>>>Register_Object slNomism
46147>>>>>>>Register_Object sl041
46147>>>>>>>//DDB-SelectionEnd
46147>>>>>>> 
46147>>>>>>>Use Payresp.DD
46147>>>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
46147>>>>>>>>>//DDB-FileStart
46147>>>>>>>>>//DDB-HeaderStart
46147>>>>>>>>>
46147>>>>>>>>>// File Name : PMSSXET.DD
46147>>>>>>>>>// Class Name: PmsSxet_DataDictionary
46147>>>>>>>>>// Revision  : 27
46147>>>>>>>>>// Version   : 2
46147>>>>>>>>>
46147>>>>>>>>>Use  Windows           // Basic Definitions
46147>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46147>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46147>>>>>>>>>
46147>>>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
46149>>>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
46151>>>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
46153>>>>>>>>>Open Pmoves
46155>>>>>>>>>
46155>>>>>>>>>//DDB-HeaderEnd
46155>>>>>>>>>
46155>>>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
46155>>>>>>>>>>>//AB/ Project bpEnYpol
46155>>>>>>>>>>>//AB/ Object prj is a Dialog_Project
46155>>>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
46155>>>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
46155>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
46155>>>>>>>>>>>
46155>>>>>>>>>>>// Project Object Structure
46155>>>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
46155>>>>>>>>>>>
46155>>>>>>>>>>>// Register all objects
46155>>>>>>>>>>>Register_Object bpEnYpol
46155>>>>>>>>>>>
46155>>>>>>>>>>>
46155>>>>>>>>>>>//AB-IgnoreStart
46155>>>>>>>>>>>
46155>>>>>>>>>>>Use Bproces.Sub
46155>>>>>>>>>>>
46155>>>>>>>>>>>
46155>>>>>>>>>>>//AB-IgnoreEnd
46155>>>>>>>>>>>
46155>>>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
46157>>>>>>>>>>>
46157>>>>>>>>>>>    //AB-StoreTopStart
46157>>>>>>>>>>>
46157>>>>>>>>>>>    Open Pmoves
46159>>>>>>>>>>>    Open Psxetika
46161>>>>>>>>>>>
46161>>>>>>>>>>>    Set Status_Panel_State to False
46162>>>>>>>>>>>    //Set Allow_Cancel_State  to True
46162>>>>>>>>>>>    Set Display_Error_State to True
46163>>>>>>>>>>>    //Set Process_Title to "               "
46163>>>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
46163>>>>>>>>>>>    //Set Status_log_state to True
46163>>>>>>>>>>>
46163>>>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
46165>>>>>>>>>>>    Property Integer    piLathos            Public  0
46167>>>>>>>>>>>    Property Number     pnQty               Public  0
46169>>>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
46171>>>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
46173>>>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
46175>>>>>>>>>>>    Property String     psRecr              Public ''
46177>>>>>>>>>>>
46177>>>>>>>>>>>
46177>>>>>>>>>>>    //AB-StoreTopEnd
46177>>>>>>>>>>>
46177>>>>>>>>>>>    Set Size to 60 100
46178>>>>>>>>>>>    Set Location to 4 5
46179>>>>>>>>>>>
46179>>>>>>>>>>>    //AB-DDOStart
46179>>>>>>>>>>>
46179>>>>>>>>>>>
46179>>>>>>>>>>>    //AB-DDOEnd
46179>>>>>>>>>>>
46179>>>>>>>>>>>
46179>>>>>>>>>>>    //AB-StoreStart
46179>>>>>>>>>>>
46179>>>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
46181>>>>>>>>>>>        Clear Pmoves
46182>>>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
46183>>>>>>>>>>>        Find Eq Pmoves by index.2
46184>>>>>>>>>>>>
46184>>>>>>>>>>>        If (Found) Begin
46186>>>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
46189>>>>>>>>>>>            Else Begin
46190>>>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
46191>>>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
46192>>>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
46195>>>>>>>>>>>                Saverecord Pmoves
46196>>>>>>>>>>>
46196>>>>>>>>>>>                Clear Particle
46197>>>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
46198>>>>>>>>>>>                Find Eq Particle by Index.2
46199>>>>>>>>>>>>
46199>>>>>>>>>>>                If (Found) Begin
46201>>>>>>>>>>>                   // Reread
46201>>>>>>>>>>>                    Add anQty to Particle.Timol_Qty
46202>>>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
46204>>>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
46205>>>>>>>>>>>
46205>>>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
46208>>>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
46210>>>>>>>>>>>
46210>>>>>>>>>>>                    End
46210>>>>>>>>>>>>
46210>>>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
46212>>>>>>>>>>>                    Saverecord Particle
46213>>>>>>>>>>>                   // Unlock
46213>>>>>>>>>>>                End
46213>>>>>>>>>>>>
46213>>>>>>>>>>>                Else Function_Return 40002
46215>>>>>>>>>>>            End
46215>>>>>>>>>>>>
46215>>>>>>>>>>>        End
46215>>>>>>>>>>>>
46215>>>>>>>>>>>        Else Function_Return 40000
46217>>>>>>>>>>>        Function_Return 0
46218>>>>>>>>>>>    End_Function
46219>>>>>>>>>>>
46219>>>>>>>>>>>    Procedure OnProcess
46221>>>>>>>>>>>        Integer iLathos iSub iAkyro
46222>>>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
46222>>>>>>>>>>>        Number  nQty nQty2
46222>>>>>>>>>>>
46222>>>>>>>>>>>        Set piLathos        to 0
46223>>>>>>>>>>>        Get pnQty           to nQty2
46224>>>>>>>>>>>        Get psRecr          to sRecr
46225>>>>>>>>>>>        Get piFromAkyrosh   to iAkyro
46226>>>>>>>>>>>
46226>>>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
46226>>>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
46226>>>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
46226>>>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
46226>>>>>>>>>>>        Move (nQty2<0)   to iSub
46227>>>>>>>>>>>
46227>>>>>>>>>>>
46227>>>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
46228>>>>>>>>>>>
46228>>>>>>>>>>>        If (iLathos) Begin
46230>>>>>>>>>>>            Set piLathos to iLathos
46231>>>>>>>>>>>            Procedure_Return
46232>>>>>>>>>>>        End
46232>>>>>>>>>>>>
46232>>>>>>>>>>>
46232>>>>>>>>>>>
46232>>>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
46232>>>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
46232>>>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
46232>>>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
46232>>>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
46232>>>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
46232>>>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
46232>>>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
46232>>>>>>>>>>>
46232>>>>>>>>>>>        If (iAkyro) Begin
46234>>>>>>>>>>>            Clear Pmoves
46235>>>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
46236>>>>>>>>>>>            Find Eq Pmoves by index.2
46237>>>>>>>>>>>>
46237>>>>>>>>>>>            If (Found) Begin
46239>>>>>>>>>>>                Clear PmsSxet
46240>>>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
46241>>>>>>>>>>>                Find Gt PmsSxet by Index.1
46242>>>>>>>>>>>>
46242>>>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
46246>>>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
46247>>>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
46248>>>>>>>>>>>                    If (iSub) Begin
46250>>>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
46250>>>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
46250>>>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
46250>>>>>>>>>>>                    End
46250>>>>>>>>>>>>
46250>>>>>>>>>>>                    Else Begin
46251>>>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
46251>>>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
46251>>>>>>>>>>>                        // PmsSxet arnhtikh.
46251>>>>>>>>>>>                        Move (nQty*(-1)) to nQty
46252>>>>>>>>>>>                    End
46252>>>>>>>>>>>>
46252>>>>>>>>>>>
46252>>>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
46252>>>>>>>>>>>                    // 07/01/2003 //
46252>>>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
46253>>>>>>>>>>>
46253>>>>>>>>>>>                    If (iLathos) Begin
46255>>>>>>>>>>>                        Set piLathos to (iLathos+3)
46256>>>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
46256>>>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
46256>>>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
46256>>>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
46256>>>>>>>>>>>                        Procedure_Return
46257>>>>>>>>>>>                    End
46257>>>>>>>>>>>>
46257>>>>>>>>>>>
46257>>>>>>>>>>>                    Clear PmsSxet
46258>>>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
46259>>>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
46260>>>>>>>>>>>                    Find Eq PmsSxet by Index.1
46261>>>>>>>>>>>>
46261>>>>>>>>>>>                    Find Gt PmsSxet by Index.1
46262>>>>>>>>>>>>
46262>>>>>>>>>>>                Loop
46263>>>>>>>>>>>>
46263>>>>>>>>>>>            End
46263>>>>>>>>>>>>
46263>>>>>>>>>>>            Else Set piLathos to 40007
46265>>>>>>>>>>>        End
46265>>>>>>>>>>>>
46265>>>>>>>>>>>
46265>>>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
46268>>>>>>>>>>>
46268>>>>>>>>>>>    End_Procedure
46269>>>>>>>>>>>
46269>>>>>>>>>>>    Procedure OnError integer error_info string errMsg
46271>>>>>>>>>>>    End_Procedure
46272>>>>>>>>>>>
46272>>>>>>>>>>>    Procedure Start_Process
46274>>>>>>>>>>>        Forward Send Start_Process
46276>>>>>>>>>>>    End_Procedure
46277>>>>>>>>>>>
46277>>>>>>>>>>>    Procedure End_Process
46279>>>>>>>>>>>        Forward Send End_Process
46281>>>>>>>>>>>        If (piCurrentPartl(Self)) Begin
46283>>>>>>>>>>>            Clear Particle
46284>>>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
46285>>>>>>>>>>>            Find Eq Particle.Recnum
46286>>>>>>>>>>>>
46286>>>>>>>>>>>        End
46286>>>>>>>>>>>>
46286>>>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
46288>>>>>>>>>>>            Clear Pmoves
46289>>>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
46290>>>>>>>>>>>            Find Eq Pmoves.Recnum
46291>>>>>>>>>>>>
46291>>>>>>>>>>>        End
46291>>>>>>>>>>>>
46291>>>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
46293>>>>>>>>>>>            Clear PmsSxet
46294>>>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
46295>>>>>>>>>>>            Find Eq PmsSxet.Recnum
46296>>>>>>>>>>>>
46296>>>>>>>>>>>        End
46296>>>>>>>>>>>>
46296>>>>>>>>>>>    End_Procedure
46297>>>>>>>>>>>
46297>>>>>>>>>>>    //AB-StoreEnd
46297>>>>>>>>>>>
46297>>>>>>>>>>>End_Object    // bpEnYpol
46298>>>>>>>>>>>
46298>>>>>>>>>>>//AB/ End_Object    // prj
46298>>>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
46298>>>>>>>>>>>//AB/ Project MyArray
46298>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
46298>>>>>>>>>>>//AB/         Set ProjectName to "MyArray"
46298>>>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
46298>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46298>>>>>>>>>>>
46298>>>>>>>>>>>// Project Object Structure
46298>>>>>>>>>>>//   Psx_Array is a BusinessProcessSub
46298>>>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
46298>>>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
46298>>>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
46298>>>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
46298>>>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
46298>>>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
46298>>>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
46298>>>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
46298>>>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
46298>>>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
46298>>>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
46298>>>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
46298>>>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
46298>>>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
46298>>>>>>>>>>>//     Country_DD is a Country_DataDictionary
46298>>>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
46298>>>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
46298>>>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
46298>>>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
46298>>>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
46298>>>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
46298>>>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
46298>>>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
46298>>>>>>>>>>>
46298>>>>>>>>>>>// Register all objects
46298>>>>>>>>>>>Register_Object Areas_DD
46298>>>>>>>>>>>Register_Object Areas_DD2
46298>>>>>>>>>>>Register_Object Cities_DD
46298>>>>>>>>>>>Register_Object Cities_DD2
46298>>>>>>>>>>>Register_Object Clients_DD
46298>>>>>>>>>>>Register_Object Clients_DD2
46298>>>>>>>>>>>Register_Object Country_DD
46298>>>>>>>>>>>Register_Object Country_DD2
46298>>>>>>>>>>>Register_Object Ctypkin_DD
46298>>>>>>>>>>>Register_Object Ctypkin_DD2
46298>>>>>>>>>>>Register_Object Nomisma_DD
46298>>>>>>>>>>>Register_Object Nomisma_DD2
46298>>>>>>>>>>>Register_Object Particle_DD
46298>>>>>>>>>>>Register_Object Particle_DD2
46298>>>>>>>>>>>Register_Object Payresp_DD
46298>>>>>>>>>>>Register_Object Payresp_DD2
46298>>>>>>>>>>>Register_Object Psx_Array
46298>>>>>>>>>>>Register_Object Psxetika_DD
46298>>>>>>>>>>>Register_Object Ptyppar_DD
46298>>>>>>>>>>>Register_Object Ptyppar_DD2
46298>>>>>>>>>>>Register_Object Towns_DD
46298>>>>>>>>>>>Register_Object Towns_DD2
46298>>>>>>>>>>>Register_Object Wtypkin_DD
46298>>>>>>>>>>>Register_Object Wtypkin_DD2
46298>>>>>>>>>>>
46298>>>>>>>>>>>
46298>>>>>>>>>>>
46298>>>>>>>>>>>    //AB-StoreTopStart
46298>>>>>>>>>>>
46298>>>>>>>>>>>    Use CTYPKIN.DD
46298>>>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
46298>>>>>>>>>>>>>//DDB-FileStart
46298>>>>>>>>>>>>>//DDB-HeaderStart
46298>>>>>>>>>>>>>
46298>>>>>>>>>>>>>// File Name : WTYPKIN.DD
46298>>>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
46298>>>>>>>>>>>>>// Revision  : 49
46298>>>>>>>>>>>>>// Version   : 2
46298>>>>>>>>>>>>>
46298>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46298>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46298>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46298>>>>>>>>>>>>>
46298>>>>>>>>>>>>>Open Wtypkin
46300>>>>>>>>>>>>>Open Ptyppar
46302>>>>>>>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
46304>>>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
46306>>>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
46308>>>>>>>>>>>>>Open Sysrecw
46310>>>>>>>>>>>>>Open Syscurxr
46312>>>>>>>>>>>>>
46312>>>>>>>>>>>>>//DDB-HeaderEnd
46312>>>>>>>>>>>>>//DDB-ValidationStart
46312>>>>>>>>>>>>>
46312>>>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
46312>>>>>>>>>>>>>
46312>>>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
46314>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
46315>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46315>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46315>>>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
46316>>>>>>>>>>>>>//DDB-ValidationEnd
46316>>>>>>>>>>>>>//DDB-SelectionStart
46316>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
46316>>>>>>>>>>>>>Register_Object sl029a
46316>>>>>>>>>>>>>//DDB-SelectionEnd
46316>>>>>>>>>>>>>
46316>>>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
46317>>>>>>>>>>>>>               
46317>>>>>>>>>>>>>    Procedure Construct_Object
46318>>>>>>>>>>>>>        Forward Send Construct_Object
46320>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
46321>>>>>>>>>>>>>    End_Procedure
46322>>>>>>>>>>>>>
46322>>>>>>>>>>>>>    Procedure Save_Main_File
46323>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46325>>>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
46328>>>>>>>>>>>>>        End
46328>>>>>>>>>>>>>>
46328>>>>>>>>>>>>>        Forward Send Save_Main_File
46330>>>>>>>>>>>>>    End_Procedure
46331>>>>>>>>>>>>>
46331>>>>>>>>>>>>>
46331>>>>>>>>>>>>>     Procedure Creating
46332>>>>>>>>>>>>>        Forward Send Creating
46334>>>>>>>>>>>>>        // Insert Code Here
46334>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
46335>>>>>>>>>>>>>    End_Procedure   // Creating
46336>>>>>>>>>>>>>
46336>>>>>>>>>>>>>    // Define_Fields:
46336>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46336>>>>>>>>>>>>>
46336>>>>>>>>>>>>>    Procedure Define_Fields
46337>>>>>>>>>>>>>        Forward Send Define_Fields
46339>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46339>>>>>>>>>>>>>        //DDB-DefineFieldStart
46339>>>>>>>>>>>>>
46339>>>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
46340>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46341>>>>>>>>>>>>>
46341>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46342>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46343>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46344>>>>>>>>>>>>>
46344>>>>>>>>>>>>>        // Child (Client) file structure................
46344>>>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
46345>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
46346>>>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
46347>>>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
46348>>>>>>>>>>>>>
46348>>>>>>>>>>>>>        // External (System) file structure.............
46348>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46349>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46350>>>>>>>>>>>>>
46350>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
46353>>>>>>>>>>>>>
46353>>>>>>>>>>>>>        // Field-based properties.......................
46353>>>>>>>>>>>>>
46353>>>>>>>>>>>>>        // Wtypkin.Company_Code
46353>>>>>>>>>>>>>
46353>>>>>>>>>>>>>        // Wtypkin.Branch_Code
46353>>>>>>>>>>>>>
46353>>>>>>>>>>>>>        // Wtypkin.Year_Year
46353>>>>>>>>>>>>>
46353>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
46353>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
46354>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
46355>>>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
46356>>>>>>>>>>>>>
46356>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
46356>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
46357>>>>>>>>>>>>>
46357>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
46357>>>>>>>>>>>>>
46357>>>>>>>>>>>>>        // Wtypkin.Year_Recr
46357>>>>>>>>>>>>>
46357>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
46357>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
46358>>>>>>>>>>>>>
46358>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
46358>>>>>>>>>>>>>
46358>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
46358>>>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
46359>>>>>>>>>>>>>
46359>>>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
46359>>>>>>>>>>>>>
46359>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46359>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46360>>>>>>>>>>>>>
46360>>>>>>>>>>>>>    // Field_Defaults:
46360>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46360>>>>>>>>>>>>>
46360>>>>>>>>>>>>>    Procedure Field_Defaults
46361>>>>>>>>>>>>>        Forward Send Field_Defaults
46363>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46363>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46363>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46363>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46364>>>>>>>>>>>>>
46364>>>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
46365>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46365>>>>>>>>>>>>>
46365>>>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
46365>>>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
46365>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46365>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
46365>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
46365>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>// Project Object Structure
46365>>>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
46365>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46365>>>>>>>>>>>>>>>//     oSelList is a dbListSub
46365>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46365>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46365>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>// Register all objects
46365>>>>>>>>>>>>>>>Register_Object oCancel_bn
46365>>>>>>>>>>>>>>>Register_Object oOK_bn
46365>>>>>>>>>>>>>>>Register_Object oSearch_bn
46365>>>>>>>>>>>>>>>Register_Object oSelList
46365>>>>>>>>>>>>>>>Register_Object sl029a
46365>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>    //AB-IgnoreStart
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
46365>>>>>>>>>>>>>>>    Use dbList.Sub
46365>>>>>>>>>>>>>>>    Use Button.Sub
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>    Use WTYPKIN.DD
46365>>>>>>>>>>>>>>>    
46365>>>>>>>>>>>>>>>    //AB-IgnoreEnd
46365>>>>>>>>>>>>>>>
46365>>>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
46367>>>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
46368>>>>>>>>>>>>>>>        Set Size to 148 297
46369>>>>>>>>>>>>>>>        Set Location to 4 5
46370>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46371>>>>>>>>>>>>>>>        Set Modal_State to FALSE
46372>>>>>>>>>>>>>>>
46372>>>>>>>>>>>>>>>        //AB-DDOStart
46372>>>>>>>>>>>>>>>
46372>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
46374>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
46375>>>>>>>>>>>>>>>
46375>>>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
46376>>>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
46377>>>>>>>>>>>>>>>
46377>>>>>>>>>>>>>>>        //AB-DDOEnd
46377>>>>>>>>>>>>>>>
46377>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
46379>>>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
46380>>>>>>>>>>>>>>>            Set Size to 105 280
46381>>>>>>>>>>>>>>>            Set Location to 6 6
46382>>>>>>>>>>>>>>>
46382>>>>>>>>>>>>>>>            Begin_Row
46385>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
46386>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
46387>>>>>>>>>>>>>>>            End_Row
46392>>>>>>>>>>>>>>>
46392>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
46393>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
46394>>>>>>>>>>>>>>>            
46394>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
46395>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
46396>>>>>>>>>>>>>>>            
46396>>>>>>>>>>>>>>>        End_Object    // oSelList
46397>>>>>>>>>>>>>>>
46397>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46399>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
46400>>>>>>>>>>>>>>>            Set Location to 115 126
46401>>>>>>>>>>>>>>>
46401>>>>>>>>>>>>>>>            //AB-StoreStart
46401>>>>>>>>>>>>>>>            Procedure OnClick
46403>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46404>>>>>>>>>>>>>>>            End_Procedure
46405>>>>>>>>>>>>>>>            //AB-StoreEnd
46405>>>>>>>>>>>>>>>
46405>>>>>>>>>>>>>>>        End_Object    // oOK_bn
46406>>>>>>>>>>>>>>>
46406>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46408>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
46409>>>>>>>>>>>>>>>            Set Location to 115 181
46410>>>>>>>>>>>>>>>
46410>>>>>>>>>>>>>>>            //AB-StoreStart
46410>>>>>>>>>>>>>>>            Procedure OnClick
46412>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46413>>>>>>>>>>>>>>>            End_Procedure
46414>>>>>>>>>>>>>>>            //AB-StoreEnd
46414>>>>>>>>>>>>>>>
46414>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
46415>>>>>>>>>>>>>>>
46415>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46417>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
46418>>>>>>>>>>>>>>>            Set Location to 115 236
46419>>>>>>>>>>>>>>>
46419>>>>>>>>>>>>>>>            //AB-StoreStart
46419>>>>>>>>>>>>>>>            Procedure OnClick
46421>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46422>>>>>>>>>>>>>>>            End_Procedure
46423>>>>>>>>>>>>>>>            //AB-StoreEnd
46423>>>>>>>>>>>>>>>
46423>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
46424>>>>>>>>>>>>>>>
46424>>>>>>>>>>>>>>>
46424>>>>>>>>>>>>>>>        //AB-StoreStart
46424>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46425>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46426>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46427>>>>>>>>>>>>>>>        //AB-StoreEnd
46427>>>>>>>>>>>>>>>
46427>>>>>>>>>>>>>>>    End_Object    // sl029a
46428>>>>>>>>>>>>>>>
46428>>>>>>>>>>>>>>>//AB/     End_Object    // prj
46428>>>>>>>>>>>>>
46428>>>>>>>>>>>>>//DDB-Selection-pkg-End
46428>>>>>>>>>>>>>//DDB-FileEnd
46428>>>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
46428>>>>>>>>>>>>>//DDB-FileStart
46428>>>>>>>>>>>>>//DDB-HeaderStart
46428>>>>>>>>>>>>>
46428>>>>>>>>>>>>>// File Name : PTYPPAR.DD
46428>>>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
46428>>>>>>>>>>>>>// Revision  : 88
46428>>>>>>>>>>>>>// Version   : 2
46428>>>>>>>>>>>>>
46428>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46428>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46428>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46428>>>>>>>>>>>>>
46428>>>>>>>>>>>>>Open Ptyppar
46430>>>>>>>>>>>>>Open Particle
46432>>>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
46434>>>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
46436>>>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
46438>>>>>>>>>>>>>Open Ctypkin
46440>>>>>>>>>>>>>Open Wtypkin
46442>>>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
46444>>>>>>>>>>>>>Open Syscurxr
46446>>>>>>>>>>>>>
46446>>>>>>>>>>>>>//DDB-HeaderEnd
46446>>>>>>>>>>>>>//DDB-ValidationStart
46446>>>>>>>>>>>>>
46446>>>>>>>>>>>>>Register_Object Ptyppar_Year_Recr_VT
46446>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
46446>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
46446>>>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
46446>>>>>>>>>>>>>
46446>>>>>>>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
46448>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46449>>>>>>>>>>>>>
46449>>>>>>>>>>>>>    Procedure Fill_List
46451>>>>>>>>>>>>>        Forward Send Fill_List
46453>>>>>>>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
46454>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
46455>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
46456>>>>>>>>>>>>>    End_Procedure    // Fill_List
46457>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46457>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46457>>>>>>>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
46458>>>>>>>>>>>>>
46458>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
46460>>>>>>>>>>>>>
46460>>>>>>>>>>>>>    Procedure Fill_List
46462>>>>>>>>>>>>>        Forward Send Fill_List
46464>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
46465>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
46466>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
46467>>>>>>>>>>>>>    End_Procedure    // Fill_List
46468>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46468>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46468>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
46469>>>>>>>>>>>>>
46469>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
46471>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
46472>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46473>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46473>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46473>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
46474>>>>>>>>>>>>>
46474>>>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
46476>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46477>>>>>>>>>>>>>
46477>>>>>>>>>>>>>    Procedure Fill_List
46479>>>>>>>>>>>>>        Forward Send Fill_List
46481>>>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
46482>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
46483>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
46484>>>>>>>>>>>>>    End_Procedure    // Fill_List
46485>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46485>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46485>>>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
46486>>>>>>>>>>>>>//DDB-ValidationEnd
46486>>>>>>>>>>>>>//DDB-SelectionStart
46486>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
46486>>>>>>>>>>>>>Register_Object sl012
46486>>>>>>>>>>>>>//DDB-SelectionEnd
46486>>>>>>>>>>>>>
46486>>>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
46487>>>>>>>>>>>>>
46487>>>>>>>>>>>>>    Procedure Construct_Object
46488>>>>>>>>>>>>>        Forward Send Construct_Object
46490>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
46491>>>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
46492>>>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
46493>>>>>>>>>>>>>    End_Procedure
46494>>>>>>>>>>>>>
46494>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
46495>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
46497>>>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
46498>>>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
46499>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
46500>>>>>>>>>>>>>
46500>>>>>>>>>>>>>    Procedure OnConstrain
46501>>>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
46503>>>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
46505>>>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
46507>>>>>>>>>>>>>        End
46507>>>>>>>>>>>>>>
46507>>>>>>>>>>>>>    End_Procedure
46508>>>>>>>>>>>>>
46508>>>>>>>>>>>>>    Procedure Clear_Main_File
46509>>>>>>>>>>>>>        Forward Send Clear_Main_File
46511>>>>>>>>>>>>>        Set piOldCtypkin to 0
46512>>>>>>>>>>>>>        Set piOldWtypkin to 0
46513>>>>>>>>>>>>>    End_Procedure
46514>>>>>>>>>>>>>
46514>>>>>>>>>>>>>    Procedure Save_Main_File
46515>>>>>>>>>>>>>        Integer isAdmin iYes
46516>>>>>>>>>>>>>        String  sStr
46516>>>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
46517>>>>>>>>>>>>>
46517>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46519>>>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
46522>>>>>>>>>>>>>        End
46522>>>>>>>>>>>>>>
46522>>>>>>>>>>>>>
46522>>>>>>>>>>>>>        If (Operation_Origin=Self) Begin
46524>>>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
46526>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
46529>>>>>>>>>>>>>                Else Begin
46530>>>>>>>>>>>>>                    Move '' to sStr
46531>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
46532>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
46533>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
46536>>>>>>>>>>>>>                End
46536>>>>>>>>>>>>>>
46536>>>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
46536>>>>>>>>>>>>>>
46536>>>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
46538>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
46541>>>>>>>>>>>>>                Else Begin
46542>>>>>>>>>>>>>                    Move '' to sStr
46543>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
46544>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
46545>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
46548>>>>>>>>>>>>>                End
46548>>>>>>>>>>>>>>
46548>>>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
46548>>>>>>>>>>>>>>
46548>>>>>>>>>>>>>        End // If (Operation_Origin=Self)
46548>>>>>>>>>>>>>>
46548>>>>>>>>>>>>>        Forward Send Save_Main_File
46550>>>>>>>>>>>>>    End_Procedure // Save_Main_File
46551>>>>>>>>>>>>>
46551>>>>>>>>>>>>>
46551>>>>>>>>>>>>>    Procedure Update
46552>>>>>>>>>>>>>        Forward Send Update
46554>>>>>>>>>>>>>        // Insert Code Here
46554>>>>>>>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
46554>>>>>>>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
46555>>>>>>>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
46556>>>>>>>>>>>>>//        end
46556>>>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
46556>>>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
46556>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
46557>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
46558>>>>>>>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
46561>>>>>>>>>>>>>    End_Procedure   // Update
46562>>>>>>>>>>>>>
46562>>>>>>>>>>>>>    Procedure Creating
46563>>>>>>>>>>>>>        Forward Send Creating
46565>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
46566>>>>>>>>>>>>>    End_Procedure   // Creating
46567>>>>>>>>>>>>>
46567>>>>>>>>>>>>>
46567>>>>>>>>>>>>>    // Define_Fields:
46567>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46567>>>>>>>>>>>>>    Procedure Define_Fields
46568>>>>>>>>>>>>>        Forward Send Define_Fields
46570>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46570>>>>>>>>>>>>>        //DDB-DefineFieldStart
46570>>>>>>>>>>>>>
46570>>>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
46571>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46572>>>>>>>>>>>>>
46572>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46573>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46574>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46575>>>>>>>>>>>>>
46575>>>>>>>>>>>>>        // Child (Client) file structure................
46575>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
46576>>>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
46577>>>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
46578>>>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
46579>>>>>>>>>>>>>
46579>>>>>>>>>>>>>        // Parent (Server) file structure...............
46579>>>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
46580>>>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
46581>>>>>>>>>>>>>
46581>>>>>>>>>>>>>        // External (System) file structure.............
46581>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
46582>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46583>>>>>>>>>>>>>
46583>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Field-based properties.......................
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Ptyppar.Company_Code
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Ptyppar.Branch_Code
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Ptyppar.Year_Year
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
46586>>>>>>>>>>>>>
46586>>>>>>>>>>>>>        // Ptyppar.Year_Recr
46586>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
46587>>>>>>>>>>>>>
46587>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
46587>>>>>>>>>>>>>
46587>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
46587>>>>>>>>>>>>>
46587>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
46587>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
46588>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
46589>>>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
46590>>>>>>>>>>>>>
46590>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
46590>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
46591>>>>>>>>>>>>>
46591>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
46591>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
46592>>>>>>>>>>>>>
46592>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
46592>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND
46593>>>>>>>>>>>>>
46593>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
46593>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
46594>>>>>>>>>>>>>
46594>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
46594>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
46595>>>>>>>>>>>>>
46595>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
46595>>>>>>>>>>>>>
46595>>>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
46595>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
46596>>>>>>>>>>>>>
46596>>>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
46596>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
46597>>>>>>>>>>>>>
46597>>>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
46597>>>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
46598>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Singular
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Sub
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Constrain
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Label
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Label1
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Sap
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        // Ptyppar.Is_Xondr
46599>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46599>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46600>>>>>>>>>>>>>
46600>>>>>>>>>>>>>    // Field_Defaults:
46600>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46600>>>>>>>>>>>>>
46600>>>>>>>>>>>>>    Procedure Field_Defaults
46601>>>>>>>>>>>>>        Forward Send Field_Defaults
46603>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46603>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46603>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
46604>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
46605>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46605>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46606>>>>>>>>>>>>>
46606>>>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
46607>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46607>>>>>>>>>>>>>
46607>>>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
46607>>>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
46607>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
46607>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
46607>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
46607>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>// Project Object Structure
46607>>>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
46607>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
46607>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46607>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
46607>>>>>>>>>>>>>>>//     oSelList is a dbListSub
46607>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46607>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46607>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>// Register all objects
46607>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
46607>>>>>>>>>>>>>>>Register_Object oCancel_bn
46607>>>>>>>>>>>>>>>Register_Object oOK_bn
46607>>>>>>>>>>>>>>>Register_Object oSearch_bn
46607>>>>>>>>>>>>>>>Register_Object oSelList
46607>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
46607>>>>>>>>>>>>>>>Register_Object sl012
46607>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>//AB-IgnoreStart
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>Use DFAllEnt.pkg
46607>>>>>>>>>>>>>>>Use dbList.Sub
46607>>>>>>>>>>>>>>>Use Button.Sub
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>Use CTYPKIN.DD
46607>>>>>>>>>>>>>>>Use WTYPKIN.DD
46607>>>>>>>>>>>>>>>Use PTYPPAR.DD
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>//AB-IgnoreEnd
46607>>>>>>>>>>>>>>>
46607>>>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
46609>>>>>>>>>>>>>>>
46609>>>>>>>>>>>>>>>    //AB-StoreTopStart
46609>>>>>>>>>>>>>>>    Property String psModule Public ''
46611>>>>>>>>>>>>>>>    Property integer pifromclient Public 0
46613>>>>>>>>>>>>>>>    
46613>>>>>>>>>>>>>>>    //AB-StoreTopEnd
46613>>>>>>>>>>>>>>>
46613>>>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
46614>>>>>>>>>>>>>>>    Set Size to 203 490
46615>>>>>>>>>>>>>>>    Set Location to 4 4
46616>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46617>>>>>>>>>>>>>>>    Set Modal_State to FALSE
46618>>>>>>>>>>>>>>>
46618>>>>>>>>>>>>>>>    //AB-DDOStart
46618>>>>>>>>>>>>>>>
46618>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
46620>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
46621>>>>>>>>>>>>>>>
46621>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
46623>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
46624>>>>>>>>>>>>>>>
46624>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
46626>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
46627>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
46628>>>>>>>>>>>>>>>
46628>>>>>>>>>>>>>>>        //AB-StoreStart
46628>>>>>>>>>>>>>>>        
46628>>>>>>>>>>>>>>>        Procedure OnConstrain
46630>>>>>>>>>>>>>>>            Forward Send OnConstrain
46632>>>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
46634>>>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
46636>>>>>>>>>>>>>>>            End
46636>>>>>>>>>>>>>>>>
46636>>>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
46638>>>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
46640>>>>>>>>>>>>>>>            End
46640>>>>>>>>>>>>>>>>
46640>>>>>>>>>>>>>>>        End_Procedure
46641>>>>>>>>>>>>>>>        
46641>>>>>>>>>>>>>>>        
46641>>>>>>>>>>>>>>>        
46641>>>>>>>>>>>>>>>        
46641>>>>>>>>>>>>>>>        //AB-StoreEnd
46641>>>>>>>>>>>>>>>
46641>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
46642>>>>>>>>>>>>>>>
46642>>>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
46643>>>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
46644>>>>>>>>>>>>>>>
46644>>>>>>>>>>>>>>>    //AB-DDOEnd
46644>>>>>>>>>>>>>>>
46644>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
46646>>>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
46647>>>>>>>>>>>>>>>        Set Size to 161 474
46648>>>>>>>>>>>>>>>        Set Location to 6 6
46649>>>>>>>>>>>>>>>
46649>>>>>>>>>>>>>>>        Begin_Row
46652>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
46653>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
46654>>>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
46655>>>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
46656>>>>>>>>>>>>>>>        End_Row
46661>>>>>>>>>>>>>>>
46661>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
46662>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
46663>>>>>>>>>>>>>>>        
46663>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
46664>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46665>>>>>>>>>>>>>>>        
46665>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
46666>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
46667>>>>>>>>>>>>>>>        
46667>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
46668>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
46669>>>>>>>>>>>>>>>        
46669>>>>>>>>>>>>>>>
46669>>>>>>>>>>>>>>>        //AB-StoreStart
46669>>>>>>>>>>>>>>>        
46669>>>>>>>>>>>>>>>        Procedure Activate
46671>>>>>>>>>>>>>>>            Forward Send Activate
46673>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
46674>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
46675>>>>>>>>>>>>>>>        End_Procedure
46676>>>>>>>>>>>>>>>        
46676>>>>>>>>>>>>>>>        //AB-StoreEnd
46676>>>>>>>>>>>>>>>
46676>>>>>>>>>>>>>>>    End_Object    // oSelList
46677>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
46679>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
46680>>>>>>>>>>>>>>>        Set Location to 171 323
46681>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46682>>>>>>>>>>>>>>>
46682>>>>>>>>>>>>>>>        //AB-StoreStart
46682>>>>>>>>>>>>>>>        Procedure OnClick
46684>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
46685>>>>>>>>>>>>>>>        End_Procedure
46686>>>>>>>>>>>>>>>        //AB-StoreEnd
46686>>>>>>>>>>>>>>>
46686>>>>>>>>>>>>>>>    End_Object    // oOK_bn
46687>>>>>>>>>>>>>>>
46687>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
46689>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
46690>>>>>>>>>>>>>>>        Set Location to 171 377
46691>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46692>>>>>>>>>>>>>>>
46692>>>>>>>>>>>>>>>        //AB-StoreStart
46692>>>>>>>>>>>>>>>        Procedure OnClick
46694>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
46695>>>>>>>>>>>>>>>        End_Procedure
46696>>>>>>>>>>>>>>>        //AB-StoreEnd
46696>>>>>>>>>>>>>>>
46696>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
46697>>>>>>>>>>>>>>>
46697>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
46699>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
46700>>>>>>>>>>>>>>>        Set Location to 171 433
46701>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46702>>>>>>>>>>>>>>>
46702>>>>>>>>>>>>>>>        //AB-StoreStart
46702>>>>>>>>>>>>>>>        Procedure OnClick
46704>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
46705>>>>>>>>>>>>>>>        End_Procedure
46706>>>>>>>>>>>>>>>        //AB-StoreEnd
46706>>>>>>>>>>>>>>>
46706>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
46707>>>>>>>>>>>>>>>
46707>>>>>>>>>>>>>>>
46707>>>>>>>>>>>>>>>    //AB-StoreStart
46707>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46708>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46709>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46710>>>>>>>>>>>>>>>    
46710>>>>>>>>>>>>>>>    
46710>>>>>>>>>>>>>>>    //AB-StoreEnd
46710>>>>>>>>>>>>>>>
46710>>>>>>>>>>>>>>>End_Object    // sl012
46711>>>>>>>>>>>>>>>
46711>>>>>>>>>>>>>>>//AB/ End_Object    // prj
46711>>>>>>>>>>>>>
46711>>>>>>>>>>>>>//DDB-Selection-pkg-End
46711>>>>>>>>>>>>>//DDB-FileEnd
46711>>>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
46711>>>>>>>>>>>>>//DDB-FileStart
46711>>>>>>>>>>>>>//DDB-HeaderStart
46711>>>>>>>>>>>>>
46711>>>>>>>>>>>>>// File Name : PSEIRA.DD
46711>>>>>>>>>>>>>// Class Name: Pseira_DataDictionary
46711>>>>>>>>>>>>>// Revision  : 34
46711>>>>>>>>>>>>>// Version   : 2
46711>>>>>>>>>>>>>
46711>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46711>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46711>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46711>>>>>>>>>>>>>
46711>>>>>>>>>>>>>Open Pseira
46713>>>>>>>>>>>>>Open Ptyppar
46715>>>>>>>>>>>>>Open Sysrecp
46717>>>>>>>>>>>>>Open Syscurxr
46719>>>>>>>>>>>>>
46719>>>>>>>>>>>>>//DDB-HeaderEnd
46719>>>>>>>>>>>>>//DDB-SelectionStart
46719>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
46719>>>>>>>>>>>>>Register_Object sl013
46719>>>>>>>>>>>>>//DDB-SelectionEnd
46719>>>>>>>>>>>>>
46719>>>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
46720>>>>>>>>>>>>>
46720>>>>>>>>>>>>>    Procedure Save_Main_File
46721>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46723>>>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
46726>>>>>>>>>>>>>        End
46726>>>>>>>>>>>>>>
46726>>>>>>>>>>>>>        Forward Send Save_Main_File
46728>>>>>>>>>>>>>    End_Procedure
46729>>>>>>>>>>>>>
46729>>>>>>>>>>>>>    Procedure Update
46730>>>>>>>>>>>>>        Forward Send Update
46732>>>>>>>>>>>>>        // Insert Code Here
46732>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
46733>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
46734>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
46735>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
46736>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
46737>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
46738>>>>>>>>>>>>>    End_Procedure   // Update
46739>>>>>>>>>>>>>
46739>>>>>>>>>>>>>
46739>>>>>>>>>>>>>     Procedure Creating
46740>>>>>>>>>>>>>        Forward Send Creating
46742>>>>>>>>>>>>>        // Insert Code Here
46742>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
46743>>>>>>>>>>>>>    End_Procedure   // Creating
46744>>>>>>>>>>>>>
46744>>>>>>>>>>>>>
46744>>>>>>>>>>>>>    // Define_Fields:
46744>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46744>>>>>>>>>>>>>
46744>>>>>>>>>>>>>    Procedure Define_Fields
46745>>>>>>>>>>>>>        Forward Send Define_Fields
46747>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46747>>>>>>>>>>>>>        //DDB-DefineFieldStart
46747>>>>>>>>>>>>>
46747>>>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
46748>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46749>>>>>>>>>>>>>
46749>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46750>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46751>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46752>>>>>>>>>>>>>
46752>>>>>>>>>>>>>        // Parent (Server) file structure...............
46752>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
46753>>>>>>>>>>>>>
46753>>>>>>>>>>>>>        // External (System) file structure.............
46753>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
46754>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46755>>>>>>>>>>>>>
46755>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Field-based properties.......................
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Company_Code
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Branch_Code
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Year_Year
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Ctypkin_Code
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Wtypkin_Code
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Ptyppar_Code
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Ptyppar_Recr
46758>>>>>>>>>>>>>
46758>>>>>>>>>>>>>        // Pseira.Pseira_Seira
46758>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
46759>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
46760>>>>>>>>>>>>>
46760>>>>>>>>>>>>>        // Pseira.Pseira_Rec0
46760>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
46761>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
46762>>>>>>>>>>>>>
46762>>>>>>>>>>>>>        // Pseira.Pseira_Recr
46762>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
46763>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        // Pseira.Pseira_Printer
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        // Pseira.Pseira_Form
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        // Pseira.Pseira_Autonum
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        // Pseira.Autonum_Plus
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        // Pseira.Autonum_Minus
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        // Pseira.Auto_Plus_Last
46764>>>>>>>>>>>>>
46764>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46764>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46765>>>>>>>>>>>>>
46765>>>>>>>>>>>>>    // Field_Defaults:
46765>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46765>>>>>>>>>>>>>
46765>>>>>>>>>>>>>    Procedure Field_Defaults
46766>>>>>>>>>>>>>        Forward Send Field_Defaults
46768>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46768>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46768>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46768>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46769>>>>>>>>>>>>>
46769>>>>>>>>>>>>>End_Class    // Pseira_DataDictionary
46770>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46770>>>>>>>>>>>>>
46770>>>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
46770>>>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
46770>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46770>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
46770>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
46770>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>// Project Object Structure
46770>>>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
46770>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
46770>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46770>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
46770>>>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
46770>>>>>>>>>>>>>>>//     oSelList is a dbListSub
46770>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46770>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46770>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>// Register all objects
46770>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
46770>>>>>>>>>>>>>>>Register_Object oCancel_bn
46770>>>>>>>>>>>>>>>Register_Object oOK_bn
46770>>>>>>>>>>>>>>>Register_Object oSearch_bn
46770>>>>>>>>>>>>>>>Register_Object oSelList
46770>>>>>>>>>>>>>>>Register_Object Pseira_DD
46770>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
46770>>>>>>>>>>>>>>>Register_Object sl013
46770>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>    //AB-IgnoreStart
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
46770>>>>>>>>>>>>>>>    Use dbList.Sub
46770>>>>>>>>>>>>>>>    Use Button.Sub
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>    Use CTYPKIN.DD
46770>>>>>>>>>>>>>>>    Use WTYPKIN.DD
46770>>>>>>>>>>>>>>>    Use PTYPPAR.DD
46770>>>>>>>>>>>>>>>    Use PSEIRA.DD
46770>>>>>>>>>>>>>>>    
46770>>>>>>>>>>>>>>>    //AB-IgnoreEnd
46770>>>>>>>>>>>>>>>
46770>>>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
46772>>>>>>>>>>>>>>>
46772>>>>>>>>>>>>>>>        //AB-StoreTopStart
46772>>>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
46774>>>>>>>>>>>>>>>        
46774>>>>>>>>>>>>>>>        //AB-StoreTopEnd
46774>>>>>>>>>>>>>>>
46774>>>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
46775>>>>>>>>>>>>>>>        Set Size to 148 214
46776>>>>>>>>>>>>>>>        Set Location to 1 7
46777>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46778>>>>>>>>>>>>>>>        Set Modal_State to FALSE
46779>>>>>>>>>>>>>>>
46779>>>>>>>>>>>>>>>        //AB-DDOStart
46779>>>>>>>>>>>>>>>
46779>>>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
46781>>>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
46782>>>>>>>>>>>>>>>
46782>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
46784>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
46785>>>>>>>>>>>>>>>
46785>>>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
46787>>>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
46788>>>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
46789>>>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
46790>>>>>>>>>>>>>>>
46790>>>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
46792>>>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
46793>>>>>>>>>>>>>>>
46793>>>>>>>>>>>>>>>            //AB-StoreStart
46793>>>>>>>>>>>>>>>            Procedure OnConstrain
46795>>>>>>>>>>>>>>>                String sID
46796>>>>>>>>>>>>>>>                Forward Send OnConstrain
46798>>>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
46799>>>>>>>>>>>>>>>                Move (trim(sID)) to sID
46800>>>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
46804>>>>>>>>>>>>>>>            End_procedure
46805>>>>>>>>>>>>>>>            
46805>>>>>>>>>>>>>>>            //AB-StoreEnd
46805>>>>>>>>>>>>>>>
46805>>>>>>>>>>>>>>>        End_Object    // Pseira_DD
46806>>>>>>>>>>>>>>>
46806>>>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
46807>>>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
46808>>>>>>>>>>>>>>>
46808>>>>>>>>>>>>>>>        //AB-DDOEnd
46808>>>>>>>>>>>>>>>
46808>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
46810>>>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
46811>>>>>>>>>>>>>>>            Set Size to 105 197
46812>>>>>>>>>>>>>>>            Set Location to 6 6
46813>>>>>>>>>>>>>>>
46813>>>>>>>>>>>>>>>            Begin_Row
46816>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
46817>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
46818>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
46819>>>>>>>>>>>>>>>            End_Row
46824>>>>>>>>>>>>>>>
46824>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
46825>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
46826>>>>>>>>>>>>>>>            
46826>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
46827>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
46828>>>>>>>>>>>>>>>            
46828>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
46829>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
46830>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
46831>>>>>>>>>>>>>>>            
46831>>>>>>>>>>>>>>>
46831>>>>>>>>>>>>>>>            //AB-StoreStart
46831>>>>>>>>>>>>>>>                    
46831>>>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
46833>>>>>>>>>>>>>>>            
46833>>>>>>>>>>>>>>>            Procedure Store_Defaults
46835>>>>>>>>>>>>>>>                   Forward Send Store_Defaults
46837>>>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
46838>>>>>>>>>>>>>>>            End_Procedure
46839>>>>>>>>>>>>>>>            
46839>>>>>>>>>>>>>>>            Procedure ReStore_Defaults
46841>>>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
46843>>>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
46844>>>>>>>>>>>>>>>            End_Procedure
46845>>>>>>>>>>>>>>>            
46845>>>>>>>>>>>>>>>            Procedure Activating
46847>>>>>>>>>>>>>>>                Forward Send Activating
46849>>>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
46850>>>>>>>>>>>>>>>            End_Procedure
46851>>>>>>>>>>>>>>>            
46851>>>>>>>>>>>>>>>            
46851>>>>>>>>>>>>>>>            //AB-StoreEnd
46851>>>>>>>>>>>>>>>
46851>>>>>>>>>>>>>>>        End_Object    // oSelList
46852>>>>>>>>>>>>>>>
46852>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46854>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46855>>>>>>>>>>>>>>>            Set Location to 114 42
46856>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46857>>>>>>>>>>>>>>>
46857>>>>>>>>>>>>>>>            //AB-StoreStart
46857>>>>>>>>>>>>>>>            Procedure OnClick
46859>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46860>>>>>>>>>>>>>>>            End_Procedure
46861>>>>>>>>>>>>>>>            //AB-StoreEnd
46861>>>>>>>>>>>>>>>
46861>>>>>>>>>>>>>>>        End_Object    // oOK_bn
46862>>>>>>>>>>>>>>>
46862>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46864>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46865>>>>>>>>>>>>>>>            Set Location to 114 98
46866>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46867>>>>>>>>>>>>>>>
46867>>>>>>>>>>>>>>>            //AB-StoreStart
46867>>>>>>>>>>>>>>>            Procedure OnClick
46869>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46870>>>>>>>>>>>>>>>            End_Procedure
46871>>>>>>>>>>>>>>>            //AB-StoreEnd
46871>>>>>>>>>>>>>>>
46871>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
46872>>>>>>>>>>>>>>>
46872>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46874>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
46875>>>>>>>>>>>>>>>            Set Location to 114 153
46876>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46877>>>>>>>>>>>>>>>
46877>>>>>>>>>>>>>>>            //AB-StoreStart
46877>>>>>>>>>>>>>>>            Procedure OnClick
46879>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46880>>>>>>>>>>>>>>>            End_Procedure
46881>>>>>>>>>>>>>>>            //AB-StoreEnd
46881>>>>>>>>>>>>>>>
46881>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
46882>>>>>>>>>>>>>>>
46882>>>>>>>>>>>>>>>
46882>>>>>>>>>>>>>>>        //AB-StoreStart
46882>>>>>>>>>>>>>>>            
46882>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46883>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46884>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        
46885>>>>>>>>>>>>>>>        //AB-StoreEnd
46885>>>>>>>>>>>>>>>
46885>>>>>>>>>>>>>>>    End_Object    // sl013
46886>>>>>>>>>>>>>>>
46886>>>>>>>>>>>>>>>//AB/     End_Object    // prj
46886>>>>>>>>>>>>>
46886>>>>>>>>>>>>>//DDB-Selection-pkg-End
46886>>>>>>>>>>>>>//DDB-FileEnd
46886>>>>>>>>>>>    Use NOMISMA.DD
46886>>>>>>>>>>>    Use COUNTRY.DD
46886>>>>>>>>>>>    Use TOWNS.DD
46886>>>>>>>>>>>    Use CITIES.DD
46886>>>>>>>>>>>    Use PAYRESP.DD
46886>>>>>>>>>>>    Use AREAS.DD
46886>>>>>>>>>>>    Use CLIENTS.DD
46886>>>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
46886>>>>>>>>>>>>>//DDB-FileStart
46886>>>>>>>>>>>>>//DDB-HeaderStart
46886>>>>>>>>>>>>>
46886>>>>>>>>>>>>>// File Name : PARTICLE.DD
46886>>>>>>>>>>>>>// Class Name: Particle_DataDictionary
46886>>>>>>>>>>>>>// Revision  : 262
46886>>>>>>>>>>>>>// Version   : 2
46886>>>>>>>>>>>>>
46886>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46886>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46886>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46886>>>>>>>>>>>>>
46886>>>>>>>>>>>>>Open Particle
46888>>>>>>>>>>>>>Open Pmoves
46890>>>>>>>>>>>>>Open Tparticl
46892>>>>>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
46894>>>>>>>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
46896>>>>>>>>>>>>>Open Psxetika
46898>>>>>>>>>>>>>Open Clients
46900>>>>>>>>>>>>>Open Ptyppar
46902>>>>>>>>>>>>>Open Nomisma
46904>>>>>>>>>>>>>Open Sysrecp
46906>>>>>>>>>>>>>Open Syscurxr
46908>>>>>>>>>>>>>Open Pseira
46910>>>>>>>>>>>>>Open Cn
46912>>>>>>>>>>>>>Open Partlfpa
46914>>>>>>>>>>>>>Open Clorder
46916>>>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
46918>>>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
46920>>>>>>>>>>>>>Open Psxetika
46922>>>>>>>>>>>>>Open Pmoves
46924>>>>>>>>>>>>>Open Gmove
46926>>>>>>>>>>>>>Open Sysrecg
46928>>>>>>>>>>>>>
46928>>>>>>>>>>>>>//DDB-HeaderEnd
46928>>>>>>>>>>>>>//DDB-ValidationStart
46928>>>>>>>>>>>>>
46928>>>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
46928>>>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
46928>>>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
46928>>>>>>>>>>>>>
46928>>>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
46930>>>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
46931>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46932>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46932>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46932>>>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
46933>>>>>>>>>>>>>
46933>>>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
46935>>>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
46936>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46937>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46937>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46937>>>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
46938>>>>>>>>>>>>>
46938>>>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
46940>>>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
46941>>>>>>>>>>>>>    Set Validate_State    To FALSE
46942>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46943>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46943>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46943>>>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
46944>>>>>>>>>>>>>//DDB-ValidationEnd
46944>>>>>>>>>>>>>//DDB-SelectionStart
46944>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46944>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
46944>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
46944>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
46944>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
46944>>>>>>>>>>>>>Register_Object sl041
46944>>>>>>>>>>>>>Register_Object sl014
46944>>>>>>>>>>>>>Register_Object sl054
46944>>>>>>>>>>>>>Register_Object sl053
46944>>>>>>>>>>>>>Register_Object sl064
46944>>>>>>>>>>>>>//DDB-SelectionEnd
46944>>>>>>>>>>>>>
46944>>>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
46944>>>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
46944>>>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
46944>>>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
46944>>>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
46944>>>>>>>>>>>>>//    Set Ordering            to  1
46944>>>>>>>>>>>>>//    Set Static_State to False
46944>>>>>>>>>>>>>//End_Object
46944>>>>>>>>>>>>>
46944>>>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
46946>>>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
46948>>>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
46950>>>>>>>>>>>>>Open SysCurXr
46952>>>>>>>>>>>>>
46952>>>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
46953>>>>>>>>>>>>>
46953>>>>>>>>>>>>>    Function fsVresCNDescr String asCNCode Returns String
46954>>>>>>>>>>>>>        String rVal
46955>>>>>>>>>>>>>        Clear CN
46956>>>>>>>>>>>>>        Move asCNCode            to Cn.Cn_Code
46957>>>>>>>>>>>>>        Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
46958>>>>>>>>>>>>>>
46958>>>>>>>>>>>>>        If (Found) Move (Trim(CN.CN_Descr)) to rVal
46961>>>>>>>>>>>>>        Else Move '' to rVal
46963>>>>>>>>>>>>>        Function_Return rVal
46964>>>>>>>>>>>>>    End_Function
46965>>>>>>>>>>>>>
46965>>>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
46966>>>>>>>>>>>>>        String rVal
46967>>>>>>>>>>>>>        Clear Pumps
46968>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
46969>>>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
46970>>>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
46971>>>>>>>>>>>>>>
46971>>>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
46974>>>>>>>>>>>>>        Else Move '' to rVal
46976>>>>>>>>>>>>>        Function_Return rVal
46977>>>>>>>>>>>>>    End_Function
46978>>>>>>>>>>>>>
46978>>>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
46979>>>>>>>>>>>>>        String rVal
46980>>>>>>>>>>>>>        Clear Cars
46981>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
46982>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
46983>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
46984>>>>>>>>>>>>>>
46984>>>>>>>>>>>>>
46984>>>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
46987>>>>>>>>>>>>>        Else Move '' to rVal
46989>>>>>>>>>>>>>        Function_Return rVal
46990>>>>>>>>>>>>>    End_Function
46991>>>>>>>>>>>>>
46991>>>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
46992>>>>>>>>>>>>>        String rVal
46993>>>>>>>>>>>>>        Clear Cars
46994>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
46995>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
46996>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
46997>>>>>>>>>>>>>>
46997>>>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
47000>>>>>>>>>>>>>        Else        Move '' to rVal
47002>>>>>>>>>>>>>        Function_Return rVal
47003>>>>>>>>>>>>>    End_Function
47004>>>>>>>>>>>>>
47004>>>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
47005>>>>>>>>>>>>>        String rVal
47006>>>>>>>>>>>>>        Clear Drivers
47007>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
47008>>>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
47009>>>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
47010>>>>>>>>>>>>>>
47010>>>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
47013>>>>>>>>>>>>>        Else Move '' to rVal
47015>>>>>>>>>>>>>        Function_Return rVal
47016>>>>>>>>>>>>>    End_Function
47017>>>>>>>>>>>>>
47017>>>>>>>>>>>>>    Procedure Construct_Object
47018>>>>>>>>>>>>>        Forward Send Construct_Object
47020>>>>>>>>>>>>>        Property String     psOldCode       Public ''
47021>>>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
47022>>>>>>>>>>>>>        Property String     psOldUserID     Public ''
47023>>>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
47024>>>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0 
47025>>>>>>>>>>>>>        Property Integer    PifromBhma1     Public  0 
47026>>>>>>>>>>>>>        //------------------------------------------------
47026>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47026>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
47026>>>>>>>>>>>>>        // einai 1     js 03/12/2007
47026>>>>>>>>>>>>>        //------------------------------------------------  
47026>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
47027>>>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
47028>>>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
47029>>>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
47030>>>>>>>>>>>>>        Property String  psAud_Old_ErgoDescr    Public ""
47031>>>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
47032>>>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
47033>>>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
47034>>>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
47035>>>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
47036>>>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
47037>>>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
47038>>>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
47039>>>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
47040>>>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0     
47041>>>>>>>>>>>>>        Property String  psAud_Old_Ektyposh     Public "" 
47042>>>>>>>>>>>>>        Property Integer piAud_Old_Timol        Public  0
47043>>>>>>>>>>>>>        Property Date    pdAud_Old_SapHmnia     Public ""
47044>>>>>>>>>>>>>        //------------------------------------------------
47044>>>>>>>>>>>>>    End_procedure
47045>>>>>>>>>>>>> 
47045>>>>>>>>>>>>> 
47045>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
47046>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
47048>>>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
47049>>>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
47050>>>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
47051>>>>>>>>>>>>>        //------------------------------------------------
47051>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47051>>>>>>>>>>>>>        // ton pedion js 03/12/2007
47051>>>>>>>>>>>>>        //------------------------------------------------
47051>>>>>>>>>>>>>        Set psAud_Old_Pelaths       to Particle.Client_ID
47052>>>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
47053>>>>>>>>>>>>>        Set psAud_Old_Ergo          to Particle.CN_Code     
47054>>>>>>>>>>>>>        Set psAud_Old_ErgoDescr     to (fsVresCNDescr(Self,Particle.CN_Code))
47055>>>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Particle.Partl_Recr 
47056>>>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Particle.Partl_Recr 
47057>>>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
47058>>>>>>>>>>>>>        Set psAud_Old_Zonh          to Particle.Zone_ID
47059>>>>>>>>>>>>>        Set psAud_Old_Antlia        to Particle.Antlia_code
47060>>>>>>>>>>>>>        Set psAud_Old_Oxhma         to Particle.Oxhma_code
47061>>>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
47062>>>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
47063>>>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
47064>>>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No    
47065>>>>>>>>>>>>>        Set psAud_Old_Ektyposh      to Particle.Partl_Ektyposh 
47066>>>>>>>>>>>>>        Set piAud_Old_Timol         to Particle.Partl_Timol
47067>>>>>>>>>>>>>        Set pdAud_Old_SapHmnia      to Particle.Sap_hmnia
47068>>>>>>>>>>>>>
47068>>>>>>>>>>>>>        
47068>>>>>>>>>>>>>        //------------------------------------------------
47068>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
47069>>>>>>>>>>>>>
47069>>>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
47070>>>>>>>>>>>>>        Local Integer Changed
47071>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
47072>>>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
47074>>>>>>>>>>>>>            SysDate4 dDate
47075>>>>>>>>>>>>>            Set Field_Default_Value iField to dDate
47076>>>>>>>>>>>>>        End
47076>>>>>>>>>>>>>>
47076>>>>>>>>>>>>>    End_Procedure   // Shmera
47077>>>>>>>>>>>>>
47077>>>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
47078>>>>>>>>>>>>>        Local Integer Changed
47079>>>>>>>>>>>>>        Date dDate
47079>>>>>>>>>>>>>        Number nHour nMin
47079>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
47080>>>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
47082>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
47085>>>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
47086>>>>>>>>>>>>>        End
47086>>>>>>>>>>>>>>
47086>>>>>>>>>>>>>    End_Procedure   // Shmera
47087>>>>>>>>>>>>>
47087>>>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
47088>>>>>>>>>>>>>        Local Integer Changed
47089>>>>>>>>>>>>>        Date dDate
47089>>>>>>>>>>>>>        Number nHour nMin nTotal
47089>>>>>>>>>>>>>        String sOra sMin
47089>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
47090>>>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
47092>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
47095>>>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
47096>>>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
47097>>>>>>>>>>>>>        End
47097>>>>>>>>>>>>>>
47097>>>>>>>>>>>>>    End_Procedure   // Shmera
47098>>>>>>>>>>>>>
47098>>>>>>>>>>>>>    Procedure Save_Main_File
47099>>>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
47100>>>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
47100>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
47100>>>>>>>>>>>>>        Date    dHmnia
47100>>>>>>>>>>>>>
47100>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
47103>>>>>>>>>>>>>
47103>>>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
47105>>>>>>>>>>>>>            Clear Cn
47106>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
47107>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
47108>>>>>>>>>>>>>>
47108>>>>>>>>>>>>>            If (Found) Begin
47110>>>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
47111>>>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
47112>>>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
47113>>>>>>>>>>>>>            End
47113>>>>>>>>>>>>>>
47113>>>>>>>>>>>>>            Else Begin
47114>>>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
47115>>>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
47116>>>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
47117>>>>>>>>>>>>>            End
47117>>>>>>>>>>>>>>
47117>>>>>>>>>>>>>        End
47117>>>>>>>>>>>>>>
47117>>>>>>>>>>>>>        Else Begin
47118>>>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
47119>>>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
47120>>>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
47121>>>>>>>>>>>>>        End
47121>>>>>>>>>>>>>>
47121>>>>>>>>>>>>>
47121>>>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
47122>>>>>>>>>>>>>
47122>>>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
47123>>>>>>>>>>>>>        Get piOldSelected               to iOldSelected
47124>>>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
47125>>>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
47126>>>>>>>>>>>>>
47126>>>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
47128>>>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
47131>>>>>>>>>>>>>        End
47131>>>>>>>>>>>>>>
47131>>>>>>>>>>>>>        Else Begin
47132>>>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
47133>>>>>>>>>>>>>        End
47133>>>>>>>>>>>>>>
47133>>>>>>>>>>>>>
47133>>>>>>>>>>>>>        Move 0 to nPosothtaKin
47134>>>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
47136>>>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
47138>>>>>>>>>>>>>                If (iSelected) Begin
47140>>>>>>>>>>>>>                    Clear Pmoves
47141>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
47142>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
47143>>>>>>>>>>>>>>
47143>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
47147>>>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
47148>>>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
47149>>>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
47150>>>>>>>>>>>>>                        Saverecord Pmoves
47151>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
47152>>>>>>>>>>>>>>
47152>>>>>>>>>>>>>                    Loop
47153>>>>>>>>>>>>>>
47153>>>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
47154>>>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
47155>>>>>>>>>>>>>                End
47155>>>>>>>>>>>>>>
47155>>>>>>>>>>>>>                Else Begin
47156>>>>>>>>>>>>>                    Clear Pmoves
47157>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
47158>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
47159>>>>>>>>>>>>>>
47159>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
47163>>>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
47164>>>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
47165>>>>>>>>>>>>>                        Saverecord Pmoves
47166>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
47167>>>>>>>>>>>>>>
47167>>>>>>>>>>>>>                    Loop
47168>>>>>>>>>>>>>>
47168>>>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
47169>>>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
47170>>>>>>>>>>>>>                End
47170>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>
47170>>>>>>>>>>>>>//                // js 11/04/2003
47170>>>>>>>>>>>>>//                If (iPmoves) Begin
47170>>>>>>>>>>>>>//                    Clear Pmoves
47170>>>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
47170>>>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
47170>>>>>>>>>>>>>//                End
47170>>>>>>>>>>>>>
47170>>>>>>>>>>>>>            End
47170>>>>>>>>>>>>>>
47170>>>>>>>>>>>>>            Set piFromMetasx to 0
47171>>>>>>>>>>>>>        End
47171>>>>>>>>>>>>>>
47171>>>>>>>>>>>>>
47171>>>>>>>>>>>>>        Forward Send Save_Main_File
47173>>>>>>>>>>>>>
47173>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
47174>>>>>>>>>>>>>
47174>>>>>>>>>>>>>
47174>>>>>>>>>>>>>    Procedure Calc_The_Totals
47175>>>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
47176>>>>>>>>>>>>>
47176>>>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
47177>>>>>>>>>>>>>
47177>>>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
47178>>>>>>>>>>>>>
47178>>>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
47179>>>>>>>>>>>>>
47179>>>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
47181>>>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
47182>>>>>>>>>>>>>        End
47182>>>>>>>>>>>>>>
47182>>>>>>>>>>>>>
47182>>>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
47184>>>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
47185>>>>>>>>>>>>>        End
47185>>>>>>>>>>>>>>
47185>>>>>>>>>>>>>
47185>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47185>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47185>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47185>>>>>>>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
47187>>>>>>>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
47188>>>>>>>>>>>>>        End
47188>>>>>>>>>>>>>>
47188>>>>>>>>>>>>>        Else Begin
47189>>>>>>>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
47192>>>>>>>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
47194>>>>>>>>>>>>>        End
47194>>>>>>>>>>>>>>
47194>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47194>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47194>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47194>>>>>>>>>>>>>
47194>>>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
47195>>>>>>>>>>>>>
47195>>>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
47197>>>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
47198>>>>>>>>>>>>>
47198>>>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
47199>>>>>>>>>>>>>
47199>>>>>>>>>>>>>        End
47199>>>>>>>>>>>>>>
47199>>>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
47201>>>>>>>>>>>>>
47201>>>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
47202>>>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
47203>>>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
47204>>>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
47205>>>>>>>>>>>>>    End_Procedure
47206>>>>>>>>>>>>>
47206>>>>>>>>>>>>>    Procedure Find_The_Rate
47207>>>>>>>>>>>>>        String  sCode sWhat
47208>>>>>>>>>>>>>        Integer iRateID
47208>>>>>>>>>>>>>        Number nEuro nIsot nRate
47208>>>>>>>>>>>>>        Date dHmnia
47208>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
47209>>>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
47212>>>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
47213>>>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
47214>>>>>>>>>>>>>        If (nIsot=0) Begin
47216>>>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
47219>>>>>>>>>>>>>            Move (Trim(sCode)) to sCode
47220>>>>>>>>>>>>>            Clear Isotimia
47221>>>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
47222>>>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
47223>>>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
47224>>>>>>>>>>>>>>
47224>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
47227>>>>>>>>>>>>>            Else Begin
47228>>>>>>>>>>>>>                Case Begin
47228>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
47230>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
47231>>>>>>>>>>>>>                        Case Break
47232>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
47235>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
47236>>>>>>>>>>>>>                        Case Break
47237>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
47240>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
47241>>>>>>>>>>>>>                        Case Break
47242>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
47245>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
47246>>>>>>>>>>>>>                        Case Break
47247>>>>>>>>>>>>>                Case End
47247>>>>>>>>>>>>>            End
47247>>>>>>>>>>>>>>
47247>>>>>>>>>>>>>        End
47247>>>>>>>>>>>>>>
47247>>>>>>>>>>>>>        Else Begin
47248>>>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
47251>>>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
47252>>>>>>>>>>>>>            Clear Nomisma
47253>>>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
47254>>>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47255>>>>>>>>>>>>>>
47255>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
47258>>>>>>>>>>>>>        End
47258>>>>>>>>>>>>>>
47258>>>>>>>>>>>>>    End_Procedure
47259>>>>>>>>>>>>>
47259>>>>>>>>>>>>>    Procedure Update
47260>>>>>>>>>>>>>        String  sCodeApo sCodeEos
47261>>>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
47261>>>>>>>>>>>>>        Integer iBreak iPmovesID
47261>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
47261>>>>>>>>>>>>>        Date    dHmnia
47261>>>>>>>>>>>>>
47261>>>>>>>>>>>>>        Forward Send Update
47263>>>>>>>>>>>>>
47263>>>>>>>>>>>>>        Send Find_The_Rate
47264>>>>>>>>>>>>>
47264>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
47265>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
47266>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
47267>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
47268>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
47269>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
47269>>>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
47270>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
47271>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
47272>>>>>>>>>>>>>
47272>>>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
47273>>>>>>>>>>>>>
47273>>>>>>>>>>>>>        Send Calc_The_Totals
47274>>>>>>>>>>>>>
47274>>>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
47275>>>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
47276>>>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
47277>>>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
47278>>>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
47279>>>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
47280>>>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
47281>>>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
47282>>>>>>>>>>>>>
47282>>>>>>>>>>>>>
47282>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47282>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47282>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47282>>>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
47282>>>>>>>>>>>>>//            Clear PartlFpa
47282>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47282>>>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
47282>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47282>>>>>>>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
47282>>>>>>>>>>>>>//            Saverecord PartlFpa
47282>>>>>>>>>>>>>//        End
47282>>>>>>>>>>>>>
47282>>>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
47282>>>>>>>>>>>>>//            Clear PartlFpa
47282>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47282>>>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
47282>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47282>>>>>>>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
47282>>>>>>>>>>>>>//            Saverecord PartlFpa
47282>>>>>>>>>>>>>//        End
47282>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47282>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47282>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47282>>>>>>>>>>>>>
47282>>>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
47282>>>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
47282>>>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
47282>>>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
47282>>>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
47282>>>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
47282>>>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
47285>>>>>>>>>>>>>        // 01/10/2001
47285>>>>>>>>>>>>>
47285>>>>>>>>>>>>>
47285>>>>>>>>>>>>>        //---------------------------------------------
47285>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
47285>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47285>>>>>>>>>>>>>            //MODE_WAITING  
47285>>>>>>>>>>>>>            //MODE_FINDING  
47285>>>>>>>>>>>>>            //MODE_CLEARING 
47285>>>>>>>>>>>>>            //MODE_CREATING 
47285>>>>>>>>>>>>>            //MODE_SAVING   
47285>>>>>>>>>>>>>            //MODE_DELETING 
47285>>>>>>>>>>>>>            //MODE_ABORTING 
47285>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47285>>>>>>>>>>>>>        Date    dDate  Shmer 
47285>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
47285>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47289>>>>>>>>>>>>>        Move iHour  to sHour
47290>>>>>>>>>>>>>        Move iMin   to sMin
47291>>>>>>>>>>>>>        Move iSec   to sSec
47292>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47296>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47300>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47304>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47305>>>>>>>>>>>>>        
47305>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
47305>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
47307>>>>>>>>>>>>>            Get fsLoginUserID to sUser
47308>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
47310>>>>>>>>>>>>>                clear gmove
47311>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
47312>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
47313>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
47314>>>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
47315>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
47316>>>>>>>>>>>>>                move Particle.partl_no      to gmove.garticl_no
47317>>>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
47318>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
47319>>>>>>>>>>>>>                move Particle.Partl_Recr    to gmove.garticl_recr
47320>>>>>>>>>>>>>                reread sysrecg
47324>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47325>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47326>>>>>>>>>>>>>                saverecord sysrecg
47327>>>>>>>>>>>>>                unlock
47328>>>>>>>>>>>>>>
47328>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
47329>>>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
47330>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
47331>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
47332>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
47333>>>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
47334>>>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
47335>>>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
47336>>>>>>>>>>>>>                Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                    to gmove.Cur_CN_Addr 
47337>>>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47338>>>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Pms_Recr  
47339>>>>>>>>>>>>>                Move Particle.Zone_ID               to Gmove.Cur_Zonh
47340>>>>>>>>>>>>>                Move Particle.Antlia_code           to Gmove.Cur_Antlia
47341>>>>>>>>>>>>>                Move Particle.Oxhma_code            to Gmove.Cur_Oxhma       
47342>>>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
47343>>>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
47344>>>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
47345>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ §˜¨˜©«˜« ¡¦ç" to sText
47346>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
47347>>>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
47348>>>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
47349>>>>>>>>>>>>>                saverecord gmove
47350>>>>>>>>>>>>>                Set piCreateNew to 0
47351>>>>>>>>>>>>>            End
47351>>>>>>>>>>>>>>
47351>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
47354>>>>>>>>>>>>>                Integer isChanged
47354>>>>>>>>>>>>>                Move 0 to isChanged
47355>>>>>>>>>>>>>                
47355>>>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths (Self))<>Trim(Clients.Client_ID      ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Particle.CN_Code    ))) Move 1 to isChanged    
47358>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh    (Self))<>Trim(Particle.Zone_ID       ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Particle.Antlia_code))) Move 1 to isChanged   
47362>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma   (Self))<>Trim(Particle.Oxhma_code    ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
47366>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira   (Self))<>Trim(Particle.Pseira_Seira  ))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
47370>>>>>>>>>>>>>                Else If  (piAud_Old_No           (Self) <>Particle.Partl_No)                                                                                 Move 1 to isChanged
47374>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh))   Or  (piAud_Old_Timol(Self)<>Particle.Partl_Timol               )) Move 1 to isChanged  
47378>>>>>>>>>>>>>                Else If  (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia) Move 1 to isChanged
47382>>>>>>>>>>>>>
47382>>>>>>>>>>>>>                If (isChanged>0) Begin  
47384>>>>>>>>>>>>>                    clear gmove
47385>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
47386>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
47387>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
47388>>>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
47389>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
47390>>>>>>>>>>>>>                    move Particle.partl_no      to gmove.garticl_no
47391>>>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
47392>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
47393>>>>>>>>>>>>>                    move Particle.Partl_Recr    to gmove.garticl_recr
47394>>>>>>>>>>>>>                    reread sysrecg
47398>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47399>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47400>>>>>>>>>>>>>                    saverecord sysrecg
47401>>>>>>>>>>>>>                    unlock
47402>>>>>>>>>>>>>>
47402>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
47403>>>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
47404>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
47405>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
47406>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
47407>>>>>>>>>>>>>                    //--
47407>>>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47408>>>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Pms_Recr  
47409>>>>>>>>>>>>>                    //--
47409>>>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
47410>>>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
47411>>>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
47412>>>>>>>>>>>>>                    Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                        to gmove.Cur_CN_Addr 
47413>>>>>>>>>>>>>                    Move (Trim(Particle.Zone_ID     ))  to Gmove.Cur_Zonh
47414>>>>>>>>>>>>>                    Move (Trim(Particle.Antlia_code ))  to Gmove.Cur_Antlia
47415>>>>>>>>>>>>>                    Move (Trim(Particle.Oxhma_code  ))  to Gmove.Cur_Oxhma       
47416>>>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
47417>>>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
47418>>>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
47419>>>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No     
47420>>>>>>>>>>>>>                    Move Particle.Sap_hmnia             to Gmove.Date1
47421>>>>>>>>>>>>>                    //--
47421>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
47422>>>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
47423>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
47424>>>>>>>>>>>>>                    Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                          to gmove.Prev_CN_Addr 
47425>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
47426>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
47427>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
47428>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
47429>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
47430>>>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
47431>>>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
47432>>>>>>>>>>>>>                    Move (pdAud_Old_SapHmnia     (Self )) to gmove.Date2 
47433>>>>>>>>>>>>>                    
47433>>>>>>>>>>>>>                    //--  
47433>>>>>>>>>>>>>                    If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh)) Or (piAud_Old_Timol(Self)<>Particle.Partl_Timol) Or ;                        (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia)) Move "€¤¦ š£˜ ˜¨˜©«˜« ¡¦ç - BACK DOOR"    to sText 
47436>>>>>>>>>>>>>                    Else Move "ƒ æ¨Ÿà©ž ˜¨˜©«˜« ¡¦ç"               to sText 
47438>>>>>>>>>>>>>                    
47438>>>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
47439>>>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
47440>>>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
47441>>>>>>>>>>>>>                    saverecord gmove
47442>>>>>>>>>>>>>                    Set piCreateNew to 0
47443>>>>>>>>>>>>>                End
47443>>>>>>>>>>>>>>
47443>>>>>>>>>>>>>            End
47443>>>>>>>>>>>>>>
47443>>>>>>>>>>>>>        End
47443>>>>>>>>>>>>>>
47443>>>>>>>>>>>>>
47443>>>>>>>>>>>>>
47443>>>>>>>>>>>>>    End_Procedure   // Update
47444>>>>>>>>>>>>>
47444>>>>>>>>>>>>>    Procedure Delete_Main_File
47445>>>>>>>>>>>>>        //---------------------------------------------
47445>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
47445>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47445>>>>>>>>>>>>>            //MODE_WAITING  
47445>>>>>>>>>>>>>            //MODE_FINDING  
47445>>>>>>>>>>>>>            //MODE_CLEARING 
47445>>>>>>>>>>>>>            //MODE_CREATING 
47445>>>>>>>>>>>>>            //MODE_SAVING   
47445>>>>>>>>>>>>>            //MODE_DELETING 
47445>>>>>>>>>>>>>            //MODE_ABORTING 
47445>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47446>>>>>>>>>>>>>        Date    dDate  Shmer 
47446>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
47446>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47450>>>>>>>>>>>>>        Move iHour  to sHour
47451>>>>>>>>>>>>>        Move iMin   to sMin
47452>>>>>>>>>>>>>        Move iSec   to sSec
47453>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47457>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47461>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47465>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47466>>>>>>>>>>>>>        
47466>>>>>>>>>>>>>        // Auditing / Diagrafh 
47466>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
47468>>>>>>>>>>>>>            Get fsLoginUserID to sUser
47469>>>>>>>>>>>>>
47469>>>>>>>>>>>>>            clear gmove
47470>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
47471>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
47472>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
47473>>>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
47474>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
47475>>>>>>>>>>>>>            move Particle.partl_no      to gmove.garticl_no
47476>>>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
47477>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
47478>>>>>>>>>>>>>            move Particle.Partl_Recr    to gmove.garticl_recr
47479>>>>>>>>>>>>>            reread sysrecg
47483>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47484>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47485>>>>>>>>>>>>>            saverecord sysrecg
47486>>>>>>>>>>>>>            unlock
47487>>>>>>>>>>>>>>
47487>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
47488>>>>>>>>>>>>>
47488>>>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
47489>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
47490>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
47491>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
47492>>>>>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
47493>>>>>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
47494>>>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
47495>>>>>>>>>>>>>            Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                to gmove.Prev_CN_Addr 
47496>>>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
47497>>>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
47498>>>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
47499>>>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
47500>>>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
47501>>>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
47502>>>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
47503>>>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
47504>>>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
47505>>>>>>>>>>>>>            Move (pdAud_Old_SapHmnia (Self ))   to gmove.Date2 
47506>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã ˜¨˜©«˜« ¡¦ç" to sText
47507>>>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
47508>>>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
47509>>>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
47510>>>>>>>>>>>>>            saverecord gmove
47511>>>>>>>>>>>>>        End
47511>>>>>>>>>>>>>>
47511>>>>>>>>>>>>>
47511>>>>>>>>>>>>>        Forward Send Delete_Main_File
47513>>>>>>>>>>>>>
47513>>>>>>>>>>>>>    End_Procedure
47514>>>>>>>>>>>>>
47514>>>>>>>>>>>>>    Procedure Backout
47515>>>>>>>>>>>>>        Forward Send Backout
47517>>>>>>>>>>>>>        Send Calc_The_Totals
47518>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47518>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47518>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47518>>>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
47518>>>>>>>>>>>>>//            Clear PartlFpa
47518>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47518>>>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
47518>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47518>>>>>>>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
47518>>>>>>>>>>>>>//            Saverecord PartlFpa
47518>>>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
47518>>>>>>>>>>>>>//        End
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
47518>>>>>>>>>>>>>//            Clear PartlFpa
47518>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47518>>>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
47518>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47518>>>>>>>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
47518>>>>>>>>>>>>>//            Saverecord PartlFpa
47518>>>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
47518>>>>>>>>>>>>>//        End
47518>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47518>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47518>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>
47518>>>>>>>>>>>>>    End_Procedure
47519>>>>>>>>>>>>>
47519>>>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
47520>>>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
47521>>>>>>>>>>>>>
47521>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
47521>>>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
47523>>>>>>>>>>>>>            Clear Pseira
47524>>>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
47525>>>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
47526>>>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
47526>>>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
47526>>>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
47526>>>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
47527>>>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
47528>>>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
47529>>>>>>>>>>>>>>
47529>>>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
47529>>>>>>>>>>>>>            If (Found=1) Begin
47531>>>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
47531>>>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
47533>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
47534>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
47535>>>>>>>>>>>>>                    Saverecord Pseira
47536>>>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
47537>>>>>>>>>>>>>                End
47537>>>>>>>>>>>>>>
47537>>>>>>>>>>>>>            End
47537>>>>>>>>>>>>>>
47537>>>>>>>>>>>>>        End
47537>>>>>>>>>>>>>>
47537>>>>>>>>>>>>>        Else Begin
47538>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
47538>>>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
47540>>>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
47541>>>>>>>>>>>>>            End
47541>>>>>>>>>>>>>>
47541>>>>>>>>>>>>>        End
47541>>>>>>>>>>>>>>
47541>>>>>>>>>>>>>    End_Procedure
47542>>>>>>>>>>>>>
47542>>>>>>>>>>>>>    Procedure Creating
47543>>>>>>>>>>>>>        Integer iNextNo
47544>>>>>>>>>>>>>        String  sNo sSeira
47544>>>>>>>>>>>>>        Forward Send Creating
47546>>>>>>>>>>>>>        // Insert Code Here
47546>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
47547>>>>>>>>>>>>>
47547>>>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 19 to Particle.Disc_Vat_Pct
47550>>>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 19 to Particle.Partl_ExtraVatP
47553>>>>>>>>>>>>>
47553>>>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
47554>>>>>>>>>>>>>
47554>>>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
47556>>>>>>>>>>>>>            Clear Cn
47557>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
47558>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
47559>>>>>>>>>>>>>>
47559>>>>>>>>>>>>>            If (Found) Begin
47561>>>>>>>>>>>>>                Move Particle.Partl_No      to sNo
47562>>>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
47563>>>>>>>>>>>>>                Move (Trim(sNo))            to sNo
47564>>>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
47565>>>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
47568>>>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
47569>>>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
47570>>>>>>>>>>>>>                Saverecord CN
47571>>>>>>>>>>>>>            End
47571>>>>>>>>>>>>>>
47571>>>>>>>>>>>>>        End 
47571>>>>>>>>>>>>>>
47571>>>>>>>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
47571>>>>>>>>>>>>>        // kai sta aytonoma deltia apostolhs
47571>>>>>>>>>>>>>        if (PifromBhma1(self)=0) begin
47573>>>>>>>>>>>>>            if (clients.client_ptyppar='100') begin
47575>>>>>>>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
47578>>>>>>>>>>>>>            end
47578>>>>>>>>>>>>>>
47578>>>>>>>>>>>>>            else if (clients.client_ptyppar='113') begin 
47581>>>>>>>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
47584>>>>>>>>>>>>>            end
47584>>>>>>>>>>>>>>
47584>>>>>>>>>>>>>        End
47584>>>>>>>>>>>>>>
47584>>>>>>>>>>>>>        
47584>>>>>>>>>>>>>        Set piCreateNew to 1
47585>>>>>>>>>>>>>    
47585>>>>>>>>>>>>>    End_Procedure   // Creating
47586>>>>>>>>>>>>>
47586>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
47587>>>>>>>>>>>>>        String sStr
47588>>>>>>>>>>>>>        Move '' to sStr
47589>>>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
47590>>>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
47591>>>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
47593>>>>>>>>>>>>>
47593>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
47596>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
47600>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
47604>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
47608>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47612>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47616>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47620>>>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47624>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
47628>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
47632>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
47636>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
47640>>>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
47644>>>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
47648>>>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
47652>>>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
47656>>>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
47660>>>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
47664>>>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
47668>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
47672>>>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
47676>>>>>>>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
47680>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
47683>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
47684>>>>>>>>>>>>>
47684>>>>>>>>>>>>>    Function Validate_Save Returns Integer
47685>>>>>>>>>>>>>        Number nqty
47686>>>>>>>>>>>>>        Integer iReturnVal iYes
47686>>>>>>>>>>>>>        String  sCurrentUserID sOldUserID
47686>>>>>>>>>>>>>
47686>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
47688>>>>>>>>>>>>>
47688>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47690>>>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
47693>>>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
47697>>>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
47701>>>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
47705>>>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
47709>>>>>>>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
47709>>>>>>>>>>>>>            Else Begin
47710>>>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
47710>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47710>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
47710>>>>>>>>>>>>>//                End
47710>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
47710>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47710>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
47710>>>>>>>>>>>>>//                End
47710>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
47710>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47710>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
47710>>>>>>>>>>>>>//                End
47710>>>>>>>>>>>>>
47710>>>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
47713>>>>>>>>>>>>>                Else Begin
47714>>>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
47716>>>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
47717>>>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
47718>>>>>>>>>>>>>                        If (sOldUserID<>'') Begin
47720>>>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
47723>>>>>>>>>>>>>                        End
47723>>>>>>>>>>>>>>
47723>>>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
47723>>>>>>>>>>>>>                    End
47723>>>>>>>>>>>>>>
47723>>>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
47723>>>>>>>>>>>>>                End
47723>>>>>>>>>>>>>>
47723>>>>>>>>>>>>>            End
47723>>>>>>>>>>>>>>
47723>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
47723>>>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
47723>>>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
47723>>>>>>>>>>>>>//               ginoun ekptoseis 100%.
47723>>>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
47723>>>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
47723>>>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
47723>>>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
47723>>>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
47723>>>>>>>>>>>>>//               varesei to validation.
47723>>>>>>>>>>>>>
47723>>>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
47723>>>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
47723>>>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
47723>>>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
47723>>>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
47723>>>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
47723>>>>>>>>>>>>>//                    Move 6051 to iReturnVal
47723>>>>>>>>>>>>>
47723>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
47723>>>>>>>>>>>>>
47723>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
47726>>>>>>>>>>>>>        End
47726>>>>>>>>>>>>>>
47726>>>>>>>>>>>>>        Function_Return iReturnVal
47727>>>>>>>>>>>>>    End_Function   // Validate_Save
47728>>>>>>>>>>>>>
47728>>>>>>>>>>>>>
47728>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
47729>>>>>>>>>>>>>        Integer iReturnVal
47730>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
47732>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47734>>>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
47737>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
47741>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
47744>>>>>>>>>>>>>        End
47744>>>>>>>>>>>>>>
47744>>>>>>>>>>>>>        Function_Return iReturnVal
47745>>>>>>>>>>>>>    End_Function   // Validate_Delete
47746>>>>>>>>>>>>>
47746>>>>>>>>>>>>>
47746>>>>>>>>>>>>>    // Define_Fields:
47746>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47746>>>>>>>>>>>>>
47746>>>>>>>>>>>>>    Procedure Define_Fields
47747>>>>>>>>>>>>>        Forward Send Define_Fields
47749>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47749>>>>>>>>>>>>>        //DDB-DefineFieldStart
47749>>>>>>>>>>>>>
47749>>>>>>>>>>>>>        Set Main_File            To Particle.File_Number
47750>>>>>>>>>>>>>
47750>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47751>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47752>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47753>>>>>>>>>>>>>
47753>>>>>>>>>>>>>        // Child (Client) file structure................
47753>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
47754>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
47755>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
47756>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
47757>>>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
47758>>>>>>>>>>>>>
47758>>>>>>>>>>>>>        // Parent (Server) file structure...............
47758>>>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
47759>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
47760>>>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
47761>>>>>>>>>>>>>
47761>>>>>>>>>>>>>        // External (System) file structure.............
47761>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
47762>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
47763>>>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
47764>>>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
47765>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
47766>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
47767>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
47768>>>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
47769>>>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
47770>>>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
47771>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
47772>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
47773>>>>>>>>>>>>>
47773>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Field-based properties.......................
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Company_Code
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Branch_Code
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Year_Year
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Ctypkin_Code
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Wtypkin_Code
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Ptyppar_Code
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Pseira_Seira
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Custprom_Code
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Client_Id
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Partl_No
47776>>>>>>>>>>>>>
47776>>>>>>>>>>>>>        // Particle.Cn_Recr
47776>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
47777>>>>>>>>>>>>>
47777>>>>>>>>>>>>>        // Particle.Pseira_Recr
47777>>>>>>>>>>>>>
47777>>>>>>>>>>>>>        // Particle.Partl_Hmnia
47777>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
47778>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
47779>>>>>>>>>>>>>
47779>>>>>>>>>>>>>        // Particle.Partl_Rec0
47779>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Lastno
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Tdiakin
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Car
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Reldoc
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Toposf
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Toposa
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Troposa
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Tof
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Disctof
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Disccl
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Autodisc
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Time
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Totambd
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Amdiscpms
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Totdiscpc
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Discam
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Totamad
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Vatpct
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Vatam
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Genam
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Extra
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Extravatp
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Extravat
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Payam
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Befypol
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Currypol
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Tottem
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Det
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>        // Particle.Partl_Recr
47780>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
47781>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
47782>>>>>>>>>>>>>
47782>>>>>>>>>>>>>        // Particle.Cn_Code
47782>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Client_Recr
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Ptyppar_Recr
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Ekleise
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Ektyposh
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Akyrosh
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Nooflines
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Cmoves_Recr
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Nomisma_Code
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Isotimia
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Wcmoves_Recr
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Module
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>        // Particle.Partl_Timol
47783>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
47784>>>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Partl_Selected
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Partl_Tim_Recr
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Partl_Vsn
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Sls_Id
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Presp_Id
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Cnt_Id
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Topos_Apostolhs
47785>>>>>>>>>>>>>
47785>>>>>>>>>>>>>        // Particle.Tropos_Diakin
47785>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
47786>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
47787>>>>>>>>>>>>>
47787>>>>>>>>>>>>>        // Particle.Ora_Apostolhs
47787>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
47788>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
47789>>>>>>>>>>>>>
47789>>>>>>>>>>>>>        // Particle.Skopos_Diakin
47789>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
47790>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
47791>>>>>>>>>>>>>
47791>>>>>>>>>>>>>        // Particle.Tropos_Plhromhs
47791>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
47792>>>>>>>>>>>>>
47792>>>>>>>>>>>>>        // Particle.Odhgos_Code
47792>>>>>>>>>>>>>
47792>>>>>>>>>>>>>        // Particle.Odhgos_Name
47792>>>>>>>>>>>>>
47792>>>>>>>>>>>>>        // Particle.Oxhma_Code
47792>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
47793>>>>>>>>>>>>>
47793>>>>>>>>>>>>>        // Particle.Oxhma_Descr
47793>>>>>>>>>>>>>
47793>>>>>>>>>>>>>        // Particle.Antlia_Code
47793>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Antlia_Descr
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Partl_Euro
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Disc_Vat_Pct
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Disc_Vat_Poso
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Total_Vat_Poso
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Exei_Sxetika
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Aitiol
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Max_Days_Date
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Timol_Qty
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Timol_Ypol
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.No_Print_Module
47794>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Prohg_Ypol
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Trex_Ypol
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Parakrat_Pct
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Parakrat_Poso
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Cms_Parak_Recr
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Enhm_Logik
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Se_Logik
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Akyro
47794>>>>>>>>>>>>>
47794>>>>>>>>>>>>>        // Particle.Zone_Id
47794>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
47795>>>>>>>>>>>>>
47795>>>>>>>>>>>>>        // Particle.Fpa_On_Total
47795>>>>>>>>>>>>>
47795>>>>>>>>>>>>>        // Particle.Ss_Arithmos
47795>>>>>>>>>>>>>
47795>>>>>>>>>>>>>        // Particle.Sap_Hmnia
47795>>>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
47796>>>>>>>>>>>>>
47796>>>>>>>>>>>>>        //DDB-DefineFieldEnd
47796>>>>>>>>>>>>>    End_Procedure    // Define_Fields
47797>>>>>>>>>>>>>
47797>>>>>>>>>>>>>    // Field_Defaults:
47797>>>>>>>>>>>>>    // This procedure is used to establish default field values.
47797>>>>>>>>>>>>>
47797>>>>>>>>>>>>>    Procedure Field_Defaults
47798>>>>>>>>>>>>>        Forward Send Field_Defaults
47800>>>>>>>>>>>>>        //DDB-Generated-Code-Location
47800>>>>>>>>>>>>>        //DDB-FieldDefaultStart
47800>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
47800>>>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
47801>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
47802>>>>>>>>>>>>>
47802>>>>>>>>>>>>>End_Class    // Particle_DataDictionary
47803>>>>>>>>>>>>>//DDB-Selection-pkg-Start
47803>>>>>>>>>>>>>
47803>>>>>>>>>>>>>Use sl041.SL         // sl041
47803>>>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
47803>>>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
47803>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47803>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
47803>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
47803>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47803>>>>>>>>>>>>>>>
47803>>>>>>>>>>>>>>>// Project Object Structure
47803>>>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
47803>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
47803>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
47803>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
47803>>>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
47803>>>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
47803>>>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
47803>>>>>>>>>>>>>>>//     oSelList is a dbListSub
47803>>>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
47803>>>>>>>>>>>>>>>//     FormSub1 is a FormSub
47803>>>>>>>>>>>>>>>//     FormSub3 is a FormSub
47803>>>>>>>>>>>>>>>//     FormSub2 is a FormSub
47803>>>>>>>>>>>>>>>//     FormSub4 is a FormSub
47803>>>>>>>>>>>>>>>//     FormSub5 is a FormSub
47803>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
47803>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
47803>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
47803>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
47803>>>>>>>>>>>>>>>//     oOk_bn is a ButtonSub
47803>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47803>>>>>>>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
47803>>>>>>>>>>>>>>>
47803>>>>>>>>>>>>>>>// Register all objects
47803>>>>>>>>>>>>>>>Register_Object ButtonSub1
47803>>>>>>>>>>>>>>>Register_Object Clients_DD
47803>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
47803>>>>>>>>>>>>>>>Register_Object cSyDateForm1
47803>>>>>>>>>>>>>>>Register_Object FormSub1
47803>>>>>>>>>>>>>>>Register_Object FormSub2
47803>>>>>>>>>>>>>>>Register_Object FormSub3
47803>>>>>>>>>>>>>>>Register_Object FormSub4
47803>>>>>>>>>>>>>>>Register_Object FormSub5
47803>>>>>>>>>>>>>>>Register_Object Nomisma_DD
47803>>>>>>>>>>>>>>>Register_Object oOk_bn
47803>>>>>>>>>>>>>>>Register_Object oSearch_bn
47803>>>>>>>>>>>>>>>Register_Object oSelList
47803>>>>>>>>>>>>>>>Register_Object Particle_DD
47803>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
47803>>>>>>>>>>>>>>>Register_Object sl014
47803>>>>>>>>>>>>>>>Register_Object TextBoxSub1
47803>>>>>>>>>>>>>>>Register_Object TextBoxSub2
47803>>>>>>>>>>>>>>>Register_Object TextBoxSub3
47803>>>>>>>>>>>>>>>Register_Object TextBoxSub4
47803>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
47803>>>>>>>>>>>>>>>
47803>>>>>>>>>>>>>>>
47803>>>>>>>>>>>>>>>
47803>>>>>>>>>>>>>>>//AB-StoreTopStart
47803>>>>>>>>>>>>>>>            
47803>>>>>>>>>>>>>>>Open PtypparL
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>Use sl100.sl
47805>>>>>>>>>>>>>>>Use sl012.sl
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>//AB-StoreTopEnd
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>//AB-IgnoreStart
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>Use DFAllEnt.pkg
47805>>>>>>>>>>>>>>>Use dbList.Sub
47805>>>>>>>>>>>>>>>Use cSyDateForm.Pkg
47805>>>>>>>>>>>>>>>Use Form.Sub
47805>>>>>>>>>>>>>>>Use Txtbox.Sub
47805>>>>>>>>>>>>>>>Use Button.Sub
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>Use CTYPKIN.DD
47805>>>>>>>>>>>>>>>Use WTYPKIN.DD
47805>>>>>>>>>>>>>>>Use PTYPPAR.DD
47805>>>>>>>>>>>>>>>Use CLIENTS.DD
47805>>>>>>>>>>>>>>>Use NOMISMA.DD
47805>>>>>>>>>>>>>>>Use PARTICLE.DD
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>//AB-IgnoreEnd
47805>>>>>>>>>>>>>>>
47805>>>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
47807>>>>>>>>>>>>>>>
47807>>>>>>>>>>>>>>>    //AB-StoreTopStart
47807>>>>>>>>>>>>>>>                                
47807>>>>>>>>>>>>>>>    Property String psModule        Public ''
47809>>>>>>>>>>>>>>>    Property String psClient        Public ''
47811>>>>>>>>>>>>>>>    Property String psPtyppar       Public ''
47813>>>>>>>>>>>>>>>    Property String psCtypkin       Public ''
47815>>>>>>>>>>>>>>>    Property String psWtypkin       Public ''
47817>>>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
47819>>>>>>>>>>>>>>>    Property Integer Pino           Public 0
47821>>>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
47823>>>>>>>>>>>>>>>    
47823>>>>>>>>>>>>>>>    //AB-StoreTopEnd
47823>>>>>>>>>>>>>>>
47823>>>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
47824>>>>>>>>>>>>>>>    Set Size to 294 523
47825>>>>>>>>>>>>>>>    Set Location to 0 3
47826>>>>>>>>>>>>>>>    Set Color to 12363657
47827>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47828>>>>>>>>>>>>>>>    Set Modal_State to FALSE
47829>>>>>>>>>>>>>>>
47829>>>>>>>>>>>>>>>    //AB-DDOStart
47829>>>>>>>>>>>>>>>
47829>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
47831>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
47832>>>>>>>>>>>>>>>
47832>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
47834>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
47835>>>>>>>>>>>>>>>
47835>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
47837>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
47838>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
47839>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
47840>>>>>>>>>>>>>>>
47840>>>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
47842>>>>>>>>>>>>>>>    End_Object    // Clients_DD
47843>>>>>>>>>>>>>>>
47843>>>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
47845>>>>>>>>>>>>>>>    End_Object    // Nomisma_DD
47846>>>>>>>>>>>>>>>
47846>>>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
47848>>>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
47849>>>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
47850>>>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
47851>>>>>>>>>>>>>>>
47851>>>>>>>>>>>>>>>        //AB-StoreStart
47851>>>>>>>>>>>>>>>                                                        
47851>>>>>>>>>>>>>>>        Procedure OnConstrain
47853>>>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
47854>>>>>>>>>>>>>>>            Date    dHmnia
47854>>>>>>>>>>>>>>>            Integer Ino
47854>>>>>>>>>>>>>>>            Get psClient        to sClientID
47855>>>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
47856>>>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
47857>>>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
47858>>>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
47859>>>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
47860>>>>>>>>>>>>>>>            get Pino            to Ino
47861>>>>>>>>>>>>>>>            If (sClientID<>'') Begin
47863>>>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
47865>>>>>>>>>>>>>>>                    Set Ordering to 1
47866>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47868>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47870>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47872>>>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
47874>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
47876>>>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
47878>>>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
47880>>>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
47882>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
47886>>>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
47890>>>>>>>>>>>>>>>                End
47890>>>>>>>>>>>>>>>>
47890>>>>>>>>>>>>>>>                Else Begin
47891>>>>>>>>>>>>>>>                    Set Ordering to 13
47892>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47894>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47896>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47898>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
47900>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
47904>>>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
47908>>>>>>>>>>>>>>>                End
47908>>>>>>>>>>>>>>>>
47908>>>>>>>>>>>>>>>            End
47908>>>>>>>>>>>>>>>>
47908>>>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
47911>>>>>>>>>>>>>>>                Set Ordering to 12
47912>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47914>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47916>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47918>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
47920>>>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
47922>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
47926>>>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
47930>>>>>>>>>>>>>>>            End
47930>>>>>>>>>>>>>>>>
47930>>>>>>>>>>>>>>>            Else  Begin
47931>>>>>>>>>>>>>>>                Set Ordering to 14
47932>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47934>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47936>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47938>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
47940>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
47944>>>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
47948>>>>>>>>>>>>>>>            End
47948>>>>>>>>>>>>>>>>
47948>>>>>>>>>>>>>>>        
47948>>>>>>>>>>>>>>>        End_Procedure
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        
47949>>>>>>>>>>>>>>>        //AB-StoreEnd
47949>>>>>>>>>>>>>>>
47949>>>>>>>>>>>>>>>    End_Object    // Particle_DD
47950>>>>>>>>>>>>>>>
47950>>>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
47951>>>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
47952>>>>>>>>>>>>>>>
47952>>>>>>>>>>>>>>>    //AB-DDOEnd
47952>>>>>>>>>>>>>>>
47952>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
47954>>>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
47955>>>>>>>>>>>>>>>        Set Size to 208 511
47956>>>>>>>>>>>>>>>        Set Location to 6 5
47957>>>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
47958>>>>>>>>>>>>>>>
47958>>>>>>>>>>>>>>>        Begin_Row
47961>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
47962>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
47963>>>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
47964>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
47965>>>>>>>>>>>>>>>            Entry_Item Clients.Client_id
47966>>>>>>>>>>>>>>>            Entry_Item Clients.Client_name
47967>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_payam
47968>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
47969>>>>>>>>>>>>>>>        End_Row
47974>>>>>>>>>>>>>>>
47974>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
47975>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
47976>>>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
47977>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
47978>>>>>>>>>>>>>>>        
47978>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
47979>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
47980>>>>>>>>>>>>>>>        
47980>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 55
47981>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
47982>>>>>>>>>>>>>>>        
47982>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
47983>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
47984>>>>>>>>>>>>>>>        
47984>>>>>>>>>>>>>>>        Set Form_Width    item 5 to 140
47985>>>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
47986>>>>>>>>>>>>>>>        
47986>>>>>>>>>>>>>>>        Set Form_Width    item 6 to 48
47987>>>>>>>>>>>>>>>        Set Header_Label  item 6 to "€¥å˜"
47988>>>>>>>>>>>>>>>        
47988>>>>>>>>>>>>>>>        Set Form_Width    item 7 to 16
47989>>>>>>>>>>>>>>>        Set Header_Label  item 7 to "K"
47990>>>>>>>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
47991>>>>>>>>>>>>>>>        
47991>>>>>>>>>>>>>>>
47991>>>>>>>>>>>>>>>        //AB-StoreStart
47991>>>>>>>>>>>>>>>        Set Column_Option       Item  1 to NoEnter  True
47992>>>>>>>>>>>>>>>        Procedure End_Construct_Object
47994>>>>>>>>>>>>>>>            Integer iDecimals
47995>>>>>>>>>>>>>>>            Forward Send End_Construct_Object
47997>>>>>>>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
47998>>>>>>>>>>>>>>>            Set Points Item 6 to iDecimals
47999>>>>>>>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
48000>>>>>>>>>>>>>>>        End_Procedure
48001>>>>>>>>>>>>>>>        
48001>>>>>>>>>>>>>>>        
48001>>>>>>>>>>>>>>>        Procedure Activate
48003>>>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
48004>>>>>>>>>>>>>>>            Forward Send Activate
48006>>>>>>>>>>>>>>>        End_procedure
48007>>>>>>>>>>>>>>>        
48007>>>>>>>>>>>>>>>        Procedure Activating
48009>>>>>>>>>>>>>>>            Forward Send Activating
48011>>>>>>>>>>>>>>>            Set Auto_Index_State to True
48012>>>>>>>>>>>>>>>        End_Procedure
48013>>>>>>>>>>>>>>>        
48013>>>>>>>>>>>>>>>        
48013>>>>>>>>>>>>>>>        
48013>>>>>>>>>>>>>>>        
48013>>>>>>>>>>>>>>>        //AB-StoreEnd
48013>>>>>>>>>>>>>>>
48013>>>>>>>>>>>>>>>    End_Object    // oSelList
48014>>>>>>>>>>>>>>>
48014>>>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
48016>>>>>>>>>>>>>>>        Set Size to 13 85
48017>>>>>>>>>>>>>>>        Set Location to 222 54
48018>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48019>>>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
48020>>>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48021>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48022>>>>>>>>>>>>>>>
48022>>>>>>>>>>>>>>>        //AB-StoreStart
48022>>>>>>>>>>>>>>>                                                                                                        
48022>>>>>>>>>>>>>>>        Procedure Key Integer iKey
48024>>>>>>>>>>>>>>>            Integer iRetVal
48025>>>>>>>>>>>>>>>            Forward Send Key iKey
48027>>>>>>>>>>>>>>>            If (iKey=277) Begin
48029>>>>>>>>>>>>>>>                Send Clear_Me
48030>>>>>>>>>>>>>>>            End
48030>>>>>>>>>>>>>>>>
48030>>>>>>>>>>>>>>>        End_Procedure
48031>>>>>>>>>>>>>>>        
48031>>>>>>>>>>>>>>>        Procedure Clear_Me
48033>>>>>>>>>>>>>>>            Set Value Item 0 to ''
48034>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
48035>>>>>>>>>>>>>>>        End_Procedure
48036>>>>>>>>>>>>>>>        
48036>>>>>>>>>>>>>>>        Procedure Exiting00000
48038>>>>>>>>>>>>>>>            Forward Send Exiting
48040>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
48041>>>>>>>>>>>>>>>        End_procedure
48042>>>>>>>>>>>>>>>        
48042>>>>>>>>>>>>>>>        
48042>>>>>>>>>>>>>>>        
48042>>>>>>>>>>>>>>>        //AB-StoreEnd
48042>>>>>>>>>>>>>>>
48042>>>>>>>>>>>>>>>    End_Object    // cSyDateForm1
48043>>>>>>>>>>>>>>>
48043>>>>>>>>>>>>>>>    Object FormSub1 is a FormSub
48045>>>>>>>>>>>>>>>        Set Size to 13 85
48046>>>>>>>>>>>>>>>        Set Location to 236 54
48047>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48048>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48049>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48050>>>>>>>>>>>>>>>
48050>>>>>>>>>>>>>>>        //AB-StoreStart
48050>>>>>>>>>>>>>>>                                                                                                
48050>>>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
48051>>>>>>>>>>>>>>>        
48051>>>>>>>>>>>>>>>        Procedure Prompt
48053>>>>>>>>>>>>>>>            String sModule
48054>>>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
48055>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
48056>>>>>>>>>>>>>>>            Forward Send Prompt
48058>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
48059>>>>>>>>>>>>>>>        End_Procedure
48060>>>>>>>>>>>>>>>        
48060>>>>>>>>>>>>>>>        Procedure OnChange
48062>>>>>>>>>>>>>>>            String s1
48063>>>>>>>>>>>>>>>            Get Value Item 0 to s1
48064>>>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
48065>>>>>>>>>>>>>>>            Clear Ptypparl
48066>>>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
48067>>>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
48068>>>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
48069>>>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
48070>>>>>>>>>>>>>>>>
48070>>>>>>>>>>>>>>>            Set psPtyppar       to s1
48071>>>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
48072>>>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
48073>>>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
48074>>>>>>>>>>>>>>>        End_Procedure
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        
48075>>>>>>>>>>>>>>>        //AB-StoreEnd
48075>>>>>>>>>>>>>>>
48075>>>>>>>>>>>>>>>    End_Object    // FormSub1
48076>>>>>>>>>>>>>>>
48076>>>>>>>>>>>>>>>    Object FormSub3 is a FormSub
48078>>>>>>>>>>>>>>>        Set Size to 13 195
48079>>>>>>>>>>>>>>>        Set Location to 236 145
48080>>>>>>>>>>>>>>>        Set Color to 12363657
48081>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48082>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
48083>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48084>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
48085>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
48086>>>>>>>>>>>>>>>    End_Object    // FormSub3
48087>>>>>>>>>>>>>>>
48087>>>>>>>>>>>>>>>    Object FormSub2 is a FormSub
48089>>>>>>>>>>>>>>>        Set Size to 13 85
48090>>>>>>>>>>>>>>>        Set Location to 250 54
48091>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48092>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48093>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48094>>>>>>>>>>>>>>>
48094>>>>>>>>>>>>>>>        //AB-StoreStart
48094>>>>>>>>>>>>>>>                                                                                                
48094>>>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
48095>>>>>>>>>>>>>>>        
48095>>>>>>>>>>>>>>>        Procedure Prompt
48097>>>>>>>>>>>>>>>            String sModule
48098>>>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
48099>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
48100>>>>>>>>>>>>>>>            Forward Send Prompt
48102>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
48103>>>>>>>>>>>>>>>        End_Procedure
48104>>>>>>>>>>>>>>>        
48104>>>>>>>>>>>>>>>        Procedure OnChange
48106>>>>>>>>>>>>>>>            String s1
48107>>>>>>>>>>>>>>>            Get Value Item 0 to s1
48108>>>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
48109>>>>>>>>>>>>>>>            Set psClient to s1
48110>>>>>>>>>>>>>>>        End_Procedure
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        
48111>>>>>>>>>>>>>>>        //AB-StoreEnd
48111>>>>>>>>>>>>>>>
48111>>>>>>>>>>>>>>>    End_Object    // FormSub2
48112>>>>>>>>>>>>>>>
48112>>>>>>>>>>>>>>>    Object FormSub4 is a FormSub
48114>>>>>>>>>>>>>>>        Set Size to 13 195
48115>>>>>>>>>>>>>>>        Set Location to 250 145
48116>>>>>>>>>>>>>>>        Set Color to 12363657
48117>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48118>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
48119>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48120>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
48121>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
48122>>>>>>>>>>>>>>>    End_Object    // FormSub4
48123>>>>>>>>>>>>>>>
48123>>>>>>>>>>>>>>>    Object FormSub5 is a FormSub
48125>>>>>>>>>>>>>>>        Set Size to 13 85
48126>>>>>>>>>>>>>>>        Set Location to 263 54
48127>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48128>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48129>>>>>>>>>>>>>>>
48129>>>>>>>>>>>>>>>        //AB-StoreStart
48129>>>>>>>>>>>>>>>        Procedure OnChange
48131>>>>>>>>>>>>>>>            integer ino
48132>>>>>>>>>>>>>>>            Get Value Item 0 to ino
48133>>>>>>>>>>>>>>>            Set pino to ino
48134>>>>>>>>>>>>>>>        End_Procedure
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        
48135>>>>>>>>>>>>>>>        //AB-StoreEnd
48135>>>>>>>>>>>>>>>
48135>>>>>>>>>>>>>>>    End_Object    // FormSub5
48136>>>>>>>>>>>>>>>
48136>>>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
48138>>>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
48139>>>>>>>>>>>>>>>        Set Color to 12363657
48140>>>>>>>>>>>>>>>        Set Location to 222 5
48141>>>>>>>>>>>>>>>        Set Size to 10 35
48142>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48143>>>>>>>>>>>>>>>    End_Object    // TextBoxSub1
48144>>>>>>>>>>>>>>>
48144>>>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
48146>>>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
48147>>>>>>>>>>>>>>>        Set Color to 12363657
48148>>>>>>>>>>>>>>>        Set Location to 237 4
48149>>>>>>>>>>>>>>>        Set Size to 10 41
48150>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48151>>>>>>>>>>>>>>>    End_Object    // TextBoxSub2
48152>>>>>>>>>>>>>>>
48152>>>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
48154>>>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
48155>>>>>>>>>>>>>>>        Set Color to 12363657
48156>>>>>>>>>>>>>>>        Set Location to 252 4
48157>>>>>>>>>>>>>>>        Set Size to 10 31
48158>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48159>>>>>>>>>>>>>>>    End_Object    // TextBoxSub3
48160>>>>>>>>>>>>>>>
48160>>>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
48162>>>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
48163>>>>>>>>>>>>>>>        Set Size to 13 50
48164>>>>>>>>>>>>>>>        Set Location to 252 355
48165>>>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
48166>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48167>>>>>>>>>>>>>>>
48167>>>>>>>>>>>>>>>        //AB-StoreStart
48167>>>>>>>>>>>>>>>                
48167>>>>>>>>>>>>>>>        Procedure OnClick
48169>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
48170>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
48171>>>>>>>>>>>>>>>        End_Procedure // OnClick
48172>>>>>>>>>>>>>>>        
48172>>>>>>>>>>>>>>>        
48172>>>>>>>>>>>>>>>        
48172>>>>>>>>>>>>>>>        
48172>>>>>>>>>>>>>>>        
48172>>>>>>>>>>>>>>>        //AB-StoreEnd
48172>>>>>>>>>>>>>>>
48172>>>>>>>>>>>>>>>    End_Object    // ButtonSub1
48173>>>>>>>>>>>>>>>
48173>>>>>>>>>>>>>>>    Object oOk_bn is a ButtonSub
48175>>>>>>>>>>>>>>>
48175>>>>>>>>>>>>>>>        //AB-StoreTopStart
48175>>>>>>>>>>>>>>>                
48175>>>>>>>>>>>>>>>        //AB-StoreTopEnd
48175>>>>>>>>>>>>>>>
48175>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48176>>>>>>>>>>>>>>>        Set Location to 252 412
48177>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48178>>>>>>>>>>>>>>>
48178>>>>>>>>>>>>>>>        //AB-StoreStart
48178>>>>>>>>>>>>>>>                
48178>>>>>>>>>>>>>>>        Procedure OnClick
48180>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48181>>>>>>>>>>>>>>>        End_Procedure
48182>>>>>>>>>>>>>>>        
48182>>>>>>>>>>>>>>>        //AB-StoreEnd
48182>>>>>>>>>>>>>>>
48182>>>>>>>>>>>>>>>    End_Object    // oOk_bn
48183>>>>>>>>>>>>>>>
48183>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48185>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48186>>>>>>>>>>>>>>>        Set Size to 13 50
48187>>>>>>>>>>>>>>>        Set Location to 252 466
48188>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48189>>>>>>>>>>>>>>>
48189>>>>>>>>>>>>>>>        //AB-StoreStart
48189>>>>>>>>>>>>>>>        Procedure OnClick
48191>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48192>>>>>>>>>>>>>>>        End_Procedure
48193>>>>>>>>>>>>>>>        //AB-StoreEnd
48193>>>>>>>>>>>>>>>
48193>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48194>>>>>>>>>>>>>>>
48194>>>>>>>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
48196>>>>>>>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
48197>>>>>>>>>>>>>>>        Set Color to 12363657
48198>>>>>>>>>>>>>>>        Set Location to 265 4
48199>>>>>>>>>>>>>>>        Set Size to 10 31
48200>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48201>>>>>>>>>>>>>>>    End_Object    // TextBoxSub4
48202>>>>>>>>>>>>>>>
48202>>>>>>>>>>>>>>>
48202>>>>>>>>>>>>>>>    //AB-StoreStart
48202>>>>>>>>>>>>>>>                                
48202>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48203>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48204>>>>>>>>>>>>>>>    
48204>>>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
48205>>>>>>>>>>>>>>>    Set Modal_State to True
48206>>>>>>>>>>>>>>>    
48206>>>>>>>>>>>>>>>    Procedure Request_Cancel
48208>>>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
48209>>>>>>>>>>>>>>>        Send Clear to Particle_DD
48210>>>>>>>>>>>>>>>        Forward Send Request_Cancel
48212>>>>>>>>>>>>>>>    End_Procedure
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    
48213>>>>>>>>>>>>>>>    //AB-StoreEnd
48213>>>>>>>>>>>>>>>
48213>>>>>>>>>>>>>>>End_Object    // sl014
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>//AB-StoreStart
48214>>>>>>>>>>>>>>>            
48214>>>>>>>>>>>>>>>            
48214>>>>>>>>>>>>>>>//AB-StoreEnd
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48214>>>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
48214>>>>>>>>>>>>>>>//AB/ Project sl054:cars
48214>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48214>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
48214>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
48214>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>// Project Object Structure
48214>>>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
48214>>>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
48214>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48214>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48214>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48214>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>// Register all objects
48214>>>>>>>>>>>>>>>Register_Object Cars_DD
48214>>>>>>>>>>>>>>>Register_Object oCancel_bn
48214>>>>>>>>>>>>>>>Register_Object oOK_bn
48214>>>>>>>>>>>>>>>Register_Object oSearch_bn
48214>>>>>>>>>>>>>>>Register_Object oSelList
48214>>>>>>>>>>>>>>>Register_Object sl054
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>//AB-IgnoreStart
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48214>>>>>>>>>>>>>>>Use dbList.Sub
48214>>>>>>>>>>>>>>>Use Button.Sub
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
48214>>>>>>>>>>>>>>>>>//DDB-FileStart
48214>>>>>>>>>>>>>>>>>//DDB-HeaderStart
48214>>>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>>>// File Name : CARS.DD
48214>>>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
48214>>>>>>>>>>>>>>>>>// Revision  : 16
48214>>>>>>>>>>>>>>>>>// Version   : 2
48214>>>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48214>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48214>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48214>>>>>>>>>>>>>>>>>
48214>>>>>>>>>>>>>>>>>Open Cars
48216>>>>>>>>>>>>>>>>>Open Gmove
48218>>>>>>>>>>>>>>>>>Open Sysrecg
48220>>>>>>>>>>>>>>>>>
48220>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
48220>>>>>>>>>>>>>>>>>//DDB-ValidationStart
48220>>>>>>>>>>>>>>>>>
48220>>>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
48220>>>>>>>>>>>>>>>>>
48220>>>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
48222>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
48223>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
48224>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48225>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48225>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48225>>>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
48226>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
48226>>>>>>>>>>>>>>>>>//DDB-SelectionStart
48226>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
48226>>>>>>>>>>>>>>>>>Register_Object sl054
48226>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
48226>>>>>>>>>>>>>>>>>
48226>>>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
48227>>>>>>>>>>>>>>>>>
48227>>>>>>>>>>>>>>>>>
48227>>>>>>>>>>>>>>>>>    Procedure Construct_Object
48228>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
48230>>>>>>>>>>>>>>>>>        //------------------------------------------------
48230>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48230>>>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
48230>>>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
48230>>>>>>>>>>>>>>>>>        //------------------------------------------------  
48230>>>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
48231>>>>>>>>>>>>>>>>>        Property Integer piAud_Old_Tare         Public  0
48232>>>>>>>>>>>>>>>>>        Property Number  pnAud_Old_Pagio        Public  0
48233>>>>>>>>>>>>>>>>>        Property String  psAud_Old_CarID        Public ""
48234>>>>>>>>>>>>>>>>>        Property String  psAud_Old_CarLicense   Public ""
48235>>>>>>>>>>>>>>>>>        //------------------------------------------------
48235>>>>>>>>>>>>>>>>>
48235>>>>>>>>>>>>>>>>>    End_procedure
48236>>>>>>>>>>>>>>>>>
48236>>>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
48237>>>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
48239>>>>>>>>>>>>>>>>>        //------------------------------------------------
48239>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48239>>>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
48239>>>>>>>>>>>>>>>>>        //------------------------------------------------
48239>>>>>>>>>>>>>>>>>        Set piAud_Old_Tare          to Cars.Car_Tare
48240>>>>>>>>>>>>>>>>>        Set pnAud_Old_Pagio         to Cars.Pagio
48241>>>>>>>>>>>>>>>>>        Set psAud_Old_CarID         to Cars.Car_ID
48242>>>>>>>>>>>>>>>>>        Set psAud_Old_CarLicense    to Cars.Car_License
48243>>>>>>>>>>>>>>>>>        //------------------------------------------------
48243>>>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
48244>>>>>>>>>>>>>>>>>
48244>>>>>>>>>>>>>>>>>    Procedure Delete_Main_File
48245>>>>>>>>>>>>>>>>>        //---------------------------------------------
48245>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48245>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48246>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48246>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48246>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48250>>>>>>>>>>>>>>>>>        Move iHour  to sHour
48251>>>>>>>>>>>>>>>>>        Move iMin   to sMin
48252>>>>>>>>>>>>>>>>>        Move iSec   to sSec
48253>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48257>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48261>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48265>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48266>>>>>>>>>>>>>>>>>        
48266>>>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
48266>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
48268>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48269>>>>>>>>>>>>>>>>>            clear gmove
48270>>>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
48271>>>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
48272>>>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
48273>>>>>>>>>>>>>>>>>            move  5                     to gmove.gtypkin_code// Apo Clients
48274>>>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
48275>>>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
48276>>>>>>>>>>>>>>>>>            move Cars.Car_ID            to gmove.garticl_recr
48277>>>>>>>>>>>>>>>>>            reread sysrecg
48281>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48282>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48283>>>>>>>>>>>>>>>>>            saverecord sysrecg
48284>>>>>>>>>>>>>>>>>            unlock
48285>>>>>>>>>>>>>>>>>>
48285>>>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
48286>>>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
48287>>>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
48288>>>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
48289>>>>>>>>>>>>>>>>>            
48289>>>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Partl_Recr          
48290>>>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Pms_Recr          
48291>>>>>>>>>>>>>>>>>
48291>>>>>>>>>>>>>>>>>            Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro
48292>>>>>>>>>>>>>>>>>            Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1
48293>>>>>>>>>>>>>>>>>            Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma
48294>>>>>>>>>>>>>>>>>            Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
48295>>>>>>>>>>>>>>>>>
48295>>>>>>>>>>>>>>>>>
48295>>>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª Ž®ã£˜«¦ª"    to gmove.gmove_aitiol
48296>>>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
48297>>>>>>>>>>>>>>>>>            saverecord gmove
48298>>>>>>>>>>>>>>>>>        End
48298>>>>>>>>>>>>>>>>>>
48298>>>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
48300>>>>>>>>>>>>>>>>>
48300>>>>>>>>>>>>>>>>>    End_Procedure
48301>>>>>>>>>>>>>>>>>
48301>>>>>>>>>>>>>>>>>     Procedure Creating
48302>>>>>>>>>>>>>>>>>        Forward Send Creating
48304>>>>>>>>>>>>>>>>>        Set piCreateNew to 1
48305>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
48306>>>>>>>>>>>>>>>>>
48306>>>>>>>>>>>>>>>>>
48306>>>>>>>>>>>>>>>>>
48306>>>>>>>>>>>>>>>>>
48306>>>>>>>>>>>>>>>>>    // Update:
48306>>>>>>>>>>>>>>>>>    Procedure Update
48307>>>>>>>>>>>>>>>>>        Forward Send Update
48309>>>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
48310>>>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
48311>>>>>>>>>>>>>>>>>        // Insert Code Here
48311>>>>>>>>>>>>>>>>>        
48311>>>>>>>>>>>>>>>>>        //---------------------------------------------
48311>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48311>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48312>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48312>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48312>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48316>>>>>>>>>>>>>>>>>        Move iHour  to sHour
48317>>>>>>>>>>>>>>>>>        Move iMin   to sMin
48318>>>>>>>>>>>>>>>>>        Move iSec   to sSec
48319>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48323>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48327>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48331>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48332>>>>>>>>>>>>>>>>>        
48332>>>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
48332>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
48334>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48335>>>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
48337>>>>>>>>>>>>>>>>>                clear gmove
48338>>>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
48339>>>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
48340>>>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
48341>>>>>>>>>>>>>>>>>                move  5                     to gmove.gtypkin_code// Apo Clients
48342>>>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
48343>>>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
48344>>>>>>>>>>>>>>>>>                move Cars.Car_ID            to gmove.garticl_recr
48345>>>>>>>>>>>>>>>>>                reread sysrecg
48349>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48350>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48351>>>>>>>>>>>>>>>>>                saverecord sysrecg
48352>>>>>>>>>>>>>>>>>                unlock
48353>>>>>>>>>>>>>>>>>>
48353>>>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
48354>>>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
48355>>>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
48356>>>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
48357>>>>>>>>>>>>>>>>>
48357>>>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Partl_Recr          
48358>>>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Pms_Recr          
48359>>>>>>>>>>>>>>>>>
48359>>>>>>>>>>>>>>>>>                Move Cars.Car_Tare          to Gmove.Cur_Ox_Apobaro
48360>>>>>>>>>>>>>>>>>                Move Cars.Pagio             to Gmove.Cur_Stoxos1
48361>>>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Cur_Oxhma
48362>>>>>>>>>>>>>>>>>                Move Cars.Car_License       to Gmove.Cur_CN_Prosth
48363>>>>>>>>>>>>>>>>>                
48363>>>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª Ž®ã£˜«¦ª" to Gmove.Gmove_Aitiol
48364>>>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
48365>>>>>>>>>>>>>>>>>                saverecord gmove
48366>>>>>>>>>>>>>>>>>                Set piCreateNew to 0
48367>>>>>>>>>>>>>>>>>            End
48367>>>>>>>>>>>>>>>>>>
48367>>>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
48370>>>>>>>>>>>>>>>>>                Integer isChanged
48370>>>>>>>>>>>>>>>>>                Move 0 to isChanged
48371>>>>>>>>>>>>>>>>>                
48371>>>>>>>>>>>>>>>>>                     If (pnAud_Old_Pagio     (Self)<>Cars.Pagio        ) Move 1 to isChanged
48374>>>>>>>>>>>>>>>>>                Else If (piAud_Old_Tare      (Self)<>Cars.Car_Tare     ) Move 1 to isChanged
48378>>>>>>>>>>>>>>>>>                Else If (psAud_Old_CarID     (Self)<>Cars.Car_ID       ) Move 1 to isChanged
48382>>>>>>>>>>>>>>>>>                Else If (psAud_Old_CarLicense(Self)<>Cars.Car_License  ) Move 1 to isChanged
48386>>>>>>>>>>>>>>>>>                
48386>>>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
48388>>>>>>>>>>>>>>>>>                    clear gmove
48389>>>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
48390>>>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
48391>>>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
48392>>>>>>>>>>>>>>>>>                    move  5                     to gmove.gtypkin_code// Apo Clients
48393>>>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
48394>>>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
48395>>>>>>>>>>>>>>>>>                    move Cars.Car_ID          to gmove.garticl_recr
48396>>>>>>>>>>>>>>>>>                    reread sysrecg
48400>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48401>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48402>>>>>>>>>>>>>>>>>                    saverecord sysrecg
48403>>>>>>>>>>>>>>>>>                    unlock
48404>>>>>>>>>>>>>>>>>>
48404>>>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
48405>>>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
48406>>>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
48407>>>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
48408>>>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Partl_Recr          
48409>>>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Pms_Recr          
48410>>>>>>>>>>>>>>>>>                    //--                                
48410>>>>>>>>>>>>>>>>>                    Move Cars.Car_Tare                  to Gmove.Cur_Ox_Apobaro
48411>>>>>>>>>>>>>>>>>                    Move Cars.Pagio                     to Gmove.Cur_Stoxos1
48412>>>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Cur_Oxhma
48413>>>>>>>>>>>>>>>>>                    Move Cars.Car_License               to Gmove.Cur_CN_Prosth
48414>>>>>>>>>>>>>>>>>                    //--
48414>>>>>>>>>>>>>>>>>                    Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro    
48415>>>>>>>>>>>>>>>>>                    Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1       
48416>>>>>>>>>>>>>>>>>                    Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma         
48417>>>>>>>>>>>>>>>>>                    Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
48418>>>>>>>>>>>>>>>>>                                                         
48418>>>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª Ž®ã£˜«¦ª"   to gmove.gmove_aitiol
48419>>>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
48420>>>>>>>>>>>>>>>>>                    saverecord gmove
48421>>>>>>>>>>>>>>>>>                    Set piCreateNew to 0
48422>>>>>>>>>>>>>>>>>                End
48422>>>>>>>>>>>>>>>>>>
48422>>>>>>>>>>>>>>>>>            End
48422>>>>>>>>>>>>>>>>>>
48422>>>>>>>>>>>>>>>>>        End
48422>>>>>>>>>>>>>>>>>>
48422>>>>>>>>>>>>>>>>>        
48422>>>>>>>>>>>>>>>>>    End_Procedure   // Update
48423>>>>>>>>>>>>>>>>>
48423>>>>>>>>>>>>>>>>>
48423>>>>>>>>>>>>>>>>>    // Define_Fields:
48423>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48423>>>>>>>>>>>>>>>>>
48423>>>>>>>>>>>>>>>>>    Procedure Define_Fields
48424>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
48426>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48426>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48426>>>>>>>>>>>>>>>>>
48426>>>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
48427>>>>>>>>>>>>>>>>>
48427>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48428>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48429>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48430>>>>>>>>>>>>>>>>>
48430>>>>>>>>>>>>>>>>>        // External (System) file structure.............
48430>>>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
48431>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48432>>>>>>>>>>>>>>>>>
48432>>>>>>>>>>>>>>>>>        // Field-based properties.......................
48432>>>>>>>>>>>>>>>>>
48432>>>>>>>>>>>>>>>>>        // Cars.Car_Recnum
48432>>>>>>>>>>>>>>>>>
48432>>>>>>>>>>>>>>>>>        // Cars.Car_Company
48432>>>>>>>>>>>>>>>>>
48432>>>>>>>>>>>>>>>>>        // Cars.Car_Id
48432>>>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
48433>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
48434>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
48435>>>>>>>>>>>>>>>>>
48435>>>>>>>>>>>>>>>>>        // Cars.Car_Descr
48435>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_License
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Details
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Sitew
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Tare
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Codematch
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Driverid
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Sn
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Markexp
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_748tare1
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_748tare2
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_748sign
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Car_Bsite
48436>>>>>>>>>>>>>>>>>
48436>>>>>>>>>>>>>>>>>        // Cars.Ctype_Id
48436>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
48437>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
48438>>>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>>>        // Cars.Pagio
48438>>>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>>>        // Cars.Parakrat
48438>>>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>>>        // Cars.Car_What
48438>>>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>>>        // Cars.Car_Lc
48438>>>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>>>        // Cars.Car_Ln
48438>>>>>>>>>>>>>>>>>
48438>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48438>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48439>>>>>>>>>>>>>>>>>
48439>>>>>>>>>>>>>>>>>    // Field_Defaults:
48439>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48439>>>>>>>>>>>>>>>>>
48439>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
48440>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48442>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48442>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48442>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48442>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48443>>>>>>>>>>>>>>>>>
48443>>>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
48444>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48444>>>>>>>>>>>>>>>>>
48444>>>>>>>>>>>>>>>>>Use sl054.SL         // sl054
48444>>>>>>>>>>>>>>>>>
48444>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
48444>>>>>>>>>>>>>>>>>//DDB-FileEnd
48444>>>>>>>>>>>>>>>
48444>>>>>>>>>>>>>>>//AB-IgnoreEnd
48444>>>>>>>>>>>>>>>
48444>>>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
48446>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
48447>>>>>>>>>>>>>>>    Set Size to 148 420
48448>>>>>>>>>>>>>>>    Set Location to 4 5
48449>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48450>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48451>>>>>>>>>>>>>>>
48451>>>>>>>>>>>>>>>    //AB-DDOStart
48451>>>>>>>>>>>>>>>
48451>>>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
48453>>>>>>>>>>>>>>>    End_Object    // Cars_DD
48454>>>>>>>>>>>>>>>
48454>>>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
48455>>>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
48456>>>>>>>>>>>>>>>
48456>>>>>>>>>>>>>>>    //AB-DDOEnd
48456>>>>>>>>>>>>>>>
48456>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48458>>>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
48459>>>>>>>>>>>>>>>        Set Size to 105 403
48460>>>>>>>>>>>>>>>        Set Location to 6 6
48461>>>>>>>>>>>>>>>
48461>>>>>>>>>>>>>>>        Begin_Row
48464>>>>>>>>>>>>>>>            Entry_Item Cars.Car_id
48465>>>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
48466>>>>>>>>>>>>>>>            Entry_Item Cars.Car_license
48467>>>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
48468>>>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
48469>>>>>>>>>>>>>>>        End_Row
48474>>>>>>>>>>>>>>>
48474>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
48475>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
48476>>>>>>>>>>>>>>>        
48476>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
48477>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48478>>>>>>>>>>>>>>>        
48478>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
48479>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
48480>>>>>>>>>>>>>>>        
48480>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
48481>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
48482>>>>>>>>>>>>>>>        
48482>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
48483>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
48484>>>>>>>>>>>>>>>        
48484>>>>>>>>>>>>>>>    End_Object    // oSelList
48485>>>>>>>>>>>>>>>
48485>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48487>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48488>>>>>>>>>>>>>>>        Set Location to 114 249
48489>>>>>>>>>>>>>>>
48489>>>>>>>>>>>>>>>        //AB-StoreStart
48489>>>>>>>>>>>>>>>        Procedure OnClick
48491>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48492>>>>>>>>>>>>>>>        End_Procedure
48493>>>>>>>>>>>>>>>        //AB-StoreEnd
48493>>>>>>>>>>>>>>>
48493>>>>>>>>>>>>>>>    End_Object    // oOK_bn
48494>>>>>>>>>>>>>>>
48494>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48496>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48497>>>>>>>>>>>>>>>        Set Location to 114 305
48498>>>>>>>>>>>>>>>
48498>>>>>>>>>>>>>>>        //AB-StoreStart
48498>>>>>>>>>>>>>>>        Procedure OnClick
48500>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48501>>>>>>>>>>>>>>>        End_Procedure
48502>>>>>>>>>>>>>>>        //AB-StoreEnd
48502>>>>>>>>>>>>>>>
48502>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
48503>>>>>>>>>>>>>>>
48503>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48505>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
48506>>>>>>>>>>>>>>>        Set Location to 114 359
48507>>>>>>>>>>>>>>>
48507>>>>>>>>>>>>>>>        //AB-StoreStart
48507>>>>>>>>>>>>>>>        Procedure OnClick
48509>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48510>>>>>>>>>>>>>>>        End_Procedure
48511>>>>>>>>>>>>>>>        //AB-StoreEnd
48511>>>>>>>>>>>>>>>
48511>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48512>>>>>>>>>>>>>>>
48512>>>>>>>>>>>>>>>
48512>>>>>>>>>>>>>>>    //AB-StoreStart
48512>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48513>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48514>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48515>>>>>>>>>>>>>>>    //AB-StoreEnd
48515>>>>>>>>>>>>>>>
48515>>>>>>>>>>>>>>>End_Object    // sl054
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48516>>>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
48516>>>>>>>>>>>>>>>//AB/ Project sl053:pumps
48516>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48516>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
48516>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
48516>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>// Project Object Structure
48516>>>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
48516>>>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
48516>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48516>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48516>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48516>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>// Register all objects
48516>>>>>>>>>>>>>>>Register_Object oCancel_bn
48516>>>>>>>>>>>>>>>Register_Object oOK_bn
48516>>>>>>>>>>>>>>>Register_Object oSearch_bn
48516>>>>>>>>>>>>>>>Register_Object oSelList
48516>>>>>>>>>>>>>>>Register_Object Pumps_DD
48516>>>>>>>>>>>>>>>Register_Object sl053
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>//AB-IgnoreStart
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48516>>>>>>>>>>>>>>>Use dbList.Sub
48516>>>>>>>>>>>>>>>Use Button.Sub
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
48516>>>>>>>>>>>>>>>>>//DDB-FileStart
48516>>>>>>>>>>>>>>>>>//DDB-HeaderStart
48516>>>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>>>// File Name : PUMPS.DD
48516>>>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
48516>>>>>>>>>>>>>>>>>// Revision  : 18
48516>>>>>>>>>>>>>>>>>// Version   : 2
48516>>>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48516>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48516>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48516>>>>>>>>>>>>>>>>>
48516>>>>>>>>>>>>>>>>>Open Pumps
48518>>>>>>>>>>>>>>>>>Open Gmove
48520>>>>>>>>>>>>>>>>>Open Sysrecg
48522>>>>>>>>>>>>>>>>>
48522>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
48522>>>>>>>>>>>>>>>>>//DDB-ValidationStart
48522>>>>>>>>>>>>>>>>>
48522>>>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
48522>>>>>>>>>>>>>>>>>
48522>>>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
48524>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
48525>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
48526>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48527>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48527>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48527>>>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
48528>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
48528>>>>>>>>>>>>>>>>>//DDB-SelectionStart
48528>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
48528>>>>>>>>>>>>>>>>>Register_Object sl053
48528>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
48528>>>>>>>>>>>>>>>>>
48528>>>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
48529>>>>>>>>>>>>>>>>>
48529>>>>>>>>>>>>>>>>>    Procedure Construct_Object
48530>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
48532>>>>>>>>>>>>>>>>>        //------------------------------------------------
48532>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48532>>>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
48532>>>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
48532>>>>>>>>>>>>>>>>>        //------------------------------------------------  
48532>>>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
48533>>>>>>>>>>>>>>>>>        Property Number  pnAud_Old_M3           Public  0
48534>>>>>>>>>>>>>>>>>        Property Integer piAud_Old_Pagio        Public  0
48535>>>>>>>>>>>>>>>>>        Property String  psAud_Old_PumpID       Public ""
48536>>>>>>>>>>>>>>>>>        Property String  psAud_Old_License      Public ""
48537>>>>>>>>>>>>>>>>>        //------------------------------------------------
48537>>>>>>>>>>>>>>>>>
48537>>>>>>>>>>>>>>>>>    End_procedure
48538>>>>>>>>>>>>>>>>>
48538>>>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
48539>>>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
48541>>>>>>>>>>>>>>>>>        //------------------------------------------------
48541>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48541>>>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
48541>>>>>>>>>>>>>>>>>        //------------------------------------------------
48541>>>>>>>>>>>>>>>>>        Set pnAud_Old_M3        to Pumps.PriceM3
48542>>>>>>>>>>>>>>>>>        Set piAud_Old_Pagio     to Pumps.PagioMin
48543>>>>>>>>>>>>>>>>>        Set psAud_Old_PumpID    to Pumps.Pump_ID
48544>>>>>>>>>>>>>>>>>        Set psAud_Old_License   to Pumps.Pump_License
48545>>>>>>>>>>>>>>>>>        //------------------------------------------------
48545>>>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
48546>>>>>>>>>>>>>>>>>
48546>>>>>>>>>>>>>>>>>    Procedure Delete_Main_File
48547>>>>>>>>>>>>>>>>>        //---------------------------------------------
48547>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48547>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48548>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48548>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48548>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48552>>>>>>>>>>>>>>>>>        Move iHour  to sHour
48553>>>>>>>>>>>>>>>>>        Move iMin   to sMin
48554>>>>>>>>>>>>>>>>>        Move iSec   to sSec
48555>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48559>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48563>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48567>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48568>>>>>>>>>>>>>>>>>        
48568>>>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
48568>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
48570>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48571>>>>>>>>>>>>>>>>>            clear gmove
48572>>>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
48573>>>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
48574>>>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
48575>>>>>>>>>>>>>>>>>            move  6                     to gmove.gtypkin_code// Apo Clients
48576>>>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
48577>>>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
48578>>>>>>>>>>>>>>>>>            move Pumps.Pump_ID          to gmove.garticl_recr
48579>>>>>>>>>>>>>>>>>            reread sysrecg
48583>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48584>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48585>>>>>>>>>>>>>>>>>            saverecord sysrecg
48586>>>>>>>>>>>>>>>>>            unlock
48587>>>>>>>>>>>>>>>>>>
48587>>>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
48588>>>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
48589>>>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
48590>>>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
48591>>>>>>>>>>>>>>>>>            
48591>>>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
48592>>>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
48593>>>>>>>>>>>>>>>>>
48593>>>>>>>>>>>>>>>>>            Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Ant_Min_M3
48594>>>>>>>>>>>>>>>>>            Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Stoxos1
48595>>>>>>>>>>>>>>>>>            Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
48596>>>>>>>>>>>>>>>>>            Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
48597>>>>>>>>>>>>>>>>>
48597>>>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
48598>>>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
48599>>>>>>>>>>>>>>>>>            saverecord gmove
48600>>>>>>>>>>>>>>>>>        End
48600>>>>>>>>>>>>>>>>>>
48600>>>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
48602>>>>>>>>>>>>>>>>>
48602>>>>>>>>>>>>>>>>>    End_Procedure
48603>>>>>>>>>>>>>>>>>
48603>>>>>>>>>>>>>>>>>     Procedure Creating
48604>>>>>>>>>>>>>>>>>        Forward Send Creating
48606>>>>>>>>>>>>>>>>>        Set piCreateNew to 1
48607>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
48608>>>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>>>    // Update:
48608>>>>>>>>>>>>>>>>>    Procedure Update
48609>>>>>>>>>>>>>>>>>        Forward Send Update
48611>>>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
48612>>>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
48613>>>>>>>>>>>>>>>>>
48613>>>>>>>>>>>>>>>>>
48613>>>>>>>>>>>>>>>>>        //---------------------------------------------
48613>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48613>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48614>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48614>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48614>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48618>>>>>>>>>>>>>>>>>        Move iHour  to sHour
48619>>>>>>>>>>>>>>>>>        Move iMin   to sMin
48620>>>>>>>>>>>>>>>>>        Move iSec   to sSec
48621>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48625>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48629>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48633>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48634>>>>>>>>>>>>>>>>>        
48634>>>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
48634>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
48636>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48637>>>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
48639>>>>>>>>>>>>>>>>>                clear gmove
48640>>>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
48641>>>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
48642>>>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
48643>>>>>>>>>>>>>>>>>                move  6                     to gmove.gtypkin_code// Apo Clients
48644>>>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
48645>>>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
48646>>>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.garticl_recr
48647>>>>>>>>>>>>>>>>>                reread sysrecg
48651>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48652>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48653>>>>>>>>>>>>>>>>>                saverecord sysrecg
48654>>>>>>>>>>>>>>>>>                unlock
48655>>>>>>>>>>>>>>>>>>
48655>>>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
48656>>>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
48657>>>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
48658>>>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
48659>>>>>>>>>>>>>>>>>
48659>>>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Partl_Recr          
48660>>>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Pms_Recr          
48661>>>>>>>>>>>>>>>>>
48661>>>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.Cur_Antlia
48662>>>>>>>>>>>>>>>>>                Move Pumps.PriceM3          to Gmove.Cur_Stoxos1
48663>>>>>>>>>>>>>>>>>                Move Pumps.PagioMin         to Gmove.Cur_Ant_Min_M3
48664>>>>>>>>>>>>>>>>>                Move Pumps.Pump_License     to Gmove.Cur_CN_Prosth
48665>>>>>>>>>>>>>>>>>
48665>>>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª €¤«¢å˜ª" to Gmove.Gmove_Aitiol
48666>>>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
48667>>>>>>>>>>>>>>>>>                saverecord gmove
48668>>>>>>>>>>>>>>>>>                Set piCreateNew to 0
48669>>>>>>>>>>>>>>>>>            End
48669>>>>>>>>>>>>>>>>>>
48669>>>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
48672>>>>>>>>>>>>>>>>>                Integer isChanged
48672>>>>>>>>>>>>>>>>>                Move 0 to isChanged
48673>>>>>>>>>>>>>>>>>                
48673>>>>>>>>>>>>>>>>>                     If (pnAud_Old_M3      (Self)<>Pumps.PriceM3     ) Move 1 to isChanged
48676>>>>>>>>>>>>>>>>>                Else If (piAud_Old_Pagio   (Self)<>Pumps.PagioMin    ) Move 1 to isChanged
48680>>>>>>>>>>>>>>>>>                Else If (psAud_Old_PumpID  (Self)<>Pumps.Pump_ID     ) Move 1 to isChanged
48684>>>>>>>>>>>>>>>>>                Else If (psAud_Old_License (Self)<>Pumps.Pump_License) Move 1 to isChanged
48688>>>>>>>>>>>>>>>>>
48688>>>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
48690>>>>>>>>>>>>>>>>>                    clear gmove
48691>>>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
48692>>>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
48693>>>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
48694>>>>>>>>>>>>>>>>>                    move  6                     to gmove.gtypkin_code// Apo Clients
48695>>>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
48696>>>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
48697>>>>>>>>>>>>>>>>>                    move Pumps.Pump_ID          to gmove.garticl_recr
48698>>>>>>>>>>>>>>>>>                    reread sysrecg
48702>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48703>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48704>>>>>>>>>>>>>>>>>                    saverecord sysrecg
48705>>>>>>>>>>>>>>>>>                    unlock
48706>>>>>>>>>>>>>>>>>>
48706>>>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
48707>>>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
48708>>>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
48709>>>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
48710>>>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
48711>>>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
48712>>>>>>>>>>>>>>>>>                    //--                                
48712>>>>>>>>>>>>>>>>>                    move Pumps.Pump_ID                  to gmove.Cur_Antlia
48713>>>>>>>>>>>>>>>>>                    Move Pumps.PriceM3                  to Gmove.Cur_Stoxos1
48714>>>>>>>>>>>>>>>>>                    Move Pumps.PagioMin                 to Gmove.Cur_Ant_Min_M3
48715>>>>>>>>>>>>>>>>>                    Move Pumps.Pump_License             to Gmove.Cur_CN_Prosth
48716>>>>>>>>>>>>>>>>>                    //--
48716>>>>>>>>>>>>>>>>>                    Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Stoxos1      
48717>>>>>>>>>>>>>>>>>                    Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Ant_Min_M3   
48718>>>>>>>>>>>>>>>>>                    Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
48719>>>>>>>>>>>>>>>>>                    Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
48720>>>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
48721>>>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
48722>>>>>>>>>>>>>>>>>                    saverecord gmove
48723>>>>>>>>>>>>>>>>>                    Set piCreateNew to 0
48724>>>>>>>>>>>>>>>>>                End
48724>>>>>>>>>>>>>>>>>>
48724>>>>>>>>>>>>>>>>>            End
48724>>>>>>>>>>>>>>>>>>
48724>>>>>>>>>>>>>>>>>        End
48724>>>>>>>>>>>>>>>>>>
48724>>>>>>>>>>>>>>>>>
48724>>>>>>>>>>>>>>>>>
48724>>>>>>>>>>>>>>>>>
48724>>>>>>>>>>>>>>>>>    End_Procedure   // Update
48725>>>>>>>>>>>>>>>>>
48725>>>>>>>>>>>>>>>>>
48725>>>>>>>>>>>>>>>>>    // Define_Fields:
48725>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48725>>>>>>>>>>>>>>>>>
48725>>>>>>>>>>>>>>>>>    Procedure Define_Fields
48726>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
48728>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48728>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48728>>>>>>>>>>>>>>>>>
48728>>>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
48729>>>>>>>>>>>>>>>>>
48729>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48730>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48731>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48732>>>>>>>>>>>>>>>>>
48732>>>>>>>>>>>>>>>>>        // External (System) file structure.............
48732>>>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
48733>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48734>>>>>>>>>>>>>>>>>
48734>>>>>>>>>>>>>>>>>        // Field-based properties.......................
48734>>>>>>>>>>>>>>>>>
48734>>>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
48734>>>>>>>>>>>>>>>>>
48734>>>>>>>>>>>>>>>>>        // Pumps.Pump_Company
48734>>>>>>>>>>>>>>>>>
48734>>>>>>>>>>>>>>>>>        // Pumps.Pump_Id
48734>>>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
48735>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
48736>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
48737>>>>>>>>>>>>>>>>>
48737>>>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
48737>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_License
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
48738>>>>>>>>>>>>>>>>>
48738>>>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
48738>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
48739>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        // Pumps.Pagiomin
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        // Pumps.Pricem3
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        // Pumps.Parakrat
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        // Pumps.Pump_What
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        // Pumps.Pump_Lc
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        // Pumps.Pump_Ln
48740>>>>>>>>>>>>>>>>>
48740>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48740>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48741>>>>>>>>>>>>>>>>>
48741>>>>>>>>>>>>>>>>>    // Field_Defaults:
48741>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48741>>>>>>>>>>>>>>>>>
48741>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
48742>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48744>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48744>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48744>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48744>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48745>>>>>>>>>>>>>>>>>
48745>>>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
48746>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48746>>>>>>>>>>>>>>>>>
48746>>>>>>>>>>>>>>>>>Use sl053.SL         // sl053
48746>>>>>>>>>>>>>>>>>
48746>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
48746>>>>>>>>>>>>>>>>>//DDB-FileEnd
48746>>>>>>>>>>>>>>>
48746>>>>>>>>>>>>>>>//AB-IgnoreEnd
48746>>>>>>>>>>>>>>>
48746>>>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
48748>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
48749>>>>>>>>>>>>>>>    Set Size to 148 325
48750>>>>>>>>>>>>>>>    Set Location to 4 5
48751>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48752>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48753>>>>>>>>>>>>>>>
48753>>>>>>>>>>>>>>>    //AB-DDOStart
48753>>>>>>>>>>>>>>>
48753>>>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
48755>>>>>>>>>>>>>>>    End_Object    // Pumps_DD
48756>>>>>>>>>>>>>>>
48756>>>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
48757>>>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
48758>>>>>>>>>>>>>>>
48758>>>>>>>>>>>>>>>    //AB-DDOEnd
48758>>>>>>>>>>>>>>>
48758>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48760>>>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
48761>>>>>>>>>>>>>>>        Set Size to 105 309
48762>>>>>>>>>>>>>>>        Set Location to 6 6
48763>>>>>>>>>>>>>>>
48763>>>>>>>>>>>>>>>        Begin_Row
48766>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
48767>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
48768>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
48769>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
48770>>>>>>>>>>>>>>>        End_Row
48775>>>>>>>>>>>>>>>
48775>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
48776>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
48777>>>>>>>>>>>>>>>        
48777>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
48778>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48779>>>>>>>>>>>>>>>        
48779>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
48780>>>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
48781>>>>>>>>>>>>>>>        
48781>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
48782>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
48783>>>>>>>>>>>>>>>        
48783>>>>>>>>>>>>>>>    End_Object    // oSelList
48784>>>>>>>>>>>>>>>
48784>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48786>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48787>>>>>>>>>>>>>>>        Set Location to 114 157
48788>>>>>>>>>>>>>>>
48788>>>>>>>>>>>>>>>        //AB-StoreStart
48788>>>>>>>>>>>>>>>        Procedure OnClick
48790>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48791>>>>>>>>>>>>>>>        End_Procedure
48792>>>>>>>>>>>>>>>        //AB-StoreEnd
48792>>>>>>>>>>>>>>>
48792>>>>>>>>>>>>>>>    End_Object    // oOK_bn
48793>>>>>>>>>>>>>>>
48793>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48795>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48796>>>>>>>>>>>>>>>        Set Location to 114 212
48797>>>>>>>>>>>>>>>
48797>>>>>>>>>>>>>>>        //AB-StoreStart
48797>>>>>>>>>>>>>>>        Procedure OnClick
48799>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48800>>>>>>>>>>>>>>>        End_Procedure
48801>>>>>>>>>>>>>>>        //AB-StoreEnd
48801>>>>>>>>>>>>>>>
48801>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
48802>>>>>>>>>>>>>>>
48802>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48804>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
48805>>>>>>>>>>>>>>>        Set Location to 114 267
48806>>>>>>>>>>>>>>>
48806>>>>>>>>>>>>>>>        //AB-StoreStart
48806>>>>>>>>>>>>>>>        Procedure OnClick
48808>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48809>>>>>>>>>>>>>>>        End_Procedure
48810>>>>>>>>>>>>>>>        //AB-StoreEnd
48810>>>>>>>>>>>>>>>
48810>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48811>>>>>>>>>>>>>>>
48811>>>>>>>>>>>>>>>
48811>>>>>>>>>>>>>>>    //AB-StoreStart
48811>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48812>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48813>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48814>>>>>>>>>>>>>>>    //AB-StoreEnd
48814>>>>>>>>>>>>>>>
48814>>>>>>>>>>>>>>>End_Object    // sl053
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48815>>>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
48815>>>>>>>>>>>>>>>//AB/ Project sl064 : Zones
48815>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48815>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
48815>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
48815>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>// Project Object Structure
48815>>>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
48815>>>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
48815>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48815>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48815>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48815>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>// Register all objects
48815>>>>>>>>>>>>>>>Register_Object oCancel_bn
48815>>>>>>>>>>>>>>>Register_Object oOK_bn
48815>>>>>>>>>>>>>>>Register_Object oSearch_bn
48815>>>>>>>>>>>>>>>Register_Object oSelList
48815>>>>>>>>>>>>>>>Register_Object sl064
48815>>>>>>>>>>>>>>>Register_Object Zones_DD
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>//AB-IgnoreStart
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48815>>>>>>>>>>>>>>>Use dbList.Sub
48815>>>>>>>>>>>>>>>Use Button.Sub
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
48815>>>>>>>>>>>>>>>>>//DDB-FileStart
48815>>>>>>>>>>>>>>>>>//DDB-HeaderStart
48815>>>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>>>// File Name : ZONES.DD
48815>>>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
48815>>>>>>>>>>>>>>>>>// Revision  : 4
48815>>>>>>>>>>>>>>>>>// Version   : 2
48815>>>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48815>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48815>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48815>>>>>>>>>>>>>>>>>
48815>>>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
48817>>>>>>>>>>>>>>>>>Open Brzones
48819>>>>>>>>>>>>>>>>>
48819>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
48819>>>>>>>>>>>>>>>>>//DDB-SelectionStart
48819>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
48819>>>>>>>>>>>>>>>>>Register_Object sl064
48819>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
48819>>>>>>>>>>>>>>>>>
48819>>>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
48820>>>>>>>>>>>>>>>>>
48820>>>>>>>>>>>>>>>>>    // Define_Fields:
48820>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48820>>>>>>>>>>>>>>>>>
48820>>>>>>>>>>>>>>>>>    Procedure Define_Fields
48821>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
48823>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48823>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48823>>>>>>>>>>>>>>>>>
48823>>>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
48824>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48825>>>>>>>>>>>>>>>>>
48825>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48826>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48827>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48828>>>>>>>>>>>>>>>>>
48828>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
48828>>>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
48829>>>>>>>>>>>>>>>>>
48829>>>>>>>>>>>>>>>>>        // Field-based properties.......................
48829>>>>>>>>>>>>>>>>>
48829>>>>>>>>>>>>>>>>>        // Zones.Zone_Id
48829>>>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
48830>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
48831>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
48832>>>>>>>>>>>>>>>>>
48832>>>>>>>>>>>>>>>>>        // Zones.Zone_Descr
48832>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
48833>>>>>>>>>>>>>>>>>
48833>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48833>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48834>>>>>>>>>>>>>>>>>
48834>>>>>>>>>>>>>>>>>    // Field_Defaults:
48834>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48834>>>>>>>>>>>>>>>>>
48834>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
48835>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48837>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48837>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48837>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48837>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48838>>>>>>>>>>>>>>>>>
48838>>>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
48839>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48839>>>>>>>>>>>>>>>>>
48839>>>>>>>>>>>>>>>>>Use sl064.SL         // sl064
48839>>>>>>>>>>>>>>>>>
48839>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
48839>>>>>>>>>>>>>>>>>//DDB-FileEnd
48839>>>>>>>>>>>>>>>
48839>>>>>>>>>>>>>>>//AB-IgnoreEnd
48839>>>>>>>>>>>>>>>
48839>>>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
48858>>>>>>>>>>>>>>>    Set Label to "…é¤œª"
48859>>>>>>>>>>>>>>>    Set Size to 148 297
48860>>>>>>>>>>>>>>>    Set Location to 4 5
48861>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48862>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48863>>>>>>>>>>>>>>>
48863>>>>>>>>>>>>>>>    //AB-DDOStart
48863>>>>>>>>>>>>>>>
48863>>>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
48865>>>>>>>>>>>>>>>    End_Object    // Zones_DD
48866>>>>>>>>>>>>>>>
48866>>>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
48867>>>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
48868>>>>>>>>>>>>>>>
48868>>>>>>>>>>>>>>>    //AB-DDOEnd
48868>>>>>>>>>>>>>>>
48868>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48870>>>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
48871>>>>>>>>>>>>>>>        Set Size to 105 280
48872>>>>>>>>>>>>>>>        Set Location to 6 6
48873>>>>>>>>>>>>>>>
48873>>>>>>>>>>>>>>>        Begin_Row
48876>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
48877>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
48878>>>>>>>>>>>>>>>        End_Row
48883>>>>>>>>>>>>>>>
48883>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
48884>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48885>>>>>>>>>>>>>>>        
48885>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
48886>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48887>>>>>>>>>>>>>>>        
48887>>>>>>>>>>>>>>>    End_Object    // oSelList
48888>>>>>>>>>>>>>>>
48888>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48890>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48891>>>>>>>>>>>>>>>        Set Location to 115 126
48892>>>>>>>>>>>>>>>
48892>>>>>>>>>>>>>>>        //AB-StoreStart
48892>>>>>>>>>>>>>>>        Procedure OnClick
48894>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48895>>>>>>>>>>>>>>>        End_Procedure
48896>>>>>>>>>>>>>>>        //AB-StoreEnd
48896>>>>>>>>>>>>>>>
48896>>>>>>>>>>>>>>>    End_Object    // oOK_bn
48897>>>>>>>>>>>>>>>
48897>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48899>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48900>>>>>>>>>>>>>>>        Set Location to 115 181
48901>>>>>>>>>>>>>>>
48901>>>>>>>>>>>>>>>        //AB-StoreStart
48901>>>>>>>>>>>>>>>        Procedure OnClick
48903>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48904>>>>>>>>>>>>>>>        End_Procedure
48905>>>>>>>>>>>>>>>        //AB-StoreEnd
48905>>>>>>>>>>>>>>>
48905>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
48906>>>>>>>>>>>>>>>
48906>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48908>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
48909>>>>>>>>>>>>>>>        Set Location to 115 236
48910>>>>>>>>>>>>>>>
48910>>>>>>>>>>>>>>>        //AB-StoreStart
48910>>>>>>>>>>>>>>>        Procedure OnClick
48912>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48913>>>>>>>>>>>>>>>        End_Procedure
48914>>>>>>>>>>>>>>>        //AB-StoreEnd
48914>>>>>>>>>>>>>>>
48914>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48915>>>>>>>>>>>>>>>
48915>>>>>>>>>>>>>>>
48915>>>>>>>>>>>>>>>    //AB-StoreStart
48915>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48916>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48917>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48918>>>>>>>>>>>>>>>    //AB-StoreEnd
48918>>>>>>>>>>>>>>>
48918>>>>>>>>>>>>>>>CD_End_Object    // sl064
48920>>>>>>>>>>>>>>>>
48920>>>>>>>>>>>>>>>
48920>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48920>>>>>>>>>>>>>
48920>>>>>>>>>>>>>//DDB-Selection-pkg-End
48920>>>>>>>>>>>>>//DDB-FileEnd
48920>>>>>>>>>>>    Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
48920>>>>>>>>>>>>>//DDB-FileStart
48920>>>>>>>>>>>>>//DDB-HeaderStart
48920>>>>>>>>>>>>>
48920>>>>>>>>>>>>>// File Name : WAPOKAT.DD
48920>>>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
48920>>>>>>>>>>>>>// Revision  : 21
48920>>>>>>>>>>>>>// Version   : 2
48920>>>>>>>>>>>>>
48920>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48920>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48920>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48920>>>>>>>>>>>>>
48920>>>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
48922>>>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
48924>>>>>>>>>>>>>Open Sysrecw
48926>>>>>>>>>>>>>Open Syscurxr
48928>>>>>>>>>>>>>
48928>>>>>>>>>>>>>//DDB-HeaderEnd
48928>>>>>>>>>>>>>//DDB-SelectionStart
48928>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
48928>>>>>>>>>>>>>Register_Object sl022
48928>>>>>>>>>>>>>//DDB-SelectionEnd
48928>>>>>>>>>>>>>
48928>>>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
48929>>>>>>>>>>>>>
48929>>>>>>>>>>>>>    // Update:
48929>>>>>>>>>>>>>    Procedure Update
48930>>>>>>>>>>>>>        Forward Send Update
48932>>>>>>>>>>>>>        // Insert Code Here
48932>>>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
48932>>>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
48932>>>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
48932>>>>>>>>>>>>>    End_Procedure   // Update
48933>>>>>>>>>>>>> 
48933>>>>>>>>>>>>>     Procedure Creating
48934>>>>>>>>>>>>>        Forward Send Creating
48936>>>>>>>>>>>>>        // Insert Code Here
48936>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
48937>>>>>>>>>>>>>    End_Procedure   // Creating
48938>>>>>>>>>>>>>
48938>>>>>>>>>>>>>
48938>>>>>>>>>>>>>    // Define_Fields:
48938>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48938>>>>>>>>>>>>>
48938>>>>>>>>>>>>>    Procedure Define_Fields
48939>>>>>>>>>>>>>        Forward Send Define_Fields
48941>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48941>>>>>>>>>>>>>        //DDB-DefineFieldStart
48941>>>>>>>>>>>>>
48941>>>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
48942>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48943>>>>>>>>>>>>>
48943>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48944>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48945>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48946>>>>>>>>>>>>>
48946>>>>>>>>>>>>>        // Child (Client) file structure................
48946>>>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
48947>>>>>>>>>>>>>
48947>>>>>>>>>>>>>        // External (System) file structure.............
48947>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
48948>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
48949>>>>>>>>>>>>>
48949>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
48952>>>>>>>>>>>>>
48952>>>>>>>>>>>>>        // Field-based properties.......................
48952>>>>>>>>>>>>>
48952>>>>>>>>>>>>>        // Wapokat.Wapokat_Code
48952>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
48953>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
48954>>>>>>>>>>>>>
48954>>>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
48954>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
48955>>>>>>>>>>>>>
48955>>>>>>>>>>>>>        // Wapokat.Wapokat_Descr
48955>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
48956>>>>>>>>>>>>>
48956>>>>>>>>>>>>>        // Wapokat.Wapokat_Recr
48956>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
48957>>>>>>>>>>>>>
48957>>>>>>>>>>>>>        // Wapokat.Enhm_Sap
48957>>>>>>>>>>>>>
48957>>>>>>>>>>>>>        // Wapokat.Sap_Descr
48957>>>>>>>>>>>>>
48957>>>>>>>>>>>>>        // Wapokat.Gl
48957>>>>>>>>>>>>>
48957>>>>>>>>>>>>>        // Wapokat.Glzz
48957>>>>>>>>>>>>>
48957>>>>>>>>>>>>>        // Wapokat.Oximm1
48957>>>>>>>>>>>>>
48957>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48957>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48958>>>>>>>>>>>>>
48958>>>>>>>>>>>>>    // Field_Defaults:
48958>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48958>>>>>>>>>>>>>
48958>>>>>>>>>>>>>    Procedure Field_Defaults
48959>>>>>>>>>>>>>        Forward Send Field_Defaults
48961>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48961>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48961>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48961>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48962>>>>>>>>>>>>>
48962>>>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
48963>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48963>>>>>>>>>>>>>
48963>>>>>>>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
48963>>>>>>>>>>>>>>>//AB/ Project sl022:kathg-apothkon
48963>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48963>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
48963>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>// Project Object Structure
48963>>>>>>>>>>>>>>>//   sl022 is a dbModalPanelSub
48963>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
48963>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48963>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48963>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48963>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>// Register all objects
48963>>>>>>>>>>>>>>>Register_Object oCancel_bn
48963>>>>>>>>>>>>>>>Register_Object oOK_bn
48963>>>>>>>>>>>>>>>Register_Object oSearch_bn
48963>>>>>>>>>>>>>>>Register_Object oSelList
48963>>>>>>>>>>>>>>>Register_Object sl022
48963>>>>>>>>>>>>>>>Register_Object Wapokat_DD
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>//AB-IgnoreStart
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48963>>>>>>>>>>>>>>>Use dbList.Sub
48963>>>>>>>>>>>>>>>Use Button.Sub
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>Use WAPOKAT.DD
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>//AB-IgnoreEnd
48963>>>>>>>>>>>>>>>
48963>>>>>>>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
48982>>>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
48983>>>>>>>>>>>>>>>    Set Size to 148 297
48984>>>>>>>>>>>>>>>    Set Location to 12 19
48985>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48986>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48987>>>>>>>>>>>>>>>
48987>>>>>>>>>>>>>>>    //AB-DDOStart
48987>>>>>>>>>>>>>>>
48987>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
48989>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
48990>>>>>>>>>>>>>>>
48990>>>>>>>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
48991>>>>>>>>>>>>>>>    Set Server to (Wapokat_DD(self))
48992>>>>>>>>>>>>>>>
48992>>>>>>>>>>>>>>>    //AB-DDOEnd
48992>>>>>>>>>>>>>>>
48992>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48994>>>>>>>>>>>>>>>        Set Main_File to Wapokat.File_Number
48995>>>>>>>>>>>>>>>        Set Size to 105 280
48996>>>>>>>>>>>>>>>        Set Location to 6 6
48997>>>>>>>>>>>>>>>
48997>>>>>>>>>>>>>>>        Begin_Row
49000>>>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
49001>>>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
49002>>>>>>>>>>>>>>>        End_Row
49007>>>>>>>>>>>>>>>
49007>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 42
49008>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
49009>>>>>>>>>>>>>>>        
49009>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 228
49010>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49011>>>>>>>>>>>>>>>        
49011>>>>>>>>>>>>>>>    End_Object    // oSelList
49012>>>>>>>>>>>>>>>
49012>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49014>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49015>>>>>>>>>>>>>>>        Set Location to 115 126
49016>>>>>>>>>>>>>>>
49016>>>>>>>>>>>>>>>        //AB-StoreStart
49016>>>>>>>>>>>>>>>        Procedure OnClick
49018>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49019>>>>>>>>>>>>>>>        End_Procedure
49020>>>>>>>>>>>>>>>        //AB-StoreEnd
49020>>>>>>>>>>>>>>>
49020>>>>>>>>>>>>>>>    End_Object    // oOK_bn
49021>>>>>>>>>>>>>>>
49021>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49023>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49024>>>>>>>>>>>>>>>        Set Location to 115 181
49025>>>>>>>>>>>>>>>
49025>>>>>>>>>>>>>>>        //AB-StoreStart
49025>>>>>>>>>>>>>>>        Procedure OnClick
49027>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49028>>>>>>>>>>>>>>>        End_Procedure
49029>>>>>>>>>>>>>>>        //AB-StoreEnd
49029>>>>>>>>>>>>>>>
49029>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
49030>>>>>>>>>>>>>>>
49030>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49032>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49033>>>>>>>>>>>>>>>        Set Location to 115 236
49034>>>>>>>>>>>>>>>
49034>>>>>>>>>>>>>>>        //AB-StoreStart
49034>>>>>>>>>>>>>>>        Procedure OnClick
49036>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49037>>>>>>>>>>>>>>>        End_Procedure
49038>>>>>>>>>>>>>>>        //AB-StoreEnd
49038>>>>>>>>>>>>>>>
49038>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
49039>>>>>>>>>>>>>>>
49039>>>>>>>>>>>>>>>
49039>>>>>>>>>>>>>>>    //AB-StoreStart
49039>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49040>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49041>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49042>>>>>>>>>>>>>>>    //AB-StoreEnd
49042>>>>>>>>>>>>>>>
49042>>>>>>>>>>>>>>>CD_End_Object    // sl022
49044>>>>>>>>>>>>>>>>
49044>>>>>>>>>>>>>>>
49044>>>>>>>>>>>>>>>//AB/ End_Object    // prj
49044>>>>>>>>>>>>>
49044>>>>>>>>>>>>>//DDB-Selection-pkg-End
49044>>>>>>>>>>>>>//DDB-FileEnd
49044>>>>>>>>>>>    Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
49044>>>>>>>>>>>>>//DDB-FileStart
49044>>>>>>>>>>>>>//DDB-HeaderStart
49044>>>>>>>>>>>>>
49044>>>>>>>>>>>>>// File Name : WAPOMAST.DD
49044>>>>>>>>>>>>>// Class Name: Wapomast_DataDictionary
49044>>>>>>>>>>>>>// Revision  : 13
49044>>>>>>>>>>>>>// Version   : 2
49044>>>>>>>>>>>>>
49044>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49044>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49044>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49044>>>>>>>>>>>>>
49044>>>>>>>>>>>>>Open Wapomast
49046>>>>>>>>>>>>>Open Wax
49048>>>>>>>>>>>>>Open Wapokat
49050>>>>>>>>>>>>>Open Sysrecw
49052>>>>>>>>>>>>>
49052>>>>>>>>>>>>>//DDB-HeaderEnd
49052>>>>>>>>>>>>>//DDB-SelectionStart
49052>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
49052>>>>>>>>>>>>>Register_Object sl023
49052>>>>>>>>>>>>>//DDB-SelectionEnd
49052>>>>>>>>>>>>>
49052>>>>>>>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
49053>>>>>>>>>>>>>    // Update:
49053>>>>>>>>>>>>>    Procedure Update
49054>>>>>>>>>>>>>        Forward Send Update
49056>>>>>>>>>>>>>        // Insert Code Here
49056>>>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
49056>>>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
49056>>>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
49056>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
49057>>>>>>>>>>>>>    End_Procedure   // Update
49058>>>>>>>>>>>>> 
49058>>>>>>>>>>>>>     Procedure Creating
49059>>>>>>>>>>>>>        Forward Send Creating
49061>>>>>>>>>>>>>        // Insert Code Here
49061>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
49062>>>>>>>>>>>>>    End_Procedure   // Creating
49063>>>>>>>>>>>>>
49063>>>>>>>>>>>>>
49063>>>>>>>>>>>>>    // Define_Fields:
49063>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49063>>>>>>>>>>>>>
49063>>>>>>>>>>>>>    Procedure Define_Fields
49064>>>>>>>>>>>>>        Forward Send Define_Fields
49066>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49066>>>>>>>>>>>>>        //DDB-DefineFieldStart
49066>>>>>>>>>>>>>
49066>>>>>>>>>>>>>        Set Main_File            To Wapomast.File_Number
49067>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49068>>>>>>>>>>>>>
49068>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49069>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49070>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49071>>>>>>>>>>>>>
49071>>>>>>>>>>>>>        // Child (Client) file structure................
49071>>>>>>>>>>>>>        Send Add_Client_File  Wax.File_Number
49072>>>>>>>>>>>>>
49072>>>>>>>>>>>>>        // Parent (Server) file structure...............
49072>>>>>>>>>>>>>        Send Add_Server_File  Wapokat.File_Number
49073>>>>>>>>>>>>>
49073>>>>>>>>>>>>>        // External (System) file structure.............
49073>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49074>>>>>>>>>>>>>
49074>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
49077>>>>>>>>>>>>>
49077>>>>>>>>>>>>>        // Field-based properties.......................
49077>>>>>>>>>>>>>
49077>>>>>>>>>>>>>        // Wapomast.Wapokat_Code
49077>>>>>>>>>>>>>
49077>>>>>>>>>>>>>        // Wapomast.Wapokat_Recr
49077>>>>>>>>>>>>>
49077>>>>>>>>>>>>>        // Wapomast.Wapomast_Code
49077>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
49078>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
49079>>>>>>>>>>>>>
49079>>>>>>>>>>>>>        // Wapomast.Wapomast_Rec0
49079>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
49080>>>>>>>>>>>>>
49080>>>>>>>>>>>>>        // Wapomast.Wapomast_Descr
49080>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
49081>>>>>>>>>>>>>
49081>>>>>>>>>>>>>        // Wapomast.Wapomast_Recr
49081>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
49082>>>>>>>>>>>>>
49082>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49082>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49083>>>>>>>>>>>>>
49083>>>>>>>>>>>>>    // Field_Defaults:
49083>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49083>>>>>>>>>>>>>
49083>>>>>>>>>>>>>    Procedure Field_Defaults
49084>>>>>>>>>>>>>        Forward Send Field_Defaults
49086>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49086>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49086>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49086>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49087>>>>>>>>>>>>>
49087>>>>>>>>>>>>>End_Class    // Wapomast_DataDictionary
49088>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49088>>>>>>>>>>>>>
49088>>>>>>>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
49088>>>>>>>>>>>>>>>//AB/ Project sl023:apothkes
49088>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49088>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
49088>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>// Project Object Structure
49088>>>>>>>>>>>>>>>//   sl023 is a dbModalPanelSub
49088>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
49088>>>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
49088>>>>>>>>>>>>>>>//     oSelList is a dbListSub
49088>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49088>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49088>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>// Register all objects
49088>>>>>>>>>>>>>>>Register_Object oCancel_bn
49088>>>>>>>>>>>>>>>Register_Object oOK_bn
49088>>>>>>>>>>>>>>>Register_Object oSearch_bn
49088>>>>>>>>>>>>>>>Register_Object oSelList
49088>>>>>>>>>>>>>>>Register_Object sl023
49088>>>>>>>>>>>>>>>Register_Object Wapokat_DD
49088>>>>>>>>>>>>>>>Register_Object Wapomast_DD
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>//AB-IgnoreStart
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>Use DFAllEnt.pkg
49088>>>>>>>>>>>>>>>Use dbList.Sub
49088>>>>>>>>>>>>>>>Use Button.Sub
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>Use WAPOKAT.DD
49088>>>>>>>>>>>>>>>Use WAPOMAST.DD
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>//AB-IgnoreEnd
49088>>>>>>>>>>>>>>>
49088>>>>>>>>>>>>>>>Object sl023 is a dbModalPanelSub
49090>>>>>>>>>>>>>>>
49090>>>>>>>>>>>>>>>    //AB-StoreTopStart
49090>>>>>>>>>>>>>>>    property string psapokat public ''
49092>>>>>>>>>>>>>>>    //AB-StoreTopEnd
49092>>>>>>>>>>>>>>>
49092>>>>>>>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
49093>>>>>>>>>>>>>>>    Set Size to 126 260
49094>>>>>>>>>>>>>>>    Set Location to 4 19
49095>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49096>>>>>>>>>>>>>>>    Set Modal_State to FALSE
49097>>>>>>>>>>>>>>>
49097>>>>>>>>>>>>>>>    //AB-DDOStart
49097>>>>>>>>>>>>>>>
49097>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
49099>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
49100>>>>>>>>>>>>>>>
49100>>>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
49102>>>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
49103>>>>>>>>>>>>>>>
49103>>>>>>>>>>>>>>>        //AB-StoreStart
49103>>>>>>>>>>>>>>>        
49103>>>>>>>>>>>>>>>        begin_constraints
49105>>>>>>>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
49109>>>>>>>>>>>>>>>        
49109>>>>>>>>>>>>>>>        end_constraints
49112>>>>>>>>>>>>>>>        
49112>>>>>>>>>>>>>>>        //AB-StoreEnd
49112>>>>>>>>>>>>>>>
49112>>>>>>>>>>>>>>>    End_Object    // Wapomast_DD
49113>>>>>>>>>>>>>>>
49113>>>>>>>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
49114>>>>>>>>>>>>>>>    Set Server to (Wapomast_DD(self))
49115>>>>>>>>>>>>>>>
49115>>>>>>>>>>>>>>>    //AB-DDOEnd
49115>>>>>>>>>>>>>>>
49115>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
49117>>>>>>>>>>>>>>>        Set Main_File to Wapomast.File_Number
49118>>>>>>>>>>>>>>>        Set Server to (Wapokat_DD(self))
49119>>>>>>>>>>>>>>>        Set Size to 89 240
49120>>>>>>>>>>>>>>>        Set Location to 6 6
49121>>>>>>>>>>>>>>>
49121>>>>>>>>>>>>>>>        Begin_Row
49124>>>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
49125>>>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
49126>>>>>>>>>>>>>>>        End_Row
49131>>>>>>>>>>>>>>>
49131>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
49132>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
49133>>>>>>>>>>>>>>>        
49133>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 160
49134>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49135>>>>>>>>>>>>>>>        
49135>>>>>>>>>>>>>>>
49135>>>>>>>>>>>>>>>        //AB-StoreStart
49135>>>>>>>>>>>>>>>                    
49135>>>>>>>>>>>>>>>                    
49135>>>>>>>>>>>>>>>        //AB-StoreEnd
49135>>>>>>>>>>>>>>>
49135>>>>>>>>>>>>>>>    End_Object    // oSelList
49136>>>>>>>>>>>>>>>
49136>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49138>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49139>>>>>>>>>>>>>>>        Set Location to 92 81
49140>>>>>>>>>>>>>>>
49140>>>>>>>>>>>>>>>        //AB-StoreStart
49140>>>>>>>>>>>>>>>        Procedure OnClick
49142>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49143>>>>>>>>>>>>>>>        End_Procedure
49144>>>>>>>>>>>>>>>        //AB-StoreEnd
49144>>>>>>>>>>>>>>>
49144>>>>>>>>>>>>>>>    End_Object    // oOK_bn
49145>>>>>>>>>>>>>>>
49145>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49147>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49148>>>>>>>>>>>>>>>        Set Location to 92 135
49149>>>>>>>>>>>>>>>
49149>>>>>>>>>>>>>>>        //AB-StoreStart
49149>>>>>>>>>>>>>>>        Procedure OnClick
49151>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49152>>>>>>>>>>>>>>>        End_Procedure
49153>>>>>>>>>>>>>>>        //AB-StoreEnd
49153>>>>>>>>>>>>>>>
49153>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
49154>>>>>>>>>>>>>>>
49154>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49156>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49157>>>>>>>>>>>>>>>        Set Location to 92 191
49158>>>>>>>>>>>>>>>
49158>>>>>>>>>>>>>>>        //AB-StoreStart
49158>>>>>>>>>>>>>>>        Procedure OnClick
49160>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49161>>>>>>>>>>>>>>>        End_Procedure
49162>>>>>>>>>>>>>>>        //AB-StoreEnd
49162>>>>>>>>>>>>>>>
49162>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
49163>>>>>>>>>>>>>>>
49163>>>>>>>>>>>>>>>
49163>>>>>>>>>>>>>>>    //AB-StoreStart
49163>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49164>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49165>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49166>>>>>>>>>>>>>>>    
49166>>>>>>>>>>>>>>>    procedure activate
49168>>>>>>>>>>>>>>>        send rebuild_constraints to wapomast_dd
49169>>>>>>>>>>>>>>>        send beginning_of_data to osellist true
49170>>>>>>>>>>>>>>>        forward send activate
49172>>>>>>>>>>>>>>>    end_procedure
49173>>>>>>>>>>>>>>>    
49173>>>>>>>>>>>>>>>    
49173>>>>>>>>>>>>>>>    //AB-StoreEnd
49173>>>>>>>>>>>>>>>
49173>>>>>>>>>>>>>>>End_Object    // sl023
49174>>>>>>>>>>>>>>>
49174>>>>>>>>>>>>>>>//AB/ End_Object    // prj
49174>>>>>>>>>>>>>
49174>>>>>>>>>>>>>//DDB-Selection-pkg-End
49174>>>>>>>>>>>>>//DDB-FileEnd
49174>>>>>>>>>>>    Use WAX.DD
INCLUDING FILE: WAX.DD
49174>>>>>>>>>>>>>//DDB-FileStart
49174>>>>>>>>>>>>>//DDB-HeaderStart
49174>>>>>>>>>>>>>
49174>>>>>>>>>>>>>// File Name : WAX.DD
49174>>>>>>>>>>>>>// Class Name: Wax_DataDictionary
49174>>>>>>>>>>>>>// Revision  : 39
49174>>>>>>>>>>>>>// Version   : 2
49174>>>>>>>>>>>>>
49174>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49174>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49174>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49174>>>>>>>>>>>>>
49174>>>>>>>>>>>>>Open Wax
49176>>>>>>>>>>>>>Open Pmoves
49178>>>>>>>>>>>>>Open Wcmoves
49180>>>>>>>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
49182>>>>>>>>>>>>>Open Pmovesl
49184>>>>>>>>>>>>>Open Wapomast
49186>>>>>>>>>>>>>Open Sysrecw
49188>>>>>>>>>>>>>Open Syscurxr
49190>>>>>>>>>>>>>
49190>>>>>>>>>>>>>//DDB-HeaderEnd
49190>>>>>>>>>>>>>//DDB-SelectionStart
49190>>>>>>>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
49190>>>>>>>>>>>>>Register_Object Wax
49190>>>>>>>>>>>>>//DDB-SelectionEnd
49190>>>>>>>>>>>>>
49190>>>>>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
49192>>>>>>>>>>>>>Open Wapokat
49194>>>>>>>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
49196>>>>>>>>>>>>>
49196>>>>>>>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
49197>>>>>>>>>>>>>
49197>>>>>>>>>>>>>    Procedure Construct_Object
49198>>>>>>>>>>>>>        Forward Send Construct_Object
49200>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
49201>>>>>>>>>>>>>    End_Procedure //construct_object
49202>>>>>>>>>>>>>
49202>>>>>>>>>>>>>    Procedure OnConstrain
49203>>>>>>>>>>>>>        Forward Send OnConstrain
49205>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
49207>>>>>>>>>>>>>        End
49207>>>>>>>>>>>>>>
49207>>>>>>>>>>>>>        Else Begin
49208>>>>>>>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
49210>>>>>>>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
49212>>>>>>>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
49214>>>>>>>>>>>>>        End
49214>>>>>>>>>>>>>>
49214>>>>>>>>>>>>>    End_Procedure
49215>>>>>>>>>>>>>
49215>>>>>>>>>>>>>
49215>>>>>>>>>>>>>    // Update:
49215>>>>>>>>>>>>>    Procedure Update
49216>>>>>>>>>>>>>        Forward Send Update
49218>>>>>>>>>>>>>        // Insert Code Here
49218>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
49219>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
49220>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
49221>>>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
49222>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
49223>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
49224>>>>>>>>>>>>>    End_Procedure   // Update
49225>>>>>>>>>>>>>
49225>>>>>>>>>>>>>     Procedure Creating
49226>>>>>>>>>>>>>        Forward Send Creating
49228>>>>>>>>>>>>>        // Insert Code Here
49228>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
49229>>>>>>>>>>>>>    End_Procedure   // Creating
49230>>>>>>>>>>>>>
49230>>>>>>>>>>>>>
49230>>>>>>>>>>>>>
49230>>>>>>>>>>>>>    // Define_Fields:
49230>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49230>>>>>>>>>>>>>
49230>>>>>>>>>>>>>    Procedure Define_Fields
49231>>>>>>>>>>>>>        Forward Send Define_Fields
49233>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49233>>>>>>>>>>>>>        //DDB-DefineFieldStart
49233>>>>>>>>>>>>>
49233>>>>>>>>>>>>>        Set Main_File            To Wax.File_Number
49234>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49235>>>>>>>>>>>>>
49235>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49236>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49237>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49238>>>>>>>>>>>>>
49238>>>>>>>>>>>>>        // Child (Client) file structure................
49238>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
49239>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
49240>>>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
49241>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
49242>>>>>>>>>>>>>
49242>>>>>>>>>>>>>        // Parent (Server) file structure...............
49242>>>>>>>>>>>>>        Send Add_Server_File  Wapomast.File_Number
49243>>>>>>>>>>>>>
49243>>>>>>>>>>>>>        // External (System) file structure.............
49243>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49244>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49245>>>>>>>>>>>>>
49245>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Field-based properties.......................
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Wax.Company_Code
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Wax.Branch_Code
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Wax.Year_Year
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Wax.Wapokat_Code
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Wax.Wapomast_Code
49248>>>>>>>>>>>>>
49248>>>>>>>>>>>>>        // Wax.Wax_Code
49248>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
49249>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
49250>>>>>>>>>>>>>
49250>>>>>>>>>>>>>        // Wax.Year_Recr
49250>>>>>>>>>>>>>
49250>>>>>>>>>>>>>        // Wax.Wapomast_Recr
49250>>>>>>>>>>>>>
49250>>>>>>>>>>>>>        // Wax.Wax_Rec0
49250>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
49251>>>>>>>>>>>>>
49251>>>>>>>>>>>>>        // Wax.Wax_Recr
49251>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
49252>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
49253>>>>>>>>>>>>>
49253>>>>>>>>>>>>>        // Wax.Wax_Descr
49253>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
49254>>>>>>>>>>>>>
49254>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49254>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49255>>>>>>>>>>>>>
49255>>>>>>>>>>>>>    // Field_Defaults:
49255>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49255>>>>>>>>>>>>>
49255>>>>>>>>>>>>>    Procedure Field_Defaults
49256>>>>>>>>>>>>>        Forward Send Field_Defaults
49258>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49258>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49258>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49258>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49259>>>>>>>>>>>>>
49259>>>>>>>>>>>>>End_Class    // Wax_DataDictionary
49260>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49260>>>>>>>>>>>>>
49260>>>>>>>>>>>>>Use Wax.SL           // Wax
INCLUDING FILE: WAX.SL
49260>>>>>>>>>>>>>>>//AB/ Project Wax:Lookup Apothikhs
49260>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49260>>>>>>>>>>>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
49260>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Wax.SL"
49260>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>// Project Object Structure
49260>>>>>>>>>>>>>>>//   Wax is a dbModalPanelSub
49260>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
49260>>>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
49260>>>>>>>>>>>>>>>//     Wax_DD is a DataDictionary
49260>>>>>>>>>>>>>>>//     oSelList is a dbListSub
49260>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49260>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49260>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>// Register all objects
49260>>>>>>>>>>>>>>>Register_Object oCancel_bn
49260>>>>>>>>>>>>>>>Register_Object oOK_bn
49260>>>>>>>>>>>>>>>Register_Object oSearch_bn
49260>>>>>>>>>>>>>>>Register_Object oSelList
49260>>>>>>>>>>>>>>>Register_Object Wapokat_DD
49260>>>>>>>>>>>>>>>Register_Object Wapomast_DD
49260>>>>>>>>>>>>>>>Register_Object Wax
49260>>>>>>>>>>>>>>>Register_Object Wax_DD
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>//AB-IgnoreStart
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>Use DFAllEnt.pkg
49260>>>>>>>>>>>>>>>Use dbList.Sub
49260>>>>>>>>>>>>>>>Use Button.Sub
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>Use WAPOKAT.DD
49260>>>>>>>>>>>>>>>Use WAPOMAST.DD
49260>>>>>>>>>>>>>>>Use WAX.DD
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>//AB-IgnoreEnd
49260>>>>>>>>>>>>>>>
49260>>>>>>>>>>>>>>>Object Wax is a dbModalPanelSub
49262>>>>>>>>>>>>>>>
49262>>>>>>>>>>>>>>>    //AB-StoreTopStart
49262>>>>>>>>>>>>>>>                                    
49262>>>>>>>>>>>>>>>    Property Integer    piMustConstrain Public  0
49264>>>>>>>>>>>>>>>    Property Integer    piYear          Public  0
49266>>>>>>>>>>>>>>>    Property String     psCompany       Public ''
49268>>>>>>>>>>>>>>>    Property String     psBranch        Public ''
49270>>>>>>>>>>>>>>>    Property String     psWapokat       Public ''
49272>>>>>>>>>>>>>>>    
49272>>>>>>>>>>>>>>>    //AB-StoreTopEnd
49272>>>>>>>>>>>>>>>
49272>>>>>>>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
49273>>>>>>>>>>>>>>>    Set Size to 148 355
49274>>>>>>>>>>>>>>>    Set Location to 8 21
49275>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49276>>>>>>>>>>>>>>>    Set Modal_State to FALSE
49277>>>>>>>>>>>>>>>
49277>>>>>>>>>>>>>>>    //AB-DDOStart
49277>>>>>>>>>>>>>>>
49277>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
49279>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
49280>>>>>>>>>>>>>>>
49280>>>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
49282>>>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
49283>>>>>>>>>>>>>>>    End_Object    // Wapomast_DD
49284>>>>>>>>>>>>>>>
49284>>>>>>>>>>>>>>>    Object Wax_DD is a Wax_DataDictionary
49286>>>>>>>>>>>>>>>        Set DDO_Server to (Wapomast_DD(self))
49287>>>>>>>>>>>>>>>
49287>>>>>>>>>>>>>>>        //AB-StoreStart
49287>>>>>>>>>>>>>>>        
49287>>>>>>>>>>>>>>>        Begin_Constraints
49289>>>>>>>>>>>>>>>            Integer iMustConstrain iYear
49290>>>>>>>>>>>>>>>            String  sCompany sBranch sWapokat
49290>>>>>>>>>>>>>>>            Get piMustConstrain to iMustConstrain
49291>>>>>>>>>>>>>>>            If (iMustConstrain) Begin
49293>>>>>>>>>>>>>>>                Get piYear     to  iYear
49294>>>>>>>>>>>>>>>                Get psCompany  to  sCompany
49295>>>>>>>>>>>>>>>                Get psBranch   to  sBranch
49296>>>>>>>>>>>>>>>                Get psWapokat  to  sWapokat
49297>>>>>>>>>>>>>>>                If (sCompany<>'') Begin
49299>>>>>>>>>>>>>>>                    Constrain Wax.Company_Code eq sCompany
49301>>>>>>>>>>>>>>>                    If (sBranch<>'') Begin
49303>>>>>>>>>>>>>>>                        Constrain Wax.Branch_Code eq sBranch
49305>>>>>>>>>>>>>>>                        If (iYear<>0) Begin
49307>>>>>>>>>>>>>>>                            Constrain Wax.Year_Year eq iYear
49309>>>>>>>>>>>>>>>                            If (sWapokat<>'') Begin
49311>>>>>>>>>>>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
49313>>>>>>>>>>>>>>>                            End
49313>>>>>>>>>>>>>>>>
49313>>>>>>>>>>>>>>>                        End
49313>>>>>>>>>>>>>>>>
49313>>>>>>>>>>>>>>>                    End
49313>>>>>>>>>>>>>>>>
49313>>>>>>>>>>>>>>>                End
49313>>>>>>>>>>>>>>>>
49313>>>>>>>>>>>>>>>            End
49313>>>>>>>>>>>>>>>>
49313>>>>>>>>>>>>>>>        End_Constraints
49316>>>>>>>>>>>>>>>        
49316>>>>>>>>>>>>>>>        
49316>>>>>>>>>>>>>>>        
49316>>>>>>>>>>>>>>>        
49316>>>>>>>>>>>>>>>        
49316>>>>>>>>>>>>>>>        
49316>>>>>>>>>>>>>>>        //AB-StoreEnd
49316>>>>>>>>>>>>>>>
49316>>>>>>>>>>>>>>>    End_Object    // Wax_DD
49317>>>>>>>>>>>>>>>
49317>>>>>>>>>>>>>>>    Set Main_DD to (Wax_DD(self))
49318>>>>>>>>>>>>>>>    Set Server to (Wax_DD(self))
49319>>>>>>>>>>>>>>>
49319>>>>>>>>>>>>>>>    //AB-DDOEnd
49319>>>>>>>>>>>>>>>
49319>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
49321>>>>>>>>>>>>>>>        Set Main_File to Wax.File_Number
49322>>>>>>>>>>>>>>>        Set Size to 105 340
49323>>>>>>>>>>>>>>>        Set Location to 5 6
49324>>>>>>>>>>>>>>>
49324>>>>>>>>>>>>>>>        Begin_Row
49327>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_recr
49328>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_code
49329>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_descr
49330>>>>>>>>>>>>>>>        End_Row
49335>>>>>>>>>>>>>>>
49335>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 33
49336>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "Recr"
49337>>>>>>>>>>>>>>>        
49337>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 80
49338>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
49339>>>>>>>>>>>>>>>        
49339>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 219
49340>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
49341>>>>>>>>>>>>>>>        
49341>>>>>>>>>>>>>>>
49341>>>>>>>>>>>>>>>        //AB-StoreStart
49341>>>>>>>>>>>>>>>        
49341>>>>>>>>>>>>>>>        Procedure Activate
49343>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Wax_DD
49344>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
49345>>>>>>>>>>>>>>>            Forward Send Activate
49347>>>>>>>>>>>>>>>        End_procedure
49348>>>>>>>>>>>>>>>        
49348>>>>>>>>>>>>>>>        //AB-StoreEnd
49348>>>>>>>>>>>>>>>
49348>>>>>>>>>>>>>>>    End_Object    // oSelList
49349>>>>>>>>>>>>>>>
49349>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49351>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49352>>>>>>>>>>>>>>>        Set Location to 113 186
49353>>>>>>>>>>>>>>>
49353>>>>>>>>>>>>>>>        //AB-StoreStart
49353>>>>>>>>>>>>>>>        Procedure OnClick
49355>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49356>>>>>>>>>>>>>>>        End_Procedure
49357>>>>>>>>>>>>>>>        //AB-StoreEnd
49357>>>>>>>>>>>>>>>
49357>>>>>>>>>>>>>>>    End_Object    // oOK_bn
49358>>>>>>>>>>>>>>>
49358>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49360>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49361>>>>>>>>>>>>>>>        Set Location to 113 241
49362>>>>>>>>>>>>>>>
49362>>>>>>>>>>>>>>>        //AB-StoreStart
49362>>>>>>>>>>>>>>>        Procedure OnClick
49364>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49365>>>>>>>>>>>>>>>        End_Procedure
49366>>>>>>>>>>>>>>>        //AB-StoreEnd
49366>>>>>>>>>>>>>>>
49366>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
49367>>>>>>>>>>>>>>>
49367>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49369>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49370>>>>>>>>>>>>>>>        Set Location to 113 296
49371>>>>>>>>>>>>>>>
49371>>>>>>>>>>>>>>>        //AB-StoreStart
49371>>>>>>>>>>>>>>>        Procedure OnClick
49373>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49374>>>>>>>>>>>>>>>        End_Procedure
49375>>>>>>>>>>>>>>>        //AB-StoreEnd
49375>>>>>>>>>>>>>>>
49375>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
49376>>>>>>>>>>>>>>>
49376>>>>>>>>>>>>>>>
49376>>>>>>>>>>>>>>>    //AB-StoreStart
49376>>>>>>>>>>>>>>>                                    
49376>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49377>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49378>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49379>>>>>>>>>>>>>>>    
49379>>>>>>>>>>>>>>>    
49379>>>>>>>>>>>>>>>    
49379>>>>>>>>>>>>>>>    
49379>>>>>>>>>>>>>>>    
49379>>>>>>>>>>>>>>>    
49379>>>>>>>>>>>>>>>    //AB-StoreEnd
49379>>>>>>>>>>>>>>>
49379>>>>>>>>>>>>>>>End_Object    // Wax
49380>>>>>>>>>>>>>>>
49380>>>>>>>>>>>>>>>//AB/ End_Object    // prj
49380>>>>>>>>>>>>>
49380>>>>>>>>>>>>>//DDB-Selection-pkg-End
49380>>>>>>>>>>>>>//DDB-FileEnd
49380>>>>>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
49380>>>>>>>>>>>>>//DDB-FileStart
49380>>>>>>>>>>>>>//DDB-HeaderStart
49380>>>>>>>>>>>>>
49380>>>>>>>>>>>>>// File Name : UNITS.DD
49380>>>>>>>>>>>>>// Class Name: Units_DataDictionary
49380>>>>>>>>>>>>>// Revision  : 17
49380>>>>>>>>>>>>>// Version   : 2
49380>>>>>>>>>>>>>
49380>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49380>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49380>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49380>>>>>>>>>>>>>
49380>>>>>>>>>>>>>Open Units
49382>>>>>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
49384>>>>>>>>>>>>>Open Sysrecw
49386>>>>>>>>>>>>>Open Syscurxr
49388>>>>>>>>>>>>>
49388>>>>>>>>>>>>>//DDB-HeaderEnd
49388>>>>>>>>>>>>>//DDB-SelectionStart
49388>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
49388>>>>>>>>>>>>>Register_Object sl025
49388>>>>>>>>>>>>>//DDB-SelectionEnd
49388>>>>>>>>>>>>>
49388>>>>>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
49389>>>>>>>>>>>>>
49389>>>>>>>>>>>>>    Procedure Save_Main_File
49390>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
49392>>>>>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
49395>>>>>>>>>>>>>        End
49395>>>>>>>>>>>>>>
49395>>>>>>>>>>>>>        Forward Send Save_Main_File
49397>>>>>>>>>>>>>    End_Procedure
49398>>>>>>>>>>>>>
49398>>>>>>>>>>>>>
49398>>>>>>>>>>>>>     Procedure Creating
49399>>>>>>>>>>>>>        Forward Send Creating
49401>>>>>>>>>>>>>        // Insert Code Here
49401>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
49402>>>>>>>>>>>>>    End_Procedure   // Creating
49403>>>>>>>>>>>>>
49403>>>>>>>>>>>>>
49403>>>>>>>>>>>>>
49403>>>>>>>>>>>>>    // Define_Fields:
49403>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49403>>>>>>>>>>>>>
49403>>>>>>>>>>>>>    Procedure Define_Fields
49404>>>>>>>>>>>>>        Forward Send Define_Fields
49406>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49406>>>>>>>>>>>>>        //DDB-DefineFieldStart
49406>>>>>>>>>>>>>
49406>>>>>>>>>>>>>        Set Main_File            To Units.File_Number
49407>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49408>>>>>>>>>>>>>
49408>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49409>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49410>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49411>>>>>>>>>>>>>
49411>>>>>>>>>>>>>        // Child (Client) file structure................
49411>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49412>>>>>>>>>>>>>
49412>>>>>>>>>>>>>        // External (System) file structure.............
49412>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49413>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49414>>>>>>>>>>>>>
49414>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
49417>>>>>>>>>>>>>
49417>>>>>>>>>>>>>        // Field-based properties.......................
49417>>>>>>>>>>>>>
49417>>>>>>>>>>>>>        // Units.Units_Code
49417>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
49418>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
49419>>>>>>>>>>>>>
49419>>>>>>>>>>>>>        // Units.Units_Rec0
49419>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
49420>>>>>>>>>>>>>
49420>>>>>>>>>>>>>        // Units.Units_Descr
49420>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
49421>>>>>>>>>>>>>
49421>>>>>>>>>>>>>        // Units.Units_Recr
49421>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
49422>>>>>>>>>>>>>
49422>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49422>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49423>>>>>>>>>>>>>
49423>>>>>>>>>>>>>    // Field_Defaults:
49423>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49423>>>>>>>>>>>>>
49423>>>>>>>>>>>>>    Procedure Field_Defaults
49424>>>>>>>>>>>>>        Forward Send Field_Defaults
49426>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49426>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49426>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49426>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49427>>>>>>>>>>>>>
49427>>>>>>>>>>>>>End_Class    // Units_DataDictionary
49428>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49428>>>>>>>>>>>>>
49428>>>>>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
49428>>>>>>>>>>>>>>>//AB/ Project sl025
49428>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49428>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
49428>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
49428>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>// Project Object Structure
49428>>>>>>>>>>>>>>>//   sl025 is a dbModalPanelSub
49428>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
49428>>>>>>>>>>>>>>>//     oSelList is a dbListSub
49428>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49428>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49428>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>// Register all objects
49428>>>>>>>>>>>>>>>Register_Object oCancel_bn
49428>>>>>>>>>>>>>>>Register_Object oOK_bn
49428>>>>>>>>>>>>>>>Register_Object oSearch_bn
49428>>>>>>>>>>>>>>>Register_Object oSelList
49428>>>>>>>>>>>>>>>Register_Object sl025
49428>>>>>>>>>>>>>>>Register_Object Units_DD
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>//AB-IgnoreStart
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>Use DFAllEnt.pkg
49428>>>>>>>>>>>>>>>Use dbList.Sub
49428>>>>>>>>>>>>>>>Use Button.Sub
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>Use UNITS.DD
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>//AB-IgnoreEnd
49428>>>>>>>>>>>>>>>
49428>>>>>>>>>>>>>>>Object sl025 is a dbModalPanelSub
49430>>>>>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
49431>>>>>>>>>>>>>>>    Set Size to 148 297
49432>>>>>>>>>>>>>>>    Set Location to 4 5
49433>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49434>>>>>>>>>>>>>>>    Set Modal_State to FALSE
49435>>>>>>>>>>>>>>>
49435>>>>>>>>>>>>>>>    //AB-DDOStart
49435>>>>>>>>>>>>>>>
49435>>>>>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
49437>>>>>>>>>>>>>>>    End_Object    // Units_DD
49438>>>>>>>>>>>>>>>
49438>>>>>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
49439>>>>>>>>>>>>>>>    Set Server to (Units_DD(self))
49440>>>>>>>>>>>>>>>
49440>>>>>>>>>>>>>>>    //AB-DDOEnd
49440>>>>>>>>>>>>>>>
49440>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
49442>>>>>>>>>>>>>>>        set main_file to units.file_number 
49443>>>>>>>>>>>>>>>        Set Size to 105 280
49444>>>>>>>>>>>>>>>        Set Location to 6 6
49445>>>>>>>>>>>>>>>
49445>>>>>>>>>>>>>>>        Begin_Row
49448>>>>>>>>>>>>>>>            entry_item units.units_code 
49449>>>>>>>>>>>>>>>            entry_item units.units_descr 
49450>>>>>>>>>>>>>>>        End_Row
49455>>>>>>>>>>>>>>>
49455>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 91
49456>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
49457>>>>>>>>>>>>>>>        
49457>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 180
49458>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49459>>>>>>>>>>>>>>>        
49459>>>>>>>>>>>>>>>    End_Object    // oSelList
49460>>>>>>>>>>>>>>>
49460>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49462>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49463>>>>>>>>>>>>>>>        Set Location to 115 126
49464>>>>>>>>>>>>>>>
49464>>>>>>>>>>>>>>>        //AB-StoreStart
49464>>>>>>>>>>>>>>>        Procedure OnClick
49466>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49467>>>>>>>>>>>>>>>        End_Procedure
49468>>>>>>>>>>>>>>>        //AB-StoreEnd
49468>>>>>>>>>>>>>>>
49468>>>>>>>>>>>>>>>    End_Object    // oOK_bn
49469>>>>>>>>>>>>>>>
49469>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49471>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49472>>>>>>>>>>>>>>>        Set Location to 115 181
49473>>>>>>>>>>>>>>>
49473>>>>>>>>>>>>>>>        //AB-StoreStart
49473>>>>>>>>>>>>>>>        Procedure OnClick
49475>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49476>>>>>>>>>>>>>>>        End_Procedure
49477>>>>>>>>>>>>>>>        //AB-StoreEnd
49477>>>>>>>>>>>>>>>
49477>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
49478>>>>>>>>>>>>>>>
49478>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49480>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49481>>>>>>>>>>>>>>>        Set Location to 115 236
49482>>>>>>>>>>>>>>>
49482>>>>>>>>>>>>>>>        //AB-StoreStart
49482>>>>>>>>>>>>>>>        Procedure OnClick
49484>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49485>>>>>>>>>>>>>>>        End_Procedure
49486>>>>>>>>>>>>>>>        //AB-StoreEnd
49486>>>>>>>>>>>>>>>
49486>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
49487>>>>>>>>>>>>>>>
49487>>>>>>>>>>>>>>>
49487>>>>>>>>>>>>>>>    //AB-StoreStart
49487>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49488>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49489>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49490>>>>>>>>>>>>>>>    //AB-StoreEnd
49490>>>>>>>>>>>>>>>
49490>>>>>>>>>>>>>>>End_Object    // sl025
49491>>>>>>>>>>>>>>>
49491>>>>>>>>>>>>>>>//AB/ End_Object    // prj
49491>>>>>>>>>>>>>
49491>>>>>>>>>>>>>//DDB-Selection-pkg-End
49491>>>>>>>>>>>>>//DDB-FileEnd
49491>>>>>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
49491>>>>>>>>>>>>>//DDB-FileStart
49491>>>>>>>>>>>>>//DDB-HeaderStart
49491>>>>>>>>>>>>>
49491>>>>>>>>>>>>>// File Name : WITEMKAT.DD
49491>>>>>>>>>>>>>// Class Name: Witemkat_DataDictionary
49491>>>>>>>>>>>>>// Revision  : 26
49491>>>>>>>>>>>>>
49491>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49491>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49491>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49491>>>>>>>>>>>>>
49491>>>>>>>>>>>>>Open Witemkat
49493>>>>>>>>>>>>>Open Item
49495>>>>>>>>>>>>>Open Sysrecw
49497>>>>>>>>>>>>>Open Syscurxr
49499>>>>>>>>>>>>>
49499>>>>>>>>>>>>>//DDB-HeaderEnd
49499>>>>>>>>>>>>>//DDB-SelectionStart
49499>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
49499>>>>>>>>>>>>>Register_Object sl024
49499>>>>>>>>>>>>>//DDB-SelectionEnd
49499>>>>>>>>>>>>>
49499>>>>>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
49500>>>>>>>>>>>>>
49500>>>>>>>>>>>>>     Procedure Creating
49501>>>>>>>>>>>>>        Forward Send Creating
49503>>>>>>>>>>>>>        // Insert Code Here
49503>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
49504>>>>>>>>>>>>>    End_Procedure   // Creating
49505>>>>>>>>>>>>>   
49505>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
49506>>>>>>>>>>>>>        Local Integer iReturnVal icheck
49507>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
49509>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
49511>>>>>>>>>>>>>            // Insert Code Here
49511>>>>>>>>>>>>>//           if (witemkat.codegl <> '') begin
49511>>>>>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
49511>>>>>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
49511>>>>>>>>>>>>>//           end
49511>>>>>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49514>>>>>>>>>>>>>        End
49514>>>>>>>>>>>>>>
49514>>>>>>>>>>>>>        Function_Return iReturnVal
49515>>>>>>>>>>>>>    End_Function   // Validate_Save
49516>>>>>>>>>>>>> 
49516>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49517>>>>>>>>>>>>>        String lsError_Message
49518>>>>>>>>>>>>>        Case Begin
49518>>>>>>>>>>>>>            Case (iError_Num = 24001)
49520>>>>>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
49521>>>>>>>>>>>>>              Case Break
49522>>>>>>>>>>>>>            Case Else
49522>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
49524>>>>>>>>>>>>>        Case End
49524>>>>>>>>>>>>>        Error iError_Num lsError_Message
49525>>>>>>>>>>>>>>
49525>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
49526>>>>>>>>>>>>>
49526>>>>>>>>>>>>>
49526>>>>>>>>>>>>>
49526>>>>>>>>>>>>>    // Define_Fields:
49526>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49526>>>>>>>>>>>>>
49526>>>>>>>>>>>>>    Procedure Define_Fields
49527>>>>>>>>>>>>>        Forward Send Define_Fields
49529>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49529>>>>>>>>>>>>>        //DDB-DefineFieldStart
49529>>>>>>>>>>>>>
49529>>>>>>>>>>>>>        Set Main_File            To Witemkat.File_Number
49530>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49531>>>>>>>>>>>>>
49531>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49532>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49533>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49534>>>>>>>>>>>>>
49534>>>>>>>>>>>>>        // Child (Client) file structure................
49534>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49535>>>>>>>>>>>>>
49535>>>>>>>>>>>>>        // External (System) file structure.............
49535>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49536>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49537>>>>>>>>>>>>>
49537>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
49540>>>>>>>>>>>>>
49540>>>>>>>>>>>>>        // Field-based properties.......................
49540>>>>>>>>>>>>>
49540>>>>>>>>>>>>>        // Witemkat.Witemkat_Code  
49540>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code   To DD_AUTOFIND   
49541>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code   To (sl024(Self))
49542>>>>>>>>>>>>>
49542>>>>>>>>>>>>>        // Witemkat.Witemkat_Rec0  
49542>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0   To DD_AUTOFIND   
49543>>>>>>>>>>>>>
49543>>>>>>>>>>>>>        // Witemkat.Witemkat_Descr 
49543>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr  To (sl024(Self))
49544>>>>>>>>>>>>>
49544>>>>>>>>>>>>>        // Witemkat.Witemkat_Recr  
49544>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr   To DD_AUTOFIND   
49545>>>>>>>>>>>>>
49545>>>>>>>>>>>>>        // Witemkat.Codeglpol      
49545>>>>>>>>>>>>>
49545>>>>>>>>>>>>>        // Witemkat.Codeglago      
49545>>>>>>>>>>>>>
49545>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49545>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49546>>>>>>>>>>>>>
49546>>>>>>>>>>>>>    // Field_Defaults:
49546>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49546>>>>>>>>>>>>>
49546>>>>>>>>>>>>>    Procedure Field_Defaults
49547>>>>>>>>>>>>>        Forward Send Field_Defaults
49549>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49549>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49549>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49549>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49550>>>>>>>>>>>>>
49550>>>>>>>>>>>>>End_Class    // Witemkat_DataDictionary
49551>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49551>>>>>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
49551>>>>>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
49551>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49551>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
49551>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>// Project Object Structure
49551>>>>>>>>>>>>>>>//   sl024 is a dbModalPanelSub
49551>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
49551>>>>>>>>>>>>>>>//     oSelList is a dbListSub
49551>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49551>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49551>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>// Register all objects
49551>>>>>>>>>>>>>>>Register_Object oCancel_bn
49551>>>>>>>>>>>>>>>Register_Object oOK_bn
49551>>>>>>>>>>>>>>>Register_Object oSearch_bn
49551>>>>>>>>>>>>>>>Register_Object oSelList
49551>>>>>>>>>>>>>>>Register_Object sl024
49551>>>>>>>>>>>>>>>Register_Object Witemkat_DD
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>//AB-IgnoreStart
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>Use DFAllEnt.pkg
49551>>>>>>>>>>>>>>>Use dbList.Sub
49551>>>>>>>>>>>>>>>Use Button.Sub
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>Use WITEMKAT.DD
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>//AB-IgnoreEnd
49551>>>>>>>>>>>>>>>
49551>>>>>>>>>>>>>>>Object sl024 is a dbModalPanelSub
49553>>>>>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
49554>>>>>>>>>>>>>>>    Set Size to 217 375
49555>>>>>>>>>>>>>>>    Set Location to 4 5
49556>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49557>>>>>>>>>>>>>>>    Set Modal_State to FALSE
49558>>>>>>>>>>>>>>>
49558>>>>>>>>>>>>>>>    //AB-DDOStart
49558>>>>>>>>>>>>>>>
49558>>>>>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
49560>>>>>>>>>>>>>>>    End_Object    // Witemkat_DD
49561>>>>>>>>>>>>>>>
49561>>>>>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
49562>>>>>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
49563>>>>>>>>>>>>>>>
49563>>>>>>>>>>>>>>>    //AB-DDOEnd
49563>>>>>>>>>>>>>>>
49563>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
49565>>>>>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
49566>>>>>>>>>>>>>>>        Set Size to 175 357
49567>>>>>>>>>>>>>>>        Set Location to 6 6
49568>>>>>>>>>>>>>>>
49568>>>>>>>>>>>>>>>        Begin_Row
49571>>>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
49572>>>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
49573>>>>>>>>>>>>>>>        End_Row
49578>>>>>>>>>>>>>>>
49578>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 124
49579>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
49580>>>>>>>>>>>>>>>        
49580>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 223
49581>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49582>>>>>>>>>>>>>>>        
49582>>>>>>>>>>>>>>>    End_Object    // oSelList
49583>>>>>>>>>>>>>>>
49583>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49585>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49586>>>>>>>>>>>>>>>        Set Location to 186 210
49587>>>>>>>>>>>>>>>
49587>>>>>>>>>>>>>>>        //AB-StoreStart
49587>>>>>>>>>>>>>>>        Procedure OnClick
49589>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49590>>>>>>>>>>>>>>>        End_Procedure
49591>>>>>>>>>>>>>>>        //AB-StoreEnd
49591>>>>>>>>>>>>>>>
49591>>>>>>>>>>>>>>>    End_Object    // oOK_bn
49592>>>>>>>>>>>>>>>
49592>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49594>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49595>>>>>>>>>>>>>>>        Set Location to 186 265
49596>>>>>>>>>>>>>>>
49596>>>>>>>>>>>>>>>        //AB-StoreStart
49596>>>>>>>>>>>>>>>        Procedure OnClick
49598>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49599>>>>>>>>>>>>>>>        End_Procedure
49600>>>>>>>>>>>>>>>        //AB-StoreEnd
49600>>>>>>>>>>>>>>>
49600>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
49601>>>>>>>>>>>>>>>
49601>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49603>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49604>>>>>>>>>>>>>>>        Set Location to 186 320
49605>>>>>>>>>>>>>>>
49605>>>>>>>>>>>>>>>        //AB-StoreStart
49605>>>>>>>>>>>>>>>        Procedure OnClick
49607>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49608>>>>>>>>>>>>>>>        End_Procedure
49609>>>>>>>>>>>>>>>        //AB-StoreEnd
49609>>>>>>>>>>>>>>>
49609>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
49610>>>>>>>>>>>>>>>
49610>>>>>>>>>>>>>>>
49610>>>>>>>>>>>>>>>    //AB-StoreStart
49610>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49611>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49612>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49613>>>>>>>>>>>>>>>    //AB-StoreEnd
49613>>>>>>>>>>>>>>>
49613>>>>>>>>>>>>>>>End_Object    // sl024
49614>>>>>>>>>>>>>>>
49614>>>>>>>>>>>>>>>//AB/ End_Object    // prj
49614>>>>>>>>>>>>>//DDB-Selection-pkg-End
49614>>>>>>>>>>>>>//DDB-FileEnd
49614>>>>>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
49614>>>>>>>>>>>>>//DDB-FileStart
49614>>>>>>>>>>>>>//DDB-HeaderStart
49614>>>>>>>>>>>>>
49614>>>>>>>>>>>>>// File Name : FPA.DD
49614>>>>>>>>>>>>>// Class Name: Fpa_DataDictionary
49614>>>>>>>>>>>>>// Revision  : 34
49614>>>>>>>>>>>>>// Version   : 2
49614>>>>>>>>>>>>>
49614>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49614>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49614>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49614>>>>>>>>>>>>>
49614>>>>>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
49616>>>>>>>>>>>>>Open Iteml
49618>>>>>>>>>>>>>Open Partlfpa
49620>>>>>>>>>>>>>Open Item
49622>>>>>>>>>>>>>
49622>>>>>>>>>>>>>//DDB-HeaderEnd
49622>>>>>>>>>>>>>//DDB-SelectionStart
49622>>>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
49622>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
49622>>>>>>>>>>>>>Register_Object Fpa
49622>>>>>>>>>>>>>Register_Object sl150
49622>>>>>>>>>>>>>//DDB-SelectionEnd
49622>>>>>>>>>>>>>
49622>>>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
49623>>>>>>>>>>>>> 
49623>>>>>>>>>>>>>    // Validate_Save:
49623>>>>>>>>>>>>> 
49623>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
49624>>>>>>>>>>>>>        Local Integer iReturnVal icheck
49625>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
49627>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
49629>>>>>>>>>>>>>            // Insert Code Here
49629>>>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
49629>>>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
49629>>>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
49629>>>>>>>>>>>>>         //  end
49629>>>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
49629>>>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
49629>>>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
49629>>>>>>>>>>>>>         //  end   
49629>>>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49629>>>>>>>>>>>>>        End
49629>>>>>>>>>>>>>>
49629>>>>>>>>>>>>>        Function_Return iReturnVal
49630>>>>>>>>>>>>>    End_Function   // Validate_Save
49631>>>>>>>>>>>>> 
49631>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49632>>>>>>>>>>>>>        String lsError_Message
49633>>>>>>>>>>>>>        Case Begin
49633>>>>>>>>>>>>>            Case (iError_Num = 104001)
49635>>>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
49636>>>>>>>>>>>>>              Case Break
49637>>>>>>>>>>>>>            Case (iError_Num = 104002)
49640>>>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
49641>>>>>>>>>>>>>              Case Break
49642>>>>>>>>>>>>>            Case Else
49642>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
49644>>>>>>>>>>>>>        Case End
49644>>>>>>>>>>>>>        Error iError_Num lsError_Message
49645>>>>>>>>>>>>>>
49645>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
49646>>>>>>>>>>>>>
49646>>>>>>>>>>>>>    // Define_Fields:
49646>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49646>>>>>>>>>>>>>
49646>>>>>>>>>>>>>    Procedure Define_Fields
49647>>>>>>>>>>>>>        Forward Send Define_Fields
49649>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49649>>>>>>>>>>>>>        //DDB-DefineFieldStart
49649>>>>>>>>>>>>>
49649>>>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
49650>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49651>>>>>>>>>>>>>
49651>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49652>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49653>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49654>>>>>>>>>>>>>
49654>>>>>>>>>>>>>        // Child (Client) file structure................
49654>>>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
49655>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
49656>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49657>>>>>>>>>>>>>
49657>>>>>>>>>>>>>        // Field-based properties.......................
49657>>>>>>>>>>>>>
49657>>>>>>>>>>>>>        // Fpa.Fpa_Pososto
49657>>>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
49658>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
49659>>>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
49660>>>>>>>>>>>>>
49660>>>>>>>>>>>>>        // Fpa.Fpa_Descr
49660>>>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
49661>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
49662>>>>>>>>>>>>>
49662>>>>>>>>>>>>>        // Fpa.Agora_Codegl
49662>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
49663>>>>>>>>>>>>>
49663>>>>>>>>>>>>>        // Fpa.Polhsh_Codegl
49663>>>>>>>>>>>>>
49663>>>>>>>>>>>>>        //DDB-DefineFieldEnd
49663>>>>>>>>>>>>>    End_Procedure    // Define_Fields
49664>>>>>>>>>>>>>
49664>>>>>>>>>>>>>    // Field_Defaults:
49664>>>>>>>>>>>>>    // This procedure is used to establish default field values.
49664>>>>>>>>>>>>>
49664>>>>>>>>>>>>>    Procedure Field_Defaults
49665>>>>>>>>>>>>>        Forward Send Field_Defaults
49667>>>>>>>>>>>>>        //DDB-Generated-Code-Location
49667>>>>>>>>>>>>>        //DDB-FieldDefaultStart
49667>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
49667>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
49668>>>>>>>>>>>>>
49668>>>>>>>>>>>>>End_Class    // Fpa_DataDictionary
49669>>>>>>>>>>>>>//DDB-Selection-pkg-Start
49669>>>>>>>>>>>>>
49669>>>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
49669>>>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
49669>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49669>>>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
49669>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>// Project Object Structure
49669>>>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
49669>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
49669>>>>>>>>>>>>>>>//     oSelList is a dbListSub
49669>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49669>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49669>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>// Register all objects
49669>>>>>>>>>>>>>>>Register_Object Fpa
49669>>>>>>>>>>>>>>>Register_Object Fpa_DD
49669>>>>>>>>>>>>>>>Register_Object oCancel_bn
49669>>>>>>>>>>>>>>>Register_Object oOK_bn
49669>>>>>>>>>>>>>>>Register_Object oSearch_bn
49669>>>>>>>>>>>>>>>Register_Object oSelList
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>//AB-IgnoreStart
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>Use DFAllEnt.pkg
49669>>>>>>>>>>>>>>>Use dbList.Sub
49669>>>>>>>>>>>>>>>Use Button.Sub
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>Use FPA.DD
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>//AB-IgnoreEnd
49669>>>>>>>>>>>>>>>
49669>>>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
49688>>>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
49689>>>>>>>>>>>>>>>    Set Size to 148 181
49690>>>>>>>>>>>>>>>    Set Location to 4 5
49691>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49692>>>>>>>>>>>>>>>    Set Modal_State to FALSE
49693>>>>>>>>>>>>>>>
49693>>>>>>>>>>>>>>>    //AB-DDOStart
49693>>>>>>>>>>>>>>>
49693>>>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
49695>>>>>>>>>>>>>>>    End_Object    // Fpa_DD
49696>>>>>>>>>>>>>>>
49696>>>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
49697>>>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
49698>>>>>>>>>>>>>>>
49698>>>>>>>>>>>>>>>    //AB-DDOEnd
49698>>>>>>>>>>>>>>>
49698>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
49700>>>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
49701>>>>>>>>>>>>>>>        Set Size to 105 165
49702>>>>>>>>>>>>>>>        Set Location to 6 6
49703>>>>>>>>>>>>>>>
49703>>>>>>>>>>>>>>>        Begin_Row
49706>>>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
49707>>>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
49708>>>>>>>>>>>>>>>        End_Row
49713>>>>>>>>>>>>>>>
49713>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
49714>>>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
49715>>>>>>>>>>>>>>>        
49715>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
49716>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49717>>>>>>>>>>>>>>>        
49717>>>>>>>>>>>>>>>    End_Object    // oSelList
49718>>>>>>>>>>>>>>>
49718>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49720>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49721>>>>>>>>>>>>>>>        Set Size to 14 46
49722>>>>>>>>>>>>>>>        Set Location to 113 26
49723>>>>>>>>>>>>>>>
49723>>>>>>>>>>>>>>>        //AB-StoreStart
49723>>>>>>>>>>>>>>>        Procedure OnClick
49725>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49726>>>>>>>>>>>>>>>        End_Procedure
49727>>>>>>>>>>>>>>>        //AB-StoreEnd
49727>>>>>>>>>>>>>>>
49727>>>>>>>>>>>>>>>    End_Object    // oOK_bn
49728>>>>>>>>>>>>>>>
49728>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49730>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49731>>>>>>>>>>>>>>>        Set Size to 14 46
49732>>>>>>>>>>>>>>>        Set Location to 113 75
49733>>>>>>>>>>>>>>>
49733>>>>>>>>>>>>>>>        //AB-StoreStart
49733>>>>>>>>>>>>>>>        Procedure OnClick
49735>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49736>>>>>>>>>>>>>>>        End_Procedure
49737>>>>>>>>>>>>>>>        //AB-StoreEnd
49737>>>>>>>>>>>>>>>
49737>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
49738>>>>>>>>>>>>>>>
49738>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49740>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49741>>>>>>>>>>>>>>>        Set Size to 14 46
49742>>>>>>>>>>>>>>>        Set Location to 113 126
49743>>>>>>>>>>>>>>>
49743>>>>>>>>>>>>>>>        //AB-StoreStart
49743>>>>>>>>>>>>>>>        Procedure OnClick
49745>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49746>>>>>>>>>>>>>>>        End_Procedure
49747>>>>>>>>>>>>>>>        //AB-StoreEnd
49747>>>>>>>>>>>>>>>
49747>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
49748>>>>>>>>>>>>>>>
49748>>>>>>>>>>>>>>>
49748>>>>>>>>>>>>>>>    //AB-StoreStart
49748>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49749>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49750>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49751>>>>>>>>>>>>>>>    //AB-StoreEnd
49751>>>>>>>>>>>>>>>
49751>>>>>>>>>>>>>>>CD_End_Object    // Fpa
49753>>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>//AB/ End_Object    // prj
49753>>>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
49753>>>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
49753>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
49753>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
49753>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>// Project Object Structure
49753>>>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
49753>>>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
49753>>>>>>>>>>>>>>>//     oSelList is a dbListSub
49753>>>>>>>>>>>>>>>//     oOK_bn is a Button
49753>>>>>>>>>>>>>>>//     oCancel_bn is a Button
49753>>>>>>>>>>>>>>>//     oSearch_bn is a Button
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>// Register all objects
49753>>>>>>>>>>>>>>>Register_Object Gplan_DD
49753>>>>>>>>>>>>>>>Register_Object oCancel_bn
49753>>>>>>>>>>>>>>>Register_Object oOK_bn
49753>>>>>>>>>>>>>>>Register_Object oSearch_bn
49753>>>>>>>>>>>>>>>Register_Object oSelList
49753>>>>>>>>>>>>>>>Register_Object sl150
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>    //AB-IgnoreStart
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
49753>>>>>>>>>>>>>>>    Use dbList.Sub
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
49753>>>>>>>>>>>>>>>>>//DDB-FileStart
49753>>>>>>>>>>>>>>>>>//DDB-HeaderStart
49753>>>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>>>// File Name : GPLAN.DD
49753>>>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
49753>>>>>>>>>>>>>>>>>// Revision  : 132
49753>>>>>>>>>>>>>>>>>// Version   : 2
49753>>>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49753>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49753>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49753>>>>>>>>>>>>>>>>>
49753>>>>>>>>>>>>>>>>>Open Gplan
49755>>>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
49757>>>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
49759>>>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
49761>>>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
49763>>>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
49765>>>>>>>>>>>>>>>>>Open Sysrecg
49767>>>>>>>>>>>>>>>>>Open Syscurgl
49769>>>>>>>>>>>>>>>>>
49769>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
49769>>>>>>>>>>>>>>>>>//DDB-ValidationStart
49769>>>>>>>>>>>>>>>>>
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
49769>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
49769>>>>>>>>>>>>>>>>>
49769>>>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
49771>>>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
49772>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49773>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49773>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49773>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
49774>>>>>>>>>>>>>>>>>
49774>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
49776>>>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
49777>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49777>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49777>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
49778>>>>>>>>>>>>>>>>>
49778>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
49780>>>>>>>>>>>>>>>>>
49780>>>>>>>>>>>>>>>>>    Procedure Fill_List
49782>>>>>>>>>>>>>>>>>        Forward Send Fill_List
49784>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
49785>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
49786>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
49787>>>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
49788>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49788>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49788>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
49789>>>>>>>>>>>>>>>>>
49789>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
49791>>>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
49792>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49793>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49793>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49793>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
49794>>>>>>>>>>>>>>>>>
49794>>>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
49796>>>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
49797>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49798>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49798>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49798>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
49799>>>>>>>>>>>>>>>>>
49799>>>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
49801>>>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
49802>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49803>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49803>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49803>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
49804>>>>>>>>>>>>>>>>>
49804>>>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
49806>>>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
49807>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49808>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49808>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49808>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
49809>>>>>>>>>>>>>>>>>
49809>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
49811>>>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
49812>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49812>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49812>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
49813>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
49813>>>>>>>>>>>>>>>>>//DDB-SelectionStart
49813>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
49813>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
49813>>>>>>>>>>>>>>>>>Register_Object sl150
49813>>>>>>>>>>>>>>>>>Register_Object Gtypkin
49813>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
49813>>>>>>>>>>>>>>>>>Use arrays.Sub
49813>>>>>>>>>>>>>>>>>
49813>>>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
49813>>>>>>>>>>>>>>>>>>>//DDB-FileStart
49813>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
49813>>>>>>>>>>>>>>>>>>>
49813>>>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
49813>>>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
49813>>>>>>>>>>>>>>>>>>>// Revision  : 17
49813>>>>>>>>>>>>>>>>>>>// Version   : 2
49813>>>>>>>>>>>>>>>>>>>
49813>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49813>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49813>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49813>>>>>>>>>>>>>>>>>>>
49813>>>>>>>>>>>>>>>>>>>Open Gmovea
49815>>>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
49817>>>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
49819>>>>>>>>>>>>>>>>>>>Open Gplan
49821>>>>>>>>>>>>>>>>>>>
49821>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
49821>>>>>>>>>>>>>>>>>>>
49821>>>>>>>>>>>>>>>>>>>//open master file
49821>>>>>>>>>>>>>>>>>>>Open Gmove
49823>>>>>>>>>>>>>>>>>>>
49823>>>>>>>>>>>>>>>>>>>//define alias-master condition
49823>>>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
49826>>>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
49829>>>>>>>>>>>>>>>>>>>
49829>>>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
49829>>>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
49830>>>>>>>>>>>>>>>>>>>>
49830>>>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
49831>>>>>>>>>>>>>>>>>>>>
49831>>>>>>>>>>>>>>>>>>>
49831>>>>>>>>>>>>>>>>>>>
49831>>>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
49832>>>>>>>>>>>>>>>>>>>
49832>>>>>>>>>>>>>>>>>>>
49832>>>>>>>>>>>>>>>>>>>      //private
49832>>>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
49832>>>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
49832>>>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
49833>>>>>>>>>>>>>>>>>>>                Case Begin
49833>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
49835>>>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
49836>>>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
49837>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
49838>>>>>>>>>>>>>>>>>>>                     Case Break
49839>>>>>>>>>>>>>>>>>>>
49839>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
49842>>>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
49843>>>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
49844>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
49845>>>>>>>>>>>>>>>>>>>                     Case Break
49846>>>>>>>>>>>>>>>>>>>
49846>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
49849>>>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
49850>>>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
49851>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
49852>>>>>>>>>>>>>>>>>>>                     Case Break
49853>>>>>>>>>>>>>>>>>>>
49853>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
49856>>>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
49857>>>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
49858>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
49859>>>>>>>>>>>>>>>>>>>                     Case Break
49860>>>>>>>>>>>>>>>>>>>                Case End
49860>>>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
49861>>>>>>>>>>>>>>>>>>>
49861>>>>>>>>>>>>>>>>>>>
49861>>>>>>>>>>>>>>>>>>>
49861>>>>>>>>>>>>>>>>>>>      //private
49861>>>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
49861>>>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
49861>>>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
49862>>>>>>>>>>>>>>>>>>>
49862>>>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
49862>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
49865>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
49868>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
49871>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
49874>>>>>>>>>>>>>>>>>>>
49874>>>>>>>>>>>>>>>>>>>                 Case Begin
49874>>>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
49874>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
49876>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
49879>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
49882>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
49885>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
49888>>>>>>>>>>>>>>>>>>>                      Case Break
49889>>>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
49889>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
49892>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
49895>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
49898>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
49901>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
49904>>>>>>>>>>>>>>>>>>>                      Case Break
49905>>>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
49905>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
49908>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
49911>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
49914>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
49917>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
49920>>>>>>>>>>>>>>>>>>>                      Case Break
49921>>>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
49921>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
49924>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
49927>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
49930>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
49933>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
49936>>>>>>>>>>>>>>>>>>>                      Case Break
49937>>>>>>>>>>>>>>>>>>>                 Case End
49937>>>>>>>>>>>>>>>>>>>
49937>>>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
49938>>>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
49939>>>>>>>>>>>>>>>>>>>
49939>>>>>>>>>>>>>>>>>>>    Procedure Update
49940>>>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
49941>>>>>>>>>>>>>>>>>>>    End_Procedure //update
49942>>>>>>>>>>>>>>>>>>>
49942>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49943>>>>>>>>>>>>>>>>>>>              String lsError_Message
49944>>>>>>>>>>>>>>>>>>>              Case Begin
49944>>>>>>>>>>>>>>>>>>>                   //˜§æ validate save
49944>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
49946>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
49947>>>>>>>>>>>>>>>>>>>                   Case Break
49948>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
49951>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
49952>>>>>>>>>>>>>>>>>>>                   Case Break
49953>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
49956>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
49957>>>>>>>>>>>>>>>>>>>                   Case Break
49958>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
49961>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
49962>>>>>>>>>>>>>>>>>>>                   Case Break
49963>>>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
49963>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
49966>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
49967>>>>>>>>>>>>>>>>>>>                   Case Break
49968>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
49971>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
49972>>>>>>>>>>>>>>>>>>>                   Case Break
49973>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
49976>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
49977>>>>>>>>>>>>>>>>>>>                   Case Break
49978>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
49981>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
49982>>>>>>>>>>>>>>>>>>>                   Case Break
49983>>>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
49983>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
49986>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
49987>>>>>>>>>>>>>>>>>>>                   Case Break
49988>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
49991>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
49992>>>>>>>>>>>>>>>>>>>                   Case Break
49993>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
49996>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
49997>>>>>>>>>>>>>>>>>>>                   Case Break
49998>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
50001>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
50002>>>>>>>>>>>>>>>>>>>                   Case Break
50003>>>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
50003>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
50006>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
50007>>>>>>>>>>>>>>>>>>>                   Case Break
50008>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
50011>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
50012>>>>>>>>>>>>>>>>>>>                   Case Break
50013>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
50016>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
50017>>>>>>>>>>>>>>>>>>>                   Case Break
50018>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
50021>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
50022>>>>>>>>>>>>>>>>>>>                   Case Break
50023>>>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
50023>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
50026>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
50027>>>>>>>>>>>>>>>>>>>                   Case Break
50028>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
50031>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
50032>>>>>>>>>>>>>>>>>>>                   Case Break
50033>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
50036>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
50037>>>>>>>>>>>>>>>>>>>                   Case Break
50038>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
50041>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
50042>>>>>>>>>>>>>>>>>>>                   Case Break
50043>>>>>>>>>>>>>>>>>>>
50043>>>>>>>>>>>>>>>>>>>
50043>>>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
50043>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
50046>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
50047>>>>>>>>>>>>>>>>>>>                   Case Break
50048>>>>>>>>>>>>>>>>>>>
50048>>>>>>>>>>>>>>>>>>>                   Case Else
50048>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
50050>>>>>>>>>>>>>>>>>>>              Case End
50050>>>>>>>>>>>>>>>>>>>
50050>>>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
50051>>>>>>>>>>>>>>>>>>>>
50051>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
50052>>>>>>>>>>>>>>>>>>>
50052>>>>>>>>>>>>>>>>>>>
50052>>>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
50053>>>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
50054>>>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
50056>>>>>>>>>>>>>>>>>>>
50056>>>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
50058>>>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
50058>>>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
50059>>>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
50062>>>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
50062>>>>>>>>>>>>>>>>>>>>
50062>>>>>>>>>>>>>>>>>>>
50062>>>>>>>>>>>>>>>>>>>
50062>>>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
50063>>>>>>>>>>>>>>>>>>>    End_Function //validate_save
50064>>>>>>>>>>>>>>>>>>>
50064>>>>>>>>>>>>>>>>>>>
50064>>>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
50064>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
50065>>>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
50066>>>>>>>>>>>>>>>>>>>    End_Function //validate_delete
50067>>>>>>>>>>>>>>>>>>>
50067>>>>>>>>>>>>>>>>>>>
50067>>>>>>>>>>>>>>>>>>>    // Define_Fields:
50067>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50067>>>>>>>>>>>>>>>>>>>
50067>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50068>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50070>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50070>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50070>>>>>>>>>>>>>>>>>>>
50070>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
50071>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50072>>>>>>>>>>>>>>>>>>>
50072>>>>>>>>>>>>>>>>>>>
50072>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50072>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
50073>>>>>>>>>>>>>>>>>>>
50073>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
50073>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
50074>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
50075>>>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50075>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50076>>>>>>>>>>>>>>>>>>>
50076>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
50076>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50076>>>>>>>>>>>>>>>>>>>
50076>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50077>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50079>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50079>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50079>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50079>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50080>>>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
50081>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
50081>>>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
50081>>>>>>>>>>>>>>>>>
50081>>>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
50082>>>>>>>>>>>>>>>>>
50082>>>>>>>>>>>>>>>>>    Procedure Construct_Object
50083>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
50085>>>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
50087>>>>>>>>>>>>>>>>>        End_Object
50088>>>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
50089>>>>>>>>>>>>>>>>>        Property String     psValidChars ""
50090>>>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
50091>>>>>>>>>>>>>>>>>        Property String     psBranch 
50092>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
50093>>>>>>>>>>>>>>>>>
50093>>>>>>>>>>>>>>>>>    Procedure OnConstrain
50094>>>>>>>>>>>>>>>>>        Forward Send OnConstrain
50096>>>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
50098>>>>>>>>>>>>>>>>>        End
50098>>>>>>>>>>>>>>>>>>
50098>>>>>>>>>>>>>>>>>        Else Begin
50099>>>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
50101>>>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
50103>>>>>>>>>>>>>>>>>        End
50103>>>>>>>>>>>>>>>>>>
50103>>>>>>>>>>>>>>>>>    End_Procedure
50104>>>>>>>>>>>>>>>>>
50104>>>>>>>>>>>>>>>>>    Procedure Update
50105>>>>>>>>>>>>>>>>>        Forward Send Update
50107>>>>>>>>>>>>>>>>>        // Insert Code Here
50107>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
50108>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
50109>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
50110>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
50111>>>>>>>>>>>>>>>>>    End_Procedure   // Update
50112>>>>>>>>>>>>>>>>>
50112>>>>>>>>>>>>>>>>>    Procedure Creating
50113>>>>>>>>>>>>>>>>>        Forward Send Creating
50115>>>>>>>>>>>>>>>>>        // Insert Code Here
50115>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
50116>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
50117>>>>>>>>>>>>>>>>>
50117>>>>>>>>>>>>>>>>>
50117>>>>>>>>>>>>>>>>>//////////////////////////////////////
50117>>>>>>>>>>>>>>>>>//////////////////////////////////////
50117>>>>>>>>>>>>>>>>>
50117>>>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
50118>>>>>>>>>>>>>>>>>        String lsChar
50119>>>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
50119>>>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
50121>>>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
50122>>>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
50123>>>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
50129>>>>>>>>>>>>>>>>>>
50129>>>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
50130>>>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
50132>>>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
50133>>>>>>>>>>>>>>>>>                    Function_Return 1001
50134>>>>>>>>>>>>>>>>>               End
50134>>>>>>>>>>>>>>>>>>
50134>>>>>>>>>>>>>>>>>            Loop
50135>>>>>>>>>>>>>>>>>>
50135>>>>>>>>>>>>>>>>>        End
50135>>>>>>>>>>>>>>>>>>
50135>>>>>>>>>>>>>>>>>        Function_Return rVal
50136>>>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
50137>>>>>>>>>>>>>>>>>
50137>>>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
50137>>>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
50138>>>>>>>>>>>>>>>>>        // Insert Code Here
50138>>>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
50139>>>>>>>>>>>>>>>>>        Local Integer liFile##
50139>>>>>>>>>>>>>>>>>        Local Integer liField_Count##
50139>>>>>>>>>>>>>>>>>        Local Integer liField_Type##
50139>>>>>>>>>>>>>>>>>        Local Integer liField##
50139>>>>>>>>>>>>>>>>>
50139>>>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
50140>>>>>>>>>>>>>>>>>        Get Main_File to liFile##
50141>>>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
50144>>>>>>>>>>>>>>>>>
50144>>>>>>>>>>>>>>>>>
50144>>>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
50150>>>>>>>>>>>>>>>>>>
50150>>>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
50150>>>>>>>>>>>>>>>>>            move liField## to Fieldindex
50151>>>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
50152>>>>>>>>>>>>>>>>>        Loop
50153>>>>>>>>>>>>>>>>>>
50153>>>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
50154>>>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
50155>>>>>>>>>>>>>>>>>
50155>>>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
50155>>>>>>>>>>>>>>>>>
50155>>>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
50156>>>>>>>>>>>>>>>>>        // Insert Code Here
50156>>>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
50157>>>>>>>>>>>>>>>>>        Local Integer liFile##
50157>>>>>>>>>>>>>>>>>        Local Integer liField_Count##
50157>>>>>>>>>>>>>>>>>        Local Integer liField_Type##
50157>>>>>>>>>>>>>>>>>        Local Integer liField##
50157>>>>>>>>>>>>>>>>>
50157>>>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
50158>>>>>>>>>>>>>>>>>        Get Main_File to liFile##
50159>>>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
50162>>>>>>>>>>>>>>>>>
50162>>>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
50163>>>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
50164>>>>>>>>>>>>>>>>>
50164>>>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
50170>>>>>>>>>>>>>>>>>>
50170>>>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
50170>>>>>>>>>>>>>>>>>            move liField## to Fieldindex
50171>>>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
50172>>>>>>>>>>>>>>>>>        Loop
50173>>>>>>>>>>>>>>>>>>
50173>>>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
50174>>>>>>>>>>>>>>>>>
50174>>>>>>>>>>>>>>>>>    // Request_Save:
50174>>>>>>>>>>>>>>>>>
50174>>>>>>>>>>>>>>>>>
50174>>>>>>>>>>>>>>>>>
50174>>>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
50174>>>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
50175>>>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
50176>>>>>>>>>>>>>>>>>             REPEAT
50176>>>>>>>>>>>>>>>>>>
50176>>>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
50178>>>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
50179>>>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
50181>>>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
50182>>>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
50183>>>>>>>>>>>>>>>>>
50183>>>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
50184>>>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
50185>>>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
50185>>>>>>>>>>>>>>>>>
50185>>>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
50191>>>>>>>>>>>>>>>>>>
50191>>>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
50193>>>>>>>>>>>>>>>>>        LOOP
50194>>>>>>>>>>>>>>>>>>
50194>>>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
50195>>>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
50201>>>>>>>>>>>>>>>>>>
50201>>>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
50203>>>>>>>>>>>>>>>>>        LOOP
50204>>>>>>>>>>>>>>>>>>
50204>>>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
50205>>>>>>>>>>>>>>>>>    END_FUNCTION
50206>>>>>>>>>>>>>>>>>
50206>>>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
50207>>>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
50208>>>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
50208>>>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
50209>>>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
50210>>>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
50216>>>>>>>>>>>>>>>>>>
50216>>>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
50219>>>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
50223>>>>>>>>>>>>>>>>>             LOOP
50224>>>>>>>>>>>>>>>>>>
50224>>>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
50227>>>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
50233>>>>>>>>>>>>>>>>>>
50233>>>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
50236>>>>>>>>>>>>>>>>>             LOOP
50237>>>>>>>>>>>>>>>>>>
50237>>>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
50238>>>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
50239>>>>>>>>>>>>>>>>>
50239>>>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
50240>>>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
50241>>>>>>>>>>>>>>>>>        Number liGplanRecnum
50241>>>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
50241>>>>>>>>>>>>>>>>>
50241>>>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
50243>>>>>>>>>>>>>>>>>
50243>>>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
50244>>>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
50245>>>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
50246>>>>>>>>>>>>>>>>>
50246>>>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
50247>>>>>>>>>>>>>>>>>
50247>>>>>>>>>>>>>>>>>            clear Gplan
50248>>>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
50249>>>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
50250>>>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
50251>>>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
50252>>>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
50253>>>>>>>>>>>>>>>>>>
50253>>>>>>>>>>>>>>>>>            If (Found = 0) begin
50255>>>>>>>>>>>>>>>>>                clear gplan
50256>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50257>>>>>>>>>>>>>>>>>                find eq gplan.recnum
50258>>>>>>>>>>>>>>>>>>
50258>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
50259>>>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
50260>>>>>>>>>>>>>>>>>            end
50260>>>>>>>>>>>>>>>>>>
50260>>>>>>>>>>>>>>>>>            else begin
50261>>>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
50261>>>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
50263>>>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
50264>>>>>>>>>>>>>>>>>                   Function_return 7003
50265>>>>>>>>>>>>>>>>>               end
50265>>>>>>>>>>>>>>>>>>
50265>>>>>>>>>>>>>>>>>               clear gplan
50266>>>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
50267>>>>>>>>>>>>>>>>>               find eq gplan.recnum
50268>>>>>>>>>>>>>>>>>>
50268>>>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
50269>>>>>>>>>>>>>>>>>               function_Return 0 //ok
50270>>>>>>>>>>>>>>>>>            end
50270>>>>>>>>>>>>>>>>>>
50270>>>>>>>>>>>>>>>>>        end
50270>>>>>>>>>>>>>>>>>>
50270>>>>>>>>>>>>>>>>>        Function_Return 0
50271>>>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
50272>>>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
50272>>>>>>>>>>>>>>>>>
50272>>>>>>>>>>>>>>>>>
50272>>>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
50272>>>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
50273>>>>>>>>>>>>>>>>>        String lsNext_Anoep
50274>>>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
50274>>>>>>>>>>>>>>>>>        Number liGplanRecnum
50274>>>>>>>>>>>>>>>>>
50274>>>>>>>>>>>>>>>>>
50274>>>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
50274>>>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
50275>>>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
50276>>>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
50277>>>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
50278>>>>>>>>>>>>>>>>>
50278>>>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
50280>>>>>>>>>>>>>>>>>            find gt gplan by index.1
50281>>>>>>>>>>>>>>>>>>
50281>>>>>>>>>>>>>>>>>            if (found = 0) begin
50283>>>>>>>>>>>>>>>>>                clear gplan
50284>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50285>>>>>>>>>>>>>>>>>                find eq gplan.recnum
50286>>>>>>>>>>>>>>>>>>
50286>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
50287>>>>>>>>>>>>>>>>>            end
50287>>>>>>>>>>>>>>>>>>
50287>>>>>>>>>>>>>>>>>            else begin
50288>>>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
50288>>>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
50290>>>>>>>>>>>>>>>>>                    clear gplan
50291>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
50292>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
50293>>>>>>>>>>>>>>>>>>
50293>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
50294>>>>>>>>>>>>>>>>>                    Function_return 7004
50295>>>>>>>>>>>>>>>>>                end
50295>>>>>>>>>>>>>>>>>>
50295>>>>>>>>>>>>>>>>>                else begin
50296>>>>>>>>>>>>>>>>>                    clear gplan
50297>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
50298>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
50299>>>>>>>>>>>>>>>>>>
50299>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
50300>>>>>>>>>>>>>>>>>                end
50300>>>>>>>>>>>>>>>>>>
50300>>>>>>>>>>>>>>>>>            end
50300>>>>>>>>>>>>>>>>>>
50300>>>>>>>>>>>>>>>>>        end
50300>>>>>>>>>>>>>>>>>>
50300>>>>>>>>>>>>>>>>>
50300>>>>>>>>>>>>>>>>>        if (liMode = 1) begin
50302>>>>>>>>>>>>>>>>>            find gt gplan by index.1
50303>>>>>>>>>>>>>>>>>>
50303>>>>>>>>>>>>>>>>>            if (Found = 0) begin
50305>>>>>>>>>>>>>>>>>                clear gplan
50306>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50307>>>>>>>>>>>>>>>>>                find eq gplan.recnum
50308>>>>>>>>>>>>>>>>>>
50308>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
50309>>>>>>>>>>>>>>>>>            end
50309>>>>>>>>>>>>>>>>>>
50309>>>>>>>>>>>>>>>>>            else begin
50310>>>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
50312>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
50313>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
50314>>>>>>>>>>>>>>>>>>
50314>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
50315>>>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
50316>>>>>>>>>>>>>>>>>                end
50316>>>>>>>>>>>>>>>>>>
50316>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50317>>>>>>>>>>>>>>>>>                find eq gplan.recnum
50318>>>>>>>>>>>>>>>>>>
50318>>>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
50318>>>>>>>>>>>>>>>>>            end
50318>>>>>>>>>>>>>>>>>>
50318>>>>>>>>>>>>>>>>>        end
50318>>>>>>>>>>>>>>>>>>
50318>>>>>>>>>>>>>>>>>        Function_return 0
50319>>>>>>>>>>>>>>>>>    End_Function // fiForward_Check
50320>>>>>>>>>>>>>>>>>
50320>>>>>>>>>>>>>>>>>
50320>>>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
50321>>>>>>>>>>>>>>>>>
50321>>>>>>>>>>>>>>>>>        // Insert Code Here
50321>>>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
50322>>>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
50322>>>>>>>>>>>>>>>>>
50322>>>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
50323>>>>>>>>>>>>>>>>>>
50323>>>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
50324>>>>>>>>>>>>>>>>>    Search_Again:
50324>>>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
50325>>>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
50326>>>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
50327>>>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
50328>>>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
50329>>>>>>>>>>>>>>>>>        Find eq Gformat by index.1
50330>>>>>>>>>>>>>>>>>>
50330>>>>>>>>>>>>>>>>>
50330>>>>>>>>>>>>>>>>>        if (Found = 1) begin
50332>>>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50333>>>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
50334>>>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
50336>>>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50337>>>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
50339>>>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
50341>>>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
50342>>>>>>>>>>>>>>>>>                    end
50342>>>>>>>>>>>>>>>>>>
50342>>>>>>>>>>>>>>>>>                end
50342>>>>>>>>>>>>>>>>>>
50342>>>>>>>>>>>>>>>>>                if (libathmos > 1) begin
50344>>>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
50345>>>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
50347>>>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
50349>>>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
50350>>>>>>>>>>>>>>>>>                        End
50350>>>>>>>>>>>>>>>>>>
50350>>>>>>>>>>>>>>>>>                    End
50350>>>>>>>>>>>>>>>>>>
50350>>>>>>>>>>>>>>>>>                end
50350>>>>>>>>>>>>>>>>>>
50350>>>>>>>>>>>>>>>>>            function_return 0
50351>>>>>>>>>>>>>>>>>            end
50351>>>>>>>>>>>>>>>>>>
50351>>>>>>>>>>>>>>>>>            else begin
50352>>>>>>>>>>>>>>>>>                function_return 127
50353>>>>>>>>>>>>>>>>>            end
50353>>>>>>>>>>>>>>>>>>
50353>>>>>>>>>>>>>>>>>        end
50353>>>>>>>>>>>>>>>>>>
50353>>>>>>>>>>>>>>>>>        else begin
50354>>>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
50355>>>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
50357>>>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
50358>>>>>>>>>>>>>>>>>                Goto Search_Again
50359>>>>>>>>>>>>>>>>>>
50359>>>>>>>>>>>>>>>>>            end
50359>>>>>>>>>>>>>>>>>>
50359>>>>>>>>>>>>>>>>>            else begin
50360>>>>>>>>>>>>>>>>>                clear Gformat
50361>>>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
50362>>>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
50363>>>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
50364>>>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
50365>>>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
50366>>>>>>>>>>>>>>>>>>
50366>>>>>>>>>>>>>>>>>//* to be a function
50366>>>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50367>>>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
50368>>>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
50370>>>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50371>>>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
50373>>>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
50375>>>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
50376>>>>>>>>>>>>>>>>>                        end
50376>>>>>>>>>>>>>>>>>>
50376>>>>>>>>>>>>>>>>>                    end
50376>>>>>>>>>>>>>>>>>>
50376>>>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
50378>>>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
50379>>>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
50381>>>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
50383>>>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
50384>>>>>>>>>>>>>>>>>                            end
50384>>>>>>>>>>>>>>>>>>
50384>>>>>>>>>>>>>>>>>                        end
50384>>>>>>>>>>>>>>>>>>
50384>>>>>>>>>>>>>>>>>                    end
50384>>>>>>>>>>>>>>>>>>
50384>>>>>>>>>>>>>>>>>                function_return 0
50385>>>>>>>>>>>>>>>>>                end
50385>>>>>>>>>>>>>>>>>>
50385>>>>>>>>>>>>>>>>>                else begin
50386>>>>>>>>>>>>>>>>>                    function_return 127
50387>>>>>>>>>>>>>>>>>                end
50387>>>>>>>>>>>>>>>>>>
50387>>>>>>>>>>>>>>>>>
50387>>>>>>>>>>>>>>>>>                //* emd to be a function
50387>>>>>>>>>>>>>>>>>                function_return 0
50388>>>>>>>>>>>>>>>>>            end
50388>>>>>>>>>>>>>>>>>>
50388>>>>>>>>>>>>>>>>>        end
50388>>>>>>>>>>>>>>>>>>
50388>>>>>>>>>>>>>>>>>        Function_return 0    //ok
50389>>>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
50390>>>>>>>>>>>>>>>>>
50390>>>>>>>>>>>>>>>>>
50390>>>>>>>>>>>>>>>>>
50390>>>>>>>>>>>>>>>>>    // fiValidateGplanFields:
50390>>>>>>>>>>>>>>>>>
50390>>>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
50391>>>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
50392>>>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
50392>>>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
50392>>>>>>>>>>>>>>>>>
50392>>>>>>>>>>>>>>>>>        Get Main_File to iMainFile
50393>>>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
50396>>>>>>>>>>>>>>>>>
50396>>>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
50398>>>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
50399>>>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
50401>>>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
50402>>>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
50403>>>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
50404>>>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
50406>>>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
50407>>>>>>>>>>>>>>>>>>
50407>>>>>>>>>>>>>>>>>                               Function_Return liReturnVal
50408>>>>>>>>>>>>>>>>>                            end
50408>>>>>>>>>>>>>>>>>>
50408>>>>>>>>>>>>>>>>>
50408>>>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
50409>>>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
50411>>>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
50412>>>>>>>>>>>>>>>>>>
50412>>>>>>>>>>>>>>>>>                                        function_return 127
50413>>>>>>>>>>>>>>>>>                                      end
50413>>>>>>>>>>>>>>>>>>
50413>>>>>>>>>>>>>>>>>
50413>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
50414>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
50415>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
50416>>>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
50417>>>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
50419>>>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
50420>>>>>>>>>>>>>>>>>>
50420>>>>>>>>>>>>>>>>>                                               Function_Return 8001
50421>>>>>>>>>>>>>>>>>                                            end
50421>>>>>>>>>>>>>>>>>>
50421>>>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
50423>>>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
50424>>>>>>>>>>>>>>>>>>
50424>>>>>>>>>>>>>>>>>                                               Function_Return 8002
50425>>>>>>>>>>>>>>>>>                                          end
50425>>>>>>>>>>>>>>>>>>
50425>>>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
50427>>>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
50428>>>>>>>>>>>>>>>>>>
50428>>>>>>>>>>>>>>>>>                                               Function_Return 8003
50429>>>>>>>>>>>>>>>>>                                          end
50429>>>>>>>>>>>>>>>>>>
50429>>>>>>>>>>>>>>>>>
50429>>>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
50430>>>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
50432>>>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
50433>>>>>>>>>>>>>>>>>>
50433>>>>>>>>>>>>>>>>>                                               Function_Return 8004
50434>>>>>>>>>>>>>>>>>                                            end
50434>>>>>>>>>>>>>>>>>>
50434>>>>>>>>>>>>>>>>>
50434>>>>>>>>>>>>>>>>>            end
50434>>>>>>>>>>>>>>>>>>
50434>>>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
50436>>>>>>>>>>>>>>>>>         end
50436>>>>>>>>>>>>>>>>>>
50436>>>>>>>>>>>>>>>>>         function_return 0
50437>>>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
50438>>>>>>>>>>>>>>>>>
50438>>>>>>>>>>>>>>>>>
50438>>>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
50438>>>>>>>>>>>>>>>>>
50438>>>>>>>>>>>>>>>>>
50438>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
50439>>>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
50439>>>>>>>>>>>>>>>>>        // Insert Code Here
50439>>>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
50442>>>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
50446>>>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
50450>>>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
50454>>>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50458>>>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50462>>>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
50466>>>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
50470>>>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
50474>>>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
50478>>>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
50482>>>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
50486>>>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
50489>>>>>>>>>>>>>>>>>    End_Procedure
50490>>>>>>>>>>>>>>>>>
50490>>>>>>>>>>>>>>>>>
50490>>>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
50491>>>>>>>>>>>>>>>>>        Clear Gplan
50492>>>>>>>>>>>>>>>>>    End_Procedure
50493>>>>>>>>>>>>>>>>>
50493>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
50494>>>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
50495>>>>>>>>>>>>>>>>>        locaL string lsVal##
50495>>>>>>>>>>>>>>>>>
50495>>>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
50497>>>>>>>>>>>>>>>>>
50497>>>>>>>>>>>>>>>>>
50497>>>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
50499>>>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
50499>>>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
50499>>>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
50502>>>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
50505>>>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
50508>>>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
50514>>>>>>>>>>>>>>>>>>
50514>>>>>>>>>>>>>>>>>
50514>>>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
50515>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
50518>>>>>>>>>>>>>>>>>
50518>>>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
50519>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
50522>>>>>>>>>>>>>>>>>
50522>>>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
50523>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
50526>>>>>>>>>>>>>>>>>
50526>>>>>>>>>>>>>>>>>            Loop
50527>>>>>>>>>>>>>>>>>>
50527>>>>>>>>>>>>>>>>>              //1100:cby = globals
50527>>>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
50530>>>>>>>>>>>>>>>>>        End
50530>>>>>>>>>>>>>>>>>>
50530>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
50531>>>>>>>>>>>>>>>>>    End_Function
50532>>>>>>>>>>>>>>>>>
50532>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
50533>>>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
50534>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
50536>>>>>>>>>>>>>>>>>
50536>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
50538>>>>>>>>>>>>>>>>>            // Insert Code Here
50538>>>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
50539>>>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
50542>>>>>>>>>>>>>>>>>              //2100:cby = globals
50542>>>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
50545>>>>>>>>>>>>>>>>>        End
50545>>>>>>>>>>>>>>>>>>
50545>>>>>>>>>>>>>>>>>
50545>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
50546>>>>>>>>>>>>>>>>>    End_Function
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>//    Procedure Update
50547>>>>>>>>>>>>>>>>>//        Forward Send Update
50547>>>>>>>>>>>>>>>>>//        // Insert Code Here
50547>>>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
50547>>>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
50547>>>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
50547>>>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
50547>>>>>>>>>>>>>>>>>//    End_Procedure   // Update
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>//    Procedure Backout
50547>>>>>>>>>>>>>>>>>//        Forward Send Backout
50547>>>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
50547>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>    // Define_Fields:
50547>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50547>>>>>>>>>>>>>>>>>
50547>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50548>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50550>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50550>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50550>>>>>>>>>>>>>>>>>
50550>>>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
50551>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50552>>>>>>>>>>>>>>>>>
50552>>>>>>>>>>>>>>>>>
50552>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50552>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
50553>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
50554>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
50555>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
50556>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
50557>>>>>>>>>>>>>>>>>
50557>>>>>>>>>>>>>>>>>        // External (System) file structure.............
50557>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
50558>>>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
50559>>>>>>>>>>>>>>>>>
50559>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
50562>>>>>>>>>>>>>>>>>
50562>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50562>>>>>>>>>>>>>>>>>
50562>>>>>>>>>>>>>>>>>        // Gplan.Company_Code
50562>>>>>>>>>>>>>>>>>
50562>>>>>>>>>>>>>>>>>        // Gplan.Branch_Code
50562>>>>>>>>>>>>>>>>>
50562>>>>>>>>>>>>>>>>>        // Gplan.Year_Year
50562>>>>>>>>>>>>>>>>>
50562>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
50562>>>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
50563>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
50564>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
50565>>>>>>>>>>>>>>>>>
50565>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
50565>>>>>>>>>>>>>>>>>
50565>>>>>>>>>>>>>>>>>        // Gplan.Year_Recr
50565>>>>>>>>>>>>>>>>>
50565>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
50565>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
50566>>>>>>>>>>>>>>>>>
50566>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
50566>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
50567>>>>>>>>>>>>>>>>>
50567>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
50567>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
50567>>>>>>>>>>>>>>>>>
50567>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
50567>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
50567>>>>>>>>>>>>>>>>>
50567>>>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
50567>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
50568>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
50569>>>>>>>>>>>>>>>>>
50569>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
50569>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
50570>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
50571>>>>>>>>>>>>>>>>>
50571>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
50571>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
50571>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
50572>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
50573>>>>>>>>>>>>>>>>>
50573>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
50573>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
50573>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
50574>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
50575>>>>>>>>>>>>>>>>>
50575>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
50575>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
50576>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
50577>>>>>>>>>>>>>>>>>
50577>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
50577>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
50577>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
50578>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
50579>>>>>>>>>>>>>>>>>
50579>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
50579>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
50579>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
50580>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
50581>>>>>>>>>>>>>>>>>
50581>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
50581>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
50581>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
50582>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
50583>>>>>>>>>>>>>>>>>
50583>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
50583>>>>>>>>>>>>>>>>>
50583>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
50583>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
50584>>>>>>>>>>>>>>>>>
50584>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
50584>>>>>>>>>>>>>>>>>
50584>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
50584>>>>>>>>>>>>>>>>>
50584>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
50584>>>>>>>>>>>>>>>>>
50584>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
50584>>>>>>>>>>>>>>>>>
50584>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
50584>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
50585>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
50586>>>>>>>>>>>>>>>>>
50586>>>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
50586>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
50587>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
50588>>>>>>>>>>>>>>>>>
50588>>>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
50588>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
50588>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
50589>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
50590>>>>>>>>>>>>>>>>>
50590>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
50590>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
50591>>>>>>>>>>>>>>>>>
50591>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
50591>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
50592>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
50593>>>>>>>>>>>>>>>>>
50593>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
50593>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
50594>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
50595>>>>>>>>>>>>>>>>>
50595>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
50595>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
50596>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
50597>>>>>>>>>>>>>>>>>
50597>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
50597>>>>>>>>>>>>>>>>>
50597>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
50597>>>>>>>>>>>>>>>>>
50597>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
50597>>>>>>>>>>>>>>>>>
50597>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
50597>>>>>>>>>>>>>>>>>
50597>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
50597>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
50597>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
50598>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
50599>>>>>>>>>>>>>>>>>
50599>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
50599>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
50600>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
50601>>>>>>>>>>>>>>>>>
50601>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
50601>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
50602>>>>>>>>>>>>>>>>>
50602>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50602>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50603>>>>>>>>>>>>>>>>>
50603>>>>>>>>>>>>>>>>>    // Field_Defaults:
50603>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50603>>>>>>>>>>>>>>>>>
50603>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50604>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50606>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50606>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50606>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
50607>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
50608>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
50609>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
50610>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
50611>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
50612>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
50613>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
50614>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
50615>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
50616>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
50617>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50617>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50618>>>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50619>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>Use sl150.sl         // sl150
50619>>>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
50619>>>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
50619>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
50619>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
50619>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>// Project Object Structure
50619>>>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
50619>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
50619>>>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
50619>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
50619>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
50619>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
50619>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>// Register all objects
50619>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
50619>>>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
50619>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
50619>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
50619>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
50619>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
50619>>>>>>>>>>>>>>>>>>>Register_Object oSelList
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
50619>>>>>>>>>>>>>>>>>>>>>//DDB-FileStart
50619>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
50619>>>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
50619>>>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
50619>>>>>>>>>>>>>>>>>>>>>// Revision  : 33
50619>>>>>>>>>>>>>>>>>>>>>// Version   : 2
50619>>>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
50619>>>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50619>>>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50619>>>>>>>>>>>>>>>>>>>>>
50619>>>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
50621>>>>>>>>>>>>>>>>>>>>>Open Gtypkin
50623>>>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
50625>>>>>>>>>>>>>>>>>>>>>Open Sysrecg
50627>>>>>>>>>>>>>>>>>>>>>
50627>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
50627>>>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
50627>>>>>>>>>>>>>>>>>>>>>
50627>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
50627>>>>>>>>>>>>>>>>>>>>>
50627>>>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
50629>>>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
50630>>>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
50630>>>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
50630>>>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
50631>>>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
50631>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
50631>>>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
50631>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
50631>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
50631>>>>>>>>>>>>>>>>>>>>>
50631>>>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
50632>>>>>>>>>>>>>>>>>>>>>
50632>>>>>>>>>>>>>>>>>>>>>
50632>>>>>>>>>>>>>>>>>>>>>    // Define_Fields:
50632>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50632>>>>>>>>>>>>>>>>>>>>>
50632>>>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50633>>>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50635>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50635>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50635>>>>>>>>>>>>>>>>>>>>>
50635>>>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
50636>>>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50637>>>>>>>>>>>>>>>>>>>>>
50637>>>>>>>>>>>>>>>>>>>>>
50637>>>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50637>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
50638>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
50639>>>>>>>>>>>>>>>>>>>>>
50639>>>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
50639>>>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
50640>>>>>>>>>>>>>>>>>>>>>
50640>>>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
50643>>>>>>>>>>>>>>>>>>>>>
50643>>>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50643>>>>>>>>>>>>>>>>>>>>>
50643>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
50643>>>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
50644>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
50645>>>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
50646>>>>>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
50646>>>>>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
50646>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
50647>>>>>>>>>>>>>>>>>>>>>
50647>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
50647>>>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
50648>>>>>>>>>>>>>>>>>>>>>
50648>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
50648>>>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
50649>>>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
50650>>>>>>>>>>>>>>>>>>>>>
50650>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50650>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50651>>>>>>>>>>>>>>>>>>>>>
50651>>>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
50651>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50651>>>>>>>>>>>>>>>>>>>>>
50651>>>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50652>>>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50654>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50654>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50654>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50654>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50655>>>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
50656>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50656>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
50656>>>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
50656>>>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
50656>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
50656>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
50656>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
50656>>>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
50656>>>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
50656>>>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
50656>>>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
50656>>>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
50656>>>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>// Register all objects
50656>>>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
50656>>>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
50656>>>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
50656>>>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
50656>>>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
50656>>>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
50656>>>>>>>>>>>>>>>>>>>>>>>
50656>>>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
50675>>>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50676>>>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
50677>>>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
50678>>>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
50679>>>>>>>>>>>>>>>>>>>>>>>
50679>>>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
50679>>>>>>>>>>>>>>>>>>>>>>>
50679>>>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
50681>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
50682>>>>>>>>>>>>>>>>>>>>>>>
50682>>>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
50683>>>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
50684>>>>>>>>>>>>>>>>>>>>>>>
50684>>>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
50684>>>>>>>>>>>>>>>>>>>>>>>
50684>>>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
50686>>>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
50687>>>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
50688>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
50689>>>>>>>>>>>>>>>>>>>>>>>
50689>>>>>>>>>>>>>>>>>>>>>>>            Begin_Row
50692>>>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
50693>>>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
50694>>>>>>>>>>>>>>>>>>>>>>>            End_Row
50699>>>>>>>>>>>>>>>>>>>>>>>
50699>>>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
50700>>>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
50701>>>>>>>>>>>>>>>>>>>>>>>
50701>>>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
50702>>>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50703>>>>>>>>>>>>>>>>>>>>>>>
50703>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
50704>>>>>>>>>>>>>>>>>>>>>>>
50704>>>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
50706>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50707>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
50708>>>>>>>>>>>>>>>>>>>>>>>
50708>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50708>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50710>>>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
50711>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
50712>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50712>>>>>>>>>>>>>>>>>>>>>>>
50712>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
50713>>>>>>>>>>>>>>>>>>>>>>>
50713>>>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
50715>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50716>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
50717>>>>>>>>>>>>>>>>>>>>>>>
50717>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50717>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50719>>>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
50720>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
50721>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50721>>>>>>>>>>>>>>>>>>>>>>>
50721>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
50722>>>>>>>>>>>>>>>>>>>>>>>
50722>>>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
50724>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
50725>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
50726>>>>>>>>>>>>>>>>>>>>>>>
50726>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50726>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50728>>>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
50729>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
50730>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50730>>>>>>>>>>>>>>>>>>>>>>>
50730>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
50731>>>>>>>>>>>>>>>>>>>>>>>
50731>>>>>>>>>>>>>>>>>>>>>>>
50731>>>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
50731>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50732>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50733>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50734>>>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
50734>>>>>>>>>>>>>>>>>>>>>>>
50734>>>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
50736>>>>>>>>>>>>>>>>>>>>>>>>
50736>>>>>>>>>>>>>>>>>>>>>>>
50736>>>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
50736>>>>>>>>>>>>>>>>>>>>>
50736>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50736>>>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
50736>>>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
50736>>>>>>>>>>>>>>>>>>>>>//DDB-FileStart
50736>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
50736>>>>>>>>>>>>>>>>>>>>>
50736>>>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
50736>>>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
50736>>>>>>>>>>>>>>>>>>>>>// Revision  : 45
50736>>>>>>>>>>>>>>>>>>>>>// Version   : 2
50736>>>>>>>>>>>>>>>>>>>>>
50736>>>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
50736>>>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50736>>>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50736>>>>>>>>>>>>>>>>>>>>>
50736>>>>>>>>>>>>>>>>>>>>>Open Gtypkin
50738>>>>>>>>>>>>>>>>>>>>>Open Garticl
50740>>>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
50742>>>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
50744>>>>>>>>>>>>>>>>>>>>>Open Gthhmgio
50746>>>>>>>>>>>>>>>>>>>>>Open Sysrecg
50748>>>>>>>>>>>>>>>>>>>>>
50748>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
50748>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
50748>>>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
50748>>>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
50748>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
50748>>>>>>>>>>>>>>>>>>>>>Open SysCurGL
50750>>>>>>>>>>>>>>>>>>>>>
50750>>>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
50751>>>>>>>>>>>>>>>>>>>>>
50751>>>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
50752>>>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
50752>>>>>>>>>>>>>>>>>>>>>         Integer Changed
50753>>>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
50754>>>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
50756>>>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
50757>>>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
50758>>>>>>>>>>>>>>>>>>>>>         End
50758>>>>>>>>>>>>>>>>>>>>>>
50758>>>>>>>>>>>>>>>>>>>>>    End_Procedure
50759>>>>>>>>>>>>>>>>>>>>>
50759>>>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
50760>>>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
50762>>>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
50763>>>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
50764>>>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
50765>>>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
50766>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
50767>>>>>>>>>>>>>>>>>>>>>
50767>>>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
50767>>>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
50767>>>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
50767>>>>>>>>>>>>>>>>>>>>>//        End
50767>>>>>>>>>>>>>>>>>>>>>//        Else Begin
50767>>>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
50767>>>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
50767>>>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
50767>>>>>>>>>>>>>>>>>>>>>//        End
50767>>>>>>>>>>>>>>>>>>>>>//    End_Procedure
50767>>>>>>>>>>>>>>>>>>>>>
50767>>>>>>>>>>>>>>>>>>>>>    Procedure Update
50768>>>>>>>>>>>>>>>>>>>>>        Forward Send Update
50770>>>>>>>>>>>>>>>>>>>>>        // Insert Code Here
50770>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
50771>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
50772>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
50773>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
50774>>>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
50775>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
50776>>>>>>>>>>>>>>>>>>>>>
50776>>>>>>>>>>>>>>>>>>>>>    Procedure Creating
50777>>>>>>>>>>>>>>>>>>>>>        Forward Send Creating
50779>>>>>>>>>>>>>>>>>>>>>        // Insert Code Here
50779>>>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
50780>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
50781>>>>>>>>>>>>>>>>>>>>>
50781>>>>>>>>>>>>>>>>>>>>>
50781>>>>>>>>>>>>>>>>>>>>>
50781>>>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
50781>>>>>>>>>>>>>>>>>>>>>
50781>>>>>>>>>>>>>>>>>>>>>//    Procedure Creating
50781>>>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
50781>>>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
50781>>>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
50781>>>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
50781>>>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
50781>>>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
50781>>>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
50781>>>>>>>>>>>>>>>>>>>>>
50781>>>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
50782>>>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
50783>>>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
50785>>>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
50785>>>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
50785>>>>>>>>>>>>>>>>>>>>>//            If ( ;
50785>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
50785>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
50785>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
50785>>>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
50785>>>>>>>>>>>>>>>>>>>>>//        End
50785>>>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
50786>>>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
50787>>>>>>>>>>>>>>>>>>>>>
50787>>>>>>>>>>>>>>>>>>>>>
50787>>>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
50788>>>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
50789>>>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
50791>>>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
50791>>>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
50791>>>>>>>>>>>>>>>>>>>>>//            If ( ;
50791>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
50791>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
50791>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
50791>>>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
50791>>>>>>>>>>>>>>>>>>>>>//        End
50791>>>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
50792>>>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
50793>>>>>>>>>>>>>>>>>>>>>
50793>>>>>>>>>>>>>>>>>>>>>
50793>>>>>>>>>>>>>>>>>>>>>
50793>>>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
50794>>>>>>>>>>>>>>>>>>>>>              Case Begin
50794>>>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
50796>>>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50797>>>>>>>>>>>>>>>>>>>>>>
50797>>>>>>>>>>>>>>>>>>>>>                        Case Break
50798>>>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
50801>>>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50802>>>>>>>>>>>>>>>>>>>>>>
50802>>>>>>>>>>>>>>>>>>>>>                        Case Break
50803>>>>>>>>>>>>>>>>>>>>>                   Case Else
50803>>>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
50805>>>>>>>>>>>>>>>>>>>>>              Case End
50805>>>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
50806>>>>>>>>>>>>>>>>>>>>>
50806>>>>>>>>>>>>>>>>>>>>>
50806>>>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50807>>>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50809>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50809>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50809>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50809>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50810>>>>>>>>>>>>>>>>>>>>>
50810>>>>>>>>>>>>>>>>>>>>>
50810>>>>>>>>>>>>>>>>>>>>>
50810>>>>>>>>>>>>>>>>>>>>>    // Define_Fields:
50810>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50810>>>>>>>>>>>>>>>>>>>>>
50810>>>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50811>>>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50813>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50813>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50813>>>>>>>>>>>>>>>>>>>>>
50813>>>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
50814>>>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50815>>>>>>>>>>>>>>>>>>>>>
50815>>>>>>>>>>>>>>>>>>>>>
50815>>>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50815>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
50816>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
50817>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
50818>>>>>>>>>>>>>>>>>>>>>
50818>>>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
50818>>>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
50819>>>>>>>>>>>>>>>>>>>>>
50819>>>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
50819>>>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
50820>>>>>>>>>>>>>>>>>>>>>
50820>>>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
50823>>>>>>>>>>>>>>>>>>>>>
50823>>>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50823>>>>>>>>>>>>>>>>>>>>>
50823>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
50823>>>>>>>>>>>>>>>>>>>>>
50823>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
50823>>>>>>>>>>>>>>>>>>>>>
50823>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
50823>>>>>>>>>>>>>>>>>>>>>
50823>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
50823>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
50824>>>>>>>>>>>>>>>>>>>>>
50824>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
50824>>>>>>>>>>>>>>>>>>>>>
50824>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
50824>>>>>>>>>>>>>>>>>>>>>
50824>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
50824>>>>>>>>>>>>>>>>>>>>>
50824>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
50824>>>>>>>>>>>>>>>>>>>>>
50824>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
50824>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
50825>>>>>>>>>>>>>>>>>>>>>
50825>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50825>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50826>>>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
50827>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50827>>>>>>>>>>>>>>>>>>>>>
50827>>>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
50827>>>>>>>>>>>>>>>>>>>>>
50827>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50827>>>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
50827>>>>>>>>>>>>>>>>>>>    
50827>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
50827>>>>>>>>>>>>>>>>>>>
50827>>>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
50846>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50847>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
50848>>>>>>>>>>>>>>>>>>>        Set Size to 171 467
50849>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
50852>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
50853>>>>>>>>>>>>>>>>>>>
50853>>>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
50855>>>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
50856>>>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
50857>>>>>>>>>>>>>>>>>>>
50857>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
50858>>>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
50859>>>>>>>>>>>>>>>>>>>
50859>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
50859>>>>>>>>>>>>>>>>>>>
50859>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
50861>>>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
50862>>>>>>>>>>>>>>>>>>>            Set Size to 132 450
50863>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
50864>>>>>>>>>>>>>>>>>>>
50864>>>>>>>>>>>>>>>>>>>            Begin_Row
50867>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
50868>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
50869>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
50870>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
50871>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
50872>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
50873>>>>>>>>>>>>>>>>>>>            End_Row
50878>>>>>>>>>>>>>>>>>>>
50878>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
50879>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
50880>>>>>>>>>>>>>>>>>>>            
50880>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
50881>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50882>>>>>>>>>>>>>>>>>>>            
50882>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
50883>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
50884>>>>>>>>>>>>>>>>>>>            
50884>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
50885>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
50886>>>>>>>>>>>>>>>>>>>            
50886>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
50887>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
50888>>>>>>>>>>>>>>>>>>>            
50888>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
50889>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
50890>>>>>>>>>>>>>>>>>>>            
50890>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
50891>>>>>>>>>>>>>>>>>>>
50891>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
50893>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50894>>>>>>>>>>>>>>>>>>>            Set Location to 140 298
50895>>>>>>>>>>>>>>>>>>>
50895>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50895>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50897>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
50898>>>>>>>>>>>>>>>>>>>            End_Procedure
50899>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50899>>>>>>>>>>>>>>>>>>>
50899>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
50900>>>>>>>>>>>>>>>>>>>
50900>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
50902>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50903>>>>>>>>>>>>>>>>>>>            Set Location to 140 353
50904>>>>>>>>>>>>>>>>>>>
50904>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50904>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50906>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
50907>>>>>>>>>>>>>>>>>>>            End_Procedure
50908>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50908>>>>>>>>>>>>>>>>>>>
50908>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
50909>>>>>>>>>>>>>>>>>>>
50909>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
50911>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
50912>>>>>>>>>>>>>>>>>>>            Set Location to 140 408
50913>>>>>>>>>>>>>>>>>>>
50913>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50913>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50915>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
50916>>>>>>>>>>>>>>>>>>>            End_Procedure
50917>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50917>>>>>>>>>>>>>>>>>>>
50917>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
50918>>>>>>>>>>>>>>>>>>>
50918>>>>>>>>>>>>>>>>>>>
50918>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
50918>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50919>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50920>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50921>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
50921>>>>>>>>>>>>>>>>>>>
50921>>>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
50923>>>>>>>>>>>>>>>>>>>>
50923>>>>>>>>>>>>>>>>>>>
50923>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
50923>>>>>>>>>>>>>>>>>
50923>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50923>>>>>>>>>>>>>>>>>//DDB-FileEnd
50923>>>>>>>>>>>>>>>    
50923>>>>>>>>>>>>>>>    //AB-IgnoreEnd
50923>>>>>>>>>>>>>>>
50923>>>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
50942>>>>>>>>>>>>>>>
50942>>>>>>>>>>>>>>>        //AB-StoreTopStart
50942>>>>>>>>>>>>>>>        Property Integer piFragmaLast -1
50944>>>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
50946>>>>>>>>>>>>>>>        Property String  psFragmaToCode ""
50948>>>>>>>>>>>>>>>        
50948>>>>>>>>>>>>>>>        //AB-StoreTopEnd
50948>>>>>>>>>>>>>>>
50948>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50949>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
50950>>>>>>>>>>>>>>>        Set Size to 204 393
50951>>>>>>>>>>>>>>>        Set Location to 5 16
50952>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50953>>>>>>>>>>>>>>>        Set Modal_State to FALSE
50954>>>>>>>>>>>>>>>
50954>>>>>>>>>>>>>>>        //AB-DDOStart
50954>>>>>>>>>>>>>>>
50954>>>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
50956>>>>>>>>>>>>>>>
50956>>>>>>>>>>>>>>>            //AB-StoreStart
50956>>>>>>>>>>>>>>>                        
50956>>>>>>>>>>>>>>>            Procedure OnConstrain
50958>>>>>>>>>>>>>>>                Integer liFragmaLast
50959>>>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
50959>>>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
50960>>>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
50961>>>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
50962>>>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
50966>>>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
50970>>>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
50974>>>>>>>>>>>>>>>            End_Procedure // OnConstrain
50975>>>>>>>>>>>>>>>            
50975>>>>>>>>>>>>>>>            
50975>>>>>>>>>>>>>>>            //AB-StoreEnd
50975>>>>>>>>>>>>>>>
50975>>>>>>>>>>>>>>>        End_Object    // Gplan_DD
50976>>>>>>>>>>>>>>>
50976>>>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
50977>>>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
50978>>>>>>>>>>>>>>>
50978>>>>>>>>>>>>>>>        //AB-DDOEnd
50978>>>>>>>>>>>>>>>
50978>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
50980>>>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
50981>>>>>>>>>>>>>>>            Set Ordering to 3
50982>>>>>>>>>>>>>>>            Set Size to 164 378
50983>>>>>>>>>>>>>>>            Set Location to 4 6
50984>>>>>>>>>>>>>>>
50984>>>>>>>>>>>>>>>            Begin_Row
50987>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
50988>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
50989>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
50990>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
50991>>>>>>>>>>>>>>>            End_Row
50996>>>>>>>>>>>>>>>
50996>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
50997>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
50998>>>>>>>>>>>>>>>            
50998>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
50999>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
51000>>>>>>>>>>>>>>>            
51000>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
51001>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
51002>>>>>>>>>>>>>>>            
51002>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
51003>>>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
51004>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
51005>>>>>>>>>>>>>>>            
51005>>>>>>>>>>>>>>>
51005>>>>>>>>>>>>>>>            //AB-StoreStart
51005>>>>>>>>>>>>>>>                        
51005>>>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
51007>>>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
51009>>>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
51011>>>>>>>>>>>>>>>            
51011>>>>>>>>>>>>>>>            Procedure Store_Defaults
51013>>>>>>>>>>>>>>>                forward send Store_Defaults
51015>>>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
51016>>>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
51017>>>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
51018>>>>>>>>>>>>>>>            end_Procedure // Store_Defaults
51019>>>>>>>>>>>>>>>            
51019>>>>>>>>>>>>>>>            Procedure Restore_Defaults
51021>>>>>>>>>>>>>>>                forward send Restore_Defaults
51023>>>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
51024>>>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
51025>>>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
51026>>>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
51027>>>>>>>>>>>>>>>            
51027>>>>>>>>>>>>>>>            Procedure Activating
51029>>>>>>>>>>>>>>>                Forward Send Activating
51031>>>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
51032>>>>>>>>>>>>>>>            End_Procedure // Activating
51033>>>>>>>>>>>>>>>            
51033>>>>>>>>>>>>>>>            
51033>>>>>>>>>>>>>>>            
51033>>>>>>>>>>>>>>>            
51033>>>>>>>>>>>>>>>            //AB-StoreEnd
51033>>>>>>>>>>>>>>>
51033>>>>>>>>>>>>>>>        End_Object    // oSelList
51034>>>>>>>>>>>>>>>
51034>>>>>>>>>>>>>>>        Object oOK_bn is a Button
51036>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
51037>>>>>>>>>>>>>>>            Set Location to 170 226
51038>>>>>>>>>>>>>>>
51038>>>>>>>>>>>>>>>            //AB-StoreStart
51038>>>>>>>>>>>>>>>            Procedure OnClick
51040>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
51041>>>>>>>>>>>>>>>            End_Procedure
51042>>>>>>>>>>>>>>>            //AB-StoreEnd
51042>>>>>>>>>>>>>>>
51042>>>>>>>>>>>>>>>        End_Object    // oOK_bn
51043>>>>>>>>>>>>>>>
51043>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
51045>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
51046>>>>>>>>>>>>>>>            Set Location to 170 279
51047>>>>>>>>>>>>>>>
51047>>>>>>>>>>>>>>>            //AB-StoreStart
51047>>>>>>>>>>>>>>>            Procedure OnClick
51049>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
51050>>>>>>>>>>>>>>>            End_Procedure
51051>>>>>>>>>>>>>>>            //AB-StoreEnd
51051>>>>>>>>>>>>>>>
51051>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
51052>>>>>>>>>>>>>>>
51052>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
51054>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
51055>>>>>>>>>>>>>>>            Set Location to 170 334
51056>>>>>>>>>>>>>>>
51056>>>>>>>>>>>>>>>            //AB-StoreStart
51056>>>>>>>>>>>>>>>            Procedure OnClick
51058>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
51059>>>>>>>>>>>>>>>            End_Procedure
51060>>>>>>>>>>>>>>>            //AB-StoreEnd
51060>>>>>>>>>>>>>>>
51060>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
51061>>>>>>>>>>>>>>>
51061>>>>>>>>>>>>>>>
51061>>>>>>>>>>>>>>>        //AB-StoreStart
51061>>>>>>>>>>>>>>>                
51061>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
51062>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
51063>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
51064>>>>>>>>>>>>>>>        
51064>>>>>>>>>>>>>>>        
51064>>>>>>>>>>>>>>>        
51064>>>>>>>>>>>>>>>        //AB-StoreEnd
51064>>>>>>>>>>>>>>>
51064>>>>>>>>>>>>>>>    CD_End_Object    // sl150
51066>>>>>>>>>>>>>>>>
51066>>>>>>>>>>>>>>>
51066>>>>>>>>>>>>>>>//AB/     End_Object    // prj
51066>>>>>>>>>>>>>
51066>>>>>>>>>>>>>//DDB-Selection-pkg-End
51066>>>>>>>>>>>>>//DDB-FileEnd
51066>>>>>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
51066>>>>>>>>>>>>>//DDB-FileStart
51066>>>>>>>>>>>>>//DDB-HeaderStart
51066>>>>>>>>>>>>>
51066>>>>>>>>>>>>>// File Name : ITEM.DD
51066>>>>>>>>>>>>>// Class Name: Item_DataDictionary
51066>>>>>>>>>>>>>// Revision  : 63
51066>>>>>>>>>>>>>// Version   : 2
51066>>>>>>>>>>>>>
51066>>>>>>>>>>>>>Use  Windows           // Basic Definitions
51066>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51066>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51066>>>>>>>>>>>>>
51066>>>>>>>>>>>>>Open Item
51068>>>>>>>>>>>>>Open Witemx
51070>>>>>>>>>>>>>Open Witemcl
51072>>>>>>>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
51074>>>>>>>>>>>>>Open Units
51076>>>>>>>>>>>>>Open Witemkat
51078>>>>>>>>>>>>>Open Fpa
51080>>>>>>>>>>>>>Open Sysrecw
51082>>>>>>>>>>>>>Open Witemx
51084>>>>>>>>>>>>>
51084>>>>>>>>>>>>>//DDB-HeaderEnd
51084>>>>>>>>>>>>>//DDB-ValidationStart
51084>>>>>>>>>>>>>
51084>>>>>>>>>>>>>Register_Object Item_Item_Qual_VT
51084>>>>>>>>>>>>>Register_Object Item_Item_Analysh_VT
51084>>>>>>>>>>>>>
51084>>>>>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
51086>>>>>>>>>>>>>    Set Type_Value        To "QUAL"
51087>>>>>>>>>>>>>    Set Validate_State    To FALSE
51088>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
51089>>>>>>>>>>>>>    //DDB-ValidationCustomStart
51089>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
51089>>>>>>>>>>>>>End_Object   // Item_Item_Qual_VT
51090>>>>>>>>>>>>>
51090>>>>>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
51092>>>>>>>>>>>>>    Set Type_Value        To "ITEMANAL"
51093>>>>>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
51094>>>>>>>>>>>>>    //DDB-ValidationCustomStart
51094>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
51094>>>>>>>>>>>>>End_Object   // Item_Item_Analysh_VT
51095>>>>>>>>>>>>>//DDB-ValidationEnd
51095>>>>>>>>>>>>>//DDB-SelectionStart
51095>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
51095>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
51095>>>>>>>>>>>>>Register_Object SL22s
51095>>>>>>>>>>>>>Register_Object sl022
51095>>>>>>>>>>>>>//DDB-SelectionEnd
51095>>>>>>>>>>>>>
51095>>>>>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
51096>>>>>>>>>>>>>
51096>>>>>>>>>>>>>    Procedure Update
51097>>>>>>>>>>>>>        Forward Send Update
51099>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
51100>>>>>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
51101>>>>>>>>>>>>>    End_Procedure   // Update
51102>>>>>>>>>>>>>
51102>>>>>>>>>>>>>    Procedure Creating
51103>>>>>>>>>>>>>        Date dHmnia
51104>>>>>>>>>>>>>        Forward Send Creating
51106>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
51107>>>>>>>>>>>>>        
51107>>>>>>>>>>>>>        Clear Branch
51108>>>>>>>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
51109>>>>>>>>>>>>>        Find Gt Branch By Index.1 
51110>>>>>>>>>>>>>>
51110>>>>>>>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
51114>>>>>>>>>>>>>            Clear Witemx
51115>>>>>>>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
51116>>>>>>>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
51117>>>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
51118>>>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
51119>>>>>>>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
51120>>>>>>>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
51121>>>>>>>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
51122>>>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
51123>>>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
51124>>>>>>>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
51125>>>>>>>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
51126>>>>>>>>>>>>>            Move Item.link1                 to Witemx.link1
51127>>>>>>>>>>>>>            Move Item.link2                 to Witemx.link2
51128>>>>>>>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
51129>>>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
51130>>>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
51131>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
51132>>>>>>>>>>>>>            Saverecord Sysrecw
51133>>>>>>>>>>>>>            Saverecord Witemx
51134>>>>>>>>>>>>>            
51134>>>>>>>>>>>>>            Find Gt Branch By Index.1 
51135>>>>>>>>>>>>>>
51135>>>>>>>>>>>>>        Loop
51136>>>>>>>>>>>>>>
51136>>>>>>>>>>>>>    End_Procedure   // Creating
51137>>>>>>>>>>>>>
51137>>>>>>>>>>>>>
51137>>>>>>>>>>>>>    // Define_Fields:
51137>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51137>>>>>>>>>>>>>
51137>>>>>>>>>>>>>    Procedure Define_Fields
51138>>>>>>>>>>>>>        Forward Send Define_Fields
51140>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51140>>>>>>>>>>>>>        //DDB-DefineFieldStart
51140>>>>>>>>>>>>>
51140>>>>>>>>>>>>>        Set Main_File            To Item.File_Number
51141>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51142>>>>>>>>>>>>>
51142>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51143>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51144>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51145>>>>>>>>>>>>>
51145>>>>>>>>>>>>>        // Child (Client) file structure................
51145>>>>>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
51146>>>>>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
51147>>>>>>>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
51148>>>>>>>>>>>>>
51148>>>>>>>>>>>>>        // Parent (Server) file structure...............
51148>>>>>>>>>>>>>        Send Add_Server_File  Units.File_Number
51149>>>>>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
51150>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
51151>>>>>>>>>>>>>
51151>>>>>>>>>>>>>        // External (System) file structure.............
51151>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51152>>>>>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
51153>>>>>>>>>>>>>
51153>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
51156>>>>>>>>>>>>>
51156>>>>>>>>>>>>>        // Field-based properties.......................
51156>>>>>>>>>>>>>
51156>>>>>>>>>>>>>        // Item.Units_Code
51156>>>>>>>>>>>>>
51156>>>>>>>>>>>>>        // Item.Units_Recr
51156>>>>>>>>>>>>>
51156>>>>>>>>>>>>>        // Item.Witemkat_Code
51156>>>>>>>>>>>>>
51156>>>>>>>>>>>>>        // Item.Witemkat_Recr
51156>>>>>>>>>>>>>
51156>>>>>>>>>>>>>        // Item.Item_Code
51156>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
51157>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
51158>>>>>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
51159>>>>>>>>>>>>>
51159>>>>>>>>>>>>>        // Item.Item_Rec0
51159>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
51160>>>>>>>>>>>>>
51160>>>>>>>>>>>>>        // Item.Item_Descr
51160>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
51161>>>>>>>>>>>>>
51161>>>>>>>>>>>>>        // Item.Item_Recr
51161>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
51162>>>>>>>>>>>>>
51162>>>>>>>>>>>>>        // Item.Fpa_Pososto
51162>>>>>>>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
51163>>>>>>>>>>>>>
51163>>>>>>>>>>>>>        // Item.Item_Qual
51163>>>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
51164>>>>>>>>>>>>>
51164>>>>>>>>>>>>>        // Item.Wapokat_Code
51164>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
51165>>>>>>>>>>>>>
51165>>>>>>>>>>>>>        // Item.Item_Analysh
51165>>>>>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
51166>>>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Item_Orio
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Codeglpol
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Codeglago
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Link1
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Link2
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Group
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        // Item.Sap
51167>>>>>>>>>>>>>
51167>>>>>>>>>>>>>        //DDB-DefineFieldEnd
51167>>>>>>>>>>>>>    End_Procedure    // Define_Fields
51168>>>>>>>>>>>>>
51168>>>>>>>>>>>>>    // Field_Defaults:
51168>>>>>>>>>>>>>    // This procedure is used to establish default field values.
51168>>>>>>>>>>>>>
51168>>>>>>>>>>>>>    Procedure Field_Defaults
51169>>>>>>>>>>>>>        Forward Send Field_Defaults
51171>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51171>>>>>>>>>>>>>        //DDB-FieldDefaultStart
51171>>>>>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
51172>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
51172>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
51173>>>>>>>>>>>>>
51173>>>>>>>>>>>>>End_Class    // Item_DataDictionary
51174>>>>>>>>>>>>>//DDB-Selection-pkg-Start
51174>>>>>>>>>>>>>
51174>>>>>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
51174>>>>>>>>>>>>>>>//AB/ Project SL22s:ITEM
51174>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
51174>>>>>>>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
51174>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>// Project Object Structure
51174>>>>>>>>>>>>>>>//   SL22s is a dbModalPanel
51174>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
51174>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
51174>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
51174>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
51174>>>>>>>>>>>>>>>//     oSelList is a dbListSub
51174>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51174>>>>>>>>>>>>>>>//     ocode is a FormSub
51174>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51174>>>>>>>>>>>>>>>//     operi is a FormSub
51174>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
51174>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
51174>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
51174>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
51174>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
51174>>>>>>>>>>>>>>>//     ocodekat is a FormSub
51174>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
51174>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
51174>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>// Register all objects
51174>>>>>>>>>>>>>>>Register_Object ButtonSub1
51174>>>>>>>>>>>>>>>Register_Object Fpa_DD
51174>>>>>>>>>>>>>>>Register_Object Item_DD
51174>>>>>>>>>>>>>>>Register_Object oCancel_bn
51174>>>>>>>>>>>>>>>Register_Object ocode
51174>>>>>>>>>>>>>>>Register_Object ocodekat
51174>>>>>>>>>>>>>>>Register_Object oOK_bn
51174>>>>>>>>>>>>>>>Register_Object operi
51174>>>>>>>>>>>>>>>Register_Object oSearch_bn
51174>>>>>>>>>>>>>>>Register_Object oSelList
51174>>>>>>>>>>>>>>>Register_Object Radio1
51174>>>>>>>>>>>>>>>Register_Object Radio2
51174>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
51174>>>>>>>>>>>>>>>Register_Object SL22s
51174>>>>>>>>>>>>>>>Register_Object TextBoxSub1
51174>>>>>>>>>>>>>>>Register_Object TextBoxSub2
51174>>>>>>>>>>>>>>>Register_Object TextBoxSub3
51174>>>>>>>>>>>>>>>Register_Object Units_DD
51174>>>>>>>>>>>>>>>Register_Object Witemkat_DD
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>    //AB-StoreTopStart
51174>>>>>>>>>>>>>>>                                
51174>>>>>>>>>>>>>>>                                
51174>>>>>>>>>>>>>>>    //AB-StoreTopEnd
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>    //AB-IgnoreStart
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
51174>>>>>>>>>>>>>>>    Use dbList.Sub
51174>>>>>>>>>>>>>>>    Use Txtbox.Sub
51174>>>>>>>>>>>>>>>    Use Form.Sub
51174>>>>>>>>>>>>>>>    Use Rgroup.Sub
51174>>>>>>>>>>>>>>>    Use Radio.Sub
51174>>>>>>>>>>>>>>>    Use Button.Sub
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>    Use WITEMKAT.DD
51174>>>>>>>>>>>>>>>    Use UNITS.DD
51174>>>>>>>>>>>>>>>    Use FPA.DD
51174>>>>>>>>>>>>>>>    Use ITEM.DD
51174>>>>>>>>>>>>>>>    
51174>>>>>>>>>>>>>>>    //AB-IgnoreEnd
51174>>>>>>>>>>>>>>>
51174>>>>>>>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
51193>>>>>>>>>>>>>>>
51193>>>>>>>>>>>>>>>        //AB-StoreTopStart
51193>>>>>>>>>>>>>>>        Property String     pscode                  ''
51195>>>>>>>>>>>>>>>        Property String     psperi                  ''
51197>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
51199>>>>>>>>>>>>>>>        Property String     pscodekat               ''
51201>>>>>>>>>>>>>>>        
51201>>>>>>>>>>>>>>>        //AB-StoreTopEnd
51201>>>>>>>>>>>>>>>
51201>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
51202>>>>>>>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
51203>>>>>>>>>>>>>>>        Set Size to 270 484
51204>>>>>>>>>>>>>>>        Set Location to 5 7
51205>>>>>>>>>>>>>>>
51205>>>>>>>>>>>>>>>        //AB-DDOStart
51205>>>>>>>>>>>>>>>
51205>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51207>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
51208>>>>>>>>>>>>>>>
51208>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
51210>>>>>>>>>>>>>>>        End_Object    // Units_DD
51211>>>>>>>>>>>>>>>
51211>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
51213>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
51214>>>>>>>>>>>>>>>
51214>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
51216>>>>>>>>>>>>>>>
51216>>>>>>>>>>>>>>>            //AB-StoreTopStart
51216>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
51218>>>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
51219>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
51219>>>>>>>>>>>>>>>                       Move 0 to rVal
51220>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
51221>>>>>>>>>>>>>>>                       Get psperi to lsperi
51222>>>>>>>>>>>>>>>                       Get pscode to lscode
51223>>>>>>>>>>>>>>>                       Get pscodekat to lscodekat
51224>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51225>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51226>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
51226>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
51228>>>>>>>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
51230>>>>>>>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
51233>>>>>>>>>>>>>>>                           End
51233>>>>>>>>>>>>>>>>
51233>>>>>>>>>>>>>>>            
51233>>>>>>>>>>>>>>>                       End
51233>>>>>>>>>>>>>>>>
51233>>>>>>>>>>>>>>>                       Else Begin
51234>>>>>>>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
51236>>>>>>>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
51239>>>>>>>>>>>>>>>                           End
51239>>>>>>>>>>>>>>>>
51239>>>>>>>>>>>>>>>            
51239>>>>>>>>>>>>>>>                       End
51239>>>>>>>>>>>>>>>>
51239>>>>>>>>>>>>>>>                       Function_Return rVal
51240>>>>>>>>>>>>>>>                   End_Function
51241>>>>>>>>>>>>>>>            
51241>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
51243>>>>>>>>>>>>>>>                       String lsperi
51244>>>>>>>>>>>>>>>                       Get psperi to lsperi
51245>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51246>>>>>>>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
51247>>>>>>>>>>>>>>>                   End_Function
51248>>>>>>>>>>>>>>>            
51248>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
51250>>>>>>>>>>>>>>>                       String lscode lscodekat
51251>>>>>>>>>>>>>>>                       Get pscode to lscode
51252>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51253>>>>>>>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
51254>>>>>>>>>>>>>>>                   End_Function
51255>>>>>>>>>>>>>>>            
51255>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51255>>>>>>>>>>>>>>>
51255>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
51256>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
51257>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
51258>>>>>>>>>>>>>>>
51258>>>>>>>>>>>>>>>            //AB-StoreStart
51258>>>>>>>>>>>>>>>                                                                                                
51258>>>>>>>>>>>>>>>                                                                                                
51258>>>>>>>>>>>>>>>                                                                                                
51258>>>>>>>>>>>>>>>            Begin_Constraints
51260>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
51261>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
51261>>>>>>>>>>>>>>>             //  Get FragmaItem  to lsValue
51261>>>>>>>>>>>>>>>            
51261>>>>>>>>>>>>>>>                   Get psperi  to lsperi
51262>>>>>>>>>>>>>>>                   Get pscode  to lscode
51263>>>>>>>>>>>>>>>                   Get pscodekat  to lscodekat
51264>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
51265>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
51266>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
51267>>>>>>>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
51268>>>>>>>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
51270>>>>>>>>>>>>>>>                        set ordering to 5
51271>>>>>>>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
51272>>>>>>>>>>>>>>>                   end
51272>>>>>>>>>>>>>>>>
51272>>>>>>>>>>>>>>>                   Else Begin
51273>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
51275>>>>>>>>>>>>>>>                        If (lsperi<>'') begin
51277>>>>>>>>>>>>>>>                            set ordering to 3
51278>>>>>>>>>>>>>>>                            Constrain item.item_descr Contains lsperi
51280>>>>>>>>>>>>>>>                        end
51280>>>>>>>>>>>>>>>>
51280>>>>>>>>>>>>>>>                        Else If (lscode<>'') begin
51283>>>>>>>>>>>>>>>                            set ordering to 5
51284>>>>>>>>>>>>>>>                            Constrain item.item_code Contains lscode
51286>>>>>>>>>>>>>>>                        end
51286>>>>>>>>>>>>>>>>
51286>>>>>>>>>>>>>>>                      End
51286>>>>>>>>>>>>>>>>
51286>>>>>>>>>>>>>>>                      Else Begin
51287>>>>>>>>>>>>>>>                           If (lsperi<>'') begin
51289>>>>>>>>>>>>>>>                                set ordering to 3
51290>>>>>>>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
51291>>>>>>>>>>>>>>>                           end
51291>>>>>>>>>>>>>>>>
51291>>>>>>>>>>>>>>>                           Else If (lscode<>'') begin
51294>>>>>>>>>>>>>>>                                set ordering to 5
51295>>>>>>>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
51296>>>>>>>>>>>>>>>                           end
51296>>>>>>>>>>>>>>>>
51296>>>>>>>>>>>>>>>                      End
51296>>>>>>>>>>>>>>>>
51296>>>>>>>>>>>>>>>                   End
51296>>>>>>>>>>>>>>>>
51296>>>>>>>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
51300>>>>>>>>>>>>>>>            
51300>>>>>>>>>>>>>>>            End_Constraints
51303>>>>>>>>>>>>>>>            
51303>>>>>>>>>>>>>>>            
51303>>>>>>>>>>>>>>>            
51303>>>>>>>>>>>>>>>            
51303>>>>>>>>>>>>>>>            //AB-StoreEnd
51303>>>>>>>>>>>>>>>
51303>>>>>>>>>>>>>>>        End_Object    // Item_DD
51304>>>>>>>>>>>>>>>
51304>>>>>>>>>>>>>>>        Set Main_DD to (Item_DD(self))
51305>>>>>>>>>>>>>>>        Set Server to (Item_DD(self))
51306>>>>>>>>>>>>>>>
51306>>>>>>>>>>>>>>>        //AB-DDOEnd
51306>>>>>>>>>>>>>>>
51306>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
51308>>>>>>>>>>>>>>>            Set Main_File to Item.File_Number
51309>>>>>>>>>>>>>>>            Set Ordering to 5
51310>>>>>>>>>>>>>>>            Set Size to 190 475
51311>>>>>>>>>>>>>>>            Set Location to -1 2
51312>>>>>>>>>>>>>>>            Set Color to 14280447
51313>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
51314>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
51315>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
51316>>>>>>>>>>>>>>>
51316>>>>>>>>>>>>>>>            Begin_Row
51319>>>>>>>>>>>>>>>                Entry_Item Item.Item_code
51320>>>>>>>>>>>>>>>                Entry_Item Item.Item_descr
51321>>>>>>>>>>>>>>>                Entry_Item Item.Witemkat_code
51322>>>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
51323>>>>>>>>>>>>>>>                Entry_Item Item.Item_qual
51324>>>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
51325>>>>>>>>>>>>>>>            End_Row
51330>>>>>>>>>>>>>>>
51330>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
51331>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
51332>>>>>>>>>>>>>>>            
51332>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
51333>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
51334>>>>>>>>>>>>>>>            
51334>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
51335>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
51336>>>>>>>>>>>>>>>            
51336>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
51337>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
51338>>>>>>>>>>>>>>>            
51338>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
51339>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
51340>>>>>>>>>>>>>>>            
51340>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
51341>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
51342>>>>>>>>>>>>>>>            
51342>>>>>>>>>>>>>>>
51342>>>>>>>>>>>>>>>            //AB-StoreStart
51342>>>>>>>>>>>>>>>            
51342>>>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
51344>>>>>>>>>>>>>>>            
51344>>>>>>>>>>>>>>>            set export_item_state to true
51345>>>>>>>>>>>>>>>            
51345>>>>>>>>>>>>>>>            Procedure Activating
51347>>>>>>>>>>>>>>>               Forward send Activating
51349>>>>>>>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
51350>>>>>>>>>>>>>>>            End_Procedure
51351>>>>>>>>>>>>>>>            
51351>>>>>>>>>>>>>>>            Function Child_Exiting Integer iWhere Returns Integer
51353>>>>>>>>>>>>>>>                local integer Rval
51354>>>>>>>>>>>>>>>                Forward get Child_Exiting iWhere  to Rval
51356>>>>>>>>>>>>>>>                set value of (ocode   (self))   to ''
51357>>>>>>>>>>>>>>>                set value of (operi   (self))   to ''
51358>>>>>>>>>>>>>>>                set value of (ocodekat(self))   to ''
51359>>>>>>>>>>>>>>>                set psperi                      to ''
51360>>>>>>>>>>>>>>>                set pscode                      to ''
51361>>>>>>>>>>>>>>>                set pscodekat                   to ''
51362>>>>>>>>>>>>>>>                function_return Rval // if non-zero do not enter
51363>>>>>>>>>>>>>>>            End_function
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            
51364>>>>>>>>>>>>>>>            //AB-StoreEnd
51364>>>>>>>>>>>>>>>
51364>>>>>>>>>>>>>>>        End_Object    // oSelList
51365>>>>>>>>>>>>>>>
51365>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
51367>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
51368>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51369>>>>>>>>>>>>>>>            Set Location to 192 6
51370>>>>>>>>>>>>>>>            Set Size to 13 78
51371>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
51372>>>>>>>>>>>>>>>
51372>>>>>>>>>>>>>>>        Object ocode is a FormSub
51374>>>>>>>>>>>>>>>            Set Size to 13 197
51375>>>>>>>>>>>>>>>            Set Location to 192 79
51376>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51377>>>>>>>>>>>>>>>
51377>>>>>>>>>>>>>>>            //AB-StoreStart
51377>>>>>>>>>>>>>>>                                                
51377>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51379>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51380>>>>>>>>>>>>>>>            End_Procedure
51381>>>>>>>>>>>>>>>            
51381>>>>>>>>>>>>>>>            
51381>>>>>>>>>>>>>>>            
51381>>>>>>>>>>>>>>>            
51381>>>>>>>>>>>>>>>            //AB-StoreEnd
51381>>>>>>>>>>>>>>>
51381>>>>>>>>>>>>>>>        End_Object    // ocode
51382>>>>>>>>>>>>>>>
51382>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
51384>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
51385>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51386>>>>>>>>>>>>>>>            Set Location to 207 6
51387>>>>>>>>>>>>>>>            Set Size to 13 83
51388>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
51389>>>>>>>>>>>>>>>
51389>>>>>>>>>>>>>>>        Object operi is a FormSub
51391>>>>>>>>>>>>>>>            Set Size to 13 197
51392>>>>>>>>>>>>>>>            Set Location to 207 79
51393>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51394>>>>>>>>>>>>>>>
51394>>>>>>>>>>>>>>>            //AB-StoreStart
51394>>>>>>>>>>>>>>>                                                
51394>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51396>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51397>>>>>>>>>>>>>>>            End_Procedure
51398>>>>>>>>>>>>>>>            
51398>>>>>>>>>>>>>>>            
51398>>>>>>>>>>>>>>>            
51398>>>>>>>>>>>>>>>            
51398>>>>>>>>>>>>>>>            //AB-StoreEnd
51398>>>>>>>>>>>>>>>
51398>>>>>>>>>>>>>>>        End_Object    // operi
51399>>>>>>>>>>>>>>>
51399>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
51401>>>>>>>>>>>>>>>            Set Size to 32 77
51402>>>>>>>>>>>>>>>            Set Location to 193 277
51403>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
51405>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
51406>>>>>>>>>>>>>>>                Set Size to 10 53
51407>>>>>>>>>>>>>>>                Set Location to 7 5
51408>>>>>>>>>>>>>>>            End_Object    // Radio1
51409>>>>>>>>>>>>>>>
51409>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
51411>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
51412>>>>>>>>>>>>>>>                Set Size to 10 51
51413>>>>>>>>>>>>>>>                Set Location to 21 5
51414>>>>>>>>>>>>>>>            End_Object    // Radio2
51415>>>>>>>>>>>>>>>
51415>>>>>>>>>>>>>>>
51415>>>>>>>>>>>>>>>            //AB-StoreStart
51415>>>>>>>>>>>>>>>                                                
51415>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
51417>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
51418>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51419>>>>>>>>>>>>>>>            End_Procedure
51420>>>>>>>>>>>>>>>            
51420>>>>>>>>>>>>>>>            
51420>>>>>>>>>>>>>>>            
51420>>>>>>>>>>>>>>>            
51420>>>>>>>>>>>>>>>            //AB-StoreEnd
51420>>>>>>>>>>>>>>>
51420>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
51421>>>>>>>>>>>>>>>
51421>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
51423>>>>>>>>>>>>>>>            Set Label to "Search"
51424>>>>>>>>>>>>>>>            Set Size to 28 37
51425>>>>>>>>>>>>>>>            Set Location to 198 357
51426>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
51427>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
51428>>>>>>>>>>>>>>>
51428>>>>>>>>>>>>>>>            //AB-StoreStart
51428>>>>>>>>>>>>>>>                                                                                                
51428>>>>>>>>>>>>>>>            Set Visible_State to False
51429>>>>>>>>>>>>>>>            
51429>>>>>>>>>>>>>>>            Procedure OnClick
51431>>>>>>>>>>>>>>>                Forward Send OnClick
51433>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
51434>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
51435>>>>>>>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
51436>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
51437>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
51438>>>>>>>>>>>>>>>            End_Procedure // OnClick
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            
51439>>>>>>>>>>>>>>>            //AB-StoreEnd
51439>>>>>>>>>>>>>>>
51439>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
51440>>>>>>>>>>>>>>>
51440>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
51442>>>>>>>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
51443>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51444>>>>>>>>>>>>>>>            Set Location to 221 5
51445>>>>>>>>>>>>>>>            Set Size to 13 78
51446>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
51447>>>>>>>>>>>>>>>
51447>>>>>>>>>>>>>>>        Object ocodekat is a FormSub
51449>>>>>>>>>>>>>>>            Set Size to 13 197
51450>>>>>>>>>>>>>>>            Set Location to 221 78
51451>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51452>>>>>>>>>>>>>>>
51452>>>>>>>>>>>>>>>            //AB-StoreStart
51452>>>>>>>>>>>>>>>                                                
51452>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51454>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
51455>>>>>>>>>>>>>>>            End_Procedure
51456>>>>>>>>>>>>>>>            
51456>>>>>>>>>>>>>>>            
51456>>>>>>>>>>>>>>>            
51456>>>>>>>>>>>>>>>            //AB-StoreEnd
51456>>>>>>>>>>>>>>>
51456>>>>>>>>>>>>>>>        End_Object    // ocodekat
51457>>>>>>>>>>>>>>>
51457>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
51459>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
51460>>>>>>>>>>>>>>>            Set Location to 237 316
51461>>>>>>>>>>>>>>>
51461>>>>>>>>>>>>>>>            //AB-StoreStart
51461>>>>>>>>>>>>>>>            Procedure OnClick
51463>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
51464>>>>>>>>>>>>>>>            End_Procedure
51465>>>>>>>>>>>>>>>            //AB-StoreEnd
51465>>>>>>>>>>>>>>>
51465>>>>>>>>>>>>>>>        End_Object    // oOK_bn
51466>>>>>>>>>>>>>>>
51466>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
51468>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
51469>>>>>>>>>>>>>>>            Set Location to 237 371
51470>>>>>>>>>>>>>>>
51470>>>>>>>>>>>>>>>            //AB-StoreStart
51470>>>>>>>>>>>>>>>            Procedure OnClick
51472>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
51473>>>>>>>>>>>>>>>            End_Procedure
51474>>>>>>>>>>>>>>>            //AB-StoreEnd
51474>>>>>>>>>>>>>>>
51474>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
51475>>>>>>>>>>>>>>>
51475>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
51477>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
51478>>>>>>>>>>>>>>>            Set Location to 237 426
51479>>>>>>>>>>>>>>>
51479>>>>>>>>>>>>>>>            //AB-StoreStart
51479>>>>>>>>>>>>>>>            Procedure OnClick
51481>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
51482>>>>>>>>>>>>>>>            End_Procedure
51483>>>>>>>>>>>>>>>            //AB-StoreEnd
51483>>>>>>>>>>>>>>>
51483>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
51484>>>>>>>>>>>>>>>
51484>>>>>>>>>>>>>>>
51484>>>>>>>>>>>>>>>        //AB-StoreStart
51484>>>>>>>>>>>>>>>                
51484>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
51485>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
51486>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
51487>>>>>>>>>>>>>>>        
51487>>>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        
51488>>>>>>>>>>>>>>>        //AB-StoreEnd
51488>>>>>>>>>>>>>>>
51488>>>>>>>>>>>>>>>    CD_End_Object    // SL22s
51490>>>>>>>>>>>>>>>>
51490>>>>>>>>>>>>>>>
51490>>>>>>>>>>>>>>>
51490>>>>>>>>>>>>>>>    //AB-StoreStart
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>                                
51490>>>>>>>>>>>>>>>    //AB-StoreEnd
51490>>>>>>>>>>>>>>>
51490>>>>>>>>>>>>>>>//AB/     End_Object    // prj
51490>>>>>>>>>>>>>Use sl022.SL         // sl022
51490>>>>>>>>>>>>>
51490>>>>>>>>>>>>>//DDB-Selection-pkg-End
51490>>>>>>>>>>>>>//DDB-FileEnd
51490>>>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
51490>>>>>>>>>>>>>//DDB-FileStart
51490>>>>>>>>>>>>>//DDB-HeaderStart
51490>>>>>>>>>>>>>
51490>>>>>>>>>>>>>// File Name : WITEMX.DD
51490>>>>>>>>>>>>>// Class Name: Witemx_DataDictionary
51490>>>>>>>>>>>>>// Revision  : 77
51490>>>>>>>>>>>>>// Version   : 2
51490>>>>>>>>>>>>>
51490>>>>>>>>>>>>>Use  Windows           // Basic Definitions
51490>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51490>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51490>>>>>>>>>>>>>
51490>>>>>>>>>>>>>Open Witemx
51492>>>>>>>>>>>>>Open Witemxt
51494>>>>>>>>>>>>>Open Pmoves
51496>>>>>>>>>>>>>Open Wam
51498>>>>>>>>>>>>>Open Pmovesl
51500>>>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
51502>>>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
51504>>>>>>>>>>>>>Open Wcmoves
51506>>>>>>>>>>>>>Open Item
51508>>>>>>>>>>>>>Open Sysrecw
51510>>>>>>>>>>>>>Open Syscurxr
51512>>>>>>>>>>>>>
51512>>>>>>>>>>>>>//DDB-HeaderEnd
51512>>>>>>>>>>>>>//DDB-SelectionStart
51512>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
51512>>>>>>>>>>>>>Register_Object SL17
51512>>>>>>>>>>>>>//DDB-SelectionEnd
51512>>>>>>>>>>>>>
51512>>>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
51513>>>>>>>>>>>>>
51513>>>>>>>>>>>>>    Procedure Construct_Object
51514>>>>>>>>>>>>>        Forward Send Construct_Object
51516>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
51517>>>>>>>>>>>>>    End_Procedure //construct_object
51518>>>>>>>>>>>>>
51518>>>>>>>>>>>>>    Procedure OnConstrain
51519>>>>>>>>>>>>>        Forward Send OnConstrain
51521>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
51523>>>>>>>>>>>>>        End
51523>>>>>>>>>>>>>>
51523>>>>>>>>>>>>>        Else Begin
51524>>>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
51526>>>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
51528>>>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
51530>>>>>>>>>>>>>        End
51530>>>>>>>>>>>>>>
51530>>>>>>>>>>>>>    End_Procedure
51531>>>>>>>>>>>>>
51531>>>>>>>>>>>>>    Procedure Save_Main_File
51532>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
51534>>>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
51537>>>>>>>>>>>>>        End
51537>>>>>>>>>>>>>>
51537>>>>>>>>>>>>>        Forward Send Save_Main_File
51539>>>>>>>>>>>>>    End_Procedure
51540>>>>>>>>>>>>>
51540>>>>>>>>>>>>>    // Update:
51540>>>>>>>>>>>>>    Procedure Update
51541>>>>>>>>>>>>>        Forward Send Update
51543>>>>>>>>>>>>>        // Insert Code Here
51543>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
51544>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
51545>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
51546>>>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
51547>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
51548>>>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
51549>>>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
51550>>>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
51551>>>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
51552>>>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
51553>>>>>>>>>>>>>        Move Item.link1             to witemx.link1
51554>>>>>>>>>>>>>        move Item.link2             to witemx.link2
51555>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
51556>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
51557>>>>>>>>>>>>>    End_Procedure   // Update
51558>>>>>>>>>>>>>
51558>>>>>>>>>>>>>
51558>>>>>>>>>>>>>    Procedure Backout
51559>>>>>>>>>>>>>        Forward Send Backout
51561>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
51562>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
51563>>>>>>>>>>>>>    End_Procedure   // Update
51564>>>>>>>>>>>>>
51564>>>>>>>>>>>>>    Procedure Creating
51565>>>>>>>>>>>>>        Forward Send Creating
51567>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
51568>>>>>>>>>>>>>    End_Procedure   // Creating
51569>>>>>>>>>>>>>
51569>>>>>>>>>>>>>
51569>>>>>>>>>>>>>
51569>>>>>>>>>>>>>    // Define_Fields:
51569>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51569>>>>>>>>>>>>>
51569>>>>>>>>>>>>>    Procedure Define_Fields
51570>>>>>>>>>>>>>        Forward Send Define_Fields
51572>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51572>>>>>>>>>>>>>        //DDB-DefineFieldStart
51572>>>>>>>>>>>>>
51572>>>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
51573>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51574>>>>>>>>>>>>>
51574>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51575>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51576>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51577>>>>>>>>>>>>>
51577>>>>>>>>>>>>>        // Child (Client) file structure................
51577>>>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
51578>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
51579>>>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
51580>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
51581>>>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
51582>>>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
51583>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
51584>>>>>>>>>>>>>
51584>>>>>>>>>>>>>        // Parent (Server) file structure...............
51584>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
51585>>>>>>>>>>>>>
51585>>>>>>>>>>>>>        // External (System) file structure.............
51585>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51586>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
51587>>>>>>>>>>>>>
51587>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Field-based properties.......................
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Company_Code
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Branch_Code
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Year_Year
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Units_Code
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Witemkat_Code
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Item_Code
51590>>>>>>>>>>>>>
51590>>>>>>>>>>>>>        // Witemx.Witemx_Code
51590>>>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
51591>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
51592>>>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
51593>>>>>>>>>>>>>
51593>>>>>>>>>>>>>        // Witemx.Witemx_Recr
51593>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
51594>>>>>>>>>>>>>
51594>>>>>>>>>>>>>        // Witemx.Year_Recr
51594>>>>>>>>>>>>>
51594>>>>>>>>>>>>>        // Witemx.Item_Recr
51594>>>>>>>>>>>>>
51594>>>>>>>>>>>>>        // Witemx.Witemx_Descr
51594>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Witemx_Rec0
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Qty_Xre
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Qty_Pis
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Axia_Xre
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Axia_Pis
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Mesosta_Xre
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Mesosta_Pis
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Link1
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        // Witemx.Link2
51595>>>>>>>>>>>>>
51595>>>>>>>>>>>>>        //DDB-DefineFieldEnd
51595>>>>>>>>>>>>>    End_Procedure    // Define_Fields
51596>>>>>>>>>>>>>
51596>>>>>>>>>>>>>    // Field_Defaults:
51596>>>>>>>>>>>>>    // This procedure is used to establish default field values.
51596>>>>>>>>>>>>>
51596>>>>>>>>>>>>>    Procedure Field_Defaults
51597>>>>>>>>>>>>>        Forward Send Field_Defaults
51599>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51599>>>>>>>>>>>>>        //DDB-FieldDefaultStart
51599>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
51599>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
51600>>>>>>>>>>>>>
51600>>>>>>>>>>>>>End_Class    // Witemx_DataDictionary
51601>>>>>>>>>>>>>//DDB-Selection-pkg-Start
51601>>>>>>>>>>>>>
51601>>>>>>>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
51601>>>>>>>>>>>>>>>//AB/ Project SL17:witemx
51601>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
51601>>>>>>>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
51601>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
51601>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>// Project Object Structure
51601>>>>>>>>>>>>>>>//   SL17 is a dbModalPanelSub
51601>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
51601>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
51601>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
51601>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
51601>>>>>>>>>>>>>>>//     Witemx_DD is a DataDictionary
51601>>>>>>>>>>>>>>>//     oSelList is a dbListSub
51601>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51601>>>>>>>>>>>>>>>//     ocode is a FormSub
51601>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51601>>>>>>>>>>>>>>>//     operi is a FormSub
51601>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
51601>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
51601>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
51601>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
51601>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
51601>>>>>>>>>>>>>>>//     ocodekat is a FormSub
51601>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
51601>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
51601>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
51601>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
51601>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>// Register all objects
51601>>>>>>>>>>>>>>>Register_Object ButtonSub1
51601>>>>>>>>>>>>>>>Register_Object btnwitemcl
51601>>>>>>>>>>>>>>>Register_Object Fpa_DD
51601>>>>>>>>>>>>>>>Register_Object Item_DD
51601>>>>>>>>>>>>>>>Register_Object oCancel_bn
51601>>>>>>>>>>>>>>>Register_Object ocode
51601>>>>>>>>>>>>>>>Register_Object ocodekat
51601>>>>>>>>>>>>>>>Register_Object oOK_bn
51601>>>>>>>>>>>>>>>Register_Object operi
51601>>>>>>>>>>>>>>>Register_Object oSearch_bn
51601>>>>>>>>>>>>>>>Register_Object oSelList
51601>>>>>>>>>>>>>>>Register_Object Radio1
51601>>>>>>>>>>>>>>>Register_Object Radio2
51601>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
51601>>>>>>>>>>>>>>>Register_Object SL17
51601>>>>>>>>>>>>>>>Register_Object TextBoxSub1
51601>>>>>>>>>>>>>>>Register_Object TextBoxSub2
51601>>>>>>>>>>>>>>>Register_Object TextBoxSub3
51601>>>>>>>>>>>>>>>Register_Object Units_DD
51601>>>>>>>>>>>>>>>Register_Object Witemkat_DD
51601>>>>>>>>>>>>>>>Register_Object Witemx_DD
51601>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>    //AB-StoreTopStart
51601>>>>>>>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
51601>>>>>>>>>>>>>>>>>//AB/ Project dg186
51601>>>>>>>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
51601>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
51601>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
51601>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
51601>>>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>>>// Project Object Structure
51601>>>>>>>>>>>>>>>>>//   dg186 is a dbModalPanelSub
51601>>>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
51601>>>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
51601>>>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
51601>>>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
51601>>>>>>>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
51601>>>>>>>>>>>>>>>>>//     The_Table is a dbGrid
51601>>>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51601>>>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51601>>>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
51601>>>>>>>>>>>>>>>>>//     ocode is a FormSub
51601>>>>>>>>>>>>>>>>>//     operi is a FormSub
51601>>>>>>>>>>>>>>>>>//     ocodeprom is a FormSub
51601>>>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
51601>>>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
51601>>>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
51601>>>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
51601>>>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
51601>>>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>>>// Register all objects
51601>>>>>>>>>>>>>>>>>Register_Object ButtonSub1
51601>>>>>>>>>>>>>>>>>Register_Object btnwitemcl
51601>>>>>>>>>>>>>>>>>Register_Object dg186
51601>>>>>>>>>>>>>>>>>Register_Object Fpa_DD
51601>>>>>>>>>>>>>>>>>Register_Object Item_DD
51601>>>>>>>>>>>>>>>>>Register_Object ocode
51601>>>>>>>>>>>>>>>>>Register_Object ocodeprom
51601>>>>>>>>>>>>>>>>>Register_Object operi
51601>>>>>>>>>>>>>>>>>Register_Object Radio1
51601>>>>>>>>>>>>>>>>>Register_Object Radio2
51601>>>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
51601>>>>>>>>>>>>>>>>>Register_Object TextBoxSub1
51601>>>>>>>>>>>>>>>>>Register_Object TextBoxSub2
51601>>>>>>>>>>>>>>>>>Register_Object TextBoxSub3
51601>>>>>>>>>>>>>>>>>Register_Object The_Table
51601>>>>>>>>>>>>>>>>>Register_Object Units_DD
51601>>>>>>>>>>>>>>>>>Register_Object Witemcl_DD
51601>>>>>>>>>>>>>>>>>Register_Object Witemkat_DD
51601>>>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>>>
51601>>>>>>>>>>>>>>>>>    //AB-StoreTopStart
51601>>>>>>>>>>>>>>>>>    open clients
51603>>>>>>>>>>>>>>>>>    use sl17.sl
51603>>>>>>>>>>>>>>>>>    //AB-StoreTopEnd
51603>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
51603>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
51603>>>>>>>>>>>>>>>>>    Use Txtbox.Sub
51603>>>>>>>>>>>>>>>>>    Use Form.Sub
51603>>>>>>>>>>>>>>>>>    Use Rgroup.Sub
51603>>>>>>>>>>>>>>>>>    Use Radio.Sub
51603>>>>>>>>>>>>>>>>>    Use Button.Sub
51603>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>    Use WITEMKAT.DD
51603>>>>>>>>>>>>>>>>>    Use UNITS.DD
51603>>>>>>>>>>>>>>>>>    Use FPA.DD
51603>>>>>>>>>>>>>>>>>    Use ITEM.DD
51603>>>>>>>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
51603>>>>>>>>>>>>>>>>>>>//DDB-FileStart
51603>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
51603>>>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>>>// File Name : WITEMCL.DD
51603>>>>>>>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
51603>>>>>>>>>>>>>>>>>>>// Revision  : 16
51603>>>>>>>>>>>>>>>>>>>// Version   : 2
51603>>>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
51603>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51603>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51603>>>>>>>>>>>>>>>>>>>
51603>>>>>>>>>>>>>>>>>>>Open Witemcl
51605>>>>>>>>>>>>>>>>>>>Open Witemcld
51607>>>>>>>>>>>>>>>>>>>Open Item
51609>>>>>>>>>>>>>>>>>>>Open Sysrecw
51611>>>>>>>>>>>>>>>>>>>
51611>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
51611>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
51611>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
51611>>>>>>>>>>>>>>>>>>>Register_Object SL100
51611>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
51611>>>>>>>>>>>>>>>>>>>
51611>>>>>>>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
51612>>>>>>>>>>>>>>>>>>> 
51612>>>>>>>>>>>>>>>>>>>    // Update:
51612>>>>>>>>>>>>>>>>>>> 
51612>>>>>>>>>>>>>>>>>>>    Procedure Update
51613>>>>>>>>>>>>>>>>>>>        Forward Send Update  
51615>>>>>>>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
51616>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
51617>>>>>>>>>>>>>>>>>>> 
51617>>>>>>>>>>>>>>>>>>>
51617>>>>>>>>>>>>>>>>>>>    // Define_Fields:
51617>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51617>>>>>>>>>>>>>>>>>>>
51617>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
51618>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
51620>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51620>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
51620>>>>>>>>>>>>>>>>>>>
51620>>>>>>>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
51621>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51622>>>>>>>>>>>>>>>>>>>
51622>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51623>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51624>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51625>>>>>>>>>>>>>>>>>>>
51625>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
51625>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
51626>>>>>>>>>>>>>>>>>>>
51626>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
51626>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
51627>>>>>>>>>>>>>>>>>>>
51627>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
51627>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51628>>>>>>>>>>>>>>>>>>>
51628>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
51631>>>>>>>>>>>>>>>>>>>
51631>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
51631>>>>>>>>>>>>>>>>>>>
51631>>>>>>>>>>>>>>>>>>>        // Witemcl.Item_Code
51631>>>>>>>>>>>>>>>>>>>
51631>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Code
51631>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
51632>>>>>>>>>>>>>>>>>>>
51632>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
51632>>>>>>>>>>>>>>>>>>>
51632>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Date
51632>>>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
51633>>>>>>>>>>>>>>>>>>>
51633>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Price
51633>>>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
51634>>>>>>>>>>>>>>>>>>>
51634>>>>>>>>>>>>>>>>>>>        // Witemcl.Item_Descr
51634>>>>>>>>>>>>>>>>>>>
51634>>>>>>>>>>>>>>>>>>>        // Witemcl.Rec0
51634>>>>>>>>>>>>>>>>>>>
51634>>>>>>>>>>>>>>>>>>>        // Witemcl.Is_Client
51634>>>>>>>>>>>>>>>>>>>
51634>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
51634>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
51635>>>>>>>>>>>>>>>>>>>
51635>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
51635>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
51635>>>>>>>>>>>>>>>>>>>
51635>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
51636>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
51638>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51638>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
51638>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
51638>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
51639>>>>>>>>>>>>>>>>>>>
51639>>>>>>>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
51640>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
51640>>>>>>>>>>>>>>>>>>>
51640>>>>>>>>>>>>>>>>>>>Use sl100.sl         // SL100
51640>>>>>>>>>>>>>>>>>>>
51640>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
51640>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
51640>>>>>>>>>>>>>>>>>    
51640>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
51640>>>>>>>>>>>>>>>>>
51640>>>>>>>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
51642>>>>>>>>>>>>>>>>>
51642>>>>>>>>>>>>>>>>>        //AB-StoreTopStart
51642>>>>>>>>>>>>>>>>>        Function fsclient string code Returns string
51644>>>>>>>>>>>>>>>>>            string name
51645>>>>>>>>>>>>>>>>>            clear clients
51646>>>>>>>>>>>>>>>>>            move code to clients.client_id
51647>>>>>>>>>>>>>>>>>            find eq clients by index.6
51648>>>>>>>>>>>>>>>>>>
51648>>>>>>>>>>>>>>>>>            move clients.client_name to name
51649>>>>>>>>>>>>>>>>>            function_return name
51650>>>>>>>>>>>>>>>>>        end_Function
51651>>>>>>>>>>>>>>>>>        
51651>>>>>>>>>>>>>>>>>        Property String     pscode                  ''
51653>>>>>>>>>>>>>>>>>        Property String     psperi                  ''
51655>>>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
51657>>>>>>>>>>>>>>>>>        Property String     pscodeprom              ''
51659>>>>>>>>>>>>>>>>>        
51659>>>>>>>>>>>>>>>>>        
51659>>>>>>>>>>>>>>>>>        //AB-StoreTopEnd
51659>>>>>>>>>>>>>>>>>
51659>>>>>>>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
51660>>>>>>>>>>>>>>>>>        Set Size to 289 527
51661>>>>>>>>>>>>>>>>>        Set Location to 0 2
51662>>>>>>>>>>>>>>>>>
51662>>>>>>>>>>>>>>>>>        //AB-DDOStart
51662>>>>>>>>>>>>>>>>>
51662>>>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51664>>>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
51665>>>>>>>>>>>>>>>>>
51665>>>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
51667>>>>>>>>>>>>>>>>>        End_Object    // Units_DD
51668>>>>>>>>>>>>>>>>>
51668>>>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
51670>>>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
51671>>>>>>>>>>>>>>>>>
51671>>>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
51673>>>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
51674>>>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
51675>>>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
51676>>>>>>>>>>>>>>>>>        End_Object    // Item_DD
51677>>>>>>>>>>>>>>>>>
51677>>>>>>>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
51679>>>>>>>>>>>>>>>>>
51679>>>>>>>>>>>>>>>>>            //AB-StoreTopStart
51679>>>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
51681>>>>>>>>>>>>>>>>>                       String lsperi lscode  lscodeprom
51682>>>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
51682>>>>>>>>>>>>>>>>>                       Move 0 to rVal
51683>>>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
51684>>>>>>>>>>>>>>>>>                       Get psperi to lsperi
51685>>>>>>>>>>>>>>>>>                       Get pscode to lscode
51686>>>>>>>>>>>>>>>>>                       Get pscodeprom to lscodeprom
51687>>>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51688>>>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51689>>>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
51689>>>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
51691>>>>>>>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
51693>>>>>>>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
51696>>>>>>>>>>>>>>>>>                           End
51696>>>>>>>>>>>>>>>>>>
51696>>>>>>>>>>>>>>>>>            
51696>>>>>>>>>>>>>>>>>                       End
51696>>>>>>>>>>>>>>>>>>
51696>>>>>>>>>>>>>>>>>                       Else Begin
51697>>>>>>>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
51699>>>>>>>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
51702>>>>>>>>>>>>>>>>>                           End
51702>>>>>>>>>>>>>>>>>>
51702>>>>>>>>>>>>>>>>>            
51702>>>>>>>>>>>>>>>>>                       End
51702>>>>>>>>>>>>>>>>>>
51702>>>>>>>>>>>>>>>>>                       Function_Return rVal
51703>>>>>>>>>>>>>>>>>                   End_Function
51704>>>>>>>>>>>>>>>>>            
51704>>>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
51706>>>>>>>>>>>>>>>>>                       String lsperi
51707>>>>>>>>>>>>>>>>>                       Get psperi to lsperi
51708>>>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51709>>>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
51710>>>>>>>>>>>>>>>>>                   End_Function
51711>>>>>>>>>>>>>>>>>            
51711>>>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
51713>>>>>>>>>>>>>>>>>                       String lscode lscodeprom
51714>>>>>>>>>>>>>>>>>                       Get pscode to lscode
51715>>>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51716>>>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
51717>>>>>>>>>>>>>>>>>                   End_Function
51718>>>>>>>>>>>>>>>>>            
51718>>>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51718>>>>>>>>>>>>>>>>>
51718>>>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
51719>>>>>>>>>>>>>>>>>
51719>>>>>>>>>>>>>>>>>            //AB-StoreStart
51719>>>>>>>>>>>>>>>>>                                                                
51719>>>>>>>>>>>>>>>>>                                                                
51719>>>>>>>>>>>>>>>>>            Begin_Constraints
51721>>>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
51722>>>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
51722>>>>>>>>>>>>>>>>>                   Get psperi  to lsperi
51723>>>>>>>>>>>>>>>>>                   Get pscode  to lscode
51724>>>>>>>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
51725>>>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
51726>>>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
51727>>>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
51728>>>>>>>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
51729>>>>>>>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
51732>>>>>>>>>>>>>>>>>                   Else Begin
51733>>>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
51735>>>>>>>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
51739>>>>>>>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
51744>>>>>>>>>>>>>>>>>                      End
51744>>>>>>>>>>>>>>>>>>
51744>>>>>>>>>>>>>>>>>                   Else Begin
51745>>>>>>>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
51748>>>>>>>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
51752>>>>>>>>>>>>>>>>>                       End
51752>>>>>>>>>>>>>>>>>>
51752>>>>>>>>>>>>>>>>>                   End
51752>>>>>>>>>>>>>>>>>>
51752>>>>>>>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
51756>>>>>>>>>>>>>>>>>            
51756>>>>>>>>>>>>>>>>>            End_Constraints
51759>>>>>>>>>>>>>>>>>            
51759>>>>>>>>>>>>>>>>>            
51759>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51759>>>>>>>>>>>>>>>>>
51759>>>>>>>>>>>>>>>>>        End_Object    // Witemcl_DD
51760>>>>>>>>>>>>>>>>>
51760>>>>>>>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
51761>>>>>>>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
51762>>>>>>>>>>>>>>>>>
51762>>>>>>>>>>>>>>>>>        //AB-DDOEnd
51762>>>>>>>>>>>>>>>>>
51762>>>>>>>>>>>>>>>>>        Object The_Table is a dbGrid
51764>>>>>>>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
51765>>>>>>>>>>>>>>>>>            Set Size to 201 519
51766>>>>>>>>>>>>>>>>>            Set Location to 3 2
51767>>>>>>>>>>>>>>>>>            Set Color to 14280447
51768>>>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
51769>>>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
51770>>>>>>>>>>>>>>>>>            Set Wrap_State to TRUE
51771>>>>>>>>>>>>>>>>>
51771>>>>>>>>>>>>>>>>>            Begin_Row
51774>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_code
51775>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
51776>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
51777>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_code
51778>>>>>>>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
51779>>>>>>>>>>>>>>>>>            End_Row
51784>>>>>>>>>>>>>>>>>
51784>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 100
51785>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
51786>>>>>>>>>>>>>>>>>            
51786>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 100
51787>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
51788>>>>>>>>>>>>>>>>>            
51788>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 200
51789>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
51790>>>>>>>>>>>>>>>>>            
51790>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 0
51791>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to ""
51792>>>>>>>>>>>>>>>>>            
51792>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 111
51793>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
51794>>>>>>>>>>>>>>>>>            
51794>>>>>>>>>>>>>>>>>
51794>>>>>>>>>>>>>>>>>            //AB-StoreStart
51794>>>>>>>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
51795>>>>>>>>>>>>>>>>>            //set read_only_state to true
51795>>>>>>>>>>>>>>>>>            set no_create_state to true
51796>>>>>>>>>>>>>>>>>            set no_delete_state to true
51797>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51797>>>>>>>>>>>>>>>>>
51797>>>>>>>>>>>>>>>>>        End_Object    // The_Table
51798>>>>>>>>>>>>>>>>>
51798>>>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
51800>>>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
51801>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51802>>>>>>>>>>>>>>>>>            Set Location to 208 5
51803>>>>>>>>>>>>>>>>>            Set Size to 13 78
51804>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
51805>>>>>>>>>>>>>>>>>
51805>>>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
51807>>>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
51808>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51809>>>>>>>>>>>>>>>>>            Set Location to 223 5
51810>>>>>>>>>>>>>>>>>            Set Size to 13 83
51811>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
51812>>>>>>>>>>>>>>>>>
51812>>>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
51814>>>>>>>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
51815>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51816>>>>>>>>>>>>>>>>>            Set Location to 237 5
51817>>>>>>>>>>>>>>>>>            Set Size to 13 78
51818>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
51819>>>>>>>>>>>>>>>>>
51819>>>>>>>>>>>>>>>>>        Object ocode is a FormSub
51821>>>>>>>>>>>>>>>>>            Set Size to 13 197
51822>>>>>>>>>>>>>>>>>            Set Location to 209 91
51823>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51824>>>>>>>>>>>>>>>>>
51824>>>>>>>>>>>>>>>>>            //AB-StoreStart
51824>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
51824>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51826>>>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
51827>>>>>>>>>>>>>>>>>            End_Procedure
51828>>>>>>>>>>>>>>>>>            
51828>>>>>>>>>>>>>>>>>            
51828>>>>>>>>>>>>>>>>>            
51828>>>>>>>>>>>>>>>>>            
51828>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51828>>>>>>>>>>>>>>>>>
51828>>>>>>>>>>>>>>>>>        End_Object    // ocode
51829>>>>>>>>>>>>>>>>>
51829>>>>>>>>>>>>>>>>>        Object operi is a FormSub
51831>>>>>>>>>>>>>>>>>            Set Size to 13 197
51832>>>>>>>>>>>>>>>>>            Set Location to 223 91
51833>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51834>>>>>>>>>>>>>>>>>
51834>>>>>>>>>>>>>>>>>            //AB-StoreStart
51834>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
51834>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51836>>>>>>>>>>>>>>>>>              Send KeyAction to ButtonSub1
51837>>>>>>>>>>>>>>>>>            End_Procedure
51838>>>>>>>>>>>>>>>>>            
51838>>>>>>>>>>>>>>>>>            
51838>>>>>>>>>>>>>>>>>            
51838>>>>>>>>>>>>>>>>>            
51838>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51838>>>>>>>>>>>>>>>>>
51838>>>>>>>>>>>>>>>>>        End_Object    // operi
51839>>>>>>>>>>>>>>>>>
51839>>>>>>>>>>>>>>>>>        Object ocodeprom is a FormSub
51841>>>>>>>>>>>>>>>>>            Set Size to 13 197
51842>>>>>>>>>>>>>>>>>            Set Location to 238 91
51843>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51844>>>>>>>>>>>>>>>>>
51844>>>>>>>>>>>>>>>>>            //AB-StoreStart
51844>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
51844>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51846>>>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51847>>>>>>>>>>>>>>>>>            End_Procedure
51848>>>>>>>>>>>>>>>>>            
51848>>>>>>>>>>>>>>>>>            
51848>>>>>>>>>>>>>>>>>            
51848>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51848>>>>>>>>>>>>>>>>>
51848>>>>>>>>>>>>>>>>>        End_Object    // ocodeprom
51849>>>>>>>>>>>>>>>>>
51849>>>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
51851>>>>>>>>>>>>>>>>>            Set Size to 32 77
51852>>>>>>>>>>>>>>>>>            Set Location to 209 296
51853>>>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
51855>>>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
51856>>>>>>>>>>>>>>>>>                Set Size to 10 53
51857>>>>>>>>>>>>>>>>>                Set Location to 7 5
51858>>>>>>>>>>>>>>>>>            End_Object    // Radio1
51859>>>>>>>>>>>>>>>>>
51859>>>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
51861>>>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
51862>>>>>>>>>>>>>>>>>                Set Size to 10 51
51863>>>>>>>>>>>>>>>>>                Set Location to 21 5
51864>>>>>>>>>>>>>>>>>            End_Object    // Radio2
51865>>>>>>>>>>>>>>>>>
51865>>>>>>>>>>>>>>>>>
51865>>>>>>>>>>>>>>>>>            //AB-StoreStart
51865>>>>>>>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
51865>>>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
51867>>>>>>>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
51867>>>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
51868>>>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51869>>>>>>>>>>>>>>>>>            End_Procedure
51870>>>>>>>>>>>>>>>>>            
51870>>>>>>>>>>>>>>>>>            // If you set Current_radio you must set this after the
51870>>>>>>>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
51870>>>>>>>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
51870>>>>>>>>>>>>>>>>>            //Set Current_Radio to 0
51870>>>>>>>>>>>>>>>>>            
51870>>>>>>>>>>>>>>>>>            
51870>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51870>>>>>>>>>>>>>>>>>
51870>>>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
51871>>>>>>>>>>>>>>>>>
51871>>>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
51873>>>>>>>>>>>>>>>>>            Set Label to "Search"
51874>>>>>>>>>>>>>>>>>            Set Size to 28 37
51875>>>>>>>>>>>>>>>>>            Set Location to 210 413
51876>>>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
51877>>>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
51878>>>>>>>>>>>>>>>>>
51878>>>>>>>>>>>>>>>>>            //AB-StoreStart
51878>>>>>>>>>>>>>>>>>                                        
51878>>>>>>>>>>>>>>>>>            Set Visible_State to False
51879>>>>>>>>>>>>>>>>>            
51879>>>>>>>>>>>>>>>>>            Procedure OnClick
51881>>>>>>>>>>>>>>>>>                Forward Send OnClick
51883>>>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
51884>>>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
51885>>>>>>>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
51886>>>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
51887>>>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
51888>>>>>>>>>>>>>>>>>            End_Procedure // OnClick
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            
51889>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51889>>>>>>>>>>>>>>>>>
51889>>>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
51890>>>>>>>>>>>>>>>>>
51890>>>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
51892>>>>>>>>>>>>>>>>>
51892>>>>>>>>>>>>>>>>>            //AB-StoreTopStart
51892>>>>>>>>>>>>>>>>>                                                                                    
51892>>>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51892>>>>>>>>>>>>>>>>>
51892>>>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
51893>>>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
51894>>>>>>>>>>>>>>>>>            Set Size to 22 25
51895>>>>>>>>>>>>>>>>>            Set Location to 214 482
51896>>>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
51897>>>>>>>>>>>>>>>>>
51897>>>>>>>>>>>>>>>>>            //AB-StoreStart
51897>>>>>>>>>>>>>>>>>                                                                                    
51897>>>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
51898>>>>>>>>>>>>>>>>>            
51898>>>>>>>>>>>>>>>>>            Procedure OnClick
51900>>>>>>>>>>>>>>>>>                String  scode speri
51901>>>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
51902>>>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
51903>>>>>>>>>>>>>>>>>                set pscode of (sl17(self)) to scode
51904>>>>>>>>>>>>>>>>>                set psperi of (sl17(self)) to speri
51905>>>>>>>>>>>>>>>>>                send request_cancel to dg186
51906>>>>>>>>>>>>>>>>>            End_Procedure // OnClick
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            
51907>>>>>>>>>>>>>>>>>            //AB-StoreEnd
51907>>>>>>>>>>>>>>>>>
51907>>>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
51908>>>>>>>>>>>>>>>>>
51908>>>>>>>>>>>>>>>>>
51908>>>>>>>>>>>>>>>>>        //AB-StoreStart
51908>>>>>>>>>>>>>>>>>        Procedure Activating
51910>>>>>>>>>>>>>>>>>           integer rval
51911>>>>>>>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
51912>>>>>>>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
51913>>>>>>>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
51914>>>>>>>>>>>>>>>>>           Forward send Activating
51916>>>>>>>>>>>>>>>>>        
51916>>>>>>>>>>>>>>>>>        End_Procedure
51917>>>>>>>>>>>>>>>>>        
51917>>>>>>>>>>>>>>>>>        
51917>>>>>>>>>>>>>>>>>        
51917>>>>>>>>>>>>>>>>>        
51917>>>>>>>>>>>>>>>>>        
51917>>>>>>>>>>>>>>>>>        
51917>>>>>>>>>>>>>>>>>        //AB-StoreEnd
51917>>>>>>>>>>>>>>>>>
51917>>>>>>>>>>>>>>>>>    End_Object    // dg186
51918>>>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>>>    //AB-StoreStart
51918>>>>>>>>>>>>>>>>>        
51918>>>>>>>>>>>>>>>>>    //AB-StoreEnd
51918>>>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
51918>>>>>>>>>>>>>>>    //AB-StoreTopEnd
51918>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>    //AB-IgnoreStart
51918>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
51918>>>>>>>>>>>>>>>    Use dbList.Sub
51918>>>>>>>>>>>>>>>    Use Txtbox.Sub
51918>>>>>>>>>>>>>>>    Use Form.Sub
51918>>>>>>>>>>>>>>>    Use Rgroup.Sub
51918>>>>>>>>>>>>>>>    Use Radio.Sub
51918>>>>>>>>>>>>>>>    Use Button.Sub
51918>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>    Use UNITS.DD
51918>>>>>>>>>>>>>>>    Use WITEMKAT.DD
51918>>>>>>>>>>>>>>>    Use FPA.DD
51918>>>>>>>>>>>>>>>    Use ITEM.DD
51918>>>>>>>>>>>>>>>    Use WITEMX.DD
51918>>>>>>>>>>>>>>>    
51918>>>>>>>>>>>>>>>    //AB-IgnoreEnd
51918>>>>>>>>>>>>>>>
51918>>>>>>>>>>>>>>>    Object SL17 is a dbModalPanelSub
51920>>>>>>>>>>>>>>>
51920>>>>>>>>>>>>>>>        //AB-StoreTopStart
51920>>>>>>>>>>>>>>>                
51920>>>>>>>>>>>>>>>        Property String     pscode                  ''
51922>>>>>>>>>>>>>>>        Property String     psperi                  ''
51924>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
51926>>>>>>>>>>>>>>>        Property String     pscodekat               ''
51928>>>>>>>>>>>>>>>        
51928>>>>>>>>>>>>>>>        //AB-StoreTopEnd
51928>>>>>>>>>>>>>>>
51928>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
51929>>>>>>>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
51930>>>>>>>>>>>>>>>        Set Size to 266 484
51931>>>>>>>>>>>>>>>        Set Location to 9 14
51932>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
51933>>>>>>>>>>>>>>>        Set Modal_State to FALSE
51934>>>>>>>>>>>>>>>
51934>>>>>>>>>>>>>>>        //AB-DDOStart
51934>>>>>>>>>>>>>>>
51934>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
51936>>>>>>>>>>>>>>>        End_Object    // Units_DD
51937>>>>>>>>>>>>>>>
51937>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51939>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
51940>>>>>>>>>>>>>>>
51940>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
51942>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
51943>>>>>>>>>>>>>>>
51943>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
51945>>>>>>>>>>>>>>>
51945>>>>>>>>>>>>>>>            //AB-StoreTopStart
51945>>>>>>>>>>>>>>>                                                                                                    
51945>>>>>>>>>>>>>>>                                                                                                    
51945>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51945>>>>>>>>>>>>>>>
51945>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
51946>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
51947>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
51948>>>>>>>>>>>>>>>
51948>>>>>>>>>>>>>>>            //AB-StoreStart
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>                                                                                                    
51948>>>>>>>>>>>>>>>            //AB-StoreEnd
51948>>>>>>>>>>>>>>>
51948>>>>>>>>>>>>>>>        End_Object    // Item_DD
51949>>>>>>>>>>>>>>>
51949>>>>>>>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
51951>>>>>>>>>>>>>>>
51951>>>>>>>>>>>>>>>            //AB-StoreTopStart
51951>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
51953>>>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
51954>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
51954>>>>>>>>>>>>>>>                       Move 0 to rVal
51955>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
51956>>>>>>>>>>>>>>>                       Get psperi to lsperi
51957>>>>>>>>>>>>>>>                       Get pscode to lscode
51958>>>>>>>>>>>>>>>                       Get pscodekat to lscodekat
51959>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51960>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51961>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
51963>>>>>>>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
51965>>>>>>>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
51968>>>>>>>>>>>>>>>                           End
51968>>>>>>>>>>>>>>>>
51968>>>>>>>>>>>>>>>                       End
51968>>>>>>>>>>>>>>>>
51968>>>>>>>>>>>>>>>                       Else Begin
51969>>>>>>>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
51971>>>>>>>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
51974>>>>>>>>>>>>>>>                           End
51974>>>>>>>>>>>>>>>>
51974>>>>>>>>>>>>>>>                       End
51974>>>>>>>>>>>>>>>>
51974>>>>>>>>>>>>>>>                       Function_Return rVal
51975>>>>>>>>>>>>>>>                   End_Function
51976>>>>>>>>>>>>>>>            
51976>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
51978>>>>>>>>>>>>>>>                       String lsperi
51979>>>>>>>>>>>>>>>                       Get psperi to lsperi
51980>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51981>>>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
51982>>>>>>>>>>>>>>>                   End_Function
51983>>>>>>>>>>>>>>>            
51983>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
51985>>>>>>>>>>>>>>>                       String lscode lscodekat
51986>>>>>>>>>>>>>>>                       Get pscode to lscode
51987>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51988>>>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
51989>>>>>>>>>>>>>>>                   End_Function
51990>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51990>>>>>>>>>>>>>>>
51990>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
51991>>>>>>>>>>>>>>>
51991>>>>>>>>>>>>>>>            //AB-StoreStart
51991>>>>>>>>>>>>>>>                                                                                
51991>>>>>>>>>>>>>>>            Begin_Constraints
51993>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
51994>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
51994>>>>>>>>>>>>>>>               Get psperi               to lsperi
51995>>>>>>>>>>>>>>>               Get pscode               to lscode
51996>>>>>>>>>>>>>>>               Get pscodekat            to lscodekat
51997>>>>>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
51998>>>>>>>>>>>>>>>               Move (Trim(lsperi))      to lsperi
51999>>>>>>>>>>>>>>>               Move (Trim(lscode))      to lscode
52000>>>>>>>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
52001>>>>>>>>>>>>>>>               Set Ordering to 4
52002>>>>>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
52004>>>>>>>>>>>>>>>                    Set Ordering to 4
52005>>>>>>>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
52006>>>>>>>>>>>>>>>               End
52006>>>>>>>>>>>>>>>>
52006>>>>>>>>>>>>>>>               Else Begin
52007>>>>>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
52009>>>>>>>>>>>>>>>                        If (lsperi<>'') Begin
52011>>>>>>>>>>>>>>>                            Set Ordering to 3
52012>>>>>>>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
52014>>>>>>>>>>>>>>>                        End
52014>>>>>>>>>>>>>>>>
52014>>>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
52017>>>>>>>>>>>>>>>                            Set Ordering to 4
52018>>>>>>>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
52020>>>>>>>>>>>>>>>                        End
52020>>>>>>>>>>>>>>>>
52020>>>>>>>>>>>>>>>                  End
52020>>>>>>>>>>>>>>>>
52020>>>>>>>>>>>>>>>                  Else Begin
52021>>>>>>>>>>>>>>>                        If (lsperi<>'') Begin
52023>>>>>>>>>>>>>>>                            Set Ordering to 3
52024>>>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
52025>>>>>>>>>>>>>>>                        End
52025>>>>>>>>>>>>>>>>
52025>>>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
52028>>>>>>>>>>>>>>>                            Set Ordering to 4
52029>>>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
52030>>>>>>>>>>>>>>>                        End
52030>>>>>>>>>>>>>>>>
52030>>>>>>>>>>>>>>>                  End
52030>>>>>>>>>>>>>>>>
52030>>>>>>>>>>>>>>>                  If (lscodekat<>'') Begin
52032>>>>>>>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
52034>>>>>>>>>>>>>>>                  End
52034>>>>>>>>>>>>>>>>
52034>>>>>>>>>>>>>>>               End
52034>>>>>>>>>>>>>>>>
52034>>>>>>>>>>>>>>>            End_Constraints
52037>>>>>>>>>>>>>>>            
52037>>>>>>>>>>>>>>>            
52037>>>>>>>>>>>>>>>            //AB-StoreEnd
52037>>>>>>>>>>>>>>>
52037>>>>>>>>>>>>>>>        End_Object    // Witemx_DD
52038>>>>>>>>>>>>>>>
52038>>>>>>>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
52039>>>>>>>>>>>>>>>        Set Server to (Witemx_DD(self))
52040>>>>>>>>>>>>>>>
52040>>>>>>>>>>>>>>>        //AB-DDOEnd
52040>>>>>>>>>>>>>>>
52040>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
52042>>>>>>>>>>>>>>>            Set Main_File to Witemx.File_Number
52043>>>>>>>>>>>>>>>            Set Ordering to 5
52044>>>>>>>>>>>>>>>            Set Size to 190 475
52045>>>>>>>>>>>>>>>            Set Location to 1 1
52046>>>>>>>>>>>>>>>            Set Color to 14280447
52047>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
52048>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
52049>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
52050>>>>>>>>>>>>>>>
52050>>>>>>>>>>>>>>>            Begin_Row
52053>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_code
52054>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_descr
52055>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemkat_code
52056>>>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
52057>>>>>>>>>>>>>>>                Entry_Item Item.Item_qual
52058>>>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
52059>>>>>>>>>>>>>>>            End_Row
52064>>>>>>>>>>>>>>>
52064>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
52065>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
52066>>>>>>>>>>>>>>>            
52066>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
52067>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
52068>>>>>>>>>>>>>>>            
52068>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
52069>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
52070>>>>>>>>>>>>>>>            
52070>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
52071>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
52072>>>>>>>>>>>>>>>            
52072>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
52073>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
52074>>>>>>>>>>>>>>>            
52074>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
52075>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
52076>>>>>>>>>>>>>>>            
52076>>>>>>>>>>>>>>>
52076>>>>>>>>>>>>>>>            //AB-StoreStart
52076>>>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
52078>>>>>>>>>>>>>>>            set export_item_state to true
52079>>>>>>>>>>>>>>>            
52079>>>>>>>>>>>>>>>            Procedure End_Construct_Object
52081>>>>>>>>>>>>>>>                Forward Send End_Construct_Object
52083>>>>>>>>>>>>>>>                Set Color               to 14280447
52084>>>>>>>>>>>>>>>                Set CurrentRowColor     to 11783679
52085>>>>>>>>>>>>>>>                Set CurrentCellColor    to 11783679
52086>>>>>>>>>>>>>>>            End_Procedure
52087>>>>>>>>>>>>>>>            
52087>>>>>>>>>>>>>>>            Procedure Activating Returns Integer
52089>>>>>>>>>>>>>>>                Integer rVal
52090>>>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
52092>>>>>>>>>>>>>>>                set auto_index_state to true
52093>>>>>>>>>>>>>>>                Procedure_Return rVal
52094>>>>>>>>>>>>>>>            End_Procedure
52095>>>>>>>>>>>>>>>            
52095>>>>>>>>>>>>>>>            procedure move_value_out
52097>>>>>>>>>>>>>>>                forward send move_value_out
52099>>>>>>>>>>>>>>>                set value of (ocode(self)) to ''
52100>>>>>>>>>>>>>>>                set value of (operi(self)) to ''
52101>>>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
52102>>>>>>>>>>>>>>>                set psperi to ''
52103>>>>>>>>>>>>>>>                set pscode to ''
52104>>>>>>>>>>>>>>>                set pscodekat to ''
52105>>>>>>>>>>>>>>>            end_procedure
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>>>            //AB-StoreEnd
52106>>>>>>>>>>>>>>>
52106>>>>>>>>>>>>>>>        End_Object    // oSelList
52107>>>>>>>>>>>>>>>
52107>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
52109>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
52110>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
52111>>>>>>>>>>>>>>>            Set Location to 192 6
52112>>>>>>>>>>>>>>>            Set Size to 13 69
52113>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
52114>>>>>>>>>>>>>>>
52114>>>>>>>>>>>>>>>        Object ocode is a FormSub
52116>>>>>>>>>>>>>>>            Set Size to 13 197
52117>>>>>>>>>>>>>>>            Set Location to 192 79
52118>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
52119>>>>>>>>>>>>>>>
52119>>>>>>>>>>>>>>>            //AB-StoreStart
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            
52119>>>>>>>>>>>>>>>            //AB-StoreEnd
52119>>>>>>>>>>>>>>>
52119>>>>>>>>>>>>>>>        End_Object    // ocode
52120>>>>>>>>>>>>>>>
52120>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
52122>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
52123>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
52124>>>>>>>>>>>>>>>            Set Location to 207 6
52125>>>>>>>>>>>>>>>            Set Size to 13 71
52126>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
52127>>>>>>>>>>>>>>>
52127>>>>>>>>>>>>>>>        Object operi is a FormSub
52129>>>>>>>>>>>>>>>            Set Size to 13 197
52130>>>>>>>>>>>>>>>            Set Location to 207 79
52131>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
52132>>>>>>>>>>>>>>>
52132>>>>>>>>>>>>>>>            //AB-StoreStart
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            
52132>>>>>>>>>>>>>>>            //AB-StoreEnd
52132>>>>>>>>>>>>>>>
52132>>>>>>>>>>>>>>>        End_Object    // operi
52133>>>>>>>>>>>>>>>
52133>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
52135>>>>>>>>>>>>>>>            Set Size to 32 77
52136>>>>>>>>>>>>>>>            Set Location to 191 279
52137>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
52139>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
52140>>>>>>>>>>>>>>>                Set Size to 10 53
52141>>>>>>>>>>>>>>>                Set Location to 7 5
52142>>>>>>>>>>>>>>>            End_Object    // Radio1
52143>>>>>>>>>>>>>>>
52143>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
52145>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
52146>>>>>>>>>>>>>>>                Set Size to 10 52
52147>>>>>>>>>>>>>>>                Set Location to 21 5
52148>>>>>>>>>>>>>>>            End_Object    // Radio2
52149>>>>>>>>>>>>>>>
52149>>>>>>>>>>>>>>>
52149>>>>>>>>>>>>>>>            //AB-StoreStart
52149>>>>>>>>>>>>>>>            
52149>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
52151>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
52152>>>>>>>>>>>>>>>            End_Procedure
52153>>>>>>>>>>>>>>>            
52153>>>>>>>>>>>>>>>            
52153>>>>>>>>>>>>>>>            
52153>>>>>>>>>>>>>>>            
52153>>>>>>>>>>>>>>>            
52153>>>>>>>>>>>>>>>            //AB-StoreEnd
52153>>>>>>>>>>>>>>>
52153>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
52154>>>>>>>>>>>>>>>
52154>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
52156>>>>>>>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
52157>>>>>>>>>>>>>>>            Set Size to 15 197
52158>>>>>>>>>>>>>>>            Set Location to 236 79
52159>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
52160>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
52161>>>>>>>>>>>>>>>
52161>>>>>>>>>>>>>>>            //AB-StoreStart
52161>>>>>>>>>>>>>>>            
52161>>>>>>>>>>>>>>>            Procedure OnClick
52163>>>>>>>>>>>>>>>                Forward Send OnClick
52165>>>>>>>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
52166>>>>>>>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
52167>>>>>>>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
52168>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
52169>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
52170>>>>>>>>>>>>>>>            End_Procedure // OnClick
52171>>>>>>>>>>>>>>>            
52171>>>>>>>>>>>>>>>            
52171>>>>>>>>>>>>>>>            //AB-StoreEnd
52171>>>>>>>>>>>>>>>
52171>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
52172>>>>>>>>>>>>>>>
52172>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
52174>>>>>>>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
52175>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
52176>>>>>>>>>>>>>>>            Set Location to 221 5
52177>>>>>>>>>>>>>>>            Set Size to 13 70
52178>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
52179>>>>>>>>>>>>>>>
52179>>>>>>>>>>>>>>>        Object ocodekat is a FormSub
52181>>>>>>>>>>>>>>>            Set Size to 13 197
52182>>>>>>>>>>>>>>>            Set Location to 221 79
52183>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
52184>>>>>>>>>>>>>>>
52184>>>>>>>>>>>>>>>            //AB-StoreStart
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            
52184>>>>>>>>>>>>>>>            //AB-StoreEnd
52184>>>>>>>>>>>>>>>
52184>>>>>>>>>>>>>>>        End_Object    // ocodekat
52185>>>>>>>>>>>>>>>
52185>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
52187>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
52188>>>>>>>>>>>>>>>            Set Location to 232 318
52189>>>>>>>>>>>>>>>
52189>>>>>>>>>>>>>>>            //AB-StoreStart
52189>>>>>>>>>>>>>>>            Procedure OnClick
52191>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
52192>>>>>>>>>>>>>>>            End_Procedure
52193>>>>>>>>>>>>>>>            //AB-StoreEnd
52193>>>>>>>>>>>>>>>
52193>>>>>>>>>>>>>>>        End_Object    // oOK_bn
52194>>>>>>>>>>>>>>>
52194>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
52196>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
52197>>>>>>>>>>>>>>>            Set Location to 232 373
52198>>>>>>>>>>>>>>>
52198>>>>>>>>>>>>>>>            //AB-StoreStart
52198>>>>>>>>>>>>>>>            Procedure OnClick
52200>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
52201>>>>>>>>>>>>>>>            End_Procedure
52202>>>>>>>>>>>>>>>            //AB-StoreEnd
52202>>>>>>>>>>>>>>>
52202>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
52203>>>>>>>>>>>>>>>
52203>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
52205>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
52206>>>>>>>>>>>>>>>            Set Location to 232 428
52207>>>>>>>>>>>>>>>
52207>>>>>>>>>>>>>>>            //AB-StoreStart
52207>>>>>>>>>>>>>>>            Procedure OnClick
52209>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
52210>>>>>>>>>>>>>>>            End_Procedure
52211>>>>>>>>>>>>>>>            //AB-StoreEnd
52211>>>>>>>>>>>>>>>
52211>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
52212>>>>>>>>>>>>>>>
52212>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
52214>>>>>>>>>>>>>>>
52214>>>>>>>>>>>>>>>            //AB-StoreTopStart
52214>>>>>>>>>>>>>>>            
52214>>>>>>>>>>>>>>>            //AB-StoreTopEnd
52214>>>>>>>>>>>>>>>
52214>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
52215>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
52216>>>>>>>>>>>>>>>            Set Size to 22 25
52217>>>>>>>>>>>>>>>            Set Location to 196 443
52218>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
52219>>>>>>>>>>>>>>>
52219>>>>>>>>>>>>>>>            //AB-StoreStart
52219>>>>>>>>>>>>>>>            
52219>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
52220>>>>>>>>>>>>>>>            
52220>>>>>>>>>>>>>>>            Procedure OnClick
52222>>>>>>>>>>>>>>>                String  scode speri
52223>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
52224>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
52225>>>>>>>>>>>>>>>                set pscode of (dg186(self)) to scode
52226>>>>>>>>>>>>>>>                set psperi of (dg186(self)) to speri
52227>>>>>>>>>>>>>>>               Send popup_modal to (dg186(self))
52228>>>>>>>>>>>>>>>            End_Procedure // OnClick
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            
52229>>>>>>>>>>>>>>>            //AB-StoreEnd
52229>>>>>>>>>>>>>>>
52229>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
52230>>>>>>>>>>>>>>>
52230>>>>>>>>>>>>>>>
52230>>>>>>>>>>>>>>>        //AB-StoreStart
52230>>>>>>>>>>>>>>>                
52230>>>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
52231>>>>>>>>>>>>>>>        
52231>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
52232>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
52233>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
52234>>>>>>>>>>>>>>>        
52234>>>>>>>>>>>>>>>        Procedure Activate
52236>>>>>>>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
52237>>>>>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
52238>>>>>>>>>>>>>>>            Forward Send Activate
52240>>>>>>>>>>>>>>>        End_Procedure
52241>>>>>>>>>>>>>>>        
52241>>>>>>>>>>>>>>>        procedure request_cancel
52243>>>>>>>>>>>>>>>            forward send request_cancel
52245>>>>>>>>>>>>>>>            set value of (ocode(self)) to ''
52246>>>>>>>>>>>>>>>            set value of (operi(self)) to ''
52247>>>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
52248>>>>>>>>>>>>>>>            Set psperi  to ''
52249>>>>>>>>>>>>>>>            Set pscode  to ''
52250>>>>>>>>>>>>>>>            Set pscodekat TO ''
52251>>>>>>>>>>>>>>>        end_procedure
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        
52252>>>>>>>>>>>>>>>        //AB-StoreEnd
52252>>>>>>>>>>>>>>>
52252>>>>>>>>>>>>>>>    End_Object    // SL17
52253>>>>>>>>>>>>>>>
52253>>>>>>>>>>>>>>>
52253>>>>>>>>>>>>>>>    //AB-StoreStart
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    
52253>>>>>>>>>>>>>>>    //AB-StoreEnd
52253>>>>>>>>>>>>>>>
52253>>>>>>>>>>>>>>>//AB/     End_Object    // prj
52253>>>>>>>>>>>>>
52253>>>>>>>>>>>>>//DDB-Selection-pkg-End
52253>>>>>>>>>>>>>//DDB-FileEnd
52253>>>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
52253>>>>>>>>>>>>>//DDB-FileStart
52253>>>>>>>>>>>>>//DDB-HeaderStart
52253>>>>>>>>>>>>>
52253>>>>>>>>>>>>>// File Name : PMOVES.DD
52253>>>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
52253>>>>>>>>>>>>>// Revision  : 157
52253>>>>>>>>>>>>>// Version   : 2
52253>>>>>>>>>>>>>
52253>>>>>>>>>>>>>Use  Windows           // Basic Definitions
52253>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
52253>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52253>>>>>>>>>>>>>
52253>>>>>>>>>>>>>Open Pmoves
52255>>>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
52257>>>>>>>>>>>>>Open Pmssxet
52259>>>>>>>>>>>>>Open Wax
52261>>>>>>>>>>>>>Open Witemx
52263>>>>>>>>>>>>>Open Particle
52265>>>>>>>>>>>>>Open Sysrecp
52267>>>>>>>>>>>>>Open Syscurxr
52269>>>>>>>>>>>>>Open Partlfpa
52271>>>>>>>>>>>>>Open Clorder
52273>>>>>>>>>>>>>Open Clorderd
52275>>>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
52277>>>>>>>>>>>>>Open Gmove
52279>>>>>>>>>>>>>Open Sysrecg
52281>>>>>>>>>>>>>
52281>>>>>>>>>>>>>//DDB-HeaderEnd
52281>>>>>>>>>>>>>Open Fpa
52283>>>>>>>>>>>>>Open PartlFpa
52285>>>>>>>>>>>>>Open Item
52287>>>>>>>>>>>>>Open Wtypkin
52289>>>>>>>>>>>>>Open Witemkat
52291>>>>>>>>>>>>>Open Wapomast
52293>>>>>>>>>>>>>Open Wapokat
52295>>>>>>>>>>>>>Open Payresp
52297>>>>>>>>>>>>>
52297>>>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
52298>>>>>>>>>>>>>
52298>>>>>>>>>>>>>
52298>>>>>>>>>>>>>    Procedure Construct_Object
52299>>>>>>>>>>>>>        Forward Send Construct_Object
52301>>>>>>>>>>>>>        Property Number  pnoQty         Public  0
52302>>>>>>>>>>>>>        Property integer pifromclorder  Public  0
52303>>>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
52304>>>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
52305>>>>>>>>>>>>>        Property integer piFromMetasx   Public  0
52306>>>>>>>>>>>>>        Property String  psOldItem      Public ''        
52307>>>>>>>>>>>>>        //------------------------------------------------
52307>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
52307>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
52307>>>>>>>>>>>>>        // einai 1     js 03/12/2007
52307>>>>>>>>>>>>>        //------------------------------------------------  
52307>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
52308>>>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
52309>>>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
52310>>>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
52311>>>>>>>>>>>>>        Property String  psAud_Old_Poiothta     Public ""
52312>>>>>>>>>>>>>        Property String  psAud_Old_Eidos        Public ""
52313>>>>>>>>>>>>>
52313>>>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
52314>>>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
52315>>>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
52316>>>>>>>>>>>>>
52316>>>>>>>>>>>>>        Property Number  pnAud_Old_Qty          Public  0
52317>>>>>>>>>>>>>        Property Number  pnAud_Old_Timh         Public  0
52318>>>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
52319>>>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
52320>>>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
52321>>>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
52322>>>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
52323>>>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
52324>>>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0
52325>>>>>>>>>>>>>        //------------------------------------------------
52325>>>>>>>>>>>>>    End_Procedure
52326>>>>>>>>>>>>>
52326>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
52327>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
52329>>>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
52330>>>>>>>>>>>>>        Set psOldItem   to Item.Item_Code           
52331>>>>>>>>>>>>>        //------------------------------------------------
52331>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
52331>>>>>>>>>>>>>        // ton pedion js 03/12/2007
52331>>>>>>>>>>>>>        //------------------------------------------------
52331>>>>>>>>>>>>>        Set psAud_Old_Pelaths       to Pmoves.Client_ID
52332>>>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
52333>>>>>>>>>>>>>        Set psAud_Old_Ergo          to Pmoves.CN_Code
52334>>>>>>>>>>>>>        Set psAud_Old_Eidos         to Pmoves.Witemx_Code   
52335>>>>>>>>>>>>>        Set psAud_Old_Poiothta      to Item.Item_Qual 
52336>>>>>>>>>>>>>        Set pnAud_Old_Qty           to Pmoves.Pms_Qty 
52337>>>>>>>>>>>>>        Set pnAud_Old_Timh          to Pmoves.Pms_UnitPrice 
52338>>>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Pmoves.Partl_Recr 
52339>>>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Pmoves.Pms_Recr 
52340>>>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
52341>>>>>>>>>>>>>        Set psAud_Old_Zonh          to Pmoves.Zone
52342>>>>>>>>>>>>>        Set psAud_Old_Antlia        to Pmoves.Pump_ID
52343>>>>>>>>>>>>>        Set psAud_Old_Oxhma         to Pmoves.Car_ID
52344>>>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
52345>>>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
52346>>>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
52347>>>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No
52348>>>>>>>>>>>>>        //------------------------------------------------
52348>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
52349>>>>>>>>>>>>>
52349>>>>>>>>>>>>>
52349>>>>>>>>>>>>>    // Delete_Main_File:
52349>>>>>>>>>>>>>    Procedure Delete_Main_File
52350>>>>>>>>>>>>>        clear btnemp
52351>>>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
52352>>>>>>>>>>>>>        find ge btnemp by index.11
52353>>>>>>>>>>>>>>
52353>>>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
52355>>>>>>>>>>>>>           move 0 to btnemp.pms_recr
52356>>>>>>>>>>>>>           saverecord btnemp
52357>>>>>>>>>>>>>        end                             
52357>>>>>>>>>>>>>>
52357>>>>>>>>>>>>>
52357>>>>>>>>>>>>>        //---------------------------------------------
52357>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
52357>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52357>>>>>>>>>>>>>            //MODE_WAITING  
52357>>>>>>>>>>>>>            //MODE_FINDING  
52357>>>>>>>>>>>>>            //MODE_CLEARING 
52357>>>>>>>>>>>>>            //MODE_CREATING 
52357>>>>>>>>>>>>>            //MODE_SAVING   
52357>>>>>>>>>>>>>            //MODE_DELETING 
52357>>>>>>>>>>>>>            //MODE_ABORTING 
52357>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
52358>>>>>>>>>>>>>        Date    dDate  Shmer 
52358>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
52358>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
52362>>>>>>>>>>>>>        Move iHour  to sHour
52363>>>>>>>>>>>>>        Move iMin   to sMin
52364>>>>>>>>>>>>>        Move iSec   to sSec
52365>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52369>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52373>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52377>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52378>>>>>>>>>>>>>        
52378>>>>>>>>>>>>>        // Auditing / Diagrafh - Diorthosh
52378>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING)) Begin
52380>>>>>>>>>>>>>            Get fsLoginUserID to sUser
52381>>>>>>>>>>>>>
52381>>>>>>>>>>>>>            clear gmove
52382>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
52383>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
52384>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
52385>>>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
52386>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
52387>>>>>>>>>>>>>            move pmoves.partl_no        to gmove.garticl_no
52388>>>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
52389>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
52390>>>>>>>>>>>>>            move pmoves.pms_recr        to gmove.garticl_recr
52391>>>>>>>>>>>>>            reread sysrecg
52395>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52396>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52397>>>>>>>>>>>>>            saverecord sysrecg
52398>>>>>>>>>>>>>            unlock
52399>>>>>>>>>>>>>>
52399>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
52400>>>>>>>>>>>>>
52400>>>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
52401>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
52402>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
52403>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
52404>>>>>>>>>>>>>            Move (psAud_Old_Pelaths (Self))     to Gmove.Prev_ID
52405>>>>>>>>>>>>>            Move (psAud_Old_PelathsN(Self))     to Gmove.Prev_Name
52406>>>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
52407>>>>>>>>>>>>>            Move (psAud_Old_Eidos    (Self))    to Gmove.Prev_Item
52408>>>>>>>>>>>>>            Move (psAud_Old_Poiothta (Self))    to Gmove.Prev_Qual 
52409>>>>>>>>>>>>>            Move (pnAud_Old_Qty      (Self))    to Gmove.Prev_M3 
52410>>>>>>>>>>>>>            Move (pnAud_Old_Timh     (Self))    to Gmove.Prev_UnitPrice
52411>>>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
52412>>>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
52413>>>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
52414>>>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
52415>>>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
52416>>>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
52417>>>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
52418>>>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
52419>>>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
52420>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã š¨˜££ãª  ˜¨˜©«˜« ¡¦ç)" to sText
52421>>>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
52422>>>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
52423>>>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
52424>>>>>>>>>>>>>            saverecord gmove
52425>>>>>>>>>>>>>        End
52425>>>>>>>>>>>>>>
52425>>>>>>>>>>>>>
52425>>>>>>>>>>>>>        Forward Send Delete_Main_File
52427>>>>>>>>>>>>>        // Insert Code Here
52427>>>>>>>>>>>>>    End_Procedure   // Delete_Main_File
52428>>>>>>>>>>>>>                      
52428>>>>>>>>>>>>>
52428>>>>>>>>>>>>>    Procedure Save_Main_File
52429>>>>>>>>>>>>>        Integer iYes
52430>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
52432>>>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
52435>>>>>>>>>>>>>        End
52435>>>>>>>>>>>>>>
52435>>>>>>>>>>>>>
52435>>>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
52437>>>>>>>>>>>>>            // Elegxos FPA
52437>>>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
52437>>>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
52439>>>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
52440>>>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
52443>>>>>>>>>>>>>            End
52443>>>>>>>>>>>>>>
52443>>>>>>>>>>>>>        End
52443>>>>>>>>>>>>>>
52443>>>>>>>>>>>>>        Forward Send Save_Main_File
52445>>>>>>>>>>>>>    End_Procedure
52446>>>>>>>>>>>>>
52446>>>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
52447>>>>>>>>>>>>>        Number  rVal nQty
52448>>>>>>>>>>>>>        String  sClientID sWitemxCode
52448>>>>>>>>>>>>>        Date    dHmnia
52448>>>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
52448>>>>>>>>>>>>>
52448>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
52449>>>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
52451>>>>>>>>>>>>>            // 1=€š¦¨œª
52451>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52452>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52453>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52454>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52455>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
52456>>>>>>>>>>>>>            // Sto arxeio Globals.inc
52456>>>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
52457>>>>>>>>>>>>>        End
52457>>>>>>>>>>>>>>
52457>>>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
52460>>>>>>>>>>>>>            // 2=à¢ã©œ ª
52460>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52461>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52462>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52463>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
52464>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52465>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
52466>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
52467>>>>>>>>>>>>>            // Sto arxeio Globals.inc
52467>>>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
52468>>>>>>>>>>>>>        End
52468>>>>>>>>>>>>>>
52468>>>>>>>>>>>>>        Function_Return rVal
52469>>>>>>>>>>>>>    End_Function
52470>>>>>>>>>>>>>
52470>>>>>>>>>>>>>    Procedure Creating
52471>>>>>>>>>>>>>        Forward Send Creating
52473>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
52474>>>>>>>>>>>>>        Set piCreateNew to 1
52475>>>>>>>>>>>>>    End_Procedure   // Creating
52476>>>>>>>>>>>>>
52476>>>>>>>>>>>>>    Procedure Update
52477>>>>>>>>>>>>>        Integer iDecimals
52478>>>>>>>>>>>>>        Number  nInt nFpaOnTotal
52478>>>>>>>>>>>>>        String  sCurrentUser
52478>>>>>>>>>>>>>
52478>>>>>>>>>>>>>        Forward Send Update
52480>>>>>>>>>>>>>
52480>>>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
52481>>>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
52482>>>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
52483>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
52484>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
52485>>>>>>>>>>>>>
52485>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
52486>>>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
52487>>>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
52488>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
52489>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
52490>>>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
52491>>>>>>>>>>>>>
52491>>>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
52491>>>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
52492>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
52493>>>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
52494>>>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
52495>>>>>>>>>>>>>
52495>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
52496>>>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
52497>>>>>>>>>>>>>
52497>>>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
52498>>>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
52499>>>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
52500>>>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
52501>>>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
52502>>>>>>>>>>>>>
52502>>>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
52503>>>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
52504>>>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
52505>>>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
52506>>>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
52507>>>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
52508>>>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
52509>>>>>>>>>>>>>
52509>>>>>>>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
52512>>>>>>>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
52515>>>>>>>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
52518>>>>>>>>>>>>>
52518>>>>>>>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
52518>>>>>>>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
52518>>>>>>>>>>>>>
52518>>>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
52519>>>>>>>>>>>>>
52519>>>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
52520>>>>>>>>>>>>>
52520>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
52521>>>>>>>>>>>>>
52521>>>>>>>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
52524>>>>>>>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
52526>>>>>>>>>>>>>
52526>>>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
52527>>>>>>>>>>>>>
52527>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
52528>>>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
52529>>>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
52530>>>>>>>>>>>>>
52530>>>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
52531>>>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
52532>>>>>>>>>>>>>
52532>>>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
52533>>>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
52534>>>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
52535>>>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
52536>>>>>>>>>>>>>
52536>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52536>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52536>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
52536>>>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
52536>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
52536>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52538>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52538>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52538>>>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
52538>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52538>>>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
52538>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
52538>>>>>>>>>>>>>
52538>>>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
52539>>>>>>>>>>>>>
52539>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52541>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52542>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52543>>>>>>>>>>>>>            End
52543>>>>>>>>>>>>>>
52543>>>>>>>>>>>>>            Else Begin
52544>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52545>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52546>>>>>>>>>>>>>            End
52546>>>>>>>>>>>>>>
52546>>>>>>>>>>>>>        End
52546>>>>>>>>>>>>>>
52546>>>>>>>>>>>>>
52546>>>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
52547>>>>>>>>>>>>>
52547>>>>>>>>>>>>>
52547>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52547>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52547>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52547>>>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
52548>>>>>>>>>>>>>
52548>>>>>>>>>>>>>        Clear PartlFpa
52549>>>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52550>>>>>>>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
52551>>>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52552>>>>>>>>>>>>>>
52552>>>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
52553>>>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
52554>>>>>>>>>>>>>        Saverecord PartlFpa
52555>>>>>>>>>>>>>
52555>>>>>>>>>>>>>        Move 0 to nFpaOnTotal
52556>>>>>>>>>>>>>        Clear PartlFpa
52557>>>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52558>>>>>>>>>>>>>        Find Gt PartlFpa By Index.1
52559>>>>>>>>>>>>>>
52559>>>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52563>>>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52564>>>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52565>>>>>>>>>>>>>            Saverecord PartlFpa
52566>>>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52567>>>>>>>>>>>>>            Find Gt PartlFpa By Index.1
52568>>>>>>>>>>>>>>
52568>>>>>>>>>>>>>        Loop
52569>>>>>>>>>>>>>>
52569>>>>>>>>>>>>>
52569>>>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
52570>>>>>>>>>>>>>
52570>>>>>>>>>>>>>
52570>>>>>>>>>>>>>        //---------------------------------------------
52570>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
52570>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52570>>>>>>>>>>>>>            //MODE_WAITING  
52570>>>>>>>>>>>>>            //MODE_FINDING  
52570>>>>>>>>>>>>>            //MODE_CLEARING 
52570>>>>>>>>>>>>>            //MODE_CREATING 
52570>>>>>>>>>>>>>            //MODE_SAVING   
52570>>>>>>>>>>>>>            //MODE_DELETING 
52570>>>>>>>>>>>>>            //MODE_ABORTING 
52570>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
52570>>>>>>>>>>>>>        Date    dDate  Shmer 
52570>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
52570>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
52574>>>>>>>>>>>>>        Move iHour  to sHour
52575>>>>>>>>>>>>>        Move iMin   to sMin
52576>>>>>>>>>>>>>        Move iSec   to sSec
52577>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52581>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52585>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52589>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52590>>>>>>>>>>>>>        
52590>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
52590>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
52592>>>>>>>>>>>>>            Get fsLoginUserID to sUser
52593>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
52595>>>>>>>>>>>>>                clear gmove
52596>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
52597>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
52598>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
52599>>>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
52600>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
52601>>>>>>>>>>>>>                move pmoves.partl_no        to gmove.garticl_no
52602>>>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
52603>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
52604>>>>>>>>>>>>>                move pmoves.pms_recr        to gmove.garticl_recr
52605>>>>>>>>>>>>>                reread sysrecg
52609>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52610>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52611>>>>>>>>>>>>>                saverecord sysrecg
52612>>>>>>>>>>>>>                unlock
52613>>>>>>>>>>>>>>
52613>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
52614>>>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
52615>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
52616>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
52617>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
52618>>>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
52619>>>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
52620>>>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
52621>>>>>>>>>>>>>                Move Item.Item_Code                 to Gmove.Cur_Item
52622>>>>>>>>>>>>>                Move Item.Item_Qual                 to Gmove.Cur_Qual 
52623>>>>>>>>>>>>>                Move Pmoves.Pms_Qty                 to Gmove.Cur_M3 
52624>>>>>>>>>>>>>                Move Pmoves.Pms_UnitPrice           to Gmove.Cur_UnitPrice
52625>>>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
52626>>>>>>>>>>>>>                Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
52627>>>>>>>>>>>>>                
52627>>>>>>>>>>>>>                Move Pmoves.Zone                    to Gmove.Cur_Zonh
52628>>>>>>>>>>>>>                Move Pmoves.Pump_ID                 to Gmove.Cur_Antlia
52629>>>>>>>>>>>>>                Move Pmoves.Car_ID                  to Gmove.Cur_Oxhma       
52630>>>>>>>>>>>>>                
52630>>>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
52631>>>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
52632>>>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
52633>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ š¨˜££ãª §˜¨˜©«˜« ¡¦ç)" to sText
52634>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
52635>>>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
52636>>>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
52637>>>>>>>>>>>>>                saverecord gmove
52638>>>>>>>>>>>>>                Set piCreateNew to 0
52639>>>>>>>>>>>>>            End
52639>>>>>>>>>>>>>>
52639>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1)) Begin                                
52642>>>>>>>>>>>>>                Integer isChanged
52642>>>>>>>>>>>>>                Move 0 to isChanged
52643>>>>>>>>>>>>>                
52643>>>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths(Self))<>Trim(Clients.Client_ID    ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Pmoves.CN_Code      ))) Move 1 to isChanged    
52646>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Eidos  (Self))<>Trim(Item.Item_Code       ))   Or  (Trim(psAud_Old_Poiothta(Self))<>Trim(Item.Item_Qual      ))) Move 1 to isChanged   
52650>>>>>>>>>>>>>                Else If ((pnAud_Old_Qty         (Self) <>Pmoves.Pms_Qty             )   Or  (pnAud_Old_Timh         (Self) <>Pmoves.Pms_UnitPrice      )) Move 1 to isChanged   
52654>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh   (Self))<>Trim(Pmoves.Zone          ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Pmoves.Pump_ID      ))) Move 1 to isChanged   
52658>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma  (Self))<>Trim(Pmoves.Car_ID        ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
52662>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira  (Self))<>Trim(Particle.Pseira_Seira))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
52666>>>>>>>>>>>>>                Else If  (piAud_Old_No          (Self) <>Particle.Partl_No)                                                                               Move 1 to isChanged
52670>>>>>>>>>>>>>
52670>>>>>>>>>>>>>                If (isChanged>0) Begin  
52672>>>>>>>>>>>>>                    clear gmove
52673>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
52674>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
52675>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
52676>>>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
52677>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
52678>>>>>>>>>>>>>                    move pmoves.partl_no        to gmove.garticl_no
52679>>>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
52680>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
52681>>>>>>>>>>>>>                    move pmoves.pms_recr        to gmove.garticl_recr
52682>>>>>>>>>>>>>                    reread sysrecg
52686>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52687>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52688>>>>>>>>>>>>>                    saverecord sysrecg
52689>>>>>>>>>>>>>                    unlock
52690>>>>>>>>>>>>>>
52690>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
52691>>>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
52692>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
52693>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
52694>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
52695>>>>>>>>>>>>>                    //--
52695>>>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
52696>>>>>>>>>>>>>                    Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
52697>>>>>>>>>>>>>                    //--
52697>>>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
52698>>>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
52699>>>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
52700>>>>>>>>>>>>>                    Move (Trim(Item.Item_Code       ))  to Gmove.Cur_Item
52701>>>>>>>>>>>>>                    Move (Trim(Item.Item_Qual       ))  to Gmove.Cur_Qual 
52702>>>>>>>>>>>>>                    Move       Pmoves.Pms_Qty           to Gmove.Cur_M3 
52703>>>>>>>>>>>>>                    Move       Pmoves.Pms_UnitPrice     to Gmove.Cur_UnitPrice
52704>>>>>>>>>>>>>
52704>>>>>>>>>>>>>                    Move (Trim(Pmoves.Zone          ))  to Gmove.Cur_Zonh
52705>>>>>>>>>>>>>                    Move (Trim(Pmoves.Pump_ID       ))  to Gmove.Cur_Antlia
52706>>>>>>>>>>>>>                    Move (Trim(Pmoves.Car_ID        ))  to Gmove.Cur_Oxhma       
52707>>>>>>>>>>>>>
52707>>>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
52708>>>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
52709>>>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
52710>>>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No
52711>>>>>>>>>>>>>                    //--
52711>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
52712>>>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
52713>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
52714>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Eidos   (Self))) to Gmove.Prev_Item
52715>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Poiothta(Self))) to Gmove.Prev_Qual 
52716>>>>>>>>>>>>>                    Move      (pnAud_Old_Qty     (Self )) to Gmove.Prev_M3 
52717>>>>>>>>>>>>>                    Move      (pnAud_Old_Timh    (Self )) to Gmove.Prev_UnitPrice
52718>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
52719>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
52720>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
52721>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
52722>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
52723>>>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
52724>>>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
52725>>>>>>>>>>>>>                    //--
52725>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž š¨˜££ãª ˜¨˜©«˜« ¡¦ç)" to sText 
52726>>>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
52727>>>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
52728>>>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
52729>>>>>>>>>>>>>                    saverecord gmove
52730>>>>>>>>>>>>>                    Set piCreateNew to 0
52731>>>>>>>>>>>>>                End
52731>>>>>>>>>>>>>>
52731>>>>>>>>>>>>>            End
52731>>>>>>>>>>>>>>
52731>>>>>>>>>>>>>        End
52731>>>>>>>>>>>>>>
52731>>>>>>>>>>>>>    End_Procedure   // Update
52732>>>>>>>>>>>>>
52732>>>>>>>>>>>>>    // Backout:
52732>>>>>>>>>>>>>    Procedure Backout
52733>>>>>>>>>>>>>        Number nFpaOnTotal
52734>>>>>>>>>>>>>        Forward Send Backout
52736>>>>>>>>>>>>>
52736>>>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
52737>>>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
52738>>>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
52739>>>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
52740>>>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
52741>>>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
52742>>>>>>>>>>>>>
52742>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52742>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52742>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
52742>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
52742>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52744>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52744>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52744>>>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
52744>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52744>>>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
52744>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
52744>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52746>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52747>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52748>>>>>>>>>>>>>            End
52748>>>>>>>>>>>>>>
52748>>>>>>>>>>>>>            Else Begin
52749>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52750>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52751>>>>>>>>>>>>>            End
52751>>>>>>>>>>>>>>
52751>>>>>>>>>>>>>        End
52751>>>>>>>>>>>>>>
52751>>>>>>>>>>>>>
52751>>>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
52752>>>>>>>>>>>>>
52752>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52752>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52752>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52752>>>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
52753>>>>>>>>>>>>>
52753>>>>>>>>>>>>>        Clear PartlFpa
52754>>>>>>>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
52755>>>>>>>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
52756>>>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52757>>>>>>>>>>>>>>
52757>>>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
52758>>>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
52759>>>>>>>>>>>>>        Saverecord PartlFpa
52760>>>>>>>>>>>>>
52760>>>>>>>>>>>>>        Move 0 to nFpaOnTotal
52761>>>>>>>>>>>>>        Clear PartlFpa
52762>>>>>>>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
52763>>>>>>>>>>>>>        Find Gt PartlFpa By Index.1
52764>>>>>>>>>>>>>>
52764>>>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52768>>>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52769>>>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52770>>>>>>>>>>>>>            Saverecord PartlFpa
52771>>>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52772>>>>>>>>>>>>>            Find Gt PartlFpa By Index.1
52773>>>>>>>>>>>>>>
52773>>>>>>>>>>>>>        Loop
52774>>>>>>>>>>>>>>
52774>>>>>>>>>>>>>
52774>>>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total     
52775>>>>>>>>>>>>>        
52775>>>>>>>>>>>>>    End_Procedure   // Backout
52776>>>>>>>>>>>>>
52776>>>>>>>>>>>>>
52776>>>>>>>>>>>>>
52776>>>>>>>>>>>>>
52776>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
52777>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
52780>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
52784>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
52788>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
52792>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
52796>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
52800>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
52804>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
52808>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
52812>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
52816>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52820>>>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
52824>>>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
52828>>>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52832>>>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52836>>>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52840>>>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52844>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
52848>>>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
52852>>>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
52856>>>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
52860>>>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52864>>>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52868>>>>>>>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52872>>>>>>>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
52876>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
52879>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
52880>>>>>>>>>>>>>
52880>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
52881>>>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
52882>>>>>>>>>>>>>        Number  nInt nqty nQtyKin
52882>>>>>>>>>>>>>        String  sUserID sOldUserID sOldItem
52882>>>>>>>>>>>>>
52882>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
52884>>>>>>>>>>>>>
52884>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
52886>>>>>>>>>>>>>
52886>>>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52886>>>>>>>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
52886>>>>>>>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
52886>>>>>>>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
52886>>>>>>>>>>>>>
52886>>>>>>>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
52886>>>>>>>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
52886>>>>>>>>>>>>>//                Clear Fpa
52886>>>>>>>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
52886>>>>>>>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
52886>>>>>>>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
52886>>>>>>>>>>>>>//                If (iFpaRecnum) Begin
52886>>>>>>>>>>>>>//                    Clear Fpa
52886>>>>>>>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
52886>>>>>>>>>>>>>//                    Find Eq Fpa.Recnum
52886>>>>>>>>>>>>>//                End
52886>>>>>>>>>>>>>//            End
52886>>>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52886>>>>>>>>>>>>>
52886>>>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
52889>>>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
52893>>>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
52897>>>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
52901>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
52905>>>>>>>>>>>>>            Else Begin
52906>>>>>>>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
52906>>>>>>>>>>>>>                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
52909>>>>>>>>>>>>>                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
52913>>>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
52913>>>>>>>>>>>>>
52913>>>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52913>>>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
52913>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52913>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
52913>>>>>>>>>>>>>//                    End
52913>>>>>>>>>>>>>//                End
52913>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
52913>>>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
52913>>>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
52913>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52913>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
52913>>>>>>>>>>>>>//                End
52913>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
52913>>>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
52913>>>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
52913>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52913>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
52913>>>>>>>>>>>>>//                End
52913>>>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
52916>>>>>>>>>>>>>                    get pnoqty to nqty
52917>>>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
52920>>>>>>>>>>>>>                End
52920>>>>>>>>>>>>>>
52920>>>>>>>>>>>>>
52920>>>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
52923>>>>>>>>>>>>>                    // js 28/08/2002
52923>>>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
52923>>>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
52923>>>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
52923>>>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
52923>>>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
52923>>>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
52923>>>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
52925>>>>>>>>>>>>>                        get pnoqty to nqty
52926>>>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
52929>>>>>>>>>>>>>                        // js 22/12/2003
52929>>>>>>>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
52929>>>>>>>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
52929>>>>>>>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
52929>>>>>>>>>>>>>                        Get psOldItem to sOldItem
52930>>>>>>>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
52933>>>>>>>>>>>>>                    End
52933>>>>>>>>>>>>>>
52933>>>>>>>>>>>>>                End
52933>>>>>>>>>>>>>>
52933>>>>>>>>>>>>>            End
52933>>>>>>>>>>>>>>
52933>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52936>>>>>>>>>>>>>        End
52936>>>>>>>>>>>>>>
52936>>>>>>>>>>>>>        Function_Return iReturnVal
52937>>>>>>>>>>>>>    End_Function   // Validate_Save
52938>>>>>>>>>>>>>
52938>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
52939>>>>>>>>>>>>>        Integer iReturnVal
52940>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
52942>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
52944>>>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
52947>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
52951>>>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
52955>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52958>>>>>>>>>>>>>        End
52958>>>>>>>>>>>>>>
52958>>>>>>>>>>>>>        Function_Return iReturnVal
52959>>>>>>>>>>>>>    End_Function   // Validate_Delete
52960>>>>>>>>>>>>>
52960>>>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
52961>>>>>>>>>>>>>        Local Integer   Changed
52962>>>>>>>>>>>>>        Local Number    nInt
52962>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
52963>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
52965>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
52966>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
52967>>>>>>>>>>>>>        End
52967>>>>>>>>>>>>>>
52967>>>>>>>>>>>>>    End_Procedure   // Shmera
52968>>>>>>>>>>>>>
52968>>>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
52969>>>>>>>>>>>>>        Local Integer Changed
52970>>>>>>>>>>>>>        Local Number nInt
52970>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
52971>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
52973>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
52974>>>>>>>>>>>>>            If (nInt<0) Begin
52976>>>>>>>>>>>>>                Move (nInt*(-1)) to nInt
52977>>>>>>>>>>>>>                Set Field_Default_Value iField to nInt
52978>>>>>>>>>>>>>            End
52978>>>>>>>>>>>>>>
52978>>>>>>>>>>>>>        End
52978>>>>>>>>>>>>>>
52978>>>>>>>>>>>>>    End_Procedure   // Shmera
52979>>>>>>>>>>>>>
52979>>>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
52980>>>>>>>>>>>>>        Local Integer Changed
52981>>>>>>>>>>>>>        Local Number nInt
52981>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
52982>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
52984>>>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
52985>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
52986>>>>>>>>>>>>>        End
52986>>>>>>>>>>>>>>
52986>>>>>>>>>>>>>    End_Procedure   // Shmera
52987>>>>>>>>>>>>>
52987>>>>>>>>>>>>>    // Define_Fields:
52987>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
52987>>>>>>>>>>>>>
52987>>>>>>>>>>>>>    Procedure Define_Fields
52988>>>>>>>>>>>>>        Forward Send Define_Fields
52990>>>>>>>>>>>>>        //DDB-Generated-Code-Location
52990>>>>>>>>>>>>>        //DDB-DefineFieldStart
52990>>>>>>>>>>>>>
52990>>>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
52991>>>>>>>>>>>>>
52991>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
52992>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
52993>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52994>>>>>>>>>>>>>
52994>>>>>>>>>>>>>        // Child (Client) file structure................
52994>>>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
52995>>>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
52996>>>>>>>>>>>>>
52996>>>>>>>>>>>>>        // Parent (Server) file structure...............
52996>>>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
52997>>>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
52998>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
52999>>>>>>>>>>>>>
52999>>>>>>>>>>>>>        // External (System) file structure.............
52999>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
53000>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
53001>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
53002>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
53003>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
53004>>>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
53005>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
53006>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
53007>>>>>>>>>>>>>
53007>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Field-based properties.......................
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Company_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Branch_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Year_Year
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Ctypkin_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Wtypkin_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Custprom_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Client_Id
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Cn_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Ptyppar_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Partl_Hmnia
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Pseira_Seira
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Partl_No
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Partl_Rec0
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Witemkat_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Units_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Item_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Witemx_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Wapokat_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Wapomast_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Wax_Code
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Wax_Recr
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Witemx_Recr
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Partl_Recr
53010>>>>>>>>>>>>>
53010>>>>>>>>>>>>>        // Pmoves.Pms_Rec0
53010>>>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
53011>>>>>>>>>>>>>
53011>>>>>>>>>>>>>        // Pmoves.Pms_No
53011>>>>>>>>>>>>>
53011>>>>>>>>>>>>>        // Pmoves.Pms_Recr
53011>>>>>>>>>>>>>
53011>>>>>>>>>>>>>        // Pmoves.Pms_Unitcode
53011>>>>>>>>>>>>>
53011>>>>>>>>>>>>>        // Pmoves.Pms_Qty
53011>>>>>>>>>>>>>
53011>>>>>>>>>>>>>        // Pmoves.Pms_Unitprice
53011>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
53012>>>>>>>>>>>>>
53012>>>>>>>>>>>>>        // Pmoves.Pms_Ambd
53012>>>>>>>>>>>>>
53012>>>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
53012>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
53013>>>>>>>>>>>>>
53013>>>>>>>>>>>>>        // Pmoves.Pms_Discam
53013>>>>>>>>>>>>>
53013>>>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
53013>>>>>>>>>>>>>
53013>>>>>>>>>>>>>        // Pmoves.Pms_Vatpct
53013>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Vatam
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Exrampct
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Exdet
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Payable
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Axia
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_X0
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_P0
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_X00
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_P00
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_X1
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_P1
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_X2
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_P2
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Dlixis
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_A_Code
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Status_E
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Status_A
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_S0
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Ys0
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_S1
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Ys1
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_S2
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Ys2
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Open
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Aopen
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_M_Code
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Kk
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_C_Code2
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Module
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Btnl2_Recr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Btnemp_Recr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Btarticle_Recr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Sls_Id
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Presp_Id
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Cnt_Id
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Mhxanik_Id
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Extra_Epimer
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Clorderd_Recr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Witemx_Descr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Timol_Qty
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Timol_Ypol
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Qty_Ypol
53014>>>>>>>>>>>>>
53014>>>>>>>>>>>>>        // Pmoves.Pms_Selected
53014>>>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Sx_Parast
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Sx_Hmnia
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Sx_Seira
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Sx_Arithmos
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Pump_Id
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Car_Id
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Item_Ypot
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Qty_Return
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Client_Name
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        // Pmoves.Zone
53015>>>>>>>>>>>>>
53015>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53015>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53016>>>>>>>>>>>>>
53016>>>>>>>>>>>>>    // Field_Defaults:
53016>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53016>>>>>>>>>>>>>
53016>>>>>>>>>>>>>    Procedure Field_Defaults
53017>>>>>>>>>>>>>        Forward Send Field_Defaults
53019>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53019>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53019>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53019>>>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
53019>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53020>>>>>>>>>>>>>
53020>>>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
53021>>>>>>>>>>>>>//DDB-FileEnd
53021>>>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
53021>>>>>>>>>>>>>//DDB-FileStart
53021>>>>>>>>>>>>>//DDB-HeaderStart
53021>>>>>>>>>>>>>
53021>>>>>>>>>>>>>// File Name : PmsDtl.DD
53021>>>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
53021>>>>>>>>>>>>>// Revision  : 0
53021>>>>>>>>>>>>>// Version   : 2
53021>>>>>>>>>>>>>
53021>>>>>>>>>>>>>Use  Windows           // Basic Definitions
53021>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53021>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53021>>>>>>>>>>>>>
53021>>>>>>>>>>>>>Open Pmsdtl
53023>>>>>>>>>>>>>Open Pmoves
53025>>>>>>>>>>>>>
53025>>>>>>>>>>>>>//DDB-HeaderEnd
53025>>>>>>>>>>>>>
53025>>>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
53026>>>>>>>>>>>>>
53026>>>>>>>>>>>>>    // Define_Fields:
53026>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53026>>>>>>>>>>>>>
53026>>>>>>>>>>>>>    Procedure Define_Fields
53027>>>>>>>>>>>>>        Forward Send Define_Fields
53029>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53029>>>>>>>>>>>>>        //DDB-DefineFieldStart
53029>>>>>>>>>>>>>
53029>>>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
53030>>>>>>>>>>>>>
53030>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53031>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53032>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53033>>>>>>>>>>>>>
53033>>>>>>>>>>>>>        // Parent (Server) file structure...............
53033>>>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
53034>>>>>>>>>>>>>
53034>>>>>>>>>>>>>        // Field-based properties.......................
53034>>>>>>>>>>>>>
53034>>>>>>>>>>>>>        // Pmsdtl.Pms_Recr
53034>>>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
53035>>>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
53036>>>>>>>>>>>>>
53036>>>>>>>>>>>>>        // Pmsdtl.Line1
53036>>>>>>>>>>>>>
53036>>>>>>>>>>>>>        // Pmsdtl.Line2
53036>>>>>>>>>>>>>
53036>>>>>>>>>>>>>        // Pmsdtl.Line3
53036>>>>>>>>>>>>>
53036>>>>>>>>>>>>>        // Pmsdtl.Line4
53036>>>>>>>>>>>>>
53036>>>>>>>>>>>>>        // Pmsdtl.Line5
53036>>>>>>>>>>>>>
53036>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53036>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53037>>>>>>>>>>>>>
53037>>>>>>>>>>>>>    // Field_Defaults:
53037>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53037>>>>>>>>>>>>>
53037>>>>>>>>>>>>>    Procedure Field_Defaults
53038>>>>>>>>>>>>>        Forward Send Field_Defaults
53040>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53040>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53040>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53040>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53041>>>>>>>>>>>>>
53041>>>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
53042>>>>>>>>>>>>>//DDB-FileEnd
53042>>>>>>>>>>>    Use BAXIOKAT.DD
53042>>>>>>>>>>>    Use SYSCURXR.DD
53042>>>>>>>>>>>    Use PMSSXET.DD
53042>>>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
53042>>>>>>>>>>>>>//DDB-FileStart
53042>>>>>>>>>>>>>//DDB-HeaderStart
53042>>>>>>>>>>>>>
53042>>>>>>>>>>>>>// File Name : SALESMEN.DD
53042>>>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
53042>>>>>>>>>>>>>// Revision  : 57
53042>>>>>>>>>>>>>// Version   : 2
53042>>>>>>>>>>>>>
53042>>>>>>>>>>>>>Use  Windows           // Basic Definitions
53042>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53042>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53042>>>>>>>>>>>>>
53042>>>>>>>>>>>>>Open Salesmen
53044>>>>>>>>>>>>>Open Cn
53046>>>>>>>>>>>>>Open Sysrecc
53048>>>>>>>>>>>>>
53048>>>>>>>>>>>>>//DDB-HeaderEnd
53048>>>>>>>>>>>>>//DDB-ValidationStart
53048>>>>>>>>>>>>>
53048>>>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
53048>>>>>>>>>>>>>
53048>>>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
53050>>>>>>>>>>>>>    Set Type_Value        To "DOY"
53051>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
53052>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
53053>>>>>>>>>>>>>    //DDB-ValidationCustomStart
53053>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
53053>>>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
53054>>>>>>>>>>>>>//DDB-ValidationEnd
53054>>>>>>>>>>>>>//DDB-SelectionStart
53054>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
53054>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
53054>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
53054>>>>>>>>>>>>>Register_Object sl108
53054>>>>>>>>>>>>>Register_Object sl198
53054>>>>>>>>>>>>>Register_Object sl197
53054>>>>>>>>>>>>>//DDB-SelectionEnd
53054>>>>>>>>>>>>>
53054>>>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
53055>>>>>>>>>>>>> 
53055>>>>>>>>>>>>>    // Save_Main_File:
53055>>>>>>>>>>>>> 
53055>>>>>>>>>>>>>    Procedure Save_Main_File
53056>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
53059>>>>>>>>>>>>>        Forward Send Save_Main_File
53061>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
53062>>>>>>>>>>>>> 
53062>>>>>>>>>>>>>    // Define_Fields:
53062>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53062>>>>>>>>>>>>>     Procedure Update
53063>>>>>>>>>>>>>        Forward Send Update
53065>>>>>>>>>>>>>        // Insert Code Here
53065>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
53066>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
53067>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
53068>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
53068>>>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
53069>>>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
53070>>>>>>>>>>>>>
53070>>>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
53070>>>>>>>>>>>>>
53070>>>>>>>>>>>>>        //betolink
53070>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
53071>>>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
53072>>>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
53073>>>>>>>>>>>>>
53073>>>>>>>>>>>>>    End_Procedure   // Update
53074>>>>>>>>>>>>>
53074>>>>>>>>>>>>>     Procedure Creating
53075>>>>>>>>>>>>>        Forward Send Creating
53077>>>>>>>>>>>>>        // Insert Code Here
53077>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
53078>>>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
53079>>>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
53080>>>>>>>>>>>>>    End_Procedure   // Creating
53081>>>>>>>>>>>>>
53081>>>>>>>>>>>>>    Procedure Define_Fields
53082>>>>>>>>>>>>>        Forward Send Define_Fields
53084>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53084>>>>>>>>>>>>>        //DDB-DefineFieldStart
53084>>>>>>>>>>>>>
53084>>>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
53085>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
53086>>>>>>>>>>>>>
53086>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53087>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53088>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53089>>>>>>>>>>>>>
53089>>>>>>>>>>>>>        // Child (Client) file structure................
53089>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
53090>>>>>>>>>>>>>
53090>>>>>>>>>>>>>        // External (System) file structure.............
53090>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53091>>>>>>>>>>>>>
53091>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
53094>>>>>>>>>>>>>
53094>>>>>>>>>>>>>        // Field-based properties.......................
53094>>>>>>>>>>>>>
53094>>>>>>>>>>>>>        // Salesmen.Company_Code
53094>>>>>>>>>>>>>
53094>>>>>>>>>>>>>        // Salesmen.Branch_Code
53094>>>>>>>>>>>>>
53094>>>>>>>>>>>>>        // Salesmen.Year_Year
53094>>>>>>>>>>>>>
53094>>>>>>>>>>>>>        // Salesmen.Sls_Id
53094>>>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
53095>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
53096>>>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
53097>>>>>>>>>>>>>
53097>>>>>>>>>>>>>        // Salesmen.Sls_Name
53097>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Sls_Afm
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Sls_Rec0
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Sls_Recr
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Last_Xreosh
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Last_Pistosh
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Last_Order
53098>>>>>>>>>>>>>
53098>>>>>>>>>>>>>        // Salesmen.Sls_Doy
53098>>>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
53099>>>>>>>>>>>>>
53099>>>>>>>>>>>>>        // Salesmen.Sls_Address
53099>>>>>>>>>>>>>
53099>>>>>>>>>>>>>        // Salesmen.Sls_City
53099>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
53100>>>>>>>>>>>>>
53100>>>>>>>>>>>>>        // Salesmen.Sls_Area
53100>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Job
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Respons
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Zipcode
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Phone
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Fax
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Mobile
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Aoh
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Email
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Class
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Details
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Sitew
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Codem
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Categfpa
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Fpa
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Public
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Sn
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Repm
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Active
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Reported
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Lastupd
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Markexp
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Catjob
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Xreosh
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Pistosh
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Ypoloipo
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Plafon
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Overhead
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Add_No
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Nomos
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Sls_Xora
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        // Salesmen.Polh_Recr
53101>>>>>>>>>>>>>
53101>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53101>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53102>>>>>>>>>>>>>
53102>>>>>>>>>>>>>    // Field_Defaults:
53102>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53102>>>>>>>>>>>>>
53102>>>>>>>>>>>>>    Procedure Field_Defaults
53103>>>>>>>>>>>>>        Forward Send Field_Defaults
53105>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53105>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53105>>>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
53106>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53106>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53107>>>>>>>>>>>>>
53107>>>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
53108>>>>>>>>>>>>>//DDB-Selection-pkg-Start
53108>>>>>>>>>>>>>
53108>>>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
53108>>>>>>>>>>>>>>>//AB/ Project sl108:polhtes
53108>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
53108>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
53108>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
53108>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>// Project Object Structure
53108>>>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
53108>>>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
53108>>>>>>>>>>>>>>>//     oSelList is a dbListSub
53108>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
53108>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
53108>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>// Register all objects
53108>>>>>>>>>>>>>>>Register_Object oCancel_bn
53108>>>>>>>>>>>>>>>Register_Object oOK_bn
53108>>>>>>>>>>>>>>>Register_Object oSearch_bn
53108>>>>>>>>>>>>>>>Register_Object oSelList
53108>>>>>>>>>>>>>>>Register_Object Salesmen_DD
53108>>>>>>>>>>>>>>>Register_Object sl108
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>//AB-IgnoreStart
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>Use DFAllEnt.pkg
53108>>>>>>>>>>>>>>>Use dbList.Sub
53108>>>>>>>>>>>>>>>Use Button.Sub
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>Use SALESMEN.DD
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>//AB-IgnoreEnd
53108>>>>>>>>>>>>>>>
53108>>>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
53110>>>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
53111>>>>>>>>>>>>>>>    Set Size to 148 421
53112>>>>>>>>>>>>>>>    Set Location to 4 5
53113>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
53114>>>>>>>>>>>>>>>    Set Modal_State to FALSE
53115>>>>>>>>>>>>>>>
53115>>>>>>>>>>>>>>>    //AB-DDOStart
53115>>>>>>>>>>>>>>>
53115>>>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
53117>>>>>>>>>>>>>>>    End_Object    // Salesmen_DD
53118>>>>>>>>>>>>>>>
53118>>>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
53119>>>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
53120>>>>>>>>>>>>>>>
53120>>>>>>>>>>>>>>>    //AB-DDOEnd
53120>>>>>>>>>>>>>>>
53120>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
53122>>>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
53123>>>>>>>>>>>>>>>        Set Size to 105 408
53124>>>>>>>>>>>>>>>        Set Location to 6 6
53125>>>>>>>>>>>>>>>
53125>>>>>>>>>>>>>>>        Begin_Row
53128>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
53129>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
53130>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
53131>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
53132>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
53133>>>>>>>>>>>>>>>        End_Row
53138>>>>>>>>>>>>>>>
53138>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
53139>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
53140>>>>>>>>>>>>>>>        
53140>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
53141>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
53142>>>>>>>>>>>>>>>        
53142>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
53143>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
53144>>>>>>>>>>>>>>>        
53144>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
53145>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
53146>>>>>>>>>>>>>>>        
53146>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
53147>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
53148>>>>>>>>>>>>>>>        
53148>>>>>>>>>>>>>>>    End_Object    // oSelList
53149>>>>>>>>>>>>>>>
53149>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
53151>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
53152>>>>>>>>>>>>>>>        Set Location to 117 255
53153>>>>>>>>>>>>>>>
53153>>>>>>>>>>>>>>>        //AB-StoreStart
53153>>>>>>>>>>>>>>>        Procedure OnClick
53155>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
53156>>>>>>>>>>>>>>>        End_Procedure
53157>>>>>>>>>>>>>>>        //AB-StoreEnd
53157>>>>>>>>>>>>>>>
53157>>>>>>>>>>>>>>>    End_Object    // oOK_bn
53158>>>>>>>>>>>>>>>
53158>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
53160>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
53161>>>>>>>>>>>>>>>        Set Location to 117 310
53162>>>>>>>>>>>>>>>
53162>>>>>>>>>>>>>>>        //AB-StoreStart
53162>>>>>>>>>>>>>>>        Procedure OnClick
53164>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
53165>>>>>>>>>>>>>>>        End_Procedure
53166>>>>>>>>>>>>>>>        //AB-StoreEnd
53166>>>>>>>>>>>>>>>
53166>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
53167>>>>>>>>>>>>>>>
53167>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
53169>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
53170>>>>>>>>>>>>>>>        Set Location to 117 365
53171>>>>>>>>>>>>>>>
53171>>>>>>>>>>>>>>>        //AB-StoreStart
53171>>>>>>>>>>>>>>>        Procedure OnClick
53173>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
53174>>>>>>>>>>>>>>>        End_Procedure
53175>>>>>>>>>>>>>>>        //AB-StoreEnd
53175>>>>>>>>>>>>>>>
53175>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
53176>>>>>>>>>>>>>>>
53176>>>>>>>>>>>>>>>
53176>>>>>>>>>>>>>>>    //AB-StoreStart
53176>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
53177>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
53178>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
53179>>>>>>>>>>>>>>>    //AB-StoreEnd
53179>>>>>>>>>>>>>>>
53179>>>>>>>>>>>>>>>End_Object    // sl108
53180>>>>>>>>>>>>>>>
53180>>>>>>>>>>>>>>>//AB/ End_Object    // prj
53180>>>>>>>>>>>>>Use sl198.sl         // sl198
53180>>>>>>>>>>>>>Use sl197.SL         // sl197
53180>>>>>>>>>>>>>
53180>>>>>>>>>>>>>//DDB-Selection-pkg-End
53180>>>>>>>>>>>>>//DDB-FileEnd
53180>>>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
53180>>>>>>>>>>>>>//DDB-FileStart
53180>>>>>>>>>>>>>//DDB-HeaderStart
53180>>>>>>>>>>>>>
53180>>>>>>>>>>>>>// File Name : CONSTRCT.DD
53180>>>>>>>>>>>>>// Class Name: Constrct_DataDictionary
53180>>>>>>>>>>>>>// Revision  : 49
53180>>>>>>>>>>>>>// Version   : 2
53180>>>>>>>>>>>>>
53180>>>>>>>>>>>>>Use  Windows           // Basic Definitions
53180>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53180>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53180>>>>>>>>>>>>>
53180>>>>>>>>>>>>>Open Constrct
53182>>>>>>>>>>>>>Open Cn
53184>>>>>>>>>>>>>Open Sysrecc
53186>>>>>>>>>>>>>
53186>>>>>>>>>>>>>//DDB-HeaderEnd
53186>>>>>>>>>>>>>//DDB-ValidationStart
53186>>>>>>>>>>>>>
53186>>>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
53186>>>>>>>>>>>>>
53186>>>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
53188>>>>>>>>>>>>>    Set Type_Value        To "DOY"
53189>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
53190>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
53191>>>>>>>>>>>>>    //DDB-ValidationCustomStart
53191>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
53191>>>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
53192>>>>>>>>>>>>>//DDB-ValidationEnd
53192>>>>>>>>>>>>>//DDB-SelectionStart
53192>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
53192>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
53192>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
53192>>>>>>>>>>>>>Register_Object sl109
53192>>>>>>>>>>>>>Register_Object sl198
53192>>>>>>>>>>>>>Register_Object sl197
53192>>>>>>>>>>>>>//DDB-SelectionEnd
53192>>>>>>>>>>>>>
53192>>>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
53193>>>>>>>>>>>>>    Procedure Update
53194>>>>>>>>>>>>>        Forward Send Update
53196>>>>>>>>>>>>>        // Insert Code Here
53196>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
53197>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
53198>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
53199>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
53199>>>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
53200>>>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
53201>>>>>>>>>>>>>
53201>>>>>>>>>>>>>        //betolink
53201>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
53202>>>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
53203>>>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
53204>>>>>>>>>>>>>
53204>>>>>>>>>>>>>    End_Procedure   // Update
53205>>>>>>>>>>>>>
53205>>>>>>>>>>>>>     Procedure Creating
53206>>>>>>>>>>>>>        Forward Send Creating
53208>>>>>>>>>>>>>        // Insert Code Here
53208>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
53209>>>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
53210>>>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
53211>>>>>>>>>>>>>    End_Procedure   // Creating
53212>>>>>>>>>>>>>
53212>>>>>>>>>>>>>
53212>>>>>>>>>>>>>    Procedure Define_Fields
53213>>>>>>>>>>>>>        Forward Send Define_Fields
53215>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53215>>>>>>>>>>>>>        //DDB-DefineFieldStart
53215>>>>>>>>>>>>>
53215>>>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
53216>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
53217>>>>>>>>>>>>>
53217>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53218>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53219>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53220>>>>>>>>>>>>>
53220>>>>>>>>>>>>>        // Child (Client) file structure................
53220>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
53221>>>>>>>>>>>>>
53221>>>>>>>>>>>>>        // External (System) file structure.............
53221>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53222>>>>>>>>>>>>>
53222>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
53225>>>>>>>>>>>>>
53225>>>>>>>>>>>>>        // Field-based properties.......................
53225>>>>>>>>>>>>>
53225>>>>>>>>>>>>>        // Constrct.Company_Code
53225>>>>>>>>>>>>>
53225>>>>>>>>>>>>>        // Constrct.Branch_Code
53225>>>>>>>>>>>>>
53225>>>>>>>>>>>>>        // Constrct.Year_Year
53225>>>>>>>>>>>>>
53225>>>>>>>>>>>>>        // Constrct.Cnt_Id
53225>>>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
53226>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
53227>>>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
53228>>>>>>>>>>>>>
53228>>>>>>>>>>>>>        // Constrct.Cnt_Name
53228>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Cnt_Afm
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Cnt_Rec0
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Cnt_Recr
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Last_Xreosh
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Last_Pistosh
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Last_Order
53229>>>>>>>>>>>>>
53229>>>>>>>>>>>>>        // Constrct.Cnt_Doy
53229>>>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
53230>>>>>>>>>>>>>
53230>>>>>>>>>>>>>        // Constrct.Cnt_Address
53230>>>>>>>>>>>>>
53230>>>>>>>>>>>>>        // Constrct.Cnt_City
53230>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
53231>>>>>>>>>>>>>
53231>>>>>>>>>>>>>        // Constrct.Cnt_Area
53231>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Job
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Respons
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Zipcode
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Phone
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Fax
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Mobile
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Aoh
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Email
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Class
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Details
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Sitew
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Codem
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Categfpa
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Fpa
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Public
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Sn
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Repm
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Active
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Reported
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Pelprom
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Markexp
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Catjob
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Xreosh
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Pistosh
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Ypoloipo
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Plafon
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Overhead
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Add_No
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Nomos
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Cnt_Xora
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        // Constrct.Polh_Recr
53232>>>>>>>>>>>>>
53232>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53232>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53233>>>>>>>>>>>>>
53233>>>>>>>>>>>>>    // Field_Defaults:
53233>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53233>>>>>>>>>>>>>
53233>>>>>>>>>>>>>    Procedure Field_Defaults
53234>>>>>>>>>>>>>        Forward Send Field_Defaults
53236>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53236>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53236>>>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
53237>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53237>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53238>>>>>>>>>>>>>
53238>>>>>>>>>>>>>End_Class    // Constrct_DataDictionary
53239>>>>>>>>>>>>>//DDB-Selection-pkg-Start
53239>>>>>>>>>>>>>
53239>>>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
53239>>>>>>>>>>>>>>>//AB/ Project sl109
53239>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
53239>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
53239>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
53239>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>// Project Object Structure
53239>>>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
53239>>>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
53239>>>>>>>>>>>>>>>//     oSelList is a dbListSub
53239>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
53239>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
53239>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>// Register all objects
53239>>>>>>>>>>>>>>>Register_Object Constrct_DD
53239>>>>>>>>>>>>>>>Register_Object oCancel_bn
53239>>>>>>>>>>>>>>>Register_Object oOK_bn
53239>>>>>>>>>>>>>>>Register_Object oSearch_bn
53239>>>>>>>>>>>>>>>Register_Object oSelList
53239>>>>>>>>>>>>>>>Register_Object sl109
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>//AB-IgnoreStart
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>Use DFAllEnt.pkg
53239>>>>>>>>>>>>>>>Use dbList.Sub
53239>>>>>>>>>>>>>>>Use Button.Sub
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>Use CONSTRCT.DD
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>//AB-IgnoreEnd
53239>>>>>>>>>>>>>>>
53239>>>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
53241>>>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
53242>>>>>>>>>>>>>>>    Set Size to 148 427
53243>>>>>>>>>>>>>>>    Set Location to 4 5
53244>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
53245>>>>>>>>>>>>>>>    Set Modal_State to FALSE
53246>>>>>>>>>>>>>>>
53246>>>>>>>>>>>>>>>    //AB-DDOStart
53246>>>>>>>>>>>>>>>
53246>>>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
53248>>>>>>>>>>>>>>>    End_Object    // Constrct_DD
53249>>>>>>>>>>>>>>>
53249>>>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
53250>>>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
53251>>>>>>>>>>>>>>>
53251>>>>>>>>>>>>>>>    //AB-DDOEnd
53251>>>>>>>>>>>>>>>
53251>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
53253>>>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
53254>>>>>>>>>>>>>>>        Set Size to 105 415
53255>>>>>>>>>>>>>>>        Set Location to 6 6
53256>>>>>>>>>>>>>>>
53256>>>>>>>>>>>>>>>        Begin_Row
53259>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
53260>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
53261>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
53262>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
53263>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
53264>>>>>>>>>>>>>>>        End_Row
53269>>>>>>>>>>>>>>>
53269>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
53270>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
53271>>>>>>>>>>>>>>>        
53271>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
53272>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
53273>>>>>>>>>>>>>>>        
53273>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
53274>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
53275>>>>>>>>>>>>>>>        
53275>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
53276>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
53277>>>>>>>>>>>>>>>        
53277>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
53278>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
53279>>>>>>>>>>>>>>>        
53279>>>>>>>>>>>>>>>    End_Object    // oSelList
53280>>>>>>>>>>>>>>>
53280>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
53282>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
53283>>>>>>>>>>>>>>>        Set Location to 116 261
53284>>>>>>>>>>>>>>>
53284>>>>>>>>>>>>>>>        //AB-StoreStart
53284>>>>>>>>>>>>>>>        Procedure OnClick
53286>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
53287>>>>>>>>>>>>>>>        End_Procedure
53288>>>>>>>>>>>>>>>        //AB-StoreEnd
53288>>>>>>>>>>>>>>>
53288>>>>>>>>>>>>>>>    End_Object    // oOK_bn
53289>>>>>>>>>>>>>>>
53289>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
53291>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
53292>>>>>>>>>>>>>>>        Set Location to 116 315
53293>>>>>>>>>>>>>>>
53293>>>>>>>>>>>>>>>        //AB-StoreStart
53293>>>>>>>>>>>>>>>        Procedure OnClick
53295>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
53296>>>>>>>>>>>>>>>        End_Procedure
53297>>>>>>>>>>>>>>>        //AB-StoreEnd
53297>>>>>>>>>>>>>>>
53297>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
53298>>>>>>>>>>>>>>>
53298>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
53300>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
53301>>>>>>>>>>>>>>>        Set Location to 116 371
53302>>>>>>>>>>>>>>>
53302>>>>>>>>>>>>>>>        //AB-StoreStart
53302>>>>>>>>>>>>>>>        Procedure OnClick
53304>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
53305>>>>>>>>>>>>>>>        End_Procedure
53306>>>>>>>>>>>>>>>        //AB-StoreEnd
53306>>>>>>>>>>>>>>>
53306>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
53307>>>>>>>>>>>>>>>
53307>>>>>>>>>>>>>>>
53307>>>>>>>>>>>>>>>    //AB-StoreStart
53307>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
53308>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
53309>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
53310>>>>>>>>>>>>>>>    //AB-StoreEnd
53310>>>>>>>>>>>>>>>
53310>>>>>>>>>>>>>>>End_Object    // sl109
53311>>>>>>>>>>>>>>>
53311>>>>>>>>>>>>>>>//AB/ End_Object    // prj
53311>>>>>>>>>>>>>Use sl198.sl         // sl198
53311>>>>>>>>>>>>>Use sl197.SL         // sl197
53311>>>>>>>>>>>>>
53311>>>>>>>>>>>>>//DDB-Selection-pkg-End
53311>>>>>>>>>>>>>//DDB-FileEnd
53311>>>>>>>>>>>    Use CN.DD
53311>>>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
53311>>>>>>>>>>>>>//DDB-FileStart
53311>>>>>>>>>>>>>//DDB-HeaderStart
53311>>>>>>>>>>>>>
53311>>>>>>>>>>>>>// File Name : PSXETIKA.DD
53311>>>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
53311>>>>>>>>>>>>>// Revision  : 14
53311>>>>>>>>>>>>>// Version   : 2
53311>>>>>>>>>>>>>
53311>>>>>>>>>>>>>Use  Windows           // Basic Definitions
53311>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53311>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53311>>>>>>>>>>>>>
53311>>>>>>>>>>>>>Open Psxetika
53313>>>>>>>>>>>>>Open Particle
53315>>>>>>>>>>>>>Open Sysrecp
53317>>>>>>>>>>>>>
53317>>>>>>>>>>>>>//DDB-HeaderEnd
53317>>>>>>>>>>>>>
53317>>>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
53318>>>>>>>>>>>>>
53318>>>>>>>>>>>>>    Procedure Creating
53319>>>>>>>>>>>>>        Integer iNextNo
53320>>>>>>>>>>>>>        Forward Send Creating
53322>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
53323>>>>>>>>>>>>>    End_Procedure   // Creating
53324>>>>>>>>>>>>>
53324>>>>>>>>>>>>>    Procedure Update
53325>>>>>>>>>>>>>        Forward Send Update
53327>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
53328>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
53329>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
53330>>>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
53331>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
53332>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
53333>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
53334>>>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
53335>>>>>>>>>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
53336>>>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
53337>>>>>>>>>>>>>    End_Procedure   // Update
53338>>>>>>>>>>>>>
53338>>>>>>>>>>>>>
53338>>>>>>>>>>>>>    Procedure Request_Save
53339>>>>>>>>>>>>>        Number  nQty
53340>>>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
53340>>>>>>>>>>>>>
53340>>>>>>>>>>>>>        Forward Send Request_Save
53342>>>>>>>>>>>>>
53342>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
53343>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
53344>>>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
53346>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
53347>>>>>>>>>>>>>            If (nQty=0) Begin
53349>>>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
53349>>>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
53349>>>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
53349>>>>>>>>>>>>>                Delete Psxetika
53350>>>>>>>>>>>>>                Clear Psxetika
53351>>>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
53352>>>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
53353>>>>>>>>>>>>>                Find Eq Psxetika by Index.4
53354>>>>>>>>>>>>>>
53354>>>>>>>>>>>>>                If (Found) Delete Psxetika
53357>>>>>>>>>>>>>            End
53357>>>>>>>>>>>>>>
53357>>>>>>>>>>>>>        End
53357>>>>>>>>>>>>>>
53357>>>>>>>>>>>>>    End_Procedure
53358>>>>>>>>>>>>>
53358>>>>>>>>>>>>>
53358>>>>>>>>>>>>>    // Define_Fields:
53358>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53358>>>>>>>>>>>>>
53358>>>>>>>>>>>>>    Procedure Define_Fields
53359>>>>>>>>>>>>>        Forward Send Define_Fields
53361>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53361>>>>>>>>>>>>>        //DDB-DefineFieldStart
53361>>>>>>>>>>>>>
53361>>>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
53362>>>>>>>>>>>>>
53362>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53363>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53364>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53365>>>>>>>>>>>>>
53365>>>>>>>>>>>>>        // Parent (Server) file structure...............
53365>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53366>>>>>>>>>>>>>
53366>>>>>>>>>>>>>        // External (System) file structure.............
53366>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
53367>>>>>>>>>>>>>
53367>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Field-based properties.......................
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Company_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Branch_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Year_Year
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Ctypkin_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Wtypkin_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Ptyppar_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Pseira_Seira
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Custprom_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Client_Id
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Partl_No
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Partl_Hmnia
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Partl_Recr
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Psxetika_Recr
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Company_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Year_Year
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Client_Id
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Partl_No
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
53370>>>>>>>>>>>>>
53370>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53370>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53371>>>>>>>>>>>>>
53371>>>>>>>>>>>>>    // Field_Defaults:
53371>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53371>>>>>>>>>>>>>
53371>>>>>>>>>>>>>    Procedure Field_Defaults
53372>>>>>>>>>>>>>        Forward Send Field_Defaults
53374>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53374>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53374>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53374>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53375>>>>>>>>>>>>>
53375>>>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
53376>>>>>>>>>>>>>//DDB-FileEnd
53376>>>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
53376>>>>>>>>>>>>>//DDB-FileStart
53376>>>>>>>>>>>>>//DDB-HeaderStart
53376>>>>>>>>>>>>>
53376>>>>>>>>>>>>>// File Name : TPARTICL.DD
53376>>>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
53376>>>>>>>>>>>>>// Revision  : 28
53376>>>>>>>>>>>>>// Version   : 2
53376>>>>>>>>>>>>>
53376>>>>>>>>>>>>>Use  Windows           // Basic Definitions
53376>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53376>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53376>>>>>>>>>>>>>
53376>>>>>>>>>>>>>Open Tparticl
53378>>>>>>>>>>>>>Open Particle
53380>>>>>>>>>>>>>Open Baxiokat
53382>>>>>>>>>>>>>Open Sysrecc
53384>>>>>>>>>>>>>
53384>>>>>>>>>>>>>//DDB-HeaderEnd
53384>>>>>>>>>>>>>//DDB-ValidationStart
53384>>>>>>>>>>>>>
53384>>>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
53384>>>>>>>>>>>>>
53384>>>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
53386>>>>>>>>>>>>>    Set Type_Value        To "HMERES"
53387>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
53388>>>>>>>>>>>>>    //DDB-ValidationCustomStart
53388>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
53388>>>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
53389>>>>>>>>>>>>>//DDB-ValidationEnd
53389>>>>>>>>>>>>>
53389>>>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
53390>>>>>>>>>>>>>
53390>>>>>>>>>>>>>    Procedure Construct_Object
53391>>>>>>>>>>>>>        Forward Send Construct_Object
53393>>>>>>>>>>>>>        Property Integer piParticleID Public 0
53394>>>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
53395>>>>>>>>>>>>>    End_Procedure
53396>>>>>>>>>>>>>
53396>>>>>>>>>>>>>    Procedure End_Construct_Object
53397>>>>>>>>>>>>>        Integer iID
53398>>>>>>>>>>>>>        Forward Send End_Construct_Object
53400>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
53401>>>>>>>>>>>>>        Set piParticleID to iID
53402>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
53403>>>>>>>>>>>>>        Set piBaxiokatID to iID
53404>>>>>>>>>>>>>    End_Procedure
53405>>>>>>>>>>>>>
53405>>>>>>>>>>>>>    Procedure Calc_All_The_Fields
53406>>>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
53407>>>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
53407>>>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
53407>>>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
53407>>>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
53407>>>>>>>>>>>>>
53407>>>>>>>>>>>>>        Get piBaxiokatID                                                to iID
53408>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
53409>>>>>>>>>>>>>
53409>>>>>>>>>>>>>
53409>>>>>>>>>>>>>        Get piParticleID                                                to iID
53410>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
53411>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
53412>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
53413>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
53414>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
53415>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
53416>>>>>>>>>>>>>
53416>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
53416>>>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
53416>>>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
53416>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
53416>>>>>>>>>>>>>
53416>>>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
53416>>>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
53417>>>>>>>>>>>>>
53417>>>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
53417>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
53417>>>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
53417>>>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
53417>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
53417>>>>>>>>>>>>>//        Loop
53417>>>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
53417>>>>>>>>>>>>>
53417>>>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
53417>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
53417>>>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
53417>>>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
53417>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
53417>>>>>>>>>>>>>//        Loop
53417>>>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
53417>>>>>>>>>>>>>
53417>>>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
53417>>>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
53418>>>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
53420>>>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
53424>>>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
53425>>>>>>>>>>>>>            Loop
53426>>>>>>>>>>>>>>
53426>>>>>>>>>>>>>        End
53426>>>>>>>>>>>>>>
53426>>>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
53427>>>>>>>>>>>>>
53427>>>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
53428>>>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
53429>>>>>>>>>>>>>
53429>>>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
53429>>>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
53430>>>>>>>>>>>>>
53430>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
53431>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
53432>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
53433>>>>>>>>>>>>>
53433>>>>>>>>>>>>>    End_Procedure
53434>>>>>>>>>>>>>
53434>>>>>>>>>>>>>
53434>>>>>>>>>>>>>    Procedure Creating
53435>>>>>>>>>>>>>        Forward Send Creating
53437>>>>>>>>>>>>>        // Insert Code Here
53437>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
53438>>>>>>>>>>>>>    End_Procedure   // Creating
53439>>>>>>>>>>>>>
53439>>>>>>>>>>>>>
53439>>>>>>>>>>>>>    Procedure Save_Main_File
53440>>>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
53443>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
53445>>>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
53448>>>>>>>>>>>>>        End
53448>>>>>>>>>>>>>>
53448>>>>>>>>>>>>>      Forward Send Save_Main_File
53450>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
53451>>>>>>>>>>>>>
53451>>>>>>>>>>>>>
53451>>>>>>>>>>>>>    // Define_Fields:
53451>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53451>>>>>>>>>>>>>
53451>>>>>>>>>>>>>    Procedure Define_Fields
53452>>>>>>>>>>>>>        Forward Send Define_Fields
53454>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53454>>>>>>>>>>>>>        //DDB-DefineFieldStart
53454>>>>>>>>>>>>>
53454>>>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
53455>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
53456>>>>>>>>>>>>>
53456>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53457>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53458>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53459>>>>>>>>>>>>>
53459>>>>>>>>>>>>>        // Parent (Server) file structure...............
53459>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53460>>>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
53461>>>>>>>>>>>>>
53461>>>>>>>>>>>>>        // External (System) file structure.............
53461>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53462>>>>>>>>>>>>>
53462>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
53465>>>>>>>>>>>>>
53465>>>>>>>>>>>>>        // Field-based properties.......................
53465>>>>>>>>>>>>>
53465>>>>>>>>>>>>>        // Tparticl.Partl_Recr
53465>>>>>>>>>>>>>
53465>>>>>>>>>>>>>        // Tparticl.Baxiokat_Code
53465>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
53466>>>>>>>>>>>>>
53466>>>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
53466>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
53467>>>>>>>>>>>>>
53467>>>>>>>>>>>>>        // Tparticl.Paralabh_Meres
53467>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
53468>>>>>>>>>>>>>
53468>>>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
53468>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
53469>>>>>>>>>>>>>
53469>>>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
53469>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
53470>>>>>>>>>>>>>
53470>>>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
53470>>>>>>>>>>>>>
53470>>>>>>>>>>>>>        // Tparticl.Tparticl_Recr
53470>>>>>>>>>>>>>
53470>>>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
53470>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
53471>>>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
53472>>>>>>>>>>>>>
53472>>>>>>>>>>>>>        // Tparticl.Poso
53472>>>>>>>>>>>>>
53472>>>>>>>>>>>>>        // Tparticl.Paralabh
53472>>>>>>>>>>>>>
53472>>>>>>>>>>>>>        // Tparticl.Exoflhsh
53472>>>>>>>>>>>>>
53472>>>>>>>>>>>>>        // Tparticl.Isok
53472>>>>>>>>>>>>>
53472>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53472>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53473>>>>>>>>>>>>>
53473>>>>>>>>>>>>>    // Field_Defaults:
53473>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53473>>>>>>>>>>>>>
53473>>>>>>>>>>>>>    Procedure Field_Defaults
53474>>>>>>>>>>>>>        Forward Send Field_Defaults
53476>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53476>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53476>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53476>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53477>>>>>>>>>>>>>
53477>>>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
53478>>>>>>>>>>>>>//DDB-FileEnd
53478>>>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
53478>>>>>>>>>>>>>//DDB-FileStart
53478>>>>>>>>>>>>>//DDB-HeaderStart
53478>>>>>>>>>>>>>
53478>>>>>>>>>>>>>// File Name : PARTLFPA.DD
53478>>>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
53478>>>>>>>>>>>>>// Revision  : 7
53478>>>>>>>>>>>>>// Version   : 2
53478>>>>>>>>>>>>>
53478>>>>>>>>>>>>>Use  Windows           // Basic Definitions
53478>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53478>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53478>>>>>>>>>>>>>
53478>>>>>>>>>>>>>Open Partlfpa
53480>>>>>>>>>>>>>Open Particle
53482>>>>>>>>>>>>>Open Fpa
53484>>>>>>>>>>>>>
53484>>>>>>>>>>>>>//DDB-HeaderEnd
53484>>>>>>>>>>>>> 
53484>>>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
53485>>>>>>>>>>>>>
53485>>>>>>>>>>>>>
53485>>>>>>>>>>>>>    // Define_Fields:
53485>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53485>>>>>>>>>>>>>
53485>>>>>>>>>>>>>    Procedure Define_Fields
53486>>>>>>>>>>>>>        Forward Send Define_Fields
53488>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53488>>>>>>>>>>>>>        //DDB-DefineFieldStart
53488>>>>>>>>>>>>>
53488>>>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
53489>>>>>>>>>>>>>
53489>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53490>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53491>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53492>>>>>>>>>>>>>
53492>>>>>>>>>>>>>        // Parent (Server) file structure...............
53492>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53493>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Field-based properties.......................
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Partl_Recr
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Poso_Fpa
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        // Partlfpa.Poso_Me_Fpa
53494>>>>>>>>>>>>>
53494>>>>>>>>>>>>>        //DDB-DefineFieldEnd
53494>>>>>>>>>>>>>    End_Procedure    // Define_Fields
53495>>>>>>>>>>>>>
53495>>>>>>>>>>>>>    // Field_Defaults:
53495>>>>>>>>>>>>>    // This procedure is used to establish default field values.
53495>>>>>>>>>>>>>
53495>>>>>>>>>>>>>    Procedure Field_Defaults
53496>>>>>>>>>>>>>        Forward Send Field_Defaults
53498>>>>>>>>>>>>>        //DDB-Generated-Code-Location
53498>>>>>>>>>>>>>        //DDB-FieldDefaultStart
53498>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
53498>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
53499>>>>>>>>>>>>>
53499>>>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
53500>>>>>>>>>>>>>//DDB-FileEnd
53500>>>>>>>>>>>
53500>>>>>>>>>>>    //AB-StoreTopEnd
53500>>>>>>>>>>>
53500>>>>>>>>>>>    //AB-IgnoreStart
53500>>>>>>>>>>>
53500>>>>>>>>>>>    Use Bproces.Sub
53500>>>>>>>>>>>
53500>>>>>>>>>>>
53500>>>>>>>>>>>    //AB-IgnoreEnd
53500>>>>>>>>>>>
53500>>>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
53502>>>>>>>>>>>
53502>>>>>>>>>>>        //AB-StoreTopStart
53502>>>>>>>>>>>
53502>>>>>>>>>>>        Property    String  psParticleRecr0 Public ''
53504>>>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
53506>>>>>>>>>>>        Property    String  psClient_Desc   Public ''
53508>>>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
53510>>>>>>>>>>>        Property    String  psSeira_Seira   Public ''
53512>>>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
53514>>>>>>>>>>>        Property    Integer piPartl_No      Public  0
53516>>>>>>>>>>>        Property    Number  pnPosothta      Public  0
53518>>>>>>>>>>>
53518>>>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
53520>>>>>>>>>>>        End_Object    // Ctypkin_DD2
53521>>>>>>>>>>>
53521>>>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
53523>>>>>>>>>>>        End_Object    // Wtypkin_DD2
53524>>>>>>>>>>>
53524>>>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
53526>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
53527>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
53528>>>>>>>>>>>        End_Object    // Ptyppar_DD2
53529>>>>>>>>>>>
53529>>>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
53531>>>>>>>>>>>        End_Object    // Country_DD2
53532>>>>>>>>>>>
53532>>>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
53534>>>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
53535>>>>>>>>>>>        End_Object    // Towns_DD2
53536>>>>>>>>>>>
53536>>>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
53538>>>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
53539>>>>>>>>>>>        End_Object    // Cities_DD2
53540>>>>>>>>>>>
53540>>>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
53542>>>>>>>>>>>        End_Object    // Areas_DD2
53543>>>>>>>>>>>
53543>>>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
53545>>>>>>>>>>>        End_Object    // Payresp_DD2
53546>>>>>>>>>>>
53546>>>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
53548>>>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
53549>>>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
53550>>>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
53551>>>>>>>>>>>        End_Object    // Clients_DD2
53552>>>>>>>>>>>
53552>>>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
53554>>>>>>>>>>>        End_Object    // Nomisma_DD2
53555>>>>>>>>>>>
53555>>>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
53557>>>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
53558>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
53559>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
53560>>>>>>>>>>>        End_Object    // Particle_DD2
53561>>>>>>>>>>>
53561>>>>>>>>>>>
53561>>>>>>>>>>>        /////////////////////////////////////////////
53561>>>>>>>>>>>
53561>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
53563>>>>>>>>>>>        End_Object    // Ctypkin_DD
53564>>>>>>>>>>>
53564>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
53566>>>>>>>>>>>        End_Object    // Wtypkin_DD
53567>>>>>>>>>>>
53567>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
53569>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
53570>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
53571>>>>>>>>>>>        End_Object    // Ptyppar_DD
53572>>>>>>>>>>>
53572>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
53574>>>>>>>>>>>        End_Object    // Country_DD
53575>>>>>>>>>>>
53575>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
53577>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
53578>>>>>>>>>>>        End_Object    // Towns_DD
53579>>>>>>>>>>>
53579>>>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
53581>>>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
53582>>>>>>>>>>>        End_Object    // Cities_DD
53583>>>>>>>>>>>
53583>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
53585>>>>>>>>>>>        End_Object    // Areas_DD
53586>>>>>>>>>>>
53586>>>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
53588>>>>>>>>>>>        End_Object    // Payresp_DD
53589>>>>>>>>>>>
53589>>>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
53591>>>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
53592>>>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
53593>>>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
53594>>>>>>>>>>>        End_Object    // Clients_DD
53595>>>>>>>>>>>
53595>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53597>>>>>>>>>>>        End_Object    // Nomisma_DD
53598>>>>>>>>>>>
53598>>>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
53600>>>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
53601>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
53602>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
53603>>>>>>>>>>>        End_Object    // Particle_DD
53604>>>>>>>>>>>
53604>>>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
53606>>>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
53607>>>>>>>>>>>            Set Constrain_File  to Particle.File_Number
53608>>>>>>>>>>>        End_Object
53609>>>>>>>>>>>
53609>>>>>>>>>>>
53609>>>>>>>>>>>        //AB-StoreTopEnd
53609>>>>>>>>>>>
53609>>>>>>>>>>>        Set Size to 60 100
53610>>>>>>>>>>>
53610>>>>>>>>>>>        //AB-DDOStart
53610>>>>>>>>>>>
53610>>>>>>>>>>>
53610>>>>>>>>>>>        //AB-DDOEnd
53610>>>>>>>>>>>
53610>>>>>>>>>>>
53610>>>>>>>>>>>        //AB-StoreStart
53610>>>>>>>>>>>
53610>>>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
53612>>>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
53613>>>>>>>>>>>            Date    dPartl_Hmnia
53613>>>>>>>>>>>            Integer iPartl_No
53613>>>>>>>>>>>
53613>>>>>>>>>>>            Send Clear          to Particle_DD2
53614>>>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
53615>>>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
53616>>>>>>>>>>>
53616>>>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
53617>>>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
53618>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
53619>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
53620>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
53621>>>>>>>>>>>
53621>>>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
53622>>>>>>>>>>>            Set psClient_Desc       to sClient_Desc
53623>>>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
53624>>>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
53625>>>>>>>>>>>            Set piPartl_No          to iPartl_No
53626>>>>>>>>>>>        End_Procedure
53627>>>>>>>>>>>
53627>>>>>>>>>>>
53627>>>>>>>>>>>        Procedure Make_The_Record
53629>>>>>>>>>>>
53629>>>>>>>>>>>            Set psPtyppar_Desc      to ''
53630>>>>>>>>>>>            Set psClient_Desc       to ''
53631>>>>>>>>>>>            Set psSeira_Seira       to ''
53632>>>>>>>>>>>            Set pdPartl_Hmnia       to ''
53633>>>>>>>>>>>            Set piPartl_No          to 0
53634>>>>>>>>>>>
53634>>>>>>>>>>>            Clear Psxetika
53635>>>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
53636>>>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
53637>>>>>>>>>>>            Find Eq Psxetika by index.4
53638>>>>>>>>>>>>
53638>>>>>>>>>>>
53638>>>>>>>>>>>            If (Not(Found)) Begin
53640>>>>>>>>>>>
53640>>>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
53641>>>>>>>>>>>
53641>>>>>>>>>>>                Send Clear to Particle_DD
53642>>>>>>>>>>>                Send Clear to Psxetika_DD
53643>>>>>>>>>>>
53643>>>>>>>>>>>                // Vres ton mpampa
53643>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
53644>>>>>>>>>>>                Send Find to Particle_DD Eq 2
53645>>>>>>>>>>>
53645>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
53646>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
53647>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
53648>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
53649>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
53650>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
53651>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
53652>>>>>>>>>>>
53652>>>>>>>>>>>                Send Request_Save               to Psxetika_DD
53653>>>>>>>>>>>
53653>>>>>>>>>>>
53653>>>>>>>>>>>                // Make also 2nd Record
53653>>>>>>>>>>>                Clear Psxetika
53654>>>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
53655>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
53656>>>>>>>>>>>                Find Eq Psxetika by index.4
53657>>>>>>>>>>>>
53657>>>>>>>>>>>
53657>>>>>>>>>>>                If (Not(Found)) Begin
53659>>>>>>>>>>>
53659>>>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
53660>>>>>>>>>>>
53660>>>>>>>>>>>                    Send Clear to Particle_DD
53661>>>>>>>>>>>                    Send Clear to Psxetika_DD
53662>>>>>>>>>>>
53662>>>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
53663>>>>>>>>>>>                    Send Find to Particle_DD Eq 2
53664>>>>>>>>>>>
53664>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
53665>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
53666>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
53667>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
53668>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
53669>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
53670>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
53671>>>>>>>>>>>                    Send Request_Save               to Psxetika_DD
53672>>>>>>>>>>>                End
53672>>>>>>>>>>>>
53672>>>>>>>>>>>            End
53672>>>>>>>>>>>>
53672>>>>>>>>>>>        End_Procedure
53673>>>>>>>>>>>
53673>>>>>>>>>>>        //AB-StoreEnd
53673>>>>>>>>>>>
53673>>>>>>>>>>>    End_Object    // Psx_Array
53674>>>>>>>>>>>
53674>>>>>>>>>>>
53674>>>>>>>>>>>    //AB-StoreStart
53674>>>>>>>>>>>
53674>>>>>>>>>>>    //AB-StoreEnd
53674>>>>>>>>>>>
53674>>>>>>>>>>>//AB/     End_Object    // prj
53674>>>>>>>>>//Use bpMakeSx.dg
53674>>>>>>>>>
53674>>>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
53675>>>>>>>>>
53675>>>>>>>>>    Procedure Construct_Object
53676>>>>>>>>>        Forward Send Construct_Object
53678>>>>>>>>>        Property Integer piFromCreate   Public 0
53679>>>>>>>>>    End_Procedure
53680>>>>>>>>>
53680>>>>>>>>>    Procedure Creating
53681>>>>>>>>>        Forward Send Creating
53683>>>>>>>>>        Set piFromCreate to 1
53684>>>>>>>>>    End_Procedure
53685>>>>>>>>>
53685>>>>>>>>>    Procedure Update
53686>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
53687>>>>>>>>>        Number  nQty
53687>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53687>>>>>>>>>
53687>>>>>>>>>        Forward Send Update
53689>>>>>>>>>
53689>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
53690>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
53691>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
53692>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
53693>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
53694>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
53695>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
53696>>>>>>>>>
53696>>>>>>>>>
53696>>>>>>>>>        If (piFromCreate(Self)<>1) Begin
53698>>>>>>>>>            Add nQty to Pmoves.Pms_Qty
53699>>>>>>>>>            Saverecord Pmoves
53700>>>>>>>>>
53700>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53701>>>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
53702>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53703>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53704>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53705>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53706>>>>>>>>>            Send DoProcess          to bpEnYpol
53707>>>>>>>>>
53707>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53708>>>>>>>>>
53708>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53711>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53715>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53719>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53723>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53727>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53731>>>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53735>>>>>>>>>
53735>>>>>>>>>        End
53735>>>>>>>>>>
53735>>>>>>>>>
53735>>>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
53735>>>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
53735>>>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
53735>>>>>>>>>        // backout pou einai 3.
53735>>>>>>>>>        Move nQty to PmsSxet.Posothta
53736>>>>>>>>>
53736>>>>>>>>>
53736>>>>>>>>>        Clear Psxetika
53737>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53738>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53739>>>>>>>>>        Find Eq Psxetika by index.4
53740>>>>>>>>>>
53740>>>>>>>>>        If (Found) Begin
53742>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
53743>>>>>>>>>            Saverecord Psxetika
53744>>>>>>>>>        End
53744>>>>>>>>>>
53744>>>>>>>>>
53744>>>>>>>>>        Clear Psxetika
53745>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53746>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53747>>>>>>>>>        Find Eq Psxetika by index.4
53748>>>>>>>>>>
53748>>>>>>>>>        If (Found) Begin
53750>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
53751>>>>>>>>>            Saverecord Psxetika
53752>>>>>>>>>        End
53752>>>>>>>>>>
53752>>>>>>>>>    End_Procedure
53753>>>>>>>>>
53753>>>>>>>>>    Procedure Backout
53754>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
53755>>>>>>>>>        Number  nQty
53755>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53755>>>>>>>>>
53755>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
53756>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
53757>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
53758>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
53759>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
53760>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
53761>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
53762>>>>>>>>>
53762>>>>>>>>>        Forward Send Backout
53764>>>>>>>>>
53764>>>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
53765>>>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
53766>>>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53767>>>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53768>>>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53769>>>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53770>>>>>>>>>        Send DoProcess          to bpEnYpol
53771>>>>>>>>>
53771>>>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
53772>>>>>>>>>
53772>>>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53775>>>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53779>>>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53783>>>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53787>>>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53791>>>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53795>>>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
53799>>>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53803>>>>>>>>>
53803>>>>>>>>>        Clear Psxetika
53804>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53805>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53806>>>>>>>>>        Find Eq Psxetika by index.4
53807>>>>>>>>>>
53807>>>>>>>>>        If (Found) Begin
53809>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53810>>>>>>>>>            Saverecord Psxetika
53811>>>>>>>>>        End
53811>>>>>>>>>>
53811>>>>>>>>>
53811>>>>>>>>>        Clear Psxetika
53812>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53813>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53814>>>>>>>>>        Find Eq Psxetika by index.4
53815>>>>>>>>>>
53815>>>>>>>>>        If (Found) Begin
53817>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53818>>>>>>>>>            Saverecord Psxetika
53819>>>>>>>>>        End
53819>>>>>>>>>>
53819>>>>>>>>>    End_Procedure
53820>>>>>>>>>
53820>>>>>>>>>    Procedure Request_Save
53821>>>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53822>>>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
53822>>>>>>>>>        Number  nQty
53822>>>>>>>>>
53822>>>>>>>>>        Set piFromCreate to 0
53823>>>>>>>>>
53823>>>>>>>>>        Forward Send Request_Save
53825>>>>>>>>>
53825>>>>>>>>>        If (piFromCreate(Self)=1) Begin
53827>>>>>>>>>            Set piFromCreate                                                to 0
53828>>>>>>>>>
53828>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
53829>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
53830>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
53831>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
53832>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
53833>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
53834>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
53835>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
53836>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
53837>>>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
53838>>>>>>>>>
53838>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53839>>>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
53840>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53841>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53842>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53843>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53844>>>>>>>>>            Send DoProcess          to bpEnYpol
53845>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53846>>>>>>>>>
53846>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53849>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53853>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53857>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53861>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53865>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53869>>>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
53873>>>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53877>>>>>>>>>
53877>>>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
53878>>>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
53879>>>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
53880>>>>>>>>>            Send Make_The_Record    Of Psx_Array
53881>>>>>>>>>
53881>>>>>>>>>            // Xana vres tis eggrafes
53881>>>>>>>>>            Clear Particle
53882>>>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
53883>>>>>>>>>            Find Eq Particle by index.2
53884>>>>>>>>>>
53884>>>>>>>>>
53884>>>>>>>>>            Clear Pmoves
53885>>>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
53886>>>>>>>>>            Find Eq Pmoves by index.2
53887>>>>>>>>>>
53887>>>>>>>>>
53887>>>>>>>>>            Clear PmsSxet
53888>>>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
53889>>>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
53890>>>>>>>>>            Find Eq PmsSxet by Index.1
53891>>>>>>>>>>
53891>>>>>>>>>
53891>>>>>>>>>        End
53891>>>>>>>>>>
53891>>>>>>>>>    End_Procedure
53892>>>>>>>>>
53892>>>>>>>>>
53892>>>>>>>>>    Procedure Define_Fields
53893>>>>>>>>>        Forward Send Define_Fields
53895>>>>>>>>>        //DDB-Generated-Code-Location
53895>>>>>>>>>        //DDB-DefineFieldStart
53895>>>>>>>>>
53895>>>>>>>>>        Set Main_File            To Pmssxet.File_Number
53896>>>>>>>>>
53896>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53897>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53898>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53899>>>>>>>>>
53899>>>>>>>>>        // Parent (Server) file structure...............
53899>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
53900>>>>>>>>>
53900>>>>>>>>>        // External (System) file structure.............
53900>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
53901>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
53902>>>>>>>>>
53902>>>>>>>>>        // Field-based properties.......................
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Pms_Recr
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sxetiko_Recr
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Posothta
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Arx_Partl_Recr
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sx_Parast
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sx_Hmnia
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sx_Foreas
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sx_Arithmos
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sx_Seira
53902>>>>>>>>>
53902>>>>>>>>>        // Pmssxet.Sx_Posothta
53902>>>>>>>>>
53902>>>>>>>>>        //DDB-DefineFieldEnd
53902>>>>>>>>>    End_Procedure    // Define_Fields
53903>>>>>>>>>
53903>>>>>>>>>    Procedure Field_Defaults
53904>>>>>>>>>        Forward Send Field_Defaults
53906>>>>>>>>>        //DDB-Generated-Code-Location
53906>>>>>>>>>        //DDB-FieldDefaultStart
53906>>>>>>>>>        //DDB-FieldDefaultEnd
53906>>>>>>>>>    End_Procedure    // Field_Defaults
53907>>>>>>>>>
53907>>>>>>>>>End_Class    // Pmssxet_DataDictionary
53908>>>>>>>>>//DDB-FileEnd
53908>>>>>>>
53908>>>>>>>Class Cmoves_DataDictionary  is a DataDictionary
53909>>>>>>>
53909>>>>>>>    Procedure Construct_Object
53910>>>>>>>        Forward Send Construct_Object
53912>>>>>>>        Property Integer piFromBP           Public 0
53913>>>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
53914>>>>>>>        Property Integer piFromSysxet       Public 0   
53915>>>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
53916>>>>>>>    End_Procedure
53917>>>>>>>
53917>>>>>>>    Function Validate_Save  Returns Integer
53918>>>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
53919>>>>>>>        String sModule
53919>>>>>>>        get pifromxrhsh to ifromxrhsh
53920>>>>>>>        Forward Get Validate_Save  To iReturnVal
53922>>>>>>>        If (Not(iReturnVal)) Begin
53924>>>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
53927>>>>>>>            Clear Branch
53928>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
53929>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
53930>>>>>>>            Find Eq Branch By Index.1
53931>>>>>>>>
53931>>>>>>>            If (Not(Found)) Move 6666 to iReturnVal
53934>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
53938>>>>>>>            
53938>>>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
53940>>>>>>>                Move 10101 to iReturnVal
53941>>>>>>>            End
53941>>>>>>>>
53941>>>>>>>            Else Begin
53942>>>>>>>                
53942>>>>>>>                Move Ctypkin.Check_Overhead to iCheck
53943>>>>>>>                If (iCheck) Begin
53945>>>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
53947>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
53948>>>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
53951>>>>>>>                    End
53951>>>>>>>>
53951>>>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
53954>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
53955>>>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
53958>>>>>>>                    End
53958>>>>>>>>
53958>>>>>>>                End
53958>>>>>>>>
53958>>>>>>>                
53958>>>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
53961>>>>>>>                
53961>>>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
53964>>>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
53968>>>>>>>                
53968>>>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
53968>>>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
53972>>>>>>>                Else Begin
53973>>>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
53976>>>>>>>                    Else Begin
53977>>>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
53979>>>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
53982>>>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
53985>>>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
53988>>>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
53991>>>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
53994>>>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
53998>>>>>>>                                End
53998>>>>>>>>
53998>>>>>>>                            End
53998>>>>>>>>
53998>>>>>>>                        End
53998>>>>>>>>
53998>>>>>>>                    End
53998>>>>>>>>
53998>>>>>>>                End
53998>>>>>>>>
53998>>>>>>>            End
53998>>>>>>>>
53998>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54001>>>>>>>        End
54001>>>>>>>>
54001>>>>>>>        Function_Return iReturnVal
54002>>>>>>>    End_Function   // Validate_Save
54003>>>>>>>
54003>>>>>>>    Function Validate_Delete  Returns Integer
54004>>>>>>>        Integer iReturnVal
54005>>>>>>>        String sModule
54005>>>>>>>        Forward Get Validate_Delete  To iReturnVal
54007>>>>>>>        If (Not(iReturnVal)) Begin
54009>>>>>>>
54009>>>>>>>            Clear Branch
54010>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
54011>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
54012>>>>>>>            Find Eq Branch By Index.1
54013>>>>>>>>
54013>>>>>>>            If (Not(Found)) Move 6668 to iReturnVal
54016>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
54020>>>>>>>            
54020>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54023>>>>>>>            
54023>>>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
54026>>>>>>>            Else If (piFromBP(Self)<>1) Begin
54029>>>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
54032>>>>>>>                Else Begin
54033>>>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
54036>>>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
54039>>>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
54042>>>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
54046>>>>>>>                    End
54046>>>>>>>>
54046>>>>>>>                End
54046>>>>>>>>
54046>>>>>>>            End
54046>>>>>>>>
54046>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54049>>>>>>>        End
54049>>>>>>>>
54049>>>>>>>        Function_Return iReturnVal
54050>>>>>>>    End_Function   // Validate_Delete
54051>>>>>>>
54051>>>>>>>    Procedure Save_Main_File
54052>>>>>>>        If (Operation_Origin<>Self) Begin
54054>>>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
54057>>>>>>>        End
54057>>>>>>>>
54057>>>>>>>        If (Cmoves.Cn_Code<>'') Begin
54059>>>>>>>            Clear Cn
54060>>>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
54061>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
54062>>>>>>>>
54062>>>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
54063>>>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
54064>>>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
54065>>>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
54066>>>>>>>        End
54066>>>>>>>>
54066>>>>>>>        Else Begin
54067>>>>>>>            Move ''     to Cmoves.Sls_ID
54068>>>>>>>            Move ''     to Cmoves.Cnt_ID
54069>>>>>>>            Move ''     to Cmoves.Cn_Recr
54070>>>>>>>            Move ''     to Cmoves.Mhxanik_id
54071>>>>>>>        End
54071>>>>>>>>
54071>>>>>>>        Forward Send Save_Main_File
54073>>>>>>>    End_Procedure   // Save_Main_File
54074>>>>>>>
54074>>>>>>>
54074>>>>>>>    Procedure Update
54075>>>>>>>        String sNomisma
54076>>>>>>>        Forward Send Update
54078>>>>>>>        
54078>>>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
54080>>>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
54081>>>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
54082>>>>>>>        End
54082>>>>>>>>
54082>>>>>>>        
54082>>>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
54082>>>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
54085>>>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
54089>>>>>>>        
54089>>>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
54089>>>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
54090>>>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
54091>>>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
54092>>>>>>>
54092>>>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
54092>>>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
54095>>>>>>>
54095>>>>>>>
54095>>>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
54096>>>>>>>
54096>>>>>>>        ///an enhmeronei synolikh ofeilh pelath
54096>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
54098>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
54099>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
54100>>>>>>>        end
54100>>>>>>>>
54100>>>>>>>
54100>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
54102>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
54104>>>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
54105>>>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
54106>>>>>>>            End
54106>>>>>>>>
54106>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
54109>>>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
54110>>>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
54111>>>>>>>            End
54111>>>>>>>>
54111>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin
54113>>>>>>>                move 1 to clients.client_public  
54114>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
54115>>>>>>>                move '' to clients.status
54116>>>>>>>            end     
54116>>>>>>>>
54116>>>>>>>        End
54116>>>>>>>>
54116>>>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
54118>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
54120>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
54121>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
54122>>>>>>>            End
54122>>>>>>>>
54122>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
54125>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
54126>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
54127>>>>>>>            End
54127>>>>>>>>
54127>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin 
54129>>>>>>>                move 1 to clients.client_public
54130>>>>>>>                move '' to clients.status  
54131>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
54132>>>>>>>            end 
54132>>>>>>>>
54132>>>>>>>        End
54132>>>>>>>>
54132>>>>>>>
54132>>>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
54135>>>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
54139>>>>>>>
54139>>>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
54142>>>>>>>        Else Begin
54143>>>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
54144>>>>>>>            Move 0 to Cmoves.Axia_Sysxet
54145>>>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
54146>>>>>>>        End
54146>>>>>>>>
54146>>>>>>>
54146>>>>>>>        // js 23/01/2002
54146>>>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
54146>>>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
54146>>>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
54147>>>>>>>
54147>>>>>>>        // js 23/01/2002
54147>>>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
54147>>>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
54147>>>>>>>        // gia na emfanizei ta antistrofa sto copen
54147>>>>>>>        If (Ctypkin.Open_Item='1') Begin
54149>>>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
54151>>>>>>>                Move 1                          to Cmoves.Flag_Copen
54152>>>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
54155>>>>>>>            End
54155>>>>>>>>
54155>>>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
54158>>>>>>>                Move 2                          to Cmoves.Flag_Copen
54159>>>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
54162>>>>>>>            End
54162>>>>>>>>
54162>>>>>>>            Else Move 0 to Cmoves.Flag_Copen
54164>>>>>>>        End
54164>>>>>>>>
54164>>>>>>>        Else Move 0 to Cmoves.Flag_Copen
54166>>>>>>>    End_Procedure   // Update
54167>>>>>>>
54167>>>>>>>    Procedure Backout
54168>>>>>>>        Forward Send Backout
54170>>>>>>>
54170>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
54172>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
54173>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
54174>>>>>>>        end
54174>>>>>>>>
54174>>>>>>>
54174>>>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
54174>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
54174>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
54174>>>>>>>//        end
54174>>>>>>>
54174>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
54176>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
54178>>>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
54179>>>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
54180>>>>>>>            End
54180>>>>>>>>
54180>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
54183>>>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
54184>>>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
54185>>>>>>>            End
54185>>>>>>>>
54185>>>>>>>        End
54185>>>>>>>>
54185>>>>>>>    End_Procedure
54186>>>>>>>
54186>>>>>>>    Procedure Creating
54187>>>>>>>        Forward Send Creating
54189>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
54190>>>>>>>
54190>>>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
54190>>>>>>>
54190>>>>>>>        If (Ctypkin.Open_Item ='1') Begin
54192>>>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
54195>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
54199>>>>>>>        End
54199>>>>>>>>
54199>>>>>>>    End_Procedure   // Creating
54200>>>>>>>
54200>>>>>>>
54200>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
54201>>>>>>>        String lsError_Message
54202>>>>>>>
54202>>>>>>>        Case Begin
54202>>>>>>>            
54202>>>>>>>            Case (iError_Num = 3263)
54204>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
54205>>>>>>>            Case Break
54206>>>>>>>            
54206>>>>>>>            Case (iError_Num = 6666)
54209>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
54210>>>>>>>            Case Break
54211>>>>>>>
54211>>>>>>>            Case (iError_Num = 6667)
54214>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
54215>>>>>>>            Case Break
54216>>>>>>>
54216>>>>>>>            Case (iError_Num = 6668)
54219>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
54220>>>>>>>            Case Break
54221>>>>>>>
54221>>>>>>>            Case (iError_Num = 6669)
54224>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
54225>>>>>>>            Case Break
54226>>>>>>>
54226>>>>>>>            Case (iError_Num = 22277)
54229>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
54230>>>>>>>            Case Break
54231>>>>>>>
54231>>>>>>>            Case (iError_Num = 22278)
54234>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
54235>>>>>>>            Case Break
54236>>>>>>>
54236>>>>>>>            Case (iError_Num = 22279)
54239>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
54240>>>>>>>            Case Break
54241>>>>>>>
54241>>>>>>>            Case (iError_Num = 11170)
54244>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
54245>>>>>>>            Case Break
54246>>>>>>>
54246>>>>>>>            Case (iError_Num = 11171)
54249>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
54250>>>>>>>            Case Break
54251>>>>>>>
54251>>>>>>>            Case (iError_Num = 11172)
54254>>>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
54255>>>>>>>            Case Break
54256>>>>>>>
54256>>>>>>>            Case (iError_Num = 22288)
54259>>>>>>>                Clear Codemast
54260>>>>>>>                Move "MODULE" to Codemast.Type
54261>>>>>>>                Move Cmoves.Module_From to Codemast.Code
54262>>>>>>>                Find Eq Codemast by Index.1 //type+code
54263>>>>>>>>
54263>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
54264>>>>>>>            Case Break
54265>>>>>>>
54265>>>>>>>            Case (iError_Num = 22250)
54268>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
54269>>>>>>>            Case Break
54270>>>>>>>
54270>>>>>>>            Case (iError_Num = 22284)
54273>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
54274>>>>>>>            Case Break
54275>>>>>>>            Case (iError_Num = 22283)
54278>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
54279>>>>>>>            Case Break
54280>>>>>>>            Case (iError_Num = 22282)
54283>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
54284>>>>>>>            Case Break
54285>>>>>>>
54285>>>>>>>            //˜§æ validate delete
54285>>>>>>>            Case (iError_Num = 22289)
54288>>>>>>>                Clear Codemast
54289>>>>>>>                Move "MODULE" to Codemast.Type
54290>>>>>>>                Move Cmoves.Module_From to Codemast.Code
54291>>>>>>>                Find Eq Codemast by Index.1 //type+code
54292>>>>>>>>
54292>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
54293>>>>>>>            Case Break
54294>>>>>>>
54294>>>>>>>            Case (iError_Num = 22287)
54297>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
54298>>>>>>>            Case Break
54299>>>>>>>            Case (iError_Num = 22286)
54302>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
54303>>>>>>>            Case Break
54304>>>>>>>            Case (iError_Num = 22285)
54307>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
54308>>>>>>>            Case Break
54309>>>>>>>
54309>>>>>>>            //â¢œš®¦  open items
54309>>>>>>>            Case (iError_Num = 10101)
54312>>>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
54313>>>>>>>            Case Break
54314>>>>>>>
54314>>>>>>>            Case Else
54314>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
54316>>>>>>>        Case End
54316>>>>>>>
54316>>>>>>>        Error iError_Num lsError_Message
54317>>>>>>>>
54317>>>>>>>    End_Procedure // operation_not_allowed
54318>>>>>>>
54318>>>>>>>
54318>>>>>>>    // Define_Fields:
54318>>>>>>>    // This procedure is used to set up all data-dictionary rules.
54318>>>>>>>
54318>>>>>>>    Procedure Define_Fields
54319>>>>>>>        Forward Send Define_Fields
54321>>>>>>>        //DDB-Generated-Code-Location
54321>>>>>>>        //DDB-DefineFieldStart
54321>>>>>>>
54321>>>>>>>        Set Main_File            To Cmoves.File_Number
54322>>>>>>>        Set Cascade_Delete_State To FALSE
54323>>>>>>>
54323>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
54324>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
54325>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
54326>>>>>>>
54326>>>>>>>        // Child (Client) file structure................
54326>>>>>>>        Send Add_Client_File  Copen.File_Number
54327>>>>>>>
54327>>>>>>>        // Parent (Server) file structure...............
54327>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
54328>>>>>>>        Send Add_Server_File  Clients.File_Number
54329>>>>>>>
54329>>>>>>>        // External (System) file structure.............
54329>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
54330>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
54331>>>>>>>
54331>>>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
54334>>>>>>>
54334>>>>>>>        // Field-based properties.......................
54334>>>>>>>
54334>>>>>>>        // Cmoves.Company_Code
54334>>>>>>>
54334>>>>>>>        // Cmoves.Branch_Code
54334>>>>>>>
54334>>>>>>>        // Cmoves.Year_Year
54334>>>>>>>
54334>>>>>>>        // Cmoves.Custprom_Code
54334>>>>>>>
54334>>>>>>>        // Cmoves.Client_Id
54334>>>>>>>
54334>>>>>>>        // Cmoves.Ctypkin_Code
54334>>>>>>>
54334>>>>>>>        // Cmoves.Cmoves_Recr
54334>>>>>>>
54334>>>>>>>        // Cmoves.Cmoves_Rec0
54334>>>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
54335>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
54336>>>>>>>
54336>>>>>>>        // Cmoves.Cmoves_Hmnia
54336>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
54337>>>>>>>
54337>>>>>>>        // Cmoves.Ctypkin_Recr
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Par
54337>>>>>>>
54337>>>>>>>        // Cmoves.Partl_Recr
54337>>>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Axia
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_X0
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_P0
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_X00
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_P00
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_X1
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_P1
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_X2
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_P2
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Dlixis
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_A_Code
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Status_E
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Status_A
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_S0
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Ys0
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_S1
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Ys1
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_S2
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Ys2
54337>>>>>>>
54337>>>>>>>        // Cmoves.Cmoves_Sc_Code2
54337>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_Open
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_Aopen
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_M_Code
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_Yn_Myf
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_Myf_Axia
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_Kk
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cmoves_C_Code2
54338>>>>>>>
54338>>>>>>>        // Cmoves.Cn_Code
54338>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
54339>>>>>>>
54339>>>>>>>        // Cmoves.Client_Recr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Barticl_Recr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Qty
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Totambd0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Discam0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Totamad0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Vatam0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Extra0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Totambd00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Discam00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Totamad00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Vatam00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Extra00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Totambd1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Discam1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Totamad1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Vatam1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmove_Extra1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Module_From
54339>>>>>>>
54339>>>>>>>        // Cmoves.Parast_Abrev
54339>>>>>>>
54339>>>>>>>        // Cmoves.Enhm_Ypol_Pel
54339>>>>>>>
54339>>>>>>>        // Cmoves.Enhm_Hmnies_Pel
54339>>>>>>>
54339>>>>>>>        // Cmoves.Sls_Id
54339>>>>>>>
54339>>>>>>>        // Cmoves.Presp_Id
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cnt_Id
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Sx0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Sp0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Yx0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Yp0
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Sx1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Sp1
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Sx2
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Open_Sp2
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cmoves_Topen
54339>>>>>>>
54339>>>>>>>        // Cmoves.Cn_Recr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Pros_Sysx
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Sysxet
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Ypol_Sysx
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Pros_Sys00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Sysxet00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Ypol_Sys00
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Pros_Sysr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Sysxetr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Axia_Ypol_Sysr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Mhxanik_Id
54339>>>>>>>
54339>>>>>>>        // Cmoves.Prn_Theor
54339>>>>>>>
54339>>>>>>>        // Cmoves.Is_Closed
54339>>>>>>>
54339>>>>>>>        // Cmoves.Flag_Copen
54339>>>>>>>
54339>>>>>>>        // Cmoves.Flag_Ypol
54339>>>>>>>
54339>>>>>>>        // Cmoves.Ctypkin_Descr
54339>>>>>>>
54339>>>>>>>        // Cmoves.Client_Name
54339>>>>>>>
54339>>>>>>>        // Cmoves.Enhm_Ofeilh
54339>>>>>>>
54339>>>>>>>        // Cmoves.Sap_Hmnia
54339>>>>>>>
54339>>>>>>>        //DDB-DefineFieldEnd
54339>>>>>>>    End_Procedure    // Define_Fields
54340>>>>>>>
54340>>>>>>>    // Field_Defaults:
54340>>>>>>>    // This procedure is used to establish default field values.
54340>>>>>>>
54340>>>>>>>    Procedure Field_Defaults
54341>>>>>>>        Forward Send Field_Defaults
54343>>>>>>>        //DDB-Generated-Code-Location
54343>>>>>>>        //DDB-FieldDefaultStart
54343>>>>>>>        //DDB-FieldDefaultEnd
54343>>>>>>>    End_Procedure    // Field_Defaults
54344>>>>>>>
54344>>>>>>>End_Class    // Cmoves_DataDictionary
54345>>>>>>>//DDB-Selection-pkg-Start
54345>>>>>>>
54345>>>>>>>Use sl006.SL         // sl006
INCLUDING FILE: SL006.SL
54345>>>>>>>>>//AB/ Project sl006:Cmoves lookup
54345>>>>>>>>>//AB/ Object prj is a Lookup_Project
54345>>>>>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
54345>>>>>>>>>//AB/     Set ProjectFileName to "sl006.SL"
54345>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
54345>>>>>>>>>
54345>>>>>>>>>// Project Object Structure
54345>>>>>>>>>//   sl006 is a dbModalPanelSub
54345>>>>>>>>>//     Ctypkin_DD is a DataDictionary
54345>>>>>>>>>//     Clients_DD is a DataDictionary
54345>>>>>>>>>//     Cmoves_DD is a DataDictionary
54345>>>>>>>>>//     oSelList is a dbListSub
54345>>>>>>>>>//     oOK_bn is a ButtonSub
54345>>>>>>>>>//     oCancel_bn is a ButtonSub
54345>>>>>>>>>//     oSearch_bn is a ButtonSub
54345>>>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
54345>>>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
54345>>>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
54345>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
54345>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
54345>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
54345>>>>>>>>>//     RadioGroupSub2 is a RadioGroupSub
54345>>>>>>>>>//       Radio4 is a RadioSub
54345>>>>>>>>>//       Radio5 is a RadioSub
54345>>>>>>>>>//       Radio6 is a RadioSub
54345>>>>>>>>>
54345>>>>>>>>>// Register all objects
54345>>>>>>>>>Register_Object Clients_DD
54345>>>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
54345>>>>>>>>>Register_Object Cmoves_Axia_Sysxet
54345>>>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
54345>>>>>>>>>Register_Object Cmoves_DD
54345>>>>>>>>>Register_Object Ctypkin_DD
54345>>>>>>>>>Register_Object oCancel_bn
54345>>>>>>>>>Register_Object oOK_bn
54345>>>>>>>>>Register_Object oSearch_bn
54345>>>>>>>>>Register_Object oSelList
54345>>>>>>>>>Register_Object Radio4
54345>>>>>>>>>Register_Object Radio5
54345>>>>>>>>>Register_Object Radio6
54345>>>>>>>>>Register_Object RadioGroupSub2
54345>>>>>>>>>Register_Object sl006
54345>>>>>>>>>Register_Object TextBoxSub1
54345>>>>>>>>>Register_Object TextBoxSub2
54345>>>>>>>>>Register_Object TextBoxSub3
54345>>>>>>>>>
54345>>>>>>>>>
54345>>>>>>>>>//AB-IgnoreStart
54345>>>>>>>>>
54345>>>>>>>>>Use DFAllEnt.pkg
54345>>>>>>>>>Use dbList.Sub
54345>>>>>>>>>Use Button.Sub
54345>>>>>>>>>Use dbForm.Sub
54345>>>>>>>>>Use Txtbox.Sub
54345>>>>>>>>>Use Rgroup.Sub
54345>>>>>>>>>Use Radio.Sub
54345>>>>>>>>>
54345>>>>>>>>>
54345>>>>>>>>>Use CTYPKIN.DD
54345>>>>>>>>>Use CLIENTS.DD
54345>>>>>>>>>Use CMOVES.DD
54345>>>>>>>>>
54345>>>>>>>>>//AB-IgnoreEnd
54345>>>>>>>>>
54345>>>>>>>>>Object sl006 is a dbModalPanelSub
54347>>>>>>>>>
54347>>>>>>>>>    //AB-StoreTopStart
54347>>>>>>>>>                                        
54347>>>>>>>>>    Property String     psModule    Public ''
54349>>>>>>>>>    Property String     psClientID  Public ''
54351>>>>>>>>>    Property Date       pdApo       public ''
54353>>>>>>>>>    Property Date       pdEos       public ''
54355>>>>>>>>>    Property Integer    piXr_Or_Pi  public  0
54357>>>>>>>>>    Property Integer    piWhat      public  0
54359>>>>>>>>>    
54359>>>>>>>>>    //AB-StoreTopEnd
54359>>>>>>>>>
54359>>>>>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
54360>>>>>>>>>    Set Size to 270 519
54361>>>>>>>>>    Set Location to 5 7
54362>>>>>>>>>    Set Exit_Application_Local_State to FALSE
54363>>>>>>>>>    Set Modal_State to FALSE
54364>>>>>>>>>
54364>>>>>>>>>    //AB-DDOStart
54364>>>>>>>>>
54364>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
54366>>>>>>>>>    End_Object    // Ctypkin_DD
54367>>>>>>>>>
54367>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
54369>>>>>>>>>    End_Object    // Clients_DD
54370>>>>>>>>>
54370>>>>>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
54372>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
54373>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
54374>>>>>>>>>
54374>>>>>>>>>        //AB-StoreStart
54374>>>>>>>>>        
54374>>>>>>>>>        Begin_Constraints
54376>>>>>>>>>        
54376>>>>>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
54378>>>>>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
54380>>>>>>>>>        
54380>>>>>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
54384>>>>>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
54388>>>>>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
54392>>>>>>>>>        
54392>>>>>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
54394>>>>>>>>>        
54394>>>>>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
54398>>>>>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
54403>>>>>>>>>        
54403>>>>>>>>>        End_Constraints
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        
54406>>>>>>>>>        //AB-StoreEnd
54406>>>>>>>>>
54406>>>>>>>>>    End_Object    // Cmoves_DD
54407>>>>>>>>>
54407>>>>>>>>>    Set Main_DD to (Cmoves_DD(self))
54408>>>>>>>>>    Set Server to (Cmoves_DD(self))
54409>>>>>>>>>
54409>>>>>>>>>    //AB-DDOEnd
54409>>>>>>>>>
54409>>>>>>>>>    Object oSelList is a dbListSub
54411>>>>>>>>>
54411>>>>>>>>>        //AB-StoreTopStart
54411>>>>>>>>>                                                                                                                                                                                                                                                                                                                            
54411>>>>>>>>>        //AB-StoreTopEnd
54411>>>>>>>>>
54411>>>>>>>>>        Set Main_File to Cmoves.File_Number
54412>>>>>>>>>        Set Ordering to 4
54413>>>>>>>>>        Set Size to 199 505
54414>>>>>>>>>        Set Location to 31 7
54415>>>>>>>>>        Set Auto_Index_State to FALSE
54416>>>>>>>>>
54416>>>>>>>>>        Begin_Row
54419>>>>>>>>>            Entry_Item Cmoves.Cmoves_hmnia
54420>>>>>>>>>            Entry_Item Cmoves.Cmoves_par
54421>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
54422>>>>>>>>>            Entry_Item Clients.Client_name
54423>>>>>>>>>            Entry_Item Cmoves.Cmoves_axia
54424>>>>>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
54425>>>>>>>>>            Entry_Item Cmoves.Branch_code
54426>>>>>>>>>        End_Row
54431>>>>>>>>>
54431>>>>>>>>>        Set Form_Width    item 0 to 57
54432>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
54433>>>>>>>>>        
54433>>>>>>>>>        Set Form_Width    item 1 to 121
54434>>>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
54435>>>>>>>>>        
54435>>>>>>>>>        Set Form_Width    item 2 to 65
54436>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
54437>>>>>>>>>        
54437>>>>>>>>>        Set Form_Width    item 3 to 107
54438>>>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
54439>>>>>>>>>        
54439>>>>>>>>>        Set Form_Width    item 4 to 63
54440>>>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
54441>>>>>>>>>        
54441>>>>>>>>>        Set Form_Width    item 5 to 42
54442>>>>>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
54443>>>>>>>>>        
54443>>>>>>>>>        Set Form_Width    item 6 to 45
54444>>>>>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
54445>>>>>>>>>        
54445>>>>>>>>>
54445>>>>>>>>>        //AB-StoreStart
54445>>>>>>>>>                                                                                                                                                                                                                                                                                                                            
54445>>>>>>>>>        Procedure End_Construct_Object
54447>>>>>>>>>            String  sNom
54448>>>>>>>>>            Integer iDecs
54448>>>>>>>>>            Forward Send End_Construct_Object
54450>>>>>>>>>            Move SysCurxr.C_Code0 to sNom
54451>>>>>>>>>            Clear Nomisma
54452>>>>>>>>>            Move sNom to Nomisma.Nomisma_Code
54453>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
54454>>>>>>>>>>
54454>>>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
54457>>>>>>>>>            Else            Move 0 to iDecs
54459>>>>>>>>>        
54459>>>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
54459>>>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
54459>>>>>>>>>            If (iDecs=0) Move 2 to iDecs
54462>>>>>>>>>            //
54462>>>>>>>>>        
54462>>>>>>>>>            Set Points          Item 4 to       iDecs
54463>>>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
54464>>>>>>>>>        End_Procedure
54465>>>>>>>>>        
54465>>>>>>>>>        
54465>>>>>>>>>        
54465>>>>>>>>>        
54465>>>>>>>>>        
54465>>>>>>>>>        //AB-StoreEnd
54465>>>>>>>>>
54465>>>>>>>>>    End_Object    // oSelList
54466>>>>>>>>>
54466>>>>>>>>>    Object oOK_bn is a ButtonSub
54468>>>>>>>>>        Set Label to "&„§ ¢¦šã"
54469>>>>>>>>>        Set Location to 236 350
54470>>>>>>>>>
54470>>>>>>>>>        //AB-StoreStart
54470>>>>>>>>>        Procedure OnClick
54472>>>>>>>>>            Send OK To (oSelList(current_object))
54473>>>>>>>>>        End_Procedure
54474>>>>>>>>>        //AB-StoreEnd
54474>>>>>>>>>
54474>>>>>>>>>    End_Object    // oOK_bn
54475>>>>>>>>>
54475>>>>>>>>>    Object oCancel_bn is a ButtonSub
54477>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
54478>>>>>>>>>        Set Location to 236 404
54479>>>>>>>>>
54479>>>>>>>>>        //AB-StoreStart
54479>>>>>>>>>        Procedure OnClick
54481>>>>>>>>>            Send Cancel To (oSelList(current_object))
54482>>>>>>>>>        End_Procedure
54483>>>>>>>>>        //AB-StoreEnd
54483>>>>>>>>>
54483>>>>>>>>>    End_Object    // oCancel_bn
54484>>>>>>>>>
54484>>>>>>>>>    Object oSearch_bn is a ButtonSub
54486>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
54487>>>>>>>>>        Set Location to 236 460
54488>>>>>>>>>
54488>>>>>>>>>        //AB-StoreStart
54488>>>>>>>>>        Procedure OnClick
54490>>>>>>>>>            Send Search To (oSelList(current_object))
54491>>>>>>>>>        End_Procedure
54492>>>>>>>>>        //AB-StoreEnd
54492>>>>>>>>>
54492>>>>>>>>>    End_Object    // oSearch_bn
54493>>>>>>>>>
54493>>>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
54495>>>>>>>>>        Entry_Item Cmoves.Axia_pros_sysx
54496>>>>>>>>>        Set Size to 13 54
54497>>>>>>>>>        Set Location to 236 24
54498>>>>>>>>>        Set Color to clBtnFace
54499>>>>>>>>>        Set Label_Col_Offset to 2
54500>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
54501>>>>>>>>>        Set Enabled_State to FALSE
54502>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
54503>>>>>>>>>        Set Shadow_State Item 0 to TRUE
54504>>>>>>>>>
54504>>>>>>>>>        //AB-StoreStart
54504>>>>>>>>>        Set points item 0 to 2
54505>>>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
54506>>>>>>>>>        
54506>>>>>>>>>        //AB-StoreEnd
54506>>>>>>>>>
54506>>>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
54507>>>>>>>>>
54507>>>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
54509>>>>>>>>>        Entry_Item Cmoves.Axia_sysxet
54510>>>>>>>>>        Set Size to 13 54
54511>>>>>>>>>        Set Location to 236 140
54512>>>>>>>>>        Set Color to clBtnFace
54513>>>>>>>>>        Set Label_Col_Offset to 2
54514>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
54515>>>>>>>>>        Set Enabled_State to FALSE
54516>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
54517>>>>>>>>>        Set Shadow_State Item 0 to TRUE
54518>>>>>>>>>
54518>>>>>>>>>        //AB-StoreStart
54518>>>>>>>>>        Set points item 0 to 2
54519>>>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
54520>>>>>>>>>        
54520>>>>>>>>>        //AB-StoreEnd
54520>>>>>>>>>
54520>>>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
54521>>>>>>>>>
54521>>>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
54523>>>>>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
54524>>>>>>>>>        Set Size to 13 54
54525>>>>>>>>>        Set Location to 236 248
54526>>>>>>>>>        Set Color to clBtnFace
54527>>>>>>>>>        Set Label_Col_Offset to 2
54528>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
54529>>>>>>>>>        Set Enabled_State to FALSE
54530>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
54531>>>>>>>>>        Set Shadow_State Item 0 to TRUE
54532>>>>>>>>>
54532>>>>>>>>>        //AB-StoreStart
54532>>>>>>>>>                                                                                                    
54532>>>>>>>>>        Set points item 0 to 2
54533>>>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
54534>>>>>>>>>        
54534>>>>>>>>>        //AB-StoreEnd
54534>>>>>>>>>
54534>>>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
54535>>>>>>>>>
54535>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
54537>>>>>>>>>        Set Label to "€¥å˜"
54538>>>>>>>>>        Set Location to 238 7
54539>>>>>>>>>        Set Size to 10 15
54540>>>>>>>>>    End_Object    // TextBoxSub1
54541>>>>>>>>>
54541>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
54543>>>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
54544>>>>>>>>>        Set Location to 238 89
54545>>>>>>>>>        Set Size to 10 49
54546>>>>>>>>>    End_Object    // TextBoxSub2
54547>>>>>>>>>
54547>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
54549>>>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
54550>>>>>>>>>        Set Location to 238 210
54551>>>>>>>>>        Set Size to 10 35
54552>>>>>>>>>    End_Object    // TextBoxSub3
54553>>>>>>>>>
54553>>>>>>>>>    Object RadioGroupSub2 is a RadioGroupSub
54555>>>>>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
54556>>>>>>>>>        Set Size to 24 497
54557>>>>>>>>>        Set Location to 3 9
54558>>>>>>>>>        Object Radio4 is a RadioSub
54560>>>>>>>>>            Set Label to "Ž¢œª"
54561>>>>>>>>>            Set Size to 10 37
54562>>>>>>>>>            Set Location to 10 97
54563>>>>>>>>>        End_Object    // Radio4
54564>>>>>>>>>
54564>>>>>>>>>        Object Radio5 is a RadioSub
54566>>>>>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
54567>>>>>>>>>            Set Size to 10 97
54568>>>>>>>>>            Set Location to 10 167
54569>>>>>>>>>        End_Object    // Radio5
54570>>>>>>>>>
54570>>>>>>>>>        Object Radio6 is a RadioSub
54572>>>>>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
54573>>>>>>>>>            Set Size to 10 111
54574>>>>>>>>>            Set Location to 10 278
54575>>>>>>>>>        End_Object    // Radio6
54576>>>>>>>>>
54576>>>>>>>>>
54576>>>>>>>>>        //AB-StoreStart
54576>>>>>>>>>                                                                                        
54576>>>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
54578>>>>>>>>>            Set piWhat to iToItem
54579>>>>>>>>>            Send Rebuild_Constraints to Cmoves_DD
54580>>>>>>>>>            Send Beginning_Of_Data To oSelList True
54581>>>>>>>>>        End_Procedure
54582>>>>>>>>>        
54582>>>>>>>>>        Set Current_Radio to 1
54583>>>>>>>>>        
54583>>>>>>>>>        
54583>>>>>>>>>        
54583>>>>>>>>>        
54583>>>>>>>>>        //AB-StoreEnd
54583>>>>>>>>>
54583>>>>>>>>>    End_Object    // RadioGroupSub2
54584>>>>>>>>>
54584>>>>>>>>>
54584>>>>>>>>>    //AB-StoreStart
54584>>>>>>>>>                                        
54584>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
54585>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
54586>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
54587>>>>>>>>>    
54587>>>>>>>>>    Set Modal_State to True
54588>>>>>>>>>    
54588>>>>>>>>>    Procedure Activate
54590>>>>>>>>>        String  sNom
54591>>>>>>>>>        Integer iDecs rVal
54591>>>>>>>>>        Set piWhat to 1
54592>>>>>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
54593>>>>>>>>>        Forward Send Activate
54595>>>>>>>>>        Send Rebuild_Constraints        to Cmoves_DD
54596>>>>>>>>>        Send Beginning_Of_Data          to oSelList True
54597>>>>>>>>>    End_procedure
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    
54598>>>>>>>>>    //AB-StoreEnd
54598>>>>>>>>>
54598>>>>>>>>>End_Object    // sl006
54599>>>>>>>>>
54599>>>>>>>>>//AB/ End_Object    // prj
54599>>>>>>>Use slnomism.sl      // slNomism
54599>>>>>>>Use sl041.SL         // sl041
54599>>>>>>>
54599>>>>>>>//DDB-Selection-pkg-End
54599>>>>>>>//DDB-FileEnd
54599>>>>>    Use CFLAGKIN.DD
INCLUDING FILE: CFLAGKIN.DD
54599>>>>>>>//DDB-FileStart
54599>>>>>>>//DDB-HeaderStart
54599>>>>>>>
54599>>>>>>>// File Name : CFLAGKIN.DD
54599>>>>>>>// Class Name: Cflagkin_DataDictionary
54599>>>>>>>// Revision  : 28
54599>>>>>>>// Version   : 2
54599>>>>>>>
54599>>>>>>>Use  Windows           // Basic Definitions
54599>>>>>>>Use  DataDict          // DataDictionary Class Definition
54599>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
54599>>>>>>>
54599>>>>>>>Open Cflagkin
54601>>>>>>>Open Ctypkin
54603>>>>>>>Open Sysrecc
54605>>>>>>>Open Syscurxr
54607>>>>>>>
54607>>>>>>>//DDB-HeaderEnd
54607>>>>>>>//DDB-ValidationStart
54607>>>>>>>
54607>>>>>>>Register_Object Cflagkin_Flag
54607>>>>>>>
54607>>>>>>>Object Cflagkin_Flag  is a CodeValidationTable
54609>>>>>>>    Set Type_Value        To "CFLAGS"
54610>>>>>>>    //DDB-ValidationCustomStart
54610>>>>>>>    //DDB-ValidationCustomEnd
54610>>>>>>>End_Object   // Cflagkin_Flag
54611>>>>>>>//DDB-ValidationEnd
54611>>>>>>>
54611>>>>>>>Class Cflagkin_DataDictionary  is a DataDictionary
54612>>>>>>>
54612>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
54613>>>>>>>        String lsError_Message
54614>>>>>>>        Case Begin
54614>>>>>>>            Case (iError_Num = 7001)
54616>>>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags ˜¤à «à¤ 2 ¯ž­åà¤" to lsError_Message
54617>>>>>>>            Case Break
54618>>>>>>>            Case (iError_Num = 7002)
54621>>>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags £ž›œ¤ ¡á" to lsError_Message
54622>>>>>>>            Case Break
54623>>>>>>>            Case Else
54623>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
54625>>>>>>>        Case End
54625>>>>>>>        Error iError_Num lsError_Message
54626>>>>>>>>
54626>>>>>>>    End_Procedure // operation_not_allowed
54627>>>>>>>
54627>>>>>>>    Function Validate_Save  Returns Integer
54628>>>>>>>        Integer iReturnVal
54629>>>>>>>        Forward Get Validate_Save  To iReturnVal
54631>>>>>>>        If (Not(iReturnVal)) Begin
54633>>>>>>>                 If (Length(Trim(Cflagkin.Cflagkin_Flag))>2)    Move 7001 to iReturnVal
54636>>>>>>>            Else If (Cflagkin.Flag_Numeric=0)                   Move 7002 to iReturnVal
54640>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54643>>>>>>>        End
54643>>>>>>>>
54643>>>>>>>        Function_Return iReturnVal
54644>>>>>>>    End_Function   // Validate_Save
54645>>>>>>>
54645>>>>>>>    Procedure Update
54646>>>>>>>        Forward Send Update
54648>>>>>>>        // Insert Code Here
54648>>>>>>>//        Move SysCurXR.Company_Code  to Cflagkin.Company_Code
54648>>>>>>>//        Move SysCurXR.Branch_Code   to Cflagkin.Branch_Code
54648>>>>>>>//        Move SysCurXR.Year_Year     to Cflagkin.Year_Year
54648>>>>>>>        Move Ctypkin.Ctypkin_Code   to Cflagkin.Ctypkin_Code
54649>>>>>>>        Move Cflagkin.Cflagkin_Flag to Cflagkin.Flag_Numeric
54650>>>>>>>    End_Procedure   // Update
54651>>>>>>>
54651>>>>>>>    Procedure Creating
54652>>>>>>>        Forward Send Creating
54654>>>>>>>        // Insert Code Here
54654>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
54655>>>>>>>    End_Procedure   // Creating
54656>>>>>>>
54656>>>>>>>    // Define_Fields:
54656>>>>>>>    // This procedure is used to set up all data-dictionary rules.
54656>>>>>>>
54656>>>>>>>    Procedure Define_Fields
54657>>>>>>>        Forward Send Define_Fields
54659>>>>>>>        //DDB-Generated-Code-Location
54659>>>>>>>        //DDB-DefineFieldStart
54659>>>>>>>
54659>>>>>>>        Set Main_File            To Cflagkin.File_Number
54660>>>>>>>        Set Cascade_Delete_State To FALSE
54661>>>>>>>
54661>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
54662>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
54663>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
54664>>>>>>>
54664>>>>>>>        // Parent (Server) file structure...............
54664>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
54665>>>>>>>
54665>>>>>>>        // External (System) file structure.............
54665>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
54666>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
54667>>>>>>>
54667>>>>>>>        Define_Auto_Increment  Sysrecc.Cflagkin_Rec0  To Cflagkin.Cflagkin_Rec0
54670>>>>>>>
54670>>>>>>>        // Field-based properties.......................
54670>>>>>>>
54670>>>>>>>        // Cflagkin.Company_Code
54670>>>>>>>
54670>>>>>>>        // Cflagkin.Branch_Code
54670>>>>>>>
54670>>>>>>>        // Cflagkin.Year_Year
54670>>>>>>>
54670>>>>>>>        // Cflagkin.Ctypkin_Code
54670>>>>>>>
54670>>>>>>>        // Cflagkin.Cflagkin_Flag
54670>>>>>>>        Set Field_Value_Table      Field Cflagkin.Cflagkin_Flag To (Cflagkin_Flag(Self))
54671>>>>>>>
54671>>>>>>>        // Cflagkin.Ctypkin_Recr
54671>>>>>>>
54671>>>>>>>        // Cflagkin.Cflagkin_Descr
54671>>>>>>>
54671>>>>>>>        // Cflagkin.Cflagkin_Rec0
54671>>>>>>>        Set Field_Options          Field Cflagkin.Cflagkin_Rec0 To DD_AUTOFIND   
54672>>>>>>>
54672>>>>>>>        // Cflagkin.Cflagkin_Recr
54672>>>>>>>
54672>>>>>>>        // Cflagkin.Flag_Numeric
54672>>>>>>>
54672>>>>>>>        //DDB-DefineFieldEnd
54672>>>>>>>    End_Procedure    // Define_Fields
54673>>>>>>>
54673>>>>>>>    // Field_Defaults:
54673>>>>>>>    // This procedure is used to establish default field values.
54673>>>>>>>
54673>>>>>>>    Procedure Field_Defaults
54674>>>>>>>        Forward Send Field_Defaults
54676>>>>>>>        //DDB-Generated-Code-Location
54676>>>>>>>        //DDB-FieldDefaultStart
54676>>>>>>>        //DDB-FieldDefaultEnd
54676>>>>>>>    End_Procedure    // Field_Defaults
54677>>>>>>>
54677>>>>>>>End_Class    // Cflagkin_DataDictionary
54678>>>>>>>//DDB-FileEnd
54678>>>>>    Use BTYPKIN.DD
54678>>>>>    Use BAXIOKAT.DD
54678>>>>>    Use BARTICL.DD
54678>>>>>    Use BAXIO.DD
54678>>>>>    Use BMOVE.DD
54678>>>>>    Use NOMISMA.DD
54678>>>>>
54678>>>>>    //AB-IgnoreEnd
54678>>>>>
54678>>>>>    Object bpencmv3 is a BusinessProcessSub
54680>>>>>
54680>>>>>        //AB-StoreTopStart
54680>>>>>        Property String      psModule        Public ''
54682>>>>>        Property String      psBarticleRecr  Public ''
54684>>>>>        Property String      psCmovesRecr    Public ''
54686>>>>>        Property Integer     piWithDeletion  Public  0
54688>>>>>        Property Integer     piLathos        Public  0
54690>>>>>        Property Integer     piTxtID         Public  0
54692>>>>>        Property String      piBarticleRecn  Public  0
54694>>>>>
54694>>>>>
54694>>>>>        ////////////////////////////////////////////////////////////
54694>>>>>        /////////// Extra Data Set Needed For Finding //////////////
54694>>>>>        /////////// Incoming Bmove Record             //////////////
54694>>>>>        ////////////////////////////////////////////////////////////
54694>>>>>
54694>>>>>        Set Status_Panel_State to False
54695>>>>>        //Set Allow_Cancel_State  to True
54695>>>>>        Set Display_Error_State to True
54696>>>>>        //Set Process_Title to "               "
54696>>>>>        //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
54696>>>>>        //Set Status_log_state to True
54696>>>>>
54696>>>>>        //AB-StoreTopEnd
54696>>>>>
54696>>>>>        Set Size        to 58 88
54697>>>>>        Set Location    to 18 52
54698>>>>>
54698>>>>>        //AB-DDOStart
54698>>>>>
54698>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
54700>>>>>        End_Object    // Ctypkin_DD
54701>>>>>
54701>>>>>        Object Country_DD is a Country_DataDictionary
54703>>>>>        End_Object    // Country_DD
54704>>>>>
54704>>>>>        Object Towns_DD is a Towns_DataDictionary
54706>>>>>            Set DDO_Server to (Country_DD(self))
54707>>>>>        End_Object    // Towns_DD
54708>>>>>
54708>>>>>        Object Cities_DD is a Cities_DataDictionary
54710>>>>>            Set DDO_Server to (Towns_DD(self))
54711>>>>>        End_Object    // Cities_DD
54712>>>>>
54712>>>>>        Object Payresp_DD is a Payresp_DataDictionary
54714>>>>>        End_Object    // Payresp_DD
54715>>>>>
54715>>>>>        Object Areas_DD is a Areas_DataDictionary
54717>>>>>        End_Object    // Areas_DD
54718>>>>>
54718>>>>>        Object Clients_DD is a Clients_DataDictionary
54720>>>>>            Set DDO_Server to (Cities_DD(self))
54721>>>>>            Set DDO_Server to (Payresp_DD(self))
54722>>>>>            Set DDO_Server to (Areas_DD(self))
54723>>>>>        End_Object    // Clients_DD
54724>>>>>
54724>>>>>        Object Cmoves_DD is a Cmoves_DataDictionary
54726>>>>>            Set DDO_Server  to (Ctypkin_DD(self))
54727>>>>>            Set DDO_Server  to (Clients_DD(self))
54728>>>>>            Set piFromBP    to 1
54729>>>>>        End_Object    // Cmoves_DD
54730>>>>>
54730>>>>>        Object Cflagkin_DD is a Cflagkin_DataDictionary
54732>>>>>            Set DDO_Server to (Ctypkin_DD(self))
54733>>>>>        End_Object    // Cflagkin_DD
54734>>>>>
54734>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
54736>>>>>        End_Object    // Btypkin_DD
54737>>>>>
54737>>>>>        Object Baxiokat_DD is a Baxiokat_DataDictionary
54739>>>>>        End_Object    // Baxiokat_DD
54740>>>>>
54740>>>>>        Object Barticl_DD is a Barticl_DataDictionary
54742>>>>>            Set DDO_Server to (Btypkin_DD(self))
54743>>>>>        End_Object    // Barticl_DD
54744>>>>>
54744>>>>>        Object Baxio_DD is a Baxio_DataDictionary
54746>>>>>            Set DDO_Server to (Baxiokat_DD(self))
54747>>>>>        End_Object    // Baxio_DD
54748>>>>>
54748>>>>>        Object Bmove_DD is a Bmove_DataDictionary
54750>>>>>            Set DDO_Server to (Barticl_DD(self))
54751>>>>>            Set DDO_Server to (Baxio_DD(self))
54752>>>>>            Set Constrain_File to Barticl.File_Number
54753>>>>>        End_Object    // Bmove_DD
54754>>>>>
54754>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
54756>>>>>        End_Object    // Nomisma_DD
54757>>>>>
54757>>>>>        //AB-DDOEnd
54757>>>>>
54757>>>>>
54757>>>>>        //AB-StoreStart
54757>>>>>
54757>>>>>        Function fiDelete_Cmoves_Record String asRecr Integer aiDelete Returns Integer
54759>>>>>            Integer rVal iErr
54760>>>>>            date dsaphmnia
54760>>>>>            Move 0 to rVal
54761>>>>>            Send Clear to Cmoves_DD
54762>>>>>            Move asRecr to Cmoves.Cmoves_Recr
54763>>>>>            Send Find to Cmoves_DD eq 2 //Cmoves:Index.2:Cmoves_Recr
54764>>>>>            If (Found=1) Begin
54766>>>>>                If (aiDelete) Begin
54768>>>>>                    Send UpdateWait to (Wait(Self))  ('ƒ ˜š¨˜­ã ‰å¤ž©žª '+(String(Cmoves.Recnum)))
54769>>>>>                    Get Field_Current_Value Of Cmoves_DD Field Cmoves.sap_hmnia to dsaphmnia
54770>>>>>                    if (dsaphmnia gt '01/01/1980') ;                        error 6063 '„®œ  œ¤ž£œ¨àŸœå SAP! ƒœ¤ œ¡¢œ ›é¤œ  !!'
54773>>>>>                    Else;                        Send Request_Delete to Cmoves_DD
54775>>>>>                End
54775>>>>>>
54775>>>>>            End
54775>>>>>>
54775>>>>>            Else Begin
54776>>>>>                Move 60003 to rVal
54777>>>>>                // If From Deletion and Could not find Cmoves with Barticle_Cmoves_Recr set piLathos
54777>>>>>                If (aiDelete) error 6003 "ƒœ¤ ™¨âŸž¡œ Cmoves £œ «¦ Cmoves Recr «¦¬ §˜¨˜©«˜« ¡¦ç"
54780>>>>>            End
54780>>>>>>
54780>>>>>            Function_Return rVal
54781>>>>>        End_Function
54782>>>>>
54782>>>>>        Procedure Deal_With_Barticle
54784>>>>>            Integer iErr isClosed iInt iWithDeletion iSign iClient iID iMustSaveClientYpoloipa
54785>>>>>            Integer iEpireazeiAxies iMustEnhmWitemcl  iEpireazeiPosothtes iAntistrofhProshmou iBmoveRec0
54785>>>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iExeiSxetika iBmoveRecnum iMustSaveEpisf
54785>>>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag iAnti iiBarticleNO iMustsaveofeilh
54785>>>>>
54785>>>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort sPelaths
54785>>>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code sSls_ID sCnt_ID sPresp_ID
54785>>>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr sItem sLocked sModule sBmoveRecr
54785>>>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr ssBtypkinDescrShort
54785>>>>>
54785>>>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia nUnitPrice nGSynolo
54785>>>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd nActualXreosh nActualPistosh
54785>>>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6 nParastXreosh nParastPistosh
54785>>>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8 nPosothtaFinal nXreFinal nPisFinal
54785>>>>>            Number  nApait nEpitPoso nofeilh nofeilhpayresp napaitpayresp
54785>>>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
54785>>>>>
54785>>>>>            Number nQtyEisFinal nQtyExFinal nQtyEis nQtyEx nJS
54785>>>>>
54785>>>>>
54785>>>>>            Get psBarticleRecr  to sRecr
54786>>>>>            Move (Trim(sRecr))  to sRecr
54787>>>>>            Send Clear          to Barticl_DD
54788>>>>>            Move srecr          to Barticl.Barticl_Recr
54789>>>>>            Send Find to Barticl_DD Eq 2 // Barticl:Index.2:Barticl_Recr
54790>>>>>// todo: 25/06/2002 Logo tou find ktypaei to gamhmeno mhnyma otan kleinei h efarmogh
54790>>>>>// omos kammia allagh me opoiadhpote tropopoihsh tou kodika, eite kanoume manual find prota,
54790>>>>>// eite find_by_recnum. Opoiadhpote find mh procedural ektelestei exei to idio apotelesma
54790>>>>>
54790>>>>>//          Send Find_By_Recnum to Barticl_DD Barticl.File_Number (piBarticleRecn(Self))
54790>>>>>
54790>>>>>            If (Found=1) Begin
54792>>>>>                Get Field_Current_Value Of Btypkin_DD Field Btypkin.Btypkin_anti1   to iAnti
54793>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.Barticl_Ekleise to isClosed
54794>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.CN_Code         to sCN_Code
54795>>>>>
54795>>>>>                If (isClosed) Begin
54797>>>>>                    Move 0 to iExitFlag
54798>>>>>
54798>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
54799>>>>>                    While ((Found=1) And (iExitFlag=0))
54803>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
54804>>>>>                        Move (Trim(sRecr2)) to sRecr2
54805>>>>>                        If (Not(sRecr2='')) Move (fiDelete_Cmoves_Record(Self,sRecr2,1))  to iInt2
54808>>>>>                        Else                Move 0 to iInt2
54810>>>>>
54810>>>>>                        Send Clear to Ctypkin_DD
54811>>>>>                        Get Field_Current_Value Of Btypkin_DD Field Btypkin.Ctypkin_Recr to sCtypkinRecr
54812>>>>>                        Move 0 to iMustSaveEpisf
54813>>>>>                        Clear Cflagkin
54814>>>>>                        Move sCtypkinRecr to Cflagkin.Ctypkin_Recr
54815>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54816>>>>>>
54816>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
54820>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
54821>>>>>                            Move (Trim(sFlag)) to sFlag
54822>>>>>                                 If (sFlag='60') Move 1 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Thetika
54825>>>>>                            Else If (sFlag='61') Move 2 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Arnhtika
54829>>>>>                            Else If (sflag='66') Move 1 to iMustsaveofeilh  // enhmerovnei synolikh ofeilh
54833>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54834>>>>>>
54834>>>>>                        Loop
54835>>>>>>
54835>>>>>
54835>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
54837>>>>>                            Move 0  to nApait
54838>>>>>                            Move 0  to nEpitPoso
54839>>>>>                            Move 0  to nofeilh
54840>>>>>                            Move 0  to nofeilhpayresp
54841>>>>>                            Move 0  to napaitpayresp
54842>>>>>                            Move '' to sPelaths
54843>>>>>
54843>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
54843>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
54844>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
54845>>>>>
54845>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
54845>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
54845>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
54845>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
54845>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
54848>>>>>                            // js 13/03/2003
54848>>>>>
54848>>>>>                            Send Clear to Clients_DD
54849>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
54850>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
54851>>>>>                            If (Found=1) Begin
54853>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
54854>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
54855>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
54856>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
54857>>>>>
54857>>>>>                                If (iMustSaveofeilh=1)  Begin
54859>>>>>//                                    Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nepitposo+nofeilh)
54859>>>>>//                                    Send Request_Save to Clients_DD
54859>>>>>//                                    Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nepitposo+nofeilhpayresp)
54859>>>>>//                                    Send Request_Save to payresp_DD
54859>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
54861>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
54862>>>>>                                        Send Request_Save to Clients_DD
54863>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
54864>>>>>                                        Send Request_Save to payresp_DD
54865>>>>>                                    End
54865>>>>>>
54865>>>>>                                    Else Begin
54866>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
54867>>>>>                                        Send Request_Save to Clients_DD
54868>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
54869>>>>>                                        Send Request_Save to payresp_DD
54870>>>>>                                    End
54870>>>>>>
54870>>>>>                                End
54870>>>>>>
54870>>>>>
54870>>>>>                                If (iMustSaveEpisf=1)  Begin
54872>>>>>                                    Sub nEpitPoso from nApait
54873>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
54874>>>>>                                    Send Request_Save to Clients_DD
54875>>>>>                                    Sub nepitposo from napaitpayresp
54876>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
54877>>>>>                                    Send Request_Save to payresp_DD
54878>>>>>                                End
54878>>>>>>
54878>>>>>                                Else If (iMustSaveEpisf=2)  Begin
54881>>>>>                                    Sub (nEpitPoso*(-1)) to nApait
54882>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
54883>>>>>                                    Send Request_Save to Clients_DD
54884>>>>>                                    Sub (nEpitPoso*(-1)) to nApaitpayresp
54885>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
54886>>>>>                                    Send Request_Save to payresp_DD
54887>>>>>                                End
54887>>>>>>
54887>>>>>                            End
54887>>>>>>
54887>>>>>                            Else Begin
54888>>>>>                            End
54888>>>>>>
54888>>>>>                        End
54888>>>>>>
54888>>>>>
54888>>>>>                        If (iInt2<>0) Move iInt2 to iExitFlag
54891>>>>>                        Else Begin
54892>>>>>                            Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
54893>>>>>                            Set Field_Changed_Value Of Bmove_DD Field Bmove.Cmoves_Recr to ''
54894>>>>>                            Send Request_Save to Bmove_DD
54895>>>>>                        End
54895>>>>>>
54895>>>>>                        Send Find To Bmove_DD Next_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
54896>>>>>                    Loop
54897>>>>>>
54897>>>>>
54897>>>>>
54897>>>>>
54897>>>>>                    If (iExitFlag) Move iExitFlag   to iInt2
54900>>>>>                    Else           Move 0           to iInt2
54902>>>>>
54902>>>>>                    If (Not(iInt2)) Begin
54904>>>>>                        // €¤ ›œ¤ ®«¬§ž©œ ¢˜Ÿ¦ª ¡˜«˜ «ž¤ › ˜š¨˜­ž ¡˜  › œš¨˜­œ  ©à©«˜ «¦ Cmoves ¡˜  «¦ Wcmoves record
54904>>>>>                        // «¦«œ ¡˜Ÿ˜¨ ¦¬£œ «¦ Barticle ˜§¦ ©ž£á› ˜ Cmoves kai Wcmoves
54904>>>>>                        // ¡˜  ¥œ£˜¨¡˜¨¦¬£œ «¦ record Barticle àª ‹† ‰¢œ ©«æ §¢â¦¤
54904>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr         to ''
54905>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise     to ''
54906>>>>>                        Send Request_Save to Barticl_DD
54907>>>>>                        //Send info_box "’¦ §˜¨˜©«˜« ¡æ œå¤˜  «é¨˜ ˜¤¦ ®«æ.\n„§ «¨â§œ«œ ž «¨¦§¦§¦åž©ž «¦¬" '¢ž¨¦­¦¨å˜'
54907>>>>>                    End
54907>>>>>>
54907>>>>>                    Else Begin
54908>>>>>                        // •«¬§ž©œ ¢˜Ÿ¦ª ©«ž¤ › ˜š¨˜­ž WCmoves
54908>>>>>                        error 6111 "ƒœ¤ ™¨âŸž¡œ Cmoves š ˜ › ˜š¨˜­ã"
54909>>>>>>
54909>>>>>                    End
54909>>>>>>
54909>>>>>
54909>>>>>                End
54909>>>>>>
54909>>>>>                //// IF IS NOT CLOSED (Barticle)
54909>>>>>                Else Begin
54910>>>>>                    Integer iiRecn
54910>>>>>                    Move 0 to iExitFlag
54911>>>>>                    Send Clear To Bmove_DD
54912>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmove:Index.3:Barticl_Recr+Bmove_Rec0
54913>>>>>                    While ((Found=1) And (iExitFlag=0))
54917>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Recnum to iiRecn
54918>>>>>                        Move 0 to iInt
54919>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
54920>>>>>                        Move (Trim(sRecr2)) to sRecr2
54921>>>>>                        If (Not(sRecr2='')) Begin
54923>>>>>                            Move (fiDelete_Cmoves_Record(Self,sRecr2,0))  to iInt
54924>>>>>                            If (iInt<>60003) Move 1 to iExitFlag
54927>>>>>                        End
54927>>>>>>
54927>>>>>                        Send Find To Bmove_DD Next_Record 3
54928>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
54929>>>>>                    Loop
54930>>>>>>
54930>>>>>
54930>>>>>                    If (iExitFlag) Begin
54932>>>>>                        error 6100  "Found Cmoves Record on Open Barticl"
54933>>>>>>
54933>>>>>                    End
54933>>>>>>
54933>>>>>
54933>>>>>
54933>>>>>
54933>>>>>                    //////////////////////////jsjsjsjsjsjsjsjs
54933>>>>>                    Send Find To Bmove_DD First_Record 3 // Bmove:Index.2:Bmove_Recr
54934>>>>>
54934>>>>>                    While (Found=1)
54938>>>>>
54938>>>>>                        Send Clear to Ctypkin_DD
54939>>>>>                        Send Clear to Cflagkin_DD
54940>>>>>                        Send Clear to Clients_DD
54941>>>>>                        Send Clear to Cmoves_DD
54942>>>>>
54942>>>>>                        Get Field_Current_Value Of Btypkin_DD   Field Btypkin.Ctypkin_Recr  to sCtypkinRecr
54943>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Client_Mrecr  to sClientRecr
54944>>>>>                        move sclientrecr to clients.client_recr
54945>>>>>                        Send Find to Clients_DD eq 2 //Clients:Index.2:Client_Recr
54946>>>>>
54946>>>>>                        If (Not(Found)) Begin
54948>>>>>                            If ((iAnti=2) Or (iAnti=3)) error 5005 "Client record not found"
54951>>>>>                             ///// Else Goto Skip_All_Ctypkin
54951>>>>>                            ///// @@##@@ 21/12/2001 yannis
54951>>>>>                            ///// h allagh ayth egine gia na mporoume na enhmeronoume
54951>>>>>                            ///// kartella pelath apo episfalh posa opote kai prepei
54951>>>>>                            ///// na diabazei ta cflags
54951>>>>>                        End
54951>>>>>>
54951>>>>>
54951>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
54952>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
54953>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
54956>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia     to dHmnia
54957>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Aitiol    to sPerigrafh
54958>>>>>            //                    Get Field_Current_Value Of Barticl_DD   Field Barticl.Isotimia          to nIsotimia
54958>>>>>                        Get Field_Current_Value Of Ctypkin_DD   Field Ctypkin.Ctypkin_Module    to sModule
54959>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Sls_ID            to sSls_ID
54960>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Cnt_ID            to sCnt_ID
54961>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Presp_ID          to sPresp_ID
54962>>>>>
54962>>>>>                        Move 1 to iSign // Always 'Update'
54963>>>>>                        Move 0 to iOneCflag
54964>>>>>                        Move 0 to iMustSaveCmoves
54965>>>>>                        Move 0 to iMustSaveClient
54966>>>>>                        Move 0 to iMustSaveClientYpoloipa
54967>>>>>                        Move 0 to iMustSaveEpisf
54968>>>>>                        Move 0 to iAntistrofhProshmou
54969>>>>>                        Move 0 to imustsaveofeilh
54970>>>>>
54970>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
54971>>>>>
54971>>>>>                        Move 0 to iOneWflag
54972>>>>>                        Move 0 to iMustSaveWCmoves
54973>>>>>                        Move 0 to nPosothtaFinal
54974>>>>>                        Move 0 to nXreFinal
54975>>>>>                        Move 0 to nPisFinal
54976>>>>>                        Move 0 to iEpireazeiAxies
54977>>>>>                        Move 0 to iEpireazeiPosothtes
54978>>>>>                        Move 0 to nXre
54979>>>>>                        Move 0 to nPis
54980>>>>>                        Move 0 to nQtyEis
54981>>>>>                        Move 0 to nQtyEx
54982>>>>>                        Move 0 to iMustEnhmWitemcl
54983>>>>>
54983>>>>>
54983>>>>>                        Get Field_Current_Value Of Bmove_DD   Field Bmove.Bmove_Recr     to sBmoveRecr
54984>>>>>
54984>>>>>                        Get Field_Current_Value Of Baxio_DD   Field Baxio.Baxio_C_Code2  to sNomisma
54985>>>>>                        Move (Trim(sNomisma))   to sNomisma
54986>>>>>                        Move sNomisma to Nomisma.Nomisma_Code
54987>>>>>                        Send Find to Nomisma_DD eq 1 //Nomisma:Index.1:Nomisma_Code
54988>>>>>                        If (Not(Found)) Begin
54990>>>>>                            error 20000 "ƒœ¤ ™¨âŸž¡œ «¦ ¤æ£ ©£˜"
54991>>>>>>
54991>>>>>                        End
54991>>>>>>
54991>>>>>
54991>>>>>                        Get Field_Current_Value Of Baxio_DD     Field Baxio.Baxio_V2        to nPoso
54992>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia to dHmnia
54993>>>>>                        Move 1                                                              to nPosothta
54994>>>>>
54994>>>>>                        Move 0 to iAntistrofhProshmou
54995>>>>>
54995>>>>>                        Clear Cflagkin
54996>>>>>                        Move sCtypkinRecr           to Cflagkin.Ctypkin_Recr
54997>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
54998>>>>>>
54998>>>>>
54998>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
55002>>>>>
55002>>>>>                            Move 1 to iOneCflag
55003>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
55004>>>>>                            Move (Trim(sFlag)) to sFlag
55005>>>>>
55005>>>>>                            Case Begin
55005>>>>>                                Case (sFlag='1')
55007>>>>>                                    Move 1 to iMustSaveCmoves
55008>>>>>                                Case Break
55009>>>>>                                Case (sFlag='2') // Antistrofh Proshmou
55012>>>>>                                    Move (nPoso*iSign*(-1)) to nPoso
55013>>>>>                                    Move 1 to iAntistrofhProshmou
55014>>>>>                                Case Break
55015>>>>>                                Case (sFlag='3') // Epireazei xreoseis
55018>>>>>                                    Move (nPoso*iSign)  to nXre
55019>>>>>                                    Move 0              to nPis
55020>>>>>                                Case Break
55021>>>>>                                Case (sFlag='4') // Epireazei pistoseis
55024>>>>>                                    Move (nPoso*iSign)  to nPis
55025>>>>>                                    Move 0              to nXre
55026>>>>>                                Case Break
55027>>>>>                                Case (sFlag='5') // Epireazei Hmeromhnies
55030>>>>>                                    Move 1 to iMustSaveClient
55031>>>>>                                    If (nXre<>0) Begin
55033>>>>>                                        Move dHmnia to dLastXre
55034>>>>>                                        Move dHmnia to dLastXreParast
55035>>>>>                                        Move ''     to dLastPis
55036>>>>>                                        Move ''     to dLastPisParast
55037>>>>>                                    End
55037>>>>>>
55037>>>>>                                    Else If (nPis<>0) Begin
55040>>>>>                                        Move dHmnia to dLastPis
55041>>>>>                                        Move dHmnia to dLastPisParast
55042>>>>>                                        Move ''     to dLastXre
55043>>>>>                                        Move ''     to dLastXreParast
55044>>>>>                                    End
55044>>>>>>
55044>>>>>                                Case Break
55045>>>>>                                Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
55048>>>>>                                Case Break
55049>>>>>                                Case (sFlag='7') // Epireazei ekkremh axiografa
55052>>>>>                                Case Break
55053>>>>>                                Case (sFlag='8') // Epireazei Diamartyrhmena
55056>>>>>                                Case Break
55057>>>>>                                Case (sFlag='9') // Epireazei Tziro
55060>>>>>                                Case Break
55061>>>>>                                Case (sFlag='10') // Epireazei Apografh xreoshs
55064>>>>>                                Case Break
55065>>>>>                                Case (sFlag='11') // Epireazei Apografh Pistosh
55068>>>>>                                Case Break
55069>>>>>                                Case (sFlag='12') // Symmetoxh se MYF (Plythos)
55072>>>>>                                    Move iSign to iMyf
55073>>>>>                                Case Break
55074>>>>>                                Case (sFlag='13') // Symmetoxh se MYF (Axia)
55077>>>>>                                    Move (nPoso*iSign)  to nMyf
55078>>>>>                                Case Break
55079>>>>>                                Case (sFlag='14') // Axies se Xeno sma
55082>>>>>                                    // Blepe sxetika erothmata sthn arxh ths procedure
55082>>>>>                                Case Break
55083>>>>>                                Case (sFlag='15') // Aytomath dhmiourgia axiografou
55086>>>>>                                Case Break
55087>>>>>                                Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
55090>>>>>                                    If (nXre<>0) Begin
55092>>>>>                                        Move (nXre*(-1))    to nPis
55093>>>>>                                        Move 0              to nXre
55094>>>>>                                    End
55094>>>>>>
55094>>>>>                                    Else If (nPis<>0) Begin
55097>>>>>                                        Move (nPis*(-1))    to nXre
55098>>>>>                                        Move 0              to nPis
55099>>>>>                                    End
55099>>>>>>
55099>>>>>                                Case Break
55100>>>>>                                Case (sFlag='17') // Afairei apo Myf (akyrotika)
55103>>>>>                                    // Thelei exhghsh ti shmainei 'afairei' ?
55103>>>>>                                    // apo posothta? apo axia? apo allou?
55103>>>>>                                Case Break
55104>>>>>                                Case (sFlag='23') // Athroisths 1
55107>>>>>                                    Move (nPoso*iSign) to nAthr1
55108>>>>>                                Case Break
55109>>>>>                                Case (sFlag='24') // Athroisths 2
55112>>>>>                                    Move (nPoso*iSign) to nAthr2
55113>>>>>                                Case Break
55114>>>>>                                Case (sFlag='25') // Athroisths 3
55117>>>>>                                    Move (nPoso*iSign) to nAthr3
55118>>>>>                                Case Break
55119>>>>>                                Case (sFlag='26') // Athroisths 4
55122>>>>>                                    Move (nPoso*iSign) to nAthr4
55123>>>>>                                Case Break
55124>>>>>                                Case (sFlag='27') // Athroisths 5
55127>>>>>                                    Move (nPoso*iSign) to nAthr5
55128>>>>>                                Case Break
55129>>>>>                                Case (sFlag='28') // Athroisths 6
55132>>>>>                                    Move (nPoso*iSign) to nAthr6
55133>>>>>                                Case Break
55134>>>>>                                Case (sFlag='29') // Athroisths 7
55137>>>>>                                    Move (nPoso*iSign) to nAthr7
55138>>>>>                                Case Break
55139>>>>>                                Case (sFlag='30') // Athroisths 8
55142>>>>>                                    Move (nPoso*iSign) to nAthr8
55143>>>>>                                Case Break
55144>>>>>
55144>>>>>                                Case (sFlag='60') // Enhmeronei Episfalh Posa Thetika
55147>>>>>                                    Move 1 to iMustSaveEpisf
55148>>>>>                                Case Break
55149>>>>>
55149>>>>>                                Case (sFlag='61') // Enhmeronei Episfalh Posa Arnhtika
55152>>>>>                                    Move 2 to iMustSaveEpisf
55153>>>>>                                Case Break
55154>>>>>
55154>>>>>                                Case (sFlag='66') // Enhmeronei synolikh ofeilh
55157>>>>>                                    Move 1 to iMustSaveofeilh
55158>>>>>                                Case Break
55159>>>>>
55159>>>>>
55159>>>>>                                Case (sFlag='99') // Enhmeronei Ypoloipa
55162>>>>>                                    Move 1 to iMustSaveClientYpoloipa
55163>>>>>                                Case Break
55164>>>>>
55164>>>>>                            Case End
55164>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
55165>>>>>>
55165>>>>>                        Loop
55166>>>>>>
55166>>>>>
55166>>>>>
55166>>>>>                        If ((iOneCflag) And (iMustSaveCmoves)) Begin
55168>>>>>
55168>>>>>                            If (nXre<>0) Begin
55170>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nXre
55171>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))
55172>>>>>                                Move (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastXreosh
55173>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia))
55174>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_CodeR,dHmnia,nIsotimia))
55175>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to nXre
55176>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0     to 0
55177>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00    to 0
55178>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1     to 0
55179>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to 0
55180>>>>>                                Move 0 to nParastPistosh
55181>>>>>                            End
55181>>>>>>
55181>>>>>                            Else If (nPis<>0) Begin
55184>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nPis
55185>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))
55186>>>>>                                Move (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastPistosh
55187>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia))
55188>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_CodeR,dHmnia,nIsotimia))
55189>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to nPis
55190>>>>>
55190>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0     to 0
55191>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00    to 0
55192>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1     to 0
55193>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to 0
55194>>>>>                                Move 0 to nParastXreosh
55195>>>>>                            End
55195>>>>>>
55195>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Hmnia   to dHmnia
55196>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Barticl_Recr   to sRecr
55197>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.CN_Code        to (Trim(sCN_Code))
55198>>>>>
55198>>>>>                            // jsjsjs 11/11/2003 Amesh pleon syndesh Cmove me Bmove
55198>>>>>                            //                   Na trexei kai to enhCmBm gia batch enhmerosh
55198>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Custprom_Code   to (Trim(sBmoveRecr))
55199>>>>>                            //
55199>>>>>
55199>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Cmoves_SC_Code2   to (Trim(sNomisma))
55200>>>>>                            Get Field_Current_Value Of Btypkin_DD  Field Btypkin.Btypkin_Abr    to ssBtypkinDescrShort
55201>>>>>                            Get Field_Current_Value Of Barticl_DD  Field Barticl.Barticl_No     to iiBarticleNO
55202>>>>>                            Move '' to sPerigrafh
55203>>>>>                            Move (Append(sPerigrafh,('*'+(Trim(ssBtypkinDescrShort))+'  '+ ;                                                    (String(iiBarticleNO))+ '*'))) to sPerigrafh
55204>>>>>                            //
55204>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Par     to (Trim(sPerigrafh))
55205>>>>>
55205>>>>>                            //////////////////////////////////////////////////////////////////////////////
55205>>>>>                            // jsjsjsjs 06/02/2001 ©¬£§¢ž¨à¤¦¤«˜  «˜ §˜¨˜¡˜«à §œ› ˜
55205>>>>>                            //                     £œ «¦  › ¦ §¦©¦ š ˜ ¢¦š¦¬ª reportin ˜¥ ¦š¨˜­à¤
55205>>>>>                            //////////////////////////////////////////////////////////////////////////////
55205>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia to nJS
55206>>>>>
55206>>>>>
55206>>>>>                            If (iAntistrofhProshmou)    Move (-1) to iSign
55209>>>>>                            Else                        Move   1  to iSign
55211>>>>>
55211>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd0    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code0,dHmnia,nIsotimia))*iSign)
55212>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd00   ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code00,dHmnia,nIsotimia))*iSign)
55213>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd1    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_CodeR,dHmnia,nIsotimia))*iSign)
55214>>>>>                            //////////////////////////////////////////////////////////////////////////////
55214>>>>>                            //////////////////////////////////////////////////////////////////////////////
55214>>>>>
55214>>>>>
55214>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Module_From  to (trim(sModule))
55215>>>>>
55215>>>>>                            Get field_current_value of clients_dd field clients.recnum to iclient
55216>>>>>
55216>>>>>                            If (iClient) Begin
55218>>>>>                                If (iMustSaveClientYpoloipa =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel   to '1'
55221>>>>>                                If (iMustSaveClient         =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel to '1'
55224>>>>>                            End
55224>>>>>>
55224>>>>>
55224>>>>>                            Else begin
55225>>>>>                                error 5011 "Client record not found while saving cmoves"
55226>>>>>>
55226>>>>>                            end
55226>>>>>>
55226>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Sls_ID      to sSls_ID
55227>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Cnt_ID      to sCnt_ID
55228>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Presp_ID    to sPresp_ID
55229>>>>>                            Send Request_Save to Cmoves_DD
55230>>>>>
55230>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Recr to sCmovesRecr
55231>>>>>
55231>>>>>                            If (Trim(sCmovesRecr)='') error 5008 "Saved Cmoves but dont have Recr"
55234>>>>>                            // jsjsjs 31/08/2001
55234>>>>>                            Skip_All_Ctypkin:
55234>>>>>
55234>>>>>                            //Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr      to (Trim(sCmovesRecr))
55234>>>>>                            If ((iAnti=2) Or (iAnti=3)) ;                                Set Field_Changed_Value Of BMove_DD Field BMove.Cmoves_Recr to (Trim(sCmovesRecr))
55237>>>>>                            // jsjsjs 31/08/2001
55237>>>>>
55237>>>>>                            Send Request_Save to Bmove_DD
55238>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
55239>>>>>                            Send Request_Save to Barticl_DD
55240>>>>>                        End
55240>>>>>>
55240>>>>>                        Else Begin
55241>>>>>                            // Prosthetos kodikas gia na kleinei kai ta axiografa
55241>>>>>                            // ta opoia den kanoun kammia kinhsh.
55241>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
55242>>>>>                            Send Request_Save to Barticl_DD
55243>>>>>                        End
55243>>>>>>
55243>>>>>
55243>>>>>                        // @@##@@## yannis
55243>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
55245>>>>>                            Move 0  to nApait
55246>>>>>                            Move 0  to napaitpayresp
55247>>>>>                            Move 0  to nEpitPoso
55248>>>>>                            Move '' to sPelaths
55249>>>>>                            Move 0  to nofeilh
55250>>>>>                            Move 0  to nofeilhpayresp
55251>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
55251>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
55252>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
55253>>>>>
55253>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
55253>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
55253>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
55253>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
55253>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
55256>>>>>                            // js 13/03/2003
55256>>>>>
55256>>>>>                            Send Clear to Clients_DD
55257>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
55258>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
55259>>>>>                            If (Found=1) Begin
55261>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
55262>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
55263>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
55264>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
55265>>>>>
55265>>>>>                                If (iMustSaveofeilh=1)  Begin
55267>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
55269>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
55270>>>>>                                        Send Request_Save to Clients_DD
55271>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
55272>>>>>                                        Send Request_Save to payresp_DD
55273>>>>>                                    End
55273>>>>>>
55273>>>>>                                    Else Begin
55274>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
55275>>>>>                                        Send Request_Save to Clients_DD
55276>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
55277>>>>>                                        Send Request_Save to payresp_DD
55278>>>>>                                    End
55278>>>>>>
55278>>>>>                                End
55278>>>>>>
55278>>>>>
55278>>>>>                                If (iMustSaveEpisf=1)  Begin
55280>>>>>                                    Add nEpitPoso to nApait
55281>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
55282>>>>>                                    Send Request_Save to Clients_DD
55283>>>>>                                    Add nEpitPoso to nApaitpayresp
55284>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
55285>>>>>                                    Send Request_Save to payresp_DD
55286>>>>>
55286>>>>>                                End
55286>>>>>>
55286>>>>>                                Else If (iMustSaveEpisf=2)  Begin
55289>>>>>                                    Add (nEpitPoso*(-1)) to nApait
55290>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
55291>>>>>                                    Send Request_Save to Clients_DD
55292>>>>>                                    Add (nEpitPoso*(-1)) to nApaitpayresp
55293>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
55294>>>>>                                    Send Request_Save to payresp_DD
55295>>>>>                                End
55295>>>>>>
55295>>>>>
55295>>>>>                                Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
55296>>>>>                                Send Request_Save to Barticl_DD
55297>>>>>                            End
55297>>>>>>
55297>>>>>                            Else Begin
55298>>>>>                            End
55298>>>>>>
55298>>>>>                        End
55298>>>>>>
55298>>>>>
55298>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
55299>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
55300>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
55303>>>>>
55303>>>>>                        Send Find To Bmove_DD Next_Record 3 // Bmove:Index.2:Bmove_Recr
55304>>>>>                    Loop
55305>>>>>>
55305>>>>>
55305>>>>>                    //send info_box "€¥ æš¨˜­˜ œ§ «¬®éª ¡¢œ ©£â¤˜.\nƒœ¤ «¨¦§¦§¦ ¦ç¤«˜  ˜¤ ›œ¤ ¥œ¡¢œ ›é©¦¬¤" '¢ž¨¦­¦¨å˜'
55305>>>>>                End
55305>>>>>>
55305>>>>>            End
55305>>>>>>
55305>>>>>            Else error 5001 "’¦ ˜¨® ¡æ Barticle Recr ›œ¤ ™¨âŸž¡œ"
55307>>>>>        End_procedure
55308>>>>>
55308>>>>>
55308>>>>>        Procedure OnProcess
55310>>>>>            If (psModule(Self)='') error 5999 "Business Process Called without setting psModule property"
55313>>>>>            If (Trim(psBarticleRecr(Self))<>'') Send Deal_With_Barticle
55316>>>>>            Else error 5000  "ƒœ¤ ¬§á¨®œ  ˜¨® ¡æ Barticle Recr"// No Initial Barticle recr is passed
55318>>>>>        End_Procedure
55319>>>>>
55319>>>>>        Procedure Start_Process
55321>>>>>            Integer iErr iID
55322>>>>>            Indicate Err False
55323>>>>>            Set Button_State    of (Wait(Self)) to False
55324>>>>>            Set BarVisibleState of (Wait(Self)) to '' False
55325>>>>>            Send Popup                          to (Wait(Self))
55326>>>>>            Set piLathos                        to 0
55327>>>>>            Forward Send Start_Process
55329>>>>>        End_Procedure
55330>>>>>
55330>>>>>        Procedure End_Process
55332>>>>>            Forward Send End_Process
55334>>>>>            Send Deactivate to (Wait(Self))
55335>>>>>        End_Procedure
55336>>>>>
55336>>>>>        //AB-StoreEnd
55336>>>>>
55336>>>>>    End_Object    // bpencmv3
55337>>>>>
55337>>>>>//AB/     End_Object    // prj
55337>>>
55337>>>Use slNomism.sl
55337>>>Use sl033.sl
INCLUDING FILE: SL033.SL
55337>>>>>//AB/ Project SL033:BKINKAT
55337>>>>>//AB/ Object prj is a Lookup_Project
55337>>>>>//AB/     Set ProjectName to "SL033:BKINKAT"
55337>>>>>//AB/     Set ProjectFileName to "sl033.SL"
55337>>>>>
55337>>>>>// Project Object Structure
55337>>>>>//   sl033 is a dbModalPanelSub
55337>>>>>//     Company_DD is a DataDictionary
55337>>>>>//     Branch_DD is a DataDictionary
55337>>>>>//     Year_DD is a DataDictionary
55337>>>>>//     Btypkin_DD is a DataDictionary
55337>>>>>//     Baxiokat_DD is a DataDictionary
55337>>>>>//     Bkinkat_DD is a DataDictionary
55337>>>>>//     oSelList is a dbListSub
55337>>>>>//     oOK_bn is a ButtonSub
55337>>>>>//     oCancel_bn is a ButtonSub
55337>>>>>//     oSearch_bn is a ButtonSub
55337>>>>>
55337>>>>>// Register all objects
55337>>>>>Register_Object Baxiokat_DD
55337>>>>>Register_Object Bkinkat_DD
55337>>>>>Register_Object Branch_DD
55337>>>>>Register_Object Btypkin_DD
55337>>>>>Register_Object Company_DD
55337>>>>>Register_Object oCancel_bn
55337>>>>>Register_Object oOK_bn
55337>>>>>Register_Object oSearch_bn
55337>>>>>Register_Object oSelList
55337>>>>>Register_Object sl033
55337>>>>>Register_Object Year_DD
55337>>>>>
55337>>>>>
55337>>>>>//AB-IgnoreStart
55337>>>>>
55337>>>>>Use DFAllEnt.pkg
55337>>>>>Use dbList.Sub
55337>>>>>Use Button.Sub
55337>>>>>
55337>>>>>
55337>>>>>Use COMPANY.DD
55337>>>>>Use BRANCH.DD
55337>>>>>Use YEAR.DD
55337>>>>>Use BTYPKIN.DD
55337>>>>>Use BAXIOKAT.DD
55337>>>>>Use BKINKAT.DD
INCLUDING FILE: BKINKAT.DD
55337>>>>>>>//DDB-FileStart
55337>>>>>>>//DDB-HeaderStart
55337>>>>>>>
55337>>>>>>>// File Name : BKINKAT.DD
55337>>>>>>>// Class Name: Bkinkat_DataDictionary
55337>>>>>>>// Revision  : 39
55337>>>>>>>// Version   : 2
55337>>>>>>>
55337>>>>>>>Use  Windows           // Basic Definitions
55337>>>>>>>Use  DataDict          // DataDictionary Class Definition
55337>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
55337>>>>>>>
55337>>>>>>>Open Bkinkat
55339>>>>>>>Open Bkinkath
INCLUDING FILE: BKINKATH.FD
55341>>>>>>>Open Baxiokat
55343>>>>>>>Open Btypkin
55345>>>>>>>Open Sysrecb
55347>>>>>>>Open Bmove
55349>>>>>>>
55349>>>>>>>//DDB-HeaderEnd
55349>>>>>>>//DDB-ValidationStart
55349>>>>>>>
55349>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.Pkg
55349>>>>>>>
55349>>>>>>>Register_Object Bkinkat_Bkinkat_Yn_New_VT
55349>>>>>>>Register_Object Baxio_Status_VT
55349>>>>>>>Register_Object Bkinkat_Baxio_Place_VT
55349>>>>>>>Use Baxio.Pkg        // Baxio_Status_VT
55349>>>>>>>
55349>>>>>>>Object Bkinkat_Bkinkat_Yn_New_VT  is a DescriptionValidationTable
55351>>>>>>>
55351>>>>>>>    Procedure Fill_List
55353>>>>>>>        Forward Send Fill_List
55355>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
55356>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
55357>>>>>>>    End_Procedure    // Fill_List
55358>>>>>>>    //DDB-ValidationCustomStart
55358>>>>>>>    //DDB-ValidationCustomEnd
55358>>>>>>>End_Object   // Bkinkat_Bkinkat_Yn_New_VT
55359>>>>>>>
55359>>>>>>>Object Bkinkat_Baxio_Place_VT  is a CodeValidationTable
55361>>>>>>>    Set Type_Value        To "BAXIOPLACE"
55362>>>>>>>    Set Allow_Blank_State To TRUE
55363>>>>>>>    //DDB-ValidationCustomStart
55363>>>>>>>    //DDB-ValidationCustomEnd
55363>>>>>>>End_Object   // Bkinkat_Baxio_Place_VT
55364>>>>>>>//DDB-ValidationEnd
55364>>>>>>>Open SysCurXr
55366>>>>>>>
55366>>>>>>>Class Bkinkat_DataDictionary  is a DataDictionary_Sec
55367>>>>>>>
55367>>>>>>>    // Creating:
55367>>>>>>>
55367>>>>>>>    Procedure Creating
55368>>>>>>>        Forward Send Creating
55370>>>>>>>        // Insert Code Here
55370>>>>>>>        Move (Append('',((Trim(SysCurXr.Branch_Site))+;                         (Trim(String(Bkinkat.Bkinkat_Rec0)))))) to Bkinkat.Bkinkat_Recr
55371>>>>>>>    End_Procedure   // Creating
55372>>>>>>>
55372>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
55372>>>>>>>      //™) ˜¤áš¤à©ž properties
55372>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
55372>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
55372>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
55372>>>>>>>      Procedure Update
55373>>>>>>>                Forward Send Update
55375>>>>>>>
55375>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
55375>>>>>>>                Move Syscurxr.Company_Code  to Bkinkat.Company_Code
55376>>>>>>>                Move Syscurxr.Branch_Code   to Bkinkat.Branch_Code
55377>>>>>>>                Move Syscurxr.Year_Year     to Bkinkat.Year_Year
55378>>>>>>>                Move Btypkin.Btypkin_Code   to Bkinkat.Btypkin_Code
55379>>>>>>>                Move Baxiokat.Baxiokat_Code to Bkinkat.Baxiokat_Code
55380>>>>>>>
55380>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
55380>>>>>>>                //š.1:baxio_stat_from + baxio_plac_from:
55380>>>>>>>                //    æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â¦ ˜¥ æš¨˜­¦,
55380>>>>>>>                //    §¨¦­˜¤éª "â¨®œ«˜ " ˜§¦ «¦ §¦¬Ÿœ¤á !
55380>>>>>>>                //    ¡˜  â®œ  ¡˜«á©«˜©ž 1
55380>>>>>>>                If (Bkinkat.Bkinkat_Yn_New = 1);                Begin
55382>>>>>>>                     Move 1 to Bkinkat.Baxio_Stat_From //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
55383>>>>>>>                     Move 0 to Bkinkat.Baxio_Plac_From //¤â¦ ˜¥ æš¨˜­¦
55384>>>>>>>                End
55384>>>>>>>>
55384>>>>>>>                Else;                Begin //©«ã¤ ˜¤«åŸœ«ž §œ¨å§«à©ž, §¨â§œ  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
55385>>>>>>>                     //If (Not(Bkinkat.Baxio_Stat_From > 0)) Send Operation_Not_Allowed 3001 //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
55385>>>>>>>                     If (Not(Bkinkat.Baxio_Plac_From > 0)) Send Operation_Not_Allowed 3001 //«¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜ 
55388>>>>>>>                End
55388>>>>>>>>
55388>>>>>>>
55388>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ btypkin
55388>>>>>>>                Add 1 to   Btypkin.Bkinkat_Num
55389>>>>>>>
55389>>>>>>>                //Move BkinKat.BkinKat_Rec0   to BkinKat.BkinKat_code
55389>>>>>>>      End_Procedure   //update
55390>>>>>>>
55390>>>>>>>
55390>>>>>>>      Procedure Backout
55391>>>>>>>                Forward Send Backout
55393>>>>>>>
55393>>>>>>>                //œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ Btypkin
55393>>>>>>>                Sub 1 from Btypkin.Bkinkat_Num
55394>>>>>>>      End_Procedure   //backout
55395>>>>>>>
55395>>>>>>>
55395>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
55396>>>>>>>                String lsError_Message
55397>>>>>>>                Case Begin
55397>>>>>>>                     //˜§æ validate save
55397>>>>>>>                     Case (iError_Num = 1001)
55399>>>>>>>                     Case Break
55400>>>>>>>                     //˜§æ update
55400>>>>>>>                     Case (iError_Num = 3001)
55403>>>>>>>                          Move ("DDC 146:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜  !");                          to lsError_Message
55404>>>>>>>                     Case Break
55405>>>>>>>
55405>>>>>>>                     Case Else
55405>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
55407>>>>>>>                Case End
55407>>>>>>>
55407>>>>>>>                Error iError_Num lsError_Message
55408>>>>>>>>
55408>>>>>>>      End_Procedure // operation_not_allowed
55409>>>>>>>
55409>>>>>>>
55409>>>>>>>//----------------------------------------------------------------------------
55409>>>>>>>    Procedure Define_Fields
55410>>>>>>>        Forward Send Define_Fields
55412>>>>>>>        //DDB-Generated-Code-Location
55412>>>>>>>        //DDB-DefineFieldStart
55412>>>>>>>
55412>>>>>>>        Set Main_File            To Bkinkat.File_Number
55413>>>>>>>        Set Cascade_Delete_State To FALSE
55414>>>>>>>
55414>>>>>>>
55414>>>>>>>        // Child (Client) file structure................
55414>>>>>>>        Send Add_Client_File  Bkinkath.File_Number
55415>>>>>>>
55415>>>>>>>        // Parent (Server) file structure...............
55415>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
55416>>>>>>>        Send Add_Server_File  Btypkin.File_Number
55417>>>>>>>
55417>>>>>>>        // External (System) file structure.............
55417>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
55418>>>>>>>        Send Add_System_File  Bmove.File_Number  DD_LOCK_ON_ALL
55419>>>>>>>
55419>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
55422>>>>>>>
55422>>>>>>>        // Field-based properties.......................
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Company_Code
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Branch_Code
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Year_Year
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Btypkin_Code
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Baxiokat_Code
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Bkinkat_Code
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Bkinkat_Rec0
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Bkinkat_Recr
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Btypkin_Recr
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Baxiokat_Recr
55422>>>>>>>
55422>>>>>>>        // Bkinkat.Bkinkat_Yn_New
55422>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New To (Bkinkat_Bkinkat_Yn_New_VT(Self))
55423>>>>>>>
55423>>>>>>>        // Bkinkat.Baxio_Stat_From
55423>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From To (Baxio_Status_VT(Self))
55424>>>>>>>
55424>>>>>>>        // Bkinkat.Baxio_Stat_To
55424>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To To (Baxio_Status_VT(Self))
55425>>>>>>>
55425>>>>>>>        // Bkinkat.Baxio_Plac_From
55425>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From To (Bkinkat_Baxio_Place_VT(Self))
55426>>>>>>>
55426>>>>>>>        // Bkinkat.Baxio_Plac_To
55426>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To To (Bkinkat_Baxio_Place_VT(Self))
55427>>>>>>>
55427>>>>>>>        // Bkinkat.Bkinkat_Gplncod
55427>>>>>>>
55427>>>>>>>        //DDB-DefineFieldEnd
55427>>>>>>>
55427>>>>>>>        Set Main_File            To Bkinkat.File_Number
55428>>>>>>>        Set Cascade_Delete_State To FALSE
55429>>>>>>>
55429>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
55430>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
55431>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
55432>>>>>>>
55432>>>>>>>        // Parent (Server) file structure...............
55432>>>>>>>        Send Add_Server_File  Btypkin.File_Number
55433>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
55434>>>>>>>
55434>>>>>>>        // External (System) file structure.............
55434>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
55435>>>>>>>
55435>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
55438>>>>>>>
55438>>>>>>>        // Field-based properties.......................
55438>>>>>>>
55438>>>>>>>        // Bkinkat.Btypkin_Code
55438>>>>>>>        Set Key_Field_State        Field Bkinkat.Btypkin_Code     To TRUE
55439>>>>>>>
55439>>>>>>>        // Bkinkat.Baxiokat_Code
55439>>>>>>>        Set Field_Options          Field Bkinkat.Baxiokat_Code    To DD_AUTOFIND
55440>>>>>>>        Set Key_Field_State        Field Bkinkat.Baxiokat_Code    To TRUE
55441>>>>>>>
55441>>>>>>>        // Bkinkat.Bkinkat_Rec0
55441>>>>>>>        Set Field_Options          Field Bkinkat.Bkinkat_Rec0     To DD_NOPUT
55442>>>>>>>
55442>>>>>>>        // Bkinkat.Btypkin_Rec0
55442>>>>>>>        //Set Field_Options          Field Bkinkat.Btypkin_Rec0     To DD_NOPUT
55442>>>>>>>
55442>>>>>>>        // Bkinkat.Baxiokat_Rec0
55442>>>>>>>        //Set Field_Options          Field Bkinkat.Baxiokat_Rec0    To DD_NOPUT
55442>>>>>>>
55442>>>>>>>        // Bkinkat.Bkinkat_Yn_New
55442>>>>>>>        Set Field_Class_Name       Field Bkinkat.Bkinkat_Yn_New   To "dbComboForm_EZ"
55443>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ €¥ æš¨˜­¦ ?"
55444>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ ?"
55445>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New   To (Bkinkat_Bkinkat_Yn_New_VT(Self))
55446>>>>>>>
55446>>>>>>>        // Bkinkat.Baxio_Stat_From
55446>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_From  To "dbComboForm_EZ"
55447>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
55448>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
55449>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From  To (Baxio_Status_VT(Self))
55450>>>>>>>
55450>>>>>>>        // Bkinkat.Baxio_Stat_To
55450>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_To    To "dbComboForm_EZ"
55451>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
55452>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
55453>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To    To (Baxio_Status_VT(Self))
55454>>>>>>>
55454>>>>>>>        // Bkinkat.Baxio_Plac_From
55454>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_From  To "dbComboForm_EZ"
55455>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
55456>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
55457>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From  To (Bkinkat_Baxio_Place_VT(Self))
55458>>>>>>>
55458>>>>>>>        // Bkinkat.Baxio_Plac_To
55458>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_To    To "dbComboForm_EZ"
55459>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
55460>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
55461>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To    To (Bkinkat_Baxio_Place_VT(Self))
55462>>>>>>>
55462>>>>>>>        // Bkinkat.Bkinkat_Gplncod
55462>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
55463>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
55464>>>>>>>        //Set Field_Prompt_Object    Field Bkinkat.Bkinkat_Gplncod  To (SL056(Self))
55464>>>>>>>
55464>>>>>>>    End_Procedure    // Define_Fields
55465>>>>>>>
55465>>>>>>>
55465>>>>>>>    Procedure Field_Defaults
55466>>>>>>>        Forward Send Field_Defaults
55468>>>>>>>        //DDB-Generated-Code-Location
55468>>>>>>>        //DDB-FieldDefaultStart
55468>>>>>>>        //DDB-FieldDefaultEnd
55468>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Bkinkat_Yn_New   To 0
55469>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_From  To "1"
55470>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_To    To "1"
55471>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_From  To "1"
55472>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_To    To "1"
55473>>>>>>>    End_Procedure    // Field_Defaults
55474>>>>>>>
55474>>>>>>>End_Class    // Bkinkat_DataDictionary
55475>>>>>>>//DDB-FileEnd
55475>>>>>
55475>>>>>//AB-IgnoreEnd
55475>>>>>
55475>>>>>CD_Popup_Object sl033 is a dbModalPanelSub
55494>>>>>
55494>>>>>    //AB-StoreTopStart
55494>>>>>    Property Integer piFragmaBtypkinCode 0
55496>>>>>    
55496>>>>>    
55496>>>>>    
55496>>>>>    //AB-StoreTopEnd
55496>>>>>
55496>>>>>    Set Label to "‰˜«žš¦¨åœª ˜¥ ¦š¨á­à¤ š ˜ « ª ¡ ¤ã©œ ª"
55497>>>>>    Set Size to 206 362
55498>>>>>    Set Location to 4 5
55499>>>>>    Set Exit_Application_Local_State to FALSE
55500>>>>>    Set Modal_State to FALSE
55501>>>>>
55501>>>>>    //AB-DDOStart
55501>>>>>
55501>>>>>    Object Company_DD is a Company_DataDictionary
55503>>>>>    End_Object    // Company_DD
55504>>>>>
55504>>>>>    Object Branch_DD is a Branch_DataDictionary
55506>>>>>        Set DDO_Server to (Company_DD(self))
55507>>>>>    End_Object    // Branch_DD
55508>>>>>
55508>>>>>    Object Year_DD is a Year_DataDictionary
55510>>>>>        Set DDO_Server to (Branch_DD(self))
55511>>>>>    End_Object    // Year_DD
55512>>>>>
55512>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
55514>>>>>        Set DDO_Server to (Year_DD(self))
55515>>>>>    End_Object    // Btypkin_DD
55516>>>>>
55516>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
55518>>>>>    End_Object    // Baxiokat_DD
55519>>>>>
55519>>>>>    Object Bkinkat_DD is a Bkinkat_DataDictionary
55521>>>>>        Set DDO_Server to (Btypkin_DD(self))
55522>>>>>        Set DDO_Server to (Baxiokat_DD(self))
55523>>>>>
55523>>>>>        //AB-StoreStart
55523>>>>>                                
55523>>>>>        Procedure OnConstrain
55525>>>>>            Integer liBtypkinCode
55526>>>>>        
55526>>>>>            Get piFragmaBtypkinCode to liBtypkinCode
55527>>>>>            If (liBtypkinCode <> 0) Constrain Bkinkat.Btypkin_Code eq liBtypkinCode
55531>>>>>        End_Procedure // OnConstrain
55532>>>>>        
55532>>>>>        //AB-StoreEnd
55532>>>>>
55532>>>>>    End_Object    // Bkinkat_DD
55533>>>>>
55533>>>>>    Set Main_DD to (Bkinkat_DD(self))
55534>>>>>    Set Server to (Bkinkat_DD(self))
55535>>>>>
55535>>>>>    //AB-DDOEnd
55535>>>>>
55535>>>>>    Object oSelList is a dbListSub
55537>>>>>        Set Main_File to Bkinkat.File_Number
55538>>>>>        Set Size to 164 350
55539>>>>>        Set Location to 5 4
55540>>>>>
55540>>>>>        Begin_Row
55543>>>>>            Entry_Item Baxiokat.Baxiokat_code
55544>>>>>            Entry_Item Baxiokat.Baxiokat_descr
55545>>>>>            Entry_Item Baxiokat.Baxiokat_type
55546>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
55547>>>>>        End_Row
55552>>>>>
55552>>>>>        Set Form_Width    item 0 to 36
55553>>>>>        Set Header_Label  item 0 to "„ ›¦ª"
55554>>>>>        
55554>>>>>        Set Form_Width    item 1 to 194
55555>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
55556>>>>>        
55556>>>>>        Set Form_Width    item 2 to 29
55557>>>>>        Set Header_Label  item 2 to "„ ©./¢ž¨."
55558>>>>>        
55558>>>>>        Set Form_Width    item 3 to 83
55559>>>>>        Set Header_Label  item 3 to "„ ©./¢ž¨."
55560>>>>>        
55560>>>>>
55560>>>>>        //AB-StoreStart
55560>>>>>                                
55560>>>>>        Property Integer piStoreFragmaBtypkinCode 0
55562>>>>>        
55562>>>>>        
55562>>>>>        Procedure Store_Defaults
55564>>>>>           Forward Send Store_Defaults
55566>>>>>           Set piStoreFragmaBtypkinCode to (piFragmaBtypkinCode(Self))
55567>>>>>        End_Procedure
55568>>>>>        
55568>>>>>        Procedure ReStore_Defaults
55570>>>>>           Forward Send ReStore_Defaults
55572>>>>>           Set piFragmaBtypkinCode to (piStoreFragmaBtypkinCode(Self))
55573>>>>>        End_Procedure
55574>>>>>        
55574>>>>>        Procedure Activating
55576>>>>>           Forward Send Activating
55578>>>>>           Send Rebuild_Constraints to Bkinkat_DD
55579>>>>>        End_Procedure
55580>>>>>        
55580>>>>>        
55580>>>>>        //AB-StoreEnd
55580>>>>>
55580>>>>>    End_Object    // oSelList
55581>>>>>
55581>>>>>    Object oOK_bn is a ButtonSub
55583>>>>>        Set Label to "&„§ ¢¦šã"
55584>>>>>        Set Location to 172 195
55585>>>>>
55585>>>>>        //AB-StoreStart
55585>>>>>        Procedure OnClick
55587>>>>>            Send OK To (oSelList(current_object))
55588>>>>>        End_Procedure
55589>>>>>        //AB-StoreEnd
55589>>>>>
55589>>>>>    End_Object    // oOK_bn
55590>>>>>
55590>>>>>    Object oCancel_bn is a ButtonSub
55592>>>>>        Set Label to "&€¡ç¨à©ž"
55593>>>>>        Set Location to 172 250
55594>>>>>
55594>>>>>        //AB-StoreStart
55594>>>>>        Procedure OnClick
55596>>>>>            Send Cancel To (oSelList(current_object))
55597>>>>>        End_Procedure
55598>>>>>        //AB-StoreEnd
55598>>>>>
55598>>>>>    End_Object    // oCancel_bn
55599>>>>>
55599>>>>>    Object oSearch_bn is a ButtonSub
55601>>>>>        Set Label to "€&¤˜ã«ž©ž"
55602>>>>>        Set Location to 172 304
55603>>>>>
55603>>>>>        //AB-StoreStart
55603>>>>>        Procedure OnClick
55605>>>>>            Send Search To (oSelList(current_object))
55606>>>>>        End_Procedure
55607>>>>>        //AB-StoreEnd
55607>>>>>
55607>>>>>    End_Object    // oSearch_bn
55608>>>>>
55608>>>>>
55608>>>>>    //AB-StoreStart
55608>>>>>    
55608>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
55609>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
55610>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
55611>>>>>    
55611>>>>>    
55611>>>>>    
55611>>>>>    
55611>>>>>    //AB-StoreEnd
55611>>>>>
55611>>>>>CD_End_Object    // sl033
55613>>>>>>
55613>>>>>
55613>>>>>//AB/ End_Object    // prj
55613>>>Use r044.rv
INCLUDING FILE: R044.RV
55613>>>>>//AB/ Project R044:BMOVES
55613>>>>>//AB/     Object prj is a Report_Project
55613>>>>>//AB/         Set ProjectName to "R044:BMOVES"
55613>>>>>//AB/         Set ProjectFileName to "r044.RV"
55613>>>>>
55613>>>>>// Project Object Structure
55613>>>>>//   R044 is a ReportViewSub
55613>>>>>//     GroupSub2 is a GroupSub
55613>>>>>//       FormSub1 is a FormSub
55613>>>>>//       FormSub2 is a FormSub
55613>>>>>//       TextBoxSub7 is a TextBoxSub
55613>>>>>//       TextBoxSub8 is a TextBoxSub
55613>>>>>//     GroupSub1 is a GroupSub
55613>>>>>//       frmG12_3 is a FormSub
55613>>>>>//       frmG12_4 is a FormSub
55613>>>>>//       TextBoxSub3 is a TextBoxSub
55613>>>>>//       TextBoxSub4 is a TextBoxSub
55613>>>>>//     GroupSub3 is a GroupSub
55613>>>>>//       frmG1 is a FormSub
55613>>>>>//       frmG2 is a FormSub
55613>>>>>//       TextBoxSub9 is a TextBoxSub
55613>>>>>//       TextBoxSub10 is a TextBoxSub
55613>>>>>//     oSelectCurr is a GroupSub
55613>>>>>//       chkbCurr0 is a CheckBoxSub
55613>>>>>//       chkbCurr00 is a CheckBoxSub
55613>>>>>//       chkbCurrR is a CheckBoxSub
55613>>>>>//       chkbKeepTogether is a CheckBoxSub
55613>>>>>//     rdgSelectPrint is a RadioGroupSub
55613>>>>>//       RadioSub5 is a RadioSub
55613>>>>>//       RadioSub6 is a RadioSub
55613>>>>>//       rdFile is a RadioSub
55613>>>>>//       frmFile is a FormSub
55613>>>>>//     FormSub5 is a FormSub
55613>>>>>//     oPrint_bn is a ButtonSub
55613>>>>>//     oExit_bn is a ButtonSub
55613>>>>>//     grpYear is a GroupSub
55613>>>>>//       frmCompany is a FormSub
55613>>>>>//       frmBranch is a FormSub
55613>>>>>//       frmYear is a FormSub
55613>>>>>//       TextBoxSub11 is a TextBoxSub
55613>>>>>//       TextBoxSub12 is a TextBoxSub
55613>>>>>//       TextBoxSub13 is a TextBoxSub
55613>>>>>//     oClear_bn is a ButtonSub
55613>>>>>//     Textbox1 is a Textbox
55613>>>>>//     branch_name is a FormSub
55613>>>>>//     BMoves_BasicReport is a BasicReportSub
55613>>>>>
55613>>>>>// Register all objects
55613>>>>>Register_Object BMoves_BasicReport
55613>>>>>Register_Object branch_name
55613>>>>>Register_Object chkbCurr0
55613>>>>>Register_Object chkbCurr00
55613>>>>>Register_Object chkbCurrR
55613>>>>>Register_Object chkbKeepTogether
55613>>>>>Register_Object FormSub1
55613>>>>>Register_Object FormSub2
55613>>>>>Register_Object FormSub5
55613>>>>>Register_Object frmBranch
55613>>>>>Register_Object frmCompany
55613>>>>>Register_Object frmFile
55613>>>>>Register_Object frmG1
55613>>>>>Register_Object frmG12_3
55613>>>>>Register_Object frmG12_4
55613>>>>>Register_Object frmG2
55613>>>>>Register_Object frmYear
55613>>>>>Register_Object GroupSub1
55613>>>>>Register_Object GroupSub2
55613>>>>>Register_Object GroupSub3
55613>>>>>Register_Object grpYear
55613>>>>>Register_Object oClear_bn
55613>>>>>Register_Object oExit_bn
55613>>>>>Register_Object oPrint_bn
55613>>>>>Register_Object oSelectCurr
55613>>>>>Register_Object R044
55613>>>>>Register_Object RadioSub5
55613>>>>>Register_Object RadioSub6
55613>>>>>Register_Object rdFile
55613>>>>>Register_Object rdgSelectPrint
55613>>>>>Register_Object TextBoxSub10
55613>>>>>Register_Object TextBoxSub11
55613>>>>>Register_Object TextBoxSub12
55613>>>>>Register_Object TextBoxSub13
55613>>>>>Register_Object TextBoxSub3
55613>>>>>Register_Object TextBoxSub4
55613>>>>>Register_Object TextBoxSub7
55613>>>>>Register_Object TextBoxSub8
55613>>>>>Register_Object TextBoxSub9
55613>>>>>Register_Object Textbox1
55613>>>>>
55613>>>>>
55613>>>>>//AB/     Report View
55613>>>>>
55613>>>>>
55613>>>>>    //AB-StoreTopStart
55613>>>>>    Use DFAllRpt.pkg
55613>>>>>    Use BasicRpt.Sub
55613>>>>>    
55613>>>>>    Use SysCurXr.DD
55613>>>>>    Use BTYPKIN.DD
55613>>>>>    Use BARTICL.DD
55613>>>>>    Use BMOVE.DD
55613>>>>>    Use BAXIOKAT.DD
55613>>>>>    Use BAXIO.DD
55613>>>>>    
55613>>>>>    Use Rvi044.pkg
INCLUDING FILE: RVI044.PKG
/HEADERR044
Image 2, HEADERR044
 ________________________________________   ________________________________________   _________________
                                            †‹„ŽŠŽ‚ˆŽ €ˆŽ‚€”—Œ
                                            =====================
/SubHeaderR044_1
Image 3, SUBHEADERR044_1
_____________________________________________________________________________   ‘„ˆ€ : ___
‰ˆŒ†‘† : _________     €.€€‘’.: ____________.     €.€‡Ž“ : ____________.  †‹/Œˆ€ : __/__/____
‘“Œ€ŠŠ€‘Ž‹„ŒŽ‘ : ___________________________________
€€Š†’†‘     : ___________________________________   ‰“ˆŽ ŒŽ‹ˆ‘‹€ •†‘†‘ : ___________   ‘“ŒŽŠŽ : _,___,___,___.__
€ˆ’ˆŽŠŽ‚ˆ€ : _______________________________________________
-------------------------------------------------------------------------------------------------------------------------------
   €/€ „ˆƒŽ‘                    ‰—ƒˆ‰Ž‘ ’€„…€     €ˆ‡‹Ž‘      ŒŽ‹ˆ‘‹€             Ž‘Ž        Š†† ‰“ˆŽ               Ž‘Ž
                                                                 „‚‚€”†‘                             ŒŽ‹ˆ‘‹€
-------------------------------------------------------------------------------------------------------------------------------
/SubHeaderR044_2
Image 4, SUBHEADERR044_2
/BodyR044
Image 5, BODYR044
_____. _________________ _____________. ___________ ____________ _______ _,___,___,___.__  __/__/____ _______ _,___,___,___.__
/SubtotalR044_1
Image 6, SUBTOTALR044_1
/SubtotalR044_2
Image 7, SUBTOTALR044_2
-------------------------------------------------------------------------------------------------------------------------------
‘“ŒŽŠŽ                                                                             ’„‹€•ˆ€ : _______.         _,___,___,___.__
===============================================================================================================================
/RecParArticl
Image 8, RECPARARTICL
_________.
/FooterR044_1
Image 9, FOOTERR044_1
__/__/____
/*
55613>>>>>    Use sl031r.sl
INCLUDING FILE: SL031R.SL
55613>>>>>>>//AB/ Project sl031r:Btypkin with recr 1st col
55613>>>>>>>//AB/     Object prj is a Lookup_Project
55613>>>>>>>//AB/         Set ProjectName to "sl031r:Btypkin with recr 1st col"
55613>>>>>>>//AB/         Set ProjectFileName to "sl031r.SL"
55613>>>>>>>//AB/         Set GenerateFileName to "NONAME"
55613>>>>>>>
55613>>>>>>>// Project Object Structure
55613>>>>>>>//   SL031r is a dbModalPanelSub
55613>>>>>>>//     Btypkin_DD is a DataDictionary
55613>>>>>>>//     oSelList is a dbListSub
55613>>>>>>>//     oOK_bn is a ButtonSub
55613>>>>>>>//     oCancel_bn is a ButtonSub
55613>>>>>>>//     oSearch_bn is a ButtonSub
55613>>>>>>>
55613>>>>>>>// Register all objects
55613>>>>>>>Register_Object Btypkin_DD
55613>>>>>>>Register_Object oCancel_bn
55613>>>>>>>Register_Object oOK_bn
55613>>>>>>>Register_Object oSearch_bn
55613>>>>>>>Register_Object oSelList
55613>>>>>>>Register_Object SL031r
55613>>>>>>>
55613>>>>>>>
55613>>>>>>>    //AB-IgnoreStart
55613>>>>>>>
55613>>>>>>>    Use DFAllEnt.pkg
55613>>>>>>>    Use dbList.Sub
55613>>>>>>>    Use Button.Sub
55613>>>>>>>
55613>>>>>>>
55613>>>>>>>    Use BTYPKIN.DD
55613>>>>>>>    
55613>>>>>>>    //AB-IgnoreEnd
55613>>>>>>>
55613>>>>>>>    CD_Popup_Object SL031r is a dbModalPanelSub
55632>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
55633>>>>>>>        Set Size to 213 362
55634>>>>>>>        Set Location to 4 5
55635>>>>>>>        Set Exit_Application_Local_State to FALSE
55636>>>>>>>        Set Modal_State to FALSE
55637>>>>>>>
55637>>>>>>>        //AB-DDOStart
55637>>>>>>>
55637>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
55639>>>>>>>        End_Object    // Btypkin_DD
55640>>>>>>>
55640>>>>>>>        Set Main_DD to (Btypkin_DD(self))
55641>>>>>>>        Set Server to (Btypkin_DD(self))
55642>>>>>>>
55642>>>>>>>        //AB-DDOEnd
55642>>>>>>>
55642>>>>>>>        Object oSelList is a dbListSub
55644>>>>>>>            Set Main_File to Btypkin.File_Number
55645>>>>>>>            Set Size to 173 347
55646>>>>>>>            Set Location to 2 6
55647>>>>>>>
55647>>>>>>>            Begin_Row
55650>>>>>>>                Entry_Item Btypkin.Btypkin_recr
55651>>>>>>>                Entry_Item Btypkin.Btypkin_code
55652>>>>>>>                Entry_Item Btypkin.Btypkin_descr
55653>>>>>>>                Entry_Item Btypkin.Gtypkin_code
55654>>>>>>>                Entry_Item Btypkin.Ctypkin_code
55655>>>>>>>                Entry_Item Btypkin.Vtypkin_code
55656>>>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
55657>>>>>>>            End_Row
55662>>>>>>>
55662>>>>>>>            Set Form_Width    item 0 to 58
55663>>>>>>>            Set Header_Label  item 0 to "Btypkin recr"
55664>>>>>>>            
55664>>>>>>>            Set Form_Width    item 1 to 36
55665>>>>>>>            set header_label  item 1 to "‰å¤ž©ž" 
55666>>>>>>>            
55666>>>>>>>            Set Form_Width    item 2 to 86
55667>>>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
55668>>>>>>>            
55668>>>>>>>            Set Form_Width    item 3 to 36
55669>>>>>>>            set header_label  item 3 to "‰å¤ž©ž ‚Š" 
55670>>>>>>>            
55670>>>>>>>            Set Form_Width    item 4 to 36
55671>>>>>>>            set header_label  item 4 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
55672>>>>>>>            
55672>>>>>>>            Set Form_Width    item 5 to 36
55673>>>>>>>            set header_label  item 5 to "‰å¤ž©ž ¨¦£žŸœ¬«é¤" 
55674>>>>>>>            
55674>>>>>>>            Set Form_Width    item 6 to 53
55675>>>>>>>            set header_label  item 6 to "• ‘¬¤˜¢¢˜©¦£â¤¦¬" 
55676>>>>>>>            
55676>>>>>>>
55676>>>>>>>            //AB-StoreStart
55676>>>>>>>            Set Column_Option Item 0 to NoEnter True
55677>>>>>>>            
55677>>>>>>>            //AB-StoreEnd
55677>>>>>>>
55677>>>>>>>        End_Object    // oSelList
55678>>>>>>>
55678>>>>>>>        Object oOK_bn is a ButtonSub
55680>>>>>>>            set label to "&„§ ¢¦šã" 
55681>>>>>>>            Set Location to 178 194
55682>>>>>>>
55682>>>>>>>            //AB-StoreStart
55682>>>>>>>            Procedure OnClick
55684>>>>>>>                Send OK To oSelList
55685>>>>>>>            End_Procedure
55686>>>>>>>            //AB-StoreEnd
55686>>>>>>>
55686>>>>>>>        End_Object    // oOK_bn
55687>>>>>>>
55687>>>>>>>        Object oCancel_bn is a ButtonSub
55689>>>>>>>            set label to "&€¡ç¨à©ž" 
55690>>>>>>>            Set Location to 178 249
55691>>>>>>>
55691>>>>>>>            //AB-StoreStart
55691>>>>>>>            Procedure OnClick
55693>>>>>>>                Send Cancel To oSelList
55694>>>>>>>            End_Procedure
55695>>>>>>>            //AB-StoreEnd
55695>>>>>>>
55695>>>>>>>        End_Object    // oCancel_bn
55696>>>>>>>
55696>>>>>>>        Object oSearch_bn is a ButtonSub
55698>>>>>>>            set label to "€&¤˜ã«ž©ž" 
55699>>>>>>>            Set Location to 178 304
55700>>>>>>>
55700>>>>>>>            //AB-StoreStart
55700>>>>>>>            Procedure OnClick
55702>>>>>>>                Send Search To oSelList
55703>>>>>>>            End_Procedure
55704>>>>>>>            //AB-StoreEnd
55704>>>>>>>
55704>>>>>>>        End_Object    // oSearch_bn
55705>>>>>>>
55705>>>>>>>
55705>>>>>>>        //AB-StoreStart
55705>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
55706>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
55707>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
55708>>>>>>>        
55708>>>>>>>        //AB-StoreEnd
55708>>>>>>>
55708>>>>>>>    CD_End_Object    // SL031r
55710>>>>>>>>
55710>>>>>>>
55710>>>>>>>//AB/     End_Object    // prj
55710>>>>>    Use sl036r.sl
INCLUDING FILE: SL036R.SL
55710>>>>>>>//AB/ Project sl036r:Barticle with recr 1st col
55710>>>>>>>//AB/     Object prj is a Lookup_Project
55710>>>>>>>//AB/         Set ProjectName to "sl036r:Barticle with recr 1st col"
55710>>>>>>>//AB/         Set ProjectFileName to "sl036r.SL"
55710>>>>>>>//AB/         Set GenerateFileName to "NONAME"
55710>>>>>>>
55710>>>>>>>// Project Object Structure
55710>>>>>>>//   sl036r is a dbModalPanelSub
55710>>>>>>>//     Btypkin_DD is a DataDictionary
55710>>>>>>>//     Barticl_DD is a DataDictionary
55710>>>>>>>//     oSelList is a dbListSub
55710>>>>>>>//     oOK_bn is a ButtonSub
55710>>>>>>>//     oCancel_bn is a ButtonSub
55710>>>>>>>//     oSearch_bn is a ButtonSub
55710>>>>>>>
55710>>>>>>>// Register all objects
55710>>>>>>>Register_Object Barticl_DD
55710>>>>>>>Register_Object Btypkin_DD
55710>>>>>>>Register_Object oCancel_bn
55710>>>>>>>Register_Object oOK_bn
55710>>>>>>>Register_Object oSearch_bn
55710>>>>>>>Register_Object oSelList
55710>>>>>>>Register_Object sl036r
55710>>>>>>>
55710>>>>>>>
55710>>>>>>>    //AB-IgnoreStart
55710>>>>>>>
55710>>>>>>>    Use DFAllEnt.pkg
55710>>>>>>>    Use dbList.Sub
55710>>>>>>>    Use Button.Sub
55710>>>>>>>
55710>>>>>>>
55710>>>>>>>    Use BTYPKIN.DD
55710>>>>>>>    Use BARTICL.DD
55710>>>>>>>    
55710>>>>>>>    //AB-IgnoreEnd
55710>>>>>>>
55710>>>>>>>    CD_Popup_Object sl036r is a dbModalPanelSub
55729>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
55730>>>>>>>        Set Size to 148 440
55731>>>>>>>        Set Location to 4 5
55732>>>>>>>        Set Exit_Application_Local_State to FALSE
55733>>>>>>>        Set Modal_State to FALSE
55734>>>>>>>
55734>>>>>>>        //AB-DDOStart
55734>>>>>>>
55734>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
55736>>>>>>>        End_Object    // Btypkin_DD
55737>>>>>>>
55737>>>>>>>        Object Barticl_DD is a Barticl_DataDictionary
55739>>>>>>>            Set DDO_Server to (Btypkin_DD(self))
55740>>>>>>>        End_Object    // Barticl_DD
55741>>>>>>>
55741>>>>>>>        Set Main_DD to (Barticl_DD(self))
55742>>>>>>>        Set Server to (Barticl_DD(self))
55743>>>>>>>
55743>>>>>>>        //AB-DDOEnd
55743>>>>>>>
55743>>>>>>>        Object oSelList is a dbListSub
55745>>>>>>>            Set Main_File to Barticl.File_Number
55746>>>>>>>            Set Server to (Btypkin_DD(self))
55747>>>>>>>            Set Size to 105 424
55748>>>>>>>            Set Location to 6 6
55749>>>>>>>
55749>>>>>>>            Begin_Row
55752>>>>>>>                Entry_Item Barticl.Barticl_recr
55753>>>>>>>                Entry_Item Barticl.Barticl_no
55754>>>>>>>                Entry_Item Barticl.Barticl_hmnia
55755>>>>>>>                Entry_Item Btypkin.Btypkin_code
55756>>>>>>>                Entry_Item Btypkin.Btypkin_descr
55757>>>>>>>            End_Row
55762>>>>>>>
55762>>>>>>>            Set Form_Width    item 0 to 56
55763>>>>>>>            Set Header_Label  item 0 to "Barticl recr"
55764>>>>>>>            
55764>>>>>>>            Set Form_Width    item 1 to 84
55765>>>>>>>            set header_label  item 1 to "€¨ Ÿ£æª" 
55766>>>>>>>            
55766>>>>>>>            Set Form_Width    item 2 to 60
55767>>>>>>>            set header_label  item 2 to "†£œ¨¦£ž¤å˜" 
55768>>>>>>>            
55768>>>>>>>            Set Form_Width    item 3 to 38
55769>>>>>>>            set header_label  item 3 to "‰å¤ž©ž" 
55770>>>>>>>            
55770>>>>>>>            Set Form_Width    item 4 to 179
55771>>>>>>>            set header_label  item 4 to "œ¨ š¨˜­ã" 
55772>>>>>>>            
55772>>>>>>>
55772>>>>>>>            //AB-StoreStart
55772>>>>>>>            Set Column_Option Item 0 to NoEnter True
55773>>>>>>>            
55773>>>>>>>            //AB-StoreEnd
55773>>>>>>>
55773>>>>>>>        End_Object    // oSelList
55774>>>>>>>
55774>>>>>>>        Object oOK_bn is a ButtonSub
55776>>>>>>>            set label to "&„§ ¢¦šã" 
55777>>>>>>>            Set Location to 114 271
55778>>>>>>>
55778>>>>>>>            //AB-StoreStart
55778>>>>>>>            Procedure OnClick
55780>>>>>>>                Send OK To oSelList
55781>>>>>>>            End_Procedure
55782>>>>>>>            //AB-StoreEnd
55782>>>>>>>
55782>>>>>>>        End_Object    // oOK_bn
55783>>>>>>>
55783>>>>>>>        Object oCancel_bn is a ButtonSub
55785>>>>>>>            set label to "&€¡ç¨à©ž" 
55786>>>>>>>            Set Location to 114 327
55787>>>>>>>
55787>>>>>>>            //AB-StoreStart
55787>>>>>>>            Procedure OnClick
55789>>>>>>>                Send Cancel To oSelList
55790>>>>>>>            End_Procedure
55791>>>>>>>            //AB-StoreEnd
55791>>>>>>>
55791>>>>>>>        End_Object    // oCancel_bn
55792>>>>>>>
55792>>>>>>>        Object oSearch_bn is a ButtonSub
55794>>>>>>>            set label to "€&¤˜ã«ž©ž" 
55795>>>>>>>            Set Location to 114 381
55796>>>>>>>
55796>>>>>>>            //AB-StoreStart
55796>>>>>>>            Procedure OnClick
55798>>>>>>>                Send Search To oSelList
55799>>>>>>>            End_Procedure
55800>>>>>>>            //AB-StoreEnd
55800>>>>>>>
55800>>>>>>>        End_Object    // oSearch_bn
55801>>>>>>>
55801>>>>>>>
55801>>>>>>>        //AB-StoreStart
55801>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
55802>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
55803>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
55804>>>>>>>        
55804>>>>>>>        //AB-StoreEnd
55804>>>>>>>
55804>>>>>>>    CD_End_Object    // sl036r
55806>>>>>>>>
55806>>>>>>>
55806>>>>>>>//AB/     End_Object    // prj
55806>>>>>    use sl002.sl
55806>>>>>    //AB-StoreTopEnd
55806>>>>>
55806>>>>>    //AB-IgnoreStart
55806>>>>>
55806>>>>>    Use Rptvw.Sub
55806>>>>>    Use Group.Sub
55806>>>>>    Use Form.Sub
55806>>>>>    Use Txtbox.Sub
55806>>>>>    Use Chkbox.Sub
55806>>>>>    Use Rgroup.Sub
55806>>>>>    Use Radio.Sub
55806>>>>>    Use Button.Sub
55806>>>>>    Use DFAllEnt.pkg
55806>>>>>
55806>>>>>    //AB-IgnoreEnd
55806>>>>>
55806>>>>>    ACTIVATE_VIEW Activate_R044 FOR R044
55810>>>>>
55810>>>>>    Object R044 is a ReportViewSub
55812>>>>>
55812>>>>>        //AB-StoreTopStart
55812>>>>>        Property Integer Sort_IndexR044 0
55814>>>>>        property string  psbranch public ''
55816>>>>>        Open Syscurxr
55818>>>>>        open branch
55820>>>>>        //AB-StoreTopEnd
55820>>>>>
55820>>>>>        Set Label to "R044:†£œ¨¦¢æš ¦ €¥ ¦š¨á­à¤"
55821>>>>>        Set Size to 228 324
55822>>>>>        Set Location to 5 7
55823>>>>>
55823>>>>>        //AB-DDOStart
55823>>>>>
55823>>>>>
55823>>>>>        //AB-DDOEnd
55823>>>>>
55823>>>>>        Object GroupSub2 is a GroupSub
55825>>>>>            Set Label to "„§ ¢¦šã †£œ¨¦£ž¤å˜ª €¨Ÿ¨à¤"
55826>>>>>            Set Size to 28 317
55827>>>>>            Set Location to 28 3
55828>>>>>            Object FormSub1 is a FormSub
55830>>>>>                Set Size to 13 60
55831>>>>>                Set Location to 10 51
55832>>>>>                Set Label_Col_Offset to 2
55833>>>>>                Set Label_Justification_Mode to jMode_Right
55834>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
55835>>>>>                Set Form_Mask Item 0 to "dd/mm/yyyy"
55836>>>>>
55836>>>>>                //AB-StoreStart
55836>>>>>                set Form_Datatype item 0 to mask_date_window
55837>>>>>                
55837>>>>>                
55837>>>>>                //AB-StoreEnd
55837>>>>>
55837>>>>>            End_Object    // FormSub1
55838>>>>>
55838>>>>>            Object FormSub2 is a FormSub
55840>>>>>                Set Size to 13 60
55841>>>>>                Set Location to 10 164
55842>>>>>                Set Label_Col_Offset to 2
55843>>>>>                Set Label_Justification_Mode to jMode_Right
55844>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
55845>>>>>                Set Form_Mask Item 0 to "dd/MM/yy"
55846>>>>>
55846>>>>>                //AB-StoreStart
55846>>>>>                set Form_Datatype item 0 to mask_date_window
55847>>>>>                
55847>>>>>                
55847>>>>>                //AB-StoreEnd
55847>>>>>
55847>>>>>            End_Object    // FormSub2
55848>>>>>
55848>>>>>            Object TextBoxSub7 is a TextBoxSub
55850>>>>>                Set Label to "€§æ †£/¤å˜ "
55851>>>>>                Set Auto_Size_State to FALSE
55852>>>>>                Set FontSize to 4 0
55853>>>>>                Set Location to 10 5
55854>>>>>                Set Size to 10 41
55855>>>>>                Set Enabled_State to TRUE
55856>>>>>            End_Object    // TextBoxSub7
55857>>>>>
55857>>>>>            Object TextBoxSub8 is a TextBoxSub
55859>>>>>                Set Label to "„àª †£¤å˜  :"
55860>>>>>                Set Auto_Size_State to FALSE
55861>>>>>                Set FontSize to 4 0
55862>>>>>                Set Location to 11 124
55863>>>>>                Set Size to 10 37
55864>>>>>                Set Enabled_State to TRUE
55865>>>>>            End_Object    // TextBoxSub8
55866>>>>>
55866>>>>>        End_Object    // GroupSub2
55867>>>>>
55867>>>>>        Object GroupSub1 is a GroupSub
55869>>>>>            Set Label to "„§ ¢¦šã €¨Ÿ¨à¤"
55870>>>>>            Set Size to 46 151
55871>>>>>            Set Location to 58 3
55872>>>>>            Object frmG12_3 is a FormSub
55874>>>>>                Set Size to 13 71
55875>>>>>                Set Location to 10 60
55876>>>>>                Set Label_Col_Offset to 2
55877>>>>>                Set Label_Justification_Mode to jMode_Right
55878>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55879>>>>>                Set Form_Margin Item 0 to 14
55880>>>>>
55880>>>>>                //AB-StoreStart
55880>>>>>                Set Prompt_Object to (Sl036r(Current_object))
55881>>>>>                
55881>>>>>                //Procedure RetValue
55881>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
55881>>>>>                //End_Procedure // RetValue
55881>>>>>                
55881>>>>>                //// this is called by the prompt list upon initialization. This will let us
55881>>>>>                //// set special properties for the list's one time use. In this case we
55881>>>>>                //// want the intial column and the export column to be name (col 1)
55881>>>>>                //Procedure Prompt_Callback integer hPrompt
55881>>>>>                //    Integer liFld liBestColumn
55881>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
55881>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
55881>>>>>                //    Set Export_Column Of hPrompt        To liBestColumn
55881>>>>>                //    Set Initial_Column Of hPrompt       To liBestColumn
55881>>>>>                //    Set display_buffer_msg of hPrompt   to msg_RetValue
55881>>>>>                //end_procedure
55881>>>>>                
55881>>>>>                
55881>>>>>                
55881>>>>>                
55881>>>>>                
55881>>>>>                
55881>>>>>                //AB-StoreEnd
55881>>>>>
55881>>>>>            End_Object    // frmG12_3
55882>>>>>
55882>>>>>            Object frmG12_4 is a FormSub
55884>>>>>                Set Size to 13 71
55885>>>>>                Set Location to 27 60
55886>>>>>                Set Label_Col_Offset to 2
55887>>>>>                Set Label_Justification_Mode to jMode_Right
55888>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55889>>>>>                Set Form_Margin Item 0 to 14
55890>>>>>
55890>>>>>                //AB-StoreStart
55890>>>>>                Set Prompt_Object to (Sl036r(Current_object))
55891>>>>>                
55891>>>>>                //Procedure RetValue
55891>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
55891>>>>>                //End_Procedure // RetValue
55891>>>>>                //
55891>>>>>                //// this is called by the prompt list upon initialization. This will let us
55891>>>>>                //// set special properties for the list's one time use. In this case we
55891>>>>>                //// want the intial column and the export column to be name (col 1)
55891>>>>>                //Procedure Prompt_Callback integer hPrompt
55891>>>>>                //    Integer liFld liBestColumn
55891>>>>>                //
55891>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
55891>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
55891>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
55891>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
55891>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
55891>>>>>                //end_procedure // Prompt_Callback
55891>>>>>                //
55891>>>>>                
55891>>>>>                
55891>>>>>                
55891>>>>>                //AB-StoreEnd
55891>>>>>
55891>>>>>            End_Object    // frmG12_4
55892>>>>>
55892>>>>>            Object TextBoxSub3 is a TextBoxSub
55894>>>>>                Set Label to "€§æ €¨Ÿ¨¦  :"
55895>>>>>                Set Auto_Size_State to FALSE
55896>>>>>                Set FontSize to 4 0
55897>>>>>                Set Location to 10 5
55898>>>>>                Set Size to 10 45
55899>>>>>                Set Enabled_State to TRUE
55900>>>>>            End_Object    // TextBoxSub3
55901>>>>>
55901>>>>>            Object TextBoxSub4 is a TextBoxSub
55903>>>>>                Set Label to "„àª €¨Ÿ¨¦  :"
55904>>>>>                Set Auto_Size_State to FALSE
55905>>>>>                Set FontSize to 4 0
55906>>>>>                Set Location to 26 5
55907>>>>>                Set Size to 13 47
55908>>>>>                Set Enabled_State to TRUE
55909>>>>>            End_Object    // TextBoxSub4
55910>>>>>
55910>>>>>
55910>>>>>            //AB-StoreStart
55910>>>>>                                                                                                        
55910>>>>>                                                                                                        
55910>>>>>            //AB-StoreEnd
55910>>>>>
55910>>>>>        End_Object    // GroupSub1
55911>>>>>
55911>>>>>        Object GroupSub3 is a GroupSub
55913>>>>>            Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
55914>>>>>            Set Size to 46 160
55915>>>>>            Set Location to 58 159
55916>>>>>            Object frmG1 is a FormSub
55918>>>>>                Set Size to 13 63
55919>>>>>                Set Location to 10 60
55920>>>>>                Set Label_Col_Offset to 2
55921>>>>>                Set Label_Justification_Mode to jMode_Right
55922>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55923>>>>>                Set Form_Margin Item 0 to 6
55924>>>>>
55924>>>>>                //AB-StoreStart
55924>>>>>                Set Prompt_Object to (Sl031r(Current_object))
55925>>>>>                
55925>>>>>                //Procedure RetValue
55925>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
55925>>>>>                //End_Procedure // RetValue
55925>>>>>                //
55925>>>>>                //// this is called by the prompt list upon initialization. This will let us
55925>>>>>                //// set special properties for the list's one time use. In this case we
55925>>>>>                //// want the intial column and the export column to be name (col 1)
55925>>>>>                //Procedure Prompt_Callback integer hPrompt
55925>>>>>                //    Integer liFld liBestColumn
55925>>>>>                //
55925>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
55925>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
55925>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
55925>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
55925>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
55925>>>>>                //end_procedure // Prompt_Callback
55925>>>>>                
55925>>>>>                
55925>>>>>                
55925>>>>>                
55925>>>>>                //AB-StoreEnd
55925>>>>>
55925>>>>>            End_Object    // frmG1
55926>>>>>
55926>>>>>            Object frmG2 is a FormSub
55928>>>>>                Set Size to 13 63
55929>>>>>                Set Location to 27 60
55930>>>>>                Set Label_Col_Offset to 2
55931>>>>>                Set Label_Justification_Mode to jMode_Right
55932>>>>>                Set Prompt_Button_Mode to pb_PromptOn
55933>>>>>                Set Form_Margin Item 0 to 6
55934>>>>>
55934>>>>>                //AB-StoreStart
55934>>>>>                Set Prompt_Object to (Sl031r(Current_object))
55935>>>>>                
55935>>>>>                //Procedure RetValue
55935>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
55935>>>>>                //End_Procedure // RetValue
55935>>>>>                //
55935>>>>>                //// this is called by the prompt list upon initialization. This will let us
55935>>>>>                //// set special properties for the list's one time use. In this case we
55935>>>>>                //// want the intial column and the export column to be name (col 1)
55935>>>>>                //Procedure Prompt_Callback integer hPrompt
55935>>>>>                //    Integer liFld liBestColumn
55935>>>>>                //
55935>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
55935>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
55935>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
55935>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
55935>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
55935>>>>>                //end_procedure // Prompt_Callback
55935>>>>>                //
55935>>>>>                
55935>>>>>                
55935>>>>>                //AB-StoreEnd
55935>>>>>
55935>>>>>            End_Object    // frmG2
55936>>>>>
55936>>>>>            Object TextBoxSub9 is a TextBoxSub
55938>>>>>                Set Label to "€§æ ‰å¤ž©ž   :"
55939>>>>>                Set Auto_Size_State to FALSE
55940>>>>>                Set FontSize to 4 0
55941>>>>>                Set Location to 10 5
55942>>>>>                Set Size to 10 45
55943>>>>>                Set Enabled_State to TRUE
55944>>>>>            End_Object    // TextBoxSub9
55945>>>>>
55945>>>>>            Object TextBoxSub10 is a TextBoxSub
55947>>>>>                Set Label to "„àª ‰å¤ž©ž   :"
55948>>>>>                Set Auto_Size_State to FALSE
55949>>>>>                Set FontSize to 4 0
55950>>>>>                Set Location to 26 5
55951>>>>>                Set Size to 13 47
55952>>>>>                Set Enabled_State to TRUE
55953>>>>>            End_Object    // TextBoxSub10
55954>>>>>
55954>>>>>
55954>>>>>            //AB-StoreStart
55954>>>>>                                                                                                        
55954>>>>>                                                                                                        
55954>>>>>                                                                                                        
55954>>>>>                                                                                                        
55954>>>>>            //AB-StoreEnd
55954>>>>>
55954>>>>>        End_Object    // GroupSub3
55955>>>>>
55955>>>>>        Object oSelectCurr is a GroupSub
55957>>>>>            Set Label to "„§ ¢¦šã Œ¦£ ©£á«à¤"
55958>>>>>            Set Size to 28 317
55959>>>>>            Set Location to 106 3
55960>>>>>            Object chkbCurr0 is a CheckBoxSub
55962>>>>>                Set Label to "0"
55963>>>>>                Set Size to 10 21
55964>>>>>                Set Location to 12 15
55965>>>>>            End_Object    // chkbCurr0
55966>>>>>
55966>>>>>            Object chkbCurr00 is a CheckBoxSub
55968>>>>>                Set Label to "00"
55969>>>>>                Set Size to 10 25
55970>>>>>                Set Location to 12 90
55971>>>>>            End_Object    // chkbCurr00
55972>>>>>
55972>>>>>            Object chkbCurrR is a CheckBoxSub
55974>>>>>                Set Label to "rep"
55975>>>>>                Set Size to 10 27
55976>>>>>                Set Location to 12 162
55977>>>>>            End_Object    // chkbCurrR
55978>>>>>
55978>>>>>            Object chkbKeepTogether is a CheckBoxSub
55980>>>>>                Set Size to 10 17
55981>>>>>                Set Location to 12 251
55982>>>>>                Set Enabled_State to FALSE
55983>>>>>                Set Item_Shadow_State Item 0 to TRUE
55984>>>>>                Set Shadow_State Item 0 to TRUE
55985>>>>>
55985>>>>>                //AB-StoreStart
55985>>>>>                                                                                                                                            
55985>>>>>                Set Visible_State to False
55986>>>>>                //AB-StoreEnd
55986>>>>>
55986>>>>>            End_Object    // chkbKeepTogether
55987>>>>>
55987>>>>>        End_Object    // oSelectCurr
55988>>>>>
55988>>>>>        Object rdgSelectPrint is a RadioGroupSub
55990>>>>>            Set Label to "„¡«ç&§à©ž"
55991>>>>>            Set Size to 28 317
55992>>>>>            Set Location to 137 3
55993>>>>>            Object RadioSub5 is a RadioSub
55995>>>>>                Set Label to "ŽŸæ¤ž :"
55996>>>>>                Set Size to 10 36
55997>>>>>                Set Location to 12 6
55998>>>>>            End_Object    // RadioSub5
55999>>>>>
55999>>>>>            Object RadioSub6 is a RadioSub
56001>>>>>                Set Label to "„¡«¬§à«ãª : "
56002>>>>>                Set Size to 10 49
56003>>>>>                Set Location to 12 51
56004>>>>>            End_Object    // RadioSub6
56005>>>>>
56005>>>>>            Object rdFile is a RadioSub
56007>>>>>                Set Label to "€¨®œå¦"
56008>>>>>                Set Size to 10 41
56009>>>>>                Set Location to 12 113
56010>>>>>                Set Auto_Size_State to FALSE
56011>>>>>            End_Object    // rdFile
56012>>>>>
56012>>>>>            Object frmFile is a FormSub
56014>>>>>                Set Size to 13 144
56015>>>>>                Set Location to 10 158
56016>>>>>                Set Color to clBtnFace
56017>>>>>                Set Label_Col_Offset to 2
56018>>>>>                Set Enabled_State to FALSE
56019>>>>>                Set Item_Shadow_State Item 0 to TRUE
56020>>>>>                Set Shadow_State Item 0 to TRUE
56021>>>>>            End_Object    // frmFile
56022>>>>>
56022>>>>>
56022>>>>>            //AB-StoreStart
56022>>>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
56024>>>>>                If iNewItem EQ 0     Set Output_Device_Mode  To PRINT_TO_WINDOW
56027>>>>>                Else If iNewItem EQ 1   Set Output_Device_Mode  To PRINT_TO_PRINTER
56031>>>>>                Else If iNewItem EQ 2   Set Output_Device_Mode  To PRINT_TO_FILE
56035>>>>>                Set Enabled_State of frmFile to (iNewItem = 2)
56036>>>>>            End_Procedure
56037>>>>>            
56037>>>>>            
56037>>>>>            //AB-StoreEnd
56037>>>>>
56037>>>>>        End_Object    // rdgSelectPrint
56038>>>>>
56038>>>>>        Object FormSub5 is a FormSub
56040>>>>>            Set Size to 13 69
56041>>>>>            Set Location to 171 73
56042>>>>>            Set Label_Col_Offset to 2
56043>>>>>            Set Prompt_Button_Mode to pb_PromptOn
56044>>>>>
56044>>>>>            //AB-StoreStart
56044>>>>>            Set Prompt_Object to (sl002(Current_object))
56045>>>>>            
56045>>>>>            procedure onchange
56047>>>>>                string sbranch
56048>>>>>                get value item 0 to sbranch
56049>>>>>                clear branch
56050>>>>>                move syscurxr.company_code to branch.company_code
56051>>>>>                move sbranch               to branch.branch_code
56052>>>>>                find eq branch by index.1
56053>>>>>>
56053>>>>>                if (found=1) set value of (branch_name(self)) to branch.branch_name
56056>>>>>                else         set value of (branch_name(self)) to ''
56058>>>>>                set psbranch to branch.branch_code
56059>>>>>            end_procedure
56060>>>>>            
56060>>>>>            //AB-StoreEnd
56060>>>>>
56060>>>>>        End_Object    // FormSub5
56061>>>>>
56061>>>>>        Object oPrint_bn is a ButtonSub
56063>>>>>            Set Label to "„¡«â¢œ©ž (F2)"
56064>>>>>            Set Size to 18 53
56065>>>>>            Set Location to 193 208
56066>>>>>
56066>>>>>            //AB-StoreStart
56066>>>>>            Procedure OnClick
56068>>>>>                Send StartReport
56069>>>>>            End_Procedure // OnClick
56070>>>>>            
56070>>>>>            
56070>>>>>            //AB-StoreEnd
56070>>>>>
56070>>>>>        End_Object    // oPrint_bn
56071>>>>>
56071>>>>>        Object oExit_bn is a ButtonSub
56073>>>>>            Set Label to "„¥¦›¦ª (Esc)"
56074>>>>>            Set Size to 18 53
56075>>>>>            Set Location to 193 267
56076>>>>>
56076>>>>>            //AB-StoreStart
56076>>>>>            Procedure OnClick
56078>>>>>                Send Request_Cancel
56079>>>>>            End_Procedure // OnClick
56080>>>>>            
56080>>>>>            //AB-StoreEnd
56080>>>>>
56080>>>>>        End_Object    // oExit_bn
56081>>>>>
56081>>>>>        Object grpYear is a GroupSub
56083>>>>>            Set Size to 24 316
56084>>>>>            Set Location to 1 3
56085>>>>>            Object frmCompany is a FormSub
56087>>>>>                Set Size to 13 71
56088>>>>>                Set Location to 8 36
56089>>>>>                Set Color to clBtnFace
56090>>>>>                Set Label_Col_Offset to 2
56091>>>>>                Set Label_Justification_Mode to jMode_Right
56092>>>>>                Set Enabled_State to FALSE
56093>>>>>                Set Item_Shadow_State Item 0 to TRUE
56094>>>>>                Set Shadow_State Item 0 to TRUE
56095>>>>>            End_Object    // frmCompany
56096>>>>>
56096>>>>>            Object frmBranch is a FormSub
56098>>>>>                Set Size to 13 85
56099>>>>>                Set Location to 8 147
56100>>>>>                Set Color to clBtnFace
56101>>>>>                Set Label_Col_Offset to 2
56102>>>>>                Set Label_Justification_Mode to jMode_Right
56103>>>>>                Set Enabled_State to FALSE
56104>>>>>                Set Item_Shadow_State Item 0 to TRUE
56105>>>>>                Set Shadow_State Item 0 to TRUE
56106>>>>>            End_Object    // frmBranch
56107>>>>>
56107>>>>>            Object frmYear is a FormSub
56109>>>>>                Set Size to 13 43
56110>>>>>                Set Location to 8 268
56111>>>>>                Set Color to clBtnFace
56112>>>>>                Set Label_Col_Offset to 2
56113>>>>>                Set Label_Justification_Mode to jMode_Right
56114>>>>>                Set Enabled_State to FALSE
56115>>>>>                Set Item_Shadow_State Item 0 to TRUE
56116>>>>>                Set Shadow_State Item 0 to TRUE
56117>>>>>            End_Object    // frmYear
56118>>>>>
56118>>>>>            Object TextBoxSub11 is a TextBoxSub
56120>>>>>                Set Label to "„«˜ ¨œå˜"
56121>>>>>                Set Location to 8 3
56122>>>>>                Set Size to 10 30
56123>>>>>            End_Object    // TextBoxSub11
56124>>>>>
56124>>>>>            Object TextBoxSub12 is a TextBoxSub
56126>>>>>                Set Label to "“§¦¡/£˜"
56127>>>>>                Set Location to 9 109
56128>>>>>                Set Size to 10 33
56129>>>>>            End_Object    // TextBoxSub12
56130>>>>>
56130>>>>>            Object TextBoxSub13 is a TextBoxSub
56132>>>>>                Set Label to "•¨ã©ž           "
56133>>>>>                Set Location to 8 234
56134>>>>>                Set Size to 10 29
56135>>>>>            End_Object    // TextBoxSub13
56136>>>>>
56136>>>>>        End_Object    // grpYear
56137>>>>>
56137>>>>>        Object oClear_bn is a ButtonSub
56139>>>>>            Set Label to "€¡ç¨à©ž (F5)"
56140>>>>>            Set Size to 18 53
56141>>>>>            Set Location to 193 3
56142>>>>>            Set Focus_Mode to Pointer_Only
56143>>>>>
56143>>>>>            //AB-StoreStart
56143>>>>>                                                                                                        
56143>>>>>            Set MDI_Container to (R044(Self))
56144>>>>>            
56144>>>>>            Procedure OnClick
56146>>>>>                Delegate Send Request_Clear
56148>>>>>                Forward Send OnClick
56150>>>>>            End_Procedure // OnClick
56151>>>>>            
56151>>>>>            
56151>>>>>            
56151>>>>>            
56151>>>>>            //AB-StoreEnd
56151>>>>>
56151>>>>>        End_Object    // oClear_bn
56152>>>>>
56152>>>>>        Object Textbox1 is a Textbox
56154>>>>>            Set Label to "“§¦¡˜«á©«ž£˜"
56155>>>>>            Set Location to 172 5
56156>>>>>            Set Size to 10 54
56157>>>>>            Set FontWeight to 600
56158>>>>>        End_Object    // Textbox1
56159>>>>>
56159>>>>>        Object branch_name is a FormSub
56161>>>>>            Set Size to 13 145
56162>>>>>            Set Location to 170 161
56163>>>>>            Set Label_Col_Offset to 2
56164>>>>>
56164>>>>>            //AB-StoreStart
56164>>>>>            set enabled_state to false
56165>>>>>            //AB-StoreEnd
56165>>>>>
56165>>>>>        End_Object    // branch_name
56166>>>>>
56166>>>>>
56166>>>>>        //AB-StoreStart
56166>>>>>                
56166>>>>>        Property String     pdDate_To           ""
56168>>>>>        Property String     pdDate_From         ""
56170>>>>>        
56170>>>>>        //jsjsjs 29/01/2001
56170>>>>>        //Property Number pnSelArthro     0
56170>>>>>        //Property Number pnSelArthro_1   0
56170>>>>>        //Property Number pnSelArthro_2   0
56170>>>>>        //Property Integer    piBtypKin_Code_From  0
56170>>>>>        //Property Integer    piBtypKin_Code_To    0
56170>>>>>        Property String psBtypKin_Recr_From     ''
56172>>>>>        Property String psBtypKin_recr_To       ''
56174>>>>>        Property String psSelArthro             ''
56176>>>>>        Property String psSelArthro_1           ''
56178>>>>>        Property String psSelArthro_2           ''
56180>>>>>        //jsjsjs 29/01/2001
56180>>>>>        
56180>>>>>        Property Integer piSeries 0
56182>>>>>        Property Integer piKeepSectionTogether 0 //All one by one currencies
56184>>>>>        Property Integer piState1 0
56186>>>>>        Property Integer piState2 0
56188>>>>>        Property Integer piState3 0
56190>>>>>        Property Integer piFromGmoveView False
56192>>>>>        
56192>>>>>        Procedure PrintCurrArthro String asSelectedArthro String asPrinter String lsBtypkinRecr Date ldBarticlHmnia
56194>>>>>            Integer liRptId
56195>>>>>            Set psSelArthro to asSelectedArthro
56196>>>>>            if (psSelArthro(Self) <> '') Begin
56198>>>>>                Set pdDate_To           to ldBarticlHmnia
56199>>>>>                Set pdDate_From         to ldBarticlHmnia
56200>>>>>                Set psBtypKin_Recr_From to lsBtypkinRecr
56201>>>>>                Set psBtypKin_Recr_To   to lsBtypkinRecr
56202>>>>>                Get Report_Object_Id    to liRptId
56203>>>>>                If (liRptId) Send Rebuild_Constraints to liRptId
56206>>>>>                Set piFromGmoveView     to True
56207>>>>>                If (asPrinter = "") Move "lpt1:" to asPrinter
56210>>>>>                Set Output_Device_Name  To asPrinter
56211>>>>>                Send Run_Report
56212>>>>>                Set piFromGmoveView     to False
56213>>>>>                Set psSelArthro         to ''
56214>>>>>                Set pdDate_To           to ''
56215>>>>>                Set pdDate_From         to ''
56216>>>>>                Set psBtypKin_Recr_From to ''
56217>>>>>                Set psBtypKin_Recr_To   to ''
56218>>>>>            end
56218>>>>>>
56218>>>>>        End_Procedure // PrintCurrArthro
56219>>>>>        
56219>>>>>        Procedure StartReport
56221>>>>>            Integer iOutputDevice liRptId
56222>>>>>            String  FileName
56222>>>>>            Date ldDate_From ldDate_To
56222>>>>>            Integer liGthaa_044
56222>>>>>            String lsSelArthro_1 lsSelArthro_2 lsBtypKin_Recr_From lsBtypKin_Recr_To
56222>>>>>            Integer liState1 liState2 liState3 liKeepSectionTogether
56222>>>>>        
56222>>>>>            Get Output_Device_Mode To iOutputDevice
56223>>>>>        
56223>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
56225>>>>>               Make_Temp_File "TXT" FileName
56226>>>>>               Move (".\" - FileName)  To FileName
56227>>>>>               Set Output_Device_Name  To FileName
56228>>>>>            End
56228>>>>>>
56228>>>>>            Else If iOutputDevice EQ PRINT_TO_PRINTER ;               Set Output_Device_Name  To "Lpt1:"
56232>>>>>            Else If iOutputDevice EQ PRINT_TO_FILE Begin
56235>>>>>               Get Value of (frmFile(rdgSelectPrint (Self))) Item 0 to FileName
56236>>>>>               If (FileName = "") Make_Temp_File "TXT" FileName
56239>>>>>               Move (".\" - FileName)  To FileName
56240>>>>>               Set Output_Device_Name  To FileName
56241>>>>>            End
56241>>>>>>
56241>>>>>        
56241>>>>>            Get value of (FormSub1(GroupSub2(Self))) item 0 to ldDate_From
56242>>>>>            Set pdDate_From to ldDate_From
56243>>>>>            Get value of (FormSub2(GroupSub2(Self))) item 0 to ldDate_To
56244>>>>>            Set pdDate_To to ldDate_To
56245>>>>>        
56245>>>>>            Get value of (FrmG1(GroupSub3(Self))) item 0 to lsBtypKin_Recr_From
56246>>>>>            Set psBtypKin_Recr_From to (Trim(lsBtypKin_Recr_From))
56247>>>>>            Get value of (FrmG2(GroupSub3(Self))) item 0 to lsBtypKin_Recr_To
56248>>>>>            Set psBtypKin_Recr_To to (Trim(lsBtypKin_Recr_To))
56249>>>>>        
56249>>>>>            Get value of (FrmG12_3(GroupSub1(Self))) item 0 to lsSelArthro_1
56250>>>>>            Set psSelArthro_1 to (Trim(lsSelArthro_1))
56251>>>>>            Get value of (FrmG12_4(GroupSub1(Self))) item 0 to lsSelArthro_2
56252>>>>>            Set psSelArthro_2 to (Trim(lsSelArthro_2))
56253>>>>>        
56253>>>>>            Set piSeries to 0
56254>>>>>        
56254>>>>>            //--------------------------------------------------------------------------------
56254>>>>>            Get checked_State of (chkbCurr0(oSelectCurr(Self))) to liState1
56255>>>>>            Set piState1 to liState1
56256>>>>>            Get checked_State of (chkbCurr00(oSelectCurr(Self))) to liState2
56257>>>>>            Set piState2 to liState2
56258>>>>>            Get checked_State of (chkbCurrR(oSelectCurr(Self))) to liState3
56259>>>>>            Set piState3 to liState3
56260>>>>>            Get checked_State of (chkbKeepTogether(oSelectCurr(Self))) to liKeepSectionTogether
56261>>>>>            Set piKeepSectionTogether to liKeepSectionTogether
56262>>>>>            //--------------------------------------------------------------------------------
56262>>>>>        
56262>>>>>            Get Report_Object_Id to liRptId
56263>>>>>            If (liRptId) Send Rebuild_Constraints to liRptId
56266>>>>>        
56266>>>>>            if (piState1(Self) = 1) begin
56268>>>>>                    Set piSeries to 1 //Book1
56269>>>>>                    Set piState1 to 0
56270>>>>>                    Send Run_Report
56271>>>>>            end
56271>>>>>>
56271>>>>>            if (piState2(Self) = 1) begin
56273>>>>>                    Set piSeries to 2 //Book2
56274>>>>>                    Set piState2 to 0
56275>>>>>                    send Run_Report
56276>>>>>            end
56276>>>>>>
56276>>>>>            if (piState3(Self) = 1) begin
56278>>>>>                    Set piSeries to 3 //Reporting
56279>>>>>                    Set piState3 to 0
56280>>>>>                    send Run_Report
56281>>>>>            end
56281>>>>>>
56281>>>>>            If (piSeries(Self) = 0) send Run_Report
56284>>>>>        
56284>>>>>            if (piKeepSectionTogether(Self) = 1) begin
56286>>>>>                Set piKeepSectionTogether to 0
56287>>>>>                send page_bottom to (BMoves_BasicReport(Self))
56288>>>>>                formfeed
56289>>>>>>
56289>>>>>            end
56289>>>>>>
56289>>>>>        
56289>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
56291>>>>>               //Send DoRunEditor FileName "Empor"
56291>>>>>               RunProgram background "NotePad" FileName
56292>>>>>               EraseFile FileName
56293>>>>>>
56293>>>>>            End
56293>>>>>>
56293>>>>>        End_Procedure   // StartReport
56294>>>>>        
56294>>>>>        Function Bank_Descr String asCode Returns string
56296>>>>>            String lsDescr
56297>>>>>        
56297>>>>>            Clear Codemast
56298>>>>>            Move "BANK" to CodeMast.Type
56299>>>>>            Move asCode to CodeMast.Code
56300>>>>>            Find eq Codemast by Index.1
56301>>>>>>
56301>>>>>            [Found] Move (Trim(Codemast.Description)) to lsDescr
56302>>>>>            Function_Return lsDescr
56303>>>>>        End_Function // Bank_Descr
56304>>>>>        
56304>>>>>        Object BMoves_BasicReport is a BasicReportSub
56306>>>>>        
56306>>>>>            if (piKeepSectionTogether(Self) = 1) begin
56308>>>>>                set new_page_state to false
56309>>>>>            end
56309>>>>>>
56309>>>>>        
56309>>>>>           Set report_view_id to (Parent(Self))
56310>>>>>           set report_caption to "ƒ ˜› ¡˜©å˜ ©œ œ¥â¢ ¥ž             "
56311>>>>>           set report_title to "„¡«ç§à©ž €¨Ÿ¨à¤                     "
56312>>>>>           Report_Main_File BMove
56313>>>>>           Report_breaks Bmove.Barticl_Hmnia Bmove.Barticl_Recr
56327>>>>>        
56327>>>>>           Procedure Constrain
56329>>>>>                //jsjsjs 29/01/2001 Number lnSelArthro lnSelArthro_1 lnSelArthro_2
56329>>>>>                String lsSelArthro lsSelArthro_1 lsSelArthro_2 sbranch
56330>>>>>                Integer liGarticlStatusE
56330>>>>>                get psbranch to sbranch
56331>>>>>                Constrain Bmove.Company_Code eq SysCurXr.Company_Code
56333>>>>>                if (sbranch<>'');                    Constrain Bmove.Branch_Code  eq Sbranch
56337>>>>>                Constrain Bmove.Year_Year    eq SysCurXr.Year_Year
56339>>>>>        
56339>>>>>                Get psSelArthro     to lsSelArthro
56340>>>>>                Get psSelArthro_1   to lsSelArthro_1
56341>>>>>                Get psSelArthro_2   to lsSelArthro_2
56342>>>>>        
56342>>>>>                If (pdDate_From        (Self)<>'')  Constrain Bmove.Barticl_Hmnia ge (pdDate_From(Self))
56346>>>>>                If (pdDate_To          (Self)<>'')  Constrain Bmove.Barticl_Hmnia le (pdDate_To(Self))
56350>>>>>                if (psBtypKin_Recr_From(Self)<>'')  Constrain Bmove.Btypkin_Recr  ge (psBtypKin_Recr_From(Self))
56354>>>>>                if (psBtypKin_Recr_To  (Self)<>'')  Constrain Bmove.Btypkin_Recr  le (psBtypKin_Recr_To(Self))
56358>>>>>                if (lsSelArthro              <>'')  Constrain Bmove.Barticl_recr  eq lsSelArthro
56362>>>>>                Else if ((lsSelArthro_1<>'') OR (lsSelArthro_2 <> '')) Begin
56365>>>>>                     If  (lsSelArthro_1<>'') Constrain Bmove.Barticl_recr ge lsSelArthro_1
56369>>>>>                     If  (lsSelArthro_2<>'') Constrain Bmove.Barticl_recr le lsSelArthro_2
56373>>>>>                End
56373>>>>>>
56373>>>>>                Forward Send Constrain
56375>>>>>           End_Procedure // Constrain
56376>>>>>        
56376>>>>>           Function Starting_Report Returns Integer
56378>>>>>                Zero_SubTotals SubHeaderR044_1.10
56379>>>>>                Zero_SubTotals BodyR044.7 BodyR044.10 RecParArticl.1
56382>>>>>                Zero_SubTotals SubtotalR044_2.1 SubtotalR044_2.2
56384>>>>>           End_Function // Starting_Report
56385>>>>>        
56385>>>>>           Function Starting_Main_Report Returns Integer
56387>>>>>              Integer iRetVal
56388>>>>>              Integer iIndexR044 liRepPanelId
56388>>>>>              Forward Get Starting_Main_Report to iRetval
56390>>>>>        
56390>>>>>              If (piFromGmoveView(Self)) Begin
56392>>>>>                   Move 5 to iIndexR044  //
56393>>>>>              End
56393>>>>>>
56393>>>>>              Else Begin
56394>>>>>                   Move 5 to iIndexR044
56395>>>>>              End
56395>>>>>>
56395>>>>>              Report_Index BY iIndexR044    // set the sort order
56397>>>>>              Blankform FooterR044_1.1
56398>>>>>>
56398>>>>>              Get Report_Status_Panel to liRepPanelId
56399>>>>>              set button_text of lireppanelid to "&€¡ç¨à©ž"
56400>>>>>              Set page_feed to  0 //66 // default -2
56401>>>>>              Set page_end  to 63    // default 59
56402>>>>>              Function_Return iRetval
56403>>>>>           End_Function
56404>>>>>        
56404>>>>>           Procedure_Section Page_Top as HeaderR044
56409>>>>>              Integer iPage
56409>>>>>              string sbranch
56409>>>>>              Get Page_Count  To iPage
56410>>>>>              get psbranch    to sbranch
56411>>>>>              clear branch
56412>>>>>              move syscurxr.company_code to branch.company_code
56413>>>>>              move sbranch               to branch.branch_code
56414>>>>>              find eq branch by index.1
56415>>>>>>
56415>>>>>              if (found=1) print branch.branch_name to HeaderR044.2
56418>>>>>              else         print ''                 to HeaderR044.2
56420>>>>>              print SysCurXr.Company_Name to HeaderR044.1
56421>>>>>            //  print SysCurXr.Branch_Name  to HeaderR044.2
56421>>>>>              print SysCurXr.Year_Descr   to HeaderR044.3
56422>>>>>        
56422>>>>>             // Print iPage                to HeaderR044.7
56422>>>>>              OutPut_PageCheck
56423>>>>>           End_Procedure
56424>>>>>        
56424>>>>>           Procedure_Section SubHeader1
56426>>>>>           End_Procedure // SubHeader1
56427>>>>>        
56427>>>>>           Procedure_Section SubHeader2 as SubheaderR044_1
56432>>>>>              Integer iPage liSeries
56432>>>>>              Number lnYpol
56432>>>>>              String lsCCode
56432>>>>>        
56432>>>>>        
56432>>>>>              Get piSeries to liSeries
56433>>>>>              Print Btypkin.Btypkin_Pdescr to SubheaderR044_1.1
56434>>>>>              Print Btypkin.Btypkin_Seira  to SubheaderR044_1.2
56435>>>>>              Print Btypkin.Btypkin_Code   to SubheaderR044_1.3
56436>>>>>              Print Barticl.Barticl_No     to SubheaderR044_1.4
56437>>>>>              Print Barticl.Barticl_Rec0   to SubheaderR044_1.5
56438>>>>>              Print Barticl.Barticl_Hmnia  to SubheaderR044_1.6
56439>>>>>              Print Barticl.Barticl_Epon1  to SubheaderR044_1.7
56440>>>>>              Print Barticl.Barticl_Epon2  to SubheaderR044_1.8
56441>>>>>        
56441>>>>>              If (liSeries = 1) Begin
56443>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
56444>>>>>                Move Year.Year_C_Code0    to lsCCode
56445>>>>>              End
56445>>>>>>
56445>>>>>              Else If (liSeries = 2) Begin
56448>>>>>                Move Barticl.Barticl_Sv00 to lnYpol
56449>>>>>                Move Year.Year_C_Code00   to lsCCode
56450>>>>>              End
56450>>>>>>
56450>>>>>              Else If (liSeries = 3) Begin
56453>>>>>                Move Barticl.Barticl_SvR  to lnYpol
56454>>>>>                Move Year.Year_C_CodeR    to lsCCode
56455>>>>>              End
56455>>>>>>
56455>>>>>              Else If (liSeries = 0) Begin
56458>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
56459>>>>>                Move Year.Year_C_Code0    to lsCCode
56460>>>>>              End
56460>>>>>>
56460>>>>>              Print lscCode                to SubheaderR044_1.9
56461>>>>>              Print lnYpol                 to SubheaderR044_1.10
56462>>>>>              Print Barticl.Barticl_Aitiol to SubheaderR044_1.11
56463>>>>>        
56463>>>>>              OutPut_PageCheck
56464>>>>>           End_Procedure
56465>>>>>        
56465>>>>>           Procedure_Section  Body as BodyR044
56470>>>>>             Integer liSeries
56470>>>>>             Number lnAjia
56470>>>>>             String lsCCode
56470>>>>>        
56470>>>>>             send update_status ('„šš¨˜­ã ' + string(barticl.barticl_hmnia) + ":" +  string(bmove.bmove_rec0))
56471>>>>>             Get piSeries to liSeries
56472>>>>>             Print Bmove.Bmove_aa                to BodyR044.1
56473>>>>>             Print Baxiokat.Baxiokat_Descr       to BodyR044.2
56474>>>>>             Print Baxio.Baxio_Code              to BodyR044.3
56475>>>>>             Print (Bank_Descr(Self,Baxio.Baxio_Banka))    to BodyR044.4
56476>>>>>             Print Baxio.Baxio_No                to BodyR044.5
56477>>>>>        
56477>>>>>             Print Baxio.Baxio_C_Code2           to BodyR044.6
56478>>>>>             Print Baxio.Baxio_V2                to BodyR044.7 //{ points=2} //Reccord
56479>>>>>        
56479>>>>>             Print Baxio.Baxio_Hmnial            to BodyR044.8
56480>>>>>        
56480>>>>>             if (liSeries = 1) begin
56482>>>>>                Move Year.Year_C_Code0  to lsCCode
56483>>>>>                Move Baxio.Baxio_V0     to lnAjia
56484>>>>>             end
56484>>>>>>
56484>>>>>             if (liSeries = 2) begin
56486>>>>>                Move Year.Year_C_Code00 to lsCCode
56487>>>>>                Move Baxio.Baxio_V00    to lnAjia
56488>>>>>             End
56488>>>>>>
56488>>>>>             if (liSeries = 3) begin
56490>>>>>                Move Year.Year_C_CodeR  to lsCCode
56491>>>>>                 Move Baxio.Baxio_VR    to lnAjia
56492>>>>>             End
56492>>>>>>
56492>>>>>             if (liSeries = 0) begin
56494>>>>>                Move Year.Year_C_Code0  to lsCCode
56495>>>>>                Move Baxio.Baxio_V0     to lnAjia
56496>>>>>             end
56496>>>>>>
56496>>>>>        
56496>>>>>             Print lsCCode                       to BodyR044.9  //{ points=2} BOOK
56497>>>>>             Print lnAjia                        to BodyR044.10 //{ points=2} BOOK
56498>>>>>             Add 1 to RecParArticl.1
56499>>>>>             OutPut_PageCheck
56500>>>>>           End_Procedure
56501>>>>>        
56501>>>>>           Procedure_Section  Subtotal2 as SubtotalR044_2
56506>>>>>        
56506>>>>>             Print    RecParArticl.1   to SubtotalR044_2.1
56507>>>>>             Subtotal BodyR044.10      to SubtotalR044_2.2 //{ points=2}
56509>>>>>             BlankForm RecParArticl.1
56510>>>>>>
56510>>>>>        
56510>>>>>             OutPut_PageCheck
56511>>>>>           end_Procedure  // Subtotal2
56512>>>>>        
56512>>>>>           Procedure_Section  Subtotal1 as SubtotalR044_1
56517>>>>>        
56517>>>>>             //Subtotal SubtotalR044_2.2 to SubtotalR044_1.1 { points=2}
56517>>>>>             //Subtotal SubtotalR044_2.3 to SubtotalR044_1.2 { points=2}
56517>>>>>        
56517>>>>>             //If (piFromGmoveView(Self)=0) OutPut_PageCheck
56517>>>>>        
56517>>>>>           end_Procedure // Subtotal1
56518>>>>>        
56518>>>>>           Procedure_Section Page_Bottom as FooterR044_1
56527>>>>>               if (piKeepSectionTogether(self) <> 1)  OutPut_PageCheck
56530>>>>>           End_Procedure
56531>>>>>        
56531>>>>>        
56531>>>>>           Procedure Ending_Report
56533>>>>>               Integer rVal
56534>>>>>               Blankform SubtotalR044_2.1
56535>>>>>>
56535>>>>>               // „§˜¤˜­¦¨á «à¤ Buffers
56535>>>>>               Get fiRefindYear to rVal
56536>>>>>           End_Procedure
56537>>>>>        
56537>>>>>        End_Object // GMoves_BasicReport
56538>>>>>        
56538>>>>>        Procedure Activate_View Returns Integer
56540>>>>>            Integer Rval
56541>>>>>            Forward Get MSG_Activate_View   to Rval
56543>>>>>            If (Not(rVal))  Begin
56545>>>>>                Set Value of (frmCompany(grpYear(Self))) to SysCurXr.Company_Name
56546>>>>>                Set Value of (frmBranch(grpYear(Self)))  to SysCurXr.Branch_Name
56547>>>>>                Set Value of (frmYear(grpYear(Self)))    to SysCurXr.Year_Descr
56548>>>>>                set value of (formsub5(self))            to SysCurXr.Branch_code
56549>>>>>                set label of (chkbCurr0(oSelectCurr(Self)))  To SysCurXr.C_Code0
56550>>>>>                set label of (chkbCurr00(oSelectCurr(Self))) To SysCurXr.C_Code00
56551>>>>>                set label of (chkbCurrR(oSelectCurr(Self)))  To SysCurXr.C_CodeR
56552>>>>>                Set checked_State of (chkbCurr0(oSelectCurr(Self))) to 1
56553>>>>>            End
56553>>>>>>
56553>>>>>            Procedure_Return rVal
56554>>>>>        End_Procedure // Activate_View
56555>>>>>        
56555>>>>>        Procedure Request_Clear
56557>>>>>            Set Value of (FormSub1(GroupSub2(Self))) Item 0 to ""
56558>>>>>            Set Value of (FormSub2(GroupSub2(Self))) Item 0 to ""
56559>>>>>            Set Value of (frmG12_3(GroupSub1(Self))) Item 0 to ""
56560>>>>>            Set Value of (frmG12_4(GroupSub1(Self))) Item 0 to ""
56561>>>>>            Set Value of (frmG1(GroupSub3(Self))) Item 0 to ""
56562>>>>>            Set Value of (frmG2(GroupSub3(Self))) Item 0 to ""
56563>>>>>            Set checked_State of (chkbCurr0(oSelectCurr(Self))) to True
56564>>>>>            Set checked_State of (chkbCurr00(oSelectCurr(Self))) to False
56565>>>>>            Set checked_State of (chkbCurrR(oSelectCurr(Self))) to False
56566>>>>>            Set checked_State of (chkbKeepTogether(oSelectCurr(Self))) to False
56567>>>>>            Send Activate to (FormSub1(GroupSub2(Self)))
56568>>>>>        End_Procedure // Request_Clear
56569>>>>>        
56569>>>>>        //Set Verify_Exit_Msg To Get_No_Confirmation
56569>>>>>        On_Key kSave_Record Send KeyAction to oPrint_bn
56570>>>>>        On_Key kCancel      Send KeyAction to oExit_bn
56571>>>>>        On_Key kClear       Send Request_Clear
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        
56572>>>>>        //AB-StoreEnd
56572>>>>>
56572>>>>>    End_Object    // R044
56573>>>>>
56573>>>>>
56573>>>>>    //AB-StoreStart
56573>>>>>            
56573>>>>>            
56573>>>>>            
56573>>>>>            
56573>>>>>            
56573>>>>>            
56573>>>>>    //AB-StoreEnd
56573>>>>>
56573>>>>>//AB/     End_Object    // prj
56573>>>Use v037.vw
56573>>>Use sl100.sl
56573>>>Use sl036.sl
INCLUDING FILE: SL036.SL
56573>>>>>//AB/ Project SL036:BARTICL
56573>>>>>//AB/     Object prj is a Lookup_Project
56573>>>>>//AB/         Set ProjectName to "SL036:BARTICL"
56573>>>>>//AB/         Set ProjectFileName to "SL036.SL"
56573>>>>>
56573>>>>>// Project Object Structure
56573>>>>>//   SL036 is a dbModalPanelSub
56573>>>>>//     Btypkin_DD is a DataDictionary
56573>>>>>//     Barticl_DD is a DataDictionary
56573>>>>>//     oSelList is a dbListSub
56573>>>>>//     oOK_bn is a ButtonSub
56573>>>>>//     oCancel_bn is a ButtonSub
56573>>>>>//     oSearch_bn is a ButtonSub
56573>>>>>
56573>>>>>// Register all objects
56573>>>>>Register_Object Barticl_DD
56573>>>>>Register_Object Btypkin_DD
56573>>>>>Register_Object oCancel_bn
56573>>>>>Register_Object oOK_bn
56573>>>>>Register_Object oSearch_bn
56573>>>>>Register_Object oSelList
56573>>>>>Register_Object SL036
56573>>>>>
56573>>>>>
56573>>>>>    //AB-IgnoreStart
56573>>>>>
56573>>>>>    Use DFAllEnt.pkg
56573>>>>>    Use dbList.Sub
56573>>>>>    Use Button.Sub
56573>>>>>
56573>>>>>
56573>>>>>    Use BTYPKIN.DD
56573>>>>>    Use BARTICL.DD
56573>>>>>    
56573>>>>>    //AB-IgnoreEnd
56573>>>>>
56573>>>>>    Object SL036 is a dbModalPanelSub
56575>>>>>
56575>>>>>        //AB-StoreTopStart
56575>>>>>        Property String     psClientID      Public ''
56577>>>>>        Property String     psEponymo       Public ''
56579>>>>>        Property Date       pdHmnia         Public ''
56581>>>>>        Property Integer    piTypkinCode    Public  0
56583>>>>>        
56583>>>>>        
56583>>>>>        //AB-StoreTopEnd
56583>>>>>
56583>>>>>        Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
56584>>>>>        Set Size to 288 522
56585>>>>>        Set Location to 6 3
56586>>>>>        Set Exit_Application_Local_State to FALSE
56587>>>>>        Set Modal_State to FALSE
56588>>>>>
56588>>>>>        //AB-DDOStart
56588>>>>>
56588>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
56590>>>>>        End_Object    // Btypkin_DD
56591>>>>>
56591>>>>>        Object Barticl_DD is a Barticl_DataDictionary
56593>>>>>            Set DDO_Server to (Btypkin_DD(self))
56594>>>>>
56594>>>>>            //AB-StoreStart
56594>>>>>                                            
56594>>>>>            Begin_Constraints
56596>>>>>                String  sClientID
56597>>>>>                Date    dHmnia
56597>>>>>                Integer iTypkinCode
56597>>>>>            
56597>>>>>                Get piTypkinCode    to iTypkinCode
56598>>>>>                Get psClientID      to sClientID
56599>>>>>                Get pdHmnia         to dHmnia
56600>>>>>            
56600>>>>>                Constrain Barticl.Company_Code  Eq Syscurxr.Company_Code
56602>>>>>                Constrain Barticl.Branch_Code   Eq Syscurxr.Branch_Code
56604>>>>>                Constrain Barticl.Year_Year     Eq Syscurxr.Year_Year
56606>>>>>            
56606>>>>>                If (sClientID  <> 0) Begin
56608>>>>>                    If (iTypkinCode<> 0) Begin
56610>>>>>                        Set Ordering to 8
56611>>>>>                        Constrain Barticl.Btypkin_Code  Eq iTypkinCode
56613>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
56615>>>>>                    End
56615>>>>>>
56615>>>>>                    Else Begin
56616>>>>>                        Set Ordering to 10
56617>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
56619>>>>>                    End
56619>>>>>>
56619>>>>>                End
56619>>>>>>
56619>>>>>                Else If (dHmnia     <>'') Begin
56622>>>>>                    Set Ordering to 9
56623>>>>>                    Constrain Barticl.Barticl_Hmnia Eq dHmnia
56625>>>>>                End
56625>>>>>>
56625>>>>>                Else If (iTypkinCode<> 0) Begin
56628>>>>>                    Set Ordering to 1
56629>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
56631>>>>>                End
56631>>>>>>
56631>>>>>            End_Constraints
56634>>>>>            
56634>>>>>            //AB-StoreEnd
56634>>>>>
56634>>>>>        End_Object    // Barticl_DD
56635>>>>>
56635>>>>>        Set Main_DD to (Barticl_DD(self))
56636>>>>>        Set Server to (Barticl_DD(self))
56637>>>>>
56637>>>>>        //AB-DDOEnd
56637>>>>>
56637>>>>>        Object oSelList is a dbListSub
56639>>>>>            Set Main_File to Barticl.File_Number
56640>>>>>            Set Server to (Btypkin_DD(self))
56641>>>>>            Set Size to 238 508
56642>>>>>            Set Location to 4 5
56643>>>>>
56643>>>>>            Begin_Row
56646>>>>>                Entry_Item Barticl.Barticl_no
56647>>>>>                Entry_Item Barticl.Arith_orist
56648>>>>>                Entry_Item Barticl.Barticl_hmnia
56649>>>>>                Entry_Item Btypkin.Btypkin_code
56650>>>>>                Entry_Item Btypkin.Btypkin_descr
56651>>>>>                Entry_Item Barticl.Barticl_epon1
56652>>>>>                Entry_Item Barticl.Barticl_sv0
56653>>>>>            End_Row
56658>>>>>
56658>>>>>            Set Form_Width    item 0 to 60
56659>>>>>            Set Header_Label  item 0 to "€¨ Ÿ£æª"
56660>>>>>            
56660>>>>>            Set Form_Width    item 1 to 60
56661>>>>>            Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
56662>>>>>            
56662>>>>>            Set Form_Width    item 2 to 57
56663>>>>>            Set Header_Label  item 2 to "†£œ¨¦£ž¤å˜"
56664>>>>>            
56664>>>>>            Set Form_Width    item 3 to 41
56665>>>>>            Set Header_Label  item 3 to "‰å¤ž©ž"
56666>>>>>            
56666>>>>>            Set Form_Width    item 4 to 140
56667>>>>>            Set Header_Label  item 4 to "œ¨ š¨˜­ã"
56668>>>>>            
56668>>>>>            Set Form_Width    item 5 to 90
56669>>>>>            Set Header_Label  item 5 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
56670>>>>>            
56670>>>>>            Set Form_Width    item 6 to 54
56671>>>>>            Set Header_Label  item 6 to "¦©æ"
56672>>>>>            
56672>>>>>
56672>>>>>            //AB-StoreStart
56672>>>>>            
56672>>>>>            Set Numeric_mask Item 6 to 14 0 ' ,*'
56673>>>>>            
56673>>>>>            Procedure Activating
56675>>>>>                Send Rebuild_Constraints    to Barticl_DD
56676>>>>>                Send Beginning_Of_Data      to oSelList True
56677>>>>>                Forward Send Activating
56679>>>>>            End_Procedure
56680>>>>>            
56680>>>>>            
56680>>>>>            
56680>>>>>            
56680>>>>>            
56680>>>>>            
56680>>>>>            
56680>>>>>            //AB-StoreEnd
56680>>>>>
56680>>>>>        End_Object    // oSelList
56681>>>>>
56681>>>>>        Object oOK_bn is a ButtonSub
56683>>>>>            Set Label to "&„§ ¢¦šã"
56684>>>>>            Set Location to 255 354
56685>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56686>>>>>
56686>>>>>            //AB-StoreStart
56686>>>>>            Procedure OnClick
56688>>>>>                Send OK To oSelList
56689>>>>>            End_Procedure
56690>>>>>            //AB-StoreEnd
56690>>>>>
56690>>>>>        End_Object    // oOK_bn
56691>>>>>
56691>>>>>        Object oCancel_bn is a ButtonSub
56693>>>>>            Set Label to "&€¡ç¨à©ž"
56694>>>>>            Set Location to 255 410
56695>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56696>>>>>
56696>>>>>            //AB-StoreStart
56696>>>>>            Procedure OnClick
56698>>>>>                Send Cancel To oSelList
56699>>>>>            End_Procedure
56700>>>>>            //AB-StoreEnd
56700>>>>>
56700>>>>>        End_Object    // oCancel_bn
56701>>>>>
56701>>>>>        Object oSearch_bn is a ButtonSub
56703>>>>>            Set Label to "€&¤˜ã«ž©ž"
56704>>>>>            Set Location to 255 464
56705>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56706>>>>>
56706>>>>>            //AB-StoreStart
56706>>>>>            Procedure OnClick
56708>>>>>                Send Search To oSelList
56709>>>>>            End_Procedure
56710>>>>>            //AB-StoreEnd
56710>>>>>
56710>>>>>        End_Object    // oSearch_bn
56711>>>>>
56711>>>>>
56711>>>>>        //AB-StoreStart
56711>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
56712>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
56713>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
56714>>>>>        
56714>>>>>        
56714>>>>>        
56714>>>>>        
56714>>>>>        
56714>>>>>        
56714>>>>>        
56714>>>>>        
56714>>>>>        //AB-StoreEnd
56714>>>>>
56714>>>>>    End_Object    // SL036
56715>>>>>
56715>>>>>//AB/     End_Object    // prj
56715>>>Use r36.rv
INCLUDING FILE: R36.RV
56715>>>>>//AB/ Project R36:ektyposh barticl
56715>>>>>//AB/ Object prj is a Report_Project
56715>>>>>//AB/     Set ProjectName to "R36:ektyposh barticl"
56715>>>>>//AB/     Set ProjectFileName to "r36.rv"
56715>>>>>
56715>>>>>// Project Object Structure
56715>>>>>//   r36 is a ReportViewSub
56715>>>>>//     DestRadio is a RadioGroup
56715>>>>>//       WindowRadio is a Radio
56715>>>>>//       PrinterRadio is a Radio
56715>>>>>//     ButtonSub3 is a ButtonSub
56715>>>>>//     ButtonSub4 is a ButtonSub
56715>>>>>//     AXIO_BasicReport is a BasicReport
56715>>>>>//       Btypkin_DD is a Btypkin_DataDictionary
56715>>>>>//       Baxiokat_DD is a Baxiokat_DataDictionary
56715>>>>>//       Barticl_DD is a Barticl_DataDictionary
56715>>>>>//       Bsum_DD is a Bsum_DataDictionary
56715>>>>>//       Baxio_DD is a Baxio_DataDictionary
56715>>>>>//       Syscurxr_DD is a Syscurxr_DataDictionary
56715>>>>>//       Clients_DD is a Clients_DataDictionary
56715>>>>>//       Bmove_DD is a Bmove_DataDictionary
56715>>>>>
56715>>>>>// Register all objects
56715>>>>>Register_Object AXIO_BasicReport
56715>>>>>Register_Object Barticl_DD
56715>>>>>Register_Object Baxio_DD
56715>>>>>Register_Object Baxiokat_DD
56715>>>>>Register_Object Bmove_DD
56715>>>>>Register_Object Bsum_DD
56715>>>>>Register_Object Btypkin_DD
56715>>>>>Register_Object ButtonSub3
56715>>>>>Register_Object ButtonSub4
56715>>>>>Register_Object Clients_DD
56715>>>>>Register_Object DestRadio
56715>>>>>Register_Object PrinterRadio
56715>>>>>Register_Object r36
56715>>>>>Register_Object Syscurxr_DD
56715>>>>>Register_Object WindowRadio
56715>>>>>
56715>>>>>
56715>>>>>//AB/ Report View
56715>>>>>
56715>>>>>
56715>>>>>//AB-StoreTopStart
56715>>>>>                                                        
56715>>>>>Use dfallrpt.pkg
56715>>>>>use btypkin.dd
56715>>>>>use baxiokat.dd
56715>>>>>Use barticl.dd
56715>>>>>use bsum.dd
INCLUDING FILE: BSUM.DD
56715>>>>>>>//DDB-FileStart
56715>>>>>>>//DDB-HeaderStart
56715>>>>>>>
56715>>>>>>>// File Name : BSUM.DD
56715>>>>>>>// Class Name: Bsum_DataDictionary
56715>>>>>>>// Revision  : 11
56715>>>>>>>// Version   : 2
56715>>>>>>>
56715>>>>>>>Use  Windows           // Basic Definitions
56715>>>>>>>Use  DataDict          // DataDictionary Class Definition
56715>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56715>>>>>>>
56715>>>>>>>Open Bsum
56717>>>>>>>Open Barticl
56719>>>>>>>Open Sysrecb
56721>>>>>>>
56721>>>>>>>//DDB-HeaderEnd
56721>>>>>>>Class Bsum_DataDictionary  is a DataDictionary_Sec
56722>>>>>>>
56722>>>>>>>    // Creating:
56722>>>>>>>
56722>>>>>>>    Procedure Creating
56723>>>>>>>        Forward Send Creating
56725>>>>>>>        // Insert Code Here
56725>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
56726>>>>>>>    End_Procedure   // Creating
56727>>>>>>>
56727>>>>>>>
56727>>>>>>>    Procedure Define_Fields
56728>>>>>>>        Forward Send Define_Fields
56730>>>>>>>        //DDB-Generated-Code-Location
56730>>>>>>>        //DDB-DefineFieldStart
56730>>>>>>>
56730>>>>>>>        Set Main_File            To Bsum.File_Number
56731>>>>>>>        Set Cascade_Delete_State To FALSE
56732>>>>>>>
56732>>>>>>>
56732>>>>>>>        // Parent (Server) file structure...............
56732>>>>>>>        Send Add_Server_File  Barticl.File_Number
56733>>>>>>>
56733>>>>>>>        // External (System) file structure.............
56733>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
56734>>>>>>>
56734>>>>>>>        Define_Auto_Increment  Sysrecb.Bsum_Rec0  To Bsum.Bsum_Rec0
56737>>>>>>>
56737>>>>>>>        // Field-based properties.......................
56737>>>>>>>
56737>>>>>>>        // Bsum.Barticl_Recr
56737>>>>>>>
56737>>>>>>>        // Bsum.Baxiokat_Recr
56737>>>>>>>
56737>>>>>>>        // Bsum.Bsum_Sv2
56737>>>>>>>
56737>>>>>>>        // Bsum.Bsum_Sv0
56737>>>>>>>
56737>>>>>>>        // Bsum.Bsum_Sv00
56737>>>>>>>
56737>>>>>>>        // Bsum.Bsum_Svr
56737>>>>>>>
56737>>>>>>>        // Bsum.Gmove_Srec0
56737>>>>>>>
56737>>>>>>>        // Bsum.Bsum_Rec0
56737>>>>>>>
56737>>>>>>>        // Bsum.Bsum_Recr
56737>>>>>>>
56737>>>>>>>        //DDB-DefineFieldEnd
56737>>>>>>>
56737>>>>>>>        Set Main_File            To Bsum.File_Number
56738>>>>>>>
56738>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
56739>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
56740>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56741>>>>>>>
56741>>>>>>>        // Parent (Server) file structure...............
56741>>>>>>>        Send Add_Server_File  Barticl.File_Number
56742>>>>>>>
56742>>>>>>>        // Field-based properties.......................
56742>>>>>>>
56742>>>>>>>        // Bsum.Barticl_Rec0
56742>>>>>>>
56742>>>>>>>        // Bsum.Baxiokat_Rec0
56742>>>>>>>
56742>>>>>>>        // Bsum.Bsum_Sv2
56742>>>>>>>
56742>>>>>>>        // Bsum.Bsum_Sv0
56742>>>>>>>
56742>>>>>>>        // Bsum.Bsum_Sv00
56742>>>>>>>
56742>>>>>>>        // Bsum.Bsum_Svr
56742>>>>>>>
56742>>>>>>>        // Bsum.Gmove_Srec0
56742>>>>>>>
56742>>>>>>>    End_Procedure    // Define_Fields
56743>>>>>>>
56743>>>>>>>
56743>>>>>>>    Procedure Field_Defaults
56744>>>>>>>        Forward Send Field_Defaults
56746>>>>>>>        //DDB-Generated-Code-Location
56746>>>>>>>        //DDB-FieldDefaultStart
56746>>>>>>>        //DDB-FieldDefaultEnd
56746>>>>>>>    End_Procedure    // Field_Defaults
56747>>>>>>>
56747>>>>>>>End_Class    // Bsum_DataDictionary
56748>>>>>>>//DDB-FileEnd
56748>>>>>use baxio.dd
56748>>>>>use syscurxr.dd
56748>>>>>use clients.dd
56748>>>>>use bmove.dd
56748>>>>>Use rvi36.pkg
INCLUDING FILE: RVI36.PKG
/HEADERR36
Image 10, HEADERR36
 !
 __________________________________                                                          †‹Œˆ€  : __________
 __________________________________                                                          €.€ : __________
 __________________________________
 __________     ___________________
 €”‹ __________ ƒŽ“ _______________
                                  _______________________________________________
                                  ===============================================
                    ‘ « ¦   ® œ å ˜   ‹ œ « ˜ ™   ™ ˜  æ £ œ ¤ ¦ ¬   € ¥   ¦ š ¨ á ­ ¦ ¬     ‘«¦ ®œå˜ €§¦›â¡«ž
   ˜/˜   „å›¦ª €¥ ¦š¨á­¦¬      €¨ Ÿ£æª     „¡›æ«žª      ’¨á§œ˜  †£.Šã¥žª   Œ¦£.         €¥å˜
/BodyR36
Image 11, BODYR36
  ___  _____________________ ____________ ____________ ________ __/__/____ ___ ___,___,___.__ ____________________
/TotalR36
Image 12, TOTALR36
------------------------------------------------------------------------------------------------------------------
                                                   ‘ç¤¦¢¦ €¥å˜ª €¥ ¦š¨á­à¤ ___,___,___,___.__
       ‚ ˜ «ž __________________________________               Ž ˜¨˜¢˜™é¤
˜¨˜«ž¨ã©œ ª: ____________________________________________________________
              ____________________________________________________________  !
/*
56748>>>>>open codemast
56750>>>>>open company
56752>>>>>//AB-StoreTopEnd
56752>>>>>
56752>>>>>//AB-IgnoreStart
56752>>>>>
56752>>>>>Use Rptvw.Sub
56752>>>>>Use DFAllEnt.pkg
56752>>>>>Use Button.Sub
56752>>>>>
56752>>>>>//AB-IgnoreEnd
56752>>>>>
56752>>>>>ACTIVATE_VIEW Activate_r36 FOR r36
56756>>>>>
56756>>>>>Object r36 is a ReportViewSub
56758>>>>>
56758>>>>>    //AB-StoreTopStart
56758>>>>>            
56758>>>>>    Property Integer Sort_Indexaxio   Public 1
56760>>>>>    Property string  psrecr           public ''
56762>>>>>    property integer piaa             public 0
56764>>>>>    //AB-StoreTopEnd
56764>>>>>
56764>>>>>    Set Label to "„¡«ç§à©ž Bmoves"
56765>>>>>    Set Size to 64 186
56766>>>>>    Set Location to 1 7
56767>>>>>
56767>>>>>    //AB-DDOStart
56767>>>>>
56767>>>>>
56767>>>>>    //AB-DDOEnd
56767>>>>>
56767>>>>>    Object DestRadio is a RadioGroup
56769>>>>>
56769>>>>>        //AB-StoreTopStart
56769>>>>>                                
56769>>>>>        //AB-StoreTopEnd
56769>>>>>
56769>>>>>        Set Label to "„¡«ç§à©ž"
56770>>>>>        Set Size to 42 49
56771>>>>>        Set Location to 2 1
56772>>>>>        Object WindowRadio is a Radio
56774>>>>>            Set Size to 13 30
56775>>>>>            Set Location to 12 12
56776>>>>>            Set Bitmap to "screen4.bmp"
56777>>>>>        End_Object    // WindowRadio
56778>>>>>
56778>>>>>        Object PrinterRadio is a Radio
56780>>>>>            Set Size to 10 31
56781>>>>>            Set Location to 30 12
56782>>>>>            Set Bitmap to "PRINT_M1.BMP"
56783>>>>>        End_Object    // PrinterRadio
56784>>>>>
56784>>>>>
56784>>>>>        //AB-StoreStart
56784>>>>>        Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
56786>>>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
56788>>>>>            If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
56791>>>>>          //  Set Output_Device_Mode  To PRINT_TO_WINDOW
56791>>>>>        End_Procedure
56792>>>>>        
56792>>>>>        
56792>>>>>        
56792>>>>>        
56792>>>>>        
56792>>>>>        
56792>>>>>        
56792>>>>>        //AB-StoreEnd
56792>>>>>
56792>>>>>    End_Object    // DestRadio
56793>>>>>
56793>>>>>    Object ButtonSub3 is a ButtonSub
56795>>>>>
56795>>>>>        //AB-StoreTopStart
56795>>>>>                                                                                                                                                                                                                                                                    
56795>>>>>        //AB-StoreTopEnd
56795>>>>>
56795>>>>>        Set Bitmap to "RUNPROG.BMP"
56796>>>>>        Set Size to 18 27
56797>>>>>        Set Location to 6 59
56798>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56799>>>>>
56799>>>>>        //AB-StoreStart
56799>>>>>        Procedure OnClick
56801>>>>>        
56801>>>>>        
56801>>>>>        End_Procedure
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        
56802>>>>>        //AB-StoreEnd
56802>>>>>
56802>>>>>    End_Object    // ButtonSub3
56803>>>>>
56803>>>>>    Object ButtonSub4 is a ButtonSub
56805>>>>>
56805>>>>>        //AB-StoreTopStart
56805>>>>>                                                                                                                                                                                                                                                                                                    
56805>>>>>        //AB-StoreTopEnd
56805>>>>>
56805>>>>>        Set Bitmap to "CANCEL.BMP"
56806>>>>>        Set Size to 18 27
56807>>>>>        Set Location to 28 58
56808>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56809>>>>>
56809>>>>>        //AB-StoreStart
56809>>>>>        Procedure OnClick
56811>>>>>            Send Request_Cancel
56812>>>>>        End_Procedure
56813>>>>>        
56813>>>>>        
56813>>>>>        
56813>>>>>        
56813>>>>>        //AB-StoreEnd
56813>>>>>
56813>>>>>    End_Object    // ButtonSub4
56814>>>>>
56814>>>>>
56814>>>>>    //AB-StoreStart
56814>>>>>            
56814>>>>>    //Selection Variables
56814>>>>>    
56814>>>>>    //HELP-VARIABLES
56814>>>>>    
56814>>>>>    Procedure StartReport
56816>>>>>    
56816>>>>>        Local Integer iOutputDevice
56817>>>>>        Local String  FileName
56817>>>>>        local integer inew_state
56817>>>>>        Get Output_Device_Mode To iOutputDevice
56818>>>>>        If iOutputDevice EQ 0 Begin
56820>>>>>           Make_Temp_File "TXT" FileName
56821>>>>>           Move (".\" - FileName)  To FileName
56822>>>>>           Set Output_Device_Name  To FileName
56823>>>>>          // set piprinter to 1
56823>>>>>        End
56823>>>>>>
56823>>>>>        Else ;        Set Output_Device_Name  To "Lpt1:"
56825>>>>>    
56825>>>>>        SEND RUN_REPORT
56826>>>>>    
56826>>>>>     //   If iOutputDevice EQ 1 Begin
56826>>>>>     //      RunProgram background "notepad" FileName
56826>>>>>     //      EraseFile FileName
56826>>>>>      //  End
56826>>>>>    
56826>>>>>    End_Procedure   // StartReport
56827>>>>>    
56827>>>>>    
56827>>>>>    Object AXIO_BasicReport is a BasicReport
56829>>>>>    
56829>>>>>       Set Report_Title to "„¡«ç§à©ž €¥ ¦š¨á­à¤       "
56830>>>>>    
56830>>>>>       Object Btypkin_DD is a Btypkin_DataDictionary
56832>>>>>       End_Object    // Btypkin_DD
56833>>>>>    
56833>>>>>       Object Baxiokat_DD is a Baxiokat_DataDictionary
56835>>>>>       End_Object    // Baxiokat_DD
56836>>>>>    
56836>>>>>       Object Barticl_DD is a Barticl_DataDictionary
56838>>>>>          Set DDO_Server to (Btypkin_DD(self))
56839>>>>>       End_Object    // Barticl_DD
56840>>>>>    
56840>>>>>       Object Bsum_DD is a Bsum_DataDictionary
56842>>>>>          Set DDO_Server to (Barticl_DD(self))
56843>>>>>          Set Constrain_File to Barticl.File_Number
56844>>>>>       End_Object    // Bsum_DD
56845>>>>>    
56845>>>>>       Object Baxio_DD is a Baxio_DataDictionary
56847>>>>>          Set DDO_Server to (Baxiokat_DD(self))
56848>>>>>       End_Object    // Baxio_DD
56849>>>>>    
56849>>>>>       Object Syscurxr_DD is a Syscurxr_DataDictionary
56851>>>>>       End_Object    // Syscurxr_DD
56852>>>>>    
56852>>>>>        Object Clients_DD is a Clients_DataDictionary
56854>>>>>    
56854>>>>>        End_Object    // Clients_DD
56855>>>>>    
56855>>>>>    
56855>>>>>        Object Bmove_DD is a Bmove_DataDictionary
56857>>>>>            Set DDO_Server to (Barticl_DD(self))
56858>>>>>            Set DDO_Server to (Baxio_DD(self))
56859>>>>>            Set Constrain_File to Barticl.File_Number
56860>>>>>            begin_constraints
56862>>>>>                constrain bmove.barticl_recr eq (psrecr(self))
56864>>>>>            end_constraints
56867>>>>>        End_Object    // Bmove_DD
56868>>>>>    
56868>>>>>    
56868>>>>>    
56868>>>>>    
56868>>>>>        //Main DD for the report
56868>>>>>        Set Server To (bmove_dd(Current_Object))
56869>>>>>    
56869>>>>>        //Breaks and Index for the report
56869>>>>>        Report_Index By Index.1
56871>>>>>        Function Starting_Main_Report Returns Integer
56873>>>>>          Integer iIndexaxio
56874>>>>>          Local Integer iRetVal
56874>>>>>          set page_feed to 66
56875>>>>>          set page_end to 60
56876>>>>>          set piaa to 0
56877>>>>>          Forward Get Starting_Main_Report to iRetval
56879>>>>>          send rebuild_constraints to bmove_dd
56880>>>>>          Send Find to (bmove_dd(self)) First_Record 1
56881>>>>>          Get Sort_Indexaxio  To iIndexaxio
56882>>>>>          Report_Index BY iIndexaxio
56884>>>>>       End_Function
56885>>>>>    
56885>>>>>       Procedure_Section Page_Top as HeaderR36
56890>>>>>           date ddate
56890>>>>>           sysdate4 ddate
56891>>>>>           clear company
56892>>>>>           move barticl.company_code  to company.company_code
56893>>>>>           find eq company by index.1
56894>>>>>>
56894>>>>>           print company.company_name to headerr36.1
56895>>>>>           print ddate                to headerr36.2
56896>>>>>           clear codemast
56897>>>>>           move 'JOB' to codemast.type
56898>>>>>           move company.company_j_code to codemast.code
56899>>>>>           find eq codemast by index.1
56900>>>>>>
56900>>>>>           move codemast.description   to headerr36.3
56901>>>>>           move barticl.barticl_no      to headerr36.4
56902>>>>>           move company.company_addr   to headerr36.5
56903>>>>>           move company.company_tk     to headerr36.6
56904>>>>>           move company.company_poli   to headerr36.7
56905>>>>>           move company.company_afm    to headerr36.8
56906>>>>>           clear codemast
56907>>>>>           move 'DOY' to codemast.type
56908>>>>>           move company.company_doy    to codemast.code
56909>>>>>           find eq codemast by index.1
56910>>>>>>
56910>>>>>           move codemast.description   to headerr36.9
56911>>>>>           move btypkin.btypkin_descr  to headerr36.10
56912>>>>>           OutPut_PageCheck
56913>>>>>       End_Procedure
56914>>>>>    
56914>>>>>       Procedure_Section  Body as BodyR36
56919>>>>>          number iaa
56919>>>>>          get piaa                      to iaa
56920>>>>>          add 1                         to iaa
56921>>>>>          set piaa                      to iaa
56922>>>>>          print iaa                     to bodyr36.1
56923>>>>>          print baxiokat.baxiokat_descr to bodyr36.2
56924>>>>>          Print baxio.baxio_no          to bodyr36.3
56925>>>>>          clear codemast
56926>>>>>          move 'BANK' to codemast.type
56927>>>>>          move baxio.baxio_banka to codemast.code
56928>>>>>          find eq codemast by index.1
56929>>>>>>
56929>>>>>          move baxio.baxio_epon_in    to bodyr36.4
56930>>>>>          move codemast.description   to bodyr36.5
56931>>>>>          move baxio.baxio_hmnial     to bodyr36.6
56932>>>>>          move baxio.baxio_c_code2    to bodyr36.7
56933>>>>>          print baxio.baxio_v2        to bodyr36.8
56934>>>>>          move baxio.baxio_epon_out   to bodyr36.9
56935>>>>>          add bodyr36.8               to totalr36.1
56936>>>>>          OutPut_PageCheck
56937>>>>>       End_Procedure
56938>>>>>    
56938>>>>>       PROCEDURE_SECTION TOTAL AS TOTALR36
56943>>>>>         // Subtotal BodyR36.8      TO totalr36.1
56943>>>>>          print totalr36.1
56944>>>>>          print company.company_name to totalr36.2
56945>>>>>          print barticl.sxolia1      to totalr36.3
56946>>>>>          print barticl.sxolia2      to totalr36.4
56947>>>>>          output_pagecheck
56948>>>>>       END_PROCEDURE
56949>>>>>    
56949>>>>>       Procedure Ending_Report
56951>>>>>         Blankform BodyR36.1      Thru BodyR36.9
56952>>>>>>
56952>>>>>       End_Procedure
56953>>>>>    
56953>>>>>    End_Object
56954>>>>>    
56954>>>>>    
56954>>>>>    Procedure Activate_View Returns Integer
56956>>>>>        Local Integer Rval
56957>>>>>        Forward Get MSG_Activate_View to Rval
56959>>>>>    End_Procedure
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    
56960>>>>>    //AB-StoreEnd
56960>>>>>
56960>>>>>End_Object    // r36
56961>>>>>
56961>>>>>
56961>>>>>//AB-StoreStart
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>                                                        
56961>>>>>//AB-StoreEnd
56961>>>>>
56961>>>>>//AB/ End_Object    // prj
56961>>>Use baxio.dd
56961>>>Use Tperga.dd
INCLUDING FILE: TPERGA.DD
56961>>>>>//DDB-FileStart
56961>>>>>//DDB-HeaderStart
56961>>>>>
56961>>>>>// File Name : TPERGA.DD
56961>>>>>// Class Name: Tperga_DataDictionary
56961>>>>>// Revision  : 14
56961>>>>>// Version   : 2
56961>>>>>
56961>>>>>Use  Windows           // Basic Definitions
56961>>>>>Use  DataDict          // DataDictionary Class Definition
56961>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56961>>>>>
56961>>>>>Open Tperga
56963>>>>>Open Cn
56965>>>>>Open Baxiokat
56967>>>>>Open Sysrecc
56969>>>>>
56969>>>>>//DDB-HeaderEnd
56969>>>>>
56969>>>>>Class Tperga_DataDictionary  is a DataDictionary_Sec
56970>>>>>
56970>>>>>    Procedure Save_Main_File
56971>>>>>        If (Operation_Origin<>Self) Begin
56973>>>>>            If Tperga.Recnum Eq 0 Procedure_Return
56976>>>>>        End
56976>>>>>>
56976>>>>>        Forward Send Save_Main_File
56978>>>>>    End_Procedure
56979>>>>>
56979>>>>>
56979>>>>>
56979>>>>>    Procedure Creating
56980>>>>>        Forward Send Creating
56982>>>>>        // Insert Code Here
56982>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(TPErga.TPErga_Rec0))))));                                    to TPErga.TPErga_Recr
56983>>>>>    End_Procedure   // Creating
56984>>>>>
56984>>>>>    // Define_Fields:
56984>>>>>    // This procedure is used to set up all data-dictionary rules.
56984>>>>>
56984>>>>>    Procedure Define_Fields
56985>>>>>        Forward Send Define_Fields
56987>>>>>        //DDB-Generated-Code-Location
56987>>>>>        //DDB-DefineFieldStart
56987>>>>>
56987>>>>>        Set Main_File            To Tperga.File_Number
56988>>>>>        Set Cascade_Delete_State To FALSE
56989>>>>>
56989>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
56990>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
56991>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56992>>>>>
56992>>>>>        // Parent (Server) file structure...............
56992>>>>>        Send Add_Server_File  Cn.File_Number
56993>>>>>        Send Add_Server_File  Baxiokat.File_Number
56994>>>>>
56994>>>>>        // External (System) file structure.............
56994>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
56995>>>>>
56995>>>>>        Define_Auto_Increment  Sysrecc.Tperga_Rec0  To Tperga.Tperga_Rec0
56998>>>>>
56998>>>>>        // Field-based properties.......................
56998>>>>>
56998>>>>>        // Tperga.Cn_Code
56998>>>>>
56998>>>>>        // Tperga.Baxiokat_Code
56998>>>>>
56998>>>>>        // Tperga.Pct_Epi_Synolou
56998>>>>>
56998>>>>>        // Tperga.Paralabh_Meres
56998>>>>>
56998>>>>>        // Tperga.Xarhtos_Meres
56998>>>>>
56998>>>>>        // Tperga.Plhroteo_Meres
56998>>>>>
56998>>>>>        // Tperga.Tperga_Rec0
56998>>>>>
56998>>>>>        // Tperga.Tperga_Recr
56998>>>>>
56998>>>>>        //DDB-DefineFieldEnd
56998>>>>>    End_Procedure    // Define_Fields
56999>>>>>
56999>>>>>    // Field_Defaults:
56999>>>>>    // This procedure is used to establish default field values.
56999>>>>>
56999>>>>>    Procedure Field_Defaults
57000>>>>>        Forward Send Field_Defaults
57002>>>>>        //DDB-Generated-Code-Location
57002>>>>>        //DDB-FieldDefaultStart
57002>>>>>        //DDB-FieldDefaultEnd
57002>>>>>    End_Procedure    // Field_Defaults
57003>>>>>
57003>>>>>End_Class    // Tperga_DataDictionary
57004>>>>>//DDB-FileEnd
57004>>>Use BtnOrdH.DD
INCLUDING FILE: BTNORDH.DD
57004>>>>>//DDB-FileStart
57004>>>>>//DDB-HeaderStart
57004>>>>>
57004>>>>>// File Name : BTNORDH.DD
57004>>>>>// Class Name: Btnordh_DataDictionary
57004>>>>>// Revision  : 57
57004>>>>>// Version   : 2
57004>>>>>
57004>>>>>Use  Windows           // Basic Definitions
57004>>>>>Use  DataDict          // DataDictionary Class Definition
57004>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57004>>>>>
57004>>>>>Open Btnordh
57006>>>>>Open Btnordd
57008>>>>>Open Cn
57010>>>>>Open Sysrecc
57012>>>>>
57012>>>>>//DDB-HeaderEnd
57012>>>>>//DDB-ValidationStart
57012>>>>>
57012>>>>>Register_Object Btnordh_Velxr_VT
57012>>>>>
57012>>>>>Object Btnordh_Velxr_VT  is a CodeValidationTable
57014>>>>>    Set Type_Value        To "ELXREOSH"
57015>>>>>    Set Validate_State    To FALSE
57016>>>>>    Set Allow_Blank_State To TRUE
57017>>>>>    //DDB-ValidationCustomStart
57017>>>>>    //DDB-ValidationCustomEnd
57017>>>>>End_Object   // Btnordh_Velxr_VT
57018>>>>>//DDB-ValidationEnd
57018>>>>>//DDB-SelectionStart
57018>>>>>//DDB/ ExternalSelectionList btnordh  btnordh.sl
57018>>>>>Register_Object btnordh
57018>>>>>//DDB-SelectionEnd
57018>>>>>
57018>>>>>Class Btnordh_DataDictionary  is a DataDictionary_Sec
57019>>>>>
57019>>>>>    Procedure Construct_Object
57020>>>>>        Forward Send Construct_Object
57022>>>>>        Property integer piactive  Public 0
57023>>>>>    End_Procedure
57024>>>>>
57024>>>>>    Procedure Creating
57025>>>>>        String  sClientCode sCNCode
57026>>>>>        Integer iClientCode iCnCode iAA
57026>>>>>        date ddate
57026>>>>>        Forward Send Creating
57028>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                        (Trim(String(BTNORDH.Rec0)))))) to BTNORDH.Recr
57029>>>>>
57029>>>>>        if (sysfile.ascclientid=0);            Move (fsgStripCodeFromID(Clients.Client_ID))    to iClientCode
57032>>>>>        else;            mid clients.client_id to sclientcode 5 7
57036>>>>>        Move (fsgStripCodeFromID(CN.CN_Code))           to iCnCode
57037>>>>>        Move Cn.AA_Deop                                 to iAA
57038>>>>>        Add 1                                           to iAA
57039>>>>>        Add 1                                           to Cn.AA_Deop
57040>>>>>
57040>>>>>        if (sysfile.ascclientid=0);            Get Sfi_All_Numbers iClientCode Sysfile.Client_Digits 0 to sClientCode
57043>>>>>        Get Sfi_All_Numbers iCNCode     Sysfile.Client_Digits 0 to sCNCode
57044>>>>>
57044>>>>>        Move (sClientCode+sCNCode+'/'+(String(iAA)))    to btnordh.aa_deop
57045>>>>>        sysdate4 ddate
57046>>>>>        if (btnordh.date_create='') move ddate to btnordh.date_create
57049>>>>>        if (btnordh.deop_date ='') move ddate to btnordh.deop_date
57052>>>>>        if (piactive(self)=1) move 0 to btnordh.deop_active
57055>>>>>        else move 1 to btnordh.deop_active
57057>>>>>        // Insert Code Here
57057>>>>>    End_Procedure   // Creating
57058>>>>>
57058>>>>>     Procedure Update
57059>>>>>        Forward Send Update
57061>>>>>
57061>>>>>        // Insert Code Here
57061>>>>>        Move SysCurXR.Company_Code  to btnordh.Vcompany
57062>>>>>        Move SysCurXR.Branch_Code   to btnordh.Vbranch
57063>>>>>        move syscurxr.year_year     to btnordh.vyear
57064>>>>>        move cn.cn_code             to btnordh.cn_code
57065>>>>>        move clients.client_id      to btnordh.client_id
57066>>>>>        move payresp.presp_id       to btnordh.presp_id
57067>>>>>        move cn.cn_sls_id           to btnordh.user_id
57068>>>>>        if (btnordh.deop_date = '');           move cn.cn_start_date to btnordh.deop_date
57071>>>>>     end_procedure
57072>>>>>
57072>>>>>
57072>>>>>
57072>>>>>    // Define_Fields:
57072>>>>>    // This procedure is used to set up all data-dictionary rules.
57072>>>>>
57072>>>>>    Procedure Define_Fields
57073>>>>>        Forward Send Define_Fields
57075>>>>>        //DDB-Generated-Code-Location
57075>>>>>        //DDB-DefineFieldStart
57075>>>>>
57075>>>>>        Set Main_File            To Btnordh.File_Number
57076>>>>>        Set Cascade_Delete_State To FALSE
57077>>>>>
57077>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57078>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57079>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57080>>>>>
57080>>>>>        // Child (Client) file structure................
57080>>>>>        Send Add_Client_File  Btnordd.File_Number
57081>>>>>
57081>>>>>        // Parent (Server) file structure...............
57081>>>>>        Send Add_Server_File  Cn.File_Number
57082>>>>>
57082>>>>>        // External (System) file structure.............
57082>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
57083>>>>>
57083>>>>>        Define_Auto_Increment  Sysrecc.Btnordh_Rec0  To Btnordh.Rec0
57086>>>>>
57086>>>>>        // Field-based properties.......................
57086>>>>>
57086>>>>>        // Btnordh.Vcompany
57086>>>>>
57086>>>>>        // Btnordh.Vbranch
57086>>>>>
57086>>>>>        // Btnordh.Vyear
57086>>>>>
57086>>>>>        // Btnordh.Rec0
57086>>>>>
57086>>>>>        // Btnordh.Recr
57086>>>>>
57086>>>>>        // Btnordh.Aa_Deop
57086>>>>>        Set Field_Prompt_Object    Field Btnordh.Aa_Deop To (btnordh(Self))
57087>>>>>
57087>>>>>        // Btnordh.Cn_Recr
57087>>>>>
57087>>>>>        // Btnordh.Sxolia
57087>>>>>
57087>>>>>        // Btnordh.Cn_Code
57087>>>>>
57087>>>>>        // Btnordh.Client_Id
57087>>>>>
57087>>>>>        // Btnordh.Presp_Id
57087>>>>>
57087>>>>>        // Btnordh.Deop_Date
57087>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Date To MASK_DATE_WINDOW
57088>>>>>
57088>>>>>        // Btnordh.Deop_Active
57088>>>>>
57088>>>>>        // Btnordh.Eleiph
57088>>>>>
57088>>>>>        // Btnordh.Locked
57088>>>>>
57088>>>>>        // Btnordh.User_Id
57088>>>>>
57088>>>>>        // Btnordh.Date_Create
57088>>>>>
57088>>>>>        // Btnordh.Date_Modify
57088>>>>>
57088>>>>>        // Btnordh.Date_Locked
57088>>>>>
57088>>>>>        // Btnordh.Deop_Lhxh
57088>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Lhxh To MASK_DATE_WINDOW
57089>>>>>
57089>>>>>        // Btnordh.Statero
57089>>>>>
57089>>>>>        // Btnordh.Velxr
57089>>>>>        Set Field_Value_Table      Field Btnordh.Velxr To (Btnordh_Velxr_VT(Self))
57090>>>>>
57090>>>>>        // Btnordh.Timeout
57090>>>>>
57090>>>>>        // Btnordh.Timeout1
57090>>>>>
57090>>>>>        //DDB-DefineFieldEnd
57090>>>>>    End_Procedure    // Define_Fields
57091>>>>>
57091>>>>>
57091>>>>>    // Field_Defaults:
57091>>>>>    // This procedure is used to establish default field values.
57091>>>>>
57091>>>>>    Procedure Field_Defaults
57092>>>>>        Forward Send Field_Defaults
57094>>>>>        //DDB-Generated-Code-Location
57094>>>>>        //DDB-FieldDefaultStart
57094>>>>>        //DDB-FieldDefaultEnd
57094>>>>>    End_Procedure    // Field_Defaults
57095>>>>>
57095>>>>>End_Class    // Btnordh_DataDictionary
57096>>>>>//DDB-Selection-pkg-Start
57096>>>>>
57096>>>>>Use btnordh.sl       // btnordh
INCLUDING FILE: BTNORDH.SL
57096>>>>>>>//AB/ Project btnordh
57096>>>>>>>//AB/ Object prj is a Lookup_Project
57096>>>>>>>//AB/     Set ProjectName to "btnordh"
57096>>>>>>>//AB/     Set ProjectFileName to "btnordh.SL"
57096>>>>>>>//AB/     Set GenerateFileName to "NONAME"
57096>>>>>>>
57096>>>>>>>// Project Object Structure
57096>>>>>>>//   btnordh is a dbModalPanelSub
57096>>>>>>>//     Country_DD is a DataDictionary
57096>>>>>>>//     Towns_DD is a DataDictionary
57096>>>>>>>//     Cities_DD is a DataDictionary
57096>>>>>>>//     Areas_DD is a DataDictionary
57096>>>>>>>//     Payresp_DD is a DataDictionary
57096>>>>>>>//     Clients_DD is a DataDictionary
57096>>>>>>>//     Salesmen_DD is a DataDictionary
57096>>>>>>>//     Mhxanik_DD is a DataDictionary
57096>>>>>>>//     Constrct_DD is a DataDictionary
57096>>>>>>>//     Cn_DD is a DataDictionary
57096>>>>>>>//     Btnordh_DD is a DataDictionary
57096>>>>>>>//     Btnordd_DD is a DataDictionary
57096>>>>>>>//     oSelList is a dbListSub
57096>>>>>>>//     oOK_bn is a ButtonSub
57096>>>>>>>//     oCancel_bn is a ButtonSub
57096>>>>>>>//     oSearch_bn is a ButtonSub
57096>>>>>>>
57096>>>>>>>// Register all objects
57096>>>>>>>Register_Object Areas_DD
57096>>>>>>>Register_Object Btnordd_DD
57096>>>>>>>Register_Object Btnordh_DD
57096>>>>>>>Register_Object btnordh
57096>>>>>>>Register_Object Cities_DD
57096>>>>>>>Register_Object Clients_DD
57096>>>>>>>Register_Object Cn_DD
57096>>>>>>>Register_Object Constrct_DD
57096>>>>>>>Register_Object Country_DD
57096>>>>>>>Register_Object Mhxanik_DD
57096>>>>>>>Register_Object oCancel_bn
57096>>>>>>>Register_Object oOK_bn
57096>>>>>>>Register_Object oSearch_bn
57096>>>>>>>Register_Object oSelList
57096>>>>>>>Register_Object Payresp_DD
57096>>>>>>>Register_Object Salesmen_DD
57096>>>>>>>Register_Object Towns_DD
57096>>>>>>>
57096>>>>>>>
57096>>>>>>>//AB-IgnoreStart
57096>>>>>>>
57096>>>>>>>Use DFAllEnt.pkg
57096>>>>>>>Use dbList.Sub
57096>>>>>>>Use Button.Sub
57096>>>>>>>
57096>>>>>>>
57096>>>>>>>Use COUNTRY.DD
57096>>>>>>>Use TOWNS.DD
57096>>>>>>>Use CITIES.DD
57096>>>>>>>Use AREAS.DD
57096>>>>>>>Use PAYRESP.DD
57096>>>>>>>Use CLIENTS.DD
57096>>>>>>>Use SALESMEN.DD
57096>>>>>>>Use MHXANIK.DD
INCLUDING FILE: MHXANIK.DD
57096>>>>>>>>>//DDB-FileStart
57096>>>>>>>>>//DDB-HeaderStart
57096>>>>>>>>>
57096>>>>>>>>>// File Name : MHXANIK.DD
57096>>>>>>>>>// Class Name: Mhxanik_DataDictionary
57096>>>>>>>>>// Revision  : 24
57096>>>>>>>>>// Version   : 2
57096>>>>>>>>>
57096>>>>>>>>>Use  Windows           // Basic Definitions
57096>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
57096>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57096>>>>>>>>>
57096>>>>>>>>>Open Mhxanik
57098>>>>>>>>>Open Cn
57100>>>>>>>>>Open Sysrecc
57102>>>>>>>>>
57102>>>>>>>>>//DDB-HeaderEnd
57102>>>>>>>>>//DDB-ValidationStart
57102>>>>>>>>>
57102>>>>>>>>>Register_Object Mhxanik_Mhx_Doy_VT
57102>>>>>>>>>
57102>>>>>>>>>Object Mhxanik_Mhx_Doy_VT  is a CodeValidationTable
57104>>>>>>>>>    Set Type_Value        To "DOY"
57105>>>>>>>>>    Set Validate_State    To FALSE
57106>>>>>>>>>    Set Allow_Blank_State To TRUE
57107>>>>>>>>>    //DDB-ValidationCustomStart
57107>>>>>>>>>    //DDB-ValidationCustomEnd
57107>>>>>>>>>End_Object   // Mhxanik_Mhx_Doy_VT
57108>>>>>>>>>//DDB-ValidationEnd
57108>>>>>>>>>//DDB-SelectionStart
57108>>>>>>>>>//DDB/ ExternalSelectionList sl055  sl055.SL
57108>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
57108>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
57108>>>>>>>>>Register_Object sl055
57108>>>>>>>>>Register_Object sl198
57108>>>>>>>>>Register_Object sl197
57108>>>>>>>>>//DDB-SelectionEnd
57108>>>>>>>>>
57108>>>>>>>>>Class Mhxanik_DataDictionary  is a DataDictionary_Sec
57109>>>>>>>>>
57109>>>>>>>>>     Procedure Update
57110>>>>>>>>>        Forward Send Update
57112>>>>>>>>>        // Insert Code Here
57112>>>>>>>>>        Move SysCurXR.Company_Code  to Mhxanik.Company_Code
57113>>>>>>>>>        Move SysCurXR.Branch_Code   to Mhxanik.Branch_Code
57114>>>>>>>>>        Move SysCurXR.Year_Year     to Mhxanik.Year_Year
57115>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
57115>>>>>>>>>        Move (Mhxanik.Xreosh-Mhxanik.Pistosh)   to Mhxanik.Ypoloipo
57116>>>>>>>>>        Move (Mhxanik.Plafon-Mhxanik.ypoloipo)  to Mhxanik.Overhead
57117>>>>>>>>>
57117>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
57117>>>>>>>>>
57117>>>>>>>>>        //betolink
57117>>>>>>>>>        Move SysCurXR.Beto_Site         to Mhxanik.Mhx_SiteW
57118>>>>>>>>>        Move Mhxanik.Mhx_Rec0           to Mhxanik.Mhx_SN
57119>>>>>>>>>        Move Mhxanik.Mhx_id             to Mhxanik.Mhx_Repm
57120>>>>>>>>>
57120>>>>>>>>>    End_Procedure   // Update
57121>>>>>>>>>
57121>>>>>>>>>     Procedure Creating
57122>>>>>>>>>        Forward Send Creating
57124>>>>>>>>>        // Insert Code Here
57124>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Mhxanik.Mhx_Rec0))))));                                    to Mhxanik.Mhx_Recr
57125>>>>>>>>>        Move '1'                    to Mhxanik.Mhx_Active
57126>>>>>>>>>        get fsgCode_With_Zeroes Mhxanik.Mhx_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Mhxanik.Mhx_ID
57127>>>>>>>>>    End_Procedure   // Creating
57128>>>>>>>>>
57128>>>>>>>>>
57128>>>>>>>>>    // Define_Fields:
57128>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
57128>>>>>>>>>
57128>>>>>>>>>    Procedure Define_Fields
57129>>>>>>>>>        Forward Send Define_Fields
57131>>>>>>>>>        //DDB-Generated-Code-Location
57131>>>>>>>>>        //DDB-DefineFieldStart
57131>>>>>>>>>
57131>>>>>>>>>        Set Main_File            To Mhxanik.File_Number
57132>>>>>>>>>        Set Cascade_Delete_State To FALSE
57133>>>>>>>>>
57133>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57134>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57135>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57136>>>>>>>>>
57136>>>>>>>>>        // Child (Client) file structure................
57136>>>>>>>>>        Send Add_Client_File  Cn.File_Number
57137>>>>>>>>>
57137>>>>>>>>>        // External (System) file structure.............
57137>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
57138>>>>>>>>>
57138>>>>>>>>>        Define_Auto_Increment  Sysrecc.Mhxanik_Rec0  To Mhxanik.Mhx_Rec0
57141>>>>>>>>>
57141>>>>>>>>>        // Field-based properties.......................
57141>>>>>>>>>
57141>>>>>>>>>        // Mhxanik.Company_Code
57141>>>>>>>>>
57141>>>>>>>>>        // Mhxanik.Branch_Code
57141>>>>>>>>>
57141>>>>>>>>>        // Mhxanik.Year_Year
57141>>>>>>>>>
57141>>>>>>>>>        // Mhxanik.Mhx_Id
57141>>>>>>>>>        Set Field_Options          Field Mhxanik.Mhx_Id To DD_AUTOFIND    DD_NOPUT      
57142>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Id To (sl055(Self))
57143>>>>>>>>>        Set Key_Field_State        Field Mhxanik.Mhx_Id To TRUE
57144>>>>>>>>>
57144>>>>>>>>>        // Mhxanik.Mhx_Name
57144>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Name To (sl055(Self))
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Mhx_Afm
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Mhx_Rec0
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Mhx_Recr
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Last_Xreosh
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Last_Pistosh
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Last_Order
57145>>>>>>>>>
57145>>>>>>>>>        // Mhxanik.Mhx_Doy
57145>>>>>>>>>        Set Field_Value_Table      Field Mhxanik.Mhx_Doy To (Mhxanik_Mhx_Doy_VT(Self))
57146>>>>>>>>>
57146>>>>>>>>>        // Mhxanik.Mhx_Address
57146>>>>>>>>>
57146>>>>>>>>>        // Mhxanik.Mhx_City
57146>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_City To (sl198(Self))
57147>>>>>>>>>
57147>>>>>>>>>        // Mhxanik.Mhx_Area
57147>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Area To (sl197(Self))
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Job
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Respons
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Zipcode
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Phone
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Fax
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Mobile
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Aoh
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Email
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Class
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Details
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Sitew
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Codem
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Categfpa
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Fpa
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Public
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Sn
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Repm
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Active
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Reported
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Lastupd
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Markexp
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Catjob
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Xreosh
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Pistosh
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Ypoloipo
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Plafon
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Overhead
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Add_No
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Nomos
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Mhx_Xora
57148>>>>>>>>>
57148>>>>>>>>>        // Mhxanik.Polh_Recr
57148>>>>>>>>>
57148>>>>>>>>>        //DDB-DefineFieldEnd
57148>>>>>>>>>    End_Procedure    // Define_Fields
57149>>>>>>>>>
57149>>>>>>>>>    // Field_Defaults:
57149>>>>>>>>>    // This procedure is used to establish default field values.
57149>>>>>>>>>
57149>>>>>>>>>    Procedure Field_Defaults
57150>>>>>>>>>        Forward Send Field_Defaults
57152>>>>>>>>>        //DDB-Generated-Code-Location
57152>>>>>>>>>        //DDB-FieldDefaultStart
57152>>>>>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_Doy To "0"
57153>>>>>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_City To 0
57154>>>>>>>>>        //DDB-FieldDefaultEnd
57154>>>>>>>>>    End_Procedure    // Field_Defaults
57155>>>>>>>>>
57155>>>>>>>>>End_Class    // Mhxanik_DataDictionary
57156>>>>>>>>>//DDB-Selection-pkg-Start
57156>>>>>>>>>
57156>>>>>>>>>Use sl055.SL         // sl055
INCLUDING FILE: SL055.SL
57156>>>>>>>>>>>//AB/ Project sl055:mhxanikoi
57156>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
57156>>>>>>>>>>>//AB/     Set ProjectName to "sl055:mhxanikoi"
57156>>>>>>>>>>>//AB/     Set ProjectFileName to "sl055.SL"
57156>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
57156>>>>>>>>>>>
57156>>>>>>>>>>>// Project Object Structure
57156>>>>>>>>>>>//   sl055 is a dbModalPanelSub
57156>>>>>>>>>>>//     Mhxanik_DD is a DataDictionary
57156>>>>>>>>>>>//     oSelList is a dbListSub
57156>>>>>>>>>>>//     oOK_bn is a ButtonSub
57156>>>>>>>>>>>//     oCancel_bn is a ButtonSub
57156>>>>>>>>>>>//     oSearch_bn is a ButtonSub
57156>>>>>>>>>>>
57156>>>>>>>>>>>// Register all objects
57156>>>>>>>>>>>Register_Object Mhxanik_DD
57156>>>>>>>>>>>Register_Object oCancel_bn
57156>>>>>>>>>>>Register_Object oOK_bn
57156>>>>>>>>>>>Register_Object oSearch_bn
57156>>>>>>>>>>>Register_Object oSelList
57156>>>>>>>>>>>Register_Object sl055
57156>>>>>>>>>>>
57156>>>>>>>>>>>
57156>>>>>>>>>>>//AB-IgnoreStart
57156>>>>>>>>>>>
57156>>>>>>>>>>>Use DFAllEnt.pkg
57156>>>>>>>>>>>Use dbList.Sub
57156>>>>>>>>>>>Use Button.Sub
57156>>>>>>>>>>>
57156>>>>>>>>>>>
57156>>>>>>>>>>>Use MHXANIK.DD
57156>>>>>>>>>>>
57156>>>>>>>>>>>//AB-IgnoreEnd
57156>>>>>>>>>>>
57156>>>>>>>>>>>Object sl055 is a dbModalPanelSub
57158>>>>>>>>>>>    Set Label to "€¨®œå¦ ‹ž®˜¤ ¡é¤"
57159>>>>>>>>>>>    Set Size to 148 430
57160>>>>>>>>>>>    Set Location to 4 5
57161>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
57162>>>>>>>>>>>    Set Modal_State to FALSE
57163>>>>>>>>>>>
57163>>>>>>>>>>>    //AB-DDOStart
57163>>>>>>>>>>>
57163>>>>>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
57165>>>>>>>>>>>    End_Object    // Mhxanik_DD
57166>>>>>>>>>>>
57166>>>>>>>>>>>    Set Main_DD to (Mhxanik_DD(self))
57167>>>>>>>>>>>    Set Server to (Mhxanik_DD(self))
57168>>>>>>>>>>>
57168>>>>>>>>>>>    //AB-DDOEnd
57168>>>>>>>>>>>
57168>>>>>>>>>>>    Object oSelList is a dbListSub
57170>>>>>>>>>>>        Set Main_File to Mhxanik.File_Number
57171>>>>>>>>>>>        Set Size to 105 415
57172>>>>>>>>>>>        Set Location to 6 6
57173>>>>>>>>>>>
57173>>>>>>>>>>>        Begin_Row
57176>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_id
57177>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_name
57178>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_afm
57179>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_address
57180>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_phone
57181>>>>>>>>>>>        End_Row
57186>>>>>>>>>>>
57186>>>>>>>>>>>        Set Form_Width    item 0 to 70
57187>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
57188>>>>>>>>>>>        
57188>>>>>>>>>>>        Set Form_Width    item 1 to 100
57189>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
57190>>>>>>>>>>>        
57190>>>>>>>>>>>        Set Form_Width    item 2 to 50
57191>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
57192>>>>>>>>>>>        
57192>>>>>>>>>>>        Set Form_Width    item 3 to 135
57193>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
57194>>>>>>>>>>>        
57194>>>>>>>>>>>        Set Form_Width    item 4 to 52
57195>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
57196>>>>>>>>>>>        
57196>>>>>>>>>>>    End_Object    // oSelList
57197>>>>>>>>>>>
57197>>>>>>>>>>>    Object oOK_bn is a ButtonSub
57199>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
57200>>>>>>>>>>>        Set Location to 113 263
57201>>>>>>>>>>>
57201>>>>>>>>>>>        //AB-StoreStart
57201>>>>>>>>>>>        Procedure OnClick
57203>>>>>>>>>>>            Send OK To (oSelList(current_object))
57204>>>>>>>>>>>        End_Procedure
57205>>>>>>>>>>>        //AB-StoreEnd
57205>>>>>>>>>>>
57205>>>>>>>>>>>    End_Object    // oOK_bn
57206>>>>>>>>>>>
57206>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
57208>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
57209>>>>>>>>>>>        Set Location to 113 317
57210>>>>>>>>>>>
57210>>>>>>>>>>>        //AB-StoreStart
57210>>>>>>>>>>>        Procedure OnClick
57212>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
57213>>>>>>>>>>>        End_Procedure
57214>>>>>>>>>>>        //AB-StoreEnd
57214>>>>>>>>>>>
57214>>>>>>>>>>>    End_Object    // oCancel_bn
57215>>>>>>>>>>>
57215>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
57217>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
57218>>>>>>>>>>>        Set Location to 113 373
57219>>>>>>>>>>>
57219>>>>>>>>>>>        //AB-StoreStart
57219>>>>>>>>>>>        Procedure OnClick
57221>>>>>>>>>>>            Send Search To (oSelList(current_object))
57222>>>>>>>>>>>        End_Procedure
57223>>>>>>>>>>>        //AB-StoreEnd
57223>>>>>>>>>>>
57223>>>>>>>>>>>    End_Object    // oSearch_bn
57224>>>>>>>>>>>
57224>>>>>>>>>>>
57224>>>>>>>>>>>    //AB-StoreStart
57224>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
57225>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
57226>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
57227>>>>>>>>>>>    //AB-StoreEnd
57227>>>>>>>>>>>
57227>>>>>>>>>>>End_Object    // sl055
57228>>>>>>>>>>>
57228>>>>>>>>>>>//AB/ End_Object    // prj
57228>>>>>>>>>Use sl198.sl         // sl198
57228>>>>>>>>>Use sl197.SL         // sl197
57228>>>>>>>>>
57228>>>>>>>>>//DDB-Selection-pkg-End
57228>>>>>>>>>//DDB-FileEnd
57228>>>>>>>Use CONSTRCT.DD
57228>>>>>>>Use CN.DD
57228>>>>>>>Use BTNORDH.DD
57228>>>>>>>Use BTNORDD.DD
INCLUDING FILE: BTNORDD.DD
57228>>>>>>>>>//DDB-FileStart
57228>>>>>>>>>//DDB-HeaderStart
57228>>>>>>>>>
57228>>>>>>>>>// File Name : BTNORDD.DD
57228>>>>>>>>>// Class Name: Btnordd_DataDictionary
57228>>>>>>>>>// Revision  : 52
57228>>>>>>>>>// Version   : 2
57228>>>>>>>>>
57228>>>>>>>>>Use  Windows           // Basic Definitions
57228>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
57228>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57228>>>>>>>>>
57228>>>>>>>>>Open Btnordd
57230>>>>>>>>>Open Btnordh
57232>>>>>>>>>
57232>>>>>>>>>//DDB-HeaderEnd
57232>>>>>>>>>//DDB-ValidationStart
57232>>>>>>>>>
57232>>>>>>>>>Register_Object Btnordd_Vkatish_VT
57232>>>>>>>>>Register_Object Btnordd_Velxr_VT
57232>>>>>>>>>
57232>>>>>>>>>Object Btnordd_Vkatish_VT  is a CodeValidationTable
57234>>>>>>>>>    Set Type_Value        To "KATISH"
57235>>>>>>>>>    Set Allow_Blank_State To TRUE
57236>>>>>>>>>    Set Table_Title       To "‰€‡ˆ‘†"
57237>>>>>>>>>    //DDB-ValidationCustomStart
57237>>>>>>>>>    //DDB-ValidationCustomEnd
57237>>>>>>>>>End_Object   // Btnordd_Vkatish_VT
57238>>>>>>>>>
57238>>>>>>>>>Object Btnordd_Velxr_VT  is a CodeValidationTable
57240>>>>>>>>>    Set Type_Value        To "ELXREOSH"
57241>>>>>>>>>    Set Validate_State    To FALSE
57242>>>>>>>>>    Set Table_Title       To "•¨âà©ž „¢¢œ §é¤ ”¦¨«åà¤"
57243>>>>>>>>>    //DDB-ValidationCustomStart
57243>>>>>>>>>    //DDB-ValidationCustomEnd
57243>>>>>>>>>End_Object   // Btnordd_Velxr_VT
57244>>>>>>>>>//DDB-ValidationEnd
57244>>>>>>>>>Open Item
57246>>>>>>>>>
57246>>>>>>>>>Class Btnordd_DataDictionary  is a DataDictionary_Sec
57247>>>>>>>>> 
57247>>>>>>>>>    Procedure Construct_Object
57248>>>>>>>>>        Forward Send Construct_Object
57250>>>>>>>>>        Property Number pnOldPctDisc    Public 0
57251>>>>>>>>>        Property Number pnOldPosoDisc   Public 0
57252>>>>>>>>>        //------------------------------------------------
57252>>>>>>>>>        // Properties gia na kraththoun oi palies times 
57252>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
57252>>>>>>>>>        // einai 1     js 03/12/2007
57252>>>>>>>>>        //------------------------------------------------  
57252>>>>>>>>>        Property Integer piCreateNew            Public  0
57253>>>>>>>>>        Property String  psAud_Old_AADeop       Public ""
57254>>>>>>>>>        Property Number  pnAud_Old_Vprice       Public  0
57255>>>>>>>>>        Property Number  pnAud_Old_PagiaXRM3    Public  0
57256>>>>>>>>>        Property Number  pnAud_Old_PagiaXRPrice Public  0
57257>>>>>>>>>        Property Number  pnAud_Old_Vanopagia    Public  0
57258>>>>>>>>>        Property Integer piAud_Old_Eleiph       Public  0    
57259>>>>>>>>>        Property String  psAud_Old_Vitem        Public ""
57260>>>>>>>>>        Property String  psAud_Old_CN_Code      Public ""
57261>>>>>>>>>        Property String  psAud_Old_CN_Descr     Public ""
57262>>>>>>>>>        Property String  psAud_Old_Client_ID    Public ""
57263>>>>>>>>>        Property String  psAud_Old_Client_Name  Public ""
57264>>>>>>>>>        //------------------------------------------------
57264>>>>>>>>>    End_Procedure
57265>>>>>>>>>    
57265>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
57266>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
57268>>>>>>>>>        Set pnOldPctDisc            to Btnordd.Vdisc
57269>>>>>>>>>        Set pnOldPosoDisc           to Btnordd.VdiscPoso
57270>>>>>>>>>        Set psAud_Old_AADeop        to BtnordH.AA_Deop
57271>>>>>>>>>        Set piAud_Old_Eleiph        to BtnordH.VelXr
57272>>>>>>>>>        Set pnAud_Old_Vprice        to Btnordd.Vprice
57273>>>>>>>>>        Set pnAud_Old_PagiaXRM3     to Btnordd.VpagiaXrM3
57274>>>>>>>>>        Set pnAud_Old_PagiaXRPrice  to Btnordd.VpagiaXrPrice
57275>>>>>>>>>        Set pnAud_Old_Vanopagia     to Btnordd.Vanopagia
57276>>>>>>>>>        Set psAud_Old_Vitem         to Btnordd.Vitem         
57277>>>>>>>>>        Set psAud_Old_CN_Code       to CN.CN_Code            
57278>>>>>>>>>        Set psAud_Old_CN_Descr      to CN.CN_Descr           
57279>>>>>>>>>        Set psAud_Old_Client_ID     to Clients.Client_ID     
57280>>>>>>>>>        Set psAud_Old_Client_Name   to Clients.Client_Name   
57281>>>>>>>>>    End_Procedure   // New_Current_Record
57282>>>>>>>>>
57282>>>>>>>>>    Procedure Delete_Main_File
57283>>>>>>>>>        //---------------------------------------------
57283>>>>>>>>>        // Auditing / Katagrafh allagon
57283>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
57284>>>>>>>>>        Date    dDate  Shmer 
57284>>>>>>>>>        Integer iMin iHour iSec iLen
57284>>>>>>>>>        Sysdate dDate iHour iMin iSec 
57288>>>>>>>>>        Move iHour  to sHour
57289>>>>>>>>>        Move iMin   to sMin
57290>>>>>>>>>        Move iSec   to sSec
57291>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
57295>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
57299>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
57303>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
57304>>>>>>>>>        
57304>>>>>>>>>        // Auditing / Diagrafh 
57304>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
57306>>>>>>>>>            Get fsLoginUserID to sUser
57307>>>>>>>>>            clear gmove
57308>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
57309>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
57310>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
57311>>>>>>>>>            move  7                     to gmove.gtypkin_code// Apo Clients
57312>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
57313>>>>>>>>>            move suser                  to gmove.gplan_code
57314>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Btnordd.Recnum)))))) ;                                        to gmove.garticl_recr
57315>>>>>>>>>            reread sysrecg
57319>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
57320>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
57321>>>>>>>>>            saverecord sysrecg
57322>>>>>>>>>            unlock
57323>>>>>>>>>>
57323>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
57324>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
57325>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
57326>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
57327>>>>>>>>>            
57327>>>>>>>>>            Move BtnordH.Recr                   to Gmove.Partl_Recr          
57328>>>>>>>>>            Move (String(BtnOrdD.Recnum))       to Gmove.Pms_Recr          
57329>>>>>>>>>
57329>>>>>>>>>            Move (psAud_Old_AADeop      (Self)) to Gmove.Prev_AA_Deop
57330>>>>>>>>>            Move (piAud_Old_Eleiph      (Self)) to Gmove.Prev_Eleiph
57331>>>>>>>>>            Move (pnAud_Old_Vprice      (Self)) to Gmove.Prev_Vprice
57332>>>>>>>>>            Move (pnAud_Old_PagiaXRM3   (Self)) to Gmove.Prev_pagiaXrM3
57333>>>>>>>>>            Move (pnAud_Old_PagiaXRPrice(Self)) to Gmove.Prev_Stoxos1
57334>>>>>>>>>            Move (pnAud_Old_Vanopagia   (Self)) to Gmove.Prev_Stoxos2   
57335>>>>>>>>>            Move (psAud_Old_Vitem       (Self)) to Gmove.Prev_Item    
57336>>>>>>>>>            Move (psAud_Old_CN_Code     (Self)) to Gmove.Prev_CN      
57337>>>>>>>>>            Move (psAud_Old_CN_Descr    (Self)) to Gmove.Prev_CN_Addr 
57338>>>>>>>>>            Move (psAud_Old_Client_ID   (Self)) to Gmove.Prev_ID      
57339>>>>>>>>>            Move (psAud_Old_Client_Name (Self)) to Gmove.Prev_Name    
57340>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ƒ„Ž"    to gmove.gmove_aitiol
57341>>>>>>>>>            Move "D"                         to Gmove.Eidos_Metabolhs
57342>>>>>>>>>            saverecord gmove
57343>>>>>>>>>        End
57343>>>>>>>>>>
57343>>>>>>>>>        Forward Send Delete_Main_File
57345>>>>>>>>>
57345>>>>>>>>>    End_Procedure
57346>>>>>>>>>
57346>>>>>>>>>    Procedure Creating
57347>>>>>>>>>        Forward Send Creating   
57349>>>>>>>>>        move btnordh.deop_active to btnordd.vactive
57350>>>>>>>>>        Set piCreateNew to 1
57351>>>>>>>>>    End_Procedure   // Creating
57352>>>>>>>>> 
57352>>>>>>>>>   Procedure Update
57353>>>>>>>>>        Number iOldPct iOldPoso Total
57354>>>>>>>>>        Forward Send Update   
57356>>>>>>>>>        Get pnOldPosoDisc           to iOldPoso
57357>>>>>>>>>        Get pnOldPctDisc            to iOldPct
57358>>>>>>>>>        move btnordh.aa_deop        to btnordd.vorderbt
57359>>>>>>>>>        move btnordh.client_id      to btnordd.vclient_id
57360>>>>>>>>>        move btnordh.cn_code        to btnordd.vcn_code
57361>>>>>>>>>        move btnordh.deop_lhxh      to btnordd.deop_date   
57362>>>>>>>>>        move btnordh.deop_date      to btnordd.arxh_date
57363>>>>>>>>>      
57363>>>>>>>>>        If  (Btnordd.Vqty <> 0) Begin
57365>>>>>>>>>            Move  btnordd.VunitPrice to btnordd.Vprice
57366>>>>>>>>>            If (btnordd.vdisc >0) move (round_number(((btnordd.vprice * btnordd.vdisc) / 100),2)) to total
57369>>>>>>>>>            Move (btnordd.vprice - total) to btnordd.vprice
57370>>>>>>>>>        End
57370>>>>>>>>>>
57370>>>>>>>>>        Else Begin
57371>>>>>>>>>            move 0 to btnordd.vprice
57372>>>>>>>>>            Move 0 to btnordd.Vdisc
57373>>>>>>>>>            Move 0 to btnordd.VdiscPoso
57374>>>>>>>>>        End
57374>>>>>>>>>>
57374>>>>>>>>>
57374>>>>>>>>>        If (Btnordd.Vitem<>'') Begin 
57376>>>>>>>>>            Clear Item
57377>>>>>>>>>            Move Btnordd.Vitem to Item.Item_Code
57378>>>>>>>>>            Find Eq Item by Index.5
57379>>>>>>>>>>
57379>>>>>>>>>            Move Item.Item_Descr to btnordd.Vitem_Descr
57380>>>>>>>>>            Move Item.Item_Qual  to btnordd.VQual    
57381>>>>>>>>>            Clear Item
57382>>>>>>>>>        End
57382>>>>>>>>>>
57382>>>>>>>>>
57382>>>>>>>>>        //---------------------------------------------
57382>>>>>>>>>        // Auditing / Katagrafh allagon
57382>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
57382>>>>>>>>>        Date    dDate  Shmer 
57382>>>>>>>>>        Integer iMin iHour iSec iLen
57382>>>>>>>>>        Sysdate dDate iHour iMin iSec 
57386>>>>>>>>>        Move iHour  to sHour
57387>>>>>>>>>        Move iMin   to sMin
57388>>>>>>>>>        Move iSec   to sSec
57389>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
57393>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
57397>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
57401>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
57402>>>>>>>>>        
57402>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
57402>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
57404>>>>>>>>>            Get fsLoginUserID to sUser
57405>>>>>>>>>            If (piCreateNew(Self)=1) Begin
57407>>>>>>>>>                clear gmove
57408>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
57409>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
57410>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
57411>>>>>>>>>                move  7                     to gmove.gtypkin_code
57412>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
57413>>>>>>>>>                move suser                  to gmove.gplan_code
57414>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Btnordd.Recnum)))))) ;                                            to gmove.garticl_recr
57415>>>>>>>>>                reread sysrecg
57419>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
57420>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
57421>>>>>>>>>                saverecord sysrecg
57422>>>>>>>>>                unlock
57423>>>>>>>>>>
57423>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
57424>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
57425>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
57426>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
57427>>>>>>>>>
57427>>>>>>>>>                Move BtnordH.Recr                   to Gmove.Partl_Recr          
57428>>>>>>>>>                Move (String(BtnOrdD.Recnum))       to Gmove.Pms_Recr          
57429>>>>>>>>>
57429>>>>>>>>>                Move BtnordH.AA_Deop            to Gmove.Cur_AA_Deop
57430>>>>>>>>>                Move BtnordH.VelXr             to Gmove.Cur_Eleiph
57431>>>>>>>>>                Move Btnordd.Vprice             to Gmove.Cur_Vprice
57432>>>>>>>>>                Move Btnordd.VpagiaXrM3         to Gmove.Cur_pagiaXrM3
57433>>>>>>>>>                Move Btnordd.VpagiaXrPrice      to Gmove.Cur_Stoxos1
57434>>>>>>>>>                Move Btnordd.Vanopagia          to Gmove.Cur_Stoxos2
57435>>>>>>>>>                Move Btnordd.Vitem              to Gmove.Cur_Item
57436>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
57437>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
57438>>>>>>>>>                Move Clients.Client_ID          to Gmove.Cur_ID
57439>>>>>>>>>                Move Clients.Client_Name        to Gmove.Cur_Name   
57440>>>>>>>>>                
57440>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ƒ„Ž" to Gmove.Gmove_Aitiol
57441>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
57442>>>>>>>>>                saverecord gmove
57443>>>>>>>>>                Set piCreateNew to 0
57444>>>>>>>>>            End
57444>>>>>>>>>>
57444>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
57447>>>>>>>>>                Integer isChanged
57447>>>>>>>>>                Move 0 to isChanged
57448>>>>>>>>>                
57448>>>>>>>>>                     If (psAud_Old_AADeop       (Self)<>BtnordH.AA_Deop      ) Move 1 to isChanged
57451>>>>>>>>>                Else If (piAud_Old_Eleiph       (Self)<>BtnordH.VelXr       ) Move 1 to isChanged
57455>>>>>>>>>                Else If (pnAud_Old_Vprice       (Self)<>Btnordd.Vprice       ) Move 1 to isChanged
57459>>>>>>>>>                Else If (pnAud_Old_PagiaXRM3    (Self)<>Btnordd.VpagiaXrM3   ) Move 1 to isChanged
57463>>>>>>>>>                Else If (pnAud_Old_PagiaXRPrice (Self)<>Btnordd.VpagiaXrPrice) Move 1 to isChanged
57467>>>>>>>>>                Else If (pnAud_Old_Vanopagia    (Self)<>Btnordd.Vanopagia    ) Move 1 to isChanged
57471>>>>>>>>>                Else If (psAud_Old_Vitem        (Self)<>Btnordd.Vitem        ) Move 1 to isChanged
57475>>>>>>>>>                Else If (psAud_Old_CN_Code      (Self)<>CN.CN_Code           ) Move 1 to isChanged
57479>>>>>>>>>                Else If (psAud_Old_CN_Descr     (Self)<>CN.CN_Descr          ) Move 1 to isChanged
57483>>>>>>>>>                Else If (psAud_Old_Client_ID    (Self)<>Clients.Client_ID    ) Move 1 to isChanged
57487>>>>>>>>>                Else If (psAud_Old_Client_Name  (Self)<>Clients.Client_Name  ) Move 1 to isChanged
57491>>>>>>>>>                
57491>>>>>>>>>                If (isChanged>0) Begin  
57493>>>>>>>>>                    clear gmove
57494>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
57495>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
57496>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
57497>>>>>>>>>                    move  7                     to gmove.gtypkin_code// Apo Clients
57498>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
57499>>>>>>>>>                    move suser                  to gmove.gplan_code
57500>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Btnordd.Recnum)))))) ;                                                to gmove.garticl_recr
57501>>>>>>>>>                    reread sysrecg
57505>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
57506>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
57507>>>>>>>>>                    saverecord sysrecg
57508>>>>>>>>>                    unlock
57509>>>>>>>>>>
57509>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
57510>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
57511>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
57512>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
57513>>>>>>>>>                    //--
57513>>>>>>>>>                    Move BtnordH.Recr                   to Gmove.Partl_Recr          
57514>>>>>>>>>                    Move (String(BtnOrdD.Recnum))       to Gmove.Pms_Recr          
57515>>>>>>>>>                    //--                                
57515>>>>>>>>>                    Move BtnordH.AA_Deop                to Gmove.Cur_AA_Deop
57516>>>>>>>>>                    Move BtnordH.VelXr                 to Gmove.Cur_Eleiph
57517>>>>>>>>>                    Move Btnordd.Vprice                 to Gmove.Cur_Vprice
57518>>>>>>>>>                    Move Btnordd.VpagiaXrM3             to Gmove.Cur_pagiaXrM3
57519>>>>>>>>>                    Move Btnordd.VpagiaXrPrice          to Gmove.Cur_Stoxos1
57520>>>>>>>>>                    Move Btnordd.Vanopagia              to Gmove.Cur_Stoxos2
57521>>>>>>>>>                    Move Btnordd.Vitem                  to Gmove.Cur_Item
57522>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
57523>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
57524>>>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
57525>>>>>>>>>                    Move Clients.Client_Name            to Gmove.Cur_Name
57526>>>>>>>>>                    //--
57526>>>>>>>>>                    Move (psAud_Old_AADeop      (Self)) to Gmove.Prev_AA_Deop        
57527>>>>>>>>>                    Move (piAud_Old_Eleiph      (Self)) to Gmove.Prev_Eleiph         
57528>>>>>>>>>                    Move (pnAud_Old_Vprice      (Self)) to Gmove.Prev_Vprice       
57529>>>>>>>>>                    Move (pnAud_Old_PagiaXRM3   (Self)) to Gmove.Prev_pagiaXrM3   
57530>>>>>>>>>                    Move (pnAud_Old_PagiaXRPrice(Self)) to Gmove.Prev_Stoxos1      
57531>>>>>>>>>                    Move (pnAud_Old_Vanopagia   (Self)) to Gmove.Prev_Stoxos2      
57532>>>>>>>>>                    Move (psAud_Old_Vitem       (Self)) to Gmove.Prev_Item            
57533>>>>>>>>>                    Move (psAud_Old_CN_Code     (Self)) to Gmove.Prev_CN              
57534>>>>>>>>>                    Move (psAud_Old_CN_Descr    (Self)) to Gmove.Prev_CN_Addr         
57535>>>>>>>>>                    Move (psAud_Old_Client_ID   (Self)) to Gmove.Prev_ID              
57536>>>>>>>>>                    Move (psAud_Old_Client_Name (Self)) to Gmove.Prev_Name            
57537>>>>>>>>>
57537>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ƒ„Ž"       to gmove.gmove_aitiol
57538>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
57539>>>>>>>>>                    saverecord gmove
57540>>>>>>>>>                    Set piCreateNew to 0
57541>>>>>>>>>                End
57541>>>>>>>>>>
57541>>>>>>>>>            End
57541>>>>>>>>>>
57541>>>>>>>>>        End
57541>>>>>>>>>>
57541>>>>>>>>>
57541>>>>>>>>>   End_Procedure
57542>>>>>>>>>   
57542>>>>>>>>> 
57542>>>>>>>>>
57542>>>>>>>>>    // Define_Fields:
57542>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
57542>>>>>>>>>
57542>>>>>>>>>    Procedure Define_Fields
57543>>>>>>>>>        Forward Send Define_Fields
57545>>>>>>>>>        //DDB-Generated-Code-Location
57545>>>>>>>>>        //DDB-DefineFieldStart
57545>>>>>>>>>
57545>>>>>>>>>        Set Main_File            To Btnordd.File_Number
57546>>>>>>>>>
57546>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57547>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57548>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57549>>>>>>>>>
57549>>>>>>>>>        // Parent (Server) file structure...............
57549>>>>>>>>>        Send Add_Server_File  Btnordh.File_Number
57550>>>>>>>>>
57550>>>>>>>>>        // Field-based properties.......................
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Btnordh_Recr
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vitem
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vitem_Descr
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vqual
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vqty
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vunitprice
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vdisc
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vprice
57550>>>>>>>>>
57550>>>>>>>>>        // Btnordd.Vkatish
57550>>>>>>>>>        Set Field_Value_Table      Field Btnordd.Vkatish To (Btnordd_Vkatish_VT(Self))
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vxrm3
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vpagiaxrm3
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vpagiaxrprice
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vanopagia
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vsthsimo
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Veleipes
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vorderbt
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vclient_Id
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vcn_Code
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Vactive
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Deop_Date
57551>>>>>>>>>
57551>>>>>>>>>        // Btnordd.Velxr
57551>>>>>>>>>        Set Field_Value_Table      Field Btnordd.Velxr To (Btnordd_Velxr_VT(Self))
57552>>>>>>>>>
57552>>>>>>>>>        // Btnordd.Arxh_Date
57552>>>>>>>>>        Set Field_Mask_Type        Field Btnordd.Arxh_Date To MASK_DATE_WINDOW
57553>>>>>>>>>
57553>>>>>>>>>        // Btnordd.Vdiscposo
57553>>>>>>>>>
57553>>>>>>>>>        // Btnordd.Vqtyused
57553>>>>>>>>>
57553>>>>>>>>>        //DDB-DefineFieldEnd
57553>>>>>>>>>    End_Procedure    // Define_Fields
57554>>>>>>>>>
57554>>>>>>>>>    // Field_Defaults:
57554>>>>>>>>>    // This procedure is used to establish default field values.
57554>>>>>>>>>
57554>>>>>>>>>    Procedure Field_Defaults
57555>>>>>>>>>        Forward Send Field_Defaults
57557>>>>>>>>>        //DDB-Generated-Code-Location
57557>>>>>>>>>        //DDB-FieldDefaultStart
57557>>>>>>>>>        //DDB-FieldDefaultEnd
57557>>>>>>>>>    End_Procedure    // Field_Defaults
57558>>>>>>>>>
57558>>>>>>>>>End_Class    // Btnordd_DataDictionary
57559>>>>>>>>>//DDB-FileEnd
57559>>>>>>>
57559>>>>>>>//AB-IgnoreEnd
57559>>>>>>>
57559>>>>>>>Object btnordh is a dbModalPanelSub
57561>>>>>>>
57561>>>>>>>    //AB-StoreTopStart
57561>>>>>>>    Function fnCn string descr Returns string
57563>>>>>>>          clear cn
57564>>>>>>>          move descr to cn.cn_code
57565>>>>>>>          find eq cn by index.5
57566>>>>>>>>
57566>>>>>>>          move cn.cn_descr to descr
57567>>>>>>>          function_return descr
57568>>>>>>>    end_Function
57569>>>>>>>    
57569>>>>>>>    property string psclient     public ''
57571>>>>>>>    property string pscn         public ''
57573>>>>>>>    //AB-StoreTopEnd
57573>>>>>>>
57573>>>>>>>    Set Label to "€¨®œå¦ ƒ.„.Ž."
57574>>>>>>>    Set Size to 233 519
57575>>>>>>>    Set Location to 4 5
57576>>>>>>>    Set Exit_Application_Local_State to FALSE
57577>>>>>>>    Set Modal_State to FALSE
57578>>>>>>>
57578>>>>>>>    //AB-DDOStart
57578>>>>>>>
57578>>>>>>>    Object Country_DD is a Country_DataDictionary
57580>>>>>>>    End_Object    // Country_DD
57581>>>>>>>
57581>>>>>>>    Object Towns_DD is a Towns_DataDictionary
57583>>>>>>>        Set DDO_Server to (Country_DD(self))
57584>>>>>>>    End_Object    // Towns_DD
57585>>>>>>>
57585>>>>>>>    Object Cities_DD is a Cities_DataDictionary
57587>>>>>>>        Set DDO_Server to (Towns_DD(self))
57588>>>>>>>    End_Object    // Cities_DD
57589>>>>>>>
57589>>>>>>>    Object Areas_DD is a Areas_DataDictionary
57591>>>>>>>    End_Object    // Areas_DD
57592>>>>>>>
57592>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
57594>>>>>>>    End_Object    // Payresp_DD
57595>>>>>>>
57595>>>>>>>    Object Clients_DD is a Clients_DataDictionary
57597>>>>>>>        Set DDO_Server to (Cities_DD(self))
57598>>>>>>>        Set DDO_Server to (Areas_DD(self))
57599>>>>>>>        Set DDO_Server to (Payresp_DD(self))
57600>>>>>>>    End_Object    // Clients_DD
57601>>>>>>>
57601>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
57603>>>>>>>    End_Object    // Salesmen_DD
57604>>>>>>>
57604>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
57606>>>>>>>    End_Object    // Mhxanik_DD
57607>>>>>>>
57607>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
57609>>>>>>>    End_Object    // Constrct_DD
57610>>>>>>>
57610>>>>>>>    Object Cn_DD is a Cn_DataDictionary
57612>>>>>>>        Set DDO_Server to (Clients_DD(self))
57613>>>>>>>        Set DDO_Server to (Salesmen_DD(self))
57614>>>>>>>        Set DDO_Server to (Mhxanik_DD(self))
57615>>>>>>>        Set DDO_Server to (Constrct_DD(self))
57616>>>>>>>    End_Object    // Cn_DD
57617>>>>>>>
57617>>>>>>>    Object Btnordh_DD is a Btnordh_DataDictionary
57619>>>>>>>        Set DDO_Server to (Cn_DD(self))
57620>>>>>>>
57620>>>>>>>        //AB-StoreStart
57620>>>>>>>        set ordering to 1
57621>>>>>>>        Begin_Constraints
57623>>>>>>>            String sID scn
57624>>>>>>>            Get psclient to sID
57625>>>>>>>            get pscn     to scn
57626>>>>>>>            if ((scn='') and (sid='')) set ordering to 1
57629>>>>>>>            else set ordering to 6
57631>>>>>>>            If (sID<>'') begin
57633>>>>>>>                Constrain btnordh.Client_ID eq sID
57635>>>>>>>            end
57635>>>>>>>>
57635>>>>>>>            If (scn<>'') begin
57637>>>>>>>                constrain btnordh.cn_code   eq scn
57639>>>>>>>            end
57639>>>>>>>>
57639>>>>>>>        
57639>>>>>>>        End_Constraints
57642>>>>>>>        
57642>>>>>>>        //AB-StoreEnd
57642>>>>>>>
57642>>>>>>>    End_Object    // Btnordh_DD
57643>>>>>>>
57643>>>>>>>    Object Btnordd_DD is a BTNORDD_DataDictionary
57645>>>>>>>        Set DDO_Server to (Btnordh_DD(self))
57646>>>>>>>        Set Constrain_File to Btnordh.File_Number
57647>>>>>>>    End_Object    // Btnordd_DD
57648>>>>>>>
57648>>>>>>>    Set Main_DD to (Btnordh_DD(self))
57649>>>>>>>    Set Server to (Btnordh_DD(self))
57650>>>>>>>
57650>>>>>>>    //AB-DDOEnd
57650>>>>>>>
57650>>>>>>>    Object oSelList is a dbListSub
57652>>>>>>>        Set Main_File to Btnordh.File_Number
57653>>>>>>>        Set Ordering to 6
57654>>>>>>>        Set Size to 192 507
57655>>>>>>>        Set Location to 6 6
57656>>>>>>>        Set Auto_Index_State to FALSE
57657>>>>>>>
57657>>>>>>>        Begin_Row
57660>>>>>>>            Entry_Item Btnordh.Aa_deop
57661>>>>>>>            Entry_Item Btnordh.Client_id
57662>>>>>>>            Entry_Item (fsclient(self,btnordh.client_id))
57663>>>>>>>            Entry_Item Btnordh.Cn_code
57664>>>>>>>            Entry_Item (fncn(self,btnordh.cn_code))
57665>>>>>>>            Entry_Item Btnordh.Deop_date
57666>>>>>>>            Entry_Item Btnordh.Deop_lhxh
57667>>>>>>>            Entry_Item Btnordh.Deop_active
57668>>>>>>>            Entry_Item Btnordh.Locked
57669>>>>>>>            Entry_Item Btnordh.Statero
57670>>>>>>>        End_Row
57675>>>>>>>
57675>>>>>>>        Set Form_Width    item 0 to 66
57676>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ƒ.„.Ž."
57677>>>>>>>        
57677>>>>>>>        Set Form_Width    item 1 to 51
57678>>>>>>>        Set Header_Label  item 1 to "‰à›.œ¢á«ž"
57679>>>>>>>        
57679>>>>>>>        Set Form_Width    item 2 to 87
57680>>>>>>>        Set Header_Label  item 2 to "„§à¤¬£å˜ œ¢á«ž"
57681>>>>>>>        
57681>>>>>>>        Set Form_Width    item 3 to 51
57682>>>>>>>        Set Header_Label  item 3 to "‰à›.„¨š¦¬"
57683>>>>>>>        
57683>>>>>>>        Set Form_Width    item 4 to 106
57684>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã „¨š¦¬"
57685>>>>>>>        
57685>>>>>>>        Set Form_Width    item 5 to 47
57686>>>>>>>        Set Header_Label  item 5 to "ë¤˜¨¥ž"
57687>>>>>>>        
57687>>>>>>>        Set Form_Width    item 6 to 44
57688>>>>>>>        Set Header_Label  item 6 to "Šã¥ž"
57689>>>>>>>        
57689>>>>>>>        Set Form_Width    item 7 to 19
57690>>>>>>>        Set Header_Label  item 7 to "Off"
57691>>>>>>>        Set Column_Checkbox_State  item 7 to True
57692>>>>>>>        
57692>>>>>>>        Set Form_Width    item 8 to 17
57693>>>>>>>        Set Header_Label  item 8 to "‰Š"
57694>>>>>>>        Set Column_Checkbox_State  item 8 to True
57695>>>>>>>        
57695>>>>>>>        Set Form_Width    item 9 to 13
57696>>>>>>>        Set Header_Label  item 9 to "‘"
57697>>>>>>>        Set Column_Checkbox_State  item 9 to True
57698>>>>>>>        
57698>>>>>>>
57698>>>>>>>        //AB-StoreStart
57698>>>>>>>                                                                                        
57698>>>>>>>                                                                                        
57698>>>>>>>        Procedure Activating Returns Integer
57700>>>>>>>            Integer rVal
57701>>>>>>>            Forward Get Msg_Activating to rVal
57703>>>>>>>            Send Rebuild_Constraints to (btnordh_DD(Self))
57704>>>>>>>            set auto_index_state to true
57705>>>>>>>            Procedure_Return rVal
57706>>>>>>>        End_Procedure
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        
57707>>>>>>>        //AB-StoreEnd
57707>>>>>>>
57707>>>>>>>    End_Object    // oSelList
57708>>>>>>>
57708>>>>>>>    Object oOK_bn is a ButtonSub
57710>>>>>>>        Set Label to "&„§ ¢¦šã"
57711>>>>>>>        Set Location to 201 335
57712>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57713>>>>>>>
57713>>>>>>>        //AB-StoreStart
57713>>>>>>>        Procedure OnClick
57715>>>>>>>            Send OK To (oSelList(current_object))
57716>>>>>>>        End_Procedure
57717>>>>>>>        //AB-StoreEnd
57717>>>>>>>
57717>>>>>>>    End_Object    // oOK_bn
57718>>>>>>>
57718>>>>>>>    Object oCancel_bn is a ButtonSub
57720>>>>>>>        Set Label to "&€¡ç¨à©ž"
57721>>>>>>>        Set Location to 201 389
57722>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57723>>>>>>>
57723>>>>>>>        //AB-StoreStart
57723>>>>>>>        Procedure OnClick
57725>>>>>>>            Send Cancel To (oSelList(current_object))
57726>>>>>>>        End_Procedure
57727>>>>>>>        //AB-StoreEnd
57727>>>>>>>
57727>>>>>>>    End_Object    // oCancel_bn
57728>>>>>>>
57728>>>>>>>    Object oSearch_bn is a ButtonSub
57730>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
57731>>>>>>>        Set Location to 201 445
57732>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57733>>>>>>>
57733>>>>>>>        //AB-StoreStart
57733>>>>>>>        Procedure OnClick
57735>>>>>>>            Send Search To (oSelList(current_object))
57736>>>>>>>        End_Procedure
57737>>>>>>>        //AB-StoreEnd
57737>>>>>>>
57737>>>>>>>    End_Object    // oSearch_bn
57738>>>>>>>
57738>>>>>>>
57738>>>>>>>    //AB-StoreStart
57738>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
57739>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
57740>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
57741>>>>>>>    
57741>>>>>>>    Procedure Activating Returns Integer
57743>>>>>>>        Integer rVal
57744>>>>>>>        Forward Get Msg_Activating to rVal
57746>>>>>>>        Send Beginning_Of_Data to oSelList
57747>>>>>>>        Procedure_Return rVal
57748>>>>>>>    End_Procedure
57749>>>>>>>    
57749>>>>>>>    
57749>>>>>>>    
57749>>>>>>>    
57749>>>>>>>    
57749>>>>>>>    
57749>>>>>>>    //AB-StoreEnd
57749>>>>>>>
57749>>>>>>>End_Object    // btnordh
57750>>>>>>>
57750>>>>>>>//AB/ End_Object    // prj
57750>>>>>
57750>>>>>//DDB-Selection-pkg-End
57750>>>>>//DDB-FileEnd
57750>>>Use BtnOrdD.DD
57750>>>Use Mhxanik.DD
57750>>>Use Constrct.dd
57750>>>Use Salesmen.dd
57750>>>Use sysrecc.dd
INCLUDING FILE: SYSRECC.DD
57750>>>>>//DDB-FileStart
57750>>>>>//DDB-HeaderStart
57750>>>>>
57750>>>>>// File Name : SYSRECC.DD
57750>>>>>// Class Name: Sysrecc_DataDictionary
57750>>>>>// Revision  : 42
57750>>>>>// Version   : 2
57750>>>>>
57750>>>>>Use  Windows           // Basic Definitions
57750>>>>>Use  DataDict          // DataDictionary Class Definition
57750>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57750>>>>>
57750>>>>>Open Sysrecc
57752>>>>>
57752>>>>>//DDB-HeaderEnd
57752>>>>>
57752>>>>>Class Sysrecc_DataDictionary  is a DataDictionary
57753>>>>>
57753>>>>>    // Define_Fields:
57753>>>>>    // This procedure is used to set up all data-dictionary rules.
57753>>>>>
57753>>>>>    Procedure Define_Fields
57754>>>>>        Forward Send Define_Fields
57756>>>>>        //DDB-Generated-Code-Location
57756>>>>>        //DDB-DefineFieldStart
57756>>>>>
57756>>>>>        Set Main_File            To Sysrecc.File_Number
57757>>>>>
57757>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57758>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57759>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57760>>>>>
57760>>>>>        // Field-based properties.......................
57760>>>>>
57760>>>>>        // Sysrecc.Ctypkin_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Cflagkin_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Client_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Cmoves_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Copen_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Cmhnes_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Chmnies_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Custprom_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Cn_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Constr_Clients
57760>>>>>
57760>>>>>        // Sysrecc.Hmgio_Code
57760>>>>>
57760>>>>>        // Sysrecc.Payresp_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Salesmen_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Constrct_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Drivers_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Mhxanik_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Brzone_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Cnzone_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Tpclient_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Tperga_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Tparticl_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Tppresp_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Tpbranch_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Orders_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Ordersd_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Clorder_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Clorderd_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Ordersc_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Ordersdc_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Clorderc_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Clorderdc_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Yclients_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Aa_Ypoprosf
57760>>>>>
57760>>>>>        // Sysrecc.Btnemp_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Btnordh_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Dorderh_Rec0
57760>>>>>
57760>>>>>        // Sysrecc.Dorderd_Rec0
57760>>>>>
57760>>>>>        //DDB-DefineFieldEnd
57760>>>>>    End_Procedure    // Define_Fields
57761>>>>>
57761>>>>>    // Field_Defaults:
57761>>>>>    // This procedure is used to establish default field values.
57761>>>>>
57761>>>>>    Procedure Field_Defaults
57762>>>>>        Forward Send Field_Defaults
57764>>>>>        //DDB-Generated-Code-Location
57764>>>>>        //DDB-FieldDefaultStart
57764>>>>>        //DDB-FieldDefaultEnd
57764>>>>>    End_Procedure    // Field_Defaults
57765>>>>>
57765>>>>>End_Class    // Sysrecc_DataDictionary
57766>>>>>//DDB-FileEnd
57766>>>open cn
57768>>>//Use bp2ndCop.dg
57768>>>//Use bpACopen.dg
57768>>>
57768>>>
57768>>>//AB-StoreTopEnd
57768>>>
57768>>>//AB-IgnoreStart
57768>>>
57768>>>Use dbView.Sub
57768>>>Use Form.Sub
57768>>>Use Button.Sub
57768>>>Use Txtbox.Sub
57768>>>Use DFAllEnt.pkg
57768>>>
57768>>>//AB-IgnoreEnd
57768>>>
57768>>>ACTIVATE_VIEW Activate_gefyres2 FOR gefyres2
57772>>>
57772>>>Object gefyres2 is a dbViewSub
57774>>>
57774>>>    //AB-StoreTopStart
57774>>>                                                                        
57774>>>    Property Integer piLathos   Public   0
57776>>>    Property String  psModule   Public '01'
57778>>>    Property Integer piWhat     Public   0
57780>>>    
57780>>>    //Open Sysrecc
57780>>>    Open SysCurXR
57782>>>    Open Year
57784>>>    
57784>>>    
57784>>>    //////////////////////////////////////////////////////
57784>>>    // DataDictionary Structure needed for making Barticle
57784>>>    //////////////////////////////////////////////////////
57784>>>    
57784>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
57786>>>    End_Object    // Ctypkin_DD
57787>>>    
57787>>>    Object Country_DD is a Country_DataDictionary
57789>>>    End_Object    // Country_DD
57790>>>    
57790>>>    Object Towns_DD is a Towns_DataDictionary
57792>>>        Set DDO_Server To (Country_DD(Self))
57793>>>    End_Object    // Towns_DD
57794>>>    
57794>>>    Object Cities_DD is a Cities_DataDictionary
57796>>>        Set DDO_Server To (Towns_DD(Self))
57797>>>    End_Object    // Cities_DD
57798>>>    
57798>>>    Object Payresp_DD is a Payresp_DataDictionary
57800>>>    End_Object    // Payresp_DD
57801>>>    
57801>>>    Object Constrct_DD is a Constrct_DataDictionary
57803>>>    End_Object    // Constrct_DD
57804>>>    
57804>>>    Object Salesmen_DD is a Salesmen_DataDictionary
57806>>>    End_Object    // Salesmen_DD
57807>>>    
57807>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
57809>>>    End_Object    // Mhxanik_DD
57810>>>    
57810>>>    Object Areas_DD is a Areas_DataDictionary
57812>>>    End_Object    // Areas_DD
57813>>>    
57813>>>    Object Btypkin_DD is a Btypkin_DataDictionary
57815>>>        Set Foreign_Field_Options DD_KEYFIELD           To DD_Clear_Field_Options DD_FindReq
57816>>>        Set Foreign_Field_Options DD_INDEXFIELD         To DD_Clear_Field_Options DD_FindReq
57817>>>        Set Field_Options Field Btypkin.Btypkin_Code    To DD_Clear_Field_Options DD_Required
57818>>>    End_Object    // Btypkin_DD
57819>>>    
57819>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
57821>>>    End_Object    // Baxiokat_DD
57822>>>    
57822>>>    Object Barticl_DD is a Barticl_DataDictionary
57824>>>        Set DDO_Server To (Btypkin_DD(Self))
57825>>>    End_Object    // Barticl_DD
57826>>>    
57826>>>    Object Bsum_DD is a Bsum_DataDictionary
57828>>>        Set DDO_Server To (Barticl_DD(Self))
57829>>>        Set Constrain_File To Barticl.File_Number
57830>>>    End_Object    // Bsum_DD
57831>>>    
57831>>>    Object Baxio_DD is a Baxio_DataDictionary
57833>>>        Set DDO_Server To (Baxiokat_DD(Self))
57834>>>        Set allow_foreign_new_save_state To True
57835>>>    End_Object    // Baxio_DD
57836>>>    
57836>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
57838>>>    End_Object    // Syscurxr_DD
57839>>>    
57839>>>    Object Sysrecc_DD is a Sysrecc_DataDictionary
57841>>>    End_Object    // Sysrecc
57842>>>    
57842>>>    Object Clients_DD is a Clients_DataDictionary
57844>>>        Set DDO_Server To (Cities_DD(Self))
57845>>>        Set DDO_Server To (Payresp_DD(Self))
57846>>>        Set DDO_Server To (Areas_DD(Self))
57847>>>    End_Object    // Clients_DD
57848>>>    
57848>>>    Object Cn_DD is a Cn_DataDictionary
57850>>>        Set DDO_Server To (Clients_DD(Self))
57851>>>        Set DDO_Server To (Constrct_DD(Self))
57852>>>        Set DDO_Server To (Salesmen_DD(Self))
57853>>>        Set DDO_Server To (Mhxanik_DD(Self))
57854>>>    End_Object    // Cn_DD
57855>>>    
57855>>>    Object Tperga_DD is a Tperga_DataDictionary
57857>>>        Set DDO_Server To (CN_DD(Self))
57858>>>        Set DDO_Server To (Baxiokat_DD(Self))
57859>>>        Set Constrain_File To CN.File_Number
57860>>>    End_Object    // Btnordd_DD
57861>>>    
57861>>>    Object Bmove_DD is a Bmove_DataDictionary
57863>>>        Set DDO_Server To (Barticl_DD(Self))
57864>>>        Set DDO_Server To (Baxio_DD(Self))
57865>>>        Set Constrain_File To Barticl.File_Number
57866>>>    End_Object    // Bmove_DD
57867>>>    
57867>>>    Object Cmoves_DD is a Cmoves_DataDictionary
57869>>>        Set DDO_Server To (Ctypkin_DD(Self))
57870>>>        Set DDO_Server To (Clients_DD(Self))
57871>>>        //Set Constrain_File to Clients.File_Number
57871>>>        Set piFromBP To True
57872>>>    
57872>>>    
57872>>>        Procedure Update
57874>>>            String  sNomisma
57875>>>            Date    dHmnia
57875>>>            Move Cmoves.Cmoves_Hmnia                To  dHmnia
57876>>>            If (dHmnia='') Sysdate4                     Cmoves.Cmoves_Hmnia
57879>>>            Move Cmoves.Cmoves_Sc_Code2             To  sNomisma
57880>>>            Move (Trim(sNomisma))                   To  sNomisma
57881>>>            If (sNomisma='') Move SysCurXr.C_Code0  To  Cmoves.Cmoves_Sc_Code2
57884>>>    
57884>>>            Send Compute_all_Fields 1
57885>>>    
57885>>>            Forward Send Update
57887>>>    
57887>>>            If (Ctypkin.Open_Item='1') Begin
57889>>>                If (Cmoves.Axia_Pros_Sysx=0) ;                    Move (Abs(Cmoves.Cmoves_Axia))              To Cmoves.Axia_Pros_Sysx
57892>>>                Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) To Cmoves.Axia_Ypol_Sysx
57893>>>                Move (Cmoves.Axia_Ypol_Sysx<>0)                 To Cmoves.Flag_Ypol
57894>>>    
57894>>>                If ((Cmoves.Cmoves_X0<>0) and ((Cmoves.Cmoves_P0=0))) Begin
57896>>>                    Move 1                          To Cmoves.Flag_Copen
57897>>>                    If (Cmoves.Cmoves_X0<0) Move 2  To Cmoves.Flag_Copen
57900>>>                End
57900>>>>
57900>>>                Else If ((Cmoves.Cmoves_P0<>0) and ((Cmoves.Cmoves_X0=0))) Begin
57903>>>                    Move 2                          To Cmoves.Flag_Copen
57904>>>                    If (Cmoves.Cmoves_P0<0) Move 1  To Cmoves.Flag_Copen
57907>>>                End
57907>>>>
57907>>>                Else Move 0 To Cmoves.Flag_Copen
57909>>>            End
57909>>>>
57909>>>        End_Procedure
57910>>>    
57910>>>        Procedure Backout
57912>>>            Forward Send Backout
57914>>>            Send Compute_all_Fields (-1)
57915>>>        End_Procedure
57916>>>    
57916>>>        Procedure Compute_all_Fields Number aiSign
57918>>>            Integer iErr isClosed iInt iWithDeletion iClient iSign
57919>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iMustSaveClientYpoloipa
57919>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag
57919>>>            Integer iMaxDays iAnameneiSxetiko iExeiSxetika iPartlTimol imustsaveofeilh
57919>>>    
57919>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort
57919>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code
57919>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr
57919>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr
57919>>>    
57919>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia
57919>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd
57919>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6
57919>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8
57919>>>    
57919>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
57919>>>            String sModule
57919>>>    
57919>>>            Move '01' To sModule
57920>>>    
57920>>>            Move 1 To iSign
57921>>>    
57921>>>            If ((Cmoves.Module_From=sModule) and (Cmoves.Barticl_Recr='') and (Cmoves.Partl_Recr=''))  Begin
57923>>>    
57923>>>                Move Ctypkin.Ctypkin_Recr   To sCtypkinRecr
57924>>>                Move clients.client_recr    To sclientrecr
57925>>>                Move Cmoves.Cmoves_sc_code2 To sNomisma
57926>>>                Move (Trim(sNomisma))       To sNomisma
57927>>>    
57927>>>                If (Trim(sCtypkinRecr)='') Begin
57929>>>                    Send stop_box '-åí ??åôå åðéë?îåé ôýðï ê-íç?ç?' ("error 1011 vwcmoves  "+'?ëçñï?ïñ-á')
57930>>>                    Procedure_Return
57931>>>                End
57931>>>>
57931>>>                Else If (Trim(sClientRecr)='') Begin
57934>>>                        If (smodule='01') Send stop_box '-åí ??åôå åðéë?îåé ?åë-ôç'      ("error 1012 vwcmoves  "+'?ëçñï?ïñ-á')
57937>>>                    Else If (smodule='02') Send stop_box '-åí ??åôå åðéë?îåé ?ñïìçèåõô?'  ("error 1013 vwcmoves  "+'?ëçñï?ïñ-á')
57941>>>                    Procedure_Return
57942>>>                End
57942>>>>
57942>>>                Else If (Trim(sNomisma)='') Begin
57945>>>                    Send stop_box '-åí ??åôå åðéë?îåé =ïìé?ìá' ("error 1014 vwcmoves  "+'?ëçñï?ïñ-á')
57946>>>                    Procedure_Return
57947>>>                End
57947>>>>
57947>>>    
57947>>>    
57947>>>                Move Cmoves.Cmoves_Hmnia    To dHmnia
57948>>>                Move Cmoves.Cmoves_Axia     To nPoso
57949>>>    
57949>>>                Move 0 To iOneCflag
57950>>>                Move 0 To iMustSaveCmoves
57951>>>                Move 0 To iMustSaveClient
57952>>>                Move 0 To iMustSaveClientYpoloipa
57953>>>                Move 0 To iAnameneiSxetiko
57954>>>                Move 0 To imustsaveofeilh
57955>>>                Move 0 To iMaxDays
57956>>>    
57956>>>                Clear Cflagkin
57957>>>                Move sCtypkinRecr           To Cflagkin.Ctypkin_Recr
57958>>>                Find gt Cflagkin by Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
57959>>>>
57959>>>                While ((Found=1) and (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
57963>>>                    Move 1 To iOneCflag
57964>>>                    Move Cflagkin.Cflagkin_Flag To sFlag
57965>>>                    Move (Trim(sFlag)) To sFlag
57966>>>    
57966>>>                    Case Begin
57966>>>                        Case (sFlag='1')
57968>>>                            Move 1 To iMustSaveCmoves
57969>>>                        Case Break
57970>>>                        Case (sFlag='2') // Antistrofh Proshmou
57973>>>                            Move (nPoso*iSign*(-1)) To nPoso
57974>>>                        Case Break
57975>>>                        Case (sFlag='3') // Epireazei xreoseis
57978>>>                            Move (nPoso*iSign)  To nXre
57979>>>                            Move 0              To nPis
57980>>>                        Case Break
57981>>>                        Case (sFlag='4') // Epireazei pistoseis
57984>>>                            Move (nPoso*iSign)  To nPis
57985>>>                            Move 0              To nXre
57986>>>                        Case Break
57987>>>                        Case (sFlag='5') // Epireazei Hmeromhnies
57990>>>                            Move 1 To iMustSaveClient
57991>>>                            If (nXre<>0) Begin
57993>>>                                Move dHmnia To dLastXre
57994>>>                                Move dHmnia To dLastXreParast
57995>>>                                Move ''     To dLastPis
57996>>>                                Move ''     To dLastPisParast
57997>>>                            End
57997>>>>
57997>>>                            Else If (nPis<>0) Begin
58000>>>                                Move dHmnia To dLastPis
58001>>>                                Move dHmnia To dLastPisParast
58002>>>                                Move ''     To dLastXre
58003>>>                                Move ''     To dLastXreParast
58004>>>                            End
58004>>>>
58004>>>                        Case Break
58005>>>                        Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
58008>>>                        Case Break
58009>>>                        Case (sFlag='7') // Epireazei ekkremh axiografa
58012>>>                        Case Break
58013>>>                        Case (sFlag='8') // Epireazei Diamartyrhmena
58016>>>                        Case Break
58017>>>                        Case (sFlag='9') // Epireazei Tziro
58020>>>                        Case Break
58021>>>                        Case (sFlag='10') // Epireazei Apografh xreoshs
58024>>>                        Case Break
58025>>>                        Case (sFlag='11') // Epireazei Apografh Pistosh
58028>>>                        Case Break
58029>>>                        Case (sFlag='12') // Symmetoxh se MYF (Plythos)
58032>>>                            Move iSign To iMyf
58033>>>                        Case Break
58034>>>                        Case (sFlag='13') // Symmetoxh se MYF (Axia)
58037>>>                            Move (nPoso*iSign)  To nMyf
58038>>>                        Case Break
58039>>>                        Case (sFlag='14') // Axies se Xeno sma
58042>>>                            // Blepe sxetika erothmata sthn arxh ths procedure
58042>>>                        Case Break
58043>>>                        Case (sFlag='15') // Aytomath dhmiourgia axiografou
58046>>>                        Case Break
58047>>>                        Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
58050>>>                            If (nXre<>0) Begin
58052>>>                                Move (nXre*(-1))    To nPis
58053>>>                                Move 0              To nXre
58054>>>                            End
58054>>>>
58054>>>                            Else If (nPis<>0) Begin
58057>>>                                Move (nPis*(-1))    To nXre
58058>>>                                Move 0              To nPis
58059>>>                            End
58059>>>>
58059>>>                        Case Break
58060>>>                        Case (sFlag='17') // Afairei apo Myf (akyrotika)
58063>>>                            // Thelei exhghsh ti shmainei 'afairei' ?
58063>>>                            // apo posothta? apo axia? apo allou?
58063>>>                        Case Break
58064>>>                        Case (sFlag='23') // Athroisths 1
58067>>>                            Move (nPoso*iSign) To nAthr1
58068>>>                        Case Break
58069>>>                        Case (sFlag='24') // Athroisths 2
58072>>>                            Move (nPoso*iSign) To nAthr2
58073>>>                        Case Break
58074>>>                        Case (sFlag='25') // Athroisths 3
58077>>>                            Move (nPoso*iSign) To nAthr3
58078>>>                        Case Break
58079>>>                        Case (sFlag='26') // Athroisths 4
58082>>>                            Move (nPoso*iSign) To nAthr4
58083>>>                        Case Break
58084>>>                        Case (sFlag='27') // Athroisths 5
58087>>>                            Move (nPoso*iSign) To nAthr5
58088>>>                        Case Break
58089>>>                        Case (sFlag='28') // Athroisths 6
58092>>>                            Move (nPoso*iSign) To nAthr6
58093>>>                        Case Break
58094>>>                        Case (sFlag='29') // Athroisths 7
58097>>>                            Move (nPoso*iSign) To nAthr7
58098>>>                        Case Break
58099>>>                        Case (sFlag='30') // Athroisths 8
58102>>>                            Move (nPoso*iSign) To nAthr8
58103>>>                        Case Break
58104>>>                        Case (sFlag='50') // Anamenei sxetika
58107>>>                            Move 1 To iAnameneiSxetiko
58108>>>                            Move Ctypkin.Max_Days_Sx_Par To iMaxDays
58109>>>                        Case Break
58110>>>                        Case (sFlag='66') // ephreazei synolikh ofeilh
58113>>>                            Move 1 To iMustSaveofeilh
58114>>>                        Case Break
58115>>>                        Case (sFlag='99') // Enhmeronei Ypoloipa
58118>>>                            Move 1 To iMustSaveClientYpoloipa
58119>>>                        Case Break
58120>>>    
58120>>>                    Case End
58120>>>    
58120>>>                    Find gt Cflagkin by Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
58121>>>>
58121>>>                Loop
58122>>>>
58122>>>    
58122>>>                If ((iOneCflag) and (iMustSaveCmoves)) Begin
58124>>>                    If (nXre<>0) Begin
58126>>>                        Move nXre To Cmoves.Cmoves_Axia
58127>>>                        If (aiSign=1) Begin
58129>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  To Cmoves.Cmoves_x0
58130>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) To Cmoves.Cmoves_x00
58131>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  To Cmoves.Cmoves_x1
58132>>>                            Add nXre To Cmoves.Cmoves_x2
58133>>>                        End
58133>>>>
58133>>>                        Else Begin
58134>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_x0
58135>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_x00
58136>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_x1
58137>>>                            Sub nXre From Cmoves.Cmoves_x2
58138>>>                        End
58138>>>>
58138>>>                    End
58138>>>>
58138>>>                    Else If (nPis<>0) Begin
58141>>>                        Move nPis To Cmoves.Cmoves_Axia
58142>>>                        If (aiSign=1) Begin
58144>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  To Cmoves.Cmoves_p0
58145>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) To Cmoves.Cmoves_p00
58146>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  To Cmoves.Cmoves_p1
58147>>>                            Add nPis To Cmoves.Cmoves_p2
58148>>>                        End
58148>>>>
58148>>>                        Else Begin
58149>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_p0
58150>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_p00
58151>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_p1
58152>>>                            Sub nPis From Cmoves.Cmoves_p2
58153>>>                        End
58153>>>>
58153>>>                    End
58153>>>>
58153>>>                    Move (Trim(sModule)) To Cmoves.Module_From
58154>>>                    If (Trim(sClientRecr)<>'') Begin
58156>>>                        If (iMustSaveClientYpoloipa =1)  Move '1' To Cmoves.Enhm_Ypol_Pel
58159>>>                        If (iMustSaveClient         =1)  Move '1' To Cmoves.Enhm_Hmnies_Pel
58162>>>                        If (iMustSaveofeilh         =1)  Move '1' To Cmoves.Enhm_ofeilh
58165>>>                    End
58165>>>>
58165>>>                    Else Begin
58166>>>                             If (smodule='01') Send stop_box '-åí ??åôå åðéë?îåé ?åëáôç'       ("error 1015 vwcmoves  "+'?ëçñï?ïñ-á')
58169>>>                        Else If (smodule='02') Send stop_box '-åí ??åôå åðéë?îåé ?ñïìçèåõô?'  ("error 1016 vwcmoves  "+'?ëçñï?ïñ-á')
58173>>>                        Procedure_Return
58174>>>                    End
58174>>>>
58174>>>                End
58174>>>>
58174>>>            End
58174>>>>
58174>>>        End_Procedure
58175>>>    End_Object    // Cmoves_DD
58176>>>    
58176>>>    Object Btnordh_DD is a Btnordh_DataDictionary
58178>>>        Set DDO_Server To (Cn_DD(Self))
58179>>>        Set Constrain_File To Cn.File_Number
58180>>>        Send DefineAllExtendedFields
58181>>>    End_Object    // Btnordh_DD
58182>>>    
58182>>>    Object Btnordd_DD is a Btnordd_DataDictionary
58184>>>        Set DDO_Server To (Btnordh_DD(Self))
58185>>>        Set Constrain_File To Btnordh.File_Number
58186>>>    End_Object    // Btnordd_DD
58187>>>    
58187>>>    //////////////////////////////////////////////////////
58187>>>    // DataDictionary Structure needed for making Barticle
58187>>>    //////////////////////////////////////////////////////
58187>>>    
58187>>>    
58187>>>    //AB-StoreTopEnd
58187>>>
58187>>>    Set Label to "ƒž£ ¦¬¨šå˜ „šš¨˜­é¤ •¨œà©žª -  ©«à©žª 2 “§¦¢¦ §˜ §œ¢˜«à¤ Œ„Ž 24-11-2008 Ermhs (Yannis Parasxos)"
58188>>>    Set Size to 119 489
58189>>>    Set Location to 9 7
58190>>>
58190>>>    //AB-DDOStart
58190>>>
58190>>>
58190>>>    //AB-DDOEnd
58190>>>
58190>>>    Object frmFileName is a FormSub
58192>>>        Set Size to 13 321
58193>>>        Set Location to 6 63
58194>>>        Set Color to clBtnFace
58195>>>        Set Label_Col_Offset to 2
58196>>>        Set Label_Justification_Mode to jMode_Right
58197>>>        Set Prompt_Button_Mode to pb_PromptOn
58198>>>        Set Enabled_State to FALSE
58199>>>        Set Form_FontWeight Item 0 to 600
58200>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58201>>>        Set Item_Shadow_State Item 0 to TRUE
58202>>>        Set Shadow_State Item 0 to TRUE
58203>>>        Set Value Item 0 to "C:\YPOLOIPA_PELATON_NEO_23_11_2008.txt"
58204>>>
58204>>>        //AB-StoreStart
58204>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
58204>>>        Procedure Prompt
58206>>>            String  sFileName
58207>>>            Integer bOpen
58207>>>            Get Show_Dialog Of oOpenFile To bOpen
58208>>>            If bOpen Begin
58210>>>                Get File_Name Of oOpenFile To sFileName
58211>>>                If (Trim(sFileName)<>'') Set Value Item 0 To sFileName
58214>>>            End
58214>>>>
58214>>>        End_Procedure
58215>>>        
58215>>>        
58215>>>        //AB-StoreEnd
58215>>>
58215>>>    End_Object    // frmFileName
58216>>>
58216>>>    Object Frmdate is a FormSub
58218>>>        Set Size to 13 69
58219>>>        Set Location to 49 71
58220>>>        Set Color to clBtnFace
58221>>>        Set Label_Col_Offset to 2
58222>>>        Set Form_Datatype Item 0 to Mask_Date_Window
58223>>>        Set Enabled_State to FALSE
58224>>>        Set Form_FontWeight Item 0 to 600
58225>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
58226>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58227>>>        Set Item_Shadow_State Item 0 to TRUE
58228>>>        Set Shadow_State Item 0 to TRUE
58229>>>        Set Value Item 0 to "24/11/2008"
58230>>>    End_Object    // Frmdate
58231>>>
58231>>>    Object ButtonSub1 is a ButtonSub
58233>>>
58233>>>        //AB-StoreTopStart
58233>>>        
58233>>>        //AB-StoreTopEnd
58233>>>
58233>>>        Set Label to "„§œ¥œ¨š˜©å˜"
58234>>>        Set Size to 14 218
58235>>>        Set Location to 73 112
58236>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58237>>>
58237>>>        //AB-StoreStart
58237>>>        
58237>>>        Procedure OnClick
58239>>>            String  sFile sFile2 sLabel sBr
58240>>>            Integer iFileExists iCheckAfm
58240>>>            Date ddate
58240>>>            Get label To slabel
58241>>>        
58241>>>            If (syscurxr.branch_code<>'84') Begin
58243>>>                Send Stop_Box '„„ˆ Œ€ ’„„ˆ ‘’Ž “Ž‰€’€‘’†‹€ 84 - TRANS ƒŽ‹ˆ‰† “Ž‰ 2 ˆ. „.' '‘­á¢£˜ 7001'
58244>>>                Procedure_Return
58245>>>            End
58245>>>>
58245>>>        
58245>>>        
58245>>>            Set Enabled_State To False
58246>>>        
58246>>>            move syscurxr.branch_code To sBr
58247>>>            Get value Of frmdate   Item 0 To ddate
58248>>>            Move (Trim(sBr)) To sBr
58249>>>            If (ddate='') Begin
58251>>>                Send info_box 'ƒœ¤ ›é©˜«œ †£/¤å˜ £œ«˜­¦¨áª “§¦¢¦å§à¤'
58252>>>                Set Enabled_State To True
58253>>>                Procedure_Return
58254>>>            End
58254>>>>
58254>>>            // Mhdenismos tou ASCII kathe fora pou trexei
58254>>>            Direct_Output Channel 9 'C:\Domikh_Kinhseis_Error2.txt'
58256>>>            Close_Output Channel 9
58258>>>            //
58258>>>        
58258>>>            Get Value Of frmFileName Item 0 To sFile
58259>>>            Move (Trim(Uppercase(sFile)))   To sFile
58260>>>            If (sFile<>'') Begin
58262>>>                Get Get_File_Exists sFile   To iFileExists
58263>>>                If (not(iFileExists)) Begin
58265>>>                    Send Stop_Box "ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦." "‘­á¢£˜ 1001"
58266>>>                    Set Enabled_State To True
58267>>>                    Procedure_Return
58268>>>                End
58268>>>>
58268>>>                     If (sBr<>'') Send Read_Kinhseis         sFile sBr
58271>>>                     Else Begin
58272>>>                        Send Info_Box 'ƒœ¤ §¢ž¡«¨¦¢¦šã©˜«œ ¬§¦¡˜«á©«ž£˜' '¢ž¨¦­¦¨å˜'
58273>>>                        Set Enabled_State To True
58274>>>                        Procedure_Return
58275>>>                    End
58275>>>>
58275>>>        
58275>>>        
58275>>>                Send Info_Box "† ƒ ˜› ¡˜©å˜ «œ¢œåà©œ" "¢ž¨¦­¦¨å˜"
58276>>>            End
58276>>>>
58276>>>            Else Send Stop_Box 'ƒœ¤ §¨¦©› ¦¨å©˜«œ §¦¬ ™¨å©¡œ«œ «¦ ˜¨®œå¦' '‘­á¢£˜ 1002'
58278>>>        
58278>>>        
58278>>>            Set Label Of ButtonSub1 To sLabel
58279>>>            Set Enabled_State To True
58280>>>        End_Procedure // OnClick
58281>>>        
58281>>>        
58281>>>        Procedure Read_Kinhseis String asFile String asBr
58283>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
58283>>>            String  sCode    sClientID sRecr   sError skeno
58284>>>            Integer iLathos iBtypkin  iInt1   iBaxioKat iCmvRec
58284>>>            Integer iError_Object_ID  iRecnum iErr rVal
58284>>>            Local String  sKinhsh sArPar sEidAxio sUnused sHmnia sKodPel sKodErg sCN s1
58284>>>            Integer iKodMon iXondr iKodKin1 iKodKin2 iCtypkin iExit77
58284>>>            Local String  sepon spol
58284>>>            Number  nxre npis nposo
58284>>>            Date    dHmParast dHmAxio
58284>>>            Get value Of Frmdate Item 0 To dhmparast
58285>>>            /////////////////////////
58285>>>        
58285>>>            Move 0 To iInt1
58286>>>            //Move '‹œ«˜­.“§¦¢¦å§à¤ ' To sArPar
58286>>>           // Append sarpar dhmparast
58286>>>            Append_Output Channel 9 'C:\domikh_Kinhseis_Error2.txt'
58288>>>        
58288>>>            Set piLathos To 0
58289>>>        
58289>>>            Move '01' To gs_Module_Code
58290>>>        
58290>>>            Begin_Transaction
58291>>>                Move Error_Object_ID To iError_Object_ID
58292>>>        
58292>>>                Direct_Input Channel 1 asFile
58294>>>                Readln Channel 1 scode s1 nxre npis
58299>>>                While (not(Seqeof))
58303>>>                    Add 1 To iInt1
58304>>>                    Set Label Of ButtonSub1 To (String(iInt1))
58305>>>        
58305>>>                    move ''     to sclientid
58306>>>                    Move 0      to iExit77
58307>>>        
58307>>>                    Send Clear          To Ctypkin_DD
58308>>>                    Send Clear          To Clients_DD
58309>>>                    Send Clear          To Cmoves_DD
58310>>>                    Move (Trim(scode))  To scode
58311>>>        
58311>>>                    Clear clients
58312>>>                    Move ''         To sClientID
58313>>>                    Move scode      To clients.client_codem
58314>>>                    find ge clients.recnum
58315>>>>
58315>>>                    while ((found) And (iExit77=0))
58319>>>                        if (scode=clients.client_codem)  begin
58321>>>                            Move clients.client_id  to sclientid
58322>>>                            Move 1                  to iExit77
58323>>>                        end
58323>>>>
58323>>>                        find gt clients.recnum
58324>>>>
58324>>>                    loop
58325>>>>
58325>>>        
58325>>>        //            String sMesss
58325>>>        //            Integer iYes
58325>>>        //            Move "" to sMesss
58325>>>        //            Move (Trim(sCode)+ "   " +Trim(sClientID)) to sMesss
58325>>>        //            Get YesNo_Box sMesss to iYes
58325>>>        //            If (iYes=MBR_NO) Begin
58325>>>        //                Error 7777 'Procedure Aborted'
58325>>>        //                Unlock
58325>>>        //                Abort_Transaction
58325>>>        //                Procedure_Return
58325>>>        //            End
58325>>>        
58325>>>        
58325>>>                    If (sclientid="") Begin
58327>>>                        Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found codem= ' (Trim(scode)) '  Xre=' nXre '  Pis=' nPis
58337>>>                        Abort_Transaction
58338>>>                        Goto Diavase_Epomeno_pelath_Gefyras33
58339>>>>
58339>>>                    End
58339>>>>
58339>>>        
58339>>>        
58339>>>                    //----------------------------------------------------------------//
58339>>>                    //-----------------   XREOSEIS  ----------------------------------//
58339>>>                    //----------------------------------------------------------------//
58339>>>                    If (nXre<>0) Begin
58341>>>        
58341>>>                        Send Clear To Cmoves_DD
58342>>>        
58342>>>                        Move 103    to ictypkin
58343>>>                        //Move nXre   to nPoso
58343>>>        
58343>>>                        Move sClientID  to Clients.Client_Id
58344>>>                        Send Find To Clients_DD eq 6 // Client_ID
58345>>>                        If (not(Found)) Begin
58347>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found CLientID= ' (Trim(sClientID)) '  Xre=' nXre '  Pis=' nPis
58357>>>                            Abort_Transaction
58358>>>                            Goto Diavase_Epomeno_pelath_Gefyras33
58359>>>>
58359>>>                        End
58359>>>>
58359>>>        
58359>>>                        Move iCtypkin               To Ctypkin.Ctypkin_Code
58360>>>                        Send Find To Ctypkin_DD eq 1
58361>>>                        If (not(Found)) Begin
58363>>>                            ERROR 7003 'CANNOT FIND CTYPKIN'
58364>>>>
58364>>>                            Abort_Transaction
58365>>>                            Goto Diavase_Epomeno_pelath_Gefyras33
58366>>>>
58366>>>                        End
58366>>>>
58366>>>        
58366>>>                        clear cn
58367>>>                        move sclientid to cn.client_id
58368>>>                        find ge cn by index.4
58369>>>>
58369>>>                        if ((found) and (cn.client_id = sclientid)) begin
58371>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code       To cn.cn_code
58372>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr       To cn.cn_recr
58373>>>                        end
58373>>>>
58373>>>                        else begin
58374>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code       To '01.Z2.00000'
58375>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr       To '81.9572'
58376>>>                        end
58376>>>>
58376>>>        
58376>>>                        Move '*•-‘†‹*'                                                     To sArPar
58377>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Hmnia      To dHmParast
58378>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_M_Code     To '01'
58379>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Module_From       To '01'
58380>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_axia       To nXre
58381>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_par        To (Trim(sArPar))
58382>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_sc_code2   To 'EUR'
58383>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.enhm_ofeilh       To '1'
58384>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel     To '1'
58385>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel   To '1'
58386>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_A_Code     To '4'
58387>>>                        Send Request_Save To Cmoves_DD
58388>>>        
58388>>>                        Showln (Trim(sCode)) " - " (Trim(sClientID)) "   XREOSH  "  "     Xre = " nXre "     Pis = " nPis
58397>>>        
58397>>>                        Get Field_Current_Value Of Cmoves_DD Field Cmoves.Recnum To iCmvRec
58398>>>                        If (iCmvRec) Begin
58400>>>                        End
58400>>>>
58400>>>                        Else Begin
58401>>>                            Error 8501 'Cmoves reposition impossible'
58402>>>>
58402>>>                            Abort_Transaction
58403>>>                        End
58403>>>>
58403>>>                    End
58403>>>>
58403>>>        
58403>>>        
58403>>>                    //----------------------------------------------------------------//
58403>>>                    //-----------------   PISTOSEIS  ---------------------------------//
58403>>>                    //----------------------------------------------------------------//
58403>>>                    If (nPis<>0) Begin
58405>>>        
58405>>>                        Send Clear          To Ctypkin_DD
58406>>>                        Send Clear          To Clients_DD
58407>>>                        Send Clear          To Cmoves_DD
58408>>>        
58408>>>                        Move (Trim(scode))  To scode
58409>>>        
58409>>>                        Move 104 To ictypkin
58410>>>                        //Move nPis to nPoso
58410>>>        
58410>>>                        Move sClientID                  To Clients.Client_Id
58411>>>                        Send Find To Clients_DD eq 6 // Client_ID
58412>>>                        If (not(Found)) Begin
58414>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found ClientID= ' (Trim(sClientID)) '  Xre=' nXre '  Pis=' nPis
58424>>>                            Abort_Transaction
58425>>>                            Goto Diavase_Epomeno_pelath_Gefyras33
58426>>>>
58426>>>                        End
58426>>>>
58426>>>        
58426>>>                        Move iCtypkin To Ctypkin.Ctypkin_Code
58427>>>                        Send Find To Ctypkin_DD eq 1
58428>>>                        If (not(Found)) Begin
58430>>>                            Error 7003 'CTYPKIN NOT FOUND'
58431>>>>
58431>>>                            Abort_Transaction
58432>>>                        End
58432>>>>
58432>>>        
58432>>>                        clear cn
58433>>>                        move sclientid to cn.client_id
58434>>>                        find ge cn by index.4
58435>>>>
58435>>>                        if ((found) and (cn.client_id = sclientid)) begin
58437>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code       To cn.cn_code
58438>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr       To cn.cn_recr
58439>>>                        end
58439>>>>
58439>>>                        else begin
58440>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code       To '01.Z2.00000'
58441>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr       To '81.9572'
58442>>>                        end
58442>>>>
58442>>>        
58442>>>                        Move '*‘-‘†‹*' To sArPar
58443>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Hmnia      To dHmParast
58444>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_M_Code     To '01'
58445>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Module_From       To '01'
58446>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_axia       To nPis
58447>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_par        To (Trim(sArPar))
58448>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_sc_code2   To 'EUR'
58449>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.enhm_ofeilh       To '1'
58450>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel     To '1'
58451>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel   To '1'
58452>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_A_Code     To '4'
58453>>>                        Send Request_Save To Cmoves_DD
58454>>>        
58454>>>                        Showln (Trim(sCode)) " - " (Trim(sClientID)) "   PISTOSH  "  "     Xre = " nXre "     Pis = " nPis
58463>>>        
58463>>>                        Get Field_Current_Value Of Cmoves_DD Field Cmoves.Recnum To iCmvRec
58464>>>                        If (iCmvRec) Begin
58466>>>                        End
58466>>>>
58466>>>                        Else Begin
58467>>>                            Error 8501 'Cmoves reposition impossible'
58468>>>>
58468>>>                            Abort_Transaction
58469>>>                            Goto Diavase_Epomeno_pelath_Gefyras33
58470>>>>
58470>>>                        End
58470>>>>
58470>>>                    End
58470>>>>
58470>>>        
58470>>>                    Diavase_Epomeno_pelath_Gefyras33:
58470>>>        
58470>>>                    Readln Channel 1 scode s1 nxre npis
58475>>>                Loop
58476>>>>
58476>>>        
58476>>>        
58476>>>            End_Transaction
58477>>>            Unlock
58478>>>>
58478>>>        
58478>>>            Move (Err) To iErr
58479>>>            If (iErr) Begin
58481>>>                Get Error_Text iErr To sError
58482>>>                Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    ¨¦™¢ž£˜ ˜§¦ « ª ¡¢á©œ ª= ' (String(iErr)) '     ' (Trim(sError))
58490>>>                Unlock
58491>>>>
58491>>>                Close_Output Channel 9
58493>>>                Procedure_Return
58494>>>            End
58494>>>>
58494>>>        
58494>>>        
58494>>>            Set Label Of ButtonSub1 To ''
58495>>>        
58495>>>                 If (piLathos(Self)=70000) Send Stop_Box 'Btypkin Not found'  ('# '+(String(iInt1)))
58498>>>            Else If (piLathos(Self)=70001) Send Stop_Box 'Client Not found'   ('# '+(String(iInt1)))
58502>>>            Else If (piLathos(Self)=70002) Send Stop_Box 'Baxiokat Not found' ('# '+(String(iInt1)))
58506>>>        
58506>>>        
58506>>>            Close_Output Channel 9
58508>>>        
58508>>>        
58508>>>        End_Procedure // Read_Kinhseis
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        
58509>>>        //AB-StoreEnd
58509>>>
58509>>>    End_Object    // ButtonSub1
58510>>>
58510>>>    Object TextBoxSub1 is a TextBoxSub
58512>>>        Set Label to "„§ ¢¦šã ˜¨®œå¦¬"
58513>>>        Set Location to 7 5
58514>>>        Set Size to 10 55
58515>>>        Set TypeFace to "MS Sans Serif"
58516>>>    End_Object    // TextBoxSub1
58517>>>
58517>>>    Object oOpenFile is a OpenDialog
58519>>>        Set Location to 2 407
58520>>>        Set Dialog_Caption to "Select a file"
58521>>>
58521>>>        //AB-StoreStart
58521>>>        Set Filter_String   To 'Text Files|*.txt|All Files|*.*'
58522>>>        Set Initial_Folder  To 'C:\VDF6\Develop\Empor'
58523>>>        Set Filter_Index    To 1
58524>>>        
58524>>>        //AB-StoreEnd
58524>>>
58524>>>    End_Object    // oOpenFile
58525>>>
58525>>>    Object TextBoxSub3 is a TextBoxSub
58527>>>        Set Label to "„§ ¢¦šã †£/¤å˜ª"
58528>>>        Set Location to 49 5
58529>>>        Set Size to 12 64
58530>>>        Set TypeFace to "MS Sans Serif"
58531>>>    End_Object    // TextBoxSub3
58532>>>
58532>>>
58532>>>    //AB-StoreStart
58532>>>                                                                        
58532>>>    Procedure Activate_View Returns Integer
58534>>>        String sStr sModule StrDisp
58535>>>        Integer rVal iint icheck
58535>>>        string scompany
58535>>>        set value of (frmdate(self)) to '24/11/2008'
58536>>>    
58536>>>        Forward Get Msg_Activate_View to rVal
58538>>>        Procedure_Return rVal
58539>>>    End_Procedure
58540>>>    
58540>>>    
58540>>>    
58540>>>    
58540>>>    
58540>>>    
58540>>>    //AB-StoreEnd
58540>>>
58540>>>End_Object    // gefyres2
58541>>>
58541>>>
58541>>>//AB-StoreStart
58541>>>                                    
58541>>>                                    
58541>>>                                    
58541>>>                                    
58541>>>//AB-StoreEnd
58541>>>
58541>>>//AB/ End_Object    // prj
58541>        Use gefyres3.vw                                                                     
INCLUDING FILE: GEFYRES3.VW
58541>>>//AB/ Project gefyresdom:domikh3
58541>>>//AB/ Object prj is a View_Project
58541>>>//AB/     Set ProjectName to "gefyresdom:domikh3"
58541>>>//AB/     Set ProjectFileName to "gefyres3.vw"
58541>>>
58541>>>// Project Object Structure
58541>>>//   Gefyres3 is a dbViewSub
58541>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
58541>>>//     Country_DD is a Country_DataDictionary
58541>>>//     Towns_DD is a Towns_DataDictionary
58541>>>//     Cities_DD is a Cities_DataDictionary
58541>>>//     Payresp_DD is a Payresp_DataDictionary
58541>>>//     Constrct_DD is a Constrct_DataDictionary
58541>>>//     Salesmen_DD is a Salesmen_DataDictionary
58541>>>//     Mhxanik_DD is a Mhxanik_DataDictionary
58541>>>//     Areas_DD is a Areas_DataDictionary
58541>>>//     Btypkin_DD is a Btypkin_DataDictionary
58541>>>//     Baxiokat_DD is a Baxiokat_DataDictionary
58541>>>//     Barticl_DD is a Barticl_DataDictionary
58541>>>//     Bsum_DD is a Bsum_DataDictionary
58541>>>//     Baxio_DD is a Baxio_DataDictionary
58541>>>//     Syscurxr_DD is a Syscurxr_DataDictionary
58541>>>//     Sysrecc_DD is a Sysrecc_DataDictionary
58541>>>//     Clients_DD is a Clients_DataDictionary
58541>>>//     Cn_DD is a Cn_DataDictionary
58541>>>//     Tperga_DD is a Tperga_DataDictionary
58541>>>//     Bmove_DD is a Bmove_DataDictionary
58541>>>//     Cmoves_DD is a Cmoves_DataDictionary
58541>>>//     Btnordh_DD is a Btnordh_DataDictionary
58541>>>//     Btnordd_DD is a Btnordd_DataDictionary
58541>>>//     frmFileName is a FormSub
58541>>>//     Frmdate is a FormSub
58541>>>//     ButtonSub1 is a ButtonSub
58541>>>//     TextBoxSub1 is a TextBoxSub
58541>>>//     oOpenFile is a OpenDialog
58541>>>//     TextBoxSub3 is a TextBoxSub
58541>>>
58541>>>// Register all objects
58541>>>Register_Object Areas_DD
58541>>>Register_Object Barticl_DD
58541>>>Register_Object Baxio_DD
58541>>>Register_Object Baxiokat_DD
58541>>>Register_Object Bmove_DD
58541>>>Register_Object Bsum_DD
58541>>>Register_Object Btnordd_DD
58541>>>Register_Object Btnordh_DD
58541>>>Register_Object Btypkin_DD
58541>>>Register_Object ButtonSub1
58541>>>Register_Object Cities_DD
58541>>>Register_Object Clients_DD
58541>>>Register_Object Cmoves_DD
58541>>>Register_Object Cn_DD
58541>>>Register_Object Constrct_DD
58541>>>Register_Object Country_DD
58541>>>Register_Object Ctypkin_DD
58541>>>Register_Object Frmdate
58541>>>Register_Object frmFileName
58541>>>Register_Object Gefyres3
58541>>>Register_Object Mhxanik_DD
58541>>>Register_Object oOpenFile
58541>>>Register_Object Payresp_DD
58541>>>Register_Object Salesmen_DD
58541>>>Register_Object Syscurxr_DD
58541>>>Register_Object Sysrecc_DD
58541>>>Register_Object TextBoxSub1
58541>>>Register_Object TextBoxSub3
58541>>>Register_Object Towns_DD
58541>>>Register_Object Tperga_DD
58541>>>
58541>>>
58541>>>//AB/ AppBuild VIEW
58541>>>
58541>>>
58541>>>//AB-StoreTopStart
58541>>>                            
58541>>>Use sl041.sl
58541>>>
58541>>>Use bpEnCmv3.dg // Business Process Finilizing Barticle
58541>>>
58541>>>Use slNomism.sl
58541>>>Use sl033.sl
58541>>>Use r044.rv
58541>>>Use v037.vw
58541>>>Use sl100.sl
58541>>>Use sl036.sl
58541>>>Use r36.rv
58541>>>Use baxio.dd
58541>>>Use Tperga.dd
58541>>>Use BtnOrdH.DD
58541>>>Use BtnOrdD.DD
58541>>>Use Mhxanik.DD
58541>>>Use Constrct.dd
58541>>>Use Salesmen.dd
58541>>>Use sysrecc.dd
58541>>>
58541>>>//Use bp2ndCop.dg
58541>>>//Use bpACopen.dg
58541>>>
58541>>>
58541>>>//AB-StoreTopEnd
58541>>>
58541>>>//AB-IgnoreStart
58541>>>
58541>>>Use dbView.Sub
58541>>>Use Form.Sub
58541>>>Use Button.Sub
58541>>>Use Txtbox.Sub
58541>>>Use DFAllEnt.pkg
58541>>>
58541>>>//AB-IgnoreEnd
58541>>>
58541>>>ACTIVATE_VIEW Activate_Gefyres3 FOR Gefyres3
58545>>>
58545>>>Object Gefyres3 is a dbViewSub
58547>>>
58547>>>    //AB-StoreTopStart
58547>>>                                                                            
58547>>>    Property Integer piLathos   Public   0
58549>>>    Property String  psModule   Public '01'
58551>>>    Property Integer piWhat     Public   0
58553>>>    
58553>>>    //Open Sysrecc
58553>>>    Open SysCurXR
58555>>>    Open Year
58557>>>    
58557>>>    
58557>>>    //////////////////////////////////////////////////////
58557>>>    // DataDictionary Structure needed for making Barticle
58557>>>    //////////////////////////////////////////////////////
58557>>>    
58557>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
58559>>>    End_Object    // Ctypkin_DD
58560>>>    
58560>>>    Object Country_DD is a Country_DataDictionary
58562>>>    End_Object    // Country_DD
58563>>>    
58563>>>    Object Towns_DD is a Towns_DataDictionary
58565>>>        Set DDO_Server To (Country_DD(Self))
58566>>>    End_Object    // Towns_DD
58567>>>    
58567>>>    Object Cities_DD is a Cities_DataDictionary
58569>>>        Set DDO_Server To (Towns_DD(Self))
58570>>>    End_Object    // Cities_DD
58571>>>    
58571>>>    Object Payresp_DD is a Payresp_DataDictionary
58573>>>    End_Object    // Payresp_DD
58574>>>    
58574>>>    Object Constrct_DD is a Constrct_DataDictionary
58576>>>    End_Object    // Constrct_DD
58577>>>    
58577>>>    Object Salesmen_DD is a Salesmen_DataDictionary
58579>>>    End_Object    // Salesmen_DD
58580>>>    
58580>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
58582>>>    End_Object    // Mhxanik_DD
58583>>>    
58583>>>    Object Areas_DD is a Areas_DataDictionary
58585>>>    End_Object    // Areas_DD
58586>>>    
58586>>>    Object Btypkin_DD is a Btypkin_DataDictionary
58588>>>        Set Foreign_Field_Options DD_KEYFIELD           To DD_Clear_Field_Options DD_FindReq
58589>>>        Set Foreign_Field_Options DD_INDEXFIELD         To DD_Clear_Field_Options DD_FindReq
58590>>>        Set Field_Options Field Btypkin.Btypkin_Code    To DD_Clear_Field_Options DD_Required
58591>>>    End_Object    // Btypkin_DD
58592>>>    
58592>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
58594>>>    End_Object    // Baxiokat_DD
58595>>>    
58595>>>    Object Barticl_DD is a Barticl_DataDictionary
58597>>>        Set DDO_Server To (Btypkin_DD(Self))
58598>>>    End_Object    // Barticl_DD
58599>>>    
58599>>>    Object Bsum_DD is a Bsum_DataDictionary
58601>>>        Set DDO_Server To (Barticl_DD(Self))
58602>>>        Set Constrain_File To Barticl.File_Number
58603>>>    End_Object    // Bsum_DD
58604>>>    
58604>>>    Object Baxio_DD is a Baxio_DataDictionary
58606>>>        Set DDO_Server To (Baxiokat_DD(Self))
58607>>>        Set allow_foreign_new_save_state To True
58608>>>    End_Object    // Baxio_DD
58609>>>    
58609>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
58611>>>    End_Object    // Syscurxr_DD
58612>>>    
58612>>>    Object Sysrecc_DD is a Sysrecc_DataDictionary
58614>>>    End_Object    // Sysrecc
58615>>>    
58615>>>    Object Clients_DD is a Clients_DataDictionary
58617>>>        Set DDO_Server To (Cities_DD(Self))
58618>>>        Set DDO_Server To (Payresp_DD(Self))
58619>>>        Set DDO_Server To (Areas_DD(Self))
58620>>>    End_Object    // Clients_DD
58621>>>    
58621>>>    Object Cn_DD is a Cn_DataDictionary
58623>>>        Set DDO_Server To (Clients_DD(Self))
58624>>>        Set DDO_Server To (Constrct_DD(Self))
58625>>>        Set DDO_Server To (Salesmen_DD(Self))
58626>>>        Set DDO_Server To (Mhxanik_DD(Self))
58627>>>    End_Object    // Cn_DD
58628>>>    
58628>>>    Object Tperga_DD is a Tperga_DataDictionary
58630>>>        Set DDO_Server To (CN_DD(Self))
58631>>>        Set DDO_Server To (Baxiokat_DD(Self))
58632>>>        Set Constrain_File To CN.File_Number
58633>>>    End_Object    // Btnordd_DD
58634>>>    
58634>>>    Object Bmove_DD is a Bmove_DataDictionary
58636>>>        Set DDO_Server To (Barticl_DD(Self))
58637>>>        Set DDO_Server To (Baxio_DD(Self))
58638>>>        Set Constrain_File To Barticl.File_Number
58639>>>    End_Object    // Bmove_DD
58640>>>    
58640>>>    Object Cmoves_DD is a Cmoves_DataDictionary
58642>>>        Set DDO_Server To (Ctypkin_DD(Self))
58643>>>        Set DDO_Server To (Clients_DD(Self))
58644>>>        //Set Constrain_File to Clients.File_Number
58644>>>        Set piFromBP To True
58645>>>    
58645>>>    
58645>>>        Procedure Update
58647>>>            String  sNomisma
58648>>>            Date    dHmnia
58648>>>            Move Cmoves.Cmoves_Hmnia                To  dHmnia
58649>>>            If (dHmnia='') Sysdate4                     Cmoves.Cmoves_Hmnia
58652>>>            Move Cmoves.Cmoves_Sc_Code2             To  sNomisma
58653>>>            Move (Trim(sNomisma))                   To  sNomisma
58654>>>            If (sNomisma='') Move SysCurXr.C_Code0  To  Cmoves.Cmoves_Sc_Code2
58657>>>    
58657>>>            Send Compute_all_Fields 1
58658>>>    
58658>>>            Forward Send Update
58660>>>    
58660>>>            If (Ctypkin.Open_Item='1') Begin
58662>>>                If (Cmoves.Axia_Pros_Sysx=0) ;                    Move (Abs(Cmoves.Cmoves_Axia))              To Cmoves.Axia_Pros_Sysx
58665>>>                Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) To Cmoves.Axia_Ypol_Sysx
58666>>>                Move (Cmoves.Axia_Ypol_Sysx<>0)                 To Cmoves.Flag_Ypol
58667>>>    
58667>>>                If ((Cmoves.Cmoves_X0<>0) and ((Cmoves.Cmoves_P0=0))) Begin
58669>>>                    Move 1                          To Cmoves.Flag_Copen
58670>>>                    If (Cmoves.Cmoves_X0<0) Move 2  To Cmoves.Flag_Copen
58673>>>                End
58673>>>>
58673>>>                Else If ((Cmoves.Cmoves_P0<>0) and ((Cmoves.Cmoves_X0=0))) Begin
58676>>>                    Move 2                          To Cmoves.Flag_Copen
58677>>>                    If (Cmoves.Cmoves_P0<0) Move 1  To Cmoves.Flag_Copen
58680>>>                End
58680>>>>
58680>>>                Else Move 0 To Cmoves.Flag_Copen
58682>>>            End
58682>>>>
58682>>>        End_Procedure
58683>>>    
58683>>>        Procedure Backout
58685>>>            Forward Send Backout
58687>>>            Send Compute_all_Fields (-1)
58688>>>        End_Procedure
58689>>>    
58689>>>        Procedure Compute_all_Fields Number aiSign
58691>>>            Integer iErr isClosed iInt iWithDeletion iClient iSign
58692>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iMustSaveClientYpoloipa
58692>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag
58692>>>            Integer iMaxDays iAnameneiSxetiko iExeiSxetika iPartlTimol imustsaveofeilh
58692>>>    
58692>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort
58692>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code
58692>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr
58692>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr
58692>>>    
58692>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia
58692>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd
58692>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6
58692>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8
58692>>>    
58692>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
58692>>>            String sModule
58692>>>    
58692>>>            Move '01' To sModule
58693>>>    
58693>>>            Move 1 To iSign
58694>>>    
58694>>>            If ((Cmoves.Module_From=sModule) and (Cmoves.Barticl_Recr='') and (Cmoves.Partl_Recr=''))  Begin
58696>>>    
58696>>>                Move Ctypkin.Ctypkin_Recr   To sCtypkinRecr
58697>>>                Move clients.client_recr    To sclientrecr
58698>>>                Move Cmoves.Cmoves_sc_code2 To sNomisma
58699>>>                Move (Trim(sNomisma))       To sNomisma
58700>>>    
58700>>>                If (Trim(sCtypkinRecr)='') Begin
58702>>>                    Send stop_box '-åí ??åôå åðéë?îåé ôýðï ê-íç?ç?' ("error 1011 vwcmoves  "+'?ëçñï?ïñ-á')
58703>>>                    Procedure_Return
58704>>>                End
58704>>>>
58704>>>                Else If (Trim(sClientRecr)='') Begin
58707>>>                        If (smodule='01') Send stop_box '-åí ??åôå åðéë?îåé ?åë-ôç'      ("error 1012 vwcmoves  "+'?ëçñï?ïñ-á')
58710>>>                    Else If (smodule='02') Send stop_box '-åí ??åôå åðéë?îåé ?ñïìçèåõô?'  ("error 1013 vwcmoves  "+'?ëçñï?ïñ-á')
58714>>>                    Procedure_Return
58715>>>                End
58715>>>>
58715>>>                Else If (Trim(sNomisma)='') Begin
58718>>>                    Send stop_box '-åí ??åôå åðéë?îåé =ïìé?ìá' ("error 1014 vwcmoves  "+'?ëçñï?ïñ-á')
58719>>>                    Procedure_Return
58720>>>                End
58720>>>>
58720>>>    
58720>>>    
58720>>>                Move Cmoves.Cmoves_Hmnia    To dHmnia
58721>>>                Move Cmoves.Cmoves_Axia     To nPoso
58722>>>    
58722>>>                Move 0 To iOneCflag
58723>>>                Move 0 To iMustSaveCmoves
58724>>>                Move 0 To iMustSaveClient
58725>>>                Move 0 To iMustSaveClientYpoloipa
58726>>>                Move 0 To iAnameneiSxetiko
58727>>>                Move 0 To imustsaveofeilh
58728>>>                Move 0 To iMaxDays
58729>>>    
58729>>>                Clear Cflagkin
58730>>>                Move sCtypkinRecr           To Cflagkin.Ctypkin_Recr
58731>>>                Find gt Cflagkin by Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
58732>>>>
58732>>>                While ((Found=1) and (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
58736>>>                    Move 1 To iOneCflag
58737>>>                    Move Cflagkin.Cflagkin_Flag To sFlag
58738>>>                    Move (Trim(sFlag)) To sFlag
58739>>>    
58739>>>                    Case Begin
58739>>>                        Case (sFlag='1')
58741>>>                            Move 1 To iMustSaveCmoves
58742>>>                        Case Break
58743>>>                        Case (sFlag='2') // Antistrofh Proshmou
58746>>>                            Move (nPoso*iSign*(-1)) To nPoso
58747>>>                        Case Break
58748>>>                        Case (sFlag='3') // Epireazei xreoseis
58751>>>                            Move (nPoso*iSign)  To nXre
58752>>>                            Move 0              To nPis
58753>>>                        Case Break
58754>>>                        Case (sFlag='4') // Epireazei pistoseis
58757>>>                            Move (nPoso*iSign)  To nPis
58758>>>                            Move 0              To nXre
58759>>>                        Case Break
58760>>>                        Case (sFlag='5') // Epireazei Hmeromhnies
58763>>>                            Move 1 To iMustSaveClient
58764>>>                            If (nXre<>0) Begin
58766>>>                                Move dHmnia To dLastXre
58767>>>                                Move dHmnia To dLastXreParast
58768>>>                                Move ''     To dLastPis
58769>>>                                Move ''     To dLastPisParast
58770>>>                            End
58770>>>>
58770>>>                            Else If (nPis<>0) Begin
58773>>>                                Move dHmnia To dLastPis
58774>>>                                Move dHmnia To dLastPisParast
58775>>>                                Move ''     To dLastXre
58776>>>                                Move ''     To dLastXreParast
58777>>>                            End
58777>>>>
58777>>>                        Case Break
58778>>>                        Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
58781>>>                        Case Break
58782>>>                        Case (sFlag='7') // Epireazei ekkremh axiografa
58785>>>                        Case Break
58786>>>                        Case (sFlag='8') // Epireazei Diamartyrhmena
58789>>>                        Case Break
58790>>>                        Case (sFlag='9') // Epireazei Tziro
58793>>>                        Case Break
58794>>>                        Case (sFlag='10') // Epireazei Apografh xreoshs
58797>>>                        Case Break
58798>>>                        Case (sFlag='11') // Epireazei Apografh Pistosh
58801>>>                        Case Break
58802>>>                        Case (sFlag='12') // Symmetoxh se MYF (Plythos)
58805>>>                            Move iSign To iMyf
58806>>>                        Case Break
58807>>>                        Case (sFlag='13') // Symmetoxh se MYF (Axia)
58810>>>                            Move (nPoso*iSign)  To nMyf
58811>>>                        Case Break
58812>>>                        Case (sFlag='14') // Axies se Xeno sma
58815>>>                            // Blepe sxetika erothmata sthn arxh ths procedure
58815>>>                        Case Break
58816>>>                        Case (sFlag='15') // Aytomath dhmiourgia axiografou
58819>>>                        Case Break
58820>>>                        Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
58823>>>                            If (nXre<>0) Begin
58825>>>                                Move (nXre*(-1))    To nPis
58826>>>                                Move 0              To nXre
58827>>>                            End
58827>>>>
58827>>>                            Else If (nPis<>0) Begin
58830>>>                                Move (nPis*(-1))    To nXre
58831>>>                                Move 0              To nPis
58832>>>                            End
58832>>>>
58832>>>                        Case Break
58833>>>                        Case (sFlag='17') // Afairei apo Myf (akyrotika)
58836>>>                            // Thelei exhghsh ti shmainei 'afairei' ?
58836>>>                            // apo posothta? apo axia? apo allou?
58836>>>                        Case Break
58837>>>                        Case (sFlag='23') // Athroisths 1
58840>>>                            Move (nPoso*iSign) To nAthr1
58841>>>                        Case Break
58842>>>                        Case (sFlag='24') // Athroisths 2
58845>>>                            Move (nPoso*iSign) To nAthr2
58846>>>                        Case Break
58847>>>                        Case (sFlag='25') // Athroisths 3
58850>>>                            Move (nPoso*iSign) To nAthr3
58851>>>                        Case Break
58852>>>                        Case (sFlag='26') // Athroisths 4
58855>>>                            Move (nPoso*iSign) To nAthr4
58856>>>                        Case Break
58857>>>                        Case (sFlag='27') // Athroisths 5
58860>>>                            Move (nPoso*iSign) To nAthr5
58861>>>                        Case Break
58862>>>                        Case (sFlag='28') // Athroisths 6
58865>>>                            Move (nPoso*iSign) To nAthr6
58866>>>                        Case Break
58867>>>                        Case (sFlag='29') // Athroisths 7
58870>>>                            Move (nPoso*iSign) To nAthr7
58871>>>                        Case Break
58872>>>                        Case (sFlag='30') // Athroisths 8
58875>>>                            Move (nPoso*iSign) To nAthr8
58876>>>                        Case Break
58877>>>                        Case (sFlag='50') // Anamenei sxetika
58880>>>                            Move 1 To iAnameneiSxetiko
58881>>>                            Move Ctypkin.Max_Days_Sx_Par To iMaxDays
58882>>>                        Case Break
58883>>>                        Case (sFlag='66') // ephreazei synolikh ofeilh
58886>>>                            Move 1 To iMustSaveofeilh
58887>>>                        Case Break
58888>>>                        Case (sFlag='99') // Enhmeronei Ypoloipa
58891>>>                            Move 1 To iMustSaveClientYpoloipa
58892>>>                        Case Break
58893>>>    
58893>>>                    Case End
58893>>>    
58893>>>                    Find gt Cflagkin by Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
58894>>>>
58894>>>                Loop
58895>>>>
58895>>>    
58895>>>                If ((iOneCflag) and (iMustSaveCmoves)) Begin
58897>>>                    If (nXre<>0) Begin
58899>>>                        Move nXre To Cmoves.Cmoves_Axia
58900>>>                        If (aiSign=1) Begin
58902>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  To Cmoves.Cmoves_x0
58903>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) To Cmoves.Cmoves_x00
58904>>>                            Add (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  To Cmoves.Cmoves_x1
58905>>>                            Add nXre To Cmoves.Cmoves_x2
58906>>>                        End
58906>>>>
58906>>>                        Else Begin
58907>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_x0
58908>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_x00
58909>>>                            Sub (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_x1
58910>>>                            Sub nXre From Cmoves.Cmoves_x2
58911>>>                        End
58911>>>>
58911>>>                    End
58911>>>>
58911>>>                    Else If (nPis<>0) Begin
58914>>>                        Move nPis To Cmoves.Cmoves_Axia
58915>>>                        If (aiSign=1) Begin
58917>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  To Cmoves.Cmoves_p0
58918>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) To Cmoves.Cmoves_p00
58919>>>                            Add (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  To Cmoves.Cmoves_p1
58920>>>                            Add nPis To Cmoves.Cmoves_p2
58921>>>                        End
58921>>>>
58921>>>                        Else Begin
58922>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))  From Cmoves.Cmoves_p0
58923>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia)) From Cmoves.Cmoves_p00
58924>>>                            Sub (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Coder,dHmnia,nIsotimia))  From Cmoves.Cmoves_p1
58925>>>                            Sub nPis From Cmoves.Cmoves_p2
58926>>>                        End
58926>>>>
58926>>>                    End
58926>>>>
58926>>>                    Move (Trim(sModule)) To Cmoves.Module_From
58927>>>                    If (Trim(sClientRecr)<>'') Begin
58929>>>                        If (iMustSaveClientYpoloipa =1)  Move '1' To Cmoves.Enhm_Ypol_Pel
58932>>>                        If (iMustSaveClient         =1)  Move '1' To Cmoves.Enhm_Hmnies_Pel
58935>>>                        If (iMustSaveofeilh         =1)  Move '1' To Cmoves.Enhm_ofeilh
58938>>>                    End
58938>>>>
58938>>>                    Else Begin
58939>>>                             If (smodule='01') Send stop_box '-åí ??åôå åðéë?îåé ?åëáôç'       ("error 1015 vwcmoves  "+'?ëçñï?ïñ-á')
58942>>>                        Else If (smodule='02') Send stop_box '-åí ??åôå åðéë?îåé ?ñïìçèåõô?'  ("error 1016 vwcmoves  "+'?ëçñï?ïñ-á')
58946>>>                        Procedure_Return
58947>>>                    End
58947>>>>
58947>>>                End
58947>>>>
58947>>>            End
58947>>>>
58947>>>        End_Procedure
58948>>>    End_Object    // Cmoves_DD
58949>>>    
58949>>>    Object Btnordh_DD is a Btnordh_DataDictionary
58951>>>        Set DDO_Server To (Cn_DD(Self))
58952>>>        Set Constrain_File To Cn.File_Number
58953>>>        Send DefineAllExtendedFields
58954>>>    End_Object    // Btnordh_DD
58955>>>    
58955>>>    Object Btnordd_DD is a Btnordd_DataDictionary
58957>>>        Set DDO_Server To (Btnordh_DD(Self))
58958>>>        Set Constrain_File To Btnordh.File_Number
58959>>>    End_Object    // Btnordd_DD
58960>>>    
58960>>>    //////////////////////////////////////////////////////
58960>>>    // DataDictionary Structure needed for making Barticle
58960>>>    //////////////////////////////////////////////////////
58960>>>    
58960>>>    
58960>>>    //AB-StoreTopEnd
58960>>>
58960>>>    Set Label to "ƒž£ ¦¬¨šå˜ „šš¨˜­é¤ €§¦š¨˜­žª 2 “§¦¢¦ §˜ §œ¢˜«à¤ 31-05-2008 Ermhs (Yannis Parasxos)"
58961>>>    Set Size to 119 458
58962>>>    Set Location to 9 7
58963>>>
58963>>>    //AB-DDOStart
58963>>>
58963>>>
58963>>>    //AB-DDOEnd
58963>>>
58963>>>    Object frmFileName is a FormSub
58965>>>        Set Size to 13 321
58966>>>        Set Location to 6 63
58967>>>        Set Color to clBtnFace
58968>>>        Set Label_Col_Offset to 2
58969>>>        Set Label_Justification_Mode to jMode_Right
58970>>>        Set Prompt_Button_Mode to pb_PromptOn
58971>>>        Set Enabled_State to FALSE
58972>>>        Set Form_FontWeight Item 0 to 600
58973>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58974>>>        Set Item_Shadow_State Item 0 to TRUE
58975>>>        Set Shadow_State Item 0 to TRUE
58976>>>        Set Value Item 0 to "C:\B2_YPOLOIPA_PELATVN_31_05-2008.txt"
58977>>>
58977>>>        //AB-StoreStart
58977>>>                                                                                                                            
58977>>>        Procedure Prompt
58979>>>            String  sFileName
58980>>>            Integer bOpen
58980>>>            Get Show_Dialog Of oOpenFile To bOpen
58981>>>            If bOpen Begin
58983>>>                Get File_Name Of oOpenFile To sFileName
58984>>>                If (Trim(sFileName)<>'') Set Value Item 0 To sFileName
58987>>>            End
58987>>>>
58987>>>        End_Procedure
58988>>>        
58988>>>        
58988>>>        //AB-StoreEnd
58988>>>
58988>>>    End_Object    // frmFileName
58989>>>
58989>>>    Object Frmdate is a FormSub
58991>>>        Set Size to 13 69
58992>>>        Set Location to 49 71
58993>>>        Set Color to clBtnFace
58994>>>        Set Label_Col_Offset to 2
58995>>>        Set Form_Datatype Item 0 to Mask_Date_Window
58996>>>        Set Enabled_State to FALSE
58997>>>        Set Form_FontWeight Item 0 to 600
58998>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
58999>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
59000>>>        Set Item_Shadow_State Item 0 to TRUE
59001>>>        Set Shadow_State Item 0 to TRUE
59002>>>        Set Value Item 0 to "31/5/2008"
59003>>>    End_Object    // Frmdate
59004>>>
59004>>>    Object ButtonSub1 is a ButtonSub
59006>>>
59006>>>        //AB-StoreTopStart
59006>>>        
59006>>>        //AB-StoreTopEnd
59006>>>
59006>>>        Set Label to "„§œ¥œ¨š˜©å˜"
59007>>>        Set Size to 14 218
59008>>>        Set Location to 73 112
59009>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
59010>>>
59010>>>        //AB-StoreStart
59010>>>        
59010>>>        Procedure OnClick
59012>>>            String  sFile sFile2 sLabel sBr
59013>>>            Integer iFileExists iCheckAfm
59013>>>            Date ddate
59013>>>            Get label To slabel
59014>>>        
59014>>>            If (syscurxr.branch_code<>'84') Begin
59016>>>                Send Stop_Box '„„ˆ Œ€ ’„„ˆ ‘’Ž “Ž‰€’€‘’†‹€ 84 - TRANS ƒŽ‹ˆ‰† “Ž‰ 2 ˆ. „.' '‘­á¢£˜ 7001'
59017>>>                Procedure_Return
59018>>>            End
59018>>>>
59018>>>        
59018>>>            Set Enabled_State To False
59019>>>        
59019>>>            move syscurxr.branch_code To sBr
59020>>>            //Get Value Of frmBranch Item 0 To sBr
59020>>>            Get value Of frmdate   Item 0 To ddate
59021>>>            Move (Trim(sBr)) To sBr
59022>>>            If (ddate='') Begin
59024>>>                Send info_box 'ƒœ¤ ›é©˜«œ †£/¤å˜ £œ«˜­¦¨áª “§¦¢¦å§à¤'
59025>>>                Set Enabled_State To True
59026>>>                Procedure_Return
59027>>>            End
59027>>>>
59027>>>            // Mhdenismos tou ASCII kathe fora pou trexei
59027>>>            Direct_Output Channel 9 'C:\Paros_Kinhseis_Error.txt'
59029>>>            Close_Output Channel 9
59031>>>            //
59031>>>        
59031>>>            Get Value Of frmFileName Item 0 To sFile
59032>>>            Move (Trim(Uppercase(sFile)))   To sFile
59033>>>            If (sFile<>'') Begin
59035>>>                Get Get_File_Exists sFile   To iFileExists
59036>>>                If (not(iFileExists)) Begin
59038>>>                    Send Stop_Box "ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦." "‘­á¢£˜ 1001"
59039>>>                    Set Enabled_State To True
59040>>>                    Procedure_Return
59041>>>                End
59041>>>>
59041>>>        
59041>>>                If (sBr<>'') Send Read_Kinhseis sFile sBr
59044>>>                Else Begin
59045>>>                    Send Info_Box 'ƒœ¤ §¢ž¡«¨¦¢¦šã©˜«œ ¬§¦¡˜«á©«ž£˜' '¢ž¨¦­¦¨å˜'
59046>>>                    Set Enabled_State To True
59047>>>                    Procedure_Return
59048>>>                End
59048>>>>
59048>>>        
59048>>>                Send Info_Box "† ƒ ˜› ¡˜©å˜ «œ¢œåà©œ" "¢ž¨¦­¦¨å˜"
59049>>>            End
59049>>>>
59049>>>            Else Send Stop_Box 'ƒœ¤ §¨¦©› ¦¨å©˜«œ §¦¬ ™¨å©¡œ«œ «¦ ˜¨®œå¦' '‘­á¢£˜ 1002'
59051>>>        
59051>>>        
59051>>>            Set Label Of ButtonSub1 To sLabel
59052>>>            Set Enabled_State To True
59053>>>        End_Procedure // OnClick
59054>>>        
59054>>>        
59054>>>        Procedure Read_Kinhseis String asFile String asBr
59056>>>            // €¤œ¥á¨«ž«œª ‹œ«˜™¢ž«âª
59056>>>            String  sCode   sClientID sRecr   sError skeno
59057>>>            Integer iLathos iBtypkin  iInt1   iBaxioKat iCmvRec
59057>>>            Integer iError_Object_ID  iRecnum iErr rVal
59057>>>            Local String  sKinhsh sArPar sEidAxio sUnused sHmnia sKodPel sKodErg sCN
59057>>>            Integer iKodMon iXondr iKodKin1 iKodKin2 iCtypkin
59057>>>            Local String  sepon spol  sxre spis  s1 s2
59057>>>            Number  nxre npis nPoso
59057>>>            Date    dHmParast dHmAxio
59057>>>            Get value Of Frmdate Item 0 To dhmparast
59058>>>            /////////////////////////
59058>>>            Integer iExit0
59058>>>            Move 0 To iInt1
59059>>>            Move '‹œ«˜­.“§¦¢¦å§à¤ ' To sArPar
59060>>>            Append sarpar dhmparast
59061>>>            Append_Output Channel 9 'C:\Paros_Kinhseis_Error3.txt'
59063>>>        
59063>>>            Set piLathos To 0
59064>>>        
59064>>>            Move '01' To gs_Module_Code
59065>>>        
59065>>>            Begin_Transaction
59066>>>                Move Error_Object_ID To iError_Object_ID
59067>>>        
59067>>>                Direct_Input Channel 1 asFile
59069>>>                Readln Channel 1 sCode s1 s2 nPoso
59074>>>        
59074>>>                While (not(Seqeof))
59078>>>                    Add 1 To iInt1
59079>>>                    Set Label Of ButtonSub1 To (String(iInt1))
59080>>>        
59080>>>                    Move 0              to iExit0
59081>>>                    Move (trim(sCode))  to sCode
59082>>>        
59082>>>                    If (nPoso<>0) Begin
59084>>>                        Send Clear To Ctypkin_DD
59085>>>                        Send Clear To Clients_DD
59086>>>                        Send Clear To Cmoves_DD
59087>>>                        If (nPoso>0)        Move 101 To ictypkin
59090>>>                        Else If (nPoso<0)   Move 102 To ictypkin
59094>>>                        Else Goto Read_Next_Kinhsh34
59096>>>                        Move (Trim(sCode))  To sCode
59097>>>        
59097>>>                        Clear clients
59098>>>                        Move '' To sClientID
59099>>>        
59099>>>                        Move scode To clients.client_codem
59100>>>                        find ge clients.recnum
59101>>>>
59101>>>                        while ((found) anD (iExit0=0))
59105>>>                            if (scode=clients.client_codem)  begin
59107>>>                                Move clients.client_id To sclientid
59108>>>                                Move 1 to iExit0
59109>>>                            end
59109>>>>
59109>>>                            find gt clients.recnum
59110>>>>
59110>>>                        loop
59111>>>>
59111>>>        
59111>>>                        If (sclientid="") Begin
59113>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Client not found codem= ' (Trim(scode)) '  Poso=' nPoso
59121>>>                            Abort_Transaction
59122>>>                            Goto Read_Next_Kinhsh34
59123>>>>
59123>>>                        End
59123>>>>
59123>>>        
59123>>>                       Move iCtypkin    To Ctypkin.Ctypkin_Code
59124>>>                       Send Find        To Ctypkin_DD eq 1
59125>>>                       If (not(Found)) Begin
59127>>>                            Set piLathos To 7003
59128>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Ctypkin not found iCtypkin=' (String(iCtypkin))
59134>>>                            Abort_Transaction
59135>>>                            Goto Read_Next_Kinhsh34
59136>>>>
59136>>>                        End
59136>>>>
59136>>>        
59136>>>                        clear cn
59137>>>                        move sclientid to cn.client_id
59138>>>                        find ge cn by index.4
59139>>>>
59139>>>                        if ((found) and (cn.client_id = sclientid)) begin
59141>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code       To cn.cn_code
59142>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr       To cn.cn_recr
59143>>>                        end
59143>>>>
59143>>>                        else begin
59144>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code       To '01.Z2.00000'
59145>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr       To '81.9572'
59146>>>                        end
59146>>>>
59146>>>        
59146>>>        
59146>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Hmnia      To dHmParast
59147>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_M_Code     To '01'
59148>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Module_From       To '01'
59149>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_axia       To (Abs(nPoso))
59150>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_par        To (Trim(sArPar))
59151>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_sc_code2   To 'EUR'
59152>>>        
59152>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.enhm_ofeilh       To '1'
59153>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel     To '1'
59154>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel   To '1'
59155>>>                        Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_A_Code     To '3'
59156>>>        
59156>>>                        Send Request_Save To Cmoves_DD
59157>>>        
59157>>>                        Get Field_Current_Value Of Cmoves_DD Field Cmoves.Recnum To iCmvRec
59158>>>        
59158>>>                        If (iCmvRec) Begin
59160>>>                        End
59160>>>>
59160>>>                        Else Begin
59161>>>                            Writeln Channel 9 '‰ ¤ã©œ ª - Record #' (String(iInt1)) '    Cmoves repositioning not found'
59166>>>                            Abort_Transaction
59167>>>                        End
59167>>>>
59167>>>        
59167>>>                    End
59167>>>>
59167>>>        
59167>>>                    Read_Next_Kinhsh34:
59167>>>                    Readln Channel 1 sCode s1 s2 nPoso
59172>>>                Loop
59173>>>>
59173>>>        
59173>>>            End_Transaction
59174>>>            Unlock
59175>>>>
59175>>>            Move iError_Object_ID To Error_Object_ID
59176>>>        
59176>>>            Set Label Of ButtonSub1 To ''
59177>>>        
59177>>>                 If (piLathos(Self)=70000) Send Stop_Box 'Btypkin Not found'  ('# '+(String(iInt1)))
59180>>>            Else If (piLathos(Self)=70001) Send Stop_Box 'Client Not found'   ('# '+(String(iInt1)))
59184>>>            Else If (piLathos(Self)=70002) Send Stop_Box 'Baxiokat Not found' ('# '+(String(iInt1)))
59188>>>        
59188>>>        
59188>>>            Close_Output Channel 9
59190>>>        
59190>>>        
59190>>>        End_Procedure // Read_Kinhseis
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        
59191>>>        //AB-StoreEnd
59191>>>
59191>>>    End_Object    // ButtonSub1
59192>>>
59192>>>    Object TextBoxSub1 is a TextBoxSub
59194>>>        Set Label to "„§ ¢¦šã ˜¨®œå¦¬"
59195>>>        Set Location to 7 5
59196>>>        Set Size to 10 55
59197>>>        Set TypeFace to "MS Sans Serif"
59198>>>    End_Object    // TextBoxSub1
59199>>>
59199>>>    Object oOpenFile is a OpenDialog
59201>>>        Set Location to 2 407
59202>>>        Set Dialog_Caption to "Select a file"
59203>>>
59203>>>        //AB-StoreStart
59203>>>        Set Filter_String   To 'Text Files|*.txt|All Files|*.*'
59204>>>        Set Initial_Folder  To 'C:\VDF6\Develop\Empor'
59205>>>        Set Filter_Index    To 1
59206>>>        
59206>>>        //AB-StoreEnd
59206>>>
59206>>>    End_Object    // oOpenFile
59207>>>
59207>>>    Object TextBoxSub3 is a TextBoxSub
59209>>>        Set Label to "„§ ¢¦šã †£/¤å˜ª"
59210>>>        Set Location to 49 5
59211>>>        Set Size to 12 64
59212>>>        Set TypeFace to "MS Sans Serif"
59213>>>    End_Object    // TextBoxSub3
59214>>>
59214>>>
59214>>>    //AB-StoreStart
59214>>>                                                                            
59214>>>                                                                            
59214>>>                                                                            
59214>>>                                                                            
59214>>>                                                                            
59214>>>                                                                            
59214>>>    //AB-StoreEnd
59214>>>
59214>>>End_Object    // Gefyres3
59215>>>
59215>>>
59215>>>//AB-StoreStart
59215>>>                            
59215>>>                            
59215>>>                            
59215>>>//AB-StoreEnd
59215>>>
59215>>>//AB/ End_Object    // prj
59215>
59215>        //  Include all reports
59215>        Use rmetafyp.RV                                                                     
INCLUDING FILE: RMETAFYP.RV
59215>>>//AB/ Project Rmetafyp
59215>>>//AB/ Object prj is a Report_Project
59215>>>//AB/     Set ProjectName to "Rmetafyp"
59215>>>//AB/     Set ProjectFileName to "rmetafyp.RV"
59215>>>
59215>>>// Project Object Structure
59215>>>//   rmetafyp is a ReportViewSub
59215>>>//     cSyDateForm1 is a cSyDateForm
59215>>>//     ButtonSub3 is a ButtonSub
59215>>>//     TextBoxSub1 is a TextBoxSub
59215>>>//     f_payresp is a CheckBoxSub
59215>>>//     chkAkyr is a CheckBoxSub
59215>>>//     TextBoxSub4 is a TextBoxSub
59215>>>//     FormSub2 is a FormSub
59215>>>//     btnMess is a ButtonSub
59215>>>//     chkErmhs is a CheckBoxSub
59215>>>//     TextBoxSub5 is a TextBoxSub
59215>>>//     Areas_DD is a Areas_DataDictionary
59215>>>//     Payresp_DD is a Payresp_DataDictionary
59215>>>//     syscurxr_DD is a syscurxr_DataDictionary
59215>>>//     Country_DD is a Country_DataDictionary
59215>>>//     Towns_DD is a Towns_DataDictionary
59215>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
59215>>>//     Cities_DD is a Cities_DataDictionary
59215>>>//     Clients_DD is a Clients_DataDictionary
59215>>>//     Cmoves_DD is a Cmoves_DataDictionary
59215>>>//     metafyp_BasicReport is a BasicReport
59215>>>//       Areas_DD is a Areas_DataDictionary
59215>>>//       Payresp_DD is a Payresp_DataDictionary
59215>>>//       syscurxr_DD is a syscurxr_DataDictionary
59215>>>//       Country_DD is a Country_DataDictionary
59215>>>//       Towns_DD is a Towns_DataDictionary
59215>>>//       Ctypkin_DD is a Ctypkin_DataDictionary
59215>>>//       Cities_DD is a Cities_DataDictionary
59215>>>//       Clients_DD is a Clients_DataDictionary
59215>>>//       Cmoves_DD is a Cmoves_DataDictionary
59215>>>//       Cmovesa_DD is a Cmovesa_DataDictionary
59215>>>
59215>>>// Register all objects
59215>>>Register_Object Areas_DD
59215>>>Register_Object ButtonSub3
59215>>>Register_Object btnMess
59215>>>Register_Object Cities_DD
59215>>>Register_Object Clients_DD
59215>>>Register_Object Cmoves_DD
59215>>>Register_Object Cmovesa_DD
59215>>>Register_Object Country_DD
59215>>>Register_Object Ctypkin_DD
59215>>>Register_Object chkAkyr
59215>>>Register_Object chkErmhs
59215>>>Register_Object cSyDateForm1
59215>>>Register_Object FormSub2
59215>>>Register_Object f_payresp
59215>>>Register_Object metafyp_BasicReport
59215>>>Register_Object Payresp_DD
59215>>>Register_Object rmetafyp
59215>>>Register_Object syscurxr_DD
59215>>>Register_Object TextBoxSub1
59215>>>Register_Object TextBoxSub4
59215>>>Register_Object TextBoxSub5
59215>>>Register_Object Towns_DD
59215>>>
59215>>>
59215>>>//AB/ Report View
59215>>>
59215>>>
59215>>>//AB-StoreTopStart
59215>>>Use dfallrpt.pkg
59215>>>use areas.dd
59215>>>use country.dd
59215>>>use towns.dd
59215>>>use payresp.dd
59215>>>Use cities.DD
59215>>>Use clients.DD
59215>>>Use ctypkin.DD
59215>>>Use cmoves.DD
59215>>>USE CMOVESA.DD
INCLUDING FILE: CMOVESA.DD
59215>>>>>//DDB-FileStart
59215>>>>>//DDB-HeaderStart
59215>>>>>
59215>>>>>// File Name : CMOVESA.DD
59215>>>>>// Class Name: Cmovesa_DataDictionary
59215>>>>>// Revision  : 58
59215>>>>>// Version   : 2
59215>>>>>
59215>>>>>Use  Windows           // Basic Definitions
59215>>>>>Use  DataDict          // DataDictionary Class Definition
59215>>>>>Use  DDvalTbl          // Validation Table Class Definitions
59215>>>>>
59215>>>>>Open Cmovesa
59217>>>>>Open Copen
59219>>>>>
59219>>>>>//DDB-HeaderEnd
59219>>>>>//DDB-SelectionStart
59219>>>>>//DDB/ ExternalSelectionList sl006a1  sl006a1.SL
59219>>>>>Register_Object sl006a1
59219>>>>>//DDB-SelectionEnd
59219>>>>>//open master file
59219>>>>>Open Cmoves
59221>>>>>
59221>>>>>//define alias-master condition
59221>>>>>Set_Attribute DF_FILE_ALIAS of Cmoves.File_Number  to DF_FILE_IS_MASTER
59224>>>>>Set_Attribute DF_FILE_ALIAS of Cmovesa.File_Number to DF_FILE_IS_ALIAS
59227>>>>>
59227>>>>>Set_Relate Cmovesa.Ctypkin_Recr     to |FN0,0
59228>>>>>>
59228>>>>>Set_Relate Cmovesa.Client_Recr      to |FN0,0
59229>>>>>>
59229>>>>>
59229>>>>>Class Cmovesa_DataDictionary  is a DataDictionary_Sec
59230>>>>>
59230>>>>>//    Procedure Do_Compute_Open_Itemsa
59230>>>>>//        Case Begin
59230>>>>>//                Case (Cmovesa.Cmoves_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
59230>>>>>//                    Move "+"                                              to Cmovesa.Cmoves_Topen
59230>>>>>//                    Move (Cmovesa.Cmoves_X0 - Cmovesa.Cmoves_Open_Sx0)    to Cmovesa.Cmoves_Open_Yx0
59230>>>>>//                    Move 0                                                to Cmovesa.Cmoves_Open_Yp0
59230>>>>>//                Case Break
59230>>>>>
59230>>>>>//                Case (Cmovesa.Cmoves_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
59230>>>>>//                    Move "-"                                                 to Cmovesa.Cmoves_Topen
59230>>>>>//                    Move ((Abs(Cmovesa.Cmoves_X0))- Cmovesa.Cmoves_Open_Sp0) to Cmovesa.Cmoves_Open_Yp0
59230>>>>>//                    Move 0                                                   to Cmovesa.Cmoves_Open_Yx0
59230>>>>>//                Case Break
59230>>>>>
59230>>>>>//                Case (Cmovesa.Cmoves_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
59230>>>>>//                    Move "-"                                              to Cmovesa.Cmoves_Topen
59230>>>>>//                    Move (Cmovesa.Cmoves_P0 - Cmovesa.Cmoves_Open_Sp0)    to Cmovesa.Cmoves_Open_Yp0
59230>>>>>//                    Move 0                                                to Cmovesa.Cmoves_Open_Yx0
59230>>>>>//                Case Break
59230>>>>>
59230>>>>>//                Case (Cmovesa.Cmoves_P0 < 0) //¯œç«¦- § ©«à« ¡æ record
59230>>>>>//                    Move "+"                                                 to Cmovesa.Cmoves_Topen
59230>>>>>//                    Move ((Abs(Cmovesa.Cmoves_P0))-Cmovesa.Cmoves_Open_Sx0)  to Cmovesa.Cmoves_Open_Yx0
59230>>>>>//                    Move 0                                                   to Cmovesa.Cmoves_Open_Yp0
59230>>>>>//                Case Break
59230>>>>>//        Case End
59230>>>>>//    End_Procedure //do_compute_open_itemsa
59230>>>>>
59230>>>>>
59230>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
59230>>>>>      //¡˜¢œå«˜  ˜§æ validate save
59230>>>>>      Function  fi_Validate_Open_Itemsa Returns Integer
59231>>>>>
59231>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
59231>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 >= 0                       )) Function_Return 1101
59234>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 >= 0                       )) Function_Return 1102
59237>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 >= 0                       )) Function_Return 1103
59240>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 >= 0                       )) Function_Return 1104
59243>>>>>
59243>>>>>                 Case Begin
59243>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
59243>>>>>                      Case (Cmovesa.Cmoves_X0 > 0)
59245>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 <=      Cmovesa.Cmoves_X0  )) Function_Return 1105
59248>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 <=      Cmovesa.Cmoves_X0  )) Function_Return 1106
59251>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0  = 0                       )) Function_Return 1107
59254>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0  = 0                       )) Function_Return 1108
59257>>>>>                      Case Break
59258>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
59258>>>>>                      Case (Cmovesa.Cmoves_X0 < 0)
59261>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0  = 0                       )) Function_Return 1109
59264>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0  = 0                       )) Function_Return 1110
59267>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 <= (Abs(Cmovesa.Cmoves_X0)))) Function_Return 1111
59270>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 <= (Abs(Cmovesa.Cmoves_X0)))) Function_Return 1112
59273>>>>>                      Case Break
59274>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
59274>>>>>                      Case (Cmovesa.Cmoves_P0 > 0)
59277>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0  = 0                       )) Function_Return 1113
59280>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0  = 0                       )) Function_Return 1114
59283>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 <=      Cmovesa.Cmoves_P0  )) Function_Return 1115
59286>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 <=      Cmovesa.Cmoves_P0  )) Function_Return 1116
59289>>>>>                      Case Break
59290>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
59290>>>>>                      Case (Cmovesa.Cmoves_P0 < 0)
59293>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 <= (Abs(Cmovesa.Cmoves_P0)))) Function_Return 1117
59296>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 <= (Abs(Cmovesa.Cmoves_P0)))) Function_Return 1118
59299>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0  = 0                       )) Function_Return 1119
59302>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0  = 0                       )) Function_Return 1120
59305>>>>>                      Case Break
59306>>>>>                 Case End
59306>>>>>
59306>>>>>                 Function_Return 0 //æ¢˜ ok
59307>>>>>      End_Function //fi_validate_open_itemsa
59308>>>>>
59308>>>>>
59308>>>>>    Procedure Update 
59309>>>>>        
59309>>>>>        Forward Send Update
59311>>>>>                        
59311>>>>>        If (Cmovesa.Cmoves_M_Code='') Move Cmovesa.Module_From to Cmovesa.Cmoves_M_Code
59314>>>>>//        Send Do_Compute_Open_Itemsa
59314>>>>>
59314>>>>>        If (Ctypkin.Open_Item='1') Move (CmovesA.Axia_Pros_Sysx-CmovesA.Axia_Sysxet) to CmovesA.Axia_Ypol_Sysx
59317>>>>>        Else Begin
59318>>>>>            Move 0 to CmovesA.Axia_Pros_Sysx
59319>>>>>            Move 0 to CmovesA.Axia_Sysxet 
59320>>>>>            Move 0 to CmovesA.Axia_Ypol_Sysx
59321>>>>>        End
59321>>>>>>
59321>>>>>
59321>>>>>        // js 23/01/2002
59321>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
59321>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
59321>>>>>        Move (CmovesA.Axia_Ypol_Sysx<>0) to CmovesA.Flag_Ypol
59322>>>>>
59322>>>>>        // js 23/01/2002
59322>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
59322>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
59322>>>>>        // gia na emfanizei ta antistrofa sto copen
59322>>>>>        If (Ctypkin.Open_Item='1') Begin
59324>>>>>            If ((CmovesA.Cmoves_X0<>0) And ((CmovesA.Cmoves_P0=0))) Begin
59326>>>>>                Move 1                          to CmovesA.Flag_Copen
59327>>>>>                If (CmovesA.Cmoves_X0<0) Move 2 to CmovesA.Flag_Copen
59330>>>>>            End
59330>>>>>>
59330>>>>>            Else If ((CmovesA.Cmoves_P0<>0) And ((CmovesA.Cmoves_X0=0))) Begin
59333>>>>>                Move 2                          to CmovesA.Flag_Copen
59334>>>>>                If (CmovesA.Cmoves_P0<0) Move 1 to CmovesA.Flag_Copen
59337>>>>>            End
59337>>>>>>
59337>>>>>            Else Move 0 to CmovesA.Flag_Copen
59339>>>>>        End 
59339>>>>>>
59339>>>>>        Else Move 0 to CmovesA.Flag_Copen
59341>>>>>    End_Procedure //update
59342>>>>>
59342>>>>>
59342>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
59343>>>>>        String lsError_Message
59344>>>>>        Case Begin
59344>>>>>            //˜§æ validate save
59344>>>>>            Case (iError_Num = 88888)
59346>>>>>                Clear Codemast
59347>>>>>                Move "MODULE" to Codemast.Type
59348>>>>>                Move Cmovesa.Module_From to Codemast.Code
59349>>>>>                Find Eq Codemast by Index.1 //type+code
59350>>>>>>
59350>>>>>                Move ("DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
59351>>>>>            Case Break
59352>>>>>
59352>>>>>            Case (iError_Num = 88850)
59355>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå˜¤  ¡œ¤æ" to lsError_Message
59356>>>>>            Case Break
59357>>>>>
59357>>>>>            Case (iError_Num = 88884)
59360>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ A¥ æš¨˜­˜" to lsError_Message
59361>>>>>            Case Break
59362>>>>>            Case (iError_Num = 88883)
59365>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
59366>>>>>            Case Break
59367>>>>>            Case (iError_Num = 88882)
59370>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª Aš¦¨âª" to lsError_Message
59371>>>>>            Case Break
59372>>>>>
59372>>>>>            //˜§æ validate delete
59372>>>>>            Case (iError_Num = 88889)
59375>>>>>                Clear Codemast
59376>>>>>                Move "MODULE" to Codemast.Type
59377>>>>>                Move Cmovesa.Module_From to Codemast.Code
59378>>>>>                Find Eq Codemast by Index.1 //type+code
59379>>>>>>
59379>>>>>                Move ("DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
59380>>>>>            Case Break
59381>>>>>
59381>>>>>            Case (iError_Num = 88887)
59384>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ A¥ æš¨˜­˜" to lsError_Message
59385>>>>>            Case Break
59386>>>>>            Case (iError_Num = 88886)
59389>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
59390>>>>>            Case Break
59391>>>>>            Case (iError_Num = 88885)
59394>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª Aš¦¨âª" to lsError_Message
59395>>>>>            Case Break
59396>>>>>
59396>>>>>            //â¢œš®¦  open items
59396>>>>>            Case (iError_Num = 10101)
59399>>>>>                Move ("DDC 006:A¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
59400>>>>>            Case Break
59401>>>>>
59401>>>>>            Case Else
59401>>>>>                Forward Send Operation_Not_Allowed iError_Num
59403>>>>>        Case End
59403>>>>>
59403>>>>>        Error iError_Num lsError_Message
59404>>>>>>
59404>>>>>    End_Procedure // operation_not_allowed
59405>>>>>
59405>>>>>
59405>>>>>    Function Validate_Save Returns Integer
59406>>>>>         Integer iReturnVal liOpen_Itemsa
59407>>>>>         Forward Get Validate_Save to iReturnVal
59409>>>>>         If (Not(iReturnVal)) Begin
59411>>>>>            If (CmovesA.Axia_Ypol_Sysx<0) Move 10101 to ireturnVal
59414>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
59417>>>>>         End //«â¢¦ª ¡é› ¡˜ validation
59417>>>>>>
59417>>>>>         Function_Return iReturnVal
59418>>>>>    End_Function //validate_save
59419>>>>>
59419>>>>>
59419>>>>>    Function Validate_Delete  Returns Integer
59420>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
59421>>>>>    End_Function //validate_delete
59422>>>>>
59422>>>>>
59422>>>>>
59422>>>>>    // Define_Fields:
59422>>>>>    // This procedure is used to set up all data-dictionary rules.
59422>>>>>
59422>>>>>    Procedure Define_Fields
59423>>>>>        Forward Send Define_Fields
59425>>>>>        //DDB-Generated-Code-Location
59425>>>>>        //DDB-DefineFieldStart
59425>>>>>
59425>>>>>        Set Main_File            To Cmovesa.File_Number
59426>>>>>        Set Cascade_Delete_State To FALSE
59427>>>>>
59427>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
59428>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
59429>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
59430>>>>>
59430>>>>>        // Child (Client) file structure................
59430>>>>>        Send Add_Client_File  Copen.File_Number
59431>>>>>
59431>>>>>        // Field-based properties.......................
59431>>>>>
59431>>>>>        // Cmovesa.Company_Code
59431>>>>>
59431>>>>>        // Cmovesa.Branch_Code
59431>>>>>
59431>>>>>        // Cmovesa.Year_Year
59431>>>>>
59431>>>>>        // Cmovesa.Custprom_Code
59431>>>>>
59431>>>>>        // Cmovesa.Client_Id
59431>>>>>
59431>>>>>        // Cmovesa.Ctypkin_Code
59431>>>>>
59431>>>>>        // Cmovesa.Cmoves_Recr
59431>>>>>        Set Field_Prompt_Object    Field Cmovesa.Cmoves_Recr To (sl006a1(Self))
59432>>>>>
59432>>>>>        // Cmovesa.Cmoves_Rec0
59432>>>>>
59432>>>>>        // Cmovesa.Cmoves_Hmnia
59432>>>>>        Set Field_Prompt_Object    Field Cmovesa.Cmoves_Hmnia To (sl006a1(Self))
59433>>>>>
59433>>>>>        // Cmovesa.Ctypkin_Recr
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Par
59433>>>>>
59433>>>>>        // Cmovesa.Partl_Recr
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Axia
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_X0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_P0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_X00
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_P00
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_X1
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_P1
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_X2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_P2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Dlixis
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_A_Code
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Status_E
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Status_A
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_S0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Ys0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_S1
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Ys1
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_S2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Ys2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Sc_Code2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Aopen
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_M_Code
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Yn_Myf
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Myf_Axia
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Kk
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_C_Code2
59433>>>>>
59433>>>>>        // Cmovesa.Cn_Code
59433>>>>>
59433>>>>>        // Cmovesa.Client_Recr
59433>>>>>
59433>>>>>        // Cmovesa.Barticl_Recr
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Qty
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Totambd0
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Discam0
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Totamad0
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Vatam0
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Extra0
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Totambd00
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Discam00
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Totamad00
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Vatam00
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Extra00
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Totambd1
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Discam1
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Totamad1
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Vatam1
59433>>>>>
59433>>>>>        // Cmovesa.Cmove_Extra1
59433>>>>>
59433>>>>>        // Cmovesa.Module_From
59433>>>>>
59433>>>>>        // Cmovesa.Parast_Abrev
59433>>>>>
59433>>>>>        // Cmovesa.Enhm_Ypol_Pel
59433>>>>>
59433>>>>>        // Cmovesa.Enhm_Hmnies_Pel
59433>>>>>
59433>>>>>        // Cmovesa.Sls_Id
59433>>>>>
59433>>>>>        // Cmovesa.Presp_Id
59433>>>>>
59433>>>>>        // Cmovesa.Cnt_Id
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Sx0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Sp0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Yx0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Yp0
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Sx1
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Sp1
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Sx2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Open_Sp2
59433>>>>>
59433>>>>>        // Cmovesa.Cmoves_Topen
59433>>>>>
59433>>>>>        // Cmovesa.Cn_Recr
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Pros_Sysx
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Sysxet
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Ypol_Sysx
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Pros_Sys00
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Sysxet00
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Ypol_Sys00
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Pros_Sysr
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Sysxetr
59433>>>>>
59433>>>>>        // Cmovesa.Axia_Ypol_Sysr
59433>>>>>
59433>>>>>        // Cmovesa.Mhxanik_Id
59433>>>>>
59433>>>>>        // Cmovesa.Prn_Theor
59433>>>>>
59433>>>>>        // Cmovesa.Is_Closed
59433>>>>>
59433>>>>>        // Cmovesa.Flag_Copen
59433>>>>>
59433>>>>>        // Cmovesa.Flag_Ypol
59433>>>>>
59433>>>>>        // Cmovesa.Ctypkin_Descr
59433>>>>>
59433>>>>>        // Cmovesa.Client_Name
59433>>>>>
59433>>>>>        // Cmovesa.Enhm_Ofeilh
59433>>>>>
59433>>>>>        //DDB-DefineFieldEnd
59433>>>>>    End_Procedure    // Define_Fields
59434>>>>>
59434>>>>>    // Field_Defaults:
59434>>>>>    // This procedure is used to establish default field values.
59434>>>>>
59434>>>>>    Procedure Field_Defaults
59435>>>>>        Forward Send Field_Defaults
59437>>>>>        //DDB-Generated-Code-Location
59437>>>>>        //DDB-FieldDefaultStart
59437>>>>>        //DDB-FieldDefaultEnd
59437>>>>>    End_Procedure    // Field_Defaults
59438>>>>>
59438>>>>>End_Class    // Cmovesa_DataDictionary
59439>>>>>//DDB-Selection-pkg-Start
59439>>>>>
59439>>>>>Use sl006a1.SL       // sl006a1
INCLUDING FILE: SL006A1.SL
59439>>>>>>>//AB/ Project sl006a1
59439>>>>>>>//AB/ Object prj is a Lookup_Project
59439>>>>>>>//AB/     Set ProjectName to "sl006a1"
59439>>>>>>>//AB/     Set ProjectFileName to "sl006a1.SL"
59439>>>>>>>//AB/     Set GenerateFileName to "NONAME"
59439>>>>>>>
59439>>>>>>>// Project Object Structure
59439>>>>>>>//   sl006a1 is a dbModalPanelSub
59439>>>>>>>//     Cmovesa_DD is a DataDictionary
59439>>>>>>>//     oSelList is a dbListSub
59439>>>>>>>//     oOK_bn is a ButtonSub
59439>>>>>>>//     oCancel_bn is a ButtonSub
59439>>>>>>>//     oSearch_bn is a ButtonSub
59439>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
59439>>>>>>>//     TextBoxSub1 is a TextBoxSub
59439>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
59439>>>>>>>//     TextBoxSub2 is a TextBoxSub
59439>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
59439>>>>>>>//     TextBoxSub3 is a TextBoxSub
59439>>>>>>>
59439>>>>>>>// Register all objects
59439>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
59439>>>>>>>Register_Object Cmoves_Axia_Sysxet
59439>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
59439>>>>>>>Register_Object Cmovesa_DD
59439>>>>>>>Register_Object oCancel_bn
59439>>>>>>>Register_Object oOK_bn
59439>>>>>>>Register_Object oSearch_bn
59439>>>>>>>Register_Object oSelList
59439>>>>>>>Register_Object sl006a1
59439>>>>>>>Register_Object TextBoxSub1
59439>>>>>>>Register_Object TextBoxSub2
59439>>>>>>>Register_Object TextBoxSub3
59439>>>>>>>
59439>>>>>>>
59439>>>>>>>//AB-IgnoreStart
59439>>>>>>>
59439>>>>>>>Use DFAllEnt.pkg
59439>>>>>>>Use dbList.Sub
59439>>>>>>>Use Button.Sub
59439>>>>>>>Use dbForm.Sub
59439>>>>>>>Use Txtbox.Sub
59439>>>>>>>
59439>>>>>>>
59439>>>>>>>Use CMOVESA.DD
59439>>>>>>>
59439>>>>>>>//AB-IgnoreEnd
59439>>>>>>>
59439>>>>>>>CD_Popup_Object sl006a1 is a dbModalPanelSub
59458>>>>>>>
59458>>>>>>>    //AB-StoreTopStart
59458>>>>>>>                                                        
59458>>>>>>>    Property String     FragmaClientID  Public ''
59460>>>>>>>    Property Integer    piXr_Or_Pi      Public  0
59462>>>>>>>    Property String     psModule        Public ''
59464>>>>>>>    Property Date       pdApo           public ''
59466>>>>>>>    Property Date       pdEos           public ''
59468>>>>>>>    Property Integer    piWhat          public  0
59470>>>>>>>    
59470>>>>>>>    
59470>>>>>>>    //AB-StoreTopEnd
59470>>>>>>>
59470>>>>>>>    Set Label to "‰ ¤ã©œ ª"
59471>>>>>>>    Set Size to 231 495
59472>>>>>>>    Set Location to 4 6
59473>>>>>>>    Set Exit_Application_Local_State to FALSE
59474>>>>>>>    Set Modal_State to FALSE
59475>>>>>>>
59475>>>>>>>    //AB-DDOStart
59475>>>>>>>
59475>>>>>>>    Object Cmovesa_DD is a Cmovesa_DataDictionary
59477>>>>>>>
59477>>>>>>>        //AB-StoreStart
59477>>>>>>>                    
59477>>>>>>>        Begin_Constraints
59479>>>>>>>            Constrain Cmovesa.Company_Code  Eq SyscurXr.Company_Code
59481>>>>>>>            Constrain Cmovesa.Year_Year     Eq SyscurXr.Year_Year
59483>>>>>>>            Constrain Cmovesa.Flag_Ypol     Eq 1
59485>>>>>>>            Constrain CmovesA.Client_ID     Eq (FragmaClientID(Self))
59487>>>>>>>            Constrain CmovesA.Module_From   Eq (psModule(Self))
59489>>>>>>>                 If (piXr_or_Pi(Self)=1)    Constrain Cmovesa.Flag_Copen Eq 2
59493>>>>>>>            Else If (piXr_or_Pi(Self)=2)    Constrain Cmovesa.Flag_Copen Eq 1
59498>>>>>>>            If (pdApo(Self)<>'')            Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
59502>>>>>>>            If (pdEos(Self)<>'')            Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
59506>>>>>>>        End_Constraints
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        
59509>>>>>>>        //AB-StoreEnd
59509>>>>>>>
59509>>>>>>>    End_Object    // Cmovesa_DD
59510>>>>>>>
59510>>>>>>>    Set Main_DD to (Cmovesa_DD(self))
59511>>>>>>>    Set Server to (Cmovesa_DD(self))
59512>>>>>>>
59512>>>>>>>    //AB-DDOEnd
59512>>>>>>>
59512>>>>>>>    Object oSelList is a dbListSub
59514>>>>>>>
59514>>>>>>>        //AB-StoreTopStart
59514>>>>>>>                                                                                                                                                        
59514>>>>>>>                                                                                                                                                        
59514>>>>>>>        //AB-StoreTopEnd
59514>>>>>>>
59514>>>>>>>        Set Main_File to Cmovesa.File_Number
59515>>>>>>>        Set Size to 191 478
59516>>>>>>>        Set Location to 6 6
59517>>>>>>>
59517>>>>>>>        Begin_Row
59520>>>>>>>            Entry_Item Cmovesa.Cmoves_hmnia
59521>>>>>>>            Entry_Item Cmovesa.Cmoves_par
59522>>>>>>>            Entry_Item Cmovesa.Ctypkin_descr
59523>>>>>>>            Entry_Item Cmovesa.Client_name
59524>>>>>>>            Entry_Item Cmovesa.Cmoves_axia
59525>>>>>>>            Entry_Item Cmovesa.Branch_code
59526>>>>>>>        End_Row
59531>>>>>>>
59531>>>>>>>        Set Form_Width    item 0 to 57
59532>>>>>>>        Set Header_Label  item 0 to "†£/¤å˜"
59533>>>>>>>        
59533>>>>>>>        Set Form_Width    item 1 to 102
59534>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
59535>>>>>>>        
59535>>>>>>>        Set Form_Width    item 2 to 98
59536>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
59537>>>>>>>        
59537>>>>>>>        Set Form_Width    item 3 to 111
59538>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
59539>>>>>>>        
59539>>>>>>>        Set Form_Width    item 4 to 64
59540>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
59541>>>>>>>        
59541>>>>>>>        Set Form_Width    item 5 to 40
59542>>>>>>>        Set Header_Label  item 5 to "“§¦¡/£˜"
59543>>>>>>>        
59543>>>>>>>
59543>>>>>>>        //AB-StoreStart
59543>>>>>>>                                                                                                                                                        
59543>>>>>>>        Property String StoreFragmaClientID Public ''
59545>>>>>>>        Property String StorepsModule       Public ''
59547>>>>>>>        //
59547>>>>>>>        Procedure Store_Defaults
59549>>>>>>>               Forward Send Store_Defaults
59551>>>>>>>               Set StoreFragmaClientID  to (FragmaClientID  (Self))
59552>>>>>>>               Set StorepsModule        to (psModule        (Self))
59553>>>>>>>        End_Procedure
59554>>>>>>>        //
59554>>>>>>>        Procedure ReStore_Defaults
59556>>>>>>>               Forward Send ReStore_Defaults
59558>>>>>>>               Set FragmaClientID   to (StoreFragmaClientID (Self))
59559>>>>>>>               Set psModule         to (StorepsModule       (Self))
59560>>>>>>>        End_Procedure
59561>>>>>>>        //
59561>>>>>>>        Procedure Activating
59563>>>>>>>           Forward Send Activating
59565>>>>>>>           Send Rebuild_Constraints to (Cmovesa_DD(Self))
59566>>>>>>>        End_Procedure
59567>>>>>>>        //
59567>>>>>>>        Procedure Activate
59569>>>>>>>            Forward Send Activate
59571>>>>>>>            Send Beginning_Of_Data          to oSelList True
59572>>>>>>>        End_procedure
59573>>>>>>>        
59573>>>>>>>        Procedure End_Construct_Object
59575>>>>>>>            String  sNom
59576>>>>>>>            Integer iDecs
59576>>>>>>>            Forward Send End_Construct_Object
59578>>>>>>>            Move SysCurxr.C_Code0 to sNom
59579>>>>>>>            Clear Nomisma
59580>>>>>>>            Move sNom to Nomisma.Nomisma_Code
59581>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
59582>>>>>>>>
59582>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
59585>>>>>>>            Else            Move 0 to iDecs
59587>>>>>>>        
59587>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
59587>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
59587>>>>>>>            If (iDecs=0) Move 2 to iDecs
59590>>>>>>>            //
59590>>>>>>>        
59590>>>>>>>            Set Points          Item 4 to       iDecs
59591>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs ' ,*'
59592>>>>>>>        End_Procedure
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        
59593>>>>>>>        //AB-StoreEnd
59593>>>>>>>
59593>>>>>>>    End_Object    // oSelList
59594>>>>>>>
59594>>>>>>>    Object oOK_bn is a ButtonSub
59596>>>>>>>        Set Label to "&„§ ¢¦šã"
59597>>>>>>>        Set Location to 199 325
59598>>>>>>>
59598>>>>>>>        //AB-StoreStart
59598>>>>>>>        Procedure OnClick
59600>>>>>>>            Send OK To (oSelList(current_object))
59601>>>>>>>        End_Procedure
59602>>>>>>>        //AB-StoreEnd
59602>>>>>>>
59602>>>>>>>    End_Object    // oOK_bn
59603>>>>>>>
59603>>>>>>>    Object oCancel_bn is a ButtonSub
59605>>>>>>>        Set Label to "&€¡ç¨à©ž"
59606>>>>>>>        Set Location to 199 379
59607>>>>>>>
59607>>>>>>>        //AB-StoreStart
59607>>>>>>>        Procedure OnClick
59609>>>>>>>            Send Cancel To (oSelList(current_object))
59610>>>>>>>        End_Procedure
59611>>>>>>>        //AB-StoreEnd
59611>>>>>>>
59611>>>>>>>    End_Object    // oCancel_bn
59612>>>>>>>
59612>>>>>>>    Object oSearch_bn is a ButtonSub
59614>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
59615>>>>>>>        Set Location to 199 435
59616>>>>>>>
59616>>>>>>>        //AB-StoreStart
59616>>>>>>>        Procedure OnClick
59618>>>>>>>            Send Search To (oSelList(current_object))
59619>>>>>>>        End_Procedure
59620>>>>>>>        //AB-StoreEnd
59620>>>>>>>
59620>>>>>>>    End_Object    // oSearch_bn
59621>>>>>>>
59621>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
59623>>>>>>>        Entry_Item Cmovesa.Axia_ypol_sysx
59624>>>>>>>        Set Size to 13 54
59625>>>>>>>        Set Location to 199 249
59626>>>>>>>        Set Color to clBtnFace
59627>>>>>>>        Set Label_Col_Offset to 2
59628>>>>>>>        Set Label_Justification_Mode to jMode_Right
59629>>>>>>>        Set Enabled_State to FALSE
59630>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
59631>>>>>>>        Set Shadow_State Item 0 to TRUE
59632>>>>>>>
59632>>>>>>>        //AB-StoreStart
59632>>>>>>>                                                                                                
59632>>>>>>>        Set points item 0 to 2
59633>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
59634>>>>>>>        
59634>>>>>>>        //AB-StoreEnd
59634>>>>>>>
59634>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
59635>>>>>>>
59635>>>>>>>    Object TextBoxSub1 is a TextBoxSub
59637>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
59638>>>>>>>        Set Location to 201 211
59639>>>>>>>        Set Size to 10 35
59640>>>>>>>    End_Object    // TextBoxSub1
59641>>>>>>>
59641>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
59643>>>>>>>        Entry_Item Cmovesa.Axia_sysxet
59644>>>>>>>        Set Size to 13 54
59645>>>>>>>        Set Location to 199 141
59646>>>>>>>        Set Color to clBtnFace
59647>>>>>>>        Set Label_Col_Offset to 2
59648>>>>>>>        Set Label_Justification_Mode to jMode_Right
59649>>>>>>>        Set Enabled_State to FALSE
59650>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
59651>>>>>>>        Set Shadow_State Item 0 to TRUE
59652>>>>>>>
59652>>>>>>>        //AB-StoreStart
59652>>>>>>>        Set points item 0 to 2
59653>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
59654>>>>>>>        
59654>>>>>>>        //AB-StoreEnd
59654>>>>>>>
59654>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
59655>>>>>>>
59655>>>>>>>    Object TextBoxSub2 is a TextBoxSub
59657>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
59658>>>>>>>        Set Location to 201 90
59659>>>>>>>        Set Size to 10 49
59660>>>>>>>    End_Object    // TextBoxSub2
59661>>>>>>>
59661>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
59663>>>>>>>        Entry_Item Cmovesa.Axia_pros_sysx
59664>>>>>>>        Set Size to 13 54
59665>>>>>>>        Set Location to 199 25
59666>>>>>>>        Set Color to clBtnFace
59667>>>>>>>        Set Label_Col_Offset to 2
59668>>>>>>>        Set Label_Justification_Mode to jMode_Right
59669>>>>>>>        Set Enabled_State to FALSE
59670>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
59671>>>>>>>        Set Shadow_State Item 0 to TRUE
59672>>>>>>>
59672>>>>>>>        //AB-StoreStart
59672>>>>>>>        Set points item 0 to 2
59673>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
59674>>>>>>>        
59674>>>>>>>        //AB-StoreEnd
59674>>>>>>>
59674>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
59675>>>>>>>
59675>>>>>>>    Object TextBoxSub3 is a TextBoxSub
59677>>>>>>>        Set Label to "€¥å˜"
59678>>>>>>>        Set Location to 201 6
59679>>>>>>>        Set Size to 10 15
59680>>>>>>>    End_Object    // TextBoxSub3
59681>>>>>>>
59681>>>>>>>
59681>>>>>>>    //AB-StoreStart
59681>>>>>>>                                                        
59681>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
59682>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
59683>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
59684>>>>>>>    
59684>>>>>>>    
59684>>>>>>>    
59684>>>>>>>    
59684>>>>>>>    
59684>>>>>>>    
59684>>>>>>>    
59684>>>>>>>    //AB-StoreEnd
59684>>>>>>>
59684>>>>>>>CD_End_Object    // sl006a1
59686>>>>>>>>
59686>>>>>>>
59686>>>>>>>//AB/ End_Object    // prj
59686>>>>>
59686>>>>>//DDB-Selection-pkg-End
59686>>>>>//DDB-FileEnd
59686>>>USE SYSCURXR.DD
59686>>>use docpresp.dg
INCLUDING FILE: DOCPRESP.DG
59686>>>>>
59686>>>>>// Register all objects
59686>>>>>Register_Object syscurxr_DD
59686>>>>>Register_Object Docpresp
59686>>>>>Register_Object payresp_DD
59686>>>>>Register_Object year_DD
59686>>>>>Register_Object rmetafyp.rv
59686>>>>>
59686>>>>>
59686>>>>>
59686>>>>>//AB-IgnoreStart
59686>>>>>
59686>>>>>Use Bproces.Sub
59686>>>>>Use DFAllEnt.pkg
59686>>>>>use syscurxr.dd
59686>>>>>use payresp.dd
59686>>>>>use year.dd
59686>>>>>
59686>>>>>//AB-IgnoreEnd
59686>>>>>
59686>>>>>Object Docpresp is a BusinessProcessSub
59688>>>>>
59688>>>>>    //AB-StoreTopStart
59688>>>>>
59688>>>>>    Property    Integer piError       Public  0
59690>>>>>    property    string  datefrom      public ''
59692>>>>>    property    integer piTxtID       public 0
59694>>>>>    property    integer piLathos      public 0
59696>>>>>    property    string  psclient      public ''
59698>>>>>    property    string  psmodule      public ''
59700>>>>>    property    string  pscode        public ''
59702>>>>>
59702>>>>>    Open SysCurXr
59704>>>>>    //reread syscurxr
59704>>>>>    //unlock
59704>>>>>
59704>>>>>    Set Status_Panel_State to False
59705>>>>>    Set Display_Error_State to True
59706>>>>>
59706>>>>>    //AB-StoreTopEnd
59706>>>>>
59706>>>>>    Set Size to 82 140
59707>>>>>    Set Location to 72 182
59708>>>>>
59708>>>>>    //AB-DDOStart
59708>>>>>
59708>>>>>
59708>>>>>    Object Payresp_DD is a Payresp_DataDictionary
59710>>>>>
59710>>>>>    End_Object    // Payresp_DD
59711>>>>>
59711>>>>>    Object year_DD is a year_DataDictionary
59713>>>>>
59713>>>>>    End_Object    // year_DD
59714>>>>>
59714>>>>>    Object syscurxr_DD is a syscurxr_DataDictionary
59716>>>>>
59716>>>>>    End_Object    // syscurxr
59717>>>>>
59717>>>>>
59717>>>>>    //AB-StoreEnd
59717>>>>>
59717>>>>>
59717>>>>>    //AB-DDOEnd
59717>>>>>
59717>>>>>
59717>>>>>    //AB-StoreStart
59717>>>>>
59717>>>>>    Procedure Start_Processing
59719>>>>>     String  scode smodule spar
59720>>>>>     Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1 nplafon nofeilh
59720>>>>>     Date    dHmnia
59720>>>>>     string  serr
59720>>>>>     integer iyear icount nyear ctypkinyear
59720>>>>>     Clear payresp
59721>>>>>     move syscurxr.company_code     to payresp.company_code
59722>>>>>     find gt payresp by index.5
59723>>>>>>
59723>>>>>     While ((found=1)and (syscurxr.company_code eq payresp.company_code))
59727>>>>>         add 1 to icount
59728>>>>>         clear year
59729>>>>>         move syscurxr.company_code     to year.company_code
59730>>>>>         move syscurxr.branch_code      to year.branch_code
59731>>>>>         move (syscurxr.year_year+1)    to year.year_year
59732>>>>>         find eq year by index.1
59733>>>>>>
59733>>>>>         if (not(found)) error 3002 'ƒœ¤ â®œ«œ ˜¤¦å¥œ  ¤â˜ ®¨ã©ž ©«¦ ¬§¦¡˜«á©«ž£˜ !!'
59736>>>>>         move payresp.presp_id to scode
59737>>>>>         move year.payresp_plafon to nplafon
59738>>>>>         move year.payresp_ofeilh to nofeilh
59739>>>>>         reread payresp
59743>>>>>         move 0 to payresp.pistosh
59744>>>>>         move 0 to payresp.xreosh
59745>>>>>         move 0 to payresp.ypoloipo
59746>>>>>         move 0 to payresp.overhead
59747>>>>>         // ›œ¤ ¥â¨à ˜¤ §¨â§œ  ¤˜ £ž›œ¤å¦¬¤ «˜ œ§ ©­˜¢ã §¦©á ¡˜  §¦©á ˜§¦ ƒ.€///
59747>>>>>     //    move 0 to payresp.poso_se_apait
59747>>>>>     //    move 0 to payresp.posa_apo_dap
59747>>>>>         move nplafon to payresp.plafon
59748>>>>>         move nofeilh to payresp.orio_syn_ofeilh
59749>>>>>         saverecord payresp
59750>>>>>         unlock
59751>>>>>>
59751>>>>>         Send UpdateWait to (piTxtID(Self))  ('‹ž›œ¤ ©£æª ¬§¦¢.¬§œ¬Ÿ.§¢ž¨à£ãª '+(String(scode)+ ' '+(string(icount))))
59752>>>>>     Find  gt payresp by index.5
59753>>>>>>
59753>>>>>     loop
59754>>>>>>
59754>>>>>
59754>>>>>      if (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
59757>>>>>    End_Procedure
59758>>>>>
59758>>>>>
59758>>>>>    Procedure OnProcess
59760>>>>>        Send Start_Processing
59761>>>>>    End_Procedure
59762>>>>>
59762>>>>>    Procedure Start_Process
59764>>>>>         Set piTxtID                         to (Wait(Self))
59765>>>>>         Set Button_State    of (Wait(Self)) to False
59766>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
59767>>>>>         Send Popup                          to (Wait(Self))
59768>>>>>         Set piLathos                        to 0
59769>>>>>         Forward Send Start_Process
59771>>>>>    End_Procedure
59772>>>>>
59772>>>>>    Procedure OnError integer error_info string errMsg
59774>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
59777>>>>>    End_Procedure
59778>>>>>
59778>>>>>
59778>>>>>    Procedure End_Process
59780>>>>>       Forward Send End_Process
59782>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
59785>>>>>    End_Procedure
59786>>>>>
59786>>>>>
59786>>>>>    //AB-StoreEnd
59786>>>>>
59786>>>>>End_Object
59787>>>>>
59787>>>>>//AB/ End_Object    // prj
59787>>>use docclients.dg
INCLUDING FILE: DOCCLIENTS.DG
59787>>>>>
59787>>>>>// Register all objects
59787>>>>>Register_Object syscurxr_DD
59787>>>>>Register_Object Docclients
59787>>>>>Register_Object clients_DD
59787>>>>>Register_Object year_DD
59787>>>>>Register_Object rmetafyp.rv
59787>>>>>
59787>>>>>
59787>>>>>
59787>>>>>//AB-IgnoreStart
59787>>>>>
59787>>>>>Use Bproces.Sub
59787>>>>>Use DFAllEnt.pkg
59787>>>>>use syscurxr.dd
59787>>>>>use clients.dd
59787>>>>>use year.dd
59787>>>>>
59787>>>>>//AB-IgnoreEnd
59787>>>>>
59787>>>>>Object Docclients is a BusinessProcessSub
59789>>>>>
59789>>>>>    //AB-StoreTopStart
59789>>>>>
59789>>>>>    Property    Integer piError       Public  0
59791>>>>>    property    string  datefrom      public ''
59793>>>>>    property    integer piTxtID       public 0
59795>>>>>    property    integer piLathos      public 0
59797>>>>>    property    string  psclient      public ''
59799>>>>>    property    string  psmodule      public ''
59801>>>>>    property    string  pscode        public ''
59803>>>>>
59803>>>>>    Open SysCurXr
59805>>>>>    //reread syscurxr
59805>>>>>    //unlock
59805>>>>>
59805>>>>>    Set Status_Panel_State to False
59806>>>>>    Set Display_Error_State to True
59807>>>>>
59807>>>>>    //AB-StoreTopEnd
59807>>>>>
59807>>>>>    Set Size to 82 140
59808>>>>>    Set Location to 72 182
59809>>>>>
59809>>>>>    //AB-DDOStart
59809>>>>>
59809>>>>>
59809>>>>>    Object clients_DD is a clients_DataDictionary
59811>>>>>
59811>>>>>    End_Object    // clients_DD
59812>>>>>
59812>>>>>    Object year_DD is a year_DataDictionary
59814>>>>>
59814>>>>>    End_Object    // year_DD
59815>>>>>
59815>>>>>    Object syscurxr_DD is a syscurxr_DataDictionary
59817>>>>>
59817>>>>>    End_Object    // syscurxr
59818>>>>>
59818>>>>>
59818>>>>>    //AB-StoreEnd
59818>>>>>
59818>>>>>
59818>>>>>    //AB-DDOEnd
59818>>>>>
59818>>>>>
59818>>>>>    //AB-StoreStart
59818>>>>>
59818>>>>>    Procedure Start_Processing
59820>>>>>     String  scode smodule spar
59821>>>>>     Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1 nplafon nofeilh
59821>>>>>     Date    dHmnia
59821>>>>>     string  serr
59821>>>>>     integer iyear icount nyear ctypkinyear
59821>>>>>
59821>>>>>     Get psModule to sModule
59822>>>>>     If (Trim(sModule)='') Error 1001 'ƒœ¤ ¬§á¨®œ  Module'
59825>>>>>
59825>>>>>     Clear clients
59826>>>>>     move syscurxr.company_code     to clients.company_code
59827>>>>>   //  move syscurxr.branch_code      to clients.branch_code
59827>>>>>  //   move 0                         to clients.year_year
59827>>>>>     find gt clients by index.5
59828>>>>>>
59828>>>>>     While ((found) and (syscurxr.company_code eq clients.company_code))
59832>>>>>
59832>>>>>         add 1 to icount
59833>>>>>
59833>>>>>         If (;            ((sModule='01') And (Clients.is_Client      ='1')) Or ;            ((sModule='02') And (Clients.is_Promhtheyths='1')) ;            ) Begin
59835>>>>>
59835>>>>>                clear year
59836>>>>>                move syscurxr.company_code     to year.company_code
59837>>>>>                move syscurxr.branch_code      to year.branch_code
59838>>>>>                move (syscurxr.year_year+1)    to year.year_year
59839>>>>>                find eq year by index.1
59840>>>>>>
59840>>>>>                if (not(found)) error 3002 'ƒœ¤ â®œ«œ ˜¤¦å¥œ  ¤â˜ ®¨ã©ž ©«¦ ¬§¦¡˜«á©«ž£˜ !!'
59843>>>>>                move clients.client_id to scode
59844>>>>>                move year.clients_plafon to nplafon
59845>>>>>                move year.clients_ofeilh to nofeilh
59846>>>>>                reread clients
59850>>>>>                move 0 to clients.pistosh
59851>>>>>                move 0 to clients.xreosh
59852>>>>>                move 0 to clients.ypoloipo
59853>>>>>                move 0 to clients.overhead
59854>>>>>                // ›œ¤ ¥â¨à ˜¤ §¨â§œ  ¤˜ £ž›œ¤å¦¬¤ «˜ œ§ ©­˜¢ã §¦©á ¡˜  §¦©á ˜§¦ ƒ.€///
59854>>>>>            //    move 0 to clients.poso_se_apait
59854>>>>>            //    move 0 to clients.posa_apo_dap
59854>>>>>
59854>>>>>                if (clients.is_client = '1') begin
59856>>>>>                    move nplafon to clients.plafon
59857>>>>>                    move nofeilh to clients.orio_syn_ofeilh
59858>>>>>                end
59858>>>>>>
59858>>>>>                saverecord clients
59859>>>>>                unlock
59860>>>>>>
59860>>>>>                Send UpdateWait to (piTxtID(Self))  ('‹ž›œ¤ ©£æª ¬§¦¢.”¦¨â˜ '+(String(scode)+ ' '+(string(icount))))
59861>>>>>
59861>>>>>         End
59861>>>>>>
59861>>>>>        Find  gt clients by index.5
59862>>>>>>
59862>>>>>     loop
59863>>>>>>
59863>>>>>
59863>>>>>      if (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
59866>>>>>    End_Procedure
59867>>>>>
59867>>>>>
59867>>>>>    Procedure OnProcess
59869>>>>>        Send Start_Processing
59870>>>>>    End_Procedure
59871>>>>>
59871>>>>>    Procedure Start_Process
59873>>>>>         Set piTxtID                         to (Wait(Self))
59874>>>>>         Set Button_State    of (Wait(Self)) to False
59875>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
59876>>>>>         Send Popup                          to (Wait(Self))
59877>>>>>         Set piLathos                        to 0
59878>>>>>         Forward Send Start_Process
59880>>>>>    End_Procedure
59881>>>>>
59881>>>>>    Procedure OnError integer error_info string errMsg
59883>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
59886>>>>>    End_Procedure
59887>>>>>
59887>>>>>
59887>>>>>    Procedure End_Process
59889>>>>>       Forward Send End_Process
59891>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
59894>>>>>    End_Procedure
59895>>>>>
59895>>>>>
59895>>>>>    //AB-StoreEnd
59895>>>>>
59895>>>>>End_Object
59896>>>>>
59896>>>>>//AB/ End_Object    // prj
59896>>>OPEN CN
59898>>>//AB-StoreTopEnd
59898>>>
59898>>>//AB-IgnoreStart
59898>>>
59898>>>Use Rptvw.Sub
59898>>>Use cSyDateForm.Pkg
59898>>>Use Button.Sub
59898>>>Use Txtbox.Sub
59898>>>Use Chkbox.Sub
59898>>>Use Form.Sub
59898>>>
59898>>>//AB-IgnoreEnd
59898>>>
59898>>>ACTIVATE_VIEW Activate_rmetafyp FOR rmetafyp
59902>>>
59902>>>Object rmetafyp is a ReportViewSub
59904>>>
59904>>>    //AB-StoreTopStart
59904>>>    property integer pierr              public 0
59906>>>    Property Integer Sort_IndexRlog     Public 1
59908>>>    property integer pipayresp          public 0
59910>>>    property integer picount            public 0
59912>>>    property string  psmodule           public ''
59914>>>    property date    pddate             public ''
59916>>>    property number  px0                public 0
59918>>>    property number  pp0                public 0
59920>>>    property number  px00               public 0
59922>>>    property number  pp00               public 0
59924>>>    property number  px1                public 0
59926>>>    property number  pp1                public 0
59928>>>    
59928>>>    //AB-StoreTopEnd
59928>>>
59928>>>    Set Label to "‹œ«˜­¦¨á ¬§¦¢¦å§à¤"
59929>>>    Set Size to 130 272
59930>>>    Set Location to 7 12
59931>>>    Set Color to 13540467
59932>>>
59932>>>    //AB-DDOStart
59932>>>
59932>>>
59932>>>    //AB-DDOEnd
59932>>>
59932>>>    Object cSyDateForm1 is a cSyDateForm
59934>>>        Set Size to 13 66
59935>>>        Set Location to 11 119
59936>>>        Set Label_Col_Offset to 2
59937>>>        Set Label_Justification_Mode to jMode_Right
59938>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
59939>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
59940>>>
59940>>>        //AB-StoreStart
59940>>>        set prompt_object to (ocalendar(self))
59941>>>        //AB-StoreEnd
59941>>>
59941>>>    End_Object    // cSyDateForm1
59942>>>
59942>>>    Object ButtonSub3 is a ButtonSub
59944>>>
59944>>>        //AB-StoreTopStart
59944>>>        
59944>>>        //AB-StoreTopEnd
59944>>>
59944>>>        Set Bitmap to "RUNPROG.BMP"
59945>>>        Set Size to 20 23
59946>>>        Set Location to 10 236
59947>>>        Set Border_Style to Border_StaticEdge
59948>>>        Set Focus_Mode to Pointer_Only
59949>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
59950>>>
59950>>>        //AB-StoreStart
59950>>>        
59950>>>        Set TooltipValue to '„¤˜¨¥ž › ˜› ¡˜©å˜ª'
59951>>>        
59951>>>        Procedure OnClick
59953>>>            String StartHmen sModule sMess
59954>>>            Integer ibpoid iYear iPayResp ibpoid1 iChkAkyr iYes
59954>>>        
59954>>>            get value           of csydateform1 to starthmen
59955>>>            Get checked_State   of f_payresp    to ipayresp
59956>>>            Get checked_State   of chkAkyr      to iChkAkyr
59957>>>            get psModule                        to sModule
59958>>>        
59958>>>            If (StartHmen='') Begin
59960>>>                Send Stop_Box 'ƒœ¤ §¢ž¡«¨¦¢¦šã©˜«œ ž£œ¨¦£ž¤å˜ œšš¨˜­é¤' '‘­á¢£˜ 1001'
59961>>>                Send Activate to cSyDateForm1
59962>>>                Procedure_Return
59963>>>            End
59963>>>>
59963>>>        
59963>>>            Move (TheYearSegment(starthmen)) to iYear
59964>>>            If (iYear Lt syscurxr.year_year) Begin
59966>>>                Send Stop_Box '„©­˜¢£â¤ž ž£œ¨¦£ž¤å˜ œšš¨˜­é¤' '‘­á¢£˜ 1002'
59967>>>                Send Activate to cSyDateForm1
59968>>>                Procedure_Return
59969>>>            End
59969>>>>
59969>>>            If ((sModule<>'01') And (sModule<>'02')) Begin
59971>>>                Send Stop_Box 'ŠáŸ¦ª ©«¦ Module ¡¬¡¢é£˜«¦ª' '‘­á¢£˜ 1003'
59972>>>                Send Activate to cSyDateForm1
59973>>>                Procedure_Return
59974>>>            End
59974>>>>
59974>>>        
59974>>>            Integer iCheckErmhs
59974>>>            Get Checked_State Of chkErmhs to iCheckErmhs
59975>>>        
59975>>>            If (iChkAkyr) Begin
59977>>>                Move '' to sMess
59978>>>                Append sMess '„å©«œ ™â™˜ ¦  ¦«  Ÿâ¢œ«œ ¤˜ ˜¡¬¨é©œ«œ' '\n«ž¤ › ˜› ¡˜©å˜ £œ«˜­¦¨áª ¬§¦¢¦å§à¤ «žª ' StartHmen
59981>>>                Get YesNo_Box sMess to iYes
59982>>>                If (iYes=MBR_NO) Procedure_Return
59985>>>                String sCtyp
59985>>>                Begin_Transaction
59986>>>                    Send Clear      to Cmoves_DD
59987>>>                    Move StartHmen  to Cmoves.Cmoves_Hmnia
59988>>>                    Send Find       to Cmoves_DD Gt 3
59989>>>                    While ((Found) And (Cmoves.Cmoves_Hmnia=StartHmen))
59993>>>                        Set Label Of btnMess to (Trim(Cmoves.Cmoves_Hmnia)+' '+String(Cmoves.Recnum))
59994>>>        
59994>>>        
59994>>>                        // ‹„’€”Ž„‘ “ŽŠŽˆ—Œ €Ž ƒŽ‹ˆ‰† ‹„ †‹„Ž‹†Œˆ„‘ 31/05/2008 ‰€ˆ 24/11/2008
59994>>>                             If ((sModule='01') And (Cmoves.Ctypkin_Code='101') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="") And (iCheckErmhs=0)) Send Request_Delete to Cmoves_DD
59997>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='102') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="") And (iCheckErmhs=0)) Send Request_Delete to Cmoves_DD
60001>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='103') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="") And (iCheckErmhs=0)) Send Request_Delete to Cmoves_DD
60005>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='104') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="") And (iCheckErmhs=0)) Send Request_Delete to Cmoves_DD
60009>>>        
60009>>>                        // ‹„’€”Ž„‘ “ŽŠŽˆ—Œ €Ž „‹† ‹„ †‹„Ž‹†Œˆ„‘ 31/05/2008 ‰€ˆ 24/11/2008
60009>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='101') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="3") And (iCheckErmhs=1)) Send Request_Delete to Cmoves_DD
60013>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='102') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="3") And (iCheckErmhs=1)) Send Request_Delete to Cmoves_DD
60017>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='103') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="4") And (iCheckErmhs=1)) Send Request_Delete to Cmoves_DD
60021>>>                        Else If ((sModule='01') And (Cmoves.Ctypkin_Code='104') And (Cmoves.Company_Code=SysCurXr.Company_Code) And (Cmoves.Branch_Code=SysCurXr.Branch_Code) And (Cmoves.Cmoves_A_Code="4") And (iCheckErmhs=1)) Send Request_Delete to Cmoves_DD
60025>>>        
60025>>>                        Send Find to Cmoves_DD GT 3
60026>>>                    Loop
60027>>>>
60027>>>                End_Transaction
60028>>>            End
60028>>>>
60028>>>            Set Label Of btnMess to ''
60029>>>        End_Procedure
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        
60030>>>        //AB-StoreEnd
60030>>>
60030>>>    End_Object    // ButtonSub3
60031>>>
60031>>>    Object TextBoxSub1 is a TextBoxSub
60033>>>        Set Label to "ƒé©«œ ž£/¤å˜ š ˜ « ª œšš¨˜­âª “§¦¢¦å§à¤ §¦¬ Ÿ˜ › ˜š¨˜­¦ç¤"
60034>>>        Set Color to 13540467
60035>>>        Set TextColor to clYellow
60036>>>        Set Location to 6 9
60037>>>        Set Size to 29 83
60038>>>        Set FontWeight to 600
60039>>>        Set Justification_Mode to jMode_Center
60040>>>        Set TypeFace to "MS Sans Serif"
60041>>>    End_Object    // TextBoxSub1
60042>>>
60042>>>    Object f_payresp is a CheckBoxSub
60044>>>
60044>>>        //AB-StoreTopStart
60044>>>                
60044>>>                
60044>>>        //AB-StoreTopEnd
60044>>>
60044>>>        Set Size to 8 9
60045>>>        Set Location to 94 248
60046>>>        Set Color to clWindowText
60047>>>
60047>>>        //AB-StoreStart
60047>>>                
60047>>>        Set Enabled_State to False
60048>>>        Set Visible_State to False
60049>>>        
60049>>>        
60049>>>        
60049>>>        
60049>>>        //AB-StoreEnd
60049>>>
60049>>>    End_Object    // f_payresp
60050>>>
60050>>>    Object chkAkyr is a CheckBoxSub
60052>>>        Set Size to 8 9
60053>>>        Set Location to 47 152
60054>>>        Set Color to 7302102
60055>>>        Set Checked_State to TRUE
60056>>>        Set Enabled_State to FALSE
60057>>>        Set Item_Shadow_State Item 0 to TRUE
60058>>>        Set Shadow_State Item 0 to TRUE
60059>>>    End_Object    // chkAkyr
60060>>>
60060>>>    Object TextBoxSub4 is a TextBoxSub
60062>>>        Set Label to "€¡ç¨à©ž ƒ ˜› ¡˜©å˜ª"
60063>>>        Set Transparent_State to TRUE
60064>>>        Set TextColor to clLime
60065>>>        Set FontSize to 12 4
60066>>>        Set Location to 43 172
60067>>>        Set Size to 18 44
60068>>>        Set FontWeight to 600
60069>>>        Set Justification_Mode to jMode_Center
60070>>>        Set TypeFace to "MS Sans Serif"
60071>>>    End_Object    // TextBoxSub4
60072>>>
60072>>>    Object FormSub2 is a FormSub
60074>>>        Set Size to 5 268
60075>>>        Set Location to 78 -1
60076>>>        Set Color to clYellow
60077>>>        Set Label_Col_Offset to 2
60078>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
60079>>>
60079>>>        //AB-StoreStart
60079>>>                                                                                                                                                                                                                                        
60079>>>        Set Enabled_State   to False
60080>>>        Set Color           to clRed
60081>>>        
60081>>>        //AB-StoreEnd
60081>>>
60081>>>    End_Object    // FormSub2
60082>>>
60082>>>    Object btnMess is a ButtonSub
60084>>>        Set Size to 14 258
60085>>>        Set Location to 94 5
60086>>>        Set Border_Style to Border_StaticEdge
60087>>>        Set Focus_Mode to NonFocusable
60088>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
60089>>>
60089>>>        //AB-StoreStart
60089>>>        Procedure OnClick
60091>>>        
60091>>>        End_Procedure // OnClick
60092>>>        //AB-StoreEnd
60092>>>
60092>>>    End_Object    // btnMess
60093>>>
60093>>>    Object chkErmhs is a CheckBoxSub
60095>>>        Set Size to 10 10
60096>>>        Set Location to 47 49
60097>>>        Set Color to 13540467
60098>>>        Set TextColor to clLime
60099>>>    End_Object    // chkErmhs
60100>>>
60100>>>    Object TextBoxSub5 is a TextBoxSub
60102>>>        Set Label to "„šš¨˜­âª ˜§¦ „‹†"
60103>>>        Set Transparent_State to TRUE
60104>>>        Set TextColor to clLime
60105>>>        Set FontSize to 12 4
60106>>>        Set Location to 43 66
60107>>>        Set Size to 18 44
60108>>>        Set FontWeight to 600
60109>>>        Set Justification_Mode to jMode_Center
60110>>>        Set TypeFace to "MS Sans Serif"
60111>>>    End_Object    // TextBoxSub5
60112>>>
60112>>>
60112>>>    //AB-StoreStart
60112>>>                            
60112>>>    Set Output_Device_Name to None
60113>>>    
60113>>>    ////////////////////////////////////////////
60113>>>    // Omada DD gia thn akyrosh ths diadikasia
60113>>>    // metaforas ypoloipon
60113>>>    ////////////////////////////////////////////
60113>>>    Object Areas_DD is a Areas_DataDictionary
60115>>>    End_Object
60116>>>    Object Payresp_DD is a Payresp_DataDictionary
60118>>>    End_Object
60119>>>    Object syscurxr_DD is a syscurxr_DataDictionary
60121>>>    End_Object
60122>>>    Object Country_DD is a Country_DataDictionary
60124>>>    End_Object
60125>>>    Object Towns_DD is a Towns_DataDictionary
60127>>>        Set DDO_Server to (Country_DD(self))
60128>>>    End_Object
60129>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
60131>>>        set piMustNOTConstrain to 1
60132>>>        Procedure Update
60134>>>        End_Procedure
60135>>>        Procedure Creating
60137>>>        End_Procedure
60138>>>    End_Object
60139>>>    Object Cities_DD is a Cities_DataDictionary
60141>>>        Set DDO_Server to (Towns_DD(self))
60142>>>    End_Object
60143>>>    Object Clients_DD is a Clients_DataDictionary
60145>>>        Set DDO_Server to (Cities_DD(self))
60146>>>        Set DDO_Server to (Payresp_DD(self))
60147>>>        Set DDO_Server to (Areas_DD(self))
60148>>>    End_Object
60149>>>    Object Cmoves_DD is a Cmoves_DataDictionary
60151>>>        Set DDO_Server to (Ctypkin_DD(self))
60152>>>        Set DDO_Server to (Clients_DD(self))
60153>>>        set pifromxrhsh to 1
60154>>>        set pifrombp    to 1
60155>>>    End_Object
60156>>>    ////////////////////////////////////////////
60156>>>    ////////////////////////////////////////////
60156>>>    
60156>>>    
60156>>>    
60156>>>    Procedure Activate_View Returns Integer
60158>>>        String sStr sModule StrDisp
60159>>>        Integer rVal
60159>>>    
60159>>>        Forward Get Msg_Activate_View to rVal
60161>>>    
60161>>>        //Get psMenuModule  Of Main_Menu  to sModule
60161>>>        
60161>>>        Set psModule to '01' //                   to sModule
60162>>>    
60162>>>        // ‰à› ¡˜ª §¦¬ ˜­¦¨˜ «¦ constrain «à¤ ©«¦ ®œ à¤ «¦¬ view ¦§àª §˜¨˜©«˜« ¡á
60162>>>        // ž ¡ ¤ã©œ ª §¦¬ „„ˆ ¤˜ œå¤˜  constrain ˜¤˜¢¦š˜ £œ «¦ ¡ç¡¢à£˜ ˜§¦
60162>>>        // «¦ ¦§¦ ¦ ¡˜¢œå«˜  «¦ view. .•. ˜¤ ¡¢žŸœå ˜§¦ à¢ã©œ ª/œ¢á«œª ¤˜ £ž¤
60162>>>        // ­˜å¤¦¤«˜  ©«˜ §˜¨˜©«˜« ¡á «˜ ctypkin €š¦¨é¤ ¡¢§....
60162>>>    
60162>>>        Move (gsfCode_mast("MODULE",(psModule(Self)))) to    StrDisp
60163>>>    
60163>>>        if (smodule = "01");             Set Label Of rmetafyp to ("‹œ«˜­¦¨á ¬§¦¢¦å§à¤ œ¢˜«é¤"+ ' '+(trim(syscurxr.branch_name)))
60166>>>        if (smodule = "02");             Set Label Of rmetafyp to ("‹œ«˜­¦¨á ¬§¦¢¦å§à¤ ¨¦£žŸœ¬«é¤"+' ' +(trim(syscurxr.branch_name)))
60169>>>    
60169>>>          if (psmodule(self) = "01");             Set Report_Title of (metafyp_BasicReport(self)) to  "‹œ«˜­¦¨á ¬§¦¢¦å§à¤ œ¢˜«é¤         "
60172>>>        if (psmodule(self) = "02");             Set Report_Title of (metafyp_BasicReport(self)) to  "‹œ«˜­¦¨á ¬§¦¢¦å§à¤ ¨¦£žŸœ¬«é¤          "
60175>>>    
60175>>>    End_Procedure
60176>>>    
60176>>>    Procedure StartReport
60178>>>        Local Integer iOutputDevice ipayresp
60179>>>        Local String  FileName
60179>>>        local date ddate
60179>>>        Get value of csydateform1 item 0 to ddate
60180>>>        set pddate to ddate
60181>>>        Get value of f_payresp  item 0 to ipayresp
60182>>>        set pipayresp to ipayresp
60183>>>        SEND RUN_REPORT
60184>>>    End_Procedure   // StartReport
60185>>>    
60185>>>    
60185>>>    Object metafyp_BasicReport is a BasicReport
60187>>>    
60187>>>        Set Report_Title to "‹œ«˜­¦¨á ¬§¦¢¦å§à¤                                  "
60188>>>        Set Report_Caption to "ƒ ˜› ¡˜©å˜ ©œ „¥â¢ ¥ž                             "
60189>>>        Object Areas_DD is a Areas_DataDictionary
60191>>>        End_Object    // Areas_DD
60192>>>    
60192>>>        Object Payresp_DD is a Payresp_DataDictionary
60194>>>        End_Object    // Payresp_DD
60195>>>    
60195>>>        Object syscurxr_DD is a syscurxr_DataDictionary
60197>>>        End_Object    // syscurxr
60198>>>    
60198>>>        Object Country_DD is a Country_DataDictionary
60200>>>        End_Object    // Country_DD
60201>>>    
60201>>>        Object Towns_DD is a Towns_DataDictionary
60203>>>            Set DDO_Server to (Country_DD(self))
60204>>>        End_Object    // Towns_DD
60205>>>    
60205>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
60207>>>            set piMustNOTConstrain to 1
60208>>>    
60208>>>            Procedure Update
60210>>>            End_Procedure
60211>>>    
60211>>>            Procedure Creating
60213>>>            End_Procedure
60214>>>        End_Object    // Ctypkin_DD
60215>>>    
60215>>>        Object Cities_DD is a Cities_DataDictionary
60217>>>            Set DDO_Server to (Towns_DD(self))
60218>>>        End_Object    // Cities_DD
60219>>>    
60219>>>        Object Clients_DD is a Clients_DataDictionary
60221>>>            Set DDO_Server to (Cities_DD(self))
60222>>>            Set DDO_Server to (Payresp_DD(self))
60223>>>            Set DDO_Server to (Areas_DD(self))
60224>>>        End_Object    // Clients_DD
60225>>>    
60225>>>        Object Cmoves_DD is a Cmoves_DataDictionary
60227>>>            Set DDO_Server to (Ctypkin_DD(self))
60228>>>            Set DDO_Server to (Clients_DD(self))
60229>>>            set pifromxrhsh to 1
60230>>>            set pifrombp    to 1
60231>>>        End_Object    // Cmoves_DD
60232>>>    
60232>>>        Object Cmovesa_DD is a Cmovesa_DataDictionary
60234>>>            //AB-StoreStart
60234>>>            Begin_Constraints
60236>>>                date ddate
60237>>>                string smodule
60237>>>                get psmodule to smodule
60238>>>                set ordering to 13
60239>>>                constrain cmovesa.company_code eq syscurxr.company_code
60241>>>                constrain cmovesa.branch_code  eq syscurxr.branch_code
60243>>>                constrain cmovesa.year_year    eq syscurxr.year_year
60245>>>                constrain cmovesa.module_from  eq smodule
60247>>>            End_Constraints
60250>>>        end_object
60251>>>        Set Server To (cmovesa_dd(Current_Object))
60252>>>    
60252>>>        //Breaks and Index for the report
60252>>>        Report_Index By Index.11
60254>>>        Report_breaks cmovesa.company_code cmovesa.branch_code cmovesa.module_from cmovesa.client_id cmovesa.cn_code
60271>>>        Function Starting_Main_Report Returns Integer
60273>>>          REREAD SYSCURXR
60277>>>          UNLOCK
60278>>>>
60278>>>          Integer iIndexRlog
60279>>>          Local Integer iRetVal
60279>>>          Forward Get Starting_Main_Report to iRetval
60281>>>          send rebuild_constraints to cmovesa_dd
60282>>>          Send Find to (cmovesa_dd(self)) First_Record 13
60283>>>        End_Function
60284>>>    
60284>>>        Procedure_Section subheader1
60286>>>            integer ino
60287>>>            move 0 to ino
60288>>>        End_Procedure
60289>>>    
60289>>>        Procedure_Section subheader2
60291>>>        End_Procedure
60292>>>    
60292>>>        Procedure_Section subheader3
60294>>>        End_Procedure
60295>>>    
60295>>>        Procedure_Section subheader4
60297>>>        End_Procedure
60298>>>    
60298>>>        Procedure_Section subheader5
60300>>>        End_Procedure
60301>>>        Procedure_Section  Body
60303>>>            String  scode smodule spar serr
60304>>>            Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1
60304>>>            Date    dHmnia
60304>>>            integer iyear icount nyear ctypkinyear
60304>>>            get px0    to nx0
60305>>>            get px1    to nx1
60306>>>            get px00   to nx00
60307>>>            get pp0    to np0
60308>>>            get pp1    to np1
60309>>>            get pp00   to np00
60310>>>            add cmovesa.cmoves_x0     to nx0
60311>>>            add cmovesa.cmoves_p0     to np0
60312>>>            add cmovesa.cmoves_x00    to nx00
60313>>>            add cmovesa.cmoves_p00    to np00
60314>>>            add cmovesa.cmoves_x1     to nx1
60315>>>            add cmovesa.cmoves_p1     to np1
60316>>>            set px0    to nx0
60317>>>            set px1    to nx1
60318>>>            set px00   to nx00
60319>>>            set pp0    to np0
60320>>>            set pp1    to np1
60321>>>            set pp00   to np00
60322>>>        End_Procedure
60323>>>    
60323>>>        Procedure_Section subTOTAL5
60325>>>    
60325>>>             Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1
60326>>>             integer icount
60326>>>             string smodule spar msgstr SID scn
60326>>>             date ddate
60326>>>             get psmodule to smodule
60327>>>             get pddate to ddate
60328>>>             add 1 to icount
60329>>>             get px0    to nx0
60330>>>             get px1    to nx1
60331>>>             get px00   to nx00
60332>>>             get pp0    to np0
60333>>>             get pp1    to np1
60334>>>             get pp00   to np00
60335>>>             if ((nx0 <> 0) or (np0 <>0)) begin
60337>>>                if (nx0 > np0) begin
60339>>>                   move (nx0 - np0) to nx0
60340>>>                   move (nx00-np00) to nx00
60341>>>                   move (nx1-np1)   to nx1
60342>>>                   move 0           to np0
60343>>>                   move 0           to np00
60344>>>                   move 0           to np1
60345>>>                end
60345>>>>
60345>>>                else begin
60346>>>                   move (np0-nx0)   to np0
60347>>>                   move (np00-nx00) to np00
60348>>>                   move (np1-nx1)   to np1
60349>>>                   move 0           to nx0
60350>>>                   move 0           to nx00
60351>>>                   move 0           to nx1
60352>>>                end
60352>>>>
60352>>>    
60352>>>                send clear to cmoves_dd
60353>>>                move cmovesa.client_id to clients.client_id
60354>>>                send find to clients_dd eq 6
60355>>>                if (not(found)) error 2999 'ƒœ¤ ™¨å©¡à œ¢á«ž'
60358>>>    
60358>>>                move (trim(syscurxr.company_code))      to ctypkin.company_code
60359>>>                move (trim(syscurxr.branch_code))       to ctypkin.branch_code
60360>>>                move (TheYearSegment(ddate))            to ctypkin.year_year
60361>>>                if ((smodule = '01') and (nx0 <> 0)) move '101' to ctypkin.ctypkin_code
60364>>>                if ((smodule = '01') and (np0 <> 0)) move '102' to ctypkin.ctypkin_code
60367>>>                if ((smodule = '02') and (nx0 <> 0)) move '201' to ctypkin.ctypkin_code
60370>>>                if ((smodule = '02') and (np0 <> 0)) move '202' to ctypkin.ctypkin_code
60373>>>                send find to ctypkin_dd eq 1
60374>>>                if (found=1) begin
60376>>>                    if (cmovesa.cn_code='') begin
60378>>>                        move 'ƒœ¤ ™¨å©¡à „¨š¦ ©«¦¤ §œ¢á«ž = ' to msgstr
60379>>>                        append msgstr cmovesa.client_id
60380>>>                        error 2996 msgstr
60381>>>>
60381>>>                    End
60381>>>>
60381>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_x0 to nx0
60382>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_p0 to np0
60383>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_x00 to nx00
60384>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_p00 to np00
60385>>>                    if (nx0>np0) set field_changed_value of cmoves_dd field cmoves.cmoves_axia to nx0
60388>>>                    else if (np0>nx0) set field_changed_value of cmoves_dd field cmoves.cmoves_axia to np0
60392>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_x1 to nx1
60393>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_p1 to np1
60394>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_hmnia to ddate
60395>>>                    move '‹œ«˜­.¬§¦¢¦å§à¤ ' to spar
60396>>>                    append spar ddate
60397>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_par to spar
60398>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_sc_code2 to 'EUR'
60399>>>                    set field_changed_value of cmoves_dd field cmoves.cmoves_M_code to smodule
60400>>>                    set field_changed_value of cmoves_dd field cmoves.Module_from to smodule
60401>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel    to '1'
60402>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel  to '1'
60403>>>                    set field_changed_value of cmoves_dd field cmoves.cn_code to cmovesa.cn_code
60404>>>                    set field_changed_value of cmoves_dd field cmoves.cn_recr to cmovesa.cn_recr
60405>>>                    set field_changed_value of cmoves_dd field cmoves.sls_id  to cmovesa.sls_id
60406>>>                    set field_changed_value of cmoves_dd field cmoves.presp_id to cmovesa.presp_id
60407>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cnt_id   to cmovesa.cnt_id
60408>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.mhxanik_id to cmovesa.mhxanik_id
60409>>>                    send request_save to cmoves_dd
60410>>>                end
60410>>>>
60410>>>                  MOVE cmovesa.client_id to sid
60411>>>                  MOVE cmovesa.cn_code to scn
60412>>>                  send update_status ('„šš¨˜­ã   ' + string(sid) + " : " + string(scn))
60413>>>                  PROSPER:
60413>>>                  set px0  to 0
60414>>>                  set px1  to 0
60415>>>                  set px00 to 0
60416>>>                  set pp0  to 0
60417>>>                  set pp1  to 0
60418>>>                  set pp00 to 0
60419>>>             end
60419>>>>
60419>>>        End_Procedure
60420>>>    
60420>>>    
60420>>>        Procedure_Section subtotal4
60422>>>           integer ino
60423>>>           move 0 to ino
60424>>>        End_Procedure
60425>>>    
60425>>>    
60425>>>        Procedure_Section subtotal3
60427>>>           integer ino
60428>>>           move 0 to ino
60429>>>        End_Procedure
60430>>>    
60430>>>        Procedure_Section subtotal2
60432>>>           integer ino
60433>>>           move 0 to ino
60434>>>        End_Procedure
60435>>>    
60435>>>        Procedure_Section subtotal1
60437>>>           integer ino
60438>>>           move 0 to ino
60439>>>        End_Procedure
60440>>>    
60440>>>    End_Object
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    
60441>>>    //AB-StoreEnd
60441>>>
60441>>>End_Object    // rmetafyp
60442>>>
60442>>>
60442>>>//AB-StoreStart
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>                        
60442>>>//AB-StoreEnd
60442>>>
60442>>>//AB/ End_Object    // prj
60442>        Use CN_DELET.VW                                                                     
INCLUDING FILE: CN_DELET.VW
60442>>>//AB/ Project CN_DELET
60442>>>//AB/     Object prj is a View_Project
60442>>>//AB/         Set ProjectName to "CN_DELET"
60442>>>//AB/         Set ProjectFileName to "CN_DELET.VW"
60442>>>
60442>>>// Project Object Structure
60442>>>//   CN_DELET is a dbViewSub
60442>>>//     Company_DD is a DataDictionary
60442>>>//     Branch_DD is a DataDictionary
60442>>>//     Ctypkin_DD is a DataDictionary
60442>>>//     Country_DD is a DataDictionary
60442>>>//     Towns_DD is a DataDictionary
60442>>>//     Cities_DD is a DataDictionary
60442>>>//     Areas_DD is a DataDictionary
60442>>>//     Payresp_DD is a DataDictionary
60442>>>//     Clients_DD is a DataDictionary
60442>>>//     Cmoves_DD is a DataDictionary
60442>>>//     Cmovesa_DD is a DataDictionary
60442>>>//     Copen_DD is a DataDictionary
60442>>>//     Wtypkin_DD is a DataDictionary
60442>>>//     Ptyppar_DD is a DataDictionary
60442>>>//     Nomisma_DD is a DataDictionary
60442>>>//     Particle_DD is a DataDictionary
60442>>>//     Wapokat_DD is a DataDictionary
60442>>>//     Wapomast_DD is a DataDictionary
60442>>>//     Wax_DD is a DataDictionary
60442>>>//     Units_DD is a DataDictionary
60442>>>//     Witemkat_DD is a DataDictionary
60442>>>//     Fpa_DD is a DataDictionary
60442>>>//     Item_DD is a DataDictionary
60442>>>//     Witemx_DD is a DataDictionary
60442>>>//     Pmoves_DD is a DataDictionary
60442>>>//     Pmsdtl_DD is a DataDictionary
60442>>>//     Baxiokat_DD is a DataDictionary
60442>>>//     Pmssxet_DD is a DataDictionary
60442>>>//     Salesmen_DD is a DataDictionary
60442>>>//     Mhxanik_DD is a DataDictionary
60442>>>//     Constrct_DD is a DataDictionary
60442>>>//     Cn_DD is a DataDictionary
60442>>>//     Particll_DD is a DataDictionary
60442>>>//     Psxetika_DD is a DataDictionary
60442>>>//     Dorderh_DD is a DataDictionary
60442>>>//     Clnbank_DD is a DataDictionary
60442>>>//     Dorderd_DD is a DataDictionary
60442>>>//     Zones_DD is a DataDictionary
60442>>>//     Brzones_DD is a DataDictionary
60442>>>//     Cnzones_DD is a DataDictionary
60442>>>//     Tpclient_DD is a DataDictionary
60442>>>//     Tperga_DD is a DataDictionary
60442>>>//     Tparticl_DD is a DataDictionary
60442>>>//     Cmovesa2_DD is a DataDictionary
60442>>>//     Clorder_DD is a DataDictionary
60442>>>//     Clorderd_DD is a DataDictionary
60442>>>//     Clitem_DD is a DataDictionary
60442>>>//     Partlfpa_DD is a DataDictionary
60442>>>//     Btnordh_DD is a DataDictionary
60442>>>//     Btnordd_DD is a DataDictionary
60442>>>//     Pmovesl_DD is a DataDictionary
60442>>>//     Container2 is a dbContainer3d
60442>>>//       Clients_Client_id is a dbForm
60442>>>//       Clients_Client_name is a dbForm
60442>>>//       Clients_Client_afm is a dbForm
60442>>>//       TextBoxSub5 is a TextBoxSub
60442>>>//       TextBoxSub6 is a TextBoxSub
60442>>>//       TextBoxSub7 is a TextBoxSub
60442>>>//     Cn_ is a dbGridSub
60442>>>//     btnPartl is a ButtonSub
60442>>>//     Cn_Cn_Codematch is a dbFormSub
60442>>>
60442>>>// Register all objects
60442>>>Register_Object Areas_DD
60442>>>Register_Object Baxiokat_DD
60442>>>Register_Object Branch_DD
60442>>>Register_Object Brzones_DD
60442>>>Register_Object Btnordd_DD
60442>>>Register_Object Btnordh_DD
60442>>>Register_Object btnPartl
60442>>>Register_Object Cities_DD
60442>>>Register_Object Clients_Client_afm
60442>>>Register_Object Clients_Client_id
60442>>>Register_Object Clients_Client_name
60442>>>Register_Object Clients_DD
60442>>>Register_Object Clitem_DD
60442>>>Register_Object Clnbank_DD
60442>>>Register_Object Clorder_DD
60442>>>Register_Object Clorderd_DD
60442>>>Register_Object Cmoves_DD
60442>>>Register_Object Cmovesa_DD
60442>>>Register_Object Cmovesa2_DD
60442>>>Register_Object CN_DELET
60442>>>Register_Object Cn_
60442>>>Register_Object Cn_Cn_Codematch
60442>>>Register_Object Cn_DD
60442>>>Register_Object Cnzones_DD
60442>>>Register_Object Company_DD
60442>>>Register_Object Constrct_DD
60442>>>Register_Object Container2
60442>>>Register_Object Copen_DD
60442>>>Register_Object Country_DD
60442>>>Register_Object Ctypkin_DD
60442>>>Register_Object Dorderd_DD
60442>>>Register_Object Dorderh_DD
60442>>>Register_Object Fpa_DD
60442>>>Register_Object Item_DD
60442>>>Register_Object Mhxanik_DD
60442>>>Register_Object Nomisma_DD
60442>>>Register_Object Particle_DD
60442>>>Register_Object Particll_DD
60442>>>Register_Object Partlfpa_DD
60442>>>Register_Object Payresp_DD
60442>>>Register_Object Pmoves_DD
60442>>>Register_Object Pmovesl_DD
60442>>>Register_Object Pmsdtl_DD
60442>>>Register_Object Pmssxet_DD
60442>>>Register_Object Psxetika_DD
60442>>>Register_Object Ptyppar_DD
60442>>>Register_Object Salesmen_DD
60442>>>Register_Object TextBoxSub5
60442>>>Register_Object TextBoxSub6
60442>>>Register_Object TextBoxSub7
60442>>>Register_Object Towns_DD
60442>>>Register_Object Tparticl_DD
60442>>>Register_Object Tpclient_DD
60442>>>Register_Object Tperga_DD
60442>>>Register_Object Units_DD
60442>>>Register_Object Wapokat_DD
60442>>>Register_Object Wapomast_DD
60442>>>Register_Object Wax_DD
60442>>>Register_Object Witemkat_DD
60442>>>Register_Object Witemx_DD
60442>>>Register_Object Wtypkin_DD
60442>>>Register_Object Zones_DD
60442>>>
60442>>>
60442>>>//AB/     AppBuild VIEW
60442>>>
60442>>>
60442>>>    //AB-StoreTopStart
60442>>>    use v041.vw
INCLUDING FILE: V041.VW
60442>>>>>//AB/ Project V041:MHTROO CN
60442>>>>>//AB/ Object prj is a View_Project
60442>>>>>//AB/     Set ProjectName to "V041:MHTROO CN"
60442>>>>>//AB/     Set ProjectFileName to "V041.VW"
60442>>>>>//AB/     Set GenerateFileName to "NONAME"
60442>>>>>
60442>>>>>// Project Object Structure
60442>>>>>//   V041 is a dbViewSub
60442>>>>>//     Company_DD is a DataDictionary
60442>>>>>//     Branch_DD is a DataDictionary
60442>>>>>//     Baxiokat_DD is a DataDictionary
60442>>>>>//     Country_DD is a DataDictionary
60442>>>>>//     Towns_DD is a DataDictionary
60442>>>>>//     Cities_DD is a DataDictionary
60442>>>>>//     Areas_DD is a DataDictionary
60442>>>>>//     Payresp_DD is a DataDictionary
60442>>>>>//     Clients_DD is a DataDictionary
60442>>>>>//     Constrct_DD is a DataDictionary
60442>>>>>//     Salesmen_DD is a DataDictionary
60442>>>>>//     Mhxanik_DD is a DataDictionary
60442>>>>>//     Cn_DD is a DataDictionary
60442>>>>>//     Zones_DD is a DataDictionary
60442>>>>>//     Brzones_DD is a DataDictionary
60442>>>>>//     Cnzones_DD is a DataDictionary
60442>>>>>//     Tperga_DD is a DataDictionary
60442>>>>>//     Btnordh_DD is a DataDictionary
60442>>>>>//     Btnordd_DD is a DataDictionary
60442>>>>>//     cn_cn_code is a dbForm
60442>>>>>//     Cn_Eidos_Cn is a dbComboFormSub
60442>>>>>//     Cn_Cn_Active is a dbCheckBoxSub
60442>>>>>//     Clients_Client_name is a dbForm
60442>>>>>//     Clients_Client_Adress is a dbFormSub
60442>>>>>//     Clients_Client_Add_No is a dbFormSub
60442>>>>>//     Clients_Client_Zipcode is a dbFormSub
60442>>>>>//     Cn_Cn_Area is a dbFormSub
60442>>>>>//     Cn_Cn_city is a dbFormSub
60442>>>>>//     TextBoxSub5 is a TextBoxSub
60442>>>>>//     TextBoxSub6 is a TextBoxSub
60442>>>>>//     TextBoxSub7 is a TextBoxSub
60442>>>>>//     TextBoxSub8 is a TextBoxSub
60442>>>>>//     TextBoxSub9 is a TextBoxSub
60442>>>>>//     TextBoxSub11 is a TextBoxSub
60442>>>>>//     Cn_Cn_Nomos is a dbFormSub
60442>>>>>//     Cn_Cn_Xora is a dbFormSub
60442>>>>>//     Cn_Cn_Categfpa is a dbComboFormSub
60442>>>>>//     Cn_Cn_Phone is a dbFormSub
60442>>>>>//     Clients_Client_Id is a dbFormSub
60442>>>>>//     Clients_Client_Name is a dbFormSub
60442>>>>>//     Clients_Client_Respons is a dbFormSub
60442>>>>>//     Cn_Yesno is a dbComboFormSub
60442>>>>>//     Cn_Dateeggy is a dbFormSub
60442>>>>>//     dbTabDialogSub1 is a dbTabDialogSub
60442>>>>>//       dbTabPageSub1 is a dbTabPageSub
60442>>>>>//         TextBoxSub36 is a TextBoxSub
60442>>>>>//         Payresp_Presp_Id is a dbFormSub
60442>>>>>//         Constrct_Cnt_Id is a dbFormSub
60442>>>>>//         Salesmen_Sls_Id is a dbFormSub
60442>>>>>//         Mhxanik_Mhx_Id is a dbFormSub
60442>>>>>//         Cn_Cn_Vticket is a dbCheckBoxSub
60442>>>>>//         Payresp_Presp_Name is a dbFormSub
60442>>>>>//         Cn_Polhths_Constr is a dbFormSub
60442>>>>>//         TextBoxSub37 is a TextBoxSub
60442>>>>>//         Constrct_Cnt_Name is a dbFormSub
60442>>>>>//         Cn_Polhths_Mhx is a dbFormSub
60442>>>>>//         Cn_Cn_Distance is a dbFormSub
60442>>>>>//         Cn_Tropos_Metaf is a dbComboFormSub
60442>>>>>//         Cn_Cn_Start_Date is a dbFormSub
60442>>>>>//         TextBoxSub38 is a TextBoxSub
60442>>>>>//         Cn_Cn_End_Date is a dbFormSub
60442>>>>>//         Salesmen_Sls_Name is a dbFormSub
60442>>>>>//         Mhxanik_Mhx_Name is a dbFormSub
60442>>>>>//         TextBoxSub42 is a TextBoxSub
60442>>>>>//         TextBoxSub44 is a TextBoxSub
60442>>>>>//         TextBoxSub45 is a TextBoxSub
60442>>>>>//         TextBoxSub48 is a TextBoxSub
60442>>>>>//         btnPartl is a ButtonSub
60442>>>>>//         TextBoxSub55 is a TextBoxSub
60442>>>>>//         TextBoxSub56 is a TextBoxSub
60442>>>>>//         Cn_Cn_End_Date is a dbFormSub
60442>>>>>//         Textbox3 is a Textbox
60442>>>>>//         Textbox4 is a Textbox
60442>>>>>//         TextBoxSub57 is a TextBoxSub
60442>>>>>//         Cn_Hm_Prot_Fortio is a dbFormSub
60442>>>>>//         Textbox5 is a Textbox
60442>>>>>//         Cn_Mesoskyklos is a dbFormSub
60442>>>>>//         Textbox7 is a Textbox
60442>>>>>//         Cn_Diodia is a dbFormSub
60442>>>>>//         TextBoxSub61 is a TextBoxSub
60442>>>>>//       dbTabPageSub2 is a dbTabPageSub
60442>>>>>//         Btnordh_ is a dbGridSub
60442>>>>>//         The_Table is a dbGrid
60442>>>>>//         Btnordh_Deop_Date is a dbFormSub
60442>>>>>//         Btnordh_Deop_M3ap is a dbFormSub
60442>>>>>//         Btnordh_Deop_Active is a dbCheckBoxSub
60442>>>>>//       dbTabPageSub3 is a dbTabPageSub
60442>>>>>//         Textbox10 is a Textbox
60442>>>>>//         Btnordh_Sxolia is a dbEditSub
60442>>>>>//       dbTabPageSub4 is a dbTabPageSub
60442>>>>>//         Tperga_ is a dbGridSub
60442>>>>>//         ButtonSub1 is a ButtonSub
60442>>>>>//       dbTabPageSub5 is a dbTabPageSub
60442>>>>>//         TextBoxSub50 is a TextBoxSub
60442>>>>>//         TextBoxSub51 is a TextBoxSub
60442>>>>>//         TextBoxSub52 is a TextBoxSub
60442>>>>>//         TextBoxSub53 is a TextBoxSub
60442>>>>>//         Cn_Lic_Number is a dbFormSub
60442>>>>>//         Cn_Lic_Date is a dbFormSub
60442>>>>>//         Cn_Lic_Lixi is a dbFormSub
60442>>>>>//         Cn_Lic_Auth is a dbFormSub
60442>>>>>//         Cn_Cn_Branch is a dbFormSub
60442>>>>>//         Cn_Cn_M3 is a dbFormSub
60442>>>>>//         Cn_Cn_Details is a dbEditSub
60442>>>>>//         TextBoxSub54 is a TextBoxSub
60442>>>>>//         TextBoxSub58 is a TextBoxSub
60442>>>>>//         TextBoxSub59 is a TextBoxSub
60442>>>>>//         TextBoxSub60 is a TextBoxSub
60442>>>>>//       dbTabPageSub6 is a dbTabPageSub
60442>>>>>//         Cnzones_ is a dbGridSub
60442>>>>>//       dbTabPageSub7 is a dbTabPageSub
60442>>>>>//         Cn_Cn_Exfd1 is a dbFormSub
60442>>>>>//         Cn_Cn_Exfd2 is a dbFormSub
60442>>>>>//         Cn_Cn_Exfd5 is a dbFormSub
60442>>>>>//         Cn_Cn_Exfd6 is a dbFormSub
60442>>>>>//         Cn_Cn_Exfd3 is a dbFormSub
60442>>>>>//         Cn_Cn_Exfd4 is a dbFormSub
60442>>>>>//     TextBoxSub30 is a TextBoxSub
60442>>>>>//     TextBoxSub31 is a TextBoxSub
60442>>>>>//     TextBoxSub32 is a TextBoxSub
60442>>>>>//     TextBoxSub33 is a TextBoxSub
60442>>>>>//     TextBoxSub34 is a TextBoxSub
60442>>>>>//     TextBoxSub35 is a TextBoxSub
60442>>>>>//     TextBoxSub43 is a TextBoxSub
60442>>>>>//     frmCityDescr is a FormSub
60442>>>>>//     frmAreaDescr is a FormSub
60442>>>>>//     frmTownDescr is a FormSub
60442>>>>>//     frmCountryDescr is a FormSub
60442>>>>>//     TextBoxSub49 is a TextBoxSub
60442>>>>>//     ButtonSub6 is a ButtonSub
60442>>>>>//     ButtonSub7 is a ButtonSub
60442>>>>>//     ButtonSub8 is a ButtonSub
60442>>>>>//     Textbox2 is a Textbox
60442>>>>>//     Textbox8 is a Textbox
60442>>>>>//     Textbox9 is a Textbox
60442>>>>>//     Cn_Sum_Pct_Tper is a dbFormSub
60442>>>>>//     Cn_Cn_Codematch is a dbFormSub
60442>>>>>
60442>>>>>// Register all objects
60442>>>>>Register_Object Areas_DD
60442>>>>>Register_Object Baxiokat_DD
60442>>>>>Register_Object Branch_DD
60442>>>>>Register_Object Brzones_DD
60442>>>>>Register_Object Btnordd_DD
60442>>>>>Register_Object Btnordh_
60442>>>>>Register_Object Btnordh_DD
60442>>>>>Register_Object Btnordh_Deop_Active
60442>>>>>Register_Object Btnordh_Deop_Date
60442>>>>>Register_Object Btnordh_Deop_M3ap
60442>>>>>Register_Object Btnordh_Sxolia
60442>>>>>Register_Object ButtonSub1
60442>>>>>Register_Object ButtonSub6
60442>>>>>Register_Object ButtonSub7
60442>>>>>Register_Object ButtonSub8
60442>>>>>Register_Object btnPartl
60442>>>>>Register_Object Cities_DD
60442>>>>>Register_Object Clients_Client_Add_No
60442>>>>>Register_Object Clients_Client_Adress
60442>>>>>Register_Object Clients_Client_Id
60442>>>>>Register_Object Clients_Client_Name
60442>>>>>Register_Object Clients_Client_name
60442>>>>>Register_Object Clients_Client_Respons
60442>>>>>Register_Object Clients_Client_Zipcode
60442>>>>>Register_Object Clients_DD
60442>>>>>Register_Object Cn_Cn_Active
60442>>>>>Register_Object Cn_Cn_Area
60442>>>>>Register_Object Cn_Cn_Branch
60442>>>>>Register_Object Cn_Cn_Categfpa
60442>>>>>Register_Object Cn_Cn_Codematch
60442>>>>>Register_Object Cn_Cn_city
60442>>>>>Register_Object Cn_Cn_Details
60442>>>>>Register_Object Cn_Cn_Distance
60442>>>>>Register_Object Cn_Cn_End_Date
60442>>>>>Register_Object Cn_Cn_Exfd1
60442>>>>>Register_Object Cn_Cn_Exfd2
60442>>>>>Register_Object Cn_Cn_Exfd3
60442>>>>>Register_Object Cn_Cn_Exfd4
60442>>>>>Register_Object Cn_Cn_Exfd5
60442>>>>>Register_Object Cn_Cn_Exfd6
60442>>>>>Register_Object Cn_Cn_M3
60442>>>>>Register_Object Cn_Cn_Nomos
60442>>>>>Register_Object Cn_Cn_Phone
60442>>>>>Register_Object Cn_Cn_Start_Date
60442>>>>>Register_Object Cn_Cn_Vticket
60442>>>>>Register_Object Cn_Cn_Xora
60442>>>>>Register_Object Cn_Dateeggy
60442>>>>>Register_Object Cn_DD
60442>>>>>Register_Object Cn_Diodia
60442>>>>>Register_Object Cn_Eidos_Cn
60442>>>>>Register_Object Cn_Hm_Prot_Fortio
60442>>>>>Register_Object Cn_Lic_Auth
60442>>>>>Register_Object Cn_Lic_Date
60442>>>>>Register_Object Cn_Lic_Lixi
60442>>>>>Register_Object Cn_Lic_Number
60442>>>>>Register_Object Cn_Mesoskyklos
60442>>>>>Register_Object Cn_Polhths_Constr
60442>>>>>Register_Object Cn_Polhths_Mhx
60442>>>>>Register_Object Cn_Sum_Pct_Tper
60442>>>>>Register_Object Cn_Tropos_Metaf
60442>>>>>Register_Object Cn_Yesno
60442>>>>>Register_Object Cnzones_
60442>>>>>Register_Object Cnzones_DD
60442>>>>>Register_Object Company_DD
60442>>>>>Register_Object Constrct_Cnt_Id
60442>>>>>Register_Object Constrct_Cnt_Name
60442>>>>>Register_Object Constrct_DD
60442>>>>>Register_Object Country_DD
60442>>>>>Register_Object cn_cn_code
60442>>>>>Register_Object dbTabDialogSub1
60442>>>>>Register_Object dbTabPageSub1
60442>>>>>Register_Object dbTabPageSub2
60442>>>>>Register_Object dbTabPageSub3
60442>>>>>Register_Object dbTabPageSub4
60442>>>>>Register_Object dbTabPageSub5
60442>>>>>Register_Object dbTabPageSub6
60442>>>>>Register_Object dbTabPageSub7
60442>>>>>Register_Object frmAreaDescr
60442>>>>>Register_Object frmCityDescr
60442>>>>>Register_Object frmCountryDescr
60442>>>>>Register_Object frmTownDescr
60442>>>>>Register_Object Mhxanik_DD
60442>>>>>Register_Object Mhxanik_Mhx_Id
60442>>>>>Register_Object Mhxanik_Mhx_Name
60442>>>>>Register_Object Payresp_DD
60442>>>>>Register_Object Payresp_Presp_Id
60442>>>>>Register_Object Payresp_Presp_Name
60442>>>>>Register_Object Salesmen_DD
60442>>>>>Register_Object Salesmen_Sls_Id
60442>>>>>Register_Object Salesmen_Sls_Name
60442>>>>>Register_Object TextBoxSub11
60442>>>>>Register_Object TextBoxSub30
60442>>>>>Register_Object TextBoxSub31
60442>>>>>Register_Object TextBoxSub32
60442>>>>>Register_Object TextBoxSub33
60442>>>>>Register_Object TextBoxSub34
60442>>>>>Register_Object TextBoxSub35
60442>>>>>Register_Object TextBoxSub36
60442>>>>>Register_Object TextBoxSub37
60442>>>>>Register_Object TextBoxSub38
60442>>>>>Register_Object TextBoxSub42
60442>>>>>Register_Object TextBoxSub43
60442>>>>>Register_Object TextBoxSub44
60442>>>>>Register_Object TextBoxSub45
60442>>>>>Register_Object TextBoxSub48
60442>>>>>Register_Object TextBoxSub49
60442>>>>>Register_Object TextBoxSub5
60442>>>>>Register_Object TextBoxSub50
60442>>>>>Register_Object TextBoxSub51
60442>>>>>Register_Object TextBoxSub52
60442>>>>>Register_Object TextBoxSub53
60442>>>>>Register_Object TextBoxSub54
60442>>>>>Register_Object TextBoxSub55
60442>>>>>Register_Object TextBoxSub56
60442>>>>>Register_Object TextBoxSub57
60442>>>>>Register_Object TextBoxSub58
60442>>>>>Register_Object TextBoxSub59
60442>>>>>Register_Object TextBoxSub6
60442>>>>>Register_Object TextBoxSub60
60442>>>>>Register_Object TextBoxSub61
60442>>>>>Register_Object TextBoxSub7
60442>>>>>Register_Object TextBoxSub8
60442>>>>>Register_Object TextBoxSub9
60442>>>>>Register_Object Textbox10
60442>>>>>Register_Object Textbox2
60442>>>>>Register_Object Textbox3
60442>>>>>Register_Object Textbox4
60442>>>>>Register_Object Textbox5
60442>>>>>Register_Object Textbox7
60442>>>>>Register_Object Textbox8
60442>>>>>Register_Object Textbox9
60442>>>>>Register_Object The_Table
60442>>>>>Register_Object Towns_DD
60442>>>>>Register_Object Tperga_
60442>>>>>Register_Object Tperga_DD
60442>>>>>Register_Object V041
60442>>>>>Register_Object Zones_DD
60442>>>>>
60442>>>>>
60442>>>>>//AB/ AppBuild VIEW
60442>>>>>
60442>>>>>
60442>>>>>//AB-StoreTopStart
60442>>>>>use sl041.sl
60442>>>>>Use sl053.sl
60442>>>>>USE SL22S.SL
60442>>>>>use v193.vw
INCLUDING FILE: V193.VW
60442>>>>>>>//AB/ Project V193:DEOP pelaton-ergon
60442>>>>>>>//AB/ Object prj is a View_Project
60442>>>>>>>//AB/     Set ProjectName to "V193:DEOP pelaton-ergon"
60442>>>>>>>//AB/     Set ProjectFileName to "V193.vw"
60442>>>>>>>//AB/     Set GenerateFileName to "V193.vw"
60442>>>>>>>
60442>>>>>>>// Project Object Structure
60442>>>>>>>//   V193 is a dbViewSub
60442>>>>>>>//     Baxiokat_DD is a DataDictionary
60442>>>>>>>//     Country_DD is a DataDictionary
60442>>>>>>>//     Towns_DD is a DataDictionary
60442>>>>>>>//     Cities_DD is a DataDictionary
60442>>>>>>>//     Areas_DD is a DataDictionary
60442>>>>>>>//     Payresp_DD is a DataDictionary
60442>>>>>>>//     Clients_DD is a DataDictionary
60442>>>>>>>//     Constrct_DD is a DataDictionary
60442>>>>>>>//     Salesmen_DD is a DataDictionary
60442>>>>>>>//     Mhxanik_DD is a DataDictionary
60442>>>>>>>//     Cn_DD is a DataDictionary
60442>>>>>>>//     Tperga_DD is a DataDictionary
60442>>>>>>>//     Btnordh_DD is a DataDictionary
60442>>>>>>>//     Btnordd_DD is a DataDictionary
60442>>>>>>>//     Container1 is a dbContainer3d
60442>>>>>>>//       TextBoxSub5 is a TextBoxSub
60442>>>>>>>//       TextBoxSub6 is a TextBoxSub
60442>>>>>>>//       Btnordh_Client_Id is a dbFormSub
60442>>>>>>>//       Btnordh_Cn_Code is a dbFormSub
60442>>>>>>>//       TextBoxSub9 is a TextBoxSub
60442>>>>>>>//       Btnordh_Aa_Deop is a dbFormSub
60442>>>>>>>//       Btnordh_Deop_Date is a dbFormSub
60442>>>>>>>//       Btnordh_Deop_Lhxh is a dbFormSub
60442>>>>>>>//       Btnordh_Eleiph is a dbFormSub
60442>>>>>>>//       Btnordh_Velxr is a dbComboFormSub
60442>>>>>>>//       ButtonSub1 is a ButtonSub
60442>>>>>>>//       Btnordh_Deop_Active is a dbCheckBoxSub
60442>>>>>>>//       Clients_Client_Name is a dbFormSub
60442>>>>>>>//       Cn_Cn_Descr is a dbFormSub
60442>>>>>>>//       Btnordh_Locked is a dbCheckBoxSub
60442>>>>>>>//       TextBoxSub10 is a TextBoxSub
60442>>>>>>>//       Btnordh_Sxolia is a dbEditSub
60442>>>>>>>//       TextBoxSub11 is a TextBoxSub
60442>>>>>>>//       Payresp_Presp_Id is a dbFormSub
60442>>>>>>>//       Payresp_Presp_Name is a dbFormSub
60442>>>>>>>//       TextBoxSub12 is a TextBoxSub
60442>>>>>>>//       ButtonSub2 is a ButtonSub
60442>>>>>>>//       TextBoxSub13 is a TextBoxSub
60442>>>>>>>//       ButtonSub3 is a ButtonSub
60442>>>>>>>//       Btnactive is a ButtonSub
60442>>>>>>>//       TextBoxSub14 is a TextBoxSub
60442>>>>>>>//       Btncopy is a ButtonSub
60442>>>>>>>//       TextBoxSub15 is a TextBoxSub
60442>>>>>>>//       Textbox1 is a Textbox
60442>>>>>>>//       Textbox2 is a Textbox
60442>>>>>>>//       Btnordh_Statero is a dbCheckBoxSub
60442>>>>>>>//       ButtonSub4 is a ButtonSub
60442>>>>>>>//       ButtonSub5 is a ButtonSub
60442>>>>>>>//       Btnektyp is a ButtonSub
60442>>>>>>>//       ButtonSub6 is a ButtonSub
60442>>>>>>>//     The_Table is a dbGrid
60442>>>>>>>//     TextBoxSub7 is a TextBoxSub
60442>>>>>>>//     TextBoxSub8 is a TextBoxSub
60442>>>>>>>//     item_descr is a FormSub
60442>>>>>>>//     TextBoxSub17 is a TextBoxSub
60442>>>>>>>//     Btnordh_Date_Create is a dbFormSub
60442>>>>>>>//     Tperga_ is a dbGridSub
60442>>>>>>>//     TextBoxSub18 is a TextBoxSub
60442>>>>>>>//     TextBoxSub19 is a TextBoxSub
60442>>>>>>>//     Clients_Hpso is a dbFormSub
60442>>>>>>>//     TextBoxSub20 is a TextBoxSub
60442>>>>>>>//     Clients_Hpal is a dbFormSub
60442>>>>>>>
60442>>>>>>>// Register all objects
60442>>>>>>>Register_Object Areas_DD
60442>>>>>>>Register_Object Baxiokat_DD
60442>>>>>>>Register_Object Btnactive
60442>>>>>>>Register_Object Btncopy
60442>>>>>>>Register_Object Btnektyp
60442>>>>>>>Register_Object Btnordd_DD
60442>>>>>>>Register_Object Btnordh_Aa_Deop
60442>>>>>>>Register_Object Btnordh_Client_Id
60442>>>>>>>Register_Object Btnordh_Cn_Code
60442>>>>>>>Register_Object Btnordh_Date_Create
60442>>>>>>>Register_Object Btnordh_DD
60442>>>>>>>Register_Object Btnordh_Deop_Active
60442>>>>>>>Register_Object Btnordh_Deop_Date
60442>>>>>>>Register_Object Btnordh_Deop_Lhxh
60442>>>>>>>Register_Object Btnordh_Eleiph
60442>>>>>>>Register_Object Btnordh_Locked
60442>>>>>>>Register_Object Btnordh_Statero
60442>>>>>>>Register_Object Btnordh_Sxolia
60442>>>>>>>Register_Object Btnordh_Velxr
60442>>>>>>>Register_Object ButtonSub1
60442>>>>>>>Register_Object ButtonSub2
60442>>>>>>>Register_Object ButtonSub3
60442>>>>>>>Register_Object ButtonSub4
60442>>>>>>>Register_Object ButtonSub5
60442>>>>>>>Register_Object ButtonSub6
60442>>>>>>>Register_Object Cities_DD
60442>>>>>>>Register_Object Clients_Client_Name
60442>>>>>>>Register_Object Clients_DD
60442>>>>>>>Register_Object Clients_Hpal
60442>>>>>>>Register_Object Clients_Hpso
60442>>>>>>>Register_Object Cn_Cn_Descr
60442>>>>>>>Register_Object Cn_DD
60442>>>>>>>Register_Object Constrct_DD
60442>>>>>>>Register_Object Container1
60442>>>>>>>Register_Object Country_DD
60442>>>>>>>Register_Object item_descr
60442>>>>>>>Register_Object Mhxanik_DD
60442>>>>>>>Register_Object Payresp_DD
60442>>>>>>>Register_Object Payresp_Presp_Id
60442>>>>>>>Register_Object Payresp_Presp_Name
60442>>>>>>>Register_Object Salesmen_DD
60442>>>>>>>Register_Object TextBoxSub10
60442>>>>>>>Register_Object TextBoxSub11
60442>>>>>>>Register_Object TextBoxSub12
60442>>>>>>>Register_Object TextBoxSub13
60442>>>>>>>Register_Object TextBoxSub14
60442>>>>>>>Register_Object TextBoxSub15
60442>>>>>>>Register_Object TextBoxSub17
60442>>>>>>>Register_Object TextBoxSub18
60442>>>>>>>Register_Object TextBoxSub19
60442>>>>>>>Register_Object TextBoxSub20
60442>>>>>>>Register_Object TextBoxSub5
60442>>>>>>>Register_Object TextBoxSub6
60442>>>>>>>Register_Object TextBoxSub7
60442>>>>>>>Register_Object TextBoxSub8
60442>>>>>>>Register_Object TextBoxSub9
60442>>>>>>>Register_Object Textbox1
60442>>>>>>>Register_Object Textbox2
60442>>>>>>>Register_Object The_Table
60442>>>>>>>Register_Object Towns_DD
60442>>>>>>>Register_Object Tperga_
60442>>>>>>>Register_Object Tperga_DD
60442>>>>>>>Register_Object V193
60442>>>>>>>
60442>>>>>>>
60442>>>>>>>//AB/ AppBuild VIEW
60442>>>>>>>
60442>>>>>>>
60442>>>>>>>//AB-StoreTopStart
60442>>>>>>>use btnordh.sl
60442>>>>>>>open item
60444>>>>>>>open iteml
60446>>>>>>>Use ItemL.DD
INCLUDING FILE: ITEML.DD
60446>>>>>>>>>//DDB-FileStart
60446>>>>>>>>>//DDB-HeaderStart
60446>>>>>>>>>
60446>>>>>>>>>// File Name : ITEML.DD
60446>>>>>>>>>// Class Name: Iteml_DataDictionary
60446>>>>>>>>>// Revision  : 2
60446>>>>>>>>>// Version   : 2
60446>>>>>>>>>
60446>>>>>>>>>Use  Windows           // Basic Definitions
60446>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
60446>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
60446>>>>>>>>>
60446>>>>>>>>>Open Iteml
60448>>>>>>>>>Open Units
60450>>>>>>>>>Open Witemkat
60452>>>>>>>>>Open Fpa
60454>>>>>>>>>
60454>>>>>>>>>//DDB-HeaderEnd
60454>>>>>>>>>
60454>>>>>>>>>open item
60456>>>>>>>>>
60456>>>>>>>>>Set_attribute  DF_FILE_ALIAS of iteml.File_number to DF_FILE_IS_ALIAS
60459>>>>>>>>>Set_attribute  DF_FILE_ALIAS of item.File_number  to DF_FILE_IS_MASTER
60462>>>>>>>>>
60462>>>>>>>>>// clear the relationship in the alias file
60462>>>>>>>>>Set_relate iteml.units_recr to |FN0,0
60463>>>>>>>>>>
60463>>>>>>>>>Set_relate iteml.witemkat_recr to |FN0,0
60464>>>>>>>>>>
60464>>>>>>>>>Set_relate iteml.fpa_pososto to |FN0,0
60465>>>>>>>>>>
60465>>>>>>>>>
60465>>>>>>>>>Class Iteml_DataDictionary  is a DataDictionary_Sec
60466>>>>>>>>>
60466>>>>>>>>>    // Define_Fields:
60466>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
60466>>>>>>>>>
60466>>>>>>>>>    Procedure Define_Fields
60467>>>>>>>>>        Forward Send Define_Fields
60469>>>>>>>>>        //DDB-Generated-Code-Location
60469>>>>>>>>>        //DDB-DefineFieldStart
60469>>>>>>>>>
60469>>>>>>>>>        Set Main_File            To Iteml.File_Number
60470>>>>>>>>>        Set Cascade_Delete_State To FALSE
60471>>>>>>>>>
60471>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
60472>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
60473>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
60474>>>>>>>>>
60474>>>>>>>>>        // Parent (Server) file structure...............
60474>>>>>>>>>        Send Add_Server_File  Units.File_Number
60475>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
60476>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
60477>>>>>>>>>
60477>>>>>>>>>        // Field-based properties.......................
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Units_Code
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Units_Recr
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Witemkat_Code
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Witemkat_Recr
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Code
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Rec0
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Descr
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Recr
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Fpa_Pososto
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Qual
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Wapokat_Code
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Analysh
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Item_Orio
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Codeglpol
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Codeglago
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Link1
60477>>>>>>>>>
60477>>>>>>>>>        // Iteml.Link2
60477>>>>>>>>>
60477>>>>>>>>>        //DDB-DefineFieldEnd
60477>>>>>>>>>    End_Procedure    // Define_Fields
60478>>>>>>>>>
60478>>>>>>>>>    // Field_Defaults:
60478>>>>>>>>>    // This procedure is used to establish default field values.
60478>>>>>>>>>
60478>>>>>>>>>    Procedure Field_Defaults
60479>>>>>>>>>        Forward Send Field_Defaults
60481>>>>>>>>>        //DDB-Generated-Code-Location
60481>>>>>>>>>        //DDB-FieldDefaultStart
60481>>>>>>>>>        //DDB-FieldDefaultEnd
60481>>>>>>>>>    End_Procedure    // Field_Defaults
60482>>>>>>>>>
60482>>>>>>>>>End_Class    // Iteml_DataDictionary
60483>>>>>>>>>//DDB-FileEnd
60483>>>>>>>open BtnordhL
INCLUDING FILE: BTNORDHL.FD
60485>>>>>>>open BtnorddL
INCLUDING FILE: BTNORDDL.FD
60487>>>>>>>Use BtnorddL.DD
INCLUDING FILE: BTNORDDL.DD
60487>>>>>>>>>//DDB-FileStart
60487>>>>>>>>>//DDB-HeaderStart
60487>>>>>>>>>
60487>>>>>>>>>// File Name : BTNORDDL.DD
60487>>>>>>>>>// Class Name: Btnorddl_DataDictionary
60487>>>>>>>>>// Revision  : 0
60487>>>>>>>>>// Version   : 2
60487>>>>>>>>>
60487>>>>>>>>>Use  Windows           // Basic Definitions
60487>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
60487>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
60487>>>>>>>>>
60487>>>>>>>>>Open Btnorddl
60489>>>>>>>>>Open Btnordh
60491>>>>>>>>>
60491>>>>>>>>>//DDB-HeaderEnd
60491>>>>>>>>>open Btnordd
60493>>>>>>>>>
60493>>>>>>>>>Set_attribute  DF_FILE_ALIAS of BtnorddL.File_number to DF_FILE_IS_ALIAS
60496>>>>>>>>>Set_attribute  DF_FILE_ALIAS of Btnordd.File_number  to DF_FILE_IS_MASTER
60499>>>>>>>>>
60499>>>>>>>>>// clear the relationship in the alias file
60499>>>>>>>>>Set_relate BtnorddL.btnordh_recr to |FN0,0
60500>>>>>>>>>>
60500>>>>>>>>>Class Btnorddl_DataDictionary  is a DataDictionary_sec
60501>>>>>>>>>
60501>>>>>>>>>    // Define_Fields:
60501>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
60501>>>>>>>>>
60501>>>>>>>>>    Procedure Define_Fields
60502>>>>>>>>>        Forward Send Define_Fields
60504>>>>>>>>>        //DDB-Generated-Code-Location
60504>>>>>>>>>        //DDB-DefineFieldStart
60504>>>>>>>>>
60504>>>>>>>>>        Set Main_File            To Btnorddl.File_Number
60505>>>>>>>>>
60505>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
60506>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
60507>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
60508>>>>>>>>>
60508>>>>>>>>>        // Parent (Server) file structure...............
60508>>>>>>>>>        Send Add_Server_File  Btnordh.File_Number
60509>>>>>>>>>
60509>>>>>>>>>        // Field-based properties.......................
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Btnordh_Recr
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vitem
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vitem_Descr
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vqual
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vqty
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vunitprice
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vdisc
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vprice
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vkatish
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vxrm3
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vpagiaxrm3
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vpagiaxrprice
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vanopagia
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vsthsimo
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Veleipes
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vorderbt
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vclient_Id
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vcn_Code
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vactive
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Deop_Date
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Velxr
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Arxh_Date
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vdiscposo
60509>>>>>>>>>
60509>>>>>>>>>        // Btnorddl.Vqtyused
60509>>>>>>>>>
60509>>>>>>>>>        //DDB-DefineFieldEnd
60509>>>>>>>>>    End_Procedure    // Define_Fields
60510>>>>>>>>>
60510>>>>>>>>>    // Field_Defaults:
60510>>>>>>>>>    // This procedure is used to establish default field values.
60510>>>>>>>>>
60510>>>>>>>>>    Procedure Field_Defaults
60511>>>>>>>>>        Forward Send Field_Defaults
60513>>>>>>>>>        //DDB-Generated-Code-Location
60513>>>>>>>>>        //DDB-FieldDefaultStart
60513>>>>>>>>>        //DDB-FieldDefaultEnd
60513>>>>>>>>>    End_Procedure    // Field_Defaults
60514>>>>>>>>>
60514>>>>>>>>>End_Class    // Btnorddl_DataDictionary
60515>>>>>>>>>//DDB-FileEnd
60515>>>>>>>use v193a.vw
INCLUDING FILE: V193A.VW
60515>>>>>>>>>//AB/ Project v193a:deop/pelath
60515>>>>>>>>>//AB/     Object prj is a View_Project
60515>>>>>>>>>//AB/         Set ProjectName to "v193a:deop/pelath"
60515>>>>>>>>>//AB/         Set ProjectFileName to "v193a.VW"
60515>>>>>>>>>
60515>>>>>>>>>// Project Object Structure
60515>>>>>>>>>//   v193a is a dbViewSub
60515>>>>>>>>>//     Btnordd_DD is a DataDictionary
60515>>>>>>>>>//     The_Table is a dbGrid
60515>>>>>>>>>//     Container1 is a dbContainer3d
60515>>>>>>>>>//       TextBoxSub2 is a TextBoxSub
60515>>>>>>>>>//       TextBoxSub3 is a TextBoxSub
60515>>>>>>>>>//       clients_code is a FormSub
60515>>>>>>>>>//       client_name is a FormSub
60515>>>>>>>>>//       cons_code is a FormSub
60515>>>>>>>>>//       cons_name is a FormSub
60515>>>>>>>>>//       RadioGroupSub1 is a RadioGroupSub
60515>>>>>>>>>//         Radio1 is a RadioSub
60515>>>>>>>>>//         Radio2 is a RadioSub
60515>>>>>>>>>//         Radio3 is a RadioSub
60515>>>>>>>>>
60515>>>>>>>>>// Register all objects
60515>>>>>>>>>Register_Object Btnordd_DD
60515>>>>>>>>>Register_Object Container1
60515>>>>>>>>>Register_Object client_name
60515>>>>>>>>>Register_Object clients_code
60515>>>>>>>>>Register_Object cons_code
60515>>>>>>>>>Register_Object cons_name
60515>>>>>>>>>Register_Object Radio1
60515>>>>>>>>>Register_Object Radio2
60515>>>>>>>>>Register_Object Radio3
60515>>>>>>>>>Register_Object RadioGroupSub1
60515>>>>>>>>>Register_Object TextBoxSub2
60515>>>>>>>>>Register_Object TextBoxSub3
60515>>>>>>>>>Register_Object The_Table
60515>>>>>>>>>Register_Object v193a
60515>>>>>>>>>
60515>>>>>>>>>
60515>>>>>>>>>//AB/     AppBuild VIEW
60515>>>>>>>>>
60515>>>>>>>>>    //AB-IgnoreStart
60515>>>>>>>>>
60515>>>>>>>>>    Use dbView.Sub
60515>>>>>>>>>    Use DFAllEnt.pkg
60515>>>>>>>>>    Use Txtbox.Sub
60515>>>>>>>>>    Use Form.Sub
60515>>>>>>>>>    Use Rgroup.Sub
60515>>>>>>>>>    Use Radio.Sub
60515>>>>>>>>>
60515>>>>>>>>>    Use BTNORDD.DD
60515>>>>>>>>>    
60515>>>>>>>>>    //AB-IgnoreEnd
60515>>>>>>>>>
60515>>>>>>>>>    ACTIVATE_VIEW Activate_v193a FOR v193a
60519>>>>>>>>>
60519>>>>>>>>>    Object v193a is a dbViewSub
60521>>>>>>>>>
60521>>>>>>>>>        //AB-StoreTopStart
60521>>>>>>>>>        PROPERTY string PSCLIENT      public ''
60523>>>>>>>>>        property string pscn   public ''
60525>>>>>>>>>        property integer piepil public 0
60527>>>>>>>>>        function fsqual string code returns string
60529>>>>>>>>>             string squal
60530>>>>>>>>>             clear iteml
60531>>>>>>>>>             move code to iteml.item_code
60532>>>>>>>>>             find eq iteml by index.5
60533>>>>>>>>>>
60533>>>>>>>>>             move iteml.item_qual to squal
60534>>>>>>>>>             function_return squal
60535>>>>>>>>>        end_Function
60536>>>>>>>>>        
60536>>>>>>>>>        Procedure Constrain_The_Records
60538>>>>>>>>>            string sorder scn sclient
60539>>>>>>>>>            Get Value of (clients_code(container1(current_object)))     to sclient
60540>>>>>>>>>            Get Value of (cons_code(container1(current_object)))        to scn
60541>>>>>>>>>            set pscn                       to scn
60542>>>>>>>>>            set psclient                   to sclient
60543>>>>>>>>>            Send Rebuild_Constraints       to btnordD_dd
60544>>>>>>>>>            send beginning_of_data         to the_table true
60545>>>>>>>>>        End_Procedure
60546>>>>>>>>>        
60546>>>>>>>>>        //AB-StoreTopEnd
60546>>>>>>>>>
60546>>>>>>>>>        Set Label to "€¤á¢¬©ž œ ›é¤  œ¢á«ž-„¨š¦¬  ƒ.„.Ž."
60547>>>>>>>>>        Set Size to 282 520
60548>>>>>>>>>        Set Location to 6 6
60549>>>>>>>>>
60549>>>>>>>>>        //AB-DDOStart
60549>>>>>>>>>
60549>>>>>>>>>        Object Btnordd_DD is a Btnordd_DataDictionary
60551>>>>>>>>>
60551>>>>>>>>>            //AB-StoreStart
60551>>>>>>>>>            Begin_Constraints
60553>>>>>>>>>                 string  sclient scn
60554>>>>>>>>>                 get psclient        to sclient
60555>>>>>>>>>                 get pscn            to scn
60556>>>>>>>>>                 if (psclient(self) <> '');                    constrain btnordd.vclient_id  eq sclient
60560>>>>>>>>>                 if (pscn(self) <> '');                    constrain btnordD.vcn_code    eq scn
60564>>>>>>>>>                 if (piepil(self)=1) constrain btnordd.vactive eq 0
60568>>>>>>>>>                 else if (piepil(self)=2) constrain btnordd.vactive ne 0
60573>>>>>>>>>            End_Constraints
60576>>>>>>>>>            
60576>>>>>>>>>            
60576>>>>>>>>>            
60576>>>>>>>>>            //AB-StoreEnd
60576>>>>>>>>>
60576>>>>>>>>>        End_Object    // Btnordd_DD
60577>>>>>>>>>
60577>>>>>>>>>        Set Main_DD to (Btnordd_DD(self))
60578>>>>>>>>>        Set Server to (Btnordd_DD(self))
60579>>>>>>>>>
60579>>>>>>>>>        //AB-DDOEnd
60579>>>>>>>>>
60579>>>>>>>>>        Object The_Table is a dbGrid
60581>>>>>>>>>            Set Main_File to Btnordd.File_Number
60582>>>>>>>>>            Set Size to 202 506
60583>>>>>>>>>            Set Location to 62 3
60584>>>>>>>>>            Set Wrap_State to TRUE
60585>>>>>>>>>
60585>>>>>>>>>            Begin_Row
60588>>>>>>>>>                Entry_Item Btnordd.Recnum
60589>>>>>>>>>                Entry_Item Btnordd.Vorderbt
60590>>>>>>>>>                Entry_Item Btnordd.Vitem
60591>>>>>>>>>                Entry_Item (fsqual(self,btnordd.vitem))
60592>>>>>>>>>                Entry_Item Btnordd.Vqty
60593>>>>>>>>>                Entry_Item Btnordd.Vprice
60594>>>>>>>>>                Entry_Item Btnordd.Vkatish
60595>>>>>>>>>                Entry_Item Btnordd.Vxrm3
60596>>>>>>>>>                Entry_Item Btnordd.Vpagiaxrm3
60597>>>>>>>>>                Entry_Item Btnordd.Vpagiaxrprice
60598>>>>>>>>>                Entry_Item Btnordd.Arxh_date
60599>>>>>>>>>                Entry_Item Btnordd.Deop_date
60600>>>>>>>>>            End_Row
60605>>>>>>>>>
60605>>>>>>>>>            Set Form_Width    item 0 to 0
60606>>>>>>>>>            Set Header_Label  item 0 to ""
60607>>>>>>>>>            
60607>>>>>>>>>            Set Form_Width    item 1 to 64
60608>>>>>>>>>            Set Header_Label  item 1 to "‰à›. ƒ.„.Ž."
60609>>>>>>>>>            
60609>>>>>>>>>            Set Form_Width    item 2 to 54
60610>>>>>>>>>            Set Header_Label  item 2 to "‰à›.„å›¦¬ª"
60611>>>>>>>>>            
60611>>>>>>>>>            Set Form_Width    item 3 to 40
60612>>>>>>>>>            Set Header_Label  item 3 to "¦ æ«"
60613>>>>>>>>>            
60613>>>>>>>>>            Set Form_Width    item 4 to 40
60614>>>>>>>>>            Set Header_Label  item 4 to "¦©æ«"
60615>>>>>>>>>            
60615>>>>>>>>>            Set Form_Width    item 5 to 45
60616>>>>>>>>>            Set Header_Label  item 5 to "€¥å˜"
60617>>>>>>>>>            
60617>>>>>>>>>            Set Form_Width    item 6 to 32
60618>>>>>>>>>            Set Header_Label  item 6 to "‰áŸ ©ž"
60619>>>>>>>>>            
60619>>>>>>>>>            Set Form_Width    item 7 to 32
60620>>>>>>>>>            Set Header_Label  item 7 to "•¨/m3"
60621>>>>>>>>>            Set Column_Checkbox_State  item 7 to True
60622>>>>>>>>>            
60622>>>>>>>>>            Set Form_Width    item 8 to 48
60623>>>>>>>>>            Set Header_Label  item 8 to "˜š.•¨/m3"
60624>>>>>>>>>            
60624>>>>>>>>>            Set Form_Width    item 9 to 54
60625>>>>>>>>>            Set Header_Label  item 9 to "˜š.’ £ã •¨."
60626>>>>>>>>>            
60626>>>>>>>>>            Set Form_Width    item 10 to 46
60627>>>>>>>>>            Set Header_Label  item 10 to "†£.„¤˜¨¥"
60628>>>>>>>>>            
60628>>>>>>>>>            Set Form_Width    item 11 to 46
60629>>>>>>>>>            Set Header_Label  item 11 to "†£.Šã¥žª"
60630>>>>>>>>>            
60630>>>>>>>>>
60630>>>>>>>>>            //AB-StoreStart
60630>>>>>>>>>            set read_only_state to true
60631>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
60632>>>>>>>>>            Set Column_Option Item 5 to NoEnter True
60633>>>>>>>>>            set currentrowcolor to 11468799
60634>>>>>>>>>            set currentcellcolor to 11468799
60635>>>>>>>>>            
60635>>>>>>>>>            Procedure End_Construct_Object
60637>>>>>>>>>                Integer iDecimals
60638>>>>>>>>>                Forward Send End_Construct_Object
60640>>>>>>>>>                Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
60641>>>>>>>>>                Set Points Item 4 to 2
60642>>>>>>>>>                Set Points Item 5 to iDecimals
60643>>>>>>>>>             //   Set Points Item 6 to iDecimals
60643>>>>>>>>>                Set Points Item 9 to iDecimals
60644>>>>>>>>>                Set Points Item 8 to iDecimals
60645>>>>>>>>>                Set Numeric_Mask  Item 5 to 14 iDecimals ' ,*'
60646>>>>>>>>>             //   Set Numeric_Mask  Item 6 to 14 iDecimals ' ,*'
60646>>>>>>>>>                Set Numeric_Mask  Item 9 to 14 iDecimals ' ,*'
60647>>>>>>>>>                Set Numeric_Mask  Item 8 to 14 iDecimals ' ,*'
60648>>>>>>>>>            End_Procedure
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            
60649>>>>>>>>>            //AB-StoreEnd
60649>>>>>>>>>
60649>>>>>>>>>        End_Object    // The_Table
60650>>>>>>>>>
60650>>>>>>>>>        Object Container1 is a dbContainer3d
60652>>>>>>>>>            Set Border_Style to Border_Normal
60653>>>>>>>>>            Set Size to 57 507
60654>>>>>>>>>            Set Location to 2 1
60655>>>>>>>>>            Object TextBoxSub2 is a TextBoxSub
60657>>>>>>>>>                Set Label to "‰à›.œ¢á«ž"
60658>>>>>>>>>                Set Location to 3 5
60659>>>>>>>>>                Set Size to 10 45
60660>>>>>>>>>                Set TypeFace to "MS Sans Serif"
60661>>>>>>>>>            End_Object    // TextBoxSub2
60662>>>>>>>>>
60662>>>>>>>>>            Object TextBoxSub3 is a TextBoxSub
60664>>>>>>>>>                Set Label to "‰à›.„¨š¦¬"
60665>>>>>>>>>                Set Location to 17 5
60666>>>>>>>>>                Set Size to 10 45
60667>>>>>>>>>                Set TypeFace to "MS Sans Serif"
60668>>>>>>>>>            End_Object    // TextBoxSub3
60669>>>>>>>>>
60669>>>>>>>>>            Object clients_code is a FormSub
60671>>>>>>>>>                Set Size to 13 128
60672>>>>>>>>>                Set Location to 2 63
60673>>>>>>>>>                Set Label_Col_Offset to 2
60674>>>>>>>>>                Set Prompt_Button_Mode to pb_PromptOn
60675>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
60676>>>>>>>>>
60676>>>>>>>>>                //AB-StoreStart
60676>>>>>>>>>                procedure onchange
60678>>>>>>>>>                    string sclient sname
60679>>>>>>>>>                    get value of (clients_code(self)) item 0 to sclient
60680>>>>>>>>>                    Move (fsclient(Self,sclient)) to sname
60681>>>>>>>>>                    set value of (client_name(self)) to sname
60682>>>>>>>>>                
60682>>>>>>>>>                end_procedure
60683>>>>>>>>>                
60683>>>>>>>>>                Set Prompt_Object to (sl100(Current_object))
60684>>>>>>>>>                Procedure Prompt_Callback integer hPrompt
60686>>>>>>>>>                    Local String lsValue
60687>>>>>>>>>                    set Export_Column of hPrompt to 0
60688>>>>>>>>>                    Set Initial_Column of hPrompt to 0
60689>>>>>>>>>                end_procedure
60690>>>>>>>>>                
60690>>>>>>>>>                Procedure Prompt
60692>>>>>>>>>                    Set psModule Of (sl100(Self)) to '01'
60693>>>>>>>>>                    Forward Send Prompt
60695>>>>>>>>>                End_Procedure
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                
60696>>>>>>>>>                //AB-StoreEnd
60696>>>>>>>>>
60696>>>>>>>>>            End_Object    // clients_code
60697>>>>>>>>>
60697>>>>>>>>>            Object client_name is a FormSub
60699>>>>>>>>>                Set Size to 13 305
60700>>>>>>>>>                Set Location to 2 197
60701>>>>>>>>>                Set Label_Col_Offset to 2
60702>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
60703>>>>>>>>>
60703>>>>>>>>>                //AB-StoreStart
60703>>>>>>>>>                set enabled_state to false
60704>>>>>>>>>                //AB-StoreEnd
60704>>>>>>>>>
60704>>>>>>>>>            End_Object    // client_name
60705>>>>>>>>>
60705>>>>>>>>>            Object cons_code is a FormSub
60707>>>>>>>>>                Set Size to 13 128
60708>>>>>>>>>                Set Location to 17 63
60709>>>>>>>>>                Set Label_Col_Offset to 2
60710>>>>>>>>>                Set Prompt_Button_Mode to pb_PromptOn
60711>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
60712>>>>>>>>>
60712>>>>>>>>>                //AB-StoreStart
60712>>>>>>>>>                procedure onchange
60714>>>>>>>>>                    string scons sdescr
60715>>>>>>>>>                    get value of (cons_code(self)) item 0 to scons
60716>>>>>>>>>                    move (fsCNDescr(Self,scons)) to sdescr
60717>>>>>>>>>                    set value of (cons_name(self)) to sdescr
60718>>>>>>>>>                end_procedure
60719>>>>>>>>>                
60719>>>>>>>>>                Set Prompt_Object to (sl041(Current_object))
60720>>>>>>>>>                Procedure Prompt
60722>>>>>>>>>                    string scode
60723>>>>>>>>>                    get value of (clients_code(container1(self))) to scode
60724>>>>>>>>>                    if (scode<>'') set fragmaclient_id of (sl041(self)) to scode
60727>>>>>>>>>                    forward send prompt
60729>>>>>>>>>                    set fragmaclient_id of (sl041(self)) to ''
60730>>>>>>>>>                end_procedure
60731>>>>>>>>>                
60731>>>>>>>>>                
60731>>>>>>>>>                
60731>>>>>>>>>                
60731>>>>>>>>>                
60731>>>>>>>>>                //AB-StoreEnd
60731>>>>>>>>>
60731>>>>>>>>>            End_Object    // cons_code
60732>>>>>>>>>
60732>>>>>>>>>            Object cons_name is a FormSub
60734>>>>>>>>>                Set Size to 13 305
60735>>>>>>>>>                Set Location to 18 197
60736>>>>>>>>>                Set Label_Col_Offset to 2
60737>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
60738>>>>>>>>>
60738>>>>>>>>>                //AB-StoreStart
60738>>>>>>>>>                set enabled_state to false
60739>>>>>>>>>                //AB-StoreEnd
60739>>>>>>>>>
60739>>>>>>>>>            End_Object    // cons_name
60740>>>>>>>>>
60740>>>>>>>>>            Object RadioGroupSub1 is a RadioGroupSub
60742>>>>>>>>>                Set Size to 20 207
60743>>>>>>>>>                Set Location to 32 63
60744>>>>>>>>>                Object Radio1 is a RadioSub
60746>>>>>>>>>                    Set Label to "î¢˜ «˜ œå›ž"
60747>>>>>>>>>                    Set Size to 10 57
60748>>>>>>>>>                    Set Location to 7 3
60749>>>>>>>>>                End_Object    // Radio1
60750>>>>>>>>>
60750>>>>>>>>>                Object Radio2 is a RadioSub
60752>>>>>>>>>                    Set Label to "„¤œ¨šá"
60753>>>>>>>>>                    Set Size to 10 49
60754>>>>>>>>>                    Set Location to 7 70
60755>>>>>>>>>                End_Object    // Radio2
60756>>>>>>>>>
60756>>>>>>>>>                Object Radio3 is a RadioSub
60758>>>>>>>>>                    Set Label to "€¤œ¤œ¨šá"
60759>>>>>>>>>                    Set Size to 10 55
60760>>>>>>>>>                    Set Location to 7 135
60761>>>>>>>>>                End_Object    // Radio3
60762>>>>>>>>>
60762>>>>>>>>>
60762>>>>>>>>>                //AB-StoreStart
60762>>>>>>>>>                                        
60762>>>>>>>>>                Procedure Notify_Select_State integer iToItem integer iFromItem
60764>>>>>>>>>                     IF itoitem eq 0 set piepil to 0
60767>>>>>>>>>                     else if itoitem eq 1 set piepil to 1
60771>>>>>>>>>                     else if itoitem eq 2 set piepil to 2
60775>>>>>>>>>                     send Constrain_The_Records
60776>>>>>>>>>                End_Procedure
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                
60777>>>>>>>>>                //AB-StoreEnd
60777>>>>>>>>>
60777>>>>>>>>>            End_Object    // RadioGroupSub1
60778>>>>>>>>>
60778>>>>>>>>>        End_Object    // Container1
60779>>>>>>>>>
60779>>>>>>>>>
60779>>>>>>>>>        //AB-StoreStart
60779>>>>>>>>>                
60779>>>>>>>>>        Procedure Activate_View Returns Integer
60781>>>>>>>>>            String  sModule sIsClient sIsPromhtheyths
60782>>>>>>>>>            Integer rVal iCurRec
60782>>>>>>>>>            if (pscn(self)<>'') set value of (cons_code(container1(self))) to (pscn(self))
60785>>>>>>>>>            if (psclient(self)<>'') set value of (clients_code(container1(self))) to (psclient(self))
60788>>>>>>>>>            Forward Get Msg_Activate_View to rVal
60790>>>>>>>>>            Procedure_Return rVal
60791>>>>>>>>>        End_Procedure
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        
60792>>>>>>>>>        //AB-StoreEnd
60792>>>>>>>>>
60792>>>>>>>>>    End_Object    // v193a
60793>>>>>>>>>
60793>>>>>>>>>//AB/     End_Object    // prj
60793>>>>>>>use r193_1.rv
INCLUDING FILE: R193_1.RV
60793>>>>>>>>>//AB/ Project r193_1:ektyposh deop
60793>>>>>>>>>//AB/ Object prj is a Report_Project
60793>>>>>>>>>//AB/     Set ProjectName to "r193_1:ektyposh deop"
60793>>>>>>>>>//AB/     Set ProjectFileName to "R193_1.RV"
60793>>>>>>>>>
60793>>>>>>>>>// Project Object Structure
60793>>>>>>>>>//   r193_1 is a ReportView
60793>>>>>>>>>//     DestRadio is a RadioGroup
60793>>>>>>>>>//       WindowRadio is a Radio
60793>>>>>>>>>//     ButtonSub1 is a Button
60793>>>>>>>>>//     ButtonSub3 is a ButtonSub
60793>>>>>>>>>//     prom1WQLReport is a crystalreportSubSQL
60793>>>>>>>>>
60793>>>>>>>>>// Register all objects
60793>>>>>>>>>Register_Object ButtonSub1
60793>>>>>>>>>Register_Object ButtonSub3
60793>>>>>>>>>Register_Object DestRadio
60793>>>>>>>>>Register_Object prom1WQLReport
60793>>>>>>>>>Register_Object r193_1
60793>>>>>>>>>Register_Object WindowRadio
60793>>>>>>>>>
60793>>>>>>>>>
60793>>>>>>>>>//AB/ Report View
60793>>>>>>>>>
60793>>>>>>>>>
60793>>>>>>>>>//AB-StoreTopStart
60793>>>>>>>>>Use dfallrpt
60793>>>>>>>>>Open sysfile
60795>>>>>>>>>//AB-StoreTopEnd
60795>>>>>>>>>
60795>>>>>>>>>//AB-IgnoreStart
60795>>>>>>>>>
60795>>>>>>>>>Use DFAllEnt.pkg
60795>>>>>>>>>Use Button.Sub
60795>>>>>>>>>
60795>>>>>>>>>//AB-IgnoreEnd
60795>>>>>>>>>
60795>>>>>>>>>ACTIVATE_VIEW Activate_r193_1 FOR r193_1
60799>>>>>>>>>
60799>>>>>>>>>Object r193_1 is a ReportView
60801>>>>>>>>>
60801>>>>>>>>>    //AB-StoreTopStart
60801>>>>>>>>>    property string          psdeop  public ''
60803>>>>>>>>>    //AB-StoreTopEnd
60803>>>>>>>>>
60803>>>>>>>>>    Set Label to "„¡«ç§à©ž ƒ„Ž"
60804>>>>>>>>>    Set Size to 48 191
60805>>>>>>>>>    Set Location to 6 86
60806>>>>>>>>>
60806>>>>>>>>>    //AB-DDOStart
60806>>>>>>>>>
60806>>>>>>>>>
60806>>>>>>>>>    //AB-DDOEnd
60806>>>>>>>>>
60806>>>>>>>>>    Object DestRadio is a RadioGroup
60808>>>>>>>>>
60808>>>>>>>>>        //AB-StoreTopStart
60808>>>>>>>>>
60808>>>>>>>>>        //AB-StoreTopEnd
60808>>>>>>>>>
60808>>>>>>>>>        Set Label to "tz.ektyposh"
60809>>>>>>>>>        Set Size to 29 49
60810>>>>>>>>>        Set Location to 2 1
60811>>>>>>>>>        Object WindowRadio is a Radio
60813>>>>>>>>>            Set Size to 13 30
60814>>>>>>>>>            Set Location to 12 12
60815>>>>>>>>>            Set Bitmap to "screen4.bmp"
60816>>>>>>>>>        End_Object    // WindowRadio
60817>>>>>>>>>
60817>>>>>>>>>
60817>>>>>>>>>        //AB-StoreStart
60817>>>>>>>>>        set visible_state of (destradio(self)) to false
60818>>>>>>>>>        Set Output_Device_Mode To WQL_PRINT_TO_WINDOW
60819>>>>>>>>>
60819>>>>>>>>>
60819>>>>>>>>>
60819>>>>>>>>>
60819>>>>>>>>>
60819>>>>>>>>>        //AB-StoreEnd
60819>>>>>>>>>
60819>>>>>>>>>    End_Object    // DestRadio
60820>>>>>>>>>
60820>>>>>>>>>    Object ButtonSub1 is a Button
60822>>>>>>>>>
60822>>>>>>>>>        //AB-StoreTopStart
60822>>>>>>>>>
60822>>>>>>>>>        //AB-StoreTopEnd
60822>>>>>>>>>
60822>>>>>>>>>        Set Bitmap to "RUNPROG.BMP"
60823>>>>>>>>>        Set Size to 18 29
60824>>>>>>>>>        Set Location to 6 55
60825>>>>>>>>>
60825>>>>>>>>>        //AB-StoreStart
60825>>>>>>>>>        Procedure OnClick
60827>>>>>>>>>           Send Runprom1report To (prom1WQLReport(Current_Object))
60828>>>>>>>>>        End_Procedure
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>
60829>>>>>>>>>        //AB-StoreEnd
60829>>>>>>>>>
60829>>>>>>>>>    End_Object    // ButtonSub1
60830>>>>>>>>>
60830>>>>>>>>>    Object ButtonSub3 is a ButtonSub
60832>>>>>>>>>
60832>>>>>>>>>        //AB-StoreTopStart
60832>>>>>>>>>
60832>>>>>>>>>        //AB-StoreTopEnd
60832>>>>>>>>>
60832>>>>>>>>>        Set Bitmap to "CANCEL.BMP"
60833>>>>>>>>>        Set Size to 18 29
60834>>>>>>>>>        Set Location to 6 89
60835>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
60836>>>>>>>>>
60836>>>>>>>>>        //AB-StoreStart
60836>>>>>>>>>        Procedure OnClick
60838>>>>>>>>>            Send Request_Cancel
60839>>>>>>>>>        End_Procedure
60840>>>>>>>>>
60840>>>>>>>>>
60840>>>>>>>>>
60840>>>>>>>>>
60840>>>>>>>>>        //AB-StoreEnd
60840>>>>>>>>>
60840>>>>>>>>>    End_Object    // ButtonSub3
60841>>>>>>>>>
60841>>>>>>>>>
60841>>>>>>>>>    //AB-StoreStart
60841>>>>>>>>>    Object prom1WQLReport Is A crystalreportSubSQL
60843>>>>>>>>>         Property Integer ReportReady Public False
60845>>>>>>>>>         Set Report_View_id To (Parent(Current_object))
60846>>>>>>>>>         set Report_name    To "r193_1.rpt"
60847>>>>>>>>>         Procedure OnStartPrinting
60849>>>>>>>>>             Local String  Selection FileName lsdate sitem spay  sdeop sdoy seleipes sjob
60850>>>>>>>>>             local number  nypoprosf npelates ncn
60850>>>>>>>>>             Local Integer FileType Destination SortOrder NumSortFields CurSortField
60850>>>>>>>>>             Local Integer SortDirection ifrom datefrom istadio
60850>>>>>>>>>             Move "" To Selection
60851>>>>>>>>>             move 'JOB' to sjob
60852>>>>>>>>>             move 'PAY_TERMS' to spay
60853>>>>>>>>>             move 'DOY' to sdoy
60854>>>>>>>>>             move 'ELXREOSH' TO seleipes
60855>>>>>>>>>             get psdeop to sdeop
60856>>>>>>>>>             Append Selection "{CODEMAST.TYPE} = "  '"' (SDOY) '"'
60860>>>>>>>>>             Append Selection (If(Selection <> "", " and ", "")) "{CODEMASTL.TYPE} = "  '"' (SDOY) '"'
60865>>>>>>>>>             Append Selection (If(Selection <> "", " and ", "")) "{CODEMASTn.TYPE} = "  '"' (seleipes) '"'
60870>>>>>>>>>             Append Selection (If(Selection <> "", " and ", "")) "{CODEMASTj.TYPE} = "  '"' (sjob) '"'
60875>>>>>>>>>             Append Selection (If(Selection <> "", " and ", "")) "{btnordh.aa_deop} = "  '"' (TRIM(sdeop)) '"'
60880>>>>>>>>>            Set SelectionFormula To Selection
60881>>>>>>>>>            Send AddSortField "{btnordd.vitem}" PE_SF_ascending SortDirection
60882>>>>>>>>>            If Selection Eq "" ;                Set Formula "SelTxt" To ('"' + "NONE" + '"')
60885>>>>>>>>>            Else ;                Set Formula "SelTxt" To ('"' + (Replaces('"', Selection, "")) + '"')
60887>>>>>>>>>            set formula "fetoima" to (winql_string(sysfile.wapokat_etoima))
60888>>>>>>>>>            set formula "fELLEIPES" to (winql_string(sysfile.ELLEIPES))
60889>>>>>>>>>            move WQL_PRINT_TO_WINDOW to destination
60890>>>>>>>>>            If Destination EQ WQL_PRINT_TO_WINDOW ;                Set ReportReady To False
60893>>>>>>>>>            Else ;                Set ReportReady To True
60895>>>>>>>>>
60895>>>>>>>>>        End_procedure // OnStartPrinting
60896>>>>>>>>>
60896>>>>>>>>>
60896>>>>>>>>>        Procedure Runprom1Report
60898>>>>>>>>>            Send Cursor_Wait To (Cursor_Control(Current_Object))
60899>>>>>>>>>            Send Run_report
60900>>>>>>>>>            Send Cursor_Ready To (Cursor_Control(Current_Object))
60901>>>>>>>>>            If (ReportReady(Current_object)) ;                Send Info_box "WinQL report ready."
60904>>>>>>>>>        End_procedure // RunCustReport
60905>>>>>>>>>
60905>>>>>>>>>    End_object
60906>>>>>>>>>
60906>>>>>>>>>
60906>>>>>>>>>    //AB-StoreEnd
60906>>>>>>>>>
60906>>>>>>>>>End_Object    // r193_1
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>//AB-StoreStart
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>
60907>>>>>>>>>//AB-StoreEnd
60907>>>>>>>>>
60907>>>>>>>>>//AB/ End_Object    // prj
60907>>>>>>>use doCOPY.pkg
INCLUDING FILE: DOCOPY.PKG
60907>>>>>>>>>    Open SYSCURXR
60909>>>>>>>>>    Use COUNTRY.DD
60909>>>>>>>>>    Use TOWNS.DD
60909>>>>>>>>>    Use CITIES.DD
60909>>>>>>>>>    Use AREAS.DD
60909>>>>>>>>>    Use PAYRESP.DD
60909>>>>>>>>>    Use CLIENTS.DD
60909>>>>>>>>>    Use CONSTRCT.DD
60909>>>>>>>>>    Use SALESMEN.DD
60909>>>>>>>>>    Use MHXANIK.DD
60909>>>>>>>>>    Use CN.DD
60909>>>>>>>>>    Use BTNORDH.DD
60909>>>>>>>>>    Use BTNORDD.DD
60909>>>>>>>>>    Open BtnordhL
60911>>>>>>>>>    Open BtnorddL
60913>>>>>>>>>    use v193.vw
60913>>>>>>>>>
60913>>>>>>>>>      Object oDoCOPY is A BusinessProcessSub
60915>>>>>>>>>        set Status_panel_state to false
60916>>>>>>>>>        set Display_Error_state to true
60917>>>>>>>>>        property string psid
60919>>>>>>>>>        property string psrecr
60921>>>>>>>>>        property integer piTxtID public 0
60923>>>>>>>>>        property integer piLathos public 0
60925>>>>>>>>>
60925>>>>>>>>>        Object Country_DD is a Country_DataDictionary
60927>>>>>>>>>        End_Object    // Country_DD
60928>>>>>>>>>
60928>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
60930>>>>>>>>>            Set DDO_Server to (Country_DD(self))
60931>>>>>>>>>        End_Object    // Towns_DD
60932>>>>>>>>>
60932>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
60934>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
60935>>>>>>>>>        End_Object    // Cities_DD
60936>>>>>>>>>
60936>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
60938>>>>>>>>>        End_Object    // Areas_DD
60939>>>>>>>>>
60939>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
60941>>>>>>>>>        End_Object    // Payresp_DD
60942>>>>>>>>>
60942>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
60944>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
60945>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
60946>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
60947>>>>>>>>>        End_Object    // Clients_DD
60948>>>>>>>>>
60948>>>>>>>>>        Object Constrct_DD is a Constrct_DataDictionary
60950>>>>>>>>>        End_Object    // Constrct_DD
60951>>>>>>>>>
60951>>>>>>>>>        Object Salesmen_DD is a Salesmen_DataDictionary
60953>>>>>>>>>        End_Object    // Salesmen_DD
60954>>>>>>>>>
60954>>>>>>>>>        Object Mhxanik_DD is a Mhxanik_DataDictionary
60956>>>>>>>>>        End_Object    // Mhxanik_DD
60957>>>>>>>>>
60957>>>>>>>>>        Object Cn_DD is a Cn_DataDictionary
60959>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
60960>>>>>>>>>            Set DDO_Server to (Constrct_DD(self))
60961>>>>>>>>>            Set DDO_Server to (Salesmen_DD(self))
60962>>>>>>>>>            Set DDO_Server to (Mhxanik_DD(self))
60963>>>>>>>>>        End_Object    // Cn_DD
60964>>>>>>>>>
60964>>>>>>>>>        Object Btnordh_DD is a Btnordh_DataDictionary
60966>>>>>>>>>            Set DDO_Server to (Cn_DD(self))
60967>>>>>>>>>            send defineallextendedfields
60968>>>>>>>>>        End_Object    // Btnordh_DD
60969>>>>>>>>>
60969>>>>>>>>>        Object Btnordd_DD is a Btnordd_DataDictionary
60971>>>>>>>>>            Set DDO_Server to (Btnordh_DD(self))
60972>>>>>>>>>            Set Constrain_File to Btnordh.File_Number
60973>>>>>>>>>        End_Object    // Btnordd_DD
60974>>>>>>>>>
60974>>>>>>>>>
60974>>>>>>>>>
60974>>>>>>>>>    //    Object btnordh_DD is a btnordh_DataDictionary
60974>>>>>>>>>    //    End_Object  // btnordh_DD
60974>>>>>>>>>
60974>>>>>>>>>    //    Object btnordd_DD is a btnordd_DataDictionary
60974>>>>>>>>>    //    End_Object  // btnordd_DD
60974>>>>>>>>>
60974>>>>>>>>>PROCEDURE beg_copy string srecr
60976>>>>>>>>>          set psrecr to srecr
60977>>>>>>>>>          SEND DOPROCESS
60978>>>>>>>>>END_PROCEDURE
60979>>>>>>>>>
60979>>>>>>>>>Procedure upcopy_rec
60981>>>>>>>>>    local date ddate ddeopdate ddeoplhxh
60982>>>>>>>>>    local number  nqty nunitprice ndisc nprice nxrm3 neleiph npagiaxrm3 npagiaxrprice;                  nanopagia nsthsimo neleipes
60982>>>>>>>>>    local string  saadeop sitem sitemdescr squal skatish scnrecr ssxolia scncode sclientid;                  suserid  srecr sstatero selxr sel
60982>>>>>>>>>    local integer irecnum irec
60982>>>>>>>>>    SYSDATE4 ddate
60983>>>>>>>>>    get psrecr to srecr
60984>>>>>>>>>    clear btnordhL
60985>>>>>>>>>    move srecr to btnordhL.recr
60986>>>>>>>>>    find eq btnordhL by index.2
60987>>>>>>>>>>
60987>>>>>>>>>    if (not(found))  error 3500 'ƒœ¤ ™¨å©¡à «¦ ˜¨® ¡æ ƒ.„.Ž.'
60990>>>>>>>>>    move btnordhL.cn_recr    to scnrecr
60991>>>>>>>>>    move btnordhL.velxr      to sel
60992>>>>>>>>>    move btnordhL.sxolia     to ssxolia
60993>>>>>>>>>    move btnordhL.deop_date  to ddeopdate
60994>>>>>>>>>    move btnordhL.eleiph     to neleiph
60995>>>>>>>>>    move btnordhL.user_id    to suserid
60996>>>>>>>>>    move btnordhL.statero    to sstatero
60997>>>>>>>>>    move btnordhL.deop_lhxh  to ddeoplhxh
60998>>>>>>>>>    move 1 to btnordhL.deop_active
60999>>>>>>>>>    move (ddate-1) to btnordhL.deop_lhxh
61000>>>>>>>>>    if (btnordhL.deop_lhxh < btnordhL.deop_date) move btnordhL.deop_date to btnordhL.deop_lhxh
61003>>>>>>>>>    saverecord btnordhL
61004>>>>>>>>>    send clear to btnordh_dd
61005>>>>>>>>>    send clear to btnordd_dd
61006>>>>>>>>>    move scnrecr            to cn.cn_recr
61007>>>>>>>>>    send find to cn_dd eq 2
61008>>>>>>>>>    if (not(found))  error 3501 'ƒœ¤ ™¨å©¡à «¦ â¨š¦'
61011>>>>>>>>>
61011>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.sxolia     to ssxolia
61012>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.deop_date  to ddate
61013>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.eleiph     to neleiph
61014>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.velxr      to sel
61015>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.user_id    to suserid
61016>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.statero    to sstatero
61017>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.deop_lhxh  to ddeoplhxh
61018>>>>>>>>>    set field_changed_value of btnordh_dd field btnordh.date_create to ddate
61019>>>>>>>>>    send request_save to btnordh_dd
61020>>>>>>>>>    get field_current_value of btnordh_dd field btnordh.recnum     to irec
61021>>>>>>>>>    set pirecnum of (v193(self)) to irec
61022>>>>>>>>>    Clear btnorddL
61023>>>>>>>>>    move srecr to btnorddL.btnordh_recr
61024>>>>>>>>>    Find Gt btnorddL By Index.1
61025>>>>>>>>>>
61025>>>>>>>>>    While ((Found=1) And (sRecr=btnorddL.btnordh_recr))
61029>>>>>>>>>        move btnorddL.recnum         to irecnum
61030>>>>>>>>>        move btnorddL.vitem          to sitem
61031>>>>>>>>>        move btnorddL.vitem_descr    to sitemdescr
61032>>>>>>>>>        move btnorddL.vqual          to squal
61033>>>>>>>>>        move btnorddL.vqty           to nqty
61034>>>>>>>>>        move btnorddL.vunitprice     to nunitprice
61035>>>>>>>>>        move btnorddL.vdisc          to ndisc
61036>>>>>>>>>        move btnorddL.vprice         to nprice
61037>>>>>>>>>        move btnorddL.vkatish        to skatish
61038>>>>>>>>>        move btnorddL.vxrm3          to nxrm3
61039>>>>>>>>>        move btnorddL.vpagiaxrm3     to npagiaxrm3
61040>>>>>>>>>        move btnorddL.vpagiaxrprice  to npagiaxrprice
61041>>>>>>>>>        move btnorddL.vsthsimo       to nsthsimo
61042>>>>>>>>>        move btnorddL.veleipes       to neleipes
61043>>>>>>>>>        move btnorddL.velxr          to selxr
61044>>>>>>>>>        move 1 to btnorddL.vactive
61045>>>>>>>>>        move (ddate-1) to btnorddL.deop_date
61046>>>>>>>>>        if (btnorddL.deop_date < btnorddL.arxh_date) move btnorddL.arxh_date to btnorddL.deop_date
61049>>>>>>>>>        saverecord btnorddL
61050>>>>>>>>>
61050>>>>>>>>>        send clear to btnordd_dd
61051>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vitem           to sitem
61052>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vitem_descr     to sitemdescr
61053>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vqual           to squal
61054>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vqty            to nqty
61055>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vunitprice      to nunitprice
61056>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vdisc           to ndisc
61057>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vprice          to nprice
61058>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vkatish         to skatish
61059>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vxrm3           to nxrm3
61060>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vpagiaxrm3      to npagiaxrm3
61061>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vpagiaxrprice   to npagiaxrprice
61062>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.vsthsimo        to nsthsimo
61063>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.veleipes        to neleipes
61064>>>>>>>>>        set field_changed_value of btnordd_dd field btnordd.velxr           to selxr
61065>>>>>>>>>        send request_save to btnordd_dd
61066>>>>>>>>>        Find Gt btnorddL by Index.1
61067>>>>>>>>>>
61067>>>>>>>>>    Loop
61068>>>>>>>>>>
61068>>>>>>>>>End_Procedure
61069>>>>>>>>>
61069>>>>>>>>>Procedure OnProcess
61071>>>>>>>>>       send upcopy_rec
61072>>>>>>>>>End_Procedure
61073>>>>>>>>>
61073>>>>>>>>>Procedure Start_Process
61075>>>>>>>>>         Set piTxtID                         to (Wait(Self))
61076>>>>>>>>>         Set Button_State    of (Wait(Self)) to False
61077>>>>>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
61078>>>>>>>>>         Send Popup                          to (Wait(Self))
61079>>>>>>>>>         Set piLathos                        to 0
61080>>>>>>>>>         Forward Send Start_Process
61082>>>>>>>>> End_Procedure
61083>>>>>>>>>
61083>>>>>>>>>    Procedure OnError integer error_info string errMsg
61085>>>>>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
61088>>>>>>>>>    End_Procedure
61089>>>>>>>>>
61089>>>>>>>>>
61089>>>>>>>>>    Procedure End_Process
61091>>>>>>>>>       Forward Send End_Process
61093>>>>>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
61096>>>>>>>>>    End_Procedure
61097>>>>>>>>>
61097>>>>>>>>>
61097>>>>>>>>>End_Object
61098>>>>>>>>>
61098>>>>>>>>>
61098>>>>>>>use vwclients.vw
INCLUDING FILE: VWCLIENTS.VW
61098>>>>>>>>>//AB/ Project VWCLIENTS
61098>>>>>>>>>//AB/ Object prj is a View_Project
61098>>>>>>>>>//AB/     Set ProjectName to "VWCLIENTS"
61098>>>>>>>>>//AB/     Set ProjectFileName to "VWCLIENTS.vw"
61098>>>>>>>>>//AB/     Set GenerateFileName to "VWCLIENTS.vw"
61098>>>>>>>>>
61098>>>>>>>>>// Project Object Structure
61098>>>>>>>>>//   VWCLIENTS is a dbViewSubs
61098>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
61098>>>>>>>>>//     cn_DD is a cn_DataDictionary
61098>>>>>>>>>//     Baxiokat_DD is a DataDictionary
61098>>>>>>>>>//     Country_DD is a DataDictionary
61098>>>>>>>>>//     Towns_DD is a DataDictionary
61098>>>>>>>>>//     Cities_DD is a DataDictionary
61098>>>>>>>>>//     Payresp_DD is a DataDictionary
61098>>>>>>>>>//     Areas_DD is a DataDictionary
61098>>>>>>>>>//     Clients_DD is a DataDictionary
61098>>>>>>>>>//     Salesmen_DD is a DataDictionary
61098>>>>>>>>>//     Mhxanik_DD is a DataDictionary
61098>>>>>>>>>//     Constrct_DD is a DataDictionary
61098>>>>>>>>>//     Cn_DD is a DataDictionary
61098>>>>>>>>>//     Clnbank_DD is a DataDictionary
61098>>>>>>>>>//     Tpclient_DD is a DataDictionary
61098>>>>>>>>>//     Clitem_DD is a DataDictionary
61098>>>>>>>>>//     Clients_Client_id is a dbForm
61098>>>>>>>>>//     Clients_Client_name is a dbForm
61098>>>>>>>>>//     Clients_Client_Adress is a dbFormSub
61098>>>>>>>>>//     Clients_Client_Add_No is a dbFormSub
61098>>>>>>>>>//     Clients_Client_Zipcode is a dbFormSub
61098>>>>>>>>>//     Areas_Area_Id is a dbFormSub
61098>>>>>>>>>//     Areas_Area_Descr is a dbFormSub
61098>>>>>>>>>//     Clients_Client_City is a dbFormSub
61098>>>>>>>>>//     Towns_Town_Descr is a dbFormSub
61098>>>>>>>>>//     Country_Country_Descr is a dbFormSub
61098>>>>>>>>>//     Payresp_Presp_Id is a dbFormSub
61098>>>>>>>>>//     Payresp_Presp_Name is a dbFormSub
61098>>>>>>>>>//     TextBoxSub26 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub27 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub28 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub29 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub30 is a TextBoxSub
61098>>>>>>>>>//     dbTabDialogSub2 is a dbTabDialogSub
61098>>>>>>>>>//       dbTabPageSub3 is a dbTabPageSub
61098>>>>>>>>>//         Clients_Client_afm is a dbForm
61098>>>>>>>>>//         TextBoxSub31 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub32 is a TextBoxSub
61098>>>>>>>>>//         Clients_Client_Doy is a dbComboFormSub
61098>>>>>>>>>//         Clients_Client_Job is a dbComboForm
61098>>>>>>>>>//         Clients_Client_Idiot is a dbComboForm
61098>>>>>>>>>//         Clients_Client_Class is a dbFormSub
61098>>>>>>>>>//         Clients_Client_Phone is a dbFormSub
61098>>>>>>>>>//         Clients_Client_Fax is a dbFormSub
61098>>>>>>>>>//         Clients_Client_Mobile is a dbFormSub
61098>>>>>>>>>//         Clients_Client_Aoh is a dbFormSub
61098>>>>>>>>>//         Clients_Client_Email is a dbFormSub
61098>>>>>>>>>//         TextBoxSub33 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub34 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub35 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub36 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub37 is a TextBoxSub
61098>>>>>>>>>//         Clients_Client_Respons is a dbFormSub
61098>>>>>>>>>//         TextBoxSub38 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub48 is a TextBoxSub
61098>>>>>>>>>//         Clients_Client_Hmnia is a dbFormSub
61098>>>>>>>>>//         TextBoxSub54 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub55 is a TextBoxSub
61098>>>>>>>>>//         Clients_Client_Glcode is a dbFormSub
61098>>>>>>>>>//         Clients_Sysxetish is a dbFormSub
61098>>>>>>>>>//         Textbox4 is a Textbox
61098>>>>>>>>>//         Clients_Client_Details is a dbEditSub
61098>>>>>>>>>//         TextBoxSub63 is a TextBoxSub
61098>>>>>>>>>//         btnPartl is a ButtonSub
61098>>>>>>>>>//         TextBoxSub69 is a TextBoxSub
61098>>>>>>>>>//         FormSub3 is a FormSub
61098>>>>>>>>>//         Clients_Client_Reported is a dbCheckBoxSub
61098>>>>>>>>>//       dbTabPageSub4 is a dbTabPageSub
61098>>>>>>>>>//         dbCheckBoxSub1 is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Xreosh is a dbFormSubs
61098>>>>>>>>>//         Clients_Pistosh is a dbFormSubs
61098>>>>>>>>>//         Clients_Ypoloipo is a dbFormSubs
61098>>>>>>>>>//         TextBoxSub39 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub40 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub41 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub42 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub43 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub44 is a TextBoxSub
61098>>>>>>>>>//         Clients_Plafon is a dbFormSubs
61098>>>>>>>>>//         Clients_Overhead is a dbFormSubs
61098>>>>>>>>>//         Clients_Synolikh_Ofeilh is a dbFormSubs
61098>>>>>>>>>//         TextBoxSub52 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub53 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub59 is a TextBoxSub
61098>>>>>>>>>//         Clients_Orio_Syn_Ofeilh is a dbFormSubs
61098>>>>>>>>>//         Clients_Client_Ptyppar is a dbFormSub
61098>>>>>>>>>//         Clients_Client_Seira is a dbFormSub
61098>>>>>>>>>//         Clients_Hpso is a dbFormSub
61098>>>>>>>>>//         Clients_Hpal is a dbFormSub
61098>>>>>>>>>//         Clients_Poso_Se_Apait is a dbFormSubs
61098>>>>>>>>>//         Clients_Is_Pelaths is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Is_Promhtheyths is a dbCheckBoxSub
61098>>>>>>>>>//         TextBoxSub60 is a TextBoxSub
61098>>>>>>>>>//         Clients_Last_Xreosh is a dbFormSub
61098>>>>>>>>>//         Clients_Last_Pistosh is a dbFormSub
61098>>>>>>>>>//         Textbox1 is a Textbox
61098>>>>>>>>>//         Textbox2 is a Textbox
61098>>>>>>>>>//         TextBoxSub61 is a TextBoxSub
61098>>>>>>>>>//         Clients_Feregios is a dbComboFormSub
61098>>>>>>>>>//         Clients_Is_Eksoter is a dbCheckBoxSub
61098>>>>>>>>>//         TextBoxSub62 is a TextBoxSub
61098>>>>>>>>>//         Clients_Is_Xondr is a dbCheckBoxSub
61098>>>>>>>>>//         Textbox3 is a Textbox
61098>>>>>>>>>//         TextBoxSub64 is a TextBoxSub
61098>>>>>>>>>//         FormSub1 is a FormSub
61098>>>>>>>>>//         TextBoxSub65 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub66 is a TextBoxSub
61098>>>>>>>>>//         TextBoxSub67 is a TextBoxSub
61098>>>>>>>>>//         Textbox6 is a Textbox
61098>>>>>>>>>//         Clients_Custprom_Code is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Custprom_Recr is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Endoomil is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Npdd is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Anal is a dbCheckBoxSub
61098>>>>>>>>>//         Clients_Status is a dbFormSub
61098>>>>>>>>>//         TextBoxSub70 is a TextBoxSub
61098>>>>>>>>>//         Clients_Client_Fpa is a dbCheckBoxSub
61098>>>>>>>>>//         TextBoxSub71 is a TextBoxSub
61098>>>>>>>>>//         Textbox7 is a Textbox
61098>>>>>>>>>//         Clients_SAPHMNIA is a dbFormSub
61098>>>>>>>>>//       dbTabPageSub3 is a dbTabPageSub
61098>>>>>>>>>//         Clnbank_ is a dbGridSub
61098>>>>>>>>>//       dbTabPageSub4 is a dbTabPageSub
61098>>>>>>>>>//         Tpclient_ is a dbGridSub
61098>>>>>>>>>//         ButtonSub1 is a ButtonSub
61098>>>>>>>>>//       dbTabPageSub5 is a dbTabPageSub
61098>>>>>>>>>//         clitem_ is a dbGridSub
61098>>>>>>>>>//     TextBoxSub49 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub56 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub57 is a TextBoxSub
61098>>>>>>>>>//     TextBoxSub58 is a TextBoxSub
61098>>>>>>>>>//     ButtonSub2 is a ButtonSub
61098>>>>>>>>>//     BTN_ERGA is a ButtonSub
61098>>>>>>>>>//     ButtonSub3 is a ButtonSub
61098>>>>>>>>>//     ButtonSub4 is a ButtonSub
61098>>>>>>>>>//     ButtonSub5 is a ButtonSub
61098>>>>>>>>>//     Towns_Town_Descr is a dbFormSub
61098>>>>>>>>>//     Cities_City_Descr is a dbFormSub
61098>>>>>>>>>//     Country_Country_Descr is a dbFormSub
61098>>>>>>>>>//     Textbox5 is a Textbox
61098>>>>>>>>>
61098>>>>>>>>>// Register all objects
61098>>>>>>>>>Register_Object Areas_Area_Descr
61098>>>>>>>>>Register_Object Areas_Area_Id
61098>>>>>>>>>Register_Object Areas_DD
61098>>>>>>>>>Register_Object Baxiokat_DD
61098>>>>>>>>>Register_Object BTN_ERGA
61098>>>>>>>>>Register_Object ButtonSub1
61098>>>>>>>>>Register_Object ButtonSub2
61098>>>>>>>>>Register_Object ButtonSub3
61098>>>>>>>>>Register_Object ButtonSub4
61098>>>>>>>>>Register_Object ButtonSub5
61098>>>>>>>>>Register_Object btnPartl
61098>>>>>>>>>Register_Object Cities_City_Descr
61098>>>>>>>>>Register_Object Cities_DD
61098>>>>>>>>>Register_Object Clients_Anal
61098>>>>>>>>>Register_Object Clients_Client_Add_No
61098>>>>>>>>>Register_Object Clients_Client_Adress
61098>>>>>>>>>Register_Object Clients_Client_Aoh
61098>>>>>>>>>Register_Object Clients_Client_afm
61098>>>>>>>>>Register_Object Clients_Client_City
61098>>>>>>>>>Register_Object Clients_Client_Class
61098>>>>>>>>>Register_Object Clients_Client_Details
61098>>>>>>>>>Register_Object Clients_Client_Doy
61098>>>>>>>>>Register_Object Clients_Client_Email
61098>>>>>>>>>Register_Object Clients_Client_Fax
61098>>>>>>>>>Register_Object Clients_Client_Fpa
61098>>>>>>>>>Register_Object Clients_Client_Glcode
61098>>>>>>>>>Register_Object Clients_Client_Hmnia
61098>>>>>>>>>Register_Object Clients_Client_Idiot
61098>>>>>>>>>Register_Object Clients_Client_id
61098>>>>>>>>>Register_Object Clients_Client_Job
61098>>>>>>>>>Register_Object Clients_Client_Mobile
61098>>>>>>>>>Register_Object Clients_Client_name
61098>>>>>>>>>Register_Object Clients_Client_Phone
61098>>>>>>>>>Register_Object Clients_Client_Ptyppar
61098>>>>>>>>>Register_Object Clients_Client_Reported
61098>>>>>>>>>Register_Object Clients_Client_Respons
61098>>>>>>>>>Register_Object Clients_Client_Seira
61098>>>>>>>>>Register_Object Clients_Client_Zipcode
61098>>>>>>>>>Register_Object Clients_Custprom_Code
61098>>>>>>>>>Register_Object Clients_Custprom_Recr
61098>>>>>>>>>Register_Object Clients_DD
61098>>>>>>>>>Register_Object Clients_Endoomil
61098>>>>>>>>>Register_Object Clients_Feregios
61098>>>>>>>>>Register_Object Clients_Hpal
61098>>>>>>>>>Register_Object Clients_Hpso
61098>>>>>>>>>Register_Object Clients_Is_Eksoter
61098>>>>>>>>>Register_Object Clients_Is_Pelaths
61098>>>>>>>>>Register_Object Clients_Is_Promhtheyths
61098>>>>>>>>>Register_Object Clients_Is_Xondr
61098>>>>>>>>>Register_Object Clients_Last_Pistosh
61098>>>>>>>>>Register_Object Clients_Last_Xreosh
61098>>>>>>>>>Register_Object Clients_Npdd
61098>>>>>>>>>Register_Object Clients_Orio_Syn_Ofeilh
61098>>>>>>>>>Register_Object Clients_Overhead
61098>>>>>>>>>Register_Object Clients_Pistosh
61098>>>>>>>>>Register_Object Clients_Plafon
61098>>>>>>>>>Register_Object Clients_Poso_Se_Apait
61098>>>>>>>>>Register_Object Clients_SAPHMNIA
61098>>>>>>>>>Register_Object Clients_Status
61098>>>>>>>>>Register_Object Clients_Synolikh_Ofeilh
61098>>>>>>>>>Register_Object Clients_Sysxetish
61098>>>>>>>>>Register_Object Clients_Xreosh
61098>>>>>>>>>Register_Object Clients_Ypoloipo
61098>>>>>>>>>Register_Object Clitem_DD
61098>>>>>>>>>Register_Object Clnbank_
61098>>>>>>>>>Register_Object Clnbank_DD
61098>>>>>>>>>Register_Object Cn_DD
61098>>>>>>>>>Register_Object Constrct_DD
61098>>>>>>>>>Register_Object Country_Country_Descr
61098>>>>>>>>>Register_Object Country_DD
61098>>>>>>>>>Register_Object clitem_
61098>>>>>>>>>Register_Object cn_DD
61098>>>>>>>>>Register_Object dbCheckBoxSub1
61098>>>>>>>>>Register_Object dbTabDialogSub2
61098>>>>>>>>>Register_Object dbTabPageSub3
61098>>>>>>>>>Register_Object dbTabPageSub4
61098>>>>>>>>>Register_Object dbTabPageSub5
61098>>>>>>>>>Register_Object FormSub1
61098>>>>>>>>>Register_Object FormSub3
61098>>>>>>>>>Register_Object Mhxanik_DD
61098>>>>>>>>>Register_Object Payresp_DD
61098>>>>>>>>>Register_Object Payresp_DD2
61098>>>>>>>>>Register_Object Payresp_Presp_Id
61098>>>>>>>>>Register_Object Payresp_Presp_Name
61098>>>>>>>>>Register_Object Salesmen_DD
61098>>>>>>>>>Register_Object TextBoxSub26
61098>>>>>>>>>Register_Object TextBoxSub27
61098>>>>>>>>>Register_Object TextBoxSub28
61098>>>>>>>>>Register_Object TextBoxSub29
61098>>>>>>>>>Register_Object TextBoxSub30
61098>>>>>>>>>Register_Object TextBoxSub31
61098>>>>>>>>>Register_Object TextBoxSub32
61098>>>>>>>>>Register_Object TextBoxSub33
61098>>>>>>>>>Register_Object TextBoxSub34
61098>>>>>>>>>Register_Object TextBoxSub35
61098>>>>>>>>>Register_Object TextBoxSub36
61098>>>>>>>>>Register_Object TextBoxSub37
61098>>>>>>>>>Register_Object TextBoxSub38
61098>>>>>>>>>Register_Object TextBoxSub39
61098>>>>>>>>>Register_Object TextBoxSub40
61098>>>>>>>>>Register_Object TextBoxSub41
61098>>>>>>>>>Register_Object TextBoxSub42
61098>>>>>>>>>Register_Object TextBoxSub43
61098>>>>>>>>>Register_Object TextBoxSub44
61098>>>>>>>>>Register_Object TextBoxSub48
61098>>>>>>>>>Register_Object TextBoxSub49
61098>>>>>>>>>Register_Object TextBoxSub52
61098>>>>>>>>>Register_Object TextBoxSub53
61098>>>>>>>>>Register_Object TextBoxSub54
61098>>>>>>>>>Register_Object TextBoxSub55
61098>>>>>>>>>Register_Object TextBoxSub56
61098>>>>>>>>>Register_Object TextBoxSub57
61098>>>>>>>>>Register_Object TextBoxSub58
61098>>>>>>>>>Register_Object TextBoxSub59
61098>>>>>>>>>Register_Object TextBoxSub60
61098>>>>>>>>>Register_Object TextBoxSub61
61098>>>>>>>>>Register_Object TextBoxSub62
61098>>>>>>>>>Register_Object TextBoxSub63
61098>>>>>>>>>Register_Object TextBoxSub64
61098>>>>>>>>>Register_Object TextBoxSub65
61098>>>>>>>>>Register_Object TextBoxSub66
61098>>>>>>>>>Register_Object TextBoxSub67
61098>>>>>>>>>Register_Object TextBoxSub69
61098>>>>>>>>>Register_Object TextBoxSub70
61098>>>>>>>>>Register_Object TextBoxSub71
61098>>>>>>>>>Register_Object Textbox1
61098>>>>>>>>>Register_Object Textbox2
61098>>>>>>>>>Register_Object Textbox3
61098>>>>>>>>>Register_Object Textbox4
61098>>>>>>>>>Register_Object Textbox5
61098>>>>>>>>>Register_Object Textbox6
61098>>>>>>>>>Register_Object Textbox7
61098>>>>>>>>>Register_Object Towns_DD
61098>>>>>>>>>Register_Object Towns_Town_Descr
61098>>>>>>>>>Register_Object Tpclient_
61098>>>>>>>>>Register_Object Tpclient_DD
61098>>>>>>>>>Register_Object VWCLIENTS
61098>>>>>>>>>
61098>>>>>>>>>
61098>>>>>>>>>//AB/ AppBuild VIEW
61098>>>>>>>>>
61098>>>>>>>>>
61098>>>>>>>>>//AB-StoreTopStart
61098>>>>>>>>>Open SysrecG
61100>>>>>>>>>Open Gmove
61102>>>>>>>>>open witemx
61104>>>>>>>>>open ptypparl
61106>>>>>>>>>open syscurxr
61108>>>>>>>>>use v041.vw
61108>>>>>>>>>use v197.vw
INCLUDING FILE: V197.VW
61108>>>>>>>>>>>//AB/ Project V197:AREAS
61108>>>>>>>>>>>//AB/     Object prj is a View_Project
61108>>>>>>>>>>>//AB/         Set ProjectName to "V197:AREAS"
61108>>>>>>>>>>>//AB/         Set ProjectFileName to "V197.vw"
61108>>>>>>>>>>>//AB/         Set GenerateFileName to "V197.vw"
61108>>>>>>>>>>>
61108>>>>>>>>>>>// Project Object Structure
61108>>>>>>>>>>>//   V197 is a dbView
61108>>>>>>>>>>>//     Areas_DD is a DataDictionary
61108>>>>>>>>>>>//     The_Table is a dbGrid
61108>>>>>>>>>>>
61108>>>>>>>>>>>// Register all objects
61108>>>>>>>>>>>Register_Object Areas_DD
61108>>>>>>>>>>>Register_Object The_Table
61108>>>>>>>>>>>Register_Object V197
61108>>>>>>>>>>>
61108>>>>>>>>>>>
61108>>>>>>>>>>>//AB/     AppBuild VIEW
61108>>>>>>>>>>>
61108>>>>>>>>>>>    //AB-IgnoreStart
61108>>>>>>>>>>>
61108>>>>>>>>>>>    Use DFAllEnt.pkg
61108>>>>>>>>>>>
61108>>>>>>>>>>>    Use AREAS.DD
61108>>>>>>>>>>>    
61108>>>>>>>>>>>    //AB-IgnoreEnd
61108>>>>>>>>>>>
61108>>>>>>>>>>>    ACTIVATE_VIEW Activate_V197 FOR V197
61112>>>>>>>>>>>
61112>>>>>>>>>>>    Object V197 is a dbView
61114>>>>>>>>>>>        Set Label to "œ¨ ¦®âª"
61115>>>>>>>>>>>        Set Size to 114 287
61116>>>>>>>>>>>        Set Location to 6 6
61117>>>>>>>>>>>
61117>>>>>>>>>>>        //AB-DDOStart
61117>>>>>>>>>>>
61117>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
61119>>>>>>>>>>>        End_Object    // Areas_DD
61120>>>>>>>>>>>
61120>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
61121>>>>>>>>>>>        Set Server to (Areas_DD(self))
61122>>>>>>>>>>>
61122>>>>>>>>>>>        //AB-DDOEnd
61122>>>>>>>>>>>
61122>>>>>>>>>>>        Object The_Table is a dbGrid
61124>>>>>>>>>>>            Set Main_File to Areas.File_Number
61125>>>>>>>>>>>            Set Ordering to 1
61126>>>>>>>>>>>            Set Size to 81 272
61127>>>>>>>>>>>            Set Location to 7 4
61128>>>>>>>>>>>            Set Wrap_State to TRUE
61129>>>>>>>>>>>
61129>>>>>>>>>>>            Begin_Row
61132>>>>>>>>>>>                Entry_Item Areas.Area_id
61133>>>>>>>>>>>                Entry_Item Areas.Area_descr
61134>>>>>>>>>>>                Entry_Item Areas.Area_site
61135>>>>>>>>>>>            End_Row
61140>>>>>>>>>>>
61140>>>>>>>>>>>            Set Form_Width    item 0 to 50
61141>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
61142>>>>>>>>>>>            
61142>>>>>>>>>>>            Set Form_Width    item 1 to 180
61143>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
61144>>>>>>>>>>>            
61144>>>>>>>>>>>            Set Form_Width    item 2 to 35
61145>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
61146>>>>>>>>>>>            
61146>>>>>>>>>>>        End_Object    // The_Table
61147>>>>>>>>>>>
61147>>>>>>>>>>>    End_Object    // V197
61148>>>>>>>>>>>
61148>>>>>>>>>>>//AB/     End_Object    // prj
61148>>>>>>>>>use v198.vw
INCLUDING FILE: V198.VW
61148>>>>>>>>>>>//AB/ Project v198:cities
61148>>>>>>>>>>>//AB/     Object prj is a View_Project
61148>>>>>>>>>>>//AB/         Set ProjectName to "v198:cities"
61148>>>>>>>>>>>//AB/         Set ProjectFileName to "v198.vw"
61148>>>>>>>>>>>//AB/         Set GenerateFileName to "v198.vw"
61148>>>>>>>>>>>
61148>>>>>>>>>>>// Project Object Structure
61148>>>>>>>>>>>//   v198 is a dbView
61148>>>>>>>>>>>//     Country_DD is a DataDictionary
61148>>>>>>>>>>>//     Towns_DD is a DataDictionary
61148>>>>>>>>>>>//     Cities_DD is a DataDictionary
61148>>>>>>>>>>>//     The_Table is a dbGrid
61148>>>>>>>>>>>
61148>>>>>>>>>>>// Register all objects
61148>>>>>>>>>>>Register_Object Cities_DD
61148>>>>>>>>>>>Register_Object Country_DD
61148>>>>>>>>>>>Register_Object The_Table
61148>>>>>>>>>>>Register_Object Towns_DD
61148>>>>>>>>>>>Register_Object v198
61148>>>>>>>>>>>
61148>>>>>>>>>>>
61148>>>>>>>>>>>//AB/     AppBuild VIEW
61148>>>>>>>>>>>
61148>>>>>>>>>>>    //AB-IgnoreStart
61148>>>>>>>>>>>
61148>>>>>>>>>>>    Use DFAllEnt.pkg
61148>>>>>>>>>>>
61148>>>>>>>>>>>    Use Country.DD
61148>>>>>>>>>>>    Use Towns.DD
61148>>>>>>>>>>>    Use CITIES.DD
61148>>>>>>>>>>>    
61148>>>>>>>>>>>    //AB-IgnoreEnd
61148>>>>>>>>>>>
61148>>>>>>>>>>>    ACTIVATE_VIEW Activate_v198 FOR v198
61152>>>>>>>>>>>
61152>>>>>>>>>>>    Object v198 is a dbView
61154>>>>>>>>>>>        Set Label to "æ¢œ ª"
61155>>>>>>>>>>>        Set Size to 199 378
61156>>>>>>>>>>>        Set Location to 6 11
61157>>>>>>>>>>>
61157>>>>>>>>>>>        //AB-DDOStart
61157>>>>>>>>>>>
61157>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
61159>>>>>>>>>>>        End_Object    // Country_DD
61160>>>>>>>>>>>
61160>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
61162>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
61163>>>>>>>>>>>        End_Object    // Towns_DD
61164>>>>>>>>>>>
61164>>>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
61166>>>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
61167>>>>>>>>>>>        End_Object    // Cities_DD
61168>>>>>>>>>>>
61168>>>>>>>>>>>        Set Main_DD to (Cities_DD(self))
61169>>>>>>>>>>>        Set Server to (Cities_DD(self))
61170>>>>>>>>>>>
61170>>>>>>>>>>>        //AB-DDOEnd
61170>>>>>>>>>>>
61170>>>>>>>>>>>        Object The_Table is a dbGrid
61172>>>>>>>>>>>            Set Main_File to Cities.File_Number
61173>>>>>>>>>>>            Set Ordering to 1
61174>>>>>>>>>>>            Set Size to 167 364
61175>>>>>>>>>>>            Set Location to 10 4
61176>>>>>>>>>>>            Set Wrap_State to TRUE
61177>>>>>>>>>>>
61177>>>>>>>>>>>            Begin_Row
61180>>>>>>>>>>>                Entry_Item Cities.City_id
61181>>>>>>>>>>>                Entry_Item Cities.City_descr
61182>>>>>>>>>>>                Entry_Item Towns.Town_descr
61183>>>>>>>>>>>                Entry_Item Country.Country_descr
61184>>>>>>>>>>>            End_Row
61189>>>>>>>>>>>
61189>>>>>>>>>>>            Set Form_Width    item 0 to 56
61190>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
61191>>>>>>>>>>>            
61191>>>>>>>>>>>            Set Form_Width    item 1 to 117
61192>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
61193>>>>>>>>>>>            
61193>>>>>>>>>>>            Set Form_Width    item 2 to 93
61194>>>>>>>>>>>            Set Header_Label  item 2 to "Œ¦£æª"
61195>>>>>>>>>>>            
61195>>>>>>>>>>>            Set Form_Width    item 3 to 90
61196>>>>>>>>>>>            Set Header_Label  item 3 to "•é¨˜"
61197>>>>>>>>>>>            
61197>>>>>>>>>>>        End_Object    // The_Table
61198>>>>>>>>>>>
61198>>>>>>>>>>>    End_Object    // v198
61199>>>>>>>>>>>
61199>>>>>>>>>>>//AB/     End_Object    // prj
61199>>>>>>>>>use v111.vw
INCLUDING FILE: V111.VW
61199>>>>>>>>>>>//AB/ Project v111:ypeytinoi plhromon
61199>>>>>>>>>>>//AB/ Object prj is a View_Project
61199>>>>>>>>>>>//AB/     Set ProjectName to "v111:ypeytinoi plhromon"
61199>>>>>>>>>>>//AB/     Set ProjectFileName to "V111.VW"
61199>>>>>>>>>>>//AB/     Set GenerateFileName to "VWCLIENTS.vw"
61199>>>>>>>>>>>
61199>>>>>>>>>>>// Project Object Structure
61199>>>>>>>>>>>//   v111 is a dbViewSub
61199>>>>>>>>>>>//     Baxiokat_DD is a DataDictionary
61199>>>>>>>>>>>//     Country_DD is a DataDictionary
61199>>>>>>>>>>>//     Towns_DD is a DataDictionary
61199>>>>>>>>>>>//     Payresp_DD is a DataDictionary
61199>>>>>>>>>>>//     Prspbank_DD is a DataDictionary
61199>>>>>>>>>>>//     Tppresp_DD is a DataDictionary
61199>>>>>>>>>>>//     Areas_DD is a DataDictionary
61199>>>>>>>>>>>//     Cities_DD is a DataDictionary
61199>>>>>>>>>>>//     payresp_id is a dbForm
61199>>>>>>>>>>>//     payresp_name is a dbForm
61199>>>>>>>>>>>//     payresp_Adress is a dbFormSub
61199>>>>>>>>>>>//     Payresp_Presp_Add_No is a dbFormSub
61199>>>>>>>>>>>//     payresp_Zipcode is a dbFormSub
61199>>>>>>>>>>>//     TextBoxSub26 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub27 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub29 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub30 is a TextBoxSub
61199>>>>>>>>>>>//     Cn_Cn_Area is a dbFormSub
61199>>>>>>>>>>>//     frmAreaDescr is a FormSub
61199>>>>>>>>>>>//     Cn_Cn_city is a dbFormSub
61199>>>>>>>>>>>//     frmCityDescr is a FormSub
61199>>>>>>>>>>>//     Cn_Cn_Nomos is a dbFormSub
61199>>>>>>>>>>>//     frmTownDescr is a FormSub
61199>>>>>>>>>>>//     Cn_Cn_Xora is a dbFormSub
61199>>>>>>>>>>>//     frmCountryDescr is a FormSub
61199>>>>>>>>>>>//     dbTabDialogSub2 is a dbTabDialogSub
61199>>>>>>>>>>>//       dbTabPageSub3 is a dbTabPageSub
61199>>>>>>>>>>>//         payresp_afm is a dbForm
61199>>>>>>>>>>>//         Payresp_Presp_Doy is a dbComboFormSub
61199>>>>>>>>>>>//         TextBoxSub31 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub32 is a TextBoxSub
61199>>>>>>>>>>>//         payresp_Phone is a dbFormSub
61199>>>>>>>>>>>//         payresp_Fax is a dbFormSub
61199>>>>>>>>>>>//         payresp_Mobile is a dbFormSub
61199>>>>>>>>>>>//         payresp_Aoh is a dbFormSub
61199>>>>>>>>>>>//         payresp_Email is a dbFormSub
61199>>>>>>>>>>>//         TextBoxSub33 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub34 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub35 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub36 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub37 is a TextBoxSub
61199>>>>>>>>>>>//         payresp_Respons is a dbFormSub
61199>>>>>>>>>>>//         TextBoxSub38 is a TextBoxSub
61199>>>>>>>>>>>//       dbTabPageSub4 is a dbTabPageSub
61199>>>>>>>>>>>//         payresp_Xreosh is a dbFormSub
61199>>>>>>>>>>>//         payresp_Pistosh is a dbFormSub
61199>>>>>>>>>>>//         payresp_Ypoloipo is a dbFormSub
61199>>>>>>>>>>>//         TextBoxSub40 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub41 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub42 is a TextBoxSub
61199>>>>>>>>>>>//         TextBoxSub44 is a TextBoxSub
61199>>>>>>>>>>>//         payresp_Plafon is a dbFormSub
61199>>>>>>>>>>>//         payresp_Overhead is a dbFormSub
61199>>>>>>>>>>>//         TextBoxSub64 is a TextBoxSub
61199>>>>>>>>>>>//         Payresp_Synolikh_Ofeilh is a dbFormSub
61199>>>>>>>>>>>//         Payresp_Poso_Se_Apait is a dbFormSub
61199>>>>>>>>>>>//         Textbox1 is a Textbox
61199>>>>>>>>>>>//         Payresp_Stoxos_Ipal is a dbFormSub
61199>>>>>>>>>>>//         Payresp_Stoxos_Ipso is a dbFormSub
61199>>>>>>>>>>>//         Payresp_Orio_Syn_Ofeilh is a dbFormSub
61199>>>>>>>>>>>//         TextBoxSub65 is a TextBoxSub
61199>>>>>>>>>>>//         Textbox2 is a Textbox
61199>>>>>>>>>>>//         Payresp_Feregios is a dbComboFormSub
61199>>>>>>>>>>>//       dbTabPageSub3 is a dbTabPageSub
61199>>>>>>>>>>>//         PrspBank_ is a dbGridSub
61199>>>>>>>>>>>//       dbTabPageSub4 is a dbTabPageSub
61199>>>>>>>>>>>//         Tppresp_ is a dbGridSub
61199>>>>>>>>>>>//     TextBoxSub48 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub60 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub61 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub62 is a TextBoxSub
61199>>>>>>>>>>>//     TextBoxSub63 is a TextBoxSub
61199>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
61199>>>>>>>>>>>//     ButtonSub2 is a ButtonSub
61199>>>>>>>>>>>
61199>>>>>>>>>>>// Register all objects
61199>>>>>>>>>>>Register_Object Areas_DD
61199>>>>>>>>>>>Register_Object Baxiokat_DD
61199>>>>>>>>>>>Register_Object ButtonSub1
61199>>>>>>>>>>>Register_Object ButtonSub2
61199>>>>>>>>>>>Register_Object Cities_DD
61199>>>>>>>>>>>Register_Object Cn_Cn_Area
61199>>>>>>>>>>>Register_Object Cn_Cn_city
61199>>>>>>>>>>>Register_Object Cn_Cn_Nomos
61199>>>>>>>>>>>Register_Object Cn_Cn_Xora
61199>>>>>>>>>>>Register_Object Country_DD
61199>>>>>>>>>>>Register_Object dbTabDialogSub2
61199>>>>>>>>>>>Register_Object dbTabPageSub3
61199>>>>>>>>>>>Register_Object dbTabPageSub4
61199>>>>>>>>>>>Register_Object frmAreaDescr
61199>>>>>>>>>>>Register_Object frmCityDescr
61199>>>>>>>>>>>Register_Object frmCountryDescr
61199>>>>>>>>>>>Register_Object frmTownDescr
61199>>>>>>>>>>>Register_Object Payresp_DD
61199>>>>>>>>>>>Register_Object Payresp_Feregios
61199>>>>>>>>>>>Register_Object Payresp_Orio_Syn_Ofeilh
61199>>>>>>>>>>>Register_Object Payresp_Poso_Se_Apait
61199>>>>>>>>>>>Register_Object Payresp_Presp_Add_No
61199>>>>>>>>>>>Register_Object Payresp_Presp_Doy
61199>>>>>>>>>>>Register_Object Payresp_Stoxos_Ipal
61199>>>>>>>>>>>Register_Object Payresp_Stoxos_Ipso
61199>>>>>>>>>>>Register_Object Payresp_Synolikh_Ofeilh
61199>>>>>>>>>>>Register_Object PrspBank_
61199>>>>>>>>>>>Register_Object Prspbank_DD
61199>>>>>>>>>>>Register_Object payresp_Adress
61199>>>>>>>>>>>Register_Object payresp_Aoh
61199>>>>>>>>>>>Register_Object payresp_afm
61199>>>>>>>>>>>Register_Object payresp_Email
61199>>>>>>>>>>>Register_Object payresp_Fax
61199>>>>>>>>>>>Register_Object payresp_id
61199>>>>>>>>>>>Register_Object payresp_Mobile
61199>>>>>>>>>>>Register_Object payresp_name
61199>>>>>>>>>>>Register_Object payresp_Overhead
61199>>>>>>>>>>>Register_Object payresp_Phone
61199>>>>>>>>>>>Register_Object payresp_Pistosh
61199>>>>>>>>>>>Register_Object payresp_Plafon
61199>>>>>>>>>>>Register_Object payresp_Respons
61199>>>>>>>>>>>Register_Object payresp_Xreosh
61199>>>>>>>>>>>Register_Object payresp_Ypoloipo
61199>>>>>>>>>>>Register_Object payresp_Zipcode
61199>>>>>>>>>>>Register_Object TextBoxSub26
61199>>>>>>>>>>>Register_Object TextBoxSub27
61199>>>>>>>>>>>Register_Object TextBoxSub29
61199>>>>>>>>>>>Register_Object TextBoxSub30
61199>>>>>>>>>>>Register_Object TextBoxSub31
61199>>>>>>>>>>>Register_Object TextBoxSub32
61199>>>>>>>>>>>Register_Object TextBoxSub33
61199>>>>>>>>>>>Register_Object TextBoxSub34
61199>>>>>>>>>>>Register_Object TextBoxSub35
61199>>>>>>>>>>>Register_Object TextBoxSub36
61199>>>>>>>>>>>Register_Object TextBoxSub37
61199>>>>>>>>>>>Register_Object TextBoxSub38
61199>>>>>>>>>>>Register_Object TextBoxSub40
61199>>>>>>>>>>>Register_Object TextBoxSub41
61199>>>>>>>>>>>Register_Object TextBoxSub42
61199>>>>>>>>>>>Register_Object TextBoxSub44
61199>>>>>>>>>>>Register_Object TextBoxSub48
61199>>>>>>>>>>>Register_Object TextBoxSub60
61199>>>>>>>>>>>Register_Object TextBoxSub61
61199>>>>>>>>>>>Register_Object TextBoxSub62
61199>>>>>>>>>>>Register_Object TextBoxSub63
61199>>>>>>>>>>>Register_Object TextBoxSub64
61199>>>>>>>>>>>Register_Object TextBoxSub65
61199>>>>>>>>>>>Register_Object Textbox1
61199>>>>>>>>>>>Register_Object Textbox2
61199>>>>>>>>>>>Register_Object Towns_DD
61199>>>>>>>>>>>Register_Object Tppresp_
61199>>>>>>>>>>>Register_Object Tppresp_DD
61199>>>>>>>>>>>Register_Object v111
61199>>>>>>>>>>>
61199>>>>>>>>>>>
61199>>>>>>>>>>>//AB/ AppBuild VIEW
61199>>>>>>>>>>>
61199>>>>>>>>>>>
61199>>>>>>>>>>>//AB-StoreTopStart
61199>>>>>>>>>>>use v198.vw
61199>>>>>>>>>>>use v197.vw
61199>>>>>>>>>>>//AB-StoreTopEnd
61199>>>>>>>>>>>
61199>>>>>>>>>>>//AB-IgnoreStart
61199>>>>>>>>>>>
61199>>>>>>>>>>>Use dbView.Sub
61199>>>>>>>>>>>Use DFAllEnt.pkg
61199>>>>>>>>>>>Use dbForm.Sub
61199>>>>>>>>>>>Use Txtbox.Sub
61199>>>>>>>>>>>Use Form.Sub
61199>>>>>>>>>>>Use dbTabdlg.Sub
61199>>>>>>>>>>>Use dbCmbfrm.Sub
61199>>>>>>>>>>>Use dbGrid.Sub
61199>>>>>>>>>>>Use Button.Sub
61199>>>>>>>>>>>
61199>>>>>>>>>>>Use BAXIOKAT.DD
61199>>>>>>>>>>>Use COUNTRY.DD
61199>>>>>>>>>>>Use TOWNS.DD
61199>>>>>>>>>>>Use PAYRESP.DD
61199>>>>>>>>>>>Use PRSPBANK.DD
INCLUDING FILE: PRSPBANK.DD
61199>>>>>>>>>>>>>//DDB-FileStart
61199>>>>>>>>>>>>>//DDB-HeaderStart
61199>>>>>>>>>>>>>
61199>>>>>>>>>>>>>// File Name : PRSPBANK.DD
61199>>>>>>>>>>>>>// Class Name: Prspbank_DataDictionary
61199>>>>>>>>>>>>>// Revision  : 2
61199>>>>>>>>>>>>>// Version   : 2
61199>>>>>>>>>>>>>
61199>>>>>>>>>>>>>Use  Windows           // Basic Definitions
61199>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
61199>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
61199>>>>>>>>>>>>>
61199>>>>>>>>>>>>>Open Prspbank
61201>>>>>>>>>>>>>Open Payresp
61203>>>>>>>>>>>>>
61203>>>>>>>>>>>>>//DDB-HeaderEnd
61203>>>>>>>>>>>>>//DDB-ValidationStart
61203>>>>>>>>>>>>>
61203>>>>>>>>>>>>>Register_Object Prspbank_Bank_Id_VT
61203>>>>>>>>>>>>>
61203>>>>>>>>>>>>>Object Prspbank_Bank_Id_VT  is a CodeValidationTable
61205>>>>>>>>>>>>>    Set Type_Value        To "BANK"
61206>>>>>>>>>>>>>    //DDB-ValidationCustomStart
61206>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
61206>>>>>>>>>>>>>End_Object   // Prspbank_Bank_Id_VT
61207>>>>>>>>>>>>>//DDB-ValidationEnd
61207>>>>>>>>>>>>>
61207>>>>>>>>>>>>>Class Prspbank_DataDictionary  is a DataDictionary_Sec
61208>>>>>>>>>>>>>
61208>>>>>>>>>>>>>    // Define_Fields:
61208>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
61208>>>>>>>>>>>>>
61208>>>>>>>>>>>>>    Procedure Define_Fields
61209>>>>>>>>>>>>>        Forward Send Define_Fields
61211>>>>>>>>>>>>>        //DDB-Generated-Code-Location
61211>>>>>>>>>>>>>        //DDB-DefineFieldStart
61211>>>>>>>>>>>>>
61211>>>>>>>>>>>>>        Set Main_File            To Prspbank.File_Number
61212>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
61213>>>>>>>>>>>>>
61213>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
61214>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
61215>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
61216>>>>>>>>>>>>>
61216>>>>>>>>>>>>>        // Parent (Server) file structure...............
61216>>>>>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
61217>>>>>>>>>>>>>
61217>>>>>>>>>>>>>        // Field-based properties.......................
61217>>>>>>>>>>>>>
61217>>>>>>>>>>>>>        // Prspbank.Payresp_Id
61217>>>>>>>>>>>>>
61217>>>>>>>>>>>>>        // Prspbank.Bank_Id
61217>>>>>>>>>>>>>        Set Field_Value_Table      Field Prspbank.Bank_Id To (Prspbank_Bank_Id_VT(Self))
61218>>>>>>>>>>>>>
61218>>>>>>>>>>>>>        // Prspbank.Logariasmos
61218>>>>>>>>>>>>>
61218>>>>>>>>>>>>>        //DDB-DefineFieldEnd
61218>>>>>>>>>>>>>    End_Procedure    // Define_Fields
61219>>>>>>>>>>>>>
61219>>>>>>>>>>>>>    // Field_Defaults:
61219>>>>>>>>>>>>>    // This procedure is used to establish default field values.
61219>>>>>>>>>>>>>
61219>>>>>>>>>>>>>    Procedure Field_Defaults
61220>>>>>>>>>>>>>        Forward Send Field_Defaults
61222>>>>>>>>>>>>>        //DDB-Generated-Code-Location
61222>>>>>>>>>>>>>        //DDB-FieldDefaultStart
61222>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
61222>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
61223>>>>>>>>>>>>>
61223>>>>>>>>>>>>>End_Class    // Prspbank_DataDictionary
61224>>>>>>>>>>>>>//DDB-FileEnd
61224>>>>>>>>>>>Use TPPRESP.DD
INCLUDING FILE: TPPRESP.DD
61224>>>>>>>>>>>>>//DDB-FileStart
61224>>>>>>>>>>>>>//DDB-HeaderStart
61224>>>>>>>>>>>>>
61224>>>>>>>>>>>>>// File Name : TPPRESP.DD
61224>>>>>>>>>>>>>// Class Name: Tppresp_DataDictionary
61224>>>>>>>>>>>>>// Revision  : 6
61224>>>>>>>>>>>>>// Version   : 2
61224>>>>>>>>>>>>>
61224>>>>>>>>>>>>>Use  Windows           // Basic Definitions
61224>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
61224>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
61224>>>>>>>>>>>>>
61224>>>>>>>>>>>>>Open Tppresp
61226>>>>>>>>>>>>>Open Payresp
61228>>>>>>>>>>>>>Open Baxiokat
61230>>>>>>>>>>>>>Open Sysrecc
61232>>>>>>>>>>>>>
61232>>>>>>>>>>>>>//DDB-HeaderEnd
61232>>>>>>>>>>>>>
61232>>>>>>>>>>>>>Class Tppresp_DataDictionary  is a DataDictionary_Sec
61233>>>>>>>>>>>>>
61233>>>>>>>>>>>>>
61233>>>>>>>>>>>>>    Procedure Save_Main_File
61234>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
61236>>>>>>>>>>>>>            If TpPresp.Recnum Eq 0 Procedure_Return
61239>>>>>>>>>>>>>        End
61239>>>>>>>>>>>>>>
61239>>>>>>>>>>>>>        Forward Send Save_Main_File
61241>>>>>>>>>>>>>    End_Procedure
61242>>>>>>>>>>>>>
61242>>>>>>>>>>>>>
61242>>>>>>>>>>>>>
61242>>>>>>>>>>>>>    Procedure Creating
61243>>>>>>>>>>>>>        Forward Send Creating
61245>>>>>>>>>>>>>        // Insert Code Here
61245>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(TPPresp.TPPresp_Rec0))))));                                    to TPPresp.TPPresp_Recr
61246>>>>>>>>>>>>>    End_Procedure   // Creating
61247>>>>>>>>>>>>>
61247>>>>>>>>>>>>>
61247>>>>>>>>>>>>>    // Define_Fields:
61247>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
61247>>>>>>>>>>>>>
61247>>>>>>>>>>>>>    Procedure Define_Fields
61248>>>>>>>>>>>>>        Forward Send Define_Fields
61250>>>>>>>>>>>>>        //DDB-Generated-Code-Location
61250>>>>>>>>>>>>>        //DDB-DefineFieldStart
61250>>>>>>>>>>>>>
61250>>>>>>>>>>>>>        Set Main_File            To Tppresp.File_Number
61251>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
61252>>>>>>>>>>>>>
61252>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
61253>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
61254>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
61255>>>>>>>>>>>>>
61255>>>>>>>>>>>>>        // Parent (Server) file structure...............
61255>>>>>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
61256>>>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
61257>>>>>>>>>>>>>
61257>>>>>>>>>>>>>        // External (System) file structure.............
61257>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
61258>>>>>>>>>>>>>
61258>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tppresp_Rec0  To Tppresp.Tppresp_Rec0
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Field-based properties.......................
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Payresp_Id
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Baxiokat_Code
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Pct_Epi_Synolou
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Paralabh_Meres
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Xarhtos_Meres
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Plhroteo_Meres
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Tppresp_Rec0
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        // Tppresp.Tppresp_Recr
61261>>>>>>>>>>>>>
61261>>>>>>>>>>>>>        //DDB-DefineFieldEnd
61261>>>>>>>>>>>>>    End_Procedure    // Define_Fields
61262>>>>>>>>>>>>>
61262>>>>>>>>>>>>>    // Field_Defaults:
61262>>>>>>>>>>>>>    // This procedure is used to establish default field values.
61262>>>>>>>>>>>>>
61262>>>>>>>>>>>>>    Procedure Field_Defaults
61263>>>>>>>>>>>>>        Forward Send Field_Defaults
61265>>>>>>>>>>>>>        //DDB-Generated-Code-Location
61265>>>>>>>>>>>>>        //DDB-FieldDefaultStart
61265>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
61265>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
61266>>>>>>>>>>>>>
61266>>>>>>>>>>>>>End_Class    // Tppresp_DataDictionary
61267>>>>>>>>>>>>>//DDB-FileEnd
61267>>>>>>>>>>>Use AREAS.DD
61267>>>>>>>>>>>Use CITIES.DD
61267>>>>>>>>>>>
61267>>>>>>>>>>>//AB-IgnoreEnd
61267>>>>>>>>>>>
61267>>>>>>>>>>>ACTIVATE_VIEW Activate_v111 FOR v111
61271>>>>>>>>>>>
61271>>>>>>>>>>>Object v111 is a dbViewSub
61273>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
61274>>>>>>>>>>>    Set Size to 273 509
61275>>>>>>>>>>>    Set Location to 2 7
61276>>>>>>>>>>>
61276>>>>>>>>>>>    //AB-DDOStart
61276>>>>>>>>>>>
61276>>>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
61278>>>>>>>>>>>    End_Object    // Baxiokat_DD
61279>>>>>>>>>>>
61279>>>>>>>>>>>    Object Country_DD is a Country_DataDictionary
61281>>>>>>>>>>>    End_Object    // Country_DD
61282>>>>>>>>>>>
61282>>>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
61284>>>>>>>>>>>        Set DDO_Server to (Country_DD(self))
61285>>>>>>>>>>>    End_Object    // Towns_DD
61286>>>>>>>>>>>
61286>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
61288>>>>>>>>>>>
61288>>>>>>>>>>>        //AB-StoreTopStart
61288>>>>>>>>>>>        Property Integer piNomosID  Public 0
61290>>>>>>>>>>>        Property Integer piXoraID   Public 0
61292>>>>>>>>>>>        
61292>>>>>>>>>>>        //AB-StoreTopEnd
61292>>>>>>>>>>>
61292>>>>>>>>>>>
61292>>>>>>>>>>>        //AB-StoreStart
61292>>>>>>>>>>>        set ordering to 7
61293>>>>>>>>>>>        Procedure Save_Main_File
61295>>>>>>>>>>>            Move (piNomosID(Self))  to payresp.presp_Nomos
61296>>>>>>>>>>>            Move (piXoraID(Self))   to payresp.presp_Xora
61297>>>>>>>>>>>            Forward Send Save_Main_File
61299>>>>>>>>>>>        End_Procedure
61300>>>>>>>>>>>        
61300>>>>>>>>>>>        
61300>>>>>>>>>>>        
61300>>>>>>>>>>>        //AB-StoreEnd
61300>>>>>>>>>>>
61300>>>>>>>>>>>    End_Object    // Payresp_DD
61301>>>>>>>>>>>
61301>>>>>>>>>>>    Object Prspbank_DD is a Prspbank_DataDictionary
61303>>>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
61304>>>>>>>>>>>        Set Constrain_File to Payresp.File_Number
61305>>>>>>>>>>>    End_Object    // Prspbank_DD
61306>>>>>>>>>>>
61306>>>>>>>>>>>    Object Tppresp_DD is a Tppresp_DataDictionary
61308>>>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
61309>>>>>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
61310>>>>>>>>>>>        Set Constrain_File to Payresp.File_Number
61311>>>>>>>>>>>    End_Object    // Tppresp_DD
61312>>>>>>>>>>>
61312>>>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
61314>>>>>>>>>>>    End_Object    // Areas_DD
61315>>>>>>>>>>>
61315>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
61317>>>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
61318>>>>>>>>>>>    End_Object    // Cities_DD
61319>>>>>>>>>>>
61319>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
61320>>>>>>>>>>>    Set Server to (Payresp_DD(self))
61321>>>>>>>>>>>
61321>>>>>>>>>>>    //AB-DDOEnd
61321>>>>>>>>>>>
61321>>>>>>>>>>>    Object payresp_id is a dbForm
61323>>>>>>>>>>>        Entry_Item Payresp.Presp_id
61324>>>>>>>>>>>        Set Size to 13 96
61325>>>>>>>>>>>        Set Location to 3 72
61326>>>>>>>>>>>        Set Label_Col_Offset to 2
61327>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61328>>>>>>>>>>>    End_Object    // payresp_id
61329>>>>>>>>>>>
61329>>>>>>>>>>>    Object payresp_name is a dbForm
61331>>>>>>>>>>>        Entry_Item Payresp.Presp_name
61332>>>>>>>>>>>        Set Size to 13 227
61333>>>>>>>>>>>        Set Location to 2 219
61334>>>>>>>>>>>        Set Label_Col_Offset to 2
61335>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61336>>>>>>>>>>>    End_Object    // payresp_name
61337>>>>>>>>>>>
61337>>>>>>>>>>>    Object payresp_Adress is a dbFormSub
61339>>>>>>>>>>>        Entry_Item Payresp.Presp_address
61340>>>>>>>>>>>        Set Size to 13 261
61341>>>>>>>>>>>        Set Location to 21 72
61342>>>>>>>>>>>        Set Label_Col_Offset to 2
61343>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61344>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61345>>>>>>>>>>>    End_Object    // payresp_Adress
61346>>>>>>>>>>>
61346>>>>>>>>>>>    Object Payresp_Presp_Add_No is a dbFormSub
61348>>>>>>>>>>>        Entry_Item Payresp.Presp_add_no
61349>>>>>>>>>>>        Set Size to 13 55
61350>>>>>>>>>>>        Set Location to 21 391
61351>>>>>>>>>>>        Set Label_Col_Offset to 2
61352>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61353>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61354>>>>>>>>>>>    End_Object    // Payresp_Presp_Add_No
61355>>>>>>>>>>>
61355>>>>>>>>>>>    Object payresp_Zipcode is a dbFormSub
61357>>>>>>>>>>>        Entry_Item Payresp.Presp_zipcode
61358>>>>>>>>>>>        Set Size to 13 38
61359>>>>>>>>>>>        Set Location to 39 72
61360>>>>>>>>>>>        Set Label_Col_Offset to 2
61361>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61362>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61363>>>>>>>>>>>    End_Object    // payresp_Zipcode
61364>>>>>>>>>>>
61364>>>>>>>>>>>    Object TextBoxSub26 is a TextBoxSub
61366>>>>>>>>>>>        Set Label to "‰à› ¡æª"
61367>>>>>>>>>>>        Set Location to 4 9
61368>>>>>>>>>>>        Set Size to 10 31
61369>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
61370>>>>>>>>>>>    End_Object    // TextBoxSub26
61371>>>>>>>>>>>
61371>>>>>>>>>>>    Object TextBoxSub27 is a TextBoxSub
61373>>>>>>>>>>>        Set Label to "ƒ œçŸ¬¤©ž"
61374>>>>>>>>>>>        Set Location to 21 8
61375>>>>>>>>>>>        Set Size to 10 41
61376>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
61377>>>>>>>>>>>    End_Object    // TextBoxSub27
61378>>>>>>>>>>>
61378>>>>>>>>>>>    Object TextBoxSub29 is a TextBoxSub
61380>>>>>>>>>>>        Set Label to "’.‰."
61381>>>>>>>>>>>        Set Location to 39 7
61382>>>>>>>>>>>        Set Size to 10 16
61383>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
61384>>>>>>>>>>>    End_Object    // TextBoxSub29
61385>>>>>>>>>>>
61385>>>>>>>>>>>    Object TextBoxSub30 is a TextBoxSub
61387>>>>>>>>>>>        Set Label to "„§à¤¬£å˜"
61388>>>>>>>>>>>        Set Location to 3 178
61389>>>>>>>>>>>        Set Size to 12 34
61390>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
61391>>>>>>>>>>>    End_Object    // TextBoxSub30
61392>>>>>>>>>>>
61392>>>>>>>>>>>    Object Cn_Cn_Area is a dbFormSub
61394>>>>>>>>>>>        Entry_Item Payresp.Presp_area
61395>>>>>>>>>>>        Set Size to 13 65
61396>>>>>>>>>>>        Set Location to 39 264
61397>>>>>>>>>>>        Set Label_Col_Offset to 2
61398>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61399>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61400>>>>>>>>>>>
61400>>>>>>>>>>>        //AB-StoreStart
61400>>>>>>>>>>>        Set Points Item 0 to 0
61401>>>>>>>>>>>        Procedure OnChange
61403>>>>>>>>>>>            Integer iVal
61404>>>>>>>>>>>            Get Field_Current_Value Of payresp_DD Field payresp.presp_Area to iVal
61405>>>>>>>>>>>            Set Value Of frmAreaDescr Item 0 to (fsAreaDescr(iVal))
61406>>>>>>>>>>>        End_Procedure
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        
61407>>>>>>>>>>>        //AB-StoreEnd
61407>>>>>>>>>>>
61407>>>>>>>>>>>    End_Object    // Cn_Cn_Area
61408>>>>>>>>>>>
61408>>>>>>>>>>>    Object frmAreaDescr is a FormSub
61410>>>>>>>>>>>        Set Size to 13 113
61411>>>>>>>>>>>        Set Location to 39 333
61412>>>>>>>>>>>        Set Color to clBtnFace
61413>>>>>>>>>>>        Set Label_Col_Offset to 2
61414>>>>>>>>>>>        Set Enabled_State to FALSE
61415>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61416>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
61417>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
61418>>>>>>>>>>>    End_Object    // frmAreaDescr
61419>>>>>>>>>>>
61419>>>>>>>>>>>    Object Cn_Cn_city is a dbFormSub
61421>>>>>>>>>>>        Entry_Item Payresp.Presp_city_id
61422>>>>>>>>>>>        Set Size to 13 38
61423>>>>>>>>>>>        Set Location to 53 72
61424>>>>>>>>>>>        Set Label_Col_Offset to 2
61425>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61426>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61427>>>>>>>>>>>
61427>>>>>>>>>>>        //AB-StoreStart
61427>>>>>>>>>>>        Set Points Item 0 to 0
61428>>>>>>>>>>>        Procedure OnChange
61430>>>>>>>>>>>            Integer iVal
61431>>>>>>>>>>>            Get Field_Current_Value Of Payresp_DD Field payresp.presp_City_id to iVal
61432>>>>>>>>>>>            Set Value Of frmCityDescr Item 0 to (fsCityDescr(iVal))
61433>>>>>>>>>>>        
61433>>>>>>>>>>>            Move (fiTownIDFromCity(iVal)) to ival
61434>>>>>>>>>>>            Set Field_Current_Value Of payresp_DD Field payresp.presp_Nomos to iVal
61435>>>>>>>>>>>            Set piNomosID Of payresp_dd to iVal
61436>>>>>>>>>>>        
61436>>>>>>>>>>>            Set Value Of frmTownDescr Item 0 to (fsTownDescr(iVal))
61437>>>>>>>>>>>            Move (fiCountryIDFromTown(iVal)) to ival
61438>>>>>>>>>>>        
61438>>>>>>>>>>>            Set Field_Current_Value Of payresp_DD Field payresp.presp_Xora to iVal
61439>>>>>>>>>>>            Set piXoraID Of payresp_dd to iVal
61440>>>>>>>>>>>        
61440>>>>>>>>>>>            Set Value Of frmCountryDescr Item 0 to (fsCountryDescr(iVal))
61441>>>>>>>>>>>        End_Procedure
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        
61442>>>>>>>>>>>        //AB-StoreEnd
61442>>>>>>>>>>>
61442>>>>>>>>>>>    End_Object    // Cn_Cn_city
61443>>>>>>>>>>>
61443>>>>>>>>>>>    Object frmCityDescr is a FormSub
61445>>>>>>>>>>>        Set Size to 13 85
61446>>>>>>>>>>>        Set Location to 53 116
61447>>>>>>>>>>>        Set Color to clBtnFace
61448>>>>>>>>>>>        Set Label_Col_Offset to 2
61449>>>>>>>>>>>        Set Enabled_State to FALSE
61450>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61451>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
61452>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
61453>>>>>>>>>>>    End_Object    // frmCityDescr
61454>>>>>>>>>>>
61454>>>>>>>>>>>    Object Cn_Cn_Nomos is a dbFormSub
61456>>>>>>>>>>>        Entry_Item Payresp.Presp_nomos
61457>>>>>>>>>>>        Set Size to 13 65
61458>>>>>>>>>>>        Set Location to 53 264
61459>>>>>>>>>>>        Set Color to clBtnFace
61460>>>>>>>>>>>        Set Label_Col_Offset to 2
61461>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61462>>>>>>>>>>>        Set Enabled_State to FALSE
61463>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61464>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
61465>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
61466>>>>>>>>>>>    End_Object    // Cn_Cn_Nomos
61467>>>>>>>>>>>
61467>>>>>>>>>>>    Object frmTownDescr is a FormSub
61469>>>>>>>>>>>        Set Size to 13 113
61470>>>>>>>>>>>        Set Location to 53 333
61471>>>>>>>>>>>        Set Color to clBtnFace
61472>>>>>>>>>>>        Set Label_Col_Offset to 2
61473>>>>>>>>>>>        Set Enabled_State to FALSE
61474>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61475>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
61476>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
61477>>>>>>>>>>>    End_Object    // frmTownDescr
61478>>>>>>>>>>>
61478>>>>>>>>>>>    Object Cn_Cn_Xora is a dbFormSub
61480>>>>>>>>>>>        Entry_Item Payresp.Presp_xora
61481>>>>>>>>>>>        Set Size to 13 38
61482>>>>>>>>>>>        Set Location to 67 72
61483>>>>>>>>>>>        Set Color to clBtnFace
61484>>>>>>>>>>>        Set Label_Col_Offset to 2
61485>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
61486>>>>>>>>>>>        Set Enabled_State to FALSE
61487>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61488>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
61489>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
61490>>>>>>>>>>>    End_Object    // Cn_Cn_Xora
61491>>>>>>>>>>>
61491>>>>>>>>>>>    Object frmCountryDescr is a FormSub
61493>>>>>>>>>>>        Set Size to 13 85
61494>>>>>>>>>>>        Set Location to 68 116
61495>>>>>>>>>>>        Set Color to clBtnFace
61496>>>>>>>>>>>        Set Label_Col_Offset to 2
61497>>>>>>>>>>>        Set Enabled_State to FALSE
61498>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61499>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
61500>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
61501>>>>>>>>>>>    End_Object    // frmCountryDescr
61502>>>>>>>>>>>
61502>>>>>>>>>>>    Object dbTabDialogSub2 is a dbTabDialogSub
61504>>>>>>>>>>>        Set Size to 161 495
61505>>>>>>>>>>>        Set Location to 92 6
61506>>>>>>>>>>>        Set Border_Style to Border_Normal
61507>>>>>>>>>>>        Object dbTabPageSub3 is a dbTabPageSub
61509>>>>>>>>>>>            Set Label to "dbTabPageSub1"
61510>>>>>>>>>>>            Object payresp_afm is a dbForm
61512>>>>>>>>>>>                Entry_Item Payresp.Presp_afm
61513>>>>>>>>>>>                Set Size to 13 65
61514>>>>>>>>>>>                Set Location to 7 65
61515>>>>>>>>>>>                Set Label_Col_Offset to 2
61516>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61517>>>>>>>>>>>            End_Object    // payresp_afm
61518>>>>>>>>>>>
61518>>>>>>>>>>>            Object Payresp_Presp_Doy is a dbComboFormSub
61520>>>>>>>>>>>                Entry_Item Payresp.Presp_doy
61521>>>>>>>>>>>                Set Size to 13 137
61522>>>>>>>>>>>                Set Location to 25 65
61523>>>>>>>>>>>                Set Label_Col_Offset to 2
61524>>>>>>>>>>>            End_Object    // Payresp_Presp_Doy
61525>>>>>>>>>>>
61525>>>>>>>>>>>            Object TextBoxSub31 is a TextBoxSub
61527>>>>>>>>>>>                Set Label to "€.”.‹."
61528>>>>>>>>>>>                Set Location to 7 9
61529>>>>>>>>>>>                Set Size to 10 31
61530>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61531>>>>>>>>>>>            End_Object    // TextBoxSub31
61532>>>>>>>>>>>
61532>>>>>>>>>>>            Object TextBoxSub32 is a TextBoxSub
61534>>>>>>>>>>>                Set Label to "ƒ.Ž.“."
61535>>>>>>>>>>>                Set Location to 24 9
61536>>>>>>>>>>>                Set Size to 10 36
61537>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61538>>>>>>>>>>>            End_Object    // TextBoxSub32
61539>>>>>>>>>>>
61539>>>>>>>>>>>            Object payresp_Phone is a dbFormSub
61541>>>>>>>>>>>                Entry_Item Payresp.Presp_phone
61542>>>>>>>>>>>                Set Size to 13 306
61543>>>>>>>>>>>                Set Location to 44 65
61544>>>>>>>>>>>                Set Label_Col_Offset to 2
61545>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61546>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61547>>>>>>>>>>>            End_Object    // payresp_Phone
61548>>>>>>>>>>>
61548>>>>>>>>>>>            Object payresp_Fax is a dbFormSub
61550>>>>>>>>>>>                Entry_Item Payresp.Presp_fax
61551>>>>>>>>>>>                Set Size to 13 306
61552>>>>>>>>>>>                Set Location to 60 65
61553>>>>>>>>>>>                Set Label_Col_Offset to 2
61554>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61555>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61556>>>>>>>>>>>            End_Object    // payresp_Fax
61557>>>>>>>>>>>
61557>>>>>>>>>>>            Object payresp_Mobile is a dbFormSub
61559>>>>>>>>>>>                Entry_Item Payresp.Presp_mobile
61560>>>>>>>>>>>                Set Size to 13 306
61561>>>>>>>>>>>                Set Location to 75 65
61562>>>>>>>>>>>                Set Label_Col_Offset to 2
61563>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61564>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61565>>>>>>>>>>>            End_Object    // payresp_Mobile
61566>>>>>>>>>>>
61566>>>>>>>>>>>            Object payresp_Aoh is a dbFormSub
61568>>>>>>>>>>>                Entry_Item Payresp.Presp_aoh
61569>>>>>>>>>>>                Set Size to 13 306
61570>>>>>>>>>>>                Set Location to 91 65
61571>>>>>>>>>>>                Set Label_Col_Offset to 2
61572>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61573>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61574>>>>>>>>>>>            End_Object    // payresp_Aoh
61575>>>>>>>>>>>
61575>>>>>>>>>>>            Object payresp_Email is a dbFormSub
61577>>>>>>>>>>>                Entry_Item Payresp.Presp_email
61578>>>>>>>>>>>                Set Size to 13 306
61579>>>>>>>>>>>                Set Location to 106 65
61580>>>>>>>>>>>                Set Label_Col_Offset to 2
61581>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61582>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61583>>>>>>>>>>>            End_Object    // payresp_Email
61584>>>>>>>>>>>
61584>>>>>>>>>>>            Object TextBoxSub33 is a TextBoxSub
61586>>>>>>>>>>>                Set Label to "e-Mail"
61587>>>>>>>>>>>                Set Location to 107 9
61588>>>>>>>>>>>                Set Size to 10 20
61589>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61590>>>>>>>>>>>            End_Object    // TextBoxSub33
61591>>>>>>>>>>>
61591>>>>>>>>>>>            Object TextBoxSub34 is a TextBoxSub
61593>>>>>>>>>>>                Set Label to "’ž¢â­à¤˜"
61594>>>>>>>>>>>                Set Location to 44 9
61595>>>>>>>>>>>                Set Size to 10 39
61596>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61597>>>>>>>>>>>            End_Object    // TextBoxSub34
61598>>>>>>>>>>>
61598>>>>>>>>>>>            Object TextBoxSub35 is a TextBoxSub
61600>>>>>>>>>>>                Set Label to "Fax"
61601>>>>>>>>>>>                Set Location to 60 9
61602>>>>>>>>>>>                Set Size to 10 13
61603>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61604>>>>>>>>>>>            End_Object    // TextBoxSub35
61605>>>>>>>>>>>
61605>>>>>>>>>>>            Object TextBoxSub36 is a TextBoxSub
61607>>>>>>>>>>>                Set Label to "‰ ¤ž«æ"
61608>>>>>>>>>>>                Set Location to 75 9
61609>>>>>>>>>>>                Set Size to 10 31
61610>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61611>>>>>>>>>>>            End_Object    // TextBoxSub36
61612>>>>>>>>>>>
61612>>>>>>>>>>>            Object TextBoxSub37 is a TextBoxSub
61614>>>>>>>>>>>                Set Label to "€.Ž.†."
61615>>>>>>>>>>>                Set Location to 90 9
61616>>>>>>>>>>>                Set Size to 10 33
61617>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61618>>>>>>>>>>>            End_Object    // TextBoxSub37
61619>>>>>>>>>>>
61619>>>>>>>>>>>            Object payresp_Respons is a dbFormSub
61621>>>>>>>>>>>                Entry_Item Payresp.Presp_respons
61622>>>>>>>>>>>                Set Size to 13 306
61623>>>>>>>>>>>                Set Location to 122 65
61624>>>>>>>>>>>                Set Label_Col_Offset to 2
61625>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61626>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61627>>>>>>>>>>>            End_Object    // payresp_Respons
61628>>>>>>>>>>>
61628>>>>>>>>>>>            Object TextBoxSub38 is a TextBoxSub
61630>>>>>>>>>>>                Set Label to "“§œçŸ¬¤¦ª"
61631>>>>>>>>>>>                Set Location to 122 9
61632>>>>>>>>>>>                Set Size to 12 43
61633>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61634>>>>>>>>>>>            End_Object    // TextBoxSub38
61635>>>>>>>>>>>
61635>>>>>>>>>>>
61635>>>>>>>>>>>            //AB-StoreStart
61635>>>>>>>>>>>                                                                                                                                    
61635>>>>>>>>>>>            set label to "‚œ¤ ¡á ‘«¦ ®œå˜"
61636>>>>>>>>>>>            
61636>>>>>>>>>>>            //AB-StoreEnd
61636>>>>>>>>>>>
61636>>>>>>>>>>>        End_Object    // dbTabPageSub3
61637>>>>>>>>>>>
61637>>>>>>>>>>>        Object dbTabPageSub4 is a dbTabPageSub
61639>>>>>>>>>>>            Set Label to "dbTabPageSub2"
61640>>>>>>>>>>>            Object payresp_Xreosh is a dbFormSub
61642>>>>>>>>>>>                Entry_Item Payresp.Xreosh
61643>>>>>>>>>>>                Set Size to 13 138
61644>>>>>>>>>>>                Set Location to 9 65
61645>>>>>>>>>>>                Set Color to clBtnFace
61646>>>>>>>>>>>                Set Label_Col_Offset to 2
61647>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61648>>>>>>>>>>>                Set Enabled_State to FALSE
61649>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61650>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61651>>>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
61652>>>>>>>>>>>                Set Shadow_State Item 0 to TRUE
61653>>>>>>>>>>>
61653>>>>>>>>>>>                //AB-StoreStart
61653>>>>>>>>>>>                Procedure End_Construct_Object
61655>>>>>>>>>>>                    Integer iDecimals
61656>>>>>>>>>>>                    Forward Send End_Construct_Object
61658>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
61659>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61660>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals '  ,*'
61661>>>>>>>>>>>                End_Procedure
61662>>>>>>>>>>>                
61662>>>>>>>>>>>                
61662>>>>>>>>>>>                //AB-StoreEnd
61662>>>>>>>>>>>
61662>>>>>>>>>>>            End_Object    // payresp_Xreosh
61663>>>>>>>>>>>
61663>>>>>>>>>>>            Object payresp_Pistosh is a dbFormSub
61665>>>>>>>>>>>                Entry_Item Payresp.Pistosh
61666>>>>>>>>>>>                Set Size to 13 138
61667>>>>>>>>>>>                Set Location to 23 65
61668>>>>>>>>>>>                Set Color to clBtnFace
61669>>>>>>>>>>>                Set Label_Col_Offset to 2
61670>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61671>>>>>>>>>>>                Set Enabled_State to FALSE
61672>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61673>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61674>>>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
61675>>>>>>>>>>>                Set Shadow_State Item 0 to TRUE
61676>>>>>>>>>>>
61676>>>>>>>>>>>                //AB-StoreStart
61676>>>>>>>>>>>                Procedure End_Construct_Object
61678>>>>>>>>>>>                    Integer iDecimals
61679>>>>>>>>>>>                    Forward Send End_Construct_Object
61681>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
61682>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61683>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals '  ,*'
61684>>>>>>>>>>>                End_Procedure
61685>>>>>>>>>>>                
61685>>>>>>>>>>>                
61685>>>>>>>>>>>                
61685>>>>>>>>>>>                //AB-StoreEnd
61685>>>>>>>>>>>
61685>>>>>>>>>>>            End_Object    // payresp_Pistosh
61686>>>>>>>>>>>
61686>>>>>>>>>>>            Object payresp_Ypoloipo is a dbFormSub
61688>>>>>>>>>>>                Entry_Item Payresp.Ypoloipo
61689>>>>>>>>>>>                Set Size to 13 138
61690>>>>>>>>>>>                Set Location to 39 65
61691>>>>>>>>>>>                Set Color to clBtnFace
61692>>>>>>>>>>>                Set Label_Col_Offset to 2
61693>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61694>>>>>>>>>>>                Set Enabled_State to FALSE
61695>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61696>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61697>>>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
61698>>>>>>>>>>>                Set Shadow_State Item 0 to TRUE
61699>>>>>>>>>>>
61699>>>>>>>>>>>                //AB-StoreStart
61699>>>>>>>>>>>                Procedure End_Construct_Object
61701>>>>>>>>>>>                    Integer iDecimals
61702>>>>>>>>>>>                    Forward Send End_Construct_Object
61704>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0 to    iDecimals
61705>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61706>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals '  ,*'
61707>>>>>>>>>>>                End_Procedure
61708>>>>>>>>>>>                
61708>>>>>>>>>>>                
61708>>>>>>>>>>>                //AB-StoreEnd
61708>>>>>>>>>>>
61708>>>>>>>>>>>            End_Object    // payresp_Ypoloipo
61709>>>>>>>>>>>
61709>>>>>>>>>>>            Object TextBoxSub40 is a TextBoxSub
61711>>>>>>>>>>>                Set Label to "å©«à©ž"
61712>>>>>>>>>>>                Set Location to 23 9
61713>>>>>>>>>>>                Set Size to 10 39
61714>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61715>>>>>>>>>>>            End_Object    // TextBoxSub40
61716>>>>>>>>>>>
61716>>>>>>>>>>>            Object TextBoxSub41 is a TextBoxSub
61718>>>>>>>>>>>                Set Label to "•¨âà©ž"
61719>>>>>>>>>>>                Set Location to 9 9
61720>>>>>>>>>>>                Set Size to 10 36
61721>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61722>>>>>>>>>>>            End_Object    // TextBoxSub41
61723>>>>>>>>>>>
61723>>>>>>>>>>>            Object TextBoxSub42 is a TextBoxSub
61725>>>>>>>>>>>                Set Label to "“§æ¢¦ §¦"
61726>>>>>>>>>>>                Set Location to 39 9
61727>>>>>>>>>>>                Set Size to 10 43
61728>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61729>>>>>>>>>>>            End_Object    // TextBoxSub42
61730>>>>>>>>>>>
61730>>>>>>>>>>>            Object TextBoxSub44 is a TextBoxSub
61732>>>>>>>>>>>                Set Label to "OverHead"
61733>>>>>>>>>>>                Set Location to 80 9
61734>>>>>>>>>>>                Set Size to 10 45
61735>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61736>>>>>>>>>>>            End_Object    // TextBoxSub44
61737>>>>>>>>>>>
61737>>>>>>>>>>>            Object payresp_Plafon is a dbFormSub
61739>>>>>>>>>>>                Entry_Item Payresp.Plafon
61740>>>>>>>>>>>                Set Size to 13 138
61741>>>>>>>>>>>                Set Location to 57 65
61742>>>>>>>>>>>                Set Label_Col_Offset to 2
61743>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61744>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61745>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61746>>>>>>>>>>>
61746>>>>>>>>>>>                //AB-StoreStart
61746>>>>>>>>>>>                Procedure End_Construct_Object
61748>>>>>>>>>>>                    Integer iDecimals
61749>>>>>>>>>>>                    Forward Send End_Construct_Object
61751>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
61752>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61753>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
61754>>>>>>>>>>>                End_Procedure
61755>>>>>>>>>>>                
61755>>>>>>>>>>>                
61755>>>>>>>>>>>                
61755>>>>>>>>>>>                //AB-StoreEnd
61755>>>>>>>>>>>
61755>>>>>>>>>>>            End_Object    // payresp_Plafon
61756>>>>>>>>>>>
61756>>>>>>>>>>>            Object payresp_Overhead is a dbFormSub
61758>>>>>>>>>>>                Entry_Item Payresp.Overhead
61759>>>>>>>>>>>                Set Size to 13 138
61760>>>>>>>>>>>                Set Location to 80 65
61761>>>>>>>>>>>                Set Color to clBtnFace
61762>>>>>>>>>>>                Set Label_Col_Offset to 2
61763>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61764>>>>>>>>>>>                Set Enabled_State to FALSE
61765>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61766>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61767>>>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
61768>>>>>>>>>>>                Set Shadow_State Item 0 to TRUE
61769>>>>>>>>>>>
61769>>>>>>>>>>>                //AB-StoreStart
61769>>>>>>>>>>>                Procedure End_Construct_Object
61771>>>>>>>>>>>                    Integer iDecimals
61772>>>>>>>>>>>                    Forward Send End_Construct_Object
61774>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
61775>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61776>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals '  ,*'
61777>>>>>>>>>>>                End_Procedure
61778>>>>>>>>>>>                
61778>>>>>>>>>>>                
61778>>>>>>>>>>>                //AB-StoreEnd
61778>>>>>>>>>>>
61778>>>>>>>>>>>            End_Object    // payresp_Overhead
61779>>>>>>>>>>>
61779>>>>>>>>>>>            Object TextBoxSub64 is a TextBoxSub
61781>>>>>>>>>>>                Set Label to "‘¬¤¦¢ ¡ã Ž­œ ¢ã"
61782>>>>>>>>>>>                Set Location to 115 3
61783>>>>>>>>>>>                Set Size to 12 55
61784>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61785>>>>>>>>>>>            End_Object    // TextBoxSub64
61786>>>>>>>>>>>
61786>>>>>>>>>>>            Object Payresp_Synolikh_Ofeilh is a dbFormSub
61788>>>>>>>>>>>                Entry_Item Payresp.Synolikh_ofeilh
61789>>>>>>>>>>>                Set Size to 13 138
61790>>>>>>>>>>>                Set Location to 115 65
61791>>>>>>>>>>>                Set Color to clBtnFace
61792>>>>>>>>>>>                Set Label_Col_Offset to 2
61793>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61794>>>>>>>>>>>                Set Enabled_State to FALSE
61795>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61796>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61797>>>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
61798>>>>>>>>>>>                Set Shadow_State Item 0 to TRUE
61799>>>>>>>>>>>
61799>>>>>>>>>>>                //AB-StoreStart
61799>>>>>>>>>>>                Procedure End_Construct_Object
61801>>>>>>>>>>>                    Integer iDecimals
61802>>>>>>>>>>>                    Forward Send End_Construct_Object
61804>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0 to    iDecimals
61805>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61806>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
61807>>>>>>>>>>>                End_Procedure
61808>>>>>>>>>>>                
61808>>>>>>>>>>>                
61808>>>>>>>>>>>                
61808>>>>>>>>>>>                //AB-StoreEnd
61808>>>>>>>>>>>
61808>>>>>>>>>>>            End_Object    // Payresp_Synolikh_Ofeilh
61809>>>>>>>>>>>
61809>>>>>>>>>>>            Object Payresp_Poso_Se_Apait is a dbFormSub
61811>>>>>>>>>>>                Entry_Item Payresp.Poso_se_apait
61812>>>>>>>>>>>                Set Label to "„§ ©­˜¢ã §¦©á"
61813>>>>>>>>>>>                Set Size to 13 114
61814>>>>>>>>>>>                Set Location to 98 303
61815>>>>>>>>>>>                Set Label_Col_Offset to 2
61816>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61817>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61818>>>>>>>>>>>
61818>>>>>>>>>>>                //AB-StoreStart
61818>>>>>>>>>>>                Set Item_Option Item 0  to NoEnter True
61819>>>>>>>>>>>                Set TextColor           to clRed
61820>>>>>>>>>>>                
61820>>>>>>>>>>>                Procedure End_Construct_Object
61822>>>>>>>>>>>                    Integer iDecimals
61823>>>>>>>>>>>                    Forward Send End_Construct_Object
61825>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
61826>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61827>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
61828>>>>>>>>>>>                End_Procedure
61829>>>>>>>>>>>                
61829>>>>>>>>>>>                //AB-StoreEnd
61829>>>>>>>>>>>
61829>>>>>>>>>>>            End_Object    // Payresp_Poso_Se_Apait
61830>>>>>>>>>>>
61830>>>>>>>>>>>            Object Textbox1 is a Textbox
61832>>>>>>>>>>>                Set Label to "î¨ ¦ ‘¬¤.Ž­œ ¢ãª "
61833>>>>>>>>>>>                Set Location to 98 3
61834>>>>>>>>>>>                Set Size to 10 53
61835>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61836>>>>>>>>>>>            End_Object    // Textbox1
61837>>>>>>>>>>>
61837>>>>>>>>>>>            Object Payresp_Stoxos_Ipal is a dbFormSub
61839>>>>>>>>>>>                Entry_Item Payresp.Stoxos_ipal
61840>>>>>>>>>>>                Set Label to "‘«æ®¦ª †€Š"
61841>>>>>>>>>>>                Set Size to 13 33
61842>>>>>>>>>>>                Set Location to 36 260
61843>>>>>>>>>>>                Set Label_Col_Offset to 2
61844>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61845>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61846>>>>>>>>>>>
61846>>>>>>>>>>>                //AB-StoreStart
61846>>>>>>>>>>>                Set Points Item 0 to 0
61847>>>>>>>>>>>                Set Numeric_Mask Item 0 to 14 0 ' ,*'
61848>>>>>>>>>>>                //AB-StoreEnd
61848>>>>>>>>>>>
61848>>>>>>>>>>>            End_Object    // Payresp_Stoxos_Ipal
61849>>>>>>>>>>>
61849>>>>>>>>>>>            Object Payresp_Stoxos_Ipso is a dbFormSub
61851>>>>>>>>>>>                Entry_Item Payresp.Stoxos_ipso
61852>>>>>>>>>>>                Set Label to "‘«æ®¦ª †‘Ž"
61853>>>>>>>>>>>                Set Size to 13 33
61854>>>>>>>>>>>                Set Location to 56 260
61855>>>>>>>>>>>                Set Label_Col_Offset to 2
61856>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61857>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61858>>>>>>>>>>>
61858>>>>>>>>>>>                //AB-StoreStart
61858>>>>>>>>>>>                Set Points Item 0 to 0
61859>>>>>>>>>>>                Set Numeric_Mask Item 0 to 14 0 ' ,*'
61860>>>>>>>>>>>                //AB-StoreEnd
61860>>>>>>>>>>>
61860>>>>>>>>>>>            End_Object    // Payresp_Stoxos_Ipso
61861>>>>>>>>>>>
61861>>>>>>>>>>>            Object Payresp_Orio_Syn_Ofeilh is a dbFormSub
61863>>>>>>>>>>>                Entry_Item Payresp.Orio_syn_ofeilh
61864>>>>>>>>>>>                Set Size to 13 138
61865>>>>>>>>>>>                Set Location to 98 65
61866>>>>>>>>>>>                Set Label_Col_Offset to 2
61867>>>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
61868>>>>>>>>>>>                Set Form_FontWeight Item 0 to 600
61869>>>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
61870>>>>>>>>>>>
61870>>>>>>>>>>>                //AB-StoreStart
61870>>>>>>>>>>>                Procedure End_Construct_Object
61872>>>>>>>>>>>                    Integer iDecimals
61873>>>>>>>>>>>                    Forward Send End_Construct_Object
61875>>>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecimals
61876>>>>>>>>>>>                    Set Points Item 0 to iDecimals
61877>>>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
61878>>>>>>>>>>>                End_Procedure
61879>>>>>>>>>>>                //AB-StoreEnd
61879>>>>>>>>>>>
61879>>>>>>>>>>>            End_Object    // Payresp_Orio_Syn_Ofeilh
61880>>>>>>>>>>>
61880>>>>>>>>>>>            Object TextBoxSub65 is a TextBoxSub
61882>>>>>>>>>>>                Set Label to "A¤¦ ®«æª Š¦š/£æª"
61883>>>>>>>>>>>                Set Location to 58 0
61884>>>>>>>>>>>                Set Size to 10 62
61885>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61886>>>>>>>>>>>            End_Object    // TextBoxSub65
61887>>>>>>>>>>>
61887>>>>>>>>>>>            Object Textbox2 is a Textbox
61889>>>>>>>>>>>                Set Label to "”œ¨œšš¬æ«ž«˜ ”¦¨â˜"
61890>>>>>>>>>>>                Set Location to 115 221
61891>>>>>>>>>>>                Set Size to 10 81
61892>>>>>>>>>>>                Set TypeFace to "MS Sans Serif"
61893>>>>>>>>>>>            End_Object    // Textbox2
61894>>>>>>>>>>>
61894>>>>>>>>>>>            Object Payresp_Feregios is a dbComboFormSub
61896>>>>>>>>>>>                Entry_Item Payresp.Feregios
61897>>>>>>>>>>>                Set Size to 13 114
61898>>>>>>>>>>>                Set Location to 114 303
61899>>>>>>>>>>>                Set Label_Col_Offset to 2
61900>>>>>>>>>>>            End_Object    // Payresp_Feregios
61901>>>>>>>>>>>
61901>>>>>>>>>>>
61901>>>>>>>>>>>            //AB-StoreStart
61901>>>>>>>>>>>                                                                                                                                    
61901>>>>>>>>>>>            set label to "Ž ¡¦¤¦£ ¡á"
61902>>>>>>>>>>>            
61902>>>>>>>>>>>            
61902>>>>>>>>>>>            
61902>>>>>>>>>>>            //AB-StoreEnd
61902>>>>>>>>>>>
61902>>>>>>>>>>>        End_Object    // dbTabPageSub4
61903>>>>>>>>>>>
61903>>>>>>>>>>>        Object dbTabPageSub3 is a dbTabPageSub
61905>>>>>>>>>>>            Set Label to "dbTabPageSub3"
61906>>>>>>>>>>>            Object PrspBank_ is a dbGridSub
61908>>>>>>>>>>>
61908>>>>>>>>>>>                //AB-StoreTopStart
61908>>>>>>>>>>>                                                                                                                                                                            
61908>>>>>>>>>>>                //AB-StoreTopEnd
61908>>>>>>>>>>>
61908>>>>>>>>>>>                Set Main_File to Prspbank.File_Number
61909>>>>>>>>>>>                Set Server to (Prspbank_DD(self))
61910>>>>>>>>>>>                Set Size to 136 375
61911>>>>>>>>>>>                Set Location to 2 3
61912>>>>>>>>>>>                Set Wrap_State to TRUE
61913>>>>>>>>>>>
61913>>>>>>>>>>>                Begin_Row
61916>>>>>>>>>>>                    Entry_Item Prspbank.Bank_id
61917>>>>>>>>>>>                    Entry_Item (gsfCode_Mast('BANK',PrspBank.Bank_ID))
61918>>>>>>>>>>>                    Entry_Item Prspbank.Logariasmos
61919>>>>>>>>>>>                End_Row
61924>>>>>>>>>>>
61924>>>>>>>>>>>                Set Form_Width    item 0 to 73
61925>>>>>>>>>>>                Set Header_Label  item 0 to "’¨á§œ˜"
61926>>>>>>>>>>>                
61926>>>>>>>>>>>                Set Form_Width    item 1 to 138
61927>>>>>>>>>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
61928>>>>>>>>>>>                
61928>>>>>>>>>>>                Set Form_Width    item 2 to 155
61929>>>>>>>>>>>                Set Header_Label  item 2 to "Š¦š˜¨ ˜©£æª"
61930>>>>>>>>>>>                
61930>>>>>>>>>>>
61930>>>>>>>>>>>                //AB-StoreStart
61930>>>>>>>>>>>                                                                                                                                                                            
61930>>>>>>>>>>>                Set Column_Option Item 1 to NoEnter True
61931>>>>>>>>>>>                
61931>>>>>>>>>>>                Procedure Item_Change Integer iFromItem Integer iToItem Returns Integer
61933>>>>>>>>>>>                    String sID sVal
61934>>>>>>>>>>>                    Integer iBase iCI iCol rVal
61934>>>>>>>>>>>                    If (Focus(Desktop)=PrspBank_(Self)) Begin
61936>>>>>>>>>>>                        Get Base_Item           to iBase
61937>>>>>>>>>>>                        Get Value Item iBase    to sID
61938>>>>>>>>>>>                        If (Trim(sID)<>'') Set Value Item (iBase+1) to ;                                (gsfCode_Mast('BANK',sID))
61941>>>>>>>>>>>                    End
61941>>>>>>>>>>>>
61941>>>>>>>>>>>                    Forward Get Msg_Item_Change iFromItem iToItem to rVal
61943>>>>>>>>>>>                    Procedure_Return rVal
61944>>>>>>>>>>>                End_Procedure
61945>>>>>>>>>>>                
61945>>>>>>>>>>>                
61945>>>>>>>>>>>                Function Child_entering returns Integer
61947>>>>>>>>>>>                    Integer rval
61948>>>>>>>>>>>                    Forward Get Child_Entering to rVal
61950>>>>>>>>>>>                    If (NOT(rVal)) Begin
61952>>>>>>>>>>>                        If (Should_Save(payresp_DD(Self))) Send Request_Save to payresp_DD
61955>>>>>>>>>>>                    End
61955>>>>>>>>>>>>
61955>>>>>>>>>>>                    function_return rVal
61956>>>>>>>>>>>                End_Function
61957>>>>>>>>>>>                //AB-StoreEnd
61957>>>>>>>>>>>
61957>>>>>>>>>>>            End_Object    // PrspBank_
61958>>>>>>>>>>>
61958>>>>>>>>>>>
61958>>>>>>>>>>>            //AB-StoreStart
61958>>>>>>>>>>>                                                                                                                                    
61958>>>>>>>>>>>            Set Label to "’¨á§œœª"
61959>>>>>>>>>>>            
61959>>>>>>>>>>>            //AB-StoreEnd
61959>>>>>>>>>>>
61959>>>>>>>>>>>        End_Object    // dbTabPageSub3
61960>>>>>>>>>>>
61960>>>>>>>>>>>        Object dbTabPageSub4 is a dbTabPageSub
61962>>>>>>>>>>>            Set Label to "dbTabPageSub4"
61963>>>>>>>>>>>            Object Tppresp_ is a dbGridSub
61965>>>>>>>>>>>                Set Main_File to Tppresp.File_Number
61966>>>>>>>>>>>                Set Server to (Tppresp_DD(self))
61967>>>>>>>>>>>                Set Size to 141 480
61968>>>>>>>>>>>                Set Location to 2 4
61969>>>>>>>>>>>                Set Wrap_State to TRUE
61970>>>>>>>>>>>
61970>>>>>>>>>>>                Begin_Row
61973>>>>>>>>>>>                    Entry_Item Baxiokat.Baxiokat_descr
61974>>>>>>>>>>>                    Entry_Item Tppresp.Pct_epi_synolou
61975>>>>>>>>>>>                    Entry_Item Tppresp.Paralabh_meres
61976>>>>>>>>>>>                    Entry_Item Tppresp.Xarhtos_meres
61977>>>>>>>>>>>                    Entry_Item Tppresp.Plhroteo_meres
61978>>>>>>>>>>>                End_Row
61983>>>>>>>>>>>
61983>>>>>>>>>>>                Set Form_Width    item 0 to 161
61984>>>>>>>>>>>                Set Header_Label  item 0 to "’¨æ§¦ª"
61985>>>>>>>>>>>                
61985>>>>>>>>>>>                Set Form_Width    item 1 to 63
61986>>>>>>>>>>>                Set Header_Label  item 1 to "% œ§å ‘¬¤æ¢¦¬"
61987>>>>>>>>>>>                
61987>>>>>>>>>>>                Set Form_Width    item 2 to 73
61988>>>>>>>>>>>                Set Header_Label  item 2 to "˜¨˜¢˜™ã (£â¨œª)"
61989>>>>>>>>>>>                
61989>>>>>>>>>>>                Set Form_Width    item 3 to 88
61990>>>>>>>>>>>                Set Header_Label  item 3 to "ƒ á©«ž£˜ « £¦¢æšž©žª"
61991>>>>>>>>>>>                
61991>>>>>>>>>>>                Set Form_Width    item 4 to 90
61992>>>>>>>>>>>                Set Header_Label  item 4 to "Šã¥ž œ§ «˜šãª (†£â¨œª)"
61993>>>>>>>>>>>                
61993>>>>>>>>>>>
61993>>>>>>>>>>>                //AB-StoreStart
61993>>>>>>>>>>>                Function Child_entering returns Integer
61995>>>>>>>>>>>                    Integer rval
61996>>>>>>>>>>>                    Forward Get Child_Entering to rVal
61998>>>>>>>>>>>                    If (NOT(rVal)) Begin
62000>>>>>>>>>>>                        If (Should_Save(payresp_DD(Self))) Send Request_Save to payresp_DD
62003>>>>>>>>>>>                    End
62003>>>>>>>>>>>>
62003>>>>>>>>>>>                    function_return rVal
62004>>>>>>>>>>>                End_Function
62005>>>>>>>>>>>                
62005>>>>>>>>>>>                
62005>>>>>>>>>>>                
62005>>>>>>>>>>>                //AB-StoreEnd
62005>>>>>>>>>>>
62005>>>>>>>>>>>            End_Object    // Tppresp_
62006>>>>>>>>>>>
62006>>>>>>>>>>>
62006>>>>>>>>>>>            //AB-StoreStart
62006>>>>>>>>>>>                                                                                                                                    
62006>>>>>>>>>>>            set label to "’¨æ§¦  ¢ž¨à£ãª"
62007>>>>>>>>>>>            
62007>>>>>>>>>>>            //AB-StoreEnd
62007>>>>>>>>>>>
62007>>>>>>>>>>>        End_Object    // dbTabPageSub4
62008>>>>>>>>>>>
62008>>>>>>>>>>>
62008>>>>>>>>>>>        //AB-StoreStart
62008>>>>>>>>>>>                
62008>>>>>>>>>>>        //AB-StoreEnd
62008>>>>>>>>>>>
62008>>>>>>>>>>>    End_Object    // dbTabDialogSub2
62009>>>>>>>>>>>
62009>>>>>>>>>>>    Object TextBoxSub48 is a TextBoxSub
62011>>>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
62012>>>>>>>>>>>        Set Location to 23 347
62013>>>>>>>>>>>        Set Size to 10 31
62014>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62015>>>>>>>>>>>    End_Object    // TextBoxSub48
62016>>>>>>>>>>>
62016>>>>>>>>>>>    Object TextBoxSub60 is a TextBoxSub
62018>>>>>>>>>>>        Set Label to "œ¨ ¦®ã"
62019>>>>>>>>>>>        Set Location to 40 223
62020>>>>>>>>>>>        Set Size to 12 30
62021>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62022>>>>>>>>>>>    End_Object    // TextBoxSub60
62023>>>>>>>>>>>
62023>>>>>>>>>>>    Object TextBoxSub61 is a TextBoxSub
62025>>>>>>>>>>>        Set Label to "æ¢ž"
62026>>>>>>>>>>>        Set Location to 53 7
62027>>>>>>>>>>>        Set Size to 10 31
62028>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62029>>>>>>>>>>>    End_Object    // TextBoxSub61
62030>>>>>>>>>>>
62030>>>>>>>>>>>    Object TextBoxSub62 is a TextBoxSub
62032>>>>>>>>>>>        Set Label to "Œ¦£æª"
62033>>>>>>>>>>>        Set Location to 53 223
62034>>>>>>>>>>>        Set Size to 12 27
62035>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62036>>>>>>>>>>>    End_Object    // TextBoxSub62
62037>>>>>>>>>>>
62037>>>>>>>>>>>    Object TextBoxSub63 is a TextBoxSub
62039>>>>>>>>>>>        Set Label to "•é¨˜"
62040>>>>>>>>>>>        Set Location to 66 7
62041>>>>>>>>>>>        Set Size to 12 28
62042>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62043>>>>>>>>>>>    End_Object    // TextBoxSub63
62044>>>>>>>>>>>
62044>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
62046>>>>>>>>>>>        Set Label to "ButtonSub6"
62047>>>>>>>>>>>        Set Bitmap to "tvwbo16.bmp"
62048>>>>>>>>>>>        Set Size to 10 11
62049>>>>>>>>>>>        Set Location to 40 450
62050>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62051>>>>>>>>>>>
62051>>>>>>>>>>>        //AB-StoreStart
62051>>>>>>>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª œ¨ ¦®é¤"
62052>>>>>>>>>>>        Procedure OnClick
62054>>>>>>>>>>>           send activate_v197
62055>>>>>>>>>>>        End_Procedure // OnClick
62056>>>>>>>>>>>        
62056>>>>>>>>>>>        
62056>>>>>>>>>>>        //AB-StoreEnd
62056>>>>>>>>>>>
62056>>>>>>>>>>>    End_Object    // ButtonSub1
62057>>>>>>>>>>>
62057>>>>>>>>>>>    Object ButtonSub2 is a ButtonSub
62059>>>>>>>>>>>        Set Label to "ButtonSub6"
62060>>>>>>>>>>>        Set Bitmap to "tvwbo16.bmp"
62061>>>>>>>>>>>        Set Size to 10 11
62062>>>>>>>>>>>        Set Location to 54 202
62063>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62064>>>>>>>>>>>
62064>>>>>>>>>>>        //AB-StoreStart
62064>>>>>>>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª æ¢œà¤"
62065>>>>>>>>>>>        Procedure OnClick
62067>>>>>>>>>>>           send activate_v198
62068>>>>>>>>>>>        End_Procedure // OnClick
62069>>>>>>>>>>>        
62069>>>>>>>>>>>        
62069>>>>>>>>>>>        
62069>>>>>>>>>>>        //AB-StoreEnd
62069>>>>>>>>>>>
62069>>>>>>>>>>>    End_Object    // ButtonSub2
62070>>>>>>>>>>>
62070>>>>>>>>>>>
62070>>>>>>>>>>>    //AB-StoreStart
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>                                                    
62070>>>>>>>>>>>    //AB-StoreEnd
62070>>>>>>>>>>>
62070>>>>>>>>>>>End_Object    // v111
62071>>>>>>>>>>>
62071>>>>>>>>>>>
62071>>>>>>>>>>>//AB-StoreStart
62071>>>>>>>>>>>            
62071>>>>>>>>>>>            
62071>>>>>>>>>>>            
62071>>>>>>>>>>>//AB-StoreEnd
62071>>>>>>>>>>>
62071>>>>>>>>>>>//AB/ End_Object    // prj
62071>>>>>>>>>use sl012.sl
62071>>>>>>>>>use sl013.sl
62071>>>>>>>>>use cn.vw
INCLUDING FILE: CN.VW
62071>>>>>>>>>>>//AB/ Project CN : Constructions
62071>>>>>>>>>>>//AB/ Object prj is a View_Project
62071>>>>>>>>>>>//AB/     Set ProjectName to "CN : Constructions"
62071>>>>>>>>>>>//AB/     Set ProjectFileName to "CN.VW"
62071>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
62071>>>>>>>>>>>
62071>>>>>>>>>>>// Project Object Structure
62071>>>>>>>>>>>//   CN is a dbViewSub
62071>>>>>>>>>>>//     Cities_DD is a DataDictionary
62071>>>>>>>>>>>//     Payresp_DD is a DataDictionary
62071>>>>>>>>>>>//     Clients_DD is a DataDictionary
62071>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
62071>>>>>>>>>>>//     Constrct_DD is a DataDictionary
62071>>>>>>>>>>>//     Mhxanik_DD is a DataDictionary
62071>>>>>>>>>>>//     Cn_DD is a DataDictionary
62071>>>>>>>>>>>//     Container2 is a dbContainer3d
62071>>>>>>>>>>>//       Clients_Client_id is a dbForm
62071>>>>>>>>>>>//       Clients_Client_name is a dbForm
62071>>>>>>>>>>>//       Clients_Client_afm is a dbForm
62071>>>>>>>>>>>//       TextBoxSub5 is a TextBoxSub
62071>>>>>>>>>>>//       TextBoxSub6 is a TextBoxSub
62071>>>>>>>>>>>//       TextBoxSub7 is a TextBoxSub
62071>>>>>>>>>>>//     Cn_ is a dbGridSub
62071>>>>>>>>>>>//     btnPartl is a ButtonSub
62071>>>>>>>>>>>//     Cn_Cn_Codematch is a dbFormSub
62071>>>>>>>>>>>
62071>>>>>>>>>>>// Register all objects
62071>>>>>>>>>>>Register_Object btnPartl
62071>>>>>>>>>>>Register_Object Cities_DD
62071>>>>>>>>>>>Register_Object Clients_Client_afm
62071>>>>>>>>>>>Register_Object Clients_Client_id
62071>>>>>>>>>>>Register_Object Clients_Client_name
62071>>>>>>>>>>>Register_Object Clients_DD
62071>>>>>>>>>>>Register_Object CN
62071>>>>>>>>>>>Register_Object Cn_
62071>>>>>>>>>>>Register_Object Cn_Cn_Codematch
62071>>>>>>>>>>>Register_Object Cn_DD
62071>>>>>>>>>>>Register_Object Constrct_DD
62071>>>>>>>>>>>Register_Object Container2
62071>>>>>>>>>>>Register_Object Mhxanik_DD
62071>>>>>>>>>>>Register_Object Payresp_DD
62071>>>>>>>>>>>Register_Object Salesmen_DD
62071>>>>>>>>>>>Register_Object TextBoxSub5
62071>>>>>>>>>>>Register_Object TextBoxSub6
62071>>>>>>>>>>>Register_Object TextBoxSub7
62071>>>>>>>>>>>
62071>>>>>>>>>>>
62071>>>>>>>>>>>//AB/ AppBuild VIEW
62071>>>>>>>>>>>
62071>>>>>>>>>>>
62071>>>>>>>>>>>//AB-StoreTopStart
62071>>>>>>>>>>>use v041.vw
62071>>>>>>>>>>>//AB-StoreTopEnd
62071>>>>>>>>>>>
62071>>>>>>>>>>>//AB-IgnoreStart
62071>>>>>>>>>>>
62071>>>>>>>>>>>Use dbView.Sub
62071>>>>>>>>>>>Use DFAllEnt.pkg
62071>>>>>>>>>>>Use Txtbox.Sub
62071>>>>>>>>>>>Use dbGrid.Sub
62071>>>>>>>>>>>Use Button.Sub
62071>>>>>>>>>>>Use dbForm.Sub
62071>>>>>>>>>>>
62071>>>>>>>>>>>Use CITIES.DD
62071>>>>>>>>>>>Use PAYRESP.DD
62071>>>>>>>>>>>Use CLIENTS.DD
62071>>>>>>>>>>>Use SALESMEN.DD
62071>>>>>>>>>>>Use CONSTRCT.DD
62071>>>>>>>>>>>Use MHXANIK.DD
62071>>>>>>>>>>>Use CN.DD
62071>>>>>>>>>>>
62071>>>>>>>>>>>//AB-IgnoreEnd
62071>>>>>>>>>>>
62071>>>>>>>>>>>ACTIVATE_VIEW Activate_CN FOR CN
62075>>>>>>>>>>>
62075>>>>>>>>>>>Object CN is a dbViewSub
62077>>>>>>>>>>>
62077>>>>>>>>>>>    //AB-StoreTopStart
62077>>>>>>>>>>>    Property string psmodule public ''
62079>>>>>>>>>>>    Property String psClientID public ''
62081>>>>>>>>>>>    
62081>>>>>>>>>>>    //AB-StoreTopEnd
62081>>>>>>>>>>>
62081>>>>>>>>>>>    Set Label to "œ¢á«œª - „¨š˜"
62082>>>>>>>>>>>    Set Size to 284 513
62083>>>>>>>>>>>    Set Location to 2 9
62084>>>>>>>>>>>
62084>>>>>>>>>>>    //AB-DDOStart
62084>>>>>>>>>>>
62084>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
62086>>>>>>>>>>>
62086>>>>>>>>>>>        //AB-StoreStart
62086>>>>>>>>>>>        Set Read_Only_State to True
62087>>>>>>>>>>>        
62087>>>>>>>>>>>        
62087>>>>>>>>>>>        //AB-StoreEnd
62087>>>>>>>>>>>
62087>>>>>>>>>>>    End_Object    // Cities_DD
62088>>>>>>>>>>>
62088>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
62090>>>>>>>>>>>
62090>>>>>>>>>>>        //AB-StoreStart
62090>>>>>>>>>>>        Set Read_Only_State to True
62091>>>>>>>>>>>        
62091>>>>>>>>>>>        
62091>>>>>>>>>>>        
62091>>>>>>>>>>>        //AB-StoreEnd
62091>>>>>>>>>>>
62091>>>>>>>>>>>    End_Object    // Payresp_DD
62092>>>>>>>>>>>
62092>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
62094>>>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
62095>>>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
62096>>>>>>>>>>>
62096>>>>>>>>>>>        //AB-StoreStart
62096>>>>>>>>>>>        Set Read_Only_State to True
62097>>>>>>>>>>>        
62097>>>>>>>>>>>        
62097>>>>>>>>>>>        
62097>>>>>>>>>>>        //AB-StoreEnd
62097>>>>>>>>>>>
62097>>>>>>>>>>>    End_Object    // Clients_DD
62098>>>>>>>>>>>
62098>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
62100>>>>>>>>>>>
62100>>>>>>>>>>>        //AB-StoreStart
62100>>>>>>>>>>>        Set Read_Only_State to True
62101>>>>>>>>>>>        
62101>>>>>>>>>>>        
62101>>>>>>>>>>>        
62101>>>>>>>>>>>        //AB-StoreEnd
62101>>>>>>>>>>>
62101>>>>>>>>>>>    End_Object    // Salesmen_DD
62102>>>>>>>>>>>
62102>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
62104>>>>>>>>>>>
62104>>>>>>>>>>>        //AB-StoreStart
62104>>>>>>>>>>>        Set Read_Only_State to True
62105>>>>>>>>>>>        
62105>>>>>>>>>>>        
62105>>>>>>>>>>>        
62105>>>>>>>>>>>        //AB-StoreEnd
62105>>>>>>>>>>>
62105>>>>>>>>>>>    End_Object    // Constrct_DD
62106>>>>>>>>>>>
62106>>>>>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
62108>>>>>>>>>>>
62108>>>>>>>>>>>        //AB-StoreStart
62108>>>>>>>>>>>        Set Read_Only_State to True
62109>>>>>>>>>>>        
62109>>>>>>>>>>>        
62109>>>>>>>>>>>        
62109>>>>>>>>>>>        //AB-StoreEnd
62109>>>>>>>>>>>
62109>>>>>>>>>>>    End_Object    // Mhxanik_DD
62110>>>>>>>>>>>
62110>>>>>>>>>>>    Object Cn_DD is a Cn_DataDictionary
62112>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
62113>>>>>>>>>>>        Set DDO_Server to (Salesmen_DD(self))
62114>>>>>>>>>>>        Set DDO_Server to (Constrct_DD(self))
62115>>>>>>>>>>>        Set DDO_Server to (Mhxanik_DD(self))
62116>>>>>>>>>>>        Set Constrain_File to Clients.File_Number
62117>>>>>>>>>>>
62117>>>>>>>>>>>        //AB-StoreStart
62117>>>>>>>>>>>        Set Read_Only_State to True
62118>>>>>>>>>>>        
62118>>>>>>>>>>>        
62118>>>>>>>>>>>        //AB-StoreEnd
62118>>>>>>>>>>>
62118>>>>>>>>>>>    End_Object    // Cn_DD
62119>>>>>>>>>>>
62119>>>>>>>>>>>    Set Main_DD to (Clients_DD(self))
62120>>>>>>>>>>>    Set Server to (Clients_DD(self))
62121>>>>>>>>>>>
62121>>>>>>>>>>>    //AB-DDOEnd
62121>>>>>>>>>>>
62121>>>>>>>>>>>    Object Container2 is a dbContainer3d
62123>>>>>>>>>>>        Set Border_Style to Border_Normal
62124>>>>>>>>>>>        Set Size to 58 491
62125>>>>>>>>>>>        Set Location to 6 9
62126>>>>>>>>>>>        Object Clients_Client_id is a dbForm
62128>>>>>>>>>>>            Entry_Item Clients.Client_id
62129>>>>>>>>>>>            Set Size to 13 126
62130>>>>>>>>>>>            Set Location to 6 66
62131>>>>>>>>>>>            Set Label_Col_Offset to 2
62132>>>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
62133>>>>>>>>>>>
62133>>>>>>>>>>>            //AB-StoreStart
62133>>>>>>>>>>>            Procedure Prompt
62135>>>>>>>>>>>                Set psModule Of (sl100(Self)) to (psModule(cn(Self)))
62136>>>>>>>>>>>                Forward Send Prompt
62138>>>>>>>>>>>            End_Procedure
62139>>>>>>>>>>>            //AB-StoreEnd
62139>>>>>>>>>>>
62139>>>>>>>>>>>        End_Object    // Clients_Client_id
62140>>>>>>>>>>>
62140>>>>>>>>>>>        Object Clients_Client_name is a dbForm
62142>>>>>>>>>>>            Entry_Item Clients.Client_name
62143>>>>>>>>>>>            Set Size to 13 306
62144>>>>>>>>>>>            Set Location to 20 66
62145>>>>>>>>>>>            Set Label_Col_Offset to 2
62146>>>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
62147>>>>>>>>>>>        End_Object    // Clients_Client_name
62148>>>>>>>>>>>
62148>>>>>>>>>>>        Object Clients_Client_afm is a dbForm
62150>>>>>>>>>>>            Entry_Item Clients.Client_afm
62151>>>>>>>>>>>            Set Size to 13 71
62152>>>>>>>>>>>            Set Location to 36 66
62153>>>>>>>>>>>            Set Label_Col_Offset to 2
62154>>>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
62155>>>>>>>>>>>        End_Object    // Clients_Client_afm
62156>>>>>>>>>>>
62156>>>>>>>>>>>        Object TextBoxSub5 is a TextBoxSub
62158>>>>>>>>>>>            Set Label to "‰à› ¡æª œ¢á«ž"
62159>>>>>>>>>>>            Set Location to 7 7
62160>>>>>>>>>>>            Set Size to 10 57
62161>>>>>>>>>>>            Set TypeFace to "MS Sans Serif"
62162>>>>>>>>>>>        End_Object    // TextBoxSub5
62163>>>>>>>>>>>
62163>>>>>>>>>>>        Object TextBoxSub6 is a TextBoxSub
62165>>>>>>>>>>>            Set Label to "„§à¤¬£å˜"
62166>>>>>>>>>>>            Set Location to 22 7
62167>>>>>>>>>>>            Set Size to 10 41
62168>>>>>>>>>>>            Set TypeFace to "MS Sans Serif"
62169>>>>>>>>>>>        End_Object    // TextBoxSub6
62170>>>>>>>>>>>
62170>>>>>>>>>>>        Object TextBoxSub7 is a TextBoxSub
62172>>>>>>>>>>>            Set Label to "€.”.‹."
62173>>>>>>>>>>>            Set Location to 36 7
62174>>>>>>>>>>>            Set Size to 10 35
62175>>>>>>>>>>>            Set TypeFace to "MS Sans Serif"
62176>>>>>>>>>>>        End_Object    // TextBoxSub7
62177>>>>>>>>>>>
62177>>>>>>>>>>>
62177>>>>>>>>>>>        //AB-StoreStart
62177>>>>>>>>>>>                                                                                                                                        
62177>>>>>>>>>>>                                                                                                                                        
62177>>>>>>>>>>>                                                                                                                                        
62177>>>>>>>>>>>                                                                                                                                        
62177>>>>>>>>>>>        //AB-StoreEnd
62177>>>>>>>>>>>
62177>>>>>>>>>>>    End_Object    // Container2
62178>>>>>>>>>>>
62178>>>>>>>>>>>    Object Cn_ is a dbGridSub
62180>>>>>>>>>>>        Set Main_File to Cn.File_Number
62181>>>>>>>>>>>        Set Server to (Cn_DD(self))
62182>>>>>>>>>>>        Set Size to 168 493
62183>>>>>>>>>>>        Set Location to 70 8
62184>>>>>>>>>>>        Set Wrap_State to TRUE
62185>>>>>>>>>>>
62185>>>>>>>>>>>        Begin_Row
62188>>>>>>>>>>>            Entry_Item Cn.Cn_code
62189>>>>>>>>>>>            Entry_Item Cn.Cn_descr
62190>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
62191>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
62192>>>>>>>>>>>            Entry_Item Payresp.Presp_name
62193>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_name
62194>>>>>>>>>>>            Entry_Item Cn.Cn_start_date
62195>>>>>>>>>>>            Entry_Item Cn.Hm_tel_fortio
62196>>>>>>>>>>>        End_Row
62201>>>>>>>>>>>
62201>>>>>>>>>>>        Set Form_Width    item 0 to 45
62202>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª "
62203>>>>>>>>>>>        
62203>>>>>>>>>>>        Set Form_Width    item 1 to 88
62204>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ë¨š¦¬"
62205>>>>>>>>>>>        
62205>>>>>>>>>>>        Set Form_Width    item 2 to 65
62206>>>>>>>>>>>        Set Header_Label  item 2 to "„¨š¦¢á™¦ª"
62207>>>>>>>>>>>        
62207>>>>>>>>>>>        Set Form_Width    item 3 to 65
62208>>>>>>>>>>>        Set Header_Label  item 3 to "à¢ž«ãª"
62209>>>>>>>>>>>        
62209>>>>>>>>>>>        Set Form_Width    item 4 to 70
62210>>>>>>>>>>>        Set Header_Label  item 4 to "“§œçŸ. ¢ž¨à£é¤"
62211>>>>>>>>>>>        
62211>>>>>>>>>>>        Set Form_Width    item 5 to 60
62212>>>>>>>>>>>        Set Header_Label  item 5 to "‹ž®˜¤ ¡æª"
62213>>>>>>>>>>>        
62213>>>>>>>>>>>        Set Form_Width    item 6 to 47
62214>>>>>>>>>>>        Set Header_Label  item 6 to "„¤˜¨¥ž"
62215>>>>>>>>>>>        
62215>>>>>>>>>>>        Set Form_Width    item 7 to 47
62216>>>>>>>>>>>        Set Header_Label  item 7 to "’œ¢.”¦¨«å¦"
62217>>>>>>>>>>>        
62217>>>>>>>>>>>
62217>>>>>>>>>>>        //AB-StoreStart
62217>>>>>>>>>>>        set read_only_state to true
62218>>>>>>>>>>>        
62218>>>>>>>>>>>        //AB-StoreEnd
62218>>>>>>>>>>>
62218>>>>>>>>>>>    End_Object    // Cn_
62219>>>>>>>>>>>
62219>>>>>>>>>>>    Object btnPartl is a ButtonSub
62221>>>>>>>>>>>        Set Label to "ButtonSub1"
62222>>>>>>>>>>>        Set Bitmap to "Filesys3.bmp"
62223>>>>>>>>>>>        Set Size to 22 25
62224>>>>>>>>>>>        Set Location to 246 11
62225>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62226>>>>>>>>>>>
62226>>>>>>>>>>>        //AB-StoreStart
62226>>>>>>>>>>>                                                                                
62226>>>>>>>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ â¨šà¤"
62227>>>>>>>>>>>        
62227>>>>>>>>>>>        Procedure OnClick
62229>>>>>>>>>>>                string scnid
62230>>>>>>>>>>>                get field_current_value of cn_dd field cn.cn_code to scnid
62231>>>>>>>>>>>                set pscncode of (v041(self)) to scnid
62232>>>>>>>>>>>                send activate_v041
62233>>>>>>>>>>>        End_Procedure // OnClick
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        
62234>>>>>>>>>>>        //AB-StoreEnd
62234>>>>>>>>>>>
62234>>>>>>>>>>>    End_Object    // btnPartl
62235>>>>>>>>>>>
62235>>>>>>>>>>>    Object Cn_Cn_Codematch is a dbFormSub
62237>>>>>>>>>>>        Entry_Item Cn.Cn_codematch
62238>>>>>>>>>>>        Set Server to (Cn_DD(self))
62239>>>>>>>>>>>        Set Size to 13 65
62240>>>>>>>>>>>        Set Location to 250 431
62241>>>>>>>>>>>        Set Color to clBtnFace
62242>>>>>>>>>>>        Set TextColor to 185
62243>>>>>>>>>>>        Set Label_Col_Offset to 2
62244>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62245>>>>>>>>>>>        Set Enabled_State to FALSE
62246>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
62247>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62248>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
62249>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
62250>>>>>>>>>>>    End_Object    // Cn_Cn_Codematch
62251>>>>>>>>>>>
62251>>>>>>>>>>>
62251>>>>>>>>>>>    //AB-StoreStart
62251>>>>>>>>>>>                
62251>>>>>>>>>>>                
62251>>>>>>>>>>>    Procedure Activate_View Returns Integer
62253>>>>>>>>>>>        String  sModule
62254>>>>>>>>>>>        Integer rVal iCurRec
62254>>>>>>>>>>>        //Get psMenuModule  Of Main_Menu  to sModule
62254>>>>>>>>>>>        Set psModule to '01'  //sModule
62255>>>>>>>>>>>        Forward Get Msg_Activate_View to rVal
62257>>>>>>>>>>>        If (psClientID(Self)<>'') Begin
62259>>>>>>>>>>>            Send Clear to Clients_DD
62260>>>>>>>>>>>            Move (psClientID(Self)) to Clients.Client_ID
62261>>>>>>>>>>>            Send Find to Clients_DD Eq 6
62262>>>>>>>>>>>        End
62262>>>>>>>>>>>>
62262>>>>>>>>>>>        Procedure_Return rVal
62263>>>>>>>>>>>    End_Procedure
62264>>>>>>>>>>>    
62264>>>>>>>>>>>    
62264>>>>>>>>>>>    
62264>>>>>>>>>>>    
62264>>>>>>>>>>>    
62264>>>>>>>>>>>    
62264>>>>>>>>>>>    //AB-StoreEnd
62264>>>>>>>>>>>
62264>>>>>>>>>>>End_Object    // CN
62265>>>>>>>>>>>
62265>>>>>>>>>>>
62265>>>>>>>>>>>//AB-StoreStart
62265>>>>>>>>>>>                        
62265>>>>>>>>>>>//AB-StoreEnd
62265>>>>>>>>>>>
62265>>>>>>>>>>>//AB/ End_Object    // prj
62265>>>>>>>>>use sl002.sl
62265>>>>>>>>>
62265>>>>>>>>>//AB-StoreTopEnd
62265>>>>>>>>>
62265>>>>>>>>>//AB-IgnoreStart
62265>>>>>>>>>
62265>>>>>>>>>Use dbViews.Sub
62265>>>>>>>>>Use DFAllEnt.pkg
62265>>>>>>>>>Use dbForm.Sub
62265>>>>>>>>>Use Txtbox.Sub
62265>>>>>>>>>Use dbTabdlg.Sub
62265>>>>>>>>>Use dbCmbfrm.Sub
62265>>>>>>>>>Use dbEdit.Sub
62265>>>>>>>>>Use Button.Sub
62265>>>>>>>>>Use Form.Sub
62265>>>>>>>>>Use dbChkbox.Sub
62265>>>>>>>>>Use dbForms.Sub
62265>>>>>>>>>Use dbGrid.Sub
62265>>>>>>>>>
62265>>>>>>>>>Use BAXIOKAT.DD
62265>>>>>>>>>Use COUNTRY.DD
62265>>>>>>>>>Use TOWNS.DD
62265>>>>>>>>>Use CITIES.DD
62265>>>>>>>>>Use PAYRESP.DD
62265>>>>>>>>>Use AREAS.DD
62265>>>>>>>>>Use CLIENTS.DD
62265>>>>>>>>>Use SALESMEN.DD
62265>>>>>>>>>Use MHXANIK.DD
62265>>>>>>>>>Use CONSTRCT.DD
62265>>>>>>>>>Use CN.DD
62265>>>>>>>>>Use CLNBANK.DD
INCLUDING FILE: CLNBANK.DD
62265>>>>>>>>>>>//DDB-FileStart
62265>>>>>>>>>>>//DDB-HeaderStart
62265>>>>>>>>>>>
62265>>>>>>>>>>>// File Name : CLNBANK.DD
62265>>>>>>>>>>>// Class Name: Clnbank_DataDictionary
62265>>>>>>>>>>>// Revision  : 4
62265>>>>>>>>>>>// Version   : 2
62265>>>>>>>>>>>
62265>>>>>>>>>>>Use  Windows           // Basic Definitions
62265>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
62265>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
62265>>>>>>>>>>>
62265>>>>>>>>>>>Open Clnbank
62267>>>>>>>>>>>Open Clients
62269>>>>>>>>>>>
62269>>>>>>>>>>>//DDB-HeaderEnd
62269>>>>>>>>>>>//DDB-ValidationStart
62269>>>>>>>>>>>
62269>>>>>>>>>>>Register_Object Clnbank_Bank_Id_VT
62269>>>>>>>>>>>
62269>>>>>>>>>>>Object Clnbank_Bank_Id_VT  is a CodeValidationTable
62271>>>>>>>>>>>    Set Type_Value        To "BANK"
62272>>>>>>>>>>>    //DDB-ValidationCustomStart
62272>>>>>>>>>>>    //DDB-ValidationCustomEnd
62272>>>>>>>>>>>End_Object   // Clnbank_Bank_Id_VT
62273>>>>>>>>>>>//DDB-ValidationEnd
62273>>>>>>>>>>>
62273>>>>>>>>>>>Class Clnbank_DataDictionary  is a DataDictionary_Sec
62274>>>>>>>>>>>
62274>>>>>>>>>>>    // Define_Fields:
62274>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
62274>>>>>>>>>>>
62274>>>>>>>>>>>    Procedure Define_Fields
62275>>>>>>>>>>>        Forward Send Define_Fields
62277>>>>>>>>>>>        //DDB-Generated-Code-Location
62277>>>>>>>>>>>        //DDB-DefineFieldStart
62277>>>>>>>>>>>
62277>>>>>>>>>>>        Set Main_File            To Clnbank.File_Number
62278>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
62279>>>>>>>>>>>
62279>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
62280>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
62281>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
62282>>>>>>>>>>>
62282>>>>>>>>>>>        // Parent (Server) file structure...............
62282>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
62283>>>>>>>>>>>
62283>>>>>>>>>>>        // Field-based properties.......................
62283>>>>>>>>>>>
62283>>>>>>>>>>>        // Clnbank.Client_Id
62283>>>>>>>>>>>
62283>>>>>>>>>>>        // Clnbank.Bank_Id
62283>>>>>>>>>>>        Set Field_Value_Table      Field Clnbank.Bank_Id To (Clnbank_Bank_Id_VT(Self))
62284>>>>>>>>>>>
62284>>>>>>>>>>>        // Clnbank.Logariasmos
62284>>>>>>>>>>>
62284>>>>>>>>>>>        //DDB-DefineFieldEnd
62284>>>>>>>>>>>    End_Procedure    // Define_Fields
62285>>>>>>>>>>>
62285>>>>>>>>>>>    // Field_Defaults:
62285>>>>>>>>>>>    // This procedure is used to establish default field values.
62285>>>>>>>>>>>
62285>>>>>>>>>>>    Procedure Field_Defaults
62286>>>>>>>>>>>        Forward Send Field_Defaults
62288>>>>>>>>>>>        //DDB-Generated-Code-Location
62288>>>>>>>>>>>        //DDB-FieldDefaultStart
62288>>>>>>>>>>>        //DDB-FieldDefaultEnd
62288>>>>>>>>>>>    End_Procedure    // Field_Defaults
62289>>>>>>>>>>>
62289>>>>>>>>>>>End_Class    // Clnbank_DataDictionary
62290>>>>>>>>>>>//DDB-FileEnd
62290>>>>>>>>>Use TPCLIENT.DD
INCLUDING FILE: TPCLIENT.DD
62290>>>>>>>>>>>//DDB-FileStart
62290>>>>>>>>>>>//DDB-HeaderStart
62290>>>>>>>>>>>
62290>>>>>>>>>>>// File Name : TPCLIENT.DD
62290>>>>>>>>>>>// Class Name: Tpclient_DataDictionary
62290>>>>>>>>>>>// Revision  : 9
62290>>>>>>>>>>>// Version   : 2
62290>>>>>>>>>>>
62290>>>>>>>>>>>Use  Windows           // Basic Definitions
62290>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
62290>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
62290>>>>>>>>>>>
62290>>>>>>>>>>>Open Tpclient
62292>>>>>>>>>>>Open Clients
62294>>>>>>>>>>>Open Baxiokat
62296>>>>>>>>>>>Open Sysrecc
62298>>>>>>>>>>>
62298>>>>>>>>>>>//DDB-HeaderEnd
62298>>>>>>>>>>>
62298>>>>>>>>>>>Class Tpclient_DataDictionary  is a DataDictionary_Sec
62299>>>>>>>>>>>
62299>>>>>>>>>>>    Procedure Save_Main_File
62300>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
62302>>>>>>>>>>>            If TPClient.Recnum Eq 0 Procedure_Return
62305>>>>>>>>>>>        End
62305>>>>>>>>>>>>
62305>>>>>>>>>>>        Forward Send Save_Main_File
62307>>>>>>>>>>>    End_Procedure
62308>>>>>>>>>>>
62308>>>>>>>>>>>
62308>>>>>>>>>>>    Procedure Creating
62309>>>>>>>>>>>        Forward Send Creating
62311>>>>>>>>>>>        // Insert Code Here
62311>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(TPClient.TPClient_Rec0))))));                                    to TPClient.TPClient_Recr
62312>>>>>>>>>>>    End_Procedure   // Creating
62313>>>>>>>>>>>
62313>>>>>>>>>>>
62313>>>>>>>>>>>    // Define_Fields:
62313>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
62313>>>>>>>>>>>
62313>>>>>>>>>>>    Procedure Define_Fields
62314>>>>>>>>>>>        Forward Send Define_Fields
62316>>>>>>>>>>>        //DDB-Generated-Code-Location
62316>>>>>>>>>>>        //DDB-DefineFieldStart
62316>>>>>>>>>>>
62316>>>>>>>>>>>        Set Main_File            To Tpclient.File_Number
62317>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
62318>>>>>>>>>>>
62318>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
62319>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
62320>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
62321>>>>>>>>>>>
62321>>>>>>>>>>>        // Parent (Server) file structure...............
62321>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
62322>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
62323>>>>>>>>>>>
62323>>>>>>>>>>>        // External (System) file structure.............
62323>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
62324>>>>>>>>>>>
62324>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tpclient_Rec0  To Tpclient.Tpclient_Rec0
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Field-based properties.......................
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Client_Id
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Baxiokat_Code
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Pct_Epi_Synolou
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Paralabh_Meres
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Xarhtos_Meres
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Plhroteo_Meres
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Tpclient_Rec0
62327>>>>>>>>>>>
62327>>>>>>>>>>>        // Tpclient.Tpclient_Recr
62327>>>>>>>>>>>
62327>>>>>>>>>>>        //DDB-DefineFieldEnd
62327>>>>>>>>>>>    End_Procedure    // Define_Fields
62328>>>>>>>>>>>
62328>>>>>>>>>>>    // Field_Defaults:
62328>>>>>>>>>>>    // This procedure is used to establish default field values.
62328>>>>>>>>>>>
62328>>>>>>>>>>>    Procedure Field_Defaults
62329>>>>>>>>>>>        Forward Send Field_Defaults
62331>>>>>>>>>>>        //DDB-Generated-Code-Location
62331>>>>>>>>>>>        //DDB-FieldDefaultStart
62331>>>>>>>>>>>        //DDB-FieldDefaultEnd
62331>>>>>>>>>>>    End_Procedure    // Field_Defaults
62332>>>>>>>>>>>
62332>>>>>>>>>>>End_Class    // Tpclient_DataDictionary
62333>>>>>>>>>>>//DDB-FileEnd
62333>>>>>>>>>Use CLITEM.DD
INCLUDING FILE: CLITEM.DD
62333>>>>>>>>>>>//DDB-FileStart
62333>>>>>>>>>>>//DDB-HeaderStart
62333>>>>>>>>>>>
62333>>>>>>>>>>>// File Name : CLITEM.DD
62333>>>>>>>>>>>// Class Name: Clitem_DataDictionary
62333>>>>>>>>>>>// Revision  : 4
62333>>>>>>>>>>>// Version   : 2
62333>>>>>>>>>>>
62333>>>>>>>>>>>Use  Windows           // Basic Definitions
62333>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
62333>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
62333>>>>>>>>>>>
62333>>>>>>>>>>>Open Clitem
62335>>>>>>>>>>>Open Clients
62337>>>>>>>>>>>
62337>>>>>>>>>>>//DDB-HeaderEnd
62337>>>>>>>>>>>
62337>>>>>>>>>>>Class Clitem_DataDictionary  is a DataDictionary_sec
62338>>>>>>>>>>>     
62338>>>>>>>>>>>      Procedure Update
62339>>>>>>>>>>>        Forward Send Update
62341>>>>>>>>>>>        // Insert Code Here
62341>>>>>>>>>>>        Move clients.client_id  to Clitem.client_id 
62342>>>>>>>>>>>      end_procedure
62343>>>>>>>>>>>     
62343>>>>>>>>>>>    // Define_Fields:
62343>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
62343>>>>>>>>>>>
62343>>>>>>>>>>>    Procedure Define_Fields
62344>>>>>>>>>>>        Forward Send Define_Fields
62346>>>>>>>>>>>        //DDB-Generated-Code-Location
62346>>>>>>>>>>>        //DDB-DefineFieldStart
62346>>>>>>>>>>>
62346>>>>>>>>>>>        Set Main_File            To Clitem.File_Number
62347>>>>>>>>>>>
62347>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
62348>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
62349>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
62350>>>>>>>>>>>
62350>>>>>>>>>>>        // Parent (Server) file structure...............
62350>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
62351>>>>>>>>>>>
62351>>>>>>>>>>>        // Field-based properties.......................
62351>>>>>>>>>>>
62351>>>>>>>>>>>        // Clitem.Client_Id
62351>>>>>>>>>>>
62351>>>>>>>>>>>        // Clitem.Item_Code
62351>>>>>>>>>>>
62351>>>>>>>>>>>        // Clitem.Item_Date
62351>>>>>>>>>>>        Set Field_Mask_Type        Field Clitem.Item_Date To MASK_DATE_WINDOW
62352>>>>>>>>>>>
62352>>>>>>>>>>>        // Clitem.Item_Price
62352>>>>>>>>>>>
62352>>>>>>>>>>>        // Clitem.Item_Pctdisc
62352>>>>>>>>>>>
62352>>>>>>>>>>>        // Clitem.Item_Axia
62352>>>>>>>>>>>
62352>>>>>>>>>>>        //DDB-DefineFieldEnd
62352>>>>>>>>>>>    End_Procedure    // Define_Fields
62353>>>>>>>>>>>
62353>>>>>>>>>>>    // Field_Defaults:
62353>>>>>>>>>>>    // This procedure is used to establish default field values.
62353>>>>>>>>>>>
62353>>>>>>>>>>>    Procedure Field_Defaults
62354>>>>>>>>>>>        Forward Send Field_Defaults
62356>>>>>>>>>>>        //DDB-Generated-Code-Location
62356>>>>>>>>>>>        //DDB-FieldDefaultStart
62356>>>>>>>>>>>        //DDB-FieldDefaultEnd
62356>>>>>>>>>>>    End_Procedure    // Field_Defaults
62357>>>>>>>>>>>
62357>>>>>>>>>>>End_Class    // Clitem_DataDictionary
62358>>>>>>>>>>>//DDB-FileEnd
62358>>>>>>>>>
62358>>>>>>>>>//AB-IgnoreEnd
62358>>>>>>>>>
62358>>>>>>>>>ACTIVATE_VIEW Activate_VWCLIENTS FOR VWCLIENTS
62362>>>>>>>>>
62362>>>>>>>>>Object VWCLIENTS is a dbViewSubs
62364>>>>>>>>>
62364>>>>>>>>>    //AB-StoreTopStart
62364>>>>>>>>>    property string  psclient    public ''
62366>>>>>>>>>    Property String  psModule    Public ''
62368>>>>>>>>>    Property string  psanal      public ''
62370>>>>>>>>>    //        Property string  psnanal     public ''
62370>>>>>>>>>    Property string  psendo      public ''
62372>>>>>>>>>    Property string  psnendo     public ''
62374>>>>>>>>>    Property string  psxondr     public ''
62376>>>>>>>>>    Property string  psnxondr    public ''
62378>>>>>>>>>    Property string  psdhmos     public ''
62380>>>>>>>>>    Property string  psndhmos    public ''
62382>>>>>>>>>    Property string  psnpdd      public ''
62384>>>>>>>>>    Property string  psnnpdd     public ''
62386>>>>>>>>>    Property string  psafm       public ''
62388>>>>>>>>>    Property string  psnafm      public ''
62390>>>>>>>>>    Property string  psdoy       public ''
62392>>>>>>>>>    Property string  psndoy      public ''
62394>>>>>>>>>    Property string  psname      public ''
62396>>>>>>>>>    Property string  psnname     public ''
62398>>>>>>>>>    Property integer pijob       public ''
62400>>>>>>>>>    Property integer pinjob      public ''
62402>>>>>>>>>    Property integer picity      public ''
62404>>>>>>>>>    Property integer pincity     public ''
62406>>>>>>>>>    Property string  psodos      public ''
62408>>>>>>>>>    Property string  psnodos     public ''
62410>>>>>>>>>    Property string  psodosnr    public ''
62412>>>>>>>>>    Property string  psnodosnr   public ''
62414>>>>>>>>>    Property string  pszip       public 0
62416>>>>>>>>>    Property string  psnzip      public 0
62418>>>>>>>>>    Property string  pstel       public ''
62420>>>>>>>>>    Property string  psntel      public ''
62422>>>>>>>>>    property integer picreate    public 0
62424>>>>>>>>>    PROPERTY String  psparast    public ''
62426>>>>>>>>>    property string  psnparast   public ''
62428>>>>>>>>>    
62428>>>>>>>>>    Object Payresp_DD2 is a Payresp_DataDictionary
62430>>>>>>>>>    End_Object    // Payresp_DD2
62431>>>>>>>>>    
62431>>>>>>>>>    
62431>>>>>>>>>    Object cn_DD is a cn_DataDictionary
62433>>>>>>>>>    End_Object    // cn
62434>>>>>>>>>    
62434>>>>>>>>>    Function Confirm_Save_clients Returns Integer
62436>>>>>>>>>        local integer NoSave Srvr Rec
62437>>>>>>>>>        Get Server to Srvr
62438>>>>>>>>>        Get Current_Record of Srvr to Rec
62439>>>>>>>>>        Get Confirm "„šš¨˜­ã ©«¦ ®œåà¤ œ¢á«ž ??" to NoSave
62440>>>>>>>>>        Function_Return NoSave
62441>>>>>>>>>    End_Function
62442>>>>>>>>>    
62442>>>>>>>>>    Function Check_Afm_Local String Afm_Num Returns Integer
62444>>>>>>>>>        Integer iii Num1 Num2
62445>>>>>>>>>    
62445>>>>>>>>>        Move (Trim(Afm_Num)) To Afm_Num
62446>>>>>>>>>    
62446>>>>>>>>>        For iii From 1 To (Length(Trim(Afm_Num)))
62452>>>>>>>>>>
62452>>>>>>>>>            If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
62455>>>>>>>>>        Loop
62456>>>>>>>>>>
62456>>>>>>>>>    
62456>>>>>>>>>        Move (Right(Afm_Num,1)) to Num2
62457>>>>>>>>>    
62457>>>>>>>>>        If (Length(Afm_Num)<>9) Function_Return 2
62460>>>>>>>>>    
62460>>>>>>>>>        Move 0 to Num1
62461>>>>>>>>>    
62461>>>>>>>>>        For iii From 1 to 8
62467>>>>>>>>>>
62467>>>>>>>>>            Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
62468>>>>>>>>>        Loop
62469>>>>>>>>>>
62469>>>>>>>>>    
62469>>>>>>>>>        Move (Mod(Num1,11)) to Num1
62470>>>>>>>>>        If (Num1=10) Move 0 to Num1
62473>>>>>>>>>    
62473>>>>>>>>>        If (Num1=Num2)  Function_Return 0
62476>>>>>>>>>        Else            Function_Return 1
62478>>>>>>>>>    End_Function
62479>>>>>>>>>    
62479>>>>>>>>>    Function Validate_AFM String asAFM String asPel Returns Integer
62481>>>>>>>>>        Integer rVal iCheck
62482>>>>>>>>>        // Elegxos gia sosto AFM
62482>>>>>>>>>        Move (Check_AFM(asAFM)) to iCheck
62483>>>>>>>>>        If (iCheck=1) Begin
62485>>>>>>>>>            Function_Return 1
62486>>>>>>>>>        End
62486>>>>>>>>>>
62486>>>>>>>>>        Else If (iCheck=2) Begin
62489>>>>>>>>>            Function_Return 2
62490>>>>>>>>>        End
62490>>>>>>>>>>
62490>>>>>>>>>        Else If (iCheck=3) Begin
62493>>>>>>>>>            Function_Return 3
62494>>>>>>>>>        End
62494>>>>>>>>>>
62494>>>>>>>>>        Function_Return 0
62495>>>>>>>>>    End_Function
62496>>>>>>>>>    
62496>>>>>>>>>    //AB-StoreTopEnd
62496>>>>>>>>>
62496>>>>>>>>>    Set Label to "”¦¨œåª"
62497>>>>>>>>>    Set Size to 289 505
62498>>>>>>>>>    Set Location to 2 5
62499>>>>>>>>>
62499>>>>>>>>>    //AB-DDOStart
62499>>>>>>>>>
62499>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
62501>>>>>>>>>
62501>>>>>>>>>        //AB-StoreStart
62501>>>>>>>>>                                                                                                                        
62501>>>>>>>>>                                                                                                                        
62501>>>>>>>>>                                                                                                                        
62501>>>>>>>>>        //AB-StoreEnd
62501>>>>>>>>>
62501>>>>>>>>>    End_Object    // Baxiokat_DD
62502>>>>>>>>>
62502>>>>>>>>>    Object Country_DD is a Country_DataDictionary
62504>>>>>>>>>
62504>>>>>>>>>        //AB-StoreStart
62504>>>>>>>>>                                                                                                                        
62504>>>>>>>>>                                                                                                                        
62504>>>>>>>>>                                                                                                                        
62504>>>>>>>>>        //AB-StoreEnd
62504>>>>>>>>>
62504>>>>>>>>>    End_Object    // Country_DD
62505>>>>>>>>>
62505>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
62507>>>>>>>>>        Set DDO_Server to (Country_DD(self))
62508>>>>>>>>>
62508>>>>>>>>>        //AB-StoreStart
62508>>>>>>>>>                                                                                                                        
62508>>>>>>>>>                                                                                                                        
62508>>>>>>>>>                                                                                                                        
62508>>>>>>>>>        //AB-StoreEnd
62508>>>>>>>>>
62508>>>>>>>>>    End_Object    // Towns_DD
62509>>>>>>>>>
62509>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
62511>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
62512>>>>>>>>>
62512>>>>>>>>>        //AB-StoreStart
62512>>>>>>>>>                                                                                                                        
62512>>>>>>>>>                                                                                                                        
62512>>>>>>>>>                                                                                                                        
62512>>>>>>>>>        //AB-StoreEnd
62512>>>>>>>>>
62512>>>>>>>>>    End_Object    // Cities_DD
62513>>>>>>>>>
62513>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
62515>>>>>>>>>
62515>>>>>>>>>        //AB-StoreStart
62515>>>>>>>>>                                                                                                                        
62515>>>>>>>>>                                                                                                                        
62515>>>>>>>>>        //AB-StoreEnd
62515>>>>>>>>>
62515>>>>>>>>>    End_Object    // Payresp_DD
62516>>>>>>>>>
62516>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
62518>>>>>>>>>
62518>>>>>>>>>        //AB-StoreStart
62518>>>>>>>>>                                                                                                                        
62518>>>>>>>>>                                                                                                                        
62518>>>>>>>>>        //AB-StoreEnd
62518>>>>>>>>>
62518>>>>>>>>>    End_Object    // Areas_DD
62519>>>>>>>>>
62519>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
62521>>>>>>>>>
62521>>>>>>>>>        //AB-StoreTopStart
62521>>>>>>>>>        
62521>>>>>>>>>        Property Integer piNomosID  Public 0
62523>>>>>>>>>        Property Integer piXoraID   Public 0
62525>>>>>>>>>        
62525>>>>>>>>>        //AB-StoreTopEnd
62525>>>>>>>>>
62525>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
62526>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
62527>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
62528>>>>>>>>>
62528>>>>>>>>>        //AB-StoreStart
62528>>>>>>>>>        
62528>>>>>>>>>        Procedure OnConstrain
62530>>>>>>>>>                 If (psModule(vwClients(Self))='01')  Constrain Clients.is_Client       Eq '1'
62534>>>>>>>>>            Else If (psModule(vwClients(Self))='02')  Constrain Clients.is_Promhtheyths Eq '1'
62539>>>>>>>>>        End_Procedure
62540>>>>>>>>>        
62540>>>>>>>>>        Procedure Creating
62542>>>>>>>>>            Integer iPrevCode
62543>>>>>>>>>            string spar
62543>>>>>>>>>            date dNullHmnia
62543>>>>>>>>>            Forward Send Creating
62545>>>>>>>>>        
62545>>>>>>>>>                 If (psModule(vwClients(Self))='01') Move '1' to Clients.is_Client
62548>>>>>>>>>            Else If (psModule(vwClients(Self))='02') Move '1' to Clients.is_Promhtheyths
62552>>>>>>>>>        
62552>>>>>>>>>            Move ''             to Clients.status
62553>>>>>>>>>            Move '01/01/1753'   to Clients.SAP_Hmnia //dNullHmnia
62554>>>>>>>>>        
62554>>>>>>>>>            Clear ptypparl
62555>>>>>>>>>            move syscurxr.company_code  to ptypparl.company_code
62556>>>>>>>>>            move syscurxr.branch_code   to ptypparl.branch_code
62557>>>>>>>>>            move Clients.Client_Ptyppar to ptypparl.ptyppar_code
62558>>>>>>>>>            find eq  ptypparl by index.1
62559>>>>>>>>>>
62559>>>>>>>>>            if (found) begin
62561>>>>>>>>>                if (ptypparl.is_xondr=1) Move '1' to clients.is_xondr
62564>>>>>>>>>                else begin
62565>>>>>>>>>                        Move ''     to clients.is_xondr
62566>>>>>>>>>                end
62566>>>>>>>>>>
62566>>>>>>>>>            end
62566>>>>>>>>>>
62566>>>>>>>>>            Else Error 1002 '€¤ç§˜¨¡«¦ ˜¨˜©«˜« ¡æ ‹œ«˜©®ž£˜« ©£¦ç'
62568>>>>>>>>>        End_Procedure
62569>>>>>>>>>        
62569>>>>>>>>>        Procedure request_save
62571>>>>>>>>>            STRING safm sstr sCode
62572>>>>>>>>>            Integer iRec iFound isok
62572>>>>>>>>>            Move 0 to iFound
62573>>>>>>>>>            GET FIELD_CURRENT_VALUE OF CLIENTS_DD FIELD CLIENTS.CLIENT_AFM TO SAFM
62574>>>>>>>>>            GET FIELD_CURRENT_VALUE OF CLIENTS_DD FIELD CLIENTS.CLIENT_ID TO sCode
62575>>>>>>>>>            Get Validate_Afm safm scode  to isOk
62576>>>>>>>>>                    If (isok=1) Send Info_Box  '¨¦©¦®ã. ŠáŸ¦ª €”‹ ' 'Š†Ž”Žˆ€'
62579>>>>>>>>>            else    If (isok=2) Send Info_Box  '¨¦©¦®ã. €”‹ <> 9 •˜¨˜¡«ã¨œª ' 'Š†Ž”Žˆ€'
62583>>>>>>>>>            else    If (isok=3) Send Info_Box  '¨¦©¦®ã. €”‹ œ¨ â®œ  £ž €§¦›œ¡«¦çª •˜¨˜¡«ã¨œª ' 'Š†Ž”Žˆ€'
62587>>>>>>>>>            Forward Send REQUEST_Save
62589>>>>>>>>>        
62589>>>>>>>>>            GET FIELD_CURRENT_VALUE OF CLIENTS_DD FIELD CLIENTS.CLIENT_AFM TO SAFM
62590>>>>>>>>>            GET FIELD_CURRENT_VALUE OF CLIENTS_DD FIELD CLIENTS.CLIENT_ID TO sCode
62591>>>>>>>>>            GET FIELD_CURRENT_VALUE OF CLIENTS_DD FIELD CLIENTS.Recnum TO iRec
62592>>>>>>>>>            move '¨âŸž¡œ «¦ €.”.‹ ‘«¦¤ ”¦¨â˜ = ' to sstr
62593>>>>>>>>>            If (iRec) Begin
62595>>>>>>>>>               clear clients
62596>>>>>>>>>               move safm to clients.client_afm
62597>>>>>>>>>               find gt clients by index.8
62598>>>>>>>>>>
62598>>>>>>>>>               While ((found) and (clients.client_afm=safm))
62602>>>>>>>>>                    If (Clients.Client_ID<>sCode) Begin
62604>>>>>>>>>                        append sstr clients.client_id
62605>>>>>>>>>                        Send Info_Box sstr 'Ž‘Ž•†'
62606>>>>>>>>>                        Send Find_By_Recnum to Clients_DD Clients.File_Number iRec
62607>>>>>>>>>                        Procedure_Return
62608>>>>>>>>>                    End
62608>>>>>>>>>>
62608>>>>>>>>>                    find gt clients by index.8
62609>>>>>>>>>>
62609>>>>>>>>>               Loop
62610>>>>>>>>>>
62610>>>>>>>>>            End
62610>>>>>>>>>>
62610>>>>>>>>>        End_Procedure
62611>>>>>>>>>        
62611>>>>>>>>>        Procedure Save_Main_File
62613>>>>>>>>>            Integer iReturnVal imodify  ijob icity incity injob
62614>>>>>>>>>            string msgstr  sanal snanal sendo sxondr sdhmos snpdd sname sodos spar
62614>>>>>>>>>            string snendo snxondr sndhmos snnpdd snname snodos sparast snparast
62614>>>>>>>>>            string sodosnr szip safm sdoy stel sntel sndoy snafm snzip snodosnr
62614>>>>>>>>>            date    dNullHmnia
62614>>>>>>>>>        
62614>>>>>>>>>            Move '01/01/1753' to dNullHmnia
62615>>>>>>>>>        
62615>>>>>>>>>            Move (piNomosID(Self))  to clients.client_Nomos
62616>>>>>>>>>            Move (piXoraID(Self))   to clients.client_Xora
62617>>>>>>>>>        
62617>>>>>>>>>        //    get psanal   to sanal
62617>>>>>>>>>        //    get psnanal  to snanal
62617>>>>>>>>>            get psendo   to sendo
62618>>>>>>>>>            get psxondr  to sxondr
62619>>>>>>>>>            get psdhmos  to sdhmos
62620>>>>>>>>>            get psnpdd   to snpdd
62621>>>>>>>>>            get psname   to sname
62622>>>>>>>>>            get pijob    to ijob
62623>>>>>>>>>            get picity   to icity
62624>>>>>>>>>            get psodos   to sodos
62625>>>>>>>>>            get psodosnr to sodosnr
62626>>>>>>>>>            get pszip    to szip
62627>>>>>>>>>            get psafm    to safm
62628>>>>>>>>>            get psdoy    to sdoy
62629>>>>>>>>>            get pstel    to stel
62630>>>>>>>>>            get psparast to sparast
62631>>>>>>>>>        
62631>>>>>>>>>            if (sendo<>clients.endoomil)         move 1 to imodify
62634>>>>>>>>>            if (sdhmos<>clients.custprom_code)   move 1 to imodify
62637>>>>>>>>>            if (snpdd<>clients.npdd)             move 1 to imodify
62640>>>>>>>>>            if (sname<>clients.client_name)      move 1 to imodify
62643>>>>>>>>>            if (ijob<>clients.client_job)        move 1 to imodify
62646>>>>>>>>>            if (icity<>clients.client_city_id)   move 1 to imodify
62649>>>>>>>>>            if (sodos<>clients.client_address)   move 1 to imodify
62652>>>>>>>>>            if (sodosnr<>clients.client_add_no)  move 1 to imodify
62655>>>>>>>>>            if (szip<>clients.client_zipcode)    move 1 to imodify
62658>>>>>>>>>            if (safm<>clients.client_afm)        move 1 to imodify
62661>>>>>>>>>            if (sdoy<>clients.client_doy)        move 1 to imodify
62664>>>>>>>>>            if (stel<>clients.client_phone)      move 1 to imodify
62667>>>>>>>>>            if (sxondr<>clients.is_xondr)        move 1 to imodify
62670>>>>>>>>>        //    if (sanal<>clients.anal)             move 1 to imodify
62670>>>>>>>>>            if (sparast<>clients.client_ptyppar) move 1 to imodify
62673>>>>>>>>>        
62673>>>>>>>>>            if ((imodify=1) And (clients.status<>'')) Begin
62675>>>>>>>>>                move dNullHmnia    to clients.sap_hmnia
62676>>>>>>>>>                move '1'           to clients.status
62677>>>>>>>>>            End
62677>>>>>>>>>>
62677>>>>>>>>>        
62677>>>>>>>>>            Forward Send Save_Main_File
62679>>>>>>>>>        
62679>>>>>>>>>        End_Procedure
62680>>>>>>>>>        
62680>>>>>>>>>        Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
62682>>>>>>>>>            Forward Send New_Current_Record  iOldRec iNewRec
62684>>>>>>>>>        //    set psanal      to clients.anal
62684>>>>>>>>>            set psendo      to clients.endoomil
62685>>>>>>>>>            set psxondr     to clients.is_xondr
62686>>>>>>>>>            set psdhmos     to clients.custprom_code
62687>>>>>>>>>            set psnpdd      to clients.npdd
62688>>>>>>>>>            set psname      to clients.client_name
62689>>>>>>>>>            set pijob       to clients.client_job
62690>>>>>>>>>            set picity      to clients.client_city_id
62691>>>>>>>>>            set psodos      to clients.client_address
62692>>>>>>>>>            set psodosnr    to clients.client_add_no
62693>>>>>>>>>            set pszip       to clients.client_zipcode
62694>>>>>>>>>            set psafm       to clients.client_afm
62695>>>>>>>>>            set psdoy       to clients.client_doy
62696>>>>>>>>>            set pstel       to clients.client_phone
62697>>>>>>>>>            set psparast    to clients.client_ptyppar
62698>>>>>>>>>        End_Procedure
62699>>>>>>>>>        
62699>>>>>>>>>        
62699>>>>>>>>>        Function Validate_Save  Returns Integer
62701>>>>>>>>>            Integer iReturnVal imodify  ijob icity incity injob
62702>>>>>>>>>            string msgstr  sanal snanal sendo sxondr sdhmos snpdd sname sodos spar
62702>>>>>>>>>            string snendo snxondr sndhmos snnpdd snname snodos sparast snparast
62702>>>>>>>>>            string sodosnr szip safm sdoy stel sntel sndoy snafm snzip snodosnr
62702>>>>>>>>>            date    dNullHmnia
62702>>>>>>>>>        
62702>>>>>>>>>            Forward Get Validate_Save  To iReturnVal
62704>>>>>>>>>        
62704>>>>>>>>>            If (Not(iReturnVal)) Begin
62706>>>>>>>>>        
62706>>>>>>>>>                Get psparast    to sparast
62707>>>>>>>>>        //        Get psanal      to sanal
62707>>>>>>>>>                Get psxondr     to sxondr
62708>>>>>>>>>        
62708>>>>>>>>>                // 10/12/2004 Prosthikh elegxou gia to sparast diaforo tou keno  giati xtypaei stis neees eggrafes
62708>>>>>>>>>                if ((sparast<>clients.client_ptyppar) And (sparast<>'')) begin
62710>>>>>>>>>                    move "" to msgstr
62711>>>>>>>>>                    move "ƒœ¤ ‹§¦¨œå«œ ¤˜ €¢¢á¥œ«œ ˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž!" to msgstr
62712>>>>>>>>>                        error 6199 msgstr
62713>>>>>>>>>>
62713>>>>>>>>>                end
62713>>>>>>>>>>
62713>>>>>>>>>        
62713>>>>>>>>>                if ((sxondr<>clients.is_xondr) And (sxondr<>'')) begin
62715>>>>>>>>>                    move "" to msgstr
62716>>>>>>>>>                    move "ƒœ¤ ‹§¦¨œå«œ ¤˜ «¦¤ €¢¢á¥œ«œ ©œ •¦¤›¨ ¡ãª/Š ˜¤ ¡ãª !" to msgstr
62717>>>>>>>>>                    error 6170 msgstr
62718>>>>>>>>>>
62718>>>>>>>>>                end
62718>>>>>>>>>>
62718>>>>>>>>>        //        if ((sanal<>clients.anal) And (sanal<>'')) begin
62718>>>>>>>>>        //            move "" to msgstr
62718>>>>>>>>>        //            move "ƒœ¤ ‹§¦¨œå«œ ¤˜ «¦¤ €¢¢á¥œ«œ «¨æ§¦ §˜¨˜¡¦¢¦çŸž©žª ©«¦ SAP" to msgstr
62718>>>>>>>>>        //            error 6176 msgstr
62718>>>>>>>>>        //        end
62718>>>>>>>>>            End
62718>>>>>>>>>>
62718>>>>>>>>>            Function_Return iReturnVal
62719>>>>>>>>>        End_Function   // Validate_Save
62720>>>>>>>>>        
62720>>>>>>>>>        
62720>>>>>>>>>        
62720>>>>>>>>>        
62720>>>>>>>>>        
62720>>>>>>>>>        
62720>>>>>>>>>        //AB-StoreEnd
62720>>>>>>>>>
62720>>>>>>>>>    End_Object    // Clients_DD
62721>>>>>>>>>
62721>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
62723>>>>>>>>>    End_Object    // Salesmen_DD
62724>>>>>>>>>
62724>>>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
62726>>>>>>>>>    End_Object    // Mhxanik_DD
62727>>>>>>>>>
62727>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
62729>>>>>>>>>    End_Object    // Constrct_DD
62730>>>>>>>>>
62730>>>>>>>>>    Object Cn_DD is a Cn_DataDictionary
62732>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
62733>>>>>>>>>        Set DDO_Server to (Salesmen_DD(self))
62734>>>>>>>>>        Set DDO_Server to (Mhxanik_DD(self))
62735>>>>>>>>>        Set DDO_Server to (Constrct_DD(self))
62736>>>>>>>>>        Set Constrain_File to Clients.File_Number
62737>>>>>>>>>    End_Object    // Cn_DD
62738>>>>>>>>>
62738>>>>>>>>>    Object Clnbank_DD is a Clnbank_DataDictionary
62740>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
62741>>>>>>>>>        Set Constrain_File to Clients.File_Number
62742>>>>>>>>>    End_Object    // Clnbank_DD
62743>>>>>>>>>
62743>>>>>>>>>    Object Tpclient_DD is a Tpclient_DataDictionary
62745>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
62746>>>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
62747>>>>>>>>>        Set Constrain_File to Clients.File_Number
62748>>>>>>>>>    End_Object    // Tpclient_DD
62749>>>>>>>>>
62749>>>>>>>>>    Object Clitem_DD is a Clitem_DataDictionary
62751>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
62752>>>>>>>>>        Set Constrain_File to Clients.File_Number
62753>>>>>>>>>    End_Object    // Clitem_DD
62754>>>>>>>>>
62754>>>>>>>>>    Set Main_DD to (Clients_DD(self))
62755>>>>>>>>>    Set Server to (Clients_DD(self))
62756>>>>>>>>>
62756>>>>>>>>>    //AB-DDOEnd
62756>>>>>>>>>
62756>>>>>>>>>    Object Clients_Client_id is a dbForm
62758>>>>>>>>>        Entry_Item Clients.Client_id
62759>>>>>>>>>        Set Size to 13 92
62760>>>>>>>>>        Set Location to 7 64
62761>>>>>>>>>        Set Label_Col_Offset to 2
62762>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62763>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
62764>>>>>>>>>
62764>>>>>>>>>        //AB-StoreStart
62764>>>>>>>>>        Procedure Key Integer iKey
62766>>>>>>>>>        End_Procedure
62767>>>>>>>>>        Procedure Prompt
62769>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(vwClients(Self)))
62770>>>>>>>>>            Forward Send Prompt
62772>>>>>>>>>        End_Procedure
62773>>>>>>>>>        
62773>>>>>>>>>        procedure onchange
62775>>>>>>>>>            string sid
62776>>>>>>>>>            get field_current_value of clients_dd field clients.client_id     to sid
62777>>>>>>>>>        
62777>>>>>>>>>            set enabled_state of (buttonsub2(self)) to ((sid='') and (psmodule(self)='01'))
62778>>>>>>>>>            set enabled_state of (btn_erga(self))   to ((sid<>'') and (psmodule(self)='01'))
62779>>>>>>>>>        end_procedure
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        
62780>>>>>>>>>        //AB-StoreEnd
62780>>>>>>>>>
62780>>>>>>>>>    End_Object    // Clients_Client_id
62781>>>>>>>>>
62781>>>>>>>>>    Object Clients_Client_name is a dbForm
62783>>>>>>>>>        Entry_Item Clients.Client_name
62784>>>>>>>>>        Set Size to 13 286
62785>>>>>>>>>        Set Location to 7 206
62786>>>>>>>>>        Set Label_Col_Offset to 2
62787>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62788>>>>>>>>>
62788>>>>>>>>>        //AB-StoreStart
62788>>>>>>>>>                                                                                                                        
62788>>>>>>>>>        Procedure Prompt_CallBack Integer hPromptID
62790>>>>>>>>>            Set psModule Of hPromptID to (psModule(vwClients(Self)))
62791>>>>>>>>>        End_procedure
62792>>>>>>>>>        
62792>>>>>>>>>        //AB-StoreEnd
62792>>>>>>>>>
62792>>>>>>>>>    End_Object    // Clients_Client_name
62793>>>>>>>>>
62793>>>>>>>>>    Object Clients_Client_Adress is a dbFormSub
62795>>>>>>>>>        Entry_Item Clients.Client_address
62796>>>>>>>>>        Set Size to 13 318
62797>>>>>>>>>        Set Location to 21 64
62798>>>>>>>>>        Set Label_Col_Offset to 2
62799>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62800>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62801>>>>>>>>>    End_Object    // Clients_Client_Adress
62802>>>>>>>>>
62802>>>>>>>>>    Object Clients_Client_Add_No is a dbFormSub
62804>>>>>>>>>        Entry_Item Clients.Client_add_no
62805>>>>>>>>>        Set Size to 13 49
62806>>>>>>>>>        Set Location to 21 443
62807>>>>>>>>>        Set Label_Col_Offset to 2
62808>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62809>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62810>>>>>>>>>    End_Object    // Clients_Client_Add_No
62811>>>>>>>>>
62811>>>>>>>>>    Object Clients_Client_Zipcode is a dbFormSub
62813>>>>>>>>>        Entry_Item Clients.Client_zipcode
62814>>>>>>>>>        Set Size to 13 60
62815>>>>>>>>>        Set Location to 35 64
62816>>>>>>>>>        Set Label_Col_Offset to 2
62817>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62818>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62819>>>>>>>>>    End_Object    // Clients_Client_Zipcode
62820>>>>>>>>>
62820>>>>>>>>>    Object Areas_Area_Id is a dbFormSub
62822>>>>>>>>>        Entry_Item Areas.Area_id
62823>>>>>>>>>        Set Size to 13 47
62824>>>>>>>>>        Set Location to 36 279
62825>>>>>>>>>        Set Label_Col_Offset to 2
62826>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62827>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62828>>>>>>>>>
62828>>>>>>>>>        //AB-StoreStart
62828>>>>>>>>>                                                                                                                        
62828>>>>>>>>>                                                                                                                        
62828>>>>>>>>>        //AB-StoreEnd
62828>>>>>>>>>
62828>>>>>>>>>    End_Object    // Areas_Area_Id
62829>>>>>>>>>
62829>>>>>>>>>    Object Areas_Area_Descr is a dbFormSub
62831>>>>>>>>>        Entry_Item Areas.Area_descr
62832>>>>>>>>>        Set Size to 13 147
62833>>>>>>>>>        Set Location to 36 334
62834>>>>>>>>>        Set Color to clBtnFace
62835>>>>>>>>>        Set Label_Col_Offset to 2
62836>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62837>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOff
62838>>>>>>>>>        Set Enabled_State to FALSE
62839>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62840>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
62841>>>>>>>>>        Set Shadow_State Item 0 to TRUE
62842>>>>>>>>>    End_Object    // Areas_Area_Descr
62843>>>>>>>>>
62843>>>>>>>>>    Object Clients_Client_City is a dbFormSub
62845>>>>>>>>>        Entry_Item Cities.City_id
62846>>>>>>>>>        Set Size to 13 61
62847>>>>>>>>>        Set Location to 49 64
62848>>>>>>>>>        Set Label_Col_Offset to 2
62849>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62850>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62851>>>>>>>>>
62851>>>>>>>>>        //AB-StoreStart
62851>>>>>>>>>        Procedure OnChange
62853>>>>>>>>>            Integer iVal
62854>>>>>>>>>            Get Field_Current_Value Of cities_DD Field cities.City_id to iVal
62855>>>>>>>>>            Move (fiTownIDFromCity(iVal)) to ival
62856>>>>>>>>>            Set piNomosID Of clients_dd to iVal
62857>>>>>>>>>            Move (fiCountryIDFromTown(iVal)) to ival
62858>>>>>>>>>            Set piXoraID Of clients_dd to iVal
62859>>>>>>>>>        End_Procedure
62860>>>>>>>>>        //AB-StoreEnd
62860>>>>>>>>>
62860>>>>>>>>>    End_Object    // Clients_Client_City
62861>>>>>>>>>
62861>>>>>>>>>    Object Towns_Town_Descr is a dbFormSub
62863>>>>>>>>>        Entry_Item Towns.Town_id
62864>>>>>>>>>        Set Size to 13 47
62865>>>>>>>>>        Set Location to 50 279
62866>>>>>>>>>        Set Color to clBtnFace
62867>>>>>>>>>        Set Label_Col_Offset to 2
62868>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62869>>>>>>>>>        Set Enabled_State to FALSE
62870>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62871>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
62872>>>>>>>>>        Set Shadow_State Item 0 to TRUE
62873>>>>>>>>>    End_Object    // Towns_Town_Descr
62874>>>>>>>>>
62874>>>>>>>>>    Object Country_Country_Descr is a dbFormSub
62876>>>>>>>>>        Entry_Item Country.Country_id
62877>>>>>>>>>        Set Size to 13 61
62878>>>>>>>>>        Set Location to 63 64
62879>>>>>>>>>        Set Color to clBtnFace
62880>>>>>>>>>        Set Label_Col_Offset to 2
62881>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62882>>>>>>>>>        Set Enabled_State to FALSE
62883>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62884>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
62885>>>>>>>>>        Set Shadow_State Item 0 to TRUE
62886>>>>>>>>>    End_Object    // Country_Country_Descr
62887>>>>>>>>>
62887>>>>>>>>>    Object Payresp_Presp_Id is a dbFormSub
62889>>>>>>>>>        Entry_Item Payresp.Presp_id
62890>>>>>>>>>        Set Size to 13 61
62891>>>>>>>>>        Set Location to 77 64
62892>>>>>>>>>        Set Label_Col_Offset to 2
62893>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62894>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62895>>>>>>>>>
62895>>>>>>>>>        //AB-StoreStart
62895>>>>>>>>>        set Item_Option item 0 to FindReq true
62896>>>>>>>>>        //AB-StoreEnd
62896>>>>>>>>>
62896>>>>>>>>>    End_Object    // Payresp_Presp_Id
62897>>>>>>>>>
62897>>>>>>>>>    Object Payresp_Presp_Name is a dbFormSub
62899>>>>>>>>>        Entry_Item Payresp.Presp_name
62900>>>>>>>>>        Set Size to 13 199
62901>>>>>>>>>        Set Location to 77 128
62902>>>>>>>>>        Set Color to clBtnFace
62903>>>>>>>>>        Set Label_Col_Offset to 2
62904>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
62905>>>>>>>>>        Set Enabled_State to FALSE
62906>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
62907>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
62908>>>>>>>>>        Set Shadow_State Item 0 to TRUE
62909>>>>>>>>>    End_Object    // Payresp_Presp_Name
62910>>>>>>>>>
62910>>>>>>>>>    Object TextBoxSub26 is a TextBoxSub
62912>>>>>>>>>        Set Label to "‰à› ¡æª"
62913>>>>>>>>>        Set Location to 8 5
62914>>>>>>>>>        Set Size to 10 35
62915>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62916>>>>>>>>>    End_Object    // TextBoxSub26
62917>>>>>>>>>
62917>>>>>>>>>    Object TextBoxSub27 is a TextBoxSub
62919>>>>>>>>>        Set Label to "Ž›æª"
62920>>>>>>>>>        Set Location to 22 5
62921>>>>>>>>>        Set Size to 10 19
62922>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62923>>>>>>>>>    End_Object    // TextBoxSub27
62924>>>>>>>>>
62924>>>>>>>>>    Object TextBoxSub28 is a TextBoxSub
62926>>>>>>>>>        Set Label to "æ¢ž"
62927>>>>>>>>>        Set Location to 52 5
62928>>>>>>>>>        Set Size to 10 31
62929>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62930>>>>>>>>>    End_Object    // TextBoxSub28
62931>>>>>>>>>
62931>>>>>>>>>    Object TextBoxSub29 is a TextBoxSub
62933>>>>>>>>>        Set Label to "’.‰."
62934>>>>>>>>>        Set Location to 37 5
62935>>>>>>>>>        Set Size to 10 16
62936>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62937>>>>>>>>>    End_Object    // TextBoxSub29
62938>>>>>>>>>
62938>>>>>>>>>    Object TextBoxSub30 is a TextBoxSub
62940>>>>>>>>>        Set Label to "„§à¤¬£å˜"
62941>>>>>>>>>        Set Location to 7 165
62942>>>>>>>>>        Set Size to 12 34
62943>>>>>>>>>        Set TypeFace to "MS Sans Serif"
62944>>>>>>>>>    End_Object    // TextBoxSub30
62945>>>>>>>>>
62945>>>>>>>>>    Object dbTabDialogSub2 is a dbTabDialogSub
62947>>>>>>>>>
62947>>>>>>>>>        //AB-StoreTopStart
62947>>>>>>>>>                                                                                                                        
62947>>>>>>>>>        //AB-StoreTopEnd
62947>>>>>>>>>
62947>>>>>>>>>        Set Size to 169 492
62948>>>>>>>>>        Set Location to 102 -1
62949>>>>>>>>>        Object dbTabPageSub3 is a dbTabPageSub
62951>>>>>>>>>            Set Label to "dbTabPageSub1"
62952>>>>>>>>>            Object Clients_Client_afm is a dbForm
62954>>>>>>>>>                Entry_Item Clients.Client_afm
62955>>>>>>>>>                Set Size to 13 71
62956>>>>>>>>>                Set Location to 5 65
62957>>>>>>>>>                Set Label_Col_Offset to 2
62958>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
62959>>>>>>>>>            End_Object    // Clients_Client_afm
62960>>>>>>>>>
62960>>>>>>>>>            Object TextBoxSub31 is a TextBoxSub
62962>>>>>>>>>                Set Label to "€.”.‹"
62963>>>>>>>>>                Set Location to 5 9
62964>>>>>>>>>                Set Size to 10 38
62965>>>>>>>>>                Set TypeFace to "MS Sans Serif"
62966>>>>>>>>>            End_Object    // TextBoxSub31
62967>>>>>>>>>
62967>>>>>>>>>            Object TextBoxSub32 is a TextBoxSub
62969>>>>>>>>>                Set Label to "ƒ.Ž.“."
62970>>>>>>>>>                Set Location to 7 153
62971>>>>>>>>>                Set Size to 10 36
62972>>>>>>>>>                Set TypeFace to "MS Sans Serif"
62973>>>>>>>>>            End_Object    // TextBoxSub32
62974>>>>>>>>>
62974>>>>>>>>>            Object Clients_Client_Doy is a dbComboFormSub
62976>>>>>>>>>                Entry_Item Clients.Client_doy
62977>>>>>>>>>                Set Size to 13 174
62978>>>>>>>>>                Set Location to 5 199
62979>>>>>>>>>                Set Label_Col_Offset to 2
62980>>>>>>>>>            End_Object    // Clients_Client_Doy
62981>>>>>>>>>
62981>>>>>>>>>            Object Clients_Client_Job is a dbComboForm
62983>>>>>>>>>                Entry_Item Clients.Client_job
62984>>>>>>>>>                Set Size to 13 309
62985>>>>>>>>>                Set Location to 20 65
62986>>>>>>>>>                Set Label_Col_Offset to 2
62987>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
62988>>>>>>>>>                Set Entry_State to FALSE
62989>>>>>>>>>            End_Object    // Clients_Client_Job
62990>>>>>>>>>
62990>>>>>>>>>            Object Clients_Client_Idiot is a dbComboForm
62992>>>>>>>>>                Entry_Item Clients.Client_idiot
62993>>>>>>>>>                Set Size to 13 185
62994>>>>>>>>>                Set Location to 36 65
62995>>>>>>>>>                Set Label_Col_Offset to 2
62996>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
62997>>>>>>>>>                Set Entry_State to FALSE
62998>>>>>>>>>            End_Object    // Clients_Client_Idiot
62999>>>>>>>>>
62999>>>>>>>>>            Object Clients_Client_Class is a dbFormSub
63001>>>>>>>>>                Entry_Item Clients.Client_class
63002>>>>>>>>>                Set Size to 13 60
63003>>>>>>>>>                Set Location to 36 310
63004>>>>>>>>>                Set Label_Col_Offset to 2
63005>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63006>>>>>>>>>                Set Prompt_Button_Mode to pb_PromptOn
63007>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63008>>>>>>>>>
63008>>>>>>>>>                //AB-StoreStart
63008>>>>>>>>>                set prompt_object to (sl002(self))
63009>>>>>>>>>                procedure onchange
63011>>>>>>>>>                    string scompany sdescr sbranch
63012>>>>>>>>>                    get value item 0 to sbranch
63013>>>>>>>>>                    move syscurxr.company_code to scompany
63014>>>>>>>>>                    clear branch
63015>>>>>>>>>                    move scompany to branch.company_code
63016>>>>>>>>>                    move sbranch  to branch.branch_code
63017>>>>>>>>>                    find eq branch by index.1
63018>>>>>>>>>>
63018>>>>>>>>>                    move branch.branch_name to sdescr
63019>>>>>>>>>                    set value of formsub3 to sdescr
63020>>>>>>>>>                end_procedure
63021>>>>>>>>>                
63021>>>>>>>>>                Procedure Prompt
63023>>>>>>>>>                    String sVal
63024>>>>>>>>>                    Set Modal_State Of (sl002(Current_object)) to True
63025>>>>>>>>>                    Set psFragmaCompanyCode Of (sl002(Current_object)) to syscurxr.company_code
63026>>>>>>>>>                    Forward Send Prompt
63028>>>>>>>>>                    Set psFragmaCompanyCode Of (sl002(Current_object)) to ''
63029>>>>>>>>>                End_procedure
63030>>>>>>>>>                
63030>>>>>>>>>                procedure key
63032>>>>>>>>>                end_procedure
63033>>>>>>>>>                
63033>>>>>>>>>                
63033>>>>>>>>>                
63033>>>>>>>>>                
63033>>>>>>>>>                //AB-StoreEnd
63033>>>>>>>>>
63033>>>>>>>>>            End_Object    // Clients_Client_Class
63034>>>>>>>>>
63034>>>>>>>>>            Object Clients_Client_Phone is a dbFormSub
63036>>>>>>>>>                Entry_Item Clients.Client_phone
63037>>>>>>>>>                Set Size to 13 185
63038>>>>>>>>>                Set Location to 52 65
63039>>>>>>>>>                Set Label_Col_Offset to 2
63040>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63041>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63042>>>>>>>>>            End_Object    // Clients_Client_Phone
63043>>>>>>>>>
63043>>>>>>>>>            Object Clients_Client_Fax is a dbFormSub
63045>>>>>>>>>                Entry_Item Clients.Client_fax
63046>>>>>>>>>                Set Size to 13 159
63047>>>>>>>>>                Set Location to 50 311
63048>>>>>>>>>                Set Label_Col_Offset to 2
63049>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63050>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63051>>>>>>>>>            End_Object    // Clients_Client_Fax
63052>>>>>>>>>
63052>>>>>>>>>            Object Clients_Client_Mobile is a dbFormSub
63054>>>>>>>>>                Entry_Item Clients.Client_mobile
63055>>>>>>>>>                Set Size to 13 185
63056>>>>>>>>>                Set Location to 67 65
63057>>>>>>>>>                Set Label_Col_Offset to 2
63058>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63059>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63060>>>>>>>>>            End_Object    // Clients_Client_Mobile
63061>>>>>>>>>
63061>>>>>>>>>            Object Clients_Client_Aoh is a dbFormSub
63063>>>>>>>>>                Entry_Item Clients.Client_aoh
63064>>>>>>>>>                Set Size to 13 159
63065>>>>>>>>>                Set Location to 66 311
63066>>>>>>>>>                Set Label_Col_Offset to 2
63067>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63068>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63069>>>>>>>>>            End_Object    // Clients_Client_Aoh
63070>>>>>>>>>
63070>>>>>>>>>            Object Clients_Client_Email is a dbFormSub
63072>>>>>>>>>                Entry_Item Clients.Client_email
63073>>>>>>>>>                Set Size to 13 185
63074>>>>>>>>>                Set Location to 82 65
63075>>>>>>>>>                Set Label_Col_Offset to 2
63076>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63077>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63078>>>>>>>>>            End_Object    // Clients_Client_Email
63079>>>>>>>>>
63079>>>>>>>>>            Object TextBoxSub33 is a TextBoxSub
63081>>>>>>>>>                Set Label to "e-Mail"
63082>>>>>>>>>                Set Location to 83 9
63083>>>>>>>>>                Set Size to 10 20
63084>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63085>>>>>>>>>            End_Object    // TextBoxSub33
63086>>>>>>>>>
63086>>>>>>>>>            Object TextBoxSub34 is a TextBoxSub
63088>>>>>>>>>                Set Label to "’ž¢â­à¤˜"
63089>>>>>>>>>                Set Location to 52 9
63090>>>>>>>>>                Set Size to 10 39
63091>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63092>>>>>>>>>            End_Object    // TextBoxSub34
63093>>>>>>>>>
63093>>>>>>>>>            Object TextBoxSub35 is a TextBoxSub
63095>>>>>>>>>                Set Label to "Fax"
63096>>>>>>>>>                Set Location to 53 255
63097>>>>>>>>>                Set Size to 10 13
63098>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63099>>>>>>>>>            End_Object    // TextBoxSub35
63100>>>>>>>>>
63100>>>>>>>>>            Object TextBoxSub36 is a TextBoxSub
63102>>>>>>>>>                Set Label to "‰ ¤ž«æ"
63103>>>>>>>>>                Set Location to 70 8
63104>>>>>>>>>                Set Size to 10 31
63105>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63106>>>>>>>>>            End_Object    // TextBoxSub36
63107>>>>>>>>>
63107>>>>>>>>>            Object TextBoxSub37 is a TextBoxSub
63109>>>>>>>>>                Set Label to "€.Ž.†."
63110>>>>>>>>>                Set Location to 69 257
63111>>>>>>>>>                Set Size to 9 26
63112>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63113>>>>>>>>>            End_Object    // TextBoxSub37
63114>>>>>>>>>
63114>>>>>>>>>            Object Clients_Client_Respons is a dbFormSub
63116>>>>>>>>>                Entry_Item Clients.Client_respons
63117>>>>>>>>>                Set Size to 13 159
63118>>>>>>>>>                Set Location to 82 311
63119>>>>>>>>>                Set Label_Col_Offset to 2
63120>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63121>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63122>>>>>>>>>            End_Object    // Clients_Client_Respons
63123>>>>>>>>>
63123>>>>>>>>>            Object TextBoxSub38 is a TextBoxSub
63125>>>>>>>>>                Set Label to "“§œçŸ¬¤¦ª"
63126>>>>>>>>>                Set Location to 83 255
63127>>>>>>>>>                Set Size to 12 43
63128>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63129>>>>>>>>>            End_Object    // TextBoxSub38
63130>>>>>>>>>
63130>>>>>>>>>            Object TextBoxSub48 is a TextBoxSub
63132>>>>>>>>>                Set Label to "†£/¤å˜ €¨®ãª"
63133>>>>>>>>>                Set Location to 98 9
63134>>>>>>>>>                Set Size to 10 49
63135>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63136>>>>>>>>>            End_Object    // TextBoxSub48
63137>>>>>>>>>
63137>>>>>>>>>            Object Clients_Client_Hmnia is a dbFormSub
63139>>>>>>>>>                Entry_Item Clients.Client_hmnia
63140>>>>>>>>>                Set Size to 13 60
63141>>>>>>>>>                Set Location to 97 65
63142>>>>>>>>>                Set Label_Col_Offset to 2
63143>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63144>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63145>>>>>>>>>
63145>>>>>>>>>                //AB-StoreStart
63145>>>>>>>>>                set enabled_state to false
63146>>>>>>>>>                //AB-StoreEnd
63146>>>>>>>>>
63146>>>>>>>>>            End_Object    // Clients_Client_Hmnia
63147>>>>>>>>>
63147>>>>>>>>>            Object TextBoxSub54 is a TextBoxSub
63149>>>>>>>>>                Set Label to "ˆ› æ«ž«˜"
63150>>>>>>>>>                Set Location to 36 9
63151>>>>>>>>>                Set Size to 10 33
63152>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63153>>>>>>>>>            End_Object    // TextBoxSub54
63154>>>>>>>>>
63154>>>>>>>>>            Object TextBoxSub55 is a TextBoxSub
63156>>>>>>>>>                Set Label to "„§áššœ¢£˜"
63157>>>>>>>>>                Set Location to 20 9
63158>>>>>>>>>                Set Size to 10 41
63159>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63160>>>>>>>>>            End_Object    // TextBoxSub55
63161>>>>>>>>>
63161>>>>>>>>>            Object Clients_Client_Glcode is a dbFormSub
63163>>>>>>>>>                Entry_Item Clients.Client_glcode
63164>>>>>>>>>                Set Size to 13 74
63165>>>>>>>>>                Set Location to 96 311
63166>>>>>>>>>                Set Label_Col_Offset to 2
63167>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63168>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63169>>>>>>>>>            End_Object    // Clients_Client_Glcode
63170>>>>>>>>>
63170>>>>>>>>>            Object Clients_Sysxetish is a dbFormSub
63172>>>>>>>>>                Entry_Item Clients.Sysxetish
63173>>>>>>>>>                Set Label to "‰à› ¡æª ‘¬©®â« ©žª"
63174>>>>>>>>>                Set Size to 13 74
63175>>>>>>>>>                Set Location to 110 311
63176>>>>>>>>>                Set Label_Col_Offset to 2
63177>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63178>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63179>>>>>>>>>            End_Object    // Clients_Sysxetish
63180>>>>>>>>>
63180>>>>>>>>>            Object Textbox4 is a Textbox
63182>>>>>>>>>                Set Label to "‰à› ¡æª ‚.Š"
63183>>>>>>>>>                Set Location to 98 256
63184>>>>>>>>>                Set Size to 10 41
63185>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63186>>>>>>>>>            End_Object    // Textbox4
63187>>>>>>>>>
63187>>>>>>>>>            Object Clients_Client_Details is a dbEditSub
63189>>>>>>>>>                Entry_Item Clients.Client_details
63190>>>>>>>>>                Set Size to 28 322
63191>>>>>>>>>                Set Location to 124 64
63192>>>>>>>>>            End_Object    // Clients_Client_Details
63193>>>>>>>>>
63193>>>>>>>>>            Object TextBoxSub63 is a TextBoxSub
63195>>>>>>>>>                Set Label to "‘®æ¢ ˜"
63196>>>>>>>>>                Set Color to clAqua
63197>>>>>>>>>                Set Location to 123 27
63198>>>>>>>>>                Set Size to 10 27
63199>>>>>>>>>                Set FontWeight to 600
63200>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63201>>>>>>>>>            End_Object    // TextBoxSub63
63202>>>>>>>>>
63202>>>>>>>>>            Object btnPartl is a ButtonSub
63204>>>>>>>>>                Set Label to "ButtonSub1"
63205>>>>>>>>>                Set Bitmap to "Filesys3.bmp"
63206>>>>>>>>>                Set Size to 22 25
63207>>>>>>>>>                Set Location to 4 459
63208>>>>>>>>>                Set Focus_Mode to Pointer_Only
63209>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63210>>>>>>>>>
63210>>>>>>>>>                //AB-StoreStart
63210>>>>>>>>>                Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ œ¢˜«é¤ - „¨šà¤"
63211>>>>>>>>>                Procedure OnClick
63213>>>>>>>>>                    String  sCLIENTcode
63214>>>>>>>>>                    Get Field_Current_Value Of clients_DD Field Clients.client_id to sclientcode
63215>>>>>>>>>                    if (sclientcode<>'') begin
63217>>>>>>>>>                       Set psClientID Of (Cn(Self)) to sclientcode
63218>>>>>>>>>                       send activate_cn
63219>>>>>>>>>                    end
63219>>>>>>>>>>
63219>>>>>>>>>                End_Procedure // OnClick
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                
63220>>>>>>>>>                //AB-StoreEnd
63220>>>>>>>>>
63220>>>>>>>>>            End_Object    // btnPartl
63221>>>>>>>>>
63221>>>>>>>>>            Object TextBoxSub69 is a TextBoxSub
63223>>>>>>>>>                Set Label to "“§¦¡˜«á©«ž£˜"
63224>>>>>>>>>                Set Location to 36 254
63225>>>>>>>>>                Set Size to 12 55
63226>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63227>>>>>>>>>            End_Object    // TextBoxSub69
63228>>>>>>>>>
63228>>>>>>>>>            Object FormSub3 is a FormSub
63230>>>>>>>>>                Set Size to 13 97
63231>>>>>>>>>                Set Location to 35 372
63232>>>>>>>>>                Set Color to clBtnFace
63233>>>>>>>>>                Set Label_Col_Offset to 2
63234>>>>>>>>>                Set Enabled_State to FALSE
63235>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63236>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63237>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63238>>>>>>>>>            End_Object    // FormSub3
63239>>>>>>>>>
63239>>>>>>>>>            Object Clients_Client_Reported is a dbCheckBoxSub
63241>>>>>>>>>                Entry_Item Clients.Client_reported
63242>>>>>>>>>                Set Label to "Œâ¦ª"
63243>>>>>>>>>                Set Size to 10 31
63244>>>>>>>>>                Set Location to 138 454
63245>>>>>>>>>            End_Object    // Clients_Client_Reported
63246>>>>>>>>>
63246>>>>>>>>>
63246>>>>>>>>>            //AB-StoreStart
63246>>>>>>>>>                                                                                                                                                                        
63246>>>>>>>>>            set label to "‚œ¤ ¡á ‘«¦ ®œå˜"
63247>>>>>>>>>            
63247>>>>>>>>>            //AB-StoreEnd
63247>>>>>>>>>
63247>>>>>>>>>        End_Object    // dbTabPageSub3
63248>>>>>>>>>
63248>>>>>>>>>        Object dbTabPageSub4 is a dbTabPageSub
63250>>>>>>>>>            Set Label to "dbTabPageSub2"
63251>>>>>>>>>            Object dbCheckBoxSub1 is a dbCheckBoxSub
63253>>>>>>>>>                Entry_Item Clients.Client_locked
63254>>>>>>>>>                Set Size to 13 16
63255>>>>>>>>>                Set Location to 2 72
63256>>>>>>>>>            End_Object    // dbCheckBoxSub1
63257>>>>>>>>>
63257>>>>>>>>>            Object Clients_Xreosh is a dbFormSubs
63259>>>>>>>>>                Entry_Item Clients.Xreosh
63260>>>>>>>>>                Set Size to 13 138
63261>>>>>>>>>                Set Location to 28 72
63262>>>>>>>>>                Set Color to clBtnFace
63263>>>>>>>>>                Set Label_Col_Offset to 2
63264>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63265>>>>>>>>>                Set Enabled_State to FALSE
63266>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63267>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63268>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63269>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63270>>>>>>>>>
63270>>>>>>>>>                //AB-StoreStart
63270>>>>>>>>>                Procedure End_Construct_Object
63272>>>>>>>>>                    Integer idecimals
63273>>>>>>>>>                    Forward Send End_Construct_Object
63275>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63276>>>>>>>>>                    Set Points Item 0 to idecimals
63277>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63278>>>>>>>>>                End_Procedure
63279>>>>>>>>>                
63279>>>>>>>>>                
63279>>>>>>>>>                //AB-StoreEnd
63279>>>>>>>>>
63279>>>>>>>>>            End_Object    // Clients_Xreosh
63280>>>>>>>>>
63280>>>>>>>>>            Object Clients_Pistosh is a dbFormSubs
63282>>>>>>>>>                Entry_Item Clients.Pistosh
63283>>>>>>>>>                Set Size to 13 138
63284>>>>>>>>>                Set Location to 42 72
63285>>>>>>>>>                Set Color to clBtnFace
63286>>>>>>>>>                Set Label_Col_Offset to 2
63287>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63288>>>>>>>>>                Set Enabled_State to FALSE
63289>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63290>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63291>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63292>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63293>>>>>>>>>
63293>>>>>>>>>                //AB-StoreStart
63293>>>>>>>>>                Procedure End_Construct_Object
63295>>>>>>>>>                    Integer idecimals
63296>>>>>>>>>                    Forward Send End_Construct_Object
63298>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63299>>>>>>>>>                    Set Points Item 0 to idecimals
63300>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63301>>>>>>>>>                End_Procedure
63302>>>>>>>>>                
63302>>>>>>>>>                
63302>>>>>>>>>                
63302>>>>>>>>>                //AB-StoreEnd
63302>>>>>>>>>
63302>>>>>>>>>            End_Object    // Clients_Pistosh
63303>>>>>>>>>
63303>>>>>>>>>            Object Clients_Ypoloipo is a dbFormSubs
63305>>>>>>>>>                Entry_Item Clients.Ypoloipo
63306>>>>>>>>>                Set Size to 13 138
63307>>>>>>>>>                Set Location to 58 72
63308>>>>>>>>>                Set Color to clBtnFace
63309>>>>>>>>>                Set Label_Col_Offset to 2
63310>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63311>>>>>>>>>                Set Enabled_State to FALSE
63312>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63313>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63314>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63315>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63316>>>>>>>>>
63316>>>>>>>>>                //AB-StoreStart
63316>>>>>>>>>                Procedure End_Construct_Object
63318>>>>>>>>>                    Integer idecimals
63319>>>>>>>>>                    Forward Send End_Construct_Object
63321>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63322>>>>>>>>>                    Set Points Item 0 to idecimals
63323>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63324>>>>>>>>>                End_Procedure
63325>>>>>>>>>                
63325>>>>>>>>>                
63325>>>>>>>>>                
63325>>>>>>>>>                //AB-StoreEnd
63325>>>>>>>>>
63325>>>>>>>>>            End_Object    // Clients_Ypoloipo
63326>>>>>>>>>
63326>>>>>>>>>            Object TextBoxSub39 is a TextBoxSub
63328>>>>>>>>>                Set Label to "œ¢á«žª"
63329>>>>>>>>>                Set Location to 15 399
63330>>>>>>>>>                Set Size to 10 31
63331>>>>>>>>>                Set FontWeight to 600
63332>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63333>>>>>>>>>
63333>>>>>>>>>                //AB-StoreStart
63333>>>>>>>>>                                                                                                                                                                                                                        
63333>>>>>>>>>                Set Visible_State to False
63334>>>>>>>>>                Set Enabled_State to False
63335>>>>>>>>>                
63335>>>>>>>>>                //AB-StoreEnd
63335>>>>>>>>>
63335>>>>>>>>>            End_Object    // TextBoxSub39
63336>>>>>>>>>
63336>>>>>>>>>            Object TextBoxSub40 is a TextBoxSub
63338>>>>>>>>>                Set Label to "å©«à©ž"
63339>>>>>>>>>                Set Location to 42 4
63340>>>>>>>>>                Set Size to 10 39
63341>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63342>>>>>>>>>            End_Object    // TextBoxSub40
63343>>>>>>>>>
63343>>>>>>>>>            Object TextBoxSub41 is a TextBoxSub
63345>>>>>>>>>                Set Label to "•¨âà©ž"
63346>>>>>>>>>                Set Location to 28 4
63347>>>>>>>>>                Set Size to 10 36
63348>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63349>>>>>>>>>            End_Object    // TextBoxSub41
63350>>>>>>>>>
63350>>>>>>>>>            Object TextBoxSub42 is a TextBoxSub
63352>>>>>>>>>                Set Label to "“§æ¢¦ §¦"
63353>>>>>>>>>                Set Location to 58 4
63354>>>>>>>>>                Set Size to 10 43
63355>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63356>>>>>>>>>            End_Object    // TextBoxSub42
63357>>>>>>>>>
63357>>>>>>>>>            Object TextBoxSub43 is a TextBoxSub
63359>>>>>>>>>                Set Label to "Ž¨ ¦ €¤¦ ¡«¦ç Š¦š."
63360>>>>>>>>>                Set Location to 77 4
63361>>>>>>>>>                Set Size to 10 65
63362>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63363>>>>>>>>>            End_Object    // TextBoxSub43
63364>>>>>>>>>
63364>>>>>>>>>            Object TextBoxSub44 is a TextBoxSub
63366>>>>>>>>>                Set Label to "OverHead"
63367>>>>>>>>>                Set Location to 92 4
63368>>>>>>>>>                Set Size to 10 45
63369>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63370>>>>>>>>>            End_Object    // TextBoxSub44
63371>>>>>>>>>
63371>>>>>>>>>            Object Clients_Plafon is a dbFormSubs
63373>>>>>>>>>                Entry_Item Clients.Plafon
63374>>>>>>>>>                Set Size to 13 138
63375>>>>>>>>>                Set Location to 76 72
63376>>>>>>>>>                Set Label_Col_Offset to 2
63377>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63378>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63379>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63380>>>>>>>>>
63380>>>>>>>>>                //AB-StoreStart
63380>>>>>>>>>                Procedure End_Construct_Object
63382>>>>>>>>>                    Integer idecimals
63383>>>>>>>>>                    Forward Send End_Construct_Object
63385>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63386>>>>>>>>>                    Set Points Item 0 to idecimals
63387>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63388>>>>>>>>>                End_Procedure
63389>>>>>>>>>                
63389>>>>>>>>>                
63389>>>>>>>>>                //AB-StoreEnd
63389>>>>>>>>>
63389>>>>>>>>>            End_Object    // Clients_Plafon
63390>>>>>>>>>
63390>>>>>>>>>            Object Clients_Overhead is a dbFormSubs
63392>>>>>>>>>                Entry_Item Clients.Overhead
63393>>>>>>>>>                Set Size to 13 138
63394>>>>>>>>>                Set Location to 92 72
63395>>>>>>>>>                Set Color to clBtnFace
63396>>>>>>>>>                Set Label_Col_Offset to 2
63397>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63398>>>>>>>>>                Set Enabled_State to FALSE
63399>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63400>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63401>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63402>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63403>>>>>>>>>
63403>>>>>>>>>                //AB-StoreStart
63403>>>>>>>>>                Procedure End_Construct_Object
63405>>>>>>>>>                    Integer idecimals
63406>>>>>>>>>                    Forward Send End_Construct_Object
63408>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63409>>>>>>>>>                    Set Points Item 0 to idecimals
63410>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63411>>>>>>>>>                End_Procedure
63412>>>>>>>>>                
63412>>>>>>>>>                //AB-StoreEnd
63412>>>>>>>>>
63412>>>>>>>>>            End_Object    // Clients_Overhead
63413>>>>>>>>>
63413>>>>>>>>>            Object Clients_Synolikh_Ofeilh is a dbFormSubs
63415>>>>>>>>>                Entry_Item Clients.Synolikh_ofeilh
63416>>>>>>>>>                Set Size to 13 138
63417>>>>>>>>>                Set Location to 123 72
63418>>>>>>>>>                Set Color to clBtnFace
63419>>>>>>>>>                Set Label_Col_Offset to 2
63420>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63421>>>>>>>>>                Set Enabled_State to FALSE
63422>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63423>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63424>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63425>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63426>>>>>>>>>
63426>>>>>>>>>                //AB-StoreStart
63426>>>>>>>>>                Procedure End_Construct_Object
63428>>>>>>>>>                    Integer idecimals
63429>>>>>>>>>                    Forward Send End_Construct_Object
63431>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63432>>>>>>>>>                    Set Points Item 0 to idecimals
63433>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63434>>>>>>>>>                End_Procedure
63435>>>>>>>>>                
63435>>>>>>>>>                
63435>>>>>>>>>                
63435>>>>>>>>>                //AB-StoreEnd
63435>>>>>>>>>
63435>>>>>>>>>            End_Object    // Clients_Synolikh_Ofeilh
63436>>>>>>>>>
63436>>>>>>>>>            Object TextBoxSub52 is a TextBoxSub
63438>>>>>>>>>                Set Label to "‘¬¤¦¢ ¡ã Ž­œ ¢ã"
63439>>>>>>>>>                Set Location to 122 4
63440>>>>>>>>>                Set Size to 12 55
63441>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63442>>>>>>>>>            End_Object    // TextBoxSub52
63443>>>>>>>>>
63443>>>>>>>>>            Object TextBoxSub53 is a TextBoxSub
63445>>>>>>>>>                Set Label to "‰¢œ ›à£â¤¦ª"
63446>>>>>>>>>                Set Location to 2 4
63447>>>>>>>>>                Set Size to 12 43
63448>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63449>>>>>>>>>            End_Object    // TextBoxSub53
63450>>>>>>>>>
63450>>>>>>>>>            Object TextBoxSub59 is a TextBoxSub
63452>>>>>>>>>                Set Label to "¨¦£žŸœ¬«ãª"
63453>>>>>>>>>                Set Location to 2 398
63454>>>>>>>>>                Set Size to 10 51
63455>>>>>>>>>                Set FontWeight to 600
63456>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63457>>>>>>>>>
63457>>>>>>>>>                //AB-StoreStart
63457>>>>>>>>>                                                                                                                                                                                                                        
63457>>>>>>>>>                Set Visible_State to False
63458>>>>>>>>>                Set Enabled_State to False
63459>>>>>>>>>                
63459>>>>>>>>>                //AB-StoreEnd
63459>>>>>>>>>
63459>>>>>>>>>            End_Object    // TextBoxSub59
63460>>>>>>>>>
63460>>>>>>>>>            Object Clients_Orio_Syn_Ofeilh is a dbFormSubs
63462>>>>>>>>>                Entry_Item Clients.Orio_syn_ofeilh
63463>>>>>>>>>                Set Size to 13 138
63464>>>>>>>>>                Set Location to 108 72
63465>>>>>>>>>                Set Label_Col_Offset to 2
63466>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63467>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63468>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63469>>>>>>>>>
63469>>>>>>>>>                //AB-StoreStart
63469>>>>>>>>>                Procedure End_Construct_Object
63471>>>>>>>>>                    Integer idecimals
63472>>>>>>>>>                    Forward Send End_Construct_Object
63474>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63475>>>>>>>>>                    Set Points Item 0 to idecimals
63476>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63477>>>>>>>>>                End_Procedure
63478>>>>>>>>>                //AB-StoreEnd
63478>>>>>>>>>
63478>>>>>>>>>            End_Object    // Clients_Orio_Syn_Ofeilh
63479>>>>>>>>>
63479>>>>>>>>>            Object Clients_Client_Ptyppar is a dbFormSub
63481>>>>>>>>>                Entry_Item Clients.Client_ptyppar
63482>>>>>>>>>                Set Size to 13 47
63483>>>>>>>>>                Set Location to 40 281
63484>>>>>>>>>                Set Label_Col_Offset to 2
63485>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63486>>>>>>>>>                Set Prompt_Button_Mode to pb_PromptOn
63487>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63488>>>>>>>>>
63488>>>>>>>>>                //AB-StoreStart
63488>>>>>>>>>                set prompt_object to (sl012(self))
63489>>>>>>>>>                procedure onchange
63491>>>>>>>>>                    string sptyppar sdescr
63492>>>>>>>>>                    get value item 0 to sptyppar
63493>>>>>>>>>                    move (fsptyppar(self,sptyppar)) to sdescr
63494>>>>>>>>>                    set value of (formsub1(dbtabpagesub4(dbtabdialogsub2(self)))) to sdescr
63495>>>>>>>>>                end_procedure
63496>>>>>>>>>                
63496>>>>>>>>>                Procedure Prompt
63498>>>>>>>>>                    String sVal
63499>>>>>>>>>                    Set Modal_State Of (sl012(Current_object)) to True
63500>>>>>>>>>                    Set psModule Of (sl012(Current_object)) to (psModule(Self))
63501>>>>>>>>>                    set pifromclient Of (sl012(Current_object)) to 1
63502>>>>>>>>>                    Forward Send Prompt
63504>>>>>>>>>                    set pifromclient Of (sl012(Current_object)) to 0
63505>>>>>>>>>                End_procedure
63506>>>>>>>>>                
63506>>>>>>>>>                procedure key
63508>>>>>>>>>                end_procedure
63509>>>>>>>>>                
63509>>>>>>>>>                
63509>>>>>>>>>                //AB-StoreEnd
63509>>>>>>>>>
63509>>>>>>>>>            End_Object    // Clients_Client_Ptyppar
63510>>>>>>>>>
63510>>>>>>>>>            Object Clients_Client_Seira is a dbFormSub
63512>>>>>>>>>                Entry_Item Clients.Client_seira
63513>>>>>>>>>                Set Size to 13 47
63514>>>>>>>>>                Set Location to 55 281
63515>>>>>>>>>                Set Label_Col_Offset to 2
63516>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63517>>>>>>>>>                Set Prompt_Button_Mode to pb_PromptOn
63518>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63519>>>>>>>>>
63519>>>>>>>>>                //AB-StoreStart
63519>>>>>>>>>                set prompt_object to (sl013(self))
63520>>>>>>>>>                
63520>>>>>>>>>                procedure prompt
63522>>>>>>>>>                    string sptyppar srecr
63523>>>>>>>>>                    get value of clients_client_ptyppar to sptyppar
63524>>>>>>>>>                    clear ptyppar
63525>>>>>>>>>                    move syscurxr.company_code  to ptyppar.company_code
63526>>>>>>>>>                    move syscurxr.branch_code   to ptyppar.branch_code
63527>>>>>>>>>                    move syscurxr.year_year     to ptyppar.year_year
63528>>>>>>>>>                    move sptyppar               to ptyppar.ptyppar_code
63529>>>>>>>>>                    find eq ptyppar by index.1
63530>>>>>>>>>>
63530>>>>>>>>>                    if (found=1) set FragmaPtyppar_Recr of (sl013(self)) to ptyppar.ptyppar_recr
63533>>>>>>>>>                    forward send prompt
63535>>>>>>>>>                end_procedure
63536>>>>>>>>>                
63536>>>>>>>>>                
63536>>>>>>>>>                
63536>>>>>>>>>                procedure key
63538>>>>>>>>>                end_procedure
63539>>>>>>>>>                
63539>>>>>>>>>                
63539>>>>>>>>>                //AB-StoreEnd
63539>>>>>>>>>
63539>>>>>>>>>            End_Object    // Clients_Client_Seira
63540>>>>>>>>>
63540>>>>>>>>>            Object Clients_Hpso is a dbFormSub
63542>>>>>>>>>                Entry_Item Clients.Hpso
63543>>>>>>>>>                Set Size to 13 30
63544>>>>>>>>>                Set Location to 75 281
63545>>>>>>>>>                Set Label_Col_Offset to 2
63546>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63547>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63548>>>>>>>>>            End_Object    // Clients_Hpso
63549>>>>>>>>>
63549>>>>>>>>>            Object Clients_Hpal is a dbFormSub
63551>>>>>>>>>                Entry_Item Clients.Hpal
63552>>>>>>>>>                Set Size to 13 30
63553>>>>>>>>>                Set Location to 92 281
63554>>>>>>>>>                Set Label_Col_Offset to 2
63555>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63556>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63557>>>>>>>>>            End_Object    // Clients_Hpal
63558>>>>>>>>>
63558>>>>>>>>>            Object Clients_Poso_Se_Apait is a dbFormSubs
63560>>>>>>>>>                Entry_Item Clients.Poso_se_apait
63561>>>>>>>>>                Set Size to 13 59
63562>>>>>>>>>                Set Location to 109 281
63563>>>>>>>>>                Set TextColor to clRed
63564>>>>>>>>>                Set Label_Col_Offset to 2
63565>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63566>>>>>>>>>                Set Form_FontWeight Item 0 to 600
63567>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63568>>>>>>>>>
63568>>>>>>>>>                //AB-StoreStart
63568>>>>>>>>>                Set Item_Option Item 0  to NoEnter True
63569>>>>>>>>>                Set TextColor           to clRed
63570>>>>>>>>>                
63570>>>>>>>>>                Procedure End_Construct_Object
63572>>>>>>>>>                    Integer idecimals
63573>>>>>>>>>                    Forward Send End_Construct_Object
63575>>>>>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    idecimals
63576>>>>>>>>>                    Set Points Item 0 to idecimals
63577>>>>>>>>>                    Set Numeric_Mask Item 0 to 14 idecimals ' ,*'
63578>>>>>>>>>                End_Procedure
63579>>>>>>>>>                
63579>>>>>>>>>                
63579>>>>>>>>>                //AB-StoreEnd
63579>>>>>>>>>
63579>>>>>>>>>            End_Object    // Clients_Poso_Se_Apait
63580>>>>>>>>>
63580>>>>>>>>>            Object Clients_Is_Pelaths is a dbCheckBoxSub
63582>>>>>>>>>                Entry_Item Clients.Is_client
63583>>>>>>>>>                Set Size to 13 10
63584>>>>>>>>>                Set Location to 14 460
63585>>>>>>>>>
63585>>>>>>>>>                //AB-StoreStart
63585>>>>>>>>>                                                                                                                                                                                                                        
63585>>>>>>>>>                Set Visible_State to False
63586>>>>>>>>>                Set Enabled_State to False
63587>>>>>>>>>                
63587>>>>>>>>>                //AB-StoreEnd
63587>>>>>>>>>
63587>>>>>>>>>            End_Object    // Clients_Is_Pelaths
63588>>>>>>>>>
63588>>>>>>>>>            Object Clients_Is_Promhtheyths is a dbCheckBoxSub
63590>>>>>>>>>                Entry_Item Clients.Is_promhtheyths
63591>>>>>>>>>                Set Size to 13 10
63592>>>>>>>>>                Set Location to 2 460
63593>>>>>>>>>
63593>>>>>>>>>                //AB-StoreStart
63593>>>>>>>>>                                                                                                                                                                                                                        
63593>>>>>>>>>                                                                                                                                                                                                                        
63593>>>>>>>>>                Set Visible_State to False
63594>>>>>>>>>                Set Enabled_State to False
63595>>>>>>>>>                
63595>>>>>>>>>                //AB-StoreEnd
63595>>>>>>>>>
63595>>>>>>>>>            End_Object    // Clients_Is_Promhtheyths
63596>>>>>>>>>
63596>>>>>>>>>            Object TextBoxSub60 is a TextBoxSub
63598>>>>>>>>>                Set Label to "„§ ©­˜¢ã ¦©á"
63599>>>>>>>>>                Set Location to 110 218
63600>>>>>>>>>                Set Size to 10 53
63601>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63602>>>>>>>>>            End_Object    // TextBoxSub60
63603>>>>>>>>>
63603>>>>>>>>>            Object Clients_Last_Xreosh is a dbFormSub
63605>>>>>>>>>                Entry_Item Clients.Last_xreosh
63606>>>>>>>>>                Set Size to 13 66
63607>>>>>>>>>                Set Location to 138 72
63608>>>>>>>>>                Set Label_Col_Offset to 2
63609>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63610>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63611>>>>>>>>>
63611>>>>>>>>>                //AB-StoreStart
63611>>>>>>>>>                set enabled_state to false
63612>>>>>>>>>                //AB-StoreEnd
63612>>>>>>>>>
63612>>>>>>>>>            End_Object    // Clients_Last_Xreosh
63613>>>>>>>>>
63613>>>>>>>>>            Object Clients_Last_Pistosh is a dbFormSub
63615>>>>>>>>>                Entry_Item Clients.Last_pistosh
63616>>>>>>>>>                Set Size to 13 66
63617>>>>>>>>>                Set Location to 138 208
63618>>>>>>>>>                Set Label_Col_Offset to 2
63619>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63620>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63621>>>>>>>>>
63621>>>>>>>>>                //AB-StoreStart
63621>>>>>>>>>                set enabled_state to false
63622>>>>>>>>>                //AB-StoreEnd
63622>>>>>>>>>
63622>>>>>>>>>            End_Object    // Clients_Last_Pistosh
63623>>>>>>>>>
63623>>>>>>>>>            Object Textbox1 is a Textbox
63625>>>>>>>>>                Set Label to "’œ¢œ¬«.•¨âà©ž"
63626>>>>>>>>>                Set Location to 140 4
63627>>>>>>>>>                Set Size to 10 55
63628>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63629>>>>>>>>>            End_Object    // Textbox1
63630>>>>>>>>>
63630>>>>>>>>>            Object Textbox2 is a Textbox
63632>>>>>>>>>                Set Label to "’œ¢œ¬«.å©«à©ž"
63633>>>>>>>>>                Set Location to 139 146
63634>>>>>>>>>                Set Size to 12 57
63635>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63636>>>>>>>>>            End_Object    // Textbox2
63637>>>>>>>>>
63637>>>>>>>>>            Object TextBoxSub61 is a TextBoxSub
63639>>>>>>>>>                Set Label to "œ¢á«žª „¥à«."
63640>>>>>>>>>                Set Location to 2 95
63641>>>>>>>>>                Set Size to 12 49
63642>>>>>>>>>                Set FontWeight to 600
63643>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63644>>>>>>>>>
63644>>>>>>>>>                //AB-StoreStart
63644>>>>>>>>>                                                                                                                                                                                                                        
63644>>>>>>>>>                                                                                                                                                                                                                        
63644>>>>>>>>>                                                                                                                                                                                                                        
63644>>>>>>>>>                                                                                                                                                                                                                        
63644>>>>>>>>>                //AB-StoreEnd
63644>>>>>>>>>
63644>>>>>>>>>            End_Object    // TextBoxSub61
63645>>>>>>>>>
63645>>>>>>>>>            Object Clients_Feregios is a dbComboFormSub
63647>>>>>>>>>                Entry_Item Clients.Feregios
63648>>>>>>>>>                Set Size to 13 123
63649>>>>>>>>>                Set Location to 139 361
63650>>>>>>>>>                Set Label_Col_Offset to 2
63651>>>>>>>>>            End_Object    // Clients_Feregios
63652>>>>>>>>>
63652>>>>>>>>>            Object Clients_Is_Eksoter is a dbCheckBoxSub
63654>>>>>>>>>                Entry_Item Clients.Is_eksoter
63655>>>>>>>>>                Set Size to 13 19
63656>>>>>>>>>                Set Location to 2 161
63657>>>>>>>>>            End_Object    // Clients_Is_Eksoter
63658>>>>>>>>>
63658>>>>>>>>>            Object TextBoxSub62 is a TextBoxSub
63660>>>>>>>>>                Set Label to "•¦¤›¨ ¡ãª"
63661>>>>>>>>>                Set Location to 3 186
63662>>>>>>>>>                Set Size to 10 41
63663>>>>>>>>>                Set FontWeight to 600
63664>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63665>>>>>>>>>
63665>>>>>>>>>                //AB-StoreStart
63665>>>>>>>>>                                                                                                                                                                                                                        
63665>>>>>>>>>                                                                                                                                                                                                                        
63665>>>>>>>>>                                                                                                                                                                                                                        
63665>>>>>>>>>                                                                                                                                                                                                                        
63665>>>>>>>>>                //AB-StoreEnd
63665>>>>>>>>>
63665>>>>>>>>>            End_Object    // TextBoxSub62
63666>>>>>>>>>
63666>>>>>>>>>            Object Clients_Is_Xondr is a dbCheckBoxSub
63668>>>>>>>>>                Entry_Item Clients.Is_xondr
63669>>>>>>>>>                Set Size to 13 15
63670>>>>>>>>>                Set Location to 2 236
63671>>>>>>>>>            End_Object    // Clients_Is_Xondr
63672>>>>>>>>>
63672>>>>>>>>>            Object Textbox3 is a Textbox
63674>>>>>>>>>                Set Label to "î¨ ¦ ‘¬¤.Ž­œ ¢ãª "
63675>>>>>>>>>                Set Location to 109 4
63676>>>>>>>>>                Set Size to 9 60
63677>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63678>>>>>>>>>            End_Object    // Textbox3
63679>>>>>>>>>
63679>>>>>>>>>            Object TextBoxSub64 is a TextBoxSub
63681>>>>>>>>>                Set Label to "˜¨˜©«˜« ¡æ"
63682>>>>>>>>>                Set Location to 42 218
63683>>>>>>>>>                Set Size to 10 49
63684>>>>>>>>>                Set FontWeight to 600
63685>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63686>>>>>>>>>            End_Object    // TextBoxSub64
63687>>>>>>>>>
63687>>>>>>>>>            Object FormSub1 is a FormSub
63689>>>>>>>>>                Set Size to 13 136
63690>>>>>>>>>                Set Location to 40 333
63691>>>>>>>>>                Set Color to clBtnFace
63692>>>>>>>>>                Set Label_Col_Offset to 2
63693>>>>>>>>>                Set Enabled_State to FALSE
63694>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63695>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63696>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63697>>>>>>>>>            End_Object    // FormSub1
63698>>>>>>>>>
63698>>>>>>>>>            Object TextBoxSub65 is a TextBoxSub
63700>>>>>>>>>                Set Label to "‘œ ¨á"
63701>>>>>>>>>                Set Location to 58 218
63702>>>>>>>>>                Set Size to 10 21
63703>>>>>>>>>                Set FontWeight to 600
63704>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63705>>>>>>>>>            End_Object    // TextBoxSub65
63706>>>>>>>>>
63706>>>>>>>>>            Object TextBoxSub66 is a TextBoxSub
63708>>>>>>>>>                Set Label to "‘«æ®¦ª †‘Ž"
63709>>>>>>>>>                Set Location to 78 218
63710>>>>>>>>>                Set Size to 10 47
63711>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63712>>>>>>>>>            End_Object    // TextBoxSub66
63713>>>>>>>>>
63713>>>>>>>>>            Object TextBoxSub67 is a TextBoxSub
63715>>>>>>>>>                Set Label to "‘«æ®¦ª †€Š "
63716>>>>>>>>>                Set Location to 93 218
63717>>>>>>>>>                Set Size to 10 46
63718>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63719>>>>>>>>>            End_Object    // TextBoxSub67
63720>>>>>>>>>
63720>>>>>>>>>            Object Textbox6 is a Textbox
63722>>>>>>>>>                Set Label to "”œ¨œšš¬æ«ž«˜ ”¦¨â˜"
63723>>>>>>>>>                Set Location to 140 281
63724>>>>>>>>>                Set Size to 10 81
63725>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63726>>>>>>>>>            End_Object    // Textbox6
63727>>>>>>>>>
63727>>>>>>>>>            Object Clients_Custprom_Code is a dbCheckBoxSub
63729>>>>>>>>>                Entry_Item Clients.Custprom_code
63730>>>>>>>>>                Set Label to "ƒž£æ© ¦ •à¨åª €”‹ (‹“”)"
63731>>>>>>>>>                Set Size to 10 106
63732>>>>>>>>>                Set Location to 56 364
63733>>>>>>>>>            End_Object    // Clients_Custprom_Code
63734>>>>>>>>>
63734>>>>>>>>>            Object Clients_Custprom_Recr is a dbCheckBoxSub
63736>>>>>>>>>                Entry_Item Clients.Custprom_recr
63737>>>>>>>>>                Set Label to "€š¨æ«žª (‹“”)"
63738>>>>>>>>>                Set Size to 10 77
63739>>>>>>>>>                Set Location to 67 364
63740>>>>>>>>>            End_Object    // Clients_Custprom_Recr
63741>>>>>>>>>
63741>>>>>>>>>            Object Clients_Endoomil is a dbCheckBoxSub
63743>>>>>>>>>                Entry_Item Clients.Endoomil
63744>>>>>>>>>                Set Label to "„¤›¦¦£ ¢ ¡æª"
63745>>>>>>>>>                Set Size to 10 66
63746>>>>>>>>>                Set Location to 78 364
63747>>>>>>>>>            End_Object    // Clients_Endoomil
63748>>>>>>>>>
63748>>>>>>>>>            Object Clients_Npdd is a dbCheckBoxSub
63750>>>>>>>>>                Entry_Item Clients.Npdd
63751>>>>>>>>>                Set Label to "Œ..ƒ.ƒ"
63752>>>>>>>>>                Set Size to 10 46
63753>>>>>>>>>                Set Location to 89 364
63754>>>>>>>>>            End_Object    // Clients_Npdd
63755>>>>>>>>>
63755>>>>>>>>>            Object Clients_Anal is a dbCheckBoxSub
63757>>>>>>>>>                Entry_Item Clients.Anal
63758>>>>>>>>>                Set Label to "‘¬š¡œ¤«¨à« ¡á SAP"
63759>>>>>>>>>                Set Size to 10 88
63760>>>>>>>>>                Set Location to 99 364
63761>>>>>>>>>                Set Visible_State to FALSE
63762>>>>>>>>>            End_Object    // Clients_Anal
63763>>>>>>>>>
63763>>>>>>>>>            Object Clients_Status is a dbFormSub
63765>>>>>>>>>                Entry_Item Clients.Status
63766>>>>>>>>>                Set Size to 13 21
63767>>>>>>>>>                Set Location to 109 460
63768>>>>>>>>>                Set Color to clBtnFace
63769>>>>>>>>>                Set Label_Col_Offset to 2
63770>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63771>>>>>>>>>                Set Enabled_State to FALSE
63772>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63773>>>>>>>>>                Set Item_Shadow_State Item 0 to TRUE
63774>>>>>>>>>                Set Shadow_State Item 0 to TRUE
63775>>>>>>>>>            End_Object    // Clients_Status
63776>>>>>>>>>
63776>>>>>>>>>            Object TextBoxSub70 is a TextBoxSub
63778>>>>>>>>>                Set Label to "‰˜«á©«˜©ž"
63779>>>>>>>>>                Set Location to 110 409
63780>>>>>>>>>                Set Size to 10 43
63781>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63782>>>>>>>>>            End_Object    // TextBoxSub70
63783>>>>>>>>>
63783>>>>>>>>>            Object Clients_Client_Fpa is a dbCheckBoxSub
63785>>>>>>>>>                Entry_Item Clients.Client_fpa
63786>>>>>>>>>                Set Size to 13 14
63787>>>>>>>>>                Set Location to 13 236
63788>>>>>>>>>            End_Object    // Clients_Client_Fpa
63789>>>>>>>>>
63789>>>>>>>>>            Object TextBoxSub71 is a TextBoxSub
63791>>>>>>>>>                Set Label to "NO SAP"
63792>>>>>>>>>                Set Location to 14 193
63793>>>>>>>>>                Set Size to 10 28
63794>>>>>>>>>                Set FontWeight to 600
63795>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63796>>>>>>>>>
63796>>>>>>>>>                //AB-StoreStart
63796>>>>>>>>>                                                                                                                                                                                                                        
63796>>>>>>>>>                                                                                                                                                                                                                        
63796>>>>>>>>>                //AB-StoreEnd
63796>>>>>>>>>
63796>>>>>>>>>            End_Object    // TextBoxSub71
63797>>>>>>>>>
63797>>>>>>>>>            Object Textbox7 is a Textbox
63799>>>>>>>>>                Set Label to "†£/¤å˜ SAP"
63800>>>>>>>>>                Set Location to 126 364
63801>>>>>>>>>                Set Size to 10 46
63802>>>>>>>>>                Set TypeFace to "MS Sans Serif"
63803>>>>>>>>>            End_Object    // Textbox7
63804>>>>>>>>>
63804>>>>>>>>>            Object Clients_SAPHMNIA is a dbFormSub
63806>>>>>>>>>                Entry_Item Clients.Sap_hmnia
63807>>>>>>>>>                Set Size to 13 66
63808>>>>>>>>>                Set Location to 124 417
63809>>>>>>>>>                Set Label_Col_Offset to 2
63810>>>>>>>>>                Set Label_Justification_Mode to jMode_Right
63811>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63812>>>>>>>>>
63812>>>>>>>>>                //AB-StoreStart
63812>>>>>>>>>                set enabled_state to false
63813>>>>>>>>>                //AB-StoreEnd
63813>>>>>>>>>
63813>>>>>>>>>            End_Object    // Clients_SAPHMNIA
63814>>>>>>>>>
63814>>>>>>>>>
63814>>>>>>>>>            //AB-StoreStart
63814>>>>>>>>>                                                                                                                                                                        
63814>>>>>>>>>            set label to "Ž ¡¦¤¦£ ¡á"
63815>>>>>>>>>            
63815>>>>>>>>>            
63815>>>>>>>>>            
63815>>>>>>>>>            //AB-StoreEnd
63815>>>>>>>>>
63815>>>>>>>>>        End_Object    // dbTabPageSub4
63816>>>>>>>>>
63816>>>>>>>>>        Object dbTabPageSub3 is a dbTabPageSub
63818>>>>>>>>>            Set Label to "dbTabPageSub3"
63819>>>>>>>>>            Object Clnbank_ is a dbGridSub
63821>>>>>>>>>
63821>>>>>>>>>                //AB-StoreTopStart
63821>>>>>>>>>                                                                                                                                                                                                                        
63821>>>>>>>>>                //AB-StoreTopEnd
63821>>>>>>>>>
63821>>>>>>>>>                Set Main_File to Clnbank.File_Number
63822>>>>>>>>>                Set Server to (Clnbank_DD(self))
63823>>>>>>>>>                Set Size to 140 475
63824>>>>>>>>>                Set Location to 7 7
63825>>>>>>>>>                Set Wrap_State to TRUE
63826>>>>>>>>>
63826>>>>>>>>>                Begin_Row
63829>>>>>>>>>                    Entry_Item Clnbank.Bank_id
63830>>>>>>>>>                    Entry_Item (gsfCode_Mast('BANK',ClnBank.Bank_ID))
63831>>>>>>>>>                    Entry_Item Clnbank.Logariasmos
63832>>>>>>>>>                End_Row
63837>>>>>>>>>
63837>>>>>>>>>                Set Form_Width    item 0 to 78
63838>>>>>>>>>                Set Header_Label  item 0 to "’¨á§œ˜"
63839>>>>>>>>>                
63839>>>>>>>>>                Set Form_Width    item 1 to 180
63840>>>>>>>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
63841>>>>>>>>>                
63841>>>>>>>>>                Set Form_Width    item 2 to 210
63842>>>>>>>>>                Set Header_Label  item 2 to "Š¦š˜¨ ˜©£æª"
63843>>>>>>>>>                
63843>>>>>>>>>
63843>>>>>>>>>                //AB-StoreStart
63843>>>>>>>>>                                                                                                                                                                                                                        
63843>>>>>>>>>                Set Column_Option Item 1 to NoEnter True
63844>>>>>>>>>                
63844>>>>>>>>>                Procedure Item_Change Integer iFromItem Integer iToItem Returns Integer
63846>>>>>>>>>                    String sID sVal
63847>>>>>>>>>                    Integer iBase iCI iCol rVal
63847>>>>>>>>>                    If (Focus(Desktop)=ClnBank_(Self)) Begin
63849>>>>>>>>>                        Get Base_Item           to iBase
63850>>>>>>>>>                        Get Value Item iBase    to sID
63851>>>>>>>>>                        If (Trim(sID)<>'') Set Value Item (iBase+1) to ;                                (gsfCode_Mast('BANK',sID))
63854>>>>>>>>>                    End
63854>>>>>>>>>>
63854>>>>>>>>>                    Forward Get Msg_Item_Change iFromItem iToItem to rVal
63856>>>>>>>>>                    Procedure_Return rVal
63857>>>>>>>>>                End_Procedure
63858>>>>>>>>>                
63858>>>>>>>>>                Function Child_entering returns Integer
63860>>>>>>>>>                    Integer rval iErr
63861>>>>>>>>>                    Forward Get Child_Entering to rVal
63863>>>>>>>>>                    If (NOT(rVal)) Begin
63865>>>>>>>>>                        If (Current_Record(Clients_DD(Self))) Forward Get Child_Entering to rVal
63869>>>>>>>>>                        Else Begin
63870>>>>>>>>>                            Function_Return 1
63871>>>>>>>>>                        End
63871>>>>>>>>>>
63871>>>>>>>>>                    End
63871>>>>>>>>>>
63871>>>>>>>>>                    function_return rVal
63872>>>>>>>>>                End_Function
63873>>>>>>>>>                
63873>>>>>>>>>                
63873>>>>>>>>>                
63873>>>>>>>>>                
63873>>>>>>>>>                
63873>>>>>>>>>                
63873>>>>>>>>>                
63873>>>>>>>>>                //AB-StoreEnd
63873>>>>>>>>>
63873>>>>>>>>>            End_Object    // Clnbank_
63874>>>>>>>>>
63874>>>>>>>>>
63874>>>>>>>>>            //AB-StoreStart
63874>>>>>>>>>                                                                                                                                                                        
63874>>>>>>>>>            set label to "’¨á§œœª"
63875>>>>>>>>>            
63875>>>>>>>>>            //AB-StoreEnd
63875>>>>>>>>>
63875>>>>>>>>>        End_Object    // dbTabPageSub3
63876>>>>>>>>>
63876>>>>>>>>>        Object dbTabPageSub4 is a dbTabPageSub
63878>>>>>>>>>            Set Label to "dbTabPageSub4"
63879>>>>>>>>>            Object Tpclient_ is a dbGridSub
63881>>>>>>>>>                Set Main_File to Tpclient.File_Number
63882>>>>>>>>>                Set Server to (Tpclient_DD(self))
63883>>>>>>>>>                Set Size to 130 480
63884>>>>>>>>>                Set Location to 5 4
63885>>>>>>>>>                Set Wrap_State to TRUE
63886>>>>>>>>>
63886>>>>>>>>>                Begin_Row
63889>>>>>>>>>                    Entry_Item Baxiokat.Baxiokat_descr
63890>>>>>>>>>                    Entry_Item Tpclient.Pct_epi_synolou
63891>>>>>>>>>                    Entry_Item Tpclient.Paralabh_meres
63892>>>>>>>>>                    Entry_Item Tpclient.Xarhtos_meres
63893>>>>>>>>>                    Entry_Item Tpclient.Plhroteo_meres
63894>>>>>>>>>                End_Row
63899>>>>>>>>>
63899>>>>>>>>>                Set Form_Width    item 0 to 158
63900>>>>>>>>>                Set Header_Label  item 0 to "’¨æ§¦ª"
63901>>>>>>>>>                
63901>>>>>>>>>                Set Form_Width    item 1 to 63
63902>>>>>>>>>                Set Header_Label  item 1 to "% œ§å ‘¬¤æ¢¦¬"
63903>>>>>>>>>                
63903>>>>>>>>>                Set Form_Width    item 2 to 73
63904>>>>>>>>>                Set Header_Label  item 2 to "˜¨˜¢˜™ã (£â¨œª)"
63905>>>>>>>>>                
63905>>>>>>>>>                Set Form_Width    item 3 to 90
63906>>>>>>>>>                Set Header_Label  item 3 to "ƒ á©«ž£˜ « £¦¢æšž©žª"
63907>>>>>>>>>                
63907>>>>>>>>>                Set Form_Width    item 4 to 90
63908>>>>>>>>>                Set Header_Label  item 4 to "Šã¥ž œ§ «˜šãª (†£â¨œª)"
63909>>>>>>>>>                
63909>>>>>>>>>
63909>>>>>>>>>                //AB-StoreStart
63909>>>>>>>>>                                                                                                                                                                                                                        
63909>>>>>>>>>                Function Child_entering returns Integer
63911>>>>>>>>>                    Integer rval iErr
63912>>>>>>>>>                    Forward Get Child_Entering to rVal
63914>>>>>>>>>                    If (NOT(rVal)) Begin
63916>>>>>>>>>                        If (Current_Record(Clients_DD(Self))) Forward Get Child_Entering to rVal
63920>>>>>>>>>                        Else Begin
63921>>>>>>>>>                            Function_Return 1
63922>>>>>>>>>                        End
63922>>>>>>>>>>
63922>>>>>>>>>                    End
63922>>>>>>>>>>
63922>>>>>>>>>                    function_return rVal
63923>>>>>>>>>                End_Function
63924>>>>>>>>>                
63924>>>>>>>>>                
63924>>>>>>>>>                
63924>>>>>>>>>                //AB-StoreEnd
63924>>>>>>>>>
63924>>>>>>>>>            End_Object    // Tpclient_
63925>>>>>>>>>
63925>>>>>>>>>            Object ButtonSub1 is a ButtonSub
63927>>>>>>>>>
63927>>>>>>>>>                //AB-StoreTopStart
63927>>>>>>>>>                                                                                                                                                                                                                        
63927>>>>>>>>>                //AB-StoreTopEnd
63927>>>>>>>>>
63927>>>>>>>>>                Set Label to "„ ©˜šàšã «¨æ§¦¬ §¢ž¨à£ãª ¬§œçŸ¬¤¦¬ §¢ž¨à£ãª, §¨¦ª «¨¦§¦§¦åž©ž"
63928>>>>>>>>>                Set Size to 14 244
63929>>>>>>>>>                Set Location to 138 121
63930>>>>>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
63931>>>>>>>>>
63931>>>>>>>>>                //AB-StoreStart
63931>>>>>>>>>                                                                                                                                                                                                                        
63931>>>>>>>>>                Procedure Bring_Records_From_Presp String asPrespID String asClientID
63933>>>>>>>>>                    Clear TPClient
63934>>>>>>>>>                    Move asPrespID to TPPresp.PayResp_ID
63935>>>>>>>>>                    Find Gt TPPresp By Index.1 // Presp_ID+...
63936>>>>>>>>>>
63936>>>>>>>>>                    While ((Found=1) And (TPPresp.PayResp_ID=asPrespID))
63940>>>>>>>>>                        Clear TPClient
63941>>>>>>>>>                        Move asClientID                to TPClient.Client_ID
63942>>>>>>>>>                        Move TPPresp.Baxiokat_Code     to TPClient.Baxiokat_Code
63943>>>>>>>>>                        Move TPPresp.Pct_Epi_Synolou   to TPClient.Pct_Epi_Synolou
63944>>>>>>>>>                        Move TPPresp.Paralabh_Meres    to TPClient.Paralabh_Meres
63945>>>>>>>>>                        Move TPPresp.Xarhtos_Meres     to TPClient.Xarhtos_Meres
63946>>>>>>>>>                        Move TPPresp.Plhroteo_Meres    to TPClient.Plhroteo_Meres
63947>>>>>>>>>                        Move (Sysrecc.TPClient_Rec0+1) to TPClient.TPClient_Rec0
63948>>>>>>>>>                        Reread Sysrecc
63952>>>>>>>>>                        Move (Sysrecc.TPClient_Rec0+1) to Sysrecc.TPClient_Rec0
63953>>>>>>>>>                        Saverecord Sysrecc
63954>>>>>>>>>                        UnLock
63955>>>>>>>>>>
63955>>>>>>>>>                        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                         (Trim(String(TPClient.TPClient_Rec0))))));                                                        to TPClient.TPClient_Recr
63956>>>>>>>>>                        Saverecord TPClient
63957>>>>>>>>>                        Find Gt TPPresp By Index.1 // Presp_ID+...
63958>>>>>>>>>>
63958>>>>>>>>>                    Loop
63959>>>>>>>>>>
63959>>>>>>>>>                    Send Beginning_Of_Data to TPClient_ True
63960>>>>>>>>>                End_Procedure
63961>>>>>>>>>                
63961>>>>>>>>>                
63961>>>>>>>>>                Procedure OnClick
63963>>>>>>>>>                    Integer iRecnum rVal iVal iClient
63964>>>>>>>>>                    String sClientID sPrespID
63964>>>>>>>>>                
63964>>>>>>>>>                    Send Beginning_Of_Data  to TPClient_ True
63965>>>>>>>>>                    Get Field_Current_Value Of Clients_DD    Field Clients.Recnum     to iRecnum
63966>>>>>>>>>                    Get Field_Current_Value Of Clients_DD    Field Clients.Client_ID  to sClientID
63967>>>>>>>>>                    Get Field_Current_Value Of TPClient_DD  Field TPClient.Recnum   to iClient
63968>>>>>>>>>                    Get Field_Current_Value Of PayResp_DD   Field Payresp.Presp_id  to sPrespID
63969>>>>>>>>>                
63969>>>>>>>>>                    If ((Trim(sClientID)<>'') And (iRecnum<>0) And (Trim(sPrespID)<>'')) Begin
63971>>>>>>>>>                        Get Message_Box "Œ˜ ˜¤« š¨á¯à «¦¬ª «¨æ§¦¬ª §¢ž¨à£ãª «¦¬ ¬§. §¢ž¨à£é¤ ?" "„§ ™œ™˜åà©ž";                            MB_OKCANCEL (MB_ICONQUESTION IOR MB_DEFBUTTON1) to iVal  // 1=ok 2=cancel
63972>>>>>>>>>                        If (iVal=1) Begin
63974>>>>>>>>>                            If (iClient) Begin
63976>>>>>>>>>                                Get Message_Box "Ÿ˜ › ˜š¨á¯à «¦¬ª ¬§á¨®¦¤«œª «¨æ§¦¬ª §¢ž¨à£ãª\n‡â¢œ«œ §˜¨˜š£˜« ¡á ¤˜ šå¤œ  ˜¬«æ ?" "„§ ™œ™˜åà©ž";                                    MB_OKCANCEL (MB_ICONQUESTION IOR MB_DEFBUTTON1) to iVal  // 1=ok 2=cancel
63977>>>>>>>>>                                If (iVal=1) Begin
63979>>>>>>>>>                                    Clear TPClient
63980>>>>>>>>>                                    Move sClientID to TPClient.Client_ID
63981>>>>>>>>>                                    Find Gt TPClient By Index.1 // Client_ID+.....
63982>>>>>>>>>>
63982>>>>>>>>>                                    While ((Found=1) And (TPClient.Client_ID=sClientID))
63986>>>>>>>>>                                        Delete TPClient
63987>>>>>>>>>                                        Find Gt TPClient By Index.1 // Client_ID+.....
63988>>>>>>>>>>
63988>>>>>>>>>                                    Loop
63989>>>>>>>>>>
63989>>>>>>>>>                                    Send Bring_Records_From_Presp sPrespID sClientID
63990>>>>>>>>>                                End
63990>>>>>>>>>>
63990>>>>>>>>>                            End
63990>>>>>>>>>>
63990>>>>>>>>>                            Else Send Bring_Records_From_Presp sPrespID sClientID
63992>>>>>>>>>                        End
63992>>>>>>>>>>
63992>>>>>>>>>                    End
63992>>>>>>>>>>
63992>>>>>>>>>                End_Procedure // OnClick
63993>>>>>>>>>                
63993>>>>>>>>>                
63993>>>>>>>>>                
63993>>>>>>>>>                
63993>>>>>>>>>                
63993>>>>>>>>>                
63993>>>>>>>>>                
63993>>>>>>>>>                //AB-StoreEnd
63993>>>>>>>>>
63993>>>>>>>>>            End_Object    // ButtonSub1
63994>>>>>>>>>
63994>>>>>>>>>
63994>>>>>>>>>            //AB-StoreStart
63994>>>>>>>>>                                                                                                                                                                        
63994>>>>>>>>>            Set label to "’¨æ§¦  ¢ž¨à£ãª"
63995>>>>>>>>>            
63995>>>>>>>>>            
63995>>>>>>>>>            //AB-StoreEnd
63995>>>>>>>>>
63995>>>>>>>>>        End_Object    // dbTabPageSub4
63996>>>>>>>>>
63996>>>>>>>>>        Object dbTabPageSub5 is a dbTabPageSub
63998>>>>>>>>>            Set Label to "dbTabPageSub5"
63999>>>>>>>>>            Object clitem_ is a dbGridSub
64001>>>>>>>>>                Set Main_File to Clitem.File_Number
64002>>>>>>>>>                Set Server to (Clitem_DD(self))
64003>>>>>>>>>                Set Ordering to 1
64004>>>>>>>>>                Set Size to 146 436
64005>>>>>>>>>                Set Location to 1 3
64006>>>>>>>>>                Set Color to 14280447
64007>>>>>>>>>                Set CurrentRowColor to 11783679
64008>>>>>>>>>                Set CurrentCellColor to 11783679
64009>>>>>>>>>                Set Wrap_State to TRUE
64010>>>>>>>>>
64010>>>>>>>>>                Begin_Row
64013>>>>>>>>>                    Entry_Item Clitem.Recnum
64014>>>>>>>>>                    Entry_Item Clitem.Item_code
64015>>>>>>>>>                    Entry_Item (Fswitemx(self,clitem.item_code))
64016>>>>>>>>>                    Entry_Item Clitem.Item_date
64017>>>>>>>>>                    Entry_Item Clitem.Item_price
64018>>>>>>>>>                    Entry_Item Clitem.Item_pctdisc
64019>>>>>>>>>                    Entry_Item Clitem.Item_axia
64020>>>>>>>>>                End_Row
64025>>>>>>>>>
64025>>>>>>>>>                Set Form_Width    item 0 to 0
64026>>>>>>>>>                Set Header_Label  item 0 to "Recnum"
64027>>>>>>>>>                
64027>>>>>>>>>                Set Form_Width    item 1 to 75
64028>>>>>>>>>                Set Header_Label  item 1 to "‰à› ¡æª œå›¦¬ª"
64029>>>>>>>>>                
64029>>>>>>>>>                Set Form_Width    item 2 to 120
64030>>>>>>>>>                Set Header_Label  item 2 to "œ¨ š¨˜­ã"
64031>>>>>>>>>                
64031>>>>>>>>>                Set Form_Width    item 3 to 80
64032>>>>>>>>>                Set Header_Label  item 3 to "’œ¢.†£/¤å˜ ˜¨˜©«."
64033>>>>>>>>>                
64033>>>>>>>>>                Set Form_Width    item 4 to 55
64034>>>>>>>>>                Set Header_Label  item 4 to "‰˜Ÿ˜¨ã ˜¥å˜"
64035>>>>>>>>>                
64035>>>>>>>>>                Set Form_Width    item 5 to 49
64036>>>>>>>>>                Set Header_Label  item 5 to "% ë¡§«à©ž"
64037>>>>>>>>>                
64037>>>>>>>>>                Set Form_Width    item 6 to 51
64038>>>>>>>>>                Set Header_Label  item 6 to "’œ¢ ¡ã « £ã"
64039>>>>>>>>>                
64039>>>>>>>>>
64039>>>>>>>>>                //AB-StoreStart
64039>>>>>>>>>                                                                                                                                                                                                                        
64039>>>>>>>>>                set child_table_state to true
64040>>>>>>>>>                Set Column_Option Item 0 to NoEnter True
64041>>>>>>>>>                Procedure End_Construct_Object
64043>>>>>>>>>                    Integer idecimals
64044>>>>>>>>>                    Forward Send End_Construct_Object
64046>>>>>>>>>                    Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    idecimals
64047>>>>>>>>>                    Set Points Item 4 to idecimals
64048>>>>>>>>>                    Set Points Item 6 to idecimals
64049>>>>>>>>>                    Set Numeric_Mask Item 4 to 14 idecimals ' ,*'
64050>>>>>>>>>                    Set Numeric_Mask Item 6 to 14 idecimals ' ,*'
64051>>>>>>>>>                End_Procedure
64052>>>>>>>>>                
64052>>>>>>>>>                
64052>>>>>>>>>                Function Child_entering returns Integer
64054>>>>>>>>>                    Integer rval iErr
64055>>>>>>>>>                    Forward Get Child_Entering to rVal
64057>>>>>>>>>                    If (NOT(rVal)) Begin
64059>>>>>>>>>                        If (Current_Record(Clients_DD(Self))) Forward Get Child_Entering to rVal
64063>>>>>>>>>                        Else Begin
64064>>>>>>>>>                            Function_Return 1
64065>>>>>>>>>                        End
64065>>>>>>>>>>
64065>>>>>>>>>                    End
64065>>>>>>>>>>
64065>>>>>>>>>                    function_return rVal
64066>>>>>>>>>                End_Function
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                
64067>>>>>>>>>                //AB-StoreEnd
64067>>>>>>>>>
64067>>>>>>>>>            End_Object    // clitem_
64068>>>>>>>>>
64068>>>>>>>>>        End_Object    // dbTabPageSub5
64069>>>>>>>>>
64069>>>>>>>>>
64069>>>>>>>>>        //AB-StoreStart
64069>>>>>>>>>                                                                                                                        
64069>>>>>>>>>        Function Tab_Change Integer Pagenumber Integer Focus_Mode Returns Integer
64071>>>>>>>>>            Integer Rval
64072>>>>>>>>>            String  sclient smodule
64072>>>>>>>>>            If (PageNumber=4) Begin
64074>>>>>>>>>                If (psmodule(self)<>'01') Move 0 to PageNumber
64077>>>>>>>>>            End
64077>>>>>>>>>>
64077>>>>>>>>>            Forward Get Tab_Change Pagenumber Focus_Mode To Rval
64079>>>>>>>>>            Function_Return Rval
64080>>>>>>>>>        End_Function
64081>>>>>>>>>        
64081>>>>>>>>>        
64081>>>>>>>>>        //AB-StoreEnd
64081>>>>>>>>>
64081>>>>>>>>>    End_Object    // dbTabDialogSub2
64082>>>>>>>>>
64082>>>>>>>>>    Object TextBoxSub49 is a TextBoxSub
64084>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
64085>>>>>>>>>        Set Location to 23 396
64086>>>>>>>>>        Set Size to 10 32
64087>>>>>>>>>        Set TypeFace to "MS Sans Serif"
64088>>>>>>>>>    End_Object    // TextBoxSub49
64089>>>>>>>>>
64089>>>>>>>>>    Object TextBoxSub56 is a TextBoxSub
64091>>>>>>>>>        Set Label to "œ¨ ¦®ã"
64092>>>>>>>>>        Set Location to 37 245
64093>>>>>>>>>        Set Size to 10 31
64094>>>>>>>>>        Set TypeFace to "MS Sans Serif"
64095>>>>>>>>>    End_Object    // TextBoxSub56
64096>>>>>>>>>
64096>>>>>>>>>    Object TextBoxSub57 is a TextBoxSub
64098>>>>>>>>>        Set Label to "Œ¦£æª"
64099>>>>>>>>>        Set Location to 51 245
64100>>>>>>>>>        Set Size to 10 23
64101>>>>>>>>>        Set TypeFace to "MS Sans Serif"
64102>>>>>>>>>    End_Object    // TextBoxSub57
64103>>>>>>>>>
64103>>>>>>>>>    Object TextBoxSub58 is a TextBoxSub
64105>>>>>>>>>        Set Label to "•é¨˜"
64106>>>>>>>>>        Set Location to 66 4
64107>>>>>>>>>        Set Size to 10 21
64108>>>>>>>>>        Set TypeFace to "MS Sans Serif"
64109>>>>>>>>>    End_Object    // TextBoxSub58
64110>>>>>>>>>
64110>>>>>>>>>    Object ButtonSub2 is a ButtonSub
64112>>>>>>>>>        Set Label to "ButtonSub2"
64113>>>>>>>>>        Set Bitmap to "aggel.bmp"
64114>>>>>>>>>        Set Size to 20 23
64115>>>>>>>>>        Set Location to 72 422
64116>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64117>>>>>>>>>
64117>>>>>>>>>        //AB-StoreStart
64117>>>>>>>>>        Set TooltipValue to "€¤« š¨˜­ã œ¢á«ž ©œ ¬§œçŸ¬¤¦ ¢ž¨à£é¤"
64118>>>>>>>>>        Procedure OnClick
64120>>>>>>>>>            string sname safm sdoy saddress sjob srespons szipcode sphone sfax smobile
64121>>>>>>>>>            string saoh semail sidiot saddno sprespid srecr
64121>>>>>>>>>            integer retval iVal irecnum
64121>>>>>>>>>            number  ncity narea
64121>>>>>>>>>            get yesno_box "‡â¢œ«œ §¨˜š£˜« ¡á ¤˜ šå¤œ  ˜¤« š¨˜­ã «¦¬ §œ¢á«ž ©œ ¬§œçŸ¬¤¦ §¢ž¨à£ãª ??" to retval
64122>>>>>>>>>            get value of (clients_client_name(self)) to sname
64123>>>>>>>>>        
64123>>>>>>>>>            If (RetVal =MBR_yes and sname ne '') begin
64125>>>>>>>>>               get field_current_value of clients_dd field clients.recnum          to irecnum
64126>>>>>>>>>               get field_current_value of clients_dd field clients.client_name     to sname
64127>>>>>>>>>               get field_current_value of clients_dd field clients.client_afm      to safm
64128>>>>>>>>>               get field_current_value of clients_dd field clients.client_doy      to sdoy
64129>>>>>>>>>               get field_current_value of clients_dd field clients.client_address  to saddress
64130>>>>>>>>>               get field_current_value of cities_dd  field cities.city_id          to ncity
64131>>>>>>>>>               get field_current_value of areas_dd   field areas.area_id           to narea
64132>>>>>>>>>               get field_current_value of clients_dd field clients.client_job      to sjob
64133>>>>>>>>>               get field_current_value of clients_dd field clients.client_respons  to srespons
64134>>>>>>>>>               get field_current_value of clients_dd field clients.client_zipcode  to szipcode
64135>>>>>>>>>               get field_current_value of clients_dd field clients.client_phone    to sphone
64136>>>>>>>>>               get field_current_value of clients_dd field clients.client_fax      to sfax
64137>>>>>>>>>               get field_current_value of clients_dd field clients.client_mobile   to smobile
64138>>>>>>>>>               get field_current_value of clients_dd field clients.client_aoh      to saoh
64139>>>>>>>>>               get field_current_value of clients_dd field clients.client_email    to semail
64140>>>>>>>>>               get field_current_value of clients_dd field clients.client_idiot    to sidiot
64141>>>>>>>>>               get field_current_value of clients_dd field clients.client_add_no   to saddno
64142>>>>>>>>>               send clear to payresp_dd2
64143>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_name     to sname
64144>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_afm      to safm
64145>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_doy      to sdoy
64146>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_address  to saddress
64147>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_city_id  to ncity
64148>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_area     to narea
64149>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_job      to sjob
64150>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_respons  to srespons
64151>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_zipcode  to szipcode
64152>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_phone    to sphone
64153>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_fax      to sfax
64154>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_mobile   to smobile
64155>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_aoh      to saoh
64156>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_email    to semail
64157>>>>>>>>>               set field_changed_value of payresp_dd2 field payresp.presp_add_no   to saddno
64158>>>>>>>>>               move ncity to iVal
64159>>>>>>>>>               Move (fiTownIDFromCity(iVal)) to ival
64160>>>>>>>>>               Set Field_Changed_Value Of payresp_DD2 Field payresp.presp_Nomos to iVal
64161>>>>>>>>>               Move (fiCountryIDFromTown(iVal)) to ival
64162>>>>>>>>>               Set Field_Changed_Value Of payresp_DD2 Field payresp.presp_Xora to iVal
64163>>>>>>>>>               send request_save to payresp_dd2
64164>>>>>>>>>               get field_current_value of payresp_dd2 field payresp.presp_recr to srecr
64165>>>>>>>>>               move srecr to payresp.presp_recr
64166>>>>>>>>>               send find to payresp_dd eq 2
64167>>>>>>>>>            end
64167>>>>>>>>>>
64167>>>>>>>>>            else begin
64168>>>>>>>>>               send stop_box '€¤« š¨˜­ã ®à¨åª œ§à¤¬£å˜ §œ¢á«ž ˜›ç¤˜«ž !!' '‘­á¢£˜'
64169>>>>>>>>>            end
64169>>>>>>>>>>
64169>>>>>>>>>        End_Procedure // OnClick
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        
64170>>>>>>>>>        //AB-StoreEnd
64170>>>>>>>>>
64170>>>>>>>>>    End_Object    // ButtonSub2
64171>>>>>>>>>
64171>>>>>>>>>    Object BTN_ERGA is a ButtonSub
64173>>>>>>>>>        Set Label to "ButtonSub3"
64174>>>>>>>>>        Set Bitmap to "notes8.bmp"
64175>>>>>>>>>        Set Size to 20 23
64176>>>>>>>>>        Set Location to 72 461
64177>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64178>>>>>>>>>
64178>>>>>>>>>        //AB-StoreStart
64178>>>>>>>>>        Set TooltipValue to "ƒž£ ¦¬¨šå˜ '„¨š¦¬ £œ «˜ ©«¦ ®œå˜ œ¢á«ž"
64179>>>>>>>>>        
64179>>>>>>>>>        Procedure OnClick
64181>>>>>>>>>            string sname safm sdoy saddress sjob srespons szipcode sphone sfax smobile
64182>>>>>>>>>            string saoh semail sidiot saddno msgstr sid srecr scnid sclname
64182>>>>>>>>>            integer retval iVal irecnum
64182>>>>>>>>>            number  ncity narea
64182>>>>>>>>>            get yesno_box "‡â¢œ«œ §¨˜š£˜« ¡á ¤˜ §¨¦®à¨ã©à ©«ž¤ ›ž£ ¦¬¨šå˜ â¨š¦¬ £œ ©«¦ ®œå˜ œ¢á«ž ??" to retval
64183>>>>>>>>>            get field_current_value of clients_dd field clients.client_id to sid
64184>>>>>>>>>        
64184>>>>>>>>>            If (RetVal =MBR_yes and sid ne '') begin
64186>>>>>>>>>        
64186>>>>>>>>>                get field_current_value of clients_dd field clients.client_recr     to srecr
64187>>>>>>>>>                get field_current_value of clients_dd field clients.client_address  to saddress
64188>>>>>>>>>                get field_current_value of clients_dd field clients.client_city_id  to ncity
64189>>>>>>>>>                get field_current_value of clients_dd field clients.client_area     to narea
64190>>>>>>>>>                get field_current_value of clients_dd field clients.client_respons  to srespons
64191>>>>>>>>>                get field_current_value of clients_dd field clients.client_zipcode  to szipcode
64192>>>>>>>>>                get field_current_value of clients_dd field clients.client_phone    to sphone
64193>>>>>>>>>                get field_current_value of clients_dd field clients.client_add_no   to saddno
64194>>>>>>>>>                get field_current_value of clients_dd field clients.client_name     to sclname
64195>>>>>>>>>        
64195>>>>>>>>>                clear cn
64196>>>>>>>>>                move syscurxr.company_code to cn.company_code
64197>>>>>>>>>                move syscurxr.branch_code  to cn.branch_code
64198>>>>>>>>>                move syscurxr.year_year    to cn.year_year
64199>>>>>>>>>                move srecr                 to cn.client_recr
64200>>>>>>>>>                move sid                   to cn.client_id
64201>>>>>>>>>                move '' to sname
64202>>>>>>>>>                append sname (trim(sclname)) ' (' (trim(saddress)) ')'
64206>>>>>>>>>                move (trim(sname))         to cn.cn_descr
64207>>>>>>>>>                move saddress              to cn.cn_address
64208>>>>>>>>>                move ncity                 to cn.cn_city
64209>>>>>>>>>                move narea                 to cn.cn_area
64210>>>>>>>>>                move srespons              to Cn.Cn_responsible
64211>>>>>>>>>                move szipcode              to cn.cn_zipcode
64212>>>>>>>>>                move sphone                to cn.cn_phone
64213>>>>>>>>>                move saddno                to cn.cn_add_no
64214>>>>>>>>>                move ncity to iVal
64215>>>>>>>>>                Move (fiTownIDFromCity(iVal)) to ival
64216>>>>>>>>>                move ival                  to cn.cn_nomos
64217>>>>>>>>>                Move (fiCountryIDFromTown(iVal)) to ival
64218>>>>>>>>>                move ival to cn.cn_xora
64219>>>>>>>>>                move 'A' to cn.cn_active
64220>>>>>>>>>                reread sysrecc
64224>>>>>>>>>                move (sysrecc.cn_rec0+1) to sysrecc.cn_rec0
64225>>>>>>>>>                saverecord sysrecc
64226>>>>>>>>>                unlock
64227>>>>>>>>>>
64227>>>>>>>>>                move sysrecc.cn_rec0 to cn.cn_rec0
64228>>>>>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                  (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
64229>>>>>>>>>                Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
64230>>>>>>>>>                move cn.cn_code to scnid
64231>>>>>>>>>        
64231>>>>>>>>>                saverecord cn
64232>>>>>>>>>        
64232>>>>>>>>>                // Prosthikh gia to auditing js 14/12/2007
64232>>>>>>>>>                //---------------------------------------------
64232>>>>>>>>>                // Auditing / Katagrafh allagon
64232>>>>>>>>>                String  sUser sText sTime sMin sHour sSec
64232>>>>>>>>>                Date    dDate  Shmer
64232>>>>>>>>>                Integer iMin iHour iSec iLen
64232>>>>>>>>>                Sysdate dDate iHour iMin iSec
64236>>>>>>>>>                Move iHour  to sHour
64237>>>>>>>>>                Move iMin   to sMin
64238>>>>>>>>>                Move iSec   to sSec
64239>>>>>>>>>                If (Length(sHour)=1) Insert "0" in sHour at 1
64243>>>>>>>>>                If (Length(sMin )=1) Insert "0" in sMin  at 1
64247>>>>>>>>>                If (Length(sSec )=1) Insert "0" in sSec  at 1
64251>>>>>>>>>                Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
64252>>>>>>>>>        
64252>>>>>>>>>                // Auditing / Dhmiourgia
64252>>>>>>>>>                If (Sysfile.Use_Audit=1) Begin
64254>>>>>>>>>                    Get fsLoginUserID to sUser
64255>>>>>>>>>                    clear gmove
64256>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
64257>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
64258>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
64259>>>>>>>>>                    move  4                     to gmove.gtypkin_code
64260>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
64261>>>>>>>>>                    move suser                  to gmove.gplan_code
64262>>>>>>>>>                    move CN.CN_Recr             to gmove.garticl_recr
64263>>>>>>>>>                    reread sysrecg
64267>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
64268>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
64269>>>>>>>>>                    saverecord sysrecg
64270>>>>>>>>>                    unlock
64271>>>>>>>>>>
64271>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
64272>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
64273>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs
64274>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
64275>>>>>>>>>        
64275>>>>>>>>>                    Move CN.CN_Recr                 to Gmove.Partl_Recr
64276>>>>>>>>>                    Move CN.CN_Recr                 to Gmove.Pms_Recr
64277>>>>>>>>>        
64277>>>>>>>>>                    Move CN.CN_Code                 to Gmove.Cur_CN
64278>>>>>>>>>                    Move CN.CN_Address              to Gmove.Cur_CN_Addr
64279>>>>>>>>>                    Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
64280>>>>>>>>>                    Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
64281>>>>>>>>>                    Move "N" to Gmove.Eidos_Metabolhs
64282>>>>>>>>>                    saverecord gmove
64283>>>>>>>>>                End
64283>>>>>>>>>>
64283>>>>>>>>>                // Prosthikh gia to auditing js 14/12/2007
64283>>>>>>>>>                send request_cancel to (vwclients(self))
64284>>>>>>>>>                set pscncode of (v041(self)) to scnid
64285>>>>>>>>>                send activate_v041
64286>>>>>>>>>            end
64286>>>>>>>>>>
64286>>>>>>>>>            else begin
64287>>>>>>>>>                send stop_box '€¤« š¨˜­ã ®à¨åª §œ¢á«ž ˜›ç¤˜«ž !!' '‘­á¢£˜'
64288>>>>>>>>>            end
64288>>>>>>>>>>
64288>>>>>>>>>        End_Procedure // OnClick
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        
64289>>>>>>>>>        //AB-StoreEnd
64289>>>>>>>>>
64289>>>>>>>>>    End_Object    // BTN_ERGA
64290>>>>>>>>>
64290>>>>>>>>>    Object ButtonSub3 is a ButtonSub
64292>>>>>>>>>        Set Label to "ButtonSub6"
64293>>>>>>>>>        Set Bitmap to "tvwbo16.bmp"
64294>>>>>>>>>        Set Size to 10 11
64295>>>>>>>>>        Set Location to 38 485
64296>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64297>>>>>>>>>
64297>>>>>>>>>        //AB-StoreStart
64297>>>>>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª œ¨ ¦®é¤"
64298>>>>>>>>>        Procedure OnClick
64300>>>>>>>>>           send activate_v197
64301>>>>>>>>>        End_Procedure // OnClick
64302>>>>>>>>>        
64302>>>>>>>>>        
64302>>>>>>>>>        //AB-StoreEnd
64302>>>>>>>>>
64302>>>>>>>>>    End_Object    // ButtonSub3
64303>>>>>>>>>
64303>>>>>>>>>    Object ButtonSub4 is a ButtonSub
64305>>>>>>>>>        Set Label to "ButtonSub6"
64306>>>>>>>>>        Set Bitmap to "tvwbo16.bmp"
64307>>>>>>>>>        Set Size to 10 11
64308>>>>>>>>>        Set Location to 50 230
64309>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64310>>>>>>>>>
64310>>>>>>>>>        //AB-StoreStart
64310>>>>>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª æ¢œà¤"
64311>>>>>>>>>        Procedure OnClick
64313>>>>>>>>>           send activate_v198
64314>>>>>>>>>        End_Procedure // OnClick
64315>>>>>>>>>        
64315>>>>>>>>>        
64315>>>>>>>>>        
64315>>>>>>>>>        //AB-StoreEnd
64315>>>>>>>>>
64315>>>>>>>>>    End_Object    // ButtonSub4
64316>>>>>>>>>
64316>>>>>>>>>    Object ButtonSub5 is a ButtonSub
64318>>>>>>>>>        Set Label to "ButtonSub6"
64319>>>>>>>>>        Set Bitmap to "tvwbo16.bmp"
64320>>>>>>>>>        Set Size to 10 11
64321>>>>>>>>>        Set Location to 79 328
64322>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64323>>>>>>>>>
64323>>>>>>>>>        //AB-StoreStart
64323>>>>>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª “§œçŸ¬¤à¤ §¢ž¨à£é¤"
64324>>>>>>>>>        Procedure OnClick
64326>>>>>>>>>           send activate_v111
64327>>>>>>>>>        End_Procedure // OnClick
64328>>>>>>>>>        
64328>>>>>>>>>        
64328>>>>>>>>>        
64328>>>>>>>>>        
64328>>>>>>>>>        //AB-StoreEnd
64328>>>>>>>>>
64328>>>>>>>>>    End_Object    // ButtonSub5
64329>>>>>>>>>
64329>>>>>>>>>    Object Towns_Town_Descr is a dbFormSub
64331>>>>>>>>>        Entry_Item Towns.Town_descr
64332>>>>>>>>>        Set Size to 13 147
64333>>>>>>>>>        Set Location to 50 334
64334>>>>>>>>>        Set Color to clBtnFace
64335>>>>>>>>>        Set Label_Col_Offset to 2
64336>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
64337>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOff
64338>>>>>>>>>        Set Enabled_State to FALSE
64339>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64340>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
64341>>>>>>>>>        Set Shadow_State Item 0 to TRUE
64342>>>>>>>>>    End_Object    // Towns_Town_Descr
64343>>>>>>>>>
64343>>>>>>>>>    Object Cities_City_Descr is a dbFormSub
64345>>>>>>>>>        Entry_Item Cities.City_descr
64346>>>>>>>>>        Set Size to 12 101
64347>>>>>>>>>        Set Location to 49 129
64348>>>>>>>>>        Set Color to clBtnFace
64349>>>>>>>>>        Set Label_Col_Offset to 2
64350>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
64351>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOff
64352>>>>>>>>>        Set Enabled_State to FALSE
64353>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64354>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
64355>>>>>>>>>        Set Shadow_State Item 0 to TRUE
64356>>>>>>>>>    End_Object    // Cities_City_Descr
64357>>>>>>>>>
64357>>>>>>>>>    Object Country_Country_Descr is a dbFormSub
64359>>>>>>>>>        Entry_Item Country.Country_descr
64360>>>>>>>>>        Set Size to 13 101
64361>>>>>>>>>        Set Location to 64 129
64362>>>>>>>>>        Set Color to clBtnFace
64363>>>>>>>>>        Set Label_Col_Offset to 2
64364>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
64365>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOff
64366>>>>>>>>>        Set Enabled_State to FALSE
64367>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
64368>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
64369>>>>>>>>>        Set Shadow_State Item 0 to TRUE
64370>>>>>>>>>    End_Object    // Country_Country_Descr
64371>>>>>>>>>
64371>>>>>>>>>    Object Textbox5 is a Textbox
64373>>>>>>>>>        Set Label to "“§œçŸ. ¢ž¨à£é¤ "
64374>>>>>>>>>        Set Location to 79 3
64375>>>>>>>>>        Set Size to 10 61
64376>>>>>>>>>        Set TypeFace to "MS Sans Serif"
64377>>>>>>>>>    End_Object    // Textbox5
64378>>>>>>>>>
64378>>>>>>>>>
64378>>>>>>>>>    //AB-StoreStart
64378>>>>>>>>>    set verify_data_loss_msg    to get_no_confirmation
64379>>>>>>>>>    set verify_exit_msg         to get_no_confirmation
64380>>>>>>>>>    
64380>>>>>>>>>    Procedure Activate_View Returns Integer
64382>>>>>>>>>        String  sModule sIsClient sIsPromhtheyths sid
64383>>>>>>>>>        Integer rVal iCurRec
64383>>>>>>>>>    
64383>>>>>>>>>    //    Get psMenuModule  Of Main_Menu  to sModule
64383>>>>>>>>>        Set psModule to sModule
64384>>>>>>>>>        if (smodule = "01") begin
64386>>>>>>>>>          Set Label Of VWCLIENTS to "€¨®œå¦ œ¢˜«é¤"
64387>>>>>>>>>          set visible_state of (dbtabpagesub5(dbtabdialogsub2(self))) to true
64388>>>>>>>>>          set label of (dbtabpagesub5(dbtabdialogsub2(self))) to '’ £¦¡˜«á¢¦š¦ª œ¢á«ž'
64389>>>>>>>>>        end
64389>>>>>>>>>>
64389>>>>>>>>>        if (smodule = "02") begin
64391>>>>>>>>>          Set Label Of VWCLIENTS to "€¨®œå¦ ¨¦£žŸœ¬«é¤"
64392>>>>>>>>>          set visible_state of (dbtabpagesub5(dbtabdialogsub2(self))) to false
64393>>>>>>>>>          set label of (dbtabpagesub5(dbtabdialogsub2(self))) to '’ £¦¡˜«á¢¦š¦ª'
64394>>>>>>>>>        end
64394>>>>>>>>>>
64394>>>>>>>>>    
64394>>>>>>>>>        Forward Get Msg_Activate_View to rVal
64396>>>>>>>>>        Reread Sysfile
64400>>>>>>>>>        Unlock
64401>>>>>>>>>>
64401>>>>>>>>>    
64401>>>>>>>>>        get psclient to sid
64402>>>>>>>>>        if (sid<>'') begin
64404>>>>>>>>>          send clear to clients_dd
64405>>>>>>>>>          move sid to clients.client_id
64406>>>>>>>>>          send find to clients_dd eq 6
64407>>>>>>>>>        end
64407>>>>>>>>>>
64407>>>>>>>>>        Send Rebuild_Constraints to Clients_DD
64408>>>>>>>>>        Procedure_Return rVal
64409>>>>>>>>>    End_Procedure
64410>>>>>>>>>    
64410>>>>>>>>>    procedure request_cancel
64412>>>>>>>>>        Forward send request_cancel
64414>>>>>>>>>        Set psclient to ''
64415>>>>>>>>>    end_procedure
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    
64416>>>>>>>>>    //AB-StoreEnd
64416>>>>>>>>>
64416>>>>>>>>>End_Object    // VWCLIENTS
64417>>>>>>>>>
64417>>>>>>>>>
64417>>>>>>>>>//AB-StoreStart
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>                        
64417>>>>>>>>>//AB-StoreEnd
64417>>>>>>>>>
64417>>>>>>>>>//AB/ End_Object    // prj
64417>>>>>>>use v041.vw
64417>>>>>>>use v111.vw
64417>>>>>>>use sl100.sl
64417>>>>>>>use sl041.sl
64417>>>>>>>use v193v.vw
INCLUDING FILE: V193V.VW
64417>>>>>>>>>//AB/ Project V193v:verify DEOP pelaton-ergon
64417>>>>>>>>>//AB/ Object prj is a View_Project
64417>>>>>>>>>//AB/     Set ProjectName to "V193v:verify DEOP pelaton-ergon"
64417>>>>>>>>>//AB/     Set ProjectFileName to "V193v.VW"
64417>>>>>>>>>//AB/     Set GenerateFileName to "V193.vw"
64417>>>>>>>>>
64417>>>>>>>>>// Project Object Structure
64417>>>>>>>>>//   V193v is a dbViewSub
64417>>>>>>>>>//     Baxiokat_DD is a DataDictionary
64417>>>>>>>>>//     Country_DD is a DataDictionary
64417>>>>>>>>>//     Towns_DD is a DataDictionary
64417>>>>>>>>>//     Cities_DD is a DataDictionary
64417>>>>>>>>>//     Areas_DD is a DataDictionary
64417>>>>>>>>>//     Payresp_DD is a DataDictionary
64417>>>>>>>>>//     Clients_DD is a DataDictionary
64417>>>>>>>>>//     Constrct_DD is a DataDictionary
64417>>>>>>>>>//     Salesmen_DD is a DataDictionary
64417>>>>>>>>>//     Mhxanik_DD is a DataDictionary
64417>>>>>>>>>//     Cn_DD is a DataDictionary
64417>>>>>>>>>//     Tperga_DD is a DataDictionary
64417>>>>>>>>>//     Btnordh_DD is a DataDictionary
64417>>>>>>>>>//     Btnordd_DD is a DataDictionary
64417>>>>>>>>>//     Container1 is a dbContainer3d
64417>>>>>>>>>//       TextBoxSub5 is a TextBoxSub
64417>>>>>>>>>//       TextBoxSub6 is a TextBoxSub
64417>>>>>>>>>//       Btnordh_Client_Id is a dbFormSub
64417>>>>>>>>>//       Btnordh_Cn_Code is a dbFormSub
64417>>>>>>>>>//       TextBoxSub9 is a TextBoxSub
64417>>>>>>>>>//       Btnordh_Aa_Deop is a dbFormSub
64417>>>>>>>>>//       Btnordh_Deop_Date is a dbFormSub
64417>>>>>>>>>//       Btnordh_Deop_Lhxh is a dbFormSub
64417>>>>>>>>>//       Btnordh_Eleiph is a dbFormSub
64417>>>>>>>>>//       Btnordh_Velxr is a dbComboFormSub
64417>>>>>>>>>//       Btnordh_Deop_Active is a dbCheckBoxSub
64417>>>>>>>>>//       Clients_Client_Name is a dbFormSub
64417>>>>>>>>>//       Cn_Cn_Descr is a dbFormSub
64417>>>>>>>>>//       Btnordh_Locked is a dbCheckBoxSub
64417>>>>>>>>>//       TextBoxSub10 is a TextBoxSub
64417>>>>>>>>>//       Btnordh_Sxolia is a dbEditSub
64417>>>>>>>>>//       TextBoxSub11 is a TextBoxSub
64417>>>>>>>>>//       Payresp_Presp_Id is a dbFormSub
64417>>>>>>>>>//       Payresp_Presp_Name is a dbFormSub
64417>>>>>>>>>//       TextBoxSub12 is a TextBoxSub
64417>>>>>>>>>//       ButtonSub2 is a ButtonSub
64417>>>>>>>>>//       TextBoxSub13 is a TextBoxSub
64417>>>>>>>>>//       ButtonSub3 is a ButtonSub
64417>>>>>>>>>//       Btnactive is a ButtonSub
64417>>>>>>>>>//       TextBoxSub14 is a TextBoxSub
64417>>>>>>>>>//       Btncopy is a ButtonSub
64417>>>>>>>>>//       TextBoxSub15 is a TextBoxSub
64417>>>>>>>>>//       Textbox1 is a Textbox
64417>>>>>>>>>//       Textbox2 is a Textbox
64417>>>>>>>>>//       Btnordh_Statero is a dbCheckBoxSub
64417>>>>>>>>>//       ButtonSub4 is a ButtonSub
64417>>>>>>>>>//       ButtonSub5 is a ButtonSub
64417>>>>>>>>>//       Btnektyp is a ButtonSub
64417>>>>>>>>>//       ButtonSub6 is a ButtonSub
64417>>>>>>>>>//     The_Table is a dbGrid
64417>>>>>>>>>//     TextBoxSub7 is a TextBoxSub
64417>>>>>>>>>//     TextBoxSub8 is a TextBoxSub
64417>>>>>>>>>//     item_descr is a FormSub
64417>>>>>>>>>//     TextBoxSub17 is a TextBoxSub
64417>>>>>>>>>//     Btnordh_Date_Create is a dbFormSub
64417>>>>>>>>>//     Tperga_ is a dbGridSub
64417>>>>>>>>>//     TextBoxSub18 is a TextBoxSub
64417>>>>>>>>>//     TextBoxSub19 is a TextBoxSub
64417>>>>>>>>>//     Clients_Hpso is a dbFormSub
64417>>>>>>>>>//     TextBoxSub20 is a TextBoxSub
64417>>>>>>>>>//     Clients_Hpal is a dbFormSub
64417>>>>>>>>>
64417>>>>>>>>>// Register all objects
64417>>>>>>>>>Register_Object Areas_DD
64417>>>>>>>>>Register_Object Baxiokat_DD
64417>>>>>>>>>Register_Object Btnactive
64417>>>>>>>>>Register_Object Btncopy
64417>>>>>>>>>Register_Object Btnektyp
64417>>>>>>>>>Register_Object Btnordd_DD
64417>>>>>>>>>Register_Object Btnordh_Aa_Deop
64417>>>>>>>>>Register_Object Btnordh_Client_Id
64417>>>>>>>>>Register_Object Btnordh_Cn_Code
64417>>>>>>>>>Register_Object Btnordh_Date_Create
64417>>>>>>>>>Register_Object Btnordh_DD
64417>>>>>>>>>Register_Object Btnordh_Deop_Active
64417>>>>>>>>>Register_Object Btnordh_Deop_Date
64417>>>>>>>>>Register_Object Btnordh_Deop_Lhxh
64417>>>>>>>>>Register_Object Btnordh_Eleiph
64417>>>>>>>>>Register_Object Btnordh_Locked
64417>>>>>>>>>Register_Object Btnordh_Statero
64417>>>>>>>>>Register_Object Btnordh_Sxolia
64417>>>>>>>>>Register_Object Btnordh_Velxr
64417>>>>>>>>>Register_Object ButtonSub2
64417>>>>>>>>>Register_Object ButtonSub3
64417>>>>>>>>>Register_Object ButtonSub4
64417>>>>>>>>>Register_Object ButtonSub5
64417>>>>>>>>>Register_Object ButtonSub6
64417>>>>>>>>>Register_Object Cities_DD
64417>>>>>>>>>Register_Object Clients_Client_Name
64417>>>>>>>>>Register_Object Clients_DD
64417>>>>>>>>>Register_Object Clients_Hpal
64417>>>>>>>>>Register_Object Clients_Hpso
64417>>>>>>>>>Register_Object Cn_Cn_Descr
64417>>>>>>>>>Register_Object Cn_DD
64417>>>>>>>>>Register_Object Constrct_DD
64417>>>>>>>>>Register_Object Container1
64417>>>>>>>>>Register_Object Country_DD
64417>>>>>>>>>Register_Object item_descr
64417>>>>>>>>>Register_Object Mhxanik_DD
64417>>>>>>>>>Register_Object Payresp_DD
64417>>>>>>>>>Register_Object Payresp_Presp_Id
64417>>>>>>>>>Register_Object Payresp_Presp_Name
64417>>>>>>>>>Register_Object Salesmen_DD
64417>>>>>>>>>Register_Object TextBoxSub10
64417>>>>>>>>>Register_Object TextBoxSub11
64417>>>>>>>>>Register_Object TextBoxSub12
64417>>>>>>>>>Register_Object TextBoxSub13
64417>>>>>>>>>Register_Object TextBoxSub14
64417>>>>>>>>>Register_Object TextBoxSub15
64417>>>>>>>>>Register_Object TextBoxSub17
64417>>>>>>>>>Register_Object TextBoxSub18
64417>>>>>>>>>Register_Object TextBoxSub19
64417>>>>>>>>>Register_Object TextBoxSub20
64417>>>>>>>>>Register_Object TextBoxSub5
64417>>>>>>>>>Register_Object TextBoxSub6
64417>>>>>>>>>Register_Object TextBoxSub7
64417>>>>>>>>>Register_Object TextBoxSub8
64417>>>>>>>>>Register_Object TextBoxSub9
64417>>>>>>>>>Register_Object Textbox1
64417>>>>>>>>>Register_Object Textbox2
64417>>>>>>>>>Register_Object The_Table
64417>>>>>>>>>Register_Object Towns_DD
64417>>>>>>>>>Register_Object Tperga_
64417>>>>>>>>>Register_Object Tperga_DD
64417>>>>>>>>>Register_Object V193v
64417>>>>>>>>>
64417>>>>>>>>>
64417>>>>>>>>>//AB/ AppBuild VIEW
64417>>>>>>>>>
64417>>>>>>>>>
64417>>>>>>>>>//AB-StoreTopStart
64417>>>>>>>>>use btnordh.sl
64417>>>>>>>>>open iteml
64419>>>>>>>>>open BtnordhL
64421>>>>>>>>>open BtnorddL
64423>>>>>>>>>use v193a.vw
64423>>>>>>>>>use r193_1.rv
64423>>>>>>>>>use doCOPY.pkg
64423>>>>>>>>>use vwclients.vw
64423>>>>>>>>>use v041.vw
64423>>>>>>>>>use v111.vw
64423>>>>>>>>>use sl100.sl
64423>>>>>>>>>use sl041.sl
64423>>>>>>>>>
64423>>>>>>>>>//AB-StoreTopEnd
64423>>>>>>>>>
64423>>>>>>>>>//AB-IgnoreStart
64423>>>>>>>>>
64423>>>>>>>>>Use dbView.Sub
64423>>>>>>>>>Use DFAllEnt.pkg
64423>>>>>>>>>Use Txtbox.Sub
64423>>>>>>>>>Use dbForm.Sub
64423>>>>>>>>>Use dbCmbfrm.Sub
64423>>>>>>>>>Use dbChkbox.Sub
64423>>>>>>>>>Use dbEdit.Sub
64423>>>>>>>>>Use Button.Sub
64423>>>>>>>>>Use Form.Sub
64423>>>>>>>>>Use dbGrid.Sub
64423>>>>>>>>>
64423>>>>>>>>>Use BAXIOKAT.DD
64423>>>>>>>>>Use COUNTRY.DD
64423>>>>>>>>>Use TOWNS.DD
64423>>>>>>>>>Use CITIES.DD
64423>>>>>>>>>Use AREAS.DD
64423>>>>>>>>>Use PAYRESP.DD
64423>>>>>>>>>Use CLIENTS.DD
64423>>>>>>>>>Use CONSTRCT.DD
64423>>>>>>>>>Use SALESMEN.DD
64423>>>>>>>>>Use MHXANIK.DD
64423>>>>>>>>>Use CN.DD
64423>>>>>>>>>Use TPERGA.DD
64423>>>>>>>>>Use BTNORDH.DD
64423>>>>>>>>>Use BTNORDD.DD
64423>>>>>>>>>
64423>>>>>>>>>//AB-IgnoreEnd
64423>>>>>>>>>
64423>>>>>>>>>ACTIVATE_VIEW Activate_V193v FOR V193v
64427>>>>>>>>>
64427>>>>>>>>>Object V193v is a dbViewSub
64429>>>>>>>>>
64429>>>>>>>>>    //AB-StoreTopStart
64429>>>>>>>>>    Property string     PSCLIENT    public ''
64431>>>>>>>>>    property string     psCnCode    public ''
64433>>>>>>>>>    property integer    piepil      public 0
64435>>>>>>>>>    property integer    pibtn       public 0
64437>>>>>>>>>    Property String     psModule    public ''
64439>>>>>>>>>    property integer    pirecnum    public 0
64441>>>>>>>>>    property date       pddate      public ''
64443>>>>>>>>>    property string     psdeop      public ''
64445>>>>>>>>>    
64445>>>>>>>>>    function fsqual string code returns string
64447>>>>>>>>>         string squal
64448>>>>>>>>>         clear iteml
64449>>>>>>>>>         move code to iteml.item_code
64450>>>>>>>>>         find eq iteml by index.5
64451>>>>>>>>>>
64451>>>>>>>>>         move iteml.item_qual to squal
64452>>>>>>>>>         function_return squal
64453>>>>>>>>>    end_Function
64454>>>>>>>>>    
64454>>>>>>>>>    //Object btnordd_DD2 is a btnordd_DataDictionary
64454>>>>>>>>>    //End_Object    // btnordd_DD2
64454>>>>>>>>>    
64454>>>>>>>>>    //AB-StoreTopEnd
64454>>>>>>>>>
64454>>>>>>>>>    Set Label to "ƒ ˜š¨˜­ã €¤œ¤œ¨šé¤ ƒ.„.Ž."
64455>>>>>>>>>    Set Size to 285 529
64456>>>>>>>>>    Set Location to 1 1
64457>>>>>>>>>
64457>>>>>>>>>    //AB-DDOStart
64457>>>>>>>>>
64457>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
64459>>>>>>>>>    End_Object    // Baxiokat_DD
64460>>>>>>>>>
64460>>>>>>>>>    Object Country_DD is a Country_DataDictionary
64462>>>>>>>>>    End_Object    // Country_DD
64463>>>>>>>>>
64463>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
64465>>>>>>>>>        Set DDO_Server to (Country_DD(self))
64466>>>>>>>>>    End_Object    // Towns_DD
64467>>>>>>>>>
64467>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
64469>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
64470>>>>>>>>>    End_Object    // Cities_DD
64471>>>>>>>>>
64471>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
64473>>>>>>>>>    End_Object    // Areas_DD
64474>>>>>>>>>
64474>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
64476>>>>>>>>>
64476>>>>>>>>>        //AB-StoreStart
64476>>>>>>>>>                                                                                                                
64476>>>>>>>>>        Set piCheckPlaf to 0
64477>>>>>>>>>        
64477>>>>>>>>>        //AB-StoreEnd
64477>>>>>>>>>
64477>>>>>>>>>    End_Object    // Payresp_DD
64478>>>>>>>>>
64478>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
64480>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
64481>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
64482>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
64483>>>>>>>>>
64483>>>>>>>>>        //AB-StoreStart
64483>>>>>>>>>                                                                                                                
64483>>>>>>>>>        Set piCheckPlaf to 0
64484>>>>>>>>>        
64484>>>>>>>>>        //AB-StoreEnd
64484>>>>>>>>>
64484>>>>>>>>>    End_Object    // Clients_DD
64485>>>>>>>>>
64485>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
64487>>>>>>>>>    End_Object    // Constrct_DD
64488>>>>>>>>>
64488>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
64490>>>>>>>>>    End_Object    // Salesmen_DD
64491>>>>>>>>>
64491>>>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
64493>>>>>>>>>    End_Object    // Mhxanik_DD
64494>>>>>>>>>
64494>>>>>>>>>    Object Cn_DD is a Cn_DataDictionary
64496>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
64497>>>>>>>>>        Set DDO_Server to (Constrct_DD(self))
64498>>>>>>>>>        Set DDO_Server to (Salesmen_DD(self))
64499>>>>>>>>>        Set DDO_Server to (Mhxanik_DD(self))
64500>>>>>>>>>    End_Object    // Cn_DD
64501>>>>>>>>>
64501>>>>>>>>>    Object Tperga_DD is a Tperga_DataDictionary
64503>>>>>>>>>        Set DDO_Server to (Cn_DD(self))
64504>>>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
64505>>>>>>>>>        Set Constrain_File to Cn.File_Number
64506>>>>>>>>>    End_Object    // Tperga_DD
64507>>>>>>>>>
64507>>>>>>>>>    Object Btnordh_DD is a Btnordh_DataDictionary
64509>>>>>>>>>        Set DDO_Server to (Cn_DD(self))
64510>>>>>>>>>        Set Constrain_File to Cn.File_Number
64511>>>>>>>>>
64511>>>>>>>>>        //AB-StoreStart
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>                                                    
64511>>>>>>>>>        //AB-StoreEnd
64511>>>>>>>>>
64511>>>>>>>>>    End_Object    // Btnordh_DD
64512>>>>>>>>>
64512>>>>>>>>>    Object Btnordd_DD is a BTNORDD_DataDictionary
64514>>>>>>>>>        Set DDO_Server to (Btnordh_DD(self))
64515>>>>>>>>>        Set Constrain_File to Btnordh.File_Number
64516>>>>>>>>>    End_Object    // Btnordd_DD
64517>>>>>>>>>
64517>>>>>>>>>    Set Main_DD to (Btnordh_DD(self))
64518>>>>>>>>>    Set Server to (Btnordh_DD(self))
64519>>>>>>>>>
64519>>>>>>>>>    //AB-DDOEnd
64519>>>>>>>>>
64519>>>>>>>>>    Object Container1 is a dbContainer3d
64521>>>>>>>>>        Set Border_Style to Border_Normal
64522>>>>>>>>>        Set Size to 108 518
64523>>>>>>>>>        Set Location to 2 4
64524>>>>>>>>>        Object TextBoxSub5 is a TextBoxSub
64526>>>>>>>>>            Set Label to "‰à›.œ¢á«ž"
64527>>>>>>>>>            Set Location to 4 3
64528>>>>>>>>>            Set Size to 10 45
64529>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64530>>>>>>>>>        End_Object    // TextBoxSub5
64531>>>>>>>>>
64531>>>>>>>>>        Object TextBoxSub6 is a TextBoxSub
64533>>>>>>>>>            Set Label to "‰à›.„¨š¦¬"
64534>>>>>>>>>            Set Location to 18 3
64535>>>>>>>>>            Set Size to 10 45
64536>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64537>>>>>>>>>        End_Object    // TextBoxSub6
64538>>>>>>>>>
64538>>>>>>>>>        Object Btnordh_Client_Id is a dbFormSub
64540>>>>>>>>>            Entry_Item Clients.Client_id
64541>>>>>>>>>            Set Server to (Tperga_DD(self))
64542>>>>>>>>>            Set Size to 13 128
64543>>>>>>>>>            Set Location to 2 63
64544>>>>>>>>>            Set Label_Col_Offset to 2
64545>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64546>>>>>>>>>            Set Prompt_Button_Mode to pb_PromptOn
64547>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64548>>>>>>>>>
64548>>>>>>>>>            //AB-StoreStart
64548>>>>>>>>>                                                                                                                                                                    
64548>>>>>>>>>            Set Prompt_Object to (sl100(Current_object))
64549>>>>>>>>>            Procedure Prompt_Callback integer hPrompt
64551>>>>>>>>>                Local String lsValue
64552>>>>>>>>>                set Export_Column of hPrompt to 0
64553>>>>>>>>>                Set Initial_Column of hPrompt to 0
64554>>>>>>>>>            end_procedure
64555>>>>>>>>>            
64555>>>>>>>>>            Procedure Prompt
64557>>>>>>>>>                Set psModule Of (sl100(Self)) to (psModule(v193(Self)))
64558>>>>>>>>>                Forward Send Prompt
64560>>>>>>>>>            End_Procedure
64561>>>>>>>>>            
64561>>>>>>>>>            Procedure Key Integer iKey
64563>>>>>>>>>            End_Procedure
64564>>>>>>>>>            
64564>>>>>>>>>            
64564>>>>>>>>>            
64564>>>>>>>>>            //AB-StoreEnd
64564>>>>>>>>>
64564>>>>>>>>>        End_Object    // Btnordh_Client_Id
64565>>>>>>>>>
64565>>>>>>>>>        Object Btnordh_Cn_Code is a dbFormSub
64567>>>>>>>>>            Entry_Item Cn.Cn_code
64568>>>>>>>>>            Set Server to (Tperga_DD(self))
64569>>>>>>>>>            Set Size to 13 128
64570>>>>>>>>>            Set Location to 18 63
64571>>>>>>>>>            Set Label_Col_Offset to 2
64572>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64573>>>>>>>>>            Set Prompt_Button_Mode to pb_PromptOn
64574>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64575>>>>>>>>>
64575>>>>>>>>>            //AB-StoreStart
64575>>>>>>>>>            Set Prompt_Object to (sl041(Current_object))
64576>>>>>>>>>            Procedure Prompt_Callback integer hPrompt
64578>>>>>>>>>                set Export_Column of hPrompt to 0
64579>>>>>>>>>                Set Initial_Column of hPrompt to 0
64580>>>>>>>>>            end_procedure
64581>>>>>>>>>            
64581>>>>>>>>>            procedure prompt
64583>>>>>>>>>                string scode
64584>>>>>>>>>                get value of (btnordh_client_id(container1(self))) to scode
64585>>>>>>>>>                if (scode<>'') set fragmaclient_id of (sl041(self)) to scode
64588>>>>>>>>>                forward send prompt
64590>>>>>>>>>                set fragmaclient_id of (sl041(self)) to ''
64591>>>>>>>>>            end_procedure
64592>>>>>>>>>            
64592>>>>>>>>>            
64592>>>>>>>>>            Procedure Key Integer iKey
64594>>>>>>>>>            End_Procedure
64595>>>>>>>>>            
64595>>>>>>>>>            //AB-StoreEnd
64595>>>>>>>>>
64595>>>>>>>>>        End_Object    // Btnordh_Cn_Code
64596>>>>>>>>>
64596>>>>>>>>>        Object TextBoxSub9 is a TextBoxSub
64598>>>>>>>>>            Set Label to "†£/¤å˜  '„¤˜¨¥žª"
64599>>>>>>>>>            Set Location to 63 3
64600>>>>>>>>>            Set Size to 10 57
64601>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64602>>>>>>>>>        End_Object    // TextBoxSub9
64603>>>>>>>>>
64603>>>>>>>>>        Object Btnordh_Aa_Deop is a dbFormSub
64605>>>>>>>>>            Entry_Item Btnordh.Aa_deop
64606>>>>>>>>>            Set Size to 13 128
64607>>>>>>>>>            Set Location to 47 63
64608>>>>>>>>>            Set Label_Col_Offset to 2
64609>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64610>>>>>>>>>            Set Prompt_Button_Mode to pb_PromptOn
64611>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64612>>>>>>>>>
64612>>>>>>>>>            //AB-StoreStart
64612>>>>>>>>>            Set Prompt_Object to (btnordh(Current_object))
64613>>>>>>>>>            Procedure Prompt_Callback integer hPrompt
64615>>>>>>>>>                Local String lsValue
64616>>>>>>>>>                set Export_Column of hPrompt to 0
64617>>>>>>>>>                Set Initial_Column of hPrompt to 0
64618>>>>>>>>>            end_procedure
64619>>>>>>>>>            
64619>>>>>>>>>            Procedure Key Integer iKey
64621>>>>>>>>>            End_Procedure
64622>>>>>>>>>            
64622>>>>>>>>>            Procedure Prompt
64624>>>>>>>>>                string sid scn
64625>>>>>>>>>                get value of (btnordh_client_id(container1(self))) to sid
64626>>>>>>>>>                get value of (btnordh_cn_code(container1(self))) to scn
64627>>>>>>>>>                if (sid<>'') set psclient of (btnordh(self)) to sid
64630>>>>>>>>>                if (scn<>'') set pscn of (btnordh(self)) to scn
64633>>>>>>>>>                Forward Send Prompt
64635>>>>>>>>>                set psclient of (btnordh(self)) to ''
64636>>>>>>>>>                set pscn of (btnordh(self)) to ''
64637>>>>>>>>>            End_Procedure
64638>>>>>>>>>            
64638>>>>>>>>>            procedure Refresh Integer iMode
64640>>>>>>>>>                Forward Send Refresh iMode
64642>>>>>>>>>                integer irecnum
64643>>>>>>>>>                get field_current_value of btnordh_dd field btnordh.recnum to irecnum
64644>>>>>>>>>                Set Enabled_State Of (buttonsub3(container1(self))) to (btnordh.locked=0)
64645>>>>>>>>>                Set Enabled_State Of (btnactive(container1(self)))  to ((btnordh.locked=1)AND (btnordh.deop_active=0))
64646>>>>>>>>>                Set Enabled_State Of (btncopy(container1(self)))    to ((btnordh.locked=1)and (btnordh.deop_active=0))
64647>>>>>>>>>                set enabled_state of (the_table(self))              to (btnordh.recr<>'')
64648>>>>>>>>>                set enabled_state of (btnektyp(self))               to (btnordh.recr<>'')
64649>>>>>>>>>            End_procedure
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            
64650>>>>>>>>>            //AB-StoreEnd
64650>>>>>>>>>
64650>>>>>>>>>        End_Object    // Btnordh_Aa_Deop
64651>>>>>>>>>
64651>>>>>>>>>        Object Btnordh_Deop_Date is a dbFormSub
64653>>>>>>>>>            Entry_Item Btnordh.Deop_date
64654>>>>>>>>>            Set Size to 13 62
64655>>>>>>>>>            Set Location to 62 63
64656>>>>>>>>>            Set Label_Col_Offset to 2
64657>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64658>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64659>>>>>>>>>        End_Object    // Btnordh_Deop_Date
64660>>>>>>>>>
64660>>>>>>>>>        Object Btnordh_Deop_Lhxh is a dbFormSub
64662>>>>>>>>>            Entry_Item Btnordh.Deop_lhxh
64663>>>>>>>>>            Set Size to 13 66
64664>>>>>>>>>            Set Location to 62 183
64665>>>>>>>>>            Set Label_Col_Offset to 2
64666>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64667>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64668>>>>>>>>>        End_Object    // Btnordh_Deop_Lhxh
64669>>>>>>>>>
64669>>>>>>>>>        Object Btnordh_Eleiph is a dbFormSub
64671>>>>>>>>>            Entry_Item Btnordh.Eleiph
64672>>>>>>>>>            Set Size to 13 31
64673>>>>>>>>>            Set Location to 62 434
64674>>>>>>>>>            Set Label_Col_Offset to 2
64675>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64676>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64677>>>>>>>>>        End_Object    // Btnordh_Eleiph
64678>>>>>>>>>
64678>>>>>>>>>        Object Btnordh_Velxr is a dbComboFormSub
64680>>>>>>>>>            Entry_Item Btnordh.Velxr
64681>>>>>>>>>            Set Size to 13 41
64682>>>>>>>>>            Set Location to 61 470
64683>>>>>>>>>            Set Label_Col_Offset to 2
64684>>>>>>>>>        End_Object    // Btnordh_Velxr
64685>>>>>>>>>
64685>>>>>>>>>        Object Btnordh_Deop_Active is a dbCheckBoxSub
64687>>>>>>>>>            Entry_Item Btnordh.Deop_active
64688>>>>>>>>>            Set Size to 10 11
64689>>>>>>>>>            Set Location to 52 266
64690>>>>>>>>>            Set Enabled_State to FALSE
64691>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
64692>>>>>>>>>            Set Shadow_State Item 0 to TRUE
64693>>>>>>>>>        End_Object    // Btnordh_Deop_Active
64694>>>>>>>>>
64694>>>>>>>>>        Object Clients_Client_Name is a dbFormSub
64696>>>>>>>>>            Entry_Item Clients.Client_name
64697>>>>>>>>>            Set Size to 13 287
64698>>>>>>>>>            Set Location to 1 197
64699>>>>>>>>>            Set Color to clBtnFace
64700>>>>>>>>>            Set Label_Col_Offset to 2
64701>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64702>>>>>>>>>            Set Enabled_State to FALSE
64703>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64704>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
64705>>>>>>>>>            Set Shadow_State Item 0 to TRUE
64706>>>>>>>>>        End_Object    // Clients_Client_Name
64707>>>>>>>>>
64707>>>>>>>>>        Object Cn_Cn_Descr is a dbFormSub
64709>>>>>>>>>            Entry_Item Cn.Cn_descr
64710>>>>>>>>>            Set Size to 13 287
64711>>>>>>>>>            Set Location to 17 197
64712>>>>>>>>>            Set Color to clBtnFace
64713>>>>>>>>>            Set Label_Col_Offset to 2
64714>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64715>>>>>>>>>            Set Enabled_State to FALSE
64716>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64717>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
64718>>>>>>>>>            Set Shadow_State Item 0 to TRUE
64719>>>>>>>>>        End_Object    // Cn_Cn_Descr
64720>>>>>>>>>
64720>>>>>>>>>        Object Btnordh_Locked is a dbCheckBoxSub
64722>>>>>>>>>            Entry_Item Btnordh.Locked
64723>>>>>>>>>            Set Size to 10 13
64724>>>>>>>>>            Set Location to 65 266
64725>>>>>>>>>            Set Enabled_State to FALSE
64726>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
64727>>>>>>>>>            Set Shadow_State Item 0 to TRUE
64728>>>>>>>>>        End_Object    // Btnordh_Locked
64729>>>>>>>>>
64729>>>>>>>>>        Object TextBoxSub10 is a TextBoxSub
64731>>>>>>>>>            Set Label to "“§œ¬Ÿ.¢ž¨à£é¤"
64732>>>>>>>>>            Set Location to 33 3
64733>>>>>>>>>            Set Size to 10 58
64734>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64735>>>>>>>>>        End_Object    // TextBoxSub10
64736>>>>>>>>>
64736>>>>>>>>>        Object Btnordh_Sxolia is a dbEditSub
64738>>>>>>>>>            Entry_Item Btnordh.Sxolia
64739>>>>>>>>>            Set Size to 28 450
64740>>>>>>>>>            Set Location to 76 63
64741>>>>>>>>>        End_Object    // Btnordh_Sxolia
64742>>>>>>>>>
64742>>>>>>>>>        Object TextBoxSub11 is a TextBoxSub
64744>>>>>>>>>            Set Label to "‘®æ¢ ˜"
64745>>>>>>>>>            Set Location to 75 34
64746>>>>>>>>>            Set Size to 10 26
64747>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64748>>>>>>>>>        End_Object    // TextBoxSub11
64749>>>>>>>>>
64749>>>>>>>>>        Object Payresp_Presp_Id is a dbFormSub
64751>>>>>>>>>            Entry_Item Payresp.Presp_id
64752>>>>>>>>>            Set Server to (Tperga_DD(self))
64753>>>>>>>>>            Set Size to 13 128
64754>>>>>>>>>            Set Location to 33 63
64755>>>>>>>>>            Set Color to clBtnFace
64756>>>>>>>>>            Set Label_Col_Offset to 2
64757>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64758>>>>>>>>>            Set Enabled_State to FALSE
64759>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64760>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
64761>>>>>>>>>            Set Shadow_State Item 0 to TRUE
64762>>>>>>>>>
64762>>>>>>>>>            //AB-StoreStart
64762>>>>>>>>>                                                                                                                                                                    
64762>>>>>>>>>            //AB-StoreEnd
64762>>>>>>>>>
64762>>>>>>>>>        End_Object    // Payresp_Presp_Id
64763>>>>>>>>>
64763>>>>>>>>>        Object Payresp_Presp_Name is a dbFormSub
64765>>>>>>>>>            Entry_Item Payresp.Presp_name
64766>>>>>>>>>            Set Size to 13 287
64767>>>>>>>>>            Set Location to 32 197
64768>>>>>>>>>            Set Color to clBtnFace
64769>>>>>>>>>            Set Label_Col_Offset to 2
64770>>>>>>>>>            Set Label_Justification_Mode to jMode_Right
64771>>>>>>>>>            Set Enabled_State to FALSE
64772>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64773>>>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
64774>>>>>>>>>            Set Shadow_State Item 0 to TRUE
64775>>>>>>>>>        End_Object    // Payresp_Presp_Name
64776>>>>>>>>>
64776>>>>>>>>>        Object TextBoxSub12 is a TextBoxSub
64778>>>>>>>>>            Set Label to "‰à›. ƒ.„.Ž."
64779>>>>>>>>>            Set Location to 48 3
64780>>>>>>>>>            Set Size to 10 45
64781>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64782>>>>>>>>>        End_Object    // TextBoxSub12
64783>>>>>>>>>
64783>>>>>>>>>        Object ButtonSub2 is a ButtonSub
64785>>>>>>>>>            Set Label to "ButtonSub4"
64786>>>>>>>>>            Set Bitmap to "AssForm.bmp"
64787>>>>>>>>>            Set Size to 21 24
64788>>>>>>>>>            Set Location to 84 29
64789>>>>>>>>>            Set Focus_Mode to Pointer_Only
64790>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64791>>>>>>>>>
64791>>>>>>>>>            //AB-StoreStart
64791>>>>>>>>>                                                                                                                                                        
64791>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ƒ.„.Ž.  œ¢á«ž-„¨š¦¬"
64792>>>>>>>>>            
64792>>>>>>>>>            Procedure OnClick
64794>>>>>>>>>                Integer iRec icheck
64795>>>>>>>>>                string  sclient scn
64795>>>>>>>>>                Get Field_Current_Value Of clients_dd Field clients.client_id to sclient
64796>>>>>>>>>                Get Field_Current_Value Of cn_dd      Field cn.cn_code        to scn
64797>>>>>>>>>                Set psclient of (v193a(self)) to sclient
64798>>>>>>>>>                set pscn     of (v193a(self)) to scn
64799>>>>>>>>>                Send activate_v193a
64800>>>>>>>>>            End_Procedure // OnClick
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            
64801>>>>>>>>>            //AB-StoreEnd
64801>>>>>>>>>
64801>>>>>>>>>        End_Object    // ButtonSub2
64802>>>>>>>>>
64802>>>>>>>>>        Object TextBoxSub13 is a TextBoxSub
64804>>>>>>>>>            Set Label to "‰¢œ ›à£â¤¦"
64805>>>>>>>>>            Set Location to 65 277
64806>>>>>>>>>            Set Size to 10 41
64807>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64808>>>>>>>>>        End_Object    // TextBoxSub13
64809>>>>>>>>>
64809>>>>>>>>>        Object ButtonSub3 is a ButtonSub
64811>>>>>>>>>            Set Label to "ButtonSub3"
64812>>>>>>>>>            Set Bitmap to "autocopen.bmp"
64813>>>>>>>>>            Set Size to 23 25
64814>>>>>>>>>            Set Location to 52 320
64815>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64816>>>>>>>>>
64816>>>>>>>>>            //AB-StoreStart
64816>>>>>>>>>            set tooltipvalue to '‰¢œå›à£˜ ƒ.„.Ž.'
64817>>>>>>>>>            Procedure OnClick
64819>>>>>>>>>                integer iactive retval irecnum
64820>>>>>>>>>                string srecr sdeop sitem msgstr scn sclient
64820>>>>>>>>>                get yesno_box "‡â¢œ«œ §¨˜š£˜« ¡á ¤˜ ¡¢œ ›é©œ  «¦ ƒ.„.Ž. ?? " to retval
64821>>>>>>>>>                If (RetVal =MBR_yes) begin
64823>>>>>>>>>                    get field_current_value of btnordh_dd field btnordh.recnum to irecnum
64824>>>>>>>>>                    if (irecnum) begin
64826>>>>>>>>>                        send find to btnordd_dd first_record 1
64827>>>>>>>>>                        if (not(found)) begin
64829>>>>>>>>>                            error 3003 'ƒœ¤ â®œ«œ §œ¨˜©£â¤˜ œå›ž ©«¦ ƒ.„.Ž.'
64830>>>>>>>>>>
64830>>>>>>>>>                            procedure_return
64831>>>>>>>>>                        end
64831>>>>>>>>>>
64831>>>>>>>>>                        set pibtn to 1
64832>>>>>>>>>                        set field_current_value of btnordh_dd field btnordh.locked to 1
64833>>>>>>>>>                        begin_transaction
64834>>>>>>>>>                            indicate err false
64835>>>>>>>>>                            While (found=1)
64839>>>>>>>>>                                set field_changed_value of btnordd_dd field btnordd.vactive    to 0
64840>>>>>>>>>                                send request_save to btnordd_dd
64841>>>>>>>>>                                send find to btnordd_dd next_record 1
64842>>>>>>>>>                            loop
64843>>>>>>>>>>
64843>>>>>>>>>                            set field_changed_value of btnordh_dd field btnordh.locked to 1
64844>>>>>>>>>                            set field_changed_value of btnordh_dd field btnordh.deop_active to 0
64845>>>>>>>>>                            send request_save to btnordh_dd
64846>>>>>>>>>                        end_transaction
64847>>>>>>>>>                        send clear to btnordd_dd
64848>>>>>>>>>                    end
64848>>>>>>>>>>
64848>>>>>>>>>                    else error 3004 'ƒœ¤ â®à œ¤œ¨šæ ƒ.„.Ž.'
64850>>>>>>>>>                    set pibtn to 0
64851>>>>>>>>>                    Send Find_By_Recnum to btnordh_DD btnordh.File_Number iRecnum
64852>>>>>>>>>                end
64852>>>>>>>>>>
64852>>>>>>>>>            
64852>>>>>>>>>            End_Procedure // OnClick
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            
64853>>>>>>>>>            //AB-StoreEnd
64853>>>>>>>>>
64853>>>>>>>>>        End_Object    // ButtonSub3
64854>>>>>>>>>
64854>>>>>>>>>        Object Btnactive is a ButtonSub
64856>>>>>>>>>            Set Label to "ButtonSub4"
64857>>>>>>>>>            Set Bitmap to "delcat_m.bmp"
64858>>>>>>>>>            Set Size to 23 25
64859>>>>>>>>>            Set Location to 52 348
64860>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64861>>>>>>>>>
64861>>>>>>>>>            //AB-StoreStart
64861>>>>>>>>>            set tooltipvalue to '€§œ¤œ¨š¦§¦åž©ž ƒ.„.Ž.'
64862>>>>>>>>>            
64862>>>>>>>>>            Procedure OnClick
64864>>>>>>>>>                integer iactive retval irecnum
64865>>>>>>>>>                string srecr sdeop sitem msgstr scn sclient
64865>>>>>>>>>                get yesno_box "‡â¢œ«œ §¨˜š£˜« ¡á ¤˜ ˜§œ¤œ¨š¦§¦ žŸã «¦ ƒ.„.Ž. ?? " to retval
64866>>>>>>>>>                If (RetVal =MBR_yes) begin
64868>>>>>>>>>                    get field_current_value of btnordh_dd field btnordh.recnum to irecnum
64869>>>>>>>>>                    if (irecnum) begin
64871>>>>>>>>>                        send rebuild_constraints to btnordd_dd
64872>>>>>>>>>                        send find to btnordd_dd first_record 1
64873>>>>>>>>>                        if (not(found)) begin
64875>>>>>>>>>                            error 3013 'ƒœ¤ â®œ«œ §œ¨˜©£â¤˜ œå›ž ©«¦ ƒ.„.Ž.'
64876>>>>>>>>>>
64876>>>>>>>>>                            procedure_return
64877>>>>>>>>>                        end
64877>>>>>>>>>>
64877>>>>>>>>>                        set pibtn to 1
64878>>>>>>>>>                        begin_transaction
64879>>>>>>>>>                            indicate err false
64880>>>>>>>>>                            set dynamic_update_state of the_table to false
64881>>>>>>>>>                            While (found=1)
64885>>>>>>>>>                                set field_changed_value of btnordd_dd field btnordd.vactive to 2
64886>>>>>>>>>                                send request_save to btnordd_dd
64887>>>>>>>>>                                send find to btnordd_dd next_record 1
64888>>>>>>>>>                            loop
64889>>>>>>>>>>
64889>>>>>>>>>                            set field_changed_value of btnordh_dd field btnordh.deop_active to 1
64890>>>>>>>>>                            send request_save to btnordh_dd
64891>>>>>>>>>                        end_transaction
64892>>>>>>>>>                        set dynamic_update_state of the_table to true
64893>>>>>>>>>                        send clear to btnordd_dd
64894>>>>>>>>>                    end
64894>>>>>>>>>>
64894>>>>>>>>>                    else error 3004 'ƒœ¤ â®à œ¤œ¨šæ ƒ.„.Ž.'
64896>>>>>>>>>                    set pibtn to 0
64897>>>>>>>>>                    Send Find_By_Recnum to btnordh_DD btnordh.File_Number iRecnum
64898>>>>>>>>>                end
64898>>>>>>>>>>
64898>>>>>>>>>            End_Procedure // OnClick
64899>>>>>>>>>            
64899>>>>>>>>>            //AB-StoreEnd
64899>>>>>>>>>
64899>>>>>>>>>        End_Object    // Btnactive
64900>>>>>>>>>
64900>>>>>>>>>        Object TextBoxSub14 is a TextBoxSub
64902>>>>>>>>>            Set Label to "€¤œ¤œ¨šæ"
64903>>>>>>>>>            Set Location to 52 277
64904>>>>>>>>>            Set Size to 10 37
64905>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64906>>>>>>>>>        End_Object    // TextBoxSub14
64907>>>>>>>>>
64907>>>>>>>>>        Object Btncopy is a ButtonSub
64909>>>>>>>>>            Set Label to "ButtonSub4"
64910>>>>>>>>>            Set Bitmap to "COPY_mg.bmp"
64911>>>>>>>>>            Set Size to 23 25
64912>>>>>>>>>            Set Location to 52 375
64913>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64914>>>>>>>>>
64914>>>>>>>>>            //AB-StoreStart
64914>>>>>>>>>            set tooltipvalue to '€¤« š¨˜­ã ƒ.„.Ž. ©œ á¢¢¦'
64915>>>>>>>>>            Procedure OnClick
64917>>>>>>>>>                integer ibpoid retval iakyrh irecnum ifinish
64918>>>>>>>>>                string msgstr lsstore srecr
64918>>>>>>>>>                Get Field_Current_Value Of btnordh_dd Field btnordh.recr to srecr
64919>>>>>>>>>                Get Field_Current_Value Of btnordh_dd Field btnordh.recnum to irecnum
64920>>>>>>>>>                Get YesNo_Box "¨¦©¦®ã ! €¨®åœ  ž › ˜› ¡˜©å˜ ˜¤« š¨˜­ãª ƒ.„.Ž. Œá ‘¬¤œ®å©à ??"  to RetVal
64921>>>>>>>>>                If (RetVal =MBR_yes) begin
64923>>>>>>>>>                    begin_transaction
64924>>>>>>>>>                        indicate err false
64925>>>>>>>>>                        move (oDocopy(current_object)) to iBpoid
64926>>>>>>>>>                        send beg_copy to ibpoid srecr
64927>>>>>>>>>                    end_transaction
64928>>>>>>>>>                    if (not(err)) begin
64930>>>>>>>>>                        get pirecnum to irecnum
64931>>>>>>>>>                        SEND clear to btnordh_dd
64932>>>>>>>>>                        Send Find_By_Recnum to btnordh_DD btnordh.File_Number iRecnum
64933>>>>>>>>>                        send beginning_of_data to the_table true
64934>>>>>>>>>                    end
64934>>>>>>>>>>
64934>>>>>>>>>                    else send info_box '‘ž£œ éŸž¡œ ¢áŸ¦ª ¡˜«á «ž¤ ˜¤« š¨˜­ã.ƒ ˜› ¡˜©å˜ ˜¡¬¨éŸž¡œ' '¢ž¨¦­¦¨å˜'
64936>>>>>>>>>                end
64936>>>>>>>>>>
64936>>>>>>>>>            End_Procedure // OnClick
64937>>>>>>>>>            
64937>>>>>>>>>            
64937>>>>>>>>>            //AB-StoreEnd
64937>>>>>>>>>
64937>>>>>>>>>        End_Object    // Btncopy
64938>>>>>>>>>
64938>>>>>>>>>        Object TextBoxSub15 is a TextBoxSub
64940>>>>>>>>>            Set Label to "†£/¤å˜  Šã¥žª"
64941>>>>>>>>>            Set Location to 62 131
64942>>>>>>>>>            Set Size to 12 49
64943>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64944>>>>>>>>>        End_Object    // TextBoxSub15
64945>>>>>>>>>
64945>>>>>>>>>        Object Textbox1 is a Textbox
64947>>>>>>>>>            Set Label to "‘«˜Ÿœ¨æ«ž«˜"
64948>>>>>>>>>            Set Location to 48 211
64949>>>>>>>>>            Set Size to 10 53
64950>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64951>>>>>>>>>        End_Object    // Textbox1
64952>>>>>>>>>
64952>>>>>>>>>        Object Textbox2 is a Textbox
64954>>>>>>>>>            Set Label to "„¢¢œ §âª ­¦¨«å¦"
64955>>>>>>>>>            Set Location to 50 437
64956>>>>>>>>>            Set Size to 10 60
64957>>>>>>>>>            Set FontWeight to 600
64958>>>>>>>>>            Set TypeFace to "MS Sans Serif"
64959>>>>>>>>>        End_Object    // Textbox2
64960>>>>>>>>>
64960>>>>>>>>>        Object Btnordh_Statero is a dbCheckBoxSub
64962>>>>>>>>>            Entry_Item Btnordh.Statero
64963>>>>>>>>>            Set Size to 13 11
64964>>>>>>>>>            Set Location to 46 197
64965>>>>>>>>>        End_Object    // Btnordh_Statero
64966>>>>>>>>>
64966>>>>>>>>>        Object ButtonSub4 is a ButtonSub
64968>>>>>>>>>            Set Label to "ButtonSub6"
64969>>>>>>>>>            Set Bitmap to "tvwbo16.bmp"
64970>>>>>>>>>            Set Size to 10 11
64971>>>>>>>>>            Set Location to 2 487
64972>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64973>>>>>>>>>
64973>>>>>>>>>            //AB-StoreStart
64973>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª œ¢˜«é¤"
64974>>>>>>>>>            Procedure OnClick
64976>>>>>>>>>               send activate_vwclients
64977>>>>>>>>>            End_Procedure // OnClick
64978>>>>>>>>>            
64978>>>>>>>>>            
64978>>>>>>>>>            
64978>>>>>>>>>            
64978>>>>>>>>>            //AB-StoreEnd
64978>>>>>>>>>
64978>>>>>>>>>        End_Object    // ButtonSub4
64979>>>>>>>>>
64979>>>>>>>>>        Object ButtonSub5 is a ButtonSub
64981>>>>>>>>>            Set Label to "ButtonSub6"
64982>>>>>>>>>            Set Bitmap to "tvwbo16.bmp"
64983>>>>>>>>>            Set Size to 10 11
64984>>>>>>>>>            Set Location to 17 487
64985>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64986>>>>>>>>>
64986>>>>>>>>>            //AB-StoreStart
64986>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª „¨šà¤"
64987>>>>>>>>>            Procedure OnClick
64989>>>>>>>>>               send activate_v041
64990>>>>>>>>>            End_Procedure // OnClick
64991>>>>>>>>>            
64991>>>>>>>>>            
64991>>>>>>>>>            
64991>>>>>>>>>            
64991>>>>>>>>>            
64991>>>>>>>>>            //AB-StoreEnd
64991>>>>>>>>>
64991>>>>>>>>>        End_Object    // ButtonSub5
64992>>>>>>>>>
64992>>>>>>>>>        Object Btnektyp is a ButtonSub
64994>>>>>>>>>
64994>>>>>>>>>            //AB-StoreTopStart
64994>>>>>>>>>                                                                                                    
64994>>>>>>>>>            //AB-StoreTopEnd
64994>>>>>>>>>
64994>>>>>>>>>            Set Label to "ButtonSub6"
64995>>>>>>>>>            Set Bitmap to "Printer.bmp"
64996>>>>>>>>>            Set Size to 23 25
64997>>>>>>>>>            Set Location to 52 404
64998>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
64999>>>>>>>>>
64999>>>>>>>>>            //AB-StoreStart
64999>>>>>>>>>                                                                                                    
64999>>>>>>>>>            Set TooltipValue to "„¡«ç§à©ž ƒ.„.Ž."
65000>>>>>>>>>            
65000>>>>>>>>>            Procedure OnClick
65002>>>>>>>>>                string sdeop
65003>>>>>>>>>                Get Field_Current_Value Of btnordh_DD Field btnordh.aa_deop to sdeop
65004>>>>>>>>>                Set psdeop  of (r193_1(self)) to sdeop
65005>>>>>>>>>                Send runprom1Report to (prom1WQLReport(r193_1(Self)))
65006>>>>>>>>>            End_Procedure // OnClick
65007>>>>>>>>>            
65007>>>>>>>>>            
65007>>>>>>>>>            
65007>>>>>>>>>            
65007>>>>>>>>>            
65007>>>>>>>>>            //AB-StoreEnd
65007>>>>>>>>>
65007>>>>>>>>>        End_Object    // Btnektyp
65008>>>>>>>>>
65008>>>>>>>>>        Object ButtonSub6 is a ButtonSub
65010>>>>>>>>>            Set Label to "ButtonSub6"
65011>>>>>>>>>            Set Bitmap to "tvwbo16.bmp"
65012>>>>>>>>>            Set Size to 10 11
65013>>>>>>>>>            Set Location to 33 487
65014>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65015>>>>>>>>>
65015>>>>>>>>>            //AB-StoreStart
65015>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ž©žª “§. ¢ž¨à£ãª"
65016>>>>>>>>>            Procedure OnClick
65018>>>>>>>>>               send activate_v111
65019>>>>>>>>>            End_Procedure // OnClick
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            
65020>>>>>>>>>            //AB-StoreEnd
65020>>>>>>>>>
65020>>>>>>>>>        End_Object    // ButtonSub6
65021>>>>>>>>>
65021>>>>>>>>>    End_Object    // Container1
65022>>>>>>>>>
65022>>>>>>>>>    Object The_Table is a dbGrid
65024>>>>>>>>>        Set Main_File to Btnordd.File_Number
65025>>>>>>>>>        Set Server to (Btnordd_DD(self))
65026>>>>>>>>>        Set Ordering to 1
65027>>>>>>>>>        Set Size to 95 524
65028>>>>>>>>>        Set Location to 124 1
65029>>>>>>>>>        Set Wrap_State to TRUE
65030>>>>>>>>>
65030>>>>>>>>>        Begin_Row
65033>>>>>>>>>            Entry_Item Btnordd.Recnum
65034>>>>>>>>>            Entry_Item Btnordd.Vitem
65035>>>>>>>>>            Entry_Item (fsqual(self,btnordd.vitem))
65036>>>>>>>>>            Entry_Item Btnordd.Vqty
65037>>>>>>>>>            Entry_Item Btnordd.Vunitprice
65038>>>>>>>>>            Entry_Item Btnordd.Vdisc
65039>>>>>>>>>            Entry_Item Btnordd.Vdiscposo
65040>>>>>>>>>            Entry_Item Btnordd.Vprice
65041>>>>>>>>>            Entry_Item Btnordd.Vkatish
65042>>>>>>>>>            Entry_Item Btnordd.Vxrm3
65043>>>>>>>>>            Entry_Item Btnordd.Vpagiaxrm3
65044>>>>>>>>>            Entry_Item Btnordd.Vpagiaxrprice
65045>>>>>>>>>        End_Row
65050>>>>>>>>>
65050>>>>>>>>>        Set Form_Width    item 0 to 0
65051>>>>>>>>>        Set Header_Label  item 0 to ""
65052>>>>>>>>>        
65052>>>>>>>>>        Set Form_Width    item 1 to 62
65053>>>>>>>>>        Set Header_Label  item 1 to "‰à›.„å›¦¬ª"
65054>>>>>>>>>        
65054>>>>>>>>>        Set Form_Width    item 2 to 65
65055>>>>>>>>>        Set Header_Label  item 2 to "¦ æ«ž«˜"
65056>>>>>>>>>        
65056>>>>>>>>>        Set Form_Width    item 3 to 43
65057>>>>>>>>>        Set Header_Label  item 3 to "¦©æ«ž«˜"
65058>>>>>>>>>        
65058>>>>>>>>>        Set Form_Width    item 4 to 46
65059>>>>>>>>>        Set Header_Label  item 4 to "’ £ã ‹¦¤"
65060>>>>>>>>>        
65060>>>>>>>>>        Set Form_Width    item 5 to 35
65061>>>>>>>>>        Set Header_Label  item 5 to "%„¡§«"
65062>>>>>>>>>        
65062>>>>>>>>>        Set Form_Width    item 6 to 42
65063>>>>>>>>>        Set Header_Label  item 6 to "„¡§«à©ž"
65064>>>>>>>>>        
65064>>>>>>>>>        Set Form_Width    item 7 to 50
65065>>>>>>>>>        Set Header_Label  item 7 to "€¥å˜"
65066>>>>>>>>>        
65066>>>>>>>>>        Set Form_Width    item 8 to 43
65067>>>>>>>>>        Set Header_Label  item 8 to "‰áŸ ©ž"
65068>>>>>>>>>        
65068>>>>>>>>>        Set Form_Width    item 9 to 32
65069>>>>>>>>>        Set Header_Label  item 9 to "•¨/m3"
65070>>>>>>>>>        Set Column_Checkbox_State  item 9 to True
65071>>>>>>>>>        
65071>>>>>>>>>        Set Form_Width    item 10 to 50
65072>>>>>>>>>        Set Header_Label  item 10 to "˜š.•¨/m3"
65073>>>>>>>>>        
65073>>>>>>>>>        Set Form_Width    item 11 to 51
65074>>>>>>>>>        Set Header_Label  item 11 to "˜š.’ £ã •¨."
65075>>>>>>>>>        
65075>>>>>>>>>
65075>>>>>>>>>        //AB-StoreStart
65075>>>>>>>>>                                
65075>>>>>>>>>        Set Column_Prompt_Object item 1 to (sl22s(self))
65076>>>>>>>>>        
65076>>>>>>>>>        Set Column_Option Item 0        to NoEnter True
65077>>>>>>>>>        Set Column_Option Item 7        to NoEnter True
65078>>>>>>>>>        
65078>>>>>>>>>        Set CurrentRowColor             to 11468799
65079>>>>>>>>>        Set CurrentCellColor            to 11468799
65080>>>>>>>>>        
65080>>>>>>>>>        procedure item_change integer fromi integer toi returns integer
65082>>>>>>>>>            local integer rval icol iBase_item iGridID iCurrItem iFileNumber iFieldNumber
65083>>>>>>>>>            Local String Sval sQUAL svalue sNameFrom
65083>>>>>>>>>            local integer iColumn
65083>>>>>>>>>            local number nTimhMon  ndisc ntot
65083>>>>>>>>>            move (the_table(self)) to igridid
65084>>>>>>>>>            forward get msg_item_change fromi toi to rval
65086>>>>>>>>>            if (focus(Desktop) = igridid) begin
65088>>>>>>>>>                Get Column fromi to iCol
65089>>>>>>>>>                if (icol=1) begin
65091>>>>>>>>>                    Get Base_Item                   to iBase_item
65092>>>>>>>>>                    Get Value Item (iBase_item+1)   to Sval
65093>>>>>>>>>                    Move (Fsitem(self,Sval))        to Svalue
65094>>>>>>>>>                    move (Fsqual(self,Sval))        to Squal
65095>>>>>>>>>                    Set value item (iBase_item+2)   to squal
65096>>>>>>>>>                    Set value of (item_descr(self)) to svalue
65097>>>>>>>>>                End
65097>>>>>>>>>>
65097>>>>>>>>>                Else if (icol=5) begin
65100>>>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vdisc  To ndisc
65101>>>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vunitprice To nTimhMon
65102>>>>>>>>>                    move (round_number(((ntimhmon * ndisc) / 100),2)) to ntot
65103>>>>>>>>>                    // js 04/11/2002
65103>>>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.Vdiscposo To nTot
65104>>>>>>>>>                    //
65104>>>>>>>>>                    move (ntimhmon - ntot) to ntimhmon
65105>>>>>>>>>                    //Set Field_Current_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
65105>>>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
65106>>>>>>>>>                End
65106>>>>>>>>>>
65106>>>>>>>>>                Else if (icol=6) begin
65109>>>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vdiscposo  To ndisc
65110>>>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vunitprice To nTimhMon
65111>>>>>>>>>                    move (round_number(((nDisc*100)/nTimhMon),2)) to ntot
65112>>>>>>>>>                    //Set Field_Current_Value Of btnordd_DD Field btnordd.Vdisc To nTot
65112>>>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.Vdisc To nTot
65113>>>>>>>>>                    move (ntimhmon - nDisc) to ntimhmon
65114>>>>>>>>>                    //Set Field_Current_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
65114>>>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
65115>>>>>>>>>                End
65115>>>>>>>>>>
65115>>>>>>>>>            End
65115>>>>>>>>>>
65115>>>>>>>>>            procedure_return rval
65116>>>>>>>>>        end_procedure
65117>>>>>>>>>        
65117>>>>>>>>>        Procedure End_Construct_Object
65119>>>>>>>>>            Integer iDecimals
65120>>>>>>>>>            Forward Send End_Construct_Object
65122>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
65123>>>>>>>>>            Set Points Item 3 to 2
65124>>>>>>>>>            Set Points Item 4 to iDecimals
65125>>>>>>>>>            Set Points Item 5 to 2
65126>>>>>>>>>            Set Points Item 6 to iDecimals
65127>>>>>>>>>            Set Points Item 7 to iDecimals
65128>>>>>>>>>            Set Points Item 10 to iDecimals
65129>>>>>>>>>            Set Points Item 11 to iDecimals
65130>>>>>>>>>            Set Numeric_Mask  Item 4 to 14 iDecimals ' ,*'
65131>>>>>>>>>            Set Numeric_Mask  Item 6 to 14 iDecimals ' ,*'
65132>>>>>>>>>            Set Numeric_Mask  Item 7 to 14 iDecimals ' ,*'
65133>>>>>>>>>            Set Numeric_Mask  Item 10 to 14 iDecimals ' ,*'
65134>>>>>>>>>            Set Numeric_Mask  Item 11 to 14 iDecimals ' ,*'
65135>>>>>>>>>        End_Procedure
65136>>>>>>>>>        
65136>>>>>>>>>        Function Child_entering returns Integer
65138>>>>>>>>>            Integer rval
65139>>>>>>>>>            Forward Get Child_Entering to rVal
65141>>>>>>>>>            If (NOT(rVal)) Begin
65143>>>>>>>>>                If (Should_Save(btnordh_DD(Self))) Send Request_Save to btnordh_DD
65146>>>>>>>>>                If (Current_Record(btnordh_DD(Self))) Forward Get Child_Entering to rVal
65150>>>>>>>>>                Else Begin
65151>>>>>>>>>                    Function_Return 1
65152>>>>>>>>>                End
65152>>>>>>>>>>
65152>>>>>>>>>            End
65152>>>>>>>>>>
65152>>>>>>>>>            function_return rVal
65153>>>>>>>>>        End_Function
65154>>>>>>>>>        
65154>>>>>>>>>        
65154>>>>>>>>>        //AB-StoreEnd
65154>>>>>>>>>
65154>>>>>>>>>    End_Object    // The_Table
65155>>>>>>>>>
65155>>>>>>>>>    Object TextBoxSub7 is a TextBoxSub
65157>>>>>>>>>        Set Label to "œ›å˜ š ˜ ®¨ã©ž €¤«¢å˜ª"
65158>>>>>>>>>        Set Color to clNavy
65159>>>>>>>>>        Set TextColor to clYellow
65160>>>>>>>>>        Set Location to 111 305
65161>>>>>>>>>        Set Size to 10 179
65162>>>>>>>>>        Set FontWeight to 600
65163>>>>>>>>>        Set Justification_Mode to jMode_Center
65164>>>>>>>>>        Set TypeFace to "MS Sans Serif"
65165>>>>>>>>>    End_Object    // TextBoxSub7
65166>>>>>>>>>
65166>>>>>>>>>    Object TextBoxSub8 is a TextBoxSub
65168>>>>>>>>>        Set Label to "œ¨ š¨˜­ã „å›¦¬ª"
65169>>>>>>>>>        Set Location to 221 3
65170>>>>>>>>>        Set Size to 10 65
65171>>>>>>>>>        Set FontWeight to 600
65172>>>>>>>>>        Set TypeFace to "MS Sans Serif"
65173>>>>>>>>>    End_Object    // TextBoxSub8
65174>>>>>>>>>
65174>>>>>>>>>    Object item_descr is a FormSub
65176>>>>>>>>>        Set Size to 13 117
65177>>>>>>>>>        Set Location to 220 82
65178>>>>>>>>>        Set Color to clBtnFace
65179>>>>>>>>>        Set Label_Col_Offset to 2
65180>>>>>>>>>        Set Enabled_State to FALSE
65181>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
65182>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
65183>>>>>>>>>        Set Shadow_State Item 0 to TRUE
65184>>>>>>>>>
65184>>>>>>>>>        //AB-StoreStart
65184>>>>>>>>>                                                                                                                
65184>>>>>>>>>                                                                                                                
65184>>>>>>>>>                                                                                                                
65184>>>>>>>>>        //AB-StoreEnd
65184>>>>>>>>>
65184>>>>>>>>>    End_Object    // item_descr
65185>>>>>>>>>
65185>>>>>>>>>    Object TextBoxSub17 is a TextBoxSub
65187>>>>>>>>>        Set Label to "ƒž£ ¦¬¨šãŸž¡œ"
65188>>>>>>>>>        Set Location to 237 4
65189>>>>>>>>>        Set Size to 10 51
65190>>>>>>>>>        Set TypeFace to "MS Sans Serif"
65191>>>>>>>>>    End_Object    // TextBoxSub17
65192>>>>>>>>>
65192>>>>>>>>>    Object Btnordh_Date_Create is a dbFormSub
65194>>>>>>>>>        Entry_Item Btnordh.Date_create
65195>>>>>>>>>        Set Size to 13 57
65196>>>>>>>>>        Set Location to 235 82
65197>>>>>>>>>        Set Color to clBtnFace
65198>>>>>>>>>        Set Label_Col_Offset to 2
65199>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
65200>>>>>>>>>        Set Enabled_State to FALSE
65201>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
65202>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
65203>>>>>>>>>        Set Shadow_State Item 0 to TRUE
65204>>>>>>>>>    End_Object    // Btnordh_Date_Create
65205>>>>>>>>>
65205>>>>>>>>>    Object Tperga_ is a dbGridSub
65207>>>>>>>>>        Set Main_File to Tperga.File_Number
65208>>>>>>>>>        Set Server to (Tperga_DD(self))
65209>>>>>>>>>        Set Size to 48 319
65210>>>>>>>>>        Set Location to 221 204
65211>>>>>>>>>        Set Wrap_State to TRUE
65212>>>>>>>>>
65212>>>>>>>>>        Begin_Row
65215>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
65216>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
65217>>>>>>>>>            Entry_Item Tperga.Pct_epi_synolou
65218>>>>>>>>>            Entry_Item Tperga.Paralabh_meres
65219>>>>>>>>>            Entry_Item Tperga.Xarhtos_meres
65220>>>>>>>>>            Entry_Item Tperga.Plhroteo_meres
65221>>>>>>>>>        End_Row
65226>>>>>>>>>
65226>>>>>>>>>        Set Form_Width    item 0 to 36
65227>>>>>>>>>        Set Header_Label  item 0 to "‰à›."
65228>>>>>>>>>        
65228>>>>>>>>>        Set Form_Width    item 1 to 79
65229>>>>>>>>>        Set Header_Label  item 1 to "’¨æ§¦ª"
65230>>>>>>>>>        
65230>>>>>>>>>        Set Form_Width    item 2 to 47
65231>>>>>>>>>        Set Header_Label  item 2 to "% ‘¬¤æ¢¦¬"
65232>>>>>>>>>        
65232>>>>>>>>>        Set Form_Width    item 3 to 55
65233>>>>>>>>>        Set Header_Label  item 3 to "˜¨˜¢˜™ã (‹)"
65234>>>>>>>>>        
65234>>>>>>>>>        Set Form_Width    item 4 to 57
65235>>>>>>>>>        Set Header_Label  item 4 to "†£. ’ £/©žª"
65236>>>>>>>>>        
65236>>>>>>>>>        Set Form_Width    item 5 to 39
65237>>>>>>>>>        Set Header_Label  item 5 to "¢ž¨. (‹)"
65238>>>>>>>>>        
65238>>>>>>>>>
65238>>>>>>>>>        //AB-StoreStart
65238>>>>>>>>>                                                                                                                
65238>>>>>>>>>                                                                                                                
65238>>>>>>>>>        Set Column_Option Item 1        to NoEnter True
65239>>>>>>>>>        
65239>>>>>>>>>        Function Child_entering returns Integer
65241>>>>>>>>>            Integer rval iErr
65242>>>>>>>>>            Forward Get Child_Entering to rVal
65244>>>>>>>>>            If (NOT(rVal)) Begin
65246>>>>>>>>>                If (Current_Record(BtnOrdH_DD(Self))) Forward Get Child_Entering to rVal
65250>>>>>>>>>                Else Begin
65251>>>>>>>>>                    Function_Return 1
65252>>>>>>>>>                End
65252>>>>>>>>>>
65252>>>>>>>>>            End
65252>>>>>>>>>>
65252>>>>>>>>>            function_return rVal
65253>>>>>>>>>        End_Function
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        
65254>>>>>>>>>        //AB-StoreEnd
65254>>>>>>>>>
65254>>>>>>>>>    End_Object    // Tperga_
65255>>>>>>>>>
65255>>>>>>>>>    Object TextBoxSub18 is a TextBoxSub
65257>>>>>>>>>        Set Label to "’¨æ§¦  ¢ž¨à£ãª "
65258>>>>>>>>>        Set Location to 237 143
65259>>>>>>>>>        Set Size to 10 59
65260>>>>>>>>>        Set TypeFace to "MS Sans Serif"
65261>>>>>>>>>    End_Object    // TextBoxSub18
65262>>>>>>>>>
65262>>>>>>>>>    Object TextBoxSub19 is a TextBoxSub
65264>>>>>>>>>        Set Label to "‘«æ®¦ª †‘Ž"
65265>>>>>>>>>        Set Location to 252 4
65266>>>>>>>>>        Set Size to 10 47
65267>>>>>>>>>        Set TypeFace to "MS Sans Serif"
65268>>>>>>>>>    End_Object    // TextBoxSub19
65269>>>>>>>>>
65269>>>>>>>>>    Object Clients_Hpso is a dbFormSub
65271>>>>>>>>>        Entry_Item Clients.Hpso
65272>>>>>>>>>        Set Size to 13 30
65273>>>>>>>>>        Set Location to 250 82
65274>>>>>>>>>        Set Label_Col_Offset to 2
65275>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
65276>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
65277>>>>>>>>>
65277>>>>>>>>>        //AB-StoreStart
65277>>>>>>>>>        set enabled_state to false
65278>>>>>>>>>        //AB-StoreEnd
65278>>>>>>>>>
65278>>>>>>>>>    End_Object    // Clients_Hpso
65279>>>>>>>>>
65279>>>>>>>>>    Object TextBoxSub20 is a TextBoxSub
65281>>>>>>>>>        Set Label to "‘«æ®¦ª †€Š "
65282>>>>>>>>>        Set Location to 252 117
65283>>>>>>>>>        Set Size to 10 46
65284>>>>>>>>>        Set TypeFace to "MS Sans Serif"
65285>>>>>>>>>    End_Object    // TextBoxSub20
65286>>>>>>>>>
65286>>>>>>>>>    Object Clients_Hpal is a dbFormSub
65288>>>>>>>>>        Entry_Item Clients.Hpal
65289>>>>>>>>>        Set Size to 13 30
65290>>>>>>>>>        Set Location to 250 168
65291>>>>>>>>>        Set Label_Col_Offset to 2
65292>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
65293>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
65294>>>>>>>>>
65294>>>>>>>>>        //AB-StoreStart
65294>>>>>>>>>        set enabled_state to false
65295>>>>>>>>>        //AB-StoreEnd
65295>>>>>>>>>
65295>>>>>>>>>    End_Object    // Clients_Hpal
65296>>>>>>>>>
65296>>>>>>>>>
65296>>>>>>>>>    //AB-StoreStart
65296>>>>>>>>>    set verify_data_loss_msg    to get_no_confirmation
65297>>>>>>>>>    set verify_save_msg         to get_no_confirmation
65298>>>>>>>>>    set verify_exit_msg         to get_no_confirmation
65299>>>>>>>>>    
65299>>>>>>>>>    Procedure Activate
65301>>>>>>>>>        String  sModule sIsClient sIsPromhtheyths
65302>>>>>>>>>        Integer rVal iCurRec irecnum
65302>>>>>>>>>        if (pscncode(self)<>'') begin
65304>>>>>>>>>           send clear to cn_dd
65305>>>>>>>>>           send clear to btnordh_dd
65306>>>>>>>>>           send clear to btnordd_dd
65307>>>>>>>>>           send clear to tperga_dd
65308>>>>>>>>>           move (pscncode(self)) to cn.cn_code
65309>>>>>>>>>           send find to cn_dd eq 5
65310>>>>>>>>>        end
65310>>>>>>>>>>
65310>>>>>>>>>        set pscncode   to ''
65311>>>>>>>>>    
65311>>>>>>>>>        if (psdeop(self)<>'') begin
65313>>>>>>>>>            Clear btnordh
65314>>>>>>>>>            Move (psdeop(self)) to btnordh.aa_deop
65315>>>>>>>>>            Find Eq btnordh by index.1
65316>>>>>>>>>>
65316>>>>>>>>>            send find to btnordh_dd eq 1
65317>>>>>>>>>        end
65317>>>>>>>>>>
65317>>>>>>>>>        set psdeop to ''
65318>>>>>>>>>        Forward Send Activate
65320>>>>>>>>>    
65320>>>>>>>>>    End_Procedure
65321>>>>>>>>>    
65321>>>>>>>>>    Procedure Activate_View Returns Integer
65323>>>>>>>>>        String  sModule sIsClient sIsPromhtheyths
65324>>>>>>>>>        Integer rVal iCurRec
65324>>>>>>>>>        Forward Get Msg_Activate_View to rVal
65326>>>>>>>>>     //   Get psMenuModule  Of Main_Menu  to sModule
65326>>>>>>>>>        Set psModule to sModule
65327>>>>>>>>>        Procedure_Return rVal
65328>>>>>>>>>    End_Procedure
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    
65329>>>>>>>>>    //AB-StoreEnd
65329>>>>>>>>>
65329>>>>>>>>>End_Object    // V193v
65330>>>>>>>>>
65330>>>>>>>>>
65330>>>>>>>>>//AB-StoreStart
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>    
65330>>>>>>>>>//AB-StoreEnd
65330>>>>>>>>>
65330>>>>>>>>>//AB/ End_Object    // prj
65330>>>>>>>open syscurxr
65332>>>>>>>
65332>>>>>>>//AB-StoreTopEnd
65332>>>>>>>
65332>>>>>>>//AB-IgnoreStart
65332>>>>>>>
65332>>>>>>>Use dbView.Sub
65332>>>>>>>Use DFAllEnt.pkg
65332>>>>>>>Use Txtbox.Sub
65332>>>>>>>Use dbForm.Sub
65332>>>>>>>Use dbCmbfrm.Sub
65332>>>>>>>Use Button.Sub
65332>>>>>>>Use dbChkbox.Sub
65332>>>>>>>Use dbEdit.Sub
65332>>>>>>>Use Form.Sub
65332>>>>>>>Use dbGrid.Sub
65332>>>>>>>
65332>>>>>>>Use BAXIOKAT.DD
65332>>>>>>>Use COUNTRY.DD
65332>>>>>>>Use TOWNS.DD
65332>>>>>>>Use CITIES.DD
65332>>>>>>>Use AREAS.DD
65332>>>>>>>Use PAYRESP.DD
65332>>>>>>>Use CLIENTS.DD
65332>>>>>>>Use CONSTRCT.DD
65332>>>>>>>Use SALESMEN.DD
65332>>>>>>>Use MHXANIK.DD
65332>>>>>>>Use CN.DD
65332>>>>>>>Use TPERGA.DD
65332>>>>>>>Use BTNORDH.DD
65332>>>>>>>Use BTNORDD.DD
65332>>>>>>>
65332>>>>>>>//AB-IgnoreEnd
65332>>>>>>>
65332>>>>>>>ACTIVATE_VIEW Activate_V193 FOR V193
65336>>>>>>>
65336>>>>>>>Object V193 is a dbViewSub
65338>>>>>>>
65338>>>>>>>    //AB-StoreTopStart
65338>>>>>>>    Property string     PSCLIENT    public ''
65340>>>>>>>    property string     psCnCode    public ''
65342>>>>>>>    property integer    piepil      public 0
65344>>>>>>>    property integer    pibtn       public 0
65346>>>>>>>    Property String     psModule    public ''
65348>>>>>>>    property integer    pirecnum    public 0
65350>>>>>>>    property date       pddate      public ''
65352>>>>>>>    property string     psdeop      public ''
65354>>>>>>>    
65354>>>>>>>    function fsqual string code returns string
65356>>>>>>>         string squal
65357>>>>>>>         clear iteml
65358>>>>>>>         move code to iteml.item_code
65359>>>>>>>         find eq iteml by index.5
65360>>>>>>>>
65360>>>>>>>         move iteml.item_qual to squal
65361>>>>>>>    //     clear itemL
65361>>>>>>>         function_return squal
65362>>>>>>>    end_Function
65363>>>>>>>    
65363>>>>>>>    //AB-StoreTopEnd
65363>>>>>>>
65363>>>>>>>    Set Label to "€¤á¢¬©ž œ ›é¤  œ¢á«ž-„¨š¦¬  ƒ.„.Ž."
65364>>>>>>>    Set Size to 285 529
65365>>>>>>>    Set Location to 1 1
65366>>>>>>>
65366>>>>>>>    //AB-DDOStart
65366>>>>>>>
65366>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
65368>>>>>>>    End_Object    // Baxiokat_DD
65369>>>>>>>
65369>>>>>>>    Object Country_DD is a Country_DataDictionary
65371>>>>>>>    End_Object    // Country_DD
65372>>>>>>>
65372>>>>>>>    Object Towns_DD is a Towns_DataDictionary
65374>>>>>>>        Set DDO_Server to (Country_DD(self))
65375>>>>>>>
65375>>>>>>>        //AB-StoreStart
65375>>>>>>>                                                                                                                                        
65375>>>>>>>                                                                                                                                        
65375>>>>>>>                                                                                                                                        
65375>>>>>>>        //AB-StoreEnd
65375>>>>>>>
65375>>>>>>>    End_Object    // Towns_DD
65376>>>>>>>
65376>>>>>>>    Object Cities_DD is a Cities_DataDictionary
65378>>>>>>>        Set DDO_Server to (Towns_DD(self))
65379>>>>>>>
65379>>>>>>>        //AB-StoreStart
65379>>>>>>>                                                                                                                                        
65379>>>>>>>        //AB-StoreEnd
65379>>>>>>>
65379>>>>>>>    End_Object    // Cities_DD
65380>>>>>>>
65380>>>>>>>    Object Areas_DD is a Areas_DataDictionary
65382>>>>>>>    End_Object    // Areas_DD
65383>>>>>>>
65383>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
65385>>>>>>>
65385>>>>>>>        //AB-StoreStart
65385>>>>>>>                                                                                                                                                                                                                                                                                    
65385>>>>>>>        Set piCheckPlaf to 0
65386>>>>>>>        
65386>>>>>>>        //AB-StoreEnd
65386>>>>>>>
65386>>>>>>>    End_Object    // Payresp_DD
65387>>>>>>>
65387>>>>>>>    Object Clients_DD is a Clients_DataDictionary
65389>>>>>>>        Set DDO_Server to (Cities_DD(self))
65390>>>>>>>        Set DDO_Server to (Areas_DD(self))
65391>>>>>>>        Set DDO_Server to (Payresp_DD(self))
65392>>>>>>>
65392>>>>>>>        //AB-StoreStart
65392>>>>>>>                                                                                                                                                                                                                                                                                    
65392>>>>>>>        Set piCheckPlaf to 0
65393>>>>>>>        
65393>>>>>>>        //AB-StoreEnd
65393>>>>>>>
65393>>>>>>>    End_Object    // Clients_DD
65394>>>>>>>
65394>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
65396>>>>>>>    End_Object    // Constrct_DD
65397>>>>>>>
65397>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
65399>>>>>>>    End_Object    // Salesmen_DD
65400>>>>>>>
65400>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
65402>>>>>>>    End_Object    // Mhxanik_DD
65403>>>>>>>
65403>>>>>>>    Object Cn_DD is a Cn_DataDictionary
65405>>>>>>>        Set DDO_Server to (Clients_DD(self))
65406>>>>>>>        Set DDO_Server to (Constrct_DD(self))
65407>>>>>>>        Set DDO_Server to (Salesmen_DD(self))
65408>>>>>>>        Set DDO_Server to (Mhxanik_DD(self))
65409>>>>>>>    End_Object    // Cn_DD
65410>>>>>>>
65410>>>>>>>    Object Tperga_DD is a Tperga_DataDictionary
65412>>>>>>>        Set DDO_Server to (Cn_DD(self))
65413>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
65414>>>>>>>        Set Constrain_File to Cn.File_Number
65415>>>>>>>    End_Object    // Tperga_DD
65416>>>>>>>
65416>>>>>>>    Object Btnordh_DD is a Btnordh_DataDictionary
65418>>>>>>>        Set DDO_Server to (Cn_DD(self))
65419>>>>>>>        Set Constrain_File to Cn.File_Number
65420>>>>>>>
65420>>>>>>>        //AB-StoreStart
65420>>>>>>>                                                                                                                                                                                                                                                                                    
65420>>>>>>>        Procedure Save_Main_File
65422>>>>>>>            integer ilocked ibtn
65423>>>>>>>            date ddate
65423>>>>>>>            get pibtn to ibtn
65424>>>>>>>            get field_current_value of btnordh_dd field btnordh.locked to ilocked
65425>>>>>>>            If (ilocked=0) Forward Send Save_Main_File
65429>>>>>>>            else if (ilocked=1 and ibtn=1) Forward Send Save_Main_File
65434>>>>>>>            Else Send Info_Box "’¦ ƒ.„.Ž. œå¤˜  ¡¢œ ›à£â¤¦.\nƒœ¤ œ§ «¨â§¦¤«˜  ˜¢¢˜šâª" "¢ž¨¦­¦¨å˜"
65436>>>>>>>        End_Procedure
65437>>>>>>>        Procedure Delete_Main_File
65439>>>>>>>            integer ilocked ibtn
65440>>>>>>>            get pibtn to ibtn
65441>>>>>>>            get field_current_value of btnordh_dd field btnordh.locked to ilocked
65442>>>>>>>            If (ilocked=0) Forward Send delete_Main_File
65446>>>>>>>            else if (ilocked=1 and ibtn=1) Forward Send delete_Main_File
65451>>>>>>>            Else Send Info_Box  "’¦ ƒ.„.Ž. œå¤˜  ¡¢œ ›à£â¤¦.\nƒœ¤ œ§ «¨â§¦¤«˜  ˜¢¢˜šâª" "¢ž¨¦­¦¨å˜"
65453>>>>>>>        End_Procedure
65454>>>>>>>        
65454>>>>>>>        Function Validate_Save  Returns Integer
65456>>>>>>>            Local Integer iReturnVal
65457>>>>>>>            date ddate
65457>>>>>>>            Forward Get Validate_Save  To iReturnVal
65459>>>>>>>            If (Not(iReturnVal)) Begin
65461>>>>>>>               if (btnordh.DEOP_DATE gt btnordh.DEOP_LHXH) error 3322 '†£œ¨¦£ž¤å˜ â¤˜¨¥žª > ž£/¤å˜ ¢ã¥žª'
65464>>>>>>>            end
65464>>>>>>>>
65464>>>>>>>            Function_Return iReturnVal
65465>>>>>>>        End_Function   // Validate_Save
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        
65466>>>>>>>        //AB-StoreEnd
65466>>>>>>>
65466>>>>>>>    End_Object    // Btnordh_DD
65467>>>>>>>
65467>>>>>>>    Object Btnordd_DD is a Btnordd_DataDictionary
65469>>>>>>>
65469>>>>>>>        //AB-StoreTopStart
65469>>>>>>>                
65469>>>>>>>        //AB-StoreTopEnd
65469>>>>>>>
65469>>>>>>>        Set DDO_Server to (Btnordh_DD(self))
65470>>>>>>>        Set Constrain_File to Btnordh.File_Number
65471>>>>>>>
65471>>>>>>>        //AB-StoreStart
65471>>>>>>>                
65471>>>>>>>        Function Validate_Save  Returns Integer
65473>>>>>>>            Local Integer iReturnVal
65474>>>>>>>            Integer iErrorObj iRetval iRecnum
65474>>>>>>>            String  sClient sCN sItem sDeop sStr
65474>>>>>>>            Date    dStart dHmnia
65474>>>>>>>            Forward Get Validate_Save  To iReturnVal
65476>>>>>>>            If (Not(iReturnVal)) Begin
65478>>>>>>>               // Insert Code Here
65478>>>>>>>               clear iteml
65479>>>>>>>               move btnordd.vitem to iteml.item_code
65480>>>>>>>               find eq iteml by index.5
65481>>>>>>>>
65481>>>>>>>               if (not(found)) Begin
65483>>>>>>>                    Clear ItemL
65484>>>>>>>                    error 4444 'ƒœ¤ ¬§á¨®œ  «¦ œå›¦ª ©«¦ ˜¨®œå¦ œ ›é¤'
65485>>>>>>>>
65485>>>>>>>               End
65485>>>>>>>>
65485>>>>>>>               Clear ItemL
65486>>>>>>>               If (btnordd.vunitprice=0) error 4443 'ƒœ¤ œ§ «¨â§œ«˜  ¡˜«˜®é¨ž©ž £œ « £ã £¦¤á›¦ª = 0'
65489>>>>>>>        ///////////////////////////
65489>>>>>>>                Move '' to sStr
65490>>>>>>>                Move Clients.Client_ID to sClient
65491>>>>>>>                Move CN.CN_Code        to sCn
65492>>>>>>>                Move Btnordd.Vitem     to sItem
65493>>>>>>>                Move Btnordd.Vorderbt  to sDeop
65494>>>>>>>                Move Btnordh.Deop_Date to dStart
65495>>>>>>>                Move Btnordh.Recnum    to iRecnum
65496>>>>>>>        
65496>>>>>>>                Clear BtnorddL
65497>>>>>>>                Move sClient    to BtnorddL.Vclient_ID
65498>>>>>>>                Move sCN        to BtnorddL.Vcn_Code
65499>>>>>>>                Move 0          to BtnorddL.Vactive
65500>>>>>>>                Move sItem      to BtnorddL.Vitem
65501>>>>>>>                Move 9999999999 to BtnorddL.Recnum
65502>>>>>>>                Find Lt BtnorddL by index.3
65503>>>>>>>>
65503>>>>>>>                If  ((Found=1) And (BtnorddL.Vclient_ID=sClient) And (BtnorddL.Vcn_Code=sCN) And  ;                                   (BtnorddL.Vactive   =0)       And (BtnorddL.Vitem=sItem)  And  ;                                   (BtnorddL.Deop_Date>=dStart)) Begin
65505>>>>>>>                    // An to teleytaio record pou vriskei einai o eaytos tou
65505>>>>>>>                    // me ton index ayton, na girisei ena akoma piso.
65505>>>>>>>                    If (BtnorddL.Vorderbt=sDeop) Begin
65507>>>>>>>                        Find Lt BtnorddL by index.3
65508>>>>>>>>
65508>>>>>>>                        If  ((Found=1) And (BtnorddL.Vclient_ID=sClient) And (BtnorddL.Vcn_Code=sCN) And  ;                                           (BtnorddL.Vactive   =0)       And (BtnorddL.Vitem=sItem)  And  ;                                           (BtnorddL.Deop_Date>=dStart)) Begin
65510>>>>>>>                            Clear BtnOrddL
65511>>>>>>>                            Append sStr '’¦ œå›¦ª ˜¬«æ ¬§á¨®œ  ©«¦ œ¤œ¨šæ ƒ„Ž ' (Trim(BtnorddL.Vorderbt)) ' £œ ¢ã¥ž ' (String(BtnorddL.Deop_Date))
65515>>>>>>>                            Append sStr '\n† ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ›œ¤ œ§ «¨â§œ«˜  ¡˜  ˜¡¬¨é¤œ«˜ ' //'\n˜«ã©«œ F5 £œ«á «¦ §˜¨æ¤ £ã¤¬£˜.'
65516>>>>>>>                            error 8000 sStr
65517>>>>>>>>
65517>>>>>>>                        End
65517>>>>>>>>
65517>>>>>>>                    End
65517>>>>>>>>
65517>>>>>>>                    Else Begin
65518>>>>>>>                        Clear BtnOrddL
65519>>>>>>>                        Append sStr '’¦ œå›¦ª ˜¬«æ ¬§á¨®œ  ©«¦ œ¤œ¨šæ ƒ„Ž ' (Trim(BtnorddL.Vorderbt)) ' £œ ¢ã¥ž ' (String(BtnorddL.Deop_Date))
65523>>>>>>>                        Append sStr '\n† ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ›œ¤ œ§ «¨â§œ«˜  ¡˜  ˜¡¬¨é¤œ«˜ ' //'\n˜«ã©«œ F5 £œ«á «¦ §˜¨æ¤ £ã¤¬£˜.'
65524>>>>>>>                        error 8000 sStr
65525>>>>>>>>
65525>>>>>>>                    End
65525>>>>>>>>
65525>>>>>>>                End
65525>>>>>>>>
65525>>>>>>>                Clear BtnOrddL
65526>>>>>>>        ///////////////////////////
65526>>>>>>>           End
65526>>>>>>>>
65526>>>>>>>        
65526>>>>>>>           Function_Return iReturnVal
65527>>>>>>>        End_Function   // Validate_Save
65528>>>>>>>        
65528>>>>>>>        Procedure Save_Main_File
65530>>>>>>>            integer ilocked ibtn
65531>>>>>>>            get pibtn to ibtn
65532>>>>>>>            get field_current_value of btnordh_dd field btnordh.locked to ilocked
65533>>>>>>>            If (ilocked=0) Forward Send Save_Main_File
65537>>>>>>>            else if (ilocked=1 and ibtn=1) Forward Send Save_Main_File
65542>>>>>>>            Else Send Info_Box "’¦ ƒ.„.Ž. œå¤˜  ¡¢œ ›à£â¤¦.\nƒœ¤ œ§ «¨â§¦¤«˜  ˜¢¢˜šâª" "¢ž¨¦­¦¨å˜"
65544>>>>>>>        End_Procedure
65545>>>>>>>        
65545>>>>>>>        Procedure Delete_Main_File
65547>>>>>>>            integer ilocked ibtn
65548>>>>>>>            get pibtn to ibtn
65549>>>>>>>            get field_current_value of btnordh_dd field btnordh.locked to ilocked
65550>>>>>>>            If (ilocked=0) Forward Send delete_Main_File
65554>>>>>>>            else if (ilocked=1 and ibtn=1) Forward Send delete_Main_File
65559>>>>>>>            Else Send Info_Box  "’¦ ƒ.„.Ž. œå¤˜  ¡¢œ ›à£â¤¦.\nƒœ¤ œ§ «¨â§¦¤«˜  ˜¢¢˜šâª" "¢ž¨¦­¦¨å˜"
65561>>>>>>>        End_Procedure
65562>>>>>>>        
65562>>>>>>>        
65562>>>>>>>        
65562>>>>>>>        //AB-StoreEnd
65562>>>>>>>
65562>>>>>>>    End_Object    // Btnordd_DD
65563>>>>>>>
65563>>>>>>>    Set Main_DD to (Btnordh_DD(self))
65564>>>>>>>    Set Server to (Btnordh_DD(self))
65565>>>>>>>
65565>>>>>>>    //AB-DDOEnd
65565>>>>>>>
65565>>>>>>>    Object Container1 is a dbContainer3d
65567>>>>>>>        Set Border_Style to Border_Normal
65568>>>>>>>        Set Size to 108 518
65569>>>>>>>        Set Location to 2 4
65570>>>>>>>        Object TextBoxSub5 is a TextBoxSub
65572>>>>>>>            Set Label to "‰à›.œ¢á«ž"
65573>>>>>>>            Set Location to 4 3
65574>>>>>>>            Set Size to 10 45
65575>>>>>>>            Set TypeFace to "MS Sans Serif"
65576>>>>>>>        End_Object    // TextBoxSub5
65577>>>>>>>
65577>>>>>>>        Object TextBoxSub6 is a TextBoxSub
65579>>>>>>>            Set Label to "‰à›.„¨š¦¬"
65580>>>>>>>            Set Location to 18 3
65581>>>>>>>            Set Size to 10 45
65582>>>>>>>            Set TypeFace to "MS Sans Serif"
65583>>>>>>>        End_Object    // TextBoxSub6
65584>>>>>>>
65584>>>>>>>        Object Btnordh_Client_Id is a dbFormSub
65586>>>>>>>            Entry_Item Clients.Client_id
65587>>>>>>>            Set Server to (Tperga_DD(self))
65588>>>>>>>            Set Size to 13 128
65589>>>>>>>            Set Location to 2 63
65590>>>>>>>            Set Label_Col_Offset to 2
65591>>>>>>>            Set Label_Justification_Mode to jMode_Right
65592>>>>>>>            Set Prompt_Button_Mode to pb_PromptOn
65593>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65594>>>>>>>
65594>>>>>>>            //AB-StoreStart
65594>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                    
65594>>>>>>>            Set Prompt_Object to (sl100(Current_object))
65595>>>>>>>            Procedure Prompt_Callback integer hPrompt
65597>>>>>>>                Local String lsValue
65598>>>>>>>                set Export_Column of hPrompt to 0
65599>>>>>>>                Set Initial_Column of hPrompt to 0
65600>>>>>>>            end_procedure
65601>>>>>>>            
65601>>>>>>>            Procedure Prompt
65603>>>>>>>                Set psModule Of (sl100(Self)) to (psModule(v193(Self)))
65604>>>>>>>                Forward Send Prompt
65606>>>>>>>            End_Procedure
65607>>>>>>>            
65607>>>>>>>            Procedure Key Integer iKey
65609>>>>>>>            End_Procedure
65610>>>>>>>            
65610>>>>>>>            
65610>>>>>>>            
65610>>>>>>>            //AB-StoreEnd
65610>>>>>>>
65610>>>>>>>        End_Object    // Btnordh_Client_Id
65611>>>>>>>
65611>>>>>>>        Object Btnordh_Cn_Code is a dbFormSub
65613>>>>>>>            Entry_Item Cn.Cn_code
65614>>>>>>>            Set Server to (Tperga_DD(self))
65615>>>>>>>            Set Size to 13 128
65616>>>>>>>            Set Location to 18 63
65617>>>>>>>            Set Label_Col_Offset to 2
65618>>>>>>>            Set Label_Justification_Mode to jMode_Right
65619>>>>>>>            Set Prompt_Button_Mode to pb_PromptOn
65620>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65621>>>>>>>
65621>>>>>>>            //AB-StoreStart
65621>>>>>>>            Set Prompt_Object to (sl041(Current_object))
65622>>>>>>>            Procedure Prompt_Callback integer hPrompt
65624>>>>>>>                set Export_Column of hPrompt to 0
65625>>>>>>>                Set Initial_Column of hPrompt to 0
65626>>>>>>>            end_procedure
65627>>>>>>>            
65627>>>>>>>            procedure prompt
65629>>>>>>>                string scode
65630>>>>>>>                get value of (btnordh_client_id(container1(self))) to scode
65631>>>>>>>                if (scode<>'') set fragmaclient_id of (sl041(self)) to scode
65634>>>>>>>                forward send prompt
65636>>>>>>>                set fragmaclient_id of (sl041(self)) to ''
65637>>>>>>>            end_procedure
65638>>>>>>>            
65638>>>>>>>            
65638>>>>>>>            Procedure Key Integer iKey
65640>>>>>>>            End_Procedure
65641>>>>>>>            
65641>>>>>>>            //AB-StoreEnd
65641>>>>>>>
65641>>>>>>>        End_Object    // Btnordh_Cn_Code
65642>>>>>>>
65642>>>>>>>        Object TextBoxSub9 is a TextBoxSub
65644>>>>>>>            Set Label to "†£/¤å˜  '„¤˜¨¥žª"
65645>>>>>>>            Set Location to 63 3
65646>>>>>>>            Set Size to 10 57
65647>>>>>>>            Set TypeFace to "MS Sans Serif"
65648>>>>>>>        End_Object    // TextBoxSub9
65649>>>>>>>
65649>>>>>>>        Object Btnordh_Aa_Deop is a dbFormSub
65651>>>>>>>
65651>>>>>>>            //AB-StoreTopStart
65651>>>>>>>                                                                                    
65651>>>>>>>            //AB-StoreTopEnd
65651>>>>>>>
65651>>>>>>>            Entry_Item Btnordh.Aa_deop
65652>>>>>>>            Set Size to 13 128
65653>>>>>>>            Set Location to 47 63
65654>>>>>>>            Set Label_Col_Offset to 2
65655>>>>>>>            Set Label_Justification_Mode to jMode_Right
65656>>>>>>>            Set Prompt_Button_Mode to pb_PromptOn
65657>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65658>>>>>>>
65658>>>>>>>            //AB-StoreStart
65658>>>>>>>                                                                                    
65658>>>>>>>            Set Prompt_Object to (btnordh(Current_object))
65659>>>>>>>            
65659>>>>>>>            Procedure Prompt_Callback integer hPrompt
65661>>>>>>>                Local String lsValue
65662>>>>>>>                set Export_Column of hPrompt to 0
65663>>>>>>>                Set Initial_Column of hPrompt to 0
65664>>>>>>>            end_procedure
65665>>>>>>>            
65665>>>>>>>            Procedure Key Integer iKey
65667>>>>>>>            End_Procedure
65668>>>>>>>            
65668>>>>>>>            Procedure Prompt
65670>>>>>>>                string sid scn
65671>>>>>>>                get value of (btnordh_client_id(container1(self))) to sid
65672>>>>>>>                get value of (btnordh_cn_code(container1(self))) to scn
65673>>>>>>>                if (sid<>'') set psclient of (btnordh(Current_object)) to sid
65676>>>>>>>                if (scn<>'') set pscn of (btnordh(Current_object)) to scn
65679>>>>>>>                Forward Send Prompt
65681>>>>>>>                set psclient of (btnordh(Current_object)) to ''
65682>>>>>>>                set pscn of (btnordh(Current_object)) to ''
65683>>>>>>>            End_Procedure
65684>>>>>>>            
65684>>>>>>>            procedure Refresh Integer iMode
65686>>>>>>>                Forward Send Refresh iMode
65688>>>>>>>                integer irecnum
65689>>>>>>>                get field_current_value of btnordh_dd field btnordh.recnum to irecnum
65690>>>>>>>                Set Enabled_State Of (buttonsub1(container1(self))) to (irecnum=0)
65691>>>>>>>                Set Enabled_State Of (buttonsub3(container1(self))) to (btnordh.locked=0)
65692>>>>>>>                Set Enabled_State Of (btnactive(container1(self)))  to ((btnordh.locked=1) And (btnordh.deop_active=0))
65693>>>>>>>                Set Enabled_State Of (btncopy(container1(self)))    to ((btnordh.locked=1) And (btnordh.deop_active=0))
65694>>>>>>>                set enabled_state of (the_table(self))              to (btnordh.recr<>'')
65695>>>>>>>                set enabled_state of (btnektyp(self))               to (btnordh.recr<>'')
65696>>>>>>>            End_procedure
65697>>>>>>>            
65697>>>>>>>            
65697>>>>>>>            //AB-StoreEnd
65697>>>>>>>
65697>>>>>>>        End_Object    // Btnordh_Aa_Deop
65698>>>>>>>
65698>>>>>>>        Object Btnordh_Deop_Date is a dbFormSub
65700>>>>>>>            Entry_Item Btnordh.Deop_date
65701>>>>>>>            Set Size to 13 62
65702>>>>>>>            Set Location to 62 63
65703>>>>>>>            Set Label_Col_Offset to 2
65704>>>>>>>            Set Label_Justification_Mode to jMode_Right
65705>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65706>>>>>>>        End_Object    // Btnordh_Deop_Date
65707>>>>>>>
65707>>>>>>>        Object Btnordh_Deop_Lhxh is a dbFormSub
65709>>>>>>>            Entry_Item Btnordh.Deop_lhxh
65710>>>>>>>            Set Size to 13 66
65711>>>>>>>            Set Location to 62 183
65712>>>>>>>            Set Label_Col_Offset to 2
65713>>>>>>>            Set Label_Justification_Mode to jMode_Right
65714>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65715>>>>>>>        End_Object    // Btnordh_Deop_Lhxh
65716>>>>>>>
65716>>>>>>>        Object Btnordh_Eleiph is a dbFormSub
65718>>>>>>>            Entry_Item Btnordh.Eleiph
65719>>>>>>>            Set Size to 13 31
65720>>>>>>>            Set Location to 62 434
65721>>>>>>>            Set Label_Col_Offset to 2
65722>>>>>>>            Set Label_Justification_Mode to jMode_Right
65723>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65724>>>>>>>        End_Object    // Btnordh_Eleiph
65725>>>>>>>
65725>>>>>>>        Object Btnordh_Velxr is a dbComboFormSub
65727>>>>>>>            Entry_Item Btnordh.Velxr
65728>>>>>>>            Set Size to 13 41
65729>>>>>>>            Set Location to 61 470
65730>>>>>>>            Set Label_Col_Offset to 2
65731>>>>>>>        End_Object    // Btnordh_Velxr
65732>>>>>>>
65732>>>>>>>        Object ButtonSub1 is a ButtonSub
65734>>>>>>>            Set Label to "ButtonSub2"
65735>>>>>>>            Set Bitmap to "eddoc_m.bmp"
65736>>>>>>>            Set Size to 22 23
65737>>>>>>>            Set Location to 84 2
65738>>>>>>>            Set Focus_Mode to Pointer_Only
65739>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65740>>>>>>>
65740>>>>>>>            //AB-StoreStart
65740>>>>>>>            set tooltipvalue to '€¤¦ š£˜ ¤â¦¬ ƒ.„.Ž.'
65741>>>>>>>            Procedure OnClick
65743>>>>>>>                string sclient scn
65744>>>>>>>                get field_current_value of clients_dd field clients.client_id to sclient
65745>>>>>>>                get field_current_value of cn_dd field cn.cn_code to scn
65746>>>>>>>                if (scn<>'' and sclient<>'') begin
65748>>>>>>>                    set field_changed_value of btnordh_dd field btnordh.aa_deop to 0
65749>>>>>>>                    send request_save to btnordh_dd
65750>>>>>>>                end
65750>>>>>>>>
65750>>>>>>>                else error 3300 'ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã â¨š¦¬'
65752>>>>>>>            End_Procedure // OnClick
65753>>>>>>>            
65753>>>>>>>            
65753>>>>>>>            
65753>>>>>>>            
65753>>>>>>>            
65753>>>>>>>            
65753>>>>>>>            //AB-StoreEnd
65753>>>>>>>
65753>>>>>>>        End_Object    // ButtonSub1
65754>>>>>>>
65754>>>>>>>        Object Btnordh_Deop_Active is a dbCheckBoxSub
65756>>>>>>>            Entry_Item Btnordh.Deop_active
65757>>>>>>>            Set Size to 10 11
65758>>>>>>>            Set Location to 52 266
65759>>>>>>>            Set Enabled_State to FALSE
65760>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
65761>>>>>>>            Set Shadow_State Item 0 to TRUE
65762>>>>>>>        End_Object    // Btnordh_Deop_Active
65763>>>>>>>
65763>>>>>>>        Object Clients_Client_Name is a dbFormSub
65765>>>>>>>            Entry_Item Clients.Client_name
65766>>>>>>>            Set Size to 13 287
65767>>>>>>>            Set Location to 1 197
65768>>>>>>>            Set Color to clBtnFace
65769>>>>>>>            Set Label_Col_Offset to 2
65770>>>>>>>            Set Label_Justification_Mode to jMode_Right
65771>>>>>>>            Set Enabled_State to FALSE
65772>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65773>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
65774>>>>>>>            Set Shadow_State Item 0 to TRUE
65775>>>>>>>        End_Object    // Clients_Client_Name
65776>>>>>>>
65776>>>>>>>        Object Cn_Cn_Descr is a dbFormSub
65778>>>>>>>            Entry_Item Cn.Cn_descr
65779>>>>>>>            Set Size to 13 287
65780>>>>>>>            Set Location to 17 197
65781>>>>>>>            Set Color to clBtnFace
65782>>>>>>>            Set Label_Col_Offset to 2
65783>>>>>>>            Set Label_Justification_Mode to jMode_Right
65784>>>>>>>            Set Enabled_State to FALSE
65785>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65786>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
65787>>>>>>>            Set Shadow_State Item 0 to TRUE
65788>>>>>>>        End_Object    // Cn_Cn_Descr
65789>>>>>>>
65789>>>>>>>        Object Btnordh_Locked is a dbCheckBoxSub
65791>>>>>>>            Entry_Item Btnordh.Locked
65792>>>>>>>            Set Size to 10 13
65793>>>>>>>            Set Location to 65 266
65794>>>>>>>            Set Enabled_State to FALSE
65795>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
65796>>>>>>>            Set Shadow_State Item 0 to TRUE
65797>>>>>>>        End_Object    // Btnordh_Locked
65798>>>>>>>
65798>>>>>>>        Object TextBoxSub10 is a TextBoxSub
65800>>>>>>>            Set Label to "“§œ¬Ÿ.¢ž¨à£é¤"
65801>>>>>>>            Set Location to 33 3
65802>>>>>>>            Set Size to 10 58
65803>>>>>>>            Set TypeFace to "MS Sans Serif"
65804>>>>>>>        End_Object    // TextBoxSub10
65805>>>>>>>
65805>>>>>>>        Object Btnordh_Sxolia is a dbEditSub
65807>>>>>>>            Entry_Item Btnordh.Sxolia
65808>>>>>>>            Set Size to 28 450
65809>>>>>>>            Set Location to 76 63
65810>>>>>>>        End_Object    // Btnordh_Sxolia
65811>>>>>>>
65811>>>>>>>        Object TextBoxSub11 is a TextBoxSub
65813>>>>>>>            Set Label to "‘®æ¢ ˜"
65814>>>>>>>            Set Location to 75 34
65815>>>>>>>            Set Size to 10 26
65816>>>>>>>            Set TypeFace to "MS Sans Serif"
65817>>>>>>>        End_Object    // TextBoxSub11
65818>>>>>>>
65818>>>>>>>        Object Payresp_Presp_Id is a dbFormSub
65820>>>>>>>            Entry_Item Payresp.Presp_id
65821>>>>>>>            Set Size to 13 128
65822>>>>>>>            Set Location to 33 63
65823>>>>>>>            Set Color to clBtnFace
65824>>>>>>>            Set Label_Col_Offset to 2
65825>>>>>>>            Set Label_Justification_Mode to jMode_Right
65826>>>>>>>            Set Enabled_State to FALSE
65827>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65828>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
65829>>>>>>>            Set Shadow_State Item 0 to TRUE
65830>>>>>>>
65830>>>>>>>            //AB-StoreStart
65830>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                    
65830>>>>>>>            //AB-StoreEnd
65830>>>>>>>
65830>>>>>>>        End_Object    // Payresp_Presp_Id
65831>>>>>>>
65831>>>>>>>        Object Payresp_Presp_Name is a dbFormSub
65833>>>>>>>            Entry_Item Payresp.Presp_name
65834>>>>>>>            Set Size to 13 287
65835>>>>>>>            Set Location to 32 197
65836>>>>>>>            Set Color to clBtnFace
65837>>>>>>>            Set Label_Col_Offset to 2
65838>>>>>>>            Set Label_Justification_Mode to jMode_Right
65839>>>>>>>            Set Enabled_State to FALSE
65840>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65841>>>>>>>            Set Item_Shadow_State Item 0 to TRUE
65842>>>>>>>            Set Shadow_State Item 0 to TRUE
65843>>>>>>>        End_Object    // Payresp_Presp_Name
65844>>>>>>>
65844>>>>>>>        Object TextBoxSub12 is a TextBoxSub
65846>>>>>>>            Set Label to "‰à›. ƒ.„.Ž."
65847>>>>>>>            Set Location to 48 3
65848>>>>>>>            Set Size to 10 45
65849>>>>>>>            Set TypeFace to "MS Sans Serif"
65850>>>>>>>        End_Object    // TextBoxSub12
65851>>>>>>>
65851>>>>>>>        Object ButtonSub2 is a ButtonSub
65853>>>>>>>            Set Label to "ButtonSub4"
65854>>>>>>>            Set Bitmap to "AssForm.bmp"
65855>>>>>>>            Set Size to 21 24
65856>>>>>>>            Set Location to 84 29
65857>>>>>>>            Set Focus_Mode to Pointer_Only
65858>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65859>>>>>>>
65859>>>>>>>            //AB-StoreStart
65859>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                        
65859>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ƒ.„.Ž.  œ¢á«ž-„¨š¦¬"
65860>>>>>>>            
65860>>>>>>>            Procedure OnClick
65862>>>>>>>                Integer iRec icheck
65863>>>>>>>                string  sclient scn
65863>>>>>>>                Get Field_Current_Value Of clients_dd Field clients.client_id to sclient
65864>>>>>>>                Get Field_Current_Value Of cn_dd      Field cn.cn_code        to scn
65865>>>>>>>                Set psclient of (v193a(self)) to sclient
65866>>>>>>>                set pscn     of (v193a(self)) to scn
65867>>>>>>>                Send activate_v193a
65868>>>>>>>            End_Procedure // OnClick
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            
65869>>>>>>>            //AB-StoreEnd
65869>>>>>>>
65869>>>>>>>        End_Object    // ButtonSub2
65870>>>>>>>
65870>>>>>>>        Object TextBoxSub13 is a TextBoxSub
65872>>>>>>>            Set Label to "‰¢œ ›à£â¤¦"
65873>>>>>>>            Set Location to 65 277
65874>>>>>>>            Set Size to 10 41
65875>>>>>>>            Set TypeFace to "MS Sans Serif"
65876>>>>>>>        End_Object    // TextBoxSub13
65877>>>>>>>
65877>>>>>>>        Object ButtonSub3 is a ButtonSub
65879>>>>>>>            Set Label to "ButtonSub3"
65880>>>>>>>            Set Bitmap to "autocopen.bmp"
65881>>>>>>>            Set Size to 23 25
65882>>>>>>>            Set Location to 52 320
65883>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65884>>>>>>>
65884>>>>>>>            //AB-StoreStart
65884>>>>>>>            set tooltipvalue to '‰¢œå›à£˜ ƒ.„.Ž.'
65885>>>>>>>            Procedure OnClick
65887>>>>>>>                integer iactive retval irecnum
65888>>>>>>>                string srecr sdeop sitem msgstr scn sclient
65888>>>>>>>                get yesno_box "‡â¢œ«œ §¨˜š£˜« ¡á ¤˜ ¡¢œ ›é©œ  «¦ ƒ.„.Ž. ?? " to retval
65889>>>>>>>                If (RetVal =MBR_yes) begin
65891>>>>>>>                    get field_current_value of btnordh_dd field btnordh.recnum to irecnum
65892>>>>>>>                    if (irecnum) begin
65894>>>>>>>                        send find to btnordd_dd first_record 1
65895>>>>>>>                        if (not(found)) begin
65897>>>>>>>                            error 3003 'ƒœ¤ â®œ«œ §œ¨˜©£â¤˜ œå›ž ©«¦ ƒ.„.Ž.'
65898>>>>>>>>
65898>>>>>>>                            procedure_return
65899>>>>>>>                        end
65899>>>>>>>>
65899>>>>>>>                        set pibtn to 1
65900>>>>>>>                        set field_current_value of btnordh_dd field btnordh.locked to 1
65901>>>>>>>                        begin_transaction
65902>>>>>>>                            indicate err false
65903>>>>>>>                            While (found=1)
65907>>>>>>>                                set field_changed_value of btnordd_dd field btnordd.vactive    to 0
65908>>>>>>>                                send request_save to btnordd_dd
65909>>>>>>>                                send find to btnordd_dd next_record 1
65910>>>>>>>                            loop
65911>>>>>>>>
65911>>>>>>>                            set field_changed_value of btnordh_dd field btnordh.locked to 1
65912>>>>>>>                            set field_changed_value of btnordh_dd field btnordh.deop_active to 0
65913>>>>>>>                            send request_save to btnordh_dd
65914>>>>>>>                        end_transaction
65915>>>>>>>                        send clear to btnordd_dd
65916>>>>>>>                    end
65916>>>>>>>>
65916>>>>>>>                    else error 3004 'ƒœ¤ â®à œ¤œ¨šæ ƒ.„.Ž.'
65918>>>>>>>                    set pibtn to 0
65919>>>>>>>                    Send Find_By_Recnum to btnordh_DD btnordh.File_Number iRecnum
65920>>>>>>>                end
65920>>>>>>>>
65920>>>>>>>            
65920>>>>>>>            End_Procedure // OnClick
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            
65921>>>>>>>            //AB-StoreEnd
65921>>>>>>>
65921>>>>>>>        End_Object    // ButtonSub3
65922>>>>>>>
65922>>>>>>>        Object Btnactive is a ButtonSub
65924>>>>>>>            Set Label to "ButtonSub4"
65925>>>>>>>            Set Bitmap to "delcat_m.bmp"
65926>>>>>>>            Set Size to 23 25
65927>>>>>>>            Set Location to 52 348
65928>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65929>>>>>>>
65929>>>>>>>            //AB-StoreStart
65929>>>>>>>            set tooltipvalue to '€§œ¤œ¨š¦§¦åž©ž ƒ.„.Ž.'
65930>>>>>>>            
65930>>>>>>>            Procedure OnClick
65932>>>>>>>                integer iactive retval irecnum
65933>>>>>>>                string srecr sdeop sitem msgstr scn sclient
65933>>>>>>>                get yesno_box "‡â¢œ«œ §¨˜š£˜« ¡á ¤˜ ˜§œ¤œ¨š¦§¦ žŸã «¦ ƒ.„.Ž. ?? " to retval
65934>>>>>>>                If (RetVal =MBR_yes) begin
65936>>>>>>>                    get field_current_value of btnordh_dd field btnordh.recnum to irecnum
65937>>>>>>>                    if (irecnum) begin
65939>>>>>>>                        send rebuild_constraints to btnordd_dd
65940>>>>>>>                        send find to btnordd_dd first_record 1
65941>>>>>>>                        if (not(found)) begin
65943>>>>>>>                            error 3013 'ƒœ¤ â®œ«œ §œ¨˜©£â¤˜ œå›ž ©«¦ ƒ.„.Ž.'
65944>>>>>>>>
65944>>>>>>>                            procedure_return
65945>>>>>>>                        end
65945>>>>>>>>
65945>>>>>>>                        set pibtn to 1
65946>>>>>>>                        begin_transaction
65947>>>>>>>                            indicate err false
65948>>>>>>>                            set dynamic_update_state of the_table to false
65949>>>>>>>                            While (found=1)
65953>>>>>>>                                set field_changed_value of btnordd_dd field btnordd.vactive to 2
65954>>>>>>>                                send request_save to btnordd_dd
65955>>>>>>>                                send find to btnordd_dd next_record 1
65956>>>>>>>                            loop
65957>>>>>>>>
65957>>>>>>>                            set field_changed_value of btnordh_dd field btnordh.deop_active to 1
65958>>>>>>>                            send request_save to btnordh_dd
65959>>>>>>>                        end_transaction
65960>>>>>>>                        set dynamic_update_state of the_table to true
65961>>>>>>>                        send clear to btnordd_dd
65962>>>>>>>                    end
65962>>>>>>>>
65962>>>>>>>                    else error 3004 'ƒœ¤ â®à œ¤œ¨šæ ƒ.„.Ž.'
65964>>>>>>>                    set pibtn to 0
65965>>>>>>>                    Send Find_By_Recnum to btnordh_DD btnordh.File_Number iRecnum
65966>>>>>>>                end
65966>>>>>>>>
65966>>>>>>>            End_Procedure // OnClick
65967>>>>>>>            
65967>>>>>>>            //AB-StoreEnd
65967>>>>>>>
65967>>>>>>>        End_Object    // Btnactive
65968>>>>>>>
65968>>>>>>>        Object TextBoxSub14 is a TextBoxSub
65970>>>>>>>            Set Label to "€¤œ¤œ¨šæ"
65971>>>>>>>            Set Location to 52 277
65972>>>>>>>            Set Size to 10 37
65973>>>>>>>            Set TypeFace to "MS Sans Serif"
65974>>>>>>>        End_Object    // TextBoxSub14
65975>>>>>>>
65975>>>>>>>        Object Btncopy is a ButtonSub
65977>>>>>>>            Set Label to "ButtonSub4"
65978>>>>>>>            Set Bitmap to "COPY_mg.bmp"
65979>>>>>>>            Set Size to 23 25
65980>>>>>>>            Set Location to 52 375
65981>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
65982>>>>>>>
65982>>>>>>>            //AB-StoreStart
65982>>>>>>>            set tooltipvalue to '€¤« š¨˜­ã ƒ.„.Ž. ©œ á¢¢¦'
65983>>>>>>>            Procedure OnClick
65985>>>>>>>                integer ibpoid retval iakyrh irecnum ifinish
65986>>>>>>>                string msgstr lsstore srecr
65986>>>>>>>                Get Field_Current_Value Of btnordh_dd Field btnordh.recr to srecr
65987>>>>>>>                Get Field_Current_Value Of btnordh_dd Field btnordh.recnum to irecnum
65988>>>>>>>                Get YesNo_Box "¨¦©¦®ã ! €¨®åœ  ž › ˜› ¡˜©å˜ ˜¤« š¨˜­ãª ƒ.„.Ž. Œá ‘¬¤œ®å©à ??"  to RetVal
65989>>>>>>>                If (RetVal =MBR_yes) begin
65991>>>>>>>                    begin_transaction
65992>>>>>>>                        indicate err false
65993>>>>>>>                        move (oDocopy(current_object)) to iBpoid
65994>>>>>>>                        send beg_copy to ibpoid srecr
65995>>>>>>>                    end_transaction
65996>>>>>>>                    if (not(err)) begin
65998>>>>>>>                        get pirecnum to irecnum
65999>>>>>>>                        SEND clear to btnordh_dd
66000>>>>>>>                        Send Find_By_Recnum to btnordh_DD btnordh.File_Number iRecnum
66001>>>>>>>                        send beginning_of_data to the_table true
66002>>>>>>>                    end
66002>>>>>>>>
66002>>>>>>>                    else send info_box '‘ž£œ éŸž¡œ ¢áŸ¦ª ¡˜«á «ž¤ ˜¤« š¨˜­ã.ƒ ˜› ¡˜©å˜ ˜¡¬¨éŸž¡œ' '¢ž¨¦­¦¨å˜'
66004>>>>>>>                end
66004>>>>>>>>
66004>>>>>>>            End_Procedure // OnClick
66005>>>>>>>            
66005>>>>>>>            
66005>>>>>>>            //AB-StoreEnd
66005>>>>>>>
66005>>>>>>>        End_Object    // Btncopy
66006>>>>>>>
66006>>>>>>>        Object TextBoxSub15 is a TextBoxSub
66008>>>>>>>            Set Label to "†£/¤å˜  Šã¥žª"
66009>>>>>>>            Set Location to 62 131
66010>>>>>>>            Set Size to 12 49
66011>>>>>>>            Set TypeFace to "MS Sans Serif"
66012>>>>>>>        End_Object    // TextBoxSub15
66013>>>>>>>
66013>>>>>>>        Object Textbox1 is a Textbox
66015>>>>>>>            Set Label to "‘«˜Ÿœ¨æ«ž«˜"
66016>>>>>>>            Set Location to 48 211
66017>>>>>>>            Set Size to 10 53
66018>>>>>>>            Set TypeFace to "MS Sans Serif"
66019>>>>>>>        End_Object    // Textbox1
66020>>>>>>>
66020>>>>>>>        Object Textbox2 is a Textbox
66022>>>>>>>            Set Label to "„¢¢œ §âª ­¦¨«å¦"
66023>>>>>>>            Set Location to 50 437
66024>>>>>>>            Set Size to 10 60
66025>>>>>>>            Set FontWeight to 600
66026>>>>>>>            Set TypeFace to "MS Sans Serif"
66027>>>>>>>        End_Object    // Textbox2
66028>>>>>>>
66028>>>>>>>        Object Btnordh_Statero is a dbCheckBoxSub
66030>>>>>>>            Entry_Item Btnordh.Statero
66031>>>>>>>            Set Size to 13 11
66032>>>>>>>            Set Location to 46 197
66033>>>>>>>        End_Object    // Btnordh_Statero
66034>>>>>>>
66034>>>>>>>        Object ButtonSub4 is a ButtonSub
66036>>>>>>>            Set Label to "ButtonSub6"
66037>>>>>>>            Set Bitmap to "tvwbo16.bmp"
66038>>>>>>>            Set Size to 10 11
66039>>>>>>>            Set Location to 2 487
66040>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
66041>>>>>>>
66041>>>>>>>            //AB-StoreStart
66041>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ ©žª œ¢˜«é¤"
66042>>>>>>>            Procedure OnClick
66044>>>>>>>               send activate_vwclients
66045>>>>>>>            End_Procedure // OnClick
66046>>>>>>>            
66046>>>>>>>            
66046>>>>>>>            
66046>>>>>>>            
66046>>>>>>>            //AB-StoreEnd
66046>>>>>>>
66046>>>>>>>        End_Object    // ButtonSub4
66047>>>>>>>
66047>>>>>>>        Object ButtonSub5 is a ButtonSub
66049>>>>>>>            Set Label to "ButtonSub6"
66050>>>>>>>            Set Bitmap to "tvwbo16.bmp"
66051>>>>>>>            Set Size to 10 11
66052>>>>>>>            Set Location to 17 487
66053>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
66054>>>>>>>
66054>>>>>>>            //AB-StoreStart
66054>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ž©žª „¨šà¤"
66055>>>>>>>            Procedure OnClick
66057>>>>>>>               send activate_v041
66058>>>>>>>            End_Procedure // OnClick
66059>>>>>>>            
66059>>>>>>>            
66059>>>>>>>            
66059>>>>>>>            
66059>>>>>>>            
66059>>>>>>>            
66059>>>>>>>            //AB-StoreEnd
66059>>>>>>>
66059>>>>>>>        End_Object    // ButtonSub5
66060>>>>>>>
66060>>>>>>>        Object Btnektyp is a ButtonSub
66062>>>>>>>
66062>>>>>>>            //AB-StoreTopStart
66062>>>>>>>                                                                                                                
66062>>>>>>>            //AB-StoreTopEnd
66062>>>>>>>
66062>>>>>>>            Set Label to "ButtonSub6"
66063>>>>>>>            Set Bitmap to "Printer.bmp"
66064>>>>>>>            Set Size to 23 25
66065>>>>>>>            Set Location to 52 404
66066>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
66067>>>>>>>
66067>>>>>>>            //AB-StoreStart
66067>>>>>>>                                                                                                                
66067>>>>>>>            Set TooltipValue to "„¡«ç§à©ž ƒ.„.Ž."
66068>>>>>>>            
66068>>>>>>>            Procedure OnClick
66070>>>>>>>                string sdeop
66071>>>>>>>                Get Field_Current_Value Of btnordh_DD Field btnordh.aa_deop to sdeop
66072>>>>>>>                Set psdeop  of (r193_1(self)) to sdeop
66073>>>>>>>                Send runprom1Report to (prom1WQLReport(r193_1(Self)))
66074>>>>>>>            End_Procedure // OnClick
66075>>>>>>>            
66075>>>>>>>            //AB-StoreEnd
66075>>>>>>>
66075>>>>>>>        End_Object    // Btnektyp
66076>>>>>>>
66076>>>>>>>        Object ButtonSub6 is a ButtonSub
66078>>>>>>>            Set Label to "ButtonSub6"
66079>>>>>>>            Set Bitmap to "tvwbo16.bmp"
66080>>>>>>>            Set Size to 10 11
66081>>>>>>>            Set Location to 33 487
66082>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
66083>>>>>>>
66083>>>>>>>            //AB-StoreStart
66083>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ž©žª “§. ¢ž¨à£ãª"
66084>>>>>>>            Procedure OnClick
66086>>>>>>>               send activate_v111
66087>>>>>>>            End_Procedure // OnClick
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            
66088>>>>>>>            //AB-StoreEnd
66088>>>>>>>
66088>>>>>>>        End_Object    // ButtonSub6
66089>>>>>>>
66089>>>>>>>    End_Object    // Container1
66090>>>>>>>
66090>>>>>>>    Object The_Table is a dbGrid
66092>>>>>>>        Set Main_File to Btnordd.File_Number
66093>>>>>>>        Set Server to (Btnordd_DD(self))
66094>>>>>>>        Set Ordering to 1
66095>>>>>>>        Set Size to 95 524
66096>>>>>>>        Set Location to 124 1
66097>>>>>>>        Set Wrap_State to TRUE
66098>>>>>>>
66098>>>>>>>        Begin_Row
66101>>>>>>>            Entry_Item Btnordd.Recnum
66102>>>>>>>            Entry_Item Btnordd.Vitem
66103>>>>>>>            Entry_Item (fsqual(self,btnordd.vitem))
66104>>>>>>>            Entry_Item Btnordd.Vqty
66105>>>>>>>            Entry_Item Btnordd.Vunitprice
66106>>>>>>>            Entry_Item Btnordd.Vdisc
66107>>>>>>>            Entry_Item Btnordd.Vdiscposo
66108>>>>>>>            Entry_Item Btnordd.Vprice
66109>>>>>>>            Entry_Item Btnordd.Vkatish
66110>>>>>>>            Entry_Item Btnordd.Vxrm3
66111>>>>>>>            Entry_Item Btnordd.Vpagiaxrm3
66112>>>>>>>            Entry_Item Btnordd.Vpagiaxrprice
66113>>>>>>>        End_Row
66118>>>>>>>
66118>>>>>>>        Set Form_Width    item 0 to 0
66119>>>>>>>        Set Header_Label  item 0 to ""
66120>>>>>>>        
66120>>>>>>>        Set Form_Width    item 1 to 62
66121>>>>>>>        Set Header_Label  item 1 to "‰à›.„å›¦¬ª"
66122>>>>>>>        
66122>>>>>>>        Set Form_Width    item 2 to 65
66123>>>>>>>        Set Header_Label  item 2 to "¦ æ«ž«˜"
66124>>>>>>>        
66124>>>>>>>        Set Form_Width    item 3 to 43
66125>>>>>>>        Set Header_Label  item 3 to "¦©æ«ž«˜"
66126>>>>>>>        
66126>>>>>>>        Set Form_Width    item 4 to 46
66127>>>>>>>        Set Header_Label  item 4 to "’ £ã ‹¦¤"
66128>>>>>>>        
66128>>>>>>>        Set Form_Width    item 5 to 35
66129>>>>>>>        Set Header_Label  item 5 to "%„¡§«"
66130>>>>>>>        
66130>>>>>>>        Set Form_Width    item 6 to 42
66131>>>>>>>        Set Header_Label  item 6 to "„¡§«à©ž"
66132>>>>>>>        
66132>>>>>>>        Set Form_Width    item 7 to 50
66133>>>>>>>        Set Header_Label  item 7 to "€¥å˜"
66134>>>>>>>        
66134>>>>>>>        Set Form_Width    item 8 to 43
66135>>>>>>>        Set Header_Label  item 8 to "‰áŸ ©ž"
66136>>>>>>>        
66136>>>>>>>        Set Form_Width    item 9 to 32
66137>>>>>>>        Set Header_Label  item 9 to "•¨/m3"
66138>>>>>>>        Set Column_Checkbox_State  item 9 to True
66139>>>>>>>        
66139>>>>>>>        Set Form_Width    item 10 to 50
66140>>>>>>>        Set Header_Label  item 10 to "˜š.•¨/m3"
66141>>>>>>>        
66141>>>>>>>        Set Form_Width    item 11 to 51
66142>>>>>>>        Set Header_Label  item 11 to "˜š.’ £ã •¨."
66143>>>>>>>        
66143>>>>>>>
66143>>>>>>>        //AB-StoreStart
66143>>>>>>>                        
66143>>>>>>>        Set Column_Prompt_Object item 1 to (sl22s(self))
66144>>>>>>>        
66144>>>>>>>        Set Column_Option Item 0        to NoEnter True
66145>>>>>>>        Set Column_Option Item 7        to NoEnter True
66146>>>>>>>        
66146>>>>>>>        Set CurrentRowColor             to 11468799
66147>>>>>>>        Set CurrentCellColor            to 11468799
66148>>>>>>>        
66148>>>>>>>        
66148>>>>>>>        procedure item_change integer fromi integer toi returns integer
66150>>>>>>>            local integer rval icol iBase_item iGridID iCurrItem iFileNumber iFieldNumber
66151>>>>>>>            Local String Sval sQUAL svalue sNameFrom
66151>>>>>>>            local integer iColumn
66151>>>>>>>            local number nTimhMon  ndisc ntot
66151>>>>>>>            move (the_table(self)) to igridid
66152>>>>>>>            forward get msg_item_change fromi toi to rval
66154>>>>>>>            if (focus(Desktop) = igridid) begin
66156>>>>>>>                Get Column fromi to iCol
66157>>>>>>>                if (icol=1) begin
66159>>>>>>>                    Get Base_Item                   to iBase_item
66160>>>>>>>                    Get Value Item (iBase_item+1)   to Sval
66161>>>>>>>                    Move (Fsitem(self,Sval))        to Svalue
66162>>>>>>>                    move (Fsqual(self,Sval))        to Squal
66163>>>>>>>                    Set value item (iBase_item+2)   to squal
66164>>>>>>>                    Set value of (item_descr(self)) to svalue
66165>>>>>>>                End
66165>>>>>>>>
66165>>>>>>>                Else if (icol=5) begin
66168>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vdisc  To ndisc
66169>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vunitprice To nTimhMon
66170>>>>>>>                    move (round_number(((ntimhmon * ndisc) / 100),2)) to ntot
66171>>>>>>>                    // js 04/11/2002
66171>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.Vdiscposo To nTot
66172>>>>>>>                    //
66172>>>>>>>                    move (ntimhmon - ntot) to ntimhmon
66173>>>>>>>                    //Set Field_Current_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
66173>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
66174>>>>>>>                End
66174>>>>>>>>
66174>>>>>>>                Else if (icol=6) begin
66177>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vdiscposo  To ndisc
66178>>>>>>>                    Get Field_Current_Value Of btnordd_DD Field btnordd.vunitprice To nTimhMon
66179>>>>>>>                    move (round_number(((nDisc*100)/nTimhMon),2)) to ntot
66180>>>>>>>                    //Set Field_Current_Value Of btnordd_DD Field btnordd.Vdisc To nTot
66180>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.Vdisc To nTot
66181>>>>>>>                    move (ntimhmon - nDisc) to ntimhmon
66182>>>>>>>                    //Set Field_Current_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
66182>>>>>>>                    Set Field_Changed_Value Of btnordd_DD Field btnordd.vprice To ntimhmon
66183>>>>>>>                End
66183>>>>>>>>
66183>>>>>>>            End
66183>>>>>>>>
66183>>>>>>>            procedure_return rval
66184>>>>>>>        end_procedure
66185>>>>>>>        
66185>>>>>>>        Procedure End_Construct_Object
66187>>>>>>>            Integer iDecimals
66188>>>>>>>            Forward Send End_Construct_Object
66190>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
66191>>>>>>>            Set Points Item 3 to 2
66192>>>>>>>            Set Points Item 4 to iDecimals
66193>>>>>>>            Set Points Item 5 to 2
66194>>>>>>>            Set Points Item 6 to iDecimals
66195>>>>>>>            Set Points Item 7 to iDecimals
66196>>>>>>>            Set Points Item 10 to iDecimals
66197>>>>>>>            Set Points Item 11 to iDecimals
66198>>>>>>>            Set Numeric_Mask  Item 4 to 14 iDecimals ' ,*'
66199>>>>>>>            Set Numeric_Mask  Item 6 to 14 iDecimals ' ,*'
66200>>>>>>>            Set Numeric_Mask  Item 7 to 14 iDecimals ' ,*'
66201>>>>>>>            Set Numeric_Mask  Item 10 to 14 iDecimals ' ,*'
66202>>>>>>>            Set Numeric_Mask  Item 11 to 14 iDecimals ' ,*'
66203>>>>>>>        End_Procedure
66204>>>>>>>        
66204>>>>>>>        Function Child_entering returns Integer
66206>>>>>>>            Integer rval
66207>>>>>>>            Forward Get Child_Entering to rVal
66209>>>>>>>            If (NOT(rVal)) Begin
66211>>>>>>>                If (Should_Save(btnordh_DD(Self))) Send Request_Save to btnordh_DD
66214>>>>>>>                If (Current_Record(btnordh_DD(Self))) Forward Get Child_Entering to rVal
66218>>>>>>>                Else Begin
66219>>>>>>>                    Function_Return 1
66220>>>>>>>                End
66220>>>>>>>>
66220>>>>>>>            End
66220>>>>>>>>
66220>>>>>>>            function_return rVal
66221>>>>>>>        End_Function
66222>>>>>>>        
66222>>>>>>>        //AB-StoreEnd
66222>>>>>>>
66222>>>>>>>    End_Object    // The_Table
66223>>>>>>>
66223>>>>>>>    Object TextBoxSub7 is a TextBoxSub
66225>>>>>>>        Set Label to "œ›å˜ š ˜ ®¨ã©ž €¤«¢å˜ª"
66226>>>>>>>        Set Color to clNavy
66227>>>>>>>        Set TextColor to clYellow
66228>>>>>>>        Set Location to 111 305
66229>>>>>>>        Set Size to 10 179
66230>>>>>>>        Set FontWeight to 600
66231>>>>>>>        Set Justification_Mode to jMode_Center
66232>>>>>>>        Set TypeFace to "MS Sans Serif"
66233>>>>>>>    End_Object    // TextBoxSub7
66234>>>>>>>
66234>>>>>>>    Object TextBoxSub8 is a TextBoxSub
66236>>>>>>>        Set Label to "œ¨ š¨˜­ã „å›¦¬ª"
66237>>>>>>>        Set Location to 221 3
66238>>>>>>>        Set Size to 10 65
66239>>>>>>>        Set FontWeight to 600
66240>>>>>>>        Set TypeFace to "MS Sans Serif"
66241>>>>>>>    End_Object    // TextBoxSub8
66242>>>>>>>
66242>>>>>>>    Object item_descr is a FormSub
66244>>>>>>>        Set Size to 13 117
66245>>>>>>>        Set Location to 220 82
66246>>>>>>>        Set Color to clBtnFace
66247>>>>>>>        Set Label_Col_Offset to 2
66248>>>>>>>        Set Enabled_State to FALSE
66249>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66250>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
66251>>>>>>>        Set Shadow_State Item 0 to TRUE
66252>>>>>>>
66252>>>>>>>        //AB-StoreStart
66252>>>>>>>                                                                                                                                                                                                                                                                                    
66252>>>>>>>                                                                                                                                                                                                                                                                                    
66252>>>>>>>                                                                                                                                                                                                                                                                                    
66252>>>>>>>        //AB-StoreEnd
66252>>>>>>>
66252>>>>>>>    End_Object    // item_descr
66253>>>>>>>
66253>>>>>>>    Object TextBoxSub17 is a TextBoxSub
66255>>>>>>>        Set Label to "ƒž£ ¦¬¨šãŸž¡œ"
66256>>>>>>>        Set Location to 237 4
66257>>>>>>>        Set Size to 10 51
66258>>>>>>>        Set TypeFace to "MS Sans Serif"
66259>>>>>>>    End_Object    // TextBoxSub17
66260>>>>>>>
66260>>>>>>>    Object Btnordh_Date_Create is a dbFormSub
66262>>>>>>>        Entry_Item Btnordh.Date_create
66263>>>>>>>        Set Size to 13 57
66264>>>>>>>        Set Location to 235 82
66265>>>>>>>        Set Color to clBtnFace
66266>>>>>>>        Set Label_Col_Offset to 2
66267>>>>>>>        Set Label_Justification_Mode to jMode_Right
66268>>>>>>>        Set Enabled_State to FALSE
66269>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66270>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
66271>>>>>>>        Set Shadow_State Item 0 to TRUE
66272>>>>>>>    End_Object    // Btnordh_Date_Create
66273>>>>>>>
66273>>>>>>>    Object Tperga_ is a dbGridSub
66275>>>>>>>        Set Main_File to Tperga.File_Number
66276>>>>>>>        Set Server to (Tperga_DD(self))
66277>>>>>>>        Set Size to 48 319
66278>>>>>>>        Set Location to 221 204
66279>>>>>>>        Set Wrap_State to TRUE
66280>>>>>>>
66280>>>>>>>        Begin_Row
66283>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
66284>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
66285>>>>>>>            Entry_Item Tperga.Pct_epi_synolou
66286>>>>>>>            Entry_Item Tperga.Paralabh_meres
66287>>>>>>>            Entry_Item Tperga.Xarhtos_meres
66288>>>>>>>            Entry_Item Tperga.Plhroteo_meres
66289>>>>>>>        End_Row
66294>>>>>>>
66294>>>>>>>        Set Form_Width    item 0 to 36
66295>>>>>>>        Set Header_Label  item 0 to "‰à›."
66296>>>>>>>        
66296>>>>>>>        Set Form_Width    item 1 to 79
66297>>>>>>>        Set Header_Label  item 1 to "’¨æ§¦ª"
66298>>>>>>>        
66298>>>>>>>        Set Form_Width    item 2 to 47
66299>>>>>>>        Set Header_Label  item 2 to "% ‘¬¤æ¢¦¬"
66300>>>>>>>        
66300>>>>>>>        Set Form_Width    item 3 to 55
66301>>>>>>>        Set Header_Label  item 3 to "˜¨˜¢˜™ã (‹)"
66302>>>>>>>        
66302>>>>>>>        Set Form_Width    item 4 to 57
66303>>>>>>>        Set Header_Label  item 4 to "†£. ’ £/©žª"
66304>>>>>>>        
66304>>>>>>>        Set Form_Width    item 5 to 39
66305>>>>>>>        Set Header_Label  item 5 to "¢ž¨. (‹)"
66306>>>>>>>        
66306>>>>>>>
66306>>>>>>>        //AB-StoreStart
66306>>>>>>>                                                                                                                                                                                                                                                                                    
66306>>>>>>>                                                                                                                                                                                                                                                                                    
66306>>>>>>>        Set Column_Option Item 1        to NoEnter True
66307>>>>>>>        
66307>>>>>>>        Function Child_entering returns Integer
66309>>>>>>>            Integer rval iErr
66310>>>>>>>            Forward Get Child_Entering to rVal
66312>>>>>>>            If (NOT(rVal)) Begin
66314>>>>>>>                If (Current_Record(BtnOrdH_DD(Self))) Forward Get Child_Entering to rVal
66318>>>>>>>                Else Begin
66319>>>>>>>                    Function_Return 1
66320>>>>>>>                End
66320>>>>>>>>
66320>>>>>>>            End
66320>>>>>>>>
66320>>>>>>>            function_return rVal
66321>>>>>>>        End_Function
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        
66322>>>>>>>        //AB-StoreEnd
66322>>>>>>>
66322>>>>>>>    End_Object    // Tperga_
66323>>>>>>>
66323>>>>>>>    Object TextBoxSub18 is a TextBoxSub
66325>>>>>>>        Set Label to "’¨æ§¦  ¢ž¨à£ãª "
66326>>>>>>>        Set Location to 237 143
66327>>>>>>>        Set Size to 10 59
66328>>>>>>>        Set TypeFace to "MS Sans Serif"
66329>>>>>>>    End_Object    // TextBoxSub18
66330>>>>>>>
66330>>>>>>>    Object TextBoxSub19 is a TextBoxSub
66332>>>>>>>        Set Label to "‘«æ®¦ª †‘Ž"
66333>>>>>>>        Set Location to 252 4
66334>>>>>>>        Set Size to 10 47
66335>>>>>>>        Set TypeFace to "MS Sans Serif"
66336>>>>>>>    End_Object    // TextBoxSub19
66337>>>>>>>
66337>>>>>>>    Object Clients_Hpso is a dbFormSub
66339>>>>>>>        Entry_Item Clients.Hpso
66340>>>>>>>        Set Size to 13 30
66341>>>>>>>        Set Location to 250 82
66342>>>>>>>        Set Label_Col_Offset to 2
66343>>>>>>>        Set Label_Justification_Mode to jMode_Right
66344>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66345>>>>>>>
66345>>>>>>>        //AB-StoreStart
66345>>>>>>>        set enabled_state to false
66346>>>>>>>        //AB-StoreEnd
66346>>>>>>>
66346>>>>>>>    End_Object    // Clients_Hpso
66347>>>>>>>
66347>>>>>>>    Object TextBoxSub20 is a TextBoxSub
66349>>>>>>>        Set Label to "‘«æ®¦ª †€Š "
66350>>>>>>>        Set Location to 252 117
66351>>>>>>>        Set Size to 10 46
66352>>>>>>>        Set TypeFace to "MS Sans Serif"
66353>>>>>>>    End_Object    // TextBoxSub20
66354>>>>>>>
66354>>>>>>>    Object Clients_Hpal is a dbFormSub
66356>>>>>>>        Entry_Item Clients.Hpal
66357>>>>>>>        Set Size to 13 30
66358>>>>>>>        Set Location to 250 168
66359>>>>>>>        Set Label_Col_Offset to 2
66360>>>>>>>        Set Label_Justification_Mode to jMode_Right
66361>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66362>>>>>>>
66362>>>>>>>        //AB-StoreStart
66362>>>>>>>        set enabled_state to false
66363>>>>>>>        //AB-StoreEnd
66363>>>>>>>
66363>>>>>>>    End_Object    // Clients_Hpal
66364>>>>>>>
66364>>>>>>>
66364>>>>>>>    //AB-StoreStart
66364>>>>>>>    set verify_data_loss_msg    to get_no_confirmation
66365>>>>>>>    set verify_save_msg         to get_no_confirmation
66366>>>>>>>    set verify_exit_msg         to get_no_confirmation
66367>>>>>>>    On_Key Key_Alt+Key_o        Send activate_v193v
66368>>>>>>>    
66368>>>>>>>    Procedure Activate
66370>>>>>>>        String  sModule
66371>>>>>>>        Integer rVal iCurRec irecnum
66371>>>>>>>        if (pscncode(self)<>'') begin
66373>>>>>>>           send clear to cn_dd
66374>>>>>>>           send clear to btnordh_dd
66375>>>>>>>           send clear to btnordd_dd
66376>>>>>>>           send clear to tperga_dd
66377>>>>>>>           move (pscncode(self)) to cn.cn_code
66378>>>>>>>           send find to cn_dd eq 5
66379>>>>>>>        end
66379>>>>>>>>
66379>>>>>>>        set pscncode   to ''
66380>>>>>>>    
66380>>>>>>>        if (psdeop(self)<>'') begin
66382>>>>>>>            Clear btnordh
66383>>>>>>>            Move (psdeop(self)) to btnordh.aa_deop
66384>>>>>>>            Find Eq btnordh by index.1
66385>>>>>>>>
66385>>>>>>>            send find to btnordh_dd eq 1
66386>>>>>>>        end
66386>>>>>>>>
66386>>>>>>>        set psdeop to ''
66387>>>>>>>        Forward Send Activate
66389>>>>>>>    
66389>>>>>>>    End_Procedure
66390>>>>>>>    
66390>>>>>>>    Procedure Activate_View Returns Integer
66392>>>>>>>        String  sModule
66393>>>>>>>        Integer rVal iCurRec
66393>>>>>>>        Forward Get Msg_Activate_View to rVal
66395>>>>>>>     //   Get psMenuModule  Of Main_Menu  to sModule
66395>>>>>>>        Set psModule to sModule
66396>>>>>>>        Procedure_Return rVal
66397>>>>>>>    End_Procedure
66398>>>>>>>    
66398>>>>>>>    
66398>>>>>>>    
66398>>>>>>>    
66398>>>>>>>    
66398>>>>>>>    //AB-StoreEnd
66398>>>>>>>
66398>>>>>>>End_Object    // V193
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>//AB-StoreStart
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>
66399>>>>>>>//AB-StoreEnd
66399>>>>>>>
66399>>>>>>>//AB/ End_Object    // prj
66399>>>>>use v197.vw
66399>>>>>use v198.vw
66399>>>>>use sl002.sl
66399>>>>>use vwclients.vw
66399>>>>>use sl108.sl
66399>>>>>open iteml
66401>>>>>Open BranchL
INCLUDING FILE: BRANCHL.FD
66403>>>>>//AB-StoreTopEnd
66403>>>>>
66403>>>>>//AB-IgnoreStart
66403>>>>>
66403>>>>>Use dbView.Sub
66403>>>>>Use DFAllEnt.pkg
66403>>>>>Use dbCmbfrm.Sub
66403>>>>>Use dbChkbox.Sub
66403>>>>>Use dbForm.Sub
66403>>>>>Use Txtbox.Sub
66403>>>>>Use dbTabdlg.Sub
66403>>>>>Use Button.Sub
66403>>>>>Use dbGrid.Sub
66403>>>>>Use dbEdit.Sub
66403>>>>>Use Form.Sub
66403>>>>>
66403>>>>>Use COMPANY.DD
66403>>>>>Use BRANCH.DD
66403>>>>>Use BAXIOKAT.DD
66403>>>>>Use COUNTRY.DD
66403>>>>>Use TOWNS.DD
66403>>>>>Use CITIES.DD
66403>>>>>Use AREAS.DD
66403>>>>>Use PAYRESP.DD
66403>>>>>Use CLIENTS.DD
66403>>>>>Use CONSTRCT.DD
66403>>>>>Use SALESMEN.DD
66403>>>>>Use MHXANIK.DD
66403>>>>>Use CN.DD
66403>>>>>Use ZONES.DD
66403>>>>>Use BRZONES.DD
INCLUDING FILE: BRZONES.DD
66403>>>>>>>//DDB-FileStart
66403>>>>>>>//DDB-HeaderStart
66403>>>>>>>
66403>>>>>>>// File Name : BRZONES.DD
66403>>>>>>>// Class Name: BrZones_DataDictionary
66403>>>>>>>// Revision  : 7
66403>>>>>>>// Version   : 2
66403>>>>>>>
66403>>>>>>>Use  Windows           // Basic Definitions
66403>>>>>>>Use  DataDict          // DataDictionary Class Definition
66403>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
66403>>>>>>>
66403>>>>>>>Open Brzones
66405>>>>>>>Open Cnzones
66407>>>>>>>Open Branch
66409>>>>>>>Open Zones
66411>>>>>>>Open Sysrecc
66413>>>>>>>
66413>>>>>>>//DDB-HeaderEnd
66413>>>>>>>//DDB-SelectionStart
66413>>>>>>>//DDB/ ExternalSelectionList sl065  sl065.SL
66413>>>>>>>Register_Object sl065
66413>>>>>>>//DDB-SelectionEnd
66413>>>>>>>
66413>>>>>>>Class BrZones_DataDictionary  is a DataDictionary_Sec
66414>>>>>>>
66414>>>>>>>    Procedure Update
66415>>>>>>>        Forward Send Update
66417>>>>>>>        // Insert Code Here
66417>>>>>>>        Move Branch.Beto_Site   to BrZones.Beto_Site
66418>>>>>>>    End_Procedure   // Update
66419>>>>>>>
66419>>>>>>>    Procedure Creating
66420>>>>>>>        Forward Send Creating
66422>>>>>>>        // Insert Code Here
66422>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                        (Trim(String(BrZones.BrZones_Rec0)))))) to BrZones.BrZone_Recr
66423>>>>>>>    End_Procedure   // Creating
66424>>>>>>>
66424>>>>>>>
66424>>>>>>>    // Define_Fields:
66424>>>>>>>    // This procedure is used to set up all data-dictionary rules.
66424>>>>>>>
66424>>>>>>>    Procedure Define_Fields
66425>>>>>>>        Forward Send Define_Fields
66427>>>>>>>        //DDB-Generated-Code-Location
66427>>>>>>>        //DDB-DefineFieldStart
66427>>>>>>>
66427>>>>>>>        Set Main_File            To Brzones.File_Number
66428>>>>>>>        Set Cascade_Delete_State To FALSE
66429>>>>>>>
66429>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
66430>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
66431>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
66432>>>>>>>
66432>>>>>>>        // Child (Client) file structure................
66432>>>>>>>        Send Add_Client_File  Cnzones.File_Number
66433>>>>>>>
66433>>>>>>>        // Parent (Server) file structure...............
66433>>>>>>>        Send Add_Server_File  Branch.File_Number
66434>>>>>>>        Send Add_Server_File  Zones.File_Number
66435>>>>>>>
66435>>>>>>>        // External (System) file structure.............
66435>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
66436>>>>>>>
66436>>>>>>>        Define_Auto_Increment  Sysrecc.Brzone_Rec0  To Brzones.Brzones_Rec0
66439>>>>>>>
66439>>>>>>>        // Field-based properties.......................
66439>>>>>>>
66439>>>>>>>        // Brzones.Branch_Recr
66439>>>>>>>
66439>>>>>>>        // Brzones.Zone_Id
66439>>>>>>>        Set Field_Options          Field Brzones.Zone_Id To DD_AUTOFIND   
66440>>>>>>>
66440>>>>>>>        // Brzones.Brzones_Rec0
66440>>>>>>>        Set Field_Options          Field Brzones.Brzones_Rec0 To DD_AUTOFIND   
66441>>>>>>>
66441>>>>>>>        // Brzones.Brzone_Recr
66441>>>>>>>        Set Field_Prompt_Object    Field Brzones.Brzone_Recr To (sl065(Self))
66442>>>>>>>
66442>>>>>>>        // Brzones.Beto_Site
66442>>>>>>>
66442>>>>>>>        // Brzones.Zone_Km
66442>>>>>>>
66442>>>>>>>        // Brzones.Zone_Charge0
66442>>>>>>>
66442>>>>>>>        // Brzones.Zone_Charge1
66442>>>>>>>
66442>>>>>>>        // Brzones.Zone_Charge2
66442>>>>>>>
66442>>>>>>>        //DDB-DefineFieldEnd
66442>>>>>>>    End_Procedure    // Define_Fields
66443>>>>>>>
66443>>>>>>>    // Field_Defaults:
66443>>>>>>>    // This procedure is used to establish default field values.
66443>>>>>>>
66443>>>>>>>    Procedure Field_Defaults
66444>>>>>>>        Forward Send Field_Defaults
66446>>>>>>>        //DDB-Generated-Code-Location
66446>>>>>>>        //DDB-FieldDefaultStart
66446>>>>>>>        //DDB-FieldDefaultEnd
66446>>>>>>>    End_Procedure    // Field_Defaults
66447>>>>>>>
66447>>>>>>>End_Class    // Brzones_DataDictionary
66448>>>>>>>//DDB-Selection-pkg-Start
66448>>>>>>>
66448>>>>>>>Use sl065.SL         // sl065
INCLUDING FILE: SL065.SL
66448>>>>>>>>>//AB/ Project sl065 : Zones ana Xrhsh
66448>>>>>>>>>//AB/     Object prj is a Lookup_Project
66448>>>>>>>>>//AB/         Set ProjectName to "sl065 : Zones ana Xrhsh"
66448>>>>>>>>>//AB/         Set ProjectFileName to "sl065.SL"
66448>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
66448>>>>>>>>>
66448>>>>>>>>>// Project Object Structure
66448>>>>>>>>>//   sl065 is a dbModalPanelSub
66448>>>>>>>>>//     Company_DD is a DataDictionary
66448>>>>>>>>>//     Branch_DD is a DataDictionary
66448>>>>>>>>>//     Zones_DD is a DataDictionary
66448>>>>>>>>>//     Brzones_DD is a DataDictionary
66448>>>>>>>>>//     oSelList is a dbListSub
66448>>>>>>>>>//     oOK_bn is a ButtonSub
66448>>>>>>>>>//     oCancel_bn is a ButtonSub
66448>>>>>>>>>//     oSearch_bn is a ButtonSub
66448>>>>>>>>>
66448>>>>>>>>>// Register all objects
66448>>>>>>>>>Register_Object Branch_DD
66448>>>>>>>>>Register_Object Brzones_DD
66448>>>>>>>>>Register_Object Company_DD
66448>>>>>>>>>Register_Object oCancel_bn
66448>>>>>>>>>Register_Object oOK_bn
66448>>>>>>>>>Register_Object oSearch_bn
66448>>>>>>>>>Register_Object oSelList
66448>>>>>>>>>Register_Object sl065
66448>>>>>>>>>Register_Object Zones_DD
66448>>>>>>>>>
66448>>>>>>>>>
66448>>>>>>>>>    //AB-IgnoreStart
66448>>>>>>>>>
66448>>>>>>>>>    Use DFAllEnt.pkg
66448>>>>>>>>>    Use dbList.Sub
66448>>>>>>>>>    Use Button.Sub
66448>>>>>>>>>
66448>>>>>>>>>
66448>>>>>>>>>    Use COMPANY.DD
66448>>>>>>>>>    Use BRANCH.DD
66448>>>>>>>>>    Use ZONES.DD
66448>>>>>>>>>    Use BRZONES.DD
66448>>>>>>>>>    
66448>>>>>>>>>    //AB-IgnoreEnd
66448>>>>>>>>>
66448>>>>>>>>>    Object sl065 is a dbModalPanelSub
66450>>>>>>>>>        Set Label to "…é¤œª ˜¤˜ ¬§¦¡˜«á©«ž£˜"
66451>>>>>>>>>        Set Size to 146 515
66452>>>>>>>>>        Set Location to 4 3
66453>>>>>>>>>        Set Exit_Application_Local_State to FALSE
66454>>>>>>>>>        Set Modal_State to FALSE
66455>>>>>>>>>
66455>>>>>>>>>        //AB-DDOStart
66455>>>>>>>>>
66455>>>>>>>>>        Object Company_DD is a Company_DataDictionary
66457>>>>>>>>>        End_Object    // Company_DD
66458>>>>>>>>>
66458>>>>>>>>>        Object Branch_DD is a Branch_DataDictionary
66460>>>>>>>>>            Set DDO_Server to (Company_DD(self))
66461>>>>>>>>>        End_Object    // Branch_DD
66462>>>>>>>>>
66462>>>>>>>>>        Object Zones_DD is a Zones_DataDictionary
66464>>>>>>>>>        End_Object    // Zones_DD
66465>>>>>>>>>
66465>>>>>>>>>        Object Brzones_DD is a BrZones_DataDictionary
66467>>>>>>>>>            Set DDO_Server to (Branch_DD(self))
66468>>>>>>>>>            Set DDO_Server to (Zones_DD(self))
66469>>>>>>>>>        End_Object    // Brzones_DD
66470>>>>>>>>>
66470>>>>>>>>>        Set Main_DD to (Brzones_DD(self))
66471>>>>>>>>>        Set Server to (Brzones_DD(self))
66472>>>>>>>>>
66472>>>>>>>>>        //AB-DDOEnd
66472>>>>>>>>>
66472>>>>>>>>>        Object oSelList is a dbListSub
66474>>>>>>>>>            Set Main_File to Brzones.File_Number
66475>>>>>>>>>            Set Server to (Company_DD(self))
66476>>>>>>>>>            Set Size to 105 501
66477>>>>>>>>>            Set Location to 6 6
66478>>>>>>>>>
66478>>>>>>>>>            Begin_Row
66481>>>>>>>>>                Entry_Item Company.Company_name
66482>>>>>>>>>                Entry_Item Branch.Branch_name
66483>>>>>>>>>                Entry_Item Zones.Zone_id
66484>>>>>>>>>                Entry_Item Zones.Zone_descr
66485>>>>>>>>>                Entry_Item Brzones.Beto_site
66486>>>>>>>>>                Entry_Item Brzones.Zone_km
66487>>>>>>>>>                Entry_Item Brzones.Zone_charge0
66488>>>>>>>>>                Entry_Item Brzones.Zone_charge1
66489>>>>>>>>>                Entry_Item Brzones.Zone_charge2
66490>>>>>>>>>            End_Row
66495>>>>>>>>>
66495>>>>>>>>>            Set Form_Width    item 0 to 61
66496>>>>>>>>>            Set Header_Label  item 0 to "„«˜ ¨å˜"
66497>>>>>>>>>            
66497>>>>>>>>>            Set Form_Width    item 1 to 61
66498>>>>>>>>>            Set Header_Label  item 1 to "“§¦¡˜«/£˜"
66499>>>>>>>>>            
66499>>>>>>>>>            Set Form_Width    item 2 to 34
66500>>>>>>>>>            Set Header_Label  item 2 to "…é¤ž"
66501>>>>>>>>>            
66501>>>>>>>>>            Set Form_Width    item 3 to 107
66502>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã"
66503>>>>>>>>>            
66503>>>>>>>>>            Set Form_Width    item 4 to 42
66504>>>>>>>>>            Set Header_Label  item 4 to "Beto Site"
66505>>>>>>>>>            
66505>>>>>>>>>            Set Form_Width    item 5 to 48
66506>>>>>>>>>            Set Header_Label  item 5 to "•¢£"
66507>>>>>>>>>            
66507>>>>>>>>>            Set Form_Width    item 6 to 48
66508>>>>>>>>>            Set Header_Label  item 6 to "•¨âà©ž 0"
66509>>>>>>>>>            
66509>>>>>>>>>            Set Form_Width    item 7 to 48
66510>>>>>>>>>            Set Header_Label  item 7 to "•¨âà©ž 1"
66511>>>>>>>>>            
66511>>>>>>>>>            Set Form_Width    item 8 to 48
66512>>>>>>>>>            Set Header_Label  item 8 to "•¨âà©ž 2"
66513>>>>>>>>>            
66513>>>>>>>>>        End_Object    // oSelList
66514>>>>>>>>>
66514>>>>>>>>>        Object oOK_bn is a ButtonSub
66516>>>>>>>>>            Set Label to "&„§ ¢¦šã"
66517>>>>>>>>>            Set Location to 112 348
66518>>>>>>>>>
66518>>>>>>>>>            //AB-StoreStart
66518>>>>>>>>>            Procedure OnClick
66520>>>>>>>>>                Send OK To (oSelList(current_object))
66521>>>>>>>>>            End_Procedure
66522>>>>>>>>>            //AB-StoreEnd
66522>>>>>>>>>
66522>>>>>>>>>        End_Object    // oOK_bn
66523>>>>>>>>>
66523>>>>>>>>>        Object oCancel_bn is a ButtonSub
66525>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
66526>>>>>>>>>            Set Location to 112 403
66527>>>>>>>>>
66527>>>>>>>>>            //AB-StoreStart
66527>>>>>>>>>            Procedure OnClick
66529>>>>>>>>>                Send Cancel To (oSelList(current_object))
66530>>>>>>>>>            End_Procedure
66531>>>>>>>>>            //AB-StoreEnd
66531>>>>>>>>>
66531>>>>>>>>>        End_Object    // oCancel_bn
66532>>>>>>>>>
66532>>>>>>>>>        Object oSearch_bn is a ButtonSub
66534>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
66535>>>>>>>>>            Set Location to 112 458
66536>>>>>>>>>
66536>>>>>>>>>            //AB-StoreStart
66536>>>>>>>>>            Procedure OnClick
66538>>>>>>>>>                Send Search To (oSelList(current_object))
66539>>>>>>>>>            End_Procedure
66540>>>>>>>>>            //AB-StoreEnd
66540>>>>>>>>>
66540>>>>>>>>>        End_Object    // oSearch_bn
66541>>>>>>>>>
66541>>>>>>>>>
66541>>>>>>>>>        //AB-StoreStart
66541>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
66542>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
66543>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
66544>>>>>>>>>        //AB-StoreEnd
66544>>>>>>>>>
66544>>>>>>>>>    End_Object    // sl065
66545>>>>>>>>>
66545>>>>>>>>>//AB/     End_Object    // prj
66545>>>>>>>
66545>>>>>>>//DDB-Selection-pkg-End
66545>>>>>>>//DDB-FileEnd
66545>>>>>Use CNZONES.DD
INCLUDING FILE: CNZONES.DD
66545>>>>>>>//DDB-FileStart
66545>>>>>>>//DDB-HeaderStart
66545>>>>>>>
66545>>>>>>>// File Name : CNZONES.DD
66545>>>>>>>// Class Name: Cnzones_DataDictionary
66545>>>>>>>// Revision  : 8
66545>>>>>>>// Version   : 2
66545>>>>>>>
66545>>>>>>>Use  Windows           // Basic Definitions
66545>>>>>>>Use  DataDict          // DataDictionary Class Definition
66545>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
66545>>>>>>>
66545>>>>>>>Open Cnzones
66547>>>>>>>Open Cn
66549>>>>>>>Open Brzones
66551>>>>>>>Open Sysrecc
66553>>>>>>>
66553>>>>>>>//DDB-HeaderEnd
66553>>>>>>>
66553>>>>>>>Class Cnzones_DataDictionary  is a DataDictionary_Sec
66554>>>>>>> 
66554>>>>>>>    Procedure Save_Main_File
66555>>>>>>>        If (Operation_Origin<>Self) Begin
66557>>>>>>>            If CnZones.Recnum Eq 0 Procedure_Return
66560>>>>>>>        End
66560>>>>>>>>
66560>>>>>>>        If ((Trim(Cn.Cn_Code         )='') Or ;            (Trim(BrZones.BrZone_Recr)='') Or ;            (CnZones.Cnzone_Rec0      = 0)) Error 1150 '† œšš¨˜­ã œå¤˜  ¡œ¤ã. ƒœ¤ ¡˜«˜®à¨œå«˜ '
66563>>>>>>>        Forward Send Save_Main_File
66565>>>>>>>    End_Procedure
66566>>>>>>> 
66566>>>>>>>    Procedure Update
66567>>>>>>>        Forward Send Update
66569>>>>>>>        // Insert Code Here
66569>>>>>>>        Move Branch.Beto_Site   to CnZones.Beto_Site_3
66570>>>>>>>        Move Branch.Branch_Recr to CnZones.Branch_Recr
66571>>>>>>>        Move Zones.Zone_ID      to CnZones.Zone_ID
66572>>>>>>>    End_Procedure   // Update
66573>>>>>>>
66573>>>>>>>    Procedure Creating
66574>>>>>>>        Forward Send Creating
66576>>>>>>>        // Insert Code Here
66576>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Cnzones.Cnzone_Rec0))))));                        to Cnzones.Cnzone_Recr
66577>>>>>>>    End_Procedure   // Creating
66578>>>>>>>
66578>>>>>>>
66578>>>>>>>    // Define_Fields:
66578>>>>>>>    // This procedure is used to set up all data-dictionary rules.
66578>>>>>>>
66578>>>>>>>    Procedure Define_Fields
66579>>>>>>>        Forward Send Define_Fields
66581>>>>>>>        //DDB-Generated-Code-Location
66581>>>>>>>        //DDB-DefineFieldStart
66581>>>>>>>
66581>>>>>>>        Set Main_File            To Cnzones.File_Number
66582>>>>>>>
66582>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
66583>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
66584>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
66585>>>>>>>
66585>>>>>>>        // Parent (Server) file structure...............
66585>>>>>>>        Send Add_Server_File  Cn.File_Number
66586>>>>>>>        Send Add_Server_File  Brzones.File_Number
66587>>>>>>>
66587>>>>>>>        // External (System) file structure.............
66587>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
66588>>>>>>>
66588>>>>>>>        Define_Auto_Increment  Sysrecc.Cnzone_Rec0  To Cnzones.Cnzone_Rec0
66591>>>>>>>
66591>>>>>>>        // Field-based properties.......................
66591>>>>>>>
66591>>>>>>>        // Cnzones.Cn_Code
66591>>>>>>>
66591>>>>>>>        // Cnzones.Brzone_Recr
66591>>>>>>>        Set Field_Options          Field Cnzones.Brzone_Recr To DD_AUTOFIND   
66592>>>>>>>
66592>>>>>>>        // Cnzones.Cnzone_Rec0
66592>>>>>>>
66592>>>>>>>        // Cnzones.Cnzone_Recr
66592>>>>>>>
66592>>>>>>>        // Cnzones.Branch_Recr
66592>>>>>>>
66592>>>>>>>        // Cnzones.Beto_Site_3
66592>>>>>>>
66592>>>>>>>        // Cnzones.Zone_Id
66592>>>>>>>
66592>>>>>>>        //DDB-DefineFieldEnd
66592>>>>>>>    End_Procedure    // Define_Fields
66593>>>>>>>
66593>>>>>>>    // Field_Defaults:
66593>>>>>>>    // This procedure is used to establish default field values.
66593>>>>>>>
66593>>>>>>>    Procedure Field_Defaults
66594>>>>>>>        Forward Send Field_Defaults
66596>>>>>>>        //DDB-Generated-Code-Location
66596>>>>>>>        //DDB-FieldDefaultStart
66596>>>>>>>        //DDB-FieldDefaultEnd
66596>>>>>>>    End_Procedure    // Field_Defaults
66597>>>>>>>
66597>>>>>>>End_Class    // Cnzones_DataDictionary
66598>>>>>>>//DDB-FileEnd
66598>>>>>Use TPERGA.DD
66598>>>>>Use BTNORDH.DD
66598>>>>>Use BTNORDD.DD
66598>>>>>
66598>>>>>//AB-IgnoreEnd
66598>>>>>
66598>>>>>ACTIVATE_VIEW Activate_V041 FOR V041
66602>>>>>
66602>>>>>Object V041 is a dbViewSub
66604>>>>>
66604>>>>>    //AB-StoreTopStart
66604>>>>>    property string constraint_val public ''
66606>>>>>    property integer pieidos       public 0
66608>>>>>    property string pscncode       public ''
66610>>>>>    function fsqual string code returns string
66612>>>>>         string squal
66613>>>>>         clear iteml
66614>>>>>         move code to iteml.item_code
66615>>>>>         find eq iteml by index.5
66616>>>>>>
66616>>>>>         move iteml.item_qual to squal
66617>>>>>         function_return squal
66618>>>>>    end_Function
66619>>>>>    
66619>>>>>    //AB-StoreTopEnd
66619>>>>>
66619>>>>>    Set Label to "‹ž«¨é¦ ë¨šà¤ "
66620>>>>>    Set Size to 282 513
66621>>>>>    Set Location to 2 5
66622>>>>>
66622>>>>>    //AB-DDOStart
66622>>>>>
66622>>>>>    Object Company_DD is a Company_DataDictionary
66624>>>>>
66624>>>>>        //AB-StoreStart
66624>>>>>        Set Read_Only_State to True
66625>>>>>        
66625>>>>>        //AB-StoreEnd
66625>>>>>
66625>>>>>    End_Object    // Company_DD
66626>>>>>
66626>>>>>    Object Branch_DD is a Branch_DataDictionary
66628>>>>>        Set DDO_Server to (Company_DD(self))
66629>>>>>
66629>>>>>        //AB-StoreStart
66629>>>>>                                                                                                                                                                                                                                                                                            
66629>>>>>        Set Read_Only_State to True
66630>>>>>        
66630>>>>>        //AB-StoreEnd
66630>>>>>
66630>>>>>    End_Object    // Branch_DD
66631>>>>>
66631>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
66633>>>>>
66633>>>>>        //AB-StoreStart
66633>>>>>        Set Read_Only_State to True
66634>>>>>        
66634>>>>>        //AB-StoreEnd
66634>>>>>
66634>>>>>    End_Object    // Baxiokat_DD
66635>>>>>
66635>>>>>    Object Country_DD is a Country_DataDictionary
66637>>>>>
66637>>>>>        //AB-StoreStart
66637>>>>>        Set Read_Only_State to True
66638>>>>>        
66638>>>>>        //AB-StoreEnd
66638>>>>>
66638>>>>>    End_Object    // Country_DD
66639>>>>>
66639>>>>>    Object Towns_DD is a Towns_DataDictionary
66641>>>>>        Set DDO_Server to (Country_DD(self))
66642>>>>>
66642>>>>>        //AB-StoreStart
66642>>>>>        Set Read_Only_State to True
66643>>>>>        
66643>>>>>        //AB-StoreEnd
66643>>>>>
66643>>>>>    End_Object    // Towns_DD
66644>>>>>
66644>>>>>    Object Cities_DD is a Cities_DataDictionary
66646>>>>>        Set DDO_Server to (Towns_DD(self))
66647>>>>>
66647>>>>>        //AB-StoreStart
66647>>>>>        Set Read_Only_State to True
66648>>>>>        
66648>>>>>        //AB-StoreEnd
66648>>>>>
66648>>>>>    End_Object    // Cities_DD
66649>>>>>
66649>>>>>    Object Areas_DD is a Areas_DataDictionary
66651>>>>>
66651>>>>>        //AB-StoreStart
66651>>>>>        Set Read_Only_State to True
66652>>>>>        
66652>>>>>        //AB-StoreEnd
66652>>>>>
66652>>>>>    End_Object    // Areas_DD
66653>>>>>
66653>>>>>    Object Payresp_DD is a Payresp_DataDictionary
66655>>>>>
66655>>>>>        //AB-StoreStart
66655>>>>>                                                                                                                                                                                                                                                                                            
66655>>>>>        Set piCheckPlaf to True
66656>>>>>        
66656>>>>>        Set Read_Only_State to True
66657>>>>>        
66657>>>>>        //AB-StoreEnd
66657>>>>>
66657>>>>>    End_Object    // Payresp_DD
66658>>>>>
66658>>>>>    Object Clients_DD is a Clients_DataDictionary
66660>>>>>        Set DDO_Server to (Cities_DD(self))
66661>>>>>        Set DDO_Server to (Areas_DD(self))
66662>>>>>        Set DDO_Server to (Payresp_DD(self))
66663>>>>>
66663>>>>>        //AB-StoreStart
66663>>>>>                                                                                                                                                                                                                                                                                            
66663>>>>>        Set piCheckPlaf to True
66664>>>>>        
66664>>>>>        Set Read_Only_State to True
66665>>>>>        
66665>>>>>        
66665>>>>>        //AB-StoreEnd
66665>>>>>
66665>>>>>    End_Object    // Clients_DD
66666>>>>>
66666>>>>>    Object Constrct_DD is a Constrct_DataDictionary
66668>>>>>
66668>>>>>        //AB-StoreStart
66668>>>>>        Set Read_Only_State to True
66669>>>>>        
66669>>>>>        //AB-StoreEnd
66669>>>>>
66669>>>>>    End_Object    // Constrct_DD
66670>>>>>
66670>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
66672>>>>>
66672>>>>>        //AB-StoreStart
66672>>>>>        Set Read_Only_State to True
66673>>>>>        
66673>>>>>        //AB-StoreEnd
66673>>>>>
66673>>>>>    End_Object    // Salesmen_DD
66674>>>>>
66674>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
66676>>>>>
66676>>>>>        //AB-StoreStart
66676>>>>>        Set Read_Only_State to True
66677>>>>>        
66677>>>>>        //AB-StoreEnd
66677>>>>>
66677>>>>>    End_Object    // Mhxanik_DD
66678>>>>>
66678>>>>>    Object Cn_DD is a Cn_DataDictionary
66680>>>>>
66680>>>>>        //AB-StoreTopStart
66680>>>>>        Property Integer piNomosID  Public 0
66682>>>>>        Property Integer piXoraID   Public 0
66684>>>>>        
66684>>>>>        //AB-StoreTopEnd
66684>>>>>
66684>>>>>        Set DDO_Server to (Clients_DD(self))
66685>>>>>        Set DDO_Server to (Constrct_DD(self))
66686>>>>>        Set DDO_Server to (Salesmen_DD(self))
66687>>>>>        Set DDO_Server to (Mhxanik_DD(self))
66688>>>>>
66688>>>>>        //AB-StoreStart
66688>>>>>                                                                                                                                                                                                                                                                                            
66688>>>>>        Procedure Save_Main_File
66690>>>>>            Move (piNomosID(Self))  to Cn.Cn_Nomos
66691>>>>>            Move (piXoraID(Self))   to Cn.Cn_Xora
66692>>>>>            If (cn.cn_end_date <> '') move 'F' to cn.cn_active
66695>>>>>            else                      move 'A' to cn.cn_active
66697>>>>>            Forward Send Save_Main_File
66699>>>>>        End_Procedure
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        
66700>>>>>        //AB-StoreEnd
66700>>>>>
66700>>>>>    End_Object    // Cn_DD
66701>>>>>
66701>>>>>    Object Zones_DD is a Zones_DataDictionary
66703>>>>>
66703>>>>>        //AB-StoreStart
66703>>>>>        Set Read_Only_State to True
66704>>>>>        
66704>>>>>        //AB-StoreEnd
66704>>>>>
66704>>>>>    End_Object    // Zones_DD
66705>>>>>
66705>>>>>    Object Brzones_DD is a BrZones_DataDictionary
66707>>>>>        Set DDO_Server to (Branch_DD(self))
66708>>>>>        Set DDO_Server to (Zones_DD(self))
66709>>>>>
66709>>>>>        //AB-StoreStart
66709>>>>>        Set Read_Only_State to True
66710>>>>>        
66710>>>>>        //AB-StoreEnd
66710>>>>>
66710>>>>>    End_Object    // Brzones_DD
66711>>>>>
66711>>>>>    Object Cnzones_DD is a Cnzones_DataDictionary
66713>>>>>        Set DDO_Server to (Brzones_DD(self))
66714>>>>>        Set DDO_Server to (Cn_DD(self))
66715>>>>>        Set Constrain_File to Cn.File_Number
66716>>>>>
66716>>>>>        //AB-StoreStart
66716>>>>>                                                                                                                                                                                                                                                                                                        
66716>>>>>        //AB-StoreEnd
66716>>>>>
66716>>>>>    End_Object    // Cnzones_DD
66717>>>>>
66717>>>>>    Object Tperga_DD is a Tperga_DataDictionary
66719>>>>>        Set DDO_Server to (Cn_DD(self))
66720>>>>>        Set DDO_Server to (Baxiokat_DD(self))
66721>>>>>        Set Constrain_File to Cn.File_Number
66722>>>>>    End_Object    // Tperga_DD
66723>>>>>
66723>>>>>    Object Btnordh_DD is a Btnordh_DataDictionary
66725>>>>>        Set DDO_Server to (Cn_DD(self))
66726>>>>>        Set Constrain_File to Cn.File_Number
66727>>>>>    End_Object    // Btnordh_DD
66728>>>>>
66728>>>>>    Object Btnordd_DD is a Btnordd_DataDictionary
66730>>>>>        Set DDO_Server to (Btnordh_DD(self))
66731>>>>>        Set Constrain_File to Btnordh.File_Number
66732>>>>>    End_Object    // Btnordd_DD
66733>>>>>
66733>>>>>    Set Main_DD to (Cn_DD(self))
66734>>>>>    Set Server to (Cn_DD(self))
66735>>>>>
66735>>>>>    //AB-DDOEnd
66735>>>>>
66735>>>>>    Object cn_cn_code is a dbForm
66737>>>>>        Entry_Item Cn.Cn_code
66738>>>>>        Set Size to 13 92
66739>>>>>        Set Location to 4 61
66740>>>>>        Set Label_Col_Offset to 2
66741>>>>>        Set Label_Justification_Mode to jMode_Right
66742>>>>>
66742>>>>>        //AB-StoreStart
66742>>>>>        Set Prompt_Object to (sl041(Current_object))
66743>>>>>        
66743>>>>>        Procedure Prompt_Callback integer hPrompt
66745>>>>>            Local String lsValue
66746>>>>>            set Export_Column of hPrompt to 1
66747>>>>>            Set Initial_Column of hPrompt to 1
66748>>>>>        end_procedure
66749>>>>>        
66749>>>>>        procedure prompt
66751>>>>>            string sclient
66752>>>>>            get value of (clients_client_id(self)) to sclient
66753>>>>>            set fragmaclient_id of (sl041(self)) to sclient
66754>>>>>            forward send prompt
66756>>>>>            set fragmaclient_id of (sl041(self)) to ''
66757>>>>>        end_procedure
66758>>>>>        
66758>>>>>        procedure onchange
66760>>>>>            set enabled_state of (btnpartl(dbtabpagesub1(dbtabdialogsub1(self))));                to ((cn.cn_code<>'') and (constrct.cnt_id<>'') and (salesmen.sls_id<>'') and (mhxanik.mhx_id<>''))
66761>>>>>        end_procedure
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        
66762>>>>>        //AB-StoreEnd
66762>>>>>
66762>>>>>    End_Object    // cn_cn_code
66763>>>>>
66763>>>>>    Object Cn_Eidos_Cn is a dbComboFormSub
66765>>>>>        Entry_Item Cn.Eidos_cn
66766>>>>>        Set Size to 13 232
66767>>>>>        Set Location to 4 268
66768>>>>>        Set Label_Col_Offset to 2
66769>>>>>    End_Object    // Cn_Eidos_Cn
66770>>>>>
66770>>>>>    Object Cn_Cn_Active is a dbCheckBoxSub
66772>>>>>        Entry_Item Cn.Cn_active
66773>>>>>        Set Size to 10 11
66774>>>>>        Set Location to 6 157
66775>>>>>
66775>>>>>        //AB-StoreStart
66775>>>>>        set enabled_state to false
66776>>>>>        //AB-StoreEnd
66776>>>>>
66776>>>>>    End_Object    // Cn_Cn_Active
66777>>>>>
66777>>>>>    Object Clients_Client_name is a dbForm
66779>>>>>        Entry_Item Cn.Cn_descr
66780>>>>>        Set Size to 13 440
66781>>>>>        Set Location to 20 61
66782>>>>>        Set Label_Col_Offset to 2
66783>>>>>        Set Label_Justification_Mode to jMode_Right
66784>>>>>    End_Object    // Clients_Client_name
66785>>>>>
66785>>>>>    Object Clients_Client_Adress is a dbFormSub
66787>>>>>        Entry_Item Cn.Cn_address
66788>>>>>        Set Size to 13 333
66789>>>>>        Set Location to 34 61
66790>>>>>        Set Label_Col_Offset to 2
66791>>>>>        Set Label_Justification_Mode to jMode_Right
66792>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66793>>>>>    End_Object    // Clients_Client_Adress
66794>>>>>
66794>>>>>    Object Clients_Client_Add_No is a dbFormSub
66796>>>>>        Entry_Item Cn.Cn_add_no
66797>>>>>        Set Size to 13 51
66798>>>>>        Set Location to 34 449
66799>>>>>        Set Label_Col_Offset to 2
66800>>>>>        Set Label_Justification_Mode to jMode_Right
66801>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66802>>>>>    End_Object    // Clients_Client_Add_No
66803>>>>>
66803>>>>>    Object Clients_Client_Zipcode is a dbFormSub
66805>>>>>        Entry_Item Cn.Cn_zipcode
66806>>>>>        Set Size to 13 92
66807>>>>>        Set Location to 49 61
66808>>>>>        Set Label_Col_Offset to 2
66809>>>>>        Set Label_Justification_Mode to jMode_Right
66810>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66811>>>>>    End_Object    // Clients_Client_Zipcode
66812>>>>>
66812>>>>>    Object Cn_Cn_Area is a dbFormSub
66814>>>>>        Entry_Item Cn.Cn_area
66815>>>>>        Set Size to 13 65
66816>>>>>        Set Location to 50 252
66817>>>>>        Set Label_Col_Offset to 2
66818>>>>>        Set Label_Justification_Mode to jMode_Right
66819>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66820>>>>>
66820>>>>>        //AB-StoreStart
66820>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
66820>>>>>        Procedure OnChange
66822>>>>>            Integer iVal
66823>>>>>            Get Field_Current_Value Of CN_DD Field CN.CN_Area to iVal
66824>>>>>            Set Value Of frmAreaDescr Item 0 to (fsAreaDescr(iVal))
66825>>>>>        End_Procedure
66826>>>>>        
66826>>>>>        
66826>>>>>        
66826>>>>>        
66826>>>>>        
66826>>>>>        //AB-StoreEnd
66826>>>>>
66826>>>>>    End_Object    // Cn_Cn_Area
66827>>>>>
66827>>>>>    Object Cn_Cn_city is a dbFormSub
66829>>>>>        Entry_Item Cn.Cn_city
66830>>>>>        Set Size to 13 37
66831>>>>>        Set Location to 63 61
66832>>>>>        Set Label_Col_Offset to 2
66833>>>>>        Set Label_Justification_Mode to jMode_Right
66834>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66835>>>>>
66835>>>>>        //AB-StoreStart
66835>>>>>                                                                                                                                                    
66835>>>>>        Procedure OnChange
66837>>>>>            Integer iVal
66838>>>>>            Get Field_Current_Value Of CN_DD Field CN.CN_City to iVal
66839>>>>>            Set Value Of frmCityDescr Item 0 to (fsCityDescr(iVal))
66840>>>>>            Move (fiTownIDFromCity(iVal)) to ival
66841>>>>>            Set Field_Current_Value Of CN_DD Field CN.CN_Nomos to iVal
66842>>>>>            Set piNomosID Of Cn_DD to iVal
66843>>>>>            Set Value Of frmTownDescr Item 0 to (fsTownDescr(iVal))
66844>>>>>            Move (fiCountryIDFromTown(iVal)) to ival
66845>>>>>            Set Field_Current_Value Of CN_DD Field CN.CN_Xora to iVal
66846>>>>>            Set piXoraID Of Cn_DD to iVal
66847>>>>>            Set Value Of frmCountryDescr Item 0 to (fsCountryDescr(iVal))
66848>>>>>        End_Procedure
66849>>>>>        
66849>>>>>        //AB-StoreEnd
66849>>>>>
66849>>>>>    End_Object    // Cn_Cn_city
66850>>>>>
66850>>>>>    Object TextBoxSub5 is a TextBoxSub
66852>>>>>        Set Label to "’.‰."
66853>>>>>        Set Location to 49 5
66854>>>>>        Set Size to 10 16
66855>>>>>        Set TypeFace to "MS Sans Serif"
66856>>>>>    End_Object    // TextBoxSub5
66857>>>>>
66857>>>>>    Object TextBoxSub6 is a TextBoxSub
66859>>>>>        Set Label to "ƒ œçŸ¬¤©ž"
66860>>>>>        Set Location to 36 5
66861>>>>>        Set Size to 10 41
66862>>>>>        Set TypeFace to "MS Sans Serif"
66863>>>>>    End_Object    // TextBoxSub6
66864>>>>>
66864>>>>>    Object TextBoxSub7 is a TextBoxSub
66866>>>>>        Set Label to "‰à› ¡æª"
66867>>>>>        Set Location to 4 5
66868>>>>>        Set Size to 10 35
66869>>>>>        Set TypeFace to "MS Sans Serif"
66870>>>>>    End_Object    // TextBoxSub7
66871>>>>>
66871>>>>>    Object TextBoxSub8 is a TextBoxSub
66873>>>>>        Set Label to "œ¨ š¨˜­ã"
66874>>>>>        Set Location to 20 5
66875>>>>>        Set Size to 10 43
66876>>>>>        Set TypeFace to "MS Sans Serif"
66877>>>>>    End_Object    // TextBoxSub8
66878>>>>>
66878>>>>>    Object TextBoxSub9 is a TextBoxSub
66880>>>>>        Set Label to "æ¢ž"
66881>>>>>        Set Location to 63 5
66882>>>>>        Set Size to 10 31
66883>>>>>        Set TypeFace to "MS Sans Serif"
66884>>>>>    End_Object    // TextBoxSub9
66885>>>>>
66885>>>>>    Object TextBoxSub11 is a TextBoxSub
66887>>>>>        Set Label to "€¨ Ÿ£æª"
66888>>>>>        Set Location to 36 403
66889>>>>>        Set Size to 10 32
66890>>>>>        Set TypeFace to "MS Sans Serif"
66891>>>>>    End_Object    // TextBoxSub11
66892>>>>>
66892>>>>>    Object Cn_Cn_Nomos is a dbFormSub
66894>>>>>        Entry_Item Cn.Cn_nomos
66895>>>>>        Set Size to 13 65
66896>>>>>        Set Location to 63 252
66897>>>>>        Set Color to clBtnFace
66898>>>>>        Set Label_Col_Offset to 2
66899>>>>>        Set Label_Justification_Mode to jMode_Right
66900>>>>>        Set Enabled_State to FALSE
66901>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66902>>>>>        Set Item_Shadow_State Item 0 to TRUE
66903>>>>>        Set Shadow_State Item 0 to TRUE
66904>>>>>    End_Object    // Cn_Cn_Nomos
66905>>>>>
66905>>>>>    Object Cn_Cn_Xora is a dbFormSub
66907>>>>>        Entry_Item Cn.Cn_xora
66908>>>>>        Set Size to 13 37
66909>>>>>        Set Location to 78 61
66910>>>>>        Set Color to clBtnFace
66911>>>>>        Set Label_Col_Offset to 2
66912>>>>>        Set Label_Justification_Mode to jMode_Right
66913>>>>>        Set Enabled_State to FALSE
66914>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66915>>>>>        Set Item_Shadow_State Item 0 to TRUE
66916>>>>>        Set Shadow_State Item 0 to TRUE
66917>>>>>    End_Object    // Cn_Cn_Xora
66918>>>>>
66918>>>>>    Object Cn_Cn_Categfpa is a dbComboFormSub
66920>>>>>        Entry_Item Cn.Cn_categfpa
66921>>>>>        Set Size to 13 65
66922>>>>>        Set Location to 76 252
66923>>>>>        Set Label_Col_Offset to 2
66924>>>>>        Set Label_Justification_Mode to jMode_Right
66925>>>>>    End_Object    // Cn_Cn_Categfpa
66926>>>>>
66926>>>>>    Object Cn_Cn_Phone is a dbFormSub
66928>>>>>        Entry_Item Cn.Cn_phone
66929>>>>>        Set Size to 13 257
66930>>>>>        Set Location to 92 61
66931>>>>>        Set Label_Col_Offset to 2
66932>>>>>        Set Label_Justification_Mode to jMode_Right
66933>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66934>>>>>    End_Object    // Cn_Cn_Phone
66935>>>>>
66935>>>>>    Object Clients_Client_Id is a dbFormSub
66937>>>>>        Entry_Item Clients.Client_id
66938>>>>>        Set Size to 13 112
66939>>>>>        Set Location to 106 61
66940>>>>>        Set Label_Col_Offset to 2
66941>>>>>        Set Label_Justification_Mode to jMode_Right
66942>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66943>>>>>
66943>>>>>        //AB-StoreStart
66943>>>>>        Procedure Prompt
66945>>>>>            Set psModule Of (sl100(Self)) to '01'
66946>>>>>            Forward Send Prompt
66948>>>>>        End_Procedure
66949>>>>>        //AB-StoreEnd
66949>>>>>
66949>>>>>    End_Object    // Clients_Client_Id
66950>>>>>
66950>>>>>    Object Clients_Client_Name is a dbFormSub
66952>>>>>        Entry_Item Clients.Client_name
66953>>>>>        Set Size to 13 317
66954>>>>>        Set Location to 106 176
66955>>>>>        Set Color to clBtnFace
66956>>>>>        Set Label_Col_Offset to 2
66957>>>>>        Set Label_Justification_Mode to jMode_Right
66958>>>>>        Set Prompt_Button_Mode to pb_PromptOff
66959>>>>>        Set Enabled_State to FALSE
66960>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66961>>>>>        Set Item_Shadow_State Item 0 to TRUE
66962>>>>>        Set Shadow_State Item 0 to TRUE
66963>>>>>
66963>>>>>        //AB-StoreStart
66963>>>>>        Procedure Prompt
66965>>>>>            Set psModule Of (sl100(Self)) to '01'
66966>>>>>            Forward Send Prompt
66968>>>>>        End_Procedure
66969>>>>>        //AB-StoreEnd
66969>>>>>
66969>>>>>    End_Object    // Clients_Client_Name
66970>>>>>
66970>>>>>    Object Clients_Client_Respons is a dbFormSub
66972>>>>>        Entry_Item Cn.Cn_responsible
66973>>>>>        Set Size to 13 257
66974>>>>>        Set Location to 119 61
66975>>>>>        Set Label_Col_Offset to 2
66976>>>>>        Set Label_Justification_Mode to jMode_Right
66977>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66978>>>>>    End_Object    // Clients_Client_Respons
66979>>>>>
66979>>>>>    Object Cn_Yesno is a dbComboFormSub
66981>>>>>        Entry_Item Cn.Yesno
66982>>>>>        Set Size to 13 38
66983>>>>>        Set Location to 119 381
66984>>>>>        Set Label_Col_Offset to 2
66985>>>>>    End_Object    // Cn_Yesno
66986>>>>>
66986>>>>>    Object Cn_Dateeggy is a dbFormSub
66988>>>>>        Entry_Item Cn.Dateeggy
66989>>>>>        Set Size to 12 44
66990>>>>>        Set Location to 121 449
66991>>>>>        Set Label_Col_Offset to 2
66992>>>>>        Set Label_Justification_Mode to jMode_Right
66993>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
66994>>>>>    End_Object    // Cn_Dateeggy
66995>>>>>
66995>>>>>    Object dbTabDialogSub1 is a dbTabDialogSub
66997>>>>>        Set Size to 118 501
66998>>>>>        Set Location to 142 5
66999>>>>>        Object dbTabPageSub1 is a dbTabPageSub
67001>>>>>            Set Label to "dbTabPageSub1"
67002>>>>>            Object TextBoxSub36 is a TextBoxSub
67004>>>>>                Set Label to "“§œçŸ. ¢ž¨à£é¤ "
67005>>>>>                Set Location to 8 0
67006>>>>>                Set Size to 10 61
67007>>>>>                Set TypeFace to "MS Sans Serif"
67008>>>>>            End_Object    // TextBoxSub36
67009>>>>>
67009>>>>>            Object Payresp_Presp_Id is a dbFormSub
67011>>>>>                Entry_Item Payresp.Presp_id
67012>>>>>                Set Size to 12 80
67013>>>>>                Set Location to 7 71
67014>>>>>                Set Color to clBtnFace
67015>>>>>                Set Label_Col_Offset to 2
67016>>>>>                Set Label_Justification_Mode to jMode_Right
67017>>>>>                Set Enabled_State to FALSE
67018>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67019>>>>>                Set Item_Shadow_State Item 0 to TRUE
67020>>>>>                Set Shadow_State Item 0 to TRUE
67021>>>>>
67021>>>>>                //AB-StoreStart
67021>>>>>                set Item_Option item 0 to FindReq true
67022>>>>>                //AB-StoreEnd
67022>>>>>
67022>>>>>            End_Object    // Payresp_Presp_Id
67023>>>>>
67023>>>>>            Object Constrct_Cnt_Id is a dbFormSub
67025>>>>>                Entry_Item Constrct.Cnt_id
67026>>>>>                Set Size to 12 80
67027>>>>>                Set Location to 20 71
67028>>>>>                Set Label_Col_Offset to 2
67029>>>>>                Set Label_Justification_Mode to jMode_Right
67030>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67031>>>>>
67031>>>>>                //AB-StoreStart
67031>>>>>                set Item_Option item 0 to FindReq true
67032>>>>>                procedure key
67034>>>>>                end_procedure
67035>>>>>                
67035>>>>>                //AB-StoreEnd
67035>>>>>
67035>>>>>            End_Object    // Constrct_Cnt_Id
67036>>>>>
67036>>>>>            Object Salesmen_Sls_Id is a dbFormSub
67038>>>>>                Entry_Item Salesmen.Sls_id
67039>>>>>                Set Size to 12 80
67040>>>>>                Set Location to 34 71
67041>>>>>                Set Label_Col_Offset to 2
67042>>>>>                Set Label_Justification_Mode to jMode_Right
67043>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67044>>>>>
67044>>>>>                //AB-StoreStart
67044>>>>>                set Item_Option item 0 to FindReq true
67045>>>>>                procedure key
67047>>>>>                end_procedure
67048>>>>>                //AB-StoreEnd
67048>>>>>
67048>>>>>            End_Object    // Salesmen_Sls_Id
67049>>>>>
67049>>>>>            Object Mhxanik_Mhx_Id is a dbFormSub
67051>>>>>                Entry_Item Mhxanik.Mhx_id
67052>>>>>                Set Size to 12 80
67053>>>>>                Set Location to 47 71
67054>>>>>                Set Label_Col_Offset to 2
67055>>>>>                Set Label_Justification_Mode to jMode_Right
67056>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67057>>>>>
67057>>>>>                //AB-StoreStart
67057>>>>>                set Item_Option item 0 to FindReq true
67058>>>>>                procedure key
67060>>>>>                end_procedure
67061>>>>>                //AB-StoreEnd
67061>>>>>
67061>>>>>            End_Object    // Mhxanik_Mhx_Id
67062>>>>>
67062>>>>>            Object Cn_Cn_Vticket is a dbCheckBoxSub
67064>>>>>                Entry_Item Cn.Cn_vticket
67065>>>>>                Set Size to 13 16
67066>>>>>                Set Location to 46 449
67067>>>>>            End_Object    // Cn_Cn_Vticket
67068>>>>>
67068>>>>>            Object Payresp_Presp_Name is a dbFormSub
67070>>>>>                Entry_Item Payresp.Presp_name
67071>>>>>                Set Size to 12 303
67072>>>>>                Set Location to 7 154
67073>>>>>                Set Color to clBtnFace
67074>>>>>                Set Label_Col_Offset to 2
67075>>>>>                Set Label_Justification_Mode to jMode_Right
67076>>>>>                Set Enabled_State to FALSE
67077>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67078>>>>>                Set Item_Shadow_State Item 0 to TRUE
67079>>>>>                Set Shadow_State Item 0 to TRUE
67080>>>>>            End_Object    // Payresp_Presp_Name
67081>>>>>
67081>>>>>            Object Cn_Polhths_Constr is a dbFormSub
67083>>>>>                Entry_Item Cn.Polhths_constr
67084>>>>>                Set Size to 13 167
67085>>>>>                Set Location to 60 71
67086>>>>>                Set Label_Col_Offset to 2
67087>>>>>                Set Label_Justification_Mode to jMode_Right
67088>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67089>>>>>            End_Object    // Cn_Polhths_Constr
67090>>>>>
67090>>>>>            Object TextBoxSub37 is a TextBoxSub
67092>>>>>                Set Label to "„¨š¦¢á™¦ª"
67093>>>>>                Set Location to 22 1
67094>>>>>                Set Size to 10 44
67095>>>>>                Set TypeFace to "MS Sans Serif"
67096>>>>>            End_Object    // TextBoxSub37
67097>>>>>
67097>>>>>            Object Constrct_Cnt_Name is a dbFormSub
67099>>>>>                Entry_Item Constrct.Cnt_name
67100>>>>>                Set Size to 12 303
67101>>>>>                Set Location to 20 154
67102>>>>>                Set Color to clBtnFace
67103>>>>>                Set Label_Col_Offset to 2
67104>>>>>                Set Label_Justification_Mode to jMode_Right
67105>>>>>                Set Enabled_State to FALSE
67106>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67107>>>>>                Set Item_Shadow_State Item 0 to TRUE
67108>>>>>                Set Shadow_State Item 0 to TRUE
67109>>>>>            End_Object    // Constrct_Cnt_Name
67110>>>>>
67110>>>>>            Object Cn_Polhths_Mhx is a dbFormSub
67112>>>>>                Entry_Item Cn.Polhths_mhx
67113>>>>>                Set Size to 13 167
67114>>>>>                Set Location to 74 71
67115>>>>>                Set Label_Col_Offset to 2
67116>>>>>                Set Label_Justification_Mode to jMode_Right
67117>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67118>>>>>            End_Object    // Cn_Polhths_Mhx
67119>>>>>
67119>>>>>            Object Cn_Cn_Distance is a dbFormSub
67121>>>>>                Entry_Item Cn.Cn_distance
67122>>>>>                Set Size to 13 38
67123>>>>>                Set Location to 87 70
67124>>>>>                Set Label_Col_Offset to 2
67125>>>>>                Set Label_Justification_Mode to jMode_Right
67126>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67127>>>>>            End_Object    // Cn_Cn_Distance
67128>>>>>
67128>>>>>            Object Cn_Tropos_Metaf is a dbComboFormSub
67130>>>>>                Entry_Item Cn.Tropos_metaf
67131>>>>>                Set Size to 13 67
67132>>>>>                Set Location to 88 171
67133>>>>>                Set Label_Col_Offset to 2
67134>>>>>            End_Object    // Cn_Tropos_Metaf
67135>>>>>
67135>>>>>            Object Cn_Cn_Start_Date is a dbFormSub
67137>>>>>                Entry_Item Cn.Cn_start_date
67138>>>>>                Set Size to 13 50
67139>>>>>                Set Location to 60 299
67140>>>>>                Set Label_Col_Offset to 2
67141>>>>>                Set Label_Justification_Mode to jMode_Right
67142>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67143>>>>>            End_Object    // Cn_Cn_Start_Date
67144>>>>>
67144>>>>>            Object TextBoxSub38 is a TextBoxSub
67146>>>>>                Set Label to "à¢ž«ãª"
67147>>>>>                Set Location to 34 1
67148>>>>>                Set Size to 12 37
67149>>>>>                Set TypeFace to "MS Sans Serif"
67150>>>>>            End_Object    // TextBoxSub38
67151>>>>>
67151>>>>>            Object Cn_Cn_End_Date is a dbFormSub
67153>>>>>                Entry_Item Cn.Cn_end_date
67154>>>>>                Set Size to 13 55
67155>>>>>                Set Location to 59 403
67156>>>>>                Set Label_Col_Offset to 2
67157>>>>>                Set Label_Justification_Mode to jMode_Right
67158>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67159>>>>>            End_Object    // Cn_Cn_End_Date
67160>>>>>
67160>>>>>            Object Salesmen_Sls_Name is a dbFormSub
67162>>>>>                Entry_Item Salesmen.Sls_name
67163>>>>>                Set Size to 12 303
67164>>>>>                Set Location to 34 154
67165>>>>>                Set Color to clBtnFace
67166>>>>>                Set Label_Col_Offset to 2
67167>>>>>                Set Label_Justification_Mode to jMode_Right
67168>>>>>                Set Enabled_State to FALSE
67169>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67170>>>>>                Set Item_Shadow_State Item 0 to TRUE
67171>>>>>                Set Shadow_State Item 0 to TRUE
67172>>>>>            End_Object    // Salesmen_Sls_Name
67173>>>>>
67173>>>>>            Object Mhxanik_Mhx_Name is a dbFormSub
67175>>>>>                Entry_Item Mhxanik.Mhx_name
67176>>>>>                Set Size to 12 194
67177>>>>>                Set Location to 47 154
67178>>>>>                Set Color to clBtnFace
67179>>>>>                Set Label_Col_Offset to 2
67180>>>>>                Set Label_Justification_Mode to jMode_Right
67181>>>>>                Set Enabled_State to FALSE
67182>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67183>>>>>                Set Item_Shadow_State Item 0 to TRUE
67184>>>>>                Set Shadow_State Item 0 to TRUE
67185>>>>>            End_Object    // Mhxanik_Mhx_Name
67186>>>>>
67186>>>>>            Object TextBoxSub42 is a TextBoxSub
67188>>>>>                Set Label to "€§æ©«˜©ž  •¢£"
67189>>>>>                Set Location to 87 1
67190>>>>>                Set Size to 12 53
67191>>>>>                Set TypeFace to "MS Sans Serif"
67192>>>>>            End_Object    // TextBoxSub42
67193>>>>>
67193>>>>>            Object TextBoxSub44 is a TextBoxSub
67195>>>>>                Set Label to "ë¤˜¨¥ž ë¨š¦¬ "
67196>>>>>                Set Location to 62 241
67197>>>>>                Set Size to 10 50
67198>>>>>                Set TypeFace to "MS Sans Serif"
67199>>>>>            End_Object    // TextBoxSub44
67200>>>>>
67200>>>>>            Object TextBoxSub45 is a TextBoxSub
67202>>>>>                Set Label to "Šã¥ž ë¨š¦¬"
67203>>>>>                Set Location to 62 351
67204>>>>>                Set Size to 10 44
67205>>>>>                Set TypeFace to "MS Sans Serif"
67206>>>>>            End_Object    // TextBoxSub45
67207>>>>>
67207>>>>>            Object TextBoxSub48 is a TextBoxSub
67209>>>>>                Set Label to "‹ž®˜¤ ¡æª"
67210>>>>>                Set Location to 49 0
67211>>>>>                Set Size to 10 41
67212>>>>>                Set TypeFace to "MS Sans Serif"
67213>>>>>            End_Object    // TextBoxSub48
67214>>>>>
67214>>>>>            Object btnPartl is a ButtonSub
67216>>>>>
67216>>>>>                //AB-StoreTopStart
67216>>>>>                                                                                                                                                                                                                                                                            
67216>>>>>                //AB-StoreTopEnd
67216>>>>>
67216>>>>>                Set Label to "ButtonSub1"
67217>>>>>                Set Bitmap to "Filesys3.bmp"
67218>>>>>                Set Size to 22 25
67219>>>>>                Set Location to 14 465
67220>>>>>                Set Focus_Mode to Pointer_Only
67221>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67222>>>>>
67222>>>>>                //AB-StoreStart
67222>>>>>                Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ƒ.„.Ž."
67223>>>>>                Procedure OnClick
67225>>>>>                    String  sCLIENTcode scncode
67226>>>>>                    Get Field_Current_Value Of clients_DD Field Clients.client_id to sclientcode
67227>>>>>                    Get Field_Current_Value Of Cn_DD      Field Cn.cn_code        to scncode
67228>>>>>                    if (scncode<>'') begin
67230>>>>>                       set pscncode   of (v193(self)) to scncode
67231>>>>>                       send activate_v193
67232>>>>>                    end
67232>>>>>>
67232>>>>>                    else error 3002 '„¨š¦ ¡œ¤æ'
67234>>>>>                End_Procedure // OnClick
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                
67235>>>>>                //AB-StoreEnd
67235>>>>>
67235>>>>>            End_Object    // btnPartl
67236>>>>>
67236>>>>>            Object TextBoxSub55 is a TextBoxSub
67238>>>>>                Set Label to "’¨. ‹œ«˜­¦¨áª"
67239>>>>>                Set Location to 89 111
67240>>>>>                Set Size to 12 54
67241>>>>>                Set TypeFace to "MS Sans Serif"
67242>>>>>            End_Object    // TextBoxSub55
67243>>>>>
67243>>>>>            Object TextBoxSub56 is a TextBoxSub
67245>>>>>                Set Label to "’œ¢œ¬«.‘¡¬¨¦›."
67246>>>>>                Set Location to 74 351
67247>>>>>                Set Size to 10 55
67248>>>>>                Set TypeFace to "MS Sans Serif"
67249>>>>>            End_Object    // TextBoxSub56
67250>>>>>
67250>>>>>            Object Cn_Cn_End_Date is a dbFormSub
67252>>>>>                Entry_Item Cn.Hm_tel_fortio
67253>>>>>                Set Size to 13 55
67254>>>>>                Set Location to 73 403
67255>>>>>                Set Color to clBtnFace
67256>>>>>                Set Label_Col_Offset to 2
67257>>>>>                Set Label_Justification_Mode to jMode_Right
67258>>>>>                Set Enabled_State to FALSE
67259>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67260>>>>>                Set Item_Shadow_State Item 0 to TRUE
67261>>>>>                Set Shadow_State Item 0 to TRUE
67262>>>>>            End_Object    // Cn_Cn_End_Date
67263>>>>>
67263>>>>>            Object Textbox3 is a Textbox
67265>>>>>                Set Label to "à¢ž«ãª „¨š¦¢á™¦¬"
67266>>>>>                Set Location to 62 0
67267>>>>>                Set Size to 10 69
67268>>>>>                Set TypeFace to "MS Sans Serif"
67269>>>>>            End_Object    // Textbox3
67270>>>>>
67270>>>>>            Object Textbox4 is a Textbox
67272>>>>>                Set Label to "à¢ž«ãª ‹ž®˜¤ ¡¦ç"
67273>>>>>                Set Location to 74 0
67274>>>>>                Set Size to 10 68
67275>>>>>                Set TypeFace to "MS Sans Serif"
67276>>>>>            End_Object    // Textbox4
67277>>>>>
67277>>>>>            Object TextBoxSub57 is a TextBoxSub
67279>>>>>                Set Label to "ë¤˜¨¥ž ‘¡¬¨¦›. "
67280>>>>>                Set Location to 76 241
67281>>>>>                Set Size to 10 56
67282>>>>>                Set TypeFace to "MS Sans Serif"
67283>>>>>            End_Object    // TextBoxSub57
67284>>>>>
67284>>>>>            Object Cn_Hm_Prot_Fortio is a dbFormSub
67286>>>>>                Entry_Item Cn.Hm_prot_fortio
67287>>>>>                Set Size to 13 50
67288>>>>>                Set Location to 73 299
67289>>>>>                Set Color to clBtnFace
67290>>>>>                Set Label_Col_Offset to 2
67291>>>>>                Set Label_Justification_Mode to jMode_Right
67292>>>>>                Set Enabled_State to FALSE
67293>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67294>>>>>                Set Item_Shadow_State Item 0 to TRUE
67295>>>>>                Set Shadow_State Item 0 to TRUE
67296>>>>>            End_Object    // Cn_Hm_Prot_Fortio
67297>>>>>
67297>>>>>            Object Textbox5 is a Textbox
67299>>>>>                Set Label to "‹.‰ ›¨¦£¦¢.(—¨.)"
67300>>>>>                Set Location to 89 241
67301>>>>>                Set Size to 10 57
67302>>>>>                Set TypeFace to "MS Sans Serif"
67303>>>>>            End_Object    // Textbox5
67304>>>>>
67304>>>>>            Object Cn_Mesoskyklos is a dbFormSub
67306>>>>>                Entry_Item Cn.Mesoskyklos
67307>>>>>                Set Size to 13 50
67308>>>>>                Set Location to 87 299
67309>>>>>                Set Label_Col_Offset to 2
67310>>>>>                Set Label_Justification_Mode to jMode_Right
67311>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67312>>>>>            End_Object    // Cn_Mesoskyklos
67313>>>>>
67313>>>>>            Object Textbox7 is a Textbox
67315>>>>>                Set Label to "ƒ æ› ˜"
67316>>>>>                Set Location to 90 367
67317>>>>>                Set Size to 10 24
67318>>>>>                Set TypeFace to "MS Sans Serif"
67319>>>>>            End_Object    // Textbox7
67320>>>>>
67320>>>>>            Object Cn_Diodia is a dbFormSub
67322>>>>>                Entry_Item Cn.Diodia
67323>>>>>                Set Size to 13 55
67324>>>>>                Set Location to 87 403
67325>>>>>                Set Label_Col_Offset to 2
67326>>>>>                Set Label_Justification_Mode to jMode_Right
67327>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67328>>>>>            End_Object    // Cn_Diodia
67329>>>>>
67329>>>>>            Object TextBoxSub61 is a TextBoxSub
67331>>>>>                Set Label to "„¡«. •ž£ ¡é¤ ¨¦©Ÿâ«à¤"
67332>>>>>                Set Location to 48 351
67333>>>>>                Set Size to 10 91
67334>>>>>                Set TypeFace to "MS Sans Serif"
67335>>>>>            End_Object    // TextBoxSub61
67336>>>>>
67336>>>>>
67336>>>>>            //AB-StoreStart
67336>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
67336>>>>>            set label to "¨æ©Ÿœ«˜ ‘«¦ ®œå˜"
67337>>>>>            
67337>>>>>            
67337>>>>>            
67337>>>>>            //AB-StoreEnd
67337>>>>>
67337>>>>>        End_Object    // dbTabPageSub1
67338>>>>>
67338>>>>>        Object dbTabPageSub2 is a dbTabPageSub
67340>>>>>            Set Label to "dbTabPageSub2"
67341>>>>>            Object Btnordh_ is a dbGridSub
67343>>>>>                Set Main_File to Btnordh.File_Number
67344>>>>>                Set Server to (Btnordh_DD(self))
67345>>>>>                Set Ordering to 8
67346>>>>>                Set Size to 92 76
67347>>>>>                Set Location to 7 0
67348>>>>>                Set Wrap_State to TRUE
67349>>>>>
67349>>>>>                Begin_Row
67352>>>>>                    Entry_Item Btnordh.Aa_deop
67353>>>>>                End_Row
67358>>>>>
67358>>>>>                Set Form_Width    item 0 to 70
67359>>>>>                Set Header_Label  item 0 to "‰à›. ƒ.„.Ž."
67360>>>>>                
67360>>>>>
67360>>>>>                //AB-StoreStart
67360>>>>>                set currentrowcolor to 11468799
67361>>>>>                set currentcellcolor to 11468799
67362>>>>>                set read_only_state to true
67363>>>>>                //AB-StoreEnd
67363>>>>>
67363>>>>>            End_Object    // Btnordh_
67364>>>>>
67364>>>>>            Object The_Table is a dbGrid
67366>>>>>                Set Main_File to Btnordd.File_Number
67367>>>>>                Set Server to (Btnordd_DD(self))
67368>>>>>                Set Ordering to 1
67369>>>>>                Set Size to 87 402
67370>>>>>                Set Location to 19 83
67371>>>>>                Set Wrap_State to TRUE
67372>>>>>
67372>>>>>                Begin_Row
67375>>>>>                    Entry_Item Btnordd.Recnum
67376>>>>>                    Entry_Item Btnordd.Vitem
67377>>>>>                    Entry_Item (fsitem(self,btnordd.vitem))
67378>>>>>                    Entry_Item (fsqual(self,btnordd.vitem))
67379>>>>>                    Entry_Item Btnordd.Vqty
67380>>>>>                    Entry_Item Btnordd.Vunitprice
67381>>>>>                    Entry_Item Btnordd.Vdisc
67382>>>>>                    Entry_Item Btnordd.Vprice
67383>>>>>                    Entry_Item Btnordd.Vkatish
67384>>>>>                    Entry_Item Btnordd.Vxrm3
67385>>>>>                End_Row
67390>>>>>
67390>>>>>                Set Form_Width    item 0 to 0
67391>>>>>                Set Header_Label  item 0 to ""
67392>>>>>                
67392>>>>>                Set Form_Width    item 1 to 55
67393>>>>>                Set Header_Label  item 1 to "‰à›.„å›¦¬ª"
67394>>>>>                
67394>>>>>                Set Form_Width    item 2 to 77
67395>>>>>                Set Header_Label  item 2 to "œ¨ š¨˜­ã"
67396>>>>>                
67396>>>>>                Set Form_Width    item 3 to 43
67397>>>>>                Set Header_Label  item 3 to "¦ æ«ž«˜"
67398>>>>>                
67398>>>>>                Set Form_Width    item 4 to 38
67399>>>>>                Set Header_Label  item 4 to "¦©æ«"
67400>>>>>                
67400>>>>>                Set Form_Width    item 5 to 40
67401>>>>>                Set Header_Label  item 5 to "’ £ã ‹¦¤"
67402>>>>>                
67402>>>>>                Set Form_Width    item 6 to 30
67403>>>>>                Set Header_Label  item 6 to "%„¡§«"
67404>>>>>                
67404>>>>>                Set Form_Width    item 7 to 43
67405>>>>>                Set Header_Label  item 7 to "€¥å˜"
67406>>>>>                
67406>>>>>                Set Form_Width    item 8 to 38
67407>>>>>                Set Header_Label  item 8 to "‰áŸ ©ž"
67408>>>>>                
67408>>>>>                Set Form_Width    item 9 to 32
67409>>>>>                Set Header_Label  item 9 to "•¨/m3"
67410>>>>>                Set Column_Checkbox_State  item 9 to True
67411>>>>>                
67411>>>>>
67411>>>>>                //AB-StoreStart
67411>>>>>                set read_only_state to true
67412>>>>>                set currentrowcolor to 11468799
67413>>>>>                set currentcellcolor to 11468799
67414>>>>>                
67414>>>>>                Procedure End_Construct_Object
67416>>>>>                    Integer iDecimals
67417>>>>>                    Forward Send End_Construct_Object
67419>>>>>                    Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
67420>>>>>                    Set Points Item 5 to iDecimals
67421>>>>>                    Set Points Item 7 to iDecimals
67422>>>>>                    Set Numeric_Mask  Item 5 to 14 iDecimals ' ,*'
67423>>>>>                    Set Numeric_Mask  Item 7 to 14 iDecimals ' ,*'
67424>>>>>                End_Procedure
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                
67425>>>>>                //AB-StoreEnd
67425>>>>>
67425>>>>>            End_Object    // The_Table
67426>>>>>
67426>>>>>            Object Btnordh_Deop_Date is a dbFormSub
67428>>>>>                Entry_Item Btnordh.Deop_date
67429>>>>>                Set Label to "†£/¤å˜ ˆ©®ç¦ª"
67430>>>>>                Set Size to 13 66
67431>>>>>                Set Location to 2 199
67432>>>>>                Set Label_Col_Offset to 2
67433>>>>>                Set Label_Justification_Mode to jMode_Right
67434>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67435>>>>>
67435>>>>>                //AB-StoreStart
67435>>>>>                set enabled_state to false
67436>>>>>                //AB-StoreEnd
67436>>>>>
67436>>>>>            End_Object    // Btnordh_Deop_Date
67437>>>>>
67437>>>>>            Object Btnordh_Deop_M3ap is a dbFormSub
67439>>>>>                Entry_Item Btnordh.Eleiph
67440>>>>>                Set Label to "„¢¢œ §âª ”¦¨«å¦"
67441>>>>>                Set Size to 13 47
67442>>>>>                Set Location to 2 347
67443>>>>>                Set Label_Col_Offset to 2
67444>>>>>                Set Label_Justification_Mode to jMode_Right
67445>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67446>>>>>
67446>>>>>                //AB-StoreStart
67446>>>>>                set enabled_state to false
67447>>>>>                //AB-StoreEnd
67447>>>>>
67447>>>>>            End_Object    // Btnordh_Deop_M3ap
67448>>>>>
67448>>>>>            Object Btnordh_Deop_Active is a dbCheckBoxSub
67450>>>>>                Entry_Item Btnordh.Deop_active
67451>>>>>                Set Label to "€¤œ¤œ¨šæ"
67452>>>>>                Set Size to 10 52
67453>>>>>                Set Location to 4 83
67454>>>>>
67454>>>>>                //AB-StoreStart
67454>>>>>                set enabled_state to false
67455>>>>>                //AB-StoreEnd
67455>>>>>
67455>>>>>            End_Object    // Btnordh_Deop_Active
67456>>>>>
67456>>>>>
67456>>>>>            //AB-StoreStart
67456>>>>>            set label to 'ƒ.„.Ž.'
67457>>>>>            
67457>>>>>            
67457>>>>>            
67457>>>>>            
67457>>>>>            
67457>>>>>            
67457>>>>>            
67457>>>>>            
67457>>>>>            //AB-StoreEnd
67457>>>>>
67457>>>>>        End_Object    // dbTabPageSub2
67458>>>>>
67458>>>>>        Object dbTabPageSub3 is a dbTabPageSub
67460>>>>>            Set Label to "dbTabPageSub3"
67461>>>>>            Object Textbox10 is a Textbox
67463>>>>>                Set Label to "‘®æ¢ ˜ ƒ.„.Ž. "
67464>>>>>                Set TextColor to clPurple
67465>>>>>                Set Location to 6 9
67466>>>>>                Set Size to 10 60
67467>>>>>                Set FontWeight to 600
67468>>>>>                Set TypeFace to "MS Sans Serif"
67469>>>>>            End_Object    // Textbox10
67470>>>>>
67470>>>>>            Object Btnordh_Sxolia is a dbEditSub
67472>>>>>                Entry_Item Btnordh.Sxolia
67473>>>>>                Set Size to 60 480
67474>>>>>                Set Location to 25 7
67475>>>>>
67475>>>>>                //AB-StoreStart
67475>>>>>                set enabled_state to false
67476>>>>>                //AB-StoreEnd
67476>>>>>
67476>>>>>            End_Object    // Btnordh_Sxolia
67477>>>>>
67477>>>>>
67477>>>>>            //AB-StoreStart
67477>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
67477>>>>>            set label to '‘®æ¢ ˜ ƒ.„.Ž.'
67478>>>>>            
67478>>>>>            
67478>>>>>            
67478>>>>>            //AB-StoreEnd
67478>>>>>
67478>>>>>        End_Object    // dbTabPageSub3
67479>>>>>
67479>>>>>        Object dbTabPageSub4 is a dbTabPageSub
67481>>>>>            Set Label to "dbTabPageSub4"
67482>>>>>            Object Tperga_ is a dbGridSub
67484>>>>>                Set Main_File to Tperga.File_Number
67485>>>>>                Set Server to (Tperga_DD(self))
67486>>>>>                Set Size to 71 489
67487>>>>>                Set Location to 6 3
67488>>>>>                Set Wrap_State to TRUE
67489>>>>>
67489>>>>>                Begin_Row
67492>>>>>                    Entry_Item Baxiokat.Baxiokat_descr
67493>>>>>                    Entry_Item Tperga.Pct_epi_synolou
67494>>>>>                    Entry_Item Tperga.Paralabh_meres
67495>>>>>                    Entry_Item Tperga.Xarhtos_meres
67496>>>>>                    Entry_Item Tperga.Plhroteo_meres
67497>>>>>                End_Row
67502>>>>>
67502>>>>>                Set Form_Width    item 0 to 164
67503>>>>>                Set Header_Label  item 0 to "’¨æ§¦ª"
67504>>>>>                
67504>>>>>                Set Form_Width    item 1 to 65
67505>>>>>                Set Header_Label  item 1 to "% œ§å ‘¬¤æ¢¦¬"
67506>>>>>                
67506>>>>>                Set Form_Width    item 2 to 72
67507>>>>>                Set Header_Label  item 2 to "˜¨˜¢˜™ã (£â¨œª)"
67508>>>>>                
67508>>>>>                Set Form_Width    item 3 to 93
67509>>>>>                Set Header_Label  item 3 to "ƒ á©«ž£˜ « £¦¢æšž©žª"
67510>>>>>                
67510>>>>>                Set Form_Width    item 4 to 87
67511>>>>>                Set Header_Label  item 4 to "Šã¥ž œ§ «˜šãª †£â¨œª)"
67512>>>>>                
67512>>>>>
67512>>>>>                //AB-StoreStart
67512>>>>>                Function Child_entering returns Integer
67514>>>>>                    Integer rval iErr
67515>>>>>                    Forward Get Child_Entering to rVal
67517>>>>>                    If (NOT(rVal)) Begin
67519>>>>>                        If (Current_Record(cn_DD(Self))) Forward Get Child_Entering to rVal
67523>>>>>                        Else Begin
67524>>>>>                            Function_Return 1
67525>>>>>                        End
67525>>>>>>
67525>>>>>                    End
67525>>>>>>
67525>>>>>                    function_return rVal
67526>>>>>                End_Function
67527>>>>>                
67527>>>>>                Procedure Key Integer iKey
67529>>>>>                    Integer iCol
67530>>>>>                    Get Current_Col to iCol
67531>>>>>                    If (iCol<>0) Forward Send Key iKey
67535>>>>>                End_Procedure
67536>>>>>                
67536>>>>>                
67536>>>>>                
67536>>>>>                
67536>>>>>                
67536>>>>>                
67536>>>>>                //AB-StoreEnd
67536>>>>>
67536>>>>>            End_Object    // Tperga_
67537>>>>>
67537>>>>>            Object ButtonSub1 is a ButtonSub
67539>>>>>
67539>>>>>                //AB-StoreTopStart
67539>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
67539>>>>>                //AB-StoreTopEnd
67539>>>>>
67539>>>>>                Set Label to "„ ©˜šàšã «¨æ§¦¬ §¢ž¨à£ãª ­¦¨â˜ §¨¦ª «¨¦§¦§¦åž©ž"
67540>>>>>                Set Size to 14 217
67541>>>>>                Set Location to 82 139
67542>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67543>>>>>
67543>>>>>                //AB-StoreStart
67543>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
67543>>>>>                Procedure Bring_Records_From_Client String asClient String asErgo
67545>>>>>                    Clear TPClient
67546>>>>>                    Move asClient to TPClient.Client_ID
67547>>>>>                    Find Gt TPClient By Index.1 // Client_ID+...
67548>>>>>>
67548>>>>>                    While ((Found=1) And (TPClient.Client_ID=asClient))
67552>>>>>                        Clear TPErga
67553>>>>>                        Move asErgo                     to TPErga.CN_Code
67554>>>>>                        Move TPClient.Baxiokat_Code     to TPErga.Baxiokat_Code
67555>>>>>                        Move TPClient.Pct_Epi_Synolou   to TPErga.Pct_Epi_Synolou
67556>>>>>                        Move TPClient.Paralabh_Meres    to TPErga.Paralabh_Meres
67557>>>>>                        Move TPClient.Xarhtos_Meres     to TPErga.Xarhtos_Meres
67558>>>>>                        Move TPClient.Plhroteo_Meres    to TPErga.Plhroteo_Meres
67559>>>>>                        Move (Sysrecc.TPErga_Rec0+1)    to TPErga.TPErga_Rec0
67560>>>>>                        Reread Sysrecc
67564>>>>>                        Move (Sysrecc.TPErga_Rec0+1)    to Sysrecc.TPErga_Rec0
67565>>>>>                        Saverecord Sysrecc
67566>>>>>                        UnLock
67567>>>>>>
67567>>>>>                        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                         (Trim(String(TPErga.TPErga_Rec0))))));                                                        to TPErga.TPErga_Recr
67568>>>>>                        Saverecord TPErga
67569>>>>>                        Find Gt TPClient By Index.1 // Client_ID+...
67570>>>>>>
67570>>>>>                    Loop
67571>>>>>>
67571>>>>>                    Send Beginning_Of_Data to TPErga_ True
67572>>>>>                End_Procedure
67573>>>>>                
67573>>>>>                
67573>>>>>                Procedure OnClick
67575>>>>>                    Integer iRecnum iErga rVal iVal
67576>>>>>                    String sClient sErgo
67576>>>>>                    Send Beginning_Of_Data to TPErga_ True
67577>>>>>                    Get Field_Current_Value Of CN_DD Field Cn.Recnum                to iRecnum
67578>>>>>                    Get Field_Current_Value Of CN_DD Field Cn.CN_Code               to sErgo
67579>>>>>                    Get Field_Current_Value Of TPErga_DD Field TPErga.Recnum        to iErga
67580>>>>>                    Get Field_Current_Value Of Clients_DD Field Clients.Client_ID   to sClient
67581>>>>>                    If ((Trim(sClient)<>'') And (iRecnum<>0)) Begin
67583>>>>>                        Get Message_Box "Œ˜ ˜¤« š¨á¯à «¦¬ª «¨æ§¦¬ª §¢ž¨à£ãª «¦¬ ­¦¨â˜ ?" "„§ ™œ™˜åà©ž";                            MB_OKCANCEL (MB_ICONQUESTION IOR MB_DEFBUTTON1) to iVal  // 1=ok 2=cancel
67584>>>>>                        If (iVal=1) Begin
67586>>>>>                            If (iErga) Begin
67588>>>>>                                Get Message_Box "Ÿ˜ › ˜š¨á¯à «¦¬ª ¬§á¨®¦¤«œª «¨æ§¦¬ª §¢ž¨à£ãª\n‡â¢œ«œ §˜¨˜š£˜« ¡á ¤˜ šå¤œ  ˜¬«æ ?" "„§ ™œ™˜åà©ž";                                    MB_OKCANCEL (MB_ICONQUESTION IOR MB_DEFBUTTON1) to iVal  // 1=ok 2=cancel
67589>>>>>                                If (iVal=1) Begin
67591>>>>>                                    Clear TPErga
67592>>>>>                                    Move sErgo to TPErga.CN_Code
67593>>>>>                                    Find Gt TPErga By Index.1 // CN_Code+.....
67594>>>>>>
67594>>>>>                                    While ((Found=1) And (TPErga.CN_Code=sErgo))
67598>>>>>                                        Delete TPErga
67599>>>>>                                        Find Gt TPErga By Index.1 // CN_Code+.....
67600>>>>>>
67600>>>>>                                    Loop
67601>>>>>>
67601>>>>>                //                    Send Beginning_Of_Data to TPErga_ True
67601>>>>>                                    Send Bring_Records_From_Client sClient sErgo
67602>>>>>                                End
67602>>>>>>
67602>>>>>                            End
67602>>>>>>
67602>>>>>                            Else Send Bring_Records_From_Client sClient sErgo
67604>>>>>                        End
67604>>>>>>
67604>>>>>                    End
67604>>>>>>
67604>>>>>                End_Procedure // OnClick
67605>>>>>                
67605>>>>>                
67605>>>>>                
67605>>>>>                
67605>>>>>                
67605>>>>>                
67605>>>>>                //AB-StoreEnd
67605>>>>>
67605>>>>>            End_Object    // ButtonSub1
67606>>>>>
67606>>>>>
67606>>>>>            //AB-StoreStart
67606>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
67606>>>>>            set label to "’¨æ§¦  ¢ž¨à£ãª"
67607>>>>>            
67607>>>>>            //AB-StoreEnd
67607>>>>>
67607>>>>>        End_Object    // dbTabPageSub4
67608>>>>>
67608>>>>>        Object dbTabPageSub5 is a dbTabPageSub
67610>>>>>            Set Label to "dbTabPageSub5"
67611>>>>>            Object TextBoxSub50 is a TextBoxSub
67613>>>>>                Set Label to "€¨ Ÿ. ê›œ ˜ª"
67614>>>>>                Set Location to 6 3
67615>>>>>                Set Size to 10 52
67616>>>>>                Set TypeFace to "MS Sans Serif"
67617>>>>>            End_Object    // TextBoxSub50
67618>>>>>
67618>>>>>            Object TextBoxSub51 is a TextBoxSub
67620>>>>>                Set Label to "†£/¤å˜ ë¡›¦©žª"
67621>>>>>                Set Location to 18 3
67622>>>>>                Set Size to 10 55
67623>>>>>                Set TypeFace to "MS Sans Serif"
67624>>>>>            End_Object    // TextBoxSub51
67625>>>>>
67625>>>>>            Object TextBoxSub52 is a TextBoxSub
67627>>>>>                Set Label to "„¡›æ«žª"
67628>>>>>                Set Location to 32 3
67629>>>>>                Set Size to 10 38
67630>>>>>                Set TypeFace to "MS Sans Serif"
67631>>>>>            End_Object    // TextBoxSub52
67632>>>>>
67632>>>>>            Object TextBoxSub53 is a TextBoxSub
67634>>>>>                Set Label to "‘®æ¢ ˜"
67635>>>>>                Set Location to 79 27
67636>>>>>                Set Size to 10 26
67637>>>>>                Set FontWeight to 800
67638>>>>>                Set TypeFace to "MS Sans Serif"
67639>>>>>            End_Object    // TextBoxSub53
67640>>>>>
67640>>>>>            Object Cn_Lic_Number is a dbFormSub
67642>>>>>                Entry_Item Cn.Lic_number
67643>>>>>                Set Size to 13 126
67644>>>>>                Set Location to 4 63
67645>>>>>                Set Label_Col_Offset to 2
67646>>>>>                Set Label_Justification_Mode to jMode_Right
67647>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67648>>>>>            End_Object    // Cn_Lic_Number
67649>>>>>
67649>>>>>            Object Cn_Lic_Date is a dbFormSub
67651>>>>>                Entry_Item Cn.Lic_date
67652>>>>>                Set Size to 13 66
67653>>>>>                Set Location to 19 63
67654>>>>>                Set Label_Col_Offset to 2
67655>>>>>                Set Label_Justification_Mode to jMode_Right
67656>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67657>>>>>            End_Object    // Cn_Lic_Date
67658>>>>>
67658>>>>>            Object Cn_Lic_Lixi is a dbFormSub
67660>>>>>                Entry_Item Cn.Lic_lixi
67661>>>>>                Set Size to 13 66
67662>>>>>                Set Location to 18 241
67663>>>>>                Set Label_Col_Offset to 2
67664>>>>>                Set Label_Justification_Mode to jMode_Right
67665>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67666>>>>>            End_Object    // Cn_Lic_Lixi
67667>>>>>
67667>>>>>            Object Cn_Lic_Auth is a dbFormSub
67669>>>>>                Entry_Item Cn.Lic_auth
67670>>>>>                Set Size to 13 246
67671>>>>>                Set Location to 34 63
67672>>>>>                Set Label_Col_Offset to 2
67673>>>>>                Set Label_Justification_Mode to jMode_Right
67674>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67675>>>>>            End_Object    // Cn_Lic_Auth
67676>>>>>
67676>>>>>            Object Cn_Cn_Branch is a dbFormSub
67678>>>>>                Entry_Item Cn.Cn_branch
67679>>>>>                Set Size to 13 66
67680>>>>>                Set Location to 49 62
67681>>>>>                Set Label_Col_Offset to 2
67682>>>>>                Set Label_Justification_Mode to jMode_Right
67683>>>>>                Set Prompt_Button_Mode to pb_PromptOn
67684>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67685>>>>>
67685>>>>>                //AB-StoreStart
67685>>>>>                set prompt_object to (sl002(self))
67686>>>>>                
67686>>>>>                
67686>>>>>                
67686>>>>>                
67686>>>>>                
67686>>>>>                //AB-StoreEnd
67686>>>>>
67686>>>>>            End_Object    // Cn_Cn_Branch
67687>>>>>
67687>>>>>            Object Cn_Cn_M3 is a dbFormSub
67689>>>>>                Entry_Item Cn.Cn_m3
67690>>>>>                Set Size to 13 57
67691>>>>>                Set Location to 49 179
67692>>>>>                Set Label_Col_Offset to 2
67693>>>>>                Set Label_Justification_Mode to jMode_Right
67694>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67695>>>>>
67695>>>>>                //AB-StoreStart
67695>>>>>                Set Points Item 0 to 1
67696>>>>>                //AB-StoreEnd
67696>>>>>
67696>>>>>            End_Object    // Cn_Cn_M3
67697>>>>>
67697>>>>>            Object Cn_Cn_Details is a dbEditSub
67699>>>>>                Entry_Item Cn.Cn_details
67700>>>>>                Set Size to 31 369
67701>>>>>                Set Location to 69 61
67702>>>>>            End_Object    // Cn_Cn_Details
67703>>>>>
67703>>>>>            Object TextBoxSub54 is a TextBoxSub
67705>>>>>                Set Label to "Šã¥ž ê›œ ˜ª"
67706>>>>>                Set Location to 18 191
67707>>>>>                Set Size to 10 45
67708>>>>>                Set TypeFace to "MS Sans Serif"
67709>>>>>            End_Object    // TextBoxSub54
67710>>>>>
67710>>>>>            Object TextBoxSub58 is a TextBoxSub
67712>>>>>                Set Label to "¨¦¬§¦¢¦š ©£æª “§/©«ž£˜- §¦©æ«ž«˜"
67713>>>>>                Set Location to 48 -2
67714>>>>>                Set Size to 25 59
67715>>>>>                Set Justification_Mode to jMode_Center
67716>>>>>                Set TypeFace to "MS Sans Serif"
67717>>>>>            End_Object    // TextBoxSub58
67718>>>>>
67718>>>>>            Object TextBoxSub59 is a TextBoxSub
67720>>>>>                Set Label to "¦©æ«ž«˜"
67721>>>>>                Set Location to 50 133
67722>>>>>                Set Size to 10 41
67723>>>>>                Set TypeFace to "MS Sans Serif"
67724>>>>>            End_Object    // TextBoxSub59
67725>>>>>
67725>>>>>            Object TextBoxSub60 is a TextBoxSub
67727>>>>>                Set Label to "M3"
67728>>>>>                Set Location to 51 240
67729>>>>>                Set Size to 10 11
67730>>>>>                Set TypeFace to "MS Sans Serif"
67731>>>>>            End_Object    // TextBoxSub60
67732>>>>>
67732>>>>>
67732>>>>>            //AB-StoreStart
67732>>>>>            set label to "‘«¦ ®œå˜ „¨š¦¬ - ‘®æ¢ ˜"
67733>>>>>            //AB-StoreEnd
67733>>>>>
67733>>>>>        End_Object    // dbTabPageSub5
67734>>>>>
67734>>>>>        Object dbTabPageSub6 is a dbTabPageSub
67736>>>>>            Set Label to "dbTabPageSub6"
67737>>>>>            Object Cnzones_ is a dbGridSub
67739>>>>>
67739>>>>>                //AB-StoreTopStart
67739>>>>>                                                                                                                                                                                                                                            
67739>>>>>                Function fsBranch Returns String
67741>>>>>                    Clear BranchL
67742>>>>>                    Move BrZones.Branch_Recr to BranchL.Branch_Recr
67743>>>>>                    Find Eq BranchL By Index.2
67744>>>>>>
67744>>>>>                    Function_Return BranchL.Branch_Name
67745>>>>>                End_Function
67746>>>>>                
67746>>>>>                
67746>>>>>                //AB-StoreTopEnd
67746>>>>>
67746>>>>>                Set Main_File to Cnzones.File_Number
67747>>>>>                Set Server to (Cnzones_DD(self))
67748>>>>>                Set Ordering to 1
67749>>>>>                Set Size to 84 432
67750>>>>>                Set Location to 4 3
67751>>>>>                Set Wrap_State to TRUE
67752>>>>>
67752>>>>>                Begin_Row
67755>>>>>                    Entry_Item Brzones.Brzone_recr
67756>>>>>                    Entry_Item Zones.Zone_descr
67757>>>>>                    Entry_Item Brzones.Zone_km
67758>>>>>                    Entry_Item Brzones.Zone_charge0
67759>>>>>                    Entry_Item Brzones.Zone_charge1
67760>>>>>                    Entry_Item Brzones.Zone_charge2
67761>>>>>                    Entry_Item (fsBranch(Self))
67762>>>>>                End_Row
67767>>>>>
67767>>>>>                Set Form_Width    item 0 to 42
67768>>>>>                Set Header_Label  item 0 to "…é¤ž"
67769>>>>>                
67769>>>>>                Set Form_Width    item 1 to 76
67770>>>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
67771>>>>>                
67771>>>>>                Set Form_Width    item 2 to 53
67772>>>>>                Set Header_Label  item 2 to "•¢£"
67773>>>>>                
67773>>>>>                Set Form_Width    item 3 to 65
67774>>>>>                Set Header_Label  item 3 to "•¨âà©ž 0"
67775>>>>>                
67775>>>>>                Set Form_Width    item 4 to 65
67776>>>>>                Set Header_Label  item 4 to "•¨âà©ž 1"
67777>>>>>                
67777>>>>>                Set Form_Width    item 5 to 65
67778>>>>>                Set Header_Label  item 5 to "•¨âà©ž 2"
67779>>>>>                
67779>>>>>                Set Form_Width    item 6 to 60
67780>>>>>                Set Header_Label  item 6 to "“§¦¡˜«/£˜"
67781>>>>>                
67781>>>>>
67781>>>>>                //AB-StoreStart
67781>>>>>                Set Column_Option Item 0 to NoPut   True
67782>>>>>                Set Column_Option Item 1 to NoEnter True
67783>>>>>                Set Column_Option Item 2 to NoEnter True
67784>>>>>                Set Column_Option Item 3 to NoEnter True
67785>>>>>                Set Column_Option Item 4 to NoEnter True
67786>>>>>                Set Column_Option Item 5 to NoEnter True
67787>>>>>                
67787>>>>>                Function Child_entering returns Integer
67789>>>>>                    Integer rval iErr
67790>>>>>                    Forward Get Child_Entering to rVal
67792>>>>>                    If (NOT(rVal)) Begin
67794>>>>>                        If (Current_Record(Cn_DD(Self))) Forward Get Child_Entering to rVal
67798>>>>>                        Else Begin
67799>>>>>                            Function_Return 1
67800>>>>>                        End
67800>>>>>>
67800>>>>>                    End
67800>>>>>>
67800>>>>>                    function_return rVal
67801>>>>>                End_Function
67802>>>>>                
67802>>>>>                Procedure Key Integer iKey
67804>>>>>                    Integer iCol
67805>>>>>                    Get Current_Col to iCol
67806>>>>>                    If (iCol<>0) Forward Send Key iKey
67810>>>>>                End_Procedure
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                
67811>>>>>                //AB-StoreEnd
67811>>>>>
67811>>>>>            End_Object    // Cnzones_
67812>>>>>
67812>>>>>
67812>>>>>            //AB-StoreStart
67812>>>>>            set label to "…é¤œª €¤á „¨š¦"
67813>>>>>            //AB-StoreEnd
67813>>>>>
67813>>>>>        End_Object    // dbTabPageSub6
67814>>>>>
67814>>>>>        Object dbTabPageSub7 is a dbTabPageSub
67816>>>>>            Set Label to "dbTabPageSub7"
67817>>>>>            Object Cn_Cn_Exfd1 is a dbFormSub
67819>>>>>                Entry_Item Cn.Cn_exfd1
67820>>>>>                Set Label to "‚¨˜££ã 1"
67821>>>>>                Set Size to 13 406
67822>>>>>                Set Location to 6 60
67823>>>>>                Set Label_Col_Offset to 2
67824>>>>>                Set Label_Justification_Mode to jMode_Right
67825>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67826>>>>>            End_Object    // Cn_Cn_Exfd1
67827>>>>>
67827>>>>>            Object Cn_Cn_Exfd2 is a dbFormSub
67829>>>>>                Entry_Item Cn.Cn_exfd2
67830>>>>>                Set Label to "‚¨˜££ã 2"
67831>>>>>                Set Size to 13 406
67832>>>>>                Set Location to 22 60
67833>>>>>                Set Label_Col_Offset to 2
67834>>>>>                Set Label_Justification_Mode to jMode_Right
67835>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67836>>>>>            End_Object    // Cn_Cn_Exfd2
67837>>>>>
67837>>>>>            Object Cn_Cn_Exfd5 is a dbFormSub
67839>>>>>                Entry_Item Cn.Cn_exfd5
67840>>>>>                Set Label to "‚¨˜££ã 3"
67841>>>>>                Set Size to 13 406
67842>>>>>                Set Location to 38 60
67843>>>>>                Set Label_Col_Offset to 2
67844>>>>>                Set Label_Justification_Mode to jMode_Right
67845>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67846>>>>>            End_Object    // Cn_Cn_Exfd5
67847>>>>>
67847>>>>>            Object Cn_Cn_Exfd6 is a dbFormSub
67849>>>>>                Entry_Item Cn.Cn_exfd6
67850>>>>>                Set Label to "‚¨˜££ã 4"
67851>>>>>                Set Size to 13 406
67852>>>>>                Set Location to 54 60
67853>>>>>                Set Label_Col_Offset to 2
67854>>>>>                Set Label_Justification_Mode to jMode_Right
67855>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67856>>>>>            End_Object    // Cn_Cn_Exfd6
67857>>>>>
67857>>>>>            Object Cn_Cn_Exfd3 is a dbFormSub
67859>>>>>                Entry_Item Cn.Cn_exfd3
67860>>>>>                Set Label to "‚¨˜££ã 5 €”‹"
67861>>>>>                Set Size to 13 406
67862>>>>>                Set Location to 70 60
67863>>>>>                Set Label_Col_Offset to 2
67864>>>>>                Set Label_Justification_Mode to jMode_Right
67865>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67866>>>>>            End_Object    // Cn_Cn_Exfd3
67867>>>>>
67867>>>>>            Object Cn_Cn_Exfd4 is a dbFormSub
67869>>>>>                Entry_Item Cn.Cn_exfd4
67870>>>>>                Set Label to "‚¨˜££ã 5 ƒŽ“"
67871>>>>>                Set Size to 13 406
67872>>>>>                Set Location to 86 60
67873>>>>>                Set Label_Col_Offset to 2
67874>>>>>                Set Label_Justification_Mode to jMode_Right
67875>>>>>                Set Form_TypeFace Item 0 to "MS Sans Serif"
67876>>>>>            End_Object    // Cn_Cn_Exfd4
67877>>>>>
67877>>>>>
67877>>>>>            //AB-StoreStart
67877>>>>>                                                                                    
67877>>>>>            set label to "¨¦ª ’¨å«¦¬ª"
67878>>>>>            
67878>>>>>            
67878>>>>>            //AB-StoreEnd
67878>>>>>
67878>>>>>        End_Object    // dbTabPageSub7
67879>>>>>
67879>>>>>    End_Object    // dbTabDialogSub1
67880>>>>>
67880>>>>>    Object TextBoxSub30 is a TextBoxSub
67882>>>>>        Set Label to "Œ¦£æª"
67883>>>>>        Set Location to 63 202
67884>>>>>        Set Size to 12 27
67885>>>>>        Set TypeFace to "MS Sans Serif"
67886>>>>>    End_Object    // TextBoxSub30
67887>>>>>
67887>>>>>    Object TextBoxSub31 is a TextBoxSub
67889>>>>>        Set Label to "œ¨ ¦®ã"
67890>>>>>        Set Location to 50 202
67891>>>>>        Set Size to 12 30
67892>>>>>        Set TypeFace to "MS Sans Serif"
67893>>>>>    End_Object    // TextBoxSub31
67894>>>>>
67894>>>>>    Object TextBoxSub32 is a TextBoxSub
67896>>>>>        Set Label to "•é¨˜"
67897>>>>>        Set Location to 76 5
67898>>>>>        Set Size to 12 28
67899>>>>>        Set TypeFace to "MS Sans Serif"
67900>>>>>    End_Object    // TextBoxSub32
67901>>>>>
67901>>>>>    Object TextBoxSub33 is a TextBoxSub
67903>>>>>        Set Label to "’ž¢â­à¤˜"
67904>>>>>        Set Location to 90 5
67905>>>>>        Set Size to 10 44
67906>>>>>        Set TypeFace to "MS Sans Serif"
67907>>>>>    End_Object    // TextBoxSub33
67908>>>>>
67908>>>>>    Object TextBoxSub34 is a TextBoxSub
67910>>>>>        Set Label to "œ¢á«žª"
67911>>>>>        Set Location to 105 5
67912>>>>>        Set Size to 12 35
67913>>>>>        Set TypeFace to "MS Sans Serif"
67914>>>>>    End_Object    // TextBoxSub34
67915>>>>>
67915>>>>>    Object TextBoxSub35 is a TextBoxSub
67917>>>>>        Set Label to "“§œçŸ¬¤¦ª"
67918>>>>>        Set Location to 119 5
67919>>>>>        Set Size to 12 43
67920>>>>>        Set TypeFace to "MS Sans Serif"
67921>>>>>    End_Object    // TextBoxSub35
67922>>>>>
67922>>>>>    Object TextBoxSub43 is a TextBoxSub
67924>>>>>        Set Label to "‰˜«žš.”..€."
67925>>>>>        Set Location to 78 202
67926>>>>>        Set Size to 10 46
67927>>>>>        Set TypeFace to "MS Sans Serif"
67928>>>>>    End_Object    // TextBoxSub43
67929>>>>>
67929>>>>>    Object frmCityDescr is a FormSub
67931>>>>>        Set Size to 13 81
67932>>>>>        Set Location to 63 104
67933>>>>>        Set Color to clBtnFace
67934>>>>>        Set Label_Col_Offset to 2
67935>>>>>        Set Enabled_State to FALSE
67936>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
67937>>>>>        Set Item_Shadow_State Item 0 to TRUE
67938>>>>>        Set Shadow_State Item 0 to TRUE
67939>>>>>    End_Object    // frmCityDescr
67940>>>>>
67940>>>>>    Object frmAreaDescr is a FormSub
67942>>>>>        Set Size to 13 170
67943>>>>>        Set Location to 50 321
67944>>>>>        Set Color to clBtnFace
67945>>>>>        Set Label_Col_Offset to 2
67946>>>>>        Set Enabled_State to FALSE
67947>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
67948>>>>>        Set Item_Shadow_State Item 0 to TRUE
67949>>>>>        Set Shadow_State Item 0 to TRUE
67950>>>>>    End_Object    // frmAreaDescr
67951>>>>>
67951>>>>>    Object frmTownDescr is a FormSub
67953>>>>>        Set Size to 13 170
67954>>>>>        Set Location to 63 321
67955>>>>>        Set Color to clBtnFace
67956>>>>>        Set Label_Col_Offset to 2
67957>>>>>        Set Enabled_State to FALSE
67958>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
67959>>>>>        Set Item_Shadow_State Item 0 to TRUE
67960>>>>>        Set Shadow_State Item 0 to TRUE
67961>>>>>    End_Object    // frmTownDescr
67962>>>>>
67962>>>>>    Object frmCountryDescr is a FormSub
67964>>>>>        Set Size to 13 81
67965>>>>>        Set Location to 78 104
67966>>>>>        Set Color to clBtnFace
67967>>>>>        Set Label_Col_Offset to 2
67968>>>>>        Set Enabled_State to FALSE
67969>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
67970>>>>>        Set Item_Shadow_State Item 0 to TRUE
67971>>>>>        Set Shadow_State Item 0 to TRUE
67972>>>>>    End_Object    // frmCountryDescr
67973>>>>>
67973>>>>>    Object TextBoxSub49 is a TextBoxSub
67975>>>>>        Set Label to "‘œ „¥â¢ ¥ž"
67976>>>>>        Set Location to 6 172
67977>>>>>        Set Size to 10 41
67978>>>>>        Set TypeFace to "MS Sans Serif"
67979>>>>>    End_Object    // TextBoxSub49
67980>>>>>
67980>>>>>    Object ButtonSub6 is a ButtonSub
67982>>>>>        Set Label to "ButtonSub6"
67983>>>>>        Set Bitmap to "tvwbo16.bmp"
67984>>>>>        Set Size to 10 11
67985>>>>>        Set Location to 53 493
67986>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
67987>>>>>
67987>>>>>        //AB-StoreStart
67987>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ž©žª œ¨ ¦®é¤"
67988>>>>>        Procedure OnClick
67990>>>>>           send activate_v197
67991>>>>>        End_Procedure // OnClick
67992>>>>>        
67992>>>>>        
67992>>>>>        
67992>>>>>        //AB-StoreEnd
67992>>>>>
67992>>>>>    End_Object    // ButtonSub6
67993>>>>>
67993>>>>>    Object ButtonSub7 is a ButtonSub
67995>>>>>        Set Label to "ButtonSub6"
67996>>>>>        Set Bitmap to "tvwbo16.bmp"
67997>>>>>        Set Size to 10 11
67998>>>>>        Set Location to 63 187
67999>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
68000>>>>>
68000>>>>>        //AB-StoreStart
68000>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ž©žª æ¢œà¤"
68001>>>>>        Procedure OnClick
68003>>>>>           send activate_v198
68004>>>>>        End_Procedure // OnClick
68005>>>>>        
68005>>>>>        
68005>>>>>        
68005>>>>>        
68005>>>>>        //AB-StoreEnd
68005>>>>>
68005>>>>>    End_Object    // ButtonSub7
68006>>>>>
68006>>>>>    Object ButtonSub8 is a ButtonSub
68008>>>>>        Set Label to "ButtonSub6"
68009>>>>>        Set Bitmap to "tvwbo16.bmp"
68010>>>>>        Set Size to 10 11
68011>>>>>        Set Location to 106 494
68012>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
68013>>>>>
68013>>>>>        //AB-StoreStart
68013>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ ¡˜«˜®é¨ž©žª œ¢˜«é¤"
68014>>>>>        Procedure OnClick
68016>>>>>           send activate_vwclients
68017>>>>>        End_Procedure // OnClick
68018>>>>>        
68018>>>>>        
68018>>>>>        
68018>>>>>        
68018>>>>>        
68018>>>>>        //AB-StoreEnd
68018>>>>>
68018>>>>>    End_Object    // ButtonSub8
68019>>>>>
68019>>>>>    Object Textbox2 is a Textbox
68021>>>>>        Set Label to "„å›¦ª „¨š¦¬"
68022>>>>>        Set Location to 6 223
68023>>>>>        Set Size to 10 42
68024>>>>>        Set TypeFace to "MS Sans Serif"
68025>>>>>    End_Object    // Textbox2
68026>>>>>
68026>>>>>    Object Textbox8 is a Textbox
68028>>>>>        Set Label to "„šš¬ž«.œ§ ©«¦¢ã"
68029>>>>>        Set Location to 121 321
68030>>>>>        Set Size to 10 57
68031>>>>>        Set TypeFace to "MS Sans Serif"
68032>>>>>    End_Object    // Textbox8
68033>>>>>
68033>>>>>    Object Textbox9 is a Textbox
68035>>>>>        Set Label to "†£/¤å˜"
68036>>>>>        Set Location to 122 422
68037>>>>>        Set Size to 10 23
68038>>>>>        Set TypeFace to "MS Sans Serif"
68039>>>>>    End_Object    // Textbox9
68040>>>>>
68040>>>>>    Object Cn_Sum_Pct_Tper is a dbFormSub
68042>>>>>        Entry_Item Cn.Sum_pct_tper
68043>>>>>        Set Label to "‰à› ë¨š¦¬ Metro"
68044>>>>>        Set Size to 13 42
68045>>>>>        Set Location to 88 451
68046>>>>>        Set Label_Col_Offset to 2
68047>>>>>        Set Label_Justification_Mode to jMode_Right
68048>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
68049>>>>>
68049>>>>>        //AB-StoreStart
68049>>>>>                            
68049>>>>>        Set Points          Item 0 to   0
68050>>>>>        Set Numeric_Mask    Item 0 to 3 0
68051>>>>>        
68051>>>>>        //AB-StoreEnd
68051>>>>>
68051>>>>>    End_Object    // Cn_Sum_Pct_Tper
68052>>>>>
68052>>>>>    Object Cn_Cn_Codematch is a dbFormSub
68054>>>>>        Entry_Item Cn.Cn_codematch
68055>>>>>        Set Size to 13 63
68056>>>>>        Set Location to 76 321
68057>>>>>        Set Color to clBtnFace
68058>>>>>        Set TextColor to 185
68059>>>>>        Set Label_Col_Offset to 2
68060>>>>>        Set Label_Justification_Mode to jMode_Right
68061>>>>>        Set Enabled_State to FALSE
68062>>>>>        Set Form_FontWeight Item 0 to 600
68063>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
68064>>>>>        Set Item_Shadow_State Item 0 to TRUE
68065>>>>>        Set Shadow_State Item 0 to TRUE
68066>>>>>    End_Object    // Cn_Cn_Codematch
68067>>>>>
68067>>>>>
68067>>>>>    //AB-StoreStart
68067>>>>>    set verify_data_loss_msg    to get_no_confirmation
68068>>>>>    set verify_exit_msg         to get_no_confirmation
68069>>>>>    
68069>>>>>    Procedure Activate_View Returns Integer
68071>>>>>        Integer rVal igrid iDec
68072>>>>>        String scncode
68072>>>>>        Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDec
68073>>>>>        Move (cnzones_(dbtabpagesub6(dbtabdialogsub1(Self)))) to igrid
68074>>>>>        Set Points of igrid Item 3       to iDec
68075>>>>>        Set Points of igrid Item 4       to iDec
68076>>>>>        Set Points of igrid Item 5       to iDec
68077>>>>>        Set Numeric_Mask of igrid Item 3 to 14 iDec '*, '
68078>>>>>        Set Numeric_Mask of igrid Item 4 to 14 iDec '*, '
68079>>>>>        Set Numeric_Mask of igrid Item 5 to 14 iDec '*, '
68080>>>>>    //    set visible_state of (the_table1(dbtabpagesub2(dbtabdialogsub1(self)))) to false
68080>>>>>        Forward Get Msg_Activate_View to rVal
68082>>>>>        If (pscncode(Self)<>'') Begin
68084>>>>>            Clear CN
68085>>>>>            Move (psCNCode(Self)) to CN.CN_Code
68086>>>>>            Find eq CN by Index.5
68087>>>>>>
68087>>>>>            If (Found) Send Request_Find of CN_DD eq CN.File_Number 5
68090>>>>>    //        Send Clear to cn_dd
68090>>>>>    //        Get pscncode to scncode
68090>>>>>    //        Move scncode to cn.cn_code
68090>>>>>    //        Send Find to cn_dd eq 5
68090>>>>>            Set pscncode to ''
68091>>>>>        End
68091>>>>>>
68091>>>>>    
68091>>>>>        Procedure_Return rVal
68092>>>>>    End_Procedure
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    
68093>>>>>    //AB-StoreEnd
68093>>>>>
68093>>>>>End_Object    // V041
68094>>>>>
68094>>>>>
68094>>>>>//AB-StoreStart
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>                                
68094>>>>>//AB-StoreEnd
68094>>>>>
68094>>>>>//AB/ End_Object    // prj
68094>>>    open pmoves
68096>>>    open cmoves
68098>>>    //AB-StoreTopEnd
68098>>>
68098>>>    //AB-IgnoreStart
68098>>>
68098>>>    Use dbView.Sub
68098>>>    Use DFAllEnt.pkg
68098>>>    Use Txtbox.Sub
68098>>>    Use dbGrid.Sub
68098>>>    Use Button.Sub
68098>>>    Use dbForm.Sub
68098>>>
68098>>>    Use COMPANY.DD
68098>>>    Use BRANCH.DD
68098>>>    Use CTYPKIN.DD
68098>>>    Use COUNTRY.DD
68098>>>    Use TOWNS.DD
68098>>>    Use CITIES.DD
68098>>>    Use AREAS.DD
68098>>>    Use PAYRESP.DD
68098>>>    Use CLIENTS.DD
68098>>>    Use CMOVES.DD
68098>>>    Use CMOVESA.DD
68098>>>    Use COPEN.DD
INCLUDING FILE: COPEN.DD
68098>>>>>//DDB-FileStart
68098>>>>>//DDB-HeaderStart
68098>>>>>
68098>>>>>// File Name : COPEN.DD
68098>>>>>// Class Name: Copen_DataDictionary
68098>>>>>// Revision  : 67
68098>>>>>// Version   : 2
68098>>>>>
68098>>>>>Use  Windows           // Basic Definitions
68098>>>>>Use  DataDict          // DataDictionary Class Definition
68098>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68098>>>>>
68098>>>>>Open Copen
68100>>>>>Open Cmoves
68102>>>>>Open Cmovesa
68104>>>>>Open Sysrecc
68106>>>>>Open Syscurxr
68108>>>>>
68108>>>>>//DDB-HeaderEnd
68108>>>>>//DDB-ValidationStart
68108>>>>>
68108>>>>>Register_Object Copen_Copen_C_Code2_VT
68108>>>>>Register_Object Copen_Copen_M_Code_VT
68108>>>>>
68108>>>>>Object Copen_Copen_C_Code2_VT  is a CodeValidationTable
68110>>>>>    Set Type_Value        To "CURRENCY"
68111>>>>>    Set Allow_Blank_State To TRUE
68112>>>>>    //DDB-ValidationCustomStart
68112>>>>>    //DDB-ValidationCustomEnd
68112>>>>>End_Object   // Copen_Copen_C_Code2_VT
68113>>>>>
68113>>>>>Object Copen_Copen_M_Code_VT  is a CodeValidationTable
68115>>>>>    Set Type_Value        To "MODULE"
68116>>>>>    Set Allow_Blank_State To TRUE
68117>>>>>    //DDB-ValidationCustomStart
68117>>>>>    //DDB-ValidationCustomEnd
68117>>>>>End_Object   // Copen_Copen_M_Code_VT
68118>>>>>//DDB-ValidationEnd
68118>>>>>
68118>>>>>Class Copen_DataDictionary  is a DataDictionary_Sec
68119>>>>>
68119>>>>>    Procedure Save_Main_File
68120>>>>>        If (Operation_Origin<>Self) Begin
68122>>>>>            If Copen.Recnum Eq 0 Procedure_Return
68125>>>>>        End
68125>>>>>>
68125>>>>>        Forward Send Save_Main_File
68127>>>>>    End_Procedure
68128>>>>>
68128>>>>>    Procedure Default_Initial_Amount Integer iField Number nVal
68129>>>>>        Integer iChanged
68130>>>>>        Get Field_Changed_State iField to iChanged
68131>>>>>        If ((iChanged=0) And (nVal=0)) Begin
68133>>>>>            If (Cmoves.Axia_ypol_sysx<=CmovesA.Axia_ypol_sysx) ;                 Set Field_Default_Value iField to Cmoves.Axia_ypol_sysx
68136>>>>>            Else Set Field_Default_Value iField to CmovesA.Axia_ypol_sysx
68138>>>>>        End
68138>>>>>>
68138>>>>>    End_procedure
68139>>>>>
68139>>>>>    Procedure Construct_Object
68140>>>>>        Forward Send Construct_Object
68142>>>>>        Property Integer piCmovesID         Public 0
68143>>>>>        Property Integer piIsSaved          Public 0
68144>>>>>        Property Integer piFromBP           Public 0
68145>>>>>        Property Integer piNotMoveSyscurXr  Public 0
68146>>>>>    End_Procedure
68147>>>>>
68147>>>>>    Procedure End_Construct_Object
68148>>>>>        Integer iCmovesID
68149>>>>>        Forward Send End_Construct_Object
68151>>>>>        Move (Find_Server_DDO(Self,Cmoves.File_Number)) to iCmovesID
68152>>>>>        Set piCmovesID to iCmovesID
68153>>>>>    End_Procedure
68154>>>>>
68154>>>>>     Procedure Creating
68155>>>>>        Forward Send Creating
68157>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Copen.Copen_Rec0)))))) to Copen.Copen_Recr
68158>>>>>    End_Procedure   // Creating
68159>>>>>
68159>>>>>    Procedure Update
68160>>>>>        Forward Send Update
68162>>>>>        // Insert Code Here
68162>>>>>        Move SysCurXR.Company_Code  to Copen.Company_Code
68163>>>>>        Move SysCurXR.Branch_Code   to Copen.Branch_Code
68164>>>>>        Move SysCurXR.Year_Year     to Copen.Year_Year
68165>>>>>        Move Clients.Client_ID      to Copen.Client_ID
68166>>>>>        Move Ctypkin.Ctypkin_Code   to Copen.Ctypkin_Code
68167>>>>>
68167>>>>>        Move 0 to Copen.Copen_X0
68168>>>>>        Move 0 to Copen.Copen_P0
68169>>>>>        If      (Cmovesa.Cmoves_X0 <> 0) Move Copen.Copen_Axia0 to Copen.Copen_X0
68172>>>>>        Else If (Cmovesa.Cmoves_P0 <> 0) Move Copen.Copen_Axia0 to Copen.Copen_P0
68176>>>>>        Move Cmovesa.Cmoves_Recr    to Copen.Cmovesa_Recr
68177>>>>>        
68177>>>>>        Add Copen.Copen_Axia0       to Cmoves.Axia_Sysxet
68178>>>>>    End_Procedure   // Update
68179>>>>>
68179>>>>>    Procedure Backout
68180>>>>>        Forward Send Backout
68182>>>>>        Sub Copen.Copen_Axia0   From Cmoves.Axia_Sysxet
68183>>>>>    End_Procedure //backout
68184>>>>>
68184>>>>>
68184>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
68185>>>>>        String lsError_Message
68186>>>>>        Case Begin
68186>>>>>            //˜§æ validate save
68186>>>>>
68186>>>>>            Case (iError_Num = 1006)
68188>>>>>                Move "DDC 009:€›ç¤˜«ž ž œšš¨˜­ã. \n’¦ §¦©æ ƒ„Œ £§¦¨œå ¤˜ œå¤˜  0" to lsError_Message
68189>>>>>            Case Break
68190>>>>>            Case (iError_Num = 1010)
68193>>>>>                Move "DDC 009:€›ç¤˜«ž ž œšš¨˜­ã. \n¦©æ ‘¬©®â« ©žª £ž›œ¤ ¡æ" to lsError_Message
68194>>>>>            Case Break
68195>>>>>            Case (iError_Num = 1011)
68198>>>>>                Move "DDC 009:€›ç¤˜«ž ž œšš¨˜­ã. \n’¦ §¦©æ ©¬©®â« ©žª â®œ  ¬§œ¨™œå \n’¦ › ˜Ÿâ© £¦ §¦©æ §¨¦ª ©¬©®â« ©ž" to lsError_Message
68199>>>>>            Case Break
68200>>>>>            Case (iError_Num = 1012)
68203>>>>>                Move "DDC 009:€›ç¤˜«ž ž œšš¨˜­ã. \n’¦ ¦©æ ©¬©®â« ©žª â®œ  ¬§œ¨™œå \n’¦ ¬§æ¢¦ §¦¬ §¦©¦ç §¨¦ª ©¬©®â« ©ž" to lsError_Message
68204>>>>>            Case Break
68205>>>>>
68205>>>>>            Case (iError_Num = 10001)
68208>>>>>                Move "DDC 009:ƒœ¤ £§æ¨œ©˜ ¤˜ œ§˜¤˜«¦§¦Ÿœ«žŸé \n©«ž¤ «¨â®¦¬©˜ œšš¨˜­ã \n’¦ ˜¨®œå¦ â®œ  ¬§¦©«œå ž£ á \n•¨œå˜œ«˜  ˜¤˜› ¦¨šá¤à©ž" to lsError_Message
68209>>>>>            Case Break
68210>>>>>            //˜§æ validate delete
68210>>>>>            Case (iError_Num = 10002)
68213>>>>>                Move "DDC 009:€›ç¤˜«ž ž › ˜š¨˜­ã. \nƒœ¤ ™¨å©¡à š ˜ › ˜š¨˜­ã «ž¤ ©¬©®œ« ©£â¤ž (˜¤«å©«¨¦­ž) œšš¨˜­ã" to lsError_Message
68214>>>>>            Case Break
68215>>>>>            Case (iError_Num = 1101)
68218>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                to lsError_Message
68219>>>>>            Case Break
68220>>>>>            Case (iError_Num = 1102)
68223>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                to lsError_Message
68224>>>>>            Case Break
68225>>>>>            Case (iError_Num = 1103)
68228>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                to lsError_Message
68229>>>>>            Case Break
68230>>>>>            Case (iError_Num = 1104)
68233>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                to lsError_Message
68234>>>>>            Case Break
68235>>>>>            //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
68235>>>>>            Case (iError_Num = 1105)
68238>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                to lsError_Message
68239>>>>>            Case Break
68240>>>>>            Case (iError_Num = 1106)
68243>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                to lsError_Message
68244>>>>>            Case Break
68245>>>>>            Case (iError_Num = 1107)
68248>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                to lsError_Message
68249>>>>>            Case Break
68250>>>>>            Case (iError_Num = 1108)
68253>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                to lsError_Message
68254>>>>>            Case Break
68255>>>>>            //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
68255>>>>>            Case (iError_Num = 1109)
68258>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                to lsError_Message
68259>>>>>            Case Break
68260>>>>>            Case (iError_Num = 1110)
68263>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                to lsError_Message
68264>>>>>            Case Break
68265>>>>>            Case (iError_Num = 1111)
68268>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                to lsError_Message
68269>>>>>            Case Break
68270>>>>>            Case (iError_Num = 1112)
68273>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                to lsError_Message
68274>>>>>            Case Break
68275>>>>>            //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
68275>>>>>            Case (iError_Num = 1113)
68278>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                to lsError_Message
68279>>>>>            Case Break
68280>>>>>            Case (iError_Num = 1114)
68283>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                to lsError_Message
68284>>>>>            Case Break
68285>>>>>            Case (iError_Num = 1115)
68288>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                to lsError_Message
68289>>>>>            Case Break
68290>>>>>            Case (iError_Num = 1116)
68293>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                to lsError_Message
68294>>>>>            Case Break
68295>>>>>            //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
68295>>>>>            Case (iError_Num = 1117)
68298>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                to lsError_Message
68299>>>>>            Case Break
68300>>>>>            Case (iError_Num = 1118)
68303>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                to lsError_Message
68304>>>>>            Case Break
68305>>>>>            Case (iError_Num = 1119)
68308>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                to lsError_Message
68309>>>>>            Case Break
68310>>>>>            Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
68313>>>>>                Move ("DDC 009:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã.\n\n"+;                "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                to lsError_Message
68314>>>>>            Case Break
68315>>>>>
68315>>>>>            Case (iError_Num = 1009)
68318>>>>>                Clear Codemast
68319>>>>>                Move "MODULE" to Codemast.Type
68320>>>>>                Move Cmoves.Module_From to Codemast.Code
68321>>>>>                Find Eq Codemast by Index.1 //type+code
68322>>>>>>
68322>>>>>                Move ("DDC 009:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
68323>>>>>            Case Break
68324>>>>>
68324>>>>>
68324>>>>>            //˜§æ validate delete
68324>>>>>            Case (iError_Num = 2001)
68327>>>>>                Move ("DDC 009:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ P.I.S. !");                to lsError_Message
68328>>>>>            Case Break
68329>>>>>
68329>>>>>            Case Else
68329>>>>>                Forward Send Operation_Not_Allowed iError_Num
68331>>>>>        Case End
68331>>>>>
68331>>>>>        Error iError_Num lsError_Message
68332>>>>>>
68332>>>>>    End_Procedure   //operation_not_allowed
68333>>>>>
68333>>>>>   
68333>>>>>   
68333>>>>>    Function Validate_Save Returns Integer
68334>>>>>        Integer iReturnVal
68335>>>>>        Forward Get Validate_Save to iReturnVal
68337>>>>>        If (Not(iReturnVal)) Begin
68339>>>>>                 If     (Copen.Copen_Axia0               = 0)    Send Operation_Not_Allowed 1006
68342>>>>>//            Else If (Not(Copen.Copen_M_Code = gs_Module_Code))   Send Operation_Not_Allowed 1009
68342>>>>>            Else If (Copen.Copen_Axia0=0)                        Send Operation_Not_Allowed 1010
68346>>>>>            Else If (Copen.Copen_Axia0>Cmoves.Axia_pros_sysx)    Send Operation_Not_Allowed 1011
68350>>>>>        End
68350>>>>>>
68350>>>>>        Function_Return iReturnVal
68351>>>>>    End_Function //validate_save
68352>>>>>
68352>>>>>    Function Validate_Delete Returns Integer
68353>>>>>             Integer iReturnVal
68354>>>>>             Forward Get Validate_Delete  To iReturnVal
68356>>>>>             If (Not(iReturnVal)) Begin
68358>>>>>                If (piFromBP(Self)=0) If (Not(Copen.Copen_M_Code = gs_Module_Code)) Send Operation_Not_Allowed 2001
68363>>>>>             End
68363>>>>>>
68363>>>>>             Function_Return iReturnVal
68364>>>>>    End_Function   // validate_delete
68365>>>>>
68365>>>>>    // Define_Fields:
68365>>>>>    // This procedure is used to set up all data-dictionary rules.
68365>>>>>
68365>>>>>    Procedure Define_Fields
68366>>>>>        Forward Send Define_Fields
68368>>>>>        //DDB-Generated-Code-Location
68368>>>>>        //DDB-DefineFieldStart
68368>>>>>
68368>>>>>        Set Main_File            To Copen.File_Number
68369>>>>>        Set Cascade_Delete_State To FALSE
68370>>>>>
68370>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68371>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68372>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68373>>>>>
68373>>>>>        // Parent (Server) file structure...............
68373>>>>>        Send Add_Server_File  Cmoves.File_Number
68374>>>>>        Send Add_Server_File  Cmovesa.File_Number
68375>>>>>
68375>>>>>        // External (System) file structure.............
68375>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
68376>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
68377>>>>>
68377>>>>>        Define_Auto_Increment  Sysrecc.Copen_Rec0  To Copen.Copen_Rec0
68380>>>>>
68380>>>>>        // Field-based properties.......................
68380>>>>>
68380>>>>>        // Copen.Company_Code
68380>>>>>
68380>>>>>        // Copen.Branch_Code
68380>>>>>
68380>>>>>        // Copen.Year_Year
68380>>>>>
68380>>>>>        // Copen.Custprom_Code
68380>>>>>
68380>>>>>        // Copen.Client_Id
68380>>>>>
68380>>>>>        // Copen.Ctypkin_Code
68380>>>>>
68380>>>>>        // Copen.Cmoves_Recr
68380>>>>>
68380>>>>>        // Copen.Copen_Recr
68380>>>>>
68380>>>>>        // Copen.Copen_Rec0
68380>>>>>        Set Field_Options          Field Copen.Copen_Rec0 To DD_AUTOFIND   
68381>>>>>
68381>>>>>        // Copen.Copen_X0
68381>>>>>
68381>>>>>        // Copen.Copen_P0
68381>>>>>
68381>>>>>        // Copen.Copen_X00
68381>>>>>
68381>>>>>        // Copen.Copen_P00
68381>>>>>
68381>>>>>        // Copen.Copen_Xr
68381>>>>>
68381>>>>>        // Copen.Copen_Pr
68381>>>>>
68381>>>>>        // Copen.Copen_X2
68381>>>>>
68381>>>>>        // Copen.Copen_P2
68381>>>>>
68381>>>>>        // Copen.Copen_C_Code2
68381>>>>>        Set Field_Value_Table      Field Copen.Copen_C_Code2 To (Copen_Copen_C_Code2_VT(Self))
68382>>>>>
68382>>>>>        // Copen.Copen_M_Code
68382>>>>>        Set Field_Value_Table      Field Copen.Copen_M_Code To (Copen_Copen_M_Code_VT(Self))
68383>>>>>
68383>>>>>        // Copen.Cmovesa_Recr
68383>>>>>
68383>>>>>        // Copen.Cmovesa_Recnum
68383>>>>>
68383>>>>>        // Copen.Copen_Axia0
68383>>>>>        Set Field_Entry_msg        Field Copen.Copen_Axia0 To Default_Initial_Amount
68384>>>>>
68384>>>>>        // Copen.Copen_Axia00
68384>>>>>
68384>>>>>        // Copen.Copen_Axiar
68384>>>>>
68384>>>>>        //DDB-DefineFieldEnd
68384>>>>>    End_Procedure    // Define_Fields
68385>>>>>
68385>>>>>    // Field_Defaults:
68385>>>>>    // This procedure is used to establish default field values.
68385>>>>>
68385>>>>>    Procedure Field_Defaults
68386>>>>>        Forward Send Field_Defaults
68388>>>>>        //DDB-Generated-Code-Location
68388>>>>>        //DDB-FieldDefaultStart
68388>>>>>        //DDB-FieldDefaultEnd
68388>>>>>    End_Procedure    // Field_Defaults
68389>>>>>
68389>>>>>End_Class    // Copen_DataDictionary
68390>>>>>//DDB-FileEnd
68390>>>    Use WTYPKIN.DD
68390>>>    Use PTYPPAR.DD
68390>>>    Use NOMISMA.DD
68390>>>    Use PARTICLE.DD
68390>>>    Use WAPOKAT.DD
68390>>>    Use WAPOMAST.DD
68390>>>    Use WAX.DD
68390>>>    Use UNITS.DD
68390>>>    Use WITEMKAT.DD
68390>>>    Use FPA.DD
68390>>>    Use ITEM.DD
68390>>>    Use WITEMX.DD
68390>>>    Use PMOVES.DD
68390>>>    Use PmsDtl.DD
68390>>>    Use BAXIOKAT.DD
68390>>>    Use PMSSXET.DD
68390>>>    Use SALESMEN.DD
68390>>>    Use MHXANIK.DD
68390>>>    Use CONSTRCT.DD
68390>>>    Use CN.DD
68390>>>    Use PARTICLL.DD
INCLUDING FILE: PARTICLL.DD
68390>>>>>//DDB-FileStart
68390>>>>>//DDB-HeaderStart
68390>>>>>
68390>>>>>// File Name : PARTICLL.DD
68390>>>>>// Class Name: Particll_DataDictionary
68390>>>>>// Revision  : 1
68390>>>>>// Version   : 2
68390>>>>>
68390>>>>>Use  Windows           // Basic Definitions
68390>>>>>Use  DataDict          // DataDictionary Class Definition
68390>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68390>>>>>
68390>>>>>Open Particll
68392>>>>>Open Clients
68394>>>>>Open Ptyppar
68396>>>>>Open Nomisma
68398>>>>>
68398>>>>>//DDB-HeaderEnd
68398>>>>>Open particll
68400>>>>>Set_attribute  DF_FILE_ALIAS of particll.File_number  to DF_FILE_IS_ALIAS
68403>>>>>Set_attribute  DF_FILE_ALIAS of particle.File_number  to DF_FILE_IS_MASTER
68406>>>>>
68406>>>>>// clear the relationship in the alias file
68406>>>>>Set_relate particll.client_recr  to  |FN0,0
68407>>>>>>
68407>>>>>Set_relate particll.ptyppar_recr to |FN0,0
68408>>>>>>
68408>>>>>Set_relate particll.nomisma_code to |FN0,0
68409>>>>>>
68409>>>>>Class Particll_DataDictionary  is a DataDictionary_sec
68410>>>>>
68410>>>>>    // Define_Fields:
68410>>>>>    // This procedure is used to set up all data-dictionary rules.
68410>>>>>
68410>>>>>    Procedure Define_Fields
68411>>>>>        Forward Send Define_Fields
68413>>>>>        //DDB-Generated-Code-Location
68413>>>>>        //DDB-DefineFieldStart
68413>>>>>
68413>>>>>        Set Main_File            To Particll.File_Number
68414>>>>>
68414>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68415>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68416>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68417>>>>>
68417>>>>>        // Parent (Server) file structure...............
68417>>>>>        Send Add_Server_File  Clients.File_Number
68418>>>>>        Send Add_Server_File  Ptyppar.File_Number
68419>>>>>        Send Add_Server_File  Nomisma.File_Number
68420>>>>>
68420>>>>>        // Field-based properties.......................
68420>>>>>
68420>>>>>        // Particll.Company_Code
68420>>>>>
68420>>>>>        // Particll.Branch_Code
68420>>>>>
68420>>>>>        // Particll.Year_Year
68420>>>>>
68420>>>>>        // Particll.Ctypkin_Code
68420>>>>>
68420>>>>>        // Particll.Wtypkin_Code
68420>>>>>
68420>>>>>        // Particll.Ptyppar_Code
68420>>>>>
68420>>>>>        // Particll.Pseira_Seira
68420>>>>>
68420>>>>>        // Particll.Custprom_Code
68420>>>>>
68420>>>>>        // Particll.Client_Id
68420>>>>>
68420>>>>>        // Particll.Partl_No
68420>>>>>
68420>>>>>        // Particll.Cn_Recr
68420>>>>>
68420>>>>>        // Particll.Pseira_Recr
68420>>>>>
68420>>>>>        // Particll.Partl_Hmnia
68420>>>>>
68420>>>>>        // Particll.Partl_Rec0
68420>>>>>
68420>>>>>        // Particll.Partl_Lastno
68420>>>>>
68420>>>>>        // Particll.Partl_Tdiakin
68420>>>>>
68420>>>>>        // Particll.Partl_Car
68420>>>>>
68420>>>>>        // Particll.Partl_Reldoc
68420>>>>>
68420>>>>>        // Particll.Partl_Toposf
68420>>>>>
68420>>>>>        // Particll.Partl_Toposa
68420>>>>>
68420>>>>>        // Particll.Partl_Troposa
68420>>>>>
68420>>>>>        // Particll.Partl_Tof
68420>>>>>
68420>>>>>        // Particll.Partl_Disctof
68420>>>>>
68420>>>>>        // Particll.Partl_Disccl
68420>>>>>
68420>>>>>        // Particll.Partl_Autodisc
68420>>>>>
68420>>>>>        // Particll.Partl_Time
68420>>>>>
68420>>>>>        // Particll.Partl_Totambd
68420>>>>>
68420>>>>>        // Particll.Partl_Amdiscpms
68420>>>>>
68420>>>>>        // Particll.Partl_Totdiscpc
68420>>>>>
68420>>>>>        // Particll.Partl_Discam
68420>>>>>
68420>>>>>        // Particll.Partl_Totamad
68420>>>>>
68420>>>>>        // Particll.Partl_Vatpct
68420>>>>>
68420>>>>>        // Particll.Partl_Vatam
68420>>>>>
68420>>>>>        // Particll.Partl_Genam
68420>>>>>
68420>>>>>        // Particll.Partl_Extra
68420>>>>>
68420>>>>>        // Particll.Partl_Extravatp
68420>>>>>
68420>>>>>        // Particll.Partl_Extravat
68420>>>>>
68420>>>>>        // Particll.Partl_Payam
68420>>>>>
68420>>>>>        // Particll.Partl_Befypol
68420>>>>>
68420>>>>>        // Particll.Partl_Currypol
68420>>>>>
68420>>>>>        // Particll.Partl_Tottem
68420>>>>>
68420>>>>>        // Particll.Partl_Det
68420>>>>>
68420>>>>>        // Particll.Partl_Recr
68420>>>>>
68420>>>>>        // Particll.Cn_Code
68420>>>>>
68420>>>>>        // Particll.Client_Recr
68420>>>>>
68420>>>>>        // Particll.Ptyppar_Recr
68420>>>>>
68420>>>>>        // Particll.Partl_Ekleise
68420>>>>>
68420>>>>>        // Particll.Partl_Ekl_Recr
68420>>>>>
68420>>>>>        // Particll.Partl_Ektyposh
68420>>>>>
68420>>>>>        // Particll.Partl_Akyrosh
68420>>>>>
68420>>>>>        // Particll.Partl_Akyr_Recr
68420>>>>>
68420>>>>>        // Particll.Partl_Nooflines
68420>>>>>
68420>>>>>        // Particll.Cmoves_Recr
68420>>>>>
68420>>>>>        // Particll.Nomisma_Code
68420>>>>>
68420>>>>>        // Particll.Isotimia
68420>>>>>
68420>>>>>        // Particll.Wcmoves_Recr
68420>>>>>
68420>>>>>        // Particll.Partl_Module
68420>>>>>
68420>>>>>        // Particll.Partl_Timol
68420>>>>>
68420>>>>>        // Particll.Partl_Selected
68420>>>>>
68420>>>>>        // Particll.Partl_Tim_Recr
68420>>>>>
68420>>>>>        // Particll.Partl_Vsn
68420>>>>>
68420>>>>>        // Particll.Sls_Id
68420>>>>>
68420>>>>>        // Particll.Presp_Id
68420>>>>>
68420>>>>>        // Particll.Cnt_Id
68420>>>>>
68420>>>>>        // Particll.Topos_Apostolhs
68420>>>>>
68420>>>>>        // Particll.Tropos_Diakin
68420>>>>>
68420>>>>>        // Particll.Ora_Apostolhs
68420>>>>>
68420>>>>>        // Particll.Skopos_Diakin
68420>>>>>
68420>>>>>        // Particll.Tropos_Plhromhs
68420>>>>>
68420>>>>>        // Particll.Odhgos_Code
68420>>>>>
68420>>>>>        // Particll.Odhgos_Name
68420>>>>>
68420>>>>>        // Particll.Oxhma_Code
68420>>>>>
68420>>>>>        // Particll.Oxhma_Descr
68420>>>>>
68420>>>>>        // Particll.Antlia_Code
68420>>>>>
68420>>>>>        // Particll.Antlia_Descr
68420>>>>>
68420>>>>>        // Particll.Partl_Euro
68420>>>>>
68420>>>>>        // Particll.Disc_Vat_Pct
68420>>>>>
68420>>>>>        // Particll.Disc_Vat_Poso
68420>>>>>
68420>>>>>        // Particll.Total_Vat_Poso
68420>>>>>
68420>>>>>        // Particll.Exei_Sxetika
68420>>>>>
68420>>>>>        // Particll.Aitiol
68420>>>>>
68420>>>>>        // Particll.Max_Days_Date
68420>>>>>
68420>>>>>        // Particll.Timol_Qty
68420>>>>>
68420>>>>>        // Particll.Timol_Ypol
68420>>>>>
68420>>>>>        // Particll.Epilogh_Ekkrem
68420>>>>>
68420>>>>>        // Particll.No_Print_Module
68420>>>>>
68420>>>>>        // Particll.Prohg_Ypol
68420>>>>>
68420>>>>>        // Particll.Trex_Ypol
68420>>>>>
68420>>>>>        // Particll.Parakrat_Pct
68420>>>>>
68420>>>>>        // Particll.Parakrat_Poso
68420>>>>>
68420>>>>>        // Particll.Cms_Parak_Recr
68420>>>>>
68420>>>>>        // Particll.Enhm_Logik
68420>>>>>
68420>>>>>        // Particll.Se_Logik
68420>>>>>
68420>>>>>        //DDB-DefineFieldEnd
68420>>>>>    End_Procedure    // Define_Fields
68421>>>>>
68421>>>>>    // Field_Defaults:
68421>>>>>    // This procedure is used to establish default field values.
68421>>>>>
68421>>>>>    Procedure Field_Defaults
68422>>>>>        Forward Send Field_Defaults
68424>>>>>        //DDB-Generated-Code-Location
68424>>>>>        //DDB-FieldDefaultStart
68424>>>>>        //DDB-FieldDefaultEnd
68424>>>>>    End_Procedure    // Field_Defaults
68425>>>>>
68425>>>>>End_Class    // Particll_DataDictionary
68426>>>>>//DDB-FileEnd
68426>>>    Use PSXETIKA.DD
68426>>>    Use DORDERH.DD
INCLUDING FILE: DORDERH.DD
68426>>>>>//DDB-FileStart
68426>>>>>//DDB-HeaderStart
68426>>>>>
68426>>>>>// File Name : DORDERH.DD
68426>>>>>// Class Name: Dorderh_DataDictionary
68426>>>>>// Revision  : 24
68426>>>>>// Version   : 2
68426>>>>>
68426>>>>>Use  Windows           // Basic Definitions
68426>>>>>Use  DataDict          // DataDictionary Class Definition
68426>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68426>>>>>
68426>>>>>Open Dorderh
68428>>>>>Open Dorderd
INCLUDING FILE: DORDERD.FD
68430>>>>>Open Cn
68432>>>>>Open Sysrecc
68434>>>>>
68434>>>>>//DDB-HeaderEnd
68434>>>>>//DDB-ValidationStart
68434>>>>>
68434>>>>>Register_Object Dorderh_Status_VT
68434>>>>>
68434>>>>>Object Dorderh_Status_VT  is a CodeValidationTable
68436>>>>>    Set Type_Value        To "PR_STATUS"
68437>>>>>    //DDB-ValidationCustomStart
68437>>>>>    //DDB-ValidationCustomEnd
68437>>>>>End_Object   // Dorderh_Status_VT
68438>>>>>//DDB-ValidationEnd
68438>>>>>
68438>>>>>Class Dorderh_DataDictionary  is a DataDictionary_Sec
68439>>>>> 
68439>>>>>    Procedure Construct_Object
68440>>>>>        Forward Send Construct_Object
68442>>>>>        Property String psOldID Public ''
68443>>>>>    End_Procedure
68444>>>>> 
68444>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
68445>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
68447>>>>>        Set psOldID to DorderH.DorderH_ID 
68448>>>>>    End_Procedure   // New_Current_Record
68449>>>>> 
68449>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
68450>>>>>        If (iError_Num=15000) Error 15000 'DDC 051: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡à› ¡¦ç ©«¦ ž£œ¨ã© ¦ ›œ¢«å¦ §˜¨˜ššœ¢å˜ª'
68453>>>>>        Forward Send Operation_Not_Allowed  iError_Num
68455>>>>>    End_Procedure   // Operation_Not_Allowed
68456>>>>> 
68456>>>>>    Function Validate_Save  Returns Integer
68457>>>>>        Local Integer iReturnVal
68458>>>>>        Forward Get Validate_Save  To iReturnVal
68460>>>>>        If (Not(iReturnVal)) Begin
68462>>>>>            If ((psOldID(Self)<>'') And (psOldID(Self)<>DorderH.DorderH_ID)) Send Operation_Not_Allowed 15000
68465>>>>>        End
68465>>>>>>
68465>>>>>        Function_Return iReturnVal
68466>>>>>    End_Function   // Validate_Save
68467>>>>> 
68467>>>>>    Procedure Creating
68468>>>>>        Number nOra nLepta
68469>>>>>        String  sOra sLepta
68469>>>>>        Forward Send Creating
68471>>>>>        Get fsLoginUserID           to DorderH.DorderH_User
68472>>>>>        Move SysCurXr.Company_Code  to DorderH.Company_Code
68473>>>>>
68473>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(DorderH.DORDERH_Rec0)))))) ;                                    to DorderH.DORDERH_Recr
68474>>>>>        
68474>>>>>        //prosoxh ton kodiko ton kanoyme exapsifio mono gia thessaloniki
68474>>>>>        //gts 20-07-06
68474>>>>>        /////////////////////Get fsgCode_With_Zeroes DORDERH.DORDERH_Rec0 5 SysCurXr.Company_Code SysCurXr.Branch_Code ;
68474>>>>>        /////////////////////                            to DORDERH.DORDERH_ID
68474>>>>>        
68474>>>>>        // Allagh 12/06/2007 js
68474>>>>>        // Xrhsimopoioume to pedio "SYSRECW.WTYPPAR_REC0" gia na paroume
68474>>>>>        // parametrika ton arithmo ton psifion pou tha apoteloun ton kodiko
68474>>>>>        // ths paraggelias. Prostethike epishs to pedio sthn othonh ton
68474>>>>>        // statheron systhmatos "V00.vw" gia na prosarmosoume ta ypokatasthmata
68474>>>>>        If (SYSRECW.WTYPPAR_REC0<>0) ;            Get fsgCode_With_Zeroes DORDERH.DORDERH_Rec0 SYSRECW.WTYPPAR_REC0 SysCurXr.Company_Code SysCurXr.Branch_Code to DORDERH.DORDERH_ID
68477>>>>>        Else ;            Get fsgCode_With_Zeroes DORDERH.DORDERH_Rec0 5 SysCurXr.Company_Code SysCurXr.Branch_Code to DORDERH.DORDERH_ID
68479>>>>>
68479>>>>>    End_Procedure   // Creating
68480>>>>> 
68480>>>>>    Procedure Update
68481>>>>>        Number  nOra nLepta
68482>>>>>        String  sOra sLepta
68482>>>>>        Date    dHmnia
68482>>>>>        Forward Send Update
68484>>>>>        Move Clients.Client_ID  to DorderH.Client_ID
68485>>>>>        Move Cn.CN_SiteW        to DorderH.DorderH_SiteW
68486>>>>>        Move Cn.CN_Code         to DorderH.CN_Code
68487>>>>>        
68487>>>>>        If (DorderH.DorderH_Date='') Begin
68489>>>>>            SysDate dHmnia
68490>>>>>            Move dHmnia to DorderH.DorderH_Date
68491>>>>>        End
68491>>>>>>
68491>>>>>        If (DorderH.DorderH_Time='') Begin
68493>>>>>            SysDate dHmnia nOra nLepta
68496>>>>>            Move nOra           to sOra
68497>>>>>            Move nLepta         to sLepta
68498>>>>>            Move (Trim(sOra))   to sOra
68499>>>>>            Move (Trim(sLepta)) to sLepta
68500>>>>>            If (Length(sOra  )=1) Insert '0' in sOra    at 1
68504>>>>>            If (Length(sLepta)=1) Insert '0' in sLepta  at 1
68508>>>>>            Move (sOra-sLepta)  to DorderH.DorderH_Time
68509>>>>>        End
68509>>>>>>
68509>>>>>    End_Procedure   // Update
68510>>>>> 
68510>>>>>    // Define_Fields:
68510>>>>>    // This procedure is used to set up all data-dictionary rules.
68510>>>>>
68510>>>>>    Procedure Define_Fields
68511>>>>>        Forward Send Define_Fields
68513>>>>>        //DDB-Generated-Code-Location
68513>>>>>        //DDB-DefineFieldStart
68513>>>>>
68513>>>>>        Set Main_File            To Dorderh.File_Number
68514>>>>>        Set Cascade_Delete_State To FALSE
68515>>>>>
68515>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68516>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68517>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68518>>>>>
68518>>>>>        // Child (Client) file structure................
68518>>>>>        Send Add_Client_File  Dorderd.File_Number
68519>>>>>
68519>>>>>        // Parent (Server) file structure...............
68519>>>>>        Send Add_Server_File  Cn.File_Number
68520>>>>>
68520>>>>>        // External (System) file structure.............
68520>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
68521>>>>>
68521>>>>>        Define_Auto_Increment  Sysrecc.Dorderh_Rec0  To Dorderh.Dorderh_Rec0
68524>>>>>
68524>>>>>        // Field-based properties.......................
68524>>>>>
68524>>>>>        // Dorderh.Company_Code
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Id
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Rec0
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Date
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_User
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Sitew
68524>>>>>
68524>>>>>        // Dorderh.Cn_Recr
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Sxolia
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Totam
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Who
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Amover
68524>>>>>
68524>>>>>        // Dorderh.Dorderh_Time
68524>>>>>        Set Field_Mask             Field Dorderh.Dorderh_Time To "##:##"
68525>>>>>
68525>>>>>        // Dorderh.Dorderh_Recr
68525>>>>>
68525>>>>>        // Dorderh.Cn_Code
68525>>>>>
68525>>>>>        // Dorderh.Client_Id
68525>>>>>
68525>>>>>        // Dorderh.Status
68525>>>>>        Set Field_Value_Table      Field Dorderh.Status To (Dorderh_Status_VT(Self))
68526>>>>>
68526>>>>>        //DDB-DefineFieldEnd
68526>>>>>    End_Procedure    // Define_Fields
68527>>>>>
68527>>>>>    // Field_Defaults:
68527>>>>>    // This procedure is used to establish default field values.
68527>>>>>
68527>>>>>    Procedure Field_Defaults
68528>>>>>        Forward Send Field_Defaults
68530>>>>>        //DDB-Generated-Code-Location
68530>>>>>        //DDB-FieldDefaultStart
68530>>>>>        Set Field_Changed_Value   Field Dorderh.Status To "1"
68531>>>>>        //DDB-FieldDefaultEnd
68531>>>>>    End_Procedure    // Field_Defaults
68532>>>>>
68532>>>>>End_Class    // Dorderh_DataDictionary
68533>>>>>//DDB-FileEnd
68533>>>    Use CLNBANK.DD
68533>>>    Use DORDERD.DD
INCLUDING FILE: DORDERD.DD
68533>>>>>//DDB-FileStart
68533>>>>>//DDB-HeaderStart
68533>>>>>
68533>>>>>// File Name : DORDERD.DD
68533>>>>>// Class Name: Dorderd_DataDictionary
68533>>>>>// Revision  : 23
68533>>>>>// Version   : 2
68533>>>>>
68533>>>>>Use  Windows           // Basic Definitions
68533>>>>>Use  DataDict          // DataDictionary Class Definition
68533>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68533>>>>>
68533>>>>>Open Dorderd
68535>>>>>Open Dorderh
68537>>>>>Open Sysrecc
68539>>>>>
68539>>>>>//DDB-HeaderEnd
68539>>>>>//DDB-ValidationStart
68539>>>>>
68539>>>>>Register_Object Dorderd_Pumpm_VT1
68539>>>>>Register_Object Dorderd_Kathish_VT
68539>>>>>
68539>>>>>Object Dorderd_Pumpm_VT1  is a CodeValidationTable
68541>>>>>    Set Type_Value        To "PUMPSXR"
68542>>>>>    Set Allow_Blank_State To TRUE
68543>>>>>    Set Table_Title       To "‰à› ¡¦å ®¨âà©žª ˜¤«¢å˜ª"
68544>>>>>    //DDB-ValidationCustomStart
68544>>>>>    //DDB-ValidationCustomEnd
68544>>>>>End_Object   // Dorderd_Pumpm_VT1
68545>>>>>
68545>>>>>Object Dorderd_Kathish_VT  is a CodeValidationTable
68547>>>>>    Set Type_Value        To "KATISH"
68548>>>>>    Set Allow_Blank_State To TRUE
68549>>>>>    //DDB-ValidationCustomStart
68549>>>>>    //DDB-ValidationCustomEnd
68549>>>>>End_Object   // Dorderd_Kathish_VT
68550>>>>>//DDB-ValidationEnd
68550>>>>>//DDB-SelectionStart
68550>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
68550>>>>>Register_Object sl053
68550>>>>>//DDB-SelectionEnd
68550>>>>>Open ItemL
68552>>>>>
68552>>>>>Class Dorderd_DataDictionary is a DataDictionary_Sec
68553>>>>> 
68553>>>>>    Function Validate_Delete  Returns Integer
68554>>>>>        Local Integer iReturnVal
68555>>>>>        Forward Get Validate_Delete  To iReturnVal
68557>>>>>        If (Not(iReturnVal)) Begin
68559>>>>>            If (DorderD.Qty_Se_Progr>0) Error 6000 'DDC 061: “§á¨®œ  §¦©æ«ž«˜ ©œ §¨¦š¨˜££˜« ©£æ\nƒœ¤ £§¦¨œå«œ ¤˜ › ˜š¨á¯œ«œ «ž¤ œšš¨˜­ã'            
68562>>>>>        End
68562>>>>>>
68562>>>>>        Function_Return iReturnVal
68563>>>>>    End_Function   // Validate_Delete
68564>>>>>    
68564>>>>>    Function fsItemQual String sItemCode Returns String
68565>>>>>        Clear ItemL
68566>>>>>        move sItemCode to ItemL.Item_Code
68567>>>>>        Find Eq ItemL by Index.5
68568>>>>>>
68568>>>>>        Function_Return ItemL.Item_Qual
68569>>>>>    End_Function
68570>>>>>
68570>>>>>    Procedure Request_Save
68571>>>>>        Forward Send Request_Save
68573>>>>>        If (DorderD.Recnum) Begin
68575>>>>>            Move (fsItemQual(Self,DorderD.Item_Code))   to DorderD.Quality
68576>>>>>        End
68576>>>>>>
68576>>>>>    End_Procedure
68577>>>>> 
68577>>>>>    Procedure Update
68578>>>>>        Forward Send Update
68580>>>>>        Move Cn.CN_SiteW                            to DorderD.SiteW
68581>>>>>        Move Cn.CN_Code                             to DorderD.CN_Code
68582>>>>>        Move Cn.CN_Recr                             to DorderD.CN_Recr
68583>>>>>        Move DorderH.DorderH_ID                     to DorderD.DorderH_ID
68584>>>>>        //Move (fsItemQual(Self,DorderD.Item_Code))   to DorderD.Quality
68584>>>>>        Move (Trim(DorderD.Deop_ID)='')             to DorderD.Not_Ex_Deop
68585>>>>>        Move (DateToWeekDay(DorderD.Hmnia_Parad))   to DorderD.DateW
68586>>>>>        
68586>>>>>        Move (Round_Number((DorderD.Posothta*DorderD.Timh_Monados),2)) ;                                                    to DorderD.TotAm
68587>>>>>        Add DorderD.TotAm                           to DorderH.DorderH_TotAm
68588>>>>>        Add DorderD.TotAm                           to Clients.Posa_Apo_Parag
68589>>>>>        Move (DorderD.Posothta-DorderD.Qty_Se_Progr) to DorderD.Ypol_Posothta
68590>>>>>        If (DorderD.Ypol_Posothta<0) Error 6001 'DDC 061: “§æ¢¦ §¦ §¦©æ«ž«˜ª < 0'            
68593>>>>>    End_Procedure   // Update
68594>>>>>
68594>>>>>    Procedure Backout
68595>>>>>        Forward Send Backout
68597>>>>>        Sub DorderD.TotAm From DorderH.DorderH_TotAm
68598>>>>>        Sub DorderD.TotAm From Clients.Posa_Apo_Parag
68599>>>>>    End_Procedure   // Backout
68600>>>>>
68600>>>>>    Procedure Define_Fields
68601>>>>>        Forward Send Define_Fields
68603>>>>>        //DDB-Generated-Code-Location
68603>>>>>        //DDB-DefineFieldStart
68603>>>>>
68603>>>>>        Set Main_File            To Dorderd.File_Number
68604>>>>>
68604>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68605>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68606>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68607>>>>>
68607>>>>>        // Parent (Server) file structure...............
68607>>>>>        Send Add_Server_File  Dorderh.File_Number
68608>>>>>
68608>>>>>        // External (System) file structure.............
68608>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
68609>>>>>
68609>>>>>        Define_Auto_Increment  Sysrecc.Dorderd_Rec0  To Dorderd.Dorderd_Rec0
68612>>>>>
68612>>>>>        // Field-based properties.......................
68612>>>>>
68612>>>>>        // Dorderd.Dorderh_Recr
68612>>>>>
68612>>>>>        // Dorderd.Quality
68612>>>>>
68612>>>>>        // Dorderd.Hmnia_Parad
68612>>>>>
68612>>>>>        // Dorderd.Ora_Parad
68612>>>>>        Set Field_Mask             Field Dorderd.Ora_Parad To "##:##"
68613>>>>>
68613>>>>>        // Dorderd.Posothta
68613>>>>>
68613>>>>>        // Dorderd.Ypol_Posothta
68613>>>>>
68613>>>>>        // Dorderd.Timh_Monados
68613>>>>>
68613>>>>>        // Dorderd.Sxolia
68613>>>>>
68613>>>>>        // Dorderd.Sitew
68613>>>>>
68613>>>>>        // Dorderd.Company_Code
68613>>>>>
68613>>>>>        // Dorderd.Dorderh_Id
68613>>>>>
68613>>>>>        // Dorderd.Item_Code
68613>>>>>
68613>>>>>        // Dorderd.Pump_Id
68613>>>>>        Set Field_Prompt_Object    Field Dorderd.Pump_Id To (sl053(Self))
68614>>>>>
68614>>>>>        // Dorderd.Deop_Id
68614>>>>>
68614>>>>>        // Dorderd.Btmcode1
68614>>>>>
68614>>>>>        // Dorderd.Btmcode2
68614>>>>>
68614>>>>>        // Dorderd.Btmcode3
68614>>>>>
68614>>>>>        // Dorderd.Pumpm
68614>>>>>        Set Field_Value_Table      Field Dorderd.Pumpm To (Dorderd_Pumpm_VT1(Self))
68615>>>>>
68615>>>>>        // Dorderd.Dorderd_Rec0
68615>>>>>
68615>>>>>        // Dorderd.Datew
68615>>>>>
68615>>>>>        // Dorderd.Caronstime
68615>>>>>
68615>>>>>        // Dorderd.Not_Ex_Deop
68615>>>>>        Set Field_Checkbox_Values  Field Dorderd.Not_Ex_Deop To "1"  "0"
68616>>>>>        Set Field_Class_Name       Field Dorderd.Not_Ex_Deop To "dbCheckBoxsub"
68617>>>>>
68617>>>>>        // Dorderd.Totam
68617>>>>>
68617>>>>>        // Dorderd.Qty_Se_Progr
68617>>>>>
68617>>>>>        // Dorderd.Kathish
68617>>>>>        Set Field_Value_Table      Field Dorderd.Kathish To (Dorderd_Kathish_VT(Self))
68618>>>>>
68618>>>>>        // Dorderd.Loipes_Xreoseis
68618>>>>>        Set Field_Checkbox_Values  Field Dorderd.Loipes_Xreoseis To "1"  "0"
68619>>>>>        Set Field_Class_Name       Field Dorderd.Loipes_Xreoseis To "dbCheckBoxsub"
68620>>>>>
68620>>>>>        // Dorderd.Selected
68620>>>>>
68620>>>>>        // Dorderd.Xhmika_Prosth
68620>>>>>
68620>>>>>        // Dorderd.Mhtres
68620>>>>>
68620>>>>>        // Dorderd.Cn_Code
68620>>>>>
68620>>>>>        // Dorderd.Cn_Recr
68620>>>>>
68620>>>>>        //DDB-DefineFieldEnd
68620>>>>>    End_Procedure    // Define_Fields
68621>>>>>
68621>>>>>    Procedure Field_Defaults
68622>>>>>        Forward Send Field_Defaults
68624>>>>>        //DDB-Generated-Code-Location
68624>>>>>        //DDB-FieldDefaultStart
68624>>>>>        //DDB-FieldDefaultEnd
68624>>>>>    End_Procedure    // Field_Defaults
68625>>>>>
68625>>>>>End_Class    // Dorderd_DataDictionary
68626>>>>>//DDB-Selection-pkg-Start
68626>>>>>
68626>>>>>Use sl053.SL         // sl053
68626>>>>>
68626>>>>>//DDB-Selection-pkg-End
68626>>>>>//DDB-FileEnd
68626>>>    Use ZONES.DD
68626>>>    Use BRZONES.DD
68626>>>    Use CNZONES.DD
68626>>>    Use TPCLIENT.DD
68626>>>    Use TPERGA.DD
68626>>>    Use TPARTICL.DD
68626>>>    Use CMOVESA2.DD
INCLUDING FILE: CMOVESA2.DD
68626>>>>>//DDB-FileStart
68626>>>>>//DDB-HeaderStart
68626>>>>>
68626>>>>>// File Name : CMOVESA2.DD
68626>>>>>// Class Name: Cmovesa2_DataDictionary
68626>>>>>// Revision  : 0
68626>>>>>// Version   : 2
68626>>>>>
68626>>>>>Use  Windows           // Basic Definitions
68626>>>>>Use  DataDict          // DataDictionary Class Definition
68626>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68626>>>>>
68626>>>>>Open Cmovesa2
INCLUDING FILE: CMOVESA2.FD
68628>>>>>Open Ctypkin
68630>>>>>Open Clients
68632>>>>>
68632>>>>>//DDB-HeaderEnd
68632>>>>>//open master file
68632>>>>>Open Cmoves
68634>>>>>
68634>>>>>//define alias-master condition
68634>>>>>Set_Attribute DF_FILE_ALIAS of Cmoves.File_Number   to DF_FILE_IS_MASTER
68637>>>>>Set_Attribute DF_FILE_ALIAS of Cmovesa2.File_Number to DF_FILE_IS_ALIAS
68640>>>>>
68640>>>>>Set_Relate Cmovesa2.Ctypkin_Recr     to |FN0,0
68641>>>>>>
68641>>>>>Set_Relate Cmovesa2.Client_Recr      to |FN0,0
68642>>>>>>
68642>>>>>
68642>>>>>Class Cmovesa2_DataDictionary  is a DataDictionary_Sec
68643>>>>>
68643>>>>>    // Define_Fields:
68643>>>>>    // This procedure is used to set up all data-dictionary rules.
68643>>>>>
68643>>>>>    Procedure Define_Fields
68644>>>>>        Forward Send Define_Fields
68646>>>>>        //DDB-Generated-Code-Location
68646>>>>>        //DDB-DefineFieldStart
68646>>>>>
68646>>>>>        Set Main_File            To Cmovesa2.File_Number
68647>>>>>
68647>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68648>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68649>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68650>>>>>
68650>>>>>        // Parent (Server) file structure...............
68650>>>>>        Send Add_Server_File  Ctypkin.File_Number
68651>>>>>        Send Add_Server_File  Clients.File_Number
68652>>>>>
68652>>>>>        // Field-based properties.......................
68652>>>>>
68652>>>>>        // Cmovesa2.Company_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Branch_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Year_Year
68652>>>>>
68652>>>>>        // Cmovesa2.Custprom_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Client_Id
68652>>>>>
68652>>>>>        // Cmovesa2.Ctypkin_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Recr
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Rec0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Hmnia
68652>>>>>
68652>>>>>        // Cmovesa2.Ctypkin_Recr
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Par
68652>>>>>
68652>>>>>        // Cmovesa2.Partl_Recr
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Axia
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_X0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_P0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_X00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_P00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_X1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_P1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_X2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_P2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Dlixis
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_A_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Status_E
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Status_A
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_S0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Ys0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_S1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Ys1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_S2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Ys2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Sc_Code2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Aopen
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_M_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Yn_Myf
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Myf_Axia
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Kk
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_C_Code2
68652>>>>>
68652>>>>>        // Cmovesa2.Cn_Code
68652>>>>>
68652>>>>>        // Cmovesa2.Client_Recr
68652>>>>>
68652>>>>>        // Cmovesa2.Barticl_Recr
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Qty
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Totambd0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Discam0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Totamad0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Vatam0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Extra0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Totambd00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Discam00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Totamad00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Vatam00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Extra00
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Totambd1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Discam1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Totamad1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Vatam1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmove_Extra1
68652>>>>>
68652>>>>>        // Cmovesa2.Module_From
68652>>>>>
68652>>>>>        // Cmovesa2.Parast_Abrev
68652>>>>>
68652>>>>>        // Cmovesa2.Enhm_Ypol_Pel
68652>>>>>
68652>>>>>        // Cmovesa2.Enhm_Hmnies_Pel
68652>>>>>
68652>>>>>        // Cmovesa2.Sls_Id
68652>>>>>
68652>>>>>        // Cmovesa2.Presp_Id
68652>>>>>
68652>>>>>        // Cmovesa2.Cnt_Id
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Sx0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Sp0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Yx0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Yp0
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Sx1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Sp1
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Sx2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Open_Sp2
68652>>>>>
68652>>>>>        // Cmovesa2.Cmoves_Topen
68652>>>>>
68652>>>>>        // Cmovesa2.Cn_Recr
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Pros_Sysx
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Sysxet
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Ypol_Sysx
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Pros_Sys00
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Sysxet00
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Ypol_Sys00
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Pros_Sysr
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Sysxetr
68652>>>>>
68652>>>>>        // Cmovesa2.Axia_Ypol_Sysr
68652>>>>>
68652>>>>>        // Cmovesa2.Mhxanik_Id
68652>>>>>
68652>>>>>        // Cmovesa2.Prn_Theor
68652>>>>>
68652>>>>>        // Cmovesa2.Is_Closed
68652>>>>>
68652>>>>>        // Cmovesa2.Flag_Copen
68652>>>>>
68652>>>>>        // Cmovesa2.Flag_Ypol
68652>>>>>
68652>>>>>        // Cmovesa2.Ctypkin_Descr
68652>>>>>
68652>>>>>        // Cmovesa2.Client_Name
68652>>>>>
68652>>>>>        // Cmovesa2.Enhm_Ofeilh
68652>>>>>
68652>>>>>        //DDB-DefineFieldEnd
68652>>>>>    End_Procedure    // Define_Fields
68653>>>>>
68653>>>>>    // Field_Defaults:
68653>>>>>    // This procedure is used to establish default field values.
68653>>>>>
68653>>>>>    Procedure Field_Defaults
68654>>>>>        Forward Send Field_Defaults
68656>>>>>        //DDB-Generated-Code-Location
68656>>>>>        //DDB-FieldDefaultStart
68656>>>>>        //DDB-FieldDefaultEnd
68656>>>>>    End_Procedure    // Field_Defaults
68657>>>>>
68657>>>>>End_Class    // Cmovesa2_DataDictionary
68658>>>>>//DDB-FileEnd
68658>>>    Use CLORDER.DD
INCLUDING FILE: CLORDER.DD
68658>>>>>//DDB-FileStart
68658>>>>>//DDB-HeaderStart
68658>>>>>
68658>>>>>// File Name : CLORDER.DD
68658>>>>>// Class Name: Clorder_DataDictionary
68658>>>>>// Revision  : 34
68658>>>>>// Version   : 2
68658>>>>>
68658>>>>>Use  Windows           // Basic Definitions
68658>>>>>Use  DataDict          // DataDictionary Class Definition
68658>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68658>>>>>
68658>>>>>Open Clorder
68660>>>>>Open Clorderd
68662>>>>>Open Clients
68664>>>>>Open Sysrecc
68666>>>>>Open Codetype
INCLUDING FILE: CODETYPE.FD
68668>>>>>
68668>>>>>//DDB-HeaderEnd
68668>>>>>//DDB-ValidationStart
68668>>>>>
68668>>>>>Register_Object Clorder_Tropos_VT
68668>>>>>Register_Object Clorder_How_Pay_VT
68668>>>>>
68668>>>>>Object Clorder_Tropos_VT  is a CodeValidationTable
68670>>>>>    Set Type_Value        To "SEND_TERMS"
68671>>>>>    Set Validate_State    To FALSE
68672>>>>>    Set Allow_Blank_State To TRUE
68673>>>>>    Set Table_Title       To "’¨æ§¦  ˜¨á›¦©žª"
68674>>>>>    //DDB-ValidationCustomStart
68674>>>>>    //DDB-ValidationCustomEnd
68674>>>>>End_Object   // Clorder_Tropos_VT
68675>>>>>
68675>>>>>Object Clorder_How_Pay_VT  is a CodeValidationTable
68677>>>>>    Set Type_Value        To "PAY_TERMS"
68678>>>>>    Set Validate_State    To FALSE
68679>>>>>    Set Allow_Blank_State To TRUE
68680>>>>>    Set Table_Title       To "’¨æ§¦  ¢ž¨à£ãª"
68681>>>>>    //DDB-ValidationCustomStart
68681>>>>>    //DDB-ValidationCustomEnd
68681>>>>>End_Object   // Clorder_How_Pay_VT
68682>>>>>//DDB-ValidationEnd
68682>>>>>//DDB-SelectionStart
68682>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
68682>>>>>Register_Object slNomism
68682>>>>>//DDB-SelectionEnd
68682>>>>>  
68682>>>>>Class Clorder_DataDictionary  is a DataDictionary_Sec
68683>>>>>
68683>>>>>    // Define_Fields:
68683>>>>>    // This procedure is used to set up all data-dictionary rules.
68683>>>>>
68683>>>>>    Procedure Define_Fields
68684>>>>>        Forward Send Define_Fields
68686>>>>>        //DDB-Generated-Code-Location
68686>>>>>        //DDB-DefineFieldStart
68686>>>>>
68686>>>>>        Set Main_File            To Clorder.File_Number
68687>>>>>        Set Cascade_Delete_State To FALSE
68688>>>>>
68688>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68689>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68690>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68691>>>>>
68691>>>>>        // Child (Client) file structure................
68691>>>>>        Send Add_Client_File  Clorderd.File_Number
68692>>>>>
68692>>>>>        // Parent (Server) file structure...............
68692>>>>>        Send Add_Server_File  Clients.File_Number
68693>>>>>
68693>>>>>        // External (System) file structure.............
68693>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
68694>>>>>        Send Add_System_File  Codetype.File_Number  DD_LOCK_ON_ALL
68695>>>>>
68695>>>>>        // Field-based properties.......................
68695>>>>>
68695>>>>>        // Clorder.Company_Code
68695>>>>>
68695>>>>>        // Clorder.Branch_Code
68695>>>>>
68695>>>>>        // Clorder.Year_Year
68695>>>>>
68695>>>>>        // Clorder.Aapar
68695>>>>>
68695>>>>>        // Clorder.Clients_Code
68695>>>>>
68695>>>>>        // Clorder.Armod
68695>>>>>
68695>>>>>        // Clorder.Order1_Recr
68695>>>>>
68695>>>>>        // Clorder.Rec0
68695>>>>>
68695>>>>>        // Clorder.Recr
68695>>>>>
68695>>>>>        // Clorder.Our_Date
68695>>>>>        Set Field_Mask_Type        Field Clorder.Our_Date To MASK_DATE_WINDOW
68696>>>>>
68696>>>>>        // Clorder.Rial_Date
68696>>>>>        Set Field_Mask_Type        Field Clorder.Rial_Date To MASK_DATE_WINDOW
68697>>>>>
68697>>>>>        // Clorder.Qty
68697>>>>>
68697>>>>>        // Clorder.Unitprice
68697>>>>>
68697>>>>>        // Clorder.Disc
68697>>>>>
68697>>>>>        // Clorder.Fpa
68697>>>>>
68697>>>>>        // Clorder.Net
68697>>>>>
68697>>>>>        // Clorder.Extra
68697>>>>>
68697>>>>>        // Clorder.Total
68697>>>>>
68697>>>>>        // Clorder.Aaparprom
68697>>>>>
68697>>>>>        // Clorder.Tropos
68697>>>>>        Set Field_Value_Table      Field Clorder.Tropos To (Clorder_Tropos_VT(Self))
68698>>>>>
68698>>>>>        // Clorder.Date
68698>>>>>        Set Field_Entry_msg        Field Clorder.Date To Entry_clorder_date
68699>>>>>        Set Field_Mask_Type        Field Clorder.Date To MASK_DATE_WINDOW
68700>>>>>
68700>>>>>        // Clorder.How_Pay
68700>>>>>        Set Field_Value_Table      Field Clorder.How_Pay To (Clorder_How_Pay_VT(Self))
68701>>>>>
68701>>>>>        // Clorder.Finish
68701>>>>>        Set Field_Mask             Field Clorder.Finish To "#"
68702>>>>>        Set Field_Mask_Type        Field Clorder.Finish To MASK_NUMERIC_WINDOW
68703>>>>>
68703>>>>>        // Clorder.Okey
68703>>>>>        Set Field_Mask             Field Clorder.Okey To "#"
68704>>>>>        Set Field_Mask_Type        Field Clorder.Okey To MASK_NUMERIC_WINDOW
68705>>>>>
68705>>>>>        // Clorder.Akyrh
68705>>>>>        Set Field_Mask             Field Clorder.Akyrh To "#"
68706>>>>>        Set Field_Mask_Type        Field Clorder.Akyrh To MASK_NUMERIC_WINDOW
68707>>>>>
68707>>>>>        // Clorder.Sxolia
68707>>>>>
68707>>>>>        // Clorder.Posodtl
68707>>>>>
68707>>>>>        // Clorder.Qtydtl
68707>>>>>
68707>>>>>        // Clorder.Nomisma
68707>>>>>        Set Field_Prompt_Object    Field Clorder.Nomisma To (slNomism(Self))
68708>>>>>
68708>>>>>        // Clorder.Module
68708>>>>>
68708>>>>>        // Clorder.Codetype
68708>>>>>
68708>>>>>        //DDB-DefineFieldEnd
68708>>>>>    End_Procedure    // Define_Fields
68709>>>>>
68709>>>>>     Procedure Update
68710>>>>>        Forward Send Update
68712>>>>>        move syscurxr.company_code to clorder.company_code
68713>>>>>        move syscurxr.branch_code  to clorder.branch_code
68714>>>>>        move syscurxr.year_year    to clorder.year_year
68715>>>>>        MOVE CODETYPE.TYPE         to clorder.codetype
68716>>>>>        // Insert Code Here
68716>>>>>    End_Procedure   // Update
68717>>>>>
68717>>>>>
68717>>>>>
68717>>>>>
68717>>>>>    Procedure Creating
68718>>>>>        if (clorder.module <> '01') move '02' to clorder.module
68721>>>>>        if (clorder.module = '01') begin
68723>>>>>           move (sysrecc.clorderc_rec0 + 1) to clorder.rec0
68724>>>>>           move clorder.rec0 to sysrecc.clorderc_rec0
68725>>>>>           saverecord sysrecc
68726>>>>>        end
68726>>>>>>
68726>>>>>        else begin
68727>>>>>           move (sysrecc.clorder_rec0 + 1) to clorder.rec0
68728>>>>>           move clorder.rec0 to sysrecc.clorder_rec0
68729>>>>>           saverecord sysrecc
68730>>>>>        end
68730>>>>>>
68730>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(clorder.rec0)))))) to clorder.recr
68731>>>>>        Move clorder.recr to clorder.aapar
68732>>>>>        move clorder.date to clients.last_order
68733>>>>>    End_Procedure   //
68734>>>>>    // Field_Defaults:
68734>>>>>    // This procedure is used to establish default field values.
68734>>>>>
68734>>>>>     Procedure Entry_clorder_date Integer iField Date dDate
68735>>>>>         Local Integer Changed
68736>>>>>         Get Field_Changed_State iField to Changed
68737>>>>>         If ( Changed=0 AND dDate = 0) Begin
68739>>>>>           SysDate4 dDate
68740>>>>>           Set Field_Default_Value iField to dDate
68741>>>>>         End
68741>>>>>>
68741>>>>>    End_Procedure
68742>>>>>
68742>>>>>
68742>>>>>    Procedure Field_Defaults
68743>>>>>        Forward Send Field_Defaults
68745>>>>>        //DDB-Generated-Code-Location
68745>>>>>        //DDB-FieldDefaultStart
68745>>>>>        //DDB-FieldDefaultEnd
68745>>>>>    End_Procedure    // Field_Defaults
68746>>>>>
68746>>>>>End_Class    // Clorder_DataDictionary
68747>>>>>//DDB-Selection-pkg-Start
68747>>>>>
68747>>>>>Use slnomism.sl      // slNomism
68747>>>>>
68747>>>>>//DDB-Selection-pkg-End
68747>>>>>//DDB-FileEnd
68747>>>    Use CLORDERD.DD
INCLUDING FILE: CLORDERD.DD
68747>>>>>//DDB-FileStart
68747>>>>>//DDB-HeaderStart
68747>>>>>
68747>>>>>// File Name : CLORDERD.DD
68747>>>>>// Class Name: Clorderd_DataDictionary
68747>>>>>// Revision  : 52
68747>>>>>// Version   : 2
68747>>>>>
68747>>>>>Use  Windows           // Basic Definitions
68747>>>>>Use  DataDict          // DataDictionary Class Definition
68747>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68747>>>>>
68747>>>>>Open Clorderd
68749>>>>>Open Clorder
68751>>>>>Open Sysrecc
68753>>>>>Open Iteml
68755>>>>>Open Witemcl
68757>>>>>
68757>>>>>//DDB-HeaderEnd
68757>>>>>
68757>>>>>Open Clorder
68759>>>>>
68759>>>>>Class Clorderd_DataDictionary  is a DataDictionary_Sec
68760>>>>>
68760>>>>>       Procedure Creating
68761>>>>>        string sitem sprom
68762>>>>>        Forward Send Creating
68764>>>>>        // Insert Code Here
68764>>>>>        if (clorder.module <> '01') move '02' to clorder.module
68767>>>>>        if (clorderd.module = '01') begin
68769>>>>>           move (sysrecc.clorderdc_rec0 + 1) to clorderd.rec0
68770>>>>>           move clorderd.rec0 to sysrecc.clorderdc_rec0
68771>>>>>           saverecord sysrecc
68772>>>>>        end
68772>>>>>>
68772>>>>>        else begin
68773>>>>>           move (sysrecc.clorderd_rec0 + 1) to clorderd.rec0
68774>>>>>           move clorderd.rec0 to sysrecc.clorderd_rec0
68775>>>>>           saverecord sysrecc
68776>>>>>        end
68776>>>>>>
68776>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(clorderd.rec0)))))) to clorderd.recr
68777>>>>>
68777>>>>>        if (clorder.module = '02') Begin
68779>>>>>          clear witemcl
68780>>>>>          Move clorderd.item_code   to witemcl.item_code
68781>>>>>          Move clorder.clients_code to witemcl.client_code
68782>>>>>          find eq witemcl by index.1
68783>>>>>>
68783>>>>>          move witemcl.client_itemcode to clorderd.client_item
68784>>>>>        end
68784>>>>>>
68784>>>>>
68784>>>>>       End_Procedure   // Creating
68785>>>>>
68785>>>>>
68785>>>>>    // Backout:
68785>>>>>
68785>>>>>    Procedure Backout
68786>>>>>        Forward Send Backout
68788>>>>>
68788>>>>>        // Insert Code Here
68788>>>>>        sub clorderd.Qty            from clorder.qty
68789>>>>>        sub clorderd.posofpa        from clorder.fpa
68790>>>>>        sub clorderd.posodisc       from clorder.disc
68791>>>>>        sub clorderd.posoextra      from clorder.extra
68792>>>>>        sub clorderd.posototal      from clorder.total
68793>>>>>        sub clorderd.net            from clorder.net
68794>>>>>        sub clorderd.kinish_posothta from clorder.qtydtl
68795>>>>>        sub clorderd.kinhsh_poso     from clorder.posodtl
68796>>>>>    End_Procedure   // Backout
68797>>>>>
68797>>>>>
68797>>>>>
68797>>>>>    Procedure Update
68798>>>>>        Forward Send Update
68800>>>>>        number nQtykinhsh nTimhMon nQtyTimhMon nPctEkpt nPosoEkpt nPosoNet
68801>>>>>        number nPctFpa nPosoFpa npososynolo
68801>>>>>        move syscurxr.company_code to clorderd.company_code
68802>>>>>        move syscurxr.branch_code  to clorderd.branch_code
68803>>>>>        move syscurxr.year_year    to clorderd.year_year
68804>>>>>        move clorder.aapar         to clorderd.aa_par
68805>>>>>        move clorder.clients_code  to clorderd.clients_code
68806>>>>>        move clorder.date          to clorderd.date
68807>>>>>        move clorder.module        to clorderd.module
68808>>>>>        if (clorderd.ourdate = "") begin
68810>>>>>            move clorder.our_date to clorderd.ourdate
68811>>>>>        end
68811>>>>>>
68811>>>>>        Move (round_number((clorderd.qty*clorderd.unitprice),2))   to clorderd.net
68812>>>>>        Move (Round_number(((clorderd.net*clorderd.pcdisc/100)),2)) ;                                                           to clorderd.posodisc
68813>>>>>        Move (clorderd.net-clorderd.posodisc)              to clorderd.net
68814>>>>>        Move (Round_number(((clorderd.net*clorderd.pcfpa/100)),2));                                                           to clorderd.posofpa
68815>>>>>        Move (clorderd.net+clorderd.posofpa+clorderd.posoextra) to clorderd.posototal
68816>>>>>        Add clorderd.Qty          to clorder.qty
68817>>>>>        Add clorderd.posofpa      to clorder.fpa
68818>>>>>        Add clorderd.posodisc     to clorder.disc
68819>>>>>        Add clorderd.posoextra    to clorder.extra
68820>>>>>        Add clorderd.posototal    to clorder.total
68821>>>>>        add clorderd.net          to clorder.net
68822>>>>>
68822>>>>>
68822>>>>>        move clorderd.kinish_posothta to nQtykinhsh
68823>>>>>        move clorderd.unitprice   To nTimhMon
68824>>>>>        if ((nQtykinhsh<>0) or (nTimhMon<>0)) begin
68826>>>>>           Move (round_number((nQtykinhsh*nTimhMon),2)) to nQtyTimhMon
68827>>>>>           move clorderd.pcdisc     To nPctEkpt
68828>>>>>           move clorderd.posodisc   To nPosoEkpt
68829>>>>>           Move  (Round_number(((nQtyTimhMon*nPctEkpt/100)),2)) to nPosoEkpt
68830>>>>>           Move (nQtyTimhMon-nPosoEkpt)                         To nPosoNet
68831>>>>>           move nPosonet to clorderd.kinhsh_net
68832>>>>>           move clorderd.pcfpa      To nPctFpa
68833>>>>>           move clorderd.posofpa    To nPosoFpa
68834>>>>>           Move (Round_number(((nPosoNet*nPctFpa/100)),2)) to nPosoFpa
68835>>>>>           move nPosoFpa to clorderd.kinhsh_fpa
68836>>>>>           Move (nPosoNet+nPosoFpa) to npososynolo
68837>>>>>           move npososynolo to clorderd.kinhsh_poso
68838>>>>>           add clorderd.kinish_posothta to clorder.qtydtl
68839>>>>>           add clorderd.kinhsh_poso     to clorder.posodtl
68840>>>>>        end
68840>>>>>>
68840>>>>>
68840>>>>>
68840>>>>>
68840>>>>>
68840>>>>>        // Insert Code Here
68840>>>>>    End_Procedure   // Update
68841>>>>>
68841>>>>>    Procedure Entry_clorder_fpa Integer iField number nfpa
68842>>>>>         Local Integer Changed
68843>>>>>         string sitem
68843>>>>>         Get Field_Changed_State iField to Changed
68844>>>>>         If ( Changed=0 AND nfpa = 0) Begin
68846>>>>>            clear item
68847>>>>>            move clorderd.item_code to sitem
68848>>>>>            move sitem to iteml.item_code
68849>>>>>            find eq iteml by index.5
68850>>>>>>
68850>>>>>            move iteml.fpa_pososto to nfpa
68851>>>>>            Set Field_Default_Value iField to nfpa
68852>>>>>         End
68852>>>>>>
68852>>>>>    end_procedure
68853>>>>>
68853>>>>>  // Procedure entry_clorderd_itemcode Integer iField string itemcode
68853>>>>>  //   Local Integer Changed
68853>>>>>  //   string sitem sprom
68853>>>>>  //   If (itemcode <>'') Begin
68853>>>>>  //      clear witemcl
68853>>>>>  //      get field_current_value of clorderd_dd field clorderd.item_code   to sitem
68853>>>>>  //      get field_current_value of clorder_dd  field clorder.clients_code to sprom
68853>>>>>  //      move sitem to witemcl.item_code
68853>>>>>  //      move sprom to witemcl.client_code
68853>>>>>  //      find eq witemcl by index.1
68853>>>>>  //      move witemcl.client_itemcode to itemcode
68853>>>>>  //      Set Field_Default_Value (iField+2) to itemcode
68853>>>>>  //   end
68853>>>>>  // end_Procedure
68853>>>>>
68853>>>>>    Procedure entry_clorderd_price Integer iField number nprice
68854>>>>>      Local Integer Changed
68855>>>>>      string sitem sprom
68855>>>>>      Get Field_Changed_State iField to Changed
68856>>>>>      If ( Changed=0 AND nprice = 0) Begin
68858>>>>>         clear witemcl                              
68859>>>>>         Get File_Field_Current_Value File_Field clorder.clients_code   to sProm
68860>>>>>         Get File_Field_Current_Value File_Field clorderd.item_code     to sItem
68861>>>>>//         get field_current_value of clorderd_dd field clorderd.item_code   to sitem
68861>>>>>//         get field_current_value of clorder_dd  field clorder.clients_code to sprom
68861>>>>>         move sitem to witemcl.item_code
68862>>>>>         move sprom to witemcl.client_code
68863>>>>>         find eq witemcl by index.1
68864>>>>>>
68864>>>>>         move witemcl.client_price to nprice
68865>>>>>         Set Field_Default_Value iField to nprice
68866>>>>>      end
68866>>>>>>
68866>>>>>    end_Procedure
68867>>>>>
68867>>>>>
68867>>>>>
68867>>>>>    Procedure Define_Fields
68868>>>>>        Forward Send Define_Fields
68870>>>>>        //DDB-Generated-Code-Location
68870>>>>>        //DDB-DefineFieldStart
68870>>>>>
68870>>>>>        Set Main_File            To Clorderd.File_Number
68871>>>>>        Set Cascade_Delete_State To FALSE
68872>>>>>
68872>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68873>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68874>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68875>>>>>
68875>>>>>        // Parent (Server) file structure...............
68875>>>>>        Send Add_Server_File  Clorder.File_Number
68876>>>>>
68876>>>>>        // External (System) file structure.............
68876>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
68877>>>>>        Send Add_System_File  Iteml.File_Number  DD_LOCK_ON_ALL
68878>>>>>        Send Add_System_File  Witemcl.File_Number  DD_LOCK_ON_ALL
68879>>>>>
68879>>>>>        // Field-based properties.......................
68879>>>>>
68879>>>>>        // Clorderd.Company_Code
68879>>>>>
68879>>>>>        // Clorderd.Branch_Code
68879>>>>>
68879>>>>>        // Clorderd.Year_Year
68879>>>>>
68879>>>>>        // Clorderd.Clients_Code
68879>>>>>
68879>>>>>        // Clorderd.Aa_Par
68879>>>>>
68879>>>>>        // Clorderd.Rec0
68879>>>>>
68879>>>>>        // Clorderd.Item_Code
68879>>>>>
68879>>>>>        // Clorderd.Client_Item
68879>>>>>
68879>>>>>        // Clorderd.Qty
68879>>>>>
68879>>>>>        // Clorderd.Net
68879>>>>>
68879>>>>>        // Clorderd.Pcdisc
68879>>>>>
68879>>>>>        // Clorderd.Pcfpa
68879>>>>>        Set Field_Entry_msg        Field Clorderd.Pcfpa To Entry_clorder_fpa
68880>>>>>
68880>>>>>        // Clorderd.Posodisc
68880>>>>>
68880>>>>>        // Clorderd.Posofpa
68880>>>>>
68880>>>>>        // Clorderd.Posoextra
68880>>>>>
68880>>>>>        // Clorderd.Posototal
68880>>>>>
68880>>>>>        // Clorderd.Unitprice
68880>>>>>        Set Field_Entry_msg        Field Clorderd.Unitprice To entry_clorderd_price
68881>>>>>
68881>>>>>        // Clorderd.Ourdate
68881>>>>>        Set Field_Mask_Type        Field Clorderd.Ourdate To MASK_DATE_WINDOW
68882>>>>>
68882>>>>>        // Clorderd.Rial_Date
68882>>>>>        Set Field_Mask_Type        Field Clorderd.Rial_Date To MASK_DATE_WINDOW
68883>>>>>
68883>>>>>        // Clorderd.Finish
68883>>>>>        Set Field_Mask             Field Clorderd.Finish To "#"
68884>>>>>        Set Field_Mask_Type        Field Clorderd.Finish To MASK_NUMERIC_WINDOW
68885>>>>>
68885>>>>>        // Clorderd.Clorder_Recr
68885>>>>>
68885>>>>>        // Clorderd.Kinish_Posothta
68885>>>>>
68885>>>>>        // Clorderd.Kinhsh_Poso
68885>>>>>
68885>>>>>        // Clorderd.Kinhsh_Fpa
68885>>>>>
68885>>>>>        // Clorderd.Kinhsh_Net
68885>>>>>
68885>>>>>        // Clorderd.Rial_Qty
68885>>>>>
68885>>>>>        // Clorderd.Akyrh
68885>>>>>        Set Field_Mask             Field Clorderd.Akyrh To "#"
68886>>>>>        Set Field_Mask_Type        Field Clorderd.Akyrh To MASK_NUMERIC_WINDOW
68887>>>>>
68887>>>>>        // Clorderd.Ypol_Qty
68887>>>>>
68887>>>>>        // Clorderd.Akyrh_Qty
68887>>>>>
68887>>>>>        // Clorderd.Epistrofh_Qty
68887>>>>>
68887>>>>>        // Clorderd.Status
68887>>>>>        Set Field_Mask             Field Clorderd.Status To "#"
68888>>>>>        Set Field_Mask_Type        Field Clorderd.Status To MASK_NUMERIC_WINDOW
68889>>>>>
68889>>>>>        // Clorderd.Date
68889>>>>>        Set Field_Mask_Type        Field Clorderd.Date To MASK_DATE_WINDOW
68890>>>>>
68890>>>>>        // Clorderd.Recr
68890>>>>>
68890>>>>>        // Clorderd.Wax_Recr
68890>>>>>
68890>>>>>        // Clorderd.Pmoves_Recr
68890>>>>>
68890>>>>>        // Clorderd.Module
68890>>>>>
68890>>>>>        //DDB-DefineFieldEnd
68890>>>>>    End_Procedure    // Define_Fields
68891>>>>>
68891>>>>>    // Field_Defaults:
68891>>>>>    // This procedure is used to establish default field values.
68891>>>>>
68891>>>>>    Procedure Field_Defaults
68892>>>>>        Forward Send Field_Defaults
68894>>>>>        //DDB-Generated-Code-Location
68894>>>>>        //DDB-FieldDefaultStart
68894>>>>>        //DDB-FieldDefaultEnd
68894>>>>>    End_Procedure    // Field_Defaults
68895>>>>>
68895>>>>>End_Class    // Clorderd_DataDictionary
68896>>>>>//DDB-FileEnd
68896>>>    Use CLITEM.DD
68896>>>    Use PARTLFPA.DD
68896>>>    Use BTNORDH.DD
68896>>>    Use BTNORDD.DD
68896>>>    Use PMOVESL.DD
INCLUDING FILE: PMOVESL.DD
68896>>>>>//DDB-FileStart
68896>>>>>//DDB-HeaderStart
68896>>>>>
68896>>>>>// File Name : PMOVESL.DD
68896>>>>>// Class Name: Pmovesl_DataDictionary
68896>>>>>// Revision  : 5
68896>>>>>// Version   : 2
68896>>>>>
68896>>>>>Use  Windows           // Basic Definitions
68896>>>>>Use  DataDict          // DataDictionary Class Definition
68896>>>>>Use  DDvalTbl          // Validation Table Class Definitions
68896>>>>>
68896>>>>>Open Pmovesl
68898>>>>>Open Wax
68900>>>>>Open Witemx
68902>>>>>Open Particle
68904>>>>>
68904>>>>>//DDB-HeaderEnd
68904>>>>>Open pmovesl
68906>>>>>Set_attribute  DF_FILE_ALIAS of pmovesl.File_number to DF_FILE_IS_ALIAS
68909>>>>>Set_attribute  DF_FILE_ALIAS of pmoves.File_number  to DF_FILE_IS_MASTER
68912>>>>>
68912>>>>>// clear the relationship in the alias file
68912>>>>>Set_relate pmovesl.wax_recr to  |FN0,0
68913>>>>>>
68913>>>>>Set_relate pmovesl.witemx_recr to |FN0,0
68914>>>>>>
68914>>>>>Set_relate pmovesl.partl_recr to |FN0,0
68915>>>>>>
68915>>>>>Class Pmovesl_DataDictionary  is a DataDictionary_Sec
68916>>>>>
68916>>>>>    // Define_Fields:
68916>>>>>    // This procedure is used to set up all data-dictionary rules.
68916>>>>>
68916>>>>>    Procedure Define_Fields
68917>>>>>        Forward Send Define_Fields
68919>>>>>        //DDB-Generated-Code-Location
68919>>>>>        //DDB-DefineFieldStart
68919>>>>>
68919>>>>>        Set Main_File            To Pmovesl.File_Number
68920>>>>>        Set Cascade_Delete_State To FALSE
68921>>>>>
68921>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
68922>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
68923>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
68924>>>>>
68924>>>>>        // Parent (Server) file structure...............
68924>>>>>        Send Add_Server_File  Wax.File_Number
68925>>>>>        Send Add_Server_File  Witemx.File_Number
68926>>>>>        Send Add_Server_File  Particle.File_Number
68927>>>>>
68927>>>>>        // Field-based properties.......................
68927>>>>>
68927>>>>>        // Pmovesl.Company_Code
68927>>>>>
68927>>>>>        // Pmovesl.Branch_Code
68927>>>>>
68927>>>>>        // Pmovesl.Year_Year
68927>>>>>
68927>>>>>        // Pmovesl.Ctypkin_Code
68927>>>>>
68927>>>>>        // Pmovesl.Wtypkin_Code
68927>>>>>
68927>>>>>        // Pmovesl.Custprom_Code
68927>>>>>
68927>>>>>        // Pmovesl.Client_Id
68927>>>>>
68927>>>>>        // Pmovesl.Cn_Code
68927>>>>>
68927>>>>>        // Pmovesl.Ptyppar_Code
68927>>>>>
68927>>>>>        // Pmovesl.Partl_Hmnia
68927>>>>>
68927>>>>>        // Pmovesl.Pseira_Seira
68927>>>>>
68927>>>>>        // Pmovesl.Partl_No
68927>>>>>
68927>>>>>        // Pmovesl.Partl_Rec0
68927>>>>>
68927>>>>>        // Pmovesl.Witemkat_Code
68927>>>>>
68927>>>>>        // Pmovesl.Units_Code
68927>>>>>
68927>>>>>        // Pmovesl.Item_Code
68927>>>>>
68927>>>>>        // Pmovesl.Witemx_Code
68927>>>>>
68927>>>>>        // Pmovesl.Wapokat_Code
68927>>>>>
68927>>>>>        // Pmovesl.Wapomast_Code
68927>>>>>
68927>>>>>        // Pmovesl.Wax_Code
68927>>>>>
68927>>>>>        // Pmovesl.Wax_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Witemx_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Partl_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Rec0
68927>>>>>
68927>>>>>        // Pmovesl.Pms_No
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Unitcode
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Qty
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Unitprice
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Ambd
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Pctdisc
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Discam
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Amaftdisc
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Vatpct
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Vatam
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Exrampct
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Exdet
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Payable
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Axia
68927>>>>>
68927>>>>>        // Pmovesl.Pms_X0
68927>>>>>
68927>>>>>        // Pmovesl.Pms_P0
68927>>>>>
68927>>>>>        // Pmovesl.Pms_X00
68927>>>>>
68927>>>>>        // Pmovesl.Pms_P00
68927>>>>>
68927>>>>>        // Pmovesl.Pms_X1
68927>>>>>
68927>>>>>        // Pmovesl.Pms_P1
68927>>>>>
68927>>>>>        // Pmovesl.Pms_X2
68927>>>>>
68927>>>>>        // Pmovesl.Pms_P2
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Dlixis
68927>>>>>
68927>>>>>        // Pmovesl.Pms_A_Code
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Status_E
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Status_A
68927>>>>>
68927>>>>>        // Pmovesl.Pms_S0
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Ys0
68927>>>>>
68927>>>>>        // Pmovesl.Pms_S1
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Ys1
68927>>>>>
68927>>>>>        // Pmovesl.Pms_S2
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Ys2
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Sc_Code2
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Open
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Aopen
68927>>>>>
68927>>>>>        // Pmovesl.Pms_M_Code
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Yn_Myf
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Myf_Axia
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Kk
68927>>>>>
68927>>>>>        // Pmovesl.Pms_C_Code2
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Cn_Code
68927>>>>>
68927>>>>>        // Pmovesl.Wcmoves_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Module
68927>>>>>
68927>>>>>        // Pmovesl.Btnl2_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Btnemp_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Btarticle_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Sls_Id
68927>>>>>
68927>>>>>        // Pmovesl.Presp_Id
68927>>>>>
68927>>>>>        // Pmovesl.Cnt_Id
68927>>>>>
68927>>>>>        // Pmovesl.Mhxanik_Id
68927>>>>>
68927>>>>>        // Pmovesl.Extra_Epimer
68927>>>>>
68927>>>>>        // Pmovesl.Ekpt_Epimer
68927>>>>>
68927>>>>>        // Pmovesl.Clorderd_Recr
68927>>>>>
68927>>>>>        // Pmovesl.Witemx_Descr
68927>>>>>
68927>>>>>        // Pmovesl.Ptyppar_Descr
68927>>>>>
68927>>>>>        // Pmovesl.Ti_Typonei_Pms
68927>>>>>
68927>>>>>        // Pmovesl.Timol_Qty
68927>>>>>
68927>>>>>        // Pmovesl.Timol_Ypol
68927>>>>>
68927>>>>>        // Pmovesl.Posa_Apo_Dap
68927>>>>>
68927>>>>>        // Pmovesl.Qty_Ypol
68927>>>>>
68927>>>>>        // Pmovesl.Pms_Selected
68927>>>>>
68927>>>>>        // Pmovesl.Qty_Kinhshs
68927>>>>>
68927>>>>>        //DDB-DefineFieldEnd
68927>>>>>    End_Procedure    // Define_Fields
68928>>>>>
68928>>>>>    // Field_Defaults:
68928>>>>>    // This procedure is used to establish default field values.
68928>>>>>
68928>>>>>    Procedure Field_Defaults
68929>>>>>        Forward Send Field_Defaults
68931>>>>>        //DDB-Generated-Code-Location
68931>>>>>        //DDB-FieldDefaultStart
68931>>>>>        //DDB-FieldDefaultEnd
68931>>>>>    End_Procedure    // Field_Defaults
68932>>>>>
68932>>>>>End_Class    // Pmovesl_DataDictionary
68933>>>>>//DDB-FileEnd
68933>>>    
68933>>>    //AB-IgnoreEnd
68933>>>
68933>>>    ACTIVATE_VIEW Activate_CN_DELET FOR CN_DELET
68937>>>
68937>>>    Object CN_DELET is a dbViewSub
68939>>>
68939>>>        //AB-StoreTopStart
68939>>>        Property string psmodule public ''
68941>>>        Property String psClientID public ''
68943>>>        
68943>>>        //AB-StoreTopEnd
68943>>>
68943>>>        Set Label to "Ž‘Ž•† -- ‹†Œ ’Ž „ˆ€„’„ ‰€‡ŽŠŽ“ -- ‰“Œƒ“ŒŽ‘ ‰€’€‘’Ž”†‘.   ‰Š„ˆ‘’„ ’Ž €€‡“Ž €“’Ž €‹„‘€"
68944>>>        Set Size to 284 517
68945>>>        Set Location to 2 9
68946>>>
68946>>>        //AB-DDOStart
68946>>>
68946>>>        Object Company_DD is a Company_DataDictionary
68948>>>        End_Object    // Company_DD
68949>>>
68949>>>        Object Branch_DD is a Branch_DataDictionary
68951>>>            Set DDO_Server to (Company_DD(self))
68952>>>        End_Object    // Branch_DD
68953>>>
68953>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
68955>>>        End_Object    // Ctypkin_DD
68956>>>
68956>>>        Object Country_DD is a Country_DataDictionary
68958>>>        End_Object    // Country_DD
68959>>>
68959>>>        Object Towns_DD is a Towns_DataDictionary
68961>>>            Set DDO_Server to (Country_DD(self))
68962>>>        End_Object    // Towns_DD
68963>>>
68963>>>        Object Cities_DD is a Cities_DataDictionary
68965>>>            Set DDO_Server to (Towns_DD(self))
68966>>>        End_Object    // Cities_DD
68967>>>
68967>>>        Object Areas_DD is a Areas_DataDictionary
68969>>>        End_Object    // Areas_DD
68970>>>
68970>>>        Object Payresp_DD is a Payresp_DataDictionary
68972>>>        End_Object    // Payresp_DD
68973>>>
68973>>>        Object Clients_DD is a Clients_DataDictionary
68975>>>            Set DDO_Server to (Cities_DD(self))
68976>>>            Set DDO_Server to (Areas_DD(self))
68977>>>            Set DDO_Server to (Payresp_DD(self))
68978>>>
68978>>>            //AB-StoreStart
68978>>>            set cascade_delete_state  to true
68979>>>            Procedure Request_Delete
68981>>>                Integer iErr isClosed isPrinted isReadOnly iRecnum  iyes
68982>>>                string sid
68982>>>                get field_current_value of clients_dd field clients.client_id to sid
68983>>>                move 0 to iyes
68984>>>                clear cmoves
68985>>>                move sid to cmoves.client_id
68986>>>                find ge cmoves by index.4
68987>>>>
68987>>>                while ((found) and (cmoves.client_id=sid))
68991>>>                    move 1 to iyes
68992>>>                    if (iyes=1) goto next_el
68995>>>                    find gt cmoves by index.4
68996>>>>
68996>>>                LOOP
68997>>>>
68997>>>                next_el:
68997>>>                if (iyes=1) begin
68999>>>                    send stop_box '“§á¨®¦¬¤ ‰ ¤ã©œ ª œ¢á«ž . ƒœ¤ ƒ ˜š¨á­œ«˜  !!'
69000>>>                    procedure_return
69001>>>                end
69001>>>>
69001>>>                clear pmoves
69002>>>                move sid to pmoves.client_id
69003>>>                find ge pmoves by index.6
69004>>>>
69004>>>                while ((found) and (pmoves.client_id=sid))
69008>>>                    move 1 to iyes
69009>>>                    if (iyes=1) goto re_error
69012>>>                    find gt pmoves by index.6
69013>>>>
69013>>>                LOOP
69014>>>>
69014>>>                re_error:
69014>>>                if (iyes=1) begin
69016>>>                    send stop_box '“§á¨®¦¬¤ ‰ ¤ã©œ ª œ¢á«ž. ƒœ¤ ƒ ˜š¨á­œ«˜  !!'
69017>>>                    procedure_return
69018>>>                end
69018>>>>
69018>>>                else  Forward Send Request_Delete
69021>>>            
69021>>>            End_Procedure
69022>>>            
69022>>>            
69022>>>            
69022>>>            
69022>>>            //AB-StoreEnd
69022>>>
69022>>>        End_Object    // Clients_DD
69023>>>
69023>>>        Object Cmoves_DD is a Cmoves_DataDictionary
69025>>>            Set DDO_Server to (Ctypkin_DD(self))
69026>>>            Set DDO_Server to (Clients_DD(self))
69027>>>            Set Constrain_File to Clients.File_Number
69028>>>
69028>>>            //AB-StoreStart
69028>>>            set cascade_delete_state  to true
69029>>>            //AB-StoreEnd
69029>>>
69029>>>        End_Object    // Cmoves_DD
69030>>>
69030>>>        Object Cmovesa_DD is a Cmovesa_DataDictionary
69032>>>            Set DDO_Server to (Clients_DD(self))
69033>>>
69033>>>            //AB-StoreStart
69033>>>            set cascade_delete_state  to true
69034>>>            //AB-StoreEnd
69034>>>
69034>>>        End_Object    // Cmovesa_DD
69035>>>
69035>>>        Object Copen_DD is a Copen_DataDictionary
69037>>>            Set DDO_Server to (Cmoves_DD(self))
69038>>>            Set DDO_Server to (Cmovesa_DD(self))
69039>>>            Set Constrain_File to Cmoves.File_Number
69040>>>
69040>>>            //AB-StoreStart
69040>>>            set cascade_delete_state  to true
69041>>>            
69041>>>            
69041>>>            //AB-StoreEnd
69041>>>
69041>>>        End_Object    // Copen_DD
69042>>>
69042>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
69044>>>        End_Object    // Wtypkin_DD
69045>>>
69045>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
69047>>>            Set DDO_Server to (Ctypkin_DD(self))
69048>>>            Set DDO_Server to (Wtypkin_DD(self))
69049>>>        End_Object    // Ptyppar_DD
69050>>>
69050>>>        Object Nomisma_DD is a Nomisma_DataDictionary
69052>>>        End_Object    // Nomisma_DD
69053>>>
69053>>>        Object Particle_DD is a Particle_DataDictionary
69055>>>            Set DDO_Server to (Clients_DD(self))
69056>>>            Set DDO_Server to (Ptyppar_DD(self))
69057>>>            Set DDO_Server to (Nomisma_DD(self))
69058>>>            Set Constrain_File to Clients.File_Number
69059>>>
69059>>>            //AB-StoreStart
69059>>>            
69059>>>            //AB-StoreEnd
69059>>>
69059>>>        End_Object    // Particle_DD
69060>>>
69060>>>        Object Wapokat_DD is a Wapokat_DataDictionary
69062>>>        End_Object    // Wapokat_DD
69063>>>
69063>>>        Object Wapomast_DD is a Wapomast_DataDictionary
69065>>>            Set DDO_Server to (Wapokat_DD(self))
69066>>>        End_Object    // Wapomast_DD
69067>>>
69067>>>        Object Wax_DD is a Wax_DataDictionary
69069>>>            Set DDO_Server to (Wapomast_DD(self))
69070>>>        End_Object    // Wax_DD
69071>>>
69071>>>        Object Units_DD is a Units_DataDictionary
69073>>>        End_Object    // Units_DD
69074>>>
69074>>>        Object Witemkat_DD is a Witemkat_DataDictionary
69076>>>        End_Object    // Witemkat_DD
69077>>>
69077>>>        Object Fpa_DD is a Fpa_DataDictionary
69079>>>        End_Object    // Fpa_DD
69080>>>
69080>>>        Object Item_DD is a Item_DataDictionary
69082>>>            Set DDO_Server to (Units_DD(self))
69083>>>            Set DDO_Server to (Witemkat_DD(self))
69084>>>            Set DDO_Server to (Fpa_DD(self))
69085>>>        End_Object    // Item_DD
69086>>>
69086>>>        Object Witemx_DD is a Witemx_DataDictionary
69088>>>            Set DDO_Server to (Item_DD(self))
69089>>>        End_Object    // Witemx_DD
69090>>>
69090>>>        Object Pmoves_DD is a Pmoves_DataDictionary
69092>>>            Set DDO_Server to (Wax_DD(self))
69093>>>            Set DDO_Server to (Witemx_DD(self))
69094>>>            Set DDO_Server to (Particle_DD(self))
69095>>>            Set Constrain_File to Particle.File_Number
69096>>>        End_Object    // Pmoves_DD
69097>>>
69097>>>        Object Pmsdtl_DD is a Pmsdtl_DataDictionary
69099>>>            Set DDO_Server to (Pmoves_DD(self))
69100>>>            Set Constrain_File to Pmoves.File_Number
69101>>>        End_Object    // Pmsdtl_DD
69102>>>
69102>>>        Object Baxiokat_DD is a Baxiokat_DataDictionary
69104>>>        End_Object    // Baxiokat_DD
69105>>>
69105>>>        Object Pmssxet_DD is a PmsSxet_DataDictionary
69107>>>            Set DDO_Server to (Pmoves_DD(self))
69108>>>            Set Constrain_File to Pmoves.File_Number
69109>>>        End_Object    // Pmssxet_DD
69110>>>
69110>>>        Object Salesmen_DD is a Salesmen_DataDictionary
69112>>>        End_Object    // Salesmen_DD
69113>>>
69113>>>        Object Mhxanik_DD is a Mhxanik_DataDictionary
69115>>>        End_Object    // Mhxanik_DD
69116>>>
69116>>>        Object Constrct_DD is a Constrct_DataDictionary
69118>>>        End_Object    // Constrct_DD
69119>>>
69119>>>        Object Cn_DD is a Cn_DataDictionary
69121>>>            Set DDO_Server to (Clients_DD(self))
69122>>>            Set DDO_Server to (Salesmen_DD(self))
69123>>>            Set DDO_Server to (Mhxanik_DD(self))
69124>>>            Set DDO_Server to (Constrct_DD(self))
69125>>>            Set Constrain_File to Clients.File_Number
69126>>>
69126>>>            //AB-StoreStart
69126>>>            set cascade_delete_state  to true
69127>>>            
69127>>>            
69127>>>            
69127>>>            
69127>>>            //AB-StoreEnd
69127>>>
69127>>>        End_Object    // Cn_DD
69128>>>
69128>>>        Object Particll_DD is a Particll_DataDictionary
69130>>>            Set DDO_Server to (Clients_DD(self))
69131>>>            Set DDO_Server to (Ptyppar_DD(self))
69132>>>            Set DDO_Server to (Nomisma_DD(self))
69133>>>            Set Constrain_File to Clients.File_Number
69134>>>        End_Object    // Particll_DD
69135>>>
69135>>>        Object Psxetika_DD is a Psxetika_DataDictionary
69137>>>            Set DDO_Server to (Particle_DD(self))
69138>>>            Set Constrain_File to Particle.File_Number
69139>>>        End_Object    // Psxetika_DD
69140>>>
69140>>>        Object Dorderh_DD is a Dorderh_DataDictionary
69142>>>            Set DDO_Server to (Cn_DD(self))
69143>>>            Set Constrain_File to Cn.File_Number
69144>>>
69144>>>            //AB-StoreStart
69144>>>            set cascade_delete_state  to true
69145>>>            //AB-StoreEnd
69145>>>
69145>>>        End_Object    // Dorderh_DD
69146>>>
69146>>>        Object Clnbank_DD is a Clnbank_DataDictionary
69148>>>            Set DDO_Server to (Clients_DD(self))
69149>>>            Set Constrain_File to Clients.File_Number
69150>>>        End_Object    // Clnbank_DD
69151>>>
69151>>>        Object Dorderd_DD is a Dorderd_DataDictionary
69153>>>            Set DDO_Server to (Dorderh_DD(self))
69154>>>            Set Constrain_File to Dorderh.File_Number
69155>>>        End_Object    // Dorderd_DD
69156>>>
69156>>>        Object Zones_DD is a Zones_DataDictionary
69158>>>        End_Object    // Zones_DD
69159>>>
69159>>>        Object Brzones_DD is a BrZones_DataDictionary
69161>>>            Set DDO_Server to (Branch_DD(self))
69162>>>            Set DDO_Server to (Zones_DD(self))
69163>>>        End_Object    // Brzones_DD
69164>>>
69164>>>        Object Cnzones_DD is a Cnzones_DataDictionary
69166>>>            Set DDO_Server to (Cn_DD(self))
69167>>>            Set DDO_Server to (Brzones_DD(self))
69168>>>            Set Constrain_File to Cn.File_Number
69169>>>
69169>>>            //AB-StoreStart
69169>>>            set cascade_delete_state  to true
69170>>>            //AB-StoreEnd
69170>>>
69170>>>        End_Object    // Cnzones_DD
69171>>>
69171>>>        Object Tpclient_DD is a Tpclient_DataDictionary
69173>>>            Set DDO_Server to (Clients_DD(self))
69174>>>            Set DDO_Server to (Baxiokat_DD(self))
69175>>>            Set Constrain_File to Clients.File_Number
69176>>>        End_Object    // Tpclient_DD
69177>>>
69177>>>        Object Tperga_DD is a Tperga_DataDictionary
69179>>>            Set DDO_Server to (Cn_DD(self))
69180>>>            Set DDO_Server to (Baxiokat_DD(self))
69181>>>            Set Constrain_File to Cn.File_Number
69182>>>        End_Object    // Tperga_DD
69183>>>
69183>>>        Object Tparticl_DD is a Tparticl_DataDictionary
69185>>>            Set DDO_Server to (Particle_DD(self))
69186>>>            Set DDO_Server to (Baxiokat_DD(self))
69187>>>            Set Constrain_File to Particle.File_Number
69188>>>        End_Object    // Tparticl_DD
69189>>>
69189>>>        Object Cmovesa2_DD is a Cmovesa2_DataDictionary
69191>>>            Set DDO_Server to (Ctypkin_DD(self))
69192>>>            Set DDO_Server to (Clients_DD(self))
69193>>>            Set Constrain_File to Clients.File_Number
69194>>>
69194>>>            //AB-StoreStart
69194>>>            set cascade_delete_state  to true
69195>>>            //AB-StoreEnd
69195>>>
69195>>>        End_Object    // Cmovesa2_DD
69196>>>
69196>>>        Object Clorder_DD is a Clorder_DataDictionary
69198>>>            Set DDO_Server to (Clients_DD(self))
69199>>>            Set Constrain_File to Clients.File_Number
69200>>>
69200>>>            //AB-StoreStart
69200>>>            set cascade_delete_state  to true
69201>>>            //AB-StoreEnd
69201>>>
69201>>>        End_Object    // Clorder_DD
69202>>>
69202>>>        Object Clorderd_DD is a Clorderd_DataDictionary
69204>>>            Set DDO_Server to (Clorder_DD(self))
69205>>>            Set Constrain_File to Clorder.File_Number
69206>>>        End_Object    // Clorderd_DD
69207>>>
69207>>>        Object Clitem_DD is a Clitem_DataDictionary
69209>>>            Set DDO_Server to (Clients_DD(self))
69210>>>            Set Constrain_File to Clients.File_Number
69211>>>        End_Object    // Clitem_DD
69212>>>
69212>>>        Object Partlfpa_DD is a Partlfpa_DataDictionary
69214>>>            Set DDO_Server to (Particle_DD(self))
69215>>>            Set DDO_Server to (Fpa_DD(self))
69216>>>            Set Constrain_File to Particle.File_Number
69217>>>        End_Object    // Partlfpa_DD
69218>>>
69218>>>        Object Btnordh_DD is a Btnordh_DataDictionary
69220>>>            Set DDO_Server to (Cn_DD(self))
69221>>>            Set Constrain_File to Cn.File_Number
69222>>>
69222>>>            //AB-StoreStart
69222>>>            set cascade_delete_state  to true
69223>>>            //AB-StoreEnd
69223>>>
69223>>>        End_Object    // Btnordh_DD
69224>>>
69224>>>        Object Btnordd_DD is a Btnordd_DataDictionary
69226>>>            Set DDO_Server to (Btnordh_DD(self))
69227>>>            Set Constrain_File to Btnordh.File_Number
69228>>>        End_Object    // Btnordd_DD
69229>>>
69229>>>        Object Pmovesl_DD is a Pmovesl_DataDictionary
69231>>>            Set DDO_Server to (Wax_DD(self))
69232>>>            Set DDO_Server to (Witemx_DD(self))
69233>>>            Set DDO_Server to (Particle_DD(self))
69234>>>            Set Constrain_File to Particle.File_Number
69235>>>        End_Object    // Pmovesl_DD
69236>>>
69236>>>        Set Main_DD to (Clients_DD(self))
69237>>>        Set Server to (Clients_DD(self))
69238>>>
69238>>>        //AB-DDOEnd
69238>>>
69238>>>        Object Container2 is a dbContainer3d
69240>>>            Set Border_Style to Border_Normal
69241>>>            Set Size to 58 446
69242>>>            Set Location to 6 9
69243>>>            Object Clients_Client_id is a dbForm
69245>>>                Entry_Item Clients.Client_id
69246>>>                Set Size to 13 126
69247>>>                Set Location to 6 66
69248>>>                Set Label_Col_Offset to 2
69249>>>                Set Label_Justification_Mode to jMode_Right
69250>>>
69250>>>                //AB-StoreStart
69250>>>                Procedure Prompt
69252>>>                    Set psModule Of (sl100(Self)) to (psModule(cn(Self)))
69253>>>                    Forward Send Prompt
69255>>>                End_Procedure
69256>>>                //AB-StoreEnd
69256>>>
69256>>>            End_Object    // Clients_Client_id
69257>>>
69257>>>            Object Clients_Client_name is a dbForm
69259>>>                Entry_Item Clients.Client_name
69260>>>                Set Size to 13 306
69261>>>                Set Location to 20 66
69262>>>                Set Label_Col_Offset to 2
69263>>>                Set Label_Justification_Mode to jMode_Right
69264>>>            End_Object    // Clients_Client_name
69265>>>
69265>>>            Object Clients_Client_afm is a dbForm
69267>>>                Entry_Item Clients.Client_afm
69268>>>                Set Size to 13 71
69269>>>                Set Location to 36 66
69270>>>                Set Label_Col_Offset to 2
69271>>>                Set Label_Justification_Mode to jMode_Right
69272>>>            End_Object    // Clients_Client_afm
69273>>>
69273>>>            Object TextBoxSub5 is a TextBoxSub
69275>>>                Set Label to "‰à› ¡æª œ¢á«ž"
69276>>>                Set Location to 7 7
69277>>>                Set Size to 10 57
69278>>>                Set TypeFace to "MS Sans Serif"
69279>>>            End_Object    // TextBoxSub5
69280>>>
69280>>>            Object TextBoxSub6 is a TextBoxSub
69282>>>                Set Label to "„§à¤¬£å˜"
69283>>>                Set Location to 22 7
69284>>>                Set Size to 10 41
69285>>>                Set TypeFace to "MS Sans Serif"
69286>>>            End_Object    // TextBoxSub6
69287>>>
69287>>>            Object TextBoxSub7 is a TextBoxSub
69289>>>                Set Label to "€.”.‹."
69290>>>                Set Location to 36 7
69291>>>                Set Size to 10 35
69292>>>                Set TypeFace to "MS Sans Serif"
69293>>>            End_Object    // TextBoxSub7
69294>>>
69294>>>
69294>>>            //AB-StoreStart
69294>>>            
69294>>>            
69294>>>            
69294>>>            
69294>>>            //AB-StoreEnd
69294>>>
69294>>>        End_Object    // Container2
69295>>>
69295>>>        Object Cn_ is a dbGridSub
69297>>>            Set Main_File to Cn.File_Number
69298>>>            Set Server to (Cn_DD(self))
69299>>>            Set Size to 168 493
69300>>>            Set Location to 70 8
69301>>>            Set Wrap_State to TRUE
69302>>>
69302>>>            Begin_Row
69305>>>                Entry_Item Cn.Cn_code
69306>>>                Entry_Item Cn.Cn_descr
69307>>>                Entry_Item Constrct.Cnt_name
69308>>>                Entry_Item Salesmen.Sls_name
69309>>>                Entry_Item Payresp.Presp_name
69310>>>                Entry_Item Mhxanik.Mhx_name
69311>>>                Entry_Item Cn.Cn_start_date
69312>>>                Entry_Item Cn.Hm_tel_fortio
69313>>>            End_Row
69318>>>
69318>>>            Set Form_Width    item 0 to 45
69319>>>            Set Header_Label  item 0 to "‰à› ¡æª "
69320>>>            
69320>>>            Set Form_Width    item 1 to 88
69321>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã ë¨š¦¬"
69322>>>            
69322>>>            Set Form_Width    item 2 to 65
69323>>>            Set Header_Label  item 2 to "„¨š¦¢á™¦ª"
69324>>>            
69324>>>            Set Form_Width    item 3 to 65
69325>>>            Set Header_Label  item 3 to "à¢ž«ãª"
69326>>>            
69326>>>            Set Form_Width    item 4 to 70
69327>>>            Set Header_Label  item 4 to "“§œçŸ. ¢ž¨à£é¤"
69328>>>            
69328>>>            Set Form_Width    item 5 to 60
69329>>>            Set Header_Label  item 5 to "‹ž®˜¤ ¡æª"
69330>>>            
69330>>>            Set Form_Width    item 6 to 47
69331>>>            Set Header_Label  item 6 to "„¤˜¨¥ž"
69332>>>            
69332>>>            Set Form_Width    item 7 to 47
69333>>>            Set Header_Label  item 7 to "’œ¢.”¦¨«å¦"
69334>>>            
69334>>>
69334>>>            //AB-StoreStart
69334>>>            set read_only_state to true
69335>>>            
69335>>>            
69335>>>            //AB-StoreEnd
69335>>>
69335>>>        End_Object    // Cn_
69336>>>
69336>>>        Object btnPartl is a ButtonSub
69338>>>            Set Label to "ButtonSub1"
69339>>>            Set Bitmap to "Filesys3.bmp"
69340>>>            Set Size to 22 25
69341>>>            Set Location to 246 11
69342>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
69343>>>
69343>>>            //AB-StoreStart
69343>>>            
69343>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ ˜¨®œå¦ â¨šà¤"
69344>>>            
69344>>>            Procedure OnClick
69346>>>                    string scnid
69347>>>                    get field_current_value of cn_dd field cn.cn_code to scnid
69348>>>                    set pscncode of (v041(self)) to scnid
69349>>>                    send activate_v041
69350>>>            End_Procedure // OnClick
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            
69351>>>            //AB-StoreEnd
69351>>>
69351>>>        End_Object    // btnPartl
69352>>>
69352>>>        Object Cn_Cn_Codematch is a dbFormSub
69354>>>            Entry_Item Cn.Cn_codematch
69355>>>            Set Server to (Country_DD(self))
69356>>>            Set Size to 13 65
69357>>>            Set Location to 250 431
69358>>>            Set Color to clBtnFace
69359>>>            Set TextColor to 185
69360>>>            Set Label_Col_Offset to 2
69361>>>            Set Label_Justification_Mode to jMode_Right
69362>>>            Set Enabled_State to FALSE
69363>>>            Set Form_FontWeight Item 0 to 600
69364>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
69365>>>            Set Item_Shadow_State Item 0 to TRUE
69366>>>            Set Shadow_State Item 0 to TRUE
69367>>>        End_Object    // Cn_Cn_Codematch
69368>>>
69368>>>
69368>>>        //AB-StoreStart
69368>>>        
69368>>>        
69368>>>        
69368>>>        
69368>>>        
69368>>>        
69368>>>        
69368>>>        
69368>>>        
69368>>>        //AB-StoreEnd
69368>>>
69368>>>    End_Object    // CN_DELET
69369>>>
69369>>>
69369>>>    //AB-StoreStart
69369>>>    
69369>>>    
69369>>>    //AB-StoreEnd
69369>>>
69369>>>//AB/     End_Object    // prj
69369>
69369>        //AB-ClientStoreStart
69369>        
69369>        if (wait(self)) send deactivate to (wait(self))
69372>        
69372>        
69372>        
69372>        
69372>        
69372>        
69372>        
69372>        //AB-ClientStoreEnd
69372>
69372>
69372>    End_Object  // Client_Area
69373>    
69373>    On_Key Key_Ctrl+Key_1 Send Activate_gefyres2 To Client_Area
69374>    On_Key Key_Ctrl+Key_2 Send Activate_Gefyres3 To Client_Area
69375>    On_Key Key_Ctrl+Key_3 Send Activate_CN_DELET To Client_Area
69376>    On_Key Key_Ctrl+Key_4 Send Activate_rmetafyp To Client_Area
69377>    
69377>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
69377>>>// 07/23/96 JJT - New Class names
69377>>>// Very prototype global status bar
69377>>>//
69377>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
69377>>>>>// 07/23/96 JJT - New Class names
69377>>>>>Use dfAstbar.pkg
69377>>>>>
69377>>>>>Class StatusBar is a AppStatusBar
69378>>>>>
69378>>>>>    Procedure Construct_Object
69379>>>>>       Forward Send Construct_Object
69381>>>>>       //
69381>>>>>       Send Add_Item 350  ''     // micro-help
69382>>>>>       Send Add_Item  40  'View:'
69383>>>>>       Set Item_Display_Style To sbNORMAL
69384>>>>>       Send Add_Item 200  ''     // view name
69385>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
69386>>>>>       Set Item_Display_Style To sbNORMAL
69387>>>>>    End_Procedure // Construct_Object
69388>>>>>
69388>>>>>    Procedure Show_View_Name String sName
69389>>>>>        Set Value item 2 to sName
69390>>>>>    End_Procedure
69391>>>>>
69391>>>>>End_Class
69392>>>
69392>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
69395>>>
69395>>>Object oStatusBarSub  is a StatusBar
69397>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
69397>>>    
69397>>>    Property Integer piStdPanes Public (PaneCount(Self))
69399>>>    
69399>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
69399>>>    Set PaneWidth item 1 to 50
69400>>>    
69400>>>    Send AddPane 55  ""        sbLOWERED
69401>>>    Send AddPane 70  ""        sbLOWERED
69402>>>    Send AddPane 55  ""        sbLOWERED
69403>>>    
69403>>>    Procedure pTimer
69405>>>        String lsDay lsHour lsHH lsMM lsSS
69406>>>        Integer liStdPanes lbState
69406>>>    
69406>>>        Get piStdPanes to liStdPanes
69407>>>        Sysdate lsDay lsHH lsMM lsSS
69411>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
69415>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
69419>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
69423>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
69424>>>        Get Simple_state to lbState
69425>>>        If  Not (lbState) Begin
69427>>>            Set Value Item liStdPanes     to lsHour
69428>>>            Set Value Item (liStdPanes+1) to lsDay
69429>>>        End
69429>>>>
69429>>>    
69429>>>    End_Procedure // pTimer
69430>>>    
69430>>>    
69430>>>    Object oTimerObj Is A DFTimer
69432>>>        Set Timeout to 1000
69433>>>        Set Timer_Active_State to TRUE
69434>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
69435>>>        Set Timer_Message to pTimer
69436>>>    End_Object // oTimerOdj
69437>>>End_Object // oStatusBar
69438>>>
69438>>>
69438>
69438>    //AB-PanelStoreStart
69438>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
69438>>>//************************************************************************
69438>>>// Confidential Trade Secret.
69438>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
69438>>>// as an unpublished work.  All rights reserved.
69438>>>// DataFlex is a registered trademark of Data Access Corporation.
69438>>>//
69438>>>//************************************************************************
69438>>>//************************************************************************
69438>>>//
69438>>>// $File name  : StdAbout.pkg
69438>>>// $File title : Standard about object package for VDF
69438>>>// Notice      :
69438>>>// $Author(s)  : John Tuohy
69438>>>//
69438>>>// $Rev History
69438>>>//
69438>>>// JT 06/27/97   File created
69438>>>//************************************************************************
69438>>>
69438>>>// This provides a quick and simple way to create an about package for a program.
69438>>>// You need to create a message inside you client area called Activate_About.
69438>>>// Within this message you should send the message DoAbout passing needed
69438>>>// string information.
69438>>>//
69438>>>//       Procedure Activate_About
69438>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
69438>>>//       End_Procedure
69438>>>//    where: sTitle =     Name of application. If none provided, uses caption
69438>>>//                        bar title
69438>>>//           sVersion   = Version Line. If none provided, will be blank
69438>>>//           sCopyRight = Copyright Line. If none provided, will be blank
69438>>>//           sAuthor    = Author name, blank if none provided
69438>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
69438>>>//                        is used.
69438>>>// It is expected that you will place this in your own object package. For
69438>>>// example an order about package may look like this:
69438>>>//
69438>>>//   // OrderAbout.pkg
69438>>>//   Use StdAbout.pkg
69438>>>//   Procedure Activate_About
69438>>>//      Local String sTitle sCopyright sVersion sAuthor
69438>>>//      Move "My Order Entry System" to sTitle
69438>>>//      Move "Version 2.1" to sVersion
69438>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
69438>>>//      Move "John Smith"  to sAuthor
69438>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
69438>>>//   end_procedure
69438>>>//   // end of file.
69438>>>
69438>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
69438>>>>>//************************************************************************
69438>>>>>// Confidential Trade Secret.
69438>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
69438>>>>>// as an unpublished work.  All rights reserved.
69438>>>>>// DataFlex is a registered trademark of Data Access Corporation.
69438>>>>>//
69438>>>>>//************************************************************************
69438>>>>>//************************************************************************
69438>>>>>//
69438>>>>>// $File name  : DfAbout.pkg
69438>>>>>// $File title : About class support
69438>>>>>// Notice      :
69438>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
69438>>>>>//
69438>>>>>// $Rev History
69438>>>>>//
69438>>>>>// JJT 11/5/98    Added version information
69438>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
69438>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
69438>>>>>//                workspace package.
69438>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
69438>>>>>//                class can create this object.
69438>>>>>//                Cleaned up the interface (used correct classes and messages)
69438>>>>>//                Added workspace reporting support to sys-info.
69438>>>>>//                Turned off wrapping in the sys-info editor.
69438>>>>>// KR  ??/??/96   File created
69438>>>>>//************************************************************************
69438>>>>>Use windows.pkg
69438>>>>>Use DFbitmap.pkg
69438>>>>>
69438>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
69439>>>>>
69439>>>>>//****************************************************************************
69439>>>>>// $Module type: FUNCTION
69439>>>>>// $Module name: Network_User_Name
69439>>>>>// $Author     : AK/VOO/KCR
69439>>>>>// Created     : 24-09-96 @ 19:17
69439>>>>>//
69439>>>>>// Description
69439>>>>>//    This function reads the current username of windows and returns that
69439>>>>>//    name or an text unknown user
69439>>>>>//
69439>>>>>// $Rev History
69439>>>>>//    24-09-96  Module header created
69439>>>>>//****************************************************************************
69439>>>>>Function Network_User_Name Returns String
69441>>>>>    Local String sName sLength
69442>>>>>    Local Pointer lpName_Addr lpLength_Addr
69442>>>>>    Local Integer iRetval
69442>>>>>
69442>>>>>    Movestr (Repeat (Character (0), 255)) To sName
69443>>>>>>
69443>>>>>    GetAddress Of sName To lpName_Addr
69444>>>>>    Movestr (DwordToBytes (255)) To sLength
69445>>>>>>
69445>>>>>    GetAddress Of sLength To lpLength_Addr
69446>>>>>
69446>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
69447>>>>>>
69447>>>>>
69447>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
69450>>>>>    Else Function_Return "User Unknown"
69452>>>>>End_Function // Network_User_Name
69453>>>>>
69453>>>>>Type MEMORYSTATUS
69453>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
69453>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
69453>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
69453>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
69453>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
69453>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
69453>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
69453>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
69453>>>>>End_Type // MEMORYSTATUS
69453>>>>>
69453>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
69454>>>>>
69454>>>>>// If a global workspace object exists it will use this variable to store
69454>>>>>// its object id.
69454>>>>>
69454>>>>>Class SysinfoDisplay Is An Edit
69455>>>>>    Procedure Construct_Object
69456>>>>>        forward send construct_object
69458>>>>>
69458>>>>>        Set Location To 6 6
69459>>>>>        Set Size To 110 255
69460>>>>>        Set Read_Only_State To True
69461>>>>>        Set wrap_state to False
69462>>>>>    end_Procedure
69463>>>>>
69463>>>>>    //****************************************************************************
69463>>>>>    // $Module type: PROCEDURE
69463>>>>>    // $Module name: Add_Line
69463>>>>>    // $Author     : VOO
69463>>>>>    // Created     : 06-10-96 @ 15:23
69463>>>>>    //
69463>>>>>    // Description
69463>>>>>    //    This method will add a line to this edit object, it should go simpler
69463>>>>>    //    but it seems to be done this way.
69463>>>>>    //
69463>>>>>    // $Rev History
69463>>>>>    //    06-10-96  Module header created
69463>>>>>    //****************************************************************************
69463>>>>>    Procedure Add_Line String sVal
69464>>>>>        Local Integer iLine
69465>>>>>
69465>>>>>        Moveint (Line_Count (Current_Object)) To iLine
69466>>>>>>
69466>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
69469>>>>>        Set Value Item iLine To sVal
69470>>>>>    End_Procedure // Add_Line
69471>>>>>
69471>>>>>    //****************************************************************************
69471>>>>>    // $Module type: PROCEDURE
69471>>>>>    // $Module name: Show_Current_Directory
69471>>>>>    // $Author     : VOO
69471>>>>>    // Created     : 06-10-96 @ 15:24
69471>>>>>    //
69471>>>>>    // Description
69471>>>>>    //    This method will show the name of the current directory in the system
69471>>>>>    //    information box
69471>>>>>    //
69471>>>>>    // $Rev History
69471>>>>>    //    06-10-96  Module header created
69471>>>>>    //****************************************************************************
69471>>>>>    Procedure Show_Current_Directory
69472>>>>>        Local String sDir
69473>>>>>
69473>>>>>        Get_Current_Directory To sDir
69474>>>>>        Send Add_Line ("Current Directory: " + sDir)
69475>>>>>    End_Procedure // Show_Current_Directory
69476>>>>>
69476>>>>>    Procedure Show_Windows_Directory
69477>>>>>        Local String sWindir
69478>>>>>
69478>>>>>        Get_Windows_Directory To sWindir
69479>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
69480>>>>>    End_Procedure // Show_Windows_Directory
69481>>>>>
69481>>>>>    Procedure Show_Current_User
69482>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
69483>>>>>    End_Procedure // Show_Current_User
69484>>>>>
69484>>>>>    Procedure Show_Number_Format
69485>>>>>        Local Integer iFormat
69486>>>>>
69486>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
69489>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
69490>>>>>        Get_Number_Format To iFormat
69491>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
69492>>>>>    End_Procedure // Show_Number_Format
69493>>>>>
69493>>>>>    Procedure Show_Filelist_Name
69494>>>>>        Local String sFilename
69495>>>>>
69495>>>>>        Get_Attribute Df_Filelist_Name To sFilename
69498>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
69499>>>>>    End_Procedure // Show_Filelist_Name
69500>>>>>
69500>>>>>    Procedure Show_Lock_Delay
69501>>>>>        Local Integer iLockdelay
69502>>>>>
69502>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
69505>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
69506>>>>>    End_Procedure // Show_Lock_Delay
69507>>>>>
69507>>>>>    Procedure Show_Lock_Timeout
69508>>>>>        Local Integer iLockTimeout
69509>>>>>
69509>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
69512>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
69513>>>>>    End_Procedure // Show_Lock_Timeout
69514>>>>>
69514>>>>>    Procedure Show_Screen_Size
69515>>>>>        Local Integer iYscreensize iXscreensize
69516>>>>>
69516>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
69517>>>>>>
69517>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
69518>>>>>>
69518>>>>>
69518>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
69519>>>>>    End_Procedure // Show_Screen_Size
69520>>>>>
69520>>>>>    Procedure Show_Page_Size
69521>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
69522>>>>>    End_procedure
69523>>>>>
69523>>>>>    Procedure Show_Date
69524>>>>>        Local Date dToday
69525>>>>>
69525>>>>>        Sysdate4 dToday
69526>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
69527>>>>>    End_procedure // Show_Date
69528>>>>>
69528>>>>>    Procedure Show_Date_Format
69529>>>>>        Local Integer iDateFormat
69530>>>>>        Local String sDateFormat
69530>>>>>
69530>>>>>        Get_Attribute Df_Date_Format To iDateFormat
69533>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
69536>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
69540>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
69544>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
69546>>>>>        Send Add_Line ("Date Format: " * sDateformat)
69547>>>>>    End_Procedure // Show_Date_Format
69548>>>>>
69548>>>>>    Procedure Show_Memavail
69549>>>>>        Local Integer iMem
69550>>>>>
69550>>>>>        Memory iMem
69551>>>>>>
69551>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
69552>>>>>    End_Procedure // Show_Memavail
69553>>>>>
69553>>>>>    Procedure Show_Systemresources
69554>>>>>        Local String sMemoryStatus
69555>>>>>        Local Pointer lpsMemoryStatus
69555>>>>>        Local Integer iVoid
69555>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
69555>>>>>
69555>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
69556>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
69557>>>>>
69557>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
69558>>>>>>
69558>>>>>
69558>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
69559>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
69560>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
69561>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
69562>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
69563>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
69564>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
69565>>>>>
69565>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
69566>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
69567>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
69568>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
69569>>>>>    End_Procedure // Show_Systemresources
69570>>>>>
69570>>>>>    Procedure Show_Registration
69571>>>>>        Local String sRegName
69572>>>>>        Local Integer iSN
69572>>>>>        Registration sRegName iSN
69573>>>>>>
69573>>>>>
69573>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
69574>>>>>        Send Add_Line ("Reg Name: " + sRegName)
69575>>>>>
69575>>>>>    End_Procedure // Show_Current_Directory
69576>>>>>
69576>>>>>
69576>>>>>
69576>>>>>    //****************************************************************************
69576>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
69576>>>>>    // to the workspace object passing the an object and message to send back
69576>>>>>    // to this object. It is expected that the workspace object will send this
69576>>>>>    // message for every line of information it wants displayed (passing the
69576>>>>>    // information to be displayed
69576>>>>>    //****************************************************************************
69576>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
69576>>>>>    Procedure Show_WorkspaceInformation
69577>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
69580>>>>>    End_Procedure
69581>>>>>
69581>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
69582>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
69583>>>>>    End_Function
69584>>>>>
69584>>>>>    Procedure Show_Versions
69585>>>>>        local integer iVersion iRevision iBuild
69586>>>>>        Version_information iVersion iRevision iBuild
69588>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
69589>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
69590>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
69591>>>>>    End_Procedure
69592>>>>>
69592>>>>>
69592>>>>>    //***
69592>>>>>    //*** BW
69592>>>>>    //*** Procedure: Show_Drivers
69592>>>>>    //*** Purpose  : Show loaed database drivers
69592>>>>>    //***
69592>>>>>
69592>>>>>    Procedure Show_Drivers
69593>>>>>        Local String  Current_drvr
69594>>>>>        Local String  Loadeddrvrs
69594>>>>>        Local Integer Number_of_drvrs
69594>>>>>        Local Integer Count
69594>>>>>
69594>>>>>        Move "" To Loadeddrvrs
69595>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
69598>>>>>        For Count From 1 To Number_of_drvrs
69604>>>>>>
69604>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
69607>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
69610>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
69611>>>>>        Loop
69612>>>>>>
69612>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
69613>>>>>    End_Procedure // Show_Drivers
69614>>>>>
69614>>>>>    //****************************************************************************
69614>>>>>    // $Module type: PROCEDURE
69614>>>>>    // $Module name: Add_Focus
69614>>>>>    // $Author     : VOO
69614>>>>>    // Created     : 24-09-96 @ 19:43
69614>>>>>    //
69614>>>>>    // Description
69614>>>>>    //    During activation we will remove the old information and add the newly
69614>>>>>    //    found systeminformation
69614>>>>>    //
69614>>>>>    // $Rev History
69614>>>>>    //    24-09-96  Module header created
69614>>>>>    //****************************************************************************
69614>>>>>    Procedure Add_Focus Integer hoRoot
69615>>>>>        Forward Send Add_Focus hoRoot
69617>>>>>
69617>>>>>        Send Delete_Data
69618>>>>>        Set Changed_State To False
69619>>>>>        Set Read_Only_State To True
69620>>>>>        Send Show_WorkSpaceInformation // added to show WS info
69621>>>>>        SEnd Show_Drivers
69622>>>>>        Send Show_Current_User
69623>>>>>        Send Show_Windows_Directory
69624>>>>>        Send Show_Current_Directory
69625>>>>>        Send Show_Filelist_Name
69626>>>>>        Send Show_Versions
69627>>>>>        Send Show_Memavail
69628>>>>>        Send Show_Screen_Size
69629>>>>>        Send Show_Page_Size
69630>>>>>        Send Show_Number_Format
69631>>>>>        Send Show_Date_Format
69632>>>>>        Send Show_Lock_Delay
69633>>>>>        Send Show_Lock_Timeout
69634>>>>>        Send Show_Date
69635>>>>>        Send Show_Systemresources
69636>>>>>        Send Show_Registration
69637>>>>>    End_Procedure // Show_All_Info
69638>>>>>
69638>>>>>End_Class // SysinfoDisplay
69639>>>>>
69639>>>>>
69639>>>>>//****************************************************************************
69639>>>>>// $Module type: OBJECT
69639>>>>>// $Module name: Sysinfo_Dialog
69639>>>>>// $Author     : VOO
69639>>>>>// Created     : 24-09-96 @ 18:47
69639>>>>>//
69639>>>>>// Description
69639>>>>>//    This object shows the systeminformation on the screen
69639>>>>>//
69639>>>>>// $Rev History
69639>>>>>//    24-09-96  Module header created
69639>>>>>//****************************************************************************
69639>>>>>Class SysInfoDialog Is A ModalPanel
69640>>>>>    Procedure Construct_Object
69641>>>>>        forward send construct_object
69643>>>>>
69643>>>>>        Set Caption_Bar To True
69644>>>>>        Set Sysmenu_Icon To True
69645>>>>>        Set Label To "System Information"
69646>>>>>        Set Size To 152 270
69647>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69648>>>>>        Set Minimize_Icon To False
69649>>>>>        Set Maximize_Icon To False
69650>>>>>        Set Border_Style To Border_Dialog
69651>>>>>
69651>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
69653>>>>>        End_Object
69654>>>>>
69654>>>>>        Object Close_Button Is A Button
69656>>>>>            Set Label to "&Close"
69657>>>>>            Set Location To 120 212
69658>>>>>            Set Message item 0 to msg_Close_Panel
69659>>>>>            Set default_action_button to current_object
69660>>>>>        End_Object // Close_Button
69661>>>>>
69661>>>>>        On_Key Kcancel       Send Close_Panel
69662>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
69663>>>>>    End_procedure
69664>>>>>
69664>>>>>End_Class // SysinfoDialog
69665>>>>>
69665>>>>>// Purpose:
69665>>>>>//
69665>>>>>// Ken Ross 12/17/96 5:16PM
69665>>>>>//
69665>>>>>Class AboutDialog Is A ModalPanel
69666>>>>>
69666>>>>>    Procedure construct_object
69667>>>>>        String sVdfRootDir
69668>>>>>        forward send construct_object
69670>>>>>        Set Label to "About..."
69671>>>>>        Set Size to 100 217
69672>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69673>>>>>
69673>>>>>        Object SysInfo_Dialog is a SysInfoDialog
69675>>>>>        End_Object
69676>>>>>
69676>>>>>        Object oBox is a Container3d
69678>>>>>            Set Border_Style to Border_StaticEdge
69679>>>>>            Set Size to 63 202
69680>>>>>            Set Location to 4 5
69681>>>>>
69681>>>>>            Object AboutGraphic is a BitmapContainer
69683>>>>>                Set Border_Style to Border_None
69684>>>>>                Set Bitmap_Style to Bitmap_Center
69685>>>>>                Set Size to 48 48
69686>>>>>                Set Location to 7 2
69687>>>>>            End_Object    // AboutGraphic
69688>>>>>
69688>>>>>            Object ProductName is a TextBox
69690>>>>>                Set label to "ProductName"
69691>>>>>                Set Size to 10 45
69692>>>>>                Set Location to 8 53
69693>>>>>            End_Object    // ProductName
69694>>>>>
69694>>>>>            Object Version is a TextBox
69696>>>>>                Set label to "Version"
69697>>>>>                Set Size to 10 25
69698>>>>>                Set Location to 21 53
69699>>>>>            End_Object    // Version
69700>>>>>
69700>>>>>            Object Copyright is a TextBox
69702>>>>>                Set label to "Copyright"
69703>>>>>                Set Size to 10 31
69704>>>>>                Set Location to 34 53
69705>>>>>            End_Object    // Copyright
69706>>>>>
69706>>>>>            Object Author is a TextBox
69708>>>>>                Set label to "Author"
69709>>>>>                Set Size to 10 22
69710>>>>>                Set Location to 46 53
69711>>>>>            End_Object    // Author
69712>>>>>
69712>>>>>        End_Object    // oBox
69713>>>>>
69713>>>>>        Object OK_bn is a Button
69715>>>>>            On_Item "&OK" Send Close_Panel
69716>>>>>            Set Size to 14 50
69717>>>>>            Set Location to 71 157
69718>>>>>        End_Object    // OK_bn
69719>>>>>
69719>>>>>        Object SysInfo_bn is a Button
69721>>>>>            On_Item "&System Info" Send Show_Sysinfo
69722>>>>>            Set Size to 14 50
69723>>>>>            Set Location to 71 101
69724>>>>>        End_Object    // SysInfo_bn
69725>>>>>
69725>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
69726>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
69727>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
69728>>>>>
69728>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
69731>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
69732>>>>>
69732>>>>>    End_Procedure
69733>>>>>
69733>>>>>    Procedure set productname string sval
69734>>>>>        set label of (productname(oBox(current_object))) to sval
69735>>>>>    End_Procedure
69736>>>>>
69736>>>>>    Procedure set version string sval
69737>>>>>        set label of (version(oBox(current_object))) to sval
69738>>>>>    End_Procedure
69739>>>>>
69739>>>>>    Procedure set copyright string sval
69740>>>>>        set label of (copyright(oBox(current_object))) to sval
69741>>>>>    End_Procedure
69742>>>>>
69742>>>>>    Procedure set author string sval
69743>>>>>        set label of (author(oBox(current_object))) to sval
69744>>>>>    End_Procedure
69745>>>>>
69745>>>>>    // square bitmaps of 42x42 work best
69745>>>>>    //
69745>>>>>    Procedure set logo string sval
69746>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
69747>>>>>    End_Procedure
69748>>>>>
69748>>>>>    Procedure Show_Sysinfo
69749>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
69750>>>>>    End_Procedure // Show_Sysinfo
69751>>>>>
69751>>>>>End_Class
69752>>>>>
69752>>>>>
69752>>>>>//Object About_Dialog is an AboutDialog
69752>>>>>//    set productname to "Visual DataFlex"
69752>>>>>//    set version to "version 4.0"
69752>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
69752>>>>>//    set author to ""
69752>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
69752>>>>>//End_Object
69752>>>>>
69752>>>>>//Procedure Activate_About
69752>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
69752>>>>>//End_Procedure
69752>>>
69752>>>// *************************************************************************
69752>>>//  Public message. This is the default message. It is expected that you will
69752>>>//   create your own message to override this
69752>>>// *************************************************************************
69752>>>
69752>>>Procedure Activate_About
69754>>>   Send DoAbout "" "" "" "" "" ""
69755>>>End_Procedure
69756>>>
69756>>>// *************************************************************************
69756>>>//  Public message. It is expected that you will send this message (most
69756>>>//  likely from Activate_About. This creates an about object, activates it
69756>>>//  and destroys it when done. It is not exepected that you will augment this.
69756>>>// *************************************************************************
69756>>>
69756>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
69758>>>        Local integer hoObj hoMain
69759>>>
69759>>>        // create object
69759>>>        Object About is an AboutDialog
69761>>>            // if no title passed use the label of the main panel
69761>>>            // (if a main panel exists).
69761>>>            if sTitle     eq '' Begin
69763>>>                Get Main_Window to hoMain
69764>>>                if hoMain Get Label of hoMain to sTitle
69767>>>            end
69767>>>>
69767>>>            set productname to sTitle
69768>>>            set version     to sVersion
69769>>>            set copyright   to sCopyRight
69770>>>            set author      to sAuthor
69771>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
69774>>>            Move Current_Object to hoObj // object Id
69775>>>        End_Object
69776>>>        Send Popup to hoObj    // popup the about object
69777>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
69778>>>End_procedure
69779>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
69779>>>Use Tooltip.pkg
69779>>>
69779>>>object StandardToolTip is a StandardToolTip000
69781>>>    move (current_object) to DefaultTooltipHintID
69782>>>end_object
69783>>>
69783>>>object ToolTipTimer is a ToolTipTimer000
69785>>>    move (current_object) to TooltipControllerID
69786>>>end_object
69787>    
69787>    
69787>    
69787>    
69787>    //AB-PanelStoreEnd
69787>
69787>
69787>End_Object
69788>
69788>
69788>//AB-StoreStart
69788>set bitmap of (client_area(main(self))) to "protem1.bmp"
69789>
69789>Send DoStoreFileModeInfo to ghoFileModeInfo
69790>
69790>
69790>Start_UI
69791>
69791>
69791>//AB-StoreEnd
69791>
69791>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 31795
Total Resources: 0
Total Commands : 69790
Total Windows  : 52
Total Pages    : 12
Static Data    : 493830
Message area   : 439002
Total Blocks   : 22324
