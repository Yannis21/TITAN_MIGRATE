//AB/ Project OpenXr : Anoigma neas xrhshs
//AB/ Object prj is a View_Project
//AB/     Set ProjectName to "OpenXr : Anoigma neas xrhshs"
//AB/     Set ProjectFileName to "OpenXr.VW"
//AB/     Set GenerateFileName to "NONAME"

// Project Object Structure
//   OpenXr is a dbView
//     Company_DDR is a Company_DataDictionary
//     Branch_DDR is a Branch_DataDictionary
//     Year_DDR is a Year_DataDictionary
//     Ctypkin_DDR is a Ctypkin_DataDictionary
//     Cflagkin_DDR is a Cflagkin_DataDictionary
//     Ctypkin_DDW is a Ctypkin_DataDictionary
//     Cflagkin_DDW is a Cflagkin_DataDictionary
//     Btypkin_DDR is a Btypkin_DataDictionary
//     Bflagkin_DDR is a Bflagkin_DataDictionary
//     Btypkin_DDW is a Btypkin_DataDictionary
//     Bflagkin_DDW is a Bflagkin_DataDictionary
//     Wtypkin_DDR is a Wtypkin_DataDictionary
//     Wtypkin_DDW is a Wtypkin_DataDictionary
//     Wflagkin_DDW is a Wflagkin_DataDictionary
//     Wflagkin_DDR is a Wflagkin_DataDictionary
//     Clients_DDR is a Clients_DataDictionary
//     CN_DDR is a CN_DataDictionary
//     Clients_DDW is a Clients_DataDictionary
//     CN_DDW is a CN_DataDictionary
//     BaxioKat_DDR is a BaxioKat_DataDictionary
//     BaxioKat_DDW is a BaxioKat_DataDictionary
//     Baxio_DDR is a Baxio_DataDictionary
//     Baxio_DDW is a Baxio_DataDictionary
//     Wapokat_DDW is a Wapokat_DataDictionary
//     Wapomast_DDW is a Wapomast_DataDictionary
//     Wax_DDW is a Wax_DataDictionary
//     Wapokat_DDR is a Wapokat_DataDictionary
//     Wapomast_DDR is a Wapomast_DataDictionary
//     Wax_DDR is a Wax_DataDictionary
//     Fpa_DDR is a Fpa_DataDictionary
//     Fpa_DDW is a Fpa_DataDictionary
//     Witemkat_DDR is a Witemkat_DataDictionary
//     Units_DDR is a Units_DataDictionary
//     Item_DDR is a Item_DataDictionary
//     Witemx_DDR is a Witemx_DataDictionary
//     Witemxt_DDR is a Witemxt_DataDictionary
//     Witemkat_DDW is a Witemkat_DataDictionary
//     Units_DDW is a Units_DataDictionary
//     Item_DDW is a Item_DataDictionary
//     Witemx_DDW is a Witemx_DataDictionary
//     Hmgio_DDR is a Hmgio_DataDictionary
//     Hmgio_DDW is a Hmgio_DataDictionary
//     HmgioW_DDR is a HmgioW_DataDictionary
//     HmgioW_DDW is a HmgioW_DataDictionary
//     Witemxt_DDW is a Witemxt_DataDictionary
//     HmCtyp_DDR is a HmCtyp_DataDictionary
//     HmCtyp_DDW is a HmCtyp_DataDictionary
//     HmWtyp_DDR is a HmWtyp_DataDictionary
//     HmWtyp_DDW is a HmWtyp_DataDictionary
//     Ptyppar_DDR is a Ptyppar_DataDictionary
//     Ptyppar_DDW is a Ptyppar_DataDictionary
//     Pseira_DDW is a Pseira_DataDictionary
//     Pseira_DDR is a Pseira_DataDictionary
//     BkinKat_DDR is a BkinKat_DataDictionary
//     BkinKat_DDW is a BkinKat_DataDictionary
//     Company_DD is a DataDictionary
//     Branch_DD is a DataDictionary
//     Year_DD is a DataDictionary
//     Ctypkin_DD is a DataDictionary
//     Cflagkin_DD is a DataDictionary
//     Syscurxr_DD is a DataDictionary
//     Container1 is a dbContainer3d
//       Company_Company_code is a dbForm
//       Company_Company_name is a dbForm
//       Branch_Branch_code is a dbForm
//       Branch_Branch_name is a dbForm
//       Branch_Branch_Site is a dbFormSub
//       Branch_Branch_Apoth is a dbFormSub
//       TextBoxSub4 is a TextBoxSub
//       TextBoxSub5 is a TextBoxSub
//       TextBoxSub6 is a TextBoxSub
//       TextBoxSub7 is a TextBoxSub
//       TextBoxSub8 is a TextBoxSub
//       TextBoxSub9 is a TextBoxSub
//       TextBoxSub10 is a TextBoxSub
//     The_Table is a dbGrid
//     txtM1 is a TextBoxSub
//     txtM2 is a TextBoxSub
//     chkCtypkin is a CheckBoxSub
//     chkBtypkin is a CheckBoxSub
//     chkWtypkin is a CheckBoxSub
//     chkClient is a CheckBoxSub
//     chkBaxio is a CheckBoxSub
//     chkPtyppar is a CheckBoxSub
//     chkWitemx is a CheckBoxSub
//     chkWax is a CheckBoxSub
//     chkForce is a CheckBoxSub
//     TextBoxSub11 is a TextBoxSub
//     chkHmCtyp is a CheckBoxSub
//     chkHmWtyp is a CheckBoxSub
//     chkBkinKat is a CheckBoxSub
//     frmYear is a FormSub
//     TextBoxSub12 is a TextBoxSub

// Register all objects
Register_Object Baxio_DDR
Register_Object Baxio_DDW
Register_Object BaxioKat_DDR
Register_Object BaxioKat_DDW
Register_Object Bflagkin_DDR
Register_Object Bflagkin_DDW
Register_Object BkinKat_DDR
Register_Object BkinKat_DDW
Register_Object Branch_Branch_Apoth
Register_Object Branch_Branch_code
Register_Object Branch_Branch_name
Register_Object Branch_Branch_Site
Register_Object Branch_DD
Register_Object Branch_DDR
Register_Object Btypkin_DDR
Register_Object Btypkin_DDW
Register_Object Cflagkin_DD
Register_Object Cflagkin_DDR
Register_Object Cflagkin_DDW
Register_Object Clients_DDR
Register_Object Clients_DDW
Register_Object CN_DDR
Register_Object CN_DDW
Register_Object Company_Company_code
Register_Object Company_Company_name
Register_Object Company_DD
Register_Object Company_DDR
Register_Object Container1
Register_Object Ctypkin_DD
Register_Object Ctypkin_DDR
Register_Object Ctypkin_DDW
Register_Object chkBaxio
Register_Object chkBkinKat
Register_Object chkBtypkin
Register_Object chkClient
Register_Object chkCtypkin
Register_Object chkForce
Register_Object chkHmCtyp
Register_Object chkHmWtyp
Register_Object chkPtyppar
Register_Object chkWax
Register_Object chkWitemx
Register_Object chkWtypkin
Register_Object Fpa_DDR
Register_Object Fpa_DDW
Register_Object frmYear
Register_Object HmCtyp_DDR
Register_Object HmCtyp_DDW
Register_Object Hmgio_DDR
Register_Object Hmgio_DDW
Register_Object HmgioW_DDR
Register_Object HmgioW_DDW
Register_Object HmWtyp_DDR
Register_Object HmWtyp_DDW
Register_Object Item_DDR
Register_Object Item_DDW
Register_Object OpenXr
Register_Object Pseira_DDR
Register_Object Pseira_DDW
Register_Object Ptyppar_DDR
Register_Object Ptyppar_DDW
Register_Object Syscurxr_DD
Register_Object TextBoxSub10
Register_Object TextBoxSub11
Register_Object TextBoxSub12
Register_Object TextBoxSub4
Register_Object TextBoxSub5
Register_Object TextBoxSub6
Register_Object TextBoxSub7
Register_Object TextBoxSub8
Register_Object TextBoxSub9
Register_Object The_Table
Register_Object txtM1
Register_Object txtM2
Register_Object Units_DDR
Register_Object Units_DDW
Register_Object Wapokat_DDR
Register_Object Wapokat_DDW
Register_Object Wapomast_DDR
Register_Object Wapomast_DDW
Register_Object Wax_DDR
Register_Object Wax_DDW
Register_Object Wflagkin_DDR
Register_Object Wflagkin_DDW
Register_Object Witemkat_DDR
Register_Object Witemkat_DDW
Register_Object Witemx_DDR
Register_Object Witemx_DDW
Register_Object Witemxt_DDR
Register_Object Witemxt_DDW
Register_Object Wtypkin_DDR
Register_Object Wtypkin_DDW
Register_Object Year_DD
Register_Object Year_DDR


//AB/ AppBuild VIEW


//AB-StoreTopStart

Open SysCurXr
Use Btypkin.DD
Use Bflagkin.DD
Use Wtypkin.DD
Use Wflagkin.DD
use clients.dd
Use CN.DD
Use Baxio.DD
Use BaxioKat.DD
Use WapoKat.DD
Use Wapomast.DD
Use Wax.DD
Use WitemKat.DD
use units.dd
Use Item.DD
Use Witemx.DD
Use Witemxt.DD
Use Fpa.DD
Use Ptyppar.DD
Use Pseira.DD
Use HmCtyp.DD
Use HmWtyp.DD

//AB-StoreTopEnd

//AB-IgnoreStart

Use DFAllEnt.pkg
Use dbForm.Sub
Use Txtbox.Sub
Use Chkbox.Sub
Use Form.Sub

Use COMPANY.DD
Use BRANCH.DD
Use YEAR.DD
Use CTYPKIN.DD
Use CFLAGKIN.DD
Use SYSCURXR.DD

//AB-IgnoreEnd

DEFERRED_VIEW Activate_OpenXr FOR ;
;
Object OpenXr is a dbView

    //AB-StoreTopStart
    Object Company_DDR is a Company_DataDictionary
    End_Object    // Company_DDR
    Object Branch_DDR is a Branch_DataDictionary
        Set DDO_Server to (Company_DDR(self))
    End_Object    // Branch_DDR
    Object Year_DDR is a Year_DataDictionary
        Set DDO_Server to (Branch_DDR(self))
    End_Object    // Year_DDR

    Object Ctypkin_DDR is a Ctypkin_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Ctypkin_DDR

    Object Cflagkin_DDR is a Cflagkin_DataDictionary
        Set DDO_Server to (Ctypkin_DDR(self))
        Set Constrain_File to Ctypkin.File_Number
    End_Object    // Cflagkin_DDR

    Object Ctypkin_DDW is a Ctypkin_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Ctypkin_DDR

    Object Cflagkin_DDW is a Cflagkin_DataDictionary
        Set DDO_Server to (Ctypkin_DDW(self))
    End_Object    // Cflagkin_DDR

    Object Btypkin_DDR is a Btypkin_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Btypkin_DDR

    Object Bflagkin_DDR is a Bflagkin_DataDictionary
        Set DDO_Server to (Btypkin_DDR(self))
        Set Constrain_File to Btypkin.File_Number
    End_Object    // Bflagkin_DDR

    Object Btypkin_DDW is a Btypkin_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Btypkin_DDW

    Object Bflagkin_DDW is a Bflagkin_DataDictionary
        Set DDO_Server to (Btypkin_DDW(self))
    End_Object    // Bflagkin_DDR

    Object Wtypkin_DDR is a Wtypkin_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Wtypkin_DDR

    Object Wtypkin_DDW is a Wtypkin_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Wtypkin_DDR

    Object Wflagkin_DDW is a Wflagkin_DataDictionary
        Set DDO_Server to (Wtypkin_DDW(self))
    End_Object    // Wflagkin_DDR

    Object Wflagkin_DDR is a Wflagkin_DataDictionary
        Set DDO_Server to (Wtypkin_DDR(self))
        Set Constrain_File to Wtypkin.File_Number
    End_Object    // Wflagkin_DDR

    Object Clients_DDR is a Clients_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Clients_DDR

    Object CN_DDR is a CN_DataDictionary
        Set DDO_Server to (Clients_DDR(self))
        set constrain_file to clients.file_number
    End_Object    // CN_DDR

    Object Clients_DDW is a Clients_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Clients_DDR

    Object CN_DDW is a CN_DataDictionary
        Set DDO_Server to (Clients_DDW(self))
    End_Object    // CN_DDR


    Object BaxioKat_DDR is a BaxioKat_DataDictionary
    End_Object    // BaxioKat_DDR

    Object BaxioKat_DDW is a BaxioKat_DataDictionary
    End_Object    // BaxioKat_DDW

    Object Baxio_DDR is a Baxio_DataDictionary
        Set piMustNOTConstrain(Self)) to True
        Set DDO_Server to (BaxioKat_DDR(self))
    End_Object    // Baxio_DDR

    Object Baxio_DDW is a Baxio_DataDictionary
        Set piMustNOTConstrain(Self)) to True
        Set DDO_Server to (BaxioKat_DDW(self))
    End_Object    // Baxio_DDW

    Object Wapokat_DDW is a Wapokat_DataDictionary
    End_Object    // Wapokat_DDW

    Object Wapomast_DDW is a Wapomast_DataDictionary
        Set DDO_Server to (Wapokat_DDW(self))
    End_Object    // Wapomast_DDW

    Object Wax_DDW is a Wax_DataDictionary
        Set piMustNOTConstrain(Self)) to True
        Set DDO_Server to (Wapomast_DDW(self))
    End_Object    // Wax_DDW

    Object Wapokat_DDR is a Wapokat_DataDictionary
    End_Object    // Wapokat_DDR

    Object Wapomast_DDR is a Wapomast_DataDictionary
        Set DDO_Server to (Wapokat_DDR(self))
    End_Object    // Wapomast_DDR

    Object Wax_DDR is a Wax_DataDictionary
        Set piMustNOTConstrain(Self)) to True
        Set DDO_Server to (Wapomast_DDR(self))
    End_Object    // Wax_DDR


    Object Fpa_DDR is a Fpa_DataDictionary
    End_Object    // Fpa_DDR

    Object Fpa_DDW is a Fpa_DataDictionary
    End_Object    // Fpa_DDW

    Object Witemkat_DDR is a Witemkat_DataDictionary
    End_Object    // Witemkat_DDR

    Object Units_DDR is a Units_DataDictionary
    End_Object    // Units_DDR

    Object Item_DDR is a Item_DataDictionary
        Set DDO_Server to (Witemkat_DDR(self))
        Set DDO_Server to (Units_DDR(self))
        Set DDO_Server to (Fpa_DDR(self))
    End_Object    // Item_DDR

    Object Witemx_DDR is a Witemx_DataDictionary
        Set DDO_Server to (Item_DDR(self))
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Witemx_DDR

    Object Witemxt_DDR is a Witemxt_DataDictionary
        Set DDO_Server to (Witemx_DDR(self))
        Set Constrain_File to Witemx.File_Number
    End_Object    // Witemx_DDR

    Object Witemkat_DDW is a Witemkat_DataDictionary
    End_Object    // Witemkat_DDW

    Object Units_DDW is a Units_DataDictionary
    End_Object    // Units_DDW

    Object Item_DDW is a Item_DataDictionary
        Set DDO_Server to (Witemkat_DDW(self))
        Set DDO_Server to (Units_DDW(self))
        Set DDO_Server to (Fpa_DDW(self))
    End_Object    // Item_DDW

    Object Witemx_DDW is a Witemx_DataDictionary
        Set DDO_Server to (Item_DDW(self))
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Witemx_DDW

    Object Hmgio_DDR is a Hmgio_DataDictionary
    End_Object    // Hmgio_DDR

    Object Hmgio_DDW is a Hmgio_DataDictionary
    End_Object    // Hmgio_DDW

    Object HmgioW_DDR is a HmgioW_DataDictionary
    End_Object    // HmgioW_DDR

    Object HmgioW_DDW is a HmgioW_DataDictionary
    End_Object    // HmgioW_DDW

    Object Witemxt_DDW is a Witemxt_DataDictionary
        Set DDO_Server to (Witemx_DDW(self))
    End_Object    // Witemx_DDW

    Object HmCtyp_DDR is a HmCtyp_DataDictionary
        Set DDO_Server to (Ctypkin_DDR(self))
        Set DDO_Server to (Hmgio_DDR(self))
    End_Object    // HmCtyp_DDR

    Object HmCtyp_DDW is a HmCtyp_DataDictionary
        Set DDO_Server to (Ctypkin_DDW(self))
        Set DDO_Server to (Hmgio_DDW(self))
    End_Object    // HmCtyp_DDW

    Object HmWtyp_DDR is a HmWtyp_DataDictionary
        Set DDO_Server to (Wtypkin_DDR(self))
        Set DDO_Server to (HmgioW_DDR(self))
    End_Object    // HmWtyp_DDR

    Object HmWtyp_DDW is a HmWtyp_DataDictionary
        Set DDO_Server to (Wtypkin_DDW(self))
        Set DDO_Server to (HmgioW_DDW(self))
    End_Object    // HmWtyp_DDW


    Object Ptyppar_DDR is a Ptyppar_DataDictionary
        Set DDO_Server to (Ctypkin_DDR(self))
        Set DDO_Server to (Wtypkin_DDR(self))
    End_Object    // Ptyppar_DDR

    Object Ptyppar_DDW is a Ptyppar_DataDictionary
        Set DDO_Server to (Ctypkin_DDW(self))
        Set DDO_Server to (Wtypkin_DDW(self))
    End_Object    // Ptyppar_DDR

    Object Pseira_DDW is a Pseira_DataDictionary
        Set DDO_Server to (Ptyppar_DDW(self))
    End_Object    // Pseira_DDR

    Object Pseira_DDR is a Pseira_DataDictionary
        Set DDO_Server to (Ptyppar_DDR(self))
        Set Constrain_File to Ptyppar.File_Number
    End_Object    // Pseira_DDR

    Object BkinKat_DDR is a BkinKat_DataDictionary
        Set DDO_Server to (Btypkin_DDR(self))
        Set DDO_Server to (Baxiokat_DDR(self))
    End_Object    // BkinKat_DDR

    Object BkinKat_DDW is a BkinKat_DataDictionary
        Set DDO_Server to (Btypkin_DDW(self))
        Set DDO_Server to (Baxiokat_DDW(self))
    End_Object    // BkinKat_DDW


    Property String psCurXr Public ''

    //AB-StoreTopEnd

    Set Label to "Ñ´ò†®úÂò - ìß¶°ò´·©´û£ò - ï®„©ú†™"
    Set Size to 277 464
    Set Location to 4 8

    //AB-DDOStart

    Object Company_DD is a Company_DataDictionary
    End_Object    // Company_DD

    Object Branch_DD is a Branch_DataDictionary
        Set DDO_Server to (Company_DD(self))
    End_Object    // Branch_DD

    Object Year_DD is a Year_DataDictionary
        Set DDO_Server to (Branch_DD(self))
        Set Constrain_File to Branch.File_Number
    End_Object    // Year_DD

    Object Ctypkin_DD is a Ctypkin_DataDictionary
    End_Object    // Ctypkin_DD

    Object Cflagkin_DD is a Cflagkin_DataDictionary
        Set DDO_Server to (Ctypkin_DD(self))
        Set Constrain_File to Ctypkin.File_Number
    End_Object    // Cflagkin_DD

    Object Syscurxr_DD is a Syscurxr_DataDictionary
    End_Object    // Syscurxr_DD

    Set Main_DD to (Branch_DD(self))
    Set Server to (Branch_DD(self))

    //AB-DDOEnd

    Object Container1 is a dbContainer3d
        Set Size to 103 454
        Set Location to 2 3
        Object Company_Company_code is a dbForm
            Entry_Item Company.Company_code
            Set Size to 13 66
            Set Location to 5 66
            Set Label_Col_Offset to 2
            Set Label_Justification_Mode to jMode_Right
        End_Object    // Company_Company_code

        Object Company_Company_name is a dbForm
            Entry_Item Company.Company_name
            Set Size to 13 366
            Set Location to 20 66
            Set Label_Col_Offset to 2
            Set Label_Justification_Mode to jMode_Right
        End_Object    // Company_Company_name

        Object Branch_Branch_code is a dbForm
            Entry_Item Branch.Branch_code
            Set Size to 13 66
            Set Location to 34 66
            Set Label_Col_Offset to 2
            Set Label_Justification_Mode to jMode_Right
        End_Object    // Branch_Branch_code

        Object Branch_Branch_name is a dbForm
            Entry_Item Branch.Branch_name
            Set Size to 13 366
            Set Location to 50 66
            Set Label_Col_Offset to 2
            Set Label_Justification_Mode to jMode_Right
        End_Object    // Branch_Branch_name

        Object Branch_Branch_Site is a dbFormSub
            Entry_Item Branch.Branch_site
            Set Size to 13 36
            Set Location to 65 66
            Set Label_Col_Offset to 2
            Set Label_Justification_Mode to jMode_Right
        End_Object    // Branch_Branch_Site

        Object Branch_Branch_Apoth is a dbFormSub
            Entry_Item Branch.Branch_apoth
            Set Size to 13 36
            Set Location to 80 66
            Set Label_Col_Offset to 2
            Set Label_Justification_Mode to jMode_Right
        End_Object    // Branch_Branch_Apoth

        Object TextBoxSub4 is a TextBoxSub
            Set Label to "Ñ´ò†®úÂò"
            Set Location to 5 7
            Set Size to 10 44
        End_Object    // TextBoxSub4

        Object TextBoxSub5 is a TextBoxSub
            Set Label to "Ñß‡§¨£Âò"
            Set Location to 21 7
            Set Size to 10 47
        End_Object    // TextBoxSub5

        Object TextBoxSub6 is a TextBoxSub
            Set Label to "ìß¶°ò´ò©´„£ò´ò"
            Set Location to 35 7
            Set Size to 10 55
        End_Object    // TextBoxSub6

        Object TextBoxSub7 is a TextBoxSub
            Set Location to 102 5
            Set Size to 3731 6307
        End_Object    // TextBoxSub7

        Object TextBoxSub8 is a TextBoxSub
            Set Label to "Ñß‡§¨£Âò"
            Set Location to 50 7
            Set Size to 10 36
        End_Object    // TextBoxSub8

        Object TextBoxSub9 is a TextBoxSub
            Set Label to "í¶£‚ò™"
            Set Location to 66 7
            Set Size to 10 29
        End_Object    // TextBoxSub9

        Object TextBoxSub10 is a TextBoxSub
            Set Label to "Äß¶ü„°û      :"
            Set Location to 81 7
            Set Size to 10 44
        End_Object    // TextBoxSub10

    End_Object    // Container1

    Object The_Table is a dbGrid
        Set Main_File to Year.File_Number
        Set Server to (Year_DD(self))
        Set Ordering to 1
        Set Size to 70 456
        Set Location to 109 3
        Set Wrap_State to TRUE

        Begin_Row
            Entry_Item Year.Year_year
            Entry_Item Year.Year_descr
            Entry_Item Year.Year_xrhshfrom
            Entry_Item Year.Year_xrhshto
            Entry_Item Year.Year_entrydate
            Entry_Item Year.Year_c_code0
            Entry_Item Year.Year_c_code00
            Entry_Item Year.Year_c_coder
        End_Row

        Set Form_Width    item 0 to 45
        Set Header_Label  item 0 to "ï®„©û :          "

        Set Form_Width    item 1 to 67
        Set Header_Label  item 1 to "èú®†ö®ò≠„"

        Set Form_Width    item 2 to 60
        Set Header_Label  item 2 to "ï®„©û Äß¶"

        Set Form_Width    item 3 to 57
        Set Header_Label  item 3 to "ï®„©û Ñ‡™"

        Set Form_Width    item 4 to 57
        Set Header_Label  item 4 to "Ü£/§Âò âò´òÆ."

        Set Form_Width    item 5 to 55
        Set Header_Label  item 5 to "Ä' åÊ£†©£ò"

        Set Form_Width    item 6 to 50
        Set Header_Label  item 6 to "Å' åÊ£†©£ò"

        Set Form_Width    item 7 to 60
        Set Header_Label  item 7 to "åÊ£†©£ò Report"


        //AB-StoreStart

        Function row_save returns integer

        //            Set_argument_size 2048

            Integer iRetVal liYearDD liCompanyDD liBranchDD iYear iLastYear rVal SysYear
            Integer iYparxei iCtypkin iBtypkin iWtypkin iForce iClient iBaxio iPtyppar iWitemx iWax
            String  sYearRecr sSite sCname sBname sYname sNom1 sNom2 sNom3 sAnti sFlags sRR2 sRR3
            String  sCompany_Code sBranch_Code sBeto_Site sCode sFlag sRR sDescr sDescrFlag sModule
            Date    ldYearXrhsh_From ldYearXrhsh_To
            Date    bBTYPKIN_L_HMNIA
            Integer bGTYPKIN_CODE bCTYPKIN_CODE bVTYPKIN_CODE bGTYPKIN_REC0 bBTYPKIN_SIGN
            Integer bCTYPKIN_REC0 bVTYPKIN_REC0 bBTYPKIN_ANTI1 bBTYPKIN_ANTI2
            Integer bBFLAGKIN_NUM bBTYPKIN_ANTI_XP bBTYPKIN_L_NO isNewBranch
            Integer bBTYPKIN_FLAG01  bBTYPKIN_FLAG02  bBTYPKIN_FLAG03 bBTYPKIN_FLAG04
            Integer bBTYPKIN_FLAG05  bBTYPKIN_FLAG06  bBTYPKIN_FLAG07 bBTYPKIN_FLAG08
            Integer bBTYPKIN_FLAG09  bBTYPKIN_FLAG10 bBTYPKIN_FLAG11 bBTYPKIN_FLAG12
            Integer bBTYPKIN_FLAG13 bBTYPKIN_FLAG14 bBTYPKIN_FLAG15 bBTYPKIN_FLAG16
            Integer bBTYPKIN_FLAG17 bBTYPKIN_FLAG18 bBTYPKIN_FLAG19 bBTYPKIN_FLAG20
            String  bGPLAN_CODE_APO1  bGPLAN_CODE_EOS1 bGPLAN_CODE_APO2 bGPLAN_CODE_EOS2
            String  bBTYPKIN_PRINTER bBTYPKIN_PDESCR bBTYPKIN_FORM bBTYPKIN_SEIRA SysYearRecr
            String  bBTYPKIN_ABR bCTYPKIN_RECR bBTYPKIN_DESCR sYearRecrNew SysCompany SysBranch
            Number  bBKINKAT_NUM cXREOSH cPISTOSH cYPOLOIPO cPLAFON cOVERHEAD
            String  cCUSTPROM_CODE cCLIENT_ID cCLIENT_NAME cCLIENT_AFM cCUSTPROM_RECR cCLIENT_RECR
            Integer cCLIENT_REC0 cCLIENT_DOY cCLIENT_CITY cCLIENT_AREA cCLIENT_CATEGFPA cCLIENT_FPA cCLIENT_PUBLIC
            Integer cCLIENT_CATJOB
            Date    cLAST_XREOSH cLAST_PISTOSH cLAST_ORDER cCLIENT_LASTUPD
            String  cCLIENT_ADDRESS cCLIENT_JOB cCLIENT_RESPONS cCLIENT_ZIPCODE cCLIENT_PHONE cCLIENT_CODEM
            String  cCLIENT_FAX cCLIENT_MOBILE cCLIENT_AOH cCLIENT_EMAIL cCLIENT_CLASS cCLIENT_DETAILS cCLIENT_SITEW
            String  cCLIENT_SN cCLIENT_REPM cCLIENT_ACTIVE cCLIENT_REPORTED cCLIENT_PELPROM cCLIENT_MARKEXP
            String  cIS_PROMHTHEYTHS cis_pelaths
        //            Integer dAXIOKAT_CODE dAXIO_REC0 dAXIO_STATUS dAXIO_PLACE dAXIO_FILE_IN dAXIO_FILE_OUT
        //            Integer dAXIO_LFILE
        //            String  dEAR_RECR dAXIOKAT_RECR dAXIO_RECR dAXIO_CODE_IN dAXIO_EPON_IN dAXIO_FPAR_IN
        //            String  dAXIO_CODE_OUT dAXIO_EPON_OUT dAXIO_FPAR_OUT dAXIO_LCODE dAXIO_LEPON dAXIO_LPAR
        //            Date    dAXIO_HMNIAE dAXIO_HMNIAP000 dAXIO_HMNIAL
        //            String  dAXIO_BANK00000 dAXIO_EKDOTHS dAXIO_EKDOTHSE dAXIO_SEDIATAGH dAXIO_SDIATAGHE dAXIO_BANKA
        //            String  dAXIO_NO dAXIO_C_CODE2 dAXIO_OPISTHO
        //            Number  dAXIO_V2 dAXIO_V0 dAXIO_V00 dAXIO_VR dAXIO_RATE0 dAXIO_RATE00 dAXIO_RATER
        //            Integer dAXIO_LIXI_YYYY dAXIO_LIXI_MM dAXIO_LIXI_DD dAXIO_BMOVE_LAA

            String  wWAPOKAT_CODE wWAPOMAST_CODE wWAX_CODE wYEAR_RECR wWAPOMAST_RECR wWAX_RECR wWAX_DESCR
            Integer wWAX_REC0

            String  zUNITS_CODE zWITEMKAT_CODE zITEM_CODE zWITEMX_CODE zWITEMX_RECR zYEAR_RECR
            String  zITEM_RECR zWITEMX_DESCR zWITEMX_YEARDESC zITEM_APOKAT_COD sYear_Anaforas
            Integer zWITEMX_REC0 zAXIA zAXIA0 zAXIA00 zAXIAR tPTYPPAR_REC0 rVal1
            Integer tPSEIRA_REC0 tPSEIRA_AUTONUM tAUTONUM_PLUS tAUTONUM_MINUS iHmCtyp iHmWtyp iBkinkat
            Date    zVALUE_DATE

            String tCTYPKIN_CODE tWTYPKIN_CODE tYEAR_RECR tCTYPKIN_RECR tWTYPKIN_RECR
            String tPTYPPAR_CODE tPTYPPAR_DESCR tPTYPPAR_IS_WHAT tPTYPPAR_MODULE SysBetoSite
            String tPTYPPAR_ABREV tPSEIRA_SEIRA tPSEIRA_PRINTER tPSEIRA_FORM sCurrentXrhsh

            String uHMGIO_CODE uCTYPKIN_RECR uCTYPKIN_CODE uWTYPKIN_RECR uWTYPKIN_CODE

            Get Checked_State Of chkCtypkin     to iCtypkin
            Get Checked_State Of chkBtypkin     to iBtypkin
            Get Checked_State Of chkWtypkin     to iWtypkin
            Get Checked_State Of chkClient      to iClient
            Get Checked_State Of chkBaxio       to iBaxio
            Get Checked_State Of chkPtyppar     to iPtyppar
            Get Checked_State Of chkWitemx      to iWitemx
            Get Checked_State Of chkHmCtyp      to iHmCtyp
            Get Checked_State Of chkHmWtyp      to iHmWtyp
            Get Checked_State Of chkBkinkat     to iBkinkat
            Get Checked_State Of chkWax         to iWax
            Get Checked_State Of chkForce       to iForce

            Get Value Of frmYear Item 0 to sYear_Anaforas
            Move (trim(sYear_Anaforas)) to sYear_Anaforas


            Move (Trim(SysCurXr.Company_Code))  to SysCompany
            Move (Trim(SysCurXr.Branch_Code))   to SysBranch
            Move (Trim(SysCurXr.Year_Year))     to SysYear
            Move (Trim(SysCurXr.Year_Recr))     to SysYearRecr
            Move (Trim(SysCurXr.Beto_Site))     to SysBetoSite

            Get psCurXr to sCurrentXrhsh
            Move (Trim(sCurrentXrhsh)) to sCurrentXrhsh

            Move 0 to iLastYear

            //  1. ë¨¢¢¶ö„ ©´¶†ÆúÂ‡§ ßò¢ò†·™ Æ®„©û™
            Move Company_DD                                                     to liCompanyDD
            Move Branch_DD                                                      to liBranchDD
            Move Year_DD                                                        to liYearDD

            Get Field_Current_Value of liCompanyDD Field Company.Company_Code   to sCompany_Code
            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code     to sBranch_Code
            Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site       to sBeto_Site
            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site     to sSite
            Get Field_Current_Value of liYearDD    Field Year.Year_Year         to iYear
            Get Field_Current_Value of liYearDD    Field Year.Year_Recr         to sYearRecr
            Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0      to sNom1
            Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00     to sNom2
            Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR      to sNom3
            Get Field_Current_Value of liCompanyDD Field Company.Company_Name   to sCname
            Get Field_Current_Value of liBranchDD  Field Branch.Branch_name     to sBname
            Get Field_Current_Value of liYearDD    Field Year.Year_Descr        to sYname

            Move 0 to isNewBranch

            If (sYear_Anaforas='') Begin
                // Ñ§´¶ß†©£Ê™ ´ú¢ú¨´òÂò™ Æ®„©û™ †õÂò™ Company+Branch
                // An õú§ ô®úÂ™ õú§ úÆú†™ ´†ß¶´ò §ò ò§´†ö®òØú†™
                Send Clear to Year_DDR
                Move sCompany_Code   to Year.Company_Code
                Move sBranch_Code    to Year.Branch_Code
                Move 2500            to Year.Year_Year
                Send Find to Year_DDR LE 1 // Company_Code+Branch_Code+Year_Year
                If ((Found=1) And (sCompany_Code=Year.Company_Code) And (sBranch_Code=Year.Branch_Code)) Begin
                    Get Field_Current_Value of Year_DDR     Field Year.Year_Year    to iLastYear
                    Get Field_Current_Value of Year_DDR     Field Year.Year_Recr    to SysYearRecr
                    Get Field_Current_Value of Branch_DDR   Field Branch.Beto_Site  to SysBetoSite
                    Move iLastYear      to SysYear
                    Move sCompany_Code  to SysCompany
                    Move sBranch_Code   to SysBranch
                End
                Else Begin
                    If ((Found=1) And (sCompany_Code=Year.Company_Code)) Begin
                        Move '‡'    to Year.Branch_Code
                        Move 2500   to Year.Year_Year
                        Send Find to Year_DDR LE 1 // Company_Code+Branch_Code+Year_Year
                        If ((Found=1) And (sCompany_Code=Year.Company_Code)) Begin
                            Get Field_Current_Value of Year_DDR     Field Year.Company_Code to SysCompany
                            Get Field_Current_Value of Year_DDR     Field Year.Branch_Code  to SysBranch
                            Get Field_Current_Value of Year_DDR     Field Year.Year_Year    to SysYear
                            Get Field_Current_Value of Year_DDR     Field Year.Year_Recr    to SysYearRecr
                            Get Field_Current_Value of Branch_DDR   Field Branch.Beto_Site  to SysBetoSite
                        End
                        Else Begin
                        End
                    End
                    Else Begin
                    End
                End
            End
            Else Begin
                Move sYear_Anaforas to iLastYear
            End



            Forward Get row_save to rVal


            If (Not(rVal)) Begin


                //  2. ë¨¢¢¶ö„ ©´¶†ÆúÂ‡§ å‚ò™ ï®„©û™
                Get Field_Current_Value of liCompanyDD Field Company.Company_Code   to sCompany_Code
                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code     to sBranch_Code
                Get Field_Current_Value of liYearDD    Field Year.Year_Year         to iYear
                Get Field_Current_Value of liYearDD    Field Year.Year_Recr         to sYearRecrNew
        //                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site       to sBeto_Site
        //                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site     to sSite
        //                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0      to sNom1
        //                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00     to sNom2
        //                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR      to sNom3
        //                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name   to sCname
        //                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name     to sBname
        //                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr        to sYname

                //////////////////////////////////////////////////////////////
                // Ä§ õú§ ¨ß·®Æú† iLastYear ©û£òÂ§ú† ß‡™ õú§ ô®‚üû°ú úöö®ò≠„
                // ß®¶ûö¶Á£ú§û™ Æ®„©û™ òß¶ ò¨´„ ß¶¨ °ò´òÆ‡®úÂ´ò† ´È®ò
                // ¶ßÊ´ú õú§ úÆú† ´†ß¶´ò §ò ò§´†ö®·Øú†

                // Ä¢¢†È™ û £ú´òô¢û´û iLastYear ßú®†úÆú† ´¶ ú´¶™ òß¶ ´¶ òß¶†¶ ò§´†ö®ò≠¶¨£ú
                //    °ò† û £ú´òô¢û´û iYear     ßú®†úÆú† ´¶ ú´¶™ ©´¶ ¶ß¶†¶ ò§´†ö®ò≠¶¨£ú

                If (Not(iLastYear))     Procedure_Return
              // georg 18/10/01
              // ¶´ò§ £ú´ò≠ú®¶¨£ú °†§„©ú†™ ©ú ò¢¢¶ ¨ß¶°ò´·©´û£ò £ò™ °¶ôú†
              //  If (iLastYear=iYear)    Procedure_Return

                //////////////////////////////////////////////////////////////

                    // Éû£†¶¨®öÂò §‚¶¨ record SysCurXr
                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code

                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site     to gs_Selected_Beto_Site

                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to sSite
                    Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to sYearRecr
                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3

                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname

                    Reread SysCurXR
                    Move gs_Selected_Company_Code   to SysCurXR.Company_Code
                    Move gs_Selected_beto_site      to SysCurXR.beto_site
                    Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
                    Move gi_Selected_Year           to SysCurXR.Year_Year
                    Move sYearRecr                  to SysCurXR.Year_Recr
                    Move sSite                      to SysCurXR.Branch_Site

                    Move sCname                     to SysCurXR.Company_Name
                    Move sBname                     to SysCurXR.Branch_Name
                    Move sYname                     to SysCurXR.Year_Descr

                    Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
                    Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo

                    Move  (Trim(sNom1))             to SysCurXR.C_Code0
                    Move  (Trim(sNom2))             to SysCurXR.C_Code00
                    Move  (Trim(sNom3))             to SysCurXR.C_CodeR

                    Saverecord SysCurXR
                    Unlock











                //  3. Ä§¶†ö£ò ´‡§ 8 Åò©†°È§ Ä®ÆúÂ‡§ ©ú Ä£ú©û úßò≠„ £ú ´¶ Year
                //  (Baxio+Btypkin+Ptyppar+Ctypkin+Clients+Witemx+Wax+Wtypkin)


                //////////////////
                //  A) CTYPKIN
                //////////////////

                If (iCtypkin) Begin
                    Send Clear              to Ctypkin_DDR
                    Move SysCompany     to Ctypkin.Company_Code
                    Move SysBranch      to Ctypkin.Branch_Code
                    Move SysYear            to Ctypkin.Year_Year
                    Send Find To Ctypkin_DDR Gt 1 //Comp+branch+year+Ctypkin_Code
                    While ((Found=1) And (SysCompany=Ctypkin.Company_Code)   ;
                                     And (SysBranch=Ctypkin.Branch_Code)     ;
                                     And (SysYear=Ctypkin.Year_Year))

                        Set Label Of txtM1 to 'CTYPKIN'
                        Set Label Of txtM2 to Ctypkin.Ctypkin_Code

                        Get Field_Current_value Of Ctypkin_DDR Field Ctypkin.Ctypkin_Code to sCode
                        Get Field_Current_Value Of Ctypkin_DDR Field Ctypkin.Ctypkin_Recr to sRR

                        Get Field_Current_Value Of Ctypkin_DDR Field Ctypkin.Ctypkin_Descr  to sDescr
                        Get Field_Current_Value Of Ctypkin_DDR Field Ctypkin.Ctypkin_Anti   to sAnti
                        Get Field_Current_Value Of Ctypkin_DDR Field Ctypkin.Ctypkin_Flags  to sFlags
                        Get Field_Current_Value Of Ctypkin_DDR Field Ctypkin.Ctypkin_Module to sModule

                        Send Clear to Ctypkin_DDW
                        Move sCompany_Code  to Ctypkin.Company_Code
                        Move sBranch_Code   to Ctypkin.Branch_Code
                        Move iYear          to Ctypkin.Year_Year
                        Move sCode          to Ctypkin.Ctypkin_Code
                        Send Find to Ctypkin_DDW Eq 1

                        If (iForce) Begin
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Company_Code   to sCompany_Code
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Branch_Code    to sBranch_Code
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Year_Year      to iYear
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Code   to sCode
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Descr  to sDescr
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Anti   to sAnti
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Flags  to sFlags
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Module to sModule
                            Send Request_Save to Ctypkin_DDW
                        End
                        Else If (NOT(Found)) Begin
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Company_Code   to sCompany_Code
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Branch_Code    to sBranch_Code
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Year_Year      to iYear
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Code   to sCode
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Descr  to sDescr
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Anti   to sAnti
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Flags  to sFlags
                            Set Field_Changed_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Module to sModule
                            Send Request_Save to Ctypkin_DDW
                        End

                        Get Field_Current_Value Of Ctypkin_DDW Field Ctypkin.Ctypkin_Recr to sRR3

                        Clear Cflagkin
                        Move sRR    to Cflagkin.Ctypkin_Recr
                        Find Gt Cflagkin By Index.4
                        While ((Found=1) And (sRR=Cflagkin.Ctypkin_Recr))

                            Move Cflagkin.Cflagkin_Flag    to sFlag
                            Move Cflagkin.Cflagkin_Descr   to sDescrFlag
                            Move Cflagkin.Cflagkin_Recr    to sRR2
                            ////////////////////////////////////////////
                            Clear Cflagkin
//                            Move sCompany_Code      to Cflagkin.Company_Code
//                            Move sBranch_Code       to Cflagkin.Branch_Code
//                            Move iYear              to Cflagkin.Year_Year
                            Move sCode              to Cflagkin.Ctypkin_Code
                            Move sFlag              to Cflagkin.Cflagkin_Flag
                            Find Eq Cflagkin By Index.1
                            If (iForce) Begin
                                If (Found) Begin
                                    Clear Ctypkin
                                    Move sRR3 to Ctypkin.Ctypkin_Recr
                                    Find Eq Ctypkin By Index.2
                                    Reread
//                                    Move sCompany_Code              To Cflagkin.Company_Code
//                                    Move sBranch_Code               To Cflagkin.Branch_Code
//                                    Move iYear                      To Cflagkin.Year_Year
                                    Move sCode                      To Cflagkin.Ctypkin_Code
                                    Move sFlag                      To Cflagkin.Cflagkin_flag
                                    Move sDescrFlag                 To Cflagkin.Cflagkin_Descr
                                    Move Ctypkin.Ctypkin_Recr       To Cflagkin.Ctypkin_Recr
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
                                    Saverecord Cflagkin
                                    Unlock
                                End
                                Else Begin
                                    Clear Ctypkin
                                    Move sRR3 to Ctypkin.Ctypkin_Recr
                                    Find Eq Ctypkin By Index.2
//                                    Move sCompany_Code              To Cflagkin.Company_Code
//                                    Move sBranch_Code               To Cflagkin.Branch_Code
//                                    Move iYear                      To Cflagkin.Year_Year
                                    Move sCode                      To Cflagkin.Ctypkin_Code
                                    Move sFlag                      To Cflagkin.Cflagkin_flag
                                    Move sDescrFlag                 To Cflagkin.Cflagkin_Descr
                                    Move Ctypkin.Ctypkin_Recr       To Cflagkin.Ctypkin_Recr
                                    Move (SYSRECC.CFLAGKIN_REC0+1)  To Cflagkin.Cflagkin_Rec0
                                    Reread Sysrecc
                                    Move (SYSRECC.CFLAGKIN_REC0+1)  To Sysrecc.Cflagkin_Rec0
                                    Saverecord Sysrecc
                                    Unlock
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
                                    Saverecord Cflagkin
                                End
                            End
                            Else If (Not(Found)) Begin
                                Clear Ctypkin
                                Move sRR3 to Ctypkin.Ctypkin_Recr
                                Find Eq Ctypkin By Index.2
//                                Move sCompany_Code              To Cflagkin.Company_Code
//                                Move sBranch_Code               To Cflagkin.Branch_Code
//                                Move iYear                      To Cflagkin.Year_Year
                                Move sCode                      To Cflagkin.Ctypkin_Code
                                Move sFlag                      To Cflagkin.Cflagkin_flag
                                Move sDescrFlag                 To Cflagkin.Cflagkin_Descr
                                Move Ctypkin.Ctypkin_Recr       To Cflagkin.Ctypkin_Recr
                                Move (SYSRECC.CFLAGKIN_REC0+1)  To Cflagkin.Cflagkin_Rec0
                                Reread Sysrecc
                                Move (SYSRECC.CFLAGKIN_REC0+1)  To Sysrecc.Cflagkin_Rec0
                                Saverecord Sysrecc
                                Unlock
                                Move (Append('',((Trim(sSite))+;
                                (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
                                Saverecord Cflagkin
                            End
                            ////////////////////////////////////////////
                            Clear Cflagkin
                            Move sRR2 to Cflagkin.Cflagkin_Recr
                            Find eq Cflagkin By Index.2
                            Find Gt Cflagkin By Index.4
                        Loop

                        Send Clear to Ctypkin_DDR
                        Move sRR to Ctypkin.Ctypkin_Recr
                        Send Find to Ctypkin_DDR eq 2

                        Send Find To Ctypkin_DDR Gt 1 //Comp+branch+year+Ctypkin_Code
                    Loop
                End // If (iCtypkin)




                //  B) BTYPKIN
                If (iBtypkin) Begin
                    Send Clear              to Btypkin_DDR
                    Move SysCompany     to Btypkin.Company_Code
                    Move SysBranch      to Btypkin.Branch_Code
                    Move SysYear            to Btypkin.Year_Year
                    Send Find To Btypkin_DDR Gt 1 //Comp+branch+year+Btypkin_Code
                    While ((Found=1) And (SysCompany=Btypkin.Company_Code)   ;
                                     And (SysBranch=Btypkin.Branch_Code)     ;
                                     And (SysYear=Btypkin.Year_Year))




                        Set Label Of txtM1 to 'Btypkin'
                        Set Label Of txtM2 to Btypkin.Btypkin_Code

                        Get Field_Current_value Of Btypkin_DDR Field Btypkin.Btypkin_Code to sCode
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.Btypkin_Recr to sRR

                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_L_HMNIA    to bBTYPKIN_L_HMNIA
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.GTYPKIN_CODE       to bGTYPKIN_CODE
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.CTYPKIN_CODE       to bCTYPKIN_CODE
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.VTYPKIN_CODE       to bVTYPKIN_CODE
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.GTYPKIN_REC0       to bGTYPKIN_REC0
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_SIGN       to bBTYPKIN_SIGN
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.CTYPKIN_REC0       to bCTYPKIN_REC0
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_ANTI2      to bBTYPKIN_ANTI2
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_ANTI1      to bBTYPKIN_ANTI1
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.VTYPKIN_REC0       to bVTYPKIN_REC0
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_ANTI_XP    to bBTYPKIN_ANTI_XP
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BKINKAT_NUM        to bBKINKAT_NUM
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BFLAGKIN_NUM       to bBFLAGKIN_NUM
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG01     to bBTYPKIN_FLAG01
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG02     to bBTYPKIN_FLAG02
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG03     to bBTYPKIN_FLAG03
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG04     to bBTYPKIN_FLAG04
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG05     to bBTYPKIN_FLAG05
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG06     to bBTYPKIN_FLAG06
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG07     to bBTYPKIN_FLAG07
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG08     to bBTYPKIN_FLAG08
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG09     to bBTYPKIN_FLAG09
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG10     to bBTYPKIN_FLAG10
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG11     to bBTYPKIN_FLAG11
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG12     to bBTYPKIN_FLAG12
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG13     to bBTYPKIN_FLAG13
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG14     to bBTYPKIN_FLAG14
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG15     to bBTYPKIN_FLAG15
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG16     to bBTYPKIN_FLAG16
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG17     to bBTYPKIN_FLAG17
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG18     to bBTYPKIN_FLAG18
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG19     to bBTYPKIN_FLAG19
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FLAG20     to bBTYPKIN_FLAG20
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.GPLAN_CODE_APO1    to bGPLAN_CODE_APO1
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.GPLAN_CODE_EOS1    to bGPLAN_CODE_EOS1
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.GPLAN_CODE_EOS2    to bGPLAN_CODE_EOS2
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.GPLAN_CODE_APO2    to bGPLAN_CODE_APO2
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_SEIRA      to bBTYPKIN_SEIRA
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_FORM       to bBTYPKIN_FORM
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_PDESCR     to bBTYPKIN_PDESCR
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_ABR        to bBTYPKIN_ABR
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.CTYPKIN_RECR       to bCTYPKIN_RECR
                        Get Field_Current_Value Of Btypkin_DDR Field Btypkin.BTYPKIN_DESCR      to bBTYPKIN_DESCR



                        Send Clear to Btypkin_DDW
                        Move sCompany_Code  to Btypkin.Company_Code
                        Move sBranch_Code   to Btypkin.Branch_Code
                        Move iYear          to Btypkin.Year_Year
                        Move sCode          to Btypkin.Btypkin_Code
                        Send Find to Btypkin_DDW Eq 1
                        If (iForce) Begin
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Company_Code       to sCompany_Code
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Branch_Code        to sBranch_Code
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Year_Year          to iYear
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Btypkin_Code       to sCode
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_L_HMNIA    to bBTYPKIN_L_HMNIA
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GTYPKIN_CODE       to bGTYPKIN_CODE
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.CTYPKIN_CODE       to bCTYPKIN_CODE
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.VTYPKIN_CODE       to bVTYPKIN_CODE
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GTYPKIN_REC0       to bGTYPKIN_REC0
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_SIGN       to bBTYPKIN_SIGN
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.CTYPKIN_REC0       to bCTYPKIN_REC0
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ANTI2      to bBTYPKIN_ANTI2
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ANTI1      to bBTYPKIN_ANTI1
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.VTYPKIN_REC0       to bVTYPKIN_REC0
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ANTI_XP    to bBTYPKIN_ANTI_XP
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BKINKAT_NUM        to bBKINKAT_NUM
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BFLAGKIN_NUM       to bBFLAGKIN_NUM
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG01     to bBTYPKIN_FLAG01
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG02     to bBTYPKIN_FLAG02
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG03     to bBTYPKIN_FLAG03
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG04     to bBTYPKIN_FLAG04
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG05     to bBTYPKIN_FLAG05
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG06     to bBTYPKIN_FLAG06
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG07     to bBTYPKIN_FLAG07
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG08     to bBTYPKIN_FLAG08
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG09     to bBTYPKIN_FLAG09
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG10     to bBTYPKIN_FLAG10
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG11     to bBTYPKIN_FLAG11
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG12     to bBTYPKIN_FLAG12
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG13     to bBTYPKIN_FLAG13
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG14     to bBTYPKIN_FLAG14
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG15     to bBTYPKIN_FLAG15
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG16     to bBTYPKIN_FLAG16
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG17     to bBTYPKIN_FLAG17
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG18     to bBTYPKIN_FLAG18
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG19     to bBTYPKIN_FLAG19
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG20     to bBTYPKIN_FLAG20
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_APO1    to bGPLAN_CODE_APO1
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_EOS1    to bGPLAN_CODE_EOS1
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_EOS2    to bGPLAN_CODE_EOS2
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_APO2    to bGPLAN_CODE_APO2
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_SEIRA      to bBTYPKIN_SEIRA
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FORM       to bBTYPKIN_FORM
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_PDESCR     to bBTYPKIN_PDESCR
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ABR        to bBTYPKIN_ABR
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.CTYPKIN_RECR       to bCTYPKIN_RECR
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_DESCR      to bBTYPKIN_DESCR
                            Send Request_Save to Btypkin_DDW
                        End
                        Else If (NOT(Found)) Begin
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Company_Code   to sCompany_Code
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Branch_Code    to sBranch_Code
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Year_Year      to iYear
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.Btypkin_Code   to sCode
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_L_HMNIA    to bBTYPKIN_L_HMNIA
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GTYPKIN_CODE       to bGTYPKIN_CODE
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.CTYPKIN_CODE       to bCTYPKIN_CODE
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.VTYPKIN_CODE       to bVTYPKIN_CODE
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GTYPKIN_REC0       to bGTYPKIN_REC0
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_SIGN       to bBTYPKIN_SIGN
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.CTYPKIN_REC0       to bCTYPKIN_REC0
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ANTI2      to bBTYPKIN_ANTI2
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ANTI1      to bBTYPKIN_ANTI1
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.VTYPKIN_REC0       to bVTYPKIN_REC0
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ANTI_XP    to bBTYPKIN_ANTI_XP
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BKINKAT_NUM        to bBKINKAT_NUM
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BFLAGKIN_NUM       to bBFLAGKIN_NUM
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG01     to bBTYPKIN_FLAG01
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG02     to bBTYPKIN_FLAG02
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG03     to bBTYPKIN_FLAG03
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG04     to bBTYPKIN_FLAG04
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG05     to bBTYPKIN_FLAG05
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG06     to bBTYPKIN_FLAG06
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG07     to bBTYPKIN_FLAG07
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG08     to bBTYPKIN_FLAG08
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG09     to bBTYPKIN_FLAG09
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG10     to bBTYPKIN_FLAG10
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG11     to bBTYPKIN_FLAG11
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG12     to bBTYPKIN_FLAG12
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG13     to bBTYPKIN_FLAG13
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG14     to bBTYPKIN_FLAG14
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG15     to bBTYPKIN_FLAG15
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG16     to bBTYPKIN_FLAG16
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG17     to bBTYPKIN_FLAG17
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG18     to bBTYPKIN_FLAG18
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG19     to bBTYPKIN_FLAG19
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FLAG20     to bBTYPKIN_FLAG20
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_APO1    to bGPLAN_CODE_APO1
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_EOS1    to bGPLAN_CODE_EOS1
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_EOS2    to bGPLAN_CODE_EOS2
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.GPLAN_CODE_APO2    to bGPLAN_CODE_APO2
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_SEIRA      to bBTYPKIN_SEIRA
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_FORM       to bBTYPKIN_FORM
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_PDESCR     to bBTYPKIN_PDESCR
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_ABR        to bBTYPKIN_ABR
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.CTYPKIN_RECR       to bCTYPKIN_RECR
                            Set Field_Changed_Value Of Btypkin_DDW Field Btypkin.BTYPKIN_DESCR      to bBTYPKIN_DESCR
                            Send Request_Save to Btypkin_DDW
                        End

                        Get Field_Current_Value Of Btypkin_DDW Field Btypkin.Btypkin_Recr to sRR3

                        Clear Bflagkin
                        Move sRR    to Bflagkin.Btypkin_Recr
                        Find Gt Bflagkin By Index.3
                        While ((Found=1) And (sRR=Bflagkin.Btypkin_Recr))

                            Move Bflagkin.Bflagkin_Flag    to sFlag
                            Move Bflagkin.Bflagkin_Recr    to sRR2
                            ////////////////////////////////////////////
                            Clear Bflagkin
                            Move sCompany_Code      to Bflagkin.Company_Code
                            Move sBranch_Code       to Bflagkin.Branch_Code
                            Move iYear              to Bflagkin.Year_Year
                            Move sCode              to Bflagkin.Btypkin_Code
                            Move sFlag              to Bflagkin.Bflagkin_Flag
                            Find Eq Bflagkin By Index.1
                            If (iForce) Begin
                                If (Found) Begin
                                    Clear Btypkin
                                    Move sRR3 to Btypkin.Btypkin_Recr
                                    Find Eq Btypkin By Index.2
                                    Reread
                                    Move sCompany_Code              To Bflagkin.Company_Code
                                    Move sBranch_Code               To Bflagkin.Branch_Code
                                    Move iYear                      To Bflagkin.Year_Year
                                    Move sCode                      To Bflagkin.Btypkin_Code
                                    Move sFlag                      To Bflagkin.Bflagkin_flag
                                    //Move sDescrFlag                 To Bflagkin.Bflagkin_Descr
                                    Move Btypkin.Btypkin_Recr       To Bflagkin.Btypkin_Recr
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Bflagkin.Bflagkin_Rec0)))))) to Bflagkin.Bflagkin_Recr
                                    Saverecord Bflagkin
                                    Unlock
                                End
                                Else Begin
                                    Clear Btypkin
                                    Move sRR3 to Btypkin.Btypkin_Recr
                                    Find Eq Btypkin By Index.2
                                    Move sCompany_Code              To Bflagkin.Company_Code
                                    Move sBranch_Code               To Bflagkin.Branch_Code
                                    Move iYear                      To Bflagkin.Year_Year
                                    Move sCode                      To Bflagkin.Btypkin_Code
                                    Move sFlag                      To Bflagkin.Bflagkin_flag
                                    //Move sDescrFlag                 To Bflagkin.Bflagkin_Descr
                                    Move Btypkin.Btypkin_Recr       To Bflagkin.Btypkin_Recr
                                    Move (SYSRECB.Bflagkin_REC0+1)  To Bflagkin.Bflagkin_Rec0
                                    Reread SysrecB
                                    Move (SYSRECB.Bflagkin_REC0+1)  To SysrecB.Bflagkin_Rec0
                                    Saverecord SysrecB
                                    Unlock
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Bflagkin.Bflagkin_Rec0)))))) to Bflagkin.Bflagkin_Recr
                                    Saverecord Bflagkin
                                End

                            End
                            Else If (Not(Found)) Begin
                                Clear Btypkin
                                Move sRR3 to Btypkin.Btypkin_Recr
                                Find Eq Btypkin By Index.2
                                Move sCompany_Code              To Bflagkin.Company_Code
                                Move sBranch_Code               To Bflagkin.Branch_Code
                                Move iYear                      To Bflagkin.Year_Year
                                Move sCode                      To Bflagkin.Btypkin_Code
                                Move sFlag                      To Bflagkin.Bflagkin_flag
                                //Move sDescrFlag                 To Bflagkin.Bflagkin_Descr
                                Move Btypkin.Btypkin_Recr       To Bflagkin.Btypkin_Recr
                                Move (SYSRECB.Bflagkin_REC0+1)  To Bflagkin.Bflagkin_Rec0
                                Reread SysrecB
                                Move (SYSRECB.Bflagkin_REC0+1)  To SysrecB.Bflagkin_Rec0
                                Saverecord SysrecB
                                Unlock
                                Move (Append('',((Trim(sSite))+;
                                (Trim(String(Bflagkin.Bflagkin_Rec0)))))) to Bflagkin.Bflagkin_Recr
                                Saverecord Bflagkin
                            End
                            ////////////////////////////////////////////
                            Clear Bflagkin
                            Move sRR2 to Bflagkin.Bflagkin_Recr
                            Find eq Bflagkin By Index.2
                            Find Gt Bflagkin By Index.3
                        Loop

                        Send Clear to Btypkin_DDR
                        Move sRR to Btypkin.Btypkin_Recr
                        Send Find to Btypkin_DDR eq 2

                        Send Find To Btypkin_DDR Gt 1 //Comp+branch+year+Btypkin_Code
                    Loop
                End // If (iBtypkin)





                //////////////////
                //  C) WTYPKIN
                //////////////////

                If (iWtypkin) Begin
                    Send Clear          to Wtypkin_DDR
                    Move SysCompany to Wtypkin.Company_Code
                    Move SysBranch  to Wtypkin.Branch_Code
                    Move SysYear        to Wtypkin.Year_Year
                    Send Find To Wtypkin_DDR Gt 1 //Comp+branch+year+Wtypkin_Code
                    While ((Found=1) And (SysCompany=Wtypkin.Company_Code)   ;
                                     And (SysBranch=Wtypkin.Branch_Code)     ;
                                     And (SysYear=Wtypkin.Year_Year))


                        Set Label Of txtM1 to 'Wtypkin'
                        Set Label Of txtM2 to Wtypkin.Wtypkin_Code

                        Get Field_Current_value Of Wtypkin_DDR Field Wtypkin.Wtypkin_Code to sCode
                        Get Field_Current_Value Of Wtypkin_DDR Field Wtypkin.Wtypkin_Recr to sRR

                        Get Field_Current_Value Of Wtypkin_DDR Field Wtypkin.Wtypkin_Descr  to sDescr
                        Get Field_Current_Value Of Wtypkin_DDR Field Wtypkin.Wtypkin_Anti   to sAnti
                        //Get Field_Current_Value Of Wtypkin_DDR Field Wtypkin.Wtypkin_Flags  to sFlags
                        Get Field_Current_Value Of Wtypkin_DDR Field Wtypkin.Wtypkin_Module to sModule

                        Send Clear to Wtypkin_DDW
                        Move sCompany_Code  to Wtypkin.Company_Code
                        Move sBranch_Code   to Wtypkin.Branch_Code
                        Move iYear          to Wtypkin.Year_Year
                        Move sCode          to Wtypkin.Wtypkin_Code
                        Send Find to Wtypkin_DDW Eq 1

                        If (iForce) Begin
                            If (Found) Begin
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Descr  to sDescr
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Anti   to sAnti
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Module to sModule
                                Send Request_Save to Wtypkin_DDW
                            End
                            Else Begin
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Company_Code   to sCompany_Code
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Branch_Code    to sBranch_Code
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Year_Year      to iYear
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Code   to sCode
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Descr  to sDescr
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Anti   to sAnti
                                Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Module to sModule
                                Send Request_Save to Wtypkin_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Company_Code   to sCompany_Code
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Branch_Code    to sBranch_Code
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Year_Year      to iYear
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Code   to sCode
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Descr  to sDescr
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Anti   to sAnti
                            Set Field_Changed_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Module to sModule
                            Send Request_Save to Wtypkin_DDW
                        End

                        Get Field_Current_Value Of Wtypkin_DDW Field Wtypkin.Wtypkin_Recr to sRR3

                        Clear Wflagkin
                        Move sRR    to Wflagkin.Wtypkin_Recr
                        Find Gt Wflagkin By Index.4
                        While ((Found=1) And (sRR=Wflagkin.Wtypkin_Recr))
                            Move Wflagkin.Wflagkin_Flag    to sFlag
                            Move Wflagkin.Wflagkin_Descr   to sDescrFlag
                            Move Wflagkin.Wflagkin_Recr    to sRR2
                            ////////////////////////////////////////////
                            Clear Wflagkin
                            Move sCompany_Code      to Wflagkin.Company_Code
                            Move sBranch_Code       to Wflagkin.Branch_Code
                            Move iYear              to Wflagkin.Year_Year
                            Move sCode              to Wflagkin.Wtypkin_Code
                            Move sFlag              to Wflagkin.Wflagkin_Flag
                            Find Eq Wflagkin By Index.1

                            If (iForce) Begin
                                If (Found) Begin
                                    Clear Wtypkin
                                    Move sRR3 to Wtypkin.Wtypkin_Recr
                                    Find Eq Wtypkin By Index.2
                                    Reread
                                    Move sCompany_Code              To Wflagkin.Company_Code
                                    Move sBranch_Code               To Wflagkin.Branch_Code
                                    Move iYear                      To Wflagkin.Year_Year
                                    Move sCode                      To Wflagkin.Wtypkin_Code
                                    Move sFlag                      To Wflagkin.Wflagkin_flag
                                    Move sDescrFlag                 To Wflagkin.Wflagkin_Descr
                                    Move Wtypkin.Wtypkin_Recr       To Wflagkin.Wtypkin_Recr
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Wflagkin.Wflagkin_Rec0)))))) to Wflagkin.Wflagkin_Recr
                                    Saverecord Wflagkin
                                    Unlock
                                End
                                Else Begin
                                    Clear Wtypkin
                                    Move sRR3 to Wtypkin.Wtypkin_Recr
                                    Find Eq Wtypkin By Index.2
                                    Move sCompany_Code              To Wflagkin.Company_Code
                                    Move sBranch_Code               To Wflagkin.Branch_Code
                                    Move iYear                      To Wflagkin.Year_Year
                                    Move sCode                      To Wflagkin.Wtypkin_Code
                                    Move sFlag                      To Wflagkin.Wflagkin_flag
                                    Move sDescrFlag                 To Wflagkin.Wflagkin_Descr
                                    Move Wtypkin.Wtypkin_Recr       To Wflagkin.Wtypkin_Recr
                                    Move (SYSRECW.Wflagkin_REC0+1)  To Wflagkin.Wflagkin_Rec0
                                    Reread SysrecW
                                    Move (SYSRECW.Wflagkin_REC0+1)  To SysrecW.Wflagkin_Rec0
                                    Saverecord SysrecW
                                    Unlock
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Wflagkin.Wflagkin_Rec0)))))) to Wflagkin.Wflagkin_Recr
                                    Saverecord Wflagkin
                                End
                            End
                            Else If (Not(Found)) Begin
                                Clear Wtypkin
                                Move sRR3 to Wtypkin.Wtypkin_Recr
                                Find Eq Wtypkin By Index.2
                                Move sCompany_Code              To Wflagkin.Company_Code
                                Move sBranch_Code               To Wflagkin.Branch_Code
                                Move iYear                      To Wflagkin.Year_Year
                                Move sCode                      To Wflagkin.Wtypkin_Code
                                Move sFlag                      To Wflagkin.Wflagkin_flag
                                Move sDescrFlag                 To Wflagkin.Wflagkin_Descr
                                Move Wtypkin.Wtypkin_Recr       To Wflagkin.Wtypkin_Recr
                                Move (SYSRECW.Wflagkin_REC0+1)  To Wflagkin.Wflagkin_Rec0
                                Reread SysrecW
                                Move (SYSRECW.Wflagkin_REC0+1)  To SysrecW.Wflagkin_Rec0
                                Saverecord SysrecW
                                Unlock
                                Move (Append('',((Trim(sSite))+;
                                (Trim(String(Wflagkin.Wflagkin_Rec0)))))) to Wflagkin.Wflagkin_Recr
                                Saverecord Wflagkin
                            End
                            ////////////////////////////////////////////
                            Clear Wflagkin
                            Move sRR2 to Wflagkin.Wflagkin_Recr
                            Find eq Wflagkin By Index.2
                            Find Gt Wflagkin By Index.4
                        Loop

                        Send Clear to Wtypkin_DDR
                        Move sRR to Wtypkin.Wtypkin_Recr
                        Send Find to Wtypkin_DDR eq 2

                        Send Find To Wtypkin_DDR Gt 1 //Comp+branch+year+Wtypkin_Code
                    Loop
                End // If (Wtypkin)




                //////////////////
                //  D) Clients
                //////////////////

                // 14/03/2001 js SOS
                // íÄ ÑêÇÄ (CN)  - ÉÑå -   ãÑíÄîÑêéåíÄà
                // é âóÉàâÄë     - ÉÑå -   ÑïÑà îíàÄïíÑà
                // éà CLIENTS éãóë ÑàåÄà éâ

                String sRR5
                If ((iClient) And (SysrecC.Constr_Clients='1')) Begin
                    Send Clear          to Clients_DDR
                    Move SysCompany to Clients.Company_Code
                    Move SysBranch  to Clients.Branch_Code
                    Move SysYear        to Clients.Year_Year
                    Send Find To Clients_DDR Gt 1 //Comp+branch+year+Clients_Code
                    While ((Found=1) And (SysCompany=Clients.Company_Code)   ;
                                     And (SysBranch=Clients.Branch_Code)     ;
                                     And (SysYear=Clients.Year_Year))


                        Set Label Of txtM1 to 'Clients'
                        set label of txtm2 to clients.client_id

                        get field_current_value of clients_ddr field clients.client_id          to scode
                        get field_current_value of clients_ddr field clients.client_recr        to srr
                        get field_current_value of clients_ddr field clients.client_name        to cclient_name
                        get field_current_value of clients_ddr field clients.client_afm         to cclient_afm
                        get field_current_value of clients_ddr field clients.custprom_recr      to ccustprom_recr
                        get field_current_value of clients_ddr field clients.last_xreosh        to clast_xreosh
                        get field_current_value of clients_ddr field clients.last_pistosh       to clast_pistosh
                        get field_current_value of clients_ddr field clients.last_order         to clast_order
                        get field_current_value of clients_ddr field clients.client_doy         to cclient_doy
                        get field_current_value of clients_ddr field clients.client_address     to cclient_address
                        get field_current_value of clients_ddr field clients.client_city_id        to cclient_city
                        get field_current_value of clients_ddr field clients.client_area        to cclient_area
                        get field_current_value of clients_ddr field clients.client_job         to cclient_job
                        get field_current_value of clients_ddr field clients.client_respons     to cclient_respons
                        get field_current_value of clients_ddr field clients.client_zipcode     to cclient_zipcode
                        get field_current_value of clients_ddr field clients.client_phone       to cclient_phone
                        get field_current_value of clients_ddr field clients.client_fax         to cclient_fax
                        get field_current_value of clients_ddr field clients.client_mobile      to cclient_mobile
                        get field_current_value of clients_ddr field clients.client_aoh         to cclient_aoh
                        get field_current_value of clients_ddr field clients.client_email       to cclient_email
                        get field_current_value of clients_ddr field clients.client_class       to cclient_class
                        get field_current_value of clients_ddr field clients.client_details     to cclient_details
                        get field_current_value of clients_ddr field clients.client_sitew       to cclient_sitew
                        get field_current_value of clients_ddr field clients.client_codem       to cclient_codem
                        get field_current_value of clients_ddr field clients.client_categfpa    to cclient_categfpa
                        get field_current_value of clients_ddr field clients.client_fpa         to cclient_fpa
                        get field_current_value of clients_ddr field clients.client_public      to cclient_public
                        get field_current_value of clients_ddr field clients.client_sn          to cclient_sn
                        get field_current_value of clients_ddr field clients.client_repm        to cclient_repm
                        get field_current_value of clients_ddr field clients.client_active      to cclient_active
                        get field_current_value of clients_ddr field clients.client_reported    to cclient_reported
                        get field_current_value of clients_ddr field clients.client_pelprom     to cclient_pelprom
                        get field_current_value of clients_ddr field clients.client_lastupd     to cclient_lastupd
                        get field_current_value of clients_ddr field clients.client_markexp     to cclient_markexp
                        get field_current_value of clients_ddr field clients.client_catjob      to cclient_catjob
                        get field_current_value of clients_ddr field clients.is_promhtheyths    to cis_promhtheyths
                        get field_current_value of clients_ddr field clients.is_client          to cis_pelaths
                        get field_current_value of clients_ddr field clients.xreosh             to cxreosh
                        get field_current_value of clients_ddr field clients.pistosh            to cpistosh
                        get field_current_value of clients_ddr field clients.ypoloipo           to cypoloipo
                        get field_current_value of clients_ddr field clients.plafon             to cplafon
                        get field_current_value of clients_ddr field clients.overhead           to coverhead

                        Send Clear to Clients_DDW
                        move scompany_code  to clients.company_code
                        move sbranch_code   to clients.branch_code
                        move iyear          to clients.year_year
                        move scode          to clients.client_id
                        Send Find to Clients_DDW Eq 1

                        If (iForce) Begin
                            set field_changed_value of clients_ddw field clients.company_code   to scompany_code
                            set field_changed_value of clients_ddw field clients.branch_code    to sbranch_code
                            set field_changed_value of clients_ddw field clients.year_year      to iyear
                            set field_changed_value of clients_ddw field clients.client_id      to scode
                            set field_changed_value of clients_ddw field clients.client_id          to scode
                            set field_changed_value of clients_ddw field clients.client_recr        to srr
                            set field_changed_value of clients_ddw field clients.client_name        to cclient_name
                            set field_changed_value of clients_ddw field clients.client_afm         to cclient_afm
                            set field_changed_value of clients_ddw field clients.custprom_recr      to ccustprom_recr
                            set field_changed_value of clients_ddw field clients.last_xreosh        to clast_xreosh
                            set field_changed_value of clients_ddw field clients.last_pistosh       to clast_pistosh
                            set field_changed_value of clients_ddw field clients.last_order         to clast_order
                            set field_changed_value of clients_ddw field clients.client_doy         to cclient_doy
                            set field_changed_value of clients_ddw field clients.client_address     to cclient_address
                            set field_changed_value of clients_ddw field clients.client_city_id        to cclient_city
                            set field_changed_value of clients_ddw field clients.client_area        to cclient_area
                            set field_changed_value of clients_ddw field clients.client_job         to cclient_job
                            set field_changed_value of clients_ddw field clients.client_respons     to cclient_respons
                            set field_changed_value of clients_ddw field clients.client_zipcode     to cclient_zipcode
                            set field_changed_value of clients_ddw field clients.client_phone       to cclient_phone
                            set field_changed_value of clients_ddw field clients.client_fax         to cclient_fax
                            set field_changed_value of clients_ddw field clients.client_mobile      to cclient_mobile
                            set field_changed_value of clients_ddw field clients.client_aoh         to cclient_aoh
                            set field_changed_value of clients_ddw field clients.client_email       to cclient_email
                            set field_changed_value of clients_ddw field clients.client_class       to cclient_class
                            set field_changed_value of clients_ddw field clients.client_details     to cclient_details
                            set field_changed_value of clients_ddw field clients.client_sitew       to cclient_sitew
                            set field_changed_value of clients_ddw field clients.client_codem       to cclient_codem
                            set field_changed_value of clients_ddw field clients.client_categfpa    to cclient_categfpa
                            set field_changed_value of clients_ddw field clients.client_fpa         to cclient_fpa
                            set field_changed_value of clients_ddw field clients.client_public      to cclient_public
                            set field_changed_value of clients_ddw field clients.client_sn          to cclient_sn
                            set field_changed_value of clients_ddw field clients.client_repm        to cclient_repm
                            set field_changed_value of clients_ddw field clients.client_active      to cclient_active
                            set field_changed_value of clients_ddw field clients.client_reported    to cclient_reported
                            set field_changed_value of clients_ddw field clients.client_pelprom     to cclient_pelprom
                            set field_changed_value of clients_ddw field clients.client_lastupd     to cclient_lastupd
                            set field_changed_value of clients_ddw field clients.client_markexp     to cclient_markexp
                            set field_changed_value of clients_ddw field clients.client_catjob      to cclient_catjob
                            set field_changed_value of clients_ddw field clients.is_promhtheyths    to cis_promhtheyths
                            set field_changed_value of clients_ddw field clients.is_client          to cis_pelaths
                            set field_changed_value of clients_ddw field clients.xreosh             to cxreosh
                            set field_changed_value of clients_ddw field clients.pistosh            to cpistosh
                            set field_changed_value of clients_ddw field clients.ypoloipo           to cypoloipo
                            set field_changed_value of clients_ddw field clients.plafon             to cplafon
                            set field_changed_value of clients_ddw field clients.overhead           to coverhead

                            Send Request_Save to Clients_DDW
                        End
                        Else If (NOT(Found)) Begin
                            set field_changed_value of clients_ddw field clients.company_code   to scompany_code
                            set field_changed_value of clients_ddw field clients.branch_code    to sbranch_code
                            set field_changed_value of clients_ddw field clients.year_year      to iyear
                            set field_changed_value of clients_ddw field clients.client_id      to scode
                            set field_changed_value of clients_ddw field clients.client_id          to scode
                            set field_changed_value of clients_ddw field clients.client_recr        to srr
                            set field_changed_value of clients_ddw field clients.client_name        to cclient_name
                            set field_changed_value of clients_ddw field clients.client_afm         to cclient_afm
                            set field_changed_value of clients_ddw field clients.custprom_recr      to ccustprom_recr
                            set field_changed_value of clients_ddw field clients.last_xreosh        to clast_xreosh
                            set field_changed_value of clients_ddw field clients.last_pistosh       to clast_pistosh
                            set field_changed_value of clients_ddw field clients.last_order         to clast_order
                            set field_changed_value of clients_ddw field clients.client_doy         to cclient_doy
                            set field_changed_value of clients_ddw field clients.client_address     to cclient_address
                            set field_changed_value of clients_ddw field clients.client_city_id        to cclient_city
                            set field_changed_value of clients_ddw field clients.client_area        to cclient_area
                            set field_changed_value of clients_ddw field clients.client_job         to cclient_job
                            set field_changed_value of clients_ddw field clients.client_respons     to cclient_respons
                            set field_changed_value of clients_ddw field clients.client_zipcode     to cclient_zipcode
                            set field_changed_value of clients_ddw field clients.client_phone       to cclient_phone
                            set field_changed_value of clients_ddw field clients.client_fax         to cclient_fax
                            set field_changed_value of clients_ddw field clients.client_mobile      to cclient_mobile
                            set field_changed_value of clients_ddw field clients.client_aoh         to cclient_aoh
                            set field_changed_value of clients_ddw field clients.client_email       to cclient_email
                            set field_changed_value of clients_ddw field clients.client_class       to cclient_class
                            set field_changed_value of clients_ddw field clients.client_details     to cclient_details
                            set field_changed_value of clients_ddw field clients.client_sitew       to cclient_sitew
                            set field_changed_value of clients_ddw field clients.client_codem       to cclient_codem
                            set field_changed_value of clients_ddw field clients.client_categfpa    to cclient_categfpa
                            set field_changed_value of clients_ddw field clients.client_fpa         to cclient_fpa
                            set field_changed_value of clients_ddw field clients.client_public      to cclient_public
                            set field_changed_value of clients_ddw field clients.client_sn          to cclient_sn
                            set field_changed_value of clients_ddw field clients.client_repm        to cclient_repm
                            set field_changed_value of clients_ddw field clients.client_active      to cclient_active
                            set field_changed_value of clients_ddw field clients.client_reported    to cclient_reported
                            set field_changed_value of clients_ddw field clients.client_pelprom     to cclient_pelprom
                            set field_changed_value of clients_ddw field clients.client_lastupd     to cclient_lastupd
                            set field_changed_value of clients_ddw field clients.client_markexp     to cclient_markexp
                            set field_changed_value of clients_ddw field clients.client_catjob      to cclient_catjob
                            set field_changed_value of clients_ddw field clients.is_promhtheyths    to cis_promhtheyths
                            set field_changed_value of clients_ddw field clients.is_client          to cis_pelaths
                            set field_changed_value of clients_ddw field clients.xreosh             to cxreosh
                            set field_changed_value of clients_ddw field clients.pistosh            to cpistosh
                            set field_changed_value of clients_ddw field clients.ypoloipo           to cypoloipo
                            set field_changed_value of clients_ddw field clients.plafon             to cplafon
                            set field_changed_value of clients_ddw field clients.overhead           to coverhead
                            Send Request_Save to Clients_DDW
                        End

                        get field_current_value of clients_ddw field clients.client_id      to srr3
                        get field_current_value of clients_ddw field clients.client_recr    to srr5

        //                            // íÄ ÑêÇÄ áÑäéìå îíàÄçàãé
        //                            // é âóÉàâÄë ÑàåÄà Äèé ÄèäÜ ÄåíàÇêÄîÜ
        //                            // áÑäÑà èêéëÄêãéÇÜ
        //                            Clear CN
        //                            Move sRR3 to CN.Client_ID
        //                            Find Gt CN By Index.4
        //                            While ((Found=1) And (sRR3=CN.Client_ID))

        //                                Move CN.CN_Flag    to sFlag
        //                                Move CN.CN_Descr   to sDescrFlag
        //                                Move CN.CN_Recr    to sRR2
        //                                ////////////////////////////////////////////
        //                                Clear CN
        //                                Move sCompany_Code      to CN.Company_Code
        //                                Move sBranch_Code       to CN.Branch_Code
        //                                Move iYear              to CN.Year_Year
        //                                Move sCode              to CN.Client_ID
        //                                Move sFlag              to CN.CN_Flag
        //                                Find Eq CN By Index.1
        //                                If (iForce) Begin
        //                                    If (Found) Begin
        //                                        Clear Clients
        //                                        move srr5 to clients.client_recr
        //                                        Find Eq Clients By Index.2
        //                                        Reread
        //                                        Move sCompany_Code              To CN.Company_Code
        //                                        Move sBranch_Code               To CN.Branch_Code
        //                                        Move iYear                      To CN.Year_Year
        //                                        Move sCode                      To CN.Clients_Code
        //                                        Move sFlag                      To CN.CN_flag
        //                                        Move sDescrFlag                 To CN.CN_Descr
        //                                        move clients.clients_recr       to cn.clients_recr
        //                                        Move (Append('',((Trim(sSite))+;
        //                                        (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
        //                                        Saverecord CN
        //                                        Unlock
        //                                    End
        //                                    Else Begin
        //                                        Clear Clients
        //                                        move srr5 to clients.client_recr
        //                                        Find Eq Clients By Index.2
        //                                        Move sCompany_Code              To CN.Company_Code
        //                                        Move sBranch_Code               To CN.Branch_Code
        //                                        Move iYear                      To CN.Year_Year
        //                                        Move sCode                      To CN.Clients_Code
        //                                        Move sFlag                      To CN.CN_flag
        //                                        Move sDescrFlag                 To CN.CN_Descr
        //                                        move clients.clients_recr       to cn.clients_recr
        //                                        Move (SYSRECC.CN_REC0+1)  To CN.CN_Rec0
        //                                        Reread Sysrecc
        //                                        Move (SYSRECC.CN_REC0+1)  To Sysrecc.CN_Rec0
        //                                        Saverecord Sysrecc
        //                                        Unlock
        //                                        Move (Append('',((Trim(sSite))+;
        //                                        (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
        //                                        Saverecord CN
        //                                    End
        //                                End
        //                                Else If (Not(Found)) Begin
        //                                    Clear Clients
        //                                    move srr5 to clients.client_recr
        //                                    Find Eq Clients By Index.2
        //                                    Move sCompany_Code              To CN.Company_Code
        //                                    Move sBranch_Code               To CN.Branch_Code
        //                                    Move iYear                      To CN.Year_Year
        //                                    Move sCode                      To CN.Clients_Code
        //                                    Move sFlag                      To CN.CN_flag
        //                                    Move sDescrFlag                 To CN.CN_Descr
        //                                    move clients.clients_recr       to cn.clients_recr
        //                                    Move (SYSRECC.CN_REC0+1)        To CN.CN_Rec0
        //                                    Reread Sysrecc
        //                                    Move (SYSRECC.CN_REC0+1)        To Sysrecc.CN_Rec0
        //                                    Saverecord Sysrecc
        //                                    Unlock
        //                                    Move (Append('',((Trim(sSite))+;
        //                                    (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
        //                                    Saverecord CN
        //                                End
        //                                ////////////////////////////////////////////
        //                                Clear CN
        //                                Move sRR2 to CN.CN_Recr
        //                                Find eq CN By Index.2
        //                                Find Gt CN By Index.4
        //                            Loop

                        Send Clear to Clients_DDR
                        move srr to clients.client_recr
                        Send Find to Clients_DDR eq 2

                        Send Find To Clients_DDR Gt 1 //Comp+branch+year+Clients_Code
                    Loop
                End // If (iClient)


        //                //////////////////
        //                //  E) Baxio
        //                //////////////////
        //                String sCode2

        //                If (iBaxio) Begin
        //                    Send Clear          to Baxio_DDR
        //                    Move sCompany_Code  to Baxio.Company_Code
        //                    Move sBranch_Code   to Baxio.Branch_Code
        //                    Move iLastYear      to Baxio.Year_Year
        //                    Send Find To Baxio_DDR Gt 1 //Comp+branch+year+Baxiokat_Code+Baxio_Code
        //                    While ((Found=1) And (sCompany_Code=Baxio.Company_Code)   ;
        //                                     And (sBranch_Code=Baxio.Branch_Code)     ;
        //                                     And (iLastYear=Baxio.Year_Year))

        //                        Set Label Of txtM1 to 'Baxio'
        //                        Set Label Of txtM2 to Baxio.Baxio_Code

        //                        Get Field_Current_value Of Baxio_DDR Field Baxio.Baxio_Code             to sCode
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.Baxio_Recr             to sRR
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIOKAT_CODE          to dAxioKAT_CODE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIOKAT_RECR          to dAxioKAT_RECR
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_STATUS           to dAxio_STATUS
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_PLACE            to dAxio_PLACE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FILE_IN          to dAxio_FILE_IN
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_CODE_IN          to dAxio_CODE_IN
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EPON_IN          to dAxio_EPON_IN
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FPAR_IN          to dAxio_FPAR_IN
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FILE_OUT         to dAxio_FILE_OUT
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_CODE_OUT         to dAxio_CODE_OUT
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EPON_OUT         to dAxio_EPON_OUT
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_FPAR_OUT         to dAxio_FPAR_OUT
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LFILE            to dAxio_LFILE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LCODE            to dAxio_LCODE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LEPON            to dAxio_LEPON
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LPAR             to dAxio_LPAR
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_BANK00000        to dAxio_BANK00000
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_HMNIAE           to dAxio_HMNIAE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_HMNIAP000        to dAxio_HMNIAP000
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_HMNIAL           to dAxio_HMNIAL
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EKDOTHS          to dAxio_EKDOTHS
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_SDIATAGHE        to dAxio_SDIATAGHE
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_BANKA            to dAxio_BANKA
        //                        //Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_OPISTHO          to dAxio_OPISTHO
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_NO               to dAxio_NO
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_V2               to dAxio_V2
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_V0               to dAxio_V0
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_V00              to dAxio_V00
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_VR               to dAxio_VR
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_RATE0            to dAxio_RATE0
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_RATE00           to dAxio_RATE00
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_RATER            to dAxio_RATER
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_C_CODE2          to dAxio_C_CODE2
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LIXI_YYYY        to dAxio_LIXI_YYYY
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LIXI_MM          to dAxio_LIXI_MM
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_BMOVE_LAA        to dAxio_BMOVE_LAA
        //                        Get Field_Current_Value Of Baxio_DDR Field Baxio.BAXIO_LIXI_DD          to dAxio_LIXI_DD

        //                        Send Clear to Baxio_DDW
        //                        Move sCompany_Code  to Baxio.Company_Code
        //                        Move sBranch_Code   to Baxio.Branch_Code
        //                        Move iYear          to Baxio.Year_Year
        //                        Move sCode          to Baxio.Baxio_Code
        //                        Send Find to Baxio_DDW Eq 1

        //                        If (iForce) Begin
        //                            Send Clear to baxioKat_DDW
        //                            Move dAxioKAT_RECR to BaxioKat.BaxioKat_Recr
        //                            Send Find to Baxiokat_DDW Eq 2
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Company_Code   to sCompany_Code
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Branch_Code    to sBranch_Code
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Year_Year      to iYear
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Baxio_Code   to sCode
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.Baxio_Recr             to sRR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_CODE          to dAxioKAT_CODE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_RECR          to dAxioKAT_RECR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_STATUS           to dAxio_STATUS
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_PLACE            to dAxio_PLACE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_IN          to dAxio_FILE_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_IN          to dAxio_CODE_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_IN          to dAxio_EPON_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_IN          to dAxio_FPAR_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_OUT         to dAxio_FILE_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_OUT         to dAxio_CODE_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_OUT         to dAxio_EPON_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_OUT         to dAxio_FPAR_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LFILE            to dAxio_LFILE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LCODE            to dAxio_LCODE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LEPON            to dAxio_LEPON
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LPAR             to dAxio_LPAR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANK00000        to dAxio_BANK00000
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAE           to dAxio_HMNIAE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAP000        to dAxio_HMNIAP000
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAL           to dAxio_HMNIAL
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHS          to dAxio_EKDOTHS
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_SDIATAGHE        to dAxio_SDIATAGHE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANKA            to dAxio_BANKA
        //                            //Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_OPISTHO          to dAxio_OPISTHO
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_NO               to dAxio_NO
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V2               to dAxio_V2
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V0               to dAxio_V0
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V00              to dAxio_V00
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_VR               to dAxio_VR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE0            to dAxio_RATE0
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE00           to dAxio_RATE00
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATER            to dAxio_RATER
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_C_CODE2          to dAxio_C_CODE2
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_YYYY        to dAxio_LIXI_YYYY
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_MM          to dAxio_LIXI_MM
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BMOVE_LAA        to dAxio_BMOVE_LAA
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_DD          to dAxio_LIXI_DD
        //                            Send Request_Save to Baxio_DDW
        //                        End
        //                        Else If (NOT(Found)) Begin
        //                            Send Clear to baxioKat_DDW
        //                            Move dAxioKAT_RECR to BaxioKat.BaxioKat_Recr
        //                            Send Find to Baxiokat_DDW Eq 2
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Company_Code   to sCompany_Code
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Branch_Code    to sBranch_Code
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Year_Year      to iYear
        //                            Set Field_Changed_Value Of Baxio_DDW Field Baxio.Baxio_Code   to sCode
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.Baxio_Recr             to sRR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_CODE          to dAxioKAT_CODE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIOKAT_RECR          to dAxioKAT_RECR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_STATUS           to dAxio_STATUS
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_PLACE            to dAxio_PLACE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_IN          to dAxio_FILE_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_IN          to dAxio_CODE_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_IN          to dAxio_EPON_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_IN          to dAxio_FPAR_IN
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FILE_OUT         to dAxio_FILE_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_CODE_OUT         to dAxio_CODE_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EPON_OUT         to dAxio_EPON_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_FPAR_OUT         to dAxio_FPAR_OUT
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LFILE            to dAxio_LFILE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LCODE            to dAxio_LCODE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LEPON            to dAxio_LEPON
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LPAR             to dAxio_LPAR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANK00000        to dAxio_BANK00000
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAE           to dAxio_HMNIAE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAP000        to dAxio_HMNIAP000
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_HMNIAL           to dAxio_HMNIAL
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHS          to dAxio_EKDOTHS
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_EKDOTHSE         to dAxio_EKDOTHSE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_SDIATAGHE        to dAxio_SDIATAGHE
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BANKA            to dAxio_BANKA
        //                            //Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_OPISTHO          to dAxio_OPISTHO
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_NO               to dAxio_NO
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V2               to dAxio_V2
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V0               to dAxio_V0
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_V00              to dAxio_V00
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_VR               to dAxio_VR
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE0            to dAxio_RATE0
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATE00           to dAxio_RATE00
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_RATER            to dAxio_RATER
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_C_CODE2          to dAxio_C_CODE2
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_YYYY        to dAxio_LIXI_YYYY
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_MM          to dAxio_LIXI_MM
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_BMOVE_LAA        to dAxio_BMOVE_LAA
        //                            Set Field_Changed_Value of Baxio_DDW Field Baxio.BAXIO_LIXI_DD          to dAxio_LIXI_DD
        //                            Send Request_Save to Baxio_DDW
        //                        End

        //                        Send Clear to Baxio_DDR
        //                        Move sRR to Baxio.Baxio_Recr
        //                        Send Find to Baxio_DDR eq 2

        //                        Send Find To Baxio_DDR Gt 1 //Comp+branch+year+Baxiokat_Code+Baxio_Code
        //                    Loop
        //                End // If (iBaxio)


                //////////////////
                //  F) Wax
                //////////////////
                String sCode2



                If (iWax) Begin
                    Send Clear          to Wax_DDR
                    Move SysCompany to Wax.Company_Code
                    Move SysBranch  to Wax.Branch_Code
                    Move SysYear        to Wax.Year_Year
                    Send Find To Wax_DDR Gt 1 //Comp+branch+year+Wax_Code
                    While ((Found=1) And (SysCompany=Wax.Company_Code)   ;
                                     And (SysBranch=Wax.Branch_Code)     ;
                                     And (SysYear=Wax.Year_Year))

                        Set Label Of txtM1 to 'Wax'
                        Set Label Of txtM2 to Wax.Wax_Code

                        Get Field_Current_value Of Wax_DDR Field Wax.Wax_Code           to sCode
                        Get Field_Current_Value Of Wax_DDR Field Wax.Wax_Recr           to sRR
                        Get Field_Current_Value Of Wax_DDR Field Wax.Wapomast_CODE      to wWAPOMAST_CODE
                        Get Field_Current_Value Of Wax_DDR Field Wax.Wapomast_RECR      to wWapomast_RECR
                        Get Field_Current_Value Of Wax_DDR Field Wax.Wapokat_CODE       to wWAPOKAT_CODE
                        Get Field_Current_Value Of Wax_DDR Field Wax.WAX_DESCR          to wWAX_DESCR

                        Send Clear to Wax_DDW
                        Move sCompany_Code  to Wax.Company_Code
                        Move sBranch_Code   to Wax.Branch_Code
                        Move iYear          to Wax.Year_Year
                        Move wWapokat_Code  to Wax.Wapokat_Code
                        Move wWapomast_Code to Wax.Wapomast_Code

                        //////////////////////////////////////////////////////
                        // 19/03/2001 JSJS âÄíéèàå ëìåÑåéÜëÜë ãÑ íéå íéäÜ
                        // íé èÑÉàé WAX_CODE èÄàêåÑà íàãÜ Äèé íé CURRENT YEAR
                        // Move sCode          to Wax.Wax_Code
                        Move iYear          to Wax.Wax_Code
                        //////////////////////////////////////////////////////

                        Send Find to Wax_DDW Eq 1

                        If (iForce) Begin
                            If (Found) Begin
                                Set Field_Changed_Value Of Wax_DDW Field Wax.WAX_DESCR      to wWAX_DESCR
                                Send Request_Save to Wax_DDW
                            End
                            Else Begin
                                Send Clear to Wapomast_DDW
                                Move wWapomast_RECR to Wapomast.Wapomast_Recr
                                Send Find to Wapomast_DDW Eq 2
                                Set Field_Changed_Value Of Wax_DDW Field Wax.Company_Code   to sCompany_Code
                                Set Field_Changed_Value Of Wax_DDW Field Wax.Branch_Code    to sBranch_Code
                                Set Field_Changed_Value Of Wax_DDW Field Wax.Year_Year      to iYear
                                Set Field_Changed_Value Of Wax_DDW Field Wax.Wapokat_CODE   to wWAPOKAT_CODE
                                Set Field_Changed_Value of Wax_DDW Field Wax.Wapomast_CODE  to wWapomast_Code

                                //////////////////////////////////////////////////////
                                // 19/03/2001 JSJS âÄíéèàå ëìåÑåéÜëÜë ãÑ íéå íéäÜ
                                // íé èÑÉàé WAX_CODE èÄàêåÑà íàãÜ Äèé íé CURRENT YEAR
                                //Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to sCode
                                Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to iYear
                                //////////////////////////////////////////////////////

                                Set Field_Changed_Value of Wax_DDW Field Wax.Wax_Recr       to sRR
                                Set Field_Changed_Value Of Wax_DDW Field Wax.WAX_DESCR      to wWAX_DESCR
                                Send Request_Save to Wax_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin
                            Send Clear to Wapomast_DDW
                            Move wWapomast_RECR to Wapomast.Wapomast_Recr
                            Send Find to Wapomast_DDW Eq 2
                            Set Field_Changed_Value Of Wax_DDW Field Wax.Company_Code   to sCompany_Code
                            Set Field_Changed_Value Of Wax_DDW Field Wax.Branch_Code    to sBranch_Code
                            Set Field_Changed_Value Of Wax_DDW Field Wax.Year_Year      to iYear
                            Set Field_Changed_Value Of Wax_DDW Field Wax.Wapokat_CODE   to wWAPOKAT_CODE
                            Set Field_Changed_Value of Wax_DDW Field Wax.Wapomast_CODE  to wWapomast_Code
                            //////////////////////////////////////////////////////
                            // 19/03/2001 JSJS âÄíéèàå ëìåÑåéÜëÜë ãÑ íéå íéäÜ
                            // íé èÑÉàé WAX_CODE èÄàêåÑà íàãÜ Äèé íé CURRENT YEAR
                            //Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to sCode
                            Set Field_Changed_Value Of Wax_DDW Field Wax.Wax_Code       to iYear
                            //////////////////////////////////////////////////////
                            Set Field_Changed_Value of Wax_DDW Field Wax.Wax_Recr       to sRR
                            Set Field_Changed_Value Of Wax_DDW Field Wax.WAX_DESCR      to wWAX_DESCR
                            Send Request_Save to Wax_DDW
                        End

                        Send Clear to Wax_DDR
                        Move sRR to Wax.Wax_Recr
                        Send Find to Wax_DDR eq 2

                        Send Find To Wax_DDR Gt 1 //Comp+branch+year+Wapokat_Code+Wapomast_Code+Wax_Code
                    Loop
                End // If (iWax)





                //////////////////
                //  G) Witemx
                //////////////////

                Integer iRec0 iRec01

                If (iWitemx) Begin


                    Send Clear          to Witemx_DDR
                    Move SysCompany to Witemx.Company_Code
                    Move SysBranch  to Witemx.Branch_Code
                    Move SysYear        to Witemx.Year_Year
                    Send Find To Witemx_DDR Gt 1 //Comp+branch+year+Witemx_Code
                    While ((Found=1) And (SysCompany=Witemx.Company_Code)   ;
                                     And (SysBranch=Witemx.Branch_Code)     ;
                                     And (SysYear=Witemx.Year_Year))

                        Set Label Of txtM1 to 'Witemx'
                        Set Label Of txtM2 to Witemx.Witemx_Code

                        Get Field_Current_value Of Witemx_DDR Field Witemx.Witemx_Code      to sCode
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.Witemx_Recr      to sRR
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.Witemx_Rec0      to iRec0
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.UNITS_CODE       to zUNITS_CODE
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMKAT_CODE    to zWITEMKAT_CODE
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_CODE        to zITEM_CODE
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMX_RECR      to zWITEMX_RECR
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_RECR        to zITEM_RECR
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.WITEMX_YEARDESC  to zWITEMX_YEARDESC
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
                        Get Field_Current_Value Of Witemx_DDR Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD

                        Send Clear to Witemx_DDW
                        Move sCompany_Code  to Witemx.Company_Code
                        Move sBranch_Code   to Witemx.Branch_Code
                        Move iYear          to Witemx.Year_Year
                        Move zUnits_Code    to Witemx.Units_Code
                        Move zWITEMKAT_CODE to Witemx.Witemkat_Code
                        Move zITEM_CODE     to Witemx.Item_Code
                        Move sCode          to Witemx.Witemx_Code

                        Send Find to Witemx_DDW Eq 1

                        If (iForce) Begin
                            If (Found) Begin
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_YEARDESC  to iYear
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
                                Send Request_Save to Witemx_DDW
                            End
                            Else Begin
                                Send Clear to Item_DDW
                                Move zItem_Code to Item.Item_Code
                                Send Find To Item_DDW eq 5
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.Company_Code     to sCompany_Code
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.Branch_Code      to sBranch_Code
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.Year_Year        to iYear
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.UNITS_CODE       to zUNITS_CODE
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMKAT_CODE    to zWITEMKAT_CODE
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_CODE        to zItem_Code
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.Witemx_Code      to sCode
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_YEARDESC  to iYear
                                Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
                                Send Request_Save to Witemx_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin
                            Send Clear to Item_DDW
                            Move zItem_Code to Item.Item_Code
                            Send Find To Item_DDW eq 5
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Company_Code     to sCompany_Code
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Branch_Code      to sBranch_Code
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Year_Year        to iYear
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.UNITS_CODE       to zUNITS_CODE
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMKAT_CODE    to zWITEMKAT_CODE
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_CODE        to zItem_Code
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.Witemx_Code      to sCode
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_DESCR     to zWITEMX_DESCR
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.WITEMX_YEARDESC  to iYear
                            Set Field_Changed_Value Of Witemx_DDW Field Witemx.ITEM_APOKAT_COD  to zITEM_APOKAT_COD
                            Send Request_Save to Witemx_DDW
                        End

                        Get Field_Current_Value Of Witemx_DDW Field Witemx.Witemx_Recr to sRR3

                        Clear Witemxt
                        Move sRR    to Witemxt.Witemx_Recr
                        Find Gt Witemxt By Index.4
                        While ((Found=1) And (sRR=Witemxt.Witemx_Recr))
                            Move Witemxt.Witemxt_Rec0   to iRec01
                            Move Witemxt.AXIA           to zAXIA
                            Move Witemxt.AXIA0          to zAXIA0
                            Move Witemxt.AXIA00         to zAXIA00
                            Move Witemxt.AXIAR          to zAXIAR
                            Move Witemxt.VALUE_DATE     to zVALUE_DATE

                            ////////////////////////////////////////////
                            Clear Witemxt
                            Move sCompany_Code      to Witemxt.Company_Code
                            Move sBranch_Code       to Witemxt.Branch_Code
                            Move iYear              to Witemxt.Year_Year
                            Move sRR3               to Witemxt.Witemx_Recr
                            Move zValue_Date        to Witemxt.Value_Date

                            Find Eq Witemxt By Index.1

                            If (iForce) Begin
                                If (Found) Begin
                                    Clear Witemx
                                    Move sRR3 to Witemx.Witemx_Recr
                                    Find Eq Witemx By Index.2
                                    Reread
                                    Move Witemx.Witemx_Recr To Witemxt.Witemx_Recr
                                    Move zAxia              to Witemxt.Axia
                                    Move zAxia0             to Witemxt.Axia0
                                    Move zAxia00            to Witemxt.Axia00
                                    Move zAxiaR             to Witemxt.AxiaR
                                    Saverecord Witemxt
                                    Unlock
                                End
                                Else Begin
                                    Clear Witemx
                                    Move sRR3 to Witemx.Witemx_Recr
                                    Find Eq Witemx By Index.2
                                    Move sCompany_Code              To Witemxt.Company_Code
                                    Move sBranch_Code               To Witemxt.Branch_Code
                                    Move iYear                      To Witemxt.Year_Year
                                    Move Witemx.Witemx_Recr         To Witemxt.Witemx_Recr
                                    Move zAxia                      to Witemxt.Axia
                                    Move zAxia0                     to Witemxt.Axia0
                                    Move zAxia00                    to Witemxt.Axia00
                                    Move zAxiaR                     to Witemxt.AxiaR
                                    Move (SYSRECW.Witemxt_REC0+1)  To Witemxt.Witemxt_Rec0
                                    Reread SysrecW
                                    Move (SYSRECW.Witemxt_REC0+1)  To SysrecW.Witemxt_Rec0
                                    Saverecord SysrecW
                                    Unlock
                                    Saverecord Witemxt
                                End
                            End
                            Else If (Not(Found)) Begin
                                Clear Witemx
                                Move sRR3 to Witemx.Witemx_Recr
                                Find Eq Witemx By Index.2
                                Move sCompany_Code              To Witemxt.Company_Code
                                Move sBranch_Code               To Witemxt.Branch_Code
                                Move iYear                      To Witemxt.Year_Year
                                Move Witemx.Witemx_Recr         To Witemxt.Witemx_Recr
                                Move zAxia                      to Witemxt.Axia
                                Move zAxia0                     to Witemxt.Axia0
                                Move zAxia00                    to Witemxt.Axia00
                                Move zAxiaR                     to Witemxt.AxiaR
                                Move (SYSRECW.Witemxt_REC0+1)  To Witemxt.Witemxt_Rec0
                                Reread SysrecW
                                Move (SYSRECW.Witemxt_REC0+1)  To SysrecW.Witemxt_Rec0
                                Saverecord SysrecW
                                Unlock
                                Saverecord Witemxt
                            End
                            ////////////////////////////////////////////
                            Clear Witemxt
                            Move iRec01 to Witemxt.Witemxt_Rec0
                            Find eq Witemxt By Index.2
                            Find Gt Witemxt By Index.4
                        Loop

                        Send Clear to Witemx_DDR
                        Move sRR to Witemx.Witemx_Recr
                        Send Find to Witemx_DDR eq 2

                        Send Find To Witemx_DDR Gt 1 //Comp+branch+year+Witemx_Code
                    Loop
                End // If (Witemx)





                //////////////////
                //  H) Ptyppar
                //////////////////
                If (iPtyppar) Begin
                    Send Clear          to Ptyppar_DDR
                    Move SysCompany to Ptyppar.Company_Code
                    Move SysBranch  to Ptyppar.Branch_Code
                    Move SysYear        to Ptyppar.Year_Year
                    Send Find To Ptyppar_DDR Gt 7 //Comp+branch+year+Wtypkin_Code+Ctypkin_Code+Ptyppar_Code
                    While ((Found=1) And (SysCompany=Ptyppar.Company_Code)   ;
                                     And (SysBranch=Ptyppar.Branch_Code)     ;
                                     And (SysYear=Ptyppar.Year_Year))


                        Set Label Of txtM1 to 'Ptyppar'
                        Set Label Of txtM2 to Ptyppar.Ptyppar_Code

                        Get Field_Current_value Of Ptyppar_DDR Field Ptyppar.Ptyppar_Code       to sCode
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.Ptyppar_Recr       to sRR
                        Get Field_Current_value Of Ptyppar_DDR Field Ptyppar.CTYPKIN_CODE       to tCTYPKIN_CODE
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.WTYPKIN_CODE       to tWTYPKIN_CODE
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.CTYPKIN_RECR       to tCTYPKIN_RECR
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.WTYPKIN_RECR       to tWTYPKIN_RECR
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_DESCR      to tPTYPPAR_DESCR
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_IS_WHAT    to tPTYPPAR_IS_WHAT
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_MODULE     to tPTYPPAR_MODULE
                        Get Field_Current_Value Of Ptyppar_DDR Field Ptyppar.PTYPPAR_ABREV      to tPTYPPAR_ABREV


                        Send Clear to Ptyppar_DDW
                        Move sCompany_Code  to Ptyppar.Company_Code
                        Move sBranch_Code   to Ptyppar.Branch_Code
                        Move iYear          to Ptyppar.Year_Year
                        Move tCtypkin_Code  to Ptyppar.Ctypkin_Code
                        Move tWtypkin_Code  to Ptyppar.Wtypkin_Code
                        Move sCode          to Ptyppar.Ptyppar_Code
                        Send Find to Ptyppar_DDW Eq 7

                        If (iForce) Begin
                            If (Found) Begin
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_DESCR    to tPTYPPAR_DESCR
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_IS_WHAT  to tPTYPPAR_IS_WHAT
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_MODULE   to tPTYPPAR_MODULE
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_ABREV    to tPTYPPAR_ABREV
                                Send Request_Save to Ptyppar_DDW
                            End
                            Else Begin
                                Send Clear to Ctypkin_DDW
        //                            Move tCtypkin_RECR to Ctypkin.Ctypkin_Recr
        //                            Send Find to Ctypkin_DDW Eq 2

                                Move sCompany_Code  to Ctypkin.Company_Code
                                Move sBranch_Code   to Ctypkin.Branch_Code
                                Move iYear          to Ctypkin.Year_Year
                                Move tCTYPKIN_CODE  to Ctypkin.Ctypkin_Code
                                Send Find to Ctypkin_DDW Eq 1

                                Send Clear to Wtypkin_DDW
        //                            Move tWtypkin_RECR to Wtypkin.Wtypkin_Recr
        //                            Send Find to Wtypkin_DDW Eq 2
                                Move sCompany_Code  to Wtypkin.Company_Code
                                Move sBranch_Code   to Wtypkin.Branch_Code
                                Move iYear          to Wtypkin.Year_Year
                                Move tWtypkin_CODE  to Wtypkin.Wtypkin_Code
                                Send Find to Wtypkin_DDW Eq 1

                                Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Company_Code     to sCompany_Code
                                Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Branch_Code      to sBranch_Code
                                Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Year_Year        to iYear
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.CTYPKIN_CODE     to tCTYPKIN_CODE
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.WTYPKIN_CODE     to tWTYPKIN_CODE
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_CODE     to sCODE
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.YEAR_RECR        to sYearRecr
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_DESCR    to tPTYPPAR_DESCR
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_IS_WHAT  to tPTYPPAR_IS_WHAT
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_MODULE   to tPTYPPAR_MODULE
                                Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_ABREV    to tPTYPPAR_ABREV
                                Send Request_Save to Ptyppar_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin

                            Send Clear to Ctypkin_DDW
        //                            Move tCtypkin_RECR to Ctypkin.Ctypkin_Recr
        //                            Send Find to Ctypkin_DDW Eq 2

                            Move sCompany_Code  to Ctypkin.Company_Code
                            Move sBranch_Code   to Ctypkin.Branch_Code
                            Move iYear          to Ctypkin.Year_Year
                            Move tCTYPKIN_CODE  to Ctypkin.Ctypkin_Code
                            Send Find to Ctypkin_DDW Eq 1

                            Send Clear to Wtypkin_DDW
        //                            Move tWtypkin_RECR to Wtypkin.Wtypkin_Recr
        //                            Send Find to Wtypkin_DDW Eq 2
                            Move sCompany_Code  to Wtypkin.Company_Code
                            Move sBranch_Code   to Wtypkin.Branch_Code
                            Move iYear          to Wtypkin.Year_Year
                            Move tWtypkin_CODE  to Wtypkin.Wtypkin_Code
                            Send Find to Wtypkin_DDW Eq 1


                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Company_Code     to sCompany_Code
                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Branch_Code      to sBranch_Code
                            Set Field_Changed_Value Of Ptyppar_DDW Field Ptyppar.Year_Year        to iYear
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.CTYPKIN_CODE     to tCTYPKIN_CODE
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.WTYPKIN_CODE     to tWTYPKIN_CODE
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_CODE     to sCODE
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.YEAR_RECR        to sYearRecr
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_DESCR    to tPTYPPAR_DESCR
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_IS_WHAT  to tPTYPPAR_IS_WHAT
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_MODULE   to tPTYPPAR_MODULE
                            Set Field_Changed_Value of Ptyppar_DDW Field Ptyppar.PTYPPAR_ABREV    to tPTYPPAR_ABREV
                            Send Request_Save to Ptyppar_DDW
                        End

                        Get Field_Current_Value Of Ptyppar_DDW Field Ptyppar.Ptyppar_Recr to sRR3

                        Clear Pseira
                        Move sRR to Pseira.Ptyppar_Recr
                        Find Gt Pseira By Index.3
                        While ((Found=1) And (sRR=Pseira.Ptyppar_Recr))

                            Move Pseira.Pseira_Recr    to sRR2
                            Move Pseira.PSEIRA_SEIRA   to   tPSEIRA_SEIRA
                            Move Pseira.PSEIRA_REC0    to   tPSEIRA_REC0
                            Move Pseira.PSEIRA_PRINTER to   tPSEIRA_PRINTER
                            Move Pseira.PSEIRA_FORM    to   tPSEIRA_FORM
                            Move Pseira.PSEIRA_AUTONUM to   tPSEIRA_AUTONUM
                            Move Pseira.AUTONUM_PLUS   to   tAUTONUM_PLUS
                            Move Pseira.AUTONUM_MINUS  to   tAUTONUM_MINUS
                            ////////////////////////////////////////////
                            Clear Pseira
                            Move sCompany_Code      to Pseira.Company_Code
                            Move sBranch_Code       to Pseira.Branch_Code
                            //Move iYear              to Pseira.Year_Year
                            Move sCode              to Pseira.Ptyppar_Code
                            Move tpSeira_Seira      to Pseira.Pseira_Seira
                            Find Eq Pseira By Index.1
                            If (iForce) Begin
                                If (Found) Begin
                                    Clear Ptyppar
                                    Move sRR3 to Ptyppar.Ptyppar_Recr
                                    Find Eq Ptyppar By Index.2
                                    Reread
                                    Move tWTYPKIN_CODE              to Pseira.WTYPKIN_CODE
                                    Move tCtypkin_CODE              to Pseira.Ctypkin_CODE
                                    Move tPSEIRA_PRINTER            to Pseira.PSEIRA_PRINTER
                                    Move tPSEIRA_FORM               to Pseira.PSEIRA_FORM
                                    Move tPSEIRA_AUTONUM            to Pseira.PSEIRA_AUTONUM
                                    Move tAUTONUM_PLUS              to Pseira.AUTONUM_PLUS
                                    Move tAUTONUM_MINUS             to Pseira.AUTONUM_MINUS
                                    Move Ptyppar.Ptyppar_Recr       To Pseira.Ptyppar_Recr
                                    Saverecord Pseira
                                    Unlock
                                End
                                Else Begin
                                    Clear Ptyppar
                                    Move sRR3 to Ptyppar.Ptyppar_Recr
                                    Find Eq Ptyppar By Index.2
                                    Move sCompany_Code              To Pseira.Company_Code
                                    Move sBranch_Code               To Pseira.Branch_Code
                                    //Move iYear                      To Pseira.Year_Year
                                    Move sCode                      To Pseira.Ptyppar_Code
                                    Move tPSEIRA_SEIRA              to Pseira.PSEIRA_SEIRA
                                    Move tPSEIRA_PRINTER            to Pseira.PSEIRA_PRINTER
                                    Move tPSEIRA_FORM               to Pseira.PSEIRA_FORM
                                    Move tPSEIRA_AUTONUM            to Pseira.PSEIRA_AUTONUM
                                    Move tAUTONUM_PLUS              to Pseira.AUTONUM_PLUS
                                    Move tAUTONUM_MINUS             to Pseira.AUTONUM_MINUS
                                    Move tWTYPKIN_CODE              to Pseira.WTYPKIN_CODE
                                    Move tCtypkin_CODE              to Pseira.Ctypkin_CODE
                                    Move Ptyppar.Ptyppar_Recr       To Pseira.Ptyppar_Recr
                                    Move (SYSRECP.Pseira_REC0+1)    To Pseira.Pseira_Rec0
                                    Reread SysrecP
                                    Move (SYSRECP.Pseira_REC0+1)    To SysrecP.Pseira_Rec0
                                    Saverecord SysrecP
                                    Unlock
                                    Move (Append('',((Trim(sSite))+;
                                    (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
                                    Saverecord Pseira
                                End
                            End
                            Else If (Not(Found)) Begin
                                Clear Ptyppar
                                Move sRR3 to Ptyppar.Ptyppar_Recr
                                Find Eq Ptyppar By Index.2
                                Move sCompany_Code              To Pseira.Company_Code
                                Move sBranch_Code               To Pseira.Branch_Code
                                Move iYear                      To Pseira.Year_Year
                                Move sCode                      To Pseira.Ptyppar_Code
                                Move tPSEIRA_SEIRA              to Pseira.PSEIRA_SEIRA
                                Move tPSEIRA_PRINTER            to Pseira.PSEIRA_PRINTER
                                Move tPSEIRA_FORM               to Pseira.PSEIRA_FORM
                                Move tPSEIRA_AUTONUM            to Pseira.PSEIRA_AUTONUM
                                Move tAUTONUM_PLUS              to Pseira.AUTONUM_PLUS
                                Move tAUTONUM_MINUS             to Pseira.AUTONUM_MINUS
                                Move tWTYPKIN_CODE              to Pseira.WTYPKIN_CODE
                                Move tCtypkin_CODE              to Pseira.Ctypkin_CODE
                                Move Ptyppar.Ptyppar_Recr       To Pseira.Ptyppar_Recr
                                Move (SYSRECP.Pseira_REC0+1)    To Pseira.Pseira_Rec0
                                Reread SysrecP
                                Move (SYSRECP.Pseira_REC0+1)    To SysrecP.Pseira_Rec0
                                Saverecord SysrecP
                                Unlock
                                Move (Append('',((Trim(sSite))+;
                                (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
                                Saverecord Pseira
                            End
                            ////////////////////////////////////////////
                            Clear Pseira
                            Move sRR2 to Pseira.Pseira_Recr
                            Find eq Pseira By Index.2
                            Find Gt Pseira By Index.3
                        Loop

        //                Send Clear to Ptyppar_DDR
        //                Move sRR to Ptyppar.Ptyppar_Recr
        //                Send Find to Ptyppar_DDR eq 2
                        Send Clear to Ptyppar_DDR
                 //  georg £ú´ò≠‚®ú† £Ê§¶ ´¶ ß®È´¶ ptyppar °ò† ôöòÂ§ú† loop 17/10/01
                 //       Move sCompany_Code  to Ptyppar.Company_Code
                 //       Move sBranch_Code   to Ptyppar.Branch_Code
                 //       Move iLastYear      to Ptyppar.Year_Year
                        Move SysCompany to Ptyppar.Company_Code
                        Move SysBranch  to Ptyppar.Branch_Code
                        Move SysYear        to Ptyppar.Year_Year
                        Move tWtypkin_Code  to Ptyppar.Wtypkin_Code
                        Move tCtypkin_Code  to Ptyppar.Ctypkin_Code
                        Move sCode          to Ptyppar.Ptyppar_Code
                        Send Find to Ptyppar_DDR Eq 7

                        Send Find To Ptyppar_DDR Gt 7 //Comp+branch+year+Wtypkin_Code+Ctypkin_Code+Ptyppar_Code
                    Loop
                End // If (iPtyppar)



                //////////////////
                //  I) HmCtyp
                //////////////////
                If (iHmCtyp) Begin
                    Integer iirec
                    Send Clear          to HmCtyp_DDR
                    Move SysCompany to HmCtyp.Company_Code
                    Move SysBranch  to HmCtyp.Branch_Code
                    Move SysYear        to HmCtyp.Year_Year
                    Send Find To HmCtyp_DDR Gt 3  //Comp+branch+year+Ctypkin_Code+Hmgio_Code
                    While ((Found=1) And (SysCompany=HmCtyp.Company_Code)   ;
                                     And (SysBranch=HmCtyp.Branch_Code)     ;
                                     And (SysYear=HmCtyp.Year_Year))

                        Set Label Of txtM1 to 'HmCtyp'
                        Set Label Of txtM2 to HmCtyp.Ctypkin_Code

                        Get Field_Current_value Of HmCtyp_DDR Field HmCtyp.HMGIO_CODE   to uHMGIO_CODE
                        Get Field_Current_Value Of HmCtyp_DDR Field HmCtyp.CTYPKIN_CODE to uCTYPKIN_CODE
                        Get Field_Current_Value Of HmCtyp_DDR Field HmCtyp.recnum       to iiRec

                        Clear HmCtyp
                        Move sCompany_Code  to HmCtyp.Company_Code
                        Move sBranch_Code   to HmCtyp.Branch_Code
                        Move iYear          to HmCtyp.Year_Year
                        Move uCtypkin_Code  to HmCtyp.Ctypkin_Code
                        Move uHmgio_Code    to HmCtyp.Hmgio_Code
                        Find Eq HmCtyp By Index.3
                        If (Found) Begin
                            Send Find_By_Recnum To HmCtyp_DDW HmCtyp.File_Number HmCtyp.Recnum
                        End
                        Else Send Clear to HmCtyp_DDW

        //                        Send Clear to HmCtyp_DDW
        //                        Move sCompany_Code  to HmCtyp.Company_Code
        //                        Move sBranch_Code   to HmCtyp.Branch_Code
        //                        Move iYear          to HmCtyp.Year_Year
        //                        Move uCtypkin_Code  to HmCtyp.Ctypkin_Code
        //                        Move uHmgio_Code    to HmCtyp.Hmgio_Code
        //                        Send Find to HmCtyp_DDW Eq 3 //Comp+branch+year+Ctypkin_Code+Hmgio_Code

                        If (iForce) Begin
                            If (Found) Begin
                                //Send Request_Save to HmCtyp_DDW
                            End
                            Else Begin

                                Send Clear to Ctypkin_DDW
                                Move sCompany_Code  to Ctypkin.Company_Code
                                Move sBranch_Code   to Ctypkin.Branch_Code
                                Move iYear          to Ctypkin.Year_Year
                                Move uCTYPKIN_CODE  to Ctypkin.Ctypkin_Code
                                Send Find to Ctypkin_DDW Eq 1

                                Send Clear to Hmgio_DDW
                                Move uHmgio_CODE  to Hmgio.Hmgio_Code
                                Send Find to Hmgio_DDW Eq 1

                                Set Field_Changed_Value Of HmCtyp_DDW Field HmCtyp.Company_Code     to sCompany_Code
                                Set Field_Changed_Value Of HmCtyp_DDW Field HmCtyp.Branch_Code      to sBranch_Code
                                Set Field_Changed_Value Of HmCtyp_DDW Field HmCtyp.Year_Year        to iYear
                                //Set Field_Changed_Value of HmCtyp_DDW Field HmCtyp.CTYPKIN_CODE     to uCTYPKIN_CODE
                                //Set Field_Changed_Value of HmCtyp_DDW Field HmCtyp.Hmgio_CODE       to uHmgio_CODE
                                Send Request_Save to HmCtyp_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin
                            Send Clear to Ctypkin_DDW
                            Move sCompany_Code  to Ctypkin.Company_Code
                            Move sBranch_Code   to Ctypkin.Branch_Code
                            Move iYear          to Ctypkin.Year_Year
                            Move uCTYPKIN_CODE  to Ctypkin.Ctypkin_Code
                            Send Find to Ctypkin_DDW Eq 1

                            Send Clear to Hmgio_DDW
                            Move uHmgio_CODE  to Hmgio.Hmgio_Code
                            Send Find to Hmgio_DDW Eq 1

                            Set Field_Changed_Value Of HmCtyp_DDW Field HmCtyp.Company_Code     to sCompany_Code
                            Set Field_Changed_Value Of HmCtyp_DDW Field HmCtyp.Branch_Code      to sBranch_Code
                            Set Field_Changed_Value Of HmCtyp_DDW Field HmCtyp.Year_Year        to iYear
                            //Set Field_Changed_Value of HmCtyp_DDW Field HmCtyp.CTYPKIN_CODE     to uCTYPKIN_CODE

                            Send Request_Save to HmCtyp_DDW
                        End

                        Send Find_By_Recnum To HmCtyp_DDR HmCtyp.File_Number iiRec

                        Send Find To HmCtyp_DDR Gt 3 //Comp+branch+year+Ctypkin_Code+Hmgio_Code
                    Loop
                End // If (iHmCtyp)



                //////////////////
                //  J) HmWtyp
                //////////////////
                If (iHmWtyp) Begin
                    Send Clear          to HmWtyp_DDR

                    Move SysCompany to HmWtyp.Company_Code
                    Move SysBranch  to HmWtyp.Branch_Code
                    Move SysYear        to HmWtyp.Year_Year
                    Send Find To HmWtyp_DDR Gt 3  //Comp+branch+year+Ctypkin_Code+Hmgio_Code
                    While ((Found=1) And (SysCompany=HmWtyp.Company_Code)   ;
                                     And (SysBranch=HmWtyp.Branch_Code)     ;
                                     And (SysYear=HmWtyp.Year_Year))


                        Set Label Of txtM1 to 'HmWtyp'
                        Set Label Of txtM2 to HmWtyp.Wtypkin_Code

                        Get Field_Current_value Of HmWtyp_DDR Field HmWtyp.HmgioW_CODE  to uHmgio_Code
                        Get Field_Current_Value Of HmWtyp_DDR Field HmWtyp.Wtypkin_CODE to uWtypkin_CODE
                        Get Field_Current_Value Of HmWtyp_DDR Field HmWtyp.recnum       to iiRec


                        Clear HmWtyp
                        Move sCompany_Code  to HmWtyp.Company_Code
                        Move sBranch_Code   to HmWtyp.Branch_Code
                        Move iYear          to HmWtyp.Year_Year
                        Move uWtypkin_Code  to HmWtyp.Wtypkin_Code
                        Move uHmgio_Code    to HmWtyp.HmgioW_Code
                        Find Eq HmWtyp By Index.3 //Comp+branch+year+Wtypkin_Code+HmgioW_Code
                        If (Found=1) Begin
                            Send Find_By_Recnum To HmWtyp_DDW HmWtyp.File_Number HmWtyp.Recnum
                        End
                        Else Send Clear to HmWtyp_DDW

        //                        Send Clear to HmWtyp_DDW
        //                        Move sCompany_Code  to HmWtyp.Company_Code
        //                        Move sBranch_Code   to HmWtyp.Branch_Code
        //                        Move iYear          to HmWtyp.Year_Year
        //                        Move uWtypkin_Code  to HmWtyp.Wtypkin_Code
        //                        Move uHmgio_Code    to HmWtyp.HmgioW_Code
        //                        Send Request_Find   to HmWtyp_DDW Eq HmWtyp.File_Number 3

                        If (iForce) Begin
                            If (Found) Begin
                                //Send Request_Save to HmWtyp_DDW
                            End
                            Else Begin

                                Send Clear to Wtypkin_DDW
                                Move sCompany_Code  to Wtypkin.Company_Code
                                Move sBranch_Code   to Wtypkin.Branch_Code
                                Move iYear          to Wtypkin.Year_Year
                                Move uWtypkin_CODE  to Wtypkin.Wtypkin_Code
                                Send Find to Wtypkin_DDW Eq 1

                                Send Clear to HmgioW_DDW
                                Move uHmgio_Code  to HmgioW.HmgioW_Code
                                Send Find to HmgioW_DDW Eq 1

                                Set Field_Changed_Value Of HmWtyp_DDW Field HmWtyp.Company_Code     to sCompany_Code
                                Set Field_Changed_Value Of HmWtyp_DDW Field HmWtyp.Branch_Code      to sBranch_Code
                                Set Field_Changed_Value Of HmWtyp_DDW Field HmWtyp.Year_Year        to iYear
                                //Set Field_Changed_Value of HmWtyp_DDW Field HmWtyp.Wtypkin_CODE     to uWtypkin_CODE
                                //Set Field_Changed_Value of HmWtyp_DDW Field HmWtyp.HmgioW_CODE       to uHmgio_Code
                                Send Request_Save to HmWtyp_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin

                            Send Clear to Wtypkin_DDW
                            Move sCompany_Code  to Wtypkin.Company_Code
                            Move sBranch_Code   to Wtypkin.Branch_Code
                            Move iYear          to Wtypkin.Year_Year
                            Move uWtypkin_CODE  to Wtypkin.Wtypkin_Code
                            Send Find to Wtypkin_DDW Eq 1

                            Send Clear to HmgioW_DDW
                            Move uHmgio_Code  to HmgioW.HmgioW_Code
                            Send Find to HmgioW_DDW Eq 1

                            Set Field_Changed_Value Of HmWtyp_DDW Field HmWtyp.Company_Code     to sCompany_Code
                            Set Field_Changed_Value Of HmWtyp_DDW Field HmWtyp.Branch_Code      to sBranch_Code
                            Set Field_Changed_Value Of HmWtyp_DDW Field HmWtyp.Year_Year        to iYear
                            //Set Field_Changed_Value of HmWtyp_DDW Field HmWtyp.Wtypkin_CODE     to uWtypkin_CODE
                            Send Request_Save to HmWtyp_DDW
                        End

                        Send Find_By_Recnum To HmWtyp_DDR HmWtyp.File_Number iiRec
        //                        Send Clear to HmWtyp_DDR
        //                        Move sCompany_Code  to HmWtyp.Company_Code
        //                        Move sBranch_Code   to HmWtyp.Branch_Code
        //                        Move iLastYear      to HmWtyp.Year_Year
        //                        Move uWtypkin_Code  to HmWtyp.Wtypkin_Code
        //                        Move uHmgio_Code    to HmWtyp.HmgioW_Code
        //                        Send Find to HmWtyp_DDR Eq 3

                        Send Find To HmWtyp_DDR Gt 3 //Comp+branch+year+Wtypkin_Code+HmgioW_Code
                    Loop
                End // If (iHmWtyp)






                //////////////////
                //  K) Bkinkat
                //////////////////
                If (iBkinkat) Begin
                    //Integer iirec
                    String uBtypkin_Code uBaxiokat_Code

                    Send Clear          to Btypkin_DDR
                    Send Clear          to Baxiokat_DDR
                    Send Clear          to Bkinkat_DDR

                    Send Clear          to Btypkin_DDW
                    Send Clear          to Baxiokat_DDW
                    Send Clear          to Bkinkat_DDW

                    Move SysCompany to Bkinkat.Company_Code
                    Move SysBranch  to Bkinkat.Branch_Code
                    Move SysYear        to Bkinkat.Year_Year
                    Send Find To Bkinkat_DDR Gt 1 //Comp+branch+year+Btypkin_Code+Baxiokat_Code
                    While ((Found=1) And (SysCompany=Bkinkat.Company_Code)   ;
                                     And (SysBranch=Bkinkat.Branch_Code)     ;
                                     And (SysYear=Bkinkat.Year_Year))

                        Set Label Of txtM1 to 'Bkinkat'
                        Set Label Of txtM2 to Bkinkat.Btypkin_Code

                        Get Field_Current_Value Of Bkinkat_DDR Field Bkinkat.Btypkin_CODE       to uBtypkin_CODE
                        Get Field_Current_value Of Bkinkat_DDR Field Bkinkat.Baxiokat_CODE      to uBaxiokat_CODE
                        Get Field_Current_Value Of Bkinkat_DDR Field Bkinkat.recnum             to iiRec

                        Clear Bkinkat
                        Move sCompany_Code  to Bkinkat.Company_Code
                        Move sBranch_Code   to Bkinkat.Branch_Code
                        Move iYear          to Bkinkat.Year_Year
                        Move uBtypkin_Code  to Bkinkat.Btypkin_Code
                        Move uBaxiokat_Code to Bkinkat.Baxiokat_Code
                        Find Eq Bkinkat By Index.1
                        If (Found) Begin
                            Send Find_By_Recnum To Bkinkat_DDW Bkinkat.File_Number Bkinkat.Recnum
                        End
                        Else Send Clear to Bkinkat_DDW

                        If (iForce) Begin
                            If (Found) Begin
                                //Send Request_Save to Bkinkat_DDW
                            End
                            Else Begin
                                Send Clear to Btypkin_DDW
                                Move sCompany_Code  to Btypkin.Company_Code
                                Move sBranch_Code   to Btypkin.Branch_Code
                                Move iYear          to Btypkin.Year_Year
                                Move uBtypkin_CODE  to Btypkin.Btypkin_Code
                                Send Find to Btypkin_DDW Eq 1

                                Send Clear to Baxiokat_DDW
                                Move uBaxiokat_CODE  to Baxiokat.Baxiokat_Code
                                Send Find to Baxiokat_DDW Eq 1

                                Set Field_Changed_Value Of Bkinkat_DDW Field Bkinkat.Company_Code     to sCompany_Code
                                Set Field_Changed_Value Of Bkinkat_DDW Field Bkinkat.Branch_Code      to sBranch_Code
                                Set Field_Changed_Value Of Bkinkat_DDW Field Bkinkat.Year_Year        to iYear
                                Set Field_Changed_Value of Bkinkat_DDW Field Bkinkat.Bkinkat_Yn_New   to 1 // Neo Axiografo

                                Send Request_Save to Bkinkat_DDW
                            End
                        End
                        Else If (NOT(Found)) Begin
                            Integer iiirec1 iiirec2

                            Clear Btypkin
                            Move sCompany_Code  to Btypkin.Company_Code
                            Move sBranch_Code   to Btypkin.Branch_Code
                            Move iYear          to Btypkin.Year_Year
                            Move uBtypkin_CODE  to Btypkin.Btypkin_Code
                            Find Eq Btypkin By Index.1
                            If (Found=1) Begin
                                Move Btypkin.Recnum to iiirec1
                                Send Find_By_Recnum to Btypkin_DDW Btypkin.File_Number iiirec1
                            End

                            Clear Baxiokat
                            Move uBaxiokat_CODE  to Baxiokat.Baxiokat_Code
                            Find Eq Baxiokat By Index.1
                            If (Found=1) Begin
                                Move Baxiokat.Recnum to iiirec2
                                Send Find_By_Recnum to Baxiokat_DDW Baxiokat.File_Number iiirec2
                            End

                            Set Field_Changed_Value Of Bkinkat_DDW Field Bkinkat.Company_Code       to sCompany_Code
                            Set Field_Changed_Value Of Bkinkat_DDW Field Bkinkat.Branch_Code        to sBranch_Code
                            Set Field_Changed_Value Of Bkinkat_DDW Field Bkinkat.Year_Year          to iYear
                            Set Field_Changed_Value of Bkinkat_DDW Field Bkinkat.Btypkin_Code       to Btypkin.Btypkin_Code
                            Set Field_Changed_Value of Bkinkat_DDW Field Bkinkat.Baxiokat_Code      to Baxiokat.Baxiokat_Code
                            Set Field_Changed_Value of Bkinkat_DDW Field Bkinkat.Bkinkat_Yn_New     to 1 // Neo Axiografo

                            Send Request_Save to Bkinkat_DDW
                        End

                        Send Find_By_Recnum To Bkinkat_DDR Bkinkat.File_Number iiRec

                        Send Find To Bkinkat_DDR Gt 1 //Comp+branch+year+Btypkin_Code+Baxiokat_Code
                    Loop
                End // If (iBkinkat)

                /////////////////////////////////////////////////////////////////////////


                // Ñßò§ò≠¶®· ´®‚Æ¶¨©ò™ Æ®„©û™
                If  (Trim(sCurrentXrhsh)<>'') Begin
                    Send Clear to Year_DDR
                    Move sCurrentXrhsh   to Year.Year_Recr
                    Send Find to Year_DDR Eq 2
                    If (Found) Begin
                        // Ñßò§ò≠¶®·  record SysCurXr
                        Get Field_Current_Value of Company_DDR Field Company.Company_Code to gs_Selected_Company_Code
                        Get Field_Current_Value of Company_DDR Field Company.Company_Name to sCname
                        Get Field_Current_Value of Branch_DDR  Field Branch.Branch_Code   to gs_Selected_Branch_Code
                        Get Field_Current_Value of Branch_DDR  Field Branch.Beto_Site     to gs_Selected_Beto_Site
                        Get Field_Current_Value of Branch_DDR  Field Branch.Branch_Site   to sSite
                        Get Field_Current_Value of Branch_DDR  Field Branch.Branch_name   to sBname
                        Get Field_Current_Value of Year_DDR    Field Year.Year_Year       to gi_Selected_Year
                        Get Field_Current_Value of Year_DDR    Field Year.Year_XrhshFrom  to ldYearXrhsh_From
                        Get Field_Current_Value of Year_DDR    Field Year.Year_XrhshTo    to ldYearXrhsh_To
                        Get Field_Current_Value of Year_DDR    Field Year.Year_Recr       to sYearRecr
                        Get Field_Current_Value of Year_DDR    Field Year.Year_C_Code0    to sNom1
                        Get Field_Current_Value of Year_DDR    Field Year.Year_C_Code00   to sNom2
                        Get Field_Current_Value of Year_DDR    Field Year.Year_C_CodeR    to sNom3
                        Get Field_Current_Value of Year_DDR    Field Year.Year_Descr      to sYname
                        Reread SysCurXR
                        Move gs_Selected_Company_Code   to SysCurXR.Company_Code
                        Move gs_Selected_beto_site      to SysCurXR.beto_site
                        Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
                        Move gi_Selected_Year           to SysCurXR.Year_Year
                        Move sYearRecr                  to SysCurXR.Year_Recr
                        Move sSite                      to SysCurXR.Branch_Site
                        Move sCname                     to SysCurXR.Company_Name
                        Move sBname                     to SysCurXR.Branch_Name
                        Move sYname                     to SysCurXR.Year_Descr
                        Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
                        Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
                        Move  (Trim(sNom1))             to SysCurXR.C_Code0
                        Move  (Trim(sNom2))             to SysCurXR.C_Code00
                        Move  (Trim(sNom3))             to SysCurXR.C_CodeR
                        Saverecord SysCurXR
                        Unlock
                    End
                End
            End
            send info_box "Ü õ†òõ†°ò©Âò ò§¶Âö£ò´¶™ Æ®„©û™ ´ú¢úÂ‡©ú.\nè®Â§ ©¨§úÆÂ©ú´ú, °¢úÂ©´ú ´û§ ú≠ò®£¶ö„ °ò† •ò§ò£ßúÂ´ú" tz.plhroforia
            Set Label Of txtM1 to ''
            Set Label Of txtM2 to ''

        //            Move (Close_all_Views(Self,False)) to Rval1
        //            If (Not(rVal1)) Begin
        //                Send Allaxe_Xrhsh
        //                Send Activate to (Main_Menu(Self))
        //            End
            Function_Return rVal
        End_Function





        //AB-StoreEnd

    End_Object    // The_Table

    Object txtM1 is a TextBoxSub
        Set Label to "txtM1"
        Set Location to 249 3
        Set Size to 10 58

        //AB-StoreStart
        Set label to ''

        //AB-StoreEnd

    End_Object    // txtM1

    Object txtM2 is a TextBoxSub
        Set Label to "txtM2"
        Set Location to 249 68
        Set Size to 10 81

        //AB-StoreStart
        Set label to ''

        //AB-StoreEnd

    End_Object    // txtM2

    Object chkCtypkin is a CheckBoxSub
        Set Label to "Ctypkin+Cflagkin"
        Set Size to 10 69
        Set Location to 202 3
    End_Object    // chkCtypkin

    Object chkBtypkin is a CheckBoxSub
        Set Label to "Btypkin+Bflagkin"
        Set Size to 10 69
        Set Location to 202 78
    End_Object    // chkBtypkin

    Object chkWtypkin is a CheckBoxSub
        Set Label to "Wtypkin+Wflagkin"
        Set Size to 10 75
        Set Location to 202 155
    End_Object    // chkWtypkin

    Object chkClient is a CheckBoxSub
        Set Label to "Clients"
        Set Size to 10 37
        Set Location to 202 241
    End_Object    // chkClient

    Object chkBaxio is a CheckBoxSub
        Set Label to "Baxio"
        Set Size to 10 34
        Set Location to 215 241
    End_Object    // chkBaxio

    Object chkPtyppar is a CheckBoxSub
        Set Label to "Ptyppar"
        Set Size to 10 41
        Set Location to 215 3
    End_Object    // chkPtyppar

    Object chkWitemx is a CheckBoxSub
        Set Label to "Witemx"
        Set Size to 10 40
        Set Location to 215 78
    End_Object    // chkWitemx

    Object chkWax is a CheckBoxSub
        Set Label to "Wax"
        Set Size to 10 31
        Set Location to 215 155
    End_Object    // chkWax

    Object chkForce is a CheckBoxSub
        Set Label to "Forced Update"
        Set Size to 10 64
        Set Location to 233 3
    End_Object    // chkForce

    Object TextBoxSub11 is a TextBoxSub
        Set Label to "ë´¶ ·§¶†ö£ò §‚ò™ Æ®„©û™ §ò £ú´ò≠ú®ü¶Á§ ¶† ò°Ê¢¶¨üú™ úöö®ò≠‚™ "
        Set TextColor to clRed
        Set Location to 187 3
        Set Size to 10 239
        Set FontWeight to 600
    End_Object    // TextBoxSub11

    Object chkHmCtyp is a CheckBoxSub
        Set Label to "HmCtyp"
        Set Size to 10 41
        Set Location to 202 297
    End_Object    // chkHmCtyp

    Object chkHmWtyp is a CheckBoxSub
        Set Label to "HmWtyp"
        Set Size to 10 44
        Set Location to 215 297
    End_Object    // chkHmWtyp

    Object chkBkinKat is a CheckBoxSub
        Set Label to "Bkinkat"
        Set Size to 10 41
        Set Location to 202 355
    End_Object    // chkBkinKat

    Object frmYear is a FormSub
        Set Size to 13 23
        Set Location to 186 355
        Set Label_Col_Offset to 2
        Set Value Item 0 to "1999"
    End_Object    // frmYear

    Object TextBoxSub12 is a TextBoxSub
        Set Label to "Ñ´¶™ Ä§ò≠¶®·™"
        Set Location to 187 297
        Set Size to 10 54
    End_Object    // TextBoxSub12


    //AB-StoreStart

    Procedure Activate_View Returns Integer
        Integer rVal
        String sCurrentXrhsh
        Forward Get Msg_Activate_View to rVal
        Set Checked_State Of chkClient to (SysrecC.Constr_Clients='1')
        Set Enabled_State Of chkClient to (SysrecC.Constr_Clients='1')
        Get Field_Current_Value Of SysCurXr_DD Field SysCurXr.Year_Recr  to sCurrentXrhsh
        Set psCurXr to sCurrentXrhsh
        Procedure_return rVal
    End_Procedure



    //AB-StoreEnd

CD_End_Object    // OpenXr


//AB-StoreStart

//AB-StoreEnd

//AB/ End_Object    // prj
