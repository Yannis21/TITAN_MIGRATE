//AB/ Project v3t
//AB/ Object prj is a View_Project
//AB/     Set ProjectName to "v3t"
//AB/     Set ProjectFileName to "v3t.VW"

// Project Object Structure
//   V3t is a dbViewSubS
//     sysrecc is a sysrecc_DataDictionary
//     Company_DDR is a Company_DataDictionary
//     Branch_DDR is a Branch_DataDictionary
//     Year_DDR is a Year_DataDictionary
//     Clients_DDR is a Clients_DataDictionary
//     Clients_DDW is a Clients_DataDictionary
//     Wapokat_DDW is a Wapokat_DataDictionary
//     Wapomast_DDW is a Wapomast_DataDictionary
//     Wax_DDW is a Wax_DataDictionary
//     Wapokat_DDR is a Wapokat_DataDictionary
//     Wapomast_DDR is a Wapomast_DataDictionary
//     Wax_DDR is a Wax_DataDictionary
//     Country_DD2 is a Country_DataDictionary
//     Towns_DD2 is a Towns_DataDictionary
//     Cities_DD2 is a Cities_DataDictionary
//     Areas_DD2 is a Areas_DataDictionary
//     Payresp_DD2 is a Payresp_DataDictionary
//     Clients_DD2 is a Clients_DataDictionary
//     Clorder_DD is a Clorder_DataDictionary
//     Clorderd_DD is a Clorderd_DataDictionary
//     Clorder_DD2 is a Clorder_DataDictionary
//     Clorderd_DD2 is a Clorderd_DataDictionary
//     Company_DD is a DataDictionary
//     Branch_DD is a DataDictionary
//     Year_DD is a DataDictionary
//     Ctypkin_DD is a DataDictionary
//     Cflagkin_DD is a DataDictionary
//     Syscurxr_DD is a DataDictionary
//     Company_Company_Code is a dbFormSub
//     Company_Company_Name is a dbFormSub
//     dbTabDialogSubS1 is a dbTabDialogSubS
//       TP_db1 is a dbTabPage
//         Company_Company_Afm is a dbFormSub
//         Company_Company_Addr is a dbFormSub
//         Company_Company_Tk is a dbFormSub
//         Company_Company_Poli is a dbFormSub
//         Company_Company_Tel is a dbFormSub
//         Company_Company_Fax is a dbFormSub
//         Company_Company_Email is a dbFormSub
//         Company_Company_Resp is a dbFormSub
//         TextBoxSub3 is a TextBoxSub
//         TextBoxSub4 is a TextBoxSub
//         TextBoxSub5 is a TextBoxSub
//         TextBoxSub6 is a TextBoxSub
//         TextBoxSub7 is a TextBoxSub
//         TextBoxSub8 is a TextBoxSub
//         TextBoxSub9 is a TextBoxSub
//         TextBoxSub10 is a TextBoxSub
//         TextBoxSub14 is a TextBoxSub
//         Textbox1 is a Textbox
//         Company_Company_Doy is a dbComboFormSub
//         Company_Company_J_Code is a dbComboFormSub
//       TP_db2 is a dbTabPage
//         Branch_table is a dbGridSub
//         TextBoxSub34 is a TextBoxSub
//         branch_branch_Afm is a dbFormSub
//         TextBoxSub35 is a TextBoxSub
//         branch_branch_Doy is a dbComboForm
//         TextBoxSub36 is a TextBoxSub
//         branch_branch_Addr is a dbFormSub
//         TextBoxSub37 is a TextBoxSub
//         branch_branch_Tk is a dbFormSub
//         TextBoxSub38 is a TextBoxSub
//         branch_branch_Poli is a dbFormSub
//         TextBoxSub39 is a TextBoxSub
//         branch_branch_Tel is a dbFormSub
//         TextBoxSub40 is a TextBoxSub
//         branch_branch_Fax is a dbFormSub
//         TextBoxSub41 is a TextBoxSub
//         branch_branch_Email is a dbFormSub
//         TextBoxSub42 is a TextBoxSub
//         branch_branch_Resp is a dbFormSub
//         Branch_Path_Exp is a dbFormSub
//         Branch_Exp_Txtname is a dbFormSub
//         TextBoxSub43 is a TextBoxSub
//         TextBoxSub44 is a TextBoxSub
//       dbTabPageSubS3 is a dbTabPageSubS
//         The_Table is a dbGrid
//         TextBoxSub24 is a TextBoxSub
//         chkCtypkin is a CheckBoxSub
//         chkPtyppar is a CheckBoxSub
//         chkForce is a CheckBoxSub
//         txtM1 is a TextBoxSub
//         txtM2 is a TextBoxSub
//         chkBtypkin is a CheckBoxSub
//         chkWitemx is a CheckBoxSub
//         chkWtypkin is a CheckBoxSub
//         chkWax is a CheckBoxSub
//         chkClient is a CheckBoxSub
//         chkBaxio is a CheckBoxSub
//         chkHmCtyp is a CheckBoxSub
//         TextBoxSub27 is a TextBoxSub
//         frmYear is a FormSub
//         chkBkinKat is a CheckBoxSub
//         chkHmWtyp is a CheckBoxSub
//         TextBoxSub32 is a TextBoxSub
//         Company_Company_Code is a dbFormSub
//         TextBoxSub33 is a TextBoxSub
//         Company_Company_Name is a dbFormSub
//         chkclorder is a CheckBoxSub
//     TextBoxSub1 is a TextBoxSub
//     TextBoxSub2 is a TextBoxSub
//     dbBitmap3 is a dbBitmap

// Register all objects
Register_Object Areas_DD2
Register_Object Branch_DD
Register_Object Branch_DDR
Register_Object Branch_Exp_Txtname
Register_Object Branch_Path_Exp
Register_Object Branch_table
Register_Object branch_branch_Addr
Register_Object branch_branch_Afm
Register_Object branch_branch_Doy
Register_Object branch_branch_Email
Register_Object branch_branch_Fax
Register_Object branch_branch_Poli
Register_Object branch_branch_Resp
Register_Object branch_branch_Tel
Register_Object branch_branch_Tk
Register_Object Cflagkin_DD
Register_Object Cities_DD2
Register_Object Clients_DD2
Register_Object Clients_DDR
Register_Object Clients_DDW
Register_Object Clorder_DD
Register_Object Clorder_DD2
Register_Object Clorderd_DD
Register_Object Clorderd_DD2
Register_Object Company_Company_Addr
Register_Object Company_Company_Afm
Register_Object Company_Company_Code
Register_Object Company_Company_Doy
Register_Object Company_Company_Email
Register_Object Company_Company_Fax
Register_Object Company_Company_J_Code
Register_Object Company_Company_Name
Register_Object Company_Company_Poli
Register_Object Company_Company_Resp
Register_Object Company_Company_Tel
Register_Object Company_Company_Tk
Register_Object Company_DD
Register_Object Company_DDR
Register_Object Country_DD2
Register_Object Ctypkin_DD
Register_Object chkBaxio
Register_Object chkBkinKat
Register_Object chkBtypkin
Register_Object chkClient
Register_Object chkCtypkin
Register_Object chkclorder
Register_Object chkForce
Register_Object chkHmCtyp
Register_Object chkHmWtyp
Register_Object chkPtyppar
Register_Object chkWax
Register_Object chkWitemx
Register_Object chkWtypkin
Register_Object dbBitmap3
Register_Object dbTabDialogSubS1
Register_Object dbTabPageSubS3
Register_Object frmYear
Register_Object Payresp_DD2
Register_Object Syscurxr_DD
Register_Object sysrecc
Register_Object TextBoxSub1
Register_Object TextBoxSub10
Register_Object TextBoxSub14
Register_Object TextBoxSub2
Register_Object TextBoxSub24
Register_Object TextBoxSub27
Register_Object TextBoxSub3
Register_Object TextBoxSub32
Register_Object TextBoxSub33
Register_Object TextBoxSub34
Register_Object TextBoxSub35
Register_Object TextBoxSub36
Register_Object TextBoxSub37
Register_Object TextBoxSub38
Register_Object TextBoxSub39
Register_Object TextBoxSub4
Register_Object TextBoxSub40
Register_Object TextBoxSub41
Register_Object TextBoxSub42
Register_Object TextBoxSub43
Register_Object TextBoxSub44
Register_Object TextBoxSub5
Register_Object TextBoxSub6
Register_Object TextBoxSub7
Register_Object TextBoxSub8
Register_Object TextBoxSub9
Register_Object Textbox1
Register_Object The_Table
Register_Object Towns_DD2
Register_Object TP_db1
Register_Object TP_db2
Register_Object txtM1
Register_Object txtM2
Register_Object V3t
Register_Object Wapokat_DDR
Register_Object Wapokat_DDW
Register_Object Wapomast_DDR
Register_Object Wapomast_DDW
Register_Object Wax_DDR
Register_Object Wax_DDW
Register_Object Year_DD
Register_Object Year_DDR


//AB/ AppBuild VIEW


//AB-StoreTopStart
Open SysCurXr
use sysrecc.dd
Use Btypkin.DD
Use Bflagkin.DD
Use Wtypkin.DD
Use Wflagkin.DD
use clients.dd
use payresp.dd
use areas.dd
use cities.dd
use towns.dd
use country.dd
Use CN.DD
Use Baxio.DD
Use BaxioKat.DD
Use WapoKat.DD
Use Wapomast.DD
Use Wax.DD
Use WitemKat.DD
use units.dd
Use Item.DD
Use Witemx.DD
Use Witemxt.DD
Use Fpa.DD
Use Ptyppar.DD
Use Pseira.DD
Use HmCtyp.DD
Use HmWtyp.DD
use clorder.dd
use clorderd.dd
use sl001.sl
//AB-StoreTopEnd

//AB-IgnoreStart

Use dbView.Sub
Use DFAllEnt.pkg
Use dbForm.Sub
Use dbTabDlgS.Sub
Use Txtbox.Sub
Use dbCmbfrm.Sub
Use dbGrid.Sub
Use Chkbox.Sub
Use Form.Sub

Use COMPANY.DD
Use BRANCH.DD
Use YEAR.DD
Use CTYPKIN.DD
Use CFLAGKIN.DD
Use SYSCURXR.DD

//AB-IgnoreEnd

ACTIVATE_VIEW Activate_V3t FOR V3t

Object V3t is a dbViewSubS

    //AB-StoreTopStart
    property string psrecr public ''
    
    Object sysrecc is a sysrecc_DataDictionary
    End_Object    // sysrecc
    
    Object Company_DDR is a Company_DataDictionary
    End_Object    // Company_DDR
    Object Branch_DDR is a Branch_DataDictionary
        Set DDO_Server to (Company_DDR(self))
    End_Object    // Branch_DDR
    Object Year_DDR is a Year_DataDictionary
        Set DDO_Server to (Branch_DDR(self))
    End_Object    // Year_DDR
    
    
    Object Clients_DDR is a Clients_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Clients_DDR
    
    
    
    Object Clients_DDW is a Clients_DataDictionary
        Set piMustNOTConstrain(Self)) to True
    End_Object    // Clients_DDR
    
    
    
    Object Wapokat_DDW is a Wapokat_DataDictionary
    End_Object    // Wapokat_DDW
    
    Object Wapomast_DDW is a Wapomast_DataDictionary
        Set DDO_Server to (Wapokat_DDW(self))
    End_Object    // Wapomast_DDW
    
    Object Wax_DDW is a Wax_DataDictionary
        Set piMustNOTConstrain(Self)) to True
        Set DDO_Server to (Wapomast_DDW(self))
    End_Object    // Wax_DDW
    
    Object Wapokat_DDR is a Wapokat_DataDictionary
    End_Object    // Wapokat_DDR
    
    Object Wapomast_DDR is a Wapomast_DataDictionary
        Set DDO_Server to (Wapokat_DDR(self))
    End_Object    // Wapomast_DDR
    
    Object Wax_DDR is a Wax_DataDictionary
        Set piMustNOTConstrain(Self)) to True
        Set DDO_Server to (Wapomast_DDR(self))
    End_Object    // Wax_DDR
    
    
    
    
    
    Object Country_DD2 is a Country_DataDictionary
    End_Object    // Country_DD
    
    Object Towns_DD2 is a Towns_DataDictionary
        Set DDO_Server to (Country_DD2(self))
    End_Object    // Towns_DD
    
    Object Cities_DD2 is a Cities_DataDictionary
        Set DDO_Server to (Towns_DD2(self))
    End_Object    // Cities_DD
    
    Object Areas_DD2 is a Areas_DataDictionary
    End_Object    // Areas_DD
    
    Object Payresp_DD2 is a Payresp_DataDictionary
    End_Object    // Payresp_DD
    
    Object Clients_DD2 is a Clients_DataDictionary
        Set DDO_Server to (Cities_DD2(self))
        Set DDO_Server to (Areas_DD2(self))
        Set DDO_Server to (Payresp_DD2(self))
        set no_delete_state to true
    End_Object
    
    
    
    Object Clorder_DD is a Clorder_DataDictionary
        procedure update
        end_procedure
        procedure creating
        end_procedure
    End_Object    // Clorder_DD
    
    Object Clorderd_DD is a Clorderd_DataDictionary
        Set DDO_Server to (clorder_DD(self))
        begin_constraints
          string srecr
          get psrecr to srecr
          constrain clorderd.clorder_recr eq srecr
        end_constraints
        procedure update
        end_procedure
        procedure creating
        end_procedure
    end_object
    
    Object Clorder_DD2 is a Clorder_DataDictionary
        Set DDO_Server to (Clients_DD2(self))
        Set Constrain_File to Clients.File_Number
        procedure update
        end_procedure
        procedure creating
        end_procedure
    End_Object    // Clorder_DD
    
    Object Clorderd_DD2 is a Clorderd_DataDictionary
        Set DDO_Server to (clorder_DD2(self))
        Set Constrain_File to clorder.File_Number
        procedure update
        end_procedure
        procedure creating
        end_procedure
    end_object
    
    Property String psCurXr Public ''
    Function Confirm_Delete_company Returns Integer
        local integer rval
        Get confirm "É†òö®ò≠„ Ñ´ò†®úÂò™ ??" to rval
        Function_Return rval
    End_Function
    
    Function Confirm_Save_company Returns Integer
        local integer NoSave Srvr Rec
        Get Server to Srvr
        Get Current_Record of Srvr to Rec
        If Rec eq 0 ;
           Get Confirm "Ñöö®ò≠„ å‚ò™ Ñ´ò†®úÂò™ ??" to NoSave
        Function_Return NoSave
    End_Function
    
    Set Verify_Save_MSG       to GET_Confirm_save_company
    Set Verify_Delete_MSG     to GET_Confirm_delete_company
    
    Function Save_header returns integer
       Local integer Rec Changed Srvr
       Get Server to Srvr
       Get Current_Record of Srvr to Rec
       Get Should_Save to Changed
    
    
       If (Rec=0 AND Changed=0) Begin
          Error 300 'è®‚ßú† å· è®¶ûöûüúÂ Ñöö®ò≠„ Ñ´ò†®úÂò™ !!'
          Function_Return 1
       End
    
       Send request_save_no_clear
    
    
       Get Should_Save to Changed
       Get Current_record of Srvr to Rec
       If (Rec=0 OR Changed) ;
          Function_return 1
    end_function
    
    //AB-StoreTopEnd

    Set Label to "Ñ´ò†®Âò - ìß¶°ò´·©´û£ò - ï®„©û"
    Set Size to 290 517
    Set Location to 1 1

    //AB-DDOStart

    Object Company_DD is a Company_DataDictionary
    End_Object    // Company_DD

    Object Branch_DD is a Branch_DataDictionary
        Set DDO_Server to (Company_DD(self))
        Set Constrain_File to Company.File_Number
    End_Object    // Branch_DD

    Object Year_DD is a Year_DataDictionary
        Set DDO_Server to (Branch_DD(self))
        Set Constrain_File to Branch.File_Number
    End_Object    // Year_DD

    Object Ctypkin_DD is a Ctypkin_DataDictionary
    End_Object    // Ctypkin_DD

    Object Cflagkin_DD is a Cflagkin_DataDictionary
        Set DDO_Server to (Ctypkin_DD(self))
    End_Object    // Cflagkin_DD

    Object Syscurxr_DD is a Syscurxr_DataDictionary
    End_Object    // Syscurxr_DD

    Set Main_DD to (Company_DD(self))
    Set Server to (Company_DD(self))

    //AB-DDOEnd

    Object Company_Company_Code is a dbFormSub
        Entry_Item Company.Company_code
        Set Size to 13 66
        Set Location to 6 77
        Set Label_Col_Offset to 2
        Set Label_Justification_Mode to jMode_Right

        //AB-StoreStart
        Set Prompt_Object to (sl001(Current_object))
        //AB-StoreEnd

    End_Object    // Company_Company_Code

    Object Company_Company_Name is a dbFormSub
        Entry_Item Company.Company_name
        Set Size to 13 285
        Set Location to 22 77
        Set Label_Col_Offset to 2
        Set Label_Justification_Mode to jMode_Right

        //AB-StoreStart
        Set Prompt_Object to (sl001(Current_object))
        
        
        //AB-StoreEnd

    End_Object    // Company_Company_Name

    Object dbTabDialogSubS1 is a dbTabDialogSubS

        //AB-StoreTopStart
                                                                                                                                                        
        //AB-StoreTopEnd

        Set Size to 225 506
        Set Location to 48 4
        Set Rotate_Mode to RM_Rotate
        Set Border_Style to Border_Normal
        Object TP_db1 is a dbTabPage

            //AB-StoreTopStart
                                                                                                                                                                                                                        
            //AB-StoreTopEnd

            Set Label to "ë´¶†ÆúÂò Ñ´ò†®úÂò™"
            Object Company_Company_Afm is a dbFormSub
                Entry_Item Company.Company_afm
                Set Size to 13 126
                Set Location to 10 71
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Afm

            Object Company_Company_Addr is a dbFormSub
                Entry_Item Company.Company_addr
                Set Size to 13 285
                Set Location to 28 71
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Addr

            Object Company_Company_Tk is a dbFormSub
                Entry_Item Company.Company_tk
                Set Size to 13 83
                Set Location to 78 70
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Tk

            Object Company_Company_Poli is a dbFormSub
                Entry_Item Company.Company_poli
                Set Size to 13 83
                Set Location to 95 70
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Poli

            Object Company_Company_Tel is a dbFormSub
                Entry_Item Company.Company_tel
                Set Size to 13 83
                Set Location to 112 70
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Tel

            Object Company_Company_Fax is a dbFormSub
                Entry_Item Company.Company_fax
                Set Size to 13 83
                Set Location to 128 70
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Fax

            Object Company_Company_Email is a dbFormSub
                Entry_Item Company.Company_email
                Set Size to 13 83
                Set Location to 145 70
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Email

            Object Company_Company_Resp is a dbFormSub
                Entry_Item Company.Company_resp
                Set Size to 13 285
                Set Location to 162 71
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Company_Company_Resp

            Object TextBoxSub3 is a TextBoxSub
                Set Label to "Ä.î.ã"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 13 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub3

            Object TextBoxSub4 is a TextBoxSub
                Set Label to "É†úÁü¨§©û"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 29 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub4

            Object TextBoxSub5 is a TextBoxSub
                Set Label to "T.K"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 81 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub5

            Object TextBoxSub6 is a TextBoxSub
                Set Label to "èÊ¢û"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 98 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub6

            Object TextBoxSub7 is a TextBoxSub
                Set Label to "íû¢‚≠‡§¶"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 114 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub7

            Object TextBoxSub8 is a TextBoxSub
                Set Label to "Ä®†ü£Ê™ Fax"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 129 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub8

            Object TextBoxSub9 is a TextBoxSub
                Set Label to "Email"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 146 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub9

            Object TextBoxSub10 is a TextBoxSub
                Set Label to "ìßúÁü¨§¶™"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 163 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub10

            Object TextBoxSub14 is a TextBoxSub
                Set Label to "É.é.ì"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 46 9
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub14

            Object Textbox1 is a Textbox
                Set Label to "Ñß·ööú¢£ò"
                Set Location to 64 7
                Set Size to 10 43
            End_Object    // Textbox1

            Object Company_Company_Doy is a dbComboFormSub
                Entry_Item Company.Company_doy
                Set Size to 15 127
                Set Location to 44 70
                Set Label_Col_Offset to 2
            End_Object    // Company_Company_Doy

            Object Company_Company_J_Code is a dbComboFormSub
                Entry_Item Company.Company_j_code
                Set Size to 15 127
                Set Location to 61 70
                Set Label_Col_Offset to 2
            End_Object    // Company_Company_J_Code


            //AB-StoreStart
            Set Label to "ë´¶†ÆúÂò Ñ´ò†®Âò™"
            
            //AB-StoreEnd

        End_Object    // TP_db1

        Object TP_db2 is a dbTabPage

            //AB-StoreTopStart
                                                                                                                                                                                                                        
            //AB-StoreTopEnd

            Set Label to "ë´¶†ÆúÂò ìß¶°ò´ò©´„£ò´¶™"
            Object Branch_table is a dbGridSub

                //AB-StoreTopStart
                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                        
                //AB-StoreTopEnd

                Set Main_File to Branch.File_Number
                Set Server to (Branch_DD(self))
                Set Size to 79 397
                Set Location to 4 2
                Set Wrap_State to TRUE

                Begin_Row
                    Entry_Item Branch.Branch_code
                    Entry_Item Branch.Branch_name
                    Entry_Item Branch.Branch_site
                End_Row

                Set Form_Width    item 0 to 108
                Set Header_Label  item 0 to "â‡õ†°Ê™"
                
                Set Form_Width    item 1 to 240
                Set Header_Label  item 1 to "é§¶£ò©Âò"
                
                Set Form_Width    item 2 to 40
                Set Header_Label  item 2 to "í¶£‚ò™"
                

                //AB-StoreStart
                set currentrowcolor to 11468799
                set currentcellcolor to 11468799
                Set child_table_state        to TRUE
                Function Child_entering returns Integer
                local integer rval
                    Delegate Get Save_Header to rval
                    function_return rval
                End_Function
                
                Function Confirm_Delete_branch Returns Integer
                    local integer rval
                    Get confirm "É†òö®ò≠„ ìß¶°ò´ò©´„£ò´¶™ ??" to rval
                    Function_Return rval
                End_Function
                
                
                Function Confirm_Save_branch Returns Integer
                    local integer rval
                    Get Confirm "Ñöö®ò≠„ ìß¶°ò´ò©´„£ò´¶™ ??" to rval
                    Function_Return rval
                End_Function
                
                Set Verify_Save_MSG       to GET_Confirm_save_branch
                Set Verify_Delete_MSG     to GET_Confirm_delete_branch
                
                Procedure refresh integer iMode
                    local integer iRec
                    Get Current_record of (branch_dd(Current_object)) to iRec
                    if (irec > 0) begin
                        Forward Send Refresh iMode
                    end
                End_procedure
                
                Procedure Next_Row
                    Send Activate
                    Set Current_Item to (Base_Item(self))
                    Send Down_row
                End_Procedure
                
                
                
                
                //AB-StoreEnd

            End_Object    // Branch_table

            Object TextBoxSub34 is a TextBoxSub
                Set Label to "Ä.î.ã"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 81 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub34

            Object branch_branch_Afm is a dbFormSub
                Entry_Item Branch.Branch_afm
                Set Server to (Branch_DD(self))
                Set Size to 13 77
                Set Location to 79 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Afm

            Object TextBoxSub35 is a TextBoxSub
                Set Label to "É.é.ì"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 81 147
                Set Size to 10 27
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub35

            Object branch_branch_Doy is a dbComboForm
                Entry_Item Branch.Branch_doy
                Set Server to (Branch_DD(self))
                Set Size to 13 126
                Set Location to 78 181
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Doy

            Object TextBoxSub36 is a TextBoxSub
                Set Label to "É†úÁü¨§©û"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 95 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub36

            Object branch_branch_Addr is a dbFormSub
                Entry_Item Branch.Branch_addr
                Set Server to (Branch_DD(self))
                Set Size to 13 243
                Set Location to 93 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Addr

            Object TextBoxSub37 is a TextBoxSub
                Set Label to "T.K"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 109 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub37

            Object branch_branch_Tk is a dbFormSub
                Entry_Item Branch.Branch_tk
                Set Server to (Branch_DD(self))
                Set Size to 13 77
                Set Location to 107 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Tk

            Object TextBoxSub38 is a TextBoxSub
                Set Label to "èÊ¢û"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 122 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub38

            Object branch_branch_Poli is a dbFormSub
                Entry_Item Branch.Branch_poli
                Set Server to (Branch_DD(self))
                Set Size to 13 243
                Set Location to 121 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Poli

            Object TextBoxSub39 is a TextBoxSub
                Set Label to "íû¢‚≠‡§¶"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 136 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub39

            Object branch_branch_Tel is a dbFormSub
                Entry_Item Branch.Branch_tel
                Set Server to (Branch_DD(self))
                Set Size to 13 77
                Set Location to 135 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Tel

            Object TextBoxSub40 is a TextBoxSub
                Set Label to "Ä®†ü£Ê™ Fax"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 137 185
                Set Size to 10 43
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub40

            Object branch_branch_Fax is a dbFormSub
                Entry_Item Branch.Branch_fax
                Set Server to (Branch_DD(self))
                Set Size to 13 77
                Set Location to 135 231
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Fax

            Object TextBoxSub41 is a TextBoxSub
                Set Label to "Email"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 151 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub41

            Object branch_branch_Email is a dbFormSub
                Entry_Item Branch.Branch_email
                Set Server to (Branch_DD(self))
                Set Size to 13 243
                Set Location to 149 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Email

            Object TextBoxSub42 is a TextBoxSub
                Set Label to "ìßúÁü¨§¶™"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 165 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub42

            Object branch_branch_Resp is a dbFormSub
                Entry_Item Branch.Branch_resp
                Set Server to (Branch_DD(self))
                Set Size to 13 243
                Set Location to 164 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // branch_branch_Resp

            Object Branch_Path_Exp is a dbFormSub
                Entry_Item Branch.Path_exp
                Set Server to (Branch_DD(self))
                Set Size to 13 243
                Set Location to 178 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Branch_Path_Exp

            Object Branch_Exp_Txtname is a dbFormSub
                Entry_Item Branch.Exp_txtname
                Set Server to (Branch_DD(self))
                Set Size to 13 156
                Set Location to 192 65
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    // Branch_Exp_Txtname

            Object TextBoxSub43 is a TextBoxSub
                Set Label to "Ä®ÆúÂ¶ TXT"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 196 3
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub43

            Object TextBoxSub44 is a TextBoxSub
                Set Label to "Path Exp ß®¶ö®/£¶Á"
                Set Auto_Size_State to FALSE
                Set TextColor to clWindow
                Set FontSize to 4 0
                Set Location to 176 3
                Set Size to 18 47
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub44


            //AB-StoreStart
            Set Label to "ìß¶°ò´ò©´„£ò´ò"
            
            //AB-StoreEnd

        End_Object    // TP_db2

        Object dbTabPageSubS3 is a dbTabPageSubS
            Set Label to "dbTabPageSubS3"
            Object The_Table is a dbGrid
                Set Main_File to Year.File_Number
                Set Server to (Year_DD(self))
                Set Ordering to 1
                Set Size to 70 456
                Set Location to 44 3
                Set Wrap_State to TRUE

                Begin_Row
                    Entry_Item Year.Year_year
                    Entry_Item Year.Year_descr
                    Entry_Item Year.Year_xrhshfrom
                    Entry_Item Year.Year_xrhshto
                    Entry_Item Year.Year_entrydate
                    Entry_Item Year.Year_c_code0
                    Entry_Item Year.Year_c_code00
                    Entry_Item Year.Year_c_coder
                End_Row

                Set Form_Width    item 0 to 45
                Set Header_Label  item 0 to "ï®„©û :          "
                
                Set Form_Width    item 1 to 67
                Set Header_Label  item 1 to "èú®†ö®ò≠„"
                
                Set Form_Width    item 2 to 60
                Set Header_Label  item 2 to "ï®„©û Äß¶"
                
                Set Form_Width    item 3 to 57
                Set Header_Label  item 3 to "ï®„©û Ñ‡™"
                
                Set Form_Width    item 4 to 57
                Set Header_Label  item 4 to "Ü£/§Âò âò´òÆ."
                
                Set Form_Width    item 5 to 55
                Set Header_Label  item 5 to "Ä' åÊ£†©£ò"
                
                Set Form_Width    item 6 to 50
                Set Header_Label  item 6 to "Å' åÊ£†©£ò"
                
                Set Form_Width    item 7 to 60
                Set Header_Label  item 7 to "åÊ£†©£ò Report"
                

                //AB-StoreStart
                                    
                Function row_save returns integer
                
                //            Set_argument_size 2048
                
                    Integer iRetVal liYearDD liCompanyDD liBranchDD iYear iLastYear rVal SysYear
                    Integer iYparxei iCtypkin iBtypkin iWtypkin iForce iClient iBaxio iPtyppar iWitemx iWax
                    integer iclorder
                    String  sYearRecr sSite sCname sBname sYname sNom1 sNom2 sNom3 sAnti sFlags sRR2 sRR3
                    String  sCompany_Code sBranch_Code sBeto_Site sCode sFlag sRR sDescr sDescrFlag sModule
                    Date    ldYearXrhsh_From ldYearXrhsh_To
                    Date    bBTYPKIN_L_HMNIA ddate
                    Integer bGTYPKIN_CODE bCTYPKIN_CODE bVTYPKIN_CODE bGTYPKIN_REC0 bBTYPKIN_SIGN
                    Integer bCTYPKIN_REC0 bVTYPKIN_REC0 bBTYPKIN_ANTI1 bBTYPKIN_ANTI2
                    Integer bBFLAGKIN_NUM bBTYPKIN_ANTI_XP bBTYPKIN_L_NO isNewBranch
                    Integer bBTYPKIN_FLAG01  bBTYPKIN_FLAG02  bBTYPKIN_FLAG03 bBTYPKIN_FLAG04
                    Integer bBTYPKIN_FLAG05  bBTYPKIN_FLAG06  bBTYPKIN_FLAG07 bBTYPKIN_FLAG08
                    Integer bBTYPKIN_FLAG09  bBTYPKIN_FLAG10 bBTYPKIN_FLAG11 bBTYPKIN_FLAG12
                    Integer bBTYPKIN_FLAG13 bBTYPKIN_FLAG14 bBTYPKIN_FLAG15 bBTYPKIN_FLAG16
                    Integer bBTYPKIN_FLAG17 bBTYPKIN_FLAG18 bBTYPKIN_FLAG19 bBTYPKIN_FLAG20
                    String  bGPLAN_CODE_APO1  bGPLAN_CODE_EOS1 bGPLAN_CODE_APO2 bGPLAN_CODE_EOS2
                    String  bBTYPKIN_PRINTER bBTYPKIN_PDESCR bBTYPKIN_FORM bBTYPKIN_SEIRA SysYearRecr
                    String  bBTYPKIN_ABR bCTYPKIN_RECR bBTYPKIN_DESCR sYearRecrNew SysCompany SysBranch
                    Number  bBKINKAT_NUM cXREOSH cPISTOSH cYPOLOIPO cPLAFON cOVERHEAD
                    String  cCUSTPROM_CODE cCLIENT_ID cCLIENT_NAME cCLIENT_AFM cCUSTPROM_RECR cCLIENT_RECR
                    Integer cCLIENT_REC0 cCLIENT_DOY cCLIENT_CITY cCLIENT_AREA cCLIENT_CATEGFPA cCLIENT_FPA cCLIENT_PUBLIC
                    Integer cCLIENT_CATJOB
                    Date    cLAST_XREOSH cLAST_PISTOSH cLAST_ORDER cCLIENT_LASTUPD
                    String  cCLIENT_ADDRESS cCLIENT_JOB cCLIENT_RESPONS cCLIENT_ZIPCODE cCLIENT_PHONE cCLIENT_CODEM
                    String  cCLIENT_FAX cCLIENT_MOBILE cCLIENT_AOH cCLIENT_EMAIL cCLIENT_CLASS cCLIENT_DETAILS cCLIENT_SITEW
                    String  cCLIENT_SN cCLIENT_REPM cCLIENT_ACTIVE cCLIENT_REPORTED cCLIENT_PELPROM cCLIENT_MARKEXP
                    String  cIS_PROMHTHEYTHS cis_pelaths
                           Integer dAXIOKAT_CODE dAXIO_REC0 dAXIO_STATUS dAXIO_PLACE dAXIO_FILE_IN dAXIO_FILE_OUT
                           Integer dAXIO_LFILE
                           String  dEAR_RECR dAXIOKAT_RECR dAXIO_RECR dAXIO_CODE_IN dAXIO_EPON_IN dAXIO_FPAR_IN
                           String  dAXIO_CODE_OUT dAXIO_EPON_OUT dAXIO_FPAR_OUT dAXIO_LCODE dAXIO_LEPON dAXIO_LPAR
                           Date    dAXIO_HMNIAE dAXIO_HMNIAP000 dAXIO_HMNIAL
                           String  dAXIO_BANK00000 dAXIO_EKDOTHS dAXIO_EKDOTHSE dAXIO_SDIATAGH dAXIO_SDIATAGHE dAXIO_BANKA
                           String  dAXIO_NO dAXIO_C_CODE2 dAXIO_OPISTHO
                           Number  dAXIO_V2 dAXIO_V0 dAXIO_V00 dAXIO_VR dAXIO_RATE0 dAXIO_RATE00 dAXIO_RATER
                           Integer dAXIO_LIXI_YYYY dAXIO_LIXI_MM dAXIO_LIXI_DD dAXIO_BMOVE_LAA
                
                    String  wWAPOKAT_CODE wWAPOMAST_CODE wWAX_CODE wYEAR_RECR wWAPOMAST_RECR wWAX_RECR wWAX_DESCR
                    Integer wWAX_REC0 igridid
                
                    String  zUNITS_CODE zWITEMKAT_CODE zITEM_CODE zWITEMX_CODE zWITEMX_RECR zYEAR_RECR
                    String  zITEM_RECR zWITEMX_DESCR zWITEMX_YEARDESC zITEM_APOKAT_COD sYear_Anaforas
                    Integer zWITEMX_REC0 zAXIA zAXIA0 zAXIA00 zAXIAR tPTYPPAR_REC0 rVal1
                    Integer tPSEIRA_REC0 tPSEIRA_AUTONUM tAUTONUM_PLUS tAUTONUM_MINUS iHmCtyp iHmWtyp iBkinkat
                    Date    zVALUE_DATE dourdate drialdate
                
                    String tCTYPKIN_CODE tWTYPKIN_CODE tYEAR_RECR tCTYPKIN_RECR tWTYPKIN_RECR
                    String tPTYPPAR_CODE tPTYPPAR_DESCR tPTYPPAR_IS_WHAT tPTYPPAR_MODULE SysBetoSite
                    String tPTYPPAR_ABREV tPSEIRA_SEIRA tPSEIRA_PRINTER tPSEIRA_FORM sCurrentXrhsh
                
                    String uHMGIO_CODE uCTYPKIN_RECR uCTYPKIN_CODE uWTYPKIN_RECR uWTYPKIN_CODE
                    string saapar sarmod sorder1 saaparprom stropos showpay sitem sclientitem
                    number nqty nunit ndisc nfpa nnet nextra ntotal nposodtl nqtydtl
                    integer ifinish iokey iakyrh istatus
                    number npcdisc npcfpa nkposothta nkposo nkfpa nknet nrialqty nypolqty
                    number nakyrhqty nepistrofhqty
                    string spmovesrecr swaxrecr sirec0 srecr clorderdrecr
                
                    move (the_table(dbTabPageSubS3(dbTabDialogSubS1(self)))) to igridid
                    Get Checked_State Of chkCtypkin     to iCtypkin
                    Get Checked_State Of chkBtypkin     to iBtypkin
                    Get Checked_State Of chkWtypkin     to iWtypkin
                    Get Checked_State Of chkClient      to iClient
                    Get Checked_State Of chkBaxio       to iBaxio
                    Get Checked_State Of chkPtyppar     to iPtyppar
                    Get Checked_State Of chkWitemx      to iWitemx
                    Get Checked_State Of chkHmCtyp      to iHmCtyp
                    Get Checked_State Of chkHmWtyp      to iHmWtyp
                    Get Checked_State Of chkBkinkat     to iBkinkat
                    Get Checked_State Of chkWax         to iWax
                    Get Checked_State Of chkclorder     to iclorder
                    Get Checked_State Of chkForce       to iForce
                
                    Get Value Of frmYear Item 0 to sYear_Anaforas
                    Move (trim(sYear_Anaforas)) to sYear_Anaforas
                
                
                    Move (Trim(SysCurXr.Company_Code))  to SysCompany
                    Move (Trim(SysCurXr.Branch_Code))   to SysBranch
                    Move (Trim(SysCurXr.Year_Year))     to SysYear
                    Move (Trim(SysCurXr.Year_Recr))     to SysYearRecr
                    Move (Trim(SysCurXr.Beto_Site))     to SysBetoSite
                
                    Get psCurXr to sCurrentXrhsh
                    Move (Trim(sCurrentXrhsh)) to sCurrentXrhsh
                
                    Move 0 to iLastYear
                
                    //  1. ë¨¢¢¶ö„ ©´¶†ÆúÂ‡§ ßò¢ò†·™ Æ®„©û™
                    Move Company_DD                                                     to liCompanyDD
                    Move Branch_DD                                                      to liBranchDD
                    Move Year_DD                                                        to liYearDD
                
                    Get Field_Current_Value of liCompanyDD Field Company.Company_Code   to sCompany_Code
                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code     to sBranch_Code
                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site       to sBeto_Site
                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site     to sSite
                    Get Field_Current_Value of liYearDD    Field Year.Year_Year         to iYear
                    Get Field_Current_Value of liYearDD    Field Year.Year_Recr         to sYearRecr
                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0      to sNom1
                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00     to sNom2
                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR      to sNom3
                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name   to sCname
                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name     to sBname
                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr        to sYname
                
                    Move 0 to isNewBranch
                
                    If (sYear_Anaforas='') Begin
                        // Ñ§´¶ß†©£Ê™ ´ú¢ú¨´òÂò™ Æ®„©û™ †õÂò™ Company+Branch
                        // An õú§ ô®úÂ™ õú§ úÆú†™ ´†ß¶´ò §ò ò§´†ö®òØú†™
                        Send Clear to Year_DDR
                        Move sCompany_Code   to Year.Company_Code
                        Move sBranch_Code    to Year.Branch_Code
                        Move 2500            to Year.Year_Year
                        Send Find to Year_DDR LE 1 // Company_Code+Branch_Code+Year_Year
                        If ((Found=1) And (sCompany_Code=Year.Company_Code) And (sBranch_Code=Year.Branch_Code)) Begin
                            Get Field_Current_Value of Year_DDR     Field Year.Year_Year    to iLastYear
                            Get Field_Current_Value of Year_DDR     Field Year.Year_Recr    to SysYearRecr
                            Get Field_Current_Value of Branch_DDR   Field Branch.Beto_Site  to SysBetoSite
                            Move iLastYear      to SysYear
                            Move sCompany_Code  to SysCompany
                            Move sBranch_Code   to SysBranch
                        End
                        Else Begin
                            If ((Found=1) And (sCompany_Code=Year.Company_Code)) Begin
                                Move '‡'    to Year.Branch_Code
                                Move 2500   to Year.Year_Year
                                Send Find to Year_DDR LE 1 // Company_Code+Branch_Code+Year_Year
                                If ((Found=1) And (sCompany_Code=Year.Company_Code)) Begin
                                    Get Field_Current_Value of Year_DDR     Field Year.Company_Code to SysCompany
                                    Get Field_Current_Value of Year_DDR     Field Year.Branch_Code  to SysBranch
                                    Get Field_Current_Value of Year_DDR     Field Year.Year_Year    to SysYear
                                    Get Field_Current_Value of Year_DDR     Field Year.Year_Recr    to SysYearRecr
                                    Get Field_Current_Value of Branch_DDR   Field Branch.Beto_Site  to SysBetoSite
                                End
                                Else Begin
                                End
                            End
                            Else Begin
                            End
                        End
                    End
                    Else Begin
                        Move sYear_Anaforas to iLastYear
                    End
                
                
                
                    Forward Get row_save to rVal
                
                
                    If (Not(rVal)) Begin
                
                
                        //  2. ë¨¢¢¶ö„ ©´¶†ÆúÂ‡§ å‚ò™ ï®„©û™
                        Get Field_Current_Value of liCompanyDD Field Company.Company_Code   to sCompany_Code
                        Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code     to sBranch_Code
                        Get Field_Current_Value of liYearDD    Field Year.Year_Year         to iYear
                        Get Field_Current_Value of liYearDD    Field Year.Year_Recr         to sYearRecrNew
                //                    Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site       to sBeto_Site
                //                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site     to sSite
                //                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0      to sNom1
                //                    Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00     to sNom2
                //                    Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR      to sNom3
                //                    Get Field_Current_Value of liCompanyDD Field Company.Company_Name   to sCname
                //                    Get Field_Current_Value of liBranchDD  Field Branch.Branch_name     to sBname
                //                    Get Field_Current_Value of liYearDD    Field Year.Year_Descr        to sYname
                
                        //////////////////////////////////////////////////////////////
                        // Ä§ õú§ ¨ß·®Æú† iLastYear ©û£òÂ§ú† ß‡™ õú§ ô®‚üû°ú úöö®ò≠„
                        // ß®¶ûö¶Á£ú§û™ Æ®„©û™ òß¶ ò¨´„ ß¶¨ °ò´òÆ‡®úÂ´ò† ´È®ò
                        // ¶ßÊ´ú õú§ úÆú† ´†ß¶´ò §ò ò§´†ö®·Øú†
                
                        // Ä¢¢†È™ û £ú´òô¢û´û iLastYear ßú®†úÆú† ´¶ ú´¶™ òß¶ ´¶ òß¶†¶ ò§´†ö®ò≠¶¨£ú
                        //    °ò† û £ú´òô¢û´û iYear     ßú®†úÆú† ´¶ ú´¶™ ©´¶ ¶ß¶†¶ ò§´†ö®ò≠¶¨£ú
                
                        If (Not(iLastYear))     Procedure_Return
                      // georg 18/10/01
                      // ¶´ò§ £ú´ò≠ú®¶¨£ú °†§„©ú†™ ©ú ò¢¢¶ ¨ß¶°ò´·©´û£ò £ò™ °¶ôú†
                      //  If (iLastYear=iYear)    Procedure_Return
                
                        //////////////////////////////////////////////////////////////
                
                            // Éû£†¶¨®öÂò §‚¶¨ record SysCurXr
                            Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
                
                            Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site     to gs_Selected_Beto_Site
                
                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to sSite
                            Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
                            Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to sYearRecr
                            Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
                            Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
                            Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
                
                            Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
                            Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
                            Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
                
                            Reread SysCurXR
                            Move gs_Selected_Company_Code   to SysCurXR.Company_Code
                            Move gs_Selected_beto_site      to SysCurXR.beto_site
                            Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
                            Move gi_Selected_Year           to SysCurXR.Year_Year
                            Move sYearRecr                  to SysCurXR.Year_Recr
                            Move sSite                      to SysCurXR.Branch_Site
                
                            Move sCname                     to SysCurXR.Company_Name
                            Move sBname                     to SysCurXR.Branch_Name
                            Move sYname                     to SysCurXR.Year_Descr
                
                            Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
                            Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
                
                            Move  (Trim(sNom1))             to SysCurXR.C_Code0
                            Move  (Trim(sNom2))             to SysCurXR.C_Code00
                            Move  (Trim(sNom3))             to SysCurXR.C_CodeR
                
                            Saverecord SysCurXR
                            Unlock
                
                
                
                           If (iclorder) Begin
                              Send Clear          to clorder_DD
                              Move sCompany_Code  to clorder.Company_Code
                              Move sBranch_Code   to clorder.Branch_Code
                              Move iLastYear      to clorder.Year_Year
                              Send Find To clorder_DD Gt 1 //Comp+branch+year+clients_code+aapar
                              while (found=1)
                                   Get Field_Current_value Of clorder_DD Field clorder.recr    to srr
                                   if    ((clorder.rial_date='') ;
                                   and  (sCompany_Code=clorder.Company_Code)   ;
                                   and (sBranch_Code=clorder.Branch_Code)     ;
                                   and (iLastYear=clorder.Year_Year)) begin
                                    Set Label Of txtM1 to 'clorder'
                                    Set Label Of txtM2 to clorder.aapar
                                    Get Field_Current_value Of clorder_DD Field clorder.recr    to srr
                                    set psrecr to srr
                                    Get Field_Current_value Of clorder_DD Field clorder.aapar          to saapar
                                    Get Field_Current_Value Of clorder_DD Field clorder.clients_code   to scode
                                    Get Field_Current_Value Of clorder_DD Field clorder.armod          to sarmod
                                    Get Field_Current_Value Of clorder_DD Field clorder.order1_recr    to sorder1
                                    Get Field_Current_Value Of clorder_DD Field clorder.our_date       to dourdate
                                    Get Field_Current_Value Of clorder_DD Field clorder.rial_date      to drialdate
                                    Get Field_Current_Value Of clorder_DD Field clorder.qty            to nqty
                                    Get Field_Current_Value Of clorder_DD Field clorder.unitprice      to nunit
                                    Get Field_Current_Value Of clorder_DD Field clorder.disc           to ndisc
                                    Get Field_Current_Value Of clorder_DD Field clorder.fpa            to nfpa
                                    Get Field_Current_Value Of clorder_DD Field clorder.net            to nnet
                                    Get Field_Current_Value Of clorder_DD Field clorder.extra          to nextra
                                    Get Field_Current_Value Of clorder_DD Field clorder.total          to ntotal
                                    Get Field_Current_Value Of clorder_DD Field clorder.aaparprom      to saaparprom
                                    Get Field_Current_Value Of clorder_DD Field clorder.tropos         to stropos
                                    Get Field_Current_Value Of clorder_DD Field clorder.date           to ddate
                                    Get Field_Current_Value Of clorder_DD Field clorder.how_pay        to showpay
                                    Get Field_Current_Value Of clorder_DD Field clorder.finish         to ifinish
                                    Get Field_Current_Value Of clorder_DD Field clorder.okey           to iokey
                                    Get Field_Current_Value Of clorder_DD Field clorder.akyrh          to iakyrh
                                    Get Field_Current_Value Of clorder_DD Field clorder.posodtl        to nposodtl
                                    Get Field_Current_Value Of clorder_DD Field clorder.qtydtl         to nqtydtl
                                    Get Field_Current_Value Of clorder_DD Field clorder.nomisma        to snom1
                                    Get Field_Current_Value Of clorder_DD Field clorder.module         to smodule
                                    Send Clear to clorder_DD2
                                    Move sCompany_Code  to clorder.Company_Code
                                    Move sBranch_Code   to clorder.Branch_Code
                                    Move iYear          to clorder.Year_Year
                                    Move sCode          to clorder.clients_Code
                                    move saapar         to clorder.aapar
                                    Send Find to clorder_DD2 Eq 1
                                    If (NOT(Found)) Begin
                                        move scode to clients.client_id
                                        send find to clients_dd2 eq 6
                                        Set Field_Changed_Value Of clorder_DD2 Field clorder.Company_Code   to sCompany_Code
                                        Set Field_Changed_Value Of clorder_DD2 Field clorder.Branch_Code    to sBranch_Code
                                        Set Field_Changed_Value Of clorder_DD2 Field clorder.Year_Year      to iYear
                                        set Field_changed_value Of clorder_DD2 Field clorder.aapar          to saapar
                                        set Field_changed_Value Of clorder_DD2 Field clorder.clients_code   to scode
                                        set Field_changed_Value Of clorder_DD2 Field clorder.armod          to sarmod
                                        set Field_changed_Value Of clorder_DD2 Field clorder.order1_recr    to sorder1
                                        set Field_changed_Value Of clorder_DD2 Field clorder.our_date       to dourdate
                                        set Field_changed_Value Of clorder_DD2 Field clorder.rial_date      to drialdate
                                        set Field_changed_Value Of clorder_DD2 Field clorder.qty            to nqty
                                        set Field_changed_Value Of clorder_DD2 Field clorder.unitprice      to nunit
                                        set Field_changed_Value Of clorder_DD2 Field clorder.disc           to ndisc
                                        set Field_changed_Value Of clorder_DD2 Field clorder.fpa            to nfpa
                                        set Field_changed_Value Of clorder_DD2 Field clorder.net            to nnet
                                        set Field_changed_Value Of clorder_DD2 Field clorder.extra          to nextra
                                        set Field_changed_Value Of clorder_DD2 Field clorder.total          to ntotal
                                        set Field_changed_Value Of clorder_DD2 Field clorder.aaparprom      to saaparprom
                                        set Field_changed_Value Of clorder_DD2 Field clorder.tropos         to stropos
                                        set Field_changed_Value Of clorder_DD2 Field clorder.date           to ddate
                                        set Field_changed_Value Of clorder_DD2 Field clorder.how_pay        to showpay
                                        set Field_changed_Value Of clorder_DD2 Field clorder.finish         to ifinish
                                        set Field_changed_Value Of clorder_DD2 Field clorder.okey           to iokey
                                        set Field_changed_Value Of clorder_DD2 Field clorder.akyrh          to iakyrh
                                        set Field_changed_Value Of clorder_DD2 Field clorder.posodtl        to nposodtl
                                        set Field_changed_Value Of clorder_DD2 Field clorder.qtydtl         to nqtydtl
                                        set Field_changed_Value Of clorder_DD2 Field clorder.nomisma        to snom1
                                        set Field_changed_Value Of clorder_DD2 Field clorder.module         to smodule
                                        reread sysrecc
                                        if (smodule = '01') begin
                                           move (sysrecc.clorderc_rec0 + 1) to sirec0
                                           move sirec0 to sysrecc.clorderc_rec0
                                           saverecord sysrecc
                                        end
                                        else begin
                                           move (sysrecc.clorder_rec0 + 1) to sirec0
                                           move sirec0 to sysrecc.clorder_rec0
                                           saverecord sysrecc
                                        end
                                        unlock
                                        set Field_changed_Value Of clorder_DD2 Field clorder.rec0 to sirec0
                                        Move (Append('',((Trim(SysCurXR.Branch_Site))+;
                                            (Trim(String(sirec0)))))) to sirec0
                                        set Field_changed_Value Of clorder_DD2 Field clorder.recr to sirec0
                                        send request_save to clorder_dd2
                                        send rebuild_constraints to clorderd_dd
                                        send find to clorderd_dd first_record 1
                                        while (found=1)
                                              Get Field_Current_value Of clorderd_DD Field clorderd.recr           to clorderdrecr
                                              Get Field_Current_value Of clorderd_DD Field clorderd.aa_par         to saapar
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.clients_code   to scode
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.item_code      to sitem
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.client_item    to sclientitem
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.pcdisc         to npcdisc
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.pcfpa          to npcfpa
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.ourdate        to dourdate
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.rial_date      to drialdate
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.qty            to nqty
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.unitprice      to nunit
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.posodisc       to ndisc
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.posofpa        to nfpa
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.net            to nnet
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.posoextra      to nextra
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.posototal      to ntotal
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.kinish_posothta to nkposothta
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.kinhsh_poso    to nkposo
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.date           to ddate
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.kinhsh_fpa     to nkfpa
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.finish         to ifinish
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.kinhsh_net     to nknet
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.akyrh          to iakyrh
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.rial_qty       to nrialqty
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.ypol_qty       to nypolqty
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.akyrh_qty      to nakyrhqty
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.epistrofh_qty  to nepistrofhqty
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.status         to istatus
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.pmoves_recr    to spmovesrecr
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.wax_recr       to swaxrecr
                                              Get Field_Current_Value Of clorderd_DD Field clorderd.module         to smodule
                                              send clear to wax_ddr
                                              move swaxrecr to wax.wax_recr
                                              send find to wax_ddr eq 2
                                              if (found=1) begin
                                                  Get Field_Current_Value Of wax_ddr Field wax.wapokat_code  to wwapokat_code
                                                  Get Field_Current_Value Of wax_ddr Field wax.wapomast_code to wwapomast_code
                                                  Get Field_Current_Value Of wax_ddr Field wax.wax_code      to wwax_code
                                                  send clear to wax_ddr
                                                  Move sCompany_Code  to wax.Company_Code
                                                  Move sBranch_Code   to wax.Branch_Code
                                                  Move iYear          to wax.Year_Year
                                                  move wwapokat_code  to wax.wapokat_code
                                                  move wwapomast_code to wax.wapomast_code
                                                  Move iYear          to wax.wax_code
                                                  send find to wax_ddr eq 1
                                                  if (found=1) Get Field_Current_Value Of wax_ddr Field wax.wax_recr to swaxrecr
                                              end
                                              Send Clear to clorderd_DD2
                                              set Field_changed_value Of clorderd_DD2 Field clorderd.company_code   to sCompany_Code
                                              set Field_changed_value Of clorderd_DD2 Field clorderd.branch_code    to sBranch_Code
                                              set Field_changed_value Of clorderd_DD2 Field clorderd.year_year      to iYear
                                              set Field_changed_value Of clorderd_DD2 Field clorderd.aa_par         to saapar
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.clients_code   to scode
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.item_code      to sitem
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.client_item    to sclientitem
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.pcdisc         to npcdisc
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.pcfpa          to npcfpa
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.ourdate        to dourdate
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.rial_date      to drialdate
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.qty            to nqty
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.unitprice      to nunit
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.posodisc       to ndisc
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.posofpa        to nfpa
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.net            to nnet
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.posoextra      to nextra
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.posototal      to ntotal
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.kinish_posothta to nkposothta
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.kinhsh_poso    to nkposo
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.date           to ddate
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.kinhsh_fpa     to nkfpa
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.finish         to ifinish
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.kinhsh_net     to nknet
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.akyrh          to iakyrh
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.rial_qty       to nrialqty
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.ypol_qty       to nypolqty
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.akyrh_qty      to nakyrhqty
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.epistrofh_qty  to nepistrofhqty
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.status         to istatus
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.pmoves_recr    to spmovesrecr
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.wax_recr       to swaxrecr
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.module         to smodule
                                              reread sysrecc
                                              if (smodule = '01') begin
                                                 move (sysrecc.clorderdc_rec0 + 1) to sirec0
                                                 move sirec0 to sysrecc.clorderdc_rec0
                                                 saverecord sysrecc
                                              end
                                              else begin
                                                 move (sysrecc.clorderd_rec0 + 1) to sirec0
                                                 move sirec0 to sysrecc.clorderd_rec0
                                                 saverecord sysrecc
                                              end
                                              unlock
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.rec0 to  sirec0
                                              Move (Append('',((Trim(SysCurXR.Branch_Site))+;
                                                   (Trim(String(sirec0)))))) to sirec0
                                              set Field_changed_Value Of clorderd_DD2 Field clorderd.recr to  sirec0
                                              send request_save to clorderd_dd2
                                         send clear to clorderd_dd
                                         move clorderdrecr to clorderd.recr
                                         send find to clorderd_dd eq 2
                                         send find to clorderd_dd gt 1
                                         loop
                                      end
                                   end
                
                                Move sRR to clorder.recr
                                Send Find to clorder_DD eq 2
                                Send Find To clorder_DD Gt 1 //Comp+branch+year+clients_code+aapar
                                Loop
                            End // If (iclorder)
                
                
                
                        // Ñßò§ò≠¶®· ´®‚Æ¶¨©ò™ Æ®„©û™
                        If  (Trim(sCurrentXrhsh)<>'') Begin
                            Send Clear to Year_DDR
                            Move sCurrentXrhsh   to Year.Year_Recr
                            Send Find to Year_DDR Eq 2
                            If (Found) Begin
                                // Ñßò§ò≠¶®·  record SysCurXr
                                Get Field_Current_Value of Company_DDR Field Company.Company_Code to gs_Selected_Company_Code
                                Get Field_Current_Value of Company_DDR Field Company.Company_Name to sCname
                                Get Field_Current_Value of Branch_DDR  Field Branch.Branch_Code   to gs_Selected_Branch_Code
                                Get Field_Current_Value of Branch_DDR  Field Branch.Beto_Site     to gs_Selected_Beto_Site
                                Get Field_Current_Value of Branch_DDR  Field Branch.Branch_Site   to sSite
                                Get Field_Current_Value of Branch_DDR  Field Branch.Branch_name   to sBname
                                Get Field_Current_Value of Year_DDR    Field Year.Year_Year       to gi_Selected_Year
                                Get Field_Current_Value of Year_DDR    Field Year.Year_XrhshFrom  to ldYearXrhsh_From
                                Get Field_Current_Value of Year_DDR    Field Year.Year_XrhshTo    to ldYearXrhsh_To
                                Get Field_Current_Value of Year_DDR    Field Year.Year_Recr       to sYearRecr
                                Get Field_Current_Value of Year_DDR    Field Year.Year_C_Code0    to sNom1
                                Get Field_Current_Value of Year_DDR    Field Year.Year_C_Code00   to sNom2
                                Get Field_Current_Value of Year_DDR    Field Year.Year_C_CodeR    to sNom3
                                Get Field_Current_Value of Year_DDR    Field Year.Year_Descr      to sYname
                                Reread SysCurXR
                                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
                                Move gs_Selected_beto_site      to SysCurXR.beto_site
                                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
                                Move gi_Selected_Year           to SysCurXR.Year_Year
                                Move sYearRecr                  to SysCurXR.Year_Recr
                                Move sSite                      to SysCurXR.Branch_Site
                                Move sCname                     to SysCurXR.Company_Name
                                Move sBname                     to SysCurXR.Branch_Name
                                Move sYname                     to SysCurXR.Year_Descr
                                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
                                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
                                Move  (Trim(sNom1))             to SysCurXR.C_Code0
                                Move  (Trim(sNom2))             to SysCurXR.C_Code00
                                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
                                Saverecord SysCurXR
                                Unlock
                            End
                        End
                    End
                    send info_box "Ü õ†òõ†°ò©Âò ò§¶Âö£ò´¶™ Æ®„©û™ ´ú¢úÂ‡©ú.\nè®Â§ ©¨§úÆÂ©ú´ú, °¢úÂ©´ú ´û§ ú≠ò®£¶ö„ °ò† •ò§ò£ßúÂ´ú" 'è¢û®¶≠¶®Âò'
                    Set Label Of txtM1 to ''
                    Set Label Of txtM2 to ''
                
                //            Move (Close_all_Views(Self,False)) to Rval1
                //            If (Not(rVal1)) Begin
                //                Send Allaxe_Xrhsh
                //                Send Activate to (Main_Menu(Self))
                //            End
                    Function_Return rVal
                End_Function
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                //AB-StoreEnd

            End_Object    // The_Table

            Object TextBoxSub24 is a TextBoxSub
                Set Label to "ë´¶ ·§¶†ö£ò §‚ò™ Æ®„©û™ §ò £ú´ò≠ú®ü¶Á§ ¶† ò°Ê¢¶¨üú™ úöö®ò≠‚™ "
                Set TextColor to clRed
                Set Location to 122 3
                Set Size to 10 239
                Set FontWeight to 600
            End_Object    // TextBoxSub24

            Object chkCtypkin is a CheckBoxSub
                Set Label to "Ctypkin+Cflagkin"
                Set Size to 10 69
                Set Location to 137 3
            End_Object    // chkCtypkin

            Object chkPtyppar is a CheckBoxSub
                Set Label to "Ptyppar"
                Set Size to 10 41
                Set Location to 150 3
            End_Object    // chkPtyppar

            Object chkForce is a CheckBoxSub
                Set Label to "Forced Update"
                Set Size to 10 64
                Set Location to 168 3
            End_Object    // chkForce

            Object txtM1 is a TextBoxSub
                Set Label to "txtM1"
                Set Location to 184 3
                Set Size to 10 58

                //AB-StoreStart
                Set label to ''
                
                //AB-StoreEnd

            End_Object    // txtM1

            Object txtM2 is a TextBoxSub
                Set Label to "txtM2"
                Set Location to 184 69
                Set Size to 10 81

                //AB-StoreStart
                Set label to ''
                
                //AB-StoreEnd

            End_Object    // txtM2

            Object chkBtypkin is a CheckBoxSub
                Set Label to "Btypkin+Bflagkin"
                Set Size to 10 69
                Set Location to 137 79
            End_Object    // chkBtypkin

            Object chkWitemx is a CheckBoxSub
                Set Label to "Witemx"
                Set Size to 10 40
                Set Location to 150 79
            End_Object    // chkWitemx

            Object chkWtypkin is a CheckBoxSub
                Set Label to "Wtypkin+Wflagkin"
                Set Size to 10 75
                Set Location to 137 155
            End_Object    // chkWtypkin

            Object chkWax is a CheckBoxSub
                Set Label to "Wax"
                Set Size to 10 31
                Set Location to 150 155
            End_Object    // chkWax

            Object chkClient is a CheckBoxSub
                Set Label to "Clients"
                Set Size to 10 37
                Set Location to 137 241
            End_Object    // chkClient

            Object chkBaxio is a CheckBoxSub
                Set Label to "Baxio"
                Set Size to 10 34
                Set Location to 150 241
            End_Object    // chkBaxio

            Object chkHmCtyp is a CheckBoxSub
                Set Label to "HmCtyp"
                Set Size to 10 41
                Set Location to 137 297
            End_Object    // chkHmCtyp

            Object TextBoxSub27 is a TextBoxSub
                Set Label to "Ñ´¶™ Ä§ò≠¶®·™"
                Set Location to 122 297
                Set Size to 10 54
            End_Object    // TextBoxSub27

            Object frmYear is a FormSub
                Set Size to 13 23
                Set Location to 121 355
                Set Label_Col_Offset to 2
            End_Object    // frmYear

            Object chkBkinKat is a CheckBoxSub
                Set Label to "Bkinkat"
                Set Size to 10 41
                Set Location to 137 355
            End_Object    // chkBkinKat

            Object chkHmWtyp is a CheckBoxSub
                Set Label to "HmWtyp"
                Set Size to 10 44
                Set Location to 150 297
            End_Object    // chkHmWtyp

            Object TextBoxSub32 is a TextBoxSub
                Set Label to "â‡õ†°Ê™ ìß¶°ò´.:     "
                Set Auto_Size_State to FALSE
                Set TextColor to clNavy
                Set FontSize to 4 0
                Set Location to 7 15
                Set Size to 10 60
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub32

            Object Company_Company_Code is a dbFormSub
                Entry_Item Branch.Branch_code
                Set Server to (Branch_DD(self))
                Set Size to 13 66
                Set Location to 6 77
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right

                //AB-StoreStart
                Set Prompt_Object to (sl002(Current_object))
                //AB-StoreEnd

            End_Object    // Company_Company_Code

            Object TextBoxSub33 is a TextBoxSub
                Set Label to "é§¶£ò©Âò :"
                Set Auto_Size_State to FALSE
                Set TextColor to clNavy
                Set FontSize to 4 0
                Set Location to 22 15
                Set Size to 10 55
                Set Justification_Mode to jMode_Left
                Set TypeFace to "MS Sans Serif"
                Set Enabled_State to TRUE
            End_Object    // TextBoxSub33

            Object Company_Company_Name is a dbFormSub
                Entry_Item Branch.Branch_name
                Set Server to (Branch_DD(self))
                Set Size to 13 285
                Set Location to 22 77
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right

                //AB-StoreStart
                Set Prompt_Object to (sl001(Current_object))
                //AB-StoreEnd

            End_Object    // Company_Company_Name

            Object chkclorder is a CheckBoxSub
                Set Label to "Clorder"
                Set Size to 10 39
                Set Location to 150 355
            End_Object    // chkclorder


            //AB-StoreStart
            Set label to 'ï®„©ú†™ / Ñ´ò†®úÂò'
            //AB-StoreEnd

        End_Object    // dbTabPageSubS3


        //AB-StoreStart
        Set Label to "ë´¶†ÆúÂò Ñ´ò†®Âò™"
        
        //AB-StoreEnd

    End_Object    // dbTabDialogSubS1

    Object TextBoxSub1 is a TextBoxSub
        Set Label to "â‡õ†°Ê™ Ñ´ò†®Âò™:     "
        Set Auto_Size_State to FALSE
        Set TextColor to clNavy
        Set FontSize to 4 0
        Set Location to 7 15
        Set Size to 10 60
        Set Justification_Mode to jMode_Left
        Set TypeFace to "MS Sans Serif"
        Set Enabled_State to TRUE
    End_Object    // TextBoxSub1

    Object TextBoxSub2 is a TextBoxSub
        Set Label to "é§¶£ò©Âò :"
        Set Auto_Size_State to FALSE
        Set TextColor to clNavy
        Set FontSize to 4 0
        Set Location to 22 15
        Set Size to 10 55
        Set Justification_Mode to jMode_Left
        Set TypeFace to "MS Sans Serif"
        Set Enabled_State to TRUE
    End_Object    // TextBoxSub2

    Object dbBitmap3 is a dbBitmap
        Entry_Item Company.Company_bitmap
        Set Border_Style to Border_Normal
        Set Size to 46 80
        Set Location to 2 431
        Set Bitmap_Style to Bitmap_Stretch

        //AB-StoreStart
        set Store_With_Pathname_State to true
        //AB-StoreEnd

    End_Object    // dbBitmap3


    //AB-StoreStart
    Set Verify_Exit_Msg To Get_No_Confirmation
    Procedure Activate_View Returns Integer
        Integer rVal igridid
        String sCurrentXrhsh
        Forward Get Msg_Activate_View to rVal
        move (the_table(dbTabPageSubS3(dbTabDialogSubS1(self)))) to igridid
        Set Checked_State Of (chkClient(igridid)) to (SysrecC.Constr_Clients='1')
        Set Enabled_State Of (chkClient(igridid)) to (SysrecC.Constr_Clients='1')
        Get Field_Current_Value Of SysCurXr_DD Field SysCurXr.Year_Recr  to sCurrentXrhsh
        set value of (frmyear(dbTabPageSubS3(dbTabDialogSubS1(self)))) to syscurxr.year_year
        Set psCurXr to sCurrentXrhsh
        Procedure_return rVal
    End_Procedure
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    //AB-StoreEnd

End_Object    // V3t


//AB-StoreStart
                    
                    
                    
                    
                    
//AB-StoreEnd

//AB/ End_Object    // prj
