Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\enhmerga.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>Use Workspc.pkg
30325>
30325>//  Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>
30341>>>
30341>>>Type PEWindowOptions
30341>>>  Field PEWindowOptions.StructSize As Word
30341>>>  Field PEWindowOptions.hasGroupTree As Word
30341>>>  Field PEWindowOptions.canDrillDown As Word
30341>>>  Field PEWindowOptions.hasNavigationControls As Word
30341>>>  Field PEWindowOptions.hasCancelButton As Word
30341>>>  Field PEWindowOptions.hasPrintButton As Word
30341>>>  Field PEWindowOptions.hasExportButton As Word
30341>>>  Field PEWindowOptions.hasZoomControl As Word
30341>>>  Field PEWindowOptions.hasCloseButton As Word
30341>>>  Field PEWindowOptions.hasProgressControls As Word
30341>>>  Field PEWindowOptions.hasSearchButton As Word
30341>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30341>>>  Field PEWindowOptions.hasRefreshButton As Word
30341>>>End_Type // PEWindowOptions
30341>>>
30341>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30342>>>
30342>>>Class CrystalReportSubSQL Is A CrystalReport
30343>>>
30343>>>    Procedure Construct_Object
30344>>>        Forward send Construct_Object
30346>>>        // Everything on except hasGroupTree by default
30346>>>        property integer hasGroupTree 0
30347>>>        property integer canDrillDown 1
30348>>>        property integer hasNavigationControls 1
30349>>>        property integer hasCancelButton 1
30350>>>        property integer hasPrintButton 1
30351>>>        property integer hasExportButton 1
30352>>>        property integer hasZoomControl 1
30353>>>        property integer hasCloseButton 1
30354>>>        property integer hasProgressControls 1
30355>>>        property integer hasSearchButton 1
30356>>>        property integer hasPrintSetupButton 1
30357>>>        property integer hasRefreshButton 1
30358>>>
30358>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30359>>>    End_Procedure // Construct_Object
30360>>>
30360>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30361>>>        Integer iPrintJob iResult
30362>>>        String sPEWindowOptions
30362>>>        Pointer pPeWindowOptions
30362>>>
30362>>>        Get PrintJob To iPrintJob
30363>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30364>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30365>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30366>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30367>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30368>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30369>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30370>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30371>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30372>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30373>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30374>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30375>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30376>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30377>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30378>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30379>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30381>>>    End_Procedure // OutputToWindow
30382>>>
30382>>>    Procedure Set TmpFileDir String aDir
30383>>>        String lsCurrWspc lsDir
30384>>>
30384>>>//        If (ghoWorkSpace <> 0) Begin
30384>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30384>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30384>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30384>>>//            Set Report_Data_Path to lsDir
30384>>>//        End
30384>>>    End_Procedure
30385>>>
30385>>>    Procedure DoWinQLReport
30386>>>        // This can be used when reports must be able to run in different data directories
30386>>>        Set TmpFileDir to "TmpFileDir"
30387>>>        Forward Send DoWinQLReport
30389>>>    End_Procedure
30390>>>
30390>>>
30390>>>    // This hook procedure is called after the print job has been opened.
30390>>>
30390>>>    Procedure OnInitializeReport000
30391>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30391>>>
30391>>>        Integer iTables iMax iCount iType
30392>>>        String  sLocation sLocation2 sPath DirSep
30392>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30392>>>
30392>>>//        Open Sysfile
30392>>>
30392>>>        String  sActualSQL
30392>>>        String  sActualTemp
30392>>>        String  sOldSQL
30392>>>        String  sOldTemp
30392>>>        String  sServerName
30392>>>        String  sDatabaseName
30392>>>        String  sUserID
30392>>>
30392>>>//        Move Sysfile.ActualSQL      to sActualSQL
30392>>>//        Move Sysfile.ActualTemp     to sActualTemp
30392>>>//        Move Sysfile.OldSQL         to sOldSQL
30392>>>//        Move Sysfile.OldTemp        to sOldTemp
30392>>>//        Move Sysfile.cServerName    to sServerName
30392>>>//        Move Sysfile.cDatabaseName  to sDatabaseName
30392>>>//        Move Sysfile.cUserID        to sUserID
30392>>>
30392>>> //       Move 'SMS'                 to sOldSQL
30392>>> //       Move 'C:\Dns_tmp\'         to sOldTemp
30392>>> //       Move 'SMSMET'        to sActualSQL      // Database
30392>>> //       Move 'C:\Dns_tmp\'         to sActualTemp
30392>>> //      Move 'SMSMET'        to sServerName    // ODBC
30392>>> //       Move 'SMSMET'        to sDatabaseName  // DataBase
30392>>>     //   Move 'sa'               to sUserID
30392>>>
30392>>>        Move 'SMS'                 to sOldSQL
30393>>>        Move 'C:\Dns_tmp\'         to sOldTemp
30394>>>        Move 'SMSTITAN'            to sActualSQL      // Database
30395>>>        Move 'C:\Dns_tmp\'         to sActualTemp
30396>>>        Move 'SMSTITAN'            to sServerName    // ODBC
30397>>>        Move 'SMSTITAN'            to sDatabaseName  // DataBase
30398>>>
30398>>>
30398>>>        Move (Trim(sActualSQL   )) to sActualSQL
30399>>>        Move (Trim(sActualTemp  )) to sActualTemp
30400>>>        Move (Trim(sOldSQL      )) to sOldSQL
30401>>>        Move (Trim(sOldTemp     )) to sOldTemp
30402>>>        Move (Trim(sServerName  )) to sServerName
30403>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30404>>>        Move (Trim(sUserID      )) to sUserID
30405>>>
30405>>>
30405>>>        Forward Send OnInitializeReport
30407>>>
30407>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30408>>>        Get NTables To iMax
30409>>>        Decrement iMax
30410>>>        Get Report_Data_Path                                    To sPath
30411>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30414>>>        For iCount From 0 To iMax
30420>>>>
30420>>>            Get NthTableLocation iCount         To sLocation
30421>>>            Get Report_Base_File_Name sLocation To sLocation2
30422>>>            Get NthTableDBType           iCount to iType
30423>>>
30423>>>            // An einai type 1 topiko
30423>>>            //               2=SQL
30423>>>            If (iType=2) Begin
30425>>>                If (sLocation contains sOldSQL) Begin
30427>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30428>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30429>>>                End
30429>>>>
30429>>>            End
30429>>>>
30429>>>            Else If (iType=1) Begin
30432>>>                If (sLocation contains sOldTemp) Begin
30434>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30435>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30436>>>                End
30436>>>>
30436>>>            End
30436>>>>
30436>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30437>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30438>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30439>>>        Loop // For iCount From 0 To iMax
30440>>>>
30440>>>
30440>>>    End_Procedure // OnInitializeReport
30441>>>
30441>>>
30441>>>//                Showln '--------------------------------------------------------'
30441>>>//                Showln iCount
30441>>>//                Showln sLocation
30441>>>//                Showln sPath
30441>>>//                Showln sLocation2
30441>>>//                Showln iType
30441>>>
30441>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30441>>>                  //Set Report_Data_Path to ''
30441>>>                  //Get NthTableDBType              iCount to iType
30441>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30441>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30441>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30441>>>                  //Get NthTableLocation iCount                 To sMyLocation
30441>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30441>>>                  //Showln sMyLocation
30441>>>                  //Set NthTableLocation            iCount To sMyLocation
30441>>>                //End
30441>>>
30441>>>
30441>>>
30441>>>    // This hook procedure is called just before a print job is closed.
30441>>>    Procedure OnDeInitializeReport
30442>>>        Forward Send OnDEInitializeReport
30444>>>    End_Procedure // OnDeInitializeReport
30445>>>
30445>>>    // This hook procedure is called just before a the print job is started.
30445>>>    Procedure OnStartPrinting
30446>>>        Forward Send OnStartPrinting
30448>>>    End_Procedure // OnStartPrinting
30449>>>
30449>>>    // This hook procedure is called just after a print job has finished.
30449>>>    Procedure OnStopPrinting
30450>>>        Forward Send OnStopPrinting
30452>>>    End_Procedure // OnStopPrinting
30453>>>
30453>>>
30453>>>End_Class // CrystalReportSubSQL
30454>>>
30454>Integer giWait_Obj
30454>
30454>// General Functions-Procedures and Variables
30454>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30454>>>
30454>>>        String  gs_Selected_Company_Code
30454>>>        String  gs_Selected_Branch_Code
30454>>>        Integer gi_Selected_Year
30454>>>        String gs_Selected_Year_Recr
30454>>>        String  gs_Module_Code
30454>>>
30454>>>
30454>>>//Open Currency
30454>>>//Function CurrDigits Global String asCurr Returns Integer
30454>>>//    Integer liDecX
30454>>>//    Clear Currency
30454>>>//    move asCurr to Currency.Currency_C_Code
30454>>>//    Find Eq Currency By Index.1
30454>>>//    move Currency.Currency_Dec to liDecX
30454>>>//    Function_Return liDecX
30454>>>//End_Function // CurrDigits
30454>>>
30454>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30456>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30458>>>
30458>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30459>>>    Move (Trim(asNomisma)) to asNomisma
30460>>>    Clear Nomisma
30461>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30464>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30466>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30467>>>>
30467>>>    Function_Return Nomisma.Dekadika
30468>>>End_Function //
30469>>>
30469>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30470>>>    String rVal
30471>>>    Integer iLength iInt
30471>>>    Move aiCode to rVal
30472>>>    Move (trim(rVal)) to rVal
30473>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30479>>>>
30479>>>        Move (Insert('0',rVal,1)) to rVal
30480>>>    Loop
30481>>>>
30481>>>    Function_Return rVal
30482>>>End_Function
30483>>>
30483>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30484>>>    String rVal
30485>>>    Integer iLength iInt ipos
30485>>>    Move aiCode to rVal
30486>>>    Move (trim(rVal)) to rVal
30487>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30488>>>    For iInt From 1 to ipos
30494>>>>
30494>>>        Move (Insert('0',rVal,1)) to rVal
30495>>>    Loop
30496>>>>
30496>>>    Function_Return rVal
30497>>>End_Function
30498>>>
30498>>>
30498>>>Open Year
INCLUDING FILE: YEAR.FD
30500>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30501>>>    Send aiMsg to Self
30502>>>End_Procedure
30503>>>
30503>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30504>>>    Integer liChanged
30505>>>
30505>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30508>>>    If (Not(Current_Record(aiYearDD))) Begin
30510>>>        Get Should_Save of aiPanel to liChanged
30511>>>        Send Clear to aiYearDD
30512>>>        Move gs_Selected_Company_Code to Year.Company_Code
30513>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30514>>>        Move gi_Selected_Year         to Year.Year_Year
30515>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30516>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30519>>>    End
30519>>>>
30519>>>End_Procedure
30520>>>
30520>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30521>>>    Integer liSrvr
30522>>>    String  lsCurrentYearRecr
30522>>>
30522>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30524>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30526>>>    End
30526>>>>
30526>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30527>>>    Get Server of aiPanel to liSrvr
30528>>>    // Respects Default values
30528>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30533>>>End_Procedure
30534>>>
30534>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30534>>>//                                                          Holds the current year rec0
30534>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30534>>>
30534>>>
30534>>>Function fiRefindYear Global Returns Integer
30535>>>    Clear Year
30536>>>    Move gs_Selected_Company_Code to Year.Company_Code
30537>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30538>>>    Move gi_Selected_Year         to Year.Year_Year
30539>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30540>>>>
30540>>>    Function_Return (Found = 0)
30541>>>End_Function //fiRefindYear
30542>>>
30542>>>Procedure DoRunApplication for Baseclass String sAppName
30543>>>    string sRuntime  lsStr
30544>>>
30544>>>    Append lsStr 'C:\Dns.bat ' sAppName
30546>>>    RunProgram Wait  lsStr
30547>>>
30547>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30547>>>//    append sRuntime "\dfrun " sAppName
30547>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30549>>>    runprogram background sRuntime
30550>>>End_procedure // DoRunApplication
30551>>>
30551>>>// Run the Editor
30551>>>Procedure DoRunEditor for Baseclass String asFile
30552>>>    string sRunPath lsWspcName
30553>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30554>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30557>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30557>>>    Move (Replace('.',asFile,'')) to asFile
30558>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30559>>>    send DoRunApplication sRunPath
30560>>>End_Procedure // DoRunEditor
30561>>>
30561>>>//--------------------------------------
30561>>>
30561>>>//start of global functions and procedures
30561>>>
30561>>>
30561>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30561>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30562>>>         String  lsTemp_Code1 lsTemp_Code2
30563>>>         Integer liCounter
30563>>>
30563>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30563>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30564>>>
30564>>>         //2.˜¤« ©«¨¦­ã
30564>>>         For liCounter From 1 to (Length(lsCode))
30570>>>>
30570>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30571>>>         Loop
30572>>>>
30572>>>
30572>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30572>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30573>>>
30573>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30573>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30574>>>
30574>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30574>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30580>>>>
30580>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30581>>>         Loop
30582>>>>
30582>>>
30582>>>         Function_Return (Trim(lsTemp_Code2))
30583>>>End_Function //gsffind_previous
30584>>>
30584>>>
30584>>>Function gifSystem_Check Returns Integer
30585>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30586>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30586>>>//       Clear Company
30586>>>//       Find Gt Company.Recnum
30586>>>//       While (Found = 1)
30586>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30586>>>//             Add Company.Company_NumGarticl to liS_Garticls
30586>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30586>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30586>>>//             Add Company.Company_NumGplan   to liS_GPlans
30586>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30586>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30586>>>//             Find Gt Company.Recnum
30586>>>//       Loop
30586>>>//
30586>>>//       Get_Attribute {attribute} [of {file-handle} ;
30586>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30586>>>//                        To {variable}
30586>>>//
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30586>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30586>>>//
30586>>>
30586>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30586>>>
30586>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30586>>>
30586>>>    Function_Return 0
30587>>>End_Function //gifSystem_Check
30588>>>
30588>>>/////////////////////////////////////////////////////////////////
30588>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30588>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30589>>>
30589>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30590>>>    Integer liInt liInteger iTimes iStart
30590>>>    Number  lnDecimals
30590>>>
30590>>>    Move (Integer(anValue))                                         to liInteger
30591>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30592>>>
30592>>>    Move liInteger              to lsAkeraios
30593>>>    Move lnDecimals             to lsDekadika
30594>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30595>>>    Move (Trim(lsDekadika))     to lsDekadika
30596>>>
30596>>>    Move (Length(lsAkeraios)) to iStart
30597>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30603>>>>
30603>>>        Insert "0" in lsAkeraios at 1
30605>>>    Loop
30606>>>>
30606>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30607>>>
30607>>>    Move (Length(lsDekadika)) to iStart
30608>>>    For iTimes From iStart to (aiLengthDekadika-1)
30614>>>>
30614>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30615>>>    Loop
30616>>>>
30616>>>    Move (Trim(lsDekadika)) to lsDekadika
30617>>>
30617>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30620>>>    Move '' to lsRetVal
30621>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30622>>>    Function_Return lsRetval
30623>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30624>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30624>>>
30624>>>Open Codemast
30626>>>
30626>>>
30626>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30627>>>         Clear Codemast
30628>>>         Move lsType  to Codemast.Type
30629>>>         Move lsValue to Codemast.Code
30630>>>         Find Eq Codemast by Index.1 //type+code
30631>>>>
30631>>>         Function_Return Codemast.Description
30632>>>End_Function //code_mast
30633>>>
30633>>>
30633>>>Open Branch
INCLUDING FILE: BRANCH.FD
30635>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30636>>>    String rVal
30637>>>    Integer iInt
30637>>>    Clear Branch
30638>>>    Move asCompany  to Branch.Company_Code
30639>>>    Move asBranch   to Branch.Branch_Code
30640>>>    Find Eq Branch by Index.1
30641>>>>
30641>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30644>>>    Move (Trim(asCompany))  to asCompany
30645>>>    Move (Trim(asBranch))   to asBranch
30646>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30650>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30654>>>    Move ''                                           to rVal
30655>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30656>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30657>>>    Move (Trim(rVal))                                 to rVal
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>Function fsgStripCodeFromID Global String asID Returns Integer
30661>>>      Integer iLen iPos iInt
30662>>>      If (Trim(asID)='') Function_Return 0
30665>>>      Move (Trim  (asID)) to asID
30666>>>      Move (Length(asID)) to iLen
30667>>>      For iInt From 1     to iLen
30673>>>>
30673>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30676>>>      Loop
30677>>>>
30677>>>      Function_Return (Right(asID,(iLen-iPos)))
30678>>>End_Function
30679>>>
30679>>>Function fsCityDescr Global Integer aiCityID Returns String
30680>>>    String rVal
30681>>>    Open Cities
INCLUDING FILE: CITIES.FD
30683>>>    Clear Cities
30684>>>    Move aiCityID to Cities.City_ID
30685>>>    Find Eq Cities By Index.1
30686>>>>
30686>>>    If (Found=1) Move Cities.City_descr to rVal
30689>>>    Else         Move '' to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30694>>>    Open Cities
30696>>>    Clear Cities
30697>>>    Move aiCityID to Cities.City_ID
30698>>>    Find Eq Cities By Index.1
30699>>>>
30699>>>    Function_Return Cities.Town_ID
30700>>>End_Function
30701>>>
30701>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30702>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30704>>>    Clear Towns
30705>>>    Move aiTownID to Towns.Town_ID
30706>>>    Find Eq Towns By Index.1
30707>>>>
30707>>>    Function_Return Towns.Country_ID
30708>>>End_Function
30709>>>
30709>>>Function fsTownDescr Global Integer aiTownID Returns String
30710>>>    String rVal
30711>>>    Open Towns
30713>>>    Clear Towns
30714>>>    Move aiTownID to Towns.Town_ID
30715>>>    Find Eq Towns By Index.1
30716>>>>
30716>>>    If (Found=1) Move Towns.Town_descr to rVal
30719>>>    Else         Move '' to rVal
30721>>>    Function_Return rVal
30722>>>End_Function
30723>>>
30723>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30724>>>    String rVal
30725>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30727>>>    Clear Country
30728>>>    Move aiCountryID to Country.Country_ID
30729>>>    Find Eq Country By Index.1
30730>>>>
30730>>>    If (Found=1) Move Country.Country_descr to rVal
30733>>>    Else         Move '' to rVal
30735>>>    Function_Return rVal
30736>>>End_Function
30737>>>
30737>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30738>>>    String rVal
30739>>>    Open Areas
INCLUDING FILE: AREAS.FD
30741>>>    Clear Areas
30742>>>    Move aiAreaID to Areas.Area_ID
30743>>>    Find Eq Areas By Index.1
30744>>>>
30744>>>    If (Found=1) Move Areas.Area_descr to rVal
30747>>>    Else         Move '' to rVal
30749>>>    Function_Return rVal
30750>>>End_Function
30751>>>
30751>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30752>>>    Local String rVal lsTmp lsOO lsLL
30753>>>    Local Number lnOO lnLL
30753>>>
30753>>>    Move '' to lsOO
30754>>>    Move '' to lsLL
30755>>>    Move '' to rVal
30756>>>
30756>>>    Move (Integer(anTime))                              to lnOO
30757>>>
30757>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30758>>>
30758>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30761>>>    Else         Move (String(lnOO))                    to lsOO
30763>>>    Move (Trim(lsOO))                                   to lsOO
30764>>>
30764>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30767>>>    Else         Move (String(lnLL))                    to lsLL
30769>>>    Move (Trim(lsLL))                                   to lsLL
30770>>>
30770>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30771>>>
30771>>>    Move (Trim(rVal)) to rVal
30772>>>
30772>>>    Function_Return rVal
30773>>>End_Function
30774>>>
30774>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30775>>>    Local Number rVal nOres nLepta
30776>>>    Move (Integer(aiMinutes/60))    to nOres
30777>>>    Move (    Mod(aiMinutes,60))    to nLepta
30778>>>    Move (nOres+(nLepta/100))       to rVal
30779>>>    Function_Return rVal
30780>>>End_Function
30781>>>
30781>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30782>>>    Local Integer rVal
30783>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30784>>>    Function_Return rVal
30785>>>End_Function
30786>>>
30786>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30787>>>    Local Integer rVal iMinStart iMinEnd
30788>>>
30788>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30791>>>
30791>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30792>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30793>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30794>>>    Function_Return rVal
30795>>>End_Function
30796>>>
30796>>>
30796>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30797>>>    Local Integer iTmp
30798>>>    Local Number  rVal
30798>>>
30798>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30801>>>
30801>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30802>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30803>>>    Function_Return rVal
30804>>>End_Function
30805>>>
30805>>>
30805>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30807>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30809>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30811>>>
30811>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30812>>>  Integer iExodos
30813>>>  Number nPoso nPct
30813>>>  Move 0 to nPoso
30814>>>  Move 0 to nPct
30815>>>  Move 0 to iExodos
30816>>>
30816>>>  Move (Trim(asItemCode)) to asItemCode
30817>>>  Move (Trim(asPromCode)) to asPromCode
30818>>>
30818>>>  // 1.Anazhthsh sto arxeio Witemcld
30818>>>  Clear Witemcld
30819>>>  Move asItemCode to Witemcld.Item_Code
30820>>>  Move asPromCode to Witemcld.Client_Code
30821>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30822>>>>
30822>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30826>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30828>>>          Move 1 to iExodos
30829>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30832>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30836>>>      End
30836>>>>
30836>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30837>>>>
30837>>>  Loop
30838>>>>
30838>>>  If (iExodos) Begin
30840>>>      If (nPoso) Function_Return nPoso
30843>>>      Else Function_Return nPct
30845>>>  End
30845>>>>
30845>>>
30845>>>  // 2.Anazhthsh sto arxeio Witemcl
30845>>>  Clear WitemCL
30846>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30847>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30848>>>  Find Eq WitemCL By Index.1
30849>>>>
30849>>>  If (Found=1) Function_Return WitemCL.Client_Price
30852>>>
30852>>>  Function_Return 0
30853>>>End_Function
30854>>>
30854>>>
30854>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30856>>>
30856>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30857>>>
30857>>>  Integer iExodos iCheckDeop
30858>>>  Number nPoso nPct
30858>>>
30858>>>  Move (Num_Arguments=7) to iCheckDeop
30859>>>
30859>>>  Move 0 to nPoso
30860>>>  Move 0 to nPct
30861>>>  Move 0 to iExodos
30862>>>
30862>>>  Move (Trim(asItemCode))                 to asItemCode
30863>>>  Move (Trim(asClientID))                 to asClientID
30864>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30865>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30866>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30869>>>
30869>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30869>>>  If (iCheckDeop) Begin
30871>>>      Clear btnordd
30872>>>      Move asClientID   to btnordd.vclient_id
30873>>>      Move asCNCode     to btnordd.vcn_code
30874>>>      Move asWitemxCode to btnordd.vitem
30875>>>      Move 0            to btnordd.vactive
30876>>>      Move adHmnia      to btnordd.arxh_date
30877>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30878>>>>
30878>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30880>>>          move btnordd.vprice to nPoso
30881>>>          If (nPoso) Function_Return nPoso
30884>>>      End
30884>>>>
30884>>>  End
30884>>>>
30884>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
30884>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30884>>> // Clear Witemcld
30884>>> // Move asItemCode to Witemcld.Item_Code
30884>>> // Move asClientID to Witemcld.Client_Code
30884>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
30884>>> //                      (Witemcld.Client_Code= asClientID) And ;
30884>>> //                      (iExodos=0))
30884>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30884>>> //         Move 1 to iExodos
30884>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30884>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30884>>> //     End
30884>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // Loop
30884>>> // If (iExodos) Begin
30884>>> //     If (nPoso) Function_Return nPoso
30884>>> //     Else Function_Return nPct
30884>>> // End
30884>>>
30884>>>
30884>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30884>>>  //Clear Witemxt
30884>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
30884>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30884>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
30884>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
30884>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
30884>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
30884>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
30884>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
30884>>>  //                     (iExodos=0))
30884>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30884>>>  //        Move 1 to iExodos
30884>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30884>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30884>>>  //    End
30884>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //Loop
30884>>>  //If (iExodos) Begin
30884>>>  //    If (nPoso) Function_Return nPoso
30884>>>  //    Else Function_Return nPct
30884>>>  //End
30884>>>
30884>>>
30884>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30884>>>  //Clear WitemCL
30884>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
30884>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
30884>>>  //Find Eq WitemCL By Index.1
30884>>>  //If (Found=1) Function_Return WitemCL.Client_Price
30884>>>
30884>>>  Function_Return 0
30885>>>End_Function
30886>>>
30886>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30887>>>    String sEnter
30888>>>    Move '' to sEnter
30889>>>    Move (Trim(asStr)) to asStr
30890>>>    Append sEnter (Character(13)) (Character(10))
30892>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30893>>>    Function_return (Trim(asStr))
30894>>>End_function
30895>>>
30895>>>
30895>>>//end   of global functions and procedures
30895>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30895>>>>>USE AllEntSc
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>Object Wait is a ModalPanelSub
30897>>>>>
30897>>>>>    //AB-StoreTopStart
30897>>>>>
30897>>>>>    // How to Use It
30897>>>>>    // Get the maximum position of the bar
30897>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30897>>>>>    //
30897>>>>>    // Set the maximum position of the bar
30897>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30897>>>>>    //
30897>>>>>    // Start Bar Progress from beginning
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30897>>>>>    //
30897>>>>>    // End Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30897>>>>>    //
30897>>>>>    // Update Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30897>>>>>    // When you want the update to be done for every i (this is slower)
30897>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30897>>>>>    //
30897>>>>>    // Display Buttons on the object
30897>>>>>    // Set Button_State of (Wait(Self)) to False/True
30897>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30897>>>>>    //
30897>>>>>    // Initialization of the Progress Bar
30897>>>>>    // Send Popup to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Deactivation of the Progress Bar
30897>>>>>    // Send Deactivate to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Message during the process
30897>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30897>>>>>    //
30897>>>>>    // Extra Info for button "Info >>"
30897>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30897>>>>>    // If sFile<>'' then reads the contents of the file
30897>>>>>    // Else Fills the Edit with the string of sDetail
30897>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30897>>>>>    //
30897>>>>>    // Remarks instead of Progress Bar
30897>>>>>    // Set Button_State of (Wait(Self))     to False
30897>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30897>>>>>    // Update During Process
30897>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30897>>>>>
30897>>>>>    //AB-StoreTopEnd
30897>>>>>
30897>>>>>    Set Exit_Application_Local_State to FALSE
30898>>>>>    Set Modal_State to FALSE
30899>>>>>    Set Popup_State to TRUE
30900>>>>>    Set Border_Style to Border_Thick
30901>>>>>    Set Minimize_Icon to FALSE
30902>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30903>>>>>    Set Size to 138 256
30904>>>>>
30904>>>>>    //AB-DDOStart
30904>>>>>
30904>>>>>
30904>>>>>    //AB-DDOEnd
30904>>>>>
30904>>>>>    Object WaitBar is a ProgressBarSub
30906>>>>>
30906>>>>>        //AB-StoreTopStart
30906>>>>>
30906>>>>>        //AB-StoreTopEnd
30906>>>>>
30906>>>>>        Set Size to 21 243
30907>>>>>        Set Location to 7 4
30908>>>>>
30908>>>>>        //AB-StoreStart
30908>>>>>        Send DoRegSize  self smTopRight
30909>>>>>        //AB-StoreEnd
30909>>>>>
30909>>>>>    End_Object
30910>>>>>
30910>>>>>    Object WaitText is a TextBoxSub
30912>>>>>
30912>>>>>        //AB-StoreTopStart
30912>>>>>
30912>>>>>        //AB-StoreTopEnd
30912>>>>>
30912>>>>>        Set Enabled_State to TRUE
30913>>>>>        Set Label to "Processing"
30914>>>>>        Set FontSize to 4 0
30915>>>>>        Set Size to 10 81
30916>>>>>        Set Location to 36 5
30917>>>>>
30917>>>>>        //AB-StoreStart
30917>>>>>
30917>>>>>        //AB-StoreEnd
30917>>>>>
30917>>>>>    End_Object
30918>>>>>
30918>>>>>    Object bnCancel is a ButtonSub
30920>>>>>
30920>>>>>        //AB-StoreTopStart
30920>>>>>
30920>>>>>        //AB-StoreTopEnd
30920>>>>>
30920>>>>>        Set Default_State to TRUE
30921>>>>>        Set Label to "OK"
30922>>>>>        Set Location to 34 143
30923>>>>>
30923>>>>>        //AB-StoreStart
30923>>>>>
30923>>>>>        Procedure OnClick
30925>>>>>             Send Deactivate to (Wait(Self))
30926>>>>>        End_Procedure
30927>>>>>
30927>>>>>        Send DoRegAlign self amTopRight
30928>>>>>        //AB-StoreEnd
30928>>>>>
30928>>>>>    End_Object
30929>>>>>
30929>>>>>    Object bnDetail is a ButtonSub
30931>>>>>
30931>>>>>        //AB-StoreTopStart
30931>>>>>
30931>>>>>        //AB-StoreTopEnd
30931>>>>>
30931>>>>>        Set Focus_Mode to Pointer_Only
30932>>>>>        Set Label to "Info >>"
30933>>>>>        Set Location to 34 197
30934>>>>>
30934>>>>>        //AB-StoreStart
30934>>>>>
30934>>>>>        Procedure OnClick
30936>>>>>            Delegate Send Show_Details False
30938>>>>>        End_Procedure
30939>>>>>
30939>>>>>        Send DoRegAlign self amTopRight
30940>>>>>        //AB-StoreEnd
30940>>>>>
30940>>>>>    End_Object
30941>>>>>
30941>>>>>    Object LineControlSub1 is a LineControlSub
30943>>>>>
30943>>>>>        //AB-StoreTopStart
30943>>>>>
30943>>>>>        //AB-StoreTopEnd
30943>>>>>
30943>>>>>        Set Size to 2 243
30944>>>>>        Set Location to 54 4
30945>>>>>
30945>>>>>        //AB-StoreStart
30945>>>>>
30945>>>>>        Send DoRegSize  self smTopRight
30946>>>>>        //AB-StoreEnd
30946>>>>>
30946>>>>>    End_Object
30947>>>>>
30947>>>>>    Object WaitEdit is a editSub
30949>>>>>
30949>>>>>        //AB-StoreTopStart
30949>>>>>
30949>>>>>        //AB-StoreTopEnd
30949>>>>>
30949>>>>>        Set Enabled_State to FALSE
30950>>>>>        Set Read_Only_State to TRUE
30951>>>>>        Set Size to 58 243
30952>>>>>        Set Location to 60 4
30953>>>>>        Set Color to clWhite
30954>>>>>
30954>>>>>        //AB-StoreStart
30954>>>>>
30954>>>>>        Send DoRegSize Self amBottomRight
30955>>>>>        Delegate Set Size to 66 256
30957>>>>>
30957>>>>>        //AB-StoreEnd
30957>>>>>
30957>>>>>    End_Object
30958>>>>>
30958>>>>>    Object oTxtAntiBar is a TextBoxSub
30960>>>>>        Set Enabled_State to TRUE
30961>>>>>        Set Visible_State to FALSE
30962>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30963>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30964>>>>>        Set Auto_Size_State to FALSE
30965>>>>>        Set FontWeight to 600
30966>>>>>        Set FontSize to 4 0
30967>>>>>        Set Size to 10 209
30968>>>>>        Set Location to 10 4
30969>>>>>        Set TextColor to clNavy
30970>>>>>    End_Object
30971>>>>>
30971>>>>>
30971>>>>>    //AB-StoreStart
30971>>>>>    Property Integer piWaitSize  Public (Size(Self))
30973>>>>>    Property Integer piPrevSize  Public (Size(Self))
30975>>>>>    Property Integer piState     Public False
30977>>>>>
30977>>>>>    Set Locate_Mode to Center_On_Screen
30978>>>>>    Set Destroy_Object_State to True
30979>>>>>
30979>>>>>    Procedure Show_Details Integer bAlways
30981>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30982>>>>>        Local String sLabel
30982>>>>>        Get Size                to liSize
30983>>>>>        Get piState             to bState
30984>>>>>        Get piWaitSize          to liOriSize
30985>>>>>        Move (Hi(liSize))       to hiSize
30986>>>>>        Move (Low(liSize))      to lowSize
30987>>>>>        Move (Hi(liOriSize))    to hiOriSize
30988>>>>>        If (bAlways) Begin
30990>>>>>            Set piState         to False
30991>>>>>            Move 0              to bState
30992>>>>>        End
30992>>>>>>
30992>>>>>        If bState Begin
30994>>>>>             Set Size to hiOriSize lowSize
30995>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30996>>>>>        End
30996>>>>>>
30996>>>>>        Else Begin
30997>>>>>             Set Size to 138 lowSize
30998>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30999>>>>>        End
30999>>>>>>
30999>>>>>        Set piState to (1-bState)
31000>>>>>    End_Procedure
31001>>>>>
31001>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31003>>>>>       If (bState) Begin
31005>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31008>>>>>       End
31008>>>>>>
31008>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31010>>>>>    End_Procedure
31011>>>>>
31011>>>>>    Procedure DoInitialize_WaitBar
31013>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31014>>>>>    End_Procedure
31015>>>>>
31015>>>>>    Procedure DoTerminate_WaitBar
31017>>>>>        Local Integer iMax
31018>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31019>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31020>>>>>    End_Procedure
31021>>>>>
31021>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31023>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31024>>>>>    End_Procedure
31025>>>>>
31025>>>>>    Function Bar_Maximum_Position Returns Integer
31027>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31028>>>>>    End_Function
31029>>>>>
31029>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31031>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31032>>>>>    End_Procedure
31033>>>>>
31033>>>>>    Function Bar_Minimum_Position Returns Integer
31035>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31036>>>>>    End_Function
31037>>>>>
31037>>>>>    Procedure Set Bar_Step_Value Integer iStep
31039>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31040>>>>>    End_Procedure
31041>>>>>
31041>>>>>    Function Bar_Step_Value Returns Integer
31043>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31044>>>>>    End_Function
31045>>>>>
31045>>>>>    Procedure Set Wait_Message String sMessage
31047>>>>>        Set Value of (WaitText(Self)) to sMessage
31048>>>>>    End_Procedure
31049>>>>>
31049>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31051>>>>>        Local Integer liEditId
31052>>>>>        Move (WaitEdit(Self)) to liEditId
31053>>>>>        If bInitData Send Delete_Data to liEditId
31056>>>>>        If sFile ne "" Begin
31058>>>>>           Send Read to liEditId sFile
31059>>>>>           Send Beginning_Of_Data to liEditId
31060>>>>>        End
31060>>>>>>
31060>>>>>        Else Begin
31061>>>>>           Send Insert to liEditId sDetail
31062>>>>>        End
31062>>>>>>
31062>>>>>    End_Procedure
31063>>>>>
31063>>>>>    Procedure OnResize
31065>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31066>>>>>        Get Size to liPrevSize
31067>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31068>>>>>        Forward Send OnResize
31070>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31071>>>>>        Move (Hi(liLoc)) to liHiLoc
31072>>>>>        Get piState to bState
31073>>>>>        Get Size to liSize
31074>>>>>        Move (Hi(liSize)) to liHiSize
31075>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31077>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31078>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31081>>>>>        End
31081>>>>>>
31081>>>>>        Else Begin
31082>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31083>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31086>>>>>        End
31086>>>>>>
31086>>>>>    End_Procedure
31087>>>>>
31087>>>>>    Procedure Set Button_State Integer bState
31089>>>>>        If bState Begin
31091>>>>>            Set Caption_Bar to True
31092>>>>>            Set Size to 66 256
31093>>>>>        End
31093>>>>>>
31093>>>>>        Else Begin
31094>>>>>            Set Caption_Bar to False
31095>>>>>            Set Size to 38 256
31096>>>>>        End
31096>>>>>>
31096>>>>>    End_Procedure
31097>>>>>
31097>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31099>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31100>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31101>>>>>        If (bState = 0) Begin
31103>>>>>            Set Size to 24 256
31104>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31105>>>>>        End
31105>>>>>>
31105>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31108>>>>>    End_Procedure
31109>>>>>
31109>>>>>    Procedure Deactivating integer search_mode Returns Integer
31111>>>>>        local integer rval
31112>>>>>        Forward Get MSG_Deactivating search_mode to rval
31114>>>>>        Set Modal_State of (Wait(Self)) to False
31115>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31116>>>>>        Procedure_Return rval
31117>>>>>    End_Procedure
31118>>>>>
31118>>>>>    Procedure UpdateWait String sMsg
31120>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31121>>>>>    End_Procedure
31122>>>>>
31122>>>>>
31122>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31124>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31125>>>>>    End_Procedure
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>    //AB-StoreEnd
31126>>>>>
31126>>>>>End_Object
31127>>>>>
31127>>>>>
31127>>>>>//AB-StoreStart
31127>>>>>
31127>>>>>//AB-StoreEnd
31127>>>>>
31127>>>>>//AB/ End_Object    // prj
31127>>>
31127>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31127>>>//AB/ Project Calendar
31127>>>//AB/ Object prj is a Lookup_Project
31127>>>//AB/     Set ProjectName to "Calendar"
31127>>>//AB/     Set ProjectFileName to "Calendar.sl"
31127>>>
31127>>>// Project Object Structure
31127>>>//   oCalendar is a dbModalPanel
31127>>>//     Container3d1 is a Container3d
31127>>>//       Grid2 is a Grid
31127>>>//       Textbox2 is a Textbox
31127>>>//       Textbox3 is a Textbox
31127>>>//       Textbox4 is a Textbox
31127>>>//       Textbox5 is a Textbox
31127>>>//       Textbox6 is a Textbox
31127>>>//       Textbox7 is a Textbox
31127>>>//       Textbox8 is a Textbox
31127>>>//       LineControl1 is a LineControl
31127>>>//       Container3d2 is a Container3d
31127>>>//         oRght is a BitmapContainer
31127>>>//         oLeft is a BitmapContainer
31127>>>//         oMonth is a Textbox
31127>>>//           oSelectMonth is a FloatingPopupMenu
31127>>>//         oYear is a Textbox
31127>>>//         oSelectYear is a Form
31127>>>//     BitmapContainer3 is a BitmapContainer
31127>>>//     oToday is a Textbox
31127>>>
31127>>>// Register all objects
31127>>>Register_Object BitmapContainer3
31127>>>Register_Object Container3d1
31127>>>Register_Object Container3d2
31127>>>Register_Object Grid2
31127>>>Register_Object LineControl1
31127>>>Register_Object oCalendar
31127>>>Register_Object oLeft
31127>>>Register_Object oMonth
31127>>>Register_Object oRght
31127>>>Register_Object oSelectMonth
31127>>>Register_Object oSelectYear
31127>>>Register_Object oToday
31127>>>Register_Object oYear
31127>>>Register_Object Textbox2
31127>>>Register_Object Textbox3
31127>>>Register_Object Textbox4
31127>>>Register_Object Textbox5
31127>>>Register_Object Textbox6
31127>>>Register_Object Textbox7
31127>>>Register_Object Textbox8
31127>>>
31127>>>
31127>>>
31127>>>//AB-StoreTopStart
31127>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31127>>>>>// **********************************************************************
31127>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31127>>>>>//
31127>>>>>// by Sture Andersen (sa1@vd.dk)
31127>>>>>//
31127>>>>>// The file contains a number of global functions for manipulating
31127>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31127>>>>>// This package is public domain.
31127>>>>>//
31127>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31127>>>>>// listing the functions and their use.
31127>>>>>//
31127>>>>>//
31127>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31127>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31127>>>>>//                         - Addition of popup_calendar to VDF.
31127>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31127>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31127>>>>>//         Thu  10-07-1997 - Fixes.
31127>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31127>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31127>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31127>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31127>>>>>//                           ItemSysdate added.
31127>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31127>>>>>//                           FieldSysdate added.
31127>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31127>>>>>//                           Module_Compile_Time added.
31127>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31127>>>>>//                           responds if entry_state of the calling object
31127>>>>>//                           is true (VDF version). (No apparent effect)
31127>>>>>//         Sat  28-03-1998 - Added the following functions:
31127>>>>>//                             TS_SysTime      TS_ExtractDate
31127>>>>>//                             TS_ExtractTime  TS_ConvertToString
31127>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31127>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31127>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31127>>>>>//                           Module_Start_Time added.
31127>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31127>>>>>//         Mon  12-10-1998 - Portuguese added
31127>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31127>>>>>//         Tue  29-12-1998 - Function DateAsString added
31127>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson
31127>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson (again)
31127>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31127>>>>>//                           class (Continue->TS_Continue and Pause->
31127>>>>>//                           TS_Pause)
31127>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31127>>>>>//                           added.
31127>>>>>//                         - Procedures DateCurrentSeparator and
31127>>>>>//                           DateCurrentFormat added.
31127>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31127>>>>>//                           Jan1st1000 and Jan1st100
31127>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31127>>>>>//                           to trap 3 digit years.
31127>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31127>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31127>>>>>//                         - Fixed error in TS_ConvertToString
31127>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31127>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31127>>>>>//                           from the calendar to forms with no form_margin.
31127>>>>>//         Tue  07-09-1999 - Added function DateAsText
31127>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31127>>>>>//                           in combination with y2k.
31127>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31127>>>>>//                         - Existing function DateAsString renamed to
31127>>>>>//                           DateToString.
31127>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31127>>>>>//                           would result in seeding the calendar on year 100.
31127>>>>>//                           This error was caused by the fact that VDF 4
31127>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31127>>>>>//                           command returns 03-01-100
31127>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31127>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31127>>>>>//
31127>>>>>// NOTE:  There is language dependent string constants in this file.
31127>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31127>>>>>//        norwegian, spanish, german and portuguese
31127>>>>>//
31127>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31127>>>>>//
31127>>>>>// ***********************************************************************
31127>>>>>
31127>>>>>Use ui
31127>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31127>>>>>>>// Use Language     // Default language setup
31127>>>>>>>// Sets default languange if not set by compiler command line
31127>>>>>>>
31127>>>>>>>define lng_dutch      for 131
31127>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_spanish    for 134
31127>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_english    for 144
31127>>>>>>>define lng_danish     for 145
31127>>>>>>>define lng_swedish    for 146
31127>>>>>>>define lng_norwegian  for 147
31127>>>>>>>define lng_Greek    for 148
31127>>>>>>>define lng_german     for 149
31127>>>>>>>define lng_portuguese for 155
31127>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>define lng_default for !@
31127>>>>>>>
31127>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31127>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31127>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31127>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31127>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31127>>>>>>>
31127>>>>>>>//  FOR_EX (extended FOR command)
31127>>>>>>>//  -----------------------------
31127>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31127>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31127>>>>>>>//> you need to do a decremental loop.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>//  DESKTOP_SECTION
31127>>>>>>>//  ---------------
31127>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31127>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31127>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>
31127>>>>>
31127>>>>>// Switches
31127>>>>>
31127>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31127>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31127>>>>>
31127>>>>> define t.calendar.year           for "Year"
31127>>>>> define t.calendar.month          for "Month"
31127>>>>> define t.calendar.day            for "Day"
31127>>>>> define t.calendar.week           for "Wk."
31127>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31127>>>>> define t.calendar.Monday         for "Monday"
31127>>>>> define t.calendar.Tuesday        for "Tuesday"
31127>>>>> define t.calendar.Wednesday      for "Wednesday"
31127>>>>> define t.calendar.Thursday       for "Thursday"
31127>>>>> define t.calendar.Friday         for "Friday"
31127>>>>> define t.calendar.Saturday       for "Saturday"
31127>>>>> define t.calendar.Sunday         for "Sunday"
31127>>>>> define t.calendar.January        for "January"
31127>>>>> define t.calendar.February       for "February"
31127>>>>> define t.calendar.March          for "March"
31127>>>>> define t.calendar.April          for "April"
31127>>>>> define t.calendar.May            for "May"
31127>>>>> define t.calendar.June           for "June"
31127>>>>> define t.calendar.July           for "July"
31127>>>>> define t.calendar.August         for "August"
31127>>>>> define t.calendar.September      for "September"
31127>>>>> define t.calendar.October        for "October"
31127>>>>> define t.calendar.November       for "November"
31127>>>>> define t.calendar.December       for "December"
31127>>>>> define t.calendar.ok             for "OK"
31127>>>>> define t.calendar.Cancel         for "Cancel"
31127>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31127>>>>>
31127>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31127>>>>>define Jan1st1900          for 693975
31127>>>>>define Jan1st2000          for 730500
31127>>>>>define Jan1st1000          for 365250
31127>>>>>define Jan1st105           for 38352
31127>>>>>define Jan1st100           for 36525
31127>>>>>
31127>>>>>enumeration_list // Date Segments
31127>>>>>  define DS_DAY
31127>>>>>  define DS_WEEK
31127>>>>>  define DS_MONTH
31127>>>>>  define DS_YEAR
31127>>>>>end_enumeration_list
31127>>>>>
31127>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31127>>>>>
31127>>>>>procedure DateDecompose global date date# //very internal!!
31128>>>>>  local integer pos1# pos2# format#
31129>>>>>  local string str# sep#
31129>>>>>  get_attribute DF_DATE_FORMAT to format#
31132>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31135>>>>>  character pos1# to sep#                  // end overload
31136>>>>>>
31136>>>>>  move date# to str#
31137>>>>>  replace sep# in str# with "$"
31139>>>>>  move strmark to pos1#
31140>>>>>  if [found] begin
31142>>>>>    replace sep# in str# with "$"
31144>>>>>    move strmark to pos2#
31145>>>>>  end
31145>>>>>>
31145>>>>>  else begin
31146>>>>>    move 0 to Dates$Year
31147>>>>>    move 0 to Dates$Month
31148>>>>>    move 0 to Dates$Day
31149>>>>>  end
31149>>>>>>
31149>>>>>  [ found] begin
31151>>>>>>
31151>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31155>>>>>    if format# eq DF_DATE_USA begin
31157>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31160>>>>>>
31160>>>>>          left str# to Dates$Month  (pos1#-1)
31162>>>>>>
31162>>>>>    end
31162>>>>>>
31162>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31166>>>>>
31166>>>>>    if format# eq DF_DATE_MILITARY begin
31168>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31171>>>>>>
31171>>>>>          left str# to Dates$Year   (pos1#-1)
31173>>>>>>
31173>>>>>    end
31173>>>>>>
31173>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31177>>>>>  end
31177>>>>>>
31177>>>>>end_procedure
31178>>>>>
31178>>>>>function DateCompose global integer day# integer month# integer year# returns date
31179>>>>>  local integer format#
31180>>>>>  local date date#
31180>>>>>  local string sep#
31180>>>>>  ifnot (day#*month#*year#) function_return 0
31183>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31186>>>>>  character format# to sep#                  // end overload
31187>>>>>>
31187>>>>>  get_attribute DF_DATE_FORMAT to format#
31190>>>>>  if day# gt 28 begin
31192>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31195>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31198>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31201>>>>>    send DateDecompose date#
31202>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31205>>>>>  end
31205>>>>>>
31205>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31208>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31211>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31212>>>>>end_function
31213>>>>>
31213>>>>>function DateFormatName global integer format# returns string
31214>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31217>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31220>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31223>>>>>end_function
31224>>>>>
31224>>>>>function DateCurrentSeparator global returns string
31225>>>>>  local integer rval#
31226>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31229>>>>>  function_return (character(rval#))
31230>>>>>end_function
31231>>>>>
31231>>>>>function DateCurrentFormat global returns integer
31232>>>>>  local integer rval#
31233>>>>>  get_attribute DF_DATE_FORMAT to rval#
31236>>>>>  function_return rval#
31237>>>>>end_function
31238>>>>>
31238>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31239>>>>>  local string rval# letter#
31240>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31243>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31246>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31249>>>>>  left t.calendar.year to letter# 1
31251>>>>>>
31251>>>>>  replace "1" in rval# with letter#
31253>>>>>  replace "1" in rval# with letter#
31255>>>>>  ifnot long# move "" to letter#
31258>>>>>  move (replaces("1",rval#,letter#)) to rval#
31259>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31260>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31261>>>>>  if sep# eq "" begin
31263>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31266>>>>>    character format# to sep#
31267>>>>>>
31267>>>>>  end
31267>>>>>>
31267>>>>>  move (replaces("4",rval#,sep#)) to rval#
31268>>>>>  function_return rval#
31269>>>>>end_function
31270>>>>>
31270>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31271>>>>>  local integer sep_len# day# month# year#
31272>>>>>  move (length(sep#)) to sep_len#
31273>>>>>  if four_digit_year# move 4 to four_digit_year#
31276>>>>>  else move 2 to four_digit_year#
31278>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31280>>>>>    move (mid(date#,2,1)) to day#
31281>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31282>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31283>>>>>  end
31283>>>>>>
31283>>>>>  if format# eq DF_DATE_USA begin // MDY
31285>>>>>    move (mid(date#,2,1)) to month#
31286>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31287>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31288>>>>>  end
31288>>>>>>
31288>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31290>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31291>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31292>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31293>>>>>  end
31293>>>>>>
31293>>>>>  function_return (DateCompose(day#,month#,year#))
31294>>>>>end_function
31295>>>>>
31295>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31296>>>>>  local string rval# day# month# year#
31297>>>>>  get Date2to4 date# to date#
31298>>>>>  if (integer(date#)) begin
31300>>>>>    send DateDecompose date#
31301>>>>>    move Dates$Day to day#
31302>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31306>>>>>    move Dates$Month to month#
31307>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31311>>>>>    move Dates$Year to year#
31312>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31315>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31318>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31321>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31324>>>>>  end
31324>>>>>>
31324>>>>>  function_return rval#
31325>>>>>end_function
31326>>>>>
31326>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31326>>>>>// Use function DateToString instead.
31326>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31327>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31328>>>>>end_function
31329>>>>>
31329>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31330>>>>>  if (date#=0) function_return 0
31333>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31336>>>>>  if (segment#<>DS_DAY) begin // months or years
31338>>>>>    send DateDecompose date#
31339>>>>>    if segment# eq DS_MONTH begin //months
31341>>>>>      move (Dates$Month+amount#) to Dates$Month
31342>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31345>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31346>>>>>    end //years:
31346>>>>>>
31346>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31349>>>>>  end
31349>>>>>>
31349>>>>>  else function_return (date#+amount#) //days
31351>>>>>end_function
31352>>>>>
31352>>>>>function DateSegment global date date# integer segment# returns integer
31353>>>>>  send DateDecompose date#
31354>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31357>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31360>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31363>>>>>end_function
31364>>>>>
31364>>>>>function DateToInteger global date date# returns integer
31365>>>>>  send DateDecompose date#
31366>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31367>>>>>end_function
31368>>>>>
31368>>>>>function FirstDayInMonth global date date# returns date
31369>>>>>  local integer month# year#
31370>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31371>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31372>>>>>  function_return (DateCompose(1,month#,year#))
31373>>>>>end_function
31374>>>>>
31374>>>>>function LastDayInMonth global date date# returns date
31375>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31376>>>>>  function_return (FirstDayInMonth(date#)-1)
31377>>>>>end_function
31378>>>>>
31378>>>>>function FirstDayInYear global date date# returns date
31379>>>>>  local integer year#
31380>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31381>>>>>  function_return (DateCompose(1,1,year#))
31382>>>>>end_function
31383>>>>>
31383>>>>>function LastDayInYear global date date# returns date
31384>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31385>>>>>  function_return (FirstDayInYear(date#)-1)
31386>>>>>end_function
31387>>>>>
31387>>>>>// Prior to 18/1-99 version of DateWeekNumber
31387>>>>>//function DateWeekNumber global date date# returns integer
31387>>>>>//  local integer week# first_wd# day_of_year# year#
31387>>>>>//  if (date#=0) function_return 0
31387>>>>>//  get Date2to4 date# to date#
31387>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31387>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31387>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31387>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31387>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31387>>>>>//  else move 0 to week#
31387>>>>>//  if first_wd# le 4 increment week#
31387>>>>>//  if week# gt 52 begin
31387>>>>>//    move 1 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  if week# eq 0 begin
31387>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31387>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31387>>>>>//    move 52 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  function_return week#
31387>>>>>//end_function
31387>>>>>
31387>>>>>function DateWeekNumber global date date# returns integer
31388>>>>>  local integer week# first_wd# day_of_year# year# wd#
31389>>>>>  if (date#=0) function_return 0
31392>>>>>  get Date2to4 date# to date#
31393>>>>>  // Leap-year test for actual or previous year
31393>>>>>  // Year# only used for selection between 52 and
31393>>>>>  // Therefore get year# from the first day of actual week
31393>>>>>  get DateDayNumber date# to wd#
31394>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31395>>>>>
31395>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31396>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31397>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31398>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31401>>>>>  else move 0 to week#
31403>>>>>  if first_wd# le 4 increment week#
31406>>>>>  if week# gt 52 begin
31408>>>>>    move 1 to week#
31409>>>>>    if first_wd# eq 4 move 53 to week#
31412>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31419>>>>>  end
31419>>>>>>
31419>>>>>  if week# eq 0 begin
31421>>>>>    // Week 52 or 53
31421>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31422>>>>>    move 52 to week#
31423>>>>>    if first_wd# eq 4 move 53 to week#
31426>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31433>>>>>  end
31433>>>>>>
31433>>>>>  function_return week#
31434>>>>>end_function
31435>>>>>
31435>>>>>function DayName global integer int# returns string
31436>>>>>  if int# eq 1 function_return t.calendar.Monday
31439>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31442>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31445>>>>>  if int# eq 4 function_return t.calendar.Thursday
31448>>>>>  if int# eq 5 function_return t.calendar.Friday
31451>>>>>  if int# eq 6 function_return t.calendar.Saturday
31454>>>>>  if int# eq 7 function_return t.calendar.Sunday
31457>>>>>  function_return ""
31458>>>>>end_function
31459>>>>>
31459>>>>>function DateDayNumber global date date# returns integer
31460>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31461>>>>>  get Date2to4 date# to date#
31462>>>>>  move date# to rval#
31463>>>>>  if rval# begin
31465>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31468>>>>>    move (rval#-((rval#/7)*7)) to rval#
31469>>>>>    if rval# eq 0 move 7 to rval#
31472>>>>>  end
31472>>>>>>
31472>>>>>  function_return rval#
31473>>>>>end_function
31474>>>>>
31474>>>>>function DateDayName global date date# returns string
31475>>>>>  function_return (DayName(DateDayNumber(date#)))
31476>>>>>end_function
31477>>>>>
31477>>>>>function YearMaxWeek global integer year# returns integer
31478>>>>>  local integer wk1# wk2#
31479>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31480>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31481>>>>>  function_return (wk1# max wk2#)
31482>>>>>end_function
31483>>>>>
31483>>>>>function WeekToDate global integer year# integer week# returns date
31484>>>>>  local date date#
31485>>>>>  move (DateCompose(1,1,year#)) to date#
31486>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31489>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31490>>>>>  function_return (week#-1*7+date#)
31491>>>>>end_function
31492>>>>>
31492>>>>>function MonthName global integer int# returns string
31493>>>>>  if int# eq  1 function_return t.calendar.January
31496>>>>>  if int# eq  2 function_return t.calendar.February
31499>>>>>  if int# eq  3 function_return t.calendar.March
31502>>>>>  if int# eq  4 function_return t.calendar.April
31505>>>>>  if int# eq  5 function_return t.calendar.May
31508>>>>>  if int# eq  6 function_return t.calendar.June
31511>>>>>  if int# eq  7 function_return t.calendar.July
31514>>>>>  if int# eq  8 function_return t.calendar.August
31517>>>>>  if int# eq  9 function_return t.calendar.September
31520>>>>>  if int# eq 10 function_return t.calendar.October
31523>>>>>  if int# eq 11 function_return t.calendar.November
31526>>>>>  if int# eq 12 function_return t.calendar.December
31529>>>>>  function_return ""
31530>>>>>end_function
31531>>>>>
31531>>>>>function DateMonthName global date date# returns string
31532>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31533>>>>>end_function
31534>>>>>
31534>>>>>function DateAsText global date date# string format# returns string
31535>>>>>  if date# eq 0 function_return ""
31538>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31539>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31540>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31541>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31542>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31543>>>>>  function_return format#
31544>>>>>end_function
31545>>>>>
31545>>>>>function Year2to4 global integer year# returns integer
31546>>>>>  local integer epoch_value#
31547>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31548>>>>>  if year# lt 100 begin
31550>>>>>    if year# gt epoch_value# function_return (year#+1900)
31553>>>>>    function_return (year#+2000)
31554>>>>>  end
31554>>>>>>
31554>>>>>  function_return year# // No conversion done!
31555>>>>>end_function
31556>>>>>
31556>>>>>function Date2to4 global date date# returns date
31557>>>>>  local integer epoch_value#
31558>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31559>>>>>  if date# gt 0 begin // Only if there is a date to convert
31561>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31563>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31566>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31567>>>>>    end
31567>>>>>>
31567>>>>>    function_return date# // No conversion done!
31568>>>>>  end
31568>>>>>>
31568>>>>>end_function
31569>>>>>
31569>>>>>function Date4to2 global date date# returns date
31570>>>>>  local integer epoch_value# year#
31571>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31572>>>>>  if date# gt 0 begin // Only if there is a date to convert
31574>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31575>>>>>    if year# ge 100 begin // Only then conversion is needed!
31577>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31579>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31582>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31584>>>>>      end
31584>>>>>>
31584>>>>>      else error 301 "Date is out of epoch range"
31586>>>>>    end
31586>>>>>>
31586>>>>>  end
31586>>>>>>
31586>>>>>  function_return date# // No conversion done!
31587>>>>>end_function
31588>>>>>
31588>>>>>function dSysDate global returns date
31589>>>>>  local date date#
31590>>>>>  sysdate4 date#
31591>>>>>  function_return date#
31592>>>>>end_function
31593>>>>>
31593>>>>>function iSysYear global returns integer
31594>>>>>  local date date#
31595>>>>>  sysdate4 date#
31596>>>>>  function_return (DateSegment(date#,DS_YEAR))
31597>>>>>end_function
31598>>>>>
31598>>>>>procedure ItemSysdate for desktop integer itm#
31599>>>>>  local date date#
31600>>>>>  get value item itm# to date#
31601>>>>>  if date# eq 0 begin
31603>>>>>    sysdate4 date#
31604>>>>>    set changed_value item itm# to date#
31605>>>>>  end
31605>>>>>>
31605>>>>>end_procedure
31606>>>>>
31606>>>>>procedure ItemDate2to4 for desktop integer itm#
31607>>>>>  local integer year#
31608>>>>>  local date date# new_date#
31608>>>>>  get value item itm# to date#
31609>>>>>
31609>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31610>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31613>>>>>  else move date# to new_date#
31615>>>>>
31615>>>>>  move (Date2to4(new_date#)) to new_date#
31616>>>>>  move (DateSegment(new_date#,3)) to year#
31617>>>>>  if (year#>99 and year#<1000) begin
31619>>>>>    error 15 // Illegal entry in this window
31620>>>>>>
31620>>>>>    procedure_return 1
31621>>>>>  end
31621>>>>>>
31621>>>>>  if new_date# ne date# set value item itm# to new_date#
31624>>>>>end_procedure
31625>>>>>
31625>>>>>procedure ItemYear2to4 for desktop integer itm#
31626>>>>>  local integer year# new_year#
31627>>>>>  get value item itm# to year#
31628>>>>>  if (year#>99 and year#<1000) begin
31630>>>>>    error 15 // Illegal entry in this window
31631>>>>>>
31631>>>>>    procedure_return 1
31632>>>>>  end
31632>>>>>>
31632>>>>>  move (Year2to4(year#)) to new_year#
31633>>>>>  if new_year# ne year# set value item itm# to new_year#
31636>>>>>end_procedure
31637>>>>>
31637>>>>> procedure FieldSysdate for DataDictionary integer fld#
31638>>>>>   local date date#
31639>>>>>   get field_current_value fld# to date#
31640>>>>>   if date# eq 0 begin
31642>>>>>     sysdate4 date#
31643>>>>>     set field_changed_value fld# to date#
31644>>>>>   end
31644>>>>>>
31644>>>>> end_procedure
31645>>>>>
31645>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31646>>>>>   local integer year#
31647>>>>>   local date date# new_date#
31647>>>>>   get field_current_value fld# to date#
31648>>>>>
31648>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31649>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31652>>>>>   else move date# to new_date#
31654>>>>>
31654>>>>>   move (Date2to4(new_date#)) to new_date#
31655>>>>>   move (DateSegment(new_date#,3)) to year#
31656>>>>>   if (year#>99 and year# <=999) begin
31658>>>>>     error 15 // Illegal entry in this window
31659>>>>>>
31659>>>>>     procedure_return 1
31660>>>>>   end
31660>>>>>>
31660>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31663>>>>> end_procedure
31664>>>>>
31664>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31665>>>>>   local integer year# new_year# changed#
31666>>>>>   get field_current_value fld# to year#
31667>>>>>   get field_changed_state fld# to changed#
31668>>>>>   if changed# begin
31670>>>>>     if (year#>99 and year#<1000) begin
31672>>>>>       error 15 // Illegal entry in this window
31673>>>>>>
31673>>>>>       procedure_return 1
31674>>>>>     end
31674>>>>>>
31674>>>>>     move (Year2to4(year#)) to new_year#
31675>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31678>>>>>   end
31678>>>>>>
31678>>>>> end_procedure
31679>>>>>
31679>>>>> function SysDate global returns date
31680>>>>>   function_return (dSysDate())
31681>>>>> end_function
31682>>>>>
31682>>>>>function sSysTime global returns string
31683>>>>>  local integer h# m# s#
31684>>>>>  sysdate4 h# h# m# s#
31688>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31689>>>>>end_function
31690>>>>>
31690>>>>>function TS_SysTime global returns number
31691>>>>>  local integer d# h# m# s#
31692>>>>>  sysdate4 d# h# m# s#
31696>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31697>>>>>end_function
31698>>>>>
31698>>>>>//> This function returns a TS value composed from the date and time
31698>>>>>//> passed to it. Note that the time variable must be of the format
31698>>>>>//> "hh:mm:ss".
31698>>>>>function TS_Compose global date date# string time# returns number
31699>>>>>  local integer h# m# s#
31700>>>>>  left time# to h# 2
31702>>>>>>
31702>>>>>  mid time# to m# 2 4
31705>>>>>>
31705>>>>>  mid time# to s# 2 7
31708>>>>>>
31708>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31709>>>>>end_function
31710>>>>>
31710>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31711>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31712>>>>>end_function
31713>>>>>
31713>>>>>function TS_ExtractDate global number time# returns date
31714>>>>>  function_return (time#/86400) // 86400=24*60*60
31715>>>>>end_function
31716>>>>>
31716>>>>>function TS_ExtractTime global number time# returns string
31717>>>>>  local integer h# m# s#
31718>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31719>>>>>  move (s#/3600) to h#
31720>>>>>  move (s#-(h#*3600)) to s#
31721>>>>>  move (s#/60) to m#
31722>>>>>  move (s#-(m#*60)) to s#
31723>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31724>>>>>end_function
31725>>>>>
31725>>>>>function TS_ConvertToString global number time# returns string
31726>>>>>  local date d#
31727>>>>>  move (TS_ExtractDate(time#)) to d#
31728>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31731>>>>>  else function_return (TS_ExtractTime(time#))
31733>>>>>end_function
31734>>>>>
31734>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31735>>>>>  local integer h# m#
31736>>>>>  move (ts#/3600) to h#
31737>>>>>  move (ts#-(h#*3600)) to ts#
31738>>>>>  move (ts#/60) to m#
31739>>>>>  move (ts#-(m#*60)) to ts#
31740>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31741>>>>>end_function
31742>>>>>
31742>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31742>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31743>>>>>  local integer obj2# itm2#
31744>>>>>  if num_arguments gt 3 begin
31746>>>>>    move tmp_obj2# to obj2#
31747>>>>>    move tmp_itm2# to itm2#
31748>>>>>  end
31748>>>>>>
31748>>>>>  else begin
31749>>>>>    move obj1# to obj2#
31750>>>>>    move (itm1#+1) to itm2#
31751>>>>>  end
31751>>>>>>
31751>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31752>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31753>>>>>end_procedure
31754>>>>>
31754>>>>>class TS_TimeEstimator is an array
31755>>>>>  procedure construct_object
31756>>>>>    forward send construct_object
31758>>>>>    set delegation_mode to delegate_to_parent
31759>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31760>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31761>>>>>    property number  pnLeft    public 0 // Number of seconds left
31762>>>>>    property number  pnStart   public 0
31763>>>>>    property number  pnPause   public 0
31764>>>>>    property number  pnPercent public 0
31765>>>>>    property integer piMin     public 0
31766>>>>>    property integer piMax     public 0
31767>>>>>  end_procedure
31768>>>>>
31768>>>>>  procedure TS_Start integer min# integer max#
31769>>>>>    set piMin to min#
31770>>>>>    set piMax to max#
31771>>>>>    set pnStart to (TS_SysTime())
31772>>>>>    set pnElapsed to 0
31773>>>>>    set pnPercent to 0
31774>>>>>  end_procedure
31775>>>>>
31775>>>>>  procedure TS_Calculate integer pos#
31776>>>>>    local integer min# max#
31777>>>>>    get piMin to min#
31778>>>>>    get piMax to max#
31779>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31780>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31781>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31782>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31783>>>>>  end_procedure
31784>>>>>
31784>>>>>  procedure TS_Pause
31785>>>>>    set pnPause to (TS_SysTime())
31786>>>>>  end_procedure
31787>>>>>
31787>>>>>  procedure TS_Continue
31788>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31789>>>>>  end_procedure
31790>>>>>end_class
31791>>>>>
31791>>>>>function TS_Module_Compile_Time global string path# returns number
31792>>>>>  local integer pos# day# month# year# seqeof# ch#
31793>>>>>  local string date# str# time#
31793>>>>>  move path# to str#
31794>>>>>  if str# ne "" begin
31796>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31797>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31798>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31800>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31802>>>>>    [ seqeof] move 1 to seqeof#
31803>>>>>    [~seqeof] move 0 to seqeof#
31804>>>>>    [~seqeof] readln str#
31805>>>>>    close_input channel ch#
31807>>>>>  end
31807>>>>>>
31807>>>>>  if seqeof# function_return 0
31810>>>>>  pos "," in str# to pos#
31812>>>>>>
31812>>>>>  move (mid(str#,18,pos#+2)) to str#
31813>>>>>  move (integer(mid(str#,2,4))) to day#
31814>>>>>  move (integer(mid(str#,2,1))) to month#
31815>>>>>  move (integer(mid(str#,2,7))) to year#
31816>>>>>  if year# eq 10 begin
31818>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31819>>>>>    move (mid(str#,8,11)) to str#
31820>>>>>  end
31820>>>>>>
31820>>>>>  else move (mid(str#,8,10)) to str#
31822>>>>>  move (DateCompose(day#,month#,year#)) to date#
31823>>>>>  move (Date2to4(date#)) to date#
31824>>>>>  pos ":" in str# to pos#
31826>>>>>>
31826>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31827>>>>>end_function
31828>>>>>
31828>>>>>string Dates$Module_Compile_Time
31828>>>>>move "" to Dates$Module_Compile_Time
31829>>>>>
31829>>>>>function Module_Compile_Date global returns date
31830>>>>>  local number ts#
31831>>>>>  local string str#
31831>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31832>>>>>  get TS_Module_Compile_Time str# to ts#
31833>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31834>>>>>  function_return (TS_ExtractDate(ts#))
31835>>>>>end_function
31836>>>>>
31836>>>>>function Module_Compile_Time global returns string
31837>>>>>  local date grb#
31838>>>>>  // Module_Compile_Date must be called before this one!
31838>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31841>>>>>  function_return Dates$Module_Compile_Time
31842>>>>>end_function
31843>>>>>
31843>>>>>date   Dates$ModuleStartDate
31843>>>>>string Dates$ModuleStartTime 8
31843>>>>>move (dSysDate()) to Dates$ModuleStartDate
31844>>>>>move (sSysTime()) to Dates$ModuleStartTime
31845>>>>>
31845>>>>>function Module_Start_Date global returns date
31846>>>>>  function_return Dates$ModuleStartDate
31847>>>>>end_function
31848>>>>>
31848>>>>>function Module_Start_Time global returns string
31849>>>>>  function_return Dates$ModuleStartTime
31850>>>>>end_function
31851>>>>>
31851>>>>> register_procedure NotifyPopupCalendarChange date date#
31851>>>>> register_procedure NotifyPopupCalendarSelect date date#
31851>>>>>  use dfAllent
31851>>>>>  class calendar.textbox is a textbox
31852>>>>>    procedure construct_object
31853>>>>>      forward send construct_object
31855>>>>>      Set Auto_Size_State To False
31856>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31857>>>>>    end_procedure
31858>>>>>  end_class
31859>>>>>
31859>>>>>  register_object btn1
31859>>>>>  register_object btn6
31859>>>>>
31859>>>>>  class calendar.button is a button
31860>>>>>
31860>>>>>    procedure construct_object
31861>>>>>      forward send construct_object
31863>>>>>      set size to 15 18
31864>>>>>      on_key kleftarrow   send prev_day
31865>>>>>      on_key krightarrow  send next_day
31866>>>>>      on_key kuparrow     send prev_week
31867>>>>>      on_key kdownarrow   send next_week
31868>>>>>      property date p_assigned_date public 0
31869>>>>>    end_procedure
31870>>>>>
31870>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31871>>>>>      send activate to (btn1(current_object))
31872>>>>>    end_procedure
31873>>>>>    procedure switch_back
31874>>>>>      send activate to (btn6(current_object))
31875>>>>>    end_procedure
31876>>>>>
31876>>>>>    procedure mouse_down
31877>>>>>      local integer current_object#
31878>>>>>      forward send mouse_down
31880>>>>>      move current_object to current_object#
31881>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31883>>>>>    end_procedure
31884>>>>>  end_class
31885>>>>>
31885>>>>>  desktop_section
31891>>>>>    object popup_calendar is a ModalPanel
31893>>>>>      set size to 160 250
31894>>>>>      property date    p_current_date  public 0
31896>>>>>      property integer p_current_year  public -1
31898>>>>>      property integer p_current_month public -1
31900>>>>>      property integer pExportState    public 1
31902>>>>>
31902>>>>>      on_key key_ctrl+key_pgup send prev_year
31903>>>>>      on_key key_ctrl+key_pgdn send next_year
31904>>>>>      on_key          key_pgup send prev_month
31905>>>>>      on_key          key_pgdn send next_month
31906>>>>>      on_key key_ctrl+key_d    send go_today
31907>>>>>      on_key kcancel           send cancel
31908>>>>>
31908>>>>>      object cont3d is a container3d
31910>>>>>        set location to 5 5
31911>>>>>        set size to 120 237
31912>>>>>        object textbox_year is a calendar.textbox
31914>>>>>          set location to 5 5
31915>>>>>          set size to 15 30
31916>>>>>          set border_style to border_staticedge
31917>>>>>          procedure display
31919>>>>>            set value to (p_current_year(current_object))
31920>>>>>          end_procedure
31921>>>>>        end_object
31922>>>>>        object dayname_header is a container3d
31924>>>>>          set location to 5 39
31925>>>>>          set size to 15 126
31926>>>>>          set border_style to border_staticedge
31927>>>>>          procedure initialize
31929>>>>>            local integer itm#
31930>>>>>            for itm# from 0 to 6
31936>>>>>>
31936>>>>>              object txt is a calendar.textbox
31938>>>>>                set size to 12 17
31939>>>>>                set location to 0 (itm#*17.6+1)
31940>>>>>                 set value to (left(DayName(itm#+1),3))
31941>>>>>              end_object
31942>>>>>            loop
31943>>>>>>
31943>>>>>          end_procedure
31944>>>>>          send initialize
31945>>>>>        end_object
31946>>>>>        object weeknumber_header is a container3d
31948>>>>>          set location to 24 5
31949>>>>>          set size     to 89 30
31950>>>>>          set border_style to border_staticedge
31951>>>>>          object obj_id_array is an array
31953>>>>>          end_object
31954>>>>>          procedure initialize
31956>>>>>            local integer itm# obj#
31957>>>>>            move (obj_id_array(current_object)) to obj#
31958>>>>>            for itm# from 0 to 5
31964>>>>>>
31964>>>>>              object txt is a textbox
31966>>>>>                set size to 15 30
31967>>>>>                set location to (itm#*15+1) 1
31968>>>>>                set value of obj# item (item_count(obj#)) to current_object
31969>>>>>              end_object
31970>>>>>            loop
31971>>>>>>
31971>>>>>          end_procedure
31972>>>>>          procedure display
31974>>>>>            local integer itm# obj#
31975>>>>>            local date date# last_date#
31975>>>>>            move (obj_id_array(current_object)) to obj#
31976>>>>>            get p_current_date to date#
31977>>>>>            move (FirstDayInMonth(date#)) to date#
31978>>>>>            move (LastDayInMonth(date#)) to last_date#
31979>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31980>>>>>            for itm# from 0 to 5
31986>>>>>>
31986>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31989>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31991>>>>>            loop
31992>>>>>>
31992>>>>>          end_procedure
31993>>>>>          send initialize
31994>>>>>        end_object
31995>>>>>        object days_grid is a container3d
31997>>>>>          set location to 23 39
31998>>>>>          set size     to 100 127
31999>>>>>          set border_style to border_none
32000>>>>>          object btn_array is an array
32002>>>>>          end_object
32003>>>>>          procedure initialize
32005>>>>>            local integer row# col# button_array#
32006>>>>>            move (btn_array(current_object)) to button_array#
32007>>>>>            for row# from 0 to 5
32013>>>>>>
32013>>>>>              for col# from 0 to 6
32019>>>>>>
32019>>>>>                object btn is a calendar.button
32021>>>>>                  set location to (row#*15) (col#*18)
32022>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32023>>>>>                  on_item "" send move_value_out_ok
32024>>>>>                end_object
32025>>>>>              loop
32026>>>>>>
32026>>>>>            loop
32027>>>>>>
32027>>>>>          end_procedure
32028>>>>>          send initialize
32029>>>>>
32029>>>>>          procedure display.iii integer itm# integer day# integer activate#
32031>>>>>            local integer obj# current_day#
32032>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32033>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32034>>>>>            if activate# begin
32036>>>>>              if day# eq current_day# send activate to obj#
32039>>>>>            end
32039>>>>>>
32039>>>>>            else begin
32040>>>>>              if day# begin
32042>>>>>                set value of obj# to day#
32043>>>>>                set visible_state of obj# to true
32044>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32045>>>>>              end
32045>>>>>>
32045>>>>>              else set visible_state of obj# to false
32047>>>>>            end
32047>>>>>>
32047>>>>>          end_procedure
32048>>>>>
32048>>>>>          procedure display integer activate#
32050>>>>>            local integer first_item# last_item# itm# day# date#
32051>>>>>            get p_current_date to date#
32052>>>>>            move (FirstDayInMonth(date#)) to date#
32053>>>>>            move (DateDayNumber(date#)-1) to first_item#
32054>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32055>>>>>            ifnot activate# begin
32057>>>>>              for itm# from 0 to (first_item#-1)
32063>>>>>>
32063>>>>>                send display.iii itm# 0 0
32064>>>>>              loop
32065>>>>>>
32065>>>>>            end
32065>>>>>>
32065>>>>>            move 1 to day#
32066>>>>>            for itm# from first_item# to last_item#
32072>>>>>>
32072>>>>>              send display.iii itm# day# activate#
32073>>>>>              increment day#
32074>>>>>            loop
32075>>>>>>
32075>>>>>            ifnot activate# begin
32077>>>>>              for itm# from (last_item#+1) to 41
32083>>>>>>
32083>>>>>                send display.iii itm# 0 0
32084>>>>>              loop
32085>>>>>>
32085>>>>>            end
32085>>>>>>
32085>>>>>          end_procedure
32086>>>>>        end_object
32087>>>>>        object txt_month is a calendar.textbox
32089>>>>>          set size to 12 27
32090>>>>>          set location to 25 185
32091>>>>>          set value to t.calendar.month
32092>>>>>        end_object
32093>>>>>        object btn1 is a button
32095>>>>>          set size to 12 12
32096>>>>>          set location to 40 185
32097>>>>>          on_item "" send prev_month
32098>>>>>          set bitmap to "prev.bmp"
32099>>>>>          procedure switch_back
32101>>>>>            send display_main
32102>>>>>          end_procedure
32103>>>>>        end_object
32104>>>>>        object btn2 is a button
32106>>>>>          set size to 12 12
32107>>>>>          set location to 40 200
32108>>>>>          on_item "" send next_month
32109>>>>>          set bitmap to "next.bmp"
32110>>>>>        end_object
32111>>>>>        object txt_year is a calendar.textbox
32113>>>>>          set size to 12 27
32114>>>>>          set location to 70 185
32115>>>>>          set value to t.calendar.year
32116>>>>>        end_object
32117>>>>>        object btn3 is a button
32119>>>>>          set size to 12 12
32120>>>>>          set location to 85 185
32121>>>>>          on_item "" send prev_year
32122>>>>>          set bitmap to "prev.bmp"
32123>>>>>        end_object
32124>>>>>        object btn4 is a button
32126>>>>>          set size to 12 12
32127>>>>>          set location to 85 200
32128>>>>>          on_item "" send next_year
32129>>>>>          set bitmap to "next.bmp"
32130>>>>>        end_object
32131>>>>>      end_object
32132>>>>>      object btn5 is a button
32134>>>>>        set size to 14 60
32135>>>>>        set location to 129 115
32136>>>>>        on_item t.calendar.ok send move_value_out_ok
32137>>>>>      end_object
32138>>>>>      object btn6 is a button
32140>>>>>        set size to 14 60
32141>>>>>        set location to 129 182
32142>>>>>        on_item t.calendar.cancel send cancel
32143>>>>>        procedure switch
32145>>>>>          send display_main
32146>>>>>        end_procedure
32147>>>>>      end_object
32148>>>>>      procedure next_year
32150>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32151>>>>>        send display_main
32152>>>>>      end_procedure
32153>>>>>      procedure prev_year
32155>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32156>>>>>        send display_main
32157>>>>>      end_procedure
32158>>>>>      procedure next_month
32160>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32161>>>>>        send display_main
32162>>>>>      end_procedure
32163>>>>>      procedure prev_month
32165>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32166>>>>>        send display_main
32167>>>>>      end_procedure
32168>>>>>      procedure next_week
32170>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32171>>>>>        send display_main
32172>>>>>      end_procedure
32173>>>>>      procedure prev_week
32175>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32176>>>>>        send display_main
32177>>>>>      end_procedure
32178>>>>>      procedure next_day
32180>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32181>>>>>        send display_main
32182>>>>>      end_procedure
32183>>>>>      procedure prev_day
32185>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32186>>>>>        send display_main
32187>>>>>      end_procedure
32188>>>>>      procedure go_today
32190>>>>>        local date date#
32191>>>>>        sysdate4 date#
32192>>>>>        set p_current_date to date#
32193>>>>>        send display_main
32194>>>>>      end_procedure
32195>>>>>      property integer invoking_object_id public 0
32197>>>>>      procedure OnChange date date#
32199>>>>>        local integer focus# dm#
32200>>>>>        get invoking_object_id to focus#
32201>>>>>        if focus# gt desktop begin
32203>>>>>          get delegation_mode of focus# to dm#
32204>>>>>          set delegation_mode of focus# to no_delegate_or_error
32205>>>>>          send NotifyPopupCalendarChange to focus# date#
32206>>>>>          set delegation_mode of focus# to dm#
32207>>>>>        end
32207>>>>>>
32207>>>>>      end_procedure
32208>>>>>      procedure display
32210>>>>>        local integer date# month# year#
32211>>>>>        get p_current_date to date#
32212>>>>>        send OnChange date#
32213>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32214>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32215>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32217>>>>>          set p_current_year to year#
32218>>>>>          set p_current_month to month#
32219>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32220>>>>>          send display to (textbox_year(cont3d(current_object)))
32221>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32222>>>>>          send display to (days_grid(cont3d(current_object))) 0
32223>>>>>        end
32223>>>>>>
32223>>>>>      end_procedure
32224>>>>>      procedure display_main
32226>>>>>        send display
32227>>>>>        send display to (days_grid(cont3d(current_object))) 1
32228>>>>>      end_procedure
32229>>>>>      procedure popup_no_export
32231>>>>>        set pExportState to false
32232>>>>>        send popup
32233>>>>>        set pExportState to true
32234>>>>>      end_procedure
32235>>>>>
32235>>>>>      procedure popup_group
32237>>>>>        local integer focus#
32238>>>>>        local date date#
32238>>>>>        move (focus(desktop)) to focus#
32239>>>>>        set invoking_object_id to focus#
32240>>>>>        get value of focus# item current to date#
32241>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32244>>>>>        move (Date2to4(date#)) to date#
32245>>>>>        set p_current_date to date#
32246>>>>>        send display
32247>>>>>        forward send popup_group
32249>>>>>        send display to (days_grid(cont3d(current_object))) 1
32250>>>>>      end_procedure
32251>>>>>
32251>>>>>      procedure move_value_out
32253>>>>>        local integer focus# dm# margin# datatype#
32254>>>>>        if (pExportState(current_object)) begin
32256>>>>>          get invoking_object_id to focus#
32257>>>>>          if focus# gt desktop begin
32259>>>>>            get delegation_mode of focus# to dm#
32260>>>>>            set delegation_mode of focus# to no_delegate_or_error
32261>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32262>>>>>            get form_margin of focus# item current to margin#
32263>>>>>            get form_datatype of focus# item current to datatype#
32264>>>>>            set delegation_mode of focus# to dm#
32265>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32268>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32270>>>>>            set item_changed_state of focus# item current to true
32271>>>>>          end
32271>>>>>>
32271>>>>>        end
32271>>>>>>
32271>>>>>      end_procedure
32272>>>>>
32272>>>>>      procedure move_value_out_ok
32274>>>>>        send move_value_out
32275>>>>>        send deactivate
32276>>>>>      end_procedure
32277>>>>>
32277>>>>>      procedure request_popup
32279>>>>>        local integer focus# type# dm#
32280>>>>>        move (focus(desktop)) to focus#
32281>>>>>        if focus# gt desktop begin
32283>>>>>          get delegation_mode of focus# to dm#
32284>>>>>          set delegation_mode of focus# to no_delegate_or_error
32285>>>>>          get form_datatype of focus# item current to type#
32286>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32289>>>>>          set delegation_mode of focus# to dm#
32290>>>>>        end
32290>>>>>>
32290>>>>>      end_procedure
32291>>>>>    end_object
32292>>>>>  end_desktop_section
32294>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32294>>>>>  // substitute would become negative (because located on the desktop). This
32294>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32294>>>>>  procedure request_popup_calendar for BaseClass
32295>>>>>    send request_popup to (popup_calendar(current_object))
32296>>>>>  end_procedure
32297>>>>>  procedure popup_calendar_no_export
32298>>>>>    send popup_no_export to (popup_calendar(current_object))
32299>>>>>  end_procedure
32300>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32300>>>>>  procedure Add_Calendar_tbButton integer oTb#
32301>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32302>>>>>  end_procedure
32303>>>>> function s.calendar returns integer // Backwards compatible!!
32304>>>>>   function_return (popup_calendar(current_object))
32305>>>>> end_function
32306>>>>>
32306>>>>>// Karl,
32306>>>>>// Structure is as follows,
32306>>>>>//
32306>>>>>// //put this code in the top portion of the view code or in the program
32306>>>>>// code.
32306>>>>>//
32306>>>>>// Type SystemTime
32306>>>>>//   field SystemTime.iYear As Word
32306>>>>>//   field SystemTime.iMonth As Word
32306>>>>>//   field SystemTime.iDayOfWeek As Word
32306>>>>>//   field SystemTime.iDay As Word
32306>>>>>//   field SystemTime.iHour As Word
32306>>>>>//   field SystemTime.iMinute As Word
32306>>>>>//   field SystemTime.iSecond As Word
32306>>>>>//   field SystemTime.iMilliseconds As Word
32306>>>>>// End_Type
32306>>>>>//
32306>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32306>>>>>//
32306>>>>>// //put this code in an onClick or wherever
32306>>>>>// procedure onclick
32306>>>>>//   local integer iRetVal
32306>>>>>//   local string TimeData
32306>>>>>//   local pointer GST
32306>>>>>//
32306>>>>>//   ZeroType SystemTime to TimeData
32306>>>>>//   getAddress from TimeData to GST
32306>>>>>//
32306>>>>>//   move (GetSystemTime(GST)) to iRetVal
32306>>>>>// end_procedure
32306>>>>>//
32306>>>>>// To extract the data from the Structure after calling the function use
32306>>>>>// the getbuff command as follows:
32306>>>>>//
32306>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32306>>>>>//
32306>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32306>>>>>//
32306>>>>>// OLIVER NELSON
32306>>>>>//
32306>>>>>//
32306>>>
32306>>>//AB-StoreTopEnd
32306>>>
32306>>>//AB-IgnoreStart
32306>>>
32306>>>Use DFAllEnt.pkg
32306>>>
32306>>>
32306>>>//AB-IgnoreEnd
32306>>>
32306>>>CD_Popup_Object oCalendar is a dbModalPanel
32325>>>
32325>>>    //AB-StoreTopStart
32325>>>    on_key kcancel           send cancel
32326>>>    //AB-StoreTopEnd
32326>>>
32326>>>    Set Border_Style to Border_Normal
32327>>>    Set Caption_Bar to FALSE
32328>>>    Set Label to "Ÿ­¢ àì, 2001"
32329>>>    Set Size to 98 123
32330>>>    Set Location to 10 22
32331>>>    Set Color to clWhite
32332>>>
32332>>>    //AB-DDOStart
32332>>>
32332>>>
32332>>>    //AB-DDOEnd
32332>>>
32332>>>    Object Container3d1 is a Container3d
32334>>>        Set Size to 88 135
32335>>>        Set Location to -2 -1
32336>>>        Set Color to clWhite
32337>>>        Set Border_Style to Border_None
32338>>>        Object Grid2 is a Grid
32340>>>
32340>>>            //AB-StoreTopStart
32340>>>            property date    p_current_date     public 0
32342>>>            property integer p_current_year     public -1
32344>>>            property integer p_current_month    public -1
32346>>>            property integer p_selected_day     public -1
32348>>>            property integer pExportState       public 1
32350>>>            property integer invoking_object_id public 0
32352>>>            
32352>>>            Set Border_Style To BORDER_NONE
32353>>>            Set header_visible_state To False
32354>>>            set select_mode to no_select
32355>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32356>>>            
32356>>>            on_key Key_F1 Send Help
32357>>>            on_key key_ctrl+key_pgup send prev_year
32358>>>            on_key key_ctrl+key_pgdn send next_year
32359>>>            on_key          key_pgup send prev_month
32360>>>            on_key          key_pgdn send next_month
32361>>>            on_key key_enter         send move_value_out
32362>>>            on_key key_ctrl+key_d    send go_today
32363>>>            
32363>>>            //AB-StoreTopEnd
32363>>>
32363>>>            Set Color to clWhite
32364>>>            Set CurrentCellColor to clWhite
32365>>>            Set CurrentCellTextColor to clWhite
32366>>>            Set Size to 61 145
32367>>>            Set Location to 30 1
32368>>>            Set Resize_Column_state to FALSE
32369>>>
32369>>>            Set Line_Width to 7 0
32370>>>
32370>>>            Set Form_Width    item 0 to 18
32371>>>            Set Header_Label  item 0 to "­"
32372>>>            
32372>>>            Set Form_Width    item 1 to 18
32373>>>            Set Header_Label  item 1 to "‚â"
32374>>>            
32374>>>            Set Form_Width    item 2 to 18
32375>>>            Set Header_Label  item 2 to "‘à"
32376>>>            
32376>>>            Set Form_Width    item 3 to 18
32377>>>            Set Header_Label  item 3 to "—â"
32378>>>            
32378>>>            Set Form_Width    item 4 to 18
32379>>>            Set Header_Label  item 4 to "â"
32380>>>            
32380>>>            Set Form_Width    item 5 to 18
32381>>>            Set Header_Label  item 5 to "‘¡"
32382>>>            
32382>>>            Set Form_Width    item 6 to 18
32383>>>            Set Header_Label  item 6 to "‚á"
32384>>>            
32384>>>
32384>>>            //AB-StoreStart
32384>>>            
32384>>>            procedure go_today
32386>>>                Date date#
32387>>>                sysdate4 date#
32388>>>                set p_current_date to date#
32389>>>                Send Update_Calendar
32390>>>            end_procedure
32391>>>            
32391>>>            procedure next_month
32393>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32394>>>                Send Update_Calendar
32395>>>            end_procedure
32396>>>            
32396>>>            procedure prev_month
32398>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32399>>>                Send Update_Calendar
32400>>>            end_procedure
32401>>>            
32401>>>            procedure next_year
32403>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32404>>>                Send Update_Calendar
32405>>>            end_procedure
32406>>>            
32406>>>            procedure prev_year
32408>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32409>>>                Send Update_Calendar
32410>>>            end_procedure
32411>>>            
32411>>>            Procedure Activate
32413>>>                Date date#
32414>>>                Forward Send Activate
32416>>>                Set current_item to (p_selected_day(Self))
32417>>>            End_Procedure
32418>>>            
32418>>>            Procedure Update_Calendar
32420>>>                Set Dynamic_Update_State To False
32421>>>                send Fill_List
32422>>>                Set Dynamic_Update_State To True
32423>>>                // Send Update_Label
32423>>>                Set current_item to (p_selected_day(Self))
32424>>>                Send Date_Changing to (oYear(Container3d2(self)))
32425>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32426>>>            End_Procedure
32427>>>            
32427>>>            Procedure Fill_List
32429>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32430>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32430>>>                Date dToday
32430>>>                Send Delete_Data
32431>>>            
32431>>>                Get p_current_date to date#
32432>>>            
32432>>>                SysDate4 dToday
32433>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32434>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32435>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32436>>>            
32436>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32437>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32438>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32439>>>                Set p_current_month To sel_month#
32440>>>                Set p_current_year To sel_year#
32441>>>            
32441>>>                move (FirstDayInMonth(date#)) to date#
32442>>>                move (DateDayNumber(date#)-1) to first_item#
32443>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32444>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32445>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32446>>>            
32446>>>                If (first_item# > 0) Begin
32448>>>                    Move (first_item#-1) to day#
32449>>>                    For iFor from 0 to (first_item#-1)
32455>>>>
32455>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32456>>>                        Set Entry_State Item iFor To False
32457>>>                        Set ItemTextColor Item iFor To clGray
32458>>>                        Decrement day#
32459>>>                    Loop
32460>>>>
32460>>>                End
32460>>>>
32460>>>            
32460>>>                Move 1 To day#
32461>>>                For iFor from first_item# to last_item#
32467>>>>
32467>>>                    Send Add_Item Msg_Move_Value_Out day#
32468>>>                    Set Entry_State Item iFor To False
32469>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32472>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32475>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32476>>>                    Set form_datatype item iFor To mask_numeric_window
32477>>>                    Set form_Mask item iFor To "## "
32478>>>                    Increment day#
32479>>>                Loop
32480>>>>
32480>>>            
32480>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32481>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32482>>>            
32482>>>                If (last_item# < 41) Begin
32484>>>                    Move 1 to day#
32485>>>                    For iFor from (last_item#+1) to 41
32491>>>>
32491>>>                        Send Add_Item msg_move_value_out day#
32492>>>                        Set Entry_State Item iFor To False
32493>>>                        Set ItemTextColor Item iFor To clGray
32494>>>                        Increment day#
32495>>>                    Loop
32496>>>>
32496>>>                End
32496>>>>
32496>>>            
32496>>>            End_Procedure
32497>>>            
32497>>>            Procedure Help
32499>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32500>>>            End_Procedure
32501>>>            
32501>>>            procedure mouse_click integer window integer char_pos
32503>>>                Send Move_Value_Out
32504>>>                forward send mouse_click window char_pos
32506>>>            end_procedure
32507>>>            
32507>>>            Procedure Move_Value_Out
32509>>>                Integer iYear iMonth iDay iItm
32510>>>                Date Date# next_date# prev_date#
32510>>>                Get Current_Item To iItm
32511>>>                If (pExportState(Self)) Begin
32513>>>                    Get Value Item iItm To iDay
32514>>>                    Get p_current_month to iMonth
32515>>>                    Get p_current_year  to iYear
32516>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32517>>>            
32517>>>                    If ((iItm>27)and(iDay<15)) Begin
32519>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32520>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32521>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32522>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32523>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32524>>>                    End
32524>>>>
32524>>>                    If ((iItm<7)and(iDay>20)) Begin
32526>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32527>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32528>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32529>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32530>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32531>>>                    End
32531>>>>
32531>>>            
32531>>>                    Send Export_Date date#
32532>>>                End
32532>>>>
32532>>>            End_Procedure
32533>>>            
32533>>>            Procedure Export_Date date date#
32535>>>                local integer focus# dm# margin# datatype#
32536>>>                get invoking_object_id to focus#
32537>>>            
32537>>>                if focus# gt desktop begin
32539>>>                     get delegation_mode of focus# to dm#
32540>>>                     set delegation_mode of focus# to no_delegate_or_error
32541>>>                     get form_margin of focus# item current to margin#
32542>>>                     get form_datatype of focus# item current to datatype#
32543>>>                     set delegation_mode of focus# to dm#
32544>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32547>>>                     else             set value of focus# item current to (Date4to2(date#))
32549>>>                     set item_changed_state of focus# item current to true
32550>>>                end
32550>>>>
32550>>>                Send Close_Calendar
32551>>>            End_Procedure
32552>>>            //AB-StoreEnd
32552>>>
32552>>>        End_Object    // Grid2
32553>>>
32553>>>        Object Textbox2 is a Textbox
32555>>>            Set Label to "­"
32556>>>            Set Auto_Size_State to FALSE
32557>>>            Set Transparent_State to TRUE
32558>>>            Set Color to clWhite
32559>>>            Set TextColor to clNavy
32560>>>            Set Location to 19 4
32561>>>            Set Size to 10 15
32562>>>
32562>>>            //AB-StoreStart
32562>>>                                        
32562>>>            Set Label To (left(t.calendar.Monday,2))
32563>>>            //AB-StoreEnd
32563>>>
32563>>>        End_Object    // Textbox2
32564>>>
32564>>>        Object Textbox3 is a Textbox
32566>>>            Set Label to "‚â"
32567>>>            Set Auto_Size_State to FALSE
32568>>>            Set Transparent_State to TRUE
32569>>>            Set Color to clWhite
32570>>>            Set TextColor to clNavy
32571>>>            Set Location to 19 22
32572>>>            Set Size to 10 12
32573>>>
32573>>>            //AB-StoreStart
32573>>>                                        
32573>>>            Set Label To (left(t.calendar.Tuesday,2))
32574>>>            //AB-StoreEnd
32574>>>
32574>>>        End_Object    // Textbox3
32575>>>
32575>>>        Object Textbox4 is a Textbox
32577>>>            Set Label to "‘à"
32578>>>            Set Auto_Size_State to FALSE
32579>>>            Set Transparent_State to TRUE
32580>>>            Set Color to clWhite
32581>>>            Set TextColor to clNavy
32582>>>            Set Location to 19 39
32583>>>            Set Size to 10 15
32584>>>
32584>>>            //AB-StoreStart
32584>>>                                        
32584>>>            Set Label To (left(t.calendar.Wednesday,2))
32585>>>            //AB-StoreEnd
32585>>>
32585>>>        End_Object    // Textbox4
32586>>>
32586>>>        Object Textbox5 is a Textbox
32588>>>            Set Label to "—â"
32589>>>            Set Auto_Size_State to FALSE
32590>>>            Set Transparent_State to TRUE
32591>>>            Set Color to clWhite
32592>>>            Set TextColor to clNavy
32593>>>            Set Location to 19 57
32594>>>            Set Size to 10 17
32595>>>
32595>>>            //AB-StoreStart
32595>>>                                        
32595>>>            Set Label To (left(t.calendar.Thursday,2))
32596>>>            //AB-StoreEnd
32596>>>
32596>>>        End_Object    // Textbox5
32597>>>
32597>>>        Object Textbox6 is a Textbox
32599>>>            Set Label to "â"
32600>>>            Set Auto_Size_State to FALSE
32601>>>            Set Transparent_State to TRUE
32602>>>            Set Color to clWhite
32603>>>            Set TextColor to clNavy
32604>>>            Set Location to 19 76
32605>>>            Set Size to 10 17
32606>>>
32606>>>            //AB-StoreStart
32606>>>                                        
32606>>>            Set Label To (left(t.calendar.Friday,2))
32607>>>            //AB-StoreEnd
32607>>>
32607>>>        End_Object    // Textbox6
32608>>>
32608>>>        Object Textbox7 is a Textbox
32610>>>            Set Label to "‘¡"
32611>>>            Set Auto_Size_State to FALSE
32612>>>            Set Transparent_State to TRUE
32613>>>            Set Color to clWhite
32614>>>            Set TextColor to clNavy
32615>>>            Set Location to 19 91
32616>>>            Set Size to 10 18
32617>>>
32617>>>            //AB-StoreStart
32617>>>                                        
32617>>>            Set Label To (left(t.calendar.Saturday,2))
32618>>>            //AB-StoreEnd
32618>>>
32618>>>        End_Object    // Textbox7
32619>>>
32619>>>        Object Textbox8 is a Textbox
32621>>>            Set Label to "‚á"
32622>>>            Set Auto_Size_State to FALSE
32623>>>            Set Transparent_State to TRUE
32624>>>            Set Color to clWhite
32625>>>            Set TextColor to clNavy
32626>>>            Set Location to 19 109
32627>>>            Set Size to 10 17
32628>>>
32628>>>            //AB-StoreStart
32628>>>                                        
32628>>>            Set Label To (left(t.calendar.Sunday,2))
32629>>>            //AB-StoreEnd
32629>>>
32629>>>        End_Object    // Textbox8
32630>>>
32630>>>        Object LineControl1 is a LineControl
32632>>>            Set Line_Style to lnSINGLE
32633>>>            Set Size to 1 116
32634>>>            Set Location to 28 4
32635>>>
32635>>>            //AB-StoreStart
32635>>>                                        
32635>>>            //AB-StoreEnd
32635>>>
32635>>>        End_Object    // LineControl1
32636>>>
32636>>>        Object Container3d2 is a Container3d
32638>>>            Set Size to 18 131
32639>>>            Set Location to 1 1
32640>>>            Set Color to clNavy
32641>>>            Set Border_Style to Border_None
32642>>>            Object oRght is a BitmapContainer
32644>>>                Set Size to 10 14
32645>>>                Set Location to 4 105
32646>>>                Set Bitmap to "rght.bmp"
32647>>>                Set Border_Style to Border_None
32648>>>
32648>>>                //AB-StoreStart
32648>>>                Procedure Mouse_Down
32650>>>                    Send Next_Month to Grid2
32651>>>                End_Procedure
32652>>>                //AB-StoreEnd
32652>>>
32652>>>            End_Object    // oRght
32653>>>
32653>>>            Object oLeft is a BitmapContainer
32655>>>                Set Size to 10 14
32656>>>                Set Location to 4 3
32657>>>                Set Bitmap to "lft.bmp"
32658>>>                Set Border_Style to Border_None
32659>>>
32659>>>                //AB-StoreStart
32659>>>                Procedure Mouse_Down
32661>>>                    Send Prev_Month to Grid2
32662>>>                End_Procedure
32663>>>                //AB-StoreEnd
32663>>>
32663>>>            End_Object    // oLeft
32664>>>
32664>>>            Object oMonth is a Textbox
32666>>>
32666>>>                //AB-StoreTopStart
32666>>>                Property integer piSelected_Month public 0
32668>>>                //AB-StoreTopEnd
32668>>>
32668>>>                Set Label to "January"
32669>>>                Set Auto_Size_State to FALSE
32670>>>                Set Transparent_State to TRUE
32671>>>                Set Color to clWhite
32672>>>                Set TextColor to clWhite
32673>>>                Set Location to 4 23
32674>>>                Set Size to 10 43
32675>>>                Set FontWeight to 800
32676>>>                Set Justification_Mode to jMode_Center
32677>>>
32677>>>                //AB-StoreStart
32677>>>                                    
32677>>>                Procedure Mouse_Down
32679>>>                    Integer iState
32680>>>                    Get Visible_State of oSelectYear to iState
32681>>>                    If (iState) Send OnKillFocus to oSelectYear
32684>>>                    Send Popup to oSelectMonth
32685>>>                End_Procedure
32686>>>                
32686>>>                Procedure pSelectJan
32688>>>                    Set Label to t.calendar.january
32689>>>                    Set piSelected_Month to 1
32690>>>                    Send Adjust_Calendar
32691>>>                End_Procedure
32692>>>                Procedure pSelectFeb
32694>>>                    Set Label to t.calendar.february
32695>>>                    Set piSelected_Month to 2
32696>>>                    Send Adjust_Calendar
32697>>>                End_Procedure
32698>>>                Procedure pSelectMar
32700>>>                    Set Label to t.calendar.march
32701>>>                    Set piSelected_Month to 3
32702>>>                    Send Adjust_Calendar
32703>>>                End_Procedure
32704>>>                Procedure pSelectApr
32706>>>                    Set Label to t.calendar.april
32707>>>                    Set piSelected_Month to 4
32708>>>                    Send Adjust_Calendar
32709>>>                End_Procedure
32710>>>                Procedure pSelectMay
32712>>>                    Set Label to t.calendar.may
32713>>>                    Set piSelected_Month to 5
32714>>>                    Send Adjust_Calendar
32715>>>                End_Procedure
32716>>>                Procedure pSelectJun
32718>>>                    Set Label to t.calendar.june
32719>>>                    Set piSelected_Month to 6
32720>>>                    Send Adjust_Calendar
32721>>>                End_Procedure
32722>>>                Procedure pSelectJul
32724>>>                    Set Label to t.calendar.july
32725>>>                    Set piSelected_Month to 7
32726>>>                    Send Adjust_Calendar
32727>>>                End_Procedure
32728>>>                Procedure pSelectAug
32730>>>                    Set Label to t.calendar.august
32731>>>                    Set piSelected_Month to 8
32732>>>                    Send Adjust_Calendar
32733>>>                End_Procedure
32734>>>                Procedure pSelectSep
32736>>>                    Set Label to t.calendar.september
32737>>>                    Set piSelected_Month to 9
32738>>>                    Send Adjust_Calendar
32739>>>                End_Procedure
32740>>>                Procedure pSelectOct
32742>>>                    Set Label to t.calendar.october
32743>>>                    Set piSelected_Month to 10
32744>>>                    Send Adjust_Calendar
32745>>>                End_Procedure
32746>>>                Procedure pSelectNov
32748>>>                    Set Label to t.calendar.november
32749>>>                    Set piSelected_Month to 11
32750>>>                    Send Adjust_Calendar
32751>>>                End_Procedure
32752>>>                Procedure pSelectDec
32754>>>                    Set Label to t.calendar.december
32755>>>                    Set piSelected_Month to 12
32756>>>                    Send Adjust_Calendar
32757>>>                End_Procedure
32758>>>                
32758>>>                Object oSelectMonth is a FloatingPopupMenu
32760>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32761>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32762>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32763>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32764>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32765>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32766>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32767>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32768>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32769>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32770>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32771>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32772>>>                End_Object
32773>>>                
32773>>>                Procedure Adjust_Calendar
32775>>>                    Date date#
32776>>>                    Integer iDay iMonth iYear iItm
32776>>>                    Set Visible_State to false
32777>>>                    Set Visible_State to true
32778>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32779>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32780>>>                    Get piSelected_Month to iMonth
32781>>>                    Get Label of oYear to iYear
32782>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32783>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32784>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32785>>>                End_Procedure
32786>>>                
32786>>>                Procedure Activating
32788>>>                    Forward Send Activating
32790>>>                    Send Date_Changing
32791>>>                End_Procedure
32792>>>                
32792>>>                Procedure Date_Changing
32794>>>                    Set Visible_State to false
32795>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32796>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32797>>>                    Set Visible_State to true
32798>>>                End_Procedure
32799>>>                
32799>>>                
32799>>>                //AB-StoreEnd
32799>>>
32799>>>            End_Object    // oMonth
32800>>>
32800>>>            Object oYear is a Textbox
32802>>>                Set Label to "2001"
32803>>>                Set Transparent_State to TRUE
32804>>>                Set Color to clWhite
32805>>>                Set TextColor to clWhite
32806>>>                Set Location to 4 77
32807>>>                Set Size to 10 18
32808>>>                Set FontWeight to 800
32809>>>
32809>>>                //AB-StoreStart
32809>>>                                                    
32809>>>                Procedure Mouse_Down
32811>>>                    String sVal
32812>>>                    Get Label to sVal
32813>>>                    Set Value of oSelectYear item 0 to sVal
32814>>>                    Set Visible_State of oSelectYear to True
32815>>>                    Send Activate to (oSelectYear(Self))
32816>>>                End_Procedure
32817>>>                
32817>>>                Procedure Activating
32819>>>                    Forward Send Activating
32821>>>                    Send Date_Changing
32822>>>                End_Procedure
32823>>>                
32823>>>                Procedure Date_Changing
32825>>>                    Set Visible_State to false
32826>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32827>>>                    Set Visible_State to true
32828>>>                End_Procedure
32829>>>                //AB-StoreEnd
32829>>>
32829>>>            End_Object    // oYear
32830>>>
32830>>>            Object oSelectYear is a Form
32832>>>
32832>>>                //AB-StoreTopStart
32832>>>                Set Visible_State To False
32833>>>                //AB-StoreTopEnd
32833>>>
32833>>>                Set Size to 10 24
32834>>>                Set Location to 4 75
32835>>>                Set Color to clWhite
32836>>>                Set TextColor to clNavy
32837>>>                Set Form_Border Item 0 to Border_Normal
32838>>>
32838>>>                //AB-StoreStart
32838>>>                                                    
32838>>>                On_Key Key_Enter Send OnKillFocus
32839>>>                On_Key Key_Escape Send OnKillFocus
32840>>>                
32840>>>                Procedure SetFontWeight
32842>>>                    Set Form_FontWeight item 0 to 800
32843>>>                End_Procedure
32844>>>                
32844>>>                Procedure OnKillFocus
32846>>>                    String sVal
32847>>>                    Integer iMonth iDay iYear iItm
32847>>>                    Date date#
32847>>>                    Get Value item 0 to sVal
32848>>>                    Set Visible_State of oYear to false
32849>>>                    Set Label of oYear to sVal
32850>>>                    Set Visible_State of oYear to true
32851>>>                    Set Visible_State to false
32852>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32853>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32854>>>                    Get piSelected_Month of oMonth to iMonth
32855>>>                    Get Value item 0 to iYear
32856>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32857>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32858>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32859>>>                End_Procedure
32860>>>                
32860>>>                Send SetFontWeight
32861>>>                //AB-StoreEnd
32861>>>
32861>>>            End_Object    // oSelectYear
32862>>>
32862>>>
32862>>>            //AB-StoreStart
32862>>>                            
32862>>>            Procedure Mouse_Down
32864>>>                Integer iState
32865>>>                Get Visible_State of oSelectYear to iState
32866>>>                If (iState) Send OnKillFocus to oSelectYear
32869>>>            End_Procedure
32870>>>            
32870>>>            //AB-StoreEnd
32870>>>
32870>>>        End_Object    // Container3d2
32871>>>
32871>>>
32871>>>        //AB-StoreStart
32871>>>                            
32871>>>        //AB-StoreEnd
32871>>>
32871>>>    End_Object    // Container3d1
32872>>>
32872>>>    Object BitmapContainer3 is a BitmapContainer
32874>>>        Set Size to 9 19
32875>>>        Set Location to 88 3
32876>>>        Set Color to clWhite
32877>>>        Set Bitmap to "cdate.bmp"
32878>>>        Set Border_Style to Border_None
32879>>>
32879>>>        //AB-StoreStart
32879>>>        Procedure Mouse_Down
32881>>>            Send go_today to (Grid2(Container3d1(Self)))
32882>>>            Send Adjust_Label to oToday
32883>>>        End_Procedure
32884>>>        //AB-StoreEnd
32884>>>
32884>>>    End_Object    // BitmapContainer3
32885>>>
32885>>>    Object oToday is a Textbox
32887>>>        Set Label to "Today: 01.01.2001"
32888>>>        Set Auto_Size_State to FALSE
32889>>>        Set Color to clWhite
32890>>>        Set Location to 88 22
32891>>>        Set Size to 8 73
32892>>>        Set FontWeight to 800
32893>>>
32893>>>        //AB-StoreStart
32893>>>        Procedure Mouse_Down
32895>>>            Send go_today to (Grid2(Container3d1(Self)))
32896>>>            Send Adjust_Label
32897>>>        End_Procedure
32898>>>        
32898>>>        Procedure Adjust_Label
32900>>>            date date#
32901>>>            SysDate4 date#
32902>>>            Set Visible_State To false
32903>>>            Set Label         to (t.calendar.today+": "+String(date#))
32904>>>            Set Visible_State To true
32905>>>        End_Procedure
32906>>>        
32906>>>        Procedure Activating
32908>>>            Forward Send Activating
32910>>>            Send Adjust_Label
32911>>>        End_Procedure
32912>>>        //AB-StoreEnd
32912>>>
32912>>>    End_Object    // oToday
32913>>>
32913>>>
32913>>>    //AB-StoreStart
32913>>>                
32913>>>    procedure popup
32915>>>        local integer focus# icItm iYear iMonth
32916>>>        local date date#
32916>>>        move (focus(desktop)) to focus#
32917>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32918>>>        get value of focus# item current to date#
32919>>>        ifnot (integer(date#)) sysdate date#
32922>>>        move (Date2to4(date#)) to date#
32923>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32924>>>        send fill_list to (Grid2(Container3d1(self)))
32925>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32926>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32927>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32928>>>        forward send popup
32930>>>    end_procedure
32931>>>    
32931>>>    Procedure Close_Calendar
32933>>>        Send Exit
32934>>>    End_Procedure
32935>>>    //AB-StoreEnd
32935>>>
32935>>>CD_End_Object    // oCalendar
32937>>>>
32937>>>
32937>>>
32937>>>//AB-StoreStart
32937>>>    
32937>>>    
32937>>>//AB-StoreEnd
32937>>>
32937>>>//AB/ End_Object    // prj
32937>Use Dates.Utl
32937>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
32937>>>// ===========================================================================
32937>>>//
32937>>>// The ROUND_NUMBER global function has been designed to return the rounded
32937>>>// value of a given 'numeric' argument at a specified rounding precision.
32937>>>//
32937>>>// ---------------------------------------------------------------------------
32937>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32937>>>// necessary calculations.  It uses a string handling technique instead.
32937>>>// ---------------------------------------------------------------------------
32937>>>//
32937>>>// The function requires two arguments, as follows:-
32937>>>//
32937>>>// (a) The numeric value to be rounded, where the range of valid values is
32937>>>//     +/- 99,999,999,999,999.99999999.
32937>>>//
32937>>>// (b) The rounding precision required.  This must be an integer value in the
32937>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32937>>>//     threshold value is substituted.
32937>>>//
32937>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32937>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32937>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32937>>>//     round progressively to the left of the decimal point (a frequent
32937>>>//     requirement in financial reporting).
32937>>>//
32937>>>// If the result of the rounding produces a value outside the valid numeric
32937>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32937>>>//
32937>>>// Assumptions:-  The only assumptions made have been that the range of
32937>>>// numeric values and the limit of eight decimal places are unlikely to change
32937>>>// in the forseeable future.
32937>>>//
32937>>>// Examples:-
32937>>>//
32937>>>//  1st Argument      2nd Argument   Return Value
32937>>>//  ------------      ------------   ------------
32937>>>//  123456.87654321         8         123456.87654321
32937>>>//  123456.87654321         2         123456.88
32937>>>// -123456.87654321         2        -123456.88
32937>>>//  123456.98765432         0         123457
32937>>>// -123456.98765432        -1        -123460
32937>>>//  123456.98765432        -2         123500
32937>>>//  123456.98765432        -3         123000
32937>>>//  987654                 -4         990000
32937>>>//  987654                 -5        1000000
32937>>>//  987654                 -6        1000000
32937>>>//  987654                 -7              0
32937>>>//
32937>>>// ===========================================================================
32937>>>
32937>>>
32937>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32938>>>
32938>>>  Local Number nAdj
32939>>>
32939>>>  Move 10000000000000 to nAdj
32940>>>
32940>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32940>>>
32940>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32943>>>
32943>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32943>>>
32943>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32946>>>
32946>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32946>>>
32946>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32947>>>
32947>>>End_Function
32948>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
32948>>>//AB/ Project Connect
32948>>>//AB/ Object prj is a Dialog_Project
32948>>>//AB/     Set ProjectName to "Connect"
32948>>>//AB/     Set ProjectFileName to "Connect.dg"
32948>>>
32948>>>// Project Object Structure
32948>>>//   Connect is a BasicPanelSub
32948>>>//     BitmapContainer1 is a BitmapContainerSub
32948>>>//     Textbox5 is a TextBoxSub
32948>>>//     ComboForm2 is a ComboFormSub
32948>>>//     Textbox6 is a TextBoxSub
32948>>>//     Form4 is a FormSub
32948>>>//     Textbox7 is a TextBoxSub
32948>>>//     Form5 is a FormSub
32948>>>//     Textbox8 is a TextBoxSub
32948>>>//     Form6 is a FormSub
32948>>>//     CheckBox1 is a CheckBoxSub
32948>>>//     oOK_bn is a ButtonSub
32948>>>//     oCancel_bn is a ButtonSub
32948>>>
32948>>>// Register all objects
32948>>>Register_Object BitmapContainer1
32948>>>Register_Object CheckBox1
32948>>>Register_Object ComboForm2
32948>>>Register_Object Connect
32948>>>Register_Object Form4
32948>>>Register_Object Form5
32948>>>Register_Object Form6
32948>>>Register_Object oCancel_bn
32948>>>Register_Object oOK_bn
32948>>>Register_Object Textbox5
32948>>>Register_Object Textbox6
32948>>>Register_Object Textbox7
32948>>>Register_Object Textbox8
32948>>>
32948>>>
32948>>>
32948>>>//AB-StoreTopStart
32948>>>
32948>>>///#INCLUDE
32948>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
32948>>>>>USE UI
32948>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
32948>>>>>// This command will issue a properly commands to define the FETCH attribute status
32948>>>>>// for file fields.
32948>>>>>//
32948>>>>>//------------------------------------------------------------------------------
32948>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SQL_FOR_ONEROW <file number>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
32948>>>>>// one ROW for each DataFlex FIND command issued
32948>>>>>// In this case the DBMS optimizer will generate a query with just one row
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------------------------------------------
32948>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
32948>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
32948>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
32948>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
32948>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------
32948>>>>>// SQL_SET <stmt>
32948>>>>>//
32948>>>>>//-----------------------------------------
32948>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
32948>>>>>//
32948>>>>>//------------
32948>>>>>// SQL_EXECUTE
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------
32948>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
32948>>>>>//
32948>>>>>// LOCK_TABLE will lock the entire table specified as an argument
32948>>>>>// This command will start a new transaction if it still wasn't done.
32948>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
32948>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
32948>>>>>// rows and then atualize their buffers
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------
32948>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
32948>>>>>//
32948>>>>>//-------------------------------
32948>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
32948>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
32948>>>>>//
32948>>>>>//-------------------------------------------------
32948>>>>>// OPEN_INT <DATAFLEX FILE NAME>
32948>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
32948>>>>>//
32948>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
32948>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
32948>>>>>// will issue a OPEN command
32948>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
32948>>>>>//
32948>>>>>//=========================================================================================================
32948>>>>>// SELECT STUFFS
32948>>>>>//--------------
32948>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
32948>>>>>//
32948>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
32948>>>>>//
32948>>>>>//
32948>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
32948>>>>>//
32948>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
32948>>>>>//
32948>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
32948>>>>>//
32948>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_COMMIT_STMT
32948>>>>>//
32948>>>>>// SQL_ROLLBACK_STMT
32948>>>>>//
32948>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
32948>>>>>//
32948>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------------------------------------------------------------------------------------
32948>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
32948>>>>>// Writes a message inside driver log trace file if this is activated
32948>>>>>//
32948>>>>>//-----------------------------------------------------
32948>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
32948>>>>>// Generating the INT file
32948>>>>>//
32948>>>>>// -----------------------
32948>>>>>// SQL_ERROR_MESSAGE <VAR>
32948>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
32948>>>>>
32948>>>>>
32948>>>>>//=======================================================================================
32948>>>>>// SQLFlex Commands
32948>>>>>//-----------------
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// SQLFlex_REVISION <VAR>
32948>>>>>// Retrieves SQLFlex revision
32948>>>>>//
32948>>>>>//-------------------------------------
32948>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
32948>>>>>// Sets current database
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// GET_DATABASE_NAME TO <VAR>
32948>>>>>// Gets name of current database
32948>>>>>//
32948>>>>>//----------------------------------
32948>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
32948>>>>>// Sets current schema name
32948>>>>>//
32948>>>>>//-------------------------
32948>>>>>// GET_SCHEMA_NAME TO <VAR>
32948>>>>>// Gets current schema name
32948>>>>>//
32948>>>>>//--------------------------------
32948>>>>>// SQL_USEDATABASE <DATABASE NAME>
32948>>>>>// Specifies the current Database
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// SET_CURRENT_SERVER TO <VAR>
32948>>>>>// Set the current logged server
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// GET_CURRENT_SERVER TO <VAR>
32948>>>>>// Retrieves the current logged server
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SET_HOST_NAME TO <HOST NAME>
32948>>>>>// Defines current host name
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// GET_HOST_NAME TO <VAR>
32948>>>>>// Retrieves the current host name
32948>>>>>//
32948>>>>>//---------------------------------------------------------------
32948>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
32948>>>>>// Specifies host name during login process
32948>>>>>//
32948>>>>>// SQL_CANCEL_QUERY_STMT
32948>>>>>//
32948>>>>>//========================================
32948>>>>>// SQL SERVER Stored Procedure Call engine
32948>>>>>//----------------------------------------
32948>>>>>//
32948>>>>>//
32948>>>>>
32948>>>>>//
32948>>>>>//--------------------------------------------------------------------------------------------------------------
32948>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
32948>>>>>//
32948>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
32948>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
32948>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// ORAFlex Commands
32948>>>>>//-----------------
32948>>>>>//----------------------------
32948>>>>>// ORAFlex_REVISION <VARIABLE>
32948>>>>>// Retrieves ORAFlex revision
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
32948>>>>>// Keeps all files opened even during a LOGOUT
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
32948>>>>>//
32948>>>>>//---------------------------------------------
32948>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the number of opened cursors
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
32948>>>>>// Activates Time stamp for date columns
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------------------------------------
32948>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// BUFFER save stuffs
32948>>>>>//-------------------
32948>>>>>
32948>>>>>//-------------------------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
32948>>>>>// Initialize the BUFFER buffer
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
32948>>>>>// Moves field buffer values to cache buffer
32948>>>>>//-------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
32948>>>>>// Save rows that remains in cache
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>
32948>>>//AB-StoreTopEnd
32948>>>
32948>>>//AB-IgnoreStart
32948>>>
32948>>>Use Panel.Sub
32948>>>Use Bitmap.Sub
32948>>>Use Txtbox.Sub
32948>>>Use Cmbfrm.Sub
32948>>>Use Form.Sub
32948>>>Use Chkbox.Sub
32948>>>Use Button.Sub
32948>>>
32948>>>
32948>>>//AB-IgnoreEnd
32948>>>
32948>>>Object Connect is a BasicPanelSub
32950>>>
32950>>>    //AB-StoreTopStart
32950>>>
32950>>>    //AB-StoreTopEnd
32950>>>
32950>>>    Set Sysmenu_Icon to FALSE
32951>>>    Set Minimize_Icon to FALSE
32952>>>    Set Label to "Login"
32953>>>    Set Size to 105 230
32954>>>    Set Location to 20 37
32955>>>
32955>>>    //AB-DDOStart
32955>>>
32955>>>
32955>>>    //AB-DDOEnd
32955>>>
32955>>>    Object BitmapContainer1 is a BitmapContainerSub
32957>>>        Set Size to 21 23
32958>>>        Set Location to 4 4
32959>>>        Set Bitmap to "Login1.bmp"
32960>>>        Set Border_Style to Border_None
32961>>>        Set Bitmap_Style to Bitmap_Center
32962>>>        Set Dialog_Caption to "Select a bitmap file"
32963>>>
32963>>>        //AB-StoreStart
32963>>>
32963>>>
32963>>>
32963>>>
32963>>>        //AB-StoreEnd
32963>>>
32963>>>    End_Object    // BitmapContainer1
32964>>>
32964>>>    Object Textbox5 is a TextBoxSub
32966>>>        Set Label to "Driver:"
32967>>>        Set FontSize to 4 0
32968>>>        Set Location to 6 34
32969>>>        Set Size to 13 40
32970>>>        Set TypeFace to "MS Sans Serif"
32971>>>        Set Enabled_State to TRUE
32972>>>    End_Object    // Textbox5
32973>>>
32973>>>    Object ComboForm2 is a ComboFormSub
32975>>>
32975>>>        //AB-StoreTopStart
32975>>>
32975>>>        Set CapsLock_State to True
32976>>>
32976>>>        //AB-StoreTopEnd
32976>>>
32976>>>        Set Size to 13 85
32977>>>        Set Location to 6 76
32978>>>        Set Label_Col_Offset to 2
32979>>>        Set Label_Justification_Mode to jMode_Right
32980>>>
32980>>>        //AB-StoreStart
32980>>>        Procedure Combo_Fill_List
32982>>>                Local String Availdrv## TempDrv##
32983>>>                Local Integer HowMany i p1## p2##
32983>>>
32983>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
32986>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
32989>>>                insert "WorkSpaces\" in AvailDrv## at 1
32991>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
32994>>>
32994>>>                Move Availdrv## to Tempdrv##
32995>>>                Repeat
32995>>>>
32995>>>                    Replace "|" in Tempdrv## With ""
32997>>>                    [Found] Increment HowMany
32998>>>                Until [Finderr]
33000>>>
33000>>>                Send Combo_add_Item ""
33001>>>
33001>>>                If HowMany lt 1 Begin
33003>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33006>>>                End
33006>>>>
33006>>>                Else Begin
33007>>>                    For i From 0 to HowMany
33013>>>>
33013>>>                        If i eq 0 Move 1 to p1##
33016>>>                        Else Begin
33017>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33018>>>                            Replace "|" in Availdrv## With ","
33020>>>                        End
33020>>>>
33020>>>                        Move ((Pos("|",Availdrv##))) to p2##
33021>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33022>>>                    Loop
33023>>>>
33023>>>                End
33023>>>>
33023>>>        End_Procedure
33024>>>
33024>>>        Set Allow_Blank_state to True
33025>>>
33025>>>
33025>>>
33025>>>        //AB-StoreEnd
33025>>>
33025>>>    End_Object    // ComboForm2
33026>>>
33026>>>    Object Textbox6 is a TextBoxSub
33028>>>        Set Label to "Server:"
33029>>>        Set FontSize to 4 0
33030>>>        Set Location to 22 34
33031>>>        Set Size to 13 40
33032>>>        Set TypeFace to "MS Sans Serif"
33033>>>        Set Enabled_State to TRUE
33034>>>    End_Object    // Textbox6
33035>>>
33035>>>    Object Form4 is a FormSub
33037>>>        Set Size to 13 93
33038>>>        Set Location to 22 76
33039>>>        Set Label_Col_Offset to 2
33040>>>        Set Label_Justification_Mode to jMode_Right
33041>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33042>>>    End_Object    // Form4
33043>>>
33043>>>    Object Textbox7 is a TextBoxSub
33045>>>        Set Label to "User Name:"
33046>>>        Set FontSize to 4 0
33047>>>        Set Location to 38 34
33048>>>        Set Size to 13 40
33049>>>        Set TypeFace to "MS Sans Serif"
33050>>>        Set Enabled_State to TRUE
33051>>>    End_Object    // Textbox7
33052>>>
33052>>>    Object Form5 is a FormSub
33054>>>        Set Size to 13 93
33055>>>        Set Location to 38 76
33056>>>        Set Label_Col_Offset to 2
33057>>>        Set Label_Justification_Mode to jMode_Right
33058>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33059>>>    End_Object    // Form5
33060>>>
33060>>>    Object Textbox8 is a TextBoxSub
33062>>>        Set Label to "Password:"
33063>>>        Set FontSize to 4 0
33064>>>        Set Location to 54 34
33065>>>        Set Size to 13 40
33066>>>        Set TypeFace to "MS Sans Serif"
33067>>>        Set Enabled_State to TRUE
33068>>>    End_Object    // Textbox8
33069>>>
33069>>>    Object Form6 is a FormSub
33071>>>        Set Size to 13 93
33072>>>        Set Location to 54 76
33073>>>        Set Label_Col_Offset to 2
33074>>>        Set Label_Justification_Mode to jMode_Right
33075>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33076>>>
33076>>>        //AB-StoreStart
33076>>>        Set Password_State Item 0 to True
33077>>>
33077>>>        //AB-StoreEnd
33077>>>
33077>>>    End_Object    // Form6
33078>>>
33078>>>    Object CheckBox1 is a CheckBoxSub
33080>>>        Set Label to "Save Password"
33081>>>        Set Size to 10 66
33082>>>        Set Location to 73 76
33083>>>        Set Status_Help to "Remember The Password at Next Login"
33084>>>    End_Object    // CheckBox1
33085>>>
33085>>>    Object oOK_bn is a ButtonSub
33087>>>        Set Label to "Co&nnect"
33088>>>        Set Default_State to TRUE
33089>>>        Set Bitmap to "mcr.bmp"
33090>>>        Set Size to 28 33
33091>>>        Set Location to 9 184
33092>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33093>>>
33093>>>        //AB-StoreStart
33093>>>        Procedure OnClick
33095>>>            Set LoginOk to True
33096>>>            Send Stop_Modal_ui
33097>>>        End_Procedure
33098>>>        Set Status_Help to "Connect"
33099>>>        //AB-StoreEnd
33099>>>
33099>>>    End_Object    // oOK_bn
33100>>>
33100>>>    Object oCancel_bn is a ButtonSub
33102>>>        Set Label to "&Cancel"
33103>>>        Set Bitmap to "exit2.bmp"
33104>>>        Set Size to 28 32
33105>>>        Set Location to 39 184
33106>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33107>>>
33107>>>        //AB-StoreStart
33107>>>
33107>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33108>>>
33108>>>        Procedure OnClick
33110>>>            Set LoginOk to False
33111>>>            Send Exit_Application to (Connect(Current_Object))
33112>>>        End_Procedure
33113>>>
33113>>>        Set Status_Help to "Close Application"
33114>>>
33114>>>
33114>>>        //AB-StoreEnd
33114>>>
33114>>>    End_Object    // oCancel_bn
33115>>>
33115>>>
33115>>>    //AB-StoreStart
33115>>>
33115>>>    Set Modal_State to True
33116>>>
33116>>>    // Now is WorkspaceAware
33116>>>
33116>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33117>>>    ON_KEY KSAVE_RECORD SEND OK
33118>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33119>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33120>>>
33120>>>    Set Locate_Mode to Center_On_Screen
33121>>>    Set Exit_Application_Local_State to False
33122>>>    Set Exit_MSG to Exit
33123>>>    Set Description_State to True
33124>>>
33124>>>    Property Integer LoginOk public false
33126>>>
33126>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33127>>>
33127>>>    Function Network_User_Name Returns String
33129>>>        Local String sName sLength
33130>>>        Local Pointer lpName_Addr lpLength_Addr
33130>>>        Local Integer iRetval
33130>>>
33130>>>        Movestr (Repeat (Character (0), 255)) To sName
33131>>>>
33131>>>        GetAddress Of sName To lpName_Addr
33132>>>        Movestr (DwordToBytes (255)) To sLength
33133>>>>
33133>>>        GetAddress Of sLength To lpLength_Addr
33134>>>
33134>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33135>>>>
33135>>>
33135>>>        If iRetval Eq 0 Function_Return (CString (sName))
33138>>>        Else Function_Return "User Unknown"
33140>>>    End_Function // Network_User_Name
33141>>>
33141>>>    Function fsCrypto String lsWay String lsOld Returns String
33143>>>        Local String lsNew lsTemp
33144>>>        Local Integer liCount
33144>>>           For liCount From 1 to (Length(lsOld))
33150>>>>
33150>>>               Mid lsOld to lsTemp 1 liCount
33153>>>>
33153>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33155>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33158>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33160>>>               End
33160>>>>
33160>>>               Else Begin
33161>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33163>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33166>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33168>>>                   End
33168>>>>
33168>>>               End
33168>>>>
33168>>>               Append lsNew lsTemp
33169>>>           Loop
33170>>>>
33170>>>        Function_Return (lsNew)
33171>>>    End_Function
33172>>>
33172>>>    Procedure Activating
33174>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33175>>>        Local String LastLogin## LoginSeq##
33175>>>        Local Integer SavePassword##
33175>>>
33175>>>        Forward Send Activating
33177>>>
33177>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33180>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33183>>>        insert "WorkSpaces\" in LastLogin## at 1
33185>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33188>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33191>>>
33191>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33194>>>        Else Move LoginSeq## to LoginDriver##
33196>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33199>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33202>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33205>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33208>>>
33208>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33210>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33211>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33212>>>        End
33212>>>>
33212>>>        Else Begin
33213>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33214>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33215>>>        End
33215>>>>
33215>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33216>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33217>>>        If (SavePassword##) Begin
33219>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33220>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33224>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33225>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33226>>>        End
33226>>>>
33226>>>    End_Procedure
33227>>>
33227>>>    Function LoginUser Returns Integer
33229>>>        Integer SavePassword## Size## PasswordOk
33230>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33230>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33230>>>        Integer liOpenCursors
33230>>>
33230>>>        Send Popup_Modal
33231>>>
33231>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33232>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33233>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33234>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33235>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33236>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33237>>>
33237>>>    //tolis 03/02/2004
33237>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33239>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33239>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33239>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33239>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33239>>>    //        send trap_error to (error_info_object(current_object)) 25000
33239>>>    //        send trap_error to (error_info_object(current_object)) 4255
33239>>>    //        send trap_error to (error_info_object(current_object)) 12293
33239>>>    //        If LastErr eq 25000 Begin
33239>>>    //            Error LastErr "Invalid Login Information"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 4255 Begin
33239>>>    //            Error LastErr "Invalid Driver Name"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 12293 Begin
33239>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33239>>>    //            Set LoginOk to False
33239>>>    //           Send Exit_Application
33239>>>    //      End
33239>>>            Set LoginOk to True
33240>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33240>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33240>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33240>>>    //        End
33240>>>        End
33240>>>>
33240>>>        Else Begin
33241>>>            Set LoginOk to True
33242>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33244>>>            Move "DATAFLEX" To LoginDriver##
33245>>>            Move "" to LoginServer##
33246>>>            File_Size Users to Size##
33249>>>            If Size## ne 0 Begin
33251>>>                 Clear Users
33252>>>                 Move LoginUSerId##   to Users.Login_Id
33253>>>                 Find eq Users by Index.1
33254>>>>
33254>>>                 [Finderr] Begin
33256>>>>
33256>>>                    Error 25000 "Unknown User"
33257>>>>
33257>>>                    Set LoginOk to False
33258>>>                    Get LoginOk to PasswordOk
33259>>>                    Function_Return PasswordOk
33260>>>                 End
33260>>>>
33260>>>                 [Found] Begin
33262>>>>
33262>>>                    If (LoginPassword## ne Users.Password) Begin
33264>>>                        Error 25000 "Invalid Password"
33265>>>>
33265>>>                        Set LoginOk to False
33266>>>                        Get LoginOk to PasswordOk
33267>>>                        Function_Return PasswordOk
33268>>>                    End
33268>>>>
33268>>>                    Else Move Users.Departm_Code to sDepartment
33270>>>                    Move (Trim(sDepartment)) to sDepartment
33271>>>                 End
33271>>>>
33271>>>            End
33271>>>>
33271>>>            Close Users
33272>>>
33272>>>
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>    //            Integer bFileExists
33272>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>    //            If (NOT(bFileExists)) Begin
33272>>>
33272>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33272>>>    //                If (bFileExists) Begin
33272>>>
33272>>>    ////                        If Size## ne 0 Begin
33272>>>
33272>>>    //                            Local String ss1 ss2 ss3 ss4
33272>>>    //                            Local String dd1 dd2 dd3 dd4
33272>>>    //                            Move '' to dd1
33272>>>    //                            Move '' to dd2
33272>>>    //                            Move '' to dd3
33272>>>    //                            Move '' to dd4
33272>>>
33272>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33272>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            While (Not(Seqeof))
33272>>>    //                                Move (Trim(ss1)) to ss1
33272>>>    //                                Move (Trim(ss2)) to ss2
33272>>>    //                                Move (Trim(ss3)) to ss3
33272>>>    //                                Move (Trim(ss4)) to ss4
33272>>>    //                                Append dd1 '"' ss1 '"'
33272>>>    //                                Append dd2 '"' ss2 '"'
33272>>>    //                                Append dd3 '"' ss3 '"'
33272>>>    //                                Append dd4 '"' ss4 '"'
33272>>>    //                                Login dd1 dd2 dd3 dd4
33272>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            Loop
33272>>>
33272>>>
33272>>>    ////                            // Only Filmnet Users Log on to SQL
33272>>>    ////                            If (sDepartment='FILMNET') Begin
33272>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33272>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            End
33272>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33272>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>
33272>>>    ////                        End
33272>>>    ////                        Else Begin
33272>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33272>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                        End
33272>>>
33272>>>
33272>>>    //                End
33272>>>
33272>>>    //            End
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>            //*Integer bFileExists
33272>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>            //*If (NOT(bFileExists)) Begin
33272>>>            //*    If Size## ne 0 Begin
33272>>>            //*        // Only Filmnet Users Log on to SQL
33272>>>            //*        If (sDepartment='FILMNET') Begin
33272>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*        End
33272>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*    End
33272>>>            //*    Else Begin
33272>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*    End
33272>>>            //*
33272>>>            //*End
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>        End
33272>>>>
33272>>>
33272>>>        Open Users
33274>>>        //Open "Users" as Users
33274>>>        File_Size Users to Size##
33277>>>        If Size## ne 0 Begin
33279>>>             Clear Users
33280>>>             Move LoginUSerId##   to Users.Login_Id
33281>>>             Find eq Users by Index.1
33282>>>>
33282>>>             [Finderr] Begin
33284>>>>
33284>>>                Error 25000 "Unknown User"
33285>>>>
33285>>>                Set LoginOk to False
33286>>>                Get LoginOk to PasswordOk
33287>>>                Function_Return PasswordOk
33288>>>             End
33288>>>>
33288>>>             [Found] Begin
33290>>>>
33290>>>                If (LoginPassword## ne Users.Password) Begin
33292>>>                    Error 25000 "Invalid Password"
33293>>>>
33293>>>                    Set LoginOk to False
33294>>>                    Get LoginOk to PasswordOk
33295>>>                    Function_Return PasswordOk
33296>>>                End
33296>>>>
33296>>>                Else Move Users.Departm_Code to sDepartment
33298>>>                Move (Trim(sDepartment)) to sDepartment
33299>>>             End
33299>>>>
33299>>>        End
33299>>>>
33299>>>        Close Users
33300>>>
33300>>>        Get LoginOk to PasswordOk
33301>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33305>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33308>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33311>>>        insert "WorkSpaces\" in LastLogin## at 1
33313>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33316>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33318>>>           If Not LoginDriver## in LoginSeq## Begin
33320>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33323>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33325>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33328>>>           End
33328>>>>
33328>>>        End
33328>>>>
33328>>>        Append LastLogin## "\" (Module_Name(Self))
33330>>>        Append LastLogin## "\LastLogin"
33331>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33334>>>
33334>>>        If "|" in LoginSeq## Begin
33336>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33340>>>        End
33340>>>>
33340>>>        Else Begin
33341>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33344>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33349>>>        End
33349>>>>
33349>>>        Left LoginSeq## to LoginSeq## 250
33351>>>>
33351>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33354>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33357>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33360>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33363>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33367>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33371>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33375>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33381>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33384>>>        If (SavePassword##) Begin
33386>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33387>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33390>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33391>>>        End
33391>>>>
33391>>>        Else Begin
33392>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33393>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33396>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33397>>>        End
33397>>>>
33397>>>
33397>>>        Function_Return PasswordOk
33398>>>    End_Function
33399>>>
33399>>>    Procedure Login For Desktop
33400>>>        Local Integer LoginPassword##
33401>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33402>>>        If Not LoginPassword## Send Exit_Application
33405>>>    End_Procedure
33406>>>
33406>>>    Function CheckLogin For Desktop Returns Integer
33407>>>        Local Integer LoginPassword##
33408>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33409>>>        Function_Return LoginPassword##
33410>>>    End_Function
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>    //AB-StoreEnd
33411>>>
33411>>>End_Object    // Connect
33412>>>
33412>>>
33412>>>//AB-StoreStart
33412>>>
33412>>>
33412>>>
33412>>>//AB-StoreEnd
33412>>>
33412>>>//AB/ End_Object    // prj
33412>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33412>>>
33412>>>
33412>>>Function Check_Afm Global String Afm_Num Returns Integer
33413>>>    Integer iii Num1 Num2
33414>>>
33414>>>    Move (Trim(Afm_Num)) To Afm_Num
33415>>>
33415>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33421>>>>
33421>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33424>>>    Loop
33425>>>>
33425>>>
33425>>>    Move (Right(Afm_Num,1)) to Num2
33426>>>
33426>>>    If (Length(Afm_Num)<>9) Function_Return 2
33429>>>
33429>>>    Move 0 to Num1
33430>>>
33430>>>    For iii From 1 to 8
33436>>>>
33436>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33437>>>    Loop
33438>>>>
33438>>>
33438>>>    Move (Mod(Num1,11)) to Num1
33439>>>    If (Num1=10) Move 0 to Num1
33442>>>
33442>>>    If (Num1=Num2)  Function_Return 0
33445>>>    Else            Function_Return 1
33447>>>End_Function
33448>>>
33448>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33448>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33450>>>open syscurxr
33452>>>open gplan
INCLUDING FILE: GPLAN.FD
33454>>>//open gplanl
33454>>>open iteml
INCLUDING FILE: ITEML.FD
33456>>>open cn
INCLUDING FILE: CN.FD
33458>>>open payresp
INCLUDING FILE: PAYRESP.FD
33460>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33462>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33464>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33466>>>open clients
INCLUDING FILE: CLIENTS.FD
33468>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33470>>>open wax
INCLUDING FILE: WAX.FD
33472>>>Function Check_log Global String slog Returns Integer
33473>>>    clear gplan
33474>>>    move syscurxr.company_code to gplan.company_code
33475>>>    move syscurxr.branch_code  to gplan.branch_code
33476>>>    move syscurxr.year_year    to gplan.year_year
33477>>>    move slog                  to gplan.gplan_code
33478>>>    find eq gplan by index.1
33479>>>>
33479>>>    if (found=1) function_return 0
33482>>>    else         function_return 1
33484>>>
33484>>>End_Function
33485>>>
33485>>>Function Check_last Global String slog Returns Integer
33486>>>    clear gplan
33487>>>    move syscurxr.company_code to gplan.company_code
33488>>>    move syscurxr.branch_code  to gplan.branch_code
33489>>>    move syscurxr.year_year    to gplan.year_year
33490>>>    move slog                  to gplan.gplan_code
33491>>>    find eq gplan by index.1
33492>>>>
33492>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33495>>>    else                                         Function_return 1
33497>>>
33497>>>End_Function
33498>>>
33498>>>Function fsgplandescr String slog Returns string
33499>>>    clear gplan
33500>>>    move syscurgl.company_code to gplan.company_code
33501>>>    move syscurgl.branch_code  to gplan.branch_code
33502>>>    move syscurgl.year_year    to gplan.year_year
33503>>>    move slog                  to gplan.gplan_code
33504>>>    find eq gplan by index.1
33505>>>>
33505>>>    if (found=1) function_return gplan.gplan_descr1
33508>>>    else         function_return ''
33510>>>
33510>>>End_Function
33511>>>
33511>>>//Function fsgplanperi String slog Returns string
33511>>>//    string sdescr
33511>>>//    clear gplanl
33511>>>//    move syscurgl.company_code to  gplanl.company_code
33511>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33511>>>//    move slog                  to  gplanl.gplan_code
33511>>>//    find eq gplanl by index.1
33511>>>//    if (found=1) begin
33511>>>//        move gplanl.gplan_descr1 to sdescr
33511>>>//        function_return sdescr
33511>>>//    end
33511>>>//    else         function_return ''
33511>>>//End_Function
33511>>>
33511>>>
33511>>>
33511>>>Function fsclient string code Returns string
33512>>>    string name
33513>>>    clear clients
33514>>>    move code to clients.client_id
33515>>>    find eq clients by index.6
33516>>>>
33516>>>    if (found) move clients.client_name to name
33519>>>    else       move '' to name
33521>>>    function_return name
33522>>>end_Function
33523>>>
33523>>>Function fspayresp string code Returns string
33524>>>    string name
33525>>>    clear payresp
33526>>>    move code to payresp.presp_id
33527>>>    find eq payresp by index.7
33528>>>>
33528>>>    if (found) move payresp.presp_name to name
33531>>>    else       move '' to name
33533>>>    function_return name
33534>>>end_Function
33535>>>
33535>>>Function fssalesmen string code Returns string
33536>>>    string name
33537>>>    clear salesmen
33538>>>    move code to salesmen.sls_id
33539>>>    find eq salesmen by index.4
33540>>>>
33540>>>    if (found) move salesmen.sls_name to name
33543>>>    else       move '' to name
33545>>>    function_return name
33546>>>end_Function
33547>>>
33547>>>Function fsconstrct string code Returns string
33548>>>    string name
33549>>>    clear constrct
33550>>>    move code to constrct.cnt_id
33551>>>    find eq constrct by index.5
33552>>>>
33552>>>    if (found) move constrct.cnt_name to name
33555>>>    else       move '' to name
33557>>>    function_return name
33558>>>end_Function
33559>>>
33559>>>Function fsmhxanik string code Returns string
33560>>>    string name
33561>>>    clear mhxanik
33562>>>    move code to mhxanik.mhx_id
33563>>>    find eq mhxanik by index.4
33564>>>>
33564>>>    if (found) move mhxanik.mhx_name to name
33567>>>    else       move '' to name
33569>>>    function_return name
33570>>>end_Function
33571>>>
33571>>>
33571>>>Function fsptyppar string code Returns string
33572>>>    string sdescr
33573>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33574>>>    move syscurxr.company_code to ptypparl.company_code
33575>>>    move syscurxr.branch_code  to ptypparl.branch_code
33576>>> //   move syscurxr.year_year    to ptypparl.year_year
33576>>>    move code                  to ptypparl.ptyppar_code
33577>>>    find eq ptypparl by index.1
33578>>>>
33578>>>    move ptypparl.ptyppar_descr to sdescr
33579>>>    function_return sdescr
33580>>>end_Function
33581>>>
33581>>>Function fsgplan string code Returns string
33582>>>    string sdescr
33583>>>    clear gplan
33584>>>    move syscurxr.company_code to gplan.company_code
33585>>>    move syscurxr.branch_code  to gplan.branch_code
33586>>>    move syscurxr.year_year    to gplan.year_year
33587>>>    move code                  to gplan.gplan_code
33588>>>    find eq gplan by index.1
33589>>>>
33589>>>    move gplan.gplan_descr1    to sdescr
33590>>>    function_return sdescr
33591>>>end_Function
33592>>>
33592>>>Function fsitem string scode Returns string
33593>>>    clear iteml
33594>>>    move scode to iteml.item_code
33595>>>    find eq iteml by index.5
33596>>>>
33596>>>    function_return iteml.item_descr
33597>>>end_Function
33598>>>
33598>>>Function fswax string srecr Returns string
33599>>>    clear wax
33600>>>    move srecr to wax.wax_recr
33601>>>    find eq wax by index.2
33602>>>>
33602>>>    function_return wax.wax_descr
33603>>>end_Function
33604>>>
33604>>>
33604>>>Function fswitemx string code Returns string
33605>>>    string name
33606>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33607>>>    move syscurxr.company_code to witemx.company_code
33608>>>    move syscurxr.branch_code  to witemx.branch_code
33609>>>    move syscurxr.year_year    to witemx.year_year
33610>>>    move code to witemx.witemx_code
33611>>>    find eq witemx by index.5
33612>>>>
33612>>>    move witemx.witemx_descr to name
33613>>>    function_return name
33614>>>end_Function
33615>>>
33615>>>Function fsCNDescr String asItem Returns String
33616>>>    Clear CN
33617>>>    move asItem to CN.CN_Code
33618>>>    Find Eq CN by Index.5
33619>>>>
33619>>>    Function_Return CN.CN_Descr
33620>>>End_Function
33621>>>
33621>>>Function fswtypkin String askin Returns String
33622>>>    Clear Wtypkin
33623>>>    move askin to Wtypkin.wtypkin_code
33624>>>    Find Eq wtypkin by Index.1
33625>>>>
33625>>>    Function_Return Wtypkin.wtypkin_descr
33626>>>End_Function
33627>>>
33627>>>Function FindGtypkinDescr Integer aiCode Returns String
33628>>>    String lsDescr
33629>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33630>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33631>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33632>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33633>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33634>>>    Find eq Gtypkin by Index.1
33635>>>>
33635>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33636>>>    Function_Return lsDescr
33637>>>End_Function // FindGtypkinDescr
33638>>>
33638>>>Function FindBtypkinDescr Integer aiCode Returns String
33639>>>    String lsDescr
33640>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33641>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33642>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33643>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33644>>>    Move aiCode                   to Btypkin.btypkin_Code
33645>>>    Find eq Btypkin by Index.1
33646>>>>
33646>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33647>>>    Function_Return lsDescr
33648>>>End_Function // FindGtypkinDescr
33649>>>
33649>>>
33649>Send Login
33650>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
33650>>>// Statement of purpose:
33650>>>// When using a reread command in VDF you will unfortunately lock many more
33650>>>// files than are necessary.  In order to only lock the files necessary I
33650>>>// use the following procedure to set all files to readonly, manually set
33650>>>// the files being worked on to (default) and then reset all back at the end.
33650>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
33650>>>
33650>>>// The original package is a contribution of another programmer whom I cannot
33650>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
33650>>>// with a non-default filemode will be set back to it's previous setting.
33650>>>
33650>>>Object FileModeArray Is An Array
33652>>>    // 0 = File Number
33652>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
33652>>>End_Object
33653>>>
33653>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
33654>>>    Integer iCounter hArray iExists
33655>>>    Move (FileModeArray(Self)) To hArray
33656>>>    For iCounter From 0 To 1000
33662>>>>
33662>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33663>>>        If (Not(iExists) Or (iExists = iFile)) Begin
33665>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
33666>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
33667>>>        End
33667>>>>
33667>>>        If (Not(iExists) Or (iExists = iFile)) Break
33670>>>    Loop
33671>>>>
33671>>>End_Procedure
33672>>>
33672>>>Procedure Clear_FileModeArray
33673>>>    Send Delete_Data To (FileModeArray(Self))
33674>>>End_Procedure
33675>>>
33675>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
33676>>>    Integer iCounter iExists iNonStandardFileMode hArray
33677>>>    Move (FileModeArray(Self)) To hArray
33678>>>    For iCounter From 0 To 1000
33684>>>>
33684>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33685>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
33688>>>        If (iExists = iFile) Begin
33690>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
33691>>>            Function_Return iNonStandardFileMode
33692>>>        End
33692>>>>
33692>>>    Loop
33693>>>>
33693>>>    Function_Return
33694>>>End_Function
33695>>>
33695>>>Procedure ChangeAllFileModes Integer iMode
33696>>>    Integer iFile iExistingFileMode iNonStandardFileMode
33697>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
33700>>>    Repeat
33700>>>>
33700>>>        // Get Each Opened File, One At A Time...
33700>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
33703>>>        If (Not(iFile)) Break
33706>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
33708>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
33711>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
33714>>>        End
33714>>>>
33714>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
33716>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
33717>>>        End
33717>>>>
33717>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
33722>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
33726>>>    Loop
33727>>>>
33727>>>End_Procedure
33728>>>
33728>>>// // Comment: Example Of Usage:
33728>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
33728>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
33728>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
33728>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
33728>>>//    Indicate Err False
33728>>>//    Begin_Transaction
33728>>>//
33728>>>//        Clear MyFile1
33728>>>//        Move 1 To MyFile1.Key
33728>>>//        Find EQ MyFile1 By Index.1
33728>>>//        Relate MyFile1
33728>>>//        Add MyFile2.Amount To MyFile1.Amount
33728>>>//        Saverecord MyFile1
33728>>>//        Saverecord MyFile2
33728>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
33728>>>//
33728>>>//    End_Transaction
33728>>>//    If (Err) Begin
33728>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
33728>>>//    End
33728>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
INCLUDING FILE: XRHSH.PKG
33728>>//------------------------------
33728>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33728>>>>//AB/ Project Select / Change Xrhsh
33728>>>>//AB/ Object prj is a Dialog_Project
33728>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33728>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33728>>>>
33728>>>>// Project Object Structure
33728>>>>//   oSelectYear is a dbModalPanelSub
33728>>>>//     Company_DD is a DataDictionary
33728>>>>//     Branch_DD is a DataDictionary
33728>>>>//     Year_DD is a DataDictionary
33728>>>>//     Company_Company_Code is a dbFormSub
33728>>>>//     Company_Company_Name is a dbFormSub
33728>>>>//     Branch_Branch_Code is a dbFormSub
33728>>>>//     Branch_Branch_Name is a dbFormSub
33728>>>>//     Year_Year_Year is a dbFormSub
33728>>>>//     Year_Year_Descr is a dbFormSub
33728>>>>//     Year_Year_Entrydate is a dbFormSub
33728>>>>//     oOk_bn is a ButtonSub
33728>>>>//     oCancel_bn is a ButtonSub
33728>>>>//     otxtCompany is a TextBoxSub
33728>>>>//     otxtBranch is a TextBoxSub
33728>>>>//     otxtYear is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     chkxr is a CheckBoxSub
33728>>>>
33728>>>>// Register all objects
33728>>>>Register_Object Branch_Branch_Code
33728>>>>Register_Object Branch_Branch_Name
33728>>>>Register_Object Branch_DD
33728>>>>Register_Object Company_Company_Code
33728>>>>Register_Object Company_Company_Name
33728>>>>Register_Object Company_DD
33728>>>>Register_Object chkxr
33728>>>>Register_Object oCancel_bn
33728>>>>Register_Object oOk_bn
33728>>>>Register_Object oSelectYear
33728>>>>Register_Object otxtBranch
33728>>>>Register_Object otxtCompany
33728>>>>Register_Object otxtWorkingDay
33728>>>>Register_Object otxtYear
33728>>>>Register_Object Year_DD
33728>>>>Register_Object Year_Year_Descr
33728>>>>Register_Object Year_Year_Entrydate
33728>>>>Register_Object Year_Year_Year
33728>>>>
33728>>>>
33728>>>>
33728>>>>//AB-StoreTopStart
33728>>>>
33728>>>>
33728>>>>
33728>>>>
33728>>>>       String  gs_selected_beto_site
33728>>>>
33728>>>>Open SysCurXR
33730>>>>Open Nomisma
33732>>>>
33732>>>>//AB-StoreTopEnd
33732>>>>
33732>>>>//AB-IgnoreStart
33732>>>>
33732>>>>Use DFAllEnt.pkg
33732>>>>Use dbForm.Sub
33732>>>>Use Button.Sub
33732>>>>Use Txtbox.Sub
33732>>>>Use Chkbox.Sub
33732>>>>
33732>>>>
33732>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33732>>>>>>//DDB-FileStart
33732>>>>>>//DDB-HeaderStart
33732>>>>>>
33732>>>>>>// File Name : COMPANY.DD
33732>>>>>>// Class Name: Company_DataDictionary
33732>>>>>>// Revision  : 62
33732>>>>>>// Version   : 2
33732>>>>>>
33732>>>>>>Use  Windows           // Basic Definitions
33732>>>>>>Use  DataDict          // DataDictionary Class Definition
33732>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33732>>>>>>
33732>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33734>>>>>>Open Branch
33736>>>>>>
33736>>>>>>//DDB-HeaderEnd
33736>>>>>>//DDB-ValidationStart
33736>>>>>>
33736>>>>>>Register_Object Company_Company_Doy_VT
33736>>>>>>Register_Object Company_Company_J_Code_VT
33736>>>>>>
33736>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33738>>>>>>    Set Type_Value        To "DOY"
33739>>>>>>    Set Allow_Blank_State To TRUE
33740>>>>>>    //DDB-ValidationCustomStart
33740>>>>>>    //DDB-ValidationCustomEnd
33740>>>>>>End_Object   // Company_Company_Doy_VT
33741>>>>>>
33741>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33743>>>>>>    Set Type_Value        To "JOB"
33744>>>>>>    Set Allow_Blank_State To TRUE
33745>>>>>>    //DDB-ValidationCustomStart
33745>>>>>>    //DDB-ValidationCustomEnd
33745>>>>>>End_Object   // Company_Company_J_Code_VT
33746>>>>>>//DDB-ValidationEnd
33746>>>>>>//DDB-SelectionStart
33746>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33746>>>>>>Register_Object sl001
33746>>>>>>//DDB-SelectionEnd
33746>>>>>> 
33746>>>>>>Class Company_DataDictionary  is a DataDictionary
33747>>>>>> 
33747>>>>>>    // Update:
33747>>>>>> 
33747>>>>>>    Procedure Update
33748>>>>>>        Forward Send Update
33750>>>>>>        move 'DOY' to company.doy_type
33751>>>>>>        move 'JOB' to company.jcode_type 
33752>>>>>>        // Insert Code Here
33752>>>>>>    End_Procedure   // Update
33753>>>>>> 
33753>>>>>>
33753>>>>>>    // Operation_Not_Allowed:
33753>>>>>>
33753>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33754>>>>>>        // Insert Code Here
33754>>>>>>        Case Begin
33754>>>>>>             Case (iError_Num = 1001)
33756>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33757>>>>>>>
33757>>>>>>             Case Break
33758>>>>>>
33758>>>>>>             Case Else
33758>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33760>>>>>>        Case End
33760>>>>>>    End_Procedure   // Operation_Not_Allowed
33761>>>>>>
33761>>>>>>
33761>>>>>>    // Validate_Save:
33761>>>>>>
33761>>>>>>    Function Validate_Save  Returns Integer
33762>>>>>>        Local Integer iReturnVal
33763>>>>>>        Forward Get Validate_Save  To iReturnVal
33765>>>>>>        If (Not(iReturnVal)) Begin
33767>>>>>>            // Insert Code Here
33767>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33770>>>>>>        End
33770>>>>>>>
33770>>>>>>        Function_Return iReturnVal
33771>>>>>>    End_Function   // Validate_Save
33772>>>>>>
33772>>>>>>
33772>>>>>>    // Define_Fields:
33772>>>>>>    // This procedure is used to set up all data-dictionary rules.
33772>>>>>>
33772>>>>>>    Procedure Define_Fields
33773>>>>>>        Forward Send Define_Fields
33775>>>>>>        //DDB-Generated-Code-Location
33775>>>>>>        //DDB-DefineFieldStart
33775>>>>>>
33775>>>>>>        Set Main_File            To Company.File_Number
33776>>>>>>        Set Cascade_Delete_State To FALSE
33777>>>>>>
33777>>>>>>
33777>>>>>>        // Child (Client) file structure................
33777>>>>>>        Send Add_Client_File  Branch.File_Number
33778>>>>>>
33778>>>>>>        // Field-based properties.......................
33778>>>>>>
33778>>>>>>        // Company.Company_Code
33778>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33779>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33780>>>>>>
33780>>>>>>        // Company.Company_Name
33780>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33781>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33782>>>>>>
33782>>>>>>        // Company.Company_Afm
33782>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33783>>>>>>
33783>>>>>>        // Company.Company_Addr
33783>>>>>>
33783>>>>>>        // Company.Company_Tk
33783>>>>>>
33783>>>>>>        // Company.Company_Poli
33783>>>>>>
33783>>>>>>        // Company.Company_Doy
33783>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33784>>>>>>
33784>>>>>>        // Company.Company_J_Code
33784>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33785>>>>>>
33785>>>>>>        // Company.Company_C_Code0
33785>>>>>>
33785>>>>>>        // Company.Company_C_Cod00
33785>>>>>>
33785>>>>>>        // Company.Company_C_Coder
33785>>>>>>
33785>>>>>>        // Company.Company_Tel
33785>>>>>>
33785>>>>>>        // Company.Company_Fax
33785>>>>>>
33785>>>>>>        // Company.Company_Email
33785>>>>>>
33785>>>>>>        // Company.Company_Resp
33785>>>>>>
33785>>>>>>        // Company.Company_Bitmap
33785>>>>>>
33785>>>>>>        // Company.Beto_Site
33785>>>>>>
33785>>>>>>        // Company.Logo
33785>>>>>>
33785>>>>>>        // Company.Doy_Type
33785>>>>>>
33785>>>>>>        // Company.Jcode_Type
33785>>>>>>
33785>>>>>>        // Company.Sap_Code
33785>>>>>>
33785>>>>>>        // Company.Sap_Path
33785>>>>>>
33785>>>>>>        //DDB-DefineFieldEnd
33785>>>>>>    End_Procedure    // Define_Fields
33786>>>>>>
33786>>>>>>    // Field_Defaults:
33786>>>>>>    // This procedure is used to establish default field values.
33786>>>>>>
33786>>>>>>    Procedure Field_Defaults
33787>>>>>>        Forward Send Field_Defaults
33789>>>>>>        //DDB-Generated-Code-Location
33789>>>>>>        //DDB-FieldDefaultStart
33789>>>>>>        //DDB-FieldDefaultEnd
33789>>>>>>    End_Procedure    // Field_Defaults
33790>>>>>>End_Class    // Company_DataDictionary
33791>>>>>>
33791>>>>>>//DDB-Selection-pkg-Start
33791>>>>>>
33791>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33791>>>>>>>>//AB/ Project sl001 : Etairies
33791>>>>>>>>//AB/     Object prj is a Lookup_Project
33791>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33791>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33791>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33791>>>>>>>>
33791>>>>>>>>// Project Object Structure
33791>>>>>>>>//   sl001 is a dbModalPanel
33791>>>>>>>>//     Company_DD is a DataDictionary
33791>>>>>>>>//     oSelList is a dbList
33791>>>>>>>>//     oOK_bn is a ButtonSub
33791>>>>>>>>//     oCancel_bn is a ButtonSub
33791>>>>>>>>//     oSearch_bn is a ButtonSub
33791>>>>>>>>
33791>>>>>>>>// Register all objects
33791>>>>>>>>Register_Object Company_DD
33791>>>>>>>>Register_Object oCancel_bn
33791>>>>>>>>Register_Object oOK_bn
33791>>>>>>>>Register_Object oSearch_bn
33791>>>>>>>>Register_Object oSelList
33791>>>>>>>>Register_Object sl001
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    //AB-IgnoreStart
33791>>>>>>>>
33791>>>>>>>>    Use DFAllEnt.pkg
33791>>>>>>>>    Use Button.Sub
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    Use COMPANY.DD
33791>>>>>>>>    
33791>>>>>>>>    //AB-IgnoreEnd
33791>>>>>>>>
33791>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33810>>>>>>>>        Set Label to "„«˜ ¨åœª"
33811>>>>>>>>        Set Size to 148 297
33812>>>>>>>>        Set Location to 12 27
33813>>>>>>>>
33813>>>>>>>>        //AB-DDOStart
33813>>>>>>>>
33813>>>>>>>>        Object Company_DD is a Company_DataDictionary
33815>>>>>>>>        End_Object    // Company_DD
33816>>>>>>>>
33816>>>>>>>>        Set Main_DD to (Company_DD(self))
33817>>>>>>>>        Set Server to (Company_DD(self))
33818>>>>>>>>
33818>>>>>>>>        //AB-DDOEnd
33818>>>>>>>>
33818>>>>>>>>        Object oSelList is a dbList
33820>>>>>>>>            Set Main_File to Company.File_Number
33821>>>>>>>>            Set Size to 105 280
33822>>>>>>>>            Set Location to 6 6
33823>>>>>>>>
33823>>>>>>>>            Begin_Row
33826>>>>>>>>                Entry_Item Company.Company_code
33827>>>>>>>>                Entry_Item Company.Company_name
33828>>>>>>>>                Entry_Item Company.Company_afm
33829>>>>>>>>            End_Row
33834>>>>>>>>
33834>>>>>>>>            Set Form_Width    item 0 to 42
33835>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33836>>>>>>>>            
33836>>>>>>>>            Set Form_Width    item 1 to 150
33837>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33838>>>>>>>>            
33838>>>>>>>>            Set Form_Width    item 2 to 80
33839>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33840>>>>>>>>            
33840>>>>>>>>        End_Object    // oSelList
33841>>>>>>>>
33841>>>>>>>>        Object oOK_bn is a ButtonSub
33843>>>>>>>>            Set Label to "&„§ ¢¦šã"
33844>>>>>>>>            Set Location to 115 126
33845>>>>>>>>
33845>>>>>>>>            //AB-StoreStart
33845>>>>>>>>            Procedure OnClick
33847>>>>>>>>                Send OK To (oSelList(current_object))
33848>>>>>>>>            End_Procedure
33849>>>>>>>>            //AB-StoreEnd
33849>>>>>>>>
33849>>>>>>>>        End_Object    // oOK_bn
33850>>>>>>>>
33850>>>>>>>>        Object oCancel_bn is a ButtonSub
33852>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33853>>>>>>>>            Set Location to 115 181
33854>>>>>>>>
33854>>>>>>>>            //AB-StoreStart
33854>>>>>>>>            Procedure OnClick
33856>>>>>>>>                Send Cancel To (oSelList(current_object))
33857>>>>>>>>            End_Procedure
33858>>>>>>>>            //AB-StoreEnd
33858>>>>>>>>
33858>>>>>>>>        End_Object    // oCancel_bn
33859>>>>>>>>
33859>>>>>>>>        Object oSearch_bn is a ButtonSub
33861>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33862>>>>>>>>            Set Location to 115 236
33863>>>>>>>>
33863>>>>>>>>            //AB-StoreStart
33863>>>>>>>>            Procedure OnClick
33865>>>>>>>>                Send Search To (oSelList(current_object))
33866>>>>>>>>            End_Procedure
33867>>>>>>>>            //AB-StoreEnd
33867>>>>>>>>
33867>>>>>>>>        End_Object    // oSearch_bn
33868>>>>>>>>
33868>>>>>>>>
33868>>>>>>>>        //AB-StoreStart
33868>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33869>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33870>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33871>>>>>>>>        //AB-StoreEnd
33871>>>>>>>>
33871>>>>>>>>    CD_End_Object    // sl001
33873>>>>>>>>>
33873>>>>>>>>
33873>>>>>>>>//AB/     End_Object    // prj
33873>>>>>>
33873>>>>>>//DDB-Selection-pkg-End
33873>>>>>>//DDB-FileEnd
33873>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33873>>>>>>//DDB-FileStart
33873>>>>>>//DDB-HeaderStart
33873>>>>>>
33873>>>>>>// File Name : BRANCH.DD
33873>>>>>>// Class Name: Branch_DataDictionary
33873>>>>>>// Revision  : 92
33873>>>>>>// Version   : 2
33873>>>>>>
33873>>>>>>Use  Windows           // Basic Definitions
33873>>>>>>Use  DataDict          // DataDictionary Class Definition
33873>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33873>>>>>>
33873>>>>>>Open Branch
33875>>>>>>Open Year
33877>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33879>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33881>>>>>>Open Company
33883>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33885>>>>>>
33885>>>>>>//DDB-HeaderEnd
33885>>>>>>//DDB-ValidationStart
33885>>>>>>
33885>>>>>>Register_Object Branch_Branch_Doy_VT
33885>>>>>>Register_Object Branch_Branch_C_Code0_VT
33885>>>>>>
33885>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33887>>>>>>    Set Type_Value        To "DOY"
33888>>>>>>    Set Validate_State    To FALSE
33889>>>>>>    Set Allow_Blank_State To TRUE
33890>>>>>>    //DDB-ValidationCustomStart
33890>>>>>>    //DDB-ValidationCustomEnd
33890>>>>>>End_Object   // Branch_Branch_Doy_VT
33891>>>>>>
33891>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33893>>>>>>    Set Type_Value        To ""
33894>>>>>>    Set Allow_Blank_State To TRUE
33895>>>>>>    //DDB-ValidationCustomStart
33895>>>>>>    //DDB-ValidationCustomEnd
33895>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33896>>>>>>//DDB-ValidationEnd
33896>>>>>>//DDB-SelectionStart
33896>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33896>>>>>>Register_Object SL002
33896>>>>>>//DDB-SelectionEnd
33896>>>>>>
33896>>>>>>Class Branch_DataDictionary  is a DataDictionary
33897>>>>>> 
33897>>>>>>    Procedure Save_Main_File
33898>>>>>>        Forward Send Save_Main_File
33900>>>>>>        // Insert Code Here
33900>>>>>>    End_Procedure   // Save_Main_File
33901>>>>>> 
33901>>>>>>    Procedure Creating
33902>>>>>>        Forward Send Creating
33904>>>>>>        // Insert Code Here
33904>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33905>>>>>>    End_Procedure   // Creating
33906>>>>>>
33906>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33907>>>>>>        // Insert Code Here
33907>>>>>>        Case Begin
33907>>>>>>             Case (iError_Num = 1001)
33909>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33910>>>>>>>
33910>>>>>>             Case Break
33911>>>>>>
33911>>>>>>             Case Else
33911>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33913>>>>>>        Case End
33913>>>>>>    End_Procedure   // Operation_Not_Allowed
33914>>>>>>
33914>>>>>>
33914>>>>>>    // Validate_Save:
33914>>>>>>
33914>>>>>>    Function Validate_Save  Returns Integer
33915>>>>>>        Local Integer iReturnVal
33916>>>>>>        Forward Get Validate_Save  To iReturnVal
33918>>>>>>        If (Not(iReturnVal)) Begin
33920>>>>>>            // Insert Code Here
33920>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33923>>>>>>        End
33923>>>>>>>
33923>>>>>>        Function_Return iReturnVal
33924>>>>>>    End_Function   // Validate_Save
33925>>>>>>
33925>>>>>>
33925>>>>>>    // Define_Fields:
33925>>>>>>    // This procedure is used to set up all data-dictionary rules.
33925>>>>>>
33925>>>>>>    Procedure Define_Fields
33926>>>>>>        Forward Send Define_Fields
33928>>>>>>        //DDB-Generated-Code-Location
33928>>>>>>        //DDB-DefineFieldStart
33928>>>>>>
33928>>>>>>        Set Main_File            To Branch.File_Number
33929>>>>>>        Set Cascade_Delete_State To FALSE
33930>>>>>>
33930>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33931>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33932>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33933>>>>>>
33933>>>>>>        // Child (Client) file structure................
33933>>>>>>        Send Add_Client_File  Year.File_Number
33934>>>>>>        Send Add_Client_File  Brzones.File_Number
33935>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33936>>>>>>
33936>>>>>>        // Parent (Server) file structure...............
33936>>>>>>        Send Add_Server_File  Company.File_Number
33937>>>>>>
33937>>>>>>        // External (System) file structure.............
33937>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33938>>>>>>
33938>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33941>>>>>>
33941>>>>>>        // Field-based properties.......................
33941>>>>>>
33941>>>>>>        // Branch.Company_Code
33941>>>>>>
33941>>>>>>        // Branch.Branch_Code
33941>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33942>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33943>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33944>>>>>>
33944>>>>>>        // Branch.Branch_Rec0
33944>>>>>>
33944>>>>>>        // Branch.Branch_Recr
33944>>>>>>
33944>>>>>>        // Branch.Branch_Name
33944>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33945>>>>>>
33945>>>>>>        // Branch.Branch_Afm
33945>>>>>>
33945>>>>>>        // Branch.Branch_Addr
33945>>>>>>
33945>>>>>>        // Branch.Branch_Tk
33945>>>>>>
33945>>>>>>        // Branch.Branch_Poli
33945>>>>>>
33945>>>>>>        // Branch.Branch_Doy
33945>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33946>>>>>>
33946>>>>>>        // Branch.Branch_J_Code
33946>>>>>>
33946>>>>>>        // Branch.Branch_C_Code0
33946>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Code00
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Coder
33947>>>>>>
33947>>>>>>        // Branch.Branch_Tel
33947>>>>>>
33947>>>>>>        // Branch.Branch_Fax
33947>>>>>>
33947>>>>>>        // Branch.Branch_Email
33947>>>>>>
33947>>>>>>        // Branch.Branch_Resp
33947>>>>>>
33947>>>>>>        // Branch.Branch_Bitmap
33947>>>>>>
33947>>>>>>        // Branch.Branch_Site
33947>>>>>>
33947>>>>>>        // Branch.Branch_Apoth
33947>>>>>>
33947>>>>>>        // Branch.Beto_Site
33947>>>>>>
33947>>>>>>        // Branch.Path_Exp
33947>>>>>>
33947>>>>>>        // Branch.Exp_Txtname
33947>>>>>>
33947>>>>>>        // Branch.Send_Phone
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Files
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Conf
33947>>>>>>
33947>>>>>>        // Branch.Tomeas_Code
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Retry
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Exit
33947>>>>>>
33947>>>>>>        // Branch.Ras_Name
33947>>>>>>
33947>>>>>>        // Branch.Ras_Passw
33947>>>>>>
33947>>>>>>        // Branch.Ras_Domain
33947>>>>>>
33947>>>>>>        // Branch.Last_Hmnia_Ekt
33947>>>>>>
33947>>>>>>        // Branch.Deop_Logo
33947>>>>>>
33947>>>>>>        // Branch.Entolh
33947>>>>>>
33947>>>>>>        // Branch.Paragogh
33947>>>>>>
33947>>>>>>        // Branch.Locked_Until
33947>>>>>>
33947>>>>>>        // Branch.Sap_Code
33947>>>>>>
33947>>>>>>        // Branch.Perioxh
33947>>>>>>
33947>>>>>>        // Branch.Egkatastash
33947>>>>>>
33947>>>>>>        // Branch.Date_Locked
33947>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
33948>>>>>>
33948>>>>>>        //DDB-DefineFieldEnd
33948>>>>>>    End_Procedure    // Define_Fields
33949>>>>>>
33949>>>>>>    // Field_Defaults:
33949>>>>>>    // This procedure is used to establish default field values.
33949>>>>>>
33949>>>>>>    Procedure Field_Defaults
33950>>>>>>        Forward Send Field_Defaults
33952>>>>>>        //DDB-Generated-Code-Location
33952>>>>>>        //DDB-FieldDefaultStart
33952>>>>>>        //DDB-FieldDefaultEnd
33952>>>>>>    End_Procedure    // Field_Defaults
33953>>>>>>End_Class    // Branch_DataDictionary
33954>>>>>>
33954>>>>>>//DDB-Selection-pkg-Start
33954>>>>>>
33954>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33954>>>>>>>>//AB/ Project SL002:Branch
33954>>>>>>>>//AB/ Object prj is a Lookup_Project
33954>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33954>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33954>>>>>>>>
33954>>>>>>>>// Project Object Structure
33954>>>>>>>>//   SL002 is a dbModalPanelSub
33954>>>>>>>>//     Company_DD is a DataDictionary
33954>>>>>>>>//     Branch_DD is a DataDictionary
33954>>>>>>>>//     oSelList is a dbListSub
33954>>>>>>>>//     oOK_bn is a ButtonSub
33954>>>>>>>>//     oCancel_bn is a ButtonSub
33954>>>>>>>>//     oSearch_bn is a ButtonSub
33954>>>>>>>>
33954>>>>>>>>// Register all objects
33954>>>>>>>>Register_Object Branch_DD
33954>>>>>>>>Register_Object Company_DD
33954>>>>>>>>Register_Object oCancel_bn
33954>>>>>>>>Register_Object oOK_bn
33954>>>>>>>>Register_Object oSearch_bn
33954>>>>>>>>Register_Object oSelList
33954>>>>>>>>Register_Object SL002
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreStart
33954>>>>>>>>
33954>>>>>>>>Use DFAllEnt.pkg
33954>>>>>>>>Use dbList.Sub
33954>>>>>>>>Use Button.Sub
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>Use COMPANY.DD
33954>>>>>>>>Use BRANCH.DD
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreEnd
33954>>>>>>>>
33954>>>>>>>>Object SL002 is a dbModalPanelSub
33956>>>>>>>>
33956>>>>>>>>    //AB-StoreTopStart
33956>>>>>>>>    Property String psFragmaCompanyCode  ""
33958>>>>>>>>    
33958>>>>>>>>    //AB-StoreTopEnd
33958>>>>>>>>
33958>>>>>>>>    Set Minimize_Icon to FALSE
33959>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33960>>>>>>>>    Set Size to 146 430
33961>>>>>>>>    Set Location to 4 5
33962>>>>>>>>    Set Exit_Application_Local_State to FALSE
33963>>>>>>>>    Set Modal_State to FALSE
33964>>>>>>>>
33964>>>>>>>>    //AB-DDOStart
33964>>>>>>>>
33964>>>>>>>>    Object Company_DD is a Company_DataDictionary
33966>>>>>>>>    End_Object    // Company_DD
33967>>>>>>>>
33967>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33969>>>>>>>>        Set DDO_Server to (Company_DD(self))
33970>>>>>>>>
33970>>>>>>>>        //AB-StoreStart
33970>>>>>>>>        Procedure OnConstrain
33972>>>>>>>>             String lsCompanyCode
33973>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33974>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33978>>>>>>>>        End_Procedure // OnConstrain
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        //AB-StoreEnd
33979>>>>>>>>
33979>>>>>>>>    End_Object    // Branch_DD
33980>>>>>>>>
33980>>>>>>>>    Set Main_DD to (Branch_DD(self))
33981>>>>>>>>    Set Server to (Branch_DD(self))
33982>>>>>>>>
33982>>>>>>>>    //AB-DDOEnd
33982>>>>>>>>
33982>>>>>>>>    Object oSelList is a dbListSub
33984>>>>>>>>        Set Main_File to Branch.File_Number
33985>>>>>>>>        Set Size to 105 415
33986>>>>>>>>        Set Location to 6 6
33987>>>>>>>>
33987>>>>>>>>        Begin_Row
33990>>>>>>>>            Entry_Item Branch.Branch_code
33991>>>>>>>>            Entry_Item Branch.Branch_name
33992>>>>>>>>            Entry_Item Company.Company_code
33993>>>>>>>>            Entry_Item Company.Company_name
33994>>>>>>>>            Entry_Item Branch.Beto_site
33995>>>>>>>>            Entry_Item Branch.Branch_recr
33996>>>>>>>>        End_Row
34001>>>>>>>>
34001>>>>>>>>        Set Form_Width    item 0 to 60
34002>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34003>>>>>>>>        
34003>>>>>>>>        Set Form_Width    item 1 to 128
34004>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34005>>>>>>>>        
34005>>>>>>>>        Set Form_Width    item 2 to 69
34006>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34007>>>>>>>>        
34007>>>>>>>>        Set Form_Width    item 3 to 109
34008>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34009>>>>>>>>        
34009>>>>>>>>        Set Form_Width    item 4 to 42
34010>>>>>>>>        Set Header_Label  item 4 to "Site"
34011>>>>>>>>        
34011>>>>>>>>        Set Form_Width    item 5 to 0
34012>>>>>>>>        Set Header_Label  item 5 to ""
34013>>>>>>>>        
34013>>>>>>>>
34013>>>>>>>>        //AB-StoreStart
34013>>>>>>>>                
34013>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34015>>>>>>>>        
34015>>>>>>>>        Procedure Store_Defaults
34017>>>>>>>>            forward send Store_Defaults
34019>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34020>>>>>>>>        end_Procedure // Store_Defaults
34021>>>>>>>>        
34021>>>>>>>>        Procedure Restore_Defaults
34023>>>>>>>>            forward send Restore_Defaults
34025>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34026>>>>>>>>        end_Procedure // Restore_Defaults
34027>>>>>>>>        
34027>>>>>>>>        Procedure Activating
34029>>>>>>>>            Forward Send Activating
34031>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34032>>>>>>>>        End_Procedure // Activating
34033>>>>>>>>        
34033>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34034>>>>>>>>        
34034>>>>>>>>        
34034>>>>>>>>        //AB-StoreEnd
34034>>>>>>>>
34034>>>>>>>>    End_Object    // oSelList
34035>>>>>>>>
34035>>>>>>>>    Object oOK_bn is a ButtonSub
34037>>>>>>>>        Set Label to "&„§ ¢¦šã"
34038>>>>>>>>        Set Location to 112 262
34039>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34040>>>>>>>>
34040>>>>>>>>        //AB-StoreStart
34040>>>>>>>>        Procedure OnClick
34042>>>>>>>>            Send OK To (oSelList(current_object))
34043>>>>>>>>        End_Procedure
34044>>>>>>>>        //AB-StoreEnd
34044>>>>>>>>
34044>>>>>>>>    End_Object    // oOK_bn
34045>>>>>>>>
34045>>>>>>>>    Object oCancel_bn is a ButtonSub
34047>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34048>>>>>>>>        Set Location to 112 317
34049>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34050>>>>>>>>
34050>>>>>>>>        //AB-StoreStart
34050>>>>>>>>        Procedure OnClick
34052>>>>>>>>            Send Cancel To (oSelList(current_object))
34053>>>>>>>>        End_Procedure
34054>>>>>>>>        //AB-StoreEnd
34054>>>>>>>>
34054>>>>>>>>    End_Object    // oCancel_bn
34055>>>>>>>>
34055>>>>>>>>    Object oSearch_bn is a ButtonSub
34057>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34058>>>>>>>>        Set Location to 112 372
34059>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34060>>>>>>>>
34060>>>>>>>>        //AB-StoreStart
34060>>>>>>>>        Procedure OnClick
34062>>>>>>>>            Send Search To (oSelList(current_object))
34063>>>>>>>>        End_Procedure
34064>>>>>>>>        //AB-StoreEnd
34064>>>>>>>>
34064>>>>>>>>    End_Object    // oSearch_bn
34065>>>>>>>>
34065>>>>>>>>
34065>>>>>>>>    //AB-StoreStart
34065>>>>>>>>    
34065>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34066>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34067>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    //AB-StoreEnd
34068>>>>>>>>
34068>>>>>>>>End_Object    // SL002
34069>>>>>>>>
34069>>>>>>>>//AB/ End_Object    // prj
34069>>>>>>
34069>>>>>>//DDB-Selection-pkg-End
34069>>>>>>//DDB-FileEnd
34069>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34069>>>>>>//DDB-FileStart
34069>>>>>>//DDB-HeaderStart
34069>>>>>>
34069>>>>>>// File Name : YEAR.DD
34069>>>>>>// Class Name: Year_DataDictionary
34069>>>>>>// Revision  : 119
34069>>>>>>// Version   : 2
34069>>>>>>
34069>>>>>>Use  Windows           // Basic Definitions
34069>>>>>>Use  DataDict          // DataDictionary Class Definition
34069>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34069>>>>>>
34069>>>>>>Open Year
34071>>>>>>Open Branch
34073>>>>>>Open Syscurxr
34075>>>>>>
34075>>>>>>//DDB-HeaderEnd
34075>>>>>>//DDB-ValidationStart
34075>>>>>>
34075>>>>>>Register_Object Year_Year_C_Code0_VT1
34075>>>>>>Register_Object Year_Year_C_Code00_VT1
34075>>>>>>Register_Object Year_Year_C_Coder_VT1
34075>>>>>>
34075>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34077>>>>>>    Set Type_Value        To "CURRENCY"
34078>>>>>>    //DDB-ValidationCustomStart
34078>>>>>>    //DDB-ValidationCustomEnd
34078>>>>>>End_Object   // Year_Year_C_Code0_VT1
34079>>>>>>
34079>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34081>>>>>>    Set Type_Value        To "CURRENCY"
34082>>>>>>    //DDB-ValidationCustomStart
34082>>>>>>    //DDB-ValidationCustomEnd
34082>>>>>>End_Object   // Year_Year_C_Code00_VT1
34083>>>>>>
34083>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34085>>>>>>    Set Type_Value        To "CURRENCY"
34086>>>>>>    //DDB-ValidationCustomStart
34086>>>>>>    //DDB-ValidationCustomEnd
34086>>>>>>End_Object   // Year_Year_C_Coder_VT1
34087>>>>>>//DDB-ValidationEnd
34087>>>>>>//DDB-SelectionStart
34087>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34087>>>>>>Register_Object SL003
34087>>>>>>//DDB-SelectionEnd
34087>>>>>>            
34087>>>>>>Class Year_DataDictionary  is a DataDictionary
34088>>>>>>    
34088>>>>>>    Procedure Creating
34089>>>>>>        Forward Send Creating
34091>>>>>>        // Insert Code Here
34091>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34092>>>>>>    End_Procedure   // Creating
34093>>>>>>
34093>>>>>>
34093>>>>>>    // Operation_Not_Allowed:
34093>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34094>>>>>>        // Insert Code Here
34094>>>>>>        Case Begin    
34094>>>>>>             Case (iError_Num = 1001)
34096>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34097>>>>>>>
34097>>>>>>             Case Break
34098>>>>>>             Case (iError_Num=1002)
34101>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34102>>>>>>>
34102>>>>>>             Case Break
34103>>>>>>             Case (iError_Num=1003)
34106>>>>>>                Error 1003 "DDC 053:Company Code=0"
34107>>>>>>>
34107>>>>>>             Case Break
34108>>>>>>             Case (iError_Num=1004)
34111>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34112>>>>>>>
34112>>>>>>             Case Break
34113>>>>>>             Case Else
34113>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34115>>>>>>        Case End
34115>>>>>>    End_Procedure   // Operation_Not_Allowed
34116>>>>>>
34116>>>>>>
34116>>>>>>    // Update:
34116>>>>>>    // Use this message to effect changes in related-to files. The
34116>>>>>>    // Backout message should be designed to reverse the effects of this
34116>>>>>>    // message. It is invoked while the database is locked.
34116>>>>>>
34116>>>>>>    Procedure Update
34117>>>>>>        Forward Send Update
34119>>>>>>        // Insert Code Here
34119>>>>>>        Move Company.Company_Code   to Year.Company_Code
34120>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34121>>>>>>        move branch.beto_site       to year.beto_site
34122>>>>>>
34122>>>>>>        //sos:parametrika apo sysfile?
34122>>>>>>       
34122>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34122>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>       // Else Begin
34122>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34122>>>>>>    End_Procedure   // Update
34123>>>>>>
34123>>>>>>    // Validate_Save:
34123>>>>>>
34123>>>>>>    Function Validate_Save  Returns Integer
34124>>>>>>        Local Integer iReturnVal
34125>>>>>>        Forward Get Validate_Save  To iReturnVal
34127>>>>>>        If (Not(iReturnVal)) Begin
34129>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34132>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34136>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34140>>>>>>        End
34140>>>>>>>
34140>>>>>>        Function_Return iReturnVal
34141>>>>>>    End_Function   // Validate_Save
34142>>>>>>
34142>>>>>>
34142>>>>>>    // Define_Fields:
34142>>>>>>    // This procedure is used to set up all data-dictionary rules.
34142>>>>>>
34142>>>>>>    Procedure Define_Fields
34143>>>>>>        Forward Send Define_Fields
34145>>>>>>        //DDB-Generated-Code-Location
34145>>>>>>        //DDB-DefineFieldStart
34145>>>>>>
34145>>>>>>        Set Main_File            To Year.File_Number
34146>>>>>>        Set Cascade_Delete_State To FALSE
34147>>>>>>
34147>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34148>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34149>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34150>>>>>>
34150>>>>>>        // Parent (Server) file structure...............
34150>>>>>>        Send Add_Server_File  Branch.File_Number
34151>>>>>>
34151>>>>>>        // External (System) file structure.............
34151>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34152>>>>>>
34152>>>>>>        // Field-based properties.......................
34152>>>>>>
34152>>>>>>        // Year.Company_Code
34152>>>>>>
34152>>>>>>        // Year.Branch_Code
34152>>>>>>
34152>>>>>>        // Year.Year_Year
34152>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34153>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34154>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34155>>>>>>
34155>>>>>>        // Year.Year_Recr
34155>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34156>>>>>>
34156>>>>>>        // Year.Branch_Recr
34156>>>>>>
34156>>>>>>        // Year.Year_Descr
34156>>>>>>
34156>>>>>>        // Year.Year_Isolfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Isolto
34156>>>>>>
34156>>>>>>        // Year.Year_Openfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Opento
34156>>>>>>
34156>>>>>>        // Year.Year_Entrydate
34156>>>>>>
34156>>>>>>        // Year.Year_Dateaa
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshto
34156>>>>>>
34156>>>>>>        // Year.Year_Myflimit
34156>>>>>>
34156>>>>>>        // Year.Year_Numgtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numgarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numgmove
34156>>>>>>
34156>>>>>>        // Year.Year_Numgplan
34156>>>>>>
34156>>>>>>        // Year.Year_Numgformat
34156>>>>>>
34156>>>>>>        // Year.Year_Numgthaa
34156>>>>>>
34156>>>>>>        // Year.Year_Numgopen
34156>>>>>>
34156>>>>>>        // Year.Year_Numbtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numbaxio
34156>>>>>>
34156>>>>>>        // Year.Year_Numbarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numbmove
34156>>>>>>
34156>>>>>>        // Year.Year_Delimiter
34156>>>>>>
34156>>>>>>        // Year.Year_Printer
34156>>>>>>
34156>>>>>>        // Year.Year_Valid_Char
34156>>>>>>
34156>>>>>>        // Year.Year_C_Code0
34156>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34157>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34158>>>>>>
34158>>>>>>        // Year.Year_C_Code00
34158>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34159>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34160>>>>>>
34160>>>>>>        // Year.Year_C_Coder
34160>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34161>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34162>>>>>>
34162>>>>>>        // Year.Beto_Site
34162>>>>>>
34162>>>>>>        // Year.Clients_Plafon
34162>>>>>>
34162>>>>>>        // Year.Payresp_Plafon
34162>>>>>>
34162>>>>>>        // Year.Clients_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Payresp_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Working
34162>>>>>>
34162>>>>>>        //DDB-DefineFieldEnd
34162>>>>>>
34162>>>>>>        Set Main_File            To Year.File_Number
34163>>>>>>        Set Cascade_Delete_State To FALSE
34164>>>>>>
34164>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34165>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34166>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34167>>>>>>
34167>>>>>>        // Child (Client) file structure................
34167>>>>>>
34167>>>>>>        // Parent (Server) file structure...............
34167>>>>>>        Send Add_Server_File  Branch.File_Number
34168>>>>>>
34168>>>>>>        // Field-based properties.......................
34168>>>>>>
34168>>>>>>        // Year.Company_Code
34168>>>>>>
34168>>>>>>        // Year.Branch_Code
34168>>>>>>
34168>>>>>>        // Year.Year_Year
34168>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34169>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34170>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34171>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34171>>>>>>
34171>>>>>>        // Year.Year_Descr
34171>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34172>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34173>>>>>>
34173>>>>>>        // Year.Year_C_Code0
34173>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34174>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34175>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34176>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34176>>>>>>
34176>>>>>>        // Year.Year_C_Code00
34176>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34177>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34178>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34179>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34179>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34179>>>>>>
34179>>>>>>        // Year.Year_C_Coder
34179>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34180>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34181>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34182>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34182>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34182>>>>>>
34182>>>>>>        // Year.Year_Isolfrom
34182>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34183>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34184>>>>>>
34184>>>>>>        // Year.Year_Isolto
34184>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34185>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34186>>>>>>
34186>>>>>>        // Year.Year_Openfrom
34186>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34187>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34188>>>>>>
34188>>>>>>        // Year.Year_Opento
34188>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34189>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34190>>>>>>
34190>>>>>>        // Year.Year_Entrydate
34190>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34191>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34192>>>>>>
34192>>>>>>        // Year.Year_Dateaa
34192>>>>>>
34192>>>>>>        // Year.Year_Xrhshfrom
34192>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34193>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34194>>>>>>
34194>>>>>>        // Year.Year_Xrhshto
34194>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34195>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34196>>>>>>
34196>>>>>>        // Year.Year_Myflimit
34196>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34197>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34198>>>>>>
34198>>>>>>        // Year.Year_Numgtypkin
34198>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34199>>>>>>
34199>>>>>>        // Year.Year_Numgarticl
34199>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34200>>>>>>
34200>>>>>>        // Year.Year_Numgmove
34200>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34201>>>>>>
34201>>>>>>        // Year.Year_Numgplan
34201>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34202>>>>>>
34202>>>>>>        // Year.Year_Numgformat
34202>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34203>>>>>>
34203>>>>>>        // Year.Year_Numgthaa
34203>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34204>>>>>>
34204>>>>>>        // Year.Year_Numgopen
34204>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34205>>>>>>
34205>>>>>>        // Year.Year_Numbaxio
34205>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34206>>>>>>
34206>>>>>>        // Year.Year_Numbarticl
34206>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34207>>>>>>
34207>>>>>>        // Year.Year_Numbmove
34207>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34208>>>>>>
34208>>>>>>        // Year.Year_Delimiter
34208>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34209>>>>>>
34209>>>>>>        // Year.Year_Printer
34209>>>>>>
34209>>>>>>        // Year.Year_Valid_Char
34209>>>>>>
34209>>>>>>    End_Procedure    // Define_Fields
34210>>>>>>
34210>>>>>>    // Field_Defaults:
34210>>>>>>    // This procedure is used to establish default field values.
34210>>>>>>
34210>>>>>>    Procedure Field_Defaults
34211>>>>>>        Forward Send Field_Defaults
34213>>>>>>        //DDB-Generated-Code-Location
34213>>>>>>        //DDB-FieldDefaultStart
34213>>>>>>        //DDB-FieldDefaultEnd
34213>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34214>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34215>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34216>>>>>>    End_Procedure    // Field_Defaults
34217>>>>>>
34217>>>>>>End_Class    // Year_DataDictionary
34218>>>>>>//DDB-Selection-pkg-Start
34218>>>>>>
34218>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34218>>>>>>>>//AB/ Project SL003:Year
34218>>>>>>>>//AB/ Object prj is a Lookup_Project
34218>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34218>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34218>>>>>>>>
34218>>>>>>>>// Project Object Structure
34218>>>>>>>>//   SL003 is a dbModalPanelSub
34218>>>>>>>>//     Company_DD is a DataDictionary
34218>>>>>>>>//     Branch_DD is a DataDictionary
34218>>>>>>>>//     Year_DD is a DataDictionary
34218>>>>>>>>//     oSelList is a dbListSub
34218>>>>>>>>//     oOK_bn is a ButtonSub
34218>>>>>>>>//     oCancel_bn is a ButtonSub
34218>>>>>>>>//     oSearch_bn is a ButtonSub
34218>>>>>>>>
34218>>>>>>>>// Register all objects
34218>>>>>>>>Register_Object Branch_DD
34218>>>>>>>>Register_Object Company_DD
34218>>>>>>>>Register_Object oCancel_bn
34218>>>>>>>>Register_Object oOK_bn
34218>>>>>>>>Register_Object oSearch_bn
34218>>>>>>>>Register_Object oSelList
34218>>>>>>>>Register_Object SL003
34218>>>>>>>>Register_Object Year_DD
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreStart
34218>>>>>>>>
34218>>>>>>>>Use DFAllEnt.pkg
34218>>>>>>>>Use dbList.Sub
34218>>>>>>>>Use Button.Sub
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>Use COMPANY.DD
34218>>>>>>>>Use BRANCH.DD
34218>>>>>>>>Use YEAR.DD
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreEnd
34218>>>>>>>>
34218>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34237>>>>>>>>
34237>>>>>>>>    //AB-StoreTopStart
34237>>>>>>>>    Property String psFragmaCompanyCode  ""
34239>>>>>>>>    Property String psFragmaBranchCode   ""
34241>>>>>>>>    property integer pifragmaactive public 0
34243>>>>>>>>    //AB-StoreTopEnd
34243>>>>>>>>
34243>>>>>>>>    Set Minimize_Icon to FALSE
34244>>>>>>>>    Set Label to "•¨ã©œ ª"
34245>>>>>>>>    Set Size to 149 449
34246>>>>>>>>    Set Location to 4 7
34247>>>>>>>>    Set Exit_Application_Local_State to FALSE
34248>>>>>>>>    Set Modal_State to FALSE
34249>>>>>>>>
34249>>>>>>>>    //AB-DDOStart
34249>>>>>>>>
34249>>>>>>>>    Object Company_DD is a Company_DataDictionary
34251>>>>>>>>    End_Object    // Company_DD
34252>>>>>>>>
34252>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34254>>>>>>>>        Set DDO_Server to (Company_DD(self))
34255>>>>>>>>    End_Object    // Branch_DD
34256>>>>>>>>
34256>>>>>>>>    Object Year_DD is a Year_DataDictionary
34258>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34259>>>>>>>>
34259>>>>>>>>        //AB-StoreStart
34259>>>>>>>>        Procedure OnConstrain
34261>>>>>>>>             String lsCompanyCode lsBranchCode
34262>>>>>>>>             integer iactive
34262>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34263>>>>>>>>             get pifragmaactive to iactive
34264>>>>>>>>             If (lsCompanyCode <> "") Begin
34266>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34267>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34269>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34273>>>>>>>>             End
34273>>>>>>>>>
34273>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34277>>>>>>>>        End_Procedure // OnConstrain
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        //AB-StoreEnd
34278>>>>>>>>
34278>>>>>>>>    End_Object    // Year_DD
34279>>>>>>>>
34279>>>>>>>>    Set Main_DD to (Year_DD(self))
34280>>>>>>>>    Set Server to (Year_DD(self))
34281>>>>>>>>
34281>>>>>>>>    //AB-DDOEnd
34281>>>>>>>>
34281>>>>>>>>    Object oSelList is a dbListSub
34283>>>>>>>>        Set Main_File to Year.File_Number
34284>>>>>>>>        Set Size to 105 433
34285>>>>>>>>        Set Location to 6 6
34286>>>>>>>>
34286>>>>>>>>        Begin_Row
34289>>>>>>>>            Entry_Item Year.Year_year
34290>>>>>>>>            Entry_Item Company.Company_code
34291>>>>>>>>            Entry_Item Company.Company_name
34292>>>>>>>>            Entry_Item Branch.Branch_code
34293>>>>>>>>            Entry_Item Branch.Branch_name
34294>>>>>>>>        End_Row
34299>>>>>>>>
34299>>>>>>>>        Set Form_Width    item 0 to 36
34300>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34301>>>>>>>>        
34301>>>>>>>>        Set Form_Width    item 1 to 71
34302>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34303>>>>>>>>        
34303>>>>>>>>        Set Form_Width    item 2 to 136
34304>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34305>>>>>>>>        
34305>>>>>>>>        Set Form_Width    item 3 to 73
34306>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34307>>>>>>>>        
34307>>>>>>>>        Set Form_Width    item 4 to 109
34308>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34309>>>>>>>>        
34309>>>>>>>>
34309>>>>>>>>        //AB-StoreStart
34309>>>>>>>>                                                
34309>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34311>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34313>>>>>>>>        
34313>>>>>>>>        Procedure Store_Defaults
34315>>>>>>>>            forward send Store_Defaults
34317>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34318>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34319>>>>>>>>        end_Procedure // Store_Defaults
34320>>>>>>>>        
34320>>>>>>>>        Procedure Restore_Defaults
34322>>>>>>>>            forward send Restore_Defaults
34324>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34325>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34326>>>>>>>>        end_Procedure // Restore_Defaults
34327>>>>>>>>        
34327>>>>>>>>        Procedure Activating
34329>>>>>>>>            Forward Send Activating
34331>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34332>>>>>>>>        End_Procedure // Activating
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        //AB-StoreEnd
34333>>>>>>>>
34333>>>>>>>>    End_Object    // oSelList
34334>>>>>>>>
34334>>>>>>>>    Object oOK_bn is a ButtonSub
34336>>>>>>>>        Set Label to "&„§ ¢¦šã"
34337>>>>>>>>        Set Location to 112 280
34338>>>>>>>>
34338>>>>>>>>        //AB-StoreStart
34338>>>>>>>>        Procedure OnClick
34340>>>>>>>>            Send OK To (oSelList(current_object))
34341>>>>>>>>        End_Procedure
34342>>>>>>>>        //AB-StoreEnd
34342>>>>>>>>
34342>>>>>>>>    End_Object    // oOK_bn
34343>>>>>>>>
34343>>>>>>>>    Object oCancel_bn is a ButtonSub
34345>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34346>>>>>>>>        Set Location to 112 335
34347>>>>>>>>
34347>>>>>>>>        //AB-StoreStart
34347>>>>>>>>        Procedure OnClick
34349>>>>>>>>            Send Cancel To (oSelList(current_object))
34350>>>>>>>>        End_Procedure
34351>>>>>>>>        //AB-StoreEnd
34351>>>>>>>>
34351>>>>>>>>    End_Object    // oCancel_bn
34352>>>>>>>>
34352>>>>>>>>    Object oSearch_bn is a ButtonSub
34354>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34355>>>>>>>>        Set Location to 112 390
34356>>>>>>>>
34356>>>>>>>>        //AB-StoreStart
34356>>>>>>>>        Procedure OnClick
34358>>>>>>>>            Send Search To (oSelList(current_object))
34359>>>>>>>>        End_Procedure
34360>>>>>>>>        //AB-StoreEnd
34360>>>>>>>>
34360>>>>>>>>    End_Object    // oSearch_bn
34361>>>>>>>>
34361>>>>>>>>
34361>>>>>>>>    //AB-StoreStart
34361>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34362>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34363>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    //AB-StoreEnd
34364>>>>>>>>
34364>>>>>>>>CD_End_Object    // SL003
34366>>>>>>>>>
34366>>>>>>>>
34366>>>>>>>>//AB/ End_Object    // prj
34366>>>>>>
34366>>>>>>//DDB-Selection-pkg-End
34366>>>>>>//DDB-FileEnd
34366>>>>
34366>>>>//AB-IgnoreEnd
34366>>>>
34366>>>>Object oSelectYear is a dbModalPanelSub
34368>>>>
34368>>>>    //AB-StoreTopStart
34368>>>>    
34368>>>>    Property String  psSelectedYearRecr  ''
34370>>>>    Property Integer piChangeState False
34372>>>>    
34372>>>>    //AB-StoreTopEnd
34372>>>>
34372>>>>    Set Minimize_Icon to FALSE
34373>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34374>>>>    Set Size to 111 372
34375>>>>    Set Location to 60 40
34376>>>>    Set Color to 12232306
34377>>>>
34377>>>>    //AB-DDOStart
34377>>>>
34377>>>>    Object Company_DD is a Company_DataDictionary
34379>>>>
34379>>>>        //AB-StoreStart
34379>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34380>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34381>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34382>>>>        
34382>>>>        
34382>>>>        
34382>>>>        //AB-StoreEnd
34382>>>>
34382>>>>    End_Object    // Company_DD
34383>>>>
34383>>>>    Object Branch_DD is a Branch_DataDictionary
34385>>>>        Set DDO_Server to (Company_DD(self))
34386>>>>
34386>>>>        //AB-StoreStart
34386>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34387>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34388>>>>        
34388>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34389>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34390>>>>        
34390>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34391>>>>        //AB-StoreEnd
34391>>>>
34391>>>>    End_Object    // Branch_DD
34392>>>>
34392>>>>    Object Year_DD is a Year_DataDictionary
34394>>>>        Set DDO_Server to (Branch_DD(self))
34395>>>>
34395>>>>        //AB-StoreStart
34395>>>>        
34395>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34396>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34397>>>>        
34397>>>>        Function Validate_Delete Returns Integer
34399>>>>            Function_Return 1
34400>>>>        End_Function
34401>>>>        
34401>>>>        //AB-StoreEnd
34401>>>>
34401>>>>    End_Object    // Year_DD
34402>>>>
34402>>>>    Set Main_DD to (Year_DD(self))
34403>>>>    Set Server to (Year_DD(self))
34404>>>>
34404>>>>    //AB-DDOEnd
34404>>>>
34404>>>>    Object Company_Company_Code is a dbFormSub
34406>>>>        Entry_Item Company.Company_code
34407>>>>        Set Size to 13 71
34408>>>>        Set Location to 9 112
34409>>>>        Set Color to 12232306
34410>>>>        Set Label_Col_Offset to 2
34411>>>>        Set Label_Justification_Mode to jMode_Right
34412>>>>        Set Prompt_Button_Mode to pb_PromptOn
34413>>>>        Set Auto_Clear_Deo_State to FALSE
34414>>>>        Set Enabled_State to FALSE
34415>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34416>>>>        Set Item_Shadow_State Item 0 to TRUE
34417>>>>        Set Shadow_State Item 0 to TRUE
34418>>>>
34418>>>>        //AB-StoreStart
34418>>>>        
34418>>>>        Set Prompt_Object to (sl001(Self))
34419>>>>        
34419>>>>        
34419>>>>        //AB-StoreEnd
34419>>>>
34419>>>>    End_Object    // Company_Company_Code
34420>>>>
34420>>>>    Object Company_Company_Name is a dbFormSub
34422>>>>        Entry_Item Company.Company_name
34423>>>>        Set Size to 13 168
34424>>>>        Set Location to 9 188
34425>>>>        Set Color to 12232306
34426>>>>        Set Label_Col_Offset to 2
34427>>>>        Set Label_Justification_Mode to jMode_Right
34428>>>>        Set Enabled_State to FALSE
34429>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34430>>>>        Set Item_Shadow_State Item 0 to TRUE
34431>>>>        Set Shadow_State Item 0 to TRUE
34432>>>>
34432>>>>        //AB-StoreStart
34432>>>>        
34432>>>>        //AB-StoreEnd
34432>>>>
34432>>>>    End_Object    // Company_Company_Name
34433>>>>
34433>>>>    Object Branch_Branch_Code is a dbFormSub
34435>>>>        Entry_Item Branch.Branch_code
34436>>>>        Set Size to 13 71
34437>>>>        Set Location to 23 112
34438>>>>        Set Color to 12232306
34439>>>>        Set Label_Col_Offset to 2
34440>>>>        Set Label_Justification_Mode to jMode_Right
34441>>>>        Set Prompt_Button_Mode to pb_PromptOn
34442>>>>        Set Auto_Clear_Deo_State to FALSE
34443>>>>        Set Enabled_State to FALSE
34444>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34445>>>>        Set Item_Shadow_State Item 0 to TRUE
34446>>>>        Set Shadow_State Item 0 to TRUE
34447>>>>
34447>>>>        //AB-StoreStart
34447>>>>        Set Prompt_Object to (sl002(Self))
34448>>>>        
34448>>>>        Procedure Prompt_CallBack Integer hPrompt
34450>>>>            string lsCompanyCode
34451>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34452>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34453>>>>        End_Procedure
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        //AB-StoreEnd
34454>>>>
34454>>>>    End_Object    // Branch_Branch_Code
34455>>>>
34455>>>>    Object Branch_Branch_Name is a dbFormSub
34457>>>>        Entry_Item Branch.Branch_name
34458>>>>        Set Size to 13 168
34459>>>>        Set Location to 23 188
34460>>>>        Set Color to 12232306
34461>>>>        Set Label_Justification_Mode to jMode_Right
34462>>>>        Set Enabled_State to FALSE
34463>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34464>>>>        Set Item_Shadow_State Item 0 to TRUE
34465>>>>        Set Shadow_State Item 0 to TRUE
34466>>>>
34466>>>>        //AB-StoreStart
34466>>>>        
34466>>>>        
34466>>>>        //AB-StoreEnd
34466>>>>
34466>>>>    End_Object    // Branch_Branch_Name
34467>>>>
34467>>>>    Object Year_Year_Year is a dbFormSub
34469>>>>        Entry_Item Year.Year_year
34470>>>>        Set Size to 13 71
34471>>>>        Set Location to 37 112
34472>>>>        Set Label_Col_Offset to 2
34473>>>>        Set Label_Justification_Mode to jMode_Right
34474>>>>        Set Prompt_Button_Mode to pb_PromptOn
34475>>>>        Set Auto_Clear_Deo_State to FALSE
34476>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34477>>>>
34477>>>>        //AB-StoreStart
34477>>>>        Set Prompt_Object to (sl003(Self))
34478>>>>        
34478>>>>        Procedure Prompt_CallBack Integer hPrompt
34480>>>>            String lsCompanyCode lsBranchCode
34481>>>>            integer icheck
34481>>>>            get checked_state of (chkxr(self)) to icheck
34482>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34483>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34484>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34485>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34486>>>>            set pifragmaactive      of hPrompt to icheck
34487>>>>        End_Procedure
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        //AB-StoreEnd
34488>>>>
34488>>>>    End_Object    // Year_Year_Year
34489>>>>
34489>>>>    Object Year_Year_Descr is a dbFormSub
34491>>>>        Entry_Item Year.Year_descr
34492>>>>        Set Size to 13 168
34493>>>>        Set Location to 37 188
34494>>>>        Set Color to 12232306
34495>>>>        Set Label_Col_Offset to 2
34496>>>>        Set Label_Justification_Mode to jMode_Right
34497>>>>        Set Enabled_State to FALSE
34498>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34499>>>>        Set Item_Shadow_State Item 0 to TRUE
34500>>>>        Set Shadow_State Item 0 to TRUE
34501>>>>
34501>>>>        //AB-StoreStart
34501>>>>        
34501>>>>        //AB-StoreEnd
34501>>>>
34501>>>>    End_Object    // Year_Year_Descr
34502>>>>
34502>>>>    Object Year_Year_Entrydate is a dbFormSub
34504>>>>        Entry_Item Year.Year_entrydate
34505>>>>        Set Size to 13 71
34506>>>>        Set Location to 52 112
34507>>>>        Set Label_Col_Offset to 2
34508>>>>        Set Label_Justification_Mode to jMode_Right
34509>>>>        Set Auto_Clear_Deo_State to FALSE
34510>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34511>>>>    End_Object    // Year_Year_Entrydate
34512>>>>
34512>>>>    Object oOk_bn is a ButtonSub
34514>>>>        Set Label to "€§¦›¦®ã (F2)"
34515>>>>        Set Size to 17 54
34516>>>>        Set Location to 74 188
34517>>>>        Set Form_FontHeight Item 0 to 14
34518>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34519>>>>
34519>>>>        //AB-StoreStart
34519>>>>        
34519>>>>        Procedure OnClick
34521>>>>            Delegate Send AcceptTheValues
34523>>>>        End_Procedure
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        //AB-StoreEnd
34524>>>>
34524>>>>    End_Object    // oOk_bn
34525>>>>
34525>>>>    Object oCancel_bn is a ButtonSub
34527>>>>        Set Label to "„¥¦›¦ª "
34528>>>>        Set Size to 17 54
34529>>>>        Set Location to 74 302
34530>>>>        Set Form_FontHeight Item 0 to 14
34531>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34532>>>>
34532>>>>        //AB-StoreStart
34532>>>>        
34532>>>>        Procedure OnClick
34534>>>>           Send Exit_Application to oSelectYear
34535>>>>        End_Procedure
34536>>>>        
34536>>>>        
34536>>>>        
34536>>>>        //AB-StoreEnd
34536>>>>
34536>>>>    End_Object    // oCancel_bn
34537>>>>
34537>>>>    Object otxtCompany is a TextBoxSub
34539>>>>        Set Label to "„«˜ ¨œå˜"
34540>>>>        Set Auto_Size_State to FALSE
34541>>>>        Set Color to 12232306
34542>>>>        Set FontSize to 14 8
34543>>>>        Set Location to 9 10
34544>>>>        Set Size to 10 35
34545>>>>        Set FontWeight to 600
34546>>>>        Set TypeFace to "MS Sans Serif"
34547>>>>        Set Enabled_State to TRUE
34548>>>>    End_Object    // otxtCompany
34549>>>>
34549>>>>    Object otxtBranch is a TextBoxSub
34551>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34552>>>>        Set Auto_Size_State to FALSE
34553>>>>        Set Color to 12232306
34554>>>>        Set FontSize to 14 8
34555>>>>        Set Location to 23 10
34556>>>>        Set Size to 10 63
34557>>>>        Set FontWeight to 600
34558>>>>        Set TypeFace to "MS Sans Serif"
34559>>>>        Set Enabled_State to TRUE
34560>>>>    End_Object    // otxtBranch
34561>>>>
34561>>>>    Object otxtYear is a TextBoxSub
34563>>>>        Set Label to "•¨ã©ž :          "
34564>>>>        Set Auto_Size_State to FALSE
34565>>>>        Set Color to 12232306
34566>>>>        Set FontSize to 14 8
34567>>>>        Set Location to 38 10
34568>>>>        Set Size to 10 40
34569>>>>        Set FontWeight to 600
34570>>>>        Set TypeFace to "MS Sans Serif"
34571>>>>        Set Enabled_State to TRUE
34572>>>>    End_Object    // otxtYear
34573>>>>
34573>>>>    Object otxtWorkingDay is a TextBoxSub
34575>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34576>>>>        Set Auto_Size_State to FALSE
34577>>>>        Set Color to 12232306
34578>>>>        Set FontSize to 14 8
34579>>>>        Set Location to 52 10
34580>>>>        Set Size to 10 63
34581>>>>        Set FontWeight to 600
34582>>>>        Set TypeFace to "MS Sans Serif"
34583>>>>        Set Enabled_State to TRUE
34584>>>>    End_Object    // otxtWorkingDay
34585>>>>
34585>>>>    Object otxtWorkingDay is a TextBoxSub
34587>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34588>>>>        Set Auto_Size_State to FALSE
34589>>>>        Set Color to 12232306
34590>>>>        Set FontSize to 14 8
34591>>>>        Set Location to 79 9
34592>>>>        Set Size to 10 63
34593>>>>        Set FontWeight to 600
34594>>>>        Set TypeFace to "MS Sans Serif"
34595>>>>        Set Enabled_State to TRUE
34596>>>>    End_Object    // otxtWorkingDay
34597>>>>
34597>>>>    Object chkxr is a CheckBoxSub
34599>>>>        Set Size to 13 22
34600>>>>        Set Location to 79 113
34601>>>>        Set Color to 12232306
34602>>>>    End_Object    // chkxr
34603>>>>
34603>>>>
34603>>>>    //AB-StoreStart
34603>>>>    
34603>>>>    On_Key Key_Ctrl+Key_X Send None
34604>>>>    On_Key Key_Alt+Key_X  Send None
34605>>>>    
34605>>>>    Function ifSelect_Xrhsh Returns String
34607>>>>        String  lsRecord_id
34608>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34609>>>>        send popup_modal
34610>>>>        Get psSelectedYearRecr to lsRecord_id
34611>>>>        Function_return lsRecord_Id
34612>>>>    End_Function
34613>>>>    
34613>>>>    Procedure AcceptTheValues
34615>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34616>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34616>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34616>>>>        Move Year_DD to liYearDD
34617>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34618>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34621>>>>        else begin
34622>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34623>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34624>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34627>>>>            else begin
34628>>>>                Move Company_DD to liCompanyDD
34629>>>>                Move Branch_DD  to liBranchDD
34630>>>>                Move Year_DD    to liYearDD
34631>>>>                send Request_Save to liYearDD
34632>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34633>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34634>>>>    
34634>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34635>>>>    
34635>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34636>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34637>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34638>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34639>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34640>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34641>>>>    
34641>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34642>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34643>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34644>>>>    
34644>>>>    
34644>>>>                Local String    sCode
34644>>>>                Local Integer   iBreak
34644>>>>                Move 0 to iBreak
34645>>>>                Clear Nomisma
34646>>>>                Find Gt Nomisma.Recnum
34647>>>>>
34647>>>>                While ((Found=1) And (iBreak=0))
34651>>>>                    If (Nomisma.Einai_Euro='1') Begin
34653>>>>                        Move 1 to iBreak
34654>>>>                        Move Nomisma.Nomisma_Code to sCode
34655>>>>                    End
34655>>>>>
34655>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34658>>>>                Loop
34659>>>>>
34659>>>>                Move (Trim(sCode)) to sCode
34660>>>>    
34660>>>>    
34660>>>>                Reread SysCurXR
34664>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34665>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34666>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34667>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34668>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34669>>>>                Move lsSite                     to SysCurXR.Branch_Site
34670>>>>    
34670>>>>                Move sCname                     to SysCurXR.Company_Name
34671>>>>                Move sBname                     to SysCurXR.Branch_Name
34672>>>>                Move sYname                     to SysCurXR.Year_Descr
34673>>>>    
34673>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34674>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34675>>>>    
34675>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34676>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34677>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34678>>>>    
34678>>>>                Move sCode                      to SysCurXR.Euro_Code
34679>>>>    
34679>>>>                Saverecord SysCurXR
34680>>>>                Unlock
34681>>>>>
34681>>>>    
34681>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34682>>>>                Set psSelectedYearRecr          to lsYearRecr
34683>>>>    
34683>>>>                Send Stop_Modal_ui
34684>>>>    
34684>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34685>>>>            End
34685>>>>>
34685>>>>        end
34685>>>>>
34685>>>>    End_Procedure
34686>>>>    
34686>>>>    Set Locate_Mode to Center_On_Screen
34687>>>>    
34687>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34688>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34689>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34690>>>>    
34690>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34691>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    //AB-StoreEnd
34692>>>>
34692>>>>End_Object    // oSelectYear
34693>>>>
34693>>>>
34693>>>>//AB-StoreStart
34693>>>>
34693>>>>
34693>>>>//AB-StoreEnd
34693>>>>
34693>>>>//AB/ End_Object    // prj
34693>>
34693>>Procedure Epelexe_Xrhsh
34694>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34695>>    String lsCompany lsBranch lsWhatXrhsh
34695>>    Move oSelectYear to liModalId
34696>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34697>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34700>>End_Procedure
34701>>
34701>>Procedure Allaxe_Xrhsh
34702>>    Integer rVal liModalId iID
34703>>    If (Close_All_Views(Self,True)=0) Begin
34705>>        Move oSelectYear to liModalId
34706>>        Send Epelexe_Xrhsh
34707>>    End
34707>>>
34707>>End_Procedure
34708>>
34708>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34709>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34710>>
34710>>Send Epelexe_Xrhsh
34711>>//------------------------------
34711>>
34711>Set Button_State    of (Wait(Self)) to False
34712>Set BarVisibleState of (Wait(Self)) to '' False
34713>Send Popup                          to (Wait(Self))
34714>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é §œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
34715>
34715>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34715>>>
34715>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34715>>>>>
34715>>>>>Open Users
34717>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34719>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34721>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34723>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34725>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34727>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34729>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34731>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34733>>>>>Open Oth
INCLUDING FILE: OTH.FD
34735>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34737>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34739>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34741>>>>>
34741>>>>>
34741>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34742>>>>>
34742>>>>>Function Network_User_Name Returns String
34743>>>>>    Local String sName sLength
34744>>>>>    Local Pointer lpName_Addr lpLength_Addr
34744>>>>>    Local Integer iRetval
34744>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34745>>>>>>
34745>>>>>    GetAddress Of sName To lpName_Addr
34746>>>>>    Movestr (DwordToBytes (255)) To sLength
34747>>>>>>
34747>>>>>    GetAddress Of sLength To lpLength_Addr
34748>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34749>>>>>>
34749>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34752>>>>>    Else Function_Return "User Unknown"
34754>>>>>End_Function // Network_User_Name
34755>>>>>
34755>>>>>Function fsGetOfficePath Global Returns String
34756>>>>>    String sRegistryKeyPath sRegOfficePath
34757>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34758>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34759>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34763>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34764>>>>>    If (sRegOfficePath='') Begin
34766>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34767>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34771>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34772>>>>>        If (sRegOfficePath='') Begin
34774>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34775>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34779>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34780>>>>>            If (sRegOfficePath='') Begin
34782>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34783>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34787>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34788>>>>>            End
34788>>>>>>
34788>>>>>        End
34788>>>>>>
34788>>>>>    End
34788>>>>>>
34788>>>>>    Function_Return sRegOfficePath
34789>>>>>End_Procedure
34790>>>>>
34790>>>>>
34790>>>>>Function fsGetLastDir Global Returns String
34791>>>>>    String sRegistryKeyPath sRegDir sUserName
34792>>>>>    Get Network_User_Name to sUserName
34793>>>>>
34793>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34796>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34799>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34801>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34803>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34804>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34805>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34808>>>>>    Function_Return sRegDir
34809>>>>>End_Procedure
34810>>>>>
34810>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34811>>>>>    String sRegistryKeyPath sRegDir sUserName
34812>>>>>    Get Network_User_Name to sUserName
34813>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34816>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34819>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34821>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34823>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34824>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34825>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34828>>>>>    Function_Return 0
34829>>>>>End_Procedure
34830>>>>>
34830>>>>>
34830>>>>>Function fsVresExt Global String asFileName Returns String
34831>>>>>    String rVal
34832>>>>>    Integer iPos iLen
34832>>>>>    Move (UpperCase(asFileName)) to asFileName
34833>>>>>    Move (Trim(asFileName)) to asFileName
34834>>>>>    Move 0 to iPos
34835>>>>>    For iLen from 1 to (length(asFileName))
34841>>>>>>
34841>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34844>>>>>    Loop
34845>>>>>>
34845>>>>>    If (Not(iPos)) Function_Return ''
34848>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34849>>>>>    Move (Trim(rVal)) to rVal
34850>>>>>    Function_Return rVal
34851>>>>>End_Function
34852>>>>>
34852>>>>>
34852>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34853>>>>>    Integer rVal iUser iGroup
34854>>>>>    String  sUser sRecr
34854>>>>>    Move (Trim(asViewName))     to asViewName
34855>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34856>>>>>
34856>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34858>>>>>        Get fsLoginUserID to sUser
34859>>>>>        Clear Users
34860>>>>>        Move sUser        to Users.Login_ID
34861>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34862>>>>>>
34862>>>>>        If (Found=1) Begin
34864>>>>>            Move Users.User_ID  to iUser
34865>>>>>            Move Users.Grp_ID   to iGroup
34866>>>>>            Clear GrpOth
34867>>>>>            Move iUser          to GrpOth.User_ID
34868>>>>>            Move asViewName     to GrpOth.View_Name
34869>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34870>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34871>>>>>>
34871>>>>>            If (Found=1) Begin
34873>>>>>                // rVal=1 ==> NO READ ALLOWED
34873>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34873>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34873>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34876>>>>>                Else Begin
34877>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34879>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34882>>>>>                        Else                        Move 2 to rVal
34884>>>>>                    End
34884>>>>>>
34884>>>>>                End
34884>>>>>>
34884>>>>>            End
34884>>>>>>
34884>>>>>            Else Begin
34885>>>>>                Clear GrpOth0
34886>>>>>                Move iGroup         to GrpOth0.Group_ID
34887>>>>>                Move asViewName     to GrpOth0.View_Name
34888>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34889>>>>>
34889>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34890>>>>>>
34890>>>>>                If (Found=1) Begin
34892>>>>>                    // rVal=1 ==> NO READ ALLOWED
34892>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34892>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34892>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34895>>>>>                    Else Begin
34896>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34898>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34901>>>>>                            Else                         Move 2 to rVal
34903>>>>>                        End
34903>>>>>>
34903>>>>>                    End
34903>>>>>>
34903>>>>>                End
34903>>>>>>
34903>>>>>                Else Move 0 to rVal
34905>>>>>            End
34905>>>>>>
34905>>>>>        End
34905>>>>>>
34905>>>>>        Else Move 0 to rVal
34907>>>>>    End
34907>>>>>>
34907>>>>>    Function_Return rVal
34908>>>>>End_Function
34909>>>>>
34909>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34910>>>>>    Integer rVal iUser iGroup
34911>>>>>    String  sUser sRecr
34911>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34913>>>>>        Get fsLoginUserID to sUser
34914>>>>>        Clear Users
34915>>>>>        Move sUser        to Users.Login_ID
34916>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34917>>>>>>
34917>>>>>        If (Found=1) Begin
34919>>>>>            Move Users.User_ID  to iUser
34920>>>>>            Move Users.Grp_ID   to iGroup
34921>>>>>            Clear Pedia
34922>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34923>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34924>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34925>>>>>>
34925>>>>>            If (Found=1) Begin
34927>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34928>>>>>                // Find Combination User/File/Field in GRPPEDIA
34928>>>>>                Clear GrpPedia
34929>>>>>                Move iUser                      to GrpPedia.User_ID
34930>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34931>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34932>>>>>>
34932>>>>>                If (Found=1) Begin
34934>>>>>                    // rVal=1 ==> NO READ ALLOWED
34934>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34934>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34934>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34937>>>>>                    Else Begin
34938>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34940>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34943>>>>>                            Else                            Move 2 to rVal
34945>>>>>                        End
34945>>>>>>
34945>>>>>                    End
34945>>>>>>
34945>>>>>                End
34945>>>>>>
34945>>>>>                Else Begin
34946>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34946>>>>>                    Clear GrpPed0
34947>>>>>                    Move iGroup         to GrpPed0.Group_ID
34948>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34949>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34950>>>>>>
34950>>>>>                    If (Found=1) Begin
34952>>>>>                        // rVal=1 ==> NO READ ALLOWED
34952>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34952>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34952>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34955>>>>>                        Else Begin
34956>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34958>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34961>>>>>                                Else                           Move 2 to rVal
34963>>>>>                            End
34963>>>>>>
34963>>>>>                        End
34963>>>>>>
34963>>>>>                    End
34963>>>>>>
34963>>>>>                End
34963>>>>>>
34963>>>>>            End
34963>>>>>>
34963>>>>>            Else Begin
34964>>>>>                Move 0 to rVal
34965>>>>>            End
34965>>>>>>
34965>>>>>        End
34965>>>>>>
34965>>>>>        Else Begin
34966>>>>>            Move 0 to rVal
34967>>>>>        End
34967>>>>>>
34967>>>>>    End
34967>>>>>>
34967>>>>>    Function_Return rVal
34968>>>>>End_Function
34969>>>>>
34969>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34970>>>>>    String rVal lsDirSep
34971>>>>>    Integer iPos iMet iLen iCnt
34971>>>>>    Move (Trim(asFullPath))                 To rVal
34972>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34973>>>>>    If (rVal Contains lsDirSep) Begin
34975>>>>>        Move (Length(rVal)) to iLen
34976>>>>>        Move iLen to iCnt
34977>>>>>        While iCnt Gt 0
34981>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34983>>>>>                If (iCnt=iLen) Function_Return asFullPath
34986>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34988>>>>>            End
34988>>>>>>
34988>>>>>            Decrement iCnt
34989>>>>>        End // While iCnt Gt 0
34990>>>>>>
34990>>>>>    End
34990>>>>>>
34990>>>>>    Else  Function_Return (Trim(asFullPath))
34992>>>>>    Function_Return rVal
34993>>>>>End_Function
34994>>>>>
34994>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34995>>>>>    String rVal lsDirSep
34996>>>>>    Integer iPos iMet iLen iCnt
34996>>>>>    Move (Trim(asFullPath))                 To rVal
34997>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34998>>>>>    If (rVal Contains lsDirSep) Begin
35000>>>>>        Move (Length(rVal)) to iLen
35001>>>>>        Move iLen to iCnt
35002>>>>>        While iCnt Gt 0
35006>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35009>>>>>            Decrement iCnt
35010>>>>>        End // While iCnt Gt 0
35011>>>>>>
35011>>>>>    End
35011>>>>>>
35011>>>>>    Function_Return rVal
35012>>>>>End_Function
35013>>>>>
35013>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35013>>>>>//    Local String rVal lsTmp lsOO lsLL
35013>>>>>//    Local Number lnOO lnLL
35013>>>>>
35013>>>>>//    Move '' to lsOO
35013>>>>>//    Move '' to lsLL
35013>>>>>//    Move '' to rVal
35013>>>>>
35013>>>>>//    Move (Integer(anTime))                              to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35013>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>
35013>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35013>>>>>
35013>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35013>>>>>//    Else         Move (String(lnOO))                    to lsOO
35013>>>>>//    Move (Trim(lsOO))                                   to lsOO
35013>>>>>
35013>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35013>>>>>//    Else         Move (String(lnLL))                    to lsLL
35013>>>>>//    Move (Trim(lsLL))                                   to lsLL
35013>>>>>
35013>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35013>>>>>
35013>>>>>//    Move (Trim(rVal)) to rVal
35013>>>>>
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35013>>>>>//    Local Number rVal nOres nLepta
35013>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35013>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35013>>>>>//    Move (nOres+(nLepta/100))       to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35013>>>>>//    Local Integer rVal
35013>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35013>>>>>//                                                                    Number anEndTime    ;
35013>>>>>//                                                                    Returns Integer
35013>>>>>//    Local Integer rVal iMinStart iMinEnd
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35013>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35013>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35013>>>>>//                                                                Number anEndTime    ;
35013>>>>>//                                                                Returns Number
35013>>>>>//    Local Integer iTmp
35013>>>>>//    Local Number  rVal
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35013>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>Function fsLoginUserID Global Returns String
35014>>>>>    Local String LastLogin# LoginUserid#
35015>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35018>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35021>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35023>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35026>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35029>>>>>    Trim LoginUserID# to LoginUserID#
35030>>>>>>
35030>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35033>>>>>    Function_Return LoginUserID#
35034>>>>>End_Function
35035>>>>>
35035>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35036>>>>>    Integer rVal
35037>>>>>    String  lsCurrentWksp
35037>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35040>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35043>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35045>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35045>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35045>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35048>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35051>>>>>    Function_Return rVal
35052>>>>>End_Function
35053>>>>>
35053>>>>>
35053>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35054>>>>>    String rVal lsCurrentWksp
35055>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35058>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35061>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35063>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35063>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35063>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35066>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35069>>>>>    Function_Return (Trim(rVal))
35070>>>>>End_Function
35071>>>>>
35071>>>>>
35071>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35072>>>>>    Integer rVal
35073>>>>>    String  lsCurrentWksp
35073>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35076>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35079>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35081>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35084>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35087>>>>>    Function_Return rVal
35088>>>>>End_Function
35089>>>>>
35089>>>>>
35089>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35090>>>>>    String rVal lsCurrentWksp
35091>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35094>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35097>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35099>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35102>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35105>>>>>    Function_Return (Trim(rVal))
35106>>>>>End_Function
35107>>>>>
35107>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35108>>>>>    Integer rVal
35109>>>>>    String  lsCurrentWksp
35109>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35112>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35115>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35117>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35120>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35123>>>>>    Function_Return rVal
35124>>>>>End_Function
35125>>>>>
35125>>>>>
35125>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35126>>>>>    String rVal lsCurrentWksp
35127>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35130>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35133>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35135>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35138>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35141>>>>>    Function_Return (Trim(rVal))
35142>>>>>End_Function
35143>>>>>
35143>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35144>>>>>    String rVal lsCurrentWksp
35145>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35148>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35151>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35153>>>>>    Append lsCurrentWksp "\FEM"
35154>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35157>>>>>    Function_Return (Trim(rVal))
35158>>>>>End_Function
35159>>>>>
35159>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35160>>>>>    String rVal lsCurrentWksp
35161>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35164>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35167>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35169>>>>>    Append lsCurrentWksp "\FEM"
35170>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35173>>>>>    Function_Return (Trim(rVal))
35174>>>>>End_Function
35175>>>>>
35175>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35176>>>>>    Integer rVal
35177>>>>>    String  lsCurrentWksp
35177>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35180>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35183>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35185>>>>>    Append lsCurrentWksp "\FEM"
35186>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35189>>>>>    Function_Return rVal
35190>>>>>End_Function
35191>>>>>
35191>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35192>>>>>    Integer rVal
35193>>>>>    String  lsCurrentWksp
35193>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35196>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35199>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35201>>>>>    Append lsCurrentWksp "\FEM"
35202>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35205>>>>>    Function_Return rVal
35206>>>>>End_Function
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>Function fig_Is_Admin Global Returns Integer
35208>>>>>    String sUser
35209>>>>>    Integer rVal
35209>>>>>    Get fsLoginUserID to sUser
35210>>>>>    Move (trim(sUser)) to sUser
35211>>>>>    Clear Users
35212>>>>>    Move sUser to Users.Login_ID
35213>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35214>>>>>>
35214>>>>>    Move Users.Admin_Rights to rVal
35215>>>>>    Function_Return rVal
35216>>>>>End_Function
35217>>>>>
35217>>>>>Function fig_The_User_Group Global Returns Integer
35218>>>>>    String sUser
35219>>>>>    Get fsLoginUserID   to sUser
35220>>>>>    Move (trim(sUser))  to sUser
35221>>>>>    Clear Users
35222>>>>>    Move sUser          to Users.Login_ID
35223>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35224>>>>>>
35224>>>>>    Clear UserGrps
35225>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35226>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35227>>>>>>
35227>>>>>    Function_Return UserGrps.Grp_ID
35228>>>>>End_Function
35229>>>>>
35229>>>>>Function fsg_The_User_Department Global Returns String
35230>>>>>    String sUser
35231>>>>>    Get fsLoginUserID   to sUser
35232>>>>>    Move (trim(sUser))  to sUser
35233>>>>>    Clear Users
35234>>>>>    Move sUser          to Users.Login_ID
35235>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35236>>>>>>
35236>>>>>    Clear Departm
35237>>>>>    Move Users.Departm_Code   to Departm.Code
35238>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35239>>>>>>
35239>>>>>    Function_Return Departm.Code
35240>>>>>End_Function
35241>>>>>
35241>>>>>
35241>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35242>>>>>    Integer rVal
35243>>>>>    Move (trim(asUser)) to asUser
35244>>>>>    Clear Users
35245>>>>>    Move asUser to Users.Login_ID
35246>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35247>>>>>>
35247>>>>>    Move Users.Admin_Rights to rVal
35248>>>>>    Function_Return rVal
35249>>>>>End_Function
35250>>>>>
35250>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35251>>>>>    Move (trim(asUser))  to asUser
35252>>>>>    Clear Users
35253>>>>>    Move asUser          to Users.Login_ID
35254>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35255>>>>>>
35255>>>>>    Clear UserGrps
35256>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35257>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35258>>>>>>
35258>>>>>    Function_Return UserGrps.Grp_ID
35259>>>>>End_Function
35260>>>>>
35260>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35261>>>>>    Move (trim(asUser))  to asUser
35262>>>>>    Clear Users
35263>>>>>    Move asUser          to Users.Login_ID
35264>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35265>>>>>>
35265>>>>>    Clear Departm
35266>>>>>    Move Users.Departm_Code   to Departm.Code
35267>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35268>>>>>>
35268>>>>>    Function_Return Departm.Code
35269>>>>>End_Function
35270>>>>>
35270>>>>>
35270>>>
35270>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35271>>>
35271>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35273>>>    Open Users
35275>>>    Open Views
INCLUDING FILE: VIEWS.FD
35277>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35279>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35281>>>    Open Arxeia
35283>>>    Open GrpArx
35285>>>
35285>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35286>>>        String  lsView lsLogin
35287>>>        Integer liUser  liViews iGroup
35287>>>
35287>>>        Move (fsLoginUserID())      to lsLogin
35288>>>        Move (Trim(ToOEM(asView)))  to lsView
35289>>>
35289>>>        //////  /////////////////////////////////////
35289>>>        Clear Users
35290>>>        Move lsLogin    to Users.Login_ID
35291>>>
35291>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35292>>>>
35292>>>        If (Found=1)  Begin
35294>>>            Move Users.User_ID  to liUser
35295>>>            Move Users.Grp_ID   to iGroup
35296>>>        End
35296>>>>
35296>>>        Else Function_Return 0
35298>>>
35298>>>        Clear Views
35299>>>        Move (Trim(lsView)) to Views.Menu_Name
35300>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35301>>>>
35301>>>        If (Found=1) Begin
35303>>>            Move Views.View_ID to liViews
35304>>>            Clear GrpViews
35305>>>            Move liUser    to GrpViews.User_ID
35306>>>            Move liViews   to GrpViews.View_ID
35307>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35308>>>>
35308>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35310>>>                Function_Return (GrpViews.Allow_Read<>'1')
35311>>>            End
35311>>>>
35311>>>            Else Begin
35312>>>                Clear GrpView0
35313>>>                Move iGroup    to GrpView0.Group_ID
35314>>>                Move liViews   to GrpView0.View_ID
35315>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35316>>>>
35316>>>                If (Found=1) Begin
35318>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35319>>>                End
35319>>>>
35319>>>                Else         Function_Return 0
35321>>>            End
35321>>>>
35321>>>        End
35321>>>>
35321>>>        Else Function_Return 0
35323>>>    End_Function
35324>>>
35324>>>//    Procedure Enhmerose_Views_File_In_Class
35324>>>//        Integer liCount liInt liLastNo
35324>>>//        String lsStr
35324>>>//        Get Item_Count to liCount
35324>>>//        // find last view_id
35324>>>//        Clear Views
35324>>>//        Move 9999 to Views.View_ID
35324>>>//        Find lt Views by index.1 // view_id
35324>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35324>>>//        Else            Move 0              to liLastNo
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Begin
35324>>>//                Clear Views
35324>>>//                Move lsStr to Views.Menu_Name
35324>>>//                Find eq Views by index.2 // Views.Menu_Name
35324>>>//                If (NOT(Found)) Begin
35324>>>//                    Add 1 to liLastNo
35324>>>//                    Move liLastNo to Views.View_ID
35324>>>//                    Saverecord Views
35324>>>//                End
35324>>>//            End
35324>>>//        Loop
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35324>>>//        Loop
35324>>>//    End_procedure
35324>>>
35324>>>    Procedure OnInitMenu
35325>>>        Integer liCount liInt liLastNo
35326>>>        String lsStr
35326>>>
35326>>>        Get Item_Count to liCount
35327>>>
35327>>>        // find last view_id
35327>>>        Clear Views
35328>>>        Move 9999 to Views.View_ID
35329>>>        Find lt Views by index.1 // view_id
35330>>>>
35330>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35333>>>        Else            Move 0              to liLastNo
35335>>>        For liInt From 0 to (liCount-1)
35341>>>>
35341>>>            Get Value item liInt to lsStr
35342>>>            Move (Trim(lsStr)) to lsStr
35343>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35345>>>                Clear Views
35346>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35347>>>                Find eq Views by index.2 // Views.Menu_Name
35348>>>>
35348>>>                If (NOT(Found)) Begin
35350>>>                    Add 1 to liLastNo
35351>>>                    Move liLastNo to Views.View_ID
35352>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35352>>>                    Saverecord Views
35353>>>                End
35353>>>>
35353>>>            End
35353>>>>
35353>>>        Loop
35354>>>>
35354>>>        For liInt From 0 to (liCount-1)
35360>>>>
35360>>>            Get Value item liInt to lsStr
35361>>>            Move (Trim(lsStr)) to lsStr
35362>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35363>>>        Loop
35364>>>>
35364>>>
35364>>>    End_procedure
35365>>>
35365>>>//    Procedure End_Construct_Object
35365>>>//        Forward Send End_Construct_Object
35365>>>//        Send Enhmerose_Views_File_In_Class
35365>>>//    End_Procedure
35365>>>
35365>>>End_Class //ButtonSub
35366>>>
35366>>>
35366>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
35366>>>
35366>>>Open Sysfile
35368>>>Open UserGrps
35370>>>Open Users
35372>>>Open Views
35374>>>Open GrpViews
35376>>>Open Arxeia
35378>>>Open GrpArx
35380>>>Open GrpArx0
35382>>>Open GrpView0
35384>>>
35384>>>Use DD.Sub
35384>>>
35384>>>Class Datadictionary_Sec  Is A DatadictionarySub
35385>>>
35385>>>
35385>>>    Procedure Construct_Object
35386>>>        Forward Send Construct_Object
35388>>>        Property Integer cpiUpdate              0
35389>>>        Property Integer cpiBackout             0
35390>>>        Property Integer cpiEditing             0
35391>>>        Property Integer cpiFileNumber          0
35392>>>        Property String  cpsFileName            ''
35393>>>        Property String  cpsLoginID             ''
35394>>>        Property Integer cpiCannot_Read         0
35395>>>        Property Integer cpiCannot_Create       0
35396>>>        Property Integer cpiCannot_Delete       0
35397>>>        Property Integer cpiCannot_Edit         0
35398>>>        Property Integer piFN                   0
35399>>>    End_Procedure
35400>>>
35400>>>//    Procedure Save_Main_File
35400>>>//        If (Operation_Origin<>Self) Begin
35400>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
35400>>>//        End
35400>>>//        Forward Send Save_Main_File
35400>>>//    End_Procedure
35400>>>
35400>>>
35400>>>
35400>>>    Function Validate_Save Returns Integer
35401>>>        Integer rVal
35402>>>        Forward Get Validate_Save to rVal
35404>>>        If (Not(rVal)) Begin
35406>>>            Get cpiCannot_Read to rVal
35407>>>            If (Not(rVal)) Begin
35409>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
35410>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
35413>>>                Else                    Get cpiCannot_Create    to rVal
35415>>>            End
35415>>>>
35415>>>            If (rVal) Send Operation_Not_Allowed rVal
35418>>>        End
35418>>>>
35418>>>        Function_Return rVal
35419>>>    End_Function
35420>>>
35420>>>    Function Validate_Delete Returns Integer
35421>>>        Integer rVal
35422>>>        Forward Get Validate_Delete to rVal
35424>>>        If (Not(rVal)) Begin
35426>>>            Get cpiCannot_Read to rVal
35427>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
35430>>>            If (rVal) Send Operation_Not_Allowed rVal
35433>>>        End
35433>>>>
35433>>>        Function_Return rVal
35434>>>    End_Function
35435>>>
35435>>>    Procedure End_Construct_Object
35436>>>        Integer liSrv rVal
35437>>>        String lsStr
35437>>>        Forward Send End_Construct_Object
35439>>>        Get Main_File                                   To liSrv
35440>>>        Set cpiFileNumber                               To liSrv
35441>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
35444>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
35445>>>        Set cpsLoginID                                  To (fsLoginUserID())
35446>>>        Send Find_User_Rights
35447>>>        Set piFN to lisrv
35448>>>    End_Procedure
35449>>>
35449>>>    Procedure Find_User_Rights
35450>>>        String lsArxeio lsLogin
35451>>>        Integer liUser liArxeio iGroup
35451>>>
35451>>>        Get cpiFileNumber   to liArxeio
35452>>>        Get cpsFileName     to lsArxeio
35453>>>        Get cpsLoginID      to lsLogin
35454>>>
35454>>>        Clear Users
35455>>>        Move lsLogin    to Users.Login_ID
35456>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35457>>>>
35457>>>        If (Found=1)  Begin
35459>>>            Move Users.User_ID  to liUser
35460>>>            Move Users.Grp_ID   to iGroup
35461>>>        End
35461>>>>
35461>>>        //Else Send Operation_Not_Allowed 9999
35461>>>
35461>>>        Clear Arxeia
35462>>>
35462>>>        Move liArxeio to Arxeia.Arxeio_ID
35463>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
35464>>>>
35464>>>
35464>>>        If (Found=1) Begin
35466>>>            Move Arxeia.Arxeio_ID to liArxeio
35467>>>
35467>>>            Clear GrpArx
35468>>>            Move liUser     to GrpArx.User_ID
35469>>>            Move liArxeio   to GrpArx.Arxeio_ID
35470>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
35471>>>>
35471>>>            If (Found=1) Begin
35473>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
35476>>>               Else                         Set cpiCannot_Read   to 10003
35478>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
35481>>>               Else                         Set cpiCannot_Create to 10000
35483>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
35486>>>               Else                         Set cpiCannot_Edit   to 10001
35488>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
35491>>>               Else                         Set cpiCannot_Delete to 10002
35493>>>            End
35493>>>>
35493>>>            Else Begin
35494>>>                Clear GrpArx0
35495>>>                Move iGroup   to GrpArx0.Group_ID
35496>>>                Move liArxeio to GrpArx0.Arxeio_ID
35497>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
35498>>>>
35498>>>                If (Found=1) Begin
35500>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
35503>>>                    Else                            Set cpiCannot_Read   to 20003
35505>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
35508>>>                    Else                            Set cpiCannot_Create to 20000
35510>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
35513>>>                    Else                            Set cpiCannot_Edit   to 20001
35515>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
35518>>>                    Else                            Set cpiCannot_Delete to 20002
35520>>>                End
35520>>>>
35520>>>                Else Begin
35521>>>                    Set cpiCannot_Read   to 0
35522>>>                    Set cpiCannot_Edit   to 0
35523>>>                    Set cpiCannot_Create to 0
35524>>>                    Set cpiCannot_Delete to 0
35525>>>                End
35525>>>>
35525>>>            End
35525>>>>
35525>>>        End
35525>>>>
35525>>>        Else Begin
35526>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
35526>>>            Set cpiCannot_Read   to 0
35527>>>            Set cpiCannot_Edit   to 0
35528>>>            Set cpiCannot_Create to 0
35529>>>            Set cpiCannot_Delete to 0
35530>>>        End
35530>>>>
35530>>>    End_Procedure
35531>>>
35531>>>    Procedure Clear_main_file
35532>>>        Forward Send Clear_main_file
35534>>>        Set cpiBackout to 0
35535>>>        Set cpiUpdate  to 0
35536>>>    End_Procedure
35537>>>
35537>>>    Procedure Update
35538>>>        Forward Send Update
35540>>>        Set cpiUpdate to 1
35541>>>    End_Procedure
35542>>>
35542>>>    Procedure Backout
35543>>>        Forward Send Backout
35545>>>        Set cpiBackout to 1
35546>>>    End_Procedure
35547>>>
35547>>>    Procedure OnConstrain
35548>>>        Integer rVal liSrv
35549>>>        Forward Send OnConstrain
35551>>>        Get cpiFileNumber  To liSrv
35552>>>        Move liSrv         To Filenumber
35553>>>        Get cpiCannot_Read to rVal
35554>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
35558>>>    End_Procedure
35559>>>
35559>>>    Procedure Operation_Not_Allowed  Integer iError_Num
35560>>>        String sLektiko
35561>>>        Move '' to sLektiko
35562>>>
35562>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35565>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
35569>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35573>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
35577>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35581>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
35585>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35589>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
35593>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
35597>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
35601>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
35605>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
35609>>>
35609>>>             If iError_Num eq 10000 Error 10000 sLektiko
35612>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
35616>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
35620>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
35624>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
35628>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
35632>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
35636>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
35640>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
35644>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
35648>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
35652>>>
35652>>>        Else Forward Send Operation_Not_Allowed  iError_Num
35655>>>    End_Procedure   // Operation_Not_Allowed
35656>>>
35656>>>
35656>>>End_Class //Datadictionary_Sec
35657>
35657>//------------------------------
35657>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
35657>>>//****************************************************************************
35657>>>//
35657>>>// $File name  : FlexOLE
35657>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
35657>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35657>>>// $Author     : JW, SF
35657>>>// $System     : DFOLE
35657>>>// Created     : 96-05-30 @ 18.12.51
35657>>>// $Last Rev   : 96-10-09 @ 14.59.35
35657>>>//
35657>>>// $Description
35657>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
35657>>>// Including all DLL interface declarations and DataFlex classes
35657>>>//
35657>>>// $Rev History
35657>>>//   96-05-30 File header created
35657>>>//
35657>>>//****************************************************************************
35657>>>
35657>>>USE DLL
35657>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
35657>>>>>//****************************************************************************
35657>>>>>//
35657>>>>>// $File name  : FOLE_API
35657>>>>>// $File title : API for FlexOLE
35657>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35657>>>>>// $Author     : JW, SF
35657>>>>>// $System     : FlexOLE
35657>>>>>// Created     : 96-05-30 @ 18.12.51
35657>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
35657>>>>>//
35657>>>>>// $Description
35657>>>>>//  DLL interface declarations
35657>>>>>//
35657>>>>>// $Rev History
35657>>>>>//   96-05-30 File header created
35657>>>>>//
35657>>>>>//****************************************************************************
35657>>>>>
35657>>>>>
35657>>>>>USE DLL
35657>>>>>
35657>>>>>// Global variable for OLE
35657>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
35657>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
35657>>>>>
35657>>>>>//Global integer for objectId
35657>>>>>Integer oOLEVariantId
35657>>>>>
35657>>>>>
35657>>>>>
35657>>>>>// Optional param for OLEVariant.
35657>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
35657>>>>>
35657>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
35657>>>>>// to signify that this parameter is optional and not specified.
35657>>>>>// It is only used internally, DON'T use it directly, see above constant.
35657>>>>>
35657>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
35657>>>>>
35657>>>>>// Null terminating for C strings
35657>>>>>
35657>>>>>// Alias data types
35657>>>>>                            // but since DataFlex has no substitute data type
35657>>>>>                            // it is internally casted back and forth
35657>>>>>                            // into an Integer
35657>>>>>                            // NOTE! Might be changed to a one char string
35657>>>>>
35657>>>>>
35657>>>>>
35657>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
35657>>>>>// It looks like we have to create these anyway (to compile cleanly)
35657>>>>>
35657>>>>>
35657>>>>>Type TP_OLEVariant
35657>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
35657>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
35657>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
35657>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
35657>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
35657>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
35657>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
35657>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
35657>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
35657>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
35657>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
35657>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
35657>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
35657>>>>>End_Type
35657>>>>>
35657>>>>>
35657>>>>>// VARIANT constants used with the vt field in an OLEVariant type
35657>>>>>
35657>>>>>
35657>>>>>
35657>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
35657>>>>>
35657>>>>>// Used to register the OCX event notification messages
35657>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
35658>>>>>
35658>>>>>// External functions providing access to DFOLECLN.DLL
35658>>>>>// These functions are normally not accessed directly, they are
35658>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
35658>>>>>
35658>>>>>//********DLL Interface OLE Auto General Functions************
35658>>>>>
35658>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
35659>>>>>
35659>>>>>
35659>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35660>>>>>
35660>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35661>>>>>
35661>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
35662>>>>>
35662>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35663>>>>>
35663>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35664>>>>>
35664>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
35665>>>>>
35665>>>>>//********DLL Interface OLE Auto Get Property Functions**************
35665>>>>>
35665>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35666>>>>>
35666>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35667>>>>>
35667>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35668>>>>>
35668>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35669>>>>>
35669>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35670>>>>>
35670>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
35671>>>>>
35671>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35672>>>>>
35672>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35673>>>>>
35673>>>>>
35673>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
35674>>>>>
35674>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
35675>>>>>
35675>>>>>
35675>>>>>//********DLL Interface OLE Auto Set Property Functions**************
35675>>>>>
35675>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
35676>>>>>
35676>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35677>>>>>
35677>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
35678>>>>>
35678>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
35679>>>>>
35679>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
35680>>>>>
35680>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
35681>>>>>
35681>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
35682>>>>>
35682>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
35683>>>>>
35683>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
35684>>>>>
35684>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35685>>>>>
35685>>>>>
35685>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
35685>>>>>
35685>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
35686>>>>>
35686>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
35687>>>>>
35687>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35688>>>>>
35688>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
35689>>>>>
35689>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
35690>>>>>
35690>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
35691>>>>>
35691>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
35692>>>>>
35692>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
35693>>>>>
35693>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
35694>>>>>
35694>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35695>>>>>
35695>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
35696>>>>>
35696>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
35696>>>>>
35696>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35697>>>>>
35697>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35698>>>>>
35698>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35699>>>>>
35699>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35700>>>>>
35700>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35701>>>>>
35701>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35702>>>>>
35702>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35703>>>>>
35703>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35704>>>>>
35704>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35705>>>>>
35705>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
35706>>>>>
35706>>>>>
35706>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
35707>>>>>
35707>>>>>//********DLL Interface OLE Control Functions*********************
35707>>>>>
35707>>>>>
35707>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
35708>>>>>
35708>>>>>
35708>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
35709>>>>>
35709>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
35710>>>>>
35710>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35711>>>>>
35711>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35712>>>>>
35712>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
35713>>>>>
35713>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35714>>>>>
35714>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35715>>>>>
35715>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35716>>>>>
35716>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35717>>>>>
35717>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
35718>>>>>
35718>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
35719>>>>>
35719>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
35720>>>>>
35720>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
35721>>>>>
35721>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
35722>>>>>
35722>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
35723>>>>>
35723>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
35724>>>>>
35724>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
35725>>>>>
35725>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
35726>>>>>
35726>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
35727>>>>>
35727>>>>>
35727>>>>>
35727>>>>>// This command is only used internaly and should NOT be used by the developer
35727>>>>>
35727>>>USE DFEXTCLM
35727>>>USE EXTFRM
35727>>>USE DBEXTFRM
35727>>>
35727>>>//**********
35727>>>//*** Error messages***
35727>>>//**********
35727>>>
35727>>>    Enum_List
35727>>>        Define OLE_SV_LANG
35727>>>        Define OLE_US_LANG
35727>>>    End_Enum_List
35727>>>
35727>>>    Define OLE_CURR_LANG For OLE_US_LANG
35727>>>
35727>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
35727>>>>
35727>>>
35727>>>
35727>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
35727>>>// tasks involved working with the OLEVariant.
35727>>>Class cOLEVariant is an array
35728>>>    Procedure Construct_Object
35729>>>        Forward Send Construct_Object
35731>>>        Local Integer iRetVal
35732>>>        Move (DFOleInit()) to iRetVal
35733>>>        Send OCXInit
35734>>>    End_Procedure
35735>>>
35735>>>    Procedure Destroy_Object
35736>>>        Local Integer iRetVal
35737>>>        Move (DFOleUninit()) to iRetVal
35738>>>        Forward Send Destroy_Object
35740>>>    End_Procedure
35741>>>
35741>>>    Procedure OCXInit
35742>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
35743>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
35744>>>    End_Procedure
35745>>>
35745>>>    Function GetType  OLEVariant var Returns DWORD
35746>>>        Local DWORD varVt
35747>>>        GetBuff from var at Variant.vt to varVt
35748>>>        Function_Return varVt
35749>>>    End_Function
35750>>>
35750>>>    Function GetShort OLEVariant var Returns Integer
35751>>>        Local Integer iVal
35752>>>        GetBuff from var at Variant.iVal to iVal
35753>>>        Function_Return iVal
35754>>>    End_Function
35755>>>
35755>>>    Function GetInteger OLEVariant var Returns Integer
35756>>>        Local Integer lVal
35757>>>        GetBuff from var at Variant.lVal to lVal
35758>>>        Function_Return lVal
35759>>>    End_Function
35760>>>
35760>>>    Function GetFloat OLEVariant var Returns OLEReal
35761>>>        Local OLEReal fltVal
35762>>>        GetBuff_String from var at Variant.fltVal to fltVal
35763>>>        Function_Return fltVal
35764>>>    End_Function
35765>>>
35765>>>    Function GetDouble OLEVariant var Returns OLEReal
35766>>>        Local OLEReal dblVal
35767>>>        GetBuff_String from var at Variant.dblVal to dblVal
35768>>>        Function_Return dblVal
35769>>>    End_Function
35770>>>
35770>>>    Function GetCurrency OLEVariant var Returns Number
35771>>>        Local Number cyVal
35772>>>        GetBuff_String from var at Variant.cyVal to cyVal
35773>>>        Function_Return cyVal
35774>>>    End_Function
35775>>>
35775>>>    Function GetDate OLEVariant var Returns Date
35776>>>        Local Date dtVal
35777>>>        GetBuff from var at Variant.dtVal to dtVal
35778>>>        Function_Return dtVal
35779>>>    End_Function
35780>>>
35780>>>    Function GetString OLEVariant var Returns String
35781>>>        Local String strVal
35782>>>        GetBuff_String from var at Variant.strVal to strVal
35783>>>        Function_Return strVal
35784>>>    End_Function
35785>>>
35785>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
35786>>>        Local LPDispatch dspVal
35787>>>        GetBuff from var at Variant.dspVal to dspVal
35788>>>        Function_Return dspVal
35789>>>    End_Function
35790>>>
35790>>>    Function GetOLEError OLEVariant var Returns OLEError
35791>>>        Local OLEError errVal
35792>>>        GetBuff from var at Variant.errVal to errVal
35793>>>        Function_Return errVal
35794>>>    End_Function
35795>>>
35795>>>    Function GetBool OLEVariant var Returns Bool
35796>>>        Local Bool blVal
35797>>>        GetBuff from var at Variant.blVal to blVal
35798>>>        Function_Return blVal
35799>>>    End_Function
35800>>>
35800>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
35801>>>        Local LPIUnknown uknVal
35802>>>        GetBuff from var at Variant.uknVal to uknVal
35803>>>        Function_Return uknVal
35804>>>    End_Function
35805>>>
35805>>>    Function GetUChar OLEVariant var Returns UChar
35806>>>        Local UChar ui1Val
35807>>>        GetBuff from var at Variant.ui1Val to ui1Val
35808>>>        Function_Return ui1Val
35809>>>    End_Function
35810>>>
35810>>>    Function GetValue OLEVariant var Returns String
35811>>>        Local DWORD vt
35812>>>        Local String retVal
35812>>>        Get GetType var to vt
35813>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
35816>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
35820>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
35824>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
35828>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
35832>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
35836>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
35840>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
35844>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
35848>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
35852>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
35856>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
35860>>>        Function_Return retVal
35861>>>    End_Function
35862>>>
35862>>>    Function PutValue DWORD vt String val Returns OLEVariant
35863>>>        Inst_OLEVariant var
35865>>>        Put vt to var at Variant.vt
35866>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
35869>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
35873>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
35877>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
35881>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
35885>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
35889>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
35893>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
35897>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
35901>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
35905>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
35909>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
35913>>>        Else begin
35914>>>            Put OLE_VT_ERROR to var at Variant.vt
35915>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
35916>>>        End
35916>>>>
35916>>>        Function_Return var
35917>>>    End_Function
35918>>>
35918>>>End_Class
35919>>>
35919>>>// The one and only cOLEVariant helper object
35919>>>Object oOLEVariant is a cOLEVariant
35921>>>        Move Current_Object to oOLEVariantId
35922>>>End_Object
35923>>>
35923>>>//Command so we get nicer code for the events, only used internally
35923>>>
35923>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
35923>>>
35923>>>// Command to both set the datatype and value to an OLEVariant
35923>>>
35923>>>
35923>>>// The OLE Base class, all OLE classes are derived from this class
35923>>>// Defines basic functionality and conversation with DLL interface
35923>>>
35923>>>Class cCOM_IDispatch is a Message
35924>>>
35924>>>    Procedure DefineCOM_IDispatch
35925>>>        Property String  progIdStr Public ""
35926>>>        Property Integer ClientId Public 0
35927>>>        Property Integer AutoAddRef Public 0
35928>>>    End_Procedure
35929>>>
35929>>>// GetProperty functions
35929>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
35930>>>        Local Integer lpropVal iClientId
35931>>>        Get clientId to iClientId
35932>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
35933>>>        Function_Return lpropVal
35934>>>    End_Function
35935>>>
35935>>>    Function GetShortProperty DWORD dwDispId returns Integer
35936>>>        Local Integer lpropVal iClientId
35937>>>        Get clientId to iClientId
35938>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
35939>>>        Function_Return lpropVal
35940>>>    End_Function
35941>>>
35941>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
35942>>>        Local BOOL lpropVal
35943>>>        Local Integer iClientId
35943>>>        Get clientId to iClientId
35944>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
35945>>>        Function_Return lpropVal
35946>>>    End_Function
35947>>>
35947>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
35948>>>        Local Number lpropVal
35949>>>        Local String lsProp
35949>>>        Local Integer iClientId iRetVal
35949>>>        Local Pointer llpsprop
35949>>>        Get clientId to iClientId
35950>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35951>>>        GetAddress of lsprop to llpsprop
35952>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35953>>>        Move lsProp to lpropVal
35954>>>        Function_Return lpropVal
35955>>>    End_Function
35956>>>
35956>>>    Function GetDateProperty DWORD dwDispId returns Date
35957>>>        Local Date lpropVal
35958>>>        Local Integer iClientId
35958>>>        Get clientId to iClientId
35959>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
35960>>>        Function_Return lpropVal
35961>>>    End_Function
35962>>>
35962>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
35963>>>        Local LPDispatch lpropVal
35964>>>        Local Integer iClientId
35964>>>        Get clientId to iClientId
35965>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
35966>>>        Function_Return lpropVal
35967>>>    End_Function
35968>>>
35968>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
35969>>>        Local OLEReal lpropVal
35970>>>        Local Integer iClientId iRetVal
35970>>>        Local String lsProp
35970>>>        Local Pointer llpsprop
35970>>>        Get clientId to iClientId
35971>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35972>>>        GetAddress of lsprop to llpsprop
35973>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35974>>>        Move lsProp to lpropVal
35975>>>        Function_Return lpropVal
35976>>>    End_Function
35977>>>
35977>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
35978>>>        Local OLEReal lpropVal
35979>>>        Local Integer iClientId iRetVal
35979>>>        Local String lsProp
35979>>>        Local Pointer llpsprop
35979>>>        Get clientId to iClientId
35980>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35981>>>        GetAddress of lsprop to llpsprop
35982>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35983>>>        Move lsProp to lpropVal
35984>>>        Function_Return lpropVal
35985>>>    End_Function
35986>>>
35986>>>    Function GetStringProperty DWORD dwDispId returns String
35987>>>        Local String lpropVal
35988>>>        Local Integer iClientId iRetVal
35988>>>        Local Pointer llppropVal
35988>>>        Get clientId to iClientId
35989>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
35990>>>        GetAddress of lpropVal to llppropval
35991>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35992>>>        Function_Return (CString(lpropVal))
35993>>>    End_Function
35994>>>
35994>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
35995>>>        Local OLEVariant lpropVal
35996>>>        Local Integer iClientId iRetVal
35996>>>        Local Pointer llppropVal
35996>>>        Get clientId to iClientId
35997>>>        ZeroType TP_OLEVariant to lpropVal
35998>>>        GetAddress of lpropVal to llppropval
35999>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
36000>>>        Function_Return lpropVal
36001>>>    End_Function
36002>>>
36002>>>// SetProperty procedures
36002>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
36003>>>        Local Integer iClientId iRetVal
36004>>>        Get ClientId to iClientId
36005>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36006>>>    End_Procedure
36007>>>
36007>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
36008>>>        Local Integer iClientId iRetVal
36009>>>        Get ClientId to iClientId
36010>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36011>>>    End_Procedure
36012>>>
36012>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
36013>>>        Local Integer iClientId iRetVal
36014>>>        Get ClientId to iClientId
36015>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
36016>>>    End_Procedure
36017>>>
36017>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
36018>>>        Local Integer iClientId iRetVal
36019>>>        Local String lsprop
36019>>>        Get ClientId to iClientId
36020>>>        Move lpropVal to lsprop
36021>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
36022>>>    End_Procedure
36023>>>
36023>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
36024>>>        Local Integer iClientId iRetVal
36025>>>        Get ClientId to iClientId
36026>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36027>>>    End_Procedure
36028>>>
36028>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
36029>>>        Local Integer iClientId iRetVal
36030>>>        Get ClientId to iClientId
36031>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36032>>>    End_Procedure
36033>>>
36033>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
36034>>>        Local Integer iClientId iRetVal
36035>>>        Local String lsprop
36035>>>        Get ClientId to iClientId
36036>>>        Move lpropVal to lsprop
36037>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36038>>>    End_Procedure
36039>>>
36039>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
36040>>>        Local Integer iClientId iRetVal
36041>>>        Local String lsprop
36041>>>        Get ClientId to iClientId
36042>>>        Move lpropVal to lsprop
36043>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
36044>>>    End_Procedure
36045>>>
36045>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
36046>>>        Local Integer iClientId iRetVal
36047>>>        Get ClientId to iClientId
36048>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36049>>>    End_Procedure
36050>>>
36050>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
36051>>>        Local Integer iClientId iRetVal
36052>>>        Get ClientId to iClientId
36053>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
36056>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
36057>>>    End_Procedure
36058>>>
36058>>>// Pre-Invoke functions
36058>>>    Procedure DeclareParams Integer nrOfParams
36059>>>        Local Integer iClientId iRetVal
36060>>>        Get ClientId to iCLientId
36061>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
36062>>>    End_Procedure
36063>>>
36063>>>    Procedure DefineIntegerParam Integer param
36064>>>        Local Integer iClientId iRetVal
36065>>>        Get ClientId to iClientId
36066>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
36067>>>    End_Procedure
36068>>>
36068>>>    Procedure DefineShortParam Integer param
36069>>>        Local Integer iClientId iRetVal
36070>>>        Get ClientId to iClientId
36071>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
36072>>>    End_Procedure
36073>>>
36073>>>    Procedure DefineBoolParam BOOL param
36074>>>        Local Integer iClientId iRetVal
36075>>>        Get ClientId to iClientId
36076>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
36077>>>    End_Procedure
36078>>>
36078>>>    Procedure DefineCurrencyParam Number param
36079>>>        Local Integer iClientId iRetVal
36080>>>        Local String lsparam
36080>>>        Get ClientId to iClientId
36081>>>        Move param to lsparam
36082>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
36083>>>    End_Procedure
36084>>>
36084>>>    Procedure DefineDateParam Date param
36085>>>        Local Integer iClientId iRetVal
36086>>>        Get ClientId to iClientId
36087>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
36088>>>    End_Procedure
36089>>>
36089>>>    Procedure DefineLPDispatchParam LPDispatch param
36090>>>        Local Integer iClientId iRetVal
36091>>>        Get ClientId to iClientId
36092>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
36093>>>    End_Procedure
36094>>>
36094>>>    Procedure DefineRealParam OLEReal param
36095>>>        Local Integer iClientId iRetVal
36096>>>        Local String lsparam
36096>>>        Get ClientId to iClientId
36097>>>        Move param to lsparam
36098>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
36099>>>    End_Procedure
36100>>>
36100>>>    Procedure DefineShortRealParam OLEReal param
36101>>>        Local Integer iClientId iRetVal
36102>>>        Local String lsparam
36102>>>        Get ClientId to iClientId
36103>>>        Move param to lsparam
36104>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
36105>>>    End_Procedure
36106>>>
36106>>>    Procedure DefineStringParam String param
36107>>>        Local Integer iClientId iRetVal
36108>>>        Get ClientId to iClientId
36109>>>        Append param OLENull
36110>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
36111>>>    End_Procedure
36112>>>
36112>>>    Procedure DefineOLEVariantParam OLEVariant param
36113>>>        Local Integer iClientId iRetVal
36114>>>        Get ClientId to iClientId
36115>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
36118>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
36119>>>    End_Procedure
36120>>>
36120>>>// Invoke functions
36120>>>    Procedure InvokeVoidFunction DWORD dwDispId
36121>>>        Local Integer iClientId iRetVal
36122>>>        Get ClientId to iClientId
36123>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
36124>>>    End_Procedure
36125>>>
36125>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
36126>>>        Local Integer iClientId iRetVal
36127>>>        Get ClientId to iClientId
36128>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
36129>>>        Function_Return iRetVal
36130>>>    End_Function
36131>>>
36131>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
36132>>>        Local Integer iClientId iRetVal
36133>>>        Get ClientId to iClientId
36134>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
36135>>>        Function_Return iRetVal
36136>>>    End_Function
36137>>>
36137>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
36138>>>        Local Integer iClientId iRetVal
36139>>>        Get ClientId to iClientId
36140>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
36141>>>        Function_Return iRetVal
36142>>>    End_Function
36143>>>
36143>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
36144>>>        Local Integer iClientId iRetVal
36145>>>        Local Number nRetVal
36145>>>        Local String sRetVal
36145>>>        Local Pointer psRetVal
36145>>>        Get ClientId to iClientId
36146>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36147>>>        GetAddress of sRetVal to psRetVal
36148>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36149>>>        Move sRetVal to nRetVal
36150>>>        Function_Return nRetVal
36151>>>    End_Function
36152>>>
36152>>>    Function InvokeDateFunction DWORD dwDispId returns Date
36153>>>        Local Integer iClientId
36154>>>        Local Date dRetVal
36154>>>        Get ClientId to iClientId
36155>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
36156>>>        Function_Return dRetVal
36157>>>    End_Function
36158>>>
36158>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
36159>>>        Local Integer iClientId
36160>>>        Local LPDispatch lpdRetVal
36160>>>        Get ClientId to iClientId
36161>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
36162>>>        Function_Return lpdRetVal
36163>>>    End_Function
36164>>>
36164>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
36165>>>        Local Integer iClientId iRetVal
36166>>>        Local OLEReal rRetVal
36166>>>        Local String sRetVal
36166>>>        Local Pointer psRetVal
36166>>>        Get ClientId to iClientId
36167>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36168>>>        GetAddress of sRetVal to psRetVal
36169>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36170>>>        Move sRetVal to rRetVal
36171>>>        Function_Return rRetVal
36172>>>    End_Function
36173>>>
36173>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
36174>>>        Local Integer iClientId iRetVal
36175>>>        Local OLEReal rRetVal
36175>>>        Local String sRetVal
36175>>>        Local Pointer psRetVal
36175>>>        Get ClientId to iClientId
36176>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36177>>>        GetAddress of sRetVal to psRetVal
36178>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36179>>>        Move sRetVal to rRetVal
36180>>>        Function_Return rRetVal
36181>>>    End_Function
36182>>>
36182>>>    Function InvokeStringFunction DWORD dwDispId returns String
36183>>>        Local Integer iClientId iRetVal
36184>>>        Local String sRetVal
36184>>>        Local Pointer psRetVal
36184>>>        Get ClientId to iClientId
36185>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36186>>>        GetAddress of sRetVal to psRetVal
36187>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
36188>>>        Function_Return (CString(sRetVal))
36189>>>    End_Function
36190>>>
36190>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
36191>>>        Local Integer iClientId iRetVal
36192>>>        Local OLEVariant vRetVal
36192>>>        Local Pointer pvRetVal
36192>>>        Get ClientId to iClientId
36193>>>        ZeroType TP_OLEVariant to vRetVal
36194>>>        GetAddress of vRetVal to pvRetVal
36195>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
36196>>>        Function_Return vRetVal
36197>>>    End_Function
36198>>>
36198>>>
36198>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
36198>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
36199>>>        Local Integer iRetVal
36200>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
36201>>>        Function_Return iRetVal
36202>>>    End_Function
36203>>>
36203>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
36204>>>        Local Integer iRetVal
36205>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
36206>>>        Function_Return iRetVal
36207>>>    End_Function
36208>>>
36208>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
36209>>>        Local Bool iRetVal
36210>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
36211>>>        Function_Return iRetVal
36212>>>    End_Function
36213>>>
36213>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
36214>>>        Local Integer iretVal
36215>>>        Local Currency cRetVal
36215>>>        Local String destStr
36215>>>        Local Pointer pdestStr
36215>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36216>>>        GetAddress of destStr to pdestStr
36217>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
36218>>>        Move (CString(destStr)) to cRetVal
36219>>>        Function_Return cRetVal
36220>>>    End_Function
36221>>>
36221>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
36222>>>        Local Date dRetVal
36223>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
36224>>>        Function_Return dRetVal
36225>>>    End_Function
36226>>>
36226>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
36227>>>        Local LPDispatch lpRetVal
36228>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
36229>>>        Function_Return lpRetVal
36230>>>    End_Function
36231>>>
36231>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
36232>>>        Local Integer iretVal
36233>>>        Local OLEReal rRetVal
36233>>>        Local String destStr
36233>>>        Local Pointer pdestStr
36233>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36234>>>        GetAddress of destStr to pdestStr
36235>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
36236>>>        Move (CString(destStr)) to rRetVal
36237>>>        Function_Return rRetVal
36238>>>    End_Function
36239>>>
36239>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
36240>>>        Local Integer iretVal
36241>>>        Local ShortReal rRetVal
36241>>>        Local String destStr
36241>>>        Local Pointer pdestStr
36241>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36242>>>        GetAddress of destStr to pdestStr
36243>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
36244>>>        Move (CString(destStr)) to rRetVal
36245>>>        Function_Return rRetVal
36246>>>    End_Function
36247>>>
36247>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
36248>>>        Local Integer iretVal
36249>>>        Local String sRetVal
36249>>>        Local Pointer psRetVal
36249>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
36250>>>        GetAddress of sRetVal to psRetVal
36251>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
36252>>>        Function_Return (CString(sRetVal))
36253>>>    End_Function
36254>>>
36254>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
36255>>>        Local Integer iretVal
36256>>>        Inst_OLEVariant vRetVal
36257>>>        Local Pointer pvRetVal
36257>>>        GetAddress of vRetVal to pvRetVal
36258>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
36259>>>        Function_Return vRetVal
36260>>>    End_Function
36261>>>
36261>>>End_Class
36262>>>
36262>>>
36262>>>// The OLE Automation base class,
36262>>>// which all automation classes are derived from
36262>>>
36262>>>Class Automation_Client is a cCOM_IDispatch
36263>>>    Procedure Construct_Object
36264>>>        Forward Send Construct_Object
36266>>>        Send DefineCOM_IDispatch
36267>>>        Local Integer iClientId
36268>>>        Move (CreateAutomationClient()) To iClientId
36269>>>        If iClientId Eq 0 Begin
36271>>>            Set ClientId to 0
36272>>>            Error 1002 DFOLEError1002
36273>>>>
36273>>>        End
36273>>>>
36273>>>        Else Set ClientId To iClientId
36275>>>        End_Procedure
36276>>>
36276>>>    Procedure Destroy_Object
36277>>>        Local Integer iRetVal iClientId
36278>>>        Get ClientId to iClientId
36279>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
36280>>>        Forward Send Destroy_Object
36282>>>    End_Procedure
36283>>>
36283>>>    Procedure CreateDispatch
36284>>>                Local Integer iRetVal
36285>>>                Local Integer iClientId
36285>>>        Local String sCLSID
36285>>>        Get progIdStr to sCLSID
36286>>>        Append sCLSID OLENull
36287>>>
36287>>>                Get clientId to iClientId
36288>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
36289>>>                If iRetVal Eq 0 Begin
36291>>>            Error 1000 DFOLEError1000
36292>>>>
36292>>>                End
36292>>>>
36292>>>        End_Procedure
36293>>>
36293>>>        Procedure AttachDispatch LPDispatch pdisp
36294>>>                Local Integer iRetVal
36295>>>                Local Integer iClientId
36295>>>                Local Integer bAutoAddRef
36295>>>                Get clientId to iClientId
36296>>>                Get AutoAddRef to bAutoAddRef
36297>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
36298>>>                If iRetVal Eq 0 Begin
36300>>>                Error 1001 DFOLEError1001
36301>>>>
36301>>>                End
36301>>>>
36301>>>    End_Procedure
36302>>>
36302>>>    Function AttachActiveObject Returns Bool
36303>>>                Local Bool bRetVal
36304>>>                Local Integer iClientId
36304>>>                Local String sCLSID
36304>>>                Get progIdStr to sCLSID
36305>>>                Append sCLSID OLENull
36306>>>                Get clientId to iClientId
36307>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
36308>>>                Function_Return bRetVal
36309>>>    End_Function
36310>>>
36310>>>    Procedure ReleaseDispatch
36311>>>        Local Integer iRetVal
36312>>>        Local Integer iClientId
36312>>>        Get clientId to iClientId
36313>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
36314>>>    End_Procedure
36315>>>
36315>>>    Function GetDispatch returns LPDispatch
36316>>>        Local LPDispatch retVal
36317>>>        Local Integer iClientId
36317>>>        Get clientId to iClientId
36318>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
36319>>>        Function_Return retVal
36320>>>    End_Function
36321>>>
36321>>>End_Class
36322>>>
36322>>>
36322>>>//     cCom_IDispatch  External_Class_Mixin
36322>>>//                 |       |    
36322>>>//                 |       cOCXNavigation_Mixin
36322>>>//                 |         |    
36322>>>//               cOCX_Client_Mixin
36322>>>//                        |    |
36322>>>//                        |    |
36322>>>// Form_External_Control  |    |   dbForm_External_Control
36322>>>//                 |      |    |        |  
36322>>>//                OCX_Client   dbOCX_Client
36322>>>
36322>>>
36322>>>
36322>>>// The focus navigation mixin class for ActiveX controls
36322>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
36323>>>    Import_Class_Protocol External_Class_Mixin
36324>>>    Register_Procedure WMDF_DFOCXNotifyEvent
36324>>>
36324>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
36325>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
36328>>>    End_Procedure
36329>>>
36329>>>    Procedure OCXFocusChange Integer lParam
36330>>>        If (lParam);            Send External_SetFocus
36333>>>        Else;            Send External_KillFocus
36335>>>    End_Procedure
36336>>>
36336>>>    //Provided just to cancel the External_Class_Mixin implementation
36336>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
36336>>>    Procedure Page_Object Integer state
36337>>>        Forward Send Page_Object state        
36339>>>    End_Procedure
36340>>>
36340>>>    Procedure Enable_Window integer iState
36341>>>      // Here we switch iState again, for backwards compatibility
36341>>>      Set OcxShadow_State to (Not(iState))
36342>>>    End_procedure
36343>>>
36343>>>End_Class
36344>>>
36344>>>
36344>>>//The standard OCX class mixin, it is the 
36344>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
36344>>>Class cOCX_Client_Mixin is a Mixin
36345>>>
36345>>>    Import_Class_Protocol cCOM_IDispatch
36346>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
36347>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
36347>>>
36347>>>    Procedure DefineOCX_Client
36348>>>        Send DefineCOM_IDispatch
36349>>>        Local Integer iClientId
36350>>>        Property integer Private.OCXShadowState Public 0
36351>>>        Property String  Private.OCXCaption Public ""
36352>>>        Property String  OCXLicense Public ""
36353>>>        Property String  OCXPropFile Public ""
36354>>>        Move (CreateOCXClient()) to iclientId
36355>>>                Set ClientId to iClientId
36356>>>        Send Use_Parent_Color
36357>>>    End_Procedure
36358>>>
36358>>>    Function OCXShadow_State Returns Integer
36359>>>        Local Integer bEnabled
36360>>>        Get Private.OCXShadowState to bEnabled
36361>>>        Function_Return bEnabled
36362>>>    End_Function
36363>>>
36363>>>    Procedure Set OCXShadow_State Integer bEnable
36364>>>        Local integer hWnd iSuccess iCLientId
36365>>>        Set Private.OCXShadowState to bEnable
36366>>>        Get clientId to iClientId
36367>>>        If bEnable;            Move (false) to bEnable
36370>>>        else;            Move (true) to bEnable
36372>>>        Get Window_Handle to hWnd
36373>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
36376>>>    End_Procedure
36377>>>
36377>>>    Procedure SetOCXCaption String sCaption
36378>>>        Local Integer iClientId iRetVal
36379>>>        Get ClientId to iClientId
36380>>>        Append sCaption OLENull
36381>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
36382>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
36385>>>        Else;            Set Private.OCXCaption to sCaption
36387>>>    End_Procedure
36388>>>
36388>>>    Function GetOCXCaption Returns String
36389>>>        Local Integer iClientId iRetVal
36390>>>        Local String destStr
36390>>>        Local Pointer lpDestStr
36390>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36391>>>        GetAddress of destStr to lpDestStr
36392>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
36393>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
36396>>>        Set Private.OCXCaption to (CString(destStr))
36397>>>        Function_Return (Private.OCXCaption(Current_Object))
36398>>>    End_Function
36399>>>
36399>>>    Procedure SET OCXCaption String sCaption
36400>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
36403>>>        Else;            Set Private.OCXCaption to sCaption
36405>>>    End_Procedure
36406>>>
36406>>>    Function OCXCaption Returns String
36407>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
36410>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
36412>>>    End_Procedure
36413>>>
36413>>>    // To avoid flickering during resize operations
36413>>>    Procedure Use_Parent_Color
36414>>>        Local Integer Clr Txtclr Backclr
36415>>>        Delegate Get Object_Color To Clr
36417>>>        Move (Hi(Clr)) To Txtclr
36418>>>        Move (Low(Clr)) To Backclr
36419>>>        Set Object_Color To Txtclr Backclr
36420>>>    End_Procedure
36421>>>
36421>>>    Procedure Page_Object integer iState
36422>>>        Forward Send Page_Object iState
36424>>>        If iState Eq (True) Send LoadOCX
36427>>>    End_Procedure
36428>>>
36428>>>    Procedure Remove_Object
36429>>>        Send UnloadOCX
36430>>>        Forward send Remove_Object
36432>>>    End_Procedure
36433>>>
36433>>>    Procedure LoadOCX
36434>>>        Local Pointer HWnd
36435>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
36435>>>        Local String sPrgId lic sCap sPropFile
36435>>>        Send PreCreateOCX
36436>>>        Get ClientId to iClientId
36437>>>        Get Window_Handle to hwnd
36438>>>        Get progIdStr to sPrgId
36439>>>        Append sPrgId OLENull
36440>>>        Get Private.OCXCaption To sCap
36441>>>        Append sCap OLENull
36442>>>        Get OCXLicense To Lic
36443>>>        Append Lic OLENull
36444>>>        Get OCXPropFile To sPropFile
36445>>>        Append sPropfile OLENull
36446>>>        Get Visible_State to iVisible
36447>>>        If (iVisible) Move WS_VISIBLE to dwSty
36450>>>        Else Move 0 to dwSty
36452>>>        Get Private.OCXShadowState to iShadow
36453>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
36456>>>        Move (dwSty ior WS_TABSTOP) to dwSty
36457>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
36458>>>        Send PostCreateOCX
36459>>>    End_Procedure
36460>>>
36460>>>    Procedure UnloadOCX
36461>>>        Local Integer iRetVal
36462>>>                Local Integer iClientId
36462>>>                Get ClientId to iClientId
36463>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
36464>>>    End_Procedure
36465>>>
36465>>>    //This procedure is triggered before the OCX control is created
36465>>>    Procedure PreCreateOCX
36466>>>    End_Procedure
36467>>>
36467>>>    //This procedure is triggered after the OCX control is created but
36467>>>    //before it's shown
36467>>>    Procedure PostCreateOCX
36468>>>    End_Procedure
36469>>>End_Class
36470>>>
36470>>>// The non data aware OCX class
36470>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
36470>>>Class OCX_Client is a FormExternalControl
36471>>>    Import_Class_Protocol cOCX_Client_Mixin
36472>>>
36472>>>    //These allows us to use the VDF standard 'Value' to get and set the
36472>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
36472>>>
36472>>>    Procedure Set ControlValue string sVal
36473>>>        Set OCXCaption to sVal
36474>>>    End_Procedure
36475>>>
36475>>>    Function Value Integer item_number Returns String
36476>>>        Function_Return (OCXCaption(Current_Object))
36477>>>    End_Function
36478>>>
36478>>>End_Class
36479>>>
36479>>>
36479>>>// The Data aware OCX class
36479>>>// Derive from this class if you want your ActiveX control to be data aware
36479>>>Class dbOCX_Client is a dbFormExternalControl
36480>>>    Import_Class_Protocol cOCX_Client_Mixin
36481>>>
36481>>>    Procedure DefinedbOCX_Client
36482>>>        Send DefineOCX_Client
36483>>>        Property String  Private.OCXdbValue public ""
36484>>>    End_Procedure
36485>>>
36485>>>    Procedure Set ControlValue string sVal
36486>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
36489>>>    End_Procedure
36490>>>
36490>>>    Function ControlValue Returns String
36491>>>        Function_Return (Private.OCXDbValue(Current_Object))
36492>>>    End_Function
36493>>>
36493>>>    //Triggered when the database value has changed,
36493>>>    // and the ActiveX control needs to be updated
36493>>>    //Override and perform necessary updating to the OCX
36493>>>    Procedure OnRefreshDbOcxValue String sVal
36494>>>    End_Procedure
36495>>>
36495>>>    //Should be called when the ActiveX control's value has changed,
36495>>>    // and the database value needs to be updated
36495>>>    Procedure UpdateDbOcxValue String sVal
36496>>>        Set Private.OCXdbValue to sVal
36497>>>        Send ControlValueChanged
36498>>>    End_Procedure
36499>>>
36499>>>End_Class
36500>>>
36500>>>
36500>>>// Command for common declarations of ActiveX control classes, only used internally
36500>>>
36500>>>
36500>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
36500>>>>>// OLEStdFont Charset Constants
36500>>>>>Enum_List
36500>>>>>        Define OLEANSI_CHARSET for 0 
36500>>>>>        Define OLEDEFAULT_CHARSET for 1
36500>>>>>        Define OLESYMBOL_CHARSET for 2
36500>>>>>End_Enum_List
36500>>>>>
36500>>>>>
36500>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
36500>>>>>// ProgId: 
36500>>>>>Class OLEFontMixin is a Automation_Client
36501>>>>>
36501>>>>>        Function StdFontName Returns String
36502>>>>>                Local String lpropVal
36503>>>>>                Get GetStringProperty 0 to lpropVal
36504>>>>>                Function_Return lpropVal
36505>>>>>        End_Function
36506>>>>>
36506>>>>>        Procedure SET StdFontName String lpropVal
36507>>>>>                Send SetStringProperty 0 lpropVal
36508>>>>>        End_Procedure
36509>>>>>
36509>>>>>        Function StdFontSize Returns Currency
36510>>>>>                Local Currency lpropVal
36511>>>>>                Get GetCurrencyProperty 2 to lpropVal
36512>>>>>                Function_Return lpropVal
36513>>>>>        End_Function
36514>>>>>
36514>>>>>        Procedure SET StdFontSize Currency lpropVal
36515>>>>>                Send SetCurrencyProperty 2 lpropVal
36516>>>>>        End_Procedure
36517>>>>>
36517>>>>>        Function StdFontBold Returns Bool
36518>>>>>                Local Bool lpropVal
36519>>>>>                Get GetBoolProperty 3 to lpropVal
36520>>>>>                Function_Return lpropVal
36521>>>>>        End_Function
36522>>>>>
36522>>>>>        Procedure SET StdFontBold Bool lpropVal
36523>>>>>                Send SetBoolProperty 3 lpropVal
36524>>>>>        End_Procedure
36525>>>>>
36525>>>>>        Function StdFontItalic Returns Bool
36526>>>>>                Local Bool lpropVal
36527>>>>>                Get GetBoolProperty 4 to lpropVal
36528>>>>>                Function_Return lpropVal
36529>>>>>        End_Function
36530>>>>>
36530>>>>>        Procedure SET StdFontItalic Bool lpropVal
36531>>>>>                Send SetBoolProperty 4 lpropVal
36532>>>>>        End_Procedure
36533>>>>>
36533>>>>>        Function StdFontUnderline Returns Bool
36534>>>>>                Local Bool lpropVal
36535>>>>>                Get GetBoolProperty 5 to lpropVal
36536>>>>>                Function_Return lpropVal
36537>>>>>        End_Function
36538>>>>>
36538>>>>>        Procedure SET StdFontUnderline Bool lpropVal
36539>>>>>                Send SetBoolProperty 5 lpropVal
36540>>>>>        End_Procedure
36541>>>>>
36541>>>>>        Function StdFontStrikethrough Returns Bool
36542>>>>>                Local Bool lpropVal
36543>>>>>                Get GetBoolProperty 6 to lpropVal
36544>>>>>                Function_Return lpropVal
36545>>>>>        End_Function
36546>>>>>
36546>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
36547>>>>>                Send SetBoolProperty 6 lpropVal
36548>>>>>        End_Procedure
36549>>>>>
36549>>>>>        Function StdFontWeight Returns Integer
36550>>>>>                Local Integer lpropVal
36551>>>>>                Get GetShortProperty 7 to lpropVal
36552>>>>>                Function_Return lpropVal
36553>>>>>        End_Function
36554>>>>>
36554>>>>>        Procedure SET StdFontWeight Integer lpropVal
36555>>>>>                Send SetShortProperty 7 lpropVal
36556>>>>>        End_Procedure
36557>>>>>
36557>>>>>        Function StdFontCharset Returns Integer
36558>>>>>                Local Integer lpropVal
36559>>>>>                Get GetShortProperty 8 to lpropVal
36560>>>>>                Function_Return lpropVal
36561>>>>>        End_Function
36562>>>>>
36562>>>>>        Procedure SET StdFontCharset Integer lpropVal
36563>>>>>                Send SetShortProperty 8 lpropVal
36564>>>>>        End_Procedure
36565>>>>>
36565>>>>>End_Class
36566>>>>>
36566>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
36566>>>>>// ProgId: StdFont
36566>>>>>// Number of impl.Types:1
36566>>>>>// Referenced class Font
36566>>>>>Class OLEStdFont is a Automation_Client
36567>>>>>        Import_Class_Protocol OLEFontMixin
36568>>>>>
36568>>>>>        Procedure Construct_Object
36569>>>>>                Forward Send Construct_Object
36571>>>>>                Set progIdStr to "StdFont"
36572>>>>>        End_Procedure
36573>>>>>End_Class
36574>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
36574>>>>>
36574>>>>>// Picture Type Constants
36574>>>>>//Enum_List
36574>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
36574>>>>>        Define OLEPICTYPE_NONE for 0 // None
36574>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
36574>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
36574>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
36574>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
36574>>>>>//End_Enum_List
36574>>>>>
36574>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
36574>>>>>// ProgId: 
36574>>>>>Class OLEPictureMixin is a Automation_Client
36575>>>>>
36575>>>>>        Function StdPictureHandle Returns OLE_HANDLE
36576>>>>>                Local OLE_HANDLE lpropVal
36577>>>>>                Get GetIntegerProperty 0 to lpropVal
36578>>>>>                Function_Return lpropVal
36579>>>>>        End_Function
36580>>>>>
36580>>>>>        Function StdPicturehPal Returns OLE_HANDLE
36581>>>>>                Local OLE_HANDLE lpropVal
36582>>>>>                Get GetIntegerProperty 2 to lpropVal
36583>>>>>                Function_Return lpropVal
36584>>>>>        End_Function
36585>>>>>
36585>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
36586>>>>>                Send SetIntegerProperty 2 lpropVal
36587>>>>>        End_Procedure
36588>>>>>
36588>>>>>        Function StdPictureType Returns Integer
36589>>>>>                Local Integer lpropVal
36590>>>>>                Get GetShortProperty 3 to lpropVal
36591>>>>>                Function_Return lpropVal
36592>>>>>        End_Function
36593>>>>>
36593>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
36594>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
36595>>>>>                Get GetIntegerProperty 4 to lpropVal
36596>>>>>                Function_Return lpropVal
36597>>>>>        End_Function
36598>>>>>
36598>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
36599>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
36600>>>>>                Get GetIntegerProperty 5 to lpropVal
36601>>>>>                Function_Return lpropVal
36602>>>>>        End_Function
36603>>>>>
36603>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
36604>>>>>                Send DeclareParams 10
36605>>>>>                Send DefineIntegerParam lhdc
36606>>>>>                Send DefineIntegerParam lx
36607>>>>>                Send DefineIntegerParam ly
36608>>>>>                Send DefineIntegerParam lcx
36609>>>>>                Send DefineIntegerParam lcy
36610>>>>>                Send DefineIntegerParam lxSrc
36611>>>>>                Send DefineIntegerParam lySrc
36612>>>>>                Send DefineIntegerParam lcxSrc
36613>>>>>                Send DefineIntegerParam lcySrc
36614>>>>>                Send DefineIntegerParam lprcWBounds
36615>>>>>                Send InvokeVoidFunction 6
36616>>>>>        End_Procedure 
36617>>>>>
36617>>>>>End_Class
36618>>>>>
36618>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
36618>>>>>// ProgId: StdPicture
36618>>>>>// Number of impl.Types:1
36618>>>>>// Referenced class Picture
36618>>>>>Class OLEStdPicture is a Automation_Client
36619>>>>>        Import_Class_Protocol OLEPictureMixin
36620>>>>>
36620>>>>>        Procedure Construct_Object
36621>>>>>                Forward Send Construct_Object
36623>>>>>                Set progIdStr to "StdPicture"
36624>>>>>        End_Procedure
36625>>>>>End_Class
36626>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
36626>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
36626>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
36626>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36626>>>
36626>>>//Enum_List
36626>>>    Define OLEdpdDesktop        for  0 // Desktop
36626>>>    Define OLEdpdControlPanel   for  1 // Control Panel
36626>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
36626>>>    Define OLEdpdMyComputer     for  3 // My Computer
36626>>>    Define OLEdpdFontDir        for  4 // Font Directory
36626>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
36626>>>    Define OLEdpdPrinters       for  6 // Printers
36626>>>    Define OLEdpdPrograms       for  7 // Programs
36626>>>    Define OLEdpdRecent         for  8 // Recent
36626>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
36626>>>    Define OLEdpdSendTo         for 10 // Send To
36626>>>    Define OLEdpdStartMenu      for 11 // Start Menu
36626>>>    Define OLEdpdStartUp        for 12 // Start Up
36626>>>    Define OLEdpdTemplates      for 13 // Templates
36626>>>    Define OLEdpdCustom         for 14 // Custom Root
36626>>>//End_Enum_List
36626>>>
36626>>>// Dispatch interface for DPDlg Control
36626>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
36626>>>// ProgId:
36626>>>Class OLE_DDPDlg is a Message
36627>>>
36627>>>        Function DPDlgBrowseForComputer Returns Bool
36628>>>                Local Bool lpropVal
36629>>>                Get GetBoolProperty 1 to lpropVal
36630>>>                Function_Return lpropVal
36631>>>        End_Function
36632>>>
36632>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
36633>>>                Send SetBoolProperty 1 lpropVal
36634>>>        End_Procedure
36635>>>
36635>>>        Function DPDlgBrowseForPrinter Returns Bool
36636>>>                Local Bool lpropVal
36637>>>                Get GetBoolProperty 2 to lpropVal
36638>>>                Function_Return lpropVal
36639>>>        End_Function
36640>>>
36640>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
36641>>>                Send SetBoolProperty 2 lpropVal
36642>>>        End_Procedure
36643>>>
36643>>>        Function DPDlgDontGoBelowDomain Returns Bool
36644>>>                Local Bool lpropVal
36645>>>                Get GetBoolProperty 3 to lpropVal
36646>>>                Function_Return lpropVal
36647>>>        End_Function
36648>>>
36648>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
36649>>>                Send SetBoolProperty 3 lpropVal
36650>>>        End_Procedure
36651>>>
36651>>>        Function DPDlgReturnFSAncestors Returns Bool
36652>>>                Local Bool lpropVal
36653>>>                Get GetBoolProperty 4 to lpropVal
36654>>>                Function_Return lpropVal
36655>>>        End_Function
36656>>>
36656>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
36657>>>                Send SetBoolProperty 4 lpropVal
36658>>>        End_Procedure
36659>>>
36659>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
36660>>>                Local Bool lpropVal
36661>>>                Get GetBoolProperty 5 to lpropVal
36662>>>                Function_Return lpropVal
36663>>>        End_Function
36664>>>
36664>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
36665>>>                Send SetBoolProperty 5 lpropVal
36666>>>        End_Procedure
36667>>>
36667>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
36668>>>                Local OLE_ROOTSHORT lpropVal
36669>>>                Get GetIntegerProperty 6 to lpropVal
36670>>>                Function_Return lpropVal
36671>>>        End_Function
36672>>>
36672>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
36673>>>                Send SetIntegerProperty 6 lpropVal
36674>>>        End_Procedure
36675>>>
36675>>>        Function DPDlghWnd Returns OLE_HANDLE
36676>>>                Local OLE_HANDLE lpropVal
36677>>>                Get GetIntegerProperty -515 to lpropVal
36678>>>                Function_Return lpropVal
36679>>>        End_Function
36680>>>
36680>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
36681>>>                Send SetIntegerProperty -515 lpropVal
36682>>>        End_Procedure
36683>>>
36683>>>        Function DPDlgIcon Returns LPDispatch
36684>>>                Local LPDispatch lpropVal
36685>>>                Get GetLPDispatchProperty 7 to lpropVal
36686>>>                Function_Return lpropVal
36687>>>        End_Function
36688>>>
36688>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
36689>>>                Send SetLPDispatchProperty 7 lpropVal
36690>>>        End_Procedure
36691>>>
36691>>>        Function DPDlgFolder Returns String
36692>>>                Local String lpropVal
36693>>>                Get GetStringProperty 8 to lpropVal
36694>>>                Function_Return lpropVal
36695>>>        End_Function
36696>>>
36696>>>        Procedure SET DPDlgFolder String lpropVal
36697>>>                Send SetStringProperty 8 lpropVal
36698>>>        End_Procedure
36699>>>
36699>>>        Function DPDlgCaption Returns String
36700>>>                Local String lpropVal
36701>>>                Get GetStringProperty -518 to lpropVal
36702>>>                Function_Return lpropVal
36703>>>        End_Function
36704>>>
36704>>>        Procedure SET DPDlgCaption String lpropVal
36705>>>                Send SetStringProperty -518 lpropVal
36706>>>        End_Procedure
36707>>>
36707>>>        Function DPDlg_Caption Returns String
36708>>>                Local String lpropVal
36709>>>                Get GetStringProperty 0 to lpropVal
36710>>>                Function_Return lpropVal
36711>>>        End_Function
36712>>>
36712>>>        Procedure SET DPDlg_Caption String lpropVal
36713>>>                Send SetStringProperty 0 lpropVal
36714>>>        End_Procedure
36715>>>
36715>>>        Function DPDlgPath Returns String
36716>>>                Local String lpropVal
36717>>>                Get GetStringProperty 9 to lpropVal
36718>>>                Function_Return lpropVal
36719>>>        End_Function
36720>>>
36720>>>        Procedure SET DPDlgPath String lpropVal
36721>>>                Send SetStringProperty 9 lpropVal
36722>>>        End_Procedure
36723>>>
36723>>>        Function DPDlgCustomRoot Returns String
36724>>>                Local String lpropVal
36725>>>                Get GetStringProperty 10 to lpropVal
36726>>>                Function_Return lpropVal
36727>>>        End_Function
36728>>>
36728>>>        Procedure SET DPDlgCustomRoot String lpropVal
36729>>>                Send SetStringProperty 10 lpropVal
36730>>>        End_Procedure
36731>>>
36731>>>        Function DPDlgShow Returns Bool
36732>>>                Local Bool lretVal
36733>>>                Get InvokeBoolFunction 11 to lretVal
36734>>>                Function_Return lretVal
36735>>>        End_Function
36736>>>
36736>>>        Procedure DPDlgAboutBox
36737>>>                Send InvokeVoidFunction -552
36738>>>        End_Procedure
36739>>>
36739>>>End_Class
36740>>>
36740>>>// Event interface for DPDlg Control
36740>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
36740>>>// ProgId:
36740>>>Class OLE_DDPDlgEvents is a Message
36741>>>
36741>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
36742>>>        End_Procedure
36743>>>
36743>>>End_Class
36744>>>
36744>>>// DPDlg Control
36744>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36744>>>// ProgId: DPDLG.DPDlgCtrl.1
36744>>>// Number of impl.Types:2
36744>>>// Referenced class _DDPDlg
36744>>>// Referenced class _DDPDlgEvents
36744>>>Class OLEDPDlg is a OCX_Client
36745>>>        Import_Class_Protocol OLE_DDPDlg
36746>>>        Import_Class_Protocol OLE_DDPDlgEvents
36747>>>
36747>>>        Procedure Construct_Object
36748>>>                Forward Send Construct_Object
36750>>>                Send DefineOCX_Client
36751>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36752>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36755>>>        End_Procedure
36756>>>
36756>>>        Procedure PreDPDlgFolderSelected Integer lParam
36757>>>                Local String lPath
36758>>>                Local Bool lAllow
36758>>>                Get GetEventStringParam lParam 0 to lPath
36759>>>                Get GetEventBoolParam lParam 1 to lAllow
36760>>>                Send OnDPDlgFolderSelected lPath lAllow
36761>>>        End_Procedure
36762>>>
36762>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36763>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36766>>>        End_Procedure
36767>>>End_Class
36768>>>
36768>>>// DPDlg Control
36768>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36768>>>// ProgId: DPDLG.DPDlgCtrl.1
36768>>>// Number of impl.Types:2
36768>>>// Referenced class _DDPDlg
36768>>>// Referenced class _DDPDlgEvents
36768>>>Class dbOLEDPDlg is a dbOCX_Client
36769>>>        Import_Class_Protocol OLE_DDPDlg
36770>>>        Import_Class_Protocol OLE_DDPDlgEvents
36771>>>
36771>>>        Procedure Construct_Object
36772>>>                Forward Send Construct_Object
36774>>>                Send DefineDbOCX_Client
36775>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36776>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36779>>>        End_Procedure
36780>>>
36780>>>        Procedure PreDPDlgFolderSelected Integer lParam
36781>>>                Local String lPath
36782>>>                Local Bool lAllow
36782>>>                Get GetEventStringParam lParam 0 to lPath
36783>>>                Get GetEventBoolParam lParam 1 to lAllow
36784>>>                Send OnDPDlgFolderSelected lPath lAllow
36785>>>        End_Procedure
36786>>>
36786>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36787>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36790>>>        End_Procedure
36791>>>End_Class
36792>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
36792>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
36792>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
36792>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36792>>>
36792>>>//Enum_List
36792>>>    Define OLERasActionNone         for 0 // No action
36792>>>    Define OLERasActionConnect      for 1 // Connect server
36792>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
36792>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
36792>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
36792>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
36792>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
36792>>>//End_Enum_List
36792>>>
36792>>>// IRasXCom Interface
36792>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
36792>>>// ProgId:
36792>>>Class OLEIRasXCom is a Automation_Client
36793>>>
36793>>>// Sets or returns the filename of the phonebook to use.
36793>>>        Function RasXComPhoneBook Returns String
36794>>>                Local String lpropVal
36795>>>                Get GetStringProperty 1 to lpropVal
36796>>>                Function_Return lpropVal
36797>>>        End_Function
36798>>>
36798>>>// Sets or returns the filename of the phonebook to use.
36798>>>        Procedure SET RasXComPhoneBook String lpropVal
36799>>>                Send SetStringProperty 1 lpropVal
36800>>>        End_Procedure
36801>>>
36801>>>// Sets or returns the phone number to dial.
36801>>>        Function RasXComPhoneNumber Returns String
36802>>>                Local String lpropVal
36803>>>                Get GetStringProperty 2 to lpropVal
36804>>>                Function_Return lpropVal
36805>>>        End_Function
36806>>>
36806>>>// Sets or returns the phone number to dial.
36806>>>        Procedure SET RasXComPhoneNumber String lpropVal
36807>>>                Send SetStringProperty 2 lpropVal
36808>>>        End_Procedure
36809>>>
36809>>>// Sets or returns the name to use when logging on.
36809>>>        Function RasXComLogonName Returns String
36810>>>                Local String lpropVal
36811>>>                Get GetStringProperty 3 to lpropVal
36812>>>                Function_Return lpropVal
36813>>>        End_Function
36814>>>
36814>>>// Sets or returns the name to use when logging on.
36814>>>        Procedure SET RasXComLogonName String lpropVal
36815>>>                Send SetStringProperty 3 lpropVal
36816>>>        End_Procedure
36817>>>
36817>>>// Sets or returns the password to use.
36817>>>        Function RasXComLogonPassword Returns String
36818>>>                Local String lpropVal
36819>>>                Get GetStringProperty 4 to lpropVal
36820>>>                Function_Return lpropVal
36821>>>        End_Function
36822>>>
36822>>>// Sets or returns the password to use.
36822>>>        Procedure SET RasXComLogonPassword String lpropVal
36823>>>                Send SetStringProperty 4 lpropVal
36824>>>        End_Procedure
36825>>>
36825>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36825>>>        Function RasXComCallbackNumber Returns String
36826>>>                Local String lpropVal
36827>>>                Get GetStringProperty 5 to lpropVal
36828>>>                Function_Return lpropVal
36829>>>        End_Function
36830>>>
36830>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36830>>>        Procedure SET RasXComCallbackNumber String lpropVal
36831>>>                Send SetStringProperty 5 lpropVal
36832>>>        End_Procedure
36833>>>
36833>>>// Sets or returns the name of the current phone book entry.
36833>>>        Function RasXComEntryName Returns String
36834>>>                Local String lpropVal
36835>>>                Get GetStringProperty 6 to lpropVal
36836>>>                Function_Return lpropVal
36837>>>        End_Function
36838>>>
36838>>>// Sets or returns the name of the current phone book entry.
36838>>>        Procedure SET RasXComEntryName String lpropVal
36839>>>                Send SetStringProperty 6 lpropVal
36840>>>        End_Procedure
36841>>>
36841>>>// Sets or returns the domain to use for user authentication.
36841>>>        Function RasXComDomain Returns String
36842>>>                Local String lpropVal
36843>>>                Get GetStringProperty 7 to lpropVal
36844>>>                Function_Return lpropVal
36845>>>        End_Function
36846>>>
36846>>>// Sets or returns the domain to use for user authentication.
36846>>>        Procedure SET RasXComDomain String lpropVal
36847>>>                Send SetStringProperty 7 lpropVal
36848>>>        End_Procedure
36849>>>
36849>>>// Determines if methods are blocking.
36849>>>        Function RasXComBlocking Returns Bool
36850>>>                Local Bool lpropVal
36851>>>                Get GetBoolProperty 8 to lpropVal
36852>>>                Function_Return lpropVal
36853>>>        End_Function
36854>>>
36854>>>// Determines if methods are blocking.
36854>>>        Procedure SET RasXComBlocking Bool lpropVal
36855>>>                Send SetBoolProperty 8 lpropVal
36856>>>        End_Procedure
36857>>>
36857>>>// Returns the version of the control.
36857>>>        Function RasXComVersion Returns String
36858>>>                Local String lpropVal
36859>>>                Get GetStringProperty 9 to lpropVal
36860>>>                Function_Return lpropVal
36861>>>        End_Function
36862>>>
36862>>>// Returns the number of names in the current phonebook.
36862>>>        Function RasXComEntryCount Returns Integer
36863>>>                Local Integer lpropVal
36864>>>                Get GetShortProperty 10 to lpropVal
36865>>>                Function_Return lpropVal
36866>>>        End_Function
36867>>>
36867>>>// Returns whether or not RAS services are available.
36867>>>        Function RasXComRASAvailable Returns Bool
36868>>>                Local Bool lpropVal
36869>>>                Get GetBoolProperty 11 to lpropVal
36870>>>                Function_Return lpropVal
36871>>>        End_Function
36872>>>
36872>>>// Holds the last error number reported.
36872>>>        Function RasXComLastError Returns Integer
36873>>>                Local Integer lpropVal
36874>>>                Get GetShortProperty 12 to lpropVal
36875>>>                Function_Return lpropVal
36876>>>        End_Function
36877>>>
36877>>>// Returns the last method executed.
36877>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
36878>>>                Local OLE_MethodsEnum lpropVal
36879>>>                Get GetIntegerProperty 13 to lpropVal
36880>>>                Function_Return lpropVal
36881>>>        End_Function
36882>>>
36882>>>// Holds a description of the last error number reported.
36882>>>        Function RasXComLastErrorString Returns String
36883>>>                Local String lpropVal
36884>>>                Get GetStringProperty 14 to lpropVal
36885>>>                Function_Return lpropVal
36886>>>        End_Function
36887>>>
36887>>>// The current state of the control.
36887>>>        Function RasXComState Returns Integer
36888>>>                Local Integer lpropVal
36889>>>                Get GetShortProperty 15 to lpropVal
36890>>>                Function_Return lpropVal
36891>>>        End_Function
36892>>>
36892>>>// A user-friendly version of the current state of the control.
36892>>>        Function RasXComStateString Returns String
36893>>>                Local String lpropVal
36894>>>                Get GetStringProperty 16 to lpropVal
36895>>>                Function_Return lpropVal
36896>>>        End_Function
36897>>>
36897>>>// Returns the RAS handle of a connection.
36897>>>        Function RasXComHandle Returns DWORD
36898>>>                Local DWORD lpropVal
36899>>>                Get GetIntegerProperty 17 to lpropVal
36900>>>                Function_Return lpropVal
36901>>>        End_Function
36902>>>
36902>>>// Returns whether or not a connection is active.
36902>>>        Function RasXComEntryConnected Returns Bool
36903>>>                Local Bool lpropVal
36904>>>                Get GetBoolProperty 18 to lpropVal
36905>>>                Function_Return lpropVal
36906>>>        End_Function
36907>>>
36907>>>// Returns the list of names in a phone book.
36907>>>        Function RasXComEntryList Integer lIndex Returns String
36908>>>                Local String lpropVal
36909>>>                Send DeclareParams 1
36910>>>                Send DefineShortParam lIndex
36911>>>                Get GetStringProperty 19 to lpropVal
36912>>>                Function_Return lpropVal
36913>>>        End_Function
36914>>>
36914>>>// Holds licensing information.
36914>>>        Function RasXComLicenseKey Returns String
36915>>>                Local String lpropVal
36916>>>                Get GetStringProperty 20 to lpropVal
36917>>>                Function_Return lpropVal
36918>>>        End_Function
36919>>>
36919>>>// Holds licensing information.
36919>>>        Procedure SET RasXComLicenseKey String lpropVal
36920>>>                Send SetStringProperty 20 lpropVal
36921>>>        End_Procedure
36922>>>
36922>>>// Connects to a server.
36922>>>        Procedure RasXComConnect
36923>>>                Send InvokeVoidFunction 22
36924>>>        End_Procedure
36925>>>
36925>>>// Disconnects (logs off) from the server.
36925>>>        Procedure RasXComDisconnect
36926>>>                Send InvokeVoidFunction 23
36927>>>        End_Procedure
36928>>>
36928>>>// Retrives an entry from the current phonebook.
36928>>>        Procedure RasXComGetEntry
36929>>>                Send InvokeVoidFunction 24
36930>>>        End_Procedure
36931>>>
36931>>>// Creates and entry in the current phone book.
36931>>>        Procedure RasXComCreateEntry
36932>>>                Send InvokeVoidFunction 25
36933>>>        End_Procedure
36934>>>
36934>>>// Allows the user to edit a RAS phone book entry.
36934>>>        Procedure RasXComEditEntry
36935>>>                Send InvokeVoidFunction 26
36936>>>        End_Procedure
36937>>>
36937>>>// Resets the component to its original state and re-loads the phone book.
36937>>>        Procedure RasXComRefresh
36938>>>                Send InvokeVoidFunction -550
36939>>>        End_Procedure
36940>>>
36940>>>// Displays About Box.
36940>>>        Procedure RasXComAbout
36941>>>                Send InvokeVoidFunction -552
36942>>>        End_Procedure
36943>>>
36943>>>// Allows object to unload without disconnecting the current connection.
36943>>>        Function RasXComDisconnectOnDestroy Returns Bool
36944>>>                Local Bool lpropVal
36945>>>                Get GetBoolProperty 28 to lpropVal
36946>>>                Function_Return lpropVal
36947>>>        End_Function
36948>>>
36948>>>// Allows object to unload without disconnecting the current connection.
36948>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
36949>>>                Send SetBoolProperty 28 lpropVal
36950>>>        End_Procedure
36951>>>
36951>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36951>>>        Function RasXComNotificationObject Returns LPDispatch
36952>>>                Local LPDispatch lpropVal
36953>>>                Get GetLPDispatchProperty 27 to lpropVal
36954>>>                Function_Return lpropVal
36955>>>        End_Function
36956>>>
36956>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36956>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
36957>>>                Send SetLPDispatchProperty 27 lpropVal
36958>>>        End_Procedure
36959>>>
36959>>>// Returns the version of the control.
36959>>>        Procedure SET RasXComVersion String lpropVal
36960>>>                Send SetStringProperty 9 lpropVal
36961>>>        End_Procedure
36962>>>
36962>>>End_Class
36963>>>
36963>>>// _IRasXComEvents Interface
36963>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
36963>>>// ProgId:
36963>>>Class OLE_IRasXComEvents is a Automation_Client
36964>>>
36964>>>// Fired when a method finishes.
36964>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36965>>>                Send DeclareParams 3
36966>>>                Send DefineIntegerParam lLastMethod
36967>>>                Send DefineShortParam lErrorCode
36968>>>                Send DefineStringParam lErrorString
36969>>>                Send InvokeVoidFunction 1
36970>>>        End_Procedure
36971>>>
36971>>>// Fired when the control's internal state changes.
36971>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
36972>>>                Send DeclareParams 2
36973>>>                Send DefineShortParam lNewState
36974>>>                Send DefineShortParam lOldState
36975>>>                Send InvokeVoidFunction 2
36976>>>        End_Procedure
36977>>>
36977>>>End_Class
36978>>>
36978>>>// RasXCom Class
36978>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
36978>>>// ProgId: Mabry.RasXCom.1
36978>>>// Number of impl.Types:2
36978>>>// Referenced class IRasXCom
36978>>>// Referenced class _IRasXComEvents
36978>>>Class OLERasXCom is a Automation_Client
36979>>>        Import_Class_Protocol OLEIRasXCom
36980>>>        Import_Class_Protocol OLE_IRasXComEvents
36981>>>
36981>>>        Procedure Construct_Object
36982>>>                Forward Send Construct_Object
36984>>>        Set progIdStr to "Mabry.RasXCom"
36985>>>        End_Procedure
36986>>>End_Class
36987>>>
36987>>>// IRasXComNotify Interface
36987>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
36987>>>// ProgId:
36987>>>Class OLEIRasXComNotify is a Automation_Client
36988>>>
36988>>>// Done
36988>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36989>>>                Send DeclareParams 4
36990>>>                Send DefineLPDispatchParam lPackageObject
36991>>>                Send DefineIntegerParam lLastMethod
36992>>>                Send DefineShortParam lErrorCode
36993>>>                Send DefineStringParam lErrorString
36994>>>                Send InvokeVoidFunction 1
36995>>>        End_Procedure
36996>>>
36996>>>// Fired when the control's internal state changes.
36996>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
36997>>>                Send DeclareParams 3
36998>>>                Send DefineLPDispatchParam lPackageObject
36999>>>                Send DefineShortParam lNewState
37000>>>                Send DefineShortParam lOldState
37001>>>                Send InvokeVoidFunction 2
37002>>>        End_Procedure
37003>>>
37003>>>End_Class
37004>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
37004>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
37004>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
37004>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37004>>>
37004>>>// Dispatch interface for xfind Control
37004>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
37004>>>// ProgId: 
37004>>>Class OLEIxfind is a Message
37005>>>
37005>>>        Procedure xfindAboutBox
37006>>>                Send InvokeVoidFunction -552
37007>>>        End_Procedure 
37008>>>
37008>>>        Function xfindSearchString Returns String
37009>>>                Local String lpropVal
37010>>>                Get GetStringProperty 6 to lpropVal
37011>>>                Function_Return lpropVal
37012>>>        End_Function
37013>>>
37013>>>        Procedure SET xfindSearchString String lpropVal
37014>>>                Send SetStringProperty 6 lpropVal
37015>>>        End_Procedure
37016>>>
37016>>>        Function xfindSearchFrom Returns String
37017>>>                Local String lpropVal
37018>>>                Get GetStringProperty 7 to lpropVal
37019>>>                Function_Return lpropVal
37020>>>        End_Function
37021>>>
37021>>>        Procedure SET xfindSearchFrom String lpropVal
37022>>>                Send SetStringProperty 7 lpropVal
37023>>>        End_Procedure
37024>>>
37024>>>        Function xfindSearchSubDirs Returns Bool
37025>>>                Local Bool lpropVal
37026>>>                Get GetBoolProperty 8 to lpropVal
37027>>>                Function_Return lpropVal
37028>>>        End_Function
37029>>>
37029>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
37030>>>                Send SetBoolProperty 8 lpropVal
37031>>>        End_Procedure
37032>>>
37032>>>        Procedure xfindStartSearching
37033>>>                Send InvokeVoidFunction 2
37034>>>        End_Procedure 
37035>>>
37035>>>        Function xfindIsSearching Returns Bool
37036>>>                Local Bool lpropVal
37037>>>                Get GetBoolProperty 5 to lpropVal
37038>>>                Function_Return lpropVal
37039>>>        End_Function
37040>>>
37040>>>        Procedure xfindAbortSearch
37041>>>                Send InvokeVoidFunction 9
37042>>>        End_Procedure 
37043>>>
37043>>>        Function xfindFileName Returns String
37044>>>                Local String lpropVal
37045>>>                Get GetStringProperty 3 to lpropVal
37046>>>                Function_Return lpropVal
37047>>>        End_Function
37048>>>
37048>>>        Function xfindFileSize Returns DWORD
37049>>>                Local DWORD lpropVal
37050>>>                Get GetIntegerProperty 4 to lpropVal
37051>>>                Function_Return lpropVal
37052>>>        End_Function
37053>>>
37053>>>End_Class
37054>>>
37054>>>// Events interface for xfind Control
37054>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
37054>>>// ProgId: 
37054>>>Class OLEIxfindEvents is a Message
37055>>>
37055>>>        Procedure OnxfindActivate
37056>>>        End_Procedure
37057>>>
37057>>>        Procedure OnxfindClick
37058>>>        End_Procedure
37059>>>
37059>>>        Procedure OnxfindCreate
37060>>>        End_Procedure
37061>>>
37061>>>        Procedure OnxfindDblClick
37062>>>        End_Procedure
37063>>>
37063>>>        Procedure OnxfindDestroy
37064>>>        End_Procedure
37065>>>
37065>>>        Procedure OnxfindDeactivate
37066>>>        End_Procedure
37067>>>
37067>>>        Procedure OnxfindKeyPress Integer lKey
37068>>>        End_Procedure
37069>>>
37069>>>        Procedure OnxfindPaint
37070>>>        End_Procedure
37071>>>
37071>>>        Procedure OnxfindFinishedSearch
37072>>>        End_Procedure
37073>>>
37073>>>        Procedure OnxfindFoundFile
37074>>>        End_Procedure
37075>>>
37075>>>End_Class
37076>>>
37076>>>// xfind Control
37076>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37076>>>// ProgId: xfind10.xfind
37076>>>// Number of impl.Types:2
37076>>>// Referenced class Ixfind
37076>>>// Referenced class IxfindEvents
37076>>>Class OLExfind is a OCX_Client
37077>>>        Import_Class_Protocol OLEIxfind
37078>>>        Import_Class_Protocol OLEIxfindEvents
37079>>>
37079>>>        Procedure Construct_Object
37080>>>                Forward Send Construct_Object
37082>>>                Send DefineOCX_Client
37083>>>                Set progIdStr to "xfind10.xfind"
37084>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37087>>>        End_Procedure
37088>>>
37088>>>        Procedure PrexfindKeyPress Integer lParam
37089>>>                Local Integer lKey
37090>>>                Get GetEventShortParam lParam 0 to lKey
37091>>>                Send OnxfindKeyPress lKey
37092>>>        End_Procedure
37093>>>
37093>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37094>>>                ON_EVENT 1 Fire OnxfindActivate
37097>>>                ON_EVENT 2 Fire OnxfindClick
37100>>>                ON_EVENT 3 Fire OnxfindCreate
37103>>>                ON_EVENT 5 Fire OnxfindDblClick
37106>>>                ON_EVENT 6 Fire OnxfindDestroy
37109>>>                ON_EVENT 7 Fire OnxfindDeactivate
37112>>>                ON_EVENT 11 Fire PrexfindKeyPress
37115>>>                ON_EVENT 16 Fire OnxfindPaint
37118>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37121>>>                ON_EVENT 8 Fire OnxfindFoundFile
37124>>>        End_Procedure
37125>>>End_Class
37126>>>
37126>>>// xfind Control
37126>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
37126>>>// ProgId: xfind10.xfind
37126>>>// Number of impl.Types:2
37126>>>// Referenced class Ixfind
37126>>>// Referenced class IxfindEvents
37126>>>Class dbOLExfind is a dbOCX_Client
37127>>>        Import_Class_Protocol OLEIxfind
37128>>>        Import_Class_Protocol OLEIxfindEvents
37129>>>
37129>>>        Procedure Construct_Object
37130>>>                Forward Send Construct_Object
37132>>>                Send DefineDbOCX_Client
37133>>>                Set progIdStr to "xfind10.xfind"
37134>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
37137>>>        End_Procedure
37138>>>
37138>>>        Procedure PrexfindKeyPress Integer lParam
37139>>>                Local Integer lKey
37140>>>                Get GetEventShortParam lParam 0 to lKey
37141>>>                Send OnxfindKeyPress lKey
37142>>>        End_Procedure
37143>>>
37143>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37144>>>                ON_EVENT 1 Fire OnxfindActivate
37147>>>                ON_EVENT 2 Fire OnxfindClick
37150>>>                ON_EVENT 3 Fire OnxfindCreate
37153>>>                ON_EVENT 5 Fire OnxfindDblClick
37156>>>                ON_EVENT 6 Fire OnxfindDestroy
37159>>>                ON_EVENT 7 Fire OnxfindDeactivate
37162>>>                ON_EVENT 11 Fire PrexfindKeyPress
37165>>>                ON_EVENT 16 Fire OnxfindPaint
37168>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
37171>>>                ON_EVENT 8 Fire OnxfindFoundFile
37174>>>        End_Procedure
37175>>>End_Class
37176>Use EZFTP    // Ftp Package
INCLUDING FILE: EZFTP.PKG
37176>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\EZFTP.OCX
37176>>>// Generated by FlexOLE Class Generator Thursday, December 28, 2000 13:30:32
37176>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
37176>>>
37176>>>// Dispatch interface for EZFTP Control
37176>>>// CLSID:{6580F765-7819-11CF-B86C-444553540000}
37176>>>// ProgId:
37176>>>Class OLE_DEZFTP is a Message
37177>>>
37177>>>        Function EZFTPRemoteAddress Returns String
37178>>>                Local String lpropVal
37179>>>                Get GetStringProperty 1 to lpropVal
37180>>>                Function_Return lpropVal
37181>>>        End_Function
37182>>>
37182>>>        Procedure SET EZFTPRemoteAddress String lpropVal
37183>>>                Send SetStringProperty 1 lpropVal
37184>>>        End_Procedure
37185>>>
37185>>>        Function EZFTPLocalFile Returns String
37186>>>                Local String lpropVal
37187>>>                Get GetStringProperty 2 to lpropVal
37188>>>                Function_Return lpropVal
37189>>>        End_Function
37190>>>
37190>>>        Procedure SET EZFTPLocalFile String lpropVal
37191>>>                Send SetStringProperty 2 lpropVal
37192>>>        End_Procedure
37193>>>
37193>>>        Function EZFTPRemoteFile Returns String
37194>>>                Local String lpropVal
37195>>>                Get GetStringProperty 3 to lpropVal
37196>>>                Function_Return lpropVal
37197>>>        End_Function
37198>>>
37198>>>        Procedure SET EZFTPRemoteFile String lpropVal
37199>>>                Send SetStringProperty 3 lpropVal
37200>>>        End_Procedure
37201>>>
37201>>>        Function EZFTPUserName Returns String
37202>>>                Local String lpropVal
37203>>>                Get GetStringProperty 4 to lpropVal
37204>>>                Function_Return lpropVal
37205>>>        End_Function
37206>>>
37206>>>        Procedure SET EZFTPUserName String lpropVal
37207>>>                Send SetStringProperty 4 lpropVal
37208>>>        End_Procedure
37209>>>
37209>>>        Function EZFTPPassword Returns String
37210>>>                Local String lpropVal
37211>>>                Get GetStringProperty 5 to lpropVal
37212>>>                Function_Return lpropVal
37213>>>        End_Function
37214>>>
37214>>>        Procedure SET EZFTPPassword String lpropVal
37215>>>                Send SetStringProperty 5 lpropVal
37216>>>        End_Procedure
37217>>>
37217>>>        Function EZFTPBinary Returns Bool
37218>>>                Local Bool lpropVal
37219>>>                Get GetBoolProperty 6 to lpropVal
37220>>>                Function_Return lpropVal
37221>>>        End_Function
37222>>>
37222>>>        Procedure SET EZFTPBinary Bool lpropVal
37223>>>                Send SetBoolProperty 6 lpropVal
37224>>>        End_Procedure
37225>>>
37225>>>        Function EZFTPRemoteDirectory Returns String
37226>>>                Local String lpropVal
37227>>>                Get GetStringProperty 9 to lpropVal
37228>>>                Function_Return lpropVal
37229>>>        End_Function
37230>>>
37230>>>        Procedure SET EZFTPRemoteDirectory String lpropVal
37231>>>                Send SetStringProperty 9 lpropVal
37232>>>        End_Procedure
37233>>>
37233>>>        Function EZFTPProfessionalEdition Returns Bool
37234>>>                Local Bool lpropVal
37235>>>                Get GetBoolProperty 10 to lpropVal
37236>>>                Function_Return lpropVal
37237>>>        End_Function
37238>>>
37238>>>        Procedure SET EZFTPProfessionalEdition Bool lpropVal
37239>>>                Send SetBoolProperty 10 lpropVal
37240>>>        End_Procedure
37241>>>
37241>>>        Function EZFTPUseCache Returns Bool
37242>>>                Local Bool lpropVal
37243>>>                Get GetBoolProperty 7 to lpropVal
37244>>>                Function_Return lpropVal
37245>>>        End_Function
37246>>>
37246>>>        Procedure SET EZFTPUseCache Bool lpropVal
37247>>>                Send SetBoolProperty 7 lpropVal
37248>>>        End_Procedure
37249>>>
37249>>>        Function EZFTPCancelTransfer Returns Bool
37250>>>                Local Bool lpropVal
37251>>>                Get GetBoolProperty 8 to lpropVal
37252>>>                Function_Return lpropVal
37253>>>        End_Function
37254>>>
37254>>>        Procedure SET EZFTPCancelTransfer Bool lpropVal
37255>>>                Send SetBoolProperty 8 lpropVal
37256>>>        End_Procedure
37257>>>
37257>>>        Procedure EZFTPConnect
37258>>>                Send InvokeVoidFunction 11
37259>>>        End_Procedure
37260>>>
37260>>>        Procedure EZFTPDisconnect
37261>>>                Send InvokeVoidFunction 12
37262>>>        End_Procedure
37263>>>
37263>>>        Procedure EZFTPGetFile
37264>>>                Send InvokeVoidFunction 13
37265>>>        End_Procedure
37266>>>
37266>>>        Procedure EZFTPPutFile
37267>>>                Send InvokeVoidFunction 14
37268>>>        End_Procedure
37269>>>
37269>>>        Procedure EZFTPDeleteFile String lFileName
37270>>>                Send DeclareParams 1
37271>>>                Send DefineStringParam lFileName
37272>>>                Send InvokeVoidFunction 15
37273>>>        End_Procedure
37274>>>
37274>>>        Procedure EZFTPRenameFile String lOldName String lNewName
37275>>>                Send DeclareParams 2
37276>>>                Send DefineStringParam lOldName
37277>>>                Send DefineStringParam lNewName
37278>>>                Send InvokeVoidFunction 16
37279>>>        End_Procedure
37280>>>
37280>>>        Procedure EZFTPMkDir String lDirectoryName
37281>>>                Send DeclareParams 1
37282>>>                Send DefineStringParam lDirectoryName
37283>>>                Send InvokeVoidFunction 17
37284>>>        End_Procedure
37285>>>
37285>>>        Procedure EZFTPRmDir String lDirectoryName
37286>>>                Send DeclareParams 1
37287>>>                Send DefineStringParam lDirectoryName
37288>>>                Send InvokeVoidFunction 18
37289>>>        End_Procedure
37290>>>
37290>>>        Procedure EZFTPGetDirectory String lFileName
37291>>>                Send DeclareParams 1
37292>>>                Send DefineStringParam lFileName
37293>>>                Send InvokeVoidFunction 19
37294>>>        End_Procedure
37295>>>
37295>>>        Procedure EZFTPAboutBox
37296>>>                Send InvokeVoidFunction -552
37297>>>        End_Procedure
37298>>>
37298>>>End_Class
37299>>>
37299>>>// Event interface for EZFTP Control
37299>>>// CLSID:{6580F766-7819-11CF-B86C-444553540000}
37299>>>// ProgId:
37299>>>Class OLE_DEZFTPEvents is a Message
37300>>>
37300>>>        Procedure OnEZFTPNextDirectoryEntry String lFileName DWORD lAttributes OLEReal lLength
37301>>>        End_Procedure
37302>>>
37302>>>        Procedure OnEZFTPTransferProgress DWORD lBytesTransferred DWORD lTotalBytes
37303>>>        End_Procedure
37304>>>
37304>>>End_Class
37305>>>
37305>>>// EZFTP Control
37305>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37305>>>// ProgId: EZFTP.EZFTPCtrl.1
37305>>>// Number of impl.Types:2
37305>>>// Referenced class _DEZFTP
37305>>>// Referenced class _DEZFTPEvents
37305>>>
37305>>>Class OLEEZFTP is a OCX_Client
37306>>>        Import_Class_Protocol OLE_DEZFTP
37307>>>        Import_Class_Protocol OLE_DEZFTPEvents
37308>>>
37308>>>        Procedure Construct_Object
37309>>>                Forward Send Construct_Object
37311>>>                Send DefineOCX_Client
37312>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37313>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37316>>>        End_Procedure
37317>>>
37317>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37318>>>                Local String lFileName
37319>>>                Local DWORD lAttributes
37319>>>                Local OLEReal lLength
37319>>>                Get GetEventStringParam lParam 0 to lFileName
37320>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37321>>>                Get GetEventRealParam lParam 2 to lLength
37322>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37323>>>        End_Procedure
37324>>>
37324>>>        Procedure PreEZFTPTransferProgress Integer lParam
37325>>>                Local DWORD lBytesTransferred
37326>>>                Local DWORD lTotalBytes
37326>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37327>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37328>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37329>>>        End_Procedure
37330>>>
37330>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37331>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37334>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37337>>>        End_Procedure
37338>>>End_Class
37339>>>
37339>>>// EZFTP Control
37339>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37339>>>// ProgId: EZFTP.EZFTPCtrl.1
37339>>>// Number of impl.Types:2
37339>>>// Referenced class _DEZFTP
37339>>>// Referenced class _DEZFTPEvents
37339>>>Class dbOLEEZFTP is a dbOCX_Client
37340>>>        Import_Class_Protocol OLE_DEZFTP
37341>>>        Import_Class_Protocol OLE_DEZFTPEvents
37342>>>
37342>>>        Procedure Construct_Object
37343>>>                Forward Send Construct_Object
37345>>>                Send DefineDbOCX_Client
37346>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37347>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37350>>>        End_Procedure
37351>>>
37351>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37352>>>                Local String lFileName
37353>>>                Local DWORD lAttributes
37353>>>                Local OLEReal lLength
37353>>>                Get GetEventStringParam lParam 0 to lFileName
37354>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37355>>>                Get GetEventRealParam lParam 2 to lLength
37356>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37357>>>        End_Procedure
37358>>>
37358>>>        Procedure PreEZFTPTransferProgress Integer lParam
37359>>>                Local DWORD lBytesTransferred
37360>>>                Local DWORD lTotalBytes
37360>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37361>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37362>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37363>>>        End_Procedure
37364>>>
37364>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37365>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37368>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37371>>>        End_Procedure
37372>>>End_Class
37373>Use dvFTP    // Ftp Package
INCLUDING FILE: DVFTP.PKG
37373>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37373>>>//             for Visual Dataflex
37373>>>//
37373>>>// Created by: Marcel J. Zwiebel
37373>>>//             Dataview - The Netherlands
37373>>>// E-mail    : marcel@dataview-sc.com
37373>>>// CIS id    : 100273,2473
37373>>>// Web URL   : http://www.dataview-sc.com
37373>>>//
37373>>>// Date      : 28/07/1997 
37373>>>
37373>>>Use Windows.pkg
37373>>>Use DLL.pkg
37373>>>
37373>>>// register external functions of the dvftp.dll
37373>>>
37373>>>
37373>>>// function   : dvInternetAttemptConnect
37373>>>//
37373>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37373>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37373>>>//              ISP, the standard dialup dialog box will be evoked.
37373>>>//                   
37373>>>// parameters : none
37373>>>//
37373>>>// returns    : integer - Is 0 (ok) or error-number.
37373>>>//
37373>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37374>>>
37374>>>
37374>>>// function   : dvInternetOpen
37374>>>//
37374>>>// description: Initializes the application's use of the WIN32 Internet functions.
37374>>>//
37374>>>// parameters : none
37374>>>//
37374>>>// returns    : integer - Is 0 (ok) or error-number.
37374>>>//
37374>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37375>>>
37375>>>
37375>>>// function   : dvInternetConnect
37375>>>//
37375>>>// description: Opens an FTP-session with a server.
37375>>>//
37375>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37375>>>//                                  an ip-number (for example: 145.58.31.4).
37375>>>//              string UserName   - Login-name for the server, can be empty for 
37375>>>//                                  "anonymous" login (default for most FTP servers).
37375>>>//              string Password   - Password for the server, can be empty for 
37375>>>//                                  "anonymous" login (default for most FTP servers).
37375>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37375>>>//                                  server, otherwise 0.
37375>>>//
37375>>>// returns    : integer - Is 0 (ok) or error-number.
37375>>>//
37375>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37376>>>
37376>>>
37376>>>// function   : dvFtpSetCurrentDirectory
37376>>>//
37376>>>// description: Changes to a different working directory on the FTP server.
37376>>>//
37376>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37376>>>//                                 This can be either a fully qualified path or a name 
37376>>>//                                 relative to the current directory. 
37376>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37376>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37376>>>//                                 translates the directory name separators to the appropriate 
37376>>>//                                 character before they are used. 
37376>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37376>>>//                                 current working directory (not all remote systems use a
37376>>>//                                 hierarchical naming scheme for directories).
37376>>>//
37376>>>// returns    : integer - Is 0 (ok) or error-number.
37376>>>//
37376>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37377>>>
37377>>>
37377>>>// function   : dvFtpGetCurrentDirectory
37377>>>//
37377>>>// description: Retrieves the current directory for the specified FTP session.
37377>>>//
37377>>>// parameters : none
37377>>>//
37377>>>// returns    : string - Name of the current directory.
37377>>>//
37377>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37378>>>
37378>>>
37378>>>// function   : dvFtpCreateDirectory
37378>>>//
37378>>>// description: Creates a new directory on the FTP server. 
37378>>>//
37378>>>// parameters : string Directory - The name of the directory to create on the remote system.
37378>>>//                                 This can be either a fully qualified path or a name 
37378>>>//                                 relative to the current directory. 
37378>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37378>>>//                                 directory separator for either name. dvFtpCreateDirectory
37378>>>//                                 translates the directory name separators to the appropriate 
37378>>>//                                 character before they are used. 
37378>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37378>>>//                                 current working directory (not all remote systems use a
37378>>>//                                 hierarchical naming scheme for directories).
37378>>>//
37378>>>// returns    : integer - Is 0 (ok) or error-number.
37378>>>//
37378>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37379>>>
37379>>>
37379>>>// function   : dvFtpRemoveDirectory
37379>>>//
37379>>>// description: Removes the specified directory on the FTP server. 
37379>>>//
37379>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37379>>>//                                 This can be either a fully qualified path or a name 
37379>>>//                                 relative to the current directory. 
37379>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37379>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37379>>>//                                 translates the directory name separators to the appropriate 
37379>>>//                                 character before they are used. 
37379>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37379>>>//                                 current working directory (not all remote systems use a
37379>>>//                                 hierarchical naming scheme for directories).
37379>>>//
37379>>>// returns    : integer - Is 0 (ok) or error-number.
37379>>>//
37379>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37380>>>
37380>>>
37380>>>// function   : dvFtpFindFirstFile
37380>>>//
37380>>>// description: Searches the specified directory of the given FTP session.
37380>>>//
37380>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37380>>>//                                  the FTP server's file system. If the string is empty the 
37380>>>//                                  first file in the current directory on the server will be 
37380>>>//                                  searched for. 
37380>>>//              integer UseCache  - Indicates using the local computer's cache.
37380>>>//                                  If the value is 0 then the the cache will be used. 
37380>>>//                                  If the value is 1 then a download of the requested file, 
37380>>>//                                  object, or directory listing from the origin server will be 
37380>>>//                                  forced, not from the cache.
37380>>>//
37380>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37380>>>//                       searched directory is empty the string "directory is empty" is returned.
37380>>>//
37380>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37381>>>
37381>>>
37381>>>// function   : dvFtpFindNextFile
37381>>>//
37381>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37381>>>//
37381>>>// parameters : none
37381>>>//
37381>>>// returns    : string - Name of the next file found or empty when no more files are found.
37381>>>//
37381>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37382>>>
37382>>>
37382>>>// function   : dvFtpDeleteFile
37382>>>//
37382>>>// description: Deletes a file stored on the FTP server. 
37382>>>//
37382>>>// parameters : string FileSelect - Name of the file to be deleted.
37382>>>//                                  Can be file names relative to the current directory. 
37382>>>//                                  A backslash (\) or forward slash (/) can be used as 
37382>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37382>>>//                                  directory name separators to the appropriate character 
37382>>>//                                  before they are used. 
37382>>>//
37382>>>// returns    : integer - Is 0 (ok) or error-number.
37382>>>//
37382>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37383>>>
37383>>>
37383>>>// function   : dvFtpRenameFile
37383>>>//
37383>>>// description: Renames a file stored on the FTP server. 
37383>>>//
37383>>>// parameters : string Existing - The name of the file that will have its name changed on the
37383>>>//                                remote FTP server. 
37383>>>//              string New      - The new name for the remote file. 
37383>>>//
37383>>>//                                Both names can be relative to the current directory. A backslash 
37383>>>//                                (\) or forward slash (/) can be used as the directory separator 
37383>>>//                                for either name. dvFtpRenameFile translates the directory name 
37383>>>//                                separators to the appropriate character before they are used. 
37383>>>//
37383>>>// returns    : integer - Is 0 (ok) or error-number.
37383>>>//
37383>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37384>>>
37384>>>
37384>>>// function   : dvFtpGetFile
37384>>>//
37384>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37384>>>//              creating a new local file in the process. 
37384>>>//
37384>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37384>>>//              string  NewFile      - The name of the file to create on the local system. 
37384>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37384>>>//                                     proceed if a local file of the specified name already exists. 
37384>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37384>>>//              integer FileType     - Indicates the transfer method.
37384>>>//                                     If the value is 0 then the function transfers the file using 
37384>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37384>>>//                                     information is converted to local equivalents. 
37384>>>//                                     If the value is 1 then the function transfers the file using 
37384>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37384>>>//                                     exactly as it exists with no changes. 
37384>>>//
37384>>>// returns    : integer - Is 0 (ok) or error-number.
37384>>>//
37384>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37385>>>
37385>>>
37385>>>// function   : dvFtpPutFile
37385>>>//
37385>>>// description: Stores a file on the FTP server. 
37385>>>//
37385>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37385>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37385>>>//              integer FileType      - Indicates the transfer method.
37385>>>//                                      If the value is 0 then the function transfers the 
37385>>>//                                      file as ASCII. 
37385>>>//                                      If the value is 1 then the function transfres the
37385>>>//                                      file as binary. 
37385>>>//
37385>>>// returns    : integer - Is 0 (ok) or error-number.
37385>>>//
37385>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37386>>>
37386>>>
37386>>>
37386>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37386>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37386>>>// some of the common information about files, such as file creation date and time, is not 
37386>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37386>>>// fill in unavailable information with a best guess based on available information. For example,
37386>>>// creation and last access dates will often be the same as the file's modification date.
37386>>>
37386>>>
37386>>>// function   : dvFtpFilename
37386>>>//
37386>>>// description: The name of the file. 
37386>>>//
37386>>>// parameters : none
37386>>>//
37386>>>// returns    : string - Name of the file
37386>>>//
37386>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37387>>>
37387>>>
37387>>>// function   : dvFtpAlternateFilename
37387>>>//
37387>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37387>>>//              filename format.
37387>>>//
37387>>>// parameters : none
37387>>>//
37387>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37387>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37387>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37387>>>//                       this function returns an empty string.
37387>>>//
37387>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37388>>>
37388>>>
37388>>>// function   : dvFtpFileCreated
37388>>>//              
37388>>>// description: The date/time the file was created in 24-hour format.
37388>>>//
37388>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37388>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37388>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37388>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37388>>>//
37388>>>// returns    : string - The file creation-date/time
37388>>>//
37388>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37389>>>
37389>>>
37389>>>// function   : dvFtpFileAccessed
37389>>>//              
37389>>>// description: The last date/time the file was accessed in 24-hour format.
37389>>>//
37389>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37389>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37389>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37389>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37389>>>//
37389>>>// returns    : string - The last file access-date/time
37389>>>//
37389>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37390>>>
37390>>>
37390>>>// function   : dvFtpFileWritten
37390>>>//              
37390>>>// description: The last date/time the file was written to in 24-hour format.
37390>>>//
37390>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37390>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37390>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37390>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37390>>>//
37390>>>// returns    : string - The last file written to-date/time
37390>>>//
37390>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37391>>>
37391>>>
37391>>>// function   : dvFtpFileSize
37391>>>//              
37391>>>// description: The size of the file in bytes.
37391>>>//
37391>>>// parameters : none
37391>>>//
37391>>>// returns    : integer - Filesize in bytes.
37391>>>//
37391>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37392>>>
37392>>>
37392>>>// function   : dvFtpIsDirectory
37392>>>//              
37392>>>// description: The file is an directory.
37392>>>//
37392>>>// parameters : none
37392>>>//
37392>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37392>>>//
37392>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37393>>>
37393>>>
37393>>>// function   : dvGetServerMsg
37393>>>//              
37393>>>// description: Gets the returned message from the FTP server (error-number will
37393>>>//              be 12003 "extended error").
37393>>>//
37393>>>// parameters : none
37393>>>//
37393>>>// returns    : string - Return message from the FTP server.
37393>>>//
37393>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37394>>>
37394>>>
37394>>>// error-numbers returned
37394>>>//
37394>>>// 12001  "out of handles"            
37394>>>// 12002  "timeout"
37394>>>// 12003  "extended error"
37394>>>// 12004  "internal error"            
37394>>>// 12005  "invalid url"               
37394>>>// 12006  "unrecognized scheme"       
37394>>>// 12007  "name not resolved"         
37394>>>// 12008  "protocol not found"        
37394>>>// 12009  "invalid option"            
37394>>>// 12010  "bad option length"         
37394>>>// 12011  "option not settable"      
37394>>>// 12012  "shutdown"                  
37394>>>// 12013  "incorrect user name"       
37394>>>// 12014  "incorrect password"
37394>>>// 12015  "login failure"             
37394>>>// 12016  "invalid operation"         
37394>>>// 12017  "operation cancelled"       
37394>>>// 12018  "incorrect handle type"     
37394>>>// 12019  "incorrect handle state"
37394>>>// 12020  "not proxy request"         
37394>>>// 12021  "registry value not found"
37394>>>// 12022  "bad registry parameter"    
37394>>>// 12023  "no direct access"          
37394>>>// 12024  "no context"                
37394>>>// 12025  "no callback"               
37394>>>// 12026  "request pending"           
37394>>>// 12027  "incorrect format"          
37394>>>// 12028  "item not found"            
37394>>>// 12029  "cannot connect"            
37394>>>// 12030  "connection aborted"        
37394>>>// 12031  "connection reset"          
37394>>>// 12032  "force retry"               
37394>>>// 12033  "invalid proxy request"     
37394>>>// 12034  "need ui"                   
37394>>>// 12036  "handle exists"             
37394>>>// 12037  "sec cert date invalid"     
37394>>>// 12038  "sec cert cn invalid"       
37394>>>// 12039  "http to https on redir"    
37394>>>// 12040  "https to http on_redir"    
37394>>>// 12041  "mixed security"            
37394>>>// 12042  "chg post is non secure"    
37394>>>// 12043  "post is non_secure"        
37394>>>// 12044  "client auth cert needed"   
37394>>>// 12045  "invalid ca"                
37394>>>// 12046  "client auth not setup"     
37394>>>// 12047  "async thread failed"       
37394>>>// 12048  "redirect scheme change"    
37394>>>// 12049  "dialog pending"            
37394>>>// 12050  "retry dialog"              
37394>>>// 12110  "ftp transfer in progress"  
37394>>>// 12111  "ftp dropped"               
37394>>>// 12112  "ftp no passive mode"       
37394>>>// 12157  "security channel error"    
37394>>>// 12158  "unable to cache file"      
37394>>>// 12159  "tcpip not installed"       
37394>>>// 12163  "disconnected"              
37394>>>// 12164  "server unreachable"        
37394>>>// 12165  "proxy server unreachable"  
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>>>
37394>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37394>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37394>>>//
37394>>>// Created by: Marcel J. Zwiebel
37394>>>//             Dataview - The Netherlands
37394>>>// E-mail    : marcel@dataview-sc.com
37394>>>// Web URL   : http://www.dataview-sc.com
37394>>>//
37394>>>// Date      : 03/24/1999
37394>>>
37394>>>Use Windows.pkg
37394>>>Use DLL.pkg 
37394>>>
37394>>>
37394>>>// register external functions of the dvdailer.dll
37394>>>
37394>>>
37394>>>// function   : dvInternetGetConnectedState
37394>>>//
37394>>>// description: Retrieves the connected state of the local system.
37394>>>//                   
37394>>>// parameters : none
37394>>>//
37394>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37394>>>//                              2 = the local system uses a local area network to connect to the Internet.
37394>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37394>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37394>>>//                              0 = there is no Internet connection.
37394>>>//
37394>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37395>>>
37395>>>
37395>>>// function   : dvInternetAutodial
37395>>>//
37395>>>// description: Automatically causes the modem to dial the default Internet connection.
37395>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37395>>>//                   
37395>>>// parameters : none
37395>>>//
37395>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37395>>>//
37395>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37396>>>
37396>>>
37396>>>// function   : dvInternetAutodialHangup
37396>>>//
37396>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37396>>>//                   
37396>>>// parameters : none
37396>>>//
37396>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37396>>>//
37396>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37397>>>
37397>>>
37397>>>// function   : dvInternetDial
37397>>>//
37397>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37397>>>//              Use the function dvInternetHangup to hangup this connection.
37397>>>//                   
37397>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37397>>>//
37397>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37397>>>//
37397>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37398>>>
37398>>>
37398>>>// function   : dvInternetHangup
37398>>>//
37398>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37398>>>//              
37398>>>// parameters : none
37398>>>//
37398>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37398>>>//
37398>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>>>
37399>//------------------------------
37399>
37399>
37399>//AB-StoreTopEnd
37399>
37399>
37399>Object Main is a Panelsub
37401>    Set Label To "EnhmErga"
37402>
37402>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
37405>>//************************************************************************
37405>>//
37405>>//* Copyright (c) 1997 Data Access Corporation, Miami Florida,
37405>>//* All rights reserved.
37405>>//* DataFlex is a registered trademark of Data Access Corporation.
37405>>//*
37405>>//*
37405>>//*  Module Name:
37405>>//*      FILE_PM.INC
37405>>//*
37405>>//*  Creator:
37405>>//*        LS, MAZ, JJT(changed for windaf)
37405>>//*
37405>>//*  Date:
37405>>//*      November 31, 1992
37405>>//*      10/28/94 03:17 pm - JJT windaf chagges
37405>>//*
37405>>//*  Purpose:
37405>>//*         package for creating generic record_pull_down object for entry
37405>>//*             object actions(assumed to be used as first pull down menu,
37405>>//*             hence EXIT option as last item)
37405>>//*
37405>>//*************************************************************************
37405>>// JJT - Modified to shadow items if not a DEO OR if no server
37405>>//*************************************************************************
37405>>
37405>>
37405>>Object oMyWinPrint is an DF_PRINTER
37407>>
37407>>    Procedure DFPrint
37409>>        Local Integer iRetVal
37410>>
37410>>        Get DFGetPrintDialogFlags To iRetVal
37411>>
37411>>        If iRetVal Begin
37413>>            Send DFPrintDoc
37414>>            Send DFClearDoc
37415>>        End
37415>>>
37415>>    End_Procedure
37416>>    Move Current_Object to WinPrintId
37417>>End_Object
37418>>
37418>>Register_Procedure Set piPropertiesObjectId
37418>>Register_Function piPropertiesObjectId Returns Integer
37418>>
37418>>Register_Function Close_All_Views Integer bWith_Confirmation Returns Integer
37418>>
37418>>DFCreate_Menu "&„šš¨˜­âª" File_Menu is a DEOPopupMenu
37422>>    On_Item "&€¡ç¨à©ž/Add\aF5" send Request_Clear
37423>>        Set Status_Help To '‰˜Ÿ˜¨åœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37424>>
37424>>    On_Item "&Super €¡ç¨à©ž\aCtrl+F5" send Request_Clear_All
37425>>        Set Status_Help To '‰˜Ÿ˜¨åœ  æ¢˜ «˜ ›œ›¦£â¤˜ ˜§æ «ž¤ æ¯ž'
37426>>
37426>>    On_Item "&ƒ ˜š¨˜­ã\aShift+F2" send Request_Delete
37427>>        Set Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37428>>
37428>>    On_Item "&€¤˜ã«ž©ž\aF9" send Find_GE
37429>>        Set Status_Help To '¨å©¡œ  £ á œšš¨˜­ã'
37430>>
37430>>    On_Item "&„§æ£œ¤¦\aF8" send Find_Next
37431>>        Set Status_Help To '¨å©¡œ  «ž¤ œ§æ£œ¤ž œšš¨˜­ã'
37432>>
37432>>    On_Item "&¨¦žš¦ç£œ¤¦\aF7" send Find_Previous
37433>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨¦žš¦ç£œ¤ž œšš¨˜­ã'
37434>>
37434>>    //On_Item "Super ˜¤˜ã«ž©ž\aShift+F9" send Superfind
37434>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž £ áª œšš¨˜­ãª'
37434>>
37434>>    //On_Item "Super œ§æ£œ¤¦\aShift+F8" send Superfind_Next
37434>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž œ§æ£œ¤žª œšš¨˜­ãª'
37434>>
37434>>    //On_Item "Super §¨¦žš¦ç£œ¤¦\aShift+F7" send Superfind_Previous
37434>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž §¨¦žš¦ç£œ¤žª œšš¨˜­ãª'
37434>>
37434>>    On_Item "&¨é«¦\aCtrl+Home" send Beginning_Of_Data
37435>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨é«ž œšš¨˜­ã'
37436>>
37436>>    On_Item "’œ&¢œ¬«˜å¦\aCtrl+End" send End_Of_Data
37437>>        Set Status_Help To '¨å©¡œ  «ž¤ «œ¢œ¬«˜¢å˜ œšš¨˜­ã'
37438>>
37438>>    On_Item "&„šš¨˜­ž\aF2" send Request_Save
37439>>        Set Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37440>>
37440>>    On_Item "" send NONE
37441>>
37441>>    //on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  Send Activate_oPrnSetup to (client_area(current_object))
37441>>    on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  send DFPrintSetup       to (oWinPrint(Self))
37442>>    Set Status_Help To "çŸ£ ©ž œ¡«ç§à©žª"
37443>>    on_item   "„¡«ç§à©ž           "  send DFPrint            to (oMyWinPrint(Self))
37444>>    Set Status_Help To "„¡«ç§à©ž œšš¨á­¦¬"
37445>>
37445>>    On_Item "" send NONE
37446>>
37446>>    On_Item "&ˆ› ¦«ž«œª\aAlt+I" send DoShowProperties to Self
37447>>    Set Status_Help To '‰˜Ÿ¦¨ ©£æª ˆ› ¦«ã«à¤ «žª œ­˜¨£¦šãª'
37448>>
37448>>    On_Item "" send NONE
37449>>
37449>>    On_Item "„&¥¦›¦ª\aAlt+F4" send Exit_Application to desktop
37450>>        Set Status_Help To 'š˜å¤œ  ˜§¦ «ž¤ œ­˜¨£¦šã'
37451>>
37451>>    Procedure DoShowProperties
37453>>        If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37456>>    End_Procedure
37457>>
37457>>    On_Key Key_Alt+Key_I Send DoShowProperties
37458>>
37458>>    //  When ever the menu [pulldown] is initialized, check/set
37458>>    //  the state of its items.
37458>>    //
37458>>    Procedure OnInitMenu
37460>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
37461>>        Local integer IsDeoControl lId liClId
37461>>        Get Focus to Obj#
37462>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37463>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
37466>>        If (isDeo AND Srvr) Begin
37468>>            // returns T if object in question is a DEO control object (i.e.
37468>>            // understands the data_file, data_field messages).
37468>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37469>>            Get Should_Save of Obj# to changed  // changed file?
37470>>            If IsDEOControl Begin
37472>>                Get data_file of Obj# to file#
37473>>                Get data_field of Obj# to field#
37474>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
37475>>            End
37475>>>
37475>>            Else ;                Move 1 to NoIndex
37477>>            Set Shadow_state item 0  to False
37478>>            Set Shadow_state item 1  to False
37479>>            Set Shadow_state item 2  to (Current_record(Srvr)=0)
37480>>            Set Shadow_state item 3  to NoIndex
37481>>            Set Shadow_state item 4  to NoIndex
37482>>            Set Shadow_state item 5  to NoIndex
37483>>            Set Shadow_state item 6  to NoIndex
37484>>            Set Shadow_state item 7  to NoIndex
37485>>            Set Shadow_state item 8  to (Should_Save(Srvr)=0)
37486>>         //   Set Shadow_state item 9  to NoIndex
37486>>         //   Set Shadow_state item 10  to NoIndex
37486>>         //   Set Shadow_state item 11 to NoIndex
37486>>         //   Set Shadow_state item 12 to (Should_Save(Srvr)=0)
37486>>        End
37486>>>
37486>>        Else Begin
37487>>            for itm from 0 to 8 //11
37493>>>
37493>>                set shadow_State item itm to TRUE
37494>>            Loop
37495>>>
37495>>        End
37495>>>
37495>>        Set Shadow_State Item 13 to (piPropertiesObjectId(Self)=0)
37496>>    End_Procedure
37497>>
37497>>    Register_Procedure Activate_oPrnSetup
37497>>
37497>>End_Pull_Down
37499>>Set Status_Help to "€¤˜ã«ž©ž, „šš¨˜­ã, ƒ ˜š¨˜­ã, €¡ç¨à©ž ›œ›¦£â¤à¤ ã â¥¦›¦ª ˜§¦ «ž¤ œ­˜¨£¦šã"
37500>
37500>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
37504>            On_Item "&EnCMVCN\aCtrl+1" Send Activate_EnCMVCN
37505>        End_Pull_down
37507>        Set Status_Help To "Available Views"
37508>        
INCLUDING FILE: NAVI_PM.INC
37508>>Use DFDEOMnu
37508>>
37508>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
37512>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
37513>>        Set Status_Help To  'Move to Next Area'
37514>>
37514>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
37515>>        Set Status_Help To  'Move to Previous Area'
37516>>
37516>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
37517>>        Set Status_Help To  'Move to Next View'
37518>>
37518>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
37519>>        Set Status_Help To  'Move to Previous View'
37520>>
37520>>    On_Item ""                          send none
37521>>
37521>>    On_Item "&List\aF4"               send Prompt
37522>>        Set Status_Help To  'Show Selection Lists'
37523>>
37523>>    On_Item "&Zoom\aAlt+F9"             send Zoom
37524>>        Set Status_Help To  'Show Zoom'
37525>>
37525>>    Procedure OnInitMenu
37527>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
37528>>        Get Focus to Obj#
37529>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37530>>        If IsDeo Begin
37532>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37533>>            If IsDeoControl Begin
37535>>                Get Prompt_Object of Obj# to Prmpt
37536>>                Get Zoom_Object of Obj# to zm
37537>>            End
37537>>>
37537>>            Set Shadow_state item 0  to False
37538>>            Set Shadow_state item 1  to False
37539>>            Set Shadow_state item 2  to False
37540>>            Set Shadow_state item 3  to False
37541>>            Set Shadow_state item 5  to (Prmpt=0)
37542>>            Set Shadow_state item 6  to (Zm=0)
37543>>        End
37543>>>
37543>>        Else Begin
37544>>            for itm from 0 to 6
37550>>>
37550>>                set shadow_State item itm to TRUE
37551>>            Loop
37552>>>
37552>>        End
37552>>>
37552>>    End_Procedure
37553>>
37553>>End_Pull_Down
37555>>Set Status_Help to "Navigation in different areas of the screen"
37556>>
INCLUDING FILE: WIN_PM.INC
37556>>DFCreate_Menu "&Window" Window_Menu
37560>>    Set select_mode to Multi_Select
37561>>    // normal number of items in pulldown (w/ no active views)
37561>>    property integer std_item_count public 0
37563>>
37563>>    DFCreate_Menu "&Preferences" Display_Options_Menu
37567>>        Set select_mode to Multi_Select
37568>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
37569>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
37570>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
37571>>
37571>>        //  When ever the menu [pulldown] is initialized, check/set
37571>>        //  the state of its items.
37571>>        //
37571>>        Procedure OnInitMenu
37573>>            local integer bState
37574>>
37574>>            Get ToolBar_State to bState
37575>>            Set Select_State Item 0 to bState
37576>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
37579>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
37581>>
37581>>            Get Statusbar_State to bState
37582>>            Set Select_State Item 1 to bState
37583>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
37586>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
37588>>
37588>>            Get Auto_Arrange_Icons_State to bState
37589>>            Set Select_State Item 2 to bState
37590>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
37593>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
37595>>
37595>>        End_procedure
37596>>
37596>>
37596>>    End_Pull_Down
37598>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
37599>>
37599>>    On_Item ""
37600>>
37600>>    On_Item "&Cascade" send Cascade_Windows                   To Self
37601>>        Set Status_Help                                       To ''
37602>>
37602>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
37603>>        Set Status_Help                                       To ''
37604>>
37604>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
37605>>        Set Status_Help                                       To ''
37606>>
37606>>    On_Item ""
37607>>
37607>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
37608>>        Set Status_Help                                       To ''
37609>>
37609>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
37610>>        Set Status_Help                                       To ''
37611>>
37611>>    On_Item ""
37612>>
37612>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
37613>>        Set Status_Help                                       To ''
37614>>
37614>>    // set this to the number of items in the menu with no views.
37614>>    Set Std_item_count to (item_count(current_object))
37615>>
37615>>    // add all active views to the end of the menu
37615>>    Procedure OnInitMenu
37617>>        local integer iStdCnt iNumCnt hVw hCl iCount
37618>>        Local string sLbl
37618>>        //*** Remove all old view items
37618>>        Get Item_count     to iNumCnt
37619>>        get Std_item_count to iStdCnt
37620>>        For iCount from 1  to (iNumCnt - iStdCnt)
37626>>>
37626>>            Send Delete_item iStdCnt
37627>>        Loop
37628>>>
37628>>
37628>>        Move iStdcnt to iNumCnt
37629>>        get Client_id to hCl // object id of client area
37630>>        If hCl Begin
37632>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
37633>>           While hVw
37637>>              if (Active_state(hVw)) Begin
37639>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
37641>>                    send add_item 0 ''
37642>>                    increment iNumCnt
37643>>                 end
37643>>>
37643>>                 Get Label of hVw to sLbl // caption bar (name) of view
37644>>                 // note that all views understand the message activate_view.
37644>>                 send add_item msg_activate_view sLbl // set message, value and destination
37645>>                 set aux_value item iNumcnt to hVw
37646>>                 // if this is the focus view, mark it.
37646>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
37649>>                 // create status help
37649>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
37650>>                 increment iNumCnt
37651>>              end
37651>>>
37651>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
37652>>           End
37653>>>
37653>>        End
37653>>>
37653>>    End_Procedure // OnInitMenu
37654>>
37654>>End_Pull_Down
37656>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
37657>>
37657>>
37657>>DFCreate_Menu "&Help" Help_Menu
37661>>    on_item "&Help Topic" send Help_on_topic
37662>>        Set Status_Help To "Search for help on a particular subject."
37663>>        on_item "" send NONE
37664>>    on_item "&Context Help"          send Extended_Help
37665>>        Set Status_Help To "Show Context sensitive help."
37666>>
37666>>    on_item "&Files Help"            send File_Help
37667>>        Set Status_Help To "Show Files help."
37668>>
37668>>    on_item "&Keys Help"             send Keys_Help
37669>>        Set Status_Help To "Show Keys help."
37670>>
37670>>    on_item "" send NONE
37671>>
37671>>    on_item "&How to Use Help"       send Help_For_Help
37672>>        Set Status_Help To "How to Use Help"
37673>>
37673>>    on_item "" send NONE
37674>>
37674>>    On_Item "&Tips of the Day" send Activate_TipOfDay
37675>>        Set Status_Help To "Tips of the Day"
37676>>
37676>>    on_item "" send NONE
37677>>
37677>>    On_item "About" Send Activate_About
37678>>        Set Status_Help To "System Information"
37679>>end_pull_down
37681>>Set Status_Help to "Access to the program's help subsystem"
37682>>
37682>>Register_Procedure Activate_TipOfDay
37682>>
37682>>
37682>    End_Menu
37684>
37684>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
37684>>>// 23/07/1998 SPY
37684>>>
37684>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
37684>>>>>//-------------------------------------------------------------------------
37684>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
37684>>>>>//
37684>>>>>//
37684>>>>>// 07/23/96 JJT - New Class names
37684>>>>>//-------------------------------------------------------------------------
37684>>>>>
37684>>>>>Use DfPanel // dfapp_buttonbar
37684>>>>>
37684>>>>>Class ToolBar is a AppToolBar
37685>>>>>
37685>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
37686>>>>>      Local integer rval MainObj#
37687>>>>>      Get Main_Panel_id to MainObj#
37688>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
37691>>>>>      Function_Return rVal
37692>>>>>    End_Function
37693>>>>>
37693>>>>>    Procedure Redirect_Button_Message integer Itm
37694>>>>>         Local integer Msg# Aux# rval Understood
37695>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
37698>>>>>         Get Message   item itm  to Msg#
37699>>>>>         Get Aux_Value item itm  to Aux#
37700>>>>>         If Msg# Begin
37702>>>>>           If Aux# eq 0 Begin
37704>>>>>              Get Focus to Aux#
37705>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
37706>>>>>              If Not Understood Move 0 to Aux#
37709>>>>>           End
37709>>>>>>
37709>>>>>           If Aux# Get Msg# of Aux# to rval
37712>>>>>           Procedure_return rval
37713>>>>>         end
37713>>>>>>
37713>>>>>    End_Procedure // Redirect_Message
37714>>>>>
37714>>>>>End_Class
37715>>>>>
37715>>>>>
37715>>>Use Dates.utl
37715>>>
37715>>>Register_Object CalendarEz
37715>>>Register_Procedure Activate_Sort_Vw
37715>>>Register_Procedure DoPrintScreen
37715>>>
37715>>>Procedure doPopupCalendar
37717>>>    Send request_popup to (Popup_calendar(Self))
37718>>>End_Procedure
37719>>>
37719>>>Procedure doRebuild
37721>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
37722>>>End_Procedure
37723>>>
37723>>>Procedure doExit_Application
37725>>>    send Exit_Application to desktop
37726>>>End_Procedure
37727>>>
37727>>>Procedure DoRefresh_Grids
37729>>>    Integer liObj
37730>>>    
37730>>>    Move (Focus(Desktop)) to liObj
37731>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
37734>>>End_Procedure
37735>>>
37735>>>Procedure DoPopupCalc
37737>>>    Runprogram background "Calc.exe"
37738>>>End_Procedure
37739>>>
37739>>>Procedure DoPopupSetup
37741>>>    string sRunPath
37742>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
37745>>>    append sRunPath "\dfparams"
37746>>>    send DoRunApplication sRunPath
37747>>>End_Procedure
37748>>>
37748>>>Object oMyWinPrint is an DF_PRINTER
37750>>>    Procedure DFPrint
37752>>>        Integer iRetVal
37753>>>        Get DFGetPrintDialogFlags To iRetVal
37754>>>        If iRetVal Begin
37756>>>            Send DFPrintDoc
37757>>>            Send DFClearDoc
37758>>>        End
37758>>>>
37758>>>    End_Procedure
37759>>>    Move Current_Object to WinPrintId
37760>>>End_Object
37761>>>
37761>>>
37761>>>Procedure DoPrint
37763>>>    Send DfPrint to (oMyWinPrint(Self))
37764>>>End_Procedure
37765>>>
37765>>>Procedure DoShowPropertiesPage
37767>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37770>>>End_Procedure
37771>>>
37771>>>   //  Button bar object.
37771>>>//
37771>>>Object Tool_Bar is a ToolBar     
37773>>>    
37773>>>    Property Integer piOutputDestination Public 0
37775>>>
37775>>>    Send ImageList_Add 'bgn.bmp'      // 0
37776>>>    Send ImageList_Add 'end.bmp'      // 1
37777>>>    Send ImageList_Add 'next.bmp'     // 2
37778>>>    Send ImageList_Add 'prev.bmp'     // 3
37779>>>    Send ImageList_Add 'clr.bmp'      // 4
37780>>>    Send ImageList_Add 'clra.bmp'     // 5
37781>>>    Send ImageList_Add 'calend.bmp'   // 6
37782>>>    Send ImageList_Add 'Abfile.bmp'   // 7
37783>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
37784>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
37785>>>    Send ImageList_Add 'Abup.bmp'     // 10
37786>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
37787>>>    Send ImageList_Add 'Save1.bmp'    // 12
37788>>>    Send ImageList_Add 'Exitm.bmp'    // 13
37789>>>    Send ImageList_Add 'include.bmp'  // 14
37790>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
37791>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
37792>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
37793>>>    Send ImageList_Add 'calc1.bmp'    // 18
37794>>>    Send ImageList_Add 'print_m0.bmp' // 19
37795>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
37796>>>    Send ImageList_Add 'vuur.bmp'     // 21
37797>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
37797>>>
37797>>>    send Add_button (ico_user+0) msg_beginning_of_data
37798>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
37799>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
37800>>>
37800>>>    send Add_button (ico_user+3) msg_find_previous
37801>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
37802>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
37803>>>
37803>>>    send Add_button (ico_user+10) msg_find_GE
37804>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
37805>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
37806>>>
37806>>>    send Add_button (ico_user+2) msg_find_next
37807>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
37808>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
37809>>>
37809>>>    send Add_button (ico_user+1) msg_end_of_data
37810>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
37811>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
37812>>>
37812>>>    send Add_space
37813>>>
37813>>>    send Add_button ico_std_find msg_prompt
37814>>>    Send Add_ToolTip "Šå©«˜ (F4)"
37815>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
37816>>>
37816>>>    send Add_button (ico_User+15) msg_zoom
37817>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
37818>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
37819>>>
37819>>>    send Add_button (ico_user+6) msg_doPopupCalendar
37820>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
37821>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
37822>>>
37822>>>    send Add_space
37823>>>
37823>>>    send Add_button (ico_user+4) msg_request_clear
37824>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
37825>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
37826>>>
37826>>>    send Add_button (ico_user+5) msg_request_clear_all
37827>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
37828>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
37829>>>
37829>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
37830>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
37831>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
37832>>>
37832>>>    send Add_space
37833>>>
37833>>>    send Add_button ico_std_filesave msg_request_save
37834>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
37835>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
37836>>>
37836>>>    send Add_button ico_std_delete msg_request_delete
37837>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
37838>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
37839>>>
37839>>>    send Add_button (ico_user+12) msg_request_save_no_clear
37840>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
37841>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
37842>>>
37842>>>    send Add_space
37843>>>
37843>>>    send Add_button ico_std_cut msg_cut
37844>>>    Send Add_ToolTip "€§¦¡¦§ã"
37845>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37846>>>
37846>>>    send Add_button ico_std_copy msg_copy
37847>>>    Send Add_ToolTip "€¤« š¨˜­ã"
37848>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37849>>>
37849>>>    send Add_button ico_std_paste msg_paste
37850>>>    Send Add_ToolTip "„ ©˜šàšã"
37851>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
37852>>>
37852>>>    //send Add_button (ico_user+19) msg_DoPrint
37852>>>    send Add_button ICO_STD_PRINT msg_DoPrint
37853>>>    Send Add_ToolTip "„¡«ç§à©ž"
37854>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
37855>>>
37855>>>    send Add_space              
37856>>>
37856>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
37856>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
37857>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
37858>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
37859>>>    
37859>>>    Object oOutputSelector Is A ComboFormSub
37861>>>       Set Entry_State Item 0 to FALSE
37862>>>       Set Combo_Sort_State to FALSE
37863>>>       Set GuiLocation to 1 480
37864>>>       Set Size to 14 55
37865>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
37866>>>       Set Focus_Mode to Pointer_Only
37867>>>       Set Skip_State to True
37868>>>       
37868>>>       Procedure Combo_Fill_List
37870>>>       
37870>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
37871>>>           Send Combo_Add_Item 'Clipboard'
37872>>>       
37872>>>       End_Procedure
37873>>>       
37873>>>       Procedure OnChange
37875>>>           String liValue
37876>>>           
37876>>>           Get Value Item 0 to liValue 
37877>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
37880>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
37884>>>       End_Procedure
37885>>>       
37885>>>    End_Object   // oReportSelector
37886>>>    
37886>>>    For WindowIndex from 1 to 12
37892>>>>
37892>>>        send Add_space              
37893>>>    Loop
37894>>>>
37894>>>
37894>>>    send Add_button (ico_user+7) msg_DoRebuild
37895>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
37896>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
37897>>>
37897>>>    send Add_button (ico_user+18) msg_DoPopupCalc
37898>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
37899>>>    Set  Status_Help To ""
37900>>>
37900>>>    send Add_button (ico_user+21) msg_DoPopupSetup
37901>>>    Send Add_ToolTip "Setup Client"
37902>>>    Set  Status_Help To "Machine Settings Network Parameter"
37903>>>
37903>>>    send Add_space
37904>>>
37904>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
37905>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
37906>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
37907>>>
37907>>>    send Add_button ico_std_help msg_Help_On_Topic
37908>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
37909>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
37910>>>
37910>>>    send Add_space
37911>>>
37911>>>    send Add_button (ico_user+13) msg_Exit_Application
37912>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
37913>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
37914>>>
37914>>>    Procedure DoPrintScreen
37916>>>        Integer iVoid aiWhereTo
37917>>>        
37917>>>        Get piOutputDestination to aiWhereTo
37918>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
37921>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
37925>>>    End_Procedure
37926>>>
37926>>>
37926>>>    Procedure Redirect_Button_Message integer Itm
37928>>>        Integer msg# liObj liCls
37929>>>        
37929>>>        Get Message   item itm  to Msg#
37930>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
37933>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
37937>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
37941>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
37945>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
37949>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
37953>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
37957>>>        Else Forward Send Redirect_Button_Message Itm
37960>>>    End_Procedure // Redirect_Message
37961>>>
37961>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
37963>>>        Integer hoClient
37964>>>        
37964>>>        Delegate Get Client_Id To hoClient
37966>>>        Delegate Set Client_Id To 0
37968>>>        //----Changes the Icon
37968>>>        //Set Toolbar_State To False
37968>>>        //Set Form_Image_Index Item iItem To iImageIndex
37968>>>        //Set Toolbar_State To True
37968>>>        //----Changes the Shadow_State
37968>>>        Set Shadow_State Item iItem To iImageIndex
37969>>>        Delegate Set Client_Id To hoClient
37971>>>    End_Procedure // DoChangeToolBarIcon
37972>>>
37972>>>    Procedure Page_Object Integer iState
37974>>>      Integer hoCurrentObject
37975>>>      
37975>>>      Forward Send Page_Object iState
37977>>>      Move (Self) to hoCurrentObject
37978>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
37979>>>    End_Procedure   // Page_Object
37980>>>
37980>>>    
37980>>>    Procedure Page Integer iState
37982>>>        Forward Send Page iState
37984>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
37985>>>        If iState Begin
37987>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
37987>>>        End
37987>>>>
37987>>>    End_Procedure
37988>>>    
37988>>>//    Object oToolBarTimer Is A DfTimer
37988>>>//        Procedure OnTimer
37988>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
37988>>>//           
37988>>>//           Get Focus To hoFocus
37988>>>//           If hoFocus Gt Desktop Begin
37988>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
37988>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
37988>>>//                //                    if it is a modal panel, this could throw up error messages.
37988>>>//                If (bIsModal = DfFalse) Begin
37988>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
37988>>>//                End
37988>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
37988>>>//                Move (Parent (Self)) To hoToolBar
37988>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
37988>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
37988>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
37988>>>//                End
37988>>>//           End
37988>>>//       End_Procedure // OnTimer
37988>>>//   End_Object // oToolBarTimer
37988>>>   
37988>>>End_Object
37989>>>
37989>>>
37989>    
37989>    Object Client_Area is a AppClientAreasub
37991>
37991>        //AB-ClientStoreTopStart
37991>        
37991>        
37991>                Use Roundfn.Fnc
37991>                Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                               String asNomismaCodeSe  Date   adHmnia;                                               Number nIsotimia  Returns Number
37992>        
37992>                    Number rVal nApo_Euro_Isot nSe_Euro_Isot
37993>                    Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
37993>                    Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
37993>                    String  sCode
37993>        
37993>                    If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
37996>        
37996>                    Clear Nomisma
37997>                    Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
37998>                    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
37999>                    Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
38000>                    Move Nomisma.Einai_DRX      to iApo_Einai_DRX
38001>                    Move Nomisma.Einai_EURO     to iApo_Einai_Euro
38002>                    Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
38003>                    Move Nomisma.Dekadika       to iDekadika_Apo
38004>                    // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
38004>                    If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
38006>                        If (adHmnia='') Sysdate            adHmnia
38009>                        Move (Trim(asNomismaCodeApo))   to sCode
38010>                        Clear Isotimia
INCLUDING FILE: ISOTIMIA.FD
38011>                        Move sCode                      to Isotimia.Nomisma_Code
38012>                        Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38013>                        Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38014>                        Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
38015>                    End
38015>        
38015>                    Clear Nomisma
38016>                    Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
38017>                    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38018>                    Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
38019>                    Move Nomisma.Einai_DRX      to iSe_Einai_DRX
38020>                    Move Nomisma.Einai_EURO     to iSe_Einai_Euro
38021>                    Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
38022>                    Move Nomisma.Dekadika       to iDekadika_Se
38023>                    // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
38023>                    If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
38025>                        If (adHmnia='') Sysdate            adHmnia
38028>                        Move (Trim(asNomismaCodeSe))    to sCode
38029>                        Clear Isotimia
38030>                        Move sCode                      to Isotimia.Nomisma_Code
38031>                        Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38032>                        Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38033>                        Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
38034>                    End
38034>        
38034>                    Calc (anPoso/nApo_Euro_Isot) to rVal
38035>                    Move (Round_Number(rVal,6)) to rVal
38036>                    Calc (rVal*nSe_Euro_Isot) to rVal
38037>                    Move (Round_Number(rVal,iDekadika_Se)) to rVal
38038>        
38038>                    Function_Return rVal
38039>                End_Function
38040>        
38040>        
38040>        //AB-ClientStoreTopEnd
38040>
38040>        //  Include all views
38040>        Use EnCMVCN.VW                                                                      
INCLUDING FILE: ENCMVCN.VW
38040>>>//AB/ Project EnCMVCN
38040>>>//AB/ Object prj is a View_Project
38040>>>//AB/     Set ProjectName to "EnCMVCN"
38040>>>//AB/     Set ProjectFileName to "EnCMVCN.VW"
38040>>>
38040>>>// Project Object Structure
38040>>>//   EnCMVCN is a dbViewSub
38040>>>//     ButtonSub1 is a ButtonSub
38040>>>
38040>>>// Register all objects
38040>>>Register_Object ButtonSub1
38040>>>Register_Object EnCMVCN
38040>>>
38040>>>
38040>>>//AB/ AppBuild VIEW
38040>>>
38040>>>
38040>>>//AB-StoreTopStart
38040>>>                            
38040>>>Use sl041.sl
INCLUDING FILE: SL041.SL
38040>>>>>//AB/ Project CN : sl041
38040>>>>>//AB/     Object prj is a Lookup_Project
38040>>>>>//AB/         Set ProjectName to "CN : sl041"
38040>>>>>//AB/         Set ProjectFileName to "sl041.SL"
38040>>>>>//AB/         Set GenerateFileName to "NONAME"
38040>>>>>
38040>>>>>// Project Object Structure
38040>>>>>//   sl041 is a dbModalPanelSub
38040>>>>>//     Clients_DD is a DataDictionary
38040>>>>>//     Cn_DD is a DataDictionary
38040>>>>>//     oSelList is a dbListSub
38040>>>>>//     oOK_bn is a ButtonSub
38040>>>>>//     oCancel_bn is a ButtonSub
38040>>>>>//     oSearch_bn is a ButtonSub
38040>>>>>
38040>>>>>// Register all objects
38040>>>>>Register_Object Clients_DD
38040>>>>>Register_Object Cn_DD
38040>>>>>Register_Object oCancel_bn
38040>>>>>Register_Object oOK_bn
38040>>>>>Register_Object oSearch_bn
38040>>>>>Register_Object oSelList
38040>>>>>Register_Object sl041
38040>>>>>
38040>>>>>
38040>>>>>    //AB-IgnoreStart
38040>>>>>
38040>>>>>    Use DFAllEnt.pkg
38040>>>>>    Use dbList.Sub
38040>>>>>    Use Button.Sub
38040>>>>>
38040>>>>>
38040>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
38040>>>>>>>//DDB-FileStart
38040>>>>>>>//DDB-HeaderStart
38040>>>>>>>
38040>>>>>>>// File Name : CLIENTS.DD
38040>>>>>>>// Class Name: Clients_DataDictionary
38040>>>>>>>// Revision  : 241
38040>>>>>>>// Version   : 2
38040>>>>>>>
38040>>>>>>>Use  Windows           // Basic Definitions
38040>>>>>>>Use  DataDict          // DataDictionary Class Definition
38040>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38040>>>>>>>
38040>>>>>>>Open Clients
38042>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38044>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38046>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38048>>>>>>>Open Cn
38050>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38052>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38054>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38056>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38058>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38060>>>>>>>Open Cities
38062>>>>>>>Open Areas
38064>>>>>>>Open Payresp
38066>>>>>>>Open Syscurxr
38068>>>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38070>>>>>>>Open Ptypparl
38072>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
38074>>>>>>>Open Sysrecg
38076>>>>>>>
38076>>>>>>>//DDB-HeaderEnd
38076>>>>>>>//DDB-ValidationStart
38076>>>>>>>
38076>>>>>>>Register_Object Clients_Client_Doy_VT
38076>>>>>>>Register_Object Clients_Client_Job_VT
38076>>>>>>>Register_Object Clients_Client_Categfpa_VT
38076>>>>>>>Register_Object Clients_Client_Catjob_VT1
38076>>>>>>>Register_Object Clients_Client_Idiot_VT
38076>>>>>>>Register_Object Clients_Feregios_VT
38076>>>>>>>
38076>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38078>>>>>>>    Set Type_Value        To "DOY"
38079>>>>>>>    Set Validate_State    To FALSE
38080>>>>>>>    Set Allow_Blank_State To TRUE
38081>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
38082>>>>>>>    //DDB-ValidationCustomStart
38082>>>>>>>    //DDB-ValidationCustomEnd
38082>>>>>>>End_Object   // Clients_Client_Doy_VT
38083>>>>>>>
38083>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38085>>>>>>>    Set Type_Value        To "JOB"
38086>>>>>>>    Set Validate_State    To FALSE
38087>>>>>>>    Set Allow_Blank_State To TRUE
38088>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38089>>>>>>>    //DDB-ValidationCustomStart
38089>>>>>>>    //DDB-ValidationCustomEnd
38089>>>>>>>End_Object   // Clients_Client_Job_VT
38090>>>>>>>
38090>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38092>>>>>>>    Set Type_Value        To "VAT_STATUS"
38093>>>>>>>    Set Validate_State    To FALSE
38094>>>>>>>    Set Allow_Blank_State To TRUE
38095>>>>>>>    //DDB-ValidationCustomStart
38095>>>>>>>    //DDB-ValidationCustomEnd
38095>>>>>>>End_Object   // Clients_Client_Categfpa_VT
38096>>>>>>>
38096>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38098>>>>>>>    Set Type_Value        To "JOB"
38099>>>>>>>    Set Validate_State    To FALSE
38100>>>>>>>    Set Allow_Blank_State To TRUE
38101>>>>>>>    //DDB-ValidationCustomStart
38101>>>>>>>    //DDB-ValidationCustomEnd
38101>>>>>>>End_Object   // Clients_Client_Catjob_VT1
38102>>>>>>>
38102>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38104>>>>>>>    Set Type_Value        To "IDIOT"
38105>>>>>>>    Set Validate_State    To FALSE
38106>>>>>>>    Set Allow_Blank_State To TRUE
38107>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38108>>>>>>>    //DDB-ValidationCustomStart
38108>>>>>>>    //DDB-ValidationCustomEnd
38108>>>>>>>End_Object   // Clients_Client_Idiot_VT
38109>>>>>>>
38109>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38111>>>>>>>    Set Type_Value        To "FEREGIOS"
38112>>>>>>>    Set Allow_Blank_State To TRUE
38113>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38114>>>>>>>    //DDB-ValidationCustomStart
38114>>>>>>>    //DDB-ValidationCustomEnd
38114>>>>>>>End_Object   // Clients_Feregios_VT
38115>>>>>>>//DDB-ValidationEnd
38115>>>>>>>//DDB-SelectionStart
38115>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
38115>>>>>>>Register_Object sl100
38115>>>>>>>//DDB-SelectionEnd
38115>>>>>>>Open Sysfile
38117>>>>>>>open year
38119>>>>>>>
38119>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38120>>>>>>>
38120>>>>>>>    Procedure Construct_Object
38121>>>>>>>        Forward Send Construct_Object
38123>>>>>>>        Property Integer piMustNOTConstrain Public 0
38124>>>>>>>        Property Integer piCheckPlaf        Public 0
38125>>>>>>>        //------------------------------------------------
38125>>>>>>>        // Properties gia na kraththoun oi palies times
38125>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
38125>>>>>>>        // einai 1     js 03/12/2007
38125>>>>>>>        //------------------------------------------------
38125>>>>>>>        Property Integer piCreateNew            Public  0
38126>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
38127>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
38128>>>>>>>        Property String  psAud_Old_AFM          Public ""
38129>>>>>>>        Property String  psAud_Old_DOY          Public ""
38130>>>>>>>        Property String  psAud_Old_DOYN         Public ""
38131>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
38132>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
38133>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
38134>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
38135>>>>>>>        //------------------------------------------------
38135>>>>>>>
38135>>>>>>>    End_Procedure
38136>>>>>>>
38136>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38137>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38139>>>>>>>        //------------------------------------------------
38139>>>>>>>        // Properties gia na kraththoun oi palies times
38139>>>>>>>        // ton pedion js 03/12/2007
38139>>>>>>>        //------------------------------------------------
38139>>>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
38140>>>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
38141>>>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
38142>>>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
38143>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
38144>>>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
38145>>>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
38146>>>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
38147>>>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
38148>>>>>>>        //------------------------------------------------
38148>>>>>>>     End_Procedure   // New_Current_Record
38149>>>>>>>
38149>>>>>>>
38149>>>>>>>    // Backout:
38149>>>>>>>    Procedure Backout
38150>>>>>>>        Forward Send Backout
38152>>>>>>>        // Insert Code Here
38152>>>>>>>    End_Procedure   // Backout
38153>>>>>>>
38153>>>>>>>    Procedure Delete_Main_File
38154>>>>>>>        //---------------------------------------------
38154>>>>>>>        // Auditing / Katagrafh allagon
38154>>>>>>>        String  sUser sText sTime sMin sHour sSec
38155>>>>>>>        Date    dDate  Shmer
38155>>>>>>>        Integer iMin iHour iSec iLen
38155>>>>>>>        Sysdate dDate iHour iMin iSec
38159>>>>>>>        Move iHour  to sHour
38160>>>>>>>        Move iMin   to sMin
38161>>>>>>>        Move iSec   to sSec
38162>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38166>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38170>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38174>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38175>>>>>>>
38175>>>>>>>        // Auditing / Diagrafh
38175>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38177>>>>>>>            Get fsLoginUserID to sUser
38178>>>>>>>            clear gmove
38179>>>>>>>            move syscurxr.company_code  to gmove.company_code
38180>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
38181>>>>>>>            move syscurxr.year_year     to gmove.year_year
38182>>>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
38183>>>>>>>            move ddate                  to gmove.garticl_hmnia
38184>>>>>>>            move suser                  to gmove.gplan_code
38185>>>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
38186>>>>>>>            reread sysrecg
38190>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38191>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38192>>>>>>>            saverecord sysrecg
38193>>>>>>>            unlock
38194>>>>>>>>
38194>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38195>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38196>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
38197>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38198>>>>>>>
38198>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38199>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38200>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38201>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
38202>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38203>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38204>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38205>>>>>>>
38205>>>>>>>
38205>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
38206>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38207>>>>>>>            saverecord gmove
38208>>>>>>>        End
38208>>>>>>>>
38208>>>>>>>
38208>>>>>>>        Forward Send Delete_Main_File
38210>>>>>>>
38210>>>>>>>    End_Procedure
38211>>>>>>>
38211>>>>>>>
38211>>>>>>>    Procedure Update
38212>>>>>>>        Forward Send Update
38214>>>>>>>        // Insert Code Here
38214>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
38215>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
38216>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
38217>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38217>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
38218>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
38219>>>>>>>
38219>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
38219>>>>>>>
38219>>>>>>>        //betolink
38219>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
38220>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
38221>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
38222>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
38223>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
38224>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job             
38224>>>>>>>     
38224>>>>>>>     
38224>>>>>>>        //---------------------------------------------
38224>>>>>>>        // Auditing / Katagrafh allagon
38224>>>>>>>        String  sUser sText sTime sMin sHour sSec
38225>>>>>>>        Date    dDate  Shmer 
38225>>>>>>>        Integer iMin iHour iSec iLen
38225>>>>>>>        Sysdate dDate iHour iMin iSec 
38229>>>>>>>        Move iHour  to sHour
38230>>>>>>>        Move iMin   to sMin
38231>>>>>>>        Move iSec   to sSec
38232>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38236>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38240>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38244>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38245>>>>>>>        
38245>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
38245>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38247>>>>>>>            Get fsLoginUserID to sUser
38248>>>>>>>            If (piCreateNew(Self)=1) Begin
38250>>>>>>>                clear gmove
38251>>>>>>>                move syscurxr.company_code  to gmove.company_code
38252>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
38253>>>>>>>                move syscurxr.year_year     to gmove.year_year
38254>>>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
38255>>>>>>>                move ddate                  to gmove.garticl_hmnia
38256>>>>>>>                move suser                  to gmove.gplan_code
38257>>>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
38258>>>>>>>                reread sysrecg
38262>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38263>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38264>>>>>>>                saverecord sysrecg
38265>>>>>>>                unlock
38266>>>>>>>>
38266>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38267>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38268>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38269>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38270>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
38271>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
38272>>>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr 
38273>>>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr  
38274>>>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
38275>>>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
38276>>>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
38277>>>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
38278>>>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
38279>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
38280>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
38281>>>>>>>                saverecord gmove
38282>>>>>>>                Set piCreateNew to 0
38283>>>>>>>            End
38283>>>>>>>>
38283>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38286>>>>>>>                Integer isChanged
38286>>>>>>>                Move 0 to isChanged
38287>>>>>>>                
38287>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
38290>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
38294>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
38298>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
38302>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
38306>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
38310>>>>>>>                
38310>>>>>>>                If (isChanged>0) Begin  
38312>>>>>>>                    clear gmove
38313>>>>>>>                    move syscurxr.company_code  to gmove.company_code
38314>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38315>>>>>>>                    move syscurxr.year_year     to gmove.year_year
38316>>>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
38317>>>>>>>                    move ddate                  to gmove.garticl_hmnia
38318>>>>>>>                    move suser                  to gmove.gplan_code
38319>>>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
38320>>>>>>>                    reread sysrecg
38324>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38325>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38326>>>>>>>                    saverecord sysrecg
38327>>>>>>>                    unlock
38328>>>>>>>>
38328>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38329>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38330>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38331>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38332>>>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr 
38333>>>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr  
38334>>>>>>>                    //--
38334>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
38335>>>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
38336>>>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
38337>>>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
38338>>>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
38339>>>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
38340>>>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
38341>>>>>>>                    //--
38341>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38342>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38343>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38344>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
38345>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38346>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38347>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38348>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
38349>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38350>>>>>>>                    saverecord gmove
38351>>>>>>>                    Set piCreateNew to 0
38352>>>>>>>                End
38352>>>>>>>>
38352>>>>>>>            End
38352>>>>>>>>
38352>>>>>>>        End
38352>>>>>>>>
38352>>>>>>>
38352>>>>>>>     
38352>>>>>>>    End_Procedure   // Update
38353>>>>>>>
38353>>>>>>>
38353>>>>>>>    Procedure Creating
38354>>>>>>>        date ddate iYes
38355>>>>>>>        Forward Send Creating
38357>>>>>>>        // Insert Code Here
38357>>>>>>>
38357>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
38358>>>>>>>        Move '1'                    to Clients.Client_Active
38359>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
38360>>>>>>>        sysdate4 ddate
38361>>>>>>>        move ddate                  to Clients.Client_Hmnia    
38362>>>>>>>        Set piCreateNew to 1
38363>>>>>>>    End_Procedure   // Creating
38364>>>>>>>
38364>>>>>>>    Function Validate_Save  Returns Integer
38365>>>>>>>        Integer iReturnVal iCheck iYes
38366>>>>>>>        Forward Get Validate_Save  To iReturnVal
38368>>>>>>>        If (Not(iReturnVal)) Begin
38370>>>>>>>
38370>>>>>>>            If (clients.is_eksoter <> '1') begin
38372>>>>>>>                If (Clients.Is_Xondr='1') Begin
38374>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
38376>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
38377>>>>>>>                        If (iCheck) Begin
38379>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
38382>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
38386>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
38390>>>>>>>                        End
38390>>>>>>>>
38390>>>>>>>                    End
38390>>>>>>>>
38390>>>>>>>                End
38390>>>>>>>>
38390>>>>>>>            End
38390>>>>>>>>
38390>>>>>>>
38390>>>>>>>            If (piCheckPlaf(Self)=1) Begin
38392>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
38394>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
38395>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
38398>>>>>>>                End
38398>>>>>>>>
38398>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
38401>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
38402>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38405>>>>>>>                End
38405>>>>>>>>
38405>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
38408>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
38409>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38412>>>>>>>                End
38412>>>>>>>>
38412>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
38415>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
38416>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
38419>>>>>>>                End
38419>>>>>>>>
38419>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
38421>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
38422>>>>>>>                End
38422>>>>>>>>
38422>>>>>>>            End
38422>>>>>>>>
38422>>>>>>>
38422>>>>>>>            If (iReturnVal) Begin
38424>>>>>>>                Send Operation_Not_Allowed iReturnVal
38425>>>>>>>            End
38425>>>>>>>>
38425>>>>>>>        End
38425>>>>>>>>
38425>>>>>>>        Function_Return iReturnVal
38426>>>>>>>    End_Function   // Validate_Save
38427>>>>>>>
38427>>>>>>>
38427>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38428>>>>>>>        String lsError_Message
38429>>>>>>>
38429>>>>>>>        Case Begin
38429>>>>>>>            Case (iError_Num = 4001)
38431>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38432>>>>>>>              Case Break
38433>>>>>>>            Case (iError_Num = 4002)
38436>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
38437>>>>>>>              Case Break
38438>>>>>>>            Case (iError_Num = 4003)
38441>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38442>>>>>>>              Case Break
38443>>>>>>>            Case (iError_Num = 4004)
38446>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
38447>>>>>>>              Case Break
38448>>>>>>>            Case (iError_Num = 4005)
38451>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
38452>>>>>>>              Case Break
38453>>>>>>>            Case (iError_Num = 4006)
38456>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
38457>>>>>>>              Case Break
38458>>>>>>>
38458>>>>>>>            Case Else
38458>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38460>>>>>>>        Case End
38460>>>>>>>
38460>>>>>>>        Error iError_Num lsError_Message
38461>>>>>>>>
38461>>>>>>>    End_Procedure // operation_not_allowed
38462>>>>>>>
38462>>>>>>>
38462>>>>>>>    // Define_Fields:
38462>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38462>>>>>>>
38462>>>>>>>    Procedure Define_Fields
38463>>>>>>>        Forward Send Define_Fields
38465>>>>>>>        //DDB-Generated-Code-Location
38465>>>>>>>        //DDB-DefineFieldStart
38465>>>>>>>
38465>>>>>>>        Set Main_File            To Clients.File_Number
38466>>>>>>>        Set Cascade_Delete_State To FALSE
38467>>>>>>>
38467>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38468>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38469>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38470>>>>>>>
38470>>>>>>>        // Child (Client) file structure................
38470>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38471>>>>>>>        Send Add_Client_File  Particle.File_Number
38472>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38473>>>>>>>        Send Add_Client_File  Cn.File_Number
38474>>>>>>>        Send Add_Client_File  Particll.File_Number
38475>>>>>>>        Send Add_Client_File  Clnbank.File_Number
38476>>>>>>>        Send Add_Client_File  Tpclient.File_Number
38477>>>>>>>        Send Add_Client_File  Clorder.File_Number
38478>>>>>>>        Send Add_Client_File  Clitem.File_Number
38479>>>>>>>
38479>>>>>>>        // Parent (Server) file structure...............
38479>>>>>>>        Send Add_Server_File  Cities.File_Number
38480>>>>>>>        Send Add_Server_File  Areas.File_Number
38481>>>>>>>        Send Add_Server_File  Payresp.File_Number
38482>>>>>>>
38482>>>>>>>        // External (System) file structure.............
38482>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38483>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38484>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
38485>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38486>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38487>>>>>>>
38487>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
38490>>>>>>>
38490>>>>>>>        // Field-based properties.......................
38490>>>>>>>
38490>>>>>>>        // Clients.Company_Code
38490>>>>>>>
38490>>>>>>>        // Clients.Branch_Code
38490>>>>>>>
38490>>>>>>>        // Clients.Year_Year
38490>>>>>>>
38490>>>>>>>        // Clients.Custprom_Code
38490>>>>>>>
38490>>>>>>>        // Clients.Client_Id
38490>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
38491>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
38492>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
38493>>>>>>>
38493>>>>>>>        // Clients.Client_Name
38493>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
38494>>>>>>>
38494>>>>>>>        // Clients.Client_Afm
38494>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
38495>>>>>>>
38495>>>>>>>        // Clients.Client_Rec0
38495>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
38496>>>>>>>
38496>>>>>>>        // Clients.Custprom_Recr
38496>>>>>>>
38496>>>>>>>        // Clients.Client_Recr
38496>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
38497>>>>>>>
38497>>>>>>>        // Clients.Last_Xreosh
38497>>>>>>>
38497>>>>>>>        // Clients.Last_Pistosh
38497>>>>>>>
38497>>>>>>>        // Clients.Last_Order
38497>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
38498>>>>>>>
38498>>>>>>>        // Clients.Client_Doy
38498>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
38499>>>>>>>
38499>>>>>>>        // Clients.Client_Address
38499>>>>>>>
38499>>>>>>>        // Clients.Client_City_Id
38499>>>>>>>
38499>>>>>>>        // Clients.Client_Area
38499>>>>>>>
38499>>>>>>>        // Clients.Client_Job
38499>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Respons
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Zipcode
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Phone
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Fax
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Mobile
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Aoh
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Email
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Class
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Details
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Sitew
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Codem
38500>>>>>>>
38500>>>>>>>        // Clients.Client_Categfpa
38500>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Fpa
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Public
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Sn
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Repm
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Active
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Reported
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Pelprom
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Lastupd
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Markexp
38501>>>>>>>
38501>>>>>>>        // Clients.Client_Catjob
38501>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
38502>>>>>>>
38502>>>>>>>        // Clients.Is_Promhtheyths
38502>>>>>>>
38502>>>>>>>        // Clients.Xreosh
38502>>>>>>>
38502>>>>>>>        // Clients.Pistosh
38502>>>>>>>
38502>>>>>>>        // Clients.Ypoloipo
38502>>>>>>>
38502>>>>>>>        // Clients.Plafon
38502>>>>>>>
38502>>>>>>>        // Clients.Overhead
38502>>>>>>>
38502>>>>>>>        // Clients.Client_Company
38502>>>>>>>
38502>>>>>>>        // Clients.Client_Repmatch
38502>>>>>>>
38502>>>>>>>        // Clients.Client_Hmnia
38502>>>>>>>
38502>>>>>>>        // Clients.Client_Presp
38502>>>>>>>
38502>>>>>>>        // Clients.Client_Locked
38502>>>>>>>
38502>>>>>>>        // Clients.Synolikh_Ofeilh
38502>>>>>>>
38502>>>>>>>        // Clients.Client_Idiot
38502>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Add_No
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Nomos
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Xora
38503>>>>>>>
38503>>>>>>>        // Clients.Polh_Recr
38503>>>>>>>
38503>>>>>>>        // Clients.Presp_Id
38503>>>>>>>
38503>>>>>>>        // Clients.Sum_Pct_Tpcl
38503>>>>>>>
38503>>>>>>>        // Clients.Is_Client
38503>>>>>>>
38503>>>>>>>        // Clients.Sysxetish
38503>>>>>>>
38503>>>>>>>        // Clients.Poso_Se_Apait
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Glcode
38503>>>>>>>
38503>>>>>>>        // Clients.Is_Eksoter
38503>>>>>>>
38503>>>>>>>        // Clients.Is_Xondr
38503>>>>>>>
38503>>>>>>>        // Clients.Orio_Syn_Ofeilh
38503>>>>>>>
38503>>>>>>>        // Clients.Posa_Apo_Dap
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Doybtm
38503>>>>>>>
38503>>>>>>>        // Clients.Posa_Apo_Parag
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Ptyppar
38503>>>>>>>
38503>>>>>>>        // Clients.Client_Seira
38503>>>>>>>
38503>>>>>>>        // Clients.Hpso
38503>>>>>>>
38503>>>>>>>        // Clients.Hpal
38503>>>>>>>
38503>>>>>>>        // Clients.Feregios
38503>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
38504>>>>>>>
38504>>>>>>>        // Clients.Diakin
38504>>>>>>>
38504>>>>>>>        // Clients.Status
38504>>>>>>>
38504>>>>>>>        // Clients.Anal
38504>>>>>>>
38504>>>>>>>        // Clients.Endoomil
38504>>>>>>>
38504>>>>>>>        // Clients.Npdd
38504>>>>>>>
38504>>>>>>>        // Clients.Sap_Hmnia
38504>>>>>>>
38504>>>>>>>        //DDB-DefineFieldEnd
38504>>>>>>>    End_Procedure    // Define_Fields
38505>>>>>>>
38505>>>>>>>    // Field_Defaults:
38505>>>>>>>    // This procedure is used to establish default field values.
38505>>>>>>>
38505>>>>>>>    Procedure Field_Defaults
38506>>>>>>>        Forward Send Field_Defaults
38508>>>>>>>        //DDB-Generated-Code-Location
38508>>>>>>>        //DDB-FieldDefaultStart
38508>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
38509>>>>>>>        //DDB-FieldDefaultEnd
38509>>>>>>>    End_Procedure    // Field_Defaults
38510>>>>>>>
38510>>>>>>>End_Class    // Clients_DataDictionary
38511>>>>>>>//DDB-Selection-pkg-Start
38511>>>>>>>
38511>>>>>>>Use sl100.SL         // sl100
INCLUDING FILE: SL100.SL
38511>>>>>>>>>//AB/ Project SL100:PELATES
38511>>>>>>>>>//AB/     Object prj is a Lookup_Project
38511>>>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
38511>>>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
38511>>>>>>>>>
38511>>>>>>>>>// Project Object Structure
38511>>>>>>>>>//   sl100 is a dbModalPanelSub
38511>>>>>>>>>//     Clients_DD is a DataDictionary
38511>>>>>>>>>//     oSelList is a dbListSub
38511>>>>>>>>>//     oOK_bn is a ButtonSub
38511>>>>>>>>>//     oCancel_bn is a ButtonSub
38511>>>>>>>>>//     oSearch_bn is a ButtonSub
38511>>>>>>>>>
38511>>>>>>>>>// Register all objects
38511>>>>>>>>>Register_Object Clients_DD
38511>>>>>>>>>Register_Object oCancel_bn
38511>>>>>>>>>Register_Object oOK_bn
38511>>>>>>>>>Register_Object oSearch_bn
38511>>>>>>>>>Register_Object oSelList
38511>>>>>>>>>Register_Object sl100
38511>>>>>>>>>
38511>>>>>>>>>
38511>>>>>>>>>    //AB-IgnoreStart
38511>>>>>>>>>
38511>>>>>>>>>    Use DFAllEnt.pkg
38511>>>>>>>>>    Use dbList.Sub
38511>>>>>>>>>    Use Button.Sub
38511>>>>>>>>>
38511>>>>>>>>>
38511>>>>>>>>>    Use CLIENTS.DD
38511>>>>>>>>>    
38511>>>>>>>>>    //AB-IgnoreEnd
38511>>>>>>>>>
38511>>>>>>>>>    Object sl100 is a dbModalPanelSub
38513>>>>>>>>>
38513>>>>>>>>>        //AB-StoreTopStart
38513>>>>>>>>>                
38513>>>>>>>>>        Property String     FragmaClient        Public ''
38515>>>>>>>>>        Property String     psIsPromhtheyths    Public ''
38517>>>>>>>>>        Property Integer    piMustConstrain     Public  0
38519>>>>>>>>>        Property String     psModule            Public ''
38521>>>>>>>>>        
38521>>>>>>>>>        //AB-StoreTopEnd
38521>>>>>>>>>
38521>>>>>>>>>        Set Label to "(Xlate(Label(Self)))"
38522>>>>>>>>>        Set Size to 252 509
38523>>>>>>>>>        Set Location to 4 5
38524>>>>>>>>>
38524>>>>>>>>>        //AB-DDOStart
38524>>>>>>>>>
38524>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
38526>>>>>>>>>
38526>>>>>>>>>            //AB-StoreTopStart
38526>>>>>>>>>                                                        
38526>>>>>>>>>            //AB-StoreTopEnd
38526>>>>>>>>>
38526>>>>>>>>>
38526>>>>>>>>>            //AB-StoreStart
38526>>>>>>>>>                                                        
38526>>>>>>>>>            Begin_Constraints
38528>>>>>>>>>                     If (psModule(Self)='01') BEGIN
38530>>>>>>>>>                        Constrain Clients.is_Client        Eq '1'
38532>>>>>>>>>                     end
38532>>>>>>>>>>
38532>>>>>>>>>                     Else If (psModule(Self)='02') begin
38535>>>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
38537>>>>>>>>>                     end
38537>>>>>>>>>>
38537>>>>>>>>>            End_Constraints
38540>>>>>>>>>            
38540>>>>>>>>>            
38540>>>>>>>>>            
38540>>>>>>>>>            
38540>>>>>>>>>            
38540>>>>>>>>>            //AB-StoreEnd
38540>>>>>>>>>
38540>>>>>>>>>        End_Object    // Clients_DD
38541>>>>>>>>>
38541>>>>>>>>>        Set Main_DD to (Clients_DD(self))
38542>>>>>>>>>        Set Server to (Clients_DD(self))
38543>>>>>>>>>
38543>>>>>>>>>        //AB-DDOEnd
38543>>>>>>>>>
38543>>>>>>>>>        Object oSelList is a dbListSub
38545>>>>>>>>>            Set Main_File to Clients.File_Number
38546>>>>>>>>>            Set Size to 204 496
38547>>>>>>>>>            Set Location to 7 5
38548>>>>>>>>>            Set Auto_Index_State to FALSE
38549>>>>>>>>>
38549>>>>>>>>>            Begin_Row
38552>>>>>>>>>                Entry_Item Clients.Client_id
38553>>>>>>>>>                Entry_Item Clients.Client_name
38554>>>>>>>>>                Entry_Item Clients.Client_afm
38555>>>>>>>>>                Entry_Item Clients.Last_xreosh
38556>>>>>>>>>                Entry_Item Clients.Last_pistosh
38557>>>>>>>>>                Entry_Item Clients.Client_codem
38558>>>>>>>>>                Entry_Item Clients.Is_client
38559>>>>>>>>>                Entry_Item Clients.Is_promhtheyths
38560>>>>>>>>>            End_Row
38565>>>>>>>>>
38565>>>>>>>>>            Set Form_Width    item 0 to 64
38566>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38567>>>>>>>>>            
38567>>>>>>>>>            Set Form_Width    item 1 to 133
38568>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38569>>>>>>>>>            
38569>>>>>>>>>            Set Form_Width    item 2 to 62
38570>>>>>>>>>            Set Header_Label  item 2 to "€”‹"
38571>>>>>>>>>            
38571>>>>>>>>>            Set Form_Width    item 3 to 60
38572>>>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
38573>>>>>>>>>            
38573>>>>>>>>>            Set Form_Width    item 4 to 60
38574>>>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
38575>>>>>>>>>            
38575>>>>>>>>>            Set Form_Width    item 5 to 59
38576>>>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
38577>>>>>>>>>            
38577>>>>>>>>>            Set Form_Width    item 6 to 26
38578>>>>>>>>>            Set Header_Label  item 6 to "œ¢"
38579>>>>>>>>>            Set Column_Checkbox_State  item 6 to True
38580>>>>>>>>>            
38580>>>>>>>>>            Set Form_Width    item 7 to 26
38581>>>>>>>>>            Set Header_Label  item 7 to "¨¦£"
38582>>>>>>>>>            Set Column_Checkbox_State  item 7 to True
38583>>>>>>>>>            
38583>>>>>>>>>
38583>>>>>>>>>            //AB-StoreStart
38583>>>>>>>>>                                                                                
38583>>>>>>>>>            //Property String StoreFragmaClient   Public ''
38583>>>>>>>>>            //Property String StorePsModule       Public ''
38583>>>>>>>>>            
38583>>>>>>>>>            //Procedure Store_Defaults
38583>>>>>>>>>            //    Forward Send Store_Defaults
38583>>>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
38583>>>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
38583>>>>>>>>>            //End_Procedure
38583>>>>>>>>>            
38583>>>>>>>>>            //Procedure ReStore_Defaults
38583>>>>>>>>>            //    Forward Send ReStore_Defaults
38583>>>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
38583>>>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
38583>>>>>>>>>            //End_Procedure
38583>>>>>>>>>            
38583>>>>>>>>>            Set Column_Option Item 6 to NoEnter True
38584>>>>>>>>>            Set Column_Option Item 7 to NoEnter True
38585>>>>>>>>>            
38585>>>>>>>>>            Procedure Activating
38587>>>>>>>>>                Forward Send Activating
38589>>>>>>>>>                Set Auto_Index_State to True
38590>>>>>>>>>            End_Procedure
38591>>>>>>>>>            
38591>>>>>>>>>            Procedure Activate
38593>>>>>>>>>                Send Rebuild_Constraints    to Clients_DD
38594>>>>>>>>>                If (FragmaClient(Self)<>'') Begin
38596>>>>>>>>>                    Clear Clients
38597>>>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
38598>>>>>>>>>                    Find Eq Clients By Index.6
38599>>>>>>>>>>
38599>>>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
38602>>>>>>>>>                End
38602>>>>>>>>>>
38602>>>>>>>>>                Forward Send Activate
38604>>>>>>>>>            End_procedure
38605>>>>>>>>>            
38605>>>>>>>>>            
38605>>>>>>>>>            
38605>>>>>>>>>            
38605>>>>>>>>>            //AB-StoreEnd
38605>>>>>>>>>
38605>>>>>>>>>        End_Object    // oSelList
38606>>>>>>>>>
38606>>>>>>>>>        Object oOK_bn is a ButtonSub
38608>>>>>>>>>            Set Label to "&„§ ¢¦šã"
38609>>>>>>>>>            Set Location to 218 341
38610>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38611>>>>>>>>>
38611>>>>>>>>>            //AB-StoreStart
38611>>>>>>>>>            Procedure OnClick
38613>>>>>>>>>                Send OK To (oSelList(current_object))
38614>>>>>>>>>            End_Procedure
38615>>>>>>>>>            //AB-StoreEnd
38615>>>>>>>>>
38615>>>>>>>>>        End_Object    // oOK_bn
38616>>>>>>>>>
38616>>>>>>>>>        Object oCancel_bn is a ButtonSub
38618>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
38619>>>>>>>>>            Set Location to 218 396
38620>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38621>>>>>>>>>
38621>>>>>>>>>            //AB-StoreStart
38621>>>>>>>>>            Procedure OnClick
38623>>>>>>>>>                Send Cancel To (oSelList(current_object))
38624>>>>>>>>>            End_Procedure
38625>>>>>>>>>            //AB-StoreEnd
38625>>>>>>>>>
38625>>>>>>>>>        End_Object    // oCancel_bn
38626>>>>>>>>>
38626>>>>>>>>>        Object oSearch_bn is a ButtonSub
38628>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38629>>>>>>>>>            Set Location to 218 451
38630>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38631>>>>>>>>>
38631>>>>>>>>>            //AB-StoreStart
38631>>>>>>>>>            Procedure OnClick
38633>>>>>>>>>                Send Search To (oSelList(current_object))
38634>>>>>>>>>            End_Procedure
38635>>>>>>>>>            //AB-StoreEnd
38635>>>>>>>>>
38635>>>>>>>>>        End_Object    // oSearch_bn
38636>>>>>>>>>
38636>>>>>>>>>
38636>>>>>>>>>        //AB-StoreStart
38636>>>>>>>>>                
38636>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38637>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38638>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38639>>>>>>>>>        
38639>>>>>>>>>        Set Modal_State to True
38640>>>>>>>>>        Set Locate_Mode to Center_On_Screen
38641>>>>>>>>>        
38641>>>>>>>>>        
38641>>>>>>>>>        Procedure Activating Returns Integer
38643>>>>>>>>>            Integer rVal
38644>>>>>>>>>            Forward Get Msg_Activating to rVal
38646>>>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
38649>>>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
38653>>>>>>>>>            Procedure_Return rVal
38654>>>>>>>>>        End_procedure
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        
38655>>>>>>>>>        //AB-StoreEnd
38655>>>>>>>>>
38655>>>>>>>>>    End_Object    // sl100
38656>>>>>>>>>
38656>>>>>>>>>//AB/     End_Object    // prj
38656>>>>>>>
38656>>>>>>>//DDB-Selection-pkg-End
38656>>>>>>>//DDB-FileEnd
38656>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
38656>>>>>>>//DDB-FileStart
38656>>>>>>>//DDB-HeaderStart
38656>>>>>>>
38656>>>>>>>// File Name : CN.DD
38656>>>>>>>// Class Name: Cn_DataDictionary
38656>>>>>>>// Revision  : 99
38656>>>>>>>// Version   : 2
38656>>>>>>>
38656>>>>>>>Use  Windows           // Basic Definitions
38656>>>>>>>Use  DataDict          // DataDictionary Class Definition
38656>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38656>>>>>>>
38656>>>>>>>Open Cn
38658>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
38660>>>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
38662>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
38664>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
38666>>>>>>>Open Clients
38668>>>>>>>Open Salesmen
38670>>>>>>>Open Mhxanik
38672>>>>>>>Open Constrct
38674>>>>>>>Open Sysrecc
38676>>>>>>>Open Syscurxr
38678>>>>>>>Open Gmove
38680>>>>>>>Open Sysrecg
38682>>>>>>>
38682>>>>>>>//DDB-HeaderEnd
38682>>>>>>>//DDB-ValidationStart
38682>>>>>>>
38682>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
38682>>>>>>>Register_Object Cn_Tropos_Metaf_VT
38682>>>>>>>Register_Object Cn_Eidos_Cn_VT
38682>>>>>>>Register_Object Cn_Yesno_VT
38682>>>>>>>
38682>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
38684>>>>>>>    Set Type_Value        To "VAT_STATUS"
38685>>>>>>>    Set Validate_State    To FALSE
38686>>>>>>>    Set Allow_Blank_State To TRUE
38687>>>>>>>    //DDB-ValidationCustomStart
38687>>>>>>>    //DDB-ValidationCustomEnd
38687>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
38688>>>>>>>
38688>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
38690>>>>>>>    Set Type_Value        To "FORTOSH"
38691>>>>>>>    Set Allow_Blank_State To TRUE
38692>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
38693>>>>>>>    //DDB-ValidationCustomStart
38693>>>>>>>    //DDB-ValidationCustomEnd
38693>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
38694>>>>>>>
38694>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
38696>>>>>>>    Set Type_Value        To "EIDOSCN"
38697>>>>>>>    Set Allow_Blank_State To TRUE
38698>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
38699>>>>>>>    //DDB-ValidationCustomStart
38699>>>>>>>    //DDB-ValidationCustomEnd
38699>>>>>>>End_Object   // Cn_Eidos_Cn_VT
38700>>>>>>>
38700>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
38702>>>>>>>    Set Type_Value        To "YESNO"
38703>>>>>>>    Set Allow_Blank_State To TRUE
38704>>>>>>>    //DDB-ValidationCustomStart
38704>>>>>>>    //DDB-ValidationCustomEnd
38704>>>>>>>End_Object   // Cn_Yesno_VT
38705>>>>>>>//DDB-ValidationEnd
38705>>>>>>>//DDB-SelectionStart
38705>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
38705>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
38705>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
38705>>>>>>>Register_Object sl041
38705>>>>>>>Register_Object sl198
38705>>>>>>>Register_Object sl197
38705>>>>>>>//DDB-SelectionEnd
38705>>>>>>>
38705>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
38706>>>>>>>
38706>>>>>>>
38706>>>>>>>    Procedure Construct_Object
38707>>>>>>>        Forward Send Construct_Object
38709>>>>>>>        //------------------------------------------------
38709>>>>>>>        // Properties gia na kraththoun oi palies times 
38709>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
38709>>>>>>>        // einai 1     js 03/12/2007
38709>>>>>>>        //------------------------------------------------  
38709>>>>>>>        Property Integer piCreateNew            Public  0
38710>>>>>>>        Property String  psAud_Old_CN           Public ""
38711>>>>>>>        Property String  psAud_Old_CNAdd        Public ""
38712>>>>>>>        Property String  psAud_Old_Chem         Public ""
38713>>>>>>>        Property String  psAud_Old_CNRecr       Public ""
38714>>>>>>>        //------------------------------------------------
38714>>>>>>>
38714>>>>>>>    End_procedure
38715>>>>>>>
38715>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38716>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38718>>>>>>>        //------------------------------------------------
38718>>>>>>>        // Properties gia na kraththoun oi palies times 
38718>>>>>>>        // ton pedion js 03/12/2007
38718>>>>>>>        //------------------------------------------------
38718>>>>>>>        Set psAud_Old_CN           to CN.CN_Code
38719>>>>>>>        Set psAud_Old_CNAdd        to CN.CN_Descr
38720>>>>>>>        Set psAud_Old_Chem         to CN.CN_VTicket
38721>>>>>>>        Set psAud_Old_CNRecr       to CN.CN_Recr
38722>>>>>>>        //------------------------------------------------
38722>>>>>>>     End_Procedure   // New_Current_Record
38723>>>>>>>
38723>>>>>>>    Procedure Delete_Main_File
38724>>>>>>>        //---------------------------------------------
38724>>>>>>>        // Auditing / Katagrafh allagon
38724>>>>>>>        String  sUser sText sTime sMin sHour sSec
38725>>>>>>>        Date    dDate  Shmer 
38725>>>>>>>        Integer iMin iHour iSec iLen
38725>>>>>>>        Sysdate dDate iHour iMin iSec 
38729>>>>>>>        Move iHour  to sHour
38730>>>>>>>        Move iMin   to sMin
38731>>>>>>>        Move iSec   to sSec
38732>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38736>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38740>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38744>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38745>>>>>>>        
38745>>>>>>>        // Auditing / Diagrafh 
38745>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38747>>>>>>>            Get fsLoginUserID to sUser
38748>>>>>>>            clear gmove
38749>>>>>>>            move syscurxr.company_code  to gmove.company_code
38750>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
38751>>>>>>>            move syscurxr.year_year     to gmove.year_year
38752>>>>>>>            move  4                     to gmove.gtypkin_code// Apo Clients
38753>>>>>>>            move ddate                  to gmove.garticl_hmnia
38754>>>>>>>            move suser                  to gmove.gplan_code
38755>>>>>>>            move CN.CN_Recr             to gmove.garticl_recr
38756>>>>>>>            reread sysrecg
38760>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38761>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38762>>>>>>>            saverecord sysrecg
38763>>>>>>>            unlock
38764>>>>>>>>
38764>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38765>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38766>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
38767>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38768>>>>>>>            
38768>>>>>>>            Move CN.CN_Recr                     to Gmove.Partl_Recr          
38769>>>>>>>            Move CN.CN_Recr                     to Gmove.Pms_Recr          
38770>>>>>>>
38770>>>>>>>            Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
38771>>>>>>>            Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
38772>>>>>>>            Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
38773>>>>>>>
38773>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
38774>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38775>>>>>>>            saverecord gmove
38776>>>>>>>        End
38776>>>>>>>>
38776>>>>>>>        Forward Send Delete_Main_File
38778>>>>>>>
38778>>>>>>>    End_Procedure
38779>>>>>>>
38779>>>>>>>    Procedure Update
38780>>>>>>>        Forward Send Update
38782>>>>>>>        // Insert Code Here
38782>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
38783>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
38784>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
38785>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
38785>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
38786>>>>>>>
38786>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
38787>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
38788>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
38789>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
38790>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
38791>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
38792>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
38793>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
38794>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
38795>>>>>>>
38795>>>>>>>        //---------------------------------------------
38795>>>>>>>        // Auditing / Katagrafh allagon
38795>>>>>>>        String  sUser sText sTime sMin sHour sSec
38796>>>>>>>        Date    dDate  Shmer 
38796>>>>>>>        Integer iMin iHour iSec iLen
38796>>>>>>>        Sysdate dDate iHour iMin iSec 
38800>>>>>>>        Move iHour  to sHour
38801>>>>>>>        Move iMin   to sMin
38802>>>>>>>        Move iSec   to sSec
38803>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38807>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38811>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38815>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38816>>>>>>>        
38816>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
38816>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38818>>>>>>>            Get fsLoginUserID to sUser
38819>>>>>>>            If (piCreateNew(Self)=1) Begin
38821>>>>>>>                clear gmove
38822>>>>>>>                move syscurxr.company_code  to gmove.company_code
38823>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
38824>>>>>>>                move syscurxr.year_year     to gmove.year_year
38825>>>>>>>                move  4                     to gmove.gtypkin_code// Apo Clients
38826>>>>>>>                move ddate                  to gmove.garticl_hmnia
38827>>>>>>>                move suser                  to gmove.gplan_code
38828>>>>>>>                move CN.CN_Recr             to gmove.garticl_recr
38829>>>>>>>                reread sysrecg
38833>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38834>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38835>>>>>>>                saverecord sysrecg
38836>>>>>>>                unlock
38837>>>>>>>>
38837>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38838>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38839>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38840>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38841>>>>>>>
38841>>>>>>>                Move CN.CN_Recr                 to Gmove.Partl_Recr          
38842>>>>>>>                Move CN.CN_Recr                 to Gmove.Pms_Recr          
38843>>>>>>>
38843>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
38844>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
38845>>>>>>>                Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
38846>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
38847>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
38848>>>>>>>                saverecord gmove
38849>>>>>>>                Set piCreateNew to 0
38850>>>>>>>            End
38850>>>>>>>>
38850>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38853>>>>>>>                Integer isChanged
38853>>>>>>>                Move 0 to isChanged
38854>>>>>>>                
38854>>>>>>>                     If (psAud_Old_CN   (Self)<>CN.CN_Code   ) Move 1 to isChanged
38857>>>>>>>                Else If (psAud_Old_CNAdd(Self)<>CN.CN_Descr  ) Move 1 to isChanged
38861>>>>>>>                Else If (psAud_Old_Chem (Self)<>CN.CN_VTicket) Move 1 to isChanged
38865>>>>>>>                
38865>>>>>>>                If (isChanged>0) Begin  
38867>>>>>>>                    clear gmove
38868>>>>>>>                    move syscurxr.company_code  to gmove.company_code
38869>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38870>>>>>>>                    move syscurxr.year_year     to gmove.year_year
38871>>>>>>>                    move  4                     to gmove.gtypkin_code// Apo Clients
38872>>>>>>>                    move ddate                  to gmove.garticl_hmnia
38873>>>>>>>                    move suser                  to gmove.gplan_code
38874>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
38875>>>>>>>                    reread sysrecg
38879>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38880>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38881>>>>>>>                    saverecord sysrecg
38882>>>>>>>                    unlock
38883>>>>>>>>
38883>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38884>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38885>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38886>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38887>>>>>>>                    Move CN.CN_Recr                     to Gmove.Partl_Recr          
38888>>>>>>>                    Move CN.CN_Recr                     to Gmove.Pms_Recr          
38889>>>>>>>                    //--                                
38889>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
38890>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
38891>>>>>>>                    Move CN.CN_VTicket                  to Gmove.Cur_CN_Prosth
38892>>>>>>>                    //--
38892>>>>>>>                    Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
38893>>>>>>>                    Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
38894>>>>>>>                    Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
38895>>>>>>>
38895>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
38896>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38897>>>>>>>                    saverecord gmove
38898>>>>>>>                    Set piCreateNew to 0
38899>>>>>>>                End
38899>>>>>>>>
38899>>>>>>>            End
38899>>>>>>>>
38899>>>>>>>        End
38899>>>>>>>>
38899>>>>>>>
38899>>>>>>>
38899>>>>>>>    End_Procedure   // Update
38900>>>>>>>
38900>>>>>>>     Procedure Creating
38901>>>>>>>        Forward Send Creating
38903>>>>>>>        // Insert Code Here
38903>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
38904>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
38905>>>>>>>        Set piCreateNew to 1
38906>>>>>>>    End_Procedure   // Creating
38907>>>>>>>
38907>>>>>>>
38907>>>>>>>
38907>>>>>>>    // Define_Fields:
38907>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38907>>>>>>>
38907>>>>>>>    Procedure Define_Fields
38908>>>>>>>        Forward Send Define_Fields
38910>>>>>>>        //DDB-Generated-Code-Location
38910>>>>>>>        //DDB-DefineFieldStart
38910>>>>>>>
38910>>>>>>>        Set Main_File            To Cn.File_Number
38911>>>>>>>        Set Cascade_Delete_State To FALSE
38912>>>>>>>
38912>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38913>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38914>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38915>>>>>>>
38915>>>>>>>        // Child (Client) file structure................
38915>>>>>>>        Send Add_Client_File  Cnzones.File_Number
38916>>>>>>>        Send Add_Client_File  Tperga.File_Number
38917>>>>>>>        Send Add_Client_File  Btnordh.File_Number
38918>>>>>>>        Send Add_Client_File  Dorderh.File_Number
38919>>>>>>>
38919>>>>>>>        // Parent (Server) file structure...............
38919>>>>>>>        Send Add_Server_File  Clients.File_Number
38920>>>>>>>        Send Add_Server_File  Salesmen.File_Number
38921>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
38922>>>>>>>        Send Add_Server_File  Constrct.File_Number
38923>>>>>>>
38923>>>>>>>        // External (System) file structure.............
38923>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38924>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38925>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38926>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38927>>>>>>>
38927>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
38930>>>>>>>
38930>>>>>>>        // Field-based properties.......................
38930>>>>>>>
38930>>>>>>>        // Cn.Company_Code
38930>>>>>>>
38930>>>>>>>        // Cn.Branch_Code
38930>>>>>>>
38930>>>>>>>        // Cn.Year_Year
38930>>>>>>>
38930>>>>>>>        // Cn.Custprom_Code
38930>>>>>>>
38930>>>>>>>        // Cn.Client_Id
38930>>>>>>>
38930>>>>>>>        // Cn.Cn_Code
38930>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
38931>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
38932>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
38933>>>>>>>
38933>>>>>>>        // Cn.Client_Recr
38933>>>>>>>
38933>>>>>>>        // Cn.Cn_Rec0
38933>>>>>>>
38933>>>>>>>        // Cn.Cn_Recr
38933>>>>>>>
38933>>>>>>>        // Cn.Cn_Descr
38933>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
38934>>>>>>>
38934>>>>>>>        // Cn.Cn_Address
38934>>>>>>>
38934>>>>>>>        // Cn.Cn_Zipcode
38934>>>>>>>
38934>>>>>>>        // Cn.Cn_City
38934>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
38935>>>>>>>
38935>>>>>>>        // Cn.Cn_Area
38935>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_License
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Responsible
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Cnt_Recr
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Cnt_Id
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Phone
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Zone
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Sls_Recr
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Sls_Id
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Details
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Distance
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Pump
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Pumplicense
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Totalstats
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Analstats
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Coated
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Sitew
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Clientmatch
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Codematch
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Pumpid
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Clientid
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Sn
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Repmatch
38936>>>>>>>
38936>>>>>>>        // Cn.Cn_Active
38936>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Reported
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Lastupdated
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Markexp
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Vdetails
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Vticket
38937>>>>>>>
38937>>>>>>>        // Cn.Constraction_Id
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Presp_Id
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Presp_Recr
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Add_No
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Nomos
38937>>>>>>>
38937>>>>>>>        // Cn.Cn_Xora
38937>>>>>>>
38937>>>>>>>        // Cn.Polh_Recr
38937>>>>>>>
38937>>>>>>>        // Cn.Lic_Number
38937>>>>>>>
38937>>>>>>>        // Cn.Lic_Date
38937>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
38938>>>>>>>
38938>>>>>>>        // Cn.Lic_Lixi
38938>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
38939>>>>>>>
38939>>>>>>>        // Cn.Lic_Auth
38939>>>>>>>
38939>>>>>>>        // Cn.Cn_Start_Date
38939>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
38940>>>>>>>
38940>>>>>>>        // Cn.Cn_End_Date
38940>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
38941>>>>>>>
38941>>>>>>>        // Cn.Cn_Categfpa
38941>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
38942>>>>>>>
38942>>>>>>>        // Cn.Cn_Tpay
38942>>>>>>>
38942>>>>>>>        // Cn.Mhxanik_Id
38942>>>>>>>
38942>>>>>>>        // Cn.Sum_Pct_Tper
38942>>>>>>>
38942>>>>>>>        // Cn.Cn_M3
38942>>>>>>>
38942>>>>>>>        // Cn.Aa_Deop
38942>>>>>>>
38942>>>>>>>        // Cn.Hm_Tel_Fortio
38942>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
38943>>>>>>>
38943>>>>>>>        // Cn.Tel_Fortio_No
38943>>>>>>>
38943>>>>>>>        // Cn.Tropos_Metaf
38943>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
38944>>>>>>>
38944>>>>>>>        // Cn.Eidos_Cn
38944>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
38945>>>>>>>
38945>>>>>>>        // Cn.Polhths_Constr
38945>>>>>>>
38945>>>>>>>        // Cn.Polhths_Mhx
38945>>>>>>>
38945>>>>>>>        // Cn.Hm_Prot_Fortio
38945>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
38946>>>>>>>
38946>>>>>>>        // Cn.Mesoskyklos
38946>>>>>>>
38946>>>>>>>        // Cn.Diodia
38946>>>>>>>
38946>>>>>>>        // Cn.Yesno
38946>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
38947>>>>>>>
38947>>>>>>>        // Cn.Dateeggy
38947>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Branch
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Exfd1
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Exfd2
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Exfd3
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Exfd4
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Exfd5
38948>>>>>>>
38948>>>>>>>        // Cn.Cn_Exfd6
38948>>>>>>>
38948>>>>>>>        //DDB-DefineFieldEnd
38948>>>>>>>    End_Procedure    // Define_Fields
38949>>>>>>>
38949>>>>>>>    // Field_Defaults:
38949>>>>>>>    // This procedure is used to establish default field values.
38949>>>>>>>          
38949>>>>>>>    Procedure Field_Defaults
38950>>>>>>>        Forward Send Field_Defaults
38952>>>>>>>        //DDB-Generated-Code-Location
38952>>>>>>>        //DDB-FieldDefaultStart
38952>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
38953>>>>>>>        //DDB-FieldDefaultEnd
38953>>>>>>>    End_Procedure    // Field_Defaults
38954>>>>>>>
38954>>>>>>>End_Class    // Cn_DataDictionary
38955>>>>>>>//DDB-Selection-pkg-Start
38955>>>>>>>
38955>>>>>>>Use sl041.sl         // sl041
38955>>>>>>>Use sl198.sl         // sl198
INCLUDING FILE: SL198.SL
38955>>>>>>>>>//AB/ Project sl198:cities
38955>>>>>>>>>//AB/ Object prj is a Lookup_Project
38955>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
38955>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
38955>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
38955>>>>>>>>>
38955>>>>>>>>>// Project Object Structure
38955>>>>>>>>>//   sl198 is a dbModalPanelSub
38955>>>>>>>>>//     Cities_DD is a DataDictionary
38955>>>>>>>>>//     oSelList is a dbListSub
38955>>>>>>>>>//     oOK_bn is a ButtonSub
38955>>>>>>>>>//     oCancel_bn is a ButtonSub
38955>>>>>>>>>//     oSearch_bn is a ButtonSub
38955>>>>>>>>>
38955>>>>>>>>>// Register all objects
38955>>>>>>>>>Register_Object Cities_DD
38955>>>>>>>>>Register_Object oCancel_bn
38955>>>>>>>>>Register_Object oOK_bn
38955>>>>>>>>>Register_Object oSearch_bn
38955>>>>>>>>>Register_Object oSelList
38955>>>>>>>>>Register_Object sl198
38955>>>>>>>>>
38955>>>>>>>>>
38955>>>>>>>>>//AB-IgnoreStart
38955>>>>>>>>>
38955>>>>>>>>>Use DFAllEnt.pkg
38955>>>>>>>>>Use dbList.Sub
38955>>>>>>>>>Use Button.Sub
38955>>>>>>>>>
38955>>>>>>>>>
38955>>>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
38955>>>>>>>>>>>//DDB-FileStart
38955>>>>>>>>>>>//DDB-HeaderStart
38955>>>>>>>>>>>
38955>>>>>>>>>>>// File Name : CITIES.DD
38955>>>>>>>>>>>// Class Name: Cities_DataDictionary
38955>>>>>>>>>>>// Revision  : 14
38955>>>>>>>>>>>// Version   : 2
38955>>>>>>>>>>>
38955>>>>>>>>>>>Use  Windows           // Basic Definitions
38955>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38955>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38955>>>>>>>>>>>
38955>>>>>>>>>>>Open Cities
38957>>>>>>>>>>>Open Clients
38959>>>>>>>>>>>Open Towns
38961>>>>>>>>>>>
38961>>>>>>>>>>>//DDB-HeaderEnd
38961>>>>>>>>>>>//DDB-SelectionStart
38961>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
38961>>>>>>>>>>>Register_Object sl198
38961>>>>>>>>>>>//DDB-SelectionEnd
38961>>>>>>>>>>>
38961>>>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
38962>>>>>>>>>>>
38962>>>>>>>>>>>    // Define_Fields:
38962>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38962>>>>>>>>>>>
38962>>>>>>>>>>>    Procedure Define_Fields
38963>>>>>>>>>>>        Forward Send Define_Fields
38965>>>>>>>>>>>        //DDB-Generated-Code-Location
38965>>>>>>>>>>>        //DDB-DefineFieldStart
38965>>>>>>>>>>>
38965>>>>>>>>>>>        Set Main_File            To Cities.File_Number
38966>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
38967>>>>>>>>>>>
38967>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38968>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38969>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38970>>>>>>>>>>>
38970>>>>>>>>>>>        // Child (Client) file structure................
38970>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
38971>>>>>>>>>>>
38971>>>>>>>>>>>        // Parent (Server) file structure...............
38971>>>>>>>>>>>        Send Add_Server_File  Towns.File_Number
38972>>>>>>>>>>>
38972>>>>>>>>>>>        // Field-based properties.......................
38972>>>>>>>>>>>
38972>>>>>>>>>>>        // Cities.City_Id
38972>>>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
38973>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
38974>>>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
38975>>>>>>>>>>>
38975>>>>>>>>>>>        // Cities.City_Descr
38975>>>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
38976>>>>>>>>>>>
38976>>>>>>>>>>>        // Cities.Town_Id
38976>>>>>>>>>>>
38976>>>>>>>>>>>        //DDB-DefineFieldEnd
38976>>>>>>>>>>>    End_Procedure    // Define_Fields
38977>>>>>>>>>>>
38977>>>>>>>>>>>    // Field_Defaults:
38977>>>>>>>>>>>    // This procedure is used to establish default field values.
38977>>>>>>>>>>>
38977>>>>>>>>>>>    Procedure Field_Defaults
38978>>>>>>>>>>>        Forward Send Field_Defaults
38980>>>>>>>>>>>        //DDB-Generated-Code-Location
38980>>>>>>>>>>>        //DDB-FieldDefaultStart
38980>>>>>>>>>>>        //DDB-FieldDefaultEnd
38980>>>>>>>>>>>    End_Procedure    // Field_Defaults
38981>>>>>>>>>>>
38981>>>>>>>>>>>End_Class    // Cities_DataDictionary
38982>>>>>>>>>>>//DDB-Selection-pkg-Start
38982>>>>>>>>>>>
38982>>>>>>>>>>>Use sl198.SL         // sl198
38982>>>>>>>>>>>
38982>>>>>>>>>>>//DDB-Selection-pkg-End
38982>>>>>>>>>>>//DDB-FileEnd
38982>>>>>>>>>
38982>>>>>>>>>//AB-IgnoreEnd
38982>>>>>>>>>
38982>>>>>>>>>Object sl198 is a dbModalPanelSub
38984>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
38985>>>>>>>>>    Set Size to 148 297
38986>>>>>>>>>    Set Location to 4 5
38987>>>>>>>>>    Set Exit_Application_Local_State to FALSE
38988>>>>>>>>>    Set Modal_State to FALSE
38989>>>>>>>>>
38989>>>>>>>>>    //AB-DDOStart
38989>>>>>>>>>
38989>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
38991>>>>>>>>>
38991>>>>>>>>>        //AB-StoreStart
38991>>>>>>>>>                
38991>>>>>>>>>                
38991>>>>>>>>>        //AB-StoreEnd
38991>>>>>>>>>
38991>>>>>>>>>    End_Object    // Cities_DD
38992>>>>>>>>>
38992>>>>>>>>>    Set Main_DD to (Cities_DD(self))
38993>>>>>>>>>    Set Server to (Cities_DD(self))
38994>>>>>>>>>
38994>>>>>>>>>    //AB-DDOEnd
38994>>>>>>>>>
38994>>>>>>>>>    Object oSelList is a dbListSub
38996>>>>>>>>>        Set Main_File to Cities.File_Number
38997>>>>>>>>>        Set Size to 105 280
38998>>>>>>>>>        Set Location to 6 6
38999>>>>>>>>>
38999>>>>>>>>>        Begin_Row
39002>>>>>>>>>            Entry_Item Cities.City_id
39003>>>>>>>>>            Entry_Item Cities.City_descr
39004>>>>>>>>>        End_Row
39009>>>>>>>>>
39009>>>>>>>>>        Set Form_Width    item 0 to 50
39010>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
39011>>>>>>>>>        
39011>>>>>>>>>        Set Form_Width    item 1 to 221
39012>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
39013>>>>>>>>>        
39013>>>>>>>>>
39013>>>>>>>>>        //AB-StoreStart
39013>>>>>>>>>        
39013>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
39014>>>>>>>>>        
39014>>>>>>>>>        
39014>>>>>>>>>        
39014>>>>>>>>>        
39014>>>>>>>>>        
39014>>>>>>>>>        //AB-StoreEnd
39014>>>>>>>>>
39014>>>>>>>>>    End_Object    // oSelList
39015>>>>>>>>>
39015>>>>>>>>>    Object oOK_bn is a ButtonSub
39017>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39018>>>>>>>>>        Set Location to 115 126
39019>>>>>>>>>
39019>>>>>>>>>        //AB-StoreStart
39019>>>>>>>>>        Procedure OnClick
39021>>>>>>>>>            Send OK To (oSelList(current_object))
39022>>>>>>>>>        End_Procedure
39023>>>>>>>>>        //AB-StoreEnd
39023>>>>>>>>>
39023>>>>>>>>>    End_Object    // oOK_bn
39024>>>>>>>>>
39024>>>>>>>>>    Object oCancel_bn is a ButtonSub
39026>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39027>>>>>>>>>        Set Location to 115 181
39028>>>>>>>>>
39028>>>>>>>>>        //AB-StoreStart
39028>>>>>>>>>        Procedure OnClick
39030>>>>>>>>>            Send Cancel To (oSelList(current_object))
39031>>>>>>>>>        End_Procedure
39032>>>>>>>>>        //AB-StoreEnd
39032>>>>>>>>>
39032>>>>>>>>>    End_Object    // oCancel_bn
39033>>>>>>>>>
39033>>>>>>>>>    Object oSearch_bn is a ButtonSub
39035>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
39036>>>>>>>>>        Set Location to 115 236
39037>>>>>>>>>
39037>>>>>>>>>        //AB-StoreStart
39037>>>>>>>>>        Procedure OnClick
39039>>>>>>>>>            Send Search To (oSelList(current_object))
39040>>>>>>>>>        End_Procedure
39041>>>>>>>>>        //AB-StoreEnd
39041>>>>>>>>>
39041>>>>>>>>>    End_Object    // oSearch_bn
39042>>>>>>>>>
39042>>>>>>>>>
39042>>>>>>>>>    //AB-StoreStart
39042>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39043>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39044>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39045>>>>>>>>>    //AB-StoreEnd
39045>>>>>>>>>
39045>>>>>>>>>End_Object    // sl198
39046>>>>>>>>>
39046>>>>>>>>>//AB/ End_Object    // prj
39046>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
39046>>>>>>>>>//AB/ Project sl197:areas
39046>>>>>>>>>//AB/     Object prj is a Lookup_Project
39046>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
39046>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
39046>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39046>>>>>>>>>
39046>>>>>>>>>// Project Object Structure
39046>>>>>>>>>//   sl197 is a dbModalPanelSub
39046>>>>>>>>>//     Areas_DD is a DataDictionary
39046>>>>>>>>>//     oSelList is a dbListSub
39046>>>>>>>>>//     oOK_bn is a ButtonSub
39046>>>>>>>>>//     oCancel_bn is a ButtonSub
39046>>>>>>>>>//     oSearch_bn is a ButtonSub
39046>>>>>>>>>
39046>>>>>>>>>// Register all objects
39046>>>>>>>>>Register_Object Areas_DD
39046>>>>>>>>>Register_Object oCancel_bn
39046>>>>>>>>>Register_Object oOK_bn
39046>>>>>>>>>Register_Object oSearch_bn
39046>>>>>>>>>Register_Object oSelList
39046>>>>>>>>>Register_Object sl197
39046>>>>>>>>>
39046>>>>>>>>>
39046>>>>>>>>>    //AB-IgnoreStart
39046>>>>>>>>>
39046>>>>>>>>>    Use DFAllEnt.pkg
39046>>>>>>>>>    Use dbList.Sub
39046>>>>>>>>>    Use Button.Sub
39046>>>>>>>>>
39046>>>>>>>>>
39046>>>>>>>>>    Use AREAS.DD
INCLUDING FILE: AREAS.DD
39046>>>>>>>>>>>//DDB-FileStart
39046>>>>>>>>>>>//DDB-HeaderStart
39046>>>>>>>>>>>
39046>>>>>>>>>>>// File Name : AREAS.DD
39046>>>>>>>>>>>// Class Name: Areas_DataDictionary
39046>>>>>>>>>>>// Revision  : 8
39046>>>>>>>>>>>// Version   : 2
39046>>>>>>>>>>>
39046>>>>>>>>>>>Use  Windows           // Basic Definitions
39046>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39046>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39046>>>>>>>>>>>
39046>>>>>>>>>>>Open Areas
39048>>>>>>>>>>>Open Clients
39050>>>>>>>>>>>
39050>>>>>>>>>>>//DDB-HeaderEnd
39050>>>>>>>>>>>//DDB-SelectionStart
39050>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
39050>>>>>>>>>>>Register_Object sl197
39050>>>>>>>>>>>//DDB-SelectionEnd
39050>>>>>>>>>>>
39050>>>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
39051>>>>>>>>>>>
39051>>>>>>>>>>>    // Define_Fields:
39051>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39051>>>>>>>>>>>
39051>>>>>>>>>>>    Procedure Define_Fields
39052>>>>>>>>>>>        Forward Send Define_Fields
39054>>>>>>>>>>>        //DDB-Generated-Code-Location
39054>>>>>>>>>>>        //DDB-DefineFieldStart
39054>>>>>>>>>>>
39054>>>>>>>>>>>        Set Main_File            To Areas.File_Number
39055>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
39056>>>>>>>>>>>
39056>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39057>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39058>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39059>>>>>>>>>>>
39059>>>>>>>>>>>        // Child (Client) file structure................
39059>>>>>>>>>>>        Send Add_Client_File  Clients.File_Number
39060>>>>>>>>>>>
39060>>>>>>>>>>>        // Field-based properties.......................
39060>>>>>>>>>>>
39060>>>>>>>>>>>        // Areas.Area_Id
39060>>>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
39061>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
39062>>>>>>>>>>>
39062>>>>>>>>>>>        // Areas.Area_Descr
39062>>>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
39063>>>>>>>>>>>
39063>>>>>>>>>>>        // Areas.Area_Site
39063>>>>>>>>>>>
39063>>>>>>>>>>>        //DDB-DefineFieldEnd
39063>>>>>>>>>>>    End_Procedure    // Define_Fields
39064>>>>>>>>>>>
39064>>>>>>>>>>>    // Field_Defaults:
39064>>>>>>>>>>>    // This procedure is used to establish default field values.
39064>>>>>>>>>>>
39064>>>>>>>>>>>    Procedure Field_Defaults
39065>>>>>>>>>>>        Forward Send Field_Defaults
39067>>>>>>>>>>>        //DDB-Generated-Code-Location
39067>>>>>>>>>>>        //DDB-FieldDefaultStart
39067>>>>>>>>>>>        //DDB-FieldDefaultEnd
39067>>>>>>>>>>>    End_Procedure    // Field_Defaults
39068>>>>>>>>>>>
39068>>>>>>>>>>>End_Class    // Areas_DataDictionary
39069>>>>>>>>>>>//DDB-Selection-pkg-Start
39069>>>>>>>>>>>
39069>>>>>>>>>>>Use sl197.SL         // sl197
39069>>>>>>>>>>>
39069>>>>>>>>>>>//DDB-Selection-pkg-End
39069>>>>>>>>>>>//DDB-FileEnd
39069>>>>>>>>>    
39069>>>>>>>>>    //AB-IgnoreEnd
39069>>>>>>>>>
39069>>>>>>>>>    Object sl197 is a dbModalPanelSub
39071>>>>>>>>>
39071>>>>>>>>>        //AB-StoreTopStart
39071>>>>>>>>>                    
39071>>>>>>>>>        //AB-StoreTopEnd
39071>>>>>>>>>
39071>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
39072>>>>>>>>>        Set Size to 148 297
39073>>>>>>>>>        Set Location to 4 5
39074>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39075>>>>>>>>>        Set Modal_State to FALSE
39076>>>>>>>>>
39076>>>>>>>>>        //AB-DDOStart
39076>>>>>>>>>
39076>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
39078>>>>>>>>>
39078>>>>>>>>>            //AB-StoreStart
39078>>>>>>>>>                                    
39078>>>>>>>>>            //AB-StoreEnd
39078>>>>>>>>>
39078>>>>>>>>>        End_Object    // Areas_DD
39079>>>>>>>>>
39079>>>>>>>>>        Set Main_DD to (Areas_DD(self))
39080>>>>>>>>>        Set Server to (Areas_DD(self))
39081>>>>>>>>>
39081>>>>>>>>>        //AB-DDOEnd
39081>>>>>>>>>
39081>>>>>>>>>        Object oSelList is a dbListSub
39083>>>>>>>>>            Set Main_File to Areas.File_Number
39084>>>>>>>>>            Set Ordering to 2
39085>>>>>>>>>            Set Size to 105 280
39086>>>>>>>>>            Set Location to 5 5
39087>>>>>>>>>            Set Export_Item_State to TRUE
39088>>>>>>>>>
39088>>>>>>>>>            Begin_Row
39091>>>>>>>>>                Entry_Item Areas.Area_id
39092>>>>>>>>>                Entry_Item Areas.Area_descr
39093>>>>>>>>>                Entry_Item Areas.Area_site
39094>>>>>>>>>            End_Row
39099>>>>>>>>>
39099>>>>>>>>>            Set Form_Width    item 0 to 45
39100>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
39101>>>>>>>>>            
39101>>>>>>>>>            Set Form_Width    item 1 to 192
39102>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
39103>>>>>>>>>            
39103>>>>>>>>>            Set Form_Width    item 2 to 35
39104>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
39105>>>>>>>>>            
39105>>>>>>>>>
39105>>>>>>>>>            //AB-StoreStart
39105>>>>>>>>>            
39105>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
39106>>>>>>>>>            
39106>>>>>>>>>            
39106>>>>>>>>>            //AB-StoreEnd
39106>>>>>>>>>
39106>>>>>>>>>        End_Object    // oSelList
39107>>>>>>>>>
39107>>>>>>>>>        Object oOK_bn is a ButtonSub
39109>>>>>>>>>            Set Label to "&„§ ¢¦šã"
39110>>>>>>>>>            Set Location to 115 126
39111>>>>>>>>>
39111>>>>>>>>>            //AB-StoreStart
39111>>>>>>>>>            Procedure OnClick
39113>>>>>>>>>                Send OK To (oSelList(current_object))
39114>>>>>>>>>            End_Procedure
39115>>>>>>>>>            //AB-StoreEnd
39115>>>>>>>>>
39115>>>>>>>>>        End_Object    // oOK_bn
39116>>>>>>>>>
39116>>>>>>>>>        Object oCancel_bn is a ButtonSub
39118>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
39119>>>>>>>>>            Set Location to 115 181
39120>>>>>>>>>
39120>>>>>>>>>            //AB-StoreStart
39120>>>>>>>>>            Procedure OnClick
39122>>>>>>>>>                Send Cancel To (oSelList(current_object))
39123>>>>>>>>>            End_Procedure
39124>>>>>>>>>            //AB-StoreEnd
39124>>>>>>>>>
39124>>>>>>>>>        End_Object    // oCancel_bn
39125>>>>>>>>>
39125>>>>>>>>>        Object oSearch_bn is a ButtonSub
39127>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
39128>>>>>>>>>            Set Location to 115 236
39129>>>>>>>>>
39129>>>>>>>>>            //AB-StoreStart
39129>>>>>>>>>            Procedure OnClick
39131>>>>>>>>>                Send Search To (oSelList(current_object))
39132>>>>>>>>>            End_Procedure
39133>>>>>>>>>            //AB-StoreEnd
39133>>>>>>>>>
39133>>>>>>>>>        End_Object    // oSearch_bn
39134>>>>>>>>>
39134>>>>>>>>>
39134>>>>>>>>>        //AB-StoreStart
39134>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39135>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39136>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39137>>>>>>>>>        
39137>>>>>>>>>        
39137>>>>>>>>>        
39137>>>>>>>>>        
39137>>>>>>>>>        
39137>>>>>>>>>        //AB-StoreEnd
39137>>>>>>>>>
39137>>>>>>>>>    End_Object    // sl197
39138>>>>>>>>>
39138>>>>>>>>>//AB/     End_Object    // prj
39138>>>>>>>
39138>>>>>>>//DDB-Selection-pkg-End
39138>>>>>>>//DDB-FileEnd
39138>>>>>    
39138>>>>>    //AB-IgnoreEnd
39138>>>>>
39138>>>>>    Object sl041 is a dbModalPanelSub
39140>>>>>
39140>>>>>        //AB-StoreTopStart
39140>>>>>        Property String FragmaClient_ID Public ''
39142>>>>>        
39142>>>>>        //AB-StoreTopEnd
39142>>>>>
39142>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
39143>>>>>        Set Size to 249 500
39144>>>>>        Set Location to 2 6
39145>>>>>        Set Exit_Application_Local_State to FALSE
39146>>>>>        Set Modal_State to FALSE
39147>>>>>
39147>>>>>        //AB-DDOStart
39147>>>>>
39147>>>>>        Object Clients_DD is a Clients_DataDictionary
39149>>>>>
39149>>>>>            //AB-StoreStart
39149>>>>>                                                                                                                                                                                                                                        
39149>>>>>                                                                                                                                                                                                                                        
39149>>>>>                                                                                                                                                                                                                                        
39149>>>>>            //AB-StoreEnd
39149>>>>>
39149>>>>>        End_Object    // Clients_DD
39150>>>>>
39150>>>>>        Object Cn_DD is a Cn_DataDictionary
39152>>>>>            Set DDO_Server to (Clients_DD(self))
39153>>>>>
39153>>>>>            //AB-StoreStart
39153>>>>>                                            
39153>>>>>            Begin_Constraints
39155>>>>>                String sID
39156>>>>>                Get FragmaClient_ID to sID
39157>>>>>                If (sID<>'') begin
39159>>>>>                    set ordering to 4
39160>>>>>                    Constrain CN.Client_ID eq sID
39162>>>>>                end
39162>>>>>>
39162>>>>>                ELSE SET ORDERING TO -1
39164>>>>>            End_Constraints
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            
39167>>>>>            //AB-StoreEnd
39167>>>>>
39167>>>>>        End_Object    // Cn_DD
39168>>>>>
39168>>>>>        Set Main_DD to (Cn_DD(self))
39169>>>>>        Set Server to (Cn_DD(self))
39170>>>>>
39170>>>>>        //AB-DDOEnd
39170>>>>>
39170>>>>>        Object oSelList is a dbListSub
39172>>>>>            Set Main_File to Cn.File_Number
39173>>>>>            Set Ordering to 4
39174>>>>>            Set Size to 209 481
39175>>>>>            Set Location to 6 6
39176>>>>>            Set Auto_Index_State to FALSE
39177>>>>>
39177>>>>>            Begin_Row
39180>>>>>                Entry_Item Cn.Cn_code
39181>>>>>                Entry_Item Cn.Cn_descr
39182>>>>>                Entry_Item Cn.Client_id
39183>>>>>                Entry_Item Clients.Client_name
39184>>>>>                Entry_Item Cn.Cn_active
39185>>>>>            End_Row
39190>>>>>
39190>>>>>            Set Form_Width    item 0 to 61
39191>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
39192>>>>>            
39192>>>>>            Set Form_Width    item 1 to 185
39193>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
39194>>>>>            
39194>>>>>            Set Form_Width    item 2 to 60
39195>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
39196>>>>>            
39196>>>>>            Set Form_Width    item 3 to 123
39197>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
39198>>>>>            
39198>>>>>            Set Form_Width    item 4 to 44
39199>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
39200>>>>>            Set Column_Checkbox_State  item 4 to True
39201>>>>>            
39201>>>>>
39201>>>>>            //AB-StoreStart
39201>>>>>                                            
39201>>>>>            Property String StoreFragmaClient_ID Public ''
39203>>>>>            
39203>>>>>            Procedure Store_Defaults
39205>>>>>                   Forward Send Store_Defaults
39207>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
39208>>>>>            End_Procedure
39209>>>>>            
39209>>>>>            Procedure ReStore_Defaults
39211>>>>>                   Forward Send ReStore_Defaults
39213>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
39214>>>>>            End_Procedure
39215>>>>>            
39215>>>>>            Procedure Activating Returns Integer
39217>>>>>                Integer rVal
39218>>>>>                Forward Get Msg_Activating to rVal
39220>>>>>                set auto_index_state to true
39221>>>>>                SET ORDERING TO -1
39222>>>>>                Procedure_Return rVal
39223>>>>>            End_Procedure
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            
39224>>>>>            //AB-StoreEnd
39224>>>>>
39224>>>>>        End_Object    // oSelList
39225>>>>>
39225>>>>>        Object oOK_bn is a ButtonSub
39227>>>>>            Set Label to "&„§ ¢¦šã"
39228>>>>>            Set Location to 219 327
39229>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39230>>>>>
39230>>>>>            //AB-StoreStart
39230>>>>>            Procedure OnClick
39232>>>>>                Send OK To (oSelList(current_object))
39233>>>>>            End_Procedure
39234>>>>>            //AB-StoreEnd
39234>>>>>
39234>>>>>        End_Object    // oOK_bn
39235>>>>>
39235>>>>>        Object oCancel_bn is a ButtonSub
39237>>>>>            Set Label to "&€¡ç¨à©ž"
39238>>>>>            Set Location to 219 383
39239>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39240>>>>>
39240>>>>>            //AB-StoreStart
39240>>>>>            Procedure OnClick
39242>>>>>                Send Cancel To (oSelList(current_object))
39243>>>>>            End_Procedure
39244>>>>>            //AB-StoreEnd
39244>>>>>
39244>>>>>        End_Object    // oCancel_bn
39245>>>>>
39245>>>>>        Object oSearch_bn is a ButtonSub
39247>>>>>            Set Label to "€&¤˜ã«ž©ž"
39248>>>>>            Set Location to 219 437
39249>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39250>>>>>
39250>>>>>            //AB-StoreStart
39250>>>>>            Procedure OnClick
39252>>>>>                Send Search To (oSelList(current_object))
39253>>>>>            End_Procedure
39254>>>>>            //AB-StoreEnd
39254>>>>>
39254>>>>>        End_Object    // oSearch_bn
39255>>>>>
39255>>>>>
39255>>>>>        //AB-StoreStart
39255>>>>>                        
39255>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39256>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39257>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39258>>>>>        Set Modal_State to True
39259>>>>>        Procedure Activating Returns Integer
39261>>>>>            Integer rVal
39262>>>>>            Forward Get Msg_Activating to rVal
39264>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
39265>>>>>            Send Beginning_Of_Data to oSelList
39266>>>>>            Procedure_Return rVal
39267>>>>>        End_Procedure
39268>>>>>        
39268>>>>>        procedure page integer pagemode
39270>>>>>            forward send page pagemode
39272>>>>>            set location to 40,40
39273>>>>>        end_procedure
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        
39274>>>>>        //AB-StoreEnd
39274>>>>>
39274>>>>>    End_Object    // sl041
39275>>>>>
39275>>>>>//AB/     End_Object    // prj
39275>>>
39275>>>Use bpEnCmv3.dg // Business Process Finilizing Barticle
INCLUDING FILE: BPENCMV3.DG
39275>>>>>//AB/ Project bpencmv3
39275>>>>>//AB/     Object prj is a Dialog_Project
39275>>>>>//AB/         Set ProjectName to "bpencmv3"
39275>>>>>//AB/         Set ProjectFileName to "bpencmv3.DG"
39275>>>>>
39275>>>>>// Project Object Structure
39275>>>>>//   bpencmv3 is a BusinessProcessSub
39275>>>>>//     Ctypkin_DD is a DataDictionary
39275>>>>>//     Country_DD is a DataDictionary
39275>>>>>//     Towns_DD is a DataDictionary
39275>>>>>//     Cities_DD is a DataDictionary
39275>>>>>//     Payresp_DD is a DataDictionary
39275>>>>>//     Areas_DD is a DataDictionary
39275>>>>>//     Clients_DD is a DataDictionary
39275>>>>>//     Cmoves_DD is a DataDictionary
39275>>>>>//     Cflagkin_DD is a DataDictionary
39275>>>>>//     Btypkin_DD is a DataDictionary
39275>>>>>//     Baxiokat_DD is a DataDictionary
39275>>>>>//     Barticl_DD is a DataDictionary
39275>>>>>//     Baxio_DD is a DataDictionary
39275>>>>>//     Bmove_DD is a DataDictionary
39275>>>>>//     Nomisma_DD is a DataDictionary
39275>>>>>
39275>>>>>// Register all objects
39275>>>>>Register_Object Areas_DD
39275>>>>>Register_Object Barticl_DD
39275>>>>>Register_Object Baxio_DD
39275>>>>>Register_Object Baxiokat_DD
39275>>>>>Register_Object Bmove_DD
39275>>>>>Register_Object Btypkin_DD
39275>>>>>Register_Object bpencmv3
39275>>>>>Register_Object Cflagkin_DD
39275>>>>>Register_Object Cities_DD
39275>>>>>Register_Object Clients_DD
39275>>>>>Register_Object Cmoves_DD
39275>>>>>Register_Object Country_DD
39275>>>>>Register_Object Ctypkin_DD
39275>>>>>Register_Object Nomisma_DD
39275>>>>>Register_Object Payresp_DD
39275>>>>>Register_Object Towns_DD
39275>>>>>
39275>>>>>
39275>>>>>
39275>>>>>    //AB-StoreTopStart
39275>>>>>
39275>>>>>
39275>>>>>    //AB-StoreTopEnd
39275>>>>>
39275>>>>>    //AB-IgnoreStart
39275>>>>>
39275>>>>>    Use Bproces.Sub
39275>>>>>    Use DFAllEnt.pkg
39275>>>>>
39275>>>>>
39275>>>>>    Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
39275>>>>>>>//DDB-FileStart
39275>>>>>>>//DDB-HeaderStart
39275>>>>>>>
39275>>>>>>>// File Name : CTYPKIN.DD
39275>>>>>>>// Class Name: Ctypkin_DataDictionary
39275>>>>>>>// Revision  : 70
39275>>>>>>>// Version   : 2
39275>>>>>>>
39275>>>>>>>Use  Windows           // Basic Definitions
39275>>>>>>>Use  DataDict          // DataDictionary Class Definition
39275>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39275>>>>>>>
39275>>>>>>>Open Ctypkin
INCLUDING FILE: CTYPKIN.FD
39277>>>>>>>Open Cmoves
39279>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
39281>>>>>>>Open Ptypparl
39283>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
39285>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
39287>>>>>>>Open Cmovesa
39289>>>>>>>Open Sysrecc
39291>>>>>>>Open Syscurxr
39293>>>>>>>
39293>>>>>>>//DDB-HeaderEnd
39293>>>>>>>//DDB-ValidationStart
39293>>>>>>>
39293>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
39293>>>>>>>
39293>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
39295>>>>>>>    Set Type_Value        To "MODULE"
39296>>>>>>>    //DDB-ValidationCustomStart
39296>>>>>>>    //DDB-ValidationCustomEnd
39296>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
39297>>>>>>>//DDB-ValidationEnd
39297>>>>>>>//DDB-SelectionStart
39297>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
39297>>>>>>>Register_Object sl007
39297>>>>>>>//DDB-SelectionEnd
39297>>>>>>>
39297>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
39298>>>>>>>         
39298>>>>>>>    Procedure Construct_Object
39299>>>>>>>        Forward Send Construct_Object
39301>>>>>>>        Property Integer piMustNOTConstrain Public 0
39302>>>>>>>    End_Procedure
39303>>>>>>>
39303>>>>>>>    Procedure Save_Main_File
39304>>>>>>>        If (Operation_Origin<>Self) Begin
39306>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
39309>>>>>>>        End
39309>>>>>>>>
39309>>>>>>>        Forward Send Save_Main_File
39311>>>>>>>    End_Procedure
39312>>>>>>>
39312>>>>>>>     Procedure Creating
39313>>>>>>>        Forward Send Creating
39315>>>>>>>        // Insert Code Here
39315>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
39316>>>>>>>    End_Procedure   // Creating
39317>>>>>>>
39317>>>>>>>
39317>>>>>>>    // Define_Fields:
39317>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39317>>>>>>>
39317>>>>>>>    Procedure Define_Fields
39318>>>>>>>        Forward Send Define_Fields
39320>>>>>>>        //DDB-Generated-Code-Location
39320>>>>>>>        //DDB-DefineFieldStart
39320>>>>>>>
39320>>>>>>>        Set Main_File            To Ctypkin.File_Number
39321>>>>>>>        Set Cascade_Delete_State To FALSE
39322>>>>>>>
39322>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39323>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39324>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39325>>>>>>>
39325>>>>>>>        // Child (Client) file structure................
39325>>>>>>>        Send Add_Client_File  Cmoves.File_Number
39326>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
39327>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
39328>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39329>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
39330>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
39331>>>>>>>
39331>>>>>>>        // External (System) file structure.............
39331>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39332>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39333>>>>>>>
39333>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
39336>>>>>>>
39336>>>>>>>        // Field-based properties.......................
39336>>>>>>>
39336>>>>>>>        // Ctypkin.Company_Code
39336>>>>>>>
39336>>>>>>>        // Ctypkin.Branch_Code
39336>>>>>>>
39336>>>>>>>        // Ctypkin.Year_Year
39336>>>>>>>
39336>>>>>>>        // Ctypkin.Ctypkin_Code
39336>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
39337>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
39338>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
39339>>>>>>>
39339>>>>>>>        // Ctypkin.Ctypkin_Rec0
39339>>>>>>>
39339>>>>>>>        // Ctypkin.Ctypkin_Recr
39339>>>>>>>
39339>>>>>>>        // Ctypkin.Year_Recr
39339>>>>>>>
39339>>>>>>>        // Ctypkin.Ctypkin_Descr
39339>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
39340>>>>>>>
39340>>>>>>>        // Ctypkin.Ctypkin_Anti
39340>>>>>>>
39340>>>>>>>        // Ctypkin.Ctypkin_Flags
39340>>>>>>>
39340>>>>>>>        // Ctypkin.Ctypkin_Module
39340>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
39341>>>>>>>
39341>>>>>>>        // Ctypkin.Open_Item
39341>>>>>>>
39341>>>>>>>        // Ctypkin.Check_Overhead
39341>>>>>>>
39341>>>>>>>        // Ctypkin.Max_Days_Sx_Par
39341>>>>>>>
39341>>>>>>>        // Ctypkin.Singular
39341>>>>>>>
39341>>>>>>>        // Ctypkin.Sub
39341>>>>>>>
39341>>>>>>>        // Ctypkin.Subreport
39341>>>>>>>
39341>>>>>>>        //DDB-DefineFieldEnd
39341>>>>>>>    End_Procedure    // Define_Fields
39342>>>>>>>
39342>>>>>>>    // Field_Defaults:
39342>>>>>>>    // This procedure is used to establish default field values.
39342>>>>>>>
39342>>>>>>>    Procedure Field_Defaults
39343>>>>>>>        Forward Send Field_Defaults
39345>>>>>>>        //DDB-Generated-Code-Location
39345>>>>>>>        //DDB-FieldDefaultStart
39345>>>>>>>        //DDB-FieldDefaultEnd
39345>>>>>>>    End_Procedure    // Field_Defaults
39346>>>>>>>
39346>>>>>>>End_Class    // Ctypkin_DataDictionary
39347>>>>>>>//DDB-Selection-pkg-Start
39347>>>>>>>
39347>>>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
39347>>>>>>>>>//AB/ Project Ctypkin : sl007
39347>>>>>>>>>//AB/ Object prj is a Lookup_Project
39347>>>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
39347>>>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
39347>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39347>>>>>>>>>
39347>>>>>>>>>// Project Object Structure
39347>>>>>>>>>//   sl007 is a dbModalPanelSub
39347>>>>>>>>>//     Ctypkin_DD is a DataDictionary
39347>>>>>>>>>//     oSelList is a dbListSub
39347>>>>>>>>>//     oOK_bn is a ButtonSub
39347>>>>>>>>>//     oCancel_bn is a ButtonSub
39347>>>>>>>>>//     oSearch_bn is a ButtonSub
39347>>>>>>>>>
39347>>>>>>>>>// Register all objects
39347>>>>>>>>>Register_Object Ctypkin_DD
39347>>>>>>>>>Register_Object oCancel_bn
39347>>>>>>>>>Register_Object oOK_bn
39347>>>>>>>>>Register_Object oSearch_bn
39347>>>>>>>>>Register_Object oSelList
39347>>>>>>>>>Register_Object sl007
39347>>>>>>>>>
39347>>>>>>>>>
39347>>>>>>>>>//AB-IgnoreStart
39347>>>>>>>>>
39347>>>>>>>>>Use DFAllEnt.pkg
39347>>>>>>>>>Use dbList.Sub
39347>>>>>>>>>Use Button.Sub
39347>>>>>>>>>
39347>>>>>>>>>
39347>>>>>>>>>Use CTYPKIN.DD
39347>>>>>>>>>
39347>>>>>>>>>//AB-IgnoreEnd
39347>>>>>>>>>
39347>>>>>>>>>Object sl007 is a dbModalPanelSub
39349>>>>>>>>>
39349>>>>>>>>>    //AB-StoreTopStart
39349>>>>>>>>>    Property String psModule Public ''
39351>>>>>>>>>    
39351>>>>>>>>>    //AB-StoreTopEnd
39351>>>>>>>>>
39351>>>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
39352>>>>>>>>>    Set Size to 148 350
39353>>>>>>>>>    Set Location to 4 7
39354>>>>>>>>>    Set Exit_Application_Local_State to FALSE
39355>>>>>>>>>    Set Modal_State to FALSE
39356>>>>>>>>>
39356>>>>>>>>>    //AB-DDOStart
39356>>>>>>>>>
39356>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39358>>>>>>>>>
39358>>>>>>>>>        //AB-StoreStart
39358>>>>>>>>>                                
39358>>>>>>>>>        Begin_Constraints
39360>>>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
39364>>>>>>>>>        End_Constraints
39367>>>>>>>>>        
39367>>>>>>>>>        
39367>>>>>>>>>        
39367>>>>>>>>>        
39367>>>>>>>>>        //AB-StoreEnd
39367>>>>>>>>>
39367>>>>>>>>>    End_Object    // Ctypkin_DD
39368>>>>>>>>>
39368>>>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
39369>>>>>>>>>    Set Server to (Ctypkin_DD(self))
39370>>>>>>>>>
39370>>>>>>>>>    //AB-DDOEnd
39370>>>>>>>>>
39370>>>>>>>>>    Object oSelList is a dbListSub
39372>>>>>>>>>        Set Main_File to Ctypkin.File_Number
39373>>>>>>>>>        Set Size to 105 335
39374>>>>>>>>>        Set Location to 6 6
39375>>>>>>>>>
39375>>>>>>>>>        Begin_Row
39378>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
39379>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39380>>>>>>>>>        End_Row
39385>>>>>>>>>
39385>>>>>>>>>        Set Form_Width    item 0 to 71
39386>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
39387>>>>>>>>>        
39387>>>>>>>>>        Set Form_Width    item 1 to 255
39388>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
39389>>>>>>>>>        
39389>>>>>>>>>
39389>>>>>>>>>        //AB-StoreStart
39389>>>>>>>>>                    
39389>>>>>>>>>                    
39389>>>>>>>>>        Procedure Activate
39391>>>>>>>>>            Forward Send Activate
39393>>>>>>>>>            Send Beginning_Of_Data to oSelList True
39394>>>>>>>>>        End_Procedure
39395>>>>>>>>>        
39395>>>>>>>>>        
39395>>>>>>>>>        
39395>>>>>>>>>        
39395>>>>>>>>>        //AB-StoreEnd
39395>>>>>>>>>
39395>>>>>>>>>    End_Object    // oSelList
39396>>>>>>>>>
39396>>>>>>>>>    Object oOK_bn is a ButtonSub
39398>>>>>>>>>        Set Label to "&„§ ¢¦šã"
39399>>>>>>>>>        Set Location to 113 171
39400>>>>>>>>>
39400>>>>>>>>>        //AB-StoreStart
39400>>>>>>>>>        Procedure OnClick
39402>>>>>>>>>            Send OK To (oSelList(current_object))
39403>>>>>>>>>        End_Procedure
39404>>>>>>>>>        //AB-StoreEnd
39404>>>>>>>>>
39404>>>>>>>>>    End_Object    // oOK_bn
39405>>>>>>>>>
39405>>>>>>>>>    Object oCancel_bn is a ButtonSub
39407>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
39408>>>>>>>>>        Set Location to 113 226
39409>>>>>>>>>
39409>>>>>>>>>        //AB-StoreStart
39409>>>>>>>>>        Procedure OnClick
39411>>>>>>>>>            Send Cancel To (oSelList(current_object))
39412>>>>>>>>>        End_Procedure
39413>>>>>>>>>        //AB-StoreEnd
39413>>>>>>>>>
39413>>>>>>>>>    End_Object    // oCancel_bn
39414>>>>>>>>>
39414>>>>>>>>>    Object oSearch_bn is a ButtonSub
39416>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39417>>>>>>>>>        Set Location to 113 281
39418>>>>>>>>>
39418>>>>>>>>>        //AB-StoreStart
39418>>>>>>>>>        Procedure OnClick
39420>>>>>>>>>            Send Search To (oSelList(current_object))
39421>>>>>>>>>        End_Procedure
39422>>>>>>>>>        //AB-StoreEnd
39422>>>>>>>>>
39422>>>>>>>>>    End_Object    // oSearch_bn
39423>>>>>>>>>
39423>>>>>>>>>
39423>>>>>>>>>    //AB-StoreStart
39423>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39424>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39425>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39426>>>>>>>>>    
39426>>>>>>>>>    Procedure Activate Returns Integer
39428>>>>>>>>>        Integer rVal
39429>>>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
39430>>>>>>>>>        Forward Get Msg_Activate to rVal
39432>>>>>>>>>        Procedure_Return rVal
39433>>>>>>>>>    End_Procedure
39434>>>>>>>>>    
39434>>>>>>>>>    //AB-StoreEnd
39434>>>>>>>>>
39434>>>>>>>>>End_Object    // sl007
39435>>>>>>>>>
39435>>>>>>>>>//AB/ End_Object    // prj
39435>>>>>>>
39435>>>>>>>//DDB-Selection-pkg-End
39435>>>>>>>//DDB-FileEnd
39435>>>>>    Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
39435>>>>>>>//DDB-FileStart
39435>>>>>>>//DDB-HeaderStart
39435>>>>>>>
39435>>>>>>>// File Name : COUNTRY.DD
39435>>>>>>>// Class Name: Country_DataDictionary
39435>>>>>>>// Revision  : 3
39435>>>>>>>// Version   : 2
39435>>>>>>>
39435>>>>>>>Use  Windows           // Basic Definitions
39435>>>>>>>Use  DataDict          // DataDictionary Class Definition
39435>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39435>>>>>>>
39435>>>>>>>Open Country
39437>>>>>>>Open Towns
39439>>>>>>>
39439>>>>>>>//DDB-HeaderEnd
39439>>>>>>>//DDB-SelectionStart
39439>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
39439>>>>>>>Register_Object sl058
39439>>>>>>>//DDB-SelectionEnd
39439>>>>>>>
39439>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
39440>>>>>>>
39440>>>>>>>    // Define_Fields:
39440>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39440>>>>>>>
39440>>>>>>>    Procedure Define_Fields
39441>>>>>>>        Forward Send Define_Fields
39443>>>>>>>        //DDB-Generated-Code-Location
39443>>>>>>>        //DDB-DefineFieldStart
39443>>>>>>>
39443>>>>>>>        Set Main_File            To Country.File_Number
39444>>>>>>>        Set Cascade_Delete_State To FALSE
39445>>>>>>>
39445>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39446>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39447>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39448>>>>>>>
39448>>>>>>>        // Child (Client) file structure................
39448>>>>>>>        Send Add_Client_File  Towns.File_Number
39449>>>>>>>
39449>>>>>>>        // Field-based properties.......................
39449>>>>>>>
39449>>>>>>>        // Country.Country_Id
39449>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
39450>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
39451>>>>>>>
39451>>>>>>>        // Country.Country_Descr
39451>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
39452>>>>>>>
39452>>>>>>>        //DDB-DefineFieldEnd
39452>>>>>>>    End_Procedure    // Define_Fields
39453>>>>>>>
39453>>>>>>>    // Field_Defaults:
39453>>>>>>>    // This procedure is used to establish default field values.
39453>>>>>>>
39453>>>>>>>    Procedure Field_Defaults
39454>>>>>>>        Forward Send Field_Defaults
39456>>>>>>>        //DDB-Generated-Code-Location
39456>>>>>>>        //DDB-FieldDefaultStart
39456>>>>>>>        //DDB-FieldDefaultEnd
39456>>>>>>>    End_Procedure    // Field_Defaults
39457>>>>>>>
39457>>>>>>>End_Class    // Country_DataDictionary
39458>>>>>>>//DDB-Selection-pkg-Start
39458>>>>>>>
39458>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
39458>>>>>>>>>//AB/ Project sl058 : Countries - Xores
39458>>>>>>>>>//AB/     Object prj is a Lookup_Project
39458>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
39458>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
39458>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39458>>>>>>>>>
39458>>>>>>>>>// Project Object Structure
39458>>>>>>>>>//   sl058 is a dbModalPanelSub
39458>>>>>>>>>//     Country_DD is a DataDictionary
39458>>>>>>>>>//     oSelList is a dbListSub
39458>>>>>>>>>//     oOK_bn is a ButtonSub
39458>>>>>>>>>//     oCancel_bn is a ButtonSub
39458>>>>>>>>>//     oSearch_bn is a ButtonSub
39458>>>>>>>>>
39458>>>>>>>>>// Register all objects
39458>>>>>>>>>Register_Object Country_DD
39458>>>>>>>>>Register_Object oCancel_bn
39458>>>>>>>>>Register_Object oOK_bn
39458>>>>>>>>>Register_Object oSearch_bn
39458>>>>>>>>>Register_Object oSelList
39458>>>>>>>>>Register_Object sl058
39458>>>>>>>>>
39458>>>>>>>>>
39458>>>>>>>>>    //AB-IgnoreStart
39458>>>>>>>>>
39458>>>>>>>>>    Use DFAllEnt.pkg
39458>>>>>>>>>    Use dbList.Sub
39458>>>>>>>>>    Use Button.Sub
39458>>>>>>>>>
39458>>>>>>>>>
39458>>>>>>>>>    Use Country.DD
39458>>>>>>>>>    
39458>>>>>>>>>    //AB-IgnoreEnd
39458>>>>>>>>>
39458>>>>>>>>>    Object sl058 is a dbModalPanelSub
39460>>>>>>>>>        Set Label to "•é¨œª"
39461>>>>>>>>>        Set Size to 148 297
39462>>>>>>>>>        Set Location to 6 10
39463>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39464>>>>>>>>>        Set Modal_State to FALSE
39465>>>>>>>>>
39465>>>>>>>>>        //AB-DDOStart
39465>>>>>>>>>
39465>>>>>>>>>        Object Country_DD is a Country_DataDictionary
39467>>>>>>>>>        End_Object    // Country_DD
39468>>>>>>>>>
39468>>>>>>>>>        Set Main_DD to (Country_DD(self))
39469>>>>>>>>>        Set Server to (Country_DD(self))
39470>>>>>>>>>
39470>>>>>>>>>        //AB-DDOEnd
39470>>>>>>>>>
39470>>>>>>>>>        Object oSelList is a dbListSub
39472>>>>>>>>>            Set Main_File to Country.File_Number
39473>>>>>>>>>            Set Size to 105 280
39474>>>>>>>>>            Set Location to 6 6
39475>>>>>>>>>
39475>>>>>>>>>            Begin_Row
39478>>>>>>>>>                Entry_Item Country.Country_id
39479>>>>>>>>>                Entry_Item Country.Country_descr
39480>>>>>>>>>            End_Row
39485>>>>>>>>>
39485>>>>>>>>>            Set Form_Width    item 0 to 87
39486>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
39487>>>>>>>>>            
39487>>>>>>>>>            Set Form_Width    item 1 to 183
39488>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39489>>>>>>>>>            
39489>>>>>>>>>        End_Object    // oSelList
39490>>>>>>>>>
39490>>>>>>>>>        Object oOK_bn is a ButtonSub
39492>>>>>>>>>            Set Label to "&„§ ¢¦šã"
39493>>>>>>>>>            Set Location to 115 126
39494>>>>>>>>>
39494>>>>>>>>>            //AB-StoreStart
39494>>>>>>>>>            Procedure OnClick
39496>>>>>>>>>                Send OK To (oSelList(current_object))
39497>>>>>>>>>            End_Procedure
39498>>>>>>>>>            //AB-StoreEnd
39498>>>>>>>>>
39498>>>>>>>>>        End_Object    // oOK_bn
39499>>>>>>>>>
39499>>>>>>>>>        Object oCancel_bn is a ButtonSub
39501>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
39502>>>>>>>>>            Set Location to 115 181
39503>>>>>>>>>
39503>>>>>>>>>            //AB-StoreStart
39503>>>>>>>>>            Procedure OnClick
39505>>>>>>>>>                Send Cancel To (oSelList(current_object))
39506>>>>>>>>>            End_Procedure
39507>>>>>>>>>            //AB-StoreEnd
39507>>>>>>>>>
39507>>>>>>>>>        End_Object    // oCancel_bn
39508>>>>>>>>>
39508>>>>>>>>>        Object oSearch_bn is a ButtonSub
39510>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
39511>>>>>>>>>            Set Location to 115 236
39512>>>>>>>>>
39512>>>>>>>>>            //AB-StoreStart
39512>>>>>>>>>            Procedure OnClick
39514>>>>>>>>>                Send Search To (oSelList(current_object))
39515>>>>>>>>>            End_Procedure
39516>>>>>>>>>            //AB-StoreEnd
39516>>>>>>>>>
39516>>>>>>>>>        End_Object    // oSearch_bn
39517>>>>>>>>>
39517>>>>>>>>>
39517>>>>>>>>>        //AB-StoreStart
39517>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39518>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39519>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39520>>>>>>>>>        //AB-StoreEnd
39520>>>>>>>>>
39520>>>>>>>>>    End_Object    // sl058
39521>>>>>>>>>
39521>>>>>>>>>//AB/     End_Object    // prj
39521>>>>>>>
39521>>>>>>>//DDB-Selection-pkg-End
39521>>>>>>>//DDB-FileEnd
39521>>>>>    Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
39521>>>>>>>//DDB-FileStart
39521>>>>>>>//DDB-HeaderStart
39521>>>>>>>
39521>>>>>>>// File Name : TOWNS.DD
39521>>>>>>>// Class Name: Towns_DataDictionary
39521>>>>>>>// Revision  : 8
39521>>>>>>>// Version   : 2
39521>>>>>>>
39521>>>>>>>Use  Windows           // Basic Definitions
39521>>>>>>>Use  DataDict          // DataDictionary Class Definition
39521>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39521>>>>>>>
39521>>>>>>>Open Towns
39523>>>>>>>Open Cities
39525>>>>>>>Open Country
39527>>>>>>>
39527>>>>>>>//DDB-HeaderEnd
39527>>>>>>>//DDB-SelectionStart
39527>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
39527>>>>>>>Register_Object sl057
39527>>>>>>>//DDB-SelectionEnd
39527>>>>>>>
39527>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
39528>>>>>>>
39528>>>>>>>    Procedure Save_Main_File
39529>>>>>>>        If (Operation_Origin<>Self) Begin
39531>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
39534>>>>>>>        End
39534>>>>>>>>
39534>>>>>>>        Forward Send Save_Main_File
39536>>>>>>>    End_Procedure
39537>>>>>>>
39537>>>>>>>
39537>>>>>>>    // Define_Fields:
39537>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39537>>>>>>>
39537>>>>>>>    Procedure Define_Fields
39538>>>>>>>        Forward Send Define_Fields
39540>>>>>>>        //DDB-Generated-Code-Location
39540>>>>>>>        //DDB-DefineFieldStart
39540>>>>>>>
39540>>>>>>>        Set Main_File            To Towns.File_Number
39541>>>>>>>        Set Cascade_Delete_State To FALSE
39542>>>>>>>
39542>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39543>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
39544>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
39545>>>>>>>
39545>>>>>>>        // Child (Client) file structure................
39545>>>>>>>        Send Add_Client_File  Cities.File_Number
39546>>>>>>>
39546>>>>>>>        // Parent (Server) file structure...............
39546>>>>>>>        Send Add_Server_File  Country.File_Number
39547>>>>>>>
39547>>>>>>>        // Field-based properties.......................
39547>>>>>>>
39547>>>>>>>        // Towns.Country_Id
39547>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
39548>>>>>>>
39548>>>>>>>        // Towns.Town_Id
39548>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
39549>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
39550>>>>>>>
39550>>>>>>>        // Towns.Town_Descr
39550>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
39551>>>>>>>
39551>>>>>>>        //DDB-DefineFieldEnd
39551>>>>>>>    End_Procedure    // Define_Fields
39552>>>>>>>
39552>>>>>>>    // Field_Defaults:
39552>>>>>>>    // This procedure is used to establish default field values.
39552>>>>>>>
39552>>>>>>>    Procedure Field_Defaults
39553>>>>>>>        Forward Send Field_Defaults
39555>>>>>>>        //DDB-Generated-Code-Location
39555>>>>>>>        //DDB-FieldDefaultStart
39555>>>>>>>        //DDB-FieldDefaultEnd
39555>>>>>>>    End_Procedure    // Field_Defaults
39556>>>>>>>
39556>>>>>>>End_Class    // Towns_DataDictionary
39557>>>>>>>//DDB-Selection-pkg-Start
39557>>>>>>>
39557>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
39557>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
39557>>>>>>>>>//AB/     Object prj is a Lookup_Project
39557>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
39557>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
39557>>>>>>>>>
39557>>>>>>>>>// Project Object Structure
39557>>>>>>>>>//   sl057 is a dbModalPanelSub
39557>>>>>>>>>//     Country_DD is a DataDictionary
39557>>>>>>>>>//     Towns_DD is a DataDictionary
39557>>>>>>>>>//     oSelList is a dbListSub
39557>>>>>>>>>//     oOK_bn is a ButtonSub
39557>>>>>>>>>//     oCancel_bn is a ButtonSub
39557>>>>>>>>>//     oSearch_bn is a ButtonSub
39557>>>>>>>>>
39557>>>>>>>>>// Register all objects
39557>>>>>>>>>Register_Object Country_DD
39557>>>>>>>>>Register_Object oCancel_bn
39557>>>>>>>>>Register_Object oOK_bn
39557>>>>>>>>>Register_Object oSearch_bn
39557>>>>>>>>>Register_Object oSelList
39557>>>>>>>>>Register_Object sl057
39557>>>>>>>>>Register_Object Towns_DD
39557>>>>>>>>>
39557>>>>>>>>>
39557>>>>>>>>>    //AB-IgnoreStart
39557>>>>>>>>>
39557>>>>>>>>>    Use DFAllEnt.pkg
39557>>>>>>>>>    Use dbList.Sub
39557>>>>>>>>>    Use Button.Sub
39557>>>>>>>>>
39557>>>>>>>>>
39557>>>>>>>>>    Use COUNTRY.DD
39557>>>>>>>>>    Use TOWNS.DD
39557>>>>>>>>>    
39557>>>>>>>>>    //AB-IgnoreEnd
39557>>>>>>>>>
39557>>>>>>>>>    Object sl057 is a dbModalPanelSub
39559>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
39560>>>>>>>>>        Set Size to 148 297
39561>>>>>>>>>        Set Location to 6 10
39562>>>>>>>>>        Set Exit_Application_Local_State to FALSE
39563>>>>>>>>>        Set Modal_State to FALSE
39564>>>>>>>>>
39564>>>>>>>>>        //AB-DDOStart
39564>>>>>>>>>
39564>>>>>>>>>        Object Country_DD is a Country_DataDictionary
39566>>>>>>>>>        End_Object    // Country_DD
39567>>>>>>>>>
39567>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
39569>>>>>>>>>            Set DDO_Server to (Country_DD(self))
39570>>>>>>>>>        End_Object    // Towns_DD
39571>>>>>>>>>
39571>>>>>>>>>        Set Main_DD to (Towns_DD(self))
39572>>>>>>>>>        Set Server to (Towns_DD(self))
39573>>>>>>>>>
39573>>>>>>>>>        //AB-DDOEnd
39573>>>>>>>>>
39573>>>>>>>>>        Object oSelList is a dbListSub
39575>>>>>>>>>            Set Main_File to Towns.File_Number
39576>>>>>>>>>            Set Size to 105 280
39577>>>>>>>>>            Set Location to 6 6
39578>>>>>>>>>
39578>>>>>>>>>            Begin_Row
39581>>>>>>>>>                Entry_Item Towns.Town_id
39582>>>>>>>>>                Entry_Item Towns.Town_descr
39583>>>>>>>>>                Entry_Item Country.Country_descr
39584>>>>>>>>>            End_Row
39589>>>>>>>>>
39589>>>>>>>>>            Set Form_Width    item 0 to 43
39590>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
39591>>>>>>>>>            
39591>>>>>>>>>            Set Form_Width    item 1 to 137
39592>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39593>>>>>>>>>            
39593>>>>>>>>>            Set Form_Width    item 2 to 94
39594>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
39595>>>>>>>>>            
39595>>>>>>>>>        End_Object    // oSelList
39596>>>>>>>>>
39596>>>>>>>>>        Object oOK_bn is a ButtonSub
39598>>>>>>>>>            Set Label to "&„§ ¢¦šã"
39599>>>>>>>>>            Set Location to 115 126
39600>>>>>>>>>
39600>>>>>>>>>            //AB-StoreStart
39600>>>>>>>>>            Procedure OnClick
39602>>>>>>>>>                Send OK To (oSelList(current_object))
39603>>>>>>>>>            End_Procedure
39604>>>>>>>>>            //AB-StoreEnd
39604>>>>>>>>>
39604>>>>>>>>>        End_Object    // oOK_bn
39605>>>>>>>>>
39605>>>>>>>>>        Object oCancel_bn is a ButtonSub
39607>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
39608>>>>>>>>>            Set Location to 115 181
39609>>>>>>>>>
39609>>>>>>>>>            //AB-StoreStart
39609>>>>>>>>>            Procedure OnClick
39611>>>>>>>>>                Send Cancel To (oSelList(current_object))
39612>>>>>>>>>            End_Procedure
39613>>>>>>>>>            //AB-StoreEnd
39613>>>>>>>>>
39613>>>>>>>>>        End_Object    // oCancel_bn
39614>>>>>>>>>
39614>>>>>>>>>        Object oSearch_bn is a ButtonSub
39616>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
39617>>>>>>>>>            Set Location to 115 236
39618>>>>>>>>>
39618>>>>>>>>>            //AB-StoreStart
39618>>>>>>>>>            Procedure OnClick
39620>>>>>>>>>                Send Search To (oSelList(current_object))
39621>>>>>>>>>            End_Procedure
39622>>>>>>>>>            //AB-StoreEnd
39622>>>>>>>>>
39622>>>>>>>>>        End_Object    // oSearch_bn
39623>>>>>>>>>
39623>>>>>>>>>
39623>>>>>>>>>        //AB-StoreStart
39623>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39624>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39625>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39626>>>>>>>>>        //AB-StoreEnd
39626>>>>>>>>>
39626>>>>>>>>>    End_Object    // sl057
39627>>>>>>>>>
39627>>>>>>>>>//AB/     End_Object    // prj
39627>>>>>>>
39627>>>>>>>//DDB-Selection-pkg-End
39627>>>>>>>//DDB-FileEnd
39627>>>>>    Use CITIES.DD
39627>>>>>    Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
39627>>>>>>>//DDB-FileStart
39627>>>>>>>//DDB-HeaderStart
39627>>>>>>>
39627>>>>>>>// File Name : PAYRESP.DD
39627>>>>>>>// Class Name: Payresp_DataDictionary
39627>>>>>>>// Revision  : 82
39627>>>>>>>// Version   : 2
39627>>>>>>>
39627>>>>>>>Use  Windows           // Basic Definitions
39627>>>>>>>Use  DataDict          // DataDictionary Class Definition
39627>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39627>>>>>>>
39627>>>>>>>Open Payresp
39629>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
39631>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
39633>>>>>>>Open Clients
39635>>>>>>>Open Sysrecc
39637>>>>>>>Open Gmove
39639>>>>>>>Open Sysrecg
39641>>>>>>>
39641>>>>>>>//DDB-HeaderEnd
39641>>>>>>>//DDB-ValidationStart
39641>>>>>>>
39641>>>>>>>Register_Object Payresp_Presp_Doy_VT
39641>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
39641>>>>>>>Register_Object Payresp_Feregios_VT
39641>>>>>>>
39641>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
39643>>>>>>>    Set Type_Value        To "DOY"
39644>>>>>>>    Set Allow_Blank_State To TRUE
39645>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
39646>>>>>>>    //DDB-ValidationCustomStart
39646>>>>>>>    //DDB-ValidationCustomEnd
39646>>>>>>>End_Object   // Payresp_Presp_Doy_VT
39647>>>>>>>
39647>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
39649>>>>>>>    Set Type_Value        To "VAT_STATUS"
39650>>>>>>>    Set Validate_State    To FALSE
39651>>>>>>>    Set Allow_Blank_State To TRUE
39652>>>>>>>    //DDB-ValidationCustomStart
39652>>>>>>>    //DDB-ValidationCustomEnd
39652>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
39653>>>>>>>
39653>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
39655>>>>>>>    Set Type_Value        To "FEREGIOS"
39656>>>>>>>    Set Allow_Blank_State To TRUE
39657>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
39658>>>>>>>    //DDB-ValidationCustomStart
39658>>>>>>>    //DDB-ValidationCustomEnd
39658>>>>>>>End_Object   // Payresp_Feregios_VT
39659>>>>>>>//DDB-ValidationEnd
39659>>>>>>>//DDB-SelectionStart
39659>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
39659>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
39659>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
39659>>>>>>>Register_Object sl111
39659>>>>>>>Register_Object sl198
39659>>>>>>>Register_Object sl197
39659>>>>>>>//DDB-SelectionEnd
39659>>>>>>>
39659>>>>>>>Open Year
39661>>>>>>>
39661>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
39662>>>>>>>
39662>>>>>>>    Procedure Construct_Object
39663>>>>>>>        Forward Send Construct_Object
39665>>>>>>>        Property Integer piCheckPlaf        Public 0
39666>>>>>>>        //------------------------------------------------
39666>>>>>>>        // Properties gia na kraththoun oi palies times
39666>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
39666>>>>>>>        // einai 1     js 03/12/2007
39666>>>>>>>        //------------------------------------------------
39666>>>>>>>        Property Integer piCreateNew            Public  0
39667>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
39668>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
39669>>>>>>>        Property String  psAud_Old_AFM          Public ""
39670>>>>>>>        Property String  psAud_Old_DOY          Public ""
39671>>>>>>>        Property String  psAud_Old_DOYN         Public ""
39672>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
39673>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
39674>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
39675>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
39676>>>>>>>        //------------------------------------------------
39676>>>>>>>
39676>>>>>>>    End_procedure
39677>>>>>>>
39677>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
39678>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
39680>>>>>>>        //------------------------------------------------
39680>>>>>>>        // Properties gia na kraththoun oi palies times
39680>>>>>>>        // ton pedion js 03/12/2007
39680>>>>>>>        //------------------------------------------------
39680>>>>>>>        Set psAud_Old_Pelaths      to Payresp.Presp_ID
39681>>>>>>>        Set psAud_Old_PelathsN     to Payresp.Presp_Name
39682>>>>>>>        Set psAud_Old_AFM          to Payresp.Presp_AFM
39683>>>>>>>        Set psAud_Old_DOY          to Payresp.Presp_Doy
39684>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Payresp.Presp_Doy))
39685>>>>>>>        Set piAud_Old_HPAL         to Payresp.Stoxos_IPAL
39686>>>>>>>        Set piAud_Old_HPSO         to Payresp.Stoxos_IPSO
39687>>>>>>>        Set psAud_Old_PartlRecr    to Payresp.Presp_Recr
39688>>>>>>>        Set psAud_Old_PmsRecr      to Payresp.Presp_Recr
39689>>>>>>>        //------------------------------------------------
39689>>>>>>>     End_Procedure   // New_Current_Record
39690>>>>>>>
39690>>>>>>>    Procedure Delete_Main_File
39691>>>>>>>        //---------------------------------------------
39691>>>>>>>        // Auditing / Katagrafh allagon
39691>>>>>>>        String  sUser sText sTime sMin sHour sSec
39692>>>>>>>        Date    dDate  Shmer
39692>>>>>>>        Integer iMin iHour iSec iLen
39692>>>>>>>        Sysdate dDate iHour iMin iSec
39696>>>>>>>        Move iHour  to sHour
39697>>>>>>>        Move iMin   to sMin
39698>>>>>>>        Move iSec   to sSec
39699>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
39703>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
39707>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
39711>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
39712>>>>>>>
39712>>>>>>>        // Auditing / Diagrafh
39712>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
39714>>>>>>>            Get fsLoginUserID to sUser
39715>>>>>>>            clear gmove
39716>>>>>>>            move syscurxr.company_code  to gmove.company_code
39717>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
39718>>>>>>>            move syscurxr.year_year     to gmove.year_year
39719>>>>>>>            move  3                     to gmove.gtypkin_code// Apo Clients
39720>>>>>>>            move ddate                  to gmove.garticl_hmnia
39721>>>>>>>            move suser                  to gmove.gplan_code
39722>>>>>>>            move Payresp.Presp_Recr    to gmove.garticl_recr
39723>>>>>>>            reread sysrecg
39727>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39728>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39729>>>>>>>            saverecord sysrecg
39730>>>>>>>            unlock
39731>>>>>>>>
39731>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
39732>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
39733>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
39734>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
39735>>>>>>>
39735>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
39736>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
39737>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
39738>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
39739>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
39740>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
39741>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
39742>>>>>>>
39742>>>>>>>
39742>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"     to gmove.gmove_aitiol
39743>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
39744>>>>>>>            saverecord gmove
39745>>>>>>>        End
39745>>>>>>>>
39745>>>>>>>        Forward Send Delete_Main_File
39747>>>>>>>
39747>>>>>>>    End_Procedure
39748>>>>>>>
39748>>>>>>>    Procedure Update
39749>>>>>>>        Forward Send Update
39751>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
39752>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
39753>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
39754>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
39754>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
39755>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
39756>>>>>>>
39756>>>>>>>        //betolink
39756>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
39757>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
39758>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
39759>>>>>>>
39759>>>>>>>        //---------------------------------------------
39759>>>>>>>        // Auditing / Katagrafh allagon
39759>>>>>>>        String  sUser sText sTime sMin sHour sSec
39760>>>>>>>        Date    dDate  Shmer
39760>>>>>>>        Integer iMin iHour iSec iLen
39760>>>>>>>        Sysdate dDate iHour iMin iSec
39764>>>>>>>        Move iHour  to sHour
39765>>>>>>>        Move iMin   to sMin
39766>>>>>>>        Move iSec   to sSec
39767>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
39771>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
39775>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
39779>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
39780>>>>>>>
39780>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
39780>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
39782>>>>>>>            Get fsLoginUserID to sUser
39783>>>>>>>            If (piCreateNew(Self)=1) Begin
39785>>>>>>>                clear gmove
39786>>>>>>>                move syscurxr.company_code  to gmove.company_code
39787>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
39788>>>>>>>                move syscurxr.year_year     to gmove.year_year
39789>>>>>>>                move  3                     to gmove.gtypkin_code// Apo Clients
39790>>>>>>>                move ddate                  to gmove.garticl_hmnia
39791>>>>>>>                move suser                  to gmove.gplan_code
39792>>>>>>>                move Payresp.Presp_Recr     to gmove.garticl_recr
39793>>>>>>>                reread sysrecg
39797>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39798>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39799>>>>>>>                saverecord sysrecg
39800>>>>>>>                unlock
39801>>>>>>>>
39801>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
39802>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
39803>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
39804>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
39805>>>>>>>                Move Payresp.Presp_ID               to Gmove.Cur_ID
39806>>>>>>>                Move Payresp.Presp_Name             to Gmove.Cur_Name
39807>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
39808>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
39809>>>>>>>                Move Payresp.Presp_AFM              to Gmove.Cur_AFM
39810>>>>>>>                Move Payresp.Presp_DOY              to Gmove.Cur_DOY
39811>>>>>>>                Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
39812>>>>>>>                Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
39813>>>>>>>                Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
39814>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤" to Gmove.Gmove_Aitiol
39815>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
39816>>>>>>>                saverecord gmove
39817>>>>>>>                Set piCreateNew to 0
39818>>>>>>>            End
39818>>>>>>>>
39818>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
39821>>>>>>>                Integer isChanged
39821>>>>>>>                Move 0 to isChanged
39822>>>>>>>                
39822>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Payresp.Presp_ID   ) Move 1 to isChanged
39825>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Payresp.Presp_Name ) Move 1 to isChanged
39829>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Payresp.Presp_AFM  ) Move 1 to isChanged
39833>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Payresp.Presp_DOY  ) Move 1 to isChanged
39837>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Payresp.Stoxos_IPAL) Move 1 to isChanged
39841>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Payresp.Stoxos_IPSO) Move 1 to isChanged
39845>>>>>>>                
39845>>>>>>>                If (isChanged>0) Begin  
39847>>>>>>>                    clear gmove
39848>>>>>>>                    move syscurxr.company_code  to gmove.company_code
39849>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
39850>>>>>>>                    move syscurxr.year_year     to gmove.year_year
39851>>>>>>>                    move  3                     to gmove.gtypkin_code// Apo Clients
39852>>>>>>>                    move ddate                  to gmove.garticl_hmnia
39853>>>>>>>                    move suser                  to gmove.gplan_code
39854>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
39855>>>>>>>                    reread sysrecg
39859>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
39860>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
39861>>>>>>>                    saverecord sysrecg
39862>>>>>>>                    unlock
39863>>>>>>>>
39863>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
39864>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
39865>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
39866>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
39867>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
39868>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
39869>>>>>>>                    //--
39869>>>>>>>                    Move Payresp.Presp_ID               to Gmove.Cur_ID
39870>>>>>>>                    Move Payresp.Presp_Name             to Gmove.Cur_Name
39871>>>>>>>                    Move Payresp.Presp_AFM              to Gmove.Cur_AFM
39872>>>>>>>                    Move Payresp.Presp_DOY              to Gmove.Cur_DOY
39873>>>>>>>                    Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
39874>>>>>>>                    Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
39875>>>>>>>                    Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
39876>>>>>>>                    //--
39876>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
39877>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
39878>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
39879>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
39880>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
39881>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
39882>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
39883>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"  to gmove.gmove_aitiol
39884>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
39885>>>>>>>                    saverecord gmove
39886>>>>>>>                    Set piCreateNew to 0
39887>>>>>>>                End
39887>>>>>>>>
39887>>>>>>>            End
39887>>>>>>>>
39887>>>>>>>        End
39887>>>>>>>>
39887>>>>>>>
39887>>>>>>>    End_Procedure   // Update
39888>>>>>>>
39888>>>>>>>     Procedure Creating
39889>>>>>>>        Forward Send Creating
39891>>>>>>>        // Insert Code Here
39891>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
39892>>>>>>>        Move '1'                    to payresp.presp_Active
39893>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
39894>>>>>>>        clear year
39895>>>>>>>        move syscurxr.branch_code   to year.branch_code
39896>>>>>>>        move syscurxr.company_code  to year.company_code
39897>>>>>>>        move syscurxr.year_year     to YEAR.year_year
39898>>>>>>>        find eq year by index.1
39899>>>>>>>>
39899>>>>>>>        if (found=1) begin
39901>>>>>>>            move year.payresp_plafon to payresp.plafon
39902>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
39903>>>>>>>        end
39903>>>>>>>>
39903>>>>>>>        Set piCreateNew to 1
39904>>>>>>>    End_Procedure   // Creating
39905>>>>>>>
39905>>>>>>>   Function Validate_Save  Returns Integer
39906>>>>>>>        Integer iReturnVal iCheck iYes
39907>>>>>>>        Forward Get Validate_Save  To iReturnVal
39909>>>>>>>        If (Not(iReturnVal)) Begin
39911>>>>>>>
39911>>>>>>>            If (Sysfile.Check_Afm=1) Begin
39913>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
39914>>>>>>>                If (iCheck) Begin
39916>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
39919>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
39923>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
39927>>>>>>>                End
39927>>>>>>>>
39927>>>>>>>            End
39927>>>>>>>>
39927>>>>>>>
39927>>>>>>>           If (piCheckPlaf(Self)=1) Begin
39929>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
39931>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
39932>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
39935>>>>>>>                End
39935>>>>>>>>
39935>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
39938>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
39939>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
39942>>>>>>>                End
39942>>>>>>>>
39942>>>>>>>           End
39942>>>>>>>>
39942>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
39945>>>>>>>        End
39945>>>>>>>>
39945>>>>>>>        Function_Return iReturnVal
39946>>>>>>>    End_Function   // Validate_Save
39947>>>>>>>
39947>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39948>>>>>>>        String lsError_Message
39949>>>>>>>        Case Begin
39949>>>>>>>            Case (iError_Num = 4001)
39951>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
39952>>>>>>>              Case Break
39953>>>>>>>            Case (iError_Num = 4002)
39956>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
39957>>>>>>>              Case Break
39958>>>>>>>            Case (iError_Num = 4003)
39961>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
39962>>>>>>>              Case Break
39963>>>>>>>            Case (iError_Num = 4004)
39966>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
39967>>>>>>>              Case Break
39968>>>>>>>            Case (iError_Num = 4005)
39971>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
39972>>>>>>>              Case Break
39973>>>>>>>            Case Else
39973>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
39975>>>>>>>        Case End
39975>>>>>>>        Error iError_Num lsError_Message
39976>>>>>>>>
39976>>>>>>>    End_Procedure // operation_not_allowed
39977>>>>>>>
39977>>>>>>>
39977>>>>>>>
39977>>>>>>>    Procedure Define_Fields
39978>>>>>>>        Forward Send Define_Fields
39980>>>>>>>        //DDB-Generated-Code-Location
39980>>>>>>>        //DDB-DefineFieldStart
39980>>>>>>>
39980>>>>>>>        Set Main_File            To Payresp.File_Number
39981>>>>>>>        Set Cascade_Delete_State To FALSE
39982>>>>>>>
39982>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39983>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39984>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39985>>>>>>>
39985>>>>>>>        // Child (Client) file structure................
39985>>>>>>>        Send Add_Client_File  Prspbank.File_Number
39986>>>>>>>        Send Add_Client_File  Tppresp.File_Number
39987>>>>>>>        Send Add_Client_File  Clients.File_Number
39988>>>>>>>
39988>>>>>>>        // External (System) file structure.............
39988>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39989>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
39990>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
39991>>>>>>>
39991>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
39994>>>>>>>
39994>>>>>>>        // Field-based properties.......................
39994>>>>>>>
39994>>>>>>>        // Payresp.Company_Code
39994>>>>>>>
39994>>>>>>>        // Payresp.Branch_Code
39994>>>>>>>
39994>>>>>>>        // Payresp.Year_Year
39994>>>>>>>
39994>>>>>>>        // Payresp.Custprom_Code
39994>>>>>>>
39994>>>>>>>        // Payresp.Presp_Id
39994>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
39995>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
39996>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
39997>>>>>>>
39997>>>>>>>        // Payresp.Presp_Name
39997>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
39998>>>>>>>
39998>>>>>>>        // Payresp.Presp_Afm
39998>>>>>>>
39998>>>>>>>        // Payresp.Presp_Rec0
39998>>>>>>>
39998>>>>>>>        // Payresp.Custprom_Recr
39998>>>>>>>
39998>>>>>>>        // Payresp.Presp_Recr
39998>>>>>>>
39998>>>>>>>        // Payresp.Last_Xreosh
39998>>>>>>>
39998>>>>>>>        // Payresp.Last_Pistosh
39998>>>>>>>
39998>>>>>>>        // Payresp.Last_Order
39998>>>>>>>
39998>>>>>>>        // Payresp.Presp_Doy
39998>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
39999>>>>>>>
39999>>>>>>>        // Payresp.Presp_Address
39999>>>>>>>
39999>>>>>>>        // Payresp.Presp_City_Id
39999>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
40000>>>>>>>
40000>>>>>>>        // Payresp.Presp_Area
40000>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Job
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Respons
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Zipcode
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Phone
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Fax
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Mobile
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Aoh
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Email
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Class
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Details
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Sitew
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Codem
40001>>>>>>>
40001>>>>>>>        // Payresp.Presp_Categfpa
40001>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Fpa
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Public
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Sn
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Repm
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Active
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Reported
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Pelprom
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Lastupd
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Markexp
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Catjob
40002>>>>>>>
40002>>>>>>>        // Payresp.Is_Promhtheyths
40002>>>>>>>
40002>>>>>>>        // Payresp.Xreosh
40002>>>>>>>
40002>>>>>>>        // Payresp.Pistosh
40002>>>>>>>
40002>>>>>>>        // Payresp.Ypoloipo
40002>>>>>>>
40002>>>>>>>        // Payresp.Plafon
40002>>>>>>>
40002>>>>>>>        // Payresp.Overhead
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Add_No
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Nomos
40002>>>>>>>
40002>>>>>>>        // Payresp.Presp_Xora
40002>>>>>>>
40002>>>>>>>        // Payresp.Polh_Recr
40002>>>>>>>
40002>>>>>>>        // Payresp.Synolikh_Ofeilh
40002>>>>>>>
40002>>>>>>>        // Payresp.Stoxos_Ipal
40002>>>>>>>
40002>>>>>>>        // Payresp.Stoxos_Ipso
40002>>>>>>>
40002>>>>>>>        // Payresp.Poso_Se_Apait
40002>>>>>>>
40002>>>>>>>        // Payresp.Orio_Syn_Ofeilh
40002>>>>>>>
40002>>>>>>>        // Payresp.Posa_Apo_Dap
40002>>>>>>>
40002>>>>>>>        // Payresp.Feregios
40002>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
40003>>>>>>>
40003>>>>>>>        //DDB-DefineFieldEnd
40003>>>>>>>    End_Procedure    // Define_Fields
40004>>>>>>>
40004>>>>>>>    // Field_Defaults:
40004>>>>>>>    // This procedure is used to establish default field values.
40004>>>>>>>
40004>>>>>>>    Procedure Field_Defaults
40005>>>>>>>        Forward Send Field_Defaults
40007>>>>>>>        //DDB-Generated-Code-Location
40007>>>>>>>        //DDB-FieldDefaultStart
40007>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
40008>>>>>>>        //DDB-FieldDefaultEnd
40008>>>>>>>    End_Procedure    // Field_Defaults
40009>>>>>>>
40009>>>>>>>End_Class    // Payresp_DataDictionary
40010>>>>>>>//DDB-Selection-pkg-Start
40010>>>>>>>
40010>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
40010>>>>>>>>>//AB/ Project sl111
40010>>>>>>>>>//AB/ Object prj is a Lookup_Project
40010>>>>>>>>>//AB/     Set ProjectName to "sl111"
40010>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
40010>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40010>>>>>>>>>
40010>>>>>>>>>// Project Object Structure
40010>>>>>>>>>//   sl111 is a dbModalPanelSub
40010>>>>>>>>>//     Payresp_DD is a DataDictionary
40010>>>>>>>>>//     oSelList is a dbListSub
40010>>>>>>>>>//     oOK_bn is a ButtonSub
40010>>>>>>>>>//     oCancel_bn is a ButtonSub
40010>>>>>>>>>//     oSearch_bn is a ButtonSub
40010>>>>>>>>>
40010>>>>>>>>>// Register all objects
40010>>>>>>>>>Register_Object oCancel_bn
40010>>>>>>>>>Register_Object oOK_bn
40010>>>>>>>>>Register_Object oSearch_bn
40010>>>>>>>>>Register_Object oSelList
40010>>>>>>>>>Register_Object Payresp_DD
40010>>>>>>>>>Register_Object sl111
40010>>>>>>>>>
40010>>>>>>>>>
40010>>>>>>>>>//AB-IgnoreStart
40010>>>>>>>>>
40010>>>>>>>>>Use DFAllEnt.pkg
40010>>>>>>>>>Use dbList.Sub
40010>>>>>>>>>Use Button.Sub
40010>>>>>>>>>
40010>>>>>>>>>
40010>>>>>>>>>Use PAYRESP.DD
40010>>>>>>>>>
40010>>>>>>>>>//AB-IgnoreEnd
40010>>>>>>>>>
40010>>>>>>>>>Object sl111 is a dbModalPanelSub
40012>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
40013>>>>>>>>>    Set Size to 148 443
40014>>>>>>>>>    Set Location to 4 5
40015>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40016>>>>>>>>>    Set Modal_State to FALSE
40017>>>>>>>>>
40017>>>>>>>>>    //AB-DDOStart
40017>>>>>>>>>
40017>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
40019>>>>>>>>>    End_Object    // Payresp_DD
40020>>>>>>>>>
40020>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
40021>>>>>>>>>    Set Server to (Payresp_DD(self))
40022>>>>>>>>>
40022>>>>>>>>>    //AB-DDOEnd
40022>>>>>>>>>
40022>>>>>>>>>    Object oSelList is a dbListSub
40024>>>>>>>>>        Set Main_File to Payresp.File_Number
40025>>>>>>>>>        Set Size to 105 430
40026>>>>>>>>>        Set Location to 6 6
40027>>>>>>>>>
40027>>>>>>>>>        Begin_Row
40030>>>>>>>>>            Entry_Item Payresp.Presp_id
40031>>>>>>>>>            Entry_Item Payresp.Presp_name
40032>>>>>>>>>            Entry_Item Payresp.Presp_afm
40033>>>>>>>>>            Entry_Item Payresp.Presp_address
40034>>>>>>>>>            Entry_Item Payresp.Presp_phone
40035>>>>>>>>>        End_Row
40040>>>>>>>>>
40040>>>>>>>>>        Set Form_Width    item 0 to 60
40041>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
40042>>>>>>>>>        
40042>>>>>>>>>        Set Form_Width    item 1 to 106
40043>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
40044>>>>>>>>>        
40044>>>>>>>>>        Set Form_Width    item 2 to 60
40045>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
40046>>>>>>>>>        
40046>>>>>>>>>        Set Form_Width    item 3 to 135
40047>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
40048>>>>>>>>>        
40048>>>>>>>>>        Set Form_Width    item 4 to 60
40049>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
40050>>>>>>>>>        
40050>>>>>>>>>    End_Object    // oSelList
40051>>>>>>>>>
40051>>>>>>>>>    Object oOK_bn is a ButtonSub
40053>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40054>>>>>>>>>        Set Location to 113 277
40055>>>>>>>>>
40055>>>>>>>>>        //AB-StoreStart
40055>>>>>>>>>        Procedure OnClick
40057>>>>>>>>>            Send OK To (oSelList(current_object))
40058>>>>>>>>>        End_Procedure
40059>>>>>>>>>        //AB-StoreEnd
40059>>>>>>>>>
40059>>>>>>>>>    End_Object    // oOK_bn
40060>>>>>>>>>
40060>>>>>>>>>    Object oCancel_bn is a ButtonSub
40062>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40063>>>>>>>>>        Set Location to 113 332
40064>>>>>>>>>
40064>>>>>>>>>        //AB-StoreStart
40064>>>>>>>>>        Procedure OnClick
40066>>>>>>>>>            Send Cancel To (oSelList(current_object))
40067>>>>>>>>>        End_Procedure
40068>>>>>>>>>        //AB-StoreEnd
40068>>>>>>>>>
40068>>>>>>>>>    End_Object    // oCancel_bn
40069>>>>>>>>>
40069>>>>>>>>>    Object oSearch_bn is a ButtonSub
40071>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
40072>>>>>>>>>        Set Location to 113 387
40073>>>>>>>>>
40073>>>>>>>>>        //AB-StoreStart
40073>>>>>>>>>        Procedure OnClick
40075>>>>>>>>>            Send Search To (oSelList(current_object))
40076>>>>>>>>>        End_Procedure
40077>>>>>>>>>        //AB-StoreEnd
40077>>>>>>>>>
40077>>>>>>>>>    End_Object    // oSearch_bn
40078>>>>>>>>>
40078>>>>>>>>>
40078>>>>>>>>>    //AB-StoreStart
40078>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40079>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40080>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40081>>>>>>>>>    //AB-StoreEnd
40081>>>>>>>>>
40081>>>>>>>>>End_Object    // sl111
40082>>>>>>>>>
40082>>>>>>>>>//AB/ End_Object    // prj
40082>>>>>>>Use sl198.sl         // sl198
40082>>>>>>>Use sl197.SL         // sl197
40082>>>>>>>
40082>>>>>>>//DDB-Selection-pkg-End
40082>>>>>>>//DDB-FileEnd
40082>>>>>    Use AREAS.DD
40082>>>>>    Use CLIENTS.DD
40082>>>>>    Use CMOVES.DD
INCLUDING FILE: CMOVES.DD
40082>>>>>>>//DDB-FileStart
40082>>>>>>>//DDB-HeaderStart
40082>>>>>>>
40082>>>>>>>// File Name : CMOVES.DD
40082>>>>>>>// Class Name: Cmoves_DataDictionary
40082>>>>>>>// Revision  : 148
40082>>>>>>>// Version   : 2
40082>>>>>>>
40082>>>>>>>Use  Windows           // Basic Definitions
40082>>>>>>>Use  DataDict          // DataDictionary Class Definition
40082>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40082>>>>>>>
40082>>>>>>>Open Cmoves
40084>>>>>>>Open Copen
INCLUDING FILE: COPEN.FD
40086>>>>>>>Open Ctypkin
40088>>>>>>>Open Clients
40090>>>>>>>Open Sysrecc
40092>>>>>>>Open Syscurxr
40094>>>>>>>
40094>>>>>>>//DDB-HeaderEnd
40094>>>>>>>//DDB-SelectionStart
40094>>>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
40094>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
40094>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
40094>>>>>>>Register_Object sl006
40094>>>>>>>Register_Object slNomism
40094>>>>>>>Register_Object sl041
40094>>>>>>>//DDB-SelectionEnd
40094>>>>>>> 
40094>>>>>>>Use Payresp.DD
40094>>>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
40094>>>>>>>>>//DDB-FileStart
40094>>>>>>>>>//DDB-HeaderStart
40094>>>>>>>>>
40094>>>>>>>>>// File Name : PMSSXET.DD
40094>>>>>>>>>// Class Name: PmsSxet_DataDictionary
40094>>>>>>>>>// Revision  : 27
40094>>>>>>>>>// Version   : 2
40094>>>>>>>>>
40094>>>>>>>>>Use  Windows           // Basic Definitions
40094>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40094>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40094>>>>>>>>>
40094>>>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
40096>>>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
40098>>>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
40100>>>>>>>>>Open Pmoves
40102>>>>>>>>>
40102>>>>>>>>>//DDB-HeaderEnd
40102>>>>>>>>>
40102>>>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
40102>>>>>>>>>>>//AB/ Project bpEnYpol
40102>>>>>>>>>>>//AB/ Object prj is a Dialog_Project
40102>>>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
40102>>>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
40102>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40102>>>>>>>>>>>
40102>>>>>>>>>>>// Project Object Structure
40102>>>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
40102>>>>>>>>>>>
40102>>>>>>>>>>>// Register all objects
40102>>>>>>>>>>>Register_Object bpEnYpol
40102>>>>>>>>>>>
40102>>>>>>>>>>>
40102>>>>>>>>>>>//AB-IgnoreStart
40102>>>>>>>>>>>
40102>>>>>>>>>>>Use Bproces.Sub
40102>>>>>>>>>>>
40102>>>>>>>>>>>
40102>>>>>>>>>>>//AB-IgnoreEnd
40102>>>>>>>>>>>
40102>>>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
40104>>>>>>>>>>>
40104>>>>>>>>>>>    //AB-StoreTopStart
40104>>>>>>>>>>>
40104>>>>>>>>>>>    Open Pmoves
40106>>>>>>>>>>>    Open Psxetika
40108>>>>>>>>>>>
40108>>>>>>>>>>>    Set Status_Panel_State to False
40109>>>>>>>>>>>    //Set Allow_Cancel_State  to True
40109>>>>>>>>>>>    Set Display_Error_State to True
40110>>>>>>>>>>>    //Set Process_Title to "               "
40110>>>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
40110>>>>>>>>>>>    //Set Status_log_state to True
40110>>>>>>>>>>>
40110>>>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
40112>>>>>>>>>>>    Property Integer    piLathos            Public  0
40114>>>>>>>>>>>    Property Number     pnQty               Public  0
40116>>>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
40118>>>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
40120>>>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
40122>>>>>>>>>>>    Property String     psRecr              Public ''
40124>>>>>>>>>>>
40124>>>>>>>>>>>
40124>>>>>>>>>>>    //AB-StoreTopEnd
40124>>>>>>>>>>>
40124>>>>>>>>>>>    Set Size to 60 100
40125>>>>>>>>>>>    Set Location to 4 5
40126>>>>>>>>>>>
40126>>>>>>>>>>>    //AB-DDOStart
40126>>>>>>>>>>>
40126>>>>>>>>>>>
40126>>>>>>>>>>>    //AB-DDOEnd
40126>>>>>>>>>>>
40126>>>>>>>>>>>
40126>>>>>>>>>>>    //AB-StoreStart
40126>>>>>>>>>>>
40126>>>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
40128>>>>>>>>>>>        Clear Pmoves
40129>>>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
40130>>>>>>>>>>>        Find Eq Pmoves by index.2
40131>>>>>>>>>>>>
40131>>>>>>>>>>>        If (Found) Begin
40133>>>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
40136>>>>>>>>>>>            Else Begin
40137>>>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
40138>>>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
40139>>>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
40142>>>>>>>>>>>                Saverecord Pmoves
40143>>>>>>>>>>>
40143>>>>>>>>>>>                Clear Particle
40144>>>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
40145>>>>>>>>>>>                Find Eq Particle by Index.2
40146>>>>>>>>>>>>
40146>>>>>>>>>>>                If (Found) Begin
40148>>>>>>>>>>>                   // Reread
40148>>>>>>>>>>>                    Add anQty to Particle.Timol_Qty
40149>>>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
40151>>>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
40152>>>>>>>>>>>
40152>>>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
40155>>>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
40157>>>>>>>>>>>
40157>>>>>>>>>>>                    End
40157>>>>>>>>>>>>
40157>>>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
40159>>>>>>>>>>>                    Saverecord Particle
40160>>>>>>>>>>>                   // Unlock
40160>>>>>>>>>>>                End
40160>>>>>>>>>>>>
40160>>>>>>>>>>>                Else Function_Return 40002
40162>>>>>>>>>>>            End
40162>>>>>>>>>>>>
40162>>>>>>>>>>>        End
40162>>>>>>>>>>>>
40162>>>>>>>>>>>        Else Function_Return 40000
40164>>>>>>>>>>>        Function_Return 0
40165>>>>>>>>>>>    End_Function
40166>>>>>>>>>>>
40166>>>>>>>>>>>    Procedure OnProcess
40168>>>>>>>>>>>        Integer iLathos iSub iAkyro
40169>>>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
40169>>>>>>>>>>>        Number  nQty nQty2
40169>>>>>>>>>>>
40169>>>>>>>>>>>        Set piLathos        to 0
40170>>>>>>>>>>>        Get pnQty           to nQty2
40171>>>>>>>>>>>        Get psRecr          to sRecr
40172>>>>>>>>>>>        Get piFromAkyrosh   to iAkyro
40173>>>>>>>>>>>
40173>>>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
40173>>>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
40173>>>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
40173>>>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
40173>>>>>>>>>>>        Move (nQty2<0)   to iSub
40174>>>>>>>>>>>
40174>>>>>>>>>>>
40174>>>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
40175>>>>>>>>>>>
40175>>>>>>>>>>>        If (iLathos) Begin
40177>>>>>>>>>>>            Set piLathos to iLathos
40178>>>>>>>>>>>            Procedure_Return
40179>>>>>>>>>>>        End
40179>>>>>>>>>>>>
40179>>>>>>>>>>>
40179>>>>>>>>>>>
40179>>>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
40179>>>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
40179>>>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
40179>>>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
40179>>>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
40179>>>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
40179>>>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
40179>>>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
40179>>>>>>>>>>>
40179>>>>>>>>>>>        If (iAkyro) Begin
40181>>>>>>>>>>>            Clear Pmoves
40182>>>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
40183>>>>>>>>>>>            Find Eq Pmoves by index.2
40184>>>>>>>>>>>>
40184>>>>>>>>>>>            If (Found) Begin
40186>>>>>>>>>>>                Clear PmsSxet
40187>>>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
40188>>>>>>>>>>>                Find Gt PmsSxet by Index.1
40189>>>>>>>>>>>>
40189>>>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
40193>>>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
40194>>>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
40195>>>>>>>>>>>                    If (iSub) Begin
40197>>>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
40197>>>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
40197>>>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
40197>>>>>>>>>>>                    End
40197>>>>>>>>>>>>
40197>>>>>>>>>>>                    Else Begin
40198>>>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
40198>>>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
40198>>>>>>>>>>>                        // PmsSxet arnhtikh.
40198>>>>>>>>>>>                        Move (nQty*(-1)) to nQty
40199>>>>>>>>>>>                    End
40199>>>>>>>>>>>>
40199>>>>>>>>>>>
40199>>>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
40199>>>>>>>>>>>                    // 07/01/2003 //
40199>>>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
40200>>>>>>>>>>>
40200>>>>>>>>>>>                    If (iLathos) Begin
40202>>>>>>>>>>>                        Set piLathos to (iLathos+3)
40203>>>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
40203>>>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
40203>>>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
40203>>>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
40203>>>>>>>>>>>                        Procedure_Return
40204>>>>>>>>>>>                    End
40204>>>>>>>>>>>>
40204>>>>>>>>>>>
40204>>>>>>>>>>>                    Clear PmsSxet
40205>>>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
40206>>>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
40207>>>>>>>>>>>                    Find Eq PmsSxet by Index.1
40208>>>>>>>>>>>>
40208>>>>>>>>>>>                    Find Gt PmsSxet by Index.1
40209>>>>>>>>>>>>
40209>>>>>>>>>>>                Loop
40210>>>>>>>>>>>>
40210>>>>>>>>>>>            End
40210>>>>>>>>>>>>
40210>>>>>>>>>>>            Else Set piLathos to 40007
40212>>>>>>>>>>>        End
40212>>>>>>>>>>>>
40212>>>>>>>>>>>
40212>>>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
40215>>>>>>>>>>>
40215>>>>>>>>>>>    End_Procedure
40216>>>>>>>>>>>
40216>>>>>>>>>>>    Procedure OnError integer error_info string errMsg
40218>>>>>>>>>>>    End_Procedure
40219>>>>>>>>>>>
40219>>>>>>>>>>>    Procedure Start_Process
40221>>>>>>>>>>>        Forward Send Start_Process
40223>>>>>>>>>>>    End_Procedure
40224>>>>>>>>>>>
40224>>>>>>>>>>>    Procedure End_Process
40226>>>>>>>>>>>        Forward Send End_Process
40228>>>>>>>>>>>        If (piCurrentPartl(Self)) Begin
40230>>>>>>>>>>>            Clear Particle
40231>>>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
40232>>>>>>>>>>>            Find Eq Particle.Recnum
40233>>>>>>>>>>>>
40233>>>>>>>>>>>        End
40233>>>>>>>>>>>>
40233>>>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
40235>>>>>>>>>>>            Clear Pmoves
40236>>>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
40237>>>>>>>>>>>            Find Eq Pmoves.Recnum
40238>>>>>>>>>>>>
40238>>>>>>>>>>>        End
40238>>>>>>>>>>>>
40238>>>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
40240>>>>>>>>>>>            Clear PmsSxet
40241>>>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
40242>>>>>>>>>>>            Find Eq PmsSxet.Recnum
40243>>>>>>>>>>>>
40243>>>>>>>>>>>        End
40243>>>>>>>>>>>>
40243>>>>>>>>>>>    End_Procedure
40244>>>>>>>>>>>
40244>>>>>>>>>>>    //AB-StoreEnd
40244>>>>>>>>>>>
40244>>>>>>>>>>>End_Object    // bpEnYpol
40245>>>>>>>>>>>
40245>>>>>>>>>>>//AB/ End_Object    // prj
40245>>>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
40245>>>>>>>>>>>//AB/ Project MyArray
40245>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
40245>>>>>>>>>>>//AB/         Set ProjectName to "MyArray"
40245>>>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
40245>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40245>>>>>>>>>>>
40245>>>>>>>>>>>// Project Object Structure
40245>>>>>>>>>>>//   Psx_Array is a BusinessProcessSub
40245>>>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
40245>>>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
40245>>>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
40245>>>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
40245>>>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
40245>>>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
40245>>>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
40245>>>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
40245>>>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
40245>>>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
40245>>>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
40245>>>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
40245>>>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
40245>>>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
40245>>>>>>>>>>>//     Country_DD is a Country_DataDictionary
40245>>>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
40245>>>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
40245>>>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
40245>>>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
40245>>>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
40245>>>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
40245>>>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
40245>>>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
40245>>>>>>>>>>>
40245>>>>>>>>>>>// Register all objects
40245>>>>>>>>>>>Register_Object Areas_DD
40245>>>>>>>>>>>Register_Object Areas_DD2
40245>>>>>>>>>>>Register_Object Cities_DD
40245>>>>>>>>>>>Register_Object Cities_DD2
40245>>>>>>>>>>>Register_Object Clients_DD
40245>>>>>>>>>>>Register_Object Clients_DD2
40245>>>>>>>>>>>Register_Object Country_DD
40245>>>>>>>>>>>Register_Object Country_DD2
40245>>>>>>>>>>>Register_Object Ctypkin_DD
40245>>>>>>>>>>>Register_Object Ctypkin_DD2
40245>>>>>>>>>>>Register_Object Nomisma_DD
40245>>>>>>>>>>>Register_Object Nomisma_DD2
40245>>>>>>>>>>>Register_Object Particle_DD
40245>>>>>>>>>>>Register_Object Particle_DD2
40245>>>>>>>>>>>Register_Object Payresp_DD
40245>>>>>>>>>>>Register_Object Payresp_DD2
40245>>>>>>>>>>>Register_Object Psx_Array
40245>>>>>>>>>>>Register_Object Psxetika_DD
40245>>>>>>>>>>>Register_Object Ptyppar_DD
40245>>>>>>>>>>>Register_Object Ptyppar_DD2
40245>>>>>>>>>>>Register_Object Towns_DD
40245>>>>>>>>>>>Register_Object Towns_DD2
40245>>>>>>>>>>>Register_Object Wtypkin_DD
40245>>>>>>>>>>>Register_Object Wtypkin_DD2
40245>>>>>>>>>>>
40245>>>>>>>>>>>
40245>>>>>>>>>>>
40245>>>>>>>>>>>    //AB-StoreTopStart
40245>>>>>>>>>>>
40245>>>>>>>>>>>    Use CTYPKIN.DD
40245>>>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
40245>>>>>>>>>>>>>//DDB-FileStart
40245>>>>>>>>>>>>>//DDB-HeaderStart
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>// File Name : WTYPKIN.DD
40245>>>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
40245>>>>>>>>>>>>>// Revision  : 49
40245>>>>>>>>>>>>>// Version   : 2
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40245>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40245>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>Open Wtypkin
40247>>>>>>>>>>>>>Open Ptyppar
40249>>>>>>>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
40251>>>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
40253>>>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
40255>>>>>>>>>>>>>Open Sysrecw
INCLUDING FILE: SYSRECW.FD
40257>>>>>>>>>>>>>Open Syscurxr
40259>>>>>>>>>>>>>
40259>>>>>>>>>>>>>//DDB-HeaderEnd
40259>>>>>>>>>>>>>//DDB-ValidationStart
40259>>>>>>>>>>>>>
40259>>>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
40259>>>>>>>>>>>>>
40259>>>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
40261>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
40262>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40262>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40262>>>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
40263>>>>>>>>>>>>>//DDB-ValidationEnd
40263>>>>>>>>>>>>>//DDB-SelectionStart
40263>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
40263>>>>>>>>>>>>>Register_Object sl029a
40263>>>>>>>>>>>>>//DDB-SelectionEnd
40263>>>>>>>>>>>>>
40263>>>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
40264>>>>>>>>>>>>>               
40264>>>>>>>>>>>>>    Procedure Construct_Object
40265>>>>>>>>>>>>>        Forward Send Construct_Object
40267>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
40268>>>>>>>>>>>>>    End_Procedure
40269>>>>>>>>>>>>>
40269>>>>>>>>>>>>>    Procedure Save_Main_File
40270>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40272>>>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
40275>>>>>>>>>>>>>        End
40275>>>>>>>>>>>>>>
40275>>>>>>>>>>>>>        Forward Send Save_Main_File
40277>>>>>>>>>>>>>    End_Procedure
40278>>>>>>>>>>>>>
40278>>>>>>>>>>>>>
40278>>>>>>>>>>>>>     Procedure Creating
40279>>>>>>>>>>>>>        Forward Send Creating
40281>>>>>>>>>>>>>        // Insert Code Here
40281>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
40282>>>>>>>>>>>>>    End_Procedure   // Creating
40283>>>>>>>>>>>>>
40283>>>>>>>>>>>>>    // Define_Fields:
40283>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40283>>>>>>>>>>>>>
40283>>>>>>>>>>>>>    Procedure Define_Fields
40284>>>>>>>>>>>>>        Forward Send Define_Fields
40286>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40286>>>>>>>>>>>>>        //DDB-DefineFieldStart
40286>>>>>>>>>>>>>
40286>>>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
40287>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40288>>>>>>>>>>>>>
40288>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40289>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40290>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40291>>>>>>>>>>>>>
40291>>>>>>>>>>>>>        // Child (Client) file structure................
40291>>>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
40292>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
40293>>>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
40294>>>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
40295>>>>>>>>>>>>>
40295>>>>>>>>>>>>>        // External (System) file structure.............
40295>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
40296>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40297>>>>>>>>>>>>>
40297>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>        // Field-based properties.......................
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>        // Wtypkin.Company_Code
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>        // Wtypkin.Branch_Code
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>        // Wtypkin.Year_Year
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
40300>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
40301>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
40302>>>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
40303>>>>>>>>>>>>>
40303>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
40303>>>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
40304>>>>>>>>>>>>>
40304>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
40304>>>>>>>>>>>>>
40304>>>>>>>>>>>>>        // Wtypkin.Year_Recr
40304>>>>>>>>>>>>>
40304>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
40304>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
40305>>>>>>>>>>>>>
40305>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
40305>>>>>>>>>>>>>
40305>>>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
40305>>>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
40306>>>>>>>>>>>>>
40306>>>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
40306>>>>>>>>>>>>>
40306>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40306>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40307>>>>>>>>>>>>>
40307>>>>>>>>>>>>>    // Field_Defaults:
40307>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40307>>>>>>>>>>>>>
40307>>>>>>>>>>>>>    Procedure Field_Defaults
40308>>>>>>>>>>>>>        Forward Send Field_Defaults
40310>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40310>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40310>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40310>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40311>>>>>>>>>>>>>
40311>>>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
40312>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40312>>>>>>>>>>>>>
40312>>>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
40312>>>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
40312>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40312>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
40312>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
40312>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>// Project Object Structure
40312>>>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
40312>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40312>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40312>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40312>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40312>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>// Register all objects
40312>>>>>>>>>>>>>>>Register_Object oCancel_bn
40312>>>>>>>>>>>>>>>Register_Object oOK_bn
40312>>>>>>>>>>>>>>>Register_Object oSearch_bn
40312>>>>>>>>>>>>>>>Register_Object oSelList
40312>>>>>>>>>>>>>>>Register_Object sl029a
40312>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>    //AB-IgnoreStart
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
40312>>>>>>>>>>>>>>>    Use dbList.Sub
40312>>>>>>>>>>>>>>>    Use Button.Sub
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>    Use WTYPKIN.DD
40312>>>>>>>>>>>>>>>    
40312>>>>>>>>>>>>>>>    //AB-IgnoreEnd
40312>>>>>>>>>>>>>>>
40312>>>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
40314>>>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
40315>>>>>>>>>>>>>>>        Set Size to 148 297
40316>>>>>>>>>>>>>>>        Set Location to 4 5
40317>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40318>>>>>>>>>>>>>>>        Set Modal_State to FALSE
40319>>>>>>>>>>>>>>>
40319>>>>>>>>>>>>>>>        //AB-DDOStart
40319>>>>>>>>>>>>>>>
40319>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
40321>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
40322>>>>>>>>>>>>>>>
40322>>>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
40323>>>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
40324>>>>>>>>>>>>>>>
40324>>>>>>>>>>>>>>>        //AB-DDOEnd
40324>>>>>>>>>>>>>>>
40324>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
40326>>>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
40327>>>>>>>>>>>>>>>            Set Size to 105 280
40328>>>>>>>>>>>>>>>            Set Location to 6 6
40329>>>>>>>>>>>>>>>
40329>>>>>>>>>>>>>>>            Begin_Row
40332>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
40333>>>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
40334>>>>>>>>>>>>>>>            End_Row
40339>>>>>>>>>>>>>>>
40339>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
40340>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
40341>>>>>>>>>>>>>>>            
40341>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
40342>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
40343>>>>>>>>>>>>>>>            
40343>>>>>>>>>>>>>>>        End_Object    // oSelList
40344>>>>>>>>>>>>>>>
40344>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40346>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
40347>>>>>>>>>>>>>>>            Set Location to 115 126
40348>>>>>>>>>>>>>>>
40348>>>>>>>>>>>>>>>            //AB-StoreStart
40348>>>>>>>>>>>>>>>            Procedure OnClick
40350>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
40351>>>>>>>>>>>>>>>            End_Procedure
40352>>>>>>>>>>>>>>>            //AB-StoreEnd
40352>>>>>>>>>>>>>>>
40352>>>>>>>>>>>>>>>        End_Object    // oOK_bn
40353>>>>>>>>>>>>>>>
40353>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40355>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
40356>>>>>>>>>>>>>>>            Set Location to 115 181
40357>>>>>>>>>>>>>>>
40357>>>>>>>>>>>>>>>            //AB-StoreStart
40357>>>>>>>>>>>>>>>            Procedure OnClick
40359>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40360>>>>>>>>>>>>>>>            End_Procedure
40361>>>>>>>>>>>>>>>            //AB-StoreEnd
40361>>>>>>>>>>>>>>>
40361>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
40362>>>>>>>>>>>>>>>
40362>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40364>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
40365>>>>>>>>>>>>>>>            Set Location to 115 236
40366>>>>>>>>>>>>>>>
40366>>>>>>>>>>>>>>>            //AB-StoreStart
40366>>>>>>>>>>>>>>>            Procedure OnClick
40368>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
40369>>>>>>>>>>>>>>>            End_Procedure
40370>>>>>>>>>>>>>>>            //AB-StoreEnd
40370>>>>>>>>>>>>>>>
40370>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
40371>>>>>>>>>>>>>>>
40371>>>>>>>>>>>>>>>
40371>>>>>>>>>>>>>>>        //AB-StoreStart
40371>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40372>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40373>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40374>>>>>>>>>>>>>>>        //AB-StoreEnd
40374>>>>>>>>>>>>>>>
40374>>>>>>>>>>>>>>>    End_Object    // sl029a
40375>>>>>>>>>>>>>>>
40375>>>>>>>>>>>>>>>//AB/     End_Object    // prj
40375>>>>>>>>>>>>>
40375>>>>>>>>>>>>>//DDB-Selection-pkg-End
40375>>>>>>>>>>>>>//DDB-FileEnd
40375>>>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
40375>>>>>>>>>>>>>//DDB-FileStart
40375>>>>>>>>>>>>>//DDB-HeaderStart
40375>>>>>>>>>>>>>
40375>>>>>>>>>>>>>// File Name : PTYPPAR.DD
40375>>>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
40375>>>>>>>>>>>>>// Revision  : 88
40375>>>>>>>>>>>>>// Version   : 2
40375>>>>>>>>>>>>>
40375>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40375>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40375>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40375>>>>>>>>>>>>>
40375>>>>>>>>>>>>>Open Ptyppar
40377>>>>>>>>>>>>>Open Particle
40379>>>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
40381>>>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
40383>>>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
40385>>>>>>>>>>>>>Open Ctypkin
40387>>>>>>>>>>>>>Open Wtypkin
40389>>>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
40391>>>>>>>>>>>>>Open Syscurxr
40393>>>>>>>>>>>>>
40393>>>>>>>>>>>>>//DDB-HeaderEnd
40393>>>>>>>>>>>>>//DDB-ValidationStart
40393>>>>>>>>>>>>>
40393>>>>>>>>>>>>>Register_Object Ptyppar_Year_Recr_VT
40393>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
40393>>>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
40393>>>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
40393>>>>>>>>>>>>>
40393>>>>>>>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
40395>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40396>>>>>>>>>>>>>
40396>>>>>>>>>>>>>    Procedure Fill_List
40398>>>>>>>>>>>>>        Forward Send Fill_List
40400>>>>>>>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
40401>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
40402>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
40403>>>>>>>>>>>>>    End_Procedure    // Fill_List
40404>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40404>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40404>>>>>>>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
40405>>>>>>>>>>>>>
40405>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
40407>>>>>>>>>>>>>
40407>>>>>>>>>>>>>    Procedure Fill_List
40409>>>>>>>>>>>>>        Forward Send Fill_List
40411>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
40412>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
40413>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
40414>>>>>>>>>>>>>    End_Procedure    // Fill_List
40415>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40415>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40415>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
40416>>>>>>>>>>>>>
40416>>>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
40418>>>>>>>>>>>>>    Set Type_Value        To "MODULE"
40419>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40420>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40420>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40420>>>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
40421>>>>>>>>>>>>>
40421>>>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
40423>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
40424>>>>>>>>>>>>>
40424>>>>>>>>>>>>>    Procedure Fill_List
40426>>>>>>>>>>>>>        Forward Send Fill_List
40428>>>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
40429>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
40430>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
40431>>>>>>>>>>>>>    End_Procedure    // Fill_List
40432>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40432>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40432>>>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
40433>>>>>>>>>>>>>//DDB-ValidationEnd
40433>>>>>>>>>>>>>//DDB-SelectionStart
40433>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
40433>>>>>>>>>>>>>Register_Object sl012
40433>>>>>>>>>>>>>//DDB-SelectionEnd
40433>>>>>>>>>>>>>
40433>>>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
40434>>>>>>>>>>>>>
40434>>>>>>>>>>>>>    Procedure Construct_Object
40435>>>>>>>>>>>>>        Forward Send Construct_Object
40437>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
40438>>>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
40439>>>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
40440>>>>>>>>>>>>>    End_Procedure
40441>>>>>>>>>>>>>
40441>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40442>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40444>>>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
40445>>>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
40446>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
40447>>>>>>>>>>>>>
40447>>>>>>>>>>>>>    Procedure OnConstrain
40448>>>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
40450>>>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
40452>>>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
40454>>>>>>>>>>>>>        End
40454>>>>>>>>>>>>>>
40454>>>>>>>>>>>>>    End_Procedure
40455>>>>>>>>>>>>>
40455>>>>>>>>>>>>>    Procedure Clear_Main_File
40456>>>>>>>>>>>>>        Forward Send Clear_Main_File
40458>>>>>>>>>>>>>        Set piOldCtypkin to 0
40459>>>>>>>>>>>>>        Set piOldWtypkin to 0
40460>>>>>>>>>>>>>    End_Procedure
40461>>>>>>>>>>>>>
40461>>>>>>>>>>>>>    Procedure Save_Main_File
40462>>>>>>>>>>>>>        Integer isAdmin iYes
40463>>>>>>>>>>>>>        String  sStr
40463>>>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
40464>>>>>>>>>>>>>
40464>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40466>>>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
40469>>>>>>>>>>>>>        End
40469>>>>>>>>>>>>>>
40469>>>>>>>>>>>>>
40469>>>>>>>>>>>>>        If (Operation_Origin=Self) Begin
40471>>>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
40473>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
40476>>>>>>>>>>>>>                Else Begin
40477>>>>>>>>>>>>>                    Move '' to sStr
40478>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
40479>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
40480>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
40483>>>>>>>>>>>>>                End
40483>>>>>>>>>>>>>>
40483>>>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
40483>>>>>>>>>>>>>>
40483>>>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
40485>>>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
40488>>>>>>>>>>>>>                Else Begin
40489>>>>>>>>>>>>>                    Move '' to sStr
40490>>>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
40491>>>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
40492>>>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
40495>>>>>>>>>>>>>                End
40495>>>>>>>>>>>>>>
40495>>>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
40495>>>>>>>>>>>>>>
40495>>>>>>>>>>>>>        End // If (Operation_Origin=Self)
40495>>>>>>>>>>>>>>
40495>>>>>>>>>>>>>        Forward Send Save_Main_File
40497>>>>>>>>>>>>>    End_Procedure // Save_Main_File
40498>>>>>>>>>>>>>
40498>>>>>>>>>>>>>
40498>>>>>>>>>>>>>    Procedure Update
40499>>>>>>>>>>>>>        Forward Send Update
40501>>>>>>>>>>>>>        // Insert Code Here
40501>>>>>>>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
40501>>>>>>>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
40502>>>>>>>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
40503>>>>>>>>>>>>>//        end
40503>>>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
40503>>>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
40503>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
40504>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
40505>>>>>>>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
40508>>>>>>>>>>>>>    End_Procedure   // Update
40509>>>>>>>>>>>>>
40509>>>>>>>>>>>>>    Procedure Creating
40510>>>>>>>>>>>>>        Forward Send Creating
40512>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
40513>>>>>>>>>>>>>    End_Procedure   // Creating
40514>>>>>>>>>>>>>
40514>>>>>>>>>>>>>
40514>>>>>>>>>>>>>    // Define_Fields:
40514>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40514>>>>>>>>>>>>>    Procedure Define_Fields
40515>>>>>>>>>>>>>        Forward Send Define_Fields
40517>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40517>>>>>>>>>>>>>        //DDB-DefineFieldStart
40517>>>>>>>>>>>>>
40517>>>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
40518>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40519>>>>>>>>>>>>>
40519>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
40520>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
40521>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40522>>>>>>>>>>>>>
40522>>>>>>>>>>>>>        // Child (Client) file structure................
40522>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
40523>>>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
40524>>>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
40525>>>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
40526>>>>>>>>>>>>>
40526>>>>>>>>>>>>>        // Parent (Server) file structure...............
40526>>>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
40527>>>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
40528>>>>>>>>>>>>>
40528>>>>>>>>>>>>>        // External (System) file structure.............
40528>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
40529>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40530>>>>>>>>>>>>>
40530>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Field-based properties.......................
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Ptyppar.Company_Code
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Ptyppar.Branch_Code
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Ptyppar.Year_Year
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
40533>>>>>>>>>>>>>
40533>>>>>>>>>>>>>        // Ptyppar.Year_Recr
40533>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
40534>>>>>>>>>>>>>
40534>>>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
40534>>>>>>>>>>>>>
40534>>>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
40534>>>>>>>>>>>>>
40534>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
40534>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
40535>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
40536>>>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
40537>>>>>>>>>>>>>
40537>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
40537>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
40538>>>>>>>>>>>>>
40538>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
40538>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
40539>>>>>>>>>>>>>
40539>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
40539>>>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND
40540>>>>>>>>>>>>>
40540>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
40540>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
40541>>>>>>>>>>>>>
40541>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
40541>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
40542>>>>>>>>>>>>>
40542>>>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
40542>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
40543>>>>>>>>>>>>>
40543>>>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
40543>>>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
40544>>>>>>>>>>>>>
40544>>>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
40544>>>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
40545>>>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Singular
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Sub
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Constrain
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Label
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Label1
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Sap
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        // Ptyppar.Is_Xondr
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40546>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40547>>>>>>>>>>>>>
40547>>>>>>>>>>>>>    // Field_Defaults:
40547>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40547>>>>>>>>>>>>>
40547>>>>>>>>>>>>>    Procedure Field_Defaults
40548>>>>>>>>>>>>>        Forward Send Field_Defaults
40550>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40550>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40550>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
40551>>>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
40552>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40552>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40553>>>>>>>>>>>>>
40553>>>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
40554>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40554>>>>>>>>>>>>>
40554>>>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
40554>>>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
40554>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
40554>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
40554>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
40554>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>// Project Object Structure
40554>>>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
40554>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
40554>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40554>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
40554>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40554>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40554>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40554>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>// Register all objects
40554>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
40554>>>>>>>>>>>>>>>Register_Object oCancel_bn
40554>>>>>>>>>>>>>>>Register_Object oOK_bn
40554>>>>>>>>>>>>>>>Register_Object oSearch_bn
40554>>>>>>>>>>>>>>>Register_Object oSelList
40554>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
40554>>>>>>>>>>>>>>>Register_Object sl012
40554>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>//AB-IgnoreStart
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>Use DFAllEnt.pkg
40554>>>>>>>>>>>>>>>Use dbList.Sub
40554>>>>>>>>>>>>>>>Use Button.Sub
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>Use CTYPKIN.DD
40554>>>>>>>>>>>>>>>Use WTYPKIN.DD
40554>>>>>>>>>>>>>>>Use PTYPPAR.DD
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>//AB-IgnoreEnd
40554>>>>>>>>>>>>>>>
40554>>>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
40556>>>>>>>>>>>>>>>
40556>>>>>>>>>>>>>>>    //AB-StoreTopStart
40556>>>>>>>>>>>>>>>    Property String psModule Public ''
40558>>>>>>>>>>>>>>>    Property integer pifromclient Public 0
40560>>>>>>>>>>>>>>>    
40560>>>>>>>>>>>>>>>    //AB-StoreTopEnd
40560>>>>>>>>>>>>>>>
40560>>>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
40561>>>>>>>>>>>>>>>    Set Size to 203 490
40562>>>>>>>>>>>>>>>    Set Location to 4 4
40563>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
40564>>>>>>>>>>>>>>>    Set Modal_State to FALSE
40565>>>>>>>>>>>>>>>
40565>>>>>>>>>>>>>>>    //AB-DDOStart
40565>>>>>>>>>>>>>>>
40565>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
40567>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
40568>>>>>>>>>>>>>>>
40568>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
40570>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
40571>>>>>>>>>>>>>>>
40571>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
40573>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
40574>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
40575>>>>>>>>>>>>>>>
40575>>>>>>>>>>>>>>>        //AB-StoreStart
40575>>>>>>>>>>>>>>>        
40575>>>>>>>>>>>>>>>        Procedure OnConstrain
40577>>>>>>>>>>>>>>>            Forward Send OnConstrain
40579>>>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
40581>>>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
40583>>>>>>>>>>>>>>>            End
40583>>>>>>>>>>>>>>>>
40583>>>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
40585>>>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
40587>>>>>>>>>>>>>>>            End
40587>>>>>>>>>>>>>>>>
40587>>>>>>>>>>>>>>>        End_Procedure
40588>>>>>>>>>>>>>>>        
40588>>>>>>>>>>>>>>>        
40588>>>>>>>>>>>>>>>        
40588>>>>>>>>>>>>>>>        
40588>>>>>>>>>>>>>>>        //AB-StoreEnd
40588>>>>>>>>>>>>>>>
40588>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
40589>>>>>>>>>>>>>>>
40589>>>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
40590>>>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
40591>>>>>>>>>>>>>>>
40591>>>>>>>>>>>>>>>    //AB-DDOEnd
40591>>>>>>>>>>>>>>>
40591>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
40593>>>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
40594>>>>>>>>>>>>>>>        Set Size to 161 474
40595>>>>>>>>>>>>>>>        Set Location to 6 6
40596>>>>>>>>>>>>>>>
40596>>>>>>>>>>>>>>>        Begin_Row
40599>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
40600>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
40601>>>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
40602>>>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
40603>>>>>>>>>>>>>>>        End_Row
40608>>>>>>>>>>>>>>>
40608>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
40609>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
40610>>>>>>>>>>>>>>>        
40610>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
40611>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
40612>>>>>>>>>>>>>>>        
40612>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
40613>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
40614>>>>>>>>>>>>>>>        
40614>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
40615>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
40616>>>>>>>>>>>>>>>        
40616>>>>>>>>>>>>>>>
40616>>>>>>>>>>>>>>>        //AB-StoreStart
40616>>>>>>>>>>>>>>>        
40616>>>>>>>>>>>>>>>        Procedure Activate
40618>>>>>>>>>>>>>>>            Forward Send Activate
40620>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
40621>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
40622>>>>>>>>>>>>>>>        End_Procedure
40623>>>>>>>>>>>>>>>        
40623>>>>>>>>>>>>>>>        //AB-StoreEnd
40623>>>>>>>>>>>>>>>
40623>>>>>>>>>>>>>>>    End_Object    // oSelList
40624>>>>>>>>>>>>>>>
40624>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
40626>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
40627>>>>>>>>>>>>>>>        Set Location to 171 323
40628>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40629>>>>>>>>>>>>>>>
40629>>>>>>>>>>>>>>>        //AB-StoreStart
40629>>>>>>>>>>>>>>>        Procedure OnClick
40631>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
40632>>>>>>>>>>>>>>>        End_Procedure
40633>>>>>>>>>>>>>>>        //AB-StoreEnd
40633>>>>>>>>>>>>>>>
40633>>>>>>>>>>>>>>>    End_Object    // oOK_bn
40634>>>>>>>>>>>>>>>
40634>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
40636>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
40637>>>>>>>>>>>>>>>        Set Location to 171 377
40638>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40639>>>>>>>>>>>>>>>
40639>>>>>>>>>>>>>>>        //AB-StoreStart
40639>>>>>>>>>>>>>>>        Procedure OnClick
40641>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
40642>>>>>>>>>>>>>>>        End_Procedure
40643>>>>>>>>>>>>>>>        //AB-StoreEnd
40643>>>>>>>>>>>>>>>
40643>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
40644>>>>>>>>>>>>>>>
40644>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
40646>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
40647>>>>>>>>>>>>>>>        Set Location to 171 433
40648>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40649>>>>>>>>>>>>>>>
40649>>>>>>>>>>>>>>>        //AB-StoreStart
40649>>>>>>>>>>>>>>>        Procedure OnClick
40651>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
40652>>>>>>>>>>>>>>>        End_Procedure
40653>>>>>>>>>>>>>>>        //AB-StoreEnd
40653>>>>>>>>>>>>>>>
40653>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
40654>>>>>>>>>>>>>>>
40654>>>>>>>>>>>>>>>
40654>>>>>>>>>>>>>>>    //AB-StoreStart
40654>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40655>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40656>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40657>>>>>>>>>>>>>>>    
40657>>>>>>>>>>>>>>>    
40657>>>>>>>>>>>>>>>    //AB-StoreEnd
40657>>>>>>>>>>>>>>>
40657>>>>>>>>>>>>>>>End_Object    // sl012
40658>>>>>>>>>>>>>>>
40658>>>>>>>>>>>>>>>//AB/ End_Object    // prj
40658>>>>>>>>>>>>>
40658>>>>>>>>>>>>>//DDB-Selection-pkg-End
40658>>>>>>>>>>>>>//DDB-FileEnd
40658>>>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
40658>>>>>>>>>>>>>//DDB-FileStart
40658>>>>>>>>>>>>>//DDB-HeaderStart
40658>>>>>>>>>>>>>
40658>>>>>>>>>>>>>// File Name : PSEIRA.DD
40658>>>>>>>>>>>>>// Class Name: Pseira_DataDictionary
40658>>>>>>>>>>>>>// Revision  : 34
40658>>>>>>>>>>>>>// Version   : 2
40658>>>>>>>>>>>>>
40658>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40658>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40658>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40658>>>>>>>>>>>>>
40658>>>>>>>>>>>>>Open Pseira
40660>>>>>>>>>>>>>Open Ptyppar
40662>>>>>>>>>>>>>Open Sysrecp
40664>>>>>>>>>>>>>Open Syscurxr
40666>>>>>>>>>>>>>
40666>>>>>>>>>>>>>//DDB-HeaderEnd
40666>>>>>>>>>>>>>//DDB-SelectionStart
40666>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
40666>>>>>>>>>>>>>Register_Object sl013
40666>>>>>>>>>>>>>//DDB-SelectionEnd
40666>>>>>>>>>>>>>
40666>>>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
40667>>>>>>>>>>>>>
40667>>>>>>>>>>>>>    Procedure Save_Main_File
40668>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
40670>>>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
40673>>>>>>>>>>>>>        End
40673>>>>>>>>>>>>>>
40673>>>>>>>>>>>>>        Forward Send Save_Main_File
40675>>>>>>>>>>>>>    End_Procedure
40676>>>>>>>>>>>>>
40676>>>>>>>>>>>>>    Procedure Update
40677>>>>>>>>>>>>>        Forward Send Update
40679>>>>>>>>>>>>>        // Insert Code Here
40679>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
40680>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
40681>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
40682>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
40683>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
40684>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
40685>>>>>>>>>>>>>    End_Procedure   // Update
40686>>>>>>>>>>>>>
40686>>>>>>>>>>>>>
40686>>>>>>>>>>>>>     Procedure Creating
40687>>>>>>>>>>>>>        Forward Send Creating
40689>>>>>>>>>>>>>        // Insert Code Here
40689>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
40690>>>>>>>>>>>>>    End_Procedure   // Creating
40691>>>>>>>>>>>>>
40691>>>>>>>>>>>>>
40691>>>>>>>>>>>>>    // Define_Fields:
40691>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40691>>>>>>>>>>>>>
40691>>>>>>>>>>>>>    Procedure Define_Fields
40692>>>>>>>>>>>>>        Forward Send Define_Fields
40694>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40694>>>>>>>>>>>>>        //DDB-DefineFieldStart
40694>>>>>>>>>>>>>
40694>>>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
40695>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40696>>>>>>>>>>>>>
40696>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40697>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40698>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40699>>>>>>>>>>>>>
40699>>>>>>>>>>>>>        // Parent (Server) file structure...............
40699>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
40700>>>>>>>>>>>>>
40700>>>>>>>>>>>>>        // External (System) file structure.............
40700>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
40701>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40702>>>>>>>>>>>>>
40702>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Field-based properties.......................
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Company_Code
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Branch_Code
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Year_Year
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Ctypkin_Code
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Wtypkin_Code
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Ptyppar_Code
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Ptyppar_Recr
40705>>>>>>>>>>>>>
40705>>>>>>>>>>>>>        // Pseira.Pseira_Seira
40705>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
40706>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
40707>>>>>>>>>>>>>
40707>>>>>>>>>>>>>        // Pseira.Pseira_Rec0
40707>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
40708>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
40709>>>>>>>>>>>>>
40709>>>>>>>>>>>>>        // Pseira.Pseira_Recr
40709>>>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
40710>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Pseira_Printer
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Pseira_Form
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Pseira_Autonum
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Autonum_Plus
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Autonum_Minus
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        // Pseira.Auto_Plus_Last
40711>>>>>>>>>>>>>
40711>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40711>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40712>>>>>>>>>>>>>
40712>>>>>>>>>>>>>    // Field_Defaults:
40712>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40712>>>>>>>>>>>>>
40712>>>>>>>>>>>>>    Procedure Field_Defaults
40713>>>>>>>>>>>>>        Forward Send Field_Defaults
40715>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40715>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40715>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40715>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40716>>>>>>>>>>>>>
40716>>>>>>>>>>>>>End_Class    // Pseira_DataDictionary
40717>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40717>>>>>>>>>>>>>
40717>>>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
40717>>>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
40717>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40717>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
40717>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
40717>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>// Project Object Structure
40717>>>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
40717>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
40717>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
40717>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
40717>>>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
40717>>>>>>>>>>>>>>>//     oSelList is a dbListSub
40717>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
40717>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
40717>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>// Register all objects
40717>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
40717>>>>>>>>>>>>>>>Register_Object oCancel_bn
40717>>>>>>>>>>>>>>>Register_Object oOK_bn
40717>>>>>>>>>>>>>>>Register_Object oSearch_bn
40717>>>>>>>>>>>>>>>Register_Object oSelList
40717>>>>>>>>>>>>>>>Register_Object Pseira_DD
40717>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
40717>>>>>>>>>>>>>>>Register_Object sl013
40717>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>    //AB-IgnoreStart
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
40717>>>>>>>>>>>>>>>    Use dbList.Sub
40717>>>>>>>>>>>>>>>    Use Button.Sub
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>    Use CTYPKIN.DD
40717>>>>>>>>>>>>>>>    Use WTYPKIN.DD
40717>>>>>>>>>>>>>>>    Use PTYPPAR.DD
40717>>>>>>>>>>>>>>>    Use PSEIRA.DD
40717>>>>>>>>>>>>>>>    
40717>>>>>>>>>>>>>>>    //AB-IgnoreEnd
40717>>>>>>>>>>>>>>>
40717>>>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
40719>>>>>>>>>>>>>>>
40719>>>>>>>>>>>>>>>        //AB-StoreTopStart
40719>>>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
40721>>>>>>>>>>>>>>>        
40721>>>>>>>>>>>>>>>        //AB-StoreTopEnd
40721>>>>>>>>>>>>>>>
40721>>>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
40722>>>>>>>>>>>>>>>        Set Size to 148 214
40723>>>>>>>>>>>>>>>        Set Location to 1 7
40724>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40725>>>>>>>>>>>>>>>        Set Modal_State to FALSE
40726>>>>>>>>>>>>>>>
40726>>>>>>>>>>>>>>>        //AB-DDOStart
40726>>>>>>>>>>>>>>>
40726>>>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
40728>>>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
40729>>>>>>>>>>>>>>>
40729>>>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
40731>>>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
40732>>>>>>>>>>>>>>>
40732>>>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
40734>>>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
40735>>>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
40736>>>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
40737>>>>>>>>>>>>>>>
40737>>>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
40739>>>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
40740>>>>>>>>>>>>>>>
40740>>>>>>>>>>>>>>>            //AB-StoreStart
40740>>>>>>>>>>>>>>>            Procedure OnConstrain
40742>>>>>>>>>>>>>>>                String sID
40743>>>>>>>>>>>>>>>                Forward Send OnConstrain
40745>>>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
40746>>>>>>>>>>>>>>>                Move (trim(sID)) to sID
40747>>>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
40751>>>>>>>>>>>>>>>            End_procedure
40752>>>>>>>>>>>>>>>            
40752>>>>>>>>>>>>>>>            //AB-StoreEnd
40752>>>>>>>>>>>>>>>
40752>>>>>>>>>>>>>>>        End_Object    // Pseira_DD
40753>>>>>>>>>>>>>>>
40753>>>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
40754>>>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
40755>>>>>>>>>>>>>>>
40755>>>>>>>>>>>>>>>        //AB-DDOEnd
40755>>>>>>>>>>>>>>>
40755>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
40757>>>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
40758>>>>>>>>>>>>>>>            Set Size to 105 197
40759>>>>>>>>>>>>>>>            Set Location to 6 6
40760>>>>>>>>>>>>>>>
40760>>>>>>>>>>>>>>>            Begin_Row
40763>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
40764>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
40765>>>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
40766>>>>>>>>>>>>>>>            End_Row
40771>>>>>>>>>>>>>>>
40771>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
40772>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
40773>>>>>>>>>>>>>>>            
40773>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
40774>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
40775>>>>>>>>>>>>>>>            
40775>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
40776>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
40777>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
40778>>>>>>>>>>>>>>>            
40778>>>>>>>>>>>>>>>
40778>>>>>>>>>>>>>>>            //AB-StoreStart
40778>>>>>>>>>>>>>>>                    
40778>>>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
40780>>>>>>>>>>>>>>>            
40780>>>>>>>>>>>>>>>            Procedure Store_Defaults
40782>>>>>>>>>>>>>>>                   Forward Send Store_Defaults
40784>>>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
40785>>>>>>>>>>>>>>>            End_Procedure
40786>>>>>>>>>>>>>>>            
40786>>>>>>>>>>>>>>>            Procedure ReStore_Defaults
40788>>>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
40790>>>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
40791>>>>>>>>>>>>>>>            End_Procedure
40792>>>>>>>>>>>>>>>            
40792>>>>>>>>>>>>>>>            Procedure Activating
40794>>>>>>>>>>>>>>>                Forward Send Activating
40796>>>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
40797>>>>>>>>>>>>>>>            End_Procedure
40798>>>>>>>>>>>>>>>            
40798>>>>>>>>>>>>>>>            
40798>>>>>>>>>>>>>>>            //AB-StoreEnd
40798>>>>>>>>>>>>>>>
40798>>>>>>>>>>>>>>>        End_Object    // oSelList
40799>>>>>>>>>>>>>>>
40799>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
40801>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
40802>>>>>>>>>>>>>>>            Set Location to 114 42
40803>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40804>>>>>>>>>>>>>>>
40804>>>>>>>>>>>>>>>            //AB-StoreStart
40804>>>>>>>>>>>>>>>            Procedure OnClick
40806>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
40807>>>>>>>>>>>>>>>            End_Procedure
40808>>>>>>>>>>>>>>>            //AB-StoreEnd
40808>>>>>>>>>>>>>>>
40808>>>>>>>>>>>>>>>        End_Object    // oOK_bn
40809>>>>>>>>>>>>>>>
40809>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
40811>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
40812>>>>>>>>>>>>>>>            Set Location to 114 98
40813>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40814>>>>>>>>>>>>>>>
40814>>>>>>>>>>>>>>>            //AB-StoreStart
40814>>>>>>>>>>>>>>>            Procedure OnClick
40816>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
40817>>>>>>>>>>>>>>>            End_Procedure
40818>>>>>>>>>>>>>>>            //AB-StoreEnd
40818>>>>>>>>>>>>>>>
40818>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
40819>>>>>>>>>>>>>>>
40819>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
40821>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
40822>>>>>>>>>>>>>>>            Set Location to 114 153
40823>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
40824>>>>>>>>>>>>>>>
40824>>>>>>>>>>>>>>>            //AB-StoreStart
40824>>>>>>>>>>>>>>>            Procedure OnClick
40826>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
40827>>>>>>>>>>>>>>>            End_Procedure
40828>>>>>>>>>>>>>>>            //AB-StoreEnd
40828>>>>>>>>>>>>>>>
40828>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
40829>>>>>>>>>>>>>>>
40829>>>>>>>>>>>>>>>
40829>>>>>>>>>>>>>>>        //AB-StoreStart
40829>>>>>>>>>>>>>>>            
40829>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
40830>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
40831>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        
40832>>>>>>>>>>>>>>>        //AB-StoreEnd
40832>>>>>>>>>>>>>>>
40832>>>>>>>>>>>>>>>    End_Object    // sl013
40833>>>>>>>>>>>>>>>
40833>>>>>>>>>>>>>>>//AB/     End_Object    // prj
40833>>>>>>>>>>>>>
40833>>>>>>>>>>>>>//DDB-Selection-pkg-End
40833>>>>>>>>>>>>>//DDB-FileEnd
40833>>>>>>>>>>>    Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
40833>>>>>>>>>>>>>//DDB-FileStart
40833>>>>>>>>>>>>>//DDB-HeaderStart
40833>>>>>>>>>>>>>
40833>>>>>>>>>>>>>// File Name : NOMISMA.DD
40833>>>>>>>>>>>>>// Class Name: Nomisma_DataDictionary
40833>>>>>>>>>>>>>// Revision  : 52
40833>>>>>>>>>>>>>// Version   : 2
40833>>>>>>>>>>>>>
40833>>>>>>>>>>>>>Use  Windows           // Basic Definitions
40833>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
40833>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40833>>>>>>>>>>>>>
40833>>>>>>>>>>>>>Open Nomisma
40835>>>>>>>>>>>>>Open Isotimia
40837>>>>>>>>>>>>>Open Particle
40839>>>>>>>>>>>>>
40839>>>>>>>>>>>>>//DDB-HeaderEnd
40839>>>>>>>>>>>>>//DDB-ValidationStart
40839>>>>>>>>>>>>>
40839>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
40839>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
40839>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
40839>>>>>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
40839>>>>>>>>>>>>>
40839>>>>>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
40841>>>>>>>>>>>>>
40841>>>>>>>>>>>>>    Procedure Fill_List
40843>>>>>>>>>>>>>        Forward Send Fill_List
40845>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
40846>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
40847>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
40848>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
40849>>>>>>>>>>>>>    End_Procedure    // Fill_List
40850>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40850>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40850>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
40851>>>>>>>>>>>>>
40851>>>>>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
40853>>>>>>>>>>>>>
40853>>>>>>>>>>>>>    Procedure Fill_List
40855>>>>>>>>>>>>>        Forward Send Fill_List
40857>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40858>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40859>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
40860>>>>>>>>>>>>>    End_Procedure    // Fill_List
40861>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40861>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40861>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
40862>>>>>>>>>>>>>
40862>>>>>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
40864>>>>>>>>>>>>>
40864>>>>>>>>>>>>>    Procedure Fill_List
40866>>>>>>>>>>>>>        Forward Send Fill_List
40868>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40869>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40870>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
40871>>>>>>>>>>>>>    End_Procedure    // Fill_List
40872>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40872>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40872>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
40873>>>>>>>>>>>>>
40873>>>>>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
40875>>>>>>>>>>>>>
40875>>>>>>>>>>>>>    Procedure Fill_List
40877>>>>>>>>>>>>>        Forward Send Fill_List
40879>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
40880>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
40881>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
40882>>>>>>>>>>>>>    End_Procedure    // Fill_List
40883>>>>>>>>>>>>>    //DDB-ValidationCustomStart
40883>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
40883>>>>>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
40884>>>>>>>>>>>>>//DDB-ValidationEnd
40884>>>>>>>>>>>>>//DDB-SelectionStart
40884>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
40884>>>>>>>>>>>>>Register_Object sl059
40884>>>>>>>>>>>>>//DDB-SelectionEnd
40884>>>>>>>>>>>>>
40884>>>>>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
40885>>>>>>>>>>>>>
40885>>>>>>>>>>>>>    Procedure Construct_Object
40886>>>>>>>>>>>>>        Forward Send Construct_Object
40888>>>>>>>>>>>>>        Property String psOldCode Public ''
40889>>>>>>>>>>>>>    End_procedure
40890>>>>>>>>>>>>>
40890>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40891>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40893>>>>>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
40894>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
40895>>>>>>>>>>>>>
40895>>>>>>>>>>>>>    Procedure Save_Main_File
40896>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
40899>>>>>>>>>>>>>        Forward Send Save_Main_File
40901>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
40902>>>>>>>>>>>>>
40902>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
40903>>>>>>>>>>>>>        Local Integer iReturnVal 
40904>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
40906>>>>>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
40908>>>>>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
40911>>>>>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
40915>>>>>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
40918>>>>>>>>>>>>>            End
40918>>>>>>>>>>>>>>
40918>>>>>>>>>>>>>        Function_Return iReturnVal
40919>>>>>>>>>>>>>    End_Function   // Validate_Save
40920>>>>>>>>>>>>>
40920>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
40921>>>>>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
40924>>>>>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
40928>>>>>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
40928>>>>>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
40931>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
40932>>>>>>>>>>>>>
40932>>>>>>>>>>>>>    Procedure Update
40933>>>>>>>>>>>>>        Forward Send Update
40935>>>>>>>>>>>>>        // Insert Code Here
40935>>>>>>>>>>>>>        SYSDATE NOMISMA.LUP
40936>>>>>>>>>>>>>    End_Procedure   // Update
40937>>>>>>>>>>>>>
40937>>>>>>>>>>>>>    Procedure Creating
40938>>>>>>>>>>>>>        Forward Send Creating
40940>>>>>>>>>>>>>        // Insert Code Here
40940>>>>>>>>>>>>>        SYSDATE NOMISMA.FUP
40941>>>>>>>>>>>>>    End_Procedure   // Creating
40942>>>>>>>>>>>>>
40942>>>>>>>>>>>>>    // Define_Fields:
40942>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
40942>>>>>>>>>>>>>
40942>>>>>>>>>>>>>    Procedure Define_Fields
40943>>>>>>>>>>>>>        Forward Send Define_Fields
40945>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40945>>>>>>>>>>>>>        //DDB-DefineFieldStart
40945>>>>>>>>>>>>>
40945>>>>>>>>>>>>>        Set Main_File            To Nomisma.File_Number
40946>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
40947>>>>>>>>>>>>>
40947>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40948>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40949>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40950>>>>>>>>>>>>>
40950>>>>>>>>>>>>>        // Child (Client) file structure................
40950>>>>>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
40951>>>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
40952>>>>>>>>>>>>>
40952>>>>>>>>>>>>>        // Field-based properties.......................
40952>>>>>>>>>>>>>
40952>>>>>>>>>>>>>        // Nomisma.Nomisma_Code
40952>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
40953>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
40954>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
40955>>>>>>>>>>>>>
40955>>>>>>>>>>>>>        // Nomisma.Nomisma_Descr
40955>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
40956>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
40957>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
40958>>>>>>>>>>>>>
40958>>>>>>>>>>>>>        // Nomisma.Nomisma_Short
40958>>>>>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
40959>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
40960>>>>>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Dekadika
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Fup
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Lup
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Euro_Zone
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Einai_Drx
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Einai_Euro
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Monades
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Kl_Isot_Euro
40961>>>>>>>>>>>>>
40961>>>>>>>>>>>>>        // Nomisma.Nomisma_Type
40961>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
40962>>>>>>>>>>>>>
40962>>>>>>>>>>>>>        // Nomisma.Nomisma_Sign0
40962>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
40963>>>>>>>>>>>>>
40963>>>>>>>>>>>>>        // Nomisma.Nomisma_Sign00
40963>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
40964>>>>>>>>>>>>>
40964>>>>>>>>>>>>>        // Nomisma.Nomisma_Signr
40964>>>>>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
40965>>>>>>>>>>>>>
40965>>>>>>>>>>>>>        //DDB-DefineFieldEnd
40965>>>>>>>>>>>>>    End_Procedure    // Define_Fields
40966>>>>>>>>>>>>>
40966>>>>>>>>>>>>>    // Field_Defaults:
40966>>>>>>>>>>>>>    // This procedure is used to establish default field values.
40966>>>>>>>>>>>>>
40966>>>>>>>>>>>>>    Procedure Field_Defaults
40967>>>>>>>>>>>>>        Forward Send Field_Defaults
40969>>>>>>>>>>>>>        //DDB-Generated-Code-Location
40969>>>>>>>>>>>>>        //DDB-FieldDefaultStart
40969>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
40969>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
40970>>>>>>>>>>>>>
40970>>>>>>>>>>>>>End_Class    // Nomisma_DataDictionary
40971>>>>>>>>>>>>>//DDB-Selection-pkg-Start
40971>>>>>>>>>>>>>
40971>>>>>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
40971>>>>>>>>>>>>>>>//AB/ Project sl059
40971>>>>>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
40971>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
40971>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
40971>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>    //AB-IgnoreStart
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>    Use NOMISMA.DD
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>    //AB-IgnoreEnd
40971>>>>>>>>>>>>>>>
40971>>>>>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
40990>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
40991>>>>>>>>>>>>>>>        Set Modal_State to FALSE
40992>>>>>>>>>>>>>>>        Set Popup_State to FALSE
40993>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
40994>>>>>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
40995>>>>>>>>>>>>>>>        Set Size to 148 295
40996>>>>>>>>>>>>>>>        Set Location to 4 5
40997>>>>>>>>>>>>>>>
40997>>>>>>>>>>>>>>>        //AB-DDOStart
40997>>>>>>>>>>>>>>>
40997>>>>>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
40999>>>>>>>>>>>>>>>        End_Object    // Nomisma_DD
41000>>>>>>>>>>>>>>>
41000>>>>>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
41001>>>>>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
41002>>>>>>>>>>>>>>>
41002>>>>>>>>>>>>>>>        //AB-DDOEnd
41002>>>>>>>>>>>>>>>
41002>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
41004>>>>>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
41005>>>>>>>>>>>>>>>            Set Size to 105 278
41006>>>>>>>>>>>>>>>            Set Location to 6 6
41007>>>>>>>>>>>>>>>
41007>>>>>>>>>>>>>>>            Begin_Row
41010>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
41011>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
41012>>>>>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
41013>>>>>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
41014>>>>>>>>>>>>>>>            End_Row
41019>>>>>>>>>>>>>>>
41019>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 45
41020>>>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
41021>>>>>>>>>>>>>>>
41021>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 115
41022>>>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
41023>>>>>>>>>>>>>>>
41023>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 58
41024>>>>>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
41025>>>>>>>>>>>>>>>
41025>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 54
41026>>>>>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
41027>>>>>>>>>>>>>>>
41027>>>>>>>>>>>>>>>        End_Object    // oSelList
41028>>>>>>>>>>>>>>>
41028>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41030>>>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
41031>>>>>>>>>>>>>>>            Set Location to 113 124
41032>>>>>>>>>>>>>>>
41032>>>>>>>>>>>>>>>            //AB-StoreStart
41032>>>>>>>>>>>>>>>            Procedure OnClick
41034>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
41035>>>>>>>>>>>>>>>            End_Procedure
41036>>>>>>>>>>>>>>>            //AB-StoreEnd
41036>>>>>>>>>>>>>>>
41036>>>>>>>>>>>>>>>        End_Object    // oOK_bn
41037>>>>>>>>>>>>>>>
41037>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41039>>>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
41040>>>>>>>>>>>>>>>            Set Location to 113 179
41041>>>>>>>>>>>>>>>
41041>>>>>>>>>>>>>>>            //AB-StoreStart
41041>>>>>>>>>>>>>>>            Procedure OnClick
41043>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41044>>>>>>>>>>>>>>>            End_Procedure
41045>>>>>>>>>>>>>>>            //AB-StoreEnd
41045>>>>>>>>>>>>>>>
41045>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
41046>>>>>>>>>>>>>>>
41046>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41048>>>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
41049>>>>>>>>>>>>>>>            Set Location to 113 234
41050>>>>>>>>>>>>>>>
41050>>>>>>>>>>>>>>>            //AB-StoreStart
41050>>>>>>>>>>>>>>>            Procedure OnClick
41052>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
41053>>>>>>>>>>>>>>>            End_Procedure
41054>>>>>>>>>>>>>>>            //AB-StoreEnd
41054>>>>>>>>>>>>>>>
41054>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
41055>>>>>>>>>>>>>>>
41055>>>>>>>>>>>>>>>
41055>>>>>>>>>>>>>>>        //AB-StoreStart
41055>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41056>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41057>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41058>>>>>>>>>>>>>>>        //AB-StoreEnd
41058>>>>>>>>>>>>>>>
41058>>>>>>>>>>>>>>>    CD_End_Object    // sl059
41060>>>>>>>>>>>>>>>>
41060>>>>>>>>>>>>>>>
41060>>>>>>>>>>>>>>>//AB/     End_Object    // prj
41060>>>>>>>>>>>>>
41060>>>>>>>>>>>>>//DDB-Selection-pkg-End
41060>>>>>>>>>>>>>//DDB-FileEnd
41060>>>>>>>>>>>    Use COUNTRY.DD
41060>>>>>>>>>>>    Use TOWNS.DD
41060>>>>>>>>>>>    Use CITIES.DD
41060>>>>>>>>>>>    Use PAYRESP.DD
41060>>>>>>>>>>>    Use AREAS.DD
41060>>>>>>>>>>>    Use CLIENTS.DD
41060>>>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
41060>>>>>>>>>>>>>//DDB-FileStart
41060>>>>>>>>>>>>>//DDB-HeaderStart
41060>>>>>>>>>>>>>
41060>>>>>>>>>>>>>// File Name : PARTICLE.DD
41060>>>>>>>>>>>>>// Class Name: Particle_DataDictionary
41060>>>>>>>>>>>>>// Revision  : 262
41060>>>>>>>>>>>>>// Version   : 2
41060>>>>>>>>>>>>>
41060>>>>>>>>>>>>>Use  Windows           // Basic Definitions
41060>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41060>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41060>>>>>>>>>>>>>
41060>>>>>>>>>>>>>Open Particle
41062>>>>>>>>>>>>>Open Pmoves
41064>>>>>>>>>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
41066>>>>>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
41068>>>>>>>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
41070>>>>>>>>>>>>>Open Psxetika
41072>>>>>>>>>>>>>Open Clients
41074>>>>>>>>>>>>>Open Ptyppar
41076>>>>>>>>>>>>>Open Nomisma
41078>>>>>>>>>>>>>Open Sysrecp
41080>>>>>>>>>>>>>Open Syscurxr
41082>>>>>>>>>>>>>Open Pseira
41084>>>>>>>>>>>>>Open Cn
41086>>>>>>>>>>>>>Open Partlfpa
41088>>>>>>>>>>>>>Open Clorder
41090>>>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
41092>>>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
41094>>>>>>>>>>>>>Open Psxetika
41096>>>>>>>>>>>>>Open Pmoves
41098>>>>>>>>>>>>>Open Gmove
41100>>>>>>>>>>>>>Open Sysrecg
41102>>>>>>>>>>>>>
41102>>>>>>>>>>>>>//DDB-HeaderEnd
41102>>>>>>>>>>>>>//DDB-ValidationStart
41102>>>>>>>>>>>>>
41102>>>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
41102>>>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
41102>>>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
41102>>>>>>>>>>>>>
41102>>>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
41104>>>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
41105>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41106>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41106>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41106>>>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
41107>>>>>>>>>>>>>
41107>>>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
41109>>>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
41110>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41111>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41111>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41111>>>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
41112>>>>>>>>>>>>>
41112>>>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
41114>>>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
41115>>>>>>>>>>>>>    Set Validate_State    To FALSE
41116>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
41117>>>>>>>>>>>>>    //DDB-ValidationCustomStart
41117>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
41117>>>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
41118>>>>>>>>>>>>>//DDB-ValidationEnd
41118>>>>>>>>>>>>>//DDB-SelectionStart
41118>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
41118>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
41118>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
41118>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
41118>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
41118>>>>>>>>>>>>>Register_Object sl041
41118>>>>>>>>>>>>>Register_Object sl014
41118>>>>>>>>>>>>>Register_Object sl054
41118>>>>>>>>>>>>>Register_Object sl053
41118>>>>>>>>>>>>>Register_Object sl064
41118>>>>>>>>>>>>>//DDB-SelectionEnd
41118>>>>>>>>>>>>>
41118>>>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
41118>>>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
41118>>>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
41118>>>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
41118>>>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
41118>>>>>>>>>>>>>//    Set Ordering            to  1
41118>>>>>>>>>>>>>//    Set Static_State to False
41118>>>>>>>>>>>>>//End_Object
41118>>>>>>>>>>>>>
41118>>>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
41120>>>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
41122>>>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
41124>>>>>>>>>>>>>Open SysCurXr
41126>>>>>>>>>>>>>
41126>>>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
41127>>>>>>>>>>>>>
41127>>>>>>>>>>>>>    Function fsVresCNDescr String asCNCode Returns String
41128>>>>>>>>>>>>>        String rVal
41129>>>>>>>>>>>>>        Clear CN
41130>>>>>>>>>>>>>        Move asCNCode            to Cn.Cn_Code
41131>>>>>>>>>>>>>        Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41132>>>>>>>>>>>>>>
41132>>>>>>>>>>>>>        If (Found) Move (Trim(CN.CN_Descr)) to rVal
41135>>>>>>>>>>>>>        Else Move '' to rVal
41137>>>>>>>>>>>>>        Function_Return rVal
41138>>>>>>>>>>>>>    End_Function
41139>>>>>>>>>>>>>
41139>>>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
41140>>>>>>>>>>>>>        String rVal
41141>>>>>>>>>>>>>        Clear Pumps
41142>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
41143>>>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
41144>>>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
41145>>>>>>>>>>>>>>
41145>>>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
41148>>>>>>>>>>>>>        Else Move '' to rVal
41150>>>>>>>>>>>>>        Function_Return rVal
41151>>>>>>>>>>>>>    End_Function
41152>>>>>>>>>>>>>
41152>>>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
41153>>>>>>>>>>>>>        String rVal
41154>>>>>>>>>>>>>        Clear Cars
41155>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41156>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41157>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41158>>>>>>>>>>>>>>
41158>>>>>>>>>>>>>
41158>>>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
41161>>>>>>>>>>>>>        Else Move '' to rVal
41163>>>>>>>>>>>>>        Function_Return rVal
41164>>>>>>>>>>>>>    End_Function
41165>>>>>>>>>>>>>
41165>>>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
41166>>>>>>>>>>>>>        String rVal
41167>>>>>>>>>>>>>        Clear Cars
41168>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
41169>>>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
41170>>>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
41171>>>>>>>>>>>>>>
41171>>>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
41174>>>>>>>>>>>>>        Else        Move '' to rVal
41176>>>>>>>>>>>>>        Function_Return rVal
41177>>>>>>>>>>>>>    End_Function
41178>>>>>>>>>>>>>
41178>>>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
41179>>>>>>>>>>>>>        String rVal
41180>>>>>>>>>>>>>        Clear Drivers
41181>>>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
41182>>>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
41183>>>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
41184>>>>>>>>>>>>>>
41184>>>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
41187>>>>>>>>>>>>>        Else Move '' to rVal
41189>>>>>>>>>>>>>        Function_Return rVal
41190>>>>>>>>>>>>>    End_Function
41191>>>>>>>>>>>>>
41191>>>>>>>>>>>>>    Procedure Construct_Object
41192>>>>>>>>>>>>>        Forward Send Construct_Object
41194>>>>>>>>>>>>>        Property String     psOldCode       Public ''
41195>>>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
41196>>>>>>>>>>>>>        Property String     psOldUserID     Public ''
41197>>>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
41198>>>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0 
41199>>>>>>>>>>>>>        Property Integer    PifromBhma1     Public  0 
41200>>>>>>>>>>>>>        //------------------------------------------------
41200>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41200>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
41200>>>>>>>>>>>>>        // einai 1     js 03/12/2007
41200>>>>>>>>>>>>>        //------------------------------------------------  
41200>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
41201>>>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
41202>>>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
41203>>>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
41204>>>>>>>>>>>>>        Property String  psAud_Old_ErgoDescr    Public ""
41205>>>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
41206>>>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
41207>>>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
41208>>>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
41209>>>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
41210>>>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
41211>>>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
41212>>>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
41213>>>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
41214>>>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0     
41215>>>>>>>>>>>>>        Property String  psAud_Old_Ektyposh     Public "" 
41216>>>>>>>>>>>>>        Property Integer piAud_Old_Timol        Public  0
41217>>>>>>>>>>>>>        Property Date    pdAud_Old_SapHmnia     Public ""
41218>>>>>>>>>>>>>        //------------------------------------------------
41218>>>>>>>>>>>>>    End_procedure
41219>>>>>>>>>>>>> 
41219>>>>>>>>>>>>> 
41219>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41220>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41222>>>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
41223>>>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
41224>>>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
41225>>>>>>>>>>>>>        //------------------------------------------------
41225>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
41225>>>>>>>>>>>>>        // ton pedion js 03/12/2007
41225>>>>>>>>>>>>>        //------------------------------------------------
41225>>>>>>>>>>>>>        Set psAud_Old_Pelaths       to Particle.Client_ID
41226>>>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
41227>>>>>>>>>>>>>        Set psAud_Old_Ergo          to Particle.CN_Code     
41228>>>>>>>>>>>>>        Set psAud_Old_ErgoDescr     to (fsVresCNDescr(Self,Particle.CN_Code))
41229>>>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Particle.Partl_Recr 
41230>>>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Particle.Partl_Recr 
41231>>>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
41232>>>>>>>>>>>>>        Set psAud_Old_Zonh          to Particle.Zone_ID
41233>>>>>>>>>>>>>        Set psAud_Old_Antlia        to Particle.Antlia_code
41234>>>>>>>>>>>>>        Set psAud_Old_Oxhma         to Particle.Oxhma_code
41235>>>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
41236>>>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
41237>>>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
41238>>>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No    
41239>>>>>>>>>>>>>        Set psAud_Old_Ektyposh      to Particle.Partl_Ektyposh 
41240>>>>>>>>>>>>>        Set piAud_Old_Timol         to Particle.Partl_Timol
41241>>>>>>>>>>>>>        Set pdAud_Old_SapHmnia      to Particle.Sap_hmnia
41242>>>>>>>>>>>>>
41242>>>>>>>>>>>>>        
41242>>>>>>>>>>>>>        //------------------------------------------------
41242>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
41243>>>>>>>>>>>>>
41243>>>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
41244>>>>>>>>>>>>>        Local Integer Changed
41245>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
41246>>>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
41248>>>>>>>>>>>>>            SysDate4 dDate
41249>>>>>>>>>>>>>            Set Field_Default_Value iField to dDate
41250>>>>>>>>>>>>>        End
41250>>>>>>>>>>>>>>
41250>>>>>>>>>>>>>    End_Procedure   // Shmera
41251>>>>>>>>>>>>>
41251>>>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
41252>>>>>>>>>>>>>        Local Integer Changed
41253>>>>>>>>>>>>>        Date dDate
41253>>>>>>>>>>>>>        Number nHour nMin
41253>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
41254>>>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
41256>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
41259>>>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
41260>>>>>>>>>>>>>        End
41260>>>>>>>>>>>>>>
41260>>>>>>>>>>>>>    End_Procedure   // Shmera
41261>>>>>>>>>>>>>
41261>>>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
41262>>>>>>>>>>>>>        Local Integer Changed
41263>>>>>>>>>>>>>        Date dDate
41263>>>>>>>>>>>>>        Number nHour nMin nTotal
41263>>>>>>>>>>>>>        String sOra sMin
41263>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
41264>>>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
41266>>>>>>>>>>>>>            SysDate4 dDate nHour nMin
41269>>>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
41270>>>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
41271>>>>>>>>>>>>>        End
41271>>>>>>>>>>>>>>
41271>>>>>>>>>>>>>    End_Procedure   // Shmera
41272>>>>>>>>>>>>>
41272>>>>>>>>>>>>>    Procedure Save_Main_File
41273>>>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
41274>>>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
41274>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
41274>>>>>>>>>>>>>        Date    dHmnia
41274>>>>>>>>>>>>>
41274>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
41277>>>>>>>>>>>>>
41277>>>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
41279>>>>>>>>>>>>>            Clear Cn
41280>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41281>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41282>>>>>>>>>>>>>>
41282>>>>>>>>>>>>>            If (Found) Begin
41284>>>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
41285>>>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
41286>>>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
41287>>>>>>>>>>>>>            End
41287>>>>>>>>>>>>>>
41287>>>>>>>>>>>>>            Else Begin
41288>>>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
41289>>>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
41290>>>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
41291>>>>>>>>>>>>>            End
41291>>>>>>>>>>>>>>
41291>>>>>>>>>>>>>        End
41291>>>>>>>>>>>>>>
41291>>>>>>>>>>>>>        Else Begin
41292>>>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
41293>>>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
41294>>>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
41295>>>>>>>>>>>>>        End
41295>>>>>>>>>>>>>>
41295>>>>>>>>>>>>>
41295>>>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
41296>>>>>>>>>>>>>
41296>>>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
41297>>>>>>>>>>>>>        Get piOldSelected               to iOldSelected
41298>>>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
41299>>>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
41300>>>>>>>>>>>>>
41300>>>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
41302>>>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
41305>>>>>>>>>>>>>        End
41305>>>>>>>>>>>>>>
41305>>>>>>>>>>>>>        Else Begin
41306>>>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
41307>>>>>>>>>>>>>        End
41307>>>>>>>>>>>>>>
41307>>>>>>>>>>>>>
41307>>>>>>>>>>>>>        Move 0 to nPosothtaKin
41308>>>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
41310>>>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
41312>>>>>>>>>>>>>                If (iSelected) Begin
41314>>>>>>>>>>>>>                    Clear Pmoves
41315>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41316>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
41317>>>>>>>>>>>>>>
41317>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41321>>>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
41322>>>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
41323>>>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
41324>>>>>>>>>>>>>                        Saverecord Pmoves
41325>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
41326>>>>>>>>>>>>>>
41326>>>>>>>>>>>>>                    Loop
41327>>>>>>>>>>>>>>
41327>>>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
41328>>>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
41329>>>>>>>>>>>>>                End
41329>>>>>>>>>>>>>>
41329>>>>>>>>>>>>>                Else Begin
41330>>>>>>>>>>>>>                    Clear Pmoves
41331>>>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
41332>>>>>>>>>>>>>                    Find Gt Pmoves by index.3
41333>>>>>>>>>>>>>>
41333>>>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
41337>>>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
41338>>>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
41339>>>>>>>>>>>>>                        Saverecord Pmoves
41340>>>>>>>>>>>>>                        Find Gt Pmoves by index.3
41341>>>>>>>>>>>>>>
41341>>>>>>>>>>>>>                    Loop
41342>>>>>>>>>>>>>>
41342>>>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
41343>>>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
41344>>>>>>>>>>>>>                End
41344>>>>>>>>>>>>>>
41344>>>>>>>>>>>>>
41344>>>>>>>>>>>>>//                // js 11/04/2003
41344>>>>>>>>>>>>>//                If (iPmoves) Begin
41344>>>>>>>>>>>>>//                    Clear Pmoves
41344>>>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
41344>>>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
41344>>>>>>>>>>>>>//                End
41344>>>>>>>>>>>>>
41344>>>>>>>>>>>>>            End
41344>>>>>>>>>>>>>>
41344>>>>>>>>>>>>>            Set piFromMetasx to 0
41345>>>>>>>>>>>>>        End
41345>>>>>>>>>>>>>>
41345>>>>>>>>>>>>>
41345>>>>>>>>>>>>>        Forward Send Save_Main_File
41347>>>>>>>>>>>>>
41347>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
41348>>>>>>>>>>>>>
41348>>>>>>>>>>>>>
41348>>>>>>>>>>>>>    Procedure Calc_The_Totals
41349>>>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
41350>>>>>>>>>>>>>
41350>>>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
41351>>>>>>>>>>>>>
41351>>>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
41352>>>>>>>>>>>>>
41352>>>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
41353>>>>>>>>>>>>>
41353>>>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
41355>>>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
41356>>>>>>>>>>>>>        End
41356>>>>>>>>>>>>>>
41356>>>>>>>>>>>>>
41356>>>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
41358>>>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
41359>>>>>>>>>>>>>        End
41359>>>>>>>>>>>>>>
41359>>>>>>>>>>>>>
41359>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41359>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41359>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41359>>>>>>>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
41361>>>>>>>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
41362>>>>>>>>>>>>>        End
41362>>>>>>>>>>>>>>
41362>>>>>>>>>>>>>        Else Begin
41363>>>>>>>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
41366>>>>>>>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
41368>>>>>>>>>>>>>        End
41368>>>>>>>>>>>>>>
41368>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41368>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41368>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41368>>>>>>>>>>>>>
41368>>>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
41369>>>>>>>>>>>>>
41369>>>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
41371>>>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
41372>>>>>>>>>>>>>
41372>>>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
41373>>>>>>>>>>>>>
41373>>>>>>>>>>>>>        End
41373>>>>>>>>>>>>>>
41373>>>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
41375>>>>>>>>>>>>>
41375>>>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
41376>>>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
41377>>>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
41378>>>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
41379>>>>>>>>>>>>>    End_Procedure
41380>>>>>>>>>>>>>
41380>>>>>>>>>>>>>    Procedure Find_The_Rate
41381>>>>>>>>>>>>>        String  sCode sWhat
41382>>>>>>>>>>>>>        Integer iRateID
41382>>>>>>>>>>>>>        Number nEuro nIsot nRate
41382>>>>>>>>>>>>>        Date dHmnia
41382>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
41383>>>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
41386>>>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
41387>>>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
41388>>>>>>>>>>>>>        If (nIsot=0) Begin
41390>>>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
41393>>>>>>>>>>>>>            Move (Trim(sCode)) to sCode
41394>>>>>>>>>>>>>            Clear Isotimia
41395>>>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
41396>>>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
41397>>>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
41398>>>>>>>>>>>>>>
41398>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41401>>>>>>>>>>>>>            Else Begin
41402>>>>>>>>>>>>>                Case Begin
41402>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
41404>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
41405>>>>>>>>>>>>>                        Case Break
41406>>>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
41409>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
41410>>>>>>>>>>>>>                        Case Break
41411>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
41414>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
41415>>>>>>>>>>>>>                        Case Break
41416>>>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
41419>>>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
41420>>>>>>>>>>>>>                        Case Break
41421>>>>>>>>>>>>>                Case End
41421>>>>>>>>>>>>>            End
41421>>>>>>>>>>>>>>
41421>>>>>>>>>>>>>        End
41421>>>>>>>>>>>>>>
41421>>>>>>>>>>>>>        Else Begin
41422>>>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
41425>>>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
41426>>>>>>>>>>>>>            Clear Nomisma
41427>>>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
41428>>>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
41429>>>>>>>>>>>>>>
41429>>>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
41432>>>>>>>>>>>>>        End
41432>>>>>>>>>>>>>>
41432>>>>>>>>>>>>>    End_Procedure
41433>>>>>>>>>>>>>
41433>>>>>>>>>>>>>    Procedure Update
41434>>>>>>>>>>>>>        String  sCodeApo sCodeEos
41435>>>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
41435>>>>>>>>>>>>>        Integer iBreak iPmovesID
41435>>>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
41435>>>>>>>>>>>>>        Date    dHmnia
41435>>>>>>>>>>>>>
41435>>>>>>>>>>>>>        Forward Send Update
41437>>>>>>>>>>>>>
41437>>>>>>>>>>>>>        Send Find_The_Rate
41438>>>>>>>>>>>>>
41438>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
41439>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
41440>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
41441>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
41442>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
41443>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
41443>>>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
41444>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
41445>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
41446>>>>>>>>>>>>>
41446>>>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
41447>>>>>>>>>>>>>
41447>>>>>>>>>>>>>        Send Calc_The_Totals
41448>>>>>>>>>>>>>
41448>>>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
41449>>>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
41450>>>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
41451>>>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
41452>>>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
41453>>>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
41454>>>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
41455>>>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
41456>>>>>>>>>>>>>
41456>>>>>>>>>>>>>
41456>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41456>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41456>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41456>>>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41456>>>>>>>>>>>>>//            Clear PartlFpa
41456>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41456>>>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41456>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41456>>>>>>>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
41456>>>>>>>>>>>>>//            Saverecord PartlFpa
41456>>>>>>>>>>>>>//        End
41456>>>>>>>>>>>>>
41456>>>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41456>>>>>>>>>>>>>//            Clear PartlFpa
41456>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41456>>>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41456>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41456>>>>>>>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
41456>>>>>>>>>>>>>//            Saverecord PartlFpa
41456>>>>>>>>>>>>>//        End
41456>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41456>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41456>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41456>>>>>>>>>>>>>
41456>>>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
41456>>>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
41456>>>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
41456>>>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
41456>>>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
41456>>>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
41456>>>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
41459>>>>>>>>>>>>>        // 01/10/2001
41459>>>>>>>>>>>>>
41459>>>>>>>>>>>>>
41459>>>>>>>>>>>>>        //---------------------------------------------
41459>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
41459>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41459>>>>>>>>>>>>>            //MODE_WAITING  
41459>>>>>>>>>>>>>            //MODE_FINDING  
41459>>>>>>>>>>>>>            //MODE_CLEARING 
41459>>>>>>>>>>>>>            //MODE_CREATING 
41459>>>>>>>>>>>>>            //MODE_SAVING   
41459>>>>>>>>>>>>>            //MODE_DELETING 
41459>>>>>>>>>>>>>            //MODE_ABORTING 
41459>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41459>>>>>>>>>>>>>        Date    dDate  Shmer 
41459>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
41459>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41463>>>>>>>>>>>>>        Move iHour  to sHour
41464>>>>>>>>>>>>>        Move iMin   to sMin
41465>>>>>>>>>>>>>        Move iSec   to sSec
41466>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41470>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41474>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41478>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41479>>>>>>>>>>>>>        
41479>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41479>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41481>>>>>>>>>>>>>            Get fsLoginUserID to sUser
41482>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
41484>>>>>>>>>>>>>                clear gmove
41485>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
41486>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41487>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
41488>>>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
41489>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
41490>>>>>>>>>>>>>                move Particle.partl_no      to gmove.garticl_no
41491>>>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
41492>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
41493>>>>>>>>>>>>>                move Particle.Partl_Recr    to gmove.garticl_recr
41494>>>>>>>>>>>>>                reread sysrecg
41498>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41499>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41500>>>>>>>>>>>>>                saverecord sysrecg
41501>>>>>>>>>>>>>                unlock
41502>>>>>>>>>>>>>>
41502>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
41503>>>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
41504>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41505>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41506>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41507>>>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
41508>>>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
41509>>>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
41510>>>>>>>>>>>>>                Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                    to gmove.Cur_CN_Addr 
41511>>>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41512>>>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41513>>>>>>>>>>>>>                Move Particle.Zone_ID               to Gmove.Cur_Zonh
41514>>>>>>>>>>>>>                Move Particle.Antlia_code           to Gmove.Cur_Antlia
41515>>>>>>>>>>>>>                Move Particle.Oxhma_code            to Gmove.Cur_Oxhma       
41516>>>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
41517>>>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
41518>>>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
41519>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ §˜¨˜©«˜« ¡¦ç" to sText
41520>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
41521>>>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
41522>>>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
41523>>>>>>>>>>>>>                saverecord gmove
41524>>>>>>>>>>>>>                Set piCreateNew to 0
41525>>>>>>>>>>>>>            End
41525>>>>>>>>>>>>>>
41525>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41528>>>>>>>>>>>>>                Integer isChanged
41528>>>>>>>>>>>>>                Move 0 to isChanged
41529>>>>>>>>>>>>>                
41529>>>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths (Self))<>Trim(Clients.Client_ID      ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Particle.CN_Code    ))) Move 1 to isChanged    
41532>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh    (Self))<>Trim(Particle.Zone_ID       ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Particle.Antlia_code))) Move 1 to isChanged   
41536>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma   (Self))<>Trim(Particle.Oxhma_code    ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
41540>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira   (Self))<>Trim(Particle.Pseira_Seira  ))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
41544>>>>>>>>>>>>>                Else If  (piAud_Old_No           (Self) <>Particle.Partl_No)                                                                                 Move 1 to isChanged
41548>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh))   Or  (piAud_Old_Timol(Self)<>Particle.Partl_Timol               )) Move 1 to isChanged  
41552>>>>>>>>>>>>>                Else If  (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia) Move 1 to isChanged
41556>>>>>>>>>>>>>
41556>>>>>>>>>>>>>                If (isChanged>0) Begin  
41558>>>>>>>>>>>>>                    clear gmove
41559>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41560>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41561>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41562>>>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
41563>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41564>>>>>>>>>>>>>                    move Particle.partl_no      to gmove.garticl_no
41565>>>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
41566>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
41567>>>>>>>>>>>>>                    move Particle.Partl_Recr    to gmove.garticl_recr
41568>>>>>>>>>>>>>                    reread sysrecg
41572>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41573>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41574>>>>>>>>>>>>>                    saverecord sysrecg
41575>>>>>>>>>>>>>                    unlock
41576>>>>>>>>>>>>>>
41576>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41577>>>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
41578>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41579>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41580>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41581>>>>>>>>>>>>>                    //--
41581>>>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
41582>>>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Pms_Recr  
41583>>>>>>>>>>>>>                    //--
41583>>>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
41584>>>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
41585>>>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
41586>>>>>>>>>>>>>                    Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                        to gmove.Cur_CN_Addr 
41587>>>>>>>>>>>>>                    Move (Trim(Particle.Zone_ID     ))  to Gmove.Cur_Zonh
41588>>>>>>>>>>>>>                    Move (Trim(Particle.Antlia_code ))  to Gmove.Cur_Antlia
41589>>>>>>>>>>>>>                    Move (Trim(Particle.Oxhma_code  ))  to Gmove.Cur_Oxhma       
41590>>>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
41591>>>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
41592>>>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
41593>>>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No     
41594>>>>>>>>>>>>>                    Move Particle.Sap_hmnia             to Gmove.Date1
41595>>>>>>>>>>>>>                    //--
41595>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
41596>>>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
41597>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
41598>>>>>>>>>>>>>                    Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                          to gmove.Prev_CN_Addr 
41599>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
41600>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
41601>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
41602>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
41603>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
41604>>>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
41605>>>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
41606>>>>>>>>>>>>>                    Move (pdAud_Old_SapHmnia     (Self )) to gmove.Date2 
41607>>>>>>>>>>>>>                    
41607>>>>>>>>>>>>>                    //--  
41607>>>>>>>>>>>>>                    If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh)) Or (piAud_Old_Timol(Self)<>Particle.Partl_Timol) Or ;                        (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia)) Move "€¤¦ š£˜ ˜¨˜©«˜« ¡¦ç - BACK DOOR"    to sText 
41610>>>>>>>>>>>>>                    Else Move "ƒ æ¨Ÿà©ž ˜¨˜©«˜« ¡¦ç"               to sText 
41612>>>>>>>>>>>>>                    
41612>>>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
41613>>>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
41614>>>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
41615>>>>>>>>>>>>>                    saverecord gmove
41616>>>>>>>>>>>>>                    Set piCreateNew to 0
41617>>>>>>>>>>>>>                End
41617>>>>>>>>>>>>>>
41617>>>>>>>>>>>>>            End
41617>>>>>>>>>>>>>>
41617>>>>>>>>>>>>>        End
41617>>>>>>>>>>>>>>
41617>>>>>>>>>>>>>
41617>>>>>>>>>>>>>
41617>>>>>>>>>>>>>    End_Procedure   // Update
41618>>>>>>>>>>>>>
41618>>>>>>>>>>>>>    Procedure Delete_Main_File
41619>>>>>>>>>>>>>        //---------------------------------------------
41619>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
41619>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
41619>>>>>>>>>>>>>            //MODE_WAITING  
41619>>>>>>>>>>>>>            //MODE_FINDING  
41619>>>>>>>>>>>>>            //MODE_CLEARING 
41619>>>>>>>>>>>>>            //MODE_CREATING 
41619>>>>>>>>>>>>>            //MODE_SAVING   
41619>>>>>>>>>>>>>            //MODE_DELETING 
41619>>>>>>>>>>>>>            //MODE_ABORTING 
41619>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41620>>>>>>>>>>>>>        Date    dDate  Shmer 
41620>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
41620>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
41624>>>>>>>>>>>>>        Move iHour  to sHour
41625>>>>>>>>>>>>>        Move iMin   to sMin
41626>>>>>>>>>>>>>        Move iSec   to sSec
41627>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41631>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41635>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41639>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41640>>>>>>>>>>>>>        
41640>>>>>>>>>>>>>        // Auditing / Diagrafh 
41640>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41642>>>>>>>>>>>>>            Get fsLoginUserID to sUser
41643>>>>>>>>>>>>>
41643>>>>>>>>>>>>>            clear gmove
41644>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
41645>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41646>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
41647>>>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
41648>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
41649>>>>>>>>>>>>>            move Particle.partl_no      to gmove.garticl_no
41650>>>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
41651>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
41652>>>>>>>>>>>>>            move Particle.Partl_Recr    to gmove.garticl_recr
41653>>>>>>>>>>>>>            reread sysrecg
41657>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41658>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41659>>>>>>>>>>>>>            saverecord sysrecg
41660>>>>>>>>>>>>>            unlock
41661>>>>>>>>>>>>>>
41661>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
41662>>>>>>>>>>>>>
41662>>>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
41663>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41664>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
41665>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41666>>>>>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41667>>>>>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41668>>>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
41669>>>>>>>>>>>>>            Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                to gmove.Prev_CN_Addr 
41670>>>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
41671>>>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
41672>>>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
41673>>>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
41674>>>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
41675>>>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
41676>>>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
41677>>>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
41678>>>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
41679>>>>>>>>>>>>>            Move (pdAud_Old_SapHmnia (Self ))   to gmove.Date2 
41680>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã ˜¨˜©«˜« ¡¦ç" to sText
41681>>>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
41682>>>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
41683>>>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
41684>>>>>>>>>>>>>            saverecord gmove
41685>>>>>>>>>>>>>        End
41685>>>>>>>>>>>>>>
41685>>>>>>>>>>>>>
41685>>>>>>>>>>>>>        Forward Send Delete_Main_File
41687>>>>>>>>>>>>>
41687>>>>>>>>>>>>>    End_Procedure
41688>>>>>>>>>>>>>
41688>>>>>>>>>>>>>    Procedure Backout
41689>>>>>>>>>>>>>        Forward Send Backout
41691>>>>>>>>>>>>>        Send Calc_The_Totals
41692>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41692>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41692>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41692>>>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
41692>>>>>>>>>>>>>//            Clear PartlFpa
41692>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41692>>>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
41692>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41692>>>>>>>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
41692>>>>>>>>>>>>>//            Saverecord PartlFpa
41692>>>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41692>>>>>>>>>>>>>//        End
41692>>>>>>>>>>>>>
41692>>>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
41692>>>>>>>>>>>>>//            Clear PartlFpa
41692>>>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
41692>>>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
41692>>>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
41692>>>>>>>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
41692>>>>>>>>>>>>>//            Saverecord PartlFpa
41692>>>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
41692>>>>>>>>>>>>>//        End
41692>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41692>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
41692>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
41692>>>>>>>>>>>>>
41692>>>>>>>>>>>>>
41692>>>>>>>>>>>>>    End_Procedure
41693>>>>>>>>>>>>>
41693>>>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
41694>>>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
41695>>>>>>>>>>>>>
41695>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41695>>>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
41697>>>>>>>>>>>>>            Clear Pseira
41698>>>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
41699>>>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
41700>>>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
41700>>>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
41700>>>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
41700>>>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
41701>>>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
41702>>>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
41703>>>>>>>>>>>>>>
41703>>>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
41703>>>>>>>>>>>>>            If (Found=1) Begin
41705>>>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
41705>>>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
41707>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
41708>>>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
41709>>>>>>>>>>>>>                    Saverecord Pseira
41710>>>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
41711>>>>>>>>>>>>>                End
41711>>>>>>>>>>>>>>
41711>>>>>>>>>>>>>            End
41711>>>>>>>>>>>>>>
41711>>>>>>>>>>>>>        End
41711>>>>>>>>>>>>>>
41711>>>>>>>>>>>>>        Else Begin
41712>>>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
41712>>>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
41714>>>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
41715>>>>>>>>>>>>>            End
41715>>>>>>>>>>>>>>
41715>>>>>>>>>>>>>        End
41715>>>>>>>>>>>>>>
41715>>>>>>>>>>>>>    End_Procedure
41716>>>>>>>>>>>>>
41716>>>>>>>>>>>>>    Procedure Creating
41717>>>>>>>>>>>>>        Integer iNextNo
41718>>>>>>>>>>>>>        String  sNo sSeira
41718>>>>>>>>>>>>>        Forward Send Creating
41720>>>>>>>>>>>>>        // Insert Code Here
41720>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
41721>>>>>>>>>>>>>
41721>>>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 19 to Particle.Disc_Vat_Pct
41724>>>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 19 to Particle.Partl_ExtraVatP
41727>>>>>>>>>>>>>
41727>>>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
41728>>>>>>>>>>>>>
41728>>>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
41730>>>>>>>>>>>>>            Clear Cn
41731>>>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
41732>>>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
41733>>>>>>>>>>>>>>
41733>>>>>>>>>>>>>            If (Found) Begin
41735>>>>>>>>>>>>>                Move Particle.Partl_No      to sNo
41736>>>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
41737>>>>>>>>>>>>>                Move (Trim(sNo))            to sNo
41738>>>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
41739>>>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
41742>>>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
41743>>>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
41744>>>>>>>>>>>>>                Saverecord CN
41745>>>>>>>>>>>>>            End
41745>>>>>>>>>>>>>>
41745>>>>>>>>>>>>>        End 
41745>>>>>>>>>>>>>>
41745>>>>>>>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
41745>>>>>>>>>>>>>        // kai sta aytonoma deltia apostolhs
41745>>>>>>>>>>>>>        if (PifromBhma1(self)=0) begin
41747>>>>>>>>>>>>>            if (clients.client_ptyppar='100') begin
41749>>>>>>>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
41752>>>>>>>>>>>>>            end
41752>>>>>>>>>>>>>>
41752>>>>>>>>>>>>>            else if (clients.client_ptyppar='113') begin 
41755>>>>>>>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
41758>>>>>>>>>>>>>            end
41758>>>>>>>>>>>>>>
41758>>>>>>>>>>>>>        End
41758>>>>>>>>>>>>>>
41758>>>>>>>>>>>>>        
41758>>>>>>>>>>>>>        Set piCreateNew to 1
41759>>>>>>>>>>>>>    
41759>>>>>>>>>>>>>    End_Procedure   // Creating
41760>>>>>>>>>>>>>
41760>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
41761>>>>>>>>>>>>>        String sStr
41762>>>>>>>>>>>>>        Move '' to sStr
41763>>>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
41764>>>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
41765>>>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
41767>>>>>>>>>>>>>
41767>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
41770>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
41774>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
41778>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
41782>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41786>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
41790>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41794>>>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
41798>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
41802>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
41806>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
41810>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
41814>>>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
41818>>>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
41822>>>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
41826>>>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
41830>>>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41834>>>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
41838>>>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
41842>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
41846>>>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
41850>>>>>>>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
41854>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
41857>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
41858>>>>>>>>>>>>>
41858>>>>>>>>>>>>>    Function Validate_Save Returns Integer
41859>>>>>>>>>>>>>        Number nqty
41860>>>>>>>>>>>>>        Integer iReturnVal iYes
41860>>>>>>>>>>>>>        String  sCurrentUserID sOldUserID
41860>>>>>>>>>>>>>
41860>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41862>>>>>>>>>>>>>
41862>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41864>>>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
41867>>>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
41871>>>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
41875>>>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
41879>>>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
41883>>>>>>>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
41883>>>>>>>>>>>>>            Else Begin
41884>>>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41884>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41884>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
41884>>>>>>>>>>>>>//                End
41884>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
41884>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41884>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41884>>>>>>>>>>>>>//                End
41884>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
41884>>>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
41884>>>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
41884>>>>>>>>>>>>>//                End
41884>>>>>>>>>>>>>
41884>>>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
41887>>>>>>>>>>>>>                Else Begin
41888>>>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
41890>>>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
41891>>>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
41892>>>>>>>>>>>>>                        If (sOldUserID<>'') Begin
41894>>>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
41897>>>>>>>>>>>>>                        End
41897>>>>>>>>>>>>>>
41897>>>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
41897>>>>>>>>>>>>>                    End
41897>>>>>>>>>>>>>>
41897>>>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
41897>>>>>>>>>>>>>                End
41897>>>>>>>>>>>>>>
41897>>>>>>>>>>>>>            End
41897>>>>>>>>>>>>>>
41897>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
41897>>>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
41897>>>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
41897>>>>>>>>>>>>>//               ginoun ekptoseis 100%.
41897>>>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
41897>>>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
41897>>>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
41897>>>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
41897>>>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
41897>>>>>>>>>>>>>//               varesei to validation.
41897>>>>>>>>>>>>>
41897>>>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
41897>>>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
41897>>>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
41897>>>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
41897>>>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
41897>>>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
41897>>>>>>>>>>>>>//                    Move 6051 to iReturnVal
41897>>>>>>>>>>>>>
41897>>>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
41897>>>>>>>>>>>>>
41897>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41900>>>>>>>>>>>>>        End
41900>>>>>>>>>>>>>>
41900>>>>>>>>>>>>>        Function_Return iReturnVal
41901>>>>>>>>>>>>>    End_Function   // Validate_Save
41902>>>>>>>>>>>>>
41902>>>>>>>>>>>>>
41902>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
41903>>>>>>>>>>>>>        Integer iReturnVal
41904>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
41906>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
41908>>>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
41911>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
41915>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41918>>>>>>>>>>>>>        End
41918>>>>>>>>>>>>>>
41918>>>>>>>>>>>>>        Function_Return iReturnVal
41919>>>>>>>>>>>>>    End_Function   // Validate_Delete
41920>>>>>>>>>>>>>
41920>>>>>>>>>>>>>
41920>>>>>>>>>>>>>    // Define_Fields:
41920>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41920>>>>>>>>>>>>>
41920>>>>>>>>>>>>>    Procedure Define_Fields
41921>>>>>>>>>>>>>        Forward Send Define_Fields
41923>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41923>>>>>>>>>>>>>        //DDB-DefineFieldStart
41923>>>>>>>>>>>>>
41923>>>>>>>>>>>>>        Set Main_File            To Particle.File_Number
41924>>>>>>>>>>>>>
41924>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41925>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41926>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41927>>>>>>>>>>>>>
41927>>>>>>>>>>>>>        // Child (Client) file structure................
41927>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
41928>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
41929>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
41930>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
41931>>>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
41932>>>>>>>>>>>>>
41932>>>>>>>>>>>>>        // Parent (Server) file structure...............
41932>>>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
41933>>>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
41934>>>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
41935>>>>>>>>>>>>>
41935>>>>>>>>>>>>>        // External (System) file structure.............
41935>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
41936>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
41937>>>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
41938>>>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
41939>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
41940>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
41941>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
41942>>>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
41943>>>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
41944>>>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
41945>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41946>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41947>>>>>>>>>>>>>
41947>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Field-based properties.......................
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Company_Code
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Branch_Code
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Year_Year
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Ctypkin_Code
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Wtypkin_Code
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Ptyppar_Code
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Pseira_Seira
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Custprom_Code
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Client_Id
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Partl_No
41950>>>>>>>>>>>>>
41950>>>>>>>>>>>>>        // Particle.Cn_Recr
41950>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
41951>>>>>>>>>>>>>
41951>>>>>>>>>>>>>        // Particle.Pseira_Recr
41951>>>>>>>>>>>>>
41951>>>>>>>>>>>>>        // Particle.Partl_Hmnia
41951>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
41952>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
41953>>>>>>>>>>>>>
41953>>>>>>>>>>>>>        // Particle.Partl_Rec0
41953>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Lastno
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Tdiakin
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Car
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Reldoc
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Toposf
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Toposa
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Troposa
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Tof
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Disctof
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Disccl
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Autodisc
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Time
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Totambd
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Amdiscpms
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Totdiscpc
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Discam
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Totamad
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Vatpct
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Vatam
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Genam
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Extra
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Extravatp
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Extravat
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Payam
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Befypol
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Currypol
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Tottem
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Det
41954>>>>>>>>>>>>>
41954>>>>>>>>>>>>>        // Particle.Partl_Recr
41954>>>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
41955>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
41956>>>>>>>>>>>>>
41956>>>>>>>>>>>>>        // Particle.Cn_Code
41956>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Client_Recr
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Ptyppar_Recr
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Ekleise
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Ektyposh
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Akyrosh
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Nooflines
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Cmoves_Recr
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Nomisma_Code
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Isotimia
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Wcmoves_Recr
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Module
41957>>>>>>>>>>>>>
41957>>>>>>>>>>>>>        // Particle.Partl_Timol
41957>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
41958>>>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Partl_Selected
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Partl_Tim_Recr
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Partl_Vsn
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Sls_Id
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Presp_Id
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Cnt_Id
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Topos_Apostolhs
41959>>>>>>>>>>>>>
41959>>>>>>>>>>>>>        // Particle.Tropos_Diakin
41959>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
41960>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
41961>>>>>>>>>>>>>
41961>>>>>>>>>>>>>        // Particle.Ora_Apostolhs
41961>>>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
41962>>>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
41963>>>>>>>>>>>>>
41963>>>>>>>>>>>>>        // Particle.Skopos_Diakin
41963>>>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
41964>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
41965>>>>>>>>>>>>>
41965>>>>>>>>>>>>>        // Particle.Tropos_Plhromhs
41965>>>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
41966>>>>>>>>>>>>>
41966>>>>>>>>>>>>>        // Particle.Odhgos_Code
41966>>>>>>>>>>>>>
41966>>>>>>>>>>>>>        // Particle.Odhgos_Name
41966>>>>>>>>>>>>>
41966>>>>>>>>>>>>>        // Particle.Oxhma_Code
41966>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
41967>>>>>>>>>>>>>
41967>>>>>>>>>>>>>        // Particle.Oxhma_Descr
41967>>>>>>>>>>>>>
41967>>>>>>>>>>>>>        // Particle.Antlia_Code
41967>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Antlia_Descr
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Partl_Euro
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Disc_Vat_Pct
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Disc_Vat_Poso
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Total_Vat_Poso
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Exei_Sxetika
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Aitiol
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Max_Days_Date
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Timol_Qty
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Timol_Ypol
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.No_Print_Module
41968>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Prohg_Ypol
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Trex_Ypol
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Parakrat_Pct
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Parakrat_Poso
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Cms_Parak_Recr
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Enhm_Logik
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Se_Logik
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Akyro
41968>>>>>>>>>>>>>
41968>>>>>>>>>>>>>        // Particle.Zone_Id
41968>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
41969>>>>>>>>>>>>>
41969>>>>>>>>>>>>>        // Particle.Fpa_On_Total
41969>>>>>>>>>>>>>
41969>>>>>>>>>>>>>        // Particle.Ss_Arithmos
41969>>>>>>>>>>>>>
41969>>>>>>>>>>>>>        // Particle.Sap_Hmnia
41969>>>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
41970>>>>>>>>>>>>>
41970>>>>>>>>>>>>>        //DDB-DefineFieldEnd
41970>>>>>>>>>>>>>    End_Procedure    // Define_Fields
41971>>>>>>>>>>>>>
41971>>>>>>>>>>>>>    // Field_Defaults:
41971>>>>>>>>>>>>>    // This procedure is used to establish default field values.
41971>>>>>>>>>>>>>
41971>>>>>>>>>>>>>    Procedure Field_Defaults
41972>>>>>>>>>>>>>        Forward Send Field_Defaults
41974>>>>>>>>>>>>>        //DDB-Generated-Code-Location
41974>>>>>>>>>>>>>        //DDB-FieldDefaultStart
41974>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
41974>>>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
41975>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
41976>>>>>>>>>>>>>
41976>>>>>>>>>>>>>End_Class    // Particle_DataDictionary
41977>>>>>>>>>>>>>//DDB-Selection-pkg-Start
41977>>>>>>>>>>>>>
41977>>>>>>>>>>>>>Use sl041.SL         // sl041
41977>>>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
41977>>>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
41977>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41977>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
41977>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
41977>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41977>>>>>>>>>>>>>>>
41977>>>>>>>>>>>>>>>// Project Object Structure
41977>>>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
41977>>>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
41977>>>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
41977>>>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
41977>>>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
41977>>>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
41977>>>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
41977>>>>>>>>>>>>>>>//     oSelList is a dbListSub
41977>>>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
41977>>>>>>>>>>>>>>>//     FormSub1 is a FormSub
41977>>>>>>>>>>>>>>>//     FormSub3 is a FormSub
41977>>>>>>>>>>>>>>>//     FormSub2 is a FormSub
41977>>>>>>>>>>>>>>>//     FormSub4 is a FormSub
41977>>>>>>>>>>>>>>>//     FormSub5 is a FormSub
41977>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
41977>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
41977>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
41977>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
41977>>>>>>>>>>>>>>>//     oOk_bn is a ButtonSub
41977>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41977>>>>>>>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
41977>>>>>>>>>>>>>>>
41977>>>>>>>>>>>>>>>// Register all objects
41977>>>>>>>>>>>>>>>Register_Object ButtonSub1
41977>>>>>>>>>>>>>>>Register_Object Clients_DD
41977>>>>>>>>>>>>>>>Register_Object Ctypkin_DD
41977>>>>>>>>>>>>>>>Register_Object cSyDateForm1
41977>>>>>>>>>>>>>>>Register_Object FormSub1
41977>>>>>>>>>>>>>>>Register_Object FormSub2
41977>>>>>>>>>>>>>>>Register_Object FormSub3
41977>>>>>>>>>>>>>>>Register_Object FormSub4
41977>>>>>>>>>>>>>>>Register_Object FormSub5
41977>>>>>>>>>>>>>>>Register_Object Nomisma_DD
41977>>>>>>>>>>>>>>>Register_Object oOk_bn
41977>>>>>>>>>>>>>>>Register_Object oSearch_bn
41977>>>>>>>>>>>>>>>Register_Object oSelList
41977>>>>>>>>>>>>>>>Register_Object Particle_DD
41977>>>>>>>>>>>>>>>Register_Object Ptyppar_DD
41977>>>>>>>>>>>>>>>Register_Object sl014
41977>>>>>>>>>>>>>>>Register_Object TextBoxSub1
41977>>>>>>>>>>>>>>>Register_Object TextBoxSub2
41977>>>>>>>>>>>>>>>Register_Object TextBoxSub3
41977>>>>>>>>>>>>>>>Register_Object TextBoxSub4
41977>>>>>>>>>>>>>>>Register_Object Wtypkin_DD
41977>>>>>>>>>>>>>>>
41977>>>>>>>>>>>>>>>
41977>>>>>>>>>>>>>>>
41977>>>>>>>>>>>>>>>//AB-StoreTopStart
41977>>>>>>>>>>>>>>>            
41977>>>>>>>>>>>>>>>Open PtypparL
41979>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>Use sl100.sl
41979>>>>>>>>>>>>>>>Use sl012.sl
41979>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>//AB-StoreTopEnd
41979>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>//AB-IgnoreStart
41979>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>Use DFAllEnt.pkg
41979>>>>>>>>>>>>>>>Use dbList.Sub
41979>>>>>>>>>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
41979>>>>>>>>>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
41979>>>>>>>>>>>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
41979>>>>>>>>>>>>>>>>>>>>>//AB/ Project Calendar Outlook
41979>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41979>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
41979>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
41979>>>>>>>>>>>>>>>>>>>>>//   oCalendar is a BasicPanelSub
41979>>>>>>>>>>>>>>>>>>>>>//     Container3d1 is a Container3d
41979>>>>>>>>>>>>>>>>>>>>>//       Grid2 is a Grid
41979>>>>>>>>>>>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox2 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox3 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox4 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox5 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox6 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox7 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       Textbox8 is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//       LineControl1 is a LineControl
41979>>>>>>>>>>>>>>>>>>>>>//       Container3d2 is a Container3d
41979>>>>>>>>>>>>>>>>>>>>>//         oRght is a BitmapContainer
41979>>>>>>>>>>>>>>>>>>>>>//         oLeft is a BitmapContainer
41979>>>>>>>>>>>>>>>>>>>>>//         oMonth is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
41979>>>>>>>>>>>>>>>>>>>>>//         oCalendarYear is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//         oSelectCalendarYear is a Form
41979>>>>>>>>>>>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
41979>>>>>>>>>>>>>>>>>>>>>//     oToday is a Textbox
41979>>>>>>>>>>>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
41979>>>>>>>>>>>>>>>>>>>>>//     Help_Container is a Container3d
41979>>>>>>>>>>>>>>>>>>>>>//       Help_Info is a Edit
41979>>>>>>>>>>>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>// Register all objects
41979>>>>>>>>>>>>>>>>>>>>>Register_Object BitmapContainer3
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Container3d1
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Container3d2
41979>>>>>>>>>>>>>>>>>>>>>Register_Object cOutlookFloatingMenu
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Grid2
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Help_Container
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Help_Info
41979>>>>>>>>>>>>>>>>>>>>>Register_Object HelpFloatingMenu
41979>>>>>>>>>>>>>>>>>>>>>Register_Object LineControl1
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oCalendar
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oCalendarYear
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oCloseCalendar_bn
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oLeft
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oMonth
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oRght
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oSelectCalendarYear
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oSelectMonth
41979>>>>>>>>>>>>>>>>>>>>>Register_Object oToday
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox2
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox3
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox4
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox5
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox6
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox7
41979>>>>>>>>>>>>>>>>>>>>>Register_Object Textbox8
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>    //AB-StoreTopStart
41979>>>>>>>>>>>>>>>>>>>>>    Use dates.utl
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>    //AB-StoreTopEnd
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>    Use Panel.Sub
41979>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
41979>>>>>>>>>>>>>>>>>>>>>
41979>>>>>>>>>>>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
41981>>>>>>>>>>>>>>>>>>>>>        Set Border_Style to Border_Normal
41982>>>>>>>>>>>>>>>>>>>>>        Set Caption_Bar to FALSE
41983>>>>>>>>>>>>>>>>>>>>>        Set Label to "January, 2001"
41984>>>>>>>>>>>>>>>>>>>>>        Set Size to 98 123
41985>>>>>>>>>>>>>>>>>>>>>        Set Location to 10 22
41986>>>>>>>>>>>>>>>>>>>>>        Set Color to clWhite
41987>>>>>>>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
41988>>>>>>>>>>>>>>>>>>>>>        Set Popup_State to TRUE
41989>>>>>>>>>>>>>>>>>>>>>
41989>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
41989>>>>>>>>>>>>>>>>>>>>>
41989>>>>>>>>>>>>>>>>>>>>>
41989>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
41989>>>>>>>>>>>>>>>>>>>>>
41989>>>>>>>>>>>>>>>>>>>>>        Object Container3d1 is a Container3d
41991>>>>>>>>>>>>>>>>>>>>>            Set Size to 88 135
41992>>>>>>>>>>>>>>>>>>>>>            Set Location to -2 -1
41993>>>>>>>>>>>>>>>>>>>>>            Set Color to clWhite
41994>>>>>>>>>>>>>>>>>>>>>            Set Border_Style to Border_None
41995>>>>>>>>>>>>>>>>>>>>>            Object Grid2 is a Grid
41997>>>>>>>>>>>>>>>>>>>>>
41997>>>>>>>>>>>>>>>>>>>>>                //AB-StoreTopStart
41997>>>>>>>>>>>>>>>>>>>>>                property date    p_current_date     0
41999>>>>>>>>>>>>>>>>>>>>>                property integer p_current_year     -1
42001>>>>>>>>>>>>>>>>>>>>>                property integer p_current_month    -1
42003>>>>>>>>>>>>>>>>>>>>>                property integer p_selected_day     -1
42005>>>>>>>>>>>>>>>>>>>>>                property integer pExportState       1
42007>>>>>>>>>>>>>>>>>>>>>                property integer invoking_object_id 0
42009>>>>>>>>>>>>>>>>>>>>>                Property integer piCurrentDayItem   -1
42011>>>>>>>>>>>>>>>>>>>>>
42011>>>>>>>>>>>>>>>>>>>>>                Set Border_Style To BORDER_NONE
42012>>>>>>>>>>>>>>>>>>>>>                Set header_visible_state To False
42013>>>>>>>>>>>>>>>>>>>>>                set select_mode to no_select
42014>>>>>>>>>>>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
42015>>>>>>>>>>>>>>>>>>>>>
42015>>>>>>>>>>>>>>>>>>>>>                on_key Key_F1 Send Help
42016>>>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
42017>>>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
42018>>>>>>>>>>>>>>>>>>>>>                on_key          key_pgup send prev_month
42019>>>>>>>>>>>>>>>>>>>>>                on_key          key_pgdn send next_month
42020>>>>>>>>>>>>>>>>>>>>>                on_key key_enter         send move_value_out
42021>>>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
42022>>>>>>>>>>>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
42023>>>>>>>>>>>>>>>>>>>>>
42023>>>>>>>>>>>>>>>>>>>>>                //AB-StoreTopEnd
42023>>>>>>>>>>>>>>>>>>>>>
42023>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42024>>>>>>>>>>>>>>>>>>>>>                Set CurrentCellColor to clWhite
42025>>>>>>>>>>>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
42026>>>>>>>>>>>>>>>>>>>>>                Set Size to 61 145
42027>>>>>>>>>>>>>>>>>>>>>                Set Location to 30 1
42028>>>>>>>>>>>>>>>>>>>>>                Set Resize_Column_state to FALSE
42029>>>>>>>>>>>>>>>>>>>>>
42029>>>>>>>>>>>>>>>>>>>>>                Set Line_Width to 7 0
42030>>>>>>>>>>>>>>>>>>>>>
42030>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 0 to 18
42031>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
42032>>>>>>>>>>>>>>>>>>>>>
42032>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 1 to 18
42033>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
42034>>>>>>>>>>>>>>>>>>>>>
42034>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 2 to 18
42035>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 2 to "We"
42036>>>>>>>>>>>>>>>>>>>>>
42036>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 3 to 18
42037>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
42038>>>>>>>>>>>>>>>>>>>>>
42038>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 4 to 18
42039>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
42040>>>>>>>>>>>>>>>>>>>>>
42040>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 5 to 18
42041>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
42042>>>>>>>>>>>>>>>>>>>>>
42042>>>>>>>>>>>>>>>>>>>>>                Set Form_Width    item 6 to 18
42043>>>>>>>>>>>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
42044>>>>>>>>>>>>>>>>>>>>>
42044>>>>>>>>>>>>>>>>>>>>>
42044>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42044>>>>>>>>>>>>>>>>>>>>>
42044>>>>>>>>>>>>>>>>>>>>>                Procedure Change_Year
42046>>>>>>>>>>>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
42047>>>>>>>>>>>>>>>>>>>>>                End_Procedure // Change_Year
42048>>>>>>>>>>>>>>>>>>>>>
42048>>>>>>>>>>>>>>>>>>>>>                procedure go_today
42050>>>>>>>>>>>>>>>>>>>>>                    Date date#
42051>>>>>>>>>>>>>>>>>>>>>                    sysdate4 date#
42052>>>>>>>>>>>>>>>>>>>>>                    set p_current_date to date#
42053>>>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42054>>>>>>>>>>>>>>>>>>>>>                end_procedure
42055>>>>>>>>>>>>>>>>>>>>>
42055>>>>>>>>>>>>>>>>>>>>>                procedure next_month
42057>>>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
42058>>>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42059>>>>>>>>>>>>>>>>>>>>>                end_procedure
42060>>>>>>>>>>>>>>>>>>>>>
42060>>>>>>>>>>>>>>>>>>>>>                procedure prev_month
42062>>>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
42063>>>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42064>>>>>>>>>>>>>>>>>>>>>                end_procedure
42065>>>>>>>>>>>>>>>>>>>>>
42065>>>>>>>>>>>>>>>>>>>>>                procedure next_year
42067>>>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
42068>>>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42069>>>>>>>>>>>>>>>>>>>>>                end_procedure
42070>>>>>>>>>>>>>>>>>>>>>
42070>>>>>>>>>>>>>>>>>>>>>                procedure prev_year
42072>>>>>>>>>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
42073>>>>>>>>>>>>>>>>>>>>>                    Send Update_Calendar
42074>>>>>>>>>>>>>>>>>>>>>                end_procedure
42075>>>>>>>>>>>>>>>>>>>>>
42075>>>>>>>>>>>>>>>>>>>>>                Procedure Activate
42077>>>>>>>>>>>>>>>>>>>>>                    Date date#
42078>>>>>>>>>>>>>>>>>>>>>                    Forward Send Activate
42080>>>>>>>>>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
42081>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42082>>>>>>>>>>>>>>>>>>>>>
42082>>>>>>>>>>>>>>>>>>>>>                Procedure Update_Calendar
42084>>>>>>>>>>>>>>>>>>>>>                    Set Dynamic_Update_State To False
42085>>>>>>>>>>>>>>>>>>>>>                    send Fill_List
42086>>>>>>>>>>>>>>>>>>>>>                    Set Dynamic_Update_State To True
42087>>>>>>>>>>>>>>>>>>>>>                    // Send Update_Label
42087>>>>>>>>>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
42088>>>>>>>>>>>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
42089>>>>>>>>>>>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
42090>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42091>>>>>>>>>>>>>>>>>>>>>
42091>>>>>>>>>>>>>>>>>>>>>                Procedure Fill_List
42093>>>>>>>>>>>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
42094>>>>>>>>>>>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
42094>>>>>>>>>>>>>>>>>>>>>                    Date dToday
42094>>>>>>>>>>>>>>>>>>>>>                    Send Delete_Data
42095>>>>>>>>>>>>>>>>>>>>>
42095>>>>>>>>>>>>>>>>>>>>>                    Get p_current_date to date#
42096>>>>>>>>>>>>>>>>>>>>>
42096>>>>>>>>>>>>>>>>>>>>>                    SysDate4 dToday
42097>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
42098>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
42099>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
42100>>>>>>>>>>>>>>>>>>>>>
42100>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
42101>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
42102>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
42103>>>>>>>>>>>>>>>>>>>>>                    Set p_current_month To sel_month#
42104>>>>>>>>>>>>>>>>>>>>>                    Set p_current_year To sel_year#
42105>>>>>>>>>>>>>>>>>>>>>
42105>>>>>>>>>>>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
42106>>>>>>>>>>>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
42107>>>>>>>>>>>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
42108>>>>>>>>>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
42109>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
42110>>>>>>>>>>>>>>>>>>>>>
42110>>>>>>>>>>>>>>>>>>>>>                    If (first_item# > 0) Begin
42112>>>>>>>>>>>>>>>>>>>>>                        Move (first_item#-1) to day#
42113>>>>>>>>>>>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
42119>>>>>>>>>>>>>>>>>>>>>>
42119>>>>>>>>>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
42120>>>>>>>>>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
42121>>>>>>>>>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
42122>>>>>>>>>>>>>>>>>>>>>                            Decrement day#
42123>>>>>>>>>>>>>>>>>>>>>                        Loop
42124>>>>>>>>>>>>>>>>>>>>>>
42124>>>>>>>>>>>>>>>>>>>>>                    End
42124>>>>>>>>>>>>>>>>>>>>>>
42124>>>>>>>>>>>>>>>>>>>>>
42124>>>>>>>>>>>>>>>>>>>>>                    Move 1 To day#
42125>>>>>>>>>>>>>>>>>>>>>                    For iFor from first_item# to last_item#
42131>>>>>>>>>>>>>>>>>>>>>>
42131>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
42132>>>>>>>>>>>>>>>>>>>>>                        Set Entry_State Item iFor To False
42133>>>>>>>>>>>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
42135>>>>>>>>>>>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
42136>>>>>>>>>>>>>>>>>>>>>                            Set piCurrentDayItem to iFor
42137>>>>>>>>>>>>>>>>>>>>>                        End
42137>>>>>>>>>>>>>>>>>>>>>>
42137>>>>>>>>>>>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
42140>>>>>>>>>>>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
42141>>>>>>>>>>>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
42142>>>>>>>>>>>>>>>>>>>>>                        Set form_Mask item iFor To "## "
42143>>>>>>>>>>>>>>>>>>>>>                        Increment day#
42144>>>>>>>>>>>>>>>>>>>>>                    Loop
42145>>>>>>>>>>>>>>>>>>>>>>
42145>>>>>>>>>>>>>>>>>>>>>
42145>>>>>>>>>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
42146>>>>>>>>>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
42147>>>>>>>>>>>>>>>>>>>>>
42147>>>>>>>>>>>>>>>>>>>>>                    If (last_item# < 41) Begin
42149>>>>>>>>>>>>>>>>>>>>>                        Move 1 to day#
42150>>>>>>>>>>>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
42156>>>>>>>>>>>>>>>>>>>>>>
42156>>>>>>>>>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
42157>>>>>>>>>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
42158>>>>>>>>>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
42159>>>>>>>>>>>>>>>>>>>>>                            Increment day#
42160>>>>>>>>>>>>>>>>>>>>>                        Loop
42161>>>>>>>>>>>>>>>>>>>>>>
42161>>>>>>>>>>>>>>>>>>>>>                    End
42161>>>>>>>>>>>>>>>>>>>>>>
42161>>>>>>>>>>>>>>>>>>>>>
42161>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42162>>>>>>>>>>>>>>>>>>>>>
42162>>>>>>>>>>>>>>>>>>>>>                Procedure Help
42164>>>>>>>>>>>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
42164>>>>>>>>>>>>>>>>>>>>>                    Set Visible_State of Help_Container to True
42165>>>>>>>>>>>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
42166>>>>>>>>>>>>>>>>>>>>>                    Send Activate to Help_Container
42167>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42168>>>>>>>>>>>>>>>>>>>>>
42168>>>>>>>>>>>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
42170>>>>>>>>>>>>>>>>>>>>>                    Send Move_Value_Out
42171>>>>>>>>>>>>>>>>>>>>>                    forward send mouse_click window char_pos
42173>>>>>>>>>>>>>>>>>>>>>                end_procedure
42174>>>>>>>>>>>>>>>>>>>>>
42174>>>>>>>>>>>>>>>>>>>>>                Procedure Move_Value_Out
42176>>>>>>>>>>>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
42177>>>>>>>>>>>>>>>>>>>>>                    Date Date# next_date# prev_date#
42177>>>>>>>>>>>>>>>>>>>>>                    Get Current_Item To iItm
42178>>>>>>>>>>>>>>>>>>>>>                    If (pExportState(Self)) Begin
42180>>>>>>>>>>>>>>>>>>>>>                        Get Value Item iItm To iDay
42181>>>>>>>>>>>>>>>>>>>>>                        Get p_current_month to iMonth
42182>>>>>>>>>>>>>>>>>>>>>                        Get p_current_year  to iYear
42183>>>>>>>>>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
42184>>>>>>>>>>>>>>>>>>>>>
42184>>>>>>>>>>>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
42186>>>>>>>>>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
42187>>>>>>>>>>>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
42188>>>>>>>>>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
42189>>>>>>>>>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
42190>>>>>>>>>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
42191>>>>>>>>>>>>>>>>>>>>>                        End
42191>>>>>>>>>>>>>>>>>>>>>>
42191>>>>>>>>>>>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
42193>>>>>>>>>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
42194>>>>>>>>>>>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
42195>>>>>>>>>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
42196>>>>>>>>>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
42197>>>>>>>>>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
42198>>>>>>>>>>>>>>>>>>>>>                        End
42198>>>>>>>>>>>>>>>>>>>>>>
42198>>>>>>>>>>>>>>>>>>>>>
42198>>>>>>>>>>>>>>>>>>>>>                        Send Export_Date date#
42199>>>>>>>>>>>>>>>>>>>>>                    End
42199>>>>>>>>>>>>>>>>>>>>>>
42199>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42200>>>>>>>>>>>>>>>>>>>>>
42200>>>>>>>>>>>>>>>>>>>>>                Procedure Export_Date date date#
42202>>>>>>>>>>>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
42203>>>>>>>>>>>>>>>>>>>>>                    get invoking_object_id to focus#
42204>>>>>>>>>>>>>>>>>>>>>
42204>>>>>>>>>>>>>>>>>>>>>                    if focus# gt desktop begin
42206>>>>>>>>>>>>>>>>>>>>>                         get delegation_mode of focus# to dm#
42207>>>>>>>>>>>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
42208>>>>>>>>>>>>>>>>>>>>>                         get form_margin of focus# item current to margin#
42209>>>>>>>>>>>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
42210>>>>>>>>>>>>>>>>>>>>>                         set delegation_mode of focus# to dm#
42211>>>>>>>>>>>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
42214>>>>>>>>>>>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
42216>>>>>>>>>>>>>>>>>>>>>                         set item_changed_state of focus# item current to true
42217>>>>>>>>>>>>>>>>>>>>>                    end
42217>>>>>>>>>>>>>>>>>>>>>>
42217>>>>>>>>>>>>>>>>>>>>>                    Send Close_Calendar
42218>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42219>>>>>>>>>>>>>>>>>>>>>
42219>>>>>>>>>>>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
42221>>>>>>>>>>>>>>>>>>>>>
42221>>>>>>>>>>>>>>>>>>>>>                    Procedure Close_Calendar
42223>>>>>>>>>>>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
42224>>>>>>>>>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
42225>>>>>>>>>>>>>>>>>>>>>
42225>>>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
42226>>>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_None             ""
42227>>>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
42228>>>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
42229>>>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
42230>>>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
42231>>>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_None             ""
42232>>>>>>>>>>>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
42233>>>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_None             ""
42234>>>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
42235>>>>>>>>>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
42236>>>>>>>>>>>>>>>>>>>>>
42236>>>>>>>>>>>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
42237>>>>>>>>>>>>>>>>>>>>>
42237>>>>>>>>>>>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
42239>>>>>>>>>>>>>>>>>>>>>                    Integer new_item liMonth
42240>>>>>>>>>>>>>>>>>>>>>                    Date    ldSysdate
42240>>>>>>>>>>>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
42242>>>>>>>>>>>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
42244>>>>>>>>>>>>>>>>>>>>>                        If (new_item >= 0) Begin
42246>>>>>>>>>>>>>>>>>>>>>                            Sysdate4 ldSysdate
42247>>>>>>>>>>>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
42248>>>>>>>>>>>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
42251>>>>>>>>>>>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
42253>>>>>>>>>>>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
42256>>>>>>>>>>>>>>>>>>>>>                        End
42256>>>>>>>>>>>>>>>>>>>>>>
42256>>>>>>>>>>>>>>>>>>>>>                    End
42256>>>>>>>>>>>>>>>>>>>>>>
42256>>>>>>>>>>>>>>>>>>>>>                    procedure_return new_item
42257>>>>>>>>>>>>>>>>>>>>>                End_Procedure // Current_Item
42258>>>>>>>>>>>>>>>>>>>>>
42258>>>>>>>>>>>>>>>>>>>>>
42258>>>>>>>>>>>>>>>>>>>>>
42258>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42258>>>>>>>>>>>>>>>>>>>>>
42258>>>>>>>>>>>>>>>>>>>>>            End_Object    // Grid2
42259>>>>>>>>>>>>>>>>>>>>>
42259>>>>>>>>>>>>>>>>>>>>>            Object Textbox2 is a Textbox
42261>>>>>>>>>>>>>>>>>>>>>                Set Label to "Mo"
42262>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42263>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42264>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42265>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42266>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 4
42267>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 15
42268>>>>>>>>>>>>>>>>>>>>>
42268>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42268>>>>>>>>>>>>>>>>>>>>>
42268>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
42269>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42269>>>>>>>>>>>>>>>>>>>>>
42269>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox2
42270>>>>>>>>>>>>>>>>>>>>>
42270>>>>>>>>>>>>>>>>>>>>>            Object Textbox3 is a Textbox
42272>>>>>>>>>>>>>>>>>>>>>                Set Label to "Tu"
42273>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42274>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42275>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42276>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42277>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 22
42278>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 12
42279>>>>>>>>>>>>>>>>>>>>>
42279>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42279>>>>>>>>>>>>>>>>>>>>>
42279>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
42280>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42280>>>>>>>>>>>>>>>>>>>>>
42280>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox3
42281>>>>>>>>>>>>>>>>>>>>>
42281>>>>>>>>>>>>>>>>>>>>>            Object Textbox4 is a Textbox
42283>>>>>>>>>>>>>>>>>>>>>                Set Label to "We"
42284>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42285>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42286>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42287>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42288>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 39
42289>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 15
42290>>>>>>>>>>>>>>>>>>>>>
42290>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42290>>>>>>>>>>>>>>>>>>>>>
42290>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
42291>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42291>>>>>>>>>>>>>>>>>>>>>
42291>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox4
42292>>>>>>>>>>>>>>>>>>>>>
42292>>>>>>>>>>>>>>>>>>>>>            Object Textbox5 is a Textbox
42294>>>>>>>>>>>>>>>>>>>>>                Set Label to "Th"
42295>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42296>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42297>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42298>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42299>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 57
42300>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 17
42301>>>>>>>>>>>>>>>>>>>>>
42301>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42301>>>>>>>>>>>>>>>>>>>>>
42301>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
42302>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42302>>>>>>>>>>>>>>>>>>>>>
42302>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox5
42303>>>>>>>>>>>>>>>>>>>>>
42303>>>>>>>>>>>>>>>>>>>>>            Object Textbox6 is a Textbox
42305>>>>>>>>>>>>>>>>>>>>>                Set Label to "Fr"
42306>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42307>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42308>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42309>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42310>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 76
42311>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 17
42312>>>>>>>>>>>>>>>>>>>>>
42312>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42312>>>>>>>>>>>>>>>>>>>>>
42312>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
42313>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42313>>>>>>>>>>>>>>>>>>>>>
42313>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox6
42314>>>>>>>>>>>>>>>>>>>>>
42314>>>>>>>>>>>>>>>>>>>>>            Object Textbox7 is a Textbox
42316>>>>>>>>>>>>>>>>>>>>>                Set Label to "Sa"
42317>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42318>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42319>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42320>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42321>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 91
42322>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 18
42323>>>>>>>>>>>>>>>>>>>>>
42323>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42323>>>>>>>>>>>>>>>>>>>>>
42323>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
42324>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42324>>>>>>>>>>>>>>>>>>>>>
42324>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox7
42325>>>>>>>>>>>>>>>>>>>>>
42325>>>>>>>>>>>>>>>>>>>>>            Object Textbox8 is a Textbox
42327>>>>>>>>>>>>>>>>>>>>>                Set Label to "Su"
42328>>>>>>>>>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
42329>>>>>>>>>>>>>>>>>>>>>                Set Transparent_State to TRUE
42330>>>>>>>>>>>>>>>>>>>>>                Set Color to clWhite
42331>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42332>>>>>>>>>>>>>>>>>>>>>                Set Location to 19 109
42333>>>>>>>>>>>>>>>>>>>>>                Set Size to 10 17
42334>>>>>>>>>>>>>>>>>>>>>
42334>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42334>>>>>>>>>>>>>>>>>>>>>
42334>>>>>>>>>>>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
42335>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42335>>>>>>>>>>>>>>>>>>>>>
42335>>>>>>>>>>>>>>>>>>>>>            End_Object    // Textbox8
42336>>>>>>>>>>>>>>>>>>>>>
42336>>>>>>>>>>>>>>>>>>>>>            Object LineControl1 is a LineControl
42338>>>>>>>>>>>>>>>>>>>>>                Set Line_Style to lnSINGLE
42339>>>>>>>>>>>>>>>>>>>>>                Set Size to 1 116
42340>>>>>>>>>>>>>>>>>>>>>                Set Location to 28 4
42341>>>>>>>>>>>>>>>>>>>>>
42341>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42341>>>>>>>>>>>>>>>>>>>>>
42341>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42341>>>>>>>>>>>>>>>>>>>>>
42341>>>>>>>>>>>>>>>>>>>>>            End_Object    // LineControl1
42342>>>>>>>>>>>>>>>>>>>>>
42342>>>>>>>>>>>>>>>>>>>>>            Object Container3d2 is a Container3d
42344>>>>>>>>>>>>>>>>>>>>>                Set Size to 18 131
42345>>>>>>>>>>>>>>>>>>>>>                Set Location to 1 1
42346>>>>>>>>>>>>>>>>>>>>>                Set Color to clNavy
42347>>>>>>>>>>>>>>>>>>>>>                Set Border_Style to Border_None
42348>>>>>>>>>>>>>>>>>>>>>                Object oRght is a BitmapContainer
42350>>>>>>>>>>>>>>>>>>>>>                    Set Size to 10 14
42351>>>>>>>>>>>>>>>>>>>>>                    Set Location to 4 105
42352>>>>>>>>>>>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
42353>>>>>>>>>>>>>>>>>>>>>                    Set Border_Style to Border_None
42354>>>>>>>>>>>>>>>>>>>>>
42354>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42354>>>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42356>>>>>>>>>>>>>>>>>>>>>                        Send Next_Month to Grid2
42357>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42358>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42358>>>>>>>>>>>>>>>>>>>>>
42358>>>>>>>>>>>>>>>>>>>>>                End_Object    // oRght
42359>>>>>>>>>>>>>>>>>>>>>
42359>>>>>>>>>>>>>>>>>>>>>                Object oLeft is a BitmapContainer
42361>>>>>>>>>>>>>>>>>>>>>                    Set Size to 10 14
42362>>>>>>>>>>>>>>>>>>>>>                    Set Location to 4 3
42363>>>>>>>>>>>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
42364>>>>>>>>>>>>>>>>>>>>>                    Set Border_Style to Border_None
42365>>>>>>>>>>>>>>>>>>>>>
42365>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42365>>>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42367>>>>>>>>>>>>>>>>>>>>>                        Send Prev_Month to Grid2
42368>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42369>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42369>>>>>>>>>>>>>>>>>>>>>
42369>>>>>>>>>>>>>>>>>>>>>                End_Object    // oLeft
42370>>>>>>>>>>>>>>>>>>>>>
42370>>>>>>>>>>>>>>>>>>>>>                Object oMonth is a Textbox
42372>>>>>>>>>>>>>>>>>>>>>
42372>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopStart
42372>>>>>>>>>>>>>>>>>>>>>                    Property integer piSelected_Month public 0
42374>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopEnd
42374>>>>>>>>>>>>>>>>>>>>>
42374>>>>>>>>>>>>>>>>>>>>>                    Set Label to "January"
42375>>>>>>>>>>>>>>>>>>>>>                    Set Auto_Size_State to FALSE
42376>>>>>>>>>>>>>>>>>>>>>                    Set Transparent_State to TRUE
42377>>>>>>>>>>>>>>>>>>>>>                    Set Color to clWhite
42378>>>>>>>>>>>>>>>>>>>>>                    Set TextColor to clWhite
42379>>>>>>>>>>>>>>>>>>>>>                    Set Location to 4 19
42380>>>>>>>>>>>>>>>>>>>>>                    Set Size to 10 46
42381>>>>>>>>>>>>>>>>>>>>>                    Set FontWeight to 800
42382>>>>>>>>>>>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
42383>>>>>>>>>>>>>>>>>>>>>
42383>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42383>>>>>>>>>>>>>>>>>>>>>
42383>>>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42385>>>>>>>>>>>>>>>>>>>>>                        Integer iState
42386>>>>>>>>>>>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
42387>>>>>>>>>>>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
42390>>>>>>>>>>>>>>>>>>>>>                        Send Popup to oSelectMonth
42391>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42392>>>>>>>>>>>>>>>>>>>>>
42392>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectJan
42394>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.january
42395>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 1
42396>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42397>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42398>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectFeb
42400>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.february
42401>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 2
42402>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42403>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42404>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectMar
42406>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.march
42407>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 3
42408>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42409>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42410>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectApr
42412>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.april
42413>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 4
42414>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42415>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42416>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectMay
42418>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.may
42419>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 5
42420>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42421>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42422>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectJun
42424>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.june
42425>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 6
42426>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42427>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42428>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectJul
42430>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.july
42431>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 7
42432>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42433>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42434>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectAug
42436>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.august
42437>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 8
42438>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42439>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42440>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectSep
42442>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.september
42443>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 9
42444>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42445>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42446>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectOct
42448>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.october
42449>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 10
42450>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42451>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42452>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectNov
42454>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.november
42455>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 11
42456>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42457>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42458>>>>>>>>>>>>>>>>>>>>>                    Procedure pSelectDec
42460>>>>>>>>>>>>>>>>>>>>>                        Set Label to t.calendar.december
42461>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to 12
42462>>>>>>>>>>>>>>>>>>>>>                        Send Adjust_Calendar
42463>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42464>>>>>>>>>>>>>>>>>>>>>
42464>>>>>>>>>>>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
42466>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
42467>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
42468>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
42469>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
42470>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
42471>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
42472>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
42473>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
42474>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
42475>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
42476>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
42477>>>>>>>>>>>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
42478>>>>>>>>>>>>>>>>>>>>>                    End_Object
42479>>>>>>>>>>>>>>>>>>>>>
42479>>>>>>>>>>>>>>>>>>>>>                    Procedure Adjust_Calendar
42481>>>>>>>>>>>>>>>>>>>>>                        Date date#
42482>>>>>>>>>>>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
42482>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42483>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to true
42484>>>>>>>>>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
42485>>>>>>>>>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
42486>>>>>>>>>>>>>>>>>>>>>                        Get piSelected_Month to iMonth
42487>>>>>>>>>>>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
42488>>>>>>>>>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
42489>>>>>>>>>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
42490>>>>>>>>>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
42491>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42492>>>>>>>>>>>>>>>>>>>>>
42492>>>>>>>>>>>>>>>>>>>>>                    Procedure Activating
42494>>>>>>>>>>>>>>>>>>>>>                        Forward Send Activating
42496>>>>>>>>>>>>>>>>>>>>>                        Send Date_Changing
42497>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42498>>>>>>>>>>>>>>>>>>>>>
42498>>>>>>>>>>>>>>>>>>>>>                    Procedure Date_Changing
42500>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42501>>>>>>>>>>>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
42502>>>>>>>>>>>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
42503>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to true
42504>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42505>>>>>>>>>>>>>>>>>>>>>
42505>>>>>>>>>>>>>>>>>>>>>
42505>>>>>>>>>>>>>>>>>>>>>
42505>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42505>>>>>>>>>>>>>>>>>>>>>
42505>>>>>>>>>>>>>>>>>>>>>                End_Object    // oMonth
42506>>>>>>>>>>>>>>>>>>>>>
42506>>>>>>>>>>>>>>>>>>>>>                Object oCalendarYear is a Textbox
42508>>>>>>>>>>>>>>>>>>>>>                    Set Label to "2001"
42509>>>>>>>>>>>>>>>>>>>>>                    Set Transparent_State to TRUE
42510>>>>>>>>>>>>>>>>>>>>>                    Set Color to clWhite
42511>>>>>>>>>>>>>>>>>>>>>                    Set TextColor to clWhite
42512>>>>>>>>>>>>>>>>>>>>>                    Set Location to 4 77
42513>>>>>>>>>>>>>>>>>>>>>                    Set Size to 10 18
42514>>>>>>>>>>>>>>>>>>>>>                    Set FontWeight to 800
42515>>>>>>>>>>>>>>>>>>>>>
42515>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42515>>>>>>>>>>>>>>>>>>>>>
42515>>>>>>>>>>>>>>>>>>>>>                    Procedure Mouse_Down
42517>>>>>>>>>>>>>>>>>>>>>                        String sVal
42518>>>>>>>>>>>>>>>>>>>>>                        Get Label to sVal
42519>>>>>>>>>>>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
42520>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
42521>>>>>>>>>>>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
42522>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42523>>>>>>>>>>>>>>>>>>>>>
42523>>>>>>>>>>>>>>>>>>>>>                    Procedure Activating
42525>>>>>>>>>>>>>>>>>>>>>                        Forward Send Activating
42527>>>>>>>>>>>>>>>>>>>>>                        Send Date_Changing
42528>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42529>>>>>>>>>>>>>>>>>>>>>
42529>>>>>>>>>>>>>>>>>>>>>                    Procedure Date_Changing
42531>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42532>>>>>>>>>>>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
42533>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to true
42534>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42535>>>>>>>>>>>>>>>>>>>>>
42535>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42535>>>>>>>>>>>>>>>>>>>>>
42535>>>>>>>>>>>>>>>>>>>>>                End_Object    // oCalendarYear
42536>>>>>>>>>>>>>>>>>>>>>
42536>>>>>>>>>>>>>>>>>>>>>                Object oSelectCalendarYear is a Form
42538>>>>>>>>>>>>>>>>>>>>>
42538>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopStart
42538>>>>>>>>>>>>>>>>>>>>>                    Set Visible_State To False
42539>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreTopEnd
42539>>>>>>>>>>>>>>>>>>>>>
42539>>>>>>>>>>>>>>>>>>>>>                    Set Size to 10 24
42540>>>>>>>>>>>>>>>>>>>>>                    Set Location to 4 75
42541>>>>>>>>>>>>>>>>>>>>>                    Set Color to clWhite
42542>>>>>>>>>>>>>>>>>>>>>                    Set TextColor to clNavy
42543>>>>>>>>>>>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
42544>>>>>>>>>>>>>>>>>>>>>
42544>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreStart
42544>>>>>>>>>>>>>>>>>>>>>
42544>>>>>>>>>>>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
42545>>>>>>>>>>>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
42546>>>>>>>>>>>>>>>>>>>>>
42546>>>>>>>>>>>>>>>>>>>>>                    Procedure SetFontWeight
42548>>>>>>>>>>>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
42549>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42550>>>>>>>>>>>>>>>>>>>>>
42550>>>>>>>>>>>>>>>>>>>>>                    Procedure OnKillFocus
42552>>>>>>>>>>>>>>>>>>>>>                        String sVal
42553>>>>>>>>>>>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
42553>>>>>>>>>>>>>>>>>>>>>                        Date date#
42553>>>>>>>>>>>>>>>>>>>>>                        Get Value item 0 to sVal
42554>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
42555>>>>>>>>>>>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
42556>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
42557>>>>>>>>>>>>>>>>>>>>>                        Set Visible_State to false
42558>>>>>>>>>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
42559>>>>>>>>>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
42560>>>>>>>>>>>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
42561>>>>>>>>>>>>>>>>>>>>>                        Get Value item 0 to iYear
42562>>>>>>>>>>>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
42565>>>>>>>>>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
42566>>>>>>>>>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
42567>>>>>>>>>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
42568>>>>>>>>>>>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
42569>>>>>>>>>>>>>>>>>>>>>                    End_Procedure
42570>>>>>>>>>>>>>>>>>>>>>
42570>>>>>>>>>>>>>>>>>>>>>                    Send SetFontWeight
42571>>>>>>>>>>>>>>>>>>>>>
42571>>>>>>>>>>>>>>>>>>>>>
42571>>>>>>>>>>>>>>>>>>>>>
42571>>>>>>>>>>>>>>>>>>>>>                    //AB-StoreEnd
42571>>>>>>>>>>>>>>>>>>>>>
42571>>>>>>>>>>>>>>>>>>>>>                End_Object    // oSelectCalendarYear
42572>>>>>>>>>>>>>>>>>>>>>
42572>>>>>>>>>>>>>>>>>>>>>
42572>>>>>>>>>>>>>>>>>>>>>                //AB-StoreStart
42572>>>>>>>>>>>>>>>>>>>>>
42572>>>>>>>>>>>>>>>>>>>>>                Procedure Mouse_Down
42574>>>>>>>>>>>>>>>>>>>>>                    Integer iState
42575>>>>>>>>>>>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
42576>>>>>>>>>>>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
42579>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42580>>>>>>>>>>>>>>>>>>>>>
42580>>>>>>>>>>>>>>>>>>>>>
42580>>>>>>>>>>>>>>>>>>>>>                //AB-StoreEnd
42580>>>>>>>>>>>>>>>>>>>>>
42580>>>>>>>>>>>>>>>>>>>>>            End_Object    // Container3d2
42581>>>>>>>>>>>>>>>>>>>>>
42581>>>>>>>>>>>>>>>>>>>>>
42581>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42581>>>>>>>>>>>>>>>>>>>>>
42581>>>>>>>>>>>>>>>>>>>>>
42581>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42581>>>>>>>>>>>>>>>>>>>>>
42581>>>>>>>>>>>>>>>>>>>>>        End_Object    // Container3d1
42582>>>>>>>>>>>>>>>>>>>>>
42582>>>>>>>>>>>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
42584>>>>>>>>>>>>>>>>>>>>>            Set Size to 9 19
42585>>>>>>>>>>>>>>>>>>>>>            Set Location to 88 3
42586>>>>>>>>>>>>>>>>>>>>>            Set Color to clWhite
42587>>>>>>>>>>>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
42588>>>>>>>>>>>>>>>>>>>>>            Set Border_Style to Border_None
42589>>>>>>>>>>>>>>>>>>>>>
42589>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42589>>>>>>>>>>>>>>>>>>>>>            Procedure Mouse_Down
42591>>>>>>>>>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
42592>>>>>>>>>>>>>>>>>>>>>                Send Adjust_Label to oToday
42593>>>>>>>>>>>>>>>>>>>>>            End_Procedure
42594>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42594>>>>>>>>>>>>>>>>>>>>>
42594>>>>>>>>>>>>>>>>>>>>>        End_Object    // BitmapContainer3
42595>>>>>>>>>>>>>>>>>>>>>
42595>>>>>>>>>>>>>>>>>>>>>        Object oToday is a Textbox
42597>>>>>>>>>>>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
42598>>>>>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
42599>>>>>>>>>>>>>>>>>>>>>            Set Color to clWhite
42600>>>>>>>>>>>>>>>>>>>>>            Set Location to 88 22
42601>>>>>>>>>>>>>>>>>>>>>            Set Size to 8 70
42602>>>>>>>>>>>>>>>>>>>>>            Set FontWeight to 800
42603>>>>>>>>>>>>>>>>>>>>>
42603>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42603>>>>>>>>>>>>>>>>>>>>>            Procedure Mouse_Down
42605>>>>>>>>>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
42606>>>>>>>>>>>>>>>>>>>>>                Send Adjust_Label
42607>>>>>>>>>>>>>>>>>>>>>            End_Procedure
42608>>>>>>>>>>>>>>>>>>>>>
42608>>>>>>>>>>>>>>>>>>>>>            Procedure Adjust_Label
42610>>>>>>>>>>>>>>>>>>>>>                date date#
42611>>>>>>>>>>>>>>>>>>>>>                SysDate4 date#
42612>>>>>>>>>>>>>>>>>>>>>                Set Visible_State To false
42613>>>>>>>>>>>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
42614>>>>>>>>>>>>>>>>>>>>>                Set Visible_State To true
42615>>>>>>>>>>>>>>>>>>>>>            End_Procedure
42616>>>>>>>>>>>>>>>>>>>>>
42616>>>>>>>>>>>>>>>>>>>>>            Procedure Activating
42618>>>>>>>>>>>>>>>>>>>>>                Forward Send Activating
42620>>>>>>>>>>>>>>>>>>>>>                Send Adjust_Label
42621>>>>>>>>>>>>>>>>>>>>>            End_Procedure
42622>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42622>>>>>>>>>>>>>>>>>>>>>
42622>>>>>>>>>>>>>>>>>>>>>        End_Object    // oToday
42623>>>>>>>>>>>>>>>>>>>>>
42623>>>>>>>>>>>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
42625>>>>>>>>>>>>>>>>>>>>>            Set Size to 9 10
42626>>>>>>>>>>>>>>>>>>>>>            Set Location to 88 112
42627>>>>>>>>>>>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
42628>>>>>>>>>>>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
42629>>>>>>>>>>>>>>>>>>>>>
42629>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
42629>>>>>>>>>>>>>>>>>>>>>
42629>>>>>>>>>>>>>>>>>>>>>            Procedure Mouse_Up
42631>>>>>>>>>>>>>>>>>>>>>                Send Close_Calendar
42632>>>>>>>>>>>>>>>>>>>>>            End_Procedure // Mouse_Up
42633>>>>>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
42633>>>>>>>>>>>>>>>>>>>>>
42633>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
42634>>>>>>>>>>>>>>>>>>>>>
42634>>>>>>>>>>>>>>>>>>>>>
42634>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
42634>>>>>>>>>>>>>>>>>>>>>
42634>>>>>>>>>>>>>>>>>>>>>        Set Block_Mouse_State to True
42635>>>>>>>>>>>>>>>>>>>>>        Set Popup_State to True
42636>>>>>>>>>>>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
42637>>>>>>>>>>>>>>>>>>>>>
42637>>>>>>>>>>>>>>>>>>>>>        procedure popup
42639>>>>>>>>>>>>>>>>>>>>>            local integer focus# icItm iYear iMonth
42640>>>>>>>>>>>>>>>>>>>>>            local date date#
42640>>>>>>>>>>>>>>>>>>>>>            move (focus(desktop)) to focus#
42641>>>>>>>>>>>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
42642>>>>>>>>>>>>>>>>>>>>>            get value of focus# item current to date#
42643>>>>>>>>>>>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
42646>>>>>>>>>>>>>>>>>>>>>            move (Date2to4(date#)) to date#
42647>>>>>>>>>>>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
42648>>>>>>>>>>>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
42649>>>>>>>>>>>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
42650>>>>>>>>>>>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
42651>>>>>>>>>>>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
42652>>>>>>>>>>>>>>>>>>>>>            forward send popup
42654>>>>>>>>>>>>>>>>>>>>>        end_procedure
42655>>>>>>>>>>>>>>>>>>>>>
42655>>>>>>>>>>>>>>>>>>>>>        Procedure Close_Calendar
42657>>>>>>>>>>>>>>>>>>>>>            Send Close_Panel
42658>>>>>>>>>>>>>>>>>>>>>        End_Procedure // Close_Calendar
42659>>>>>>>>>>>>>>>>>>>>>
42659>>>>>>>>>>>>>>>>>>>>>        Object Help_Container is a Container3d
42661>>>>>>>>>>>>>>>>>>>>>            Set Location to 0 0
42662>>>>>>>>>>>>>>>>>>>>>            Set Size     to 98 122
42663>>>>>>>>>>>>>>>>>>>>>            Set Visible_State to False
42664>>>>>>>>>>>>>>>>>>>>>            Set Enabled_State to False
42665>>>>>>>>>>>>>>>>>>>>>            Set Border_Style to Border_None
42666>>>>>>>>>>>>>>>>>>>>>            Set TextColor to clNavy
42667>>>>>>>>>>>>>>>>>>>>>
42667>>>>>>>>>>>>>>>>>>>>>            Object Help_Info is an Edit
42669>>>>>>>>>>>>>>>>>>>>>                Set Location to 0 0
42670>>>>>>>>>>>>>>>>>>>>>                Set Size     to 98 122
42671>>>>>>>>>>>>>>>>>>>>>                Set read_only_state to true
42672>>>>>>>>>>>>>>>>>>>>>                Set Border_Style to Border_None
42673>>>>>>>>>>>>>>>>>>>>>                Set scroll_bar_visible_state to False
42674>>>>>>>>>>>>>>>>>>>>>                Set FontWeight to 800
42675>>>>>>>>>>>>>>>>>>>>>
42675>>>>>>>>>>>>>>>>>>>>>                Procedure ReadHelpComments
42677>>>>>>>>>>>>>>>>>>>>>                    String lsFile
42678>>>>>>>>>>>>>>>>>>>>>
42678>>>>>>>>>>>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
42679>>>>>>>>>>>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
42682>>>>>>>>>>>>>>>>>>>>>                End_Procedure // ReadHelpComments
42683>>>>>>>>>>>>>>>>>>>>>
42683>>>>>>>>>>>>>>>>>>>>>                Procedure SetComments
42685>>>>>>>>>>>>>>>>>>>>>                    Send append_text "Help on Calendar"
42686>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42687>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42688>>>>>>>>>>>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
42689>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42690>>>>>>>>>>>>>>>>>>>>>                    Send append_text "  - select date."
42691>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42692>>>>>>>>>>>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
42693>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42694>>>>>>>>>>>>>>>>>>>>>                    Send append_text "  - select month."
42695>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42696>>>>>>>>>>>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
42697>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42698>>>>>>>>>>>>>>>>>>>>>                    Send append_text "  - set current date."
42699>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42700>>>>>>>>>>>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
42701>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42702>>>>>>>>>>>>>>>>>>>>>                    Send append_text "  - Change year."
42703>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42704>>>>>>>>>>>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
42705>>>>>>>>>>>>>>>>>>>>>                    Send Insert ""
42706>>>>>>>>>>>>>>>>>>>>>                    Send append_text "  - Select year."
42707>>>>>>>>>>>>>>>>>>>>>                End_procedure // SetComments
42708>>>>>>>>>>>>>>>>>>>>>
42708>>>>>>>>>>>>>>>>>>>>>                //Send SetComments
42708>>>>>>>>>>>>>>>>>>>>>                Set Color     to clWhite
42709>>>>>>>>>>>>>>>>>>>>>                Set TextColor to clNavy
42710>>>>>>>>>>>>>>>>>>>>>
42710>>>>>>>>>>>>>>>>>>>>>                Procedure OnSetFocus
42712>>>>>>>>>>>>>>>>>>>>>                    Send ReadHelpComments
42713>>>>>>>>>>>>>>>>>>>>>                End_Procedure
42714>>>>>>>>>>>>>>>>>>>>>
42714>>>>>>>>>>>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
42716>>>>>>>>>>>>>>>>>>>>>
42716>>>>>>>>>>>>>>>>>>>>>                    Procedure Close_Help
42718>>>>>>>>>>>>>>>>>>>>>                        Send Close_Help to Help_Container
42719>>>>>>>>>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
42720>>>>>>>>>>>>>>>>>>>>>
42720>>>>>>>>>>>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
42721>>>>>>>>>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
42722>>>>>>>>>>>>>>>>>>>>>
42722>>>>>>>>>>>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
42724>>>>>>>>>>>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
42725>>>>>>>>>>>>>>>>>>>>>                End_Procedure // Mouse_Up2
42726>>>>>>>>>>>>>>>>>>>>>
42726>>>>>>>>>>>>>>>>>>>>>            End_Object
42727>>>>>>>>>>>>>>>>>>>>>
42727>>>>>>>>>>>>>>>>>>>>>            Procedure Close_Help
42729>>>>>>>>>>>>>>>>>>>>>                Send Delete_Data to Help_Info
42730>>>>>>>>>>>>>>>>>>>>>                Set Visible_State to False
42731>>>>>>>>>>>>>>>>>>>>>                Set Enabled_State to False
42732>>>>>>>>>>>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
42733>>>>>>>>>>>>>>>>>>>>>            End_Procedure // Close_Help
42734>>>>>>>>>>>>>>>>>>>>>
42734>>>>>>>>>>>>>>>>>>>>>            On_Key kCancel Send Close_Help
42735>>>>>>>>>>>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
42736>>>>>>>>>>>>>>>>>>>>>            On_Key kEnter  Send Close_Help
42737>>>>>>>>>>>>>>>>>>>>>        End_Object // Help_Info
42738>>>>>>>>>>>>>>>>>>>>>
42738>>>>>>>>>>>>>>>>>>>>>        on_key kcancel           send Close_Calendar
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
42739>>>>>>>>>>>>>>>>>>>>>
42739>>>>>>>>>>>>>>>>>>>>>    End_Object    // oCalendar
42740>>>>>>>>>>>>>>>>>>>>>
42740>>>>>>>>>>>>>>>>>>>>>
42740>>>>>>>>>>>>>>>>>>>>>    //AB-StoreStart
42740>>>>>>>>>>>>>>>>>>>>>
42740>>>>>>>>>>>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
42741>>>>>>>>>>>>>>>>>>>>>        Integer focus# type# dm#
42742>>>>>>>>>>>>>>>>>>>>>
42742>>>>>>>>>>>>>>>>>>>>>        move (focus(desktop)) to focus#
42743>>>>>>>>>>>>>>>>>>>>>        if focus# gt desktop begin
42745>>>>>>>>>>>>>>>>>>>>>          get delegation_mode of focus# to dm#
42746>>>>>>>>>>>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
42747>>>>>>>>>>>>>>>>>>>>>          get form_datatype of focus# item current to type#
42748>>>>>>>>>>>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
42751>>>>>>>>>>>>>>>>>>>>>          set delegation_mode of focus# to dm#
42752>>>>>>>>>>>>>>>>>>>>>        end
42752>>>>>>>>>>>>>>>>>>>>>>
42752>>>>>>>>>>>>>>>>>>>>>    End_Procedure
42753>>>>>>>>>>>>>>>>>>>>>
42753>>>>>>>>>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
42754>>>>>>>>>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
42755>>>>>>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>>>>>>>    //AB-StoreEnd
42755>>>>>>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
42755>>>>>>>>>>>>>>>>>>>Use Dates.Utl
42755>>>>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
42755>>>>>>>>>>>>>>>>>>>   Define cDateToday        for "T"
42755>>>>>>>>>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
42755>>>>>>>>>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
42755>>>>>>>>>>>>>>>>>>>
42755>>>>>>>>>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
42756>>>>>>>>>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
42757>>>>>>>>>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
42758>>>>>>>>>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
42759>>>>>>>>>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
42760>>>>>>>>>>>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
42761>>>>>>>>>>>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
42762>>>>>>>>>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
42763>>>>>>>>>>>>>>>>>>>
42763>>>>>>>>>>>>>>>>>>>   Procedure DoAddOneDay
42764>>>>>>>>>>>>>>>>>>>        Integer rVal
42765>>>>>>>>>>>>>>>>>>>        Date dHmnia
42765>>>>>>>>>>>>>>>>>>>
42765>>>>>>>>>>>>>>>>>>>        Get Value Item 0 to dHmnia
42766>>>>>>>>>>>>>>>>>>>        Add 1 to dHmnia
42767>>>>>>>>>>>>>>>>>>>        Set Value Item 0 to dHmnia
42768>>>>>>>>>>>>>>>>>>>    End_Procedure // Add_One_Day
42769>>>>>>>>>>>>>>>>>>>
42769>>>>>>>>>>>>>>>>>>>    Procedure DoSubOneDay
42770>>>>>>>>>>>>>>>>>>>        Integer rVal
42771>>>>>>>>>>>>>>>>>>>        Date dHmnia
42771>>>>>>>>>>>>>>>>>>>
42771>>>>>>>>>>>>>>>>>>>        Get Value Item 0 to dHmnia
42772>>>>>>>>>>>>>>>>>>>        Sub 1 to dHmnia
42773>>>>>>>>>>>>>>>>>>>        Set Value Item 0 to dHmnia
42774>>>>>>>>>>>>>>>>>>>    End_Procedure // Add_One_Day
42775>>>>>>>>>>>>>>>>>>>
42775>>>>>>>>>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
42775>>>>>>>>>>>>>>>>>>>   Procedure Entering returns Integer
42776>>>>>>>>>>>>>>>>>>>      Integer iRetVal
42777>>>>>>>>>>>>>>>>>>>      Date    dOriginal
42777>>>>>>>>>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
42779>>>>>>>>>>>>>>>>>>>      If (iRetVal = 0) Begin
42781>>>>>>>>>>>>>>>>>>>         Send DoStoreOriginalDate
42782>>>>>>>>>>>>>>>>>>>      End
42782>>>>>>>>>>>>>>>>>>>>
42782>>>>>>>>>>>>>>>>>>>      Procedure_Return iRetVal
42783>>>>>>>>>>>>>>>>>>>   End_Procedure // Entering
42784>>>>>>>>>>>>>>>>>>>
42784>>>>>>>>>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
42784>>>>>>>>>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
42784>>>>>>>>>>>>>>>>>>>   Procedure Next
42785>>>>>>>>>>>>>>>>>>>      Send DoIntelliSenseDate
42786>>>>>>>>>>>>>>>>>>>      Forward Send Next
42788>>>>>>>>>>>>>>>>>>>   End_Procedure // Next
42789>>>>>>>>>>>>>>>>>>>
42789>>>>>>>>>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
42789>>>>>>>>>>>>>>>>>>>   Procedure DoStoreOriginalDate
42790>>>>>>>>>>>>>>>>>>>      Date    dOriginal
42791>>>>>>>>>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
42791>>>>>>>>>>>>>>>>>>>         Get Value Item 0 to dOriginal
42792>>>>>>>>>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
42793>>>>>>>>>>>>>>>>>>>      //End
42793>>>>>>>>>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
42794>>>>>>>>>>>>>>>>>>>
42794>>>>>>>>>>>>>>>>>>>   Procedure DoIntelliSenseDate
42795>>>>>>>>>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
42796>>>>>>>>>>>>>>>>>>>      Date    dCurrent dOriginal
42796>>>>>>>>>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
42796>>>>>>>>>>>>>>>>>>>
42796>>>>>>>>>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
42797>>>>>>>>>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
42798>>>>>>>>>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
42800>>>>>>>>>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
42803>>>>>>>>>>>>>>>>>>>
42803>>>>>>>>>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
42803>>>>>>>>>>>>>>>>>>>         // USA dates.
42803>>>>>>>>>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
42804>>>>>>>>>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
42805>>>>>>>>>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
42808>>>>>>>>>>>>>>>>>>>         Move (Character(iSep)) to sSep
42809>>>>>>>>>>>>>>>>>>>
42809>>>>>>>>>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
42809>>>>>>>>>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
42810>>>>>>>>>>>>>>>>>>>         Move (sSep+sSep) to sMask
42811>>>>>>>>>>>>>>>>>>>
42811>>>>>>>>>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
42811>>>>>>>>>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
42811>>>>>>>>>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
42811>>>>>>>>>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
42811>>>>>>>>>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
42813>>>>>>>>>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
42814>>>>>>>>>>>>>>>>>>>            Move sCurrent to iCurrent
42815>>>>>>>>>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
42817>>>>>>>>>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
42820>>>>>>>>>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
42822>>>>>>>>>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
42823>>>>>>>>>>>>>>>>>>>               End
42823>>>>>>>>>>>>>>>>>>>>
42823>>>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
42826>>>>>>>>>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
42827>>>>>>>>>>>>>>>>>>>               End
42827>>>>>>>>>>>>>>>>>>>>
42827>>>>>>>>>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
42830>>>>>>>>>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
42831>>>>>>>>>>>>>>>>>>>               End
42831>>>>>>>>>>>>>>>>>>>>
42831>>>>>>>>>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
42832>>>>>>>>>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
42832>>>>>>>>>>>>>>>>>>>>
42832>>>>>>>>>>>>>>>>>>>         End
42832>>>>>>>>>>>>>>>>>>>>
42832>>>>>>>>>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
42835>>>>>>>>>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
42838>>>>>>>>>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
42840>>>>>>>>>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
42841>>>>>>>>>>>>>>>>>>>            End
42841>>>>>>>>>>>>>>>>>>>>
42841>>>>>>>>>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
42844>>>>>>>>>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
42845>>>>>>>>>>>>>>>>>>>            End
42845>>>>>>>>>>>>>>>>>>>>
42845>>>>>>>>>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
42846>>>>>>>>>>>>>>>>>>>         End
42846>>>>>>>>>>>>>>>>>>>>
42846>>>>>>>>>>>>>>>>>>>      End
42846>>>>>>>>>>>>>>>>>>>>
42846>>>>>>>>>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
42847>>>>>>>>>>>>>>>>>>>
42847>>>>>>>>>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
42848>>>>>>>>>>>>>>>>>>>      Date dToday dTemp
42849>>>>>>>>>>>>>>>>>>>      Sysdate4 dToday
42850>>>>>>>>>>>>>>>>>>>
42850>>>>>>>>>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
42852>>>>>>>>>>>>>>>>>>>         Set Value to dToday
42853>>>>>>>>>>>>>>>>>>>      End
42853>>>>>>>>>>>>>>>>>>>>
42853>>>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
42856>>>>>>>>>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
42857>>>>>>>>>>>>>>>>>>>         Set Value to dTemp
42858>>>>>>>>>>>>>>>>>>>      End
42858>>>>>>>>>>>>>>>>>>>>
42858>>>>>>>>>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
42861>>>>>>>>>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
42862>>>>>>>>>>>>>>>>>>>         Set Value to dTemp
42863>>>>>>>>>>>>>>>>>>>      End
42863>>>>>>>>>>>>>>>>>>>>
42863>>>>>>>>>>>>>>>>>>>      Else Forward Send Key iKey
42866>>>>>>>>>>>>>>>>>>>   End_procedure
42867>>>>>>>>>>>>>>>>>>>
42867>>>>>>>>>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
42868>>>>>>>>>>>>>>>>>
42868>>>>>>>>>>>>>>>>>Class cSyDateForm Is A FormSub
42869>>>>>>>>>>>>>>>>>   Procedure Construct_Object
42870>>>>>>>>>>>>>>>>>      Forward Send Construct_Object
42872>>>>>>>>>>>>>>>>>
42872>>>>>>>>>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
42873>>>>>>>>>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
42874>>>>>>>>>>>>>>>>>
42874>>>>>>>>>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
42875>>>>>>>>>>>>>>>>>
42875>>>>>>>>>>>>>>>>>      On_Key kPrompt Send Prompt
42876>>>>>>>>>>>>>>>>>
42876>>>>>>>>>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
42877>>>>>>>>>>>>>>>>>      Set Status_Help   to cStatusHelp
42878>>>>>>>>>>>>>>>>>
42878>>>>>>>>>>>>>>>>>   End_Procedure // Construct_Object
42879>>>>>>>>>>>>>>>>>
42879>>>>>>>>>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
42880>>>>>>>>>>>>>>>>>
42880>>>>>>>>>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
42880>>>>>>>>>>>>>>>>>//      Integer iDatatype
42880>>>>>>>>>>>>>>>>>//
42880>>>>>>>>>>>>>>>>>//      If (iItem = Current) Begin
42880>>>>>>>>>>>>>>>>>//         Get Current_Item to iItem
42880>>>>>>>>>>>>>>>>>//      End
42880>>>>>>>>>>>>>>>>>//
42880>>>>>>>>>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
42880>>>>>>>>>>>>>>>>>//
42880>>>>>>>>>>>>>>>>>//      Function_Return iDatatype
42880>>>>>>>>>>>>>>>>>//   End_Function // Form_Datatype
42880>>>>>>>>>>>>>>>>>
42880>>>>>>>>>>>>>>>>>End_Class // cSyDateForm
42881>>>>>>>>>>>>>>>Use Form.Sub
42881>>>>>>>>>>>>>>>Use Txtbox.Sub
42881>>>>>>>>>>>>>>>Use Button.Sub
42881>>>>>>>>>>>>>>>
42881>>>>>>>>>>>>>>>
42881>>>>>>>>>>>>>>>Use CTYPKIN.DD
42881>>>>>>>>>>>>>>>Use WTYPKIN.DD
42881>>>>>>>>>>>>>>>Use PTYPPAR.DD
42881>>>>>>>>>>>>>>>Use CLIENTS.DD
42881>>>>>>>>>>>>>>>Use NOMISMA.DD
42881>>>>>>>>>>>>>>>Use PARTICLE.DD
42881>>>>>>>>>>>>>>>
42881>>>>>>>>>>>>>>>//AB-IgnoreEnd
42881>>>>>>>>>>>>>>>
42881>>>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
42883>>>>>>>>>>>>>>>
42883>>>>>>>>>>>>>>>    //AB-StoreTopStart
42883>>>>>>>>>>>>>>>                                
42883>>>>>>>>>>>>>>>    Property String psModule        Public ''
42885>>>>>>>>>>>>>>>    Property String psClient        Public ''
42887>>>>>>>>>>>>>>>    Property String psPtyppar       Public ''
42889>>>>>>>>>>>>>>>    Property String psCtypkin       Public ''
42891>>>>>>>>>>>>>>>    Property String psWtypkin       Public ''
42893>>>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
42895>>>>>>>>>>>>>>>    Property Integer Pino           Public 0
42897>>>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
42899>>>>>>>>>>>>>>>    
42899>>>>>>>>>>>>>>>    //AB-StoreTopEnd
42899>>>>>>>>>>>>>>>
42899>>>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
42900>>>>>>>>>>>>>>>    Set Size to 294 523
42901>>>>>>>>>>>>>>>    Set Location to 0 3
42902>>>>>>>>>>>>>>>    Set Color to 12363657
42903>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
42904>>>>>>>>>>>>>>>    Set Modal_State to FALSE
42905>>>>>>>>>>>>>>>
42905>>>>>>>>>>>>>>>    //AB-DDOStart
42905>>>>>>>>>>>>>>>
42905>>>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
42907>>>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
42908>>>>>>>>>>>>>>>
42908>>>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
42910>>>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
42911>>>>>>>>>>>>>>>
42911>>>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
42913>>>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
42914>>>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
42915>>>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
42916>>>>>>>>>>>>>>>
42916>>>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
42918>>>>>>>>>>>>>>>    End_Object    // Clients_DD
42919>>>>>>>>>>>>>>>
42919>>>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
42921>>>>>>>>>>>>>>>    End_Object    // Nomisma_DD
42922>>>>>>>>>>>>>>>
42922>>>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
42924>>>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
42925>>>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
42926>>>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
42927>>>>>>>>>>>>>>>
42927>>>>>>>>>>>>>>>        //AB-StoreStart
42927>>>>>>>>>>>>>>>                                                        
42927>>>>>>>>>>>>>>>        Procedure OnConstrain
42929>>>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
42930>>>>>>>>>>>>>>>            Date    dHmnia
42930>>>>>>>>>>>>>>>            Integer Ino
42930>>>>>>>>>>>>>>>            Get psClient        to sClientID
42931>>>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
42932>>>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
42933>>>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
42934>>>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
42935>>>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
42936>>>>>>>>>>>>>>>            get Pino            to Ino
42937>>>>>>>>>>>>>>>            If (sClientID<>'') Begin
42939>>>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
42941>>>>>>>>>>>>>>>                    Set Ordering to 1
42942>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42944>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42946>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42948>>>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
42950>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42952>>>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
42954>>>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
42956>>>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
42958>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42962>>>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42966>>>>>>>>>>>>>>>                End
42966>>>>>>>>>>>>>>>>
42966>>>>>>>>>>>>>>>                Else Begin
42967>>>>>>>>>>>>>>>                    Set Ordering to 13
42968>>>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42970>>>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42972>>>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42974>>>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
42976>>>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
42980>>>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
42984>>>>>>>>>>>>>>>                End
42984>>>>>>>>>>>>>>>>
42984>>>>>>>>>>>>>>>            End
42984>>>>>>>>>>>>>>>>
42984>>>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
42987>>>>>>>>>>>>>>>                Set Ordering to 12
42988>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
42990>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
42992>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
42994>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
42996>>>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
42998>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
43002>>>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
43006>>>>>>>>>>>>>>>            End
43006>>>>>>>>>>>>>>>>
43006>>>>>>>>>>>>>>>            Else  Begin
43007>>>>>>>>>>>>>>>                Set Ordering to 14
43008>>>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
43010>>>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
43012>>>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
43014>>>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
43016>>>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
43020>>>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
43024>>>>>>>>>>>>>>>            End
43024>>>>>>>>>>>>>>>>
43024>>>>>>>>>>>>>>>        
43024>>>>>>>>>>>>>>>        End_Procedure
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        
43025>>>>>>>>>>>>>>>        //AB-StoreEnd
43025>>>>>>>>>>>>>>>
43025>>>>>>>>>>>>>>>    End_Object    // Particle_DD
43026>>>>>>>>>>>>>>>
43026>>>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
43027>>>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
43028>>>>>>>>>>>>>>>
43028>>>>>>>>>>>>>>>    //AB-DDOEnd
43028>>>>>>>>>>>>>>>
43028>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43030>>>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
43031>>>>>>>>>>>>>>>        Set Size to 208 511
43032>>>>>>>>>>>>>>>        Set Location to 6 5
43033>>>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
43034>>>>>>>>>>>>>>>
43034>>>>>>>>>>>>>>>        Begin_Row
43037>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
43038>>>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
43039>>>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
43040>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
43041>>>>>>>>>>>>>>>            Entry_Item Clients.Client_id
43042>>>>>>>>>>>>>>>            Entry_Item Clients.Client_name
43043>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_payam
43044>>>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
43045>>>>>>>>>>>>>>>        End_Row
43050>>>>>>>>>>>>>>>
43050>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
43051>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
43052>>>>>>>>>>>>>>>        
43052>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
43053>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
43054>>>>>>>>>>>>>>>        
43054>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
43055>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
43056>>>>>>>>>>>>>>>        
43056>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 55
43057>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
43058>>>>>>>>>>>>>>>        
43058>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
43059>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
43060>>>>>>>>>>>>>>>        
43060>>>>>>>>>>>>>>>        Set Form_Width    item 5 to 140
43061>>>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
43062>>>>>>>>>>>>>>>        
43062>>>>>>>>>>>>>>>        Set Form_Width    item 6 to 48
43063>>>>>>>>>>>>>>>        Set Header_Label  item 6 to "€¥å˜"
43064>>>>>>>>>>>>>>>        
43064>>>>>>>>>>>>>>>        Set Form_Width    item 7 to 16
43065>>>>>>>>>>>>>>>        Set Header_Label  item 7 to "K"
43066>>>>>>>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
43067>>>>>>>>>>>>>>>        
43067>>>>>>>>>>>>>>>
43067>>>>>>>>>>>>>>>        //AB-StoreStart
43067>>>>>>>>>>>>>>>        Set Column_Option       Item  1 to NoEnter  True
43068>>>>>>>>>>>>>>>        Procedure End_Construct_Object
43070>>>>>>>>>>>>>>>            Integer iDecimals
43071>>>>>>>>>>>>>>>            Forward Send End_Construct_Object
43073>>>>>>>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
43074>>>>>>>>>>>>>>>            Set Points Item 6 to iDecimals
43075>>>>>>>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
43076>>>>>>>>>>>>>>>        End_Procedure
43077>>>>>>>>>>>>>>>        
43077>>>>>>>>>>>>>>>        
43077>>>>>>>>>>>>>>>        Procedure Activate
43079>>>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
43080>>>>>>>>>>>>>>>            Forward Send Activate
43082>>>>>>>>>>>>>>>        End_procedure
43083>>>>>>>>>>>>>>>        
43083>>>>>>>>>>>>>>>        Procedure Activating
43085>>>>>>>>>>>>>>>            Forward Send Activating
43087>>>>>>>>>>>>>>>            Set Auto_Index_State to True
43088>>>>>>>>>>>>>>>        End_Procedure
43089>>>>>>>>>>>>>>>        
43089>>>>>>>>>>>>>>>        
43089>>>>>>>>>>>>>>>        
43089>>>>>>>>>>>>>>>        
43089>>>>>>>>>>>>>>>        //AB-StoreEnd
43089>>>>>>>>>>>>>>>
43089>>>>>>>>>>>>>>>    End_Object    // oSelList
43090>>>>>>>>>>>>>>>
43090>>>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
43092>>>>>>>>>>>>>>>        Set Size to 13 85
43093>>>>>>>>>>>>>>>        Set Location to 222 54
43094>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43095>>>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
43096>>>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
43097>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43098>>>>>>>>>>>>>>>
43098>>>>>>>>>>>>>>>        //AB-StoreStart
43098>>>>>>>>>>>>>>>                                                                                                        
43098>>>>>>>>>>>>>>>        Procedure Key Integer iKey
43100>>>>>>>>>>>>>>>            Integer iRetVal
43101>>>>>>>>>>>>>>>            Forward Send Key iKey
43103>>>>>>>>>>>>>>>            If (iKey=277) Begin
43105>>>>>>>>>>>>>>>                Send Clear_Me
43106>>>>>>>>>>>>>>>            End
43106>>>>>>>>>>>>>>>>
43106>>>>>>>>>>>>>>>        End_Procedure
43107>>>>>>>>>>>>>>>        
43107>>>>>>>>>>>>>>>        Procedure Clear_Me
43109>>>>>>>>>>>>>>>            Set Value Item 0 to ''
43110>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
43111>>>>>>>>>>>>>>>        End_Procedure
43112>>>>>>>>>>>>>>>        
43112>>>>>>>>>>>>>>>        Procedure Exiting00000
43114>>>>>>>>>>>>>>>            Forward Send Exiting
43116>>>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
43117>>>>>>>>>>>>>>>        End_procedure
43118>>>>>>>>>>>>>>>        
43118>>>>>>>>>>>>>>>        
43118>>>>>>>>>>>>>>>        
43118>>>>>>>>>>>>>>>        //AB-StoreEnd
43118>>>>>>>>>>>>>>>
43118>>>>>>>>>>>>>>>    End_Object    // cSyDateForm1
43119>>>>>>>>>>>>>>>
43119>>>>>>>>>>>>>>>    Object FormSub1 is a FormSub
43121>>>>>>>>>>>>>>>        Set Size to 13 85
43122>>>>>>>>>>>>>>>        Set Location to 236 54
43123>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43124>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43125>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43126>>>>>>>>>>>>>>>
43126>>>>>>>>>>>>>>>        //AB-StoreStart
43126>>>>>>>>>>>>>>>                                                                                                
43126>>>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
43127>>>>>>>>>>>>>>>        
43127>>>>>>>>>>>>>>>        Procedure Prompt
43129>>>>>>>>>>>>>>>            String sModule
43130>>>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
43131>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
43132>>>>>>>>>>>>>>>            Forward Send Prompt
43134>>>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
43135>>>>>>>>>>>>>>>        End_Procedure
43136>>>>>>>>>>>>>>>        
43136>>>>>>>>>>>>>>>        Procedure OnChange
43138>>>>>>>>>>>>>>>            String s1
43139>>>>>>>>>>>>>>>            Get Value Item 0 to s1
43140>>>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
43141>>>>>>>>>>>>>>>            Clear Ptypparl
43142>>>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
43143>>>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
43144>>>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
43145>>>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
43146>>>>>>>>>>>>>>>>
43146>>>>>>>>>>>>>>>            Set psPtyppar       to s1
43147>>>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
43148>>>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
43149>>>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
43150>>>>>>>>>>>>>>>        End_Procedure
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        
43151>>>>>>>>>>>>>>>        //AB-StoreEnd
43151>>>>>>>>>>>>>>>
43151>>>>>>>>>>>>>>>    End_Object    // FormSub1
43152>>>>>>>>>>>>>>>
43152>>>>>>>>>>>>>>>    Object FormSub3 is a FormSub
43154>>>>>>>>>>>>>>>        Set Size to 13 195
43155>>>>>>>>>>>>>>>        Set Location to 236 145
43156>>>>>>>>>>>>>>>        Set Color to 12363657
43157>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43158>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
43159>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43160>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43161>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
43162>>>>>>>>>>>>>>>    End_Object    // FormSub3
43163>>>>>>>>>>>>>>>
43163>>>>>>>>>>>>>>>    Object FormSub2 is a FormSub
43165>>>>>>>>>>>>>>>        Set Size to 13 85
43166>>>>>>>>>>>>>>>        Set Location to 250 54
43167>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43168>>>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43169>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43170>>>>>>>>>>>>>>>
43170>>>>>>>>>>>>>>>        //AB-StoreStart
43170>>>>>>>>>>>>>>>                                                                                                
43170>>>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
43171>>>>>>>>>>>>>>>        
43171>>>>>>>>>>>>>>>        Procedure Prompt
43173>>>>>>>>>>>>>>>            String sModule
43174>>>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
43175>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
43176>>>>>>>>>>>>>>>            Forward Send Prompt
43178>>>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
43179>>>>>>>>>>>>>>>        End_Procedure
43180>>>>>>>>>>>>>>>        
43180>>>>>>>>>>>>>>>        Procedure OnChange
43182>>>>>>>>>>>>>>>            String s1
43183>>>>>>>>>>>>>>>            Get Value Item 0 to s1
43184>>>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
43185>>>>>>>>>>>>>>>            Set psClient to s1
43186>>>>>>>>>>>>>>>        End_Procedure
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        
43187>>>>>>>>>>>>>>>        //AB-StoreEnd
43187>>>>>>>>>>>>>>>
43187>>>>>>>>>>>>>>>    End_Object    // FormSub2
43188>>>>>>>>>>>>>>>
43188>>>>>>>>>>>>>>>    Object FormSub4 is a FormSub
43190>>>>>>>>>>>>>>>        Set Size to 13 195
43191>>>>>>>>>>>>>>>        Set Location to 250 145
43192>>>>>>>>>>>>>>>        Set Color to 12363657
43193>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43194>>>>>>>>>>>>>>>        Set Enabled_State to FALSE
43195>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43196>>>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43197>>>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
43198>>>>>>>>>>>>>>>    End_Object    // FormSub4
43199>>>>>>>>>>>>>>>
43199>>>>>>>>>>>>>>>    Object FormSub5 is a FormSub
43201>>>>>>>>>>>>>>>        Set Size to 13 85
43202>>>>>>>>>>>>>>>        Set Location to 263 54
43203>>>>>>>>>>>>>>>        Set Label_Col_Offset to 2
43204>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43205>>>>>>>>>>>>>>>
43205>>>>>>>>>>>>>>>        //AB-StoreStart
43205>>>>>>>>>>>>>>>        Procedure OnChange
43207>>>>>>>>>>>>>>>            integer ino
43208>>>>>>>>>>>>>>>            Get Value Item 0 to ino
43209>>>>>>>>>>>>>>>            Set pino to ino
43210>>>>>>>>>>>>>>>        End_Procedure
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        
43211>>>>>>>>>>>>>>>        //AB-StoreEnd
43211>>>>>>>>>>>>>>>
43211>>>>>>>>>>>>>>>    End_Object    // FormSub5
43212>>>>>>>>>>>>>>>
43212>>>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
43214>>>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
43215>>>>>>>>>>>>>>>        Set Color to 12363657
43216>>>>>>>>>>>>>>>        Set Location to 222 5
43217>>>>>>>>>>>>>>>        Set Size to 10 35
43218>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43219>>>>>>>>>>>>>>>    End_Object    // TextBoxSub1
43220>>>>>>>>>>>>>>>
43220>>>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
43222>>>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
43223>>>>>>>>>>>>>>>        Set Color to 12363657
43224>>>>>>>>>>>>>>>        Set Location to 237 4
43225>>>>>>>>>>>>>>>        Set Size to 10 41
43226>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43227>>>>>>>>>>>>>>>    End_Object    // TextBoxSub2
43228>>>>>>>>>>>>>>>
43228>>>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
43230>>>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
43231>>>>>>>>>>>>>>>        Set Color to 12363657
43232>>>>>>>>>>>>>>>        Set Location to 252 4
43233>>>>>>>>>>>>>>>        Set Size to 10 31
43234>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43235>>>>>>>>>>>>>>>    End_Object    // TextBoxSub3
43236>>>>>>>>>>>>>>>
43236>>>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
43238>>>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
43239>>>>>>>>>>>>>>>        Set Size to 13 50
43240>>>>>>>>>>>>>>>        Set Location to 252 355
43241>>>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
43242>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43243>>>>>>>>>>>>>>>
43243>>>>>>>>>>>>>>>        //AB-StoreStart
43243>>>>>>>>>>>>>>>                
43243>>>>>>>>>>>>>>>        Procedure OnClick
43245>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
43246>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
43247>>>>>>>>>>>>>>>        End_Procedure // OnClick
43248>>>>>>>>>>>>>>>        
43248>>>>>>>>>>>>>>>        
43248>>>>>>>>>>>>>>>        
43248>>>>>>>>>>>>>>>        
43248>>>>>>>>>>>>>>>        
43248>>>>>>>>>>>>>>>        //AB-StoreEnd
43248>>>>>>>>>>>>>>>
43248>>>>>>>>>>>>>>>    End_Object    // ButtonSub1
43249>>>>>>>>>>>>>>>
43249>>>>>>>>>>>>>>>    Object oOk_bn is a ButtonSub
43251>>>>>>>>>>>>>>>
43251>>>>>>>>>>>>>>>        //AB-StoreTopStart
43251>>>>>>>>>>>>>>>                
43251>>>>>>>>>>>>>>>        //AB-StoreTopEnd
43251>>>>>>>>>>>>>>>
43251>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43252>>>>>>>>>>>>>>>        Set Location to 252 412
43253>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43254>>>>>>>>>>>>>>>
43254>>>>>>>>>>>>>>>        //AB-StoreStart
43254>>>>>>>>>>>>>>>                
43254>>>>>>>>>>>>>>>        Procedure OnClick
43256>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43257>>>>>>>>>>>>>>>        End_Procedure
43258>>>>>>>>>>>>>>>        
43258>>>>>>>>>>>>>>>        //AB-StoreEnd
43258>>>>>>>>>>>>>>>
43258>>>>>>>>>>>>>>>    End_Object    // oOk_bn
43259>>>>>>>>>>>>>>>
43259>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43261>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43262>>>>>>>>>>>>>>>        Set Size to 13 50
43263>>>>>>>>>>>>>>>        Set Location to 252 466
43264>>>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43265>>>>>>>>>>>>>>>
43265>>>>>>>>>>>>>>>        //AB-StoreStart
43265>>>>>>>>>>>>>>>        Procedure OnClick
43267>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43268>>>>>>>>>>>>>>>        End_Procedure
43269>>>>>>>>>>>>>>>        //AB-StoreEnd
43269>>>>>>>>>>>>>>>
43269>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43270>>>>>>>>>>>>>>>
43270>>>>>>>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
43272>>>>>>>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
43273>>>>>>>>>>>>>>>        Set Color to 12363657
43274>>>>>>>>>>>>>>>        Set Location to 265 4
43275>>>>>>>>>>>>>>>        Set Size to 10 31
43276>>>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
43277>>>>>>>>>>>>>>>    End_Object    // TextBoxSub4
43278>>>>>>>>>>>>>>>
43278>>>>>>>>>>>>>>>
43278>>>>>>>>>>>>>>>    //AB-StoreStart
43278>>>>>>>>>>>>>>>                                
43278>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43279>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43280>>>>>>>>>>>>>>>    
43280>>>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
43281>>>>>>>>>>>>>>>    Set Modal_State to True
43282>>>>>>>>>>>>>>>    
43282>>>>>>>>>>>>>>>    Procedure Request_Cancel
43284>>>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
43285>>>>>>>>>>>>>>>        Send Clear to Particle_DD
43286>>>>>>>>>>>>>>>        Forward Send Request_Cancel
43288>>>>>>>>>>>>>>>    End_Procedure
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    
43289>>>>>>>>>>>>>>>    //AB-StoreEnd
43289>>>>>>>>>>>>>>>
43289>>>>>>>>>>>>>>>End_Object    // sl014
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>//AB-StoreStart
43290>>>>>>>>>>>>>>>            
43290>>>>>>>>>>>>>>>            
43290>>>>>>>>>>>>>>>//AB-StoreEnd
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43290>>>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
43290>>>>>>>>>>>>>>>//AB/ Project sl054:cars
43290>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43290>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
43290>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
43290>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>// Project Object Structure
43290>>>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
43290>>>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
43290>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43290>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43290>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43290>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>// Register all objects
43290>>>>>>>>>>>>>>>Register_Object Cars_DD
43290>>>>>>>>>>>>>>>Register_Object oCancel_bn
43290>>>>>>>>>>>>>>>Register_Object oOK_bn
43290>>>>>>>>>>>>>>>Register_Object oSearch_bn
43290>>>>>>>>>>>>>>>Register_Object oSelList
43290>>>>>>>>>>>>>>>Register_Object sl054
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>//AB-IgnoreStart
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43290>>>>>>>>>>>>>>>Use dbList.Sub
43290>>>>>>>>>>>>>>>Use Button.Sub
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
43290>>>>>>>>>>>>>>>>>//DDB-FileStart
43290>>>>>>>>>>>>>>>>>//DDB-HeaderStart
43290>>>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>>>// File Name : CARS.DD
43290>>>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
43290>>>>>>>>>>>>>>>>>// Revision  : 16
43290>>>>>>>>>>>>>>>>>// Version   : 2
43290>>>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43290>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43290>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43290>>>>>>>>>>>>>>>>>
43290>>>>>>>>>>>>>>>>>Open Cars
43292>>>>>>>>>>>>>>>>>Open Gmove
43294>>>>>>>>>>>>>>>>>Open Sysrecg
43296>>>>>>>>>>>>>>>>>
43296>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
43296>>>>>>>>>>>>>>>>>//DDB-ValidationStart
43296>>>>>>>>>>>>>>>>>
43296>>>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
43296>>>>>>>>>>>>>>>>>
43296>>>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
43298>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
43299>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
43300>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43301>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43301>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43301>>>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
43302>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
43302>>>>>>>>>>>>>>>>>//DDB-SelectionStart
43302>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
43302>>>>>>>>>>>>>>>>>Register_Object sl054
43302>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
43302>>>>>>>>>>>>>>>>>
43302>>>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
43303>>>>>>>>>>>>>>>>>
43303>>>>>>>>>>>>>>>>>
43303>>>>>>>>>>>>>>>>>    Procedure Construct_Object
43304>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
43306>>>>>>>>>>>>>>>>>        //------------------------------------------------
43306>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43306>>>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
43306>>>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
43306>>>>>>>>>>>>>>>>>        //------------------------------------------------  
43306>>>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
43307>>>>>>>>>>>>>>>>>        Property Integer piAud_Old_Tare         Public  0
43308>>>>>>>>>>>>>>>>>        Property Number  pnAud_Old_Pagio        Public  0
43309>>>>>>>>>>>>>>>>>        Property String  psAud_Old_CarID        Public ""
43310>>>>>>>>>>>>>>>>>        Property String  psAud_Old_CarLicense   Public ""
43311>>>>>>>>>>>>>>>>>        //------------------------------------------------
43311>>>>>>>>>>>>>>>>>
43311>>>>>>>>>>>>>>>>>    End_procedure
43312>>>>>>>>>>>>>>>>>
43312>>>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43313>>>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43315>>>>>>>>>>>>>>>>>        //------------------------------------------------
43315>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43315>>>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
43315>>>>>>>>>>>>>>>>>        //------------------------------------------------
43315>>>>>>>>>>>>>>>>>        Set piAud_Old_Tare          to Cars.Car_Tare
43316>>>>>>>>>>>>>>>>>        Set pnAud_Old_Pagio         to Cars.Pagio
43317>>>>>>>>>>>>>>>>>        Set psAud_Old_CarID         to Cars.Car_ID
43318>>>>>>>>>>>>>>>>>        Set psAud_Old_CarLicense    to Cars.Car_License
43319>>>>>>>>>>>>>>>>>        //------------------------------------------------
43319>>>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
43320>>>>>>>>>>>>>>>>>
43320>>>>>>>>>>>>>>>>>    Procedure Delete_Main_File
43321>>>>>>>>>>>>>>>>>        //---------------------------------------------
43321>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43321>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43322>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43322>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43322>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43326>>>>>>>>>>>>>>>>>        Move iHour  to sHour
43327>>>>>>>>>>>>>>>>>        Move iMin   to sMin
43328>>>>>>>>>>>>>>>>>        Move iSec   to sSec
43329>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43333>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43337>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43341>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43342>>>>>>>>>>>>>>>>>        
43342>>>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
43342>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
43344>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43345>>>>>>>>>>>>>>>>>            clear gmove
43346>>>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
43347>>>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
43348>>>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
43349>>>>>>>>>>>>>>>>>            move  5                     to gmove.gtypkin_code// Apo Clients
43350>>>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
43351>>>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
43352>>>>>>>>>>>>>>>>>            move Cars.Car_ID            to gmove.garticl_recr
43353>>>>>>>>>>>>>>>>>            reread sysrecg
43357>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43358>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43359>>>>>>>>>>>>>>>>>            saverecord sysrecg
43360>>>>>>>>>>>>>>>>>            unlock
43361>>>>>>>>>>>>>>>>>>
43361>>>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
43362>>>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
43363>>>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
43364>>>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
43365>>>>>>>>>>>>>>>>>            
43365>>>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Partl_Recr          
43366>>>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Pms_Recr          
43367>>>>>>>>>>>>>>>>>
43367>>>>>>>>>>>>>>>>>            Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro
43368>>>>>>>>>>>>>>>>>            Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1
43369>>>>>>>>>>>>>>>>>            Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma
43370>>>>>>>>>>>>>>>>>            Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
43371>>>>>>>>>>>>>>>>>
43371>>>>>>>>>>>>>>>>>
43371>>>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª Ž®ã£˜«¦ª"    to gmove.gmove_aitiol
43372>>>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
43373>>>>>>>>>>>>>>>>>            saverecord gmove
43374>>>>>>>>>>>>>>>>>        End
43374>>>>>>>>>>>>>>>>>>
43374>>>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
43376>>>>>>>>>>>>>>>>>
43376>>>>>>>>>>>>>>>>>    End_Procedure
43377>>>>>>>>>>>>>>>>>
43377>>>>>>>>>>>>>>>>>     Procedure Creating
43378>>>>>>>>>>>>>>>>>        Forward Send Creating
43380>>>>>>>>>>>>>>>>>        Set piCreateNew to 1
43381>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
43382>>>>>>>>>>>>>>>>>
43382>>>>>>>>>>>>>>>>>
43382>>>>>>>>>>>>>>>>>
43382>>>>>>>>>>>>>>>>>
43382>>>>>>>>>>>>>>>>>    // Update:
43382>>>>>>>>>>>>>>>>>    Procedure Update
43383>>>>>>>>>>>>>>>>>        Forward Send Update
43385>>>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
43386>>>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
43387>>>>>>>>>>>>>>>>>        // Insert Code Here
43387>>>>>>>>>>>>>>>>>        
43387>>>>>>>>>>>>>>>>>        //---------------------------------------------
43387>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43387>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43388>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43388>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43388>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43392>>>>>>>>>>>>>>>>>        Move iHour  to sHour
43393>>>>>>>>>>>>>>>>>        Move iMin   to sMin
43394>>>>>>>>>>>>>>>>>        Move iSec   to sSec
43395>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43399>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43403>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43407>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43408>>>>>>>>>>>>>>>>>        
43408>>>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
43408>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
43410>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43411>>>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
43413>>>>>>>>>>>>>>>>>                clear gmove
43414>>>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
43415>>>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
43416>>>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
43417>>>>>>>>>>>>>>>>>                move  5                     to gmove.gtypkin_code// Apo Clients
43418>>>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
43419>>>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
43420>>>>>>>>>>>>>>>>>                move Cars.Car_ID            to gmove.garticl_recr
43421>>>>>>>>>>>>>>>>>                reread sysrecg
43425>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43426>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43427>>>>>>>>>>>>>>>>>                saverecord sysrecg
43428>>>>>>>>>>>>>>>>>                unlock
43429>>>>>>>>>>>>>>>>>>
43429>>>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
43430>>>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
43431>>>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
43432>>>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
43433>>>>>>>>>>>>>>>>>
43433>>>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Partl_Recr          
43434>>>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Pms_Recr          
43435>>>>>>>>>>>>>>>>>
43435>>>>>>>>>>>>>>>>>                Move Cars.Car_Tare          to Gmove.Cur_Ox_Apobaro
43436>>>>>>>>>>>>>>>>>                Move Cars.Pagio             to Gmove.Cur_Stoxos1
43437>>>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Cur_Oxhma
43438>>>>>>>>>>>>>>>>>                Move Cars.Car_License       to Gmove.Cur_CN_Prosth
43439>>>>>>>>>>>>>>>>>                
43439>>>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª Ž®ã£˜«¦ª" to Gmove.Gmove_Aitiol
43440>>>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
43441>>>>>>>>>>>>>>>>>                saverecord gmove
43442>>>>>>>>>>>>>>>>>                Set piCreateNew to 0
43443>>>>>>>>>>>>>>>>>            End
43443>>>>>>>>>>>>>>>>>>
43443>>>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
43446>>>>>>>>>>>>>>>>>                Integer isChanged
43446>>>>>>>>>>>>>>>>>                Move 0 to isChanged
43447>>>>>>>>>>>>>>>>>                
43447>>>>>>>>>>>>>>>>>                     If (pnAud_Old_Pagio     (Self)<>Cars.Pagio        ) Move 1 to isChanged
43450>>>>>>>>>>>>>>>>>                Else If (piAud_Old_Tare      (Self)<>Cars.Car_Tare     ) Move 1 to isChanged
43454>>>>>>>>>>>>>>>>>                Else If (psAud_Old_CarID     (Self)<>Cars.Car_ID       ) Move 1 to isChanged
43458>>>>>>>>>>>>>>>>>                Else If (psAud_Old_CarLicense(Self)<>Cars.Car_License  ) Move 1 to isChanged
43462>>>>>>>>>>>>>>>>>                
43462>>>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
43464>>>>>>>>>>>>>>>>>                    clear gmove
43465>>>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
43466>>>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
43467>>>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
43468>>>>>>>>>>>>>>>>>                    move  5                     to gmove.gtypkin_code// Apo Clients
43469>>>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
43470>>>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
43471>>>>>>>>>>>>>>>>>                    move Cars.Car_ID          to gmove.garticl_recr
43472>>>>>>>>>>>>>>>>>                    reread sysrecg
43476>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43477>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43478>>>>>>>>>>>>>>>>>                    saverecord sysrecg
43479>>>>>>>>>>>>>>>>>                    unlock
43480>>>>>>>>>>>>>>>>>>
43480>>>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
43481>>>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
43482>>>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
43483>>>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
43484>>>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Partl_Recr          
43485>>>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Pms_Recr          
43486>>>>>>>>>>>>>>>>>                    //--                                
43486>>>>>>>>>>>>>>>>>                    Move Cars.Car_Tare                  to Gmove.Cur_Ox_Apobaro
43487>>>>>>>>>>>>>>>>>                    Move Cars.Pagio                     to Gmove.Cur_Stoxos1
43488>>>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Cur_Oxhma
43489>>>>>>>>>>>>>>>>>                    Move Cars.Car_License               to Gmove.Cur_CN_Prosth
43490>>>>>>>>>>>>>>>>>                    //--
43490>>>>>>>>>>>>>>>>>                    Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro    
43491>>>>>>>>>>>>>>>>>                    Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1       
43492>>>>>>>>>>>>>>>>>                    Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma         
43493>>>>>>>>>>>>>>>>>                    Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
43494>>>>>>>>>>>>>>>>>                                                         
43494>>>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª Ž®ã£˜«¦ª"   to gmove.gmove_aitiol
43495>>>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
43496>>>>>>>>>>>>>>>>>                    saverecord gmove
43497>>>>>>>>>>>>>>>>>                    Set piCreateNew to 0
43498>>>>>>>>>>>>>>>>>                End
43498>>>>>>>>>>>>>>>>>>
43498>>>>>>>>>>>>>>>>>            End
43498>>>>>>>>>>>>>>>>>>
43498>>>>>>>>>>>>>>>>>        End
43498>>>>>>>>>>>>>>>>>>
43498>>>>>>>>>>>>>>>>>        
43498>>>>>>>>>>>>>>>>>    End_Procedure   // Update
43499>>>>>>>>>>>>>>>>>
43499>>>>>>>>>>>>>>>>>
43499>>>>>>>>>>>>>>>>>    // Define_Fields:
43499>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43499>>>>>>>>>>>>>>>>>
43499>>>>>>>>>>>>>>>>>    Procedure Define_Fields
43500>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
43502>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43502>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43502>>>>>>>>>>>>>>>>>
43502>>>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
43503>>>>>>>>>>>>>>>>>
43503>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43504>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43505>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43506>>>>>>>>>>>>>>>>>
43506>>>>>>>>>>>>>>>>>        // External (System) file structure.............
43506>>>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
43507>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
43508>>>>>>>>>>>>>>>>>
43508>>>>>>>>>>>>>>>>>        // Field-based properties.......................
43508>>>>>>>>>>>>>>>>>
43508>>>>>>>>>>>>>>>>>        // Cars.Car_Recnum
43508>>>>>>>>>>>>>>>>>
43508>>>>>>>>>>>>>>>>>        // Cars.Car_Company
43508>>>>>>>>>>>>>>>>>
43508>>>>>>>>>>>>>>>>>        // Cars.Car_Id
43508>>>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
43509>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
43510>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
43511>>>>>>>>>>>>>>>>>
43511>>>>>>>>>>>>>>>>>        // Cars.Car_Descr
43511>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_License
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Details
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Sitew
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Tare
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Codematch
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Driverid
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Sn
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Markexp
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_748tare1
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_748tare2
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_748sign
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Car_Bsite
43512>>>>>>>>>>>>>>>>>
43512>>>>>>>>>>>>>>>>>        // Cars.Ctype_Id
43512>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
43513>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
43514>>>>>>>>>>>>>>>>>
43514>>>>>>>>>>>>>>>>>        // Cars.Pagio
43514>>>>>>>>>>>>>>>>>
43514>>>>>>>>>>>>>>>>>        // Cars.Parakrat
43514>>>>>>>>>>>>>>>>>
43514>>>>>>>>>>>>>>>>>        // Cars.Car_What
43514>>>>>>>>>>>>>>>>>
43514>>>>>>>>>>>>>>>>>        // Cars.Car_Lc
43514>>>>>>>>>>>>>>>>>
43514>>>>>>>>>>>>>>>>>        // Cars.Car_Ln
43514>>>>>>>>>>>>>>>>>
43514>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43514>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43515>>>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>>>    // Field_Defaults:
43515>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43515>>>>>>>>>>>>>>>>>
43515>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
43516>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43518>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43518>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43518>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43518>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43519>>>>>>>>>>>>>>>>>
43519>>>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
43520>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43520>>>>>>>>>>>>>>>>>
43520>>>>>>>>>>>>>>>>>Use sl054.SL         // sl054
43520>>>>>>>>>>>>>>>>>
43520>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
43520>>>>>>>>>>>>>>>>>//DDB-FileEnd
43520>>>>>>>>>>>>>>>
43520>>>>>>>>>>>>>>>//AB-IgnoreEnd
43520>>>>>>>>>>>>>>>
43520>>>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
43522>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
43523>>>>>>>>>>>>>>>    Set Size to 148 420
43524>>>>>>>>>>>>>>>    Set Location to 4 5
43525>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43526>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43527>>>>>>>>>>>>>>>
43527>>>>>>>>>>>>>>>    //AB-DDOStart
43527>>>>>>>>>>>>>>>
43527>>>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
43529>>>>>>>>>>>>>>>    End_Object    // Cars_DD
43530>>>>>>>>>>>>>>>
43530>>>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
43531>>>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
43532>>>>>>>>>>>>>>>
43532>>>>>>>>>>>>>>>    //AB-DDOEnd
43532>>>>>>>>>>>>>>>
43532>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43534>>>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
43535>>>>>>>>>>>>>>>        Set Size to 105 403
43536>>>>>>>>>>>>>>>        Set Location to 6 6
43537>>>>>>>>>>>>>>>
43537>>>>>>>>>>>>>>>        Begin_Row
43540>>>>>>>>>>>>>>>            Entry_Item Cars.Car_id
43541>>>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
43542>>>>>>>>>>>>>>>            Entry_Item Cars.Car_license
43543>>>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
43544>>>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
43545>>>>>>>>>>>>>>>        End_Row
43550>>>>>>>>>>>>>>>
43550>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
43551>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
43552>>>>>>>>>>>>>>>        
43552>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
43553>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43554>>>>>>>>>>>>>>>        
43554>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
43555>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
43556>>>>>>>>>>>>>>>        
43556>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
43557>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
43558>>>>>>>>>>>>>>>        
43558>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
43559>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
43560>>>>>>>>>>>>>>>        
43560>>>>>>>>>>>>>>>    End_Object    // oSelList
43561>>>>>>>>>>>>>>>
43561>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43563>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43564>>>>>>>>>>>>>>>        Set Location to 114 249
43565>>>>>>>>>>>>>>>
43565>>>>>>>>>>>>>>>        //AB-StoreStart
43565>>>>>>>>>>>>>>>        Procedure OnClick
43567>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43568>>>>>>>>>>>>>>>        End_Procedure
43569>>>>>>>>>>>>>>>        //AB-StoreEnd
43569>>>>>>>>>>>>>>>
43569>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43570>>>>>>>>>>>>>>>
43570>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43572>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43573>>>>>>>>>>>>>>>        Set Location to 114 305
43574>>>>>>>>>>>>>>>
43574>>>>>>>>>>>>>>>        //AB-StoreStart
43574>>>>>>>>>>>>>>>        Procedure OnClick
43576>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43577>>>>>>>>>>>>>>>        End_Procedure
43578>>>>>>>>>>>>>>>        //AB-StoreEnd
43578>>>>>>>>>>>>>>>
43578>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43579>>>>>>>>>>>>>>>
43579>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43581>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
43582>>>>>>>>>>>>>>>        Set Location to 114 359
43583>>>>>>>>>>>>>>>
43583>>>>>>>>>>>>>>>        //AB-StoreStart
43583>>>>>>>>>>>>>>>        Procedure OnClick
43585>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43586>>>>>>>>>>>>>>>        End_Procedure
43587>>>>>>>>>>>>>>>        //AB-StoreEnd
43587>>>>>>>>>>>>>>>
43587>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43588>>>>>>>>>>>>>>>
43588>>>>>>>>>>>>>>>
43588>>>>>>>>>>>>>>>    //AB-StoreStart
43588>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43589>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43590>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43591>>>>>>>>>>>>>>>    //AB-StoreEnd
43591>>>>>>>>>>>>>>>
43591>>>>>>>>>>>>>>>End_Object    // sl054
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43592>>>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
43592>>>>>>>>>>>>>>>//AB/ Project sl053:pumps
43592>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43592>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
43592>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
43592>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>// Project Object Structure
43592>>>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
43592>>>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
43592>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43592>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43592>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43592>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>// Register all objects
43592>>>>>>>>>>>>>>>Register_Object oCancel_bn
43592>>>>>>>>>>>>>>>Register_Object oOK_bn
43592>>>>>>>>>>>>>>>Register_Object oSearch_bn
43592>>>>>>>>>>>>>>>Register_Object oSelList
43592>>>>>>>>>>>>>>>Register_Object Pumps_DD
43592>>>>>>>>>>>>>>>Register_Object sl053
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>//AB-IgnoreStart
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43592>>>>>>>>>>>>>>>Use dbList.Sub
43592>>>>>>>>>>>>>>>Use Button.Sub
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
43592>>>>>>>>>>>>>>>>>//DDB-FileStart
43592>>>>>>>>>>>>>>>>>//DDB-HeaderStart
43592>>>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>>>// File Name : PUMPS.DD
43592>>>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
43592>>>>>>>>>>>>>>>>>// Revision  : 18
43592>>>>>>>>>>>>>>>>>// Version   : 2
43592>>>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43592>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43592>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43592>>>>>>>>>>>>>>>>>
43592>>>>>>>>>>>>>>>>>Open Pumps
43594>>>>>>>>>>>>>>>>>Open Gmove
43596>>>>>>>>>>>>>>>>>Open Sysrecg
43598>>>>>>>>>>>>>>>>>
43598>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
43598>>>>>>>>>>>>>>>>>//DDB-ValidationStart
43598>>>>>>>>>>>>>>>>>
43598>>>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
43598>>>>>>>>>>>>>>>>>
43598>>>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
43600>>>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
43601>>>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
43602>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
43603>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
43603>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
43603>>>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
43604>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
43604>>>>>>>>>>>>>>>>>//DDB-SelectionStart
43604>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
43604>>>>>>>>>>>>>>>>>Register_Object sl053
43604>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
43604>>>>>>>>>>>>>>>>>
43604>>>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
43605>>>>>>>>>>>>>>>>>
43605>>>>>>>>>>>>>>>>>    Procedure Construct_Object
43606>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
43608>>>>>>>>>>>>>>>>>        //------------------------------------------------
43608>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43608>>>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
43608>>>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
43608>>>>>>>>>>>>>>>>>        //------------------------------------------------  
43608>>>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
43609>>>>>>>>>>>>>>>>>        Property Number  pnAud_Old_M3           Public  0
43610>>>>>>>>>>>>>>>>>        Property Integer piAud_Old_Pagio        Public  0
43611>>>>>>>>>>>>>>>>>        Property String  psAud_Old_PumpID       Public ""
43612>>>>>>>>>>>>>>>>>        Property String  psAud_Old_License      Public ""
43613>>>>>>>>>>>>>>>>>        //------------------------------------------------
43613>>>>>>>>>>>>>>>>>
43613>>>>>>>>>>>>>>>>>    End_procedure
43614>>>>>>>>>>>>>>>>>
43614>>>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43615>>>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43617>>>>>>>>>>>>>>>>>        //------------------------------------------------
43617>>>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
43617>>>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
43617>>>>>>>>>>>>>>>>>        //------------------------------------------------
43617>>>>>>>>>>>>>>>>>        Set pnAud_Old_M3        to Pumps.PriceM3
43618>>>>>>>>>>>>>>>>>        Set piAud_Old_Pagio     to Pumps.PagioMin
43619>>>>>>>>>>>>>>>>>        Set psAud_Old_PumpID    to Pumps.Pump_ID
43620>>>>>>>>>>>>>>>>>        Set psAud_Old_License   to Pumps.Pump_License
43621>>>>>>>>>>>>>>>>>        //------------------------------------------------
43621>>>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
43622>>>>>>>>>>>>>>>>>
43622>>>>>>>>>>>>>>>>>    Procedure Delete_Main_File
43623>>>>>>>>>>>>>>>>>        //---------------------------------------------
43623>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43623>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43624>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43624>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43624>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43628>>>>>>>>>>>>>>>>>        Move iHour  to sHour
43629>>>>>>>>>>>>>>>>>        Move iMin   to sMin
43630>>>>>>>>>>>>>>>>>        Move iSec   to sSec
43631>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43635>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43639>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43643>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43644>>>>>>>>>>>>>>>>>        
43644>>>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
43644>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
43646>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43647>>>>>>>>>>>>>>>>>            clear gmove
43648>>>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
43649>>>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
43650>>>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
43651>>>>>>>>>>>>>>>>>            move  6                     to gmove.gtypkin_code// Apo Clients
43652>>>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
43653>>>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
43654>>>>>>>>>>>>>>>>>            move Pumps.Pump_ID          to gmove.garticl_recr
43655>>>>>>>>>>>>>>>>>            reread sysrecg
43659>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43660>>>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43661>>>>>>>>>>>>>>>>>            saverecord sysrecg
43662>>>>>>>>>>>>>>>>>            unlock
43663>>>>>>>>>>>>>>>>>>
43663>>>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
43664>>>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
43665>>>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
43666>>>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
43667>>>>>>>>>>>>>>>>>            
43667>>>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
43668>>>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
43669>>>>>>>>>>>>>>>>>
43669>>>>>>>>>>>>>>>>>            Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Ant_Min_M3
43670>>>>>>>>>>>>>>>>>            Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Stoxos1
43671>>>>>>>>>>>>>>>>>            Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
43672>>>>>>>>>>>>>>>>>            Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
43673>>>>>>>>>>>>>>>>>
43673>>>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
43674>>>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
43675>>>>>>>>>>>>>>>>>            saverecord gmove
43676>>>>>>>>>>>>>>>>>        End
43676>>>>>>>>>>>>>>>>>>
43676>>>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
43678>>>>>>>>>>>>>>>>>
43678>>>>>>>>>>>>>>>>>    End_Procedure
43679>>>>>>>>>>>>>>>>>
43679>>>>>>>>>>>>>>>>>     Procedure Creating
43680>>>>>>>>>>>>>>>>>        Forward Send Creating
43682>>>>>>>>>>>>>>>>>        Set piCreateNew to 1
43683>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
43684>>>>>>>>>>>>>>>>>
43684>>>>>>>>>>>>>>>>>
43684>>>>>>>>>>>>>>>>>    // Update:
43684>>>>>>>>>>>>>>>>>    Procedure Update
43685>>>>>>>>>>>>>>>>>        Forward Send Update
43687>>>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
43688>>>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
43689>>>>>>>>>>>>>>>>>
43689>>>>>>>>>>>>>>>>>
43689>>>>>>>>>>>>>>>>>        //---------------------------------------------
43689>>>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
43689>>>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
43690>>>>>>>>>>>>>>>>>        Date    dDate  Shmer 
43690>>>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
43690>>>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
43694>>>>>>>>>>>>>>>>>        Move iHour  to sHour
43695>>>>>>>>>>>>>>>>>        Move iMin   to sMin
43696>>>>>>>>>>>>>>>>>        Move iSec   to sSec
43697>>>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
43701>>>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
43705>>>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
43709>>>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
43710>>>>>>>>>>>>>>>>>        
43710>>>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
43710>>>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
43712>>>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
43713>>>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
43715>>>>>>>>>>>>>>>>>                clear gmove
43716>>>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
43717>>>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
43718>>>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
43719>>>>>>>>>>>>>>>>>                move  6                     to gmove.gtypkin_code// Apo Clients
43720>>>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
43721>>>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
43722>>>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.garticl_recr
43723>>>>>>>>>>>>>>>>>                reread sysrecg
43727>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43728>>>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43729>>>>>>>>>>>>>>>>>                saverecord sysrecg
43730>>>>>>>>>>>>>>>>>                unlock
43731>>>>>>>>>>>>>>>>>>
43731>>>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
43732>>>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
43733>>>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
43734>>>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
43735>>>>>>>>>>>>>>>>>
43735>>>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Partl_Recr          
43736>>>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Pms_Recr          
43737>>>>>>>>>>>>>>>>>
43737>>>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.Cur_Antlia
43738>>>>>>>>>>>>>>>>>                Move Pumps.PriceM3          to Gmove.Cur_Stoxos1
43739>>>>>>>>>>>>>>>>>                Move Pumps.PagioMin         to Gmove.Cur_Ant_Min_M3
43740>>>>>>>>>>>>>>>>>                Move Pumps.Pump_License     to Gmove.Cur_CN_Prosth
43741>>>>>>>>>>>>>>>>>
43741>>>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª €¤«¢å˜ª" to Gmove.Gmove_Aitiol
43742>>>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
43743>>>>>>>>>>>>>>>>>                saverecord gmove
43744>>>>>>>>>>>>>>>>>                Set piCreateNew to 0
43745>>>>>>>>>>>>>>>>>            End
43745>>>>>>>>>>>>>>>>>>
43745>>>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
43748>>>>>>>>>>>>>>>>>                Integer isChanged
43748>>>>>>>>>>>>>>>>>                Move 0 to isChanged
43749>>>>>>>>>>>>>>>>>                
43749>>>>>>>>>>>>>>>>>                     If (pnAud_Old_M3      (Self)<>Pumps.PriceM3     ) Move 1 to isChanged
43752>>>>>>>>>>>>>>>>>                Else If (piAud_Old_Pagio   (Self)<>Pumps.PagioMin    ) Move 1 to isChanged
43756>>>>>>>>>>>>>>>>>                Else If (psAud_Old_PumpID  (Self)<>Pumps.Pump_ID     ) Move 1 to isChanged
43760>>>>>>>>>>>>>>>>>                Else If (psAud_Old_License (Self)<>Pumps.Pump_License) Move 1 to isChanged
43764>>>>>>>>>>>>>>>>>
43764>>>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
43766>>>>>>>>>>>>>>>>>                    clear gmove
43767>>>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
43768>>>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
43769>>>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
43770>>>>>>>>>>>>>>>>>                    move  6                     to gmove.gtypkin_code// Apo Clients
43771>>>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
43772>>>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
43773>>>>>>>>>>>>>>>>>                    move Pumps.Pump_ID          to gmove.garticl_recr
43774>>>>>>>>>>>>>>>>>                    reread sysrecg
43778>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
43779>>>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
43780>>>>>>>>>>>>>>>>>                    saverecord sysrecg
43781>>>>>>>>>>>>>>>>>                    unlock
43782>>>>>>>>>>>>>>>>>>
43782>>>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
43783>>>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
43784>>>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
43785>>>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
43786>>>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
43787>>>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
43788>>>>>>>>>>>>>>>>>                    //--                                
43788>>>>>>>>>>>>>>>>>                    move Pumps.Pump_ID                  to gmove.Cur_Antlia
43789>>>>>>>>>>>>>>>>>                    Move Pumps.PriceM3                  to Gmove.Cur_Stoxos1
43790>>>>>>>>>>>>>>>>>                    Move Pumps.PagioMin                 to Gmove.Cur_Ant_Min_M3
43791>>>>>>>>>>>>>>>>>                    Move Pumps.Pump_License             to Gmove.Cur_CN_Prosth
43792>>>>>>>>>>>>>>>>>                    //--
43792>>>>>>>>>>>>>>>>>                    Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Stoxos1      
43793>>>>>>>>>>>>>>>>>                    Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Ant_Min_M3   
43794>>>>>>>>>>>>>>>>>                    Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
43795>>>>>>>>>>>>>>>>>                    Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
43796>>>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
43797>>>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
43798>>>>>>>>>>>>>>>>>                    saverecord gmove
43799>>>>>>>>>>>>>>>>>                    Set piCreateNew to 0
43800>>>>>>>>>>>>>>>>>                End
43800>>>>>>>>>>>>>>>>>>
43800>>>>>>>>>>>>>>>>>            End
43800>>>>>>>>>>>>>>>>>>
43800>>>>>>>>>>>>>>>>>        End
43800>>>>>>>>>>>>>>>>>>
43800>>>>>>>>>>>>>>>>>
43800>>>>>>>>>>>>>>>>>
43800>>>>>>>>>>>>>>>>>
43800>>>>>>>>>>>>>>>>>    End_Procedure   // Update
43801>>>>>>>>>>>>>>>>>
43801>>>>>>>>>>>>>>>>>
43801>>>>>>>>>>>>>>>>>    // Define_Fields:
43801>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43801>>>>>>>>>>>>>>>>>
43801>>>>>>>>>>>>>>>>>    Procedure Define_Fields
43802>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
43804>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43804>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43804>>>>>>>>>>>>>>>>>
43804>>>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
43805>>>>>>>>>>>>>>>>>
43805>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43806>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43807>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43808>>>>>>>>>>>>>>>>>
43808>>>>>>>>>>>>>>>>>        // External (System) file structure.............
43808>>>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
43809>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
43810>>>>>>>>>>>>>>>>>
43810>>>>>>>>>>>>>>>>>        // Field-based properties.......................
43810>>>>>>>>>>>>>>>>>
43810>>>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
43810>>>>>>>>>>>>>>>>>
43810>>>>>>>>>>>>>>>>>        // Pumps.Pump_Company
43810>>>>>>>>>>>>>>>>>
43810>>>>>>>>>>>>>>>>>        // Pumps.Pump_Id
43810>>>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
43811>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
43812>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
43813>>>>>>>>>>>>>>>>>
43813>>>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
43813>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_License
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
43814>>>>>>>>>>>>>>>>>
43814>>>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
43814>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
43815>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        // Pumps.Pagiomin
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        // Pumps.Pricem3
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        // Pumps.Parakrat
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        // Pumps.Pump_What
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        // Pumps.Pump_Lc
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        // Pumps.Pump_Ln
43816>>>>>>>>>>>>>>>>>
43816>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43816>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43817>>>>>>>>>>>>>>>>>
43817>>>>>>>>>>>>>>>>>    // Field_Defaults:
43817>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43817>>>>>>>>>>>>>>>>>
43817>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
43818>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43820>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43820>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43820>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43820>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43821>>>>>>>>>>>>>>>>>
43821>>>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
43822>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43822>>>>>>>>>>>>>>>>>
43822>>>>>>>>>>>>>>>>>Use sl053.SL         // sl053
43822>>>>>>>>>>>>>>>>>
43822>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
43822>>>>>>>>>>>>>>>>>//DDB-FileEnd
43822>>>>>>>>>>>>>>>
43822>>>>>>>>>>>>>>>//AB-IgnoreEnd
43822>>>>>>>>>>>>>>>
43822>>>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
43824>>>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
43825>>>>>>>>>>>>>>>    Set Size to 148 325
43826>>>>>>>>>>>>>>>    Set Location to 4 5
43827>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43828>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43829>>>>>>>>>>>>>>>
43829>>>>>>>>>>>>>>>    //AB-DDOStart
43829>>>>>>>>>>>>>>>
43829>>>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
43831>>>>>>>>>>>>>>>    End_Object    // Pumps_DD
43832>>>>>>>>>>>>>>>
43832>>>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
43833>>>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
43834>>>>>>>>>>>>>>>
43834>>>>>>>>>>>>>>>    //AB-DDOEnd
43834>>>>>>>>>>>>>>>
43834>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43836>>>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
43837>>>>>>>>>>>>>>>        Set Size to 105 309
43838>>>>>>>>>>>>>>>        Set Location to 6 6
43839>>>>>>>>>>>>>>>
43839>>>>>>>>>>>>>>>        Begin_Row
43842>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
43843>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
43844>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
43845>>>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
43846>>>>>>>>>>>>>>>        End_Row
43851>>>>>>>>>>>>>>>
43851>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
43852>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
43853>>>>>>>>>>>>>>>        
43853>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
43854>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43855>>>>>>>>>>>>>>>        
43855>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
43856>>>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
43857>>>>>>>>>>>>>>>        
43857>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
43858>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
43859>>>>>>>>>>>>>>>        
43859>>>>>>>>>>>>>>>    End_Object    // oSelList
43860>>>>>>>>>>>>>>>
43860>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43862>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43863>>>>>>>>>>>>>>>        Set Location to 114 157
43864>>>>>>>>>>>>>>>
43864>>>>>>>>>>>>>>>        //AB-StoreStart
43864>>>>>>>>>>>>>>>        Procedure OnClick
43866>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43867>>>>>>>>>>>>>>>        End_Procedure
43868>>>>>>>>>>>>>>>        //AB-StoreEnd
43868>>>>>>>>>>>>>>>
43868>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43869>>>>>>>>>>>>>>>
43869>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43871>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43872>>>>>>>>>>>>>>>        Set Location to 114 212
43873>>>>>>>>>>>>>>>
43873>>>>>>>>>>>>>>>        //AB-StoreStart
43873>>>>>>>>>>>>>>>        Procedure OnClick
43875>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43876>>>>>>>>>>>>>>>        End_Procedure
43877>>>>>>>>>>>>>>>        //AB-StoreEnd
43877>>>>>>>>>>>>>>>
43877>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43878>>>>>>>>>>>>>>>
43878>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43880>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
43881>>>>>>>>>>>>>>>        Set Location to 114 267
43882>>>>>>>>>>>>>>>
43882>>>>>>>>>>>>>>>        //AB-StoreStart
43882>>>>>>>>>>>>>>>        Procedure OnClick
43884>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43885>>>>>>>>>>>>>>>        End_Procedure
43886>>>>>>>>>>>>>>>        //AB-StoreEnd
43886>>>>>>>>>>>>>>>
43886>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43887>>>>>>>>>>>>>>>
43887>>>>>>>>>>>>>>>
43887>>>>>>>>>>>>>>>    //AB-StoreStart
43887>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43888>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43889>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43890>>>>>>>>>>>>>>>    //AB-StoreEnd
43890>>>>>>>>>>>>>>>
43890>>>>>>>>>>>>>>>End_Object    // sl053
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43891>>>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
43891>>>>>>>>>>>>>>>//AB/ Project sl064 : Zones
43891>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
43891>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
43891>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
43891>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>// Project Object Structure
43891>>>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
43891>>>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
43891>>>>>>>>>>>>>>>//     oSelList is a dbListSub
43891>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
43891>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
43891>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>// Register all objects
43891>>>>>>>>>>>>>>>Register_Object oCancel_bn
43891>>>>>>>>>>>>>>>Register_Object oOK_bn
43891>>>>>>>>>>>>>>>Register_Object oSearch_bn
43891>>>>>>>>>>>>>>>Register_Object oSelList
43891>>>>>>>>>>>>>>>Register_Object sl064
43891>>>>>>>>>>>>>>>Register_Object Zones_DD
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>//AB-IgnoreStart
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>Use DFAllEnt.pkg
43891>>>>>>>>>>>>>>>Use dbList.Sub
43891>>>>>>>>>>>>>>>Use Button.Sub
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
43891>>>>>>>>>>>>>>>>>//DDB-FileStart
43891>>>>>>>>>>>>>>>>>//DDB-HeaderStart
43891>>>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>>>// File Name : ZONES.DD
43891>>>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
43891>>>>>>>>>>>>>>>>>// Revision  : 4
43891>>>>>>>>>>>>>>>>>// Version   : 2
43891>>>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43891>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43891>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43891>>>>>>>>>>>>>>>>>
43891>>>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
43893>>>>>>>>>>>>>>>>>Open Brzones
43895>>>>>>>>>>>>>>>>>
43895>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
43895>>>>>>>>>>>>>>>>>//DDB-SelectionStart
43895>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
43895>>>>>>>>>>>>>>>>>Register_Object sl064
43895>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
43895>>>>>>>>>>>>>>>>>
43895>>>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
43896>>>>>>>>>>>>>>>>>
43896>>>>>>>>>>>>>>>>>    // Define_Fields:
43896>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43896>>>>>>>>>>>>>>>>>
43896>>>>>>>>>>>>>>>>>    Procedure Define_Fields
43897>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
43899>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43899>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
43899>>>>>>>>>>>>>>>>>
43899>>>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
43900>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
43901>>>>>>>>>>>>>>>>>
43901>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43902>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43903>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43904>>>>>>>>>>>>>>>>>
43904>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
43904>>>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
43905>>>>>>>>>>>>>>>>>
43905>>>>>>>>>>>>>>>>>        // Field-based properties.......................
43905>>>>>>>>>>>>>>>>>
43905>>>>>>>>>>>>>>>>>        // Zones.Zone_Id
43905>>>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
43906>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
43907>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
43908>>>>>>>>>>>>>>>>>
43908>>>>>>>>>>>>>>>>>        // Zones.Zone_Descr
43908>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
43909>>>>>>>>>>>>>>>>>
43909>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
43909>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
43910>>>>>>>>>>>>>>>>>
43910>>>>>>>>>>>>>>>>>    // Field_Defaults:
43910>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
43910>>>>>>>>>>>>>>>>>
43910>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
43911>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
43913>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
43913>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
43913>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
43913>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
43914>>>>>>>>>>>>>>>>>
43914>>>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
43915>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
43915>>>>>>>>>>>>>>>>>
43915>>>>>>>>>>>>>>>>>Use sl064.SL         // sl064
43915>>>>>>>>>>>>>>>>>
43915>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
43915>>>>>>>>>>>>>>>>>//DDB-FileEnd
43915>>>>>>>>>>>>>>>
43915>>>>>>>>>>>>>>>//AB-IgnoreEnd
43915>>>>>>>>>>>>>>>
43915>>>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
43934>>>>>>>>>>>>>>>    Set Label to "…é¤œª"
43935>>>>>>>>>>>>>>>    Set Size to 148 297
43936>>>>>>>>>>>>>>>    Set Location to 4 5
43937>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
43938>>>>>>>>>>>>>>>    Set Modal_State to FALSE
43939>>>>>>>>>>>>>>>
43939>>>>>>>>>>>>>>>    //AB-DDOStart
43939>>>>>>>>>>>>>>>
43939>>>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
43941>>>>>>>>>>>>>>>    End_Object    // Zones_DD
43942>>>>>>>>>>>>>>>
43942>>>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
43943>>>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
43944>>>>>>>>>>>>>>>
43944>>>>>>>>>>>>>>>    //AB-DDOEnd
43944>>>>>>>>>>>>>>>
43944>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
43946>>>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
43947>>>>>>>>>>>>>>>        Set Size to 105 280
43948>>>>>>>>>>>>>>>        Set Location to 6 6
43949>>>>>>>>>>>>>>>
43949>>>>>>>>>>>>>>>        Begin_Row
43952>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
43953>>>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
43954>>>>>>>>>>>>>>>        End_Row
43959>>>>>>>>>>>>>>>
43959>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
43960>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
43961>>>>>>>>>>>>>>>        
43961>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
43962>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43963>>>>>>>>>>>>>>>        
43963>>>>>>>>>>>>>>>    End_Object    // oSelList
43964>>>>>>>>>>>>>>>
43964>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
43966>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
43967>>>>>>>>>>>>>>>        Set Location to 115 126
43968>>>>>>>>>>>>>>>
43968>>>>>>>>>>>>>>>        //AB-StoreStart
43968>>>>>>>>>>>>>>>        Procedure OnClick
43970>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
43971>>>>>>>>>>>>>>>        End_Procedure
43972>>>>>>>>>>>>>>>        //AB-StoreEnd
43972>>>>>>>>>>>>>>>
43972>>>>>>>>>>>>>>>    End_Object    // oOK_bn
43973>>>>>>>>>>>>>>>
43973>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
43975>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
43976>>>>>>>>>>>>>>>        Set Location to 115 181
43977>>>>>>>>>>>>>>>
43977>>>>>>>>>>>>>>>        //AB-StoreStart
43977>>>>>>>>>>>>>>>        Procedure OnClick
43979>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
43980>>>>>>>>>>>>>>>        End_Procedure
43981>>>>>>>>>>>>>>>        //AB-StoreEnd
43981>>>>>>>>>>>>>>>
43981>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
43982>>>>>>>>>>>>>>>
43982>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
43984>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
43985>>>>>>>>>>>>>>>        Set Location to 115 236
43986>>>>>>>>>>>>>>>
43986>>>>>>>>>>>>>>>        //AB-StoreStart
43986>>>>>>>>>>>>>>>        Procedure OnClick
43988>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
43989>>>>>>>>>>>>>>>        End_Procedure
43990>>>>>>>>>>>>>>>        //AB-StoreEnd
43990>>>>>>>>>>>>>>>
43990>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
43991>>>>>>>>>>>>>>>
43991>>>>>>>>>>>>>>>
43991>>>>>>>>>>>>>>>    //AB-StoreStart
43991>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43992>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43993>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43994>>>>>>>>>>>>>>>    //AB-StoreEnd
43994>>>>>>>>>>>>>>>
43994>>>>>>>>>>>>>>>CD_End_Object    // sl064
43996>>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>
43996>>>>>>>>>>>>>>>//AB/ End_Object    // prj
43996>>>>>>>>>>>>>
43996>>>>>>>>>>>>>//DDB-Selection-pkg-End
43996>>>>>>>>>>>>>//DDB-FileEnd
43996>>>>>>>>>>>    Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
43996>>>>>>>>>>>>>//DDB-FileStart
43996>>>>>>>>>>>>>//DDB-HeaderStart
43996>>>>>>>>>>>>>
43996>>>>>>>>>>>>>// File Name : WAPOKAT.DD
43996>>>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
43996>>>>>>>>>>>>>// Revision  : 21
43996>>>>>>>>>>>>>// Version   : 2
43996>>>>>>>>>>>>>
43996>>>>>>>>>>>>>Use  Windows           // Basic Definitions
43996>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43996>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43996>>>>>>>>>>>>>
43996>>>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
43998>>>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
44000>>>>>>>>>>>>>Open Sysrecw
44002>>>>>>>>>>>>>Open Syscurxr
44004>>>>>>>>>>>>>
44004>>>>>>>>>>>>>//DDB-HeaderEnd
44004>>>>>>>>>>>>>//DDB-SelectionStart
44004>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
44004>>>>>>>>>>>>>Register_Object sl022
44004>>>>>>>>>>>>>//DDB-SelectionEnd
44004>>>>>>>>>>>>>
44004>>>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
44005>>>>>>>>>>>>>
44005>>>>>>>>>>>>>    // Update:
44005>>>>>>>>>>>>>    Procedure Update
44006>>>>>>>>>>>>>        Forward Send Update
44008>>>>>>>>>>>>>        // Insert Code Here
44008>>>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
44008>>>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
44008>>>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
44008>>>>>>>>>>>>>    End_Procedure   // Update
44009>>>>>>>>>>>>> 
44009>>>>>>>>>>>>>     Procedure Creating
44010>>>>>>>>>>>>>        Forward Send Creating
44012>>>>>>>>>>>>>        // Insert Code Here
44012>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
44013>>>>>>>>>>>>>    End_Procedure   // Creating
44014>>>>>>>>>>>>>
44014>>>>>>>>>>>>>
44014>>>>>>>>>>>>>    // Define_Fields:
44014>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44014>>>>>>>>>>>>>
44014>>>>>>>>>>>>>    Procedure Define_Fields
44015>>>>>>>>>>>>>        Forward Send Define_Fields
44017>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44017>>>>>>>>>>>>>        //DDB-DefineFieldStart
44017>>>>>>>>>>>>>
44017>>>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
44018>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44019>>>>>>>>>>>>>
44019>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44020>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44021>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44022>>>>>>>>>>>>>
44022>>>>>>>>>>>>>        // Child (Client) file structure................
44022>>>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
44023>>>>>>>>>>>>>
44023>>>>>>>>>>>>>        // External (System) file structure.............
44023>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44024>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44025>>>>>>>>>>>>>
44025>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
44028>>>>>>>>>>>>>
44028>>>>>>>>>>>>>        // Field-based properties.......................
44028>>>>>>>>>>>>>
44028>>>>>>>>>>>>>        // Wapokat.Wapokat_Code
44028>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
44029>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
44030>>>>>>>>>>>>>
44030>>>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
44030>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
44031>>>>>>>>>>>>>
44031>>>>>>>>>>>>>        // Wapokat.Wapokat_Descr
44031>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
44032>>>>>>>>>>>>>
44032>>>>>>>>>>>>>        // Wapokat.Wapokat_Recr
44032>>>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
44033>>>>>>>>>>>>>
44033>>>>>>>>>>>>>        // Wapokat.Enhm_Sap
44033>>>>>>>>>>>>>
44033>>>>>>>>>>>>>        // Wapokat.Sap_Descr
44033>>>>>>>>>>>>>
44033>>>>>>>>>>>>>        // Wapokat.Gl
44033>>>>>>>>>>>>>
44033>>>>>>>>>>>>>        // Wapokat.Glzz
44033>>>>>>>>>>>>>
44033>>>>>>>>>>>>>        // Wapokat.Oximm1
44033>>>>>>>>>>>>>
44033>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44033>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44034>>>>>>>>>>>>>
44034>>>>>>>>>>>>>    // Field_Defaults:
44034>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44034>>>>>>>>>>>>>
44034>>>>>>>>>>>>>    Procedure Field_Defaults
44035>>>>>>>>>>>>>        Forward Send Field_Defaults
44037>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44037>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44037>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44037>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44038>>>>>>>>>>>>>
44038>>>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
44039>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44039>>>>>>>>>>>>>
44039>>>>>>>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
44039>>>>>>>>>>>>>>>//AB/ Project sl022:kathg-apothkon
44039>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44039>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
44039>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>// Project Object Structure
44039>>>>>>>>>>>>>>>//   sl022 is a dbModalPanelSub
44039>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
44039>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44039>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44039>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44039>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>// Register all objects
44039>>>>>>>>>>>>>>>Register_Object oCancel_bn
44039>>>>>>>>>>>>>>>Register_Object oOK_bn
44039>>>>>>>>>>>>>>>Register_Object oSearch_bn
44039>>>>>>>>>>>>>>>Register_Object oSelList
44039>>>>>>>>>>>>>>>Register_Object sl022
44039>>>>>>>>>>>>>>>Register_Object Wapokat_DD
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>//AB-IgnoreStart
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>Use DFAllEnt.pkg
44039>>>>>>>>>>>>>>>Use dbList.Sub
44039>>>>>>>>>>>>>>>Use Button.Sub
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>Use WAPOKAT.DD
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>//AB-IgnoreEnd
44039>>>>>>>>>>>>>>>
44039>>>>>>>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
44058>>>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
44059>>>>>>>>>>>>>>>    Set Size to 148 297
44060>>>>>>>>>>>>>>>    Set Location to 12 19
44061>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44062>>>>>>>>>>>>>>>    Set Modal_State to FALSE
44063>>>>>>>>>>>>>>>
44063>>>>>>>>>>>>>>>    //AB-DDOStart
44063>>>>>>>>>>>>>>>
44063>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
44065>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
44066>>>>>>>>>>>>>>>
44066>>>>>>>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
44067>>>>>>>>>>>>>>>    Set Server to (Wapokat_DD(self))
44068>>>>>>>>>>>>>>>
44068>>>>>>>>>>>>>>>    //AB-DDOEnd
44068>>>>>>>>>>>>>>>
44068>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
44070>>>>>>>>>>>>>>>        Set Main_File to Wapokat.File_Number
44071>>>>>>>>>>>>>>>        Set Size to 105 280
44072>>>>>>>>>>>>>>>        Set Location to 6 6
44073>>>>>>>>>>>>>>>
44073>>>>>>>>>>>>>>>        Begin_Row
44076>>>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
44077>>>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
44078>>>>>>>>>>>>>>>        End_Row
44083>>>>>>>>>>>>>>>
44083>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 42
44084>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
44085>>>>>>>>>>>>>>>        
44085>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 228
44086>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
44087>>>>>>>>>>>>>>>        
44087>>>>>>>>>>>>>>>    End_Object    // oSelList
44088>>>>>>>>>>>>>>>
44088>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44090>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
44091>>>>>>>>>>>>>>>        Set Location to 115 126
44092>>>>>>>>>>>>>>>
44092>>>>>>>>>>>>>>>        //AB-StoreStart
44092>>>>>>>>>>>>>>>        Procedure OnClick
44094>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44095>>>>>>>>>>>>>>>        End_Procedure
44096>>>>>>>>>>>>>>>        //AB-StoreEnd
44096>>>>>>>>>>>>>>>
44096>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44097>>>>>>>>>>>>>>>
44097>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44099>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
44100>>>>>>>>>>>>>>>        Set Location to 115 181
44101>>>>>>>>>>>>>>>
44101>>>>>>>>>>>>>>>        //AB-StoreStart
44101>>>>>>>>>>>>>>>        Procedure OnClick
44103>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44104>>>>>>>>>>>>>>>        End_Procedure
44105>>>>>>>>>>>>>>>        //AB-StoreEnd
44105>>>>>>>>>>>>>>>
44105>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44106>>>>>>>>>>>>>>>
44106>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44108>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
44109>>>>>>>>>>>>>>>        Set Location to 115 236
44110>>>>>>>>>>>>>>>
44110>>>>>>>>>>>>>>>        //AB-StoreStart
44110>>>>>>>>>>>>>>>        Procedure OnClick
44112>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44113>>>>>>>>>>>>>>>        End_Procedure
44114>>>>>>>>>>>>>>>        //AB-StoreEnd
44114>>>>>>>>>>>>>>>
44114>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44115>>>>>>>>>>>>>>>
44115>>>>>>>>>>>>>>>
44115>>>>>>>>>>>>>>>    //AB-StoreStart
44115>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44116>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44117>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44118>>>>>>>>>>>>>>>    //AB-StoreEnd
44118>>>>>>>>>>>>>>>
44118>>>>>>>>>>>>>>>CD_End_Object    // sl022
44120>>>>>>>>>>>>>>>>
44120>>>>>>>>>>>>>>>
44120>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44120>>>>>>>>>>>>>
44120>>>>>>>>>>>>>//DDB-Selection-pkg-End
44120>>>>>>>>>>>>>//DDB-FileEnd
44120>>>>>>>>>>>    Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
44120>>>>>>>>>>>>>//DDB-FileStart
44120>>>>>>>>>>>>>//DDB-HeaderStart
44120>>>>>>>>>>>>>
44120>>>>>>>>>>>>>// File Name : WAPOMAST.DD
44120>>>>>>>>>>>>>// Class Name: Wapomast_DataDictionary
44120>>>>>>>>>>>>>// Revision  : 13
44120>>>>>>>>>>>>>// Version   : 2
44120>>>>>>>>>>>>>
44120>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44120>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44120>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44120>>>>>>>>>>>>>
44120>>>>>>>>>>>>>Open Wapomast
44122>>>>>>>>>>>>>Open Wax
44124>>>>>>>>>>>>>Open Wapokat
44126>>>>>>>>>>>>>Open Sysrecw
44128>>>>>>>>>>>>>
44128>>>>>>>>>>>>>//DDB-HeaderEnd
44128>>>>>>>>>>>>>//DDB-SelectionStart
44128>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
44128>>>>>>>>>>>>>Register_Object sl023
44128>>>>>>>>>>>>>//DDB-SelectionEnd
44128>>>>>>>>>>>>>
44128>>>>>>>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
44129>>>>>>>>>>>>>    // Update:
44129>>>>>>>>>>>>>    Procedure Update
44130>>>>>>>>>>>>>        Forward Send Update
44132>>>>>>>>>>>>>        // Insert Code Here
44132>>>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
44132>>>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
44132>>>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
44132>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
44133>>>>>>>>>>>>>    End_Procedure   // Update
44134>>>>>>>>>>>>> 
44134>>>>>>>>>>>>>     Procedure Creating
44135>>>>>>>>>>>>>        Forward Send Creating
44137>>>>>>>>>>>>>        // Insert Code Here
44137>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
44138>>>>>>>>>>>>>    End_Procedure   // Creating
44139>>>>>>>>>>>>>
44139>>>>>>>>>>>>>
44139>>>>>>>>>>>>>    // Define_Fields:
44139>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44139>>>>>>>>>>>>>
44139>>>>>>>>>>>>>    Procedure Define_Fields
44140>>>>>>>>>>>>>        Forward Send Define_Fields
44142>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44142>>>>>>>>>>>>>        //DDB-DefineFieldStart
44142>>>>>>>>>>>>>
44142>>>>>>>>>>>>>        Set Main_File            To Wapomast.File_Number
44143>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44144>>>>>>>>>>>>>
44144>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44145>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44146>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44147>>>>>>>>>>>>>
44147>>>>>>>>>>>>>        // Child (Client) file structure................
44147>>>>>>>>>>>>>        Send Add_Client_File  Wax.File_Number
44148>>>>>>>>>>>>>
44148>>>>>>>>>>>>>        // Parent (Server) file structure...............
44148>>>>>>>>>>>>>        Send Add_Server_File  Wapokat.File_Number
44149>>>>>>>>>>>>>
44149>>>>>>>>>>>>>        // External (System) file structure.............
44149>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44150>>>>>>>>>>>>>
44150>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
44153>>>>>>>>>>>>>
44153>>>>>>>>>>>>>        // Field-based properties.......................
44153>>>>>>>>>>>>>
44153>>>>>>>>>>>>>        // Wapomast.Wapokat_Code
44153>>>>>>>>>>>>>
44153>>>>>>>>>>>>>        // Wapomast.Wapokat_Recr
44153>>>>>>>>>>>>>
44153>>>>>>>>>>>>>        // Wapomast.Wapomast_Code
44153>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
44154>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
44155>>>>>>>>>>>>>
44155>>>>>>>>>>>>>        // Wapomast.Wapomast_Rec0
44155>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
44156>>>>>>>>>>>>>
44156>>>>>>>>>>>>>        // Wapomast.Wapomast_Descr
44156>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
44157>>>>>>>>>>>>>
44157>>>>>>>>>>>>>        // Wapomast.Wapomast_Recr
44157>>>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
44158>>>>>>>>>>>>>
44158>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44158>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44159>>>>>>>>>>>>>
44159>>>>>>>>>>>>>    // Field_Defaults:
44159>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44159>>>>>>>>>>>>>
44159>>>>>>>>>>>>>    Procedure Field_Defaults
44160>>>>>>>>>>>>>        Forward Send Field_Defaults
44162>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44162>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44162>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44162>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44163>>>>>>>>>>>>>
44163>>>>>>>>>>>>>End_Class    // Wapomast_DataDictionary
44164>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44164>>>>>>>>>>>>>
44164>>>>>>>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
44164>>>>>>>>>>>>>>>//AB/ Project sl023:apothkes
44164>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44164>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
44164>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>// Project Object Structure
44164>>>>>>>>>>>>>>>//   sl023 is a dbModalPanelSub
44164>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
44164>>>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
44164>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44164>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44164>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44164>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>// Register all objects
44164>>>>>>>>>>>>>>>Register_Object oCancel_bn
44164>>>>>>>>>>>>>>>Register_Object oOK_bn
44164>>>>>>>>>>>>>>>Register_Object oSearch_bn
44164>>>>>>>>>>>>>>>Register_Object oSelList
44164>>>>>>>>>>>>>>>Register_Object sl023
44164>>>>>>>>>>>>>>>Register_Object Wapokat_DD
44164>>>>>>>>>>>>>>>Register_Object Wapomast_DD
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>//AB-IgnoreStart
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>Use DFAllEnt.pkg
44164>>>>>>>>>>>>>>>Use dbList.Sub
44164>>>>>>>>>>>>>>>Use Button.Sub
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>Use WAPOKAT.DD
44164>>>>>>>>>>>>>>>Use WAPOMAST.DD
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>//AB-IgnoreEnd
44164>>>>>>>>>>>>>>>
44164>>>>>>>>>>>>>>>Object sl023 is a dbModalPanelSub
44166>>>>>>>>>>>>>>>
44166>>>>>>>>>>>>>>>    //AB-StoreTopStart
44166>>>>>>>>>>>>>>>    property string psapokat public ''
44168>>>>>>>>>>>>>>>    //AB-StoreTopEnd
44168>>>>>>>>>>>>>>>
44168>>>>>>>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
44169>>>>>>>>>>>>>>>    Set Size to 126 260
44170>>>>>>>>>>>>>>>    Set Location to 4 19
44171>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44172>>>>>>>>>>>>>>>    Set Modal_State to FALSE
44173>>>>>>>>>>>>>>>
44173>>>>>>>>>>>>>>>    //AB-DDOStart
44173>>>>>>>>>>>>>>>
44173>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
44175>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
44176>>>>>>>>>>>>>>>
44176>>>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
44178>>>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
44179>>>>>>>>>>>>>>>
44179>>>>>>>>>>>>>>>        //AB-StoreStart
44179>>>>>>>>>>>>>>>        
44179>>>>>>>>>>>>>>>        begin_constraints
44181>>>>>>>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
44185>>>>>>>>>>>>>>>        
44185>>>>>>>>>>>>>>>        end_constraints
44188>>>>>>>>>>>>>>>        
44188>>>>>>>>>>>>>>>        //AB-StoreEnd
44188>>>>>>>>>>>>>>>
44188>>>>>>>>>>>>>>>    End_Object    // Wapomast_DD
44189>>>>>>>>>>>>>>>
44189>>>>>>>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
44190>>>>>>>>>>>>>>>    Set Server to (Wapomast_DD(self))
44191>>>>>>>>>>>>>>>
44191>>>>>>>>>>>>>>>    //AB-DDOEnd
44191>>>>>>>>>>>>>>>
44191>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
44193>>>>>>>>>>>>>>>        Set Main_File to Wapomast.File_Number
44194>>>>>>>>>>>>>>>        Set Server to (Wapokat_DD(self))
44195>>>>>>>>>>>>>>>        Set Size to 89 240
44196>>>>>>>>>>>>>>>        Set Location to 6 6
44197>>>>>>>>>>>>>>>
44197>>>>>>>>>>>>>>>        Begin_Row
44200>>>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
44201>>>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
44202>>>>>>>>>>>>>>>        End_Row
44207>>>>>>>>>>>>>>>
44207>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
44208>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
44209>>>>>>>>>>>>>>>        
44209>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 160
44210>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44211>>>>>>>>>>>>>>>        
44211>>>>>>>>>>>>>>>
44211>>>>>>>>>>>>>>>        //AB-StoreStart
44211>>>>>>>>>>>>>>>                    
44211>>>>>>>>>>>>>>>                    
44211>>>>>>>>>>>>>>>        //AB-StoreEnd
44211>>>>>>>>>>>>>>>
44211>>>>>>>>>>>>>>>    End_Object    // oSelList
44212>>>>>>>>>>>>>>>
44212>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44214>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
44215>>>>>>>>>>>>>>>        Set Location to 92 81
44216>>>>>>>>>>>>>>>
44216>>>>>>>>>>>>>>>        //AB-StoreStart
44216>>>>>>>>>>>>>>>        Procedure OnClick
44218>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44219>>>>>>>>>>>>>>>        End_Procedure
44220>>>>>>>>>>>>>>>        //AB-StoreEnd
44220>>>>>>>>>>>>>>>
44220>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44221>>>>>>>>>>>>>>>
44221>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44223>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44224>>>>>>>>>>>>>>>        Set Location to 92 135
44225>>>>>>>>>>>>>>>
44225>>>>>>>>>>>>>>>        //AB-StoreStart
44225>>>>>>>>>>>>>>>        Procedure OnClick
44227>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44228>>>>>>>>>>>>>>>        End_Procedure
44229>>>>>>>>>>>>>>>        //AB-StoreEnd
44229>>>>>>>>>>>>>>>
44229>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44230>>>>>>>>>>>>>>>
44230>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44232>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44233>>>>>>>>>>>>>>>        Set Location to 92 191
44234>>>>>>>>>>>>>>>
44234>>>>>>>>>>>>>>>        //AB-StoreStart
44234>>>>>>>>>>>>>>>        Procedure OnClick
44236>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44237>>>>>>>>>>>>>>>        End_Procedure
44238>>>>>>>>>>>>>>>        //AB-StoreEnd
44238>>>>>>>>>>>>>>>
44238>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44239>>>>>>>>>>>>>>>
44239>>>>>>>>>>>>>>>
44239>>>>>>>>>>>>>>>    //AB-StoreStart
44239>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44240>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44241>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44242>>>>>>>>>>>>>>>    
44242>>>>>>>>>>>>>>>    procedure activate
44244>>>>>>>>>>>>>>>        send rebuild_constraints to wapomast_dd
44245>>>>>>>>>>>>>>>        send beginning_of_data to osellist true
44246>>>>>>>>>>>>>>>        forward send activate
44248>>>>>>>>>>>>>>>    end_procedure
44249>>>>>>>>>>>>>>>    
44249>>>>>>>>>>>>>>>    
44249>>>>>>>>>>>>>>>    //AB-StoreEnd
44249>>>>>>>>>>>>>>>
44249>>>>>>>>>>>>>>>End_Object    // sl023
44250>>>>>>>>>>>>>>>
44250>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44250>>>>>>>>>>>>>
44250>>>>>>>>>>>>>//DDB-Selection-pkg-End
44250>>>>>>>>>>>>>//DDB-FileEnd
44250>>>>>>>>>>>    Use WAX.DD
INCLUDING FILE: WAX.DD
44250>>>>>>>>>>>>>//DDB-FileStart
44250>>>>>>>>>>>>>//DDB-HeaderStart
44250>>>>>>>>>>>>>
44250>>>>>>>>>>>>>// File Name : WAX.DD
44250>>>>>>>>>>>>>// Class Name: Wax_DataDictionary
44250>>>>>>>>>>>>>// Revision  : 39
44250>>>>>>>>>>>>>// Version   : 2
44250>>>>>>>>>>>>>
44250>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44250>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44250>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44250>>>>>>>>>>>>>
44250>>>>>>>>>>>>>Open Wax
44252>>>>>>>>>>>>>Open Pmoves
44254>>>>>>>>>>>>>Open Wcmoves
44256>>>>>>>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
44258>>>>>>>>>>>>>Open Pmovesl
44260>>>>>>>>>>>>>Open Wapomast
44262>>>>>>>>>>>>>Open Sysrecw
44264>>>>>>>>>>>>>Open Syscurxr
44266>>>>>>>>>>>>>
44266>>>>>>>>>>>>>//DDB-HeaderEnd
44266>>>>>>>>>>>>>//DDB-SelectionStart
44266>>>>>>>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
44266>>>>>>>>>>>>>Register_Object Wax
44266>>>>>>>>>>>>>//DDB-SelectionEnd
44266>>>>>>>>>>>>>
44266>>>>>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
44268>>>>>>>>>>>>>Open Wapokat
44270>>>>>>>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
44272>>>>>>>>>>>>>
44272>>>>>>>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
44273>>>>>>>>>>>>>
44273>>>>>>>>>>>>>    Procedure Construct_Object
44274>>>>>>>>>>>>>        Forward Send Construct_Object
44276>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
44277>>>>>>>>>>>>>    End_Procedure //construct_object
44278>>>>>>>>>>>>>
44278>>>>>>>>>>>>>    Procedure OnConstrain
44279>>>>>>>>>>>>>        Forward Send OnConstrain
44281>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
44283>>>>>>>>>>>>>        End
44283>>>>>>>>>>>>>>
44283>>>>>>>>>>>>>        Else Begin
44284>>>>>>>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
44286>>>>>>>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
44288>>>>>>>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
44290>>>>>>>>>>>>>        End
44290>>>>>>>>>>>>>>
44290>>>>>>>>>>>>>    End_Procedure
44291>>>>>>>>>>>>>
44291>>>>>>>>>>>>>
44291>>>>>>>>>>>>>    // Update:
44291>>>>>>>>>>>>>    Procedure Update
44292>>>>>>>>>>>>>        Forward Send Update
44294>>>>>>>>>>>>>        // Insert Code Here
44294>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
44295>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
44296>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
44297>>>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
44298>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
44299>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
44300>>>>>>>>>>>>>    End_Procedure   // Update
44301>>>>>>>>>>>>>
44301>>>>>>>>>>>>>     Procedure Creating
44302>>>>>>>>>>>>>        Forward Send Creating
44304>>>>>>>>>>>>>        // Insert Code Here
44304>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
44305>>>>>>>>>>>>>    End_Procedure   // Creating
44306>>>>>>>>>>>>>
44306>>>>>>>>>>>>>
44306>>>>>>>>>>>>>
44306>>>>>>>>>>>>>    // Define_Fields:
44306>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44306>>>>>>>>>>>>>
44306>>>>>>>>>>>>>    Procedure Define_Fields
44307>>>>>>>>>>>>>        Forward Send Define_Fields
44309>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44309>>>>>>>>>>>>>        //DDB-DefineFieldStart
44309>>>>>>>>>>>>>
44309>>>>>>>>>>>>>        Set Main_File            To Wax.File_Number
44310>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44311>>>>>>>>>>>>>
44311>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44312>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44313>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44314>>>>>>>>>>>>>
44314>>>>>>>>>>>>>        // Child (Client) file structure................
44314>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
44315>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
44316>>>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
44317>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
44318>>>>>>>>>>>>>
44318>>>>>>>>>>>>>        // Parent (Server) file structure...............
44318>>>>>>>>>>>>>        Send Add_Server_File  Wapomast.File_Number
44319>>>>>>>>>>>>>
44319>>>>>>>>>>>>>        // External (System) file structure.............
44319>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44320>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44321>>>>>>>>>>>>>
44321>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Field-based properties.......................
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Wax.Company_Code
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Wax.Branch_Code
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Wax.Year_Year
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Wax.Wapokat_Code
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Wax.Wapomast_Code
44324>>>>>>>>>>>>>
44324>>>>>>>>>>>>>        // Wax.Wax_Code
44324>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
44325>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
44326>>>>>>>>>>>>>
44326>>>>>>>>>>>>>        // Wax.Year_Recr
44326>>>>>>>>>>>>>
44326>>>>>>>>>>>>>        // Wax.Wapomast_Recr
44326>>>>>>>>>>>>>
44326>>>>>>>>>>>>>        // Wax.Wax_Rec0
44326>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
44327>>>>>>>>>>>>>
44327>>>>>>>>>>>>>        // Wax.Wax_Recr
44327>>>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
44328>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
44329>>>>>>>>>>>>>
44329>>>>>>>>>>>>>        // Wax.Wax_Descr
44329>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
44330>>>>>>>>>>>>>
44330>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44330>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44331>>>>>>>>>>>>>
44331>>>>>>>>>>>>>    // Field_Defaults:
44331>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44331>>>>>>>>>>>>>
44331>>>>>>>>>>>>>    Procedure Field_Defaults
44332>>>>>>>>>>>>>        Forward Send Field_Defaults
44334>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44334>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44334>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44334>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44335>>>>>>>>>>>>>
44335>>>>>>>>>>>>>End_Class    // Wax_DataDictionary
44336>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44336>>>>>>>>>>>>>
44336>>>>>>>>>>>>>Use Wax.SL           // Wax
INCLUDING FILE: WAX.SL
44336>>>>>>>>>>>>>>>//AB/ Project Wax:Lookup Apothikhs
44336>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44336>>>>>>>>>>>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
44336>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Wax.SL"
44336>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>// Project Object Structure
44336>>>>>>>>>>>>>>>//   Wax is a dbModalPanelSub
44336>>>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
44336>>>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
44336>>>>>>>>>>>>>>>//     Wax_DD is a DataDictionary
44336>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44336>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44336>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44336>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>// Register all objects
44336>>>>>>>>>>>>>>>Register_Object oCancel_bn
44336>>>>>>>>>>>>>>>Register_Object oOK_bn
44336>>>>>>>>>>>>>>>Register_Object oSearch_bn
44336>>>>>>>>>>>>>>>Register_Object oSelList
44336>>>>>>>>>>>>>>>Register_Object Wapokat_DD
44336>>>>>>>>>>>>>>>Register_Object Wapomast_DD
44336>>>>>>>>>>>>>>>Register_Object Wax
44336>>>>>>>>>>>>>>>Register_Object Wax_DD
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>//AB-IgnoreStart
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>Use DFAllEnt.pkg
44336>>>>>>>>>>>>>>>Use dbList.Sub
44336>>>>>>>>>>>>>>>Use Button.Sub
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>Use WAPOKAT.DD
44336>>>>>>>>>>>>>>>Use WAPOMAST.DD
44336>>>>>>>>>>>>>>>Use WAX.DD
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>//AB-IgnoreEnd
44336>>>>>>>>>>>>>>>
44336>>>>>>>>>>>>>>>Object Wax is a dbModalPanelSub
44338>>>>>>>>>>>>>>>
44338>>>>>>>>>>>>>>>    //AB-StoreTopStart
44338>>>>>>>>>>>>>>>                                    
44338>>>>>>>>>>>>>>>    Property Integer    piMustConstrain Public  0
44340>>>>>>>>>>>>>>>    Property Integer    piYear          Public  0
44342>>>>>>>>>>>>>>>    Property String     psCompany       Public ''
44344>>>>>>>>>>>>>>>    Property String     psBranch        Public ''
44346>>>>>>>>>>>>>>>    Property String     psWapokat       Public ''
44348>>>>>>>>>>>>>>>    
44348>>>>>>>>>>>>>>>    //AB-StoreTopEnd
44348>>>>>>>>>>>>>>>
44348>>>>>>>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
44349>>>>>>>>>>>>>>>    Set Size to 148 355
44350>>>>>>>>>>>>>>>    Set Location to 8 21
44351>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44352>>>>>>>>>>>>>>>    Set Modal_State to FALSE
44353>>>>>>>>>>>>>>>
44353>>>>>>>>>>>>>>>    //AB-DDOStart
44353>>>>>>>>>>>>>>>
44353>>>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
44355>>>>>>>>>>>>>>>    End_Object    // Wapokat_DD
44356>>>>>>>>>>>>>>>
44356>>>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
44358>>>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
44359>>>>>>>>>>>>>>>    End_Object    // Wapomast_DD
44360>>>>>>>>>>>>>>>
44360>>>>>>>>>>>>>>>    Object Wax_DD is a Wax_DataDictionary
44362>>>>>>>>>>>>>>>        Set DDO_Server to (Wapomast_DD(self))
44363>>>>>>>>>>>>>>>
44363>>>>>>>>>>>>>>>        //AB-StoreStart
44363>>>>>>>>>>>>>>>        
44363>>>>>>>>>>>>>>>        Begin_Constraints
44365>>>>>>>>>>>>>>>            Integer iMustConstrain iYear
44366>>>>>>>>>>>>>>>            String  sCompany sBranch sWapokat
44366>>>>>>>>>>>>>>>            Get piMustConstrain to iMustConstrain
44367>>>>>>>>>>>>>>>            If (iMustConstrain) Begin
44369>>>>>>>>>>>>>>>                Get piYear     to  iYear
44370>>>>>>>>>>>>>>>                Get psCompany  to  sCompany
44371>>>>>>>>>>>>>>>                Get psBranch   to  sBranch
44372>>>>>>>>>>>>>>>                Get psWapokat  to  sWapokat
44373>>>>>>>>>>>>>>>                If (sCompany<>'') Begin
44375>>>>>>>>>>>>>>>                    Constrain Wax.Company_Code eq sCompany
44377>>>>>>>>>>>>>>>                    If (sBranch<>'') Begin
44379>>>>>>>>>>>>>>>                        Constrain Wax.Branch_Code eq sBranch
44381>>>>>>>>>>>>>>>                        If (iYear<>0) Begin
44383>>>>>>>>>>>>>>>                            Constrain Wax.Year_Year eq iYear
44385>>>>>>>>>>>>>>>                            If (sWapokat<>'') Begin
44387>>>>>>>>>>>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
44389>>>>>>>>>>>>>>>                            End
44389>>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>                        End
44389>>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>                    End
44389>>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>                End
44389>>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>            End
44389>>>>>>>>>>>>>>>>
44389>>>>>>>>>>>>>>>        End_Constraints
44392>>>>>>>>>>>>>>>        
44392>>>>>>>>>>>>>>>        
44392>>>>>>>>>>>>>>>        
44392>>>>>>>>>>>>>>>        
44392>>>>>>>>>>>>>>>        
44392>>>>>>>>>>>>>>>        
44392>>>>>>>>>>>>>>>        //AB-StoreEnd
44392>>>>>>>>>>>>>>>
44392>>>>>>>>>>>>>>>    End_Object    // Wax_DD
44393>>>>>>>>>>>>>>>
44393>>>>>>>>>>>>>>>    Set Main_DD to (Wax_DD(self))
44394>>>>>>>>>>>>>>>    Set Server to (Wax_DD(self))
44395>>>>>>>>>>>>>>>
44395>>>>>>>>>>>>>>>    //AB-DDOEnd
44395>>>>>>>>>>>>>>>
44395>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
44397>>>>>>>>>>>>>>>        Set Main_File to Wax.File_Number
44398>>>>>>>>>>>>>>>        Set Size to 105 340
44399>>>>>>>>>>>>>>>        Set Location to 5 6
44400>>>>>>>>>>>>>>>
44400>>>>>>>>>>>>>>>        Begin_Row
44403>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_recr
44404>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_code
44405>>>>>>>>>>>>>>>            Entry_Item Wax.Wax_descr
44406>>>>>>>>>>>>>>>        End_Row
44411>>>>>>>>>>>>>>>
44411>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 33
44412>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "Recr"
44413>>>>>>>>>>>>>>>        
44413>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 80
44414>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
44415>>>>>>>>>>>>>>>        
44415>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 219
44416>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
44417>>>>>>>>>>>>>>>        
44417>>>>>>>>>>>>>>>
44417>>>>>>>>>>>>>>>        //AB-StoreStart
44417>>>>>>>>>>>>>>>        
44417>>>>>>>>>>>>>>>        Procedure Activate
44419>>>>>>>>>>>>>>>            Send Rebuild_Constraints to Wax_DD
44420>>>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
44421>>>>>>>>>>>>>>>            Forward Send Activate
44423>>>>>>>>>>>>>>>        End_procedure
44424>>>>>>>>>>>>>>>        
44424>>>>>>>>>>>>>>>        //AB-StoreEnd
44424>>>>>>>>>>>>>>>
44424>>>>>>>>>>>>>>>    End_Object    // oSelList
44425>>>>>>>>>>>>>>>
44425>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44427>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
44428>>>>>>>>>>>>>>>        Set Location to 113 186
44429>>>>>>>>>>>>>>>
44429>>>>>>>>>>>>>>>        //AB-StoreStart
44429>>>>>>>>>>>>>>>        Procedure OnClick
44431>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44432>>>>>>>>>>>>>>>        End_Procedure
44433>>>>>>>>>>>>>>>        //AB-StoreEnd
44433>>>>>>>>>>>>>>>
44433>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44434>>>>>>>>>>>>>>>
44434>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44436>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44437>>>>>>>>>>>>>>>        Set Location to 113 241
44438>>>>>>>>>>>>>>>
44438>>>>>>>>>>>>>>>        //AB-StoreStart
44438>>>>>>>>>>>>>>>        Procedure OnClick
44440>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44441>>>>>>>>>>>>>>>        End_Procedure
44442>>>>>>>>>>>>>>>        //AB-StoreEnd
44442>>>>>>>>>>>>>>>
44442>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44443>>>>>>>>>>>>>>>
44443>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44445>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44446>>>>>>>>>>>>>>>        Set Location to 113 296
44447>>>>>>>>>>>>>>>
44447>>>>>>>>>>>>>>>        //AB-StoreStart
44447>>>>>>>>>>>>>>>        Procedure OnClick
44449>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44450>>>>>>>>>>>>>>>        End_Procedure
44451>>>>>>>>>>>>>>>        //AB-StoreEnd
44451>>>>>>>>>>>>>>>
44451>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44452>>>>>>>>>>>>>>>
44452>>>>>>>>>>>>>>>
44452>>>>>>>>>>>>>>>    //AB-StoreStart
44452>>>>>>>>>>>>>>>                                    
44452>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44453>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44454>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44455>>>>>>>>>>>>>>>    
44455>>>>>>>>>>>>>>>    
44455>>>>>>>>>>>>>>>    
44455>>>>>>>>>>>>>>>    
44455>>>>>>>>>>>>>>>    
44455>>>>>>>>>>>>>>>    
44455>>>>>>>>>>>>>>>    //AB-StoreEnd
44455>>>>>>>>>>>>>>>
44455>>>>>>>>>>>>>>>End_Object    // Wax
44456>>>>>>>>>>>>>>>
44456>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44456>>>>>>>>>>>>>
44456>>>>>>>>>>>>>//DDB-Selection-pkg-End
44456>>>>>>>>>>>>>//DDB-FileEnd
44456>>>>>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
44456>>>>>>>>>>>>>//DDB-FileStart
44456>>>>>>>>>>>>>//DDB-HeaderStart
44456>>>>>>>>>>>>>
44456>>>>>>>>>>>>>// File Name : UNITS.DD
44456>>>>>>>>>>>>>// Class Name: Units_DataDictionary
44456>>>>>>>>>>>>>// Revision  : 17
44456>>>>>>>>>>>>>// Version   : 2
44456>>>>>>>>>>>>>
44456>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44456>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44456>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44456>>>>>>>>>>>>>
44456>>>>>>>>>>>>>Open Units
44458>>>>>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
44460>>>>>>>>>>>>>Open Sysrecw
44462>>>>>>>>>>>>>Open Syscurxr
44464>>>>>>>>>>>>>
44464>>>>>>>>>>>>>//DDB-HeaderEnd
44464>>>>>>>>>>>>>//DDB-SelectionStart
44464>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
44464>>>>>>>>>>>>>Register_Object sl025
44464>>>>>>>>>>>>>//DDB-SelectionEnd
44464>>>>>>>>>>>>>
44464>>>>>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
44465>>>>>>>>>>>>>
44465>>>>>>>>>>>>>    Procedure Save_Main_File
44466>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
44468>>>>>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
44471>>>>>>>>>>>>>        End
44471>>>>>>>>>>>>>>
44471>>>>>>>>>>>>>        Forward Send Save_Main_File
44473>>>>>>>>>>>>>    End_Procedure
44474>>>>>>>>>>>>>
44474>>>>>>>>>>>>>
44474>>>>>>>>>>>>>     Procedure Creating
44475>>>>>>>>>>>>>        Forward Send Creating
44477>>>>>>>>>>>>>        // Insert Code Here
44477>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
44478>>>>>>>>>>>>>    End_Procedure   // Creating
44479>>>>>>>>>>>>>
44479>>>>>>>>>>>>>
44479>>>>>>>>>>>>>
44479>>>>>>>>>>>>>    // Define_Fields:
44479>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44479>>>>>>>>>>>>>
44479>>>>>>>>>>>>>    Procedure Define_Fields
44480>>>>>>>>>>>>>        Forward Send Define_Fields
44482>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44482>>>>>>>>>>>>>        //DDB-DefineFieldStart
44482>>>>>>>>>>>>>
44482>>>>>>>>>>>>>        Set Main_File            To Units.File_Number
44483>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44484>>>>>>>>>>>>>
44484>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44485>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44486>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44487>>>>>>>>>>>>>
44487>>>>>>>>>>>>>        // Child (Client) file structure................
44487>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
44488>>>>>>>>>>>>>
44488>>>>>>>>>>>>>        // External (System) file structure.............
44488>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44489>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44490>>>>>>>>>>>>>
44490>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
44493>>>>>>>>>>>>>
44493>>>>>>>>>>>>>        // Field-based properties.......................
44493>>>>>>>>>>>>>
44493>>>>>>>>>>>>>        // Units.Units_Code
44493>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
44494>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
44495>>>>>>>>>>>>>
44495>>>>>>>>>>>>>        // Units.Units_Rec0
44495>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
44496>>>>>>>>>>>>>
44496>>>>>>>>>>>>>        // Units.Units_Descr
44496>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
44497>>>>>>>>>>>>>
44497>>>>>>>>>>>>>        // Units.Units_Recr
44497>>>>>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
44498>>>>>>>>>>>>>
44498>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44498>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44499>>>>>>>>>>>>>
44499>>>>>>>>>>>>>    // Field_Defaults:
44499>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44499>>>>>>>>>>>>>
44499>>>>>>>>>>>>>    Procedure Field_Defaults
44500>>>>>>>>>>>>>        Forward Send Field_Defaults
44502>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44502>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44502>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44502>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44503>>>>>>>>>>>>>
44503>>>>>>>>>>>>>End_Class    // Units_DataDictionary
44504>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44504>>>>>>>>>>>>>
44504>>>>>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
44504>>>>>>>>>>>>>>>//AB/ Project sl025
44504>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44504>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
44504>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
44504>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>// Project Object Structure
44504>>>>>>>>>>>>>>>//   sl025 is a dbModalPanelSub
44504>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
44504>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44504>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44504>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44504>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>// Register all objects
44504>>>>>>>>>>>>>>>Register_Object oCancel_bn
44504>>>>>>>>>>>>>>>Register_Object oOK_bn
44504>>>>>>>>>>>>>>>Register_Object oSearch_bn
44504>>>>>>>>>>>>>>>Register_Object oSelList
44504>>>>>>>>>>>>>>>Register_Object sl025
44504>>>>>>>>>>>>>>>Register_Object Units_DD
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>//AB-IgnoreStart
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>Use DFAllEnt.pkg
44504>>>>>>>>>>>>>>>Use dbList.Sub
44504>>>>>>>>>>>>>>>Use Button.Sub
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>Use UNITS.DD
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>//AB-IgnoreEnd
44504>>>>>>>>>>>>>>>
44504>>>>>>>>>>>>>>>Object sl025 is a dbModalPanelSub
44506>>>>>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
44507>>>>>>>>>>>>>>>    Set Size to 148 297
44508>>>>>>>>>>>>>>>    Set Location to 4 5
44509>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44510>>>>>>>>>>>>>>>    Set Modal_State to FALSE
44511>>>>>>>>>>>>>>>
44511>>>>>>>>>>>>>>>    //AB-DDOStart
44511>>>>>>>>>>>>>>>
44511>>>>>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
44513>>>>>>>>>>>>>>>    End_Object    // Units_DD
44514>>>>>>>>>>>>>>>
44514>>>>>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
44515>>>>>>>>>>>>>>>    Set Server to (Units_DD(self))
44516>>>>>>>>>>>>>>>
44516>>>>>>>>>>>>>>>    //AB-DDOEnd
44516>>>>>>>>>>>>>>>
44516>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
44518>>>>>>>>>>>>>>>        set main_file to units.file_number 
44519>>>>>>>>>>>>>>>        Set Size to 105 280
44520>>>>>>>>>>>>>>>        Set Location to 6 6
44521>>>>>>>>>>>>>>>
44521>>>>>>>>>>>>>>>        Begin_Row
44524>>>>>>>>>>>>>>>            entry_item units.units_code 
44525>>>>>>>>>>>>>>>            entry_item units.units_descr 
44526>>>>>>>>>>>>>>>        End_Row
44531>>>>>>>>>>>>>>>
44531>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 91
44532>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
44533>>>>>>>>>>>>>>>        
44533>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 180
44534>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
44535>>>>>>>>>>>>>>>        
44535>>>>>>>>>>>>>>>    End_Object    // oSelList
44536>>>>>>>>>>>>>>>
44536>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44538>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
44539>>>>>>>>>>>>>>>        Set Location to 115 126
44540>>>>>>>>>>>>>>>
44540>>>>>>>>>>>>>>>        //AB-StoreStart
44540>>>>>>>>>>>>>>>        Procedure OnClick
44542>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44543>>>>>>>>>>>>>>>        End_Procedure
44544>>>>>>>>>>>>>>>        //AB-StoreEnd
44544>>>>>>>>>>>>>>>
44544>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44545>>>>>>>>>>>>>>>
44545>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44547>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
44548>>>>>>>>>>>>>>>        Set Location to 115 181
44549>>>>>>>>>>>>>>>
44549>>>>>>>>>>>>>>>        //AB-StoreStart
44549>>>>>>>>>>>>>>>        Procedure OnClick
44551>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44552>>>>>>>>>>>>>>>        End_Procedure
44553>>>>>>>>>>>>>>>        //AB-StoreEnd
44553>>>>>>>>>>>>>>>
44553>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44554>>>>>>>>>>>>>>>
44554>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44556>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
44557>>>>>>>>>>>>>>>        Set Location to 115 236
44558>>>>>>>>>>>>>>>
44558>>>>>>>>>>>>>>>        //AB-StoreStart
44558>>>>>>>>>>>>>>>        Procedure OnClick
44560>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44561>>>>>>>>>>>>>>>        End_Procedure
44562>>>>>>>>>>>>>>>        //AB-StoreEnd
44562>>>>>>>>>>>>>>>
44562>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44563>>>>>>>>>>>>>>>
44563>>>>>>>>>>>>>>>
44563>>>>>>>>>>>>>>>    //AB-StoreStart
44563>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44564>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44565>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44566>>>>>>>>>>>>>>>    //AB-StoreEnd
44566>>>>>>>>>>>>>>>
44566>>>>>>>>>>>>>>>End_Object    // sl025
44567>>>>>>>>>>>>>>>
44567>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44567>>>>>>>>>>>>>
44567>>>>>>>>>>>>>//DDB-Selection-pkg-End
44567>>>>>>>>>>>>>//DDB-FileEnd
44567>>>>>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
44567>>>>>>>>>>>>>//DDB-FileStart
44567>>>>>>>>>>>>>//DDB-HeaderStart
44567>>>>>>>>>>>>>
44567>>>>>>>>>>>>>// File Name : WITEMKAT.DD
44567>>>>>>>>>>>>>// Class Name: Witemkat_DataDictionary
44567>>>>>>>>>>>>>// Revision  : 26
44567>>>>>>>>>>>>>
44567>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44567>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44567>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44567>>>>>>>>>>>>>
44567>>>>>>>>>>>>>Open Witemkat
44569>>>>>>>>>>>>>Open Item
44571>>>>>>>>>>>>>Open Sysrecw
44573>>>>>>>>>>>>>Open Syscurxr
44575>>>>>>>>>>>>>
44575>>>>>>>>>>>>>//DDB-HeaderEnd
44575>>>>>>>>>>>>>//DDB-SelectionStart
44575>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
44575>>>>>>>>>>>>>Register_Object sl024
44575>>>>>>>>>>>>>//DDB-SelectionEnd
44575>>>>>>>>>>>>>
44575>>>>>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
44576>>>>>>>>>>>>>
44576>>>>>>>>>>>>>     Procedure Creating
44577>>>>>>>>>>>>>        Forward Send Creating
44579>>>>>>>>>>>>>        // Insert Code Here
44579>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
44580>>>>>>>>>>>>>    End_Procedure   // Creating
44581>>>>>>>>>>>>>   
44581>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
44582>>>>>>>>>>>>>        Local Integer iReturnVal icheck
44583>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
44585>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
44587>>>>>>>>>>>>>            // Insert Code Here
44587>>>>>>>>>>>>>//           if (witemkat.codegl <> '') begin
44587>>>>>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
44587>>>>>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
44587>>>>>>>>>>>>>//           end
44587>>>>>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44590>>>>>>>>>>>>>        End
44590>>>>>>>>>>>>>>
44590>>>>>>>>>>>>>        Function_Return iReturnVal
44591>>>>>>>>>>>>>    End_Function   // Validate_Save
44592>>>>>>>>>>>>> 
44592>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
44593>>>>>>>>>>>>>        String lsError_Message
44594>>>>>>>>>>>>>        Case Begin
44594>>>>>>>>>>>>>            Case (iError_Num = 24001)
44596>>>>>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
44597>>>>>>>>>>>>>              Case Break
44598>>>>>>>>>>>>>            Case Else
44598>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
44600>>>>>>>>>>>>>        Case End
44600>>>>>>>>>>>>>        Error iError_Num lsError_Message
44601>>>>>>>>>>>>>>
44601>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
44602>>>>>>>>>>>>>
44602>>>>>>>>>>>>>
44602>>>>>>>>>>>>>
44602>>>>>>>>>>>>>    // Define_Fields:
44602>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44602>>>>>>>>>>>>>
44602>>>>>>>>>>>>>    Procedure Define_Fields
44603>>>>>>>>>>>>>        Forward Send Define_Fields
44605>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44605>>>>>>>>>>>>>        //DDB-DefineFieldStart
44605>>>>>>>>>>>>>
44605>>>>>>>>>>>>>        Set Main_File            To Witemkat.File_Number
44606>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44607>>>>>>>>>>>>>
44607>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44608>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44609>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44610>>>>>>>>>>>>>
44610>>>>>>>>>>>>>        // Child (Client) file structure................
44610>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
44611>>>>>>>>>>>>>
44611>>>>>>>>>>>>>        // External (System) file structure.............
44611>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
44612>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
44613>>>>>>>>>>>>>
44613>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
44616>>>>>>>>>>>>>
44616>>>>>>>>>>>>>        // Field-based properties.......................
44616>>>>>>>>>>>>>
44616>>>>>>>>>>>>>        // Witemkat.Witemkat_Code  
44616>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code   To DD_AUTOFIND   
44617>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code   To (sl024(Self))
44618>>>>>>>>>>>>>
44618>>>>>>>>>>>>>        // Witemkat.Witemkat_Rec0  
44618>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0   To DD_AUTOFIND   
44619>>>>>>>>>>>>>
44619>>>>>>>>>>>>>        // Witemkat.Witemkat_Descr 
44619>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr  To (sl024(Self))
44620>>>>>>>>>>>>>
44620>>>>>>>>>>>>>        // Witemkat.Witemkat_Recr  
44620>>>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr   To DD_AUTOFIND   
44621>>>>>>>>>>>>>
44621>>>>>>>>>>>>>        // Witemkat.Codeglpol      
44621>>>>>>>>>>>>>
44621>>>>>>>>>>>>>        // Witemkat.Codeglago      
44621>>>>>>>>>>>>>
44621>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44621>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44622>>>>>>>>>>>>>
44622>>>>>>>>>>>>>    // Field_Defaults:
44622>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44622>>>>>>>>>>>>>
44622>>>>>>>>>>>>>    Procedure Field_Defaults
44623>>>>>>>>>>>>>        Forward Send Field_Defaults
44625>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44625>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44625>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44625>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44626>>>>>>>>>>>>>
44626>>>>>>>>>>>>>End_Class    // Witemkat_DataDictionary
44627>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44627>>>>>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
44627>>>>>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
44627>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44627>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
44627>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>// Project Object Structure
44627>>>>>>>>>>>>>>>//   sl024 is a dbModalPanelSub
44627>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
44627>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44627>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44627>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44627>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>// Register all objects
44627>>>>>>>>>>>>>>>Register_Object oCancel_bn
44627>>>>>>>>>>>>>>>Register_Object oOK_bn
44627>>>>>>>>>>>>>>>Register_Object oSearch_bn
44627>>>>>>>>>>>>>>>Register_Object oSelList
44627>>>>>>>>>>>>>>>Register_Object sl024
44627>>>>>>>>>>>>>>>Register_Object Witemkat_DD
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>//AB-IgnoreStart
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>Use DFAllEnt.pkg
44627>>>>>>>>>>>>>>>Use dbList.Sub
44627>>>>>>>>>>>>>>>Use Button.Sub
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>Use WITEMKAT.DD
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>//AB-IgnoreEnd
44627>>>>>>>>>>>>>>>
44627>>>>>>>>>>>>>>>Object sl024 is a dbModalPanelSub
44629>>>>>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
44630>>>>>>>>>>>>>>>    Set Size to 217 375
44631>>>>>>>>>>>>>>>    Set Location to 4 5
44632>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44633>>>>>>>>>>>>>>>    Set Modal_State to FALSE
44634>>>>>>>>>>>>>>>
44634>>>>>>>>>>>>>>>    //AB-DDOStart
44634>>>>>>>>>>>>>>>
44634>>>>>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
44636>>>>>>>>>>>>>>>    End_Object    // Witemkat_DD
44637>>>>>>>>>>>>>>>
44637>>>>>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
44638>>>>>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
44639>>>>>>>>>>>>>>>
44639>>>>>>>>>>>>>>>    //AB-DDOEnd
44639>>>>>>>>>>>>>>>
44639>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
44641>>>>>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
44642>>>>>>>>>>>>>>>        Set Size to 175 357
44643>>>>>>>>>>>>>>>        Set Location to 6 6
44644>>>>>>>>>>>>>>>
44644>>>>>>>>>>>>>>>        Begin_Row
44647>>>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
44648>>>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
44649>>>>>>>>>>>>>>>        End_Row
44654>>>>>>>>>>>>>>>
44654>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 124
44655>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
44656>>>>>>>>>>>>>>>        
44656>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 223
44657>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
44658>>>>>>>>>>>>>>>        
44658>>>>>>>>>>>>>>>    End_Object    // oSelList
44659>>>>>>>>>>>>>>>
44659>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44661>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
44662>>>>>>>>>>>>>>>        Set Location to 186 210
44663>>>>>>>>>>>>>>>
44663>>>>>>>>>>>>>>>        //AB-StoreStart
44663>>>>>>>>>>>>>>>        Procedure OnClick
44665>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44666>>>>>>>>>>>>>>>        End_Procedure
44667>>>>>>>>>>>>>>>        //AB-StoreEnd
44667>>>>>>>>>>>>>>>
44667>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44668>>>>>>>>>>>>>>>
44668>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44670>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
44671>>>>>>>>>>>>>>>        Set Location to 186 265
44672>>>>>>>>>>>>>>>
44672>>>>>>>>>>>>>>>        //AB-StoreStart
44672>>>>>>>>>>>>>>>        Procedure OnClick
44674>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44675>>>>>>>>>>>>>>>        End_Procedure
44676>>>>>>>>>>>>>>>        //AB-StoreEnd
44676>>>>>>>>>>>>>>>
44676>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44677>>>>>>>>>>>>>>>
44677>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44679>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
44680>>>>>>>>>>>>>>>        Set Location to 186 320
44681>>>>>>>>>>>>>>>
44681>>>>>>>>>>>>>>>        //AB-StoreStart
44681>>>>>>>>>>>>>>>        Procedure OnClick
44683>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44684>>>>>>>>>>>>>>>        End_Procedure
44685>>>>>>>>>>>>>>>        //AB-StoreEnd
44685>>>>>>>>>>>>>>>
44685>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44686>>>>>>>>>>>>>>>
44686>>>>>>>>>>>>>>>
44686>>>>>>>>>>>>>>>    //AB-StoreStart
44686>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44687>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44688>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44689>>>>>>>>>>>>>>>    //AB-StoreEnd
44689>>>>>>>>>>>>>>>
44689>>>>>>>>>>>>>>>End_Object    // sl024
44690>>>>>>>>>>>>>>>
44690>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44690>>>>>>>>>>>>>//DDB-Selection-pkg-End
44690>>>>>>>>>>>>>//DDB-FileEnd
44690>>>>>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
44690>>>>>>>>>>>>>//DDB-FileStart
44690>>>>>>>>>>>>>//DDB-HeaderStart
44690>>>>>>>>>>>>>
44690>>>>>>>>>>>>>// File Name : FPA.DD
44690>>>>>>>>>>>>>// Class Name: Fpa_DataDictionary
44690>>>>>>>>>>>>>// Revision  : 34
44690>>>>>>>>>>>>>// Version   : 2
44690>>>>>>>>>>>>>
44690>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44690>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44690>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44690>>>>>>>>>>>>>
44690>>>>>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
44692>>>>>>>>>>>>>Open Iteml
44694>>>>>>>>>>>>>Open Partlfpa
44696>>>>>>>>>>>>>Open Item
44698>>>>>>>>>>>>>
44698>>>>>>>>>>>>>//DDB-HeaderEnd
44698>>>>>>>>>>>>>//DDB-SelectionStart
44698>>>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
44698>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
44698>>>>>>>>>>>>>Register_Object Fpa
44698>>>>>>>>>>>>>Register_Object sl150
44698>>>>>>>>>>>>>//DDB-SelectionEnd
44698>>>>>>>>>>>>>
44698>>>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
44699>>>>>>>>>>>>> 
44699>>>>>>>>>>>>>    // Validate_Save:
44699>>>>>>>>>>>>> 
44699>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
44700>>>>>>>>>>>>>        Local Integer iReturnVal icheck
44701>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
44703>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
44705>>>>>>>>>>>>>            // Insert Code Here
44705>>>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
44705>>>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
44705>>>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
44705>>>>>>>>>>>>>         //  end
44705>>>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
44705>>>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
44705>>>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
44705>>>>>>>>>>>>>         //  end   
44705>>>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
44705>>>>>>>>>>>>>        End
44705>>>>>>>>>>>>>>
44705>>>>>>>>>>>>>        Function_Return iReturnVal
44706>>>>>>>>>>>>>    End_Function   // Validate_Save
44707>>>>>>>>>>>>> 
44707>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
44708>>>>>>>>>>>>>        String lsError_Message
44709>>>>>>>>>>>>>        Case Begin
44709>>>>>>>>>>>>>            Case (iError_Num = 104001)
44711>>>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
44712>>>>>>>>>>>>>              Case Break
44713>>>>>>>>>>>>>            Case (iError_Num = 104002)
44716>>>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
44717>>>>>>>>>>>>>              Case Break
44718>>>>>>>>>>>>>            Case Else
44718>>>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
44720>>>>>>>>>>>>>        Case End
44720>>>>>>>>>>>>>        Error iError_Num lsError_Message
44721>>>>>>>>>>>>>>
44721>>>>>>>>>>>>>    End_Procedure // operation_not_allowed
44722>>>>>>>>>>>>>
44722>>>>>>>>>>>>>    // Define_Fields:
44722>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
44722>>>>>>>>>>>>>
44722>>>>>>>>>>>>>    Procedure Define_Fields
44723>>>>>>>>>>>>>        Forward Send Define_Fields
44725>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44725>>>>>>>>>>>>>        //DDB-DefineFieldStart
44725>>>>>>>>>>>>>
44725>>>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
44726>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
44727>>>>>>>>>>>>>
44727>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
44728>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
44729>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44730>>>>>>>>>>>>>
44730>>>>>>>>>>>>>        // Child (Client) file structure................
44730>>>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
44731>>>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
44732>>>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
44733>>>>>>>>>>>>>
44733>>>>>>>>>>>>>        // Field-based properties.......................
44733>>>>>>>>>>>>>
44733>>>>>>>>>>>>>        // Fpa.Fpa_Pososto
44733>>>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
44734>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
44735>>>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
44736>>>>>>>>>>>>>
44736>>>>>>>>>>>>>        // Fpa.Fpa_Descr
44736>>>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
44737>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
44738>>>>>>>>>>>>>
44738>>>>>>>>>>>>>        // Fpa.Agora_Codegl
44738>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
44739>>>>>>>>>>>>>
44739>>>>>>>>>>>>>        // Fpa.Polhsh_Codegl
44739>>>>>>>>>>>>>
44739>>>>>>>>>>>>>        //DDB-DefineFieldEnd
44739>>>>>>>>>>>>>    End_Procedure    // Define_Fields
44740>>>>>>>>>>>>>
44740>>>>>>>>>>>>>    // Field_Defaults:
44740>>>>>>>>>>>>>    // This procedure is used to establish default field values.
44740>>>>>>>>>>>>>
44740>>>>>>>>>>>>>    Procedure Field_Defaults
44741>>>>>>>>>>>>>        Forward Send Field_Defaults
44743>>>>>>>>>>>>>        //DDB-Generated-Code-Location
44743>>>>>>>>>>>>>        //DDB-FieldDefaultStart
44743>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
44743>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
44744>>>>>>>>>>>>>
44744>>>>>>>>>>>>>End_Class    // Fpa_DataDictionary
44745>>>>>>>>>>>>>//DDB-Selection-pkg-Start
44745>>>>>>>>>>>>>
44745>>>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
44745>>>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
44745>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
44745>>>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
44745>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>// Project Object Structure
44745>>>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
44745>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
44745>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44745>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
44745>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
44745>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>// Register all objects
44745>>>>>>>>>>>>>>>Register_Object Fpa
44745>>>>>>>>>>>>>>>Register_Object Fpa_DD
44745>>>>>>>>>>>>>>>Register_Object oCancel_bn
44745>>>>>>>>>>>>>>>Register_Object oOK_bn
44745>>>>>>>>>>>>>>>Register_Object oSearch_bn
44745>>>>>>>>>>>>>>>Register_Object oSelList
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>//AB-IgnoreStart
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>Use DFAllEnt.pkg
44745>>>>>>>>>>>>>>>Use dbList.Sub
44745>>>>>>>>>>>>>>>Use Button.Sub
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>Use FPA.DD
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>//AB-IgnoreEnd
44745>>>>>>>>>>>>>>>
44745>>>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
44764>>>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
44765>>>>>>>>>>>>>>>    Set Size to 148 181
44766>>>>>>>>>>>>>>>    Set Location to 4 5
44767>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
44768>>>>>>>>>>>>>>>    Set Modal_State to FALSE
44769>>>>>>>>>>>>>>>
44769>>>>>>>>>>>>>>>    //AB-DDOStart
44769>>>>>>>>>>>>>>>
44769>>>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
44771>>>>>>>>>>>>>>>    End_Object    // Fpa_DD
44772>>>>>>>>>>>>>>>
44772>>>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
44773>>>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
44774>>>>>>>>>>>>>>>
44774>>>>>>>>>>>>>>>    //AB-DDOEnd
44774>>>>>>>>>>>>>>>
44774>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
44776>>>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
44777>>>>>>>>>>>>>>>        Set Size to 105 165
44778>>>>>>>>>>>>>>>        Set Location to 6 6
44779>>>>>>>>>>>>>>>
44779>>>>>>>>>>>>>>>        Begin_Row
44782>>>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
44783>>>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
44784>>>>>>>>>>>>>>>        End_Row
44789>>>>>>>>>>>>>>>
44789>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
44790>>>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
44791>>>>>>>>>>>>>>>        
44791>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
44792>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
44793>>>>>>>>>>>>>>>        
44793>>>>>>>>>>>>>>>    End_Object    // oSelList
44794>>>>>>>>>>>>>>>
44794>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
44796>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
44797>>>>>>>>>>>>>>>        Set Size to 14 46
44798>>>>>>>>>>>>>>>        Set Location to 113 26
44799>>>>>>>>>>>>>>>
44799>>>>>>>>>>>>>>>        //AB-StoreStart
44799>>>>>>>>>>>>>>>        Procedure OnClick
44801>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
44802>>>>>>>>>>>>>>>        End_Procedure
44803>>>>>>>>>>>>>>>        //AB-StoreEnd
44803>>>>>>>>>>>>>>>
44803>>>>>>>>>>>>>>>    End_Object    // oOK_bn
44804>>>>>>>>>>>>>>>
44804>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
44806>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
44807>>>>>>>>>>>>>>>        Set Size to 14 46
44808>>>>>>>>>>>>>>>        Set Location to 113 75
44809>>>>>>>>>>>>>>>
44809>>>>>>>>>>>>>>>        //AB-StoreStart
44809>>>>>>>>>>>>>>>        Procedure OnClick
44811>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
44812>>>>>>>>>>>>>>>        End_Procedure
44813>>>>>>>>>>>>>>>        //AB-StoreEnd
44813>>>>>>>>>>>>>>>
44813>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
44814>>>>>>>>>>>>>>>
44814>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
44816>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
44817>>>>>>>>>>>>>>>        Set Size to 14 46
44818>>>>>>>>>>>>>>>        Set Location to 113 126
44819>>>>>>>>>>>>>>>
44819>>>>>>>>>>>>>>>        //AB-StoreStart
44819>>>>>>>>>>>>>>>        Procedure OnClick
44821>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
44822>>>>>>>>>>>>>>>        End_Procedure
44823>>>>>>>>>>>>>>>        //AB-StoreEnd
44823>>>>>>>>>>>>>>>
44823>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
44824>>>>>>>>>>>>>>>
44824>>>>>>>>>>>>>>>
44824>>>>>>>>>>>>>>>    //AB-StoreStart
44824>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
44825>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
44826>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
44827>>>>>>>>>>>>>>>    //AB-StoreEnd
44827>>>>>>>>>>>>>>>
44827>>>>>>>>>>>>>>>CD_End_Object    // Fpa
44829>>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>//AB/ End_Object    // prj
44829>>>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
44829>>>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
44829>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
44829>>>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
44829>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>// Project Object Structure
44829>>>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
44829>>>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
44829>>>>>>>>>>>>>>>//     oSelList is a dbListSub
44829>>>>>>>>>>>>>>>//     oOK_bn is a Button
44829>>>>>>>>>>>>>>>//     oCancel_bn is a Button
44829>>>>>>>>>>>>>>>//     oSearch_bn is a Button
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>// Register all objects
44829>>>>>>>>>>>>>>>Register_Object Gplan_DD
44829>>>>>>>>>>>>>>>Register_Object oCancel_bn
44829>>>>>>>>>>>>>>>Register_Object oOK_bn
44829>>>>>>>>>>>>>>>Register_Object oSearch_bn
44829>>>>>>>>>>>>>>>Register_Object oSelList
44829>>>>>>>>>>>>>>>Register_Object sl150
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>    //AB-IgnoreStart
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
44829>>>>>>>>>>>>>>>    Use dbList.Sub
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
44829>>>>>>>>>>>>>>>>>//DDB-FileStart
44829>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44829>>>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>>>// File Name : GPLAN.DD
44829>>>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
44829>>>>>>>>>>>>>>>>>// Revision  : 132
44829>>>>>>>>>>>>>>>>>// Version   : 2
44829>>>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44829>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44829>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44829>>>>>>>>>>>>>>>>>
44829>>>>>>>>>>>>>>>>>Open Gplan
44831>>>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
44833>>>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
44835>>>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
44837>>>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
44839>>>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
44841>>>>>>>>>>>>>>>>>Open Sysrecg
44843>>>>>>>>>>>>>>>>>Open Syscurgl
44845>>>>>>>>>>>>>>>>>
44845>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44845>>>>>>>>>>>>>>>>>//DDB-ValidationStart
44845>>>>>>>>>>>>>>>>>
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
44845>>>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
44845>>>>>>>>>>>>>>>>>
44845>>>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
44847>>>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
44848>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44849>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44849>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44849>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
44850>>>>>>>>>>>>>>>>>
44850>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
44852>>>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
44853>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44853>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44853>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
44854>>>>>>>>>>>>>>>>>
44854>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
44856>>>>>>>>>>>>>>>>>
44856>>>>>>>>>>>>>>>>>    Procedure Fill_List
44858>>>>>>>>>>>>>>>>>        Forward Send Fill_List
44860>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
44861>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
44862>>>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
44863>>>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
44864>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44864>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44864>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
44865>>>>>>>>>>>>>>>>>
44865>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
44867>>>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
44868>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44869>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44869>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44869>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
44870>>>>>>>>>>>>>>>>>
44870>>>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
44872>>>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
44873>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44874>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44874>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44874>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
44875>>>>>>>>>>>>>>>>>
44875>>>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
44877>>>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
44878>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44879>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44879>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44879>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
44880>>>>>>>>>>>>>>>>>
44880>>>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
44882>>>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
44883>>>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
44884>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44884>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44884>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
44885>>>>>>>>>>>>>>>>>
44885>>>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
44887>>>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
44888>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
44888>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
44888>>>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
44889>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
44889>>>>>>>>>>>>>>>>>//DDB-SelectionStart
44889>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
44889>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
44889>>>>>>>>>>>>>>>>>Register_Object sl150
44889>>>>>>>>>>>>>>>>>Register_Object Gtypkin
44889>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
44889>>>>>>>>>>>>>>>>>Use arrays.Sub
44889>>>>>>>>>>>>>>>>>
44889>>>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
44889>>>>>>>>>>>>>>>>>>>//DDB-FileStart
44889>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
44889>>>>>>>>>>>>>>>>>>>
44889>>>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
44889>>>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
44889>>>>>>>>>>>>>>>>>>>// Revision  : 17
44889>>>>>>>>>>>>>>>>>>>// Version   : 2
44889>>>>>>>>>>>>>>>>>>>
44889>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
44889>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
44889>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
44889>>>>>>>>>>>>>>>>>>>
44889>>>>>>>>>>>>>>>>>>>Open Gmovea
44891>>>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
44893>>>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
44895>>>>>>>>>>>>>>>>>>>Open Gplan
44897>>>>>>>>>>>>>>>>>>>
44897>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
44897>>>>>>>>>>>>>>>>>>>
44897>>>>>>>>>>>>>>>>>>>//open master file
44897>>>>>>>>>>>>>>>>>>>Open Gmove
44899>>>>>>>>>>>>>>>>>>>
44899>>>>>>>>>>>>>>>>>>>//define alias-master condition
44899>>>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
44902>>>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
44905>>>>>>>>>>>>>>>>>>>
44905>>>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
44905>>>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
44906>>>>>>>>>>>>>>>>>>>>
44906>>>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
44907>>>>>>>>>>>>>>>>>>>>
44907>>>>>>>>>>>>>>>>>>>
44907>>>>>>>>>>>>>>>>>>>
44907>>>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
44908>>>>>>>>>>>>>>>>>>>
44908>>>>>>>>>>>>>>>>>>>
44908>>>>>>>>>>>>>>>>>>>      //private
44908>>>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
44908>>>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
44908>>>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
44909>>>>>>>>>>>>>>>>>>>                Case Begin
44909>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
44911>>>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
44912>>>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
44913>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
44914>>>>>>>>>>>>>>>>>>>                     Case Break
44915>>>>>>>>>>>>>>>>>>>
44915>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
44918>>>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
44919>>>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
44920>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
44921>>>>>>>>>>>>>>>>>>>                     Case Break
44922>>>>>>>>>>>>>>>>>>>
44922>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
44925>>>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
44926>>>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
44927>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
44928>>>>>>>>>>>>>>>>>>>                     Case Break
44929>>>>>>>>>>>>>>>>>>>
44929>>>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
44932>>>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
44933>>>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
44934>>>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
44935>>>>>>>>>>>>>>>>>>>                     Case Break
44936>>>>>>>>>>>>>>>>>>>                Case End
44936>>>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
44937>>>>>>>>>>>>>>>>>>>
44937>>>>>>>>>>>>>>>>>>>
44937>>>>>>>>>>>>>>>>>>>
44937>>>>>>>>>>>>>>>>>>>      //private
44937>>>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
44937>>>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
44937>>>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
44938>>>>>>>>>>>>>>>>>>>
44938>>>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
44938>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
44941>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
44944>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
44947>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
44950>>>>>>>>>>>>>>>>>>>
44950>>>>>>>>>>>>>>>>>>>                 Case Begin
44950>>>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
44950>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
44952>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
44955>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
44958>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
44961>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
44964>>>>>>>>>>>>>>>>>>>                      Case Break
44965>>>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
44965>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
44968>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
44971>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
44974>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
44977>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
44980>>>>>>>>>>>>>>>>>>>                      Case Break
44981>>>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
44981>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
44984>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
44987>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
44990>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
44993>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
44996>>>>>>>>>>>>>>>>>>>                      Case Break
44997>>>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
44997>>>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
45000>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
45003>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
45006>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
45009>>>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
45012>>>>>>>>>>>>>>>>>>>                      Case Break
45013>>>>>>>>>>>>>>>>>>>                 Case End
45013>>>>>>>>>>>>>>>>>>>
45013>>>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
45014>>>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
45015>>>>>>>>>>>>>>>>>>>
45015>>>>>>>>>>>>>>>>>>>    Procedure Update
45016>>>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
45017>>>>>>>>>>>>>>>>>>>    End_Procedure //update
45018>>>>>>>>>>>>>>>>>>>
45018>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
45019>>>>>>>>>>>>>>>>>>>              String lsError_Message
45020>>>>>>>>>>>>>>>>>>>              Case Begin
45020>>>>>>>>>>>>>>>>>>>                   //˜§æ validate save
45020>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
45022>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
45023>>>>>>>>>>>>>>>>>>>                   Case Break
45024>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
45027>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
45028>>>>>>>>>>>>>>>>>>>                   Case Break
45029>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
45032>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
45033>>>>>>>>>>>>>>>>>>>                   Case Break
45034>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
45037>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
45038>>>>>>>>>>>>>>>>>>>                   Case Break
45039>>>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
45039>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
45042>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
45043>>>>>>>>>>>>>>>>>>>                   Case Break
45044>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
45047>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
45048>>>>>>>>>>>>>>>>>>>                   Case Break
45049>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
45052>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
45053>>>>>>>>>>>>>>>>>>>                   Case Break
45054>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
45057>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45058>>>>>>>>>>>>>>>>>>>                   Case Break
45059>>>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
45059>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
45062>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
45063>>>>>>>>>>>>>>>>>>>                   Case Break
45064>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
45067>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45068>>>>>>>>>>>>>>>>>>>                   Case Break
45069>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
45072>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
45073>>>>>>>>>>>>>>>>>>>                   Case Break
45074>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
45077>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
45078>>>>>>>>>>>>>>>>>>>                   Case Break
45079>>>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
45079>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
45082>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
45083>>>>>>>>>>>>>>>>>>>                   Case Break
45084>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
45087>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45088>>>>>>>>>>>>>>>>>>>                   Case Break
45089>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
45092>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
45093>>>>>>>>>>>>>>>>>>>                   Case Break
45094>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
45097>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
45098>>>>>>>>>>>>>>>>>>>                   Case Break
45099>>>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
45099>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
45102>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
45103>>>>>>>>>>>>>>>>>>>                   Case Break
45104>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
45107>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
45108>>>>>>>>>>>>>>>>>>>                   Case Break
45109>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
45112>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
45113>>>>>>>>>>>>>>>>>>>                   Case Break
45114>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
45117>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
45118>>>>>>>>>>>>>>>>>>>                   Case Break
45119>>>>>>>>>>>>>>>>>>>
45119>>>>>>>>>>>>>>>>>>>
45119>>>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
45119>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
45122>>>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
45123>>>>>>>>>>>>>>>>>>>                   Case Break
45124>>>>>>>>>>>>>>>>>>>
45124>>>>>>>>>>>>>>>>>>>                   Case Else
45124>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
45126>>>>>>>>>>>>>>>>>>>              Case End
45126>>>>>>>>>>>>>>>>>>>
45126>>>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
45127>>>>>>>>>>>>>>>>>>>>
45127>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
45128>>>>>>>>>>>>>>>>>>>
45128>>>>>>>>>>>>>>>>>>>
45128>>>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
45129>>>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
45130>>>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
45132>>>>>>>>>>>>>>>>>>>
45132>>>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
45134>>>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
45134>>>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
45135>>>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
45138>>>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
45138>>>>>>>>>>>>>>>>>>>>
45138>>>>>>>>>>>>>>>>>>>
45138>>>>>>>>>>>>>>>>>>>
45138>>>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
45139>>>>>>>>>>>>>>>>>>>    End_Function //validate_save
45140>>>>>>>>>>>>>>>>>>>
45140>>>>>>>>>>>>>>>>>>>
45140>>>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
45140>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
45141>>>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
45142>>>>>>>>>>>>>>>>>>>    End_Function //validate_delete
45143>>>>>>>>>>>>>>>>>>>
45143>>>>>>>>>>>>>>>>>>>
45143>>>>>>>>>>>>>>>>>>>    // Define_Fields:
45143>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45143>>>>>>>>>>>>>>>>>>>
45143>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45144>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45146>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45146>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45146>>>>>>>>>>>>>>>>>>>
45146>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
45147>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45148>>>>>>>>>>>>>>>>>>>
45148>>>>>>>>>>>>>>>>>>>
45148>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45148>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
45149>>>>>>>>>>>>>>>>>>>
45149>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
45149>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
45150>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
45151>>>>>>>>>>>>>>>>>>>
45151>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45151>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45152>>>>>>>>>>>>>>>>>>>
45152>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
45152>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
45152>>>>>>>>>>>>>>>>>>>
45152>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45153>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45155>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45155>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45155>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45155>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45156>>>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
45157>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
45157>>>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
45157>>>>>>>>>>>>>>>>>
45157>>>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
45158>>>>>>>>>>>>>>>>>
45158>>>>>>>>>>>>>>>>>    Procedure Construct_Object
45159>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
45161>>>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
45163>>>>>>>>>>>>>>>>>        End_Object
45164>>>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
45165>>>>>>>>>>>>>>>>>        Property String     psValidChars ""
45166>>>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
45167>>>>>>>>>>>>>>>>>        Property String     psBranch 
45168>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
45169>>>>>>>>>>>>>>>>>
45169>>>>>>>>>>>>>>>>>    Procedure OnConstrain
45170>>>>>>>>>>>>>>>>>        Forward Send OnConstrain
45172>>>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
45174>>>>>>>>>>>>>>>>>        End
45174>>>>>>>>>>>>>>>>>>
45174>>>>>>>>>>>>>>>>>        Else Begin
45175>>>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
45177>>>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
45179>>>>>>>>>>>>>>>>>        End
45179>>>>>>>>>>>>>>>>>>
45179>>>>>>>>>>>>>>>>>    End_Procedure
45180>>>>>>>>>>>>>>>>>
45180>>>>>>>>>>>>>>>>>    Procedure Update
45181>>>>>>>>>>>>>>>>>        Forward Send Update
45183>>>>>>>>>>>>>>>>>        // Insert Code Here
45183>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
45184>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
45185>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
45186>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
45187>>>>>>>>>>>>>>>>>    End_Procedure   // Update
45188>>>>>>>>>>>>>>>>>
45188>>>>>>>>>>>>>>>>>    Procedure Creating
45189>>>>>>>>>>>>>>>>>        Forward Send Creating
45191>>>>>>>>>>>>>>>>>        // Insert Code Here
45191>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
45192>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
45193>>>>>>>>>>>>>>>>>
45193>>>>>>>>>>>>>>>>>
45193>>>>>>>>>>>>>>>>>//////////////////////////////////////
45193>>>>>>>>>>>>>>>>>//////////////////////////////////////
45193>>>>>>>>>>>>>>>>>
45193>>>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
45194>>>>>>>>>>>>>>>>>        String lsChar
45195>>>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
45195>>>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
45197>>>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
45198>>>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
45199>>>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
45205>>>>>>>>>>>>>>>>>>
45205>>>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
45206>>>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
45208>>>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
45209>>>>>>>>>>>>>>>>>                    Function_Return 1001
45210>>>>>>>>>>>>>>>>>               End
45210>>>>>>>>>>>>>>>>>>
45210>>>>>>>>>>>>>>>>>            Loop
45211>>>>>>>>>>>>>>>>>>
45211>>>>>>>>>>>>>>>>>        End
45211>>>>>>>>>>>>>>>>>>
45211>>>>>>>>>>>>>>>>>        Function_Return rVal
45212>>>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
45213>>>>>>>>>>>>>>>>>
45213>>>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
45213>>>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
45214>>>>>>>>>>>>>>>>>        // Insert Code Here
45214>>>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
45215>>>>>>>>>>>>>>>>>        Local Integer liFile##
45215>>>>>>>>>>>>>>>>>        Local Integer liField_Count##
45215>>>>>>>>>>>>>>>>>        Local Integer liField_Type##
45215>>>>>>>>>>>>>>>>>        Local Integer liField##
45215>>>>>>>>>>>>>>>>>
45215>>>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
45216>>>>>>>>>>>>>>>>>        Get Main_File to liFile##
45217>>>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
45220>>>>>>>>>>>>>>>>>
45220>>>>>>>>>>>>>>>>>
45220>>>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
45226>>>>>>>>>>>>>>>>>>
45226>>>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
45226>>>>>>>>>>>>>>>>>            move liField## to Fieldindex
45227>>>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
45228>>>>>>>>>>>>>>>>>        Loop
45229>>>>>>>>>>>>>>>>>>
45229>>>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
45230>>>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
45231>>>>>>>>>>>>>>>>>
45231>>>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
45231>>>>>>>>>>>>>>>>>
45231>>>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
45232>>>>>>>>>>>>>>>>>        // Insert Code Here
45232>>>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
45233>>>>>>>>>>>>>>>>>        Local Integer liFile##
45233>>>>>>>>>>>>>>>>>        Local Integer liField_Count##
45233>>>>>>>>>>>>>>>>>        Local Integer liField_Type##
45233>>>>>>>>>>>>>>>>>        Local Integer liField##
45233>>>>>>>>>>>>>>>>>
45233>>>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
45234>>>>>>>>>>>>>>>>>        Get Main_File to liFile##
45235>>>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
45238>>>>>>>>>>>>>>>>>
45238>>>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
45239>>>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
45240>>>>>>>>>>>>>>>>>
45240>>>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
45246>>>>>>>>>>>>>>>>>>
45246>>>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
45246>>>>>>>>>>>>>>>>>            move liField## to Fieldindex
45247>>>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
45248>>>>>>>>>>>>>>>>>        Loop
45249>>>>>>>>>>>>>>>>>>
45249>>>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
45250>>>>>>>>>>>>>>>>>
45250>>>>>>>>>>>>>>>>>    // Request_Save:
45250>>>>>>>>>>>>>>>>>
45250>>>>>>>>>>>>>>>>>
45250>>>>>>>>>>>>>>>>>
45250>>>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
45250>>>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
45251>>>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
45252>>>>>>>>>>>>>>>>>             REPEAT
45252>>>>>>>>>>>>>>>>>>
45252>>>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
45254>>>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
45255>>>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
45257>>>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
45258>>>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
45259>>>>>>>>>>>>>>>>>
45259>>>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
45260>>>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
45261>>>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
45261>>>>>>>>>>>>>>>>>
45261>>>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
45267>>>>>>>>>>>>>>>>>>
45267>>>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
45269>>>>>>>>>>>>>>>>>        LOOP
45270>>>>>>>>>>>>>>>>>>
45270>>>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
45271>>>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
45277>>>>>>>>>>>>>>>>>>
45277>>>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
45279>>>>>>>>>>>>>>>>>        LOOP
45280>>>>>>>>>>>>>>>>>>
45280>>>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
45281>>>>>>>>>>>>>>>>>    END_FUNCTION
45282>>>>>>>>>>>>>>>>>
45282>>>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
45283>>>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
45284>>>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
45284>>>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
45285>>>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
45286>>>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
45292>>>>>>>>>>>>>>>>>>
45292>>>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
45295>>>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
45299>>>>>>>>>>>>>>>>>             LOOP
45300>>>>>>>>>>>>>>>>>>
45300>>>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
45303>>>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
45309>>>>>>>>>>>>>>>>>>
45309>>>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
45312>>>>>>>>>>>>>>>>>             LOOP
45313>>>>>>>>>>>>>>>>>>
45313>>>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
45314>>>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
45315>>>>>>>>>>>>>>>>>
45315>>>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
45316>>>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
45317>>>>>>>>>>>>>>>>>        Number liGplanRecnum
45317>>>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
45317>>>>>>>>>>>>>>>>>
45317>>>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
45319>>>>>>>>>>>>>>>>>
45319>>>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
45320>>>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
45321>>>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
45322>>>>>>>>>>>>>>>>>
45322>>>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
45323>>>>>>>>>>>>>>>>>
45323>>>>>>>>>>>>>>>>>            clear Gplan
45324>>>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
45325>>>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
45326>>>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
45327>>>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
45328>>>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
45329>>>>>>>>>>>>>>>>>>
45329>>>>>>>>>>>>>>>>>            If (Found = 0) begin
45331>>>>>>>>>>>>>>>>>                clear gplan
45332>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45333>>>>>>>>>>>>>>>>>                find eq gplan.recnum
45334>>>>>>>>>>>>>>>>>>
45334>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
45335>>>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
45336>>>>>>>>>>>>>>>>>            end
45336>>>>>>>>>>>>>>>>>>
45336>>>>>>>>>>>>>>>>>            else begin
45337>>>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
45337>>>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
45339>>>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
45340>>>>>>>>>>>>>>>>>                   Function_return 7003
45341>>>>>>>>>>>>>>>>>               end
45341>>>>>>>>>>>>>>>>>>
45341>>>>>>>>>>>>>>>>>               clear gplan
45342>>>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
45343>>>>>>>>>>>>>>>>>               find eq gplan.recnum
45344>>>>>>>>>>>>>>>>>>
45344>>>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
45345>>>>>>>>>>>>>>>>>               function_Return 0 //ok
45346>>>>>>>>>>>>>>>>>            end
45346>>>>>>>>>>>>>>>>>>
45346>>>>>>>>>>>>>>>>>        end
45346>>>>>>>>>>>>>>>>>>
45346>>>>>>>>>>>>>>>>>        Function_Return 0
45347>>>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
45348>>>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
45348>>>>>>>>>>>>>>>>>
45348>>>>>>>>>>>>>>>>>
45348>>>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
45348>>>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
45349>>>>>>>>>>>>>>>>>        String lsNext_Anoep
45350>>>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
45350>>>>>>>>>>>>>>>>>        Number liGplanRecnum
45350>>>>>>>>>>>>>>>>>
45350>>>>>>>>>>>>>>>>>
45350>>>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
45350>>>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
45351>>>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
45352>>>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
45353>>>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
45354>>>>>>>>>>>>>>>>>
45354>>>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
45356>>>>>>>>>>>>>>>>>            find gt gplan by index.1
45357>>>>>>>>>>>>>>>>>>
45357>>>>>>>>>>>>>>>>>            if (found = 0) begin
45359>>>>>>>>>>>>>>>>>                clear gplan
45360>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45361>>>>>>>>>>>>>>>>>                find eq gplan.recnum
45362>>>>>>>>>>>>>>>>>>
45362>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
45363>>>>>>>>>>>>>>>>>            end
45363>>>>>>>>>>>>>>>>>>
45363>>>>>>>>>>>>>>>>>            else begin
45364>>>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
45364>>>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
45366>>>>>>>>>>>>>>>>>                    clear gplan
45367>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
45368>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
45369>>>>>>>>>>>>>>>>>>
45369>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
45370>>>>>>>>>>>>>>>>>                    Function_return 7004
45371>>>>>>>>>>>>>>>>>                end
45371>>>>>>>>>>>>>>>>>>
45371>>>>>>>>>>>>>>>>>                else begin
45372>>>>>>>>>>>>>>>>>                    clear gplan
45373>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
45374>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
45375>>>>>>>>>>>>>>>>>>
45375>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
45376>>>>>>>>>>>>>>>>>                end
45376>>>>>>>>>>>>>>>>>>
45376>>>>>>>>>>>>>>>>>            end
45376>>>>>>>>>>>>>>>>>>
45376>>>>>>>>>>>>>>>>>        end
45376>>>>>>>>>>>>>>>>>>
45376>>>>>>>>>>>>>>>>>
45376>>>>>>>>>>>>>>>>>        if (liMode = 1) begin
45378>>>>>>>>>>>>>>>>>            find gt gplan by index.1
45379>>>>>>>>>>>>>>>>>>
45379>>>>>>>>>>>>>>>>>            if (Found = 0) begin
45381>>>>>>>>>>>>>>>>>                clear gplan
45382>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45383>>>>>>>>>>>>>>>>>                find eq gplan.recnum
45384>>>>>>>>>>>>>>>>>>
45384>>>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
45385>>>>>>>>>>>>>>>>>            end
45385>>>>>>>>>>>>>>>>>>
45385>>>>>>>>>>>>>>>>>            else begin
45386>>>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
45388>>>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
45389>>>>>>>>>>>>>>>>>                    find eq gplan.recnum
45390>>>>>>>>>>>>>>>>>>
45390>>>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
45391>>>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
45392>>>>>>>>>>>>>>>>>                end
45392>>>>>>>>>>>>>>>>>>
45392>>>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
45393>>>>>>>>>>>>>>>>>                find eq gplan.recnum
45394>>>>>>>>>>>>>>>>>>
45394>>>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
45394>>>>>>>>>>>>>>>>>            end
45394>>>>>>>>>>>>>>>>>>
45394>>>>>>>>>>>>>>>>>        end
45394>>>>>>>>>>>>>>>>>>
45394>>>>>>>>>>>>>>>>>        Function_return 0
45395>>>>>>>>>>>>>>>>>    End_Function // fiForward_Check
45396>>>>>>>>>>>>>>>>>
45396>>>>>>>>>>>>>>>>>
45396>>>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
45397>>>>>>>>>>>>>>>>>
45397>>>>>>>>>>>>>>>>>        // Insert Code Here
45397>>>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
45398>>>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
45398>>>>>>>>>>>>>>>>>
45398>>>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
45399>>>>>>>>>>>>>>>>>>
45399>>>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
45400>>>>>>>>>>>>>>>>>    Search_Again:
45400>>>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
45401>>>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
45402>>>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
45403>>>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
45404>>>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
45405>>>>>>>>>>>>>>>>>        Find eq Gformat by index.1
45406>>>>>>>>>>>>>>>>>>
45406>>>>>>>>>>>>>>>>>
45406>>>>>>>>>>>>>>>>>        if (Found = 1) begin
45408>>>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45409>>>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
45410>>>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
45412>>>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45413>>>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
45415>>>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
45417>>>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
45418>>>>>>>>>>>>>>>>>                    end
45418>>>>>>>>>>>>>>>>>>
45418>>>>>>>>>>>>>>>>>                end
45418>>>>>>>>>>>>>>>>>>
45418>>>>>>>>>>>>>>>>>                if (libathmos > 1) begin
45420>>>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
45421>>>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
45423>>>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
45425>>>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
45426>>>>>>>>>>>>>>>>>                        End
45426>>>>>>>>>>>>>>>>>>
45426>>>>>>>>>>>>>>>>>                    End
45426>>>>>>>>>>>>>>>>>>
45426>>>>>>>>>>>>>>>>>                end
45426>>>>>>>>>>>>>>>>>>
45426>>>>>>>>>>>>>>>>>            function_return 0
45427>>>>>>>>>>>>>>>>>            end
45427>>>>>>>>>>>>>>>>>>
45427>>>>>>>>>>>>>>>>>            else begin
45428>>>>>>>>>>>>>>>>>                function_return 127
45429>>>>>>>>>>>>>>>>>            end
45429>>>>>>>>>>>>>>>>>>
45429>>>>>>>>>>>>>>>>>        end
45429>>>>>>>>>>>>>>>>>>
45429>>>>>>>>>>>>>>>>>        else begin
45430>>>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
45431>>>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
45433>>>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
45434>>>>>>>>>>>>>>>>>                Goto Search_Again
45435>>>>>>>>>>>>>>>>>>
45435>>>>>>>>>>>>>>>>>            end
45435>>>>>>>>>>>>>>>>>>
45435>>>>>>>>>>>>>>>>>            else begin
45436>>>>>>>>>>>>>>>>>                clear Gformat
45437>>>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
45438>>>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
45439>>>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
45440>>>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
45441>>>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
45442>>>>>>>>>>>>>>>>>>
45442>>>>>>>>>>>>>>>>>//* to be a function
45442>>>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45443>>>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
45444>>>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
45446>>>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
45447>>>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
45449>>>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
45451>>>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
45452>>>>>>>>>>>>>>>>>                        end
45452>>>>>>>>>>>>>>>>>>
45452>>>>>>>>>>>>>>>>>                    end
45452>>>>>>>>>>>>>>>>>>
45452>>>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
45454>>>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
45455>>>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
45457>>>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
45459>>>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
45460>>>>>>>>>>>>>>>>>                            end
45460>>>>>>>>>>>>>>>>>>
45460>>>>>>>>>>>>>>>>>                        end
45460>>>>>>>>>>>>>>>>>>
45460>>>>>>>>>>>>>>>>>                    end
45460>>>>>>>>>>>>>>>>>>
45460>>>>>>>>>>>>>>>>>                function_return 0
45461>>>>>>>>>>>>>>>>>                end
45461>>>>>>>>>>>>>>>>>>
45461>>>>>>>>>>>>>>>>>                else begin
45462>>>>>>>>>>>>>>>>>                    function_return 127
45463>>>>>>>>>>>>>>>>>                end
45463>>>>>>>>>>>>>>>>>>
45463>>>>>>>>>>>>>>>>>
45463>>>>>>>>>>>>>>>>>                //* emd to be a function
45463>>>>>>>>>>>>>>>>>                function_return 0
45464>>>>>>>>>>>>>>>>>            end
45464>>>>>>>>>>>>>>>>>>
45464>>>>>>>>>>>>>>>>>        end
45464>>>>>>>>>>>>>>>>>>
45464>>>>>>>>>>>>>>>>>        Function_return 0    //ok
45465>>>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
45466>>>>>>>>>>>>>>>>>
45466>>>>>>>>>>>>>>>>>
45466>>>>>>>>>>>>>>>>>
45466>>>>>>>>>>>>>>>>>    // fiValidateGplanFields:
45466>>>>>>>>>>>>>>>>>
45466>>>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
45467>>>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
45468>>>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
45468>>>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
45468>>>>>>>>>>>>>>>>>
45468>>>>>>>>>>>>>>>>>        Get Main_File to iMainFile
45469>>>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
45472>>>>>>>>>>>>>>>>>
45472>>>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
45474>>>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
45475>>>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
45477>>>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
45478>>>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
45479>>>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
45480>>>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
45482>>>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
45483>>>>>>>>>>>>>>>>>>
45483>>>>>>>>>>>>>>>>>                               Function_Return liReturnVal
45484>>>>>>>>>>>>>>>>>                            end
45484>>>>>>>>>>>>>>>>>>
45484>>>>>>>>>>>>>>>>>
45484>>>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
45485>>>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
45487>>>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
45488>>>>>>>>>>>>>>>>>>
45488>>>>>>>>>>>>>>>>>                                        function_return 127
45489>>>>>>>>>>>>>>>>>                                      end
45489>>>>>>>>>>>>>>>>>>
45489>>>>>>>>>>>>>>>>>
45489>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
45490>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
45491>>>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
45492>>>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
45493>>>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
45495>>>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
45496>>>>>>>>>>>>>>>>>>
45496>>>>>>>>>>>>>>>>>                                               Function_Return 8001
45497>>>>>>>>>>>>>>>>>                                            end
45497>>>>>>>>>>>>>>>>>>
45497>>>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
45499>>>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
45500>>>>>>>>>>>>>>>>>>
45500>>>>>>>>>>>>>>>>>                                               Function_Return 8002
45501>>>>>>>>>>>>>>>>>                                          end
45501>>>>>>>>>>>>>>>>>>
45501>>>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
45503>>>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
45504>>>>>>>>>>>>>>>>>>
45504>>>>>>>>>>>>>>>>>                                               Function_Return 8003
45505>>>>>>>>>>>>>>>>>                                          end
45505>>>>>>>>>>>>>>>>>>
45505>>>>>>>>>>>>>>>>>
45505>>>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
45506>>>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
45508>>>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
45509>>>>>>>>>>>>>>>>>>
45509>>>>>>>>>>>>>>>>>                                               Function_Return 8004
45510>>>>>>>>>>>>>>>>>                                            end
45510>>>>>>>>>>>>>>>>>>
45510>>>>>>>>>>>>>>>>>
45510>>>>>>>>>>>>>>>>>            end
45510>>>>>>>>>>>>>>>>>>
45510>>>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
45512>>>>>>>>>>>>>>>>>         end
45512>>>>>>>>>>>>>>>>>>
45512>>>>>>>>>>>>>>>>>         function_return 0
45513>>>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
45514>>>>>>>>>>>>>>>>>
45514>>>>>>>>>>>>>>>>>
45514>>>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
45514>>>>>>>>>>>>>>>>>
45514>>>>>>>>>>>>>>>>>
45514>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
45515>>>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
45515>>>>>>>>>>>>>>>>>        // Insert Code Here
45515>>>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
45518>>>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
45522>>>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
45526>>>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
45530>>>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45534>>>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45538>>>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
45542>>>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
45546>>>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
45550>>>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
45554>>>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
45558>>>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
45562>>>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
45565>>>>>>>>>>>>>>>>>    End_Procedure
45566>>>>>>>>>>>>>>>>>
45566>>>>>>>>>>>>>>>>>
45566>>>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
45567>>>>>>>>>>>>>>>>>        Clear Gplan
45568>>>>>>>>>>>>>>>>>    End_Procedure
45569>>>>>>>>>>>>>>>>>
45569>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
45570>>>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
45571>>>>>>>>>>>>>>>>>        locaL string lsVal##
45571>>>>>>>>>>>>>>>>>
45571>>>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
45573>>>>>>>>>>>>>>>>>
45573>>>>>>>>>>>>>>>>>
45573>>>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
45575>>>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
45575>>>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
45575>>>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
45578>>>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
45581>>>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
45584>>>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
45590>>>>>>>>>>>>>>>>>>
45590>>>>>>>>>>>>>>>>>
45590>>>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
45591>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
45594>>>>>>>>>>>>>>>>>
45594>>>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
45595>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
45598>>>>>>>>>>>>>>>>>
45598>>>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
45599>>>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
45602>>>>>>>>>>>>>>>>>
45602>>>>>>>>>>>>>>>>>            Loop
45603>>>>>>>>>>>>>>>>>>
45603>>>>>>>>>>>>>>>>>              //1100:cby = globals
45603>>>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
45606>>>>>>>>>>>>>>>>>        End
45606>>>>>>>>>>>>>>>>>>
45606>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
45607>>>>>>>>>>>>>>>>>    End_Function
45608>>>>>>>>>>>>>>>>>
45608>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
45609>>>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
45610>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
45612>>>>>>>>>>>>>>>>>
45612>>>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
45614>>>>>>>>>>>>>>>>>            // Insert Code Here
45614>>>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
45615>>>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
45618>>>>>>>>>>>>>>>>>              //2100:cby = globals
45618>>>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
45621>>>>>>>>>>>>>>>>>        End
45621>>>>>>>>>>>>>>>>>>
45621>>>>>>>>>>>>>>>>>
45621>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
45622>>>>>>>>>>>>>>>>>    End_Function
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>//    Procedure Update
45623>>>>>>>>>>>>>>>>>//        Forward Send Update
45623>>>>>>>>>>>>>>>>>//        // Insert Code Here
45623>>>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
45623>>>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
45623>>>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
45623>>>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
45623>>>>>>>>>>>>>>>>>//    End_Procedure   // Update
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>//    Procedure Backout
45623>>>>>>>>>>>>>>>>>//        Forward Send Backout
45623>>>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
45623>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>    // Define_Fields:
45623>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45623>>>>>>>>>>>>>>>>>
45623>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45624>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45626>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45626>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45626>>>>>>>>>>>>>>>>>
45626>>>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
45627>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45628>>>>>>>>>>>>>>>>>
45628>>>>>>>>>>>>>>>>>
45628>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45628>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
45629>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
45630>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
45631>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
45632>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
45633>>>>>>>>>>>>>>>>>
45633>>>>>>>>>>>>>>>>>        // External (System) file structure.............
45633>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
45634>>>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
45635>>>>>>>>>>>>>>>>>
45635>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
45638>>>>>>>>>>>>>>>>>
45638>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45638>>>>>>>>>>>>>>>>>
45638>>>>>>>>>>>>>>>>>        // Gplan.Company_Code
45638>>>>>>>>>>>>>>>>>
45638>>>>>>>>>>>>>>>>>        // Gplan.Branch_Code
45638>>>>>>>>>>>>>>>>>
45638>>>>>>>>>>>>>>>>>        // Gplan.Year_Year
45638>>>>>>>>>>>>>>>>>
45638>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
45638>>>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
45639>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
45640>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
45641>>>>>>>>>>>>>>>>>
45641>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
45641>>>>>>>>>>>>>>>>>
45641>>>>>>>>>>>>>>>>>        // Gplan.Year_Recr
45641>>>>>>>>>>>>>>>>>
45641>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
45641>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
45642>>>>>>>>>>>>>>>>>
45642>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
45642>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
45643>>>>>>>>>>>>>>>>>
45643>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
45643>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
45643>>>>>>>>>>>>>>>>>
45643>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
45643>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
45643>>>>>>>>>>>>>>>>>
45643>>>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
45643>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
45644>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
45645>>>>>>>>>>>>>>>>>
45645>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
45645>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
45646>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
45647>>>>>>>>>>>>>>>>>
45647>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
45647>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
45647>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
45648>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
45649>>>>>>>>>>>>>>>>>
45649>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
45649>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
45649>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
45650>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
45651>>>>>>>>>>>>>>>>>
45651>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
45651>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
45652>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
45653>>>>>>>>>>>>>>>>>
45653>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
45653>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
45653>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
45654>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
45655>>>>>>>>>>>>>>>>>
45655>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
45655>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
45655>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
45656>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
45657>>>>>>>>>>>>>>>>>
45657>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
45657>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
45657>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
45658>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
45659>>>>>>>>>>>>>>>>>
45659>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
45659>>>>>>>>>>>>>>>>>
45659>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
45659>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
45660>>>>>>>>>>>>>>>>>
45660>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
45660>>>>>>>>>>>>>>>>>
45660>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
45660>>>>>>>>>>>>>>>>>
45660>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
45660>>>>>>>>>>>>>>>>>
45660>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
45660>>>>>>>>>>>>>>>>>
45660>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
45660>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
45661>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
45662>>>>>>>>>>>>>>>>>
45662>>>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
45662>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
45663>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
45664>>>>>>>>>>>>>>>>>
45664>>>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
45664>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
45664>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
45665>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
45666>>>>>>>>>>>>>>>>>
45666>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
45666>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
45667>>>>>>>>>>>>>>>>>
45667>>>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
45667>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
45668>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
45669>>>>>>>>>>>>>>>>>
45669>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
45669>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
45670>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
45671>>>>>>>>>>>>>>>>>
45671>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
45671>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
45672>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
45673>>>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
45673>>>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
45673>>>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
45673>>>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
45673>>>>>>>>>>>>>>>>>
45673>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
45673>>>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
45673>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
45674>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
45675>>>>>>>>>>>>>>>>>
45675>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
45675>>>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
45676>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
45677>>>>>>>>>>>>>>>>>
45677>>>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
45677>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
45678>>>>>>>>>>>>>>>>>
45678>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45678>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45679>>>>>>>>>>>>>>>>>
45679>>>>>>>>>>>>>>>>>    // Field_Defaults:
45679>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
45679>>>>>>>>>>>>>>>>>
45679>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45680>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45682>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45682>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45682>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
45683>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
45684>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
45685>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
45686>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
45687>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
45688>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
45689>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
45690>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
45691>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
45692>>>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
45693>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45693>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45694>>>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
45695>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>Use sl150.sl         // sl150
45695>>>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
45695>>>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
45695>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
45695>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
45695>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>// Project Object Structure
45695>>>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
45695>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
45695>>>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
45695>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
45695>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
45695>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
45695>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>// Register all objects
45695>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
45695>>>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
45695>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
45695>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
45695>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
45695>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
45695>>>>>>>>>>>>>>>>>>>Register_Object oSelList
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
45695>>>>>>>>>>>>>>>>>>>>>//DDB-FileStart
45695>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
45695>>>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
45695>>>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
45695>>>>>>>>>>>>>>>>>>>>>// Revision  : 33
45695>>>>>>>>>>>>>>>>>>>>>// Version   : 2
45695>>>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
45695>>>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45695>>>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45695>>>>>>>>>>>>>>>>>>>>>
45695>>>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
45697>>>>>>>>>>>>>>>>>>>>>Open Gtypkin
45699>>>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
45701>>>>>>>>>>>>>>>>>>>>>Open Sysrecg
45703>>>>>>>>>>>>>>>>>>>>>
45703>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
45703>>>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
45703>>>>>>>>>>>>>>>>>>>>>
45703>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
45703>>>>>>>>>>>>>>>>>>>>>
45703>>>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
45705>>>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
45706>>>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
45706>>>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
45706>>>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
45707>>>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
45707>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
45707>>>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
45707>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
45707>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
45707>>>>>>>>>>>>>>>>>>>>>
45707>>>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
45708>>>>>>>>>>>>>>>>>>>>>
45708>>>>>>>>>>>>>>>>>>>>>
45708>>>>>>>>>>>>>>>>>>>>>    // Define_Fields:
45708>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45708>>>>>>>>>>>>>>>>>>>>>
45708>>>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45709>>>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45711>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45711>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45711>>>>>>>>>>>>>>>>>>>>>
45711>>>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
45712>>>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45713>>>>>>>>>>>>>>>>>>>>>
45713>>>>>>>>>>>>>>>>>>>>>
45713>>>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45713>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
45714>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
45715>>>>>>>>>>>>>>>>>>>>>
45715>>>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
45715>>>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
45716>>>>>>>>>>>>>>>>>>>>>
45716>>>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
45719>>>>>>>>>>>>>>>>>>>>>
45719>>>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45719>>>>>>>>>>>>>>>>>>>>>
45719>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
45719>>>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
45720>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
45721>>>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
45722>>>>>>>>>>>>>>>>>>>>>
45722>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
45722>>>>>>>>>>>>>>>>>>>>>
45722>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
45722>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
45723>>>>>>>>>>>>>>>>>>>>>
45723>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
45723>>>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
45724>>>>>>>>>>>>>>>>>>>>>
45724>>>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
45724>>>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
45725>>>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
45726>>>>>>>>>>>>>>>>>>>>>
45726>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45726>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45727>>>>>>>>>>>>>>>>>>>>>
45727>>>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
45727>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
45727>>>>>>>>>>>>>>>>>>>>>
45727>>>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45728>>>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45730>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45730>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45730>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45730>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45731>>>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
45732>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
45732>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
45732>>>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
45732>>>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
45732>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
45732>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
45732>>>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
45732>>>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
45732>>>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
45732>>>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
45732>>>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
45732>>>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
45732>>>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>// Register all objects
45732>>>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
45732>>>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
45732>>>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
45732>>>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
45732>>>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
45732>>>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
45732>>>>>>>>>>>>>>>>>>>>>>>
45732>>>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
45751>>>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
45752>>>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
45753>>>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
45754>>>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
45755>>>>>>>>>>>>>>>>>>>>>>>
45755>>>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
45755>>>>>>>>>>>>>>>>>>>>>>>
45755>>>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
45757>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
45758>>>>>>>>>>>>>>>>>>>>>>>
45758>>>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
45759>>>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
45760>>>>>>>>>>>>>>>>>>>>>>>
45760>>>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
45760>>>>>>>>>>>>>>>>>>>>>>>
45760>>>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
45762>>>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
45763>>>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
45764>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
45765>>>>>>>>>>>>>>>>>>>>>>>
45765>>>>>>>>>>>>>>>>>>>>>>>            Begin_Row
45768>>>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
45769>>>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
45770>>>>>>>>>>>>>>>>>>>>>>>            End_Row
45775>>>>>>>>>>>>>>>>>>>>>>>
45775>>>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
45776>>>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
45777>>>>>>>>>>>>>>>>>>>>>>>
45777>>>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
45778>>>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45779>>>>>>>>>>>>>>>>>>>>>>>
45779>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
45780>>>>>>>>>>>>>>>>>>>>>>>
45780>>>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
45782>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
45783>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
45784>>>>>>>>>>>>>>>>>>>>>>>
45784>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45784>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45786>>>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
45787>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
45788>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45788>>>>>>>>>>>>>>>>>>>>>>>
45788>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
45789>>>>>>>>>>>>>>>>>>>>>>>
45789>>>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
45791>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
45792>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
45793>>>>>>>>>>>>>>>>>>>>>>>
45793>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45793>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45795>>>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
45796>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
45797>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45797>>>>>>>>>>>>>>>>>>>>>>>
45797>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
45798>>>>>>>>>>>>>>>>>>>>>>>
45798>>>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
45800>>>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
45801>>>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
45802>>>>>>>>>>>>>>>>>>>>>>>
45802>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45802>>>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45804>>>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
45805>>>>>>>>>>>>>>>>>>>>>>>            End_Procedure
45806>>>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45806>>>>>>>>>>>>>>>>>>>>>>>
45806>>>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
45807>>>>>>>>>>>>>>>>>>>>>>>
45807>>>>>>>>>>>>>>>>>>>>>>>
45807>>>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
45807>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
45808>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
45809>>>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
45810>>>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
45810>>>>>>>>>>>>>>>>>>>>>>>
45810>>>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
45812>>>>>>>>>>>>>>>>>>>>>>>>
45812>>>>>>>>>>>>>>>>>>>>>>>
45812>>>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
45812>>>>>>>>>>>>>>>>>>>>>
45812>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
45812>>>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
45812>>>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
45812>>>>>>>>>>>>>>>>>>>>>//DDB-FileStart
45812>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
45812>>>>>>>>>>>>>>>>>>>>>
45812>>>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
45812>>>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
45812>>>>>>>>>>>>>>>>>>>>>// Revision  : 45
45812>>>>>>>>>>>>>>>>>>>>>// Version   : 2
45812>>>>>>>>>>>>>>>>>>>>>
45812>>>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
45812>>>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
45812>>>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
45812>>>>>>>>>>>>>>>>>>>>>
45812>>>>>>>>>>>>>>>>>>>>>Open Gtypkin
45814>>>>>>>>>>>>>>>>>>>>>Open Garticl
45816>>>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
45818>>>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
45820>>>>>>>>>>>>>>>>>>>>>Open Gthhmgio
45822>>>>>>>>>>>>>>>>>>>>>Open Sysrecg
45824>>>>>>>>>>>>>>>>>>>>>
45824>>>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
45824>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
45824>>>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
45824>>>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
45824>>>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
45824>>>>>>>>>>>>>>>>>>>>>Open SysCurGL
45826>>>>>>>>>>>>>>>>>>>>>
45826>>>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
45827>>>>>>>>>>>>>>>>>>>>>
45827>>>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
45828>>>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
45828>>>>>>>>>>>>>>>>>>>>>         Integer Changed
45829>>>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
45830>>>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
45832>>>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
45833>>>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
45834>>>>>>>>>>>>>>>>>>>>>         End
45834>>>>>>>>>>>>>>>>>>>>>>
45834>>>>>>>>>>>>>>>>>>>>>    End_Procedure
45835>>>>>>>>>>>>>>>>>>>>>
45835>>>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
45836>>>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
45838>>>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
45839>>>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
45840>>>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
45841>>>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
45842>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
45843>>>>>>>>>>>>>>>>>>>>>
45843>>>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
45843>>>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
45843>>>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
45843>>>>>>>>>>>>>>>>>>>>>//        End
45843>>>>>>>>>>>>>>>>>>>>>//        Else Begin
45843>>>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
45843>>>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
45843>>>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
45843>>>>>>>>>>>>>>>>>>>>>//        End
45843>>>>>>>>>>>>>>>>>>>>>//    End_Procedure
45843>>>>>>>>>>>>>>>>>>>>>
45843>>>>>>>>>>>>>>>>>>>>>    Procedure Update
45844>>>>>>>>>>>>>>>>>>>>>        Forward Send Update
45846>>>>>>>>>>>>>>>>>>>>>        // Insert Code Here
45846>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
45847>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
45848>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
45849>>>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
45850>>>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
45851>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
45852>>>>>>>>>>>>>>>>>>>>>
45852>>>>>>>>>>>>>>>>>>>>>    Procedure Creating
45853>>>>>>>>>>>>>>>>>>>>>        Forward Send Creating
45855>>>>>>>>>>>>>>>>>>>>>        // Insert Code Here
45855>>>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
45856>>>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
45857>>>>>>>>>>>>>>>>>>>>>
45857>>>>>>>>>>>>>>>>>>>>>
45857>>>>>>>>>>>>>>>>>>>>>
45857>>>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
45857>>>>>>>>>>>>>>>>>>>>>
45857>>>>>>>>>>>>>>>>>>>>>//    Procedure Creating
45857>>>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
45857>>>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
45857>>>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
45857>>>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
45857>>>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
45857>>>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
45857>>>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
45857>>>>>>>>>>>>>>>>>>>>>
45857>>>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
45858>>>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
45859>>>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
45861>>>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
45861>>>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
45861>>>>>>>>>>>>>>>>>>>>>//            If ( ;
45861>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
45861>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
45861>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
45861>>>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
45861>>>>>>>>>>>>>>>>>>>>>//        End
45861>>>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
45862>>>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
45863>>>>>>>>>>>>>>>>>>>>>
45863>>>>>>>>>>>>>>>>>>>>>
45863>>>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
45864>>>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
45865>>>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
45867>>>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
45867>>>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
45867>>>>>>>>>>>>>>>>>>>>>//            If ( ;
45867>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
45867>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
45867>>>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
45867>>>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
45867>>>>>>>>>>>>>>>>>>>>>//        End
45867>>>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
45868>>>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
45869>>>>>>>>>>>>>>>>>>>>>
45869>>>>>>>>>>>>>>>>>>>>>
45869>>>>>>>>>>>>>>>>>>>>>
45869>>>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
45870>>>>>>>>>>>>>>>>>>>>>              Case Begin
45870>>>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
45872>>>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45873>>>>>>>>>>>>>>>>>>>>>>
45873>>>>>>>>>>>>>>>>>>>>>                        Case Break
45874>>>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
45877>>>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
45878>>>>>>>>>>>>>>>>>>>>>>
45878>>>>>>>>>>>>>>>>>>>>>                        Case Break
45879>>>>>>>>>>>>>>>>>>>>>                   Case Else
45879>>>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
45881>>>>>>>>>>>>>>>>>>>>>              Case End
45881>>>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
45882>>>>>>>>>>>>>>>>>>>>>
45882>>>>>>>>>>>>>>>>>>>>>
45882>>>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
45883>>>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
45885>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45885>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
45885>>>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
45885>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
45886>>>>>>>>>>>>>>>>>>>>>
45886>>>>>>>>>>>>>>>>>>>>>
45886>>>>>>>>>>>>>>>>>>>>>
45886>>>>>>>>>>>>>>>>>>>>>    // Define_Fields:
45886>>>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
45886>>>>>>>>>>>>>>>>>>>>>
45886>>>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
45887>>>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
45889>>>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
45889>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
45889>>>>>>>>>>>>>>>>>>>>>
45889>>>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
45890>>>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
45891>>>>>>>>>>>>>>>>>>>>>
45891>>>>>>>>>>>>>>>>>>>>>
45891>>>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
45891>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
45892>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
45893>>>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
45894>>>>>>>>>>>>>>>>>>>>>
45894>>>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
45894>>>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
45895>>>>>>>>>>>>>>>>>>>>>
45895>>>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
45895>>>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
45896>>>>>>>>>>>>>>>>>>>>>
45896>>>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
45899>>>>>>>>>>>>>>>>>>>>>
45899>>>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
45899>>>>>>>>>>>>>>>>>>>>>
45899>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
45899>>>>>>>>>>>>>>>>>>>>>
45899>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
45899>>>>>>>>>>>>>>>>>>>>>
45899>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
45899>>>>>>>>>>>>>>>>>>>>>
45899>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
45899>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
45900>>>>>>>>>>>>>>>>>>>>>
45900>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
45900>>>>>>>>>>>>>>>>>>>>>
45900>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
45900>>>>>>>>>>>>>>>>>>>>>
45900>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
45900>>>>>>>>>>>>>>>>>>>>>
45900>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
45900>>>>>>>>>>>>>>>>>>>>>
45900>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
45900>>>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
45901>>>>>>>>>>>>>>>>>>>>>
45901>>>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
45901>>>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
45902>>>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
45903>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
45903>>>>>>>>>>>>>>>>>>>>>
45903>>>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
45903>>>>>>>>>>>>>>>>>>>>>
45903>>>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
45903>>>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
45903>>>>>>>>>>>>>>>>>>>    
45903>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
45903>>>>>>>>>>>>>>>>>>>
45903>>>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
45922>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
45923>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
45924>>>>>>>>>>>>>>>>>>>        Set Size to 171 467
45925>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
45926>>>>>>>>>>>>>>>>>>>
45926>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
45926>>>>>>>>>>>>>>>>>>>
45926>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
45928>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
45929>>>>>>>>>>>>>>>>>>>
45929>>>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
45931>>>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
45932>>>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
45933>>>>>>>>>>>>>>>>>>>
45933>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
45934>>>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
45935>>>>>>>>>>>>>>>>>>>
45935>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
45935>>>>>>>>>>>>>>>>>>>
45935>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
45937>>>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
45938>>>>>>>>>>>>>>>>>>>            Set Size to 132 450
45939>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
45940>>>>>>>>>>>>>>>>>>>
45940>>>>>>>>>>>>>>>>>>>            Begin_Row
45943>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
45944>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
45945>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
45946>>>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
45947>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
45948>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
45949>>>>>>>>>>>>>>>>>>>            End_Row
45954>>>>>>>>>>>>>>>>>>>
45954>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
45955>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
45956>>>>>>>>>>>>>>>>>>>            
45956>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
45957>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45958>>>>>>>>>>>>>>>>>>>            
45958>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
45959>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
45960>>>>>>>>>>>>>>>>>>>            
45960>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
45961>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
45962>>>>>>>>>>>>>>>>>>>            
45962>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
45963>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
45964>>>>>>>>>>>>>>>>>>>            
45964>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
45965>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
45966>>>>>>>>>>>>>>>>>>>            
45966>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
45967>>>>>>>>>>>>>>>>>>>
45967>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
45969>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
45970>>>>>>>>>>>>>>>>>>>            Set Location to 140 298
45971>>>>>>>>>>>>>>>>>>>
45971>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45971>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45973>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
45974>>>>>>>>>>>>>>>>>>>            End_Procedure
45975>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45975>>>>>>>>>>>>>>>>>>>
45975>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
45976>>>>>>>>>>>>>>>>>>>
45976>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
45978>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
45979>>>>>>>>>>>>>>>>>>>            Set Location to 140 353
45980>>>>>>>>>>>>>>>>>>>
45980>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45980>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45982>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
45983>>>>>>>>>>>>>>>>>>>            End_Procedure
45984>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45984>>>>>>>>>>>>>>>>>>>
45984>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
45985>>>>>>>>>>>>>>>>>>>
45985>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
45987>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
45988>>>>>>>>>>>>>>>>>>>            Set Location to 140 408
45989>>>>>>>>>>>>>>>>>>>
45989>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
45989>>>>>>>>>>>>>>>>>>>            Procedure OnClick
45991>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
45992>>>>>>>>>>>>>>>>>>>            End_Procedure
45993>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
45993>>>>>>>>>>>>>>>>>>>
45993>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
45994>>>>>>>>>>>>>>>>>>>
45994>>>>>>>>>>>>>>>>>>>
45994>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
45994>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
45995>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
45996>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
45997>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
45997>>>>>>>>>>>>>>>>>>>
45997>>>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
45999>>>>>>>>>>>>>>>>>>>>
45999>>>>>>>>>>>>>>>>>>>
45999>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
45999>>>>>>>>>>>>>>>>>
45999>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
45999>>>>>>>>>>>>>>>>>//DDB-FileEnd
45999>>>>>>>>>>>>>>>    
45999>>>>>>>>>>>>>>>    //AB-IgnoreEnd
45999>>>>>>>>>>>>>>>
45999>>>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
46018>>>>>>>>>>>>>>>
46018>>>>>>>>>>>>>>>        //AB-StoreTopStart
46018>>>>>>>>>>>>>>>        Property Integer piFragmaLast -1
46020>>>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
46022>>>>>>>>>>>>>>>        Property String  psFragmaToCode ""
46024>>>>>>>>>>>>>>>        
46024>>>>>>>>>>>>>>>        //AB-StoreTopEnd
46024>>>>>>>>>>>>>>>
46024>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
46025>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
46026>>>>>>>>>>>>>>>        Set Size to 204 393
46027>>>>>>>>>>>>>>>        Set Location to 5 16
46028>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46029>>>>>>>>>>>>>>>        Set Modal_State to FALSE
46030>>>>>>>>>>>>>>>
46030>>>>>>>>>>>>>>>        //AB-DDOStart
46030>>>>>>>>>>>>>>>
46030>>>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
46032>>>>>>>>>>>>>>>
46032>>>>>>>>>>>>>>>            //AB-StoreStart
46032>>>>>>>>>>>>>>>                        
46032>>>>>>>>>>>>>>>            Procedure OnConstrain
46034>>>>>>>>>>>>>>>                Integer liFragmaLast
46035>>>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
46035>>>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
46036>>>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
46037>>>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
46038>>>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
46042>>>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
46046>>>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
46050>>>>>>>>>>>>>>>            End_Procedure // OnConstrain
46051>>>>>>>>>>>>>>>            
46051>>>>>>>>>>>>>>>            
46051>>>>>>>>>>>>>>>            //AB-StoreEnd
46051>>>>>>>>>>>>>>>
46051>>>>>>>>>>>>>>>        End_Object    // Gplan_DD
46052>>>>>>>>>>>>>>>
46052>>>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
46053>>>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
46054>>>>>>>>>>>>>>>
46054>>>>>>>>>>>>>>>        //AB-DDOEnd
46054>>>>>>>>>>>>>>>
46054>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
46056>>>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
46057>>>>>>>>>>>>>>>            Set Ordering to 3
46058>>>>>>>>>>>>>>>            Set Size to 164 378
46059>>>>>>>>>>>>>>>            Set Location to 4 6
46060>>>>>>>>>>>>>>>
46060>>>>>>>>>>>>>>>            Begin_Row
46063>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
46064>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
46065>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
46066>>>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
46067>>>>>>>>>>>>>>>            End_Row
46072>>>>>>>>>>>>>>>
46072>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
46073>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
46074>>>>>>>>>>>>>>>            
46074>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
46075>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
46076>>>>>>>>>>>>>>>            
46076>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
46077>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
46078>>>>>>>>>>>>>>>            
46078>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
46079>>>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
46080>>>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
46081>>>>>>>>>>>>>>>            
46081>>>>>>>>>>>>>>>
46081>>>>>>>>>>>>>>>            //AB-StoreStart
46081>>>>>>>>>>>>>>>                        
46081>>>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
46083>>>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
46085>>>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
46087>>>>>>>>>>>>>>>            
46087>>>>>>>>>>>>>>>            Procedure Store_Defaults
46089>>>>>>>>>>>>>>>                forward send Store_Defaults
46091>>>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
46092>>>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
46093>>>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
46094>>>>>>>>>>>>>>>            end_Procedure // Store_Defaults
46095>>>>>>>>>>>>>>>            
46095>>>>>>>>>>>>>>>            Procedure Restore_Defaults
46097>>>>>>>>>>>>>>>                forward send Restore_Defaults
46099>>>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
46100>>>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
46101>>>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
46102>>>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
46103>>>>>>>>>>>>>>>            
46103>>>>>>>>>>>>>>>            Procedure Activating
46105>>>>>>>>>>>>>>>                Forward Send Activating
46107>>>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
46108>>>>>>>>>>>>>>>            End_Procedure // Activating
46109>>>>>>>>>>>>>>>            
46109>>>>>>>>>>>>>>>            
46109>>>>>>>>>>>>>>>            
46109>>>>>>>>>>>>>>>            
46109>>>>>>>>>>>>>>>            //AB-StoreEnd
46109>>>>>>>>>>>>>>>
46109>>>>>>>>>>>>>>>        End_Object    // oSelList
46110>>>>>>>>>>>>>>>
46110>>>>>>>>>>>>>>>        Object oOK_bn is a Button
46112>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46113>>>>>>>>>>>>>>>            Set Location to 170 226
46114>>>>>>>>>>>>>>>
46114>>>>>>>>>>>>>>>            //AB-StoreStart
46114>>>>>>>>>>>>>>>            Procedure OnClick
46116>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46117>>>>>>>>>>>>>>>            End_Procedure
46118>>>>>>>>>>>>>>>            //AB-StoreEnd
46118>>>>>>>>>>>>>>>
46118>>>>>>>>>>>>>>>        End_Object    // oOK_bn
46119>>>>>>>>>>>>>>>
46119>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
46121>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46122>>>>>>>>>>>>>>>            Set Location to 170 279
46123>>>>>>>>>>>>>>>
46123>>>>>>>>>>>>>>>            //AB-StoreStart
46123>>>>>>>>>>>>>>>            Procedure OnClick
46125>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46126>>>>>>>>>>>>>>>            End_Procedure
46127>>>>>>>>>>>>>>>            //AB-StoreEnd
46127>>>>>>>>>>>>>>>
46127>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
46128>>>>>>>>>>>>>>>
46128>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
46130>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
46131>>>>>>>>>>>>>>>            Set Location to 170 334
46132>>>>>>>>>>>>>>>
46132>>>>>>>>>>>>>>>            //AB-StoreStart
46132>>>>>>>>>>>>>>>            Procedure OnClick
46134>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46135>>>>>>>>>>>>>>>            End_Procedure
46136>>>>>>>>>>>>>>>            //AB-StoreEnd
46136>>>>>>>>>>>>>>>
46136>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
46137>>>>>>>>>>>>>>>
46137>>>>>>>>>>>>>>>
46137>>>>>>>>>>>>>>>        //AB-StoreStart
46137>>>>>>>>>>>>>>>                
46137>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
46138>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
46139>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
46140>>>>>>>>>>>>>>>        
46140>>>>>>>>>>>>>>>        
46140>>>>>>>>>>>>>>>        
46140>>>>>>>>>>>>>>>        //AB-StoreEnd
46140>>>>>>>>>>>>>>>
46140>>>>>>>>>>>>>>>    CD_End_Object    // sl150
46142>>>>>>>>>>>>>>>>
46142>>>>>>>>>>>>>>>
46142>>>>>>>>>>>>>>>//AB/     End_Object    // prj
46142>>>>>>>>>>>>>
46142>>>>>>>>>>>>>//DDB-Selection-pkg-End
46142>>>>>>>>>>>>>//DDB-FileEnd
46142>>>>>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
46142>>>>>>>>>>>>>//DDB-FileStart
46142>>>>>>>>>>>>>//DDB-HeaderStart
46142>>>>>>>>>>>>>
46142>>>>>>>>>>>>>// File Name : ITEM.DD
46142>>>>>>>>>>>>>// Class Name: Item_DataDictionary
46142>>>>>>>>>>>>>// Revision  : 63
46142>>>>>>>>>>>>>// Version   : 2
46142>>>>>>>>>>>>>
46142>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46142>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46142>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46142>>>>>>>>>>>>>
46142>>>>>>>>>>>>>Open Item
46144>>>>>>>>>>>>>Open Witemx
46146>>>>>>>>>>>>>Open Witemcl
46148>>>>>>>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
46150>>>>>>>>>>>>>Open Units
46152>>>>>>>>>>>>>Open Witemkat
46154>>>>>>>>>>>>>Open Fpa
46156>>>>>>>>>>>>>Open Sysrecw
46158>>>>>>>>>>>>>Open Witemx
46160>>>>>>>>>>>>>
46160>>>>>>>>>>>>>//DDB-HeaderEnd
46160>>>>>>>>>>>>>//DDB-ValidationStart
46160>>>>>>>>>>>>>
46160>>>>>>>>>>>>>Register_Object Item_Item_Qual_VT
46160>>>>>>>>>>>>>Register_Object Item_Item_Analysh_VT
46160>>>>>>>>>>>>>
46160>>>>>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
46162>>>>>>>>>>>>>    Set Type_Value        To "QUAL"
46163>>>>>>>>>>>>>    Set Validate_State    To FALSE
46164>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46165>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46165>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46165>>>>>>>>>>>>>End_Object   // Item_Item_Qual_VT
46166>>>>>>>>>>>>>
46166>>>>>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
46168>>>>>>>>>>>>>    Set Type_Value        To "ITEMANAL"
46169>>>>>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
46170>>>>>>>>>>>>>    //DDB-ValidationCustomStart
46170>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
46170>>>>>>>>>>>>>End_Object   // Item_Item_Analysh_VT
46171>>>>>>>>>>>>>//DDB-ValidationEnd
46171>>>>>>>>>>>>>//DDB-SelectionStart
46171>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
46171>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
46171>>>>>>>>>>>>>Register_Object SL22s
46171>>>>>>>>>>>>>Register_Object sl022
46171>>>>>>>>>>>>>//DDB-SelectionEnd
46171>>>>>>>>>>>>>
46171>>>>>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
46172>>>>>>>>>>>>>
46172>>>>>>>>>>>>>    Procedure Update
46173>>>>>>>>>>>>>        Forward Send Update
46175>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
46176>>>>>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
46177>>>>>>>>>>>>>    End_Procedure   // Update
46178>>>>>>>>>>>>>
46178>>>>>>>>>>>>>    Procedure Creating
46179>>>>>>>>>>>>>        Date dHmnia
46180>>>>>>>>>>>>>        Forward Send Creating
46182>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
46183>>>>>>>>>>>>>        
46183>>>>>>>>>>>>>        Clear Branch
46184>>>>>>>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
46185>>>>>>>>>>>>>        Find Gt Branch By Index.1 
46186>>>>>>>>>>>>>>
46186>>>>>>>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
46190>>>>>>>>>>>>>            Clear Witemx
46191>>>>>>>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
46192>>>>>>>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
46193>>>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
46194>>>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
46195>>>>>>>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
46196>>>>>>>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
46197>>>>>>>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
46198>>>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
46199>>>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
46200>>>>>>>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
46201>>>>>>>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
46202>>>>>>>>>>>>>            Move Item.link1                 to Witemx.link1
46203>>>>>>>>>>>>>            Move Item.link2                 to Witemx.link2
46204>>>>>>>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
46205>>>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
46206>>>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
46207>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
46208>>>>>>>>>>>>>            Saverecord Sysrecw
46209>>>>>>>>>>>>>            Saverecord Witemx
46210>>>>>>>>>>>>>            
46210>>>>>>>>>>>>>            Find Gt Branch By Index.1 
46211>>>>>>>>>>>>>>
46211>>>>>>>>>>>>>        Loop
46212>>>>>>>>>>>>>>
46212>>>>>>>>>>>>>    End_Procedure   // Creating
46213>>>>>>>>>>>>>
46213>>>>>>>>>>>>>
46213>>>>>>>>>>>>>    // Define_Fields:
46213>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46213>>>>>>>>>>>>>
46213>>>>>>>>>>>>>    Procedure Define_Fields
46214>>>>>>>>>>>>>        Forward Send Define_Fields
46216>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46216>>>>>>>>>>>>>        //DDB-DefineFieldStart
46216>>>>>>>>>>>>>
46216>>>>>>>>>>>>>        Set Main_File            To Item.File_Number
46217>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46218>>>>>>>>>>>>>
46218>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46219>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46220>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46221>>>>>>>>>>>>>
46221>>>>>>>>>>>>>        // Child (Client) file structure................
46221>>>>>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
46222>>>>>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
46223>>>>>>>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
46224>>>>>>>>>>>>>
46224>>>>>>>>>>>>>        // Parent (Server) file structure...............
46224>>>>>>>>>>>>>        Send Add_Server_File  Units.File_Number
46225>>>>>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
46226>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
46227>>>>>>>>>>>>>
46227>>>>>>>>>>>>>        // External (System) file structure.............
46227>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46228>>>>>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
46229>>>>>>>>>>>>>
46229>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
46232>>>>>>>>>>>>>
46232>>>>>>>>>>>>>        // Field-based properties.......................
46232>>>>>>>>>>>>>
46232>>>>>>>>>>>>>        // Item.Units_Code
46232>>>>>>>>>>>>>
46232>>>>>>>>>>>>>        // Item.Units_Recr
46232>>>>>>>>>>>>>
46232>>>>>>>>>>>>>        // Item.Witemkat_Code
46232>>>>>>>>>>>>>
46232>>>>>>>>>>>>>        // Item.Witemkat_Recr
46232>>>>>>>>>>>>>
46232>>>>>>>>>>>>>        // Item.Item_Code
46232>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
46233>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
46234>>>>>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
46235>>>>>>>>>>>>>
46235>>>>>>>>>>>>>        // Item.Item_Rec0
46235>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
46236>>>>>>>>>>>>>
46236>>>>>>>>>>>>>        // Item.Item_Descr
46236>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
46237>>>>>>>>>>>>>
46237>>>>>>>>>>>>>        // Item.Item_Recr
46237>>>>>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
46238>>>>>>>>>>>>>
46238>>>>>>>>>>>>>        // Item.Fpa_Pososto
46238>>>>>>>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
46239>>>>>>>>>>>>>
46239>>>>>>>>>>>>>        // Item.Item_Qual
46239>>>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
46240>>>>>>>>>>>>>
46240>>>>>>>>>>>>>        // Item.Wapokat_Code
46240>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
46241>>>>>>>>>>>>>
46241>>>>>>>>>>>>>        // Item.Item_Analysh
46241>>>>>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
46242>>>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Item_Orio
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Codeglpol
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Codeglago
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Link1
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Link2
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Group
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        // Item.Sap
46243>>>>>>>>>>>>>
46243>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46243>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46244>>>>>>>>>>>>>
46244>>>>>>>>>>>>>    // Field_Defaults:
46244>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46244>>>>>>>>>>>>>
46244>>>>>>>>>>>>>    Procedure Field_Defaults
46245>>>>>>>>>>>>>        Forward Send Field_Defaults
46247>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46247>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46247>>>>>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
46248>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46248>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46249>>>>>>>>>>>>>
46249>>>>>>>>>>>>>End_Class    // Item_DataDictionary
46250>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46250>>>>>>>>>>>>>
46250>>>>>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
46250>>>>>>>>>>>>>>>//AB/ Project SL22s:ITEM
46250>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46250>>>>>>>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
46250>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>// Project Object Structure
46250>>>>>>>>>>>>>>>//   SL22s is a dbModalPanel
46250>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
46250>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
46250>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
46250>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
46250>>>>>>>>>>>>>>>//     oSelList is a dbListSub
46250>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46250>>>>>>>>>>>>>>>//     ocode is a FormSub
46250>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46250>>>>>>>>>>>>>>>//     operi is a FormSub
46250>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
46250>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
46250>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
46250>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46250>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46250>>>>>>>>>>>>>>>//     ocodekat is a FormSub
46250>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46250>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46250>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>// Register all objects
46250>>>>>>>>>>>>>>>Register_Object ButtonSub1
46250>>>>>>>>>>>>>>>Register_Object Fpa_DD
46250>>>>>>>>>>>>>>>Register_Object Item_DD
46250>>>>>>>>>>>>>>>Register_Object oCancel_bn
46250>>>>>>>>>>>>>>>Register_Object ocode
46250>>>>>>>>>>>>>>>Register_Object ocodekat
46250>>>>>>>>>>>>>>>Register_Object oOK_bn
46250>>>>>>>>>>>>>>>Register_Object operi
46250>>>>>>>>>>>>>>>Register_Object oSearch_bn
46250>>>>>>>>>>>>>>>Register_Object oSelList
46250>>>>>>>>>>>>>>>Register_Object Radio1
46250>>>>>>>>>>>>>>>Register_Object Radio2
46250>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
46250>>>>>>>>>>>>>>>Register_Object SL22s
46250>>>>>>>>>>>>>>>Register_Object TextBoxSub1
46250>>>>>>>>>>>>>>>Register_Object TextBoxSub2
46250>>>>>>>>>>>>>>>Register_Object TextBoxSub3
46250>>>>>>>>>>>>>>>Register_Object Units_DD
46250>>>>>>>>>>>>>>>Register_Object Witemkat_DD
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>    //AB-StoreTopStart
46250>>>>>>>>>>>>>>>                                
46250>>>>>>>>>>>>>>>                                
46250>>>>>>>>>>>>>>>    //AB-StoreTopEnd
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>    //AB-IgnoreStart
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
46250>>>>>>>>>>>>>>>    Use dbList.Sub
46250>>>>>>>>>>>>>>>    Use Txtbox.Sub
46250>>>>>>>>>>>>>>>    Use Form.Sub
46250>>>>>>>>>>>>>>>    Use Rgroup.Sub
46250>>>>>>>>>>>>>>>    Use Radio.Sub
46250>>>>>>>>>>>>>>>    Use Button.Sub
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>    Use WITEMKAT.DD
46250>>>>>>>>>>>>>>>    Use UNITS.DD
46250>>>>>>>>>>>>>>>    Use FPA.DD
46250>>>>>>>>>>>>>>>    Use ITEM.DD
46250>>>>>>>>>>>>>>>    
46250>>>>>>>>>>>>>>>    //AB-IgnoreEnd
46250>>>>>>>>>>>>>>>
46250>>>>>>>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
46269>>>>>>>>>>>>>>>
46269>>>>>>>>>>>>>>>        //AB-StoreTopStart
46269>>>>>>>>>>>>>>>        Property String     pscode                  ''
46271>>>>>>>>>>>>>>>        Property String     psperi                  ''
46273>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
46275>>>>>>>>>>>>>>>        Property String     pscodekat               ''
46277>>>>>>>>>>>>>>>        
46277>>>>>>>>>>>>>>>        //AB-StoreTopEnd
46277>>>>>>>>>>>>>>>
46277>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
46278>>>>>>>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
46279>>>>>>>>>>>>>>>        Set Size to 270 484
46280>>>>>>>>>>>>>>>        Set Location to 5 7
46281>>>>>>>>>>>>>>>
46281>>>>>>>>>>>>>>>        //AB-DDOStart
46281>>>>>>>>>>>>>>>
46281>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
46283>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
46284>>>>>>>>>>>>>>>
46284>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
46286>>>>>>>>>>>>>>>        End_Object    // Units_DD
46287>>>>>>>>>>>>>>>
46287>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
46289>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
46290>>>>>>>>>>>>>>>
46290>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
46292>>>>>>>>>>>>>>>
46292>>>>>>>>>>>>>>>            //AB-StoreTopStart
46292>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
46294>>>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
46295>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
46295>>>>>>>>>>>>>>>                       Move 0 to rVal
46296>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
46297>>>>>>>>>>>>>>>                       Get psperi to lsperi
46298>>>>>>>>>>>>>>>                       Get pscode to lscode
46299>>>>>>>>>>>>>>>                       Get pscodekat to lscodekat
46300>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46301>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46302>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
46302>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
46304>>>>>>>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
46306>>>>>>>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
46309>>>>>>>>>>>>>>>                           End
46309>>>>>>>>>>>>>>>>
46309>>>>>>>>>>>>>>>            
46309>>>>>>>>>>>>>>>                       End
46309>>>>>>>>>>>>>>>>
46309>>>>>>>>>>>>>>>                       Else Begin
46310>>>>>>>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
46312>>>>>>>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
46315>>>>>>>>>>>>>>>                           End
46315>>>>>>>>>>>>>>>>
46315>>>>>>>>>>>>>>>            
46315>>>>>>>>>>>>>>>                       End
46315>>>>>>>>>>>>>>>>
46315>>>>>>>>>>>>>>>                       Function_Return rVal
46316>>>>>>>>>>>>>>>                   End_Function
46317>>>>>>>>>>>>>>>            
46317>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
46319>>>>>>>>>>>>>>>                       String lsperi
46320>>>>>>>>>>>>>>>                       Get psperi to lsperi
46321>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46322>>>>>>>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
46323>>>>>>>>>>>>>>>                   End_Function
46324>>>>>>>>>>>>>>>            
46324>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
46326>>>>>>>>>>>>>>>                       String lscode lscodekat
46327>>>>>>>>>>>>>>>                       Get pscode to lscode
46328>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46329>>>>>>>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
46330>>>>>>>>>>>>>>>                   End_Function
46331>>>>>>>>>>>>>>>            
46331>>>>>>>>>>>>>>>            //AB-StoreTopEnd
46331>>>>>>>>>>>>>>>
46331>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
46332>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
46333>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
46334>>>>>>>>>>>>>>>
46334>>>>>>>>>>>>>>>            //AB-StoreStart
46334>>>>>>>>>>>>>>>                                                                                                
46334>>>>>>>>>>>>>>>                                                                                                
46334>>>>>>>>>>>>>>>                                                                                                
46334>>>>>>>>>>>>>>>            Begin_Constraints
46336>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
46337>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
46337>>>>>>>>>>>>>>>             //  Get FragmaItem  to lsValue
46337>>>>>>>>>>>>>>>            
46337>>>>>>>>>>>>>>>                   Get psperi  to lsperi
46338>>>>>>>>>>>>>>>                   Get pscode  to lscode
46339>>>>>>>>>>>>>>>                   Get pscodekat  to lscodekat
46340>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
46341>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
46342>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
46343>>>>>>>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
46344>>>>>>>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
46346>>>>>>>>>>>>>>>                        set ordering to 5
46347>>>>>>>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
46348>>>>>>>>>>>>>>>                   end
46348>>>>>>>>>>>>>>>>
46348>>>>>>>>>>>>>>>                   Else Begin
46349>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
46351>>>>>>>>>>>>>>>                        If (lsperi<>'') begin
46353>>>>>>>>>>>>>>>                            set ordering to 3
46354>>>>>>>>>>>>>>>                            Constrain item.item_descr Contains lsperi
46356>>>>>>>>>>>>>>>                        end
46356>>>>>>>>>>>>>>>>
46356>>>>>>>>>>>>>>>                        Else If (lscode<>'') begin
46359>>>>>>>>>>>>>>>                            set ordering to 5
46360>>>>>>>>>>>>>>>                            Constrain item.item_code Contains lscode
46362>>>>>>>>>>>>>>>                        end
46362>>>>>>>>>>>>>>>>
46362>>>>>>>>>>>>>>>                      End
46362>>>>>>>>>>>>>>>>
46362>>>>>>>>>>>>>>>                      Else Begin
46363>>>>>>>>>>>>>>>                           If (lsperi<>'') begin
46365>>>>>>>>>>>>>>>                                set ordering to 3
46366>>>>>>>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
46367>>>>>>>>>>>>>>>                           end
46367>>>>>>>>>>>>>>>>
46367>>>>>>>>>>>>>>>                           Else If (lscode<>'') begin
46370>>>>>>>>>>>>>>>                                set ordering to 5
46371>>>>>>>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
46372>>>>>>>>>>>>>>>                           end
46372>>>>>>>>>>>>>>>>
46372>>>>>>>>>>>>>>>                      End
46372>>>>>>>>>>>>>>>>
46372>>>>>>>>>>>>>>>                   End
46372>>>>>>>>>>>>>>>>
46372>>>>>>>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
46376>>>>>>>>>>>>>>>            
46376>>>>>>>>>>>>>>>            End_Constraints
46379>>>>>>>>>>>>>>>            
46379>>>>>>>>>>>>>>>            
46379>>>>>>>>>>>>>>>            
46379>>>>>>>>>>>>>>>            
46379>>>>>>>>>>>>>>>            //AB-StoreEnd
46379>>>>>>>>>>>>>>>
46379>>>>>>>>>>>>>>>        End_Object    // Item_DD
46380>>>>>>>>>>>>>>>
46380>>>>>>>>>>>>>>>        Set Main_DD to (Item_DD(self))
46381>>>>>>>>>>>>>>>        Set Server to (Item_DD(self))
46382>>>>>>>>>>>>>>>
46382>>>>>>>>>>>>>>>        //AB-DDOEnd
46382>>>>>>>>>>>>>>>
46382>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
46384>>>>>>>>>>>>>>>            Set Main_File to Item.File_Number
46385>>>>>>>>>>>>>>>            Set Ordering to 5
46386>>>>>>>>>>>>>>>            Set Size to 190 475
46387>>>>>>>>>>>>>>>            Set Location to -1 2
46388>>>>>>>>>>>>>>>            Set Color to 14280447
46389>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
46390>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
46391>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
46392>>>>>>>>>>>>>>>
46392>>>>>>>>>>>>>>>            Begin_Row
46395>>>>>>>>>>>>>>>                Entry_Item Item.Item_code
46396>>>>>>>>>>>>>>>                Entry_Item Item.Item_descr
46397>>>>>>>>>>>>>>>                Entry_Item Item.Witemkat_code
46398>>>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
46399>>>>>>>>>>>>>>>                Entry_Item Item.Item_qual
46400>>>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
46401>>>>>>>>>>>>>>>            End_Row
46406>>>>>>>>>>>>>>>
46406>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
46407>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
46408>>>>>>>>>>>>>>>            
46408>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
46409>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46410>>>>>>>>>>>>>>>            
46410>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
46411>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
46412>>>>>>>>>>>>>>>            
46412>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
46413>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
46414>>>>>>>>>>>>>>>            
46414>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
46415>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
46416>>>>>>>>>>>>>>>            
46416>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
46417>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
46418>>>>>>>>>>>>>>>            
46418>>>>>>>>>>>>>>>
46418>>>>>>>>>>>>>>>            //AB-StoreStart
46418>>>>>>>>>>>>>>>            
46418>>>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
46420>>>>>>>>>>>>>>>            
46420>>>>>>>>>>>>>>>            set export_item_state to true
46421>>>>>>>>>>>>>>>            
46421>>>>>>>>>>>>>>>            Procedure Activating
46423>>>>>>>>>>>>>>>               Forward send Activating
46425>>>>>>>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
46426>>>>>>>>>>>>>>>            End_Procedure
46427>>>>>>>>>>>>>>>            
46427>>>>>>>>>>>>>>>            Function Child_Exiting Integer iWhere Returns Integer
46429>>>>>>>>>>>>>>>                local integer Rval
46430>>>>>>>>>>>>>>>                Forward get Child_Exiting iWhere  to Rval
46432>>>>>>>>>>>>>>>                set value of (ocode   (self))   to ''
46433>>>>>>>>>>>>>>>                set value of (operi   (self))   to ''
46434>>>>>>>>>>>>>>>                set value of (ocodekat(self))   to ''
46435>>>>>>>>>>>>>>>                set psperi                      to ''
46436>>>>>>>>>>>>>>>                set pscode                      to ''
46437>>>>>>>>>>>>>>>                set pscodekat                   to ''
46438>>>>>>>>>>>>>>>                function_return Rval // if non-zero do not enter
46439>>>>>>>>>>>>>>>            End_function
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            
46440>>>>>>>>>>>>>>>            //AB-StoreEnd
46440>>>>>>>>>>>>>>>
46440>>>>>>>>>>>>>>>        End_Object    // oSelList
46441>>>>>>>>>>>>>>>
46441>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
46443>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
46444>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46445>>>>>>>>>>>>>>>            Set Location to 192 6
46446>>>>>>>>>>>>>>>            Set Size to 13 78
46447>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
46448>>>>>>>>>>>>>>>
46448>>>>>>>>>>>>>>>        Object ocode is a FormSub
46450>>>>>>>>>>>>>>>            Set Size to 13 197
46451>>>>>>>>>>>>>>>            Set Location to 192 79
46452>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46453>>>>>>>>>>>>>>>
46453>>>>>>>>>>>>>>>            //AB-StoreStart
46453>>>>>>>>>>>>>>>                                                
46453>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46455>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46456>>>>>>>>>>>>>>>            End_Procedure
46457>>>>>>>>>>>>>>>            
46457>>>>>>>>>>>>>>>            
46457>>>>>>>>>>>>>>>            
46457>>>>>>>>>>>>>>>            
46457>>>>>>>>>>>>>>>            //AB-StoreEnd
46457>>>>>>>>>>>>>>>
46457>>>>>>>>>>>>>>>        End_Object    // ocode
46458>>>>>>>>>>>>>>>
46458>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
46460>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
46461>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46462>>>>>>>>>>>>>>>            Set Location to 207 6
46463>>>>>>>>>>>>>>>            Set Size to 13 83
46464>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
46465>>>>>>>>>>>>>>>
46465>>>>>>>>>>>>>>>        Object operi is a FormSub
46467>>>>>>>>>>>>>>>            Set Size to 13 197
46468>>>>>>>>>>>>>>>            Set Location to 207 79
46469>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46470>>>>>>>>>>>>>>>
46470>>>>>>>>>>>>>>>            //AB-StoreStart
46470>>>>>>>>>>>>>>>                                                
46470>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46472>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46473>>>>>>>>>>>>>>>            End_Procedure
46474>>>>>>>>>>>>>>>            
46474>>>>>>>>>>>>>>>            
46474>>>>>>>>>>>>>>>            
46474>>>>>>>>>>>>>>>            
46474>>>>>>>>>>>>>>>            //AB-StoreEnd
46474>>>>>>>>>>>>>>>
46474>>>>>>>>>>>>>>>        End_Object    // operi
46475>>>>>>>>>>>>>>>
46475>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
46477>>>>>>>>>>>>>>>            Set Size to 32 77
46478>>>>>>>>>>>>>>>            Set Location to 193 277
46479>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
46481>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
46482>>>>>>>>>>>>>>>                Set Size to 10 53
46483>>>>>>>>>>>>>>>                Set Location to 7 5
46484>>>>>>>>>>>>>>>            End_Object    // Radio1
46485>>>>>>>>>>>>>>>
46485>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
46487>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
46488>>>>>>>>>>>>>>>                Set Size to 10 51
46489>>>>>>>>>>>>>>>                Set Location to 21 5
46490>>>>>>>>>>>>>>>            End_Object    // Radio2
46491>>>>>>>>>>>>>>>
46491>>>>>>>>>>>>>>>
46491>>>>>>>>>>>>>>>            //AB-StoreStart
46491>>>>>>>>>>>>>>>                                                
46491>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
46493>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
46494>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46495>>>>>>>>>>>>>>>            End_Procedure
46496>>>>>>>>>>>>>>>            
46496>>>>>>>>>>>>>>>            
46496>>>>>>>>>>>>>>>            
46496>>>>>>>>>>>>>>>            
46496>>>>>>>>>>>>>>>            //AB-StoreEnd
46496>>>>>>>>>>>>>>>
46496>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
46497>>>>>>>>>>>>>>>
46497>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
46499>>>>>>>>>>>>>>>            Set Label to "Search"
46500>>>>>>>>>>>>>>>            Set Size to 28 37
46501>>>>>>>>>>>>>>>            Set Location to 198 357
46502>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
46503>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
46504>>>>>>>>>>>>>>>
46504>>>>>>>>>>>>>>>            //AB-StoreStart
46504>>>>>>>>>>>>>>>                                                                                                
46504>>>>>>>>>>>>>>>            Set Visible_State to False
46505>>>>>>>>>>>>>>>            
46505>>>>>>>>>>>>>>>            Procedure OnClick
46507>>>>>>>>>>>>>>>                Forward Send OnClick
46509>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
46510>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
46511>>>>>>>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
46512>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
46513>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
46514>>>>>>>>>>>>>>>            End_Procedure // OnClick
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            
46515>>>>>>>>>>>>>>>            //AB-StoreEnd
46515>>>>>>>>>>>>>>>
46515>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
46516>>>>>>>>>>>>>>>
46516>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
46518>>>>>>>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
46519>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46520>>>>>>>>>>>>>>>            Set Location to 221 5
46521>>>>>>>>>>>>>>>            Set Size to 13 78
46522>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
46523>>>>>>>>>>>>>>>
46523>>>>>>>>>>>>>>>        Object ocodekat is a FormSub
46525>>>>>>>>>>>>>>>            Set Size to 13 197
46526>>>>>>>>>>>>>>>            Set Location to 221 78
46527>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46528>>>>>>>>>>>>>>>
46528>>>>>>>>>>>>>>>            //AB-StoreStart
46528>>>>>>>>>>>>>>>                                                
46528>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46530>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
46531>>>>>>>>>>>>>>>            End_Procedure
46532>>>>>>>>>>>>>>>            
46532>>>>>>>>>>>>>>>            
46532>>>>>>>>>>>>>>>            
46532>>>>>>>>>>>>>>>            //AB-StoreEnd
46532>>>>>>>>>>>>>>>
46532>>>>>>>>>>>>>>>        End_Object    // ocodekat
46533>>>>>>>>>>>>>>>
46533>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46535>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46536>>>>>>>>>>>>>>>            Set Location to 237 316
46537>>>>>>>>>>>>>>>
46537>>>>>>>>>>>>>>>            //AB-StoreStart
46537>>>>>>>>>>>>>>>            Procedure OnClick
46539>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46540>>>>>>>>>>>>>>>            End_Procedure
46541>>>>>>>>>>>>>>>            //AB-StoreEnd
46541>>>>>>>>>>>>>>>
46541>>>>>>>>>>>>>>>        End_Object    // oOK_bn
46542>>>>>>>>>>>>>>>
46542>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46544>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46545>>>>>>>>>>>>>>>            Set Location to 237 371
46546>>>>>>>>>>>>>>>
46546>>>>>>>>>>>>>>>            //AB-StoreStart
46546>>>>>>>>>>>>>>>            Procedure OnClick
46548>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46549>>>>>>>>>>>>>>>            End_Procedure
46550>>>>>>>>>>>>>>>            //AB-StoreEnd
46550>>>>>>>>>>>>>>>
46550>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
46551>>>>>>>>>>>>>>>
46551>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46553>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
46554>>>>>>>>>>>>>>>            Set Location to 237 426
46555>>>>>>>>>>>>>>>
46555>>>>>>>>>>>>>>>            //AB-StoreStart
46555>>>>>>>>>>>>>>>            Procedure OnClick
46557>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46558>>>>>>>>>>>>>>>            End_Procedure
46559>>>>>>>>>>>>>>>            //AB-StoreEnd
46559>>>>>>>>>>>>>>>
46559>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
46560>>>>>>>>>>>>>>>
46560>>>>>>>>>>>>>>>
46560>>>>>>>>>>>>>>>        //AB-StoreStart
46560>>>>>>>>>>>>>>>                
46560>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
46561>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
46562>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
46563>>>>>>>>>>>>>>>        
46563>>>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        
46564>>>>>>>>>>>>>>>        //AB-StoreEnd
46564>>>>>>>>>>>>>>>
46564>>>>>>>>>>>>>>>    CD_End_Object    // SL22s
46566>>>>>>>>>>>>>>>>
46566>>>>>>>>>>>>>>>
46566>>>>>>>>>>>>>>>
46566>>>>>>>>>>>>>>>    //AB-StoreStart
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>                                
46566>>>>>>>>>>>>>>>    //AB-StoreEnd
46566>>>>>>>>>>>>>>>
46566>>>>>>>>>>>>>>>//AB/     End_Object    // prj
46566>>>>>>>>>>>>>Use sl022.SL         // sl022
46566>>>>>>>>>>>>>
46566>>>>>>>>>>>>>//DDB-Selection-pkg-End
46566>>>>>>>>>>>>>//DDB-FileEnd
46566>>>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
46566>>>>>>>>>>>>>//DDB-FileStart
46566>>>>>>>>>>>>>//DDB-HeaderStart
46566>>>>>>>>>>>>>
46566>>>>>>>>>>>>>// File Name : WITEMX.DD
46566>>>>>>>>>>>>>// Class Name: Witemx_DataDictionary
46566>>>>>>>>>>>>>// Revision  : 77
46566>>>>>>>>>>>>>// Version   : 2
46566>>>>>>>>>>>>>
46566>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46566>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46566>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46566>>>>>>>>>>>>>
46566>>>>>>>>>>>>>Open Witemx
46568>>>>>>>>>>>>>Open Witemxt
46570>>>>>>>>>>>>>Open Pmoves
46572>>>>>>>>>>>>>Open Wam
46574>>>>>>>>>>>>>Open Pmovesl
46576>>>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
46578>>>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
46580>>>>>>>>>>>>>Open Wcmoves
46582>>>>>>>>>>>>>Open Item
46584>>>>>>>>>>>>>Open Sysrecw
46586>>>>>>>>>>>>>Open Syscurxr
46588>>>>>>>>>>>>>
46588>>>>>>>>>>>>>//DDB-HeaderEnd
46588>>>>>>>>>>>>>//DDB-SelectionStart
46588>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
46588>>>>>>>>>>>>>Register_Object SL17
46588>>>>>>>>>>>>>//DDB-SelectionEnd
46588>>>>>>>>>>>>>
46588>>>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
46589>>>>>>>>>>>>>
46589>>>>>>>>>>>>>    Procedure Construct_Object
46590>>>>>>>>>>>>>        Forward Send Construct_Object
46592>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
46593>>>>>>>>>>>>>    End_Procedure //construct_object
46594>>>>>>>>>>>>>
46594>>>>>>>>>>>>>    Procedure OnConstrain
46595>>>>>>>>>>>>>        Forward Send OnConstrain
46597>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
46599>>>>>>>>>>>>>        End
46599>>>>>>>>>>>>>>
46599>>>>>>>>>>>>>        Else Begin
46600>>>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
46602>>>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
46604>>>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
46606>>>>>>>>>>>>>        End
46606>>>>>>>>>>>>>>
46606>>>>>>>>>>>>>    End_Procedure
46607>>>>>>>>>>>>>
46607>>>>>>>>>>>>>    Procedure Save_Main_File
46608>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46610>>>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
46613>>>>>>>>>>>>>        End
46613>>>>>>>>>>>>>>
46613>>>>>>>>>>>>>        Forward Send Save_Main_File
46615>>>>>>>>>>>>>    End_Procedure
46616>>>>>>>>>>>>>
46616>>>>>>>>>>>>>    // Update:
46616>>>>>>>>>>>>>    Procedure Update
46617>>>>>>>>>>>>>        Forward Send Update
46619>>>>>>>>>>>>>        // Insert Code Here
46619>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
46620>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
46621>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
46622>>>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
46623>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
46624>>>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
46625>>>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
46626>>>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
46627>>>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
46628>>>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
46629>>>>>>>>>>>>>        Move Item.link1             to witemx.link1
46630>>>>>>>>>>>>>        move Item.link2             to witemx.link2
46631>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
46632>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
46633>>>>>>>>>>>>>    End_Procedure   // Update
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>    Procedure Backout
46635>>>>>>>>>>>>>        Forward Send Backout
46637>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
46638>>>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
46639>>>>>>>>>>>>>    End_Procedure   // Update
46640>>>>>>>>>>>>>
46640>>>>>>>>>>>>>    Procedure Creating
46641>>>>>>>>>>>>>        Forward Send Creating
46643>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
46644>>>>>>>>>>>>>    End_Procedure   // Creating
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>    // Define_Fields:
46645>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>    Procedure Define_Fields
46646>>>>>>>>>>>>>        Forward Send Define_Fields
46648>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46648>>>>>>>>>>>>>        //DDB-DefineFieldStart
46648>>>>>>>>>>>>>
46648>>>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
46649>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46650>>>>>>>>>>>>>
46650>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46651>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46652>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46653>>>>>>>>>>>>>
46653>>>>>>>>>>>>>        // Child (Client) file structure................
46653>>>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
46654>>>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
46655>>>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
46656>>>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
46657>>>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
46658>>>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
46659>>>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
46660>>>>>>>>>>>>>
46660>>>>>>>>>>>>>        // Parent (Server) file structure...............
46660>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
46661>>>>>>>>>>>>>
46661>>>>>>>>>>>>>        // External (System) file structure.............
46661>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46662>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46663>>>>>>>>>>>>>
46663>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Field-based properties.......................
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Company_Code
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Branch_Code
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Year_Year
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Units_Code
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Witemkat_Code
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Item_Code
46666>>>>>>>>>>>>>
46666>>>>>>>>>>>>>        // Witemx.Witemx_Code
46666>>>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
46667>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
46668>>>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
46669>>>>>>>>>>>>>
46669>>>>>>>>>>>>>        // Witemx.Witemx_Recr
46669>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
46670>>>>>>>>>>>>>
46670>>>>>>>>>>>>>        // Witemx.Year_Recr
46670>>>>>>>>>>>>>
46670>>>>>>>>>>>>>        // Witemx.Item_Recr
46670>>>>>>>>>>>>>
46670>>>>>>>>>>>>>        // Witemx.Witemx_Descr
46670>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Witemx_Rec0
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Qty_Xre
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Qty_Pis
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Axia_Xre
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Axia_Pis
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Mesosta_Xre
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Mesosta_Pis
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Link1
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        // Witemx.Link2
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46671>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46672>>>>>>>>>>>>>
46672>>>>>>>>>>>>>    // Field_Defaults:
46672>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46672>>>>>>>>>>>>>
46672>>>>>>>>>>>>>    Procedure Field_Defaults
46673>>>>>>>>>>>>>        Forward Send Field_Defaults
46675>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46675>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46675>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46675>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46676>>>>>>>>>>>>>
46676>>>>>>>>>>>>>End_Class    // Witemx_DataDictionary
46677>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46677>>>>>>>>>>>>>
46677>>>>>>>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
46677>>>>>>>>>>>>>>>//AB/ Project SL17:witemx
46677>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46677>>>>>>>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
46677>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
46677>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>// Project Object Structure
46677>>>>>>>>>>>>>>>//   SL17 is a dbModalPanelSub
46677>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
46677>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
46677>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
46677>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
46677>>>>>>>>>>>>>>>//     Witemx_DD is a DataDictionary
46677>>>>>>>>>>>>>>>//     oSelList is a dbListSub
46677>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46677>>>>>>>>>>>>>>>//     ocode is a FormSub
46677>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46677>>>>>>>>>>>>>>>//     operi is a FormSub
46677>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
46677>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
46677>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
46677>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46677>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46677>>>>>>>>>>>>>>>//     ocodekat is a FormSub
46677>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46677>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46677>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46677>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
46677>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>// Register all objects
46677>>>>>>>>>>>>>>>Register_Object ButtonSub1
46677>>>>>>>>>>>>>>>Register_Object btnwitemcl
46677>>>>>>>>>>>>>>>Register_Object Fpa_DD
46677>>>>>>>>>>>>>>>Register_Object Item_DD
46677>>>>>>>>>>>>>>>Register_Object oCancel_bn
46677>>>>>>>>>>>>>>>Register_Object ocode
46677>>>>>>>>>>>>>>>Register_Object ocodekat
46677>>>>>>>>>>>>>>>Register_Object oOK_bn
46677>>>>>>>>>>>>>>>Register_Object operi
46677>>>>>>>>>>>>>>>Register_Object oSearch_bn
46677>>>>>>>>>>>>>>>Register_Object oSelList
46677>>>>>>>>>>>>>>>Register_Object Radio1
46677>>>>>>>>>>>>>>>Register_Object Radio2
46677>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
46677>>>>>>>>>>>>>>>Register_Object SL17
46677>>>>>>>>>>>>>>>Register_Object TextBoxSub1
46677>>>>>>>>>>>>>>>Register_Object TextBoxSub2
46677>>>>>>>>>>>>>>>Register_Object TextBoxSub3
46677>>>>>>>>>>>>>>>Register_Object Units_DD
46677>>>>>>>>>>>>>>>Register_Object Witemkat_DD
46677>>>>>>>>>>>>>>>Register_Object Witemx_DD
46677>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>    //AB-StoreTopStart
46677>>>>>>>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
46677>>>>>>>>>>>>>>>>>//AB/ Project dg186
46677>>>>>>>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
46677>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
46677>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
46677>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46677>>>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>>>// Project Object Structure
46677>>>>>>>>>>>>>>>>>//   dg186 is a dbModalPanelSub
46677>>>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
46677>>>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
46677>>>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
46677>>>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
46677>>>>>>>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
46677>>>>>>>>>>>>>>>>>//     The_Table is a dbGrid
46677>>>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
46677>>>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
46677>>>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
46677>>>>>>>>>>>>>>>>>//     ocode is a FormSub
46677>>>>>>>>>>>>>>>>>//     operi is a FormSub
46677>>>>>>>>>>>>>>>>>//     ocodeprom is a FormSub
46677>>>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
46677>>>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
46677>>>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
46677>>>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
46677>>>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
46677>>>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>>>// Register all objects
46677>>>>>>>>>>>>>>>>>Register_Object ButtonSub1
46677>>>>>>>>>>>>>>>>>Register_Object btnwitemcl
46677>>>>>>>>>>>>>>>>>Register_Object dg186
46677>>>>>>>>>>>>>>>>>Register_Object Fpa_DD
46677>>>>>>>>>>>>>>>>>Register_Object Item_DD
46677>>>>>>>>>>>>>>>>>Register_Object ocode
46677>>>>>>>>>>>>>>>>>Register_Object ocodeprom
46677>>>>>>>>>>>>>>>>>Register_Object operi
46677>>>>>>>>>>>>>>>>>Register_Object Radio1
46677>>>>>>>>>>>>>>>>>Register_Object Radio2
46677>>>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
46677>>>>>>>>>>>>>>>>>Register_Object TextBoxSub1
46677>>>>>>>>>>>>>>>>>Register_Object TextBoxSub2
46677>>>>>>>>>>>>>>>>>Register_Object TextBoxSub3
46677>>>>>>>>>>>>>>>>>Register_Object The_Table
46677>>>>>>>>>>>>>>>>>Register_Object Units_DD
46677>>>>>>>>>>>>>>>>>Register_Object Witemcl_DD
46677>>>>>>>>>>>>>>>>>Register_Object Witemkat_DD
46677>>>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>>>
46677>>>>>>>>>>>>>>>>>    //AB-StoreTopStart
46677>>>>>>>>>>>>>>>>>    open clients
46679>>>>>>>>>>>>>>>>>    use sl17.sl
46679>>>>>>>>>>>>>>>>>    //AB-StoreTopEnd
46679>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
46679>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
46679>>>>>>>>>>>>>>>>>    Use Txtbox.Sub
46679>>>>>>>>>>>>>>>>>    Use Form.Sub
46679>>>>>>>>>>>>>>>>>    Use Rgroup.Sub
46679>>>>>>>>>>>>>>>>>    Use Radio.Sub
46679>>>>>>>>>>>>>>>>>    Use Button.Sub
46679>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>    Use WITEMKAT.DD
46679>>>>>>>>>>>>>>>>>    Use UNITS.DD
46679>>>>>>>>>>>>>>>>>    Use FPA.DD
46679>>>>>>>>>>>>>>>>>    Use ITEM.DD
46679>>>>>>>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
46679>>>>>>>>>>>>>>>>>>>//DDB-FileStart
46679>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
46679>>>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>>>// File Name : WITEMCL.DD
46679>>>>>>>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
46679>>>>>>>>>>>>>>>>>>>// Revision  : 16
46679>>>>>>>>>>>>>>>>>>>// Version   : 2
46679>>>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
46679>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46679>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46679>>>>>>>>>>>>>>>>>>>
46679>>>>>>>>>>>>>>>>>>>Open Witemcl
46681>>>>>>>>>>>>>>>>>>>Open Witemcld
46683>>>>>>>>>>>>>>>>>>>Open Item
46685>>>>>>>>>>>>>>>>>>>Open Sysrecw
46687>>>>>>>>>>>>>>>>>>>
46687>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
46687>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
46687>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
46687>>>>>>>>>>>>>>>>>>>Register_Object SL100
46687>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
46687>>>>>>>>>>>>>>>>>>>
46687>>>>>>>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
46688>>>>>>>>>>>>>>>>>>> 
46688>>>>>>>>>>>>>>>>>>>    // Update:
46688>>>>>>>>>>>>>>>>>>> 
46688>>>>>>>>>>>>>>>>>>>    Procedure Update
46689>>>>>>>>>>>>>>>>>>>        Forward Send Update  
46691>>>>>>>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
46692>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
46693>>>>>>>>>>>>>>>>>>> 
46693>>>>>>>>>>>>>>>>>>>
46693>>>>>>>>>>>>>>>>>>>    // Define_Fields:
46693>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46693>>>>>>>>>>>>>>>>>>>
46693>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
46694>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
46696>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46696>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
46696>>>>>>>>>>>>>>>>>>>
46696>>>>>>>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
46697>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46698>>>>>>>>>>>>>>>>>>>
46698>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46699>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46700>>>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46701>>>>>>>>>>>>>>>>>>>
46701>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
46701>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
46702>>>>>>>>>>>>>>>>>>>
46702>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
46702>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
46703>>>>>>>>>>>>>>>>>>>
46703>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
46703>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46704>>>>>>>>>>>>>>>>>>>
46704>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
46707>>>>>>>>>>>>>>>>>>>
46707>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
46707>>>>>>>>>>>>>>>>>>>
46707>>>>>>>>>>>>>>>>>>>        // Witemcl.Item_Code
46707>>>>>>>>>>>>>>>>>>>
46707>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Code
46707>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
46708>>>>>>>>>>>>>>>>>>>
46708>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
46708>>>>>>>>>>>>>>>>>>>
46708>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Date
46708>>>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
46709>>>>>>>>>>>>>>>>>>>
46709>>>>>>>>>>>>>>>>>>>        // Witemcl.Client_Price
46709>>>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
46710>>>>>>>>>>>>>>>>>>>
46710>>>>>>>>>>>>>>>>>>>        // Witemcl.Item_Descr
46710>>>>>>>>>>>>>>>>>>>
46710>>>>>>>>>>>>>>>>>>>        // Witemcl.Rec0
46710>>>>>>>>>>>>>>>>>>>
46710>>>>>>>>>>>>>>>>>>>        // Witemcl.Is_Client
46710>>>>>>>>>>>>>>>>>>>
46710>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
46710>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
46711>>>>>>>>>>>>>>>>>>>
46711>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
46711>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
46711>>>>>>>>>>>>>>>>>>>
46711>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
46712>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
46714>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
46714>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
46714>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
46714>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
46715>>>>>>>>>>>>>>>>>>>
46715>>>>>>>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
46716>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
46716>>>>>>>>>>>>>>>>>>>
46716>>>>>>>>>>>>>>>>>>>Use sl100.sl         // SL100
46716>>>>>>>>>>>>>>>>>>>
46716>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
46716>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
46716>>>>>>>>>>>>>>>>>    
46716>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
46716>>>>>>>>>>>>>>>>>
46716>>>>>>>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
46718>>>>>>>>>>>>>>>>>
46718>>>>>>>>>>>>>>>>>        //AB-StoreTopStart
46718>>>>>>>>>>>>>>>>>        Function fsclient string code Returns string
46720>>>>>>>>>>>>>>>>>            string name
46721>>>>>>>>>>>>>>>>>            clear clients
46722>>>>>>>>>>>>>>>>>            move code to clients.client_id
46723>>>>>>>>>>>>>>>>>            find eq clients by index.6
46724>>>>>>>>>>>>>>>>>>
46724>>>>>>>>>>>>>>>>>            move clients.client_name to name
46725>>>>>>>>>>>>>>>>>            function_return name
46726>>>>>>>>>>>>>>>>>        end_Function
46727>>>>>>>>>>>>>>>>>        
46727>>>>>>>>>>>>>>>>>        Property String     pscode                  ''
46729>>>>>>>>>>>>>>>>>        Property String     psperi                  ''
46731>>>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
46733>>>>>>>>>>>>>>>>>        Property String     pscodeprom              ''
46735>>>>>>>>>>>>>>>>>        
46735>>>>>>>>>>>>>>>>>        
46735>>>>>>>>>>>>>>>>>        //AB-StoreTopEnd
46735>>>>>>>>>>>>>>>>>
46735>>>>>>>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
46736>>>>>>>>>>>>>>>>>        Set Size to 289 527
46737>>>>>>>>>>>>>>>>>        Set Location to 0 2
46738>>>>>>>>>>>>>>>>>
46738>>>>>>>>>>>>>>>>>        //AB-DDOStart
46738>>>>>>>>>>>>>>>>>
46738>>>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
46740>>>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
46741>>>>>>>>>>>>>>>>>
46741>>>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
46743>>>>>>>>>>>>>>>>>        End_Object    // Units_DD
46744>>>>>>>>>>>>>>>>>
46744>>>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
46746>>>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
46747>>>>>>>>>>>>>>>>>
46747>>>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
46749>>>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
46750>>>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
46751>>>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
46752>>>>>>>>>>>>>>>>>        End_Object    // Item_DD
46753>>>>>>>>>>>>>>>>>
46753>>>>>>>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
46755>>>>>>>>>>>>>>>>>
46755>>>>>>>>>>>>>>>>>            //AB-StoreTopStart
46755>>>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
46757>>>>>>>>>>>>>>>>>                       String lsperi lscode  lscodeprom
46758>>>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
46758>>>>>>>>>>>>>>>>>                       Move 0 to rVal
46759>>>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
46760>>>>>>>>>>>>>>>>>                       Get psperi to lsperi
46761>>>>>>>>>>>>>>>>>                       Get pscode to lscode
46762>>>>>>>>>>>>>>>>>                       Get pscodeprom to lscodeprom
46763>>>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46764>>>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46765>>>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
46765>>>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
46767>>>>>>>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
46769>>>>>>>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
46772>>>>>>>>>>>>>>>>>                           End
46772>>>>>>>>>>>>>>>>>>
46772>>>>>>>>>>>>>>>>>            
46772>>>>>>>>>>>>>>>>>                       End
46772>>>>>>>>>>>>>>>>>>
46772>>>>>>>>>>>>>>>>>                       Else Begin
46773>>>>>>>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
46775>>>>>>>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
46778>>>>>>>>>>>>>>>>>                           End
46778>>>>>>>>>>>>>>>>>>
46778>>>>>>>>>>>>>>>>>            
46778>>>>>>>>>>>>>>>>>                       End
46778>>>>>>>>>>>>>>>>>>
46778>>>>>>>>>>>>>>>>>                       Function_Return rVal
46779>>>>>>>>>>>>>>>>>                   End_Function
46780>>>>>>>>>>>>>>>>>            
46780>>>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
46782>>>>>>>>>>>>>>>>>                       String lsperi
46783>>>>>>>>>>>>>>>>>                       Get psperi to lsperi
46784>>>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
46785>>>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
46786>>>>>>>>>>>>>>>>>                   End_Function
46787>>>>>>>>>>>>>>>>>            
46787>>>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
46789>>>>>>>>>>>>>>>>>                       String lscode lscodeprom
46790>>>>>>>>>>>>>>>>>                       Get pscode to lscode
46791>>>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
46792>>>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
46793>>>>>>>>>>>>>>>>>                   End_Function
46794>>>>>>>>>>>>>>>>>            
46794>>>>>>>>>>>>>>>>>            //AB-StoreTopEnd
46794>>>>>>>>>>>>>>>>>
46794>>>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
46795>>>>>>>>>>>>>>>>>
46795>>>>>>>>>>>>>>>>>            //AB-StoreStart
46795>>>>>>>>>>>>>>>>>                                                                
46795>>>>>>>>>>>>>>>>>                                                                
46795>>>>>>>>>>>>>>>>>            Begin_Constraints
46797>>>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
46798>>>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
46798>>>>>>>>>>>>>>>>>                   Get psperi  to lsperi
46799>>>>>>>>>>>>>>>>>                   Get pscode  to lscode
46800>>>>>>>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
46801>>>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
46802>>>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
46803>>>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
46804>>>>>>>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
46805>>>>>>>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
46808>>>>>>>>>>>>>>>>>                   Else Begin
46809>>>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
46811>>>>>>>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
46815>>>>>>>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
46820>>>>>>>>>>>>>>>>>                      End
46820>>>>>>>>>>>>>>>>>>
46820>>>>>>>>>>>>>>>>>                   Else Begin
46821>>>>>>>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
46824>>>>>>>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
46828>>>>>>>>>>>>>>>>>                       End
46828>>>>>>>>>>>>>>>>>>
46828>>>>>>>>>>>>>>>>>                   End
46828>>>>>>>>>>>>>>>>>>
46828>>>>>>>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
46832>>>>>>>>>>>>>>>>>            
46832>>>>>>>>>>>>>>>>>            End_Constraints
46835>>>>>>>>>>>>>>>>>            
46835>>>>>>>>>>>>>>>>>            
46835>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46835>>>>>>>>>>>>>>>>>
46835>>>>>>>>>>>>>>>>>        End_Object    // Witemcl_DD
46836>>>>>>>>>>>>>>>>>
46836>>>>>>>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
46837>>>>>>>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
46838>>>>>>>>>>>>>>>>>
46838>>>>>>>>>>>>>>>>>        //AB-DDOEnd
46838>>>>>>>>>>>>>>>>>
46838>>>>>>>>>>>>>>>>>        Object The_Table is a dbGrid
46840>>>>>>>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
46841>>>>>>>>>>>>>>>>>            Set Size to 201 519
46842>>>>>>>>>>>>>>>>>            Set Location to 3 2
46843>>>>>>>>>>>>>>>>>            Set Color to 14280447
46844>>>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
46845>>>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
46846>>>>>>>>>>>>>>>>>            Set Wrap_State to TRUE
46847>>>>>>>>>>>>>>>>>
46847>>>>>>>>>>>>>>>>>            Begin_Row
46850>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_code
46851>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
46852>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
46853>>>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_code
46854>>>>>>>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
46855>>>>>>>>>>>>>>>>>            End_Row
46860>>>>>>>>>>>>>>>>>
46860>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 100
46861>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
46862>>>>>>>>>>>>>>>>>            
46862>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 100
46863>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
46864>>>>>>>>>>>>>>>>>            
46864>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 200
46865>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
46866>>>>>>>>>>>>>>>>>            
46866>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 0
46867>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to ""
46868>>>>>>>>>>>>>>>>>            
46868>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 111
46869>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
46870>>>>>>>>>>>>>>>>>            
46870>>>>>>>>>>>>>>>>>
46870>>>>>>>>>>>>>>>>>            //AB-StoreStart
46870>>>>>>>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
46871>>>>>>>>>>>>>>>>>            //set read_only_state to true
46871>>>>>>>>>>>>>>>>>            set no_create_state to true
46872>>>>>>>>>>>>>>>>>            set no_delete_state to true
46873>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46873>>>>>>>>>>>>>>>>>
46873>>>>>>>>>>>>>>>>>        End_Object    // The_Table
46874>>>>>>>>>>>>>>>>>
46874>>>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
46876>>>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
46877>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46878>>>>>>>>>>>>>>>>>            Set Location to 208 5
46879>>>>>>>>>>>>>>>>>            Set Size to 13 78
46880>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
46881>>>>>>>>>>>>>>>>>
46881>>>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
46883>>>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
46884>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46885>>>>>>>>>>>>>>>>>            Set Location to 223 5
46886>>>>>>>>>>>>>>>>>            Set Size to 13 83
46887>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
46888>>>>>>>>>>>>>>>>>
46888>>>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
46890>>>>>>>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
46891>>>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
46892>>>>>>>>>>>>>>>>>            Set Location to 237 5
46893>>>>>>>>>>>>>>>>>            Set Size to 13 78
46894>>>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
46895>>>>>>>>>>>>>>>>>
46895>>>>>>>>>>>>>>>>>        Object ocode is a FormSub
46897>>>>>>>>>>>>>>>>>            Set Size to 13 197
46898>>>>>>>>>>>>>>>>>            Set Location to 209 91
46899>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46900>>>>>>>>>>>>>>>>>
46900>>>>>>>>>>>>>>>>>            //AB-StoreStart
46900>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
46900>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46902>>>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
46903>>>>>>>>>>>>>>>>>            End_Procedure
46904>>>>>>>>>>>>>>>>>            
46904>>>>>>>>>>>>>>>>>            
46904>>>>>>>>>>>>>>>>>            
46904>>>>>>>>>>>>>>>>>            
46904>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46904>>>>>>>>>>>>>>>>>
46904>>>>>>>>>>>>>>>>>        End_Object    // ocode
46905>>>>>>>>>>>>>>>>>
46905>>>>>>>>>>>>>>>>>        Object operi is a FormSub
46907>>>>>>>>>>>>>>>>>            Set Size to 13 197
46908>>>>>>>>>>>>>>>>>            Set Location to 223 91
46909>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46910>>>>>>>>>>>>>>>>>
46910>>>>>>>>>>>>>>>>>            //AB-StoreStart
46910>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
46910>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46912>>>>>>>>>>>>>>>>>              Send KeyAction to ButtonSub1
46913>>>>>>>>>>>>>>>>>            End_Procedure
46914>>>>>>>>>>>>>>>>>            
46914>>>>>>>>>>>>>>>>>            
46914>>>>>>>>>>>>>>>>>            
46914>>>>>>>>>>>>>>>>>            
46914>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46914>>>>>>>>>>>>>>>>>
46914>>>>>>>>>>>>>>>>>        End_Object    // operi
46915>>>>>>>>>>>>>>>>>
46915>>>>>>>>>>>>>>>>>        Object ocodeprom is a FormSub
46917>>>>>>>>>>>>>>>>>            Set Size to 13 197
46918>>>>>>>>>>>>>>>>>            Set Location to 238 91
46919>>>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
46920>>>>>>>>>>>>>>>>>
46920>>>>>>>>>>>>>>>>>            //AB-StoreStart
46920>>>>>>>>>>>>>>>>>                                                                                                                                                                                                    
46920>>>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
46922>>>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46923>>>>>>>>>>>>>>>>>            End_Procedure
46924>>>>>>>>>>>>>>>>>            
46924>>>>>>>>>>>>>>>>>            
46924>>>>>>>>>>>>>>>>>            
46924>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46924>>>>>>>>>>>>>>>>>
46924>>>>>>>>>>>>>>>>>        End_Object    // ocodeprom
46925>>>>>>>>>>>>>>>>>
46925>>>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
46927>>>>>>>>>>>>>>>>>            Set Size to 32 77
46928>>>>>>>>>>>>>>>>>            Set Location to 209 296
46929>>>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
46931>>>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
46932>>>>>>>>>>>>>>>>>                Set Size to 10 53
46933>>>>>>>>>>>>>>>>>                Set Location to 7 5
46934>>>>>>>>>>>>>>>>>            End_Object    // Radio1
46935>>>>>>>>>>>>>>>>>
46935>>>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
46937>>>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
46938>>>>>>>>>>>>>>>>>                Set Size to 10 51
46939>>>>>>>>>>>>>>>>>                Set Location to 21 5
46940>>>>>>>>>>>>>>>>>            End_Object    // Radio2
46941>>>>>>>>>>>>>>>>>
46941>>>>>>>>>>>>>>>>>
46941>>>>>>>>>>>>>>>>>            //AB-StoreStart
46941>>>>>>>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
46941>>>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
46943>>>>>>>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
46943>>>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
46944>>>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
46945>>>>>>>>>>>>>>>>>            End_Procedure
46946>>>>>>>>>>>>>>>>>            
46946>>>>>>>>>>>>>>>>>            // If you set Current_radio you must set this after the
46946>>>>>>>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
46946>>>>>>>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
46946>>>>>>>>>>>>>>>>>            //Set Current_Radio to 0
46946>>>>>>>>>>>>>>>>>            
46946>>>>>>>>>>>>>>>>>            
46946>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46946>>>>>>>>>>>>>>>>>
46946>>>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
46947>>>>>>>>>>>>>>>>>
46947>>>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
46949>>>>>>>>>>>>>>>>>            Set Label to "Search"
46950>>>>>>>>>>>>>>>>>            Set Size to 28 37
46951>>>>>>>>>>>>>>>>>            Set Location to 210 413
46952>>>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
46953>>>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
46954>>>>>>>>>>>>>>>>>
46954>>>>>>>>>>>>>>>>>            //AB-StoreStart
46954>>>>>>>>>>>>>>>>>                                        
46954>>>>>>>>>>>>>>>>>            Set Visible_State to False
46955>>>>>>>>>>>>>>>>>            
46955>>>>>>>>>>>>>>>>>            Procedure OnClick
46957>>>>>>>>>>>>>>>>>                Forward Send OnClick
46959>>>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
46960>>>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
46961>>>>>>>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
46962>>>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
46963>>>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
46964>>>>>>>>>>>>>>>>>            End_Procedure // OnClick
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            
46965>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46965>>>>>>>>>>>>>>>>>
46965>>>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
46966>>>>>>>>>>>>>>>>>
46966>>>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
46968>>>>>>>>>>>>>>>>>
46968>>>>>>>>>>>>>>>>>            //AB-StoreTopStart
46968>>>>>>>>>>>>>>>>>                                                                                    
46968>>>>>>>>>>>>>>>>>            //AB-StoreTopEnd
46968>>>>>>>>>>>>>>>>>
46968>>>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
46969>>>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
46970>>>>>>>>>>>>>>>>>            Set Size to 22 25
46971>>>>>>>>>>>>>>>>>            Set Location to 214 482
46972>>>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
46973>>>>>>>>>>>>>>>>>
46973>>>>>>>>>>>>>>>>>            //AB-StoreStart
46973>>>>>>>>>>>>>>>>>                                                                                    
46973>>>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
46974>>>>>>>>>>>>>>>>>            
46974>>>>>>>>>>>>>>>>>            Procedure OnClick
46976>>>>>>>>>>>>>>>>>                String  scode speri
46977>>>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
46978>>>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
46979>>>>>>>>>>>>>>>>>                set pscode of (sl17(self)) to scode
46980>>>>>>>>>>>>>>>>>                set psperi of (sl17(self)) to speri
46981>>>>>>>>>>>>>>>>>                send request_cancel to dg186
46982>>>>>>>>>>>>>>>>>            End_Procedure // OnClick
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            
46983>>>>>>>>>>>>>>>>>            //AB-StoreEnd
46983>>>>>>>>>>>>>>>>>
46983>>>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
46984>>>>>>>>>>>>>>>>>
46984>>>>>>>>>>>>>>>>>
46984>>>>>>>>>>>>>>>>>        //AB-StoreStart
46984>>>>>>>>>>>>>>>>>        Procedure Activating
46986>>>>>>>>>>>>>>>>>           integer rval
46987>>>>>>>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
46988>>>>>>>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
46989>>>>>>>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
46990>>>>>>>>>>>>>>>>>           Forward send Activating
46992>>>>>>>>>>>>>>>>>        
46992>>>>>>>>>>>>>>>>>        End_Procedure
46993>>>>>>>>>>>>>>>>>        
46993>>>>>>>>>>>>>>>>>        
46993>>>>>>>>>>>>>>>>>        
46993>>>>>>>>>>>>>>>>>        
46993>>>>>>>>>>>>>>>>>        
46993>>>>>>>>>>>>>>>>>        
46993>>>>>>>>>>>>>>>>>        //AB-StoreEnd
46993>>>>>>>>>>>>>>>>>
46993>>>>>>>>>>>>>>>>>    End_Object    // dg186
46994>>>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>>>    //AB-StoreStart
46994>>>>>>>>>>>>>>>>>        
46994>>>>>>>>>>>>>>>>>    //AB-StoreEnd
46994>>>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
46994>>>>>>>>>>>>>>>    //AB-StoreTopEnd
46994>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>    //AB-IgnoreStart
46994>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
46994>>>>>>>>>>>>>>>    Use dbList.Sub
46994>>>>>>>>>>>>>>>    Use Txtbox.Sub
46994>>>>>>>>>>>>>>>    Use Form.Sub
46994>>>>>>>>>>>>>>>    Use Rgroup.Sub
46994>>>>>>>>>>>>>>>    Use Radio.Sub
46994>>>>>>>>>>>>>>>    Use Button.Sub
46994>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>    Use UNITS.DD
46994>>>>>>>>>>>>>>>    Use WITEMKAT.DD
46994>>>>>>>>>>>>>>>    Use FPA.DD
46994>>>>>>>>>>>>>>>    Use ITEM.DD
46994>>>>>>>>>>>>>>>    Use WITEMX.DD
46994>>>>>>>>>>>>>>>    
46994>>>>>>>>>>>>>>>    //AB-IgnoreEnd
46994>>>>>>>>>>>>>>>
46994>>>>>>>>>>>>>>>    Object SL17 is a dbModalPanelSub
46996>>>>>>>>>>>>>>>
46996>>>>>>>>>>>>>>>        //AB-StoreTopStart
46996>>>>>>>>>>>>>>>                
46996>>>>>>>>>>>>>>>        Property String     pscode                  ''
46998>>>>>>>>>>>>>>>        Property String     psperi                  ''
47000>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
47002>>>>>>>>>>>>>>>        Property String     pscodekat               ''
47004>>>>>>>>>>>>>>>        
47004>>>>>>>>>>>>>>>        //AB-StoreTopEnd
47004>>>>>>>>>>>>>>>
47004>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
47005>>>>>>>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
47006>>>>>>>>>>>>>>>        Set Size to 266 484
47007>>>>>>>>>>>>>>>        Set Location to 9 14
47008>>>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
47009>>>>>>>>>>>>>>>        Set Modal_State to FALSE
47010>>>>>>>>>>>>>>>
47010>>>>>>>>>>>>>>>        //AB-DDOStart
47010>>>>>>>>>>>>>>>
47010>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
47012>>>>>>>>>>>>>>>        End_Object    // Units_DD
47013>>>>>>>>>>>>>>>
47013>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
47015>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
47016>>>>>>>>>>>>>>>
47016>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
47018>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
47019>>>>>>>>>>>>>>>
47019>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
47021>>>>>>>>>>>>>>>
47021>>>>>>>>>>>>>>>            //AB-StoreTopStart
47021>>>>>>>>>>>>>>>                                                                                                    
47021>>>>>>>>>>>>>>>                                                                                                    
47021>>>>>>>>>>>>>>>            //AB-StoreTopEnd
47021>>>>>>>>>>>>>>>
47021>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
47022>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
47023>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
47024>>>>>>>>>>>>>>>
47024>>>>>>>>>>>>>>>            //AB-StoreStart
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>                                                                                                    
47024>>>>>>>>>>>>>>>            //AB-StoreEnd
47024>>>>>>>>>>>>>>>
47024>>>>>>>>>>>>>>>        End_Object    // Item_DD
47025>>>>>>>>>>>>>>>
47025>>>>>>>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
47027>>>>>>>>>>>>>>>
47027>>>>>>>>>>>>>>>            //AB-StoreTopStart
47027>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
47029>>>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
47030>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
47030>>>>>>>>>>>>>>>                       Move 0 to rVal
47031>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
47032>>>>>>>>>>>>>>>                       Get psperi to lsperi
47033>>>>>>>>>>>>>>>                       Get pscode to lscode
47034>>>>>>>>>>>>>>>                       Get pscodekat to lscodekat
47035>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
47036>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
47037>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
47039>>>>>>>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
47041>>>>>>>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
47044>>>>>>>>>>>>>>>                           End
47044>>>>>>>>>>>>>>>>
47044>>>>>>>>>>>>>>>                       End
47044>>>>>>>>>>>>>>>>
47044>>>>>>>>>>>>>>>                       Else Begin
47045>>>>>>>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
47047>>>>>>>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
47050>>>>>>>>>>>>>>>                           End
47050>>>>>>>>>>>>>>>>
47050>>>>>>>>>>>>>>>                       End
47050>>>>>>>>>>>>>>>>
47050>>>>>>>>>>>>>>>                       Function_Return rVal
47051>>>>>>>>>>>>>>>                   End_Function
47052>>>>>>>>>>>>>>>            
47052>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
47054>>>>>>>>>>>>>>>                       String lsperi
47055>>>>>>>>>>>>>>>                       Get psperi to lsperi
47056>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
47057>>>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
47058>>>>>>>>>>>>>>>                   End_Function
47059>>>>>>>>>>>>>>>            
47059>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
47061>>>>>>>>>>>>>>>                       String lscode lscodekat
47062>>>>>>>>>>>>>>>                       Get pscode to lscode
47063>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
47064>>>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
47065>>>>>>>>>>>>>>>                   End_Function
47066>>>>>>>>>>>>>>>            //AB-StoreTopEnd
47066>>>>>>>>>>>>>>>
47066>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
47067>>>>>>>>>>>>>>>
47067>>>>>>>>>>>>>>>            //AB-StoreStart
47067>>>>>>>>>>>>>>>                                                                                
47067>>>>>>>>>>>>>>>            Begin_Constraints
47069>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
47070>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
47070>>>>>>>>>>>>>>>               Get psperi               to lsperi
47071>>>>>>>>>>>>>>>               Get pscode               to lscode
47072>>>>>>>>>>>>>>>               Get pscodekat            to lscodekat
47073>>>>>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
47074>>>>>>>>>>>>>>>               Move (Trim(lsperi))      to lsperi
47075>>>>>>>>>>>>>>>               Move (Trim(lscode))      to lscode
47076>>>>>>>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
47077>>>>>>>>>>>>>>>               Set Ordering to 4
47078>>>>>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
47080>>>>>>>>>>>>>>>                    Set Ordering to 4
47081>>>>>>>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
47082>>>>>>>>>>>>>>>               End
47082>>>>>>>>>>>>>>>>
47082>>>>>>>>>>>>>>>               Else Begin
47083>>>>>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
47085>>>>>>>>>>>>>>>                        If (lsperi<>'') Begin
47087>>>>>>>>>>>>>>>                            Set Ordering to 3
47088>>>>>>>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
47090>>>>>>>>>>>>>>>                        End
47090>>>>>>>>>>>>>>>>
47090>>>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
47093>>>>>>>>>>>>>>>                            Set Ordering to 4
47094>>>>>>>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
47096>>>>>>>>>>>>>>>                        End
47096>>>>>>>>>>>>>>>>
47096>>>>>>>>>>>>>>>                  End
47096>>>>>>>>>>>>>>>>
47096>>>>>>>>>>>>>>>                  Else Begin
47097>>>>>>>>>>>>>>>                        If (lsperi<>'') Begin
47099>>>>>>>>>>>>>>>                            Set Ordering to 3
47100>>>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
47101>>>>>>>>>>>>>>>                        End
47101>>>>>>>>>>>>>>>>
47101>>>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
47104>>>>>>>>>>>>>>>                            Set Ordering to 4
47105>>>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
47106>>>>>>>>>>>>>>>                        End
47106>>>>>>>>>>>>>>>>
47106>>>>>>>>>>>>>>>                  End
47106>>>>>>>>>>>>>>>>
47106>>>>>>>>>>>>>>>                  If (lscodekat<>'') Begin
47108>>>>>>>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
47110>>>>>>>>>>>>>>>                  End
47110>>>>>>>>>>>>>>>>
47110>>>>>>>>>>>>>>>               End
47110>>>>>>>>>>>>>>>>
47110>>>>>>>>>>>>>>>            End_Constraints
47113>>>>>>>>>>>>>>>            
47113>>>>>>>>>>>>>>>            
47113>>>>>>>>>>>>>>>            //AB-StoreEnd
47113>>>>>>>>>>>>>>>
47113>>>>>>>>>>>>>>>        End_Object    // Witemx_DD
47114>>>>>>>>>>>>>>>
47114>>>>>>>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
47115>>>>>>>>>>>>>>>        Set Server to (Witemx_DD(self))
47116>>>>>>>>>>>>>>>
47116>>>>>>>>>>>>>>>        //AB-DDOEnd
47116>>>>>>>>>>>>>>>
47116>>>>>>>>>>>>>>>        Object oSelList is a dbListSub
47118>>>>>>>>>>>>>>>            Set Main_File to Witemx.File_Number
47119>>>>>>>>>>>>>>>            Set Ordering to 5
47120>>>>>>>>>>>>>>>            Set Size to 190 475
47121>>>>>>>>>>>>>>>            Set Location to 1 1
47122>>>>>>>>>>>>>>>            Set Color to 14280447
47123>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
47124>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
47125>>>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
47126>>>>>>>>>>>>>>>
47126>>>>>>>>>>>>>>>            Begin_Row
47129>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_code
47130>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_descr
47131>>>>>>>>>>>>>>>                Entry_Item Witemx.Witemkat_code
47132>>>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
47133>>>>>>>>>>>>>>>                Entry_Item Item.Item_qual
47134>>>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
47135>>>>>>>>>>>>>>>            End_Row
47140>>>>>>>>>>>>>>>
47140>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
47141>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
47142>>>>>>>>>>>>>>>            
47142>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
47143>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
47144>>>>>>>>>>>>>>>            
47144>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
47145>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
47146>>>>>>>>>>>>>>>            
47146>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
47147>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
47148>>>>>>>>>>>>>>>            
47148>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
47149>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
47150>>>>>>>>>>>>>>>            
47150>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
47151>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
47152>>>>>>>>>>>>>>>            
47152>>>>>>>>>>>>>>>
47152>>>>>>>>>>>>>>>            //AB-StoreStart
47152>>>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
47154>>>>>>>>>>>>>>>            set export_item_state to true
47155>>>>>>>>>>>>>>>            
47155>>>>>>>>>>>>>>>            Procedure End_Construct_Object
47157>>>>>>>>>>>>>>>                Forward Send End_Construct_Object
47159>>>>>>>>>>>>>>>                Set Color               to 14280447
47160>>>>>>>>>>>>>>>                Set CurrentRowColor     to 11783679
47161>>>>>>>>>>>>>>>                Set CurrentCellColor    to 11783679
47162>>>>>>>>>>>>>>>            End_Procedure
47163>>>>>>>>>>>>>>>            
47163>>>>>>>>>>>>>>>            Procedure Activating Returns Integer
47165>>>>>>>>>>>>>>>                Integer rVal
47166>>>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
47168>>>>>>>>>>>>>>>                set auto_index_state to true
47169>>>>>>>>>>>>>>>                Procedure_Return rVal
47170>>>>>>>>>>>>>>>            End_Procedure
47171>>>>>>>>>>>>>>>            
47171>>>>>>>>>>>>>>>            procedure move_value_out
47173>>>>>>>>>>>>>>>                forward send move_value_out
47175>>>>>>>>>>>>>>>                set value of (ocode(self)) to ''
47176>>>>>>>>>>>>>>>                set value of (operi(self)) to ''
47177>>>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
47178>>>>>>>>>>>>>>>                set psperi to ''
47179>>>>>>>>>>>>>>>                set pscode to ''
47180>>>>>>>>>>>>>>>                set pscodekat to ''
47181>>>>>>>>>>>>>>>            end_procedure
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            
47182>>>>>>>>>>>>>>>            //AB-StoreEnd
47182>>>>>>>>>>>>>>>
47182>>>>>>>>>>>>>>>        End_Object    // oSelList
47183>>>>>>>>>>>>>>>
47183>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
47185>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
47186>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
47187>>>>>>>>>>>>>>>            Set Location to 192 6
47188>>>>>>>>>>>>>>>            Set Size to 13 69
47189>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
47190>>>>>>>>>>>>>>>
47190>>>>>>>>>>>>>>>        Object ocode is a FormSub
47192>>>>>>>>>>>>>>>            Set Size to 13 197
47193>>>>>>>>>>>>>>>            Set Location to 192 79
47194>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
47195>>>>>>>>>>>>>>>
47195>>>>>>>>>>>>>>>            //AB-StoreStart
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            
47195>>>>>>>>>>>>>>>            //AB-StoreEnd
47195>>>>>>>>>>>>>>>
47195>>>>>>>>>>>>>>>        End_Object    // ocode
47196>>>>>>>>>>>>>>>
47196>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
47198>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
47199>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
47200>>>>>>>>>>>>>>>            Set Location to 207 6
47201>>>>>>>>>>>>>>>            Set Size to 13 71
47202>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
47203>>>>>>>>>>>>>>>
47203>>>>>>>>>>>>>>>        Object operi is a FormSub
47205>>>>>>>>>>>>>>>            Set Size to 13 197
47206>>>>>>>>>>>>>>>            Set Location to 207 79
47207>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
47208>>>>>>>>>>>>>>>
47208>>>>>>>>>>>>>>>            //AB-StoreStart
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            
47208>>>>>>>>>>>>>>>            //AB-StoreEnd
47208>>>>>>>>>>>>>>>
47208>>>>>>>>>>>>>>>        End_Object    // operi
47209>>>>>>>>>>>>>>>
47209>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
47211>>>>>>>>>>>>>>>            Set Size to 32 77
47212>>>>>>>>>>>>>>>            Set Location to 191 279
47213>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
47215>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
47216>>>>>>>>>>>>>>>                Set Size to 10 53
47217>>>>>>>>>>>>>>>                Set Location to 7 5
47218>>>>>>>>>>>>>>>            End_Object    // Radio1
47219>>>>>>>>>>>>>>>
47219>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
47221>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
47222>>>>>>>>>>>>>>>                Set Size to 10 52
47223>>>>>>>>>>>>>>>                Set Location to 21 5
47224>>>>>>>>>>>>>>>            End_Object    // Radio2
47225>>>>>>>>>>>>>>>
47225>>>>>>>>>>>>>>>
47225>>>>>>>>>>>>>>>            //AB-StoreStart
47225>>>>>>>>>>>>>>>            
47225>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
47227>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
47228>>>>>>>>>>>>>>>            End_Procedure
47229>>>>>>>>>>>>>>>            
47229>>>>>>>>>>>>>>>            
47229>>>>>>>>>>>>>>>            
47229>>>>>>>>>>>>>>>            
47229>>>>>>>>>>>>>>>            
47229>>>>>>>>>>>>>>>            //AB-StoreEnd
47229>>>>>>>>>>>>>>>
47229>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
47230>>>>>>>>>>>>>>>
47230>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
47232>>>>>>>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
47233>>>>>>>>>>>>>>>            Set Size to 15 197
47234>>>>>>>>>>>>>>>            Set Location to 236 79
47235>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
47236>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
47237>>>>>>>>>>>>>>>
47237>>>>>>>>>>>>>>>            //AB-StoreStart
47237>>>>>>>>>>>>>>>            
47237>>>>>>>>>>>>>>>            Procedure OnClick
47239>>>>>>>>>>>>>>>                Forward Send OnClick
47241>>>>>>>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
47242>>>>>>>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
47243>>>>>>>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
47244>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
47245>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
47246>>>>>>>>>>>>>>>            End_Procedure // OnClick
47247>>>>>>>>>>>>>>>            
47247>>>>>>>>>>>>>>>            
47247>>>>>>>>>>>>>>>            //AB-StoreEnd
47247>>>>>>>>>>>>>>>
47247>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
47248>>>>>>>>>>>>>>>
47248>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
47250>>>>>>>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
47251>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
47252>>>>>>>>>>>>>>>            Set Location to 221 5
47253>>>>>>>>>>>>>>>            Set Size to 13 70
47254>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
47255>>>>>>>>>>>>>>>
47255>>>>>>>>>>>>>>>        Object ocodekat is a FormSub
47257>>>>>>>>>>>>>>>            Set Size to 13 197
47258>>>>>>>>>>>>>>>            Set Location to 221 79
47259>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
47260>>>>>>>>>>>>>>>
47260>>>>>>>>>>>>>>>            //AB-StoreStart
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            
47260>>>>>>>>>>>>>>>            //AB-StoreEnd
47260>>>>>>>>>>>>>>>
47260>>>>>>>>>>>>>>>        End_Object    // ocodekat
47261>>>>>>>>>>>>>>>
47261>>>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
47263>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
47264>>>>>>>>>>>>>>>            Set Location to 232 318
47265>>>>>>>>>>>>>>>
47265>>>>>>>>>>>>>>>            //AB-StoreStart
47265>>>>>>>>>>>>>>>            Procedure OnClick
47267>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
47268>>>>>>>>>>>>>>>            End_Procedure
47269>>>>>>>>>>>>>>>            //AB-StoreEnd
47269>>>>>>>>>>>>>>>
47269>>>>>>>>>>>>>>>        End_Object    // oOK_bn
47270>>>>>>>>>>>>>>>
47270>>>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
47272>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
47273>>>>>>>>>>>>>>>            Set Location to 232 373
47274>>>>>>>>>>>>>>>
47274>>>>>>>>>>>>>>>            //AB-StoreStart
47274>>>>>>>>>>>>>>>            Procedure OnClick
47276>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
47277>>>>>>>>>>>>>>>            End_Procedure
47278>>>>>>>>>>>>>>>            //AB-StoreEnd
47278>>>>>>>>>>>>>>>
47278>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
47279>>>>>>>>>>>>>>>
47279>>>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
47281>>>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
47282>>>>>>>>>>>>>>>            Set Location to 232 428
47283>>>>>>>>>>>>>>>
47283>>>>>>>>>>>>>>>            //AB-StoreStart
47283>>>>>>>>>>>>>>>            Procedure OnClick
47285>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
47286>>>>>>>>>>>>>>>            End_Procedure
47287>>>>>>>>>>>>>>>            //AB-StoreEnd
47287>>>>>>>>>>>>>>>
47287>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
47288>>>>>>>>>>>>>>>
47288>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
47290>>>>>>>>>>>>>>>
47290>>>>>>>>>>>>>>>            //AB-StoreTopStart
47290>>>>>>>>>>>>>>>            
47290>>>>>>>>>>>>>>>            //AB-StoreTopEnd
47290>>>>>>>>>>>>>>>
47290>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
47291>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
47292>>>>>>>>>>>>>>>            Set Size to 22 25
47293>>>>>>>>>>>>>>>            Set Location to 196 443
47294>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
47295>>>>>>>>>>>>>>>
47295>>>>>>>>>>>>>>>            //AB-StoreStart
47295>>>>>>>>>>>>>>>            
47295>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
47296>>>>>>>>>>>>>>>            
47296>>>>>>>>>>>>>>>            Procedure OnClick
47298>>>>>>>>>>>>>>>                String  scode speri
47299>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
47300>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
47301>>>>>>>>>>>>>>>                set pscode of (dg186(self)) to scode
47302>>>>>>>>>>>>>>>                set psperi of (dg186(self)) to speri
47303>>>>>>>>>>>>>>>               Send popup_modal to (dg186(self))
47304>>>>>>>>>>>>>>>            End_Procedure // OnClick
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            
47305>>>>>>>>>>>>>>>            //AB-StoreEnd
47305>>>>>>>>>>>>>>>
47305>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
47306>>>>>>>>>>>>>>>
47306>>>>>>>>>>>>>>>
47306>>>>>>>>>>>>>>>        //AB-StoreStart
47306>>>>>>>>>>>>>>>                
47306>>>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
47307>>>>>>>>>>>>>>>        
47307>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
47308>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
47309>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
47310>>>>>>>>>>>>>>>        
47310>>>>>>>>>>>>>>>        Procedure Activate
47312>>>>>>>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
47313>>>>>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
47314>>>>>>>>>>>>>>>            Forward Send Activate
47316>>>>>>>>>>>>>>>        End_Procedure
47317>>>>>>>>>>>>>>>        
47317>>>>>>>>>>>>>>>        procedure request_cancel
47319>>>>>>>>>>>>>>>            forward send request_cancel
47321>>>>>>>>>>>>>>>            set value of (ocode(self)) to ''
47322>>>>>>>>>>>>>>>            set value of (operi(self)) to ''
47323>>>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
47324>>>>>>>>>>>>>>>            Set psperi  to ''
47325>>>>>>>>>>>>>>>            Set pscode  to ''
47326>>>>>>>>>>>>>>>            Set pscodekat TO ''
47327>>>>>>>>>>>>>>>        end_procedure
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        
47328>>>>>>>>>>>>>>>        //AB-StoreEnd
47328>>>>>>>>>>>>>>>
47328>>>>>>>>>>>>>>>    End_Object    // SL17
47329>>>>>>>>>>>>>>>
47329>>>>>>>>>>>>>>>
47329>>>>>>>>>>>>>>>    //AB-StoreStart
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    
47329>>>>>>>>>>>>>>>    //AB-StoreEnd
47329>>>>>>>>>>>>>>>
47329>>>>>>>>>>>>>>>//AB/     End_Object    // prj
47329>>>>>>>>>>>>>
47329>>>>>>>>>>>>>//DDB-Selection-pkg-End
47329>>>>>>>>>>>>>//DDB-FileEnd
47329>>>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
47329>>>>>>>>>>>>>//DDB-FileStart
47329>>>>>>>>>>>>>//DDB-HeaderStart
47329>>>>>>>>>>>>>
47329>>>>>>>>>>>>>// File Name : PMOVES.DD
47329>>>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
47329>>>>>>>>>>>>>// Revision  : 157
47329>>>>>>>>>>>>>// Version   : 2
47329>>>>>>>>>>>>>
47329>>>>>>>>>>>>>Use  Windows           // Basic Definitions
47329>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
47329>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
47329>>>>>>>>>>>>>
47329>>>>>>>>>>>>>Open Pmoves
47331>>>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
47333>>>>>>>>>>>>>Open Pmssxet
47335>>>>>>>>>>>>>Open Wax
47337>>>>>>>>>>>>>Open Witemx
47339>>>>>>>>>>>>>Open Particle
47341>>>>>>>>>>>>>Open Sysrecp
47343>>>>>>>>>>>>>Open Syscurxr
47345>>>>>>>>>>>>>Open Partlfpa
47347>>>>>>>>>>>>>Open Clorder
47349>>>>>>>>>>>>>Open Clorderd
47351>>>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
47353>>>>>>>>>>>>>Open Gmove
47355>>>>>>>>>>>>>Open Sysrecg
47357>>>>>>>>>>>>>
47357>>>>>>>>>>>>>//DDB-HeaderEnd
47357>>>>>>>>>>>>>Open Fpa
47359>>>>>>>>>>>>>Open PartlFpa
47361>>>>>>>>>>>>>Open Item
47363>>>>>>>>>>>>>Open Wtypkin
47365>>>>>>>>>>>>>Open Witemkat
47367>>>>>>>>>>>>>Open Wapomast
47369>>>>>>>>>>>>>Open Wapokat
47371>>>>>>>>>>>>>Open Payresp
47373>>>>>>>>>>>>>
47373>>>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
47374>>>>>>>>>>>>>
47374>>>>>>>>>>>>>
47374>>>>>>>>>>>>>    Procedure Construct_Object
47375>>>>>>>>>>>>>        Forward Send Construct_Object
47377>>>>>>>>>>>>>        Property Number  pnoQty         Public  0
47378>>>>>>>>>>>>>        Property integer pifromclorder  Public  0
47379>>>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
47380>>>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
47381>>>>>>>>>>>>>        Property integer piFromMetasx   Public  0
47382>>>>>>>>>>>>>        Property String  psOldItem      Public ''        
47383>>>>>>>>>>>>>        //------------------------------------------------
47383>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47383>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
47383>>>>>>>>>>>>>        // einai 1     js 03/12/2007
47383>>>>>>>>>>>>>        //------------------------------------------------  
47383>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
47384>>>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
47385>>>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
47386>>>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
47387>>>>>>>>>>>>>        Property String  psAud_Old_Poiothta     Public ""
47388>>>>>>>>>>>>>        Property String  psAud_Old_Eidos        Public ""
47389>>>>>>>>>>>>>
47389>>>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
47390>>>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
47391>>>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
47392>>>>>>>>>>>>>
47392>>>>>>>>>>>>>        Property Number  pnAud_Old_Qty          Public  0
47393>>>>>>>>>>>>>        Property Number  pnAud_Old_Timh         Public  0
47394>>>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
47395>>>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
47396>>>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
47397>>>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
47398>>>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
47399>>>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
47400>>>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0
47401>>>>>>>>>>>>>        //------------------------------------------------
47401>>>>>>>>>>>>>    End_Procedure
47402>>>>>>>>>>>>>
47402>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
47403>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
47405>>>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
47406>>>>>>>>>>>>>        Set psOldItem   to Item.Item_Code           
47407>>>>>>>>>>>>>        //------------------------------------------------
47407>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47407>>>>>>>>>>>>>        // ton pedion js 03/12/2007
47407>>>>>>>>>>>>>        //------------------------------------------------
47407>>>>>>>>>>>>>        Set psAud_Old_Pelaths       to Pmoves.Client_ID
47408>>>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
47409>>>>>>>>>>>>>        Set psAud_Old_Ergo          to Pmoves.CN_Code
47410>>>>>>>>>>>>>        Set psAud_Old_Eidos         to Pmoves.Witemx_Code   
47411>>>>>>>>>>>>>        Set psAud_Old_Poiothta      to Item.Item_Qual 
47412>>>>>>>>>>>>>        Set pnAud_Old_Qty           to Pmoves.Pms_Qty 
47413>>>>>>>>>>>>>        Set pnAud_Old_Timh          to Pmoves.Pms_UnitPrice 
47414>>>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Pmoves.Partl_Recr 
47415>>>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Pmoves.Pms_Recr 
47416>>>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
47417>>>>>>>>>>>>>        Set psAud_Old_Zonh          to Pmoves.Zone
47418>>>>>>>>>>>>>        Set psAud_Old_Antlia        to Pmoves.Pump_ID
47419>>>>>>>>>>>>>        Set psAud_Old_Oxhma         to Pmoves.Car_ID
47420>>>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
47421>>>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
47422>>>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
47423>>>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No
47424>>>>>>>>>>>>>        //------------------------------------------------
47424>>>>>>>>>>>>>    End_Procedure   // New_Current_Record
47425>>>>>>>>>>>>>
47425>>>>>>>>>>>>>
47425>>>>>>>>>>>>>    // Delete_Main_File:
47425>>>>>>>>>>>>>    Procedure Delete_Main_File
47426>>>>>>>>>>>>>        clear btnemp
47427>>>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
47428>>>>>>>>>>>>>        find ge btnemp by index.11
47429>>>>>>>>>>>>>>
47429>>>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
47431>>>>>>>>>>>>>           move 0 to btnemp.pms_recr
47432>>>>>>>>>>>>>           saverecord btnemp
47433>>>>>>>>>>>>>        end                             
47433>>>>>>>>>>>>>>
47433>>>>>>>>>>>>>
47433>>>>>>>>>>>>>        //---------------------------------------------
47433>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
47433>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47433>>>>>>>>>>>>>            //MODE_WAITING  
47433>>>>>>>>>>>>>            //MODE_FINDING  
47433>>>>>>>>>>>>>            //MODE_CLEARING 
47433>>>>>>>>>>>>>            //MODE_CREATING 
47433>>>>>>>>>>>>>            //MODE_SAVING   
47433>>>>>>>>>>>>>            //MODE_DELETING 
47433>>>>>>>>>>>>>            //MODE_ABORTING 
47433>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47434>>>>>>>>>>>>>        Date    dDate  Shmer 
47434>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
47434>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47438>>>>>>>>>>>>>        Move iHour  to sHour
47439>>>>>>>>>>>>>        Move iMin   to sMin
47440>>>>>>>>>>>>>        Move iSec   to sSec
47441>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47445>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47449>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47453>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47454>>>>>>>>>>>>>        
47454>>>>>>>>>>>>>        // Auditing / Diagrafh - Diorthosh
47454>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING)) Begin
47456>>>>>>>>>>>>>            Get fsLoginUserID to sUser
47457>>>>>>>>>>>>>
47457>>>>>>>>>>>>>            clear gmove
47458>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
47459>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
47460>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
47461>>>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
47462>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
47463>>>>>>>>>>>>>            move pmoves.partl_no        to gmove.garticl_no
47464>>>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
47465>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
47466>>>>>>>>>>>>>            move pmoves.pms_recr        to gmove.garticl_recr
47467>>>>>>>>>>>>>            reread sysrecg
47471>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47472>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47473>>>>>>>>>>>>>            saverecord sysrecg
47474>>>>>>>>>>>>>            unlock
47475>>>>>>>>>>>>>>
47475>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
47476>>>>>>>>>>>>>
47476>>>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
47477>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
47478>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
47479>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
47480>>>>>>>>>>>>>            Move (psAud_Old_Pelaths (Self))     to Gmove.Prev_ID
47481>>>>>>>>>>>>>            Move (psAud_Old_PelathsN(Self))     to Gmove.Prev_Name
47482>>>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
47483>>>>>>>>>>>>>            Move (psAud_Old_Eidos    (Self))    to Gmove.Prev_Item
47484>>>>>>>>>>>>>            Move (psAud_Old_Poiothta (Self))    to Gmove.Prev_Qual 
47485>>>>>>>>>>>>>            Move (pnAud_Old_Qty      (Self))    to Gmove.Prev_M3 
47486>>>>>>>>>>>>>            Move (pnAud_Old_Timh     (Self))    to Gmove.Prev_UnitPrice
47487>>>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
47488>>>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
47489>>>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
47490>>>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
47491>>>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
47492>>>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
47493>>>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
47494>>>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
47495>>>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
47496>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã š¨˜££ãª  ˜¨˜©«˜« ¡¦ç)" to sText
47497>>>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
47498>>>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
47499>>>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
47500>>>>>>>>>>>>>            saverecord gmove
47501>>>>>>>>>>>>>        End
47501>>>>>>>>>>>>>>
47501>>>>>>>>>>>>>
47501>>>>>>>>>>>>>        Forward Send Delete_Main_File
47503>>>>>>>>>>>>>        // Insert Code Here
47503>>>>>>>>>>>>>    End_Procedure   // Delete_Main_File
47504>>>>>>>>>>>>>                      
47504>>>>>>>>>>>>>
47504>>>>>>>>>>>>>    Procedure Save_Main_File
47505>>>>>>>>>>>>>        Integer iYes
47506>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
47508>>>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
47511>>>>>>>>>>>>>        End
47511>>>>>>>>>>>>>>
47511>>>>>>>>>>>>>
47511>>>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
47513>>>>>>>>>>>>>            // Elegxos FPA
47513>>>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
47513>>>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
47515>>>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
47516>>>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
47519>>>>>>>>>>>>>            End
47519>>>>>>>>>>>>>>
47519>>>>>>>>>>>>>        End
47519>>>>>>>>>>>>>>
47519>>>>>>>>>>>>>        Forward Send Save_Main_File
47521>>>>>>>>>>>>>    End_Procedure
47522>>>>>>>>>>>>>
47522>>>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
47523>>>>>>>>>>>>>        Number  rVal nQty
47524>>>>>>>>>>>>>        String  sClientID sWitemxCode
47524>>>>>>>>>>>>>        Date    dHmnia
47524>>>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
47524>>>>>>>>>>>>>
47524>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
47525>>>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
47527>>>>>>>>>>>>>            // 1=€š¦¨œª
47527>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
47528>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
47529>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
47530>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
47531>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
47532>>>>>>>>>>>>>            // Sto arxeio Globals.inc
47532>>>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
47533>>>>>>>>>>>>>        End
47533>>>>>>>>>>>>>>
47533>>>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
47536>>>>>>>>>>>>>            // 2=à¢ã©œ ª
47536>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
47537>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
47538>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
47539>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
47540>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
47541>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
47542>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
47543>>>>>>>>>>>>>            // Sto arxeio Globals.inc
47543>>>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
47544>>>>>>>>>>>>>        End
47544>>>>>>>>>>>>>>
47544>>>>>>>>>>>>>        Function_Return rVal
47545>>>>>>>>>>>>>    End_Function
47546>>>>>>>>>>>>>
47546>>>>>>>>>>>>>    Procedure Creating
47547>>>>>>>>>>>>>        Forward Send Creating
47549>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
47550>>>>>>>>>>>>>        Set piCreateNew to 1
47551>>>>>>>>>>>>>    End_Procedure   // Creating
47552>>>>>>>>>>>>>
47552>>>>>>>>>>>>>    Procedure Update
47553>>>>>>>>>>>>>        Integer iDecimals
47554>>>>>>>>>>>>>        Number  nInt nFpaOnTotal
47554>>>>>>>>>>>>>        String  sCurrentUser
47554>>>>>>>>>>>>>
47554>>>>>>>>>>>>>        Forward Send Update
47556>>>>>>>>>>>>>
47556>>>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
47557>>>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
47558>>>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
47559>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
47560>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
47561>>>>>>>>>>>>>
47561>>>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
47562>>>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
47563>>>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
47564>>>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
47565>>>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
47566>>>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
47567>>>>>>>>>>>>>
47567>>>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
47567>>>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
47568>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
47569>>>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
47570>>>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
47571>>>>>>>>>>>>>
47571>>>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
47572>>>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
47573>>>>>>>>>>>>>
47573>>>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
47574>>>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
47575>>>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
47576>>>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
47577>>>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
47578>>>>>>>>>>>>>
47578>>>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
47579>>>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
47580>>>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
47581>>>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
47582>>>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
47583>>>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
47584>>>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
47585>>>>>>>>>>>>>
47585>>>>>>>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
47588>>>>>>>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
47591>>>>>>>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
47594>>>>>>>>>>>>>
47594>>>>>>>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
47594>>>>>>>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
47594>>>>>>>>>>>>>
47594>>>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
47595>>>>>>>>>>>>>
47595>>>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
47596>>>>>>>>>>>>>
47596>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
47597>>>>>>>>>>>>>
47597>>>>>>>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
47600>>>>>>>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
47602>>>>>>>>>>>>>
47602>>>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
47603>>>>>>>>>>>>>
47603>>>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
47604>>>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
47605>>>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
47606>>>>>>>>>>>>>
47606>>>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
47607>>>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
47608>>>>>>>>>>>>>
47608>>>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
47609>>>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
47610>>>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
47611>>>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
47612>>>>>>>>>>>>>
47612>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
47612>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
47612>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
47612>>>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
47612>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
47612>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
47614>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
47614>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
47614>>>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
47614>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
47614>>>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
47614>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
47614>>>>>>>>>>>>>
47614>>>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
47615>>>>>>>>>>>>>
47615>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
47617>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
47618>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
47619>>>>>>>>>>>>>            End
47619>>>>>>>>>>>>>>
47619>>>>>>>>>>>>>            Else Begin
47620>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
47621>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
47622>>>>>>>>>>>>>            End
47622>>>>>>>>>>>>>>
47622>>>>>>>>>>>>>        End
47622>>>>>>>>>>>>>>
47622>>>>>>>>>>>>>
47622>>>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
47623>>>>>>>>>>>>>
47623>>>>>>>>>>>>>
47623>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47623>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47623>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47623>>>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
47624>>>>>>>>>>>>>
47624>>>>>>>>>>>>>        Clear PartlFpa
47625>>>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47626>>>>>>>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
47627>>>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47628>>>>>>>>>>>>>>
47628>>>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
47629>>>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
47630>>>>>>>>>>>>>        Saverecord PartlFpa
47631>>>>>>>>>>>>>
47631>>>>>>>>>>>>>        Move 0 to nFpaOnTotal
47632>>>>>>>>>>>>>        Clear PartlFpa
47633>>>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47634>>>>>>>>>>>>>        Find Gt PartlFpa By Index.1
47635>>>>>>>>>>>>>>
47635>>>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
47639>>>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
47640>>>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
47641>>>>>>>>>>>>>            Saverecord PartlFpa
47642>>>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
47643>>>>>>>>>>>>>            Find Gt PartlFpa By Index.1
47644>>>>>>>>>>>>>>
47644>>>>>>>>>>>>>        Loop
47645>>>>>>>>>>>>>>
47645>>>>>>>>>>>>>
47645>>>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
47646>>>>>>>>>>>>>
47646>>>>>>>>>>>>>
47646>>>>>>>>>>>>>        //---------------------------------------------
47646>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
47646>>>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47646>>>>>>>>>>>>>            //MODE_WAITING  
47646>>>>>>>>>>>>>            //MODE_FINDING  
47646>>>>>>>>>>>>>            //MODE_CLEARING 
47646>>>>>>>>>>>>>            //MODE_CREATING 
47646>>>>>>>>>>>>>            //MODE_SAVING   
47646>>>>>>>>>>>>>            //MODE_DELETING 
47646>>>>>>>>>>>>>            //MODE_ABORTING 
47646>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47646>>>>>>>>>>>>>        Date    dDate  Shmer 
47646>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
47646>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47650>>>>>>>>>>>>>        Move iHour  to sHour
47651>>>>>>>>>>>>>        Move iMin   to sMin
47652>>>>>>>>>>>>>        Move iSec   to sSec
47653>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47657>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47661>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47665>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47666>>>>>>>>>>>>>        
47666>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
47666>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
47668>>>>>>>>>>>>>            Get fsLoginUserID to sUser
47669>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
47671>>>>>>>>>>>>>                clear gmove
47672>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
47673>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
47674>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
47675>>>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
47676>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
47677>>>>>>>>>>>>>                move pmoves.partl_no        to gmove.garticl_no
47678>>>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
47679>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
47680>>>>>>>>>>>>>                move pmoves.pms_recr        to gmove.garticl_recr
47681>>>>>>>>>>>>>                reread sysrecg
47685>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47686>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47687>>>>>>>>>>>>>                saverecord sysrecg
47688>>>>>>>>>>>>>                unlock
47689>>>>>>>>>>>>>>
47689>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
47690>>>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
47691>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
47692>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
47693>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
47694>>>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
47695>>>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
47696>>>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
47697>>>>>>>>>>>>>                Move Item.Item_Code                 to Gmove.Cur_Item
47698>>>>>>>>>>>>>                Move Item.Item_Qual                 to Gmove.Cur_Qual 
47699>>>>>>>>>>>>>                Move Pmoves.Pms_Qty                 to Gmove.Cur_M3 
47700>>>>>>>>>>>>>                Move Pmoves.Pms_UnitPrice           to Gmove.Cur_UnitPrice
47701>>>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47702>>>>>>>>>>>>>                Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
47703>>>>>>>>>>>>>                
47703>>>>>>>>>>>>>                Move Pmoves.Zone                    to Gmove.Cur_Zonh
47704>>>>>>>>>>>>>                Move Pmoves.Pump_ID                 to Gmove.Cur_Antlia
47705>>>>>>>>>>>>>                Move Pmoves.Car_ID                  to Gmove.Cur_Oxhma       
47706>>>>>>>>>>>>>                
47706>>>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
47707>>>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
47708>>>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
47709>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ š¨˜££ãª §˜¨˜©«˜« ¡¦ç)" to sText
47710>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
47711>>>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
47712>>>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
47713>>>>>>>>>>>>>                saverecord gmove
47714>>>>>>>>>>>>>                Set piCreateNew to 0
47715>>>>>>>>>>>>>            End
47715>>>>>>>>>>>>>>
47715>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1)) Begin                                
47718>>>>>>>>>>>>>                Integer isChanged
47718>>>>>>>>>>>>>                Move 0 to isChanged
47719>>>>>>>>>>>>>                
47719>>>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths(Self))<>Trim(Clients.Client_ID    ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Pmoves.CN_Code      ))) Move 1 to isChanged    
47722>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Eidos  (Self))<>Trim(Item.Item_Code       ))   Or  (Trim(psAud_Old_Poiothta(Self))<>Trim(Item.Item_Qual      ))) Move 1 to isChanged   
47726>>>>>>>>>>>>>                Else If ((pnAud_Old_Qty         (Self) <>Pmoves.Pms_Qty             )   Or  (pnAud_Old_Timh         (Self) <>Pmoves.Pms_UnitPrice      )) Move 1 to isChanged   
47730>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh   (Self))<>Trim(Pmoves.Zone          ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Pmoves.Pump_ID      ))) Move 1 to isChanged   
47734>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma  (Self))<>Trim(Pmoves.Car_ID        ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
47738>>>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira  (Self))<>Trim(Particle.Pseira_Seira))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
47742>>>>>>>>>>>>>                Else If  (piAud_Old_No          (Self) <>Particle.Partl_No)                                                                               Move 1 to isChanged
47746>>>>>>>>>>>>>
47746>>>>>>>>>>>>>                If (isChanged>0) Begin  
47748>>>>>>>>>>>>>                    clear gmove
47749>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
47750>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
47751>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
47752>>>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
47753>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
47754>>>>>>>>>>>>>                    move pmoves.partl_no        to gmove.garticl_no
47755>>>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
47756>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
47757>>>>>>>>>>>>>                    move pmoves.pms_recr        to gmove.garticl_recr
47758>>>>>>>>>>>>>                    reread sysrecg
47762>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47763>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47764>>>>>>>>>>>>>                    saverecord sysrecg
47765>>>>>>>>>>>>>                    unlock
47766>>>>>>>>>>>>>>
47766>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
47767>>>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
47768>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
47769>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
47770>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
47771>>>>>>>>>>>>>                    //--
47771>>>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47772>>>>>>>>>>>>>                    Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
47773>>>>>>>>>>>>>                    //--
47773>>>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
47774>>>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
47775>>>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
47776>>>>>>>>>>>>>                    Move (Trim(Item.Item_Code       ))  to Gmove.Cur_Item
47777>>>>>>>>>>>>>                    Move (Trim(Item.Item_Qual       ))  to Gmove.Cur_Qual 
47778>>>>>>>>>>>>>                    Move       Pmoves.Pms_Qty           to Gmove.Cur_M3 
47779>>>>>>>>>>>>>                    Move       Pmoves.Pms_UnitPrice     to Gmove.Cur_UnitPrice
47780>>>>>>>>>>>>>
47780>>>>>>>>>>>>>                    Move (Trim(Pmoves.Zone          ))  to Gmove.Cur_Zonh
47781>>>>>>>>>>>>>                    Move (Trim(Pmoves.Pump_ID       ))  to Gmove.Cur_Antlia
47782>>>>>>>>>>>>>                    Move (Trim(Pmoves.Car_ID        ))  to Gmove.Cur_Oxhma       
47783>>>>>>>>>>>>>
47783>>>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
47784>>>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
47785>>>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
47786>>>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No
47787>>>>>>>>>>>>>                    //--
47787>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
47788>>>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
47789>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
47790>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Eidos   (Self))) to Gmove.Prev_Item
47791>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Poiothta(Self))) to Gmove.Prev_Qual 
47792>>>>>>>>>>>>>                    Move      (pnAud_Old_Qty     (Self )) to Gmove.Prev_M3 
47793>>>>>>>>>>>>>                    Move      (pnAud_Old_Timh    (Self )) to Gmove.Prev_UnitPrice
47794>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
47795>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
47796>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
47797>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
47798>>>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
47799>>>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
47800>>>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
47801>>>>>>>>>>>>>                    //--
47801>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž š¨˜££ãª ˜¨˜©«˜« ¡¦ç)" to sText 
47802>>>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
47803>>>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
47804>>>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
47805>>>>>>>>>>>>>                    saverecord gmove
47806>>>>>>>>>>>>>                    Set piCreateNew to 0
47807>>>>>>>>>>>>>                End
47807>>>>>>>>>>>>>>
47807>>>>>>>>>>>>>            End
47807>>>>>>>>>>>>>>
47807>>>>>>>>>>>>>        End
47807>>>>>>>>>>>>>>
47807>>>>>>>>>>>>>    End_Procedure   // Update
47808>>>>>>>>>>>>>
47808>>>>>>>>>>>>>    // Backout:
47808>>>>>>>>>>>>>    Procedure Backout
47809>>>>>>>>>>>>>        Number nFpaOnTotal
47810>>>>>>>>>>>>>        Forward Send Backout
47812>>>>>>>>>>>>>
47812>>>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
47813>>>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
47814>>>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
47815>>>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
47816>>>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
47817>>>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
47818>>>>>>>>>>>>>
47818>>>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
47818>>>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
47818>>>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
47818>>>>>>>>>>>>>        // Pmoves.Posa_apo_dap
47818>>>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
47820>>>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
47820>>>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
47820>>>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
47820>>>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
47820>>>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
47820>>>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
47820>>>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
47822>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
47823>>>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
47824>>>>>>>>>>>>>            End
47824>>>>>>>>>>>>>>
47824>>>>>>>>>>>>>            Else Begin
47825>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
47826>>>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
47827>>>>>>>>>>>>>            End
47827>>>>>>>>>>>>>>
47827>>>>>>>>>>>>>        End
47827>>>>>>>>>>>>>>
47827>>>>>>>>>>>>>
47827>>>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
47828>>>>>>>>>>>>>
47828>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47828>>>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47828>>>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47828>>>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
47829>>>>>>>>>>>>>
47829>>>>>>>>>>>>>        Clear PartlFpa
47830>>>>>>>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
47831>>>>>>>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
47832>>>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47833>>>>>>>>>>>>>>
47833>>>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
47834>>>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
47835>>>>>>>>>>>>>        Saverecord PartlFpa
47836>>>>>>>>>>>>>
47836>>>>>>>>>>>>>        Move 0 to nFpaOnTotal
47837>>>>>>>>>>>>>        Clear PartlFpa
47838>>>>>>>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
47839>>>>>>>>>>>>>        Find Gt PartlFpa By Index.1
47840>>>>>>>>>>>>>>
47840>>>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
47844>>>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
47845>>>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
47846>>>>>>>>>>>>>            Saverecord PartlFpa
47847>>>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
47848>>>>>>>>>>>>>            Find Gt PartlFpa By Index.1
47849>>>>>>>>>>>>>>
47849>>>>>>>>>>>>>        Loop
47850>>>>>>>>>>>>>>
47850>>>>>>>>>>>>>
47850>>>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total     
47851>>>>>>>>>>>>>        
47851>>>>>>>>>>>>>    End_Procedure   // Backout
47852>>>>>>>>>>>>>
47852>>>>>>>>>>>>>
47852>>>>>>>>>>>>>
47852>>>>>>>>>>>>>
47852>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
47853>>>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
47856>>>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
47860>>>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
47864>>>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
47868>>>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
47872>>>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
47876>>>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
47880>>>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
47884>>>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
47888>>>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
47892>>>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
47896>>>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
47900>>>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
47904>>>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47908>>>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47912>>>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47916>>>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47920>>>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
47924>>>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
47928>>>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
47932>>>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
47936>>>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
47940>>>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
47944>>>>>>>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
47948>>>>>>>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
47952>>>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
47955>>>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
47956>>>>>>>>>>>>>
47956>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
47957>>>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
47958>>>>>>>>>>>>>        Number  nInt nqty nQtyKin
47958>>>>>>>>>>>>>        String  sUserID sOldUserID sOldItem
47958>>>>>>>>>>>>>
47958>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
47960>>>>>>>>>>>>>
47960>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47962>>>>>>>>>>>>>
47962>>>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
47962>>>>>>>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
47962>>>>>>>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
47962>>>>>>>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
47962>>>>>>>>>>>>>
47962>>>>>>>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
47962>>>>>>>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
47962>>>>>>>>>>>>>//                Clear Fpa
47962>>>>>>>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
47962>>>>>>>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
47962>>>>>>>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
47962>>>>>>>>>>>>>//                If (iFpaRecnum) Begin
47962>>>>>>>>>>>>>//                    Clear Fpa
47962>>>>>>>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
47962>>>>>>>>>>>>>//                    Find Eq Fpa.Recnum
47962>>>>>>>>>>>>>//                End
47962>>>>>>>>>>>>>//            End
47962>>>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
47962>>>>>>>>>>>>>
47962>>>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
47965>>>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
47969>>>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
47973>>>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
47977>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
47981>>>>>>>>>>>>>            Else Begin
47982>>>>>>>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
47982>>>>>>>>>>>>>                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
47985>>>>>>>>>>>>>                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
47989>>>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
47989>>>>>>>>>>>>>
47989>>>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
47989>>>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
47989>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47989>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
47989>>>>>>>>>>>>>//                    End
47989>>>>>>>>>>>>>//                End
47989>>>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
47989>>>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
47989>>>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
47989>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47989>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
47989>>>>>>>>>>>>>//                End
47989>>>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
47989>>>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
47989>>>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
47989>>>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47989>>>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
47989>>>>>>>>>>>>>//                End
47989>>>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
47992>>>>>>>>>>>>>                    get pnoqty to nqty
47993>>>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
47996>>>>>>>>>>>>>                End
47996>>>>>>>>>>>>>>
47996>>>>>>>>>>>>>
47996>>>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
47999>>>>>>>>>>>>>                    // js 28/08/2002
47999>>>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
47999>>>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
47999>>>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
47999>>>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
47999>>>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
47999>>>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
47999>>>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
48001>>>>>>>>>>>>>                        get pnoqty to nqty
48002>>>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
48005>>>>>>>>>>>>>                        // js 22/12/2003
48005>>>>>>>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
48005>>>>>>>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
48005>>>>>>>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
48005>>>>>>>>>>>>>                        Get psOldItem to sOldItem
48006>>>>>>>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
48009>>>>>>>>>>>>>                    End
48009>>>>>>>>>>>>>>
48009>>>>>>>>>>>>>                End
48009>>>>>>>>>>>>>>
48009>>>>>>>>>>>>>            End
48009>>>>>>>>>>>>>>
48009>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48012>>>>>>>>>>>>>        End
48012>>>>>>>>>>>>>>
48012>>>>>>>>>>>>>        Function_Return iReturnVal
48013>>>>>>>>>>>>>    End_Function   // Validate_Save
48014>>>>>>>>>>>>>
48014>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
48015>>>>>>>>>>>>>        Integer iReturnVal
48016>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
48018>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
48020>>>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
48023>>>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
48027>>>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
48031>>>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
48034>>>>>>>>>>>>>        End
48034>>>>>>>>>>>>>>
48034>>>>>>>>>>>>>        Function_Return iReturnVal
48035>>>>>>>>>>>>>    End_Function   // Validate_Delete
48036>>>>>>>>>>>>>
48036>>>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
48037>>>>>>>>>>>>>        Local Integer   Changed
48038>>>>>>>>>>>>>        Local Number    nInt
48038>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
48039>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
48041>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
48042>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
48043>>>>>>>>>>>>>        End
48043>>>>>>>>>>>>>>
48043>>>>>>>>>>>>>    End_Procedure   // Shmera
48044>>>>>>>>>>>>>
48044>>>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
48045>>>>>>>>>>>>>        Local Integer Changed
48046>>>>>>>>>>>>>        Local Number nInt
48046>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
48047>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
48049>>>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
48050>>>>>>>>>>>>>            If (nInt<0) Begin
48052>>>>>>>>>>>>>                Move (nInt*(-1)) to nInt
48053>>>>>>>>>>>>>                Set Field_Default_Value iField to nInt
48054>>>>>>>>>>>>>            End
48054>>>>>>>>>>>>>>
48054>>>>>>>>>>>>>        End
48054>>>>>>>>>>>>>>
48054>>>>>>>>>>>>>    End_Procedure   // Shmera
48055>>>>>>>>>>>>>
48055>>>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
48056>>>>>>>>>>>>>        Local Integer Changed
48057>>>>>>>>>>>>>        Local Number nInt
48057>>>>>>>>>>>>>        Get Field_Changed_State iField to Changed
48058>>>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
48060>>>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
48061>>>>>>>>>>>>>            Set Field_Default_Value iField to nInt
48062>>>>>>>>>>>>>        End
48062>>>>>>>>>>>>>>
48062>>>>>>>>>>>>>    End_Procedure   // Shmera
48063>>>>>>>>>>>>>
48063>>>>>>>>>>>>>    // Define_Fields:
48063>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48063>>>>>>>>>>>>>
48063>>>>>>>>>>>>>    Procedure Define_Fields
48064>>>>>>>>>>>>>        Forward Send Define_Fields
48066>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48066>>>>>>>>>>>>>        //DDB-DefineFieldStart
48066>>>>>>>>>>>>>
48066>>>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
48067>>>>>>>>>>>>>
48067>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48068>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48069>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48070>>>>>>>>>>>>>
48070>>>>>>>>>>>>>        // Child (Client) file structure................
48070>>>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
48071>>>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
48072>>>>>>>>>>>>>
48072>>>>>>>>>>>>>        // Parent (Server) file structure...............
48072>>>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
48073>>>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
48074>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48075>>>>>>>>>>>>>
48075>>>>>>>>>>>>>        // External (System) file structure.............
48075>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
48076>>>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
48077>>>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
48078>>>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
48079>>>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
48080>>>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
48081>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
48082>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48083>>>>>>>>>>>>>
48083>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Field-based properties.......................
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Company_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Branch_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Year_Year
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Ctypkin_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Wtypkin_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Custprom_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Client_Id
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Cn_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Ptyppar_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Partl_Hmnia
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Pseira_Seira
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Partl_No
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Partl_Rec0
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Witemkat_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Units_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Item_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Witemx_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Wapokat_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Wapomast_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Wax_Code
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Wax_Recr
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Witemx_Recr
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Partl_Recr
48086>>>>>>>>>>>>>
48086>>>>>>>>>>>>>        // Pmoves.Pms_Rec0
48086>>>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
48087>>>>>>>>>>>>>
48087>>>>>>>>>>>>>        // Pmoves.Pms_No
48087>>>>>>>>>>>>>
48087>>>>>>>>>>>>>        // Pmoves.Pms_Recr
48087>>>>>>>>>>>>>
48087>>>>>>>>>>>>>        // Pmoves.Pms_Unitcode
48087>>>>>>>>>>>>>
48087>>>>>>>>>>>>>        // Pmoves.Pms_Qty
48087>>>>>>>>>>>>>
48087>>>>>>>>>>>>>        // Pmoves.Pms_Unitprice
48087>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
48088>>>>>>>>>>>>>
48088>>>>>>>>>>>>>        // Pmoves.Pms_Ambd
48088>>>>>>>>>>>>>
48088>>>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
48088>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
48089>>>>>>>>>>>>>
48089>>>>>>>>>>>>>        // Pmoves.Pms_Discam
48089>>>>>>>>>>>>>
48089>>>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
48089>>>>>>>>>>>>>
48089>>>>>>>>>>>>>        // Pmoves.Pms_Vatpct
48089>>>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Vatam
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Exrampct
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Exdet
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Payable
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Axia
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_X0
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_P0
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_X00
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_P00
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_X1
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_P1
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_X2
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_P2
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Dlixis
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_A_Code
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Status_E
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Status_A
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_S0
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Ys0
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_S1
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Ys1
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_S2
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Ys2
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Open
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Aopen
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_M_Code
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Kk
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_C_Code2
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Module
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Btnl2_Recr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Btnemp_Recr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Btarticle_Recr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Sls_Id
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Presp_Id
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Cnt_Id
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Mhxanik_Id
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Extra_Epimer
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Clorderd_Recr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Witemx_Descr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Timol_Qty
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Timol_Ypol
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Qty_Ypol
48090>>>>>>>>>>>>>
48090>>>>>>>>>>>>>        // Pmoves.Pms_Selected
48090>>>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Sx_Parast
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Sx_Hmnia
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Sx_Seira
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Sx_Arithmos
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Pump_Id
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Car_Id
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Item_Ypot
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Qty_Return
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Client_Name
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        // Pmoves.Zone
48091>>>>>>>>>>>>>
48091>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48091>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48092>>>>>>>>>>>>>
48092>>>>>>>>>>>>>    // Field_Defaults:
48092>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48092>>>>>>>>>>>>>
48092>>>>>>>>>>>>>    Procedure Field_Defaults
48093>>>>>>>>>>>>>        Forward Send Field_Defaults
48095>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48095>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48095>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48095>>>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
48095>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48096>>>>>>>>>>>>>
48096>>>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
48097>>>>>>>>>>>>>//DDB-FileEnd
48097>>>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
48097>>>>>>>>>>>>>//DDB-FileStart
48097>>>>>>>>>>>>>//DDB-HeaderStart
48097>>>>>>>>>>>>>
48097>>>>>>>>>>>>>// File Name : PmsDtl.DD
48097>>>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
48097>>>>>>>>>>>>>// Revision  : 0
48097>>>>>>>>>>>>>// Version   : 2
48097>>>>>>>>>>>>>
48097>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48097>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48097>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48097>>>>>>>>>>>>>
48097>>>>>>>>>>>>>Open Pmsdtl
48099>>>>>>>>>>>>>Open Pmoves
48101>>>>>>>>>>>>>
48101>>>>>>>>>>>>>//DDB-HeaderEnd
48101>>>>>>>>>>>>>
48101>>>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
48102>>>>>>>>>>>>>
48102>>>>>>>>>>>>>    // Define_Fields:
48102>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48102>>>>>>>>>>>>>
48102>>>>>>>>>>>>>    Procedure Define_Fields
48103>>>>>>>>>>>>>        Forward Send Define_Fields
48105>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48105>>>>>>>>>>>>>        //DDB-DefineFieldStart
48105>>>>>>>>>>>>>
48105>>>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
48106>>>>>>>>>>>>>
48106>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48107>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48108>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48109>>>>>>>>>>>>>
48109>>>>>>>>>>>>>        // Parent (Server) file structure...............
48109>>>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
48110>>>>>>>>>>>>>
48110>>>>>>>>>>>>>        // Field-based properties.......................
48110>>>>>>>>>>>>>
48110>>>>>>>>>>>>>        // Pmsdtl.Pms_Recr
48110>>>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
48111>>>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
48112>>>>>>>>>>>>>
48112>>>>>>>>>>>>>        // Pmsdtl.Line1
48112>>>>>>>>>>>>>
48112>>>>>>>>>>>>>        // Pmsdtl.Line2
48112>>>>>>>>>>>>>
48112>>>>>>>>>>>>>        // Pmsdtl.Line3
48112>>>>>>>>>>>>>
48112>>>>>>>>>>>>>        // Pmsdtl.Line4
48112>>>>>>>>>>>>>
48112>>>>>>>>>>>>>        // Pmsdtl.Line5
48112>>>>>>>>>>>>>
48112>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48112>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48113>>>>>>>>>>>>>
48113>>>>>>>>>>>>>    // Field_Defaults:
48113>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48113>>>>>>>>>>>>>
48113>>>>>>>>>>>>>    Procedure Field_Defaults
48114>>>>>>>>>>>>>        Forward Send Field_Defaults
48116>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48116>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48116>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48116>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48117>>>>>>>>>>>>>
48117>>>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
48118>>>>>>>>>>>>>//DDB-FileEnd
48118>>>>>>>>>>>    Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
48118>>>>>>>>>>>>>//DDB-FileStart
48118>>>>>>>>>>>>>//DDB-HeaderStart
48118>>>>>>>>>>>>>
48118>>>>>>>>>>>>>// File Name : BAXIOKAT.DD
48118>>>>>>>>>>>>>// Class Name: Baxiokat_DataDictionary
48118>>>>>>>>>>>>>// Revision  : 45
48118>>>>>>>>>>>>>// Version   : 2
48118>>>>>>>>>>>>>
48118>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48118>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48118>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48118>>>>>>>>>>>>>
48118>>>>>>>>>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
48120>>>>>>>>>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
48122>>>>>>>>>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
48124>>>>>>>>>>>>>Open Tpclient
48126>>>>>>>>>>>>>Open Tperga
48128>>>>>>>>>>>>>Open Tparticl
48130>>>>>>>>>>>>>Open Sysrecb
INCLUDING FILE: SYSRECB.FD
48132>>>>>>>>>>>>>
48132>>>>>>>>>>>>>//DDB-HeaderEnd
48132>>>>>>>>>>>>>//DDB-ValidationStart
48132>>>>>>>>>>>>>
48132>>>>>>>>>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
48132>>>>>>>>>>>>>
48132>>>>>>>>>>>>>Register_Object Baxiokat_Type_VT
48132>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
48132>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
48132>>>>>>>>>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
48132>>>>>>>>>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
INCLUDING FILE: BAXIO.PKG
48132>>>>>>>>>>>>>>>// **************************************************************************
48132>>>>>>>>>>>>>>>// *Code Style   : Object                                                   *
48132>>>>>>>>>>>>>>>// *Name         : Baxio.vts                                                *
48132>>>>>>>>>>>>>>>// *Revision     : 1                                                        *
48132>>>>>>>>>>>>>>>// *Main File    :                                                          *
48132>>>>>>>>>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
48132>>>>>>>>>>>>>>>// *Creation Date: 01/09/99                                                 *
48132>>>>>>>>>>>>>>>// *Last Update  :                                                          *
48132>>>>>>>>>>>>>>>// *Author       : JA                                                       *
48132>>>>>>>>>>>>>>>// *Includes     :                                                          *
48132>>>>>>>>>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
48132>>>>>>>>>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
48132>>>>>>>>>>>>>>>// *             :                                                          *
48132>>>>>>>>>>>>>>>// *             :                                                          *
48132>>>>>>>>>>>>>>>// *Returns      :                                                          *
48132>>>>>>>>>>>>>>>// *             :                                                          *
48132>>>>>>>>>>>>>>>// *‰nown bugs   :                                                          *
48132>>>>>>>>>>>>>>>// *             :                                                          *
48132>>>>>>>>>>>>>>>// *Improvements :                                                          *
48132>>>>>>>>>>>>>>>// *             :                                                          *
48132>>>>>>>>>>>>>>>// *             :                                                          *
48132>>>>>>>>>>>>>>>// **************************************************************************
48132>>>>>>>>>>>>>>>// *                        A N A L Y S I S                                 *
48132>>>>>>>>>>>>>>>// **************************************************************************
48132>>>>>>>>>>>>>>>// *                                                                        *
48132>>>>>>>>>>>>>>>// **************************************************************************
48132>>>>>>>>>>>>>>>
48132>>>>>>>>>>>>>>>
48132>>>>>>>>>>>>>>>//Set Allow_Blank_State To TRUE
48132>>>>>>>>>>>>>>>
48132>>>>>>>>>>>>>>>//used by: 1. baxiokat.baxiokat_type
48132>>>>>>>>>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
48134>>>>>>>>>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
48135>>>>>>>>>>>>>>>       Procedure Fill_List
48137>>>>>>>>>>>>>>>                 Forward Send Fill_List
48139>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
48140>>>>>>>>>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
48141>>>>>>>>>>>>>>>       End_Procedure //fill_list
48142>>>>>>>>>>>>>>>End_Object   //Baxiokat_Type_VT
48143>>>>>>>>>>>>>>>
48143>>>>>>>>>>>>>>>
48143>>>>>>>>>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
48143>>>>>>>>>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
48143>>>>>>>>>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
48143>>>>>>>>>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
48143>>>>>>>>>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
48143>>>>>>>>>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
48145>>>>>>>>>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
48146>>>>>>>>>>>>>>>       Procedure Fill_List
48148>>>>>>>>>>>>>>>                 Forward Send Fill_List
48150>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
48151>>>>>>>>>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
48152>>>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
48153>>>>>>>>>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
48154>>>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
48155>>>>>>>>>>>>>>>
48155>>>>>>>>>>>>>>>       End_Procedure // fill_list
48156>>>>>>>>>>>>>>>End_Object   //Baxio_Status_VT1
48157>>>>>>>>>>>>>>>
48157>>>>>>>>>>>>>>>
48157>>>>>>>>>>>>>>>
48157>>>>>>>>>>>>>>>//used by: 1. btypkin.btypkin_anti1
48157>>>>>>>>>>>>>>>//         2. btypkin.btypkin_anti2
48157>>>>>>>>>>>>>>>//         3. baxio.baxio_file_in
48157>>>>>>>>>>>>>>>//         4. baxio.baxio_file_out
48157>>>>>>>>>>>>>>>//         5. baxio.baxio_lfile
48157>>>>>>>>>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
48159>>>>>>>>>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
48160>>>>>>>>>>>>>>>       Procedure Fill_List
48162>>>>>>>>>>>>>>>                 Forward Send Fill_List
48164>>>>>>>>>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
48165>>>>>>>>>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
48166>>>>>>>>>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
48167>>>>>>>>>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
48168>>>>>>>>>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
48169>>>>>>>>>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
48170>>>>>>>>>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
48171>>>>>>>>>>>>>>>       End_Procedure // fill_list
48172>>>>>>>>>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
48173>>>>>>>>>>>>>>>
48173>>>>>>>>>>>>>
48173>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
48175>>>>>>>>>>>>>
48175>>>>>>>>>>>>>    Procedure Fill_List
48177>>>>>>>>>>>>>        Forward Send Fill_List
48179>>>>>>>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
48180>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
48181>>>>>>>>>>>>>    End_Procedure    // Fill_List
48182>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48182>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48182>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
48183>>>>>>>>>>>>>
48183>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
48185>>>>>>>>>>>>>    Set Type_Value        To "BANK"
48186>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48187>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48187>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48187>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
48188>>>>>>>>>>>>>
48188>>>>>>>>>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
48190>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48191>>>>>>>>>>>>>
48191>>>>>>>>>>>>>    Procedure Fill_List
48193>>>>>>>>>>>>>        Forward Send Fill_List
48195>>>>>>>>>>>>>        Send Add_Table_Value  "0"  ""
48196>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
48197>>>>>>>>>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
48198>>>>>>>>>>>>>    End_Procedure    // Fill_List
48199>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48199>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48199>>>>>>>>>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
48200>>>>>>>>>>>>>//DDB-ValidationEnd
48200>>>>>>>>>>>>>//DDB-SelectionStart
48200>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
48200>>>>>>>>>>>>>Register_Object SL034
48200>>>>>>>>>>>>>//DDB-SelectionEnd
48200>>>>>>>>>>>>>
48200>>>>>>>>>>>>>Open Syscurxr
48202>>>>>>>>>>>>>Open Btypkin
48204>>>>>>>>>>>>>Open Bkinkat
48206>>>>>>>>>>>>>
48206>>>>>>>>>>>>>
48206>>>>>>>>>>>>>// Apo Baxio_DD
48206>>>>>>>>>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
48206>>>>>>>>>>>>>//
48206>>>>>>>>>>>>>
48206>>>>>>>>>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
48207>>>>>>>>>>>>>
48207>>>>>>>>>>>>>     Procedure Creating
48208>>>>>>>>>>>>>        Forward Send Creating
48210>>>>>>>>>>>>>        // Insert Code Here
48210>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
48211>>>>>>>>>>>>>    End_Procedure   // Creating
48212>>>>>>>>>>>>>
48212>>>>>>>>>>>>>     Procedure Construct_Object
48213>>>>>>>>>>>>>               Forward Send Construct_Object
48215>>>>>>>>>>>>>
48215>>>>>>>>>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
48215>>>>>>>>>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
48215>>>>>>>>>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
48215>>>>>>>>>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
48215>>>>>>>>>>>>>               Property Integer piBarticl_dd  0
48216>>>>>>>>>>>>>               Property Integer piBmove_dd    0
48217>>>>>>>>>>>>>               Property Integer piBaxio_dd    0
48218>>>>>>>>>>>>>               Property Integer piBtypkin_dd 0
48219>>>>>>>>>>>>>     End_Procedure   //construct_object
48220>>>>>>>>>>>>>
48220>>>>>>>>>>>>>
48220>>>>>>>>>>>>>     //private
48220>>>>>>>>>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
48220>>>>>>>>>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
48220>>>>>>>>>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
48221>>>>>>>>>>>>>               String lsBaxio_C_Code_2
48222>>>>>>>>>>>>>        PROCEDURE_RETURN
48223>>>>>>>>>>>>>//jsjsjs 24/01/2001
48223>>>>>>>>>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
48223>>>>>>>>>>>>>
48223>>>>>>>>>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
48223>>>>>>>>>>>>>//jsjsjs 24/01/2001
48223>>>>>>>>>>>>>     End_Procedure //private.exit_baxiokat_code
48224>>>>>>>>>>>>>
48224>>>>>>>>>>>>>
48224>>>>>>>>>>>>>    //private
48224>>>>>>>>>>>>>    //¡˜¢œå«˜  ˜§æ:
48224>>>>>>>>>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
48224>>>>>>>>>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
48225>>>>>>>>>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
48226>>>>>>>>>>>>>
48226>>>>>>>>>>>>>        PROCEDURE_RETURN
48227>>>>>>>>>>>>>
48227>>>>>>>>>>>>>
48227>>>>>>>>>>>>>    End_Procedure //private.entry_gtypkin_code
48228>>>>>>>>>>>>>
48228>>>>>>>>>>>>>
48228>>>>>>>>>>>>>
48228>>>>>>>>>>>>>
48228>>>>>>>>>>>>>    Procedure Update
48229>>>>>>>>>>>>>          Forward Send Update
48231>>>>>>>>>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
48233>>>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Bank
48234>>>>>>>>>>>>>               Move "" to Baxiokat.Baxiokat_Lno
48235>>>>>>>>>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
48236>>>>>>>>>>>>>          End
48236>>>>>>>>>>>>>>
48236>>>>>>>>>>>>>    End_Procedure
48237>>>>>>>>>>>>>
48237>>>>>>>>>>>>>
48237>>>>>>>>>>>>>    Procedure Define_Fields
48238>>>>>>>>>>>>>        Forward Send Define_Fields
48240>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48240>>>>>>>>>>>>>        //DDB-DefineFieldStart
48240>>>>>>>>>>>>>
48240>>>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
48241>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48242>>>>>>>>>>>>>
48242>>>>>>>>>>>>>
48242>>>>>>>>>>>>>        // Child (Client) file structure................
48242>>>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
48243>>>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
48244>>>>>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
48245>>>>>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
48246>>>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
48247>>>>>>>>>>>>>
48247>>>>>>>>>>>>>        // External (System) file structure.............
48247>>>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
48248>>>>>>>>>>>>>
48248>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
48251>>>>>>>>>>>>>
48251>>>>>>>>>>>>>        // Field-based properties.......................
48251>>>>>>>>>>>>>
48251>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
48251>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
48252>>>>>>>>>>>>>
48252>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
48252>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
48253>>>>>>>>>>>>>
48253>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
48253>>>>>>>>>>>>>
48253>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Recr
48253>>>>>>>>>>>>>
48253>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
48253>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
48254>>>>>>>>>>>>>
48254>>>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
48254>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
48254>>>>>>>>>>>>>
48254>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
48254>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
48255>>>>>>>>>>>>>
48255>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
48255>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
48256>>>>>>>>>>>>>
48256>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
48256>>>>>>>>>>>>>
48256>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
48256>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
48257>>>>>>>>>>>>>
48257>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48257>>>>>>>>>>>>>
48257>>>>>>>>>>>>>        Set Main_File            To Baxiokat.File_Number
48258>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48259>>>>>>>>>>>>>
48259>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48260>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48261>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48262>>>>>>>>>>>>>
48262>>>>>>>>>>>>>        // Child (Client) file structure................
48262>>>>>>>>>>>>>        Send Add_Client_File  Baxio.File_Number
48263>>>>>>>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
48264>>>>>>>>>>>>>
48264>>>>>>>>>>>>>        // External (System) file structure.............
48264>>>>>>>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
48265>>>>>>>>>>>>>
48265>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
48268>>>>>>>>>>>>>
48268>>>>>>>>>>>>>        // Field-based properties.......................
48268>>>>>>>>>>>>>
48268>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Code
48268>>>>>>>>>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
48269>>>>>>>>>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
48270>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
48271>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
48272>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
48273>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
48274>>>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
48275>>>>>>>>>>>>>
48275>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Descr
48275>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
48276>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
48277>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
48278>>>>>>>>>>>>>
48278>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Rec0
48278>>>>>>>>>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
48279>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
48280>>>>>>>>>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
48281>>>>>>>>>>>>>
48281>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Type
48281>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
48282>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
48283>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
48284>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
48285>>>>>>>>>>>>>
48285>>>>>>>>>>>>>        // Baxiokat.Baxio_Lcode
48285>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
48286>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
48287>>>>>>>>>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
48287>>>>>>>>>>>>>
48287>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Yn5390
48287>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
48288>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
48289>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
48290>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
48291>>>>>>>>>>>>>
48291>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Bank
48291>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
48292>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
48293>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
48294>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
48295>>>>>>>>>>>>>
48295>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Lno
48295>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
48296>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
48297>>>>>>>>>>>>>
48297>>>>>>>>>>>>>        // Baxiokat.Baxiokat_Formul
48297>>>>>>>>>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
48298>>>>>>>>>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
48299>>>>>>>>>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
48300>>>>>>>>>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
48301>>>>>>>>>>>>>
48301>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48302>>>>>>>>>>>>>
48302>>>>>>>>>>>>>
48302>>>>>>>>>>>>>    Procedure Field_Defaults
48303>>>>>>>>>>>>>        Forward Send Field_Defaults
48305>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48305>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48305>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48305>>>>>>>>>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
48306>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48307>>>>>>>>>>>>>
48307>>>>>>>>>>>>>End_Class    // Baxiokat_DataDictionary
48308>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48308>>>>>>>>>>>>>
48308>>>>>>>>>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
48308>>>>>>>>>>>>>>>//AB/ Project SL034:BAXIOKAT
48308>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48308>>>>>>>>>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
48308>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
48308>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>// Project Object Structure
48308>>>>>>>>>>>>>>>//   SL034 is a dbModalPanelSub
48308>>>>>>>>>>>>>>>//     Baxiokat_DD is a DataDictionary
48308>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48308>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48308>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48308>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>// Register all objects
48308>>>>>>>>>>>>>>>Register_Object Baxiokat_DD
48308>>>>>>>>>>>>>>>Register_Object oCancel_bn
48308>>>>>>>>>>>>>>>Register_Object oOK_bn
48308>>>>>>>>>>>>>>>Register_Object oSearch_bn
48308>>>>>>>>>>>>>>>Register_Object oSelList
48308>>>>>>>>>>>>>>>Register_Object SL034
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>//AB-IgnoreStart
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48308>>>>>>>>>>>>>>>Use dbList.Sub
48308>>>>>>>>>>>>>>>Use Button.Sub
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>Use BAXIOKAT.DD
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>//AB-IgnoreEnd
48308>>>>>>>>>>>>>>>
48308>>>>>>>>>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
48327>>>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
48328>>>>>>>>>>>>>>>    Set Size to 206 347
48329>>>>>>>>>>>>>>>    Set Location to 4 5
48330>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48331>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48332>>>>>>>>>>>>>>>
48332>>>>>>>>>>>>>>>    //AB-DDOStart
48332>>>>>>>>>>>>>>>
48332>>>>>>>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
48334>>>>>>>>>>>>>>>    End_Object    // Baxiokat_DD
48335>>>>>>>>>>>>>>>
48335>>>>>>>>>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
48336>>>>>>>>>>>>>>>    Set Server to (Baxiokat_DD(self))
48337>>>>>>>>>>>>>>>
48337>>>>>>>>>>>>>>>    //AB-DDOEnd
48337>>>>>>>>>>>>>>>
48337>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48339>>>>>>>>>>>>>>>        Set Main_File to Baxiokat.File_Number
48340>>>>>>>>>>>>>>>        Set Size to 164 335
48341>>>>>>>>>>>>>>>        Set Location to 5 4
48342>>>>>>>>>>>>>>>
48342>>>>>>>>>>>>>>>        Begin_Row
48345>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
48346>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
48347>>>>>>>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
48348>>>>>>>>>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
48349>>>>>>>>>>>>>>>        End_Row
48354>>>>>>>>>>>>>>>
48354>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
48355>>>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
48356>>>>>>>>>>>>>>>
48356>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 172
48357>>>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
48358>>>>>>>>>>>>>>>
48358>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 16
48359>>>>>>>>>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
48360>>>>>>>>>>>>>>>
48360>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 83
48361>>>>>>>>>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
48362>>>>>>>>>>>>>>>
48362>>>>>>>>>>>>>>>    End_Object    // oSelList
48363>>>>>>>>>>>>>>>
48363>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48365>>>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
48366>>>>>>>>>>>>>>>        Set Location to 172 180
48367>>>>>>>>>>>>>>>
48367>>>>>>>>>>>>>>>        //AB-StoreStart
48367>>>>>>>>>>>>>>>        Procedure OnClick
48369>>>>>>>>>>>>>>>            Send OK To oSelList
48370>>>>>>>>>>>>>>>        End_Procedure
48371>>>>>>>>>>>>>>>        //AB-StoreEnd
48371>>>>>>>>>>>>>>>
48371>>>>>>>>>>>>>>>    End_Object    // oOK_bn
48372>>>>>>>>>>>>>>>
48372>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48374>>>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
48375>>>>>>>>>>>>>>>        Set Location to 172 234
48376>>>>>>>>>>>>>>>
48376>>>>>>>>>>>>>>>        //AB-StoreStart
48376>>>>>>>>>>>>>>>        Procedure OnClick
48378>>>>>>>>>>>>>>>            Send Cancel To oSelList
48379>>>>>>>>>>>>>>>        End_Procedure
48380>>>>>>>>>>>>>>>        //AB-StoreEnd
48380>>>>>>>>>>>>>>>
48380>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
48381>>>>>>>>>>>>>>>
48381>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48383>>>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
48384>>>>>>>>>>>>>>>        Set Location to 172 289
48385>>>>>>>>>>>>>>>
48385>>>>>>>>>>>>>>>        //AB-StoreStart
48385>>>>>>>>>>>>>>>        Procedure OnClick
48387>>>>>>>>>>>>>>>            Send Search To oSelList
48388>>>>>>>>>>>>>>>        End_Procedure
48389>>>>>>>>>>>>>>>        //AB-StoreEnd
48389>>>>>>>>>>>>>>>
48389>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48390>>>>>>>>>>>>>>>
48390>>>>>>>>>>>>>>>
48390>>>>>>>>>>>>>>>    //AB-StoreStart
48390>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
48391>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
48392>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
48393>>>>>>>>>>>>>>>    //AB-StoreEnd
48393>>>>>>>>>>>>>>>
48393>>>>>>>>>>>>>>>CD_End_Object    // SL034
48395>>>>>>>>>>>>>>>>
48395>>>>>>>>>>>>>>>
48395>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48395>>>>>>>>>>>>>
48395>>>>>>>>>>>>>//DDB-Selection-pkg-End
48395>>>>>>>>>>>>>//DDB-FileEnd
48395>>>>>>>>>>>    Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
48395>>>>>>>>>>>>>//DDB-FileStart
48395>>>>>>>>>>>>>//DDB-HeaderStart
48395>>>>>>>>>>>>>
48395>>>>>>>>>>>>>// File Name : SYSCURXR.DD
48395>>>>>>>>>>>>>// Class Name: Syscurxr_DataDictionary
48395>>>>>>>>>>>>>// Revision  : 8
48395>>>>>>>>>>>>>// Version   : 2
48395>>>>>>>>>>>>>
48395>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48395>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48395>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48395>>>>>>>>>>>>>
48395>>>>>>>>>>>>>Open Syscurxr
48397>>>>>>>>>>>>>
48397>>>>>>>>>>>>>//DDB-HeaderEnd
48397>>>>>>>>>>>>>
48397>>>>>>>>>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
48398>>>>>>>>>>>>>
48398>>>>>>>>>>>>>    // Define_Fields:
48398>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48398>>>>>>>>>>>>>
48398>>>>>>>>>>>>>    Procedure Define_Fields
48399>>>>>>>>>>>>>        Forward Send Define_Fields
48401>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48401>>>>>>>>>>>>>        //DDB-DefineFieldStart
48401>>>>>>>>>>>>>
48401>>>>>>>>>>>>>        Set Main_File            To Syscurxr.File_Number
48402>>>>>>>>>>>>>
48402>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48403>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48404>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Field-based properties.......................
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Company_Code
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Branch_Code
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Year_Year
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Branch_Site
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Year_Recr
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Company_Name
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Branch_Name
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Year_Descr
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.C_Code0
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.C_Code00
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.C_Coder
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Year_Xrhshfrom
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Year_Xrhshto
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Beto_Site
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        // Syscurxr.Euro_Code
48405>>>>>>>>>>>>>
48405>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48405>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48406>>>>>>>>>>>>>
48406>>>>>>>>>>>>>    // Field_Defaults:
48406>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48406>>>>>>>>>>>>>
48406>>>>>>>>>>>>>    Procedure Field_Defaults
48407>>>>>>>>>>>>>        Forward Send Field_Defaults
48409>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48409>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48409>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48409>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48410>>>>>>>>>>>>>
48410>>>>>>>>>>>>>End_Class    // Syscurxr_DataDictionary
48411>>>>>>>>>>>>>//DDB-FileEnd
48411>>>>>>>>>>>    Use PMSSXET.DD
48411>>>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
48411>>>>>>>>>>>>>//DDB-FileStart
48411>>>>>>>>>>>>>//DDB-HeaderStart
48411>>>>>>>>>>>>>
48411>>>>>>>>>>>>>// File Name : SALESMEN.DD
48411>>>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
48411>>>>>>>>>>>>>// Revision  : 57
48411>>>>>>>>>>>>>// Version   : 2
48411>>>>>>>>>>>>>
48411>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48411>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48411>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48411>>>>>>>>>>>>>
48411>>>>>>>>>>>>>Open Salesmen
48413>>>>>>>>>>>>>Open Cn
48415>>>>>>>>>>>>>Open Sysrecc
48417>>>>>>>>>>>>>
48417>>>>>>>>>>>>>//DDB-HeaderEnd
48417>>>>>>>>>>>>>//DDB-ValidationStart
48417>>>>>>>>>>>>>
48417>>>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
48417>>>>>>>>>>>>>
48417>>>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
48419>>>>>>>>>>>>>    Set Type_Value        To "DOY"
48420>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48421>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
48422>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48422>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48422>>>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
48423>>>>>>>>>>>>>//DDB-ValidationEnd
48423>>>>>>>>>>>>>//DDB-SelectionStart
48423>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
48423>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
48423>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
48423>>>>>>>>>>>>>Register_Object sl108
48423>>>>>>>>>>>>>Register_Object sl198
48423>>>>>>>>>>>>>Register_Object sl197
48423>>>>>>>>>>>>>//DDB-SelectionEnd
48423>>>>>>>>>>>>>
48423>>>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
48424>>>>>>>>>>>>> 
48424>>>>>>>>>>>>>    // Save_Main_File:
48424>>>>>>>>>>>>> 
48424>>>>>>>>>>>>>    Procedure Save_Main_File
48425>>>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
48428>>>>>>>>>>>>>        Forward Send Save_Main_File
48430>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
48431>>>>>>>>>>>>> 
48431>>>>>>>>>>>>>    // Define_Fields:
48431>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48431>>>>>>>>>>>>>     Procedure Update
48432>>>>>>>>>>>>>        Forward Send Update
48434>>>>>>>>>>>>>        // Insert Code Here
48434>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
48435>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
48436>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
48437>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
48437>>>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
48438>>>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
48439>>>>>>>>>>>>>
48439>>>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
48439>>>>>>>>>>>>>
48439>>>>>>>>>>>>>        //betolink
48439>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
48440>>>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
48441>>>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
48442>>>>>>>>>>>>>
48442>>>>>>>>>>>>>    End_Procedure   // Update
48443>>>>>>>>>>>>>
48443>>>>>>>>>>>>>     Procedure Creating
48444>>>>>>>>>>>>>        Forward Send Creating
48446>>>>>>>>>>>>>        // Insert Code Here
48446>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
48447>>>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
48448>>>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
48449>>>>>>>>>>>>>    End_Procedure   // Creating
48450>>>>>>>>>>>>>
48450>>>>>>>>>>>>>    Procedure Define_Fields
48451>>>>>>>>>>>>>        Forward Send Define_Fields
48453>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48453>>>>>>>>>>>>>        //DDB-DefineFieldStart
48453>>>>>>>>>>>>>
48453>>>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
48454>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48455>>>>>>>>>>>>>
48455>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48456>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48457>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48458>>>>>>>>>>>>>
48458>>>>>>>>>>>>>        // Child (Client) file structure................
48458>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
48459>>>>>>>>>>>>>
48459>>>>>>>>>>>>>        // External (System) file structure.............
48459>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48460>>>>>>>>>>>>>
48460>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
48463>>>>>>>>>>>>>
48463>>>>>>>>>>>>>        // Field-based properties.......................
48463>>>>>>>>>>>>>
48463>>>>>>>>>>>>>        // Salesmen.Company_Code
48463>>>>>>>>>>>>>
48463>>>>>>>>>>>>>        // Salesmen.Branch_Code
48463>>>>>>>>>>>>>
48463>>>>>>>>>>>>>        // Salesmen.Year_Year
48463>>>>>>>>>>>>>
48463>>>>>>>>>>>>>        // Salesmen.Sls_Id
48463>>>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
48464>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
48465>>>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
48466>>>>>>>>>>>>>
48466>>>>>>>>>>>>>        // Salesmen.Sls_Name
48466>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Sls_Afm
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Sls_Rec0
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Sls_Recr
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Last_Xreosh
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Last_Pistosh
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Last_Order
48467>>>>>>>>>>>>>
48467>>>>>>>>>>>>>        // Salesmen.Sls_Doy
48467>>>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
48468>>>>>>>>>>>>>
48468>>>>>>>>>>>>>        // Salesmen.Sls_Address
48468>>>>>>>>>>>>>
48468>>>>>>>>>>>>>        // Salesmen.Sls_City
48468>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
48469>>>>>>>>>>>>>
48469>>>>>>>>>>>>>        // Salesmen.Sls_Area
48469>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Job
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Respons
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Zipcode
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Phone
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Fax
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Mobile
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Aoh
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Email
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Class
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Details
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Sitew
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Codem
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Categfpa
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Fpa
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Public
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Sn
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Repm
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Active
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Reported
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Lastupd
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Markexp
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Catjob
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Xreosh
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Pistosh
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Ypoloipo
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Plafon
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Overhead
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Add_No
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Nomos
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Sls_Xora
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        // Salesmen.Polh_Recr
48470>>>>>>>>>>>>>
48470>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48470>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48471>>>>>>>>>>>>>
48471>>>>>>>>>>>>>    // Field_Defaults:
48471>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48471>>>>>>>>>>>>>
48471>>>>>>>>>>>>>    Procedure Field_Defaults
48472>>>>>>>>>>>>>        Forward Send Field_Defaults
48474>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48474>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48474>>>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
48475>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48475>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48476>>>>>>>>>>>>>
48476>>>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
48477>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48477>>>>>>>>>>>>>
48477>>>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
48477>>>>>>>>>>>>>>>//AB/ Project sl108:polhtes
48477>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48477>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
48477>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
48477>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>// Project Object Structure
48477>>>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
48477>>>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
48477>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48477>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48477>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48477>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>// Register all objects
48477>>>>>>>>>>>>>>>Register_Object oCancel_bn
48477>>>>>>>>>>>>>>>Register_Object oOK_bn
48477>>>>>>>>>>>>>>>Register_Object oSearch_bn
48477>>>>>>>>>>>>>>>Register_Object oSelList
48477>>>>>>>>>>>>>>>Register_Object Salesmen_DD
48477>>>>>>>>>>>>>>>Register_Object sl108
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>//AB-IgnoreStart
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48477>>>>>>>>>>>>>>>Use dbList.Sub
48477>>>>>>>>>>>>>>>Use Button.Sub
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>Use SALESMEN.DD
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>//AB-IgnoreEnd
48477>>>>>>>>>>>>>>>
48477>>>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
48479>>>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
48480>>>>>>>>>>>>>>>    Set Size to 148 421
48481>>>>>>>>>>>>>>>    Set Location to 4 5
48482>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48483>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48484>>>>>>>>>>>>>>>
48484>>>>>>>>>>>>>>>    //AB-DDOStart
48484>>>>>>>>>>>>>>>
48484>>>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
48486>>>>>>>>>>>>>>>    End_Object    // Salesmen_DD
48487>>>>>>>>>>>>>>>
48487>>>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
48488>>>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
48489>>>>>>>>>>>>>>>
48489>>>>>>>>>>>>>>>    //AB-DDOEnd
48489>>>>>>>>>>>>>>>
48489>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48491>>>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
48492>>>>>>>>>>>>>>>        Set Size to 105 408
48493>>>>>>>>>>>>>>>        Set Location to 6 6
48494>>>>>>>>>>>>>>>
48494>>>>>>>>>>>>>>>        Begin_Row
48497>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
48498>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
48499>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
48500>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
48501>>>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
48502>>>>>>>>>>>>>>>        End_Row
48507>>>>>>>>>>>>>>>
48507>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
48508>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
48509>>>>>>>>>>>>>>>        
48509>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
48510>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
48511>>>>>>>>>>>>>>>        
48511>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
48512>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
48513>>>>>>>>>>>>>>>        
48513>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
48514>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
48515>>>>>>>>>>>>>>>        
48515>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
48516>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
48517>>>>>>>>>>>>>>>        
48517>>>>>>>>>>>>>>>    End_Object    // oSelList
48518>>>>>>>>>>>>>>>
48518>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48520>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48521>>>>>>>>>>>>>>>        Set Location to 117 255
48522>>>>>>>>>>>>>>>
48522>>>>>>>>>>>>>>>        //AB-StoreStart
48522>>>>>>>>>>>>>>>        Procedure OnClick
48524>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48525>>>>>>>>>>>>>>>        End_Procedure
48526>>>>>>>>>>>>>>>        //AB-StoreEnd
48526>>>>>>>>>>>>>>>
48526>>>>>>>>>>>>>>>    End_Object    // oOK_bn
48527>>>>>>>>>>>>>>>
48527>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48529>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48530>>>>>>>>>>>>>>>        Set Location to 117 310
48531>>>>>>>>>>>>>>>
48531>>>>>>>>>>>>>>>        //AB-StoreStart
48531>>>>>>>>>>>>>>>        Procedure OnClick
48533>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48534>>>>>>>>>>>>>>>        End_Procedure
48535>>>>>>>>>>>>>>>        //AB-StoreEnd
48535>>>>>>>>>>>>>>>
48535>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
48536>>>>>>>>>>>>>>>
48536>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48538>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48539>>>>>>>>>>>>>>>        Set Location to 117 365
48540>>>>>>>>>>>>>>>
48540>>>>>>>>>>>>>>>        //AB-StoreStart
48540>>>>>>>>>>>>>>>        Procedure OnClick
48542>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48543>>>>>>>>>>>>>>>        End_Procedure
48544>>>>>>>>>>>>>>>        //AB-StoreEnd
48544>>>>>>>>>>>>>>>
48544>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48545>>>>>>>>>>>>>>>
48545>>>>>>>>>>>>>>>
48545>>>>>>>>>>>>>>>    //AB-StoreStart
48545>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48546>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48547>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48548>>>>>>>>>>>>>>>    //AB-StoreEnd
48548>>>>>>>>>>>>>>>
48548>>>>>>>>>>>>>>>End_Object    // sl108
48549>>>>>>>>>>>>>>>
48549>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48549>>>>>>>>>>>>>Use sl198.sl         // sl198
48549>>>>>>>>>>>>>Use sl197.SL         // sl197
48549>>>>>>>>>>>>>
48549>>>>>>>>>>>>>//DDB-Selection-pkg-End
48549>>>>>>>>>>>>>//DDB-FileEnd
48549>>>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
48549>>>>>>>>>>>>>//DDB-FileStart
48549>>>>>>>>>>>>>//DDB-HeaderStart
48549>>>>>>>>>>>>>
48549>>>>>>>>>>>>>// File Name : CONSTRCT.DD
48549>>>>>>>>>>>>>// Class Name: Constrct_DataDictionary
48549>>>>>>>>>>>>>// Revision  : 49
48549>>>>>>>>>>>>>// Version   : 2
48549>>>>>>>>>>>>>
48549>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48549>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48549>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48549>>>>>>>>>>>>>
48549>>>>>>>>>>>>>Open Constrct
48551>>>>>>>>>>>>>Open Cn
48553>>>>>>>>>>>>>Open Sysrecc
48555>>>>>>>>>>>>>
48555>>>>>>>>>>>>>//DDB-HeaderEnd
48555>>>>>>>>>>>>>//DDB-ValidationStart
48555>>>>>>>>>>>>>
48555>>>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
48555>>>>>>>>>>>>>
48555>>>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
48557>>>>>>>>>>>>>    Set Type_Value        To "DOY"
48558>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48559>>>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
48560>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48560>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48560>>>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
48561>>>>>>>>>>>>>//DDB-ValidationEnd
48561>>>>>>>>>>>>>//DDB-SelectionStart
48561>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
48561>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
48561>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
48561>>>>>>>>>>>>>Register_Object sl109
48561>>>>>>>>>>>>>Register_Object sl198
48561>>>>>>>>>>>>>Register_Object sl197
48561>>>>>>>>>>>>>//DDB-SelectionEnd
48561>>>>>>>>>>>>>
48561>>>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
48562>>>>>>>>>>>>>    Procedure Update
48563>>>>>>>>>>>>>        Forward Send Update
48565>>>>>>>>>>>>>        // Insert Code Here
48565>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
48566>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
48567>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
48568>>>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
48568>>>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
48569>>>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
48570>>>>>>>>>>>>>
48570>>>>>>>>>>>>>        //betolink
48570>>>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
48571>>>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
48572>>>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
48573>>>>>>>>>>>>>
48573>>>>>>>>>>>>>    End_Procedure   // Update
48574>>>>>>>>>>>>>
48574>>>>>>>>>>>>>     Procedure Creating
48575>>>>>>>>>>>>>        Forward Send Creating
48577>>>>>>>>>>>>>        // Insert Code Here
48577>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
48578>>>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
48579>>>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
48580>>>>>>>>>>>>>    End_Procedure   // Creating
48581>>>>>>>>>>>>>
48581>>>>>>>>>>>>>
48581>>>>>>>>>>>>>    Procedure Define_Fields
48582>>>>>>>>>>>>>        Forward Send Define_Fields
48584>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48584>>>>>>>>>>>>>        //DDB-DefineFieldStart
48584>>>>>>>>>>>>>
48584>>>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
48585>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48586>>>>>>>>>>>>>
48586>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48587>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48588>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48589>>>>>>>>>>>>>
48589>>>>>>>>>>>>>        // Child (Client) file structure................
48589>>>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
48590>>>>>>>>>>>>>
48590>>>>>>>>>>>>>        // External (System) file structure.............
48590>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48591>>>>>>>>>>>>>
48591>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
48594>>>>>>>>>>>>>
48594>>>>>>>>>>>>>        // Field-based properties.......................
48594>>>>>>>>>>>>>
48594>>>>>>>>>>>>>        // Constrct.Company_Code
48594>>>>>>>>>>>>>
48594>>>>>>>>>>>>>        // Constrct.Branch_Code
48594>>>>>>>>>>>>>
48594>>>>>>>>>>>>>        // Constrct.Year_Year
48594>>>>>>>>>>>>>
48594>>>>>>>>>>>>>        // Constrct.Cnt_Id
48594>>>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
48595>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
48596>>>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
48597>>>>>>>>>>>>>
48597>>>>>>>>>>>>>        // Constrct.Cnt_Name
48597>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Cnt_Afm
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Cnt_Rec0
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Cnt_Recr
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Last_Xreosh
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Last_Pistosh
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Last_Order
48598>>>>>>>>>>>>>
48598>>>>>>>>>>>>>        // Constrct.Cnt_Doy
48598>>>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
48599>>>>>>>>>>>>>
48599>>>>>>>>>>>>>        // Constrct.Cnt_Address
48599>>>>>>>>>>>>>
48599>>>>>>>>>>>>>        // Constrct.Cnt_City
48599>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
48600>>>>>>>>>>>>>
48600>>>>>>>>>>>>>        // Constrct.Cnt_Area
48600>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Job
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Respons
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Zipcode
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Phone
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Fax
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Mobile
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Aoh
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Email
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Class
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Details
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Sitew
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Codem
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Categfpa
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Fpa
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Public
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Sn
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Repm
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Active
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Reported
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Pelprom
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Markexp
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Catjob
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Xreosh
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Pistosh
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Ypoloipo
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Plafon
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Overhead
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Add_No
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Nomos
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Cnt_Xora
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        // Constrct.Polh_Recr
48601>>>>>>>>>>>>>
48601>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48601>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48602>>>>>>>>>>>>>
48602>>>>>>>>>>>>>    // Field_Defaults:
48602>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48602>>>>>>>>>>>>>
48602>>>>>>>>>>>>>    Procedure Field_Defaults
48603>>>>>>>>>>>>>        Forward Send Field_Defaults
48605>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48605>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48605>>>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
48606>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48606>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48607>>>>>>>>>>>>>
48607>>>>>>>>>>>>>End_Class    // Constrct_DataDictionary
48608>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48608>>>>>>>>>>>>>
48608>>>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
48608>>>>>>>>>>>>>>>//AB/ Project sl109
48608>>>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48608>>>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
48608>>>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
48608>>>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>// Project Object Structure
48608>>>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
48608>>>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
48608>>>>>>>>>>>>>>>//     oSelList is a dbListSub
48608>>>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48608>>>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48608>>>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>// Register all objects
48608>>>>>>>>>>>>>>>Register_Object Constrct_DD
48608>>>>>>>>>>>>>>>Register_Object oCancel_bn
48608>>>>>>>>>>>>>>>Register_Object oOK_bn
48608>>>>>>>>>>>>>>>Register_Object oSearch_bn
48608>>>>>>>>>>>>>>>Register_Object oSelList
48608>>>>>>>>>>>>>>>Register_Object sl109
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>//AB-IgnoreStart
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>Use DFAllEnt.pkg
48608>>>>>>>>>>>>>>>Use dbList.Sub
48608>>>>>>>>>>>>>>>Use Button.Sub
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>Use CONSTRCT.DD
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>//AB-IgnoreEnd
48608>>>>>>>>>>>>>>>
48608>>>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
48610>>>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
48611>>>>>>>>>>>>>>>    Set Size to 148 427
48612>>>>>>>>>>>>>>>    Set Location to 4 5
48613>>>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48614>>>>>>>>>>>>>>>    Set Modal_State to FALSE
48615>>>>>>>>>>>>>>>
48615>>>>>>>>>>>>>>>    //AB-DDOStart
48615>>>>>>>>>>>>>>>
48615>>>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
48617>>>>>>>>>>>>>>>    End_Object    // Constrct_DD
48618>>>>>>>>>>>>>>>
48618>>>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
48619>>>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
48620>>>>>>>>>>>>>>>
48620>>>>>>>>>>>>>>>    //AB-DDOEnd
48620>>>>>>>>>>>>>>>
48620>>>>>>>>>>>>>>>    Object oSelList is a dbListSub
48622>>>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
48623>>>>>>>>>>>>>>>        Set Size to 105 415
48624>>>>>>>>>>>>>>>        Set Location to 6 6
48625>>>>>>>>>>>>>>>
48625>>>>>>>>>>>>>>>        Begin_Row
48628>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
48629>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
48630>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
48631>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
48632>>>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
48633>>>>>>>>>>>>>>>        End_Row
48638>>>>>>>>>>>>>>>
48638>>>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
48639>>>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48640>>>>>>>>>>>>>>>        
48640>>>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
48641>>>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
48642>>>>>>>>>>>>>>>        
48642>>>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
48643>>>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
48644>>>>>>>>>>>>>>>        
48644>>>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
48645>>>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
48646>>>>>>>>>>>>>>>        
48646>>>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
48647>>>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
48648>>>>>>>>>>>>>>>        
48648>>>>>>>>>>>>>>>    End_Object    // oSelList
48649>>>>>>>>>>>>>>>
48649>>>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48651>>>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48652>>>>>>>>>>>>>>>        Set Location to 116 261
48653>>>>>>>>>>>>>>>
48653>>>>>>>>>>>>>>>        //AB-StoreStart
48653>>>>>>>>>>>>>>>        Procedure OnClick
48655>>>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48656>>>>>>>>>>>>>>>        End_Procedure
48657>>>>>>>>>>>>>>>        //AB-StoreEnd
48657>>>>>>>>>>>>>>>
48657>>>>>>>>>>>>>>>    End_Object    // oOK_bn
48658>>>>>>>>>>>>>>>
48658>>>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48660>>>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48661>>>>>>>>>>>>>>>        Set Location to 116 315
48662>>>>>>>>>>>>>>>
48662>>>>>>>>>>>>>>>        //AB-StoreStart
48662>>>>>>>>>>>>>>>        Procedure OnClick
48664>>>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48665>>>>>>>>>>>>>>>        End_Procedure
48666>>>>>>>>>>>>>>>        //AB-StoreEnd
48666>>>>>>>>>>>>>>>
48666>>>>>>>>>>>>>>>    End_Object    // oCancel_bn
48667>>>>>>>>>>>>>>>
48667>>>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48669>>>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48670>>>>>>>>>>>>>>>        Set Location to 116 371
48671>>>>>>>>>>>>>>>
48671>>>>>>>>>>>>>>>        //AB-StoreStart
48671>>>>>>>>>>>>>>>        Procedure OnClick
48673>>>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48674>>>>>>>>>>>>>>>        End_Procedure
48675>>>>>>>>>>>>>>>        //AB-StoreEnd
48675>>>>>>>>>>>>>>>
48675>>>>>>>>>>>>>>>    End_Object    // oSearch_bn
48676>>>>>>>>>>>>>>>
48676>>>>>>>>>>>>>>>
48676>>>>>>>>>>>>>>>    //AB-StoreStart
48676>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48677>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48678>>>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48679>>>>>>>>>>>>>>>    //AB-StoreEnd
48679>>>>>>>>>>>>>>>
48679>>>>>>>>>>>>>>>End_Object    // sl109
48680>>>>>>>>>>>>>>>
48680>>>>>>>>>>>>>>>//AB/ End_Object    // prj
48680>>>>>>>>>>>>>Use sl198.sl         // sl198
48680>>>>>>>>>>>>>Use sl197.SL         // sl197
48680>>>>>>>>>>>>>
48680>>>>>>>>>>>>>//DDB-Selection-pkg-End
48680>>>>>>>>>>>>>//DDB-FileEnd
48680>>>>>>>>>>>    Use CN.DD
48680>>>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
48680>>>>>>>>>>>>>//DDB-FileStart
48680>>>>>>>>>>>>>//DDB-HeaderStart
48680>>>>>>>>>>>>>
48680>>>>>>>>>>>>>// File Name : PSXETIKA.DD
48680>>>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
48680>>>>>>>>>>>>>// Revision  : 14
48680>>>>>>>>>>>>>// Version   : 2
48680>>>>>>>>>>>>>
48680>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48680>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48680>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48680>>>>>>>>>>>>>
48680>>>>>>>>>>>>>Open Psxetika
48682>>>>>>>>>>>>>Open Particle
48684>>>>>>>>>>>>>Open Sysrecp
48686>>>>>>>>>>>>>
48686>>>>>>>>>>>>>//DDB-HeaderEnd
48686>>>>>>>>>>>>>
48686>>>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
48687>>>>>>>>>>>>>
48687>>>>>>>>>>>>>    Procedure Creating
48688>>>>>>>>>>>>>        Integer iNextNo
48689>>>>>>>>>>>>>        Forward Send Creating
48691>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
48692>>>>>>>>>>>>>    End_Procedure   // Creating
48693>>>>>>>>>>>>>
48693>>>>>>>>>>>>>    Procedure Update
48694>>>>>>>>>>>>>        Forward Send Update
48696>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
48697>>>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
48698>>>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
48699>>>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
48700>>>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
48701>>>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
48702>>>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
48703>>>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
48704>>>>>>>>>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
48705>>>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
48706>>>>>>>>>>>>>    End_Procedure   // Update
48707>>>>>>>>>>>>>
48707>>>>>>>>>>>>>
48707>>>>>>>>>>>>>    Procedure Request_Save
48708>>>>>>>>>>>>>        Number  nQty
48709>>>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
48709>>>>>>>>>>>>>
48709>>>>>>>>>>>>>        Forward Send Request_Save
48711>>>>>>>>>>>>>
48711>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
48712>>>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
48713>>>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
48715>>>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
48716>>>>>>>>>>>>>            If (nQty=0) Begin
48718>>>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
48718>>>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
48718>>>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
48718>>>>>>>>>>>>>                Delete Psxetika
48719>>>>>>>>>>>>>                Clear Psxetika
48720>>>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
48721>>>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
48722>>>>>>>>>>>>>                Find Eq Psxetika by Index.4
48723>>>>>>>>>>>>>>
48723>>>>>>>>>>>>>                If (Found) Delete Psxetika
48726>>>>>>>>>>>>>            End
48726>>>>>>>>>>>>>>
48726>>>>>>>>>>>>>        End
48726>>>>>>>>>>>>>>
48726>>>>>>>>>>>>>    End_Procedure
48727>>>>>>>>>>>>>
48727>>>>>>>>>>>>>
48727>>>>>>>>>>>>>    // Define_Fields:
48727>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48727>>>>>>>>>>>>>
48727>>>>>>>>>>>>>    Procedure Define_Fields
48728>>>>>>>>>>>>>        Forward Send Define_Fields
48730>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48730>>>>>>>>>>>>>        //DDB-DefineFieldStart
48730>>>>>>>>>>>>>
48730>>>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
48731>>>>>>>>>>>>>
48731>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
48732>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
48733>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48734>>>>>>>>>>>>>
48734>>>>>>>>>>>>>        // Parent (Server) file structure...............
48734>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48735>>>>>>>>>>>>>
48735>>>>>>>>>>>>>        // External (System) file structure.............
48735>>>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
48736>>>>>>>>>>>>>
48736>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Field-based properties.......................
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Company_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Branch_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Year_Year
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Ctypkin_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Wtypkin_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Ptyppar_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Pseira_Seira
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Custprom_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Client_Id
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Partl_No
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Partl_Hmnia
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Partl_Recr
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Psxetika_Recr
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Company_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Year_Year
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Client_Id
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Partl_No
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
48739>>>>>>>>>>>>>
48739>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48739>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48740>>>>>>>>>>>>>
48740>>>>>>>>>>>>>    // Field_Defaults:
48740>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48740>>>>>>>>>>>>>
48740>>>>>>>>>>>>>    Procedure Field_Defaults
48741>>>>>>>>>>>>>        Forward Send Field_Defaults
48743>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48743>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48743>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48743>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48744>>>>>>>>>>>>>
48744>>>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
48745>>>>>>>>>>>>>//DDB-FileEnd
48745>>>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
48745>>>>>>>>>>>>>//DDB-FileStart
48745>>>>>>>>>>>>>//DDB-HeaderStart
48745>>>>>>>>>>>>>
48745>>>>>>>>>>>>>// File Name : TPARTICL.DD
48745>>>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
48745>>>>>>>>>>>>>// Revision  : 28
48745>>>>>>>>>>>>>// Version   : 2
48745>>>>>>>>>>>>>
48745>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48745>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48745>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48745>>>>>>>>>>>>>
48745>>>>>>>>>>>>>Open Tparticl
48747>>>>>>>>>>>>>Open Particle
48749>>>>>>>>>>>>>Open Baxiokat
48751>>>>>>>>>>>>>Open Sysrecc
48753>>>>>>>>>>>>>
48753>>>>>>>>>>>>>//DDB-HeaderEnd
48753>>>>>>>>>>>>>//DDB-ValidationStart
48753>>>>>>>>>>>>>
48753>>>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
48753>>>>>>>>>>>>>
48753>>>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
48755>>>>>>>>>>>>>    Set Type_Value        To "HMERES"
48756>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48757>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48757>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48757>>>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
48758>>>>>>>>>>>>>//DDB-ValidationEnd
48758>>>>>>>>>>>>>
48758>>>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
48759>>>>>>>>>>>>>
48759>>>>>>>>>>>>>    Procedure Construct_Object
48760>>>>>>>>>>>>>        Forward Send Construct_Object
48762>>>>>>>>>>>>>        Property Integer piParticleID Public 0
48763>>>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
48764>>>>>>>>>>>>>    End_Procedure
48765>>>>>>>>>>>>>
48765>>>>>>>>>>>>>    Procedure End_Construct_Object
48766>>>>>>>>>>>>>        Integer iID
48767>>>>>>>>>>>>>        Forward Send End_Construct_Object
48769>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
48770>>>>>>>>>>>>>        Set piParticleID to iID
48771>>>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
48772>>>>>>>>>>>>>        Set piBaxiokatID to iID
48773>>>>>>>>>>>>>    End_Procedure
48774>>>>>>>>>>>>>
48774>>>>>>>>>>>>>    Procedure Calc_All_The_Fields
48775>>>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
48776>>>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
48776>>>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
48776>>>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
48776>>>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
48776>>>>>>>>>>>>>
48776>>>>>>>>>>>>>        Get piBaxiokatID                                                to iID
48777>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
48778>>>>>>>>>>>>>
48778>>>>>>>>>>>>>
48778>>>>>>>>>>>>>        Get piParticleID                                                to iID
48779>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
48780>>>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
48781>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
48782>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
48783>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
48784>>>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
48785>>>>>>>>>>>>>
48785>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
48785>>>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
48785>>>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
48785>>>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
48785>>>>>>>>>>>>>
48785>>>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
48785>>>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
48786>>>>>>>>>>>>>
48786>>>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
48786>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
48786>>>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
48786>>>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
48786>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
48786>>>>>>>>>>>>>//        Loop
48786>>>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
48786>>>>>>>>>>>>>
48786>>>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
48786>>>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
48786>>>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
48786>>>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
48786>>>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
48786>>>>>>>>>>>>>//        Loop
48786>>>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
48786>>>>>>>>>>>>>
48786>>>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
48786>>>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
48787>>>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
48789>>>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
48793>>>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
48794>>>>>>>>>>>>>            Loop
48795>>>>>>>>>>>>>>
48795>>>>>>>>>>>>>        End
48795>>>>>>>>>>>>>>
48795>>>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
48796>>>>>>>>>>>>>
48796>>>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
48797>>>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
48798>>>>>>>>>>>>>
48798>>>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
48798>>>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
48799>>>>>>>>>>>>>
48799>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
48800>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
48801>>>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
48802>>>>>>>>>>>>>
48802>>>>>>>>>>>>>    End_Procedure
48803>>>>>>>>>>>>>
48803>>>>>>>>>>>>>
48803>>>>>>>>>>>>>    Procedure Creating
48804>>>>>>>>>>>>>        Forward Send Creating
48806>>>>>>>>>>>>>        // Insert Code Here
48806>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
48807>>>>>>>>>>>>>    End_Procedure   // Creating
48808>>>>>>>>>>>>>
48808>>>>>>>>>>>>>
48808>>>>>>>>>>>>>    Procedure Save_Main_File
48809>>>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
48812>>>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
48814>>>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
48817>>>>>>>>>>>>>        End
48817>>>>>>>>>>>>>>
48817>>>>>>>>>>>>>      Forward Send Save_Main_File
48819>>>>>>>>>>>>>    End_Procedure   // Save_Main_File
48820>>>>>>>>>>>>>
48820>>>>>>>>>>>>>
48820>>>>>>>>>>>>>    // Define_Fields:
48820>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48820>>>>>>>>>>>>>
48820>>>>>>>>>>>>>    Procedure Define_Fields
48821>>>>>>>>>>>>>        Forward Send Define_Fields
48823>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48823>>>>>>>>>>>>>        //DDB-DefineFieldStart
48823>>>>>>>>>>>>>
48823>>>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
48824>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48825>>>>>>>>>>>>>
48825>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48826>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48827>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48828>>>>>>>>>>>>>
48828>>>>>>>>>>>>>        // Parent (Server) file structure...............
48828>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48829>>>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
48830>>>>>>>>>>>>>
48830>>>>>>>>>>>>>        // External (System) file structure.............
48830>>>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
48831>>>>>>>>>>>>>
48831>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
48834>>>>>>>>>>>>>
48834>>>>>>>>>>>>>        // Field-based properties.......................
48834>>>>>>>>>>>>>
48834>>>>>>>>>>>>>        // Tparticl.Partl_Recr
48834>>>>>>>>>>>>>
48834>>>>>>>>>>>>>        // Tparticl.Baxiokat_Code
48834>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
48835>>>>>>>>>>>>>
48835>>>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
48835>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
48836>>>>>>>>>>>>>
48836>>>>>>>>>>>>>        // Tparticl.Paralabh_Meres
48836>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
48837>>>>>>>>>>>>>
48837>>>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
48837>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
48838>>>>>>>>>>>>>
48838>>>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
48838>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
48839>>>>>>>>>>>>>
48839>>>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
48839>>>>>>>>>>>>>
48839>>>>>>>>>>>>>        // Tparticl.Tparticl_Recr
48839>>>>>>>>>>>>>
48839>>>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
48839>>>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
48840>>>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
48841>>>>>>>>>>>>>
48841>>>>>>>>>>>>>        // Tparticl.Poso
48841>>>>>>>>>>>>>
48841>>>>>>>>>>>>>        // Tparticl.Paralabh
48841>>>>>>>>>>>>>
48841>>>>>>>>>>>>>        // Tparticl.Exoflhsh
48841>>>>>>>>>>>>>
48841>>>>>>>>>>>>>        // Tparticl.Isok
48841>>>>>>>>>>>>>
48841>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48841>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>    // Field_Defaults:
48842>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>    Procedure Field_Defaults
48843>>>>>>>>>>>>>        Forward Send Field_Defaults
48845>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48845>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48845>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48845>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48846>>>>>>>>>>>>>
48846>>>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
48847>>>>>>>>>>>>>//DDB-FileEnd
48847>>>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
48847>>>>>>>>>>>>>//DDB-FileStart
48847>>>>>>>>>>>>>//DDB-HeaderStart
48847>>>>>>>>>>>>>
48847>>>>>>>>>>>>>// File Name : PARTLFPA.DD
48847>>>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
48847>>>>>>>>>>>>>// Revision  : 7
48847>>>>>>>>>>>>>// Version   : 2
48847>>>>>>>>>>>>>
48847>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48847>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48847>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48847>>>>>>>>>>>>>
48847>>>>>>>>>>>>>Open Partlfpa
48849>>>>>>>>>>>>>Open Particle
48851>>>>>>>>>>>>>Open Fpa
48853>>>>>>>>>>>>>
48853>>>>>>>>>>>>>//DDB-HeaderEnd
48853>>>>>>>>>>>>> 
48853>>>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
48854>>>>>>>>>>>>>
48854>>>>>>>>>>>>>
48854>>>>>>>>>>>>>    // Define_Fields:
48854>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48854>>>>>>>>>>>>>
48854>>>>>>>>>>>>>    Procedure Define_Fields
48855>>>>>>>>>>>>>        Forward Send Define_Fields
48857>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48857>>>>>>>>>>>>>        //DDB-DefineFieldStart
48857>>>>>>>>>>>>>
48857>>>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
48858>>>>>>>>>>>>>
48858>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48859>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48860>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48861>>>>>>>>>>>>>
48861>>>>>>>>>>>>>        // Parent (Server) file structure...............
48861>>>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
48862>>>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Field-based properties.......................
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Partl_Recr
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Poso_Fpa
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        // Partlfpa.Poso_Me_Fpa
48863>>>>>>>>>>>>>
48863>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48863>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48864>>>>>>>>>>>>>
48864>>>>>>>>>>>>>    // Field_Defaults:
48864>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48864>>>>>>>>>>>>>
48864>>>>>>>>>>>>>    Procedure Field_Defaults
48865>>>>>>>>>>>>>        Forward Send Field_Defaults
48867>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48867>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48867>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48867>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48868>>>>>>>>>>>>>
48868>>>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
48869>>>>>>>>>>>>>//DDB-FileEnd
48869>>>>>>>>>>>
48869>>>>>>>>>>>    //AB-StoreTopEnd
48869>>>>>>>>>>>
48869>>>>>>>>>>>    //AB-IgnoreStart
48869>>>>>>>>>>>
48869>>>>>>>>>>>    Use Bproces.Sub
48869>>>>>>>>>>>
48869>>>>>>>>>>>
48869>>>>>>>>>>>    //AB-IgnoreEnd
48869>>>>>>>>>>>
48869>>>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
48871>>>>>>>>>>>
48871>>>>>>>>>>>        //AB-StoreTopStart
48871>>>>>>>>>>>
48871>>>>>>>>>>>        Property    String  psParticleRecr0 Public ''
48873>>>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
48875>>>>>>>>>>>        Property    String  psClient_Desc   Public ''
48877>>>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
48879>>>>>>>>>>>        Property    String  psSeira_Seira   Public ''
48881>>>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
48883>>>>>>>>>>>        Property    Integer piPartl_No      Public  0
48885>>>>>>>>>>>        Property    Number  pnPosothta      Public  0
48887>>>>>>>>>>>
48887>>>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
48889>>>>>>>>>>>        End_Object    // Ctypkin_DD2
48890>>>>>>>>>>>
48890>>>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
48892>>>>>>>>>>>        End_Object    // Wtypkin_DD2
48893>>>>>>>>>>>
48893>>>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
48895>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
48896>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
48897>>>>>>>>>>>        End_Object    // Ptyppar_DD2
48898>>>>>>>>>>>
48898>>>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
48900>>>>>>>>>>>        End_Object    // Country_DD2
48901>>>>>>>>>>>
48901>>>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
48903>>>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
48904>>>>>>>>>>>        End_Object    // Towns_DD2
48905>>>>>>>>>>>
48905>>>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
48907>>>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
48908>>>>>>>>>>>        End_Object    // Cities_DD2
48909>>>>>>>>>>>
48909>>>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
48911>>>>>>>>>>>        End_Object    // Areas_DD2
48912>>>>>>>>>>>
48912>>>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
48914>>>>>>>>>>>        End_Object    // Payresp_DD2
48915>>>>>>>>>>>
48915>>>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
48917>>>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
48918>>>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
48919>>>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
48920>>>>>>>>>>>        End_Object    // Clients_DD2
48921>>>>>>>>>>>
48921>>>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
48923>>>>>>>>>>>        End_Object    // Nomisma_DD2
48924>>>>>>>>>>>
48924>>>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
48926>>>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
48927>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
48928>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
48929>>>>>>>>>>>        End_Object    // Particle_DD2
48930>>>>>>>>>>>
48930>>>>>>>>>>>
48930>>>>>>>>>>>        /////////////////////////////////////////////
48930>>>>>>>>>>>
48930>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
48932>>>>>>>>>>>        End_Object    // Ctypkin_DD
48933>>>>>>>>>>>
48933>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
48935>>>>>>>>>>>        End_Object    // Wtypkin_DD
48936>>>>>>>>>>>
48936>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
48938>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
48939>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
48940>>>>>>>>>>>        End_Object    // Ptyppar_DD
48941>>>>>>>>>>>
48941>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
48943>>>>>>>>>>>        End_Object    // Country_DD
48944>>>>>>>>>>>
48944>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
48946>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
48947>>>>>>>>>>>        End_Object    // Towns_DD
48948>>>>>>>>>>>
48948>>>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
48950>>>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
48951>>>>>>>>>>>        End_Object    // Cities_DD
48952>>>>>>>>>>>
48952>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
48954>>>>>>>>>>>        End_Object    // Areas_DD
48955>>>>>>>>>>>
48955>>>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
48957>>>>>>>>>>>        End_Object    // Payresp_DD
48958>>>>>>>>>>>
48958>>>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
48960>>>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
48961>>>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
48962>>>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
48963>>>>>>>>>>>        End_Object    // Clients_DD
48964>>>>>>>>>>>
48964>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
48966>>>>>>>>>>>        End_Object    // Nomisma_DD
48967>>>>>>>>>>>
48967>>>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
48969>>>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
48970>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
48971>>>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
48972>>>>>>>>>>>        End_Object    // Particle_DD
48973>>>>>>>>>>>
48973>>>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
48975>>>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
48976>>>>>>>>>>>            Set Constrain_File  to Particle.File_Number
48977>>>>>>>>>>>        End_Object
48978>>>>>>>>>>>
48978>>>>>>>>>>>
48978>>>>>>>>>>>        //AB-StoreTopEnd
48978>>>>>>>>>>>
48978>>>>>>>>>>>        Set Size to 60 100
48979>>>>>>>>>>>
48979>>>>>>>>>>>        //AB-DDOStart
48979>>>>>>>>>>>
48979>>>>>>>>>>>
48979>>>>>>>>>>>        //AB-DDOEnd
48979>>>>>>>>>>>
48979>>>>>>>>>>>
48979>>>>>>>>>>>        //AB-StoreStart
48979>>>>>>>>>>>
48979>>>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
48981>>>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
48982>>>>>>>>>>>            Date    dPartl_Hmnia
48982>>>>>>>>>>>            Integer iPartl_No
48982>>>>>>>>>>>
48982>>>>>>>>>>>            Send Clear          to Particle_DD2
48983>>>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
48984>>>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
48985>>>>>>>>>>>
48985>>>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
48986>>>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
48987>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
48988>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
48989>>>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
48990>>>>>>>>>>>
48990>>>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
48991>>>>>>>>>>>            Set psClient_Desc       to sClient_Desc
48992>>>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
48993>>>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
48994>>>>>>>>>>>            Set piPartl_No          to iPartl_No
48995>>>>>>>>>>>        End_Procedure
48996>>>>>>>>>>>
48996>>>>>>>>>>>
48996>>>>>>>>>>>        Procedure Make_The_Record
48998>>>>>>>>>>>
48998>>>>>>>>>>>            Set psPtyppar_Desc      to ''
48999>>>>>>>>>>>            Set psClient_Desc       to ''
49000>>>>>>>>>>>            Set psSeira_Seira       to ''
49001>>>>>>>>>>>            Set pdPartl_Hmnia       to ''
49002>>>>>>>>>>>            Set piPartl_No          to 0
49003>>>>>>>>>>>
49003>>>>>>>>>>>            Clear Psxetika
49004>>>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
49005>>>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
49006>>>>>>>>>>>            Find Eq Psxetika by index.4
49007>>>>>>>>>>>>
49007>>>>>>>>>>>
49007>>>>>>>>>>>            If (Not(Found)) Begin
49009>>>>>>>>>>>
49009>>>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
49010>>>>>>>>>>>
49010>>>>>>>>>>>                Send Clear to Particle_DD
49011>>>>>>>>>>>                Send Clear to Psxetika_DD
49012>>>>>>>>>>>
49012>>>>>>>>>>>                // Vres ton mpampa
49012>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
49013>>>>>>>>>>>                Send Find to Particle_DD Eq 2
49014>>>>>>>>>>>
49014>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
49015>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
49016>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
49017>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
49018>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
49019>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
49020>>>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
49021>>>>>>>>>>>
49021>>>>>>>>>>>                Send Request_Save               to Psxetika_DD
49022>>>>>>>>>>>
49022>>>>>>>>>>>
49022>>>>>>>>>>>                // Make also 2nd Record
49022>>>>>>>>>>>                Clear Psxetika
49023>>>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
49024>>>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
49025>>>>>>>>>>>                Find Eq Psxetika by index.4
49026>>>>>>>>>>>>
49026>>>>>>>>>>>
49026>>>>>>>>>>>                If (Not(Found)) Begin
49028>>>>>>>>>>>
49028>>>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
49029>>>>>>>>>>>
49029>>>>>>>>>>>                    Send Clear to Particle_DD
49030>>>>>>>>>>>                    Send Clear to Psxetika_DD
49031>>>>>>>>>>>
49031>>>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
49032>>>>>>>>>>>                    Send Find to Particle_DD Eq 2
49033>>>>>>>>>>>
49033>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
49034>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
49035>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
49036>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
49037>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
49038>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
49039>>>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
49040>>>>>>>>>>>                    Send Request_Save               to Psxetika_DD
49041>>>>>>>>>>>                End
49041>>>>>>>>>>>>
49041>>>>>>>>>>>            End
49041>>>>>>>>>>>>
49041>>>>>>>>>>>        End_Procedure
49042>>>>>>>>>>>
49042>>>>>>>>>>>        //AB-StoreEnd
49042>>>>>>>>>>>
49042>>>>>>>>>>>    End_Object    // Psx_Array
49043>>>>>>>>>>>
49043>>>>>>>>>>>
49043>>>>>>>>>>>    //AB-StoreStart
49043>>>>>>>>>>>
49043>>>>>>>>>>>    //AB-StoreEnd
49043>>>>>>>>>>>
49043>>>>>>>>>>>//AB/     End_Object    // prj
49043>>>>>>>>>//Use bpMakeSx.dg
49043>>>>>>>>>
49043>>>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
49044>>>>>>>>>
49044>>>>>>>>>    Procedure Construct_Object
49045>>>>>>>>>        Forward Send Construct_Object
49047>>>>>>>>>        Property Integer piFromCreate   Public 0
49048>>>>>>>>>    End_Procedure
49049>>>>>>>>>
49049>>>>>>>>>    Procedure Creating
49050>>>>>>>>>        Forward Send Creating
49052>>>>>>>>>        Set piFromCreate to 1
49053>>>>>>>>>    End_Procedure
49054>>>>>>>>>
49054>>>>>>>>>    Procedure Update
49055>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
49056>>>>>>>>>        Number  nQty
49056>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
49056>>>>>>>>>
49056>>>>>>>>>        Forward Send Update
49058>>>>>>>>>
49058>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
49059>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
49060>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
49061>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
49062>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
49063>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
49064>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
49065>>>>>>>>>
49065>>>>>>>>>
49065>>>>>>>>>        If (piFromCreate(Self)<>1) Begin
49067>>>>>>>>>            Add nQty to Pmoves.Pms_Qty
49068>>>>>>>>>            Saverecord Pmoves
49069>>>>>>>>>
49069>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
49070>>>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
49071>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
49072>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
49073>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
49074>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
49075>>>>>>>>>            Send DoProcess          to bpEnYpol
49076>>>>>>>>>
49076>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
49077>>>>>>>>>
49077>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49080>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49084>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49088>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49092>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49096>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49100>>>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49104>>>>>>>>>
49104>>>>>>>>>        End
49104>>>>>>>>>>
49104>>>>>>>>>
49104>>>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
49104>>>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
49104>>>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
49104>>>>>>>>>        // backout pou einai 3.
49104>>>>>>>>>        Move nQty to PmsSxet.Posothta
49105>>>>>>>>>
49105>>>>>>>>>
49105>>>>>>>>>        Clear Psxetika
49106>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
49107>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
49108>>>>>>>>>        Find Eq Psxetika by index.4
49109>>>>>>>>>>
49109>>>>>>>>>        If (Found) Begin
49111>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
49112>>>>>>>>>            Saverecord Psxetika
49113>>>>>>>>>        End
49113>>>>>>>>>>
49113>>>>>>>>>
49113>>>>>>>>>        Clear Psxetika
49114>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
49115>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
49116>>>>>>>>>        Find Eq Psxetika by index.4
49117>>>>>>>>>>
49117>>>>>>>>>        If (Found) Begin
49119>>>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
49120>>>>>>>>>            Saverecord Psxetika
49121>>>>>>>>>        End
49121>>>>>>>>>>
49121>>>>>>>>>    End_Procedure
49122>>>>>>>>>
49122>>>>>>>>>    Procedure Backout
49123>>>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
49124>>>>>>>>>        Number  nQty
49124>>>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
49124>>>>>>>>>
49124>>>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
49125>>>>>>>>>        Move Particle.Partl_Recr                to sRecr1
49126>>>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
49127>>>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
49128>>>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
49129>>>>>>>>>        Move PmsSxet.Posothta                   to nQty
49130>>>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
49131>>>>>>>>>
49131>>>>>>>>>        Forward Send Backout
49133>>>>>>>>>
49133>>>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
49134>>>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
49135>>>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
49136>>>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
49137>>>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
49138>>>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
49139>>>>>>>>>        Send DoProcess          to bpEnYpol
49140>>>>>>>>>
49140>>>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
49141>>>>>>>>>
49141>>>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
49144>>>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
49148>>>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
49152>>>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
49156>>>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
49160>>>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
49164>>>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
49168>>>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
49172>>>>>>>>>
49172>>>>>>>>>        Clear Psxetika
49173>>>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
49174>>>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
49175>>>>>>>>>        Find Eq Psxetika by index.4
49176>>>>>>>>>>
49176>>>>>>>>>        If (Found) Begin
49178>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
49179>>>>>>>>>            Saverecord Psxetika
49180>>>>>>>>>        End
49180>>>>>>>>>>
49180>>>>>>>>>
49180>>>>>>>>>        Clear Psxetika
49181>>>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
49182>>>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
49183>>>>>>>>>        Find Eq Psxetika by index.4
49184>>>>>>>>>>
49184>>>>>>>>>        If (Found) Begin
49186>>>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
49187>>>>>>>>>            Saverecord Psxetika
49188>>>>>>>>>        End
49188>>>>>>>>>>
49188>>>>>>>>>    End_Procedure
49189>>>>>>>>>
49189>>>>>>>>>    Procedure Request_Save
49190>>>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
49191>>>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
49191>>>>>>>>>        Number  nQty
49191>>>>>>>>>
49191>>>>>>>>>        Set piFromCreate to 0
49192>>>>>>>>>
49192>>>>>>>>>        Forward Send Request_Save
49194>>>>>>>>>
49194>>>>>>>>>        If (piFromCreate(Self)=1) Begin
49196>>>>>>>>>            Set piFromCreate                                                to 0
49197>>>>>>>>>
49197>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
49198>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
49199>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
49200>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
49201>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
49202>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
49203>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
49204>>>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
49205>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
49206>>>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
49207>>>>>>>>>
49207>>>>>>>>>            Set pnQty               Of bpEnYpol to nQty
49208>>>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
49209>>>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
49210>>>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
49211>>>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
49212>>>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
49213>>>>>>>>>            Send DoProcess          to bpEnYpol
49214>>>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
49215>>>>>>>>>
49215>>>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49218>>>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49222>>>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49226>>>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49230>>>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
49234>>>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
49238>>>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
49242>>>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
49246>>>>>>>>>
49246>>>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
49247>>>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
49248>>>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
49249>>>>>>>>>            Send Make_The_Record    Of Psx_Array
49250>>>>>>>>>
49250>>>>>>>>>            // Xana vres tis eggrafes
49250>>>>>>>>>            Clear Particle
49251>>>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
49252>>>>>>>>>            Find Eq Particle by index.2
49253>>>>>>>>>>
49253>>>>>>>>>
49253>>>>>>>>>            Clear Pmoves
49254>>>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
49255>>>>>>>>>            Find Eq Pmoves by index.2
49256>>>>>>>>>>
49256>>>>>>>>>
49256>>>>>>>>>            Clear PmsSxet
49257>>>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
49258>>>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
49259>>>>>>>>>            Find Eq PmsSxet by Index.1
49260>>>>>>>>>>
49260>>>>>>>>>
49260>>>>>>>>>        End
49260>>>>>>>>>>
49260>>>>>>>>>    End_Procedure
49261>>>>>>>>>
49261>>>>>>>>>
49261>>>>>>>>>    Procedure Define_Fields
49262>>>>>>>>>        Forward Send Define_Fields
49264>>>>>>>>>        //DDB-Generated-Code-Location
49264>>>>>>>>>        //DDB-DefineFieldStart
49264>>>>>>>>>
49264>>>>>>>>>        Set Main_File            To Pmssxet.File_Number
49265>>>>>>>>>
49265>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
49266>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
49267>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49268>>>>>>>>>
49268>>>>>>>>>        // Parent (Server) file structure...............
49268>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
49269>>>>>>>>>
49269>>>>>>>>>        // External (System) file structure.............
49269>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
49270>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
49271>>>>>>>>>
49271>>>>>>>>>        // Field-based properties.......................
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Pms_Recr
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sxetiko_Recr
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Posothta
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Arx_Partl_Recr
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sx_Parast
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sx_Hmnia
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sx_Foreas
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sx_Arithmos
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sx_Seira
49271>>>>>>>>>
49271>>>>>>>>>        // Pmssxet.Sx_Posothta
49271>>>>>>>>>
49271>>>>>>>>>        //DDB-DefineFieldEnd
49271>>>>>>>>>    End_Procedure    // Define_Fields
49272>>>>>>>>>
49272>>>>>>>>>    Procedure Field_Defaults
49273>>>>>>>>>        Forward Send Field_Defaults
49275>>>>>>>>>        //DDB-Generated-Code-Location
49275>>>>>>>>>        //DDB-FieldDefaultStart
49275>>>>>>>>>        //DDB-FieldDefaultEnd
49275>>>>>>>>>    End_Procedure    // Field_Defaults
49276>>>>>>>>>
49276>>>>>>>>>End_Class    // Pmssxet_DataDictionary
49277>>>>>>>>>//DDB-FileEnd
49277>>>>>>>
49277>>>>>>>Class Cmoves_DataDictionary  is a DataDictionary
49278>>>>>>>
49278>>>>>>>    Procedure Construct_Object
49279>>>>>>>        Forward Send Construct_Object
49281>>>>>>>        Property Integer piFromBP           Public 0
49282>>>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
49283>>>>>>>        Property Integer piFromSysxet       Public 0   
49284>>>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
49285>>>>>>>    End_Procedure
49286>>>>>>>
49286>>>>>>>    Function Validate_Save  Returns Integer
49287>>>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
49288>>>>>>>        String sModule
49288>>>>>>>        get pifromxrhsh to ifromxrhsh
49289>>>>>>>        Forward Get Validate_Save  To iReturnVal
49291>>>>>>>        If (Not(iReturnVal)) Begin
49293>>>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
49296>>>>>>>            Clear Branch
49297>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
49298>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
49299>>>>>>>            Find Eq Branch By Index.1
49300>>>>>>>>
49300>>>>>>>            If (Not(Found)) Move 6666 to iReturnVal
49303>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
49307>>>>>>>            
49307>>>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
49309>>>>>>>                Move 10101 to iReturnVal
49310>>>>>>>            End
49310>>>>>>>>
49310>>>>>>>            Else Begin
49311>>>>>>>                
49311>>>>>>>                Move Ctypkin.Check_Overhead to iCheck
49312>>>>>>>                If (iCheck) Begin
49314>>>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
49316>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
49317>>>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
49320>>>>>>>                    End
49320>>>>>>>>
49320>>>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
49323>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
49324>>>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
49327>>>>>>>                    End
49327>>>>>>>>
49327>>>>>>>                End
49327>>>>>>>>
49327>>>>>>>                
49327>>>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49330>>>>>>>                
49330>>>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
49333>>>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
49337>>>>>>>                
49337>>>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
49337>>>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
49341>>>>>>>                Else Begin
49342>>>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
49345>>>>>>>                    Else Begin
49346>>>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
49348>>>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
49351>>>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
49354>>>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
49357>>>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
49360>>>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
49363>>>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
49367>>>>>>>                                End
49367>>>>>>>>
49367>>>>>>>                            End
49367>>>>>>>>
49367>>>>>>>                        End
49367>>>>>>>>
49367>>>>>>>                    End
49367>>>>>>>>
49367>>>>>>>                End
49367>>>>>>>>
49367>>>>>>>            End
49367>>>>>>>>
49367>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49370>>>>>>>        End
49370>>>>>>>>
49370>>>>>>>        Function_Return iReturnVal
49371>>>>>>>    End_Function   // Validate_Save
49372>>>>>>>
49372>>>>>>>    Function Validate_Delete  Returns Integer
49373>>>>>>>        Integer iReturnVal
49374>>>>>>>        String sModule
49374>>>>>>>        Forward Get Validate_Delete  To iReturnVal
49376>>>>>>>        If (Not(iReturnVal)) Begin
49378>>>>>>>
49378>>>>>>>            Clear Branch
49379>>>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
49380>>>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
49381>>>>>>>            Find Eq Branch By Index.1
49382>>>>>>>>
49382>>>>>>>            If (Not(Found)) Move 6668 to iReturnVal
49385>>>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
49389>>>>>>>            
49389>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49392>>>>>>>            
49392>>>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
49395>>>>>>>            Else If (piFromBP(Self)<>1) Begin
49398>>>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
49401>>>>>>>                Else Begin
49402>>>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
49405>>>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
49408>>>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
49411>>>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
49415>>>>>>>                    End
49415>>>>>>>>
49415>>>>>>>                End
49415>>>>>>>>
49415>>>>>>>            End
49415>>>>>>>>
49415>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49418>>>>>>>        End
49418>>>>>>>>
49418>>>>>>>        Function_Return iReturnVal
49419>>>>>>>    End_Function   // Validate_Delete
49420>>>>>>>
49420>>>>>>>    Procedure Save_Main_File
49421>>>>>>>        If (Operation_Origin<>Self) Begin
49423>>>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
49426>>>>>>>        End
49426>>>>>>>>
49426>>>>>>>        If (Cmoves.Cn_Code<>'') Begin
49428>>>>>>>            Clear Cn
49429>>>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
49430>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
49431>>>>>>>>
49431>>>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
49432>>>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
49433>>>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
49434>>>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
49435>>>>>>>        End
49435>>>>>>>>
49435>>>>>>>        Else Begin
49436>>>>>>>            Move ''     to Cmoves.Sls_ID
49437>>>>>>>            Move ''     to Cmoves.Cnt_ID
49438>>>>>>>            Move ''     to Cmoves.Cn_Recr
49439>>>>>>>            Move ''     to Cmoves.Mhxanik_id
49440>>>>>>>        End
49440>>>>>>>>
49440>>>>>>>        Forward Send Save_Main_File
49442>>>>>>>    End_Procedure   // Save_Main_File
49443>>>>>>>
49443>>>>>>>
49443>>>>>>>    Procedure Update
49444>>>>>>>        String sNomisma
49445>>>>>>>        Forward Send Update
49447>>>>>>>        
49447>>>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
49449>>>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
49450>>>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
49451>>>>>>>        End
49451>>>>>>>>
49451>>>>>>>        
49451>>>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
49451>>>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
49454>>>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
49458>>>>>>>        
49458>>>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
49458>>>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
49459>>>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
49460>>>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
49461>>>>>>>
49461>>>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
49461>>>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
49464>>>>>>>
49464>>>>>>>
49464>>>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
49465>>>>>>>
49465>>>>>>>        ///an enhmeronei synolikh ofeilh pelath
49465>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
49467>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
49468>>>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
49469>>>>>>>        end
49469>>>>>>>>
49469>>>>>>>
49469>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
49471>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
49473>>>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
49474>>>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
49475>>>>>>>            End
49475>>>>>>>>
49475>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
49478>>>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
49479>>>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
49480>>>>>>>            End
49480>>>>>>>>
49480>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin
49482>>>>>>>                move 1 to clients.client_public  
49483>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
49484>>>>>>>                move '' to clients.status
49485>>>>>>>            end     
49485>>>>>>>>
49485>>>>>>>        End
49485>>>>>>>>
49485>>>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
49487>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
49489>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
49490>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
49491>>>>>>>            End
49491>>>>>>>>
49491>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
49494>>>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
49495>>>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
49496>>>>>>>            End
49496>>>>>>>>
49496>>>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin 
49498>>>>>>>                move 1 to clients.client_public
49499>>>>>>>                move '' to clients.status  
49500>>>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
49501>>>>>>>            end 
49501>>>>>>>>
49501>>>>>>>        End
49501>>>>>>>>
49501>>>>>>>
49501>>>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
49504>>>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
49508>>>>>>>
49508>>>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
49511>>>>>>>        Else Begin
49512>>>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
49513>>>>>>>            Move 0 to Cmoves.Axia_Sysxet
49514>>>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
49515>>>>>>>        End
49515>>>>>>>>
49515>>>>>>>
49515>>>>>>>        // js 23/01/2002
49515>>>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
49515>>>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
49515>>>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
49516>>>>>>>
49516>>>>>>>        // js 23/01/2002
49516>>>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
49516>>>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
49516>>>>>>>        // gia na emfanizei ta antistrofa sto copen
49516>>>>>>>        If (Ctypkin.Open_Item='1') Begin
49518>>>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
49520>>>>>>>                Move 1                          to Cmoves.Flag_Copen
49521>>>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
49524>>>>>>>            End
49524>>>>>>>>
49524>>>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
49527>>>>>>>                Move 2                          to Cmoves.Flag_Copen
49528>>>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
49531>>>>>>>            End
49531>>>>>>>>
49531>>>>>>>            Else Move 0 to Cmoves.Flag_Copen
49533>>>>>>>        End
49533>>>>>>>>
49533>>>>>>>        Else Move 0 to Cmoves.Flag_Copen
49535>>>>>>>    End_Procedure   // Update
49536>>>>>>>
49536>>>>>>>    Procedure Backout
49537>>>>>>>        Forward Send Backout
49539>>>>>>>
49539>>>>>>>        if (Cmoves.enhm_ofeilh='1') begin
49541>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
49542>>>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
49543>>>>>>>        end
49543>>>>>>>>
49543>>>>>>>
49543>>>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
49543>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
49543>>>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
49543>>>>>>>//        end
49543>>>>>>>
49543>>>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
49545>>>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
49547>>>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
49548>>>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
49549>>>>>>>            End
49549>>>>>>>>
49549>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
49552>>>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
49553>>>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
49554>>>>>>>            End
49554>>>>>>>>
49554>>>>>>>        End
49554>>>>>>>>
49554>>>>>>>    End_Procedure
49555>>>>>>>
49555>>>>>>>    Procedure Creating
49556>>>>>>>        Forward Send Creating
49558>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
49559>>>>>>>
49559>>>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
49559>>>>>>>
49559>>>>>>>        If (Ctypkin.Open_Item ='1') Begin
49561>>>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
49564>>>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
49568>>>>>>>        End
49568>>>>>>>>
49568>>>>>>>    End_Procedure   // Creating
49569>>>>>>>
49569>>>>>>>
49569>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49570>>>>>>>        String lsError_Message
49571>>>>>>>
49571>>>>>>>        Case Begin
49571>>>>>>>            
49571>>>>>>>            Case (iError_Num = 3263)
49573>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
49574>>>>>>>            Case Break
49575>>>>>>>            
49575>>>>>>>            Case (iError_Num = 6666)
49578>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
49579>>>>>>>            Case Break
49580>>>>>>>
49580>>>>>>>            Case (iError_Num = 6667)
49583>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
49584>>>>>>>            Case Break
49585>>>>>>>
49585>>>>>>>            Case (iError_Num = 6668)
49588>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
49589>>>>>>>            Case Break
49590>>>>>>>
49590>>>>>>>            Case (iError_Num = 6669)
49593>>>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
49594>>>>>>>            Case Break
49595>>>>>>>
49595>>>>>>>            Case (iError_Num = 22277)
49598>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
49599>>>>>>>            Case Break
49600>>>>>>>
49600>>>>>>>            Case (iError_Num = 22278)
49603>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
49604>>>>>>>            Case Break
49605>>>>>>>
49605>>>>>>>            Case (iError_Num = 22279)
49608>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
49609>>>>>>>            Case Break
49610>>>>>>>
49610>>>>>>>            Case (iError_Num = 11170)
49613>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
49614>>>>>>>            Case Break
49615>>>>>>>
49615>>>>>>>            Case (iError_Num = 11171)
49618>>>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
49619>>>>>>>            Case Break
49620>>>>>>>
49620>>>>>>>            Case (iError_Num = 11172)
49623>>>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
49624>>>>>>>            Case Break
49625>>>>>>>
49625>>>>>>>            Case (iError_Num = 22288)
49628>>>>>>>                Clear Codemast
49629>>>>>>>                Move "MODULE" to Codemast.Type
49630>>>>>>>                Move Cmoves.Module_From to Codemast.Code
49631>>>>>>>                Find Eq Codemast by Index.1 //type+code
49632>>>>>>>>
49632>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
49633>>>>>>>            Case Break
49634>>>>>>>
49634>>>>>>>            Case (iError_Num = 22250)
49637>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
49638>>>>>>>            Case Break
49639>>>>>>>
49639>>>>>>>            Case (iError_Num = 22284)
49642>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
49643>>>>>>>            Case Break
49644>>>>>>>            Case (iError_Num = 22283)
49647>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
49648>>>>>>>            Case Break
49649>>>>>>>            Case (iError_Num = 22282)
49652>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
49653>>>>>>>            Case Break
49654>>>>>>>
49654>>>>>>>            //˜§æ validate delete
49654>>>>>>>            Case (iError_Num = 22289)
49657>>>>>>>                Clear Codemast
49658>>>>>>>                Move "MODULE" to Codemast.Type
49659>>>>>>>                Move Cmoves.Module_From to Codemast.Code
49660>>>>>>>                Find Eq Codemast by Index.1 //type+code
49661>>>>>>>>
49661>>>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
49662>>>>>>>            Case Break
49663>>>>>>>
49663>>>>>>>            Case (iError_Num = 22287)
49666>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
49667>>>>>>>            Case Break
49668>>>>>>>            Case (iError_Num = 22286)
49671>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
49672>>>>>>>            Case Break
49673>>>>>>>            Case (iError_Num = 22285)
49676>>>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
49677>>>>>>>            Case Break
49678>>>>>>>
49678>>>>>>>            //â¢œš®¦  open items
49678>>>>>>>            Case (iError_Num = 10101)
49681>>>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
49682>>>>>>>            Case Break
49683>>>>>>>
49683>>>>>>>            Case Else
49683>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
49685>>>>>>>        Case End
49685>>>>>>>
49685>>>>>>>        Error iError_Num lsError_Message
49686>>>>>>>>
49686>>>>>>>    End_Procedure // operation_not_allowed
49687>>>>>>>
49687>>>>>>>
49687>>>>>>>    // Define_Fields:
49687>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49687>>>>>>>
49687>>>>>>>    Procedure Define_Fields
49688>>>>>>>        Forward Send Define_Fields
49690>>>>>>>        //DDB-Generated-Code-Location
49690>>>>>>>        //DDB-DefineFieldStart
49690>>>>>>>
49690>>>>>>>        Set Main_File            To Cmoves.File_Number
49691>>>>>>>        Set Cascade_Delete_State To FALSE
49692>>>>>>>
49692>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49693>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49694>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49695>>>>>>>
49695>>>>>>>        // Child (Client) file structure................
49695>>>>>>>        Send Add_Client_File  Copen.File_Number
49696>>>>>>>
49696>>>>>>>        // Parent (Server) file structure...............
49696>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
49697>>>>>>>        Send Add_Server_File  Clients.File_Number
49698>>>>>>>
49698>>>>>>>        // External (System) file structure.............
49698>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
49699>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49700>>>>>>>
49700>>>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
49703>>>>>>>
49703>>>>>>>        // Field-based properties.......................
49703>>>>>>>
49703>>>>>>>        // Cmoves.Company_Code
49703>>>>>>>
49703>>>>>>>        // Cmoves.Branch_Code
49703>>>>>>>
49703>>>>>>>        // Cmoves.Year_Year
49703>>>>>>>
49703>>>>>>>        // Cmoves.Custprom_Code
49703>>>>>>>
49703>>>>>>>        // Cmoves.Client_Id
49703>>>>>>>
49703>>>>>>>        // Cmoves.Ctypkin_Code
49703>>>>>>>
49703>>>>>>>        // Cmoves.Cmoves_Recr
49703>>>>>>>
49703>>>>>>>        // Cmoves.Cmoves_Rec0
49703>>>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
49704>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
49705>>>>>>>
49705>>>>>>>        // Cmoves.Cmoves_Hmnia
49705>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
49706>>>>>>>
49706>>>>>>>        // Cmoves.Ctypkin_Recr
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Par
49706>>>>>>>
49706>>>>>>>        // Cmoves.Partl_Recr
49706>>>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Axia
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_X0
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_P0
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_X00
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_P00
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_X1
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_P1
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_X2
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_P2
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Dlixis
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_A_Code
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Status_E
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Status_A
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_S0
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Ys0
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_S1
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Ys1
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_S2
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Ys2
49706>>>>>>>
49706>>>>>>>        // Cmoves.Cmoves_Sc_Code2
49706>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_Open
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_Aopen
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_M_Code
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_Yn_Myf
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_Myf_Axia
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_Kk
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cmoves_C_Code2
49707>>>>>>>
49707>>>>>>>        // Cmoves.Cn_Code
49707>>>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
49708>>>>>>>
49708>>>>>>>        // Cmoves.Client_Recr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Barticl_Recr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Qty
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Totambd0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Discam0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Totamad0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Vatam0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Extra0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Totambd00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Discam00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Totamad00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Vatam00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Extra00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Totambd1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Discam1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Totamad1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Vatam1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmove_Extra1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Module_From
49708>>>>>>>
49708>>>>>>>        // Cmoves.Parast_Abrev
49708>>>>>>>
49708>>>>>>>        // Cmoves.Enhm_Ypol_Pel
49708>>>>>>>
49708>>>>>>>        // Cmoves.Enhm_Hmnies_Pel
49708>>>>>>>
49708>>>>>>>        // Cmoves.Sls_Id
49708>>>>>>>
49708>>>>>>>        // Cmoves.Presp_Id
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cnt_Id
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Sx0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Sp0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Yx0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Yp0
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Sx1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Sp1
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Sx2
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Open_Sp2
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cmoves_Topen
49708>>>>>>>
49708>>>>>>>        // Cmoves.Cn_Recr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Pros_Sysx
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Sysxet
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Ypol_Sysx
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Pros_Sys00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Sysxet00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Ypol_Sys00
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Pros_Sysr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Sysxetr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Axia_Ypol_Sysr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Mhxanik_Id
49708>>>>>>>
49708>>>>>>>        // Cmoves.Prn_Theor
49708>>>>>>>
49708>>>>>>>        // Cmoves.Is_Closed
49708>>>>>>>
49708>>>>>>>        // Cmoves.Flag_Copen
49708>>>>>>>
49708>>>>>>>        // Cmoves.Flag_Ypol
49708>>>>>>>
49708>>>>>>>        // Cmoves.Ctypkin_Descr
49708>>>>>>>
49708>>>>>>>        // Cmoves.Client_Name
49708>>>>>>>
49708>>>>>>>        // Cmoves.Enhm_Ofeilh
49708>>>>>>>
49708>>>>>>>        // Cmoves.Sap_Hmnia
49708>>>>>>>
49708>>>>>>>        //DDB-DefineFieldEnd
49708>>>>>>>    End_Procedure    // Define_Fields
49709>>>>>>>
49709>>>>>>>    // Field_Defaults:
49709>>>>>>>    // This procedure is used to establish default field values.
49709>>>>>>>
49709>>>>>>>    Procedure Field_Defaults
49710>>>>>>>        Forward Send Field_Defaults
49712>>>>>>>        //DDB-Generated-Code-Location
49712>>>>>>>        //DDB-FieldDefaultStart
49712>>>>>>>        //DDB-FieldDefaultEnd
49712>>>>>>>    End_Procedure    // Field_Defaults
49713>>>>>>>
49713>>>>>>>End_Class    // Cmoves_DataDictionary
49714>>>>>>>//DDB-Selection-pkg-Start
49714>>>>>>>
49714>>>>>>>Use sl006.SL         // sl006
INCLUDING FILE: SL006.SL
49714>>>>>>>>>//AB/ Project sl006:Cmoves lookup
49714>>>>>>>>>//AB/ Object prj is a Lookup_Project
49714>>>>>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
49714>>>>>>>>>//AB/     Set ProjectFileName to "sl006.SL"
49714>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49714>>>>>>>>>
49714>>>>>>>>>// Project Object Structure
49714>>>>>>>>>//   sl006 is a dbModalPanelSub
49714>>>>>>>>>//     Ctypkin_DD is a DataDictionary
49714>>>>>>>>>//     Clients_DD is a DataDictionary
49714>>>>>>>>>//     Cmoves_DD is a DataDictionary
49714>>>>>>>>>//     oSelList is a dbListSub
49714>>>>>>>>>//     oOK_bn is a ButtonSub
49714>>>>>>>>>//     oCancel_bn is a ButtonSub
49714>>>>>>>>>//     oSearch_bn is a ButtonSub
49714>>>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
49714>>>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
49714>>>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
49714>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
49714>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
49714>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
49714>>>>>>>>>//     RadioGroupSub2 is a RadioGroupSub
49714>>>>>>>>>//       Radio4 is a RadioSub
49714>>>>>>>>>//       Radio5 is a RadioSub
49714>>>>>>>>>//       Radio6 is a RadioSub
49714>>>>>>>>>
49714>>>>>>>>>// Register all objects
49714>>>>>>>>>Register_Object Clients_DD
49714>>>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
49714>>>>>>>>>Register_Object Cmoves_Axia_Sysxet
49714>>>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
49714>>>>>>>>>Register_Object Cmoves_DD
49714>>>>>>>>>Register_Object Ctypkin_DD
49714>>>>>>>>>Register_Object oCancel_bn
49714>>>>>>>>>Register_Object oOK_bn
49714>>>>>>>>>Register_Object oSearch_bn
49714>>>>>>>>>Register_Object oSelList
49714>>>>>>>>>Register_Object Radio4
49714>>>>>>>>>Register_Object Radio5
49714>>>>>>>>>Register_Object Radio6
49714>>>>>>>>>Register_Object RadioGroupSub2
49714>>>>>>>>>Register_Object sl006
49714>>>>>>>>>Register_Object TextBoxSub1
49714>>>>>>>>>Register_Object TextBoxSub2
49714>>>>>>>>>Register_Object TextBoxSub3
49714>>>>>>>>>
49714>>>>>>>>>
49714>>>>>>>>>//AB-IgnoreStart
49714>>>>>>>>>
49714>>>>>>>>>Use DFAllEnt.pkg
49714>>>>>>>>>Use dbList.Sub
49714>>>>>>>>>Use Button.Sub
49714>>>>>>>>>Use dbForm.Sub
49714>>>>>>>>>Use Txtbox.Sub
49714>>>>>>>>>Use Rgroup.Sub
49714>>>>>>>>>Use Radio.Sub
49714>>>>>>>>>
49714>>>>>>>>>
49714>>>>>>>>>Use CTYPKIN.DD
49714>>>>>>>>>Use CLIENTS.DD
49714>>>>>>>>>Use CMOVES.DD
49714>>>>>>>>>
49714>>>>>>>>>//AB-IgnoreEnd
49714>>>>>>>>>
49714>>>>>>>>>Object sl006 is a dbModalPanelSub
49716>>>>>>>>>
49716>>>>>>>>>    //AB-StoreTopStart
49716>>>>>>>>>                                        
49716>>>>>>>>>    Property String     psModule    Public ''
49718>>>>>>>>>    Property String     psClientID  Public ''
49720>>>>>>>>>    Property Date       pdApo       public ''
49722>>>>>>>>>    Property Date       pdEos       public ''
49724>>>>>>>>>    Property Integer    piXr_Or_Pi  public  0
49726>>>>>>>>>    Property Integer    piWhat      public  0
49728>>>>>>>>>    
49728>>>>>>>>>    //AB-StoreTopEnd
49728>>>>>>>>>
49728>>>>>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
49729>>>>>>>>>    Set Size to 270 519
49730>>>>>>>>>    Set Location to 5 7
49731>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49732>>>>>>>>>    Set Modal_State to FALSE
49733>>>>>>>>>
49733>>>>>>>>>    //AB-DDOStart
49733>>>>>>>>>
49733>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
49735>>>>>>>>>    End_Object    // Ctypkin_DD
49736>>>>>>>>>
49736>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
49738>>>>>>>>>    End_Object    // Clients_DD
49739>>>>>>>>>
49739>>>>>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
49741>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
49742>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
49743>>>>>>>>>
49743>>>>>>>>>        //AB-StoreStart
49743>>>>>>>>>        
49743>>>>>>>>>        Begin_Constraints
49745>>>>>>>>>        
49745>>>>>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
49747>>>>>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
49749>>>>>>>>>        
49749>>>>>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
49753>>>>>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
49757>>>>>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
49761>>>>>>>>>        
49761>>>>>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
49763>>>>>>>>>        
49763>>>>>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
49767>>>>>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
49772>>>>>>>>>        
49772>>>>>>>>>        End_Constraints
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        
49775>>>>>>>>>        //AB-StoreEnd
49775>>>>>>>>>
49775>>>>>>>>>    End_Object    // Cmoves_DD
49776>>>>>>>>>
49776>>>>>>>>>    Set Main_DD to (Cmoves_DD(self))
49777>>>>>>>>>    Set Server to (Cmoves_DD(self))
49778>>>>>>>>>
49778>>>>>>>>>    //AB-DDOEnd
49778>>>>>>>>>
49778>>>>>>>>>    Object oSelList is a dbListSub
49780>>>>>>>>>
49780>>>>>>>>>        //AB-StoreTopStart
49780>>>>>>>>>                                                                                                                                                                                                                                                                                                                            
49780>>>>>>>>>        //AB-StoreTopEnd
49780>>>>>>>>>
49780>>>>>>>>>        Set Main_File to Cmoves.File_Number
49781>>>>>>>>>        Set Ordering to 4
49782>>>>>>>>>        Set Size to 199 505
49783>>>>>>>>>        Set Location to 31 7
49784>>>>>>>>>        Set Auto_Index_State to FALSE
49785>>>>>>>>>
49785>>>>>>>>>        Begin_Row
49788>>>>>>>>>            Entry_Item Cmoves.Cmoves_hmnia
49789>>>>>>>>>            Entry_Item Cmoves.Cmoves_par
49790>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
49791>>>>>>>>>            Entry_Item Clients.Client_name
49792>>>>>>>>>            Entry_Item Cmoves.Cmoves_axia
49793>>>>>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
49794>>>>>>>>>            Entry_Item Cmoves.Branch_code
49795>>>>>>>>>        End_Row
49800>>>>>>>>>
49800>>>>>>>>>        Set Form_Width    item 0 to 57
49801>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
49802>>>>>>>>>        
49802>>>>>>>>>        Set Form_Width    item 1 to 121
49803>>>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
49804>>>>>>>>>        
49804>>>>>>>>>        Set Form_Width    item 2 to 65
49805>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
49806>>>>>>>>>        
49806>>>>>>>>>        Set Form_Width    item 3 to 107
49807>>>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
49808>>>>>>>>>        
49808>>>>>>>>>        Set Form_Width    item 4 to 63
49809>>>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
49810>>>>>>>>>        
49810>>>>>>>>>        Set Form_Width    item 5 to 42
49811>>>>>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
49812>>>>>>>>>        
49812>>>>>>>>>        Set Form_Width    item 6 to 45
49813>>>>>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
49814>>>>>>>>>        
49814>>>>>>>>>
49814>>>>>>>>>        //AB-StoreStart
49814>>>>>>>>>                                                                                                                                                                                                                                                                                                                            
49814>>>>>>>>>        Procedure End_Construct_Object
49816>>>>>>>>>            String  sNom
49817>>>>>>>>>            Integer iDecs
49817>>>>>>>>>            Forward Send End_Construct_Object
49819>>>>>>>>>            Move SysCurxr.C_Code0 to sNom
49820>>>>>>>>>            Clear Nomisma
49821>>>>>>>>>            Move sNom to Nomisma.Nomisma_Code
49822>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
49823>>>>>>>>>>
49823>>>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
49826>>>>>>>>>            Else            Move 0 to iDecs
49828>>>>>>>>>        
49828>>>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
49828>>>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
49828>>>>>>>>>            If (iDecs=0) Move 2 to iDecs
49831>>>>>>>>>            //
49831>>>>>>>>>        
49831>>>>>>>>>            Set Points          Item 4 to       iDecs
49832>>>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
49833>>>>>>>>>        End_Procedure
49834>>>>>>>>>        
49834>>>>>>>>>        
49834>>>>>>>>>        
49834>>>>>>>>>        
49834>>>>>>>>>        
49834>>>>>>>>>        //AB-StoreEnd
49834>>>>>>>>>
49834>>>>>>>>>    End_Object    // oSelList
49835>>>>>>>>>
49835>>>>>>>>>    Object oOK_bn is a ButtonSub
49837>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49838>>>>>>>>>        Set Location to 236 350
49839>>>>>>>>>
49839>>>>>>>>>        //AB-StoreStart
49839>>>>>>>>>        Procedure OnClick
49841>>>>>>>>>            Send OK To (oSelList(current_object))
49842>>>>>>>>>        End_Procedure
49843>>>>>>>>>        //AB-StoreEnd
49843>>>>>>>>>
49843>>>>>>>>>    End_Object    // oOK_bn
49844>>>>>>>>>
49844>>>>>>>>>    Object oCancel_bn is a ButtonSub
49846>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49847>>>>>>>>>        Set Location to 236 404
49848>>>>>>>>>
49848>>>>>>>>>        //AB-StoreStart
49848>>>>>>>>>        Procedure OnClick
49850>>>>>>>>>            Send Cancel To (oSelList(current_object))
49851>>>>>>>>>        End_Procedure
49852>>>>>>>>>        //AB-StoreEnd
49852>>>>>>>>>
49852>>>>>>>>>    End_Object    // oCancel_bn
49853>>>>>>>>>
49853>>>>>>>>>    Object oSearch_bn is a ButtonSub
49855>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49856>>>>>>>>>        Set Location to 236 460
49857>>>>>>>>>
49857>>>>>>>>>        //AB-StoreStart
49857>>>>>>>>>        Procedure OnClick
49859>>>>>>>>>            Send Search To (oSelList(current_object))
49860>>>>>>>>>        End_Procedure
49861>>>>>>>>>        //AB-StoreEnd
49861>>>>>>>>>
49861>>>>>>>>>    End_Object    // oSearch_bn
49862>>>>>>>>>
49862>>>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
49864>>>>>>>>>        Entry_Item Cmoves.Axia_pros_sysx
49865>>>>>>>>>        Set Size to 13 54
49866>>>>>>>>>        Set Location to 236 24
49867>>>>>>>>>        Set Color to clBtnFace
49868>>>>>>>>>        Set Label_Col_Offset to 2
49869>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
49870>>>>>>>>>        Set Enabled_State to FALSE
49871>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
49872>>>>>>>>>        Set Shadow_State Item 0 to TRUE
49873>>>>>>>>>
49873>>>>>>>>>        //AB-StoreStart
49873>>>>>>>>>        Set points item 0 to 2
49874>>>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
49875>>>>>>>>>        
49875>>>>>>>>>        //AB-StoreEnd
49875>>>>>>>>>
49875>>>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
49876>>>>>>>>>
49876>>>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
49878>>>>>>>>>        Entry_Item Cmoves.Axia_sysxet
49879>>>>>>>>>        Set Size to 13 54
49880>>>>>>>>>        Set Location to 236 140
49881>>>>>>>>>        Set Color to clBtnFace
49882>>>>>>>>>        Set Label_Col_Offset to 2
49883>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
49884>>>>>>>>>        Set Enabled_State to FALSE
49885>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
49886>>>>>>>>>        Set Shadow_State Item 0 to TRUE
49887>>>>>>>>>
49887>>>>>>>>>        //AB-StoreStart
49887>>>>>>>>>        Set points item 0 to 2
49888>>>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
49889>>>>>>>>>        
49889>>>>>>>>>        //AB-StoreEnd
49889>>>>>>>>>
49889>>>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
49890>>>>>>>>>
49890>>>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
49892>>>>>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
49893>>>>>>>>>        Set Size to 13 54
49894>>>>>>>>>        Set Location to 236 248
49895>>>>>>>>>        Set Color to clBtnFace
49896>>>>>>>>>        Set Label_Col_Offset to 2
49897>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
49898>>>>>>>>>        Set Enabled_State to FALSE
49899>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
49900>>>>>>>>>        Set Shadow_State Item 0 to TRUE
49901>>>>>>>>>
49901>>>>>>>>>        //AB-StoreStart
49901>>>>>>>>>                                                                                                    
49901>>>>>>>>>        Set points item 0 to 2
49902>>>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
49903>>>>>>>>>        
49903>>>>>>>>>        //AB-StoreEnd
49903>>>>>>>>>
49903>>>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
49904>>>>>>>>>
49904>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
49906>>>>>>>>>        Set Label to "€¥å˜"
49907>>>>>>>>>        Set Location to 238 7
49908>>>>>>>>>        Set Size to 10 15
49909>>>>>>>>>    End_Object    // TextBoxSub1
49910>>>>>>>>>
49910>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
49912>>>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
49913>>>>>>>>>        Set Location to 238 89
49914>>>>>>>>>        Set Size to 10 49
49915>>>>>>>>>    End_Object    // TextBoxSub2
49916>>>>>>>>>
49916>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
49918>>>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
49919>>>>>>>>>        Set Location to 238 210
49920>>>>>>>>>        Set Size to 10 35
49921>>>>>>>>>    End_Object    // TextBoxSub3
49922>>>>>>>>>
49922>>>>>>>>>    Object RadioGroupSub2 is a RadioGroupSub
49924>>>>>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
49925>>>>>>>>>        Set Size to 24 497
49926>>>>>>>>>        Set Location to 3 9
49927>>>>>>>>>        Object Radio4 is a RadioSub
49929>>>>>>>>>            Set Label to "Ž¢œª"
49930>>>>>>>>>            Set Size to 10 37
49931>>>>>>>>>            Set Location to 10 97
49932>>>>>>>>>        End_Object    // Radio4
49933>>>>>>>>>
49933>>>>>>>>>        Object Radio5 is a RadioSub
49935>>>>>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
49936>>>>>>>>>            Set Size to 10 97
49937>>>>>>>>>            Set Location to 10 167
49938>>>>>>>>>        End_Object    // Radio5
49939>>>>>>>>>
49939>>>>>>>>>        Object Radio6 is a RadioSub
49941>>>>>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
49942>>>>>>>>>            Set Size to 10 111
49943>>>>>>>>>            Set Location to 10 278
49944>>>>>>>>>        End_Object    // Radio6
49945>>>>>>>>>
49945>>>>>>>>>
49945>>>>>>>>>        //AB-StoreStart
49945>>>>>>>>>                                                                                        
49945>>>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
49947>>>>>>>>>            Set piWhat to iToItem
49948>>>>>>>>>            Send Rebuild_Constraints to Cmoves_DD
49949>>>>>>>>>            Send Beginning_Of_Data To oSelList True
49950>>>>>>>>>        End_Procedure
49951>>>>>>>>>        
49951>>>>>>>>>        Set Current_Radio to 1
49952>>>>>>>>>        
49952>>>>>>>>>        
49952>>>>>>>>>        
49952>>>>>>>>>        
49952>>>>>>>>>        //AB-StoreEnd
49952>>>>>>>>>
49952>>>>>>>>>    End_Object    // RadioGroupSub2
49953>>>>>>>>>
49953>>>>>>>>>
49953>>>>>>>>>    //AB-StoreStart
49953>>>>>>>>>                                        
49953>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49954>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49955>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49956>>>>>>>>>    
49956>>>>>>>>>    Set Modal_State to True
49957>>>>>>>>>    
49957>>>>>>>>>    Procedure Activate
49959>>>>>>>>>        String  sNom
49960>>>>>>>>>        Integer iDecs rVal
49960>>>>>>>>>        Set piWhat to 1
49961>>>>>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
49962>>>>>>>>>        Forward Send Activate
49964>>>>>>>>>        Send Rebuild_Constraints        to Cmoves_DD
49965>>>>>>>>>        Send Beginning_Of_Data          to oSelList True
49966>>>>>>>>>    End_procedure
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    
49967>>>>>>>>>    //AB-StoreEnd
49967>>>>>>>>>
49967>>>>>>>>>End_Object    // sl006
49968>>>>>>>>>
49968>>>>>>>>>//AB/ End_Object    // prj
49968>>>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
49968>>>>>>>>>//AB/ Project slNomism
49968>>>>>>>>>//AB/ Object prj is a Lookup_Project
49968>>>>>>>>>//AB/     Set ProjectName to "slNomism"
49968>>>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
49968>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49968>>>>>>>>>
49968>>>>>>>>>// Project Object Structure
49968>>>>>>>>>//   slNomism is a dbModalPanelSub
49968>>>>>>>>>//     Nomisma_DD is a DataDictionary
49968>>>>>>>>>//     oSelList is a dbListSub
49968>>>>>>>>>//     oOK_bn is a ButtonSub
49968>>>>>>>>>//     oSearch_bn is a ButtonSub
49968>>>>>>>>>
49968>>>>>>>>>// Register all objects
49968>>>>>>>>>Register_Object Nomisma_DD
49968>>>>>>>>>Register_Object oOK_bn
49968>>>>>>>>>Register_Object oSearch_bn
49968>>>>>>>>>Register_Object oSelList
49968>>>>>>>>>Register_Object slNomism
49968>>>>>>>>>
49968>>>>>>>>>
49968>>>>>>>>>//AB-IgnoreStart
49968>>>>>>>>>
49968>>>>>>>>>Use DFAllEnt.pkg
49968>>>>>>>>>Use dbList.Sub
49968>>>>>>>>>Use Button.Sub
49968>>>>>>>>>
49968>>>>>>>>>
49968>>>>>>>>>Use NOMISMA.DD
49968>>>>>>>>>
49968>>>>>>>>>//AB-IgnoreEnd
49968>>>>>>>>>
49968>>>>>>>>>Object slNomism is a dbModalPanelSub
49970>>>>>>>>>
49970>>>>>>>>>    //AB-StoreTopStart
49970>>>>>>>>>    
49970>>>>>>>>>    
49970>>>>>>>>>    
49970>>>>>>>>>    //AB-StoreTopEnd
49970>>>>>>>>>
49970>>>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
49971>>>>>>>>>    Set Size to 175 397
49972>>>>>>>>>    Set Location to 5 7
49973>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49974>>>>>>>>>    Set Modal_State to FALSE
49975>>>>>>>>>
49975>>>>>>>>>    //AB-DDOStart
49975>>>>>>>>>
49975>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
49977>>>>>>>>>    End_Object    // Nomisma_DD
49978>>>>>>>>>
49978>>>>>>>>>    Set Main_DD to (Nomisma_DD(self))
49979>>>>>>>>>    Set Server to (Nomisma_DD(self))
49980>>>>>>>>>
49980>>>>>>>>>    //AB-DDOEnd
49980>>>>>>>>>
49980>>>>>>>>>    Object oSelList is a dbListSub
49982>>>>>>>>>        Set Main_File to Nomisma.File_Number
49983>>>>>>>>>        Set Size to 130 382
49984>>>>>>>>>        Set Location to 6 6
49985>>>>>>>>>
49985>>>>>>>>>        Begin_Row
49988>>>>>>>>>            Entry_Item Nomisma.Nomisma_code
49989>>>>>>>>>            Entry_Item Nomisma.Nomisma_descr
49990>>>>>>>>>            Entry_Item Nomisma.Dekadika
49991>>>>>>>>>            Entry_Item Nomisma.Euro_zone
49992>>>>>>>>>            Entry_Item Nomisma.Einai_drx
49993>>>>>>>>>            Entry_Item Nomisma.Einai_euro
49994>>>>>>>>>        End_Row
49999>>>>>>>>>
49999>>>>>>>>>        Set Form_Width    item 0 to 49
50000>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
50001>>>>>>>>>        
50001>>>>>>>>>        Set Form_Width    item 1 to 115
50002>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50003>>>>>>>>>        
50003>>>>>>>>>        Set Form_Width    item 2 to 47
50004>>>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
50005>>>>>>>>>        
50005>>>>>>>>>        Set Form_Width    item 3 to 55
50006>>>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
50007>>>>>>>>>        Set Column_Checkbox_State  item 3 to True
50008>>>>>>>>>        
50008>>>>>>>>>        Set Form_Width    item 4 to 55
50009>>>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
50010>>>>>>>>>        Set Column_Checkbox_State  item 4 to True
50011>>>>>>>>>        
50011>>>>>>>>>        Set Form_Width    item 5 to 55
50012>>>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
50013>>>>>>>>>        Set Column_Checkbox_State  item 5 to True
50014>>>>>>>>>        
50014>>>>>>>>>
50014>>>>>>>>>        //AB-StoreStart
50014>>>>>>>>>        
50014>>>>>>>>>        //AB-StoreEnd
50014>>>>>>>>>
50014>>>>>>>>>    End_Object    // oSelList
50015>>>>>>>>>
50015>>>>>>>>>    Object oOK_bn is a ButtonSub
50017>>>>>>>>>        Set Label to "&„§ ¢¦šã"
50018>>>>>>>>>        Set Location to 140 279
50019>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50020>>>>>>>>>
50020>>>>>>>>>        //AB-StoreStart
50020>>>>>>>>>        Procedure OnClick
50022>>>>>>>>>            Send OK To (oSelList(current_object))
50023>>>>>>>>>        End_Procedure
50024>>>>>>>>>        //AB-StoreEnd
50024>>>>>>>>>
50024>>>>>>>>>    End_Object    // oOK_bn
50025>>>>>>>>>
50025>>>>>>>>>    Object oSearch_bn is a ButtonSub
50027>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
50028>>>>>>>>>        Set Location to 140 339
50029>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50030>>>>>>>>>
50030>>>>>>>>>        //AB-StoreStart
50030>>>>>>>>>        
50030>>>>>>>>>        Procedure OnClick
50032>>>>>>>>>            Send Search To (oSelList(current_object))
50033>>>>>>>>>        End_Procedure
50034>>>>>>>>>        
50034>>>>>>>>>        
50034>>>>>>>>>        Set Visible_State to False
50035>>>>>>>>>        Set Enabled_State to False
50036>>>>>>>>>        //AB-StoreEnd
50036>>>>>>>>>
50036>>>>>>>>>    End_Object    // oSearch_bn
50037>>>>>>>>>
50037>>>>>>>>>
50037>>>>>>>>>    //AB-StoreStart
50037>>>>>>>>>    
50037>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50038>>>>>>>>>    
50038>>>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
50039>>>>>>>>>    
50039>>>>>>>>>    
50039>>>>>>>>>    
50039>>>>>>>>>    
50039>>>>>>>>>    //AB-StoreEnd
50039>>>>>>>>>
50039>>>>>>>>>End_Object    // slNomism
50040>>>>>>>>>
50040>>>>>>>>>//AB/ End_Object    // prj
50040>>>>>>>Use sl041.SL         // sl041
50040>>>>>>>
50040>>>>>>>//DDB-Selection-pkg-End
50040>>>>>>>//DDB-FileEnd
50040>>>>>    Use CFLAGKIN.DD
INCLUDING FILE: CFLAGKIN.DD
50040>>>>>>>//DDB-FileStart
50040>>>>>>>//DDB-HeaderStart
50040>>>>>>>
50040>>>>>>>// File Name : CFLAGKIN.DD
50040>>>>>>>// Class Name: Cflagkin_DataDictionary
50040>>>>>>>// Revision  : 28
50040>>>>>>>// Version   : 2
50040>>>>>>>
50040>>>>>>>Use  Windows           // Basic Definitions
50040>>>>>>>Use  DataDict          // DataDictionary Class Definition
50040>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50040>>>>>>>
50040>>>>>>>Open Cflagkin
50042>>>>>>>Open Ctypkin
50044>>>>>>>Open Sysrecc
50046>>>>>>>Open Syscurxr
50048>>>>>>>
50048>>>>>>>//DDB-HeaderEnd
50048>>>>>>>//DDB-ValidationStart
50048>>>>>>>
50048>>>>>>>Register_Object Cflagkin_Flag
50048>>>>>>>
50048>>>>>>>Object Cflagkin_Flag  is a CodeValidationTable
50050>>>>>>>    Set Type_Value        To "CFLAGS"
50051>>>>>>>    //DDB-ValidationCustomStart
50051>>>>>>>    //DDB-ValidationCustomEnd
50051>>>>>>>End_Object   // Cflagkin_Flag
50052>>>>>>>//DDB-ValidationEnd
50052>>>>>>>
50052>>>>>>>Class Cflagkin_DataDictionary  is a DataDictionary
50053>>>>>>>
50053>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
50054>>>>>>>        String lsError_Message
50055>>>>>>>        Case Begin
50055>>>>>>>            Case (iError_Num = 7001)
50057>>>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags ˜¤à «à¤ 2 ¯ž­åà¤" to lsError_Message
50058>>>>>>>            Case Break
50059>>>>>>>            Case (iError_Num = 7002)
50062>>>>>>>                Move "DDC 008:ƒœ¤ œ§ «¨â§¦¤«˜  Flags £ž›œ¤ ¡á" to lsError_Message
50063>>>>>>>            Case Break
50064>>>>>>>            Case Else
50064>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
50066>>>>>>>        Case End
50066>>>>>>>        Error iError_Num lsError_Message
50067>>>>>>>>
50067>>>>>>>    End_Procedure // operation_not_allowed
50068>>>>>>>
50068>>>>>>>    Function Validate_Save  Returns Integer
50069>>>>>>>        Integer iReturnVal
50070>>>>>>>        Forward Get Validate_Save  To iReturnVal
50072>>>>>>>        If (Not(iReturnVal)) Begin
50074>>>>>>>                 If (Length(Trim(Cflagkin.Cflagkin_Flag))>2)    Move 7001 to iReturnVal
50077>>>>>>>            Else If (Cflagkin.Flag_Numeric=0)                   Move 7002 to iReturnVal
50081>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
50084>>>>>>>        End
50084>>>>>>>>
50084>>>>>>>        Function_Return iReturnVal
50085>>>>>>>    End_Function   // Validate_Save
50086>>>>>>>
50086>>>>>>>    Procedure Update
50087>>>>>>>        Forward Send Update
50089>>>>>>>        // Insert Code Here
50089>>>>>>>//        Move SysCurXR.Company_Code  to Cflagkin.Company_Code
50089>>>>>>>//        Move SysCurXR.Branch_Code   to Cflagkin.Branch_Code
50089>>>>>>>//        Move SysCurXR.Year_Year     to Cflagkin.Year_Year
50089>>>>>>>        Move Ctypkin.Ctypkin_Code   to Cflagkin.Ctypkin_Code
50090>>>>>>>        Move Cflagkin.Cflagkin_Flag to Cflagkin.Flag_Numeric
50091>>>>>>>    End_Procedure   // Update
50092>>>>>>>
50092>>>>>>>    Procedure Creating
50093>>>>>>>        Forward Send Creating
50095>>>>>>>        // Insert Code Here
50095>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cflagkin.Cflagkin_Rec0)))))) to Cflagkin.Cflagkin_Recr
50096>>>>>>>    End_Procedure   // Creating
50097>>>>>>>
50097>>>>>>>    // Define_Fields:
50097>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50097>>>>>>>
50097>>>>>>>    Procedure Define_Fields
50098>>>>>>>        Forward Send Define_Fields
50100>>>>>>>        //DDB-Generated-Code-Location
50100>>>>>>>        //DDB-DefineFieldStart
50100>>>>>>>
50100>>>>>>>        Set Main_File            To Cflagkin.File_Number
50101>>>>>>>        Set Cascade_Delete_State To FALSE
50102>>>>>>>
50102>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
50103>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
50104>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50105>>>>>>>
50105>>>>>>>        // Parent (Server) file structure...............
50105>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
50106>>>>>>>
50106>>>>>>>        // External (System) file structure.............
50106>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
50107>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
50108>>>>>>>
50108>>>>>>>        Define_Auto_Increment  Sysrecc.Cflagkin_Rec0  To Cflagkin.Cflagkin_Rec0
50111>>>>>>>
50111>>>>>>>        // Field-based properties.......................
50111>>>>>>>
50111>>>>>>>        // Cflagkin.Company_Code
50111>>>>>>>
50111>>>>>>>        // Cflagkin.Branch_Code
50111>>>>>>>
50111>>>>>>>        // Cflagkin.Year_Year
50111>>>>>>>
50111>>>>>>>        // Cflagkin.Ctypkin_Code
50111>>>>>>>
50111>>>>>>>        // Cflagkin.Cflagkin_Flag
50111>>>>>>>        Set Field_Value_Table      Field Cflagkin.Cflagkin_Flag To (Cflagkin_Flag(Self))
50112>>>>>>>
50112>>>>>>>        // Cflagkin.Ctypkin_Recr
50112>>>>>>>
50112>>>>>>>        // Cflagkin.Cflagkin_Descr
50112>>>>>>>
50112>>>>>>>        // Cflagkin.Cflagkin_Rec0
50112>>>>>>>        Set Field_Options          Field Cflagkin.Cflagkin_Rec0 To DD_AUTOFIND   
50113>>>>>>>
50113>>>>>>>        // Cflagkin.Cflagkin_Recr
50113>>>>>>>
50113>>>>>>>        // Cflagkin.Flag_Numeric
50113>>>>>>>
50113>>>>>>>        //DDB-DefineFieldEnd
50113>>>>>>>    End_Procedure    // Define_Fields
50114>>>>>>>
50114>>>>>>>    // Field_Defaults:
50114>>>>>>>    // This procedure is used to establish default field values.
50114>>>>>>>
50114>>>>>>>    Procedure Field_Defaults
50115>>>>>>>        Forward Send Field_Defaults
50117>>>>>>>        //DDB-Generated-Code-Location
50117>>>>>>>        //DDB-FieldDefaultStart
50117>>>>>>>        //DDB-FieldDefaultEnd
50117>>>>>>>    End_Procedure    // Field_Defaults
50118>>>>>>>
50118>>>>>>>End_Class    // Cflagkin_DataDictionary
50119>>>>>>>//DDB-FileEnd
50119>>>>>    Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
50119>>>>>>>//DDB-FileStart
50119>>>>>>>//DDB-HeaderStart
50119>>>>>>>
50119>>>>>>>// File Name : BTYPKIN.DD
50119>>>>>>>// Class Name: Btypkin_DataDictionary
50119>>>>>>>// Revision  : 114
50119>>>>>>>// Version   : 2
50119>>>>>>>
50119>>>>>>>Use  Windows           // Basic Definitions
50119>>>>>>>Use  DataDict          // DataDictionary Class Definition
50119>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50119>>>>>>>
50119>>>>>>>Open Btypkin
50121>>>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
50123>>>>>>>Open Bkinkat
50125>>>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
50127>>>>>>>Open Sysrecb
50129>>>>>>>
50129>>>>>>>//DDB-HeaderEnd
50129>>>>>>>//DDB-ValidationStart
50129>>>>>>>
50129>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
50129>>>>>>>
50129>>>>>>>Register_Object Bfile_VT
50129>>>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
50129>>>>>>>Use Baxio.pkg        // Bfile_VT
50129>>>>>>>
50129>>>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
50131>>>>>>>
50131>>>>>>>    Procedure Fill_List
50133>>>>>>>        Forward Send Fill_List
50135>>>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
50136>>>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
50137>>>>>>>    End_Procedure    // Fill_List
50138>>>>>>>    //DDB-ValidationCustomStart
50138>>>>>>>    //DDB-ValidationCustomEnd
50138>>>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
50139>>>>>>>//DDB-ValidationEnd
50139>>>>>>>//DDB-SelectionStart
50139>>>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
50139>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
50139>>>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
50139>>>>>>>Register_Object SL031
50139>>>>>>>Register_Object sl007
50139>>>>>>>Register_Object sl007r
50139>>>>>>>//DDB-SelectionEnd
50139>>>>>>>
50139>>>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
50139>>>>>>>//Register_Object SL056 //¢å©«˜ vendor
50139>>>>>>>
50139>>>>>>>
50139>>>>>>>Open SysCurXr
50141>>>>>>>
50141>>>>>>>Open Barticl //©œ«á¨œ  prompt objects
50143>>>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
50143>>>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
50143>>>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
50143>>>>>>>
50143>>>>>>>
50143>>>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
50143>>>>>>>//Use SL102.SL //¢å©«˜ customer
50143>>>>>>>//Use SL???.SL //¢å©«˜ vendor
50143>>>>>>>Use sl100.sl // Clients selection list
50143>>>>>>>
50143>>>>>>>//*********************************************************************************
50143>>>>>>>//*          A N A L Y S I S                                                      *
50143>>>>>>>//*********************************************************************************
50143>>>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
50143>>>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
50143>>>>>>>
50143>>>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
50143>>>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
50143>>>>>>>//                                                               Btypkin.Gplan_Code_Apo
50143>>>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
50143>>>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
50143>>>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
50143>>>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
50143>>>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
50143>>>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
50143>>>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
50143>>>>>>>
50143>>>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
50143>>>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
50143>>>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
50143>>>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
50143>>>>>>>
50143>>>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
50144>>>>>>>
50144>>>>>>>    Procedure Construct_Object
50145>>>>>>>              Forward Send Construct_Object
50147>>>>>>>
50147>>>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
50147>>>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
50147>>>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
50147>>>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
50147>>>>>>>              Property Integer piBarticl_dd  0
50148>>>>>>>              Property Integer piBmove_dd    0
50149>>>>>>>              Property Integer piBaxio_dd    0
50150>>>>>>>              Property Integer piBaxiokat_dd 0
50151>>>>>>>              Property Integer piMustNOTConstrain Public 0
50152>>>>>>>    End_Procedure   //construct_object
50153>>>>>>>
50153>>>>>>>//      //private
50153>>>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
50153>>>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
50153>>>>>>>//                                                                 Integer liField            ;
50153>>>>>>>//                                                                 Integer iMustConstrain     ;
50153>>>>>>>//                                                                 String  sPelProm
50153>>>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
50153>>>>>>>
50153>>>>>>>//                Move (sl100(Self)) to iPelListID
50153>>>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
50153>>>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
50153>>>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
50153>>>>>>>
50153>>>>>>>//                Get piBarticl_dd to liBarticl_dd
50153>>>>>>>//                If (liBarticl_dd <> 0);
50153>>>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
50153>>>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
50153>>>>>>>//                     Decrement iMax
50153>>>>>>>//                     For iCount from 0 to iMax
50153>>>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
50153>>>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
50153>>>>>>>//                         If (liTemp = liField);
50153>>>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
50153>>>>>>>//                            If (liPrompt_Object_id <> 0);
50153>>>>>>>//                               Begin
50153>>>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
50153>>>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
50153>>>>>>>//                                  If (iMustConstrain) Begin
50153>>>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
50153>>>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
50153>>>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
50153>>>>>>>//                                  End
50153>>>>>>>//                            End
50153>>>>>>>//                            Else Begin
50153>>>>>>>//                                Set Prompt_Object      of iDEO to 0
50153>>>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
50153>>>>>>>//                            End
50153>>>>>>>//                         End
50153>>>>>>>//                     Loop
50153>>>>>>>//                End
50153>>>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
50153>>>>>>>
50153>>>>>>>
50153>>>>>>>//    //private
50153>>>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
50153>>>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
50153>>>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
50153>>>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
50153>>>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
50153>>>>>>>//              Integer liBaxiokat_dd liBarticl_dd
50153>>>>>>>//              String lsBarticlCode1
50153>>>>>>>
50153>>>>>>>//            // btypkin_anti
50153>>>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
50153>>>>>>>//            // "0"  "Data Entry"
50153>>>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
50153>>>>>>>//            // "2"  "”¦¨â˜ª"
50153>>>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
50153>>>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
50153>>>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
50153>>>>>>>
50153>>>>>>>
50153>>>>>>>
50153>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
50153>>>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
50153>>>>>>>//              Case Begin
50153>>>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
50153>>>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
50153>>>>>>>//                   Case Break
50153>>>>>>>
50153>>>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
50153>>>>>>>//                   Case Break
50153>>>>>>>
50153>>>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
50153>>>>>>>//                   Case Break
50153>>>>>>>
50153>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
50153>>>>>>>//                   Case Break
50153>>>>>>>//              Case End
50153>>>>>>>
50153>>>>>>>//              Case Begin
50153>>>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
50153>>>>>>>//                   Case Break
50153>>>>>>>
50153>>>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
50153>>>>>>>//                   Case Break
50153>>>>>>>
50153>>>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
50153>>>>>>>//                   Case Break
50153>>>>>>>
50153>>>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
50153>>>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
50153>>>>>>>//                   Case Break
50153>>>>>>>//              Case End
50153>>>>>>>//    End_Procedure //private.exit_btypkin_code
50153>>>>>>>
50153>>>>>>>//    // New_Current_Record:
50153>>>>>>>
50153>>>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
50153>>>>>>>//        Integer liBtypkinCodeFldNum
50153>>>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
50153>>>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
50153>>>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
50153>>>>>>>//        // Insert Code Here
50153>>>>>>>//    End_Procedure   // New_Current_Record
50153>>>>>>>
50153>>>>>>>
50153>>>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
50153>>>>>>>    //™) ˜¤áš¤à©ž properties
50153>>>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
50153>>>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
50153>>>>>>>    //œ) œ¤ž£â¨à©ž properties after
50153>>>>>>>    Procedure Update
50154>>>>>>>
50154>>>>>>>              Forward Send Update
50156>>>>>>>
50156>>>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
50156>>>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
50157>>>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
50158>>>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
50159>>>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
50160>>>>>>>
50160>>>>>>>              //™) ˜¤áš¤à©ž properties
50160>>>>>>>
50160>>>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
50160>>>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
50160>>>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
50160>>>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
50162>>>>>>>             // gts 02/12/04 oxi gia titana
50162>>>>>>>             //      Move "" to Btypkin.Gplan_Code_Apo1
50162>>>>>>>             //      Move "" to Btypkin.Gplan_Code_Eos1
50162>>>>>>>              End
50162>>>>>>>>
50162>>>>>>>
50162>>>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
50162>>>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
50162>>>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
50164>>>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
50165>>>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
50166>>>>>>>              End
50166>>>>>>>>
50166>>>>>>>
50166>>>>>>>              //š.3:gtypkin_rec0 (conditional)
50166>>>>>>>              Case Begin
50166>>>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
50168>>>>>>>//jsjsjs 24/01/2001
50168>>>>>>>//                         Clear Gtypkin
50168>>>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
50168>>>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
50168>>>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
50168>>>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
50168>>>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
50168>>>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
50168>>>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
50168>>>>>>>//jsjsjs 24/01/2001
50168>>>>>>>                   Case Break
50169>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
50169>>>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
50170>>>>>>>              Case End
50170>>>>>>>
50170>>>>>>>              //š.4:ctypkin_rec0 (conditional)
50170>>>>>>>              Case Begin
50170>>>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
50172>>>>>>>                         Clear Ctypkin
50173>>>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
50174>>>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
50175>>>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
50176>>>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
50177>>>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
50178>>>>>>>>
50178>>>>>>>                         If (Found = 1) Begin
50180>>>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
50181>>>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
50182>>>>>>>                         End
50182>>>>>>>>
50182>>>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
50184>>>>>>>                   Case Break
50185>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
50185>>>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
50186>>>>>>>                         Move '' to Btypkin.Ctypkin_Recr
50187>>>>>>>              Case End
50187>>>>>>>
50187>>>>>>>              //š.5:vtypkin_rec0 (conditional)
50187>>>>>>>              Case Begin
50187>>>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
50189>>>>>>>                         //Clear Vtypkin
50189>>>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
50189>>>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
50189>>>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
50189>>>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
50189>>>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
50189>>>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
50189>>>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
50189>>>>>>>                   Case Break
50190>>>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
50190>>>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
50191>>>>>>>              Case End
50191>>>>>>>
50191>>>>>>>              //š.6:btypkin_l_hmnia (conditional)
50191>>>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
50194>>>>>>>
50194>>>>>>>
50194>>>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
50194>>>>>>>
50194>>>>>>>              //œ) œ¤ž£â¨à©ž properties after
50194>>>>>>>    End_Procedure //update
50195>>>>>>>
50195>>>>>>>    Procedure Creating
50196>>>>>>>              Forward Send Creating
50198>>>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
50198>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
50199>>>>>>>    End_Procedure //creating
50200>>>>>>>
50200>>>>>>>//    Procedure OnConstrain
50200>>>>>>>//        Set piMustNOTConstrain to True
50200>>>>>>>        
50200>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
50200>>>>>>>//        End
50200>>>>>>>//        Else Begin
50200>>>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
50200>>>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
50200>>>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
50200>>>>>>>//        End
50200>>>>>>>//    End_Procedure
50200>>>>>>>
50200>>>>>>>
50200>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
50201>>>>>>>              String lsError_Message
50202>>>>>>>              Case Begin
50202>>>>>>>                   //˜§æ validate save
50202>>>>>>>                   Case (iError_Num = 1001)
50204>>>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
50204>>>>>>>                        //to lsError_Message
50204>>>>>>>                   Case Break
50205>>>>>>>                   Case (iError_Num = 1100)
50208>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
50209>>>>>>>                        Case Break
50210>>>>>>>
50210>>>>>>>                   //˜§æ validate delete
50210>>>>>>>                   Case (iError_Num = 2001)
50213>>>>>>>                        //Clear Codemast
50213>>>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
50213>>>>>>>                        //to lsError_Message
50213>>>>>>>                   Case Break
50214>>>>>>>                   Case (iError_Num = 2100)
50217>>>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
50218>>>>>>>                        Case Break
50219>>>>>>>
50219>>>>>>>                   //˜§æ update
50219>>>>>>>                   Case (iError_Num = 3001)
50222>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
50223>>>>>>>                   Case Break
50224>>>>>>>                   Case (iError_Num = 3002)
50227>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
50228>>>>>>>                   Case Break
50229>>>>>>>                   Case (iError_Num = 3003)
50232>>>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
50233>>>>>>>                   Case Break
50234>>>>>>>
50234>>>>>>>
50234>>>>>>>
50234>>>>>>>                   Case Else
50234>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
50236>>>>>>>              Case End
50236>>>>>>>
50236>>>>>>>              Error iError_Num lsError_Message
50237>>>>>>>>
50237>>>>>>>    End_Procedure // operation_not_allowed
50238>>>>>>>
50238>>>>>>>
50238>>>>>>>//    //1001:
50238>>>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
50238>>>>>>>//    Function Validate_Save Returns Integer
50238>>>>>>>//             Integer iReturnVal
50238>>>>>>>
50238>>>>>>>//             Forward Get Validate_Save to iReturnVal
50238>>>>>>>
50238>>>>>>>//             If (Not(iReturnVal));
50238>>>>>>>//             Begin
50238>>>>>>>//                  //1100:cby = globals
50238>>>>>>>//                  If ( ;
50238>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
50238>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
50238>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
50238>>>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
50238>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
50238>>>>>>>//             Function_Return iReturnVal
50238>>>>>>>//    End_Function   // validate_save
50238>>>>>>>
50238>>>>>>>
50238>>>>>>>//    //2001:
50238>>>>>>>//    Function Validate_Delete  Returns Integer
50238>>>>>>>//             Integer iReturnVal
50238>>>>>>>//             Forward Get Validate_Delete  To iReturnVal
50238>>>>>>>//             If (Not(iReturnVal));
50238>>>>>>>//             Begin
50238>>>>>>>
50238>>>>>>>//                  //2100:cby = globals
50238>>>>>>>//                  If ( ;
50238>>>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
50238>>>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
50238>>>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
50238>>>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
50238>>>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
50238>>>>>>>//             Function_Return iReturnVal
50238>>>>>>>//    End_Function   // Validate_Delete
50238>>>>>>>
50238>>>>>>>
50238>>>>>>>    Procedure Define_Fields
50239>>>>>>>        Forward Send Define_Fields
50241>>>>>>>        //DDB-Generated-Code-Location
50241>>>>>>>        //DDB-DefineFieldStart
50241>>>>>>>
50241>>>>>>>        Set Main_File            To Btypkin.File_Number
50242>>>>>>>        Set Cascade_Delete_State To FALSE
50243>>>>>>>
50243>>>>>>>
50243>>>>>>>        // Child (Client) file structure................
50243>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
50244>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
50245>>>>>>>        Send Add_Client_File  Barticl.File_Number
50246>>>>>>>
50246>>>>>>>        // External (System) file structure.............
50246>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
50247>>>>>>>
50247>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
50250>>>>>>>
50250>>>>>>>        // Field-based properties.......................
50250>>>>>>>
50250>>>>>>>        // Btypkin.Company_Code
50250>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
50250>>>>>>>
50250>>>>>>>        // Btypkin.Branch_Code
50250>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
50250>>>>>>>
50250>>>>>>>        // Btypkin.Year_Year
50250>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
50250>>>>>>>
50250>>>>>>>        // Btypkin.Btypkin_Code
50250>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
50251>>>>>>>
50251>>>>>>>        // Btypkin.Btypkin_Rec0
50251>>>>>>>
50251>>>>>>>        // Btypkin.Btypkin_Recr
50251>>>>>>>
50251>>>>>>>        // Btypkin.Year_Recr
50251>>>>>>>
50251>>>>>>>        // Btypkin.Btypkin_Descr
50251>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
50252>>>>>>>
50252>>>>>>>        // Btypkin.Gtypkin_Code
50252>>>>>>>
50252>>>>>>>        // Btypkin.Ctypkin_Code
50252>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
50253>>>>>>>
50253>>>>>>>        // Btypkin.Vtypkin_Code
50253>>>>>>>
50253>>>>>>>        // Btypkin.Gtypkin_Rec0
50253>>>>>>>
50253>>>>>>>        // Btypkin.Ctypkin_Rec0
50253>>>>>>>
50253>>>>>>>        // Btypkin.Vtypkin_Rec0
50253>>>>>>>
50253>>>>>>>        // Btypkin.Btypkin_Anti1
50253>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
50254>>>>>>>
50254>>>>>>>        // Btypkin.Gplan_Code_Apo1
50254>>>>>>>
50254>>>>>>>        // Btypkin.Gplan_Code_Eos1
50254>>>>>>>
50254>>>>>>>        // Btypkin.Btypkin_Anti2
50254>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
50255>>>>>>>
50255>>>>>>>        // Btypkin.Gplan_Code_Apo2
50255>>>>>>>
50255>>>>>>>        // Btypkin.Gplan_Code_Eos2
50255>>>>>>>
50255>>>>>>>        // Btypkin.Bflagkin_Num
50255>>>>>>>
50255>>>>>>>        // Btypkin.Bkinkat_Num
50255>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
50255>>>>>>>
50255>>>>>>>        // Btypkin.Btypkin_Anti_Xp
50255>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
50256>>>>>>>
50256>>>>>>>        // Btypkin.Btypkin_Printer
50256>>>>>>>
50256>>>>>>>        // Btypkin.Btypkin_Pdescr
50256>>>>>>>
50256>>>>>>>        // Btypkin.Btypkin_Form
50256>>>>>>>
50256>>>>>>>        // Btypkin.Btypkin_L_No
50256>>>>>>>
50256>>>>>>>        // Btypkin.Btypkin_L_Hmnia
50256>>>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Seira
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Abr
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Flag01
50257>>>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Flag02
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Flag03
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Flag04
50257>>>>>>>
50257>>>>>>>        // Btypkin.Btypkin_Flag05
50257>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag06
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag07
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag08
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag09
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag10
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag11
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag12
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag13
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag14
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag15
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag16
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag17
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag18
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag19
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Flag20
50258>>>>>>>
50258>>>>>>>        // Btypkin.Btypkin_Sign
50258>>>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
50259>>>>>>>
50259>>>>>>>        // Btypkin.Ctypkin_Recr
50259>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
50260>>>>>>>
50260>>>>>>>        // Btypkin.Label
50260>>>>>>>
50260>>>>>>>        // Btypkin.Locked
50260>>>>>>>
50260>>>>>>>        // Btypkin.Locked_Date
50260>>>>>>>        Set Field_Mask_Type        Field Btypkin.Locked_Date To MASK_DATE_WINDOW
50261>>>>>>>
50261>>>>>>>        //DDB-DefineFieldEnd
50261>>>>>>>
50261>>>>>>>        Set Main_File            To Btypkin.File_Number
50262>>>>>>>        Set Cascade_Delete_State To FALSE
50263>>>>>>>
50263>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
50264>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
50265>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50266>>>>>>>
50266>>>>>>>        // Child (Client) file structure................
50266>>>>>>>        Send Add_Client_File  Bflagkin.File_Number
50267>>>>>>>        Send Add_Client_File  Barticl.File_Number
50268>>>>>>>        Send Add_Client_File  Bkinkat.File_Number
50269>>>>>>>
50269>>>>>>>        // External (System) file structure.............
50269>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
50270>>>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
50270>>>>>>>
50270>>>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
50273>>>>>>>
50273>>>>>>>        // Field-based properties.......................
50273>>>>>>>
50273>>>>>>>        // Btypkin.Company_Code
50273>>>>>>>
50273>>>>>>>        // Btypkin.Branch_Code
50273>>>>>>>
50273>>>>>>>        // Btypkin.Year_Year
50273>>>>>>>
50273>>>>>>>        // Btypkin.Btypkin_Code
50273>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
50274>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
50275>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
50276>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
50277>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
50278>>>>>>>
50278>>>>>>>        // Btypkin.Btypkin_Rec0
50278>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
50279>>>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
50280>>>>>>>
50280>>>>>>>        // Btypkin.Year_Rec0
50280>>>>>>>
50280>>>>>>>        // Btypkin.Btypkin_Descr
50280>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
50281>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
50282>>>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
50283>>>>>>>
50283>>>>>>>        // Btypkin.Gtypkin_Code
50283>>>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
50284>>>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
50285>>>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
50285>>>>>>>
50285>>>>>>>        // Btypkin.Ctypkin_Code
50285>>>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
50286>>>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
50287>>>>>>>
50287>>>>>>>        // Btypkin.Vtypkin_Code
50287>>>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
50288>>>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
50289>>>>>>>
50289>>>>>>>        // Btypkin.Gtypkin_Rec0
50289>>>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
50290>>>>>>>
50290>>>>>>>        // Btypkin.Ctypkin_Rec0
50290>>>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
50291>>>>>>>
50291>>>>>>>        // Btypkin.Vtypkin_Rec0
50291>>>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
50292>>>>>>>
50292>>>>>>>        // Btypkin.Btypkin_Anti1
50292>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
50293>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
50294>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
50295>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
50296>>>>>>>
50296>>>>>>>        // Btypkin.Gplan_Code_Apo1
50296>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
50297>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
50298>>>>>>>
50298>>>>>>>        // Btypkin.Gplan_Code_Eos1
50298>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
50299>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
50300>>>>>>>
50300>>>>>>>        // Btypkin.Btypkin_Anti2
50300>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
50301>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
50302>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
50303>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
50304>>>>>>>
50304>>>>>>>        // Btypkin.Gplan_Code_Apo2
50304>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
50305>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
50306>>>>>>>
50306>>>>>>>        // Btypkin.Gplan_Code_Eos2
50306>>>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
50307>>>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
50308>>>>>>>
50308>>>>>>>        // Btypkin.Bflagkin_Num
50308>>>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
50309>>>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
50310>>>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
50311>>>>>>>
50311>>>>>>>        // Btypkin.Bkinkat_Num
50311>>>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
50312>>>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
50313>>>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
50314>>>>>>>
50314>>>>>>>        // Btypkin.Btypkin_Anti_Xp
50314>>>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
50315>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
50316>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
50317>>>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
50318>>>>>>>
50318>>>>>>>        // Btypkin.Btypkin_Printer
50318>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
50319>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
50320>>>>>>>
50320>>>>>>>        // Btypkin.Btypkin_Pdescr
50320>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
50321>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
50322>>>>>>>
50322>>>>>>>        // Btypkin.Btypkin_Form
50322>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
50323>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
50324>>>>>>>
50324>>>>>>>        // Btypkin.Btypkin_L_No
50324>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
50325>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
50326>>>>>>>        //Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
50326>>>>>>>
50326>>>>>>>        // Btypkin.Btypkin_L_Hmnia
50326>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
50327>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
50328>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
50329>>>>>>>
50329>>>>>>>        // Btypkin.Btypkin_Seira
50329>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
50330>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
50331>>>>>>>
50331>>>>>>>        // Btypkin.Btypkin_Abr
50331>>>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
50332>>>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
50333>>>>>>>
50333>>>>>>>        // Btypkin.Btypkin_Flag01
50333>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
50334>>>>>>>
50334>>>>>>>        // Btypkin.Btypkin_Flag02
50334>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
50335>>>>>>>
50335>>>>>>>        // Btypkin.Btypkin_Flag03
50335>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
50336>>>>>>>
50336>>>>>>>        // Btypkin.Btypkin_Flag04
50336>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
50337>>>>>>>
50337>>>>>>>        // Btypkin.Btypkin_Flag05
50337>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
50338>>>>>>>
50338>>>>>>>        // Btypkin.Btypkin_Flag06
50338>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
50339>>>>>>>
50339>>>>>>>        // Btypkin.Btypkin_Flag07
50339>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
50340>>>>>>>
50340>>>>>>>        // Btypkin.Btypkin_Flag08
50340>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
50341>>>>>>>
50341>>>>>>>        // Btypkin.Btypkin_Flag09
50341>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
50342>>>>>>>
50342>>>>>>>        // Btypkin.Btypkin_Flag10
50342>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
50343>>>>>>>
50343>>>>>>>        // Btypkin.Btypkin_Flag11
50343>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
50344>>>>>>>
50344>>>>>>>        // Btypkin.Btypkin_Flag12
50344>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
50345>>>>>>>
50345>>>>>>>        // Btypkin.Btypkin_Flag13
50345>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
50346>>>>>>>
50346>>>>>>>        // Btypkin.Btypkin_Flag14
50346>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
50347>>>>>>>
50347>>>>>>>        // Btypkin.Btypkin_Flag15
50347>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
50348>>>>>>>
50348>>>>>>>        // Btypkin.Btypkin_Flag16
50348>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
50349>>>>>>>
50349>>>>>>>        // Btypkin.Btypkin_Flag17
50349>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
50350>>>>>>>
50350>>>>>>>        // Btypkin.Btypkin_Flag18
50350>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
50351>>>>>>>
50351>>>>>>>        // Btypkin.Btypkin_Flag19
50351>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
50352>>>>>>>
50352>>>>>>>        // Btypkin.Btypkin_Flag20
50352>>>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
50353>>>>>>>
50353>>>>>>>    End_Procedure    // Define_Fields
50354>>>>>>>
50354>>>>>>>
50354>>>>>>>
50354>>>>>>>    // Field_Defaults:
50354>>>>>>>    // This procedure is used to establish default field values.
50354>>>>>>>
50354>>>>>>>    Procedure Field_Defaults
50355>>>>>>>        Forward Send Field_Defaults
50357>>>>>>>        //DDB-Generated-Code-Location
50357>>>>>>>        //DDB-FieldDefaultStart
50357>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
50358>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
50359>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
50360>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
50361>>>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
50362>>>>>>>        //DDB-FieldDefaultEnd
50362>>>>>>>    End_Procedure    // Field_Defaults
50363>>>>>>>End_Class    // Btypkin_DataDictionary
50364>>>>>>>//DDB-Selection-pkg-Start
50364>>>>>>>
50364>>>>>>>Use SL031.SL         // SL031
INCLUDING FILE: SL031.SL
50364>>>>>>>>>//AB/ Project SL031:BTYPKIN
50364>>>>>>>>>//AB/ Object prj is a Lookup_Project
50364>>>>>>>>>//AB/     Set ProjectName to "SL031:BTYPKIN"
50364>>>>>>>>>//AB/     Set ProjectFileName to "SL031.SL"
50364>>>>>>>>>
50364>>>>>>>>>// Project Object Structure
50364>>>>>>>>>//   SL031 is a dbModalPanelSub
50364>>>>>>>>>//     Btypkin_DD is a DataDictionary
50364>>>>>>>>>//     oSelList is a dbListSub
50364>>>>>>>>>//     oOK_bn is a ButtonSub
50364>>>>>>>>>//     oCancel_bn is a ButtonSub
50364>>>>>>>>>//     oSearch_bn is a ButtonSub
50364>>>>>>>>>
50364>>>>>>>>>// Register all objects
50364>>>>>>>>>Register_Object Btypkin_DD
50364>>>>>>>>>Register_Object oCancel_bn
50364>>>>>>>>>Register_Object oOK_bn
50364>>>>>>>>>Register_Object oSearch_bn
50364>>>>>>>>>Register_Object oSelList
50364>>>>>>>>>Register_Object SL031
50364>>>>>>>>>
50364>>>>>>>>>
50364>>>>>>>>>//AB-IgnoreStart
50364>>>>>>>>>
50364>>>>>>>>>Use DFAllEnt.pkg
50364>>>>>>>>>Use dbList.Sub
50364>>>>>>>>>Use Button.Sub
50364>>>>>>>>>
50364>>>>>>>>>
50364>>>>>>>>>Use BTYPKIN.DD
50364>>>>>>>>>
50364>>>>>>>>>//AB-IgnoreEnd
50364>>>>>>>>>
50364>>>>>>>>>CD_Popup_Object SL031 is a dbModalPanelSub
50383>>>>>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
50384>>>>>>>>>    Set Size to 213 506
50385>>>>>>>>>    Set Location to 4 5
50386>>>>>>>>>    Set Exit_Application_Local_State to FALSE
50387>>>>>>>>>    Set Modal_State to FALSE
50388>>>>>>>>>
50388>>>>>>>>>    //AB-DDOStart
50388>>>>>>>>>
50388>>>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
50390>>>>>>>>>    End_Object    // Btypkin_DD
50391>>>>>>>>>
50391>>>>>>>>>    Set Main_DD to (Btypkin_DD(self))
50392>>>>>>>>>    Set Server to (Btypkin_DD(self))
50393>>>>>>>>>
50393>>>>>>>>>    //AB-DDOEnd
50393>>>>>>>>>
50393>>>>>>>>>    Object oSelList is a dbListSub
50395>>>>>>>>>        Set Main_File to Btypkin.File_Number
50396>>>>>>>>>        Set Size to 173 491
50397>>>>>>>>>        Set Location to 3 6
50398>>>>>>>>>
50398>>>>>>>>>        Begin_Row
50401>>>>>>>>>            Entry_Item Btypkin.Btypkin_code
50402>>>>>>>>>            Entry_Item Btypkin.Btypkin_descr
50403>>>>>>>>>            Entry_Item Btypkin.Gtypkin_code
50404>>>>>>>>>            Entry_Item Btypkin.Ctypkin_code
50405>>>>>>>>>            Entry_Item Btypkin.Vtypkin_code
50406>>>>>>>>>            Entry_Item Btypkin.Btypkin_anti_xp
50407>>>>>>>>>            Entry_Item Btypkin.Locked
50408>>>>>>>>>        End_Row
50413>>>>>>>>>
50413>>>>>>>>>        Set Form_Width    item 0 to 39
50414>>>>>>>>>        Set Header_Label  item 0 to "‰å¤ž©ž"
50415>>>>>>>>>        
50415>>>>>>>>>        Set Form_Width    item 1 to 172
50416>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50417>>>>>>>>>        
50417>>>>>>>>>        Set Form_Width    item 2 to 46
50418>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž ‚Š"
50419>>>>>>>>>        
50419>>>>>>>>>        Set Form_Width    item 3 to 70
50420>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž œ¢˜«é¤        "
50421>>>>>>>>>        
50421>>>>>>>>>        Set Form_Width    item 4 to 53
50422>>>>>>>>>        Set Header_Label  item 4 to "‰å¤ž©ž ¨¦£."
50423>>>>>>>>>        
50423>>>>>>>>>        Set Form_Width    item 5 to 64
50424>>>>>>>>>        Set Header_Label  item 5 to "• ‘¬¤˜¢¢˜©¦£."
50425>>>>>>>>>        
50425>>>>>>>>>        Set Form_Width    item 6 to 42
50426>>>>>>>>>        Set Header_Label  item 6 to "‰¢œ ›à£â¤ž"
50427>>>>>>>>>        Set Column_Checkbox_State  item 6 to True
50428>>>>>>>>>        
50428>>>>>>>>>    End_Object    // oSelList
50429>>>>>>>>>
50429>>>>>>>>>    Object oOK_bn is a ButtonSub
50431>>>>>>>>>        Set Label to "&„§ ¢¦šã"
50432>>>>>>>>>        Set Location to 177 337
50433>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50434>>>>>>>>>
50434>>>>>>>>>        //AB-StoreStart
50434>>>>>>>>>        Procedure OnClick
50436>>>>>>>>>            Send OK To oSelList
50437>>>>>>>>>        End_Procedure
50438>>>>>>>>>        //AB-StoreEnd
50438>>>>>>>>>
50438>>>>>>>>>    End_Object    // oOK_bn
50439>>>>>>>>>
50439>>>>>>>>>    Object oCancel_bn is a ButtonSub
50441>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
50442>>>>>>>>>        Set Location to 177 393
50443>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50444>>>>>>>>>
50444>>>>>>>>>        //AB-StoreStart
50444>>>>>>>>>        Procedure OnClick
50446>>>>>>>>>            Send Cancel To oSelList
50447>>>>>>>>>        End_Procedure
50448>>>>>>>>>        //AB-StoreEnd
50448>>>>>>>>>
50448>>>>>>>>>    End_Object    // oCancel_bn
50449>>>>>>>>>
50449>>>>>>>>>    Object oSearch_bn is a ButtonSub
50451>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
50452>>>>>>>>>        Set Location to 177 447
50453>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
50454>>>>>>>>>
50454>>>>>>>>>        //AB-StoreStart
50454>>>>>>>>>        Procedure OnClick
50456>>>>>>>>>            Send Search To oSelList
50457>>>>>>>>>        End_Procedure
50458>>>>>>>>>        //AB-StoreEnd
50458>>>>>>>>>
50458>>>>>>>>>    End_Object    // oSearch_bn
50459>>>>>>>>>
50459>>>>>>>>>
50459>>>>>>>>>    //AB-StoreStart
50459>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
50460>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
50461>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
50462>>>>>>>>>    
50462>>>>>>>>>    //AB-StoreEnd
50462>>>>>>>>>
50462>>>>>>>>>CD_End_Object    // SL031
50464>>>>>>>>>>
50464>>>>>>>>>
50464>>>>>>>>>//AB/ End_Object    // prj
50464>>>>>>>Use sl007.SL         // sl007
50464>>>>>>>Use sl007r.SL        // sl007r
INCLUDING FILE: SL007R.SL
50464>>>>>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
50464>>>>>>>>>//AB/     Object prj is a Lookup_Project
50464>>>>>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
50464>>>>>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
50464>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
50464>>>>>>>>>
50464>>>>>>>>>// Project Object Structure
50464>>>>>>>>>//   sl007r is a dbModalPanelSub
50464>>>>>>>>>//     Ctypkin_DD is a DataDictionary
50464>>>>>>>>>//     oSelList is a dbListSub
50464>>>>>>>>>//     oOK_bn is a ButtonSub
50464>>>>>>>>>//     oCancel_bn is a ButtonSub
50464>>>>>>>>>//     oSearch_bn is a ButtonSub
50464>>>>>>>>>
50464>>>>>>>>>// Register all objects
50464>>>>>>>>>Register_Object Ctypkin_DD
50464>>>>>>>>>Register_Object oCancel_bn
50464>>>>>>>>>Register_Object oOK_bn
50464>>>>>>>>>Register_Object oSearch_bn
50464>>>>>>>>>Register_Object oSelList
50464>>>>>>>>>Register_Object sl007r
50464>>>>>>>>>
50464>>>>>>>>>
50464>>>>>>>>>    //AB-IgnoreStart
50464>>>>>>>>>
50464>>>>>>>>>    Use DFAllEnt.pkg
50464>>>>>>>>>    Use dbList.Sub
50464>>>>>>>>>    Use Button.Sub
50464>>>>>>>>>
50464>>>>>>>>>
50464>>>>>>>>>    Use CTYPKIN.DD
50464>>>>>>>>>    
50464>>>>>>>>>    //AB-IgnoreEnd
50464>>>>>>>>>
50464>>>>>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
50483>>>>>>>>>        Set Label to "Ctypkin"
50484>>>>>>>>>        Set Size to 148 480
50485>>>>>>>>>        Set Location to 12 16
50486>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50487>>>>>>>>>        Set Modal_State to FALSE
50488>>>>>>>>>
50488>>>>>>>>>        //AB-DDOStart
50488>>>>>>>>>
50488>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
50490>>>>>>>>>        End_Object    // Ctypkin_DD
50491>>>>>>>>>
50491>>>>>>>>>        Set Main_DD to (Ctypkin_DD(self))
50492>>>>>>>>>        Set Server to (Ctypkin_DD(self))
50493>>>>>>>>>
50493>>>>>>>>>        //AB-DDOEnd
50493>>>>>>>>>
50493>>>>>>>>>        Object oSelList is a dbListSub
50495>>>>>>>>>            Set Main_File to Ctypkin.File_Number
50496>>>>>>>>>            Set Size to 105 465
50497>>>>>>>>>            Set Location to 6 6
50498>>>>>>>>>
50498>>>>>>>>>            Begin_Row
50501>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_recr
50502>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_code
50503>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_descr
50504>>>>>>>>>                Entry_Item Ctypkin.Ctypkin_anti
50505>>>>>>>>>            End_Row
50510>>>>>>>>>
50510>>>>>>>>>            Set Form_Width    item 0 to 72
50511>>>>>>>>>            Set Header_Label  item 0 to "RecR"
50512>>>>>>>>>            
50512>>>>>>>>>            Set Form_Width    item 1 to 58
50513>>>>>>>>>            Set Header_Label  item 1 to "Ctypkin code"
50514>>>>>>>>>            
50514>>>>>>>>>            Set Form_Width    item 2 to 209
50515>>>>>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
50516>>>>>>>>>            
50516>>>>>>>>>            Set Form_Width    item 3 to 120
50517>>>>>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
50518>>>>>>>>>            
50518>>>>>>>>>
50518>>>>>>>>>            //AB-StoreStart
50518>>>>>>>>>            
50518>>>>>>>>>            Set Column_Option Item 0 to Noenter True
50519>>>>>>>>>            
50519>>>>>>>>>            //AB-StoreEnd
50519>>>>>>>>>
50519>>>>>>>>>        End_Object    // oSelList
50520>>>>>>>>>
50520>>>>>>>>>        Object oOK_bn is a ButtonSub
50522>>>>>>>>>            set label to "&„§ ¢¦šã" 
50523>>>>>>>>>            Set Location to 114 312
50524>>>>>>>>>
50524>>>>>>>>>            //AB-StoreStart
50524>>>>>>>>>            Procedure OnClick
50526>>>>>>>>>                Send OK To (oSelList(current_object))
50527>>>>>>>>>            End_Procedure
50528>>>>>>>>>            //AB-StoreEnd
50528>>>>>>>>>
50528>>>>>>>>>        End_Object    // oOK_bn
50529>>>>>>>>>
50529>>>>>>>>>        Object oCancel_bn is a ButtonSub
50531>>>>>>>>>            set label to "&€¡ç¨à©ž" 
50532>>>>>>>>>            Set Location to 114 367
50533>>>>>>>>>
50533>>>>>>>>>            //AB-StoreStart
50533>>>>>>>>>            Procedure OnClick
50535>>>>>>>>>                Send Cancel To (oSelList(current_object))
50536>>>>>>>>>            End_Procedure
50537>>>>>>>>>            //AB-StoreEnd
50537>>>>>>>>>
50537>>>>>>>>>        End_Object    // oCancel_bn
50538>>>>>>>>>
50538>>>>>>>>>        Object oSearch_bn is a ButtonSub
50540>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
50541>>>>>>>>>            Set Location to 114 422
50542>>>>>>>>>
50542>>>>>>>>>            //AB-StoreStart
50542>>>>>>>>>            Procedure OnClick
50544>>>>>>>>>                Send Search To (oSelList(current_object))
50545>>>>>>>>>            End_Procedure
50546>>>>>>>>>            //AB-StoreEnd
50546>>>>>>>>>
50546>>>>>>>>>        End_Object    // oSearch_bn
50547>>>>>>>>>
50547>>>>>>>>>
50547>>>>>>>>>        //AB-StoreStart
50547>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
50548>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
50549>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
50550>>>>>>>>>        //AB-StoreEnd
50550>>>>>>>>>
50550>>>>>>>>>    CD_End_Object    // sl007r
50552>>>>>>>>>>
50552>>>>>>>>>
50552>>>>>>>>>//AB/     End_Object    // prj
50552>>>>>>>
50552>>>>>>>//DDB-Selection-pkg-End
50552>>>>>>>//DDB-FileEnd
50552>>>>>    Use BAXIOKAT.DD
50552>>>>>    Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
50552>>>>>>>//DDB-FileStart
50552>>>>>>>//DDB-HeaderStart
50552>>>>>>>
50552>>>>>>>// File Name : BARTICL.DD
50552>>>>>>>// Class Name: Barticl_DataDictionary
50552>>>>>>>// Revision  : 94
50552>>>>>>>// Version   : 2
50552>>>>>>>
50552>>>>>>>Use  Windows           // Basic Definitions
50552>>>>>>>Use  DataDict          // DataDictionary Class Definition
50552>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50552>>>>>>>
50552>>>>>>>Open Barticl
50554>>>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
50556>>>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
50558>>>>>>>Open Btypkin
50560>>>>>>>Open Sysrecb
50562>>>>>>>Open Cn
50564>>>>>>>
50564>>>>>>>//DDB-HeaderEnd
50564>>>>>>>//DDB-ValidationStart
50564>>>>>>>
50564>>>>>>>Register_Object Barticl_Barticl_M_Code_VT
50564>>>>>>>
50564>>>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
50566>>>>>>>    Set Type_Value        To "MODULE"
50567>>>>>>>    Set Allow_Blank_State To TRUE
50568>>>>>>>    //DDB-ValidationCustomStart
50568>>>>>>>    //DDB-ValidationCustomEnd
50568>>>>>>>End_Object   // Barticl_Barticl_M_Code_VT
50569>>>>>>>//DDB-ValidationEnd
50569>>>>>>>//DDB-SelectionStart
50569>>>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
50569>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
50569>>>>>>>Register_Object Barticl
50569>>>>>>>Register_Object sl041
50569>>>>>>>//DDB-SelectionEnd
50569>>>>>>>
50569>>>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
50570>>>>>>>
50570>>>>>>>    Procedure Shmera integer iField  Date dDate
50571>>>>>>>        Local Integer Changed
50572>>>>>>>        Get Field_Changed_State iField to Changed
50573>>>>>>>        If (Changed=0 AND dDate =0) Begin
50575>>>>>>>            SysDate4 dDate
50576>>>>>>>            Set Field_Default_Value iField to dDate
50577>>>>>>>        End
50577>>>>>>>>
50577>>>>>>>    End_Procedure   // Shmera
50578>>>>>>>
50578>>>>>>>    Procedure Save_Main_File
50579>>>>>>>        If (Barticl.Cn_Code<>'') Begin  
50581>>>>>>>            Clear Cn   
50582>>>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
50583>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code  
50584>>>>>>>>
50584>>>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
50585>>>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
50586>>>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
50587>>>>>>>        End
50587>>>>>>>>
50587>>>>>>>        Forward Send Save_Main_File
50589>>>>>>>    End_Procedure   // Save_Main_File
50590>>>>>>>
50590>>>>>>>      Procedure private.Initialize_Properties
50591>>>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
50591>>>>>>>                 Set psB_Btypkin_Recr    to ''
50592>>>>>>>                 Set pdB_Barticl_Hmnia   to 0
50593>>>>>>>                 Set piB_Barticl_No      to 0
50594>>>>>>>                 Set psB_Barticl_Code1   to ""
50595>>>>>>>
50595>>>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
50596>>>>>>>                 Set piB_Garticl_No      to 0
50597>>>>>>>                 Set psB_Garticl_Aitiol  to ""
50598>>>>>>>
50598>>>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
50598>>>>>>>                 Set psA_Btypkin_Recr    to ''
50599>>>>>>>                 Set pdA_Barticl_Hmnia   to 0
50600>>>>>>>                 Set piA_Barticl_No      to 0
50601>>>>>>>                 Set psA_Barticl_Code1   to ""
50602>>>>>>>
50602>>>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
50603>>>>>>>                 Set piA_Garticl_No      to 0
50604>>>>>>>                 Set psA_Garticl_Aitiol  to ""
50605>>>>>>>
50605>>>>>>>                 Set psB_Gplan_Code to ""
50606>>>>>>>                 Set psA_Gplan_Code to ""
50607>>>>>>>
50607>>>>>>>      End_Procedure //private.Initialize_Properties
50608>>>>>>>
50608>>>>>>>
50608>>>>>>>      Procedure Construct_Object
50609>>>>>>>                Forward Send Construct_Object
50611>>>>>>>
50611>>>>>>>                Property String  psA_Btypkin_Recr     ''
50612>>>>>>>                Property Date    pdA_Barticl_Hmnia    0
50613>>>>>>>                Property Integer piA_Barticl_No       0
50614>>>>>>>                Property String  psB_Barticl_Code1    ""
50615>>>>>>>
50615>>>>>>>                Property String  psB_Btypkin_Recr     ''
50616>>>>>>>                Property Date    pdB_Barticl_Hmnia    0
50617>>>>>>>                Property Integer piB_Barticl_No       0
50618>>>>>>>                Property String  psA_Barticl_Code1    ""
50619>>>>>>>
50619>>>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
50620>>>>>>>                Property Integer piA_Garticl_No       0
50621>>>>>>>                Property String  psA_Garticl_Aitiol   ''
50622>>>>>>>
50622>>>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
50623>>>>>>>                Property Integer piB_Garticl_No       0
50624>>>>>>>                Property String  psB_Garticl_Aitiol   ''
50625>>>>>>>
50625>>>>>>>
50625>>>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
50626>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
50626>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
50626>>>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
50627>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
50627>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
50627>>>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
50628>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
50628>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
50628>>>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
50629>>>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
50629>>>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
50629>>>>>>>
50629>>>>>>>                Property String  psB_Gplan_Code
50630>>>>>>>                Property String  psA_Gplan_Code
50631>>>>>>>
50631>>>>>>>
50631>>>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
50632>>>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
50632>>>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
50632>>>>>>>
50632>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
50633>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
50633>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
50634>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
50634>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
50635>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
50635>>>>>>>      End_Procedure   //construct_object
50636>>>>>>>
50636>>>>>>>      Procedure Update
50637>>>>>>>                Integer liBAxio_dd liBaxiokat_dd
50638>>>>>>>                Forward Send Update
50640>>>>>>>
50640>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
50640>>>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
50641>>>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
50642>>>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
50643>>>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
50644>>>>>>>
50644>>>>>>>
50644>>>>>>>                //™) ˜¤áš¤à©ž properties
50644>>>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
50645>>>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
50646>>>>>>>
50646>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
50646>>>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
50646>>>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
50647>>>>>>>
50647>>>>>>>                Case Begin
50647>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
50649>>>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
50650>>>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
50651>>>>>>>                      Case Break
50652>>>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
50655>>>>>>>                        Move ""                    to Barticl.Barticl_Code2
50656>>>>>>>                        Move ""                    to Barticl.Barticl_Epon2
50657>>>>>>>                      Case Break
50658>>>>>>>                Case End
50658>>>>>>>
50658>>>>>>>
50658>>>>>>>                Case Begin
50658>>>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
50660>>>>>>>                        Clear Clients
50661>>>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
50662>>>>>>>                        Find Eq Clients by Index.6 //Client_ID
50663>>>>>>>>
50663>>>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
50666>>>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
50668>>>>>>>                      Case Break
50669>>>>>>>                Case End
50669>>>>>>>
50669>>>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
50671>>>>>>>                      //master gplan rec0
50671>>>>>>>                      Case Begin
50671>>>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
50673>>>>>>>//jsjsjs 24/01/2001
50673>>>>>>>//                                Clear Gplan
50673>>>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
50673>>>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
50673>>>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
50673>>>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
50673>>>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
50673>>>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
50673>>>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
50673>>>>>>>//jsjsjs 24/01/2001
50673>>>>>>>                           Case Break
50674>>>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
50674>>>>>>>                                Move 0 to Barticl.Gplan_Mrec0
50675>>>>>>>                      Case End
50675>>>>>>>                End   //please check the logic
50675>>>>>>>>
50675>>>>>>>
50675>>>>>>>
50675>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
50675>>>>>>>
50675>>>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
50675>>>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
50676>>>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
50677>>>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
50678>>>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
50679>>>>>>>
50679>>>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
50680>>>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
50681>>>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
50682>>>>>>>
50682>>>>>>>      End_Procedure   //update
50683>>>>>>>
50683>>>>>>>
50683>>>>>>>      Procedure Backout
50684>>>>>>>                Forward Send Backout
50686>>>>>>>
50686>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
50686>>>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
50687>>>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
50688>>>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
50689>>>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
50690>>>>>>>
50690>>>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
50691>>>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
50692>>>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
50693>>>>>>>      End_Procedure   // backout
50694>>>>>>>
50694>>>>>>>
50694>>>>>>>      Procedure Creating 
50695>>>>>>>                string sstr
50696>>>>>>>                Forward Send Creating
50698>>>>>>>
50698>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
50698>>>>>>>
50698>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
50699>>>>>>>
50699>>>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
50702>>>>>>>
50702>>>>>>>                //************************************************************************
50702>>>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
50702>>>>>>>                //************************************************************************
50702>>>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
50704>>>>>>>                      Add 1 to Btypkin.Btypkin_L_No
50705>>>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
50706>>>>>>>                     End
50706>>>>>>>>
50706>>>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
50707>>>>>>>                     End
50707>>>>>>>>
50707>>>>>>>                if ((btypkin.locked=1) and (barticl.barticl_hmnia ge btypkin.locked_date)) error 1966 '† ¡å¤ž©ž œå¤˜  ¡¢œ ›à£â¤ž' 
50710>>>>>>>                move '€¨.€„' To sstr 
50711>>>>>>>                Move (Append(sstr,(' '+(string(barticl.pae_arithm))+' - '+(string(Barticl.pae_hmnia))))) to sstr
50712>>>>>>>                move sstr to barticl.barticl_aitiol 
50713>>>>>>>                move 1 to barticl.ekkremes
50714>>>>>>>                
50714>>>>>>>                
50714>>>>>>>                Set piCreated_Barticl to TRUE
50715>>>>>>>      End_Procedure //creating
50716>>>>>>>
50716>>>>>>>
50716>>>>>>>      Procedure Deleting
50717>>>>>>>                Forward Send Deleting
50719>>>>>>>
50719>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
50719>>>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
50721>>>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
50722>>>>>>>                  // js 05/09/2002
50722>>>>>>>                  Saverecord Btypkin
50723>>>>>>>                End
50723>>>>>>>>
50723>>>>>>>      End_Procedure //deleting
50724>>>>>>>
50724>>>>>>>
50724>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
50725>>>>>>>                String lsError_Message
50726>>>>>>>                Case Begin
50726>>>>>>>                     //˜§æ validate save
50726>>>>>>>                     Case (iError_Num = 1001)
50728>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
50729>>>>>>>                     Case Break
50730>>>>>>>                     Case (iError_Num = 1002)
50733>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
50734>>>>>>>                     Case Break
50735>>>>>>>                     Case (iError_Num = 1003)
50738>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
50739>>>>>>>                     Case Break
50740>>>>>>>                     Case (iError_Num = 1004)
50743>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
50744>>>>>>>                     Case Break
50745>>>>>>>                     Case (iError_Num = 1005)
50748>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
50749>>>>>>>                     Case Break
50750>>>>>>>                     Case (iError_Num = 1006)
50753>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
50754>>>>>>>                     Case Break
50755>>>>>>>                     Case (iError_Num = 1007)
50758>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
50759>>>>>>>                     Case Break
50760>>>>>>>                     Case (iError_Num = 1008)
50763>>>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
50764>>>>>>>                     Case Break
50765>>>>>>>                     Case (iError_Num = 1009)
50768>>>>>>>                          Clear Codemast
50769>>>>>>>                          Move "MODULE" to Codemast.Type
50770>>>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
50771>>>>>>>                          Find Eq Codemast by Index.1 //type+code
50772>>>>>>>>
50772>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
50773>>>>>>>                     Case Break
50774>>>>>>>                     Case (iError_Num = 1011)
50777>>>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
50778>>>>>>>                     Case Break
50779>>>>>>>                     Case (iError_Num = 1100)
50782>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
50783>>>>>>>                          Case Break
50784>>>>>>>                     
50784>>>>>>>                     Case (iError_Num = 2100)
50787>>>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
50788>>>>>>>                          Case Break
50789>>>>>>>
50789>>>>>>>                   //˜§æ update
50789>>>>>>>                   Case (iError_Num = 3001)
50792>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
50793>>>>>>>                   Case Break
50794>>>>>>>                   Case (iError_Num = 3002)
50797>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
50798>>>>>>>                   Case Break
50799>>>>>>>                   Case (iError_Num = 3003)
50802>>>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
50803>>>>>>>                   Case Break
50804>>>>>>>
50804>>>>>>>                   Case (iError_Num = 1330)
50807>>>>>>>                          Move "DDC 036: €¨ Ÿ£æª .€.„. £ž›œ¤ ¡æª ã †£œ¨/¤å˜ .€.„. ¡œ¤ã" to lsError_Message
50808>>>>>>>                   Case Break
50809>>>>>>>
50809>>>>>>>                   Case (iError_Num = 1331)
50812>>>>>>>                          Move "DDC 036: †£œ¨/¤å˜ .€.„. ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
50813>>>>>>>                   Case Break
50814>>>>>>>
50814>>>>>>>                   Case (iError_Num = 1332)
50817>>>>>>>                          Move "DDC 036: †£œ¨/¤å˜ §˜¨˜©«˜« ¡¦ç ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
50818>>>>>>>                   Case Break
50819>>>>>>>
50819>>>>>>>                     Case Else
50819>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
50821>>>>>>>                Case End
50821>>>>>>>
50821>>>>>>>                Error iError_Num lsError_Message
50822>>>>>>>>
50822>>>>>>>      End_Procedure // operation_not_allowed
50823>>>>>>>
50823>>>>>>>      Function Validate_Save Returns Integer
50824>>>>>>>               Integer iReturnVal  
50825>>>>>>>               Date dShmera
50825>>>>>>>               Sysdate dShmera
50826>>>>>>>
50826>>>>>>>               Forward Get Validate_Save to iReturnVal
50828>>>>>>>               //Set piCreated_Barticl to 0
50828>>>>>>>
50828>>>>>>>               If (Not(iReturnVal));               Begin
50830>>>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
50830>>>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
50833>>>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
50836>>>>>>>
50836>>>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
50836>>>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
50839>>>>>>>                
50839>>>>>>>                
50839>>>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
50839>>>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
50842>>>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
50842>>>>>>>
50842>>>>>>>                //---------â¢œš®¦  create barticl record----------------------
50842>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
50842>>>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
50844>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
50844>>>>>>>>
50844>>>>>>>
50844>>>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
50844>>>>>>>                Else;                Begin //edit an existing record
50845>>>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
50845>>>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
50848>>>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
50848>>>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
50851>>>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
50851>>>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
50854>>>>>>>
50854>>>>>>>
50854>>>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
50854>>>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
50857>>>>>>>
50857>>>>>>>
50857>>>>>>>
50857>>>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
50857>>>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
50860>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
50860>>>>>>>>
50860>>>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
50863>>>>>>>
50863>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation         
50863>>>>>>>>
50863>>>>>>>               
50863>>>>>>>                If (sysfile.serial_number='1') Begin
50865>>>>>>>                    If ((Barticl.PAE_Arithm=0) Or (Barticl.PAE_Hmnia=""))   Send Operation_Not_Allowed 1330
50868>>>>>>>                    If (Barticl.PAE_Hmnia>dShmera)                          Send Operation_Not_Allowed 1331
50871>>>>>>>                End
50871>>>>>>>>
50871>>>>>>>
50871>>>>>>>                If (Barticl.Barticl_Hmnia>dShmera)                          Send Operation_Not_Allowed 1332
50874>>>>>>>               
50874>>>>>>>               Function_Return iReturnVal
50875>>>>>>>      End_Function   // validate_save
50876>>>>>>>
50876>>>>>>>
50876>>>>>>>      Function Validate_Delete  Returns Integer
50877>>>>>>>               Integer iReturnVal
50878>>>>>>>               Forward Get Validate_Delete  To iReturnVal
50880>>>>>>>               If (Not(iReturnVal));               Begin
50882>>>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
50885>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
50885>>>>>>>>
50885>>>>>>>               Function_Return iReturnVal
50886>>>>>>>      End_Function   // Validate_Delete
50887>>>>>>>
50887>>>>>>>
50887>>>>>>>
50887>>>>>>>      Procedure Request_Save
50888>>>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
50889>>>>>>>
50889>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
50890>>>>>>>
50890>>>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
50890>>>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
50890>>>>>>>               If ((Current_Record(Self)) = 0) Begin
50892>>>>>>>                    Forward Send Request_Save
50894>>>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
50895>>>>>>>                    Procedure_Return
50896>>>>>>>               End
50896>>>>>>>>
50896>>>>>>>
50896>>>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
50896>>>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
50896>>>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
50896>>>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
50896>>>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
50896>>>>>>>
50896>>>>>>>               BEGIN_TRANSACTION
50897>>>>>>>               Move Error_Object_ID to iErrorObj
50898>>>>>>>               Forward Send Request_Save
50900>>>>>>>
50900>>>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
50900>>>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
50901>>>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
50902>>>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
50903>>>>>>>
50903>>>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
50904>>>>>>>
50904>>>>>>>               END_TRANSACTION
50905>>>>>>>               Move iErrorObj to Error_Object_ID
50906>>>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
50907>>>>>>>
50907>>>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
50907>>>>>>>               Indicate Err False
50908>>>>>>>     End_Procedure   // request_save
50909>>>>>>>
50909>>>>>>>
50909>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
50909>>>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
50909>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
50909>>>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
50910>>>>>>>               Integer liBmove_dd
50911>>>>>>>
50911>>>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
50911>>>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
50911>>>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
50911>>>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
50911>>>>>>>
50911>>>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
50911>>>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
50912>>>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
50913>>>>>>>               Get piB_Barticl_No      to liB_Barticl_No
50914>>>>>>>
50914>>>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
50914>>>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
50915>>>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
50916>>>>>>>               Get piA_Barticl_No      to liA_Barticl_No
50917>>>>>>>
50917>>>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
50917>>>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
50917>>>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
50917>>>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
50919>>>>>>>                      Procedure_Return
50920>>>>>>>                     End
50920>>>>>>>>
50920>>>>>>>
50920>>>>>>>
50920>>>>>>>               //**************************************************************************
50920>>>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
50920>>>>>>>               //**************************************************************************
50920>>>>>>>               Get piBmove_dd           to liBmove_dd
50921>>>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
50922>>>>>>>               Send Rebuild_Constraints to Self
50923>>>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
50924>>>>>>>               Send Rebuild_Constraints to liBmove_dd
50925>>>>>>>
50925>>>>>>>               //**************************************************************************
50925>>>>>>>               //03.©á¨à©ž Bmove
50925>>>>>>>               //**************************************************************************
50925>>>>>>>               Send Clear to liBmove_dd
50926>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
50927>>>>>>>               While (Found=1)
50931>>>>>>>                      Send Request_Save to liBmove_dd
50932>>>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
50933>>>>>>>               Loop
50934>>>>>>>>
50934>>>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
50935>>>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
50935>>>>>>>     End_Procedure //private.transaction_cascade_update_bmove
50936>>>>>>>
50936>>>>>>>
50936>>>>>>>
50936>>>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
50936>>>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
50936>>>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
50936>>>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
50936>>>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
50937>>>>>>>
50937>>>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
50938>>>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
50938>>>>>>>
50938>>>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
50938>>>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
50938>>>>>>>
50938>>>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
50938>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
50939>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
50940>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
50941>>>>>>>
50941>>>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
50941>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
50942>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
50943>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
50944>>>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
50945>>>>>>>
50945>>>>>>>     End_Procedure //private.transaction_update_other_modules
50946>>>>>>>
50946>>>>>>>
50946>>>>>>>    Procedure Define_Fields
50947>>>>>>>        Forward Send Define_Fields
50949>>>>>>>        //DDB-Generated-Code-Location
50949>>>>>>>        //DDB-DefineFieldStart
50949>>>>>>>
50949>>>>>>>        Set Main_File            To Barticl.File_Number
50950>>>>>>>        Set Cascade_Delete_State To FALSE
50951>>>>>>>
50951>>>>>>>
50951>>>>>>>        // Child (Client) file structure................
50951>>>>>>>        Send Add_Client_File  Bmove.File_Number
50952>>>>>>>        Send Add_Client_File  Bsum.File_Number
50953>>>>>>>
50953>>>>>>>        // Parent (Server) file structure...............
50953>>>>>>>        Send Add_Server_File  Btypkin.File_Number
50954>>>>>>>
50954>>>>>>>        // External (System) file structure.............
50954>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
50955>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
50956>>>>>>>
50956>>>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
50959>>>>>>>
50959>>>>>>>        // Field-based properties.......................
50959>>>>>>>
50959>>>>>>>        // Barticl.Company_Code
50959>>>>>>>
50959>>>>>>>        // Barticl.Branch_Code
50959>>>>>>>
50959>>>>>>>        // Barticl.Year_Year
50959>>>>>>>
50959>>>>>>>        // Barticl.Btypkin_Code
50959>>>>>>>
50959>>>>>>>        // Barticl.Barticl_Hmnia
50959>>>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
50960>>>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
50961>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_No
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Rec0
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Recr
50962>>>>>>>
50962>>>>>>>        // Barticl.Btypkin_Recr
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Code1
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Epon1
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Code2
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Epon2
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Aitiol
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Sv2
50962>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Sv0
50962>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Sv00
50962>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Svr
50962>>>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Lines
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_Bmovela
50962>>>>>>>
50962>>>>>>>        // Barticl.Barticl_M_Code
50962>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
50963>>>>>>>
50963>>>>>>>        // Barticl.Garticl_Rec0
50963>>>>>>>
50963>>>>>>>        // Barticl.Carticl_Rec0
50963>>>>>>>
50963>>>>>>>        // Barticl.Varticl_Rec0
50963>>>>>>>
50963>>>>>>>        // Barticl.Gmove_Mrec0
50963>>>>>>>
50963>>>>>>>        // Barticl.Gplan_Mrec0
50963>>>>>>>
50963>>>>>>>        // Barticl.Client_Mrecr
50963>>>>>>>
50963>>>>>>>        // Barticl.Barticl_Ekleise
50963>>>>>>>
50963>>>>>>>        // Barticl.Cmoves_Recr
50963>>>>>>>
50963>>>>>>>        // Barticl.Isotimia
50963>>>>>>>
50963>>>>>>>        // Barticl.Cn_Code
50963>>>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
50964>>>>>>>
50964>>>>>>>        // Barticl.Cn_Descr
50964>>>>>>>
50964>>>>>>>        // Barticl.Cn_Recr
50964>>>>>>>
50964>>>>>>>        // Barticl.Sls_Id
50964>>>>>>>
50964>>>>>>>        // Barticl.Cnt_Id
50964>>>>>>>
50964>>>>>>>        // Barticl.Presp_Id
50964>>>>>>>
50964>>>>>>>        // Barticl.Se_Logik
50964>>>>>>>
50964>>>>>>>        // Barticl.Sxolia1
50964>>>>>>>
50964>>>>>>>        // Barticl.Sxolia2
50964>>>>>>>
50964>>>>>>>        // Barticl.Partl_Akyr_Recr
50964>>>>>>>
50964>>>>>>>        // Barticl.Ekkremes
50964>>>>>>>
50964>>>>>>>        // Barticl.Arith_Orist
50964>>>>>>>
50964>>>>>>>        // Barticl.Hmnia_Orist
50964>>>>>>>
50964>>>>>>>        // Barticl.Pae_Arithm
50964>>>>>>>
50964>>>>>>>        // Barticl.Pae_Hmnia
50964>>>>>>>
50964>>>>>>>        //DDB-DefineFieldEnd
50964>>>>>>>
50964>>>>>>>//        Set Main_File            To Barticl.File_Number
50964>>>>>>>
50964>>>>>>>//        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
50964>>>>>>>//        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
50964>>>>>>>//        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
50964>>>>>>>
50964>>>>>>>//        // Child (Client) file structure................
50964>>>>>>>//        Send Add_Client_File  Bsum.File_Number
50964>>>>>>>//        Send Add_Client_File  Bmove.File_Number
50964>>>>>>>
50964>>>>>>>//        // Parent (Server) file structure...............
50964>>>>>>>//        Send Add_Server_File  Btypkin.File_Number
50964>>>>>>>
50964>>>>>>>//        // External (System) file structure.............
50964>>>>>>>//        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
50964>>>>>>>//        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
50964>>>>>>>
50964>>>>>>>//        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
50964>>>>>>>
50964>>>>>>>        // Field-based properties.......................
50964>>>>>>>
50964>>>>>>>        // Barticl.Company_Code
50964>>>>>>>
50964>>>>>>>        // Barticl.Branch_Code
50964>>>>>>>
50964>>>>>>>        // Barticl.Year_Year
50964>>>>>>>
50964>>>>>>>        // Barticl.Btypkin_Code
50964>>>>>>>
50964>>>>>>>        // Barticl.Barticl_Hmnia
50964>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
50965>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
50966>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
50967>>>>>>>
50967>>>>>>>        // Barticl.Barticl_No
50967>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
50968>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
50969>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
50970>>>>>>>
50970>>>>>>>        // Barticl.Barticl_Rec0
50970>>>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
50971>>>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
50972>>>>>>>
50972>>>>>>>        // Barticl.Btypkin_Rec0
50972>>>>>>>
50972>>>>>>>        // Barticl.Barticl_Code1
50972>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
50973>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
50974>>>>>>>
50974>>>>>>>        // Barticl.Barticl_Epon1
50974>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
50975>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
50976>>>>>>>
50976>>>>>>>        // Barticl.Barticl_Code2
50976>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
50977>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
50978>>>>>>>
50978>>>>>>>        // Barticl.Barticl_Epon2
50978>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
50979>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
50980>>>>>>>
50980>>>>>>>        // Barticl.Barticl_Aitiol
50980>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
50981>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
50982>>>>>>>
50982>>>>>>>        // Barticl.Barticl_Sv2
50982>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
50983>>>>>>>
50983>>>>>>>        // Barticl.Barticl_Sv0
50983>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
50984>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
50985>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
50986>>>>>>>
50986>>>>>>>        // Barticl.Barticl_Sv00
50986>>>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
50987>>>>>>>
50987>>>>>>>        // Barticl.Barticl_Svr
50987>>>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
50988>>>>>>>
50988>>>>>>>        // Barticl.Barticl_Lines
50988>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
50989>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
50990>>>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
50991>>>>>>>
50991>>>>>>>        // Barticl.Barticl_Bmovela
50991>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
50992>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
50993>>>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
50994>>>>>>>
50994>>>>>>>        // Barticl.Barticl_M_Code
50994>>>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
50995>>>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
50996>>>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
50997>>>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
50998>>>>>>>
50998>>>>>>>        // Barticl.Garticl_Rec0
50998>>>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
50999>>>>>>>
50999>>>>>>>        // Barticl.Carticl_Rec0
50999>>>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
51000>>>>>>>
51000>>>>>>>        // Barticl.Varticl_Rec0
51000>>>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
51001>>>>>>>
51001>>>>>>>        // Barticl.Gmove_Mrec0
51001>>>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
51002>>>>>>>
51002>>>>>>>        // Barticl.Gplan_Mrec0
51002>>>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
51003>>>>>>>
51003>>>>>>>    End_Procedure    // Define_Fields
51004>>>>>>>
51004>>>>>>>
51004>>>>>>>    Procedure Field_Defaults
51005>>>>>>>        Forward Send Field_Defaults
51007>>>>>>>        //DDB-Generated-Code-Location
51007>>>>>>>        //DDB-FieldDefaultStart
51007>>>>>>>        Set Field_Changed_Value   Field Barticl.Ekkremes To 1
51008>>>>>>>        //DDB-FieldDefaultEnd
51008>>>>>>>    End_Procedure    // Field_Defaults
51009>>>>>>>
51009>>>>>>>End_Class    // Barticl_DataDictionary
51010>>>>>>>//DDB-Selection-pkg-Start
51010>>>>>>>
51010>>>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
51010>>>>>>>>>//AB/ Project Barticl:Lookup
51010>>>>>>>>>//AB/ Object prj is a Lookup_Project
51010>>>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
51010>>>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
51010>>>>>>>>>
51010>>>>>>>>>// Project Object Structure
51010>>>>>>>>>//   Barticl is a dbModalPanelSub
51010>>>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
51010>>>>>>>>>//     Btypkin_DD is a DataDictionary
51010>>>>>>>>>//     Barticl_DD is a DataDictionary
51010>>>>>>>>>//     Country_DD is a DataDictionary
51010>>>>>>>>>//     Towns_DD is a DataDictionary
51010>>>>>>>>>//     Cities_DD is a DataDictionary
51010>>>>>>>>>//     Areas_DD is a DataDictionary
51010>>>>>>>>>//     Payresp_DD is a DataDictionary
51010>>>>>>>>>//     Clients_DD is a DataDictionary
51010>>>>>>>>>//     oSelList is a dbListSub
51010>>>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
51010>>>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
51010>>>>>>>>>//     Clients_Client_Name is a dbFormSub
51010>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
51010>>>>>>>>>//     chkOpen is a CheckBoxSub
51010>>>>>>>>>//     ButtonSub1 is a ButtonSub
51010>>>>>>>>>//     oOK_bn is a ButtonSub
51010>>>>>>>>>//     oCancel_bn is a ButtonSub
51010>>>>>>>>>
51010>>>>>>>>>// Register all objects
51010>>>>>>>>>Register_Object Areas_DD
51010>>>>>>>>>Register_Object Barticl
51010>>>>>>>>>Register_Object Barticl_DD
51010>>>>>>>>>Register_Object Btypkin_Btypkin_Code
51010>>>>>>>>>Register_Object Btypkin_Btypkin_Descr
51010>>>>>>>>>Register_Object Btypkin_DD
51010>>>>>>>>>Register_Object Btypkin_DD2
51010>>>>>>>>>Register_Object ButtonSub1
51010>>>>>>>>>Register_Object Cities_DD
51010>>>>>>>>>Register_Object Clients_Client_Name
51010>>>>>>>>>Register_Object Clients_DD
51010>>>>>>>>>Register_Object Country_DD
51010>>>>>>>>>Register_Object chkOpen
51010>>>>>>>>>Register_Object cSyDateForm1
51010>>>>>>>>>Register_Object oCancel_bn
51010>>>>>>>>>Register_Object oOK_bn
51010>>>>>>>>>Register_Object oSelList
51010>>>>>>>>>Register_Object Payresp_DD
51010>>>>>>>>>Register_Object Towns_DD
51010>>>>>>>>>
51010>>>>>>>>>
51010>>>>>>>>>//AB-IgnoreStart
51010>>>>>>>>>
51010>>>>>>>>>Use DFAllEnt.pkg
51010>>>>>>>>>Use dbList.Sub
51010>>>>>>>>>Use dbForm.Sub
51010>>>>>>>>>Use cSyDateForm.Pkg
51010>>>>>>>>>Use Chkbox.Sub
51010>>>>>>>>>Use Button.Sub
51010>>>>>>>>>
51010>>>>>>>>>
51010>>>>>>>>>Use BTYPKIN.DD
51010>>>>>>>>>Use BARTICL.DD
51010>>>>>>>>>Use COUNTRY.DD
51010>>>>>>>>>Use TOWNS.DD
51010>>>>>>>>>Use CITIES.DD
51010>>>>>>>>>Use AREAS.DD
51010>>>>>>>>>Use PAYRESP.DD
51010>>>>>>>>>Use CLIENTS.DD
51010>>>>>>>>>
51010>>>>>>>>>//AB-IgnoreEnd
51010>>>>>>>>>
51010>>>>>>>>>Object Barticl is a dbModalPanelSub
51012>>>>>>>>>
51012>>>>>>>>>    //AB-StoreTopStart
51012>>>>>>>>>                    
51012>>>>>>>>>    Property Integer    piWhat              Public  0
51014>>>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
51016>>>>>>>>>    Property Integer    piIsOpen            Public  0
51018>>>>>>>>>    Property String     FragmaClientID      Public ''
51020>>>>>>>>>    Property String     FragmaClientEpon    Public ''
51022>>>>>>>>>    Property Date       FragmaHmnia         Public ''
51024>>>>>>>>>    
51024>>>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
51026>>>>>>>>>    End_Object
51027>>>>>>>>>    
51027>>>>>>>>>    
51027>>>>>>>>>    //AB-StoreTopEnd
51027>>>>>>>>>
51027>>>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
51028>>>>>>>>>    Set Size to 289 519
51029>>>>>>>>>    Set Location to 2 5
51030>>>>>>>>>    Set Exit_Application_Local_State to FALSE
51031>>>>>>>>>    Set Modal_State to FALSE
51032>>>>>>>>>
51032>>>>>>>>>    //AB-DDOStart
51032>>>>>>>>>
51032>>>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
51034>>>>>>>>>    End_Object    // Btypkin_DD
51035>>>>>>>>>
51035>>>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
51037>>>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
51038>>>>>>>>>
51038>>>>>>>>>        //AB-StoreStart
51038>>>>>>>>>                                                
51038>>>>>>>>>        Begin_Constraints
51040>>>>>>>>>            Integer iTypkinCode iWhat isOpen
51041>>>>>>>>>            String  sClientID sClientEpon
51041>>>>>>>>>            Date    dHmnia
51041>>>>>>>>>        
51041>>>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
51042>>>>>>>>>            Get FragmaClientID      to sClientID
51043>>>>>>>>>            Get FragmaClientEpon    to sClientEpon
51044>>>>>>>>>            Get FragmaHmnia         to dHmnia
51045>>>>>>>>>            Get piIsOpen            to isOpen
51046>>>>>>>>>        
51046>>>>>>>>>            If (iTypkinCode<>'') Begin
51048>>>>>>>>>                If (sClientID<>'') Begin
51050>>>>>>>>>                    Set Ordering Of Barticl_DD to 8
51051>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
51051>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
51053>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
51055>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
51057>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
51059>>>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
51061>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
51065>>>>>>>>>                End
51065>>>>>>>>>>
51065>>>>>>>>>                Else Begin
51066>>>>>>>>>                    Set Ordering Of Barticl_DD to 11
51067>>>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
51067>>>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
51069>>>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
51071>>>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
51073>>>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
51075>>>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
51079>>>>>>>>>                End
51079>>>>>>>>>>
51079>>>>>>>>>            End
51079>>>>>>>>>>
51079>>>>>>>>>            Else If (dHmnia<>'') Begin
51082>>>>>>>>>                Set Ordering Of Barticl_DD to 9
51083>>>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
51083>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
51085>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
51087>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
51089>>>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
51091>>>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
51095>>>>>>>>>            End
51095>>>>>>>>>>
51095>>>>>>>>>            Else If (sClientID<>'') Begin
51098>>>>>>>>>                Set Ordering Of Barticl_DD to 8
51099>>>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
51099>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
51101>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
51103>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
51105>>>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
51107>>>>>>>>>            End
51107>>>>>>>>>>
51107>>>>>>>>>            Else Begin
51108>>>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
51110>>>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
51112>>>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
51114>>>>>>>>>            End
51114>>>>>>>>>>
51114>>>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
51118>>>>>>>>>        End_Constraints
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        
51121>>>>>>>>>        //AB-StoreEnd
51121>>>>>>>>>
51121>>>>>>>>>    End_Object    // Barticl_DD
51122>>>>>>>>>
51122>>>>>>>>>    Object Country_DD is a Country_DataDictionary
51124>>>>>>>>>    End_Object    // Country_DD
51125>>>>>>>>>
51125>>>>>>>>>    Object Towns_DD is a Towns_DataDictionary
51127>>>>>>>>>        Set DDO_Server to (Country_DD(self))
51128>>>>>>>>>    End_Object    // Towns_DD
51129>>>>>>>>>
51129>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
51131>>>>>>>>>        Set DDO_Server to (Towns_DD(self))
51132>>>>>>>>>    End_Object    // Cities_DD
51133>>>>>>>>>
51133>>>>>>>>>    Object Areas_DD is a Areas_DataDictionary
51135>>>>>>>>>    End_Object    // Areas_DD
51136>>>>>>>>>
51136>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
51138>>>>>>>>>    End_Object    // Payresp_DD
51139>>>>>>>>>
51139>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
51141>>>>>>>>>        Set DDO_Server to (Cities_DD(self))
51142>>>>>>>>>        Set DDO_Server to (Areas_DD(self))
51143>>>>>>>>>        Set DDO_Server to (Payresp_DD(self))
51144>>>>>>>>>    End_Object    // Clients_DD
51145>>>>>>>>>
51145>>>>>>>>>    Set Main_DD to (Barticl_DD(self))
51146>>>>>>>>>    Set Server to (Barticl_DD(self))
51147>>>>>>>>>
51147>>>>>>>>>    //AB-DDOEnd
51147>>>>>>>>>
51147>>>>>>>>>    Object oSelList is a dbListSub
51149>>>>>>>>>        Set Main_File to Barticl.File_Number
51150>>>>>>>>>        Set Size to 219 505
51151>>>>>>>>>        Set Location to 6 6
51152>>>>>>>>>
51152>>>>>>>>>        Begin_Row
51155>>>>>>>>>            Entry_Item Barticl.Barticl_no
51156>>>>>>>>>            Entry_Item Barticl.Arith_orist
51157>>>>>>>>>            Entry_Item Barticl.Barticl_hmnia
51158>>>>>>>>>            Entry_Item Btypkin.Btypkin_code
51159>>>>>>>>>            Entry_Item Btypkin.Btypkin_descr
51160>>>>>>>>>            Entry_Item Barticl.Barticl_code1
51161>>>>>>>>>            Entry_Item Barticl.Barticl_epon1
51162>>>>>>>>>            Entry_Item Barticl.Barticl_sv0
51163>>>>>>>>>            Entry_Item Barticl.Barticl_ekleise
51164>>>>>>>>>            Entry_Item Barticl.Isotimia
51165>>>>>>>>>        End_Row
51170>>>>>>>>>
51170>>>>>>>>>        Set Form_Width    item 0 to 47
51171>>>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
51172>>>>>>>>>        
51172>>>>>>>>>        Set Form_Width    item 1 to 47
51173>>>>>>>>>        Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
51174>>>>>>>>>        
51174>>>>>>>>>        Set Form_Width    item 2 to 48
51175>>>>>>>>>        Set Header_Label  item 2 to "†£œ¨/¤å˜"
51176>>>>>>>>>        
51176>>>>>>>>>        Set Form_Width    item 3 to 39
51177>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž"
51178>>>>>>>>>        
51178>>>>>>>>>        Set Form_Width    item 4 to 80
51179>>>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã"
51180>>>>>>>>>        
51180>>>>>>>>>        Set Form_Width    item 5 to 55
51181>>>>>>>>>        Set Header_Label  item 5 to "‘¬¤˜¢/¤¦ª"
51182>>>>>>>>>        
51182>>>>>>>>>        Set Form_Width    item 6 to 96
51183>>>>>>>>>        Set Header_Label  item 6 to "„§à¤¬£å˜"
51184>>>>>>>>>        
51184>>>>>>>>>        Set Form_Width    item 7 to 50
51185>>>>>>>>>        Set Header_Label  item 7 to "¦©æ"
51186>>>>>>>>>        
51186>>>>>>>>>        Set Form_Width    item 8 to 16
51187>>>>>>>>>        Set Header_Label  item 8 to "‰"
51188>>>>>>>>>        Set Column_Checkbox_State  item 8 to True
51189>>>>>>>>>        
51189>>>>>>>>>        Set Form_Width    item 9 to 22
51190>>>>>>>>>        Set Header_Label  item 9 to "„¡«."
51191>>>>>>>>>        Set Column_Checkbox_State  item 9 to True
51192>>>>>>>>>        
51192>>>>>>>>>
51192>>>>>>>>>        //AB-StoreStart
51192>>>>>>>>>        
51192>>>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
51192>>>>>>>>>        //Property String  StoreFragmaClientID    Public ''
51192>>>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
51192>>>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
51192>>>>>>>>>        
51192>>>>>>>>>        Procedure End_Construct_Object
51194>>>>>>>>>            Integer iDecimals
51195>>>>>>>>>            Forward Send End_Construct_Object
51197>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
51198>>>>>>>>>            Set Points Item 7 to iDecimals
51199>>>>>>>>>            Set Numeric_Mask Item 7 to 14 iDecimals ' ,*'
51200>>>>>>>>>        End_Procedure
51201>>>>>>>>>        
51201>>>>>>>>>        //Procedure Store_Defaults
51201>>>>>>>>>        //       Forward Send Store_Defaults
51201>>>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
51201>>>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
51201>>>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
51201>>>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
51201>>>>>>>>>        //End_Procedure
51201>>>>>>>>>        
51201>>>>>>>>>        //Procedure ReStore_Defaults
51201>>>>>>>>>        //       Forward Send ReStore_Defaults
51201>>>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
51201>>>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
51201>>>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
51201>>>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
51201>>>>>>>>>        //End_Procedure
51201>>>>>>>>>        
51201>>>>>>>>>        Procedure Activate
51203>>>>>>>>>            Send Keyaction to ButtonSub1
51204>>>>>>>>>            Forward Send Activate
51206>>>>>>>>>        End_procedure
51207>>>>>>>>>        
51207>>>>>>>>>        Procedure Activating
51209>>>>>>>>>            Forward Send Activating
51211>>>>>>>>>            Set Auto_Index_State to True
51212>>>>>>>>>        End_Procedure
51213>>>>>>>>>        
51213>>>>>>>>>        
51213>>>>>>>>>        //AB-StoreEnd
51213>>>>>>>>>
51213>>>>>>>>>    End_Object    // oSelList
51214>>>>>>>>>
51214>>>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
51216>>>>>>>>>        Entry_Item Btypkin.Btypkin_code
51217>>>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
51218>>>>>>>>>        Set Size to 13 49
51219>>>>>>>>>        Set Location to 229 84
51220>>>>>>>>>        Set Label_Col_Offset to 5
51221>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
51222>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51223>>>>>>>>>
51223>>>>>>>>>        //AB-StoreStart
51223>>>>>>>>>                                                                                                                        
51223>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
51224>>>>>>>>>        
51224>>>>>>>>>        Procedure Key Integer iKey
51226>>>>>>>>>            Integer iRetVal
51227>>>>>>>>>            Forward Send Key iKey
51229>>>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
51232>>>>>>>>>        End_Procedure
51233>>>>>>>>>        
51233>>>>>>>>>        
51233>>>>>>>>>        //AB-StoreEnd
51233>>>>>>>>>
51233>>>>>>>>>    End_Object    // Btypkin_Btypkin_Code
51234>>>>>>>>>
51234>>>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
51236>>>>>>>>>        Entry_Item Btypkin.Btypkin_descr
51237>>>>>>>>>        Set Size to 13 133
51238>>>>>>>>>        Set Location to 229 139
51239>>>>>>>>>        Set Color to clBtnFace
51240>>>>>>>>>        Set Label_Col_Offset to 2
51241>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
51242>>>>>>>>>        Set Enabled_State to FALSE
51243>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51244>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
51245>>>>>>>>>        Set Shadow_State Item 0 to TRUE
51246>>>>>>>>>
51246>>>>>>>>>        //AB-StoreStart
51246>>>>>>>>>        Set Server to (Btypkin_DD2(Self))
51247>>>>>>>>>        
51247>>>>>>>>>        //AB-StoreEnd
51247>>>>>>>>>
51247>>>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
51248>>>>>>>>>
51248>>>>>>>>>    Object Clients_Client_Name is a dbFormSub
51250>>>>>>>>>        Entry_Item Clients.Client_name
51251>>>>>>>>>        Set Server to (Clients_DD(self))
51252>>>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
51253>>>>>>>>>        Set Size to 13 188
51254>>>>>>>>>        Set Location to 244 84
51255>>>>>>>>>        Set Label_Col_Offset to 5
51256>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
51257>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51258>>>>>>>>>
51258>>>>>>>>>        //AB-StoreStart
51258>>>>>>>>>                                                                                                                        
51258>>>>>>>>>        Procedure Key Integer iKey
51260>>>>>>>>>            Integer iRetVal
51261>>>>>>>>>            Forward Send Key iKey
51263>>>>>>>>>            If (iKey=277) Send Clear to Clients_DD
51266>>>>>>>>>        End_Procedure
51267>>>>>>>>>        
51267>>>>>>>>>        //AB-StoreEnd
51267>>>>>>>>>
51267>>>>>>>>>    End_Object    // Clients_Client_Name
51268>>>>>>>>>
51268>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
51270>>>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
51271>>>>>>>>>        Set Size to 13 66
51272>>>>>>>>>        Set Location to 258 84
51273>>>>>>>>>        Set Label_Col_Offset to 5
51274>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
51275>>>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
51276>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51277>>>>>>>>>
51277>>>>>>>>>        //AB-StoreStart
51277>>>>>>>>>                                                                                                                        
51277>>>>>>>>>        On_Key KClear Send ClearMe
51278>>>>>>>>>        
51278>>>>>>>>>        Procedure ClearMe
51280>>>>>>>>>            Set Value Item 0 to ''
51281>>>>>>>>>        End_Procedure
51282>>>>>>>>>        
51282>>>>>>>>>        //AB-StoreEnd
51282>>>>>>>>>
51282>>>>>>>>>    End_Object    // cSyDateForm1
51283>>>>>>>>>
51283>>>>>>>>>    Object chkOpen is a CheckBoxSub
51285>>>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
51286>>>>>>>>>        Set Size to 10 62
51287>>>>>>>>>        Set Location to 260 156
51288>>>>>>>>>    End_Object    // chkOpen
51289>>>>>>>>>
51289>>>>>>>>>    Object ButtonSub1 is a ButtonSub
51291>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
51292>>>>>>>>>        Set Size to 13 52
51293>>>>>>>>>        Set Location to 258 219
51294>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51295>>>>>>>>>
51295>>>>>>>>>        //AB-StoreStart
51295>>>>>>>>>                                                        
51295>>>>>>>>>        Procedure OnClick
51297>>>>>>>>>            String  sEpon sID
51298>>>>>>>>>            Integer iTypkin isOpen
51298>>>>>>>>>            Date    dHmnia
51298>>>>>>>>>        
51298>>>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
51299>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
51300>>>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
51301>>>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
51302>>>>>>>>>        
51302>>>>>>>>>            Get Checked_State Of chkOpen to isOpen
51303>>>>>>>>>        
51303>>>>>>>>>            Set FragmaTypkinCode    to iTypkin
51304>>>>>>>>>            Set FragmaClientID      to sID
51305>>>>>>>>>            Set FragmaClientEpon    to sEpon
51306>>>>>>>>>            Set FragmaHmnia         to dHmnia
51307>>>>>>>>>            Set piIsOpen            to isOpen
51308>>>>>>>>>        
51308>>>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
51309>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
51310>>>>>>>>>        End_Procedure // OnClick
51311>>>>>>>>>        
51311>>>>>>>>>        
51311>>>>>>>>>        
51311>>>>>>>>>        //AB-StoreEnd
51311>>>>>>>>>
51311>>>>>>>>>    End_Object    // ButtonSub1
51312>>>>>>>>>
51312>>>>>>>>>    Object oOK_bn is a ButtonSub
51314>>>>>>>>>        Set Label to "&„§ ¢¦šã"
51315>>>>>>>>>        Set Size to 13 50
51316>>>>>>>>>        Set Location to 258 406
51317>>>>>>>>>        Set Focus_Mode to Pointer_Only
51318>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51319>>>>>>>>>
51319>>>>>>>>>        //AB-StoreStart
51319>>>>>>>>>        Procedure OnClick
51321>>>>>>>>>            Send OK To (oSelList(current_object))
51322>>>>>>>>>        End_Procedure
51323>>>>>>>>>        //AB-StoreEnd
51323>>>>>>>>>
51323>>>>>>>>>    End_Object    // oOK_bn
51324>>>>>>>>>
51324>>>>>>>>>    Object oCancel_bn is a ButtonSub
51326>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
51327>>>>>>>>>        Set Size to 13 50
51328>>>>>>>>>        Set Location to 258 461
51329>>>>>>>>>        Set Focus_Mode to Pointer_Only
51330>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
51331>>>>>>>>>
51331>>>>>>>>>        //AB-StoreStart
51331>>>>>>>>>        Procedure OnClick
51333>>>>>>>>>            Send Cancel To (oSelList(current_object))
51334>>>>>>>>>        End_Procedure
51335>>>>>>>>>        //AB-StoreEnd
51335>>>>>>>>>
51335>>>>>>>>>    End_Object    // oCancel_bn
51336>>>>>>>>>
51336>>>>>>>>>
51336>>>>>>>>>    //AB-StoreStart
51336>>>>>>>>>                    
51336>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
51337>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
51338>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
51339>>>>>>>>>    
51339>>>>>>>>>    Set Modal_State to True
51340>>>>>>>>>    
51340>>>>>>>>>    Procedure Activate
51342>>>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
51344>>>>>>>>>            Send Clear to Btypkin_DD2
51345>>>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
51346>>>>>>>>>            Send Find to Btypkin_DD2 Eq 1
51347>>>>>>>>>        End
51347>>>>>>>>>>
51347>>>>>>>>>        Else Send Clear to Btypkin_DD2
51349>>>>>>>>>        If (FragmaClientID(Self)<>'') Begin
51351>>>>>>>>>            Send Clear to Clients_DD
51352>>>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
51353>>>>>>>>>            Send Find to Clients_DD Eq 6
51354>>>>>>>>>        End
51354>>>>>>>>>>
51354>>>>>>>>>        Else Send Clear to Clients_DD
51356>>>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
51359>>>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
51361>>>>>>>>>        Forward Send Activate
51363>>>>>>>>>    End_Procedure
51364>>>>>>>>>    
51364>>>>>>>>>    //AB-StoreEnd
51364>>>>>>>>>
51364>>>>>>>>>End_Object    // Barticl
51365>>>>>>>>>
51365>>>>>>>>>//AB/ End_Object    // prj
51365>>>>>>>Use sl041.SL         // sl041
51365>>>>>>>
51365>>>>>>>//DDB-Selection-pkg-End
51365>>>>>>>//DDB-FileEnd
51365>>>>>    Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
51365>>>>>>>//DDB-FileStart
51365>>>>>>>//DDB-HeaderStart
51365>>>>>>>
51365>>>>>>>// File Name : BAXIO.DD
51365>>>>>>>// Class Name: Baxio_DataDictionary
51365>>>>>>>// Revision  : 112
51365>>>>>>>// Version   : 2
51365>>>>>>>
51365>>>>>>>Use  Windows           // Basic Definitions
51365>>>>>>>Use  DataDict          // DataDictionary Class Definition
51365>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51365>>>>>>>
51365>>>>>>>Open Baxio
51367>>>>>>>Open Bmove
51369>>>>>>>Open Baxiokat
51371>>>>>>>Open Sysrecb
51373>>>>>>>
51373>>>>>>>//DDB-HeaderEnd
51373>>>>>>>//DDB-ValidationStart
51373>>>>>>>
51373>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
51373>>>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
51373>>>>>>>
51373>>>>>>>Register_Object Baxio_Status_VT
51373>>>>>>>Register_Object Baxio_Baxio_Place_VT
51373>>>>>>>Register_Object Bfile_VT
51373>>>>>>>Register_Object Baxio_Baxio_Bank_VT
51373>>>>>>>Register_Object Baxio_Baxio_Banka_VT
51373>>>>>>>Register_Object Baxio_Baxio_From_VT
51373>>>>>>>Register_Object Baxio_Baxio_Topos_VT1
51373>>>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
51373>>>>>>>
51373>>>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
51375>>>>>>>    Set Type_Value        To "BAXIOPLACE"
51376>>>>>>>    //DDB-ValidationCustomStart
51376>>>>>>>    //DDB-ValidationCustomEnd
51376>>>>>>>End_Object   // Baxio_Baxio_Place_VT
51377>>>>>>>
51377>>>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
51379>>>>>>>    Set Type_Value        To "BANK"
51380>>>>>>>    Set Allow_Blank_State To TRUE
51381>>>>>>>    //DDB-ValidationCustomStart
51381>>>>>>>    //DDB-ValidationCustomEnd
51381>>>>>>>End_Object   // Baxio_Baxio_Bank_VT
51382>>>>>>>
51382>>>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
51384>>>>>>>    Set Type_Value        To "BANK"
51385>>>>>>>    Set Allow_Blank_State To TRUE
51386>>>>>>>    //DDB-ValidationCustomStart
51386>>>>>>>    //DDB-ValidationCustomEnd
51386>>>>>>>End_Object   // Baxio_Baxio_Banka_VT
51387>>>>>>>
51387>>>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
51389>>>>>>>    Set Allow_Blank_State To TRUE
51390>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
51391>>>>>>>
51391>>>>>>>    Procedure Fill_List
51393>>>>>>>        Forward Send Fill_List
51395>>>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
51396>>>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
51397>>>>>>>    End_Procedure    // Fill_List
51398>>>>>>>    //DDB-ValidationCustomStart
51398>>>>>>>    //DDB-ValidationCustomEnd
51398>>>>>>>End_Object   // Baxio_Baxio_From_VT
51399>>>>>>>
51399>>>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
51401>>>>>>>    Set Allow_Blank_State To TRUE
51402>>>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
51403>>>>>>>
51403>>>>>>>    Procedure Fill_List
51405>>>>>>>        Forward Send Fill_List
51407>>>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
51408>>>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
51409>>>>>>>    End_Procedure    // Fill_List
51410>>>>>>>    //DDB-ValidationCustomStart
51410>>>>>>>    //DDB-ValidationCustomEnd
51410>>>>>>>End_Object   // Baxio_Baxio_Topos_VT1
51411>>>>>>>//DDB-ValidationEnd
51411>>>>>>>//DDB-SelectionStart
51411>>>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
51411>>>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
51411>>>>>>>Register_Object SL037
51411>>>>>>>Register_Object slNomism
51411>>>>>>>//DDB-SelectionEnd
51411>>>>>>>
51411>>>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
51412>>>>>>>
51412>>>>>>>      Procedure Construct_Object
51413>>>>>>>                Forward Send Construct_Object
51415>>>>>>>
51415>>>>>>>                //btypkin related properties:
51415>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
51415>>>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
51415>>>>>>>                Property Integer piBtypkin_Flag03 0
51416>>>>>>>                Property Integer piBtypkin_Flag04 0
51417>>>>>>>                Property Integer pifromxrhsh      0
51418>>>>>>>
51418>>>>>>>                //baxio related properties:
51418>>>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
51418>>>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
51418>>>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
51418>>>>>>>                Property Integer piCreated_Baxio  0
51419>>>>>>>
51419>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
51419>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
51419>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
51419>>>>>>>                Property Number  pnB_Baxio_V2      0
51420>>>>>>>                Property Number  pnB_Baxio_V0      0
51421>>>>>>>                Property Number  pnB_Baxio_V00     0
51422>>>>>>>                Property Number  pnB_Baxio_Vr      0
51423>>>>>>>                Property String  psB_Baxio_C_Code2 ""
51424>>>>>>>                Property Integer piB_Baxio_Status  0
51425>>>>>>>                Property Integer piB_Baxio_Place   0
51426>>>>>>>
51426>>>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
51426>>>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
51426>>>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
51426>>>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
51426>>>>>>>                Property Integer piB_Baxiokat_Code 0
51427>>>>>>>                Property Integer piB_Year_Year     0
51428>>>>>>>                Property Integer piMustNOTConstrain Public 0
51429>>>>>>>      End_Procedure //construct_object
51430>>>>>>>
51430>>>>>>>
51430>>>>>>>
51430>>>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
51430>>>>>>>//                            Number anPoso           ;
51430>>>>>>>//                            String asNomismaCodeSe  ;
51430>>>>>>>//                            Date   adHmnia          ;
51430>>>>>>>//                            Number nIsotimia  Returns Number
51430>>>>>>>
51430>>>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
51430>>>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
51430>>>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
51430>>>>>>>
51430>>>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
51430>>>>>>>
51430>>>>>>>//        Clear Nomisma
51430>>>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
51430>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
51430>>>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
51430>>>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
51430>>>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
51430>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
51430>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
51430>>>>>>>
51430>>>>>>>//        Clear Nomisma
51430>>>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
51430>>>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
51430>>>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
51430>>>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
51430>>>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
51430>>>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
51430>>>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
51430>>>>>>>
51430>>>>>>>//        //05a. ??ÿ??? ? --> ??? 
51430>>>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
51430>>>>>>>//        Move (Round_Number(rVal,6)) to rVal
51430>>>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
51430>>>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
51430>>>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
51430>>>>>>>//        Function_Return rVal
51430>>>>>>>//    End_Function
51430>>>>>>>
51430>>>>>>>
51430>>>>>>>
51430>>>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
51430>>>>>>>      Function Default_Axio_C_Code2 Returns String
51431>>>>>>>               String lsBaxio_C_Code_2
51432>>>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
51432>>>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
51433>>>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
51434>>>>>>>      End_Function //default_axio_c_code2
51435>>>>>>>
51435>>>>>>>
51435>>>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
51435>>>>>>>      Procedure Convert_Axio_Values
51436>>>>>>>
51436>>>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
51437>>>>>>>
51437>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
51438>>>>>>>
51438>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
51439>>>>>>>
51439>>>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
51440>>>>>>>
51440>>>>>>>
51440>>>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
51440>>>>>>>//                                     Baxio.Baxio_V2,        ;
51440>>>>>>>//                                     SyscurXr.C_Code0,      ;
51440>>>>>>>//                                     Baxio.Baxio_HmniaE,    ;
51440>>>>>>>//                                     Baxio.Baxio_Rate0)     ;
51440>>>>>>>//                                    ) to Baxio.Baxio_V0
51440>>>>>>>//                If (liBtypkin_Flag03 = TRUE);
51440>>>>>>>//                     Begin
51440>>>>>>>//                      //˜¥å˜ 2-->00
51440>>>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
51440>>>>>>>//                                            Baxio.Baxio_V2,      ;
51440>>>>>>>//                                            SyscurXr.C_Code00,   ;
51440>>>>>>>//                                            Baxio.Baxio_HmniaE,  ;
51440>>>>>>>//                                            Baxio.Baxio_Rate00)  ;
51440>>>>>>>//                                          ) to Baxio.Baxio_V00
51440>>>>>>>//                     End
51440>>>>>>>//                Else Begin
51440>>>>>>>//                      Move 0            to Baxio.Baxio_V00
51440>>>>>>>//                     End
51440>>>>>>>//                If (liBtypkin_Flag04 = TRUE);
51440>>>>>>>//                     Begin
51440>>>>>>>//                      //˜¥å˜ 2-->r
51440>>>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
51440>>>>>>>//                                       Baxio.Baxio_V2,      ;
51440>>>>>>>//                                       SyscurXr.C_CodeR,    ;
51440>>>>>>>//                                       Baxio.Baxio_HmniaE,  ;
51440>>>>>>>//                                       Baxio.Baxio_RateR)   ;
51440>>>>>>>//                                      ) to Baxio.Baxio_VR
51440>>>>>>>//                     End
51440>>>>>>>//                Else Begin
51440>>>>>>>//                      Move 0            to Baxio.Baxio_VR
51440>>>>>>>//                     End
51440>>>>>>>      End_Procedure
51441>>>>>>>
51441>>>>>>>
51441>>>>>>>
51441>>>>>>>      Procedure Constrain
51442>>>>>>>                Forward Send Constrain
51444>>>>>>>                If (piMustNOTConstrain(Self)=1) Begin
51446>>>>>>>                End 
51446>>>>>>>>
51446>>>>>>>                else If (piMustNOTConstrain(Self)=2) Begin 
51449>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
51451>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
51453>>>>>>>                end    
51453>>>>>>>>
51453>>>>>>>                Else Begin
51454>>>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
51456>>>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
51458>>>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
51460>>>>>>>                End
51460>>>>>>>>
51460>>>>>>>      End_Procedure   //constrain
51461>>>>>>>
51461>>>>>>>
51461>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
51461>>>>>>>      //™) ˜¤áš¤à©ž properties
51461>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
51461>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
51461>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
51461>>>>>>>      Procedure Update
51462>>>>>>>                Forward Send Update
51464>>>>>>>                
51464>>>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
51467>>>>>>>                
51467>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
51467>>>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
51468>>>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
51469>>>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
51470>>>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
51471>>>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
51472>>>>>>>
51472>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
51472>>>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
51472>>>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
51474>>>>>>>                     Move "" to Baxio.Baxio_Code_In
51475>>>>>>>                     Move "" to Baxio.Baxio_Epon_In
51476>>>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
51477>>>>>>>                End
51477>>>>>>>>
51477>>>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
51477>>>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
51478>>>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
51479>>>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
51480>>>>>>>
51480>>>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
51480>>>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
51482>>>>>>>                     Move (-1) to Baxio.Baxio_File_Out
51483>>>>>>>                     Move ""   to Baxio.Baxio_Code_Out
51484>>>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
51485>>>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
51486>>>>>>>
51486>>>>>>>                     Move (-1) to Baxio.Baxio_Lfile
51487>>>>>>>                     Move ""   to Baxio.Baxio_Lepon
51488>>>>>>>                     Move ""   to Baxio.Baxio_Lpar
51489>>>>>>>                End
51489>>>>>>>>
51489>>>>>>>      End_Procedure //update
51490>>>>>>>
51490>>>>>>>
51490>>>>>>>      Procedure Backout
51491>>>>>>>                Forward Send Backout
51493>>>>>>>
51493>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
51493>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
51494>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
51495>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
51496>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
51497>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
51498>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
51499>>>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
51500>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
51501>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
51502>>>>>>>      End_Procedure //backout
51503>>>>>>>
51503>>>>>>>
51503>>>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
51504>>>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
51506>>>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
51506>>>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
51507>>>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
51508>>>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
51509>>>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
51510>>>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
51511>>>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
51512>>>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
51513>>>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
51514>>>>>>>      End_Procedure //new_current_record
51515>>>>>>>
51515>>>>>>>
51515>>>>>>>      Procedure Creating
51516>>>>>>>                Forward Send Creating
51518>>>>>>>
51518>>>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
51518>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
51518>>>>>>>
51518>>>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
51518>>>>>>>                Add 1 to Baxiokat.Baxio_Lcode
51519>>>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
51520>>>>>>>
51520>>>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
51520>>>>>>>                //£â©à «žª update ©«¦ bmove
51520>>>>>>>                Set piCreated_Baxio to TRUE
51521>>>>>>>
51521>>>>>>>//
51521>>>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
51521>>>>>>>
51521>>>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
51522>>>>>>>
51522>>>>>>>      End_Procedure //creating
51523>>>>>>>
51523>>>>>>>
51523>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
51524>>>>>>>                String lsError_Message
51525>>>>>>>                Case Begin
51525>>>>>>>                     //˜§æ validate save
51525>>>>>>>                     Case (iError_Num = 1001)
51527>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
51528>>>>>>>                     Case Break
51529>>>>>>>                     Case (iError_Num = 1002)
51532>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
51533>>>>>>>                     Case Break
51534>>>>>>>                     Case (iError_Num = 1003)
51537>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
51538>>>>>>>                     Case Break
51539>>>>>>>                     Case (iError_Num = 1004)
51542>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
51543>>>>>>>                     Case Break
51544>>>>>>>                     Case (iError_Num = 1005)
51547>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
51548>>>>>>>                     Case Break
51549>>>>>>>                     Case (iError_Num = 1006)
51552>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
51553>>>>>>>                     Case Break
51554>>>>>>>
51554>>>>>>>                     Case (iError_Num = 1007)
51557>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51558>>>>>>>                     Case Break
51559>>>>>>>                     Case (iError_Num = 1008)
51562>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51563>>>>>>>                     Case Break
51564>>>>>>>                     Case (iError_Num = 1009)
51567>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51568>>>>>>>                     Case Break
51569>>>>>>>                     Case (iError_Num = 1010)
51572>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51573>>>>>>>                     Case Break
51574>>>>>>>                     Case (iError_Num = 1011)
51577>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51578>>>>>>>                     Case Break
51579>>>>>>>                     Case (iError_Num = 1012)
51582>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51583>>>>>>>                     Case Break
51584>>>>>>>                     Case (iError_Num = 1013)
51587>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
51588>>>>>>>                     Case Break
51589>>>>>>>
51589>>>>>>>                     Case (iError_Num = 1014)
51592>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
51593>>>>>>>                     Case Break
51594>>>>>>>                     Case (iError_Num = 1015)
51597>>>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
51598>>>>>>>                     Case Break
51599>>>>>>>                     Case (iError_Num = 1100)
51602>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
51603>>>>>>>                          Case Break
51604>>>>>>>
51604>>>>>>>                     //˜§æ validate delete
51604>>>>>>>                     Case (iError_Num = 2007)
51607>>>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
51608>>>>>>>                     Case Break
51609>>>>>>>                     Case (iError_Num = 2100)
51612>>>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
51613>>>>>>>                          Case Break
51614>>>>>>>
51614>>>>>>>                     Case Else
51614>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
51616>>>>>>>                Case End
51616>>>>>>>
51616>>>>>>>                Error iError_Num lsError_Message
51617>>>>>>>>
51617>>>>>>>      End_Procedure // operation_not_allowed
51618>>>>>>>
51618>>>>>>>      //1001:baxio_hmnial > 0
51618>>>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
51618>>>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
51618>>>>>>>
51618>>>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
51618>>>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
51618>>>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
51618>>>>>>>
51618>>>>>>>
51618>>>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
51618>>>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
51618>>>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
51618>>>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
51618>>>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
51618>>>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
51618>>>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
51618>>>>>>>
51618>>>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
51618>>>>>>>
51618>>>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
51618>>>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
51618>>>>>>>      Function Validate_Save Returns Integer
51619>>>>>>>               Integer iReturnVal
51620>>>>>>>
51620>>>>>>>               Forward Get Validate_Save to iReturnVal
51622>>>>>>>
51622>>>>>>>               If (Not(iReturnVal));               Begin
51624>>>>>>>
51624>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
51624>>>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
51624>>>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
51626>>>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
51626>>>>>>>
51626>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
51628>>>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
51631>>>>>>>                      End
51631>>>>>>>>
51631>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
51631>>>>>>>>
51631>>>>>>>
51631>>>>>>>
51631>>>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
51631>>>>>>>                Else;                Begin //edit an existing record
51632>>>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
51632>>>>>>>
51632>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
51634>>>>>>>
51634>>>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
51637>>>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
51637>>>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
51640>>>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
51640>>>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
51643>>>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
51643>>>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
51646>>>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
51646>>>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
51649>>>>>>>
51649>>>>>>>                      End
51649>>>>>>>>
51649>>>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
51649>>>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
51649>>>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
51649>>>>>>>                        // anoigokleisei
51649>>>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
51649>>>>>>>//                      If (;
51649>>>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
51649>>>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
51649>>>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
51649>>>>>>>
51649>>>>>>>                      If (pifromxrhsh(Self)=0) Begin
51651>>>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
51651>>>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
51654>>>>>>>
51654>>>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
51654>>>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
51657>>>>>>>                      End
51657>>>>>>>>
51657>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
51657>>>>>>>>
51657>>>>>>>
51657>>>>>>>                //¢¦§¦å â¢œš®¦ 
51657>>>>>>>                //1001:baxio_hmnial > 0
51657>>>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
51660>>>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
51660>>>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
51663>>>>>>>                //1003:baxio_c_code2 <> ""
51663>>>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
51666>>>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
51666>>>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
51666>>>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
51666>>>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
51666>>>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
51666>>>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
51666>>>>>>>                //1100:cby = globals
51666>>>>>>>
51666>>>>>>>                If (pifromxrhsh(Self)=0) Begin
51668>>>>>>>
51668>>>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
51671>>>>>>>
51671>>>>>>>               End
51671>>>>>>>>
51671>>>>>>>
51671>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
51671>>>>>>>>
51671>>>>>>>               Function_Return iReturnVal
51672>>>>>>>      End_Function //validate_save
51673>>>>>>>
51673>>>>>>>
51673>>>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
51673>>>>>>>      Function Validate_Delete  Returns Integer
51674>>>>>>>               Integer iReturnVal
51675>>>>>>>               Forward Get Validate_Delete  To iReturnVal
51677>>>>>>>               If (Not(iReturnVal));               Begin
51679>>>>>>>
51679>>>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
51679>>>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
51682>>>>>>>
51682>>>>>>>                  //2100:cby = globals
51682>>>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
51685>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
51685>>>>>>>>
51685>>>>>>>               Function_Return iReturnVal
51686>>>>>>>      End_Function //validate_delete
51687>>>>>>>
51687>>>>>>>
51687>>>>>>>//------------------------------------------------------------------
51687>>>>>>>    Procedure Define_Fields
51688>>>>>>>        Forward Send Define_Fields
51690>>>>>>>        //DDB-Generated-Code-Location
51690>>>>>>>        //DDB-DefineFieldStart
51690>>>>>>>
51690>>>>>>>        Set Main_File            To Baxio.File_Number
51691>>>>>>>        Set Cascade_Delete_State To FALSE
51692>>>>>>>
51692>>>>>>>
51692>>>>>>>        // Child (Client) file structure................
51692>>>>>>>        Send Add_Client_File  Bmove.File_Number
51693>>>>>>>
51693>>>>>>>        // Parent (Server) file structure...............
51693>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
51694>>>>>>>
51694>>>>>>>        // External (System) file structure.............
51694>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
51695>>>>>>>
51695>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
51698>>>>>>>
51698>>>>>>>        // Field-based properties.......................
51698>>>>>>>
51698>>>>>>>        // Baxio.Company_Code
51698>>>>>>>
51698>>>>>>>        // Baxio.Branch_Code
51698>>>>>>>
51698>>>>>>>        // Baxio.Year_Year
51698>>>>>>>
51698>>>>>>>        // Baxio.Baxiokat_Code
51698>>>>>>>
51698>>>>>>>        // Baxio.Baxio_Code
51698>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
51699>>>>>>>
51699>>>>>>>        // Baxio.Baxio_Rec0
51699>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
51700>>>>>>>
51700>>>>>>>        // Baxio.Year_Recr
51700>>>>>>>
51700>>>>>>>        // Baxio.Baxiokat_Recr
51700>>>>>>>
51700>>>>>>>        // Baxio.Baxio_Recr
51700>>>>>>>
51700>>>>>>>        // Baxio.Baxio_Status
51700>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
51701>>>>>>>
51701>>>>>>>        // Baxio.Baxio_Place
51701>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
51702>>>>>>>
51702>>>>>>>        // Baxio.Baxio_File_In
51702>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
51703>>>>>>>
51703>>>>>>>        // Baxio.Baxio_Code_In
51703>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
51703>>>>>>>
51703>>>>>>>        // Baxio.Baxio_Epon_In
51703>>>>>>>
51703>>>>>>>        // Baxio.Baxio_Fpar_In
51703>>>>>>>
51703>>>>>>>        // Baxio.Baxio_File_Out
51703>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
51704>>>>>>>
51704>>>>>>>        // Baxio.Baxio_Code_Out
51704>>>>>>>
51704>>>>>>>        // Baxio.Baxio_Epon_Out
51704>>>>>>>
51704>>>>>>>        // Baxio.Baxio_Fpar_Out
51704>>>>>>>
51704>>>>>>>        // Baxio.Baxio_Lfile
51704>>>>>>>
51704>>>>>>>        // Baxio.Baxio_Lcode
51704>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
51705>>>>>>>
51705>>>>>>>        // Baxio.Baxio_Lepon
51705>>>>>>>
51705>>>>>>>        // Baxio.Baxio_Lpar
51705>>>>>>>
51705>>>>>>>        // Baxio.Baxio_Bank00000
51705>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
51706>>>>>>>
51706>>>>>>>        // Baxio.Baxio_Hmniae
51706>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
51707>>>>>>>
51707>>>>>>>        // Baxio.Baxio_Hmniap000
51707>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
51708>>>>>>>
51708>>>>>>>        // Baxio.Baxio_Hmnial
51708>>>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
51708>>>>>>>
51708>>>>>>>        // Baxio.Baxio_Ekdoths
51708>>>>>>>
51708>>>>>>>        // Baxio.Baxio_Ekdothse
51708>>>>>>>
51708>>>>>>>        // Baxio.Baxio_Sediatagh
51708>>>>>>>
51708>>>>>>>        // Baxio.Baxio_Sdiataghe
51708>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
51709>>>>>>>
51709>>>>>>>        // Baxio.Baxio_Banka
51709>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_Opistho
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_No
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_V2
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_V0
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_V00
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_Vr
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_Rate0
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_Rate00
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_Rater
51710>>>>>>>
51710>>>>>>>        // Baxio.Baxio_C_Code2
51710>>>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
51711>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
51712>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
51713>>>>>>>
51713>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
51713>>>>>>>
51713>>>>>>>        // Baxio.Baxio_Lixi_Mm
51713>>>>>>>
51713>>>>>>>        // Baxio.Baxio_Lixi_Dd
51713>>>>>>>
51713>>>>>>>        // Baxio.Baxio_Bmove_Laa
51713>>>>>>>
51713>>>>>>>        // Baxio.Baxio_Desm
51713>>>>>>>
51713>>>>>>>        // Baxio.Baxio_From
51713>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
51714>>>>>>>
51714>>>>>>>        // Baxio.Baxio_Topos
51714>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
51715>>>>>>>
51715>>>>>>>        //DDB-DefineFieldEnd
51715>>>>>>>
51715>>>>>>>        Set Main_File            To Baxio.File_Number
51716>>>>>>>        Set Cascade_Delete_State To FALSE
51717>>>>>>>
51717>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
51718>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
51719>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51720>>>>>>>
51720>>>>>>>        // Child (Client) file structure................
51720>>>>>>>        Send Add_Client_File  Bmove.File_Number
51721>>>>>>>
51721>>>>>>>        // Parent (Server) file structure...............
51721>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
51722>>>>>>>
51722>>>>>>>        // External (System) file structure.............
51722>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
51723>>>>>>>
51723>>>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
51726>>>>>>>
51726>>>>>>>        // Field-based properties.......................
51726>>>>>>>
51726>>>>>>>        // Baxio.Company_Code
51726>>>>>>>
51726>>>>>>>        // Baxio.Branch_Code
51726>>>>>>>
51726>>>>>>>        // Baxio.Year_Year
51726>>>>>>>
51726>>>>>>>        // Baxio.Baxiokat_Code
51726>>>>>>>
51726>>>>>>>        // Baxio.Baxio_Code
51726>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
51727>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
51728>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
51729>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
51730>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
51731>>>>>>>
51731>>>>>>>        // Baxio.Baxio_Rec0
51731>>>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
51732>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
51733>>>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
51734>>>>>>>
51734>>>>>>>        // Baxio.Year_Rec0
51734>>>>>>>
51734>>>>>>>        // Baxio.Baxiokat_Rec0
51734>>>>>>>
51734>>>>>>>        // Baxio.Baxio_Status
51734>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
51735>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
51736>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
51737>>>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
51738>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
51739>>>>>>>
51739>>>>>>>        // Baxio.Baxio_Place
51739>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
51740>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
51741>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
51742>>>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
51743>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
51744>>>>>>>
51744>>>>>>>        // Baxio.Baxio_File_In
51744>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
51745>>>>>>>
51745>>>>>>>        // Baxio.Baxio_Code_In
51745>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
51746>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
51747>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
51748>>>>>>>
51748>>>>>>>        // Baxio.Baxio_Epon_In
51748>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
51749>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
51750>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
51751>>>>>>>
51751>>>>>>>        // Baxio.Baxio_Fpar_In
51751>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
51752>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
51753>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
51754>>>>>>>
51754>>>>>>>        // Baxio.Baxio_File_Out
51754>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
51755>>>>>>>
51755>>>>>>>        // Baxio.Baxio_Code_Out
51755>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
51756>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
51757>>>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
51758>>>>>>>
51758>>>>>>>        // Baxio.Baxio_Epon_Out
51758>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
51759>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
51760>>>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
51761>>>>>>>
51761>>>>>>>        // Baxio.Baxio_Fpar_Out
51761>>>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
51762>>>>>>>
51762>>>>>>>        // Baxio.Baxio_Lfile
51762>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
51763>>>>>>>
51763>>>>>>>        // Baxio.Baxio_Lcode
51763>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
51764>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
51765>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
51766>>>>>>>
51766>>>>>>>        // Baxio.Baxio_Lepon
51766>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
51767>>>>>>>
51767>>>>>>>        // Baxio.Baxio_Lpar
51767>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
51768>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
51769>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
51770>>>>>>>
51770>>>>>>>        // Baxio.Baxio_Bank00000
51770>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
51771>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
51772>>>>>>>
51772>>>>>>>        // Baxio.Baxio_Hmniae
51772>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
51773>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
51774>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
51775>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
51776>>>>>>>
51776>>>>>>>        // Baxio.Baxio_Hmniap000
51776>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
51777>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
51778>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
51779>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
51780>>>>>>>
51780>>>>>>>        // Baxio.Baxio_Hmnial
51780>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
51781>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
51782>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
51783>>>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
51784>>>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
51785>>>>>>>
51785>>>>>>>        // Baxio.Baxio_Ekdoths
51785>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
51786>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
51787>>>>>>>
51787>>>>>>>        // Baxio.Baxio_Ekdothse
51787>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
51788>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
51789>>>>>>>
51789>>>>>>>        // Baxio.Baxio_Sediatagh
51789>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
51790>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
51791>>>>>>>
51791>>>>>>>        // Baxio.Baxio_Sdiataghe
51791>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
51792>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
51793>>>>>>>
51793>>>>>>>        // Baxio.Baxio_Banka
51793>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
51794>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
51795>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
51796>>>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
51797>>>>>>>
51797>>>>>>>        // Baxio.Baxio_Opistho
51797>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
51798>>>>>>>
51798>>>>>>>        // Baxio.Baxio_No
51798>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
51799>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
51800>>>>>>>
51800>>>>>>>        // Baxio.Baxio_V2
51800>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
51801>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
51802>>>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
51803>>>>>>>
51803>>>>>>>        // Baxio.Baxio_V0
51803>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
51804>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
51805>>>>>>>
51805>>>>>>>        // Baxio.Baxio_V00
51805>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
51806>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
51807>>>>>>>
51807>>>>>>>        // Baxio.Baxio_Vr
51807>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
51808>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
51809>>>>>>>
51809>>>>>>>        // Baxio.Baxio_Rate0
51809>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
51810>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
51811>>>>>>>
51811>>>>>>>        // Baxio.Baxio_Rate00
51811>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
51812>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
51813>>>>>>>
51813>>>>>>>        // Baxio.Baxio_Rater
51813>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
51814>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
51815>>>>>>>
51815>>>>>>>        // Baxio.Baxio_C_Code2
51815>>>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
51816>>>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
51817>>>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
51818>>>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
51819>>>>>>>
51819>>>>>>>        // Baxio.Baxio_Lixi_Yyyy
51819>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
51820>>>>>>>
51820>>>>>>>        // Baxio.Baxio_Lixi_Mm
51820>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
51821>>>>>>>
51821>>>>>>>        // Baxio.Baxio_Lixi_Dd
51821>>>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
51822>>>>>>>
51822>>>>>>>        // Baxio.Baxio_Bmove_Laa
51822>>>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
51823>>>>>>>
51823>>>>>>>    End_Procedure    // Define_Fields
51824>>>>>>>
51824>>>>>>>
51824>>>>>>>    Procedure Field_Defaults
51825>>>>>>>        Forward Send Field_Defaults
51827>>>>>>>        //DDB-Generated-Code-Location
51827>>>>>>>        //DDB-FieldDefaultStart
51827>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
51828>>>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
51829>>>>>>>        //DDB-FieldDefaultEnd
51829>>>>>>>    End_Procedure    // Field_Defaults
51830>>>>>>>
51830>>>>>>>End_Class    // Baxio_DataDictionary
51831>>>>>>>//DDB-Selection-pkg-Start
51831>>>>>>>
51831>>>>>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
51831>>>>>>>>>//AB/ Project SL037:BAXIO
51831>>>>>>>>>//AB/ Object prj is a Lookup_Project
51831>>>>>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
51831>>>>>>>>>//AB/     Set ProjectFileName to "SL037.SL"
51831>>>>>>>>>
51831>>>>>>>>>// Project Object Structure
51831>>>>>>>>>//   SL037 is a dbModalPanelSub
51831>>>>>>>>>//     Baxiokat_DD is a DataDictionary
51831>>>>>>>>>//     Baxio_DD is a DataDictionary
51831>>>>>>>>>//     oSelList is a dbListSub
51831>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51831>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
51831>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51831>>>>>>>>>//     cSyDateForm2 is a cSyDateForm
51831>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
51831>>>>>>>>>//     TextBoxSub5 is a TextBoxSub
51831>>>>>>>>>//     FormSub1 is a FormSub
51831>>>>>>>>>//     FormSub2 is a FormSub
51831>>>>>>>>>//     FormSub3 is a FormSub
51831>>>>>>>>>//     FormSub4 is a FormSub
51831>>>>>>>>>//     ButtonSub1 is a ButtonSub
51831>>>>>>>>>//     oOK_bn is a ButtonSub
51831>>>>>>>>>
51831>>>>>>>>>// Register all objects
51831>>>>>>>>>Register_Object Baxio_DD
51831>>>>>>>>>Register_Object Baxiokat_DD
51831>>>>>>>>>Register_Object ButtonSub1
51831>>>>>>>>>Register_Object cSyDateForm1
51831>>>>>>>>>Register_Object cSyDateForm2
51831>>>>>>>>>Register_Object FormSub1
51831>>>>>>>>>Register_Object FormSub2
51831>>>>>>>>>Register_Object FormSub3
51831>>>>>>>>>Register_Object FormSub4
51831>>>>>>>>>Register_Object oOK_bn
51831>>>>>>>>>Register_Object oSelList
51831>>>>>>>>>Register_Object SL037
51831>>>>>>>>>Register_Object TextBoxSub1
51831>>>>>>>>>Register_Object TextBoxSub2
51831>>>>>>>>>Register_Object TextBoxSub4
51831>>>>>>>>>Register_Object TextBoxSub5
51831>>>>>>>>>
51831>>>>>>>>>
51831>>>>>>>>>
51831>>>>>>>>>//AB-StoreTopStart
51831>>>>>>>>>    
51831>>>>>>>>>Use sl100.sl
51831>>>>>>>>>
51831>>>>>>>>>
51831>>>>>>>>>//AB-StoreTopEnd
51831>>>>>>>>>
51831>>>>>>>>>//AB-IgnoreStart
51831>>>>>>>>>
51831>>>>>>>>>Use DFAllEnt.pkg
51831>>>>>>>>>Use dbList.Sub
51831>>>>>>>>>Use Txtbox.Sub
51831>>>>>>>>>Use cSyDateForm.Pkg
51831>>>>>>>>>Use Form.Sub
51831>>>>>>>>>Use Button.Sub
51831>>>>>>>>>
51831>>>>>>>>>
51831>>>>>>>>>Use BAXIOKAT.DD
51831>>>>>>>>>Use BAXIO.DD
51831>>>>>>>>>
51831>>>>>>>>>//AB-IgnoreEnd
51831>>>>>>>>>
51831>>>>>>>>>Object SL037 is a dbModalPanelSub
51833>>>>>>>>>
51833>>>>>>>>>    //AB-StoreTopStart
51833>>>>>>>>>                        
51833>>>>>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
51835>>>>>>>>>    Property Integer piFragmaBaxiokatCode Public  0
51837>>>>>>>>>    Property Integer piFragmaBaxioStatus  Public  0
51839>>>>>>>>>    Property Integer piFragmaBaxioPlace   Public  0
51841>>>>>>>>>    Property string  psfragmaclient       Public ''
51843>>>>>>>>>    Property String  psFragmaBaxioStatus  Public ''
51845>>>>>>>>>    Property String  psEkdoths            Public ''
51847>>>>>>>>>    Property String  psApodekths          Public ''
51849>>>>>>>>>    Property Date pdApo                   Public ''
51851>>>>>>>>>    Property Date pdEos                   Public ''
51853>>>>>>>>>    
51853>>>>>>>>>    //AB-StoreTopEnd
51853>>>>>>>>>
51853>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
51854>>>>>>>>>    Set Size to 287 527
51855>>>>>>>>>    Set Location to 2 3
51856>>>>>>>>>    Set Exit_Application_Local_State to FALSE
51857>>>>>>>>>    Set Modal_State to FALSE
51858>>>>>>>>>
51858>>>>>>>>>    //AB-DDOStart
51858>>>>>>>>>
51858>>>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
51860>>>>>>>>>    End_Object    // Baxiokat_DD
51861>>>>>>>>>
51861>>>>>>>>>    Object Baxio_DD is a Baxio_DataDictionary
51863>>>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
51864>>>>>>>>>
51864>>>>>>>>>        //AB-StoreStart
51864>>>>>>>>>                                                    
51864>>>>>>>>>        Function fiIsOK Returns Integer
51866>>>>>>>>>            String lsBaxioStatus sclient
51867>>>>>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
51868>>>>>>>>>            Get psfragmaclient       to sclient
51869>>>>>>>>>            If (Trim(sClient)='') Begin
51871>>>>>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
51874>>>>>>>>>            End
51874>>>>>>>>>>
51874>>>>>>>>>            Else Begin
51875>>>>>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
51878>>>>>>>>>            End
51878>>>>>>>>>>
51878>>>>>>>>>            Function_Return 0
51879>>>>>>>>>        End_Function
51880>>>>>>>>>        
51880>>>>>>>>>        Procedure OnConstrain
51882>>>>>>>>>        
51882>>>>>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
51883>>>>>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
51883>>>>>>>>>            Date    dApo dEos
51883>>>>>>>>>        
51883>>>>>>>>>            Forward Send OnConstrain
51885>>>>>>>>>        
51885>>>>>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
51886>>>>>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
51887>>>>>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
51888>>>>>>>>>        
51888>>>>>>>>>            Get psApodekths             to sApodekths
51889>>>>>>>>>            Get psEkdoths               to sEkdoths
51890>>>>>>>>>            Get pdApo                   to dApo
51891>>>>>>>>>            Get pdEos                   to dEos
51892>>>>>>>>>        
51892>>>>>>>>>            If (liBaxioKatCode <> 0) Begin
51894>>>>>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
51896>>>>>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
51900>>>>>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
51903>>>>>>>>>            End
51903>>>>>>>>>>
51903>>>>>>>>>        
51903>>>>>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
51907>>>>>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
51911>>>>>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
51915>>>>>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
51919>>>>>>>>>        
51919>>>>>>>>>        End_Procedure // OnConstrain
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        
51920>>>>>>>>>        //AB-StoreEnd
51920>>>>>>>>>
51920>>>>>>>>>    End_Object    // Baxio_DD
51921>>>>>>>>>
51921>>>>>>>>>    Set Main_DD to (Baxio_DD(self))
51922>>>>>>>>>    Set Server to (Baxio_DD(self))
51923>>>>>>>>>
51923>>>>>>>>>    //AB-DDOEnd
51923>>>>>>>>>
51923>>>>>>>>>    Object oSelList is a dbListSub
51925>>>>>>>>>        Set Main_File to Baxio.File_Number
51926>>>>>>>>>        Set Size to 228 514
51927>>>>>>>>>        Set Location to 4 6
51928>>>>>>>>>
51928>>>>>>>>>        Begin_Row
51931>>>>>>>>>            Entry_Item Baxio.Baxio_code
51932>>>>>>>>>            Entry_Item Baxio.Baxio_epon_in
51933>>>>>>>>>            Entry_Item Baxio.Baxio_epon_out
51934>>>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
51935>>>>>>>>>            Entry_Item Baxio.Baxio_hmnial
51936>>>>>>>>>            Entry_Item Baxio.Baxio_v2
51937>>>>>>>>>            Entry_Item Baxio.Baxio_banka
51938>>>>>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
51939>>>>>>>>>            Entry_Item Baxio.Baxio_no
51940>>>>>>>>>        End_Row
51945>>>>>>>>>
51945>>>>>>>>>        Set Form_Width    item 0 to 41
51946>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
51947>>>>>>>>>        
51947>>>>>>>>>        Set Form_Width    item 1 to 98
51948>>>>>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
51949>>>>>>>>>        
51949>>>>>>>>>        Set Form_Width    item 2 to 94
51950>>>>>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
51951>>>>>>>>>        
51951>>>>>>>>>        Set Form_Width    item 3 to 75
51952>>>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
51953>>>>>>>>>        
51953>>>>>>>>>        Set Form_Width    item 4 to 47
51954>>>>>>>>>        Set Header_Label  item 4 to "Šã¥ž"
51955>>>>>>>>>        
51955>>>>>>>>>        Set Form_Width    item 5 to 48
51956>>>>>>>>>        Set Header_Label  item 5 to "¦©æ"
51957>>>>>>>>>        
51957>>>>>>>>>        Set Form_Width    item 6 to 12
51958>>>>>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
51959>>>>>>>>>        
51959>>>>>>>>>        Set Form_Width    item 7 to 42
51960>>>>>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
51961>>>>>>>>>        
51961>>>>>>>>>        Set Form_Width    item 8 to 53
51962>>>>>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
51963>>>>>>>>>        
51963>>>>>>>>>
51963>>>>>>>>>        //AB-StoreStart
51963>>>>>>>>>                
51963>>>>>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
51965>>>>>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
51967>>>>>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
51969>>>>>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
51971>>>>>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
51973>>>>>>>>>        
51973>>>>>>>>>        Procedure Store_Defaults
51975>>>>>>>>>            Forward Send Store_Defaults
51977>>>>>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
51978>>>>>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
51979>>>>>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
51980>>>>>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
51981>>>>>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
51982>>>>>>>>>        End_Procedure // Store_Defaults
51983>>>>>>>>>        
51983>>>>>>>>>        Procedure Restore_Defaults
51985>>>>>>>>>            Forward Send Restore_Defaults
51987>>>>>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
51988>>>>>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
51989>>>>>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
51990>>>>>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
51991>>>>>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
51992>>>>>>>>>        End_Procedure // Restore_Defaults
51993>>>>>>>>>        
51993>>>>>>>>>        Procedure Activating
51995>>>>>>>>>            Forward Send Activating
51997>>>>>>>>>         //   Set Auto_Index_State        to True
51997>>>>>>>>>            Send Rebuild_Constraints    to Baxio_DD
51998>>>>>>>>>        End_Procedure
51999>>>>>>>>>        
51999>>>>>>>>>        Procedure End_Construct_Object
52001>>>>>>>>>            Integer iDecs
52002>>>>>>>>>            Forward Send End_Construct_Object
52004>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
52005>>>>>>>>>            Set Points Item 5 to iDecs
52006>>>>>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
52007>>>>>>>>>        End_Procedure
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        
52008>>>>>>>>>        //AB-StoreEnd
52008>>>>>>>>>
52008>>>>>>>>>    End_Object    // oSelList
52009>>>>>>>>>
52009>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
52011>>>>>>>>>        Set Label to "Šã¥ž ˜§¦"
52012>>>>>>>>>        Set Location to 241 7
52013>>>>>>>>>        Set Size to 10 35
52014>>>>>>>>>        Set TypeFace to "MS Sans Serif"
52015>>>>>>>>>    End_Object    // TextBoxSub1
52016>>>>>>>>>
52016>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
52018>>>>>>>>>        Set Size to 13 66
52019>>>>>>>>>        Set Location to 240 45
52020>>>>>>>>>        Set Label_Col_Offset to 2
52021>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
52022>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
52023>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52024>>>>>>>>>
52024>>>>>>>>>        //AB-StoreStart
52024>>>>>>>>>                                                    
52024>>>>>>>>>        Procedure Key Integer iKey
52026>>>>>>>>>            Integer iRetVal
52027>>>>>>>>>            Forward Send Key iKey
52029>>>>>>>>>            If (iKey=277) Begin
52031>>>>>>>>>                Set Value Item 0 to ''
52032>>>>>>>>>                //Send KeyAction to ButtonSub1
52032>>>>>>>>>            End
52032>>>>>>>>>>
52032>>>>>>>>>        End_Procedure
52033>>>>>>>>>        
52033>>>>>>>>>        
52033>>>>>>>>>        //AB-StoreEnd
52033>>>>>>>>>
52033>>>>>>>>>    End_Object    // cSyDateForm1
52034>>>>>>>>>
52034>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
52036>>>>>>>>>        Set Label to "Šã¥ž œàª"
52037>>>>>>>>>        Set Location to 258 7
52038>>>>>>>>>        Set Size to 10 35
52039>>>>>>>>>        Set TypeFace to "MS Sans Serif"
52040>>>>>>>>>    End_Object    // TextBoxSub2
52041>>>>>>>>>
52041>>>>>>>>>    Object cSyDateForm2 is a cSyDateForm
52043>>>>>>>>>        Set Size to 13 66
52044>>>>>>>>>        Set Location to 256 45
52045>>>>>>>>>        Set Label_Col_Offset to 2
52046>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
52047>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
52048>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52049>>>>>>>>>
52049>>>>>>>>>        //AB-StoreStart
52049>>>>>>>>>                                                    
52049>>>>>>>>>        Procedure Key Integer iKey
52051>>>>>>>>>            Integer iRetVal
52052>>>>>>>>>            Forward Send Key iKey
52054>>>>>>>>>            If (iKey=277) Begin
52056>>>>>>>>>                Set Value Item 0 to ''
52057>>>>>>>>>                //Send KeyAction to ButtonSub1
52057>>>>>>>>>            End
52057>>>>>>>>>>
52057>>>>>>>>>        End_Procedure
52058>>>>>>>>>        
52058>>>>>>>>>        
52058>>>>>>>>>        //AB-StoreEnd
52058>>>>>>>>>
52058>>>>>>>>>    End_Object    // cSyDateForm2
52059>>>>>>>>>
52059>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
52061>>>>>>>>>        Set Label to "„¡›æ«žª"
52062>>>>>>>>>        Set Location to 241 118
52063>>>>>>>>>        Set Size to 10 33
52064>>>>>>>>>        Set TypeFace to "MS Sans Serif"
52065>>>>>>>>>    End_Object    // TextBoxSub4
52066>>>>>>>>>
52066>>>>>>>>>    Object TextBoxSub5 is a TextBoxSub
52068>>>>>>>>>        Set Label to "€§¦›â¡«žª"
52069>>>>>>>>>        Set Location to 258 118
52070>>>>>>>>>        Set Size to 10 39
52071>>>>>>>>>        Set TypeFace to "MS Sans Serif"
52072>>>>>>>>>    End_Object    // TextBoxSub5
52073>>>>>>>>>
52073>>>>>>>>>    Object FormSub1 is a FormSub
52075>>>>>>>>>        Set Size to 13 77
52076>>>>>>>>>        Set Location to 240 159
52077>>>>>>>>>        Set Label_Col_Offset to 2
52078>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
52079>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52080>>>>>>>>>
52080>>>>>>>>>        //AB-StoreStart
52080>>>>>>>>>                                                    
52080>>>>>>>>>        Set Prompt_Object to (sl100(Self))
52081>>>>>>>>>        
52081>>>>>>>>>        Procedure OnChange
52083>>>>>>>>>            String s1
52084>>>>>>>>>            Get Value Item 0 to s1
52085>>>>>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
52086>>>>>>>>>            Set psEkdoths to s1
52087>>>>>>>>>        End_Procedure
52088>>>>>>>>>        
52088>>>>>>>>>        
52088>>>>>>>>>        
52088>>>>>>>>>        
52088>>>>>>>>>        
52088>>>>>>>>>        
52088>>>>>>>>>        
52088>>>>>>>>>        //AB-StoreEnd
52088>>>>>>>>>
52088>>>>>>>>>    End_Object    // FormSub1
52089>>>>>>>>>
52089>>>>>>>>>    Object FormSub2 is a FormSub
52091>>>>>>>>>        Set Size to 13 187
52092>>>>>>>>>        Set Location to 240 240
52093>>>>>>>>>        Set Color to clBtnFace
52094>>>>>>>>>        Set Label_Col_Offset to 2
52095>>>>>>>>>        Set Enabled_State to FALSE
52096>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52097>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
52098>>>>>>>>>        Set Shadow_State Item 0 to TRUE
52099>>>>>>>>>    End_Object    // FormSub2
52100>>>>>>>>>
52100>>>>>>>>>    Object FormSub3 is a FormSub
52102>>>>>>>>>        Set Size to 13 77
52103>>>>>>>>>        Set Location to 256 159
52104>>>>>>>>>        Set Label_Col_Offset to 2
52105>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
52106>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52107>>>>>>>>>
52107>>>>>>>>>        //AB-StoreStart
52107>>>>>>>>>                                                    
52107>>>>>>>>>        Set Prompt_Object to (sl100(Self))
52108>>>>>>>>>        
52108>>>>>>>>>        Procedure OnChange
52110>>>>>>>>>            String s1
52111>>>>>>>>>            Get Value Item 0 to s1
52112>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
52113>>>>>>>>>            Set psApodekths to s1
52114>>>>>>>>>        End_Procedure
52115>>>>>>>>>        
52115>>>>>>>>>        
52115>>>>>>>>>        
52115>>>>>>>>>        
52115>>>>>>>>>        
52115>>>>>>>>>        
52115>>>>>>>>>        
52115>>>>>>>>>        //AB-StoreEnd
52115>>>>>>>>>
52115>>>>>>>>>    End_Object    // FormSub3
52116>>>>>>>>>
52116>>>>>>>>>    Object FormSub4 is a FormSub
52118>>>>>>>>>        Set Size to 13 187
52119>>>>>>>>>        Set Location to 256 240
52120>>>>>>>>>        Set Color to clBtnFace
52121>>>>>>>>>        Set Label_Col_Offset to 2
52122>>>>>>>>>        Set Enabled_State to FALSE
52123>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52124>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
52125>>>>>>>>>        Set Shadow_State Item 0 to TRUE
52126>>>>>>>>>    End_Object    // FormSub4
52127>>>>>>>>>
52127>>>>>>>>>    Object ButtonSub1 is a ButtonSub
52129>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
52130>>>>>>>>>        Set Size to 14 43
52131>>>>>>>>>        Set Location to 256 430
52132>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52133>>>>>>>>>
52133>>>>>>>>>        //AB-StoreStart
52133>>>>>>>>>                                                    
52133>>>>>>>>>        Procedure OnClick
52135>>>>>>>>>            Date dApo dEos
52136>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
52137>>>>>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
52138>>>>>>>>>            Set pdApo to dApo
52139>>>>>>>>>            Set pdEos to dEos
52140>>>>>>>>>            Send Rebuild_Constraints to Baxio_DD
52141>>>>>>>>>            Send Beginning_Of_Data to oSelList True
52142>>>>>>>>>        End_Procedure // OnClick
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        
52143>>>>>>>>>        //AB-StoreEnd
52143>>>>>>>>>
52143>>>>>>>>>    End_Object    // ButtonSub1
52144>>>>>>>>>
52144>>>>>>>>>    Object oOK_bn is a ButtonSub
52146>>>>>>>>>        Set Label to "&„§ ¢¦šã"
52147>>>>>>>>>        Set Size to 14 43
52148>>>>>>>>>        Set Location to 256 478
52149>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
52150>>>>>>>>>
52150>>>>>>>>>        //AB-StoreStart
52150>>>>>>>>>        Procedure OnClick
52152>>>>>>>>>            Send OK To oSelList
52153>>>>>>>>>        End_Procedure
52154>>>>>>>>>        //AB-StoreEnd
52154>>>>>>>>>
52154>>>>>>>>>    End_Object    // oOK_bn
52155>>>>>>>>>
52155>>>>>>>>>
52155>>>>>>>>>    //AB-StoreStart
52155>>>>>>>>>                        
52155>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
52156>>>>>>>>>    
52156>>>>>>>>>    Procedure Request_Cancel
52158>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
52159>>>>>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
52160>>>>>>>>>        Set Value Of FormSub1     Item 0 to ''
52161>>>>>>>>>        Set Value Of FormSub2     Item 0 to ''
52162>>>>>>>>>        Forward Send Request_Cancel
52164>>>>>>>>>    End_Procedure
52165>>>>>>>>>    
52165>>>>>>>>>    
52165>>>>>>>>>    
52165>>>>>>>>>    
52165>>>>>>>>>    
52165>>>>>>>>>    //AB-StoreEnd
52165>>>>>>>>>
52165>>>>>>>>>End_Object    // SL037
52166>>>>>>>>>
52166>>>>>>>>>
52166>>>>>>>>>//AB-StoreStart
52166>>>>>>>>>    
52166>>>>>>>>>//AB-StoreEnd
52166>>>>>>>>>
52166>>>>>>>>>//AB/ End_Object    // prj
52166>>>>>>>Use slnomism.sl      // slNomism
52166>>>>>>>
52166>>>>>>>//DDB-Selection-pkg-End
52166>>>>>>>//DDB-FileEnd
52166>>>>>    Use BMOVE.DD
INCLUDING FILE: BMOVE.DD
52166>>>>>>>//DDB-FileStart
52166>>>>>>>//DDB-HeaderStart
52166>>>>>>>
52166>>>>>>>// File Name : BMOVE.DD
52166>>>>>>>// Class Name: Bmove_DataDictionary
52166>>>>>>>// Revision  : 51
52166>>>>>>>// Version   : 2
52166>>>>>>>
52166>>>>>>>Use  Windows           // Basic Definitions
52166>>>>>>>Use  DataDict          // DataDictionary Class Definition
52166>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52166>>>>>>>
52166>>>>>>>Open Bmove
52168>>>>>>>Open Barticl
52170>>>>>>>Open Baxio
52172>>>>>>>Open Sysrecb
52174>>>>>>>Open Bkinkat
52176>>>>>>>Open Bsum
52178>>>>>>>
52178>>>>>>>//DDB-HeaderEnd
52178>>>>>>>
52178>>>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
52178>>>>>>>      //  ˜§¦          ©œ
52178>>>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
52178>>>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
52178>>>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
52178>>>>>>>
52178>>>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
52178>>>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
52178>>>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
52178>>>>>>>
52178>>>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
52178>>>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
52178>>>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
52178>>>>>>>
52178>>>>>>>
52178>>>>>>>Open SysCurXr
52180>>>>>>>Open Baxiokat
52182>>>>>>>Open Btypkin
52184>>>>>>>Open Bkinkat
52186>>>>>>>Open Baxio
52188>>>>>>>
52188>>>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
52189>>>>>>>
52189>>>>>>>      Procedure Construct_Object
52190>>>>>>>                Forward Send Construct_Object
52192>>>>>>>
52192>>>>>>>                Property Integer piCan_Create_Baxio (FALSE)
52193>>>>>>>
52193>>>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
52193>>>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
52193>>>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
52193>>>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
52193>>>>>>>                Property Integer piBarticl_dd        0
52194>>>>>>>                Property Integer piBaxio_dd          0
52195>>>>>>>                Property Integer piBtypkin_dd        0
52196>>>>>>>                Property Integer piBaxiokat_dd       0
52197>>>>>>>                Property Integer piBaxio_Status_From 0
52198>>>>>>>                Property Integer piBaxio_Status_To   0
52199>>>>>>>
52199>>>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
52200>>>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
52200>>>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
52200>>>>>>>
52200>>>>>>>                Property Integer piB_Baxio_Status  0
52201>>>>>>>                Property Integer piA_Baxio_Status  0
52202>>>>>>>
52202>>>>>>>                //19 §˜¢˜ âª « £âª
52202>>>>>>>                Property  Integer piB_Garticl_Rec0           0
52203>>>>>>>                Property  Integer piB_Gtypkin_Rec0           0
52204>>>>>>>                Property  Date    pdB_Garticl_Hmnia          0
52205>>>>>>>                Property  Integer piB_Garticl_No             0
52206>>>>>>>                Property  String  psB_Garticl_C_Code2        0
52207>>>>>>>                Property  Number  pnB_Garticl_Rate0          0
52208>>>>>>>                Property  Number  pnB_Garticl_Rate00         0
52209>>>>>>>                Property  Number  pnB_Garticl_RateR          0
52210>>>>>>>                Property  String  psB_Garticl_Aitiol         0
52211>>>>>>>
52211>>>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
52212>>>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
52213>>>>>>>                Property  Number  pnB_Gmove_Master_X2        0
52214>>>>>>>                Property  Number  pnB_Gmove_Master_P2        0
52215>>>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
52216>>>>>>>
52216>>>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
52217>>>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
52218>>>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
52219>>>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
52220>>>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
52221>>>>>>>
52221>>>>>>>                //19 ¤âœª « £âª
52221>>>>>>>                Property  Integer piA_Garticl_Rec0           0
52222>>>>>>>                Property  Integer piA_Gtypkin_Rec0           0
52223>>>>>>>                Property  Date    pdA_Garticl_Hmnia          0
52224>>>>>>>                Property  Integer piA_Garticl_No             0
52225>>>>>>>                Property  String  psA_Garticl_C_Code2        0
52226>>>>>>>                Property  Number  pnA_Garticl_Rate0          0
52227>>>>>>>                Property  Number  pnA_Garticl_Rate00         0
52228>>>>>>>                Property  Number  pnA_Garticl_RateR          0
52229>>>>>>>                Property  String  psA_Garticl_Aitiol         0
52230>>>>>>>
52230>>>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
52231>>>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
52232>>>>>>>                Property  Number  pnA_Gmove_Master_X2        0
52233>>>>>>>                Property  Number  pnA_Gmove_Master_P2        0
52234>>>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
52235>>>>>>>
52235>>>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
52236>>>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
52237>>>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
52238>>>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
52239>>>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
52240>>>>>>>
52240>>>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
52241>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
52241>>>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
52242>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
52242>>>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
52243>>>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
52243>>>>>>>
52243>>>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
52243>>>>>>>                Property Integer  piF_Garticl_Rec0           0
52244>>>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
52245>>>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
52246>>>>>>>
52246>>>>>>>                Property Integer  piUpdate                   0
52247>>>>>>>                Property Integer  piBackout                  0
52248>>>>>>>
52248>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
52248>>>>>>>                Property String   psB_Barticl_Recr           ''
52249>>>>>>>                Property String   psB_Baxiokat_Recr          ''
52250>>>>>>>                Property Number   pnB_Baxio_V2               0
52251>>>>>>>                Property Number   pnB_Baxio_V0               0
52252>>>>>>>                Property Number   pnB_Baxio_V00              0
52253>>>>>>>                Property Number   pnB_Baxio_VR               0
52254>>>>>>>
52254>>>>>>>                Property String   psA_Barticl_Recr           ''
52255>>>>>>>                Property String   psA_Baxiokat_Recr          ''
52256>>>>>>>                Property Number   pnA_Baxio_V2               0
52257>>>>>>>                Property Number   pnA_Baxio_V0               0
52258>>>>>>>                Property Number   pnA_Baxio_V00              0
52259>>>>>>>                Property Number   pnA_Baxio_VR               0
52260>>>>>>>
52260>>>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
52260>>>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
52261>>>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
52262>>>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
52263>>>>>>>
52263>>>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
52264>>>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
52265>>>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
52266>>>>>>>
52266>>>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
52267>>>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
52268>>>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
52269>>>>>>>
52269>>>>>>>                Property Integer    piMustNotConstrain      0
52270>>>>>>>
52270>>>>>>>
52270>>>>>>>      End_Procedure   //construct_object
52271>>>>>>>
52271>>>>>>>
52271>>>>>>>
52271>>>>>>>      //****************************************************************************************
52271>>>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
52271>>>>>>>      //****************************************************************************************
52271>>>>>>>
52271>>>>>>>
52271>>>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
52271>>>>>>>      //¡˜  transaction is enabled !
52271>>>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
52271>>>>>>>      //¡˜¢œå «ž¤ private.update_bsum
52271>>>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
52271>>>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
52271>>>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
52271>>>>>>>
52271>>>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
52271>>>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
52271>>>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
52271>>>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
52271>>>>>>>      Procedure private.Trexe Returns Integer
52272>>>>>>>                Integer liBackout liUpdate
52273>>>>>>>
52273>>>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
52273>>>>>>>                Number  lnB_Baxio_V2
52273>>>>>>>                Number  lnB_Baxio_V0
52273>>>>>>>                Number  lnB_Baxio_V00
52273>>>>>>>                Number  lnB_Baxio_VR
52273>>>>>>>
52273>>>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
52273>>>>>>>                Number  lnA_Baxio_V2
52273>>>>>>>                Number  lnA_Baxio_V0
52273>>>>>>>                Number  lnA_Baxio_V00
52273>>>>>>>                Number  lnA_Baxio_VR
52273>>>>>>>
52273>>>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
52273>>>>>>>                Get piBackout to liBackout
52274>>>>>>>                Get piUpdate  to liUpdate
52275>>>>>>>
52275>>>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
52275>>>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
52277>>>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
52278>>>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
52278>>>>>>>                     End
52278>>>>>>>>
52278>>>>>>>
52278>>>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
52278>>>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
52279>>>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
52280>>>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
52281>>>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
52282>>>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
52283>>>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
52284>>>>>>>
52284>>>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
52284>>>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
52285>>>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
52286>>>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
52287>>>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
52288>>>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
52289>>>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
52290>>>>>>>
52290>>>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
52290>>>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
52290>>>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
52290>>>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
52290>>>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
52292>>>>>>>                       Procedure_Return
52293>>>>>>>                      End
52293>>>>>>>>
52293>>>>>>>
52293>>>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
52293>>>>>>>                If (liBackout = 1);                Begin
52295>>>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
52296>>>>>>>                End //if (libackout = 1)
52296>>>>>>>>
52296>>>>>>>
52296>>>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
52296>>>>>>>                If (liUpdate = 1);                Begin
52298>>>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
52299>>>>>>>                End //if (liupdate = 1)
52299>>>>>>>>
52299>>>>>>>      End_Procedure //private.trexe
52300>>>>>>>
52300>>>>>>>
52300>>>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
52300>>>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
52300>>>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
52301>>>>>>>
52301>>>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
52302>>>>>>>
52302>>>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
52302>>>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
52305>>>>>>>
52305>>>>>>>                //**************************************************************************
52305>>>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
52305>>>>>>>                //**************************************************************************
52305>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
52307>>>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
52308>>>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
52308>>>>>>>                     End
52308>>>>>>>>
52308>>>>>>>                Move (lnV2  * liSign) to lnV2
52309>>>>>>>                Move (lnV0  * liSign) to lnV0
52310>>>>>>>                Move (lnV00 * liSign) to lnV00
52311>>>>>>>                Move (lnVR  * liSign) to lnVR
52312>>>>>>>
52312>>>>>>>                //**************************************************************************
52312>>>>>>>                //02.œ¤ž£â¨à©ž bsum
52312>>>>>>>                //**************************************************************************
52312>>>>>>>
52312>>>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
52312>>>>>>>                Clear Bsum
52313>>>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
52314>>>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
52315>>>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
52316>>>>>>>>
52316>>>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
52318>>>>>>>
52318>>>>>>>                      // jsjsjs 27/01/2001
52318>>>>>>>                      Add 1 to SysrecB.Bsum_Rec0
52319>>>>>>>                      Saverecord SysrecB
52320>>>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
52321>>>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
52322>>>>>>>
52322>>>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
52322>>>>>>>                      //Saverecord SysrecB
52322>>>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
52322>>>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
52322>>>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
52322>>>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
52322>>>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
52323>>>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
52324>>>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
52324>>>>>>>>
52324>>>>>>>
52324>>>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
52324>>>>>>>
52324>>>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
52324>>>>>>>
52324>>>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
52326>>>>>>>                     Delete Bsum
52327>>>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
52328>>>>>>>                End
52328>>>>>>>>
52328>>>>>>>                Else;                Begin
52329>>>>>>>                     Add lnV2  to Bsum.Bsum_SV2
52330>>>>>>>                     Add lnV0  to Bsum.Bsum_SV0
52331>>>>>>>                     Add lnV00 to Bsum.Bsum_SV00
52332>>>>>>>                     Add lnVR  to Bsum.Bsum_SVR
52333>>>>>>>                     Saverecord Bsum
52334>>>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
52335>>>>>>>                End
52335>>>>>>>>
52335>>>>>>>
52335>>>>>>>      End_Procedure //private.update_bsum
52336>>>>>>>      //****************************************************************************************
52336>>>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
52336>>>>>>>      //****************************************************************************************
52336>>>>>>>
52336>>>>>>>
52336>>>>>>>      //private
52336>>>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
52336>>>>>>>      Procedure private.Initialize_Properties
52337>>>>>>>                Integer liBarticl_dd liBaxio_dd
52338>>>>>>>
52338>>>>>>>                //barticl related properties
52338>>>>>>>                Get piBarticl_dd to liBarticl_dd
52339>>>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
52341>>>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
52342>>>>>>>                End
52342>>>>>>>>
52342>>>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
52344>>>>>>>
52344>>>>>>>                //baxio   related properties
52344>>>>>>>                Get piBaxio_dd to liBaxio_dd
52345>>>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
52347>>>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
52348>>>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
52349>>>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
52350>>>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
52351>>>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
52352>>>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
52353>>>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
52354>>>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
52355>>>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
52356>>>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
52357>>>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
52358>>>>>>>                End
52358>>>>>>>>
52358>>>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
52360>>>>>>>
52360>>>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
52361>>>>>>>
52361>>>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
52361>>>>>>>                Set piB_Garticl_Rec0         to 0
52362>>>>>>>                Set piB_Gtypkin_Rec0         to 0
52363>>>>>>>                Set pdB_Garticl_Hmnia        to 0
52364>>>>>>>                Set piB_Garticl_No           to 0
52365>>>>>>>                Set psB_Garticl_C_Code2      to 0
52366>>>>>>>                Set pnB_Garticl_Rate0        to 0
52367>>>>>>>                Set pnB_Garticl_Rate00       to 0
52368>>>>>>>                Set pnB_Garticl_RateR        to 0
52369>>>>>>>                Set psB_Garticl_Aitiol       to 0
52370>>>>>>>
52370>>>>>>>                Set piB_Gmove_Master_Rec0    to 0
52371>>>>>>>                Set piB_Gplan_Master_Rec0    to 0
52372>>>>>>>                Set pnB_Gmove_Master_X2      to 0
52373>>>>>>>                Set pnB_Gmove_Master_P2      to 0
52374>>>>>>>                Set psB_Gmove_Master_Aitiol  to 0
52375>>>>>>>
52375>>>>>>>                Set piB_Gmove_Slave_Rec0     to 0
52376>>>>>>>                Set piB_Gplan_Slave_Rec0     to 0
52377>>>>>>>                Set pnB_Gmove_Slave_X2       to 0
52378>>>>>>>                Set pnB_Gmove_Slave_P2       to 0
52379>>>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
52380>>>>>>>
52380>>>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
52380>>>>>>>                Set piA_Garticl_Rec0         to 0
52381>>>>>>>                Set piA_Gtypkin_Rec0         to 0
52382>>>>>>>                Set pdA_Garticl_Hmnia        to 0
52383>>>>>>>                Set piA_Garticl_No           to 0
52384>>>>>>>                Set psA_Garticl_C_Code2      to 0
52385>>>>>>>                Set pnA_Garticl_Rate0        to 0
52386>>>>>>>                Set pnA_Garticl_Rate00       to 0
52387>>>>>>>                Set pnA_Garticl_RateR        to 0
52388>>>>>>>                Set psA_Garticl_Aitiol       to 0
52389>>>>>>>
52389>>>>>>>                Set piA_Gmove_Master_Rec0    to 0
52390>>>>>>>                Set piA_Gplan_Master_Rec0    to 0
52391>>>>>>>                Set pnA_Gmove_Master_X2      to 0
52392>>>>>>>                Set pnA_Gmove_Master_P2      to 0
52393>>>>>>>                Set psA_Gmove_Master_Aitiol  to 0
52394>>>>>>>
52394>>>>>>>                Set piA_Gmove_Slave_Rec0     to 0
52395>>>>>>>                Set piA_Gplan_Slave_Rec0     to 0
52396>>>>>>>                Set pnA_Gmove_Slave_X2       to 0
52397>>>>>>>                Set pnA_Gmove_Slave_P2       to 0
52398>>>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
52399>>>>>>>
52399>>>>>>>                Set piBaxio_Status_From      to 0
52400>>>>>>>                Set piBaxio_Status_To        to 0
52401>>>>>>>
52401>>>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
52401>>>>>>>                Set piF_Garticl_Rec0         to 0
52402>>>>>>>                Set piF_Gmove_Master_Rec0    to 0
52403>>>>>>>                Set piF_Gmove_Slave_Rec0     to 0
52404>>>>>>>
52404>>>>>>>                Set piUpdate                 to 0
52405>>>>>>>                Set piBackout                to 0
52406>>>>>>>
52406>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
52406>>>>>>>                Set psB_Barticl_Recr         to ''
52407>>>>>>>                Set psB_Baxiokat_Recr        to ''
52408>>>>>>>                Set pnB_Baxio_V2             to 0
52409>>>>>>>                Set pnB_Baxio_V0             to 0
52410>>>>>>>                Set pnB_Baxio_V00            to 0
52411>>>>>>>                Set pnB_Baxio_VR             to 0
52412>>>>>>>
52412>>>>>>>                Set psA_Barticl_Recr         to ''
52413>>>>>>>                Set psA_Baxiokat_Recr        to ''
52414>>>>>>>                Set pnA_Baxio_V2             to 0
52415>>>>>>>                Set pnA_Baxio_V0             to 0
52416>>>>>>>                Set pnA_Baxio_V00            to 0
52417>>>>>>>                Set pnA_Baxio_VR             to 0
52418>>>>>>>
52418>>>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
52418>>>>>>>                Set  piGarticl_Delete         to  0
52419>>>>>>>                Set  piGarticl_Edit           to  0
52420>>>>>>>                Set  piGarticl_Create         to  0
52421>>>>>>>
52421>>>>>>>                Set  piMaster_Gmove_Delete    to  0
52422>>>>>>>                Set  piMaster_Gmove_Edit      to  0
52423>>>>>>>                Set  piMaster_Gmove_Create    to  0
52424>>>>>>>
52424>>>>>>>                Set  piSlave_Gmove_Delete     to  0
52425>>>>>>>                Set  piSlave_Gmove_Edit       to  0
52426>>>>>>>                Set  piSlave_Gmove_Create     to  0
52427>>>>>>>      End_Procedure //private.Initialize_Properties
52428>>>>>>>
52428>>>>>>>
52428>>>>>>>      //private
52428>>>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
52428>>>>>>>      Procedure private.Creating_Barticl
52429>>>>>>>      End_Procedure //private.creating_barticl
52430>>>>>>>
52430>>>>>>>
52430>>>>>>>      //private
52430>>>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
52430>>>>>>>      Procedure private.Creating_Baxio
52431>>>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
52432>>>>>>>
52432>>>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
52432>>>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
52432>>>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
52432>>>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
52432>>>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
52432>>>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
52432>>>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
52432>>>>>>>                Case Begin
52432>>>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
52432>>>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
52434>>>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
52435>>>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
52436>>>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
52437>>>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
52438>>>>>>>
52438>>>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
52439>>>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
52440>>>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
52441>>>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
52442>>>>>>>                     Case Break
52443>>>>>>>
52443>>>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
52443>>>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
52446>>>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
52447>>>>>>>                          Move ""                      to Baxio.Baxio_Code_In
52448>>>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
52449>>>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
52450>>>>>>>
52450>>>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
52451>>>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
52452>>>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
52453>>>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
52454>>>>>>>                     Case Break
52455>>>>>>>
52455>>>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
52455>>>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
52456>>>>>>>                Case End
52456>>>>>>>
52456>>>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
52459>>>>>>>                Move barticl.barticl_hmnia  to baxio.baxio_hmniae
52460>>>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
52460>>>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
52461>>>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
52464>>>>>>>      End_Procedure //private.creating_baxio
52465>>>>>>>
52465>>>>>>>
52465>>>>>>>//      //private
52465>>>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
52465>>>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
52465>>>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
52465>>>>>>>//                                          String lsBaxiokat_Recr;
52465>>>>>>>//                                          Returns Integer
52465>>>>>>>//               Clear Bsum
52465>>>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
52465>>>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
52465>>>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
52465>>>>>>>//               Function_Return Bsum.Gmove_Srec0
52465>>>>>>>//      End_Function //private.fibsum_gmove_srec0
52465>>>>>>>
52465>>>>>>>
52465>>>>>>>      //private
52465>>>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
52465>>>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
52465>>>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
52466>>>>>>>               Clear Bkinkat
52467>>>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
52468>>>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
52469>>>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
52470>>>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
52471>>>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
52472>>>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
52473>>>>>>>>
52473>>>>>>>               If (Found = 0) Begin
52475>>>>>>>                               Set piBaxio_Status_From to (-1)
52476>>>>>>>                               Set piBaxio_Status_To   to (-1)
52477>>>>>>>                               Function_Return 0
52478>>>>>>>                              End
52478>>>>>>>>
52478>>>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
52479>>>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
52480>>>>>>>
52480>>>>>>>
52480>>>>>>>               Function_Return Bkinkat.Baxiokat_Code
52481>>>>>>>      End_Function //private.fibkinkat_baxiokat_code
52482>>>>>>>
52482>>>>>>>
52482>>>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
52482>>>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
52482>>>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
52483>>>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
52485>>>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
52486>>>>>>>>
52486>>>>>>>                      Procedure_Return
52487>>>>>>>                     End
52487>>>>>>>>
52487>>>>>>>
52487>>>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
52487>>>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
52488>>>>>>>
52488>>>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
52488>>>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
52489>>>>>>>
52489>>>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
52489>>>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
52490>>>>>>>
52490>>>>>>>                //¤æ£ ©£˜ reporting
52490>>>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
52491>>>>>>>      End_Procedure //private.adjust_balances
52492>>>>>>>
52492>>>>>>>
52492>>>>>>>
52492>>>>>>>
52492>>>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
52492>>>>>>>      //£œ æ¢˜ «˜ ddo id's
52492>>>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
52492>>>>>>>      Procedure End_Construct_Object
52493>>>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
52494>>>>>>>
52494>>>>>>>                Forward Send End_Construct_Object
52496>>>>>>>
52496>>>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
52497>>>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
52498>>>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
52499>>>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
52500>>>>>>>
52500>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
52500>>>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
52500>>>>>>>
52500>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
52500>>>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
52500>>>>>>>
52500>>>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
52500>>>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
52500>>>>>>>
52500>>>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
52500>>>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
52503>>>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
52506>>>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
52509>>>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
52512>>>>>>>
52512>>>>>>>                //properties › ¡á «¦¬
52512>>>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
52512>>>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
52512>>>>>>>                Set piBarticl_dd                  to liBarticl_dd
52513>>>>>>>                Set piBaxio_dd                    to liBaxio_dd
52514>>>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
52515>>>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
52516>>>>>>>
52516>>>>>>>                //properties «¦¬ btypkin
52516>>>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
52517>>>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
52518>>>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
52519>>>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
52520>>>>>>>
52520>>>>>>>                //properties «¦¬ baxiokat
52520>>>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
52521>>>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
52522>>>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
52523>>>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
52524>>>>>>>
52524>>>>>>>                //properties «¦¬ barticl
52524>>>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
52525>>>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
52526>>>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
52527>>>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
52528>>>>>>>
52528>>>>>>>      End_Procedure   //end_construct_object
52529>>>>>>>
52529>>>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
52529>>>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
52529>>>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
52529>>>>>>>      Procedure Constrain
52530>>>>>>>            Forward Send Constrain
52532>>>>>>>            If (piMustNotConstrain(Self)=2) Begin
52534>>>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
52536>>>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
52538>>>>>>>            End
52538>>>>>>>>
52538>>>>>>>            Else Begin
52539>>>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
52541>>>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
52543>>>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
52545>>>>>>>            End
52545>>>>>>>>
52545>>>>>>>      End_Procedure   //constrain
52546>>>>>>>
52546>>>>>>>
52546>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
52546>>>>>>>      //™) ˜¤áš¤à©ž properties
52546>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
52546>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
52546>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
52546>>>>>>>      Procedure Update
52547>>>>>>>                Integer liTemp
52548>>>>>>>                Integer liBarticl_dd      liBaxio_dd
52548>>>>>>>                Integer liCreated_Barticl liCreated_Baxio
52548>>>>>>>                String  lsGplan_Slave_Code
52548>>>>>>>
52548>>>>>>>                Forward Send Update
52550>>>>>>>
52550>>>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
52550>>>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
52550>>>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
52550>>>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
52551>>>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
52554>>>>>>>
52554>>>>>>>
52554>>>>>>>                //***********************************************************
52554>>>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
52554>>>>>>>                //***********************************************************
52554>>>>>>>
52554>>>>>>>
52554>>>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
52554>>>>>>>                Get piBarticl_dd to liBarticl_dd
52555>>>>>>>                Get piBaxio_dd   to liBaxio_dd
52556>>>>>>>
52556>>>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
52556>>>>>>>                If (liBarticl_dd <> 0);                Begin
52558>>>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
52559>>>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
52562>>>>>>>                End
52562>>>>>>>>
52562>>>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
52564>>>>>>>
52564>>>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
52564>>>>>>>                If (liBaxio_dd   <> 0);                Begin
52566>>>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
52567>>>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
52570>>>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
52571>>>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
52572>>>>>>>                End
52572>>>>>>>>
52572>>>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
52574>>>>>>>
52574>>>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
52574>>>>>>>//                //***************************************************************************
52574>>>>>>>//                //============================================================================
52574>>>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
52574>>>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
52574>>>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
52574>>>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
52574>>>>>>>//                //***************************************************************************
52574>>>>>>>//                //============================================================================
52574>>>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
52574>>>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
52574>>>>>>>
52574>>>>>>>                Send Convert_Axio_Values to liBaxio_dd
52575>>>>>>>
52575>>>>>>>
52575>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
52575>>>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
52576>>>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
52577>>>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
52578>>>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
52579>>>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
52580>>>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
52581>>>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
52582>>>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
52583>>>>>>>
52583>>>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
52584>>>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
52585>>>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
52586>>>>>>>
52586>>>>>>>
52586>>>>>>>                //™) ˜¤áš¤à©ž properties
52586>>>>>>>
52586>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
52586>>>>>>>
52586>>>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
52586>>>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
52586>>>>>>>                //     previous §œ›å˜ «¦¬ bmove,
52586>>>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
52586>>>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
52587>>>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
52588>>>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
52589>>>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
52590>>>>>>>
52590>>>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
52590>>>>>>>
52590>>>>>>>// ----------------------------------------------------------------------------
52590>>>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
52590>>>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
52590>>>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
52590>>>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
52590>>>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
52590>>>>>>>//                  ola ta _Out pedia
52590>>>>>>>
52590>>>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
52590>>>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
52590>>>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
52590>>>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
52590>>>>>>>                if (btypkin.btypkin_code=104) move 1 to baxio.baxio_rater
52593>>>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
52595>>>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
52597>>>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
52598>>>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
52599>>>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
52600>>>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
52601>>>>>>>                    End
52601>>>>>>>>
52601>>>>>>>                    Else Begin
52602>>>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
52603>>>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
52604>>>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
52605>>>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
52606>>>>>>>                    End
52606>>>>>>>>
52606>>>>>>>                End
52606>>>>>>>>
52606>>>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
52609>>>>>>>                    // js 24/02/2002 PARATHRHSEIS
52609>>>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
52609>>>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
52609>>>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
52609>>>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
52609>>>>>>>                    // me Lcode h update tou Baxio_DD
52609>>>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
52609>>>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
52609>>>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
52609>>>>>>>
52609>>>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
52609>>>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
52609>>>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
52609>>>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
52609>>>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
52609>>>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
52609>>>>>>>                    // js 24/02/2002 Parathrhseis
52609>>>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
52610>>>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
52611>>>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
52612>>>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
52613>>>>>>>                End
52613>>>>>>>>
52613>>>>>>>
52613>>>>>>>// ----------------------------------------------------------------------------
52613>>>>>>>
52613>>>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
52613>>>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
52613>>>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
52613>>>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
52615>>>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
52616>>>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
52617>>>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
52618>>>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
52619>>>>>>>                End
52619>>>>>>>>
52619>>>>>>>
52619>>>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
52619>>>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
52620>>>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
52621>>>>>>>
52621>>>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
52621>>>>>>>//                Case Begin
52621>>>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
52621>>>>>>>////jsjsjs 24/01/2001
52621>>>>>>>////                          Clear Gplan
52621>>>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
52621>>>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
52621>>>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
52621>>>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
52621>>>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
52621>>>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
52621>>>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
52621>>>>>>>////jsjsjs 24/01/2001
52621>>>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
52621>>>>>>>
52621>>>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
52621>>>>>>>//                     Case Break
52621>>>>>>>
52621>>>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
52621>>>>>>>//                     Case Break
52621>>>>>>>
52621>>>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
52621>>>>>>>//                          Move 0 to Bmove.Gplan_SRec0
52621>>>>>>>//                Case End
52621>>>>>>>
52621>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
52621>>>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
52622>>>>>>>
52622>>>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
52622>>>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
52622>>>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
52622>>>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
52622>>>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
52622>>>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
52622>>>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
52622>>>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
52622>>>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
52622>>>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
52622>>>>>>>
52622>>>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
52622>>>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
52622>>>>>>>
52622>>>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
52622>>>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
52622>>>>>>>
52622>>>>>>>                Case Begin
52622>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
52624>>>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52624>>>>>>>//                          Set pnA_Gmove_Master_P2 to 0
52624>>>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
52624>>>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52624>>>>>>>                     Case Break
52625>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
52628>>>>>>>//                          Set pnA_Gmove_Master_X2 to 0
52628>>>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52628>>>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52628>>>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
52628>>>>>>>                     Case Break
52629>>>>>>>                     Case Else
52629>>>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
52630>>>>>>>>
52630>>>>>>>                Case End
52630>>>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
52630>>>>>>>
52630>>>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
52630>>>>>>>//                                                                            Barticl.Barticl_Rec0,;
52630>>>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
52630>>>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
52630>>>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
52630>>>>>>>
52630>>>>>>>                Set piUpdate to 1
52631>>>>>>>
52631>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
52631>>>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
52632>>>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
52633>>>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
52634>>>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
52635>>>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
52636>>>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
52637>>>>>>>
52637>>>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
52637>>>>>>>//                If (Barticl.Garticl_Rec0 = 0);
52637>>>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
52637>>>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
52637>>>>>>>//                     Set  piGarticl_Create         to  1
52637>>>>>>>//                     Set  piMaster_Gmove_Create    to  1
52637>>>>>>>//                End
52637>>>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
52637>>>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
52637>>>>>>>      End_Procedure   //update
52638>>>>>>>
52638>>>>>>>
52638>>>>>>>      Procedure Backout
52639>>>>>>>                Forward Send Backout
52641>>>>>>>
52641>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
52641>>>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
52642>>>>>>>
52642>>>>>>>
52642>>>>>>>
52642>>>>>>>                //******************************
52642>>>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
52642>>>>>>>                //******************************
52642>>>>>>>
52642>>>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
52642>>>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
52642>>>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
52642>>>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
52642>>>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
52642>>>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
52642>>>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
52642>>>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
52642>>>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
52642>>>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
52642>>>>>>>
52642>>>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
52642>>>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
52642>>>>>>>
52642>>>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
52642>>>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
52642>>>>>>>
52642>>>>>>>                Case Begin
52642>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
52644>>>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52644>>>>>>>//                          Set pnB_Gmove_Master_P2 to 0
52644>>>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
52644>>>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52644>>>>>>>                     Case Break
52645>>>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
52648>>>>>>>//                          Set pnB_Gmove_Master_X2 to 0
52648>>>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52648>>>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
52648>>>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
52648>>>>>>>                     Case Break
52649>>>>>>>                     Case Else
52649>>>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
52650>>>>>>>>
52650>>>>>>>                Case End
52650>>>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
52650>>>>>>>
52650>>>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
52650>>>>>>>//                                                                            Barticl.Barticl_Rec0,;
52650>>>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
52650>>>>>>>
52650>>>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
52650>>>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
52650>>>>>>>
52650>>>>>>>                Set piBackout to 1
52651>>>>>>>
52651>>>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
52651>>>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
52652>>>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
52653>>>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
52654>>>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
52655>>>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
52656>>>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
52657>>>>>>>                if (btypkin.btypkin_code=104) move 0 to baxio.baxio_rater
52660>>>>>>>
52660>>>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
52660>>>>>>>//                Case Begin
52660>>>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
52660>>>>>>>//                           Set  piGarticl_Delete         to  1
52660>>>>>>>//                           Set  piMaster_Gmove_Delete    to  1
52660>>>>>>>//                     Case Break
52660>>>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
52660>>>>>>>//                           Set  piGarticl_Edit           to  1
52660>>>>>>>//                           Set  piMaster_Gmove_Edit      to  1
52660>>>>>>>//                     Case Break
52660>>>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
52660>>>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
52660>>>>>>>//                     Case Break
52660>>>>>>>//                Case End
52660>>>>>>>
52660>>>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
52660>>>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
52660>>>>>>>/////////////////////Case Break
52660>>>>>>>      End_Procedure   // backout
52661>>>>>>>
52661>>>>>>>
52661>>>>>>>      Procedure Creating
52662>>>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
52663>>>>>>>
52663>>>>>>>                Forward Send Creating
52665>>>>>>>
52665>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
52666>>>>>>>
52666>>>>>>>
52666>>>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
52666>>>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
52666>>>>>>>
52666>>>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
52666>>>>>>>                Add 1 to Barticl.Barticl_Lines
52667>>>>>>>
52667>>>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
52667>>>>>>>                Add 1 to Barticl.Barticl_BmoveLa
52668>>>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
52669>>>>>>>
52669>>>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
52669>>>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
52670>>>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
52671>>>>>>>
52671>>>>>>>                //pourqua ??????
52671>>>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
52672>>>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
52673>>>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
52673>>>>>>>      End_Procedure //creating
52674>>>>>>>
52674>>>>>>>
52674>>>>>>>      Procedure Deleting
52675>>>>>>>                Integer liTemp
52676>>>>>>>
52676>>>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
52676>>>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
52676>>>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
52676>>>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
52676>>>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
52676>>>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
52676>>>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
52676>>>>>>>                //«¦¬ barticl.
52676>>>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
52676>>>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
52676>>>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
52678>>>>>>>                     Get Validate_Delete to liTemp
52679>>>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
52682>>>>>>>                End
52682>>>>>>>>
52682>>>>>>>
52682>>>>>>>                Forward Send Deleting
52684>>>>>>>
52684>>>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
52684>>>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
52685>>>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
52688>>>>>>>
52688>>>>>>>
52688>>>>>>>                //***********************************************************
52688>>>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
52688>>>>>>>                //***********************************************************
52688>>>>>>>
52688>>>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
52688>>>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
52688>>>>>>>
52688>>>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
52688>>>>>>>                Sub 1 from Barticl.Barticl_Lines
52689>>>>>>>
52689>>>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
52689>>>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
52692>>>>>>>
52692>>>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
52692>>>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
52695>>>>>>>
52695>>>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
52695>>>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
52695>>>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
52695>>>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
52696>>>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
52697>>>>>>>
52697>>>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
52697>>>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
52697>>>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
52697>>>>>>>                //     «˜ ¡¨˜«áà ©«˜
52697>>>>>>>                //     previous §œ›å˜ «¦¬ bmove,
52697>>>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
52697>>>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
52698>>>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
52699>>>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
52700>>>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
52701>>>>>>>
52701>>>>>>>                // js 05/09/2002
52701>>>>>>>                Saverecord Barticl
52702>>>>>>>                Saverecord Baxio
52703>>>>>>>
52703>>>>>>>      End_Procedure //deleting
52704>>>>>>>
52704>>>>>>>
52704>>>>>>>      Procedure Save_Main_File
52705>>>>>>>                Forward Send Save_Main_File
52707>>>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
52708>>>>>>>      End_Procedure//save_main_file
52709>>>>>>>
52709>>>>>>>
52709>>>>>>>      Procedure Delete_Main_File
52710>>>>>>>                Integer liTemp
52711>>>>>>>
52711>>>>>>>                Forward Send Delete_Main_File
52713>>>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
52714>>>>>>>
52714>>>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
52714>>>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
52714>>>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
52714>>>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
52716>>>>>>>
52716>>>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
52716>>>>>>>                     //jsjsjs 26/01/2001
52716>>>>>>>                     //Sub 1 from Year.Year_NumBaxio
52716>>>>>>>
52716>>>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
52716>>>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
52719>>>>>>>
52719>>>>>>>                     Delete Baxio
52720>>>>>>>                End
52720>>>>>>>>
52720>>>>>>>      End_Procedure //delete_main_file
52721>>>>>>>
52721>>>>>>>
52721>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
52722>>>>>>>                String lsError_Message
52723>>>>>>>                Case Begin
52723>>>>>>>                     //˜§æ validate save
52723>>>>>>>                     Case (iError_Num = 5555)
52725>>>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
52726>>>>>>>                     Case Break
52727>>>>>>>                     Case (iError_Num = 1001)
52730>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
52731>>>>>>>                     Case Break
52732>>>>>>>                     Case (iError_Num = 1004)
52735>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
52736>>>>>>>                     Case Break
52737>>>>>>>                     Case (iError_Num = 1005)
52740>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
52741>>>>>>>                     Case Break
52742>>>>>>>                     Case (iError_Num = 1006)
52745>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
52746>>>>>>>                     Case Break
52747>>>>>>>                     Case (iError_Num = 1100)
52750>>>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
52751>>>>>>>                     Case Break
52752>>>>>>>
52752>>>>>>>                     //˜§æ validate delete
52752>>>>>>>                     Case (iError_Num = 2001)
52755>>>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
52756>>>>>>>                     Case Break
52757>>>>>>>                     Case (iError_Num = 2100)
52760>>>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
52761>>>>>>>                     Case Break
52762>>>>>>>
52762>>>>>>>                     //˜§æ update
52762>>>>>>>                     Case (iError_Num = 3001)
52765>>>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
52766>>>>>>>                     Case Break
52767>>>>>>>                     Case (iError_Num = 3002)
52770>>>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
52771>>>>>>>                     Case Break
52772>>>>>>>
52772>>>>>>>                     //˜§æ deleting
52772>>>>>>>                     Case (iError_Num = 4002)
52775>>>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
52776>>>>>>>                     Case Break
52777>>>>>>>
52777>>>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
52777>>>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
52780>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52781>>>>>>>                     Case Break
52782>>>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
52785>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52786>>>>>>>                     Case Break
52787>>>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
52790>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52791>>>>>>>                     Case Break
52792>>>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
52795>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52796>>>>>>>                     Case Break
52797>>>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
52800>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52801>>>>>>>                     Case Break
52802>>>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
52805>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52806>>>>>>>                     Case Break
52807>>>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
52810>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52811>>>>>>>                     Case Break
52812>>>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
52815>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52816>>>>>>>                     Case Break
52817>>>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
52820>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52821>>>>>>>                     Case Break
52822>>>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
52825>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52826>>>>>>>                     Case Break
52827>>>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
52830>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52831>>>>>>>                     Case Break
52832>>>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
52835>>>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
52836>>>>>>>                     Case Break
52837>>>>>>>
52837>>>>>>>                     //˜§æ private.trexe (save+delete main file)
52837>>>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
52840>>>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
52841>>>>>>>                     Case Break
52842>>>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
52845>>>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
52846>>>>>>>                     Case Break
52847>>>>>>>
52847>>>>>>>                     Case Else
52847>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
52849>>>>>>>                Case End
52849>>>>>>>
52849>>>>>>>                Error iError_Num lsError_Message
52850>>>>>>>>
52850>>>>>>>      End_Procedure // operation_not_allowed
52851>>>>>>>
52851>>>>>>>
52851>>>>>>>
52851>>>>>>>
52851>>>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
52851>>>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
52851>>>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
52851>>>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
52851>>>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
52851>>>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
52851>>>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
52851>>>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
52851>>>>>>>     //1007
52851>>>>>>>     //1008
52851>>>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
52851>>>>>>>      Function Validate_Save Returns Integer
52852>>>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
52853>>>>>>>
52853>>>>>>>               Forward Get Validate_Save to iReturnVal
52855>>>>>>>
52855>>>>>>>               If (Not(iReturnVal));               Begin
52857>>>>>>>
52857>>>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
52857>>>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
52857>>>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
52857>>>>>>>//                End
52857>>>>>>>
52857>>>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
52857>>>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
52859>>>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
52859>>>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
52859>>>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
52859>>>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
52859>>>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
52859>>>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
52861>>>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
52864>>>>>>>                      End
52864>>>>>>>>
52864>>>>>>>                      Else;                      Begin
52865>>>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
52868>>>>>>>                      End
52868>>>>>>>>
52868>>>>>>>
52868>>>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
52868>>>>>>>                      //If (Not(;
52868>>>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
52868>>>>>>>                      //   )) Send Operation_Not_Allowed 1002
52868>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
52868>>>>>>>>
52868>>>>>>>
52868>>>>>>>
52868>>>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
52868>>>>>>>                Else;                Begin //edit an existing record
52869>>>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
52869>>>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
52872>>>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
52872>>>>>>>>
52872>>>>>>>
52872>>>>>>>/////////////// js 07/08/2001  07-08-2001
52872>>>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
52872>>>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
52872>>>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
52872>>>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
52872>>>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
52872>>>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
52872>>>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
52872>>>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
52872>>>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
52872>>>>>>>/////////////// js 07/08/2001  07-08-2001
52872>>>>>>>
52872>>>>>>>
52872>>>>>>>
52872>>>>>>>
52872>>>>>>>                //1100:cby = globals
52872>>>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
52875>>>>>>>
52875>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
52875>>>>>>>>
52875>>>>>>>               Function_Return iReturnVal
52876>>>>>>>      End_Function //validate_save
52877>>>>>>>
52877>>>>>>>
52877>>>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
52877>>>>>>>      Function Validate_Delete  Returns Integer
52878>>>>>>>               Integer iReturnVal
52879>>>>>>>               Forward Get Validate_Delete  To iReturnVal
52881>>>>>>>               If (Not(iReturnVal));               Begin
52883>>>>>>>
52883>>>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
52883>>>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
52886>>>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
52889>>>>>>>
52889>>>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
52889>>>>>>>>
52889>>>>>>>               Function_Return iReturnVal
52890>>>>>>>      End_Function //validate_delete
52891>>>>>>>
52891>>>>>>>
52891>>>>>>>      Procedure Request_Save
52892>>>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
52893>>>>>>>                String  lsBtypkin_Recr
52893>>>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
52893>>>>>>>                Send private.Initialize_Properties
52894>>>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
52894>>>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
52895>>>>>>>
52895>>>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
52895>>>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
52896>>>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
52897>>>>>>>
52897>>>>>>>                Clear Bkinkat
52898>>>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
52899>>>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
52900>>>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
52901>>>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
52902>>>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
52903>>>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
52904>>>>>>>>
52904>>>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
52906>>>>>>>                                Send Operation_Not_Allowed 3002
52907>>>>>>>                               End
52907>>>>>>>>
52907>>>>>>>
52907>>>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
52909>>>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
52910>>>>>>>                      Set piCan_Create_Baxio                                 to TRUE
52911>>>>>>>                     End
52911>>>>>>>>
52911>>>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
52912>>>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
52913>>>>>>>                      Set piCan_Create_Baxio                                 to FALSE
52914>>>>>>>                     End
52914>>>>>>>>
52914>>>>>>>
52914>>>>>>>                Forward Send Request_Save
52916>>>>>>>
52916>>>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
52916>>>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
52917>>>>>>>                Set Smart_Filemode_State to True
52918>>>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
52918>>>>>>>                Send private.Initialize_Properties
52919>>>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
52919>>>>>>>                Indicate Err False
52920>>>>>>>      End_Procedure //request_save
52921>>>>>>>
52921>>>>>>>
52921>>>>>>>      Procedure Request_Delete
52922>>>>>>>                Integer iErrorObj
52923>>>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
52924>>>>>>>                Forward Send Request_Delete
52926>>>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
52927>>>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
52927>>>>>>>                Indicate Err False
52928>>>>>>>      End_Procedure   //request_delete
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
52929>>>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
52929>>>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
52929>>>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
52929>>>>>>>//      Procedure private.Transaction_Update_Other_Modules
52929>>>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
52929>>>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
52929>>>>>>>
52929>>>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
52929>>>>>>>//                String lsBaxiokat_Recr
52929>>>>>>>
52929>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
52929>>>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
52929>>>>>>>
52929>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
52929>>>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
52929>>>>>>>
52929>>>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
52929>>>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
52929>>>>>>>
52929>>>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
52929>>>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
52929>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
52929>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
52929>>>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
52929>>>>>>>
52929>>>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
52929>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
52929>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
52929>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
52929>>>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//                //                                                  s  l  a  v  e  = bsum
52929>>>>>>>//                //                                        edit        create        delete
52929>>>>>>>//                //                                       -----        ------        ------
52929>>>>>>>//                // master garticl + gmove     edit         x            x              x
52929>>>>>>>//                //                            create                    x
52929>>>>>>>//                //                            delete                                   x
52929>>>>>>>//                // slave  gmove               edit         x            x              x
52929>>>>>>>//                //                            create                    x
52929>>>>>>>//                //                            delete                                   x
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//                If (;
52929>>>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
52929>>>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
52929>>>>>>>//                   );
52929>>>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
52929>>>>>>>//                //***************************************************************************
52929>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
52929>>>>>>>//                //***************************************************************************
52929>>>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
52929>>>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
52929>>>>>>>
52929>>>>>>>//// jsjsjs 24/01/2001
52929>>>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
52929>>>>>>>////                                                                                    liFlag02;
52929>>>>>>>////                                                                                    liFlag03;
52929>>>>>>>////                                                                                    liFlag04;
52929>>>>>>>////                                                                                    liFlag05
52929>>>>>>>//// jsjsjs 24/01/2001
52929>>>>>>>
52929>>>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
52929>>>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
52929>>>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
52929>>>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
52929>>>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
52929>>>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
52929>>>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
52929>>>>>>>
52929>>>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
52929>>>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
52929>>>>>>>//                Clear Barticl
52929>>>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
52929>>>>>>>//                Find Eq Barticl.Recnum
52929>>>>>>>//                If (Found = 0);
52929>>>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
52929>>>>>>>//                      Send Operation_Not_Allowed 5001
52929>>>>>>>//                End
52929>>>>>>>
52929>>>>>>>//                //=======================================================================
52929>>>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
52929>>>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
52929>>>>>>>//                If ((piUpdate(Self)) = TRUE);
52929>>>>>>>//                Begin
52929>>>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
52929>>>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
52929>>>>>>>//                     Clear Bsum
52929>>>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
52929>>>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
52929>>>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
52929>>>>>>>//                     If (Found=0);
52929>>>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
52929>>>>>>>//                           Send Operation_Not_Allowed 5002
52929>>>>>>>//                     End
52929>>>>>>>
52929>>>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
52929>>>>>>>//                     Case Begin
52929>>>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
52929>>>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
52929>>>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
52929>>>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
52929>>>>>>>//                               If (;
52929>>>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
52929>>>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
52929>>>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
52929>>>>>>>//                               If (;
52929>>>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
52929>>>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
52929>>>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
52929>>>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
52929>>>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
52929>>>>>>>//                               Saverecord Barticl
52929>>>>>>>//                          Case Break
52929>>>>>>>
52929>>>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
52929>>>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
52929>>>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
52929>>>>>>>//                          Case Else
52929>>>>>>>//                               If (;
52929>>>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
52929>>>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
52929>>>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
52929>>>>>>>//                               If (;
52929>>>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
52929>>>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
52929>>>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
52929>>>>>>>//                          Case Break
52929>>>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
52929>>>>>>>
52929>>>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
52929>>>>>>>//                     Case Begin
52929>>>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
52929>>>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
52929>>>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
52929>>>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
52929>>>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
52929>>>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
52929>>>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
52929>>>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
52929>>>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
52929>>>>>>>//                               Saverecord Bsum
52929>>>>>>>//                          Case Break
52929>>>>>>>
52929>>>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
52929>>>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
52929>>>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
52929>>>>>>>//                          Case Else
52929>>>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
52929>>>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
52929>>>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
52929>>>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
52929>>>>>>>//                          Case Break
52929>>>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
52929>>>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
52929>>>>>>>//                //=======================================================================
52929>>>>>>>
52929>>>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
52929>>>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
52929>>>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
52929>>>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
52929>>>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
52929>>>>>>>//                Begin
52929>>>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
52929>>>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
52929>>>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
52929>>>>>>>//                     If (;
52929>>>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
52929>>>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
52929>>>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
52929>>>>>>>//                     If (;
52929>>>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
52929>>>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
52929>>>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
52929>>>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
52929>>>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
52929>>>>>>>//                     Saverecord Barticl
52929>>>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                End //if (liMust_Update_Gl > 0) and ...
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//                If (liMust_Update_CUSTOMER > 0);
52929>>>>>>>//                Begin
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//                If (liMust_Update_VENDOR  > 0);
52929>>>>>>>//                Begin
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
52929>>>>>>>//                //****************************************************************************
52929>>>>>>>//                End //if (liMust_Update_VENDOR > 0)
52929>>>>>>>
52929>>>>>>>//      End_Procedure //private.transaction_update_other_modules
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
52929>>>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
52929>>>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
52929>>>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
52929>>>>>>>
52929>>>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
52929>>>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
52929>>>>>>>
52929>>>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
52929>>>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
52929>>>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
52929>>>>>>>
52929>>>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
52929>>>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>               //Forward Send Request_Save
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>
52929>>>>>>>//--------------------------------------------------------------------------------
52929>>>>>>>    Procedure Define_Fields
52930>>>>>>>        Forward Send Define_Fields
52932>>>>>>>        //DDB-Generated-Code-Location
52932>>>>>>>        //DDB-DefineFieldStart
52932>>>>>>>
52932>>>>>>>        Set Main_File            To Bmove.File_Number
52933>>>>>>>        Set Cascade_Delete_State To FALSE
52934>>>>>>>
52934>>>>>>>
52934>>>>>>>        // Parent (Server) file structure...............
52934>>>>>>>        Send Add_Server_File  Barticl.File_Number
52935>>>>>>>        Send Add_Server_File  Baxio.File_Number
52936>>>>>>>
52936>>>>>>>        // External (System) file structure.............
52936>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
52937>>>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
52938>>>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
52939>>>>>>>
52939>>>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
52942>>>>>>>
52942>>>>>>>        // Field-based properties.......................
52942>>>>>>>
52942>>>>>>>        // Bmove.Company_Code
52942>>>>>>>
52942>>>>>>>        // Bmove.Branch_Code
52942>>>>>>>
52942>>>>>>>        // Bmove.Year_Year
52942>>>>>>>
52942>>>>>>>        // Bmove.Btypkin_Code
52942>>>>>>>
52942>>>>>>>        // Bmove.Barticl_Hmnia
52942>>>>>>>
52942>>>>>>>        // Bmove.Barticl_No
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Code
52942>>>>>>>
52942>>>>>>>        // Bmove.Barticl_Recr
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Recr
52942>>>>>>>
52942>>>>>>>        // Bmove.Bmove_Rec0
52942>>>>>>>
52942>>>>>>>        // Bmove.Bmove_Recr
52942>>>>>>>
52942>>>>>>>        // Bmove.Bmove_Aa
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Aa
52942>>>>>>>
52942>>>>>>>        // Bmove.Gplan_Srec0
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Pfile
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Pcode
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Pepon
52942>>>>>>>
52942>>>>>>>        // Bmove.Baxio_Ppar
52942>>>>>>>
52942>>>>>>>        // Bmove.Btypkin_Recr
52942>>>>>>>
52942>>>>>>>        // Bmove.Sls_Id
52942>>>>>>>
52942>>>>>>>        // Bmove.Cnt_Id
52942>>>>>>>
52942>>>>>>>        // Bmove.Presp_Id
52942>>>>>>>
52942>>>>>>>        // Bmove.Bmove_M_Code
52942>>>>>>>
52942>>>>>>>        // Bmove.Cmoves_Recr
52942>>>>>>>
52942>>>>>>>        // Bmove.Exei_Enhmerosei
52942>>>>>>>
52942>>>>>>>        // Bmove.Hmnia_Enhmeros
52942>>>>>>>
52942>>>>>>>        //DDB-DefineFieldEnd
52942>>>>>>>
52942>>>>>>>        Set Main_File            To Bmove.File_Number
52943>>>>>>>        Set Cascade_Delete_State To FALSE
52944>>>>>>>
52944>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
52945>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
52946>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
52947>>>>>>>
52947>>>>>>>        // Parent (Server) file structure...............
52947>>>>>>>        Send Add_Server_File  Baxio.File_Number
52948>>>>>>>        Send Add_Server_File  Barticl.File_Number
52949>>>>>>>
52949>>>>>>>        // External (System) file structure.............
52949>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
52950>>>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
52951>>>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
52952>>>>>>>
52952>>>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
52955>>>>>>>
52955>>>>>>>        // Field-based properties.......................
52955>>>>>>>
52955>>>>>>>        // Bmove.Company_Code
52955>>>>>>>
52955>>>>>>>        // Bmove.Branch_Code
52955>>>>>>>
52955>>>>>>>        // Bmove.Year_Year
52955>>>>>>>
52955>>>>>>>        // Bmove.Btypkin_Code
52955>>>>>>>
52955>>>>>>>        // Bmove.Barticl_Hmnia
52955>>>>>>>
52955>>>>>>>        // Bmove.Barticl_No
52955>>>>>>>
52955>>>>>>>        // Bmove.Barticl_Rec0
52955>>>>>>>
52955>>>>>>>        // Bmove.Baxio_Rec0
52955>>>>>>>
52955>>>>>>>        // Bmove.Bmove_Rec0
52955>>>>>>>
52955>>>>>>>        // Bmove.Bmove_Aa
52955>>>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
52956>>>>>>>
52956>>>>>>>        // Bmove.Baxio_Aa
52956>>>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
52957>>>>>>>
52957>>>>>>>        // Bmove.Gplan_Srec0
52957>>>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
52958>>>>>>>
52958>>>>>>>        // Bmove.Baxio_Pfile
52958>>>>>>>
52958>>>>>>>        // Bmove.Baxio_Pcode
52958>>>>>>>
52958>>>>>>>        // Bmove.Baxio_Pepon
52958>>>>>>>
52958>>>>>>>        // Bmove.Baxio_Ppar
52958>>>>>>>
52958>>>>>>>    End_Procedure    // Define_Fields
52959>>>>>>>
52959>>>>>>>
52959>>>>>>>    Procedure Field_Defaults
52960>>>>>>>        Forward Send Field_Defaults
52962>>>>>>>        //DDB-Generated-Code-Location
52962>>>>>>>        //DDB-FieldDefaultStart
52962>>>>>>>        //DDB-FieldDefaultEnd
52962>>>>>>>    End_Procedure    // Field_Defaults
52963>>>>>>>
52963>>>>>>>End_Class    // Bmove_DataDictionary
52964>>>>>>>//DDB-FileEnd
52964>>>>>    Use NOMISMA.DD
52964>>>>>
52964>>>>>    //AB-IgnoreEnd
52964>>>>>
52964>>>>>    Object bpencmv3 is a BusinessProcessSub
52966>>>>>
52966>>>>>        //AB-StoreTopStart
52966>>>>>        Property String      psModule        Public ''
52968>>>>>        Property String      psBarticleRecr  Public ''
52970>>>>>        Property String      psCmovesRecr    Public ''
52972>>>>>        Property Integer     piWithDeletion  Public  0
52974>>>>>        Property Integer     piLathos        Public  0
52976>>>>>        Property Integer     piTxtID         Public  0
52978>>>>>        Property String      piBarticleRecn  Public  0
52980>>>>>
52980>>>>>
52980>>>>>        ////////////////////////////////////////////////////////////
52980>>>>>        /////////// Extra Data Set Needed For Finding //////////////
52980>>>>>        /////////// Incoming Bmove Record             //////////////
52980>>>>>        ////////////////////////////////////////////////////////////
52980>>>>>
52980>>>>>        Set Status_Panel_State to False
52981>>>>>        //Set Allow_Cancel_State  to True
52981>>>>>        Set Display_Error_State to True
52982>>>>>        //Set Process_Title to "               "
52982>>>>>        //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
52982>>>>>        //Set Status_log_state to True
52982>>>>>
52982>>>>>        //AB-StoreTopEnd
52982>>>>>
52982>>>>>        Set Size        to 58 88
52983>>>>>        Set Location    to 18 52
52984>>>>>
52984>>>>>        //AB-DDOStart
52984>>>>>
52984>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
52986>>>>>        End_Object    // Ctypkin_DD
52987>>>>>
52987>>>>>        Object Country_DD is a Country_DataDictionary
52989>>>>>        End_Object    // Country_DD
52990>>>>>
52990>>>>>        Object Towns_DD is a Towns_DataDictionary
52992>>>>>            Set DDO_Server to (Country_DD(self))
52993>>>>>        End_Object    // Towns_DD
52994>>>>>
52994>>>>>        Object Cities_DD is a Cities_DataDictionary
52996>>>>>            Set DDO_Server to (Towns_DD(self))
52997>>>>>        End_Object    // Cities_DD
52998>>>>>
52998>>>>>        Object Payresp_DD is a Payresp_DataDictionary
53000>>>>>        End_Object    // Payresp_DD
53001>>>>>
53001>>>>>        Object Areas_DD is a Areas_DataDictionary
53003>>>>>        End_Object    // Areas_DD
53004>>>>>
53004>>>>>        Object Clients_DD is a Clients_DataDictionary
53006>>>>>            Set DDO_Server to (Cities_DD(self))
53007>>>>>            Set DDO_Server to (Payresp_DD(self))
53008>>>>>            Set DDO_Server to (Areas_DD(self))
53009>>>>>        End_Object    // Clients_DD
53010>>>>>
53010>>>>>        Object Cmoves_DD is a Cmoves_DataDictionary
53012>>>>>            Set DDO_Server  to (Ctypkin_DD(self))
53013>>>>>            Set DDO_Server  to (Clients_DD(self))
53014>>>>>            Set piFromBP    to 1
53015>>>>>        End_Object    // Cmoves_DD
53016>>>>>
53016>>>>>        Object Cflagkin_DD is a Cflagkin_DataDictionary
53018>>>>>            Set DDO_Server to (Ctypkin_DD(self))
53019>>>>>        End_Object    // Cflagkin_DD
53020>>>>>
53020>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
53022>>>>>        End_Object    // Btypkin_DD
53023>>>>>
53023>>>>>        Object Baxiokat_DD is a Baxiokat_DataDictionary
53025>>>>>        End_Object    // Baxiokat_DD
53026>>>>>
53026>>>>>        Object Barticl_DD is a Barticl_DataDictionary
53028>>>>>            Set DDO_Server to (Btypkin_DD(self))
53029>>>>>        End_Object    // Barticl_DD
53030>>>>>
53030>>>>>        Object Baxio_DD is a Baxio_DataDictionary
53032>>>>>            Set DDO_Server to (Baxiokat_DD(self))
53033>>>>>        End_Object    // Baxio_DD
53034>>>>>
53034>>>>>        Object Bmove_DD is a Bmove_DataDictionary
53036>>>>>            Set DDO_Server to (Barticl_DD(self))
53037>>>>>            Set DDO_Server to (Baxio_DD(self))
53038>>>>>            Set Constrain_File to Barticl.File_Number
53039>>>>>        End_Object    // Bmove_DD
53040>>>>>
53040>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53042>>>>>        End_Object    // Nomisma_DD
53043>>>>>
53043>>>>>        //AB-DDOEnd
53043>>>>>
53043>>>>>
53043>>>>>        //AB-StoreStart
53043>>>>>
53043>>>>>        Function fiDelete_Cmoves_Record String asRecr Integer aiDelete Returns Integer
53045>>>>>            Integer rVal iErr
53046>>>>>            date dsaphmnia
53046>>>>>            Move 0 to rVal
53047>>>>>            Send Clear to Cmoves_DD
53048>>>>>            Move asRecr to Cmoves.Cmoves_Recr
53049>>>>>            Send Find to Cmoves_DD eq 2 //Cmoves:Index.2:Cmoves_Recr
53050>>>>>            If (Found=1) Begin
53052>>>>>                If (aiDelete) Begin
53054>>>>>                    Send UpdateWait to (Wait(Self))  ('ƒ ˜š¨˜­ã ‰å¤ž©žª '+(String(Cmoves.Recnum)))
53055>>>>>                    Get Field_Current_Value Of Cmoves_DD Field Cmoves.sap_hmnia to dsaphmnia
53056>>>>>                    if (dsaphmnia gt '01/01/1980') ;                        error 6063 '„®œ  œ¤ž£œ¨àŸœå SAP! ƒœ¤ œ¡¢œ ›é¤œ  !!'
53059>>>>>                    Else;                        Send Request_Delete to Cmoves_DD
53061>>>>>                End
53061>>>>>>
53061>>>>>            End
53061>>>>>>
53061>>>>>            Else Begin
53062>>>>>                Move 60003 to rVal
53063>>>>>                // If From Deletion and Could not find Cmoves with Barticle_Cmoves_Recr set piLathos
53063>>>>>                If (aiDelete) error 6003 "ƒœ¤ ™¨âŸž¡œ Cmoves £œ «¦ Cmoves Recr «¦¬ §˜¨˜©«˜« ¡¦ç"
53066>>>>>            End
53066>>>>>>
53066>>>>>            Function_Return rVal
53067>>>>>        End_Function
53068>>>>>
53068>>>>>        Procedure Deal_With_Barticle
53070>>>>>            Integer iErr isClosed iInt iWithDeletion iSign iClient iID iMustSaveClientYpoloipa
53071>>>>>            Integer iEpireazeiAxies iMustEnhmWitemcl  iEpireazeiPosothtes iAntistrofhProshmou iBmoveRec0
53071>>>>>            Integer iOneWflag iiPartlNO iExitFlag iMustSaveWCmoves iExeiSxetika iBmoveRecnum iMustSaveEpisf
53071>>>>>            Integer iMustSaveCmoves iMustSaveClient iMyf iInt2 iOneCflag iAnti iiBarticleNO iMustsaveofeilh
53071>>>>>
53071>>>>>            String  ssPtypparDescr ssSeiraDescr sWCmovesRecr sRecr2 ssPtypparDescrShort sPelaths
53071>>>>>            String  sRecr sParticle_CmovesRecr sCtypkinRecr sCn_Code sSls_ID sCnt_ID sPresp_ID
53071>>>>>            String  sClientRecr sCmovesRecr sNomisma sFlag sWtypkinRecr sItem sLocked sModule sBmoveRecr
53071>>>>>            String  sWitemxRecr sWaxRecr sClientID sPerigrafh sParticle_WCmovesRecr ssBtypkinDescrShort
53071>>>>>
53071>>>>>            Number  nVatam nGenAm nExtra nPayam nDiscAm nIsotimia nUnitPrice nGSynolo
53071>>>>>            Number  nTotAmBd nTotDiscPms nTotDiscPC nTotAmAd nActualXreosh nActualPistosh
53071>>>>>            Number  nAthr1 nAthr2 nAthr3 nAthr4 nAthr5 nAthr6 nParastXreosh nParastPistosh
53071>>>>>            Number  nPoso nXre nPis nMyf nPosothta nAthr7 nAthr8 nPosothtaFinal nXreFinal nPisFinal
53071>>>>>            Number  nApait nEpitPoso nofeilh nofeilhpayresp napaitpayresp
53071>>>>>            Date    dHmnia dLastPis dLastXre dLastXreParast dLastPisParast
53071>>>>>
53071>>>>>            Number nQtyEisFinal nQtyExFinal nQtyEis nQtyEx nJS
53071>>>>>
53071>>>>>
53071>>>>>            Get psBarticleRecr  to sRecr
53072>>>>>            Move (Trim(sRecr))  to sRecr
53073>>>>>            Send Clear          to Barticl_DD
53074>>>>>            Move srecr          to Barticl.Barticl_Recr
53075>>>>>            Send Find to Barticl_DD Eq 2 // Barticl:Index.2:Barticl_Recr
53076>>>>>// todo: 25/06/2002 Logo tou find ktypaei to gamhmeno mhnyma otan kleinei h efarmogh
53076>>>>>// omos kammia allagh me opoiadhpote tropopoihsh tou kodika, eite kanoume manual find prota,
53076>>>>>// eite find_by_recnum. Opoiadhpote find mh procedural ektelestei exei to idio apotelesma
53076>>>>>
53076>>>>>//          Send Find_By_Recnum to Barticl_DD Barticl.File_Number (piBarticleRecn(Self))
53076>>>>>
53076>>>>>            If (Found=1) Begin
53078>>>>>                Get Field_Current_Value Of Btypkin_DD Field Btypkin.Btypkin_anti1   to iAnti
53079>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.Barticl_Ekleise to isClosed
53080>>>>>                Get Field_Current_Value Of Barticl_DD Field Barticl.CN_Code         to sCN_Code
53081>>>>>
53081>>>>>                If (isClosed) Begin
53083>>>>>                    Move 0 to iExitFlag
53084>>>>>
53084>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
53085>>>>>                    While ((Found=1) And (iExitFlag=0))
53089>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
53090>>>>>                        Move (Trim(sRecr2)) to sRecr2
53091>>>>>                        If (Not(sRecr2='')) Move (fiDelete_Cmoves_Record(Self,sRecr2,1))  to iInt2
53094>>>>>                        Else                Move 0 to iInt2
53096>>>>>
53096>>>>>                        Send Clear to Ctypkin_DD
53097>>>>>                        Get Field_Current_Value Of Btypkin_DD Field Btypkin.Ctypkin_Recr to sCtypkinRecr
53098>>>>>                        Move 0 to iMustSaveEpisf
53099>>>>>                        Clear Cflagkin
53100>>>>>                        Move sCtypkinRecr to Cflagkin.Ctypkin_Recr
53101>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
53102>>>>>>
53102>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
53106>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
53107>>>>>                            Move (Trim(sFlag)) to sFlag
53108>>>>>                                 If (sFlag='60') Move 1 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Thetika
53111>>>>>                            Else If (sFlag='61') Move 2 to iMustSaveEpisf   // Enhmeronei Episfalh Posa Arnhtika
53115>>>>>                            Else If (sflag='66') Move 1 to iMustsaveofeilh  // enhmerovnei synolikh ofeilh
53119>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
53120>>>>>>
53120>>>>>                        Loop
53121>>>>>>
53121>>>>>
53121>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
53123>>>>>                            Move 0  to nApait
53124>>>>>                            Move 0  to nEpitPoso
53125>>>>>                            Move 0  to nofeilh
53126>>>>>                            Move 0  to nofeilhpayresp
53127>>>>>                            Move 0  to napaitpayresp
53128>>>>>                            Move '' to sPelaths
53129>>>>>
53129>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
53129>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
53130>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
53131>>>>>
53131>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
53131>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
53131>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
53131>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
53131>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
53134>>>>>                            // js 13/03/2003
53134>>>>>
53134>>>>>                            Send Clear to Clients_DD
53135>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
53136>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
53137>>>>>                            If (Found=1) Begin
53139>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
53140>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
53141>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
53142>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
53143>>>>>
53143>>>>>                                If (iMustSaveofeilh=1)  Begin
53145>>>>>//                                    Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nepitposo+nofeilh)
53145>>>>>//                                    Send Request_Save to Clients_DD
53145>>>>>//                                    Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nepitposo+nofeilhpayresp)
53145>>>>>//                                    Send Request_Save to payresp_DD
53145>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
53147>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
53148>>>>>                                        Send Request_Save to Clients_DD
53149>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
53150>>>>>                                        Send Request_Save to payresp_DD
53151>>>>>                                    End
53151>>>>>>
53151>>>>>                                    Else Begin
53152>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
53153>>>>>                                        Send Request_Save to Clients_DD
53154>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
53155>>>>>                                        Send Request_Save to payresp_DD
53156>>>>>                                    End
53156>>>>>>
53156>>>>>                                End
53156>>>>>>
53156>>>>>
53156>>>>>                                If (iMustSaveEpisf=1)  Begin
53158>>>>>                                    Sub nEpitPoso from nApait
53159>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
53160>>>>>                                    Send Request_Save to Clients_DD
53161>>>>>                                    Sub nepitposo from napaitpayresp
53162>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
53163>>>>>                                    Send Request_Save to payresp_DD
53164>>>>>                                End
53164>>>>>>
53164>>>>>                                Else If (iMustSaveEpisf=2)  Begin
53167>>>>>                                    Sub (nEpitPoso*(-1)) to nApait
53168>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
53169>>>>>                                    Send Request_Save to Clients_DD
53170>>>>>                                    Sub (nEpitPoso*(-1)) to nApaitpayresp
53171>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
53172>>>>>                                    Send Request_Save to payresp_DD
53173>>>>>                                End
53173>>>>>>
53173>>>>>                            End
53173>>>>>>
53173>>>>>                            Else Begin
53174>>>>>                            End
53174>>>>>>
53174>>>>>                        End
53174>>>>>>
53174>>>>>
53174>>>>>                        If (iInt2<>0) Move iInt2 to iExitFlag
53177>>>>>                        Else Begin
53178>>>>>                            Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
53179>>>>>                            Set Field_Changed_Value Of Bmove_DD Field Bmove.Cmoves_Recr to ''
53180>>>>>                            Send Request_Save to Bmove_DD
53181>>>>>                        End
53181>>>>>>
53181>>>>>                        Send Find To Bmove_DD Next_Record 3 //Bmoves:Index.3:Barticl_Recr + Bmove_Rec0
53182>>>>>                    Loop
53183>>>>>>
53183>>>>>
53183>>>>>
53183>>>>>
53183>>>>>                    If (iExitFlag) Move iExitFlag   to iInt2
53186>>>>>                    Else           Move 0           to iInt2
53188>>>>>
53188>>>>>                    If (Not(iInt2)) Begin
53190>>>>>                        // €¤ ›œ¤ ®«¬§ž©œ ¢˜Ÿ¦ª ¡˜«˜ «ž¤ › ˜š¨˜­ž ¡˜  › œš¨˜­œ  ©à©«˜ «¦ Cmoves ¡˜  «¦ Wcmoves record
53190>>>>>                        // «¦«œ ¡˜Ÿ˜¨ ¦¬£œ «¦ Barticle ˜§¦ ©ž£á› ˜ Cmoves kai Wcmoves
53190>>>>>                        // ¡˜  ¥œ£˜¨¡˜¨¦¬£œ «¦ record Barticle àª ‹† ‰¢œ ©«æ §¢â¦¤
53190>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr         to ''
53191>>>>>                        Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise     to ''
53192>>>>>                        Send Request_Save to Barticl_DD
53193>>>>>                        //Send info_box "’¦ §˜¨˜©«˜« ¡æ œå¤˜  «é¨˜ ˜¤¦ ®«æ.\n„§ «¨â§œ«œ ž «¨¦§¦§¦åž©ž «¦¬" '¢ž¨¦­¦¨å˜'
53193>>>>>                    End
53193>>>>>>
53193>>>>>                    Else Begin
53194>>>>>                        // •«¬§ž©œ ¢˜Ÿ¦ª ©«ž¤ › ˜š¨˜­ž WCmoves
53194>>>>>                        error 6111 "ƒœ¤ ™¨âŸž¡œ Cmoves š ˜ › ˜š¨˜­ã"
53195>>>>>>
53195>>>>>                    End
53195>>>>>>
53195>>>>>
53195>>>>>                End
53195>>>>>>
53195>>>>>                //// IF IS NOT CLOSED (Barticle)
53195>>>>>                Else Begin
53196>>>>>                    Integer iiRecn
53196>>>>>                    Move 0 to iExitFlag
53197>>>>>                    Send Clear To Bmove_DD
53198>>>>>                    Send Find To Bmove_DD First_Record 3 //Bmove:Index.3:Barticl_Recr+Bmove_Rec0
53199>>>>>                    While ((Found=1) And (iExitFlag=0))
53203>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Recnum to iiRecn
53204>>>>>                        Move 0 to iInt
53205>>>>>                        Get Field_Current_Value Of Bmove_DD Field Bmove.Cmoves_Recr to sRecr2
53206>>>>>                        Move (Trim(sRecr2)) to sRecr2
53207>>>>>                        If (Not(sRecr2='')) Begin
53209>>>>>                            Move (fiDelete_Cmoves_Record(Self,sRecr2,0))  to iInt
53210>>>>>                            If (iInt<>60003) Move 1 to iExitFlag
53213>>>>>                        End
53213>>>>>>
53213>>>>>                        Send Find To Bmove_DD Next_Record 3
53214>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
53215>>>>>                    Loop
53216>>>>>>
53216>>>>>
53216>>>>>                    If (iExitFlag) Begin
53218>>>>>                        error 6100  "Found Cmoves Record on Open Barticl"
53219>>>>>>
53219>>>>>                    End
53219>>>>>>
53219>>>>>
53219>>>>>
53219>>>>>
53219>>>>>                    //////////////////////////jsjsjsjsjsjsjsjs
53219>>>>>                    Send Find To Bmove_DD First_Record 3 // Bmove:Index.2:Bmove_Recr
53220>>>>>
53220>>>>>                    While (Found=1)
53224>>>>>
53224>>>>>                        Send Clear to Ctypkin_DD
53225>>>>>                        Send Clear to Cflagkin_DD
53226>>>>>                        Send Clear to Clients_DD
53227>>>>>                        Send Clear to Cmoves_DD
53228>>>>>
53228>>>>>                        Get Field_Current_Value Of Btypkin_DD   Field Btypkin.Ctypkin_Recr  to sCtypkinRecr
53229>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Client_Mrecr  to sClientRecr
53230>>>>>                        move sclientrecr to clients.client_recr
53231>>>>>                        Send Find to Clients_DD eq 2 //Clients:Index.2:Client_Recr
53232>>>>>
53232>>>>>                        If (Not(Found)) Begin
53234>>>>>                            If ((iAnti=2) Or (iAnti=3)) error 5005 "Client record not found"
53237>>>>>                             ///// Else Goto Skip_All_Ctypkin
53237>>>>>                            ///// @@##@@ 21/12/2001 yannis
53237>>>>>                            ///// h allagh ayth egine gia na mporoume na enhmeronoume
53237>>>>>                            ///// kartella pelath apo episfalh posa opote kai prepei
53237>>>>>                            ///// na diabazei ta cflags
53237>>>>>                        End
53237>>>>>>
53237>>>>>
53237>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
53238>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
53239>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
53242>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia     to dHmnia
53243>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Aitiol    to sPerigrafh
53244>>>>>            //                    Get Field_Current_Value Of Barticl_DD   Field Barticl.Isotimia          to nIsotimia
53244>>>>>                        Get Field_Current_Value Of Ctypkin_DD   Field Ctypkin.Ctypkin_Module    to sModule
53245>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Sls_ID            to sSls_ID
53246>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Cnt_ID            to sCnt_ID
53247>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Presp_ID          to sPresp_ID
53248>>>>>
53248>>>>>                        Move 1 to iSign // Always 'Update'
53249>>>>>                        Move 0 to iOneCflag
53250>>>>>                        Move 0 to iMustSaveCmoves
53251>>>>>                        Move 0 to iMustSaveClient
53252>>>>>                        Move 0 to iMustSaveClientYpoloipa
53253>>>>>                        Move 0 to iMustSaveEpisf
53254>>>>>                        Move 0 to iAntistrofhProshmou
53255>>>>>                        Move 0 to imustsaveofeilh
53256>>>>>
53256>>>>>                        Send UpdateWait to (Wait(Self)) ('„¤ž£œ¨à©ž ‰å¤ž©žª '+(String(Bmove.Recnum)))
53257>>>>>
53257>>>>>                        Move 0 to iOneWflag
53258>>>>>                        Move 0 to iMustSaveWCmoves
53259>>>>>                        Move 0 to nPosothtaFinal
53260>>>>>                        Move 0 to nXreFinal
53261>>>>>                        Move 0 to nPisFinal
53262>>>>>                        Move 0 to iEpireazeiAxies
53263>>>>>                        Move 0 to iEpireazeiPosothtes
53264>>>>>                        Move 0 to nXre
53265>>>>>                        Move 0 to nPis
53266>>>>>                        Move 0 to nQtyEis
53267>>>>>                        Move 0 to nQtyEx
53268>>>>>                        Move 0 to iMustEnhmWitemcl
53269>>>>>
53269>>>>>
53269>>>>>                        Get Field_Current_Value Of Bmove_DD   Field Bmove.Bmove_Recr     to sBmoveRecr
53270>>>>>
53270>>>>>                        Get Field_Current_Value Of Baxio_DD   Field Baxio.Baxio_C_Code2  to sNomisma
53271>>>>>                        Move (Trim(sNomisma))   to sNomisma
53272>>>>>                        Move sNomisma to Nomisma.Nomisma_Code
53273>>>>>                        Send Find to Nomisma_DD eq 1 //Nomisma:Index.1:Nomisma_Code
53274>>>>>                        If (Not(Found)) Begin
53276>>>>>                            error 20000 "ƒœ¤ ™¨âŸž¡œ «¦ ¤æ£ ©£˜"
53277>>>>>>
53277>>>>>                        End
53277>>>>>>
53277>>>>>
53277>>>>>                        Get Field_Current_Value Of Baxio_DD     Field Baxio.Baxio_V2        to nPoso
53278>>>>>                        Get Field_Current_Value Of Barticl_DD   Field Barticl.Barticl_Hmnia to dHmnia
53279>>>>>                        Move 1                                                              to nPosothta
53280>>>>>
53280>>>>>                        Move 0 to iAntistrofhProshmou
53281>>>>>
53281>>>>>                        Clear Cflagkin
53282>>>>>                        Move sCtypkinRecr           to Cflagkin.Ctypkin_Recr
53283>>>>>                        Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
53284>>>>>>
53284>>>>>
53284>>>>>                        While ((Found=1) And (sCtypkinRecr=Cflagkin.Ctypkin_Recr))
53288>>>>>
53288>>>>>                            Move 1 to iOneCflag
53289>>>>>                            Move Cflagkin.Cflagkin_Flag to sFlag
53290>>>>>                            Move (Trim(sFlag)) to sFlag
53291>>>>>
53291>>>>>                            Case Begin
53291>>>>>                                Case (sFlag='1')
53293>>>>>                                    Move 1 to iMustSaveCmoves
53294>>>>>                                Case Break
53295>>>>>                                Case (sFlag='2') // Antistrofh Proshmou
53298>>>>>                                    Move (nPoso*iSign*(-1)) to nPoso
53299>>>>>                                    Move 1 to iAntistrofhProshmou
53300>>>>>                                Case Break
53301>>>>>                                Case (sFlag='3') // Epireazei xreoseis
53304>>>>>                                    Move (nPoso*iSign)  to nXre
53305>>>>>                                    Move 0              to nPis
53306>>>>>                                Case Break
53307>>>>>                                Case (sFlag='4') // Epireazei pistoseis
53310>>>>>                                    Move (nPoso*iSign)  to nPis
53311>>>>>                                    Move 0              to nXre
53312>>>>>                                Case Break
53313>>>>>                                Case (sFlag='5') // Epireazei Hmeromhnies
53316>>>>>                                    Move 1 to iMustSaveClient
53317>>>>>                                    If (nXre<>0) Begin
53319>>>>>                                        Move dHmnia to dLastXre
53320>>>>>                                        Move dHmnia to dLastXreParast
53321>>>>>                                        Move ''     to dLastPis
53322>>>>>                                        Move ''     to dLastPisParast
53323>>>>>                                    End
53323>>>>>>
53323>>>>>                                    Else If (nPis<>0) Begin
53326>>>>>                                        Move dHmnia to dLastPis
53327>>>>>                                        Move dHmnia to dLastPisParast
53328>>>>>                                        Move ''     to dLastXre
53329>>>>>                                        Move ''     to dLastXreParast
53330>>>>>                                    End
53330>>>>>>
53330>>>>>                                Case Break
53331>>>>>                                Case (sFlag='6') // Epireazei Hmeromhnia teleytaias paraggelias
53334>>>>>                                Case Break
53335>>>>>                                Case (sFlag='7') // Epireazei ekkremh axiografa
53338>>>>>                                Case Break
53339>>>>>                                Case (sFlag='8') // Epireazei Diamartyrhmena
53342>>>>>                                Case Break
53343>>>>>                                Case (sFlag='9') // Epireazei Tziro
53346>>>>>                                Case Break
53347>>>>>                                Case (sFlag='10') // Epireazei Apografh xreoshs
53350>>>>>                                Case Break
53351>>>>>                                Case (sFlag='11') // Epireazei Apografh Pistosh
53354>>>>>                                Case Break
53355>>>>>                                Case (sFlag='12') // Symmetoxh se MYF (Plythos)
53358>>>>>                                    Move iSign to iMyf
53359>>>>>                                Case Break
53360>>>>>                                Case (sFlag='13') // Symmetoxh se MYF (Axia)
53363>>>>>                                    Move (nPoso*iSign)  to nMyf
53364>>>>>                                Case Break
53365>>>>>                                Case (sFlag='14') // Axies se Xeno sma
53368>>>>>                                    // Blepe sxetika erothmata sthn arxh ths procedure
53368>>>>>                                Case Break
53369>>>>>                                Case (sFlag='15') // Aytomath dhmiourgia axiografou
53372>>>>>                                Case Break
53373>>>>>                                Case (sFlag='16') // Allagh XreoPistoshs me antistrofh proshmou
53376>>>>>                                    If (nXre<>0) Begin
53378>>>>>                                        Move (nXre*(-1))    to nPis
53379>>>>>                                        Move 0              to nXre
53380>>>>>                                    End
53380>>>>>>
53380>>>>>                                    Else If (nPis<>0) Begin
53383>>>>>                                        Move (nPis*(-1))    to nXre
53384>>>>>                                        Move 0              to nPis
53385>>>>>                                    End
53385>>>>>>
53385>>>>>                                Case Break
53386>>>>>                                Case (sFlag='17') // Afairei apo Myf (akyrotika)
53389>>>>>                                    // Thelei exhghsh ti shmainei 'afairei' ?
53389>>>>>                                    // apo posothta? apo axia? apo allou?
53389>>>>>                                Case Break
53390>>>>>                                Case (sFlag='23') // Athroisths 1
53393>>>>>                                    Move (nPoso*iSign) to nAthr1
53394>>>>>                                Case Break
53395>>>>>                                Case (sFlag='24') // Athroisths 2
53398>>>>>                                    Move (nPoso*iSign) to nAthr2
53399>>>>>                                Case Break
53400>>>>>                                Case (sFlag='25') // Athroisths 3
53403>>>>>                                    Move (nPoso*iSign) to nAthr3
53404>>>>>                                Case Break
53405>>>>>                                Case (sFlag='26') // Athroisths 4
53408>>>>>                                    Move (nPoso*iSign) to nAthr4
53409>>>>>                                Case Break
53410>>>>>                                Case (sFlag='27') // Athroisths 5
53413>>>>>                                    Move (nPoso*iSign) to nAthr5
53414>>>>>                                Case Break
53415>>>>>                                Case (sFlag='28') // Athroisths 6
53418>>>>>                                    Move (nPoso*iSign) to nAthr6
53419>>>>>                                Case Break
53420>>>>>                                Case (sFlag='29') // Athroisths 7
53423>>>>>                                    Move (nPoso*iSign) to nAthr7
53424>>>>>                                Case Break
53425>>>>>                                Case (sFlag='30') // Athroisths 8
53428>>>>>                                    Move (nPoso*iSign) to nAthr8
53429>>>>>                                Case Break
53430>>>>>
53430>>>>>                                Case (sFlag='60') // Enhmeronei Episfalh Posa Thetika
53433>>>>>                                    Move 1 to iMustSaveEpisf
53434>>>>>                                Case Break
53435>>>>>
53435>>>>>                                Case (sFlag='61') // Enhmeronei Episfalh Posa Arnhtika
53438>>>>>                                    Move 2 to iMustSaveEpisf
53439>>>>>                                Case Break
53440>>>>>
53440>>>>>                                Case (sFlag='66') // Enhmeronei synolikh ofeilh
53443>>>>>                                    Move 1 to iMustSaveofeilh
53444>>>>>                                Case Break
53445>>>>>
53445>>>>>
53445>>>>>                                Case (sFlag='99') // Enhmeronei Ypoloipa
53448>>>>>                                    Move 1 to iMustSaveClientYpoloipa
53449>>>>>                                Case Break
53450>>>>>
53450>>>>>                            Case End
53450>>>>>                            Find Gt Cflagkin By Index.5 // Cflagkin:Index.5:Ctypkin_Recr+Flag_Numeric+Cflagkin_Recr
53451>>>>>>
53451>>>>>                        Loop
53452>>>>>>
53452>>>>>
53452>>>>>
53452>>>>>                        If ((iOneCflag) And (iMustSaveCmoves)) Begin
53454>>>>>
53454>>>>>                            If (nXre<>0) Begin
53456>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nXre
53457>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia))
53458>>>>>                                Move (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastXreosh
53459>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_Code00,dHmnia,nIsotimia))
53460>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1 ;                                    to (fngConvertPoso(sNomisma,nXre,SysCurXr.C_CodeR,dHmnia,nIsotimia))
53461>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to nXre
53462>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0     to 0
53463>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00    to 0
53464>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1     to 0
53465>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to 0
53466>>>>>                                Move 0 to nParastPistosh
53467>>>>>                            End
53467>>>>>>
53467>>>>>                            Else If (nPis<>0) Begin
53470>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia   to nPis
53471>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p0 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia))
53472>>>>>                                Move (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code0,dHmnia,nIsotimia)) to nParastPistosh
53473>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p00 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_Code00,dHmnia,nIsotimia))
53474>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p1 ;                                    to (fngConvertPoso(sNomisma,nPis,SysCurXr.C_CodeR,dHmnia,nIsotimia))
53475>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_p2     to nPis
53476>>>>>
53476>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x0     to 0
53477>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x00    to 0
53478>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x1     to 0
53479>>>>>                                Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_x2     to 0
53480>>>>>                                Move 0 to nParastXreosh
53481>>>>>                            End
53481>>>>>>
53481>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Hmnia   to dHmnia
53482>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Barticl_Recr   to sRecr
53483>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.CN_Code        to (Trim(sCN_Code))
53484>>>>>
53484>>>>>                            // jsjsjs 11/11/2003 Amesh pleon syndesh Cmove me Bmove
53484>>>>>                            //                   Na trexei kai to enhCmBm gia batch enhmerosh
53484>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Custprom_Code   to (Trim(sBmoveRecr))
53485>>>>>                            //
53485>>>>>
53485>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Cmoves_SC_Code2   to (Trim(sNomisma))
53486>>>>>                            Get Field_Current_Value Of Btypkin_DD  Field Btypkin.Btypkin_Abr    to ssBtypkinDescrShort
53487>>>>>                            Get Field_Current_Value Of Barticl_DD  Field Barticl.Barticl_No     to iiBarticleNO
53488>>>>>                            Move '' to sPerigrafh
53489>>>>>                            Move (Append(sPerigrafh,('*'+(Trim(ssBtypkinDescrShort))+'  '+ ;                                                    (String(iiBarticleNO))+ '*'))) to sPerigrafh
53490>>>>>                            //
53490>>>>>                            Set Field_Changed_Value Of Cmoves_DD    Field Cmoves.Cmoves_Par     to (Trim(sPerigrafh))
53491>>>>>
53491>>>>>                            //////////////////////////////////////////////////////////////////////////////
53491>>>>>                            // jsjsjsjs 06/02/2001 ©¬£§¢ž¨à¤¦¤«˜  «˜ §˜¨˜¡˜«à §œ› ˜
53491>>>>>                            //                     £œ «¦  › ¦ §¦©¦ š ˜ ¢¦š¦¬ª reportin ˜¥ ¦š¨˜­à¤
53491>>>>>                            //////////////////////////////////////////////////////////////////////////////
53491>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Axia to nJS
53492>>>>>
53492>>>>>
53492>>>>>                            If (iAntistrofhProshmou)    Move (-1) to iSign
53495>>>>>                            Else                        Move   1  to iSign
53497>>>>>
53497>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd0    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code0,dHmnia,nIsotimia))*iSign)
53498>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd00   ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_Code00,dHmnia,nIsotimia))*iSign)
53499>>>>>                            Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmove_TotAmBd1    ;                                to ((fngConvertPoso(sNomisma,nJS,SysCurXr.C_CodeR,dHmnia,nIsotimia))*iSign)
53500>>>>>                            //////////////////////////////////////////////////////////////////////////////
53500>>>>>                            //////////////////////////////////////////////////////////////////////////////
53500>>>>>
53500>>>>>
53500>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Module_From  to (trim(sModule))
53501>>>>>
53501>>>>>                            Get field_current_value of clients_dd field clients.recnum to iclient
53502>>>>>
53502>>>>>                            If (iClient) Begin
53504>>>>>                                If (iMustSaveClientYpoloipa =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel   to '1'
53507>>>>>                                If (iMustSaveClient         =1)  Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel to '1'
53510>>>>>                            End
53510>>>>>>
53510>>>>>
53510>>>>>                            Else begin
53511>>>>>                                error 5011 "Client record not found while saving cmoves"
53512>>>>>>
53512>>>>>                            end
53512>>>>>>
53512>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Sls_ID      to sSls_ID
53513>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Cnt_ID      to sCnt_ID
53514>>>>>                            Set Field_Changed_Value Of Cmoves_DD   Field Cmoves.Presp_ID    to sPresp_ID
53515>>>>>                            Send Request_Save to Cmoves_DD
53516>>>>>
53516>>>>>                            Get Field_Current_Value Of Cmoves_DD Field Cmoves.Cmoves_Recr to sCmovesRecr
53517>>>>>
53517>>>>>                            If (Trim(sCmovesRecr)='') error 5008 "Saved Cmoves but dont have Recr"
53520>>>>>                            // jsjsjs 31/08/2001
53520>>>>>                            Skip_All_Ctypkin:
53520>>>>>
53520>>>>>                            //Set Field_Changed_Value Of Barticl_DD Field Barticl.Cmoves_Recr      to (Trim(sCmovesRecr))
53520>>>>>                            If ((iAnti=2) Or (iAnti=3)) ;                                Set Field_Changed_Value Of BMove_DD Field BMove.Cmoves_Recr to (Trim(sCmovesRecr))
53523>>>>>                            // jsjsjs 31/08/2001
53523>>>>>
53523>>>>>                            Send Request_Save to Bmove_DD
53524>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
53525>>>>>                            Send Request_Save to Barticl_DD
53526>>>>>                        End
53526>>>>>>
53526>>>>>                        Else Begin
53527>>>>>                            // Prosthetos kodikas gia na kleinei kai ta axiografa
53527>>>>>                            // ta opoia den kanoun kammia kinhsh.
53527>>>>>                            Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
53528>>>>>                            Send Request_Save to Barticl_DD
53529>>>>>                        End
53529>>>>>>
53529>>>>>
53529>>>>>                        // @@##@@## yannis
53529>>>>>                        If ((iMustSaveEpisf<>0) or (imustsaveofeilh<>0)) Begin
53531>>>>>                            Move 0  to nApait
53532>>>>>                            Move 0  to napaitpayresp
53533>>>>>                            Move 0  to nEpitPoso
53534>>>>>                            Move '' to sPelaths
53535>>>>>                            Move 0  to nofeilh
53536>>>>>                            Move 0  to nofeilhpayresp
53537>>>>>                            //Get field_current_value of Baxio_dd field Baxio.Baxio_V0            to nEpitPoso
53537>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_V2            to nEpitPoso
53538>>>>>                            Get field_current_value of Baxio_dd field Baxio.Baxio_Code_In       to sPelaths
53539>>>>>
53539>>>>>                            // js 13/03/2003 Giati oi apografikes xreoseis pou kataxorountai apo
53539>>>>>                            // ta axiografa ?? exoun keno ayto to pedio apo thn klash tou baxio
53539>>>>>                            // Elegxetai to pedio Baxiokat.Baxiokat_Type  opou an einai 2 (Xreosh)
53539>>>>>                            // mhdenizei to pedio tou pelath Baxio.Baxio_Code_In
53539>>>>>                            If (Trim(sPelaths)='') Get field_current_value of Barticl_dd field Barticl.Barticl_code1 to sPelaths
53542>>>>>                            // js 13/03/2003
53542>>>>>
53542>>>>>                            Send Clear to Clients_DD
53543>>>>>                            Move (Trim(sPelaths)) to Clients.Client_ID
53544>>>>>                            Send Find to Clients_DD Eq 6 // Clients:index.6:Client_ID
53545>>>>>                            If (Found=1) Begin
53547>>>>>                                Get field_current_value of clients_dd field clients.Poso_Se_Apait   to nApait
53548>>>>>                                Get field_current_value of payresp_dd field payresp.Poso_Se_Apait   to nApaitpayresp
53549>>>>>                                Get field_current_value of clients_dd field clients.synolikh_ofeilh to nofeilh
53550>>>>>                                Get field_current_value of payresp_dd field payresp.synolikh_ofeilh to nofeilhpayresp
53551>>>>>
53551>>>>>                                If (iMustSaveofeilh=1)  Begin
53553>>>>>                                    If (Baxiokat.Baxiokat_Type = 2) Begin
53555>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh+nepitposo)
53556>>>>>                                        Send Request_Save to Clients_DD
53557>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp+nepitposo)
53558>>>>>                                        Send Request_Save to payresp_DD
53559>>>>>                                    End
53559>>>>>>
53559>>>>>                                    Else Begin
53560>>>>>                                        Set Field_Changed_Value of clients_dd field clients.synolikh_ofeilh to (nofeilh-nepitposo)
53561>>>>>                                        Send Request_Save to Clients_DD
53562>>>>>                                        Set Field_Changed_Value of payresp_dd field payresp.synolikh_ofeilh to (nofeilhpayresp-nepitposo)
53563>>>>>                                        Send Request_Save to payresp_DD
53564>>>>>                                    End
53564>>>>>>
53564>>>>>                                End
53564>>>>>>
53564>>>>>
53564>>>>>                                If (iMustSaveEpisf=1)  Begin
53566>>>>>                                    Add nEpitPoso to nApait
53567>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
53568>>>>>                                    Send Request_Save to Clients_DD
53569>>>>>                                    Add nEpitPoso to nApaitpayresp
53570>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
53571>>>>>                                    Send Request_Save to payresp_DD
53572>>>>>
53572>>>>>                                End
53572>>>>>>
53572>>>>>                                Else If (iMustSaveEpisf=2)  Begin
53575>>>>>                                    Add (nEpitPoso*(-1)) to nApait
53576>>>>>                                    Set Field_Changed_Value of clients_dd field clients.Poso_Se_Apait to nApait
53577>>>>>                                    Send Request_Save to Clients_DD
53578>>>>>                                    Add (nEpitPoso*(-1)) to nApaitpayresp
53579>>>>>                                    Set Field_Changed_Value of payresp_dd field payresp.Poso_Se_Apait to nApaitpayresp
53580>>>>>                                    Send Request_Save to payresp_DD
53581>>>>>                                End
53581>>>>>>
53581>>>>>
53581>>>>>                                Set Field_Changed_Value Of Barticl_DD Field Barticl.Barticl_Ekleise  to '1'
53582>>>>>                                Send Request_Save to Barticl_DD
53583>>>>>                            End
53583>>>>>>
53583>>>>>                            Else Begin
53584>>>>>                            End
53584>>>>>>
53584>>>>>                        End
53584>>>>>>
53584>>>>>
53584>>>>>                        Move sCtypkinRecr to Ctypkin.Ctypkin_Recr
53585>>>>>                        Send Find to Ctypkin_DD eq 2 //Ctypkin:Index.2:Client_Recr
53586>>>>>                        If (Not(Found)) error 5006 "Ctypkin record not found"
53589>>>>>
53589>>>>>                        Send Find To Bmove_DD Next_Record 3 // Bmove:Index.2:Bmove_Recr
53590>>>>>                    Loop
53591>>>>>>
53591>>>>>
53591>>>>>                    //send info_box "€¥ æš¨˜­˜ œ§ «¬®éª ¡¢œ ©£â¤˜.\nƒœ¤ «¨¦§¦§¦ ¦ç¤«˜  ˜¤ ›œ¤ ¥œ¡¢œ ›é©¦¬¤" '¢ž¨¦­¦¨å˜'
53591>>>>>                End
53591>>>>>>
53591>>>>>            End
53591>>>>>>
53591>>>>>            Else error 5001 "’¦ ˜¨® ¡æ Barticle Recr ›œ¤ ™¨âŸž¡œ"
53593>>>>>        End_procedure
53594>>>>>
53594>>>>>
53594>>>>>        Procedure OnProcess
53596>>>>>            If (psModule(Self)='') error 5999 "Business Process Called without setting psModule property"
53599>>>>>            If (Trim(psBarticleRecr(Self))<>'') Send Deal_With_Barticle
53602>>>>>            Else error 5000  "ƒœ¤ ¬§á¨®œ  ˜¨® ¡æ Barticle Recr"// No Initial Barticle recr is passed
53604>>>>>        End_Procedure
53605>>>>>
53605>>>>>        Procedure Start_Process
53607>>>>>            Integer iErr iID
53608>>>>>            Indicate Err False
53609>>>>>            Set Button_State    of (Wait(Self)) to False
53610>>>>>            Set BarVisibleState of (Wait(Self)) to '' False
53611>>>>>            Send Popup                          to (Wait(Self))
53612>>>>>            Set piLathos                        to 0
53613>>>>>            Forward Send Start_Process
53615>>>>>        End_Procedure
53616>>>>>
53616>>>>>        Procedure End_Process
53618>>>>>            Forward Send End_Process
53620>>>>>            Send Deactivate to (Wait(Self))
53621>>>>>        End_Procedure
53622>>>>>
53622>>>>>        //AB-StoreEnd
53622>>>>>
53622>>>>>    End_Object    // bpencmv3
53623>>>>>
53623>>>>>//AB/     End_Object    // prj
53623>>>
53623>>>Use slNomism.sl
53623>>>Use sl033.sl
INCLUDING FILE: SL033.SL
53623>>>>>//AB/ Project SL033:BKINKAT
53623>>>>>//AB/ Object prj is a Lookup_Project
53623>>>>>//AB/     Set ProjectName to "SL033:BKINKAT"
53623>>>>>//AB/     Set ProjectFileName to "sl033.SL"
53623>>>>>
53623>>>>>// Project Object Structure
53623>>>>>//   sl033 is a dbModalPanelSub
53623>>>>>//     Company_DD is a DataDictionary
53623>>>>>//     Branch_DD is a DataDictionary
53623>>>>>//     Year_DD is a DataDictionary
53623>>>>>//     Btypkin_DD is a DataDictionary
53623>>>>>//     Baxiokat_DD is a DataDictionary
53623>>>>>//     Bkinkat_DD is a DataDictionary
53623>>>>>//     oSelList is a dbListSub
53623>>>>>//     oOK_bn is a ButtonSub
53623>>>>>//     oCancel_bn is a ButtonSub
53623>>>>>//     oSearch_bn is a ButtonSub
53623>>>>>
53623>>>>>// Register all objects
53623>>>>>Register_Object Baxiokat_DD
53623>>>>>Register_Object Bkinkat_DD
53623>>>>>Register_Object Branch_DD
53623>>>>>Register_Object Btypkin_DD
53623>>>>>Register_Object Company_DD
53623>>>>>Register_Object oCancel_bn
53623>>>>>Register_Object oOK_bn
53623>>>>>Register_Object oSearch_bn
53623>>>>>Register_Object oSelList
53623>>>>>Register_Object sl033
53623>>>>>Register_Object Year_DD
53623>>>>>
53623>>>>>
53623>>>>>//AB-IgnoreStart
53623>>>>>
53623>>>>>Use DFAllEnt.pkg
53623>>>>>Use dbList.Sub
53623>>>>>Use Button.Sub
53623>>>>>
53623>>>>>
53623>>>>>Use COMPANY.DD
53623>>>>>Use BRANCH.DD
53623>>>>>Use YEAR.DD
53623>>>>>Use BTYPKIN.DD
53623>>>>>Use BAXIOKAT.DD
53623>>>>>Use BKINKAT.DD
INCLUDING FILE: BKINKAT.DD
53623>>>>>>>//DDB-FileStart
53623>>>>>>>//DDB-HeaderStart
53623>>>>>>>
53623>>>>>>>// File Name : BKINKAT.DD
53623>>>>>>>// Class Name: Bkinkat_DataDictionary
53623>>>>>>>// Revision  : 39
53623>>>>>>>// Version   : 2
53623>>>>>>>
53623>>>>>>>Use  Windows           // Basic Definitions
53623>>>>>>>Use  DataDict          // DataDictionary Class Definition
53623>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53623>>>>>>>
53623>>>>>>>Open Bkinkat
53625>>>>>>>Open Bkinkath
INCLUDING FILE: BKINKATH.FD
53627>>>>>>>Open Baxiokat
53629>>>>>>>Open Btypkin
53631>>>>>>>Open Sysrecb
53633>>>>>>>Open Bmove
53635>>>>>>>
53635>>>>>>>//DDB-HeaderEnd
53635>>>>>>>//DDB-ValidationStart
53635>>>>>>>
53635>>>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.Pkg
53635>>>>>>>
53635>>>>>>>Register_Object Bkinkat_Bkinkat_Yn_New_VT
53635>>>>>>>Register_Object Baxio_Status_VT
53635>>>>>>>Register_Object Bkinkat_Baxio_Place_VT
53635>>>>>>>Use Baxio.Pkg        // Baxio_Status_VT
53635>>>>>>>
53635>>>>>>>Object Bkinkat_Bkinkat_Yn_New_VT  is a DescriptionValidationTable
53637>>>>>>>
53637>>>>>>>    Procedure Fill_List
53639>>>>>>>        Forward Send Fill_List
53641>>>>>>>        Send Add_Table_Value  "0"  "Ž® "
53642>>>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
53643>>>>>>>    End_Procedure    // Fill_List
53644>>>>>>>    //DDB-ValidationCustomStart
53644>>>>>>>    //DDB-ValidationCustomEnd
53644>>>>>>>End_Object   // Bkinkat_Bkinkat_Yn_New_VT
53645>>>>>>>
53645>>>>>>>Object Bkinkat_Baxio_Place_VT  is a CodeValidationTable
53647>>>>>>>    Set Type_Value        To "BAXIOPLACE"
53648>>>>>>>    Set Allow_Blank_State To TRUE
53649>>>>>>>    //DDB-ValidationCustomStart
53649>>>>>>>    //DDB-ValidationCustomEnd
53649>>>>>>>End_Object   // Bkinkat_Baxio_Place_VT
53650>>>>>>>//DDB-ValidationEnd
53650>>>>>>>Open SysCurXr
53652>>>>>>>
53652>>>>>>>Class Bkinkat_DataDictionary  is a DataDictionary_Sec
53653>>>>>>>
53653>>>>>>>    // Creating:
53653>>>>>>>
53653>>>>>>>    Procedure Creating
53654>>>>>>>        Forward Send Creating
53656>>>>>>>        // Insert Code Here
53656>>>>>>>        Move (Append('',((Trim(SysCurXr.Branch_Site))+;                         (Trim(String(Bkinkat.Bkinkat_Rec0)))))) to Bkinkat.Bkinkat_Recr
53657>>>>>>>    End_Procedure   // Creating
53658>>>>>>>
53658>>>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
53658>>>>>>>      //™) ˜¤áš¤à©ž properties
53658>>>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
53658>>>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
53658>>>>>>>      //œ) œ¤ž£â¨à©ž properties after
53658>>>>>>>      Procedure Update
53659>>>>>>>                Forward Send Update
53661>>>>>>>
53661>>>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
53661>>>>>>>                Move Syscurxr.Company_Code  to Bkinkat.Company_Code
53662>>>>>>>                Move Syscurxr.Branch_Code   to Bkinkat.Branch_Code
53663>>>>>>>                Move Syscurxr.Year_Year     to Bkinkat.Year_Year
53664>>>>>>>                Move Btypkin.Btypkin_Code   to Bkinkat.Btypkin_Code
53665>>>>>>>                Move Baxiokat.Baxiokat_Code to Bkinkat.Baxiokat_Code
53666>>>>>>>
53666>>>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
53666>>>>>>>                //š.1:baxio_stat_from + baxio_plac_from:
53666>>>>>>>                //    æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â¦ ˜¥ æš¨˜­¦,
53666>>>>>>>                //    §¨¦­˜¤éª "â¨®œ«˜ " ˜§¦ «¦ §¦¬Ÿœ¤á !
53666>>>>>>>                //    ¡˜  â®œ  ¡˜«á©«˜©ž 1
53666>>>>>>>                If (Bkinkat.Bkinkat_Yn_New = 1);                Begin
53668>>>>>>>                     Move 1 to Bkinkat.Baxio_Stat_From //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
53669>>>>>>>                     Move 0 to Bkinkat.Baxio_Plac_From //¤â¦ ˜¥ æš¨˜­¦
53670>>>>>>>                End
53670>>>>>>>>
53670>>>>>>>                Else;                Begin //©«ã¤ ˜¤«åŸœ«ž §œ¨å§«à©ž, §¨â§œ  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
53671>>>>>>>                     //If (Not(Bkinkat.Baxio_Stat_From > 0)) Send Operation_Not_Allowed 3001 //¡˜«á©«˜ž ˜§æ = œ¡¡¨œ£âª
53671>>>>>>>                     If (Not(Bkinkat.Baxio_Plac_From > 0)) Send Operation_Not_Allowed 3001 //«¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜ 
53674>>>>>>>                End
53674>>>>>>>>
53674>>>>>>>
53674>>>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ btypkin
53674>>>>>>>                Add 1 to   Btypkin.Bkinkat_Num
53675>>>>>>>
53675>>>>>>>                //Move BkinKat.BkinKat_Rec0   to BkinKat.BkinKat_code
53675>>>>>>>      End_Procedure   //update
53676>>>>>>>
53676>>>>>>>
53676>>>>>>>      Procedure Backout
53677>>>>>>>                Forward Send Backout
53679>>>>>>>
53679>>>>>>>                //œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ Btypkin
53679>>>>>>>                Sub 1 from Btypkin.Bkinkat_Num
53680>>>>>>>      End_Procedure   //backout
53681>>>>>>>
53681>>>>>>>
53681>>>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
53682>>>>>>>                String lsError_Message
53683>>>>>>>                Case Begin
53683>>>>>>>                     //˜§æ validate save
53683>>>>>>>                     Case (iError_Num = 1001)
53685>>>>>>>                     Case Break
53686>>>>>>>                     //˜§æ update
53686>>>>>>>                     Case (iError_Num = 3001)
53689>>>>>>>                          Move ("DDC 146:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ §¨â§œ  ¡á§¦¬ ¤˜ ™¨å©¡œ«˜  !");                          to lsError_Message
53690>>>>>>>                     Case Break
53691>>>>>>>
53691>>>>>>>                     Case Else
53691>>>>>>>                          Forward Send Operation_Not_Allowed iError_Num
53693>>>>>>>                Case End
53693>>>>>>>
53693>>>>>>>                Error iError_Num lsError_Message
53694>>>>>>>>
53694>>>>>>>      End_Procedure // operation_not_allowed
53695>>>>>>>
53695>>>>>>>
53695>>>>>>>//----------------------------------------------------------------------------
53695>>>>>>>    Procedure Define_Fields
53696>>>>>>>        Forward Send Define_Fields
53698>>>>>>>        //DDB-Generated-Code-Location
53698>>>>>>>        //DDB-DefineFieldStart
53698>>>>>>>
53698>>>>>>>        Set Main_File            To Bkinkat.File_Number
53699>>>>>>>        Set Cascade_Delete_State To FALSE
53700>>>>>>>
53700>>>>>>>
53700>>>>>>>        // Child (Client) file structure................
53700>>>>>>>        Send Add_Client_File  Bkinkath.File_Number
53701>>>>>>>
53701>>>>>>>        // Parent (Server) file structure...............
53701>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
53702>>>>>>>        Send Add_Server_File  Btypkin.File_Number
53703>>>>>>>
53703>>>>>>>        // External (System) file structure.............
53703>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
53704>>>>>>>        Send Add_System_File  Bmove.File_Number  DD_LOCK_ON_ALL
53705>>>>>>>
53705>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
53708>>>>>>>
53708>>>>>>>        // Field-based properties.......................
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Company_Code
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Branch_Code
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Year_Year
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Btypkin_Code
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Baxiokat_Code
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Bkinkat_Code
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Bkinkat_Rec0
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Bkinkat_Recr
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Btypkin_Recr
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Baxiokat_Recr
53708>>>>>>>
53708>>>>>>>        // Bkinkat.Bkinkat_Yn_New
53708>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New To (Bkinkat_Bkinkat_Yn_New_VT(Self))
53709>>>>>>>
53709>>>>>>>        // Bkinkat.Baxio_Stat_From
53709>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From To (Baxio_Status_VT(Self))
53710>>>>>>>
53710>>>>>>>        // Bkinkat.Baxio_Stat_To
53710>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To To (Baxio_Status_VT(Self))
53711>>>>>>>
53711>>>>>>>        // Bkinkat.Baxio_Plac_From
53711>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From To (Bkinkat_Baxio_Place_VT(Self))
53712>>>>>>>
53712>>>>>>>        // Bkinkat.Baxio_Plac_To
53712>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To To (Bkinkat_Baxio_Place_VT(Self))
53713>>>>>>>
53713>>>>>>>        // Bkinkat.Bkinkat_Gplncod
53713>>>>>>>
53713>>>>>>>        //DDB-DefineFieldEnd
53713>>>>>>>
53713>>>>>>>        Set Main_File            To Bkinkat.File_Number
53714>>>>>>>        Set Cascade_Delete_State To FALSE
53715>>>>>>>
53715>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53716>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53717>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53718>>>>>>>
53718>>>>>>>        // Parent (Server) file structure...............
53718>>>>>>>        Send Add_Server_File  Btypkin.File_Number
53719>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
53720>>>>>>>
53720>>>>>>>        // External (System) file structure.............
53720>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
53721>>>>>>>
53721>>>>>>>        Define_Auto_Increment  Sysrecb.Bkinkat_Rec0  To Bkinkat.Bkinkat_Rec0
53724>>>>>>>
53724>>>>>>>        // Field-based properties.......................
53724>>>>>>>
53724>>>>>>>        // Bkinkat.Btypkin_Code
53724>>>>>>>        Set Key_Field_State        Field Bkinkat.Btypkin_Code     To TRUE
53725>>>>>>>
53725>>>>>>>        // Bkinkat.Baxiokat_Code
53725>>>>>>>        Set Field_Options          Field Bkinkat.Baxiokat_Code    To DD_AUTOFIND
53726>>>>>>>        Set Key_Field_State        Field Bkinkat.Baxiokat_Code    To TRUE
53727>>>>>>>
53727>>>>>>>        // Bkinkat.Bkinkat_Rec0
53727>>>>>>>        Set Field_Options          Field Bkinkat.Bkinkat_Rec0     To DD_NOPUT
53728>>>>>>>
53728>>>>>>>        // Bkinkat.Btypkin_Rec0
53728>>>>>>>        //Set Field_Options          Field Bkinkat.Btypkin_Rec0     To DD_NOPUT
53728>>>>>>>
53728>>>>>>>        // Bkinkat.Baxiokat_Rec0
53728>>>>>>>        //Set Field_Options          Field Bkinkat.Baxiokat_Rec0    To DD_NOPUT
53728>>>>>>>
53728>>>>>>>        // Bkinkat.Bkinkat_Yn_New
53728>>>>>>>        Set Field_Class_Name       Field Bkinkat.Bkinkat_Yn_New   To "dbComboForm_EZ"
53729>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ €¥ æš¨˜­¦ ?"
53730>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Yn_New   To "Œâ¦ ?"
53731>>>>>>>        Set Field_Value_Table      Field Bkinkat.Bkinkat_Yn_New   To (Bkinkat_Bkinkat_Yn_New_VT(Self))
53732>>>>>>>
53732>>>>>>>        // Bkinkat.Baxio_Stat_From
53732>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_From  To "dbComboForm_EZ"
53733>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
53734>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_From  To "‰˜«á©«˜©ž €§æ"
53735>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_From  To (Baxio_Status_VT(Self))
53736>>>>>>>
53736>>>>>>>        // Bkinkat.Baxio_Stat_To
53736>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Stat_To    To "dbComboForm_EZ"
53737>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
53738>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Stat_To    To "‰˜«á©«˜©ž ‘â"
53739>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Stat_To    To (Baxio_Status_VT(Self))
53740>>>>>>>
53740>>>>>>>        // Bkinkat.Baxio_Plac_From
53740>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_From  To "dbComboForm_EZ"
53741>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
53742>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_From  To "„¬¨å¡œ«¦ ©â"
53743>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_From  To (Bkinkat_Baxio_Place_VT(Self))
53744>>>>>>>
53744>>>>>>>        // Bkinkat.Baxio_Plac_To
53744>>>>>>>        Set Field_Class_Name       Field Bkinkat.Baxio_Plac_To    To "dbComboForm_EZ"
53745>>>>>>>        Set Field_Label_Long       Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
53746>>>>>>>        Set Field_Label_Short      Field Bkinkat.Baxio_Plac_To    To "áœ  ‘â"
53747>>>>>>>        Set Field_Value_Table      Field Bkinkat.Baxio_Plac_To    To (Bkinkat_Baxio_Place_VT(Self))
53748>>>>>>>
53748>>>>>>>        // Bkinkat.Bkinkat_Gplncod
53748>>>>>>>        Set Field_Label_Long       Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
53749>>>>>>>        Set Field_Label_Short      Field Bkinkat.Bkinkat_Gplncod  To "‰à› ¡æª ‚Š"
53750>>>>>>>        //Set Field_Prompt_Object    Field Bkinkat.Bkinkat_Gplncod  To (SL056(Self))
53750>>>>>>>
53750>>>>>>>    End_Procedure    // Define_Fields
53751>>>>>>>
53751>>>>>>>
53751>>>>>>>    Procedure Field_Defaults
53752>>>>>>>        Forward Send Field_Defaults
53754>>>>>>>        //DDB-Generated-Code-Location
53754>>>>>>>        //DDB-FieldDefaultStart
53754>>>>>>>        //DDB-FieldDefaultEnd
53754>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Bkinkat_Yn_New   To 0
53755>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_From  To "1"
53756>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Stat_To    To "1"
53757>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_From  To "1"
53758>>>>>>>        Set Field_Changed_Value   Field Bkinkat.Baxio_Plac_To    To "1"
53759>>>>>>>    End_Procedure    // Field_Defaults
53760>>>>>>>
53760>>>>>>>End_Class    // Bkinkat_DataDictionary
53761>>>>>>>//DDB-FileEnd
53761>>>>>
53761>>>>>//AB-IgnoreEnd
53761>>>>>
53761>>>>>CD_Popup_Object sl033 is a dbModalPanelSub
53780>>>>>
53780>>>>>    //AB-StoreTopStart
53780>>>>>    Property Integer piFragmaBtypkinCode 0
53782>>>>>    
53782>>>>>    
53782>>>>>    
53782>>>>>    //AB-StoreTopEnd
53782>>>>>
53782>>>>>    Set Label to "‰˜«žš¦¨åœª ˜¥ ¦š¨á­à¤ š ˜ « ª ¡ ¤ã©œ ª"
53783>>>>>    Set Size to 206 362
53784>>>>>    Set Location to 4 5
53785>>>>>    Set Exit_Application_Local_State to FALSE
53786>>>>>    Set Modal_State to FALSE
53787>>>>>
53787>>>>>    //AB-DDOStart
53787>>>>>
53787>>>>>    Object Company_DD is a Company_DataDictionary
53789>>>>>    End_Object    // Company_DD
53790>>>>>
53790>>>>>    Object Branch_DD is a Branch_DataDictionary
53792>>>>>        Set DDO_Server to (Company_DD(self))
53793>>>>>    End_Object    // Branch_DD
53794>>>>>
53794>>>>>    Object Year_DD is a Year_DataDictionary
53796>>>>>        Set DDO_Server to (Branch_DD(self))
53797>>>>>    End_Object    // Year_DD
53798>>>>>
53798>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
53800>>>>>        Set DDO_Server to (Year_DD(self))
53801>>>>>    End_Object    // Btypkin_DD
53802>>>>>
53802>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
53804>>>>>    End_Object    // Baxiokat_DD
53805>>>>>
53805>>>>>    Object Bkinkat_DD is a Bkinkat_DataDictionary
53807>>>>>        Set DDO_Server to (Btypkin_DD(self))
53808>>>>>        Set DDO_Server to (Baxiokat_DD(self))
53809>>>>>
53809>>>>>        //AB-StoreStart
53809>>>>>                                
53809>>>>>        Procedure OnConstrain
53811>>>>>            Integer liBtypkinCode
53812>>>>>        
53812>>>>>            Get piFragmaBtypkinCode to liBtypkinCode
53813>>>>>            If (liBtypkinCode <> 0) Constrain Bkinkat.Btypkin_Code eq liBtypkinCode
53817>>>>>        End_Procedure // OnConstrain
53818>>>>>        
53818>>>>>        //AB-StoreEnd
53818>>>>>
53818>>>>>    End_Object    // Bkinkat_DD
53819>>>>>
53819>>>>>    Set Main_DD to (Bkinkat_DD(self))
53820>>>>>    Set Server to (Bkinkat_DD(self))
53821>>>>>
53821>>>>>    //AB-DDOEnd
53821>>>>>
53821>>>>>    Object oSelList is a dbListSub
53823>>>>>        Set Main_File to Bkinkat.File_Number
53824>>>>>        Set Size to 164 350
53825>>>>>        Set Location to 5 4
53826>>>>>
53826>>>>>        Begin_Row
53829>>>>>            Entry_Item Baxiokat.Baxiokat_code
53830>>>>>            Entry_Item Baxiokat.Baxiokat_descr
53831>>>>>            Entry_Item Baxiokat.Baxiokat_type
53832>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
53833>>>>>        End_Row
53838>>>>>
53838>>>>>        Set Form_Width    item 0 to 36
53839>>>>>        Set Header_Label  item 0 to "„ ›¦ª"
53840>>>>>        
53840>>>>>        Set Form_Width    item 1 to 194
53841>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
53842>>>>>        
53842>>>>>        Set Form_Width    item 2 to 29
53843>>>>>        Set Header_Label  item 2 to "„ ©./¢ž¨."
53844>>>>>        
53844>>>>>        Set Form_Width    item 3 to 83
53845>>>>>        Set Header_Label  item 3 to "„ ©./¢ž¨."
53846>>>>>        
53846>>>>>
53846>>>>>        //AB-StoreStart
53846>>>>>                                
53846>>>>>        Property Integer piStoreFragmaBtypkinCode 0
53848>>>>>        
53848>>>>>        
53848>>>>>        Procedure Store_Defaults
53850>>>>>           Forward Send Store_Defaults
53852>>>>>           Set piStoreFragmaBtypkinCode to (piFragmaBtypkinCode(Self))
53853>>>>>        End_Procedure
53854>>>>>        
53854>>>>>        Procedure ReStore_Defaults
53856>>>>>           Forward Send ReStore_Defaults
53858>>>>>           Set piFragmaBtypkinCode to (piStoreFragmaBtypkinCode(Self))
53859>>>>>        End_Procedure
53860>>>>>        
53860>>>>>        Procedure Activating
53862>>>>>           Forward Send Activating
53864>>>>>           Send Rebuild_Constraints to Bkinkat_DD
53865>>>>>        End_Procedure
53866>>>>>        
53866>>>>>        
53866>>>>>        //AB-StoreEnd
53866>>>>>
53866>>>>>    End_Object    // oSelList
53867>>>>>
53867>>>>>    Object oOK_bn is a ButtonSub
53869>>>>>        Set Label to "&„§ ¢¦šã"
53870>>>>>        Set Location to 172 195
53871>>>>>
53871>>>>>        //AB-StoreStart
53871>>>>>        Procedure OnClick
53873>>>>>            Send OK To (oSelList(current_object))
53874>>>>>        End_Procedure
53875>>>>>        //AB-StoreEnd
53875>>>>>
53875>>>>>    End_Object    // oOK_bn
53876>>>>>
53876>>>>>    Object oCancel_bn is a ButtonSub
53878>>>>>        Set Label to "&€¡ç¨à©ž"
53879>>>>>        Set Location to 172 250
53880>>>>>
53880>>>>>        //AB-StoreStart
53880>>>>>        Procedure OnClick
53882>>>>>            Send Cancel To (oSelList(current_object))
53883>>>>>        End_Procedure
53884>>>>>        //AB-StoreEnd
53884>>>>>
53884>>>>>    End_Object    // oCancel_bn
53885>>>>>
53885>>>>>    Object oSearch_bn is a ButtonSub
53887>>>>>        Set Label to "€&¤˜ã«ž©ž"
53888>>>>>        Set Location to 172 304
53889>>>>>
53889>>>>>        //AB-StoreStart
53889>>>>>        Procedure OnClick
53891>>>>>            Send Search To (oSelList(current_object))
53892>>>>>        End_Procedure
53893>>>>>        //AB-StoreEnd
53893>>>>>
53893>>>>>    End_Object    // oSearch_bn
53894>>>>>
53894>>>>>
53894>>>>>    //AB-StoreStart
53894>>>>>    
53894>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
53895>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
53896>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
53897>>>>>    
53897>>>>>    
53897>>>>>    
53897>>>>>    
53897>>>>>    //AB-StoreEnd
53897>>>>>
53897>>>>>CD_End_Object    // sl033
53899>>>>>>
53899>>>>>
53899>>>>>//AB/ End_Object    // prj
53899>>>Use r044.rv
INCLUDING FILE: R044.RV
53899>>>>>//AB/ Project R044:BMOVES
53899>>>>>//AB/     Object prj is a Report_Project
53899>>>>>//AB/         Set ProjectName to "R044:BMOVES"
53899>>>>>//AB/         Set ProjectFileName to "r044.RV"
53899>>>>>
53899>>>>>// Project Object Structure
53899>>>>>//   R044 is a ReportViewSub
53899>>>>>//     GroupSub2 is a GroupSub
53899>>>>>//       FormSub1 is a FormSub
53899>>>>>//       FormSub2 is a FormSub
53899>>>>>//       TextBoxSub7 is a TextBoxSub
53899>>>>>//       TextBoxSub8 is a TextBoxSub
53899>>>>>//     GroupSub1 is a GroupSub
53899>>>>>//       frmG12_3 is a FormSub
53899>>>>>//       frmG12_4 is a FormSub
53899>>>>>//       TextBoxSub3 is a TextBoxSub
53899>>>>>//       TextBoxSub4 is a TextBoxSub
53899>>>>>//     GroupSub3 is a GroupSub
53899>>>>>//       frmG1 is a FormSub
53899>>>>>//       frmG2 is a FormSub
53899>>>>>//       TextBoxSub9 is a TextBoxSub
53899>>>>>//       TextBoxSub10 is a TextBoxSub
53899>>>>>//     oSelectCurr is a GroupSub
53899>>>>>//       chkbCurr0 is a CheckBoxSub
53899>>>>>//       chkbCurr00 is a CheckBoxSub
53899>>>>>//       chkbCurrR is a CheckBoxSub
53899>>>>>//       chkbKeepTogether is a CheckBoxSub
53899>>>>>//     rdgSelectPrint is a RadioGroupSub
53899>>>>>//       RadioSub5 is a RadioSub
53899>>>>>//       RadioSub6 is a RadioSub
53899>>>>>//       rdFile is a RadioSub
53899>>>>>//       frmFile is a FormSub
53899>>>>>//     FormSub5 is a FormSub
53899>>>>>//     oPrint_bn is a ButtonSub
53899>>>>>//     oExit_bn is a ButtonSub
53899>>>>>//     grpYear is a GroupSub
53899>>>>>//       frmCompany is a FormSub
53899>>>>>//       frmBranch is a FormSub
53899>>>>>//       frmYear is a FormSub
53899>>>>>//       TextBoxSub11 is a TextBoxSub
53899>>>>>//       TextBoxSub12 is a TextBoxSub
53899>>>>>//       TextBoxSub13 is a TextBoxSub
53899>>>>>//     oClear_bn is a ButtonSub
53899>>>>>//     Textbox1 is a Textbox
53899>>>>>//     branch_name is a FormSub
53899>>>>>//     BMoves_BasicReport is a BasicReportSub
53899>>>>>
53899>>>>>// Register all objects
53899>>>>>Register_Object BMoves_BasicReport
53899>>>>>Register_Object branch_name
53899>>>>>Register_Object chkbCurr0
53899>>>>>Register_Object chkbCurr00
53899>>>>>Register_Object chkbCurrR
53899>>>>>Register_Object chkbKeepTogether
53899>>>>>Register_Object FormSub1
53899>>>>>Register_Object FormSub2
53899>>>>>Register_Object FormSub5
53899>>>>>Register_Object frmBranch
53899>>>>>Register_Object frmCompany
53899>>>>>Register_Object frmFile
53899>>>>>Register_Object frmG1
53899>>>>>Register_Object frmG12_3
53899>>>>>Register_Object frmG12_4
53899>>>>>Register_Object frmG2
53899>>>>>Register_Object frmYear
53899>>>>>Register_Object GroupSub1
53899>>>>>Register_Object GroupSub2
53899>>>>>Register_Object GroupSub3
53899>>>>>Register_Object grpYear
53899>>>>>Register_Object oClear_bn
53899>>>>>Register_Object oExit_bn
53899>>>>>Register_Object oPrint_bn
53899>>>>>Register_Object oSelectCurr
53899>>>>>Register_Object R044
53899>>>>>Register_Object RadioSub5
53899>>>>>Register_Object RadioSub6
53899>>>>>Register_Object rdFile
53899>>>>>Register_Object rdgSelectPrint
53899>>>>>Register_Object TextBoxSub10
53899>>>>>Register_Object TextBoxSub11
53899>>>>>Register_Object TextBoxSub12
53899>>>>>Register_Object TextBoxSub13
53899>>>>>Register_Object TextBoxSub3
53899>>>>>Register_Object TextBoxSub4
53899>>>>>Register_Object TextBoxSub7
53899>>>>>Register_Object TextBoxSub8
53899>>>>>Register_Object TextBoxSub9
53899>>>>>Register_Object Textbox1
53899>>>>>
53899>>>>>
53899>>>>>//AB/     Report View
53899>>>>>
53899>>>>>
53899>>>>>    //AB-StoreTopStart
53899>>>>>    Use DFAllRpt.pkg
53899>>>>>    Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
53899>>>>>>>Use Dfrpt.pkg
53899>>>>>>>
53899>>>>>>>Class BasicReportSub is a BasicReport
53900>>>>>>>
53900>>>>>>>    Procedure Start_Log
53901>>>>>>>        Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
53902>>>>>>>    End_Procedure // Start_Log
53903>>>>>>>
53903>>>>>>>    Procedure End_Log
53904>>>>>>>        Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
53905>>>>>>>    End_Procedure // End_Log
53906>>>>>>>
53906>>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
53907>>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
53908>>>>>>>    End_Procedure // Error_Log_Status
53909>>>>>>>
53909>>>>>>>    Procedure Update_Status_Page
53910>>>>>>>        If (Page_End(Current_Object)) EQ 0 ;             Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
53913>>>>>>>        Else Send Update_Status ("Page: "   + String(Page_Count(Current_Object)))
53915>>>>>>>    End_Procedure // Update_Status_Page
53916>>>>>>>
53916>>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
53917>>>>>>>        If (Display_Error_State(Self)) Send End_Status
53920>>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
53921>>>>>>>>
53921>>>>>>>    End_procedure
53922>>>>>>>
53922>>>>>>>    Function Report_Interrupt Returns Integer
53923>>>>>>>        Integer rVal
53924>>>>>>>        String Mess
53924>>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
53927>>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
53929>>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
53930>>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
53933>>>>>>>        Function_Return (Rval=MBR_YES)
53934>>>>>>>    End_Function  // Report_Interrupt
53935>>>>>>>
53935>>>>>>>
53935>>>>>>>    Procedure Initialize_Output_Device
53936>>>>>>>        string sopenpath
53937>>>>>>>        get_attribute Df_Open_path to sopenpath
53940>>>>>>>        set_attribute Df_Open_path to ""
53943>>>>>>>        Direct_Output (Output_Device(current_Object))
53944>>>>>>>        Set_Attribute DF_open_path to sopenpath
53947>>>>>>>    End_procedure
53948>>>>>>>End_Class // BasicReportSub
53949>>>>>>>
53949>>>>>>>Class WinReportSub is a WinReport
53950>>>>>>>
53950>>>>>>>    Procedure Start_Log
53951>>>>>>>        Send Log_Status ("Start Report:"+Report_Title(Current_Object))
53952>>>>>>>    End_Procedure // Start_Log
53953>>>>>>>
53953>>>>>>>    Procedure End_Log
53954>>>>>>>        Send Log_Status ("End Report:  " + Report_Title(Current_Object))
53955>>>>>>>    End_Procedure // End_Log
53956>>>>>>>
53956>>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
53957>>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
53958>>>>>>>    End_Procedure // Error_Log_Status
53959>>>>>>>
53959>>>>>>>    Procedure Update_Status_Page
53960>>>>>>>        If (Page_End(Current_Object)) EQ 0 ;            Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
53963>>>>>>>        Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
53965>>>>>>>    End_Procedure // Update_Status_Page
53966>>>>>>>
53966>>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
53967>>>>>>>        If (Display_Error_State(Self)) Send End_Status
53970>>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
53971>>>>>>>>
53971>>>>>>>    End_procedure
53972>>>>>>>
53972>>>>>>>    Function Report_Interrupt Returns Integer
53973>>>>>>>        Integer rVal
53974>>>>>>>        String Mess
53974>>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
53977>>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
53979>>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
53980>>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
53983>>>>>>>        Function_Return (Rval=MBR_YES)
53984>>>>>>>    End_Function  // Report_Interrupt
53985>>>>>>>
53985>>>>>>>    Procedure Initialize_Output_Device
53986>>>>>>>        string sopenpath
53987>>>>>>>        get_attribute Df_Open_path to sopenpath
53990>>>>>>>        set_attribute Df_Open_path to ""
53993>>>>>>>        Direct_Output (Output_Device(current_Object))
53994>>>>>>>        Set_Attribute DF_open_path to sopenpath
53997>>>>>>>    End_procedure
53998>>>>>>>
53998>>>>>>>End_Class // WinReportSub
53999>>>>>>>
53999>>>>>    
53999>>>>>    Use SysCurXr.DD
53999>>>>>    Use BTYPKIN.DD
53999>>>>>    Use BARTICL.DD
53999>>>>>    Use BMOVE.DD
53999>>>>>    Use BAXIOKAT.DD
53999>>>>>    Use BAXIO.DD
53999>>>>>    
53999>>>>>    Use Rvi044.pkg
INCLUDING FILE: RVI044.PKG
/HEADERR044
Image 2, HEADERR044
 ________________________________________   ________________________________________   _________________
                                            †‹„ŽŠŽ‚ˆŽ €ˆŽ‚€”—Œ
                                            =====================
/SubHeaderR044_1
Image 3, SUBHEADERR044_1
_____________________________________________________________________________   ‘„ˆ€ : ___
‰ˆŒ†‘† : _________     €.€€‘’.: ____________.     €.€‡Ž“ : ____________.  †‹/Œˆ€ : __/__/____
‘“Œ€ŠŠ€‘Ž‹„ŒŽ‘ : ___________________________________
€€Š†’†‘     : ___________________________________   ‰“ˆŽ ŒŽ‹ˆ‘‹€ •†‘†‘ : ___________   ‘“ŒŽŠŽ : _,___,___,___.__
€ˆ’ˆŽŠŽ‚ˆ€ : _______________________________________________
-------------------------------------------------------------------------------------------------------------------------------
   €/€ „ˆƒŽ‘                    ‰—ƒˆ‰Ž‘ ’€„…€     €ˆ‡‹Ž‘      ŒŽ‹ˆ‘‹€             Ž‘Ž        Š†† ‰“ˆŽ               Ž‘Ž
                                                                 „‚‚€”†‘                             ŒŽ‹ˆ‘‹€
-------------------------------------------------------------------------------------------------------------------------------
/SubHeaderR044_2
Image 4, SUBHEADERR044_2
/BodyR044
Image 5, BODYR044
_____. _________________ _____________. ___________ ____________ _______ _,___,___,___.__  __/__/____ _______ _,___,___,___.__
/SubtotalR044_1
Image 6, SUBTOTALR044_1
/SubtotalR044_2
Image 7, SUBTOTALR044_2
-------------------------------------------------------------------------------------------------------------------------------
‘“ŒŽŠŽ                                                                             ’„‹€•ˆ€ : _______.         _,___,___,___.__
===============================================================================================================================
/RecParArticl
Image 8, RECPARARTICL
_________.
/FooterR044_1
Image 9, FOOTERR044_1
__/__/____
/*
53999>>>>>    Use sl031r.sl
INCLUDING FILE: SL031R.SL
53999>>>>>>>//AB/ Project sl031r:Btypkin with recr 1st col
53999>>>>>>>//AB/     Object prj is a Lookup_Project
53999>>>>>>>//AB/         Set ProjectName to "sl031r:Btypkin with recr 1st col"
53999>>>>>>>//AB/         Set ProjectFileName to "sl031r.SL"
53999>>>>>>>//AB/         Set GenerateFileName to "NONAME"
53999>>>>>>>
53999>>>>>>>// Project Object Structure
53999>>>>>>>//   SL031r is a dbModalPanelSub
53999>>>>>>>//     Btypkin_DD is a DataDictionary
53999>>>>>>>//     oSelList is a dbListSub
53999>>>>>>>//     oOK_bn is a ButtonSub
53999>>>>>>>//     oCancel_bn is a ButtonSub
53999>>>>>>>//     oSearch_bn is a ButtonSub
53999>>>>>>>
53999>>>>>>>// Register all objects
53999>>>>>>>Register_Object Btypkin_DD
53999>>>>>>>Register_Object oCancel_bn
53999>>>>>>>Register_Object oOK_bn
53999>>>>>>>Register_Object oSearch_bn
53999>>>>>>>Register_Object oSelList
53999>>>>>>>Register_Object SL031r
53999>>>>>>>
53999>>>>>>>
53999>>>>>>>    //AB-IgnoreStart
53999>>>>>>>
53999>>>>>>>    Use DFAllEnt.pkg
53999>>>>>>>    Use dbList.Sub
53999>>>>>>>    Use Button.Sub
53999>>>>>>>
53999>>>>>>>
53999>>>>>>>    Use BTYPKIN.DD
53999>>>>>>>    
53999>>>>>>>    //AB-IgnoreEnd
53999>>>>>>>
53999>>>>>>>    CD_Popup_Object SL031r is a dbModalPanelSub
54018>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
54019>>>>>>>        Set Size to 213 362
54020>>>>>>>        Set Location to 4 5
54021>>>>>>>        Set Exit_Application_Local_State to FALSE
54022>>>>>>>        Set Modal_State to FALSE
54023>>>>>>>
54023>>>>>>>        //AB-DDOStart
54023>>>>>>>
54023>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
54025>>>>>>>        End_Object    // Btypkin_DD
54026>>>>>>>
54026>>>>>>>        Set Main_DD to (Btypkin_DD(self))
54027>>>>>>>        Set Server to (Btypkin_DD(self))
54028>>>>>>>
54028>>>>>>>        //AB-DDOEnd
54028>>>>>>>
54028>>>>>>>        Object oSelList is a dbListSub
54030>>>>>>>            Set Main_File to Btypkin.File_Number
54031>>>>>>>            Set Size to 173 347
54032>>>>>>>            Set Location to 2 6
54033>>>>>>>
54033>>>>>>>            Begin_Row
54036>>>>>>>                Entry_Item Btypkin.Btypkin_recr
54037>>>>>>>                Entry_Item Btypkin.Btypkin_code
54038>>>>>>>                Entry_Item Btypkin.Btypkin_descr
54039>>>>>>>                Entry_Item Btypkin.Gtypkin_code
54040>>>>>>>                Entry_Item Btypkin.Ctypkin_code
54041>>>>>>>                Entry_Item Btypkin.Vtypkin_code
54042>>>>>>>                Entry_Item Btypkin.Btypkin_anti_xp
54043>>>>>>>            End_Row
54048>>>>>>>
54048>>>>>>>            Set Form_Width    item 0 to 58
54049>>>>>>>            Set Header_Label  item 0 to "Btypkin recr"
54050>>>>>>>            
54050>>>>>>>            Set Form_Width    item 1 to 36
54051>>>>>>>            set header_label  item 1 to "‰å¤ž©ž" 
54052>>>>>>>            
54052>>>>>>>            Set Form_Width    item 2 to 86
54053>>>>>>>            set header_label  item 2 to "œ¨ š¨˜­ã" 
54054>>>>>>>            
54054>>>>>>>            Set Form_Width    item 3 to 36
54055>>>>>>>            set header_label  item 3 to "‰å¤ž©ž ‚Š" 
54056>>>>>>>            
54056>>>>>>>            Set Form_Width    item 4 to 36
54057>>>>>>>            set header_label  item 4 to "‰ ¤ã©œ ª œ¢˜«é¤        " 
54058>>>>>>>            
54058>>>>>>>            Set Form_Width    item 5 to 36
54059>>>>>>>            set header_label  item 5 to "‰å¤ž©ž ¨¦£žŸœ¬«é¤" 
54060>>>>>>>            
54060>>>>>>>            Set Form_Width    item 6 to 53
54061>>>>>>>            set header_label  item 6 to "• ‘¬¤˜¢¢˜©¦£â¤¦¬" 
54062>>>>>>>            
54062>>>>>>>
54062>>>>>>>            //AB-StoreStart
54062>>>>>>>            Set Column_Option Item 0 to NoEnter True
54063>>>>>>>            
54063>>>>>>>            //AB-StoreEnd
54063>>>>>>>
54063>>>>>>>        End_Object    // oSelList
54064>>>>>>>
54064>>>>>>>        Object oOK_bn is a ButtonSub
54066>>>>>>>            set label to "&„§ ¢¦šã" 
54067>>>>>>>            Set Location to 178 194
54068>>>>>>>
54068>>>>>>>            //AB-StoreStart
54068>>>>>>>            Procedure OnClick
54070>>>>>>>                Send OK To oSelList
54071>>>>>>>            End_Procedure
54072>>>>>>>            //AB-StoreEnd
54072>>>>>>>
54072>>>>>>>        End_Object    // oOK_bn
54073>>>>>>>
54073>>>>>>>        Object oCancel_bn is a ButtonSub
54075>>>>>>>            set label to "&€¡ç¨à©ž" 
54076>>>>>>>            Set Location to 178 249
54077>>>>>>>
54077>>>>>>>            //AB-StoreStart
54077>>>>>>>            Procedure OnClick
54079>>>>>>>                Send Cancel To oSelList
54080>>>>>>>            End_Procedure
54081>>>>>>>            //AB-StoreEnd
54081>>>>>>>
54081>>>>>>>        End_Object    // oCancel_bn
54082>>>>>>>
54082>>>>>>>        Object oSearch_bn is a ButtonSub
54084>>>>>>>            set label to "€&¤˜ã«ž©ž" 
54085>>>>>>>            Set Location to 178 304
54086>>>>>>>
54086>>>>>>>            //AB-StoreStart
54086>>>>>>>            Procedure OnClick
54088>>>>>>>                Send Search To oSelList
54089>>>>>>>            End_Procedure
54090>>>>>>>            //AB-StoreEnd
54090>>>>>>>
54090>>>>>>>        End_Object    // oSearch_bn
54091>>>>>>>
54091>>>>>>>
54091>>>>>>>        //AB-StoreStart
54091>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
54092>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
54093>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
54094>>>>>>>        
54094>>>>>>>        //AB-StoreEnd
54094>>>>>>>
54094>>>>>>>    CD_End_Object    // SL031r
54096>>>>>>>>
54096>>>>>>>
54096>>>>>>>//AB/     End_Object    // prj
54096>>>>>    Use sl036r.sl
INCLUDING FILE: SL036R.SL
54096>>>>>>>//AB/ Project sl036r:Barticle with recr 1st col
54096>>>>>>>//AB/     Object prj is a Lookup_Project
54096>>>>>>>//AB/         Set ProjectName to "sl036r:Barticle with recr 1st col"
54096>>>>>>>//AB/         Set ProjectFileName to "sl036r.SL"
54096>>>>>>>//AB/         Set GenerateFileName to "NONAME"
54096>>>>>>>
54096>>>>>>>// Project Object Structure
54096>>>>>>>//   sl036r is a dbModalPanelSub
54096>>>>>>>//     Btypkin_DD is a DataDictionary
54096>>>>>>>//     Barticl_DD is a DataDictionary
54096>>>>>>>//     oSelList is a dbListSub
54096>>>>>>>//     oOK_bn is a ButtonSub
54096>>>>>>>//     oCancel_bn is a ButtonSub
54096>>>>>>>//     oSearch_bn is a ButtonSub
54096>>>>>>>
54096>>>>>>>// Register all objects
54096>>>>>>>Register_Object Barticl_DD
54096>>>>>>>Register_Object Btypkin_DD
54096>>>>>>>Register_Object oCancel_bn
54096>>>>>>>Register_Object oOK_bn
54096>>>>>>>Register_Object oSearch_bn
54096>>>>>>>Register_Object oSelList
54096>>>>>>>Register_Object sl036r
54096>>>>>>>
54096>>>>>>>
54096>>>>>>>    //AB-IgnoreStart
54096>>>>>>>
54096>>>>>>>    Use DFAllEnt.pkg
54096>>>>>>>    Use dbList.Sub
54096>>>>>>>    Use Button.Sub
54096>>>>>>>
54096>>>>>>>
54096>>>>>>>    Use BTYPKIN.DD
54096>>>>>>>    Use BARTICL.DD
54096>>>>>>>    
54096>>>>>>>    //AB-IgnoreEnd
54096>>>>>>>
54096>>>>>>>    CD_Popup_Object sl036r is a dbModalPanelSub
54115>>>>>>>        set label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤" 
54116>>>>>>>        Set Size to 148 440
54117>>>>>>>        Set Location to 4 5
54118>>>>>>>        Set Exit_Application_Local_State to FALSE
54119>>>>>>>        Set Modal_State to FALSE
54120>>>>>>>
54120>>>>>>>        //AB-DDOStart
54120>>>>>>>
54120>>>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
54122>>>>>>>        End_Object    // Btypkin_DD
54123>>>>>>>
54123>>>>>>>        Object Barticl_DD is a Barticl_DataDictionary
54125>>>>>>>            Set DDO_Server to (Btypkin_DD(self))
54126>>>>>>>        End_Object    // Barticl_DD
54127>>>>>>>
54127>>>>>>>        Set Main_DD to (Barticl_DD(self))
54128>>>>>>>        Set Server to (Barticl_DD(self))
54129>>>>>>>
54129>>>>>>>        //AB-DDOEnd
54129>>>>>>>
54129>>>>>>>        Object oSelList is a dbListSub
54131>>>>>>>            Set Main_File to Barticl.File_Number
54132>>>>>>>            Set Server to (Btypkin_DD(self))
54133>>>>>>>            Set Size to 105 424
54134>>>>>>>            Set Location to 6 6
54135>>>>>>>
54135>>>>>>>            Begin_Row
54138>>>>>>>                Entry_Item Barticl.Barticl_recr
54139>>>>>>>                Entry_Item Barticl.Barticl_no
54140>>>>>>>                Entry_Item Barticl.Barticl_hmnia
54141>>>>>>>                Entry_Item Btypkin.Btypkin_code
54142>>>>>>>                Entry_Item Btypkin.Btypkin_descr
54143>>>>>>>            End_Row
54148>>>>>>>
54148>>>>>>>            Set Form_Width    item 0 to 56
54149>>>>>>>            Set Header_Label  item 0 to "Barticl recr"
54150>>>>>>>            
54150>>>>>>>            Set Form_Width    item 1 to 84
54151>>>>>>>            set header_label  item 1 to "€¨ Ÿ£æª" 
54152>>>>>>>            
54152>>>>>>>            Set Form_Width    item 2 to 60
54153>>>>>>>            set header_label  item 2 to "†£œ¨¦£ž¤å˜" 
54154>>>>>>>            
54154>>>>>>>            Set Form_Width    item 3 to 38
54155>>>>>>>            set header_label  item 3 to "‰å¤ž©ž" 
54156>>>>>>>            
54156>>>>>>>            Set Form_Width    item 4 to 179
54157>>>>>>>            set header_label  item 4 to "œ¨ š¨˜­ã" 
54158>>>>>>>            
54158>>>>>>>
54158>>>>>>>            //AB-StoreStart
54158>>>>>>>            Set Column_Option Item 0 to NoEnter True
54159>>>>>>>            
54159>>>>>>>            //AB-StoreEnd
54159>>>>>>>
54159>>>>>>>        End_Object    // oSelList
54160>>>>>>>
54160>>>>>>>        Object oOK_bn is a ButtonSub
54162>>>>>>>            set label to "&„§ ¢¦šã" 
54163>>>>>>>            Set Location to 114 271
54164>>>>>>>
54164>>>>>>>            //AB-StoreStart
54164>>>>>>>            Procedure OnClick
54166>>>>>>>                Send OK To oSelList
54167>>>>>>>            End_Procedure
54168>>>>>>>            //AB-StoreEnd
54168>>>>>>>
54168>>>>>>>        End_Object    // oOK_bn
54169>>>>>>>
54169>>>>>>>        Object oCancel_bn is a ButtonSub
54171>>>>>>>            set label to "&€¡ç¨à©ž" 
54172>>>>>>>            Set Location to 114 327
54173>>>>>>>
54173>>>>>>>            //AB-StoreStart
54173>>>>>>>            Procedure OnClick
54175>>>>>>>                Send Cancel To oSelList
54176>>>>>>>            End_Procedure
54177>>>>>>>            //AB-StoreEnd
54177>>>>>>>
54177>>>>>>>        End_Object    // oCancel_bn
54178>>>>>>>
54178>>>>>>>        Object oSearch_bn is a ButtonSub
54180>>>>>>>            set label to "€&¤˜ã«ž©ž" 
54181>>>>>>>            Set Location to 114 381
54182>>>>>>>
54182>>>>>>>            //AB-StoreStart
54182>>>>>>>            Procedure OnClick
54184>>>>>>>                Send Search To oSelList
54185>>>>>>>            End_Procedure
54186>>>>>>>            //AB-StoreEnd
54186>>>>>>>
54186>>>>>>>        End_Object    // oSearch_bn
54187>>>>>>>
54187>>>>>>>
54187>>>>>>>        //AB-StoreStart
54187>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
54188>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
54189>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
54190>>>>>>>        
54190>>>>>>>        //AB-StoreEnd
54190>>>>>>>
54190>>>>>>>    CD_End_Object    // sl036r
54192>>>>>>>>
54192>>>>>>>
54192>>>>>>>//AB/     End_Object    // prj
54192>>>>>    use sl002.sl
54192>>>>>    //AB-StoreTopEnd
54192>>>>>
54192>>>>>    //AB-IgnoreStart
54192>>>>>
54192>>>>>    Use Rptvw.Sub
INCLUDING FILE: RPTVW.SUB
54192>>>>>>>Use DFRptvw.pkg
54192>>>>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
54192>>>>>>>>>
54192>>>>>>>>>Use Windows
54192>>>>>>>>>Use DfPanel
54192>>>>>>>>>Use EnClient
54192>>>>>>>>>Use DFNav_mx
54192>>>>>>>>>Use dfConfrm
54192>>>>>>>>>Use dfRptVw
54192>>>>>>>>>Use DFGSINI
54192>>>>>>>>>
54192>>>>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
54193>>>>>>>>>    Import_Class_Protocol Entry_Client
54194>>>>>>>>>    //  Defeat the activating augmentation for auto-locate
54194>>>>>>>>>    Procedure Activating Returns Integer
54195>>>>>>>>>      local integer RVal
54196>>>>>>>>>      forward get MSG_activating to rVal
54198>>>>>>>>>      Procedure_Return rVal
54199>>>>>>>>>    End_Procedure
54200>>>>>>>>>End_Class // dbReportAppClient_
54201>>>>>>>>>
54201>>>>>>>>>Class dbReportAppView_ is a dbReportAppClient_
54202>>>>>>>>>  import_Class_protocol entry_view_Client
54203>>>>>>>>>End_Class // dbReportAppView_
54204>>>>>>>>>
54204>>>>>>>>>
54204>>>>>>>>>Class dbReportView is a dbReportAppView_
54205>>>>>>>>>
54205>>>>>>>>>     Procedure Construct_Object
54206>>>>>>>>>      Forward Send Construct_Object No_Image
54208>>>>>>>>>      Send Define_DFNavigation  // GUI navigate changes
54209>>>>>>>>>      // dialog views get activated as popup objects.
54209>>>>>>>>>      set Dso_Detach_Mode to Detach_Always
54210>>>>>>>>>
54210>>>>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
54211>>>>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
54212>>>>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
54213>>>>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
54214>>>>>>>>>      //
54214>>>>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
54214>>>>>>>>>      // is out of the question...
54214>>>>>>>>>      Set Minimize_Icon To False
54215>>>>>>>>>      Set Maximize_Icon To False
54216>>>>>>>>>   End_Procedure // Construct_Object
54217>>>>>>>>>
54217>>>>>>>>>   Procedure Request_Delete
54218>>>>>>>>>   End_Procedure // request_delete
54219>>>>>>>>>
54219>>>>>>>>>   Procedure Request_Save
54220>>>>>>>>>   End_Procedure // request_save
54221>>>>>>>>>
54221>>>>>>>>>   Function Exit_Application_Check Returns Integer
54222>>>>>>>>>     Function_return 0
54223>>>>>>>>>   End_Function
54224>>>>>>>>>
54224>>>>>>>>>   Import_Class_Protocol DFNavigate_Mixin
54225>>>>>>>>>
54225>>>>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
54225>>>>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
54225>>>>>>>>>  //  send a DEO message. DEO clients set this true
54225>>>>>>>>>  Function DEO_Object Returns integer
54226>>>>>>>>>    Function_Return 1
54227>>>>>>>>>  End_Function // DEO_Object
54228>>>>>>>>>
54228>>>>>>>>>  //
54228>>>>>>>>>  //  Activate message for views that:
54228>>>>>>>>>  //  1. restores the view if it is minimized
54228>>>>>>>>>  //  2. Maintains the current scope's focus.
54228>>>>>>>>>  //
54228>>>>>>>>>  Procedure Activate_current_scope
54229>>>>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
54232>>>>>>>>>    Set Current_Scope to Current_Object
54233>>>>>>>>>  End_Procedure // Activate_current_scope
54234>>>>>>>>>
54234>>>>>>>>>  //  Pass full object name - return the relative name
54234>>>>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
54234>>>>>>>>>  Function Local_Object_name string nm returns string
54235>>>>>>>>>     local integer ps
54236>>>>>>>>>     Repeat
54236>>>>>>>>>>
54236>>>>>>>>>       pos "." in nm to ps
54238>>>>>>>>>>
54238>>>>>>>>>       If ps eq 0 function_return nm
54241>>>>>>>>>       increment ps
54242>>>>>>>>>       Mid Nm to Nm 255 ps
54245>>>>>>>>>>
54245>>>>>>>>>     Loop
54246>>>>>>>>>>
54246>>>>>>>>>  end_function
54247>>>>>>>>>
54247>>>>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
54247>>>>>>>>>  Function Parse_Complex string sVal returns integer
54248>>>>>>>>>     Local integer ps
54249>>>>>>>>>     Pos "," in sVal to ps
54251>>>>>>>>>>
54251>>>>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
54254>>>>>>>>>  End_Function // Parse_Complex
54255>>>>>>>>>
54255>>>>>>>>>  // Convert a complex integer to a string "hi,Low"
54255>>>>>>>>>  //
54255>>>>>>>>>  Function Complex_to_String integer i1 returns string
54256>>>>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
54257>>>>>>>>>  End_function
54258>>>>>>>>>
54258>>>>>>>>>
54258>>>>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
54258>>>>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
54258>>>>>>>>>  // sense to clutter up the registry with this kind of nonsense.
54258>>>>>>>>>  ////
54258>>>>>>>>>  ////  Save View information to dfwin.ini file. Save as:
54258>>>>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
54258>>>>>>>>>  ////     Leaving room for growth here.
54258>>>>>>>>>  ////
54258>>>>>>>>>  Procedure Save_Environment
54259>>>>>>>>>  //   Local String nm Vn st
54259>>>>>>>>>  //   Local Integer H
54259>>>>>>>>>  //
54259>>>>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
54259>>>>>>>>>  //   Move (Uppercase(trim(st))) to st
54259>>>>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
54259>>>>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
54259>>>>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
54259>>>>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
54259>>>>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
54259>>>>>>>>>  //     // button).
54259>>>>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
54259>>>>>>>>>  //
54259>>>>>>>>>  //       Get Name to Vn // full name of object
54259>>>>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
54259>>>>>>>>>  //       Get GUILocation to H             // complex location
54259>>>>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
54259>>>>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
54259>>>>>>>>>  //     End
54259>>>>>>>>>  //   End
54259>>>>>>>>>  //
54259>>>>>>>>>  End_Procedure
54260>>>>>>>>>  //
54260>>>>>>>>>  //// Augment to check for view string in .INI. Currently, if found
54260>>>>>>>>>  //// set the location
54260>>>>>>>>>  ////
54260>>>>>>>>>  Procedure Load_Environment
54261>>>>>>>>>  //   Local String nm Vn Lc
54261>>>>>>>>>  //   Local Integer H ps
54261>>>>>>>>>  //   // see above for reasoning on this
54261>>>>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
54261>>>>>>>>>  //     Get Name to Vn
54261>>>>>>>>>  //     Get Local_Object_Name Vn to Vn
54261>>>>>>>>>  //     Get System_Profile_String Vn to Nm
54261>>>>>>>>>  //     IF Nm ne '' Begin
54261>>>>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
54261>>>>>>>>>  //        If Ps Begin
54261>>>>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
54261>>>>>>>>>  //           Pos " " in Lc to ps
54261>>>>>>>>>  //           if Ps left lc to lc (ps-1)
54261>>>>>>>>>  //           Get Parse_Complex lc to H
54261>>>>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
54261>>>>>>>>>  //           Send Adjust_Logicals
54261>>>>>>>>>  //        End
54261>>>>>>>>>  //     End
54261>>>>>>>>>  //   End
54261>>>>>>>>>  End_Procedure
54262>>>>>>>>>
54262>>>>>>>>>  Function View_Changed returns Integer
54263>>>>>>>>>     Local Integer Changed
54264>>>>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
54266>>>>>>>>>     Function_Return Changed
54267>>>>>>>>>  End_Function
54268>>>>>>>>>
54268>>>>>>>>>  Procedure Notify_Exit_Application
54269>>>>>>>>>    Send Save_Environment
54270>>>>>>>>>  End_procedure
54271>>>>>>>>>
54271>>>>>>>>>  Procedure End_Construct_Object
54272>>>>>>>>>     Send Load_Environment
54273>>>>>>>>>     //Send Define_SysMenu
54273>>>>>>>>>     Forward Send End_Construct_Object
54275>>>>>>>>>  End_Procedure // End_Construct_Object
54276>>>>>>>>>
54276>>>>>>>>>  Procedure Close_Client
54277>>>>>>>>>     Send Exit_Function
54278>>>>>>>>>  End_Procedure
54279>>>>>>>>>
54279>>>>>>>>>  Procedure Entering_Scope returns Integer
54280>>>>>>>>>     Local Integer rVal
54281>>>>>>>>>     Forward Get MSG_Entering_Scope to rVal
54283>>>>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
54286>>>>>>>>>  End_Procedure
54287>>>>>>>>>
54287>>>>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
54288>>>>>>>>>     Local Integer rVal
54289>>>>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
54291>>>>>>>>>     If not rVal Send Show_View_Name ''
54294>>>>>>>>>  End_Procedure
54295>>>>>>>>>
54295>>>>>>>>>  Procedure Show_view_Name string sHelp
54296>>>>>>>>>     Local Integer rVal Id
54297>>>>>>>>>     Get Statusbar_id to id
54298>>>>>>>>>     If Id Send Show_View_Name to Id sHelp
54301>>>>>>>>>  End_Procedure
54302>>>>>>>>>
54302>>>>>>>>>  Function Should_Save_Recursive returns integer
54303>>>>>>>>>    Function_return (View_Changed(Current_Object))
54304>>>>>>>>>  End_Function
54305>>>>>>>>>
54305>>>>>>>>>End_Class // dbReportView
54306>>>>>>>
54306>>>>>>>Class ReportViewSub is a ReportView
54307>>>>>>>
54307>>>>>>>    Procedure Construct_Object
54308>>>>>>>        Forward Send Construct_Object
54310>>>>>>>        Property Integer Server 0
54311>>>>>>>    End_Procedure // Construct_Object
54312>>>>>>>
54312>>>>>>>    Procedure Page Integer PageMode
54313>>>>>>>        Integer hWnd
54314>>>>>>>        Forward Send Page PageMode
54316>>>>>>>        Get Window_Handle to hWnd
54317>>>>>>>        If (hWnd) Begin
54319>>>>>>>            Send GreekSysMenu
54320>>>>>>>        End
54320>>>>>>>>
54320>>>>>>>    End_Procedure
54321>>>>>>>
54321>>>>>>>    Procedure Close_Panel
54322>>>>>>>        Local Integer liScope
54323>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
54324>>>>>>>        Move (Scope_Focus(liScope)) To liScope
54325>>>>>>>        Forward Send Close_Panel
54327>>>>>>>        Send Activate To liScope
54328>>>>>>>    End_Procedure // Close_Panel
54329>>>>>>>
54329>>>>>>>End_Class
54330>>>>>>>
54330>>>>>>>Class dbReportViewSub is a dbReportView
54331>>>>>>>
54331>>>>>>>    Procedure Construct_Object
54332>>>>>>>        Forward Send Construct_Object
54334>>>>>>>        Property Integer Server 0
54335>>>>>>>    End_Procedure // Construct_Object
54336>>>>>>>
54336>>>>>>>    Procedure Page Integer PageMode
54337>>>>>>>        Integer hWnd
54338>>>>>>>        Forward Send Page PageMode
54340>>>>>>>        Get Window_Handle to hWnd
54341>>>>>>>        If (hWnd) Begin
54343>>>>>>>            Send GreekSysMenu
54344>>>>>>>        End
54344>>>>>>>>
54344>>>>>>>    End_Procedure
54345>>>>>>>
54345>>>>>>>    Procedure Close_Panel
54346>>>>>>>        Local Integer liScope
54347>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
54348>>>>>>>        Move (Scope_Focus(liScope)) To liScope
54349>>>>>>>        Forward Send Close_Panel
54351>>>>>>>        Send Activate To liScope
54352>>>>>>>    End_Procedure // Close_Panel
54353>>>>>>>End_Class
54354>>>>>>>
54354>>>>>    Use Group.Sub
54354>>>>>    Use Form.Sub
54354>>>>>    Use Txtbox.Sub
54354>>>>>    Use Chkbox.Sub
54354>>>>>    Use Rgroup.Sub
54354>>>>>    Use Radio.Sub
54354>>>>>    Use Button.Sub
54354>>>>>    Use DFAllEnt.pkg
54354>>>>>
54354>>>>>    //AB-IgnoreEnd
54354>>>>>
54354>>>>>    ACTIVATE_VIEW Activate_R044 FOR R044
54358>>>>>
54358>>>>>    Object R044 is a ReportViewSub
54360>>>>>
54360>>>>>        //AB-StoreTopStart
54360>>>>>        Property Integer Sort_IndexR044 0
54362>>>>>        property string  psbranch public ''
54364>>>>>        Open Syscurxr
54366>>>>>        open branch
54368>>>>>        //AB-StoreTopEnd
54368>>>>>
54368>>>>>        Set Label to "R044:†£œ¨¦¢æš ¦ €¥ ¦š¨á­à¤"
54369>>>>>        Set Size to 228 324
54370>>>>>        Set Location to 5 7
54371>>>>>
54371>>>>>        //AB-DDOStart
54371>>>>>
54371>>>>>
54371>>>>>        //AB-DDOEnd
54371>>>>>
54371>>>>>        Object GroupSub2 is a GroupSub
54373>>>>>            Set Label to "„§ ¢¦šã †£œ¨¦£ž¤å˜ª €¨Ÿ¨à¤"
54374>>>>>            Set Size to 28 317
54375>>>>>            Set Location to 28 3
54376>>>>>            Object FormSub1 is a FormSub
54378>>>>>                Set Size to 13 60
54379>>>>>                Set Location to 10 51
54380>>>>>                Set Label_Col_Offset to 2
54381>>>>>                Set Label_Justification_Mode to jMode_Right
54382>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
54383>>>>>                Set Form_Mask Item 0 to "dd/mm/yyyy"
54384>>>>>
54384>>>>>                //AB-StoreStart
54384>>>>>                set Form_Datatype item 0 to mask_date_window
54385>>>>>                
54385>>>>>                
54385>>>>>                //AB-StoreEnd
54385>>>>>
54385>>>>>            End_Object    // FormSub1
54386>>>>>
54386>>>>>            Object FormSub2 is a FormSub
54388>>>>>                Set Size to 13 60
54389>>>>>                Set Location to 10 164
54390>>>>>                Set Label_Col_Offset to 2
54391>>>>>                Set Label_Justification_Mode to jMode_Right
54392>>>>>                Set Form_Datatype Item 0 to Mask_Date_Window
54393>>>>>                Set Form_Mask Item 0 to "dd/MM/yy"
54394>>>>>
54394>>>>>                //AB-StoreStart
54394>>>>>                set Form_Datatype item 0 to mask_date_window
54395>>>>>                
54395>>>>>                
54395>>>>>                //AB-StoreEnd
54395>>>>>
54395>>>>>            End_Object    // FormSub2
54396>>>>>
54396>>>>>            Object TextBoxSub7 is a TextBoxSub
54398>>>>>                Set Label to "€§æ †£/¤å˜ "
54399>>>>>                Set Auto_Size_State to FALSE
54400>>>>>                Set FontSize to 4 0
54401>>>>>                Set Location to 10 5
54402>>>>>                Set Size to 10 41
54403>>>>>                Set Enabled_State to TRUE
54404>>>>>            End_Object    // TextBoxSub7
54405>>>>>
54405>>>>>            Object TextBoxSub8 is a TextBoxSub
54407>>>>>                Set Label to "„àª †£¤å˜  :"
54408>>>>>                Set Auto_Size_State to FALSE
54409>>>>>                Set FontSize to 4 0
54410>>>>>                Set Location to 11 124
54411>>>>>                Set Size to 10 37
54412>>>>>                Set Enabled_State to TRUE
54413>>>>>            End_Object    // TextBoxSub8
54414>>>>>
54414>>>>>        End_Object    // GroupSub2
54415>>>>>
54415>>>>>        Object GroupSub1 is a GroupSub
54417>>>>>            Set Label to "„§ ¢¦šã €¨Ÿ¨à¤"
54418>>>>>            Set Size to 46 151
54419>>>>>            Set Location to 58 3
54420>>>>>            Object frmG12_3 is a FormSub
54422>>>>>                Set Size to 13 71
54423>>>>>                Set Location to 10 60
54424>>>>>                Set Label_Col_Offset to 2
54425>>>>>                Set Label_Justification_Mode to jMode_Right
54426>>>>>                Set Prompt_Button_Mode to pb_PromptOn
54427>>>>>                Set Form_Margin Item 0 to 14
54428>>>>>
54428>>>>>                //AB-StoreStart
54428>>>>>                Set Prompt_Object to (Sl036r(Current_object))
54429>>>>>                
54429>>>>>                //Procedure RetValue
54429>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
54429>>>>>                //End_Procedure // RetValue
54429>>>>>                
54429>>>>>                //// this is called by the prompt list upon initialization. This will let us
54429>>>>>                //// set special properties for the list's one time use. In this case we
54429>>>>>                //// want the intial column and the export column to be name (col 1)
54429>>>>>                //Procedure Prompt_Callback integer hPrompt
54429>>>>>                //    Integer liFld liBestColumn
54429>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
54429>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
54429>>>>>                //    Set Export_Column Of hPrompt        To liBestColumn
54429>>>>>                //    Set Initial_Column Of hPrompt       To liBestColumn
54429>>>>>                //    Set display_buffer_msg of hPrompt   to msg_RetValue
54429>>>>>                //end_procedure
54429>>>>>                
54429>>>>>                
54429>>>>>                
54429>>>>>                
54429>>>>>                
54429>>>>>                
54429>>>>>                //AB-StoreEnd
54429>>>>>
54429>>>>>            End_Object    // frmG12_3
54430>>>>>
54430>>>>>            Object frmG12_4 is a FormSub
54432>>>>>                Set Size to 13 71
54433>>>>>                Set Location to 27 60
54434>>>>>                Set Label_Col_Offset to 2
54435>>>>>                Set Label_Justification_Mode to jMode_Right
54436>>>>>                Set Prompt_Button_Mode to pb_PromptOn
54437>>>>>                Set Form_Margin Item 0 to 14
54438>>>>>
54438>>>>>                //AB-StoreStart
54438>>>>>                Set Prompt_Object to (Sl036r(Current_object))
54439>>>>>                
54439>>>>>                //Procedure RetValue
54439>>>>>                //    Set Value Item 0 to Barticl.Barticl_Recr
54439>>>>>                //End_Procedure // RetValue
54439>>>>>                //
54439>>>>>                //// this is called by the prompt list upon initialization. This will let us
54439>>>>>                //// set special properties for the list's one time use. In this case we
54439>>>>>                //// want the intial column and the export column to be name (col 1)
54439>>>>>                //Procedure Prompt_Callback integer hPrompt
54439>>>>>                //    Integer liFld liBestColumn
54439>>>>>                //
54439>>>>>                //    Get_Fieldnumber Barticl.Barticl_Recr to liFld
54439>>>>>                //    Get Select_Best_Column Of hPrompt Barticl.File_Number liFld To liBestColumn
54439>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
54439>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
54439>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
54439>>>>>                //end_procedure // Prompt_Callback
54439>>>>>                //
54439>>>>>                
54439>>>>>                
54439>>>>>                
54439>>>>>                //AB-StoreEnd
54439>>>>>
54439>>>>>            End_Object    // frmG12_4
54440>>>>>
54440>>>>>            Object TextBoxSub3 is a TextBoxSub
54442>>>>>                Set Label to "€§æ €¨Ÿ¨¦  :"
54443>>>>>                Set Auto_Size_State to FALSE
54444>>>>>                Set FontSize to 4 0
54445>>>>>                Set Location to 10 5
54446>>>>>                Set Size to 10 45
54447>>>>>                Set Enabled_State to TRUE
54448>>>>>            End_Object    // TextBoxSub3
54449>>>>>
54449>>>>>            Object TextBoxSub4 is a TextBoxSub
54451>>>>>                Set Label to "„àª €¨Ÿ¨¦  :"
54452>>>>>                Set Auto_Size_State to FALSE
54453>>>>>                Set FontSize to 4 0
54454>>>>>                Set Location to 26 5
54455>>>>>                Set Size to 13 47
54456>>>>>                Set Enabled_State to TRUE
54457>>>>>            End_Object    // TextBoxSub4
54458>>>>>
54458>>>>>
54458>>>>>            //AB-StoreStart
54458>>>>>                                                                                                        
54458>>>>>                                                                                                        
54458>>>>>            //AB-StoreEnd
54458>>>>>
54458>>>>>        End_Object    // GroupSub1
54459>>>>>
54459>>>>>        Object GroupSub3 is a GroupSub
54461>>>>>            Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
54462>>>>>            Set Size to 46 160
54463>>>>>            Set Location to 58 159
54464>>>>>            Object frmG1 is a FormSub
54466>>>>>                Set Size to 13 63
54467>>>>>                Set Location to 10 60
54468>>>>>                Set Label_Col_Offset to 2
54469>>>>>                Set Label_Justification_Mode to jMode_Right
54470>>>>>                Set Prompt_Button_Mode to pb_PromptOn
54471>>>>>                Set Form_Margin Item 0 to 6
54472>>>>>
54472>>>>>                //AB-StoreStart
54472>>>>>                Set Prompt_Object to (Sl031r(Current_object))
54473>>>>>                
54473>>>>>                //Procedure RetValue
54473>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
54473>>>>>                //End_Procedure // RetValue
54473>>>>>                //
54473>>>>>                //// this is called by the prompt list upon initialization. This will let us
54473>>>>>                //// set special properties for the list's one time use. In this case we
54473>>>>>                //// want the intial column and the export column to be name (col 1)
54473>>>>>                //Procedure Prompt_Callback integer hPrompt
54473>>>>>                //    Integer liFld liBestColumn
54473>>>>>                //
54473>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
54473>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
54473>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
54473>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
54473>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
54473>>>>>                //end_procedure // Prompt_Callback
54473>>>>>                
54473>>>>>                
54473>>>>>                
54473>>>>>                
54473>>>>>                //AB-StoreEnd
54473>>>>>
54473>>>>>            End_Object    // frmG1
54474>>>>>
54474>>>>>            Object frmG2 is a FormSub
54476>>>>>                Set Size to 13 63
54477>>>>>                Set Location to 27 60
54478>>>>>                Set Label_Col_Offset to 2
54479>>>>>                Set Label_Justification_Mode to jMode_Right
54480>>>>>                Set Prompt_Button_Mode to pb_PromptOn
54481>>>>>                Set Form_Margin Item 0 to 6
54482>>>>>
54482>>>>>                //AB-StoreStart
54482>>>>>                Set Prompt_Object to (Sl031r(Current_object))
54483>>>>>                
54483>>>>>                //Procedure RetValue
54483>>>>>                //    Set Value Item 0 to Btypkin.Btypkin_Recr
54483>>>>>                //End_Procedure // RetValue
54483>>>>>                //
54483>>>>>                //// this is called by the prompt list upon initialization. This will let us
54483>>>>>                //// set special properties for the list's one time use. In this case we
54483>>>>>                //// want the intial column and the export column to be name (col 1)
54483>>>>>                //Procedure Prompt_Callback integer hPrompt
54483>>>>>                //    Integer liFld liBestColumn
54483>>>>>                //
54483>>>>>                //    Get_Fieldnumber Btypkin.Btypkin_Recr to liFld
54483>>>>>                //    Get Select_Best_Column Of hPrompt Btypkin.File_Number liFld To liBestColumn
54483>>>>>                //    Set Export_Column Of hPrompt To liBestColumn
54483>>>>>                //    Set Initial_Column Of hPrompt To liBestColumn
54483>>>>>                //    Set display_buffer_msg of hPrompt to msg_RetValue
54483>>>>>                //end_procedure // Prompt_Callback
54483>>>>>                //
54483>>>>>                
54483>>>>>                
54483>>>>>                //AB-StoreEnd
54483>>>>>
54483>>>>>            End_Object    // frmG2
54484>>>>>
54484>>>>>            Object TextBoxSub9 is a TextBoxSub
54486>>>>>                Set Label to "€§æ ‰å¤ž©ž   :"
54487>>>>>                Set Auto_Size_State to FALSE
54488>>>>>                Set FontSize to 4 0
54489>>>>>                Set Location to 10 5
54490>>>>>                Set Size to 10 45
54491>>>>>                Set Enabled_State to TRUE
54492>>>>>            End_Object    // TextBoxSub9
54493>>>>>
54493>>>>>            Object TextBoxSub10 is a TextBoxSub
54495>>>>>                Set Label to "„àª ‰å¤ž©ž   :"
54496>>>>>                Set Auto_Size_State to FALSE
54497>>>>>                Set FontSize to 4 0
54498>>>>>                Set Location to 26 5
54499>>>>>                Set Size to 13 47
54500>>>>>                Set Enabled_State to TRUE
54501>>>>>            End_Object    // TextBoxSub10
54502>>>>>
54502>>>>>
54502>>>>>            //AB-StoreStart
54502>>>>>                                                                                                        
54502>>>>>                                                                                                        
54502>>>>>                                                                                                        
54502>>>>>                                                                                                        
54502>>>>>            //AB-StoreEnd
54502>>>>>
54502>>>>>        End_Object    // GroupSub3
54503>>>>>
54503>>>>>        Object oSelectCurr is a GroupSub
54505>>>>>            Set Label to "„§ ¢¦šã Œ¦£ ©£á«à¤"
54506>>>>>            Set Size to 28 317
54507>>>>>            Set Location to 106 3
54508>>>>>            Object chkbCurr0 is a CheckBoxSub
54510>>>>>                Set Label to "0"
54511>>>>>                Set Size to 10 21
54512>>>>>                Set Location to 12 15
54513>>>>>            End_Object    // chkbCurr0
54514>>>>>
54514>>>>>            Object chkbCurr00 is a CheckBoxSub
54516>>>>>                Set Label to "00"
54517>>>>>                Set Size to 10 25
54518>>>>>                Set Location to 12 90
54519>>>>>            End_Object    // chkbCurr00
54520>>>>>
54520>>>>>            Object chkbCurrR is a CheckBoxSub
54522>>>>>                Set Label to "rep"
54523>>>>>                Set Size to 10 27
54524>>>>>                Set Location to 12 162
54525>>>>>            End_Object    // chkbCurrR
54526>>>>>
54526>>>>>            Object chkbKeepTogether is a CheckBoxSub
54528>>>>>                Set Size to 10 17
54529>>>>>                Set Location to 12 251
54530>>>>>                Set Enabled_State to FALSE
54531>>>>>                Set Item_Shadow_State Item 0 to TRUE
54532>>>>>                Set Shadow_State Item 0 to TRUE
54533>>>>>
54533>>>>>                //AB-StoreStart
54533>>>>>                                                                                                                                            
54533>>>>>                Set Visible_State to False
54534>>>>>                //AB-StoreEnd
54534>>>>>
54534>>>>>            End_Object    // chkbKeepTogether
54535>>>>>
54535>>>>>        End_Object    // oSelectCurr
54536>>>>>
54536>>>>>        Object rdgSelectPrint is a RadioGroupSub
54538>>>>>            Set Label to "„¡«ç&§à©ž"
54539>>>>>            Set Size to 28 317
54540>>>>>            Set Location to 137 3
54541>>>>>            Object RadioSub5 is a RadioSub
54543>>>>>                Set Label to "ŽŸæ¤ž :"
54544>>>>>                Set Size to 10 36
54545>>>>>                Set Location to 12 6
54546>>>>>            End_Object    // RadioSub5
54547>>>>>
54547>>>>>            Object RadioSub6 is a RadioSub
54549>>>>>                Set Label to "„¡«¬§à«ãª : "
54550>>>>>                Set Size to 10 49
54551>>>>>                Set Location to 12 51
54552>>>>>            End_Object    // RadioSub6
54553>>>>>
54553>>>>>            Object rdFile is a RadioSub
54555>>>>>                Set Label to "€¨®œå¦"
54556>>>>>                Set Size to 10 41
54557>>>>>                Set Location to 12 113
54558>>>>>                Set Auto_Size_State to FALSE
54559>>>>>            End_Object    // rdFile
54560>>>>>
54560>>>>>            Object frmFile is a FormSub
54562>>>>>                Set Size to 13 144
54563>>>>>                Set Location to 10 158
54564>>>>>                Set Color to clBtnFace
54565>>>>>                Set Label_Col_Offset to 2
54566>>>>>                Set Enabled_State to FALSE
54567>>>>>                Set Item_Shadow_State Item 0 to TRUE
54568>>>>>                Set Shadow_State Item 0 to TRUE
54569>>>>>            End_Object    // frmFile
54570>>>>>
54570>>>>>
54570>>>>>            //AB-StoreStart
54570>>>>>            Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
54572>>>>>                If iNewItem EQ 0     Set Output_Device_Mode  To PRINT_TO_WINDOW
54575>>>>>                Else If iNewItem EQ 1   Set Output_Device_Mode  To PRINT_TO_PRINTER
54579>>>>>                Else If iNewItem EQ 2   Set Output_Device_Mode  To PRINT_TO_FILE
54583>>>>>                Set Enabled_State of frmFile to (iNewItem = 2)
54584>>>>>            End_Procedure
54585>>>>>            
54585>>>>>            
54585>>>>>            //AB-StoreEnd
54585>>>>>
54585>>>>>        End_Object    // rdgSelectPrint
54586>>>>>
54586>>>>>        Object FormSub5 is a FormSub
54588>>>>>            Set Size to 13 69
54589>>>>>            Set Location to 171 73
54590>>>>>            Set Label_Col_Offset to 2
54591>>>>>            Set Prompt_Button_Mode to pb_PromptOn
54592>>>>>
54592>>>>>            //AB-StoreStart
54592>>>>>            Set Prompt_Object to (sl002(Current_object))
54593>>>>>            
54593>>>>>            procedure onchange
54595>>>>>                string sbranch
54596>>>>>                get value item 0 to sbranch
54597>>>>>                clear branch
54598>>>>>                move syscurxr.company_code to branch.company_code
54599>>>>>                move sbranch               to branch.branch_code
54600>>>>>                find eq branch by index.1
54601>>>>>>
54601>>>>>                if (found=1) set value of (branch_name(self)) to branch.branch_name
54604>>>>>                else         set value of (branch_name(self)) to ''
54606>>>>>                set psbranch to branch.branch_code
54607>>>>>            end_procedure
54608>>>>>            
54608>>>>>            //AB-StoreEnd
54608>>>>>
54608>>>>>        End_Object    // FormSub5
54609>>>>>
54609>>>>>        Object oPrint_bn is a ButtonSub
54611>>>>>            Set Label to "„¡«â¢œ©ž (F2)"
54612>>>>>            Set Size to 18 53
54613>>>>>            Set Location to 193 208
54614>>>>>
54614>>>>>            //AB-StoreStart
54614>>>>>            Procedure OnClick
54616>>>>>                Send StartReport
54617>>>>>            End_Procedure // OnClick
54618>>>>>            
54618>>>>>            
54618>>>>>            //AB-StoreEnd
54618>>>>>
54618>>>>>        End_Object    // oPrint_bn
54619>>>>>
54619>>>>>        Object oExit_bn is a ButtonSub
54621>>>>>            Set Label to "„¥¦›¦ª (Esc)"
54622>>>>>            Set Size to 18 53
54623>>>>>            Set Location to 193 267
54624>>>>>
54624>>>>>            //AB-StoreStart
54624>>>>>            Procedure OnClick
54626>>>>>                Send Request_Cancel
54627>>>>>            End_Procedure // OnClick
54628>>>>>            
54628>>>>>            //AB-StoreEnd
54628>>>>>
54628>>>>>        End_Object    // oExit_bn
54629>>>>>
54629>>>>>        Object grpYear is a GroupSub
54631>>>>>            Set Size to 24 316
54632>>>>>            Set Location to 1 3
54633>>>>>            Object frmCompany is a FormSub
54635>>>>>                Set Size to 13 71
54636>>>>>                Set Location to 8 36
54637>>>>>                Set Color to clBtnFace
54638>>>>>                Set Label_Col_Offset to 2
54639>>>>>                Set Label_Justification_Mode to jMode_Right
54640>>>>>                Set Enabled_State to FALSE
54641>>>>>                Set Item_Shadow_State Item 0 to TRUE
54642>>>>>                Set Shadow_State Item 0 to TRUE
54643>>>>>            End_Object    // frmCompany
54644>>>>>
54644>>>>>            Object frmBranch is a FormSub
54646>>>>>                Set Size to 13 85
54647>>>>>                Set Location to 8 147
54648>>>>>                Set Color to clBtnFace
54649>>>>>                Set Label_Col_Offset to 2
54650>>>>>                Set Label_Justification_Mode to jMode_Right
54651>>>>>                Set Enabled_State to FALSE
54652>>>>>                Set Item_Shadow_State Item 0 to TRUE
54653>>>>>                Set Shadow_State Item 0 to TRUE
54654>>>>>            End_Object    // frmBranch
54655>>>>>
54655>>>>>            Object frmYear is a FormSub
54657>>>>>                Set Size to 13 43
54658>>>>>                Set Location to 8 268
54659>>>>>                Set Color to clBtnFace
54660>>>>>                Set Label_Col_Offset to 2
54661>>>>>                Set Label_Justification_Mode to jMode_Right
54662>>>>>                Set Enabled_State to FALSE
54663>>>>>                Set Item_Shadow_State Item 0 to TRUE
54664>>>>>                Set Shadow_State Item 0 to TRUE
54665>>>>>            End_Object    // frmYear
54666>>>>>
54666>>>>>            Object TextBoxSub11 is a TextBoxSub
54668>>>>>                Set Label to "„«˜ ¨œå˜"
54669>>>>>                Set Location to 8 3
54670>>>>>                Set Size to 10 30
54671>>>>>            End_Object    // TextBoxSub11
54672>>>>>
54672>>>>>            Object TextBoxSub12 is a TextBoxSub
54674>>>>>                Set Label to "“§¦¡/£˜"
54675>>>>>                Set Location to 9 109
54676>>>>>                Set Size to 10 33
54677>>>>>            End_Object    // TextBoxSub12
54678>>>>>
54678>>>>>            Object TextBoxSub13 is a TextBoxSub
54680>>>>>                Set Label to "•¨ã©ž           "
54681>>>>>                Set Location to 8 234
54682>>>>>                Set Size to 10 29
54683>>>>>            End_Object    // TextBoxSub13
54684>>>>>
54684>>>>>        End_Object    // grpYear
54685>>>>>
54685>>>>>        Object oClear_bn is a ButtonSub
54687>>>>>            Set Label to "€¡ç¨à©ž (F5)"
54688>>>>>            Set Size to 18 53
54689>>>>>            Set Location to 193 3
54690>>>>>            Set Focus_Mode to Pointer_Only
54691>>>>>
54691>>>>>            //AB-StoreStart
54691>>>>>                                                                                                        
54691>>>>>            Set MDI_Container to (R044(Self))
54692>>>>>            
54692>>>>>            Procedure OnClick
54694>>>>>                Delegate Send Request_Clear
54696>>>>>                Forward Send OnClick
54698>>>>>            End_Procedure // OnClick
54699>>>>>            
54699>>>>>            
54699>>>>>            
54699>>>>>            
54699>>>>>            //AB-StoreEnd
54699>>>>>
54699>>>>>        End_Object    // oClear_bn
54700>>>>>
54700>>>>>        Object Textbox1 is a Textbox
54702>>>>>            Set Label to "“§¦¡˜«á©«ž£˜"
54703>>>>>            Set Location to 172 5
54704>>>>>            Set Size to 10 54
54705>>>>>            Set FontWeight to 600
54706>>>>>        End_Object    // Textbox1
54707>>>>>
54707>>>>>        Object branch_name is a FormSub
54709>>>>>            Set Size to 13 145
54710>>>>>            Set Location to 170 161
54711>>>>>            Set Label_Col_Offset to 2
54712>>>>>
54712>>>>>            //AB-StoreStart
54712>>>>>            set enabled_state to false
54713>>>>>            //AB-StoreEnd
54713>>>>>
54713>>>>>        End_Object    // branch_name
54714>>>>>
54714>>>>>
54714>>>>>        //AB-StoreStart
54714>>>>>                
54714>>>>>        Property String     pdDate_To           ""
54716>>>>>        Property String     pdDate_From         ""
54718>>>>>        
54718>>>>>        //jsjsjs 29/01/2001
54718>>>>>        //Property Number pnSelArthro     0
54718>>>>>        //Property Number pnSelArthro_1   0
54718>>>>>        //Property Number pnSelArthro_2   0
54718>>>>>        //Property Integer    piBtypKin_Code_From  0
54718>>>>>        //Property Integer    piBtypKin_Code_To    0
54718>>>>>        Property String psBtypKin_Recr_From     ''
54720>>>>>        Property String psBtypKin_recr_To       ''
54722>>>>>        Property String psSelArthro             ''
54724>>>>>        Property String psSelArthro_1           ''
54726>>>>>        Property String psSelArthro_2           ''
54728>>>>>        //jsjsjs 29/01/2001
54728>>>>>        
54728>>>>>        Property Integer piSeries 0
54730>>>>>        Property Integer piKeepSectionTogether 0 //All one by one currencies
54732>>>>>        Property Integer piState1 0
54734>>>>>        Property Integer piState2 0
54736>>>>>        Property Integer piState3 0
54738>>>>>        Property Integer piFromGmoveView False
54740>>>>>        
54740>>>>>        Procedure PrintCurrArthro String asSelectedArthro String asPrinter String lsBtypkinRecr Date ldBarticlHmnia
54742>>>>>            Integer liRptId
54743>>>>>            Set psSelArthro to asSelectedArthro
54744>>>>>            if (psSelArthro(Self) <> '') Begin
54746>>>>>                Set pdDate_To           to ldBarticlHmnia
54747>>>>>                Set pdDate_From         to ldBarticlHmnia
54748>>>>>                Set psBtypKin_Recr_From to lsBtypkinRecr
54749>>>>>                Set psBtypKin_Recr_To   to lsBtypkinRecr
54750>>>>>                Get Report_Object_Id    to liRptId
54751>>>>>                If (liRptId) Send Rebuild_Constraints to liRptId
54754>>>>>                Set piFromGmoveView     to True
54755>>>>>                If (asPrinter = "") Move "lpt1:" to asPrinter
54758>>>>>                Set Output_Device_Name  To asPrinter
54759>>>>>                Send Run_Report
54760>>>>>                Set piFromGmoveView     to False
54761>>>>>                Set psSelArthro         to ''
54762>>>>>                Set pdDate_To           to ''
54763>>>>>                Set pdDate_From         to ''
54764>>>>>                Set psBtypKin_Recr_From to ''
54765>>>>>                Set psBtypKin_Recr_To   to ''
54766>>>>>            end
54766>>>>>>
54766>>>>>        End_Procedure // PrintCurrArthro
54767>>>>>        
54767>>>>>        Procedure StartReport
54769>>>>>            Integer iOutputDevice liRptId
54770>>>>>            String  FileName
54770>>>>>            Date ldDate_From ldDate_To
54770>>>>>            Integer liGthaa_044
54770>>>>>            String lsSelArthro_1 lsSelArthro_2 lsBtypKin_Recr_From lsBtypKin_Recr_To
54770>>>>>            Integer liState1 liState2 liState3 liKeepSectionTogether
54770>>>>>        
54770>>>>>            Get Output_Device_Mode To iOutputDevice
54771>>>>>        
54771>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
54773>>>>>               Make_Temp_File "TXT" FileName
54774>>>>>               Move (".\" - FileName)  To FileName
54775>>>>>               Set Output_Device_Name  To FileName
54776>>>>>            End
54776>>>>>>
54776>>>>>            Else If iOutputDevice EQ PRINT_TO_PRINTER ;               Set Output_Device_Name  To "Lpt1:"
54780>>>>>            Else If iOutputDevice EQ PRINT_TO_FILE Begin
54783>>>>>               Get Value of (frmFile(rdgSelectPrint (Self))) Item 0 to FileName
54784>>>>>               If (FileName = "") Make_Temp_File "TXT" FileName
54787>>>>>               Move (".\" - FileName)  To FileName
54788>>>>>               Set Output_Device_Name  To FileName
54789>>>>>            End
54789>>>>>>
54789>>>>>        
54789>>>>>            Get value of (FormSub1(GroupSub2(Self))) item 0 to ldDate_From
54790>>>>>            Set pdDate_From to ldDate_From
54791>>>>>            Get value of (FormSub2(GroupSub2(Self))) item 0 to ldDate_To
54792>>>>>            Set pdDate_To to ldDate_To
54793>>>>>        
54793>>>>>            Get value of (FrmG1(GroupSub3(Self))) item 0 to lsBtypKin_Recr_From
54794>>>>>            Set psBtypKin_Recr_From to (Trim(lsBtypKin_Recr_From))
54795>>>>>            Get value of (FrmG2(GroupSub3(Self))) item 0 to lsBtypKin_Recr_To
54796>>>>>            Set psBtypKin_Recr_To to (Trim(lsBtypKin_Recr_To))
54797>>>>>        
54797>>>>>            Get value of (FrmG12_3(GroupSub1(Self))) item 0 to lsSelArthro_1
54798>>>>>            Set psSelArthro_1 to (Trim(lsSelArthro_1))
54799>>>>>            Get value of (FrmG12_4(GroupSub1(Self))) item 0 to lsSelArthro_2
54800>>>>>            Set psSelArthro_2 to (Trim(lsSelArthro_2))
54801>>>>>        
54801>>>>>            Set piSeries to 0
54802>>>>>        
54802>>>>>            //--------------------------------------------------------------------------------
54802>>>>>            Get checked_State of (chkbCurr0(oSelectCurr(Self))) to liState1
54803>>>>>            Set piState1 to liState1
54804>>>>>            Get checked_State of (chkbCurr00(oSelectCurr(Self))) to liState2
54805>>>>>            Set piState2 to liState2
54806>>>>>            Get checked_State of (chkbCurrR(oSelectCurr(Self))) to liState3
54807>>>>>            Set piState3 to liState3
54808>>>>>            Get checked_State of (chkbKeepTogether(oSelectCurr(Self))) to liKeepSectionTogether
54809>>>>>            Set piKeepSectionTogether to liKeepSectionTogether
54810>>>>>            //--------------------------------------------------------------------------------
54810>>>>>        
54810>>>>>            Get Report_Object_Id to liRptId
54811>>>>>            If (liRptId) Send Rebuild_Constraints to liRptId
54814>>>>>        
54814>>>>>            if (piState1(Self) = 1) begin
54816>>>>>                    Set piSeries to 1 //Book1
54817>>>>>                    Set piState1 to 0
54818>>>>>                    Send Run_Report
54819>>>>>            end
54819>>>>>>
54819>>>>>            if (piState2(Self) = 1) begin
54821>>>>>                    Set piSeries to 2 //Book2
54822>>>>>                    Set piState2 to 0
54823>>>>>                    send Run_Report
54824>>>>>            end
54824>>>>>>
54824>>>>>            if (piState3(Self) = 1) begin
54826>>>>>                    Set piSeries to 3 //Reporting
54827>>>>>                    Set piState3 to 0
54828>>>>>                    send Run_Report
54829>>>>>            end
54829>>>>>>
54829>>>>>            If (piSeries(Self) = 0) send Run_Report
54832>>>>>        
54832>>>>>            if (piKeepSectionTogether(Self) = 1) begin
54834>>>>>                Set piKeepSectionTogether to 0
54835>>>>>                send page_bottom to (BMoves_BasicReport(Self))
54836>>>>>                formfeed
54837>>>>>>
54837>>>>>            end
54837>>>>>>
54837>>>>>        
54837>>>>>            If iOutputDevice EQ PRINT_TO_WINDOW Begin
54839>>>>>               //Send DoRunEditor FileName "Empor"
54839>>>>>               RunProgram background "NotePad" FileName
54840>>>>>               EraseFile FileName
54841>>>>>>
54841>>>>>            End
54841>>>>>>
54841>>>>>        End_Procedure   // StartReport
54842>>>>>        
54842>>>>>        Function Bank_Descr String asCode Returns string
54844>>>>>            String lsDescr
54845>>>>>        
54845>>>>>            Clear Codemast
54846>>>>>            Move "BANK" to CodeMast.Type
54847>>>>>            Move asCode to CodeMast.Code
54848>>>>>            Find eq Codemast by Index.1
54849>>>>>>
54849>>>>>            [Found] Move (Trim(Codemast.Description)) to lsDescr
54850>>>>>            Function_Return lsDescr
54851>>>>>        End_Function // Bank_Descr
54852>>>>>        
54852>>>>>        Object BMoves_BasicReport is a BasicReportSub
54854>>>>>        
54854>>>>>            if (piKeepSectionTogether(Self) = 1) begin
54856>>>>>                set new_page_state to false
54857>>>>>            end
54857>>>>>>
54857>>>>>        
54857>>>>>           Set report_view_id to (Parent(Self))
54858>>>>>           set report_caption to "ƒ ˜› ¡˜©å˜ ©œ œ¥â¢ ¥ž             "
54859>>>>>           set report_title to "„¡«ç§à©ž €¨Ÿ¨à¤                     "
54860>>>>>           Report_Main_File BMove
54861>>>>>           Report_breaks Bmove.Barticl_Hmnia Bmove.Barticl_Recr
54875>>>>>        
54875>>>>>           Procedure Constrain
54877>>>>>                //jsjsjs 29/01/2001 Number lnSelArthro lnSelArthro_1 lnSelArthro_2
54877>>>>>                String lsSelArthro lsSelArthro_1 lsSelArthro_2 sbranch
54878>>>>>                Integer liGarticlStatusE
54878>>>>>                get psbranch to sbranch
54879>>>>>                Constrain Bmove.Company_Code eq SysCurXr.Company_Code
54881>>>>>                if (sbranch<>'');                    Constrain Bmove.Branch_Code  eq Sbranch
54885>>>>>                Constrain Bmove.Year_Year    eq SysCurXr.Year_Year
54887>>>>>        
54887>>>>>                Get psSelArthro     to lsSelArthro
54888>>>>>                Get psSelArthro_1   to lsSelArthro_1
54889>>>>>                Get psSelArthro_2   to lsSelArthro_2
54890>>>>>        
54890>>>>>                If (pdDate_From        (Self)<>'')  Constrain Bmove.Barticl_Hmnia ge (pdDate_From(Self))
54894>>>>>                If (pdDate_To          (Self)<>'')  Constrain Bmove.Barticl_Hmnia le (pdDate_To(Self))
54898>>>>>                if (psBtypKin_Recr_From(Self)<>'')  Constrain Bmove.Btypkin_Recr  ge (psBtypKin_Recr_From(Self))
54902>>>>>                if (psBtypKin_Recr_To  (Self)<>'')  Constrain Bmove.Btypkin_Recr  le (psBtypKin_Recr_To(Self))
54906>>>>>                if (lsSelArthro              <>'')  Constrain Bmove.Barticl_recr  eq lsSelArthro
54910>>>>>                Else if ((lsSelArthro_1<>'') OR (lsSelArthro_2 <> '')) Begin
54913>>>>>                     If  (lsSelArthro_1<>'') Constrain Bmove.Barticl_recr ge lsSelArthro_1
54917>>>>>                     If  (lsSelArthro_2<>'') Constrain Bmove.Barticl_recr le lsSelArthro_2
54921>>>>>                End
54921>>>>>>
54921>>>>>                Forward Send Constrain
54923>>>>>           End_Procedure // Constrain
54924>>>>>        
54924>>>>>           Function Starting_Report Returns Integer
54926>>>>>                Zero_SubTotals SubHeaderR044_1.10
54927>>>>>                Zero_SubTotals BodyR044.7 BodyR044.10 RecParArticl.1
54930>>>>>                Zero_SubTotals SubtotalR044_2.1 SubtotalR044_2.2
54932>>>>>           End_Function // Starting_Report
54933>>>>>        
54933>>>>>           Function Starting_Main_Report Returns Integer
54935>>>>>              Integer iRetVal
54936>>>>>              Integer iIndexR044 liRepPanelId
54936>>>>>              Forward Get Starting_Main_Report to iRetval
54938>>>>>        
54938>>>>>              If (piFromGmoveView(Self)) Begin
54940>>>>>                   Move 5 to iIndexR044  //
54941>>>>>              End
54941>>>>>>
54941>>>>>              Else Begin
54942>>>>>                   Move 5 to iIndexR044
54943>>>>>              End
54943>>>>>>
54943>>>>>              Report_Index BY iIndexR044    // set the sort order
54945>>>>>              Blankform FooterR044_1.1
54946>>>>>>
54946>>>>>              Get Report_Status_Panel to liRepPanelId
54947>>>>>              set button_text of lireppanelid to "&€¡ç¨à©ž"
54948>>>>>              Set page_feed to  0 //66 // default -2
54949>>>>>              Set page_end  to 63    // default 59
54950>>>>>              Function_Return iRetval
54951>>>>>           End_Function
54952>>>>>        
54952>>>>>           Procedure_Section Page_Top as HeaderR044
54957>>>>>              Integer iPage
54957>>>>>              string sbranch
54957>>>>>              Get Page_Count  To iPage
54958>>>>>              get psbranch    to sbranch
54959>>>>>              clear branch
54960>>>>>              move syscurxr.company_code to branch.company_code
54961>>>>>              move sbranch               to branch.branch_code
54962>>>>>              find eq branch by index.1
54963>>>>>>
54963>>>>>              if (found=1) print branch.branch_name to HeaderR044.2
54966>>>>>              else         print ''                 to HeaderR044.2
54968>>>>>              print SysCurXr.Company_Name to HeaderR044.1
54969>>>>>            //  print SysCurXr.Branch_Name  to HeaderR044.2
54969>>>>>              print SysCurXr.Year_Descr   to HeaderR044.3
54970>>>>>        
54970>>>>>             // Print iPage                to HeaderR044.7
54970>>>>>              OutPut_PageCheck
54971>>>>>           End_Procedure
54972>>>>>        
54972>>>>>           Procedure_Section SubHeader1
54974>>>>>           End_Procedure // SubHeader1
54975>>>>>        
54975>>>>>           Procedure_Section SubHeader2 as SubheaderR044_1
54980>>>>>              Integer iPage liSeries
54980>>>>>              Number lnYpol
54980>>>>>              String lsCCode
54980>>>>>        
54980>>>>>        
54980>>>>>              Get piSeries to liSeries
54981>>>>>              Print Btypkin.Btypkin_Pdescr to SubheaderR044_1.1
54982>>>>>              Print Btypkin.Btypkin_Seira  to SubheaderR044_1.2
54983>>>>>              Print Btypkin.Btypkin_Code   to SubheaderR044_1.3
54984>>>>>              Print Barticl.Barticl_No     to SubheaderR044_1.4
54985>>>>>              Print Barticl.Barticl_Rec0   to SubheaderR044_1.5
54986>>>>>              Print Barticl.Barticl_Hmnia  to SubheaderR044_1.6
54987>>>>>              Print Barticl.Barticl_Epon1  to SubheaderR044_1.7
54988>>>>>              Print Barticl.Barticl_Epon2  to SubheaderR044_1.8
54989>>>>>        
54989>>>>>              If (liSeries = 1) Begin
54991>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
54992>>>>>                Move Year.Year_C_Code0    to lsCCode
54993>>>>>              End
54993>>>>>>
54993>>>>>              Else If (liSeries = 2) Begin
54996>>>>>                Move Barticl.Barticl_Sv00 to lnYpol
54997>>>>>                Move Year.Year_C_Code00   to lsCCode
54998>>>>>              End
54998>>>>>>
54998>>>>>              Else If (liSeries = 3) Begin
55001>>>>>                Move Barticl.Barticl_SvR  to lnYpol
55002>>>>>                Move Year.Year_C_CodeR    to lsCCode
55003>>>>>              End
55003>>>>>>
55003>>>>>              Else If (liSeries = 0) Begin
55006>>>>>                Move Barticl.Barticl_Sv0  to lnYpol
55007>>>>>                Move Year.Year_C_Code0    to lsCCode
55008>>>>>              End
55008>>>>>>
55008>>>>>              Print lscCode                to SubheaderR044_1.9
55009>>>>>              Print lnYpol                 to SubheaderR044_1.10
55010>>>>>              Print Barticl.Barticl_Aitiol to SubheaderR044_1.11
55011>>>>>        
55011>>>>>              OutPut_PageCheck
55012>>>>>           End_Procedure
55013>>>>>        
55013>>>>>           Procedure_Section  Body as BodyR044
55018>>>>>             Integer liSeries
55018>>>>>             Number lnAjia
55018>>>>>             String lsCCode
55018>>>>>        
55018>>>>>             send update_status ('„šš¨˜­ã ' + string(barticl.barticl_hmnia) + ":" +  string(bmove.bmove_rec0))
55019>>>>>             Get piSeries to liSeries
55020>>>>>             Print Bmove.Bmove_aa                to BodyR044.1
55021>>>>>             Print Baxiokat.Baxiokat_Descr       to BodyR044.2
55022>>>>>             Print Baxio.Baxio_Code              to BodyR044.3
55023>>>>>             Print (Bank_Descr(Self,Baxio.Baxio_Banka))    to BodyR044.4
55024>>>>>             Print Baxio.Baxio_No                to BodyR044.5
55025>>>>>        
55025>>>>>             Print Baxio.Baxio_C_Code2           to BodyR044.6
55026>>>>>             Print Baxio.Baxio_V2                to BodyR044.7 //{ points=2} //Reccord
55027>>>>>        
55027>>>>>             Print Baxio.Baxio_Hmnial            to BodyR044.8
55028>>>>>        
55028>>>>>             if (liSeries = 1) begin
55030>>>>>                Move Year.Year_C_Code0  to lsCCode
55031>>>>>                Move Baxio.Baxio_V0     to lnAjia
55032>>>>>             end
55032>>>>>>
55032>>>>>             if (liSeries = 2) begin
55034>>>>>                Move Year.Year_C_Code00 to lsCCode
55035>>>>>                Move Baxio.Baxio_V00    to lnAjia
55036>>>>>             End
55036>>>>>>
55036>>>>>             if (liSeries = 3) begin
55038>>>>>                Move Year.Year_C_CodeR  to lsCCode
55039>>>>>                 Move Baxio.Baxio_VR    to lnAjia
55040>>>>>             End
55040>>>>>>
55040>>>>>             if (liSeries = 0) begin
55042>>>>>                Move Year.Year_C_Code0  to lsCCode
55043>>>>>                Move Baxio.Baxio_V0     to lnAjia
55044>>>>>             end
55044>>>>>>
55044>>>>>        
55044>>>>>             Print lsCCode                       to BodyR044.9  //{ points=2} BOOK
55045>>>>>             Print lnAjia                        to BodyR044.10 //{ points=2} BOOK
55046>>>>>             Add 1 to RecParArticl.1
55047>>>>>             OutPut_PageCheck
55048>>>>>           End_Procedure
55049>>>>>        
55049>>>>>           Procedure_Section  Subtotal2 as SubtotalR044_2
55054>>>>>        
55054>>>>>             Print    RecParArticl.1   to SubtotalR044_2.1
55055>>>>>             Subtotal BodyR044.10      to SubtotalR044_2.2 //{ points=2}
55057>>>>>             BlankForm RecParArticl.1
55058>>>>>>
55058>>>>>        
55058>>>>>             OutPut_PageCheck
55059>>>>>           end_Procedure  // Subtotal2
55060>>>>>        
55060>>>>>           Procedure_Section  Subtotal1 as SubtotalR044_1
55065>>>>>        
55065>>>>>             //Subtotal SubtotalR044_2.2 to SubtotalR044_1.1 { points=2}
55065>>>>>             //Subtotal SubtotalR044_2.3 to SubtotalR044_1.2 { points=2}
55065>>>>>        
55065>>>>>             //If (piFromGmoveView(Self)=0) OutPut_PageCheck
55065>>>>>        
55065>>>>>           end_Procedure // Subtotal1
55066>>>>>        
55066>>>>>           Procedure_Section Page_Bottom as FooterR044_1
55075>>>>>               if (piKeepSectionTogether(self) <> 1)  OutPut_PageCheck
55078>>>>>           End_Procedure
55079>>>>>        
55079>>>>>        
55079>>>>>           Procedure Ending_Report
55081>>>>>               Integer rVal
55082>>>>>               Blankform SubtotalR044_2.1
55083>>>>>>
55083>>>>>               // „§˜¤˜­¦¨á «à¤ Buffers
55083>>>>>               Get fiRefindYear to rVal
55084>>>>>           End_Procedure
55085>>>>>        
55085>>>>>        End_Object // GMoves_BasicReport
55086>>>>>        
55086>>>>>        Procedure Activate_View Returns Integer
55088>>>>>            Integer Rval
55089>>>>>            Forward Get MSG_Activate_View   to Rval
55091>>>>>            If (Not(rVal))  Begin
55093>>>>>                Set Value of (frmCompany(grpYear(Self))) to SysCurXr.Company_Name
55094>>>>>                Set Value of (frmBranch(grpYear(Self)))  to SysCurXr.Branch_Name
55095>>>>>                Set Value of (frmYear(grpYear(Self)))    to SysCurXr.Year_Descr
55096>>>>>                set value of (formsub5(self))            to SysCurXr.Branch_code
55097>>>>>                set label of (chkbCurr0(oSelectCurr(Self)))  To SysCurXr.C_Code0
55098>>>>>                set label of (chkbCurr00(oSelectCurr(Self))) To SysCurXr.C_Code00
55099>>>>>                set label of (chkbCurrR(oSelectCurr(Self)))  To SysCurXr.C_CodeR
55100>>>>>                Set checked_State of (chkbCurr0(oSelectCurr(Self))) to 1
55101>>>>>            End
55101>>>>>>
55101>>>>>            Procedure_Return rVal
55102>>>>>        End_Procedure // Activate_View
55103>>>>>        
55103>>>>>        Procedure Request_Clear
55105>>>>>            Set Value of (FormSub1(GroupSub2(Self))) Item 0 to ""
55106>>>>>            Set Value of (FormSub2(GroupSub2(Self))) Item 0 to ""
55107>>>>>            Set Value of (frmG12_3(GroupSub1(Self))) Item 0 to ""
55108>>>>>            Set Value of (frmG12_4(GroupSub1(Self))) Item 0 to ""
55109>>>>>            Set Value of (frmG1(GroupSub3(Self))) Item 0 to ""
55110>>>>>            Set Value of (frmG2(GroupSub3(Self))) Item 0 to ""
55111>>>>>            Set checked_State of (chkbCurr0(oSelectCurr(Self))) to True
55112>>>>>            Set checked_State of (chkbCurr00(oSelectCurr(Self))) to False
55113>>>>>            Set checked_State of (chkbCurrR(oSelectCurr(Self))) to False
55114>>>>>            Set checked_State of (chkbKeepTogether(oSelectCurr(Self))) to False
55115>>>>>            Send Activate to (FormSub1(GroupSub2(Self)))
55116>>>>>        End_Procedure // Request_Clear
55117>>>>>        
55117>>>>>        //Set Verify_Exit_Msg To Get_No_Confirmation
55117>>>>>        On_Key kSave_Record Send KeyAction to oPrint_bn
55118>>>>>        On_Key kCancel      Send KeyAction to oExit_bn
55119>>>>>        On_Key kClear       Send Request_Clear
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        
55120>>>>>        //AB-StoreEnd
55120>>>>>
55120>>>>>    End_Object    // R044
55121>>>>>
55121>>>>>
55121>>>>>    //AB-StoreStart
55121>>>>>            
55121>>>>>            
55121>>>>>            
55121>>>>>            
55121>>>>>            
55121>>>>>            
55121>>>>>    //AB-StoreEnd
55121>>>>>
55121>>>>>//AB/     End_Object    // prj
55121>>>Use v037.vw
INCLUDING FILE: V037.VW
55121>>>>>//AB/ Project V037:BAXIO
55121>>>>>//AB/ Object prj is a View_Project
55121>>>>>//AB/     Set ProjectName to "V037:BAXIO"
55121>>>>>//AB/     Set ProjectFileName to "V037.VW"
55121>>>>>
55121>>>>>// Project Object Structure
55121>>>>>//   VW037 is a dbViewSub
55121>>>>>//     Btypkin_DD is a DataDictionary
55121>>>>>//     Baxiokat_DD is a DataDictionary
55121>>>>>//     Barticl_DD is a DataDictionary
55121>>>>>//     Baxio_DD is a DataDictionary
55121>>>>>//     Syscurxr_DD is a DataDictionary
55121>>>>>//     Bmove_DD is a DataDictionary
55121>>>>>//     Baxiokat_Baxiokat_Code is a dbFormSub
55121>>>>>//     Baxiokat_Baxiokat_Descr is a dbFormSub
55121>>>>>//     Baxio_Baxio_Code is a dbFormSub
55121>>>>>//     Baxio_Baxio_Status is a dbFormSub
55121>>>>>//     Baxio_Baxio_Place is a dbFormSub
55121>>>>>//     dbTbDlgAxio is a dbTabDialogSub
55121>>>>>//       TP_Additional is a dbTabPage
55121>>>>>//         dbGrpObligate is a dbGroupSub
55121>>>>>//           Baxio_Baxio_Hmnial is a dbFormSub
55121>>>>>//           Baxio_Baxio_V4 is a dbFormSub
55121>>>>>//           Rate0 is a dbFormSub
55121>>>>>//           Rate00 is a dbFormSub
55121>>>>>//           RateR is a dbFormSub
55121>>>>>//           TextBoxSub3 is a TextBoxSub
55121>>>>>//           TextBoxSub4 is a TextBoxSub
55121>>>>>//           TextBoxSub5 is a TextBoxSub
55121>>>>>//           txtnom1 is a TextBoxSub
55121>>>>>//           txtnom2 is a TextBoxSub
55121>>>>>//           txtnom3 is a TextBoxSub
55121>>>>>//           Baxio_Baxio_C_Code2 is a dbFormSub
55121>>>>>//         dbGrpOptional is a dbGroupSub
55121>>>>>//           Baxio_Baxio_Ekdoths is a dbFormSub
55121>>>>>//           Baxio_Baxio_Ekdothse is a dbFormSub
55121>>>>>//           Baxio_Baxio_Sediatagh is a dbFormSub
55121>>>>>//           Baxio_Baxio_Sdiataghe is a dbFormSub
55121>>>>>//           Baxio_Baxio_Banka is a dbComboFormSub
55121>>>>>//           Baxio_Baxio_No is a dbFormSub
55121>>>>>//           Baxio_Baxio_From is a dbComboFormSub
55121>>>>>//           Baxio_Baxio_Topos is a dbComboFormSub
55121>>>>>//           Baxio_Baxio_Opistho is a dbEditSub
55121>>>>>//           TextBoxSub6 is a TextBoxSub
55121>>>>>//           TextBoxSub7 is a TextBoxSub
55121>>>>>//           TextBoxSub8 is a TextBoxSub
55121>>>>>//           TextBoxSub9 is a TextBoxSub
55121>>>>>//           TextBoxSub10 is a TextBoxSub
55121>>>>>//           TextBoxSub11 is a TextBoxSub
55121>>>>>//           TextBoxSub12 is a TextBoxSub
55121>>>>>//           Textbox3 is a Textbox
55121>>>>>//           Textbox4 is a Textbox
55121>>>>>//       TP_Status is a dbTabPage
55121>>>>>//         dbGrpEispraktea is a dbGroupSub
55121>>>>>//           Baxio_Baxio_Fbarticl is a dbFormSub
55121>>>>>//           Baxio_Baxio_Code_In is a dbFormSub
55121>>>>>//           Baxio_Baxio_Epon_In is a dbFormSub
55121>>>>>//           dbFrmHmnia is a dbFormSub
55121>>>>>//           dbFrmNo is a dbFormSub
55121>>>>>//           dbFrmGtypkin is a dbFormSub
55121>>>>>//           TextBoxSub18 is a TextBoxSub
55121>>>>>//           TextBoxSub19 is a TextBoxSub
55121>>>>>//           TextBoxSub24 is a TextBoxSub
55121>>>>>//           TextBoxSub27 is a TextBoxSub
55121>>>>>//           TextBoxSub30 is a TextBoxSub
55121>>>>>//         dbGrpPlhrotea is a dbGroupSub
55121>>>>>//           Baxio_Baxio_Lbarticl is a dbFormSub
55121>>>>>//           Baxio_Baxio_Code_Out is a dbFormSub
55121>>>>>//           Baxio_Baxio_Epon_Out is a dbFormSub
55121>>>>>//           dbFrmHmnia is a dbFormSub
55121>>>>>//           dbFrmNo is a dbFormSub
55121>>>>>//           dbFrmGtypkin is a dbFormSub
55121>>>>>//           TextBoxSub20 is a TextBoxSub
55121>>>>>//           TextBoxSub21 is a TextBoxSub
55121>>>>>//           TextBoxSub25 is a TextBoxSub
55121>>>>>//           TextBoxSub28 is a TextBoxSub
55121>>>>>//           TextBoxSub31 is a TextBoxSub
55121>>>>>//         dbGrpCurrentStat is a dbGroupSub
55121>>>>>//           Baxio_Baxio_Lcode is a dbFormSub
55121>>>>>//           Baxio_Baxio_Lepon is a dbFormSub
55121>>>>>//           Baxio_Baxio_Lpar is a dbFormSub
55121>>>>>//           dbFrmHmnia is a dbFormSub
55121>>>>>//           dbFrmNo is a dbFormSub
55121>>>>>//           dbFrmGtypkin is a dbFormSub
55121>>>>>//           TextBoxSub22 is a TextBoxSub
55121>>>>>//           TextBoxSub23 is a TextBoxSub
55121>>>>>//           TextBoxSub26 is a TextBoxSub
55121>>>>>//           TextBoxSub29 is a TextBoxSub
55121>>>>>//           TextBoxSub32 is a TextBoxSub
55121>>>>>//       TP_Bmove is a dbTabPage
55121>>>>>//         grdBmove is a dbGridSub
55121>>>>>//     dbGrpYear is a dbGroupSub
55121>>>>>//       Company_Company_Name is a dbFormSub
55121>>>>>//       Branch_Branch_Name is a dbFormSub
55121>>>>>//       Year_Year_Year is a dbFormSub
55121>>>>>//       otxtCompany is a TextBoxSub
55121>>>>>//       otxtBranch is a TextBoxSub
55121>>>>>//       otxtYear is a TextBoxSub
55121>>>>>//     TextBoxSub1 is a TextBoxSub
55121>>>>>//     TextBoxSub2 is a TextBoxSub
55121>>>>>//     TextBoxSub13 is a TextBoxSub
55121>>>>>//     TextBoxSub14 is a TextBoxSub
55121>>>>>
55121>>>>>// Register all objects
55121>>>>>Register_Object Barticl_DD
55121>>>>>Register_Object Baxio_Baxio_Banka
55121>>>>>Register_Object Baxio_Baxio_C_Code2
55121>>>>>Register_Object Baxio_Baxio_Code
55121>>>>>Register_Object Baxio_Baxio_Code_In
55121>>>>>Register_Object Baxio_Baxio_Code_Out
55121>>>>>Register_Object Baxio_Baxio_Ekdoths
55121>>>>>Register_Object Baxio_Baxio_Ekdothse
55121>>>>>Register_Object Baxio_Baxio_Epon_In
55121>>>>>Register_Object Baxio_Baxio_Epon_Out
55121>>>>>Register_Object Baxio_Baxio_Fbarticl
55121>>>>>Register_Object Baxio_Baxio_From
55121>>>>>Register_Object Baxio_Baxio_Hmnial
55121>>>>>Register_Object Baxio_Baxio_Lbarticl
55121>>>>>Register_Object Baxio_Baxio_Lcode
55121>>>>>Register_Object Baxio_Baxio_Lepon
55121>>>>>Register_Object Baxio_Baxio_Lpar
55121>>>>>Register_Object Baxio_Baxio_No
55121>>>>>Register_Object Baxio_Baxio_Opistho
55121>>>>>Register_Object Baxio_Baxio_Place
55121>>>>>Register_Object Baxio_Baxio_Sdiataghe
55121>>>>>Register_Object Baxio_Baxio_Sediatagh
55121>>>>>Register_Object Baxio_Baxio_Status
55121>>>>>Register_Object Baxio_Baxio_Topos
55121>>>>>Register_Object Baxio_Baxio_V4
55121>>>>>Register_Object Baxio_DD
55121>>>>>Register_Object Baxiokat_Baxiokat_Code
55121>>>>>Register_Object Baxiokat_Baxiokat_Descr
55121>>>>>Register_Object Baxiokat_DD
55121>>>>>Register_Object Bmove_DD
55121>>>>>Register_Object Branch_Branch_Name
55121>>>>>Register_Object Btypkin_DD
55121>>>>>Register_Object Company_Company_Name
55121>>>>>Register_Object dbFrmGtypkin
55121>>>>>Register_Object dbFrmHmnia
55121>>>>>Register_Object dbFrmNo
55121>>>>>Register_Object dbGrpCurrentStat
55121>>>>>Register_Object dbGrpEispraktea
55121>>>>>Register_Object dbGrpObligate
55121>>>>>Register_Object dbGrpOptional
55121>>>>>Register_Object dbGrpPlhrotea
55121>>>>>Register_Object dbGrpYear
55121>>>>>Register_Object dbTbDlgAxio
55121>>>>>Register_Object grdBmove
55121>>>>>Register_Object otxtBranch
55121>>>>>Register_Object otxtCompany
55121>>>>>Register_Object otxtYear
55121>>>>>Register_Object Rate0
55121>>>>>Register_Object Rate00
55121>>>>>Register_Object RateR
55121>>>>>Register_Object Syscurxr_DD
55121>>>>>Register_Object TextBoxSub1
55121>>>>>Register_Object TextBoxSub10
55121>>>>>Register_Object TextBoxSub11
55121>>>>>Register_Object TextBoxSub12
55121>>>>>Register_Object TextBoxSub13
55121>>>>>Register_Object TextBoxSub14
55121>>>>>Register_Object TextBoxSub18
55121>>>>>Register_Object TextBoxSub19
55121>>>>>Register_Object TextBoxSub2
55121>>>>>Register_Object TextBoxSub20
55121>>>>>Register_Object TextBoxSub21
55121>>>>>Register_Object TextBoxSub22
55121>>>>>Register_Object TextBoxSub23
55121>>>>>Register_Object TextBoxSub24
55121>>>>>Register_Object TextBoxSub25
55121>>>>>Register_Object TextBoxSub26
55121>>>>>Register_Object TextBoxSub27
55121>>>>>Register_Object TextBoxSub28
55121>>>>>Register_Object TextBoxSub29
55121>>>>>Register_Object TextBoxSub3
55121>>>>>Register_Object TextBoxSub30
55121>>>>>Register_Object TextBoxSub31
55121>>>>>Register_Object TextBoxSub32
55121>>>>>Register_Object TextBoxSub4
55121>>>>>Register_Object TextBoxSub5
55121>>>>>Register_Object TextBoxSub6
55121>>>>>Register_Object TextBoxSub7
55121>>>>>Register_Object TextBoxSub8
55121>>>>>Register_Object TextBoxSub9
55121>>>>>Register_Object Textbox3
55121>>>>>Register_Object Textbox4
55121>>>>>Register_Object TP_Additional
55121>>>>>Register_Object TP_Bmove
55121>>>>>Register_Object TP_Status
55121>>>>>Register_Object txtnom1
55121>>>>>Register_Object txtnom2
55121>>>>>Register_Object txtnom3
55121>>>>>Register_Object VW037
55121>>>>>Register_Object Year_Year_Year
55121>>>>>
55121>>>>>
55121>>>>>//AB/ AppBuild VIEW
55121>>>>>
55121>>>>>//AB-IgnoreStart
55121>>>>>
55121>>>>>Use dbView.Sub
55121>>>>>Use DFAllEnt.pkg
55121>>>>>Use dbForm.Sub
55121>>>>>Use dbTabdlg.Sub
55121>>>>>Use dbGroup.Sub
55121>>>>>Use Txtbox.Sub
55121>>>>>Use dbCmbfrm.Sub
55121>>>>>Use dbEdit.Sub
55121>>>>>Use dbGrid.Sub
55121>>>>>
55121>>>>>Use BTYPKIN.DD
55121>>>>>Use BAXIOKAT.DD
55121>>>>>Use BARTICL.DD
55121>>>>>Use BAXIO.DD
55121>>>>>Use SYSCURXR.DD
55121>>>>>Use BMOVE.DD
55121>>>>>
55121>>>>>//AB-IgnoreEnd
55121>>>>>
55121>>>>>ACTIVATE_VIEW Activate_VW037 FOR VW037
55125>>>>>
55125>>>>>Object VW037 is a dbViewSub
55127>>>>>
55127>>>>>    //AB-StoreTopStart
55127>>>>>                                                
55127>>>>>    //AB-StoreTopEnd
55127>>>>>
55127>>>>>    Set Label to "V037:€¥ æš¨˜­˜"
55128>>>>>    Set Size to 278 515
55129>>>>>    Set Location to 0 5
55130>>>>>
55130>>>>>    //AB-DDOStart
55130>>>>>
55130>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
55132>>>>>
55132>>>>>        //AB-StoreStart
55132>>>>>                                                                                                                                                                                                                
55132>>>>>        Set Field_Prompt_Object Field Btypkin.Btypkin_Code to None
55133>>>>>        
55133>>>>>        
55133>>>>>        
55133>>>>>        //AB-StoreEnd
55133>>>>>
55133>>>>>    End_Object    // Btypkin_DD
55134>>>>>
55134>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
55136>>>>>
55136>>>>>        //AB-StoreStart
55136>>>>>                                                                                                                                                                                                                
55136>>>>>        Set Field_Options Field Baxiokat.Baxiokat_Code  to DD_Clear_Field_Options DD_Required
55137>>>>>        
55137>>>>>        Set Foreign_Field_Options DD_IndexField         to DD_Clear_Field_Options DD_FindReq
55138>>>>>        Set Foreign_Field_Options DD_KeyField           to DD_Clear_Field_Options DD_FindReq
55139>>>>>        
55139>>>>>        
55139>>>>>        //AB-StoreEnd
55139>>>>>
55139>>>>>    End_Object    // Baxiokat_DD
55140>>>>>
55140>>>>>    Object Barticl_DD is a Barticl_DataDictionary
55142>>>>>        Set DDO_Server to (Btypkin_DD(self))
55143>>>>>
55143>>>>>        //AB-StoreStart
55143>>>>>                                                                                                                                                                                                                
55143>>>>>        Set Field_Prompt_Object Field Barticl.Barticl_Hmnia to None
55144>>>>>        Set Field_Prompt_Object Field Barticl.Barticl_No    to None
55145>>>>>        
55145>>>>>        //AB-StoreEnd
55145>>>>>
55145>>>>>    End_Object    // Barticl_DD
55146>>>>>
55146>>>>>    Object Baxio_DD is a Baxio_DataDictionary
55148>>>>>        Set DDO_Server to (Baxiokat_DD(self))
55149>>>>>
55149>>>>>        //AB-StoreStart
55149>>>>>        set pimustnotconstrain to 2
55150>>>>>        Function Validate_Save Returns Integer
55152>>>>>            Integer rVal
55153>>>>>            Forward Get Validate_Save to rVal
55155>>>>>            If (Not(rval)) If (Not(Current_Record(Self))) Move 1 to rVal
55160>>>>>            Function_Return rVal
55161>>>>>        End_Procedure // Validate_Save
55162>>>>>        
55162>>>>>        
55162>>>>>        // AYTA ENERGOPOIOYNTAI MONO GIA KOZANH KAI APENERGOPOIOYME THN
55162>>>>>        // VALIDATE_SAVE APO PANO
55162>>>>>        // GIA NA MPORESEI NA DIAGRAPSEI 2PLO PERASMENA SOMATA
55162>>>>>        // APO 2PLH METAFORA AXIOGRAFON STHN ALLAGH THS XRHSHS
55162>>>>>        //Function Validate_Delete  Returns Integer
55162>>>>>        //       Integer iReturnVal
55162>>>>>        //       Function_Return iReturnVal
55162>>>>>        //End_Function //validate_delete
55162>>>>>        
55162>>>>>        //Procedure Request_Save
55162>>>>>        //End_Procedure
55162>>>>>        
55162>>>>>        
55162>>>>>        
55162>>>>>        
55162>>>>>        
55162>>>>>        
55162>>>>>        
55162>>>>>        //AB-StoreEnd
55162>>>>>
55162>>>>>    End_Object    // Baxio_DD
55163>>>>>
55163>>>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
55165>>>>>    End_Object    // Syscurxr_DD
55166>>>>>
55166>>>>>    Object Bmove_DD is a Bmove_DataDictionary
55168>>>>>        Set DDO_Server to (Barticl_DD(self))
55169>>>>>        Set DDO_Server to (Baxio_DD(self))
55170>>>>>        Set Constrain_File to Baxio.File_Number
55171>>>>>
55171>>>>>        //AB-StoreStart
55171>>>>>        set pimustnotconstrain to 2
55172>>>>>        Set Ordering to 4
55173>>>>>        
55173>>>>>        Function Validate_Save Returns Integer
55175>>>>>            Function_Return 1
55176>>>>>        End_Procedure // Validate_Save
55177>>>>>        
55177>>>>>        Function Validate_Delete  Returns Integer
55179>>>>>            Function_Return 1
55180>>>>>        End_Function // Validate_Delete
55181>>>>>        
55181>>>>>        
55181>>>>>        
55181>>>>>        
55181>>>>>        
55181>>>>>        
55181>>>>>        //AB-StoreEnd
55181>>>>>
55181>>>>>    End_Object    // Bmove_DD
55182>>>>>
55182>>>>>    Set Main_DD to (Baxio_DD(self))
55183>>>>>    Set Server to (Baxio_DD(self))
55184>>>>>
55184>>>>>    //AB-DDOEnd
55184>>>>>
55184>>>>>    Object Baxiokat_Baxiokat_Code is a dbFormSub
55186>>>>>        Entry_Item Baxiokat.Baxiokat_code
55187>>>>>        Set Size to 13 42
55188>>>>>        Set Location to 36 41
55189>>>>>        Set Label_Col_Offset to 35
55190>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55191>>>>>    End_Object    // Baxiokat_Baxiokat_Code
55192>>>>>
55192>>>>>    Object Baxiokat_Baxiokat_Descr is a dbFormSub
55194>>>>>        Entry_Item Baxiokat.Baxiokat_descr
55195>>>>>        Set Size to 13 182
55196>>>>>        Set Location to 36 86
55197>>>>>        Set Label_Col_Offset to 2
55198>>>>>        Set Label_Justification_Mode to jMode_Right
55199>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55200>>>>>    End_Object    // Baxiokat_Baxiokat_Descr
55201>>>>>
55201>>>>>    Object Baxio_Baxio_Code is a dbFormSub
55203>>>>>        Entry_Item Baxio.Baxio_code
55204>>>>>        Set Size to 13 116
55205>>>>>        Set Location to 50 41
55206>>>>>        Set Label_Col_Offset to 35
55207>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55208>>>>>
55208>>>>>        //AB-StoreStart
55208>>>>>                                                                                                                                                                                                                
55208>>>>>        Procedure Prompt_Callback Integer hPrompt
55210>>>>>            Integer liBaxiokatCode
55211>>>>>            Get Field_Current_Value of Baxiokat_DD Field Baxiokat.Baxiokat_Code to liBaxiokatCode
55212>>>>>            Set piFragmaBaxiokatCode of hPrompt to liBaxiokatCode
55213>>>>>            Set Auto_Index_State of hPrompt to False
55214>>>>>        End_Procedure // Prompt_Callback
55215>>>>>        
55215>>>>>        
55215>>>>>        
55215>>>>>        
55215>>>>>        
55215>>>>>        
55215>>>>>        //AB-StoreEnd
55215>>>>>
55215>>>>>    End_Object    // Baxio_Baxio_Code
55216>>>>>
55216>>>>>    Object Baxio_Baxio_Status is a dbFormSub
55218>>>>>
55218>>>>>        //AB-StoreTopStart
55218>>>>>                                                                                                                                                                                                                
55218>>>>>        Function Show_Status_Descr Returns String
55220>>>>>            Integer iValue iSrv iField iObj liStatusId
55221>>>>>            String sDesc sVal
55221>>>>>            If (Current_Record(Baxio_DD(Self))) Begin
55223>>>>>                Get Server of Baxio_Baxio_Status to iSrv
55224>>>>>                Get_FieldNumber Baxio.Baxio_Status to iField
55225>>>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Status to sVal
55226>>>>>                Move Baxio_Status_VT to iObj
55227>>>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
55230>>>>>                Function_Return sDesc
55231>>>>>            End
55231>>>>>>
55231>>>>>        End_Function // Show_Status_Descr
55232>>>>>        
55232>>>>>        //AB-StoreTopEnd
55232>>>>>
55232>>>>>        Entry_Item (Show_Status_Descr(Self))
55233>>>>>        Set Size to 13 116
55234>>>>>        Set Location to 36 340
55235>>>>>        Set Label_Col_Offset to 50
55236>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55237>>>>>
55237>>>>>        //AB-StoreStart
55237>>>>>                                                                                                                                                                                                                
55237>>>>>                                                                                                                                                                                                                
55237>>>>>        //AB-StoreEnd
55237>>>>>
55237>>>>>    End_Object    // Baxio_Baxio_Status
55238>>>>>
55238>>>>>    Object Baxio_Baxio_Place is a dbFormSub
55240>>>>>
55240>>>>>        //AB-StoreTopStart
55240>>>>>                                                                                                                                                                                                                
55240>>>>>        Function Show_Place_Descr Returns String
55242>>>>>            Integer iValue iSrv iField iObj liStatusId
55243>>>>>            String sDesc sVal
55243>>>>>            If (Current_Record(Baxio_DD(Self))) Begin
55245>>>>>                Get Server of Baxio_Baxio_Place to iSrv
55246>>>>>                Get_FieldNumber Baxio.Baxio_Place to iField
55247>>>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Place to sVal
55248>>>>>                Move Baxio_Baxio_Place_VT to iObj
55249>>>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
55252>>>>>                Function_Return sDesc
55253>>>>>            End
55253>>>>>>
55253>>>>>        End_Function // Show_Place_Descr
55254>>>>>        
55254>>>>>        //AB-StoreTopEnd
55254>>>>>
55254>>>>>        Entry_Item (Show_Place_Descr(Self))
55255>>>>>        Set Size to 13 116
55256>>>>>        Set Location to 50 340
55257>>>>>        Set Label_Col_Offset to 50
55258>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55259>>>>>
55259>>>>>        //AB-StoreStart
55259>>>>>                                                                                                                                                                                                                
55259>>>>>                                                                                                                                                                                                                
55259>>>>>                                                                                                                                                                                                                
55259>>>>>                                                                                                                                                                                                                
55259>>>>>                                                                                                                                                                                                                
55259>>>>>                                                                                                                                                                                                                
55259>>>>>        //AB-StoreEnd
55259>>>>>
55259>>>>>    End_Object    // Baxio_Baxio_Place
55260>>>>>
55260>>>>>    Object dbTbDlgAxio is a dbTabDialogSub
55262>>>>>        Set Size to 191 507
55263>>>>>        Set Location to 70 2
55264>>>>>        Object TP_Additional is a dbTabPage
55266>>>>>            Set Label to "¨æ©Ÿœ«˜"
55267>>>>>            Object dbGrpObligate is a dbGroupSub
55269>>>>>                Set Label to "“§¦®¨œà« ¡á ‘«¦ ®œå˜"
55270>>>>>                Set Size to 60 492
55271>>>>>                Set Location to 3 4
55272>>>>>                Set TextColor to clNavy
55273>>>>>                Object Baxio_Baxio_Hmnial is a dbFormSub
55275>>>>>                    Entry_Item Baxio.Baxio_hmnial
55276>>>>>                    Set Size to 13 66
55277>>>>>                    Set Location to 10 82
55278>>>>>                    Set Label_Col_Offset to 70
55279>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55280>>>>>                End_Object    // Baxio_Baxio_Hmnial
55281>>>>>
55281>>>>>                Object Baxio_Baxio_V4 is a dbFormSub
55283>>>>>                    Entry_Item Baxio.Baxio_v2
55284>>>>>                    Set Size to 13 66
55285>>>>>                    Set Location to 40 82
55286>>>>>                    Set Label_Col_Offset to 70
55287>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55288>>>>>
55288>>>>>                    //AB-StoreStart
55288>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
55288>>>>>                    //Set Points Item 0 to 0
55288>>>>>                    //Set Numeric_Mask Item 0 to 14  0 ' ,*'
55288>>>>>                    
55288>>>>>                    Procedure End_Construct_Object
55290>>>>>                        Integer iDecimals
55291>>>>>                        Forward Send End_Construct_Object
55293>>>>>                        Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
55294>>>>>                        Set Points Item 0 to iDecimals
55295>>>>>                        Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
55296>>>>>                    End_Procedure
55297>>>>>                    
55297>>>>>                    
55297>>>>>                    //AB-StoreEnd
55297>>>>>
55297>>>>>                End_Object    // Baxio_Baxio_V4
55298>>>>>
55298>>>>>                Object Rate0 is a dbFormSub
55300>>>>>                    Entry_Item Baxio.Baxio_rate0
55301>>>>>                    Set Size to 13 46
55302>>>>>                    Set Location to 11 440
55303>>>>>                    Set Label_Col_Offset to 35
55304>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55305>>>>>
55305>>>>>                    //AB-StoreStart
55305>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
55305>>>>>                    Set Points Item 0 to 0
55306>>>>>                    Set Visible_State to False
55307>>>>>                    Set Enabled_State to False
55308>>>>>                    
55308>>>>>                    
55308>>>>>                    
55308>>>>>                    //AB-StoreEnd
55308>>>>>
55308>>>>>                End_Object    // Rate0
55309>>>>>
55309>>>>>                Object Rate00 is a dbFormSub
55311>>>>>                    Entry_Item Baxio.Baxio_rate00
55312>>>>>                    Set Size to 13 46
55313>>>>>                    Set Location to 26 440
55314>>>>>                    Set Label_Col_Offset to 35
55315>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55316>>>>>
55316>>>>>                    //AB-StoreStart
55316>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
55316>>>>>                    Set Points Item 0 to 2
55317>>>>>                    Set Visible_State to False
55318>>>>>                    Set Enabled_State to False
55319>>>>>                    
55319>>>>>                    //AB-StoreEnd
55319>>>>>
55319>>>>>                End_Object    // Rate00
55320>>>>>
55320>>>>>                Object RateR is a dbFormSub
55322>>>>>                    Entry_Item Baxio.Baxio_rater
55323>>>>>                    Set Size to 13 46
55324>>>>>                    Set Location to 41 440
55325>>>>>                    Set Label_Col_Offset to 35
55326>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55327>>>>>
55327>>>>>                    //AB-StoreStart
55327>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
55327>>>>>                    Set Points Item 0 to 2
55328>>>>>                    Set Visible_State to False
55329>>>>>                    Set Enabled_State to False
55330>>>>>                    
55330>>>>>                    
55330>>>>>                    //AB-StoreEnd
55330>>>>>
55330>>>>>                End_Object    // RateR
55331>>>>>
55331>>>>>                Object TextBoxSub3 is a TextBoxSub
55333>>>>>                    Set Label to "†£/¤å˜ Šã¥žª"
55334>>>>>                    Set Location to 11 18
55335>>>>>                    Set Size to 10 57
55336>>>>>                    Set TypeFace to "MS Sans Serif"
55337>>>>>                End_Object    // TextBoxSub3
55338>>>>>
55338>>>>>                Object TextBoxSub4 is a TextBoxSub
55340>>>>>                    Set Label to "Œæ£ ©£˜"
55341>>>>>                    Set Location to 24 18
55342>>>>>                    Set Size to 10 32
55343>>>>>                    Set TypeFace to "MS Sans Serif"
55344>>>>>                End_Object    // TextBoxSub4
55345>>>>>
55345>>>>>                Object TextBoxSub5 is a TextBoxSub
55347>>>>>                    Set Label to "¦©æ"
55348>>>>>                    Set Location to 39 18
55349>>>>>                    Set Size to 10 32
55350>>>>>                    Set TypeFace to "MS Sans Serif"
55351>>>>>                End_Object    // TextBoxSub5
55352>>>>>
55352>>>>>                Object txtnom1 is a TextBoxSub
55354>>>>>                    Set Label to "ˆ©¦« £å˜1"
55355>>>>>                    Set Location to 13 405
55356>>>>>                    Set Size to 10 31
55357>>>>>                    Set TypeFace to "MS Sans Serif"
55358>>>>>
55358>>>>>                    //AB-StoreStart
55358>>>>>                    Set Visible_State to False
55359>>>>>                    
55359>>>>>                    //AB-StoreEnd
55359>>>>>
55359>>>>>                End_Object    // txtnom1
55360>>>>>
55360>>>>>                Object txtnom2 is a TextBoxSub
55362>>>>>                    Set Label to "ˆ©¦« £å˜2"
55363>>>>>                    Set Location to 28 405
55364>>>>>                    Set Size to 10 31
55365>>>>>                    Set TypeFace to "MS Sans Serif"
55366>>>>>
55366>>>>>                    //AB-StoreStart
55366>>>>>                    Set Visible_State to False
55367>>>>>                    
55367>>>>>                    //AB-StoreEnd
55367>>>>>
55367>>>>>                End_Object    // txtnom2
55368>>>>>
55368>>>>>                Object txtnom3 is a TextBoxSub
55370>>>>>                    Set Label to "ˆ©¦« £å˜3"
55371>>>>>                    Set Location to 43 405
55372>>>>>                    Set Size to 10 31
55373>>>>>                    Set TypeFace to "MS Sans Serif"
55374>>>>>
55374>>>>>                    //AB-StoreStart
55374>>>>>                    Set Visible_State to False
55375>>>>>                    
55375>>>>>                    //AB-StoreEnd
55375>>>>>
55375>>>>>                End_Object    // txtnom3
55376>>>>>
55376>>>>>                Object Baxio_Baxio_C_Code2 is a dbFormSub
55378>>>>>
55378>>>>>                    //AB-StoreTopStart
55378>>>>>                    //Procedure Set_The_Decimal_Points
55378>>>>>                    //    Integer iContID
55378>>>>>                    //    String  sCode sPartlRecr
55378>>>>>                    //    date    dHmnia
55378>>>>>                    
55378>>>>>                    //    Move (dbGrpObligate(TP_Additional(dbtbDlgAxio(Self)))) to iContID
55378>>>>>                    
55378>>>>>                    //    Get Field_Current_Value Of Baxio_DD Field Baxio.Baxio_Sc_Code2 to sCode
55378>>>>>                    //    Move (Trim(sCode))  to sCode
55378>>>>>                    
55378>>>>>                    //    Clear Nomisma
55378>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
55378>>>>>                    //    Find eq Nomisma by Index.1
55378>>>>>                    //    Set Points          Of (Axia(iContID)) Item  0 to Nomisma.Dekadika
55378>>>>>                    //    Set Numeric_Mask    Of (Axia(iContID)) Item  0 to 12 Nomisma.Dekadika "*,"
55378>>>>>                    
55378>>>>>                    //    Get Label Of (TxtNom1(iContID)) Item 0 to sCode
55378>>>>>                    //    Move (Trim(sCode))  to sCode
55378>>>>>                    //    Clear Nomisma
55378>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
55378>>>>>                    //    Find eq Nomisma by Index.1
55378>>>>>                    //    Set Points          Of (X0(iContID)) Item  0 to Nomisma.Dekadika
55378>>>>>                    //    Set Points          Of (P0(iContID)) Item  0 to Nomisma.Dekadika
55378>>>>>                    //    Set Numeric_Mask Of (X0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
55378>>>>>                    //    Set Numeric_Mask Of (P0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
55378>>>>>                    
55378>>>>>                    //    Get Label Of (TxtNom2(iContID)) Item 0 to sCode
55378>>>>>                    //    Move (Trim(sCode))  to sCode
55378>>>>>                    //    Clear Nomisma
55378>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
55378>>>>>                    //    Find eq Nomisma by Index.1
55378>>>>>                    //    Set Points          Of (X00(iContID)) Item  0 to Nomisma.Dekadika
55378>>>>>                    //    Set Numeric_Mask Of (X00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
55378>>>>>                    //    Set Points          Of (P00(iContID)) Item  0 to Nomisma.Dekadika
55378>>>>>                    //    Set Numeric_Mask Of (P00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
55378>>>>>                    
55378>>>>>                    //    Get Label Of (TxtNom3(iContID)) Item 0 to sCode
55378>>>>>                    //    Move (Trim(sCode))  to sCode
55378>>>>>                    //    Clear Nomisma
55378>>>>>                    //    Move sCode to Nomisma.Nomisma_Code
55378>>>>>                    //    Find eq Nomisma by Index.1
55378>>>>>                    //    Set Points          Of (X1(iContID)) Item  0 to     Nomisma.Dekadika
55378>>>>>                    //    Set Numeric_Mask Of (X1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
55378>>>>>                    //    Set Points          Of (P1(iContID)) Item  0 to     Nomisma.Dekadika
55378>>>>>                    //    Set Numeric_Mask Of (P1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
55378>>>>>                    //End_procedure
55378>>>>>                    
55378>>>>>                    
55378>>>>>                    //AB-StoreTopEnd
55378>>>>>
55378>>>>>                    Entry_Item Baxio.Baxio_c_code2
55379>>>>>                    Set Size to 13 66
55380>>>>>                    Set Location to 25 82
55381>>>>>                    Set Label_Col_Offset to 2
55382>>>>>                    Set Label_Justification_Mode to jMode_Right
55383>>>>>                    Set Prompt_Button_Mode to pb_PromptOff
55384>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55385>>>>>
55385>>>>>                    //AB-StoreStart
55385>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
55385>>>>>                    //Procedure OnChange
55385>>>>>                    //    Send Set_The_Decimal_Points
55385>>>>>                    //End_Procedure
55385>>>>>                    
55385>>>>>                    
55385>>>>>                    //AB-StoreEnd
55385>>>>>
55385>>>>>                End_Object    // Baxio_Baxio_C_Code2
55386>>>>>
55386>>>>>
55386>>>>>                //AB-StoreStart
55386>>>>>                                                                
55386>>>>>                //AB-StoreEnd
55386>>>>>
55386>>>>>            End_Object    // dbGrpObligate
55387>>>>>
55387>>>>>            Object dbGrpOptional is a dbGroupSub
55389>>>>>                Set Label to "¨¦˜ ¨œ« ¡á ‘«¦ ®œå˜"
55390>>>>>                Set Size to 106 492
55391>>>>>                Set Location to 65 4
55392>>>>>                Set TextColor to clNavy
55393>>>>>                Object Baxio_Baxio_Ekdoths is a dbFormSub
55395>>>>>                    Entry_Item Baxio.Baxio_ekdoths
55396>>>>>                    Set Size to 13 126
55397>>>>>                    Set Location to 10 81
55398>>>>>                    Set Label_Col_Offset to 70
55399>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55400>>>>>                End_Object    // Baxio_Baxio_Ekdoths
55401>>>>>
55401>>>>>                Object Baxio_Baxio_Ekdothse is a dbFormSub
55403>>>>>                    Entry_Item Baxio.Baxio_ekdothse
55404>>>>>                    Set Size to 13 208
55405>>>>>                    Set Location to 10 264
55406>>>>>                    Set Label_Col_Offset to 35
55407>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55408>>>>>                End_Object    // Baxio_Baxio_Ekdothse
55409>>>>>
55409>>>>>                Object Baxio_Baxio_Sediatagh is a dbFormSub
55411>>>>>                    Entry_Item Baxio.Baxio_sediatagh
55412>>>>>                    Set Size to 13 126
55413>>>>>                    Set Location to 26 81
55414>>>>>                    Set Label_Col_Offset to 70
55415>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55416>>>>>                End_Object    // Baxio_Baxio_Sediatagh
55417>>>>>
55417>>>>>                Object Baxio_Baxio_Sdiataghe is a dbFormSub
55419>>>>>                    Entry_Item Baxio.Baxio_sdiataghe
55420>>>>>                    Set Size to 13 208
55421>>>>>                    Set Location to 26 264
55422>>>>>                    Set Label_Col_Offset to 35
55423>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55424>>>>>                End_Object    // Baxio_Baxio_Sdiataghe
55425>>>>>
55425>>>>>                Object Baxio_Baxio_Banka is a dbComboFormSub
55427>>>>>                    Entry_Item Baxio.Baxio_banka
55428>>>>>                    Set Size to 13 126
55429>>>>>                    Set Location to 40 81
55430>>>>>                    Set Label_Col_Offset to 70
55431>>>>>                End_Object    // Baxio_Baxio_Banka
55432>>>>>
55432>>>>>                Object Baxio_Baxio_No is a dbFormSub
55434>>>>>                    Entry_Item Baxio.Baxio_no
55435>>>>>                    Set Size to 13 126
55436>>>>>                    Set Location to 55 81
55437>>>>>                    Set Label_Col_Offset to 70
55438>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55439>>>>>                End_Object    // Baxio_Baxio_No
55440>>>>>
55440>>>>>                Object Baxio_Baxio_From is a dbComboFormSub
55442>>>>>                    Entry_Item Baxio.Baxio_from
55443>>>>>                    Set Size to 13 54
55444>>>>>                    Set Location to 70 81
55445>>>>>                    Set Label_Col_Offset to 2
55446>>>>>
55446>>>>>                    //AB-StoreStart
55446>>>>>                                                                                                                                                                                                                                                                                    
55446>>>>>                    Procedure Combo_Fill_List
55448>>>>>                        Send Combo_Add_Item  "ˆ›å¦¬" "0"
55449>>>>>                        Send Combo_Add_Item  "’¨å«¦¬" "1"
55450>>>>>                    End_Procedure
55451>>>>>                    
55451>>>>>                    
55451>>>>>                    
55451>>>>>                    
55451>>>>>                    
55451>>>>>                    
55451>>>>>                    //AB-StoreEnd
55451>>>>>
55451>>>>>                End_Object    // Baxio_Baxio_From
55452>>>>>
55452>>>>>                Object Baxio_Baxio_Topos is a dbComboFormSub
55454>>>>>                    Entry_Item Baxio.Baxio_topos
55455>>>>>                    Set Size to 13 54
55456>>>>>                    Set Location to 84 81
55457>>>>>                    Set Label_Col_Offset to 2
55458>>>>>
55458>>>>>                    //AB-StoreStart
55458>>>>>                    Procedure Combo_Fill_List
55460>>>>>                        Send Combo_Add_Item  "€«« ¡ãª" "0"
55461>>>>>                        Send Combo_Add_Item  "„§˜¨®å˜ª" "1"
55462>>>>>                    End_Procedure
55463>>>>>                    
55463>>>>>                    
55463>>>>>                    
55463>>>>>                    
55463>>>>>                    
55463>>>>>                    
55463>>>>>                    //AB-StoreEnd
55463>>>>>
55463>>>>>                End_Object    // Baxio_Baxio_Topos
55464>>>>>
55464>>>>>                Object Baxio_Baxio_Opistho is a dbEditSub
55466>>>>>                    Entry_Item Baxio.Baxio_opistho
55467>>>>>                    Set Size to 48 211
55468>>>>>                    Set Location to 50 263
55469>>>>>                End_Object    // Baxio_Baxio_Opistho
55470>>>>>
55470>>>>>                Object TextBoxSub6 is a TextBoxSub
55472>>>>>                    Set Label to "€¨® ¡æª „¡›æ«žª:"
55473>>>>>                    Set Location to 11 10
55474>>>>>                    Set Size to 10 63
55475>>>>>                    Set TypeFace to "MS Sans Serif"
55476>>>>>                End_Object    // TextBoxSub6
55477>>>>>
55477>>>>>                Object TextBoxSub7 is a TextBoxSub
55479>>>>>                    Set Label to "‘œ ƒ ˜«˜šã:"
55480>>>>>                    Set Location to 25 10
55481>>>>>                    Set Size to 10 56
55482>>>>>                    Set TypeFace to "MS Sans Serif"
55483>>>>>                End_Object    // TextBoxSub7
55484>>>>>
55484>>>>>                Object TextBoxSub8 is a TextBoxSub
55486>>>>>                    Set Label to "’¨á§œ˜"
55487>>>>>                    Set Location to 40 10
55488>>>>>                    Set Size to 10 35
55489>>>>>                    Set TypeFace to "MS Sans Serif"
55490>>>>>                End_Object    // TextBoxSub8
55491>>>>>
55491>>>>>                Object TextBoxSub9 is a TextBoxSub
55493>>>>>                    Set Label to "€¨ Ÿ£æª"
55494>>>>>                    Set Location to 55 10
55495>>>>>                    Set Size to 10 47
55496>>>>>                    Set TypeFace to "MS Sans Serif"
55497>>>>>                End_Object    // TextBoxSub9
55498>>>>>
55498>>>>>                Object TextBoxSub10 is a TextBoxSub
55500>>>>>                    Set Label to "„§à¤¬£å˜"
55501>>>>>                    Set Location to 12 224
55502>>>>>                    Set Size to 10 36
55503>>>>>                    Set TypeFace to "MS Sans Serif"
55504>>>>>                End_Object    // TextBoxSub10
55505>>>>>
55505>>>>>                Object TextBoxSub11 is a TextBoxSub
55507>>>>>                    Set Label to "„§à¤¬£å˜"
55508>>>>>                    Set Location to 28 224
55509>>>>>                    Set Size to 10 36
55510>>>>>                    Set TypeFace to "MS Sans Serif"
55511>>>>>                End_Object    // TextBoxSub11
55512>>>>>
55512>>>>>                Object TextBoxSub12 is a TextBoxSub
55514>>>>>                    Set Label to "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
55515>>>>>                    Set Location to 41 265
55516>>>>>                    Set Size to 10 79
55517>>>>>                    Set TypeFace to "MS Sans Serif"
55518>>>>>                End_Object    // TextBoxSub12
55519>>>>>
55519>>>>>                Object Textbox3 is a Textbox
55521>>>>>                    Set Label to "ˆ›å¦¬/’¨å«¦¬"
55522>>>>>                    Set Location to 71 10
55523>>>>>                    Set Size to 10 46
55524>>>>>                    Set TypeFace to "MS Sans Serif"
55525>>>>>                End_Object    // Textbox3
55526>>>>>
55526>>>>>                Object Textbox4 is a Textbox
55528>>>>>                    Set Label to "€«« ¡ãª/„§˜¨®å˜ª"
55529>>>>>                    Set Location to 86 10
55530>>>>>                    Set Size to 10 63
55531>>>>>                    Set TypeFace to "MS Sans Serif"
55532>>>>>                End_Object    // Textbox4
55533>>>>>
55533>>>>>            End_Object    // dbGrpOptional
55534>>>>>
55534>>>>>
55534>>>>>            //AB-StoreStart
55534>>>>>            set label to "‘«â¢œ®¦ª/‘é£˜ €¥ ¦š¨á­¦¬"
55535>>>>>            
55535>>>>>            //AB-StoreEnd
55535>>>>>
55535>>>>>        End_Object    // TP_Additional
55536>>>>>
55536>>>>>        Object TP_Status is a dbTabPage
55538>>>>>            Set Label to "‰˜«á©«˜©ž"
55539>>>>>            Object dbGrpEispraktea is a dbGroupSub
55541>>>>>                Set Label to "„ ©§¨˜¡«â˜"
55542>>>>>                Set Size to 44 493
55543>>>>>                Set Location to 4 3
55544>>>>>                Set TextColor to clNavy
55545>>>>>                Object Baxio_Baxio_Fbarticl is a dbFormSub
55547>>>>>
55547>>>>>                    //AB-StoreTopStart
55547>>>>>                    Procedure Find_Barticls
55549>>>>>                        Integer liBarticlRec0 liWhichBarticl
55550>>>>>                        Date ldHmnia
55550>>>>>                        String liNo liBtypkin
55550>>>>>                    
55550>>>>>                        Move Barticl.Barticl_Rec0 to liBarticlRec0
55551>>>>>                    
55551>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_In to liWhichBarticl
55552>>>>>                        If (liWhichBarticl <> 0) Begin
55554>>>>>                            Clear Barticl
55555>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
55556>>>>>                            Find eq Barticl by Index.2
55557>>>>>>
55557>>>>>                            [Found] Begin
55559>>>>>>
55559>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
55560>>>>>                                Move Barticl.Barticl_No      to liNo
55561>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
55562>>>>>                            End
55562>>>>>>
55562>>>>>                        End
55562>>>>>>
55562>>>>>                        Set Value of dbfrmHmnia   Item 0 to ldHmnia
55563>>>>>                        Set Value of dbfrmNo      Item 0 to liNo
55564>>>>>                        Set Value of dbfrmGtypkin Item 0 to liBtypkin
55565>>>>>                    
55565>>>>>                        Move "" to ldHmnia
55566>>>>>                        Move "" to liNo
55567>>>>>                        Move "" to liBtypkin
55568>>>>>                    
55568>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_Out to liWhichBarticl
55569>>>>>                        If (liWhichBarticl <> 0) Begin
55571>>>>>                            Clear Barticl
55572>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
55573>>>>>                            Find eq Barticl by Index.2
55574>>>>>>
55574>>>>>                            [Found] Begin
55576>>>>>>
55576>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
55577>>>>>                                Move Barticl.Barticl_No      to liNo
55578>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
55579>>>>>                            End
55579>>>>>>
55579>>>>>                        End
55579>>>>>>
55579>>>>>                        Set Value of (dbfrmHmnia(dbGrpPlhrotea(Self)))   Item 0 to ldHmnia
55580>>>>>                        Set Value of (dbfrmNo(dbGrpPlhrotea(Self)))      Item 0 to liNo
55581>>>>>                        Set Value of (dbfrmGtypkin(dbGrpPlhrotea(Self))) Item 0 to liBtypkin
55582>>>>>                    
55582>>>>>                        Move "" to ldHmnia
55583>>>>>                        Move "" to liNo
55584>>>>>                        Move "" to liBtypkin
55585>>>>>                    
55585>>>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Lpar to liWhichBarticl
55586>>>>>                        If (liWhichBarticl <> 0) Begin
55588>>>>>                            Clear Barticl
55589>>>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
55590>>>>>                            Find eq Barticl by Index.2
55591>>>>>>
55591>>>>>                            [Found] Begin
55593>>>>>>
55593>>>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
55594>>>>>                                Move Barticl.Barticl_No      to liNo
55595>>>>>                                Move Barticl.Btypkin_Code    to liBtypkin
55596>>>>>                            End
55596>>>>>>
55596>>>>>                        End
55596>>>>>>
55596>>>>>                        Set Value of (dbfrmHmnia(dbGrpCurrentStat(Self)))   Item 0 to ldHmnia
55597>>>>>                        Set Value of (dbfrmNo(dbGrpCurrentStat(Self)))      Item 0 to liNo
55598>>>>>                        Set Value of (dbfrmGtypkin(dbGrpCurrentStat(Self))) Item 0 to liBtypkin
55599>>>>>                    
55599>>>>>                        Clear Barticl
55600>>>>>                        Move liBarticlRec0 to Barticl.Barticl_Rec0
55601>>>>>                        Find eq Barticl by Index.2
55602>>>>>>
55602>>>>>                    End_Procedure
55603>>>>>                    
55603>>>>>                    //AB-StoreTopEnd
55603>>>>>
55603>>>>>                    Entry_Item Baxio.Baxio_fpar_in
55604>>>>>                    Set Size to 13 90
55605>>>>>                    Set Location to 10 109
55606>>>>>                    Set Label_Col_Offset to 90
55607>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55608>>>>>
55608>>>>>                    //AB-StoreStart
55608>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
55608>>>>>                    Procedure Refresh Integer iMode
55610>>>>>                        Forward Send Refresh iMode
55612>>>>>                        Send Find_Barticls
55613>>>>>                    End_Procedure // Refresh
55614>>>>>                    
55614>>>>>                    
55614>>>>>                    
55614>>>>>                    
55614>>>>>                    
55614>>>>>                    //AB-StoreEnd
55614>>>>>
55614>>>>>                End_Object    // Baxio_Baxio_Fbarticl
55615>>>>>
55615>>>>>                Object Baxio_Baxio_Code_In is a dbFormSub
55617>>>>>                    Entry_Item Baxio.Baxio_code_in
55618>>>>>                    Set Size to 13 126
55619>>>>>                    Set Location to 24 109
55620>>>>>                    Set Label_Col_Offset to 90
55621>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55622>>>>>                End_Object    // Baxio_Baxio_Code_In
55623>>>>>
55623>>>>>                Object Baxio_Baxio_Epon_In is a dbFormSub
55625>>>>>                    Entry_Item Baxio.Baxio_epon_in
55626>>>>>                    Set Size to 13 192
55627>>>>>                    Set Location to 24 283
55628>>>>>                    Set Color to clBtnFace
55629>>>>>                    Set Label_Col_Offset to 40
55630>>>>>                    Set Enabled_State to FALSE
55631>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55632>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55633>>>>>                    Set Shadow_State Item 0 to TRUE
55634>>>>>                End_Object    // Baxio_Baxio_Epon_In
55635>>>>>
55635>>>>>                Object dbFrmHmnia is a dbFormSub
55637>>>>>                    Set Size to 13 65
55638>>>>>                    Set Location to 10 231
55639>>>>>                    Set Color to clBtnFace
55640>>>>>                    Set Label_Col_Offset to 2
55641>>>>>                    Set Label_Justification_Mode to jMode_Right
55642>>>>>                    Set Enabled_State to FALSE
55643>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55644>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55645>>>>>                    Set Shadow_State Item 0 to TRUE
55646>>>>>                End_Object    // dbFrmHmnia
55647>>>>>
55647>>>>>                Object dbFrmNo is a dbFormSub
55649>>>>>                    Set Size to 13 65
55650>>>>>                    Set Location to 10 318
55651>>>>>                    Set Color to clBtnFace
55652>>>>>                    Set Label_Col_Offset to 2
55653>>>>>                    Set Label_Justification_Mode to jMode_Right
55654>>>>>                    Set Enabled_State to FALSE
55655>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55656>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55657>>>>>                    Set Shadow_State Item 0 to TRUE
55658>>>>>                End_Object    // dbFrmNo
55659>>>>>
55659>>>>>                Object dbFrmGtypkin is a dbFormSub
55661>>>>>                    Set Label to "‰å¤ž©ž"
55662>>>>>                    Set Size to 13 57
55663>>>>>                    Set Location to 10 418
55664>>>>>                    Set Color to clBtnFace
55665>>>>>                    Set Label_Col_Offset to 2
55666>>>>>                    Set Label_Justification_Mode to jMode_Right
55667>>>>>                    Set Enabled_State to FALSE
55668>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55669>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55670>>>>>                    Set Shadow_State Item 0 to TRUE
55671>>>>>                End_Object    // dbFrmGtypkin
55672>>>>>
55672>>>>>                Object TextBoxSub18 is a TextBoxSub
55674>>>>>                    Set Label to "˜¨/¡æ ˜¨˜¢˜™ãª:"
55675>>>>>                    Set Location to 12 18
55676>>>>>                    Set Size to 10 69
55677>>>>>                    Set TypeFace to "MS Sans Serif"
55678>>>>>                End_Object    // TextBoxSub18
55679>>>>>
55679>>>>>                Object TextBoxSub19 is a TextBoxSub
55681>>>>>                    Set Label to "˜¨˜¢ã­Ÿž¡œ ˜§æ:"
55682>>>>>                    Set Location to 25 18
55683>>>>>                    Set Size to 10 67
55684>>>>>                    Set TypeFace to "MS Sans Serif"
55685>>>>>                End_Object    // TextBoxSub19
55686>>>>>
55686>>>>>                Object TextBoxSub24 is a TextBoxSub
55688>>>>>                    Set Label to "†£-¤å˜"
55689>>>>>                    Set Location to 12 201
55690>>>>>                    Set Size to 10 26
55691>>>>>                    Set TypeFace to "MS Sans Serif"
55692>>>>>                End_Object    // TextBoxSub24
55693>>>>>
55693>>>>>                Object TextBoxSub27 is a TextBoxSub
55695>>>>>                    Set Label to "„§à¤¬£å˜"
55696>>>>>                    Set Location to 26 239
55697>>>>>                    Set Size to 10 39
55698>>>>>                    Set TypeFace to "MS Sans Serif"
55699>>>>>                End_Object    // TextBoxSub27
55700>>>>>
55700>>>>>                Object TextBoxSub30 is a TextBoxSub
55702>>>>>                    Set Label to "Œ¦:"
55703>>>>>                    Set Location to 11 298
55704>>>>>                    Set Size to 10 15
55705>>>>>                    Set TypeFace to "MS Sans Serif"
55706>>>>>                End_Object    // TextBoxSub30
55707>>>>>
55707>>>>>            End_Object    // dbGrpEispraktea
55708>>>>>
55708>>>>>            Object dbGrpPlhrotea is a dbGroupSub
55710>>>>>                Set Label to "„ ©§¨˜¡«â˜/¢ž¨à«â˜"
55711>>>>>                Set Size to 44 493
55712>>>>>                Set Location to 51 3
55713>>>>>                Set TextColor to clNavy
55714>>>>>                Object Baxio_Baxio_Lbarticl is a dbFormSub
55716>>>>>                    Entry_Item Baxio.Baxio_fpar_out
55717>>>>>                    Set Size to 13 90
55718>>>>>                    Set Location to 10 109
55719>>>>>                    Set Label_Col_Offset to 90
55720>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55721>>>>>                End_Object    // Baxio_Baxio_Lbarticl
55722>>>>>
55722>>>>>                Object Baxio_Baxio_Code_Out is a dbFormSub
55724>>>>>                    Entry_Item Baxio.Baxio_code_out
55725>>>>>                    Set Size to 13 126
55726>>>>>                    Set Location to 25 109
55727>>>>>                    Set Label_Col_Offset to 90
55728>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55729>>>>>                End_Object    // Baxio_Baxio_Code_Out
55730>>>>>
55730>>>>>                Object Baxio_Baxio_Epon_Out is a dbFormSub
55732>>>>>                    Entry_Item Baxio.Baxio_epon_out
55733>>>>>                    Set Size to 13 192
55734>>>>>                    Set Location to 25 283
55735>>>>>                    Set Color to clBtnFace
55736>>>>>                    Set Label_Col_Offset to 40
55737>>>>>                    Set Enabled_State to FALSE
55738>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55739>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55740>>>>>                    Set Shadow_State Item 0 to TRUE
55741>>>>>                End_Object    // Baxio_Baxio_Epon_Out
55742>>>>>
55742>>>>>                Object dbFrmHmnia is a dbFormSub
55744>>>>>                    Set Size to 13 65
55745>>>>>                    Set Location to 10 231
55746>>>>>                    Set Color to clBtnFace
55747>>>>>                    Set Label_Col_Offset to 2
55748>>>>>                    Set Label_Justification_Mode to jMode_Right
55749>>>>>                    Set Enabled_State to FALSE
55750>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55751>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55752>>>>>                    Set Shadow_State Item 0 to TRUE
55753>>>>>                End_Object    // dbFrmHmnia
55754>>>>>
55754>>>>>                Object dbFrmNo is a dbFormSub
55756>>>>>                    Set Size to 13 65
55757>>>>>                    Set Location to 10 318
55758>>>>>                    Set Color to clBtnFace
55759>>>>>                    Set Label_Col_Offset to 2
55760>>>>>                    Set Label_Justification_Mode to jMode_Right
55761>>>>>                    Set Enabled_State to FALSE
55762>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55763>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55764>>>>>                    Set Shadow_State Item 0 to TRUE
55765>>>>>                End_Object    // dbFrmNo
55766>>>>>
55766>>>>>                Object dbFrmGtypkin is a dbFormSub
55768>>>>>                    Set Label to "‰å¤ž©ž"
55769>>>>>                    Set Size to 13 57
55770>>>>>                    Set Location to 10 418
55771>>>>>                    Set Color to clBtnFace
55772>>>>>                    Set Label_Col_Offset to 2
55773>>>>>                    Set Label_Justification_Mode to jMode_Right
55774>>>>>                    Set Enabled_State to FALSE
55775>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55776>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55777>>>>>                    Set Shadow_State Item 0 to TRUE
55778>>>>>                End_Object    // dbFrmGtypkin
55779>>>>>
55779>>>>>                Object TextBoxSub20 is a TextBoxSub
55781>>>>>                    Set Label to "˜¨/¡æ ˜¨á›¦©žª:"
55782>>>>>                    Set Location to 10 19
55783>>>>>                    Set Size to 10 71
55784>>>>>                    Set TypeFace to "MS Sans Serif"
55785>>>>>                End_Object    // TextBoxSub20
55786>>>>>
55786>>>>>                Object TextBoxSub21 is a TextBoxSub
55788>>>>>                    Set Label to "¨é«¦ª ˜¨˜¢ã§«žª:"
55789>>>>>                    Set Location to 24 19
55790>>>>>                    Set Size to 10 78
55791>>>>>                    Set TypeFace to "MS Sans Serif"
55792>>>>>                End_Object    // TextBoxSub21
55793>>>>>
55793>>>>>                Object TextBoxSub25 is a TextBoxSub
55795>>>>>                    Set Label to "†£-¤å˜"
55796>>>>>                    Set Location to 10 201
55797>>>>>                    Set Size to 10 26
55798>>>>>                    Set TypeFace to "MS Sans Serif"
55799>>>>>                End_Object    // TextBoxSub25
55800>>>>>
55800>>>>>                Object TextBoxSub28 is a TextBoxSub
55802>>>>>                    Set Label to "„§à¤¬£å˜"
55803>>>>>                    Set Location to 27 237
55804>>>>>                    Set Size to 10 41
55805>>>>>                    Set TypeFace to "MS Sans Serif"
55806>>>>>                End_Object    // TextBoxSub28
55807>>>>>
55807>>>>>                Object TextBoxSub31 is a TextBoxSub
55809>>>>>                    Set Label to "Œ¦:"
55810>>>>>                    Set Location to 12 298
55811>>>>>                    Set Size to 9 15
55812>>>>>                    Set TypeFace to "MS Sans Serif"
55813>>>>>                End_Object    // TextBoxSub31
55814>>>>>
55814>>>>>            End_Object    // dbGrpPlhrotea
55815>>>>>
55815>>>>>            Object dbGrpCurrentStat is a dbGroupSub
55817>>>>>                Set Label to "’¨â®¦¬©˜ ‰˜«á©«˜©ž"
55818>>>>>                Set Size to 44 493
55819>>>>>                Set Location to 98 3
55820>>>>>                Set TextColor to clNavy
55821>>>>>                Object Baxio_Baxio_Lcode is a dbFormSub
55823>>>>>                    Entry_Item Baxio.Baxio_lcode
55824>>>>>                    Set Size to 13 126
55825>>>>>                    Set Location to 24 109
55826>>>>>                    Set Label_Col_Offset to 90
55827>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55828>>>>>                End_Object    // Baxio_Baxio_Lcode
55829>>>>>
55829>>>>>                Object Baxio_Baxio_Lepon is a dbFormSub
55831>>>>>                    Entry_Item Baxio.Baxio_lepon
55832>>>>>                    Set Size to 13 192
55833>>>>>                    Set Location to 24 283
55834>>>>>                    Set Color to clBtnFace
55835>>>>>                    Set Label_Col_Offset to 40
55836>>>>>                    Set Enabled_State to FALSE
55837>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55838>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55839>>>>>                    Set Shadow_State Item 0 to TRUE
55840>>>>>                End_Object    // Baxio_Baxio_Lepon
55841>>>>>
55841>>>>>                Object Baxio_Baxio_Lpar is a dbFormSub
55843>>>>>                    Entry_Item Baxio.Baxio_lpar
55844>>>>>                    Set Size to 13 90
55845>>>>>                    Set Location to 9 109
55846>>>>>                    Set Label_Col_Offset to 90
55847>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55848>>>>>                End_Object    // Baxio_Baxio_Lpar
55849>>>>>
55849>>>>>                Object dbFrmHmnia is a dbFormSub
55851>>>>>                    Set Size to 13 65
55852>>>>>                    Set Location to 10 231
55853>>>>>                    Set Color to clBtnFace
55854>>>>>                    Set Label_Col_Offset to 2
55855>>>>>                    Set Label_Justification_Mode to jMode_Right
55856>>>>>                    Set Enabled_State to FALSE
55857>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55858>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55859>>>>>                    Set Shadow_State Item 0 to TRUE
55860>>>>>                End_Object    // dbFrmHmnia
55861>>>>>
55861>>>>>                Object dbFrmNo is a dbFormSub
55863>>>>>                    Set Size to 13 65
55864>>>>>                    Set Location to 10 318
55865>>>>>                    Set Color to clBtnFace
55866>>>>>                    Set Label_Col_Offset to 2
55867>>>>>                    Set Label_Justification_Mode to jMode_Right
55868>>>>>                    Set Enabled_State to FALSE
55869>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55870>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55871>>>>>                    Set Shadow_State Item 0 to TRUE
55872>>>>>                End_Object    // dbFrmNo
55873>>>>>
55873>>>>>                Object dbFrmGtypkin is a dbFormSub
55875>>>>>                    Set Label to "‰å¤ž©ž"
55876>>>>>                    Set Size to 13 57
55877>>>>>                    Set Location to 10 418
55878>>>>>                    Set Color to clBtnFace
55879>>>>>                    Set Label_Col_Offset to 2
55880>>>>>                    Set Label_Justification_Mode to jMode_Right
55881>>>>>                    Set Enabled_State to FALSE
55882>>>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
55883>>>>>                    Set Item_Shadow_State Item 0 to TRUE
55884>>>>>                    Set Shadow_State Item 0 to TRUE
55885>>>>>                End_Object    // dbFrmGtypkin
55886>>>>>
55886>>>>>                Object TextBoxSub22 is a TextBoxSub
55888>>>>>                    Set Label to "’œ¢œ¬«˜å¦ ˜¨/¡æ:"
55889>>>>>                    Set Location to 11 13
55890>>>>>                    Set Size to 10 68
55891>>>>>                    Set TypeFace to "MS Sans Serif"
55892>>>>>                End_Object    // TextBoxSub22
55893>>>>>
55893>>>>>                Object TextBoxSub23 is a TextBoxSub
55895>>>>>                    Set Label to "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª:"
55896>>>>>                    Set Location to 24 13
55897>>>>>                    Set Size to 10 90
55898>>>>>                    Set TypeFace to "MS Sans Serif"
55899>>>>>                End_Object    // TextBoxSub23
55900>>>>>
55900>>>>>                Object TextBoxSub26 is a TextBoxSub
55902>>>>>                    Set Label to "†£-¤å˜"
55903>>>>>                    Set Location to 11 200
55904>>>>>                    Set Size to 10 27
55905>>>>>                    Set TypeFace to "MS Sans Serif"
55906>>>>>                End_Object    // TextBoxSub26
55907>>>>>
55907>>>>>                Object TextBoxSub29 is a TextBoxSub
55909>>>>>                    Set Label to "„§à¤¬£å˜"
55910>>>>>                    Set Location to 26 239
55911>>>>>                    Set Size to 10 40
55912>>>>>                    Set TypeFace to "MS Sans Serif"
55913>>>>>                End_Object    // TextBoxSub29
55914>>>>>
55914>>>>>                Object TextBoxSub32 is a TextBoxSub
55916>>>>>                    Set Label to "Œ¦:"
55917>>>>>                    Set Location to 11 297
55918>>>>>                    Set Size to 10 15
55919>>>>>                    Set TypeFace to "MS Sans Serif"
55920>>>>>                End_Object    // TextBoxSub32
55921>>>>>
55921>>>>>            End_Object    // dbGrpCurrentStat
55922>>>>>
55922>>>>>
55922>>>>>            //AB-StoreStart
55922>>>>>            set label to "Š¦ §á ‘«¦ ®œå˜"
55923>>>>>            
55923>>>>>            //AB-StoreEnd
55923>>>>>
55923>>>>>        End_Object    // TP_Status
55924>>>>>
55924>>>>>        Object TP_Bmove is a dbTabPage
55926>>>>>            Set Label to "‰å¤ž©ž"
55927>>>>>            Object grdBmove is a dbGridSub
55929>>>>>                Set Main_File to Bmove.File_Number
55930>>>>>                Set Server to (Bmove_DD(self))
55931>>>>>                Set Ordering to 4
55932>>>>>                Set Size to 159 489
55933>>>>>                Set Location to 7 5
55934>>>>>                Set Wrap_State to TRUE
55935>>>>>                Set Read_Only_State to TRUE
55936>>>>>
55936>>>>>                Begin_Row
55939>>>>>                    Entry_Item Btypkin.Btypkin_code
55940>>>>>                    Entry_Item Btypkin.Btypkin_descr
55941>>>>>                    Entry_Item Barticl.Barticl_hmnia
55942>>>>>                    Entry_Item Barticl.Barticl_no
55943>>>>>                    Entry_Item Barticl.Barticl_code1
55944>>>>>                    Entry_Item Barticl.Barticl_code2
55945>>>>>                End_Row
55950>>>>>
55950>>>>>                Set Form_Width    item 0 to 38
55951>>>>>                Set Header_Label  item 0 to "‰å¤ž©ž"
55952>>>>>                
55952>>>>>                Set Form_Width    item 1 to 197
55953>>>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
55954>>>>>                
55954>>>>>                Set Form_Width    item 2 to 45
55955>>>>>                Set Header_Label  item 2 to "†£-¤å˜"
55956>>>>>                
55956>>>>>                Set Form_Width    item 3 to 45
55957>>>>>                Set Header_Label  item 3 to "€¨ Ÿ£æª"
55958>>>>>                
55958>>>>>                Set Form_Width    item 4 to 82
55959>>>>>                Set Header_Label  item 4 to "‘¬¤˜¢¢˜©©æ£œ¤¦ª"
55960>>>>>                
55960>>>>>                Set Form_Width    item 5 to 76
55961>>>>>                Set Header_Label  item 5 to "˜¨˜¢ã§«žª"
55962>>>>>                
55962>>>>>
55962>>>>>                //AB-StoreStart
55962>>>>>                                                                
55962>>>>>                Procedure Set Col_Entry_State Integer iItem Integer iState
55964>>>>>                    Integer liPrototype
55965>>>>>                    Get Prototype_Object to liPrototype
55966>>>>>                    Set Entry_State of liPrototype Item iItem to iState
55967>>>>>                End_Procedure // Col_Entry_State
55968>>>>>                
55968>>>>>                Set Col_Entry_State to 0 False
55969>>>>>                Set Col_Entry_State to 1 False
55970>>>>>                Set Col_Entry_State to 2 False
55971>>>>>                Set Col_Entry_State to 3 False
55972>>>>>                Set Col_Entry_State to 4 False
55973>>>>>                Set Col_Entry_State to 5 False
55974>>>>>                
55974>>>>>                Procedure Mouse_Up Integer aiWindow Integer iChar_Pos
55976>>>>>                End_Procedure // Mouse_Up
55977>>>>>                
55977>>>>>                
55977>>>>>                Procedure Request_Clear_All
55979>>>>>                End_Procedure // Request_Clear_All
55980>>>>>                
55980>>>>>                
55980>>>>>                //AB-StoreEnd
55980>>>>>
55980>>>>>            End_Object    // grdBmove
55981>>>>>
55981>>>>>
55981>>>>>            //AB-StoreStart
55981>>>>>            set label to "‰ ¤ã©œ ª    "
55982>>>>>            //AB-StoreEnd
55982>>>>>
55982>>>>>        End_Object    // TP_Bmove
55983>>>>>
55983>>>>>    End_Object    // dbTbDlgAxio
55984>>>>>
55984>>>>>    Object dbGrpYear is a dbGroupSub
55986>>>>>        Set Size to 26 505
55987>>>>>        Set Location to 2 3
55988>>>>>        Object Company_Company_Name is a dbFormSub
55990>>>>>            Entry_Item Syscurxr.Company_name
55991>>>>>            Set Server to (Syscurxr_DD(self))
55992>>>>>            Set Size to 13 139
55993>>>>>            Set Location to 9 47
55994>>>>>            Set Color to clBtnFace
55995>>>>>            Set Label_Col_Offset to 2
55996>>>>>            Set Label_Justification_Mode to jMode_Right
55997>>>>>            Set Enabled_State to FALSE
55998>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55999>>>>>            Set Item_Shadow_State Item 0 to TRUE
56000>>>>>            Set Shadow_State Item 0 to TRUE
56001>>>>>        End_Object    // Company_Company_Name
56002>>>>>
56002>>>>>        Object Branch_Branch_Name is a dbFormSub
56004>>>>>            Entry_Item Syscurxr.Branch_name
56005>>>>>            Set Server to (Syscurxr_DD(self))
56006>>>>>            Set Size to 13 141
56007>>>>>            Set Location to 9 241
56008>>>>>            Set Color to clBtnFace
56009>>>>>            Set Label_Col_Offset to 2
56010>>>>>            Set Label_Justification_Mode to jMode_Right
56011>>>>>            Set Enabled_State to FALSE
56012>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56013>>>>>            Set Item_Shadow_State Item 0 to TRUE
56014>>>>>            Set Shadow_State Item 0 to TRUE
56015>>>>>        End_Object    // Branch_Branch_Name
56016>>>>>
56016>>>>>        Object Year_Year_Year is a dbFormSub
56018>>>>>            Entry_Item Syscurxr.Year_year
56019>>>>>            Set Server to (Syscurxr_DD(self))
56020>>>>>            Set Size to 13 61
56021>>>>>            Set Location to 9 440
56022>>>>>            Set Color to clBtnFace
56023>>>>>            Set Label_Col_Offset to 2
56024>>>>>            Set Label_Justification_Mode to jMode_Right
56025>>>>>            Set Enabled_State to FALSE
56026>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56027>>>>>            Set Item_Shadow_State Item 0 to TRUE
56028>>>>>            Set Shadow_State Item 0 to TRUE
56029>>>>>
56029>>>>>            //AB-StoreStart
56029>>>>>                                                                                                                                                                                                                                                                                                    
56029>>>>>                                                                                                                                                                                                                                                                                                    
56029>>>>>                                                                                                                                                                                                                                                                                                    
56029>>>>>            //AB-StoreEnd
56029>>>>>
56029>>>>>        End_Object    // Year_Year_Year
56030>>>>>
56030>>>>>        Object otxtCompany is a TextBoxSub
56032>>>>>            Set Label to "„«˜ ¨œå˜"
56033>>>>>            Set Auto_Size_State to FALSE
56034>>>>>            Set TextColor to clNavy
56035>>>>>            Set FontSize to 4 0
56036>>>>>            Set Location to 10 8
56037>>>>>            Set Size to 10 31
56038>>>>>            Set FontWeight to 800
56039>>>>>            Set Justification_Mode to jMode_Right
56040>>>>>            Set TypeFace to "MS Sans Serif"
56041>>>>>            Set Enabled_State to TRUE
56042>>>>>        End_Object    // otxtCompany
56043>>>>>
56043>>>>>        Object otxtBranch is a TextBoxSub
56045>>>>>            Set Label to "“§¦¡/£˜ :"
56046>>>>>            Set Auto_Size_State to FALSE
56047>>>>>            Set TextColor to clNavy
56048>>>>>            Set FontSize to 4 0
56049>>>>>            Set Location to 10 200
56050>>>>>            Set Size to 10 31
56051>>>>>            Set FontWeight to 800
56052>>>>>            Set Justification_Mode to jMode_Right
56053>>>>>            Set TypeFace to "MS Sans Serif"
56054>>>>>            Set Enabled_State to TRUE
56055>>>>>        End_Object    // otxtBranch
56056>>>>>
56056>>>>>        Object otxtYear is a TextBoxSub
56058>>>>>            Set Label to "•¨ã©ž :          "
56059>>>>>            Set Auto_Size_State to FALSE
56060>>>>>            Set TextColor to clNavy
56061>>>>>            Set FontSize to 4 0
56062>>>>>            Set Location to 10 408
56063>>>>>            Set Size to 10 24
56064>>>>>            Set FontWeight to 800
56065>>>>>            Set Justification_Mode to jMode_Right
56066>>>>>            Set TypeFace to "MS Sans Serif"
56067>>>>>            Set Enabled_State to TRUE
56068>>>>>        End_Object    // otxtYear
56069>>>>>
56069>>>>>    End_Object    // dbGrpYear
56070>>>>>
56070>>>>>    Object TextBoxSub1 is a TextBoxSub
56072>>>>>        Set Label to "„å›¦ª"
56073>>>>>        Set Location to 36 5
56074>>>>>        Set Size to 10 35
56075>>>>>        Set TypeFace to "MS Sans Serif"
56076>>>>>    End_Object    // TextBoxSub1
56077>>>>>
56077>>>>>    Object TextBoxSub2 is a TextBoxSub
56079>>>>>        Set Label to "‰à› ¡æª"
56080>>>>>        Set Location to 49 5
56081>>>>>        Set Size to 10 33
56082>>>>>        Set TypeFace to "MS Sans Serif"
56083>>>>>    End_Object    // TextBoxSub2
56084>>>>>
56084>>>>>    Object TextBoxSub13 is a TextBoxSub
56086>>>>>        Set Label to "‰˜«á©«˜©ž"
56087>>>>>        Set Location to 37 285
56088>>>>>        Set Size to 10 51
56089>>>>>        Set TypeFace to "MS Sans Serif"
56090>>>>>    End_Object    // TextBoxSub13
56091>>>>>
56091>>>>>    Object TextBoxSub14 is a TextBoxSub
56093>>>>>        Set Label to "¨å©¡œ«˜ "
56094>>>>>        Set Location to 49 285
56095>>>>>        Set Size to 12 39
56096>>>>>        Set TypeFace to "MS Sans Serif"
56097>>>>>    End_Object    // TextBoxSub14
56098>>>>>
56098>>>>>
56098>>>>>    //AB-StoreStart
56098>>>>>                                                
56098>>>>>                                                
56098>>>>>    //AB-StoreEnd
56098>>>>>
56098>>>>>End_Object    // VW037
56099>>>>>
56099>>>>>//AB/ End_Object    // prj
56099>>>Use sl100.sl
56099>>>Use sl036.sl
INCLUDING FILE: SL036.SL
56099>>>>>//AB/ Project SL036:BARTICL
56099>>>>>//AB/     Object prj is a Lookup_Project
56099>>>>>//AB/         Set ProjectName to "SL036:BARTICL"
56099>>>>>//AB/         Set ProjectFileName to "SL036.SL"
56099>>>>>
56099>>>>>// Project Object Structure
56099>>>>>//   SL036 is a dbModalPanelSub
56099>>>>>//     Btypkin_DD is a DataDictionary
56099>>>>>//     Barticl_DD is a DataDictionary
56099>>>>>//     oSelList is a dbListSub
56099>>>>>//     oOK_bn is a ButtonSub
56099>>>>>//     oCancel_bn is a ButtonSub
56099>>>>>//     oSearch_bn is a ButtonSub
56099>>>>>
56099>>>>>// Register all objects
56099>>>>>Register_Object Barticl_DD
56099>>>>>Register_Object Btypkin_DD
56099>>>>>Register_Object oCancel_bn
56099>>>>>Register_Object oOK_bn
56099>>>>>Register_Object oSearch_bn
56099>>>>>Register_Object oSelList
56099>>>>>Register_Object SL036
56099>>>>>
56099>>>>>
56099>>>>>    //AB-IgnoreStart
56099>>>>>
56099>>>>>    Use DFAllEnt.pkg
56099>>>>>    Use dbList.Sub
56099>>>>>    Use Button.Sub
56099>>>>>
56099>>>>>
56099>>>>>    Use BTYPKIN.DD
56099>>>>>    Use BARTICL.DD
56099>>>>>    
56099>>>>>    //AB-IgnoreEnd
56099>>>>>
56099>>>>>    Object SL036 is a dbModalPanelSub
56101>>>>>
56101>>>>>        //AB-StoreTopStart
56101>>>>>        Property String     psClientID      Public ''
56103>>>>>        Property String     psEponymo       Public ''
56105>>>>>        Property Date       pdHmnia         Public ''
56107>>>>>        Property Integer    piTypkinCode    Public  0
56109>>>>>        
56109>>>>>        
56109>>>>>        //AB-StoreTopEnd
56109>>>>>
56109>>>>>        Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
56110>>>>>        Set Size to 288 522
56111>>>>>        Set Location to 6 3
56112>>>>>        Set Exit_Application_Local_State to FALSE
56113>>>>>        Set Modal_State to FALSE
56114>>>>>
56114>>>>>        //AB-DDOStart
56114>>>>>
56114>>>>>        Object Btypkin_DD is a Btypkin_DataDictionary
56116>>>>>        End_Object    // Btypkin_DD
56117>>>>>
56117>>>>>        Object Barticl_DD is a Barticl_DataDictionary
56119>>>>>            Set DDO_Server to (Btypkin_DD(self))
56120>>>>>
56120>>>>>            //AB-StoreStart
56120>>>>>                                            
56120>>>>>            Begin_Constraints
56122>>>>>                String  sClientID
56123>>>>>                Date    dHmnia
56123>>>>>                Integer iTypkinCode
56123>>>>>            
56123>>>>>                Get piTypkinCode    to iTypkinCode
56124>>>>>                Get psClientID      to sClientID
56125>>>>>                Get pdHmnia         to dHmnia
56126>>>>>            
56126>>>>>                Constrain Barticl.Company_Code  Eq Syscurxr.Company_Code
56128>>>>>                Constrain Barticl.Branch_Code   Eq Syscurxr.Branch_Code
56130>>>>>                Constrain Barticl.Year_Year     Eq Syscurxr.Year_Year
56132>>>>>            
56132>>>>>                If (sClientID  <> 0) Begin
56134>>>>>                    If (iTypkinCode<> 0) Begin
56136>>>>>                        Set Ordering to 8
56137>>>>>                        Constrain Barticl.Btypkin_Code  Eq iTypkinCode
56139>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
56141>>>>>                    End
56141>>>>>>
56141>>>>>                    Else Begin
56142>>>>>                        Set Ordering to 10
56143>>>>>                        Constrain Barticl.Barticl_Code1 Eq sClientID
56145>>>>>                    End
56145>>>>>>
56145>>>>>                End
56145>>>>>>
56145>>>>>                Else If (dHmnia     <>'') Begin
56148>>>>>                    Set Ordering to 9
56149>>>>>                    Constrain Barticl.Barticl_Hmnia Eq dHmnia
56151>>>>>                End
56151>>>>>>
56151>>>>>                Else If (iTypkinCode<> 0) Begin
56154>>>>>                    Set Ordering to 1
56155>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
56157>>>>>                End
56157>>>>>>
56157>>>>>            End_Constraints
56160>>>>>            
56160>>>>>            //AB-StoreEnd
56160>>>>>
56160>>>>>        End_Object    // Barticl_DD
56161>>>>>
56161>>>>>        Set Main_DD to (Barticl_DD(self))
56162>>>>>        Set Server to (Barticl_DD(self))
56163>>>>>
56163>>>>>        //AB-DDOEnd
56163>>>>>
56163>>>>>        Object oSelList is a dbListSub
56165>>>>>            Set Main_File to Barticl.File_Number
56166>>>>>            Set Server to (Btypkin_DD(self))
56167>>>>>            Set Size to 238 508
56168>>>>>            Set Location to 4 5
56169>>>>>
56169>>>>>            Begin_Row
56172>>>>>                Entry_Item Barticl.Barticl_no
56173>>>>>                Entry_Item Barticl.Arith_orist
56174>>>>>                Entry_Item Barticl.Barticl_hmnia
56175>>>>>                Entry_Item Btypkin.Btypkin_code
56176>>>>>                Entry_Item Btypkin.Btypkin_descr
56177>>>>>                Entry_Item Barticl.Barticl_epon1
56178>>>>>                Entry_Item Barticl.Barticl_sv0
56179>>>>>            End_Row
56184>>>>>
56184>>>>>            Set Form_Width    item 0 to 60
56185>>>>>            Set Header_Label  item 0 to "€¨ Ÿ£æª"
56186>>>>>            
56186>>>>>            Set Form_Width    item 1 to 60
56187>>>>>            Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
56188>>>>>            
56188>>>>>            Set Form_Width    item 2 to 57
56189>>>>>            Set Header_Label  item 2 to "†£œ¨¦£ž¤å˜"
56190>>>>>            
56190>>>>>            Set Form_Width    item 3 to 41
56191>>>>>            Set Header_Label  item 3 to "‰å¤ž©ž"
56192>>>>>            
56192>>>>>            Set Form_Width    item 4 to 140
56193>>>>>            Set Header_Label  item 4 to "œ¨ š¨˜­ã"
56194>>>>>            
56194>>>>>            Set Form_Width    item 5 to 90
56195>>>>>            Set Header_Label  item 5 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
56196>>>>>            
56196>>>>>            Set Form_Width    item 6 to 54
56197>>>>>            Set Header_Label  item 6 to "¦©æ"
56198>>>>>            
56198>>>>>
56198>>>>>            //AB-StoreStart
56198>>>>>            
56198>>>>>            Set Numeric_mask Item 6 to 14 0 ' ,*'
56199>>>>>            
56199>>>>>            Procedure Activating
56201>>>>>                Send Rebuild_Constraints    to Barticl_DD
56202>>>>>                Send Beginning_Of_Data      to oSelList True
56203>>>>>                Forward Send Activating
56205>>>>>            End_Procedure
56206>>>>>            
56206>>>>>            
56206>>>>>            
56206>>>>>            
56206>>>>>            
56206>>>>>            
56206>>>>>            
56206>>>>>            //AB-StoreEnd
56206>>>>>
56206>>>>>        End_Object    // oSelList
56207>>>>>
56207>>>>>        Object oOK_bn is a ButtonSub
56209>>>>>            Set Label to "&„§ ¢¦šã"
56210>>>>>            Set Location to 255 354
56211>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56212>>>>>
56212>>>>>            //AB-StoreStart
56212>>>>>            Procedure OnClick
56214>>>>>                Send OK To oSelList
56215>>>>>            End_Procedure
56216>>>>>            //AB-StoreEnd
56216>>>>>
56216>>>>>        End_Object    // oOK_bn
56217>>>>>
56217>>>>>        Object oCancel_bn is a ButtonSub
56219>>>>>            Set Label to "&€¡ç¨à©ž"
56220>>>>>            Set Location to 255 410
56221>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56222>>>>>
56222>>>>>            //AB-StoreStart
56222>>>>>            Procedure OnClick
56224>>>>>                Send Cancel To oSelList
56225>>>>>            End_Procedure
56226>>>>>            //AB-StoreEnd
56226>>>>>
56226>>>>>        End_Object    // oCancel_bn
56227>>>>>
56227>>>>>        Object oSearch_bn is a ButtonSub
56229>>>>>            Set Label to "€&¤˜ã«ž©ž"
56230>>>>>            Set Location to 255 464
56231>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56232>>>>>
56232>>>>>            //AB-StoreStart
56232>>>>>            Procedure OnClick
56234>>>>>                Send Search To oSelList
56235>>>>>            End_Procedure
56236>>>>>            //AB-StoreEnd
56236>>>>>
56236>>>>>        End_Object    // oSearch_bn
56237>>>>>
56237>>>>>
56237>>>>>        //AB-StoreStart
56237>>>>>        On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
56238>>>>>        On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
56239>>>>>        On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
56240>>>>>        
56240>>>>>        
56240>>>>>        
56240>>>>>        
56240>>>>>        
56240>>>>>        
56240>>>>>        
56240>>>>>        
56240>>>>>        //AB-StoreEnd
56240>>>>>
56240>>>>>    End_Object    // SL036
56241>>>>>
56241>>>>>//AB/     End_Object    // prj
56241>>>Use r36.rv
INCLUDING FILE: R36.RV
56241>>>>>//AB/ Project R36:ektyposh barticl
56241>>>>>//AB/ Object prj is a Report_Project
56241>>>>>//AB/     Set ProjectName to "R36:ektyposh barticl"
56241>>>>>//AB/     Set ProjectFileName to "r36.rv"
56241>>>>>
56241>>>>>// Project Object Structure
56241>>>>>//   r36 is a ReportViewSub
56241>>>>>//     DestRadio is a RadioGroup
56241>>>>>//       WindowRadio is a Radio
56241>>>>>//       PrinterRadio is a Radio
56241>>>>>//     ButtonSub3 is a ButtonSub
56241>>>>>//     ButtonSub4 is a ButtonSub
56241>>>>>//     AXIO_BasicReport is a BasicReport
56241>>>>>//       Btypkin_DD is a Btypkin_DataDictionary
56241>>>>>//       Baxiokat_DD is a Baxiokat_DataDictionary
56241>>>>>//       Barticl_DD is a Barticl_DataDictionary
56241>>>>>//       Bsum_DD is a Bsum_DataDictionary
56241>>>>>//       Baxio_DD is a Baxio_DataDictionary
56241>>>>>//       Syscurxr_DD is a Syscurxr_DataDictionary
56241>>>>>//       Clients_DD is a Clients_DataDictionary
56241>>>>>//       Bmove_DD is a Bmove_DataDictionary
56241>>>>>
56241>>>>>// Register all objects
56241>>>>>Register_Object AXIO_BasicReport
56241>>>>>Register_Object Barticl_DD
56241>>>>>Register_Object Baxio_DD
56241>>>>>Register_Object Baxiokat_DD
56241>>>>>Register_Object Bmove_DD
56241>>>>>Register_Object Bsum_DD
56241>>>>>Register_Object Btypkin_DD
56241>>>>>Register_Object ButtonSub3
56241>>>>>Register_Object ButtonSub4
56241>>>>>Register_Object Clients_DD
56241>>>>>Register_Object DestRadio
56241>>>>>Register_Object PrinterRadio
56241>>>>>Register_Object r36
56241>>>>>Register_Object Syscurxr_DD
56241>>>>>Register_Object WindowRadio
56241>>>>>
56241>>>>>
56241>>>>>//AB/ Report View
56241>>>>>
56241>>>>>
56241>>>>>//AB-StoreTopStart
56241>>>>>                                                        
56241>>>>>Use dfallrpt.pkg
56241>>>>>use btypkin.dd
56241>>>>>use baxiokat.dd
56241>>>>>Use barticl.dd
56241>>>>>use bsum.dd
INCLUDING FILE: BSUM.DD
56241>>>>>>>//DDB-FileStart
56241>>>>>>>//DDB-HeaderStart
56241>>>>>>>
56241>>>>>>>// File Name : BSUM.DD
56241>>>>>>>// Class Name: Bsum_DataDictionary
56241>>>>>>>// Revision  : 11
56241>>>>>>>// Version   : 2
56241>>>>>>>
56241>>>>>>>Use  Windows           // Basic Definitions
56241>>>>>>>Use  DataDict          // DataDictionary Class Definition
56241>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56241>>>>>>>
56241>>>>>>>Open Bsum
56243>>>>>>>Open Barticl
56245>>>>>>>Open Sysrecb
56247>>>>>>>
56247>>>>>>>//DDB-HeaderEnd
56247>>>>>>>Class Bsum_DataDictionary  is a DataDictionary_Sec
56248>>>>>>>
56248>>>>>>>    // Creating:
56248>>>>>>>
56248>>>>>>>    Procedure Creating
56249>>>>>>>        Forward Send Creating
56251>>>>>>>        // Insert Code Here
56251>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
56252>>>>>>>    End_Procedure   // Creating
56253>>>>>>>
56253>>>>>>>
56253>>>>>>>    Procedure Define_Fields
56254>>>>>>>        Forward Send Define_Fields
56256>>>>>>>        //DDB-Generated-Code-Location
56256>>>>>>>        //DDB-DefineFieldStart
56256>>>>>>>
56256>>>>>>>        Set Main_File            To Bsum.File_Number
56257>>>>>>>        Set Cascade_Delete_State To FALSE
56258>>>>>>>
56258>>>>>>>
56258>>>>>>>        // Parent (Server) file structure...............
56258>>>>>>>        Send Add_Server_File  Barticl.File_Number
56259>>>>>>>
56259>>>>>>>        // External (System) file structure.............
56259>>>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
56260>>>>>>>
56260>>>>>>>        Define_Auto_Increment  Sysrecb.Bsum_Rec0  To Bsum.Bsum_Rec0
56263>>>>>>>
56263>>>>>>>        // Field-based properties.......................
56263>>>>>>>
56263>>>>>>>        // Bsum.Barticl_Recr
56263>>>>>>>
56263>>>>>>>        // Bsum.Baxiokat_Recr
56263>>>>>>>
56263>>>>>>>        // Bsum.Bsum_Sv2
56263>>>>>>>
56263>>>>>>>        // Bsum.Bsum_Sv0
56263>>>>>>>
56263>>>>>>>        // Bsum.Bsum_Sv00
56263>>>>>>>
56263>>>>>>>        // Bsum.Bsum_Svr
56263>>>>>>>
56263>>>>>>>        // Bsum.Gmove_Srec0
56263>>>>>>>
56263>>>>>>>        // Bsum.Bsum_Rec0
56263>>>>>>>
56263>>>>>>>        // Bsum.Bsum_Recr
56263>>>>>>>
56263>>>>>>>        //DDB-DefineFieldEnd
56263>>>>>>>
56263>>>>>>>        Set Main_File            To Bsum.File_Number
56264>>>>>>>
56264>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
56265>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
56266>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56267>>>>>>>
56267>>>>>>>        // Parent (Server) file structure...............
56267>>>>>>>        Send Add_Server_File  Barticl.File_Number
56268>>>>>>>
56268>>>>>>>        // Field-based properties.......................
56268>>>>>>>
56268>>>>>>>        // Bsum.Barticl_Rec0
56268>>>>>>>
56268>>>>>>>        // Bsum.Baxiokat_Rec0
56268>>>>>>>
56268>>>>>>>        // Bsum.Bsum_Sv2
56268>>>>>>>
56268>>>>>>>        // Bsum.Bsum_Sv0
56268>>>>>>>
56268>>>>>>>        // Bsum.Bsum_Sv00
56268>>>>>>>
56268>>>>>>>        // Bsum.Bsum_Svr
56268>>>>>>>
56268>>>>>>>        // Bsum.Gmove_Srec0
56268>>>>>>>
56268>>>>>>>    End_Procedure    // Define_Fields
56269>>>>>>>
56269>>>>>>>
56269>>>>>>>    Procedure Field_Defaults
56270>>>>>>>        Forward Send Field_Defaults
56272>>>>>>>        //DDB-Generated-Code-Location
56272>>>>>>>        //DDB-FieldDefaultStart
56272>>>>>>>        //DDB-FieldDefaultEnd
56272>>>>>>>    End_Procedure    // Field_Defaults
56273>>>>>>>
56273>>>>>>>End_Class    // Bsum_DataDictionary
56274>>>>>>>//DDB-FileEnd
56274>>>>>use baxio.dd
56274>>>>>use syscurxr.dd
56274>>>>>use clients.dd
56274>>>>>use bmove.dd
56274>>>>>Use rvi36.pkg
INCLUDING FILE: RVI36.PKG
/HEADERR36
Image 10, HEADERR36
 !
 __________________________________                                                          †‹Œˆ€  : __________
 __________________________________                                                          €.€ : __________
 __________________________________
 __________     ___________________
 €”‹ __________ ƒŽ“ _______________
                                  _______________________________________________
                                  ===============================================
                    ‘ « ¦   ® œ å ˜   ‹ œ « ˜ ™   ™ ˜  æ £ œ ¤ ¦ ¬   € ¥   ¦ š ¨ á ­ ¦ ¬     ‘«¦ ®œå˜ €§¦›â¡«ž
   ˜/˜   „å›¦ª €¥ ¦š¨á­¦¬      €¨ Ÿ£æª     „¡›æ«žª      ’¨á§œ˜  †£.Šã¥žª   Œ¦£.         €¥å˜
/BodyR36
Image 11, BODYR36
  ___  _____________________ ____________ ____________ ________ __/__/____ ___ ___,___,___.__ ____________________
/TotalR36
Image 12, TOTALR36
------------------------------------------------------------------------------------------------------------------
                                                   ‘ç¤¦¢¦ €¥å˜ª €¥ ¦š¨á­à¤ ___,___,___,___.__
       ‚ ˜ «ž __________________________________               Ž ˜¨˜¢˜™é¤
˜¨˜«ž¨ã©œ ª: ____________________________________________________________
              ____________________________________________________________  !
/*
56274>>>>>open codemast
56276>>>>>open company
56278>>>>>//AB-StoreTopEnd
56278>>>>>
56278>>>>>//AB-IgnoreStart
56278>>>>>
56278>>>>>Use Rptvw.Sub
56278>>>>>Use DFAllEnt.pkg
56278>>>>>Use Button.Sub
56278>>>>>
56278>>>>>//AB-IgnoreEnd
56278>>>>>
56278>>>>>ACTIVATE_VIEW Activate_r36 FOR r36
56282>>>>>
56282>>>>>Object r36 is a ReportViewSub
56284>>>>>
56284>>>>>    //AB-StoreTopStart
56284>>>>>            
56284>>>>>    Property Integer Sort_Indexaxio   Public 1
56286>>>>>    Property string  psrecr           public ''
56288>>>>>    property integer piaa             public 0
56290>>>>>    //AB-StoreTopEnd
56290>>>>>
56290>>>>>    Set Label to "„¡«ç§à©ž Bmoves"
56291>>>>>    Set Size to 64 186
56292>>>>>    Set Location to 1 7
56293>>>>>
56293>>>>>    //AB-DDOStart
56293>>>>>
56293>>>>>
56293>>>>>    //AB-DDOEnd
56293>>>>>
56293>>>>>    Object DestRadio is a RadioGroup
56295>>>>>
56295>>>>>        //AB-StoreTopStart
56295>>>>>                                
56295>>>>>        //AB-StoreTopEnd
56295>>>>>
56295>>>>>        Set Label to "„¡«ç§à©ž"
56296>>>>>        Set Size to 42 49
56297>>>>>        Set Location to 2 1
56298>>>>>        Object WindowRadio is a Radio
56300>>>>>            Set Size to 13 30
56301>>>>>            Set Location to 12 12
56302>>>>>            Set Bitmap to "screen4.bmp"
56303>>>>>        End_Object    // WindowRadio
56304>>>>>
56304>>>>>        Object PrinterRadio is a Radio
56306>>>>>            Set Size to 10 31
56307>>>>>            Set Location to 30 12
56308>>>>>            Set Bitmap to "PRINT_M1.BMP"
56309>>>>>        End_Object    // PrinterRadio
56310>>>>>
56310>>>>>
56310>>>>>        //AB-StoreStart
56310>>>>>        Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
56312>>>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
56314>>>>>            If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
56317>>>>>          //  Set Output_Device_Mode  To PRINT_TO_WINDOW
56317>>>>>        End_Procedure
56318>>>>>        
56318>>>>>        
56318>>>>>        
56318>>>>>        
56318>>>>>        
56318>>>>>        
56318>>>>>        
56318>>>>>        //AB-StoreEnd
56318>>>>>
56318>>>>>    End_Object    // DestRadio
56319>>>>>
56319>>>>>    Object ButtonSub3 is a ButtonSub
56321>>>>>
56321>>>>>        //AB-StoreTopStart
56321>>>>>                                                                                                                                                                                                                                                                    
56321>>>>>        //AB-StoreTopEnd
56321>>>>>
56321>>>>>        Set Bitmap to "RUNPROG.BMP"
56322>>>>>        Set Size to 18 27
56323>>>>>        Set Location to 6 59
56324>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56325>>>>>
56325>>>>>        //AB-StoreStart
56325>>>>>        Procedure OnClick
56327>>>>>        
56327>>>>>        
56327>>>>>        End_Procedure
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        
56328>>>>>        //AB-StoreEnd
56328>>>>>
56328>>>>>    End_Object    // ButtonSub3
56329>>>>>
56329>>>>>    Object ButtonSub4 is a ButtonSub
56331>>>>>
56331>>>>>        //AB-StoreTopStart
56331>>>>>                                                                                                                                                                                                                                                                                                    
56331>>>>>        //AB-StoreTopEnd
56331>>>>>
56331>>>>>        Set Bitmap to "CANCEL.BMP"
56332>>>>>        Set Size to 18 27
56333>>>>>        Set Location to 28 58
56334>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
56335>>>>>
56335>>>>>        //AB-StoreStart
56335>>>>>        Procedure OnClick
56337>>>>>            Send Request_Cancel
56338>>>>>        End_Procedure
56339>>>>>        
56339>>>>>        
56339>>>>>        
56339>>>>>        
56339>>>>>        //AB-StoreEnd
56339>>>>>
56339>>>>>    End_Object    // ButtonSub4
56340>>>>>
56340>>>>>
56340>>>>>    //AB-StoreStart
56340>>>>>            
56340>>>>>    //Selection Variables
56340>>>>>    
56340>>>>>    //HELP-VARIABLES
56340>>>>>    
56340>>>>>    Procedure StartReport
56342>>>>>    
56342>>>>>        Local Integer iOutputDevice
56343>>>>>        Local String  FileName
56343>>>>>        local integer inew_state
56343>>>>>        Get Output_Device_Mode To iOutputDevice
56344>>>>>        If iOutputDevice EQ 0 Begin
56346>>>>>           Make_Temp_File "TXT" FileName
56347>>>>>           Move (".\" - FileName)  To FileName
56348>>>>>           Set Output_Device_Name  To FileName
56349>>>>>          // set piprinter to 1
56349>>>>>        End
56349>>>>>>
56349>>>>>        Else ;        Set Output_Device_Name  To "Lpt1:"
56351>>>>>    
56351>>>>>        SEND RUN_REPORT
56352>>>>>    
56352>>>>>     //   If iOutputDevice EQ 1 Begin
56352>>>>>     //      RunProgram background "notepad" FileName
56352>>>>>     //      EraseFile FileName
56352>>>>>      //  End
56352>>>>>    
56352>>>>>    End_Procedure   // StartReport
56353>>>>>    
56353>>>>>    
56353>>>>>    Object AXIO_BasicReport is a BasicReport
56355>>>>>    
56355>>>>>       Set Report_Title to "„¡«ç§à©ž €¥ ¦š¨á­à¤       "
56356>>>>>    
56356>>>>>       Object Btypkin_DD is a Btypkin_DataDictionary
56358>>>>>       End_Object    // Btypkin_DD
56359>>>>>    
56359>>>>>       Object Baxiokat_DD is a Baxiokat_DataDictionary
56361>>>>>       End_Object    // Baxiokat_DD
56362>>>>>    
56362>>>>>       Object Barticl_DD is a Barticl_DataDictionary
56364>>>>>          Set DDO_Server to (Btypkin_DD(self))
56365>>>>>       End_Object    // Barticl_DD
56366>>>>>    
56366>>>>>       Object Bsum_DD is a Bsum_DataDictionary
56368>>>>>          Set DDO_Server to (Barticl_DD(self))
56369>>>>>          Set Constrain_File to Barticl.File_Number
56370>>>>>       End_Object    // Bsum_DD
56371>>>>>    
56371>>>>>       Object Baxio_DD is a Baxio_DataDictionary
56373>>>>>          Set DDO_Server to (Baxiokat_DD(self))
56374>>>>>       End_Object    // Baxio_DD
56375>>>>>    
56375>>>>>       Object Syscurxr_DD is a Syscurxr_DataDictionary
56377>>>>>       End_Object    // Syscurxr_DD
56378>>>>>    
56378>>>>>        Object Clients_DD is a Clients_DataDictionary
56380>>>>>    
56380>>>>>        End_Object    // Clients_DD
56381>>>>>    
56381>>>>>    
56381>>>>>        Object Bmove_DD is a Bmove_DataDictionary
56383>>>>>            Set DDO_Server to (Barticl_DD(self))
56384>>>>>            Set DDO_Server to (Baxio_DD(self))
56385>>>>>            Set Constrain_File to Barticl.File_Number
56386>>>>>            begin_constraints
56388>>>>>                constrain bmove.barticl_recr eq (psrecr(self))
56390>>>>>            end_constraints
56393>>>>>        End_Object    // Bmove_DD
56394>>>>>    
56394>>>>>    
56394>>>>>    
56394>>>>>    
56394>>>>>        //Main DD for the report
56394>>>>>        Set Server To (bmove_dd(Current_Object))
56395>>>>>    
56395>>>>>        //Breaks and Index for the report
56395>>>>>        Report_Index By Index.1
56397>>>>>        Function Starting_Main_Report Returns Integer
56399>>>>>          Integer iIndexaxio
56400>>>>>          Local Integer iRetVal
56400>>>>>          set page_feed to 66
56401>>>>>          set page_end to 60
56402>>>>>          set piaa to 0
56403>>>>>          Forward Get Starting_Main_Report to iRetval
56405>>>>>          send rebuild_constraints to bmove_dd
56406>>>>>          Send Find to (bmove_dd(self)) First_Record 1
56407>>>>>          Get Sort_Indexaxio  To iIndexaxio
56408>>>>>          Report_Index BY iIndexaxio
56410>>>>>       End_Function
56411>>>>>    
56411>>>>>       Procedure_Section Page_Top as HeaderR36
56416>>>>>           date ddate
56416>>>>>           sysdate4 ddate
56417>>>>>           clear company
56418>>>>>           move barticl.company_code  to company.company_code
56419>>>>>           find eq company by index.1
56420>>>>>>
56420>>>>>           print company.company_name to headerr36.1
56421>>>>>           print ddate                to headerr36.2
56422>>>>>           clear codemast
56423>>>>>           move 'JOB' to codemast.type
56424>>>>>           move company.company_j_code to codemast.code
56425>>>>>           find eq codemast by index.1
56426>>>>>>
56426>>>>>           move codemast.description   to headerr36.3
56427>>>>>           move barticl.barticl_no      to headerr36.4
56428>>>>>           move company.company_addr   to headerr36.5
56429>>>>>           move company.company_tk     to headerr36.6
56430>>>>>           move company.company_poli   to headerr36.7
56431>>>>>           move company.company_afm    to headerr36.8
56432>>>>>           clear codemast
56433>>>>>           move 'DOY' to codemast.type
56434>>>>>           move company.company_doy    to codemast.code
56435>>>>>           find eq codemast by index.1
56436>>>>>>
56436>>>>>           move codemast.description   to headerr36.9
56437>>>>>           move btypkin.btypkin_descr  to headerr36.10
56438>>>>>           OutPut_PageCheck
56439>>>>>       End_Procedure
56440>>>>>    
56440>>>>>       Procedure_Section  Body as BodyR36
56445>>>>>          number iaa
56445>>>>>          get piaa                      to iaa
56446>>>>>          add 1                         to iaa
56447>>>>>          set piaa                      to iaa
56448>>>>>          print iaa                     to bodyr36.1
56449>>>>>          print baxiokat.baxiokat_descr to bodyr36.2
56450>>>>>          Print baxio.baxio_no          to bodyr36.3
56451>>>>>          clear codemast
56452>>>>>          move 'BANK' to codemast.type
56453>>>>>          move baxio.baxio_banka to codemast.code
56454>>>>>          find eq codemast by index.1
56455>>>>>>
56455>>>>>          move baxio.baxio_epon_in    to bodyr36.4
56456>>>>>          move codemast.description   to bodyr36.5
56457>>>>>          move baxio.baxio_hmnial     to bodyr36.6
56458>>>>>          move baxio.baxio_c_code2    to bodyr36.7
56459>>>>>          print baxio.baxio_v2        to bodyr36.8
56460>>>>>          move baxio.baxio_epon_out   to bodyr36.9
56461>>>>>          add bodyr36.8               to totalr36.1
56462>>>>>          OutPut_PageCheck
56463>>>>>       End_Procedure
56464>>>>>    
56464>>>>>       PROCEDURE_SECTION TOTAL AS TOTALR36
56469>>>>>         // Subtotal BodyR36.8      TO totalr36.1
56469>>>>>          print totalr36.1
56470>>>>>          print company.company_name to totalr36.2
56471>>>>>          print barticl.sxolia1      to totalr36.3
56472>>>>>          print barticl.sxolia2      to totalr36.4
56473>>>>>          output_pagecheck
56474>>>>>       END_PROCEDURE
56475>>>>>    
56475>>>>>       Procedure Ending_Report
56477>>>>>         Blankform BodyR36.1      Thru BodyR36.9
56478>>>>>>
56478>>>>>       End_Procedure
56479>>>>>    
56479>>>>>    End_Object
56480>>>>>    
56480>>>>>    
56480>>>>>    Procedure Activate_View Returns Integer
56482>>>>>        Local Integer Rval
56483>>>>>        Forward Get MSG_Activate_View to Rval
56485>>>>>    End_Procedure
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    
56486>>>>>    //AB-StoreEnd
56486>>>>>
56486>>>>>End_Object    // r36
56487>>>>>
56487>>>>>
56487>>>>>//AB-StoreStart
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>                                                        
56487>>>>>//AB-StoreEnd
56487>>>>>
56487>>>>>//AB/ End_Object    // prj
56487>>>Use baxio.dd
56487>>>Use Tperga.dd
INCLUDING FILE: TPERGA.DD
56487>>>>>//DDB-FileStart
56487>>>>>//DDB-HeaderStart
56487>>>>>
56487>>>>>// File Name : TPERGA.DD
56487>>>>>// Class Name: Tperga_DataDictionary
56487>>>>>// Revision  : 14
56487>>>>>// Version   : 2
56487>>>>>
56487>>>>>Use  Windows           // Basic Definitions
56487>>>>>Use  DataDict          // DataDictionary Class Definition
56487>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56487>>>>>
56487>>>>>Open Tperga
56489>>>>>Open Cn
56491>>>>>Open Baxiokat
56493>>>>>Open Sysrecc
56495>>>>>
56495>>>>>//DDB-HeaderEnd
56495>>>>>
56495>>>>>Class Tperga_DataDictionary  is a DataDictionary_Sec
56496>>>>>
56496>>>>>    Procedure Save_Main_File
56497>>>>>        If (Operation_Origin<>Self) Begin
56499>>>>>            If Tperga.Recnum Eq 0 Procedure_Return
56502>>>>>        End
56502>>>>>>
56502>>>>>        Forward Send Save_Main_File
56504>>>>>    End_Procedure
56505>>>>>
56505>>>>>
56505>>>>>
56505>>>>>    Procedure Creating
56506>>>>>        Forward Send Creating
56508>>>>>        // Insert Code Here
56508>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(TPErga.TPErga_Rec0))))));                                    to TPErga.TPErga_Recr
56509>>>>>    End_Procedure   // Creating
56510>>>>>
56510>>>>>    // Define_Fields:
56510>>>>>    // This procedure is used to set up all data-dictionary rules.
56510>>>>>
56510>>>>>    Procedure Define_Fields
56511>>>>>        Forward Send Define_Fields
56513>>>>>        //DDB-Generated-Code-Location
56513>>>>>        //DDB-DefineFieldStart
56513>>>>>
56513>>>>>        Set Main_File            To Tperga.File_Number
56514>>>>>        Set Cascade_Delete_State To FALSE
56515>>>>>
56515>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
56516>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
56517>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56518>>>>>
56518>>>>>        // Parent (Server) file structure...............
56518>>>>>        Send Add_Server_File  Cn.File_Number
56519>>>>>        Send Add_Server_File  Baxiokat.File_Number
56520>>>>>
56520>>>>>        // External (System) file structure.............
56520>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
56521>>>>>
56521>>>>>        Define_Auto_Increment  Sysrecc.Tperga_Rec0  To Tperga.Tperga_Rec0
56524>>>>>
56524>>>>>        // Field-based properties.......................
56524>>>>>
56524>>>>>        // Tperga.Cn_Code
56524>>>>>
56524>>>>>        // Tperga.Baxiokat_Code
56524>>>>>
56524>>>>>        // Tperga.Pct_Epi_Synolou
56524>>>>>
56524>>>>>        // Tperga.Paralabh_Meres
56524>>>>>
56524>>>>>        // Tperga.Xarhtos_Meres
56524>>>>>
56524>>>>>        // Tperga.Plhroteo_Meres
56524>>>>>
56524>>>>>        // Tperga.Tperga_Rec0
56524>>>>>
56524>>>>>        // Tperga.Tperga_Recr
56524>>>>>
56524>>>>>        //DDB-DefineFieldEnd
56524>>>>>    End_Procedure    // Define_Fields
56525>>>>>
56525>>>>>    // Field_Defaults:
56525>>>>>    // This procedure is used to establish default field values.
56525>>>>>
56525>>>>>    Procedure Field_Defaults
56526>>>>>        Forward Send Field_Defaults
56528>>>>>        //DDB-Generated-Code-Location
56528>>>>>        //DDB-FieldDefaultStart
56528>>>>>        //DDB-FieldDefaultEnd
56528>>>>>    End_Procedure    // Field_Defaults
56529>>>>>
56529>>>>>End_Class    // Tperga_DataDictionary
56530>>>>>//DDB-FileEnd
56530>>>Use BtnOrdH.DD
INCLUDING FILE: BTNORDH.DD
56530>>>>>//DDB-FileStart
56530>>>>>//DDB-HeaderStart
56530>>>>>
56530>>>>>// File Name : BTNORDH.DD
56530>>>>>// Class Name: Btnordh_DataDictionary
56530>>>>>// Revision  : 57
56530>>>>>// Version   : 2
56530>>>>>
56530>>>>>Use  Windows           // Basic Definitions
56530>>>>>Use  DataDict          // DataDictionary Class Definition
56530>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56530>>>>>
56530>>>>>Open Btnordh
56532>>>>>Open Btnordd
56534>>>>>Open Cn
56536>>>>>Open Sysrecc
56538>>>>>
56538>>>>>//DDB-HeaderEnd
56538>>>>>//DDB-ValidationStart
56538>>>>>
56538>>>>>Register_Object Btnordh_Velxr_VT
56538>>>>>
56538>>>>>Object Btnordh_Velxr_VT  is a CodeValidationTable
56540>>>>>    Set Type_Value        To "ELXREOSH"
56541>>>>>    Set Validate_State    To FALSE
56542>>>>>    Set Allow_Blank_State To TRUE
56543>>>>>    //DDB-ValidationCustomStart
56543>>>>>    //DDB-ValidationCustomEnd
56543>>>>>End_Object   // Btnordh_Velxr_VT
56544>>>>>//DDB-ValidationEnd
56544>>>>>//DDB-SelectionStart
56544>>>>>//DDB/ ExternalSelectionList btnordh  btnordh.sl
56544>>>>>Register_Object btnordh
56544>>>>>//DDB-SelectionEnd
56544>>>>>
56544>>>>>Class Btnordh_DataDictionary  is a DataDictionary_Sec
56545>>>>>
56545>>>>>    Procedure Construct_Object
56546>>>>>        Forward Send Construct_Object
56548>>>>>        Property integer piactive  Public 0
56549>>>>>    End_Procedure
56550>>>>>
56550>>>>>    Procedure Creating
56551>>>>>        String  sClientCode sCNCode
56552>>>>>        Integer iClientCode iCnCode iAA
56552>>>>>        date ddate
56552>>>>>        Forward Send Creating
56554>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                        (Trim(String(BTNORDH.Rec0)))))) to BTNORDH.Recr
56555>>>>>
56555>>>>>        if (sysfile.ascclientid=0);            Move (fsgStripCodeFromID(Clients.Client_ID))    to iClientCode
56558>>>>>        else;            mid clients.client_id to sclientcode 5 7
56562>>>>>        Move (fsgStripCodeFromID(CN.CN_Code))           to iCnCode
56563>>>>>        Move Cn.AA_Deop                                 to iAA
56564>>>>>        Add 1                                           to iAA
56565>>>>>        Add 1                                           to Cn.AA_Deop
56566>>>>>
56566>>>>>        if (sysfile.ascclientid=0);            Get Sfi_All_Numbers iClientCode Sysfile.Client_Digits 0 to sClientCode
56569>>>>>        Get Sfi_All_Numbers iCNCode     Sysfile.Client_Digits 0 to sCNCode
56570>>>>>
56570>>>>>        Move (sClientCode+sCNCode+'/'+(String(iAA)))    to btnordh.aa_deop
56571>>>>>        sysdate4 ddate
56572>>>>>        if (btnordh.date_create='') move ddate to btnordh.date_create
56575>>>>>        if (btnordh.deop_date ='') move ddate to btnordh.deop_date
56578>>>>>        if (piactive(self)=1) move 0 to btnordh.deop_active
56581>>>>>        else move 1 to btnordh.deop_active
56583>>>>>        // Insert Code Here
56583>>>>>    End_Procedure   // Creating
56584>>>>>
56584>>>>>     Procedure Update
56585>>>>>        Forward Send Update
56587>>>>>
56587>>>>>        // Insert Code Here
56587>>>>>        Move SysCurXR.Company_Code  to btnordh.Vcompany
56588>>>>>        Move SysCurXR.Branch_Code   to btnordh.Vbranch
56589>>>>>        move syscurxr.year_year     to btnordh.vyear
56590>>>>>        move cn.cn_code             to btnordh.cn_code
56591>>>>>        move clients.client_id      to btnordh.client_id
56592>>>>>        move payresp.presp_id       to btnordh.presp_id
56593>>>>>        move cn.cn_sls_id           to btnordh.user_id
56594>>>>>        if (btnordh.deop_date = '');           move cn.cn_start_date to btnordh.deop_date
56597>>>>>     end_procedure
56598>>>>>
56598>>>>>
56598>>>>>
56598>>>>>    // Define_Fields:
56598>>>>>    // This procedure is used to set up all data-dictionary rules.
56598>>>>>
56598>>>>>    Procedure Define_Fields
56599>>>>>        Forward Send Define_Fields
56601>>>>>        //DDB-Generated-Code-Location
56601>>>>>        //DDB-DefineFieldStart
56601>>>>>
56601>>>>>        Set Main_File            To Btnordh.File_Number
56602>>>>>        Set Cascade_Delete_State To FALSE
56603>>>>>
56603>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
56604>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
56605>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56606>>>>>
56606>>>>>        // Child (Client) file structure................
56606>>>>>        Send Add_Client_File  Btnordd.File_Number
56607>>>>>
56607>>>>>        // Parent (Server) file structure...............
56607>>>>>        Send Add_Server_File  Cn.File_Number
56608>>>>>
56608>>>>>        // External (System) file structure.............
56608>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
56609>>>>>
56609>>>>>        Define_Auto_Increment  Sysrecc.Btnordh_Rec0  To Btnordh.Rec0
56612>>>>>
56612>>>>>        // Field-based properties.......................
56612>>>>>
56612>>>>>        // Btnordh.Vcompany
56612>>>>>
56612>>>>>        // Btnordh.Vbranch
56612>>>>>
56612>>>>>        // Btnordh.Vyear
56612>>>>>
56612>>>>>        // Btnordh.Rec0
56612>>>>>
56612>>>>>        // Btnordh.Recr
56612>>>>>
56612>>>>>        // Btnordh.Aa_Deop
56612>>>>>        Set Field_Prompt_Object    Field Btnordh.Aa_Deop To (btnordh(Self))
56613>>>>>
56613>>>>>        // Btnordh.Cn_Recr
56613>>>>>
56613>>>>>        // Btnordh.Sxolia
56613>>>>>
56613>>>>>        // Btnordh.Cn_Code
56613>>>>>
56613>>>>>        // Btnordh.Client_Id
56613>>>>>
56613>>>>>        // Btnordh.Presp_Id
56613>>>>>
56613>>>>>        // Btnordh.Deop_Date
56613>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Date To MASK_DATE_WINDOW
56614>>>>>
56614>>>>>        // Btnordh.Deop_Active
56614>>>>>
56614>>>>>        // Btnordh.Eleiph
56614>>>>>
56614>>>>>        // Btnordh.Locked
56614>>>>>
56614>>>>>        // Btnordh.User_Id
56614>>>>>
56614>>>>>        // Btnordh.Date_Create
56614>>>>>
56614>>>>>        // Btnordh.Date_Modify
56614>>>>>
56614>>>>>        // Btnordh.Date_Locked
56614>>>>>
56614>>>>>        // Btnordh.Deop_Lhxh
56614>>>>>        Set Field_Mask_Type        Field Btnordh.Deop_Lhxh To MASK_DATE_WINDOW
56615>>>>>
56615>>>>>        // Btnordh.Statero
56615>>>>>
56615>>>>>        // Btnordh.Velxr
56615>>>>>        Set Field_Value_Table      Field Btnordh.Velxr To (Btnordh_Velxr_VT(Self))
56616>>>>>
56616>>>>>        // Btnordh.Timeout
56616>>>>>
56616>>>>>        // Btnordh.Timeout1
56616>>>>>
56616>>>>>        //DDB-DefineFieldEnd
56616>>>>>    End_Procedure    // Define_Fields
56617>>>>>
56617>>>>>
56617>>>>>    // Field_Defaults:
56617>>>>>    // This procedure is used to establish default field values.
56617>>>>>
56617>>>>>    Procedure Field_Defaults
56618>>>>>        Forward Send Field_Defaults
56620>>>>>        //DDB-Generated-Code-Location
56620>>>>>        //DDB-FieldDefaultStart
56620>>>>>        //DDB-FieldDefaultEnd
56620>>>>>    End_Procedure    // Field_Defaults
56621>>>>>
56621>>>>>End_Class    // Btnordh_DataDictionary
56622>>>>>//DDB-Selection-pkg-Start
56622>>>>>
56622>>>>>Use btnordh.sl       // btnordh
INCLUDING FILE: BTNORDH.SL
56622>>>>>>>//AB/ Project btnordh
56622>>>>>>>//AB/ Object prj is a Lookup_Project
56622>>>>>>>//AB/     Set ProjectName to "btnordh"
56622>>>>>>>//AB/     Set ProjectFileName to "btnordh.SL"
56622>>>>>>>//AB/     Set GenerateFileName to "NONAME"
56622>>>>>>>
56622>>>>>>>// Project Object Structure
56622>>>>>>>//   btnordh is a dbModalPanelSub
56622>>>>>>>//     Country_DD is a DataDictionary
56622>>>>>>>//     Towns_DD is a DataDictionary
56622>>>>>>>//     Cities_DD is a DataDictionary
56622>>>>>>>//     Areas_DD is a DataDictionary
56622>>>>>>>//     Payresp_DD is a DataDictionary
56622>>>>>>>//     Clients_DD is a DataDictionary
56622>>>>>>>//     Salesmen_DD is a DataDictionary
56622>>>>>>>//     Mhxanik_DD is a DataDictionary
56622>>>>>>>//     Constrct_DD is a DataDictionary
56622>>>>>>>//     Cn_DD is a DataDictionary
56622>>>>>>>//     Btnordh_DD is a DataDictionary
56622>>>>>>>//     Btnordd_DD is a DataDictionary
56622>>>>>>>//     oSelList is a dbListSub
56622>>>>>>>//     oOK_bn is a ButtonSub
56622>>>>>>>//     oCancel_bn is a ButtonSub
56622>>>>>>>//     oSearch_bn is a ButtonSub
56622>>>>>>>
56622>>>>>>>// Register all objects
56622>>>>>>>Register_Object Areas_DD
56622>>>>>>>Register_Object Btnordd_DD
56622>>>>>>>Register_Object Btnordh_DD
56622>>>>>>>Register_Object btnordh
56622>>>>>>>Register_Object Cities_DD
56622>>>>>>>Register_Object Clients_DD
56622>>>>>>>Register_Object Cn_DD
56622>>>>>>>Register_Object Constrct_DD
56622>>>>>>>Register_Object Country_DD
56622>>>>>>>Register_Object Mhxanik_DD
56622>>>>>>>Register_Object oCancel_bn
56622>>>>>>>Register_Object oOK_bn
56622>>>>>>>Register_Object oSearch_bn
56622>>>>>>>Register_Object oSelList
56622>>>>>>>Register_Object Payresp_DD
56622>>>>>>>Register_Object Salesmen_DD
56622>>>>>>>Register_Object Towns_DD
56622>>>>>>>
56622>>>>>>>
56622>>>>>>>//AB-IgnoreStart
56622>>>>>>>
56622>>>>>>>Use DFAllEnt.pkg
56622>>>>>>>Use dbList.Sub
56622>>>>>>>Use Button.Sub
56622>>>>>>>
56622>>>>>>>
56622>>>>>>>Use COUNTRY.DD
56622>>>>>>>Use TOWNS.DD
56622>>>>>>>Use CITIES.DD
56622>>>>>>>Use AREAS.DD
56622>>>>>>>Use PAYRESP.DD
56622>>>>>>>Use CLIENTS.DD
56622>>>>>>>Use SALESMEN.DD
56622>>>>>>>Use MHXANIK.DD
INCLUDING FILE: MHXANIK.DD
56622>>>>>>>>>//DDB-FileStart
56622>>>>>>>>>//DDB-HeaderStart
56622>>>>>>>>>
56622>>>>>>>>>// File Name : MHXANIK.DD
56622>>>>>>>>>// Class Name: Mhxanik_DataDictionary
56622>>>>>>>>>// Revision  : 24
56622>>>>>>>>>// Version   : 2
56622>>>>>>>>>
56622>>>>>>>>>Use  Windows           // Basic Definitions
56622>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
56622>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56622>>>>>>>>>
56622>>>>>>>>>Open Mhxanik
56624>>>>>>>>>Open Cn
56626>>>>>>>>>Open Sysrecc
56628>>>>>>>>>
56628>>>>>>>>>//DDB-HeaderEnd
56628>>>>>>>>>//DDB-ValidationStart
56628>>>>>>>>>
56628>>>>>>>>>Register_Object Mhxanik_Mhx_Doy_VT
56628>>>>>>>>>
56628>>>>>>>>>Object Mhxanik_Mhx_Doy_VT  is a CodeValidationTable
56630>>>>>>>>>    Set Type_Value        To "DOY"
56631>>>>>>>>>    Set Validate_State    To FALSE
56632>>>>>>>>>    Set Allow_Blank_State To TRUE
56633>>>>>>>>>    //DDB-ValidationCustomStart
56633>>>>>>>>>    //DDB-ValidationCustomEnd
56633>>>>>>>>>End_Object   // Mhxanik_Mhx_Doy_VT
56634>>>>>>>>>//DDB-ValidationEnd
56634>>>>>>>>>//DDB-SelectionStart
56634>>>>>>>>>//DDB/ ExternalSelectionList sl055  sl055.SL
56634>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
56634>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
56634>>>>>>>>>Register_Object sl055
56634>>>>>>>>>Register_Object sl198
56634>>>>>>>>>Register_Object sl197
56634>>>>>>>>>//DDB-SelectionEnd
56634>>>>>>>>>
56634>>>>>>>>>Class Mhxanik_DataDictionary  is a DataDictionary_Sec
56635>>>>>>>>>
56635>>>>>>>>>     Procedure Update
56636>>>>>>>>>        Forward Send Update
56638>>>>>>>>>        // Insert Code Here
56638>>>>>>>>>        Move SysCurXR.Company_Code  to Mhxanik.Company_Code
56639>>>>>>>>>        Move SysCurXR.Branch_Code   to Mhxanik.Branch_Code
56640>>>>>>>>>        Move SysCurXR.Year_Year     to Mhxanik.Year_Year
56641>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
56641>>>>>>>>>        Move (Mhxanik.Xreosh-Mhxanik.Pistosh)   to Mhxanik.Ypoloipo
56642>>>>>>>>>        Move (Mhxanik.Plafon-Mhxanik.ypoloipo)  to Mhxanik.Overhead
56643>>>>>>>>>
56643>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
56643>>>>>>>>>
56643>>>>>>>>>        //betolink
56643>>>>>>>>>        Move SysCurXR.Beto_Site         to Mhxanik.Mhx_SiteW
56644>>>>>>>>>        Move Mhxanik.Mhx_Rec0           to Mhxanik.Mhx_SN
56645>>>>>>>>>        Move Mhxanik.Mhx_id             to Mhxanik.Mhx_Repm
56646>>>>>>>>>
56646>>>>>>>>>    End_Procedure   // Update
56647>>>>>>>>>
56647>>>>>>>>>     Procedure Creating
56648>>>>>>>>>        Forward Send Creating
56650>>>>>>>>>        // Insert Code Here
56650>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Mhxanik.Mhx_Rec0))))));                                    to Mhxanik.Mhx_Recr
56651>>>>>>>>>        Move '1'                    to Mhxanik.Mhx_Active
56652>>>>>>>>>        get fsgCode_With_Zeroes Mhxanik.Mhx_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Mhxanik.Mhx_ID
56653>>>>>>>>>    End_Procedure   // Creating
56654>>>>>>>>>
56654>>>>>>>>>
56654>>>>>>>>>    // Define_Fields:
56654>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
56654>>>>>>>>>
56654>>>>>>>>>    Procedure Define_Fields
56655>>>>>>>>>        Forward Send Define_Fields
56657>>>>>>>>>        //DDB-Generated-Code-Location
56657>>>>>>>>>        //DDB-DefineFieldStart
56657>>>>>>>>>
56657>>>>>>>>>        Set Main_File            To Mhxanik.File_Number
56658>>>>>>>>>        Set Cascade_Delete_State To FALSE
56659>>>>>>>>>
56659>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
56660>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
56661>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56662>>>>>>>>>
56662>>>>>>>>>        // Child (Client) file structure................
56662>>>>>>>>>        Send Add_Client_File  Cn.File_Number
56663>>>>>>>>>
56663>>>>>>>>>        // External (System) file structure.............
56663>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
56664>>>>>>>>>
56664>>>>>>>>>        Define_Auto_Increment  Sysrecc.Mhxanik_Rec0  To Mhxanik.Mhx_Rec0
56667>>>>>>>>>
56667>>>>>>>>>        // Field-based properties.......................
56667>>>>>>>>>
56667>>>>>>>>>        // Mhxanik.Company_Code
56667>>>>>>>>>
56667>>>>>>>>>        // Mhxanik.Branch_Code
56667>>>>>>>>>
56667>>>>>>>>>        // Mhxanik.Year_Year
56667>>>>>>>>>
56667>>>>>>>>>        // Mhxanik.Mhx_Id
56667>>>>>>>>>        Set Field_Options          Field Mhxanik.Mhx_Id To DD_AUTOFIND    DD_NOPUT      
56668>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Id To (sl055(Self))
56669>>>>>>>>>        Set Key_Field_State        Field Mhxanik.Mhx_Id To TRUE
56670>>>>>>>>>
56670>>>>>>>>>        // Mhxanik.Mhx_Name
56670>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Name To (sl055(Self))
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Mhx_Afm
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Mhx_Rec0
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Mhx_Recr
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Last_Xreosh
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Last_Pistosh
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Last_Order
56671>>>>>>>>>
56671>>>>>>>>>        // Mhxanik.Mhx_Doy
56671>>>>>>>>>        Set Field_Value_Table      Field Mhxanik.Mhx_Doy To (Mhxanik_Mhx_Doy_VT(Self))
56672>>>>>>>>>
56672>>>>>>>>>        // Mhxanik.Mhx_Address
56672>>>>>>>>>
56672>>>>>>>>>        // Mhxanik.Mhx_City
56672>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_City To (sl198(Self))
56673>>>>>>>>>
56673>>>>>>>>>        // Mhxanik.Mhx_Area
56673>>>>>>>>>        Set Field_Prompt_Object    Field Mhxanik.Mhx_Area To (sl197(Self))
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Job
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Respons
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Zipcode
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Phone
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Fax
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Mobile
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Aoh
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Email
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Class
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Details
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Sitew
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Codem
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Categfpa
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Fpa
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Public
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Sn
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Repm
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Active
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Reported
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Lastupd
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Markexp
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Catjob
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Xreosh
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Pistosh
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Ypoloipo
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Plafon
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Overhead
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Add_No
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Nomos
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Mhx_Xora
56674>>>>>>>>>
56674>>>>>>>>>        // Mhxanik.Polh_Recr
56674>>>>>>>>>
56674>>>>>>>>>        //DDB-DefineFieldEnd
56674>>>>>>>>>    End_Procedure    // Define_Fields
56675>>>>>>>>>
56675>>>>>>>>>    // Field_Defaults:
56675>>>>>>>>>    // This procedure is used to establish default field values.
56675>>>>>>>>>
56675>>>>>>>>>    Procedure Field_Defaults
56676>>>>>>>>>        Forward Send Field_Defaults
56678>>>>>>>>>        //DDB-Generated-Code-Location
56678>>>>>>>>>        //DDB-FieldDefaultStart
56678>>>>>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_Doy To "0"
56679>>>>>>>>>        Set Field_Changed_Value   Field Mhxanik.Mhx_City To 0
56680>>>>>>>>>        //DDB-FieldDefaultEnd
56680>>>>>>>>>    End_Procedure    // Field_Defaults
56681>>>>>>>>>
56681>>>>>>>>>End_Class    // Mhxanik_DataDictionary
56682>>>>>>>>>//DDB-Selection-pkg-Start
56682>>>>>>>>>
56682>>>>>>>>>Use sl055.SL         // sl055
INCLUDING FILE: SL055.SL
56682>>>>>>>>>>>//AB/ Project sl055:mhxanikoi
56682>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
56682>>>>>>>>>>>//AB/     Set ProjectName to "sl055:mhxanikoi"
56682>>>>>>>>>>>//AB/     Set ProjectFileName to "sl055.SL"
56682>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
56682>>>>>>>>>>>
56682>>>>>>>>>>>// Project Object Structure
56682>>>>>>>>>>>//   sl055 is a dbModalPanelSub
56682>>>>>>>>>>>//     Mhxanik_DD is a DataDictionary
56682>>>>>>>>>>>//     oSelList is a dbListSub
56682>>>>>>>>>>>//     oOK_bn is a ButtonSub
56682>>>>>>>>>>>//     oCancel_bn is a ButtonSub
56682>>>>>>>>>>>//     oSearch_bn is a ButtonSub
56682>>>>>>>>>>>
56682>>>>>>>>>>>// Register all objects
56682>>>>>>>>>>>Register_Object Mhxanik_DD
56682>>>>>>>>>>>Register_Object oCancel_bn
56682>>>>>>>>>>>Register_Object oOK_bn
56682>>>>>>>>>>>Register_Object oSearch_bn
56682>>>>>>>>>>>Register_Object oSelList
56682>>>>>>>>>>>Register_Object sl055
56682>>>>>>>>>>>
56682>>>>>>>>>>>
56682>>>>>>>>>>>//AB-IgnoreStart
56682>>>>>>>>>>>
56682>>>>>>>>>>>Use DFAllEnt.pkg
56682>>>>>>>>>>>Use dbList.Sub
56682>>>>>>>>>>>Use Button.Sub
56682>>>>>>>>>>>
56682>>>>>>>>>>>
56682>>>>>>>>>>>Use MHXANIK.DD
56682>>>>>>>>>>>
56682>>>>>>>>>>>//AB-IgnoreEnd
56682>>>>>>>>>>>
56682>>>>>>>>>>>Object sl055 is a dbModalPanelSub
56684>>>>>>>>>>>    Set Label to "€¨®œå¦ ‹ž®˜¤ ¡é¤"
56685>>>>>>>>>>>    Set Size to 148 430
56686>>>>>>>>>>>    Set Location to 4 5
56687>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
56688>>>>>>>>>>>    Set Modal_State to FALSE
56689>>>>>>>>>>>
56689>>>>>>>>>>>    //AB-DDOStart
56689>>>>>>>>>>>
56689>>>>>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
56691>>>>>>>>>>>    End_Object    // Mhxanik_DD
56692>>>>>>>>>>>
56692>>>>>>>>>>>    Set Main_DD to (Mhxanik_DD(self))
56693>>>>>>>>>>>    Set Server to (Mhxanik_DD(self))
56694>>>>>>>>>>>
56694>>>>>>>>>>>    //AB-DDOEnd
56694>>>>>>>>>>>
56694>>>>>>>>>>>    Object oSelList is a dbListSub
56696>>>>>>>>>>>        Set Main_File to Mhxanik.File_Number
56697>>>>>>>>>>>        Set Size to 105 415
56698>>>>>>>>>>>        Set Location to 6 6
56699>>>>>>>>>>>
56699>>>>>>>>>>>        Begin_Row
56702>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_id
56703>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_name
56704>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_afm
56705>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_address
56706>>>>>>>>>>>            Entry_Item Mhxanik.Mhx_phone
56707>>>>>>>>>>>        End_Row
56712>>>>>>>>>>>
56712>>>>>>>>>>>        Set Form_Width    item 0 to 70
56713>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
56714>>>>>>>>>>>        
56714>>>>>>>>>>>        Set Form_Width    item 1 to 100
56715>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
56716>>>>>>>>>>>        
56716>>>>>>>>>>>        Set Form_Width    item 2 to 50
56717>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
56718>>>>>>>>>>>        
56718>>>>>>>>>>>        Set Form_Width    item 3 to 135
56719>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
56720>>>>>>>>>>>        
56720>>>>>>>>>>>        Set Form_Width    item 4 to 52
56721>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
56722>>>>>>>>>>>        
56722>>>>>>>>>>>    End_Object    // oSelList
56723>>>>>>>>>>>
56723>>>>>>>>>>>    Object oOK_bn is a ButtonSub
56725>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
56726>>>>>>>>>>>        Set Location to 113 263
56727>>>>>>>>>>>
56727>>>>>>>>>>>        //AB-StoreStart
56727>>>>>>>>>>>        Procedure OnClick
56729>>>>>>>>>>>            Send OK To (oSelList(current_object))
56730>>>>>>>>>>>        End_Procedure
56731>>>>>>>>>>>        //AB-StoreEnd
56731>>>>>>>>>>>
56731>>>>>>>>>>>    End_Object    // oOK_bn
56732>>>>>>>>>>>
56732>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
56734>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
56735>>>>>>>>>>>        Set Location to 113 317
56736>>>>>>>>>>>
56736>>>>>>>>>>>        //AB-StoreStart
56736>>>>>>>>>>>        Procedure OnClick
56738>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
56739>>>>>>>>>>>        End_Procedure
56740>>>>>>>>>>>        //AB-StoreEnd
56740>>>>>>>>>>>
56740>>>>>>>>>>>    End_Object    // oCancel_bn
56741>>>>>>>>>>>
56741>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
56743>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
56744>>>>>>>>>>>        Set Location to 113 373
56745>>>>>>>>>>>
56745>>>>>>>>>>>        //AB-StoreStart
56745>>>>>>>>>>>        Procedure OnClick
56747>>>>>>>>>>>            Send Search To (oSelList(current_object))
56748>>>>>>>>>>>        End_Procedure
56749>>>>>>>>>>>        //AB-StoreEnd
56749>>>>>>>>>>>
56749>>>>>>>>>>>    End_Object    // oSearch_bn
56750>>>>>>>>>>>
56750>>>>>>>>>>>
56750>>>>>>>>>>>    //AB-StoreStart
56750>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
56751>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
56752>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
56753>>>>>>>>>>>    //AB-StoreEnd
56753>>>>>>>>>>>
56753>>>>>>>>>>>End_Object    // sl055
56754>>>>>>>>>>>
56754>>>>>>>>>>>//AB/ End_Object    // prj
56754>>>>>>>>>Use sl198.sl         // sl198
56754>>>>>>>>>Use sl197.SL         // sl197
56754>>>>>>>>>
56754>>>>>>>>>//DDB-Selection-pkg-End
56754>>>>>>>>>//DDB-FileEnd
56754>>>>>>>Use CONSTRCT.DD
56754>>>>>>>Use CN.DD
56754>>>>>>>Use BTNORDH.DD
56754>>>>>>>Use BTNORDD.DD
INCLUDING FILE: BTNORDD.DD
56754>>>>>>>>>//DDB-FileStart
56754>>>>>>>>>//DDB-HeaderStart
56754>>>>>>>>>
56754>>>>>>>>>// File Name : BTNORDD.DD
56754>>>>>>>>>// Class Name: Btnordd_DataDictionary
56754>>>>>>>>>// Revision  : 52
56754>>>>>>>>>// Version   : 2
56754>>>>>>>>>
56754>>>>>>>>>Use  Windows           // Basic Definitions
56754>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
56754>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56754>>>>>>>>>
56754>>>>>>>>>Open Btnordd
56756>>>>>>>>>Open Btnordh
56758>>>>>>>>>
56758>>>>>>>>>//DDB-HeaderEnd
56758>>>>>>>>>//DDB-ValidationStart
56758>>>>>>>>>
56758>>>>>>>>>Register_Object Btnordd_Vkatish_VT
56758>>>>>>>>>Register_Object Btnordd_Velxr_VT
56758>>>>>>>>>
56758>>>>>>>>>Object Btnordd_Vkatish_VT  is a CodeValidationTable
56760>>>>>>>>>    Set Type_Value        To "KATISH"
56761>>>>>>>>>    Set Allow_Blank_State To TRUE
56762>>>>>>>>>    Set Table_Title       To "‰€‡ˆ‘†"
56763>>>>>>>>>    //DDB-ValidationCustomStart
56763>>>>>>>>>    //DDB-ValidationCustomEnd
56763>>>>>>>>>End_Object   // Btnordd_Vkatish_VT
56764>>>>>>>>>
56764>>>>>>>>>Object Btnordd_Velxr_VT  is a CodeValidationTable
56766>>>>>>>>>    Set Type_Value        To "ELXREOSH"
56767>>>>>>>>>    Set Validate_State    To FALSE
56768>>>>>>>>>    Set Table_Title       To "•¨âà©ž „¢¢œ §é¤ ”¦¨«åà¤"
56769>>>>>>>>>    //DDB-ValidationCustomStart
56769>>>>>>>>>    //DDB-ValidationCustomEnd
56769>>>>>>>>>End_Object   // Btnordd_Velxr_VT
56770>>>>>>>>>//DDB-ValidationEnd
56770>>>>>>>>>Open Item
56772>>>>>>>>>
56772>>>>>>>>>Class Btnordd_DataDictionary  is a DataDictionary_Sec
56773>>>>>>>>> 
56773>>>>>>>>>    Procedure Construct_Object
56774>>>>>>>>>        Forward Send Construct_Object
56776>>>>>>>>>        Property Number pnOldPctDisc    Public 0
56777>>>>>>>>>        Property Number pnOldPosoDisc   Public 0
56778>>>>>>>>>        //------------------------------------------------
56778>>>>>>>>>        // Properties gia na kraththoun oi palies times 
56778>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
56778>>>>>>>>>        // einai 1     js 03/12/2007
56778>>>>>>>>>        //------------------------------------------------  
56778>>>>>>>>>        Property Integer piCreateNew            Public  0
56779>>>>>>>>>        Property String  psAud_Old_AADeop       Public ""
56780>>>>>>>>>        Property Number  pnAud_Old_Vprice       Public  0
56781>>>>>>>>>        Property Number  pnAud_Old_PagiaXRM3    Public  0
56782>>>>>>>>>        Property Number  pnAud_Old_PagiaXRPrice Public  0
56783>>>>>>>>>        Property Number  pnAud_Old_Vanopagia    Public  0
56784>>>>>>>>>        Property Integer piAud_Old_Eleiph       Public  0    
56785>>>>>>>>>        Property String  psAud_Old_Vitem        Public ""
56786>>>>>>>>>        Property String  psAud_Old_CN_Code      Public ""
56787>>>>>>>>>        Property String  psAud_Old_CN_Descr     Public ""
56788>>>>>>>>>        Property String  psAud_Old_Client_ID    Public ""
56789>>>>>>>>>        Property String  psAud_Old_Client_Name  Public ""
56790>>>>>>>>>        //------------------------------------------------
56790>>>>>>>>>    End_Procedure
56791>>>>>>>>>    
56791>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
56792>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
56794>>>>>>>>>        Set pnOldPctDisc            to Btnordd.Vdisc
56795>>>>>>>>>        Set pnOldPosoDisc           to Btnordd.VdiscPoso
56796>>>>>>>>>        Set psAud_Old_AADeop        to BtnordH.AA_Deop
56797>>>>>>>>>        Set piAud_Old_Eleiph        to BtnordH.VelXr
56798>>>>>>>>>        Set pnAud_Old_Vprice        to Btnordd.Vprice
56799>>>>>>>>>        Set pnAud_Old_PagiaXRM3     to Btnordd.VpagiaXrM3
56800>>>>>>>>>        Set pnAud_Old_PagiaXRPrice  to Btnordd.VpagiaXrPrice
56801>>>>>>>>>        Set pnAud_Old_Vanopagia     to Btnordd.Vanopagia
56802>>>>>>>>>        Set psAud_Old_Vitem         to Btnordd.Vitem         
56803>>>>>>>>>        Set psAud_Old_CN_Code       to CN.CN_Code            
56804>>>>>>>>>        Set psAud_Old_CN_Descr      to CN.CN_Descr           
56805>>>>>>>>>        Set psAud_Old_Client_ID     to Clients.Client_ID     
56806>>>>>>>>>        Set psAud_Old_Client_Name   to Clients.Client_Name   
56807>>>>>>>>>    End_Procedure   // New_Current_Record
56808>>>>>>>>>
56808>>>>>>>>>    Procedure Delete_Main_File
56809>>>>>>>>>        //---------------------------------------------
56809>>>>>>>>>        // Auditing / Katagrafh allagon
56809>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
56810>>>>>>>>>        Date    dDate  Shmer 
56810>>>>>>>>>        Integer iMin iHour iSec iLen
56810>>>>>>>>>        Sysdate dDate iHour iMin iSec 
56814>>>>>>>>>        Move iHour  to sHour
56815>>>>>>>>>        Move iMin   to sMin
56816>>>>>>>>>        Move iSec   to sSec
56817>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
56821>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
56825>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
56829>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
56830>>>>>>>>>        
56830>>>>>>>>>        // Auditing / Diagrafh 
56830>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
56832>>>>>>>>>            Get fsLoginUserID to sUser
56833>>>>>>>>>            clear gmove
56834>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
56835>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
56836>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
56837>>>>>>>>>            move  7                     to gmove.gtypkin_code// Apo Clients
56838>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
56839>>>>>>>>>            move suser                  to gmove.gplan_code
56840>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Btnordd.Recnum)))))) ;                                        to gmove.garticl_recr
56841>>>>>>>>>            reread sysrecg
56845>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
56846>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
56847>>>>>>>>>            saverecord sysrecg
56848>>>>>>>>>            unlock
56849>>>>>>>>>>
56849>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
56850>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
56851>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
56852>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
56853>>>>>>>>>            
56853>>>>>>>>>            Move BtnordH.Recr                   to Gmove.Partl_Recr          
56854>>>>>>>>>            Move (String(BtnOrdD.Recnum))       to Gmove.Pms_Recr          
56855>>>>>>>>>
56855>>>>>>>>>            Move (psAud_Old_AADeop      (Self)) to Gmove.Prev_AA_Deop
56856>>>>>>>>>            Move (piAud_Old_Eleiph      (Self)) to Gmove.Prev_Eleiph
56857>>>>>>>>>            Move (pnAud_Old_Vprice      (Self)) to Gmove.Prev_Vprice
56858>>>>>>>>>            Move (pnAud_Old_PagiaXRM3   (Self)) to Gmove.Prev_pagiaXrM3
56859>>>>>>>>>            Move (pnAud_Old_PagiaXRPrice(Self)) to Gmove.Prev_Stoxos1
56860>>>>>>>>>            Move (pnAud_Old_Vanopagia   (Self)) to Gmove.Prev_Stoxos2   
56861>>>>>>>>>            Move (psAud_Old_Vitem       (Self)) to Gmove.Prev_Item    
56862>>>>>>>>>            Move (psAud_Old_CN_Code     (Self)) to Gmove.Prev_CN      
56863>>>>>>>>>            Move (psAud_Old_CN_Descr    (Self)) to Gmove.Prev_CN_Addr 
56864>>>>>>>>>            Move (psAud_Old_Client_ID   (Self)) to Gmove.Prev_ID      
56865>>>>>>>>>            Move (psAud_Old_Client_Name (Self)) to Gmove.Prev_Name    
56866>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ƒ„Ž"    to gmove.gmove_aitiol
56867>>>>>>>>>            Move "D"                         to Gmove.Eidos_Metabolhs
56868>>>>>>>>>            saverecord gmove
56869>>>>>>>>>        End
56869>>>>>>>>>>
56869>>>>>>>>>        Forward Send Delete_Main_File
56871>>>>>>>>>
56871>>>>>>>>>    End_Procedure
56872>>>>>>>>>
56872>>>>>>>>>    Procedure Creating
56873>>>>>>>>>        Forward Send Creating   
56875>>>>>>>>>        move btnordh.deop_active to btnordd.vactive
56876>>>>>>>>>        Set piCreateNew to 1
56877>>>>>>>>>    End_Procedure   // Creating
56878>>>>>>>>> 
56878>>>>>>>>>   Procedure Update
56879>>>>>>>>>        Number iOldPct iOldPoso Total
56880>>>>>>>>>        Forward Send Update   
56882>>>>>>>>>        Get pnOldPosoDisc           to iOldPoso
56883>>>>>>>>>        Get pnOldPctDisc            to iOldPct
56884>>>>>>>>>        move btnordh.aa_deop        to btnordd.vorderbt
56885>>>>>>>>>        move btnordh.client_id      to btnordd.vclient_id
56886>>>>>>>>>        move btnordh.cn_code        to btnordd.vcn_code
56887>>>>>>>>>        move btnordh.deop_lhxh      to btnordd.deop_date   
56888>>>>>>>>>        move btnordh.deop_date      to btnordd.arxh_date
56889>>>>>>>>>      
56889>>>>>>>>>        If  (Btnordd.Vqty <> 0) Begin
56891>>>>>>>>>            Move  btnordd.VunitPrice to btnordd.Vprice
56892>>>>>>>>>            If (btnordd.vdisc >0) move (round_number(((btnordd.vprice * btnordd.vdisc) / 100),2)) to total
56895>>>>>>>>>            Move (btnordd.vprice - total) to btnordd.vprice
56896>>>>>>>>>        End
56896>>>>>>>>>>
56896>>>>>>>>>        Else Begin
56897>>>>>>>>>            move 0 to btnordd.vprice
56898>>>>>>>>>            Move 0 to btnordd.Vdisc
56899>>>>>>>>>            Move 0 to btnordd.VdiscPoso
56900>>>>>>>>>        End
56900>>>>>>>>>>
56900>>>>>>>>>
56900>>>>>>>>>        If (Btnordd.Vitem<>'') Begin 
56902>>>>>>>>>            Clear Item
56903>>>>>>>>>            Move Btnordd.Vitem to Item.Item_Code
56904>>>>>>>>>            Find Eq Item by Index.5
56905>>>>>>>>>>
56905>>>>>>>>>            Move Item.Item_Descr to btnordd.Vitem_Descr
56906>>>>>>>>>            Move Item.Item_Qual  to btnordd.VQual    
56907>>>>>>>>>            Clear Item
56908>>>>>>>>>        End
56908>>>>>>>>>>
56908>>>>>>>>>
56908>>>>>>>>>        //---------------------------------------------
56908>>>>>>>>>        // Auditing / Katagrafh allagon
56908>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
56908>>>>>>>>>        Date    dDate  Shmer 
56908>>>>>>>>>        Integer iMin iHour iSec iLen
56908>>>>>>>>>        Sysdate dDate iHour iMin iSec 
56912>>>>>>>>>        Move iHour  to sHour
56913>>>>>>>>>        Move iMin   to sMin
56914>>>>>>>>>        Move iSec   to sSec
56915>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
56919>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
56923>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
56927>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
56928>>>>>>>>>        
56928>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
56928>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
56930>>>>>>>>>            Get fsLoginUserID to sUser
56931>>>>>>>>>            If (piCreateNew(Self)=1) Begin
56933>>>>>>>>>                clear gmove
56934>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
56935>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
56936>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
56937>>>>>>>>>                move  7                     to gmove.gtypkin_code
56938>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
56939>>>>>>>>>                move suser                  to gmove.gplan_code
56940>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Btnordd.Recnum)))))) ;                                            to gmove.garticl_recr
56941>>>>>>>>>                reread sysrecg
56945>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
56946>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
56947>>>>>>>>>                saverecord sysrecg
56948>>>>>>>>>                unlock
56949>>>>>>>>>>
56949>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
56950>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
56951>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
56952>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
56953>>>>>>>>>
56953>>>>>>>>>                Move BtnordH.Recr                   to Gmove.Partl_Recr          
56954>>>>>>>>>                Move (String(BtnOrdD.Recnum))       to Gmove.Pms_Recr          
56955>>>>>>>>>
56955>>>>>>>>>                Move BtnordH.AA_Deop            to Gmove.Cur_AA_Deop
56956>>>>>>>>>                Move BtnordH.VelXr             to Gmove.Cur_Eleiph
56957>>>>>>>>>                Move Btnordd.Vprice             to Gmove.Cur_Vprice
56958>>>>>>>>>                Move Btnordd.VpagiaXrM3         to Gmove.Cur_pagiaXrM3
56959>>>>>>>>>                Move Btnordd.VpagiaXrPrice      to Gmove.Cur_Stoxos1
56960>>>>>>>>>                Move Btnordd.Vanopagia          to Gmove.Cur_Stoxos2
56961>>>>>>>>>                Move Btnordd.Vitem              to Gmove.Cur_Item
56962>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
56963>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
56964>>>>>>>>>                Move Clients.Client_ID          to Gmove.Cur_ID
56965>>>>>>>>>                Move Clients.Client_Name        to Gmove.Cur_Name   
56966>>>>>>>>>                
56966>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ƒ„Ž" to Gmove.Gmove_Aitiol
56967>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
56968>>>>>>>>>                saverecord gmove
56969>>>>>>>>>                Set piCreateNew to 0
56970>>>>>>>>>            End
56970>>>>>>>>>>
56970>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
56973>>>>>>>>>                Integer isChanged
56973>>>>>>>>>                Move 0 to isChanged
56974>>>>>>>>>                
56974>>>>>>>>>                     If (psAud_Old_AADeop       (Self)<>BtnordH.AA_Deop      ) Move 1 to isChanged
56977>>>>>>>>>                Else If (piAud_Old_Eleiph       (Self)<>BtnordH.VelXr       ) Move 1 to isChanged
56981>>>>>>>>>                Else If (pnAud_Old_Vprice       (Self)<>Btnordd.Vprice       ) Move 1 to isChanged
56985>>>>>>>>>                Else If (pnAud_Old_PagiaXRM3    (Self)<>Btnordd.VpagiaXrM3   ) Move 1 to isChanged
56989>>>>>>>>>                Else If (pnAud_Old_PagiaXRPrice (Self)<>Btnordd.VpagiaXrPrice) Move 1 to isChanged
56993>>>>>>>>>                Else If (pnAud_Old_Vanopagia    (Self)<>Btnordd.Vanopagia    ) Move 1 to isChanged
56997>>>>>>>>>                Else If (psAud_Old_Vitem        (Self)<>Btnordd.Vitem        ) Move 1 to isChanged
57001>>>>>>>>>                Else If (psAud_Old_CN_Code      (Self)<>CN.CN_Code           ) Move 1 to isChanged
57005>>>>>>>>>                Else If (psAud_Old_CN_Descr     (Self)<>CN.CN_Descr          ) Move 1 to isChanged
57009>>>>>>>>>                Else If (psAud_Old_Client_ID    (Self)<>Clients.Client_ID    ) Move 1 to isChanged
57013>>>>>>>>>                Else If (psAud_Old_Client_Name  (Self)<>Clients.Client_Name  ) Move 1 to isChanged
57017>>>>>>>>>                
57017>>>>>>>>>                If (isChanged>0) Begin  
57019>>>>>>>>>                    clear gmove
57020>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
57021>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
57022>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
57023>>>>>>>>>                    move  7                     to gmove.gtypkin_code// Apo Clients
57024>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
57025>>>>>>>>>                    move suser                  to gmove.gplan_code
57026>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Btnordd.Recnum)))))) ;                                                to gmove.garticl_recr
57027>>>>>>>>>                    reread sysrecg
57031>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
57032>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
57033>>>>>>>>>                    saverecord sysrecg
57034>>>>>>>>>                    unlock
57035>>>>>>>>>>
57035>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
57036>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
57037>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
57038>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
57039>>>>>>>>>                    //--
57039>>>>>>>>>                    Move BtnordH.Recr                   to Gmove.Partl_Recr          
57040>>>>>>>>>                    Move (String(BtnOrdD.Recnum))       to Gmove.Pms_Recr          
57041>>>>>>>>>                    //--                                
57041>>>>>>>>>                    Move BtnordH.AA_Deop                to Gmove.Cur_AA_Deop
57042>>>>>>>>>                    Move BtnordH.VelXr                 to Gmove.Cur_Eleiph
57043>>>>>>>>>                    Move Btnordd.Vprice                 to Gmove.Cur_Vprice
57044>>>>>>>>>                    Move Btnordd.VpagiaXrM3             to Gmove.Cur_pagiaXrM3
57045>>>>>>>>>                    Move Btnordd.VpagiaXrPrice          to Gmove.Cur_Stoxos1
57046>>>>>>>>>                    Move Btnordd.Vanopagia              to Gmove.Cur_Stoxos2
57047>>>>>>>>>                    Move Btnordd.Vitem                  to Gmove.Cur_Item
57048>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
57049>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
57050>>>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
57051>>>>>>>>>                    Move Clients.Client_Name            to Gmove.Cur_Name
57052>>>>>>>>>                    //--
57052>>>>>>>>>                    Move (psAud_Old_AADeop      (Self)) to Gmove.Prev_AA_Deop        
57053>>>>>>>>>                    Move (piAud_Old_Eleiph      (Self)) to Gmove.Prev_Eleiph         
57054>>>>>>>>>                    Move (pnAud_Old_Vprice      (Self)) to Gmove.Prev_Vprice       
57055>>>>>>>>>                    Move (pnAud_Old_PagiaXRM3   (Self)) to Gmove.Prev_pagiaXrM3   
57056>>>>>>>>>                    Move (pnAud_Old_PagiaXRPrice(Self)) to Gmove.Prev_Stoxos1      
57057>>>>>>>>>                    Move (pnAud_Old_Vanopagia   (Self)) to Gmove.Prev_Stoxos2      
57058>>>>>>>>>                    Move (psAud_Old_Vitem       (Self)) to Gmove.Prev_Item            
57059>>>>>>>>>                    Move (psAud_Old_CN_Code     (Self)) to Gmove.Prev_CN              
57060>>>>>>>>>                    Move (psAud_Old_CN_Descr    (Self)) to Gmove.Prev_CN_Addr         
57061>>>>>>>>>                    Move (psAud_Old_Client_ID   (Self)) to Gmove.Prev_ID              
57062>>>>>>>>>                    Move (psAud_Old_Client_Name (Self)) to Gmove.Prev_Name            
57063>>>>>>>>>
57063>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ƒ„Ž"       to gmove.gmove_aitiol
57064>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
57065>>>>>>>>>                    saverecord gmove
57066>>>>>>>>>                    Set piCreateNew to 0
57067>>>>>>>>>                End
57067>>>>>>>>>>
57067>>>>>>>>>            End
57067>>>>>>>>>>
57067>>>>>>>>>        End
57067>>>>>>>>>>
57067>>>>>>>>>
57067>>>>>>>>>   End_Procedure
57068>>>>>>>>>   
57068>>>>>>>>> 
57068>>>>>>>>>
57068>>>>>>>>>    // Define_Fields:
57068>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
57068>>>>>>>>>
57068>>>>>>>>>    Procedure Define_Fields
57069>>>>>>>>>        Forward Send Define_Fields
57071>>>>>>>>>        //DDB-Generated-Code-Location
57071>>>>>>>>>        //DDB-DefineFieldStart
57071>>>>>>>>>
57071>>>>>>>>>        Set Main_File            To Btnordd.File_Number
57072>>>>>>>>>
57072>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57073>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57074>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57075>>>>>>>>>
57075>>>>>>>>>        // Parent (Server) file structure...............
57075>>>>>>>>>        Send Add_Server_File  Btnordh.File_Number
57076>>>>>>>>>
57076>>>>>>>>>        // Field-based properties.......................
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Btnordh_Recr
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vitem
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vitem_Descr
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vqual
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vqty
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vunitprice
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vdisc
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vprice
57076>>>>>>>>>
57076>>>>>>>>>        // Btnordd.Vkatish
57076>>>>>>>>>        Set Field_Value_Table      Field Btnordd.Vkatish To (Btnordd_Vkatish_VT(Self))
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vxrm3
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vpagiaxrm3
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vpagiaxrprice
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vanopagia
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vsthsimo
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Veleipes
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vorderbt
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vclient_Id
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vcn_Code
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Vactive
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Deop_Date
57077>>>>>>>>>
57077>>>>>>>>>        // Btnordd.Velxr
57077>>>>>>>>>        Set Field_Value_Table      Field Btnordd.Velxr To (Btnordd_Velxr_VT(Self))
57078>>>>>>>>>
57078>>>>>>>>>        // Btnordd.Arxh_Date
57078>>>>>>>>>        Set Field_Mask_Type        Field Btnordd.Arxh_Date To MASK_DATE_WINDOW
57079>>>>>>>>>
57079>>>>>>>>>        // Btnordd.Vdiscposo
57079>>>>>>>>>
57079>>>>>>>>>        // Btnordd.Vqtyused
57079>>>>>>>>>
57079>>>>>>>>>        //DDB-DefineFieldEnd
57079>>>>>>>>>    End_Procedure    // Define_Fields
57080>>>>>>>>>
57080>>>>>>>>>    // Field_Defaults:
57080>>>>>>>>>    // This procedure is used to establish default field values.
57080>>>>>>>>>
57080>>>>>>>>>    Procedure Field_Defaults
57081>>>>>>>>>        Forward Send Field_Defaults
57083>>>>>>>>>        //DDB-Generated-Code-Location
57083>>>>>>>>>        //DDB-FieldDefaultStart
57083>>>>>>>>>        //DDB-FieldDefaultEnd
57083>>>>>>>>>    End_Procedure    // Field_Defaults
57084>>>>>>>>>
57084>>>>>>>>>End_Class    // Btnordd_DataDictionary
57085>>>>>>>>>//DDB-FileEnd
57085>>>>>>>
57085>>>>>>>//AB-IgnoreEnd
57085>>>>>>>
57085>>>>>>>Object btnordh is a dbModalPanelSub
57087>>>>>>>
57087>>>>>>>    //AB-StoreTopStart
57087>>>>>>>    Function fnCn string descr Returns string
57089>>>>>>>          clear cn
57090>>>>>>>          move descr to cn.cn_code
57091>>>>>>>          find eq cn by index.5
57092>>>>>>>>
57092>>>>>>>          move cn.cn_descr to descr
57093>>>>>>>          function_return descr
57094>>>>>>>    end_Function
57095>>>>>>>    
57095>>>>>>>    property string psclient     public ''
57097>>>>>>>    property string pscn         public ''
57099>>>>>>>    //AB-StoreTopEnd
57099>>>>>>>
57099>>>>>>>    Set Label to "€¨®œå¦ ƒ.„.Ž."
57100>>>>>>>    Set Size to 233 519
57101>>>>>>>    Set Location to 4 5
57102>>>>>>>    Set Exit_Application_Local_State to FALSE
57103>>>>>>>    Set Modal_State to FALSE
57104>>>>>>>
57104>>>>>>>    //AB-DDOStart
57104>>>>>>>
57104>>>>>>>    Object Country_DD is a Country_DataDictionary
57106>>>>>>>    End_Object    // Country_DD
57107>>>>>>>
57107>>>>>>>    Object Towns_DD is a Towns_DataDictionary
57109>>>>>>>        Set DDO_Server to (Country_DD(self))
57110>>>>>>>    End_Object    // Towns_DD
57111>>>>>>>
57111>>>>>>>    Object Cities_DD is a Cities_DataDictionary
57113>>>>>>>        Set DDO_Server to (Towns_DD(self))
57114>>>>>>>    End_Object    // Cities_DD
57115>>>>>>>
57115>>>>>>>    Object Areas_DD is a Areas_DataDictionary
57117>>>>>>>    End_Object    // Areas_DD
57118>>>>>>>
57118>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
57120>>>>>>>    End_Object    // Payresp_DD
57121>>>>>>>
57121>>>>>>>    Object Clients_DD is a Clients_DataDictionary
57123>>>>>>>        Set DDO_Server to (Cities_DD(self))
57124>>>>>>>        Set DDO_Server to (Areas_DD(self))
57125>>>>>>>        Set DDO_Server to (Payresp_DD(self))
57126>>>>>>>    End_Object    // Clients_DD
57127>>>>>>>
57127>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
57129>>>>>>>    End_Object    // Salesmen_DD
57130>>>>>>>
57130>>>>>>>    Object Mhxanik_DD is a Mhxanik_DataDictionary
57132>>>>>>>    End_Object    // Mhxanik_DD
57133>>>>>>>
57133>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
57135>>>>>>>    End_Object    // Constrct_DD
57136>>>>>>>
57136>>>>>>>    Object Cn_DD is a Cn_DataDictionary
57138>>>>>>>        Set DDO_Server to (Clients_DD(self))
57139>>>>>>>        Set DDO_Server to (Salesmen_DD(self))
57140>>>>>>>        Set DDO_Server to (Mhxanik_DD(self))
57141>>>>>>>        Set DDO_Server to (Constrct_DD(self))
57142>>>>>>>    End_Object    // Cn_DD
57143>>>>>>>
57143>>>>>>>    Object Btnordh_DD is a Btnordh_DataDictionary
57145>>>>>>>        Set DDO_Server to (Cn_DD(self))
57146>>>>>>>
57146>>>>>>>        //AB-StoreStart
57146>>>>>>>        set ordering to 1
57147>>>>>>>        Begin_Constraints
57149>>>>>>>            String sID scn
57150>>>>>>>            Get psclient to sID
57151>>>>>>>            get pscn     to scn
57152>>>>>>>            if ((scn='') and (sid='')) set ordering to 1
57155>>>>>>>            else set ordering to 6
57157>>>>>>>            If (sID<>'') begin
57159>>>>>>>                Constrain btnordh.Client_ID eq sID
57161>>>>>>>            end
57161>>>>>>>>
57161>>>>>>>            If (scn<>'') begin
57163>>>>>>>                constrain btnordh.cn_code   eq scn
57165>>>>>>>            end
57165>>>>>>>>
57165>>>>>>>        
57165>>>>>>>        End_Constraints
57168>>>>>>>        
57168>>>>>>>        //AB-StoreEnd
57168>>>>>>>
57168>>>>>>>    End_Object    // Btnordh_DD
57169>>>>>>>
57169>>>>>>>    Object Btnordd_DD is a BTNORDD_DataDictionary
57171>>>>>>>        Set DDO_Server to (Btnordh_DD(self))
57172>>>>>>>        Set Constrain_File to Btnordh.File_Number
57173>>>>>>>    End_Object    // Btnordd_DD
57174>>>>>>>
57174>>>>>>>    Set Main_DD to (Btnordh_DD(self))
57175>>>>>>>    Set Server to (Btnordh_DD(self))
57176>>>>>>>
57176>>>>>>>    //AB-DDOEnd
57176>>>>>>>
57176>>>>>>>    Object oSelList is a dbListSub
57178>>>>>>>        Set Main_File to Btnordh.File_Number
57179>>>>>>>        Set Ordering to 6
57180>>>>>>>        Set Size to 192 507
57181>>>>>>>        Set Location to 6 6
57182>>>>>>>        Set Auto_Index_State to FALSE
57183>>>>>>>
57183>>>>>>>        Begin_Row
57186>>>>>>>            Entry_Item Btnordh.Aa_deop
57187>>>>>>>            Entry_Item Btnordh.Client_id
57188>>>>>>>            Entry_Item (fsclient(self,btnordh.client_id))
57189>>>>>>>            Entry_Item Btnordh.Cn_code
57190>>>>>>>            Entry_Item (fncn(self,btnordh.cn_code))
57191>>>>>>>            Entry_Item Btnordh.Deop_date
57192>>>>>>>            Entry_Item Btnordh.Deop_lhxh
57193>>>>>>>            Entry_Item Btnordh.Deop_active
57194>>>>>>>            Entry_Item Btnordh.Locked
57195>>>>>>>            Entry_Item Btnordh.Statero
57196>>>>>>>        End_Row
57201>>>>>>>
57201>>>>>>>        Set Form_Width    item 0 to 66
57202>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ƒ.„.Ž."
57203>>>>>>>        
57203>>>>>>>        Set Form_Width    item 1 to 51
57204>>>>>>>        Set Header_Label  item 1 to "‰à›.œ¢á«ž"
57205>>>>>>>        
57205>>>>>>>        Set Form_Width    item 2 to 87
57206>>>>>>>        Set Header_Label  item 2 to "„§à¤¬£å˜ œ¢á«ž"
57207>>>>>>>        
57207>>>>>>>        Set Form_Width    item 3 to 51
57208>>>>>>>        Set Header_Label  item 3 to "‰à›.„¨š¦¬"
57209>>>>>>>        
57209>>>>>>>        Set Form_Width    item 4 to 106
57210>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã „¨š¦¬"
57211>>>>>>>        
57211>>>>>>>        Set Form_Width    item 5 to 47
57212>>>>>>>        Set Header_Label  item 5 to "ë¤˜¨¥ž"
57213>>>>>>>        
57213>>>>>>>        Set Form_Width    item 6 to 44
57214>>>>>>>        Set Header_Label  item 6 to "Šã¥ž"
57215>>>>>>>        
57215>>>>>>>        Set Form_Width    item 7 to 19
57216>>>>>>>        Set Header_Label  item 7 to "Off"
57217>>>>>>>        Set Column_Checkbox_State  item 7 to True
57218>>>>>>>        
57218>>>>>>>        Set Form_Width    item 8 to 17
57219>>>>>>>        Set Header_Label  item 8 to "‰Š"
57220>>>>>>>        Set Column_Checkbox_State  item 8 to True
57221>>>>>>>        
57221>>>>>>>        Set Form_Width    item 9 to 13
57222>>>>>>>        Set Header_Label  item 9 to "‘"
57223>>>>>>>        Set Column_Checkbox_State  item 9 to True
57224>>>>>>>        
57224>>>>>>>
57224>>>>>>>        //AB-StoreStart
57224>>>>>>>                                                                                        
57224>>>>>>>                                                                                        
57224>>>>>>>        Procedure Activating Returns Integer
57226>>>>>>>            Integer rVal
57227>>>>>>>            Forward Get Msg_Activating to rVal
57229>>>>>>>            Send Rebuild_Constraints to (btnordh_DD(Self))
57230>>>>>>>            set auto_index_state to true
57231>>>>>>>            Procedure_Return rVal
57232>>>>>>>        End_Procedure
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        
57233>>>>>>>        //AB-StoreEnd
57233>>>>>>>
57233>>>>>>>    End_Object    // oSelList
57234>>>>>>>
57234>>>>>>>    Object oOK_bn is a ButtonSub
57236>>>>>>>        Set Label to "&„§ ¢¦šã"
57237>>>>>>>        Set Location to 201 335
57238>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57239>>>>>>>
57239>>>>>>>        //AB-StoreStart
57239>>>>>>>        Procedure OnClick
57241>>>>>>>            Send OK To (oSelList(current_object))
57242>>>>>>>        End_Procedure
57243>>>>>>>        //AB-StoreEnd
57243>>>>>>>
57243>>>>>>>    End_Object    // oOK_bn
57244>>>>>>>
57244>>>>>>>    Object oCancel_bn is a ButtonSub
57246>>>>>>>        Set Label to "&€¡ç¨à©ž"
57247>>>>>>>        Set Location to 201 389
57248>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57249>>>>>>>
57249>>>>>>>        //AB-StoreStart
57249>>>>>>>        Procedure OnClick
57251>>>>>>>            Send Cancel To (oSelList(current_object))
57252>>>>>>>        End_Procedure
57253>>>>>>>        //AB-StoreEnd
57253>>>>>>>
57253>>>>>>>    End_Object    // oCancel_bn
57254>>>>>>>
57254>>>>>>>    Object oSearch_bn is a ButtonSub
57256>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
57257>>>>>>>        Set Location to 201 445
57258>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57259>>>>>>>
57259>>>>>>>        //AB-StoreStart
57259>>>>>>>        Procedure OnClick
57261>>>>>>>            Send Search To (oSelList(current_object))
57262>>>>>>>        End_Procedure
57263>>>>>>>        //AB-StoreEnd
57263>>>>>>>
57263>>>>>>>    End_Object    // oSearch_bn
57264>>>>>>>
57264>>>>>>>
57264>>>>>>>    //AB-StoreStart
57264>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
57265>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
57266>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
57267>>>>>>>    
57267>>>>>>>    Procedure Activating Returns Integer
57269>>>>>>>        Integer rVal
57270>>>>>>>        Forward Get Msg_Activating to rVal
57272>>>>>>>        Send Beginning_Of_Data to oSelList
57273>>>>>>>        Procedure_Return rVal
57274>>>>>>>    End_Procedure
57275>>>>>>>    
57275>>>>>>>    
57275>>>>>>>    
57275>>>>>>>    
57275>>>>>>>    
57275>>>>>>>    
57275>>>>>>>    //AB-StoreEnd
57275>>>>>>>
57275>>>>>>>End_Object    // btnordh
57276>>>>>>>
57276>>>>>>>//AB/ End_Object    // prj
57276>>>>>
57276>>>>>//DDB-Selection-pkg-End
57276>>>>>//DDB-FileEnd
57276>>>Use BtnOrdD.DD
57276>>>Use Mhxanik.DD
57276>>>Use Constrct.dd
57276>>>Use Salesmen.dd
57276>>>Use sysrecc.dd
INCLUDING FILE: SYSRECC.DD
57276>>>>>//DDB-FileStart
57276>>>>>//DDB-HeaderStart
57276>>>>>
57276>>>>>// File Name : SYSRECC.DD
57276>>>>>// Class Name: Sysrecc_DataDictionary
57276>>>>>// Revision  : 42
57276>>>>>// Version   : 2
57276>>>>>
57276>>>>>Use  Windows           // Basic Definitions
57276>>>>>Use  DataDict          // DataDictionary Class Definition
57276>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57276>>>>>
57276>>>>>Open Sysrecc
57278>>>>>
57278>>>>>//DDB-HeaderEnd
57278>>>>>
57278>>>>>Class Sysrecc_DataDictionary  is a DataDictionary
57279>>>>>
57279>>>>>    // Define_Fields:
57279>>>>>    // This procedure is used to set up all data-dictionary rules.
57279>>>>>
57279>>>>>    Procedure Define_Fields
57280>>>>>        Forward Send Define_Fields
57282>>>>>        //DDB-Generated-Code-Location
57282>>>>>        //DDB-DefineFieldStart
57282>>>>>
57282>>>>>        Set Main_File            To Sysrecc.File_Number
57283>>>>>
57283>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57284>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57285>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57286>>>>>
57286>>>>>        // Field-based properties.......................
57286>>>>>
57286>>>>>        // Sysrecc.Ctypkin_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Cflagkin_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Client_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Cmoves_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Copen_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Cmhnes_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Chmnies_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Custprom_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Cn_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Constr_Clients
57286>>>>>
57286>>>>>        // Sysrecc.Hmgio_Code
57286>>>>>
57286>>>>>        // Sysrecc.Payresp_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Salesmen_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Constrct_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Drivers_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Mhxanik_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Brzone_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Cnzone_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Tpclient_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Tperga_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Tparticl_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Tppresp_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Tpbranch_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Orders_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Ordersd_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Clorder_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Clorderd_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Ordersc_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Ordersdc_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Clorderc_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Clorderdc_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Yclients_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Aa_Ypoprosf
57286>>>>>
57286>>>>>        // Sysrecc.Btnemp_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Btnordh_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Dorderh_Rec0
57286>>>>>
57286>>>>>        // Sysrecc.Dorderd_Rec0
57286>>>>>
57286>>>>>        //DDB-DefineFieldEnd
57286>>>>>    End_Procedure    // Define_Fields
57287>>>>>
57287>>>>>    // Field_Defaults:
57287>>>>>    // This procedure is used to establish default field values.
57287>>>>>
57287>>>>>    Procedure Field_Defaults
57288>>>>>        Forward Send Field_Defaults
57290>>>>>        //DDB-Generated-Code-Location
57290>>>>>        //DDB-FieldDefaultStart
57290>>>>>        //DDB-FieldDefaultEnd
57290>>>>>    End_Procedure    // Field_Defaults
57291>>>>>
57291>>>>>End_Class    // Sysrecc_DataDictionary
57292>>>>>//DDB-FileEnd
57292>>>
57292>>>//Use bp2ndCop.dg
57292>>>//Use bpACopen.dg
57292>>>
57292>>>
57292>>>//AB-StoreTopEnd
57292>>>
57292>>>//AB-IgnoreStart
57292>>>
57292>>>Use dbView.Sub
57292>>>Use Button.Sub
57292>>>
57292>>>//AB-IgnoreEnd
57292>>>
57292>>>ACTIVATE_VIEW Activate_EnCMVCN FOR EnCMVCN
57296>>>
57296>>>Object EnCMVCN is a dbViewSub
57298>>>
57298>>>    //AB-StoreTopStart
57298>>>    
57298>>>    Open SysCurXR
57300>>>    Open Year
57302>>>    Open Clients
57304>>>    Open Cn
57306>>>    Open Cmoves
57308>>>    
57308>>>    
57308>>>    //AB-StoreTopEnd
57308>>>
57308>>>    Set Label to "„¤ž£â¨à©ž ‰ ¤ã©œà¤ £œ «¦ §¨é«¦ › ˜Ÿâ© £¦ „¨š¦ (‚ ˜ ŽŠ€ «˜ “§¦¡˜«˜©«ã£˜«˜)"
57309>>>    Set Size to 94 458
57310>>>    Set Location to 9 7
57311>>>
57311>>>    //AB-DDOStart
57311>>>
57311>>>
57311>>>    //AB-DDOEnd
57311>>>
57311>>>    Object ButtonSub1 is a ButtonSub
57313>>>
57313>>>        //AB-StoreTopStart
57313>>>        
57313>>>        //AB-StoreTopEnd
57313>>>
57313>>>        Set Label to "„§œ¥œ¨š˜©å˜"
57314>>>        Set Size to 14 415
57315>>>        Set Location to 37 19
57316>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57317>>>
57317>>>        //AB-StoreStart
57317>>>        
57317>>>        Procedure OnClick
57319>>>            String  sFile sFile2 sLabel sMess sFileName CmRecr CnRecr
57320>>>            Integer iFileExists iCheckAfm iCount isFound iRecnum
57320>>>            Date ddate
57320>>>            Get label To slabel
57321>>>            Set Enabled_State To False
57322>>>            Move "C:\#Xoris_Erga.txt" to sFileName
57323>>>            Move 0 to iCount
57324>>>            Move "" to sMess
57325>>>
57325>>>            Get Get_File_Exists sFileName To iFileExists
57326>>>            If (iFileExists) EraseFile sFileName 
57329>>>
57329>>>            Open Branch
57331>>>            Move SyscurXR.Company_Code to Branch.Company_Code
57332>>>            Find GE Branch By Index.1
57333>>>>
57333>>>            While ((Found) And (SyscurXR.Company_Code=Branch.Company_Code))
57337>>>                //----
57337>>>        
57337>>>                Clear Cmoves
57338>>>                Find GE Cmoves By Index.11 // CN_Recr+Cmoves_Recr
57339>>>>
57339>>>                While ((Found) And (Cmoves.CN_Recr=""))
57343>>>        
57343>>>                    Move Cmoves.Cmoves_Recr to CmRecr
57344>>>                    Move (Trim(CmRecr)+" - "+Trim(Cmoves.Client_ID)+"   "+String(Cmoves.Cmoves_Hmnia)) to sMess
57345>>>                    Move (Trim(sMess)) to sMess
57346>>>                    Set Label to sMess
57347>>>        
57347>>>                    Clear CN
57348>>>                    Move Cmoves.Client_ID   to CN.Client_ID
57349>>>                    Find GE Cn By Index.4
57350>>>>
57350>>>                    If ((Found) And (Cmoves.Client_ID=CN.Client_ID)) Begin
57352>>>                        Reread Cmoves
57356>>>                        Move CN.CN_Code     to Cmoves.CN_Code
57357>>>                        Move CN.CN_Recr     to Cmoves.CN_Recr
57358>>>                        Saverecord Cmoves
57359>>>                        Unlock
57360>>>>
57360>>>                        Clear Cmoves
57361>>>                        Move ""     to Cmoves.CN_Recr
57362>>>                        Move CmRecr to Cmoves.Cmoves_Recr
57363>>>                    End
57363>>>>
57363>>>                    Else Begin
57364>>>                        Add 1 to iCount
57365>>>                        Append_Output Channel 7 sFileName
57367>>>                        Write   Channel 7 '“§¦¡˜«˜©«ž£˜='
57369>>>                        Write   Channel 7 (trim(Branch.Branch_Code))
57371>>>                        Write   Channel 7 "    œ¢á«žª="
57373>>>                        Write   Channel 7 (trim(Cmoves.Client_ID))
57375>>>                        Write   Channel 7 "    †£œ¨/¤å˜="
57377>>>                        Write   Channel 7 (String(Cmoves.Cmoves_Hmnia))
57379>>>                        Write   Channel 7 "    Recr="
57381>>>                        Write   Channel 7 (String(Cmoves.Cmoves_Recr))
57383>>>                        Writeln Channel 7
57385>>>                        Close_Output Channel 7
57387>>>                    End
57387>>>>
57387>>>                    Find GT Cmoves By Index.11 // CN_Recr+Cmoves_Recr
57388>>>>
57388>>>                Loop
57389>>>>
57389>>>        
57389>>>                //----
57389>>>                Find GT Branch By Index.1
57390>>>>
57390>>>            Loop
57391>>>>
57391>>>        
57391>>>            Set Label Of ButtonSub1 To sLabel
57392>>>            Set Enabled_State To True
57393>>>        
57393>>>            String sMess2
57393>>>            Move "’¦ ˜¨®œå¦ £œ æ¤¦£˜ #Xoris_Erga.txt ©«¦ C ©˜ª\n§œ¨ â®œ  «¦¬ª §œ¢á«œª ˜¬«¦çª" to sMess2
57394>>>        
57394>>>            If (iCount>0) Begin
57396>>>                Move "" to sMess
57397>>>                Move ("¨âŸž¡˜¤ "+String(iCount)+" ˜¡æ£˜ ¡ ¤ã©œ ª £œ §œ¢á«œª ®à¨åª â¨š¦") to sMess
57398>>>                Send Info_Box sMess  "¨¦©¦®ã"
57399>>>                Send Info_Box sMess2 "¨¦©¦®ã"
57400>>>            End
57400>>>>
57400>>>            Else Begin
57401>>>                Send Info_Box "î¢œª ¦  ¡ ¤ã©œ ª ®à¨åª â¨š¦ œ¤ž£œ¨éŸž¡˜¤ œ§ «¬®éª" "¢ž¨¦­¦¨å˜"
57402>>>            End
57402>>>>
57402>>>        End_Procedure // OnClick
57403>>>        
57403>>>        
57403>>>        
57403>>>        //AB-StoreEnd
57403>>>
57403>>>    End_Object    // ButtonSub1
57404>>>
57404>>>
57404>>>    //AB-StoreStart
57404>>>    
57404>>>    
57404>>>    Procedure Activate_View Returns Integer
57406>>>        Integer rVal
57407>>>        Forward Get Msg_Activate_View to rVal
57409>>>    
57409>>>        Procedure_Return rVal
57410>>>    End_Procedure
57411>>>    
57411>>>    //AB-StoreEnd
57411>>>
57411>>>End_Object    // EnCMVCN
57412>>>
57412>>>
57412>>>//AB-StoreStart
57412>>>                            
57412>>>                            
57412>>>                            
57412>>>//AB-StoreEnd
57412>>>
57412>>>//AB/ End_Object    // prj
57412>
57412>        //AB-ClientStoreStart
57412>        
57412>        if (wait(self)) send deactivate to (wait(self))
57415>        
57415>        
57415>        
57415>        
57415>        
57415>        
57415>        
57415>        
57415>        
57415>        //AB-ClientStoreEnd
57415>
57415>
57415>    End_Object  // Client_Area
57416>    
57416>    On_Key Key_Ctrl+Key_1 Send Activate_EnCMVCN To Client_Area
57417>    
57417>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
57417>>>// 07/23/96 JJT - New Class names
57417>>>// Very prototype global status bar
57417>>>//
57417>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
57417>>>>>// 07/23/96 JJT - New Class names
57417>>>>>Use dfAstbar.pkg
57417>>>>>
57417>>>>>Class StatusBar is a AppStatusBar
57418>>>>>
57418>>>>>    Procedure Construct_Object
57419>>>>>       Forward Send Construct_Object
57421>>>>>       //
57421>>>>>       Send Add_Item 350  ''     // micro-help
57422>>>>>       Send Add_Item  40  'View:'
57423>>>>>       Set Item_Display_Style To sbNORMAL
57424>>>>>       Send Add_Item 200  ''     // view name
57425>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
57426>>>>>       Set Item_Display_Style To sbNORMAL
57427>>>>>    End_Procedure // Construct_Object
57428>>>>>
57428>>>>>    Procedure Show_View_Name String sName
57429>>>>>        Set Value item 2 to sName
57430>>>>>    End_Procedure
57431>>>>>
57431>>>>>End_Class
57432>>>
57432>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
57435>>>
57435>>>Object oStatusBarSub  is a StatusBar
57437>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
57437>>>    
57437>>>    Property Integer piStdPanes Public (PaneCount(Self))
57439>>>    
57439>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
57439>>>    Set PaneWidth item 1 to 50
57440>>>    
57440>>>    Send AddPane 55  ""        sbLOWERED
57441>>>    Send AddPane 70  ""        sbLOWERED
57442>>>    Send AddPane 55  ""        sbLOWERED
57443>>>    
57443>>>    Procedure pTimer
57445>>>        String lsDay lsHour lsHH lsMM lsSS
57446>>>        Integer liStdPanes lbState
57446>>>    
57446>>>        Get piStdPanes to liStdPanes
57447>>>        Sysdate lsDay lsHH lsMM lsSS
57451>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
57455>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
57459>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
57463>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
57464>>>        Get Simple_state to lbState
57465>>>        If  Not (lbState) Begin
57467>>>            Set Value Item liStdPanes     to lsHour
57468>>>            Set Value Item (liStdPanes+1) to lsDay
57469>>>        End
57469>>>>
57469>>>    
57469>>>    End_Procedure // pTimer
57470>>>    
57470>>>    
57470>>>    Object oTimerObj Is A DFTimer
57472>>>        Set Timeout to 1000
57473>>>        Set Timer_Active_State to TRUE
57474>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
57475>>>        Set Timer_Message to pTimer
57476>>>    End_Object // oTimerOdj
57477>>>End_Object // oStatusBar
57478>>>
57478>>>
57478>
57478>    //AB-PanelStoreStart
57478>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
57478>>>//************************************************************************
57478>>>// Confidential Trade Secret.
57478>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
57478>>>// as an unpublished work.  All rights reserved.
57478>>>// DataFlex is a registered trademark of Data Access Corporation.
57478>>>//
57478>>>//************************************************************************
57478>>>//************************************************************************
57478>>>//
57478>>>// $File name  : StdAbout.pkg
57478>>>// $File title : Standard about object package for VDF
57478>>>// Notice      :
57478>>>// $Author(s)  : John Tuohy
57478>>>//
57478>>>// $Rev History
57478>>>//
57478>>>// JT 06/27/97   File created
57478>>>//************************************************************************
57478>>>
57478>>>// This provides a quick and simple way to create an about package for a program.
57478>>>// You need to create a message inside you client area called Activate_About.
57478>>>// Within this message you should send the message DoAbout passing needed
57478>>>// string information.
57478>>>//
57478>>>//       Procedure Activate_About
57478>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
57478>>>//       End_Procedure
57478>>>//    where: sTitle =     Name of application. If none provided, uses caption
57478>>>//                        bar title
57478>>>//           sVersion   = Version Line. If none provided, will be blank
57478>>>//           sCopyRight = Copyright Line. If none provided, will be blank
57478>>>//           sAuthor    = Author name, blank if none provided
57478>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
57478>>>//                        is used.
57478>>>// It is expected that you will place this in your own object package. For
57478>>>// example an order about package may look like this:
57478>>>//
57478>>>//   // OrderAbout.pkg
57478>>>//   Use StdAbout.pkg
57478>>>//   Procedure Activate_About
57478>>>//      Local String sTitle sCopyright sVersion sAuthor
57478>>>//      Move "My Order Entry System" to sTitle
57478>>>//      Move "Version 2.1" to sVersion
57478>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
57478>>>//      Move "John Smith"  to sAuthor
57478>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
57478>>>//   end_procedure
57478>>>//   // end of file.
57478>>>
57478>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
57478>>>>>//************************************************************************
57478>>>>>// Confidential Trade Secret.
57478>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
57478>>>>>// as an unpublished work.  All rights reserved.
57478>>>>>// DataFlex is a registered trademark of Data Access Corporation.
57478>>>>>//
57478>>>>>//************************************************************************
57478>>>>>//************************************************************************
57478>>>>>//
57478>>>>>// $File name  : DfAbout.pkg
57478>>>>>// $File title : About class support
57478>>>>>// Notice      :
57478>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
57478>>>>>//
57478>>>>>// $Rev History
57478>>>>>//
57478>>>>>// JJT 11/5/98    Added version information
57478>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
57478>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
57478>>>>>//                workspace package.
57478>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
57478>>>>>//                class can create this object.
57478>>>>>//                Cleaned up the interface (used correct classes and messages)
57478>>>>>//                Added workspace reporting support to sys-info.
57478>>>>>//                Turned off wrapping in the sys-info editor.
57478>>>>>// KR  ??/??/96   File created
57478>>>>>//************************************************************************
57478>>>>>Use windows.pkg
57478>>>>>Use DFbitmap.pkg
57478>>>>>
57478>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
57479>>>>>
57479>>>>>//****************************************************************************
57479>>>>>// $Module type: FUNCTION
57479>>>>>// $Module name: Network_User_Name
57479>>>>>// $Author     : AK/VOO/KCR
57479>>>>>// Created     : 24-09-96 @ 19:17
57479>>>>>//
57479>>>>>// Description
57479>>>>>//    This function reads the current username of windows and returns that
57479>>>>>//    name or an text unknown user
57479>>>>>//
57479>>>>>// $Rev History
57479>>>>>//    24-09-96  Module header created
57479>>>>>//****************************************************************************
57479>>>>>Function Network_User_Name Returns String
57481>>>>>    Local String sName sLength
57482>>>>>    Local Pointer lpName_Addr lpLength_Addr
57482>>>>>    Local Integer iRetval
57482>>>>>
57482>>>>>    Movestr (Repeat (Character (0), 255)) To sName
57483>>>>>>
57483>>>>>    GetAddress Of sName To lpName_Addr
57484>>>>>    Movestr (DwordToBytes (255)) To sLength
57485>>>>>>
57485>>>>>    GetAddress Of sLength To lpLength_Addr
57486>>>>>
57486>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
57487>>>>>>
57487>>>>>
57487>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
57490>>>>>    Else Function_Return "User Unknown"
57492>>>>>End_Function // Network_User_Name
57493>>>>>
57493>>>>>Type MEMORYSTATUS
57493>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
57493>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
57493>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
57493>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
57493>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
57493>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
57493>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
57493>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
57493>>>>>End_Type // MEMORYSTATUS
57493>>>>>
57493>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
57494>>>>>
57494>>>>>// If a global workspace object exists it will use this variable to store
57494>>>>>// its object id.
57494>>>>>
57494>>>>>Class SysinfoDisplay Is An Edit
57495>>>>>    Procedure Construct_Object
57496>>>>>        forward send construct_object
57498>>>>>
57498>>>>>        Set Location To 6 6
57499>>>>>        Set Size To 110 255
57500>>>>>        Set Read_Only_State To True
57501>>>>>        Set wrap_state to False
57502>>>>>    end_Procedure
57503>>>>>
57503>>>>>    //****************************************************************************
57503>>>>>    // $Module type: PROCEDURE
57503>>>>>    // $Module name: Add_Line
57503>>>>>    // $Author     : VOO
57503>>>>>    // Created     : 06-10-96 @ 15:23
57503>>>>>    //
57503>>>>>    // Description
57503>>>>>    //    This method will add a line to this edit object, it should go simpler
57503>>>>>    //    but it seems to be done this way.
57503>>>>>    //
57503>>>>>    // $Rev History
57503>>>>>    //    06-10-96  Module header created
57503>>>>>    //****************************************************************************
57503>>>>>    Procedure Add_Line String sVal
57504>>>>>        Local Integer iLine
57505>>>>>
57505>>>>>        Moveint (Line_Count (Current_Object)) To iLine
57506>>>>>>
57506>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
57509>>>>>        Set Value Item iLine To sVal
57510>>>>>    End_Procedure // Add_Line
57511>>>>>
57511>>>>>    //****************************************************************************
57511>>>>>    // $Module type: PROCEDURE
57511>>>>>    // $Module name: Show_Current_Directory
57511>>>>>    // $Author     : VOO
57511>>>>>    // Created     : 06-10-96 @ 15:24
57511>>>>>    //
57511>>>>>    // Description
57511>>>>>    //    This method will show the name of the current directory in the system
57511>>>>>    //    information box
57511>>>>>    //
57511>>>>>    // $Rev History
57511>>>>>    //    06-10-96  Module header created
57511>>>>>    //****************************************************************************
57511>>>>>    Procedure Show_Current_Directory
57512>>>>>        Local String sDir
57513>>>>>
57513>>>>>        Get_Current_Directory To sDir
57514>>>>>        Send Add_Line ("Current Directory: " + sDir)
57515>>>>>    End_Procedure // Show_Current_Directory
57516>>>>>
57516>>>>>    Procedure Show_Windows_Directory
57517>>>>>        Local String sWindir
57518>>>>>
57518>>>>>        Get_Windows_Directory To sWindir
57519>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
57520>>>>>    End_Procedure // Show_Windows_Directory
57521>>>>>
57521>>>>>    Procedure Show_Current_User
57522>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
57523>>>>>    End_Procedure // Show_Current_User
57524>>>>>
57524>>>>>    Procedure Show_Number_Format
57525>>>>>        Local Integer iFormat
57526>>>>>
57526>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
57529>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
57530>>>>>        Get_Number_Format To iFormat
57531>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
57532>>>>>    End_Procedure // Show_Number_Format
57533>>>>>
57533>>>>>    Procedure Show_Filelist_Name
57534>>>>>        Local String sFilename
57535>>>>>
57535>>>>>        Get_Attribute Df_Filelist_Name To sFilename
57538>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
57539>>>>>    End_Procedure // Show_Filelist_Name
57540>>>>>
57540>>>>>    Procedure Show_Lock_Delay
57541>>>>>        Local Integer iLockdelay
57542>>>>>
57542>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
57545>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
57546>>>>>    End_Procedure // Show_Lock_Delay
57547>>>>>
57547>>>>>    Procedure Show_Lock_Timeout
57548>>>>>        Local Integer iLockTimeout
57549>>>>>
57549>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
57552>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
57553>>>>>    End_Procedure // Show_Lock_Timeout
57554>>>>>
57554>>>>>    Procedure Show_Screen_Size
57555>>>>>        Local Integer iYscreensize iXscreensize
57556>>>>>
57556>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
57557>>>>>>
57557>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
57558>>>>>>
57558>>>>>
57558>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
57559>>>>>    End_Procedure // Show_Screen_Size
57560>>>>>
57560>>>>>    Procedure Show_Page_Size
57561>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
57562>>>>>    End_procedure
57563>>>>>
57563>>>>>    Procedure Show_Date
57564>>>>>        Local Date dToday
57565>>>>>
57565>>>>>        Sysdate4 dToday
57566>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
57567>>>>>    End_procedure // Show_Date
57568>>>>>
57568>>>>>    Procedure Show_Date_Format
57569>>>>>        Local Integer iDateFormat
57570>>>>>        Local String sDateFormat
57570>>>>>
57570>>>>>        Get_Attribute Df_Date_Format To iDateFormat
57573>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
57576>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
57580>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
57584>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
57586>>>>>        Send Add_Line ("Date Format: " * sDateformat)
57587>>>>>    End_Procedure // Show_Date_Format
57588>>>>>
57588>>>>>    Procedure Show_Memavail
57589>>>>>        Local Integer iMem
57590>>>>>
57590>>>>>        Memory iMem
57591>>>>>>
57591>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
57592>>>>>    End_Procedure // Show_Memavail
57593>>>>>
57593>>>>>    Procedure Show_Systemresources
57594>>>>>        Local String sMemoryStatus
57595>>>>>        Local Pointer lpsMemoryStatus
57595>>>>>        Local Integer iVoid
57595>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
57595>>>>>
57595>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
57596>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
57597>>>>>
57597>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
57598>>>>>>
57598>>>>>
57598>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
57599>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
57600>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
57601>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
57602>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
57603>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
57604>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
57605>>>>>
57605>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
57606>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
57607>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
57608>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
57609>>>>>    End_Procedure // Show_Systemresources
57610>>>>>
57610>>>>>    Procedure Show_Registration
57611>>>>>        Local String sRegName
57612>>>>>        Local Integer iSN
57612>>>>>        Registration sRegName iSN
57613>>>>>>
57613>>>>>
57613>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
57614>>>>>        Send Add_Line ("Reg Name: " + sRegName)
57615>>>>>
57615>>>>>    End_Procedure // Show_Current_Directory
57616>>>>>
57616>>>>>
57616>>>>>
57616>>>>>    //****************************************************************************
57616>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
57616>>>>>    // to the workspace object passing the an object and message to send back
57616>>>>>    // to this object. It is expected that the workspace object will send this
57616>>>>>    // message for every line of information it wants displayed (passing the
57616>>>>>    // information to be displayed
57616>>>>>    //****************************************************************************
57616>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
57616>>>>>    Procedure Show_WorkspaceInformation
57617>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
57620>>>>>    End_Procedure
57621>>>>>
57621>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
57622>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
57623>>>>>    End_Function
57624>>>>>
57624>>>>>    Procedure Show_Versions
57625>>>>>        local integer iVersion iRevision iBuild
57626>>>>>        Version_information iVersion iRevision iBuild
57628>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
57629>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
57630>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
57631>>>>>    End_Procedure
57632>>>>>
57632>>>>>
57632>>>>>    //***
57632>>>>>    //*** BW
57632>>>>>    //*** Procedure: Show_Drivers
57632>>>>>    //*** Purpose  : Show loaed database drivers
57632>>>>>    //***
57632>>>>>
57632>>>>>    Procedure Show_Drivers
57633>>>>>        Local String  Current_drvr
57634>>>>>        Local String  Loadeddrvrs
57634>>>>>        Local Integer Number_of_drvrs
57634>>>>>        Local Integer Count
57634>>>>>
57634>>>>>        Move "" To Loadeddrvrs
57635>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
57638>>>>>        For Count From 1 To Number_of_drvrs
57644>>>>>>
57644>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
57647>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
57650>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
57651>>>>>        Loop
57652>>>>>>
57652>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
57653>>>>>    End_Procedure // Show_Drivers
57654>>>>>
57654>>>>>    //****************************************************************************
57654>>>>>    // $Module type: PROCEDURE
57654>>>>>    // $Module name: Add_Focus
57654>>>>>    // $Author     : VOO
57654>>>>>    // Created     : 24-09-96 @ 19:43
57654>>>>>    //
57654>>>>>    // Description
57654>>>>>    //    During activation we will remove the old information and add the newly
57654>>>>>    //    found systeminformation
57654>>>>>    //
57654>>>>>    // $Rev History
57654>>>>>    //    24-09-96  Module header created
57654>>>>>    //****************************************************************************
57654>>>>>    Procedure Add_Focus Integer hoRoot
57655>>>>>        Forward Send Add_Focus hoRoot
57657>>>>>
57657>>>>>        Send Delete_Data
57658>>>>>        Set Changed_State To False
57659>>>>>        Set Read_Only_State To True
57660>>>>>        Send Show_WorkSpaceInformation // added to show WS info
57661>>>>>        SEnd Show_Drivers
57662>>>>>        Send Show_Current_User
57663>>>>>        Send Show_Windows_Directory
57664>>>>>        Send Show_Current_Directory
57665>>>>>        Send Show_Filelist_Name
57666>>>>>        Send Show_Versions
57667>>>>>        Send Show_Memavail
57668>>>>>        Send Show_Screen_Size
57669>>>>>        Send Show_Page_Size
57670>>>>>        Send Show_Number_Format
57671>>>>>        Send Show_Date_Format
57672>>>>>        Send Show_Lock_Delay
57673>>>>>        Send Show_Lock_Timeout
57674>>>>>        Send Show_Date
57675>>>>>        Send Show_Systemresources
57676>>>>>        Send Show_Registration
57677>>>>>    End_Procedure // Show_All_Info
57678>>>>>
57678>>>>>End_Class // SysinfoDisplay
57679>>>>>
57679>>>>>
57679>>>>>//****************************************************************************
57679>>>>>// $Module type: OBJECT
57679>>>>>// $Module name: Sysinfo_Dialog
57679>>>>>// $Author     : VOO
57679>>>>>// Created     : 24-09-96 @ 18:47
57679>>>>>//
57679>>>>>// Description
57679>>>>>//    This object shows the systeminformation on the screen
57679>>>>>//
57679>>>>>// $Rev History
57679>>>>>//    24-09-96  Module header created
57679>>>>>//****************************************************************************
57679>>>>>Class SysInfoDialog Is A ModalPanel
57680>>>>>    Procedure Construct_Object
57681>>>>>        forward send construct_object
57683>>>>>
57683>>>>>        Set Caption_Bar To True
57684>>>>>        Set Sysmenu_Icon To True
57685>>>>>        Set Label To "System Information"
57686>>>>>        Set Size To 152 270
57687>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
57688>>>>>        Set Minimize_Icon To False
57689>>>>>        Set Maximize_Icon To False
57690>>>>>        Set Border_Style To Border_Dialog
57691>>>>>
57691>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
57693>>>>>        End_Object
57694>>>>>
57694>>>>>        Object Close_Button Is A Button
57696>>>>>            Set Label to "&Close"
57697>>>>>            Set Location To 120 212
57698>>>>>            Set Message item 0 to msg_Close_Panel
57699>>>>>            Set default_action_button to current_object
57700>>>>>        End_Object // Close_Button
57701>>>>>
57701>>>>>        On_Key Kcancel       Send Close_Panel
57702>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
57703>>>>>    End_procedure
57704>>>>>
57704>>>>>End_Class // SysinfoDialog
57705>>>>>
57705>>>>>// Purpose:
57705>>>>>//
57705>>>>>// Ken Ross 12/17/96 5:16PM
57705>>>>>//
57705>>>>>Class AboutDialog Is A ModalPanel
57706>>>>>
57706>>>>>    Procedure construct_object
57707>>>>>        String sVdfRootDir
57708>>>>>        forward send construct_object
57710>>>>>        Set Label to "About..."
57711>>>>>        Set Size to 100 217
57712>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
57713>>>>>
57713>>>>>        Object SysInfo_Dialog is a SysInfoDialog
57715>>>>>        End_Object
57716>>>>>
57716>>>>>        Object oBox is a Container3d
57718>>>>>            Set Border_Style to Border_StaticEdge
57719>>>>>            Set Size to 63 202
57720>>>>>            Set Location to 4 5
57721>>>>>
57721>>>>>            Object AboutGraphic is a BitmapContainer
57723>>>>>                Set Border_Style to Border_None
57724>>>>>                Set Bitmap_Style to Bitmap_Center
57725>>>>>                Set Size to 48 48
57726>>>>>                Set Location to 7 2
57727>>>>>            End_Object    // AboutGraphic
57728>>>>>
57728>>>>>            Object ProductName is a TextBox
57730>>>>>                Set label to "ProductName"
57731>>>>>                Set Size to 10 45
57732>>>>>                Set Location to 8 53
57733>>>>>            End_Object    // ProductName
57734>>>>>
57734>>>>>            Object Version is a TextBox
57736>>>>>                Set label to "Version"
57737>>>>>                Set Size to 10 25
57738>>>>>                Set Location to 21 53
57739>>>>>            End_Object    // Version
57740>>>>>
57740>>>>>            Object Copyright is a TextBox
57742>>>>>                Set label to "Copyright"
57743>>>>>                Set Size to 10 31
57744>>>>>                Set Location to 34 53
57745>>>>>            End_Object    // Copyright
57746>>>>>
57746>>>>>            Object Author is a TextBox
57748>>>>>                Set label to "Author"
57749>>>>>                Set Size to 10 22
57750>>>>>                Set Location to 46 53
57751>>>>>            End_Object    // Author
57752>>>>>
57752>>>>>        End_Object    // oBox
57753>>>>>
57753>>>>>        Object OK_bn is a Button
57755>>>>>            On_Item "&OK" Send Close_Panel
57756>>>>>            Set Size to 14 50
57757>>>>>            Set Location to 71 157
57758>>>>>        End_Object    // OK_bn
57759>>>>>
57759>>>>>        Object SysInfo_bn is a Button
57761>>>>>            On_Item "&System Info" Send Show_Sysinfo
57762>>>>>            Set Size to 14 50
57763>>>>>            Set Location to 71 101
57764>>>>>        End_Object    // SysInfo_bn
57765>>>>>
57765>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
57766>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
57767>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
57768>>>>>
57768>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
57771>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
57772>>>>>
57772>>>>>    End_Procedure
57773>>>>>
57773>>>>>    Procedure set productname string sval
57774>>>>>        set label of (productname(oBox(current_object))) to sval
57775>>>>>    End_Procedure
57776>>>>>
57776>>>>>    Procedure set version string sval
57777>>>>>        set label of (version(oBox(current_object))) to sval
57778>>>>>    End_Procedure
57779>>>>>
57779>>>>>    Procedure set copyright string sval
57780>>>>>        set label of (copyright(oBox(current_object))) to sval
57781>>>>>    End_Procedure
57782>>>>>
57782>>>>>    Procedure set author string sval
57783>>>>>        set label of (author(oBox(current_object))) to sval
57784>>>>>    End_Procedure
57785>>>>>
57785>>>>>    // square bitmaps of 42x42 work best
57785>>>>>    //
57785>>>>>    Procedure set logo string sval
57786>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
57787>>>>>    End_Procedure
57788>>>>>
57788>>>>>    Procedure Show_Sysinfo
57789>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
57790>>>>>    End_Procedure // Show_Sysinfo
57791>>>>>
57791>>>>>End_Class
57792>>>>>
57792>>>>>
57792>>>>>//Object About_Dialog is an AboutDialog
57792>>>>>//    set productname to "Visual DataFlex"
57792>>>>>//    set version to "version 4.0"
57792>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
57792>>>>>//    set author to ""
57792>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
57792>>>>>//End_Object
57792>>>>>
57792>>>>>//Procedure Activate_About
57792>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
57792>>>>>//End_Procedure
57792>>>
57792>>>// *************************************************************************
57792>>>//  Public message. This is the default message. It is expected that you will
57792>>>//   create your own message to override this
57792>>>// *************************************************************************
57792>>>
57792>>>Procedure Activate_About
57794>>>   Send DoAbout "" "" "" "" "" ""
57795>>>End_Procedure
57796>>>
57796>>>// *************************************************************************
57796>>>//  Public message. It is expected that you will send this message (most
57796>>>//  likely from Activate_About. This creates an about object, activates it
57796>>>//  and destroys it when done. It is not exepected that you will augment this.
57796>>>// *************************************************************************
57796>>>
57796>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
57798>>>        Local integer hoObj hoMain
57799>>>
57799>>>        // create object
57799>>>        Object About is an AboutDialog
57801>>>            // if no title passed use the label of the main panel
57801>>>            // (if a main panel exists).
57801>>>            if sTitle     eq '' Begin
57803>>>                Get Main_Window to hoMain
57804>>>                if hoMain Get Label of hoMain to sTitle
57807>>>            end
57807>>>>
57807>>>            set productname to sTitle
57808>>>            set version     to sVersion
57809>>>            set copyright   to sCopyRight
57810>>>            set author      to sAuthor
57811>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
57814>>>            Move Current_Object to hoObj // object Id
57815>>>        End_Object
57816>>>        Send Popup to hoObj    // popup the about object
57817>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
57818>>>End_procedure
57819>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
57819>>>Use Tooltip.pkg
57819>>>
57819>>>object StandardToolTip is a StandardToolTip000
57821>>>    move (current_object) to DefaultTooltipHintID
57822>>>end_object
57823>>>
57823>>>object ToolTipTimer is a ToolTipTimer000
57825>>>    move (current_object) to TooltipControllerID
57826>>>end_object
57827>    
57827>    
57827>    
57827>    
57827>    //AB-PanelStoreEnd
57827>
57827>
57827>End_Object
57828>
57828>
57828>//AB-StoreStart
57828>
57828>set bitmap of (client_area(main(self))) to "protem1.bmp"
57829>Send DoStoreFileModeInfo to ghoFileModeInfo
57830>
57830>Start_UI
57831>
57831>
57831>
57831>
57831>//AB-StoreEnd
57831>
57831>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 29291
Total Resources: 0
Total Commands : 57830
Total Windows  : 52
Total Pages    : 12
Static Data    : 405166
Message area   : 332159
Total Blocks   : 18796
