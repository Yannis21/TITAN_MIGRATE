Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\initpasswords.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30333>
30333>Register_Object Client_Area
30333>
30333>//AB-StoreTopStart
30333>Use Workspc.pkg
30333>
30333>//  Set date attributes as needed
30333>Set_Date_Attribute sysdate4_State to (TRUE)
30334>Set_Date_Attribute Date4_State    to (TRUE)
30335>Set_Date_Attribute epoch_value    to 30
30336>
30336>Object ProgramWorkspace is a WorkspaceSub
30338>    Set WorkspaceName to CURRENT$WORKSPACE
30339>    Set kEnter_Next_State to True
30340>//    Set ModuleName    to 'ProgramName' // Special module name.
30340>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30340>End_Object
30341>
30341>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30341>>>// Help_ids.inc
30341>>>//
30341>>>// Context ids for the order entry system. This uses
30341>>>// help file ordentry.hlp.
30341>>>//
30341>>>// This is a sample version. YOU must supply
30341>>>// the ID values
30341>>>
30341>>>//  Generic Context Ids
30341>>>//
30341>>>
30341>>>// It is expected that file-names ids will be the same as their
30341>>>// filenumber.
30341>>>
30341>>>
30341>>>//  View and selection-list specific context ids
30341>>>//
30341>>>//..........add view, object, selection-list ids here....
30341>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30341>>>// STD_HELP.PKG
30341>>>//
30341>>>// Global Help Object
30341>>>//
30341>>>//  Creates all Help Support required to access WINDOWs help system
30341>>>//  with DataFlex. Creates a global object named Help_Object.
30341>>>//
30341>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30341>>>
30341>>>use DFHlpSys // Context Sensitive Help Support
30341>>>
30341>>>
30341>>>// This file needs to be provided by the developer. It will contain
30341>>>// symbolic replacements for the ID integer values used to access the
30341>>>// the windows help file's topics.
30341>>>//
30341>>>use Help_ids.inc
30341>>>
30341>>>// If the following are not defined in help_ids.inc,
30341>>>//  create default 0 values for them
30341>>>Define GeneralHelpId    for    0
30341>>>Define KeysHelpId       for    0
30341>>>Define FileHelpId       for    0
30341>>>Define ErrorHelpId      for    0  // probably not used in VDF
30341>>>Define IndexHelpId      for    0  // probably not used in VDF
30341>>>
30341>>>object Help_Object is a HelpSystem // global help object
30343>>>
30343>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30344>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30345>>>   Set Help_Id_Keys    to KeysHelpId       //
30346>>>   Set Help_Id_Files   to FileHelpId       //
30347>>>   Set Help_Id_Errors  to ErrorHelpId      //
30348>>>
30348>>>end_object
30349>
30349>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30349>>>Use CrystalReport.pkg
30349>>>
30349>>>Define PE_SUBREPORT_NAME_LEN       for 128
30349>>>
30349>>>Type PESubreportInfo
30349>>>  Field PESubreportInfo.structSize as Word
30349>>>  Field PESubreportInfo.name       as Char PE_SUBREPORT_NAME_LEN
30349>>>  Field PESubreportInfo.NLinks     as Short
30349>>>  Field PESubreportInfo.IsOnDemand as Short
30349>>>End_Type // PESubreportInfo
30349>>>
30349>>>
30349>>>External_Function PEGetNSections "PEGetNSections" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30350>>>
30350>>>External_Function PEGetSectionCode "PEGetSectionCode" CRPE32.DLL ;  Integer printJob ;  Integer sectionN ;  Returns Integer
30351>>>
30351>>>External_Function PECloseSubreport "PECloseSubreport" CRPE32.DLL ;  Integer printJob ;  Returns Integer
30352>>>
30352>>>External_Function PEGetNSubreportsInSection "PEGetNSubreportsInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Returns Integer
30353>>>
30353>>>External_Function PEGetNthSubreportInSection "PEGetNthSubreportInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Integer subreportN ;  Returns Integer
30354>>>
30354>>>External_Function PEGetSubreportInfo "PEGetSubreportInfo" CRPE32.DLL ;  Integer printJob ;  Integer subreportHandle ;  Pointer subreportInfo ;  Returns Integer
30355>>>
30355>>>External_Function PEOpenSubreport "PEOpenSubreport" CRPE32.DLL ;  Integer parentJob ;  Pointer subreportName ;  Returns Integer
30356>>>
30356>>>
30356>>>Type PEWindowOptions
30356>>>  Field PEWindowOptions.StructSize As Word
30356>>>  Field PEWindowOptions.hasGroupTree As Word
30356>>>  Field PEWindowOptions.canDrillDown As Word
30356>>>  Field PEWindowOptions.hasNavigationControls As Word
30356>>>  Field PEWindowOptions.hasCancelButton As Word
30356>>>  Field PEWindowOptions.hasPrintButton As Word
30356>>>  Field PEWindowOptions.hasExportButton As Word
30356>>>  Field PEWindowOptions.hasZoomControl As Word
30356>>>  Field PEWindowOptions.hasCloseButton As Word
30356>>>  Field PEWindowOptions.hasProgressControls As Word
30356>>>  Field PEWindowOptions.hasSearchButton As Word
30356>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30356>>>  Field PEWindowOptions.hasRefreshButton As Word
30356>>>End_Type // PEWindowOptions
30356>>>
30356>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30357>>>
30357>>>Class CrystalReportSubSQL Is A CrystalReport
30358>>>
30358>>>    Procedure Construct_Object
30359>>>        Forward send Construct_Object
30361>>>        // Everything on except hasGroupTree by default
30361>>>        property integer hasGroupTree 0
30362>>>        property integer canDrillDown 1
30363>>>        property integer hasNavigationControls 1
30364>>>        property integer hasCancelButton 1
30365>>>        property integer hasPrintButton 1
30366>>>        property integer hasExportButton 1
30367>>>        property integer hasZoomControl 1
30368>>>        property integer hasCloseButton 1
30369>>>        property integer hasProgressControls 1
30370>>>        property integer hasSearchButton 1
30371>>>        property integer hasPrintSetupButton 1
30372>>>        property integer hasRefreshButton 1
30373>>>
30373>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30374>>>    End_Procedure // Construct_Object
30375>>>
30375>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30376>>>        Integer iPrintJob iResult
30377>>>        String sPEWindowOptions
30377>>>        Pointer pPeWindowOptions
30377>>>
30377>>>        Get PrintJob To iPrintJob
30378>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30379>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30380>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30381>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30382>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30383>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30384>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30385>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30386>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30387>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30388>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30389>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30390>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30391>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30392>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30393>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30394>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30396>>>    End_Procedure // OutputToWindow
30397>>>
30397>>>    Procedure Set TmpFileDir String aDir
30398>>>        String lsCurrWspc lsDir
30399>>>
30399>>>//        If (ghoWorkSpace <> 0) Begin
30399>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30399>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30399>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30399>>>//            Set Report_Data_Path to lsDir
30399>>>//        End
30399>>>    End_Procedure
30400>>>
30400>>>    Procedure DoWinQLReport
30401>>>        // This can be used when reports must be able to run in different data directories
30401>>>        Set TmpFileDir to "TmpFileDir"
30402>>>        Forward Send DoWinQLReport
30404>>>    End_Procedure
30405>>>
30405>>>
30405>>>  Function NSections Returns Integer
30406>>>    Integer iPrintJob iResult
30407>>>
30407>>>    Get PrintJob To iPrintJob
30408>>>    Move (PEGetNSections(iPrintJob)) To iResult
30409>>>    Move (Low(iResult)) To iResult
30410>>>    Function_Return iResult
30411>>>  End_Function // NSections
30412>>>
30412>>>  Function SectionCode Integer iSectionN Returns Integer
30413>>>    Integer iPrintJob iResult
30414>>>
30414>>>    Get PrintJob To iPrintJob
30415>>>    Move (PEGetSectionCode(iPrintJob,iSectionN)) To iResult
30416>>>    Move (Low(iResult)) To iResult
30417>>>    Function_Return iResult
30418>>>  End_Function // SectionCode
30419>>>
30419>>>  Function CloseSubreport Integer iSubreport Returns Integer
30420>>>    Integer iResult
30421>>>
30421>>>    Move (PECloseSubreport(iSubreport)) To iResult
30422>>>    Function_Return iResult
30423>>>  End_Function // CloseSubreport
30424>>>
30424>>>  Function NSubreportsInSection Integer iSectionCode Returns Integer
30425>>>    Integer iPrintJob iResult
30426>>>
30426>>>    Get PrintJob To iPrintJob
30427>>>    Move (PEGetNSubreportsInSection(iPrintJob,iSectionCode)) To iResult
30428>>>    Move (Low(iResult)) To iResult
30429>>>    Function_Return iResult
30430>>>  End_Function // nSubreportsInSection
30431>>>
30431>>>  Function NthSubreportInSection Integer iSectionCode Integer iSubreportN Returns Integer
30432>>>    Integer iPrintJob iResult
30433>>>
30433>>>    Get PrintJob To iPrintJob
30434>>>    Move (PEGetNthSubreportInSection(iPrintJob,iSectionCode,iSubreportN)) To iResult
30435>>>    Function_Return iResult
30436>>>  End_Function // NthSubreportInSection
30437>>>
30437>>>  Function SubreportName Integer iSubreportHandle Returns String
30438>>>    String sPESubreportInfo sResult
30439>>>    Pointer pPESubreportInfo
30439>>>    Integer iPrintJob iResult
30439>>>
30439>>>    ZeroType PESubreportInfo To sPESubreportInfo
30440>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30441>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30442>>>
30442>>>    Get PrintJob To iPrintJob
30443>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30444>>>    If iResult GetBuff_String From sPESubreportInfo at PESubreportInfo.name To sResult
30447>>>    Function_Return (ToOEM(sResult))
30448>>>  End_Function // SubreportName
30449>>>
30449>>>  Function SubreportNLinks Integer iSubreportHandle Returns Integer
30450>>>    String sPESubreportInfo
30451>>>    Pointer pPESubreportInfo
30451>>>    Integer iPrintJob iResult
30451>>>
30451>>>    ZeroType PESubreportInfo To sPESubreportInfo
30452>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30453>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30454>>>
30454>>>    Get PrintJob To iPrintJob
30455>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30456>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.NLinks To iResult
30459>>>    Function_Return iResult
30460>>>  End_Function // SubreportNLinks
30461>>>
30461>>>  Function SubreportIsOnDemand Integer iSubreportHandle Returns Integer
30462>>>    String sPESubreportInfo
30463>>>    Pointer pPESubreportInfo
30463>>>    Integer iPrintJob iResult
30463>>>
30463>>>    ZeroType PESubreportInfo To sPESubreportInfo
30464>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
30465>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
30466>>>
30466>>>    Get PrintJob To iPrintJob
30467>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
30468>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.IsOnDemand To iResult
30471>>>    Function_Return iResult
30472>>>  End_Function // SubreportIsOnDemand
30473>>>
30473>>>  Function OpenSubReport String sSubreport Returns Integer
30474>>>    Integer iPrintJob iResult
30475>>>    Pointer pSubreport
30475>>>
30475>>>    Get PrintJob To iPrintJob
30476>>>    GetAddress Of sSubreport To pSubreport
30477>>>    Move (PEOpenSubreport(iPrintJob,pSubreport)) To iResult
30478>>>    Move (Low(iResult)) To iResult
30479>>>    Function_Return iResult
30480>>>  End_Function // OpenSubReport
30481>>>
30481>>>  Function NTablesInSubreport Integer iSubreportHandle Returns Integer
30482>>>    Local Integer iResult
30483>>>
30483>>>    Move (PEGetNTables(iSubreportHandle)) To iResult
30484>>>    Move (Low(iResult)) To iResult
30485>>>    Function_Return iResult
30486>>>  End_Function // NTablesInSubreport
30487>>>
30487>>>  Function NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN Returns String
30488>>>    Local String sPETableLocation sReturn
30489>>>    Local Pointer pPETableLocation
30489>>>    Local Integer iResult
30489>>>
30489>>>    FillType PETableLocation With 0 To sPETableLocation
30490>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30491>>>    GetAddress Of sPETableLocation To pPETableLocation
30492>>>    Move (PEGetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30493>>>    If iResult GetBuff_String From sPETableLocation At PETableLocation.Location To sReturn
30496>>>    Function_Return (ToOEM(sReturn))
30497>>>  End_Function // NthTableLocationInSubreport
30498>>>
30498>>>  Procedure Set NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN String sLocation
30499>>>    Local String sPETableLocation
30500>>>    Local Pointer pPETableLocation
30500>>>    Local Integer iResult
30500>>>
30500>>>    Move (ToANSI(sLocation+Character(0))) To sLocation
30501>>>    FillType PETableLocation With 0 To sPETableLocation
30502>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
30503>>>    Put_String sLocation To sPETableLocation At PETableLocation.Location
30504>>>    GetAddress Of sPETableLocation To pPETableLocation
30505>>>    Move (PESetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
30506>>>  End_Procedure // Set NthTableLocationInSubreport
30507>>>
30507>>>
30507>>>    // This hook procedure is called after the print job has been opened.
30507>>>
30507>>>    Procedure OnInitializeReport
30508>>>
30508>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30508>>>
30508>>>        Integer iTables iMax iCount iType
30509>>>        String  sLocation sLocation2 sPath DirSep sPassw
30509>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30509>>>
30509>>>        Integer lnSections lnSubreports lnTables iPrintJob iPath
30509>>>        Integer iSection iCode iSubreport iTable iNumPaths bExists
30509>>>        Handle hSubreport
30509>>>        String sTable sSubreport sTempFilePath sSApassw
30509>>>        Boolean bCheckforTempfile bTemp
30509>>>
30509>>>
30509>>>
30509>>>        Forward Send OnInitializeReport
30511>>>
30511>>>
30511>>>        Open Company
INCLUDING FILE: COMPANY.FD
30513>>>        Open Syscurxr
INCLUDING FILE: SYSCURXR.FD
30515>>>
30515>>>        Clear Company
30516>>>        Move SyscurXr.Company_Code to Company.Company_Code
30517>>>        Find Eq Company By Index.1
30518>>>>
30518>>>
30518>>>
30518>>>        If ((Found) And (Company.Company_C_CodeR='')) Procedure_Return
30521>>>
30521>>>        Move (Trim(COMPANY.COMPANY_EMAIL)) to sSApassw
30522>>>
30522>>>
30522>>>        String  sActualSQL
30522>>>        String  sActualTemp
30522>>>        String  sOldSQL
30522>>>        String  sOldTemp
30522>>>        String  sServerName
30522>>>        String  sDatabaseName
30522>>>        String  sUserID
30522>>>
30522>>>        //Move Company.Company_C_CodeR    to sServerName          // ODBC sto 1o pedio
30522>>>        //Move Company.Company_C_CodER    to sActualSQL           // Database sto 2o pedio
30522>>>        //Move Company.Company_C_CodER    to sDatabaseName        // Database sto 2o pedio
30522>>>
30522>>>        Move 'SMS'              to sOldSQL
30523>>>        Move 'C:\Dns_tmp\'      to sOldTemp
30524>>>
30524>>>
30524>>>        Move 'C:\Dns_tmp\'      to sActualTemp
30525>>>
30525>>>        Move (Trim(sActualSQL   )) to sActualSQL
30526>>>        Move (Trim(sActualTemp  )) to sActualTemp
30527>>>        Move (Trim(sOldSQL      )) to sOldSQL
30528>>>        Move (Trim(sOldTemp     )) to sOldTemp
30529>>>        Move (Trim(sServerName  )) to sServerName
30530>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30531>>>        Move (Trim(sUserID      )) to sUserID
30532>>>
30532>>>
30532>>>
30532>>>        Move "SMSNT"    to sServerName
30533>>>        Move "SMS"      to sDatabaseName
30534>>>        Move "SMS"      to sActualSQL
30535>>>
30535>>>        Move "sa"       to sUserID
30536>>>        //////////  06/09/2011   Move "123"      to sPassw
30536>>>        Move sSApassw   to sPassw
30537>>>
30537>>>        Send LogOnServer "SQL_DRV" sServerName sDatabaseName sUserID sPassw
30538>>>
30538>>>
30538>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30539>>>
30539>>>        Get NTables To iMax
30540>>>        Decrement iMax
30541>>>        Get Report_Data_Path                                    To sPath
30542>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30545>>>        For iCount From 0 To iMax
30551>>>>
30551>>>            Get NthTableLocation iCount         To sLocation
30552>>>            Get Report_Base_File_Name sLocation To sLocation2
30553>>>            Get NthTableDBType           iCount to iType
30554>>>
30554>>>            // An einai type 1 topiko
30554>>>            //               2=SQL
30554>>>            If (iType=2) Begin
30556>>>                If (sLocation contains sOldSQL) Begin
30558>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30559>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30560>>>                End
30560>>>>
30560>>>            End
30560>>>>
30560>>>            Else If (iType=1) Begin
30563>>>                If (sLocation contains sOldTemp) Begin
30565>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30566>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30567>>>                End
30567>>>>
30567>>>            End
30567>>>>
30567>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30568>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30569>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30570>>>
30570>>>            // 2011
30570>>>            Set nthTableLogOnPassword       iCount to sPassw       0
30571>>>            // 2011
30571>>>
30571>>>
30571>>>        Loop // For iCount From 0 To iMax
30572>>>>
30572>>>
30572>>>        // Set the location of the tables for the subreports
30572>>>        Get NSections To lnSections
30573>>>        For iSection From 0 To (lnSections-1)
30579>>>>
30579>>>            Get SectionCode iSection To iCode
30580>>>            Get NSubreportsInSection iCode To lnSubreports
30581>>>            For iSubreport From 0 To (lnSubreports-1)
30587>>>>
30587>>>                Get NthSubreportInSection iCode iSubreport To hSubreport
30588>>>                Get SubreportName hSubreport To sSubreport
30589>>>                Get OpenSubreport sSubreport To iPrintJob
30590>>>                Get NTablesInSubreport iPrintJob To lnTables
30591>>>                For iTable From 0 To (lnTables-1)
30597>>>>
30597>>>                    Get NthTableLocationInSubreport iPrintJob iTable To sTable
30598>>>                    If (sTable contains sOldSQL) Begin
30600>>>                            Move '' to sLocation
30601>>>                            Move (Replace(sOldSQL,sTable,sActualSQL)) to sLocation
30602>>>                            Set NthTableLocationInSubreport iPrintJob iTable To (Trim(sLocation))
30603>>>                            Set nthTableLogOnServerName     iTable to sServerName     0
30604>>>                            Set nthTableLogOnDataBaseName   iTable to sDatabaseName   0
30605>>>                            Set nthTableLogOnUserID         iTable to sUserID         0 // 'sa'     0
30606>>>                                // 2011
30606>>>                                Set nthTableLogOnPassword       iTable to sPassw   0
30607>>>                                // 2011
30607>>>                    End
30607>>>>
30607>>>                Loop // For iTable From 0 To nTables
30608>>>>
30608>>>            Loop // For iSubreport From 0 To nSubreports
30609>>>>
30609>>>        Loop // For iSection From 0 To (iSections-1)
30610>>>>
30610>>>
30610>>>    End_Procedure // OnInitializeReport
30611>>>
30611>>>
30611>>>    // This hook procedure is called just before a print job is closed.
30611>>>    Procedure OnDeInitializeReport
30612>>>        Forward Send OnDEInitializeReport
30614>>>    End_Procedure // OnDeInitializeReport
30615>>>
30615>>>    // This hook procedure is called just before a the print job is started.
30615>>>    Procedure OnStartPrinting
30616>>>        Forward Send OnStartPrinting
30618>>>    End_Procedure // OnStartPrinting
30619>>>
30619>>>    // This hook procedure is called just after a print job has finished.
30619>>>    Procedure OnStopPrinting
30620>>>        Forward Send OnStopPrinting
30622>>>    End_Procedure // OnStopPrinting
30623>>>End_Class // CrystalReportSubSQL
30624>>>
30624>Integer giWait_Obj
30624>string sXrhs sKodi sDeCryptoPassw
30624>String gsMyStr
30624>//-----
30624>
30624>Open Sysrec
INCLUDING FILE: SYSREC.FD
30626>Open Users
INCLUDING FILE: USERS.FD
30628>
30628>// General Functions-Procedures and Variables
30628>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30628>>>
30628>>>        String  gs_Selected_Company_Code
30628>>>        String  gs_Selected_Branch_Code
30628>>>        Integer gi_Selected_Year
30628>>>        String gs_Selected_Year_Recr
30628>>>        String  gs_Module_Code
30628>>>
30628>>>
30628>>>//Open Currency
30628>>>//Function CurrDigits Global String asCurr Returns Integer
30628>>>//    Integer liDecX
30628>>>//    Clear Currency
30628>>>//    move asCurr to Currency.Currency_C_Code
30628>>>//    Find Eq Currency By Index.1
30628>>>//    move Currency.Currency_Dec to liDecX
30628>>>//    Function_Return liDecX
30628>>>//End_Function // CurrDigits
30628>>>
30628>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30630>>>Open SysCurXr
30632>>>
30632>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30633>>>    Move (Trim(asNomisma)) to asNomisma
30634>>>    Clear Nomisma
30635>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30638>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30640>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30641>>>>
30641>>>    Function_Return Nomisma.Dekadika
30642>>>End_Function //
30643>>>
30643>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30644>>>    String rVal
30645>>>    Integer iLength iInt
30645>>>    Move aiCode to rVal
30646>>>    Move (trim(rVal)) to rVal
30647>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30653>>>>
30653>>>        Move (Insert('0',rVal,1)) to rVal
30654>>>    Loop
30655>>>>
30655>>>    Function_Return rVal
30656>>>End_Function
30657>>>
30657>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30658>>>    String rVal
30659>>>    Integer iLength iInt ipos
30659>>>    Move aiCode to rVal
30660>>>    Move (trim(rVal)) to rVal
30661>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30662>>>    For iInt From 1 to ipos
30668>>>>
30668>>>        Move (Insert('0',rVal,1)) to rVal
30669>>>    Loop
30670>>>>
30670>>>    Function_Return rVal
30671>>>End_Function
30672>>>
30672>>>
30672>>>Open Year
INCLUDING FILE: YEAR.FD
30674>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30675>>>    Send aiMsg to Self
30676>>>End_Procedure
30677>>>
30677>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30678>>>    Integer liChanged
30679>>>
30679>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30682>>>    If (Not(Current_Record(aiYearDD))) Begin
30684>>>        Get Should_Save of aiPanel to liChanged
30685>>>        Send Clear to aiYearDD
30686>>>        Move gs_Selected_Company_Code to Year.Company_Code
30687>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30688>>>        Move gi_Selected_Year         to Year.Year_Year
30689>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30690>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30693>>>    End
30693>>>>
30693>>>End_Procedure
30694>>>
30694>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30695>>>    Integer liSrvr
30696>>>    String  lsCurrentYearRecr
30696>>>
30696>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30698>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30700>>>    End
30700>>>>
30700>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30701>>>    Get Server of aiPanel to liSrvr
30702>>>    // Respects Default values
30702>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30707>>>End_Procedure
30708>>>
30708>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30708>>>//                                                          Holds the current year rec0
30708>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30708>>>
30708>>>
30708>>>Function fiRefindYear Global Returns Integer
30709>>>    Clear Year
30710>>>    Move gs_Selected_Company_Code to Year.Company_Code
30711>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30712>>>    Move gi_Selected_Year         to Year.Year_Year
30713>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30714>>>>
30714>>>    Function_Return (Found = 0)
30715>>>End_Function //fiRefindYear
30716>>>
30716>>>Procedure DoRunApplication for Baseclass String sAppName
30717>>>    string sRuntime  lsStr
30718>>>
30718>>>    Append lsStr 'C:\Dns.bat ' sAppName
30720>>>    RunProgram Wait  lsStr
30721>>>
30721>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30721>>>//    append sRuntime "\dfrun " sAppName
30721>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30723>>>    runprogram background sRuntime
30724>>>End_procedure // DoRunApplication
30725>>>
30725>>>// Run the Editor
30725>>>Procedure DoRunEditor for Baseclass String asFile
30726>>>    string sRunPath lsWspcName
30727>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30728>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30731>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30731>>>    Move (Replace('.',asFile,'')) to asFile
30732>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30733>>>    send DoRunApplication sRunPath
30734>>>End_Procedure // DoRunEditor
30735>>>
30735>>>//--------------------------------------
30735>>>
30735>>>//start of global functions and procedures
30735>>>
30735>>>
30735>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30735>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30736>>>         String  lsTemp_Code1 lsTemp_Code2
30737>>>         Integer liCounter
30737>>>
30737>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30737>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30738>>>
30738>>>         //2.˜¤« ©«¨¦­ã
30738>>>         For liCounter From 1 to (Length(lsCode))
30744>>>>
30744>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30745>>>         Loop
30746>>>>
30746>>>
30746>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30746>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30747>>>
30747>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30747>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30748>>>
30748>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30748>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30754>>>>
30754>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30755>>>         Loop
30756>>>>
30756>>>
30756>>>         Function_Return (Trim(lsTemp_Code2))
30757>>>End_Function //gsffind_previous
30758>>>
30758>>>
30758>>>Function gifSystem_Check Returns Integer
30759>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30760>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30760>>>//       Clear Company
30760>>>//       Find Gt Company.Recnum
30760>>>//       While (Found = 1)
30760>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30760>>>//             Add Company.Company_NumGarticl to liS_Garticls
30760>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30760>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30760>>>//             Add Company.Company_NumGplan   to liS_GPlans
30760>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30760>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30760>>>//             Find Gt Company.Recnum
30760>>>//       Loop
30760>>>//
30760>>>//       Get_Attribute {attribute} [of {file-handle} ;
30760>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30760>>>//                        To {variable}
30760>>>//
30760>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30760>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30760>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30760>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30760>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30760>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30760>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30760>>>//
30760>>>
30760>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30760>>>
30760>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30760>>>
30760>>>    Function_Return 0
30761>>>End_Function //gifSystem_Check
30762>>>
30762>>>/////////////////////////////////////////////////////////////////
30762>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30762>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30763>>>
30763>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30764>>>    Integer liInt liInteger iTimes iStart
30764>>>    Number  lnDecimals
30764>>>
30764>>>    Move (Integer(anValue))                                         to liInteger
30765>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30766>>>
30766>>>    Move liInteger              to lsAkeraios
30767>>>    Move lnDecimals             to lsDekadika
30768>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30769>>>    Move (Trim(lsDekadika))     to lsDekadika
30770>>>
30770>>>    Move (Length(lsAkeraios)) to iStart
30771>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30777>>>>
30777>>>        Insert "0" in lsAkeraios at 1
30779>>>    Loop
30780>>>>
30780>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30781>>>
30781>>>    Move (Length(lsDekadika)) to iStart
30782>>>    For iTimes From iStart to (aiLengthDekadika-1)
30788>>>>
30788>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30789>>>    Loop
30790>>>>
30790>>>    Move (Trim(lsDekadika)) to lsDekadika
30791>>>
30791>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30794>>>    Move '' to lsRetVal
30795>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30796>>>    Function_Return lsRetval
30797>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30798>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30798>>>
30798>>>Open Codemast
30800>>>
30800>>>
30800>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30801>>>         Clear Codemast
30802>>>         Move lsType  to Codemast.Type
30803>>>         Move lsValue to Codemast.Code
30804>>>         Find Eq Codemast by Index.1 //type+code
30805>>>>
30805>>>         Function_Return Codemast.Description
30806>>>End_Function //code_mast
30807>>>
30807>>>
30807>>>Open Branch
INCLUDING FILE: BRANCH.FD
30809>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30810>>>    String rVal
30811>>>    Integer iInt
30811>>>    Clear Branch
30812>>>    Move asCompany  to Branch.Company_Code
30813>>>    Move asBranch   to Branch.Branch_Code
30814>>>    Find Eq Branch by Index.1
30815>>>>
30815>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30818>>>    Move (Trim(asCompany))  to asCompany
30819>>>    Move (Trim(asBranch))   to asBranch
30820>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30824>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30828>>>    Move ''                                           to rVal
30829>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30830>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30831>>>    Move (Trim(rVal))                                 to rVal
30832>>>    Function_Return rVal
30833>>>End_Function
30834>>>
30834>>>Function fsgStripCodeFromID Global String asID Returns Integer
30835>>>      Integer iLen iPos iInt
30836>>>      If (Trim(asID)='') Function_Return 0
30839>>>      Move (Trim  (asID)) to asID
30840>>>      Move (Length(asID)) to iLen
30841>>>      For iInt From 1     to iLen
30847>>>>
30847>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30850>>>      Loop
30851>>>>
30851>>>      Function_Return (Right(asID,(iLen-iPos)))
30852>>>End_Function
30853>>>
30853>>>Function fsCityDescr Global Integer aiCityID Returns String
30854>>>    String rVal
30855>>>    Open Cities
INCLUDING FILE: CITIES.FD
30857>>>    Clear Cities
30858>>>    Move aiCityID to Cities.City_ID
30859>>>    Find Eq Cities By Index.1
30860>>>>
30860>>>    If (Found=1) Move Cities.City_descr to rVal
30863>>>    Else         Move '' to rVal
30865>>>    Function_Return rVal
30866>>>End_Function
30867>>>
30867>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30868>>>    Open Cities
30870>>>    Clear Cities
30871>>>    Move aiCityID to Cities.City_ID
30872>>>    Find Eq Cities By Index.1
30873>>>>
30873>>>    Function_Return Cities.Town_ID
30874>>>End_Function
30875>>>
30875>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30876>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30878>>>    Clear Towns
30879>>>    Move aiTownID to Towns.Town_ID
30880>>>    Find Eq Towns By Index.1
30881>>>>
30881>>>    Function_Return Towns.Country_ID
30882>>>End_Function
30883>>>
30883>>>Function fsTownDescr Global Integer aiTownID Returns String
30884>>>    String rVal
30885>>>    Open Towns
30887>>>    Clear Towns
30888>>>    Move aiTownID to Towns.Town_ID
30889>>>    Find Eq Towns By Index.1
30890>>>>
30890>>>    If (Found=1) Move Towns.Town_descr to rVal
30893>>>    Else         Move '' to rVal
30895>>>    Function_Return rVal
30896>>>End_Function
30897>>>
30897>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30898>>>    String rVal
30899>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30901>>>    Clear Country
30902>>>    Move aiCountryID to Country.Country_ID
30903>>>    Find Eq Country By Index.1
30904>>>>
30904>>>    If (Found=1) Move Country.Country_descr to rVal
30907>>>    Else         Move '' to rVal
30909>>>    Function_Return rVal
30910>>>End_Function
30911>>>
30911>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30912>>>    String rVal
30913>>>    Open Areas
INCLUDING FILE: AREAS.FD
30915>>>    Clear Areas
30916>>>    Move aiAreaID to Areas.Area_ID
30917>>>    Find Eq Areas By Index.1
30918>>>>
30918>>>    If (Found=1) Move Areas.Area_descr to rVal
30921>>>    Else         Move '' to rVal
30923>>>    Function_Return rVal
30924>>>End_Function
30925>>>
30925>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30926>>>    Local String rVal lsTmp lsOO lsLL
30927>>>    Local Number lnOO lnLL
30927>>>
30927>>>    Move '' to lsOO
30928>>>    Move '' to lsLL
30929>>>    Move '' to rVal
30930>>>
30930>>>    Move (Integer(anTime))                              to lnOO
30931>>>
30931>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30932>>>
30932>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30935>>>    Else         Move (String(lnOO))                    to lsOO
30937>>>    Move (Trim(lsOO))                                   to lsOO
30938>>>
30938>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30941>>>    Else         Move (String(lnLL))                    to lsLL
30943>>>    Move (Trim(lsLL))                                   to lsLL
30944>>>
30944>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30945>>>
30945>>>    Move (Trim(rVal)) to rVal
30946>>>
30946>>>    Function_Return rVal
30947>>>End_Function
30948>>>
30948>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30949>>>    Local Number rVal nOres nLepta
30950>>>    Move (Integer(aiMinutes/60))    to nOres
30951>>>    Move (    Mod(aiMinutes,60))    to nLepta
30952>>>    Move (nOres+(nLepta/100))       to rVal
30953>>>    Function_Return rVal
30954>>>End_Function
30955>>>
30955>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30956>>>    Local Integer rVal
30957>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30958>>>    Function_Return rVal
30959>>>End_Function
30960>>>
30960>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30961>>>    Local Integer rVal iMinStart iMinEnd
30962>>>
30962>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30965>>>
30965>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30966>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30967>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30968>>>    Function_Return rVal
30969>>>End_Function
30970>>>
30970>>>
30970>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30971>>>    Local Integer iTmp
30972>>>    Local Number  rVal
30972>>>
30972>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30975>>>
30975>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30976>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30977>>>    Function_Return rVal
30978>>>End_Function
30979>>>
30979>>>
30979>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30981>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30983>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30985>>>
30985>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30986>>>  Integer iExodos
30987>>>  Number nPoso nPct
30987>>>  Move 0 to nPoso
30988>>>  Move 0 to nPct
30989>>>  Move 0 to iExodos
30990>>>
30990>>>  Move (Trim(asItemCode)) to asItemCode
30991>>>  Move (Trim(asPromCode)) to asPromCode
30992>>>
30992>>>  // 1.Anazhthsh sto arxeio Witemcld
30992>>>  Clear Witemcld
30993>>>  Move asItemCode to Witemcld.Item_Code
30994>>>  Move asPromCode to Witemcld.Client_Code
30995>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30996>>>>
30996>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
31000>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
31002>>>          Move 1 to iExodos
31003>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
31006>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
31010>>>      End
31010>>>>
31010>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31011>>>>
31011>>>  Loop
31012>>>>
31012>>>  If (iExodos) Begin
31014>>>      If (nPoso) Function_Return nPoso
31017>>>      Else Function_Return nPct
31019>>>  End
31019>>>>
31019>>>
31019>>>  // 2.Anazhthsh sto arxeio Witemcl
31019>>>  Clear WitemCL
31020>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
31021>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
31022>>>  Find Eq WitemCL By Index.1
31023>>>>
31023>>>  If (Found=1) Function_Return WitemCL.Client_Price
31026>>>
31026>>>  Function_Return 0
31027>>>End_Function
31028>>>
31028>>>
31028>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
31030>>>
31030>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
31031>>>
31031>>>  Integer iExodos iCheckDeop
31032>>>  Number nPoso nPct
31032>>>
31032>>>  Move (Num_Arguments=7) to iCheckDeop
31033>>>
31033>>>  Move 0 to nPoso
31034>>>  Move 0 to nPct
31035>>>  Move 0 to iExodos
31036>>>
31036>>>  Move (Trim(asItemCode))                 to asItemCode
31037>>>  Move (Trim(asClientID))                 to asClientID
31038>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
31039>>>  Move (Trim(asWitemxCode))               to asWitemxCode
31040>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
31043>>>
31043>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
31043>>>  If (iCheckDeop) Begin
31045>>>      Clear btnordd
31046>>>      Move asClientID   to btnordd.vclient_id
31047>>>      Move asCNCode     to btnordd.vcn_code
31048>>>      Move asWitemxCode to btnordd.vitem
31049>>>      Move 0            to btnordd.vactive
31050>>>      Move adHmnia      to btnordd.arxh_date
31051>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
31052>>>>
31052>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
31054>>>          move btnordd.vprice to nPoso
31055>>>          If (nPoso) Function_Return nPoso
31058>>>      End
31058>>>>
31058>>>  End
31058>>>>
31058>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
31058>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
31058>>> // Clear Witemcld
31058>>> // Move asItemCode to Witemcld.Item_Code
31058>>> // Move asClientID to Witemcld.Client_Code
31058>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31058>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
31058>>> //                      (Witemcld.Client_Code= asClientID) And ;
31058>>> //                      (iExodos=0))
31058>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
31058>>> //         Move 1 to iExodos
31058>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
31058>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
31058>>> //     End
31058>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
31058>>> // Loop
31058>>> // If (iExodos) Begin
31058>>> //     If (nPoso) Function_Return nPoso
31058>>> //     Else Function_Return nPct
31058>>> // End
31058>>>
31058>>>
31058>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
31058>>>  //Clear Witemxt
31058>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
31058>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
31058>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
31058>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
31058>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
31058>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
31058>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
31058>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
31058>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
31058>>>  //                     (iExodos=0))
31058>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
31058>>>  //        Move 1 to iExodos
31058>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
31058>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
31058>>>  //    End
31058>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
31058>>>  //Loop
31058>>>  //If (iExodos) Begin
31058>>>  //    If (nPoso) Function_Return nPoso
31058>>>  //    Else Function_Return nPct
31058>>>  //End
31058>>>
31058>>>
31058>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
31058>>>  //Clear WitemCL
31058>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
31058>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
31058>>>  //Find Eq WitemCL By Index.1
31058>>>  //If (Found=1) Function_Return WitemCL.Client_Price
31058>>>
31058>>>  Function_Return 0
31059>>>End_Function
31060>>>
31060>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
31061>>>    String sEnter
31062>>>    Move '' to sEnter
31063>>>    Move (Trim(asStr)) to asStr
31064>>>    Append sEnter (Character(13)) (Character(10))
31066>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
31067>>>    Function_return (Trim(asStr))
31068>>>End_function
31069>>>
31069>>>
31069>>>//end   of global functions and procedures
31069>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
31069>>>>>USE AllEntSc
31069>>>>>
31069>>>>>//AB-IgnoreEnd
31069>>>>>
31069>>>>>
31069>>>>>//AB-IgnoreEnd
31069>>>>>
31069>>>>>Object Wait is a ModalPanelSub
31071>>>>>
31071>>>>>    //AB-StoreTopStart
31071>>>>>
31071>>>>>    // How to Use It
31071>>>>>    // Get the maximum position of the bar
31071>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
31071>>>>>    //
31071>>>>>    // Set the maximum position of the bar
31071>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
31071>>>>>    //
31071>>>>>    // Start Bar Progress from beginning
31071>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31071>>>>>    //
31071>>>>>    // End Bar Progress
31071>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
31071>>>>>    //
31071>>>>>    // Update Bar Progress
31071>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
31071>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
31071>>>>>    // When you want the update to be done for every i (this is slower)
31071>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
31071>>>>>    //
31071>>>>>    // Display Buttons on the object
31071>>>>>    // Set Button_State of (Wait(Self)) to False/True
31071>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
31071>>>>>    //
31071>>>>>    // Initialization of the Progress Bar
31071>>>>>    // Send Popup to (Wait(Self))
31071>>>>>    //
31071>>>>>    // Deactivation of the Progress Bar
31071>>>>>    // Send Deactivate to (Wait(Self))
31071>>>>>    //
31071>>>>>    // Message during the process
31071>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
31071>>>>>    //
31071>>>>>    // Extra Info for button "Info >>"
31071>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
31071>>>>>    // If sFile<>'' then reads the contents of the file
31071>>>>>    // Else Fills the Edit with the string of sDetail
31071>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
31071>>>>>    //
31071>>>>>    // Remarks instead of Progress Bar
31071>>>>>    // Set Button_State of (Wait(Self))     to False
31071>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
31071>>>>>    // Update During Process
31071>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
31071>>>>>
31071>>>>>    //AB-StoreTopEnd
31071>>>>>
31071>>>>>    Set Exit_Application_Local_State to FALSE
31072>>>>>    Set Modal_State to FALSE
31073>>>>>    Set Popup_State to TRUE
31074>>>>>    Set Border_Style to Border_Thick
31075>>>>>    Set Minimize_Icon to FALSE
31076>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31077>>>>>    Set Size to 138 256
31078>>>>>
31078>>>>>    //AB-DDOStart
31078>>>>>
31078>>>>>
31078>>>>>    //AB-DDOEnd
31078>>>>>
31078>>>>>    Object WaitBar is a ProgressBarSub
31080>>>>>
31080>>>>>        //AB-StoreTopStart
31080>>>>>
31080>>>>>        //AB-StoreTopEnd
31080>>>>>
31080>>>>>        Set Size to 21 243
31081>>>>>        Set Location to 7 4
31082>>>>>
31082>>>>>        //AB-StoreStart
31082>>>>>        Send DoRegSize  self smTopRight
31083>>>>>        //AB-StoreEnd
31083>>>>>
31083>>>>>    End_Object
31084>>>>>
31084>>>>>    Object WaitText is a TextBoxSub
31086>>>>>
31086>>>>>        //AB-StoreTopStart
31086>>>>>
31086>>>>>        //AB-StoreTopEnd
31086>>>>>
31086>>>>>        Set Enabled_State to TRUE
31087>>>>>        Set Label to "Processing"
31088>>>>>        Set FontSize to 4 0
31089>>>>>        Set Size to 10 81
31090>>>>>        Set Location to 36 5
31091>>>>>
31091>>>>>        //AB-StoreStart
31091>>>>>
31091>>>>>        //AB-StoreEnd
31091>>>>>
31091>>>>>    End_Object
31092>>>>>
31092>>>>>    Object bnCancel is a ButtonSub
31094>>>>>
31094>>>>>        //AB-StoreTopStart
31094>>>>>
31094>>>>>        //AB-StoreTopEnd
31094>>>>>
31094>>>>>        Set Default_State to TRUE
31095>>>>>        Set Label to "OK"
31096>>>>>        Set Location to 34 143
31097>>>>>
31097>>>>>        //AB-StoreStart
31097>>>>>
31097>>>>>        Procedure OnClick
31099>>>>>             Send Deactivate to (Wait(Self))
31100>>>>>        End_Procedure
31101>>>>>
31101>>>>>        Send DoRegAlign self amTopRight
31102>>>>>        //AB-StoreEnd
31102>>>>>
31102>>>>>    End_Object
31103>>>>>
31103>>>>>    Object bnDetail is a ButtonSub
31105>>>>>
31105>>>>>        //AB-StoreTopStart
31105>>>>>
31105>>>>>        //AB-StoreTopEnd
31105>>>>>
31105>>>>>        Set Focus_Mode to Pointer_Only
31106>>>>>        Set Label to "Info >>"
31107>>>>>        Set Location to 34 197
31108>>>>>
31108>>>>>        //AB-StoreStart
31108>>>>>
31108>>>>>        Procedure OnClick
31110>>>>>            Delegate Send Show_Details False
31112>>>>>        End_Procedure
31113>>>>>
31113>>>>>        Send DoRegAlign self amTopRight
31114>>>>>        //AB-StoreEnd
31114>>>>>
31114>>>>>    End_Object
31115>>>>>
31115>>>>>    Object LineControlSub1 is a LineControlSub
31117>>>>>
31117>>>>>        //AB-StoreTopStart
31117>>>>>
31117>>>>>        //AB-StoreTopEnd
31117>>>>>
31117>>>>>        Set Size to 2 243
31118>>>>>        Set Location to 54 4
31119>>>>>
31119>>>>>        //AB-StoreStart
31119>>>>>
31119>>>>>        Send DoRegSize  self smTopRight
31120>>>>>        //AB-StoreEnd
31120>>>>>
31120>>>>>    End_Object
31121>>>>>
31121>>>>>    Object WaitEdit is a editSub
31123>>>>>
31123>>>>>        //AB-StoreTopStart
31123>>>>>
31123>>>>>        //AB-StoreTopEnd
31123>>>>>
31123>>>>>        Set Enabled_State to FALSE
31124>>>>>        Set Read_Only_State to TRUE
31125>>>>>        Set Size to 58 243
31126>>>>>        Set Location to 60 4
31127>>>>>        Set Color to clWhite
31128>>>>>
31128>>>>>        //AB-StoreStart
31128>>>>>
31128>>>>>        Send DoRegSize Self amBottomRight
31129>>>>>        Delegate Set Size to 66 256
31131>>>>>
31131>>>>>        //AB-StoreEnd
31131>>>>>
31131>>>>>    End_Object
31132>>>>>
31132>>>>>    Object oTxtAntiBar is a TextBoxSub
31134>>>>>        Set Enabled_State to TRUE
31135>>>>>        Set Visible_State to FALSE
31136>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
31137>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
31138>>>>>        Set Auto_Size_State to FALSE
31139>>>>>        Set FontWeight to 600
31140>>>>>        Set FontSize to 4 0
31141>>>>>        Set Size to 10 209
31142>>>>>        Set Location to 10 4
31143>>>>>        Set TextColor to clNavy
31144>>>>>    End_Object
31145>>>>>
31145>>>>>
31145>>>>>    //AB-StoreStart
31145>>>>>    Property Integer piWaitSize  Public (Size(Self))
31147>>>>>    Property Integer piPrevSize  Public (Size(Self))
31149>>>>>    Property Integer piState     Public False
31151>>>>>
31151>>>>>    Set Locate_Mode to Center_On_Screen
31152>>>>>    Set Destroy_Object_State to True
31153>>>>>
31153>>>>>    Procedure Show_Details Integer bAlways
31155>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
31156>>>>>        Local String sLabel
31156>>>>>        Get Size                to liSize
31157>>>>>        Get piState             to bState
31158>>>>>        Get piWaitSize          to liOriSize
31159>>>>>        Move (Hi(liSize))       to hiSize
31160>>>>>        Move (Low(liSize))      to lowSize
31161>>>>>        Move (Hi(liOriSize))    to hiOriSize
31162>>>>>        If (bAlways) Begin
31164>>>>>            Set piState         to False
31165>>>>>            Move 0              to bState
31166>>>>>        End
31166>>>>>>
31166>>>>>        If bState Begin
31168>>>>>             Set Size to hiOriSize lowSize
31169>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
31170>>>>>        End
31170>>>>>>
31170>>>>>        Else Begin
31171>>>>>             Set Size to 138 lowSize
31172>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
31173>>>>>        End
31173>>>>>>
31173>>>>>        Set piState to (1-bState)
31174>>>>>    End_Procedure
31175>>>>>
31175>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31177>>>>>       If (bState) Begin
31179>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31182>>>>>       End
31182>>>>>>
31182>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31184>>>>>    End_Procedure
31185>>>>>
31185>>>>>    Procedure DoInitialize_WaitBar
31187>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31188>>>>>    End_Procedure
31189>>>>>
31189>>>>>    Procedure DoTerminate_WaitBar
31191>>>>>        Local Integer iMax
31192>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31193>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31194>>>>>    End_Procedure
31195>>>>>
31195>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31197>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31198>>>>>    End_Procedure
31199>>>>>
31199>>>>>    Function Bar_Maximum_Position Returns Integer
31201>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31202>>>>>    End_Function
31203>>>>>
31203>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31205>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31206>>>>>    End_Procedure
31207>>>>>
31207>>>>>    Function Bar_Minimum_Position Returns Integer
31209>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31210>>>>>    End_Function
31211>>>>>
31211>>>>>    Procedure Set Bar_Step_Value Integer iStep
31213>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31214>>>>>    End_Procedure
31215>>>>>
31215>>>>>    Function Bar_Step_Value Returns Integer
31217>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31218>>>>>    End_Function
31219>>>>>
31219>>>>>    Procedure Set Wait_Message String sMessage
31221>>>>>        Set Value of (WaitText(Self)) to sMessage
31222>>>>>    End_Procedure
31223>>>>>
31223>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31225>>>>>        Local Integer liEditId
31226>>>>>        Move (WaitEdit(Self)) to liEditId
31227>>>>>        If bInitData Send Delete_Data to liEditId
31230>>>>>        If sFile ne "" Begin
31232>>>>>           Send Read to liEditId sFile
31233>>>>>           Send Beginning_Of_Data to liEditId
31234>>>>>        End
31234>>>>>>
31234>>>>>        Else Begin
31235>>>>>           Send Insert to liEditId sDetail
31236>>>>>        End
31236>>>>>>
31236>>>>>    End_Procedure
31237>>>>>
31237>>>>>    Procedure OnResize
31239>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31240>>>>>        Get Size to liPrevSize
31241>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31242>>>>>        Forward Send OnResize
31244>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31245>>>>>        Move (Hi(liLoc)) to liHiLoc
31246>>>>>        Get piState to bState
31247>>>>>        Get Size to liSize
31248>>>>>        Move (Hi(liSize)) to liHiSize
31249>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31251>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31252>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31255>>>>>        End
31255>>>>>>
31255>>>>>        Else Begin
31256>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31257>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31260>>>>>        End
31260>>>>>>
31260>>>>>    End_Procedure
31261>>>>>
31261>>>>>    Procedure Set Button_State Integer bState
31263>>>>>        If bState Begin
31265>>>>>            Set Caption_Bar to True
31266>>>>>            Set Size to 66 256
31267>>>>>        End
31267>>>>>>
31267>>>>>        Else Begin
31268>>>>>            Set Caption_Bar to False
31269>>>>>            Set Size to 38 256
31270>>>>>        End
31270>>>>>>
31270>>>>>    End_Procedure
31271>>>>>
31271>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31273>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31274>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31275>>>>>        If (bState = 0) Begin
31277>>>>>            Set Size to 24 256
31278>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31279>>>>>        End
31279>>>>>>
31279>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31282>>>>>    End_Procedure
31283>>>>>
31283>>>>>    Procedure Deactivating integer search_mode Returns Integer
31285>>>>>        local integer rval
31286>>>>>        Forward Get MSG_Deactivating search_mode to rval
31288>>>>>        Set Modal_State of (Wait(Self)) to False
31289>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31290>>>>>        Procedure_Return rval
31291>>>>>    End_Procedure
31292>>>>>
31292>>>>>    Procedure UpdateWait String sMsg
31294>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31295>>>>>    End_Procedure
31296>>>>>
31296>>>>>
31296>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31298>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31299>>>>>    End_Procedure
31300>>>>>
31300>>>>>
31300>>>>>
31300>>>>>
31300>>>>>
31300>>>>>
31300>>>>>    //AB-StoreEnd
31300>>>>>
31300>>>>>End_Object
31301>>>>>
31301>>>>>
31301>>>>>//AB-StoreStart
31301>>>>>
31301>>>>>//AB-StoreEnd
31301>>>>>
31301>>>>>//AB/ End_Object    // prj
31301>>>
31301>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31301>>>//AB/ Project Calendar
31301>>>//AB/ Object prj is a Lookup_Project
31301>>>//AB/     Set ProjectName to "Calendar"
31301>>>//AB/     Set ProjectFileName to "Calendar.sl"
31301>>>
31301>>>// Project Object Structure
31301>>>//   oCalendar is a dbModalPanel
31301>>>//     Container3d1 is a Container3d
31301>>>//       Grid2 is a Grid
31301>>>//       Textbox2 is a Textbox
31301>>>//       Textbox3 is a Textbox
31301>>>//       Textbox4 is a Textbox
31301>>>//       Textbox5 is a Textbox
31301>>>//       Textbox6 is a Textbox
31301>>>//       Textbox7 is a Textbox
31301>>>//       Textbox8 is a Textbox
31301>>>//       LineControl1 is a LineControl
31301>>>//       Container3d2 is a Container3d
31301>>>//         oRght is a BitmapContainer
31301>>>//         oLeft is a BitmapContainer
31301>>>//         oMonth is a Textbox
31301>>>//           oSelectMonth is a FloatingPopupMenu
31301>>>//         oYear is a Textbox
31301>>>//         oSelectYear is a Form
31301>>>//     BitmapContainer3 is a BitmapContainer
31301>>>//     oToday is a Textbox
31301>>>
31301>>>// Register all objects
31301>>>Register_Object BitmapContainer3
31301>>>Register_Object Container3d1
31301>>>Register_Object Container3d2
31301>>>Register_Object Grid2
31301>>>Register_Object LineControl1
31301>>>Register_Object oCalendar
31301>>>Register_Object oLeft
31301>>>Register_Object oMonth
31301>>>Register_Object oRght
31301>>>Register_Object oSelectMonth
31301>>>Register_Object oSelectYear
31301>>>Register_Object oToday
31301>>>Register_Object oYear
31301>>>Register_Object Textbox2
31301>>>Register_Object Textbox3
31301>>>Register_Object Textbox4
31301>>>Register_Object Textbox5
31301>>>Register_Object Textbox6
31301>>>Register_Object Textbox7
31301>>>Register_Object Textbox8
31301>>>
31301>>>
31301>>>
31301>>>//AB-StoreTopStart
31301>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31301>>>>>// **********************************************************************
31301>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31301>>>>>//
31301>>>>>// by Sture Andersen (sa1@vd.dk)
31301>>>>>//
31301>>>>>// The file contains a number of global functions for manipulating
31301>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31301>>>>>// This package is public domain.
31301>>>>>//
31301>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31301>>>>>// listing the functions and their use.
31301>>>>>//
31301>>>>>//
31301>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31301>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31301>>>>>//                         - Addition of popup_calendar to VDF.
31301>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31301>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31301>>>>>//         Thu  10-07-1997 - Fixes.
31301>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31301>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31301>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31301>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31301>>>>>//                           ItemSysdate added.
31301>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31301>>>>>//                           FieldSysdate added.
31301>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31301>>>>>//                           Module_Compile_Time added.
31301>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31301>>>>>//                           responds if entry_state of the calling object
31301>>>>>//                           is true (VDF version). (No apparent effect)
31301>>>>>//         Sat  28-03-1998 - Added the following functions:
31301>>>>>//                             TS_SysTime      TS_ExtractDate
31301>>>>>//                             TS_ExtractTime  TS_ConvertToString
31301>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31301>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31301>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31301>>>>>//                           Module_Start_Time added.
31301>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31301>>>>>//         Mon  12-10-1998 - Portuguese added
31301>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31301>>>>>//         Tue  29-12-1998 - Function DateAsString added
31301>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31301>>>>>//                           Kjetil Johanson
31301>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31301>>>>>//                           Kjetil Johanson (again)
31301>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31301>>>>>//                           class (Continue->TS_Continue and Pause->
31301>>>>>//                           TS_Pause)
31301>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31301>>>>>//                           added.
31301>>>>>//                         - Procedures DateCurrentSeparator and
31301>>>>>//                           DateCurrentFormat added.
31301>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31301>>>>>//                           Jan1st1000 and Jan1st100
31301>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31301>>>>>//                           to trap 3 digit years.
31301>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31301>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31301>>>>>//                         - Fixed error in TS_ConvertToString
31301>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31301>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31301>>>>>//                           from the calendar to forms with no form_margin.
31301>>>>>//         Tue  07-09-1999 - Added function DateAsText
31301>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31301>>>>>//                           in combination with y2k.
31301>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31301>>>>>//                         - Existing function DateAsString renamed to
31301>>>>>//                           DateToString.
31301>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31301>>>>>//                           would result in seeding the calendar on year 100.
31301>>>>>//                           This error was caused by the fact that VDF 4
31301>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31301>>>>>//                           command returns 03-01-100
31301>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31301>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31301>>>>>//
31301>>>>>// NOTE:  There is language dependent string constants in this file.
31301>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31301>>>>>//        norwegian, spanish, german and portuguese
31301>>>>>//
31301>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31301>>>>>//
31301>>>>>// ***********************************************************************
31301>>>>>
31301>>>>>Use ui
31301>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31301>>>>>>>// Use Language     // Default language setup
31301>>>>>>>// Sets default languange if not set by compiler command line
31301>>>>>>>
31301>>>>>>>define lng_dutch      for 131
31301>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31301>>>>>>>define lng_spanish    for 134
31301>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31301>>>>>>>define lng_english    for 144
31301>>>>>>>define lng_danish     for 145
31301>>>>>>>define lng_swedish    for 146
31301>>>>>>>define lng_norwegian  for 147
31301>>>>>>>define lng_Greek    for 148
31301>>>>>>>define lng_german     for 149
31301>>>>>>>define lng_portuguese for 155
31301>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31301>>>>>>>
31301>>>>>>>
31301>>>>>>>define lng_default for !@
31301>>>>>>>
31301>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31301>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31301>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31301>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31301>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31301>>>>>>>
31301>>>>>>>//  FOR_EX (extended FOR command)
31301>>>>>>>//  -----------------------------
31301>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31301>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31301>>>>>>>//> you need to do a decremental loop.
31301>>>>>>>
31301>>>>>>>
31301>>>>>>>//  DESKTOP_SECTION
31301>>>>>>>//  ---------------
31301>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31301>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31301>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31301>>>>>>>
31301>>>>>>>
31301>>>>>>>
31301>>>>>
31301>>>>>// Switches
31301>>>>>
31301>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31301>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31301>>>>>
31301>>>>> define t.calendar.year           for "Year"
31301>>>>> define t.calendar.month          for "Month"
31301>>>>> define t.calendar.day            for "Day"
31301>>>>> define t.calendar.week           for "Wk."
31301>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31301>>>>> define t.calendar.Monday         for "Monday"
31301>>>>> define t.calendar.Tuesday        for "Tuesday"
31301>>>>> define t.calendar.Wednesday      for "Wednesday"
31301>>>>> define t.calendar.Thursday       for "Thursday"
31301>>>>> define t.calendar.Friday         for "Friday"
31301>>>>> define t.calendar.Saturday       for "Saturday"
31301>>>>> define t.calendar.Sunday         for "Sunday"
31301>>>>> define t.calendar.January        for "January"
31301>>>>> define t.calendar.February       for "February"
31301>>>>> define t.calendar.March          for "March"
31301>>>>> define t.calendar.April          for "April"
31301>>>>> define t.calendar.May            for "May"
31301>>>>> define t.calendar.June           for "June"
31301>>>>> define t.calendar.July           for "July"
31301>>>>> define t.calendar.August         for "August"
31301>>>>> define t.calendar.September      for "September"
31301>>>>> define t.calendar.October        for "October"
31301>>>>> define t.calendar.November       for "November"
31301>>>>> define t.calendar.December       for "December"
31301>>>>> define t.calendar.ok             for "OK"
31301>>>>> define t.calendar.Cancel         for "Cancel"
31301>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31301>>>>>
31301>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31301>>>>>define Jan1st1900          for 693975
31301>>>>>define Jan1st2000          for 730500
31301>>>>>define Jan1st1000          for 365250
31301>>>>>define Jan1st105           for 38352
31301>>>>>define Jan1st100           for 36525
31301>>>>>
31301>>>>>enumeration_list // Date Segments
31301>>>>>  define DS_DAY
31301>>>>>  define DS_WEEK
31301>>>>>  define DS_MONTH
31301>>>>>  define DS_YEAR
31301>>>>>end_enumeration_list
31301>>>>>
31301>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31301>>>>>
31301>>>>>procedure DateDecompose global date date# //very internal!!
31302>>>>>  local integer pos1# pos2# format#
31303>>>>>  local string str# sep#
31303>>>>>  get_attribute DF_DATE_FORMAT to format#
31306>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31309>>>>>  character pos1# to sep#                  // end overload
31310>>>>>>
31310>>>>>  move date# to str#
31311>>>>>  replace sep# in str# with "$"
31313>>>>>  move strmark to pos1#
31314>>>>>  if [found] begin
31316>>>>>    replace sep# in str# with "$"
31318>>>>>    move strmark to pos2#
31319>>>>>  end
31319>>>>>>
31319>>>>>  else begin
31320>>>>>    move 0 to Dates$Year
31321>>>>>    move 0 to Dates$Month
31322>>>>>    move 0 to Dates$Day
31323>>>>>  end
31323>>>>>>
31323>>>>>  [ found] begin
31325>>>>>>
31325>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31329>>>>>    if format# eq DF_DATE_USA begin
31331>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31334>>>>>>
31334>>>>>          left str# to Dates$Month  (pos1#-1)
31336>>>>>>
31336>>>>>    end
31336>>>>>>
31336>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31340>>>>>
31340>>>>>    if format# eq DF_DATE_MILITARY begin
31342>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31345>>>>>>
31345>>>>>          left str# to Dates$Year   (pos1#-1)
31347>>>>>>
31347>>>>>    end
31347>>>>>>
31347>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31351>>>>>  end
31351>>>>>>
31351>>>>>end_procedure
31352>>>>>
31352>>>>>function DateCompose global integer day# integer month# integer year# returns date
31353>>>>>  local integer format#
31354>>>>>  local date date#
31354>>>>>  local string sep#
31354>>>>>  ifnot (day#*month#*year#) function_return 0
31357>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31360>>>>>  character format# to sep#                  // end overload
31361>>>>>>
31361>>>>>  get_attribute DF_DATE_FORMAT to format#
31364>>>>>  if day# gt 28 begin
31366>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31369>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31372>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31375>>>>>    send DateDecompose date#
31376>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31379>>>>>  end
31379>>>>>>
31379>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31382>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31385>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31386>>>>>end_function
31387>>>>>
31387>>>>>function DateFormatName global integer format# returns string
31388>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31391>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31394>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31397>>>>>end_function
31398>>>>>
31398>>>>>function DateCurrentSeparator global returns string
31399>>>>>  local integer rval#
31400>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31403>>>>>  function_return (character(rval#))
31404>>>>>end_function
31405>>>>>
31405>>>>>function DateCurrentFormat global returns integer
31406>>>>>  local integer rval#
31407>>>>>  get_attribute DF_DATE_FORMAT to rval#
31410>>>>>  function_return rval#
31411>>>>>end_function
31412>>>>>
31412>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31413>>>>>  local string rval# letter#
31414>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31417>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31420>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31423>>>>>  left t.calendar.year to letter# 1
31425>>>>>>
31425>>>>>  replace "1" in rval# with letter#
31427>>>>>  replace "1" in rval# with letter#
31429>>>>>  ifnot long# move "" to letter#
31432>>>>>  move (replaces("1",rval#,letter#)) to rval#
31433>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31434>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31435>>>>>  if sep# eq "" begin
31437>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31440>>>>>    character format# to sep#
31441>>>>>>
31441>>>>>  end
31441>>>>>>
31441>>>>>  move (replaces("4",rval#,sep#)) to rval#
31442>>>>>  function_return rval#
31443>>>>>end_function
31444>>>>>
31444>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31445>>>>>  local integer sep_len# day# month# year#
31446>>>>>  move (length(sep#)) to sep_len#
31447>>>>>  if four_digit_year# move 4 to four_digit_year#
31450>>>>>  else move 2 to four_digit_year#
31452>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31454>>>>>    move (mid(date#,2,1)) to day#
31455>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31456>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31457>>>>>  end
31457>>>>>>
31457>>>>>  if format# eq DF_DATE_USA begin // MDY
31459>>>>>    move (mid(date#,2,1)) to month#
31460>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31461>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31462>>>>>  end
31462>>>>>>
31462>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31464>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31465>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31466>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31467>>>>>  end
31467>>>>>>
31467>>>>>  function_return (DateCompose(day#,month#,year#))
31468>>>>>end_function
31469>>>>>
31469>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31470>>>>>  local string rval# day# month# year#
31471>>>>>  get Date2to4 date# to date#
31472>>>>>  if (integer(date#)) begin
31474>>>>>    send DateDecompose date#
31475>>>>>    move Dates$Day to day#
31476>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31480>>>>>    move Dates$Month to month#
31481>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31485>>>>>    move Dates$Year to year#
31486>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31489>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31492>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31495>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31498>>>>>  end
31498>>>>>>
31498>>>>>  function_return rval#
31499>>>>>end_function
31500>>>>>
31500>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31500>>>>>// Use function DateToString instead.
31500>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31501>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31502>>>>>end_function
31503>>>>>
31503>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31504>>>>>  if (date#=0) function_return 0
31507>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31510>>>>>  if (segment#<>DS_DAY) begin // months or years
31512>>>>>    send DateDecompose date#
31513>>>>>    if segment# eq DS_MONTH begin //months
31515>>>>>      move (Dates$Month+amount#) to Dates$Month
31516>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31519>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31520>>>>>    end //years:
31520>>>>>>
31520>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31523>>>>>  end
31523>>>>>>
31523>>>>>  else function_return (date#+amount#) //days
31525>>>>>end_function
31526>>>>>
31526>>>>>function DateSegment global date date# integer segment# returns integer
31527>>>>>  send DateDecompose date#
31528>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31531>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31534>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31537>>>>>end_function
31538>>>>>
31538>>>>>function DateToInteger global date date# returns integer
31539>>>>>  send DateDecompose date#
31540>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31541>>>>>end_function
31542>>>>>
31542>>>>>function FirstDayInMonth global date date# returns date
31543>>>>>  local integer month# year#
31544>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31545>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31546>>>>>  function_return (DateCompose(1,month#,year#))
31547>>>>>end_function
31548>>>>>
31548>>>>>function LastDayInMonth global date date# returns date
31549>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31550>>>>>  function_return (FirstDayInMonth(date#)-1)
31551>>>>>end_function
31552>>>>>
31552>>>>>function FirstDayInYear global date date# returns date
31553>>>>>  local integer year#
31554>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31555>>>>>  function_return (DateCompose(1,1,year#))
31556>>>>>end_function
31557>>>>>
31557>>>>>function LastDayInYear global date date# returns date
31558>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31559>>>>>  function_return (FirstDayInYear(date#)-1)
31560>>>>>end_function
31561>>>>>
31561>>>>>// Prior to 18/1-99 version of DateWeekNumber
31561>>>>>//function DateWeekNumber global date date# returns integer
31561>>>>>//  local integer week# first_wd# day_of_year# year#
31561>>>>>//  if (date#=0) function_return 0
31561>>>>>//  get Date2to4 date# to date#
31561>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31561>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31561>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31561>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31561>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31561>>>>>//  else move 0 to week#
31561>>>>>//  if first_wd# le 4 increment week#
31561>>>>>//  if week# gt 52 begin
31561>>>>>//    move 1 to week#
31561>>>>>//    if first_wd# eq 4 move 53 to week#
31561>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31561>>>>>//  end
31561>>>>>//  if week# eq 0 begin
31561>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31561>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31561>>>>>//    move 52 to week#
31561>>>>>//    if first_wd# eq 4 move 53 to week#
31561>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31561>>>>>//  end
31561>>>>>//  function_return week#
31561>>>>>//end_function
31561>>>>>
31561>>>>>function DateWeekNumber global date date# returns integer
31562>>>>>  local integer week# first_wd# day_of_year# year# wd#
31563>>>>>  if (date#=0) function_return 0
31566>>>>>  get Date2to4 date# to date#
31567>>>>>  // Leap-year test for actual or previous year
31567>>>>>  // Year# only used for selection between 52 and
31567>>>>>  // Therefore get year# from the first day of actual week
31567>>>>>  get DateDayNumber date# to wd#
31568>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31569>>>>>
31569>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31570>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31571>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31572>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31575>>>>>  else move 0 to week#
31577>>>>>  if first_wd# le 4 increment week#
31580>>>>>  if week# gt 52 begin
31582>>>>>    move 1 to week#
31583>>>>>    if first_wd# eq 4 move 53 to week#
31586>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31593>>>>>  end
31593>>>>>>
31593>>>>>  if week# eq 0 begin
31595>>>>>    // Week 52 or 53
31595>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31596>>>>>    move 52 to week#
31597>>>>>    if first_wd# eq 4 move 53 to week#
31600>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31607>>>>>  end
31607>>>>>>
31607>>>>>  function_return week#
31608>>>>>end_function
31609>>>>>
31609>>>>>function DayName global integer int# returns string
31610>>>>>  if int# eq 1 function_return t.calendar.Monday
31613>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31616>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31619>>>>>  if int# eq 4 function_return t.calendar.Thursday
31622>>>>>  if int# eq 5 function_return t.calendar.Friday
31625>>>>>  if int# eq 6 function_return t.calendar.Saturday
31628>>>>>  if int# eq 7 function_return t.calendar.Sunday
31631>>>>>  function_return ""
31632>>>>>end_function
31633>>>>>
31633>>>>>function DateDayNumber global date date# returns integer
31634>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31635>>>>>  get Date2to4 date# to date#
31636>>>>>  move date# to rval#
31637>>>>>  if rval# begin
31639>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31642>>>>>    move (rval#-((rval#/7)*7)) to rval#
31643>>>>>    if rval# eq 0 move 7 to rval#
31646>>>>>  end
31646>>>>>>
31646>>>>>  function_return rval#
31647>>>>>end_function
31648>>>>>
31648>>>>>function DateDayName global date date# returns string
31649>>>>>  function_return (DayName(DateDayNumber(date#)))
31650>>>>>end_function
31651>>>>>
31651>>>>>function YearMaxWeek global integer year# returns integer
31652>>>>>  local integer wk1# wk2#
31653>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31654>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31655>>>>>  function_return (wk1# max wk2#)
31656>>>>>end_function
31657>>>>>
31657>>>>>function WeekToDate global integer year# integer week# returns date
31658>>>>>  local date date#
31659>>>>>  move (DateCompose(1,1,year#)) to date#
31660>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31663>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31664>>>>>  function_return (week#-1*7+date#)
31665>>>>>end_function
31666>>>>>
31666>>>>>function MonthName global integer int# returns string
31667>>>>>  if int# eq  1 function_return t.calendar.January
31670>>>>>  if int# eq  2 function_return t.calendar.February
31673>>>>>  if int# eq  3 function_return t.calendar.March
31676>>>>>  if int# eq  4 function_return t.calendar.April
31679>>>>>  if int# eq  5 function_return t.calendar.May
31682>>>>>  if int# eq  6 function_return t.calendar.June
31685>>>>>  if int# eq  7 function_return t.calendar.July
31688>>>>>  if int# eq  8 function_return t.calendar.August
31691>>>>>  if int# eq  9 function_return t.calendar.September
31694>>>>>  if int# eq 10 function_return t.calendar.October
31697>>>>>  if int# eq 11 function_return t.calendar.November
31700>>>>>  if int# eq 12 function_return t.calendar.December
31703>>>>>  function_return ""
31704>>>>>end_function
31705>>>>>
31705>>>>>function DateMonthName global date date# returns string
31706>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31707>>>>>end_function
31708>>>>>
31708>>>>>function DateAsText global date date# string format# returns string
31709>>>>>  if date# eq 0 function_return ""
31712>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31713>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31714>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31715>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31716>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31717>>>>>  function_return format#
31718>>>>>end_function
31719>>>>>
31719>>>>>function Year2to4 global integer year# returns integer
31720>>>>>  local integer epoch_value#
31721>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31722>>>>>  if year# lt 100 begin
31724>>>>>    if year# gt epoch_value# function_return (year#+1900)
31727>>>>>    function_return (year#+2000)
31728>>>>>  end
31728>>>>>>
31728>>>>>  function_return year# // No conversion done!
31729>>>>>end_function
31730>>>>>
31730>>>>>function Date2to4 global date date# returns date
31731>>>>>  local integer epoch_value#
31732>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31733>>>>>  if date# gt 0 begin // Only if there is a date to convert
31735>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31737>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31740>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31741>>>>>    end
31741>>>>>>
31741>>>>>    function_return date# // No conversion done!
31742>>>>>  end
31742>>>>>>
31742>>>>>end_function
31743>>>>>
31743>>>>>function Date4to2 global date date# returns date
31744>>>>>  local integer epoch_value# year#
31745>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31746>>>>>  if date# gt 0 begin // Only if there is a date to convert
31748>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31749>>>>>    if year# ge 100 begin // Only then conversion is needed!
31751>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31753>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31756>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31758>>>>>      end
31758>>>>>>
31758>>>>>      else error 301 "Date is out of epoch range"
31760>>>>>    end
31760>>>>>>
31760>>>>>  end
31760>>>>>>
31760>>>>>  function_return date# // No conversion done!
31761>>>>>end_function
31762>>>>>
31762>>>>>function dSysDate global returns date
31763>>>>>  local date date#
31764>>>>>  sysdate4 date#
31765>>>>>  function_return date#
31766>>>>>end_function
31767>>>>>
31767>>>>>function iSysYear global returns integer
31768>>>>>  local date date#
31769>>>>>  sysdate4 date#
31770>>>>>  function_return (DateSegment(date#,DS_YEAR))
31771>>>>>end_function
31772>>>>>
31772>>>>>procedure ItemSysdate for desktop integer itm#
31773>>>>>  local date date#
31774>>>>>  get value item itm# to date#
31775>>>>>  if date# eq 0 begin
31777>>>>>    sysdate4 date#
31778>>>>>    set changed_value item itm# to date#
31779>>>>>  end
31779>>>>>>
31779>>>>>end_procedure
31780>>>>>
31780>>>>>procedure ItemDate2to4 for desktop integer itm#
31781>>>>>  local integer year#
31782>>>>>  local date date# new_date#
31782>>>>>  get value item itm# to date#
31783>>>>>
31783>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31784>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31787>>>>>  else move date# to new_date#
31789>>>>>
31789>>>>>  move (Date2to4(new_date#)) to new_date#
31790>>>>>  move (DateSegment(new_date#,3)) to year#
31791>>>>>  if (year#>99 and year#<1000) begin
31793>>>>>    error 15 // Illegal entry in this window
31794>>>>>>
31794>>>>>    procedure_return 1
31795>>>>>  end
31795>>>>>>
31795>>>>>  if new_date# ne date# set value item itm# to new_date#
31798>>>>>end_procedure
31799>>>>>
31799>>>>>procedure ItemYear2to4 for desktop integer itm#
31800>>>>>  local integer year# new_year#
31801>>>>>  get value item itm# to year#
31802>>>>>  if (year#>99 and year#<1000) begin
31804>>>>>    error 15 // Illegal entry in this window
31805>>>>>>
31805>>>>>    procedure_return 1
31806>>>>>  end
31806>>>>>>
31806>>>>>  move (Year2to4(year#)) to new_year#
31807>>>>>  if new_year# ne year# set value item itm# to new_year#
31810>>>>>end_procedure
31811>>>>>
31811>>>>> procedure FieldSysdate for DataDictionary integer fld#
31812>>>>>   local date date#
31813>>>>>   get field_current_value fld# to date#
31814>>>>>   if date# eq 0 begin
31816>>>>>     sysdate4 date#
31817>>>>>     set field_changed_value fld# to date#
31818>>>>>   end
31818>>>>>>
31818>>>>> end_procedure
31819>>>>>
31819>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31820>>>>>   local integer year#
31821>>>>>   local date date# new_date#
31821>>>>>   get field_current_value fld# to date#
31822>>>>>
31822>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31823>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31826>>>>>   else move date# to new_date#
31828>>>>>
31828>>>>>   move (Date2to4(new_date#)) to new_date#
31829>>>>>   move (DateSegment(new_date#,3)) to year#
31830>>>>>   if (year#>99 and year# <=999) begin
31832>>>>>     error 15 // Illegal entry in this window
31833>>>>>>
31833>>>>>     procedure_return 1
31834>>>>>   end
31834>>>>>>
31834>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31837>>>>> end_procedure
31838>>>>>
31838>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31839>>>>>   local integer year# new_year# changed#
31840>>>>>   get field_current_value fld# to year#
31841>>>>>   get field_changed_state fld# to changed#
31842>>>>>   if changed# begin
31844>>>>>     if (year#>99 and year#<1000) begin
31846>>>>>       error 15 // Illegal entry in this window
31847>>>>>>
31847>>>>>       procedure_return 1
31848>>>>>     end
31848>>>>>>
31848>>>>>     move (Year2to4(year#)) to new_year#
31849>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31852>>>>>   end
31852>>>>>>
31852>>>>> end_procedure
31853>>>>>
31853>>>>> function SysDate global returns date
31854>>>>>   function_return (dSysDate())
31855>>>>> end_function
31856>>>>>
31856>>>>>function sSysTime global returns string
31857>>>>>  local integer h# m# s#
31858>>>>>  sysdate4 h# h# m# s#
31862>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31863>>>>>end_function
31864>>>>>
31864>>>>>function TS_SysTime global returns number
31865>>>>>  local integer d# h# m# s#
31866>>>>>  sysdate4 d# h# m# s#
31870>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31871>>>>>end_function
31872>>>>>
31872>>>>>//> This function returns a TS value composed from the date and time
31872>>>>>//> passed to it. Note that the time variable must be of the format
31872>>>>>//> "hh:mm:ss".
31872>>>>>function TS_Compose global date date# string time# returns number
31873>>>>>  local integer h# m# s#
31874>>>>>  left time# to h# 2
31876>>>>>>
31876>>>>>  mid time# to m# 2 4
31879>>>>>>
31879>>>>>  mid time# to s# 2 7
31882>>>>>>
31882>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31883>>>>>end_function
31884>>>>>
31884>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31885>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31886>>>>>end_function
31887>>>>>
31887>>>>>function TS_ExtractDate global number time# returns date
31888>>>>>  function_return (time#/86400) // 86400=24*60*60
31889>>>>>end_function
31890>>>>>
31890>>>>>function TS_ExtractTime global number time# returns string
31891>>>>>  local integer h# m# s#
31892>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31893>>>>>  move (s#/3600) to h#
31894>>>>>  move (s#-(h#*3600)) to s#
31895>>>>>  move (s#/60) to m#
31896>>>>>  move (s#-(m#*60)) to s#
31897>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31898>>>>>end_function
31899>>>>>
31899>>>>>function TS_ConvertToString global number time# returns string
31900>>>>>  local date d#
31901>>>>>  move (TS_ExtractDate(time#)) to d#
31902>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31905>>>>>  else function_return (TS_ExtractTime(time#))
31907>>>>>end_function
31908>>>>>
31908>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31909>>>>>  local integer h# m#
31910>>>>>  move (ts#/3600) to h#
31911>>>>>  move (ts#-(h#*3600)) to ts#
31912>>>>>  move (ts#/60) to m#
31913>>>>>  move (ts#-(m#*60)) to ts#
31914>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31915>>>>>end_function
31916>>>>>
31916>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31916>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31917>>>>>  local integer obj2# itm2#
31918>>>>>  if num_arguments gt 3 begin
31920>>>>>    move tmp_obj2# to obj2#
31921>>>>>    move tmp_itm2# to itm2#
31922>>>>>  end
31922>>>>>>
31922>>>>>  else begin
31923>>>>>    move obj1# to obj2#
31924>>>>>    move (itm1#+1) to itm2#
31925>>>>>  end
31925>>>>>>
31925>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31926>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31927>>>>>end_procedure
31928>>>>>
31928>>>>>class TS_TimeEstimator is an array
31929>>>>>  procedure construct_object
31930>>>>>    forward send construct_object
31932>>>>>    set delegation_mode to delegate_to_parent
31933>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31934>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31935>>>>>    property number  pnLeft    public 0 // Number of seconds left
31936>>>>>    property number  pnStart   public 0
31937>>>>>    property number  pnPause   public 0
31938>>>>>    property number  pnPercent public 0
31939>>>>>    property integer piMin     public 0
31940>>>>>    property integer piMax     public 0
31941>>>>>  end_procedure
31942>>>>>
31942>>>>>  procedure TS_Start integer min# integer max#
31943>>>>>    set piMin to min#
31944>>>>>    set piMax to max#
31945>>>>>    set pnStart to (TS_SysTime())
31946>>>>>    set pnElapsed to 0
31947>>>>>    set pnPercent to 0
31948>>>>>  end_procedure
31949>>>>>
31949>>>>>  procedure TS_Calculate integer pos#
31950>>>>>    local integer min# max#
31951>>>>>    get piMin to min#
31952>>>>>    get piMax to max#
31953>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31954>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31955>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31956>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31957>>>>>  end_procedure
31958>>>>>
31958>>>>>  procedure TS_Pause
31959>>>>>    set pnPause to (TS_SysTime())
31960>>>>>  end_procedure
31961>>>>>
31961>>>>>  procedure TS_Continue
31962>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31963>>>>>  end_procedure
31964>>>>>end_class
31965>>>>>
31965>>>>>function TS_Module_Compile_Time global string path# returns number
31966>>>>>  local integer pos# day# month# year# seqeof# ch#
31967>>>>>  local string date# str# time#
31967>>>>>  move path# to str#
31968>>>>>  if str# ne "" begin
31970>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31971>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31972>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31974>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31976>>>>>    [ seqeof] move 1 to seqeof#
31977>>>>>    [~seqeof] move 0 to seqeof#
31978>>>>>    [~seqeof] readln str#
31979>>>>>    close_input channel ch#
31981>>>>>  end
31981>>>>>>
31981>>>>>  if seqeof# function_return 0
31984>>>>>  pos "," in str# to pos#
31986>>>>>>
31986>>>>>  move (mid(str#,18,pos#+2)) to str#
31987>>>>>  move (integer(mid(str#,2,4))) to day#
31988>>>>>  move (integer(mid(str#,2,1))) to month#
31989>>>>>  move (integer(mid(str#,2,7))) to year#
31990>>>>>  if year# eq 10 begin
31992>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31993>>>>>    move (mid(str#,8,11)) to str#
31994>>>>>  end
31994>>>>>>
31994>>>>>  else move (mid(str#,8,10)) to str#
31996>>>>>  move (DateCompose(day#,month#,year#)) to date#
31997>>>>>  move (Date2to4(date#)) to date#
31998>>>>>  pos ":" in str# to pos#
32000>>>>>>
32000>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
32001>>>>>end_function
32002>>>>>
32002>>>>>string Dates$Module_Compile_Time
32002>>>>>move "" to Dates$Module_Compile_Time
32003>>>>>
32003>>>>>function Module_Compile_Date global returns date
32004>>>>>  local number ts#
32005>>>>>  local string str#
32005>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
32006>>>>>  get TS_Module_Compile_Time str# to ts#
32007>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
32008>>>>>  function_return (TS_ExtractDate(ts#))
32009>>>>>end_function
32010>>>>>
32010>>>>>function Module_Compile_Time global returns string
32011>>>>>  local date grb#
32012>>>>>  // Module_Compile_Date must be called before this one!
32012>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
32015>>>>>  function_return Dates$Module_Compile_Time
32016>>>>>end_function
32017>>>>>
32017>>>>>date   Dates$ModuleStartDate
32017>>>>>string Dates$ModuleStartTime 8
32017>>>>>move (dSysDate()) to Dates$ModuleStartDate
32018>>>>>move (sSysTime()) to Dates$ModuleStartTime
32019>>>>>
32019>>>>>function Module_Start_Date global returns date
32020>>>>>  function_return Dates$ModuleStartDate
32021>>>>>end_function
32022>>>>>
32022>>>>>function Module_Start_Time global returns string
32023>>>>>  function_return Dates$ModuleStartTime
32024>>>>>end_function
32025>>>>>
32025>>>>> register_procedure NotifyPopupCalendarChange date date#
32025>>>>> register_procedure NotifyPopupCalendarSelect date date#
32025>>>>>  use dfAllent
32025>>>>>  class calendar.textbox is a textbox
32026>>>>>    procedure construct_object
32027>>>>>      forward send construct_object
32029>>>>>      Set Auto_Size_State To False
32030>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
32031>>>>>    end_procedure
32032>>>>>  end_class
32033>>>>>
32033>>>>>  register_object btn1
32033>>>>>  register_object btn6
32033>>>>>
32033>>>>>  class calendar.button is a button
32034>>>>>
32034>>>>>    procedure construct_object
32035>>>>>      forward send construct_object
32037>>>>>      set size to 15 18
32038>>>>>      on_key kleftarrow   send prev_day
32039>>>>>      on_key krightarrow  send next_day
32040>>>>>      on_key kuparrow     send prev_week
32041>>>>>      on_key kdownarrow   send next_week
32042>>>>>      property date p_assigned_date public 0
32043>>>>>    end_procedure
32044>>>>>
32044>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
32045>>>>>      send activate to (btn1(current_object))
32046>>>>>    end_procedure
32047>>>>>    procedure switch_back
32048>>>>>      send activate to (btn6(current_object))
32049>>>>>    end_procedure
32050>>>>>
32050>>>>>    procedure mouse_down
32051>>>>>      local integer current_object#
32052>>>>>      forward send mouse_down
32054>>>>>      move current_object to current_object#
32055>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
32057>>>>>    end_procedure
32058>>>>>  end_class
32059>>>>>
32059>>>>>  desktop_section
32065>>>>>    object popup_calendar is a ModalPanel
32067>>>>>      set size to 160 250
32068>>>>>      property date    p_current_date  public 0
32070>>>>>      property integer p_current_year  public -1
32072>>>>>      property integer p_current_month public -1
32074>>>>>      property integer pExportState    public 1
32076>>>>>
32076>>>>>      on_key key_ctrl+key_pgup send prev_year
32077>>>>>      on_key key_ctrl+key_pgdn send next_year
32078>>>>>      on_key          key_pgup send prev_month
32079>>>>>      on_key          key_pgdn send next_month
32080>>>>>      on_key key_ctrl+key_d    send go_today
32081>>>>>      on_key kcancel           send cancel
32082>>>>>
32082>>>>>      object cont3d is a container3d
32084>>>>>        set location to 5 5
32085>>>>>        set size to 120 237
32086>>>>>        object textbox_year is a calendar.textbox
32088>>>>>          set location to 5 5
32089>>>>>          set size to 15 30
32090>>>>>          set border_style to border_staticedge
32091>>>>>          procedure display
32093>>>>>            set value to (p_current_year(current_object))
32094>>>>>          end_procedure
32095>>>>>        end_object
32096>>>>>        object dayname_header is a container3d
32098>>>>>          set location to 5 39
32099>>>>>          set size to 15 126
32100>>>>>          set border_style to border_staticedge
32101>>>>>          procedure initialize
32103>>>>>            local integer itm#
32104>>>>>            for itm# from 0 to 6
32110>>>>>>
32110>>>>>              object txt is a calendar.textbox
32112>>>>>                set size to 12 17
32113>>>>>                set location to 0 (itm#*17.6+1)
32114>>>>>                 set value to (left(DayName(itm#+1),3))
32115>>>>>              end_object
32116>>>>>            loop
32117>>>>>>
32117>>>>>          end_procedure
32118>>>>>          send initialize
32119>>>>>        end_object
32120>>>>>        object weeknumber_header is a container3d
32122>>>>>          set location to 24 5
32123>>>>>          set size     to 89 30
32124>>>>>          set border_style to border_staticedge
32125>>>>>          object obj_id_array is an array
32127>>>>>          end_object
32128>>>>>          procedure initialize
32130>>>>>            local integer itm# obj#
32131>>>>>            move (obj_id_array(current_object)) to obj#
32132>>>>>            for itm# from 0 to 5
32138>>>>>>
32138>>>>>              object txt is a textbox
32140>>>>>                set size to 15 30
32141>>>>>                set location to (itm#*15+1) 1
32142>>>>>                set value of obj# item (item_count(obj#)) to current_object
32143>>>>>              end_object
32144>>>>>            loop
32145>>>>>>
32145>>>>>          end_procedure
32146>>>>>          procedure display
32148>>>>>            local integer itm# obj#
32149>>>>>            local date date# last_date#
32149>>>>>            move (obj_id_array(current_object)) to obj#
32150>>>>>            get p_current_date to date#
32151>>>>>            move (FirstDayInMonth(date#)) to date#
32152>>>>>            move (LastDayInMonth(date#)) to last_date#
32153>>>>>            move (date#-DateDayNumber(date#)+1) to date#
32154>>>>>            for itm# from 0 to 5
32160>>>>>>
32160>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
32163>>>>>              else set value of (integer(value(obj#,itm#))) to ""
32165>>>>>            loop
32166>>>>>>
32166>>>>>          end_procedure
32167>>>>>          send initialize
32168>>>>>        end_object
32169>>>>>        object days_grid is a container3d
32171>>>>>          set location to 23 39
32172>>>>>          set size     to 100 127
32173>>>>>          set border_style to border_none
32174>>>>>          object btn_array is an array
32176>>>>>          end_object
32177>>>>>          procedure initialize
32179>>>>>            local integer row# col# button_array#
32180>>>>>            move (btn_array(current_object)) to button_array#
32181>>>>>            for row# from 0 to 5
32187>>>>>>
32187>>>>>              for col# from 0 to 6
32193>>>>>>
32193>>>>>                object btn is a calendar.button
32195>>>>>                  set location to (row#*15) (col#*18)
32196>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32197>>>>>                  on_item "" send move_value_out_ok
32198>>>>>                end_object
32199>>>>>              loop
32200>>>>>>
32200>>>>>            loop
32201>>>>>>
32201>>>>>          end_procedure
32202>>>>>          send initialize
32203>>>>>
32203>>>>>          procedure display.iii integer itm# integer day# integer activate#
32205>>>>>            local integer obj# current_day#
32206>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32207>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32208>>>>>            if activate# begin
32210>>>>>              if day# eq current_day# send activate to obj#
32213>>>>>            end
32213>>>>>>
32213>>>>>            else begin
32214>>>>>              if day# begin
32216>>>>>                set value of obj# to day#
32217>>>>>                set visible_state of obj# to true
32218>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32219>>>>>              end
32219>>>>>>
32219>>>>>              else set visible_state of obj# to false
32221>>>>>            end
32221>>>>>>
32221>>>>>          end_procedure
32222>>>>>
32222>>>>>          procedure display integer activate#
32224>>>>>            local integer first_item# last_item# itm# day# date#
32225>>>>>            get p_current_date to date#
32226>>>>>            move (FirstDayInMonth(date#)) to date#
32227>>>>>            move (DateDayNumber(date#)-1) to first_item#
32228>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32229>>>>>            ifnot activate# begin
32231>>>>>              for itm# from 0 to (first_item#-1)
32237>>>>>>
32237>>>>>                send display.iii itm# 0 0
32238>>>>>              loop
32239>>>>>>
32239>>>>>            end
32239>>>>>>
32239>>>>>            move 1 to day#
32240>>>>>            for itm# from first_item# to last_item#
32246>>>>>>
32246>>>>>              send display.iii itm# day# activate#
32247>>>>>              increment day#
32248>>>>>            loop
32249>>>>>>
32249>>>>>            ifnot activate# begin
32251>>>>>              for itm# from (last_item#+1) to 41
32257>>>>>>
32257>>>>>                send display.iii itm# 0 0
32258>>>>>              loop
32259>>>>>>
32259>>>>>            end
32259>>>>>>
32259>>>>>          end_procedure
32260>>>>>        end_object
32261>>>>>        object txt_month is a calendar.textbox
32263>>>>>          set size to 12 27
32264>>>>>          set location to 25 185
32265>>>>>          set value to t.calendar.month
32266>>>>>        end_object
32267>>>>>        object btn1 is a button
32269>>>>>          set size to 12 12
32270>>>>>          set location to 40 185
32271>>>>>          on_item "" send prev_month
32272>>>>>          set bitmap to "prev.bmp"
32273>>>>>          procedure switch_back
32275>>>>>            send display_main
32276>>>>>          end_procedure
32277>>>>>        end_object
32278>>>>>        object btn2 is a button
32280>>>>>          set size to 12 12
32281>>>>>          set location to 40 200
32282>>>>>          on_item "" send next_month
32283>>>>>          set bitmap to "next.bmp"
32284>>>>>        end_object
32285>>>>>        object txt_year is a calendar.textbox
32287>>>>>          set size to 12 27
32288>>>>>          set location to 70 185
32289>>>>>          set value to t.calendar.year
32290>>>>>        end_object
32291>>>>>        object btn3 is a button
32293>>>>>          set size to 12 12
32294>>>>>          set location to 85 185
32295>>>>>          on_item "" send prev_year
32296>>>>>          set bitmap to "prev.bmp"
32297>>>>>        end_object
32298>>>>>        object btn4 is a button
32300>>>>>          set size to 12 12
32301>>>>>          set location to 85 200
32302>>>>>          on_item "" send next_year
32303>>>>>          set bitmap to "next.bmp"
32304>>>>>        end_object
32305>>>>>      end_object
32306>>>>>      object btn5 is a button
32308>>>>>        set size to 14 60
32309>>>>>        set location to 129 115
32310>>>>>        on_item t.calendar.ok send move_value_out_ok
32311>>>>>      end_object
32312>>>>>      object btn6 is a button
32314>>>>>        set size to 14 60
32315>>>>>        set location to 129 182
32316>>>>>        on_item t.calendar.cancel send cancel
32317>>>>>        procedure switch
32319>>>>>          send display_main
32320>>>>>        end_procedure
32321>>>>>      end_object
32322>>>>>      procedure next_year
32324>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32325>>>>>        send display_main
32326>>>>>      end_procedure
32327>>>>>      procedure prev_year
32329>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32330>>>>>        send display_main
32331>>>>>      end_procedure
32332>>>>>      procedure next_month
32334>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32335>>>>>        send display_main
32336>>>>>      end_procedure
32337>>>>>      procedure prev_month
32339>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32340>>>>>        send display_main
32341>>>>>      end_procedure
32342>>>>>      procedure next_week
32344>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32345>>>>>        send display_main
32346>>>>>      end_procedure
32347>>>>>      procedure prev_week
32349>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32350>>>>>        send display_main
32351>>>>>      end_procedure
32352>>>>>      procedure next_day
32354>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32355>>>>>        send display_main
32356>>>>>      end_procedure
32357>>>>>      procedure prev_day
32359>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32360>>>>>        send display_main
32361>>>>>      end_procedure
32362>>>>>      procedure go_today
32364>>>>>        local date date#
32365>>>>>        sysdate4 date#
32366>>>>>        set p_current_date to date#
32367>>>>>        send display_main
32368>>>>>      end_procedure
32369>>>>>      property integer invoking_object_id public 0
32371>>>>>      procedure OnChange date date#
32373>>>>>        local integer focus# dm#
32374>>>>>        get invoking_object_id to focus#
32375>>>>>        if focus# gt desktop begin
32377>>>>>          get delegation_mode of focus# to dm#
32378>>>>>          set delegation_mode of focus# to no_delegate_or_error
32379>>>>>          send NotifyPopupCalendarChange to focus# date#
32380>>>>>          set delegation_mode of focus# to dm#
32381>>>>>        end
32381>>>>>>
32381>>>>>      end_procedure
32382>>>>>      procedure display
32384>>>>>        local integer date# month# year#
32385>>>>>        get p_current_date to date#
32386>>>>>        send OnChange date#
32387>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32388>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32389>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32391>>>>>          set p_current_year to year#
32392>>>>>          set p_current_month to month#
32393>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32394>>>>>          send display to (textbox_year(cont3d(current_object)))
32395>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32396>>>>>          send display to (days_grid(cont3d(current_object))) 0
32397>>>>>        end
32397>>>>>>
32397>>>>>      end_procedure
32398>>>>>      procedure display_main
32400>>>>>        send display
32401>>>>>        send display to (days_grid(cont3d(current_object))) 1
32402>>>>>      end_procedure
32403>>>>>      procedure popup_no_export
32405>>>>>        set pExportState to false
32406>>>>>        send popup
32407>>>>>        set pExportState to true
32408>>>>>      end_procedure
32409>>>>>
32409>>>>>      procedure popup_group
32411>>>>>        local integer focus#
32412>>>>>        local date date#
32412>>>>>        move (focus(desktop)) to focus#
32413>>>>>        set invoking_object_id to focus#
32414>>>>>        get value of focus# item current to date#
32415>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32418>>>>>        move (Date2to4(date#)) to date#
32419>>>>>        set p_current_date to date#
32420>>>>>        send display
32421>>>>>        forward send popup_group
32423>>>>>        send display to (days_grid(cont3d(current_object))) 1
32424>>>>>      end_procedure
32425>>>>>
32425>>>>>      procedure move_value_out
32427>>>>>        local integer focus# dm# margin# datatype#
32428>>>>>        if (pExportState(current_object)) begin
32430>>>>>          get invoking_object_id to focus#
32431>>>>>          if focus# gt desktop begin
32433>>>>>            get delegation_mode of focus# to dm#
32434>>>>>            set delegation_mode of focus# to no_delegate_or_error
32435>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32436>>>>>            get form_margin of focus# item current to margin#
32437>>>>>            get form_datatype of focus# item current to datatype#
32438>>>>>            set delegation_mode of focus# to dm#
32439>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32442>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32444>>>>>            set item_changed_state of focus# item current to true
32445>>>>>          end
32445>>>>>>
32445>>>>>        end
32445>>>>>>
32445>>>>>      end_procedure
32446>>>>>
32446>>>>>      procedure move_value_out_ok
32448>>>>>        send move_value_out
32449>>>>>        send deactivate
32450>>>>>      end_procedure
32451>>>>>
32451>>>>>      procedure request_popup
32453>>>>>        local integer focus# type# dm#
32454>>>>>        move (focus(desktop)) to focus#
32455>>>>>        if focus# gt desktop begin
32457>>>>>          get delegation_mode of focus# to dm#
32458>>>>>          set delegation_mode of focus# to no_delegate_or_error
32459>>>>>          get form_datatype of focus# item current to type#
32460>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32463>>>>>          set delegation_mode of focus# to dm#
32464>>>>>        end
32464>>>>>>
32464>>>>>      end_procedure
32465>>>>>    end_object
32466>>>>>  end_desktop_section
32468>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32468>>>>>  // substitute would become negative (because located on the desktop). This
32468>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32468>>>>>  procedure request_popup_calendar for BaseClass
32469>>>>>    send request_popup to (popup_calendar(current_object))
32470>>>>>  end_procedure
32471>>>>>  procedure popup_calendar_no_export
32472>>>>>    send popup_no_export to (popup_calendar(current_object))
32473>>>>>  end_procedure
32474>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32474>>>>>  procedure Add_Calendar_tbButton integer oTb#
32475>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32476>>>>>  end_procedure
32477>>>>> function s.calendar returns integer // Backwards compatible!!
32478>>>>>   function_return (popup_calendar(current_object))
32479>>>>> end_function
32480>>>>>
32480>>>>>// Karl,
32480>>>>>// Structure is as follows,
32480>>>>>//
32480>>>>>// //put this code in the top portion of the view code or in the program
32480>>>>>// code.
32480>>>>>//
32480>>>>>// Type SystemTime
32480>>>>>//   field SystemTime.iYear As Word
32480>>>>>//   field SystemTime.iMonth As Word
32480>>>>>//   field SystemTime.iDayOfWeek As Word
32480>>>>>//   field SystemTime.iDay As Word
32480>>>>>//   field SystemTime.iHour As Word
32480>>>>>//   field SystemTime.iMinute As Word
32480>>>>>//   field SystemTime.iSecond As Word
32480>>>>>//   field SystemTime.iMilliseconds As Word
32480>>>>>// End_Type
32480>>>>>//
32480>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32480>>>>>//
32480>>>>>// //put this code in an onClick or wherever
32480>>>>>// procedure onclick
32480>>>>>//   local integer iRetVal
32480>>>>>//   local string TimeData
32480>>>>>//   local pointer GST
32480>>>>>//
32480>>>>>//   ZeroType SystemTime to TimeData
32480>>>>>//   getAddress from TimeData to GST
32480>>>>>//
32480>>>>>//   move (GetSystemTime(GST)) to iRetVal
32480>>>>>// end_procedure
32480>>>>>//
32480>>>>>// To extract the data from the Structure after calling the function use
32480>>>>>// the getbuff command as follows:
32480>>>>>//
32480>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32480>>>>>//
32480>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32480>>>>>//
32480>>>>>// OLIVER NELSON
32480>>>>>//
32480>>>>>//
32480>>>
32480>>>//AB-StoreTopEnd
32480>>>
32480>>>//AB-IgnoreStart
32480>>>
32480>>>Use DFAllEnt.pkg
32480>>>
32480>>>
32480>>>//AB-IgnoreEnd
32480>>>
32480>>>CD_Popup_Object oCalendar is a dbModalPanel
32499>>>
32499>>>    //AB-StoreTopStart
32499>>>    on_key kcancel           send cancel
32500>>>    //AB-StoreTopEnd
32500>>>
32500>>>    Set Border_Style to Border_Normal
32501>>>    Set Caption_Bar to FALSE
32502>>>    Set Label to "Ÿ­¢ àì, 2001"
32503>>>    Set Size to 98 123
32504>>>    Set Location to 10 22
32505>>>    Set Color to clWhite
32506>>>
32506>>>    //AB-DDOStart
32506>>>
32506>>>
32506>>>    //AB-DDOEnd
32506>>>
32506>>>    Object Container3d1 is a Container3d
32508>>>        Set Size to 88 135
32509>>>        Set Location to -2 -1
32510>>>        Set Color to clWhite
32511>>>        Set Border_Style to Border_None
32512>>>        Object Grid2 is a Grid
32514>>>
32514>>>            //AB-StoreTopStart
32514>>>            property date    p_current_date     public 0
32516>>>            property integer p_current_year     public -1
32518>>>            property integer p_current_month    public -1
32520>>>            property integer p_selected_day     public -1
32522>>>            property integer pExportState       public 1
32524>>>            property integer invoking_object_id public 0
32526>>>            
32526>>>            Set Border_Style To BORDER_NONE
32527>>>            Set header_visible_state To False
32528>>>            set select_mode to no_select
32529>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32530>>>            
32530>>>            on_key Key_F1 Send Help
32531>>>            on_key key_ctrl+key_pgup send prev_year
32532>>>            on_key key_ctrl+key_pgdn send next_year
32533>>>            on_key          key_pgup send prev_month
32534>>>            on_key          key_pgdn send next_month
32535>>>            on_key key_enter         send move_value_out
32536>>>            on_key key_ctrl+key_d    send go_today
32537>>>            
32537>>>            //AB-StoreTopEnd
32537>>>
32537>>>            Set Color to clWhite
32538>>>            Set CurrentCellColor to clWhite
32539>>>            Set CurrentCellTextColor to clWhite
32540>>>            Set Size to 61 145
32541>>>            Set Location to 30 1
32542>>>            Set Resize_Column_state to FALSE
32543>>>
32543>>>            Set Line_Width to 7 0
32544>>>
32544>>>            Set Form_Width    item 0 to 18
32545>>>            Set Header_Label  item 0 to "­"
32546>>>            
32546>>>            Set Form_Width    item 1 to 18
32547>>>            Set Header_Label  item 1 to "‚â"
32548>>>            
32548>>>            Set Form_Width    item 2 to 18
32549>>>            Set Header_Label  item 2 to "‘à"
32550>>>            
32550>>>            Set Form_Width    item 3 to 18
32551>>>            Set Header_Label  item 3 to "—â"
32552>>>            
32552>>>            Set Form_Width    item 4 to 18
32553>>>            Set Header_Label  item 4 to "â"
32554>>>            
32554>>>            Set Form_Width    item 5 to 18
32555>>>            Set Header_Label  item 5 to "‘¡"
32556>>>            
32556>>>            Set Form_Width    item 6 to 18
32557>>>            Set Header_Label  item 6 to "‚á"
32558>>>            
32558>>>
32558>>>            //AB-StoreStart
32558>>>            
32558>>>            procedure go_today
32560>>>                Date date#
32561>>>                sysdate4 date#
32562>>>                set p_current_date to date#
32563>>>                Send Update_Calendar
32564>>>            end_procedure
32565>>>            
32565>>>            procedure next_month
32567>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32568>>>                Send Update_Calendar
32569>>>            end_procedure
32570>>>            
32570>>>            procedure prev_month
32572>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32573>>>                Send Update_Calendar
32574>>>            end_procedure
32575>>>            
32575>>>            procedure next_year
32577>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32578>>>                Send Update_Calendar
32579>>>            end_procedure
32580>>>            
32580>>>            procedure prev_year
32582>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32583>>>                Send Update_Calendar
32584>>>            end_procedure
32585>>>            
32585>>>            Procedure Activate
32587>>>                Date date#
32588>>>                Forward Send Activate
32590>>>                Set current_item to (p_selected_day(Self))
32591>>>            End_Procedure
32592>>>            
32592>>>            Procedure Update_Calendar
32594>>>                Set Dynamic_Update_State To False
32595>>>                send Fill_List
32596>>>                Set Dynamic_Update_State To True
32597>>>                // Send Update_Label
32597>>>                Set current_item to (p_selected_day(Self))
32598>>>                Send Date_Changing to (oYear(Container3d2(self)))
32599>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32600>>>            End_Procedure
32601>>>            
32601>>>            Procedure Fill_List
32603>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32604>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32604>>>                Date dToday
32604>>>                Send Delete_Data
32605>>>            
32605>>>                Get p_current_date to date#
32606>>>            
32606>>>                SysDate4 dToday
32607>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32608>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32609>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32610>>>            
32610>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32611>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32612>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32613>>>                Set p_current_month To sel_month#
32614>>>                Set p_current_year To sel_year#
32615>>>            
32615>>>                move (FirstDayInMonth(date#)) to date#
32616>>>                move (DateDayNumber(date#)-1) to first_item#
32617>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32618>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32619>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32620>>>            
32620>>>                If (first_item# > 0) Begin
32622>>>                    Move (first_item#-1) to day#
32623>>>                    For iFor from 0 to (first_item#-1)
32629>>>>
32629>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32630>>>                        Set Entry_State Item iFor To False
32631>>>                        Set ItemTextColor Item iFor To clGray
32632>>>                        Decrement day#
32633>>>                    Loop
32634>>>>
32634>>>                End
32634>>>>
32634>>>            
32634>>>                Move 1 To day#
32635>>>                For iFor from first_item# to last_item#
32641>>>>
32641>>>                    Send Add_Item Msg_Move_Value_Out day#
32642>>>                    Set Entry_State Item iFor To False
32643>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32646>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32649>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32650>>>                    Set form_datatype item iFor To mask_numeric_window
32651>>>                    Set form_Mask item iFor To "## "
32652>>>                    Increment day#
32653>>>                Loop
32654>>>>
32654>>>            
32654>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32655>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32656>>>            
32656>>>                If (last_item# < 41) Begin
32658>>>                    Move 1 to day#
32659>>>                    For iFor from (last_item#+1) to 41
32665>>>>
32665>>>                        Send Add_Item msg_move_value_out day#
32666>>>                        Set Entry_State Item iFor To False
32667>>>                        Set ItemTextColor Item iFor To clGray
32668>>>                        Increment day#
32669>>>                    Loop
32670>>>>
32670>>>                End
32670>>>>
32670>>>            
32670>>>            End_Procedure
32671>>>            
32671>>>            Procedure Help
32673>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32674>>>            End_Procedure
32675>>>            
32675>>>            procedure mouse_click integer window integer char_pos
32677>>>                Send Move_Value_Out
32678>>>                forward send mouse_click window char_pos
32680>>>            end_procedure
32681>>>            
32681>>>            Procedure Move_Value_Out
32683>>>                Integer iYear iMonth iDay iItm
32684>>>                Date Date# next_date# prev_date#
32684>>>                Get Current_Item To iItm
32685>>>                If (pExportState(Self)) Begin
32687>>>                    Get Value Item iItm To iDay
32688>>>                    Get p_current_month to iMonth
32689>>>                    Get p_current_year  to iYear
32690>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32691>>>            
32691>>>                    If ((iItm>27)and(iDay<15)) Begin
32693>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32694>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32695>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32696>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32697>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32698>>>                    End
32698>>>>
32698>>>                    If ((iItm<7)and(iDay>20)) Begin
32700>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32701>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32702>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32703>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32704>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32705>>>                    End
32705>>>>
32705>>>            
32705>>>                    Send Export_Date date#
32706>>>                End
32706>>>>
32706>>>            End_Procedure
32707>>>            
32707>>>            Procedure Export_Date date date#
32709>>>                local integer focus# dm# margin# datatype#
32710>>>                get invoking_object_id to focus#
32711>>>            
32711>>>                if focus# gt desktop begin
32713>>>                     get delegation_mode of focus# to dm#
32714>>>                     set delegation_mode of focus# to no_delegate_or_error
32715>>>                     get form_margin of focus# item current to margin#
32716>>>                     get form_datatype of focus# item current to datatype#
32717>>>                     set delegation_mode of focus# to dm#
32718>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32721>>>                     else             set value of focus# item current to (Date4to2(date#))
32723>>>                     set item_changed_state of focus# item current to true
32724>>>                end
32724>>>>
32724>>>                Send Close_Calendar
32725>>>            End_Procedure
32726>>>            //AB-StoreEnd
32726>>>
32726>>>        End_Object    // Grid2
32727>>>
32727>>>        Object Textbox2 is a Textbox
32729>>>            Set Label to "­"
32730>>>            Set Auto_Size_State to FALSE
32731>>>            Set Transparent_State to TRUE
32732>>>            Set Color to clWhite
32733>>>            Set TextColor to clNavy
32734>>>            Set Location to 19 4
32735>>>            Set Size to 10 15
32736>>>
32736>>>            //AB-StoreStart
32736>>>                                        
32736>>>            Set Label To (left(t.calendar.Monday,2))
32737>>>            //AB-StoreEnd
32737>>>
32737>>>        End_Object    // Textbox2
32738>>>
32738>>>        Object Textbox3 is a Textbox
32740>>>            Set Label to "‚â"
32741>>>            Set Auto_Size_State to FALSE
32742>>>            Set Transparent_State to TRUE
32743>>>            Set Color to clWhite
32744>>>            Set TextColor to clNavy
32745>>>            Set Location to 19 22
32746>>>            Set Size to 10 12
32747>>>
32747>>>            //AB-StoreStart
32747>>>                                        
32747>>>            Set Label To (left(t.calendar.Tuesday,2))
32748>>>            //AB-StoreEnd
32748>>>
32748>>>        End_Object    // Textbox3
32749>>>
32749>>>        Object Textbox4 is a Textbox
32751>>>            Set Label to "‘à"
32752>>>            Set Auto_Size_State to FALSE
32753>>>            Set Transparent_State to TRUE
32754>>>            Set Color to clWhite
32755>>>            Set TextColor to clNavy
32756>>>            Set Location to 19 39
32757>>>            Set Size to 10 15
32758>>>
32758>>>            //AB-StoreStart
32758>>>                                        
32758>>>            Set Label To (left(t.calendar.Wednesday,2))
32759>>>            //AB-StoreEnd
32759>>>
32759>>>        End_Object    // Textbox4
32760>>>
32760>>>        Object Textbox5 is a Textbox
32762>>>            Set Label to "—â"
32763>>>            Set Auto_Size_State to FALSE
32764>>>            Set Transparent_State to TRUE
32765>>>            Set Color to clWhite
32766>>>            Set TextColor to clNavy
32767>>>            Set Location to 19 57
32768>>>            Set Size to 10 17
32769>>>
32769>>>            //AB-StoreStart
32769>>>                                        
32769>>>            Set Label To (left(t.calendar.Thursday,2))
32770>>>            //AB-StoreEnd
32770>>>
32770>>>        End_Object    // Textbox5
32771>>>
32771>>>        Object Textbox6 is a Textbox
32773>>>            Set Label to "â"
32774>>>            Set Auto_Size_State to FALSE
32775>>>            Set Transparent_State to TRUE
32776>>>            Set Color to clWhite
32777>>>            Set TextColor to clNavy
32778>>>            Set Location to 19 76
32779>>>            Set Size to 10 17
32780>>>
32780>>>            //AB-StoreStart
32780>>>                                        
32780>>>            Set Label To (left(t.calendar.Friday,2))
32781>>>            //AB-StoreEnd
32781>>>
32781>>>        End_Object    // Textbox6
32782>>>
32782>>>        Object Textbox7 is a Textbox
32784>>>            Set Label to "‘¡"
32785>>>            Set Auto_Size_State to FALSE
32786>>>            Set Transparent_State to TRUE
32787>>>            Set Color to clWhite
32788>>>            Set TextColor to clNavy
32789>>>            Set Location to 19 91
32790>>>            Set Size to 10 18
32791>>>
32791>>>            //AB-StoreStart
32791>>>                                        
32791>>>            Set Label To (left(t.calendar.Saturday,2))
32792>>>            //AB-StoreEnd
32792>>>
32792>>>        End_Object    // Textbox7
32793>>>
32793>>>        Object Textbox8 is a Textbox
32795>>>            Set Label to "‚á"
32796>>>            Set Auto_Size_State to FALSE
32797>>>            Set Transparent_State to TRUE
32798>>>            Set Color to clWhite
32799>>>            Set TextColor to clNavy
32800>>>            Set Location to 19 109
32801>>>            Set Size to 10 17
32802>>>
32802>>>            //AB-StoreStart
32802>>>                                        
32802>>>            Set Label To (left(t.calendar.Sunday,2))
32803>>>            //AB-StoreEnd
32803>>>
32803>>>        End_Object    // Textbox8
32804>>>
32804>>>        Object LineControl1 is a LineControl
32806>>>            Set Line_Style to lnSINGLE
32807>>>            Set Size to 1 116
32808>>>            Set Location to 28 4
32809>>>
32809>>>            //AB-StoreStart
32809>>>                                        
32809>>>            //AB-StoreEnd
32809>>>
32809>>>        End_Object    // LineControl1
32810>>>
32810>>>        Object Container3d2 is a Container3d
32812>>>            Set Size to 18 131
32813>>>            Set Location to 1 1
32814>>>            Set Color to clNavy
32815>>>            Set Border_Style to Border_None
32816>>>            Object oRght is a BitmapContainer
32818>>>                Set Size to 10 14
32819>>>                Set Location to 4 105
32820>>>                Set Bitmap to "rght.bmp"
32821>>>                Set Border_Style to Border_None
32822>>>
32822>>>                //AB-StoreStart
32822>>>                Procedure Mouse_Down
32824>>>                    Send Next_Month to Grid2
32825>>>                End_Procedure
32826>>>                //AB-StoreEnd
32826>>>
32826>>>            End_Object    // oRght
32827>>>
32827>>>            Object oLeft is a BitmapContainer
32829>>>                Set Size to 10 14
32830>>>                Set Location to 4 3
32831>>>                Set Bitmap to "lft.bmp"
32832>>>                Set Border_Style to Border_None
32833>>>
32833>>>                //AB-StoreStart
32833>>>                Procedure Mouse_Down
32835>>>                    Send Prev_Month to Grid2
32836>>>                End_Procedure
32837>>>                //AB-StoreEnd
32837>>>
32837>>>            End_Object    // oLeft
32838>>>
32838>>>            Object oMonth is a Textbox
32840>>>
32840>>>                //AB-StoreTopStart
32840>>>                Property integer piSelected_Month public 0
32842>>>                //AB-StoreTopEnd
32842>>>
32842>>>                Set Label to "January"
32843>>>                Set Auto_Size_State to FALSE
32844>>>                Set Transparent_State to TRUE
32845>>>                Set Color to clWhite
32846>>>                Set TextColor to clWhite
32847>>>                Set Location to 4 23
32848>>>                Set Size to 10 43
32849>>>                Set FontWeight to 800
32850>>>                Set Justification_Mode to jMode_Center
32851>>>
32851>>>                //AB-StoreStart
32851>>>                                    
32851>>>                Procedure Mouse_Down
32853>>>                    Integer iState
32854>>>                    Get Visible_State of oSelectYear to iState
32855>>>                    If (iState) Send OnKillFocus to oSelectYear
32858>>>                    Send Popup to oSelectMonth
32859>>>                End_Procedure
32860>>>                
32860>>>                Procedure pSelectJan
32862>>>                    Set Label to t.calendar.january
32863>>>                    Set piSelected_Month to 1
32864>>>                    Send Adjust_Calendar
32865>>>                End_Procedure
32866>>>                Procedure pSelectFeb
32868>>>                    Set Label to t.calendar.february
32869>>>                    Set piSelected_Month to 2
32870>>>                    Send Adjust_Calendar
32871>>>                End_Procedure
32872>>>                Procedure pSelectMar
32874>>>                    Set Label to t.calendar.march
32875>>>                    Set piSelected_Month to 3
32876>>>                    Send Adjust_Calendar
32877>>>                End_Procedure
32878>>>                Procedure pSelectApr
32880>>>                    Set Label to t.calendar.april
32881>>>                    Set piSelected_Month to 4
32882>>>                    Send Adjust_Calendar
32883>>>                End_Procedure
32884>>>                Procedure pSelectMay
32886>>>                    Set Label to t.calendar.may
32887>>>                    Set piSelected_Month to 5
32888>>>                    Send Adjust_Calendar
32889>>>                End_Procedure
32890>>>                Procedure pSelectJun
32892>>>                    Set Label to t.calendar.june
32893>>>                    Set piSelected_Month to 6
32894>>>                    Send Adjust_Calendar
32895>>>                End_Procedure
32896>>>                Procedure pSelectJul
32898>>>                    Set Label to t.calendar.july
32899>>>                    Set piSelected_Month to 7
32900>>>                    Send Adjust_Calendar
32901>>>                End_Procedure
32902>>>                Procedure pSelectAug
32904>>>                    Set Label to t.calendar.august
32905>>>                    Set piSelected_Month to 8
32906>>>                    Send Adjust_Calendar
32907>>>                End_Procedure
32908>>>                Procedure pSelectSep
32910>>>                    Set Label to t.calendar.september
32911>>>                    Set piSelected_Month to 9
32912>>>                    Send Adjust_Calendar
32913>>>                End_Procedure
32914>>>                Procedure pSelectOct
32916>>>                    Set Label to t.calendar.october
32917>>>                    Set piSelected_Month to 10
32918>>>                    Send Adjust_Calendar
32919>>>                End_Procedure
32920>>>                Procedure pSelectNov
32922>>>                    Set Label to t.calendar.november
32923>>>                    Set piSelected_Month to 11
32924>>>                    Send Adjust_Calendar
32925>>>                End_Procedure
32926>>>                Procedure pSelectDec
32928>>>                    Set Label to t.calendar.december
32929>>>                    Set piSelected_Month to 12
32930>>>                    Send Adjust_Calendar
32931>>>                End_Procedure
32932>>>                
32932>>>                Object oSelectMonth is a FloatingPopupMenu
32934>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32935>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32936>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32937>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32938>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32939>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32940>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32941>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32942>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32943>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32944>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32945>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32946>>>                End_Object
32947>>>                
32947>>>                Procedure Adjust_Calendar
32949>>>                    Date date#
32950>>>                    Integer iDay iMonth iYear iItm
32950>>>                    Set Visible_State to false
32951>>>                    Set Visible_State to true
32952>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32953>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32954>>>                    Get piSelected_Month to iMonth
32955>>>                    Get Label of oYear to iYear
32956>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32957>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32958>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32959>>>                End_Procedure
32960>>>                
32960>>>                Procedure Activating
32962>>>                    Forward Send Activating
32964>>>                    Send Date_Changing
32965>>>                End_Procedure
32966>>>                
32966>>>                Procedure Date_Changing
32968>>>                    Set Visible_State to false
32969>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32970>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32971>>>                    Set Visible_State to true
32972>>>                End_Procedure
32973>>>                
32973>>>                
32973>>>                //AB-StoreEnd
32973>>>
32973>>>            End_Object    // oMonth
32974>>>
32974>>>            Object oYear is a Textbox
32976>>>                Set Label to "2001"
32977>>>                Set Transparent_State to TRUE
32978>>>                Set Color to clWhite
32979>>>                Set TextColor to clWhite
32980>>>                Set Location to 4 77
32981>>>                Set Size to 10 18
32982>>>                Set FontWeight to 800
32983>>>
32983>>>                //AB-StoreStart
32983>>>                                                    
32983>>>                Procedure Mouse_Down
32985>>>                    String sVal
32986>>>                    Get Label to sVal
32987>>>                    Set Value of oSelectYear item 0 to sVal
32988>>>                    Set Visible_State of oSelectYear to True
32989>>>                    Send Activate to (oSelectYear(Self))
32990>>>                End_Procedure
32991>>>                
32991>>>                Procedure Activating
32993>>>                    Forward Send Activating
32995>>>                    Send Date_Changing
32996>>>                End_Procedure
32997>>>                
32997>>>                Procedure Date_Changing
32999>>>                    Set Visible_State to false
33000>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
33001>>>                    Set Visible_State to true
33002>>>                End_Procedure
33003>>>                //AB-StoreEnd
33003>>>
33003>>>            End_Object    // oYear
33004>>>
33004>>>            Object oSelectYear is a Form
33006>>>
33006>>>                //AB-StoreTopStart
33006>>>                Set Visible_State To False
33007>>>                //AB-StoreTopEnd
33007>>>
33007>>>                Set Size to 10 24
33008>>>                Set Location to 4 75
33009>>>                Set Color to clWhite
33010>>>                Set TextColor to clNavy
33011>>>                Set Form_Border Item 0 to Border_Normal
33012>>>
33012>>>                //AB-StoreStart
33012>>>                                                    
33012>>>                On_Key Key_Enter Send OnKillFocus
33013>>>                On_Key Key_Escape Send OnKillFocus
33014>>>                
33014>>>                Procedure SetFontWeight
33016>>>                    Set Form_FontWeight item 0 to 800
33017>>>                End_Procedure
33018>>>                
33018>>>                Procedure OnKillFocus
33020>>>                    String sVal
33021>>>                    Integer iMonth iDay iYear iItm
33021>>>                    Date date#
33021>>>                    Get Value item 0 to sVal
33022>>>                    Set Visible_State of oYear to false
33023>>>                    Set Label of oYear to sVal
33024>>>                    Set Visible_State of oYear to true
33025>>>                    Set Visible_State to false
33026>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
33027>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
33028>>>                    Get piSelected_Month of oMonth to iMonth
33029>>>                    Get Value item 0 to iYear
33030>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
33031>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
33032>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
33033>>>                End_Procedure
33034>>>                
33034>>>                Send SetFontWeight
33035>>>                //AB-StoreEnd
33035>>>
33035>>>            End_Object    // oSelectYear
33036>>>
33036>>>
33036>>>            //AB-StoreStart
33036>>>                            
33036>>>            Procedure Mouse_Down
33038>>>                Integer iState
33039>>>                Get Visible_State of oSelectYear to iState
33040>>>                If (iState) Send OnKillFocus to oSelectYear
33043>>>            End_Procedure
33044>>>            
33044>>>            //AB-StoreEnd
33044>>>
33044>>>        End_Object    // Container3d2
33045>>>
33045>>>
33045>>>        //AB-StoreStart
33045>>>                            
33045>>>        //AB-StoreEnd
33045>>>
33045>>>    End_Object    // Container3d1
33046>>>
33046>>>    Object BitmapContainer3 is a BitmapContainer
33048>>>        Set Size to 9 19
33049>>>        Set Location to 88 3
33050>>>        Set Color to clWhite
33051>>>        Set Bitmap to "cdate.bmp"
33052>>>        Set Border_Style to Border_None
33053>>>
33053>>>        //AB-StoreStart
33053>>>        Procedure Mouse_Down
33055>>>            Send go_today to (Grid2(Container3d1(Self)))
33056>>>            Send Adjust_Label to oToday
33057>>>        End_Procedure
33058>>>        //AB-StoreEnd
33058>>>
33058>>>    End_Object    // BitmapContainer3
33059>>>
33059>>>    Object oToday is a Textbox
33061>>>        Set Label to "Today: 01.01.2001"
33062>>>        Set Auto_Size_State to FALSE
33063>>>        Set Color to clWhite
33064>>>        Set Location to 88 22
33065>>>        Set Size to 8 73
33066>>>        Set FontWeight to 800
33067>>>
33067>>>        //AB-StoreStart
33067>>>        Procedure Mouse_Down
33069>>>            Send go_today to (Grid2(Container3d1(Self)))
33070>>>            Send Adjust_Label
33071>>>        End_Procedure
33072>>>        
33072>>>        Procedure Adjust_Label
33074>>>            date date#
33075>>>            SysDate4 date#
33076>>>            Set Visible_State To false
33077>>>            Set Label         to (t.calendar.today+": "+String(date#))
33078>>>            Set Visible_State To true
33079>>>        End_Procedure
33080>>>        
33080>>>        Procedure Activating
33082>>>            Forward Send Activating
33084>>>            Send Adjust_Label
33085>>>        End_Procedure
33086>>>        //AB-StoreEnd
33086>>>
33086>>>    End_Object    // oToday
33087>>>
33087>>>
33087>>>    //AB-StoreStart
33087>>>                
33087>>>    procedure popup
33089>>>        local integer focus# icItm iYear iMonth
33090>>>        local date date#
33090>>>        move (focus(desktop)) to focus#
33091>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
33092>>>        get value of focus# item current to date#
33093>>>        ifnot (integer(date#)) sysdate date#
33096>>>        move (Date2to4(date#)) to date#
33097>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
33098>>>        send fill_list to (Grid2(Container3d1(self)))
33099>>>        move (DateSegment(date#,DS_YEAR)) to iYear
33100>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
33101>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
33102>>>        forward send popup
33104>>>    end_procedure
33105>>>    
33105>>>    Procedure Close_Calendar
33107>>>        Send Exit
33108>>>    End_Procedure
33109>>>    //AB-StoreEnd
33109>>>
33109>>>CD_End_Object    // oCalendar
33111>>>>
33111>>>
33111>>>
33111>>>//AB-StoreStart
33111>>>    
33111>>>    
33111>>>//AB-StoreEnd
33111>>>
33111>>>//AB/ End_Object    // prj
33111>Use Dates.Utl
33111>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
33111>>>// ===========================================================================
33111>>>//
33111>>>// The ROUND_NUMBER global function has been designed to return the rounded
33111>>>// value of a given 'numeric' argument at a specified rounding precision.
33111>>>//
33111>>>// ---------------------------------------------------------------------------
33111>>>// This version dispenses with the use of powers (10 ^ n) to perform the
33111>>>// necessary calculations.  It uses a string handling technique instead.
33111>>>// ---------------------------------------------------------------------------
33111>>>//
33111>>>// The function requires two arguments, as follows:-
33111>>>//
33111>>>// (a) The numeric value to be rounded, where the range of valid values is
33111>>>//     +/- 99,999,999,999,999.99999999.
33111>>>//
33111>>>// (b) The rounding precision required.  This must be an integer value in the
33111>>>//     range -13 to +8.  If a value outside this range is used, the nearest
33111>>>//     threshold value is substituted.
33111>>>//
33111>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
33111>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
33111>>>//     value will round to the nearest whole number.  Values -1 to -13 will
33111>>>//     round progressively to the left of the decimal point (a frequent
33111>>>//     requirement in financial reporting).
33111>>>//
33111>>>// If the result of the rounding produces a value outside the valid numeric
33111>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
33111>>>//
33111>>>// Assumptions:-  The only assumptions made have been that the range of
33111>>>// numeric values and the limit of eight decimal places are unlikely to change
33111>>>// in the forseeable future.
33111>>>//
33111>>>// Examples:-
33111>>>//
33111>>>//  1st Argument      2nd Argument   Return Value
33111>>>//  ------------      ------------   ------------
33111>>>//  123456.87654321         8         123456.87654321
33111>>>//  123456.87654321         2         123456.88
33111>>>// -123456.87654321         2        -123456.88
33111>>>//  123456.98765432         0         123457
33111>>>// -123456.98765432        -1        -123460
33111>>>//  123456.98765432        -2         123500
33111>>>//  123456.98765432        -3         123000
33111>>>//  987654                 -4         990000
33111>>>//  987654                 -5        1000000
33111>>>//  987654                 -6        1000000
33111>>>//  987654                 -7              0
33111>>>//
33111>>>// ===========================================================================
33111>>>
33111>>>
33111>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
33112>>>
33112>>>  Local Number nAdj
33113>>>
33113>>>  Move 10000000000000 to nAdj
33114>>>
33114>>>  // If the rounding precision falls in the range 0 to 8, then return:-
33114>>>
33114>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
33117>>>
33117>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
33117>>>
33117>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
33120>>>
33120>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
33120>>>
33120>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
33121>>>
33121>>>End_Function
33122>
33122>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
33122>>>
33122>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
33122>>>>>
33122>>>>>Open Users
33124>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
33126>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
33128>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
33130>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
33132>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
33134>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
33136>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
33138>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
33140>>>>>Open Oth
INCLUDING FILE: OTH.FD
33142>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
33144>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
33146>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
33148>>>>>
33148>>>>>
33148>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33149>>>>>
33149>>>>>Function Network_User_Name Returns String
33150>>>>>    Local String sName sLength
33151>>>>>    Local Pointer lpName_Addr lpLength_Addr
33151>>>>>    Local Integer iRetval
33151>>>>>    Movestr (Repeat (Character (0), 255)) To sName
33152>>>>>>
33152>>>>>    GetAddress Of sName To lpName_Addr
33153>>>>>    Movestr (DwordToBytes (255)) To sLength
33154>>>>>>
33154>>>>>    GetAddress Of sLength To lpLength_Addr
33155>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33156>>>>>>
33156>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
33159>>>>>    Else Function_Return "User Unknown"
33161>>>>>End_Function // Network_User_Name
33162>>>>>
33162>>>>>Function fsGetOfficePath Global Returns String
33163>>>>>    String sRegistryKeyPath sRegOfficePath
33164>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
33165>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
33166>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
33170>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
33171>>>>>    If (sRegOfficePath='') Begin
33173>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
33174>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33178>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33179>>>>>        If (sRegOfficePath='') Begin
33181>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
33182>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33186>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33187>>>>>            If (sRegOfficePath='') Begin
33189>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
33190>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33194>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33195>>>>>            End
33195>>>>>>
33195>>>>>        End
33195>>>>>>
33195>>>>>    End
33195>>>>>>
33195>>>>>    Function_Return sRegOfficePath
33196>>>>>End_Procedure
33197>>>>>
33197>>>>>
33197>>>>>Function fsGetLastDir Global Returns String
33198>>>>>    String sRegistryKeyPath sRegDir sUserName
33199>>>>>    Get Network_User_Name to sUserName
33200>>>>>
33200>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33203>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33206>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33208>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33210>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33211>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33212>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
33215>>>>>    Function_Return sRegDir
33216>>>>>End_Procedure
33217>>>>>
33217>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
33218>>>>>    String sRegistryKeyPath sRegDir sUserName
33219>>>>>    Get Network_User_Name to sUserName
33220>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33223>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33226>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33228>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33230>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33231>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33232>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
33235>>>>>    Function_Return 0
33236>>>>>End_Procedure
33237>>>>>
33237>>>>>
33237>>>>>Function fsVresExt Global String asFileName Returns String
33238>>>>>    String rVal
33239>>>>>    Integer iPos iLen
33239>>>>>    Move (UpperCase(asFileName)) to asFileName
33240>>>>>    Move (Trim(asFileName)) to asFileName
33241>>>>>    Move 0 to iPos
33242>>>>>    For iLen from 1 to (length(asFileName))
33248>>>>>>
33248>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
33251>>>>>    Loop
33252>>>>>>
33252>>>>>    If (Not(iPos)) Function_Return ''
33255>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
33256>>>>>    Move (Trim(rVal)) to rVal
33257>>>>>    Function_Return rVal
33258>>>>>End_Function
33259>>>>>
33259>>>>>
33259>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
33260>>>>>    Integer rVal iUser iGroup
33261>>>>>    String  sUser sRecr
33261>>>>>    Move (Trim(asViewName))     to asViewName
33262>>>>>    Move (Trim(asDbFormName))   to asDbFormName
33263>>>>>
33263>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
33265>>>>>        Get fsLoginUserID to sUser
33266>>>>>        Clear Users
33267>>>>>        Move sUser        to Users.Login_ID
33268>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33269>>>>>>
33269>>>>>        If (Found=1) Begin
33271>>>>>            Move Users.User_ID  to iUser
33272>>>>>            Move Users.Grp_ID   to iGroup
33273>>>>>            Clear GrpOth
33274>>>>>            Move iUser          to GrpOth.User_ID
33275>>>>>            Move asViewName     to GrpOth.View_Name
33276>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
33277>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
33278>>>>>>
33278>>>>>            If (Found=1) Begin
33280>>>>>                // rVal=1 ==> NO READ ALLOWED
33280>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
33280>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
33280>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
33283>>>>>                Else Begin
33284>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
33286>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
33289>>>>>                        Else                        Move 2 to rVal
33291>>>>>                    End
33291>>>>>>
33291>>>>>                End
33291>>>>>>
33291>>>>>            End
33291>>>>>>
33291>>>>>            Else Begin
33292>>>>>                Clear GrpOth0
33293>>>>>                Move iGroup         to GrpOth0.Group_ID
33294>>>>>                Move asViewName     to GrpOth0.View_Name
33295>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
33296>>>>>
33296>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
33297>>>>>>
33297>>>>>                If (Found=1) Begin
33299>>>>>                    // rVal=1 ==> NO READ ALLOWED
33299>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33299>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33299>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
33302>>>>>                    Else Begin
33303>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
33305>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
33308>>>>>                            Else                         Move 2 to rVal
33310>>>>>                        End
33310>>>>>>
33310>>>>>                    End
33310>>>>>>
33310>>>>>                End
33310>>>>>>
33310>>>>>                Else Move 0 to rVal
33312>>>>>            End
33312>>>>>>
33312>>>>>        End
33312>>>>>>
33312>>>>>        Else Move 0 to rVal
33314>>>>>    End
33314>>>>>>
33314>>>>>    Function_Return rVal
33315>>>>>End_Function
33316>>>>>
33316>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
33317>>>>>    Integer rVal iUser iGroup
33318>>>>>    String  sUser sRecr
33318>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
33320>>>>>        Get fsLoginUserID to sUser
33321>>>>>        Clear Users
33322>>>>>        Move sUser        to Users.Login_ID
33323>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33324>>>>>>
33324>>>>>        If (Found=1) Begin
33326>>>>>            Move Users.User_ID  to iUser
33327>>>>>            Move Users.Grp_ID   to iGroup
33328>>>>>            Clear Pedia
33329>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
33330>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
33331>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
33332>>>>>>
33332>>>>>            If (Found=1) Begin
33334>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
33335>>>>>                // Find Combination User/File/Field in GRPPEDIA
33335>>>>>                Clear GrpPedia
33336>>>>>                Move iUser                      to GrpPedia.User_ID
33337>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
33338>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
33339>>>>>>
33339>>>>>                If (Found=1) Begin
33341>>>>>                    // rVal=1 ==> NO READ ALLOWED
33341>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33341>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33341>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
33344>>>>>                    Else Begin
33345>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
33347>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
33350>>>>>                            Else                            Move 2 to rVal
33352>>>>>                        End
33352>>>>>>
33352>>>>>                    End
33352>>>>>>
33352>>>>>                End
33352>>>>>>
33352>>>>>                Else Begin
33353>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
33353>>>>>                    Clear GrpPed0
33354>>>>>                    Move iGroup         to GrpPed0.Group_ID
33355>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
33356>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
33357>>>>>>
33357>>>>>                    If (Found=1) Begin
33359>>>>>                        // rVal=1 ==> NO READ ALLOWED
33359>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
33359>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
33359>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
33362>>>>>                        Else Begin
33363>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
33365>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
33368>>>>>                                Else                           Move 2 to rVal
33370>>>>>                            End
33370>>>>>>
33370>>>>>                        End
33370>>>>>>
33370>>>>>                    End
33370>>>>>>
33370>>>>>                End
33370>>>>>>
33370>>>>>            End
33370>>>>>>
33370>>>>>            Else Begin
33371>>>>>                Move 0 to rVal
33372>>>>>            End
33372>>>>>>
33372>>>>>        End
33372>>>>>>
33372>>>>>        Else Begin
33373>>>>>            Move 0 to rVal
33374>>>>>        End
33374>>>>>>
33374>>>>>    End
33374>>>>>>
33374>>>>>    Function_Return rVal
33375>>>>>End_Function
33376>>>>>
33376>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
33377>>>>>    String rVal lsDirSep
33378>>>>>    Integer iPos iMet iLen iCnt
33378>>>>>    Move (Trim(asFullPath))                 To rVal
33379>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
33380>>>>>    If (rVal Contains lsDirSep) Begin
33382>>>>>        Move (Length(rVal)) to iLen
33383>>>>>        Move iLen to iCnt
33384>>>>>        While iCnt Gt 0
33388>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
33390>>>>>                If (iCnt=iLen) Function_Return asFullPath
33393>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
33395>>>>>            End
33395>>>>>>
33395>>>>>            Decrement iCnt
33396>>>>>        End // While iCnt Gt 0
33397>>>>>>
33397>>>>>    End
33397>>>>>>
33397>>>>>    Else  Function_Return (Trim(asFullPath))
33399>>>>>    Function_Return rVal
33400>>>>>End_Function
33401>>>>>
33401>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
33402>>>>>    String rVal lsDirSep
33403>>>>>    Integer iPos iMet iLen iCnt
33403>>>>>    Move (Trim(asFullPath))                 To rVal
33404>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
33405>>>>>    If (rVal Contains lsDirSep) Begin
33407>>>>>        Move (Length(rVal)) to iLen
33408>>>>>        Move iLen to iCnt
33409>>>>>        While iCnt Gt 0
33413>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
33416>>>>>            Decrement iCnt
33417>>>>>        End // While iCnt Gt 0
33418>>>>>>
33418>>>>>    End
33418>>>>>>
33418>>>>>    Function_Return rVal
33419>>>>>End_Function
33420>>>>>
33420>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
33420>>>>>//    Local String rVal lsTmp lsOO lsLL
33420>>>>>//    Local Number lnOO lnLL
33420>>>>>
33420>>>>>//    Move '' to lsOO
33420>>>>>//    Move '' to lsLL
33420>>>>>//    Move '' to rVal
33420>>>>>
33420>>>>>//    Move (Integer(anTime))                              to lnOO
33420>>>>>//    ////////////////////////////////////////////
33420>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
33420>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
33420>>>>>//    ////////////////////////////////////////////
33420>>>>>
33420>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
33420>>>>>
33420>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
33420>>>>>//    Else         Move (String(lnOO))                    to lsOO
33420>>>>>//    Move (Trim(lsOO))                                   to lsOO
33420>>>>>
33420>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
33420>>>>>//    Else         Move (String(lnLL))                    to lsLL
33420>>>>>//    Move (Trim(lsLL))                                   to lsLL
33420>>>>>
33420>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
33420>>>>>
33420>>>>>//    Move (Trim(rVal)) to rVal
33420>>>>>
33420>>>>>//    Function_Return rVal
33420>>>>>//End_Function
33420>>>>>
33420>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
33420>>>>>//    Local Number rVal nOres nLepta
33420>>>>>//    Move (Integer(aiMinutes/60))    to nOres
33420>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
33420>>>>>//    Move (nOres+(nLepta/100))       to rVal
33420>>>>>//    Function_Return rVal
33420>>>>>//End_Function
33420>>>>>
33420>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
33420>>>>>//    Local Integer rVal
33420>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
33420>>>>>//    Function_Return rVal
33420>>>>>//End_Function
33420>>>>>
33420>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
33420>>>>>//                                                                    Number anEndTime    ;
33420>>>>>//                                                                    Returns Integer
33420>>>>>//    Local Integer rVal iMinStart iMinEnd
33420>>>>>
33420>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33420>>>>>
33420>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
33420>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
33420>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
33420>>>>>//    Function_Return rVal
33420>>>>>//End_Function
33420>>>>>
33420>>>>>
33420>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
33420>>>>>//                                                                Number anEndTime    ;
33420>>>>>//                                                                Returns Number
33420>>>>>//    Local Integer iTmp
33420>>>>>//    Local Number  rVal
33420>>>>>
33420>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33420>>>>>
33420>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
33420>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
33420>>>>>//    Function_Return rVal
33420>>>>>//End_Function
33420>>>>>
33420>>>>>
33420>>>>>Function fsLoginUserID Global Returns String
33421>>>>>    Local String LastLogin# LoginUserid#
33422>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
33425>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
33428>>>>>    insert "WorkSpaces\" in LastLogin# at 1
33430>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
33433>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
33436>>>>>    Trim LoginUserID# to LoginUserID#
33437>>>>>>
33437>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
33440>>>>>    Function_Return LoginUserID#
33441>>>>>End_Function
33442>>>>>
33442>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
33443>>>>>    Integer rVal
33444>>>>>    String  lsCurrentWksp
33444>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33447>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33450>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33452>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33452>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33452>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33455>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33458>>>>>    Function_Return rVal
33459>>>>>End_Function
33460>>>>>
33460>>>>>
33460>>>>>Function fsReadRegistryLastSDFPath Global Returns String
33461>>>>>    String rVal lsCurrentWksp
33462>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33465>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33468>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33470>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33470>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33470>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33473>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33476>>>>>    Function_Return (Trim(rVal))
33477>>>>>End_Function
33478>>>>>
33478>>>>>
33478>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
33479>>>>>    Integer rVal
33480>>>>>    String  lsCurrentWksp
33480>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33483>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33486>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33488>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33491>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33494>>>>>    Function_Return rVal
33495>>>>>End_Function
33496>>>>>
33496>>>>>
33496>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
33497>>>>>    String rVal lsCurrentWksp
33498>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33501>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33504>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33506>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33509>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33512>>>>>    Function_Return (Trim(rVal))
33513>>>>>End_Function
33514>>>>>
33514>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
33515>>>>>    Integer rVal
33516>>>>>    String  lsCurrentWksp
33516>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33519>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33522>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33524>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33527>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33530>>>>>    Function_Return rVal
33531>>>>>End_Function
33532>>>>>
33532>>>>>
33532>>>>>Function fsReadRegistryLastWEBPath Global Returns String
33533>>>>>    String rVal lsCurrentWksp
33534>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33537>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33540>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33542>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33545>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33548>>>>>    Function_Return (Trim(rVal))
33549>>>>>End_Function
33550>>>>>
33550>>>>>Function fsReadRegistryFEMRootDir Global Returns String
33551>>>>>    String rVal lsCurrentWksp
33552>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33555>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33558>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33560>>>>>    Append lsCurrentWksp "\FEM"
33561>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
33564>>>>>    Function_Return (Trim(rVal))
33565>>>>>End_Function
33566>>>>>
33566>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
33567>>>>>    String rVal lsCurrentWksp
33568>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33571>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33574>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33576>>>>>    Append lsCurrentWksp "\FEM"
33577>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
33580>>>>>    Function_Return (Trim(rVal))
33581>>>>>End_Function
33582>>>>>
33582>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
33583>>>>>    Integer rVal
33584>>>>>    String  lsCurrentWksp
33584>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33587>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33590>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33592>>>>>    Append lsCurrentWksp "\FEM"
33593>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
33596>>>>>    Function_Return rVal
33597>>>>>End_Function
33598>>>>>
33598>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
33599>>>>>    Integer rVal
33600>>>>>    String  lsCurrentWksp
33600>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33603>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33606>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33608>>>>>    Append lsCurrentWksp "\FEM"
33609>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
33612>>>>>    Function_Return rVal
33613>>>>>End_Function
33614>>>>>
33614>>>>>
33614>>>>>
33614>>>>>
33614>>>>>        Function fiWriteRegistryLastDEDPath Global String asLastPath Returns Integer
33615>>>>>            Integer rVal
33616>>>>>            String  lsCurrentWksp
33616>>>>>            Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33619>>>>>            If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33622>>>>>            Insert "WorkSpaces\" in lsCurrentWksp at 1
33624>>>>>            Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_DED_Path"
33627>>>>>            Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33630>>>>>            Function_Return rVal
33631>>>>>        End_Function
33632>>>>>
33632>>>>>
33632>>>>>        Function fsReadRegistryLastDEDPath Global Returns String
33633>>>>>            String rVal lsCurrentWksp
33634>>>>>            Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33637>>>>>            If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33640>>>>>            Insert "WorkSpaces\" in lsCurrentWksp at 1
33642>>>>>            Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_DED_Path"
33645>>>>>            Get_Profile_String lsCurrentWksp "Path"  to rVal
33648>>>>>            Function_Return (Trim(rVal))
33649>>>>>        End_Function
33650>>>>>
33650>>>>>
33650>>>>>
33650>>>>>Function fig_Is_Admin Global Returns Integer
33651>>>>>    String sUser
33652>>>>>    Integer rVal
33652>>>>>    Get fsLoginUserID to sUser
33653>>>>>    Move (trim(sUser)) to sUser
33654>>>>>    Clear Users
33655>>>>>    Move sUser to Users.Login_ID
33656>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33657>>>>>>
33657>>>>>    Move Users.Admin_Rights to rVal
33658>>>>>    Function_Return rVal
33659>>>>>End_Function
33660>>>>>
33660>>>>>Function fig_The_User_Group Global Returns Integer
33661>>>>>    String sUser
33662>>>>>    Get fsLoginUserID   to sUser
33663>>>>>    Move (trim(sUser))  to sUser
33664>>>>>    Clear Users
33665>>>>>    Move sUser          to Users.Login_ID
33666>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33667>>>>>>
33667>>>>>    Clear UserGrps
33668>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33669>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33670>>>>>>
33670>>>>>    Function_Return UserGrps.Grp_ID
33671>>>>>End_Function
33672>>>>>
33672>>>>>Function fsg_The_User_Department Global Returns String
33673>>>>>    String sUser
33674>>>>>    Get fsLoginUserID   to sUser
33675>>>>>    Move (trim(sUser))  to sUser
33676>>>>>    Clear Users
33677>>>>>    Move sUser          to Users.Login_ID
33678>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33679>>>>>>
33679>>>>>    Clear Departm
33680>>>>>    Move Users.Departm_Code   to Departm.Code
33681>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33682>>>>>>
33682>>>>>    Function_Return Departm.Code
33683>>>>>End_Function
33684>>>>>
33684>>>>>
33684>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
33685>>>>>    Integer rVal
33686>>>>>    Move (trim(asUser)) to asUser
33687>>>>>    Clear Users
33688>>>>>    Move asUser to Users.Login_ID
33689>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33690>>>>>>
33690>>>>>    Move Users.Admin_Rights to rVal
33691>>>>>    Function_Return rVal
33692>>>>>End_Function
33693>>>>>
33693>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
33694>>>>>    Move (trim(asUser))  to asUser
33695>>>>>    Clear Users
33696>>>>>    Move asUser          to Users.Login_ID
33697>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33698>>>>>>
33698>>>>>    Clear UserGrps
33699>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33700>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33701>>>>>>
33701>>>>>    Function_Return UserGrps.Grp_ID
33702>>>>>End_Function
33703>>>>>
33703>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
33704>>>>>    Move (trim(asUser))  to asUser
33705>>>>>    Clear Users
33706>>>>>    Move asUser          to Users.Login_ID
33707>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33708>>>>>>
33708>>>>>    Clear Departm
33709>>>>>    Move Users.Departm_Code   to Departm.Code
33710>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33711>>>>>>
33711>>>>>    Function_Return Departm.Code
33712>>>>>End_Function
33713>>>>>
33713>>>>>
33713>>>
33713>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
33714>>>
33714>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
33716>>>    Open Users
33718>>>    Open Views
INCLUDING FILE: VIEWS.FD
33720>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
33722>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
33724>>>    Open Arxeia
33726>>>    Open GrpArx
33728>>>
33728>>>    Function Find_User_Rights_In_Class String asView Returns Integer
33729>>>        String  lsView lsLogin
33730>>>        Integer liUser  liViews iGroup
33730>>>
33730>>>        Move (fsLoginUserID())      to lsLogin
33731>>>        Move (Trim(ToOEM(asView)))  to lsView
33732>>>
33732>>>        //////  /////////////////////////////////////
33732>>>        Clear Users
33733>>>        Move lsLogin    to Users.Login_ID
33734>>>
33734>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33735>>>>
33735>>>        If (Found=1)  Begin
33737>>>            Move Users.User_ID  to liUser
33738>>>            Move Users.Grp_ID   to iGroup
33739>>>        End
33739>>>>
33739>>>        Else Function_Return 0
33741>>>
33741>>>        Clear Views
33742>>>        Move (Trim(lsView)) to Views.Menu_Name
33743>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
33744>>>>
33744>>>        If (Found=1) Begin
33746>>>            Move Views.View_ID to liViews
33747>>>            Clear GrpViews
33748>>>            Move liUser    to GrpViews.User_ID
33749>>>            Move liViews   to GrpViews.View_ID
33750>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
33751>>>>
33751>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
33753>>>                Function_Return (GrpViews.Allow_Read<>'1')
33754>>>            End
33754>>>>
33754>>>            Else Begin
33755>>>                Clear GrpView0
33756>>>                Move iGroup    to GrpView0.Group_ID
33757>>>                Move liViews   to GrpView0.View_ID
33758>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
33759>>>>
33759>>>                If (Found=1) Begin
33761>>>                    Function_Return (GrpView0.Allow_Read<>'1')
33762>>>                End
33762>>>>
33762>>>                Else         Function_Return 0
33764>>>            End
33764>>>>
33764>>>        End
33764>>>>
33764>>>        Else Function_Return 0
33766>>>    End_Function
33767>>>
33767>>>//    Procedure Enhmerose_Views_File_In_Class
33767>>>//        Integer liCount liInt liLastNo
33767>>>//        String lsStr
33767>>>//        Get Item_Count to liCount
33767>>>//        // find last view_id
33767>>>//        Clear Views
33767>>>//        Move 9999 to Views.View_ID
33767>>>//        Find lt Views by index.1 // view_id
33767>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
33767>>>//        Else            Move 0              to liLastNo
33767>>>//        For liInt From 0 to (liCount-1)
33767>>>//            Get Value item liInt to lsStr
33767>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
33767>>>//            //Move (Trim(lsStr)) to lsStr
33767>>>//            If (lsStr<>'') Begin
33767>>>//                Clear Views
33767>>>//                Move lsStr to Views.Menu_Name
33767>>>//                Find eq Views by index.2 // Views.Menu_Name
33767>>>//                If (NOT(Found)) Begin
33767>>>//                    Add 1 to liLastNo
33767>>>//                    Move liLastNo to Views.View_ID
33767>>>//                    Saverecord Views
33767>>>//                End
33767>>>//            End
33767>>>//        Loop
33767>>>//        For liInt From 0 to (liCount-1)
33767>>>//            Get Value item liInt to lsStr
33767>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
33767>>>//            //Move (Trim(lsStr)) to lsStr
33767>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
33767>>>//        Loop
33767>>>//    End_procedure
33767>>>
33767>>>    Procedure OnInitMenu
33768>>>        Integer liCount liInt liLastNo
33769>>>        String lsStr
33769>>>
33769>>>        Get Item_Count to liCount
33770>>>
33770>>>        // find last view_id
33770>>>        Clear Views
33771>>>        Move 9999 to Views.View_ID
33772>>>        Find lt Views by index.1 // view_id
33773>>>>
33773>>>        If (Found=1)    Move Views.View_ID  to liLastNo
33776>>>        Else            Move 0              to liLastNo
33778>>>        For liInt From 0 to (liCount-1)
33784>>>>
33784>>>            Get Value item liInt to lsStr
33785>>>            Move (Trim(lsStr)) to lsStr
33786>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
33788>>>                Clear Views
33789>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
33790>>>                Find eq Views by index.2 // Views.Menu_Name
33791>>>>
33791>>>                If (NOT(Found)) Begin
33793>>>                    Add 1 to liLastNo
33794>>>                    Move liLastNo to Views.View_ID
33795>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
33795>>>                    Saverecord Views
33796>>>                End
33796>>>>
33796>>>            End
33796>>>>
33796>>>        Loop
33797>>>>
33797>>>        For liInt From 0 to (liCount-1)
33803>>>>
33803>>>            Get Value item liInt to lsStr
33804>>>            Move (Trim(lsStr)) to lsStr
33805>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
33806>>>        Loop
33807>>>>
33807>>>
33807>>>    End_procedure
33808>>>
33808>>>//    Procedure End_Construct_Object
33808>>>//        Forward Send End_Construct_Object
33808>>>//        Send Enhmerose_Views_File_In_Class
33808>>>//    End_Procedure
33808>>>
33808>>>End_Class //ButtonSub
33809>>>
33809>>>
33809>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
33809>>>
33809>>>Open Sysfile
33811>>>Open UserGrps
33813>>>Open Users
33815>>>Open Views
33817>>>Open GrpViews
33819>>>Open Arxeia
33821>>>Open GrpArx
33823>>>Open GrpArx0
33825>>>Open GrpView0
33827>>>
33827>>>Use DD.Sub
33827>>>
33827>>>Class Datadictionary_Sec  Is A DatadictionarySub
33828>>>
33828>>>
33828>>>    Procedure Construct_Object
33829>>>        Forward Send Construct_Object
33831>>>        Property Integer cpiUpdate              0
33832>>>        Property Integer cpiBackout             0
33833>>>        Property Integer cpiEditing             0
33834>>>        Property Integer cpiFileNumber          0
33835>>>        Property String  cpsFileName            ''
33836>>>        Property String  cpsLoginID             ''
33837>>>        Property Integer cpiCannot_Read         0
33838>>>        Property Integer cpiCannot_Create       0
33839>>>        Property Integer cpiCannot_Delete       0
33840>>>        Property Integer cpiCannot_Edit         0
33841>>>        Property Integer piFN                   0
33842>>>    End_Procedure
33843>>>
33843>>>//    Procedure Save_Main_File
33843>>>//        If (Operation_Origin<>Self) Begin
33843>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
33843>>>//        End
33843>>>//        Forward Send Save_Main_File
33843>>>//    End_Procedure
33843>>>
33843>>>
33843>>>
33843>>>    Function Validate_Save Returns Integer
33844>>>        Integer rVal
33845>>>        Forward Get Validate_Save to rVal
33847>>>        If (Not(rVal)) Begin
33849>>>            Get cpiCannot_Read to rVal
33850>>>            If (Not(rVal)) Begin
33852>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
33853>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
33856>>>                Else                    Get cpiCannot_Create    to rVal
33858>>>            End
33858>>>>
33858>>>            If (rVal) Send Operation_Not_Allowed rVal
33861>>>        End
33861>>>>
33861>>>        Function_Return rVal
33862>>>    End_Function
33863>>>
33863>>>    Function Validate_Delete Returns Integer
33864>>>        Integer rVal
33865>>>        Forward Get Validate_Delete to rVal
33867>>>        If (Not(rVal)) Begin
33869>>>            Get cpiCannot_Read to rVal
33870>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
33873>>>            If (rVal) Send Operation_Not_Allowed rVal
33876>>>        End
33876>>>>
33876>>>        Function_Return rVal
33877>>>    End_Function
33878>>>
33878>>>    Procedure End_Construct_Object
33879>>>        Integer liSrv rVal
33880>>>        String lsStr
33880>>>        Forward Send End_Construct_Object
33882>>>        Get Main_File                                   To liSrv
33883>>>        Set cpiFileNumber                               To liSrv
33884>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
33887>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
33888>>>        Set cpsLoginID                                  To (fsLoginUserID())
33889>>>        Send Find_User_Rights
33890>>>        Set piFN to lisrv
33891>>>    End_Procedure
33892>>>
33892>>>    Procedure Find_User_Rights
33893>>>        String lsArxeio lsLogin
33894>>>        Integer liUser liArxeio iGroup
33894>>>
33894>>>        Get cpiFileNumber   to liArxeio
33895>>>        Get cpsFileName     to lsArxeio
33896>>>        Get cpsLoginID      to lsLogin
33897>>>
33897>>>        Clear Users
33898>>>        Move lsLogin    to Users.Login_ID
33899>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33900>>>>
33900>>>        If (Found=1)  Begin
33902>>>            Move Users.User_ID  to liUser
33903>>>            Move Users.Grp_ID   to iGroup
33904>>>        End
33904>>>>
33904>>>        //Else Send Operation_Not_Allowed 9999
33904>>>
33904>>>        Clear Arxeia
33905>>>
33905>>>        Move liArxeio to Arxeia.Arxeio_ID
33906>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
33907>>>>
33907>>>
33907>>>        If (Found=1) Begin
33909>>>            Move Arxeia.Arxeio_ID to liArxeio
33910>>>
33910>>>            Clear GrpArx
33911>>>            Move liUser     to GrpArx.User_ID
33912>>>            Move liArxeio   to GrpArx.Arxeio_ID
33913>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
33914>>>>
33914>>>            If (Found=1) Begin
33916>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
33919>>>               Else                         Set cpiCannot_Read   to 10003
33921>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
33924>>>               Else                         Set cpiCannot_Create to 10000
33926>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
33929>>>               Else                         Set cpiCannot_Edit   to 10001
33931>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
33934>>>               Else                         Set cpiCannot_Delete to 10002
33936>>>            End
33936>>>>
33936>>>            Else Begin
33937>>>                Clear GrpArx0
33938>>>                Move iGroup   to GrpArx0.Group_ID
33939>>>                Move liArxeio to GrpArx0.Arxeio_ID
33940>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
33941>>>>
33941>>>                If (Found=1) Begin
33943>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
33946>>>                    Else                            Set cpiCannot_Read   to 20003
33948>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
33951>>>                    Else                            Set cpiCannot_Create to 20000
33953>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
33956>>>                    Else                            Set cpiCannot_Edit   to 20001
33958>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
33961>>>                    Else                            Set cpiCannot_Delete to 20002
33963>>>                End
33963>>>>
33963>>>                Else Begin
33964>>>                    Set cpiCannot_Read   to 0
33965>>>                    Set cpiCannot_Edit   to 0
33966>>>                    Set cpiCannot_Create to 0
33967>>>                    Set cpiCannot_Delete to 0
33968>>>                End
33968>>>>
33968>>>            End
33968>>>>
33968>>>        End
33968>>>>
33968>>>        Else Begin
33969>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
33969>>>            Set cpiCannot_Read   to 0
33970>>>            Set cpiCannot_Edit   to 0
33971>>>            Set cpiCannot_Create to 0
33972>>>            Set cpiCannot_Delete to 0
33973>>>        End
33973>>>>
33973>>>    End_Procedure
33974>>>
33974>>>    Procedure Clear_main_file
33975>>>        Forward Send Clear_main_file
33977>>>        Set cpiBackout to 0
33978>>>        Set cpiUpdate  to 0
33979>>>    End_Procedure
33980>>>
33980>>>    Procedure Update
33981>>>        Forward Send Update
33983>>>        Set cpiUpdate to 1
33984>>>    End_Procedure
33985>>>
33985>>>    Procedure Backout
33986>>>        Forward Send Backout
33988>>>        Set cpiBackout to 1
33989>>>    End_Procedure
33990>>>
33990>>>    Procedure OnConstrain
33991>>>        Integer rVal liSrv
33992>>>        Forward Send OnConstrain
33994>>>        Get cpiFileNumber  To liSrv
33995>>>        Move liSrv         To Filenumber
33996>>>        Get cpiCannot_Read to rVal
33997>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
34001>>>    End_Procedure
34002>>>
34002>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34003>>>        String sLektiko
34004>>>        Move '' to sLektiko
34005>>>
34005>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34008>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
34012>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34016>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34020>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34024>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
34028>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34032>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34036>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
34040>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
34044>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
34048>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
34052>>>
34052>>>             If iError_Num eq 10000 Error 10000 sLektiko
34055>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
34059>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
34063>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
34067>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
34071>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
34075>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
34079>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
34083>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
34087>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
34091>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
34095>>>
34095>>>        Else Forward Send Operation_Not_Allowed  iError_Num
34098>>>    End_Procedure   // Operation_Not_Allowed
34099>>>
34099>>>
34099>>>End_Class //Datadictionary_Sec
34100>
34100>Function GetTheWorkSpace returns String
34101>    String lsWorkSpace
34102>    get_profile_string "WorkSpaces" "CurrentWorkspace" to lsWorkSpace
34105>    If lsWorkSpace eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to lsWorkSpace
34108>    insert "WorkSpaces\" in lsWorkSpace at 1
34110>    Function_Return lsWorkSpace
34111>End_Function
34112>
34112>Function GetTheAppPath Returns String
34113>   String lsWorkSpace lsModule lsTheAppPath
34114>   Move (GetTheWorkSpace(Self)) to lsWorkSpace
34115>   Move (Module_Name(Self)) to lsModule
34116>   Move (lsWorkSpace + "\" + lsModule) to lsTheAppPath
34117>   Function_Return lsTheAppPath
34118>End_Function
34119>
34119>//AB-StoreTopEnd
34119>
34119>
34119>Object Main is a Panelsub
34121>
34121>    //AB-PanelStoreTopStart
34121>    
34121>    //AB-PanelStoreTopEnd
34121>
34121>    Set Label To "InitPasswords"
34122>    Use InitPasswMenu.mn //  Menu package.
INCLUDING FILE: INITPASSWMENU.MN
34122>>>
34122>>>
34122>>>DFCreate_Menu Main_Menu     
34125>>>
34125>>>    Property String psMenuModule Public ''                 
34127>>>
34127>>>    DFCreate_Menu "„ˆƒˆ‰€ Ž‚€‹‹€’€" View1_PopupMenu IS A ViewPopupMenu
34131>>>
34131>>>        On_Item "ƒ ˜®œå¨ ©ž ¡˜¤æ¤à¤ œ¢âš®¦¬ «à¤ ¡à› ¡é¤ œ ©æ›¦¬"    Send Activate_vwParameters2
34132>>>        On_Item "€¨® ¡¦§¦åž©ž œ¤æª ã æ¢à¤ «à¤ ¡à› ¡é¤ œ ©æ›¦¬"      Send Activate_ClearPasswords
34133>>>
34133>>>    End_Pull_Down // &View
34135>>>
34135>>>End_Menu // Main_Menu
34137>>>
34137>>>Register_Object Client_Area
34137>    
34137>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
34137>>>// 07/23/96 JJT - New Class names
34137>>>// 10/03/97 KCR - removed leading separator
34137>>>
34137>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
34137>>>>>//-------------------------------------------------------------------------
34137>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
34137>>>>>//
34137>>>>>//
34137>>>>>// 07/23/96 JJT - New Class names
34137>>>>>//-------------------------------------------------------------------------
34137>>>>>
34137>>>>>Use DfPanel // dfapp_buttonbar
34137>>>>>
34137>>>>>Class ToolBar is a AppToolBar
34138>>>>>
34138>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
34139>>>>>      Local integer rval MainObj#
34140>>>>>      Get Main_Panel_id to MainObj#
34141>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
34144>>>>>      Function_Return rVal
34145>>>>>    End_Function
34146>>>>>
34146>>>>>    Procedure Redirect_Button_Message integer Itm
34147>>>>>         Local integer Msg# Aux# rval Understood
34148>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
34151>>>>>         Get Message   item itm  to Msg#
34152>>>>>         Get Aux_Value item itm  to Aux#
34153>>>>>         If Msg# Begin
34155>>>>>           If Aux# eq 0 Begin
34157>>>>>              Get Focus to Aux#
34158>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
34159>>>>>              If Not Understood Move 0 to Aux#
34162>>>>>           End
34162>>>>>>
34162>>>>>           If Aux# Get Msg# of Aux# to rval
34165>>>>>           Procedure_return rval
34166>>>>>         end
34166>>>>>>
34166>>>>>    End_Procedure // Redirect_Message
34167>>>>>
34167>>>>>End_Class
34168>>>>>
34168>>>>>
34168>>>
34168>>>//  Button bar object.
34168>>>//
34168>>>Object Tool_Bar is a ToolBar
34170>>>
34170>>>    Send ImageList_Add 'bgn.bmp'   // 0
34171>>>    Send ImageList_Add 'end.bmp'   // 1
34172>>>    Send ImageList_Add 'next.bmp'  // 2
34173>>>    Send ImageList_Add 'prev.bmp'  // 3
34174>>>    Send ImageList_Add 'clr.bmp'   // 4
34175>>>    Send ImageList_Add 'clra.bmp'  // 5
34176>>>
34176>>>    send Add_button (ico_user+0) msg_beginning_of_data
34177>>>    Send Add_ToolTip "Beginning of file"
34178>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
34179>>>
34179>>>    send Add_button (ico_user+3) msg_find_previous
34180>>>    Send Add_ToolTip "Find Previous"
34181>>>    Set  Status_Help To 'Find the Previous record (F7)'
34182>>>
34182>>>    send Add_button (ico_user+2) msg_find_next
34183>>>    Send Add_ToolTip "Find Next"
34184>>>    Set  Status_Help To 'Find the Next record (F8)'
34185>>>
34185>>>    send Add_button (ico_user+1) msg_end_of_data
34186>>>    Send Add_ToolTip "End of File"
34187>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
34188>>>
34188>>>    send Add_space
34189>>>
34189>>>    send Add_button ico_std_find msg_prompt
34190>>>    Send Add_ToolTip "Prompt"
34191>>>    Set  Status_Help To 'Show available selections (F4)'
34192>>>
34192>>>    send Add_button (ico_user+4) msg_request_clear
34193>>>    Send Add_ToolTip "Clear"
34194>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
34195>>>
34195>>>    send Add_button (ico_user+5) msg_request_clear_all
34196>>>    Send Add_ToolTip "Clear All"
34197>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
34198>>>
34198>>>    send Add_space
34199>>>
34199>>>    send Add_button ico_std_filesave msg_request_save
34200>>>    Send Add_ToolTip "Save"
34201>>>    Set  Status_Help To 'Save the current record (F2)'
34202>>>
34202>>>    send Add_button ico_std_delete msg_request_delete
34203>>>    Send Add_ToolTip "Delete"
34204>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
34205>>>
34205>>>    send Add_space
34206>>>
34206>>>    send Add_button ico_std_cut msg_cut
34207>>>    Send Add_ToolTip "Cut"
34208>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
34209>>>
34209>>>    send Add_button ico_std_copy msg_copy
34210>>>    Send Add_ToolTip "Copy"
34211>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
34212>>>
34212>>>    send Add_button ico_std_paste msg_paste
34213>>>    Send Add_ToolTip "Paste"
34214>>>    Set  Status_Help to "Inserts Clipboard contents"
34215>>>
34215>>>End_Object
34216>>>
34216>    
34216>    Object Client_Area is a AppClientAreasub
34218>
34218>        //AB-ClientStoreTopStart
34218>        
34218>        //AB-ClientStoreTopEnd
34218>
34218>        //  Include all views
34218>        Use ClearPasswords.VW                                                               
INCLUDING FILE: CLEARPASSWORDS.VW
34218>>>//AB/ Project ClearPasswords
34218>>>//AB/ Object prj is a View_Project
34218>>>//AB/     Set ProjectName to "ClearPasswords"
34218>>>//AB/     Set ProjectFileName to "ClearPasswords.VW"
34218>>>//AB/     Set GenerateFileName to "NONAME"
34218>>>
34218>>>// Project Object Structure
34218>>>//   ClearPasswords is a dbViewSub
34218>>>//     TextBoxSub1 is a TextBoxSub
34218>>>//     frmUserID is a FormSub
34218>>>//     frmUserName is a FormSub
34218>>>//     ButtonSub1 is a ButtonSub
34218>>>//     ButtonSub2 is a ButtonSub
34218>>>//     ButtonSub3 is a ButtonSub
34218>>>//     TextBoxSub2 is a TextBoxSub
34218>>>//     frmNewDate is a cSyDateForm
34218>>>//     ButtonSub4 is a ButtonSub
34218>>>
34218>>>// Register all objects
34218>>>Register_Object ButtonSub1
34218>>>Register_Object ButtonSub2
34218>>>Register_Object ButtonSub3
34218>>>Register_Object ButtonSub4
34218>>>Register_Object ClearPasswords
34218>>>Register_Object frmNewDate
34218>>>Register_Object frmUserID
34218>>>Register_Object frmUserName
34218>>>Register_Object TextBoxSub1
34218>>>Register_Object TextBoxSub2
34218>>>
34218>>>
34218>>>//AB/ AppBuild VIEW
34218>>>
34218>>>
34218>>>//AB-StoreTopStart
34218>>>        
34218>>>Open Sysrec
34220>>>Open Users
34222>>>Open Departm
34224>>>Open Usergrps
34226>>>
34226>>>Open UsersH
INCLUDING FILE: USERSH.FD
34228>>>
34228>>>Use slUsers.sl
INCLUDING FILE: SLUSERS.SL
34228>>>>>//AB/ Project slUsers
34228>>>>>//AB/     Object prj is a Lookup_Project
34228>>>>>//AB/         Set ProjectName to "slUsers"
34228>>>>>//AB/         Set ProjectFileName to "slusers.sl"
34228>>>>>
34228>>>>>// Project Object Structure
34228>>>>>//   slUsers is a dbModalPanelSub
34228>>>>>//     Usergrps_DD is a DataDictionary
34228>>>>>//     Users_DD is a DataDictionary
34228>>>>>//     oSelList is a dbListSub
34228>>>>>//     oOK_bn is a ButtonSub
34228>>>>>//     oCancel_bn is a ButtonSub
34228>>>>>//     oSearch_bn is a ButtonSub
34228>>>>>
34228>>>>>// Register all objects
34228>>>>>Register_Object oCancel_bn
34228>>>>>Register_Object oOK_bn
34228>>>>>Register_Object oSearch_bn
34228>>>>>Register_Object oSelList
34228>>>>>Register_Object slUsers
34228>>>>>Register_Object Usergrps_DD
34228>>>>>Register_Object Users_DD
34228>>>>>
34228>>>>>
34228>>>>>    //AB-IgnoreStart
34228>>>>>
34228>>>>>    Use DFAllEnt.pkg
34228>>>>>    Use dbList.Sub
34228>>>>>    Use Button.Sub
34228>>>>>
34228>>>>>
34228>>>>>    Use USERGRPS.DD
INCLUDING FILE: USERGRPS.DD
34228>>>>>>>//DDB-FileStart
34228>>>>>>>//DDB-HeaderStart
34228>>>>>>>
34228>>>>>>>// File Name : USERGRPS.DD
34228>>>>>>>// Class Name: Usergrps_DataDictionary
34228>>>>>>>// Revision  : 40
34228>>>>>>>// Version   : 2
34228>>>>>>>
34228>>>>>>>Use  Windows           // Basic Definitions
34228>>>>>>>Use  DataDict          // DataDictionary Class Definition
34228>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34228>>>>>>>
34228>>>>>>>Open Usergrps
34230>>>>>>>Open Grparx0
34232>>>>>>>Open Grpview0
34234>>>>>>>Open Grpoth0
34236>>>>>>>Open Users
34238>>>>>>>Open Grptabv0
INCLUDING FILE: GRPTABV0.FD
34240>>>>>>>
34240>>>>>>>//DDB-HeaderEnd
34240>>>>>>>//DDB-SelectionStart
34240>>>>>>>//DDB/ ExternalSelectionList slUserGr  slusergr.sl
34240>>>>>>>Register_Object slUserGr
34240>>>>>>>//DDB-SelectionEnd
34240>>>>>>>
34240>>>>>>>Class Usergrps_DataDictionary  is a DataDictionary_sec
34241>>>>>>>
34241>>>>>>>    // Define_Fields:
34241>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34241>>>>>>>
34241>>>>>>>    Procedure Define_Fields
34242>>>>>>>        Forward Send Define_Fields
34244>>>>>>>        //DDB-Generated-Code-Location
34244>>>>>>>        //DDB-DefineFieldStart
34244>>>>>>>
34244>>>>>>>        Set Main_File            To Usergrps.File_Number
34245>>>>>>>        Set Cascade_Delete_State To FALSE
34246>>>>>>>
34246>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34247>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34248>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34249>>>>>>>
34249>>>>>>>        // Child (Client) file structure................
34249>>>>>>>        Send Add_Client_File  Grparx0.File_Number
34250>>>>>>>        Send Add_Client_File  Grpview0.File_Number
34251>>>>>>>        Send Add_Client_File  Grpoth0.File_Number
34252>>>>>>>        Send Add_Client_File  Users.File_Number
34253>>>>>>>        Send Add_Client_File  Grptabv0.File_Number
34254>>>>>>>
34254>>>>>>>        // Field-based properties.......................
34254>>>>>>>
34254>>>>>>>        // Usergrps.Grp_Id
34254>>>>>>>        Set Field_Options          Field Usergrps.Grp_Id To DD_AUTOFIND   
34255>>>>>>>        Set Field_Prompt_Object    Field Usergrps.Grp_Id To (slUserGr(Self))
34256>>>>>>>        Set Key_Field_State        Field Usergrps.Grp_Id To TRUE
34257>>>>>>>
34257>>>>>>>        // Usergrps.Grp_Name
34257>>>>>>>        Set Field_Prompt_Object    Field Usergrps.Grp_Name To (slUserGr(Self))
34258>>>>>>>
34258>>>>>>>        // Usergrps.Allow_Read
34258>>>>>>>
34258>>>>>>>        // Usergrps.Allow_Change
34258>>>>>>>
34258>>>>>>>        // Usergrps.Allow_Create
34258>>>>>>>
34258>>>>>>>        // Usergrps.Allow_Delete
34258>>>>>>>
34258>>>>>>>        // Usergrps.Allow_Copy
34258>>>>>>>
34258>>>>>>>        //DDB-DefineFieldEnd
34258>>>>>>>    End_Procedure    // Define_Fields
34259>>>>>>>
34259>>>>>>>    // Field_Defaults:
34259>>>>>>>    // This procedure is used to establish default field values.
34259>>>>>>>
34259>>>>>>>    Procedure Field_Defaults
34260>>>>>>>        Forward Send Field_Defaults
34262>>>>>>>        //DDB-Generated-Code-Location
34262>>>>>>>        //DDB-FieldDefaultStart
34262>>>>>>>        //DDB-FieldDefaultEnd
34262>>>>>>>    End_Procedure    // Field_Defaults
34263>>>>>>>
34263>>>>>>>End_Class    // Usergrps_DataDictionary
34264>>>>>>>//DDB-Selection-pkg-Start
34264>>>>>>>
34264>>>>>>>Use slusergr.sl      // slUserGr
INCLUDING FILE: SLUSERGR.SL
34264>>>>>>>>>//AB/ Project slUserGr
34264>>>>>>>>>//AB/     Object prj is a Lookup_Project
34264>>>>>>>>>//AB/         Set ProjectName to "slUserGr"
34264>>>>>>>>>//AB/         Set ProjectFileName to "slusergr.sl"
34264>>>>>>>>>
34264>>>>>>>>>// Project Object Structure
34264>>>>>>>>>//   slUserGr is a dbModalPanelSub
34264>>>>>>>>>//     Usergrps_DD is a DataDictionary
34264>>>>>>>>>//     oSelList is a dbListSub
34264>>>>>>>>>//     oOK_bn is a ButtonSub
34264>>>>>>>>>//     oCancel_bn is a ButtonSub
34264>>>>>>>>>//     oSearch_bn is a ButtonSub
34264>>>>>>>>>
34264>>>>>>>>>// Register all objects
34264>>>>>>>>>Register_Object oCancel_bn
34264>>>>>>>>>Register_Object oOK_bn
34264>>>>>>>>>Register_Object oSearch_bn
34264>>>>>>>>>Register_Object oSelList
34264>>>>>>>>>Register_Object slUserGr
34264>>>>>>>>>Register_Object Usergrps_DD
34264>>>>>>>>>
34264>>>>>>>>>
34264>>>>>>>>>    //AB-IgnoreStart
34264>>>>>>>>>
34264>>>>>>>>>    Use DFAllEnt.pkg
34264>>>>>>>>>    Use dbList.Sub
34264>>>>>>>>>    Use Button.Sub
34264>>>>>>>>>
34264>>>>>>>>>
34264>>>>>>>>>    Use USERGRPS.DD
34264>>>>>>>>>    
34264>>>>>>>>>    //AB-IgnoreEnd
34264>>>>>>>>>
34264>>>>>>>>>    CD_Popup_Object slUserGr is a dbModalPanelSub
34283>>>>>>>>>        Set Label to "Ž£á›œª •¨ž©«é¤"
34284>>>>>>>>>        Set Size to 148 297
34285>>>>>>>>>        Set Location to 4 8
34286>>>>>>>>>        Set Exit_Application_Local_State to FALSE
34287>>>>>>>>>        Set Modal_State to FALSE
34288>>>>>>>>>
34288>>>>>>>>>        //AB-DDOStart
34288>>>>>>>>>
34288>>>>>>>>>        Object Usergrps_DD is a Usergrps_DataDictionary
34290>>>>>>>>>        End_Object    // Usergrps_DD
34291>>>>>>>>>
34291>>>>>>>>>        Set Main_DD to (Usergrps_DD(self))
34292>>>>>>>>>        Set Server to (Usergrps_DD(self))
34293>>>>>>>>>
34293>>>>>>>>>        //AB-DDOEnd
34293>>>>>>>>>
34293>>>>>>>>>        Object oSelList is a dbListSub
34295>>>>>>>>>            Set Main_File to Usergrps.File_Number
34296>>>>>>>>>            Set Size to 105 280
34297>>>>>>>>>            Set Location to 6 6
34298>>>>>>>>>
34298>>>>>>>>>            Begin_Row
34301>>>>>>>>>                Entry_Item Usergrps.Grp_id
34302>>>>>>>>>                Entry_Item Usergrps.Grp_name
34303>>>>>>>>>            End_Row
34308>>>>>>>>>
34308>>>>>>>>>            Set Form_Width    item 0 to 61
34309>>>>>>>>>            Set Header_Label  item 0 to "‰à›.Ž£á›¦ª"
34310>>>>>>>>>            
34310>>>>>>>>>            Set Form_Width    item 1 to 213
34311>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
34312>>>>>>>>>            
34312>>>>>>>>>
34312>>>>>>>>>            //AB-StoreStart
34312>>>>>>>>>                                        
34312>>>>>>>>>            Set Color to 16776436
34313>>>>>>>>>            Set TextColor to clNavy
34314>>>>>>>>>            Set CurrentRowColor to 16775135
34315>>>>>>>>>            Set CurrentRowTextColor to clNavy
34316>>>>>>>>>            Set CurrentCellColor to 16775135
34317>>>>>>>>>            Set CurrentCellTextColor to clNavy
34318>>>>>>>>>            
34318>>>>>>>>>            Set Header_Column_Sorted_State to True
34319>>>>>>>>>            
34319>>>>>>>>>            //AB-StoreEnd
34319>>>>>>>>>
34319>>>>>>>>>        End_Object    // oSelList
34320>>>>>>>>>
34320>>>>>>>>>        Object oOK_bn is a ButtonSub
34322>>>>>>>>>            Set Label to "„§ ¢¦šã"
34323>>>>>>>>>            Set Location to 115 126
34324>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34325>>>>>>>>>
34325>>>>>>>>>            //AB-StoreStart
34325>>>>>>>>>            Procedure OnClick
34327>>>>>>>>>                Send OK To (oSelList(current_object))
34328>>>>>>>>>            End_Procedure
34329>>>>>>>>>            //AB-StoreEnd
34329>>>>>>>>>
34329>>>>>>>>>        End_Object    // oOK_bn
34330>>>>>>>>>
34330>>>>>>>>>        Object oCancel_bn is a ButtonSub
34332>>>>>>>>>            Set Label to "€¡ç¨à©ž"
34333>>>>>>>>>            Set Location to 115 181
34334>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34335>>>>>>>>>
34335>>>>>>>>>            //AB-StoreStart
34335>>>>>>>>>            Procedure OnClick
34337>>>>>>>>>                Send Cancel To (oSelList(current_object))
34338>>>>>>>>>            End_Procedure
34339>>>>>>>>>            //AB-StoreEnd
34339>>>>>>>>>
34339>>>>>>>>>        End_Object    // oCancel_bn
34340>>>>>>>>>
34340>>>>>>>>>        Object oSearch_bn is a ButtonSub
34342>>>>>>>>>            Set Label to "€¤˜ã«ž©ž"
34343>>>>>>>>>            Set Location to 115 236
34344>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34345>>>>>>>>>
34345>>>>>>>>>            //AB-StoreStart
34345>>>>>>>>>            Procedure OnClick
34347>>>>>>>>>                Send Search To (oSelList(current_object))
34348>>>>>>>>>            End_Procedure
34349>>>>>>>>>            //AB-StoreEnd
34349>>>>>>>>>
34349>>>>>>>>>        End_Object    // oSearch_bn
34350>>>>>>>>>
34350>>>>>>>>>
34350>>>>>>>>>        //AB-StoreStart
34350>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34351>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34352>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34353>>>>>>>>>        //AB-StoreEnd
34353>>>>>>>>>
34353>>>>>>>>>    CD_End_Object    // slUserGr
34355>>>>>>>>>>
34355>>>>>>>>>
34355>>>>>>>>>//AB/     End_Object    // prj
34355>>>>>>>
34355>>>>>>>//DDB-Selection-pkg-End
34355>>>>>>>//DDB-FileEnd
34355>>>>>    Use USERS.DD
INCLUDING FILE: USERS.DD
34355>>>>>>>//DDB-FileStart
34355>>>>>>>//DDB-HeaderStart
34355>>>>>>>
34355>>>>>>>// File Name : USERS.DD
34355>>>>>>>// Class Name: Users_DataDictionary
34355>>>>>>>// Revision  : 49
34355>>>>>>>// Version   : 2
34355>>>>>>>
34355>>>>>>>Use  Windows           // Basic Definitions
34355>>>>>>>Use  DataDict          // DataDictionary Class Definition
34355>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34355>>>>>>>
34355>>>>>>>Open Users
34357>>>>>>>Open Grpoth
34359>>>>>>>Open Grparx
34361>>>>>>>Open Grpviews
34363>>>>>>>Open Grptabv
INCLUDING FILE: GRPTABV.FD
34365>>>>>>>Open Grpact
INCLUDING FILE: GRPACT.FD
34367>>>>>>>Open Usersh
34369>>>>>>>Open Usergrps
34371>>>>>>>Open Departm
34373>>>>>>>
34373>>>>>>>//DDB-HeaderEnd
34373>>>>>>>//DDB-SelectionStart
34373>>>>>>>//DDB/ ExternalSelectionList slUserGr  slusergr.sl
34373>>>>>>>//DDB/ ExternalSelectionList slUsers  slusers.sl
34373>>>>>>>Register_Object slUserGr
34373>>>>>>>Register_Object slUsers
34373>>>>>>>//DDB-SelectionEnd
34373>>>>>>>
34373>>>>>>>Class Users_DataDictionary  is a DataDictionary_sec
34374>>>>>>>
34374>>>>>>>    // Define_Fields:
34374>>>>>>>    // This procedure is used to set up all data-dictionary rules.
34374>>>>>>>
34374>>>>>>>    Procedure Define_Fields
34375>>>>>>>        Forward Send Define_Fields
34377>>>>>>>        //DDB-Generated-Code-Location
34377>>>>>>>        //DDB-DefineFieldStart
34377>>>>>>>
34377>>>>>>>        Set Main_File            To Users.File_Number
34378>>>>>>>        Set Cascade_Delete_State To FALSE
34379>>>>>>>
34379>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34380>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34381>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34382>>>>>>>
34382>>>>>>>        // Child (Client) file structure................
34382>>>>>>>        Send Add_Client_File  Grpoth.File_Number
34383>>>>>>>        Send Add_Client_File  Grparx.File_Number
34384>>>>>>>        Send Add_Client_File  Grpviews.File_Number
34385>>>>>>>        Send Add_Client_File  Grptabv.File_Number
34386>>>>>>>        Send Add_Client_File  Grpact.File_Number
34387>>>>>>>        Send Add_Client_File  Usersh.File_Number
34388>>>>>>>
34388>>>>>>>        // Parent (Server) file structure...............
34388>>>>>>>        Send Add_Server_File  Usergrps.File_Number
34389>>>>>>>        Send Add_Server_File  Departm.File_Number
34390>>>>>>>
34390>>>>>>>        // Field-based properties.......................
34390>>>>>>>
34390>>>>>>>        // Users.Grp_Id            
34390>>>>>>>        Set Field_Prompt_Object    Field Users.Grp_Id             To (slUserGr(Self))
34391>>>>>>>
34391>>>>>>>        // Users.User_Id           
34391>>>>>>>        Set Field_Options          Field Users.User_Id            To DD_AUTOFIND   
34392>>>>>>>        Set Field_Prompt_Object    Field Users.User_Id            To (slUsers(Self))
34393>>>>>>>        Set Key_Field_State        Field Users.User_Id            To TRUE
34394>>>>>>>
34394>>>>>>>        // Users.Login_Id          
34394>>>>>>>        Set Field_Options          Field Users.Login_Id           To DD_AUTOFIND   
34395>>>>>>>        Set Field_Prompt_Object    Field Users.Login_Id           To (slUsers(Self))
34396>>>>>>>        Set Key_Field_State        Field Users.Login_Id           To TRUE
34397>>>>>>>
34397>>>>>>>        // Users.Name              
34397>>>>>>>        Set Field_Prompt_Object    Field Users.Name               To (slUsers(Self))
34398>>>>>>>
34398>>>>>>>        // Users.Password          
34398>>>>>>>
34398>>>>>>>        // Users.Allow_Read        
34398>>>>>>>
34398>>>>>>>        // Users.Allow_Change      
34398>>>>>>>
34398>>>>>>>        // Users.Allow_Create      
34398>>>>>>>
34398>>>>>>>        // Users.Allow_Delete      
34398>>>>>>>
34398>>>>>>>        // Users.Admin_Rights      
34398>>>>>>>
34398>>>>>>>        // Users.Allow_Copy        
34398>>>>>>>
34398>>>>>>>        // Users.Departm_Code      
34398>>>>>>>
34398>>>>>>>        // Users.No_Allagh_Timhs   
34398>>>>>>>
34398>>>>>>>        // Users.Last_Login_Date   
34398>>>>>>>
34398>>>>>>>        // Users.Last_Login_Time   
34398>>>>>>>
34398>>>>>>>        // Users.Last_Password     
34398>>>>>>>
34398>>>>>>>        // Users.Last_Change       
34398>>>>>>>
34398>>>>>>>        // Users.Next_Change       
34398>>>>>>>
34398>>>>>>>        // Users.Anenergos         
34398>>>>>>>
34398>>>>>>>        // Users.Block_Until_D     
34398>>>>>>>
34398>>>>>>>        // Users.Block_Until_T     
34398>>>>>>>
34398>>>>>>>        //DDB-DefineFieldEnd
34398>>>>>>>    End_Procedure    // Define_Fields
34399>>>>>>>
34399>>>>>>>    // Field_Defaults:
34399>>>>>>>    // This procedure is used to establish default field values.
34399>>>>>>>
34399>>>>>>>    Procedure Field_Defaults
34400>>>>>>>        Forward Send Field_Defaults
34402>>>>>>>        //DDB-Generated-Code-Location
34402>>>>>>>        //DDB-FieldDefaultStart
34402>>>>>>>        Set Field_Changed_Value   Field Users.Allow_Read         To "1"
34403>>>>>>>        Set Field_Changed_Value   Field Users.Allow_Change       To "1"
34404>>>>>>>        Set Field_Changed_Value   Field Users.Allow_Create       To "1"
34405>>>>>>>        Set Field_Changed_Value   Field Users.Allow_Delete       To "1"
34406>>>>>>>        Set Field_Changed_Value   Field Users.Allow_Copy         To "1"
34407>>>>>>>        //DDB-FieldDefaultEnd
34407>>>>>>>    End_Procedure    // Field_Defaults
34408>>>>>>>
34408>>>>>>>End_Class    // Users_DataDictionary
34409>>>>>>>//DDB-Selection-pkg-Start
34409>>>>>>>
34409>>>>>>>Use slusergr.sl      // slUserGr
34409>>>>>>>Use slusers.sl       // slUsers
34409>>>>>>>
34409>>>>>>>//DDB-Selection-pkg-End
34409>>>>>>>//DDB-FileEnd
34409>>>>>    
34409>>>>>    //AB-IgnoreEnd
34409>>>>>
34409>>>>>    CD_Popup_Object slUsers is a dbModalPanelSub
34428>>>>>        Set Label to "•¨ã©«œª"
34429>>>>>        Set Size to 186 455
34430>>>>>        Set Location to 9 15
34431>>>>>        Set Exit_Application_Local_State to FALSE
34432>>>>>        Set Modal_State to FALSE
34433>>>>>
34433>>>>>        //AB-DDOStart
34433>>>>>
34433>>>>>        Object Usergrps_DD is a Usergrps_DataDictionary
34435>>>>>        End_Object    // Usergrps_DD
34436>>>>>
34436>>>>>        Object Users_DD is a Users_DataDictionary
34438>>>>>
34438>>>>>            //AB-StoreTopStart
34438>>>>>                    
34438>>>>>            //AB-StoreTopEnd
34438>>>>>
34438>>>>>            Set DDO_Server to (Usergrps_DD(self))
34439>>>>>
34439>>>>>            //AB-StoreStart
34439>>>>>                    
34439>>>>>                    
34439>>>>>                    
34439>>>>>            //AB-StoreEnd
34439>>>>>
34439>>>>>        End_Object    // Users_DD
34440>>>>>
34440>>>>>        Set Main_DD to (Users_DD(self))
34441>>>>>        Set Server to (Users_DD(self))
34442>>>>>
34442>>>>>        //AB-DDOEnd
34442>>>>>
34442>>>>>        Object oSelList is a dbListSub
34444>>>>>            Set Main_File to Users.File_Number
34445>>>>>            Set Size to 143 437
34446>>>>>            Set Location to 6 6
34447>>>>>
34447>>>>>            Begin_Row
34450>>>>>                Entry_Item Users.User_id
34451>>>>>                Entry_Item Users.Name
34452>>>>>                Entry_Item Usergrps.Grp_name
34453>>>>>                Entry_Item Users.Login_id
34454>>>>>                Entry_Item Users.Anenergos
34455>>>>>            End_Row
34460>>>>>
34460>>>>>            Set Form_Width    item 0 to 47
34461>>>>>            Set Header_Label  item 0 to "€/€"
34462>>>>>            
34462>>>>>            Set Form_Width    item 1 to 133
34463>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜«œ§é¤¬£¦"
34464>>>>>            
34464>>>>>            Set Form_Width    item 2 to 93
34465>>>>>            Set Header_Label  item 2 to "Ž£á›˜"
34466>>>>>            
34466>>>>>            Set Form_Width    item 3 to 144
34467>>>>>            Set Header_Label  item 3 to "•¨ã©«žª"
34468>>>>>            
34468>>>>>            Set Form_Width    item 4 to 14
34469>>>>>            Set Header_Label  item 4 to "€¤œ¤œ¨šæª"
34470>>>>>            Set Column_Checkbox_State  item 4 to True
34471>>>>>            
34471>>>>>
34471>>>>>            //AB-StoreStart
34471>>>>>                                            
34471>>>>>            Set Color to 16776436
34472>>>>>            Set TextColor to clNavy
34473>>>>>            Set CurrentRowColor to 16775135
34474>>>>>            Set CurrentRowTextColor to clNavy
34475>>>>>            Set CurrentCellColor to 16775135
34476>>>>>            Set CurrentCellTextColor to clNavy
34477>>>>>            Set Header_Column_Sorted_State to True
34478>>>>>            
34478>>>>>            
34478>>>>>            //AB-StoreEnd
34478>>>>>
34478>>>>>        End_Object    // oSelList
34479>>>>>
34479>>>>>        Object oOK_bn is a ButtonSub
34481>>>>>            Set Label to "„§ ¢¦šã"
34482>>>>>            Set Location to 152 284
34483>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34484>>>>>
34484>>>>>            //AB-StoreStart
34484>>>>>            Procedure OnClick
34486>>>>>                Send OK To (oSelList(current_object))
34487>>>>>            End_Procedure
34488>>>>>            //AB-StoreEnd
34488>>>>>
34488>>>>>        End_Object    // oOK_bn
34489>>>>>
34489>>>>>        Object oCancel_bn is a ButtonSub
34491>>>>>            Set Label to "€¡ç¨à©ž"
34492>>>>>            Set Location to 152 339
34493>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34494>>>>>
34494>>>>>            //AB-StoreStart
34494>>>>>            Procedure OnClick
34496>>>>>                Send Cancel To (oSelList(current_object))
34497>>>>>            End_Procedure
34498>>>>>            //AB-StoreEnd
34498>>>>>
34498>>>>>        End_Object    // oCancel_bn
34499>>>>>
34499>>>>>        Object oSearch_bn is a ButtonSub
34501>>>>>            Set Label to "€¤˜ã«ž©ž"
34502>>>>>            Set Location to 152 394
34503>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34504>>>>>
34504>>>>>            //AB-StoreStart
34504>>>>>            Procedure OnClick
34506>>>>>                Send Search To (oSelList(current_object))
34507>>>>>            End_Procedure
34508>>>>>            //AB-StoreEnd
34508>>>>>
34508>>>>>        End_Object    // oSearch_bn
34509>>>>>
34509>>>>>
34509>>>>>        //AB-StoreStart
34509>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34510>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34511>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34512>>>>>        //AB-StoreEnd
34512>>>>>
34512>>>>>    CD_End_Object    // slUsers
34514>>>>>>
34514>>>>>
34514>>>>>//AB/     End_Object    // prj
34514>>>
34514>>>//AB-StoreTopEnd
34514>>>
34514>>>//AB-IgnoreStart
34514>>>
34514>>>Use dbView.Sub
34514>>>Use Txtbox.Sub
34514>>>Use Form.Sub
34514>>>Use Button.Sub
34514>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
34514>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
34514>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
34514>>>>>>>>>//AB/ Project Calendar Outlook
34514>>>>>>>>>//AB/     Object prj is a Lookup_Project
34514>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
34514>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
34514>>>>>>>>>
34514>>>>>>>>>// Project Object Structure
34514>>>>>>>>>//   oCalendar is a BasicPanelSub
34514>>>>>>>>>//     Container3d1 is a Container3d
34514>>>>>>>>>//       Grid2 is a Grid
34514>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
34514>>>>>>>>>//       Textbox2 is a Textbox
34514>>>>>>>>>//       Textbox3 is a Textbox
34514>>>>>>>>>//       Textbox4 is a Textbox
34514>>>>>>>>>//       Textbox5 is a Textbox
34514>>>>>>>>>//       Textbox6 is a Textbox
34514>>>>>>>>>//       Textbox7 is a Textbox
34514>>>>>>>>>//       Textbox8 is a Textbox
34514>>>>>>>>>//       LineControl1 is a LineControl
34514>>>>>>>>>//       Container3d2 is a Container3d
34514>>>>>>>>>//         oRght is a BitmapContainer
34514>>>>>>>>>//         oLeft is a BitmapContainer
34514>>>>>>>>>//         oMonth is a Textbox
34514>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
34514>>>>>>>>>//         oCalendarYear is a Textbox
34514>>>>>>>>>//         oSelectCalendarYear is a Form
34514>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
34514>>>>>>>>>//     oToday is a Textbox
34514>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
34514>>>>>>>>>//     Help_Container is a Container3d
34514>>>>>>>>>//       Help_Info is a Edit
34514>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
34514>>>>>>>>>
34514>>>>>>>>>// Register all objects
34514>>>>>>>>>Register_Object BitmapContainer3
34514>>>>>>>>>Register_Object Container3d1
34514>>>>>>>>>Register_Object Container3d2
34514>>>>>>>>>Register_Object cOutlookFloatingMenu
34514>>>>>>>>>Register_Object Grid2
34514>>>>>>>>>Register_Object Help_Container
34514>>>>>>>>>Register_Object Help_Info
34514>>>>>>>>>Register_Object HelpFloatingMenu
34514>>>>>>>>>Register_Object LineControl1
34514>>>>>>>>>Register_Object oCalendar
34514>>>>>>>>>Register_Object oCalendarYear
34514>>>>>>>>>Register_Object oCloseCalendar_bn
34514>>>>>>>>>Register_Object oLeft
34514>>>>>>>>>Register_Object oMonth
34514>>>>>>>>>Register_Object oRght
34514>>>>>>>>>Register_Object oSelectCalendarYear
34514>>>>>>>>>Register_Object oSelectMonth
34514>>>>>>>>>Register_Object oToday
34514>>>>>>>>>Register_Object Textbox2
34514>>>>>>>>>Register_Object Textbox3
34514>>>>>>>>>Register_Object Textbox4
34514>>>>>>>>>Register_Object Textbox5
34514>>>>>>>>>Register_Object Textbox6
34514>>>>>>>>>Register_Object Textbox7
34514>>>>>>>>>Register_Object Textbox8
34514>>>>>>>>>
34514>>>>>>>>>
34514>>>>>>>>>
34514>>>>>>>>>    //AB-StoreTopStart
34514>>>>>>>>>    Use dates.utl
34514>>>>>>>>>
34514>>>>>>>>>
34514>>>>>>>>>    //AB-StoreTopEnd
34514>>>>>>>>>
34514>>>>>>>>>    //AB-IgnoreStart
34514>>>>>>>>>
34514>>>>>>>>>    Use Panel.Sub
34514>>>>>>>>>    Use DFAllEnt.pkg
34514>>>>>>>>>
34514>>>>>>>>>
34514>>>>>>>>>
34514>>>>>>>>>    //AB-IgnoreEnd
34514>>>>>>>>>
34514>>>>>>>>>    Object oCalendar is a BasicPanelSub
34516>>>>>>>>>        Set Border_Style to Border_Normal
34517>>>>>>>>>        Set Caption_Bar to FALSE
34518>>>>>>>>>        Set Label to "January, 2001"
34519>>>>>>>>>        Set Size to 98 123
34520>>>>>>>>>        Set Location to 10 22
34521>>>>>>>>>        Set Color to clWhite
34522>>>>>>>>>        Set Exit_Application_Local_State to TRUE
34523>>>>>>>>>        Set Popup_State to TRUE
34524>>>>>>>>>
34524>>>>>>>>>        //AB-DDOStart
34524>>>>>>>>>
34524>>>>>>>>>
34524>>>>>>>>>        //AB-DDOEnd
34524>>>>>>>>>
34524>>>>>>>>>        Object Container3d1 is a Container3d
34526>>>>>>>>>            Set Size to 88 135
34527>>>>>>>>>            Set Location to -2 -1
34528>>>>>>>>>            Set Color to clWhite
34529>>>>>>>>>            Set Border_Style to Border_None
34530>>>>>>>>>            Object Grid2 is a Grid
34532>>>>>>>>>
34532>>>>>>>>>                //AB-StoreTopStart
34532>>>>>>>>>                property date    p_current_date     0
34534>>>>>>>>>                property integer p_current_year     -1
34536>>>>>>>>>                property integer p_current_month    -1
34538>>>>>>>>>                property integer p_selected_day     -1
34540>>>>>>>>>                property integer pExportState       1
34542>>>>>>>>>                property integer invoking_object_id 0
34544>>>>>>>>>                Property integer piCurrentDayItem   -1
34546>>>>>>>>>
34546>>>>>>>>>                Set Border_Style To BORDER_NONE
34547>>>>>>>>>                Set header_visible_state To False
34548>>>>>>>>>                set select_mode to no_select
34549>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
34550>>>>>>>>>
34550>>>>>>>>>                on_key Key_F1 Send Help
34551>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
34552>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
34553>>>>>>>>>                on_key          key_pgup send prev_month
34554>>>>>>>>>                on_key          key_pgdn send next_month
34555>>>>>>>>>                on_key key_enter         send move_value_out
34556>>>>>>>>>                on_key key_ctrl+key_d    send go_today
34557>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
34558>>>>>>>>>
34558>>>>>>>>>                //AB-StoreTopEnd
34558>>>>>>>>>
34558>>>>>>>>>                Set Color to clWhite
34559>>>>>>>>>                Set CurrentCellColor to clWhite
34560>>>>>>>>>                Set CurrentCellTextColor to clWhite
34561>>>>>>>>>                Set Size to 61 145
34562>>>>>>>>>                Set Location to 30 1
34563>>>>>>>>>                Set Resize_Column_state to FALSE
34564>>>>>>>>>
34564>>>>>>>>>                Set Line_Width to 7 0
34565>>>>>>>>>
34565>>>>>>>>>                Set Form_Width    item 0 to 18
34566>>>>>>>>>                Set Header_Label  item 0 to "Mo"
34567>>>>>>>>>
34567>>>>>>>>>                Set Form_Width    item 1 to 18
34568>>>>>>>>>                Set Header_Label  item 1 to "Tu"
34569>>>>>>>>>
34569>>>>>>>>>                Set Form_Width    item 2 to 18
34570>>>>>>>>>                Set Header_Label  item 2 to "We"
34571>>>>>>>>>
34571>>>>>>>>>                Set Form_Width    item 3 to 18
34572>>>>>>>>>                Set Header_Label  item 3 to "Th"
34573>>>>>>>>>
34573>>>>>>>>>                Set Form_Width    item 4 to 18
34574>>>>>>>>>                Set Header_Label  item 4 to "Fr"
34575>>>>>>>>>
34575>>>>>>>>>                Set Form_Width    item 5 to 18
34576>>>>>>>>>                Set Header_Label  item 5 to "Sa"
34577>>>>>>>>>
34577>>>>>>>>>                Set Form_Width    item 6 to 18
34578>>>>>>>>>                Set Header_Label  item 6 to "Su"
34579>>>>>>>>>
34579>>>>>>>>>
34579>>>>>>>>>                //AB-StoreStart
34579>>>>>>>>>
34579>>>>>>>>>                Procedure Change_Year
34581>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
34582>>>>>>>>>                End_Procedure // Change_Year
34583>>>>>>>>>
34583>>>>>>>>>                procedure go_today
34585>>>>>>>>>                    Date date#
34586>>>>>>>>>                    sysdate4 date#
34587>>>>>>>>>                    set p_current_date to date#
34588>>>>>>>>>                    Send Update_Calendar
34589>>>>>>>>>                end_procedure
34590>>>>>>>>>
34590>>>>>>>>>                procedure next_month
34592>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
34593>>>>>>>>>                    Send Update_Calendar
34594>>>>>>>>>                end_procedure
34595>>>>>>>>>
34595>>>>>>>>>                procedure prev_month
34597>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
34598>>>>>>>>>                    Send Update_Calendar
34599>>>>>>>>>                end_procedure
34600>>>>>>>>>
34600>>>>>>>>>                procedure next_year
34602>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
34603>>>>>>>>>                    Send Update_Calendar
34604>>>>>>>>>                end_procedure
34605>>>>>>>>>
34605>>>>>>>>>                procedure prev_year
34607>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
34608>>>>>>>>>                    Send Update_Calendar
34609>>>>>>>>>                end_procedure
34610>>>>>>>>>
34610>>>>>>>>>                Procedure Activate
34612>>>>>>>>>                    Date date#
34613>>>>>>>>>                    Forward Send Activate
34615>>>>>>>>>                    Set current_item to (p_selected_day(Self))
34616>>>>>>>>>                End_Procedure
34617>>>>>>>>>
34617>>>>>>>>>                Procedure Update_Calendar
34619>>>>>>>>>                    Set Dynamic_Update_State To False
34620>>>>>>>>>                    send Fill_List
34621>>>>>>>>>                    Set Dynamic_Update_State To True
34622>>>>>>>>>                    // Send Update_Label
34622>>>>>>>>>                    Set current_item to (p_selected_day(Self))
34623>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
34624>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
34625>>>>>>>>>                End_Procedure
34626>>>>>>>>>
34626>>>>>>>>>                Procedure Fill_List
34628>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
34629>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
34629>>>>>>>>>                    Date dToday
34629>>>>>>>>>                    Send Delete_Data
34630>>>>>>>>>
34630>>>>>>>>>                    Get p_current_date to date#
34631>>>>>>>>>
34631>>>>>>>>>                    SysDate4 dToday
34632>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
34633>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
34634>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
34635>>>>>>>>>
34635>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
34636>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
34637>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
34638>>>>>>>>>                    Set p_current_month To sel_month#
34639>>>>>>>>>                    Set p_current_year To sel_year#
34640>>>>>>>>>
34640>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
34641>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
34642>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
34643>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
34644>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
34645>>>>>>>>>
34645>>>>>>>>>                    If (first_item# > 0) Begin
34647>>>>>>>>>                        Move (first_item#-1) to day#
34648>>>>>>>>>                        For iFor from 0 to (first_item#-1)
34654>>>>>>>>>>
34654>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
34655>>>>>>>>>                            Set Entry_State Item iFor To False
34656>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
34657>>>>>>>>>                            Decrement day#
34658>>>>>>>>>                        Loop
34659>>>>>>>>>>
34659>>>>>>>>>                    End
34659>>>>>>>>>>
34659>>>>>>>>>
34659>>>>>>>>>                    Move 1 To day#
34660>>>>>>>>>                    For iFor from first_item# to last_item#
34666>>>>>>>>>>
34666>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
34667>>>>>>>>>                        Set Entry_State Item iFor To False
34668>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
34670>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
34671>>>>>>>>>                            Set piCurrentDayItem to iFor
34672>>>>>>>>>                        End
34672>>>>>>>>>>
34672>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
34675>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
34676>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
34677>>>>>>>>>                        Set form_Mask item iFor To "## "
34678>>>>>>>>>                        Increment day#
34679>>>>>>>>>                    Loop
34680>>>>>>>>>>
34680>>>>>>>>>
34680>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
34681>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
34682>>>>>>>>>
34682>>>>>>>>>                    If (last_item# < 41) Begin
34684>>>>>>>>>                        Move 1 to day#
34685>>>>>>>>>                        For iFor from (last_item#+1) to 41
34691>>>>>>>>>>
34691>>>>>>>>>                            Send Add_Item msg_move_value_out day#
34692>>>>>>>>>                            Set Entry_State Item iFor To False
34693>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
34694>>>>>>>>>                            Increment day#
34695>>>>>>>>>                        Loop
34696>>>>>>>>>>
34696>>>>>>>>>                    End
34696>>>>>>>>>>
34696>>>>>>>>>
34696>>>>>>>>>                End_Procedure
34697>>>>>>>>>
34697>>>>>>>>>                Procedure Help
34699>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
34699>>>>>>>>>                    Set Visible_State of Help_Container to True
34700>>>>>>>>>                    Set Enabled_State of Help_Container to True
34701>>>>>>>>>                    Send Activate to Help_Container
34702>>>>>>>>>                End_Procedure
34703>>>>>>>>>
34703>>>>>>>>>                procedure mouse_click integer window integer char_pos
34705>>>>>>>>>                    Send Move_Value_Out
34706>>>>>>>>>                    forward send mouse_click window char_pos
34708>>>>>>>>>                end_procedure
34709>>>>>>>>>
34709>>>>>>>>>                Procedure Move_Value_Out
34711>>>>>>>>>                    Integer iYear iMonth iDay iItm
34712>>>>>>>>>                    Date Date# next_date# prev_date#
34712>>>>>>>>>                    Get Current_Item To iItm
34713>>>>>>>>>                    If (pExportState(Self)) Begin
34715>>>>>>>>>                        Get Value Item iItm To iDay
34716>>>>>>>>>                        Get p_current_month to iMonth
34717>>>>>>>>>                        Get p_current_year  to iYear
34718>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
34719>>>>>>>>>
34719>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
34721>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
34722>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
34723>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
34724>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
34725>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
34726>>>>>>>>>                        End
34726>>>>>>>>>>
34726>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
34728>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
34729>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
34730>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
34731>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
34732>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
34733>>>>>>>>>                        End
34733>>>>>>>>>>
34733>>>>>>>>>
34733>>>>>>>>>                        Send Export_Date date#
34734>>>>>>>>>                    End
34734>>>>>>>>>>
34734>>>>>>>>>                End_Procedure
34735>>>>>>>>>
34735>>>>>>>>>                Procedure Export_Date date date#
34737>>>>>>>>>                    local integer focus# dm# margin# datatype#
34738>>>>>>>>>                    get invoking_object_id to focus#
34739>>>>>>>>>
34739>>>>>>>>>                    if focus# gt desktop begin
34741>>>>>>>>>                         get delegation_mode of focus# to dm#
34742>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
34743>>>>>>>>>                         get form_margin of focus# item current to margin#
34744>>>>>>>>>                         get form_datatype of focus# item current to datatype#
34745>>>>>>>>>                         set delegation_mode of focus# to dm#
34746>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
34749>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
34751>>>>>>>>>                         set item_changed_state of focus# item current to true
34752>>>>>>>>>                    end
34752>>>>>>>>>>
34752>>>>>>>>>                    Send Close_Calendar
34753>>>>>>>>>                End_Procedure
34754>>>>>>>>>
34754>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
34756>>>>>>>>>
34756>>>>>>>>>                    Procedure Close_Calendar
34758>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
34759>>>>>>>>>                    End_Procedure // Close_Calendar
34760>>>>>>>>>
34760>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
34761>>>>>>>>>                    Send Add_item msg_None             ""
34762>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
34763>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
34764>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
34765>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
34766>>>>>>>>>                    Send Add_item msg_None             ""
34767>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
34768>>>>>>>>>                    Send Add_item msg_None             ""
34769>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
34770>>>>>>>>>                End_Object // cOutlookFloatingMenu
34771>>>>>>>>>
34771>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
34772>>>>>>>>>
34772>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
34774>>>>>>>>>                    Integer new_item liMonth
34775>>>>>>>>>                    Date    ldSysdate
34775>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
34777>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
34779>>>>>>>>>                        If (new_item >= 0) Begin
34781>>>>>>>>>                            Sysdate4 ldSysdate
34782>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
34783>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
34786>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
34788>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
34791>>>>>>>>>                        End
34791>>>>>>>>>>
34791>>>>>>>>>                    End
34791>>>>>>>>>>
34791>>>>>>>>>                    procedure_return new_item
34792>>>>>>>>>                End_Procedure // Current_Item
34793>>>>>>>>>
34793>>>>>>>>>
34793>>>>>>>>>
34793>>>>>>>>>                //AB-StoreEnd
34793>>>>>>>>>
34793>>>>>>>>>            End_Object    // Grid2
34794>>>>>>>>>
34794>>>>>>>>>            Object Textbox2 is a Textbox
34796>>>>>>>>>                Set Label to "Mo"
34797>>>>>>>>>                Set Auto_Size_State to FALSE
34798>>>>>>>>>                Set Transparent_State to TRUE
34799>>>>>>>>>                Set Color to clWhite
34800>>>>>>>>>                Set TextColor to clNavy
34801>>>>>>>>>                Set Location to 19 4
34802>>>>>>>>>                Set Size to 10 15
34803>>>>>>>>>
34803>>>>>>>>>                //AB-StoreStart
34803>>>>>>>>>
34803>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
34804>>>>>>>>>                //AB-StoreEnd
34804>>>>>>>>>
34804>>>>>>>>>            End_Object    // Textbox2
34805>>>>>>>>>
34805>>>>>>>>>            Object Textbox3 is a Textbox
34807>>>>>>>>>                Set Label to "Tu"
34808>>>>>>>>>                Set Auto_Size_State to FALSE
34809>>>>>>>>>                Set Transparent_State to TRUE
34810>>>>>>>>>                Set Color to clWhite
34811>>>>>>>>>                Set TextColor to clNavy
34812>>>>>>>>>                Set Location to 19 22
34813>>>>>>>>>                Set Size to 10 12
34814>>>>>>>>>
34814>>>>>>>>>                //AB-StoreStart
34814>>>>>>>>>
34814>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
34815>>>>>>>>>                //AB-StoreEnd
34815>>>>>>>>>
34815>>>>>>>>>            End_Object    // Textbox3
34816>>>>>>>>>
34816>>>>>>>>>            Object Textbox4 is a Textbox
34818>>>>>>>>>                Set Label to "We"
34819>>>>>>>>>                Set Auto_Size_State to FALSE
34820>>>>>>>>>                Set Transparent_State to TRUE
34821>>>>>>>>>                Set Color to clWhite
34822>>>>>>>>>                Set TextColor to clNavy
34823>>>>>>>>>                Set Location to 19 39
34824>>>>>>>>>                Set Size to 10 15
34825>>>>>>>>>
34825>>>>>>>>>                //AB-StoreStart
34825>>>>>>>>>
34825>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
34826>>>>>>>>>                //AB-StoreEnd
34826>>>>>>>>>
34826>>>>>>>>>            End_Object    // Textbox4
34827>>>>>>>>>
34827>>>>>>>>>            Object Textbox5 is a Textbox
34829>>>>>>>>>                Set Label to "Th"
34830>>>>>>>>>                Set Auto_Size_State to FALSE
34831>>>>>>>>>                Set Transparent_State to TRUE
34832>>>>>>>>>                Set Color to clWhite
34833>>>>>>>>>                Set TextColor to clNavy
34834>>>>>>>>>                Set Location to 19 57
34835>>>>>>>>>                Set Size to 10 17
34836>>>>>>>>>
34836>>>>>>>>>                //AB-StoreStart
34836>>>>>>>>>
34836>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
34837>>>>>>>>>                //AB-StoreEnd
34837>>>>>>>>>
34837>>>>>>>>>            End_Object    // Textbox5
34838>>>>>>>>>
34838>>>>>>>>>            Object Textbox6 is a Textbox
34840>>>>>>>>>                Set Label to "Fr"
34841>>>>>>>>>                Set Auto_Size_State to FALSE
34842>>>>>>>>>                Set Transparent_State to TRUE
34843>>>>>>>>>                Set Color to clWhite
34844>>>>>>>>>                Set TextColor to clNavy
34845>>>>>>>>>                Set Location to 19 76
34846>>>>>>>>>                Set Size to 10 17
34847>>>>>>>>>
34847>>>>>>>>>                //AB-StoreStart
34847>>>>>>>>>
34847>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
34848>>>>>>>>>                //AB-StoreEnd
34848>>>>>>>>>
34848>>>>>>>>>            End_Object    // Textbox6
34849>>>>>>>>>
34849>>>>>>>>>            Object Textbox7 is a Textbox
34851>>>>>>>>>                Set Label to "Sa"
34852>>>>>>>>>                Set Auto_Size_State to FALSE
34853>>>>>>>>>                Set Transparent_State to TRUE
34854>>>>>>>>>                Set Color to clWhite
34855>>>>>>>>>                Set TextColor to clNavy
34856>>>>>>>>>                Set Location to 19 91
34857>>>>>>>>>                Set Size to 10 18
34858>>>>>>>>>
34858>>>>>>>>>                //AB-StoreStart
34858>>>>>>>>>
34858>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
34859>>>>>>>>>                //AB-StoreEnd
34859>>>>>>>>>
34859>>>>>>>>>            End_Object    // Textbox7
34860>>>>>>>>>
34860>>>>>>>>>            Object Textbox8 is a Textbox
34862>>>>>>>>>                Set Label to "Su"
34863>>>>>>>>>                Set Auto_Size_State to FALSE
34864>>>>>>>>>                Set Transparent_State to TRUE
34865>>>>>>>>>                Set Color to clWhite
34866>>>>>>>>>                Set TextColor to clNavy
34867>>>>>>>>>                Set Location to 19 109
34868>>>>>>>>>                Set Size to 10 17
34869>>>>>>>>>
34869>>>>>>>>>                //AB-StoreStart
34869>>>>>>>>>
34869>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
34870>>>>>>>>>                //AB-StoreEnd
34870>>>>>>>>>
34870>>>>>>>>>            End_Object    // Textbox8
34871>>>>>>>>>
34871>>>>>>>>>            Object LineControl1 is a LineControl
34873>>>>>>>>>                Set Line_Style to lnSINGLE
34874>>>>>>>>>                Set Size to 1 116
34875>>>>>>>>>                Set Location to 28 4
34876>>>>>>>>>
34876>>>>>>>>>                //AB-StoreStart
34876>>>>>>>>>
34876>>>>>>>>>                //AB-StoreEnd
34876>>>>>>>>>
34876>>>>>>>>>            End_Object    // LineControl1
34877>>>>>>>>>
34877>>>>>>>>>            Object Container3d2 is a Container3d
34879>>>>>>>>>                Set Size to 18 131
34880>>>>>>>>>                Set Location to 1 1
34881>>>>>>>>>                Set Color to clNavy
34882>>>>>>>>>                Set Border_Style to Border_None
34883>>>>>>>>>                Object oRght is a BitmapContainer
34885>>>>>>>>>                    Set Size to 10 14
34886>>>>>>>>>                    Set Location to 4 105
34887>>>>>>>>>                    Set Bitmap to "rght.bmp"
34888>>>>>>>>>                    Set Border_Style to Border_None
34889>>>>>>>>>
34889>>>>>>>>>                    //AB-StoreStart
34889>>>>>>>>>                    Procedure Mouse_Down
34891>>>>>>>>>                        Send Next_Month to Grid2
34892>>>>>>>>>                    End_Procedure
34893>>>>>>>>>                    //AB-StoreEnd
34893>>>>>>>>>
34893>>>>>>>>>                End_Object    // oRght
34894>>>>>>>>>
34894>>>>>>>>>                Object oLeft is a BitmapContainer
34896>>>>>>>>>                    Set Size to 10 14
34897>>>>>>>>>                    Set Location to 4 3
34898>>>>>>>>>                    Set Bitmap to "lft.bmp"
34899>>>>>>>>>                    Set Border_Style to Border_None
34900>>>>>>>>>
34900>>>>>>>>>                    //AB-StoreStart
34900>>>>>>>>>                    Procedure Mouse_Down
34902>>>>>>>>>                        Send Prev_Month to Grid2
34903>>>>>>>>>                    End_Procedure
34904>>>>>>>>>                    //AB-StoreEnd
34904>>>>>>>>>
34904>>>>>>>>>                End_Object    // oLeft
34905>>>>>>>>>
34905>>>>>>>>>                Object oMonth is a Textbox
34907>>>>>>>>>
34907>>>>>>>>>                    //AB-StoreTopStart
34907>>>>>>>>>                    Property integer piSelected_Month public 0
34909>>>>>>>>>                    //AB-StoreTopEnd
34909>>>>>>>>>
34909>>>>>>>>>                    Set Label to "January"
34910>>>>>>>>>                    Set Auto_Size_State to FALSE
34911>>>>>>>>>                    Set Transparent_State to TRUE
34912>>>>>>>>>                    Set Color to clWhite
34913>>>>>>>>>                    Set TextColor to clWhite
34914>>>>>>>>>                    Set Location to 4 19
34915>>>>>>>>>                    Set Size to 10 46
34916>>>>>>>>>                    Set FontWeight to 800
34917>>>>>>>>>                    Set Justification_Mode to jMode_Center
34918>>>>>>>>>
34918>>>>>>>>>                    //AB-StoreStart
34918>>>>>>>>>
34918>>>>>>>>>                    Procedure Mouse_Down
34920>>>>>>>>>                        Integer iState
34921>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
34922>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
34925>>>>>>>>>                        Send Popup to oSelectMonth
34926>>>>>>>>>                    End_Procedure
34927>>>>>>>>>
34927>>>>>>>>>                    Procedure pSelectJan
34929>>>>>>>>>                        Set Label to t.calendar.january
34930>>>>>>>>>                        Set piSelected_Month to 1
34931>>>>>>>>>                        Send Adjust_Calendar
34932>>>>>>>>>                    End_Procedure
34933>>>>>>>>>                    Procedure pSelectFeb
34935>>>>>>>>>                        Set Label to t.calendar.february
34936>>>>>>>>>                        Set piSelected_Month to 2
34937>>>>>>>>>                        Send Adjust_Calendar
34938>>>>>>>>>                    End_Procedure
34939>>>>>>>>>                    Procedure pSelectMar
34941>>>>>>>>>                        Set Label to t.calendar.march
34942>>>>>>>>>                        Set piSelected_Month to 3
34943>>>>>>>>>                        Send Adjust_Calendar
34944>>>>>>>>>                    End_Procedure
34945>>>>>>>>>                    Procedure pSelectApr
34947>>>>>>>>>                        Set Label to t.calendar.april
34948>>>>>>>>>                        Set piSelected_Month to 4
34949>>>>>>>>>                        Send Adjust_Calendar
34950>>>>>>>>>                    End_Procedure
34951>>>>>>>>>                    Procedure pSelectMay
34953>>>>>>>>>                        Set Label to t.calendar.may
34954>>>>>>>>>                        Set piSelected_Month to 5
34955>>>>>>>>>                        Send Adjust_Calendar
34956>>>>>>>>>                    End_Procedure
34957>>>>>>>>>                    Procedure pSelectJun
34959>>>>>>>>>                        Set Label to t.calendar.june
34960>>>>>>>>>                        Set piSelected_Month to 6
34961>>>>>>>>>                        Send Adjust_Calendar
34962>>>>>>>>>                    End_Procedure
34963>>>>>>>>>                    Procedure pSelectJul
34965>>>>>>>>>                        Set Label to t.calendar.july
34966>>>>>>>>>                        Set piSelected_Month to 7
34967>>>>>>>>>                        Send Adjust_Calendar
34968>>>>>>>>>                    End_Procedure
34969>>>>>>>>>                    Procedure pSelectAug
34971>>>>>>>>>                        Set Label to t.calendar.august
34972>>>>>>>>>                        Set piSelected_Month to 8
34973>>>>>>>>>                        Send Adjust_Calendar
34974>>>>>>>>>                    End_Procedure
34975>>>>>>>>>                    Procedure pSelectSep
34977>>>>>>>>>                        Set Label to t.calendar.september
34978>>>>>>>>>                        Set piSelected_Month to 9
34979>>>>>>>>>                        Send Adjust_Calendar
34980>>>>>>>>>                    End_Procedure
34981>>>>>>>>>                    Procedure pSelectOct
34983>>>>>>>>>                        Set Label to t.calendar.october
34984>>>>>>>>>                        Set piSelected_Month to 10
34985>>>>>>>>>                        Send Adjust_Calendar
34986>>>>>>>>>                    End_Procedure
34987>>>>>>>>>                    Procedure pSelectNov
34989>>>>>>>>>                        Set Label to t.calendar.november
34990>>>>>>>>>                        Set piSelected_Month to 11
34991>>>>>>>>>                        Send Adjust_Calendar
34992>>>>>>>>>                    End_Procedure
34993>>>>>>>>>                    Procedure pSelectDec
34995>>>>>>>>>                        Set Label to t.calendar.december
34996>>>>>>>>>                        Set piSelected_Month to 12
34997>>>>>>>>>                        Send Adjust_Calendar
34998>>>>>>>>>                    End_Procedure
34999>>>>>>>>>
34999>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
35001>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
35002>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
35003>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
35004>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
35005>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
35006>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
35007>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
35008>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
35009>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
35010>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
35011>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
35012>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
35013>>>>>>>>>                    End_Object
35014>>>>>>>>>
35014>>>>>>>>>                    Procedure Adjust_Calendar
35016>>>>>>>>>                        Date date#
35017>>>>>>>>>                        Integer iDay iMonth iYear iItm
35017>>>>>>>>>                        Set Visible_State to false
35018>>>>>>>>>                        Set Visible_State to true
35019>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
35020>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
35021>>>>>>>>>                        Get piSelected_Month to iMonth
35022>>>>>>>>>                        Get Label of oCalendarYear to iYear
35023>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
35024>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
35025>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
35026>>>>>>>>>                    End_Procedure
35027>>>>>>>>>
35027>>>>>>>>>                    Procedure Activating
35029>>>>>>>>>                        Forward Send Activating
35031>>>>>>>>>                        Send Date_Changing
35032>>>>>>>>>                    End_Procedure
35033>>>>>>>>>
35033>>>>>>>>>                    Procedure Date_Changing
35035>>>>>>>>>                        Set Visible_State to false
35036>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
35037>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
35038>>>>>>>>>                        Set Visible_State to true
35039>>>>>>>>>                    End_Procedure
35040>>>>>>>>>
35040>>>>>>>>>
35040>>>>>>>>>
35040>>>>>>>>>                    //AB-StoreEnd
35040>>>>>>>>>
35040>>>>>>>>>                End_Object    // oMonth
35041>>>>>>>>>
35041>>>>>>>>>                Object oCalendarYear is a Textbox
35043>>>>>>>>>                    Set Label to "2001"
35044>>>>>>>>>                    Set Transparent_State to TRUE
35045>>>>>>>>>                    Set Color to clWhite
35046>>>>>>>>>                    Set TextColor to clWhite
35047>>>>>>>>>                    Set Location to 4 77
35048>>>>>>>>>                    Set Size to 10 18
35049>>>>>>>>>                    Set FontWeight to 800
35050>>>>>>>>>
35050>>>>>>>>>                    //AB-StoreStart
35050>>>>>>>>>
35050>>>>>>>>>                    Procedure Mouse_Down
35052>>>>>>>>>                        String sVal
35053>>>>>>>>>                        Get Label to sVal
35054>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
35055>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
35056>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
35057>>>>>>>>>                    End_Procedure
35058>>>>>>>>>
35058>>>>>>>>>                    Procedure Activating
35060>>>>>>>>>                        Forward Send Activating
35062>>>>>>>>>                        Send Date_Changing
35063>>>>>>>>>                    End_Procedure
35064>>>>>>>>>
35064>>>>>>>>>                    Procedure Date_Changing
35066>>>>>>>>>                        Set Visible_State to false
35067>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
35068>>>>>>>>>                        Set Visible_State to true
35069>>>>>>>>>                    End_Procedure
35070>>>>>>>>>
35070>>>>>>>>>                    //AB-StoreEnd
35070>>>>>>>>>
35070>>>>>>>>>                End_Object    // oCalendarYear
35071>>>>>>>>>
35071>>>>>>>>>                Object oSelectCalendarYear is a Form
35073>>>>>>>>>
35073>>>>>>>>>                    //AB-StoreTopStart
35073>>>>>>>>>                    Set Visible_State To False
35074>>>>>>>>>                    //AB-StoreTopEnd
35074>>>>>>>>>
35074>>>>>>>>>                    Set Size to 10 24
35075>>>>>>>>>                    Set Location to 4 75
35076>>>>>>>>>                    Set Color to clWhite
35077>>>>>>>>>                    Set TextColor to clNavy
35078>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
35079>>>>>>>>>
35079>>>>>>>>>                    //AB-StoreStart
35079>>>>>>>>>
35079>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
35080>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
35081>>>>>>>>>
35081>>>>>>>>>                    Procedure SetFontWeight
35083>>>>>>>>>                        Set Form_FontWeight item 0 to 800
35084>>>>>>>>>                    End_Procedure
35085>>>>>>>>>
35085>>>>>>>>>                    Procedure OnKillFocus
35087>>>>>>>>>                        String sVal
35088>>>>>>>>>                        Integer iMonth iDay iYear iItm
35088>>>>>>>>>                        Date date#
35088>>>>>>>>>                        Get Value item 0 to sVal
35089>>>>>>>>>                        Set Visible_State of oCalendarYear to false
35090>>>>>>>>>                        Set Label of oCalendarYear to sVal
35091>>>>>>>>>                        Set Visible_State of oCalendarYear to true
35092>>>>>>>>>                        Set Visible_State to false
35093>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
35094>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
35095>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
35096>>>>>>>>>                        Get Value item 0 to iYear
35097>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
35100>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
35101>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
35102>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
35103>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
35104>>>>>>>>>                    End_Procedure
35105>>>>>>>>>
35105>>>>>>>>>                    Send SetFontWeight
35106>>>>>>>>>
35106>>>>>>>>>
35106>>>>>>>>>
35106>>>>>>>>>                    //AB-StoreEnd
35106>>>>>>>>>
35106>>>>>>>>>                End_Object    // oSelectCalendarYear
35107>>>>>>>>>
35107>>>>>>>>>
35107>>>>>>>>>                //AB-StoreStart
35107>>>>>>>>>
35107>>>>>>>>>                Procedure Mouse_Down
35109>>>>>>>>>                    Integer iState
35110>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
35111>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
35114>>>>>>>>>                End_Procedure
35115>>>>>>>>>
35115>>>>>>>>>
35115>>>>>>>>>                //AB-StoreEnd
35115>>>>>>>>>
35115>>>>>>>>>            End_Object    // Container3d2
35116>>>>>>>>>
35116>>>>>>>>>
35116>>>>>>>>>            //AB-StoreStart
35116>>>>>>>>>
35116>>>>>>>>>
35116>>>>>>>>>            //AB-StoreEnd
35116>>>>>>>>>
35116>>>>>>>>>        End_Object    // Container3d1
35117>>>>>>>>>
35117>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
35119>>>>>>>>>            Set Size to 9 19
35120>>>>>>>>>            Set Location to 88 3
35121>>>>>>>>>            Set Color to clWhite
35122>>>>>>>>>            Set Bitmap to "cdate.bmp"
35123>>>>>>>>>            Set Border_Style to Border_None
35124>>>>>>>>>
35124>>>>>>>>>            //AB-StoreStart
35124>>>>>>>>>            Procedure Mouse_Down
35126>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
35127>>>>>>>>>                Send Adjust_Label to oToday
35128>>>>>>>>>            End_Procedure
35129>>>>>>>>>            //AB-StoreEnd
35129>>>>>>>>>
35129>>>>>>>>>        End_Object    // BitmapContainer3
35130>>>>>>>>>
35130>>>>>>>>>        Object oToday is a Textbox
35132>>>>>>>>>            Set Label to "Today: 01.01.2001"
35133>>>>>>>>>            Set Auto_Size_State to FALSE
35134>>>>>>>>>            Set Color to clWhite
35135>>>>>>>>>            Set Location to 88 22
35136>>>>>>>>>            Set Size to 8 70
35137>>>>>>>>>            Set FontWeight to 800
35138>>>>>>>>>
35138>>>>>>>>>            //AB-StoreStart
35138>>>>>>>>>            Procedure Mouse_Down
35140>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
35141>>>>>>>>>                Send Adjust_Label
35142>>>>>>>>>            End_Procedure
35143>>>>>>>>>
35143>>>>>>>>>            Procedure Adjust_Label
35145>>>>>>>>>                date date#
35146>>>>>>>>>                SysDate4 date#
35147>>>>>>>>>                Set Visible_State To false
35148>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
35149>>>>>>>>>                Set Visible_State To true
35150>>>>>>>>>            End_Procedure
35151>>>>>>>>>
35151>>>>>>>>>            Procedure Activating
35153>>>>>>>>>                Forward Send Activating
35155>>>>>>>>>                Send Adjust_Label
35156>>>>>>>>>            End_Procedure
35157>>>>>>>>>            //AB-StoreEnd
35157>>>>>>>>>
35157>>>>>>>>>        End_Object    // oToday
35158>>>>>>>>>
35158>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
35160>>>>>>>>>            Set Size to 9 10
35161>>>>>>>>>            Set Location to 88 112
35162>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
35163>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
35164>>>>>>>>>
35164>>>>>>>>>            //AB-StoreStart
35164>>>>>>>>>
35164>>>>>>>>>            Procedure Mouse_Up
35166>>>>>>>>>                Send Close_Calendar
35167>>>>>>>>>            End_Procedure // Mouse_Up
35168>>>>>>>>>
35168>>>>>>>>>
35168>>>>>>>>>
35168>>>>>>>>>
35168>>>>>>>>>            //AB-StoreEnd
35168>>>>>>>>>
35168>>>>>>>>>        End_Object    // oCloseCalendar_bn
35169>>>>>>>>>
35169>>>>>>>>>
35169>>>>>>>>>        //AB-StoreStart
35169>>>>>>>>>
35169>>>>>>>>>        Set Block_Mouse_State to True
35170>>>>>>>>>        Set Popup_State to True
35171>>>>>>>>>        Set Locate_Mode to Popup_Locate
35172>>>>>>>>>
35172>>>>>>>>>        procedure popup
35174>>>>>>>>>            local integer focus# icItm iYear iMonth
35175>>>>>>>>>            local date date#
35175>>>>>>>>>            move (focus(desktop)) to focus#
35176>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
35177>>>>>>>>>            get value of focus# item current to date#
35178>>>>>>>>>            ifnot (integer(date#)) sysdate date#
35181>>>>>>>>>            move (Date2to4(date#)) to date#
35182>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
35183>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
35184>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
35185>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
35186>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
35187>>>>>>>>>            forward send popup
35189>>>>>>>>>        end_procedure
35190>>>>>>>>>
35190>>>>>>>>>        Procedure Close_Calendar
35192>>>>>>>>>            Send Close_Panel
35193>>>>>>>>>        End_Procedure // Close_Calendar
35194>>>>>>>>>
35194>>>>>>>>>        Object Help_Container is a Container3d
35196>>>>>>>>>            Set Location to 0 0
35197>>>>>>>>>            Set Size     to 98 122
35198>>>>>>>>>            Set Visible_State to False
35199>>>>>>>>>            Set Enabled_State to False
35200>>>>>>>>>            Set Border_Style to Border_None
35201>>>>>>>>>            Set TextColor to clNavy
35202>>>>>>>>>
35202>>>>>>>>>            Object Help_Info is an Edit
35204>>>>>>>>>                Set Location to 0 0
35205>>>>>>>>>                Set Size     to 98 122
35206>>>>>>>>>                Set read_only_state to true
35207>>>>>>>>>                Set Border_Style to Border_None
35208>>>>>>>>>                Set scroll_bar_visible_state to False
35209>>>>>>>>>                Set FontWeight to 800
35210>>>>>>>>>
35210>>>>>>>>>                Procedure ReadHelpComments
35212>>>>>>>>>                    String lsFile
35213>>>>>>>>>
35213>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
35214>>>>>>>>>                    If (lsFile <> "") Send read lsFile
35217>>>>>>>>>                End_Procedure // ReadHelpComments
35218>>>>>>>>>
35218>>>>>>>>>                Procedure SetComments
35220>>>>>>>>>                    Send append_text "Help on Calendar"
35221>>>>>>>>>                    Send Insert ""
35222>>>>>>>>>                    Send Insert ""
35223>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
35224>>>>>>>>>                    Send Insert ""
35225>>>>>>>>>                    Send append_text "  - select date."
35226>>>>>>>>>                    Send Insert ""
35227>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
35228>>>>>>>>>                    Send Insert ""
35229>>>>>>>>>                    Send append_text "  - select month."
35230>>>>>>>>>                    Send Insert ""
35231>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
35232>>>>>>>>>                    Send Insert ""
35233>>>>>>>>>                    Send append_text "  - set current date."
35234>>>>>>>>>                    Send Insert ""
35235>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
35236>>>>>>>>>                    Send Insert ""
35237>>>>>>>>>                    Send append_text "  - Change year."
35238>>>>>>>>>                    Send Insert ""
35239>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
35240>>>>>>>>>                    Send Insert ""
35241>>>>>>>>>                    Send append_text "  - Select year."
35242>>>>>>>>>                End_procedure // SetComments
35243>>>>>>>>>
35243>>>>>>>>>                //Send SetComments
35243>>>>>>>>>                Set Color     to clWhite
35244>>>>>>>>>                Set TextColor to clNavy
35245>>>>>>>>>
35245>>>>>>>>>                Procedure OnSetFocus
35247>>>>>>>>>                    Send ReadHelpComments
35248>>>>>>>>>                End_Procedure
35249>>>>>>>>>
35249>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
35251>>>>>>>>>
35251>>>>>>>>>                    Procedure Close_Help
35253>>>>>>>>>                        Send Close_Help to Help_Container
35254>>>>>>>>>                    End_Procedure // Close_Calendar
35255>>>>>>>>>
35255>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
35256>>>>>>>>>                End_Object // cOutlookFloatingMenu
35257>>>>>>>>>
35257>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
35259>>>>>>>>>                    Send Popup to HelpFloatingMenu
35260>>>>>>>>>                End_Procedure // Mouse_Up2
35261>>>>>>>>>
35261>>>>>>>>>            End_Object
35262>>>>>>>>>
35262>>>>>>>>>            Procedure Close_Help
35264>>>>>>>>>                Send Delete_Data to Help_Info
35265>>>>>>>>>                Set Visible_State to False
35266>>>>>>>>>                Set Enabled_State to False
35267>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
35268>>>>>>>>>            End_Procedure // Close_Help
35269>>>>>>>>>
35269>>>>>>>>>            On_Key kCancel Send Close_Help
35270>>>>>>>>>            On_Key Key_F1  Send Close_Help
35271>>>>>>>>>            On_Key kEnter  Send Close_Help
35272>>>>>>>>>        End_Object // Help_Info
35273>>>>>>>>>
35273>>>>>>>>>        on_key kcancel           send Close_Calendar
35274>>>>>>>>>
35274>>>>>>>>>
35274>>>>>>>>>
35274>>>>>>>>>
35274>>>>>>>>>
35274>>>>>>>>>
35274>>>>>>>>>        //AB-StoreEnd
35274>>>>>>>>>
35274>>>>>>>>>    End_Object    // oCalendar
35275>>>>>>>>>
35275>>>>>>>>>
35275>>>>>>>>>    //AB-StoreStart
35275>>>>>>>>>
35275>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
35276>>>>>>>>>        Integer focus# type# dm#
35277>>>>>>>>>
35277>>>>>>>>>        move (focus(desktop)) to focus#
35278>>>>>>>>>        if focus# gt desktop begin
35280>>>>>>>>>          get delegation_mode of focus# to dm#
35281>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
35282>>>>>>>>>          get form_datatype of focus# item current to type#
35283>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
35286>>>>>>>>>          set delegation_mode of focus# to dm#
35287>>>>>>>>>        end
35287>>>>>>>>>>
35287>>>>>>>>>    End_Procedure
35288>>>>>>>>>
35288>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
35289>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
35290>>>>>>>>>
35290>>>>>>>>>
35290>>>>>>>>>    //AB-StoreEnd
35290>>>>>>>>>
35290>>>>>>>>>//AB/     End_Object    // prj
35290>>>>>>>Use Dates.Utl
35290>>>>>>>
35290>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
35290>>>>>>>   Define cDateToday        for "T"
35290>>>>>>>   Define cDateBeginOfMonth for "B"
35290>>>>>>>   Define cDateEndOfMonth   for "E"
35290>>>>>>>
35290>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
35291>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
35292>>>>>>>      Property Date    pdOriginal_Value          Public 0
35293>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
35294>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
35295>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
35296>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
35297>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
35298>>>>>>>
35298>>>>>>>   Procedure DoAddOneDay
35299>>>>>>>        Integer rVal
35300>>>>>>>        Date dHmnia
35300>>>>>>>
35300>>>>>>>        Get Value Item 0 to dHmnia
35301>>>>>>>        Add 1 to dHmnia
35302>>>>>>>        Set Value Item 0 to dHmnia
35303>>>>>>>    End_Procedure // Add_One_Day
35304>>>>>>>
35304>>>>>>>    Procedure DoSubOneDay
35305>>>>>>>        Integer rVal
35306>>>>>>>        Date dHmnia
35306>>>>>>>
35306>>>>>>>        Get Value Item 0 to dHmnia
35307>>>>>>>        Sub 1 to dHmnia
35308>>>>>>>        Set Value Item 0 to dHmnia
35309>>>>>>>    End_Procedure // Add_One_Day
35310>>>>>>>
35310>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
35310>>>>>>>   Procedure Entering returns Integer
35311>>>>>>>      Integer iRetVal
35312>>>>>>>      Date    dOriginal
35312>>>>>>>      Forward Get Msg_Entering to iRetVal
35314>>>>>>>      If (iRetVal = 0) Begin
35316>>>>>>>         Send DoStoreOriginalDate
35317>>>>>>>      End
35317>>>>>>>>
35317>>>>>>>      Procedure_Return iRetVal
35318>>>>>>>   End_Procedure // Entering
35319>>>>>>>
35319>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
35319>>>>>>>   //       value with the intention to only change the day-part of the current date.
35319>>>>>>>   Procedure Next
35320>>>>>>>      Send DoIntelliSenseDate
35321>>>>>>>      Forward Send Next
35323>>>>>>>   End_Procedure // Next
35324>>>>>>>
35324>>>>>>>   // **WvA: Store the current date-value before any changes are made
35324>>>>>>>   Procedure DoStoreOriginalDate
35325>>>>>>>      Date    dOriginal
35326>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
35326>>>>>>>         Get Value Item 0 to dOriginal
35327>>>>>>>         Set pdOriginal_Value to dOriginal
35328>>>>>>>      //End
35328>>>>>>>   End_Procedure // DoStoreOriginalDate
35329>>>>>>>
35329>>>>>>>   Procedure DoIntelliSenseDate
35330>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
35331>>>>>>>      Date    dCurrent dOriginal
35331>>>>>>>      String  sStored  sCurrent sSep sMask
35331>>>>>>>
35331>>>>>>>      Get Item_Changed_State Item 0 to bChanged
35332>>>>>>>      Get pdOriginal_Value to dOriginal
35333>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
35335>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
35338>>>>>>>
35338>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
35338>>>>>>>         // USA dates.
35338>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
35339>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
35340>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
35343>>>>>>>         Move (Character(iSep)) to sSep
35344>>>>>>>
35344>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
35344>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
35345>>>>>>>         Move (sSep+sSep) to sMask
35346>>>>>>>
35346>>>>>>>         // Now check if the user just entered a day or a day and a month.
35346>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
35346>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
35346>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
35346>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
35348>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
35349>>>>>>>            Move sCurrent to iCurrent
35350>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
35352>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
35355>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
35357>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
35358>>>>>>>               End
35358>>>>>>>>
35358>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
35361>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
35362>>>>>>>               End
35362>>>>>>>>
35362>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
35365>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
35366>>>>>>>               End
35366>>>>>>>>
35366>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
35367>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
35367>>>>>>>>
35367>>>>>>>         End
35367>>>>>>>>
35367>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
35370>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
35373>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
35375>>>>>>>               Move (Right(dOriginal,4)) to iYear
35376>>>>>>>            End
35376>>>>>>>>
35376>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
35379>>>>>>>               Move (Left(dOriginal,4))  to iYear
35380>>>>>>>            End
35380>>>>>>>>
35380>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
35381>>>>>>>         End
35381>>>>>>>>
35381>>>>>>>      End
35381>>>>>>>>
35381>>>>>>>   End_Procedure // DoIntelliSenseDate
35382>>>>>>>
35382>>>>>>>   Procedure Key Integer iKey Returns Integer
35383>>>>>>>      Date dToday dTemp
35384>>>>>>>      Sysdate4 dToday
35385>>>>>>>
35385>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
35387>>>>>>>         Set Value to dToday
35388>>>>>>>      End
35388>>>>>>>>
35388>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
35391>>>>>>>         Get FirstDayInMonth dToday to dTemp
35392>>>>>>>         Set Value to dTemp
35393>>>>>>>      End
35393>>>>>>>>
35393>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
35396>>>>>>>         Get LastDayInMonth dToday to dTemp
35397>>>>>>>         Set Value to dTemp
35398>>>>>>>      End
35398>>>>>>>>
35398>>>>>>>      Else Forward Send Key iKey
35401>>>>>>>   End_procedure
35402>>>>>>>
35402>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
35403>>>>>
35403>>>>>Class cSyDateForm Is A FormSub
35404>>>>>   Procedure Construct_Object
35405>>>>>      Forward Send Construct_Object
35407>>>>>
35407>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
35408>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
35409>>>>>
35409>>>>>      Send DoDefineIntelliSenseDateMixin
35410>>>>>
35410>>>>>      On_Key kPrompt Send Prompt
35411>>>>>
35411>>>>>      Set Prompt_Object to (oCalendar(Self))
35412>>>>>      Set Status_Help   to cStatusHelp
35413>>>>>
35413>>>>>   End_Procedure // Construct_Object
35414>>>>>
35414>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
35415>>>>>
35415>>>>>//   Function Form_Datatype Integer iItem Returns Integer
35415>>>>>//      Integer iDatatype
35415>>>>>//
35415>>>>>//      If (iItem = Current) Begin
35415>>>>>//         Get Current_Item to iItem
35415>>>>>//      End
35415>>>>>//
35415>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
35415>>>>>//
35415>>>>>//      Function_Return iDatatype
35415>>>>>//   End_Function // Form_Datatype
35415>>>>>
35415>>>>>End_Class // cSyDateForm
35416>>>
35416>>>//AB-IgnoreEnd
35416>>>
35416>>>ACTIVATE_VIEW Activate_ClearPasswords FOR ClearPasswords
35420>>>
35420>>>Object ClearPasswords is a dbViewSub
35422>>>
35422>>>    //AB-StoreTopStart
35422>>>                                        
35422>>>    //AB-StoreTopEnd
35422>>>
35422>>>    Set Label to "‹ž›œ¤ ©£æª ¡à› ¡à¤ œ ©æ›¦¬ ®¨ž©«é¤"
35423>>>    Set Size to 169 275
35424>>>    Set Location to 6 7
35425>>>
35425>>>    //AB-DDOStart
35425>>>
35425>>>
35425>>>    //AB-DDOEnd
35425>>>
35425>>>    Object TextBoxSub1 is a TextBoxSub
35427>>>        Set Label to "„§â¢¥œ •¨ã©«ž"
35428>>>        Set Location to 13 11
35429>>>        Set Size to 10 53
35430>>>        Set TypeFace to "MS Sans Serif"
35431>>>    End_Object    // TextBoxSub1
35432>>>
35432>>>    Object frmUserID is a FormSub
35434>>>
35434>>>        //AB-StoreTopStart
35434>>>                
35434>>>        //AB-StoreTopEnd
35434>>>
35434>>>        Set Size to 13 79
35435>>>        Set Location to 12 67
35436>>>        Set Label_Col_Offset to 2
35437>>>        Set Prompt_Button_Mode to pb_PromptOn
35438>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35439>>>
35439>>>        //AB-StoreStart
35439>>>                
35439>>>        Set Prompt_Object to (slUsers(Self))
35440>>>        
35440>>>        Procedure Prompt_CallBack Integer iPromptID
35442>>>            Set Initial_Column  Of iPromptID to 3
35443>>>            Set Export_Column   Of iPromptID to 3
35444>>>        End_Procedure
35445>>>        
35445>>>        Procedure OnChange
35447>>>            String sID sName
35448>>>            Get Value Item 0 to sID
35449>>>            Clear Users
35450>>>            Move sID to Users.Login_ID
35451>>>            Find Eq Users By Index.1
35452>>>>
35452>>>            Set Value Of frmUserName Item 0 to (Trim(Users.name))
35453>>>        
35453>>>        End_Procedure
35454>>>        
35454>>>        
35454>>>        
35454>>>        
35454>>>        
35454>>>        //AB-StoreEnd
35454>>>
35454>>>    End_Object    // frmUserID
35455>>>
35455>>>    Object frmUserName is a FormSub
35457>>>        Set Size to 13 183
35458>>>        Set Location to 26 67
35459>>>        Set Color to clBtnFace
35460>>>        Set Label_Col_Offset to 2
35461>>>        Set Enabled_State to FALSE
35462>>>        Set Form_FontWeight Item 0 to 600
35463>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35464>>>        Set Item_Shadow_State Item 0 to TRUE
35465>>>        Set Shadow_State Item 0 to TRUE
35466>>>    End_Object    // frmUserName
35467>>>
35467>>>    Object ButtonSub1 is a ButtonSub
35469>>>
35469>>>        //AB-StoreTopStart
35469>>>        
35469>>>        //AB-StoreTopEnd
35469>>>
35469>>>        Set Label to "‹ž›œ¤ ©£æª ¡à› ¡é¤ ŽŠ—Œ «à¤ ®¨ž©«é¤"
35470>>>        Set Size to 12 180
35471>>>        Set Location to 84 45
35472>>>        Set Focus_Mode to Pointer_Only
35473>>>        Set Form_FontWeight Item 0 to 600
35474>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35475>>>
35475>>>        //AB-StoreStart
35475>>>        
35475>>>        Procedure OnClick
35477>>>            Integer iYesNo iOK
35478>>>            Date    dHmnia
35478>>>            Sysdate dHmnia
35479>>>            Sub 1 from dHmnia
35480>>>            Get YesNo_Box "„å©«œ ˜§æ¢¬«˜ ©åš¦¬¨¦ª(ž) ¦«  Ÿâ¢œ«œ ¤˜ £ž›œ¤å©œ«œ ŽŠŽ“‘ «¦¬ª ¡à› ¡¦çª ŽŠ—Œ «à¤ ®¨ž©«é¤ ;" "** Ž‘Ž•† **" to iYesNo
35481>>>            If (iYesNo=MBR_NO) Procedure_Return
35484>>>        
35484>>>            Get YesNo_Box "„å©«œ „Œ’„Š—‘ ¡˜  €ŽŠ“’€ ©åš¦¬¨¦ª(ž) ¦«  Ÿâ¢œ«œ ¤˜ £ž›œ¤å©œ«œ ŽŠŽ“‘ «¦¬ª ¡à› ¡¦çª ŽŠ—Œ «à¤ ®¨ž©«é¤ ;" "** Ž‘Ž•† **" to iYesNo
35485>>>            If (iYesNo=MBR_NO) Procedure_Return
35488>>>        
35488>>>            Clear Users
35489>>>            Find GE Users.Recnum
35490>>>>
35490>>>            While (Found)
35494>>>                Set Label Of ButtonSub3 to (Trim(Users.Login_ID)+"  "+Trim(Users.Name))
35495>>>                Reread Users
35499>>>                Move ""     to Users.Password
35500>>>                Move ""     to Users.Last_Login_Date
35501>>>                Move ""     to Users.Last_Login_Time
35502>>>                Move ""     to Users.Last_Password
35503>>>                Move ""     to Users.Last_Change
35504>>>                Move ""     to Users.Anenergos
35505>>>                Move ""     to Users.Block_Until_D
35506>>>                Move ""     to Users.Block_Until_T
35507>>>                Move dHmnia to Users.Next_Change
35508>>>                Saverecord Users
35509>>>                Unlock
35510>>>>
35510>>>                Find GT Users.Recnum
35511>>>>
35511>>>            Loop
35512>>>>
35512>>>        
35512>>>            Clear UsersH
35513>>>            Find GE UsersH.Recnum
35514>>>>
35514>>>            While (Found)
35518>>>                Delete UsersH
35519>>>                Find GT UsersH.Recnum
35520>>>>
35520>>>            Loop
35521>>>>
35521>>>        
35521>>>            Reread Sysrec
35525>>>            Move  1 to Sysrec.LIBCAST_CODE
35526>>>            Move  1 to Sysrec.AWARD_CODE
35527>>>            Move  1 to Sysrec.GIVAWRD_CODE
35528>>>            Move  1 to Sysrec.MOVIE_LNK_CODE
35529>>>            Move  1 to Sysrec.CAST_LNK_CODE
35530>>>            Move  1 to Sysrec.AWARDTP_CODE
35531>>>            Move  1 to Sysrec.FESTIVAL_CODE
35532>>>            Move  0 to Sysrec.STWHAT_CODE
35533>>>            Move  1 to Sysrec.SNWHAT_CODE
35534>>>            Move 90 to Sysrec.LIBVIS_CODE
35535>>>            Move  3 to Sysrec.TIKANEI_CODE
35536>>>            Saverecord Sysrec
35537>>>            Unlock
35538>>>>
35538>>>            Reread Sysrec
35542>>>            Unlock
35543>>>>
35543>>>        
35543>>>            Set Value Of frmNewDate Item 0 to ""
35544>>>            Set Value Of frmUserID  Item 0 to ""
35545>>>        
35545>>>            Set Label Of ButtonSub3 to ""
35546>>>            Send Info_Box "î¢¦  ¦  ¡à› ¡¦å æ¢à¤ «à¤ ®¨ž©«é¤ £ž›œ¤å©«ž¡˜¤" "¢ž¨¦­¦¨å˜"
35547>>>        End_Procedure // OnClick
35548>>>        
35548>>>        
35548>>>        
35548>>>        //AB-StoreEnd
35548>>>
35548>>>    End_Object    // ButtonSub1
35549>>>
35549>>>    Object ButtonSub2 is a ButtonSub
35551>>>
35551>>>        //AB-StoreTopStart
35551>>>        
35551>>>        //AB-StoreTopEnd
35551>>>
35551>>>        Set Label to "‹ž›œ¤ ©£æª ¡à› ¡¦ç š ˜ œ§ ¢œš£â¤¦ ®¨ã©«ž"
35552>>>        Set Size to 20 249
35553>>>        Set Location to 49 11
35554>>>        Set Focus_Mode to Pointer_Only
35555>>>        Set Form_FontWeight Item 0 to 600
35556>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35557>>>
35557>>>        //AB-StoreStart
35557>>>        
35557>>>        Procedure OnClick
35559>>>            Integer iYesNo iOK
35560>>>            String  sID sTmp
35560>>>            Date    dHmnia
35560>>>            Sysdate dHmnia
35561>>>            Sub 1 from dHmnia
35562>>>            Get Value Of frmUserID Item 0 to sID
35563>>>            Move (Trim(sID)) to sID
35564>>>            Clear Users
35565>>>            Move sID to Users.Login_ID
35566>>>            Find Eq Users By Index.1
35567>>>>
35567>>>            If (Not(Found)) Begin
35569>>>                Send Stop_Box "€¤ç§˜¨¡«¦ª •¨ã©«žª" "‘­á¢£˜ 1050"
35570>>>                Procedure_return
35571>>>            End
35571>>>>
35571>>>            Move ("‡â¢œ«œ ¤˜ £ž›œ¤å©œ«œ «¦¤ ¡à› ¡æ œ ©æ›¦¬ «¦¬ ®¨ã©«ž "+Trim(sID)+" - "+Trim(Users.Name)+" ;") to sTmp
35572>>>            Get YesNo_Box sTmp "** Ž‘Ž•† **" to iYesNo
35573>>>            If (iYesNo=MBR_NO) Procedure_Return
35576>>>        
35576>>>            Set Label Of ButtonSub3 to (Trim(Users.Login_ID)+"  "+Trim(Users.Name))
35577>>>            Reread Users
35581>>>            Move ""     to Users.Password
35582>>>            Move ""     to Users.Last_Login_Date
35583>>>            Move ""     to Users.Last_Login_Time
35584>>>            Move ""     to Users.Last_Password
35585>>>            Move ""     to Users.Last_Change
35586>>>            Move ""     to Users.Anenergos
35587>>>            Move ""     to Users.Block_Until_D
35588>>>            Move ""     to Users.Block_Until_T
35589>>>            Move dHmnia to Users.Next_Change
35590>>>            Saverecord Users
35591>>>            Unlock
35592>>>>
35592>>>        
35592>>>            Clear UsersH
35593>>>            Move sID to UsersH.Login_ID
35594>>>            Find GE UsersH By Index.1
35595>>>>
35595>>>            While ((Found) And (UsersH.Login_ID=sID))
35599>>>                Delete UsersH
35600>>>                Find GT UsersH By Index.1
35601>>>>
35601>>>            Loop
35602>>>>
35602>>>        
35602>>>            Reread Sysrec
35606>>>            Move  1 to Sysrec.LIBCAST_CODE
35607>>>            Move  1 to Sysrec.AWARD_CODE
35608>>>            Move  1 to Sysrec.GIVAWRD_CODE
35609>>>            Move  1 to Sysrec.MOVIE_LNK_CODE
35610>>>            Move  1 to Sysrec.CAST_LNK_CODE
35611>>>            Move  1 to Sysrec.AWARDTP_CODE
35612>>>            Move  1 to Sysrec.FESTIVAL_CODE
35613>>>            Move  0 to Sysrec.STWHAT_CODE
35614>>>            Move  1 to Sysrec.SNWHAT_CODE
35615>>>            Move 90 to Sysrec.LIBVIS_CODE
35616>>>            Move  3 to Sysrec.TIKANEI_CODE
35617>>>            Saverecord Sysrec
35618>>>            Unlock
35619>>>>
35619>>>            Reread Sysrec
35623>>>            Unlock
35624>>>>
35624>>>        
35624>>>            Set Value Of frmNewDate Item 0 to ""
35625>>>            Set Value Of frmUserID  Item 0 to ""
35626>>>        
35626>>>            Set Label Of ButtonSub3 to ""
35627>>>            Send Info_Box "Ž ¡à› ¡æª «¦¬ ®¨ã©«ž £ž›œ¤å©«ž¡œ" "¢ž¨¦­¦¨å˜"
35628>>>        End_Procedure // OnClick
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        
35629>>>        //AB-StoreEnd
35629>>>
35629>>>    End_Object    // ButtonSub2
35630>>>
35630>>>    Object ButtonSub3 is a ButtonSub
35632>>>
35632>>>        //AB-StoreTopStart
35632>>>                                                                                    
35632>>>        //AB-StoreTopEnd
35632>>>
35632>>>        Set Size to 14 262
35633>>>        Set Location to 135 4
35634>>>        Set Border_Style to Border_ClientEdge
35635>>>        Set Enabled_State to FALSE
35636>>>        Set Focus_Mode to NonFocusable
35637>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35638>>>        Set Item_Shadow_State Item 0 to TRUE
35639>>>        Set Shadow_State Item 0 to TRUE
35640>>>
35640>>>        //AB-StoreStart
35640>>>                                                                                    
35640>>>                                                                                    
35640>>>        //AB-StoreEnd
35640>>>
35640>>>    End_Object    // ButtonSub3
35641>>>
35641>>>    Object TextBoxSub2 is a TextBoxSub
35643>>>        Set Label to "Œœ˜ †£/¤å˜ Šã¥žª"
35644>>>        Set Location to 113 11
35645>>>        Set Size to 12 63
35646>>>        Set TypeFace to "MS Sans Serif"
35647>>>    End_Object    // TextBoxSub2
35648>>>
35648>>>    Object frmNewDate is a cSyDateForm
35650>>>        Set Size to 13 66
35651>>>        Set Location to 113 81
35652>>>        Set Label_Col_Offset to 2
35653>>>        Set Label_Justification_Mode to jMode_Right
35654>>>        Set Form_Mask Item 0 to "dd-MMM-yy"
35655>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35656>>>    End_Object    // frmNewDate
35657>>>
35657>>>    Object ButtonSub4 is a ButtonSub
35659>>>
35659>>>        //AB-StoreTopStart
35659>>>        
35659>>>        //AB-StoreTopEnd
35659>>>
35659>>>        Set Label to "€¢¢˜šã †£/¤å˜ª Šã¥žª"
35660>>>        Set Size to 14 98
35661>>>        Set Location to 113 162
35662>>>        Set Focus_Mode to Pointer_Only
35663>>>        Set Form_FontWeight Item 0 to 600
35664>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
35665>>>
35665>>>        //AB-StoreStart
35665>>>        
35665>>>        Procedure OnClick
35667>>>            Integer iYesNo iOK
35668>>>            String  sID sTmp
35668>>>            Date    dHmnia
35668>>>            Get Value Of frmNewDate Item 0 to dHmnia
35669>>>            Get Value Of frmUserID  Item 0 to sID
35670>>>            Move (Trim(sID)) to sID
35671>>>        
35671>>>            If (dHmnia="") Begin
35673>>>                Send Stop_Box "† ž£œ¨¦£ž¤å˜ œå¤˜  ¡œ¤ã" "‘­á¢£˜ 1170"
35674>>>                Procedure_return
35675>>>            End
35675>>>>
35675>>>        
35675>>>            If (sID<>"") Begin
35677>>>                Clear Users
35678>>>                Move sID to Users.Login_ID
35679>>>                Find Eq Users By Index.1
35680>>>>
35680>>>                If (Not(Found)) Begin
35682>>>                    Send Stop_Box "€¤ç§˜¨¡«¦ª •¨ã©«žª" "‘­á¢£˜ 1050"
35683>>>                    Procedure_return
35684>>>                End
35684>>>>
35684>>>                Move ("‡â¢œ«œ ¤˜ ˜¢¢á¥œ«œ «ž¤ ž£œ¨/¤å˜ ¢ã¥žª ¡à› ¡¦ç «¦¬ ®¨ã©«ž "+Trim(sID)+" - "+Trim(Users.Name)+" ;") to sTmp
35685>>>                Get YesNo_Box sTmp "** Ž‘Ž•† **" to iYesNo
35686>>>                If (iYesNo=MBR_NO) Procedure_Return
35689>>>        
35689>>>                Clear Users
35690>>>                Move sID to Users.Login_ID
35691>>>                Find Eq Users By Index.1
35692>>>>
35692>>>                If (Found) Begin
35694>>>                    Set Label Of ButtonSub3 to (Trim(Users.Login_ID)+"  "+Trim(Users.Name))
35695>>>                    Reread Users
35699>>>                    Move dHmnia to Users.Next_Change
35700>>>                    Saverecord Users
35701>>>                    Unlock
35702>>>>
35702>>>                End
35702>>>>
35702>>>            End
35702>>>>
35702>>>            Else Begin
35703>>>                Move ("‡â¢œ«œ ¤˜ ˜¢¢á¥œ«œ «ž¤ ž£œ¨/¤å˜ ¢ã¥žª ¡à› ¡é¤ æ¢à¤ «à¤ ®¨ž©«é¤;") to sTmp
35704>>>                Get YesNo_Box sTmp "** Ž‘Ž•† **" to iYesNo
35705>>>                If (iYesNo=MBR_NO) Procedure_Return
35708>>>        
35708>>>                Clear Users
35709>>>                Find GE Users.Recnum
35710>>>>
35710>>>                While (Found)
35714>>>                    Set Label Of ButtonSub3 to (Trim(Users.Login_ID)+"  "+Trim(Users.Name))
35715>>>                    Reread Users
35719>>>                    Move dHmnia to Users.Next_Change
35720>>>                    Saverecord Users
35721>>>                    Unlock
35722>>>>
35722>>>                    Find GT Users.Recnum
35723>>>>
35723>>>                Loop
35724>>>>
35724>>>            End
35724>>>>
35724>>>        
35724>>>            Set Value Of frmNewDate Item 0 to ""
35725>>>            Set Value Of frmUserID  Item 0 to ""
35726>>>        
35726>>>            Set Label Of ButtonSub3 to ""
35727>>>            Send Info_Box "† ˜¢¢˜šã ž£œ¨/¤å˜ª ¢ã¥žª ¦¢¦¡¢ž¨éŸž¡œ" "¢ž¨¦­¦¨å˜"
35728>>>        End_Procedure // OnClick
35729>>>        
35729>>>        
35729>>>        
35729>>>        //AB-StoreEnd
35729>>>
35729>>>    End_Object    // ButtonSub4
35730>>>
35730>>>
35730>>>    //AB-StoreStart
35730>>>                                        
35730>>>    Procedure Activate_View Returns Integer
35732>>>        Integer rVal
35733>>>        Forward Get MSG_Activate_View to rVal
35735>>>        Set Value Of frmUserName Item 0 to ""
35736>>>        Set Value Of frmUserID   Item 0 to ""
35737>>>        Procedure_Return rVal
35738>>>    End_Procedure
35739>>>    
35739>>>    //AB-StoreEnd
35739>>>
35739>>>End_Object    // ClearPasswords
35740>>>
35740>>>
35740>>>//AB-StoreStart
35740>>>        
35740>>>        
35740>>>        
35740>>>//AB-StoreEnd
35740>>>
35740>>>//AB/ End_Object    // prj
35740>        Use vwParameters2.VW                                                                
INCLUDING FILE: VWPARAMETERS2.VW
35740>>>//AB/ Project vwParameters2
35740>>>//AB/     Object prj is a View_Project
35740>>>//AB/         Set ProjectName to "vwParameters2"
35740>>>//AB/         Set ProjectFileName to "vwParameters2.VW"
35740>>>//AB/         Set GenerateFileName to "NONAME"
35740>>>
35740>>>// Project Object Structure
35740>>>//   vwParameters2 is a dbViewSub
35740>>>//     chkLengthOverEight is a CheckBoxSub
35740>>>//     chk3Consecutive is a CheckBoxSub
35740>>>//     chkAtLeast1Upper is a CheckBoxSub
35740>>>//     chkAtLeast1Lower is a CheckBoxSub
35740>>>//     chkAtLeast1Number is a CheckBoxSub
35740>>>//     chkAtLeast1Special is a CheckBoxSub
35740>>>//     chkNoGreek is a CheckBoxSub
35740>>>//     chkSeiriakous is a CheckBoxSub
35740>>>//     chkBlanks is a CheckBoxSub
35740>>>//     txtDays is a TextBoxSub
35740>>>//     txtAttempts is a TextBoxSub
35740>>>//     frmAttempts is a FormSub
35740>>>//     frmChangePasswordEveryDays is a FormSub
35740>>>//     TextBoxSub23 is a TextBoxSub
35740>>>//     TextBoxSub24 is a TextBoxSub
35740>>>//     TextBoxSub25 is a TextBoxSub
35740>>>//     TextBoxSub26 is a TextBoxSub
35740>>>//     TextBoxSub27 is a TextBoxSub
35740>>>//     TextBoxSub28 is a TextBoxSub
35740>>>//     TextBoxSub29 is a TextBoxSub
35740>>>//     TextBoxSub30 is a TextBoxSub
35740>>>//     TextBoxSub31 is a TextBoxSub
35740>>>//     TextBoxSub32 is a TextBoxSub
35740>>>//     TextBoxSub33 is a TextBoxSub
35740>>>//     TextBoxSub34 is a TextBoxSub
35740>>>
35740>>>// Register all objects
35740>>>Register_Object chk3Consecutive
35740>>>Register_Object chkAtLeast1Lower
35740>>>Register_Object chkAtLeast1Number
35740>>>Register_Object chkAtLeast1Special
35740>>>Register_Object chkAtLeast1Upper
35740>>>Register_Object chkBlanks
35740>>>Register_Object chkLengthOverEight
35740>>>Register_Object chkNoGreek
35740>>>Register_Object chkSeiriakous
35740>>>Register_Object frmAttempts
35740>>>Register_Object frmChangePasswordEveryDays
35740>>>Register_Object TextBoxSub23
35740>>>Register_Object TextBoxSub24
35740>>>Register_Object TextBoxSub25
35740>>>Register_Object TextBoxSub26
35740>>>Register_Object TextBoxSub27
35740>>>Register_Object TextBoxSub28
35740>>>Register_Object TextBoxSub29
35740>>>Register_Object TextBoxSub30
35740>>>Register_Object TextBoxSub31
35740>>>Register_Object TextBoxSub32
35740>>>Register_Object TextBoxSub33
35740>>>Register_Object TextBoxSub34
35740>>>Register_Object txtAttempts
35740>>>Register_Object txtDays
35740>>>Register_Object vwParameters2
35740>>>
35740>>>
35740>>>//AB/     AppBuild VIEW
35740>>>
35740>>>
35740>>>    //AB-StoreTopStart
35740>>>
35740>>>    Open Sysrec
35742>>>
35742>>>    //AB-StoreTopEnd
35742>>>
35742>>>    //AB-IgnoreStart
35742>>>
35742>>>    Use dbView.Sub
35742>>>    Use Chkbox.Sub
35742>>>    Use Txtbox.Sub
35742>>>    Use Form.Sub
35742>>>
35742>>>    //AB-IgnoreEnd
35742>>>
35742>>>    ACTIVATE_VIEW Activate_vwParameters2 FOR vwParameters2
35746>>>
35746>>>    Object vwParameters2 is a dbViewSub
35748>>>
35748>>>        //AB-StoreTopStart
35748>>>
35748>>>        //Property Integer piMustRestart  Public 0
35748>>>        //Property String  psMyStr        Public ""
35748>>>        //Property String  psInitial      Public "sbno125olkM]RtY"
35748>>>
35748>>>        //Object oCrypt is a dbOLEChilkatCrypt2
35748>>>        //End_Object
35748>>>
35748>>>        //Function HasOneCap string asPassw Integer aiGreek Returns Integer
35748>>>        //    Integer rVal
35748>>>        //    Integer iLength x
35748>>>        //    String  sChar
35748>>>        //    Move (Length(asPassw))  to iLength
35748>>>        //    Move 0                  to rVal
35748>>>        //    For x From 1 to iLength
35748>>>        //        Move (Mid(asPassw,1,x)) to sChar
35748>>>        //        If (aiGreek=0) Begin
35748>>>        //            If ( ;
35748>>>        //                 ( (Ascii(sChar)>=65 ) And (Ascii(sChar)<= 90)) Or  ;
35748>>>        //                 ( (Ascii(ToAnsi(sChar))>=193) And (Ascii(ToAnsi(sChar))<=219))  ;
35748>>>        //               ) Begin
35748>>>        //                Move 1      to rVal
35748>>>        //                Move 9999   to x
35748>>>        //            End
35748>>>        //        End
35748>>>        //        Else Begin
35748>>>        //            If ( (Ascii(sChar)>=65) And (Ascii(sChar)<=90) ) Begin
35748>>>        //                Move 1      to rVal
35748>>>        //                Move 9999   to x
35748>>>        //            End
35748>>>        //        End
35748>>>        //    Loop
35748>>>        //    Function_Return rVal
35748>>>        //End_Function
35748>>>
35748>>>        //Function HasOneSmall string asPassw Integer aiGreek Returns Integer
35748>>>        //    Integer rVal
35748>>>        //    Integer iLength x
35748>>>        //    String  sChar
35748>>>        //    Move (Length(asPassw))  to iLength
35748>>>        //    Move 0                  to rVal
35748>>>        //    For x From 1 to iLength
35748>>>        //        Move (Mid(asPassw,1,x)) to sChar
35748>>>        //        If (aiGreek=0) Begin
35748>>>        //            If ( ;
35748>>>        //                 ( (Ascii(sChar)>= 97) And (Ascii(sChar)<=122)) Or ;
35748>>>        //                 ( (Ascii(ToAnsi(sChar))>=220) And (Ascii(ToAnsi(sChar))<=254))    ;
35748>>>        //               ) Begin
35748>>>        //                Move 1      to rVal
35748>>>        //                Move 9999   to x
35748>>>        //            End
35748>>>        //        End
35748>>>        //        Else Begin
35748>>>        //            If ( (Ascii(sChar)>=97) And (Ascii(sChar)<=122)) Begin
35748>>>        //                Move 1      to rVal
35748>>>        //                Move 9999   to x
35748>>>        //            End
35748>>>        //        End
35748>>>        //    Loop
35748>>>        //    Function_Return rVal
35748>>>        //End_Function
35748>>>
35748>>>        //Function HasOneNumber string asPassw Returns Integer
35748>>>        //    Integer rVal
35748>>>        //    Integer iLength x
35748>>>        //    String  sChar
35748>>>        //    Move (Length(asPassw))  to iLength
35748>>>        //    Move 0                  to rVal
35748>>>        //    For x From 1 to iLength
35748>>>        //        Move (Mid(asPassw,1,x)) to sChar
35748>>>        //        If ( (Ascii(sChar)>=48) And (Ascii(sChar)<=57)) Begin
35748>>>        //            Move 1      to rVal
35748>>>        //            Move 9999   to x
35748>>>        //        End
35748>>>        //    Loop
35748>>>        //    Function_Return rVal
35748>>>        //End_Function
35748>>>
35748>>>        //Function HasOneSpecial string asPassw Returns Integer
35748>>>        //    Integer rVal
35748>>>        //    Integer iLength x
35748>>>        //    String  sChar
35748>>>        //    Move (Length(asPassw))  to iLength
35748>>>        //    Move 0                  to rVal
35748>>>        //    For x From 1 to iLength
35748>>>        //        Move (Mid(asPassw,1,x)) to sChar
35748>>>        //        If ( ;
35748>>>        //             ( (Ascii(sChar)>=33) And (Ascii(sChar)<=47)) Or ;
35748>>>        //             ( (Ascii(sChar)>=58) And (Ascii(sChar)<=64)) Or ;
35748>>>        //             ( (Ascii(sChar)>=91) And (Ascii(sChar)<=96))    ;
35748>>>        //           ) Begin
35748>>>        //            Move 1      to rVal
35748>>>        //            Move 9999   to x
35748>>>        //        End
35748>>>
35748>>>        //    Loop
35748>>>        //    Function_Return rVal
35748>>>        //End_Function
35748>>>
35748>>>        //Function HasOneGreek string asPassw Returns Integer
35748>>>        //    Integer rVal
35748>>>        //    Integer iLength x
35748>>>        //    String  sChar
35748>>>        //    Move (Length(asPassw))  to iLength
35748>>>        //    Move 0                  to rVal
35748>>>        //    For x From 1 to iLength
35748>>>        //        Move (Mid(asPassw,1,x)) to sChar
35748>>>        //        If ( ;
35748>>>        //             ((Ascii(ToAnsi(sChar))>=193) And (Ascii(ToAnsi(sChar))<=219)) Or ;
35748>>>        //             ((Ascii(ToAnsi(sChar))>=220) And (Ascii(ToAnsi(sChar))<=254))    ;
35748>>>        //           ) Begin
35748>>>        //            Move 1      to rVal
35748>>>        //            Move 9999   to x
35748>>>        //            Set psMyStr to sChar
35748>>>        //        End
35748>>>        //    Loop
35748>>>        //    Function_Return rVal
35748>>>        //End_Function
35748>>>
35748>>>        //Function HasDuplicates String asPassw Returns Integer
35748>>>        //    Integer iLength x
35748>>>        //    String  s1 s2
35748>>>        //    Move (Length(asPassw)) to iLength
35748>>>        //    If (iLength > 2) Begin
35748>>>        //        For x From 1 to iLength
35748>>>        //            Move (Mid(asPassw, 1, x  )) to s1
35748>>>        //            If ((x+1)<=iLength) ;
35748>>>        //                Move (Mid(asPassw, 1, x+1)) to s2
35748>>>        //            Else Function_Return 0
35748>>>        //            If (s1=s2) Begin
35748>>>        //                Set psMyStr to (s1+s2)
35748>>>        //                Function_Return 1
35748>>>        //            End
35748>>>        //        Loop
35748>>>        //    End
35748>>>        //    Function_Return 0
35748>>>        //End_Function
35748>>>
35748>>>        //Function HasInRow string asPassw Integer aiGreek Returns Integer
35748>>>        //    Integer rVal iNum
35748>>>        //    Integer iLength x
35748>>>        //    String  sChar  sChar2  sChar3  sSet1  sSet2
35748>>>        //    String  ssChar ssChar2 ssChar3 ssSet1 ssSet2
35748>>>        //    String  s1 s2 s3 s4 s5
35748>>>
35748>>>        //    Move (Length(asPassw))  to iLength
35748>>>        //    Move 0                  to rVal
35748>>>
35748>>>        //    Set psMyStr to ""
35748>>>
35748>>>        //    For x From 1 to iLength
35748>>>        //        Move 0 to iNum
35748>>>        //        // Keep 3 consecutive characters
35748>>>        //        Move (Mid(asPassw,1,x))                         to sChar
35748>>>        //        If ((x+1)<=iLength) Move (Mid(asPassw,1,x+1))   to sChar2
35748>>>        //        Else                Move 1                      to iNum
35748>>>        //        If ((x+2)<=iLength) Move (Mid(asPassw,1,x+2))   to sChar3
35748>>>        //        Else                Move 1                      to iNum
35748>>>
35748>>>        //        If (iNum=0) Begin
35748>>>        //            // check if same type of character (Numbers)
35748>>>        //            If ( ((Ascii(sChar )>=48) And (Ascii(sChar )<=57)) And ;
35748>>>        //                 ((Ascii(sChar2)>=48) And (Ascii(sChar2)<=57)) And ;
35748>>>        //                 ((Ascii(sChar3)>=48) And (Ascii(sChar3)<=57))     ;
35748>>>        //               ) Begin
35748>>>        //                If (    ((Integer(sChar3)-Integer(sChar2))=1) And ;
35748>>>        //                        ((Integer(sChar2)-Integer(sChar ))=1)     ;
35748>>>        //                   ) Begin
35748>>>        //                   Move 1       to rVal
35748>>>        //                   Move 9999    to x
35748>>>        //                   Set psMyStr to (sChar+sChar2+sChar3)
35748>>>
35748>>>        //                End
35748>>>        //                Else If (    ((Integer(sChar2)-Integer(sChar3))=1) And ;
35748>>>        //                             ((Integer(sChar )-Integer(sChar2))=1)     ;
35748>>>        //                        ) Begin
35748>>>        //                   Move 1       to rVal
35748>>>        //                   Move 9999    to x
35748>>>        //                   Set psMyStr to (sChar+sChar2+sChar3)
35748>>>        //                End
35748>>>        //            End
35748>>>        //            // check if same type of character (Capital Letters)
35748>>>        //            Else Begin
35748>>>        //                Move "ABCDEFGHIJKLMNOPQRSTUVWXYZ"   to s1
35748>>>        //                Move "QWERTYUIOPASDFGHJKLZXCVBNM"   to s2
35748>>>        //                //Move "€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—"     to s3
35748>>>        //                //Move "˜™š›œžŸ ¡¢£¤¥¦§¨©«¬­®¯à"     to s4
35748>>>        //                Move (UpperCase(sChar ))        to ssChar
35748>>>        //                Move (UpperCase(sChar2))        to ssChar2
35748>>>        //                Move (UpperCase(sChar3))        to ssChar3
35748>>>        //                Move (sChar +sChar2+sChar3)     to sSet1
35748>>>        //                Move (sChar3+sChar2+sChar )     to sSet2
35748>>>        //                Move (ssChar +ssChar2+ssChar3)  to ssSet1
35748>>>        //                Move (ssChar3+ssChar2+ssChar )  to ssSet2
35748>>>
35748>>>        //                If ( ((Ascii(ssChar )>=65) And (Ascii(ssChar )<=90)) And ;
35748>>>        //                     ((Ascii(ssChar2)>=65) And (Ascii(ssChar2)<=90)) And ;
35748>>>        //                     ((Ascii(ssChar3)>=65) And (Ascii(ssChar2)<=90))     ;
35748>>>        //                   ) Begin
35748>>>        //                    If ( (Pos(ssSet1,s1)>0) Or (Pos(ssSet2,s1)>0) Or ;
35748>>>        //                         (Pos(ssSet1,s2)>0) Or (Pos(ssSet2,s2)>0)  ) Begin
35748>>>        //                        Move 1      to rVal
35748>>>        //                        Move 9999   to x
35748>>>        //                        //     If ( (Pos(ssSet1,s1)>0) Or (Pos(ssSet1,s2)>0) ) Set psMyStr to sSet1
35748>>>        //                        //Else If ( (Pos(ssSet2,s1)>0) Or (Pos(ssSet2,s2)>0) ) Set psMyStr to sSet1
35748>>>        //                        Set psMyStr to sSet1
35748>>>        //                    End
35748>>>        //                End
35748>>>        //            End
35748>>>        //        End
35748>>>        //    Loop
35748>>>        //    Function_Return rVal
35748>>>        //End_Function
35748>>>
35748>>>
35748>>>        //Function HasPasswordProblems string asPassw Integer i8Char    Integer i2Same  Integer iOneCap ;
35748>>>        //                                            Integer iOneSmall Integer iOneNum Integer iOneSpe ;
35748>>>        //                                            Integer iGreek    Integer iSeira  Integer iBlanks Returns Integer
35748>>>        //    Integer iHasProblems
35748>>>        //    Move 0 to iHasProblems
35748>>>
35748>>>        //         If ((i8Char   =1) And (Length(asPassw)<8))                     Move 1 to iHasProblems
35748>>>        //    Else If ((i2Same   =1) And (HasDuplicates (Self,asPassw       )=1)) Move 2 to iHasProblems
35748>>>        //    Else If ((iGreek   =1) And (HasOneGreek   (Self,asPassw       )=1)) Move 7 to iHasProblems
35748>>>        //    Else If ((iBlanks  =1) And (Pos(" ",asPassw)>0))                    Move 9 to iHasProblems
35748>>>        //    Else If ((iOneCap  =1) And (HasOneCap     (Self,asPassw,iGreek)=0)) Move 3 to iHasProblems
35748>>>        //    Else If ((iOneSmall=1) And (HasOneSmall   (Self,asPassw,iGreek)=0)) Move 4 to iHasProblems
35748>>>        //    Else If ((iOneNum  =1) And (HasOneNumber  (Self,asPassw       )=0)) Move 5 to iHasProblems
35748>>>        //    Else If ((iOneSpe  =1) And (HasOneSpecial (Self,asPassw       )=0)) Move 6 to iHasProblems
35748>>>        //    Else If ((iSeira   =1) And (HasInRow      (Self,asPassw,iGreek)=1)) Move 8 to iHasProblems
35748>>>
35748>>>        //    Function_Return iHasProblems
35748>>>        //End_Function
35748>>>
35748>>>        //AB-StoreTopEnd
35748>>>
35748>>>        Set Label to "¦¢ « ¡ã €©­˜¢œå˜ª š ˜ «¦¬ª ‰à› ¡¦çª •¨ž©«é¤"
35749>>>        Set Size to 172 413
35750>>>        Set Location to 5 5
35751>>>
35751>>>        //AB-DDOStart
35751>>>
35751>>>
35751>>>        //AB-DDOEnd
35751>>>
35751>>>        Object chkLengthOverEight is a CheckBoxSub
35753>>>
35753>>>            //AB-StoreTopStart
35753>>>
35753>>>            //AB-StoreTopEnd
35753>>>
35753>>>            Set Label to "Œ˜ â®œ  £ã¡¦ª ˜§¦ 8 ¡˜  §á¤à ®˜¨˜¡«ã¨œª"
35754>>>            Set Size to 10 239
35755>>>            Set Location to 10 15
35756>>>            Set Checked_State to TRUE
35757>>>
35757>>>            //AB-StoreStart
35757>>>
35757>>>            Procedure OnChange
35759>>>                Integer isChecked
35760>>>                String lsTheAppPath
35760>>>                Get Checked_State                                       To isChecked
35761>>>                Move (GetTheAppPath(Self))                              To lsTheAppPath
35762>>>                Set_Profile_String lsTheAppPath "Passw_LengthOverEight" To isChecked
35765>>>            End_Procedure
35766>>>
35766>>>
35766>>>
35766>>>            //AB-StoreEnd
35766>>>
35766>>>        End_Object    // chkLengthOverEight
35767>>>
35767>>>        Object chk3Consecutive is a CheckBoxSub
35769>>>
35769>>>            //AB-StoreTopStart
35769>>>
35769>>>            //AB-StoreTopEnd
35769>>>
35769>>>            Set Label to "Œ˜ £ž¤ œ§˜¤˜¢˜£™á¤œ«˜  â¤˜ª ®˜¨˜¡«ã¨˜ª 2 ©¬¤œ®æ£œ¤œª ­¦¨âª"
35770>>>            Set Size to 10 239
35771>>>            Set Location to 24 15
35772>>>            Set Checked_State to TRUE
35773>>>
35773>>>            //AB-StoreStart
35773>>>
35773>>>            Procedure OnChange
35775>>>                Integer isChecked
35776>>>                String lsTheAppPath
35776>>>                Get Checked_State                                   To isChecked
35777>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35778>>>                Set_Profile_String lsTheAppPath "Passw_3Consecutive"          To isChecked
35781>>>            End_Procedure
35782>>>
35782>>>
35782>>>
35782>>>            //AB-StoreEnd
35782>>>
35782>>>        End_Object    // chk3Consecutive
35783>>>
35783>>>        Object chkAtLeast1Upper is a CheckBoxSub
35785>>>
35785>>>            //AB-StoreTopStart
35785>>>
35785>>>            //AB-StoreTopEnd
35785>>>
35785>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª ¡œ­˜¢˜å¦ª ®˜¨˜¡«ã¨˜ª"
35786>>>            Set Size to 10 201
35787>>>            Set Location to 38 15
35788>>>            Set Checked_State to TRUE
35789>>>
35789>>>            //AB-StoreStart
35789>>>
35789>>>            Procedure OnChange
35791>>>                Integer isChecked
35792>>>                String lsTheAppPath
35792>>>                Get Checked_State                                   To isChecked
35793>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35794>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Upper"          To isChecked
35797>>>            End_Procedure
35798>>>
35798>>>
35798>>>
35798>>>            //AB-StoreEnd
35798>>>
35798>>>        End_Object    // chkAtLeast1Upper
35799>>>
35799>>>        Object chkAtLeast1Lower is a CheckBoxSub
35801>>>
35801>>>            //AB-StoreTopStart
35801>>>
35801>>>            //AB-StoreTopEnd
35801>>>
35801>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª §œæª ®˜¨˜¡«ã¨˜ª"
35802>>>            Set Size to 10 239
35803>>>            Set Location to 50 15
35804>>>            Set Checked_State to TRUE
35805>>>
35805>>>            //AB-StoreStart
35805>>>
35805>>>            Procedure OnChange
35807>>>                Integer isChecked
35808>>>                String lsTheAppPath
35808>>>                Get Checked_State                                   To isChecked
35809>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35810>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Lower"          To isChecked
35813>>>            End_Procedure
35814>>>
35814>>>
35814>>>
35814>>>            //AB-StoreEnd
35814>>>
35814>>>        End_Object    // chkAtLeast1Lower
35815>>>
35815>>>        Object chkAtLeast1Number is a CheckBoxSub
35817>>>
35817>>>            //AB-StoreTopStart
35817>>>
35817>>>            //AB-StoreTopEnd
35817>>>
35817>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª ˜¨ Ÿ£æª"
35818>>>            Set Size to 10 148
35819>>>            Set Location to 65 15
35820>>>            Set Checked_State to TRUE
35821>>>
35821>>>            //AB-StoreStart
35821>>>
35821>>>            Procedure OnChange
35823>>>                Integer isChecked
35824>>>                String lsTheAppPath
35824>>>                Get Checked_State                                   To isChecked
35825>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35826>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Number"          To isChecked
35829>>>            End_Procedure
35830>>>
35830>>>
35830>>>
35830>>>            //AB-StoreEnd
35830>>>
35830>>>        End_Object    // chkAtLeast1Number
35831>>>
35831>>>        Object chkAtLeast1Special is a CheckBoxSub
35833>>>
35833>>>            //AB-StoreTopStart
35833>>>
35833>>>            //AB-StoreTopEnd
35833>>>
35833>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª œ › ¡æª ®˜¨˜¡«ã¨˜ª"
35834>>>            Set Size to 10 187
35835>>>            Set Location to 78 15
35836>>>            Set Checked_State to TRUE
35837>>>
35837>>>            //AB-StoreStart
35837>>>
35837>>>            Procedure OnChange
35839>>>                Integer isChecked
35840>>>                String lsTheAppPath
35840>>>                Get Checked_State                                   To isChecked
35841>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35842>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Special"          To isChecked
35845>>>            End_Procedure
35846>>>
35846>>>
35846>>>
35846>>>            //AB-StoreEnd
35846>>>
35846>>>        End_Object    // chkAtLeast1Special
35847>>>
35847>>>        Object chkNoGreek is a CheckBoxSub
35849>>>
35849>>>            //AB-StoreTopStart
35849>>>
35849>>>            //AB-StoreTopEnd
35849>>>
35849>>>            Set Label to "Œ˜ £ž¤ ®¨ž© £¦§¦ ¦ç¤«˜  „¢¢ž¤ ¡¦å ®˜¨˜¡«ã¨œª"
35850>>>            Set Size to 10 239
35851>>>            Set Location to 87 15
35852>>>            Set Checked_State to TRUE
35853>>>
35853>>>            //AB-StoreStart
35853>>>
35853>>>            Set Visible_State to False
35854>>>            Set Enabled_State to False
35855>>>
35855>>>            // Hard Coded No Greek characters
35855>>>            Set Checked_State to True
35856>>>
35856>>>
35856>>>
35856>>>
35856>>>            //AB-StoreEnd
35856>>>
35856>>>        End_Object    // chkNoGreek
35857>>>
35857>>>        Object chkSeiriakous is a CheckBoxSub
35859>>>
35859>>>            //AB-StoreTopStart
35859>>>
35859>>>            //AB-StoreTopEnd
35859>>>
35859>>>            Set Label to "Œ˜ £ž¤ œ§ «â§¦¤«˜  §á¤à ˜§¦ 2 ©¬¤œ®æ£œ¤¦¬ª ©œ ©œ ¨á ®˜¨˜¡«ã¨œª"
35860>>>            Set Size to 10 247
35861>>>            Set Location to 91 15
35862>>>            Set Checked_State to TRUE
35863>>>
35863>>>            //AB-StoreStart
35863>>>
35863>>>            Procedure OnChange
35865>>>                Integer isChecked
35866>>>                String lsTheAppPath
35866>>>                Get Checked_State                                   To isChecked
35867>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35868>>>                Set_Profile_String lsTheAppPath "Passw_Seiriakous"          To isChecked
35871>>>            End_Procedure
35872>>>
35872>>>
35872>>>
35872>>>            //AB-StoreEnd
35872>>>
35872>>>        End_Object    // chkSeiriakous
35873>>>
35873>>>        Object chkBlanks is a CheckBoxSub
35875>>>
35875>>>            //AB-StoreTopStart
35875>>>
35875>>>            //AB-StoreTopEnd
35875>>>
35875>>>            Set Label to "Œ˜ £ž¤ œ§ «¨â§¦¤«˜  ¡œ¤á"
35876>>>            Set Size to 10 111
35877>>>            Set Location to 104 15
35878>>>            Set Checked_State to TRUE
35879>>>
35879>>>            //AB-StoreStart
35879>>>
35879>>>            Procedure OnChange
35881>>>                Integer isChecked
35882>>>                String lsTheAppPath
35882>>>                Get Checked_State                                   To isChecked
35883>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35884>>>                Set_Profile_String lsTheAppPath "Passw_Blanks"          To isChecked
35887>>>            End_Procedure
35888>>>
35888>>>
35888>>>
35888>>>            //AB-StoreEnd
35888>>>
35888>>>        End_Object    // chkBlanks
35889>>>
35889>>>        Object txtDays is a TextBoxSub
35891>>>            Set Label to "Œ˜ ˜¢¢áœ  ¦ ‰à› ¡æª ¡áŸœ ®® £â¨œª (0=ƒœ¤ œ¢âš®œ«˜ )"
35892>>>            Set Location to 122 27
35893>>>            Set Size to 10 184
35894>>>            Set TypeFace to "MS Sans Serif"
35895>>>        End_Object    // txtDays
35896>>>
35896>>>        Object txtAttempts is a TextBoxSub
35898>>>            Set Label to "‹âš ©«œª „§ «¨œ§«âª ¨¦©§áŸœ œª „ ©æ›¦¬"
35899>>>            Set Location to 135 27
35900>>>            Set Size to 10 151
35901>>>            Set TypeFace to "MS Sans Serif"
35902>>>        End_Object    // txtAttempts
35903>>>
35903>>>        Object frmAttempts is a FormSub
35905>>>
35905>>>            //AB-StoreTopStart
35905>>>
35905>>>            //AB-StoreTopEnd
35905>>>
35905>>>            Set Size to 13 17
35906>>>            Set Location to 134 7
35907>>>            Set Label_Col_Offset to 2
35908>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35909>>>            Set Value Item 0 to "3"
35910>>>
35910>>>            //AB-StoreStart
35910>>>
35910>>>            Procedure OnChange
35912>>>                Integer isChecked
35913>>>                String lsTheAppPath
35913>>>                Get Value Item 0 to isChecked
35914>>>                Move (GetTheAppPath(Self))                            To lsTheAppPath
35915>>>                Set_Profile_String lsTheAppPath "Passw_MaxTries"      To isChecked
35918>>>            End_Procedure
35919>>>
35919>>>
35919>>>
35919>>>            //AB-StoreEnd
35919>>>
35919>>>        End_Object    // frmAttempts
35920>>>
35920>>>        Object frmChangePasswordEveryDays is a FormSub
35922>>>
35922>>>            //AB-StoreTopStart
35922>>>
35922>>>            //AB-StoreTopEnd
35922>>>
35922>>>            Set Size to 13 17
35923>>>            Set Location to 121 7
35924>>>            Set Label_Col_Offset to 2
35925>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35926>>>            Set Value Item 0 to "30"
35927>>>
35927>>>            //AB-StoreStart
35927>>>
35927>>>            Procedure OnChange
35929>>>                Integer isChecked
35930>>>                String lsTheAppPath
35930>>>                Get Value Item 0 to isChecked
35931>>>                Move (GetTheAppPath(Self))                              To lsTheAppPath
35932>>>                Set_Profile_String lsTheAppPath "Passw_DaysChange"      To isChecked
35935>>>            End_Procedure
35936>>>
35936>>>
35936>>>
35936>>>
35936>>>            //AB-StoreEnd
35936>>>
35936>>>        End_Object    // frmChangePasswordEveryDays
35937>>>
35937>>>        Object TextBoxSub23 is a TextBoxSub
35939>>>            Set Label to "________________________"
35940>>>            Set Location to 89 264
35941>>>            Set Size to 10 32
35942>>>            Set Justification_Mode to jMode_Left
35943>>>            Set TypeFace to "MS Sans Serif"
35944>>>        End_Object    // TextBoxSub23
35945>>>
35945>>>        Object TextBoxSub24 is a TextBoxSub
35947>>>            Set Label to "_________________________"
35948>>>            Set Location to 75 201
35949>>>            Set Size to 10 94
35950>>>            Set Justification_Mode to jMode_Left
35951>>>            Set TypeFace to "MS Sans Serif"
35952>>>        End_Object    // TextBoxSub24
35953>>>
35953>>>        Object TextBoxSub25 is a TextBoxSub
35955>>>            Set Label to "_________________________________"
35956>>>            Set Location to 62 165
35957>>>            Set Size to 10 129
35958>>>            Set Justification_Mode to jMode_Left
35959>>>            Set TypeFace to "MS Sans Serif"
35960>>>        End_Object    // TextBoxSub25
35961>>>
35961>>>        Object TextBoxSub26 is a TextBoxSub
35963>>>            Set Label to "____________________________"
35964>>>            Set Location to 49 198
35965>>>            Set Size to 10 97
35966>>>            Set Justification_Mode to jMode_Left
35967>>>            Set TypeFace to "MS Sans Serif"
35968>>>        End_Object    // TextBoxSub26
35969>>>
35969>>>        Object TextBoxSub27 is a TextBoxSub
35971>>>            Set Label to "_______________________________________________"
35972>>>            Set Location to 36 212
35973>>>            Set Size to 10 82
35974>>>            Set Justification_Mode to jMode_Left
35975>>>            Set TypeFace to "MS Sans Serif"
35976>>>        End_Object    // TextBoxSub27
35977>>>
35977>>>        Object TextBoxSub28 is a TextBoxSub
35979>>>            Set Label to "______________"
35980>>>            Set Location to 22 255
35981>>>            Set Size to 10 41
35982>>>            Set Justification_Mode to jMode_Center
35983>>>            Set TypeFace to "MS Sans Serif"
35984>>>        End_Object    // TextBoxSub28
35985>>>
35985>>>        Object TextBoxSub29 is a TextBoxSub
35987>>>            Set Label to "(˜˜, LL, 44...)"
35988>>>            Set Location to 23 301
35989>>>            Set Size to 10 63
35990>>>            Set FontWeight to 600
35991>>>            Set TypeFace to "MS Sans Serif"
35992>>>        End_Object    // TextBoxSub29
35993>>>
35993>>>        Object TextBoxSub30 is a TextBoxSub
35995>>>            Set Label to "(AB...YZ)"
35996>>>            Set Location to 37 301
35997>>>            Set Size to 10 41
35998>>>            Set FontWeight to 600
35999>>>            Set TypeFace to "MS Sans Serif"
36000>>>        End_Object    // TextBoxSub30
36001>>>
36001>>>        Object TextBoxSub31 is a TextBoxSub
36003>>>            Set Label to "(ab...yz)"
36004>>>            Set Location to 50 301
36005>>>            Set Size to 10 28
36006>>>            Set FontWeight to 600
36007>>>            Set TypeFace to "MS Sans Serif"
36008>>>        End_Object    // TextBoxSub31
36009>>>
36009>>>        Object TextBoxSub32 is a TextBoxSub
36011>>>            Set Label to "(1234567890)"
36012>>>            Set Location to 63 301
36013>>>            Set Size to 10 73
36014>>>            Set FontWeight to 600
36015>>>            Set TypeFace to "MS Sans Serif"
36016>>>        End_Object    // TextBoxSub32
36017>>>
36017>>>        Object TextBoxSub33 is a TextBoxSub
36019>>>            Set Label to "(!@#$%^&/*)(_\=+-><|)"
36020>>>            Set Location to 76 301
36021>>>            Set Size to 10 75
36022>>>            Set FontWeight to 600
36023>>>            Set TypeFace to "MS Sans Serif"
36024>>>        End_Object    // TextBoxSub33
36025>>>
36025>>>        Object TextBoxSub34 is a TextBoxSub
36027>>>            Set Label to "(123...876...efg....MLK)"
36028>>>            Set Location to 91 301
36029>>>            Set Size to 10 78
36030>>>            Set FontWeight to 600
36031>>>            Set TypeFace to "MS Sans Serif"
36032>>>        End_Object    // TextBoxSub34
36033>>>
36033>>>
36033>>>        //AB-StoreStart
36033>>>
36033>>>        Procedure Activate_View Returns Integer
36035>>>            Integer rVal bState i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iMax
36036>>>
36036>>>            String  lsTheAppPath
36036>>>            Forward Get Msg_Activate_View                           To rVal
36038>>>
36038>>>            Reread Sysrec
36042>>>            Unlock
36043>>>>
36043>>>
36043>>>            Move Sysrec.LIBCAST_CODE    to i1
36044>>>            Move Sysrec.AWARD_CODE      to i2
36045>>>            Move Sysrec.GIVAWRD_CODE    to i3
36046>>>            Move Sysrec.MOVIE_LNK_CODE  to i4
36047>>>            Move Sysrec.CAST_LNK_CODE   to i5
36048>>>            Move Sysrec.AWARDTP_CODE    to i6
36049>>>            Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
36050>>>            Move Sysrec.STWHAT_CODE     to i8
36051>>>            Move Sysrec.SNWHAT_CODE     to i9
36052>>>            Move Sysrec.LIBVIS_CODE     to iDays
36053>>>            Move Sysrec.TIKANEI_CODE    to iMax
36054>>>
36054>>>            Set Checked_State Of (chkLengthOverEight(Self))         To i1
36055>>>            Set Checked_State Of (chk3Consecutive(Self))            To i2
36056>>>            Set Checked_State Of (chkAtLeast1Upper(Self))           To i3
36057>>>            Set Checked_State Of (chkAtLeast1Lower(Self))           To i4
36058>>>            Set Checked_State Of (chkAtLeast1Number(Self))          To i5
36059>>>            Set Checked_State Of (chkAtLeast1Special(Self))         To i6
36060>>>            Set Checked_State Of (ChkNoGreek(Self))                 To i7
36061>>>            Set Checked_State Of (chkSeiriakous(Self))              To i8
36062>>>            Set Checked_State Of (chkBlanks(Self))                  To i9
36063>>>            Set Value Of frmChangePasswordEveryDays Item 0          to iDays
36064>>>            Set Value Of frmAttempts                Item 0          to iMax
36065>>>
36065>>>        //    Move (GetTheAppPath(Self))                              To lsTheAppPath
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_LengthOverEight" To bState
36065>>>        //    Set Checked_State Of (chkLengthOverEight(Self))         To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_3Consecutive"    To bState
36065>>>        //    Set Checked_State Of (chk3Consecutive(Self))            To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_AtLeast1Upper"   To bState
36065>>>        //    Set Checked_State Of (chkAtLeast1Upper(Self))           To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_AtLeast1Lower"   To bState
36065>>>        //    Set Checked_State Of (chkAtLeast1Lower(Self))           To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_AtLeast1Number"  To bState
36065>>>        //    Set Checked_State Of (chkAtLeast1Number(Self))          To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_AtLeast1Special" To bState
36065>>>        //    Set Checked_State Of (chkAtLeast1Special(Self))         To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_Seiriakous"      To bState
36065>>>        //    Set Checked_State Of (chkSeiriakous(Self))              To (If((bState),1,0))
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_Blanks"          To bState
36065>>>        //    Set Checked_State Of (chkBlanks(Self))                  To (If((bState),1,0))
36065>>>
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_DaysChange"      To bState
36065>>>        //    Set Value Of frmChangePasswordEveryDays Item 0          to bState
36065>>>
36065>>>        //    Get_Profile_String lsTheAppPath "Passw_MaxTries"        To bState
36065>>>        //    Set Value Of frmAttempts Item 0                         to bState
36065>>>
36065>>>            Procedure_Return rVal
36066>>>        End_Procedure
36067>>>
36067>>>
36067>>>        Procedure Request_Cancel
36069>>>            Integer rVal bState
36070>>>            String  lsTheAppPath
36070>>>            Integer i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iMax
36070>>>
36070>>>            Get Checked_State Of (chkLengthOverEight(Self))         To i1
36071>>>            Get Checked_State Of (chk3Consecutive(Self))            To i2
36072>>>            Get Checked_State Of (chkAtLeast1Upper(Self))           To i3
36073>>>            Get Checked_State Of (chkAtLeast1Lower(Self))           To i4
36074>>>            Get Checked_State Of (chkAtLeast1Number(Self))          To i5
36075>>>            Get Checked_State Of (chkAtLeast1Special(Self))         To i6
36076>>>            Get Checked_State Of (chkNoGreek(Self))                 To i7
36077>>>            Get Checked_State Of (chkSeiriakous(Self))              To i8
36078>>>            Get Checked_State Of (chkBlanks(Self))                  To i9
36079>>>            Get Value Of frmChangePasswordEveryDays Item 0          to iDays
36080>>>            Get Value Of frmAttempts                Item 0          to iMax
36081>>>
36081>>>            Reread Sysrec
36085>>>            Move i1     to Sysrec.LIBCAST_CODE
36086>>>            Move i2     to Sysrec.AWARD_CODE
36087>>>            Move i3     to Sysrec.GIVAWRD_CODE
36088>>>            Move i4     to Sysrec.MOVIE_LNK_CODE
36089>>>            Move i5     to Sysrec.CAST_LNK_CODE
36090>>>            Move i6     to Sysrec.AWARDTP_CODE
36091>>>            Move i7     to Sysrec.FESTIVAL_CODE
36092>>>            Move i8     to Sysrec.STWHAT_CODE
36093>>>            Move i9     to Sysrec.SNWHAT_CODE
36094>>>            Move iDays  to Sysrec.LIBVIS_CODE
36095>>>            Move iMax   to Sysrec.TIKANEI_CODE
36096>>>            Saverecord Sysrec
36097>>>            Unlock
36098>>>>
36098>>>
36098>>>            Forward Send Request_Cancel
36100>>>        End_Procedure
36101>>>
36101>>>
36101>>>        Procedure Close_Panel
36103>>>            Integer rVal bState
36104>>>            String  lsTheAppPath
36104>>>            Integer i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iMax
36104>>>            Get Checked_State Of (chkLengthOverEight(Self))         To i1
36105>>>            Get Checked_State Of (chk3Consecutive(Self))            To i2
36106>>>            Get Checked_State Of (chkAtLeast1Upper(Self))           To i3
36107>>>            Get Checked_State Of (chkAtLeast1Lower(Self))           To i4
36108>>>            Get Checked_State Of (chkAtLeast1Number(Self))          To i5
36109>>>            Get Checked_State Of (chkAtLeast1Special(Self))         To i6
36110>>>            Get Checked_State Of (chkNoGreek(Self))                 To i7
36111>>>            Get Checked_State Of (chkSeiriakous(Self))              To i8
36112>>>            Get Checked_State Of (chkBlanks(Self))                  To i9
36113>>>            Get Value Of frmChangePasswordEveryDays Item 0          to iDays
36114>>>            Get Value Of frmAttempts                Item 0          to iMax
36115>>>
36115>>>            Reread Sysrec
36119>>>            Move i1     to Sysrec.LIBCAST_CODE
36120>>>            Move i2     to Sysrec.AWARD_CODE
36121>>>            Move i3     to Sysrec.GIVAWRD_CODE
36122>>>            Move i4     to Sysrec.MOVIE_LNK_CODE
36123>>>            Move i5     to Sysrec.CAST_LNK_CODE
36124>>>            Move i6     to Sysrec.AWARDTP_CODE
36125>>>            Move i7     to Sysrec.FESTIVAL_CODE
36126>>>            Move i8     to Sysrec.STWHAT_CODE
36127>>>            Move i9     to Sysrec.SNWHAT_CODE
36128>>>            Move iDays  to Sysrec.LIBVIS_CODE
36129>>>            Move iMax   to Sysrec.TIKANEI_CODE
36130>>>            Saverecord Sysrec
36131>>>            Unlock
36132>>>>
36132>>>
36132>>>            Forward Send Close_Panel
36134>>>        End_Procedure
36135>>>
36135>>>
36135>>>
36135>>>        //AB-StoreEnd
36135>>>
36135>>>    End_Object    // vwParameters2
36136>>>
36136>>>
36136>>>    //AB-StoreStart
36136>>>
36136>>>
36136>>>
36136>>>
36136>>>
36136>>>
36136>>>
36136>>>    //AB-StoreEnd
36136>>>
36136>>>//AB/     End_Object    // prj
36136>
36136>        //AB-ClientStoreStart
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        
36136>        //AB-ClientStoreEnd
36136>
36136>
36136>    End_Object  // Client_Area
36137>    
36137>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
36137>>>// 07/23/96 JJT - New Class names
36137>>>// Very prototype global status bar
36137>>>//
36137>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
36137>>>>>// 07/23/96 JJT - New Class names
36137>>>>>Use dfAstbar.pkg
36137>>>>>
36137>>>>>Class StatusBar is a AppStatusBar
36138>>>>>
36138>>>>>    Procedure Construct_Object
36139>>>>>       Forward Send Construct_Object
36141>>>>>       //
36141>>>>>       Send Add_Item 350  ''     // micro-help
36142>>>>>       Send Add_Item  40  'View:'
36143>>>>>       Set Item_Display_Style To sbNORMAL
36144>>>>>       Send Add_Item 200  ''     // view name
36145>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
36146>>>>>       Set Item_Display_Style To sbNORMAL
36147>>>>>    End_Procedure // Construct_Object
36148>>>>>
36148>>>>>    Procedure Show_View_Name String sName
36149>>>>>        Set Value item 2 to sName
36150>>>>>    End_Procedure
36151>>>>>
36151>>>>>End_Class
36152>>>
36152>>>Object Status_Bar is a StatusBar
36154>>>End_Object
36155>
36155>    //AB-PanelStoreStart
36155>    
36155>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
36155>>>//************************************************************************
36155>>>// Confidential Trade Secret.
36155>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
36155>>>// as an unpublished work.  All rights reserved.
36155>>>// DataFlex is a registered trademark of Data Access Corporation.
36155>>>//
36155>>>//************************************************************************
36155>>>//************************************************************************
36155>>>//
36155>>>// $File name  : StdAbout.pkg
36155>>>// $File title : Standard about object package for VDF
36155>>>// Notice      :
36155>>>// $Author(s)  : John Tuohy
36155>>>//
36155>>>// $Rev History
36155>>>//
36155>>>// JT 06/27/97   File created
36155>>>//************************************************************************
36155>>>
36155>>>// This provides a quick and simple way to create an about package for a program.
36155>>>// You need to create a message inside you client area called Activate_About.
36155>>>// Within this message you should send the message DoAbout passing needed
36155>>>// string information.
36155>>>//
36155>>>//       Procedure Activate_About
36155>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
36155>>>//       End_Procedure
36155>>>//    where: sTitle =     Name of application. If none provided, uses caption
36155>>>//                        bar title
36155>>>//           sVersion   = Version Line. If none provided, will be blank
36155>>>//           sCopyRight = Copyright Line. If none provided, will be blank
36155>>>//           sAuthor    = Author name, blank if none provided
36155>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
36155>>>//                        is used.
36155>>>// It is expected that you will place this in your own object package. For
36155>>>// example an order about package may look like this:
36155>>>//
36155>>>//   // OrderAbout.pkg
36155>>>//   Use StdAbout.pkg
36155>>>//   Procedure Activate_About
36155>>>//      Local String sTitle sCopyright sVersion sAuthor
36155>>>//      Move "My Order Entry System" to sTitle
36155>>>//      Move "Version 2.1" to sVersion
36155>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
36155>>>//      Move "John Smith"  to sAuthor
36155>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
36155>>>//   end_procedure
36155>>>//   // end of file.
36155>>>
36155>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
36155>>>>>//************************************************************************
36155>>>>>// Confidential Trade Secret.
36155>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
36155>>>>>// as an unpublished work.  All rights reserved.
36155>>>>>// DataFlex is a registered trademark of Data Access Corporation.
36155>>>>>//
36155>>>>>//************************************************************************
36155>>>>>//************************************************************************
36155>>>>>//
36155>>>>>// $File name  : DfAbout.pkg
36155>>>>>// $File title : About class support
36155>>>>>// Notice      :
36155>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
36155>>>>>//
36155>>>>>// $Rev History
36155>>>>>//
36155>>>>>// JJT 11/5/98    Added version information
36155>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
36155>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
36155>>>>>//                workspace package.
36155>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
36155>>>>>//                class can create this object.
36155>>>>>//                Cleaned up the interface (used correct classes and messages)
36155>>>>>//                Added workspace reporting support to sys-info.
36155>>>>>//                Turned off wrapping in the sys-info editor.
36155>>>>>// KR  ??/??/96   File created
36155>>>>>//************************************************************************
36155>>>>>Use windows.pkg
36155>>>>>Use DFbitmap.pkg
36155>>>>>
36155>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
36156>>>>>
36156>>>>>//****************************************************************************
36156>>>>>// $Module type: FUNCTION
36156>>>>>// $Module name: Network_User_Name
36156>>>>>// $Author     : AK/VOO/KCR
36156>>>>>// Created     : 24-09-96 @ 19:17
36156>>>>>//
36156>>>>>// Description
36156>>>>>//    This function reads the current username of windows and returns that
36156>>>>>//    name or an text unknown user
36156>>>>>//
36156>>>>>// $Rev History
36156>>>>>//    24-09-96  Module header created
36156>>>>>//****************************************************************************
36156>>>>>Function Network_User_Name Returns String
36158>>>>>    Local String sName sLength
36159>>>>>    Local Pointer lpName_Addr lpLength_Addr
36159>>>>>    Local Integer iRetval
36159>>>>>
36159>>>>>    Movestr (Repeat (Character (0), 255)) To sName
36160>>>>>>
36160>>>>>    GetAddress Of sName To lpName_Addr
36161>>>>>    Movestr (DwordToBytes (255)) To sLength
36162>>>>>>
36162>>>>>    GetAddress Of sLength To lpLength_Addr
36163>>>>>
36163>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
36164>>>>>>
36164>>>>>
36164>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
36167>>>>>    Else Function_Return "User Unknown"
36169>>>>>End_Function // Network_User_Name
36170>>>>>
36170>>>>>Type MEMORYSTATUS
36170>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
36170>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
36170>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
36170>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
36170>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
36170>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
36170>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
36170>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
36170>>>>>End_Type // MEMORYSTATUS
36170>>>>>
36170>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
36171>>>>>
36171>>>>>// If a global workspace object exists it will use this variable to store
36171>>>>>// its object id.
36171>>>>>
36171>>>>>Class SysinfoDisplay Is An Edit
36172>>>>>    Procedure Construct_Object
36173>>>>>        forward send construct_object
36175>>>>>
36175>>>>>        Set Location To 6 6
36176>>>>>        Set Size To 110 255
36177>>>>>        Set Read_Only_State To True
36178>>>>>        Set wrap_state to False
36179>>>>>    end_Procedure
36180>>>>>
36180>>>>>    //****************************************************************************
36180>>>>>    // $Module type: PROCEDURE
36180>>>>>    // $Module name: Add_Line
36180>>>>>    // $Author     : VOO
36180>>>>>    // Created     : 06-10-96 @ 15:23
36180>>>>>    //
36180>>>>>    // Description
36180>>>>>    //    This method will add a line to this edit object, it should go simpler
36180>>>>>    //    but it seems to be done this way.
36180>>>>>    //
36180>>>>>    // $Rev History
36180>>>>>    //    06-10-96  Module header created
36180>>>>>    //****************************************************************************
36180>>>>>    Procedure Add_Line String sVal
36181>>>>>        Local Integer iLine
36182>>>>>
36182>>>>>        Moveint (Line_Count (Current_Object)) To iLine
36183>>>>>>
36183>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
36186>>>>>        Set Value Item iLine To sVal
36187>>>>>    End_Procedure // Add_Line
36188>>>>>
36188>>>>>    //****************************************************************************
36188>>>>>    // $Module type: PROCEDURE
36188>>>>>    // $Module name: Show_Current_Directory
36188>>>>>    // $Author     : VOO
36188>>>>>    // Created     : 06-10-96 @ 15:24
36188>>>>>    //
36188>>>>>    // Description
36188>>>>>    //    This method will show the name of the current directory in the system
36188>>>>>    //    information box
36188>>>>>    //
36188>>>>>    // $Rev History
36188>>>>>    //    06-10-96  Module header created
36188>>>>>    //****************************************************************************
36188>>>>>    Procedure Show_Current_Directory
36189>>>>>        Local String sDir
36190>>>>>
36190>>>>>        Get_Current_Directory To sDir
36191>>>>>        Send Add_Line ("Current Directory: " + sDir)
36192>>>>>    End_Procedure // Show_Current_Directory
36193>>>>>
36193>>>>>    Procedure Show_Windows_Directory
36194>>>>>        Local String sWindir
36195>>>>>
36195>>>>>        Get_Windows_Directory To sWindir
36196>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
36197>>>>>    End_Procedure // Show_Windows_Directory
36198>>>>>
36198>>>>>    Procedure Show_Current_User
36199>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
36200>>>>>    End_Procedure // Show_Current_User
36201>>>>>
36201>>>>>    Procedure Show_Number_Format
36202>>>>>        Local Integer iFormat
36203>>>>>
36203>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
36206>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
36207>>>>>        Get_Number_Format To iFormat
36208>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
36209>>>>>    End_Procedure // Show_Number_Format
36210>>>>>
36210>>>>>    Procedure Show_Filelist_Name
36211>>>>>        Local String sFilename
36212>>>>>
36212>>>>>        Get_Attribute Df_Filelist_Name To sFilename
36215>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
36216>>>>>    End_Procedure // Show_Filelist_Name
36217>>>>>
36217>>>>>    Procedure Show_Lock_Delay
36218>>>>>        Local Integer iLockdelay
36219>>>>>
36219>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
36222>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
36223>>>>>    End_Procedure // Show_Lock_Delay
36224>>>>>
36224>>>>>    Procedure Show_Lock_Timeout
36225>>>>>        Local Integer iLockTimeout
36226>>>>>
36226>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
36229>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
36230>>>>>    End_Procedure // Show_Lock_Timeout
36231>>>>>
36231>>>>>    Procedure Show_Screen_Size
36232>>>>>        Local Integer iYscreensize iXscreensize
36233>>>>>
36233>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
36234>>>>>>
36234>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
36235>>>>>>
36235>>>>>
36235>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
36236>>>>>    End_Procedure // Show_Screen_Size
36237>>>>>
36237>>>>>    Procedure Show_Page_Size
36238>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
36239>>>>>    End_procedure
36240>>>>>
36240>>>>>    Procedure Show_Date
36241>>>>>        Local Date dToday
36242>>>>>
36242>>>>>        Sysdate4 dToday
36243>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
36244>>>>>    End_procedure // Show_Date
36245>>>>>
36245>>>>>    Procedure Show_Date_Format
36246>>>>>        Local Integer iDateFormat
36247>>>>>        Local String sDateFormat
36247>>>>>
36247>>>>>        Get_Attribute Df_Date_Format To iDateFormat
36250>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
36253>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
36257>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
36261>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
36263>>>>>        Send Add_Line ("Date Format: " * sDateformat)
36264>>>>>    End_Procedure // Show_Date_Format
36265>>>>>
36265>>>>>    Procedure Show_Memavail
36266>>>>>        Local Integer iMem
36267>>>>>
36267>>>>>        Memory iMem
36268>>>>>>
36268>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
36269>>>>>    End_Procedure // Show_Memavail
36270>>>>>
36270>>>>>    Procedure Show_Systemresources
36271>>>>>        Local String sMemoryStatus
36272>>>>>        Local Pointer lpsMemoryStatus
36272>>>>>        Local Integer iVoid
36272>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
36272>>>>>
36272>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
36273>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
36274>>>>>
36274>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
36275>>>>>>
36275>>>>>
36275>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
36276>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
36277>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
36278>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
36279>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
36280>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
36281>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
36282>>>>>
36282>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
36283>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
36284>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
36285>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
36286>>>>>    End_Procedure // Show_Systemresources
36287>>>>>
36287>>>>>    Procedure Show_Registration
36288>>>>>        Local String sRegName
36289>>>>>        Local Integer iSN
36289>>>>>        Registration sRegName iSN
36290>>>>>>
36290>>>>>
36290>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
36291>>>>>        Send Add_Line ("Reg Name: " + sRegName)
36292>>>>>
36292>>>>>    End_Procedure // Show_Current_Directory
36293>>>>>
36293>>>>>
36293>>>>>
36293>>>>>    //****************************************************************************
36293>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
36293>>>>>    // to the workspace object passing the an object and message to send back
36293>>>>>    // to this object. It is expected that the workspace object will send this
36293>>>>>    // message for every line of information it wants displayed (passing the
36293>>>>>    // information to be displayed
36293>>>>>    //****************************************************************************
36293>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
36293>>>>>    Procedure Show_WorkspaceInformation
36294>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
36297>>>>>    End_Procedure
36298>>>>>
36298>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
36299>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
36300>>>>>    End_Function
36301>>>>>
36301>>>>>    Procedure Show_Versions
36302>>>>>        local integer iVersion iRevision iBuild
36303>>>>>        Version_information iVersion iRevision iBuild
36305>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
36306>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
36307>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
36308>>>>>    End_Procedure
36309>>>>>
36309>>>>>
36309>>>>>    //***
36309>>>>>    //*** BW
36309>>>>>    //*** Procedure: Show_Drivers
36309>>>>>    //*** Purpose  : Show loaed database drivers
36309>>>>>    //***
36309>>>>>
36309>>>>>    Procedure Show_Drivers
36310>>>>>        Local String  Current_drvr
36311>>>>>        Local String  Loadeddrvrs
36311>>>>>        Local Integer Number_of_drvrs
36311>>>>>        Local Integer Count
36311>>>>>
36311>>>>>        Move "" To Loadeddrvrs
36312>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
36315>>>>>        For Count From 1 To Number_of_drvrs
36321>>>>>>
36321>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
36324>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
36327>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
36328>>>>>        Loop
36329>>>>>>
36329>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
36330>>>>>    End_Procedure // Show_Drivers
36331>>>>>
36331>>>>>    //****************************************************************************
36331>>>>>    // $Module type: PROCEDURE
36331>>>>>    // $Module name: Add_Focus
36331>>>>>    // $Author     : VOO
36331>>>>>    // Created     : 24-09-96 @ 19:43
36331>>>>>    //
36331>>>>>    // Description
36331>>>>>    //    During activation we will remove the old information and add the newly
36331>>>>>    //    found systeminformation
36331>>>>>    //
36331>>>>>    // $Rev History
36331>>>>>    //    24-09-96  Module header created
36331>>>>>    //****************************************************************************
36331>>>>>    Procedure Add_Focus Integer hoRoot
36332>>>>>        Forward Send Add_Focus hoRoot
36334>>>>>
36334>>>>>        Send Delete_Data
36335>>>>>        Set Changed_State To False
36336>>>>>        Set Read_Only_State To True
36337>>>>>        Send Show_WorkSpaceInformation // added to show WS info
36338>>>>>        SEnd Show_Drivers
36339>>>>>        Send Show_Current_User
36340>>>>>        Send Show_Windows_Directory
36341>>>>>        Send Show_Current_Directory
36342>>>>>        Send Show_Filelist_Name
36343>>>>>        Send Show_Versions
36344>>>>>        Send Show_Memavail
36345>>>>>        Send Show_Screen_Size
36346>>>>>        Send Show_Page_Size
36347>>>>>        Send Show_Number_Format
36348>>>>>        Send Show_Date_Format
36349>>>>>        Send Show_Lock_Delay
36350>>>>>        Send Show_Lock_Timeout
36351>>>>>        Send Show_Date
36352>>>>>        Send Show_Systemresources
36353>>>>>        Send Show_Registration
36354>>>>>    End_Procedure // Show_All_Info
36355>>>>>
36355>>>>>End_Class // SysinfoDisplay
36356>>>>>
36356>>>>>
36356>>>>>//****************************************************************************
36356>>>>>// $Module type: OBJECT
36356>>>>>// $Module name: Sysinfo_Dialog
36356>>>>>// $Author     : VOO
36356>>>>>// Created     : 24-09-96 @ 18:47
36356>>>>>//
36356>>>>>// Description
36356>>>>>//    This object shows the systeminformation on the screen
36356>>>>>//
36356>>>>>// $Rev History
36356>>>>>//    24-09-96  Module header created
36356>>>>>//****************************************************************************
36356>>>>>Class SysInfoDialog Is A ModalPanel
36357>>>>>    Procedure Construct_Object
36358>>>>>        forward send construct_object
36360>>>>>
36360>>>>>        Set Caption_Bar To True
36361>>>>>        Set Sysmenu_Icon To True
36362>>>>>        Set Label To "System Information"
36363>>>>>        Set Size To 152 270
36364>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
36365>>>>>        Set Minimize_Icon To False
36366>>>>>        Set Maximize_Icon To False
36367>>>>>        Set Border_Style To Border_Dialog
36368>>>>>
36368>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
36370>>>>>        End_Object
36371>>>>>
36371>>>>>        Object Close_Button Is A Button
36373>>>>>            Set Label to "&Close"
36374>>>>>            Set Location To 120 212
36375>>>>>            Set Message item 0 to msg_Close_Panel
36376>>>>>            Set default_action_button to current_object
36377>>>>>        End_Object // Close_Button
36378>>>>>
36378>>>>>        On_Key Kcancel       Send Close_Panel
36379>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
36380>>>>>    End_procedure
36381>>>>>
36381>>>>>End_Class // SysinfoDialog
36382>>>>>
36382>>>>>// Purpose:
36382>>>>>//
36382>>>>>// Ken Ross 12/17/96 5:16PM
36382>>>>>//
36382>>>>>Class AboutDialog Is A ModalPanel
36383>>>>>
36383>>>>>    Procedure construct_object
36384>>>>>        String sVdfRootDir
36385>>>>>        forward send construct_object
36387>>>>>        Set Label to "About..."
36388>>>>>        Set Size to 100 217
36389>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
36390>>>>>
36390>>>>>        Object SysInfo_Dialog is a SysInfoDialog
36392>>>>>        End_Object
36393>>>>>
36393>>>>>        Object oBox is a Container3d
36395>>>>>            Set Border_Style to Border_StaticEdge
36396>>>>>            Set Size to 63 202
36397>>>>>            Set Location to 4 5
36398>>>>>
36398>>>>>            Object AboutGraphic is a BitmapContainer
36400>>>>>                Set Border_Style to Border_None
36401>>>>>                Set Bitmap_Style to Bitmap_Center
36402>>>>>                Set Size to 48 48
36403>>>>>                Set Location to 7 2
36404>>>>>            End_Object    // AboutGraphic
36405>>>>>
36405>>>>>            Object ProductName is a TextBox
36407>>>>>                Set label to "ProductName"
36408>>>>>                Set Size to 10 45
36409>>>>>                Set Location to 8 53
36410>>>>>            End_Object    // ProductName
36411>>>>>
36411>>>>>            Object Version is a TextBox
36413>>>>>                Set label to "Version"
36414>>>>>                Set Size to 10 25
36415>>>>>                Set Location to 21 53
36416>>>>>            End_Object    // Version
36417>>>>>
36417>>>>>            Object Copyright is a TextBox
36419>>>>>                Set label to "Copyright"
36420>>>>>                Set Size to 10 31
36421>>>>>                Set Location to 34 53
36422>>>>>            End_Object    // Copyright
36423>>>>>
36423>>>>>            Object Author is a TextBox
36425>>>>>                Set label to "Author"
36426>>>>>                Set Size to 10 22
36427>>>>>                Set Location to 46 53
36428>>>>>            End_Object    // Author
36429>>>>>
36429>>>>>        End_Object    // oBox
36430>>>>>
36430>>>>>        Object OK_bn is a Button
36432>>>>>            On_Item "&OK" Send Close_Panel
36433>>>>>            Set Size to 14 50
36434>>>>>            Set Location to 71 157
36435>>>>>        End_Object    // OK_bn
36436>>>>>
36436>>>>>        Object SysInfo_bn is a Button
36438>>>>>            On_Item "&System Info" Send Show_Sysinfo
36439>>>>>            Set Size to 14 50
36440>>>>>            Set Location to 71 101
36441>>>>>        End_Object    // SysInfo_bn
36442>>>>>
36442>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
36443>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
36444>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
36445>>>>>
36445>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
36448>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
36449>>>>>
36449>>>>>    End_Procedure
36450>>>>>
36450>>>>>    Procedure set productname string sval
36451>>>>>        set label of (productname(oBox(current_object))) to sval
36452>>>>>    End_Procedure
36453>>>>>
36453>>>>>    Procedure set version string sval
36454>>>>>        set label of (version(oBox(current_object))) to sval
36455>>>>>    End_Procedure
36456>>>>>
36456>>>>>    Procedure set copyright string sval
36457>>>>>        set label of (copyright(oBox(current_object))) to sval
36458>>>>>    End_Procedure
36459>>>>>
36459>>>>>    Procedure set author string sval
36460>>>>>        set label of (author(oBox(current_object))) to sval
36461>>>>>    End_Procedure
36462>>>>>
36462>>>>>    // square bitmaps of 42x42 work best
36462>>>>>    //
36462>>>>>    Procedure set logo string sval
36463>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
36464>>>>>    End_Procedure
36465>>>>>
36465>>>>>    Procedure Show_Sysinfo
36466>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
36467>>>>>    End_Procedure // Show_Sysinfo
36468>>>>>
36468>>>>>End_Class
36469>>>>>
36469>>>>>
36469>>>>>//Object About_Dialog is an AboutDialog
36469>>>>>//    set productname to "Visual DataFlex"
36469>>>>>//    set version to "version 4.0"
36469>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
36469>>>>>//    set author to ""
36469>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
36469>>>>>//End_Object
36469>>>>>
36469>>>>>//Procedure Activate_About
36469>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
36469>>>>>//End_Procedure
36469>>>
36469>>>// *************************************************************************
36469>>>//  Public message. This is the default message. It is expected that you will
36469>>>//   create your own message to override this
36469>>>// *************************************************************************
36469>>>
36469>>>Procedure Activate_About
36471>>>   Send DoAbout "" "" "" "" "" ""
36472>>>End_Procedure
36473>>>
36473>>>// *************************************************************************
36473>>>//  Public message. It is expected that you will send this message (most
36473>>>//  likely from Activate_About. This creates an about object, activates it
36473>>>//  and destroys it when done. It is not exepected that you will augment this.
36473>>>// *************************************************************************
36473>>>
36473>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
36475>>>        Local integer hoObj hoMain
36476>>>
36476>>>        // create object
36476>>>        Object About is an AboutDialog
36478>>>            // if no title passed use the label of the main panel
36478>>>            // (if a main panel exists).
36478>>>            if sTitle     eq '' Begin
36480>>>                Get Main_Window to hoMain
36481>>>                if hoMain Get Label of hoMain to sTitle
36484>>>            end
36484>>>>
36484>>>            set productname to sTitle
36485>>>            set version     to sVersion
36486>>>            set copyright   to sCopyRight
36487>>>            set author      to sAuthor
36488>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
36491>>>            Move Current_Object to hoObj // object Id
36492>>>        End_Object
36493>>>        Send Popup to hoObj    // popup the about object
36494>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
36495>>>End_procedure
36496>    
36496>    
36496>    
36496>    
36496>    
36496>    
36496>    
36496>    
36496>    //AB-PanelStoreEnd
36496>
36496>
36496>End_Object
36497>
36497>
36497>//AB-StoreStart
36497>
36497>Start_UI
36498>
36498>
36498>
36498>
36498>
36498>
36498>//AB-StoreEnd
36498>
36498>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 20461
Total Resources: 0
Total Commands : 36497
Total Windows  : 1
Total Pages    : 1
Static Data    : 255469
Message area   : 182482
Total Blocks   : 11967
