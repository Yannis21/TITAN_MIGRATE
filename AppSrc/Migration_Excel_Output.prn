Compiling Program: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
Memory Available: 248676352
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files\Visual DataFlex 14.1\Pkg\dfallent.pkd)
48529>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJStandardCommandBarSystem.pkg)
48529>>>// these are all the packages used in a standard MDI menubar/toolbar system
48529>>>
48529>>>Use cCJCommandBarSystem.pkg
48529>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJStandardMenuItemClasses.pkg)
48529>>>>>Use Dfpanel.pkg
48529>>>>>Use cCJCommandBarSystem.pkg
48529>>>>>Use LanguageText.pkg
48529>>>>>
48529>>>>>
48529>>>>>Class cCJUndoMenuItem is a cCJMenuItem
48530>>>>>    
48530>>>>>    Procedure Construct_Object
48532>>>>>        Forward Send Construct_Object
48534>>>>>        Set psCaption   to C_$CaptionUndo
48535>>>>>        Set psToolTip to C_$ToolTipUndo
48536>>>>>        Set psDescription to C_$DescUndo
48537>>>>>        Set psImage to "ActionUndo.ico"
48538>>>>>        Set pbActiveUpdate to True
48539>>>>>        Set psCategory to C_$CategoryEdit
48540>>>>>        Set psShortcut to C_$Key_Ctrl_Z
48541>>>>>    End_Procedure
48542>>>>>
48542>>>>>    Procedure OnExecute Variant vCommandBarControl
48544>>>>>        Send Undo of (focus(Self))
48545>>>>>    End_Procedure
48546>>>>>    
48546>>>>>    Function IsEnabled Returns Boolean
48548>>>>>        Boolean bEnabled
48548>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
48549>>>>>        Function_Return bEnabled
48550>>>>>    End_Function
48551>>>>>         
48551>>>>>End_Class
48552>>>>>
48552>>>>>
48552>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
48553>>>>>    
48553>>>>>    Procedure Construct_Object
48555>>>>>        Forward Send Construct_Object
48557>>>>>        Set psCaption   to C_$CaptionDelete
48558>>>>>        Set psToolTip to C_$ToolTipDelete
48559>>>>>        Set psDescription to C_$DescDelete
48560>>>>>        Set psImage to "actionDelete.ico"
48561>>>>>        Set psShortcut to C_$Key_Delete
48562>>>>>        Set pbActiveUpdate to True
48563>>>>>        Set psCategory to C_$CategoryEdit
48564>>>>>    End_Procedure
48565>>>>>
48565>>>>>
48565>>>>>    Procedure OnExecute Variant vCommandBarControl
48567>>>>>        Send Delete of (focus(Self))
48568>>>>>    End_Procedure
48569>>>>>    
48569>>>>>    Function IsEnabled Returns Boolean
48571>>>>>        Boolean bEnabled
48571>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
48572>>>>>        Function_Return bEnabled
48573>>>>>    End_Function
48574>>>>>         
48574>>>>>End_Class
48575>>>>>
48575>>>>>
48575>>>>>Class cCJCutMenuItem is a cCJMenuItem
48576>>>>>    
48576>>>>>    Procedure Construct_Object
48578>>>>>        Forward Send Construct_Object
48580>>>>>        Set psCaption   to C_$CaptionCut
48581>>>>>        Set psToolTip to C_$TooltipCut
48582>>>>>        Set psDescription to C_$DescCut
48583>>>>>        Set psImage to "actionCut.ico"
48584>>>>>        Set psShortcut to C_$Key_Ctrl_X
48585>>>>>        Set pbActiveUpdate to True
48586>>>>>        Set psCategory to C_$CategoryEdit
48587>>>>>    End_Procedure
48588>>>>>
48588>>>>>
48588>>>>>    Procedure OnExecute Variant vCommandBarControl
48590>>>>>        Send Cut of (focus(Self))
48591>>>>>    End_Procedure
48592>>>>>    
48592>>>>>    Function IsEnabled Returns Boolean
48594>>>>>        Boolean bEnabled
48594>>>>>        Get CanCut of (Focus(Self)) to bEnabled
48595>>>>>        Function_Return bEnabled
48596>>>>>    End_Function
48597>>>>>         
48597>>>>>End_Class
48598>>>>>
48598>>>>>
48598>>>>>Class cCJCopyMenuItem is a cCJMenuItem
48599>>>>>    
48599>>>>>    Procedure Construct_Object
48601>>>>>        Forward Send Construct_Object
48603>>>>>        Set psCaption   to C_$CaptionCopy
48604>>>>>        Set psToolTip to C_$ToolTipCopy
48605>>>>>        Set psDescription to C_$DescCopy
48606>>>>>        Set psImage to "actionCopy.ico"
48607>>>>>        Set psShortcut to C_$Key_Ctrl_C
48608>>>>>        Set pbActiveUpdate to True
48609>>>>>        Set psCategory to C_$CategoryEdit
48610>>>>>    End_Procedure
48611>>>>>
48611>>>>>
48611>>>>>    Procedure OnExecute Variant vCommandBarControl
48613>>>>>        Send Copy of (focus(Self))
48614>>>>>    End_Procedure
48615>>>>>    
48615>>>>>    Function IsEnabled Returns Boolean
48617>>>>>        Boolean bEnabled
48617>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
48618>>>>>        Function_Return bEnabled
48619>>>>>    End_Function
48620>>>>>         
48620>>>>>End_Class
48621>>>>>
48621>>>>>
48621>>>>>Class cCJPasteMenuItem is a cCJMenuItem
48622>>>>>    
48622>>>>>    Procedure Construct_Object
48624>>>>>        Forward Send Construct_Object
48626>>>>>        Set psCaption   to C_$CaptionPaste
48627>>>>>        Set psToolTip to C_$ToolTipPaste
48628>>>>>        Set psDescription to C_$DescPaste
48629>>>>>        Set psImage to "actionPaste.ico"
48630>>>>>        Set pbActiveUpdate to True
48631>>>>>        Set psShortcut to C_$Key_Ctrl_V
48632>>>>>        Set psCategory to C_$CategoryEdit
48633>>>>>    End_Procedure
48634>>>>>
48634>>>>>
48634>>>>>    Procedure OnExecute Variant vCommandBarControl
48636>>>>>        Send Paste of (focus(Self))
48637>>>>>    End_Procedure
48638>>>>>    
48638>>>>>    Function IsEnabled Returns Boolean
48640>>>>>        Boolean bEnabled
48640>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
48641>>>>>        Function_Return bEnabled
48642>>>>>    End_Function
48643>>>>>         
48643>>>>>End_Class
48644>>>>>
48644>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
48645>>>>>    
48645>>>>>    Procedure Construct_Object
48647>>>>>        Forward Send Construct_Object
48649>>>>>        Set psCaption   to C_$CaptionSelectAll
48650>>>>>        Set psToolTip to C_$ToolTipSelectAll
48651>>>>>        Set psDescription to C_$DescSelectAll
48652>>>>>        Set pbActiveUpdate to True
48653>>>>>        Set psShortcut to C_$Key_Ctrl_A
48654>>>>>        Set psCategory to C_$CategoryEdit
48655>>>>>    End_Procedure
48656>>>>>
48656>>>>>
48656>>>>>    Procedure OnExecute Variant vCommandBarControl
48658>>>>>        Send Select_All of (focus(Self))
48659>>>>>    End_Procedure
48660>>>>>    
48660>>>>>    Function IsEnabled Returns Boolean
48662>>>>>        Boolean bEnabled
48662>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
48663>>>>>        Function_Return bEnabled
48664>>>>>    End_Function
48665>>>>>         
48665>>>>>End_Class
48666>>>>>
48666>>>>> 
48666>>>>>Class cCJExitMenuItem is a cCJMenuItem
48667>>>>>
48667>>>>>    Procedure Construct_Object
48669>>>>>        Forward Send Construct_Object
48671>>>>>        Set psCaption to C_$CaptionExit
48672>>>>>        Set psToolTip to C_$ToolTipExit
48673>>>>>        Set psDescription to C_$ToolTipExit
48674>>>>>        Set psShortcut to C_$Key_Alt_F4
48675>>>>>        Set psCategory to C_$CategoryFile
48676>>>>>    End_Procedure
48677>>>>>
48677>>>>>    Procedure OnExecute Variant vCommandBarControl
48679>>>>>        Send Exit_Application of Desktop
48680>>>>>    End_Procedure
48681>>>>>
48681>>>>>End_Class           
48682>>>>>
48682>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
48683>>>>>
48683>>>>>    Procedure Construct_Object
48685>>>>>        Forward Send Construct_Object
48687>>>>>        Set psCaption to C_$CaptionHelp
48688>>>>>        Set psDescription to C_$ToolTipHelp
48689>>>>>        Set psToolTip to C_$DescHelp
48690>>>>>        Set psImage to "ActionHelp.ico"
48691>>>>>        Set psShortcut to "F1"
48692>>>>>        Set psCategory to C_$CategoryHelp
48693>>>>>    End_Procedure
48694>>>>>    
48694>>>>>    Procedure OnExecute Variant vCommandBarControl
48696>>>>>        Send Help of (Focus(Self))
48697>>>>>    End_Procedure
48698>>>>>
48698>>>>>End_Class
48699>>>>>
48699>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
48700>>>>>
48700>>>>>    Procedure Construct_Object
48702>>>>>        Forward Send Construct_Object
48704>>>>>        Set psCaption to C_$CaptionAddStatusbar
48705>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
48706>>>>>        Set psDescription to  C_$DescAddStatusbar
48707>>>>>        Set psCategory to C_$CategoryWindow
48708>>>>>    End_Procedure
48709>>>>>
48709>>>>>    Procedure OnExecute Variant vCommandBarControl
48711>>>>>        Handle hoCommandBars hoClientArea
48711>>>>>        Get CommandBarSystemObject to hoCommandBars
48712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48713>>>>>        If hoClientArea Begin
48715>>>>>            // the clientarea's parent panel has message
48715>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
48716>>>>>        End
48716>>>>>>
48716>>>>>    End_Procedure
48717>>>>>
48717>>>>>     Function IsChecked Returns Boolean
48719>>>>>        Boolean bOn
48719>>>>>        Handle hoCommandBars hoClientArea
48719>>>>>        Get CommandBarSystemObject to hoCommandBars
48720>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48721>>>>>        If hoClientArea Begin
48723>>>>>            // the clientarea's parent panel has message
48723>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
48724>>>>>        End
48724>>>>>>
48724>>>>>        Function_Return bOn
48725>>>>>     End_Function
48726>>>>>End_Class
48727>>>>>
48727>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
48728>>>>>
48728>>>>>    Procedure Construct_Object
48730>>>>>        Forward Send Construct_Object
48732>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
48733>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
48734>>>>>        Set psDescription to C_$DescAutoArrangeIcons
48735>>>>>        Set psCategory to C_$CategoryWindow
48736>>>>>    End_Procedure
48737>>>>>
48737>>>>>    Procedure OnExecute Variant vCommandBarControl
48739>>>>>        Handle hoCommandBars hoClientArea
48739>>>>>        Get CommandBarSystemObject to hoCommandBars
48740>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48741>>>>>        If hoClientArea Begin
48743>>>>>            // the clientarea's parent panel has message
48743>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
48744>>>>>        End
48744>>>>>>
48744>>>>>    End_Procedure
48745>>>>>    
48745>>>>>     Function IsChecked Returns Boolean
48747>>>>>        Boolean bOn
48747>>>>>        Handle hoCommandBars hoClientArea
48747>>>>>        Get CommandBarSystemObject to hoCommandBars
48748>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48749>>>>>        If hoClientArea Begin
48751>>>>>            // the clientarea's parent panel has message
48751>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
48752>>>>>        End
48752>>>>>>
48752>>>>>        Function_Return bOn
48753>>>>>     End_Function
48754>>>>>End_Class
48755>>>>>
48755>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
48756>>>>>
48756>>>>>    Procedure Construct_Object
48758>>>>>        Forward Send Construct_Object
48760>>>>>        Set psCaption to C_$CaptionRestoreMenus
48761>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
48762>>>>>        Set psDescription to C_$DescRestoreMenus
48763>>>>>        Set psCategory to C_$CategoryWindow
48764>>>>>    End_Procedure
48765>>>>>
48765>>>>>    Procedure OnExecute Variant vCommandBarControl
48767>>>>>        Handle hoCommandBars
48767>>>>>        Get CommandBarSystemObject to hoCommandBars
48768>>>>>        Send RestoreLayout of hoCommandBars
48769>>>>>    End_Procedure
48770>>>>>    
48770>>>>>End_Class
48771>>>>>
48771>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
48772>>>>>
48772>>>>>    Procedure Construct_Object
48774>>>>>        Forward Send Construct_Object
48776>>>>>        Set psCaption to C_$CaptionCascade
48777>>>>>        Set psToolTip to C_$ToolTipCascade
48778>>>>>        Set psDescription to  C_$DescCascade
48779>>>>>        Set psImage to "ActionCascade.ico"
48780>>>>>        Set psCategory to C_$CategoryWindow
48781>>>>>    End_Procedure
48782>>>>>    
48782>>>>>    Procedure OnExecute Variant vCommandBarControl
48784>>>>>        Handle hoCommandBars hoClientArea
48784>>>>>        Get CommandBarSystemObject to hoCommandBars
48785>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48786>>>>>        If hoClientArea Begin
48788>>>>>            Send Cascade_Windows of hoClientArea
48789>>>>>        End
48789>>>>>>
48789>>>>>    End_Procedure
48790>>>>>End_Class
48791>>>>>
48791>>>>>Class cCJTileHorizontally is a cCJMenuItem
48792>>>>>
48792>>>>>    Procedure Construct_Object
48794>>>>>        Forward Send Construct_Object
48796>>>>>        Set psCaption to C_$CaptionTileHorizontally 
48797>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
48798>>>>>        Set psDescription to  C_$DescTileHorizontally
48799>>>>>        Set psImage to "ActionTileHorizontally.ico"
48800>>>>>        Set psCategory to C_$CategoryWindow
48801>>>>>    End_Procedure
48802>>>>>
48802>>>>>    Procedure OnExecute Variant vCommandBarControl
48804>>>>>        Handle hoCommandBars hoClientArea
48804>>>>>        Get CommandBarSystemObject to hoCommandBars
48805>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48806>>>>>        If hoClientArea Begin
48808>>>>>            Send Tile_Windows_Horizontal of hoClientArea
48809>>>>>        End
48809>>>>>>
48809>>>>>    End_Procedure
48810>>>>>End_Class
48811>>>>>
48811>>>>>Class cCJTileVertically is a cCJMenuItem
48812>>>>>
48812>>>>>    Procedure Construct_Object
48814>>>>>        Forward Send Construct_Object
48816>>>>>        Set psCaption to C_$CaptionTileVertically  
48817>>>>>        Set psToolTip to C_$ToolTipTileVertically
48818>>>>>        Set psDescription to  C_$DescTileVertically
48819>>>>>        Set psImage to "ActionTileVertically.ico"
48820>>>>>        Set psCategory to C_$CategoryWindow
48821>>>>>    End_Procedure
48822>>>>>
48822>>>>>    Procedure OnExecute Variant vCommandBarControl
48824>>>>>        Handle hoCommandBars hoClientArea
48824>>>>>        Get CommandBarSystemObject to hoCommandBars
48825>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48826>>>>>        If hoClientArea Begin
48828>>>>>            Send Tile_Windows_Vertical of hoClientArea
48829>>>>>        End
48829>>>>>>
48829>>>>>    End_Procedure
48830>>>>>End_Class
48831>>>>>
48831>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
48832>>>>>
48832>>>>>    Procedure Construct_Object
48834>>>>>        Forward Send Construct_Object
48836>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
48837>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
48838>>>>>        Set psDescription to  C_$DescMinimizeWindows
48839>>>>>        Set psCategory to C_$CategoryWindow
48840>>>>>    End_Procedure
48841>>>>>
48841>>>>>    Procedure OnExecute Variant vCommandBarControl
48843>>>>>        Handle hoCommandBars hoClientArea
48843>>>>>        Get CommandBarSystemObject to hoCommandBars
48844>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48845>>>>>        If hoClientArea Begin
48847>>>>>            // the clientarea's parent panel has message
48847>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
48848>>>>>        End
48848>>>>>>
48848>>>>>    End_Procedure
48849>>>>>End_Class
48850>>>>>
48850>>>>>
48850>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
48851>>>>>
48851>>>>>    Procedure Construct_Object
48853>>>>>        Forward Send Construct_Object
48855>>>>>        Set psCaption to C_$CaptionRestoreWindows
48856>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
48857>>>>>        Set psDescription to  C_$DescRestoreWindows
48858>>>>>        Set psCategory to C_$CategoryWindow
48859>>>>>    End_Procedure
48860>>>>>
48860>>>>>    Procedure OnExecute Variant vCommandBarControl
48862>>>>>        Handle hoCommandBars hoClientArea
48862>>>>>        Get CommandBarSystemObject to hoCommandBars
48863>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48864>>>>>        If hoClientArea Begin
48866>>>>>            // the clientarea's parent panel has message
48866>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
48867>>>>>        End
48867>>>>>>
48867>>>>>    End_Procedure
48868>>>>>End_Class
48869>>>>>
48869>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
48870>>>>>
48870>>>>>    Procedure Construct_Object
48872>>>>>        Forward Send Construct_Object
48874>>>>>        Set psCaption to C_$CaptionArrangeIcons  
48875>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
48876>>>>>        Set psDescription to  C_$DescArrangeIcons
48877>>>>>        Set psCategory to C_$CategoryWindow
48878>>>>>    End_Procedure
48879>>>>>
48879>>>>>    Procedure OnExecute Variant vCommandBarControl
48881>>>>>        Handle hoCommandBars hoClientArea
48881>>>>>        Get CommandBarSystemObject to hoCommandBars
48882>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48883>>>>>        If hoClientArea Begin
48885>>>>>            Send Arrange_Icons of hoClientArea
48886>>>>>        End
48886>>>>>>
48886>>>>>    End_Procedure
48887>>>>>
48887>>>>>End_Class
48888>>>>>    
48888>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJAboutMenuItem.pkg)
48888>>>>>Use cCJCommandBarSystem.pkg
48888>>>>>Use LanguageText.pkg
48888>>>>>
48888>>>>>// It is expected that if you use this class that you provide an about object that is
48888>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
48888>>>>>// because you may wish to create your own custom about package.
48888>>>>>
48888>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
48889>>>>>
48889>>>>>    Procedure Construct_Object
48891>>>>>        Forward Send Construct_Object
48893>>>>>        Set psCaption to C_$CaptionAbout
48894>>>>>        Set psDescription to C_$ToolTipAbout
48895>>>>>        Set psToolTip to C_$DescAbout
48896>>>>>        Set psImage to "ActionAbout.ico"
48897>>>>>        Set psCategory to C_$CategoryHelp
48898>>>>>    End_Procedure
48899>>>>>    
48899>>>>>    Procedure OnExecute Variant vCommandBarControl
48901>>>>>        Handle hoCommandBars hoClientArea
48901>>>>>        Get CommandBarSystemObject to hoCommandBars
48902>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
48903>>>>>        If hoClientArea Begin
48905>>>>>            Send Activate_About of hoClientArea
48906>>>>>        End
48906>>>>>>
48906>>>>>    End_Procedure
48907>>>>>
48907>>>>>End_Class
48908>>>>>
48908>>>>>
48908>>>Use cCJDeoMenuItemClasses.pkg
Including file: cCJDeoMenuItemClasses.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJDeoMenuItemClasses.pkg)
48908>>>>>// various DEO menu classes
48908>>>>>
48908>>>>>Use cCJCommandBarSystem.pkg
48908>>>>>Use LanguageText.pkg
48908>>>>>
48908>>>>>// Sub-class for all Date entry menu items
48908>>>>>
48908>>>>>Class cCJDeoMenuItem is a cCJMenuItem
48909>>>>>    
48909>>>>>    Procedure Construct_Object
48911>>>>>        Forward Send Construct_Object
48913>>>>>        Set psCategory to C_$CategoryDEO
48914>>>>>        Set pbActiveUpdate to True
48915>>>>>    End_Procedure
48916>>>>>
48916>>>>>    // This just redirects to cCJCommandBarsSystem object
48916>>>>>    // returns information about the Focus object. If it returns True its a DEO. If a DEO the
48916>>>>>    // server, hasRecord, changed and hasindex info will all be returned by ref.
48916>>>>>    // If false, these are all unchanged.
48916>>>>>    Function DEOInformation Handle ByRef hoServer Boolean ByRef bHasRecord Boolean ByRef bChanged Boolean ByRef bHasIndex Returns Boolean
48918>>>>>        Handle hoCommandBars
48918>>>>>        Boolean bISDeo
48918>>>>>        Get CommandBarSystemObject to hoCommandBars // must exist or a programming bug
48919>>>>>        Get DEOInformation of hoCommandBars (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDEO
48920>>>>>        Function_Return bISDeo        
48921>>>>>    End_Function
48922>>>>>
48922>>>>>End_Class
48923>>>>>
48923>>>>>// use by all navigate DEOs.
48923>>>>>
48923>>>>>Class cCJDEONavigateMenuItem is a cCJDeoMenuItem
48924>>>>>    Procedure Construct_Object
48926>>>>>        Forward Send Construct_Object
48928>>>>>        Set psCategory to C_$CategoryNavigate
48929>>>>>    End_Procedure
48930>>>>>    
48930>>>>>    Function IsEnabled Returns Boolean
48932>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48932>>>>>        Handle hoServer
48932>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48933>>>>>        Function_Return (bIsDEO)
48934>>>>>    End_Function
48935>>>>>         
48935>>>>>End_Class         
48936>>>>>
48936>>>>>
48936>>>>>Class cCJClearMenuItem is a cCJDeoMenuItem
48937>>>>>    
48937>>>>>    Procedure Construct_Object
48939>>>>>        Forward Send Construct_Object
48941>>>>>        Set psCaption   to C_$CaptionClear
48942>>>>>        Set psToolTip to C_$ToolTipClear
48943>>>>>        Set psDescription to C_$DescClear
48944>>>>>        Set psImage to "ActionClear.ico"
48945>>>>>        Set psShortcut to "F5"
48946>>>>>    End_Procedure
48947>>>>>
48947>>>>>
48947>>>>>    Procedure OnExecute Variant vCommandBarControl
48949>>>>>        Send Request_Clear of (focus(Self))
48950>>>>>    End_Procedure
48951>>>>>    
48951>>>>>    Function IsEnabled Returns Boolean
48953>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48953>>>>>        Handle hoServer
48953>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48954>>>>>        Function_Return (bIsDEO and hoServer and (bChanged or bHasRecord))
48955>>>>>    End_Function
48956>>>>>         
48956>>>>>End_Class         
48957>>>>>
48957>>>>>
48957>>>>>Class cCJClearAllMenuItem is a cCJDeoMenuItem
48958>>>>>    
48958>>>>>    Procedure Construct_Object
48960>>>>>        Forward Send Construct_Object
48962>>>>>        Set psCaption   to C_$CaptionClearAll
48963>>>>>        Set psToolTip to C_$ToolTipClearAll
48964>>>>>        Set psDescription to C_$DescClearAll
48965>>>>>        Set psImage to "ActionClearAll.ico"
48966>>>>>        Set psShortcut to C_$Key_Ctrl_F5
48967>>>>>    End_Procedure
48968>>>>>
48968>>>>>    Procedure OnExecute Variant vCommandBarControl
48970>>>>>        Send Request_Clear_All of (focus(Self))
48971>>>>>    End_Procedure
48972>>>>>    
48972>>>>>    Function IsEnabled Returns Boolean
48974>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48974>>>>>        Handle hoServer
48974>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48975>>>>>        Function_Return (bIsDEO and hoServer and (bChanged or bHasRecord))
48976>>>>>    End_Function
48977>>>>>    
48977>>>>>End_Class         
48978>>>>>
48978>>>>>
48978>>>>>
48978>>>>>Class cCJSaveMenuItem is a cCJDeoMenuItem
48979>>>>>    
48979>>>>>    Procedure Construct_Object
48981>>>>>        Forward Send Construct_Object
48983>>>>>        Set psCaption   to C_$CaptionSave
48984>>>>>        Set psToolTip to C_$ToolTipSave
48985>>>>>        Set psDescription to C_$DescSave
48986>>>>>        Set psImage to "ActionSaveRecord.ico"
48987>>>>>        Set psShortcut to "F2"
48988>>>>>    End_Procedure
48989>>>>>
48989>>>>>
48989>>>>>    Procedure OnExecute Variant vCommandBarControl
48991>>>>>        Send Request_save of (focus(Self))
48992>>>>>    End_Procedure
48993>>>>>    
48993>>>>>    Function IsEnabled Returns Boolean
48995>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
48995>>>>>        Handle hoServer
48995>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
48996>>>>>        Function_Return (bIsDEO and hoServer and bChanged)
48997>>>>>    End_Function
48998>>>>>         
48998>>>>>End_Class         
48999>>>>>
48999>>>>>
48999>>>>>Class cCJSaveNCMenuItem is a cCJDeoMenuItem
49000>>>>>
49000>>>>>    Procedure Construct_Object
49002>>>>>        Forward Send Construct_Object
49004>>>>>        Set psCaption   to C_$CaptionSaveNC
49005>>>>>        Set psToolTip to C_$ToolTipSaveNC
49006>>>>>        Set psDescription to C_$DescSaveNC
49007>>>>>        Set psImage to "ActionSave.ico"
49008>>>>>        Set psShortcut to "F12"
49009>>>>>    End_Procedure
49010>>>>>
49010>>>>>    Procedure OnExecute Variant vCommandBarControl
49012>>>>>        Send Request_save_No_Clear of (focus(Self))
49013>>>>>    End_Procedure
49014>>>>>
49014>>>>>    Function IsEnabled Returns Boolean
49016>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49016>>>>>        Handle hoServer
49016>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49017>>>>>        Function_Return (bIsDEO and hoServer and bChanged)
49018>>>>>    End_Function
49019>>>>>
49019>>>>>End_Class
49020>>>>>
49020>>>>>
49020>>>>>
49020>>>>>Class cCJDeleteMenuItem is a cCJDeoMenuItem
49021>>>>>
49021>>>>>    Procedure Construct_Object
49023>>>>>        Forward Send Construct_Object
49025>>>>>        Set psCaption   to C_$CaptionDeleteRec
49026>>>>>        Set psToolTip to C_$ToolTipDeleteRec
49027>>>>>        Set psDescription to C_$DescDeleteRec
49028>>>>>        Set psImage to "ActionDeleteRecord.ico"
49029>>>>>        Set psShortcut to C_$Key_Shift_F2
49030>>>>>    End_Procedure
49031>>>>>
49031>>>>>    Procedure OnExecute Variant vCommandBarControl
49033>>>>>        Send Request_Delete of (focus(Self))
49034>>>>>    End_Procedure
49035>>>>>
49035>>>>>    Function IsEnabled Returns Boolean
49037>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49037>>>>>        Handle hoServer
49037>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49038>>>>>        Function_Return (bIsDEO and hoServer and bHasRecord)
49039>>>>>    End_Function
49040>>>>>
49040>>>>>End_Class
49041>>>>>
49041>>>>>
49041>>>>>Class cCJPromptMenuItem is a cCJDeoMenuItem
49042>>>>>     Procedure Construct_Object
49044>>>>>        Forward Send Construct_Object
49046>>>>>        Set psCaption   to C_$CaptionPrompt
49047>>>>>        Set psToolTip to C_$ToolTipPrompt
49048>>>>>        Set psDescription to C_$DescPrompt
49049>>>>>        Set psImage to "ActionPrompt.Ico"
49050>>>>>        Set psShortcut to "F4"
49051>>>>>    End_Procedure
49052>>>>>
49052>>>>>    Procedure OnExecute Variant vCommandBarControl
49054>>>>>        Send Prompt of (focus(Self))
49055>>>>>    End_Procedure
49056>>>>>
49056>>>>>    Function IsEnabled Returns Boolean
49058>>>>>        Handle hoFocus hoPrompt
49058>>>>>        Integer iDelegate
49058>>>>>        Get Focus to hoFocus
49059>>>>>        If (hoFocus>Desktop) Begin
49061>>>>>            Get Delegation_mode of hoFocus to iDelegate
49062>>>>>            Set Delegation_mode of hoFocus to No_Delegate_or_Error
49063>>>>>            Get Prompt_object   of hoFocus to hoPrompt
49064>>>>>            Set Delegation_mode of hoFocus to iDelegate
49065>>>>>        End
49065>>>>>>
49065>>>>>        Function_Return (hoPrompt<>0)
49066>>>>>    End_Function
49067>>>>>   
49067>>>>>End_Class
49068>>>>>
49068>>>>>
49068>>>>>Class cCJZoomMenuItem is a cCJDeoMenuItem
49069>>>>>     Procedure Construct_Object
49071>>>>>        Forward Send Construct_Object
49073>>>>>        Set psCaption   to C_$CaptionZoom
49074>>>>>        Set psToolTip to C_$ToolTipZoom
49075>>>>>        Set psDescription to C_$DescZoom
49076>>>>>        Set psShortcut to C_$Key_Alt_F9
49077>>>>>    End_Procedure
49078>>>>>
49078>>>>>    Procedure OnExecute Variant vCommandBarControl
49080>>>>>        Send Zoom of (focus(Self))
49081>>>>>    End_Procedure
49082>>>>>    
49082>>>>>    Function IsEnabled Returns Boolean
49084>>>>>        Handle hoFocus hoZoom 
49084>>>>>        Integer iDelegate
49084>>>>>        Get Focus to hoFocus
49085>>>>>        If (hoFocus>Desktop) Begin
49087>>>>>            Get Delegation_mode of hoFocus to iDelegate
49088>>>>>            Set Delegation_mode of hoFocus to No_Delegate_or_Error
49089>>>>>            Get Zoom_object   of hoFocus to hoZoom
49090>>>>>            Set Delegation_mode of hoFocus to iDelegate
49091>>>>>        End
49091>>>>>>
49091>>>>>        Function_Return (hoZoom<>0)
49092>>>>>    End_Function
49093>>>>>   
49093>>>>>End_Class
49094>>>>>
49094>>>>>
49094>>>>>Class cCJFindMenuItem is a cCJDeoMenuItem
49095>>>>>    
49095>>>>>    Procedure Construct_Object
49097>>>>>        Forward Send Construct_Object
49099>>>>>        Set psCaption   to C_$CaptionFindGE
49100>>>>>        Set psToolTip to C_$ToolTipFindGE
49101>>>>>        Set psDescription to C_$DescFindGE
49102>>>>>        Set psImage to "ActionFindEq.ico"
49103>>>>>        Set psShortcut to "F9"
49104>>>>>        
49104>>>>>    End_Procedure
49105>>>>>
49105>>>>>    Procedure OnExecute Variant vCommandBarControl
49107>>>>>        Send Find_GE of (focus(Self)) 
49108>>>>>    End_Procedure
49109>>>>>    
49109>>>>>    Function IsEnabled Returns Boolean
49111>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex bIsFind
49111>>>>>        Handle hoServer hoFocus hoCommandBars
49111>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49112>>>>>        If (bIsDEO and hoServer and bHasIndex) Begin
49114>>>>>            // if it is a candidate for finding we must check if this supports the DEO Find protocol
49114>>>>>            Get Focus of desktop to hoFocus
49115>>>>>            Get CommandBarSystemObject to hoCommandBars // must exist or a programming bug
49116>>>>>            Get Is_Function of hoCommandBars Get_Deo_Find_Object hoFocus True to bIsFind
49117>>>>>            Function_Return bIsFind
49118>>>>>        End
49118>>>>>>
49118>>>>>        Function_Return False
49119>>>>>    End_Function
49120>>>>>         
49120>>>>>End_Class         
49121>>>>>
49121>>>>>
49121>>>>>Class cCJFindNextMenuItem is a cCJFindMenuItem
49122>>>>>    
49122>>>>>    Procedure Construct_Object
49124>>>>>        Forward Send Construct_Object
49126>>>>>        Set psCaption   to C_$CaptionFindGT
49127>>>>>        Set psToolTip to C_$ToolTipFindGT
49128>>>>>        Set psDescription to C_$DescFindGT
49129>>>>>        Set psImage to "ActionNext.ico"
49130>>>>>        Set psShortcut to "F8"
49131>>>>>    End_Procedure
49132>>>>>
49132>>>>>    Procedure OnExecute Variant vCommandBarControl
49134>>>>>        Send Find_Next of (focus(Self)) 
49135>>>>>    End_Procedure
49136>>>>>    
49136>>>>>End_Class         
49137>>>>>
49137>>>>>
49137>>>>>Class cCJFindPreviousMenuItem is a cCJFindMenuItem
49138>>>>>    
49138>>>>>    Procedure Construct_Object
49140>>>>>        Forward Send Construct_Object
49142>>>>>        Set psCaption   to C_$CaptionFindLT
49143>>>>>        Set psToolTip to C_$ToolTipFindLT
49144>>>>>        Set psDescription to C_$DescFindLT
49145>>>>>        Set psImage to "ActionPrevious.ico"
49146>>>>>        Set psShortcut to "F7"
49147>>>>>    End_Procedure
49148>>>>>
49148>>>>>    Procedure OnExecute Variant vCommandBarControl
49150>>>>>        Send Find_Previous of (focus(Self)) 
49151>>>>>    End_Procedure
49152>>>>>    
49152>>>>>End_Class        
49153>>>>>
49153>>>>>
49153>>>>>Class cCJFindFirstMenuItem is a cCJFindMenuItem
49154>>>>>    
49154>>>>>    Procedure Construct_Object
49156>>>>>        Forward Send Construct_Object
49158>>>>>        Set psCaption   to C_$CaptionFindFirst
49159>>>>>        Set psToolTip to C_$ToolTipFindFirst
49160>>>>>        Set psDescription to C_$DescFindFirst
49161>>>>>        Set psImage to "ActionFirst.ico"
49162>>>>>        Set psShortcut to C_$Key_Ctrl_Home
49163>>>>>    End_Procedure
49164>>>>>
49164>>>>>    Procedure OnExecute Variant vCommandBarControl
49166>>>>>        Send Find_First of (focus(Self)) 
49167>>>>>    End_Procedure
49168>>>>>    
49168>>>>>End_Class         
49169>>>>>
49169>>>>>
49169>>>>>Class cCJFindLastMenuItem is a cCJFindMenuItem
49170>>>>>    
49170>>>>>    Procedure Construct_Object
49172>>>>>        Forward Send Construct_Object
49174>>>>>        Set psCaption   to C_$CaptionFindLast
49175>>>>>        Set psToolTip to C_$ToolTipFindLast
49176>>>>>        Set psDescription to C_$DescFindLast
49177>>>>>        Set psImage to "ActionLast.ico"
49178>>>>>        Set psShortcut to C_$Key_Ctrl_End
49179>>>>>    End_Procedure
49180>>>>>
49180>>>>>    Procedure OnExecute Variant vCommandBarControl
49182>>>>>        Send Find_Last of (focus(Self)) 
49183>>>>>    End_Procedure
49184>>>>>    
49184>>>>>End_Class         
49185>>>>>
49185>>>>>
49185>>>>>
49185>>>>>Class cCJSuperFindMenuItem is a cCJFindMenuItem
49186>>>>>    
49186>>>>>    Procedure Construct_Object
49188>>>>>        Forward Send Construct_Object
49190>>>>>        Set psCaption   to C_$CaptionSuperFindGE
49191>>>>>        Set psToolTip to C_$ToolTipSuperFindGE
49192>>>>>        Set psDescription to C_$DescSuperFindGE
49193>>>>>        Set psImage to "ActionSuperFindEq.ico"
49194>>>>>        Set psShortcut to "F9"
49195>>>>>        
49195>>>>>    End_Procedure
49196>>>>>
49196>>>>>    Procedure OnExecute Variant vCommandBarControl
49198>>>>>        Send SuperFind of (focus(Self)) 
49199>>>>>    End_Procedure
49200>>>>>    
49200>>>>>    Function IsEnabled Returns Boolean
49202>>>>>        Boolean bIsDEO bHasRecord bChanged bEnabled bHasIndex
49202>>>>>        Handle hoServer
49202>>>>>        Get DEOInformation (&hoServer) (&bHasRecord) (&bChanged) (&bHasIndex) to bIsDeo
49203>>>>>        Function_Return (bIsDEO and hoServer and bHasIndex)
49204>>>>>    End_Function
49205>>>>>         
49205>>>>>End_Class         
49206>>>>>
49206>>>>>
49206>>>>>
49206>>>>>Class cCJSuperFindNextMenuItem is a cCJFindMenuItem
49207>>>>>    
49207>>>>>    Procedure Construct_Object
49209>>>>>        Forward Send Construct_Object
49211>>>>>        Set psCaption   to C_$CaptionSuperFindGT
49212>>>>>        Set psToolTip to C_$ToolTipSuperFindGT
49213>>>>>        Set psDescription to C_$DescSuperFindGT
49214>>>>>        Set psImage to "ActionSuperFindNext.ico"
49215>>>>>        Set psShortcut to "F8"
49216>>>>>    End_Procedure
49217>>>>>
49217>>>>>    Procedure OnExecute Variant vCommandBarControl
49219>>>>>        Send SuperFind_Next of (focus(Self)) 
49220>>>>>    End_Procedure
49221>>>>>    
49221>>>>>End_Class         
49222>>>>>
49222>>>>>
49222>>>>>Class cCJSuperFindPreviousMenuItem is a cCJFindMenuItem
49223>>>>>    
49223>>>>>    Procedure Construct_Object
49225>>>>>        Forward Send Construct_Object
49227>>>>>        Set psCaption   to C_$CaptionSuperFindLT
49228>>>>>        Set psToolTip to C_$ToolTipSuperFindLT
49229>>>>>        Set psDescription to C_$DescSuperFindLT
49230>>>>>        Set psImage to "ActionSuperFindPrev.ico"
49231>>>>>        Set psShortcut to "F7"
49232>>>>>    End_Procedure
49233>>>>>
49233>>>>>    Procedure OnExecute Variant vCommandBarControl
49235>>>>>        Send SuperFind_Previous of (focus(Self)) 
49236>>>>>    End_Procedure
49237>>>>>    
49237>>>>>End_Class        
49238>>>>>
49238>>>>>
49238>>>>>Class cCJNextAreaMenu is a cCJDeoNavigateMenuItem
49239>>>>>
49239>>>>>    Procedure Construct_Object
49241>>>>>        Forward Send Construct_Object
49243>>>>>        Set psCaption to C_$CaptionNextArea
49244>>>>>        Set psDescription to C_$DescNextArea
49245>>>>>        Set psToolTip to C_$ToolTipNextArea
49246>>>>>        Set psShortcut to "F6"
49247>>>>>        Set psImage to "ActionNextArea.ico"
49248>>>>>    End_Procedure
49249>>>>>        
49249>>>>>    Procedure OnExecute Variant vCommandBarControl
49251>>>>>        Send Switch_Next_Area of (Focus(Self))
49252>>>>>    End_Procedure
49253>>>>>        
49253>>>>>End_Class
49254>>>>>    
49254>>>>>Class cCJPriorAreaMenu is a cCJDeoNavigateMenuItem
49255>>>>>
49255>>>>>    Procedure Construct_Object
49257>>>>>        Forward Send Construct_Object
49259>>>>>        Set psCaption to C_$CaptionPriorArea
49260>>>>>        Set psDescription to C_$DescPriorArea
49261>>>>>        Set psToolTip to C_$ToolTipPriorArea
49262>>>>>        Set psShortcut to C_$Key_Shift_F6
49263>>>>>        Set psImage to "ActionPrevArea.ico"
49264>>>>>    End_Procedure
49265>>>>>        
49265>>>>>    Procedure OnExecute Variant vCommandBarControl
49267>>>>>        Send Switch_Prior_Area of (Focus(Self))
49268>>>>>    End_Procedure
49269>>>>>    
49269>>>>>End_Class
49270>>>>>    
49270>>>>>Class cCJNextViewMenu is a cCJDeoNavigateMenuItem
49271>>>>>
49271>>>>>    Procedure Construct_Object
49273>>>>>        Forward Send Construct_Object
49275>>>>>        Set psCaption to C_$CaptionNextView
49276>>>>>        Set psDescription to C_$DescNextView
49277>>>>>        Set psToolTip to C_$ToolTipNextView
49278>>>>>        Set psShortcut to C_$Key_Alt_F6
49279>>>>>        Set psImage to "ActionNextView.ico"
49280>>>>>    End_Procedure
49281>>>>>        
49281>>>>>    Procedure OnExecute Variant vCommandBarControl
49283>>>>>        Handle hoCommandBars hoClientArea
49283>>>>>        Get CommandBarSystemObject to hoCommandBars
49284>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
49285>>>>>        If hoClientArea Begin
49287>>>>>            Send Switch_Next_View of hoClientArea
49288>>>>>        End
49288>>>>>>
49288>>>>>    End_Procedure
49289>>>>>    
49289>>>>>End_Class
49290>>>>>    
49290>>>>>Class cCJPriorViewMenu is a cCJDeoNavigateMenuItem
49291>>>>>
49291>>>>>    Procedure Construct_Object
49293>>>>>        Forward Send Construct_Object
49295>>>>>        Set psCaption to C_$CaptionPriorView
49296>>>>>        Set psDescription to C_$DescPriorView
49297>>>>>        Set psToolTip to C_$ToolTipPriorView
49298>>>>>        Set psShortcut to C_$Key_Ctrl_F6
49299>>>>>        Set psImage to "ActionPrevView.ico"
49300>>>>>    End_Procedure
49301>>>>>        
49301>>>>>    Procedure OnExecute Variant vCommandBarControl
49303>>>>>        Handle hoCommandBars hoClientArea
49303>>>>>        Get CommandBarSystemObject to hoCommandBars
49304>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
49305>>>>>        If hoClientArea Begin
49307>>>>>            Send Switch_Prior_View of hoClientArea
49308>>>>>        End
49308>>>>>>
49308>>>>>    End_Procedure
49309>>>>>        
49309>>>>>End_Class
49310>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\cCJMDIWindowsMenuItem.pkg)
49310>>>>>Use cCJCommandBarSystem.pkg
49310>>>>>
49310>>>>>Register_Function Client_ID Returns Integer
49310>>>>>
49310>>>>>// only used by cCJMDIWIndowsMenuItem
49310>>>>>Class cCJMDIWindowItem is a cCJMenuItem
49311>>>>>
49311>>>>>    Procedure Construct_Object
49313>>>>>        Forward Send Construct_Object
49315>>>>>        Property Handle phWindow 0 // object id of view
49316>>>>>        Set pbControlFlagNoMovable to True
49317>>>>>        Set pbActiveUpdate to True
49318>>>>>    End_Procedure
49319>>>>>    
49319>>>>>    Procedure OnExecute Variant vCommandBarControl
49321>>>>>        Handle hWindow
49321>>>>>        Get phWindow to hWindow
49322>>>>>        Send Activate_View of hWindow
49323>>>>>    End_Procedure
49324>>>>>    
49324>>>>>End_Class                
49325>>>>>
49325>>>>>
49325>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
49326>>>>>    
49326>>>>>    Procedure Construct_Object
49328>>>>>        Forward Send Construct_Object
49330>>>>>        Property Handle[] phArrayOfWindows
49331>>>>>        Set peControlType to xtpControlPopup
49332>>>>>        Set psCategory to C_$CategoryWindow
49333>>>>>    End_Procedure
49334>>>>>    
49334>>>>>     // This adds MDI windows to the existing menu items.
49334>>>>>     // This removes any existing windows menus and always adds a new set to the end
49334>>>>>
49334>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
49336>>>>>        Handle  hClientArea hView
49336>>>>>        String  sLabel
49336>>>>>        Integer i iWindows
49336>>>>>        Handle[] hArrayOfWindows
49337>>>>>        Variant vItem
49337>>>>>        
49337>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
49337>>>>>        // also assume that destroying an action removes all menu instances of that action
49337>>>>>        Get phArrayOfWindows to hArrayOfWindows
49338>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
49339>>>>>        For i from 0 to (iWindows-1)
49345>>>>>>
49345>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
49346>>>>>        Loop
49347>>>>>>
49347>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
49348>>>>>
49348>>>>>        // Add all views to this menu. Create the action and add the item
49348>>>>>        Move 0 to i
49349>>>>>        Get Client_Id to hClientArea // object id of client area
49350>>>>>        If (hClientArea > 0) Begin
49352>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
49353>>>>>            While (hView <> 0)
49357>>>>>                If (Active_State(hView)) Begin
49359>>>>>                    // create the action
49359>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
49360>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
49361>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
49362>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
49363>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
49365>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
49366>>>>>                    End
49366>>>>>>
49366>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
49367>>>>>                    If (i=0) Begin
49369>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
49370>>>>>                    End
49370>>>>>>
49370>>>>>                    // Create a menu item for this action
49370>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
49371>>>>>                    Increment i
49372>>>>>                End
49372>>>>>>
49372>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
49373>>>>>            Loop
49374>>>>>>
49374>>>>>        End
49374>>>>>>
49374>>>>>
49374>>>>>        Set phArrayOfWindows to hArrayOfWindows
49375>>>>>
49375>>>>>     End_Procedure
49376>>>>>     
49376>>>>>End_Class
49377>>>>>
49377>
49377>Object oHtmlHelp is a cHtmlHelp
49379>End_Object
49380>
49380>Global_Variable String  gvsSapHmnia
49380>Global_Variable String  gvsSapPath
49380>Global_Variable Integer gviSkipHmniaCheck
49380>
49380>Object oApplication is a cApplication
49382>    Set peHelpType to htHtmlHelp
49383>
49383>    Procedure OnCreate
49386>        Handle hoCmdLine
49386>        Integer iNumArgs iArg
49386>
49386>        Get phoCommandLine              to hoCmdLine
49387>        
49387>        Get CountOfArgs of hoCmdLine to iNumArgs
49388>        
49388>        If (iNumArgs>0) Begin
49390>            Move                 (Argument(hoCmdLine, 1))   to gvsSapHmnia
49391>            Move                 (Argument(hoCmdLine, 2))   to gvsSapPath
49392>            If (iNumArgs>2) Move (Argument(hoCmdLine, 3))   to gviSkipHmniaCheck
49395>        End
49395>        
49395>    End_Procedure
49396>
49396>End_Object
49397>
49397>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\oEditContextMenu.pkg)
49397>>>Use cCJStandardMenuItemClasses.pkg
49397>>>
49397>>>Object oEditContextMenu is a cCJContextMenu
49399>>>    
49399>>>    Move Self to Default_Form_Floating_Menu_ID
49400>>>    
49400>>>    Object oUndoMenuItem is a cCJUndoMenuItem
49402>>>    End_Object
49403>>>    
49403>>>    Object oCutMenuItem is a cCJCutMenuItem
49405>>>        Set pbControlBeginGroup to True
49406>>>    End_Object
49407>>>    
49407>>>    Object oCopyMenuItem is a cCJCopyMenuItem
49409>>>    End_Object
49410>>>
49410>>>    Object oPasteMenuItem is a cCJPasteMenuItem
49412>>>    End_Object
49413>>>
49413>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
49415>>>    End_Object
49416>>>
49416>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
49418>>>        Set pbControlBeginGroup to True
49419>>>    End_Object
49420>>>
49420>>>End_Object
49421>>>
49421>Use oDEOEditContextMenu.pkg
Including file: oDEOEditContextMenu.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\oDEOEditContextMenu.pkg)
49421>>>Use Windows.pkg
49421>>>Use cCJStandardMenuItemClasses.pkg
49421>>>Use cCJDeoMenuItemClasses.pkg
49421>>>
49421>>>
49421>>>Object oDEOEditContextMenu is a cCJContextMenu
49423>>>    
49423>>>    Move Self to Default_dbFloating_Menu_ID
49424>>>    
49424>>>    Object oUndoMenuItem is a cCJUndoMenuItem
49426>>>    End_Object
49427>>>    
49427>>>    Object oCutMenuItem is a cCJCutMenuItem
49429>>>        Set pbControlBeginGroup to True
49430>>>    End_Object
49431>>>    
49431>>>    Object oCopyMenuItem is a cCJCopyMenuItem
49433>>>    End_Object
49434>>>
49434>>>    Object oPasteMenuItem is a cCJPasteMenuItem
49436>>>    End_Object
49437>>>
49437>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
49439>>>    End_Object
49440>>>
49440>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
49442>>>        Set pbControlBeginGroup to True
49443>>>    End_Object
49444>>>
49444>>>    Object oPromptMenuItem is a cCJPromptMenuItem
49446>>>        Set pbControlBeginGroup to True
49447>>>    End_Object
49448>>>
49448>>>    Object oFindNextMenu is a cCJFindNextMenuItem
49450>>>        Set pbControlBeginGroup to True
49451>>>    End_Object
49452>>>
49452>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
49454>>>    End_Object
49455>>>
49455>>>    Object oClearMenuItem is a cCJClearMenuItem
49457>>>        Set pbControlBeginGroup to True
49458>>>    End_Object
49459>>>
49459>>>    Object oClearAllMenu is a cCJClearAllMenuItem
49461>>>    End_Object
49462>>>
49462>>>    Object oSaveMenu is a cCJSaveMenuItem
49464>>>    End_Object
49465>>>    
49465>>>    Object oSaveNCMenu is a cCJSaveNCMenuItem
49467>>>    End_Object
49468>>>    Object oDeleteMenu is a cCJDeleteMenuItem
49470>>>    End_Object
49471>>>
49471>>>
49471>>>End_Object
49472>
49472>
49472>Open Users
ERROR: 4313 Include file not found USERS.FD ON LINE: 36 (49473) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 52 Bad format of expression (operator)  ON LINE: 36 (49473) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
49474>
49474>//
49474>Use PasswVerif.pkg
ERROR: 4313 Include file not found PASSWVERIF.PKG ON LINE: 39 (49474) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
49474>Use PASSDLG2.DG
Including file: PASSDLG2.DG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG)
49474>>>//AB/ Project Password Dialog
49474>>>//AB/     Object prj is a Dialog_Project
49474>>>//AB/         Set ProjectName to "Password Dialog"
49474>>>//AB/         Set ProjectFileName to "Passdlg2.dg"
49474>>>
49474>>>    //AB-IgnoreStart
49474>>>
49474>>>    USE AllEntSC
Including file: AllentSC.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\AllentSC.PKG)
49474>>>>>Integer giCommon_IntegerProg_Status
49474>>>>>Integer giCommon_IntegerN01
49474>>>>>Integer giCommon_IntegerN02
49474>>>>>Integer giCommon_IntegerN03
49474>>>>>Integer giCommon_IntegerN04
49474>>>>>Integer giCommon_IntegerN05
49474>>>>>Integer giCommon_IntegerN06
49474>>>>>Integer giCommon_IntegerN07
49474>>>>>Integer giCommon_IntegerN08
49474>>>>>Integer giCommon_IntegerN09
49474>>>>>Integer giCommon_IntegerN010
49474>>>>>
49474>>>>>//If giCommon_IntegerProg_Status
49474>>>>>
49474>>>>>USE DFALLENT
49474>>>>>
49474>>>>>USE WINUSREZ.PKG
Including file: WINUSREZ.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\WINUSREZ.PKG)
49474>>>>>>>// API Calls (Commands and Functions)
49474>>>>>>>// Author - SPY 10/11/98
49474>>>>>>>// Extension of VDF's WinUser.pkg
49474>>>>>>>// Created as a need to change the SystemMenu
49474>>>>>>>// This package will be changed (expand or shrink) according to our needs and VDF's changes
49474>>>>>>>
49474>>>>>>>Use DFTypes.pkg     // DataFlex Types (structures)
49474>>>>>>>Use Winuser.pkg
49474>>>>>>>
49474>>>>>>>// max_path is originally ci260, but we support a slightly smaller stringlength
49474>>>>>>>Define Max_Path               For |CI260
49474>>>>>>>
49474>>>>>>>// The defines below can be used to find out what kind of error has occured if
49474>>>>>>>// the API-call ShellExecute is used.
49474>>>>>>>Define ERROR_FILE_NOT_FOUND   For |CI0002
49474>>>>>>>Define ERROR_PATH_NOT_FOUND   For |CI0003
49474>>>>>>>Define ERROR_BAD_FORMAT       For |CI0011
49474>>>>>>>Define SE_ERR_ACCESSDENIED    For |CI0005
49474>>>>>>>Define SE_ERR_ASSOCINCOMPLETE For |CI0027
49474>>>>>>>Define SE_ERR_DDEBUSY         For |CI0030
49474>>>>>>>Define SE_ERR_DDEFAIL         For |CI0029
49474>>>>>>>Define SE_ERR_DDETIMEOUT      For |CI0028
49474>>>>>>>Define SE_ERR_DLLNOTFOUND     For |CI0032
49474>>>>>>>Define SE_ERR_FNF             For |CI0002
49474>>>>>>>Define SE_ERR_NOASSOC         For |CI0031
49474>>>>>>>Define SE_ERR_OOM             For |CI0008
49474>>>>>>>Define SE_ERR_PNF             For |CI0003
49474>>>>>>>Define SE_ERR_SHARE           For |CI0026
49474>>>>>>>
49474>>>>>>>Procedure DDE_Error_Handler Integer iErrorID
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49476>>>>>>>  String sMessage
49476>>>>>>>  //Move "An error occurred during a DDE transaction.\n\n" To sMessage
49476>>>>>>>  Case Begin
49476>>>>>>>    Case (iErrorID = ERROR_FILE_NOT_FOUND)
49478>>>>>>>      Append sMessage "The specified file was not found.\n"
49479>>>>>>>      Case Break
49480>>>>>>>    Case (iErrorID = ERROR_PATH_NOT_FOUND)
49483>>>>>>>      Append sMessage "The specified path was not found.\n"
49484>>>>>>>      Case Break
49485>>>>>>>    Case (iErrorID = ERROR_BAD_FORMAT)
49488>>>>>>>      Append sMessage "The .EXE file is invalid.\n"
49489>>>>>>>      Case Break
49490>>>>>>>    Case (iErrorID = SE_ERR_ACCESSDENIED)
49493>>>>>>>      Append sMessage "The operating system denied access to the specified file.\n"
49494>>>>>>>      Case Break
49495>>>>>>>    Case (iErrorID = SE_ERR_ASSOCINCOMPLETE)
49498>>>>>>>      Append sMessage "The filename association is incomplete or invalid.\n"
49499>>>>>>>      Case Break
49500>>>>>>>    Case (iErrorID = SE_ERR_DDEBUSY)
49503>>>>>>>      Append sMessage "The DDE transaction could not be completed because other DDE\n"
49504>>>>>>>      Append sMessage "transactions were being processed.\n"
49505>>>>>>>      Case Break
49506>>>>>>>    Case (iErrorID = SE_ERR_DDEFAIL)
49509>>>>>>>      Append sMessage "The DDE transaction failed.\n"
49510>>>>>>>      Case Break
49511>>>>>>>    Case (iErrorID = SE_ERR_DDETIMEOUT)
49514>>>>>>>      Append sMessage "The DDE transaction could not be completed,\n"
49515>>>>>>>      Append sMessage "because the request timed out.\n"
49516>>>>>>>      Case Break
49517>>>>>>>    Case (iErrorID = SE_ERR_DLLNOTFOUND)
49520>>>>>>>      Append sMessage "The specified dynamic-link library was not found.\n"
49521>>>>>>>      Case Break
49522>>>>>>>    Case (iErrorID = SE_ERR_NOASSOC)
49525>>>>>>>      Append sMessage "There is no application associated with the given filename extension.\n"
49526>>>>>>>      Case Break
49527>>>>>>>    Case ((iErrorID = SE_ERR_OOM) Or (iErrorID = 0))
49530>>>>>>>      Append sMessage "There is not enough free memory available to complete the operation.\n"
49531>>>>>>>      Case Break
49532>>>>>>>    Case (iErrorID = SE_ERR_PNF)
49535>>>>>>>      Append sMessage "The specified path was not found.\n"
49536>>>>>>>      Case Break
49537>>>>>>>    Case (iErrorID = SE_ERR_SHARE)
49540>>>>>>>      Append sMessage "A sharing violation occurred.\n"
49541>>>>>>>      Case Break
49542>>>>>>>    Case Else
49542>>>>>>>      Append sMessage "Unknown DDE-error occurred.\n"
49543>>>>>>>      Append sMessage ("Errornumber"*Trim(iErrorID)*".\n")
49544>>>>>>>      Case Break
49545>>>>>>>  Case End
49545>>>>>>>  Append sMessage "\nPress OK to continue...\n\n"
49546>>>>>>>  Send Stop_Box sMessage "DDE-error occured"
49547>>>>>>>End_Procedure // DDE_Error_Handler hInstance
49548>>>>>>>
49548>>>>>>>// System Menu Command Values
49548>>>>>>>
49548>>>>>>>// Obsolete names
49548>>>>>>>
49548>>>>>>>
49548>>>>>>>
49548>>>>>>>
49548>>>>>>>
49548>>>>>>>
49548>>>>>>>// Date Flags for GetDateFormatW.
49548>>>>>>>//#replace DATE_SHORTDATE            |CI1        //  use short date picture
49548>>>>>>>//#replace DATE_LONGDATE             |CI2        //  use long date picture
49548>>>>>>>
49548>>>>>>>
49548>>>>>>>//Type tSystemTime
49548>>>>>>>//    Field tSystemTime.wYear As Integer
49548>>>>>>>//    Field tSystemTime.wMonth As Integer
49548>>>>>>>//    Field tSystemTime.wDayOfWeek As Integer
49548>>>>>>>//    Field tSystemTime.wDay As Integer
49548>>>>>>>//    Field tSystemTime.wHour As Integer
49548>>>>>>>//    Field tSystemTime.wMinute As Integer
49548>>>>>>>//    Field tSystemTime.wSecond As Integer
49548>>>>>>>//    Field tSystemTime.wMilliseconds As Integer
49548>>>>>>>//End_Type  // tSystemTime
49548>>>>>>>
49548>>>>>>>// Locale Dependent APIs
49548>>>>>>>// The Date Format
49548>>>>>>>//External Function GetDateFormat  "GetDateFormatA"  Kernel32.dll ;
49548>>>>>>>//        Integer Locale Integer dwFlags Pointer lpDate String lpFormat String lpDateStr Integer cchDate Returns Integer
49548>>>>>>>                                         //   as tSystemTime
49548>>>>>>>
49548>>>>>>>// Menu Functions
49548>>>>>>>// API call to return the menu handle
49548>>>>>>>External_Function GetSystemMenu "GetSystemMenu" User32.dll ;        Handle hWnd Integer bRevert Returns Handle
49549>>>>>>>
49549>>>>>>>// API call to return the menu Items Count
49549>>>>>>>External_Function GetMenuItemCount "GetMenuItemCount" User32.dll ;        Handle hWnd Returns Integer
49550>>>>>>>
49550>>>>>>>// API call to modify the menu items by position or by command
49550>>>>>>>External_Function ModifyMenu "ModifyMenuA" User32.dll ;        Handle hWnd Integer nPosition Integer wFlags Integer wIDNewItem String lpString Returns Integer
49551>>>>>>>
49551>>>>>>>// API call to get the value of a menu item
49551>>>>>>>External_Function GetMenuString "GetMenuStringA" User32.dll ;        Handle hWnd Integer wIDItem String lpString Integer nMaxCount Integer wFlags Returns Integer
49552>>>>>>>
49552>>>>>>>External_Function SetMenuItemInfo "SetMenuItemInfoA" User32.dll ;        Handle hWnd Integer un Integer bypos Integer lpMenuItemInfo Returns Integer
49553>>>>>>>
49553>>>>>>>External_Function GetMenuItemInfo "GetMenuItemInfoA" User32.dll ;        Handle hWnd Integer un Integer bypos Integer lpMenuItemInfo Returns Integer
49554>>>>>>>
49554>>>>>>>External_Function SetMenuItemBitmaps "SetMenuItemBitmaps" User32.dll ;        Handle hMenu Integer nPosition Integer wFlags Integer hBitmapUnchecked Integer hBitmapChecked Returns Integer
49555>>>>>>>
49555>>>>>>>// API call to delete the Items of a menu
49555>>>>>>>External_Function DeleteMenu "DeleteMenu" User32.dll ;        Handle hMenu Integer nPosition Integer wFlags Returns Integer
49556>>>>>>>
49556>>>>>>>// API call to return the active window associcated with the calling thread (ie DFRUN)
49556>>>>>>>External_Function GetActiveWindow "GetActiveWindow" user32.dll Returns Integer
49557>>>>>>>
49557>>>>>>>// change the window title so we can find the window
49557>>>>>>>External_Function SetConsoleTitle "SetConsoleTitleA" Kernel32.dll ;    String lpszTitle Returns Integer
49558>>>>>>>
49558>>>>>>>// Extracts an icon from a .DLL .EXE of .ICO
49558>>>>>>>External_Function ExtractIcon "ExtractIconA" Shell32.dll ;        Handle hInst ;        String lpIconName ;        Integer nIconIndex ;        Returns Handle
49559>>>>>>>
49559>>>>>>>//Procedure SetWindowsTitle Global String TheTitle
49559>>>>>>>//    Local Pointer Titlepointer
49559>>>>>>>//    Getaddress Of TheTitle To Titlepointer
49559>>>>>>>//    Move (Setconsoletitle(Titlepointer)) To Strmark
49559>>>>>>>//End_Procedure
49559>>>>>>>
49559>>>>>>>//Procedure SetWindowsIcon Global String TheIcon
49559>>>>>>>//    // Known problem!
49559>>>>>>>//    // The function "FINDWINDOW" finds any window with a titlebar with contents of s.1
49559>>>>>>>//    // when run multiple times this procedure could change the icon of an other task
49559>>>>>>>//    // the solution is to
49559>>>>>>>//    // 1. set the title to some temporary value,
49559>>>>>>>//    // 2. find the temporary value
49559>>>>>>>//    // 3. change the icon
49559>>>>>>>//    // 4. restore the old value of the title
49559>>>>>>>
49559>>>>>>>//    Local Handle TemHandle
49559>>>>>>>//    Move (FindWindow ("ConsoleWindowClass" ,s.1 )) to TemHandle     // Windows NT code!
49559>>>>>>>//    If TemHandle eq 0 Move (FindWindow ("tty" ,s.1 )) to TemHandle  // Windows '95/'98 code!
49559>>>>>>>//    Move (SendMessage(TemHandle, WM_SETICON, 0, ExtractIcon(0, TheIcon, 0))) to strmark
49559>>>>>>>//End_Procedure
49559>>>>>>>
49559>>>>>>>Define MAX_COMPUTERNAME_LENGTH For 15
49559>>>>>>>
49559>>>>>>>External_Function32 GetComputerName "GetComputerNameA" Kernel32.Dll ;    Pointer lpComputerName Dword nNameSize Returns Integer
49560>>>>>>>
49560>>>>>>>// LPTSTR  lpComputerName address of name buffer
49560>>>>>>>// LPDWORD nNameSize      address of size of name buffer
49560>>>>>>>
49560>>>>>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
49561>>>>>>>
49561>>>>>>>// Used for printscreen
49561>>>>>>>//Define Byte For Integer
49561>>>>>>>
49561>>>>>>>External_Function Keybd_Event "keybd_event" User32.Dll ;    Integer bVk ;  // virtual-key code    Integer bScan ;   // hardware scan code    DWORD dwFlags ;   // flags specifying various function options    DWORD dwExtraInfo ;  // additional data associated with keystroke    Returns VOID_TYPE
49562>>>>>>>
49562>>>>>>>
49562>>>>>>>External_Function GetFreeResources "_MyGetFreeSystemResources32@4" ;    rsrc32.dll Integer nID Returns Integer
49563>>>>>>>
49563>>>>>>>
49563>>>>>>>External_Function GetEnvironmentVariable "GetEnvironmentVariableA" Kernel32.dll ;    Pointer lpVarName Pointer lpBuffer Integer nSize Returns Integer
49564>>>>>>>
49564>>>>>>>External_Function GetWindowsDirectory "GetWindowsDirectoryA" Kernel32.dll ;    Pointer lpBuffWinDir Integer nSize Returns Integer
49565>>>>>>>
49565>>>>>>>
49565>>>>>>>//Here are some replaces you can use for '%', '.' and '*'
49565>>>>>>>// Extra Keys not defined in FMAC
49565>>>>>>>
49565>>>>>>>
49565>>>>>>>// external function call used in Procedure DoStartDocument
49565>>>>>>>External_Function ShellExecute "ShellExecuteA" shell32.dll ;    Handle hWnd ;    Pointer lpOperation ;    Pointer lpFile ;    Pointer lpParameters ;    Pointer lpDirectory ;    Dword iShowCmd Returns Handle
49566>>>>>>>
49566>>>>>>>// this will perform an operation on a file (e.g. open) with the application
49566>>>>>>>// registered in the Windows Registry to open that type of file (via its extension)
49566>>>>>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
49566>>>>>>>Procedure DoShellExecute global String sOperation String sDocument String sParameters String sPath
49568>>>>>>>  Handle  hInstance hWnd
49568>>>>>>>  Pointer lpsOperation
49568>>>>>>>  Pointer lpsDocument
49568>>>>>>>  Pointer lpsParameters
49568>>>>>>>  Pointer lpsPath
49568>>>>>>>  // remove any leading/trailing spaces in the string
49568>>>>>>>  Move (Trim(sDocument)) To sDocument
49569>>>>>>>  Move (Trim(sPath))     To sPath
49570>>>>>>>  // Make the strings readable for windows API, by converting them to null-terminated
49570>>>>>>>  Append sOperation   (Character(0))
49571>>>>>>>  Append sDocument    (Character(0))
49572>>>>>>>  Append sParameters  (Character(0))
49573>>>>>>>  Append sPath        (Character(0))
49574>>>>>>>  // Connect the corresponding pointers to the strings
49574>>>>>>>  GetAddress Of sOperation  To lpsOperation
49575>>>>>>>  GetAddress Of sDocument   To lpsDocument
49576>>>>>>>  GetAddress Of sParameters To lpsParameters
49577>>>>>>>  GetAddress Of sPath       To lpsPath
49578>>>>>>>
49578>>>>>>>  Get Window_Handle To hWnd
49579>>>>>>>  Move (ShellExecute (hWnd, lpsOperation, lpsDocument, lpsParameters, lpsPath, 1)) To hInstance
49580>>>>>>>  If (hInstance <= 32) Begin
49582>>>>>>>    Send DDE_Error_Handler hInstance
49583>>>>>>>  End
49583>>>>>>>>
49583>>>>>>>End_Procedure // DoShellExecute
49584>>>>>>>
49584>>>>>>>// this will perform an operation on a file (e.g. open) with the application
49584>>>>>>>// registered in the Windows Registry to open that type of file (via its extension)
49584>>>>>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
49584>>>>>>>Procedure DoStartDocument GLOBAL String sOperation String sDocument
49586>>>>>>>    Send DoShellExecute sOperation (Trim (sDocument)) '' ''
49587>>>>>>>End_Procedure // DoStartDocument
49588>>>>>>>
49588>>>>>>>// returns default browser from Windows Registry
49588>>>>>>>Function DefaultBrowser Returns String
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49590>>>>>>>    String sBrowser sRegPath
49590>>>>>>>
49590>>>>>>>    Move "Classes\http\shell\open\command" To sRegPath
49591>>>>>>>    Get_Foreign_Profile_String sRegPath "" "" To sBrowser
49595>>>>>>>    Move (Replaces('"', sBrowser, "")) To sBrowser
49596>>>>>>>    Function_Return sBrowser
49597>>>>>>>End_Function // DefaultBrowser
49598>>>>>>>
49598>>>>>>>External_Function LoadCursorFromFile  "LoadCursorFromFileA" User32.DLL ;     Pointer lpFileName Returns Integer
49599>>>>>>>
49599>>>>>>>External_Function GetCursor "GetCursor" User32.dll ;    Returns Integer
49600>>>>>>>
49600>>>>>>>
49600>>>>>>>Procedure ShowTaskBar
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49602>>>>>>>    Integer iVal
49602>>>>>>>    Handle hWnd
49602>>>>>>>    Move (FindWindow("Shell_traywnd", "")) To hWnd
49603>>>>>>>    Move (SetWindowPos(hWnd, 0, 0, 0, 0, 0, SWP_SHOWWINDOW)) To iVal
49604>>>>>>>End_Procedure // ShowTaskBar
49605>>>>>>>
49605>>>>>>>
49605>>>>>>>Procedure HideTaskBar
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49607>>>>>>>    Integer iVal
49607>>>>>>>    Handle hWnd
49607>>>>>>>    Move (FindWindow("Shell_traywnd", "")) To hWnd
49608>>>>>>>    Move (SetWindowPos(hWnd, 0, 0, 0, 0, 0, SWP_HIDEWINDOW)) To iVal
49609>>>>>>>End_Procedure // HideTaskBar
49610>>>>>>>
49610>>>>>>>Function DFKeyState Global Dword vKey Returns Integer
49612>>>>>>>    Integer rVal
49612>>>>>>>
49612>>>>>>>    Move (GetKeyState(vKey)) To rVal
49613>>>>>>>    // 1 vKey pressed 0 vKey is up
49613>>>>>>>    Move (Hi(rval)) To rVal
49614>>>>>>>    If (rVal) Move (65536-rVal) To rVal
49617>>>>>>>    Function_Return rVal
49618>>>>>>>End_Function // DFKeyState
49619>>>>>>>
49619>>>>>
49619>>>>>//  6
49619>>>>>//USE DFPRGRES.PKG  // Progressbar
49619>>>>>//USE TRCKBR.PKG    // Trackbar
49619>>>>>//USE DBTRCKBR.PKG  // dbTrackbar
49619>>>>>
49619>>>>>//DEFINE ME FOR CURRENT_OBJECT
49619>>>>>
49619>>>>>USE GENERAL.PKG
Including file: General.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\General.pkg)
49619>>>>>>>Use Winuser.pkg
49619>>>>>>>Use WinUsrez.pkg
49619>>>>>>>Use Dfdeoft.pkg
49619>>>>>>>
49619>>>>>>>//Open messages
49619>>>>>>>
49619>>>>>>>// Function Xlate Global String Item_Name## Returns String
49619>>>>>>>//    Local String S_Return_Val##
49619>>>>>>>//    //If sysfile.enable_xlate eq 1 Begin
49619>>>>>>>//        Clear Messages
49619>>>>>>>//        Move Item_Name## To Messages.Greek
49619>>>>>>>//        Find Eq Messages By Index.1 //Greek
49619>>>>>>>//        If (Not(Found)) Begin
49619>>>>>>>//            Saverecord Messages
49619>>>>>>>//            Unlock
49619>>>>>>>//        End
49619>>>>>>>
49619>>>>>>>//        If Messages.Local Ne ""         Move (Trim(Messages.Local))     To S_Return_Val##
49619>>>>>>>//        Else Begin
49619>>>>>>>//            If Messages.English Ne ""   Move (Trim(Messages.English))   To S_Return_Val##
49619>>>>>>>//            Else                        Move Item_Name##                To S_Return_Val##
49619>>>>>>>//        End
49619>>>>>>>//    //End
49619>>>>>>>//    //Else                                Move Item_Name##        to S_Return_Val##
49619>>>>>>>//    Function_Return S_Return_Val## Item_Name##
49619>>>>>>>//    Function_Return Item_Name##
49619>>>>>>>//End_Function //Xlate
49619>>>>>>>
49619>>>>>>>
49619>>>>>>>//Procedure Info_BoxT GLOBAL String sMessage String sTitle
49619>>>>>>>//    Forward Send Info_Box (Xlate(sMessage)) (Xlate(sTitle))
49619>>>>>>>//End_Procedure
49619>>>>>>>
49619>>>>>>>////Doc/ Interface=Public
49619>>>>>>>//Procedure Stop_BoxT GLOBAL String sMessage String sTitle
49619>>>>>>>//    Forward Send Stop_Box (Xlate(sMessage)) (Xlate(sTitle))
49619>>>>>>>//End_Procedure
49619>>>>>>>
49619>>>>>>>////Doc/ Interface=Public
49619>>>>>>>//Function YesNo_BoxT GLOBAL String sMessage String sTitle Integer DfltBtn ;
49619>>>>>>>//                           Returns Integer
49619>>>>>>>//    Integer rval
49619>>>>>>>//    Move (YesNo_Box( (Xlate(sMessage)), (Xlate(sTitle)), DfltBtn)) to rVal
49619>>>>>>>//    Function_Return rval
49619>>>>>>>//End_Function
49619>>>>>>>
49619>>>>>>>Procedure DoCustomizeDefaultFloatMenu Integer aiObj_id
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49621>>>>>>>     Set Value of aiObj_id Item 0 to ""
49622>>>>>>>     Set Value of aiObj_id Item 2 to ""
49623>>>>>>>     Set Value of aiObj_id Item 3 to ""
49624>>>>>>>     Set Value of aiObj_id Item 4 to ""
49625>>>>>>>     Set Value of aiObj_id Item 5 to ""
49626>>>>>>>     Set Value of aiObj_id Item 7 to " "
49627>>>>>>>End_Procedure
49628>>>>>>>
49628>>>>>>>Procedure DoCustomizeDefaultdbFloatMenu Integer aiObj_id
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49630>>>>>>>      Integer liFirstItem
49630>>>>>>>      Set Value of aiObj_id Item 0 to "&"
49631>>>>>>>      Set Value of aiObj_id Item 1 to "&"
49632>>>>>>>      Set Value of aiObj_id Item 2 to "&"
49633>>>>>>>      Set Value of aiObj_id Item 3 to " &"
49634>>>>>>>      Set Value of aiObj_id Item 4 to "&"
49635>>>>>>>      Set Value of aiObj_id Item 5 to "&"
49636>>>>>>>      Set Value of aiObj_id Item 6 to "& "
49637>>>>>>>End_Procedure
49638>>>>>>>
49638>>>>>>>Procedure GreekSysMenu
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
49640>>>>>>>   Local Integer hWnd hSmId iItems bState
49640>>>>>>>   Get Window_Handle to hWnd
49641>>>>>>>   If hWnd ne 0 Begin
49643>>>>>>>        Move (GetSystemMenu(hWnd,False)) to hSmId
49644>>>>>>>        Move (GetMenuItemCount(hSmId)) to iItems
49645>>>>>>>
49645>>>>>>>        Move (ModifyMenu(hSmId,SC_RESTORE,MF_BYCOMMAND + MF_STRING,SC_RESTORE,      ("    "+(ToAnsi("&")))))               to bState
49646>>>>>>>        Move (ModifyMenu(hSmId,SC_MOVE,MF_BYCOMMAND + MF_STRING,SC_MOVE,            ("    "+(ToAnsi("&")))))              to bState
49647>>>>>>>        Move (ModifyMenu(hSmId,SC_SIZE,MF_BYCOMMAND + MF_STRING,SC_SIZE,            ("    "+(ToAnsi("&")))))                 to bState
49648>>>>>>>        Move (ModifyMenu(hSmId,SC_MINIMIZE,MF_BYCOMMAND + MF_STRING,SC_MINIMIZE,    ("    "+(ToAnsi("&")))))          to bState
49649>>>>>>>        Move (ModifyMenu(hSmId,SC_MAXIMIZE,MF_BYCOMMAND + MF_STRING,SC_MAXIMIZE,    ("    "+(ToAnsi("&")))))           to bState
49650>>>>>>>        Move (ModifyMenu(hSmId,SC_CLOSE,MF_BYCOMMAND + MF_STRING,SC_CLOSE,          ("    "+(ToAnsi("&     Alt+F4")))))       to bState
49651>>>>>>>        Move (ModifyMenu(hSmId,SC_NEXTWINDOW,MF_BYCOMMAND + MF_STRING,SC_NEXTWINDOW,("    "+(ToAnsi("&       Ctrl+F6")))))   to bState
49652>>>>>>>
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_RESTORE,MF_BYCOMMAND      + MF_STRING,SC_RESTORE      ,("    "+(ToAnsi"&")))))       to bState
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_MOVE,MF_BYCOMMAND         + MF_STRING,SC_MOVE         ,("    "+(ToAnsi"&")))))      to bState
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_SIZE,MF_BYCOMMAND         + MF_STRING,SC_SIZE         ,("    "+(ToAnsi"&")))))         to bState
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_MINIMIZE,MF_BYCOMMAND     + MF_STRING,SC_MINIMIZE     ,("    "+(ToAnsi"&")))))  to bState
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_MAXIMIZE,MF_BYCOMMAND     + MF_STRING,SC_MAXIMIZE     ,("    "+(ToAnsi"&")))))   to bState
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_CLOSE,MF_BYCOMMAND        + MF_STRING,SC_CLOSE        ,("    "+(ToAnsi"&  Alt+F4")))))  to bState
49652>>>>>>>//        Move (ModifyMenu(hSmId,SC_NEXTWINDOW,MF_BYCOMMAND   + MF_STRING,SC_NEXTWINDOW   ,("    "+(ToAnsi"& Ctrl+F6"))))) to bState
49652>>>>>>>   End
49652>>>>>>>>
49652>>>>>>>End_Procedure
49653>>>>>>>
49653>>>>>>>//****************************************************************************
49653>>>>>>>// $Module type: FUNCTION
49653>>>>>>>// $Module name: Computername
49653>>>>>>>// $Author     : SPY
49653>>>>>>>// Created     : 03-01-99 @ 9:53
49653>>>>>>>//
49653>>>>>>>// Description
49653>>>>>>>//
49653>>>>>>>// $Rev History
49653>>>>>>>//****************************************************************************
49653>>>>>>>Function Computername Global Returns String
49655>>>>>>>   Local Pointer lpComputerName lpNameSize
49655>>>>>>>   Local String sComputerName sNameSize
49655>>>>>>>   Local Integer iRetval
49655>>>>>>>
49655>>>>>>>   Movestr (Repeat (Character (0), MAX_COMPUTERNAME_LENGTH + 1)) To sComputerName
49656>>>>>>>>
49656>>>>>>>   GetAddress Of sComputerName To lpComputerName
49657>>>>>>>   Movestr (DwordToBytes (MAX_COMPUTERNAME_LENGTH + 1)) To sNameSize
49658>>>>>>>>
49658>>>>>>>   GetAddress Of sNameSize To lpNameSize
49659>>>>>>>
49659>>>>>>>   Moveint (GetComputerName (lpComputerName, lpNameSize)) To iRetval
49660>>>>>>>>
49660>>>>>>>
49660>>>>>>>   Function_Return (CString (sComputerName))
49661>>>>>>>End_Function // ComputerName
49662>>>>>>>
49662>>>>>>>
49662>>>>>>>//****************************************************************************
49662>>>>>>>// $Module type: FUNCTION
49662>>>>>>>// $Module name: DateToWeekDay
49662>>>>>>>// $Author     : SPY
49662>>>>>>>// Created     : 03-01-99 @ 9:53
49662>>>>>>>//
49662>>>>>>>// Description
49662>>>>>>>//
49662>>>>>>>// $Rev History
49662>>>>>>>//****************************************************************************
49662>>>>>>>
49662>>>>>>>Function DateToWeekDay Global date dDate returns Integer
49664>>>>>>>    local string sWeekday
49664>>>>>>>    local integer iDay
49664>>>>>>>
49664>>>>>>>    // convert to 4 digits if needed
49664>>>>>>>    //
49664>>>>>>>    //if dDate le 36524 calc (dDate+693975) to dDate
49664>>>>>>>
49664>>>>>>>    // 0   1   ... 6  
49664>>>>>>>    move ((mod((dDate-2),7))) to iDay
49665>>>>>>>
49665>>>>>>>    function_return iDay
49666>>>>>>>End_Function  // DateToWeekDay
49667>>>>>>>
49667>>>>>>>
49667>>>>>>>//****************************************************************************
49667>>>>>>>// $Module type: FUNCTION
49667>>>>>>>// $Module name: DateToWeekDayName
49667>>>>>>>// $Author     : SPY
49667>>>>>>>// Created     : 03-01-99 @ 9:53
49667>>>>>>>//
49667>>>>>>>// Description
49667>>>>>>>//
49667>>>>>>>// $Rev History
49667>>>>>>>//****************************************************************************
49667>>>>>>>
49667>>>>>>>Function DateToWeekDayName Global date dDate returns String
49669>>>>>>>    local string sWeekday
49669>>>>>>>    local integer iDay
49669>>>>>>>
49669>>>>>>>    // convert to 4 digits if needed
49669>>>>>>>    //
49669>>>>>>>    //if dDate le 36524 calc (dDate+693975) to dDate
49669>>>>>>>
49669>>>>>>>    move (DateToWeekDay(dDate)) to iDay
49670>>>>>>>
49670>>>>>>>    if iDay eq 0 move ""         to sWeekday
49673>>>>>>>    else if iDay eq 1 move ""    to sWeekday
49677>>>>>>>    else if iDay eq 2 move ""      to sWeekday
49681>>>>>>>    else if iDay eq 3 move ""    to sWeekday
49685>>>>>>>    else if iDay eq 4 move ""     to sWeekday
49689>>>>>>>    else if iDay eq 5 move ""  to sWeekday
49693>>>>>>>    else if iDay eq 6 move ""    to sWeekday
49697>>>>>>>
49697>>>>>>>    function_return sWeekday
49698>>>>>>>End_Function  // DateToWeekDay
49699>>>>>>>
49699>>>>>>>
49699>>>>>>>Function DateToWeekDayNameEnglish Global Date dDate Returns String
49701>>>>>>>    Local String sWeekday
49701>>>>>>>    Local Integer iDay
49701>>>>>>>    Move (DateToWeekDay(dDate)) To iDay
49702>>>>>>>
49702>>>>>>>         If iDay eq 0 Move "Sunday"     To sWeekday
49705>>>>>>>    Else If iDay eq 1 Move "Monday"     To sWeekday
49709>>>>>>>    Else If iDay eq 2 Move "Tuesday"    To sWeekday
49713>>>>>>>    Else If iDay eq 3 Move "Wednesday"  To sWeekday
49717>>>>>>>    Else If iDay eq 4 Move "Thursday"   To sWeekday
49721>>>>>>>    Else If iDay eq 5 Move "Friday"     To sWeekday
49725>>>>>>>    Else If iDay eq 6 Move "Saturday"   To sWeekday
49729>>>>>>>
49729>>>>>>>    Function_Return sWeekday
49730>>>>>>>End_Function  // DateToWeekDay
49731>>>>>>>
49731>>>>>>>
49731>>>>>>>//****************************************************************************
49731>>>>>>>// $Module type: FUNCTION
49731>>>>>>>// $Module name: TheFirstSegment - TheSecondSegment - TheThirdSegment of Date
49731>>>>>>>// $Author     : SPY
49731>>>>>>>// Created     : 03-01-99 @ 9:53
49731>>>>>>>//
49731>>>>>>>// Description
49731>>>>>>>//
49731>>>>>>>// $Rev History
49731>>>>>>>//****************************************************************************
49731>>>>>>>
49731>>>>>>>Function TheFirstSegment Global date dDate Returns Integer
49733>>>>>>>    Local Integer rVal rPlace
49733>>>>>>>    Local String sDSep
49733>>>>>>>    Get_attribute DF_Date_Separator to rval
49736>>>>>>>    Move (Character(rVal)) to sDSep
49737>>>>>>>    Pos sDSep in dDate to rPlace
49739>>>>>>>>
49739>>>>>>>    Move (Left(dDate,(rPlace-1))) to rVal
49740>>>>>>>    Function_Return rVal
49741>>>>>>>End_Function // TheFirstSegment
49742>>>>>>>
49742>>>>>>>Function TheSecondSegment Global Date dDate Returns Integer
49744>>>>>>>    Local Integer rVal rPlace
49744>>>>>>>    Local String sDSep sDay sTempDate
49744>>>>>>>    Move dDate to sTempDate
49745>>>>>>>    Get_attribute DF_Date_Separator to rval
49748>>>>>>>    Move (Character(rVal)) to sDSep
49749>>>>>>>    Pos sDSep in sTempDate to rPlace
49751>>>>>>>>
49751>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sDay
49752>>>>>>>    Replace (sDay+sDSep) in sTempDate With ""
49754>>>>>>>    Pos sDSep in sTempDate to rPlace
49756>>>>>>>>
49756>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to rVal
49757>>>>>>>    Function_Return rVal
49758>>>>>>>End_Function // TheMonthSegment
49759>>>>>>>
49759>>>>>>>Function TheThirdSegment Global Date dDate Returns Integer
49761>>>>>>>    Local Integer rVal rPlace
49761>>>>>>>    Local String sDSep sDay sMonth sTempDate
49761>>>>>>>    Move dDate to sTempDate
49762>>>>>>>    Get_attribute DF_Date_Separator to rval
49765>>>>>>>    Move (Character(rVal)) to sDSep
49766>>>>>>>    Pos sDSep in sTempDate to rPlace
49768>>>>>>>>
49768>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sDay
49769>>>>>>>    Replace (sDay+sDSep) in sTempDate With ""
49771>>>>>>>    Pos sDSep in sTempDate to rPlace
49773>>>>>>>>
49773>>>>>>>    Move (Left(sTempDate,(rPlace-1))) to sMonth
49774>>>>>>>    Replace (sMonth+sDSep) in sTempDate With ""
49776>>>>>>>    Move sTempDate to rVal
49777>>>>>>>    Function_Return rVal
49778>>>>>>>End_Function // TheThirdSegment
49779>>>>>>>
49779>>>>>>>
49779>>>>>>>//****************************************************************************
49779>>>>>>>// $Module type: FUNCTION
49779>>>>>>>// $Module name: TheYearSegment
49779>>>>>>>// $Author     : SPY
49779>>>>>>>// Created     : 03-01-99 @ 9:53
49779>>>>>>>//
49779>>>>>>>// Description
49779>>>>>>>//
49779>>>>>>>// $Rev History
49779>>>>>>>//****************************************************************************
49779>>>>>>>
49779>>>>>>>Function TheYearSegment Global Date dDate Returns Integer
49781>>>>>>>    Local Integer rVal rPlace
49781>>>>>>>    Local String sDSep
49781>>>>>>>    Local Number lnDateFormat
49781>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
49784>>>>>>>    Get_attribute DF_Date_Separator to rval
49787>>>>>>>    If lnDateFormat eq DF_DATE_MILITARY Move (TheFirstSegment(dDate)) to rVal
49790>>>>>>>    Else Move (TheThirdSegment(dDate)) to rVal
49792>>>>>>>    Function_Return rVal
49793>>>>>>>End_Function // TheYearSegment
49794>>>>>>>
49794>>>>>>>
49794>>>>>>>//****************************************************************************
49794>>>>>>>// $Module type: FUNCTION
49794>>>>>>>// $Module name: TheDaySegment
49794>>>>>>>// $Author     : SPY
49794>>>>>>>// Created     : 03-01-99 @ 9:53
49794>>>>>>>//
49794>>>>>>>// Description
49794>>>>>>>//
49794>>>>>>>// $Rev History
49794>>>>>>>//****************************************************************************
49794>>>>>>>
49794>>>>>>>Function TheDaySegment Global date dDate Returns Integer
49796>>>>>>>    Local Integer rVal rPlace
49796>>>>>>>    Local String sDSep
49796>>>>>>>    Local Number lnDateFormat
49796>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
49799>>>>>>>    Get_attribute DF_Date_Separator to rval
49802>>>>>>>    If lnDateFormat eq DF_DATE_EUROPEAN Move (TheFirstSegment(dDate)) to rVal
49805>>>>>>>    Else If lnDateFormat eq DF_DATE_USA Move (TheSecondSegment(dDate)) to rVal
49809>>>>>>>    Else If lnDateFormat eq DF_DATE_MILITARY Move (TheThirdSegment(dDate)) to rVal
49813>>>>>>>    Function_Return rVal
49814>>>>>>>End_Function // TheDaySegment
49815>>>>>>>
49815>>>>>>>
49815>>>>>>>//****************************************************************************
49815>>>>>>>// $Module type: FUNCTION
49815>>>>>>>// $Module name: TheMonthSegment
49815>>>>>>>// $Author     : SPY
49815>>>>>>>// Created     : 03-01-99 @ 9:53
49815>>>>>>>//
49815>>>>>>>// Description
49815>>>>>>>//
49815>>>>>>>// $Rev History
49815>>>>>>>//****************************************************************************
49815>>>>>>>
49815>>>>>>>
49815>>>>>>>Function TheMonthSegment Global date dDate Returns Integer
49817>>>>>>>    Local Integer rVal rPlace
49817>>>>>>>    Local String sDSep
49817>>>>>>>    Local Number lnDateFormat
49817>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
49820>>>>>>>    Get_attribute DF_Date_Separator to rval
49823>>>>>>>    If lnDateFormat eq DF_DATE_USA Move (TheFirstSegment(dDate)) to rVal
49826>>>>>>>    Else Move (TheSecondSegment(dDate)) to rVal
49828>>>>>>>    Function_Return rVal
49829>>>>>>>End_Function // TheMonthSegment
49830>>>>>>>
49830>>>>>>>Function Sysdate4_Year Global Returns Integer
49832>>>>>>>    Date ldHmnia
49832>>>>>>>    Sysdate4 ldHmnia
49833>>>>>>>    Function_Return (TheYearSegment(ldHmnia))
49834>>>>>>>End_Function //private.etos
49835>>>>>>>
49835>>>>>>>Function Sysdate4_Month Global Returns Integer
49837>>>>>>>    Date ldHmnia
49837>>>>>>>    Sysdate4 ldHmnia
49838>>>>>>>    Function_Return (TheMonthSegment(ldHmnia))
49839>>>>>>>End_Function //private.mhnas
49840>>>>>>>
49840>>>>>>>Function Sysdate4_Day Global Returns Integer
49842>>>>>>>    Date ldHmnia
49842>>>>>>>    Sysdate4 ldHmnia
49843>>>>>>>    Function_Return (TheDaySegment(ldHmnia))
49844>>>>>>>End_Function //private.mhnas
49845>>>>>>>
49845>>>>>>>
49845>>>>>>>//****************************************************************************
49845>>>>>>>// $Module type: FUNCTION
49845>>>>>>>// $Module name: TheMonthName (The Modes 0 The Default , 1   , 2 
49845>>>>>>>// $Author     : SPY
49845>>>>>>>// Created     : 03-01-99 @ 9:53
49845>>>>>>>//
49845>>>>>>>// Description
49845>>>>>>>//
49845>>>>>>>// $Rev History
49845>>>>>>>//****************************************************************************
49845>>>>>>>
49845>>>>>>>Enumeration_List
49845>>>>>>>    Define mMonthOnom
49845>>>>>>>    Define mMonthGen
49845>>>>>>>    Define mMonthAit
49845>>>>>>>    Define mMonthEnglish
49845>>>>>>>End_Enumeration_List
49845>>>>>>>
49845>>>>>>>Function TheMonthName Global Integer iMonthNum Integer iMode Returns String
49847>>>>>>>    Local String rMonth
49847>>>>>>>
49847>>>>>>>    If iMode eq mMonthGen Begin
49849>>>>>>>             If iMonthNum eq 1  Move ""  to rMonth
49852>>>>>>>        Else If iMonthNum eq 2  Move "" to rMonth
49856>>>>>>>        Else If iMonthNum eq 3  Move ""     to rMonth
49860>>>>>>>        Else If iMonthNum eq 4  Move ""    to rMonth
49864>>>>>>>        Else If iMonthNum eq 5  Move ""       to rMonth
49868>>>>>>>        Else If iMonthNum eq 6  Move ""     to rMonth
49872>>>>>>>        Else If iMonthNum eq 7  Move ""     to rMonth
49876>>>>>>>        Else If iMonthNum eq 8  Move ""   to rMonth
49880>>>>>>>        Else If iMonthNum eq 9  Move "" to rMonth
49884>>>>>>>        Else If iMonthNum eq 10 Move ""   to rMonth
49888>>>>>>>        Else If iMonthNum eq 11 Move ""   to rMonth
49892>>>>>>>        Else If iMonthNum eq 12 Move ""  to rMonth
49896>>>>>>>    End
49896>>>>>>>>
49896>>>>>>>    Else Begin
49897>>>>>>>        If iMode eq mMonthAit Begin
49899>>>>>>>                 If iMonthNum eq 1  Move ""  to rMonth
49902>>>>>>>            Else If iMonthNum eq 2  Move "" to rMonth
49906>>>>>>>            Else If iMonthNum eq 3  Move ""     to rMonth
49910>>>>>>>            Else If iMonthNum eq 4  Move ""    to rMonth
49914>>>>>>>            Else If iMonthNum eq 5  Move ""       to rMonth
49918>>>>>>>            Else If iMonthNum eq 6  Move ""     to rMonth
49922>>>>>>>            Else If iMonthNum eq 7  Move ""     to rMonth
49926>>>>>>>            Else If iMonthNum eq 8  Move ""   to rMonth
49930>>>>>>>            Else If iMonthNum eq 9  Move "" to rMonth
49934>>>>>>>            Else If iMonthNum eq 10 Move ""   to rMonth
49938>>>>>>>            Else If iMonthNum eq 11 Move ""   to rMonth
49942>>>>>>>            Else If iMonthNum eq 12 Move ""  to rMonth
49946>>>>>>>        End
49946>>>>>>>>
49946>>>>>>>        Else Begin
49947>>>>>>>            If iMode eq mMonthOnom Begin
49949>>>>>>>                     If iMonthNum eq 1  Move ""  To rMonth
49952>>>>>>>                Else If iMonthNum eq 2  Move "" To rMonth
49956>>>>>>>                Else If iMonthNum eq 3  Move ""     To rMonth
49960>>>>>>>                Else If iMonthNum eq 4  Move ""    To rMonth
49964>>>>>>>                Else If iMonthNum eq 5  Move ""       To rMonth
49968>>>>>>>                Else If iMonthNum eq 6  Move ""     To rMonth
49972>>>>>>>                Else If iMonthNum eq 7  Move ""     To rMonth
49976>>>>>>>                Else If iMonthNum eq 8  Move ""   To rMonth
49980>>>>>>>                Else If iMonthNum eq 9  Move "" To rMonth
49984>>>>>>>                Else If iMonthNum eq 10 Move ""   To rMonth
49988>>>>>>>                Else If iMonthNum eq 11 Move ""   To rMonth
49992>>>>>>>                Else If iMonthNum eq 12 Move ""  To rMonth
49996>>>>>>>            End
49996>>>>>>>>
49996>>>>>>>            Else Begin
49997>>>>>>>                If iMode eq mMonthEnglish Begin
49999>>>>>>>                         If iMonthNum eq 1  Move "January"      To rMonth
50002>>>>>>>                    Else If iMonthNum eq 2  Move "February"     To rMonth
50006>>>>>>>                    Else If iMonthNum eq 3  Move "March"        To rMonth
50010>>>>>>>                    Else If iMonthNum eq 4  Move "April"        To rMonth
50014>>>>>>>                    Else If iMonthNum eq 5  Move "May"          To rMonth
50018>>>>>>>                    Else If iMonthNum eq 6  Move "June"         To rMonth
50022>>>>>>>                    Else If iMonthNum eq 7  Move "July"         To rMonth
50026>>>>>>>                    Else If iMonthNum eq 8  Move "August"       To rMonth
50030>>>>>>>                    Else If iMonthNum eq 9  Move "September"    To rMonth
50034>>>>>>>                    Else If iMonthNum eq 10 Move "October"      To rMonth
50038>>>>>>>                    Else If iMonthNum eq 11 Move "November"     To rMonth
50042>>>>>>>                    Else If iMonthNum eq 12 Move "December"     To rMonth
50046>>>>>>>                End
50046>>>>>>>>
50046>>>>>>>            End
50046>>>>>>>>
50046>>>>>>>
50046>>>>>>>        End
50046>>>>>>>>
50046>>>>>>>    End
50046>>>>>>>>
50046>>>>>>>
50046>>>>>>>    Function_Return rMonth
50047>>>>>>>End_Function // TheMonthName
50048>>>>>>>
50048>>>>>>>//****************************************************************************
50048>>>>>>>// $Module type: FUNCTION
50048>>>>>>>// $Module name: LongDateName
50048>>>>>>>// $Author     : SPY
50048>>>>>>>// Created     : 03-01-99 @ 9:53
50048>>>>>>>//
50048>>>>>>>// Description
50048>>>>>>>//
50048>>>>>>>// $Rev History
50048>>>>>>>//****************************************************************************
50048>>>>>>>
50048>>>>>>>Function LongDateName Global Date dDate Returns String
50050>>>>>>>    Local String sDay sDate sMonth sYear
50050>>>>>>>    Move (DateToWeekDayName(dDate))        to sDay
50051>>>>>>>    Move (TheDaySegment(dDate))                   to sDate
50052>>>>>>>    Move (TheMonthName((TheMonthSegment(dDate)),1)) to sMonth
50053>>>>>>>    Move (TheYearSegment(dDate))                  to sYear
50054>>>>>>>    Function_Return (sDay+","*sDate*sMonth*sYear)
50055>>>>>>>End_Function
50056>>>>>>>
50056>>>>>>>//****************************************************************************
50056>>>>>>>// $Module type: FUNCTION
50056>>>>>>>// $Module name: isDisekto
50056>>>>>>>// $Author     : SPY
50056>>>>>>>// Created     : 03-01-99 @ 9:53
50056>>>>>>>//
50056>>>>>>>// Description
50056>>>>>>>//
50056>>>>>>>// $Rev History
50056>>>>>>>//****************************************************************************
50056>>>>>>>
50056>>>>>>>Function isDisekto Global Integer liYear Returns Integer
50058>>>>>>>    Local Integer rVal
50058>>>>>>>    If (Mod(liYear,4) = 0) Begin
50060>>>>>>>        If (Mod(liYear,100) = 0) Begin
50062>>>>>>>            If (Mod(liYear,400) = 0) Move 1 to rVal
50065>>>>>>>        End
50065>>>>>>>>
50065>>>>>>>        Else Move 1 to rVal
50067>>>>>>>    End
50067>>>>>>>>
50067>>>>>>>    Function_Return rVal
50068>>>>>>>End_Function // isDisekto
50069>>>>>>>
50069>>>>>>>//****************************************************************************
50069>>>>>>>// $Module type: FUNCTION
50069>>>>>>>// $Module name: DaysOfYear
50069>>>>>>>// $Author     : SPY
50069>>>>>>>// Created     : 03-01-99 @ 9:53
50069>>>>>>>//
50069>>>>>>>// Description
50069>>>>>>>//
50069>>>>>>>// $Rev History
50069>>>>>>>//****************************************************************************
50069>>>>>>>
50069>>>>>>>Function DaysOfYear global Integer iYear Returns Integer
50071>>>>>>>    Local Integer rVal
50071>>>>>>>    Move 365 to rVal
50072>>>>>>>    If (isDisekto(iYear)) Move 366 to rVal
50075>>>>>>>    Function_Return rval
50076>>>>>>>End_Function // DaysOfYear
50077>>>>>>>
50077>>>>>>>//****************************************************************************
50077>>>>>>>// $Module type: FUNCTION
50077>>>>>>>// $Module name: BeginOfMonth
50077>>>>>>>// $Author     : SPY
50077>>>>>>>// Created     : 03-01-99 @ 9:53
50077>>>>>>>//
50077>>>>>>>// Description
50077>>>>>>>//
50077>>>>>>>// $Rev History
50077>>>>>>>//****************************************************************************
50077>>>>>>>
50077>>>>>>>Function BeginOfMonth Global Integer liMonth Integer liYear Returns Date
50079>>>>>>>    Local Integer rVal
50079>>>>>>>    Local Date rDate
50079>>>>>>>    Local String liMM lsDSep
50079>>>>>>>    Local Number lnDateFormat
50079>>>>>>>    Get_attribute DF_Date_Separator to rval
50082>>>>>>>    Move (Character(rVal)) to lsDSep
50083>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
50086>>>>>>>    If (Length (liMonth) = 1) Move ("0" + String(liMonth)) to liMM
50089>>>>>>>    Else Move (String(liMonth)) to liMM
50091>>>>>>>    If lnDateFormat eq DF_DATE_EUROPEAN       Move ("01" + lsDSep + liMM + lsDSep + String(liYear)) to rDate
50094>>>>>>>    Else If lnDateFormat eq DF_DATE_USA       Move (liMM + lsDSep + "01" + lsDSep + String(liYear)) to rDate
50098>>>>>>>    Else If lnDateFormat eq DF_DATE_MILITARY  Move (String(liYear) + lsDSep + liMM + lsDSep + "01") to rDate
50102>>>>>>>    Function_Return rDate
50103>>>>>>>End_Function  //BeginOfMonth
50104>>>>>>>
50104>>>>>>>
50104>>>>>>>//****************************************************************************
50104>>>>>>>// $Module type: FUNCTION
50104>>>>>>>// $Module name: EndOfMonth
50104>>>>>>>// $Author     : SPY
50104>>>>>>>// Created     : 03-01-99 @ 9:53
50104>>>>>>>//
50104>>>>>>>// Description
50104>>>>>>>//
50104>>>>>>>// $Rev History
50104>>>>>>>//****************************************************************************
50104>>>>>>>
50104>>>>>>>Function EndOfMonth Global Integer liMonth Integer liYear Returns Date
50106>>>>>>>    Local Date rDate
50106>>>>>>>    If liMonth eq 12 Move (BeginOfMonth(1,(liYear+1))-1) to rDate
50109>>>>>>>    Else Move (BeginOfMonth((liMonth+1),liYear)-1) to rDate
50111>>>>>>>    Function_Return rDate
50112>>>>>>>End_Function  // EndOfMonth
50113>>>>>>>
50113>>>>>>>//****************************************************************************
50113>>>>>>>// $Module type: FUNCTION
50113>>>>>>>// $Module name: LastMonday
50113>>>>>>>// $Author     : SPY
50113>>>>>>>// Created     : 03-01-99 @ 9:53
50113>>>>>>>//
50113>>>>>>>// Description
50113>>>>>>>//
50113>>>>>>>// $Rev History
50113>>>>>>>//****************************************************************************
50113>>>>>>>
50113>>>>>>>Function LastMonday global Date dDate Returns Date
50115>>>>>>>    Local Integer iWeekDay
50115>>>>>>>    Local Date rVal
50115>>>>>>>    Move (DateToWeekDay(dDate)) to iWeekDay
50116>>>>>>>    If iWeekDay eq 0 Move (dDate-6) to rVal
50119>>>>>>>    Else Move (dDate-(iWeekDay-1)) to rVal
50121>>>>>>>    Function_Return rval
50122>>>>>>>End_Function // LastMonday
50123>>>>>>>
50123>>>>>>>
50123>>>>>>>//****************************************************************************
50123>>>>>>>// $Module type: FUNCTION
50123>>>>>>>// $Module name: DayOfTheYear
50123>>>>>>>// $Author     : SPY
50123>>>>>>>// Created     : 03-01-99 @ 9:53
50123>>>>>>>//
50123>>>>>>>// Description
50123>>>>>>>//
50123>>>>>>>// $Rev History
50123>>>>>>>//****************************************************************************
50123>>>>>>>
50123>>>>>>>Function DayOfTheYear global date dDate Returns Integer
50125>>>>>>>    local integer rVal
50125>>>>>>>    local string sYSeg
50125>>>>>>>    local date ldate lcheckdate
50125>>>>>>>    Local Number lnDateFormat
50125>>>>>>>    Get_Attribute DF_DATE_FORMAT to lnDateFormat
50128>>>>>>>    Move (BeginOfMonth(1,(TheYearSegment(dDate)))) to lDate
50129>>>>>>>    Move ((dDate-lDate)+1) to rval
50130>>>>>>>    If Not (isDisekto(TheYearSegment(dDate))=1) Begin
50132>>>>>>>        If lnDateFormat eq DF_DATE_EUROPEAN Move ("01/03/"+(String((TheYearSegment(dDate))))) to lcheckdate
50135>>>>>>>        Else If lnDateFormat eq DF_DATE_USA Move ("03/01/"+(String((TheYearSegment(dDate))))) to lcheckdate
50139>>>>>>>        Else If lnDateFormat eq DF_DATE_MILITARY Move ((String((TheYearSegment(dDate))))+"03/01/") to lcheckdate
50143>>>>>>>        If (((lCheckDate-lDate) = 60) and (dDate ge lcheckDate)) Move (dDate-lDate) to rval
50146>>>>>>>    End
50146>>>>>>>>
50146>>>>>>>    Function_Return rVal
50147>>>>>>>End_Function  // DayOfTheYear
50148>>>>>>>
50148>>>>>>>
50148>>>>>>>//****************************************************************************
50148>>>>>>>// $Module type: FUNCTION
50148>>>>>>>// $Module name: TheEasterDay
50148>>>>>>>// $Author     : SPY
50148>>>>>>>// Created     : 13-06-99 @ 9:53
50148>>>>>>>//
50148>>>>>>>// Description
50148>>>>>>>//
50148>>>>>>>// $Rev History
50148>>>>>>>//****************************************************************************
50148>>>>>>>
50148>>>>>>>Function TheEasterDay Global Integer aiTheYear Returns Date
50150>>>>>>>    Local Integer liMoonYearCycle liEpakth liEasterFullMoon liMonth
50150>>>>>>>    Local Integer liOldDateFormat liSeparator
50150>>>>>>>    Local Date ldEasterDay
50150>>>>>>>    Local String lsDSep
50150>>>>>>>    Get_attribute DF_Date_Separator to liSeparator
50153>>>>>>>    Get_Attribute DF_DATE_FORMAT to liOldDateFormat
50156>>>>>>>    Set_Attribute DF_DATE_FORMAT to DF_DATE_EUROPEAN
50159>>>>>>>    Move (Character(liSeparator)) to lsDSep
50160>>>>>>>    Move 3 to liMonth
50161>>>>>>>    Move (Mod((aiTheYear-2),19)) to liMoonYearCycle
50162>>>>>>>    Move (Mod((11*liMoonYearCycle),30)) to liEpakth
50163>>>>>>>    Move ((30-liEpakth)+14) to liEasterFullMoon
50164>>>>>>>    If liEasterFullMoon ge 21 Begin
50166>>>>>>>        If liEasterFullMoon gt 31 Begin
50168>>>>>>>            Move (liEasterFullMoon-31) to liEasterFullMoon
50169>>>>>>>            Move 4 to liMonth
50170>>>>>>>        End
50170>>>>>>>>
50170>>>>>>>    End
50170>>>>>>>>
50170>>>>>>>    Else Begin
50171>>>>>>>        Move (liEasterFullMoon-1) to liEasterFullMoon
50172>>>>>>>        Move 4 to liMonth
50173>>>>>>>    End
50173>>>>>>>>
50173>>>>>>>    Move (String(liEasterFullMoon) + lsDSep + String(liMonth) + lsDSep + String(aiTheYear)) to ldEasterDay
50174>>>>>>>    Set_Attribute DF_DATE_FORMAT to liOldDateFormat
50177>>>>>>>
50177>>>>>>>    //           ldEasterDay  
50177>>>>>>>    //Move (ldEasterDay + (7- (DateToWeekDay(ldEasterDay)) )  ) to ldEasterDay
50177>>>>>>>
50177>>>>>>>    //     14       ldEasterDay   
50177>>>>>>>    //ldEasterDay   (  )
50177>>>>>>>    If (DateToWeekDay(ldEasterDay) <> 0) Move (ldEasterDay + (7-(DateToWeekDay(ldEasterDay)))) to ldEasterDay
50180>>>>>>>    Move (ldEasterDay+14) to ldEasterDay
50181>>>>>>>    Function_Return ldEasterDay
50182>>>>>>>End_Function
50183>>>>>>>
50183>>>>>>>
50183>>>>>>>// Remarked -    VDF (ToAnsi, ToOEM) 21/09/98 -Spy
50183>>>>>>>
50183>>>>>>>//You must be aware that due to compatibility of the database between DOS CM
50183>>>>>>>//versions and VDF, all data in DataFlex datafiles will be stored using the same
50183>>>>>>>//character set (like DOS cp850).
50183>>>>>>>//This means that if you want read data from an ascii file directly into the
50183>>>>>>>//record buffer, and this ascii file is in windows (ansi) format, you must
50183>>>>>>>//convert the data first, using the OemToAnsi function. (and v.v. with AnsiToOem
50183>>>>>>>//if you want to write a text file of windows format).
50183>>>>>>>
50183>>>>>>>//The AnsiToOem and OemToAnsi functions itself takes pointers as arguments, so it
50183>>>>>>>//will be convenient to create functions on top of these, so you can call these
50183>>>>>>>//functions with a normal string as argument. I have made functions like this:
50183>>>>>>>
50183>>>>>>>//            function wintilcpDOS global string sind returns string
50183>>>>>>>//                local pointer ip
50183>>>>>>>//                local integer itmp ilen
50183>>>>>>>//                move (length(sind)) to ilen
50183>>>>>>>//                append sind (character(0))
50183>>>>>>>//                getaddress of sind to ip
50183>>>>>>>//                Move (AnsiToOem(ip,ip)) To iTmp
50183>>>>>>>//                function_return (left(sind,ilen))
50183>>>>>>>//            end_function
50183>>>>>>>
50183>>>>>>>//            function cpDOStilwin global string sind returns string
50183>>>>>>>//                local pointer ip
50183>>>>>>>//                local integer itmp ilen
50183>>>>>>>//                move (length(sind)) to ilen
50183>>>>>>>//                append sind (character(0))
50183>>>>>>>//                getaddress of sind to ip
50183>>>>>>>//                Move (OemToAnsi(ip,ip)) To iTmp
50183>>>>>>>//                function_return (left(sind,ilen))
50183>>>>>>>//            end_function
50183>>>>>>>
50183>>>>>>>// Global Handle for Set Object
50183>>>>>>>Integer ghoExpSet
50183>>>>>>>
50183>>>>>>>Function Get_ExpOfTwo Global Real arNum Returns Integer
50185>>>>>>>    Local real lrNum lrTempNum
50185>>>>>>>    Local Integer liCounter
50185>>>>>>>
50185>>>>>>>    Move arNum to lrNum
50186>>>>>>>    If ((lrNum < 10e+306) and (lrNum > 0)) Begin
50188>>>>>>>        //destroy the set using the global integer that hold its handle
50188>>>>>>>        If (ghoExpSet) Send destroy_object to ghoExpSet
50191>>>>>>>        //Make an instance of a set to hold the Exp
50191>>>>>>>        Get Make_Set to ghoExpSet
50192>>>>>>>        Move 1 to lrTempnum
50193>>>>>>>        While (lrTempnum<lrNum)
50197>>>>>>>
50197>>>>>>>            Repeat
50197>>>>>>>>
50197>>>>>>>                If ((2*lrTempnum)<=lrNum) Begin
50199>>>>>>>                    Move (2*lrTempnum) to lrTempnum
50200>>>>>>>                    Add 1 to liCounter
50201>>>>>>>                End
50201>>>>>>>>
50201>>>>>>>            Until ((2*lrTempnum)>lrNum)
50203>>>>>>>            Send Add_Element to ghoExpSet liCounter
50204>>>>>>>            If (lrTempnum<lrNum) Begin
50206>>>>>>>                Move (lrnum-lrTempnum) to lrnum
50207>>>>>>>                Move 1 to lrTempnum
50208>>>>>>>                Move 0 to liCounter
50209>>>>>>>            End
50209>>>>>>>>
50209>>>>>>>
50209>>>>>>>        Loop
50210>>>>>>>>
50210>>>>>>>    End
50210>>>>>>>>
50210>>>>>>>    If ((lrNum = lrTempnum) and (lrNum <> 1)) Move 0 to lrNum
50213>>>>>>>    Function_Return  (String(lrNum))
50214>>>>>>>End_Function
50215>>>>>>>
50215>>>>>>>
50215>>>>>>>Function Get_PowerOfTwo Global Returns Real
50217>>>>>>>    Local Real liPowerOfTwo
50217>>>>>>>    Local Integer liCounter liExp
50217>>>>>>>    For liCounter From 0 to (Item_Count(ghoExpSet)-1)
50223>>>>>>>>
50223>>>>>>>        Get Value of ghoExpSet Item liCounter to liExp
50224>>>>>>>        Add (2^liExp) to liPowerOfTwo
50225>>>>>>>    Loop
50226>>>>>>>>
50226>>>>>>>    Function_Return liPowerOfTwo
50227>>>>>>>End_Function
50228>>>>>>>
50228>>>>>>>
50228>>>>>>>
50228>>>>>>>//Set Shadow_State of Item N to (Component_Shadow_State(**C**))
50228>>>>>>>Function Component_Shadow_State Global Integer liComponenet_Code Returns Integer
50230>>>>>>>         If liComponenet_Code eq 3  Function_Return 1 //disable
50233>>>>>>>         Function_Return 0 //enabled
50234>>>>>>>End_Function
50235>>>>>>>
50235>>>>>>>// 1 cm = 556,9291 twips
50235>>>>>>>// 1 in = 1440 twips
50235>>>>>>>// 1 in = 2,54 cm
50235>>>>>>>
50235>>>>>>>Function CmToTwips Global Number aiCm Returns Integer
50237>>>>>>>    Function_Return (Round(aiCm*566.9291))
50238>>>>>>>End_Function // CmToTwips
50239>>>>>>>
50239>>>>>>>Function CmToInches Global Number aiCm Returns Number
50241>>>>>>>    Function_Return (aiCm/2.54)
50242>>>>>>>End_Function // CmToInches
50243>>>>>>>
50243>>>>>>>Function InchesToCm Global Number aiIn Returns Number
50245>>>>>>>    Function_Return (aiIn*2.54)
50246>>>>>>>End_Function // InchesToCm
50247>>>>>>>
50247>>>>>>>Function TwipsToCm Global Integer aiTwips Returns Number
50249>>>>>>>    Function_Return (aiTwips/566.9291)
50250>>>>>>>End_Function // TwipsToCm
50251>>>>>>>
50251>>>>>>>
50251>>>>>>>/// Function    Runtime 16/06/2000 Spy
50251>>>>>>>Procedure DoRunApplication For Baseclass String sAppName
50253>>>>>>>    String sRuntime
50253>>>>>>>    Integer bFileExists
50253>>>>>>>
50253>>>>>>>    get_profile_string "defaults" "VDFRootDir" to sRuntime
50256>>>>>>>    append sRuntime "\bin\dfrun.exe "
50257>>>>>>>    File_Exist sRuntime bFileExists
50258>>>>>>>    If (Not(bFileExists)) Begin
50260>>>>>>>        get_profile_string "defaults" "VDFBinDir" to sRuntime
50263>>>>>>>        append sRuntime "\dfrun.exe "
50264>>>>>>>        File_Exist sRuntime bFileExists
50265>>>>>>>        If (Not(bFileExists)) Begin
50267>>>>>>>            Send Stop_Box ".    RunTime!" " "
50268>>>>>>>            Procedure_Return
50269>>>>>>>        End
50269>>>>>>>>
50269>>>>>>>    End
50269>>>>>>>>
50269>>>>>>>    append sRuntime sAppName
50270>>>>>>>    runprogram background sRuntime
50271>>>>>>>End_procedure
50272>>>>>>>
50272>>>>>>>
50272>>>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
50274>>>>>>>    String rVal lsDirSep
50274>>>>>>>    Integer iPos iMet iLen iCnt
50274>>>>>>>    Move (Trim(asFullPath))                 To rVal
50275>>>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
50276>>>>>>>    If (rVal Contains lsDirSep) Begin
50278>>>>>>>        Move (Length(rVal)) to iLen
50279>>>>>>>        Move iLen to iCnt
50280>>>>>>>        While iCnt Gt 0
50284>>>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
50286>>>>>>>                If (iCnt=iLen) Function_Return asFullPath
50289>>>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
50291>>>>>>>            End
50291>>>>>>>>
50291>>>>>>>            Decrement iCnt
50292>>>>>>>        End
50293>>>>>>>>
50293>>>>>>>    End
50293>>>>>>>>
50293>>>>>>>    Else  Function_Return (Trim(asFullPath))
50295>>>>>>>    Function_Return rVal
50296>>>>>>>End_Function
50297>>>>>>>
50297>>>>>>>
50297>>>>>>>
50297>>>>>>>
50297>>>>>
50297>>>>>USE ARRAYS.Sub
Including file: ARRAYS.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\ARRAYS.SUB)
50297>>>>>>>
50297>>>>>>>//               *******************
50297>>>>>>>//               *          *
50297>>>>>>>//               *******************
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//      n           1      2       3      
50297>>>>>>>//        a1,a2b1,b2,b3c1,c2,c3,c4
50297>>>>>>>//   2      3       4      items(n)
50297>>>>>>>//repetitions      12      4       1      reps(n)/(items(n))        total_rows/(items(1))
50297>>>>>>>//passes            1      2       6      items(1) * items(2) * ... items(n-1)        1
50297>>>>>>>//nTotal_Rows =        2 * 3 * 4 = 24       items(1) * items(2) * ... items(n)
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//                             
50297>>>>>>>//                              Values_PointerCombinations_Pointer  
50297>>>>>>>//                         
50297>>>>>>>//                          0        3                  3          
50297>>>>>>>//         > 1   KKK1 (self)        CCC1 (self)     <
50297>>>>>>>//               > 2   KKK2 (self)        CCC2 (self)     <
50297>>>>>>>//                    > 3   KKK3 (self)        CCC3 (self)     <
50297>>>>>>>//                        
50297>>>>>>>//                                                                    
50297>>>>>>>//                                                                    
50297>>>>>>>//                                                                    
50297>>>>>>>//                                                                    
50297>>>>>>>//        KKK1   KKK2  KKK3                                              
50297>>>>>>>//                                                   
50297>>>>>>>//                                                         
50297>>>>>>>//                                                   
50297>>>>>>>//         A     B    C                                              
50297>>>>>>>//                                               
50297>>>>>>>//     0   2     3    4 0                                          
50297>>>>>>>//     1  A1    B1   C1 1                                          
50297>>>>>>>//     2  A2    B2   C2 2                                          
50297>>>>>>>//     3   B3   C3 3                                          
50297>>>>>>>//     4        C4 4                                          
50297>>>>>>>//                                                                
50297>>>>>>>//                          
50297>>>>>>>//                                  
50297>>>>>>>//                                         
50297>>>>>>>//                      
50297>>>>>>>//                              
50297>>>>>>>//                      
50297>>>>>>>//                        CCC1    CCC2    CCC3 
50297>>>>>>>//                      
50297>>>>>>>// reps(3)  =     1       A1      B1      C1   
50297>>>>>>>//                2       A1      B1      C2   
50297>>>>>>>//                3       A1      B1      C3   
50297>>>>>>>// reps(2)  =     4       A1      B1      C4   
50297>>>>>>>//                             
50297>>>>>>>//                5       A1      B2      C1   
50297>>>>>>>//                6       A1      B2      C2   
50297>>>>>>>//                7       A1      B2      C3   
50297>>>>>>>//                8       A1      B2      C4   
50297>>>>>>>//                             
50297>>>>>>>//                9       A1      B3      C1   
50297>>>>>>>//               10       A1      B3      C2   
50297>>>>>>>//               11       A1      B3      C3   
50297>>>>>>>// reps(1)  =    12       A1      B3      C4   
50297>>>>>>>//                      
50297>>>>>>>//               13       A2      B1      C1   
50297>>>>>>>//               14       A2      B1      C2   
50297>>>>>>>//               15       A2      B1      C3   
50297>>>>>>>//               16       A2      B1      C4   
50297>>>>>>>//                             
50297>>>>>>>//               17       A2      B2      C1   
50297>>>>>>>//               18       A2      B2      C2   
50297>>>>>>>//               19       A2      B2      C3   
50297>>>>>>>//               20       A2      B2      C4   
50297>>>>>>>//                             
50297>>>>>>>//               21       A2      B3      C1   
50297>>>>>>>//               22       A2      B3      C2   
50297>>>>>>>//               23       A2      B3      C3   
50297>>>>>>>//               24       A2      B3      C4   
50297>>>>>>>//                      
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//                      
50297>>>>>>>//  n        1        2       3   
50297>>>>>>>//         2        3       4   
50297>>>>>>>//repetitions            12        4       1 * 
50297>>>>>>>//passes                  1 *      2       6   
50297>>>>>>>//                      
50297>>>>>>>//piColumns##                       3            
50297>>>>>>>//piRows##                         24            
50297>>>>>>>//                      
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//                         
50297>>>>>>>//                         Repetitions  Passes  
50297>>>>>>>//                     
50297>>>>>>>//                      0        3        3    
50297>>>>>>>//                      1       12        1    
50297>>>>>>>//                      2        4        2    
50297>>>>>>>//                      3        1        6    
50297>>>>>>>//                     
50297>>>>>>>//
50297>>>>>>>//   combine
50297>>>>>>>// 1. Passes(n) * Items(n) * Repetitions(n) = piRows##
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//
50297>>>>>>>//piColumns##                : property          & 
50297>>>>>>>//piRows##                   : property         
50297>>>>>>>//oarray_Values_Pointer      :   object id's         (kkk arrays)
50297>>>>>>>//oarray_Combinations_Pointer:   object id's    (ccc arrays)
50297>>>>>>>//oarray_Repetitions         :         
50297>>>>>>>//oarray_Passes              :          
50297>>>>>>>//kkk                        :  
50297>>>>>>>//ccc                        :  
50297>>>>>>>//sfDimValue(column,row)     :            kkk(column),  row
50297>>>>>>>//sfComValue(column,row)     :       ccc(column),  row
50297>>>>>>>//do_AddValue(column,svalue) :    svalue      kkk(column)
50297>>>>>>>//do_Combine                 :   
50297>>>>>>>//set size to columns        :  initializations    child tables
50297>>>>>>>//                                    columns
50297>>>>>>>
50297>>>>>>>
50297>>>>>>>
50297>>>>>>>
50297>>>>>>>
50297>>>>>>>//
50297>>>>>>>//   
50297>>>>>>>Class cPinakas is an Array
50298>>>>>>>
50298>>>>>>>      //   sVal##    
50298>>>>>>>      //   item 0     
50298>>>>>>>      Procedure Add_Item String VAL##
50300>>>>>>>                Set Array_Value Item (Item_Count(Current_Object)) to Val##
50301>>>>>>>
50301>>>>>>>                // item 0  pinaka1      
50301>>>>>>>                Set Array_Value Item 0 to (Item_Count(Current_Object)-1)
50302>>>>>>>      End_Procedure //add_item
50303>>>>>>>
50303>>>>>>>      Procedure Initialize_Array_useless
50305>>>>>>>                Local Integer i##
50305>>>>>>>                For i## from 0 to (Item_Count(Current_Object)-1)
50311>>>>>>>>
50311>>>>>>>                    Set Array_Value of (Current_Object) Item i## to ""
50312>>>>>>>                Loop
50313>>>>>>>>
50313>>>>>>>      End_Procedure //initialize_array
50314>>>>>>>
50314>>>>>>>      Procedure Show_Array //,   debugging
50316>>>>>>>                Local Integer i##
50316>>>>>>>                Local String x##
50316>>>>>>>                For i## from 0 to (Item_Count(Current_Object)-1)
50322>>>>>>>>
50322>>>>>>>                    Get Array_Value of (Current_Object) Item i## to x##
50323>>>>>>>                    showln  i## " : " x##
50327>>>>>>>                Loop
50328>>>>>>>>
50328>>>>>>>      End_Procedure //show_array
50329>>>>>>>End_Class //cpinakas
50330>>>>>>>
50330>>>>>>>
50330>>>>>>>
50330>>>>>>>//
50330>>>>>>>Class cCombinations_Array_2d is a cPinakas
50331>>>>>>>
50331>>>>>>>      Procedure Construct_Object
50333>>>>>>>
50333>>>>>>>                Forward Send Construct_Object
50335>>>>>>>
50335>>>>>>>                //    =  ccc
50335>>>>>>>                Property Integer piColumns## Public 0
50336>>>>>>>
50336>>>>>>>                //   
50336>>>>>>>                Property Integer piRows##    Public 0
50337>>>>>>>
50337>>>>>>>                //pointer array   arrays  kkk ( n)
50337>>>>>>>                Object oarray_Values_Pointer       is a cPinakas
50339>>>>>>>                End_Object
50340>>>>>>>
50340>>>>>>>                //pointer array   arrays  ccc ( )
50340>>>>>>>                Object oarray_Combinations_Pointer is a cPinakas
50342>>>>>>>                End_Object
50343>>>>>>>
50343>>>>>>>                //       n
50343>>>>>>>                Object oarray_Repetitions           is a cPinakas
50345>>>>>>>                End_Object
50346>>>>>>>
50346>>>>>>>                //      n
50346>>>>>>>                Object oarray_Passes                is a cPinakas
50348>>>>>>>                End_Object
50349>>>>>>>
50349>>>>>>>       End_Procedure //construct_object
50350>>>>>>>
50350>>>>>>>
50350>>>>>>>       Procedure Do_Initialize_Child_Arrays
50352>>>>>>>                 Local Integer i##
50352>>>>>>>                 Local Integer iNumber_of_KKK_Arrays## // kkk arrays
50352>>>>>>>                 Local Integer iNumber_of_CCC_Arrays## // ccc arrays
50352>>>>>>>
50352>>>>>>>                 //*****************************************************
50352>>>>>>>                 //  kkk & ccc arrays                     *
50352>>>>>>>                 //*****************************************************
50352>>>>>>>                 Move (VALUE(oarray_Values_Pointer      (Current_Object),0)) to iNumber_of_KKK_Arrays##
50353>>>>>>>                 Move (VALUE(oarray_Combinations_Pointer(Current_Object),0)) to iNumber_of_CCC_Arrays##
50354>>>>>>>
50354>>>>>>>                 //*****************************************************
50354>>>>>>>                 //   kkk arrays                      *
50354>>>>>>>                 //*****************************************************
50354>>>>>>>                 If iNumber_of_KKK_Arrays## gt 0 Begin
50356>>>>>>>                    For i## from 1 to iNumber_of_KKK_Arrays##
50362>>>>>>>>
50362>>>>>>>                        Send Destroy_Object to (VALUE(oarray_Values_Pointer(Current_Object),i##))
50363>>>>>>>                    Loop
50364>>>>>>>>
50364>>>>>>>                 End
50364>>>>>>>>
50364>>>>>>>
50364>>>>>>>                 //*****************************************************
50364>>>>>>>                 //   ccc arrays                      *
50364>>>>>>>                 //*****************************************************
50364>>>>>>>                 If iNumber_of_CCC_Arrays## gt 0 Begin
50366>>>>>>>                    For i## from 1 to iNumber_of_CCC_Arrays##
50372>>>>>>>>
50372>>>>>>>                        Send Destroy_Object to (VALUE(oarray_Combinations_Pointer(Current_Object),i##))
50373>>>>>>>                    Loop
50374>>>>>>>>
50374>>>>>>>                 End
50374>>>>>>>>
50374>>>>>>>
50374>>>>>>>
50374>>>>>>>                 //*****************************************************
50374>>>>>>>                 //  4 child arrays                       *
50374>>>>>>>                 //*****************************************************
50374>>>>>>>                 Send Delete_Data to (oarray_Values_Pointer      (Current_Object))
50375>>>>>>>                 Send Delete_Data to (oarray_Combinations_Pointer(Current_Object))
50376>>>>>>>                 Send Delete_Data to (oarray_Repetitions         (Current_Object))
50377>>>>>>>                 Send Delete_Data to (oarray_Passes              (Current_Object))
50378>>>>>>>
50378>>>>>>>
50378>>>>>>>                 //*****************************************************
50378>>>>>>>                 //  item 0  4 child arrays          *
50378>>>>>>>                 //*****************************************************
50378>>>>>>>                 Send Add_Item to (oarray_Values_Pointer      (Current_Object)) 0 // item 0     
50379>>>>>>>                 Send Add_Item to (oarray_Combinations_Pointer(Current_Object)) 0 // item 0     
50380>>>>>>>                 Send Add_Item to (oarray_Repetitions         (Current_Object)) 0 //item 0
50381>>>>>>>                 Send Add_Item to (oarray_Passes              (Current_Object)) 0 //item 0
50382>>>>>>>
50382>>>>>>>
50382>>>>>>>                 //*****************************************************
50382>>>>>>>                 //  properties                           *
50382>>>>>>>                 //*****************************************************
50382>>>>>>>                 Set piColumns## to 0
50383>>>>>>>                 Set piRows##    to 0
50384>>>>>>>
50384>>>>>>>       End_Procedure //do_initialize_child_arrays
50385>>>>>>>
50385>>>>>>>
50385>>>>>>>       Procedure Set Size Integer iSize##
50387>>>>>>>                 Local Integer i##
50387>>>>>>>
50387>>>>>>>                 Send Do_Initialize_Child_Arrays
50388>>>>>>>
50388>>>>>>>                 Set piColumns## to iSize##
50389>>>>>>>                 Set Array_Value of (oarray_Values_Pointer(Current_Object)) Item 0 to iSize##
50390>>>>>>>
50390>>>>>>>                 For i## from 1 to iSize##
50396>>>>>>>>
50396>>>>>>>                     Object KKK is a cPinakas //array 
50398>>>>>>>                        Send Add_Item TO (oarray_Values_Pointer      (Current_Object)) Self
50399>>>>>>>                        Send Add_Item TO Self 0 //item 0  kkk
50400>>>>>>>                     End_Object
50401>>>>>>>
50401>>>>>>>                     Object CCC is a cPinakas //array 
50403>>>>>>>                        Send Add_Item TO (oarray_Combinations_Pointer(Current_Object)) Self
50404>>>>>>>                        Send Add_Item TO Self 0 //item 0  ccc
50405>>>>>>>                     End_Object
50406>>>>>>>
50406>>>>>>>
50406>>>>>>>                 Loop
50407>>>>>>>>
50407>>>>>>>       End_Procedure //set size
50408>>>>>>>
50408>>>>>>>
50408>>>>>>>       //     row##   ccc(column##) array
50408>>>>>>>       Function sfComValue Integer Column## Integer Row## returns String
50410>>>>>>>                Local Integer cccID##
50410>>>>>>>                Local String  sValue##
50410>>>>>>>                Move (VALUE(oarray_Combinations_Pointer(Current_Object),Column##)) TO cccID##  //ccc array id
50411>>>>>>>                Move (VALUE(cccID##                                    ,Row##   )) TO sValue## //ccc array value
50412>>>>>>>                Function_Return sValue##
50413>>>>>>>       End_Function //sfcomvalue
50414>>>>>>>
50414>>>>>>>
50414>>>>>>>       //     row##   kkk(column##) array
50414>>>>>>>       Function sfDimValue Integer Column## Integer Row## returns String
50416>>>>>>>                Local Integer kkkID##
50416>>>>>>>                Local String  sVALUE##
50416>>>>>>>                Move (VALUE(oarray_Values_Pointer(Current_Object),Column##)) TO kkkID##  //kkk array id
50417>>>>>>>                Move (VALUE(kkkID##                      ,Row##           )) TO sValue## //kkk array value
50418>>>>>>>                Function_Return sValue##
50419>>>>>>>       End_Function //sfdimvalue
50420>>>>>>>
50420>>>>>>>
50420>>>>>>>       //       kkk(column) array
50420>>>>>>>       Procedure Do_AddValue Integer Column## String sValue##
50422>>>>>>>                 Local Integer kkkID##
50422>>>>>>>                 Move (VALUE(oarray_Values_Pointer(Current_Object),Column##)) TO kkkID## //kkk array id
50423>>>>>>>                 Send Add_Item TO kkkID## sValue##
50424>>>>>>>       End_Procedure //doaddvalue
50425>>>>>>>
50425>>>>>>>
50425>>>>>>>       Procedure Do_Combine
50427>>>>>>>                 Local Integer iTotal_Columns##                    //total number of columns
50427>>>>>>>                 Local Integer iTotal_Rows##                       //total number of rows
50427>>>>>>>                 Local Integer n## iPass## r## j##                 //   loops
50427>>>>>>>                 Local Integer cccID##                             // object id   ccc
50427>>>>>>>                 Local Integer iRows_n##                           //number of rows for column n
50427>>>>>>>                 Local Integer iPasses_n##                         //      n##
50427>>>>>>>
50427>>>>>>>
50427>>>>>>>                 //*****************************************************
50427>>>>>>>                 //                               *
50427>>>>>>>                 //*****************************************************
50427>>>>>>>                 Get piColumns## TO iTotal_Columns##
50428>>>>>>>
50428>>>>>>>
50428>>>>>>>                 //*****************************************************
50428>>>>>>>                 //    iTotal_Rows##    *
50428>>>>>>>                 //*****************************************************
50428>>>>>>>                 Move 1 to iTotal_Rows##
50429>>>>>>>                 For n## from 1 to iTotal_Columns##
50435>>>>>>>>
50435>>>>>>>                     Calc (iTotal_Rows##*(sfDimValue(Current_Object,n##,0))) to iTotal_Rows##
50436>>>>>>>>
50436>>>>>>>                 Loop
50437>>>>>>>>
50437>>>>>>>                 Set piRows## to iTotal_Rows##
50438>>>>>>>                 //showln "Total number of rows = " iTotal_Rows##
50438>>>>>>>
50438>>>>>>>
50438>>>>>>>                 //*****************************************************
50438>>>>>>>                 //   (oarray_Repetitions) *
50438>>>>>>>                 //*****************************************************
50438>>>>>>>                 Move iTotal_Rows## to iRows_n##
50439>>>>>>>                 For n## from 1 to iTotal_Columns##
50445>>>>>>>>
50445>>>>>>>                     Calc (iRows_n##/(sfDimValue(Current_Object,n##,0))) to iRows_n##
50446>>>>>>>>
50446>>>>>>>                     Send Add_Item to (oarray_Repetitions(Current_Object)) iRows_n##
50447>>>>>>>                     //showln " Repetitions(" n## ") = " iRows_n##
50447>>>>>>>                 Loop
50448>>>>>>>>
50448>>>>>>>
50448>>>>>>>                //Set Array_Value of (oarray_Repetitions(Current_Object)) Item 0 to 3
50448>>>>>>>                //Send Add_Item to   (oarray_Repetitions(Current_Object)) 12  = 24 / 2
50448>>>>>>>                //Send Add_Item to   (oarray_Repetitions(Current_Object))  4  = 12 / 3
50448>>>>>>>                //Send Add_Item to   (oarray_Repetitions(Current_Object))  1  =  4 / 4
50448>>>>>>>
50448>>>>>>>
50448>>>>>>>                 //*****************************************************
50448>>>>>>>                 //   (oarray_Passes)            *
50448>>>>>>>                 //*****************************************************
50448>>>>>>>                 Move 1 to iPasses_n##
50449>>>>>>>                 For n## from 1 to iTotal_Columns##
50455>>>>>>>>
50455>>>>>>>                     If n## ne 1 ;                        Calc (iPasses_n##*(sfDimValue(Current_Object,(n##-1),0))) to iPasses_n##
50458>>>>>>>                     Send Add_Item to (oarray_Passes(Current_Object)) iPasses_n##
50459>>>>>>>                     //showln "Passes(" n## ") = " iPasses_n##
50459>>>>>>>                 Loop
50460>>>>>>>>
50460>>>>>>>
50460>>>>>>>                //Set Array_Value of (oarray_Passes(Current_Object)) Item 0 to 3
50460>>>>>>>                //Send Add_Item to   (oarray_Passes(Current_Object))  1 = 1
50460>>>>>>>                //Send Add_Item to   (oarray_Passes(Current_Object))  2 = 1 * 2
50460>>>>>>>                //Send Add_Item to   (oarray_Passes(Current_Object))  6 = 2 * 3
50460>>>>>>>
50460>>>>>>>
50460>>>>>>>                 //*****************************************************
50460>>>>>>>                 //                               *
50460>>>>>>>                 //*****************************************************
50460>>>>>>>
50460>>>>>>>                 //      n  kkk
50460>>>>>>>                 For n## from 1 to iTotal_Columns##
50466>>>>>>>>
50466>>>>>>>
50466>>>>>>>                     //     Passes(n)
50466>>>>>>>                     For iPass## from 1 to (VALUE(oarray_Passes(Current_Object),n##))
50472>>>>>>>>
50472>>>>>>>
50472>>>>>>>                         // ()   kkk(n)
50472>>>>>>>                         Move 0 to j##
50473>>>>>>>                         While (j## < (sfDimValue(Current_Object,n##,0)))
50477>>>>>>>                               Increment j##
50478>>>>>>>                               //show "column = " n## " pass = " iPass## " " (sfDimValue(Current_Object,n##,j##)) // (n,j)
50478>>>>>>>
50478>>>>>>>                               //      kkk(n)      Repetitions(n)
50478>>>>>>>                               For r## from 1 to (VALUE(oarray_Repetitions(Current_Object),n##))
50484>>>>>>>>
50484>>>>>>>                                   //      n   (n,j)
50484>>>>>>>                                   Move (VALUE(oarray_Combinations_Pointer(Current_Object),n##)) to cccID##
50485>>>>>>>                                   Send Add_Item to cccID## (sfDimValue(Current_Object,n##,j##))
50486>>>>>>>                                   //show (sfDimValue(Current_Object,n##,j##)) //SAROSE_PINAKA Nin
50486>>>>>>>                               Loop //r##
50487>>>>>>>>
50487>>>>>>>                               //showln
50487>>>>>>>                         End //while (   n)
50488>>>>>>>>
50488>>>>>>>
50488>>>>>>>                         //showln "--------------------"
50488>>>>>>>                     Loop //iPass#
50489>>>>>>>>
50489>>>>>>>                 Loop //n##
50490>>>>>>>>
50490>>>>>>>       End_Procedure //do_combine
50491>>>>>>>
50491>>>>>>>
50491>>>>>>>
50491>>>>>>>//   procedures & functions
50491>>>>>>>       FUNCTION CHECK_DIMENSIONS2 Integer R## Integer C## RETURNS Integer
50493>>>>>>>                Local Integer MAXR## MAXC##
50493>>>>>>>
50493>>>>>>>/////////////// MOVE (ROWS##(Current_Object))    TO MAXR##
50493>>>>>>>////////////////MOVE (COLUMNS##(Current_Object)) TO MAXC##
50493>>>>>>>                IF (;                    (R##>MAXR##) OR;                    (C##>MAXC##) OR;                    (R##<1     ) OR;                    (C##<1     )   ;                   ) FUNCTION_RETURN 1
50496>>>>>>>                FUNCTION_RETURN 0
50497>>>>>>>       End_FUNCTION //check_dimensions2
50498>>>>>>>
50498>>>>>>>
50498>>>>>>>       Procedure DEFINE2 Integer R## Integer C##
50500>>>>>>>                 Local Integer I##
50500>>>>>>>/////////////////SET ROWS##    TO R##
50500>>>>>>>/////////////////SET COLUMNS## TO C##
50500>>>>>>>/////////////////SET ITEMS##   TO (R##*C##)
50500>>>>>>>                 IF (CHECK_DIMENSIONS2(Current_Object,R##,C##)) NE 0 BEGIN
50502>>>>>>>                                                                     ERROR 1000 " !"
50503>>>>>>>>
50503>>>>>>>                                                                    END
50503>>>>>>>>
50503>>>>>>>                 FOR I## FROM 0 TO ((R##*C##)-1)
50509>>>>>>>>
50509>>>>>>>                     Send Add_Item ""
50510>>>>>>>                 LOOP
50511>>>>>>>>
50511>>>>>>>       End_Procedure //define2
50512>>>>>>>
50512>>>>>>>
50512>>>>>>>       Procedure SETVALUE2 Integer R## Integer C## STRING VALUE##
50514>>>>>>>                 Local Integer MAXC## I##
50514>>>>>>>                 IF (CHECK_DIMENSIONS2(Current_Object,R##,C##)) NE 0 BEGIN
50516>>>>>>>                                                                     ERROR 1000 " !"
50517>>>>>>>>
50517>>>>>>>                                                                    END
50517>>>>>>>>
50517>>>>>>>/////////////////MOVE (COLUMNS##(Current_Object)) TO MAXC##
50517>>>>>>>                 MOVE (((R##-1)*MAXC##)+(C##-1))  TO I##
50518>>>>>>>                 SET ARRAY_VALUE ITEM I##         TO VALUE##
50519>>>>>>>       End_Procedure //setvalue2
50520>>>>>>>
50520>>>>>>>
50520>>>>>>>       FUNCTION VALUE2 Integer R## Integer C## RETURNS STRING
50522>>>>>>>                Local STRING RETVAL##
50522>>>>>>>                Local Integer MAXR## MAXC## I##
50522>>>>>>>
50522>>>>>>>                IF (CHECK_DIMENSIONS2(Current_Object,R##,C##)) NE 0 BEGIN
50524>>>>>>>                                                                    ERROR 1000 " !"
50525>>>>>>>>
50525>>>>>>>                                                                   END
50525>>>>>>>>
50525>>>>>>>////////////////MOVE (ROWS##(Current_Object))    TO MAXR##
50525>>>>>>>////////////////MOVE (COLUMNS##(Current_Object)) TO MAXC##
50525>>>>>>>                MOVE (((R##-1)*MAXC##)+(C##-1))  TO I##
50526>>>>>>>                MOVE (VALUE(Current_Object,I##)) TO RETVAL##
50527>>>>>>>                FUNCTION_RETURN RETVAL##
50528>>>>>>>       End_FUNCTION //value2
50529>>>>>>>End_Class //ccombinations_array_2d
50530>>>>>>>
50530>>>>>USE WSPACE.Sub      //12. workspace
Including file: WSPACE.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\WSPACE.SUB)
50530>>>>>>>Use cApplication.Pkg
50530>>>>>>>
50530>>>>>>>Class cApplicationSub Is A cApplication
50531>>>>>>>
50531>>>>>>>    Procedure Construct_Object
50533>>>>>>>        Forward Send Construct_Object
50535>>>>>>>        Property Integer Disable_Keyboard_State Public False
50536>>>>>>>    End_Procedure
50537>>>>>>>
50537>>>>>>>End_Class // cApplicationSub
50538>>>>>USE DD.Sub          //11. data dictionary
Including file: DD.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DD.SUB)
50538>>>>>>>Use dfClient
50538>>>>>>>Use cApplication
50538>>>>>>>Use Datadict
50538>>>>>>>
50538>>>>>>>
50538>>>>>>>Use Wspace.sub
50538>>>>>>>
50538>>>>>>>Function fsMessagePath Global Returns String
50540>>>>>>>    String lsMessagePath xxxx
50540>>>>>>>
50540>>>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to lsMessagePath
50543>>>>>>>    trim lsMessagePath to lsMessagePath
50544>>>>>>>>
50544>>>>>>>    If lsMessagePath ne "" Begin
50546>>>>>>>        insert "WorkSpaces\" in lsMessagePath at 1
50548>>>>>>>        get_profile_string lsMessagePath "FileListPath" to lsMessagePath
50551>>>>>>>        Move (Uppercase(lsMessagePath)) to lsMessagePath
50552>>>>>>>        Replace '\FILELIST.CFG' in lsMessagePath with ""
50554>>>>>>>        append lsMessagePath "\messages"
50555>>>>>>>    End
50555>>>>>>>>
50555>>>>>>>    Else Begin
50556>>>>>>>        get_profile_string "Defaults" "VDFRootDir" to lsMessagePath
50559>>>>>>>        trim lsMessagePath to lsMessagePath
50560>>>>>>>>
50560>>>>>>>        append lsMessagePath "\messages\Messages"
50561>>>>>>>    End
50561>>>>>>>>
50561>>>>>>>    Function_Return (trim(lsMessagePath))
50562>>>>>>>End_Function
50563>>>>>>>
50563>>>>>>>Object WWW is a cApplicationSub
50565>>>>>>>End_Object
50566>>>>>>>
50566>>>>>>>
50566>>>>>>>
50566>>>>>>>Class DatadictionarySub Is A Datadictionary
50567>>>>>>>
50567>>>>>>>    Procedure Construct_Object
50569>>>>>>>        Forward Send Construct_Object
50571>>>>>>>        Property Integer piiFileNumber   0
50572>>>>>>>    End_Procedure
50573>>>>>>>
50573>>>>>>>    Procedure End_Construct_Object
50575>>>>>>>        Integer liSrv
50575>>>>>>>        Forward Send End_Construct_Object
50577>>>>>>>        //Set Allow_Foreign_New_Save_State        to True
50577>>>>>>>        Get Main_File                           to liSrv
50578>>>>>>>        Set piiFileNumber                       to lisrv
50579>>>>>>>    End_procedure
50580>>>>>>>
50580>>>>>>>//    Procedure Save_Main_File
50580>>>>>>>//        Integer isOpened iFileNumber iValue
50580>>>>>>>//        Move (piiFileNumber(Self)) to iFileNumber
50580>>>>>>>//        If (iFileNumber) Begin
50580>>>>>>>//            Get_Attribute DF_FILE_OPENED Of iFileNumber to isOpened
50580>>>>>>>//            If (isOpened=DFTRUE) Begin
50580>>>>>>>//                If (Operation_Origin<>Self) Begin
50580>>>>>>>//                    Get Field_Current_Value Of iFileNumber Field 0 to iValue
50580>>>>>>>//                    If Indirect_File.Recnum Eq 0 Procedure_Return
50580>>>>>>>//                End
50580>>>>>>>//            End
50580>>>>>>>//        End
50580>>>>>>>//        Forward Send Save_Main_File
50580>>>>>>>//    End_Procedure
50580>>>>>>>
50580>>>>>>>    Function Find_Server_DDO integer iFile  Returns Integer
50582>>>>>>>        Local Integer iReturnVal
50582>>>>>>>        Local integer iMax iCount iDDO iMain_Client_File
50582>>>>>>>        Move 0 to iReturnVal
50583>>>>>>>        Get Data_Set_Server_Count to iMax
50584>>>>>>>        Decrement iMAx
50585>>>>>>>        For iCount from 0 to iMax
50591>>>>>>>>
50591>>>>>>>            Get Data_Set_Server item iCount to iDDO
50592>>>>>>>            Get Main_File of iDDO to iMain_Client_File
50593>>>>>>>            If iMain_Client_File eq iFile move iDDO to iReturnVal
50596>>>>>>>        Loop
50597>>>>>>>>
50597>>>>>>>        Function_Return iReturnVal
50598>>>>>>>    End_Function   // Find_Server_DDO
50599>>>>>>>
50599>>>>>>>    Function Find_Client_DDO integer iFile  Returns Integer
50601>>>>>>>        Local Integer iReturnVal
50601>>>>>>>        Local integer iMax iCount iDDO iMain_Client_File
50601>>>>>>>        Move 0 to iReturnVal
50602>>>>>>>        Get Data_Set_Client_Count to iMax
50603>>>>>>>        Decrement iMAx
50604>>>>>>>        For iCount from 0 to iMax
50610>>>>>>>>
50610>>>>>>>            Get Data_Set_Client item iCount to iDDO
50611>>>>>>>            Get Main_File of iDDO to iMain_Client_File
50612>>>>>>>            If iMain_Client_File eq iFile move iDDO to iReturnVal
50615>>>>>>>        Loop
50616>>>>>>>>
50616>>>>>>>        Function_Return iReturnVal
50617>>>>>>>    End_Function   // Find_Client_DDO
50618>>>>>>>
50618>>>>>>>
50618>>>>>>>   // DDRefresh is sent in Refresh_View of HCSS_dbView, which is sent during Entering_Scope.
50618>>>>>>>   // This procedure either redisplays the current record, or clears if the current record
50618>>>>>>>   // has been deleted by another view.
50618>>>>>>>//   Procedure DDRefresh
50618>>>>>>>//      Local Integer iCurrentRecord
50618>>>>>>>//      Local String sCode
50618>>>>>>>//      Get Current_Record to iCurrentRecord
50618>>>>>>>//      If (iCurrentRecord) Begin
50618>>>>>>>//         Get Main_File to Filenumber
50618>>>>>>>//         Move 0 to Fieldindex
50618>>>>>>>//         Clear Indirect_File
50618>>>>>>>//         Move iCurrentRecord to Indirect_File.Recnum&
50618>>>>>>>//         Vfind Filenumber 0 Eq
50618>>>>>>>//         If [Finderr] Begin
50618>>>>>>>//            Send Clear
50618>>>>>>>//         End
50618>>>>>>>//         Else Begin
50618>>>>>>>//            Relate Indirect_File
50618>>>>>>>//            Send Request_Assign
50618>>>>>>>//         End
50618>>>>>>>//      End
50618>>>>>>>//   End_Procedure
50618>>>>>>>
50618>>>>>>>   Function Request_Validate_And_Save Returns Integer
50620>>>>>>>      If (Should_Save(Current_Object) And Request_Validate(Current_Object) = 0) Send Request_Save
50623>>>>>>>      Function_Return (Should_Save(Current_Object))
50624>>>>>>>   End_Function
50625>>>>>>>
50625>>>>>>>End_Class //DatadictionarySub
50626>>>>>USE STPNLSC.Sub     // Status Panel
Including file: STPNLSC.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\STPNLSC.SUB)
50626>>>>>>>Use cStatusPanel.pkg
50626>>>>>>>
50626>>>>>>>Class StatusPanelSub is a cStatusPanel
50627>>>>>>>
50627>>>>>>>    Procedure Start_Statuspanel
50629>>>>>>>        Handle Hwnd
50629>>>>>>>        Integer Swp
50629>>>>>>>        String Lscaption
50629>>>>>>>        Forward Send Start_Statuspanel
50631>>>>>>>        Move (Caption_Text(Current_Object)) To Lscaption
50632>>>>>>>        Move (Toansi(Lscaption)) To Lscaption
50633>>>>>>>        Move (Findwindow("Dfdialogclass",Lscaption)) To Hwnd
50634>>>>>>>        Move (Setwindowpos(Hwnd, Hwnd_Topmost, 0, 0, 0, 0, Swp_Nomove Ior Swp_Nosize)) To Swp
50635>>>>>>>   End_Procedure
50636>>>>>>>    Procedure End_Construct_Object
50638>>>>>>>        Forward Send End_Construct_Object
50640>>>>>>>
50640>>>>>>>    End_Procedure //Construct_Object
50641>>>>>>>
50641>>>>>>>End_Class
50642>>>>>>>
50642>>>>>>>Object Status_PanelSc is a StatusPanelSub
50644>>>>>>>End_Object
50645>>>>>>>
50645>>>>>>>
50645>>>>>>>
50645>>>>>
50645>>>>>
50645>>>>>//***************************************************************************
50645>>>>>//            Application Builder configurable classes                      *
50645>>>>>//***************************************************************************
50645>>>>>USE DBCHKBOX.Sub    //01. dbcheckbox
Including file: DBCHKBOX.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBCHKBOX.SUB)
50645>>>>>>>Use dfClient
50645>>>>>>>Use DD_Deomx
50645>>>>>>>Use dfenchk
50645>>>>>>>
50645>>>>>>>Use AccKeymx.ezc
Including file: ACCKEYMX.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\ACCKEYMX.EZC)
50645>>>>>>>>>Use dfClient
50645>>>>>>>>>Use cEdit_Mixin
50645>>>>>>>>>
50645>>>>>>>>>
50645>>>>>>>>>
50645>>>>>>>>>//Mixin      
50645>>>>>>>>>
50645>>>>>>>>>Class DisableAcceleratorKey_Mixin is a Mixin
50646>>>>>>>>>
50646>>>>>>>>>    Procedure Define_DisableAcceleratorKey_Mixin
50648>>>>>>>>>
50648>>>>>>>>>        //If (phoWorkspace(ghoApplication)) Begin
50648>>>>>>>>>            //If (Disable_Keyboard_State(phoWorkspace(ghoApplication))) Begin
50648>>>>>>>>>                //on_key kBegin_of_Panel      SEND None PRIVATE
50648>>>>>>>>>                //on_key kCancel              SEND None PRIVATE
50648>>>>>>>>>                //on_key kEnd_of_Panel        SEND None PRIVATE
50648>>>>>>>>>                //on_key kExit_Function       SEND None PRIVATE
50648>>>>>>>>>                //on_key kExit_Application    SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch              SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch_Back         SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch_Panel        SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch_Panel_Back   SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch              SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch_Back         SEND None PRIVATE
50648>>>>>>>>>                //on_key kSwitch_Panel        SEND None Private
50648>>>>>>>>>                //on_key kSwitch_Panel_Back   SEND None Private
50648>>>>>>>>>                //on_key kClose_Panel         SEND None PRIVATE
50648>>>>>>>>>                //on_key kBegin_of_Data       SEND None PRIVATE
50648>>>>>>>>>                //on_key kClear               SEND None PRIVATE
50648>>>>>>>>>                //on_key kClear_All           SEND None PRIVATE
50648>>>>>>>>>                //on_key kDelete_Record       SEND None PRIVATE
50648>>>>>>>>>                //on_key kEnd_of_Data         SEND None PRIVATE
50648>>>>>>>>>                //on_key kFind                SEND None PRIVATE
50648>>>>>>>>>                //on_key kFind_Next           SEND None PRIVATE
50648>>>>>>>>>                //on_key kFind_Previous       SEND None PRIVATE
50648>>>>>>>>>                //on_key kSave_Record         SEND None PRIVATE
50648>>>>>>>>>                //on_key kSuper_Find          SEND None PRIVATE
50648>>>>>>>>>                //on_key kSuper_Find_Next     SEND None PRIVATE
50648>>>>>>>>>                //on_key kSuper_Find_Previous SEND None PRIVATE
50648>>>>>>>>>                //on_key kPrompt              SEND None PRIVATE
50648>>>>>>>>>                //on_key kZoom                SEND None PRIVATE
50648>>>>>>>>>                //on_key kUPARROW             send None PRIVATE
50648>>>>>>>>>                //on_key kDOWNARROW           send None PRIVATE
50648>>>>>>>>>                //on_key kADD_MODE            send None PRIVATE
50648>>>>>>>>>                //on_key key_F11              send None PRIVATE
50648>>>>>>>>>                //on_key key_F12              send None PRIVATE
50648>>>>>>>>>                //on_key key_F10              send None PRIVATE
50648>>>>>>>>>                //on_key key_F1               send None PRIVATE
50648>>>>>>>>>                //on_key kHelp                send None PRIVATE
50648>>>>>>>>>                //on_key kCancel              SEND None PRIVATE
50648>>>>>>>>>                //on_key kEnter               SEND None PRIVATE
50648>>>>>>>>>                //on_key kSpace               SEND None PRIVATE
50648>>>>>>>>>                //on_key kEnter               SEND None PRIVATE
50648>>>>>>>>>                //on_key key_Tab              SEND None PRIVATE
50648>>>>>>>>>                //on_key key_Shift+key_Tab    SEND None PRIVATE
50648>>>>>>>>>            //End
50648>>>>>>>>>        //End
50648>>>>>>>>>    End_Procedure
50649>>>>>>>>>
50649>>>>>>>>>    //Procedure key Integer key_Value
50649>>>>>>>>>        //If (phoWorkspace(ghoApplication)) Begin
50649>>>>>>>>>        //    If (Not(Disable_Keyboard_State(phoWorkspace(ghoApplication)))) ;
50649>>>>>>>>>        //        Forward Send key key_value
50649>>>>>>>>>        //End
50649>>>>>>>>>    //End_Procedure
50649>>>>>>>>>
50649>>>>>>>>>End_Class
50650>>>>>>>>>
50650>>>>>>>>>
50650>>>>>>>>>
50650>>>>>>>
50650>>>>>>>Class DbcheckboxSub Is A Dbcheckbox
50651>>>>>>>
50651>>>>>>>       Procedure Construct_Object
50653>>>>>>>            Forward Send Construct_Object
50655>>>>>>>            Send Docustomizedefaultfloatmenu Default_Dbfloating_Menu_Id
50656>>>>>>>            Send Docustomizedefaultdbfloatmenu Default_Dbfloating_Menu_Id
50657>>>>>>>            //Send Define_DisableAcceleratorKey_Mixin
50657>>>>>>>       End_Procedure
50658>>>>>>>
50658>>>>>>>    Procedure End_Construct_Object
50660>>>>>>>        Forward Send End_Construct_Object
50662>>>>>>>
50662>>>>>>>    End_Procedure //Construct_Object
50663>>>>>>>
50663>>>>>>>
50663>>>>>>>
50663>>>>>>>      Import_Class_Protocol DisableAcceleratorKey_Mixin
50664>>>>>>>
50664>>>>>>>End_Class //DbcheckboxSub
50665>>>>>>>
50665>>>>>USE DBEDIT.Sub      //02. dbedit
Including file: DBEDIT.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBEDIT.SUB)
50665>>>>>>>Use dfClient
50665>>>>>>>Use dfAllent
50665>>>>>>>
50665>>>>>>>Use Editflmn.Ezc
Including file: EDITFLMN.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\EDITFLMN.EZC)
50665>>>>>>>>>Use WIndows
50665>>>>>>>>>Use dfAllent
50665>>>>>>>>>
50665>>>>>>>>>
50665>>>>>>>>>Class cEditFloatingMenu Is A FormFloatingPopupMenu
50666>>>>>>>>>    Procedure Construct_Object
50668>>>>>>>>>        Forward Send Construct_Object
50670>>>>>>>>>        //Customize The Default FloatingPopupMenu (Greeks) - General.pkg - spy 22/10/98
50670>>>>>>>>>        //Send DoCustomizeDefaultFloatMenu Self
50670>>>>>>>>>    End_Procedure
50671>>>>>>>>>End_Class // cClassFloatingMenu
50672>>>>>>>>>
50672>>>>>>>>>//  menu
50672>>>>>>>>>Object oEditFloatingMenu Is A cEditFloatingMenu
50674>>>>>>>>>End_Object
50675>>>>>>>>>
50675>>>>>>>>>//Mixin        edit
50675>>>>>>>>>Class EditFloatingPopupMenu_Mixin is a Mixin
50676>>>>>>>>>
50676>>>>>>>>>    Procedure Define_EditFloatingPopupMenu_Mixin
50678>>>>>>>>>        Property integer Floating_Menu_Object public (oEditFloatingMenu(Self))
50679>>>>>>>>>    End_Procedure
50680>>>>>>>>>
50680>>>>>>>>>      // Message   7 Item  PopupMenu
50680>>>>>>>>>      //Procedure DoSelectWholeText
50680>>>>>>>>>      //   Local Integer liMaxchar
50680>>>>>>>>>      //   // To   
50680>>>>>>>>>      //   ///////////////////////////////////Get edit_buffer_count to liMaxchar
50680>>>>>>>>>      //  Get CharCount to liMaxChar
50680>>>>>>>>>      //   //Select The Whole Text
50680>>>>>>>>>      //   Send Select 0 (liMaxchar+1)
50680>>>>>>>>>      //End_Procedure  // DoSelectWholeText
50680>>>>>>>>>
50680>>>>>>>>>
50680>>>>>>>>>      //   PopupMenu
50680>>>>>>>>>      //Procedure mouse_down2 integer i1 integer i2
50680>>>>>>>>>      //   local integer obj rval limaxchar
50680>>>>>>>>>      //   Forward Send mouse_down2 i1 i2
50680>>>>>>>>>      //   Get Floating_Menu_object to obj
50680>>>>>>>>>      //   //   bject    current   
50680>>>>>>>>>      //   If (Focus(Current_Object)<>Current_Object) ;
50680>>>>>>>>>      //      get msg_Activate to rval
50680>>>>>>>>>      //   //    
50680>>>>>>>>>      //   /////////////////////////////////get edit_buffer_count of (Focus(Self)) to liMaxChar
50680>>>>>>>>>      //  Get CharCount to liMaxChar
50680>>>>>>>>>      //   //   0  shadow to 7o Item  PopupMenu
50680>>>>>>>>>      //   Set Shadow_State of obj Item 7 to (liMaxChar = 0)
50680>>>>>>>>>      //   //  message  7 item
50680>>>>>>>>>      //   Set message of obj Item 7 to DoSelectWholeText
50680>>>>>>>>>      //   Send Popup to obj
50680>>>>>>>>>     //End_Procedure // mouse_down2
50680>>>>>>>>>
50680>>>>>>>>>
50680>>>>>>>>>End_Class   // EditFloatingPopupMenu_Mixin
50681>>>>>>>>>
50681>>>>>>>>>
50681>>>>>>>>>
50681>>>>>>>Use AccKeymx.ezc
50681>>>>>>>
50681>>>>>>>Class DbeditSub Is A cDbTextEdit
50682>>>>>>>
50682>>>>>>>      Procedure Construct_Object
50684>>>>>>>           Forward Send Construct_Object
50686>>>>>>>           Send Define_Editfloatingpopupmenu_Mixin
50687>>>>>>>           //Send Define_Disableacceleratorkey_Mixin
50687>>>>>>>      End_Procedure
50688>>>>>>>
50688>>>>>>>      Import_Class_Protocol Editfloatingpopupmenu_Mixin
50689>>>>>>>      Import_Class_Protocol Disableacceleratorkey_Mixin
50690>>>>>>>
50690>>>>>>>End_Class //DbeditSub
50691>>>>>USE DBCMBFRM.Sub    //03. dbcomboform
Including file: DBCMBFRM.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBCMBFRM.SUB)
50691>>>>>>>Use dfClient
50691>>>>>>>Use dfcdcent
Including file: Dfcdcent.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\Dfcdcent.pkg)
50691>>>>>>>>>// 04/16/96 JJT - Added DD support (if USE$DATA_DICTIONARY is defined)
50691>>>>>>>>>Use DfCentry.pkg
50691>>>>>>>>>Use CodeLoad.pkg // class support for Case_loader_Data_Set
50691>>>>>>>>>Use cCodeMaintOpen_Mixin.pkg
50691>>>>>>>>>
50691>>>>>>>>>  //
50691>>>>>>>>>  //  This is the object we need for loading files.
50691>>>>>>>>>  //
50691>>>>>>>>>  Object Code_loader is a Code_loader_Data_Set no_Image
50693>>>>>>>>>  End_Object
50694>>>>>>>>>
50694>>>>>>>>>
50694>>>>>>>>>Class dbCodeComboForm is a dbComboFormDS
50695>>>>>>>>>
50695>>>>>>>>>    // supports opening of file in reserved filelist area.
50695>>>>>>>>>    Import_Class_Protocol cCodeMaintOpen_Mixin 
50696>>>>>>>>>
50696>>>>>>>>>    Procedure Construct_Object
50698>>>>>>>>>        Forward Send Construct_Object
50700>>>>>>>>>
50700>>>>>>>>>        Send OpenCodeMast                       // methods supports w/ filelist (new) and without (old)
50701>>>>>>>>>
50701>>>>>>>>>        Set Code_File to CodeMast.File_Number   // name of file is CODEMAST
50702>>>>>>>>>        Set Code_Index to 1                     // Index 1: Types x Code
50703>>>>>>>>>        Set Type_Field to 1                     // Fld 1: Type
50704>>>>>>>>>        Set Code_Field to 2                     // Fld 2: Code
50705>>>>>>>>>        Set Description_Field to 3              // Fld 3: Description
50706>>>>>>>>>        Set Code_load_Object  to (Code_Loader(self))
50707>>>>>>>>>    End_Procedure // Construct_Object
50708>>>>>>>>>
50708>>>>>>>>>End_Class
50709>>>>>>>>>
50709>>>>>>>>>
50709>>>>>>>>>
50709>>>>>>>Use Combo_mx.Ezc
Including file: COMBO_MX.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\COMBO_MX.EZC)
50709>>>>>>>>>Use Windows
50709>>>>>>>>>
50709>>>>>>>>>//Define CB_SETDROPPEDWIDTH            for |CI$0160
50709>>>>>>>>>
50709>>>>>>>>>Class Combo_Mixin_Ez is a Mixin
50710>>>>>>>>>
50710>>>>>>>>>    Procedure Define_Combo_Mixin_Ez
50712>>>>>>>>>        Property Integer ListRowCount       0 // how many drop-down rows are required (0 = use size to determine number of rows)
50713>>>>>>>>>        Property Integer ListWidth          0 // width of dropped-down list (0=default width of edit)
50714>>>>>>>>>    End_Procedure // Define_Combo_Mixin_Ez
50715>>>>>>>>>
50715>>>>>>>>>    Procedure DoSetListWidth
50717>>>>>>>>>        Integer iListWidth // required width of drop-down list
50717>>>>>>>>>
50717>>>>>>>>>        Get ListWidth to iListWidth
50718>>>>>>>>>        If (iListWidth <> 0) Begin
50720>>>>>>>>>            Send Windows_Message CB_SETDROPPEDWIDTH iListWidth 0
50721>>>>>>>>>        End
50721>>>>>>>>>>
50721>>>>>>>>>    End_Procedure // DoSetListWidth
50722>>>>>>>>>
50722>>>>>>>>>    Procedure DoSetSize
50724>>>>>>>>>        Integer cyEdit     // height of edit control
50724>>>>>>>>>        Integer cyListItem // height of each item in the drop-down list
50724>>>>>>>>>        Integer icRow      // integer count of  visible rows
50724>>>>>>>>>        Integer cyControl  // height of complete control
50724>>>>>>>>>        Integer cxControl  // width of control
50724>>>>>>>>>
50724>>>>>>>>>        Get ListRowCount to icRow // how many rows are required
50725>>>>>>>>>        If (icRow <>0) Begin
50727>>>>>>>>>            // get height of edit portion
50727>>>>>>>>>            Get WindowsMessage CB_GETITEMHEIGHT -1 0 to cyEdit
50728>>>>>>>>>
50728>>>>>>>>>            // get height of single item in list
50728>>>>>>>>>            Get WindowsMessage CB_GETITEMHEIGHT 0 0 to cyListItem
50729>>>>>>>>>
50729>>>>>>>>>            // calculate required height
50729>>>>>>>>>            Move (cyEdit +8 +(cyListItem *icRow)) to cyControl // 8 is the empirical height of 3d effects
50730>>>>>>>>>
50730>>>>>>>>>            // retain width from initial settings
50730>>>>>>>>>            Move (Low(GuiSize(self))) to cxControl
50731>>>>>>>>>
50731>>>>>>>>>            Set GuiSize to cyControl cxControl
50732>>>>>>>>>        End
50732>>>>>>>>>>
50732>>>>>>>>>
50732>>>>>>>>>    End_Procedure // DoSetSize
50733>>>>>>>>>
50733>>>>>>>>>
50733>>>>>>>>>    Procedure Page integer mode#
50735>>>>>>>>>        Forward Send Page mode#
50737>>>>>>>>>        If (Mode# =1) Begin
50739>>>>>>>>>            Send DoSetListWidth
50740>>>>>>>>>            Send DoSetSize
50741>>>>>>>>>        End
50741>>>>>>>>>>
50741>>>>>>>>>    End_Procedure // Page
50742>>>>>>>>>
50742>>>>>>>>>    Procedure Set Visible_State Integer iState
50744>>>>>>>>>        Forward Set Visible_State to iState
50746>>>>>>>>>        if (Label_Object(self)) ;            Set Visible_State of (Label_Object(self)) to iState
50749>>>>>>>>>    End_Procedure // Visible_State
50750>>>>>>>>>
50750>>>>>>>>>End_Class // Combo_Mixin_Ez
50751>>>>>>>Use AccKeymx.ezc
50751>>>>>>>
50751>>>>>>>Class DbcomboformSub Is A Dbcomboform
50752>>>>>>>
50752>>>>>>>    Procedure Construct_Object
50754>>>>>>>        Forward Send Construct_Object
50756>>>>>>>        //Customize The Default Floatingpopupmenu (Greeks) - General.Pkg 21/09/98 Spy
50756>>>>>>>        Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
50757>>>>>>>        //Customize The Default Dbfloatingpopupmenu (Greeks) - General.Pkg 22/10/98 Spy
50757>>>>>>>        Send Docustomizedefaultdbfloatmenu Default_Dbfloating_Menu_Id
50758>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
50758>>>>>>>        Send Define_Combo_Mixin_Ez
50759>>>>>>>    End_Procedure
50760>>>>>>>
50760>>>>>>>    Procedure Combo_Add_Item_Msg Integer iMsg string sValue
50762>>>>>>>        Integer dataobj
50762>>>>>>>
50762>>>>>>>        If not (Entry_State(Current_Object,0)) Begin
50764>>>>>>>                Get Combo_data_object to dataobj
50765>>>>>>>                If dataobj Begin
50767>>>>>>>                send add_item to dataobj iMsg sValue
50768>>>>>>>                If (Deferred_State(Current_Object)=0 AND Window_Handle(Current_Object)) ;                Send WinCombo_Add_Insert_Value CB_ADDSTRING 0 sValue
50771>>>>>>>                End
50771>>>>>>>>
50771>>>>>>>        End
50771>>>>>>>>
50771>>>>>>>        Else Send Combo_Add_Item sValue
50773>>>>>>>    End_Procedure
50774>>>>>>>
50774>>>>>>>    Procedure Set Combo_Message Integer iItem Integer iValue
50776>>>>>>>        Integer dataobj
50776>>>>>>>
50776>>>>>>>        Get Combo_data_object to dataobj
50777>>>>>>>        If dataobj Set Message of dataobj Item iItem to iValue
50780>>>>>>>    End_Procedure // Combo_Message
50781>>>>>>>
50781>>>>>>>    Function Combo_Message Returns Integer
50783>>>>>>>        Integer dataobj liMsg
50783>>>>>>>
50783>>>>>>>        Get Combo_data_object to dataobj
50784>>>>>>>        If dataobj Get Message of dataobj Item (Combo_Item_Matching(Self,(value(self,0)))) to liMsg
50787>>>>>>>        Function_Return liMsg
50788>>>>>>>    End_Function // Combo_Message
50789>>>>>>>
50789>>>>>>>    Procedure Set Combo_Aux_Value Integer iItem Integer iValue
50791>>>>>>>        Integer dataobj
50791>>>>>>>
50791>>>>>>>        Get Combo_data_object to dataobj
50792>>>>>>>        If dataobj Set Aux_Value of dataobj Item iItem to iValue
50795>>>>>>>    End_Procedure // Combo_Aux_Value
50796>>>>>>>
50796>>>>>>>    Function Combo_Aux_Value Returns Integer
50798>>>>>>>        Integer dataobj liMsg
50798>>>>>>>
50798>>>>>>>        Get Combo_data_object to dataobj
50799>>>>>>>        If dataobj Get Aux_Value of dataobj Item (Combo_Item_Matching(Self,(value(self,0)))) to liMsg
50802>>>>>>>        Function_Return liMsg
50803>>>>>>>    End_Function // Combo_Aux_Value
50804>>>>>>>
50804>>>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
50805>>>>>>>    Import_Class_Protocol Combo_Mixin_Ez
50806>>>>>>>
50806>>>>>>>End_Class //DbcomboformSub
50807>>>>>USE DBFORM.Sub      //04. dbform
Including file: DBFORM.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBFORM.SUB)
50807>>>>>>>Use dfClient
50807>>>>>>>Use dfAllent
50807>>>>>>>Use Tooltip.pkg
Including file: TOOLTIP.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TOOLTIP.PKG)
50807>>>>>>>>>
50807>>>>>>>>>Use dfclient
50807>>>>>>>>>Use dfallent
50807>>>>>>>>>Use WINUSREZ.PKG
50807>>>>>>>>>
50807>>>>>>>>>//========================================================================================
50807>>>>>>>>>//  DNS Technology
50807>>>>>>>>>//
50807>>>>>>>>>//  FileName     : TOOLTIP.PKG
50807>>>>>>>>>//  Author       : S G Munn    (sgmunn@compuserve.com)
50807>>>>>>>>>//  Date Created : 01/10/1997
50807>>>>>>>>>//  Version      : 1.0
50807>>>>>>>>>//
50807>>>>>>>>>//  Purpose      : Tooltip controller
50807>>>>>>>>>//========================================================================================
50807>>>>>>>>>//  Parameters   : none
50807>>>>>>>>>//               :
50807>>>>>>>>>//  Interface    :
50807>>>>>>>>>//               :
50807>>>>>>>>>//========================================================================================
50807>>>>>>>>>//  Usage        : Use tooltip.000 just before the end_object statement of the 'main'
50807>>>>>>>>>//               : object.
50807>>>>>>>>>//               :
50807>>>>>>>>>//               : Also, I have had problems with timers if the dftimer package is used
50807>>>>>>>>>//               : inside the 'main' object.  I use dftimer outside main (just after the
50807>>>>>>>>>//               : 'use dfallent'). (Fixed - SPY 15/11/98)
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :   use tooltip.PKG //Not neccesery anymore with the EZ classes 15/11/98 - SPY
50807>>>>>>>>>//               : end_object // main
50807>>>>>>>>>//               :
50807>>>>>>>>>//               : for any object you want a tool tip for, define the following in the
50807>>>>>>>>>//               : object (or class definition)
50807>>>>>>>>>//               :
50807>>>>>>>>>//               : function TooltipHint returns string
50807>>>>>>>>>//               :     function_return "tool tip string" // or property, or expression etc.
50807>>>>>>>>>//               : end_function
50807>>>>>>>>>//               :
50807>>>>>>>>>//               : <Optional>
50807>>>>>>>>>//               : function TooltipHintObject returns integer
50807>>>>>>>>>//               :     function_return Object_ID_Of_Alternate_Tool_Tip_Object
50807>>>>>>>>>//               : end_function
50807>>>>>>>>>//               :
50807>>>>>>>>>//========================================================================================
50807>>>>>>>>>//  History      :
50807>>>>>>>>>//    Task Id    : none
50807>>>>>>>>>//    Author     : SGM
50807>>>>>>>>>//    Date       : 21/10/1997
50807>>>>>>>>>//    Comments   : Added ability for tool tip timer to 'see' the window handle of objects
50807>>>>>>>>>//               : within a modal panel.
50807>>>>>>>>>//               :
50807>>>>>>>>>//    Task Id    : none
50807>>>>>>>>>//    Author     : SGM
50807>>>>>>>>>//    Date       : 15/12/1997
50807>>>>>>>>>//    Comments   : Fixed bug with getting size and location of panel (it was offset by the
50807>>>>>>>>>//               : panel's caption bar).
50807>>>>>>>>>//               : Removed function requirement to test if object should show a tool tip -
50807>>>>>>>>>//               : return a null tool tip string for no tool tip.
50807>>>>>>>>>//               : Added ability for object to specify a different tool tip object other
50807>>>>>>>>>//               : than the default 'windows like' tool tip.
50807>>>>>>>>>//               : The parent object of this PKG does not have to 'main'.  But the PKG
50807>>>>>>>>>//               : should still be used at the end of the object.
50807>>>>>>>>>//               : Uses PlusPak!'s cTimer class.  This can be changed to use DFTimer
50807>>>>>>>>>//               : by changing the compiler directive TOOLTIP_USE_PLUSPAK_CTIMER to NO
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//    Task Id    : none
50807>>>>>>>>>//    Author     : SGM
50807>>>>>>>>>//    Date       : 15/06/1998
50807>>>>>>>>>//    Comments   : Changed name type POINT to TOOLTIP_POINT to avoid compile problemns
50807>>>>>>>>>//               : with pkg's that define a point type as well.
50807>>>>>>>>>//               :
50807>>>>>>>>>//    Task Id    : none
50807>>>>>>>>>//    Author     : SPY
50807>>>>>>>>>//    Date       : 15/11/98
50807>>>>>>>>>//               : Fixed bug with DFTimer Manager Handler Error (Now Use DfTimer is inside
50807>>>>>>>>>//               : a message Object
50807>>>>>>>>>//               :
50807>>>>>>>>>//    Task Id    : none
50807>>>>>>>>>//    Author     : SPY
50807>>>>>>>>>//    Date       : 15/11/98
50807>>>>>>>>>//               : The Objects StandardToolTip and TooltipTimer now are in Tooltip.inc File
50807>>>>>>>>>//               : that is being included in the End_Construct_Object of the dbView_EZ Class
50807>>>>>>>>>//               : This Must Be changed
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               : TODO.
50807>>>>>>>>>//               : 1. Remove tool tip when mouse is clicked.
50807>>>>>>>>>//               : 2. Allow the 'use tooltip.000' to be anywhere.
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//               :
50807>>>>>>>>>//========================================================================================
50807>>>>>>>>>use Windows
50807>>>>>>>>>Use Txtbox.Sub
Including file: TXTBOX.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TXTBOX.SUB)
50807>>>>>>>>>>>Use Tooltip.pkg
50807>>>>>>>>>>>//Use AccKeymx.ezc
50807>>>>>>>>>>>
50807>>>>>>>>>>>Class TextboxSub Is A Textbox
50808>>>>>>>>>>>
50808>>>>>>>>>>>    Procedure Construct_Object
50810>>>>>>>>>>>        Forward Send Construct_Object
50812>>>>>>>>>>>        Property String TooltipValue Public ""
50813>>>>>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
50813>>>>>>>>>>>    End_Procedure
50814>>>>>>>>>>>
50814>>>>>>>>>>>    Procedure End_Construct_Object
50816>>>>>>>>>>>        Forward Send End_Construct_Object
50818>>>>>>>>>>>    End_Procedure //Construct_Object
50819>>>>>>>>>>>
50819>>>>>>>>>>>    Function TooltipHint returns string
50821>>>>>>>>>>>        Function_Return (TooltipValue(Self))
50822>>>>>>>>>>>    End_function
50823>>>>>>>>>>>
50823>>>>>>>>>>>    //Import_Class_Protocol DisableAcceleratorKey_Mixin
50823>>>>>>>>>>>
50823>>>>>>>>>>>End_Class //TextboxSub
50824>>>>>>>>>>>
50824>>>>>>>>>
50824>>>>>>>>>Object Default_Timer is a Message
50826>>>>>>>>>    use DFTimer        // DF Timer class
Including file: Dftimer.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\Dftimer.pkg)
50826>>>>>>>>>>>//************************************************************************
50826>>>>>>>>>>>//--- DFTimer   Timer package for DataFlex programs
50826>>>>>>>>>>>//
50826>>>>>>>>>>>// Copyright (c) 1983-2002 Data Access Corporation, Miami Florida,
50826>>>>>>>>>>>// All rights reserved.
50826>>>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//************************************************************************
50826>>>>>>>>>>>//  Description:
50826>>>>>>>>>>>//      This package contains all components needed to implement timers
50826>>>>>>>>>>>//      in a DataFlex 4 program.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//  Author: Eddy Kleinjan, Data Access Nederland
50826>>>>>>>>>>>//************************************************************************
50826>>>>>>>>>>>// 03/03/2001 EK  Fixed Timer_Active_State to check for valid windows
50826>>>>>>>>>>>//                handle before trying to set or kill a timer.
50826>>>>>>>>>>>//                Fixed Kill_All_Timers to check for valid windows
50826>>>>>>>>>>>//                handle before trying to kill a timer.
50826>>>>>>>>>>>//                The windows handle might not exist anymore when the
50826>>>>>>>>>>>//                program is being exited using Exit_Application.
50826>>>>>>>>>>>// 12/13/2001 JJT fixed Timer_Active_State to check for -1 (not 0). Fixed a
50826>>>>>>>>>>>//                a bug where set Timeout started inactive timers.
50826>>>>>>>>>>>//                Added code to force timer object to desktop
50826>>>>>>>>>>>//************************************************************************
50826>>>>>>>>>>>// CLASS DFTimer
50826>>>>>>>>>>>//
50826>>>>>>>>>>>// Usage:
50826>>>>>>>>>>>//    Object MyTimer is a DFTimer
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//        Set Timeout to 2000                             // Default 1000
50826>>>>>>>>>>>//        Set Auto_Start_State to TRUE|FALSE              // Default TRUE
50826>>>>>>>>>>>//        Set Auto_Stop_State to TRUE|FALSE               // Default TRUE
50826>>>>>>>>>>>//        Set Timer_Message to MyMessage                  // Default 0
50826>>>>>>>>>>>//        Set Timer_Object to (MyObject(self))            // Default 0
50826>>>>>>>>>>>//        Set Timer_Active_State to TRUE|FALSE            // Default FALSE
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//        // Augment when no Timer_Message
50826>>>>>>>>>>>//        Procedure OnTimer
50826>>>>>>>>>>>//            Send Info_Box "HEY, WAKE UP!"
50826>>>>>>>>>>>//        End_Procedure
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    End_Object
50826>>>>>>>>>>>//
50826>>>>>>>>>>>// DESCRIPTION
50826>>>>>>>>>>>//      Objects of this class can be used to trigger an event after a
50826>>>>>>>>>>>//      certain amount of time has passed. You can specify this time
50826>>>>>>>>>>>//      by setting the Timeout property of the object. This timeout
50826>>>>>>>>>>>//      is in miliseconds.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//      Whenever a timer event happens, it will notify the object by
50826>>>>>>>>>>>//      sending an OnTimer event. You can trap this event to do whatever
50826>>>>>>>>>>>//      you want the timer to do. By default this OnTimer event
50826>>>>>>>>>>>//      will send the Timer_Message to Timer_Object, when these have
50826>>>>>>>>>>>//      been specified.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//      By default, you have to activate a timer by setting its
50826>>>>>>>>>>>//      Timer_Active_State to TRUE. When the timer has been placed
50826>>>>>>>>>>>//      inside a user-interface object, it can also be activated
50826>>>>>>>>>>>//      automatically when this user-interface object is being
50826>>>>>>>>>>>//      activated. This only happes when it Auto_Start_State is TRUE,
50826>>>>>>>>>>>//      which is the default setting. In such a case, the timer will
50826>>>>>>>>>>>//      also automatically being stopped when the user-interface
50826>>>>>>>>>>>//      object is taken of the screen. This depends on the
50826>>>>>>>>>>>//      Auto_Stop_Timer state to happen.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//      When you need to set a new timeout value, you can do so
50826>>>>>>>>>>>//      even when the timer is active. It will adjust the timeout
50826>>>>>>>>>>>//      immediately.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//      Note that timer events depend on Windows for the delivery of
50826>>>>>>>>>>>//      the event. Since timer events get a low priority in Windows,
50826>>>>>>>>>>>//      it might put your program on hold when other programs are very
50826>>>>>>>>>>>//      busy. In such a case, you will only receive one timer event
50826>>>>>>>>>>>//      after the process stopped. There is no way, other than
50826>>>>>>>>>>>//      calculating it yourself, to determine how many time has passed
50826>>>>>>>>>>>//      or how many timer event should have happened since the last
50826>>>>>>>>>>>//      timer event or timer activation.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>// PUBLIC INTERFACE
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    PROPERTIES
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Auto_Start_State When TRUE (default) the timer will be activated
50826>>>>>>>>>>>//                     automatically when the object will be (virtually)
50826>>>>>>>>>>>//                     paged on the screen.
50826>>>>>>>>>>>//                     Example: When a timer object has been placed
50826>>>>>>>>>>>//                     inside a view, then the timer will be activated
50826>>>>>>>>>>>//                     when the view is activated.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Auto_Stop_State  When TRUE (default) the timer will be deactivated
50826>>>>>>>>>>>//                     automatically when the object will be (virtually)
50826>>>>>>>>>>>//                     taken off the screen.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Timeout          The timeout value for the timer to fire. The
50826>>>>>>>>>>>//                     timeout value must be set in miliseconds.
50826>>>>>>>>>>>//                     This property may be set even when the timer is
50826>>>>>>>>>>>//                     active. The new timeout value will be applied
50826>>>>>>>>>>>//                     immediately.
50826>>>>>>>>>>>//                     NOTE: The timeout set here is never precise. It
50826>>>>>>>>>>>//                     depends on Windows to deliver the message to our
50826>>>>>>>>>>>//                     application.
50826>>>>>>>>>>>//                     Default 1000.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Timer_Active_State
50826>>>>>>>>>>>//                     Set to TRUE to activate the timer, to FALSE to
50826>>>>>>>>>>>//                     deactivate the timer.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Timer_Message    This property can be set to a messageID which has
50826>>>>>>>>>>>//                     to be sent whenever a timer event occurs. Default
50826>>>>>>>>>>>//                     this message will be send to the object itself
50826>>>>>>>>>>>//                     unless a Timer_Object as been specified.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Timer_Object     This property can be set to an objectID which has
50826>>>>>>>>>>>//                     to receive the Timer_Message whenever a timer
50826>>>>>>>>>>>//                     event occurs. This value has no meaning when
50826>>>>>>>>>>>//                     no Timer_Message has been set.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    METHODS
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    OnTimer          This event will happen whenever the specified
50826>>>>>>>>>>>//                     amount of time has passed and the timer is
50826>>>>>>>>>>>//                     active. By default it sends the message in
50826>>>>>>>>>>>//                     the Timer_Message property to the object in
50826>>>>>>>>>>>//                     the Timer_Object when these have been specified.
50826>>>>>>>>>>>//                     When you don't need this, you can just override
50826>>>>>>>>>>>//                     the OnTimer event.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>// PUBLIC INTERFACE
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Page_Object      Has been augmented to auto_start the timer when
50826>>>>>>>>>>>//                     it becomes active as part or a user-interface
50826>>>>>>>>>>>//                     object.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Page_Delete      Has been augmented to auto_stop the timer when
50826>>>>>>>>>>>//                     it is deactivated as part or a user-interface
50826>>>>>>>>>>>//                     object.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>//    Destroy_Object   Has been augmented to deactivate the timer.
50826>>>>>>>>>>>//
50826>>>>>>>>>>>Use LanguageText.pkg
50826>>>>>>>>>>>Use Windows.pkg
50826>>>>>>>>>>>Use WinUser.pkg
50826>>>>>>>>>>>
50826>>>>>>>>>>>External_Function SetTimer "SetTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Integer idTimeout ;    Pointer tmprc ;    Returns Integer
50827>>>>>>>>>>>
50827>>>>>>>>>>>External_Function KillTimer "KillTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Returns Integer
50828>>>>>>>>>>>
50828>>>>>>>>>>>// This global integer holds the ID of the object
50828>>>>>>>>>>>// that manages all timers.
50828>>>>>>>>>>>Integer giTimerManager
50828>>>>>>>>>>>
50828>>>>>>>>>>>// This class is used to store the object IDs
50828>>>>>>>>>>>// of the active timer objects. It augments
50828>>>>>>>>>>>// the Destroy_Object procedure to notify
50828>>>>>>>>>>>// the DFTimerManager to kill all its active
50828>>>>>>>>>>>// timers.
50828>>>>>>>>>>>// NOTE: This class looks very much like the
50828>>>>>>>>>>>// Set class. I didn't want to use Set because
50828>>>>>>>>>>>// Remove_Element shifts items which I don't
50828>>>>>>>>>>>// want to happen because item numbers are used
50828>>>>>>>>>>>// as timerIDs.
50828>>>>>>>>>>>
50828>>>>>>>>>>>Class TimersArray is an Array
50829>>>>>>>>>>>
50829>>>>>>>>>>>    Function Find_Object Integer iObj Returns Integer
50831>>>>>>>>>>>        Integer iMax
50831>>>>>>>>>>>        Integer iItem
50831>>>>>>>>>>>        Integer iValue
50831>>>>>>>>>>>        Get Item_count to iMax
50832>>>>>>>>>>>        Decrement iMax
50833>>>>>>>>>>>        For iItem from 1 to iMax
50839>>>>>>>>>>>>
50839>>>>>>>>>>>            Get Integer_Value item iItem to iValue
50840>>>>>>>>>>>            If iValue EQ iObj;                Function_Return iItem
50843>>>>>>>>>>>        Loop
50844>>>>>>>>>>>>
50844>>>>>>>>>>>        Function_Return -1
50845>>>>>>>>>>>    End_Function
50846>>>>>>>>>>>
50846>>>>>>>>>>>    Procedure Add_Object Integer iObj Returns Integer
50848>>>>>>>>>>>        Integer iItem
50848>>>>>>>>>>>        Get Find_Object iObj to iItem
50849>>>>>>>>>>>        If iItem LT 0 Begin
50851>>>>>>>>>>>            Get Find_Object 0 to iItem
50852>>>>>>>>>>>            If iItem LT 0 ;                Get Item_Count to iItem
50855>>>>>>>>>>>        End
50855>>>>>>>>>>>>
50855>>>>>>>>>>>        Set Array_Value item iItem to iObj
50856>>>>>>>>>>>        Procedure_Return iItem
50857>>>>>>>>>>>    End_Procedure
50858>>>>>>>>>>>
50858>>>>>>>>>>>    Procedure Remove_Object Integer iObj
50860>>>>>>>>>>>        Integer iItem
50860>>>>>>>>>>>        Get Find_Object iObj to iItem
50861>>>>>>>>>>>        If iItem GT 0 ;            Set Array_Value item iItem to 0
50864>>>>>>>>>>>    End_Procedure
50865>>>>>>>>>>>
50865>>>>>>>>>>>    Procedure Destroy_Object
50867>>>>>>>>>>>        Delegate Send Kill_All_Timers
50869>>>>>>>>>>>        Forward Send Destroy_Object
50871>>>>>>>>>>>    End_Procedure
50872>>>>>>>>>>>
50872>>>>>>>>>>>End_Class // TimersArray
50873>>>>>>>>>>>
50873>>>>>>>>>>>// This class is the actual timer manager
50873>>>>>>>>>>>// A timer will be created when Message Set_Timer_Active_State
50873>>>>>>>>>>>// has been send. This message needs two arguments. The first
50873>>>>>>>>>>>// is the objectID of the object to receive the timer event,
50873>>>>>>>>>>>// and the second is state. The object which ID has been passed,
50873>>>>>>>>>>>// needs to have a Timeout property to return the timeout for the
50873>>>>>>>>>>>// timer and it also needs to handle the MSG_OnTimer whenever a
50873>>>>>>>>>>>// timer event occurs.
50873>>>>>>>>>>>// The objectID of the Object will be placed in an array which contains
50873>>>>>>>>>>>// the objectIDs of all active timers. The Windows timer ID of a timer
50873>>>>>>>>>>>// is the itemnumber of the object in the array.
50873>>>>>>>>>>>//
50873>>>>>>>>>>>Class DFTimerManager is a DfBaseControl
50874>>>>>>>>>>>
50874>>>>>>>>>>>    Procedure Construct_Object
50876>>>>>>>>>>>
50876>>>>>>>>>>>        Forward Send Construct_Object
50878>>>>>>>>>>>
50878>>>>>>>>>>>        Set Visible_State to FALSE
50879>>>>>>>>>>>
50879>>>>>>>>>>>        Set External_Class_Name "cVdfTimer" to "static"
50880>>>>>>>>>>>        Set External_Message WM_TIMER to OnTimer
50881>>>>>>>>>>>
50881>>>>>>>>>>>        Object TimersArray is a TimersArray
50883>>>>>>>>>>>            Set Array_Value item 0 to -9999 // So we don't use item 0
50884>>>>>>>>>>>        End_Object
50885>>>>>>>>>>>
50885>>>>>>>>>>>        Move self to giTimerManager
50886>>>>>>>>>>>
50886>>>>>>>>>>>    End_Procedure
50887>>>>>>>>>>>
50887>>>>>>>>>>>    Procedure Set Timer_Active_State Integer iObj Integer iState
50889>>>>>>>>>>>        Integer iTimerID
50889>>>>>>>>>>>        Integer iTimeout
50889>>>>>>>>>>>        Integer iResult
50889>>>>>>>>>>>        Integer iSet
50889>>>>>>>>>>>        Dword   nResult
50889>>>>>>>>>>>        Handle  hWnd
50889>>>>>>>>>>>
50889>>>>>>>>>>>        // Get the handle of this object
50889>>>>>>>>>>>        Get Window_Handle to hWnd
50890>>>>>>>>>>>        If (Not(hWnd)) Begin
50892>>>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
50893>>>>>>>>>>>>
50893>>>>>>>>>>>            Procedure_Return
50894>>>>>>>>>>>        End
50894>>>>>>>>>>>>
50894>>>>>>>>>>>
50894>>>>>>>>>>>        // Test if handle is valid. If not, we leave.
50894>>>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
50897>>>>>>>>>>>
50897>>>>>>>>>>>        Move (TimersArray(self)) to iSet
50898>>>>>>>>>>>
50898>>>>>>>>>>>        If (iSet) Begin
50900>>>>>>>>>>>
50900>>>>>>>>>>>            // Let's create or modify a timer
50900>>>>>>>>>>>            If iState Begin
50902>>>>>>>>>>>
50902>>>>>>>>>>>                // Get the exising to new TimerID
50902>>>>>>>>>>>                Get MSG_Add_Object of iSet iObj to iTimerID
50903>>>>>>>>>>>
50903>>>>>>>>>>>                // Set/Modify the timer
50903>>>>>>>>>>>                Get Timeout of iObj to iTimeout
50904>>>>>>>>>>>                Move (SetTimer(hWnd, iTimerID, iTimeout, 0)) to iResult
50905>>>>>>>>>>>                If Not iResult Begin
50907>>>>>>>>>>>                    Error DFERR_DFTIMER C_$TooManyTimers
50908>>>>>>>>>>>>
50908>>>>>>>>>>>                    Procedure_Return
50909>>>>>>>>>>>                End
50909>>>>>>>>>>>>
50909>>>>>>>>>>>
50909>>>>>>>>>>>            End
50909>>>>>>>>>>>>
50909>>>>>>>>>>>
50909>>>>>>>>>>>            // Let's kill an existing timer
50909>>>>>>>>>>>            Else Begin
50910>>>>>>>>>>>
50910>>>>>>>>>>>                // Look up the object in the set
50910>>>>>>>>>>>                Get Find_Object of iSet iObj to iTimerID
50911>>>>>>>>>>>
50911>>>>>>>>>>>                If iTimerID EQ -1 ;                    Procedure_Return
50914>>>>>>>>>>>
50914>>>>>>>>>>>                // Kill the timer
50914>>>>>>>>>>>                Move (KillTimer(hWnd, iTimerID)) to iResult
50915>>>>>>>>>>>                If Not iResult Begin
50917>>>>>>>>>>>                    Move (GetLastError()) to nResult
50918>>>>>>>>>>>                    Error DFERR_DFTIMER (C_$CantKillTimer * string(nResult) - "!")
50919>>>>>>>>>>>>
50919>>>>>>>>>>>                    Procedure_Return
50920>>>>>>>>>>>                End
50920>>>>>>>>>>>>
50920>>>>>>>>>>>
50920>>>>>>>>>>>                // Remove the objectID
50920>>>>>>>>>>>                Send Remove_Object to iSet iObj
50921>>>>>>>>>>>            End
50921>>>>>>>>>>>>
50921>>>>>>>>>>>        End
50921>>>>>>>>>>>>
50921>>>>>>>>>>>    End_Procedure
50922>>>>>>>>>>>
50922>>>>>>>>>>>    Function Timer_Active_State Integer iObj Returns Integer
50924>>>>>>>>>>>        Integer iResult
50924>>>>>>>>>>>        Get Find_Object of (TimersArray(self)) iObj to iResult
50925>>>>>>>>>>>        Function_Return (iResult<>-1) // note: -1= not found
50926>>>>>>>>>>>    End_Function
50927>>>>>>>>>>>
50927>>>>>>>>>>>    // Will be called by the Set when it is being destroyed.
50927>>>>>>>>>>>    Procedure Kill_All_Timers
50929>>>>>>>>>>>        Integer iMax
50929>>>>>>>>>>>        Integer iSet
50929>>>>>>>>>>>        Integer iItem
50929>>>>>>>>>>>        Integer iObj
50929>>>>>>>>>>>        Integer iResult
50929>>>>>>>>>>>        Handle  hWnd
50929>>>>>>>>>>>
50929>>>>>>>>>>>        // Get the handle of this object
50929>>>>>>>>>>>        Get Window_Handle to hWnd
50930>>>>>>>>>>>        If (Not(hWnd)) Begin
50932>>>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
50933>>>>>>>>>>>>
50933>>>>>>>>>>>            Procedure_Return
50934>>>>>>>>>>>        End
50934>>>>>>>>>>>>
50934>>>>>>>>>>>
50934>>>>>>>>>>>        // If the window handle is no longer valid, we
50934>>>>>>>>>>>        // leave this procedure. This can happen when the
50934>>>>>>>>>>>        // program is begin aborted using Exit_Application
50934>>>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
50937>>>>>>>>>>>
50937>>>>>>>>>>>        // Scan the set and kill all known timers
50937>>>>>>>>>>>        Move (TimersArray(self)) to iSet
50938>>>>>>>>>>>        If (iSet) Begin
50940>>>>>>>>>>>            Get Item_Count of iSet to iMax
50941>>>>>>>>>>>            Decrement iMax
50942>>>>>>>>>>>            For iItem From 1 to iMax
50948>>>>>>>>>>>>
50948>>>>>>>>>>>                Get Integer_Value of iSet item iItem to iObj
50949>>>>>>>>>>>                If iObj Begin
50951>>>>>>>>>>>                    Move (KillTimer(hWnd, iItem)) to iResult
50952>>>>>>>>>>>                    Set Array_Value of iSet item iItem to 0
50953>>>>>>>>>>>                End
50953>>>>>>>>>>>>
50953>>>>>>>>>>>            Loop
50954>>>>>>>>>>>>
50954>>>>>>>>>>>        End
50954>>>>>>>>>>>>
50954>>>>>>>>>>>
50954>>>>>>>>>>>    End_Procedure
50955>>>>>>>>>>>
50955>>>>>>>>>>>    Procedure OnTimer Integer wParam Integer lParam
50957>>>>>>>>>>>        Integer iObj
50957>>>>>>>>>>>        Get Integer_Value of (TimersArray(self)) item wParam to iObj
50958>>>>>>>>>>>        If Not iObj Begin
50960>>>>>>>>>>>            Error DFERR_DFTIMER C_$TimerWithoutObject
50961>>>>>>>>>>>>
50961>>>>>>>>>>>            Procedure_Return
50962>>>>>>>>>>>        End
50962>>>>>>>>>>>>
50962>>>>>>>>>>>        Send OnTimer to iObj wParam lParam
50963>>>>>>>>>>>    End_Procedure
50964>>>>>>>>>>>
50964>>>>>>>>>>>    Procedure Destroy_Object
50966>>>>>>>>>>>        Send Kill_All_Timers
50967>>>>>>>>>>>        Forward Send Destroy_Object
50969>>>>>>>>>>>        Move 0 to giTimerManager
50970>>>>>>>>>>>    End_Procedure
50971>>>>>>>>>>>
50971>>>>>>>>>>>End_Class // DFTimerManger
50972>>>>>>>>>>>
50972>>>>>>>>>>>
50972>>>>>>>>>>>
50972>>>>>>>>>>>
50972>>>>>>>>>>>// This class acts as a container for the
50972>>>>>>>>>>>// timer manager object. This is needed because
50972>>>>>>>>>>>// A DFTimerManager object created directly at the
50972>>>>>>>>>>>// desktop doesn't have a Window_Handle which we
50972>>>>>>>>>>>// need to create a Windoows timer. By placing
50972>>>>>>>>>>>// this non-visual container around the timer
50972>>>>>>>>>>>// manager, it does get a Window_Handle.
50972>>>>>>>>>>>// The procedure End_Construct_Object has been
50972>>>>>>>>>>>// augmented to create a window and also
50972>>>>>>>>>>>// automatically page all children, which will
50972>>>>>>>>>>>// be the timer manager.
50972>>>>>>>>>>>//
50972>>>>>>>>>>>Class DFTimerManagerPanel is a dfBasePanel
50973>>>>>>>>>>>
50973>>>>>>>>>>>    Procedure Construct_Object
50975>>>>>>>>>>>        Forward Send Construct_Object
50977>>>>>>>>>>>        Set Visible_State to FALSE
50978>>>>>>>>>>>        Object DFTimerManager is a DFTimerManager
50980>>>>>>>>>>>        End_Object
50981>>>>>>>>>>>    End_Procedure
50982>>>>>>>>>>>
50982>>>>>>>>>>>    Procedure End_Construct_Object
50984>>>>>>>>>>>        Forward Send End_Construct_Object
50986>>>>>>>>>>>        Send Page_Object TRUE
50987>>>>>>>>>>>        Broadcast Send Page_Object TRUE
50989>>>>>>>>>>>    End_Procedure
50990>>>>>>>>>>>
50990>>>>>>>>>>>End_Class
50991>>>>>>>>>>>
50991>>>>>>>>>>>// This is the class the user uses to create DFTimer objects
50991>>>>>>>>>>>
50991>>>>>>>>>>>
50991>>>>>>>>>>>//{ OverrideProperty=Skip_State DesignTime=False }
50991>>>>>>>>>>>//{ OverrideProperty=TypeFace DesignTime=False }
50991>>>>>>>>>>>Class DFTimer is a Textbox
50992>>>>>>>>>>>
50992>>>>>>>>>>>    Procedure Construct_Object
50994>>>>>>>>>>>        Forward Send Construct_Object
50996>>>>>>>>>>>
50996>>>>>>>>>>>        // Make sure this object never appears
50996>>>>>>>>>>>        Set Visible_State to FALSE
50997>>>>>>>>>>>
50997>>>>>>>>>>>        Property Integer Private.Timeout    1000
50998>>>>>>>>>>>
50998>>>>>>>>>>>        Property Integer Timer_Message      0
50999>>>>>>>>>>>        Property Integer Timer_Object       0
51000>>>>>>>>>>>        Property Integer Auto_Start_State   True
51001>>>>>>>>>>>        Property Integer Auto_Stop_State    True
51002>>>>>>>>>>>    End_Procedure
51003>>>>>>>>>>>
51003>>>>>>>>>>>    Procedure Set Timer_Active_State Integer iState
51005>>>>>>>>>>>        Integer iObj
51005>>>>>>>>>>>        Move self to iObj
51006>>>>>>>>>>>        If giTimerManager ;            Set Timer_Active_State of giTimerManager iObj to iState
51009>>>>>>>>>>>    End_Procedure
51010>>>>>>>>>>>
51010>>>>>>>>>>>    Function Timer_Active_State Returns Integer
51012>>>>>>>>>>>        Integer iState
51012>>>>>>>>>>>        Integer iObj
51012>>>>>>>>>>>        Move self to iObj
51013>>>>>>>>>>>        If giTimerManager ;            Get Timer_Active_State of giTimerManager iObj to iState
51016>>>>>>>>>>>        Function_Return iState
51017>>>>>>>>>>>    End_Function
51018>>>>>>>>>>>
51018>>>>>>>>>>>    Procedure Set Timeout Integer iTimeout
51020>>>>>>>>>>>        Integer iActive
51020>>>>>>>>>>>        Set Private.Timeout to iTimeout
51021>>>>>>>>>>>        Get Timer_Active_State to iActive
51022>>>>>>>>>>>        If iActive ;            Set Timer_Active_State to TRUE
51025>>>>>>>>>>>    End_Procedure
51026>>>>>>>>>>>
51026>>>>>>>>>>>    Function Timeout Returns Integer
51028>>>>>>>>>>>        Integer iTimeout
51028>>>>>>>>>>>        Get Private.Timeout to iTimeout
51029>>>>>>>>>>>        Function_Return iTimeout
51030>>>>>>>>>>>    End_Function
51031>>>>>>>>>>>
51031>>>>>>>>>>>    Procedure OnTimer Integer iwParam Integer ilParam
51033>>>>>>>>>>>        Integer iMsg
51033>>>>>>>>>>>        Integer iObj
51033>>>>>>>>>>>        Get Timer_Message to iMsg
51034>>>>>>>>>>>        If (iMsg) Begin
51036>>>>>>>>>>>            Get Timer_Object  to iObj
51037>>>>>>>>>>>            If iObj ;                Send iMsg to iObj iwParam ilParam
51040>>>>>>>>>>>            Else ;                Send iMsg iwParam ilParam
51042>>>>>>>>>>>        End
51042>>>>>>>>>>>>
51042>>>>>>>>>>>    End_Procedure
51043>>>>>>>>>>>
51043>>>>>>>>>>>    // Augmented to Auto_Start a timer
51043>>>>>>>>>>>    //
51043>>>>>>>>>>>    Procedure Page_Object Integer iState
51045>>>>>>>>>>>        Forward Send Page_Object iState
51047>>>>>>>>>>>        If (iState AND Auto_Start_State(self)) ;            Set Timer_Active_State to TRUE
51050>>>>>>>>>>>    End_Procedure
51051>>>>>>>>>>>
51051>>>>>>>>>>>    // Augmented to Auto_Stop a timer
51051>>>>>>>>>>>    //
51051>>>>>>>>>>>    Procedure Page_Delete
51053>>>>>>>>>>>        If (Auto_Stop_State(self)) ;            Set Timer_Active_State to FALSE
51056>>>>>>>>>>>        Forward Send Page_Delete
51058>>>>>>>>>>>    End_Procedure
51059>>>>>>>>>>>
51059>>>>>>>>>>>    // Augmented to stop the timer
51059>>>>>>>>>>>    //
51059>>>>>>>>>>>    Procedure Destroy_Object
51061>>>>>>>>>>>        Set Timer_Active_State to FALSE
51062>>>>>>>>>>>        Forward Send Destroy_Object
51064>>>>>>>>>>>    End_Procedure
51065>>>>>>>>>>>
51065>>>>>>>>>>>End_Class // DFTimer
51066>>>>>>>>>>>
51066>>>>>>>>>>>//
51066>>>>>>>>>>>// This was moved into a method so it can be reliable created
51066>>>>>>>>>>>// at the desktop. Note that cDesktop adds method to cDesktop class (class of desktop)
51066>>>>>>>>>>>//
51066>>>>>>>>>>>Procedure CreateDfTimerManagerPanel FOR cDesktop
51068>>>>>>>>>>>    // Create the Desktop Timer Manager Object.
51068>>>>>>>>>>>    Object DFTimerManagerPanel is a DFTimerManagerPanel
51070>>>>>>>>>>>    End_Object
51071>>>>>>>>>>>End_Procedure
51072>>>>>>>>>>>
51072>>>>>>>>>>>Send CreateDfTimerManagerPanel of DESKTOP
51073>>>>>>>>>>>
51073>>>>>>>>>End_Object
51074>>>>>>>>>
51074>>>>>>>>>integer TooltipControllerID     // the object id of the tool tip timer
51074>>>>>>>>>integer DefaultTooltipHintID    // the object id of the default tool tip object
51074>>>>>>>>>
51074>>>>>>>>>// Point type
51074>>>>>>>>>type TOOLTIP_POINT
51074>>>>>>>>>    field TOOLTIP_POINT.X as dword
51074>>>>>>>>>    field TOOLTIP_POINT.Y as dword
51074>>>>>>>>>end_type
51074>>>>>>>>>
51074>>>>>>>>>// default function for objects, returns the hint string of an object
51074>>>>>>>>>function TooltipHint for DFObject returns string
51076>>>>>>>>>    function_return ""
51077>>>>>>>>>end_function
51078>>>>>>>>>
51078>>>>>>>>>// default function for objects, returns the hint object of an object
51078>>>>>>>>>function TooltipHintObject for DFObject returns string
51080>>>>>>>>>    function_return DefaultTooltipHintID
51081>>>>>>>>>end_function
51082>>>>>>>>>
51082>>>>>>>>>// SGM : 21/10/1997
51082>>>>>>>>>// this is a hook for us to get the window handle of a dfpanel class object.
51082>>>>>>>>>// this will either be the 'main' window handle, or a dialog's window handle.
51082>>>>>>>>>function WindowHandleForToolTip for DFPanel returns integer
51084>>>>>>>>>    local integer hd
51084>>>>>>>>>    get Window_Handle to hd
51085>>>>>>>>>    function_return hd
51086>>>>>>>>>end_function
51087>>>>>>>>>
51087>>>>>>>>>// returns the DF object id that is currently under the mouse.
51087>>>>>>>>>// the 'side effect' of this is that it will return the df object id of
51087>>>>>>>>>// ANY df object (even ones in a different VDF program!)
51087>>>>>>>>>function GetDFObjectUnderMouse global returns integer
51089>>>>>>>>>    local string  pnt    //  a TOOLTIP_POINT type
51089>>>>>>>>>    local pointer pPnt   //  a pointer to a TOOLTIP_POINT type
51089>>>>>>>>>    local integer xx     //  x location
51089>>>>>>>>>    local integer yy     //  y location
51089>>>>>>>>>    local handle  hd     //  handle of window under mouse
51089>>>>>>>>>    local integer iObj   //  the DF object under the mouse location
51089>>>>>>>>>
51089>>>>>>>>>    filltype TOOLTIP_POINT with 0 to pnt
51090>>>>>>>>>
51090>>>>>>>>>    GetAddress of pnt to pPnt
51091>>>>>>>>>
51091>>>>>>>>>    move (GetCursorPos(pPnt)) to windowindex
51092>>>>>>>>>
51092>>>>>>>>>    getbuff from pnt at TOOLTIP_POINT.X to xx
51093>>>>>>>>>    getbuff from pnt at TOOLTIP_POINT.Y to yy
51094>>>>>>>>>
51094>>>>>>>>>    move (WindowFromPoint(xx,yy)) to hd
51095>>>>>>>>>
51095>>>>>>>>>    Get_Object_From_Window hd to iObj
51096>>>>>>>>>
51096>>>>>>>>>    function_return iObj
51097>>>>>>>>>end_function
51098>>>>>>>>>
51098>>>>>>>>>//========================================================================================
51098>>>>>>>>>//  Name         : StandardToolTipLabel000
51098>>>>>>>>>//  Purpose      : Our 'label' in the standard tool tip object.
51098>>>>>>>>>//========================================================================================
51098>>>>>>>>>class StandardToolTipLabel000 is a TextboxSub
51099>>>>>>>>>    // A form is used because a text box doesn't set object_color to 4103 4120
51099>>>>>>>>>    // which is the windows tool tip hint color.
51099>>>>>>>>>
51099>>>>>>>>>
51099>>>>>>>>>    //====================================================================================
51099>>>>>>>>>    //  Name         : Construct_Object
51099>>>>>>>>>    //  Scope        : PRIVATE
51099>>>>>>>>>    //  Purpose      : Augmentation
51099>>>>>>>>>    //====================================================================================
51099>>>>>>>>>    procedure Construct_Object
51101>>>>>>>>>        forward send Construct_Object
51103>>>>>>>>>        //set Object_Color to 4103 4120
51103>>>>>>>>>        Set Color to 14811135
51104>>>>>>>>>        Set TextColor to clNavy
51105>>>>>>>>>        set Border_Style to BORDER_NONE    // weird how border none still gives a border for a form
51106>>>>>>>>>        set Focus_Mode   to NONFOCUSABLE
51107>>>>>>>>>    end_procedure
51108>>>>>>>>>
51108>>>>>>>>>    //====================================================================================
51108>>>>>>>>>    //  Name         : Autosize
51108>>>>>>>>>    //  Scope        : PRIVATE
51108>>>>>>>>>    //  Purpose      : Auto size the label
51108>>>>>>>>>    //====================================================================================
51108>>>>>>>>>    // borrowed from textbox
51108>>>>>>>>>    procedure Autosize String Val
51110>>>>>>>>>        local integer ext
51110>>>>>>>>>        get Text_Extent (ToAnsi(Val)) to ext
51111>>>>>>>>>        //Set Guisize To (Hi(Ext)+3) (Low(Ext)+2)
51111>>>>>>>>>
51111>>>>>>>>>        // some hard coded sizes, works though
51111>>>>>>>>>        set Guisize to (hi(Ext)+8) (low(Ext)+5)
51112>>>>>>>>>        send Adjust_logicals
51113>>>>>>>>>    end_procedure
51114>>>>>>>>>
51114>>>>>>>>>    //====================================================================================
51114>>>>>>>>>    //  Name         : UpdateTip
51114>>>>>>>>>    //  Scope        : PUBLIC
51114>>>>>>>>>    //  Purpose      : Update the tool tip with the new one
51114>>>>>>>>>    //====================================================================================
51114>>>>>>>>>    procedure UpdateTip string sTip
51116>>>>>>>>>        // pad with some spaces 'cause we want a 'border' around the text
51116>>>>>>>>>        set Value Item 0 to ("  " + sTip + "  ")
51117>>>>>>>>>        send Autosize (" " + sTip + " ")
51118>>>>>>>>>    end_procedure
51119>>>>>>>>>
51119>>>>>>>>>    //====================================================================================
51119>>>>>>>>>    //  Name         : ToolTipValue
51119>>>>>>>>>    //  Scope        : PUBLIC
51119>>>>>>>>>    //  Purpose      : What is the current tool tip value
51119>>>>>>>>>    //====================================================================================
51119>>>>>>>>>    function ToolTipValue returns string
51121>>>>>>>>>        // return the trim of the value for comparisons
51121>>>>>>>>>        function_return (trim( (Value(current_object,0)) ))
51122>>>>>>>>>    end_function
51123>>>>>>>>>end_class
51124>>>>>>>>>
51124>>>>>>>>>
51124>>>>>>>>>//========================================================================================
51124>>>>>>>>>//  Name         : StandardToolTip000
51124>>>>>>>>>//  Purpose      : The standard tool tip class, looks like the normal windows one.
51124>>>>>>>>>//========================================================================================
51124>>>>>>>>>class StandardToolTip000 is a ToolPanel
51125>>>>>>>>>
51125>>>>>>>>>    //====================================================================================
51125>>>>>>>>>    //  Name         :
51125>>>>>>>>>    //  Scope        : PRIVATE
51125>>>>>>>>>    //  Purpose      :
51125>>>>>>>>>    //====================================================================================
51125>>>>>>>>>
51125>>>>>>>>>    //====================================================================================
51125>>>>>>>>>    //  Name         : Construct_Object
51125>>>>>>>>>    //  Scope        : PRIVATE
51125>>>>>>>>>    //  Purpose      : Augmentation
51125>>>>>>>>>    //====================================================================================
51125>>>>>>>>>    procedure Construct_Object
51127>>>>>>>>>        forward send Construct_Object
51129>>>>>>>>>        set Border_Style  to BORDER_NORMAL
51130>>>>>>>>>        set Caption_Bar   to false
51131>>>>>>>>>        set Visible_State to false
51132>>>>>>>>>        //set Object_Color  to 4103 4120
51132>>>>>>>>>        Set Color to 14811135
51133>>>>>>>>>        Set TextColor to clNavy
51134>>>>>>>>>
51134>>>>>>>>>        // our 'text label' for the tool tip.
51134>>>>>>>>>        object ToolTipLabel is a StandardToolTipLabel000
51136>>>>>>>>>            set Location     to -2 -2
51137>>>>>>>>>        end_object
51138>>>>>>>>>    end_procedure
51139>>>>>>>>>
51139>>>>>>>>>    //====================================================================================
51139>>>>>>>>>    //  Name         : LocateToolTip
51139>>>>>>>>>    //  Scope        : PRIVATE
51139>>>>>>>>>    //  Purpose      : locate the tip just below the mouse (at least off the hot spot)
51139>>>>>>>>>    //====================================================================================
51139>>>>>>>>>    procedure LocateToolTip
51141>>>>>>>>>        local string  pnt    //  a TOOLTIP_POINT type
51141>>>>>>>>>        local pointer pPnt   //  a pointer to a TOOLTIP_POINT type
51141>>>>>>>>>        local integer xx     //  x location
51141>>>>>>>>>        local integer yy     //  y location
51141>>>>>>>>>        local integer cxy cx cy
51141>>>>>>>>>        Local Integer iYscreensize iXscreensize
51141>>>>>>>>>
51141>>>>>>>>>        filltype TOOLTIP_POINT with 0 to pnt
51142>>>>>>>>>
51142>>>>>>>>>        GetAddress of pnt to pPnt
51143>>>>>>>>>
51143>>>>>>>>>        move (GetCursorPos(pPnt)) to windowindex
51144>>>>>>>>>
51144>>>>>>>>>        getbuff from pnt at TOOLTIP_POINT.X to xx
51145>>>>>>>>>        getbuff from pnt at TOOLTIP_POINT.Y to yy
51146>>>>>>>>>
51146>>>>>>>>>        // SPY - 17/11/98
51146>>>>>>>>>        // If Location of the tooltip is outside of the screen reset the coordinayes
51146>>>>>>>>>        // Get The screen size
51146>>>>>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
51147>>>>>>>>>>
51147>>>>>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
51148>>>>>>>>>>
51148>>>>>>>>>        // Get The Tooltip Size
51148>>>>>>>>>        get client_size to cxy
51149>>>>>>>>>        move (Hi(cxy)) to cy
51150>>>>>>>>>        move (Low(cxy)) to cx
51151>>>>>>>>>        //Reset
51151>>>>>>>>>        If ((iXscreensize-xx) < cx)       Move (iXscreensize-cx) To xx
51154>>>>>>>>>        If (((iYscreensize-yy)-50) < cy)  Move (yy-cy-40)        To yy
51157>>>>>>>>>
51157>>>>>>>>>        // a bit of hard coding, but what the hell
51157>>>>>>>>>        set GUILocation to (yy + 20) xx
51158>>>>>>>>>    end_procedure
51159>>>>>>>>>
51159>>>>>>>>>    //====================================================================================
51159>>>>>>>>>    //  Name         : ShowToolTip
51159>>>>>>>>>    //  Scope        : PRIVATE
51159>>>>>>>>>    //  Purpose      : Show the requested tool tip
51159>>>>>>>>>    //====================================================================================
51159>>>>>>>>>    procedure ShowToolTip string sTip
51161>>>>>>>>>        local integer sz
51161>>>>>>>>>
51161>>>>>>>>>        // don't do anything, if it is visible AND has the same value!
51161>>>>>>>>>        if (Visible_State(current_object)) begin
51163>>>>>>>>>            // we are already visible, so determine if we need to do anything
51163>>>>>>>>>            if ((ToolTipValue(ToolTipLabel(current_object))) eq sTip) begin
51165>>>>>>>>>                // we are already showing this one,
51165>>>>>>>>>                procedure_return
51166>>>>>>>>>            end
51166>>>>>>>>>>
51166>>>>>>>>>        end
51166>>>>>>>>>>
51166>>>>>>>>>        send UpdateTip to (ToolTipLabel(current_object)) sTip
51167>>>>>>>>>
51167>>>>>>>>>        get Size  of (ToolTipLabel(current_object)) to sz
51168>>>>>>>>>        //set Size to ((hi(sz)) + 2) ((low(sz)) + 4)
51168>>>>>>>>>        set Size to ((hi(sz)) - 2) ((low(sz)) - 2)
51169>>>>>>>>>        send LocateToolTip
51170>>>>>>>>>        set Visible_State to true
51171>>>>>>>>>    end_procedure
51172>>>>>>>>>
51172>>>>>>>>>    //====================================================================================
51172>>>>>>>>>    //  Name         : HideToolTip
51172>>>>>>>>>    //  Scope        : PRIVATE
51172>>>>>>>>>    //  Purpose      : get rid of the tool tip
51172>>>>>>>>>    //====================================================================================
51172>>>>>>>>>    procedure HideToolTip
51174>>>>>>>>>        set Visible_State to false
51175>>>>>>>>>        send UpdateTip to (ToolTipLabel(current_object)) ""
51176>>>>>>>>>        set Location      to -100 -100
51177>>>>>>>>>    end_procedure
51178>>>>>>>>>
51178>>>>>>>>>end_class
51179>>>>>>>>>
51179>>>>>>>>>
51179>>>>>>>>>//========================================================================================
51179>>>>>>>>>//  Name         : ToolTipTimer000
51179>>>>>>>>>//  Purpose      : Class of object to control the tool tips.  Timer turns them on and off.
51179>>>>>>>>>//========================================================================================
51179>>>>>>>>>
51179>>>>>>>>>Class ToolTipTimer000 is a DFTimer
51180>>>>>>>>>
51180>>>>>>>>>    //====================================================================================
51180>>>>>>>>>    //  Name         :
51180>>>>>>>>>    //  Scope        : PRIVATE
51180>>>>>>>>>    //  Purpose      :
51180>>>>>>>>>    //====================================================================================
51180>>>>>>>>>
51180>>>>>>>>>    //====================================================================================
51180>>>>>>>>>    //  Name         : Construct_Object
51180>>>>>>>>>    //  Scope        : PRIVATE
51180>>>>>>>>>    //  Purpose      : Augmentation
51180>>>>>>>>>    //====================================================================================
51180>>>>>>>>>    procedure Construct_Object
51182>>>>>>>>>        forward send Construct_Object
51184>>>>>>>>>
51184>>>>>>>>>        property integer ToolTipVisible    public false  // are we displaying the tool tip
51185>>>>>>>>>        property integer LastToolTipObject public 0      // what was the last tool tip obj
51186>>>>>>>>>    end_procedure
51187>>>>>>>>>
51187>>>>>>>>>    //====================================================================================
51187>>>>>>>>>    //  Name         : ShowToolTip
51187>>>>>>>>>    //  Scope        : PRIVATE
51187>>>>>>>>>    //  Purpose      : Show the requested tool tip
51187>>>>>>>>>    //====================================================================================
51187>>>>>>>>>    procedure ShowToolTip integer ToolTipObject string sTip
51189>>>>>>>>>        local integer currentTipObj
51189>>>>>>>>>
51189>>>>>>>>>        get LastToolTipObject to currentTipObj
51190>>>>>>>>>        if (ToolTipObject ne currentTipObj) begin
51192>>>>>>>>>            // the tool tip we want to use is different to the one we used last
51192>>>>>>>>>            // so turn it off
51192>>>>>>>>>            if (ToolTipVisible(current_object)) send HideToolTip
51195>>>>>>>>>        end
51195>>>>>>>>>>
51195>>>>>>>>>
51195>>>>>>>>>        if (ToolTipObject ne 0) begin
51197>>>>>>>>>            set LastToolTipObject to ToolTipObject
51198>>>>>>>>>            set ToolTipVisible    to true
51199>>>>>>>>>
51199>>>>>>>>>            send ShowToolTip      to ToolTipObject sTip
51200>>>>>>>>>        end
51200>>>>>>>>>>
51200>>>>>>>>>        else send HideToolTip
51202>>>>>>>>>    end_procedure
51203>>>>>>>>>
51203>>>>>>>>>    //====================================================================================
51203>>>>>>>>>    //  Name         : HideToolTip
51203>>>>>>>>>    //  Scope        : PRIVATE
51203>>>>>>>>>    //  Purpose      : get rid of the current tool tip
51203>>>>>>>>>    //====================================================================================
51203>>>>>>>>>    procedure HideToolTip
51205>>>>>>>>>        local integer currentTipObj
51205>>>>>>>>>        if (ToolTipVisible(current_object)) begin
51207>>>>>>>>>            get LastToolTipObject to currentTipObj
51208>>>>>>>>>            send HideToolTip      to currentTipObj
51209>>>>>>>>>            set ToolTipVisible    to false
51210>>>>>>>>>        end
51210>>>>>>>>>>
51210>>>>>>>>>    end_procedure
51211>>>>>>>>>
51211>>>>>>>>>    //====================================================================================
51211>>>>>>>>>    //  Name         : ChangeTimerInterval
51211>>>>>>>>>    //  Scope        : PRIVATE
51211>>>>>>>>>    //  Purpose      : Hook to change timer interval.  This is because PlusPak! cTimer
51211>>>>>>>>>    //               : must be stopped and started to change the timer interval
51211>>>>>>>>>    //====================================================================================
51211>>>>>>>>>    procedure ChangeTimerInterval integer NewInterval
51213>>>>>>>>>        Set Timeout to NewInterval
51214>>>>>>>>>    end_procedure
51215>>>>>>>>>
51215>>>>>>>>>    //====================================================================================
51215>>>>>>>>>    //  Name         : CheckHint
51215>>>>>>>>>    //  Scope        : PRIVATE
51215>>>>>>>>>    //  Purpose      : check to see if a tool tip should be shown
51215>>>>>>>>>    //====================================================================================
51215>>>>>>>>>    procedure CheckHint
51217>>>>>>>>>        local integer isTipActive
51217>>>>>>>>>        //local integer showTip
51217>>>>>>>>>        local integer iobj
51217>>>>>>>>>        local string  sTip
51217>>>>>>>>>
51217>>>>>>>>>        get ToolTipVisible to isTipActive      // are we already displaying ome?
51218>>>>>>>>>        move (GetDFObjectUnderMouse()) to iObj // what is the current df object
51219>>>>>>>>>        if (iObj ne 0) begin
51221>>>>>>>>>            // we have an object
51221>>>>>>>>>            // get the tool tip string
51221>>>>>>>>>            //get ShowTooltipHint of iObj to showTip        // do we display a hint
51221>>>>>>>>>            //if (showTip) get TooltipHint of iObj to sTip  // and what is it
51221>>>>>>>>>            get TooltipHint of iObj to sTip
51222>>>>>>>>>        end
51222>>>>>>>>>>
51222>>>>>>>>>
51222>>>>>>>>>        if (isTipActive) begin
51224>>>>>>>>>            // the tool tip is active, so we either want to turn it off or we've moved to a different object
51224>>>>>>>>>            if (sTip ne "") begin
51226>>>>>>>>>                // the tool tip is active and we have something to show
51226>>>>>>>>>                send ShowToolTip (TooltipHintObject(iObj)) sTip
51227>>>>>>>>>            end
51227>>>>>>>>>>
51227>>>>>>>>>            else begin
51228>>>>>>>>>                // the tool tip is active and we don't want to show one
51228>>>>>>>>>                send HideToolTip
51229>>>>>>>>>                send ChangeTimerInterval 1000
51230>>>>>>>>>            end
51230>>>>>>>>>>
51230>>>>>>>>>        end
51230>>>>>>>>>>
51230>>>>>>>>>        else begin
51231>>>>>>>>>            // the tool tip is not active
51231>>>>>>>>>            if (sTip ne "") begin
51233>>>>>>>>>                // the tool tip is not active and we have something to show
51233>>>>>>>>>                send ShowToolTip (TooltipHintObject(iObj)) sTip
51234>>>>>>>>>                send ChangeTimerInterval 200 // make the timer check more (smoother transition from object to object)
51235>>>>>>>>>            end
51235>>>>>>>>>>
51235>>>>>>>>>            else begin
51236>>>>>>>>>                // the tool tip is not active and we don't want to show one
51236>>>>>>>>>                // nothing to do
51236>>>>>>>>>            end
51236>>>>>>>>>>
51236>>>>>>>>>        end
51236>>>>>>>>>>
51236>>>>>>>>>    end_procedure
51237>>>>>>>>>
51237>>>>>>>>>    //====================================================================================
51237>>>>>>>>>    //  Name         : CheckRemoveToolTip
51237>>>>>>>>>    //  Scope        : PRIVATE
51237>>>>>>>>>    //  Purpose      : Check to see if we should hide the tool tip, given that it should
51237>>>>>>>>>    //               : not be there!
51237>>>>>>>>>    //====================================================================================
51237>>>>>>>>>    procedure CheckRemoveToolTip
51239>>>>>>>>>        // if the tool tip is active, then get rid of it.
51239>>>>>>>>>        if (ToolTipVisible(current_object)) begin
51241>>>>>>>>>            send HideToolTip
51242>>>>>>>>>            // SGM : 21/10/1997
51242>>>>>>>>>            // added this - slow the timer down if we removed it.
51242>>>>>>>>>            send ChangeTimerInterval 1000
51243>>>>>>>>>        end
51243>>>>>>>>>>
51243>>>>>>>>>    end_procedure
51244>>>>>>>>>
51244>>>>>>>>>    //====================================================================================
51244>>>>>>>>>    //  Name         : MouseIsOverWindow
51244>>>>>>>>>    //  Scope        : PRIVATE
51244>>>>>>>>>    //  Purpose      : returns true is the mouse is over this window
51244>>>>>>>>>    //====================================================================================
51244>>>>>>>>>    function MouseIsOverWindow handle hWind returns integer
51246>>>>>>>>>        local string  pnt       // a TOOLTIP_POINT type
51246>>>>>>>>>        local pointer pPnt      // a pointer to TOOLTIP_POINT
51246>>>>>>>>>        local string  rect      // a tRECT type
51246>>>>>>>>>        local pointer pRect     // a pointer to tRECT
51246>>>>>>>>>        local integer mx        // mouse x
51246>>>>>>>>>        local integer my        // mouse y
51246>>>>>>>>>        local integer winLeft   // win left loc
51246>>>>>>>>>        local integer winTop    // win top loc
51246>>>>>>>>>        local integer winRight  // win right loc
51246>>>>>>>>>        local integer winBottom // win bottom loc
51246>>>>>>>>>
51246>>>>>>>>>        // get the location of the mouse
51246>>>>>>>>>        filltype TOOLTIP_POINT with 0 to pnt
51247>>>>>>>>>        GetAddress of pnt to pPnt
51248>>>>>>>>>        move (GetCursorPos(pPnt)) to windowindex
51249>>>>>>>>>        getbuff from pnt at TOOLTIP_POINT.X to mx
51250>>>>>>>>>        getbuff from pnt at TOOLTIP_POINT.Y to my
51251>>>>>>>>>
51251>>>>>>>>>        // get the _real_ origin and extent of the application
51251>>>>>>>>>        // using DF's Absolute_GuiOrigin returns us the loctions offset by the
51251>>>>>>>>>        // apps caption bar which just causes too many problems
51251>>>>>>>>>
51251>>>>>>>>>        filltype tRECT with 0 to rect
51252>>>>>>>>>        GetAddress of rect to pRect
51253>>>>>>>>>        move (GetWindowRect(hWind, pRect)) to windowindex
51254>>>>>>>>>        getbuff from rect at tRECT.left    to winLeft
51255>>>>>>>>>        getbuff from rect at tRECT.top     to winTop
51256>>>>>>>>>        getbuff from rect at tRECT.right   to winRight
51257>>>>>>>>>        getbuff from rect at tRECT.bottom  to winBottom
51258>>>>>>>>>
51258>>>>>>>>>        function_return (((mx gt winLeft) and (mx lt winRight)) and ((my gt winTop) and (my lt winBottom)))
51259>>>>>>>>>    end_function
51260>>>>>>>>>
51260>>>>>>>>>    //====================================================================================
51260>>>>>>>>>    //  Name         : OnTimer
51260>>>>>>>>>    //  Scope        : PRIVATE
51260>>>>>>>>>    //  Purpose      : A timer event has gone, do the checks
51260>>>>>>>>>    //====================================================================================
51260>>>>>>>>>    procedure OnTimer
51262>>>>>>>>>        local handle  hdMain
51262>>>>>>>>>        local handle  hd
51262>>>>>>>>>        local integer iFoc iObj ibase
51262>>>>>>>>>
51262>>>>>>>>>        // we have to determine if we are the active window because if there is another df app running
51262>>>>>>>>>        // we will get the df object of the object in the other app if the mouse is located there.
51262>>>>>>>>>
51262>>>>>>>>>        // this causes us to get an unresolved object reference because we're trying to talk to an object
51262>>>>>>>>>        // that isn't even in this program!
51262>>>>>>>>>
51262>>>>>>>>>        move (GetActiveWindow())                    to hd      // the active (DF) window.
51263>>>>>>>>>
51263>>>>>>>>>        // if the active window handle doesn't equal the window handle of 'main' then we are either dealing
51263>>>>>>>>>        // with a modal panel (within our app) or some other app has the windows focus.  what we need to
51263>>>>>>>>>        // do now is get the window handle of the panel that is the parent of the focus and check
51263>>>>>>>>>        // that against the active window.
51263>>>>>>>>>
51263>>>>>>>>>        // get the focus
51263>>>>>>>>>        get Focus to iFoc
51264>>>>>>>>>        // get the window handle of the panel that is the parent (or grand.. parent) of the focus.
51264>>>>>>>>>        get WindowHandleForToolTip of (iFoc) to hdMain             // the handle of the window (panel) that has the focus
51265>>>>>>>>>
51265>>>>>>>>>        // do the tests.
51265>>>>>>>>>        if (hd eq hdMain) begin
51267>>>>>>>>>            // the active window is the same as the panel with the focus,
51267>>>>>>>>>            // but is the mouse over the active window?
51267>>>>>>>>>            if (MouseIsOverWindow(current_object,hd)) begin
51269>>>>>>>>>                // the window for this app is active and the mouse is actually over the application
51269>>>>>>>>>                // not a different VDF
51269>>>>>>>>>                //move (GetDFObjectUnderMouse()) to iObj // what is the current df object
51269>>>>>>>>>                //If (base_Class(iObj) = 1) Begin
51269>>>>>>>>>                    //If (Message(iObj,0) = WM_LBUTTONDOWN) Begin
51269>>>>>>>>>                    //    showln "   " iObj "   " ibase
51269>>>>>>>>>                    //    send CheckRemoveToolTip
51269>>>>>>>>>                    //    Set TooltipVisible to True
51269>>>>>>>>>                    //End
51269>>>>>>>>>                //End
51269>>>>>>>>>                // check for tool tip hints
51269>>>>>>>>>                send CheckHint
51270>>>>>>>>>            end
51270>>>>>>>>>>
51270>>>>>>>>>            else send CheckRemoveToolTip   // remove the tool tip if it is active
51272>>>>>>>>>        end
51272>>>>>>>>>>
51272>>>>>>>>>        else send CheckRemoveToolTip       // remove the tool tip if it is active
51274>>>>>>>>>
51274>>>>>>>>>    end_procedure
51275>>>>>>>>>
51275>>>>>>>>>
51275>>>>>>>>>    //====================================================================================
51275>>>>>>>>>    //  Name         : DisableToolTips
51275>>>>>>>>>    //  Scope        : PUBLIC
51275>>>>>>>>>    //  Purpose      : Turn off tool tips
51275>>>>>>>>>    //====================================================================================
51275>>>>>>>>>    procedure DisableToolTips
51277>>>>>>>>>        Set Timer_Active_State to False
51278>>>>>>>>>    end_procedure
51279>>>>>>>>>
51279>>>>>>>>>    //====================================================================================
51279>>>>>>>>>    //  Name         : EnableToolTips
51279>>>>>>>>>    //  Scope        : PUBLIC
51279>>>>>>>>>    //  Purpose      : Turn on tool tips
51279>>>>>>>>>    //====================================================================================
51279>>>>>>>>>    procedure EnableToolTips
51281>>>>>>>>>        Set Timer_Active_State to True
51282>>>>>>>>>    end_procedure
51283>>>>>>>>>end_class
51284>>>>>>>>>
51284>>>>>>>>>//These Objects now are in Tooltip.inc File that is being included in the End_Construct_Object
51284>>>>>>>>>//of the dbView_EZ Class - SPY 15/11/78 This Must Be changed
51284>>>>>>>>>
51284>>>>>>>>>//object StandardToolTip is a StandardToolTip000
51284>>>>>>>>>//    move (current_object) to DefaultTooltipHintID
51284>>>>>>>>>//end_object
51284>>>>>>>>>
51284>>>>>>>>>//object ToolTipTimer is a ToolTipTimer000
51284>>>>>>>>>//    move (current_object) to TooltipControllerID
51284>>>>>>>>>//end_object
51284>>>>>>>>>
51284>>>>>>>Use AccKeymx.ezc
51284>>>>>>>
51284>>>>>>>Class DbformSub Is A Dbform
51285>>>>>>>
51285>>>>>>>        Procedure Construct_Object
51287>>>>>>>            Forward Send Construct_Object
51289>>>>>>>            Send Docustomizedefaultfloatmenu Default_Dbfloating_Menu_Id
51290>>>>>>>            Send Docustomizedefaultdbfloatmenu Default_Dbfloating_Menu_Id
51291>>>>>>>            //Send Define_DisableAcceleratorKey_Mixin
51291>>>>>>>
51291>>>>>>>            Property String TooltipValue Public ""
51292>>>>>>>        End_Procedure
51293>>>>>>>
51293>>>>>>>    Procedure End_Construct_Object
51295>>>>>>>        Forward Send End_Construct_Object
51297>>>>>>>
51297>>>>>>>    End_Procedure //Construct_Object
51298>>>>>>>
51298>>>>>>>
51298>>>>>>>        Function TooltipHint returns string
51300>>>>>>>            Integer liVisible liEnabled liExt
51300>>>>>>>            String lsVal liLow
51300>>>>>>>
51300>>>>>>>            Get Visible_State to liVisible
51301>>>>>>>            Get Enabled_State to liEnabled
51302>>>>>>>            If ((liVisible) and (liEnabled = 0)) Begin
51304>>>>>>>                Move (rTrim(Value(Self,0))) to lsVal
51305>>>>>>>                Get Text_Extent (ToAnsi(lsVal)) To liExt
51306>>>>>>>                Move (Low(liExt)) to liExt
51307>>>>>>>                Move (Low(Guisize(Self))) To liLow
51308>>>>>>>                If (liLow < (liExt+8)) Set TooltipValue to (rTrim(Value(Self,0)))
51311>>>>>>>                Else Set TooltipValue to ""
51313>>>>>>>            End
51313>>>>>>>>
51313>>>>>>>            Else Set TooltipValue to ""
51315>>>>>>>            Function_Return (TooltipValue(Self))
51316>>>>>>>        End_function
51317>>>>>>>
51317>>>>>>>        Procedure OnFindOrClearRecord
51319>>>>>>>        End_Procedure
51320>>>>>>>
51320>>>>>>>        Procedure Prompt
51322>>>>>>>            Forward Send Prompt
51324>>>>>>>            Send OnFindOrClearRecord
51325>>>>>>>        End_Procedure // Prompt
51326>>>>>>>
51326>>>>>>>        Procedure Find_Ge
51328>>>>>>>            Forward Send Find_Ge
51330>>>>>>>            Send OnFindOrClearRecord
51331>>>>>>>        End_Procedure // Find_Ge
51332>>>>>>>
51332>>>>>>>        Procedure Find_Next
51334>>>>>>>            Forward Send Find_Next
51336>>>>>>>            Send OnFindOrClearRecord
51337>>>>>>>        End_Procedure // Find_Next
51338>>>>>>>
51338>>>>>>>        Procedure Find_Previous
51340>>>>>>>            Forward Send Find_Previous
51342>>>>>>>            Send OnFindOrClearRecord
51343>>>>>>>        End_Procedure // Find_Previous
51344>>>>>>>
51344>>>>>>>        Procedure Beginning_Of_Data
51346>>>>>>>            Forward Send Beginning_Of_Data
51348>>>>>>>            Send OnFindOrClearRecord
51349>>>>>>>        End_Procedure // Beginning_Of_Data
51350>>>>>>>
51350>>>>>>>        Procedure End_Of_Data
51352>>>>>>>            Forward Send End_Of_Data
51354>>>>>>>            Send OnFindOrClearRecord
51355>>>>>>>        End_Procedure // End_Of_Data
51356>>>>>>>
51356>>>>>>>        Procedure entry_autofind integer find_mode
51358>>>>>>>            Forward Send entry_autofind find_mode
51360>>>>>>>            Send OnFindOrClearRecord
51361>>>>>>>        End_Procedure // entry_autofind
51362>>>>>>>
51362>>>>>>>        Procedure Request_Clear
51364>>>>>>>            Forward Send Request_Clear
51366>>>>>>>            Send OnFindOrClearRecord
51367>>>>>>>        End_Procedure // Request_Clear
51368>>>>>>>
51368>>>>>>>        Procedure Request_Clear_All
51370>>>>>>>            Forward Send Request_Clear_All
51372>>>>>>>            Send OnFindOrClearRecord
51373>>>>>>>        End_Procedure // Request_Clear_All
51374>>>>>>>
51374>>>>>>>        Procedure Set Visible_State Integer iState
51376>>>>>>>            Forward Set Visible_State to iState
51378>>>>>>>            if (Label_Object(self)) ;                Set Visible_State of (Label_Object(self)) to iState
51381>>>>>>>        End_Procedure // Visible_State
51382>>>>>>>
51382>>>>>>>        Import_Class_Protocol DisableAcceleratorKey_Mixin
51383>>>>>>>End_Class //DbformSub
51384>>>>>>>
51384>>>>>USE APCLAREA.Sub    //05. appclientarea
Including file: APCLAREA.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\APCLAREA.SUB)
51384>>>>>>>Use dfClient
51384>>>>>>>Use dfPanel
51384>>>>>>>//Use AccKeymx.ezc
51384>>>>>>>
51384>>>>>>>Class AppclientareaSub Is A ClientArea
51385>>>>>>>
51385>>>>>>>    Procedure Construct_Object
51387>>>>>>>        Forward Send Construct_Object
51389>>>>>>>        //Send Define_Disableacceleratorkey_Mixin
51389>>>>>>>    End_Procedure
51390>>>>>>>
51390>>>>>>>    //Import_Class_Protocol Disableacceleratorkey_Mixin
51390>>>>>>>
51390>>>>>>>End_Class //AppclientareaSub
51391>>>>>USE DBGRID.Sub      //06. dbgrid
Including file: DBGRID.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBGRID.SUB)
51391>>>>>>>Use dfCLient
51391>>>>>>>Use dfAllent
51391>>>>>>>//Use AccKeymx.ezc
51391>>>>>>>
51391>>>>>>>Register_Function Save_Header returns integer
51391>>>>>>>
51391>>>>>>>Class DbgridSub Is A Dbgrid
51392>>>>>>>
51392>>>>>>>       Procedure Construct_Object
51394>>>>>>>            Forward Send Construct_Object
51396>>>>>>>
51396>>>>>>>            Send DoCustomizeDefaultFloatMenu default_dbFloating_Menu_id
51397>>>>>>>            Send DoCustomizeDefaultdbFloatMenu default_dbFloating_Menu_id
51398>>>>>>>            Set Child_Table_State to True
51399>>>>>>>            //Send Define_Disableacceleratorkey_Mixin
51399>>>>>>>
51399>>>>>>>            Property Integer pInRefreshView Public False
51400>>>>>>>            Property Integer pAlreadyRefreshed Public False
51401>>>>>>>            Property Integer Auto_Save_Header Public False
51402>>>>>>>       End_Procedure
51403>>>>>>>
51403>>>>>>>       Procedure End_Construct_Object
51405>>>>>>>            Forward Send End_Construct_Object
51407>>>>>>>            Integer iItem iItems
51407>>>>>>>            String  sLabel
51407>>>>>>>            Set peDisabledTextColor to 4210752
51408>>>>>>>       End_procedure
51409>>>>>>>        Procedure Request_Delete
51411>>>>>>>            Integer iServer iCur
51411>>>>>>>            Get Server to iServer
51412>>>>>>>            Get Current_Record Of iServer to iCur
51413>>>>>>>            If (iCur) Begin
51415>>>>>>>                Forward Send Request_Delete
51417>>>>>>>                Send Up_Row Of Self
51418>>>>>>>            End
51418>>>>>>>>
51418>>>>>>>        End_Procedure
51419>>>>>>>
51419>>>>>>>       Procedure Request_Clear_All0000000
51421>>>>>>>            //Because of a bug. The first row of a grid does not clear during clear_all operation
51421>>>>>>>            Send Down_Row
51422>>>>>>>            Forward Send Request_Clear_All
51424>>>>>>>       End_Procedure
51425>>>>>>>
51425>>>>>>>        Procedure DoRightAlignColumn integer iColumn
51427>>>>>>>            Send DoAlignColumn iColumn FORM_DISPLAYRIGHT
51428>>>>>>>        End_Procedure
51429>>>>>>>
51429>>>>>>>        Procedure DoCenterColumn integer iColumn
51431>>>>>>>            Send DoAlignColumn iColumn FORM_DISPLAYCENTER
51432>>>>>>>        End_procedure
51433>>>>>>>
51433>>>>>>>        Procedure DoAlignColumn integer iColumn integer iMode
51435>>>>>>>            String  sVal
51435>>>>>>>            Integer iItem iFormWidth iTextWidth iSpaceWidth iSpaces
51435>>>>>>>
51435>>>>>>>            Move (base_item(self) + iColumn) to iItem
51436>>>>>>>            Get value item iItem to sVal
51437>>>>>>>            Move (Trim(sVal)) to sVal
51438>>>>>>>
51438>>>>>>>            If (sVal <> "") begin
51440>>>>>>>                Get Form_GuiWidth Item iItem to iFormWidth
51441>>>>>>>
51441>>>>>>>                Get Text_Extent sVal to iTextWidth
51442>>>>>>>                Move (Low(iTextWidth)) to iTextWidth
51443>>>>>>>
51443>>>>>>>                Get Text_Extent " "  to iSpaceWidth
51444>>>>>>>                Move (low(iSpaceWidth)) to iSpaceWidth
51445>>>>>>>
51445>>>>>>>                If (iMode = FORM_DISPLAYRIGHT) ;                    Move (((iFormWidth - iTextWidth) / iSpaceWidth) - 2) to iSpaces
51448>>>>>>>                If (iMode = FORM_DISPLAYCENTER) ;                    Move (((iFormWidth - iTextWidth) / 2) / iSpaceWidth) to iSpaces
51451>>>>>>>
51451>>>>>>>                Move (Repeat(" ",iSpaces) + sVal) to sVal
51452>>>>>>>
51452>>>>>>>                // if items have same values on activation or scrolling with PgUp/PgDn
51452>>>>>>>                // somehow modified value does not get set allways if not first set to ""
51452>>>>>>>                // I think it might happen when items data_file = grids main_file
51452>>>>>>>                Set Value Item iItem to ""
51453>>>>>>>                Set Value Item iItem to sVal
51454>>>>>>>            End
51454>>>>>>>>
51454>>>>>>>        End_procedure
51455>>>>>>>
51455>>>>>>>
51455>>>>>>>       Function Im_a_dbGrid returns integer
51457>>>>>>>         function_return 1
51458>>>>>>>       End_Function
51459>>>>>>>
51459>>>>>>>      // Because of a bug in code_description when field is numeric
51459>>>>>>>      Function Export_Code_Description Integer iItem String sVal Returns String
51461>>>>>>>            integer iObj
51461>>>>>>>            string sDesc
51461>>>>>>>            // Find the validation table of iItem
51461>>>>>>>            Get Item_Field_Property GET_File_Field_Table_Object iItem to iObj
51462>>>>>>>            If iObj get Find_Code_Description of iObj sVal to sDesc
51465>>>>>>>            Function_Return sDesc
51466>>>>>>>      End_Function // Export_Code_Description
51467>>>>>>>
51467>>>>>>>        // Refresh the current records displayed in the grid.
51467>>>>>>>        Procedure Refresh_Current_Page  Integer iRowArg
51469>>>>>>>            Local Integer iFile iRec iRow iParentDD iServer iCount
51469>>>>>>>            If (Num_Arguments = 0) Get Row (Top_Item(Self)) to iRow
51472>>>>>>>            Else Move iRowArg to iRow
51474>>>>>>>            Get Record_Number iRow to iRec
51475>>>>>>>            // Clearing the main_file was moved outside of the iRec block because,
51475>>>>>>>            // if iRec = 0, the record buffer should be clear.
51475>>>>>>>            Move (Main_File(Server(Self))) to Filenumber
51476>>>>>>>            Move 0 to Fieldindex
51477>>>>>>>            Clear Indirect_File
51478>>>>>>>            If iRec Begin
51480>>>>>>>                Move iRec to Indirect_File.Recnum&
51481>>>>>>>                Vfind Filenumber 0 Eq
51483>>>>>>>                // If not found, clear the file and move 0 to iRec so that the next block will execute.
51483>>>>>>>                // This avoids a Record_Not_Found error when the record for the first row has been deleted.
51483>>>>>>>                [Finderr] Begin
51485>>>>>>>>
51485>>>>>>>                    Clear Indirect_File
51486>>>>>>>                    Move 0 to iRec
51487>>>>>>>                End
51487>>>>>>>>
51487>>>>>>>                // Do a relate to make sure that the correct Parent record
51487>>>>>>>                // is in the buffer.
51487>>>>>>>                Relate Indirect_File
51488>>>>>>>            End
51488>>>>>>>>
51488>>>>>>>            // If the record number of the grid is 0, and this is a child
51488>>>>>>>            // file, make sure that the record buffer of the parent files
51488>>>>>>>            // agrees with the Current_Record of the Parent DD
51488>>>>>>>            If (iRec = 0) Begin
51490>>>>>>>                Get Server to iServer
51491>>>>>>>                Get Data_Set_Server_Count of iServer to iCount
51492>>>>>>>                // Use Contrained_Find to find the first record that satisfies the constraints.
51492>>>>>>>                // This is done for all files now, not just non-child files.
51492>>>>>>>                If iServer Begin
51494>>>>>>>                    Send Rebuild_Constraints to iServer
51495>>>>>>>                    Constrained_Find First Filenumber By 1
51500>>>>>>>                    [Finderr] Clear Indirect_File
51501>>>>>>>                End
51501>>>>>>>>
51501>>>>>>>                While iCount
51505>>>>>>>                    Decrement iCount
51506>>>>>>>                    Get Data_Set_Server of iServer iCount to iParentDD
51507>>>>>>>                    If iParentDD Begin
51509>>>>>>>                    Move (Main_File(iParentDD)) to Filenumber
51510>>>>>>>                    Get Current_Record of iParentDD to iRec
51511>>>>>>>                    If iRec Begin
51513>>>>>>>                        Move 0 to Fieldindex
51514>>>>>>>                        Clear Indirect_File
51515>>>>>>>                        Move iRec to Indirect_File.Recnum&
51516>>>>>>>                        Vfind Filenumber 0 Eq
51518>>>>>>>                        Relate Indirect_File
51519>>>>>>>                    End
51519>>>>>>>>
51519>>>>>>>                    // If there is not a current record for the parent, clear
51519>>>>>>>                    // its record buffer.  Otherwise, child records may display
51519>>>>>>>                    // with a blank header.
51519>>>>>>>                    Else Clear Indirect_File
51521>>>>>>>                    End
51521>>>>>>>>
51521>>>>>>>                Loop
51522>>>>>>>>
51522>>>>>>>            End
51522>>>>>>>>
51522>>>>>>>            Send Refresh_Page iRow 0
51523>>>>>>>        End_Procedure
51524>>>>>>>
51524>>>>>>>        Procedure RestoreTopRecord
51526>>>>>>>            Local Integer iRec iRow
51526>>>>>>>            Get Row (Top_Item(Self)) to iRow
51527>>>>>>>            Get Record_Number iRow to iRec
51528>>>>>>>            If iRec Begin
51530>>>>>>>                Move (Main_File(Server(Self))) to Filenumber
51531>>>>>>>                Move 0 to Fieldindex
51532>>>>>>>                Move iRec to Indirect_File.Recnum&
51533>>>>>>>                Vfind Filenumber 0 Eq
51535>>>>>>>                [Found] Relate Indirect_File
51536>>>>>>>            End
51536>>>>>>>>
51536>>>>>>>        End_Procedure
51537>>>>>>>
51537>>>>>>>
51537>>>>>>>        // This augmentation optimizes RefreshView, stopping Refresh_Page from being sent multiple times
51537>>>>>>>        // during on RefreshView.
51537>>>>>>>        Procedure Refresh_Page Integer iRow Integer iCol
51539>>>>>>>            If (pInRefreshView(Self) And pAlreadyRefreshed(Self)) Procedure_Return
51542>>>>>>>            If (pInRefreshView(Self)) Set pAlreadyRefreshed to True
51545>>>>>>>            If (Num_Arguments = 1) Forward Send Refresh_Page iRow
51549>>>>>>>            Else Forward Send Refresh_Page iRow iCol
51552>>>>>>>        End_Procedure
51553>>>>>>>
51553>>>>>>>        //Import_Class_Protocol Disableacceleratorkey_Mixin
51553>>>>>>>
51553>>>>>>>End_Class //dbgridSub
51554>>>>>>>
51554>>>>>USE DBSPNFRM.Sub    //07. dbspinform
Including file: DBSPNFRM.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBSPNFRM.SUB)
51554>>>>>>>Use dfClient
51554>>>>>>>Use dfspnent
51554>>>>>>>
51554>>>>>>>
51554>>>>>>>Use AccKeymx.ezc
51554>>>>>>>
51554>>>>>>>Class DbspinformSub Is A Dbspinform
51555>>>>>>>
51555>>>>>>>       Procedure Construct_Object
51557>>>>>>>            Forward Send Construct_Object
51559>>>>>>>            Send Docustomizedefaultfloatmenu Default_Dbfloating_Menu_Id
51560>>>>>>>            //Send Define_Disableacceleratorkey_Mixin
51560>>>>>>>       End_Procedure
51561>>>>>>>
51561>>>>>>>      Import_Class_Protocol Disableacceleratorkey_Mixin
51562>>>>>>>
51562>>>>>>>End_Class //DbspinformSub
51563>>>>>USE DBVIEW.Sub      //08. dbview
Including file: DBVIEW.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBVIEW.SUB)
51563>>>>>>>
51563>>>>>>>Use General.pkg
51563>>>>>>>Use WinusrEz.pkg
51563>>>>>>>Use ConfrmSc.pkg
Including file: CONFRMSC.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONFRMSC.PKG)
51563>>>>>>>>>USE msgbox
51563>>>>>>>>>
51563>>>>>>>>>Function fiConfirmation Global String item_name Returns Integer
51565>>>>>>>>>   Local Integer rval
51565>>>>>>>>>   Get YesNo_Box item_name "" to rval
51566>>>>>>>>>   Function_Return (rval<>MBR_YES)
51567>>>>>>>>>End_function
51568>>>>>>>>>
51568>>>>>>>>>Function confirm FOR DESKTOP String item_name Returns Integer
51570>>>>>>>>>   Local Integer rval
51570>>>>>>>>>   Get fiConfirmation item_name to rval
51571>>>>>>>>>   Function_Return rval
51572>>>>>>>>>End_function
51573>>>>>>>>>
51573>>>>>>>>>Function Save_Confirmation FOR DESKTOP Returns integer
51575>>>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
51576>>>>>>>>>End_function
51577>>>>>>>>>
51577>>>>>>>>>Function Delete_Confirmation FOR DESKTOP Returns integer
51579>>>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
51580>>>>>>>>>End_function
51581>>>>>>>>>
51581>>>>>>>>>Function Line_save_confirmation FOR DESKTOP Returns integer
51583>>>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
51584>>>>>>>>>End_function
51585>>>>>>>>>
51585>>>>>>>>>Function Line_delete_confirmation FOR DESKTOP Returns integer
51587>>>>>>>>>  Function_return (confirm(Current_Object,"  ?"))
51588>>>>>>>>>End_function
51589>>>>>>>>>
51589>>>>>>>>>Function Data_Loss_Confirmation FOR DESKTOP Returns integer
51591>>>>>>>>>  Function_return (confirm(Current_Object,"   ?"))
51592>>>>>>>>>End_function
51593>>>>>>>>>
51593>>>>>>>>>Function Exit_Loss_Confirmation FOR DESKTOP Returns integer
51595>>>>>>>>>  local integer tmp
51595>>>>>>>>>  get Should_save_recursive to tmp
51596>>>>>>>>>  if tmp ne 0 Function_return (confirm(Current_Object," .   ?"))
51599>>>>>>>>>End_function
51600>>>>>>>>>
51600>>>>>>>>>Function No_Confirmation FOR DESKTOP Returns integer
51602>>>>>>>>>End_function
51603>>>>>>>>>
51603>>>>>>>>>Function Should_save for desktop returns integer
51605>>>>>>>>>end_function
51606>>>>>>>>>
51606>>>>>>>>>Function Should_Save_Recursive for desktop returns integer
51608>>>>>>>>>  Local Integer rVal
51608>>>>>>>>>  Get Should_Save to Rval
51609>>>>>>>>>  If rVal eq 0 BroadCast Get Should_Save_Recursive to Rval
51613>>>>>>>>>  Function_return rVal
51614>>>>>>>>>End_Function
51615>>>>>>>>>
51615>>>>>>>>>
51615>>>>>>>Use AccKeymx.ezc
51615>>>>>>>Use cSize_mx.pkg
Including file: CSIZE_MX.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CSIZE_MX.PKG)
51615>>>>>>>>>Use dfclient
51615>>>>>>>>>Use dfallent
51615>>>>>>>>>
51615>>>>>>>>>
51615>>>>>>>>>// CSIZE_MX.PKG
51615>>>>>>>>>//
51615>>>>>>>>>//
51615>>>>>>>>>// cSize_mx.pkg
51615>>>>>>>>>
51615>>>>>>>>>// Collection of classes to support automatic size and location
51615>>>>>>>>>// of child objects
51615>>>>>>>>>
51615>>>>>>>>>Enumeration_List
51615>>>>>>>>>    Define amTopRight
51615>>>>>>>>>    Define amTopLeft
51615>>>>>>>>>    Define amBottomLeft
51615>>>>>>>>>    Define amBottomRight
51615>>>>>>>>>End_Enumeration_List
51615>>>>>>>>>
51615>>>>>>>>>Enumeration_List
51615>>>>>>>>>    Define smTopRight
51615>>>>>>>>>    Define smTopLeft
51615>>>>>>>>>    Define smBottomLeft
51615>>>>>>>>>    Define smBottomRight
51615>>>>>>>>>End_Enumeration_List
51615>>>>>>>>>
51615>>>>>>>>>
51615>>>>>>>>>Class cAlignModes Is An Array
51616>>>>>>>>>
51616>>>>>>>>>    Procedure DoAdd Integer ho Integer iMode
51618>>>>>>>>>        Local Integer cxy cxyho cy cx xyho yho xho cxho cyho
51618>>>>>>>>>        Delegate Get Size To cxy
51620>>>>>>>>>        Get Size of ho To cxyho
51621>>>>>>>>>
51621>>>>>>>>>        Move (Hi(cxy))    To cy
51622>>>>>>>>>        Move (Low(cxy))   To cx
51623>>>>>>>>>        Move (Hi(cxyho))  To cyho
51624>>>>>>>>>        Move (Low(cxyho)) To cxho
51625>>>>>>>>>
51625>>>>>>>>>        Get Location of ho To xyho
51626>>>>>>>>>        Move (Hi(xyho))  To yho
51627>>>>>>>>>        Move (Low(xyho)) To xho
51628>>>>>>>>>
51628>>>>>>>>>        If iMode eq amTopRight Begin
51630>>>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx - xho) +'|' +String(yho) +'|')
51631>>>>>>>>>        End
51631>>>>>>>>>>
51631>>>>>>>>>        Else If iMode eq amBottomRight Begin
51634>>>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx - xho) +'|' +String(cy -yho) +'|')
51635>>>>>>>>>        End
51635>>>>>>>>>>
51635>>>>>>>>>        Else If iMode eq amBottomLeft Begin
51638>>>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(xho) +'|' +String(cy -yho) +'|')
51639>>>>>>>>>        End
51639>>>>>>>>>>
51639>>>>>>>>>    End_Procedure
51640>>>>>>>>>
51640>>>>>>>>>
51640>>>>>>>>>    Procedure DoResize
51642>>>>>>>>>        Local Integer iLoop icItem iPos iMode ho x y cxy cx cy
51642>>>>>>>>>        Local String sItem
51642>>>>>>>>>        Get Item_Count To icItem
51643>>>>>>>>>        Delegate Send Adjust_Logicals
51645>>>>>>>>>        Delegate Get Size To cxy
51647>>>>>>>>>        Move (Hi(cxy)) To cy
51648>>>>>>>>>        Move (Low(cxy)) To cx
51649>>>>>>>>>        For iLoop From 0 To (icItem -1)
51655>>>>>>>>>>
51655>>>>>>>>>            Get Value item iLoop To sItem
51656>>>>>>>>>            Pos '|' In sItem To iPos
51658>>>>>>>>>>
51658>>>>>>>>>            Left sItem To ho (iPos -1)
51660>>>>>>>>>>
51660>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51662>>>>>>>>>>
51662>>>>>>>>>
51662>>>>>>>>>            Pos '|' In sItem To iPos
51664>>>>>>>>>>
51664>>>>>>>>>            Left sItem To iMode (iPos -1)
51666>>>>>>>>>>
51666>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51668>>>>>>>>>>
51668>>>>>>>>>
51668>>>>>>>>>            Pos '|' In sItem To iPos
51670>>>>>>>>>>
51670>>>>>>>>>            Left sItem To x (iPos -1)
51672>>>>>>>>>>
51672>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51674>>>>>>>>>>
51674>>>>>>>>>
51674>>>>>>>>>            Pos '|' In sItem To iPos
51676>>>>>>>>>>
51676>>>>>>>>>            Left sItem To y (iPos -1)
51678>>>>>>>>>>
51678>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51680>>>>>>>>>>
51680>>>>>>>>>
51680>>>>>>>>>            If iMode eq amTopRight         ;                Set Location of ho To y (cx -x)
51683>>>>>>>>>            Else If iMode eq amBottomRight ;                Set Location of ho To (cy -y) (cx -x)
51687>>>>>>>>>            Else If iMode eq amBottomLeft  ;                Set Location of ho To (cy -y) x
51691>>>>>>>>>
51691>>>>>>>>>        Loop
51692>>>>>>>>>>
51692>>>>>>>>>    End_Procedure
51693>>>>>>>>>
51693>>>>>>>>>End_Class
51694>>>>>>>>>
51694>>>>>>>>>//cSize_mx.pkg (Continued)
51694>>>>>>>>>Class cSizeModes Is An Array
51695>>>>>>>>>
51695>>>>>>>>>    Procedure DoAdd Integer ho Integer iMode
51697>>>>>>>>>        Local Integer cxy cxyho cy cx xyho yho xho cxho cyho
51697>>>>>>>>>        Delegate Get Size To cxy
51699>>>>>>>>>        Get Size of ho To cxyho
51700>>>>>>>>>
51700>>>>>>>>>        Move (Hi(cxy))    To cy
51701>>>>>>>>>        Move (Low(cxy))   To cx
51702>>>>>>>>>        Move (Hi(cxyho))  To cyho
51703>>>>>>>>>        Move (Low(cxyho)) To cxho
51704>>>>>>>>>
51704>>>>>>>>>        Get Location of ho To xyho
51705>>>>>>>>>        Move (Hi(xyho))  To yho
51706>>>>>>>>>        Move (Low(xyho)) To xho
51707>>>>>>>>>
51707>>>>>>>>>        If iMode eq smBottomRight Begin
51709>>>>>>>>>            Set Value item (Item_Count(Current_Object)) To ;                ( String(ho) +'|' +String(iMode) +'|' ;                +String(cx -xho -cxho) +'|' ;                                        +String(cy -yho -cyho) +'|')
51710>>>>>>>>>        End
51710>>>>>>>>>>
51710>>>>>>>>>        Else If iMode eq smTopRight Begin
51713>>>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cx -xho -cxho) +'|' ;                        +String(cyho) +'|')
51714>>>>>>>>>        End
51714>>>>>>>>>>
51714>>>>>>>>>        Else If iMode eq smTopLeft Begin
51717>>>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cx -xho) +'|' ;                        +String(cy -yHo) +'|')
51718>>>>>>>>>        End
51718>>>>>>>>>>
51718>>>>>>>>>        Else If iMode eq smBottomLeft Begin
51721>>>>>>>>>                Set Value item (Item_Count(Current_Object)) To ;                    ( String(ho) +'|' +String(iMode) +'|' ;                    +String(cxho) +'|' ;                        +String(cy -yho -cyho) +'|')
51722>>>>>>>>>        End
51722>>>>>>>>>>
51722>>>>>>>>>
51722>>>>>>>>>    End_Procedure
51723>>>>>>>>>
51723>>>>>>>>>    Procedure DoResize
51725>>>>>>>>>        Local Integer iLoop icItem iPos iMode ho x y cxy cx cy xy
51725>>>>>>>>>        Local String sItem
51725>>>>>>>>>        Get Item_Count To icItem
51726>>>>>>>>>        Delegate Get Size To cxy
51728>>>>>>>>>        Move (Hi(cxy)) To cy
51729>>>>>>>>>        Move (Low(cxy)) To cx
51730>>>>>>>>>        For iLoop From 0 To (icItem -1)
51736>>>>>>>>>>
51736>>>>>>>>>            Get Value item iLoop To sItem
51737>>>>>>>>>            Pos '|' In sItem To iPos
51739>>>>>>>>>>
51739>>>>>>>>>            Left sItem To ho (iPos -1)
51741>>>>>>>>>>
51741>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51743>>>>>>>>>>
51743>>>>>>>>>            Get Location of ho To xy
51744>>>>>>>>>
51744>>>>>>>>>            Pos '|' In sItem To iPos
51746>>>>>>>>>>
51746>>>>>>>>>            Left sItem To iMode (iPos -1)
51748>>>>>>>>>>
51748>>>>>>>>>
51748>>>>>>>>>
51748>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51750>>>>>>>>>>
51750>>>>>>>>>
51750>>>>>>>>>            Pos '|' In sItem To iPos
51752>>>>>>>>>>
51752>>>>>>>>>            Left sItem To x (iPos -1)
51754>>>>>>>>>>
51754>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51756>>>>>>>>>>
51756>>>>>>>>>
51756>>>>>>>>>            Pos '|' In sItem To iPos
51758>>>>>>>>>>
51758>>>>>>>>>            Left sItem To y (iPos -1)
51760>>>>>>>>>>
51760>>>>>>>>>            Right sItem To sItem (Length(sItem) -iPos)
51762>>>>>>>>>>
51762>>>>>>>>>
51762>>>>>>>>>            If iMode eq smBottomRight ;                Set Size of ho To (cy -y -Hi(xy)) (cx -x -Low(xy))
51765>>>>>>>>>            If iMode eq smTopRight ;                Set Size of ho To y (cx -x -Low(xy))
51768>>>>>>>>>            If iMode eq smTopLeft ;                Set Size of ho To (cy -Hi(xy)) (cx -Low(xy))
51771>>>>>>>>>            If iMode eq smBottomLeft ;                Set Size of ho To (cy -y -Hi(xy)) x
51774>>>>>>>>>
51774>>>>>>>>>
51774>>>>>>>>>        Loop
51775>>>>>>>>>>
51775>>>>>>>>>    End_Procedure
51776>>>>>>>>>
51776>>>>>>>>>End_Class
51777>>>>>>>>>
51777>>>>>>>>>
51777>>>>>>>>>//cSize_mx.pkg (Continued)
51777>>>>>>>>>
51777>>>>>>>>>Class cSize_mx Is A Mixin
51778>>>>>>>>>    Procedure Define_cSize_mx
51780>>>>>>>>>        Forward Send Construct_Object
51782>>>>>>>>>
51782>>>>>>>>>        Object oAlignModes Is A cAlignModes
51784>>>>>>>>>        End_Object
51785>>>>>>>>>        Object oSizeModes Is A cSizeModes
51787>>>>>>>>>        End_Object
51788>>>>>>>>>
51788>>>>>>>>>    End_Procedure
51789>>>>>>>>>
51789>>>>>>>>>    Procedure DoRegAlign Integer ho Integer iMode
51791>>>>>>>>>        Send DoAdd To (oAlignModes(Current_Object)) ho iMode
51792>>>>>>>>>    End_Procedure
51793>>>>>>>>>
51793>>>>>>>>>    Procedure DoRegSize Integer ho Integer iMode
51795>>>>>>>>>        Send DoAdd To (oSizeModes(Current_Object)) ho iMode
51796>>>>>>>>>    End_Procedure
51797>>>>>>>>>
51797>>>>>>>>>    Procedure OnResize
51799>>>>>>>>>        Forward Send OnResize
51801>>>>>>>>>        Send DoResize To (oAlignModes(Current_Object))
51802>>>>>>>>>        Send DoResize To (oSizeModes(Current_Object))
51803>>>>>>>>>    End_Procedure
51804>>>>>>>>>
51804>>>>>>>>>End_Class
51805>>>>>>>>>
51805>>>>>>>
51805>>>>>>>Class DbviewSub Is A Dbview
51806>>>>>>>
51806>>>>>>>    Procedure Construct_Object
51808>>>>>>>        Forward Send Construct_Object
51810>>>>>>>        On_Key Key_F12 Send Request_Save_No_Clear
51811>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
51811>>>>>>>        Send Define_cSize_mx
51812>>>>>>>        Property Integer pbVerifyExitApplication True
51813>>>>>>>        Property Integer pidbViewID              0
51814>>>>>>>        Property String  psdbViewName            ''
51815>>>>>>>    End_Procedure //Construct_Object
51816>>>>>>>
51816>>>>>>>    Procedure End_Construct_Object
51818>>>>>>>        Forward Send End_Construct_Object
51820>>>>>>>        Local Integer   idbViewID
51820>>>>>>>        Local String    sdbViewName
51820>>>>>>>        Get Name           to sdbViewName
51821>>>>>>>        Set psdbViewName   to sdbViewName
51822>>>>>>>        Get Object_ID      to idbViewID
51823>>>>>>>        Set pidbViewID     to idbViewID
51824>>>>>>>
51824>>>>>>>
51824>>>>>>>
51824>>>>>>>    End_Procedure //Construct_Object
51825>>>>>>>
51825>>>>>>>
51825>>>>>>>
51825>>>>>>>    Procedure Page Integer PageMode
51827>>>>>>>        Integer hWnd
51827>>>>>>>        Forward Send Page PageMode
51829>>>>>>>        Get Window_Handle to hWnd
51830>>>>>>>        If (hWnd) Begin
51832>>>>>>>            Send GreekSysMenu
51833>>>>>>>        End
51833>>>>>>>>
51833>>>>>>>    End_Procedure
51834>>>>>>>
51834>>>>>>>    Function Verify_Exit_Application Returns Integer
51836>>>>>>>        Integer Fail bState
51836>>>>>>>
51836>>>>>>>        Get View_Changed to Fail // Ask for changes in Data-sets
51837>>>>>>>        Get pbVerifyExitApplication to bState
51838>>>>>>>        If (fail AND bState) ; // ok a change exist...activate changed view.            Get confirm ("    " + "'" + ;                        Label(Current_Object) + "'" + ;                        ".\n\n    ;" ) to fail
51841>>>>>>>        Function_return (fail AND bState)
51842>>>>>>>    End_Function
51843>>>>>>>
51843>>>>>>>    //-------------------------------------------------------------------
51843>>>>>>>    // Change: Table entry checking - attempt to save header record
51843>>>>>>>    //         before entering a table (this is called by table. Return
51843>>>>>>>    //         a non-zero if the save failed (i.e., don't enter table)
51843>>>>>>>    //-------------------------------------------------------------------
51843>>>>>>>
51843>>>>>>>    Function Save_header returns integer
51845>>>>>>>        Local integer Rec Changed Srvr liSaveMsg
51845>>>>>>>        Get Server to Srvr                // The Header DDO.
51846>>>>>>>        If (Srvr) Begin
51848>>>>>>>            Get Current_Record of Srvr to Rec // The current order rec#.
51849>>>>>>>            Get Should_Save to Changed        // Are there any current changes?
51850>>>>>>>
51850>>>>>>>            // If there is no record and no changes we have an error.
51850>>>>>>>            //If (Rec=0 AND Changed=0) Begin // no rec
51850>>>>>>>            //    Error 300 '     \n\n    !'
51850>>>>>>>            //    Function_Return 1
51850>>>>>>>            //End
51850>>>>>>>            Get Verify_Save_MSG to liSaveMsg         // the old confirmation
51851>>>>>>>            Set Verify_Save_MSG to GET_No_Confirmation // disable confirmation
51852>>>>>>>            If (Rec=0 AND Changed) Begin
51854>>>>>>>                // Attempt to Save the current Record
51854>>>>>>>                // request_save_no_clear does a save without clearing.
51854>>>>>>>                Send request_save_no_clear
51855>>>>>>>            End
51855>>>>>>>>
51855>>>>>>>            // The save succeeded if there are now no changes, and we
51855>>>>>>>            // have a saved record. Should_save tells us if we've got changes.
51855>>>>>>>            // We must check the data-sets current_record property to see if
51855>>>>>>>            // we have a record. If it is 0, we had no save.
51855>>>>>>>            Get Should_Save to Changed  // is a save still needed
51856>>>>>>>            Get Current_record of Srvr to Rec // current record of the DD
51857>>>>>>>            // if no record or changes still exist, return an error code of 1
51857>>>>>>>            Set Verify_Save_MSG to liSaveMsg         // restore old confirm
51858>>>>>>>        End
51858>>>>>>>>
51858>>>>>>>        If (Rec=0) ;            Function_return 1
51861>>>>>>>    end_function
51862>>>>>>>
51862>>>>>>>//    Procedure Close_Panel
51862>>>>>>>//        Local Integer liScope
51862>>>>>>>//        Move (Prior_Scope(Desktop)) To liScope
51862>>>>>>>//        Move (Scope_Focus(liScope)) To liScope
51862>>>>>>>//        Forward Send Close_Panel
51862>>>>>>>//        Send Activate To liScope
51862>>>>>>>//    End_Procedure // Close_Panel
51862>>>>>>>
51862>>>>>>>//    Procedure RefreshView
51862>>>>>>>//        Integer iChanged
51862>>>>>>>//        // Do not refresh the view if unsaved changes have been made.
51862>>>>>>>//        Broadcast Recursive Get Data_Set_Should_Save to iChanged
51862>>>>>>>//        If iChanged Procedure_Return
51862>>>>>>>//        // pInRefreshView and pAlreadyRefreshed are for optimization.
51862>>>>>>>//        // Without these properties, Refresh_Page may be sent as part of the Request_Assign
51862>>>>>>>//        // of a grid's Parent DD, and then in the Broadcast of Refresh_Current_Page.
51862>>>>>>>//        // Set pInRefreshView True first, and then False at the end so that this optimization
51862>>>>>>>//        // does not effect any other occurences of Refresh_Page.
51862>>>>>>>//        Broadcast Recursive Set pInRefreshView      to True
51862>>>>>>>//        Broadcast Recursive Set pAlreadyRefreshed   to False
51862>>>>>>>//        // Restore the record for the top row of any grid in the view.
51862>>>>>>>//        // This stops a grid for a child file from jumping to the top of the list when DDRefresh is sent to the parent DDO.
51862>>>>>>>//        Broadcast Recursive Send RestoreTopRecord
51862>>>>>>>//        Broadcast Recursive Send DDRefresh              // Sent to all child DDs to redisplay the current record, clearing if not found.
51862>>>>>>>//        // Refresh_Current_Page is really only needed for the case that the current record of a grid has been
51862>>>>>>>//        // deleted.  In that case, the DDRefresh has cleared a row and moved the deleted record down, so the grid
51862>>>>>>>//        // has to be refreshed again.
51862>>>>>>>//        Broadcast Recursive Send Refresh_Current_Page   // Sent to all dbGrids to refresh the entire grid without changing the top record.
51862>>>>>>>//        Broadcast Recursive Set pInRefreshView      to False
51862>>>>>>>//        Broadcast Recursive Set pAlreadyRefreshed   to False
51862>>>>>>>//    End_Procedure
51862>>>>>>>
51862>>>>>>>//    // Refresh the view during Entering_Scope
51862>>>>>>>//    Procedure Entering_Scope
51862>>>>>>>//        Send RefreshView
51862>>>>>>>//        Forward Send Entering_Scope
51862>>>>>>>//    End_Procedure
51862>>>>>>>
51862>>>>>>>
51862>>>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
51863>>>>>>>    Import_Class_Protocol cSize_mx
51864>>>>>>>
51864>>>>>>>End_Class //dbviewSub
51865>>>>>USE DBBITMAP.Sub    //09. dbbitmap
Including file: DBBITMAP.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBBITMAP.SUB)
51865>>>>>>>Use dfClient
51865>>>>>>>Use dbBitmap
51865>>>>>>>
51865>>>>>>>Class DbbitmapSub Is A Dbbitmap
51866>>>>>>>End_Class //DbbitmapSub
51867>>>>>>>
51867>>>>>>>
51867>>>>>>>
51867>>>>>>>
51867>>>>>USE PANEL.Sub       //10. panel - modalpanel
Including file: PANEL.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PANEL.SUB)
51867>>>>>>>
51867>>>>>>>Use DfDafmac.pkg
51867>>>>>>>Use Data_Set.pkg
51867>>>>>>>Use DfClient.pkg
51867>>>>>>>Use DfPanel.pkg
51867>>>>>>>Use WinusrEz.pkg
51867>>>>>>>Use General.pkg
51867>>>>>>>Use cSize_mx.pkg
51867>>>>>>>Use Wspace.ezc
Including file: WSPACE.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\WSPACE.EZC)
51867>>>>>>>>>// ****************************************************************************
51867>>>>>>>>>// *Code Style   : OBJECT                                                     *
51867>>>>>>>>>// *Name         : WSPACE.EZC                                                 *
51867>>>>>>>>>// *Revision     : 1                                                          *
51867>>>>>>>>>// *Location     : \HOMEWIN.DEV\_EZ8.PKG                                      *
51867>>>>>>>>>// *Creation Date: 05/05/98                                                   *
51867>>>>>>>>>// *Last Update  :                                                            *
51867>>>>>>>>>// *Author       : JA                                                         *
51867>>>>>>>>>// *Includes     : GENERAL.PKG                                                *
51867>>>>>>>>>//                 cApplication.pkg                                           *
51867>>>>>>>>>// *Description  : cApplication_EZ CLASS                                      *
51867>>>>>>>>>// *--------------------------------------------------------------------------*
51867>>>>>>>>>// *Public    I/F:                                                            *
51867>>>>>>>>>// *   Properties:                                                            *
51867>>>>>>>>>// *   Methods   :                                                            *
51867>>>>>>>>>// *--------------------------------------------------------------------------*
51867>>>>>>>>>// *Protected I/F:                                                            *
51867>>>>>>>>>// *   Properties:                                                            *
51867>>>>>>>>>// *   Methods   :                                                            *
51867>>>>>>>>>// *--------------------------------------------------------------------------*
51867>>>>>>>>>// *Private   I/F:                                                            *
51867>>>>>>>>>// *   Properties:                                                            *
51867>>>>>>>>>// *   Methods   :                                                            *
51867>>>>>>>>>// *--------------------------------------------------------------------------*
51867>>>>>>>>>// *Comments     :                                                            *
51867>>>>>>>>>// *                                                                          *
51867>>>>>>>>>// *                                                                          *
51867>>>>>>>>>// *--------------------------------------------------------------------------*
51867>>>>>>>>>// *nown bugs   :                                                            *
51867>>>>>>>>>// ****************************************************************************
51867>>>>>>>>>Use cApplication.Pkg
51867>>>>>>>>>
51867>>>>>>>>>Class cApplication_Ez Is A cApplication
51868>>>>>>>>>
51868>>>>>>>>>    Procedure Construct_Object
51870>>>>>>>>>        Forward Send Construct_Object
51872>>>>>>>>>        Property Integer Disable_Keyboard_State Public False
51873>>>>>>>>>    End_Procedure
51874>>>>>>>>>
51874>>>>>>>>>End_Class // cApplication_Ez
51875>>>>>>>
51875>>>>>>>Use AccKeymx.ezc
51875>>>>>>>//Use IcoPnlMx.ezc
51875>>>>>>>Use SaveEnMx.ezc
Including file: SAVEENMX.EZC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\SAVEENMX.EZC)
51875>>>>>>>>>use dfclient
51875>>>>>>>>>Use dfallent
51875>>>>>>>>>
51875>>>>>>>>>
51875>>>>>>>>>// Mixin Class - For Saving Environment for BasicPanel And ModalPanel Classe
51875>>>>>>>>>Class SavePanelEnvironment_Mixin is a Mixin
51876>>>>>>>>>
51876>>>>>>>>>    Procedure Define_SavePanelEnvironment_Mixin
51878>>>>>>>>>        Property Integer piSaveEnvironment False
51879>>>>>>>>>    End_Procedure // Define_DisableAcceleratorKey_Mixin
51880>>>>>>>>>
51880>>>>>>>>>    Function Local_Object_name string nm returns string
51882>>>>>>>>>     Integer ps
51882>>>>>>>>>
51882>>>>>>>>>     Repeat
51882>>>>>>>>>>
51882>>>>>>>>>       pos "." in nm to ps
51884>>>>>>>>>>
51884>>>>>>>>>       If ps eq 0 function_return nm
51887>>>>>>>>>       increment ps
51888>>>>>>>>>       Mid Nm to Nm 255 ps
51891>>>>>>>>>>
51891>>>>>>>>>     Loop
51892>>>>>>>>>>
51892>>>>>>>>>    end_function // Local_Object_name
51893>>>>>>>>>
51893>>>>>>>>>    //  Take string "#1,#2" and return integer hi #1 + #2
51893>>>>>>>>>    Function Parse_Complex string sVal returns integer
51895>>>>>>>>>        Local integer ps
51895>>>>>>>>>        Pos "," in sVal to ps
51897>>>>>>>>>>
51897>>>>>>>>>        if ps ;            Function_Return ( integer(left(sVal,ps-1))*65536 + ;                            integer(mid(sVal,255,ps+1)) )
51900>>>>>>>>>    End_Function // Parse_Complex
51901>>>>>>>>>
51901>>>>>>>>>    // Convert a complex integer to a string "hi,Low"
51901>>>>>>>>>    //
51901>>>>>>>>>    Function Complex_to_String integer i1 returns string
51903>>>>>>>>>        function_return ( string(hi(i1)) - "," - String(low(i1)) )
51904>>>>>>>>>    End_function // Complex_to_String
51905>>>>>>>>>
51905>>>>>>>>>    Procedure Save_Environment
51907>>>>>>>>>        String nm Vn
51907>>>>>>>>>        Integer H st
51907>>>>>>>>>
51907>>>>>>>>>        Get piSaveEnvironment to St
51908>>>>>>>>>        If (st=TRUE) Begin
51910>>>>>>>>>        // Note with the 3.05 version we will have problems if the view has
51910>>>>>>>>>        // been maximized and then iconized. We still don't know what the normal
51910>>>>>>>>>        // size/loc is when maximized. We will take a chance and assume that an
51910>>>>>>>>>        // iconized view is always non-zoomed (since views don't support the zoom
51910>>>>>>>>>        // button).
51910>>>>>>>>>        If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
51912>>>>>>>>>
51912>>>>>>>>>            Get Name to Vn // full name of object
51913>>>>>>>>>            Get Local_Object_Name Vn to Vn   // just get the local name
51914>>>>>>>>>            Get GUILocation to H             // complex location
51915>>>>>>>>>            Get Complex_to_String h to nm    // convert complex to "hi,low"
51916>>>>>>>>>            //Set System_Profile_String VN to ("LOC:"+Nm)
51916>>>>>>>>>            Send WriteString Of ghoApplication VN ("LOC:"+Nm)
51917>>>>>>>>>        End
51917>>>>>>>>>>
51917>>>>>>>>>        End
51917>>>>>>>>>>
51917>>>>>>>>>    End_Procedure // Save_Environment
51918>>>>>>>>>
51918>>>>>>>>>    Procedure Load_Environment
51920>>>>>>>>>        String nm Vn Lc
51920>>>>>>>>>        Integer H ps St
51920>>>>>>>>>
51920>>>>>>>>>        Get piSaveEnvironment to St
51921>>>>>>>>>        If (st=TRUE) Begin
51923>>>>>>>>>            Set Locate_Mode to No_Locate
51924>>>>>>>>>            // see above for reasoning on this
51924>>>>>>>>>            If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
51926>>>>>>>>>            Get Name to Vn
51927>>>>>>>>>            Get Local_Object_Name Vn to Vn
51928>>>>>>>>>            //Get System_Profile_String Vn to Nm
51928>>>>>>>>>            Get ReadString Of ghoApplication Vn to Nm
51929>>>>>>>>>            IF Nm ne '' Begin
51931>>>>>>>>>                Pos "LOC:" in Nm to Ps   // look for LOC:row,col
51933>>>>>>>>>>
51933>>>>>>>>>                If Ps Begin
51935>>>>>>>>>                    Mid Nm to Lc 255 (Ps+4)
51938>>>>>>>>>>
51938>>>>>>>>>                    Pos " " in Lc to ps
51940>>>>>>>>>>
51940>>>>>>>>>                    if Ps left lc to lc (ps-1)
51944>>>>>>>>>                    Get Parse_Complex lc to H
51945>>>>>>>>>                    Set GUILocation to (Hi(H)) (Low(H))
51946>>>>>>>>>                    Send Adjust_Logicals
51947>>>>>>>>>                End
51947>>>>>>>>>>
51947>>>>>>>>>            End
51947>>>>>>>>>>
51947>>>>>>>>>            End
51947>>>>>>>>>>
51947>>>>>>>>>        End
51947>>>>>>>>>>
51947>>>>>>>>>    End_Procedure // Load_Environment
51948>>>>>>>>>
51948>>>>>>>>>End_Class // cSavePanelEnvironment_Mixin
51949>>>>>>>
51949>>>>>>>CLASS PANELSub IS A PANEL
51950>>>>>>>
51950>>>>>>>    Procedure Construct_Object
51952>>>>>>>        Forward Send Construct_Object
51954>>>>>>>        Property Integer Description_State Public True
51955>>>>>>>        // To hold the property page id of an application
51955>>>>>>>        Property Integer piPropertiesObjectId Public 0
51956>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
51956>>>>>>>    End_Procedure
51957>>>>>>>
51957>>>>>>>    Procedure End_Construct_Object
51959>>>>>>>        Forward Send End_Construct_Object
51961>>>>>>>
51961>>>>>>>    End_Procedure //Construct_Object
51962>>>>>>>
51962>>>>>>>    Procedure Page Integer iMode
51964>>>>>>>        Forward Send Page iMode
51966>>>>>>>        Send GreekSysMenu
51967>>>>>>>    End_Procedure // Page
51968>>>>>>>
51968>>>>>>>
51968>>>>>>>    // Function Close_All_Views
51968>>>>>>>    // Close all open MDI views
51968>>>>>>>    // Returns 0 if all OK or <> 0 If must not continue closing
51968>>>>>>>    // 'bWith_Confirmation' is a boolean argument to get user confirmation
51968>>>>>>>    // before closing all views
51968>>>>>>>
51968>>>>>>>    Function Close_All_Views Integer bWith_Confirmation Returns Integer
51970>>>>>>>        Local Integer rVal lId liClientId Srvr liCount liLstViewId liAnswer liSaveMsg IsDeo
51970>>>>>>>        //Make an instance of a set to hold the views' ids
51970>>>>>>>        get make_set to liLstViewId
51971>>>>>>>        //Find the client application area
51971>>>>>>>        Get Client_Id to liClientId
51972>>>>>>>        If Not (liClientId) Move Self to liClientId
51975>>>>>>>        //Find the views
51975>>>>>>>        Get Next_Mdi_Dialog of liClientId TRUE to lId // find first
51976>>>>>>>        While lId
51980>>>>>>>            // Only the active views
51980>>>>>>>            If (Active_state(lId)) Begin
51982>>>>>>>                // If Confirmation required
51982>>>>>>>                If (bWith_Confirmation) Begin
51984>>>>>>>                    Get is_Function Get_DEO_Object lId False to IsDeo
51985>>>>>>>                    If IsDeo Begin
51987>>>>>>>                        //Find their servers
51987>>>>>>>                        Get Server of lId to Srvr
51988>>>>>>>                        //If have one find if are changed
51988>>>>>>>                        If (Srvr) Get Should_Save of Srvr to rVal
51991>>>>>>>                        //If changed do nothing and destroy the set
51991>>>>>>>                        If (rVal) Begin
51993>>>>>>>                            Send Activate_View to lId
51994>>>>>>>                            // If Found first changed ask
51994>>>>>>>                            If Not (liAnswer) Get YesNo_Box ("   " + "'" + (Trim(Label(lId))) + "'.\n  ?") "" MB_DEFBUTTON1 MB_ICONQUESTION to liAnswer
51997>>>>>>>                            If (liAnswer = MBR_No) Begin
51999>>>>>>>                                send destroy_object to liLstViewId
52000>>>>>>>                                Function_Return rVal
52001>>>>>>>                            End // liAnswer = MBR_No
52001>>>>>>>>
52001>>>>>>>                        End  // rVal
52001>>>>>>>>
52001>>>>>>>                    End // IsDeoControl
52001>>>>>>>>
52001>>>>>>>                End // bWith_Confirmation
52001>>>>>>>>
52001>>>>>>>                Send Add_Element to liLstViewId lId
52002>>>>>>>            End // (Active_state(lId))
52002>>>>>>>>
52002>>>>>>>            Get Next_Mdi_Dialog of liClientId FALSE to lId // find next
52003>>>>>>>        End  // While
52004>>>>>>>>
52004>>>>>>>
52004>>>>>>>        // If answer is to close all views
52004>>>>>>>        Move 0 to rval
52005>>>>>>>
52005>>>>>>>        //if must close the views close them without exit confirmation
52005>>>>>>>        For liCount From 0 to (Item_Count(liLstViewId) - 1)
52011>>>>>>>>
52011>>>>>>>            Get integer_value of liLstViewId Item liCount to lId
52012>>>>>>>            Get is_Function Get_DEO_Object lId False to IsDeo
52013>>>>>>>            If IsDeo Begin
52015>>>>>>>              Get Verify_Exit_MSG of lId to liSaveMsg           // the old confirmation
52016>>>>>>>              Set Verify_Exit_MSG of lId to GET_No_Confirmation // disable confirmation
52017>>>>>>>              Send Request_Cancel to lId // send notify_all_views MSG_Close_Client lId False //Another method
52018>>>>>>>              Set Verify_Exit_MSG of lId to liSaveMsg         // restore old confirm
52019>>>>>>>            End
52019>>>>>>>>
52019>>>>>>>            Else send Close_Panel to lId
52021>>>>>>>        Loop
52022>>>>>>>>
52022>>>>>>>
52022>>>>>>>        //destroy the set
52022>>>>>>>        send destroy_object to liLstViewId
52023>>>>>>>        Function_Return rVal
52024>>>>>>>    End_Procedure //Close_all_Views
52025>>>>>>>
52025>>>>>>>    //Register_Object ProgramWorkSpace
52025>>>>>>>
52025>>>>>>>    // For controlling multiple Instances via Panel Label
52025>>>>>>>    Procedure Set Label String sLabel
52027>>>>>>>        Local String Current_Module
52027>>>>>>>        Local Integer bState
52027>>>>>>>        Forward Set Label to sLabel
52029>>>>>>>        Get Description_State to bState
52030>>>>>>>        If (bState) Begin
52032>>>>>>>            get_profile_string "WorkSpaces" "CurrentWorkspace" to Current_Module
52035>>>>>>>            If Current_Module eq "" Get psWorkspaceName of (phoWorkspace(ghoApplication)) to Current_Module
52038>>>>>>>            insert "WorkSpaces\" in Current_Module at 1
52040>>>>>>>            Append Current_Module "\" (Module_Name(Self))
52042>>>>>>>            set_profile_string Current_Module "Description" to (ToAnsi(sLabel))
52045>>>>>>>        End
52045>>>>>>>>
52045>>>>>>>    End_Procedure
52046>>>>>>>
52046>>>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
52047>>>>>>>
52047>>>>>>>End_Class //PanelSub
52048>>>>>>>
52048>>>>>>>
52048>>>>>>>Class ModalpanelSub Is A Modalpanel
52049>>>>>>>
52049>>>>>>>    Import_Class_Protocol Csize_Mx
52050>>>>>>>
52050>>>>>>>    Procedure Construct_Object
52052>>>>>>>        Forward Send Construct_Object
52054>>>>>>>        Send Define_cSize_mx
52055>>>>>>>        Send Define_SavePanelEnvironment_Mixin
52056>>>>>>>        Property Integer Description_State False
52057>>>>>>>        Property Integer pbToolWindow False
52058>>>>>>>    End_Procedure
52059>>>>>>>
52059>>>>>>>    Procedure End_Construct_Object
52061>>>>>>>        Send Load_Environment
52062>>>>>>>        Forward Send End_Construct_Object
52064>>>>>>>        Set Extended_Window_Style To WS_EX_TOOLWINDOW (pbToolWindow(Self))
52065>>>>>>>
52065>>>>>>>    End_Procedure //End_Construct_Object
52066>>>>>>>
52066>>>>>>>    Procedure Page integer PageMode
52068>>>>>>>        Forward Send Page PageMode
52070>>>>>>>        Send GreekSysMenu
52071>>>>>>>    End_Procedure
52072>>>>>>>
52072>>>>>>>
52072>>>>>>>    // For controlling multiple Instances via ModalPanel Label
52072>>>>>>>    Procedure Set Label String sLabel
52074>>>>>>>        Local String Current_Module
52074>>>>>>>        Local Integer bState
52074>>>>>>>        Forward Set Label to sLabel
52076>>>>>>>        Get Description_State to bState
52077>>>>>>>        If (bState) Begin
52079>>>>>>>            get_profile_string "WorkSpaces" "CurrentWorkspace" to Current_Module
52082>>>>>>>            If Current_Module eq "" Get psWorkspaceName of (phoWorkspace(ghoApplication)) to Current_Module
52085>>>>>>>            insert "WorkSpaces\" in Current_Module at 1
52087>>>>>>>            Append Current_Module "\" (Module_Name(Self))
52089>>>>>>>            set_profile_string Current_Module "DialogLabel" to (ToAnsi(sLabel))
52092>>>>>>>        End
52092>>>>>>>>
52092>>>>>>>    End_Procedure
52093>>>>>>>
52093>>>>>>>    Procedure Notify_Exit_Application
52095>>>>>>>        Send Save_Environment
52096>>>>>>>        Forward Send Notify_Exit_Application
52098>>>>>>>    End_procedure // Notify_Exit_Application
52099>>>>>>>
52099>>>>>>>    Import_Class_Protocol SavePanelEnvironment_Mixin
52100>>>>>>>END_CLASS //modalpanelSub
52101>>>>>>>
52101>>>>>>>
52101>>>>>>>Class BasicpanelSub Is A Basicpanel
52102>>>>>>>
52102>>>>>>>    Import_Class_Protocol Csize_Mx
52103>>>>>>>
52103>>>>>>>    Procedure Construct_Object
52105>>>>>>>        Forward Send Construct_Object
52107>>>>>>>        Send Define_Csize_Mx
52108>>>>>>>        Send Define_SavePanelEnvironment_Mixin
52109>>>>>>>        Property Integer Description_State Public False
52110>>>>>>>    End_Procedure
52111>>>>>>>
52111>>>>>>>    Procedure End_Construct_Object
52113>>>>>>>        Send Load_Environment
52114>>>>>>>        Forward Send End_Construct_Object
52116>>>>>>>    End_Procedure //End_Construct_Object
52117>>>>>>>
52117>>>>>>>    Procedure Page Integer Pagemode
52119>>>>>>>        Forward Send Page Pagemode
52121>>>>>>>         Send Greeksysmenu
52122>>>>>>>    End_Procedure
52123>>>>>>>
52123>>>>>>>    // For Controlling Multiple Instances Via Basicpanel Label
52123>>>>>>>    Procedure Set Label String Slabel
52125>>>>>>>        Local String Current_Module
52125>>>>>>>        Local Integer Bstate
52125>>>>>>>        Forward Set Label To Slabel
52127>>>>>>>        Get Description_State To Bstate
52128>>>>>>>        If (Bstate) Begin
52130>>>>>>>            Get_Profile_String "Workspaces" "Currentworkspace" To Current_Module
52133>>>>>>>            If Current_Module Eq "" Get psWorkspacename Of (phoWorkspace(ghoApplication)) To Current_Module
52136>>>>>>>            Insert "Workspaces\" In Current_Module At 1
52138>>>>>>>            Append Current_Module "\" (Module_Name(Self))
52140>>>>>>>            Set_Profile_String Current_Module "Dialoglabel" To (Toansi(Slabel))
52143>>>>>>>        End
52143>>>>>>>>
52143>>>>>>>    End_Procedure
52144>>>>>>>
52144>>>>>>>    Procedure Notify_Exit_Application
52146>>>>>>>        Send Save_Environment
52147>>>>>>>        Forward Send Notify_Exit_Application
52149>>>>>>>    End_procedure // Notify_Exit_Application
52150>>>>>>>
52150>>>>>>>    Import_Class_Protocol SavePanelEnvironment_Mixin
52151>>>>>>>End_Class //BasicpanelSub
52152>>>>>USE DBPANEL.Sub     //37. dbmodalpanel
Including file: DBPANEL.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBPANEL.SUB)
52152>>>>>>>Use dfClient
52152>>>>>>>
52152>>>>>>>
52152>>>>>>>Use cSize_mx.pkg
52152>>>>>>>Use SaveEnMx.ezc
52152>>>>>>>
52152>>>>>>>Class Dbmodalpanelsub Is A Dbmodalpanel
52153>>>>>>>
52153>>>>>>>      Import_Class_Protocol Csize_Mx
52154>>>>>>>
52154>>>>>>>      Procedure Construct_Object
52156>>>>>>>          Forward Send Construct_Object
52158>>>>>>>          Send Define_Csize_Mx
52159>>>>>>>          Send Define_SavePanelEnvironment_Mixin
52160>>>>>>>          Property Integer Description_State Public False
52161>>>>>>>          Property Integer pbToolWindow False
52162>>>>>>>      End_Procedure
52163>>>>>>>
52163>>>>>>>      Procedure End_Construct_Object
52165>>>>>>>           Send Load_Environment
52166>>>>>>>           Forward Send End_Construct_Object
52168>>>>>>>           Set Extended_Window_Style To WS_EX_TOOLWINDOW (pbToolWindow(Self))
52169>>>>>>>
52169>>>>>>>      End_Procedure //End_Construct_Object
52170>>>>>>>
52170>>>>>>>    Procedure Page Integer Pagemode
52172>>>>>>>        Local Integer Hwnd Hsmid Iitems Bstate
52172>>>>>>>        Forward Send Page Pagemode
52174>>>>>>>        Get Window_Handle To Hwnd
52175>>>>>>>        If Hwnd Ne 0 Begin
52177>>>>>>>            Move (Getsystemmenu(Hwnd,False)) To Hsmid
52178>>>>>>>            Move (Getmenuitemcount(Hsmid)) To Iitems
52179>>>>>>>            Move (Modifymenu(Hsmid,0,Mf_Byposition + Mf_String,Sc_Move,("    "+"&Move"))) To Bstate
52180>>>>>>>            If Iitems Eq 3 Begin
52182>>>>>>>                Move (Modifymenu(Hsmid,1,Mf_Byposition + Mf_String,Sc_Size,("    "+" &Size"))) To Bstate
52183>>>>>>>                Move (Modifymenu(Hsmid,2,Mf_Byposition + Mf_String,Sc_Close,("   "+"&Close     Alt+f4"))) To Bstate
52184>>>>>>>            End
52184>>>>>>>>
52184>>>>>>>            Else Begin
52185>>>>>>>                If Iitems Eq 2 Move (Modifymenu(Hsmid,1,Mf_Byposition + Mf_String,Sc_Close,("   "+"E&xit     Alt+f4"))) To Bstate
52188>>>>>>>            End
52188>>>>>>>>
52188>>>>>>>        End
52188>>>>>>>>
52188>>>>>>>    End_Procedure
52189>>>>>>>
52189>>>>>>>    // For Controlling Multiple Instances Via Modalpanel Label
52189>>>>>>>    Procedure Set Label String Slabel
52191>>>>>>>        Local String Current_Module
52191>>>>>>>        Local Integer Bstate
52191>>>>>>>        Forward Set Label To Slabel
52193>>>>>>>        Get Description_State To Bstate
52194>>>>>>>        If (Bstate) Begin
52196>>>>>>>            Get_Profile_String "Workspaces" "Currentworkspace" To Current_Module
52199>>>>>>>            If Current_Module Eq "" Get psWorkspacename Of (phoWorkspace(ghoApplication)) To Current_Module
52202>>>>>>>            Insert "Workspaces\" In Current_Module At 1
52204>>>>>>>            Append Current_Module "\" (Module_Name(Self))
52206>>>>>>>            Set_Profile_String Current_Module "Dialoglabel" To (Toansi(Slabel))
52209>>>>>>>        End
52209>>>>>>>>
52209>>>>>>>    End_Procedure
52210>>>>>>>
52210>>>>>>>    Procedure Notify_Exit_Application
52212>>>>>>>        Send Save_Environment
52213>>>>>>>        Forward Send Notify_Exit_Application
52215>>>>>>>    End_procedure // Notify_Exit_Application
52216>>>>>>>
52216>>>>>>>    Import_Class_Protocol SavePanelEnvironment_Mixin
52217>>>>>>>End_Class //Dbmodalpanelsub
52218>>>>>>>
52218>>>>>>>
52218>>>>>>>
52218>>>>>>>
52218>>>>>>>
52218>>>>>>>
52218>>>>>USE DIALOG.Sub      //38. dialog
Including file: DIALOG.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DIALOG.SUB)
52218>>>>>>>Use dfClient
52218>>>>>>>Use Dftabdlg.pkg
52218>>>>>>>
52218>>>>>>>Class Dialogsub Is A Dialog
52219>>>>>>>End_Class //Dialogsub
52220>>>>>>>
52220>>>>>>>
52220>>>>>>>
52220>>>>>
52220>>>>>//***************************************************************************
52220>>>>>//            Various                                                       *
52220>>>>>//***************************************************************************
52220>>>>>USE PROGRBAR.Sub      //13. ProgressBar
Including file: PROGRBAR.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PROGRBAR.SUB)
52220>>>>>>>
52220>>>>>>>Use DFPrgRes.PKG
Including file: Dfprgres.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\Dfprgres.pkg)
52220>>>>>>>>>//************************************************************************
52220>>>>>>>>>//--- DFPrgRes.pkg   PROGRESS-BAR
52220>>>>>>>>>//
52220>>>>>>>>>// Copyright (c) 1983-1997 Data Access Corporation, Miami Florida,
52220>>>>>>>>>// All rights reserved.
52220>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
52220>>>>>>>>>//
52220>>>>>>>>>//************************************************************************
52220>>>>>>>>>//  Description:
52220>>>>>>>>>//      DataFlex class of the Windows' Progress-Bar
52220>>>>>>>>>//
52220>>>>>>>>>//  Author: Stuart W. Booth
52220>>>>>>>>>// 07/23/96 JJT - New Class names
52220>>>>>>>>>//************************************************************************
52220>>>>>>>>>
52220>>>>>>>>>USE WINDOWS.pkg
52220>>>>>>>>>USE CommCtrl.pkg
52220>>>>>>>>>
52220>>>>>>>>>Define PBM_SETRANGE32  for (WM_USER+6)     // lParam = high, wParam = low
52220>>>>>>>>>
52220>>>>>>>>>
52220>>>>>>>>>// PUBLIC INTERFACE
52220>>>>>>>>>//
52220>>>>>>>>>//    PROPERTIES
52220>>>>>>>>>//
52220>>>>>>>>>//    Minimum_Position    integer  0          minimum progress-value
52220>>>>>>>>>//    Maximum_Position    integer  100        maximum progress-value
52220>>>>>>>>>//    Step_Value          integer  10         incremental-step value
52220>>>>>>>>>//    Current_Position    integer  0          current progress-value
52220>>>>>>>>>//
52220>>>>>>>>>//
52220>>>>>>>>>//    METHODS
52220>>>>>>>>>//
52220>>>>>>>>>//    Advance_Progress                  // step the progress-bar by Step_Value
52220>>>>>>>>>//    Advance_ProgressBy integer iValue // step the progress-bar by iValue
52220>>>>>>>>>//    Page_Object                       // augmented to send the private
52220>>>>>>>>>//                                      // Private_InitializwWindow message
52220>>>>>>>>>//
52220>>>>>>>>>//---PRIVATE INTERFACE---------------------------------------------------------
52220>>>>>>>>>//
52220>>>>>>>>>//    METHODS
52220>>>>>>>>>//
52220>>>>>>>>>//    Private_InitializeWindow // forwards construction params to Windows
52220>>>>>>>>>//
52220>>>>>>>>>// END INTERFACE
52220>>>>>>>>>
52220>>>>>>>>>
52220>>>>>>>>>Class AbstractProgressBar is a DfBaseControl
52221>>>>>>>>>    Procedure Construct_Object
52223>>>>>>>>>        Forward Send Construct_Object
52225>>>>>>>>>        Property integer Minimum_Position   0
52226>>>>>>>>>        Property integer Maximum_Position   100
52227>>>>>>>>>        Property integer Step_Value         10
52228>>>>>>>>>        Property integer Current_Position   //(Minimum_Position)
52229>>>>>>>>>    End_Procedure
52230>>>>>>>>>End_Class
52231>>>>>>>>>
52231>>>>>>>>>
52231>>>>>>>>>Class ProgressBar is a AbstractProgressBar
52232>>>>>>>>>    Procedure Construct_Object
52234>>>>>>>>>
52234>>>>>>>>>        Forward Send Construct_Object
52236>>>>>>>>>        Set External_Class_Name 'cObsoleteVdfProgressBar' To 'msctls_progress32'
52237>>>>>>>>>        Set Focus_Mode to NonFocusable
52238>>>>>>>>>        Set Skip_State to True
52239>>>>>>>>>
52239>>>>>>>>>    End_Procedure
52240>>>>>>>>>
52240>>>>>>>>>    Procedure SET Minimum_Position integer iMin
52242>>>>>>>>>        integer iMax
52242>>>>>>>>>        Get Maximum_Position To iMax
52243>>>>>>>>>        Forward SET Minimum_Position to iMin
52245>>>>>>>>>        Set Current_Position To iMin // reset
52246>>>>>>>>>        Send Windows_Message PBM_SETRANGE32 iMin iMax
52247>>>>>>>>>    End_Procedure
52248>>>>>>>>>
52248>>>>>>>>>    Procedure SET Maximum_Position integer iMax
52250>>>>>>>>>        Integer iMin
52250>>>>>>>>>        Get Minimum_Position To iMin
52251>>>>>>>>>        Send Windows_Message PBM_SETRANGE32 iMin iMax
52252>>>>>>>>>        Forward SET Maximum_Position to iMax
52254>>>>>>>>>    End_Procedure
52255>>>>>>>>>
52255>>>>>>>>>    Procedure SET Step_Value integer iStep
52257>>>>>>>>>        Send Windows_Message PBM_SETSTEP iStep 0
52258>>>>>>>>>        Forward SET Step_Value to iStep
52260>>>>>>>>>    End_Procedure
52261>>>>>>>>>
52261>>>>>>>>>    Procedure SET Current_Position integer iPos
52263>>>>>>>>>        Forward SET Current_Position To iPos
52265>>>>>>>>>        Send Windows_Message PBM_SETPOS iPos 0
52266>>>>>>>>>    End_Procedure
52267>>>>>>>>>
52267>>>>>>>>>    Procedure Advance_Progress
52269>>>>>>>>>        integer iPos iStep
52269>>>>>>>>>        Send Windows_Message PBM_STEPIT 0 0
52270>>>>>>>>>        Get Current_Position To iPos
52271>>>>>>>>>        Get Step_Value       To iStep
52272>>>>>>>>>        Forward Set Current_Position To (iPos +iStep) //forward to stop augment
52274>>>>>>>>>    End_procedure
52275>>>>>>>>>
52275>>>>>>>>>    Procedure Advance_ProgressBy  integer iAddBy
52277>>>>>>>>>        Integer iPos
52277>>>>>>>>>        Send Windows_Message PBM_DELTAPOS iAddBy 0
52278>>>>>>>>>        Get Current_Position To iPos
52279>>>>>>>>>        Forward Set Current_Position To (iPos +iAddBy)
52281>>>>>>>>>    End_procedure
52282>>>>>>>>>
52282>>>>>>>>>    Procedure Private_InitializeWindow
52284>>>>>>>>>        Integer iMin iMax iPos iStep
52284>>>>>>>>>        Get Minimum_Position To iMin
52285>>>>>>>>>        Get Maximum_Position To iMax
52286>>>>>>>>>        Get Current_Position To iPos
52287>>>>>>>>>        Get Step_Value       To iStep
52288>>>>>>>>>
52288>>>>>>>>>        Set Step_Value        To iStep
52289>>>>>>>>>        Set Minimum_Position  To iMin
52290>>>>>>>>>        Set Maximum_Position  To iMax
52291>>>>>>>>>        If iPos NE iMin Set Current_Position  To iPos
52294>>>>>>>>>    End_Procedure
52295>>>>>>>>>
52295>>>>>>>>>    Procedure Page integer iState
52297>>>>>>>>>        Forward Send Page iState
52299>>>>>>>>>        If (iState =1) Send Private_InitializeWindow
52302>>>>>>>>>    End_Procedure
52303>>>>>>>>>
52303>>>>>>>>>End_Class
52304>>>>>>>
52304>>>>>>>Class ProgressBarSub is a ProgressBar
52305>>>>>>>End_Class
52306>>>>>>>
52306>>>>>USE TRACKBAR.Sub      //14. TrackBar dbTrackbar
Including file: TRACKBAR.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TRACKBAR.SUB)
52306>>>>>>>Use TrckBr.pkg
52306>>>>>>>Use dbTrckBr.pkg
52306>>>>>>>
52306>>>>>>>Class TrackBarSub is a TrackBar
52307>>>>>>>End_Class
52308>>>>>>>
52308>>>>>>>Class dbTrackBarSub is a dbTrackBar
52309>>>>>>>End_Class
52310>>>>>>>
52310>>>>>USE TREEVIEW.Sub      //15. TreeView
Including file: TREEVIEW.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TREEVIEW.SUB)
52310>>>>>>>use DFTreeVw.PKG
52310>>>>>>>
52310>>>>>>>Class TreeViewSub is a TreeView
52311>>>>>>>End_Class
52312>>>>>>>
52312>>>>>
52312>>>>>//***************************************************************************
52312>>>>>//            Data containers                                               *
52312>>>>>//***************************************************************************
52312>>>>>USE DBGROUP.Sub     //16. dbgroup
Including file: DBGROUP.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBGROUP.SUB)
52312>>>>>>>Use dfClient
52312>>>>>>>
52312>>>>>>>
52312>>>>>>>Class DbgroupSub Is A Dbgroup
52313>>>>>>>    Procedure End_Construct_Object
52315>>>>>>>        Forward Send End_Construct_Object
52317>>>>>>>
52317>>>>>>>    End_Procedure //Construct_Object
52318>>>>>>>
52318>>>>>>>End_Class //DbgroupSub
52319>>>>>USE DBCONT3.Sub     //17. dbcontainer3d
Including file: DBCONT3.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBCONT3.SUB)
52319>>>>>>>Use dfClient
52319>>>>>>>Use dfTabdlg
52319>>>>>>>
52319>>>>>>>Class Dbcontainer3dSub Is A Dbcontainer3d
52320>>>>>>>    Procedure End_Construct_Object
52322>>>>>>>        Forward Send End_Construct_Object
52324>>>>>>>    End_Procedure //Construct_Object
52325>>>>>>>
52325>>>>>>>End_Class //Dbcontainer3dSub
52326>>>>>USE DBTABDLG.Sub    //18. dbtabdialog dbTabDialogView
Including file: DBTABDLG.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBTABDLG.SUB)
52326>>>>>>>Use dfClient
52326>>>>>>>Use dftabdlg
52326>>>>>>>
52326>>>>>>>
52326>>>>>>>
52326>>>>>>>Class dbTabDialogSub Is a dbTabDialog
52327>>>>>>>
52327>>>>>>>    Procedure End_Construct_Object
52329>>>>>>>        Forward Send End_Construct_Object
52331>>>>>>>
52331>>>>>>>    End_Procedure //Construct_Object
52332>>>>>>>
52332>>>>>>>
52332>>>>>>>//    Procedure OnEnterTab
52332>>>>>>>//        Showln 'OnEnterTab'
52332>>>>>>>//    End_Procedure
52332>>>>>>>
52332>>>>>>>//    Procedure OnLeaveTab
52332>>>>>>>//        Showln 'OnLeaveTab'
52332>>>>>>>//    End_Procedure
52332>>>>>>>
52332>>>>>>>//    Function Tab_Change Integer PageNumber Integer FocusMode Returns Integer
52332>>>>>>>//        Integer rVal hTabPage iCurrentTab
52332>>>>>>>//        Get Current_Tab to iCurrentTab
52332>>>>>>>//        If (iCurrentTab>=0) Begin
52332>>>>>>>//            Get Tab_Page_ID iCurrentTab to hTabPage
52332>>>>>>>//            Send OnLeaveTab to hTabPage
52332>>>>>>>//        End
52332>>>>>>>//        Forward Get Tab_Change PageNumber FocusMode to rVal
52332>>>>>>>
52332>>>>>>>//        Get Tab_Page_ID iCurrentTab to hTabPage
52332>>>>>>>//        If (hTabPage<>0) Send OnEnterTab to hTabPage
52332>>>>>>>
52332>>>>>>>//        Function_Return rVal
52332>>>>>>>//    End_Function
52332>>>>>>>
52332>>>>>>>      Function Exit_Loss_Confirmation Returns integer
52334>>>>>>>        Function_return (confirm(Current_Object,' .   ;'))
52335>>>>>>>      End_function
52336>>>>>>>
52336>>>>>>>End_Class //dbtabdialogSub
52337>>>>>>>
52337>>>>>>>Class DbtabpageSub Is A Dbtabpage
52338>>>>>>>    Procedure End_Construct_Object
52340>>>>>>>        Forward Send End_Construct_Object
52342>>>>>>>
52342>>>>>>>    End_Procedure //Construct_Object
52343>>>>>>>
52343>>>>>>>
52343>>>>>>>End_Class //DbtabpageSub
52344>>>>>>>
52344>>>>>>>
52344>>>>>>>Class dbTabDialogViewSub Is a dbTabDialogView
52345>>>>>>>
52345>>>>>>>    Procedure End_Construct_Object
52347>>>>>>>        Forward Send End_Construct_Object
52349>>>>>>>
52349>>>>>>>    End_Procedure //Construct_Object
52350>>>>>>>
52350>>>>>>>      Function Exit_Loss_Confirmation Returns integer
52352>>>>>>>        Function_return (confirm(Current_Object,' .   ;'))
52353>>>>>>>      End_function
52354>>>>>>>
52354>>>>>>>    Function tab_View_exit_loss returns integer
52356>>>>>>>       local integer obj oldmsg
52356>>>>>>>       get verify_exit_msg to oldmsg
52357>>>>>>>       Broadcast Get SubView_Changed to obj
52359>>>>>>>       if obj eq 0 ;          set verify_exit_msg to GET_No_Confirmation
52362>>>>>>>       Else Begin
52363>>>>>>>          send activate to obj
52364>>>>>>>          set verify_exit_msg to GET_Exit_Loss_Confirmation
52365>>>>>>>       End
52365>>>>>>>>
52365>>>>>>>       // Delegation Required to close the whole View
52365>>>>>>>       Delegate send request_cancel
52367>>>>>>>       set verify_exit_msg to oldmsg
52368>>>>>>>       function_return 1
52369>>>>>>>    end_function
52370>>>>>>>End_Class //dbtabdialogviewSub
52371>>>>>>>
52371>>>>>>>Class DbtabviewSub Is A Dbtabview
52372>>>>>>>    Procedure End_Construct_Object
52374>>>>>>>        Forward Send End_Construct_Object
52376>>>>>>>
52376>>>>>>>    End_Procedure //Construct_Object
52377>>>>>>>
52377>>>>>>>End_Class //DbtabviewSub
52378>>>>>>>
52378>>>>>USE DBRGROUP.Sub    //36. dbradiogroup
Including file: DBRGROUP.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBRGROUP.SUB)
52378>>>>>>>Use dfClient
52378>>>>>>>Use dfenrad
52378>>>>>>>
52378>>>>>>>Class DbradiogroupSub Is A Dbradiogroup
52379>>>>>>>    Procedure End_Construct_Object
52381>>>>>>>        Forward Send End_Construct_Object
52383>>>>>>>
52383>>>>>>>    End_Procedure //Construct_Object
52384>>>>>>>
52384>>>>>>>End_Class //DbradiogroupSub
52385>>>>>>>
52385>>>>>>>
52385>>>>>>>
52385>>>>>>>
52385>>>>>
52385>>>>>//***************************************************************************
52385>>>>>//            Data controls                                                 *
52385>>>>>//***************************************************************************
52385>>>>>USE DBLIST.Sub      //19. dblist
Including file: DBLIST.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DBLIST.SUB)
52385>>>>>>>Use dfClient
52385>>>>>>>Use dfSellst
52385>>>>>>>
52385>>>>>>>
52385>>>>>>>Class DblistSub Is A Dblist
52386>>>>>>>
52386>>>>>>>    Procedure Construct_Object
52388>>>>>>>        Forward Send Construct_Object
52390>>>>>>>        Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52391>>>>>>>        Property Integer Pbreverse_Find_Direction       Private False
52392>>>>>>>        Property Integer Header_Column_Sorted_State     Public  False
52393>>>>>>>        property integer Default_Request_Lookup         Public  False
52394>>>>>>>
52394>>>>>>>        Set Popup_Search_State to False
52395>>>>>>>        Set Find_Search_State  to True
52396>>>>>>>        //Send Define_Disableacceleratorkey_Mixin
52396>>>>>>>
52396>>>>>>>    End_Procedure
52397>>>>>>>
52397>>>>>>>    Procedure End_Construct_Object
52399>>>>>>>        Forward Send End_Construct_Object
52401>>>>>>>        Set Color                           to 15263976
52402>>>>>>>        Set TextColor                       to clNavy
52403>>>>>>>        Set CurrentRowColor                 to 14205112
52404>>>>>>>        Set Highlight_row_color             to 14205112
52405>>>>>>>        Set CurrentRowTextColor             to clNavy
52406>>>>>>>        Set CurrentCellColor                to 14205112
52407>>>>>>>        Set CurrentCellTextColor            to clNavy
52408>>>>>>>        Integer iItem iItems
52408>>>>>>>        String  sLabel
52408>>>>>>>        Set peDisabledTextColor to 4210752
52409>>>>>>>        //Set Modal_State to True
52409>>>>>>>    End_Procedure
52410>>>>>>>
52410>>>>>>>
52410>>>>>>>    Procedure Page Integer iMode
52412>>>>>>>        Local Integer liWhatKindOfSort
52412>>>>>>>        //You Have To Disable The Auto_Index_State Feature If You Want
52412>>>>>>>        //To Sort Thelist By Clicking The Column Header
52412>>>>>>>        Get Header_Column_Sorted_State To liWhatKindOfSort
52413>>>>>>>        If (liWhatKindOfSort) Set Auto_Index_State To False
52416>>>>>>>        Forward Send Page iMode
52418>>>>>>>    End_Procedure
52419>>>>>>>
52419>>>>>>>    // Augmented To Support Reverse Ordering If The User Clicks On A List-header
52419>>>>>>>    Procedure Establish_Find_Mode Integer Imode
52421>>>>>>>      Local Integer Ireverse_Find_Direction
52421>>>>>>>      If (Header_Column_Sorted_State(Self)) Begin
52423>>>>>>>        Get DblistSub.Pbreverse_Find_Direction To Ireverse_Find_Direction
52424>>>>>>>        If (Ireverse_Find_Direction) Begin
52426>>>>>>>            // Reverse All Finding Modes
52426>>>>>>>                 If iMode Eq (Ge)  Move (Le) To iMode
52429>>>>>>>            Else If iMode Eq (Le)  Move (Ge) To iMode
52433>>>>>>>            Else If iMode Eq (Gt)  Move (Lt) To iMode
52437>>>>>>>            Else If iMode Eq (Lt)  Move (Gt) To iMode
52441>>>>>>>        End
52441>>>>>>>>
52441>>>>>>>      End
52441>>>>>>>>
52441>>>>>>>      Forward Send Establish_Find_Mode iMode
52443>>>>>>>    End_Procedure // Establish_Find_Mode
52444>>>>>>>
52444>>>>>>>    // Augmented To Support Reverse Ordering If The User Clicks On A List-header
52444>>>>>>>    Procedure Find_Init Integer Idir
52446>>>>>>>      Integer Ireverse_Find_Direction
52446>>>>>>>      If (Header_Column_Sorted_State(Self)) Begin
52448>>>>>>>        Get DblistSub.Pbreverse_Find_Direction To Ireverse_Find_Direction
52449>>>>>>>        If (Ireverse_Find_Direction) Begin
52451>>>>>>>            // Reverse Directions For Finds
52451>>>>>>>            If Idir Eq Downward_Direction ;            Move Upward_Direction   To Idir
52454>>>>>>>            Else ;            Move Downward_Direction To Idir
52456>>>>>>>        End
52456>>>>>>>>
52456>>>>>>>      End
52456>>>>>>>>
52456>>>>>>>      Forward Send Find_Init Idir
52458>>>>>>>    End_Procedure // Find_Init
52459>>>>>>>
52459>>>>>>>    // This Procedure Is Augmented To Extent The Standard Behaviour Of Dataflex-lists
52459>>>>>>>    // To Reverse Ordering If The User Clicks On The Header.With His Left-mouse Button.
52459>>>>>>>    // This Is Standard Windows-behaviour That Can Also Be Seen In The Windows-explorer
52459>>>>>>>    // Or Outlook. Other Augmented Messages Are: Find_Init And Establish_Find_Mode
52459>>>>>>>    // Icolumn Is The Nr Of The Selected Column
52459>>>>>>>    Procedure Header_Mouse_Click Integer Icolumn
52461>>>>>>>      Local Integer Ireverse_Find_Direction Liordr iCurrent_Direction
52461>>>>>>>      Local Integer Icurrent_Column iLimit iiiii
52461>>>>>>>      Local String  sLabel sChar
52461>>>>>>>      If (Header_Column_Sorted_State(Self)) Begin
52463>>>>>>>        Get Current_Col To Icurrent_Column
52464>>>>>>>        // Reverse The Direction
52464>>>>>>>        Get DblistSub.Pbreverse_Find_Direction To Ireverse_Find_Direction
52465>>>>>>>        Set DblistSub.Pbreverse_Find_Direction To (Not(Ireverse_Find_Direction))
52466>>>>>>>
52466>>>>>>>        Get DblistSub.Pbreverse_Find_Direction To iCurrent_Direction
52467>>>>>>>        Forward Send Header_Mouse_Click Icolumn
52469>>>>>>>        // Redisplay The List With The Changed Ordering If The User Is Still In The Same
52469>>>>>>>        // Column. If This Is Not The Case, The List Is Already Refreshed...
52469>>>>>>>        If Icolumn Eq Icurrent_Column Begin
52471>>>>>>>            Get Col_Index Icurrent_Column To Liordr
52472>>>>>>>            If Liordr Ge 0 Set Ordering To Liordr
52475>>>>>>>            Get Item_Limit to iLimit
52476>>>>>>>            For iiiii From 0 to (iLimit-1)
52482>>>>>>>>
52482>>>>>>>                Get Header_Label  item iiiii    to sLabel
52483>>>>>>>                Move (Replaces('(+)',sLabel,''))  to sLabel
52484>>>>>>>                Move (Replaces('(-)',sLabel,''))  to sLabel
52485>>>>>>>                Move (Trim(sLabel))             to sLabel
52486>>>>>>>                Set Header_Label  item iiiii    to sLabel
52487>>>>>>>            Loop
52488>>>>>>>>
52488>>>>>>>
52488>>>>>>>            If (iCurrent_Direction) Move '(-)' to sChar
52491>>>>>>>            Else                    Move '(+)' to sChar
52493>>>>>>>            Get Header_Label  item Icurrent_Column  to sLabel
52494>>>>>>>            Move (Trim(sLabel))                     to sLabel
52495>>>>>>>            Set Header_Label  item Icurrent_Column  to (Trim((sLabel+' '+sChar)))
52496>>>>>>>
52496>>>>>>>            Send Beginning_Of_Data
52497>>>>>>>            Send Display
52498>>>>>>>        End
52498>>>>>>>>
52498>>>>>>>      End
52498>>>>>>>>
52498>>>>>>>      Else Forward Send Header_Mouse_Click Icolumn
52501>>>>>>>    End_Procedure // Header_Mouse_Click
52502>>>>>>>
52502>>>>>>>    Procedure Request_Lookup Integer iItem#
52504>>>>>>>        local integer iFile iField iIndx iFieldIndx iisFirst iCount iMax iStart iIsOvl iOffs1 iOffs2
52504>>>>>>>        local string sval
52504>>>>>>>        Integer liparent_file_count liParent_File_Pos lisrv liParent isParent liMainFile
52504>>>>>>>
52504>>>>>>>        get data_file  item iItem# to iFile
52505>>>>>>>        get data_field item iItem# to iField
52506>>>>>>>        get Main_File to liMainFile
52507>>>>>>>        get Server to lisrv
52508>>>>>>>        if (iFile = main_file(self) and not(default_request_lookup(self))) Begin
52510>>>>>>>            // Check if field is first in Index
52510>>>>>>>            get_attribute DF_FIELD_INDEX of iFile iField to iIndx
52513>>>>>>>            get_attribute DF_INDEX_SEGMENT_FIELD of iFile iIndx 1  to iFieldIndx
52516>>>>>>>            // Check if field in index is overlap field.
52516>>>>>>>            get_attribute DF_FIELD_OVERLAP of iFile iFieldIndx iField to iIsOvl
52519>>>>>>>            // Checks if field is first field in overlap field
52519>>>>>>>            if iIsOvl begin
52521>>>>>>>                get_attribute DF_FIELD_OFFSET of iFile iField     to iOffs1
52524>>>>>>>                get_attribute DF_FIELD_OFFSET of iFile iFieldIndx to iOffs2
52527>>>>>>>                move (iOffs1=iOffs2) to iIsFirst
52528>>>>>>>            End
52528>>>>>>>>
52528>>>>>>>            else move (iFieldIndx=iField) to iIsFirst
52530>>>>>>>            // If field is primary field in index, clear other values
52530>>>>>>>            //if iIsFirst Begin
52530>>>>>>>                get value item iItem# to sVal
52531>>>>>>>                if (server(self)) send clear to (server(self))  // make sure that recnum and invisible fields are cleared
52534>>>>>>>                else clear iFile
52536>>>>>>>                get base_item to iStart
52537>>>>>>>                move (iStart + item_limit (self)-1) to iMax
52538>>>>>>>                For iCount From iStart to iMax
52544>>>>>>>>
52544>>>>>>>                    set value item iCount to ''
52545>>>>>>>                Loop
52546>>>>>>>>
52546>>>>>>>                set value item iItem# to sVal
52547>>>>>>>            //End
52547>>>>>>>        End
52547>>>>>>>>
52547>>>>>>>        Forward Send Request_Lookup iItem#
52549>>>>>>>    end_procedure
52550>>>>>>>
52550>>>>>>>    Function Item_Field_Property Integer iMsg Integer iItem Returns String
52552>>>>>>>        Local Integer iDSO
52552>>>>>>>        Local Integer iFile
52552>>>>>>>        Local Integer iField
52552>>>>>>>        Local String  sValue
52552>>>>>>>        Get Server to iDSO
52553>>>>>>>        If iDSO Begin
52555>>>>>>>        Get Data_File item iItem to iFile
52556>>>>>>>        If iFile Begin
52558>>>>>>>            Get Data_Field item iItem to iField
52559>>>>>>>            Get iMsg of iDSO iFile iField to sValue
52560>>>>>>>        End
52560>>>>>>>>
52560>>>>>>>        End
52560>>>>>>>>
52560>>>>>>>        Function_Return sValue
52561>>>>>>>    End_Function
52562>>>>>>>
52562>>>>>>>    Procedure DoRightAlignColumn integer iColumn
52564>>>>>>>        Send DoAlignColumn iColumn FORM_DISPLAYRIGHT
52565>>>>>>>    End_Procedure
52566>>>>>>>
52566>>>>>>>    Procedure DoCenterColumn integer iColumn
52568>>>>>>>        Send DoAlignColumn iColumn FORM_DISPLAYCENTER
52569>>>>>>>    End_procedure
52570>>>>>>>
52570>>>>>>>    Procedure DoAlignColumn integer iColumn integer iMode
52572>>>>>>>        String  sVal
52572>>>>>>>        Integer iItem iFormWidth iTextWidth iSpaceWidth iSpaces
52572>>>>>>>
52572>>>>>>>        Move (base_item(self) + iColumn) to iItem
52573>>>>>>>        Get value item iItem to sVal
52574>>>>>>>        Move (Trim(sVal)) to sVal
52575>>>>>>>
52575>>>>>>>        If (sVal <> "") begin
52577>>>>>>>            Get Form_GuiWidth Item iItem to iFormWidth
52578>>>>>>>
52578>>>>>>>            Get Text_Extent sVal to iTextWidth
52579>>>>>>>            Move (Low(iTextWidth)) to iTextWidth
52580>>>>>>>
52580>>>>>>>            Get Text_Extent " "  to iSpaceWidth
52581>>>>>>>            Move (low(iSpaceWidth)) to iSpaceWidth
52582>>>>>>>
52582>>>>>>>            If (iMode = FORM_DISPLAYRIGHT) ;                Move (((iFormWidth - iTextWidth) / iSpaceWidth) - 2) to iSpaces
52585>>>>>>>            If (iMode = FORM_DISPLAYCENTER) ;                Move (((iFormWidth - iTextWidth) / 2) / iSpaceWidth) to iSpaces
52588>>>>>>>
52588>>>>>>>            Move (Repeat(" ",iSpaces) + sVal) to sVal
52589>>>>>>>
52589>>>>>>>            // if items have same values on activation or scrolling with PgUp/PgDn
52589>>>>>>>            // somehow modified value does not get set allways if not first set to ""
52589>>>>>>>            // I think it might happen when items data_file = grids main_file
52589>>>>>>>            Set Value Item iItem to ""
52590>>>>>>>            Set Value Item iItem to sVal
52591>>>>>>>        End
52591>>>>>>>>
52591>>>>>>>    End_procedure
52592>>>>>>>
52592>>>>>>>    Function Export_Code_Description Integer iItem String sVal Returns String
52594>>>>>>>        integer iObj
52594>>>>>>>        string sDesc
52594>>>>>>>        // Find the validation table of iItem
52594>>>>>>>        Get Item_Field_Property GET_File_Field_Table_Object iItem to iObj
52595>>>>>>>        If iObj get Find_Code_Description of iObj sVal to sDesc
52598>>>>>>>        Function_Return sDesc
52599>>>>>>>    End_Function // Export_Code_Description
52600>>>>>>>
52600>>>>>>>    Function Im_a_dbList Returns Integer
52602>>>>>>>        function_return 1
52603>>>>>>>    End_Function
52604>>>>>>>
52604>>>>>>>    //Import_Class_Protocol Disableacceleratorkey_Mixin
52604>>>>>>>
52604>>>>>>>End_Class //DblistSub
52605>>>>>>>
52605>>>>>
52605>>>>>
52605>>>>>//***************************************************************************
52605>>>>>//            Base containers                                               *
52605>>>>>//***************************************************************************
52605>>>>>USE GROUP.Sub       //20. group
Including file: GROUP.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\GROUP.SUB)
52605>>>>>>>use dfclient
52605>>>>>>>use dfallent
52605>>>>>>>
52605>>>>>>>Class Groupsub Is A Group
52606>>>>>>>End_Class //Groupsub
52607>>>>>USE RGROUP.Sub      //21. radio group
Including file: RGROUP.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\RGROUP.SUB)
52607>>>>>>>use dfclient
52607>>>>>>>Use dfallent
52607>>>>>>>
52607>>>>>>>Class RadiogroupSub Is A Radiogroup
52608>>>>>>>    Procedure End_Construct_Object
52610>>>>>>>        Forward Send End_Construct_Object
52612>>>>>>>
52612>>>>>>>    End_Procedure //Construct_Object
52613>>>>>>>
52613>>>>>>>End_Class //RadiogroupSub
52614>>>>>USE CONT3.Sub       //22. container 3d
Including file: CONT3.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONT3.SUB)
52614>>>>>>>Use dfClient
52614>>>>>>>Use dfBase
Including file: Dfbase.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\Dfbase.pkg)
52614>>>>>>>>>Use windows.pkg // this now lives here. (you don't need to ever use this). 
52614>>>>>>>
52614>>>>>>>Class Container3dsub Is A Container3d
52615>>>>>>>    Procedure End_Construct_Object
52617>>>>>>>        Forward Send End_Construct_Object
52619>>>>>>>
52619>>>>>>>    End_Procedure //Construct_Object
52620>>>>>>>
52620>>>>>>>
52620>>>>>>>End_Class //Container3dsub
52621>>>>>USE TABDLG.Sub      //23. tab dialog
Including file: TABDLG.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\TABDLG.SUB)
52621>>>>>>>use dfclient
52621>>>>>>>Use dfallent
52621>>>>>>>
52621>>>>>>>
52621>>>>>>>Class TabdialogSub Is A Tabdialog
52622>>>>>>>    Procedure End_Construct_Object
52624>>>>>>>        Forward Send End_Construct_Object
52626>>>>>>>
52626>>>>>>>    End_Procedure //Construct_Object
52627>>>>>>>
52627>>>>>>>End_Class //tabdialogSub
52628>>>>>>>
52628>>>>>>>
52628>>>>>>>Class TabpageSub Is A Tabpage
52629>>>>>>>    Procedure End_Construct_Object
52631>>>>>>>        Forward Send End_Construct_Object
52633>>>>>>>
52633>>>>>>>    End_Procedure //Construct_Object
52634>>>>>>>
52634>>>>>>>End_Class //TabpageSub
52635>>>>>
52635>>>>>//***************************************************************************
52635>>>>>//            Base controls                                                 *
52635>>>>>//***************************************************************************
52635>>>>>USE EDIT.Sub        //24. edit
Including file: EDIT.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\EDIT.SUB)
52635>>>>>>>Use Editflmn.Ezc
52635>>>>>>>Use AccKeymx.ezc
52635>>>>>>>
52635>>>>>>>Class EditSub Is A Edit
52636>>>>>>>
52636>>>>>>>      Procedure Construct_Object
52638>>>>>>>           Forward Send Construct_Object
52640>>>>>>>           Send Define_Editfloatingpopupmenu_Mixin
52641>>>>>>>           //Send Define_Disableacceleratorkey_Mixin
52641>>>>>>>      End_Procedure
52642>>>>>>>
52642>>>>>>>      Import_Class_Protocol Editfloatingpopupmenu_Mixin
52643>>>>>>>      Import_Class_Protocol Disableacceleratorkey_Mixin
52644>>>>>>>
52644>>>>>>>End_Class //EditSub
52645>>>>>USE BUTTON.Sub      //25. button
Including file: BUTTON.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\BUTTON.SUB)
52645>>>>>>>
52645>>>>>>>Use Tooltip.pkg
52645>>>>>>>Use AccKeymx.ezc
52645>>>>>>>
52645>>>>>>>
52645>>>>>>>Define BPM_RIGHT          for 1
52645>>>>>>>Define BPM_LEFT           for 2
52645>>>>>>>Define BPM_TOP            for 3
52645>>>>>>>Define BPM_BOTTOM         for 4
52645>>>>>>>
52645>>>>>>>Class cButtonPopupMenuSub is a DFBaseEditPullDown
52646>>>>>>>
52646>>>>>>>    Procedure Construct_Object
52648>>>>>>>        Forward Send Construct_Object
52650>>>>>>>        Property Integer piParentWindowHandle (Parent(Self))
52651>>>>>>>        Property Integer piOrientation BPM_BOTTOM
52652>>>>>>>        Send Delete_Data
52653>>>>>>>    End_Procedure // Construct_Object
52654>>>>>>>
52654>>>>>>>    Procedure DoPopup
52656>>>>>>>        // Problem: need to display the menu underneath the button
52656>>>>>>>        Integer iVoid iLeft iTop iBottom liSize liY liX
52656>>>>>>>        String sRect
52656>>>>>>>        Pointer lpsRect
52656>>>>>>>
52656>>>>>>>        If (piParentWindowHandle(Self)=0) Procedure_Return
52659>>>>>>>
52659>>>>>>>        ZeroType tRect To sRect
52660>>>>>>>        GetAddress of sRect To lpsRect
52661>>>>>>>
52661>>>>>>>        Send Windows_Message of (piParentWindowHandle(self)) TB_GETITEMRECT 0 lpsRect // get bounding rectangle of the button
52662>>>>>>>
52662>>>>>>>        GetBuff from sRect at tRect.Bottom To iBottom
52663>>>>>>>        Put iBottom To sRect at tRect.Top
52664>>>>>>>
52664>>>>>>>        Move (ClientToScreen(window_handle(piParentWindowHandle(self)), lpsRect)) To iVoid // convert Client to Screen coordinates
52665>>>>>>>        GetBuff from sRect at tRect.left To iLeft
52666>>>>>>>        GetBuff from sRect at tRect.top To iTop
52667>>>>>>>
52667>>>>>>>        Get GuiSize of (piParentWindowHandle(Self)) to liSize
52668>>>>>>>        Move (Hi(liSize))  to liY
52669>>>>>>>        Move (Low(liSize)) to liX
52670>>>>>>>        If (piOrientation(self)=BPM_BOTTOM)     Set GuiLocation To (iTop+liY) iLeft
52673>>>>>>>        Else If (piOrientation(self)=BPM_RIGHT) Set GuiLocation To iTop (iLeft+liX)
52677>>>>>>>        Send Popup
52678>>>>>>>    End_Procedure // DoPopup
52679>>>>>>>
52679>>>>>>>End_Class // cButtonPopupMenu
52680>>>>>>>
52680>>>>>>>Class ButtonSub Is A Button
52681>>>>>>>
52681>>>>>>>    Procedure Construct_Object
52683>>>>>>>        Forward Send Construct_Object
52685>>>>>>>
52685>>>>>>>        Property String TooltipValue Public ""
52686>>>>>>>        Property Integer Private.Disable_State Public False
52687>>>>>>>        Property Integer MDI_Container Public (Parent(Self))
52688>>>>>>>        //Set Message Item 0 To Msg_Buttonclicked
52688>>>>>>>        //Property Integer Calling_Object Public 0
52688>>>>>>>        // What is the popup Menu
52688>>>>>>>        Property Integer piPopupMenuId 0
52689>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
52689>>>>>>>
52689>>>>>>>    End_Procedure
52690>>>>>>>
52690>>>>>>>    Procedure End_Construct_Object
52692>>>>>>>        If (piPopupMenuId(Self)) Set Label to (Label(Self) * ">>")
52695>>>>>>>        Forward Send End_Construct_Object
52697>>>>>>>        //Set Focus_Mode to Pointer_Only
52697>>>>>>>    End_procedure
52698>>>>>>>
52698>>>>>>>    Function TooltipHint returns string
52700>>>>>>>        Function_Return (TooltipValue(Self))
52701>>>>>>>    End_function
52702>>>>>>>
52702>>>>>>>    Procedure Enable_Window integer iState
52704>>>>>>>        Local integer hWnd
52704>>>>>>>        Get Window_Handle to hWnd
52705>>>>>>>        If hWnd Move (EnableWindow(hWnd,iState)) To hWnd
52708>>>>>>>    End_procedure
52709>>>>>>>
52709>>>>>>>    Procedure Set Disable_Not_Shadowed_State Integer iState
52711>>>>>>>        Set Private.Disable_State to iState
52712>>>>>>>        Send Enable_Window (1-iState)
52713>>>>>>>    End_Procedure
52714>>>>>>>
52714>>>>>>>    Function Disable_Not_Shadowed_State Returns Integer
52716>>>>>>>        Function_Return (Private.Disable_State(Self))
52717>>>>>>>    End_Function
52718>>>>>>>
52718>>>>>>>    Procedure OnClick
52720>>>>>>>        Local Integer bFocus liObjId
52720>>>>>>>        Get Focus_Mode to bFocus
52721>>>>>>>        If (bFocus = Pointer_Only) Begin
52723>>>>>>>            Get MDI_Container to liObjId
52724>>>>>>>            If (liObjId) Send mouse_down to liObjId
52727>>>>>>>        End
52727>>>>>>>>
52727>>>>>>>    End_Procedure
52728>>>>>>>
52728>>>>>>>    Procedure Add_Item Integer aimsg String asLabel
52730>>>>>>>        Integer liMenuId
52730>>>>>>>
52730>>>>>>>        If (piPopupMenuId(Self) = 0) Procedure_Return
52733>>>>>>>        Get piPopupMenuId to liMenuId
52734>>>>>>>        Send Add_Item of liMenuId aimsg asLabel
52735>>>>>>>        Set Aux_Value of liMenuId (Item_Count(Self)-1) To self
52736>>>>>>>    End_Procedure // Add_Item
52737>>>>>>>
52737>>>>>>>    Procedure DoPopupMenu
52739>>>>>>>        If (piPopupMenuId(Self)) Send DoPopup of (piPopupMenuId(Self))
52742>>>>>>>    End_Procedure // DoPopupMenu
52743>>>>>>>
52743>>>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
52744>>>>>>>
52744>>>>>>>End_Class //ButtonSub
52745>>>>>>>
52745>>>>>>>
52745>>>>>USE CHKBOX.Sub      //26. checkbox
Including file: CHKBOX.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CHKBOX.SUB)
52745>>>>>>>Use AccKeymx.ezc
52745>>>>>>>
52745>>>>>>>Class CheckboxSub Is A Checkbox
52746>>>>>>>
52746>>>>>>>      Procedure Construct_Object
52748>>>>>>>            Forward Send Construct_Object
52750>>>>>>>            Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52751>>>>>>>            //Send Define_Disableacceleratorkey_Mixin
52751>>>>>>>      End_Procedure
52752>>>>>>>
52752>>>>>>>    Procedure End_Construct_Object
52754>>>>>>>        Forward Send End_Construct_Object
52756>>>>>>>
52756>>>>>>>    End_Procedure //Construct_Object
52757>>>>>>>
52757>>>>>>>
52757>>>>>>>
52757>>>>>>>      Import_Class_Protocol Disableacceleratorkey_Mixin
52758>>>>>>>
52758>>>>>>>End_Class //CheckboxSub
52759>>>>>USE SPNFRM.Sub      //27. spinform
Including file: SPNFRM.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\SPNFRM.SUB)
52759>>>>>>>use dfclient
52759>>>>>>>Use dfallent
52759>>>>>>>
52759>>>>>>>
52759>>>>>>>Use AccKeymx.ezc
52759>>>>>>>
52759>>>>>>>Class SpinformSub Is A Spinform
52760>>>>>>>
52760>>>>>>>      Procedure Construct_Object
52762>>>>>>>            Forward Send Construct_Object
52764>>>>>>>            Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52765>>>>>>>            //Send Define_Disableacceleratorkey_Mixin
52765>>>>>>>      End_Procedure
52766>>>>>>>
52766>>>>>>>      Import_Class_Protocol Disableacceleratorkey_Mixin
52767>>>>>>>
52767>>>>>>>End_Class //SpinformSub
52768>>>>>USE LINE.Sub        //28. line
Including file: LINE.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\LINE.SUB)
52768>>>>>>>Use DFLine.pkg
52768>>>>>>>
52768>>>>>>>Class Linecontrolsub Is A Linecontrol
52769>>>>>>>End_Class //Linecontrolsub
52770>>>>>USE RADIO.Sub       //29. radio
Including file: RADIO.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\RADIO.SUB)
52770>>>>>>>
52770>>>>>>>Use AccKeymx.ezc
52770>>>>>>>
52770>>>>>>>Class RadioSub Is A Radio
52771>>>>>>>
52771>>>>>>>       Procedure Construct_Object
52773>>>>>>>            Forward Send Construct_Object
52775>>>>>>>            //Send Define_DisableAcceleratorKey_Mixin
52775>>>>>>>       End_Procedure
52776>>>>>>>    Procedure End_Construct_Object
52778>>>>>>>        Forward Send End_Construct_Object
52780>>>>>>>
52780>>>>>>>    End_Procedure //Construct_Object
52781>>>>>>>
52781>>>>>>>
52781>>>>>>>      Import_Class_Protocol DisableAcceleratorKey_Mixin
52782>>>>>>>
52782>>>>>>>End_Class //RadioSub
52783>>>>>USE CMBFRM.Sub      //30. combo form
Including file: CMBFRM.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CMBFRM.SUB)
52783>>>>>>>Use AccKeymx.ezc
52783>>>>>>>
52783>>>>>>>Class ComboformSub Is A Comboform
52784>>>>>>>       Procedure Construct_Object
52786>>>>>>>            Forward Send Construct_Object
52788>>>>>>>            Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52789>>>>>>>            //Send Define_DisableAcceleratorKey_Mixin
52789>>>>>>>       End_Procedure
52790>>>>>>>      Import_Class_Protocol DisableAcceleratorKey_Mixin
52791>>>>>>>End_Class //ComboformSub
52792>>>>>USE FORM.Sub        //31. form
Including file: FORM.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\FORM.SUB)
52792>>>>>>>
52792>>>>>>>Use AccKeymx.ezc
52792>>>>>>>
52792>>>>>>>Class FormSub Is A Form
52793>>>>>>>
52793>>>>>>>    Procedure Construct_Object
52795>>>>>>>        Forward Send Construct_Object
52797>>>>>>>        Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52798>>>>>>>        //Send Define_DisableAcceleratorKey_Mixin
52798>>>>>>>        Property Integer Server 0
52799>>>>>>>    End_Procedure
52800>>>>>>>
52800>>>>>>>    Procedure End_Construct_Object
52802>>>>>>>        Forward Send End_Construct_Object
52804>>>>>>>
52804>>>>>>>    End_Procedure //Construct_Object
52805>>>>>>>
52805>>>>>>>    Procedure Set Visible_State Integer iState
52807>>>>>>>        Forward Set Visible_State to iState
52809>>>>>>>        if (Label_Object(self)) ;             Set Visible_State of (Label_Object(self)) to iState
52812>>>>>>>   End_Procedure // Visible_State
52813>>>>>>>
52813>>>>>>>    Import_Class_Protocol DisableAcceleratorKey_Mixin
52814>>>>>>>
52814>>>>>>>End_Class //FormSub
52815>>>>>>>
52815>>>>>>>
52815>>>>>>>
52815>>>>>USE BITMAP.Sub      //32. bitmap container
Including file: BITMAP.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\BITMAP.SUB)
52815>>>>>>>Use dbBitmap
52815>>>>>>>Class BitmapcontainerSub Is A Bitmapcontainer
52816>>>>>>>End_Class //BitmapcontainerSub
52817>>>>>USE LIST.Sub        //33. list
Including file: LIST.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\LIST.SUB)
52817>>>>>>>Use AccKeymx.ezc
52817>>>>>>>
52817>>>>>>>Class ListSub Is A List
52818>>>>>>>
52818>>>>>>>       Procedure Construct_Object
52820>>>>>>>            Forward Send Construct_Object
52822>>>>>>>            Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52823>>>>>>>            //Send Define_DisableAcceleratorKey_Mixin
52823>>>>>>>       End_Procedure
52824>>>>>>>
52824>>>>>>>    Procedure End_Construct_Object
52826>>>>>>>        Forward Send End_Construct_Object
52828>>>>>>>        Set Modal_State to True
52829>>>>>>>    End_Procedure //Construct_Object
52830>>>>>>>
52830>>>>>>>
52830>>>>>>>       Import_Class_Protocol DisableAcceleratorKey_Mixin
52831>>>>>>>
52831>>>>>>>End_Class //ListSub
52832>>>>>USE TXTBOX.Sub      //34. text box
52832>>>>>USE GRID.Sub        //35. grid
Including file: GRID.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\GRID.SUB)
52832>>>>>>>
52832>>>>>>>Use AccKeymx.ezc
52832>>>>>>>
52832>>>>>>>Class GridSub Is A Grid
52833>>>>>>>       Procedure Construct_Object
52835>>>>>>>            Forward Send Construct_Object
52837>>>>>>>            Send Docustomizedefaultfloatmenu Default_Form_Floating_Menu_Id
52838>>>>>>>            //Send Define_Disableacceleratorkey_Mixin
52838>>>>>>>       End_Procedure
52839>>>>>>>      Import_Class_Protocol Disableacceleratorkey_Mixin
52840>>>>>>>End_Class //GridSub
52841>>>>>>>
52841>>>>>USE FLATBTN.Sub     //39. flat button
Including file: FLATBTN.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\FLATBTN.SUB)
52841>>>>>>>Use Tooltip.pkg
52841>>>>>>>Use CursorSc.pkg
Including file: CURSORSC.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CURSORSC.PKG)
52841>>>>>>>>>Use WinusrEz.pkg
52841>>>>>>>>>Use DfCursor.pkg
52841>>>>>>>>>Use DfTimer
52841>>>>>>>>>
52841>>>>>>>>>Procedure Set FileCursor for CursorShape String sCursorFileName Integer bModal
52843>>>>>>>>>     Local Integer CursorID retval hWnd
52843>>>>>>>>>     Local String  szCursor
52843>>>>>>>>>     Local Pointer lpszCursor
52843>>>>>>>>>
52843>>>>>>>>>     Get Window_Handle To hWnd
52844>>>>>>>>>
52844>>>>>>>>>     Move (sCursorFileName + character(0)) To szCursor
52845>>>>>>>>>     GetAddress of szCursor To lpszCursor
52846>>>>>>>>>
52846>>>>>>>>>     Send Page_Object True
52847>>>>>>>>>     if (ClassCursorHandle(Current_Object)) eq 0 ;         Set ClassCursorHandle to (GetClassLong(hWnd, GCW_HCURSOR))
52850>>>>>>>>>     Move (LoadCursorFromFile(lpszCursor)) to CursorID
52851>>>>>>>>>
52851>>>>>>>>>     Move (SetClassLong(hWnd, GCW_HCURSOR, CursorID )) to retval
52852>>>>>>>>>     Move (SetCursor(CursorID)) to retval
52853>>>>>>>>>
52853>>>>>>>>>     If (Not(bModal)) Send Set_Mouse_Capture
52856>>>>>>>>>End_Procedure
52857>>>>>>>>>
52857>>>>>>>>>Procedure AnimCursor global string sFileName Integer aiCursorID Integer bModal
52859>>>>>>>>>    if ( trim ( sFileName ) ) ne "" ;        Set FileCursor of aiCursorID to sFilename bModal
52862>>>>>>>>>End_Procedure
52863>>>>>>>>>
52863>>>>>>>>>Procedure WaitCursor global Integer aiCursorID
52865>>>>>>>>>    Set Cursor of aiCursorID to IDC_Wait
52866>>>>>>>>>End_Procedure
52867>>>>>>>>>
52867>>>>>>>>>Procedure NormalCursor global Integer aiCursorID
52869>>>>>>>>>    Set Cursor of aiCursorID to 0
52870>>>>>>>>>End_Procedure
52871>>>>>>>>>
52871>>>>>>>>>
52871>>>>>>>>>// Point type
52871>>>>>>>>>type DFCURSOR_POINT
52871>>>>>>>>>    field DFCURSOR_POINT.X as dword
52871>>>>>>>>>    field DFCURSOR_POINT.Y as dword
52871>>>>>>>>>end_type
52871>>>>>>>>>
52871>>>>>>>>>// returns the DF object id that is currently under the mouse.
52871>>>>>>>>>// the 'side effect' of this is that it will return the df object id of
52871>>>>>>>>>// ANY df object (even ones in a different VDF program!)
52871>>>>>>>>>function GetDFObjectUnderCursor global returns integer
52873>>>>>>>>>    local string  lspnt    //  a DFCURSOR_POINT type
52873>>>>>>>>>    local pointer lpPnt    //  a pointer to a DFCURSOR_POINT type
52873>>>>>>>>>    local integer lixx     //  x location
52873>>>>>>>>>    local integer liyy     //  y location
52873>>>>>>>>>    local handle  lhd      //  handle of window under mouse
52873>>>>>>>>>    local integer liObj    //  the DF object under the mouse location
52873>>>>>>>>>
52873>>>>>>>>>    filltype DFCURSOR_POINT with 0 to lsPnt
52874>>>>>>>>>
52874>>>>>>>>>    GetAddress of lsPnt to lpPnt
52875>>>>>>>>>
52875>>>>>>>>>    move (GetCursorPos(lpPnt)) to windowindex
52876>>>>>>>>>
52876>>>>>>>>>    getbuff from lsPnt at DFCURSOR_POINT.X to liXX
52877>>>>>>>>>    getbuff from lsPnt at DFCURSOR_POINT.Y to liYY
52878>>>>>>>>>
52878>>>>>>>>>    move (WindowFromPoint(liXX,liYY)) to lHd
52879>>>>>>>>>
52879>>>>>>>>>    Get_Object_From_Window lHd to liObj
52880>>>>>>>>>
52880>>>>>>>>>    function_return liObj
52881>>>>>>>>>end_function
52882>>>>>>>>>
52882>>>>>>>>>// The Cursor Handler Used in cCursorChange Class
52882>>>>>>>>>Class CursorShapeSub Is A CursorShape
52883>>>>>>>>>    Procedure Construct_Object
52885>>>>>>>>>        Forward Send Construct_Object
52887>>>>>>>>>        Property Integer PreviousCursor Public 0
52888>>>>>>>>>        Property Integer PreviousObjectUnderCursor Public 0
52889>>>>>>>>>    End_Procedure
52890>>>>>>>>>
52890>>>>>>>>>    Procedure Mouse_Down
52892>>>>>>>>>        Delegate Send Mouse_Down
52894>>>>>>>>>    End_Procedure
52895>>>>>>>>>
52895>>>>>>>>>    Procedure Mouse_Up
52897>>>>>>>>>        Forward Send Mouse_Up
52899>>>>>>>>>        Delegate Send Mouse_Up
52901>>>>>>>>>    End_Procedure
52902>>>>>>>>>
52902>>>>>>>>>    Procedure Mouse_Down2
52904>>>>>>>>>        Delegate Send Mouse_Down2
52906>>>>>>>>>    End_Procedure
52907>>>>>>>>>
52907>>>>>>>>>    Procedure Mouse_Up2
52909>>>>>>>>>        Delegate Send Mouse_Up2
52911>>>>>>>>>    End_Procedure
52912>>>>>>>>>
52912>>>>>>>>>    Procedure Mouse_Down3
52914>>>>>>>>>        Delegate Send Mouse_Down3
52916>>>>>>>>>    End_Procedure
52917>>>>>>>>>
52917>>>>>>>>>    Procedure Mouse_Up3
52919>>>>>>>>>        Delegate Send Mouse_Up3
52921>>>>>>>>>    End_Procedure
52922>>>>>>>>>
52922>>>>>>>>>End_Class
52923>>>>>>>>>
52923>>>>>>>>>Class cCursorChange is a DfTimer
52924>>>>>>>>>    Procedure Construct_Object
52926>>>>>>>>>        Forward Send Construct_Object
52928>>>>>>>>>
52928>>>>>>>>>        Object oCursorHandler Is A CursorShapeSub
52930>>>>>>>>>        End_Object
52931>>>>>>>>>
52931>>>>>>>>>        Set Timeout to 100
52932>>>>>>>>>        Set Timer_Active_State to TRUE
52933>>>>>>>>>        Set Timer_Message to OnCursorChange
52934>>>>>>>>>
52934>>>>>>>>>        Property Integer CursorHandler Public (oCursorHandler(Self))
52935>>>>>>>>>        Property Integer Default_Border_Style Public Border_None
52936>>>>>>>>>    End_Procedure
52937>>>>>>>>>
52937>>>>>>>>>    // Event that do nothing by default
52937>>>>>>>>>    Procedure OnCursorChange
52939>>>>>>>>>    End_Procedure
52940>>>>>>>>>
52940>>>>>>>>>    //aiTheObject  = The object to change the cursor
52940>>>>>>>>>    //aiMdiPanel   = The panel the object lies inside
52940>>>>>>>>>    //asCursorType = The Type of the cursor
52940>>>>>>>>>    //aiCursorID   = The Cursor object
52940>>>>>>>>>    //bModal       = True  False if Modal_State is True or False
52940>>>>>>>>>    Procedure Set TheAnimCursor Integer aiTheObject Integer aiMdiPanel String asCursorType ;                               Integer aiCursorID  Integer bModal
52942>>>>>>>>>        Local Integer liObj liCurCursor
52942>>>>>>>>>        Local Handle hWndPanel hWndFor
52942>>>>>>>>>
52942>>>>>>>>>        Move (GetForegroundWindow()) To hWndFor
52943>>>>>>>>>        Get Window_Handle of aiMdiPanel to hWndPanel
52944>>>>>>>>>        // Corrects the side effect of  GetDFObjectUnderCursor function
52944>>>>>>>>>        If  hWndFor eq  hWndPanel Begin
52946>>>>>>>>>            Move (GetDFObjectUnderCursor()) to liObj
52947>>>>>>>>>            If (liObj) Begin
52949>>>>>>>>>                If (aiTheObject = liObj) Begin
52951>>>>>>>>>                    Send AnimCursor asCursorType aiCursorID bModal//"Hand-m.cur"
52952>>>>>>>>>                    Move (GetCursor()) to liCurCursor
52953>>>>>>>>>                    Set PreviousCursor of aiCursorId to liCurCursor
52954>>>>>>>>>                End
52954>>>>>>>>>>
52954>>>>>>>>>                Else Begin
52955>>>>>>>>>                    Move (GetCursor()) to liCurCursor
52956>>>>>>>>>                    // Only when the cursor changes
52956>>>>>>>>>                    If (PreviousCursor(aiCursorID) = liCurCursor) Begin
52958>>>>>>>>>                        Set Cursor of aiCursorID to 0
52959>>>>>>>>>                        Move (GetCursor()) to liCurCursor
52960>>>>>>>>>                    End
52960>>>>>>>>>>
52960>>>>>>>>>                End
52960>>>>>>>>>>
52960>>>>>>>>>            End
52960>>>>>>>>>>
52960>>>>>>>>>        End
52960>>>>>>>>>>
52960>>>>>>>>>    End_Procedure
52961>>>>>>>>>
52961>>>>>>>>>    //aiTheObject  = The object to change the cursor
52961>>>>>>>>>    //aiMdiPanel   = The panel the object lies inside
52961>>>>>>>>>    //asCursorType = The Type of the cursor
52961>>>>>>>>>    //aiCursorID   = The Cursor object
52961>>>>>>>>>    //bModal       = True  False if Modal_State is True or False
52961>>>>>>>>>    Procedure Set TheNewCursor Integer aiTheObject Integer aiMdiPanel Integer aiCursorType ;                               Integer aiCursorID  Integer bModal
52963>>>>>>>>>        Local Integer liObj liCurCursor
52963>>>>>>>>>        Local Handle hWndPanel hWndFor
52963>>>>>>>>>
52963>>>>>>>>>        Move (GetForegroundWindow()) To hWndFor
52964>>>>>>>>>        Get Window_Handle of aiMdiPanel to hWndPanel
52965>>>>>>>>>        // Corrects the side effect of  GetDFObjectUnderCursor function
52965>>>>>>>>>        If  hWndFor eq  hWndPanel Begin
52967>>>>>>>>>            Move (GetDFObjectUnderCursor()) to liObj
52968>>>>>>>>>            If (liObj) Begin
52970>>>>>>>>>                If (aiTheObject = liObj) Begin
52972>>>>>>>>>                    Set Cursor of aiCursorID to aiCursorType //IDC_HELP
52973>>>>>>>>>                    Move (GetCursor()) to liCurCursor
52974>>>>>>>>>                    Set PreviousCursor of aiCursorId to liCurCursor
52975>>>>>>>>>                End
52975>>>>>>>>>>
52975>>>>>>>>>                Else Begin
52976>>>>>>>>>                    Move (GetCursor()) to liCurCursor
52977>>>>>>>>>                    // Only when the cursor changes
52977>>>>>>>>>                    If (PreviousCursor(aiCursorID) = liCurCursor) Begin
52979>>>>>>>>>                        Set Cursor of aiCursorID to 0
52980>>>>>>>>>                        Move (GetCursor()) to liCurCursor
52981>>>>>>>>>                    End
52981>>>>>>>>>>
52981>>>>>>>>>                End
52981>>>>>>>>>>
52981>>>>>>>>>            End
52981>>>>>>>>>>
52981>>>>>>>>>        End
52981>>>>>>>>>>
52981>>>>>>>>>    End_Procedure
52982>>>>>>>>>
52982>>>>>>>>>    //aiTheObject  = The object to change the cursor
52982>>>>>>>>>    //aiMdiPanel   = The panel the object lies inside
52982>>>>>>>>>    //aiCursorID   = The Cursor object
52982>>>>>>>>>    //bModal       = True  False if Modal_State is True or False
52982>>>>>>>>>    Procedure Set NewBorder Integer aiTheObject Integer aiMdiPanel ;                                Integer aiCursorID Integer aiBorderStyle Integer bModal
52984>>>>>>>>>        Local Integer liObj liCurCursor liBorderStyle liModal
52984>>>>>>>>>        Local Handle hWndPanel hWndFor
52984>>>>>>>>>
52984>>>>>>>>>        Get Modal_State of aiMdiPanel to liModal
52985>>>>>>>>>        If (Not(liModal)) Begin
52987>>>>>>>>>            Move (GetForegroundWindow()) To hWndFor
52988>>>>>>>>>            Get Window_Handle of aiMdiPanel to hWndPanel
52989>>>>>>>>>            // Corrects the side effect of  GetDFObjectUnderCursor function
52989>>>>>>>>>            If  hWndFor eq  hWndPanel Begin
52991>>>>>>>>>                Move (GetDFObjectUnderCursor()) to liObj
52992>>>>>>>>>                If (liObj) Begin
52994>>>>>>>>>                    Get Border_Style of liObj to liBorderStyle
52995>>>>>>>>>                    // Only when the Object under cursor changes
52995>>>>>>>>>                    If (PreviousObjectUnderCursor(aiCursorID) <> liObj) Begin
52997>>>>>>>>>                        If (aiTheObject = liObj) Begin
52999>>>>>>>>>                                Set Border_Style of aiTheObject to aiBorderStyle //Border_Dialog
53000>>>>>>>>>                        End
53000>>>>>>>>>>
53000>>>>>>>>>                        Else Begin
53001>>>>>>>>>                                Set Border_Style of aiTheObject to (Default_Border_Style(Self)) //Border_None
53002>>>>>>>>>                        End
53002>>>>>>>>>>
53002>>>>>>>>>                    End
53002>>>>>>>>>>
53002>>>>>>>>>                End
53002>>>>>>>>>>
53002>>>>>>>>>                Set PreviousObjectUnderCursor of aiCursorID to liObj
53003>>>>>>>>>            End
53003>>>>>>>>>>
53003>>>>>>>>>        End
53003>>>>>>>>>>
53003>>>>>>>>>    End_Procedure
53004>>>>>>>>>
53004>>>>>>>>>    Procedure Set CursorChanges Integer aiTheObject Integer aiMdiPanel String asCursorType Integer bModal
53006>>>>>>>>>          Set TheNewCursor to aiTheObject aiMdiPanel asCursorType (CursorHandler(Self)) bModal
53007>>>>>>>>>    End_Procedure
53008>>>>>>>>>
53008>>>>>>>>>    Procedure Set AnimateCursor Integer aiTheObject Integer aiMdiPanel Integer aiCursorType Integer bModal
53010>>>>>>>>>          Set TheAnimCursor to aiTheObject aiMdiPanel aiCursorType (CursorHandler(Self)) bModal
53011>>>>>>>>>    End_Procedure
53012>>>>>>>>>
53012>>>>>>>>>    Procedure Set BorderChanges Integer aiTheObject Integer aiMdiPanel Integer aiBorderStyle Integer bModal
53014>>>>>>>>>          Set NewBorder to aiTheObject aiMdiPanel (CursorHandler(Self)) aiBorderStyle bModal
53015>>>>>>>>>    End_Procedure
53016>>>>>>>>>
53016>>>>>>>>>End_Class
53017>>>>>>>>>
53017>>>>>>>>>
53017>>>>>>>>>Class cMouseCursor is a cCursorChange
53018>>>>>>>>>
53018>>>>>>>>>    Procedure OnCursorChange
53020>>>>>>>>>        Delegate Send DoCursorChange
53022>>>>>>>>>    End_Procedure
53023>>>>>>>>>
53023>>>>>>>>>    Procedure Mouse_Down
53025>>>>>>>>>        Delegate Send Mouse_Down
53027>>>>>>>>>    End_Procedure
53028>>>>>>>>>
53028>>>>>>>>>    Procedure Mouse_Up
53030>>>>>>>>>        Delegate Send Mouse_Up
53032>>>>>>>>>    End_Procedure
53033>>>>>>>>>
53033>>>>>>>>>    Procedure Mouse_Down2
53035>>>>>>>>>        Delegate Send Mouse_Down2
53037>>>>>>>>>    End_Procedure
53038>>>>>>>>>
53038>>>>>>>>>    Procedure Mouse_Up2
53040>>>>>>>>>        Delegate Send Mouse_Up2
53042>>>>>>>>>    End_Procedure
53043>>>>>>>>>
53043>>>>>>>>>    Procedure Mouse_Down3
53045>>>>>>>>>        Delegate Send Mouse_Down3
53047>>>>>>>>>    End_Procedure
53048>>>>>>>>>
53048>>>>>>>>>    Procedure Mouse_Up3
53050>>>>>>>>>        Delegate Send Mouse_Up3
53052>>>>>>>>>    End_Procedure
53053>>>>>>>>>
53053>>>>>>>>>End_Class
53054>>>>>>>>>
53054>>>>>>>Use Bitmap.Sub
53054>>>>>>>Use txtBox.Sub
53054>>>>>>>
53054>>>>>>>Register_Object Main
53054>>>>>>>
53054>>>>>>>Class FlatButton_Mixin Is A Mixin
53055>>>>>>>
53055>>>>>>>    Procedure Define_FlatButton_Mixin
53057>>>>>>>        Property String TooltipValue Public ""
53058>>>>>>>        Property Integer MDI_Container Public 0
53059>>>>>>>        Property String Button_Animated_Cursor Public ""
53060>>>>>>>        Property Integer Button_Cursor Public OCR_NORMAL
53061>>>>>>>        Property Integer Flat_Button_State Public True
53062>>>>>>>
53062>>>>>>>        Set MDI_Container to (main_panel_id(Self))
53063>>>>>>>
53063>>>>>>>        Object oFlatButtonCursor is a cMouseCursor
53065>>>>>>>        End_Object
53066>>>>>>>    End_Procedure
53067>>>>>>>
53067>>>>>>>    Procedure End_Define_FlatButton_Mixin
53069>>>>>>>        If (Flat_Button_State(Self) = True) Set Border_Style to Border_None
53072>>>>>>>        Set Default_Border_Style of (oFlatButtonCursor(Self)) to (Border_Style(Self))
53073>>>>>>>    End_Procedure
53074>>>>>>>
53074>>>>>>>    Function TooltipHint returns string
53076>>>>>>>        Function_Return (TooltipValue(Self))
53077>>>>>>>    End_function
53078>>>>>>>
53078>>>>>>>    Procedure DoCursorChange
53080>>>>>>>           Local Integer liCursorID
53080>>>>>>>           If (MDI_Container(Self) <> 0) Begin
53082>>>>>>>                Move (oFlatButtonCursor(Self)) to liCursorID
53083>>>>>>>                If (Button_Animated_Cursor(Self) <> "") Set AnimateCursor of liCursorID to Self (MDI_Container(Self)) (Button_Animated_Cursor(Self)) False
53086>>>>>>>                Else If (Button_Cursor(Self) <> OCR_NORMAL) Set CursorChanges of liCursorID to Self (MDI_Container(Self)) (Button_Cursor(Self)) False
53090>>>>>>>                If (Flat_Button_State(Self) = True) Set BorderChanges of liCursorID to Self (MDI_Container(Self)) Border_Dialog False
53093>>>>>>>           End
53093>>>>>>>>
53093>>>>>>>    End_Procedure
53094>>>>>>>
53094>>>>>>>    Procedure Mouse_Down
53096>>>>>>>        If (Default_Border_Style(oFlatButtonCursor(Self)) <> (Border_ClientEdge IOR Border_StaticEdge)) ;            Set Border_Style to Border_StaticEdge
53099>>>>>>>    End_Procedure
53100>>>>>>>
53100>>>>>>>    Procedure Mouse_Up
53102>>>>>>>        If (Flat_Button_State(Self) = True) Set Border_Style to Border_Dialog
53105>>>>>>>        Else If (Default_Border_Style(oFlatButtonCursor(Self)) <> (Border_ClientEdge IOR Border_StaticEdge)) ;            Set Border_Style to (Default_Border_Style(oFlatButtonCursor(Self)))
53109>>>>>>>        Send OnClick
53110>>>>>>>    End_Procedure
53111>>>>>>>
53111>>>>>>>    Procedure OnClick
53113>>>>>>>    End_Procedure
53114>>>>>>>
53114>>>>>>>    Procedure KeyAction
53116>>>>>>>          Send OnClick
53117>>>>>>>          Procedure_Return
53118>>>>>>>    End_Procedure
53119>>>>>>>
53119>>>>>>>End_Class
53120>>>>>>>
53120>>>>>>>Class BitmapFlatButtonSub Is A BitmapContainerSub
53121>>>>>>>
53121>>>>>>>
53121>>>>>>>    Procedure Construct_Object
53123>>>>>>>        Forward Send Construct_Object
53125>>>>>>>        Send Define_FlatButton_Mixin
53126>>>>>>>    End_Procedure
53127>>>>>>>
53127>>>>>>>
53127>>>>>>>    Procedure End_Construct_Object
53129>>>>>>>        Forward Send End_Construct_Object
53131>>>>>>>        Send End_Define_FlatButton_Mixin
53132>>>>>>>    End_Procedure
53133>>>>>>>
53133>>>>>>>    Import_Class_Protocol FlatButton_Mixin
53134>>>>>>>
53134>>>>>>>End_Class //FlatButtonSub
53135>>>>>>>
53135>>>>>>>Class TextFlatButtonSub Is A TextBoxSub
53136>>>>>>>
53136>>>>>>>    Procedure Construct_Object
53138>>>>>>>        Forward Send Construct_Object
53140>>>>>>>        Send Define_FlatButton_Mixin
53141>>>>>>>        Set Transparent_State to True
53142>>>>>>>        Set Auto_Size_State to False
53143>>>>>>>    End_Procedure
53144>>>>>>>
53144>>>>>>>
53144>>>>>>>    Procedure End_Construct_Object
53146>>>>>>>        Forward Send End_Construct_Object
53148>>>>>>>        Send End_Define_FlatButton_Mixin
53149>>>>>>>    End_Procedure
53150>>>>>>>
53150>>>>>>>    Import_Class_Protocol FlatButton_Mixin
53151>>>>>>>
53151>>>>>>>End_Class //FlatButtonSub
53152>>>>>
53152>>>>>USE BPROCES.Sub     //  . business process
Including file: BPROCES.SUB    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\BPROCES.SUB)
53152>>>>>>>Use Batchdd
53152>>>>>>>Class BusinessprocessSub Is A Businessprocess
53153>>>>>>>End_Class //BusinessprocessSub
53154>>>>>
53154>>>>>//***************************************************************************
53154>>>>>//                   Switching Methods                                      *
53154>>>>>//***************************************************************************
53154>>>>>Use Switcprg.pkg
Including file: SWITCPRG.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\SWITCPRG.PKG)
53154>>>>>>>
53154>>>>>>>// switcprg.pkg
53154>>>>>>>// Switching to an Existing Instance
53154>>>>>>>// Author StarZen Technology Inc.
53154>>>>>>>//
53154>>>>>>>// 16/11/98 SPY : Added the ability to take the Label of the panel from Registry
53154>>>>>>>//
53154>>>>>>>// this maps a VDF function to a function declared in an external DLL
53154>>>>>>>
53154>>>>>>>Use DLL
53154>>>>>>>Use MsgBox.pkg
53154>>>>>>>
53154>>>>>>>External_Function GetClassNameA "GetClassNameA" User32.dll ;    Handle hWnd ;    Pointer lpszClassName ;    Integer nMaxCount ;    Returns Integer
53155>>>>>>>
53155>>>>>>>// Returns a class-name from a given window-handle
53155>>>>>>>Function GetClassName Global Handle hWnd Returns String
53157>>>>>>>    Local Integer bFound
53157>>>>>>>    Local String  szClass
53157>>>>>>>    Local Pointer lpszClass
53157>>>>>>>
53157>>>>>>>    ZeroString 60 To szClass
53158>>>>>>>    GetAddress Of szClass To lpszClass
53159>>>>>>>    Move (GetClassNameA(hWnd, lpszClass, 60)) To bFound
53160>>>>>>>
53160>>>>>>>    If bFound Begin
53162>>>>>>>        Function_Return (CString(szClass))
53163>>>>>>>    End
53163>>>>>>>>
53163>>>>>>>
53163>>>>>>>    Function_Return ''
53164>>>>>>>End_Function
53165>>>>>>>
53165>>>>>>>//Register_Object ProgramWorkSpace
53165>>>>>>>
53165>>>>>>>// Get The Label Of the Panel from Registry - 16/11/98 SPY
53165>>>>>>>Function LabelOfThePanel Global Returns String
53167>>>>>>>    String sCaption lsCurrent_Module
53167>>>>>>>
53167>>>>>>>    //Move CURRENT$WORKSPACE To lsCurrent_Module
53167>>>>>>>    If (lsCurrent_Module = "") Get psWorkspaceName Of (phoWorkspace(ghoApplication)) To lsCurrent_Module
53170>>>>>>>    If (lsCurrent_Module = "") Get_Profile_String "WorkSpaces" "CurrentWorkspace" To lsCurrent_Module
53175>>>>>>>    Insert "WorkSpaces\" in lsCurrent_Module At 1
53177>>>>>>>    Append lsCurrent_Module "\" (Module_Name(Self))
53179>>>>>>>    Get_Profile_String lsCurrent_Module "Description" To sCaption
53182>>>>>>>    Function_Return sCaption
53183>>>>>>>End_Function
53184>>>>>>>
53184>>>>>>>// Get The Label Of the Dialog from Registry - 16/11/98 SPY
53184>>>>>>>Function LabelOfTheDialog Global Returns String
53186>>>>>>>    String sCaption lsCurrent_Module
53186>>>>>>>
53186>>>>>>>    //Move CURRENT$WORKSPACE To lsCurrent_Module
53186>>>>>>>    If (lsCurrent_Module = "") Get psWorkspaceName Of (phoWorkspace(ghoApplication)) To lsCurrent_Module
53189>>>>>>>    If (lsCurrent_Module = "") Get_Profile_String "WorkSpaces" "CurrentWorkspace" To lsCurrent_Module
53194>>>>>>>    Insert "WorkSpaces\" in lsCurrent_Module At 1
53196>>>>>>>    Append lsCurrent_Module "\" (Module_Name(Self))
53198>>>>>>>    Get_Profile_String lsCurrent_Module "DialogLabel" To sCaption
53201>>>>>>>    Function_Return sCaption
53202>>>>>>>End_Function
53203>>>>>>>
53203>>>>>>>// A simplistic switching algorith for the panel and dialog(Login)
53203>>>>>>>Procedure DoAutoSwitch String sCaption
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
53205>>>>>>>    Local Handle hWnd
53205>>>>>>>    Local Integer iRetVal iVoid bKeno
53205>>>>>>>    // Use The Registry to get the label if sCaption = "" - 16/11/98 SPY
53205>>>>>>>    If sCaption eq "" Begin
53207>>>>>>>        Move (LabelOfThePanel()) To sCaption
53208>>>>>>>        Move 1 To bKeno
53209>>>>>>>    End
53209>>>>>>>>
53209>>>>>>>    Else Move (ToAnsi(sCaption)) To sCaption
53211>>>>>>>
53211>>>>>>>    If sCaption ne "" Begin
53213>>>>>>>        Move (FindWindow('DFFrameClass', sCaption)) To hWnd
53214>>>>>>>        If hWnd Begin
53216>>>>>>>            Move (SetForegroundWindow(hWnd)) To iVoid
53217>>>>>>>            Abort
53218>>>>>>>>
53218>>>>>>>        End
53218>>>>>>>>
53218>>>>>>>    End
53218>>>>>>>>
53218>>>>>>>    Else Begin
53219>>>>>>>        If (bKeno) Move (LabelOfTheDialog()) To sCaption
53222>>>>>>>        If sCaption ne "" Begin
53224>>>>>>>            Move (FindWindow('DFDialogClass', sCaption)) To hWnd
53225>>>>>>>            If hWnd Begin
53227>>>>>>>                Move (SetForegroundWindow(hWnd)) To iVoid
53228>>>>>>>                Abort
53229>>>>>>>>
53229>>>>>>>            End
53229>>>>>>>>
53229>>>>>>>        End
53229>>>>>>>>
53229>>>>>>>    End
53229>>>>>>>>
53229>>>>>>>End_Procedure
53230>>>>>>>
53230>>>>>>>Procedure Set DoAutoSwitch String sCaption
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
53232>>>>>>>    Send DoAutoSwitch sCaption
53233>>>>>>>End_Procedure
53234>>>>>>>
53234>>>>>>>// Automatically switch to a program with a matching caption
53234>>>>>>>Procedure DoAutoSwitchPartial String sCaption
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
53236>>>>>>>    Local Handle  hWnd
53236>>>>>>>    Local Integer iVoid bKeno
53236>>>>>>>    Local String  szCaption
53236>>>>>>>    Local Pointer lpszCaption
53236>>>>>>>
53236>>>>>>>    // Use The Registry to get the label if sCaption = "" - 16/11/98 SPY
53236>>>>>>>    If sCaption eq "" Begin
53238>>>>>>>        Move (LabelOfThePanel()) To sCaption
53239>>>>>>>        Move 1 To bKeno
53240>>>>>>>    End
53240>>>>>>>>
53240>>>>>>>    Else Move (ToAnsi(sCaption)) To sCaption
53242>>>>>>>
53242>>>>>>>    ZeroString 255 To szCaption
53243>>>>>>>    GetAddress Of szCaption To lpszCaption
53244>>>>>>>
53244>>>>>>>    Move (GetWindow(GetDesktopWindow(), GW_CHILD)) To hWnd
53245>>>>>>>    While hWnd
53249>>>>>>>        If (GetClassName(hWnd) = 'DFFrameClass') Begin
53251>>>>>>>            Move (GetWindowText(hWnd, lpszCaption, 255)) To iVoid
53252>>>>>>>            If sCaption Match (CString(szCaption)) Begin
53254>>>>>>>                Move (SetForegroundWindow(hWnd)) To iVoid
53255>>>>>>>                Abort
53256>>>>>>>>
53256>>>>>>>            End
53256>>>>>>>>
53256>>>>>>>        End
53256>>>>>>>>
53256>>>>>>>        Move (GetWindow(hWnd, GW_HWNDNEXT)) To hWnd
53257>>>>>>>    End
53258>>>>>>>>
53258>>>>>>>
53258>>>>>>>    //Check for Dialog (Login)
53258>>>>>>>    If (bKeno)  Move (LabelOfTheDialog()) To sCaption
53261>>>>>>>
53261>>>>>>>    ZeroString 255 To szCaption
53262>>>>>>>    GetAddress Of szCaption To lpszCaption
53263>>>>>>>
53263>>>>>>>    Move (GetWindow(GetDesktopWindow(), GW_CHILD)) To hWnd
53264>>>>>>>    While hWnd
53268>>>>>>>        If (GetClassName(hWnd) = 'DFDialogClass') Begin
53270>>>>>>>            Move (GetWindowText(hWnd, lpszCaption, 255)) To iVoid
53271>>>>>>>            If sCaption Match (CString(szCaption)) Begin
53273>>>>>>>                Move (SetForegroundWindow(hWnd)) To iVoid
53274>>>>>>>                Abort
53275>>>>>>>>
53275>>>>>>>            End
53275>>>>>>>>
53275>>>>>>>        End
53275>>>>>>>>
53275>>>>>>>        Move (GetWindow(hWnd, GW_HWNDNEXT)) To hWnd
53276>>>>>>>    End
53277>>>>>>>>
53277>>>>>>>
53277>>>>>>>End_Procedure
53278>>>>>>>
53278>>>>>>>Procedure Set DoAutoSwitchPartial String sCaption
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
53280>>>>>>>    Send DoAutoSwitchPartial sCaption
53281>>>>>>>End_Procedure
53282>>>>>>>
53282>>>>>>>// Query the user before switching to an existing instance
53282>>>>>>>Procedure DoQuerySwitchPartial String sCaption
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
53284>>>>>>>    Local Handle  hWnd
53284>>>>>>>    Local Integer iVoid iRetVal bKeno
53284>>>>>>>    Local String  szCaption
53284>>>>>>>    Local Pointer lpszCaption
53284>>>>>>>
53284>>>>>>>//    // Use The Registry to get the label if sCaption = "" - 16/11/98 SPY
53284>>>>>>>//    If sCaption eq "" Begin
53284>>>>>>>//        Move (LabelOfThePanel()) To sCaption
53284>>>>>>>//        Move 1 To bKeno
53284>>>>>>>//    End
53284>>>>>>>//    Else Move (ToAnsi(sCaption)) To sCaption
53284>>>>>>>
53284>>>>>>>//    ZeroString 255 To szCaption
53284>>>>>>>//    GetAddress Of szCaption To lpszCaption
53284>>>>>>>
53284>>>>>>>//    Move (GetWindow(GetDesktopWindow(), GW_CHILD)) To hWnd
53284>>>>>>>//    While hWnd
53284>>>>>>>//        If (GetClassName(hWnd) = 'DFFrameClass') Begin
53284>>>>>>>//           Move (GetWindowText(hWnd, lpszCaption, 255)) To iVoid
53284>>>>>>>//           If sCaption Match (CString(szCaption)) Begin
53284>>>>>>>//              Get YesNo_Box (ez.Switchprg.Message1 +;
53284>>>>>>>//                              ez.Switchprg.Message2) ez.Switchprg.MessageCaption MB_DEFBUTTON1 MB_ICONQUESTION To iRetVal
53284>>>>>>>//              If iRetVal eq MBR_YES Begin
53284>>>>>>>//                   Move (SetForegroundWindow(hWnd)) To iVoid
53284>>>>>>>//                   Abort
53284>>>>>>>//               End
53284>>>>>>>//           End
53284>>>>>>>//        End
53284>>>>>>>//        Move (GetWindow(hWnd, GW_HWNDNEXT)) To hWnd
53284>>>>>>>//    End
53284>>>>>>>
53284>>>>>>>//    //Check for Dialog (Login)
53284>>>>>>>//    If (bKeno)  Move (LabelOfTheDialog()) To sCaption
53284>>>>>>>
53284>>>>>>>//    ZeroString 255 To szCaption
53284>>>>>>>//    GetAddress Of szCaption To lpszCaption
53284>>>>>>>
53284>>>>>>>//    Move (GetWindow(GetDesktopWindow(), GW_CHILD)) To hWnd
53284>>>>>>>//    While hWnd
53284>>>>>>>//        If (GetClassName(hWnd) = 'DFDialogClass') Begin
53284>>>>>>>//           Move (GetWindowText(hWnd, lpszCaption, 255)) To iVoid
53284>>>>>>>//           If sCaption Match (CString(szCaption)) Begin
53284>>>>>>>//              Get YesNo_Box (ez.Switchprg.Message1 +;
53284>>>>>>>//                              ez.Switchprg.Message2) ez.Switchprg.MessageCaption MB_DEFBUTTON1 MB_ICONQUESTION To iRetVal
53284>>>>>>>//              If iRetVal eq MBR_YES Begin
53284>>>>>>>//                   Move (SetForegroundWindow(hWnd)) To iVoid
53284>>>>>>>//                   Abort
53284>>>>>>>//               End
53284>>>>>>>//           End
53284>>>>>>>//        End
53284>>>>>>>//        Move (GetWindow(hWnd, GW_HWNDNEXT)) To hWnd
53284>>>>>>>//    End
53284>>>>>>>
53284>>>>>>>End_Procedure
53285>>>>>>>
53285>>>>>>>Procedure Set DoQuerySwitchPartial String sCaption
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
53287>>>>>>>    Send DoQuerySwitchPartial sCaption
53288>>>>>>>End_Procedure
53289>>>>>>>
53289>>>>>
53289>>>>>
53289>>>>>//***************************************************************************
53289>>>>>//            Vdf Utilities always at the end                               *
53289>>>>>//***************************************************************************
53289>>>>>//USE APS
53289>>>>>//USE DATES.UTL
53289>>>>>Use FileMode.Inc
Including file: FILEMODE.INC    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\FILEMODE.INC)
53289>>>>>>>Use Dfclient.pkg
53289>>>>>>>Use dfallent
53289>>>>>>>
53289>>>>>>>Integer ghoFileModeInfo
53289>>>>>>>
53289>>>>>>>Object oFileModeInfo Is A Set
53291>>>>>>>
53291>>>>>>>    Object oExceptFiles Is A Set
53293>>>>>>>    End_Object // oExceptFiles
53294>>>>>>>
53294>>>>>>>    Procedure DoInitExceptFiles
53297>>>>>>>        Send Delete_Data to oExceptFiles
53298>>>>>>>    End_Procedure // DoInitExceptFiles
53299>>>>>>>
53299>>>>>>>    Procedure DoExceptFile Integer aiFile
53302>>>>>>>        Send Add_Element to oExceptFiles aiFile
53303>>>>>>>    End_Procedure // DoExceptFile
53304>>>>>>>
53304>>>>>>>    Procedure DoInitFileModeSet
53307>>>>>>>        Send Delete_Data
53308>>>>>>>    End_Procedure // DoInitFileModeSet
53309>>>>>>>
53309>>>>>>>    Procedure DoStoreFileModeInfo
53312>>>>>>>        Integer liFile liMode
53312>>>>>>>
53312>>>>>>>        Send DoInitFileModeSet
53313>>>>>>>        Send DoInitExceptFiles
53314>>>>>>>
53314>>>>>>>        repeat
53314>>>>>>>>
53314>>>>>>>            get_attribute DF_FILE_NEXT_OPENED of liFile to liFile // only the open ones
53317>>>>>>>            If (liFile > 0) Begin
53319>>>>>>>                Get_Attribute DF_FILE_MODE of liFile to liMode
53322>>>>>>>                Send Add_Element (String(liFile) + ";" + String(liMode))
53323>>>>>>>            End
53323>>>>>>>>
53323>>>>>>>        until (liFile = 0)
53325>>>>>>>
53325>>>>>>>    End_Procedure // DoStoreFileModeInfo
53326>>>>>>>
53326>>>>>>>    Procedure DoSetFileModeToReadOnly
53329>>>>>>>        Integer liFile liCount liExeptObjId liExept
53329>>>>>>>
53329>>>>>>>        Get Item_Count to liCount
53330>>>>>>>        If Not liCount Procedure_Return
53333>>>>>>>
53333>>>>>>>        Move oExceptFiles to liExeptObjId
53334>>>>>>>        Get Item_Count of liExeptObjId to liCount
53335>>>>>>>
53335>>>>>>>        repeat
53335>>>>>>>>
53335>>>>>>>            get_attribute DF_FILE_NEXT_OPENED of liFile to liFile // only the open ones
53338>>>>>>>            if (liFile > 0) Begin
53340>>>>>>>                Move (-1) to liExept
53341>>>>>>>                If (liCount) Get Find_Element of liExeptObjId liFile to liExept
53344>>>>>>>                If (liExept = (-1)) Set_Attribute DF_FILE_MODE of liFile to DF_FILEMODE_READONLY
53349>>>>>>>            End
53349>>>>>>>>
53349>>>>>>>        until (liFile = 0)
53351>>>>>>>
53351>>>>>>>        Send DoInitExceptFiles
53352>>>>>>>    End_Procedure // DoSetFileModeToReadOnly
53353>>>>>>>
53353>>>>>>>    Procedure DoReStoreFileModeInfo
53356>>>>>>>        Integer liCount liMaxFiles liFile liMode liPos bOpened
53356>>>>>>>        String  lsFileInfo
53356>>>>>>>
53356>>>>>>>        Get Item_Count to liMaxFiles
53357>>>>>>>
53357>>>>>>>        For liCount From 0 to (liMaxFiles - 1)
53363>>>>>>>>
53363>>>>>>>            Get Value Item liCount to lsFileInfo
53364>>>>>>>
53364>>>>>>>            Move (Pos(";",lsFileInfo)) to liPos
53365>>>>>>>            Move (Left(lsFileInfo,liPos-1)) to liFile
53366>>>>>>>
53366>>>>>>>            Get_Attribute DF_FILE_OPENED of liFile to bOpened
53369>>>>>>>            If (bOpened = Dftrue) Begin
53371>>>>>>>                Move (Right(lsFileInfo,Length(lsFileInfo)-liPos)) to liMode
53372>>>>>>>                Set_Attribute DF_FILE_MODE of liFile to liMode
53375>>>>>>>            End
53375>>>>>>>>
53375>>>>>>>        Loop
53376>>>>>>>>
53376>>>>>>>
53376>>>>>>>    End_Procedure // DoReStoreFileModeInfo
53377>>>>>>>
53377>>>>>>>    Procedure DoReOpenInitialFiles
53380>>>>>>>        Integer liCount liMaxFiles liFile liMode liPos bOpened
53380>>>>>>>        String  lsFileInfo
53380>>>>>>>
53380>>>>>>>        Get Item_Count to liMaxFiles
53381>>>>>>>
53381>>>>>>>        For liCount From 0 to (liMaxFiles - 1)
53387>>>>>>>>
53387>>>>>>>            Get Value Item liCount to lsFileInfo
53388>>>>>>>
53388>>>>>>>            Move (Pos(";",lsFileInfo)) to liPos
53389>>>>>>>            Move (Left(lsFileInfo,liPos-1)) to liFile
53390>>>>>>>
53390>>>>>>>            Get_Attribute DF_FILE_OPENED of liFile to bOpened
53393>>>>>>>            If (bOpened = Dffalse) Open liFile
53397>>>>>>>            Move (Right(lsFileInfo,Length(lsFileInfo)-liPos)) to liMode
53398>>>>>>>            Set_Attribute DF_FILE_MODE of liFile to liMode
53401>>>>>>>        Loop
53402>>>>>>>>
53402>>>>>>>
53402>>>>>>>    End_Procedure // DoReOpenInitialFiles
53403>>>>>>>
53403>>>>>>>    Move Self to ghoFileModeInfo
53404>>>>>>>End_Object // oFileModeInfo
53405>>>>>>>
53405>>>>>
53405>>>    Use TXTBOX.SUB
53405>>>    Open USERS
53407>>>    
53407>>>    
53407>>>    //AB-IgnoreEnd
53407>>>
53407>>>
53407>>>    //AB-IgnoreEnd
53407>>>
53407>>>    Object oNewPassDlg is a ModalPanelSub
53409>>>
53409>>>        //AB-StoreTopStart
53409>>>
53409>>>        Property String psOldPassword  Public ""
53411>>>        Property String psNewPassword  Public ""
53413>>>        Property String piCanceled     Public False
53415>>>        Property String piState        Public 0
53417>>>
53417>>>        Enum_List
53417>>>            Define All_Ok           // 0
53417>>>            Define Canceled         // 1
53417>>>            Define Same_Password    // 2
53417>>>            Define Wrong_Password   // 3
53417>>>            Define Not_Match        // 4
53417>>>        End_Enum_List
53417>>>
53417>>>
53417>>>        Procedure Popup_Modal
53420>>>            String  sLogin
53420>>>            Move (fsLoginUserID())  to sLogin
ERROR: 4367 Function Not Found in Expression FSLOGINUSERID ON LINE: 38 (53420) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53421>>>            Clear Users
53422>>>            Move sLogin    to Users.Login_ID
ERROR: 4345 Type check error USERS.LOGIN_ID, MUST BE DEFINED ON LINE: 40 (53422) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
ERROR: 4328 Undefined symbol in argument USERS.LOGIN_ID ON LINE: 40 (53422) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53423>>>            Find eq Users by Index.1 
53424>>>>
53424>>>            Set Label of oNewPassDlg to ("  "+Trim(Users.NAME)+"   -    ")
53425>>>            Forward Send Popup_Modal
53427>>>        End_Procedure
53428>>>
53428>>>
53428>>>        //AB-StoreTopEnd
53428>>>
53428>>>        Set Popup_State to TRUE
53429>>>        Set Minimize_Icon to FALSE
53430>>>        Set Label to "  "
53431>>>        Set Location to 26 79
53432>>>        Set Size to 76 257
53433>>>
53433>>>        //AB-DDOStart
53433>>>
53433>>>
53433>>>        //AB-DDOEnd
53433>>>
53433>>>        Object ConfirmPassForm is a Form
53435>>>            Set Label_Col_Offset to 2
53436>>>            Set Label_Justification_Mode to jMode_Right
53437>>>            Set Size to 13 110
53438>>>            Set Location to 4 110
53439>>>            Set Password_State item 0 to TRUE
53440>>>        End_Object    // ConfirmPassForm
53441>>>
53441>>>        Object NewPassForm is a FormSub
53443>>>            Set Label_Col_Offset to 2
53444>>>            Set Label_Justification_Mode to jMode_Right
53445>>>            Set Size to 13 110
53446>>>            Set Location to 24 110
53447>>>            Set Password_State item 0 to True
53448>>>        End_Object    // NewPassForm
53449>>>        
53449>>>        
53449>>>        Object NewPassForm2 is a FormSub
53451>>>            Set Label_Col_Offset to 2
53452>>>            Set Label_Justification_Mode to jMode_Right
53453>>>            Set Size to 13 110
53454>>>            Set Location to 39 110
53455>>>            Set Password_State item 0 to True
53456>>>        End_Object
53457>>>        
53457>>>
53457>>>        Object oOK_bn is a Button
53459>>>            Set Default_State to TRUE
53460>>>            Set Label to "&OK"
53461>>>            Set Location to 60 170
53462>>>
53462>>>            Procedure OnClick
53465>>>                Set piState To All_Ok
53466>>>                Delegate Send Deactivate
53468>>>            End_Procedure
53469>>>        End_Object    // oOK_bn
53470>>>
53470>>>        Object TextBox_EZ1 is a TextBoxSub
53472>>>            Set Enabled_State to TRUE
53473>>>            Set Label to " "
53474>>>            Set Auto_Size_State to FALSE
53475>>>            Set FontSize to 4 0
53476>>>            Set Size to 13 85
53477>>>            Set Location to 4 5
53478>>>        End_Object    // TextBox_EZ1
53479>>>
53479>>>        Object TextBox_EZ2 is a TextBoxSub
53481>>>            Set Enabled_State to TRUE
53482>>>            Set Label to " "
53483>>>            Set FontSize to 4 0
53484>>>            Set Size to 10 63
53485>>>            Set Location to 25 5
53486>>>        End_Object    // TextBox_EZ2
53487>>>
53487>>>
53487>>>        Object TextBox_EZ3 is a TextBoxSub
53489>>>            Set Enabled_State to True
53490>>>            Set Label to "  ()"
53491>>>            Set FontSize to 4 0
53492>>>            Set Size to 10 73
53493>>>            Set Location to 40 5
53494>>>        End_Object    // TextBox_EZ3
53495>>>
53495>>>        Object oCancel_bn is a ButtonSub
53497>>>            Set Label to "&Cancel"
53498>>>            Set Location to 60 114
53499>>>
53499>>>            //AB-StoreStart
53499>>>
53499>>>            Procedure OnClick
53502>>>                Set piState to Canceled
53503>>>                Delegate Send Deactivate
53505>>>            End_Procedure
53506>>>
53506>>>            //AB-StoreEnd
53506>>>
53506>>>        End_Object    // oCancel_bn
53507>>>
53507>>>
53507>>>        //AB-StoreStart
53507>>>
53507>>>        Function ConfirmNewCustomPass Returns Integer
53510>>>            Local Integer bPasswordGood
53510>>>            Local String sNewPassword sNewPassword2 sConfirmPassword sOldPassword sPassw
53510>>>
53510>>>            Set value of (NewPassForm    (Current_Object)) item 0 to ""
53511>>>            Set value of (NewPassForm2   (Current_Object)) item 0 to ""
53512>>>            Set value of (ConfirmPassForm(Current_Object)) item 0 to ""
53513>>>            
53513>>>            Send Popup_Modal
53514>>>
53514>>>            Get value of (ConfirmPassForm(Current_Object)) item 0 to sConfirmPassword
53515>>>            Get value of (NewPassForm    (Current_Object)) item 0 to sNewPassword
53516>>>            Get value of (NewPassForm2   (Current_Object)) item 0 to sNewPassword2
53517>>>
53517>>>            If (piState(Self)<>Canceled) Begin
53519>>>
53519>>>                String  sLogin
53519>>>                Move (fsLoginUserID())  to sLogin
ERROR: 4367 Function Not Found in Expression FSLOGINUSERID ON LINE: 158 (53519) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53520>>>                Clear Users
53521>>>                Move sLogin    to Users.Login_ID
ERROR: 4345 Type check error USERS.LOGIN_ID, MUST BE DEFINED ON LINE: 160 (53521) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
ERROR: 4328 Undefined symbol in argument USERS.LOGIN_ID ON LINE: 160 (53521) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53522>>>                Find eq Users by Index.1 
53523>>>>
53523>>>                If (Found) Begin
53525>>>                    Move Users.PASSWORD to sPassw
ERROR: 4328 Undefined symbol in argument USERS.PASSWORD ON LINE: 163 (53525) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53526>>>                    If sPassw ne sConfirmPassword  Begin
53528>>>                        Set piState to Wrong_Password // 3
53529>>>                    End
53529>>>>
53529>>>                    Else If sNewPassword ne sNewPassword2  Begin
53532>>>                        Set piState to Not_Match // 4
53533>>>                    End
53533>>>>
53533>>>                    Else Begin
53534>>>                        If sPassw eq sNewPassword Begin
53536>>>                            Set piState to Same_Password // 2
53537>>>                        End
53537>>>>
53537>>>                        Else Begin
53538>>>                            Set piState to All_Ok // 0
53539>>>                            Reread Users
53543>>>                            Move sNewPassword to Users.PASSWORD
ERROR: 4345 Type check error USERS.PASSWORD, MUST BE DEFINED ON LINE: 177 (53543) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
ERROR: 4328 Undefined symbol in argument USERS.PASSWORD ON LINE: 177 (53543) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53544>>>                            SaveRecord Users
53545>>>                            Unlock
53546>>>>
53546>>>                        End
53546>>>>
53546>>>                    End
53546>>>>
53546>>>                End
53546>>>>
53546>>>                Else Set piState to Canceled 
53548>>>            End
53548>>>>
53548>>>            // If Cancelled piState = 1
53548>>>            Function_Return (piState(Self))
53549>>>        End_Function
53550>>>
53550>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
53551>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
53552>>>
53552>>>
53552>>>        //AB-StoreEnd
53552>>>
53552>>>    End_Object    // oNewPassDlg
53553>>>
53553>>>//AB/     End_Object    // prj
ERROR: 4328 Undefined symbol in argument USERS.NAME ON LINE: 42 (53424) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\PASSDLG2.DG
53553>
53553>Use connect.dg
Including file: CONNECT.DG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG)
53553>>>//AB/ Project Connect
53553>>>//AB/ Object prj is a Dialog_Project
53553>>>//AB/     Set ProjectName to "Connect"
53553>>>//AB/     Set ProjectFileName to "Connect.dg"
53553>>>
53553>>>// Project Object Structure
53553>>>//   Connect is a BasicPanelSub
53553>>>//     Textbox7 is a TextBoxSub
53553>>>//     Form5 is a FormSub
53553>>>//     Textbox8 is a TextBoxSub
53553>>>//     Form6 is a FormSub
53553>>>//     oOK_bn is a ButtonSub
53553>>>//     oCancel_bn is a ButtonSub
53553>>>
53553>>>// Register all objects
53553>>>Register_Object Connect
ERROR: 4388 Illegal object name definition CONNECT ALREADY DEFINED AS A FUNCTION/PROPERTY ON LINE: 16 (53553) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
53553>>>Register_Object Form5
53553>>>Register_Object Form6
53553>>>Register_Object oCancel_bn
53553>>>Register_Object oOK_bn
53553>>>Register_Object Textbox7
53553>>>Register_Object Textbox8
53553>>>
53553>>>
53553>>>
53553>>>//AB-StoreTopStart
53553>>>
53553>>>///#INCLUDE
53553>>>Use mertech.inc
Including file: MERTECH.INC    (C:\Program Files\Visual DataFlex 14.1\Pkg\MERTECH.INC)
53553>>>>>//*************************************************************************
53553>>>>>//*                                                                       *
53553>>>>>//*  Confidential Trade Secret.                                           *
53553>>>>>//*  Copyright (c) 1997-2008 Mertech Data Systems Inc, Miami Florida      *
53553>>>>>//*  All rights reserved.                                                 *
53553>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.       *
53553>>>>>//*                                                                       *
53553>>>>>//*************************************************************************
53553>>>>>USE UI
53553>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.6.18
#REM -----------------------------------------------
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>
53553>>>>>// SQLFlex Lock Type
53553>>>>>
53553>>>>>// Extended Callback Types
53553>>>>>
53553>>>>>
53553>>>>>INTEGER _SAVEFILENUMBER#
53553>>>>>
53553>>>>>// dfStructureEnd Option bits
53553>>>>>
53553>>>>>//
53553>>>>>Enum_List  //  Call_Driver Functions
53553>>>>>    DEfine CALLDRV_LICENSE_ENVIRONMENT_SET      FOR 0
53553>>>>>    Define CALLDRV_ORA_CURRENT_SQL_SERVER       FOR 6
53553>>>>>    Define CALLDRV_CURRENT_SQL_SERVER           FOR 19
53553>>>>>    Define CALLDRV_SQL_MAX_CURSORS              FOR 26
53553>>>>>    Define CALLDRV_SQLLOADER_FIELDS_TERM        FOR 30
53553>>>>>    Define CALLDRV_CREATE_TABLE_FROM_DAT        FOR 30
53553>>>>>    Define CALLDRV_SQLLOADER_DECIMAL_SEP        FOR 31
53553>>>>>    Define CALLDRV_SQLFLEX_MAX_CURSORS          FOR 37
53553>>>>>
53553>>>>>    Define CALLDRV_GET_RETURNED_COLUMNS         FOR 39
53553>>>>>    Define CALLDRV_GET_RETURNED_ROWS            FOR 40
53553>>>>>    Define CALLDRV_GET_COLUMN_ATTRIBUTE         FOR 41
53553>>>>>    Define CALLDRV_START_TXTGEN_AFTER_RECNUM    FOR 42
53553>>>>>    Define CALLDRV_FINISH_TXTGEN_AFTER_RECNUM   FOR 43
53553>>>>>    Define CALLDRV_SET_ISOLATION_LEVEL          FOR 44
53553>>>>>    Define CALLDRV_GET_SERVER_CFG               FOR 45
53553>>>>>    Define CALLDRV_SET_SQL_LOCK_TIMEOUT         FOR 46
53553>>>>>    Define CALLDRV_GET_SQL_LOCK_TIMEOUT         FOR 47
53553>>>>>    Define CALLDRV_GET_RESULTS                  FOR 48
53553>>>>>    Define CALLDRV_GET_MORE_RESULTS             FOR 49
53553>>>>>    Define CALLDRV_GET_CURRENT_USER_NAME        FOR 50
53553>>>>>    Define CALLDRV_OPEN_EMBEDDED_CURSOR         FOR 51
53553>>>>>    Define CALLDRV_CLOSE_EMBEDDED_CURSOR        FOR 52
53553>>>>>    Define CALLDRV_SET_CURRENT_EMBEDDED_CURSOR  FOR 53
53553>>>>>    Define CALLDRV_GET_CURRENT_EMBEDDED_CURSOR  FOR 54
53553>>>>>    Define CALLDRV_SET_MAX_EMBEDDED_CURSOR      FOR 55
53553>>>>>    Define CALLDRV_GET_MAX_EMBEDDED_CURSOR      FOR 56
53553>>>>>    Define CALLDRV_SQL_TRANSACTION              FOR 57
53553>>>>>    Define CALLDRV_LOCAL_TD_PATH                FOR 58
53553>>>>>    Define CALLDRV_CREATE_DB                    FOR 59
53553>>>>>    Define CALLDRV_ESCAPE_STRING                FOR 60
53553>>>>>    Define CALLDRV_SET_PROC_ATTRIBUTE_TYPE      FOR 61
53553>>>>>    Define CALLDRV_SQL_REFRESH_CACHE            FOR 62
53553>>>>>    Define CALLDRV_GET_SQL_STMT                 FOR 63
53553>>>>>    Define CALLDRV_DIRECT_PATH_LOAD             FOR 64
53553>>>>>
53553>>>>>    Define CALLDRV_READ_LOB                     FOR 65
53553>>>>>    Define CALLDRV_WRITE_LOB                    FOR 66
53553>>>>>    Define CALLDRV_APPEND_LOB                   FOR 67
53553>>>>>    Define CALLDRV_LENGTH_LOB                   FOR 68
53553>>>>>    Define CALLDRV_LOADFROMFILE_LOB             FOR 69
53553>>>>>    Define CALLDRV_ERASE_LOB                    FOR 70
53553>>>>>    Define CALLDRV_TRUNCATE_LOB                 FOR 71
53553>>>>>    Define CALLDRV_INITIALIZE_SEQUENCE          FOR 72
53553>>>>>    Define CALLDRV_CLIENT_CFG                   FOR 73
53553>>>>>    Define CALLDRV_END_SAVERECORD               FOR 74
53553>>>>>    Define CALLDRV_ENABLE_RECONNECT             FOR 75
53553>>>>>    Define CALLDRV_ENUMERATE_SERVER             FOR 76
53553>>>>>    Define CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS FOR 77
53553>>>>>    Define CALLDRV_USE_DFLEX_DATE_FORMAT        FOR 78
53553>>>>>    Define CALLDRV_FORCE_FIELDS_NOT_NULL        FOR 79
53553>>>>>    Define CALLDRV_ORA_CREATE_TABLE_FROM_DAT    FOR 80
53553>>>>>    Define CALLDRV_MAX_DATA_SIZE                FOR 81
53553>>>>>    Define CALLDRV_CHUNK_SIZE                   FOR 82
53553>>>>>    Define CALLDRV_GET_DATA_CHUNK               FOR 83
53553>>>>>    Define CALLDRV_MIRROR_SERVER                FOR 84
53553>>>>>    Define CALLDRV_COPY_DATA                    FOR 85
53553>>>>>    Define CALLDRV_SET_SQL_CURSOR_TYPE          FOR 86
53553>>>>>    Define CALLDRV_ICF                          FOR 87
53553>>>>>    Define CALLDRV_CLEAR_INT_CACHE              FOR 88
53553>>>>>    Define CALLDRV_GET_CURRENT_USER_PASSWORD    FOR 89
53553>>>>>    Define CALLDRV_FORCE_FIELDS_NULL            FOR 90
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>// License and environment settings
53553>>>>>Enum_List
53553>>>>>    Define CALLDRV_DRIVER_REVISION             FOR 0
53553>>>>>    Define CALLDRV_COMPANY_NAME                FOR 1
53553>>>>>    Define CALLDRV_SERIAL_NUMBER               FOR 2
53553>>>>>    Define CALLDRV_LICENSED_USERS              FOR 3
53553>>>>>    Define CALLDRV_MAJOR_REVISION              FOR 4
53553>>>>>    Define CALLDRV_VERSION_COMMENTS            FOR 5
53553>>>>>    Define CALLDRV_OLEDB_OEM_TRANSLATION       FOR 6
53553>>>>>    Define CALLDRV_SET_DB_PORT                 FOR 7
53553>>>>>    Define CALLDRV_GET_DB_PORT                 FOR 8
53553>>>>>    Define CALLDRV_SET_DB_SOCKET               FOR 9
53553>>>>>    Define CALLDRV_GET_DB_SOCKET               FOR 10
53553>>>>>    Define CALLDRV_SET_AS_SYSDBA               FOR 11
53553>>>>>    Define CALLDRV_OEM_TRANSLATION_STATE       FOR 12
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>Enum_List  // CALLDRV_ENUMERATE_SERVER_OPTION
53553>>>>>    Define CALLDRV_ENUMERATE_SERVER_COUNT       FOR 0
53553>>>>>    Define CALLDRV_ENUMERATE_SERVER_SERVER      FOR 1
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>// Embedded SQL Cursor Types
53553>>>>>Enum_List
53553>>>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_NONE           FOR 0
53553>>>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_CLIENT         FOR 1
53553>>>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_SERVER         FOR 2
53553>>>>>    Define CALLDRV_ENUMERATE_CURSOR_TYPE_PARAMETERIZED  FOR 3
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>Enum_List
53553>>>>>    Define CALLDRV_VALUE_GET                    FOR 0
53553>>>>>    Define CALLDRV_VALUE_SET                    FOR 1
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>// Inverse Key types
53553>>>>>Enum_List
53553>>>>>    Define REGULAR_SEG                          FOR -1
53553>>>>>    Define INVK_CASE_SEG                        FOR 0
53553>>>>>    Define INVK_DESC_SEG                        FOR 1
53553>>>>>    Define INVK_DESC_AND_CASE_SEG               FOR 2
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>// DB2 Index Types
53553>>>>>Enum_List
53553>>>>>    Define REG_INDEX                            FOR 0
53553>>>>>    Define REV_INDEX                            FOR 1
53553>>>>>    Define CLUST_INDEX                          FOR 2
53553>>>>>    Define REV_CLUST_INDEX                      FOR 3
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>// Oracle Procedure Arguments type
53553>>>>>Enum_List
53553>>>>>    Define IS_NONE                              FOR 0
53553>>>>>    Define IS_IN                                FOR 1
53553>>>>>    Define IS_OUT                               FOR 2
53553>>>>>    Define IS_IN_OUT                            FOR 3
53553>>>>>    Define IS_RSET                              FOR 4
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>//  SQL_GET_COL Attributes
53553>>>>>Enum_List
53553>>>>>    Define SQL_GET_COL_ATTRIB_SIZE              FOR 1
53553>>>>>    Define SQL_GET_COL_ATTRIB_DECIMALS          FOR 2
53553>>>>>    Define SQL_GET_COL_ATTRIB_LABEL             FOR 3
53553>>>>>    Define SQL_GET_COL_ATTRIB_COLUMN_NAME       FOR 4
53553>>>>>    Define SQL_GET_COL_ATTRIB_TABLE_NAME        FOR 5
53553>>>>>    Define SQL_GET_COL_ATTRIB_SQLTYPE           FOR 6
53553>>>>>    Define SQL_GET_COL_ATTRIB_NULLABLE          FOR 7
53553>>>>>    Define SQL_GET_COL_ATTRIB_DFTYPE            FOR 8
53553>>>>>    Define SQL_GET_COL_ATTRIB_DATA_LENGTH       FOR 9
53553>>>>>End_Enum_List
53553>>>>>
53553>>>>>// Declare Global variables
53553>>>>>    String _DRIVERNAME# 255
53553>>>>>
53553>>>>>
53553>>>>>//Last Revised: 2007-08-08 By: Marcelo
53553>>>>>Object oMertechInc Is An Array
53555>>>>>    Property String  psArg1      Public ""
53557>>>>>    Property String  psArg2      Public ""
53559>>>>>    Property Integer piRet       Public 0
53561>>>>>    Property Integer piDecSep    Public 0
53563>>>>>
53563>>>>>    Procedure FillsArg1 Integer iSize
53566>>>>>        Set psArg1 to (REPEAT(" ",iSize))
53567>>>>>    End_Procedure
53568>>>>>
53568>>>>>    Procedure FillsArg2 Integer iSize
53571>>>>>        Set psArg2 to (REPEAT(" ",iSize))
53572>>>>>    End_Procedure
53573>>>>>
53573>>>>>    Procedure SetDecimalSeparator
53576>>>>>        Local Integer liDecSep
53576>>>>>        GET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO liDecSep
53579>>>>>        Set piDecSep to liDecSep
53580>>>>>
53580>>>>>        If liDecSep Ne 46 SET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO 46 // (.) WILL BE DECIMAL SEPARATOR
53585>>>>>    End_Procedure
53586>>>>>
53586>>>>>    Procedure RestoreDecimalSeparator
53589>>>>>        Local Integer liDecSep
53589>>>>>        Get piDecSep to liDecSep
53590>>>>>        If liDecSep Ne 46 SET_ATTRIBUTE DF_DECIMAL_SEPARATOR TO liDecSep
53595>>>>>    End_Procedure
53596>>>>>
53596>>>>>    Procedure SetsArg1Numeric String sValue
53599>>>>>        Send SetDecimalSeparator
53600>>>>>        Set psArg1 to sValue
53601>>>>>        Send RestoreDecimalSeparator
53602>>>>>    End_Procedure
53603>>>>>
53603>>>>>    Procedure SetsArg2Numeric String sValue
53606>>>>>        Send SetDecimalSeparator
53607>>>>>        Set psArg2 to sValue
53608>>>>>        Send RestoreDecimalSeparator
53609>>>>>    End_Procedure
53610>>>>>
53610>>>>>    Function GetpsArg1 Returns String
53613>>>>>        Function_Return (psArg1(_SELF#))
53614>>>>>    End_Function
53615>>>>>
53615>>>>>    Function GetpsArg2 Returns String
53618>>>>>        Function_Return (psArg2(_SELF#))
53619>>>>>    End_Function
53620>>>>>
53620>>>>>    Function GetpiRet Returns String
53623>>>>>        Function_Return (piRet(_SELF#))
53624>>>>>    End_Function
53625>>>>>
53625>>>>>    Function doCallDriver# Integer iFileNumber String sDriverID Integer iFunction String sArg1 String sArg2 Integer iLong Returns Integer
53628>>>>>        Local Integer liRetval
53628>>>>>        Local String lsArg1 lsArg2
53628>>>>>
53628>>>>>        Move sArg1 to lsArg1
53629>>>>>        Move sArg2 to lsArg2
53630>>>>>
53630>>>>>        Call_Driver iFileNumber sDRiverID Function iFunction Callback 0 Passing lsArg1 lsArg2 iLong Result liRetval
53635>>>>>
53635>>>>>        Set psArg1 to lsArg1
53636>>>>>        Set psArg2 to lsArg2
53637>>>>>        Set piRet  to liRetval
53638>>>>>        Function_Return liRetval
53639>>>>>    End_Function
53640>>>>>
53640>>>>>    Function doCallDriver2# Integer iFileNumber String sDriverID Integer iFunction Integer iLong Returns Integer
53643>>>>>        Local Integer liRetval
53643>>>>>        Local String lsArg1 lsArg2
53643>>>>>
53643>>>>>        Move (psArg1(_SELF#)) to lsArg1
53644>>>>>        Move (psArg2(_SELF#)) to lsArg2
53645>>>>>
53645>>>>>        Call_Driver iFileNumber sDRiverID Function iFunction Callback 0 Passing lsArg1 lsArg2 iLong Result liRetval
53650>>>>>
53650>>>>>        Set psArg1 to lsArg1
53651>>>>>        Set psArg2 to lsArg2
53652>>>>>        Set piRet  to liRetval
53653>>>>>        Function_Return liRetval
53654>>>>>    End_Function
53655>>>>>
53655>>>>>End_Object
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-10-25 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-10-25 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-11-09 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-07-13 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//==========================================
53656>>>>>// SELECT STUFFS
53656>>>>>//==========================================
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-01-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-07-25 By: Thomas
53656>>>>>
53656>>>>>//Last Revised: 2008-01-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-09-06 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-09-07 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-09-06 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-09-06 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-09-06 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-03-27 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-03-27 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-03-27 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-09-22 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-09-22 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-08-03 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-08-10 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-08 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-02-25 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-08-27 By: Marcelo
53656>>>>>// SQL_GET_OUTPUT_VALUE <POSITION> TO <VARIABLE>
53656>>>>>
53656>>>>>//Last Revised: 2007-09-13 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-08-03 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-01-29 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-01-29 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-09-07 By: Marcelo
53656>>>>>
53656>>>>>
53656>>>>>//Last Revised: 2005-08-29 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-08-29 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-08-27 By: Marcelo
53656>>>>>
53656>>>>>
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-09-15 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-07-19 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2006-12-27 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-10 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//==================================
53656>>>>>// SQLFlex Commands
53656>>>>>//==================================
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-02-18 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-07-21 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-06-18 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-05-10 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-05-10 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-30 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-05-07 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//==========================================
53656>>>>>// SQL SERVER Stored Procedure Call engine
53656>>>>>//==========================================
53656>>>>>
53656>>>>>//Last Revised: 2008-04-30 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-10 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-02-06 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-02-06 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2008-02-15 By: Marcelo
53656>>>>>// Copy_Data {source-table} To {dest-table} [Callback {callback-object}] [Constrain {SQL-expression}]
53656>>>>>
53656>>>>>//============================
53656>>>>>// ORAFlex Commands
53656>>>>>//============================
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2006-03-21 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-07-19 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//===========================
53656>>>>>// BUFFER save stuffs
53656>>>>>//===========================
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-08-14 By: Marcelo
53656>>>>>// CREATE_TABLE_FROM_DAT_FILE <FILE NUMBER>
53656>>>>>
53656>>>>>//Last Revised: 2002-08-14 By: Marcelo
53656>>>>>// CONVERT_DAT_FILE <FILE NUMBER>
53656>>>>>
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-04-23 By: Marcelo
53656>>>>>// Syntax:
53656>>>>>//   GET_SERVER_CFG SERVER_REVISION|SUPPORT_DESC|SUPPORT_CASE|SERVER_VERSION|SERVER_ENCODING|CONNECTION_ACTIVE OF <SERVER NAME> TO <RESULT>
53656>>>>>// Description:
53656>>>>>//   Use this command to retrieve from database server the following informations :
53656>>>>>//   command arguments :
53656>>>>>//      SERVER_REVISON : Retrieve Server major revision
53656>>>>>//      SUPPORT_DESC : <RESULT> is 1 if Server supports Descending index segments
53656>>>>>//      SUPPORT_CASE : <RESULT> is 1 if Server supports Case Insensitive index segments
53656>>>>>//      SERVER_VERSION : Retrieve Complete Server Version Description
53656>>>>>//      SERVER_ENCODING : Retrieve the Server Encoding
53656>>>>>//      CONNECTION_ACTIVE : Retrieve the Connection status. DFTRUE means connection is active
53656>>>>>//
53656>>>>>
53656>>>>>//Last Revised: 2007-04-23 By: Marcelo
53656>>>>>// Syntax:
53656>>>>>//  GET_CONNECTION_STATUS of <serverName> [<databaseName>] to <variable>
53656>>>>>// Description:
53656>>>>>//  Use this command to retrieve the connection status from the specified server
53656>>>>>//  command argumetns :
53656>>>>>//    <serverName> : Server Name
53656>>>>>//    <databaseName> : Database Name
53656>>>>>//    <variable> : DFTRUE means connection is active
53656>>>>>
53656>>>>>//Last Revised: 2005-04-06 By: Marcelo
53656>>>>>// Syntax:
53656>>>>>//   GET_CLIENT_CFG ENCODING OF <SERVER NAME> [<DATABASE NAME>] TO <RESULT>
53656>>>>>// Description:
53656>>>>>//   Use this command to retrieve from database server the following informations :
53656>>>>>//   command arguments :
53656>>>>>//      ENCODING : Retrieve the Client Encoding
53656>>>>>//
53656>>>>>
53656>>>>>//Last Revised: 2006-05-26 By: Marcelo
53656>>>>>// Syntax:
53656>>>>>//   SET_CLIENT_CFG ENCODING OF <SERVER NAME> [<DATABASE NAME>] TO <RESULT>
53656>>>>>// Description:
53656>>>>>//   Use this command to Set the following client informations :
53656>>>>>//   command arguments :
53656>>>>>//      ENCODING : Set the Client Encoding
53656>>>>>//      UNIQUE_CHECKS {DFTRUE/DFFALSE}: enable/disable uniqueness checks for secondary indexes in InnoDB tables
53656>>>>>//
53656>>>>>
53656>>>>>//NEW
53656>>>>>//Last Revised: 2002-08-23 By: Marcelo
53656>>>>>// Syntax:
53656>>>>>//   FORMAT TO USE : CALL_DB2_PROCEDURE <OWNER> <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
53656>>>>>// Description:
53656>>>>>//   CALL_STORED_PROCEDURE will call a stored procedure passing arguments
53656>>>>>
53656>>>>>// GET_RESULT_SET INTO <Var1 Var2 Var3 ... Varn>
53656>>>>>
53656>>>>>// GET_RESULTS
53656>>>>>
53656>>>>>// GET_MORE_RESULTS
53656>>>>>
53656>>>>>// GET_RESULT_SET_NUM_COLS TO <VAR>
53656>>>>>
53656>>>>>// GET_RESULT_SET_COL_NAME <COL NUMBER> TO <VAR> {<SIZE>}
53656>>>>>
53656>>>>>
53656>>>>>
53656>>>>>// CREATE_DB2_DATABASE <DB Name> <DB Alias> <Code Set> <Territory> [<Path> <NodeName> < UserId> <Password>]
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Hideraldo
53656>>>>>
53656>>>>>//Last Revised: 2005-04-04 By: Hideraldo
53656>>>>>
53656>>>>>//Last Revised: 2003-04-08 By: Marcelo
53656>>>>>
53656>>>>>
53656>>>>>
53656>>>>>//Last Revised: 2007-08-13 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-11-03 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-11-03 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2004-11-17 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2007-08-13 By: Marcelo
53656>>>>>
53656>>>>>//Last Revised: 2003-09-02 By: Marcelo
53656>>>>>FUNCTION SQLESCAPESTRING GLOBAL STRING SARG RETURNS STRING
53658>>>>>  LOCAL STRING LSARG
53658>>>>>  SQL_ESCAPE_STRING OF SARG TO LSARG
53702>>>>>  FUNCTION_RETURN LSARG
53703>>>>>END_FUNCTION
53704>>>>>
53704>>>>>//Last Revised: 2007-08-13 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-03-18 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-03-21 By: Marcelo
53704>>>>>
53704>>>>>//
53704>>>>>// LOB Columns Macro Commands Support
53704>>>>>//
53704>>>>>//Last Revised: 2007-10-04 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2008-08-19 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2008-06-20 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2007-10-04 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2007-10-04 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2007-10-04 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2007-10-04 By: Marcelo
53704>>>>>
53704>>>>>//
53704>>>>>// MYSQL Specific Macro Commands
53704>>>>>//
53704>>>>>
53704>>>>>
53704>>>>>//Last Revised: 2005-08-23 By: Marcelo
53704>>>>>
53704>>>>> ////////// Internal Macro Commands, Procedures and Functions
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>>
53704>>>>>//Last Revised: 2005-08-29 By: Marcelo
53704>>>>> Procedure MertechInc_SQL_PROCEDURE_EXECUTE for Desktop
53706>>>>>    SQL_EXECUTE_STMT
53748>>>>> End_Procedure
53749>>>>>
53749>>>>>//Last Revised: 2005-08-29 By: Marcelo
53749>>>>> Procedure MertechInc_SQL_FUNCTION_EXECUTE Desktop String sDriverName 
53751>>>>>    send MertechInc_SQL_PROCEDURE_EXECUTE
53752>>>>>    if (sDriverName = MYSQLFLEX) begin
53754>>>>>        SQL_FETCH_NEXT_ROW
53798>>>>>    end
53798>>>>>>
53798>>>>> End_Procedure
53799>>>>>
53799>>>>>//Last Revised: 2005-08-29 By: Marcelo
53799>>>>> Procedure MertechInc_SQL_SET_MYPROCEDURE_NAME Desktop String strProcName Integer iNumpar
53801>>>>>    Local Integer liPos#
53801>>>>>
53801>>>>>    DO_DECLARE_BASIC_VARIABLES#
53802>>>>>
53802>>>>>    MOVE 0 TO _NPAR#
53803>>>>>        INDICATE ERR FALSE
53804>>>>>
53804>>>>>    MOVE MySQLFlex TO _DRIVERNAME#
53805>>>>>
53805>>>>>    SQL_SET_STMT TO "CALL "
53845>>>>>    SQL_APPEND_STMT TO strProcName
53885>>>>>    SQL_APPEND_STMT TO "("
53925>>>>>    For liPos# From 1 TO iNumpar
53931>>>>>>
53931>>>>>        DO_PASS_ARGUMENTS liPos#
54027>>>>>    Loop
54028>>>>>>
54028>>>>>    SQL_APPEND_STMT TO ")"
54068>>>>>
54068>>>>>    SQL_PREPARE_STMT
54110>>>>> End_Procedure
54111>>>>>
54111>>>>>//Last Revised: 2005-08-29 By: Marcelo
54111>>>>> Procedure MertechInc_SQL_SET_ORAPROCEDURE_NAME Desktop String strProcName Integer iNumpar 
54113>>>>>    Local Integer liPos#
54113>>>>>
54113>>>>>    DO_DECLARE_BASIC_VARIABLES#
54114>>>>>
54114>>>>>    MOVE 0 TO _NPAR#
54115>>>>>        INDICATE ERR FALSE
54116>>>>>
54116>>>>>    MOVE ORAFlex TO _DRIVERNAME#
54117>>>>>
54117>>>>>    SQL_SET_STMT TO "BEGIN "
54157>>>>>    SQL_APPEND_STMT TO strProcName
54197>>>>>    SQL_APPEND_STMT TO "( "
54237>>>>>    For liPos# From 1 TO iNumpar
54243>>>>>>
54243>>>>>        DO_PASS_ARGUMENTS liPos#
54339>>>>>    Loop
54340>>>>>>
54340>>>>>    SQL_APPEND_STMT TO  " ); END;"
54380>>>>>    SQL_PREPARE_STMT
54422>>>>> End_Procedure
54423>>>>>
54423>>>>>//Last Revised: 2005-06-29 By: Marcelo
54423>>>>> Procedure MertechInc_SQL_SET_MYFUNCTION_NAME Desktop String strProcName Integer iNumparp
54425>>>>>     Local Integer liPos#
54425>>>>>
54425>>>>>    MOVE MySQLFlex TO _DRIVERNAME#
54426>>>>>
54426>>>>>    SQL_SET_STMT TO "SELECT "
54466>>>>>    SQL_APPEND_STMT TO strProcName
54506>>>>>    SQL_APPEND_STMT TO "("
54546>>>>>    For liPos# from 1 to 
54552>>>>>>
54552>>>>>        DO_PASS_ARGUMENTS liPos#
54648>>>>>    Loop
54649>>>>>>
54649>>>>>    SQL_APPEND_STMT TO ")"
54689>>>>>
54689>>>>>    SQL_PREPARE_STMT
54731>>>>> End_Procedure
54732>>>>>
54732>>>>>//Last Revised: 2005-06-29 By: Marcelo
54732>>>>> Procedure MertechInc_SQL_SET_ORAFUNCTION_NAME Desktop String strProcName Integer iNumpar
54734>>>>>    Local Integer liPos# liLLong#
54734>>>>>    Local String lsArg2# lsBlank#
54734>>>>>
54734>>>>>        SQL_SET_STMT TO "BEGIN "
54774>>>>>    SQL_APPEND_STMT TO ":PAR_RET := "
54814>>>>>    SQL_APPEND_STMT TO strProcName
54854>>>>>    SQL_APPEND_STMT TO "( "
54894>>>>>    For liPos# From 1 TO iNumpar
54900>>>>>>
54900>>>>>        DO_PASS_ARGUMENTS liPos#
54996>>>>>    Loop
54997>>>>>>
54997>>>>>    SQL_APPEND_STMT TO  " ); END;"
55037>>>>>    SQL_PREPARE_STMT
55079>>>>>
55079>>>>>    MOVE IS_OUT TO liLLong#
55080>>>>>    move " " to lsBlank#
55081>>>>>    CALL_DRIVER 0 ORAFLEX FUNCTION CALLDRV_SET_PROC_ATTRIBUTE_TYPE CALLBACK 0 PASSING lsBlank# lsBlank# liLLong# RESULT _RET#
55086>>>>>
55086>>>>>    INCREMENT _NPAR#
55087>>>>>    MOVE ":PAR_RET" TO lsArg2#
55088>>>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION 23 CALLBACK 0 PASSING _BLANK# lsArg2# 16384 RESULT _RET#
55093>>>>>End_Procedure
55094>>>>>
55094>>>>>//Last Revised: 2008-02-26 By: Marcelo
55094>>>>>Function SQL_AVAILABLE_SQL_SERVERS Desktop Returns Integer 
55096>>>>>    Local Integer liRet#
55096>>>>>    Local String lsBlank#
55096>>>>>
55096>>>>>    move " " to lsBlank#
55097>>>>>    CALL_DRIVER 0 SQLFLEX FUNCTION CALLDRV_ENUMERATE_SERVER CALLBACK 0 PASSING lsBlank# lsBlank# CALLDRV_ENUMERATE_SERVER_COUNT RESULT liRet#
55102>>>>>
55102>>>>>    function_return liRet#
55103>>>>>End_Function
55104>>>>>
55104>>>>>//Last Revised: 2008-06-26 By: Marcelo
55104>>>>>Function SQL_AVAILABLE_SQL_SERVER_NAME Desktop Integer item# Returns String 
55106>>>>>    Local Integer liRet#
55106>>>>>    Local String lsArg1# lsArg2# lsBlank#
55106>>>>>
55106>>>>>    MOVE (REPEAT(" ", 80)) TO lsArg1#
55107>>>>>    move item# to lsArg2#
55108>>>>>    CALL_DRIVER 0 SQLFLEX FUNCTION CALLDRV_ENUMERATE_SERVER CALLBACK 0 PASSING lsArg1# lsArg2# CALLDRV_ENUMERATE_SERVER_SERVER RESULT liRet#
55113>>>>>
55113>>>>>    Function_Return lsArg1#
55114>>>>>End_Function
55115>>>>>
55115>>>>>//Last Revised: 2008-02-26 By: Marcelo
55115>>>>>Procedure Set SQL_USE_ROWCOUNT_IN_TRANSACTIONS global String server# Integer value#
55117>>>>>    Local Integer liRet#
55117>>>>>    Local String lsArg1# lsArg2#
55117>>>>>
55117>>>>>    DO_DECLARE_BASIC_VARIABLES#
55118>>>>>    DO_GETFILENUMBER_DRIVERNAME# 0
55149>>>>>
55149>>>>>    move server# to lsArg1#
55150>>>>>    move value# to lsArg2#
55151>>>>>
55151>>>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS CALLBACK 0 PASSING lsArg1# lsArg2# CALLDRV_VALUE_SET RESULT liRet#
55156>>>>>    IF liRet# EQ -1 INDICATE ERR TRUE
55159>>>>>
55159>>>>>    DO_RESTORE_FILENUMBER#
55160>>>>>End_Procedure
55161>>>>>//#REPLACE UseRowCountInTransactions SQL_USE_ROWCOUNT_IN_TRANSACTIONS
55161>>>>>
55161>>>>>//Last Revised: 2008-02-26 By: Marcelo
55161>>>>>Function SQL_USE_ROWCOUNT_IN_TRANSACTIONS Global String serverName# Returns Integer
55163>>>>>    Local Integer liRet#
55163>>>>>    Local String lsBlank#
55163>>>>>    Local String lsArg1#
55163>>>>>
55163>>>>>    DO_DECLARE_BASIC_VARIABLES#
55164>>>>>    DO_GETFILENUMBER_DRIVERNAME# 0
55195>>>>>
55195>>>>>    move serverName# to lsArg1#
55196>>>>>    move " " to lsBlank#
55197>>>>>    CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_ROWCOUNT_IN_TRANSACTIONS CALLBACK 0 PASSING lsArg1# lsBlank# CALLDRV_VALUE_GET RESULT liRet#
55202>>>>>
55202>>>>>    DO_RESTORE_FILENUMBER#
55203>>>>>
55203>>>>>    function_return liRet#
55204>>>>>End_Function
55205>>>>>
55205>>>>>//Last Revised: 2008-02-26 By: Marcelo
55205>>>>>Procedure Set SQL_USE_DATAFLEX_DATEFORMAT global Integer value#
55207>>>>>    DO_DECLARE_BASIC_VARIABLES#
55208>>>>>    DO_GETFILENUMBER_DRIVERNAME# 0
55239>>>>>
55239>>>>>    If _DRIVERNAME# eq SQLFlex Begin
55241>>>>>        move value# to _ARG1#
55242>>>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_DFLEX_DATE_FORMAT CALLBACK 0 PASSING _ARG1# _BLANK# CALLDRV_VALUE_SET RESULT _RET#
55247>>>>>        IF _RET# EQ -1 INDICATE ERR TRUE
55250>>>>>    End
55250>>>>>>
55250>>>>>
55250>>>>>    DO_RESTORE_FILENUMBER#
55251>>>>>End_Procedure
55252>>>>>//#REPLACE SqlUseDataflexDateFormat SQL_USE_DATAFLEX_DATEFORMAT
55252>>>>>
55252>>>>>//Last Revised: 2008-02-26 By: Marcelo
55252>>>>>Function SQL_USE_DATAFLEX_DATEFORMAT Global Returns Integer
55254>>>>>    DO_DECLARE_BASIC_VARIABLES#
55255>>>>>    DO_GETFILENUMBER_DRIVERNAME# 0
55286>>>>>
55286>>>>>    If _DRIVERNAME# eq SQLFlex Begin
55288>>>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_USE_DFLEX_DATE_FORMAT CALLBACK 0 PASSING _BLANK# _BLANK# CALLDRV_VALUE_GET RESULT _RET#
55293>>>>>    End
55293>>>>>>
55293>>>>>    Else Move DFFALSE to _RET#
55295>>>>>
55295>>>>>    DO_RESTORE_FILENUMBER#
55296>>>>>
55296>>>>>    function_return _RET#
55297>>>>>End_Function
55298>>>>>
55298>>>>>//Last Revised: 2008-08-27 By: Marcelo
55298>>>>>Procedure Set SQL_FORCE_FIELDS_NOT_NULL global Integer value#
55300>>>>>    DO_DECLARE_BASIC_VARIABLES#
55301>>>>>    DO_GETFILENUMBER_DRIVERNAME# 0
55332>>>>>
55332>>>>>    If (_DRIVERNAME# eq ORAFlex OR _DRIVERNAME# eq MySQLFlex) Begin
55334>>>>>        move value# to _ARG1#
55335>>>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_FORCE_FIELDS_NOT_NULL CALLBACK 0 PASSING _ARG1# _BLANK# CALLDRV_VALUE_SET RESULT _RET#
55340>>>>>        IF _RET# EQ -1 INDICATE ERR TRUE
55343>>>>>    End
55343>>>>>>
55343>>>>>
55343>>>>>    DO_RESTORE_FILENUMBER#
55344>>>>>End_Procedure
55345>>>>>
55345>>>>>//Last Revised: 2008-08-27 By: Marcelo
55345>>>>>Function SQL_FORCE_FIELDS_NOT_NULL Global Returns Integer
55347>>>>>    DO_DECLARE_BASIC_VARIABLES#
55348>>>>>    DO_GETFILENUMBER_DRIVERNAME# 0
55379>>>>>
55379>>>>>    If (_DRIVERNAME# eq ORAFlex OR _DRIVERNAME# eq MySQLFlex) Begin
55381>>>>>        CALL_DRIVER 0 _DRIVERNAME# FUNCTION CALLDRV_FORCE_FIELDS_NOT_NULL CALLBACK 0 PASSING _BLANK# _BLANK# CALLDRV_VALUE_GET RESULT _RET#
55386>>>>>    End
55386>>>>>>
55386>>>>>    Else Move DFFALSE to _RET#
55388>>>>>
55388>>>>>    DO_RESTORE_FILENUMBER#
55389>>>>>
55389>>>>>    function_return _RET#
55390>>>>>End_Function
55391>>>>>
55391>>>>>//Last Revised: 2008-08-27 By: Marcelo
55391>>>>>
55391>>>>>//Last Revised: 2008-08-27 By: Marcelo
55391>>>>>
55391>>>>>//Last Revised: 2008-08-22 By: Marcelo
55391>>>>>
55391>>>>>//Last Revised: 2008-08-22 By: Marcelo
55391>>>
55391>>>//AB-StoreTopEnd
55391>>>
55391>>>//AB-IgnoreStart
55391>>>
55391>>>Use Panel.Sub
55391>>>Use Txtbox.Sub
55391>>>Use Form.Sub
55391>>>Use Button.Sub
55391>>>
55391>>>
55391>>>//AB-IgnoreEnd
55391>>>
55391>>>Object Connect is a BasicPanelSub
ERROR: 4388 Illegal object name definition CONNECT ALREADY DEFINED AS A FUNCTION/PROPERTY ON LINE: 43 (55391) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
55393>>>
55393>>>    //AB-StoreTopStart
55393>>>
55393>>>    Property Integer piOk public false
55395>>>
55395>>>
55395>>>    Function Network_User_Name Returns String
55398>>>        Local String sName sLength
55398>>>        Local Pointer lpName_Addr lpLength_Addr
55398>>>        Local Integer iRetval
55398>>>        Movestr (Repeat (Character (0), 255)) To sName
55399>>>>
55399>>>        GetAddress Of sName To lpName_Addr
55400>>>        Movestr (DwordToBytes (255)) To sLength
55401>>>>
55401>>>        GetAddress Of sLength To lpLength_Addr
55402>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
55403>>>>
55403>>>        If iRetval Eq 0 Function_Return (CString (sName))
55406>>>        Else Function_Return "Cannot recognize User Name"
55408>>>    End_Function // Network_User_Name
55409>>>
55409>>>    //AB-StoreTopEnd
55409>>>
55409>>>    Set Sysmenu_Icon to FALSE
55410>>>    Set Minimize_Icon to FALSE
55411>>>    Set Label to " "
55412>>>    Set Size to 57 231
55413>>>    Set Location to 52 49
55414>>>    Set Color to clTeal
55415>>>    Set TextColor to clAqua
55416>>>    Set Popup_State to TRUE
55417>>>
55417>>>    //AB-DDOStart
55417>>>
55417>>>
55417>>>    //AB-DDOEnd
55417>>>
55417>>>    Object Textbox7 is a TextBoxSub
55419>>>        Set Label to ""
55420>>>        Set Color to clTeal
55421>>>        Set TextColor to clAqua
55422>>>        Set FontSize to 14 8
55423>>>        Set Location to 9 9
55424>>>        Set Size to 10 30
55425>>>        Set FontWeight to 600
55426>>>        Set TypeFace to "Arial Greek"
55427>>>        Set Enabled_State to TRUE
55428>>>    End_Object    // Textbox7
55429>>>
55429>>>    Object Form5 is a FormSub
55431>>>        Set Size to 13 93
55432>>>        Set Location to 7 65
55433>>>        Set Color to 14349270
55434>>>        Set TextColor to 1720339
55435>>>        Set Label_Col_Offset to 2
55436>>>        Set Label_Justification_Mode to jMode_Right
55437>>>    End_Object    // Form5
55438>>>
55438>>>    Object Textbox8 is a TextBoxSub
55440>>>        Set Label to ""
55441>>>        Set Color to clTeal
55442>>>        Set TextColor to clAqua
55443>>>        Set FontSize to 14 8
55444>>>        Set Location to 24 9
55445>>>        Set Size to 10 30
55446>>>        Set FontWeight to 600
55447>>>        Set TypeFace to "Arial Greek"
55448>>>        Set Enabled_State to TRUE
55449>>>    End_Object    // Textbox8
55450>>>
55450>>>    Object Form6 is a FormSub
55452>>>        Set Size to 13 93
55453>>>        Set Location to 22 65
55454>>>        Set Color to 14349270
55455>>>        Set TextColor to 1720339
55456>>>        Set Label_Col_Offset to 2
55457>>>        Set Label_Justification_Mode to jMode_Right
55458>>>
55458>>>        //AB-StoreStart
55458>>>        Set Password_State Item 0 to True
55459>>>
55459>>>        //AB-StoreEnd
55459>>>
55459>>>    End_Object    // Form6
55460>>>
55460>>>    Object oOK_bn is a ButtonSub
55462>>>        Set Default_State to TRUE
55463>>>        Set Bitmap to "CheckYes.Bmp"
55464>>>        Set Size to 23 24
55465>>>        Set Location to 10 165
55466>>>
55466>>>        //AB-StoreStart
55466>>>
55466>>>        Set TooltipValue to "     "
55467>>>
55467>>>        On_Key kEnter Send Stop_Modal_ui
55468>>>
55468>>>        Procedure OnClick
55471>>>            Set piOk to True
55472>>>            Send Stop_Modal_ui
55473>>>        End_Procedure
55474>>>
55474>>>
55474>>>
55474>>>        //AB-StoreEnd
55474>>>
55474>>>    End_Object    // oOK_bn
55475>>>
55475>>>    Object oCancel_bn is a ButtonSub
55477>>>        Set Bitmap to "CheckNo.Bmp"
55478>>>        Set Size to 23 24
55479>>>        Set Location to 10 196
55480>>>
55480>>>        //AB-StoreStart
55480>>>
55480>>>        Set TooltipValue to " / "
55481>>>
55481>>>        On_Key kEnter Send Exit_Application to (Connect(Self))
55482>>>
55482>>>        Procedure OnClick
55485>>>            Set piOK to False
55486>>>            Send Exit_Application to (Connect(Self))
55487>>>        End_Procedure
55488>>>
55488>>>
55488>>>
55488>>>        //AB-StoreEnd
55488>>>
55488>>>    End_Object    // oCancel_bn
55489>>>
55489>>>
55489>>>    //AB-StoreStart
55489>>>
55489>>>    Set Modal_State                     to True
55490>>>    Set Locate_Mode                     to Center_On_Screen
55491>>>    Set Exit_Application_Local_State    to False
55492>>>    Set Exit_MSG                        to Exit
55493>>>    Set Description_State               to True
55494>>>
55494>>>    On_Key kEnter       Send OnClick to (oOk_bn(Current_Object))
55495>>>    On_Key kSave_Record Send OK
55496>>>    On_Key kCancel      Send Exit_Application
55497>>>    On_Key kClose_Panel Send Exit_Application
55498>>>
55498>>>    Procedure Activating
55501>>>        Local String sLoginUserid sLoginPassword sLastLogin
55501>>>        Forward Send Activating
55503>>>        Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sLastLogin
55506>>>        If sLastLogin eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sLastLogin
55509>>>        insert "WorkSpaces\" in sLastLogin at 1
55511>>>        Append sLastLogin "\" (Module_Name(Self))
55513>>>        Append sLastLogin "\LastLogin"
55514>>>        Get_profile_string sLastLogin "LoginUserId"  to sLoginUserid
55517>>>        If sLoginUserid eq "" Move (Network_User_Name(Current_Object))      to sLoginUserid
55520>>>        Set Value of (Form5(Current_Object))  Item 0 to sLoginUserid
55521>>>    End_Procedure
55522>>>
55522>>>    Function LoginUser Returns Integer
55525>>>        Integer iSavePassword iSize isPasswordOk
55525>>>        String  sLoginUserid sLoginPassword sLastLogin
55525>>>        String  lsLoginDate lsHH lsMM lsSS
55525>>>    
55525>>>        Send Popup_Modal
55526>>>    
55526>>>        Get Value of (Form5(Current_Object))      Item 0 to sLoginUserid
55527>>>        Get Value of (Form6(Current_Object))      Item 0 to sLoginPassword
55528>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
55529>>>    
55529>>>        Open "Users" as Users
55531>>>        File_Size Users to iSize
55534>>>        If iSize ne 0 Begin
55536>>>             Clear Users
55537>>>             Move sLoginUserid   to Users.Login_Id
ERROR: 4345 Type check error USERS.LOGIN_ID, MUST BE DEFINED ON LINE: 219 (55537) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
ERROR: 4328 Undefined symbol in argument USERS.LOGIN_ID ON LINE: 219 (55537) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
55538>>>             Find eq Users by Index.1
55539>>>>
55539>>>             [Finderr] Begin
55541>>>>
55541>>>                Error 9998 "The User is Unknown"
55542>>>>
55542>>>                Set piOK to False
55543>>>                Get piOK to isPasswordOk
55544>>>                Function_Return isPasswordOk
55545>>>             End
55545>>>>
55545>>>             If (Found=1) Begin
55547>>>                If (sLoginPassword <>Users.Password) Begin
55549>>>                    Error 9999 "The Password is Not Valid"
55550>>>>
55550>>>                    Set piOK to False
55551>>>                    Get piOK to isPasswordOk
55552>>>                    Function_Return isPasswordOk
55553>>>                End
55553>>>>
55553>>>             End
55553>>>>
55553>>>        End
55553>>>>
55553>>>        Close Users
55554>>>        Get piOK to isPasswordOk
55555>>>        Sysdate lsLoginDate lsHH lsMM lsSS
55559>>>        Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sLastLogin
55562>>>        If sLastLogin eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sLastLogin
55565>>>        insert "WorkSpaces\" in sLastLogin at 1
55567>>>        Append sLastLogin "\" (Module_Name(Self))
55569>>>        Append sLastLogin "\LastLogin"
55570>>>        Set_profile_string sLastLogin "LoginUserId"     to sLoginUserid
55573>>>        If lsHH lt 10 Insert 0 in lsHH at 1
55577>>>        If lsMM lt 10 Insert 0 in lsMM at 1
55581>>>        If lsSS lt 10 Insert 0 in lsSS at 1
55585>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
55591>>>        Set_profile_string sLastLogin "LoginTime" to lsLoginDate
55594>>>        Function_Return isPasswordOk
55595>>>    End_Function
55596>>>    
55596>>>    Procedure Login For Desktop
55598>>>        Local Integer sLoginPassword
55598>>>        Get LoginUser of (Connect(Current_Object)) to sLoginPassword
55599>>>        If Not sLoginPassword Send Exit_Application
55602>>>    End_Procedure
55603>>>    
55603>>>    
55603>>>    
55603>>>    
55603>>>    Function LoginUser2 Returns Integer
55606>>>        Integer iSavePassword iSize isPasswordOk
55606>>>        String  sLoginUserid sLoginPassword sLastLogin
55606>>>        String  lsLoginDate lsHH lsMM lsSS
55606>>>    
55606>>>        Set Value of (Form5(Current_Object))      Item 0 to 'athens oil'
55607>>>    
55607>>>        Send Popup_Modal
55608>>>    
55608>>>        Get Value of (Form5(Current_Object))      Item 0 to sLoginUserid
55609>>>        If (sLoginUserid<>'athens oil') Function_Return 0
55612>>>        Move 'athens oil' to sLoginuserID
55613>>>        Get Value of (Form6(Current_Object))      Item 0 to sLoginPassword
55614>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
55615>>>    
55615>>>        Open "Users" as Users
55617>>>        File_Size Users to iSize
55620>>>        If iSize ne 0 Begin
55622>>>             Clear Users
55623>>>             Move sLoginUserid   to Users.Login_Id
ERROR: 4345 Type check error USERS.LOGIN_ID, MUST BE DEFINED ON LINE: 281 (55623) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
ERROR: 4328 Undefined symbol in argument USERS.LOGIN_ID ON LINE: 281 (55623) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
55624>>>             Find eq Users by Index.1
55625>>>>
55625>>>             [Finderr] Begin
55627>>>>
55627>>>                Error 9998 "  "
55628>>>>
55628>>>                Set piOK to False
55629>>>                Get piOK to isPasswordOk
55630>>>                Function_Return isPasswordOk
55631>>>             End
55631>>>>
55631>>>             If (Found=1) Begin
55633>>>                If (sLoginPassword <>Users.Password) Begin
55635>>>                    Error 9999 " "
55636>>>>
55636>>>                    Set piOK to False
55637>>>                    Get piOK to isPasswordOk
55638>>>                    Function_Return isPasswordOk
55639>>>                End
55639>>>>
55639>>>             End
55639>>>>
55639>>>        End
55639>>>>
55639>>>        Close Users
55640>>>        Get piOK to isPasswordOk
55641>>>        Sysdate lsLoginDate lsHH lsMM lsSS
55645>>>        Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sLastLogin
55648>>>        If sLastLogin eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sLastLogin
55651>>>        insert "WorkSpaces\" in sLastLogin at 1
55653>>>        Append sLastLogin "\" (Module_Name(Self))
55655>>>        Append sLastLogin "\LastLogin"
55656>>>        Set_profile_string sLastLogin "LoginUserId"     to sLoginUserid
55659>>>        If lsHH lt 10 Insert 0 in lsHH at 1
55663>>>        If lsMM lt 10 Insert 0 in lsMM at 1
55667>>>        If lsSS lt 10 Insert 0 in lsSS at 1
55671>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
55677>>>        Set_profile_string sLastLogin "LoginTime" to lsLoginDate
55680>>>        Function_Return isPasswordOk
55681>>>    End_Function
55682>>>    
55682>>>    Procedure Login2 For Desktop
55684>>>        Local Integer sLoginPassword
55684>>>        Get LoginUser2 of (Connect(Current_Object)) to sLoginPassword
55685>>>        If Not sLoginPassword Send Exit_Application
55688>>>    End_Procedure
55689>>>    
55689>>>    Function CheckLogin For Desktop Returns Integer
55691>>>        Local Integer sLoginPassword
55691>>>        Get LoginUser of (Connect(Current_Object)) to sLoginPassword
55692>>>        Function_Return sLoginPassword
55693>>>    End_Function
55694>>>    
55694>>>    
55694>>>    
55694>>>    //AB-StoreEnd
55694>>>
55694>>>End_Object    // Connect
55695>>>
55695>>>
55695>>>//AB-StoreStart
55695>>>
55695>>>
55695>>>
55695>>>//AB-StoreEnd
55695>>>
55695>>>//AB/ End_Object    // prj
ERROR: 4328 Undefined symbol in argument PROGRAMWORKSPACE ON LINE: 195 (55506) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
ERROR: 4328 Undefined symbol in argument USERS.PASSWORD ON LINE: 228 (55547) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
ERROR: 4328 Undefined symbol in argument PROGRAMWORKSPACE ON LINE: 240 (55562) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
ERROR: 4328 Undefined symbol in argument USERS.PASSWORD ON LINE: 290 (55633) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
ERROR: 4328 Undefined symbol in argument PROGRAMWORKSPACE ON LINE: 302 (55648) OF FILE: C:\VDF14.1.SUB\SUBCLASSES\AppSrc\CONNECT.DG
55695>//// use checkafm.pkg
55695>////use checklog.pkg
55695>//
55695>
55695>Move 0 to iMetrhthsProsp
ERROR: 4345 Type check error IMETRHTHSPROSP, MUST BE DEFINED ON LINE: 47 (55695) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMETRHTHSPROSP ON LINE: 47 (55695) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55696>Reread Sysrec
ERROR: 4313 Include file not found SYSREC.FD ON LINE: 48 (55697) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 52 Bad format of expression (operator)  ON LINE: 48 (55697) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55700>Unlock
55701>Move Sysrec.TIKANEI_CODE    to iMax00
ERROR: 4345 Type check error IMAX00, MUST BE DEFINED ON LINE: 50 (55701) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument SYSREC.TIKANEI_CODE ON LINE: 50 (55701) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMAX00 ON LINE: 50 (55701) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55702>Move 1                      to iMetrhthsProsp
ERROR: 4345 Type check error IMETRHTHSPROSP, MUST BE DEFINED ON LINE: 51 (55702) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMETRHTHSPROSP ON LINE: 51 (55702) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55703>
55703>//=======================
55703>Start_Entry_Validation:
55703>//-----------------------
55703>Move 0 to iMustResetPass
ERROR: 4345 Type check error IMUSTRESETPASS, MUST BE DEFINED ON LINE: 56 (55703) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMUSTRESETPASS ON LINE: 56 (55703) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55704>Move 0 to iAnenergos
ERROR: 4345 Type check error IANENERGOS, MUST BE DEFINED ON LINE: 57 (55704) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IANENERGOS ON LINE: 57 (55704) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55705>Move 0 to iApotel
ERROR: 4345 Type check error IAPOTEL, MUST BE DEFINED ON LINE: 58 (55705) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IAPOTEL ON LINE: 58 (55705) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55706>
55706>Move (iMax00-iMetrhthsProsp+1)  to iCountRemain
ERROR: 4345 Type check error ICOUNTREMAIN, MUST BE DEFINED ON LINE: 60 (55706) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument ICOUNTREMAIN ON LINE: 60 (55706) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55707>If (iMetrhthsProsp>=iMax00)     Send Exit_Application
55710>
55710>Send Login
55711>
55711>If (iHasAPassword=0) Send ChangeMyPasswordG
55714>If (iAnenergos   =1) Goto Start_Entry_Validation
55717>If (iApotel      >0) Goto Start_Entry_Validation
55720>
55720>Move 0 to iApotel
ERROR: 4345 Type check error IAPOTEL, MUST BE DEFINED ON LINE: 69 (55720) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IAPOTEL ON LINE: 69 (55720) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55721>Move 0 to iMetrhthsProsp
ERROR: 4345 Type check error IMETRHTHSPROSP, MUST BE DEFINED ON LINE: 70 (55721) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMETRHTHSPROSP ON LINE: 70 (55721) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55722>Move 0 to iAnenergos
ERROR: 4345 Type check error IANENERGOS, MUST BE DEFINED ON LINE: 71 (55722) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IANENERGOS ON LINE: 71 (55722) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55723>Move 0 to iMustResetPass
ERROR: 4345 Type check error IMUSTRESETPASS, MUST BE DEFINED ON LINE: 72 (55723) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMUSTRESETPASS ON LINE: 72 (55723) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55724>//=======================
55724>
55724>
55724>Procedure ChangeMyPasswordG Global
55726>    Integer iResult
55726>    Get ConfirmNewCustomPass of oNewPassDlg to iResult
55727>         If (iResult=0) Send Info_Box   "    "                              ""
55730>    Else If (iResult=1) Send Info_Box   "   "                                          "     "
55734>    Else If (iResult=2) Send Info_Box   "       "                           "     "
55738>    Else If (iResult=3) Send Info_Box   "    "                                     "     "
55742>    Else If (iResult=4) Send Info_Box   "       "            "     "
55746>    Else If (iResult=5) Send Info_Box   "   "                                             "     "
55750>    Else If (iResult=6) Send Info_Box   "    "                                      "     "
55754>    Else If (iResult=7) Send Info_Box   "      5  "   "     "
55758>    Else                Send Info_Box   " "                                                    "     "
55760>    Move iResult to iApotel
ERROR: 4345 Type check error IAPOTEL, MUST BE DEFINED ON LINE: 88 (55760) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IAPOTEL ON LINE: 88 (55760) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
55761>End_Procedure
55762>
55762>
55762>Object oMain is a Panel
55764>    If (gviSkipHmniaCheck<>1) Set Label to " FI   UTF-8"
55767>    Else                      Set Label to "    UTF-8"
55769>    Set Location to 4 3
55770>    Set Size to 300 450
55771>
55771>    Object oCommandBarSystem is a cCJCommandBarSystem
55773>        Set pbTimerUpdate to True
55774>//
55774>        Procedure OnCreateCommandBars
55777>            Handle hoOptions
55777>            Get OptionsObject to hoOptions
55778>            Forward Send OnCreateCommandBars
55780>        End_Procedure
55781>//
55781>        Object oMenuBar is a cCJMenuBar
55783>
55783>            Object oShowCallsMenuItem is a cCJMenuItem
55785>                If (gviSkipHmniaCheck=1) Begin
55787>                    Set psCaption to "    UTF-8 "
55788>                    Set psTooltip to "    UTF-8 "
55789>                End
55789>                Else Begin
55790>                    Set psCaption to " FI   UTF-8 "
55791>                    Set psTooltip to " FI   UTF-8 "
55792>                End
55792>                
55792>                Procedure OnExecute Variant vCommandBarControl
55795>                    Handle hoClient
55795>                    Get Client_Id to hoClient
55796>                    Send Activate_Utf_View of hoClient
55797>                End_Procedure
55798>
55798>            End_Object
55799>
55799>//            Object oShowCallsMenuItem2 is a cCJMenuItem
55799>//                Set psCaption to "Printer properties "
55799>//                Set psTooltip to "Printer properties "
55799>//
55799>//                Procedure OnExecute Variant vCommandBarControl
55799>//                    Handle hoClient
55799>//                    Get Client_Id to hoClient
55799>//                    Send Activate_oPrinterInfo of hoClient
55799>//                End_Procedure
55799>//
55799>//            End_Object
55799>
55799>
55799>//
55799>//            Object oFileMenu is a cCJMenuItem
55799>//                Set peControlType to xtpControlPopup          
55799>//                Set psCaption   to "&File"
55799>//                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
55799>//                Set psCategory to "Menus"
55799>//
55799>//                Object oClearMenuItem is a cCJClearMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oClearAllMenu is a cCJClearAllMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oPromptMenuItem is a cCJPromptMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//                Object oFindMenuItem is a cCJFindMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//                Object oFindNextMenu is a cCJFindNextMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oFindFirstMenu is a cCJFindFirstMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oFindLastMenu is a cCJFindLastMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oSaveMenuItem is a cCJSaveMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//                Object oDeleteMenuItem is a cCJDeleteMenuItem
55799>//                    Set pbAddToDesignerMenu to True
55799>//                End_Object
55799>//
55799>//                Object oExitMenu is a cCJExitMenuItem
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//            End_Object
55799>//
55799>//            Object oViewMenu is a cCJMenuItem
55799>//                Set peControlType to xtpControlPopup          
55799>//                Set psCaption to "&View"
55799>//                Set psToolTip to "View"
55799>//                Set psDescription to "Available Views"
55799>//            End_Object
55799>//            
55799>//            Object oReportMenu is a cCJMenuItem
55799>//                Set peControlType to xtpControlPopup          
55799>//                Set psCaption to "&Report"
55799>//                Set psToolTip to "Report"
55799>//                Set psDescription to "Available Reports"
55799>//            End_Object
55799>//
55799>//            Object oNavigateMenu is a cCJMenuItem
55799>//                Set peControlType to xtpControlPopup      
55799>//                Set psCaption to "&Navigate"    
55799>//                Set psTooltip to "Navigate"    
55799>//                Set psDescription to "Move to different areas of the application"
55799>//
55799>//                Object oNextAreaMenu is a cCJNextAreaMenu
55799>//                End_Object
55799>//
55799>//                Object oPriorAreaMenu is a cCJPriorAreaMenu
55799>//                End_Object
55799>//
55799>//                Object oNextViewMenu is a cCJNextViewMenu
55799>//                End_Object
55799>//
55799>//                Object oPriorViewMenu is a cCJPriorViewMenu
55799>//                End_Object
55799>//
55799>//                Object oPromptMenu is a cCJPromptMenuItem
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//                Object oZoomMenu is a cCJZoomMenuItem
55799>//                End_Object
55799>//
55799>//            End_Object
55799>//
55799>//            Object oWindowMenu is a cCJMDIWindowsMenuItem
55799>//                Set peControlType to xtpControlPopup
55799>//                Set psCaption to "&Window"
55799>//                Set psToolTip to "Window"
55799>//                Set psDescription to "Display Current Views and set other display options."    
55799>//
55799>//                // These are the static windows items. More will be created in onInitPopup 
55799>//                Object oDisplayOptionsMenu is a cCJMenuItem
55799>//                    Set peControlType to xtpControlPopup          
55799>//                    Set psCaption to "&Display Options"
55799>//                    Set psToolTip to "Display Options"
55799>//                    Set psDescription to "Set display options"
55799>//
55799>//                    Object oStatusbarMenu is a cCJStatusbarMenuItem
55799>//                    End_Object
55799>//
55799>//                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
55799>//                    End_Object
55799>//
55799>//                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
55799>//                        Set pbControlBeginGroup to True
55799>//                    End_Object
55799>//
55799>//                End_Object
55799>//
55799>//                Object oCascadeMenu is a cCJCascadeMenuItem
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//                Object oHorizTile is a cCJTileHorizontally
55799>//                End_Object
55799>//
55799>//                Object oVertTile is a cCJTileVertically
55799>//                End_Object
55799>//
55799>//                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
55799>//                End_Object
55799>//
55799>//                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
55799>//                    Set pbControlBeginGroup to True
55799>//                End_Object
55799>//
55799>//            End_Object
55799>//
55799>//            Object oHelpMenu is a cCJMenuItem
55799>//                Set peControlType to xtpControlPopup    
55799>//                Set psCaption to "&Help"
55799>//                Set psDescription to "Access Information for learning and using this DataFlex application."
55799>//                Set psToolTip to "Help"
55799>//
55799>//                Object oHelpMenuItem is a cCJHelpMenuItem 
55799>//                End_Object
55799>//
55799>//                Object oAboutMenuItem is a cCJAboutMenuItem
55799>//                End_Object
55799>//
55799>//            End_Object
55799>//
55799>        End_Object
55800>//
55800>//        Object oFindToolBar is a cCJToolbar
55800>//            Set psTitle to "Finding Toolbar"
55800>//
55800>//            Object oFindFirstTool is a cCJFindFirstMenuItem
55800>//            End_Object
55800>//
55800>//            Object oFindPreviousTool is a cCJFindPreviousMenuItem
55800>//            End_Object
55800>//
55800>//            Object oFindMenuTool is a cCJFindMenuItem
55800>//            End_Object
55800>//
55800>//            Object oFindNextTool is a cCJFindNextMenuItem
55800>//            End_Object
55800>//
55800>//            Object oFindLastTool is a cCJFindLastMenuItem
55800>//            End_Object
55800>//
55800>//            Object oPromptToolItem is a cCJPromptMenuItem
55800>//                Set pbControlBeginGroup to True
55800>//            End_Object
55800>//
55800>//        End_Object
55800>//
55800>//        Object oFileToolBar is a cCJToolbar
55800>//            Set psTitle to "Data Entry Toolbar"
55800>//
55800>//            Object oClearToolItem is a cCJClearMenuItem
55800>//                Set peControlStyle to xtpButtonIconAndCaption
55800>//            End_Object
55800>//
55800>//            Object oClearAllToolItem2 is a cCJClearAllMenuItem
55800>//                Set peControlStyle to xtpButtonIconAndCaption
55800>//            End_Object
55800>//
55800>//            Object oSaveToolItem is a cCJSaveMenuItem
55800>//                Set peControlStyle to xtpButtonIconAndCaption
55800>//                Set pbControlBeginGroup to True
55800>//            End_Object
55800>//
55800>//            Object oDeleteToolItem is a cCJDeleteMenuItem
55800>//                Set peControlStyle to xtpButtonIconAndCaption
55800>//            End_Object
55800>//
55800>//        End_Object
55800>//
55800>//        Object oEditToolBar is a cCJToolbar
55800>//            Set psTitle to "Edit Toolbar"
55800>//
55800>//            Object oCutToolbarItem is a cCJCutMenuItem
55800>//            End_Object
55800>//
55800>//            Object oCopyToolbarItem is a cCJCopyMenuItem
55800>//            End_Object
55800>//
55800>//            Object oPasteToolbarItem is a cCJPasteMenuItem
55800>//            End_Object
55800>//
55800>//            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
55800>//                Set pbControlBeginGroup to True
55800>//            End_Object
55800>//
55800>//        End_Object
55800>//
55800>//        Object oStatusBar is a cCJStatusBar
55800>//
55800>//            Object oStatusPane1 is a cCJStatusBarPane
55800>//                Set piID to sbpIDIdlePane
55800>//                Set pbStyleStretch to True
55800>//            End_Object
55800>//
55800>//            Object oStatusPane2 is a cCJStatusBarPane
55800>//                Set phoViewPane to Self
55800>//                Set pbStyleStretch to True
55800>//            End_Object
55800>//
55800>//        End_Object
55800>//
55800>    End_Object
55801>
55801>    Object oClientArea is a ClientArea
55803>        Use StdAbout.pkg
Including file: STDABOUT.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\STDABOUT.PKG)
55803>>>//************************************************************************
55803>>>// Confidential Trade Secret.
55803>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
55803>>>// as an unpublished work.  All rights reserved.
55803>>>// DataFlex is a registered trademark of Data Access Corporation.
55803>>>//
55803>>>//************************************************************************
55803>>>//************************************************************************
55803>>>//
55803>>>// $File name  : StdAbout.pkg
55803>>>// $File title : Standard about object package for VDF
55803>>>// Notice      :
55803>>>// $Author(s)  : John Tuohy
55803>>>//
55803>>>// $Rev History
55803>>>//
55803>>>// JT 06/27/97   File created
55803>>>//************************************************************************
55803>>>
55803>>>// This provides a quick and simple way to create an about package for a program.
55803>>>// You need to create a message inside you client area called Activate_About.
55803>>>// Within this message you should send the message DoAbout passing needed
55803>>>// string information.
55803>>>//
55803>>>//       Procedure Activate_About
55803>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
55803>>>//       End_Procedure
55803>>>//    where: sTitle =     Name of application. If none provided, uses caption
55803>>>//                        bar title
55803>>>//           sVersion   = Version Line. If none provided, will be blank
55803>>>//           sCopyRight = Copyright Line. If none provided, will be blank
55803>>>//           sAuthor    = Author name, blank if none provided
55803>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
55803>>>//                        is used.
55803>>>// It is expected that you will place this in your own object package. For
55803>>>// example an order about package may look like this:
55803>>>//
55803>>>//   // OrderAbout.pkg
55803>>>//   Use StdAbout.pkg
55803>>>//   Procedure Activate_About
55803>>>//      Local String sTitle sCopyright sVersion sAuthor
55803>>>//      Move "My Order Entry System" to sTitle
55803>>>//      Move "Version 2.1" to sVersion
55803>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
55803>>>//      Move "John Smith"  to sAuthor
55803>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
55803>>>//   end_procedure
55803>>>//   // end of file.
55803>>>
55803>>>
55803>>>
55803>>>//Use DfAbout.Sub
55803>>>Use DfAbout.pkg
Including file: DFABOUT.PKG    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\DFABOUT.PKG)
55803>>>>>//************************************************************************
55803>>>>>// Confidential Trade Secret.
55803>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
55803>>>>>// as an unpublished work.  All rights reserved.
55803>>>>>// DataFlex is a registered trademark of Data Access Corporation.
55803>>>>>//
55803>>>>>//************************************************************************
55803>>>>>//************************************************************************
55803>>>>>//
55803>>>>>// $File name  : DfAbout.pkg
55803>>>>>// $File title : About class support
55803>>>>>// Notice      :
55803>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
55803>>>>>//
55803>>>>>// $Rev History
55803>>>>>//
55803>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
55803>>>>>// SWB 07/19/01   Added support of the Application object in preference to
55803>>>>>//                the global Workspace object, if it is present
55803>>>>>// JJT 11/05/98   Added version information
55803>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
55803>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
55803>>>>>//                workspace package.
55803>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
55803>>>>>//                class can create this object.
55803>>>>>//                Cleaned up the interface (used correct classes and messages)
55803>>>>>//                Added workspace reporting support to sys-info.
55803>>>>>//                Turned off wrapping in the sys-info editor.
55803>>>>>// KR  ??/??/96   File created
55803>>>>>//************************************************************************
55803>>>>>Use LanguageText.pkg
55803>>>>>Use windows.pkg
55803>>>>>Use DFbitmap.pkg
55803>>>>>Use GlobalFunctionsProcedures.pkg
55803>>>>>
55803>>>>>
55803>>>>>//#IFDEF ghoApplication
55803>>>>>//#ELSE
55803>>>>>//    Global_Variable Integer ghoApplication
55803>>>>>//    Move 0 To ghoApplication
55803>>>>>//#ENDIF
55803>>>>>
55803>>>>>Register_Function phoWorkspace Returns Handle
55803>>>>>Register_Function psHelpFile Returns String
55803>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
55803>>>>>
55803>>>>>//****************************************************************************
55803>>>>>// $Module type: FUNCTION
55803>>>>>// $Module name: Network_User_Name
55803>>>>>// $Author     : AK/VOO/KCR
55803>>>>>// Created     : 24-09-96 @ 19:17
55803>>>>>//
55803>>>>>// Description
55803>>>>>//    This function reads the current username of windows and returns that
55803>>>>>//    name or an text unknown user
55803>>>>>//
55803>>>>>// $Rev History
55803>>>>>//    24-09-96  Module header created
55803>>>>>//****************************************************************************
55803>>>>>//Function Network_User_Name Returns String
55803>>>>>//    String sName sLength
55803>>>>>//    Pointer lpName_Addr lpLength_Addr
55803>>>>>//    Integer iRetval
55803>>>>>//
55803>>>>>//    Movestr (Repeat (Character (0), 255)) To sName
55803>>>>>//    GetAddress Of sName To lpName_Addr
55803>>>>>//    Movestr (DwordToBytes (255)) To sLength
55803>>>>>//    GetAddress Of sLength To lpLength_Addr
55803>>>>>//
55803>>>>>//    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
55803>>>>>//
55803>>>>>//    If iRetval Eq 0 Function_Return (CString (sName))
55803>>>>>//    Else Function_Return " "
55803>>>>>//End_Function // Network_User_Name
55803>>>>>
55803>>>>>Type MEMORYSTATUS
55803>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
55803>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
55803>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
55803>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
55803>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
55803>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
55803>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
55803>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
55803>>>>>End_Type // MEMORYSTATUS
55803>>>>>
55803>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
55804>>>>>
55804>>>>>Class SysinfoDisplay Is An Edit
55805>>>>>    Procedure Construct_Object
55807>>>>>        Forward Send construct_object
55809>>>>>
55809>>>>>        Set Location To 6 6
55810>>>>>        Set Size To 110 255
55811>>>>>        Set Read_Only_State To True
55812>>>>>        Set wrap_state To False
55813>>>>>    End_Procedure
55814>>>>>
55814>>>>>    //****************************************************************************
55814>>>>>    // $Module type: PROCEDURE
55814>>>>>    // $Module name: Add_Line
55814>>>>>    // $Author     : VOO
55814>>>>>    // Created     : 06-10-96 @ 15:23
55814>>>>>    //
55814>>>>>    // Description
55814>>>>>    //    This method will add a line to this edit object, it should go simpler
55814>>>>>    //    but it seems to be done this way.
55814>>>>>    //
55814>>>>>    // $Rev History
55814>>>>>    //    06-10-96  Module header created
55814>>>>>    //****************************************************************************
55814>>>>>    Procedure Add_Line String sVal
55816>>>>>        Integer iLine
55816>>>>>
55816>>>>>        Moveint (Line_Count(Self)) To iLine
55817>>>>>>
55817>>>>>        If (iLine = 1 And Changed_State(Self) = False) Moveint 0 To iLine
55820>>>>>        Set Value Item iLine To sVal
55821>>>>>    End_Procedure // Add_Line
55822>>>>>
55822>>>>>    //****************************************************************************
55822>>>>>    // $Module type: PROCEDURE
55822>>>>>    // $Module name: Show_Current_Directory
55822>>>>>    // $Author     : VOO
55822>>>>>    // Created     : 06-10-96 @ 15:24
55822>>>>>    //
55822>>>>>    // Description
55822>>>>>    //    This method will show the name of the current directory in the system
55822>>>>>    //    information box
55822>>>>>    //
55822>>>>>    // $Rev History
55822>>>>>    //    06-10-96  Module header created
55822>>>>>    //****************************************************************************
55822>>>>>    Procedure Show_Current_Directory
55824>>>>>        String sDir
55824>>>>>
55824>>>>>        Get_Current_Directory To sDir
55825>>>>>        Send Add_Line (SFormat(C_$CurrentDirectory, sDir))
55826>>>>>    End_Procedure // Show_Current_Directory
55827>>>>>
55827>>>>>    Procedure Show_Windows_Directory
55829>>>>>        String sWindir
55829>>>>>
55829>>>>>        Get_Windows_Directory To sWindir
55830>>>>>        Send Add_Line (SFormat(C_$WindowsDirectory, sWindir))
55831>>>>>    End_Procedure // Show_Windows_Directory
55832>>>>>
55832>>>>>    Procedure Show_Current_User
55834>>>>>        //Send Add_Line (SFormat(C_$NetworkUserName, Network_User_Name(Self)))
55834>>>>>    End_Procedure // Show_Current_User
55835>>>>>
55835>>>>>    Procedure Show_Number_Format
55837>>>>>        Integer iFormat
55837>>>>>
55837>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
55840>>>>>        Send Add_Line (SFormat(C_$ThousandsSeparator, Character(iFormat), iFormat))
55841>>>>>        Get_Number_Format To iFormat
55842>>>>>        Send Add_Line (SFormat(C_$DecimalSeparator, If (iFormat = 0, ".", ",")))
55843>>>>>    End_Procedure // Show_Number_Format
55844>>>>>
55844>>>>>    Procedure Show_Filelist_Name
55846>>>>>        String sFilename
55846>>>>>
55846>>>>>        Get_Attribute Df_Filelist_Name To sFilename
55849>>>>>        Send Add_Line (SFormat(C_$CurrentFilelist, sFilename))
55850>>>>>    End_Procedure // Show_Filelist_Name
55851>>>>>
55851>>>>>    Procedure Show_Lock_Delay
55853>>>>>        Integer iLockdelay
55853>>>>>
55853>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
55856>>>>>        Send Add_Line (SFormat(C_$DatabaseLockingDelay, iLockDelay))
55857>>>>>    End_Procedure // Show_Lock_Delay
55858>>>>>
55858>>>>>    Procedure Show_Lock_Timeout
55860>>>>>        Integer iLockTimeout
55860>>>>>
55860>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
55863>>>>>        Send Add_Line (SFormat(C_$DatabaseLockingTimeout, iLockTimeOut))
55864>>>>>    End_Procedure // Show_Lock_Timeout
55865>>>>>
55865>>>>>    Procedure Show_Screen_Size
55867>>>>>        Integer iYscreensize iXscreensize
55867>>>>>
55867>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
55868>>>>>>
55868>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
55869>>>>>>
55869>>>>>
55869>>>>>        Send Add_Line (SFormat(C_$VideoResolution, iXscreensize, iYscreensize))
55870>>>>>    End_Procedure // Show_Screen_Size
55871>>>>>
55871>>>>>    Procedure Show_Page_Size
55873>>>>>        Send Add_Line (SFormat(C_$PageEndFormFeed, Pageend, Pagefeed))
55874>>>>>    End_Procedure
55875>>>>>
55875>>>>>    Procedure Show_Date
55877>>>>>        Date dToday
55877>>>>>
55877>>>>>        Sysdate4 dToday
55878>>>>>        Send Add_Line (SFormat(C_$CurrentSystemDate, String(dToday)))
55879>>>>>    End_Procedure // Show_Date
55880>>>>>
55880>>>>>    Procedure Show_Date_Format
55882>>>>>        Integer iDateFormat
55882>>>>>        String sDateFormat
55882>>>>>
55882>>>>>        Get_Attribute Df_Date_Format To iDateFormat
55885>>>>>        If iDateFormat Eq DF_DATE_USA ;            Movestr C_$USA To sDateFormat
55888>>>>>        Else If iDateformat Eq DF_DATE_EUROPEAN ;            Movestr C_$European To sDateFormat
55892>>>>>        Else If iDateformat Eq DF_DATE_MILITARY ;            Movestr C_$Military To sDateFormat
55896>>>>>        Else ;            Movestr C_$UnknownDateType To sDateFormat
55898>>>>>        Send Add_Line (SFormat(C_$DateFormat, sDateformat))
55899>>>>>    End_Procedure // Show_Date_Format
55900>>>>>
55900>>>>>    Procedure Show_Memavail
55902>>>>>        Integer iMem
55902>>>>>
55902>>>>>        Memory iMem
55903>>>>>>
55903>>>>>        Send Add_Line (SFormat(C_$AvailableMemory, iMem))
55904>>>>>    End_Procedure // Show_Memavail
55905>>>>>
55905>>>>>    Procedure Show_Systemresources
55907>>>>>        String sMemoryStatus
55907>>>>>        Pointer lpsMemoryStatus
55907>>>>>        Integer iVoid
55907>>>>>        Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
55907>>>>>
55907>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
55908>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
55909>>>>>
55909>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
55910>>>>>>
55910>>>>>
55910>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
55911>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
55912>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
55913>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
55914>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
55915>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
55916>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
55917>>>>>
55917>>>>>        Send Add_Line (SFormat(C_$MemoryUtilization, dwMemoryLoad))
55918>>>>>        Send Add_Line (SFormat(C_$AvailablePhysicalMemory, dwAvailPhys / dwTotalPhys * 100.0))
55919>>>>>        Send Add_Line (SFormat(C_$AvailablePagefileSpace, dwAvailPageFile / dwTotalPageFile * 100.0))
55920>>>>>        Send Add_Line (SFormat(C_$AvailableVirtualMemory, dwAvailVirtual / dwTotalVirtual * 100.0))
55921>>>>>    End_Procedure // Show_Systemresources
55922>>>>>
55922>>>>>    Procedure Show_Registration
55924>>>>>        String sRegName
55924>>>>>        Integer iSN
55924>>>>>        Registration sRegName iSN
55925>>>>>>
55925>>>>>
55925>>>>>        Send Add_Line (SFormat(C_$Serial, iSN))
55926>>>>>        Send Add_Line (SFormat(C_$RegName, sRegName))
55927>>>>>
55927>>>>>    End_Procedure // Show_Current_Directory
55928>>>>>
55928>>>>>
55928>>>>>
55928>>>>>    //****************************************************************************
55928>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
55928>>>>>    // to the workspace object passing the an object and message to send back
55928>>>>>    // to this object. It is expected that the workspace object will send this
55928>>>>>    // message for every line of information it wants displayed (passing the
55928>>>>>    // information to be displayed
55928>>>>>    //****************************************************************************
55928>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
55928>>>>>
55928>>>>>    Procedure Show_ServicePack
55930>>>>>        String sVersion
55930>>>>>        Get_Profile_String "" "CurrentVersionDescription" To sVersion
55933>>>>>        If (sVersion <> "") Begin
55935>>>>>           Send Add_Line sVersion
55936>>>>>           Send Add_Line ""
55937>>>>>        End
55937>>>>>>
55937>>>>>    End_Procedure
55938>>>>>
55938>>>>>    Procedure Show_WorkspaceInformation
55940>>>>>        If ghoApplication ;            Send EnumerateWorkspaceData Of (phoWorkspace(ghoApplication)) Self Msg_add_Line
55943>>>>>
55943>>>>>        // removed for VDF8
55943>>>>>        //Else If ghoWorkspace ;
55943>>>>>        //    Send EnumerateWorkspaceData of ghoWorkspace self Msg_add_Line
55943>>>>>    End_Procedure
55944>>>>>
55944>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
55946>>>>>        Function_Return (String(iVer)-"."-String(iRev)-"."-String(iBld))
55947>>>>>    End_Function
55948>>>>>
55948>>>>>    Procedure Show_Versions
55950>>>>>        Integer iVersion iRevision iBuild
55950>>>>>        Version_information iVersion iRevision iBuild
55952>>>>>        Send Add_Line (SFormat(C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
55953>>>>>        Send Add_Line (SFormat(C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
55954>>>>>        Send Add_Line (SFormat(C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
55955>>>>>    End_Procedure
55956>>>>>
55956>>>>>
55956>>>>>    //***
55956>>>>>    //*** BW
55956>>>>>    //*** Procedure: Show_Drivers
55956>>>>>    //*** Purpose  : Show loaed database drivers
55956>>>>>    //***
55956>>>>>
55956>>>>>    Procedure Show_Drivers
55958>>>>>        String  Current_drvr
55958>>>>>        String  Loadeddrvrs
55958>>>>>        Integer Number_of_drvrs
55958>>>>>        Integer Count
55958>>>>>
55958>>>>>        Move "" To Loadeddrvrs
55959>>>>>        Get_Attribute DF_NUMBER_DRIVERS To Number_of_drvrs
55962>>>>>        For Count From 1 To Number_of_drvrs
55968>>>>>>
55968>>>>>            Get_Attribute DF_DRIVER_NAME Of Count To Current_drvr
55971>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
55974>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
55975>>>>>        Loop
55976>>>>>>
55976>>>>>        Send Add_Line (SFormat(C_$DatabaseDriver, Loadeddrvrs))
55977>>>>>    End_Procedure // Show_Drivers
55978>>>>>
55978>>>>>    Procedure Show_HelpFile
55980>>>>>        Send Add_Line ""
55981>>>>>        Send Add_Line (SFormat(C_$HelpFile,  psHelpFile(ghoApplication)))
55982>>>>>    End_Procedure
55983>>>>>
55983>>>>>    Procedure Show_EnterAsTab
55985>>>>>        Send Add_Line (SFormat(C_$EnterKeyNavForward, If(pbEnterKeyAsTabKey(ghoApplication),"True","False")))
55986>>>>>    End_Procedure
55987>>>>>
55987>>>>>    //****************************************************************************
55987>>>>>    // $Module type: PROCEDURE
55987>>>>>    // $Module name: Add_Focus
55987>>>>>    // $Author     : VOO
55987>>>>>    // Created     : 24-09-96 @ 19:43
55987>>>>>    //
55987>>>>>    // Description
55987>>>>>    //    During activation we will remove the old information and add the newly
55987>>>>>    //    found systeminformation
55987>>>>>    //
55987>>>>>    // $Rev History
55987>>>>>    //    24-09-96  Module header created
55987>>>>>    //****************************************************************************
55987>>>>>    Procedure Add_Focus Integer hoRoot
55989>>>>>        Forward Send Add_Focus hoRoot
55991>>>>>
55991>>>>>        Send Delete_Data
55992>>>>>        Set Changed_State To False
55993>>>>>        Set Read_Only_State To True
55994>>>>>        Send Show_ServicePack
55995>>>>>        Send Show_WorkSpaceInformation // added to show WS info
55996>>>>>        If ghoApplication Begin
55998>>>>>            Send Show_HelpFile
55999>>>>>            Send Show_EnterAsTab
56000>>>>>        End
56000>>>>>>
56000>>>>>        Send Show_Drivers
56001>>>>>        Send Show_Current_User
56002>>>>>        Send Show_Windows_Directory
56003>>>>>        Send Show_Current_Directory
56004>>>>>        Send Show_Filelist_Name
56005>>>>>        Send Show_Versions
56006>>>>>        Send Show_Memavail
56007>>>>>        Send Show_Screen_Size
56008>>>>>        Send Show_Page_Size
56009>>>>>        Send Show_Number_Format
56010>>>>>        Send Show_Date_Format
56011>>>>>        Send Show_Lock_Delay
56012>>>>>        Send Show_Lock_Timeout
56013>>>>>        Send Show_Date
56014>>>>>        Send Show_Systemresources
56015>>>>>        //Send Show_Registration
56015>>>>>    End_Procedure // Show_All_Info
56016>>>>>
56016>>>>>End_Class // SysinfoDisplay
56017>>>>>
56017>>>>>
56017>>>>>//****************************************************************************
56017>>>>>// $Module type: OBJECT
56017>>>>>// $Module name: Sysinfo_Dialog
56017>>>>>// $Author     : VOO
56017>>>>>// Created     : 24-09-96 @ 18:47
56017>>>>>//
56017>>>>>// Description
56017>>>>>//    This object shows the systeminformation on the screen
56017>>>>>//
56017>>>>>// $Rev History
56017>>>>>//    24-09-96  Module header created
56017>>>>>//****************************************************************************
56017>>>>>Class SysInfoDialog Is A ModalPanel
56018>>>>>    Procedure Construct_Object
56020>>>>>        Forward Send construct_object
56022>>>>>
56022>>>>>        Set Caption_Bar To True
56023>>>>>        Set Sysmenu_Icon To True
56024>>>>>        Set Label To C_$SystemInformation
56025>>>>>        Set Size To 152 270
56026>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
56027>>>>>        Set Minimize_Icon To False
56028>>>>>        Set Maximize_Icon To False
56029>>>>>        Set Border_Style To Border_Thick
56030>>>>>
56030>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
56032>>>>>        End_Object
56033>>>>>
56033>>>>>        Object Close_Button Is A Button
56035>>>>>            Set Label To C_$Close
56036>>>>>            Set Location To 120 212
56037>>>>>            Set Message Item 0 To msg_Close_Panel
56038>>>>>            Set default_action_button To Self
56039>>>>>        End_Object // Close_Button
56040>>>>>
56040>>>>>        On_Key Kcancel       Send Close_Panel
56041>>>>>    End_Procedure
56042>>>>>
56042>>>>>    //****************************************************************************
56042>>>>>    // $Module type: PROCEDURE
56042>>>>>    // $Module name: OnResize
56042>>>>>    // $Author     : VO
56042>>>>>    // Created     : 05/16/00 @ 3:40
56042>>>>>    //
56042>>>>>    // Description
56042>>>>>    //      When the dialog is resized relocate the edit object and button
56042>>>>>    //
56042>>>>>    // $Rev History
56042>>>>>    //      05/16/00 VO Module header created
56042>>>>>    //****************************************************************************
56042>>>>>    Procedure OnResize
56044>>>>>        Integer iPanelGuiSize
56044>>>>>
56044>>>>>        Get GuiSize To iPanelGuiSize
56045>>>>>        Set GuiSize Of Sysinfo_Display To (Hi (iPanelGuiSize) - 70) (Low (iPanelGuiSize) - 25)
56046>>>>>        Set GuiLocation Of Close_Button To (Hi (iPanelGuiSize) - 50) (Low (iPanelGuiSize) - 90)
56047>>>>>
56047>>>>>        Send Adjust_Logicals
56048>>>>>    End_Procedure // OnResize
56049>>>>>End_Class // SysinfoDialog
56050>>>>>
56050>>>>>// Purpose:
56050>>>>>//
56050>>>>>// Ken Ross 12/17/96 5:16PM
56050>>>>>//
56050>>>>>Class AboutDialog Is A ModalPanel
56051>>>>>
56051>>>>>    Procedure construct_object
56053>>>>>        String sVdfRootDir
56053>>>>>        Forward Send construct_object
56055>>>>>        Set Label To C_$About
56056>>>>>        Set Size To 100 217
56057>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
56058>>>>>
56058>>>>>        Object SysInfo_Dialog Is A SysInfoDialog
56060>>>>>        End_Object
56061>>>>>
56061>>>>>        Object oBox Is A Container3d
56063>>>>>            Set Border_Style To Border_StaticEdge
56064>>>>>            Set Size To 63 202
56065>>>>>            Set Location To 4 5
56066>>>>>
56066>>>>>            Object oAboutGraphic Is A BitmapContainer
56068>>>>>                Set Border_Style To Border_None
56069>>>>>                Set Bitmap_Style To Bitmap_Center
56070>>>>>                Set Size To 48 48
56071>>>>>                Set Location To 7 2
56072>>>>>            End_Object    // AboutGraphic
56073>>>>>
56073>>>>>            Object oProductName Is A TextBox
56075>>>>>                Set label To C_$ProductName
56076>>>>>                Set Size To 10 45
56077>>>>>                Set Location To 8 53
56078>>>>>            End_Object    // ProductName
56079>>>>>
56079>>>>>            Object oVersion Is A TextBox
56081>>>>>                Set label To C_$Version
56082>>>>>                Set Size To 10 25
56083>>>>>                Set Location To 21 53
56084>>>>>            End_Object    // Version
56085>>>>>
56085>>>>>            Object oCopyright Is A TextBox
56087>>>>>                Set label To C_$Copyright
56088>>>>>                Set Size To 10 31
56089>>>>>                Set Location To 34 53
56090>>>>>            End_Object    // Copyright
56091>>>>>
56091>>>>>            Object oAuthor Is A TextBox
56093>>>>>                Set label To C_$Author
56094>>>>>                Set Size To 10 22
56095>>>>>                Set Location To 46 53
56096>>>>>            End_Object    // Author
56097>>>>>
56097>>>>>        End_Object    // oBox
56098>>>>>
56098>>>>>        Object OK_bn Is A Button
56100>>>>>            On_Item C_$OK Send Close_Panel
56101>>>>>            Set Size To 14 50
56102>>>>>            Set Location To 71 157
56103>>>>>        End_Object    // OK_bn
56104>>>>>
56104>>>>>        Object SysInfo_bn Is A Button
56106>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
56107>>>>>            Set Size To 14 50
56108>>>>>            Set Location To 71 101
56109>>>>>        End_Object    // SysInfo_bn
56110>>>>>
56110>>>>>        On_Key Kcancel Send KeyAction Of Ok_bn
56111>>>>>
56111>>>>>//        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
56111>>>>>//        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
56111>>>>>        Set logo To "DacAbout.bmp"  // square bitmaps of 42x42 work best
56112>>>>>
56112>>>>>    End_Procedure
56113>>>>>
56113>>>>>    Procedure Set ProductName String sProductName
56115>>>>>        Set label Of oProductName To sProductName
56116>>>>>    End_Procedure
56117>>>>>
56117>>>>>    Procedure Set Version String sVersion
56119>>>>>        Set label Of oVersion To sVersion
56120>>>>>    End_Procedure
56121>>>>>
56121>>>>>    Procedure Set Copyright String sCopyright
56123>>>>>        Set label Of oCopyright To sCopyright
56124>>>>>    End_Procedure
56125>>>>>
56125>>>>>    Procedure Set Author String sAuthor
56127>>>>>        Set Label Of oAuthor To sAuthor
56128>>>>>    End_Procedure
56129>>>>>
56129>>>>>    Procedure Set Logo String sLogo
56131>>>>>        // square bitmaps of 42x42 work best
56131>>>>>        Set Bitmap Of oAboutGraphic To sLogo
56132>>>>>    End_Procedure
56133>>>>>
56133>>>>>    Procedure Show_Sysinfo
56135>>>>>        Send Popup_Modal Of Sysinfo_Dialog
56136>>>>>    End_Procedure // Show_Sysinfo
56137>>>>>
56137>>>>>    Procedure End_Construct_Object
56139>>>>>        Handle hoVersionInfo
56139>>>>>        Boolean bIncluded
56139>>>>>        Integer iMajor iMinor iRelease iBuild
56139>>>>>
56139>>>>>        If (Label(oVersion) = C_$VERSION) Begin
56141>>>>>            // set it to the version info of the program, if available
56141>>>>>            If (ghoApplication) Begin
56143>>>>>                Get phoVersionInfo Of ghoApplication To hoVersionInfo
56144>>>>>                Get pbIncluded Of hoVersionInfo To bIncluded
56145>>>>>                If bIncluded Begin
56147>>>>>                    Get piVersionMajor   Of hoVersionInfo To iMajor
56148>>>>>                    Get piVersionMinor   Of hoVersionInfo To iMinor
56149>>>>>                    Get piVersionRelease Of hoVersionInfo To iRelease
56150>>>>>                    Get piVersionBuild   Of hoVersionInfo To iBuild
56151>>>>>
56151>>>>>                    Set Version To (SFormat(C_$VERSION +": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild))
56152>>>>>                End
56152>>>>>>
56152>>>>>            End
56152>>>>>>
56152>>>>>        End
56152>>>>>>
56152>>>>>        Forward Send End_Construct_Object
56154>>>>>    End_Procedure
56155>>>>>
56155>>>>>End_Class
56156>>>>>
56156>>>>>
56156>>>>>//Object About_Dialog is an AboutDialog
56156>>>>>//    set productname to "Visual DataFlex"
56156>>>>>//    set version to "version 4.0"
56156>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
56156>>>>>//    set author to ""
56156>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
56156>>>>>//End_Object
56156>>>>>
56156>>>>>//Procedure Activate_About
56156>>>>>//   Send Popup_Modal of About_Dialog
56156>>>>>//End_Procedure
56156>>>
56156>>>
56156>>>
56156>>>
56156>>>// *************************************************************************
56156>>>//  Public message. This is the default message. It is expected that you will
56156>>>//   create your own message to override this
56156>>>// *************************************************************************
56156>>>
56156>>>Procedure Activate_About
56159>>>   Send DoAbout "" "" "" "" ""
56160>>>End_Procedure
56161>>>
56161>>>// *************************************************************************
56161>>>//  Public message. It is expected that you will send this message (most
56161>>>//  likely from Activate_About. This creates an about object, activates it
56161>>>//  and destroys it when done. It is not exepected that you will augment this.
56161>>>// *************************************************************************
56161>>>
56161>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
56164>>>        Local Integer hoObj hoMain
56164>>>
56164>>>        // create object
56164>>>        Object About Is An AboutDialog
56166>>>            // if no title passed use the label of the main panel
56166>>>            // (if a main panel exists).
56166>>>            If sTitle     Eq '' Begin
56168>>>                Get Main_Window To hoMain
56169>>>                If hoMain Get Label Of hoMain To sTitle
56172>>>            End
56172>>>>
56172>>>            Set productname To sTitle
56173>>>            Set version     To sVersion
56174>>>            Set copyright   To sCopyRight
56175>>>            Set author      To sAuthor
56176>>>            If sBitmap    Ne '' ;               Set logo To sBitMap // square bitmaps of 42x42 work best
56179>>>            Move Current_Object To hoObj // object Id
56180>>>        End_Object
56181>>>        Send Popup To hoObj    // popup the about object
56182>>>        Send Request_Destroy_Object To hoObj // when done, it will be destroyed
56183>>>End_Procedure
56184>
56184>        Procedure Activate_About
56187>            Send DoAbout "" "" "" "" ""
56188>        End_Procedure
56189>
56189>        //------
56189>        Use Utf_View.vw
Including file: Utf_View.vw    (L:\VDF14.1.Dev\TitanUTF\AppSrc\Utf_View.vw)
56189>>>//AB/ Project Data Entry View
56189>>>//AB/ Object prj is a View_Project
56189>>>//AB/     Set Size to 230 325
56189>>>
56189>>>//Open SYSCURXR
56189>>>//Open COMPANY
56189>>>
56189>>>Use File_dlg.pkg
56189>>>Use cComDPDLG.pkg
Including file: cComDPDlg.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\cComDPDlg.pkg)
56189>>>>>// Visual DataFlex COM proxy classes generated from C:\WINNT\system32\DPDlg.ocx
56189>>>>>Use FlexCom20.pkg
56189>>>>>
56189>>>>>
56189>>>>>Define OLEROOTSHORT for Integer
56189>>>>>    // Desktop
56189>>>>>    Define OLEdpdDesktop for 0
56189>>>>>    // Control Panel
56189>>>>>    Define OLEdpdControlPanel for 1
56189>>>>>    // Desktop Directory
56189>>>>>    Define OLEdpdDesktopDir for 2
56189>>>>>    // My Computer
56189>>>>>    Define OLEdpdMyComputer for 3
56189>>>>>    // Font Directory
56189>>>>>    Define OLEdpdFontDir for 4
56189>>>>>    // Network Neighborhood
56189>>>>>    Define OLEdpdNetwork for 5
56189>>>>>    // Printers
56189>>>>>    Define OLEdpdPrinters for 6
56189>>>>>    // Programs
56189>>>>>    Define OLEdpdPrograms for 7
56189>>>>>    // Recent
56189>>>>>    Define OLEdpdRecent for 8
56189>>>>>    // Recycle Bin
56189>>>>>    Define OLEdpdRecycleBin for 9
56189>>>>>    // Send To
56189>>>>>    Define OLEdpdSendTo for 10
56189>>>>>    // Start Menu
56189>>>>>    Define OLEdpdStartMenu for 11
56189>>>>>    // Start Up
56189>>>>>    Define OLEdpdStartUp for 12
56189>>>>>    // Templates
56189>>>>>    Define OLEdpdTemplates for 13
56189>>>>>    // Custom Root
56189>>>>>    Define OLEdpdCustom for 14
56189>>>>>
56189>>>>>// CLSID: {BE5AB244-F888-11D0-9F5E-B42103C10710}
56189>>>>>// Dispatch interface for DPDlg Control
56189>>>>>Class cCom_DDPDlg is a Mixin
56190>>>>>
56190>>>>>    Function ComBrowseForComputer Returns Boolean
56192>>>>>        Boolean retVal
56192>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
56193>>>>>        Function_Return retVal
56194>>>>>    End_Function
56195>>>>>
56195>>>>>    Procedure Set ComBrowseForComputer Boolean value
56197>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
56198>>>>>    End_Procedure
56199>>>>>
56199>>>>>    Function ComBrowseForPrinter Returns Boolean
56201>>>>>        Boolean retVal
56201>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
56202>>>>>        Function_Return retVal
56203>>>>>    End_Function
56204>>>>>
56204>>>>>    Procedure Set ComBrowseForPrinter Boolean value
56206>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
56207>>>>>    End_Procedure
56208>>>>>
56208>>>>>    Function ComDontGoBelowDomain Returns Boolean
56210>>>>>        Boolean retVal
56210>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
56211>>>>>        Function_Return retVal
56212>>>>>    End_Function
56213>>>>>
56213>>>>>    Procedure Set ComDontGoBelowDomain Boolean value
56215>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
56216>>>>>    End_Procedure
56217>>>>>
56217>>>>>    Function ComReturnFSAncestors Returns Boolean
56219>>>>>        Boolean retVal
56219>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
56220>>>>>        Function_Return retVal
56221>>>>>    End_Function
56222>>>>>
56222>>>>>    Procedure Set ComReturnFSAncestors Boolean value
56224>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
56225>>>>>    End_Procedure
56226>>>>>
56226>>>>>    Function ComReturnOnlyFSDirs Returns Boolean
56228>>>>>        Boolean retVal
56228>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
56229>>>>>        Function_Return retVal
56230>>>>>    End_Function
56231>>>>>
56231>>>>>    Procedure Set ComReturnOnlyFSDirs Boolean value
56233>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
56234>>>>>    End_Procedure
56235>>>>>
56235>>>>>    Function ComRoot Returns OLEROOTSHORT
56237>>>>>        OLEROOTSHORT retVal
56237>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
56238>>>>>        Function_Return retVal
56239>>>>>    End_Function
56240>>>>>
56240>>>>>    Procedure Set ComRoot OLEROOTSHORT value
56242>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
56243>>>>>    End_Procedure
56244>>>>>
56244>>>>>    Function ComHWnd Returns OLE_HANDLE
56246>>>>>        OLE_HANDLE retVal
56246>>>>>        Get ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to retVal
56247>>>>>        Function_Return retVal
56248>>>>>    End_Function
56249>>>>>
56249>>>>>    Procedure Set ComHWnd OLE_HANDLE value
56251>>>>>        Set ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to value
56252>>>>>    End_Procedure
56253>>>>>
56253>>>>>    Function ComIcon Returns Variant
56255>>>>>        Variant retVal
56255>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_DISPATCH to retVal
56256>>>>>        Function_Return retVal
56257>>>>>    End_Function
56258>>>>>
56258>>>>>    Procedure Set ComIcon Variant value
56260>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_DISPATCH to value
56261>>>>>    End_Procedure
56262>>>>>
56262>>>>>    Function ComFolder Returns String
56264>>>>>        String retVal
56264>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
56265>>>>>        Function_Return retVal
56266>>>>>    End_Function
56267>>>>>
56267>>>>>    Procedure Set ComFolder String value
56269>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
56270>>>>>    End_Procedure
56271>>>>>
56271>>>>>    Function ComCaption Returns String
56273>>>>>        String retVal
56273>>>>>        Get ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to retVal
56274>>>>>        Function_Return retVal
56275>>>>>    End_Function
56276>>>>>
56276>>>>>    Procedure Set ComCaption String value
56278>>>>>        Set ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to value
56279>>>>>    End_Procedure
56280>>>>>
56280>>>>>    Function Com_Caption Returns String
56282>>>>>        String retVal
56282>>>>>        Get ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BSTR to retVal
56283>>>>>        Function_Return retVal
56284>>>>>    End_Function
56285>>>>>
56285>>>>>    Procedure Set Com_Caption String value
56287>>>>>        Set ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BSTR to value
56288>>>>>    End_Procedure
56289>>>>>
56289>>>>>    Function ComPath Returns String
56291>>>>>        String retVal
56291>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
56292>>>>>        Function_Return retVal
56293>>>>>    End_Function
56294>>>>>
56294>>>>>    Procedure Set ComPath String value
56296>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
56297>>>>>    End_Procedure
56298>>>>>
56298>>>>>    Function ComCustomRoot Returns String
56300>>>>>        String retVal
56300>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
56301>>>>>        Function_Return retVal
56302>>>>>    End_Function
56303>>>>>
56303>>>>>    Procedure Set ComCustomRoot String value
56305>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
56306>>>>>    End_Procedure
56307>>>>>
56307>>>>>    Function ComShow Returns Boolean
56309>>>>>        Handle hDispatchDriver
56309>>>>>        Boolean retVal
56309>>>>>        Get phDispatchDriver to hDispatchDriver
56310>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_BOOL to retVal
56311>>>>>        Function_Return retVal
56312>>>>>    End_Function
56313>>>>>
56313>>>>>    Procedure ComAboutBox
56315>>>>>        Handle hDispatchDriver
56315>>>>>        Get phDispatchDriver to hDispatchDriver
56316>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
56317>>>>>    End_Procedure
56318>>>>>End_Class
56319>>>>>
56319>>>>>// CLSID: {BE5AB245-F888-11D0-9F5E-B42103C10710}
56319>>>>>// Event interface for DPDlg Control
56319>>>>>Class cCom_DDPDlgEvents is a Mixin
56320>>>>>
56320>>>>>    Procedure OnComFolderSelected String llPath Boolean ByRef llAllow
56322>>>>>    End_Procedure
56323>>>>>
56323>>>>>    Procedure RegisterComEvents
56325>>>>>        Send RegisterComEvent 1 msg_OnComFolderSelected
56326>>>>>    End_Procedure
56327>>>>>End_Class
56328>>>>>
56328>>>>>// CoClass
56328>>>>>// ProgID: DPDLG.DPDlgCtrl.1
56328>>>>>// CLSID: {BE5AB246-F888-11D0-9F5E-B42103C10710}
56328>>>>>// DPDlg Control
56328>>>>>Class cComDPDlg is a cComActiveXControl
56329>>>>>    Import_Class_Protocol cCom_DDPDlg
56330>>>>>    Import_Class_Protocol cCom_DDPDlgEvents
56331>>>>>
56331>>>>>    Procedure Construct_Object
56333>>>>>        Forward Send Construct_Object
56335>>>>>        Set psProgID to "{BE5AB246-F888-11D0-9F5E-B42103C10710}"
56336>>>>>        Set psEventId to "{BE5AB245-F888-11D0-9F5E-B42103C10710}"
56337>>>>>        Set peAutoCreate to acAutoCreate
56338>>>>>    End_Procedure
56339>>>>>End_Class
56340>>>Use cComXFIND.pkg
Including file: cComXfind.pkg    (C:\VDF14.1.SUB\SUBCLASSES\AppSrc\cComXfind.pkg)
56340>>>>>// Visual DataFlex COM proxy classes generated from C:\WINNT\system32\xfind10DEMO.ocx
56340>>>>>Use FlexCom20.pkg
56340>>>>>
56340>>>>>
56340>>>>>// CLSID: {DF5A0221-37A0-11D4-881C-E7F891A83074}
56340>>>>>// Dispatch interface for xfind Control
56340>>>>>Class cComIxfind is a Mixin
56341>>>>>
56341>>>>>    Procedure ComAboutBox
56343>>>>>        Handle hDispatchDriver
56343>>>>>        Get phDispatchDriver to hDispatchDriver
56344>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
56345>>>>>    End_Procedure
56346>>>>>
56346>>>>>    Function ComSearchString Returns String
56348>>>>>        Handle hDispatchDriver
56348>>>>>        String retVal
56348>>>>>        Get phDispatchDriver to hDispatchDriver
56349>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_BSTR to retVal
56350>>>>>        Function_Return retVal
56351>>>>>    End_Function
56352>>>>>
56352>>>>>    Procedure Set ComSearchString String value
56354>>>>>        Handle hDispatchDriver
56354>>>>>        Get phDispatchDriver to hDispatchDriver
56355>>>>>        Send PrepareParams to hDispatchDriver 1
56356>>>>>        Set ComProperty of hDispatchDriver 6 OLE_VT_BSTR to value
56357>>>>>    End_Procedure
56358>>>>>
56358>>>>>    Function ComSearchFrom Returns String
56360>>>>>        Handle hDispatchDriver
56360>>>>>        String retVal
56360>>>>>        Get phDispatchDriver to hDispatchDriver
56361>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_BSTR to retVal
56362>>>>>        Function_Return retVal
56363>>>>>    End_Function
56364>>>>>
56364>>>>>    Procedure Set ComSearchFrom String value
56366>>>>>        Handle hDispatchDriver
56366>>>>>        Get phDispatchDriver to hDispatchDriver
56367>>>>>        Send PrepareParams to hDispatchDriver 1
56368>>>>>        Set ComProperty of hDispatchDriver 7 OLE_VT_BSTR to value
56369>>>>>    End_Procedure
56370>>>>>
56370>>>>>    Function ComSearchSubDirs Returns Boolean
56372>>>>>        Handle hDispatchDriver
56372>>>>>        Boolean retVal
56372>>>>>        Get phDispatchDriver to hDispatchDriver
56373>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_BOOL to retVal
56374>>>>>        Function_Return retVal
56375>>>>>    End_Function
56376>>>>>
56376>>>>>    Procedure Set ComSearchSubDirs Boolean value
56378>>>>>        Handle hDispatchDriver
56378>>>>>        Get phDispatchDriver to hDispatchDriver
56379>>>>>        Send PrepareParams to hDispatchDriver 1
56380>>>>>        Set ComProperty of hDispatchDriver 8 OLE_VT_BOOL to value
56381>>>>>    End_Procedure
56382>>>>>
56382>>>>>    Procedure ComStartSearching
56384>>>>>        Handle hDispatchDriver
56384>>>>>        Get phDispatchDriver to hDispatchDriver
56385>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
56386>>>>>    End_Procedure
56387>>>>>
56387>>>>>    Function ComIsSearching Returns Boolean
56389>>>>>        Handle hDispatchDriver
56389>>>>>        Boolean retVal
56389>>>>>        Get phDispatchDriver to hDispatchDriver
56390>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_BOOL to retVal
56391>>>>>        Function_Return retVal
56392>>>>>    End_Function
56393>>>>>
56393>>>>>    Procedure ComAbortSearch
56395>>>>>        Handle hDispatchDriver
56395>>>>>        Get phDispatchDriver to hDispatchDriver
56396>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
56397>>>>>    End_Procedure
56398>>>>>
56398>>>>>    Function ComFileName Returns String
56400>>>>>        Handle hDispatchDriver
56400>>>>>        String retVal
56400>>>>>        Get phDispatchDriver to hDispatchDriver
56401>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BSTR to retVal
56402>>>>>        Function_Return retVal
56403>>>>>    End_Function
56404>>>>>
56404>>>>>    Function ComFileSize Returns Integer
56406>>>>>        Handle hDispatchDriver
56406>>>>>        Integer retVal
56406>>>>>        Get phDispatchDriver to hDispatchDriver
56407>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
56408>>>>>        Function_Return retVal
56409>>>>>    End_Function
56410>>>>>End_Class
56411>>>>>
56411>>>>>// CLSID: {DF5A0223-37A0-11D4-881C-E7F891A83074}
56411>>>>>// Events interface for xfind Control
56411>>>>>Class cComIxfindEvents is a Mixin
56412>>>>>
56412>>>>>    Procedure OnComFinishedSearch
56414>>>>>    End_Procedure
56415>>>>>
56415>>>>>    Procedure OnComFoundFile
56417>>>>>    End_Procedure
56418>>>>>
56418>>>>>    Procedure RegisterComEvents
56420>>>>>        Send RegisterComEvent 4 msg_OnComFinishedSearch
56421>>>>>        Send RegisterComEvent 8 msg_OnComFoundFile
56422>>>>>    End_Procedure
56423>>>>>End_Class
56424>>>>>
56424>>>>>// CoClass
56424>>>>>// ProgID: xfind10.xfind
56424>>>>>// CLSID: {DF5A0225-37A0-11D4-881C-E7F891A83074}
56424>>>>>// xfind Control
56424>>>>>Class cComXfind is a cComActiveXControl
56425>>>>>    Import_Class_Protocol cComIxfind
56426>>>>>    Import_Class_Protocol cComIxfindEvents
56427>>>>>
56427>>>>>    Procedure Construct_Object
56429>>>>>        Forward Send Construct_Object
56431>>>>>        Set psProgID to "{DF5A0225-37A0-11D4-881C-E7F891A83074}"
56432>>>>>        Set psEventId to "{DF5A0223-37A0-11D4-881C-E7F891A83074}"
56433>>>>>        Set peAutoCreate to acAutoCreate
56434>>>>>    End_Procedure
56435>>>>>End_Class
56436>>>
56436>>>Activate_View Activate_Utf_View for Utf_View
56446>>>>
56446>>>
56446>>>Object Utf_View is a dbView
56448>>>
56448>>>    Set Border_Style to Border_Thick
56449>>>    Set Size to 121 508
56450>>>    Set Location     to 9 9
56451>>>
56451>>>    Property Integer piChoice public 0
56453>>>
56453>>>    Procedure Activate_View Returns Integer
56456>>>        Integer rVal
56456>>>        String  sFolderInitial
56456>>>        Set Label to "  UTF-8 (v4.8.4 - 02/12/2013)" 
56457>>>//        Get Value of FormSub10 item 0 to sFolderInitial
56457>>>//        If (Trim(sFolderInitial)="") Begin
56457>>>//            Clear Company
56457>>>//            Move SyscurXR.Company_Code to Company.Company_Code
56457>>>//            Find Eq Company by Index.1
56457>>>//            Set Value of FormSub10 item 0 to (Trim(Company.Sap_Path))
56457>>>//        End
56457>>>
56457>>>        If (gviSkipHmniaCheck=1) Begin
56459>>>             Set Current_Radio of oDbradiogroupSub1 to 1
56460>>>             Set Value of frmFileName item 0 to (Uppercase(Trim(gvsSapPath)))
56461>>>        End
56461>>>>
56461>>>        Else Begin
56462>>>            Set Current_Radio of oDbradiogroupSub1 to 0
56463>>>        End
56463>>>>
56463>>>
56463>>>        Set Value of FormSub10 item 0 to (Uppercase(Trim(gvsSapPath)))
56464>>>        
56464>>>        Forward Get Msg_Activate_View to rVal
56466>>>
56466>>>        If (gviSkipHmniaCheck=1) Begin
56468>>>            Send Onclick of btnSub1
56469>>>        End
56469>>>>
56469>>>
56469>>>        Procedure_Return rVal
56470>>>    End_Procedure
56471>>>
56471>>>    Function fsReturnFileFromPath String asFullPath Returns String
ERROR: 4390 Illegal method name definition GET FSRETURNFILEFROMPATH ALREADY DEFINED AS A GLOBAL METHOD ON LINE: 53 (56471) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Utf_View.vw
56474>>>        String rVal lsDirSep
56474>>>        Integer iPos iMet iLen iCnt
56474>>>        Move (Trim(asFullPath))                 to rVal
56475>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR))   to lsDirSep
56476>>>        If (rVal contains lsDirSep) Begin
56478>>>            Move (Length(rVal)) to iLen
56479>>>            Move iLen to iCnt
56480>>>            While iCnt Gt 0
56484>>>                If (Mid(rVal,1,iCnt)=lsDirSep) Begin
56486>>>                    If (iCnt=iLen) Function_Return asFullPath
56489>>>                    Else Function_Return (Right(rVal,(iLen-iCnt)))
56491>>>                End
56491>>>>
56491>>>                Decrement iCnt
56492>>>            End // While iCnt Gt 0
56493>>>>
56493>>>        End
56493>>>>
56493>>>        Else  Function_Return (Trim(asFullPath))
56495>>>        Function_Return rVal
56496>>>    End_Function
56497>>>
56497>>>
56497>>>    Function fsReadRegistryUTFfolder Returns String
56500>>>        String rVal lsCurrentWksp
56500>>>        Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
56503>>>        If (lsCurrentWksp="") Get psWorkspaceName of (phoWorkspace(ghoApplication)) to lsCurrentWksp
56506>>>        Insert "WorkSpaces\" in lsCurrentWksp At 1
56508>>>        Append lsCurrentWksp "\UTF"
56509>>>        Get_Profile_String lsCurrentWksp "ContainingFolder"  to rVal
56512>>>        Function_Return (Trim(rVal))
56513>>>    End_Function
56514>>>    
56514>>>    Function fsWriteRegistryUTFfolder String asPathToWrite Returns Integer
56517>>>        Integer rVal
56517>>>        String  lsCurrentWksp
56517>>>        Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
56520>>>        If (lsCurrentWksp="") Get psWorkspaceName of (phoWorkspace(ghoApplication)) to lsCurrentWksp
56523>>>        Insert "WorkSpaces\" in lsCurrentWksp At 1
56525>>>        Append lsCurrentWksp "\UTF"
56526>>>        Set_Profile_String lsCurrentWksp "ContainingFolder"  to (Trim(asPathToWrite))
56529>>>        Function_Return rVal
56530>>>    End_Function
56531>>>
56531>>>    Function fsReturnDirectoriesFromPath String asFullPath Returns String
56534>>>        String rVal lsDirSep
56534>>>        Integer iPos iMet iLen iCnt
56534>>>        Move (Trim(asFullPath))                 to rVal
56535>>>        Move (SysConf(SYSCOnF_DIR_SEPARATOR))   to lsDirSep
56536>>>        If (rVal contains lsDirSep) Begin
56538>>>            Move (Length(rVal)) to iLen
56539>>>            Move iLen to iCnt
56540>>>            While iCnt gt 0
56544>>>                If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
56547>>>                Decrement iCnt
56548>>>            End // While iCnt Gt 0
56549>>>>
56549>>>        End
56549>>>>
56549>>>        Function_Return rVal
56550>>>    End_Function
56551>>>
56551>>>
56551>>>    Use chartranslate.pkg
Including file: CharTranslate.pkg    (C:\Program Files\Visual DataFlex 14.1\Pkg\CharTranslate.pkg)
56551>>>>>//*************************************************************************
56551>>>>>//*
56551>>>>>//*  Copyright (c) 2001 Data Access Corporation, Miami Florida,
56551>>>>>//*  All rights reserved.
56551>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.
56551>>>>>//*
56551>>>>>//*************************************************************************
56551>>>>>//*
56551>>>>>//*  Module Name:
56551>>>>>//*      CharTranslate.pkg
56551>>>>>//*
56551>>>>>//*  Creator:
56551>>>>>//*      SF
56551>>>>>//*
56551>>>>>//*
56551>>>>>//*  Purpose:
56551>>>>>//*      Various global functions to translate OEM to UTF.
56551>>>>>//*
56551>>>>>//*************************************************************************
56551>>>>>
56551>>>>>Use Windows.pkg
56551>>>>>
56551>>>>>
56551>>>>>External_Function32 MultiByteToWideChar "MultiByteToWideChar" kernel32.dll;    DWORD dwCodePage;    DWORD dwFlags;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pWideStr;    Integer cchWideChar;    Returns Integer
56552>>>>>
56552>>>>>External_Function32 WideCharToMultiByte "WideCharToMultiByte" kernel32.dll;    DWORD dwCodePage;    DWORD dwFlags;    Pointer pWideStr;    Integer cchWideChar;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pDefaultChar;    Pointer pUsedDefaultChar;    Returns Integer
56553>>>>>
56553>>>>>//dwCodePage = Multi Byte Code Page to convert from
56553>>>>>//pMultiBuf  = Pointer to Multi Byte string
56553>>>>>//iLen       = Length in bytes of Multi Byte string
56553>>>>>//ppWideBuf  = Contents of ppWideBuf contains a pointer to the destination buffer on return
56553>>>>>Function MultiToWideBuffer Global DWORD dwCodePage Address pMultiBuf Integer iLen Address ppWideBuf Returns Integer
56555>>>>>    Integer iWideSize
56555>>>>>    Integer iVoid
56555>>>>>    Address pWideBuf
56555>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,0,0)) to iWideSize
56556>>>>>    If (iWideSize=0);        Function_Return 0
56559>>>>>    Move (Alloc((iWideSize+1)*2)) to pWideBuf
56560>>>>>    If (pWideBuf=0);        Function_Return 0
56563>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,pWideBuf,iWideSize)) to iWideSize
56564>>>>>    If (iWideSize=0) ;        Move (Free(pWideBuf)) to iVoid
56567>>>>>    else begin
56568>>>>>        Move (StoreW(pWideBuf,(iWideSize*2),0)) to iVoid
56569>>>>>        Move (StoreDW(ppWideBuf,0,pWideBuf)) to iVoid
56570>>>>>    end
56570>>>>>>
56570>>>>>    Function_Return iWideSize
56571>>>>>End_Function
56572>>>>>
56572>>>>>//dwCodePage = Multi Byte Code Page to convert to
56572>>>>>//pWideBuf   = Pointer to Wide Character string
56572>>>>>//iLen       = Length in characters of Wide Character string
56572>>>>>//ppMultiBuf = Contents of ppMultiBuf contains a pointer to the destination buffer on return
56572>>>>>Function WideToMultiBuffer Global DWORD dwCodePage Address pWideBuf Integer iLen Address ppMultiBuf Returns Integer
56574>>>>>    Integer iMultiSize
56574>>>>>    Address pMultiBuf
56574>>>>>    Integer iVoid
56574>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,0,0,0,0)) to iMultiSize
56575>>>>>    If (iMultiSize=0);        Function_Return 0
56578>>>>>    Move (Alloc(iMultiSize+1)) to pMultiBuf
56579>>>>>    If (pMultiBuf=0);        Function_Return 0
56582>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,pMultiBuf,iMultiSize,0,0)) to iMultiSize
56583>>>>>    If (iMultiSize=0) ;        Move (Free(pMultiBuf)) to iVoid
56586>>>>>    else begin
56587>>>>>        Move (StoreC(pMultiBuf,iMultiSize,0)) to iVoid
56588>>>>>        Move (StoreDW(ppMultiBuf,0,pMultiBuf)) to iVoid
56589>>>>>    end
56589>>>>>>
56589>>>>>    Function_Return iMultiSize
56590>>>>>End_Function
56591>>>>>
56591>>>>>//Converts a UTF-8 string to OEM
56591>>>>>//pUtf8Buf   = Pointer to UTF-8 string
56591>>>>>//iLen       = Length of UTF-8 string in bytes
56591>>>>>//Returns pointer to OEM string, use free() to deallocate buffer when it's no longer needed
56591>>>>>Function Utf8ToOemBuffer Global Address pUtf8Buf Integer iLen Returns Address
56593>>>>>    Address pWideBuf
56593>>>>>    Address pOemBuf
56593>>>>>    Integer iWideBufLen
56593>>>>>    Integer iMultiBufLen
56593>>>>>    Integer iVoid
56593>>>>>    Move 0 to pWideBuf
56594>>>>>    Move 0 to pOemBuf
56595>>>>>    Move (MultiToWideBuffer(CP_UTF8,pUtf8Buf,iLen,AddressOf(pWideBuf))) to iWideBufLen
56596>>>>>    If (iWideBufLen=0);        Function_Return 0
56599>>>>>    Move (WideToMultiBuffer(CP_OEMCP,pWideBuf,iWideBufLen,AddressOf(pOemBuf))) to iMultiBufLen
56600>>>>>    Move (Free(pWideBuf)) to iVoid
56601>>>>>    Function_Return pOemBuf
56602>>>>>End_Function
56603>>>>>
56603>>>>>//Converts a OEM string to UTF-8
56603>>>>>//pOemBuf    = Pointer to OEM string
56603>>>>>//iLen       = Length of OEM string in bytes
56603>>>>>//Returns pointer to UTF-8 string, use free() to deallocate buffer when it's no longer needed
56603>>>>>Function OemToUtf8Buffer Global Address pOemBuf Integer iLen Returns Address
56605>>>>>    Address pWideBuf
56605>>>>>    Address pUtf8Buf
56605>>>>>    Integer iWideBufLen
56605>>>>>    Integer iMultiBufLen
56605>>>>>    Integer iVoid
56605>>>>>    Move 0 to pWideBuf
56606>>>>>    Move 0 to pUtf8Buf
56607>>>>>    Move (MultiToWideBuffer(CP_OEMCP,pOemBuf,iLen,AddressOf(pWideBuf))) to iWideBufLen
56608>>>>>    If (iWideBufLen=0);        Function_Return 0
56611>>>>>    Move (WideToMultiBuffer(CP_UTF8,pWideBuf,iWideBufLen,AddressOf(pUtf8Buf))) to iMultiBufLen
56612>>>>>    Move (Free(pWideBuf)) to iVoid
56613>>>>>    Function_Return pUtf8Buf
56614>>>>>End_Function
56615>>>
56615>>>    Function Utf8ToOemString Global String sUtf8String Returns String
56617>>>        Address aString
56617>>>        String sOemString
56617>>>        Boolean bVoid
56617>>>        //Move (Utf8ToOemBuffer(sUtf8String, CStringLength(sUtf8String))) to aString
56617>>>        Move (Utf8ToOemBuffer(AddressOf(sUtf8String), CStringLength(sUtf8String))) to aString
56618>>>        Move aString to sOemString
56619>>>        Move (Free(aString)) to bVoid
56620>>>        Function_Return sOemString
56621>>>    End_Function
56622>>>    
56622>>>    Function OemToUtf8String Global String sUtf8String Returns String
56624>>>        Address aString
56624>>>        String sOemString
56624>>>        Boolean bVoid
56624>>>        //Move (OemToUtf8Buffer(sUtf8String, CStringLength(sUtf8String))) to aString
56624>>>        Move (OemToUtf8Buffer(AddressOf(sUtf8String), CStringLength(sUtf8String))) to aString
56625>>>        Move aString to sOemString
56626>>>        Move (Free(aString)) to bVoid
56627>>>        Function_Return sOemString
56628>>>    End_Function
56629>>>
56629>>>    Object FormSub10 is a Form
56631>>>        Set Size to 13 382
56632>>>        Set Location to 57 111
56633>>>        Set Label_Col_Offset to 2
56634>>>        Set Form_FontHeight item 0 to 14
56635>>>        Set Form_FontWeight item 0 to 600
56636>>>        Set Form_TypeFace item 0 to "Arial"
56637>>>        Set Color to 15794160
56638>>>    End_Object    // FormSub1
56639>>>
56639>>>    Object btnSelectFolder is a Button
56641>>>        Set Label to " "
56642>>>        Set Size to 14 85
56643>>>        Set Location to 56 20
56644>>>        Set Focus_Mode to Pointer_Only
56645>>>        Set Form_TypeFace item 0 to "MS Sans Serif"
56646>>>
56646>>>        Procedure OnClick
56649>>>            Integer iInt
56649>>>            String sStr sStr2 sFolder
56649>>>            
56649>>>            Set ComBrowseForComputer    of oDirectoryPicker to True
56650>>>
56650>>>            Move (Trim(gvsSapPath))                                     to sFolder
56651>>>            If (Trim(sFolder)="") Move (fsReadRegistryUTFfolder(Self))  to sFolder
56654>>>            Move (Trim(sFolder))                    to sFolder
56655>>>            If (sFolder="") Move "C:\"              to sFolder
56658>>>            Set ComPath     of oDirectoryPicker     to sFolder
56659>>>            Get ComShow     of oDirectoryPicker     to sStr
56660>>>            
56660>>>            Get ComPath of oDirectoryPicker         to sStr2  // Full Path
56661>>>            Move (Trim(sStr2))                      to sStr2
56662>>>            If (sStr2<>'')  Set Value of FormSub10 item 0 to (Uppercase(TOOEM(sStr2)))
56665>>>            Else            Set Value of FormSub10 item 0 to ''
56667>>>        End_Procedure // OnClick
56668>>>
56668>>>    End_Object    // btnSelectFolder
56669>>>
56669>>>    Object frmFileName is a Form
56671>>>
56671>>>        Set Label to " "
56672>>>        Set Size to 13 384
56673>>>        Set Location to 57 111
56674>>>        Set Label_Col_Offset to 20
56675>>>        Set Label_Justification_Mode to jMode_Right
56676>>>        Set Prompt_Button_Mode to pb_PromptOn
56677>>>        Set Form_TypeFace item 0 to "MS Sans Serif"
56678>>>        Set Label_Row_Offset to 4
56679>>>        Set Color to 13303807
56680>>>
56680>>>        Procedure Prompt
56683>>>            String  sFileName sFolder
56683>>>            Integer bOpen
56683>>>            Get Show_Dialog of oOpenDialog1 to bOpen
56684>>>            If bOpen Begin
56686>>>                Get File_Name of oOpenDialog1 to sFileName
56687>>>                If (Trim(sFileName)<>'') Set Value item 0 to sFileName
56690>>>            End
56690>>>>
56690>>>        
56690>>>        End_Procedure
56691>>>        
56691>>>        Procedure OnChange000
56694>>>            String sVal
56694>>>            Get Value item 0 to sVal
56695>>>            Move (Trim(sVal)) to sVal
56696>>>            //Set psFileName to sVal
56696>>>        End_Procedure
56697>>>
56697>>>    End_Object    // frmFileName
56698>>>
56698>>>    Object oDbradiogroupSub1 is a Dbradiogroup
56700>>>        Set Location to 2 173
56701>>>    
56701>>>        Set Size to 40 163
56702>>>    
56702>>>        Object Radio1 is a Radio
56704>>>            Set Auto_Size_State to False
56705>>>            Set Label to "    "
56706>>>            Set Size to 10 151
56707>>>            Set Location to 10 5
56708>>>        End_Object    // Radio1
56709>>>    
56709>>>        Object Radio2 is a Radio
56711>>>            Set Auto_Size_State to False
56712>>>            Set Label to "  "
56713>>>            Set Size to 10 145
56714>>>            Set Location to 25 5
56715>>>        End_Object    // Radio2
56716>>>
56716>>>        Procedure Notify_Select_State Integer iToItem Integer iFromItem
56719>>>            Set piChoice to iToItem
56720>>>
56720>>>            Set Visible_State of btnSelectFolder    to (iToItem=0)
56721>>>            Set Visible_State of FormSub10          to (iToItem=0)
56722>>>            Set Visible_State of frmFileName        to (iToItem=1)
56723>>>            
56723>>>            Set Enabled_State of btnSelectFolder    to (iToItem=0)
56724>>>            Set Enabled_State of FormSub10          to (iToItem=0)
56725>>>            Set Enabled_State of frmFileName        to (iToItem=1)
56726>>>
56726>>>        End_Procedure
56727>>>
56727>>>    
56727>>>    End_Object
56728>>>
56728>>>    Object chkOEM is a Checkbox
56730>>>        Set Size to 10 50
56731>>>        Set Location to 79 191
56732>>>        Set Label to " OEM"
56733>>>        
56733>>>        Set Checked_State to True
56734>>>        
56734>>>        Set Enabled_State to False
56735>>>    End_Object
56736>>>
56736>>>    Object chkANSI is a Checkbox
56738>>>        Set Size to 10 50
56739>>>        Set Location to 79 263
56740>>>        Set Label to " ANSI"
56741>>>        Set Enabled_State to False
56742>>>    End_Object
56743>>>
56743>>>    Object btnSub1 is a Button
56745>>>        Set Size to 20 367
56746>>>        Set Location to 97 71
56747>>>        Set Label to "      OEM  UTF-8"
56748>>>
56748>>>        Procedure OnClick
56751>>>            String  sFileName sFileNameUTF sFileNameOEM sStr1 sStr2 sStr3
56751>>>            String  sLineIn sLineOut sExt sFrom sFilesFolder
56751>>>            Address aString sLabel
56751>>>            Integer iChoice iInt
56751>>>            
56751>>>            Get piChoice    to iChoice
56752>>>            Get Label       to sLabel
56753>>>
56753>>>            If (iChoice=0) Begin
56755>>>
56755>>>                Get Value of FormSub10 item 0 to sFilesFolder
56756>>>                If (Trim(sFilesFolder)="") Procedure_Return
56759>>>                
56759>>>                If (gviSkipHmniaCheck<>1) Move '*.txt' to sExt
56762>>>                //Else                      Move '*.PUM' to sExt
56762>>>                
56762>>>                Set ComSearchString          of oRecursiveFileFinder   to (Trim(sExt))
56763>>>                Set ComSearchFrom            of oRecursiveFileFinder   to sFilesFolder
56764>>>                Set ComSearchSubDirs         of oRecursiveFileFinder   to 0
56765>>>                Send ComStartSearching       to oRecursiveFileFinder
56766>>>                
56766>>>                If (gviSkipHmniaCheck<>1) Move (fsWriteRegistryUTFfolder(Self,(Trim(sFilesFolder)))) to iInt
56769>>>            End
56769>>>>
56769>>>            Else Begin
56770>>>                Get Value of frmFileName item 0 to sFileName
56771>>>                Move (Trim(sFileName))          to sFileName
56772>>>
56772>>>                If (Trim(sFileName)="") Begin
56774>>>                    Send Stop_Box ("  ["+(Trim(sFileName))+"]  ")  " 1001"
56775>>>                    Procedure_Return
56776>>>                End 
56776>>>>
56776>>>                
56776>>>                String sFolder
56776>>>                Move (fsReturnDirectoriesFromPath(Self,sFileName))      to sFolder
56777>>>                If (gviSkipHmniaCheck<>1) Move (fsWriteRegistryUTFfolder(Self,(Trim(sFolder))))   to iInt
56780>>>
56780>>>                Move (Trim(sFileName)+".UTF8") to sFileNameUTF
56781>>>
56781>>>                Direct_Input    channel 6 sFileName
56783>>>                Direct_Output   channel 7 sFileNameUTF
56785>>>
56785>>>                Readln channel 6 sLineIn
56787>>>                While (not(SeqEof))
56791>>>                    If (Trim(sLineIn)<>'') Begin
56793>>>                        //  Move (ToOEM          (sLineIn)) to sLineIn
56793>>>                        If (gviSkipHmniaCheck<>1) Begin
56795>>>                            Move (ToOEM          (sLineIn)) to sLineIn
56796>>>                        End
56796>>>>
56796>>>                        Move (OemToUtf8String(sLineIn)) to sLineOut
56797>>>                        Writeln channel 7 sLineOut
56800>>>                        
56800>>>                    End
56800>>>>
56800>>>                    Readln channel 6 sLineIn
56802>>>                Loop
56803>>>>
56803>>>                Close_Input  channel 6
56805>>>                Close_Output channel 7
56807>>>
56807>>>                //If (gviSkipHmniaCheck<>1) Begin
56807>>>                    EraseFile sFileName
56808>>>>
56808>>>
56808>>>                    Move (Trim(sFileNameUTF)) to sStr1
56809>>>                    
56809>>>                    // Replace it with the new utf but as a txt by removing the .UTF at the end
56809>>>
56809>>>                    Move (Replace(".UTF8",sStr1,"")) to sStr2
56810>>>
56810>>>                    // Find the file name only without the full path for the rename command
56810>>>                    // which does not want the full path name for the new name because it 
56810>>>                    // uses the path from the initial file we want to rename
56810>>>                    Move (Trim(fsReturnFileFromPath(Self,sStr2))) to sStr3
56811>>>                    //
56811>>>                    RenameFile sFileNameUTF to sStr3
56812>>>>
56812>>>                //End
56812>>>                //Else Begin   
56812>>>                //    EraseFile sFileName
56812>>>                //    Move (Trim(sFileNameUTF)) to sStr1
56812>>>                //    Move (Replace(".UTF8",sStr1,"")) to sStr2
56812>>>                //    // Find the file name only without the full path for the rename command
56812>>>                //    // which does not want the full path name for the new name because it 
56812>>>                //    // uses the path from the initial file we want to rename
56812>>>                //    Move (Trim(fsReturnFileFromPath(Self,sStr2))) to sStr3
56812>>>                //End
56812>>>            End
56812>>>>
56812>>>
56812>>>            Set Label to sLabel
56813>>>            String sNewMess ss100
56813>>>            Move "" to ss100
56814>>>            
56814>>>            If (gviSkipHmniaCheck=1) Move sStr2 to ss100
56817>>>            
56817>>>            Else If (iChoice=0) Get Value of FormSub10   item 0 to ss100
56821>>>            Else                Get Value of frmFileName item 0 to ss100
56823>>>
56823>>>            Move (Trim(ss100)) to ss100        
56824>>>                
56824>>>            Move ("  ,      "+ss100) to sNewMess
56825>>>            
56825>>>            If (gviSkipHmniaCheck<>1) Send Info_Box sNewMess ""
56828>>>            
56828>>>            If (gviSkipHmniaCheck=1) Begin
56830>>>                Send Request_Cancel of Utf_View
56831>>>                Send Exit_Application
56832>>>            End
56832>>>>
56832>>>            
56832>>>        End_Procedure // OnClick
56833>>>
56833>>>    End_Object
56834>>>
56834>>>    Object oOpenDialog1 is a OpenDialog
56836>>>
56836>>>        String sFold sFil
56836>>>        Move (Trim(gvsSapPath)) to sFil
56837>>>        
56837>>>        Set Dialog_Caption to 'Select a Text file to Convert'
56838>>>        Set Filter_String  to 'Text|*.txt;*.csv'
56839>>>        
56839>>>        If (gviSkipHmniaCheck=1) Move (fsReturnDirectoriesFromPath(Self,sFil)) to sFold
56842>>>
56842>>>        Set Initial_Folder to (Trim(sFold))
56843>>>
56843>>>    End_Object    // oOpenDialog1
56844>>>
56844>>>    Object oDirectoryPicker is a cComDPDlg
56846>>>        Set Size            to 0 0
56847>>>        Set Location        to 0 0
56848>>>        Set Visible_State   to False
56849>>>        
56849>>>        Procedure Activate
56852>>>            Forward Send Activate
56854>>>            Set Location    to 1 1
56855>>>            Set Size        to 190 190
56856>>>            Set ComRoot   to 3
56857>>>            //  0=Desktop
56857>>>            //  1=Control Panel
56857>>>            //  2=Desktop Directory
56857>>>            //  3=My Computer
56857>>>            //  4=Font Directory
56857>>>            //  5=Network Neighborhood
56857>>>            //  6=Printers
56857>>>            //  7=Programs
56857>>>            //  8=Recent
56857>>>            //  9=Recycle Bin
56857>>>            // 10=Send To
56857>>>            // 11=Start Menu
56857>>>            // 12=Start Up
56857>>>            // 13=Templates
56857>>>            // 14=Custom Root
56857>>>        End_Procedure
56858>>>    End_Object
56859>>>
56859>>>    Object oRecursiveFileFinder is a cComXfind
56861>>>        Set Size            to 0 0
56862>>>        Set Location        to 0 0
56863>>>        Set Visible_State   to False
56864>>>
56864>>>
56864>>>        Procedure OnComFoundFile
56867>>>            String  sFileName sFileNameUTF sFileNameOEM sStr sPath sFile
56867>>>            String  sLineIn sLineOut sExt sFrom sFilesFolder sSapDate
56867>>>            Address aString
56867>>>            Integer iCount iOEM iANSI iTxtSize iUTFSize
56867>>>
56867>>>            Get Checked_State of chkOEM  to iOEM
56868>>>            Get Checked_State of chkANSI to iANSI
56869>>>
56869>>>            Get ComFileName  to sFileName
56870>>>            Move gvsSapHmnia to sSapDate
56871>>>
56871>>>            If (gviSkipHmniaCheck=1) Begin
56873>>>                Move (Trim(sFileName)+".UTF8")  to sFileNameUTF
56874>>>                Direct_Input    channel 6 sFileName
56876>>>                Get_Channel_Size 6 to iTXTSize
56877>>>                Direct_Output   channel 7 sFileNameUTF
56879>>>                Readln channel 6 sLineIn
56881>>>                While (not(SeqEof))
56885>>>                    If (Trim(sLineIn)<>'') Begin
56887>>>                        If      (iOEM =1) Move (ToOEM (sLineIn)) to sLineIn
56890>>>                        Else If (iANSI=1) Move (ToANSI(sLineIn)) to sLineIn
56894>>>                        Set Label of btnSub1 to (Trim(Left(sLineIn,30)))
56895>>>                        Move (OemToUtf8String(sLineIn))          to sLineOut
56896>>>                        Writeln channel 7 sLineOut
56899>>>                    End
56899>>>>
56899>>>                    Readln channel 6 sLineIn
56901>>>                Loop
56902>>>>
56902>>>                Get_Channel_Size 7 to iUTFSize
56903>>>                Close_Output channel 6
56905>>>                Close_Output channel 7
56907>>>    
56907>>>                If (iTXTSize>iUTFSize) Begin
56909>>>                    Send Info_Box ("     \n"+trim(sFileName)) ''
56910>>>                End
56910>>>>
56910>>>                
56910>>>                //         rename  .UTF8  .TXT
56910>>>                //Else Begin
56910>>>                //    String sStr1 sStr2 sStr3
56910>>>                //
56910>>>                //    // Delete the old txt FI output
56910>>>                //    EraseFile sFileName
56910>>>                //    
56910>>>                //    Move (Trim(sFileNameUTF))       to sStr1
56910>>>                //    // Replace it with the new utf but as a txt by removing the .UTF at the end
56910>>>                //    Move (Replace(".UTF8",sStr1,"")) to sStr2
56910>>>                //    // Find the file name only without the full path for the rename command
56910>>>                //    // which does not want the full path name for the new name because it 
56910>>>                //    // uses the path from the initial file we want to rename
56910>>>                //    Move (Trim(fsReturnFileFromPath(Self,sStr2))) to sStr3
56910>>>                //    //
56910>>>                //    RenameFile sFileNameUTF to sStr3
56910>>>                //    //
56910>>>                //End
56910>>>            End
56910>>>>
56910>>>            Else If (sFileName contains sSapDate) Begin
56913>>>            
56913>>>                Move (Trim(sFileName)+".UTF8")  to sFileNameUTF
56914>>>    
56914>>>                Direct_Input    channel 6 sFileName
56916>>>                
56916>>>                Get_Channel_Size 6 to iTXTSize
56917>>>    
56917>>>                Direct_Output   channel 7 sFileNameUTF
56919>>>                Readln channel 6 sLineIn
56921>>>                While (not(SeqEof))
56925>>>                    If (Trim(sLineIn)<>'') Begin
56927>>>                        If      (iOEM =1) Move (ToOEM (sLineIn)) to sLineIn
56930>>>                        Else If (iANSI=1) Move (ToANSI(sLineIn)) to sLineIn
56934>>>                        Set Label of btnSub1 to (Trim(Left(sLineIn,30)))
56935>>>                        Move (OemToUtf8String(sLineIn))          to sLineOut
56936>>>                        Writeln channel 7 sLineOut
56939>>>                    End
56939>>>>
56939>>>                    Readln channel 6 sLineIn
56941>>>                Loop
56942>>>>
56942>>>                Get_Channel_Size 7 to iUTFSize
56943>>>                
56943>>>                Close_Output channel 6
56945>>>                Close_Output channel 7
56947>>>    
56947>>>                //Direct_Input channel 7
56947>>>                //Get_Channel_Size 7 to iUTFSize
56947>>>                //Close_Input channel 7 
56947>>>                
56947>>>                If (iTXTSize>iUTFSize) Begin
56949>>>                    Send Info_Box ("    \n"+trim(sFileName)) ''
56950>>>                End
56950>>>>
56950>>>                Else Begin
56951>>>                    String sStr1 sStr2 sStr3
56951>>>    
56951>>>                    // Delete the old txt FI output
56951>>>                    EraseFile sFileName
56952>>>>
56952>>>                    
56952>>>                    Move (Trim(sFileNameUTF))       to sStr1
56953>>>                    // Replace it with the new utf but as a txt by removing the .UTF at the end
56953>>>                    Move (Replace(".UTF8",sStr1,"")) to sStr2
56954>>>                    // Find the file name only without the full path for the rename command
56954>>>                    // which does not want the full path name for the new name because it 
56954>>>                    // uses the path from the initial file we want to rename
56954>>>                    Move (Trim(fsReturnFileFromPath(Self,sStr2))) to sStr3
56955>>>                    //
56955>>>                    RenameFile sFileNameUTF to sStr3
56956>>>>
56956>>>                    //
56956>>>                End
56956>>>>
56956>>>            End //If (sFileName contains sSapDate) Begin
56956>>>>
56956>>>        End_Procedure
56957>>>
56957>>>    End_Object
56958>>>
56958>>>End_Object
56959>>>
56959>>>//AB/ End_Object    // prj
56959>        //Use PrinterInfo.vw
56959>
56959>        //------
56959>    End_Object
56960>    
56960>End_Object
56961>
56961>
56961>//If ((Trim(gvsSapHmnia)="") and (gviSkipHmniaCheck<>1)) Begin
56961>//    Send Stop_Box " / SAP" " 5001" 
56961>//    Send Exit_Application   
56961>//End
56961>//Else Begin
56961>//    Send Activate_Utf_View of (oClientArea(oMain))
56961>    Start_UI
56962>//End
56962>
ERROR: 4328 Undefined symbol in argument IMAX00 ON LINE: 60 (55706) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMETRHTHSPROSP ON LINE: 60 (55706) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMETRHTHSPROSP ON LINE: 61 (55707) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IMAX00 ON LINE: 61 (55707) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IHASAPASSWORD ON LINE: 65 (55711) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IANENERGOS ON LINE: 66 (55714) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
ERROR: 4328 Undefined symbol in argument IAPOTEL ON LINE: 67 (55717) OF FILE: L:\VDF14.1.Dev\TitanUTF\AppSrc\Migration_Excel_Output.src
Summary
Memory Available: 241889280
Total Warnings : 0
Total Errors   : 59
Total Symbols  : 32039
Total Resources: 0
Total Commands : 56961
Total Windows  : 1
Total Pages    : 1
Static Data    : 381225
Message area   : 355052
Total Blocks   : 20446
59 ERRORS HAVE BEEN FOUND.
