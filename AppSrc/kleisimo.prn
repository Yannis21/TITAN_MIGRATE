Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\kleisimo.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30325>
30325>Register_Object Client_Area
30325>
30325>//AB-StoreTopStart
30325>Use Workspc.pkg
30325>
30325>//  Set date attributes as needed
30325>Set_Date_Attribute sysdate4_State to (TRUE)
30326>Set_Date_Attribute Date4_State    to (TRUE)
30327>Set_Date_Attribute epoch_value    to 30
30328>
30328>Object ProgramWorkspace is a WorkspaceSub
30330>    Set WorkspaceName to CURRENT$WORKSPACE
30331>    Set kEnter_Next_State to True
30332>//    Set ModuleName    to 'ProgramName' // Special module name.
30332>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30332>End_Object
30333>
30333>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30333>>>// Help_ids.inc
30333>>>//
30333>>>// Context ids for the order entry system. This uses
30333>>>// help file ordentry.hlp.
30333>>>//
30333>>>// This is a sample version. YOU must supply
30333>>>// the ID values
30333>>>
30333>>>//  Generic Context Ids
30333>>>//
30333>>>
30333>>>// It is expected that file-names ids will be the same as their
30333>>>// filenumber.
30333>>>
30333>>>
30333>>>//  View and selection-list specific context ids
30333>>>//
30333>>>//..........add view, object, selection-list ids here....
30333>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30333>>>// STD_HELP.PKG
30333>>>//
30333>>>// Global Help Object
30333>>>//
30333>>>//  Creates all Help Support required to access WINDOWs help system
30333>>>//  with DataFlex. Creates a global object named Help_Object.
30333>>>//
30333>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30333>>>
30333>>>use DFHlpSys // Context Sensitive Help Support
30333>>>
30333>>>
30333>>>// This file needs to be provided by the developer. It will contain
30333>>>// symbolic replacements for the ID integer values used to access the
30333>>>// the windows help file's topics.
30333>>>//
30333>>>use Help_ids.inc
30333>>>
30333>>>// If the following are not defined in help_ids.inc,
30333>>>//  create default 0 values for them
30333>>>Define GeneralHelpId    for    0
30333>>>Define KeysHelpId       for    0
30333>>>Define FileHelpId       for    0
30333>>>Define ErrorHelpId      for    0  // probably not used in VDF
30333>>>Define IndexHelpId      for    0  // probably not used in VDF
30333>>>
30333>>>object Help_Object is a HelpSystem // global help object
30335>>>
30335>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30336>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30337>>>   Set Help_Id_Keys    to KeysHelpId       //
30338>>>   Set Help_Id_Files   to FileHelpId       //
30339>>>   Set Help_Id_Errors  to ErrorHelpId      //
30340>>>
30340>>>end_object
30341>
30341>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
30341>>>Use CrystalReport.pkg
30341>>>
30341>>>
30341>>>
30341>>>Type PEWindowOptions
30341>>>  Field PEWindowOptions.StructSize As Word
30341>>>  Field PEWindowOptions.hasGroupTree As Word
30341>>>  Field PEWindowOptions.canDrillDown As Word
30341>>>  Field PEWindowOptions.hasNavigationControls As Word
30341>>>  Field PEWindowOptions.hasCancelButton As Word
30341>>>  Field PEWindowOptions.hasPrintButton As Word
30341>>>  Field PEWindowOptions.hasExportButton As Word
30341>>>  Field PEWindowOptions.hasZoomControl As Word
30341>>>  Field PEWindowOptions.hasCloseButton As Word
30341>>>  Field PEWindowOptions.hasProgressControls As Word
30341>>>  Field PEWindowOptions.hasSearchButton As Word
30341>>>  Field PEWindowOptions.hasPrintSetupButton As Word
30341>>>  Field PEWindowOptions.hasRefreshButton As Word
30341>>>End_Type // PEWindowOptions
30341>>>
30341>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
30342>>>
30342>>>Class CrystalReportSubSQL Is A CrystalReport
30343>>>
30343>>>    Procedure Construct_Object
30344>>>        Forward send Construct_Object
30346>>>        // Everything on except hasGroupTree by default
30346>>>        property integer hasGroupTree 0
30347>>>        property integer canDrillDown 1
30348>>>        property integer hasNavigationControls 1
30349>>>        property integer hasCancelButton 1
30350>>>        property integer hasPrintButton 1
30351>>>        property integer hasExportButton 1
30352>>>        property integer hasZoomControl 1
30353>>>        property integer hasCloseButton 1
30354>>>        property integer hasProgressControls 1
30355>>>        property integer hasSearchButton 1
30356>>>        property integer hasPrintSetupButton 1
30357>>>        property integer hasRefreshButton 1
30358>>>
30358>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
30359>>>    End_Procedure // Construct_Object
30360>>>
30360>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
30361>>>        Integer iPrintJob iResult
30362>>>        String sPEWindowOptions
30362>>>        Pointer pPeWindowOptions
30362>>>
30362>>>        Get PrintJob To iPrintJob
30363>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
30364>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
30365>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
30366>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
30367>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
30368>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
30369>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
30370>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
30371>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
30372>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
30373>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
30374>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
30375>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
30376>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
30377>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
30378>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
30379>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
30381>>>    End_Procedure // OutputToWindow
30382>>>
30382>>>    Procedure Set TmpFileDir String aDir
30383>>>        String lsCurrWspc lsDir
30384>>>
30384>>>//        If (ghoWorkSpace <> 0) Begin
30384>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
30384>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
30384>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
30384>>>//            Set Report_Data_Path to lsDir
30384>>>//        End
30384>>>    End_Procedure
30385>>>
30385>>>    Procedure DoWinQLReport
30386>>>        // This can be used when reports must be able to run in different data directories
30386>>>        Set TmpFileDir to "TmpFileDir"
30387>>>        Forward Send DoWinQLReport
30389>>>    End_Procedure
30390>>>
30390>>>
30390>>>    // This hook procedure is called after the print job has been opened.
30390>>>
30390>>>    Procedure OnInitializeReport000
30391>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
30391>>>
30391>>>        Integer iTables iMax iCount iType
30392>>>        String  sLocation sLocation2 sPath DirSep
30392>>>        String  sNewPath sNewLocation sDataPath sMyLocation
30392>>>
30392>>>//        Open Sysfile
30392>>>
30392>>>        String  sActualSQL
30392>>>        String  sActualTemp
30392>>>        String  sOldSQL
30392>>>        String  sOldTemp
30392>>>        String  sServerName
30392>>>        String  sDatabaseName
30392>>>        String  sUserID
30392>>>
30392>>>//        Move Sysfile.ActualSQL      to sActualSQL
30392>>>//        Move Sysfile.ActualTemp     to sActualTemp
30392>>>//        Move Sysfile.OldSQL         to sOldSQL
30392>>>//        Move Sysfile.OldTemp        to sOldTemp
30392>>>//        Move Sysfile.cServerName    to sServerName
30392>>>//        Move Sysfile.cDatabaseName  to sDatabaseName
30392>>>//        Move Sysfile.cUserID        to sUserID
30392>>>
30392>>> //       Move 'SMS'                 to sOldSQL
30392>>> //       Move 'C:\Dns_tmp\'         to sOldTemp
30392>>> //       Move 'SMSMET'        to sActualSQL      // Database
30392>>> //       Move 'C:\Dns_tmp\'         to sActualTemp
30392>>> //      Move 'SMSMET'        to sServerName    // ODBC
30392>>> //       Move 'SMSMET'        to sDatabaseName  // DataBase
30392>>>     //   Move 'sa'               to sUserID
30392>>>
30392>>>        Move 'SMS'                 to sOldSQL
30393>>>        Move 'C:\Dns_tmp\'         to sOldTemp
30394>>>        Move 'SMSTITAN'            to sActualSQL      // Database
30395>>>        Move 'C:\Dns_tmp\'         to sActualTemp
30396>>>        Move 'SMSTITAN'            to sServerName    // ODBC
30397>>>        Move 'SMSTITAN'            to sDatabaseName  // DataBase
30398>>>
30398>>>
30398>>>        Move (Trim(sActualSQL   )) to sActualSQL
30399>>>        Move (Trim(sActualTemp  )) to sActualTemp
30400>>>        Move (Trim(sOldSQL      )) to sOldSQL
30401>>>        Move (Trim(sOldTemp     )) to sOldTemp
30402>>>        Move (Trim(sServerName  )) to sServerName
30403>>>        Move (Trim(sDatabaseName)) to sDatabaseName
30404>>>        Move (Trim(sUserID      )) to sUserID
30405>>>
30405>>>
30405>>>        Forward Send OnInitializeReport
30407>>>
30407>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
30408>>>        Get NTables To iMax
30409>>>        Decrement iMax
30410>>>        Get Report_Data_Path                                    To sPath
30411>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
30414>>>        For iCount From 0 To iMax
30420>>>>
30420>>>            Get NthTableLocation iCount         To sLocation
30421>>>            Get Report_Base_File_Name sLocation To sLocation2
30422>>>            Get NthTableDBType           iCount to iType
30423>>>
30423>>>            // An einai type 1 topiko
30423>>>            //               2=SQL
30423>>>            If (iType=2) Begin
30425>>>                If (sLocation contains sOldSQL) Begin
30427>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
30428>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30429>>>                End
30429>>>>
30429>>>            End
30429>>>>
30429>>>            Else If (iType=1) Begin
30432>>>                If (sLocation contains sOldTemp) Begin
30434>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
30435>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
30436>>>                End
30436>>>>
30436>>>            End
30436>>>>
30436>>>            Set nthTableLogOnServerName     iCount to sServerName     0
30437>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
30438>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
30439>>>        Loop // For iCount From 0 To iMax
30440>>>>
30440>>>
30440>>>    End_Procedure // OnInitializeReport
30441>>>
30441>>>
30441>>>//                Showln '--------------------------------------------------------'
30441>>>//                Showln iCount
30441>>>//                Showln sLocation
30441>>>//                Showln sPath
30441>>>//                Showln sLocation2
30441>>>//                Showln iType
30441>>>
30441>>>                //If (Trim(LowerCase(sLocation2))='btnemp.dat') Begin
30441>>>                  //Set Report_Data_Path to ''
30441>>>                  //Get NthTableDBType              iCount to iType
30441>>>                    //Set nthTableLogOnPassword       iCount to '123'     0
30441>>>                  //Set NthTableLocation            iCount To "BTNEMP"
30441>>>                    //Set NthTableLocation iCount To (sPath-sLocation2)
30441>>>                  //Get NthTableLocation iCount                 To sMyLocation
30441>>>                  //Move (Replace(sLocation,sMyLocation,''))    To sMyLocation
30441>>>                  //Showln sMyLocation
30441>>>                  //Set NthTableLocation            iCount To sMyLocation
30441>>>                //End
30441>>>
30441>>>
30441>>>
30441>>>    // This hook procedure is called just before a print job is closed.
30441>>>    Procedure OnDeInitializeReport
30442>>>        Forward Send OnDEInitializeReport
30444>>>    End_Procedure // OnDeInitializeReport
30445>>>
30445>>>    // This hook procedure is called just before a the print job is started.
30445>>>    Procedure OnStartPrinting
30446>>>        Forward Send OnStartPrinting
30448>>>    End_Procedure // OnStartPrinting
30449>>>
30449>>>    // This hook procedure is called just after a print job has finished.
30449>>>    Procedure OnStopPrinting
30450>>>        Forward Send OnStopPrinting
30452>>>    End_Procedure // OnStopPrinting
30453>>>
30453>>>
30453>>>End_Class // CrystalReportSubSQL
30454>>>
30454>Integer giWait_Obj
30454>
30454>// General Functions-Procedures and Variables
30454>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30454>>>
30454>>>        String  gs_Selected_Company_Code
30454>>>        String  gs_Selected_Branch_Code
30454>>>        Integer gi_Selected_Year
30454>>>        String gs_Selected_Year_Recr
30454>>>        String  gs_Module_Code
30454>>>
30454>>>
30454>>>//Open Currency
30454>>>//Function CurrDigits Global String asCurr Returns Integer
30454>>>//    Integer liDecX
30454>>>//    Clear Currency
30454>>>//    move asCurr to Currency.Currency_C_Code
30454>>>//    Find Eq Currency By Index.1
30454>>>//    move Currency.Currency_Dec to liDecX
30454>>>//    Function_Return liDecX
30454>>>//End_Function // CurrDigits
30454>>>
30454>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30456>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30458>>>
30458>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30459>>>    Move (Trim(asNomisma)) to asNomisma
30460>>>    Clear Nomisma
30461>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30464>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30466>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30467>>>>
30467>>>    Function_Return Nomisma.Dekadika
30468>>>End_Function //
30469>>>
30469>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30470>>>    String rVal
30471>>>    Integer iLength iInt
30471>>>    Move aiCode to rVal
30472>>>    Move (trim(rVal)) to rVal
30473>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30479>>>>
30479>>>        Move (Insert('0',rVal,1)) to rVal
30480>>>    Loop
30481>>>>
30481>>>    Function_Return rVal
30482>>>End_Function
30483>>>
30483>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30484>>>    String rVal
30485>>>    Integer iLength iInt ipos
30485>>>    Move aiCode to rVal
30486>>>    Move (trim(rVal)) to rVal
30487>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30488>>>    For iInt From 1 to ipos
30494>>>>
30494>>>        Move (Insert('0',rVal,1)) to rVal
30495>>>    Loop
30496>>>>
30496>>>    Function_Return rVal
30497>>>End_Function
30498>>>
30498>>>
30498>>>Open Year
INCLUDING FILE: YEAR.FD
30500>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30501>>>    Send aiMsg to Self
30502>>>End_Procedure
30503>>>
30503>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30504>>>    Integer liChanged
30505>>>
30505>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30508>>>    If (Not(Current_Record(aiYearDD))) Begin
30510>>>        Get Should_Save of aiPanel to liChanged
30511>>>        Send Clear to aiYearDD
30512>>>        Move gs_Selected_Company_Code to Year.Company_Code
30513>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30514>>>        Move gi_Selected_Year         to Year.Year_Year
30515>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30516>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30519>>>    End
30519>>>>
30519>>>End_Procedure
30520>>>
30520>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30521>>>    Integer liSrvr
30522>>>    String  lsCurrentYearRecr
30522>>>
30522>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30524>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30526>>>    End
30526>>>>
30526>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30527>>>    Get Server of aiPanel to liSrvr
30528>>>    // Respects Default values
30528>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30533>>>End_Procedure
30534>>>
30534>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30534>>>//                                                          Holds the current year rec0
30534>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30534>>>
30534>>>
30534>>>Function fiRefindYear Global Returns Integer
30535>>>    Clear Year
30536>>>    Move gs_Selected_Company_Code to Year.Company_Code
30537>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30538>>>    Move gi_Selected_Year         to Year.Year_Year
30539>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30540>>>>
30540>>>    Function_Return (Found = 0)
30541>>>End_Function //fiRefindYear
30542>>>
30542>>>Procedure DoRunApplication for Baseclass String sAppName
30543>>>    string sRuntime  lsStr
30544>>>
30544>>>    Append lsStr 'C:\Dns.bat ' sAppName
30546>>>    RunProgram Wait  lsStr
30547>>>
30547>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30547>>>//    append sRuntime "\dfrun " sAppName
30547>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30549>>>    runprogram background sRuntime
30550>>>End_procedure // DoRunApplication
30551>>>
30551>>>// Run the Editor
30551>>>Procedure DoRunEditor for Baseclass String asFile
30552>>>    string sRunPath lsWspcName
30553>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30554>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30557>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30557>>>    Move (Replace('.',asFile,'')) to asFile
30558>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30559>>>    send DoRunApplication sRunPath
30560>>>End_Procedure // DoRunEditor
30561>>>
30561>>>//--------------------------------------
30561>>>
30561>>>//start of global functions and procedures
30561>>>
30561>>>
30561>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30561>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30562>>>         String  lsTemp_Code1 lsTemp_Code2
30563>>>         Integer liCounter
30563>>>
30563>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30563>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30564>>>
30564>>>         //2.˜¤« ©«¨¦­ã
30564>>>         For liCounter From 1 to (Length(lsCode))
30570>>>>
30570>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30571>>>         Loop
30572>>>>
30572>>>
30572>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30572>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30573>>>
30573>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30573>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30574>>>
30574>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30574>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30580>>>>
30580>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30581>>>         Loop
30582>>>>
30582>>>
30582>>>         Function_Return (Trim(lsTemp_Code2))
30583>>>End_Function //gsffind_previous
30584>>>
30584>>>
30584>>>Function gifSystem_Check Returns Integer
30585>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30586>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30586>>>//       Clear Company
30586>>>//       Find Gt Company.Recnum
30586>>>//       While (Found = 1)
30586>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30586>>>//             Add Company.Company_NumGarticl to liS_Garticls
30586>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30586>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30586>>>//             Add Company.Company_NumGplan   to liS_GPlans
30586>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30586>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30586>>>//             Find Gt Company.Recnum
30586>>>//       Loop
30586>>>//
30586>>>//       Get_Attribute {attribute} [of {file-handle} ;
30586>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30586>>>//                        To {variable}
30586>>>//
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30586>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30586>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30586>>>//
30586>>>
30586>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30586>>>
30586>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30586>>>
30586>>>    Function_Return 0
30587>>>End_Function //gifSystem_Check
30588>>>
30588>>>/////////////////////////////////////////////////////////////////
30588>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30588>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30589>>>
30589>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30590>>>    Integer liInt liInteger iTimes iStart
30590>>>    Number  lnDecimals
30590>>>
30590>>>    Move (Integer(anValue))                                         to liInteger
30591>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30592>>>
30592>>>    Move liInteger              to lsAkeraios
30593>>>    Move lnDecimals             to lsDekadika
30594>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30595>>>    Move (Trim(lsDekadika))     to lsDekadika
30596>>>
30596>>>    Move (Length(lsAkeraios)) to iStart
30597>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30603>>>>
30603>>>        Insert "0" in lsAkeraios at 1
30605>>>    Loop
30606>>>>
30606>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30607>>>
30607>>>    Move (Length(lsDekadika)) to iStart
30608>>>    For iTimes From iStart to (aiLengthDekadika-1)
30614>>>>
30614>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30615>>>    Loop
30616>>>>
30616>>>    Move (Trim(lsDekadika)) to lsDekadika
30617>>>
30617>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30620>>>    Move '' to lsRetVal
30621>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30622>>>    Function_Return lsRetval
30623>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30624>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30624>>>
30624>>>Open Codemast
30626>>>
30626>>>
30626>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30627>>>         Clear Codemast
30628>>>         Move lsType  to Codemast.Type
30629>>>         Move lsValue to Codemast.Code
30630>>>         Find Eq Codemast by Index.1 //type+code
30631>>>>
30631>>>         Function_Return Codemast.Description
30632>>>End_Function //code_mast
30633>>>
30633>>>
30633>>>Open Branch
INCLUDING FILE: BRANCH.FD
30635>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30636>>>    String rVal
30637>>>    Integer iInt
30637>>>    Clear Branch
30638>>>    Move asCompany  to Branch.Company_Code
30639>>>    Move asBranch   to Branch.Branch_Code
30640>>>    Find Eq Branch by Index.1
30641>>>>
30641>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30644>>>    Move (Trim(asCompany))  to asCompany
30645>>>    Move (Trim(asBranch))   to asBranch
30646>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30650>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30654>>>    Move ''                                           to rVal
30655>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30656>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30657>>>    Move (Trim(rVal))                                 to rVal
30658>>>    Function_Return rVal
30659>>>End_Function
30660>>>
30660>>>Function fsgStripCodeFromID Global String asID Returns Integer
30661>>>      Integer iLen iPos iInt
30662>>>      If (Trim(asID)='') Function_Return 0
30665>>>      Move (Trim  (asID)) to asID
30666>>>      Move (Length(asID)) to iLen
30667>>>      For iInt From 1     to iLen
30673>>>>
30673>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30676>>>      Loop
30677>>>>
30677>>>      Function_Return (Right(asID,(iLen-iPos)))
30678>>>End_Function
30679>>>
30679>>>Function fsCityDescr Global Integer aiCityID Returns String
30680>>>    String rVal
30681>>>    Open Cities
INCLUDING FILE: CITIES.FD
30683>>>    Clear Cities
30684>>>    Move aiCityID to Cities.City_ID
30685>>>    Find Eq Cities By Index.1
30686>>>>
30686>>>    If (Found=1) Move Cities.City_descr to rVal
30689>>>    Else         Move '' to rVal
30691>>>    Function_Return rVal
30692>>>End_Function
30693>>>
30693>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30694>>>    Open Cities
30696>>>    Clear Cities
30697>>>    Move aiCityID to Cities.City_ID
30698>>>    Find Eq Cities By Index.1
30699>>>>
30699>>>    Function_Return Cities.Town_ID
30700>>>End_Function
30701>>>
30701>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30702>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30704>>>    Clear Towns
30705>>>    Move aiTownID to Towns.Town_ID
30706>>>    Find Eq Towns By Index.1
30707>>>>
30707>>>    Function_Return Towns.Country_ID
30708>>>End_Function
30709>>>
30709>>>Function fsTownDescr Global Integer aiTownID Returns String
30710>>>    String rVal
30711>>>    Open Towns
30713>>>    Clear Towns
30714>>>    Move aiTownID to Towns.Town_ID
30715>>>    Find Eq Towns By Index.1
30716>>>>
30716>>>    If (Found=1) Move Towns.Town_descr to rVal
30719>>>    Else         Move '' to rVal
30721>>>    Function_Return rVal
30722>>>End_Function
30723>>>
30723>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30724>>>    String rVal
30725>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30727>>>    Clear Country
30728>>>    Move aiCountryID to Country.Country_ID
30729>>>    Find Eq Country By Index.1
30730>>>>
30730>>>    If (Found=1) Move Country.Country_descr to rVal
30733>>>    Else         Move '' to rVal
30735>>>    Function_Return rVal
30736>>>End_Function
30737>>>
30737>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30738>>>    String rVal
30739>>>    Open Areas
INCLUDING FILE: AREAS.FD
30741>>>    Clear Areas
30742>>>    Move aiAreaID to Areas.Area_ID
30743>>>    Find Eq Areas By Index.1
30744>>>>
30744>>>    If (Found=1) Move Areas.Area_descr to rVal
30747>>>    Else         Move '' to rVal
30749>>>    Function_Return rVal
30750>>>End_Function
30751>>>
30751>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30752>>>    Local String rVal lsTmp lsOO lsLL
30753>>>    Local Number lnOO lnLL
30753>>>
30753>>>    Move '' to lsOO
30754>>>    Move '' to lsLL
30755>>>    Move '' to rVal
30756>>>
30756>>>    Move (Integer(anTime))                              to lnOO
30757>>>
30757>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30758>>>
30758>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30761>>>    Else         Move (String(lnOO))                    to lsOO
30763>>>    Move (Trim(lsOO))                                   to lsOO
30764>>>
30764>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30767>>>    Else         Move (String(lnLL))                    to lsLL
30769>>>    Move (Trim(lsLL))                                   to lsLL
30770>>>
30770>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30771>>>
30771>>>    Move (Trim(rVal)) to rVal
30772>>>
30772>>>    Function_Return rVal
30773>>>End_Function
30774>>>
30774>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30775>>>    Local Number rVal nOres nLepta
30776>>>    Move (Integer(aiMinutes/60))    to nOres
30777>>>    Move (    Mod(aiMinutes,60))    to nLepta
30778>>>    Move (nOres+(nLepta/100))       to rVal
30779>>>    Function_Return rVal
30780>>>End_Function
30781>>>
30781>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30782>>>    Local Integer rVal
30783>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30784>>>    Function_Return rVal
30785>>>End_Function
30786>>>
30786>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30787>>>    Local Integer rVal iMinStart iMinEnd
30788>>>
30788>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30791>>>
30791>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30792>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30793>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30794>>>    Function_Return rVal
30795>>>End_Function
30796>>>
30796>>>
30796>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30797>>>    Local Integer iTmp
30798>>>    Local Number  rVal
30798>>>
30798>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30801>>>
30801>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30802>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30803>>>    Function_Return rVal
30804>>>End_Function
30805>>>
30805>>>
30805>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30807>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30809>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30811>>>
30811>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30812>>>  Integer iExodos
30813>>>  Number nPoso nPct
30813>>>  Move 0 to nPoso
30814>>>  Move 0 to nPct
30815>>>  Move 0 to iExodos
30816>>>
30816>>>  Move (Trim(asItemCode)) to asItemCode
30817>>>  Move (Trim(asPromCode)) to asPromCode
30818>>>
30818>>>  // 1.Anazhthsh sto arxeio Witemcld
30818>>>  Clear Witemcld
30819>>>  Move asItemCode to Witemcld.Item_Code
30820>>>  Move asPromCode to Witemcld.Client_Code
30821>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30822>>>>
30822>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30826>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30828>>>          Move 1 to iExodos
30829>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30832>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30836>>>      End
30836>>>>
30836>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30837>>>>
30837>>>  Loop
30838>>>>
30838>>>  If (iExodos) Begin
30840>>>      If (nPoso) Function_Return nPoso
30843>>>      Else Function_Return nPct
30845>>>  End
30845>>>>
30845>>>
30845>>>  // 2.Anazhthsh sto arxeio Witemcl
30845>>>  Clear WitemCL
30846>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30847>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30848>>>  Find Eq WitemCL By Index.1
30849>>>>
30849>>>  If (Found=1) Function_Return WitemCL.Client_Price
30852>>>
30852>>>  Function_Return 0
30853>>>End_Function
30854>>>
30854>>>
30854>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30856>>>
30856>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30857>>>
30857>>>  Integer iExodos iCheckDeop
30858>>>  Number nPoso nPct
30858>>>
30858>>>  Move (Num_Arguments=7) to iCheckDeop
30859>>>
30859>>>  Move 0 to nPoso
30860>>>  Move 0 to nPct
30861>>>  Move 0 to iExodos
30862>>>
30862>>>  Move (Trim(asItemCode))                 to asItemCode
30863>>>  Move (Trim(asClientID))                 to asClientID
30864>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30865>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30866>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30869>>>
30869>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30869>>>  If (iCheckDeop) Begin
30871>>>      Clear btnordd
30872>>>      Move asClientID   to btnordd.vclient_id
30873>>>      Move asCNCode     to btnordd.vcn_code
30874>>>      Move asWitemxCode to btnordd.vitem
30875>>>      Move 0            to btnordd.vactive
30876>>>      Move adHmnia      to btnordd.arxh_date
30877>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30878>>>>
30878>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30880>>>          move btnordd.vprice to nPoso
30881>>>          If (nPoso) Function_Return nPoso
30884>>>      End
30884>>>>
30884>>>  End
30884>>>>
30884>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
30884>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30884>>> // Clear Witemcld
30884>>> // Move asItemCode to Witemcld.Item_Code
30884>>> // Move asClientID to Witemcld.Client_Code
30884>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
30884>>> //                      (Witemcld.Client_Code= asClientID) And ;
30884>>> //                      (iExodos=0))
30884>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30884>>> //         Move 1 to iExodos
30884>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30884>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30884>>> //     End
30884>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30884>>> // Loop
30884>>> // If (iExodos) Begin
30884>>> //     If (nPoso) Function_Return nPoso
30884>>> //     Else Function_Return nPct
30884>>> // End
30884>>>
30884>>>
30884>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30884>>>  //Clear Witemxt
30884>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
30884>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30884>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
30884>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
30884>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
30884>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
30884>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
30884>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
30884>>>  //                     (iExodos=0))
30884>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30884>>>  //        Move 1 to iExodos
30884>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30884>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30884>>>  //    End
30884>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
30884>>>  //Loop
30884>>>  //If (iExodos) Begin
30884>>>  //    If (nPoso) Function_Return nPoso
30884>>>  //    Else Function_Return nPct
30884>>>  //End
30884>>>
30884>>>
30884>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30884>>>  //Clear WitemCL
30884>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
30884>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
30884>>>  //Find Eq WitemCL By Index.1
30884>>>  //If (Found=1) Function_Return WitemCL.Client_Price
30884>>>
30884>>>  Function_Return 0
30885>>>End_Function
30886>>>
30886>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30887>>>    String sEnter
30888>>>    Move '' to sEnter
30889>>>    Move (Trim(asStr)) to asStr
30890>>>    Append sEnter (Character(13)) (Character(10))
30892>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30893>>>    Function_return (Trim(asStr))
30894>>>End_function
30895>>>
30895>>>
30895>>>//end   of global functions and procedures
30895>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30895>>>>>USE AllEntSc
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>
30895>>>>>//AB-IgnoreEnd
30895>>>>>
30895>>>>>Object Wait is a ModalPanelSub
30897>>>>>
30897>>>>>    //AB-StoreTopStart
30897>>>>>
30897>>>>>    // How to Use It
30897>>>>>    // Get the maximum position of the bar
30897>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30897>>>>>    //
30897>>>>>    // Set the maximum position of the bar
30897>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30897>>>>>    //
30897>>>>>    // Start Bar Progress from beginning
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30897>>>>>    //
30897>>>>>    // End Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30897>>>>>    //
30897>>>>>    // Update Bar Progress
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30897>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30897>>>>>    // When you want the update to be done for every i (this is slower)
30897>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30897>>>>>    //
30897>>>>>    // Display Buttons on the object
30897>>>>>    // Set Button_State of (Wait(Self)) to False/True
30897>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30897>>>>>    //
30897>>>>>    // Initialization of the Progress Bar
30897>>>>>    // Send Popup to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Deactivation of the Progress Bar
30897>>>>>    // Send Deactivate to (Wait(Self))
30897>>>>>    //
30897>>>>>    // Message during the process
30897>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30897>>>>>    //
30897>>>>>    // Extra Info for button "Info >>"
30897>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30897>>>>>    // If sFile<>'' then reads the contents of the file
30897>>>>>    // Else Fills the Edit with the string of sDetail
30897>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30897>>>>>    //
30897>>>>>    // Remarks instead of Progress Bar
30897>>>>>    // Set Button_State of (Wait(Self))     to False
30897>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30897>>>>>    // Update During Process
30897>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30897>>>>>
30897>>>>>    //AB-StoreTopEnd
30897>>>>>
30897>>>>>    Set Exit_Application_Local_State to FALSE
30898>>>>>    Set Modal_State to FALSE
30899>>>>>    Set Popup_State to TRUE
30900>>>>>    Set Border_Style to Border_Thick
30901>>>>>    Set Minimize_Icon to FALSE
30902>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30903>>>>>    Set Size to 138 256
30904>>>>>
30904>>>>>    //AB-DDOStart
30904>>>>>
30904>>>>>
30904>>>>>    //AB-DDOEnd
30904>>>>>
30904>>>>>    Object WaitBar is a ProgressBarSub
30906>>>>>
30906>>>>>        //AB-StoreTopStart
30906>>>>>
30906>>>>>        //AB-StoreTopEnd
30906>>>>>
30906>>>>>        Set Size to 21 243
30907>>>>>        Set Location to 7 4
30908>>>>>
30908>>>>>        //AB-StoreStart
30908>>>>>        Send DoRegSize  self smTopRight
30909>>>>>        //AB-StoreEnd
30909>>>>>
30909>>>>>    End_Object
30910>>>>>
30910>>>>>    Object WaitText is a TextBoxSub
30912>>>>>
30912>>>>>        //AB-StoreTopStart
30912>>>>>
30912>>>>>        //AB-StoreTopEnd
30912>>>>>
30912>>>>>        Set Enabled_State to TRUE
30913>>>>>        Set Label to "Processing"
30914>>>>>        Set FontSize to 4 0
30915>>>>>        Set Size to 10 81
30916>>>>>        Set Location to 36 5
30917>>>>>
30917>>>>>        //AB-StoreStart
30917>>>>>
30917>>>>>        //AB-StoreEnd
30917>>>>>
30917>>>>>    End_Object
30918>>>>>
30918>>>>>    Object bnCancel is a ButtonSub
30920>>>>>
30920>>>>>        //AB-StoreTopStart
30920>>>>>
30920>>>>>        //AB-StoreTopEnd
30920>>>>>
30920>>>>>        Set Default_State to TRUE
30921>>>>>        Set Label to "OK"
30922>>>>>        Set Location to 34 143
30923>>>>>
30923>>>>>        //AB-StoreStart
30923>>>>>
30923>>>>>        Procedure OnClick
30925>>>>>             Send Deactivate to (Wait(Self))
30926>>>>>        End_Procedure
30927>>>>>
30927>>>>>        Send DoRegAlign self amTopRight
30928>>>>>        //AB-StoreEnd
30928>>>>>
30928>>>>>    End_Object
30929>>>>>
30929>>>>>    Object bnDetail is a ButtonSub
30931>>>>>
30931>>>>>        //AB-StoreTopStart
30931>>>>>
30931>>>>>        //AB-StoreTopEnd
30931>>>>>
30931>>>>>        Set Focus_Mode to Pointer_Only
30932>>>>>        Set Label to "Info >>"
30933>>>>>        Set Location to 34 197
30934>>>>>
30934>>>>>        //AB-StoreStart
30934>>>>>
30934>>>>>        Procedure OnClick
30936>>>>>            Delegate Send Show_Details False
30938>>>>>        End_Procedure
30939>>>>>
30939>>>>>        Send DoRegAlign self amTopRight
30940>>>>>        //AB-StoreEnd
30940>>>>>
30940>>>>>    End_Object
30941>>>>>
30941>>>>>    Object LineControlSub1 is a LineControlSub
30943>>>>>
30943>>>>>        //AB-StoreTopStart
30943>>>>>
30943>>>>>        //AB-StoreTopEnd
30943>>>>>
30943>>>>>        Set Size to 2 243
30944>>>>>        Set Location to 54 4
30945>>>>>
30945>>>>>        //AB-StoreStart
30945>>>>>
30945>>>>>        Send DoRegSize  self smTopRight
30946>>>>>        //AB-StoreEnd
30946>>>>>
30946>>>>>    End_Object
30947>>>>>
30947>>>>>    Object WaitEdit is a editSub
30949>>>>>
30949>>>>>        //AB-StoreTopStart
30949>>>>>
30949>>>>>        //AB-StoreTopEnd
30949>>>>>
30949>>>>>        Set Enabled_State to FALSE
30950>>>>>        Set Read_Only_State to TRUE
30951>>>>>        Set Size to 58 243
30952>>>>>        Set Location to 60 4
30953>>>>>        Set Color to clWhite
30954>>>>>
30954>>>>>        //AB-StoreStart
30954>>>>>
30954>>>>>        Send DoRegSize Self amBottomRight
30955>>>>>        Delegate Set Size to 66 256
30957>>>>>
30957>>>>>        //AB-StoreEnd
30957>>>>>
30957>>>>>    End_Object
30958>>>>>
30958>>>>>    Object oTxtAntiBar is a TextBoxSub
30960>>>>>        Set Enabled_State to TRUE
30961>>>>>        Set Visible_State to FALSE
30962>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30963>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30964>>>>>        Set Auto_Size_State to FALSE
30965>>>>>        Set FontWeight to 600
30966>>>>>        Set FontSize to 4 0
30967>>>>>        Set Size to 10 209
30968>>>>>        Set Location to 10 4
30969>>>>>        Set TextColor to clNavy
30970>>>>>    End_Object
30971>>>>>
30971>>>>>
30971>>>>>    //AB-StoreStart
30971>>>>>    Property Integer piWaitSize  Public (Size(Self))
30973>>>>>    Property Integer piPrevSize  Public (Size(Self))
30975>>>>>    Property Integer piState     Public False
30977>>>>>
30977>>>>>    Set Locate_Mode to Center_On_Screen
30978>>>>>    Set Destroy_Object_State to True
30979>>>>>
30979>>>>>    Procedure Show_Details Integer bAlways
30981>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30982>>>>>        Local String sLabel
30982>>>>>        Get Size                to liSize
30983>>>>>        Get piState             to bState
30984>>>>>        Get piWaitSize          to liOriSize
30985>>>>>        Move (Hi(liSize))       to hiSize
30986>>>>>        Move (Low(liSize))      to lowSize
30987>>>>>        Move (Hi(liOriSize))    to hiOriSize
30988>>>>>        If (bAlways) Begin
30990>>>>>            Set piState         to False
30991>>>>>            Move 0              to bState
30992>>>>>        End
30992>>>>>>
30992>>>>>        If bState Begin
30994>>>>>             Set Size to hiOriSize lowSize
30995>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30996>>>>>        End
30996>>>>>>
30996>>>>>        Else Begin
30997>>>>>             Set Size to 138 lowSize
30998>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30999>>>>>        End
30999>>>>>>
30999>>>>>        Set piState to (1-bState)
31000>>>>>    End_Procedure
31001>>>>>
31001>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
31003>>>>>       If (bState) Begin
31005>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31008>>>>>       End
31008>>>>>>
31008>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
31010>>>>>    End_Procedure
31011>>>>>
31011>>>>>    Procedure DoInitialize_WaitBar
31013>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
31014>>>>>    End_Procedure
31015>>>>>
31015>>>>>    Procedure DoTerminate_WaitBar
31017>>>>>        Local Integer iMax
31018>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
31019>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
31020>>>>>    End_Procedure
31021>>>>>
31021>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
31023>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
31024>>>>>    End_Procedure
31025>>>>>
31025>>>>>    Function Bar_Maximum_Position Returns Integer
31027>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
31028>>>>>    End_Function
31029>>>>>
31029>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
31031>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
31032>>>>>    End_Procedure
31033>>>>>
31033>>>>>    Function Bar_Minimum_Position Returns Integer
31035>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
31036>>>>>    End_Function
31037>>>>>
31037>>>>>    Procedure Set Bar_Step_Value Integer iStep
31039>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
31040>>>>>    End_Procedure
31041>>>>>
31041>>>>>    Function Bar_Step_Value Returns Integer
31043>>>>>        Function_Return (Step_Value(WaitBar(Self)))
31044>>>>>    End_Function
31045>>>>>
31045>>>>>    Procedure Set Wait_Message String sMessage
31047>>>>>        Set Value of (WaitText(Self)) to sMessage
31048>>>>>    End_Procedure
31049>>>>>
31049>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
31051>>>>>        Local Integer liEditId
31052>>>>>        Move (WaitEdit(Self)) to liEditId
31053>>>>>        If bInitData Send Delete_Data to liEditId
31056>>>>>        If sFile ne "" Begin
31058>>>>>           Send Read to liEditId sFile
31059>>>>>           Send Beginning_Of_Data to liEditId
31060>>>>>        End
31060>>>>>>
31060>>>>>        Else Begin
31061>>>>>           Send Insert to liEditId sDetail
31062>>>>>        End
31062>>>>>>
31062>>>>>    End_Procedure
31063>>>>>
31063>>>>>    Procedure OnResize
31065>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
31066>>>>>        Get Size to liPrevSize
31067>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
31068>>>>>        Forward Send OnResize
31070>>>>>        Get Location of (WaitEdit(Self)) to liLoc
31071>>>>>        Move (Hi(liLoc)) to liHiLoc
31072>>>>>        Get piState to bState
31073>>>>>        Get Size to liSize
31074>>>>>        Move (Hi(liSize)) to liHiSize
31075>>>>>        If (liHiSize > (liHiLoc +30)) Begin
31077>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
31078>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
31081>>>>>        End
31081>>>>>>
31081>>>>>        Else Begin
31082>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
31083>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
31086>>>>>        End
31086>>>>>>
31086>>>>>    End_Procedure
31087>>>>>
31087>>>>>    Procedure Set Button_State Integer bState
31089>>>>>        If bState Begin
31091>>>>>            Set Caption_Bar to True
31092>>>>>            Set Size to 66 256
31093>>>>>        End
31093>>>>>>
31093>>>>>        Else Begin
31094>>>>>            Set Caption_Bar to False
31095>>>>>            Set Size to 38 256
31096>>>>>        End
31096>>>>>>
31096>>>>>    End_Procedure
31097>>>>>
31097>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
31099>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
31100>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31101>>>>>        If (bState = 0) Begin
31103>>>>>            Set Size to 24 256
31104>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31105>>>>>        End
31105>>>>>>
31105>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31108>>>>>    End_Procedure
31109>>>>>
31109>>>>>    Procedure Deactivating integer search_mode Returns Integer
31111>>>>>        local integer rval
31112>>>>>        Forward Get MSG_Deactivating search_mode to rval
31114>>>>>        Set Modal_State of (Wait(Self)) to False
31115>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31116>>>>>        Procedure_Return rval
31117>>>>>    End_Procedure
31118>>>>>
31118>>>>>    Procedure UpdateWait String sMsg
31120>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31121>>>>>    End_Procedure
31122>>>>>
31122>>>>>
31122>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31124>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31125>>>>>    End_Procedure
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>
31126>>>>>    //AB-StoreEnd
31126>>>>>
31126>>>>>End_Object
31127>>>>>
31127>>>>>
31127>>>>>//AB-StoreStart
31127>>>>>
31127>>>>>//AB-StoreEnd
31127>>>>>
31127>>>>>//AB/ End_Object    // prj
31127>>>
31127>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31127>>>//AB/ Project Calendar
31127>>>//AB/ Object prj is a Lookup_Project
31127>>>//AB/     Set ProjectName to "Calendar"
31127>>>//AB/     Set ProjectFileName to "Calendar.sl"
31127>>>
31127>>>// Project Object Structure
31127>>>//   oCalendar is a dbModalPanel
31127>>>//     Container3d1 is a Container3d
31127>>>//       Grid2 is a Grid
31127>>>//       Textbox2 is a Textbox
31127>>>//       Textbox3 is a Textbox
31127>>>//       Textbox4 is a Textbox
31127>>>//       Textbox5 is a Textbox
31127>>>//       Textbox6 is a Textbox
31127>>>//       Textbox7 is a Textbox
31127>>>//       Textbox8 is a Textbox
31127>>>//       LineControl1 is a LineControl
31127>>>//       Container3d2 is a Container3d
31127>>>//         oRght is a BitmapContainer
31127>>>//         oLeft is a BitmapContainer
31127>>>//         oMonth is a Textbox
31127>>>//           oSelectMonth is a FloatingPopupMenu
31127>>>//         oYear is a Textbox
31127>>>//         oSelectYear is a Form
31127>>>//     BitmapContainer3 is a BitmapContainer
31127>>>//     oToday is a Textbox
31127>>>
31127>>>// Register all objects
31127>>>Register_Object BitmapContainer3
31127>>>Register_Object Container3d1
31127>>>Register_Object Container3d2
31127>>>Register_Object Grid2
31127>>>Register_Object LineControl1
31127>>>Register_Object oCalendar
31127>>>Register_Object oLeft
31127>>>Register_Object oMonth
31127>>>Register_Object oRght
31127>>>Register_Object oSelectMonth
31127>>>Register_Object oSelectYear
31127>>>Register_Object oToday
31127>>>Register_Object oYear
31127>>>Register_Object Textbox2
31127>>>Register_Object Textbox3
31127>>>Register_Object Textbox4
31127>>>Register_Object Textbox5
31127>>>Register_Object Textbox6
31127>>>Register_Object Textbox7
31127>>>Register_Object Textbox8
31127>>>
31127>>>
31127>>>
31127>>>//AB-StoreTopStart
31127>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31127>>>>>// **********************************************************************
31127>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31127>>>>>//
31127>>>>>// by Sture Andersen (sa1@vd.dk)
31127>>>>>//
31127>>>>>// The file contains a number of global functions for manipulating
31127>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31127>>>>>// This package is public domain.
31127>>>>>//
31127>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31127>>>>>// listing the functions and their use.
31127>>>>>//
31127>>>>>//
31127>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31127>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31127>>>>>//                         - Addition of popup_calendar to VDF.
31127>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31127>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31127>>>>>//         Thu  10-07-1997 - Fixes.
31127>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31127>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31127>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31127>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31127>>>>>//                           ItemSysdate added.
31127>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31127>>>>>//                           FieldSysdate added.
31127>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31127>>>>>//                           Module_Compile_Time added.
31127>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31127>>>>>//                           responds if entry_state of the calling object
31127>>>>>//                           is true (VDF version). (No apparent effect)
31127>>>>>//         Sat  28-03-1998 - Added the following functions:
31127>>>>>//                             TS_SysTime      TS_ExtractDate
31127>>>>>//                             TS_ExtractTime  TS_ConvertToString
31127>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31127>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31127>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31127>>>>>//                           Module_Start_Time added.
31127>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31127>>>>>//         Mon  12-10-1998 - Portuguese added
31127>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31127>>>>>//         Tue  29-12-1998 - Function DateAsString added
31127>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson
31127>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31127>>>>>//                           Kjetil Johanson (again)
31127>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31127>>>>>//                           class (Continue->TS_Continue and Pause->
31127>>>>>//                           TS_Pause)
31127>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31127>>>>>//                           added.
31127>>>>>//                         - Procedures DateCurrentSeparator and
31127>>>>>//                           DateCurrentFormat added.
31127>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31127>>>>>//                           Jan1st1000 and Jan1st100
31127>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31127>>>>>//                           to trap 3 digit years.
31127>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31127>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31127>>>>>//                         - Fixed error in TS_ConvertToString
31127>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31127>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31127>>>>>//                           from the calendar to forms with no form_margin.
31127>>>>>//         Tue  07-09-1999 - Added function DateAsText
31127>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31127>>>>>//                           in combination with y2k.
31127>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31127>>>>>//                         - Existing function DateAsString renamed to
31127>>>>>//                           DateToString.
31127>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31127>>>>>//                           would result in seeding the calendar on year 100.
31127>>>>>//                           This error was caused by the fact that VDF 4
31127>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31127>>>>>//                           command returns 03-01-100
31127>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31127>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31127>>>>>//
31127>>>>>// NOTE:  There is language dependent string constants in this file.
31127>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31127>>>>>//        norwegian, spanish, german and portuguese
31127>>>>>//
31127>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31127>>>>>//
31127>>>>>// ***********************************************************************
31127>>>>>
31127>>>>>Use ui
31127>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31127>>>>>>>// Use Language     // Default language setup
31127>>>>>>>// Sets default languange if not set by compiler command line
31127>>>>>>>
31127>>>>>>>define lng_dutch      for 131
31127>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_spanish    for 134
31127>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>define lng_english    for 144
31127>>>>>>>define lng_danish     for 145
31127>>>>>>>define lng_swedish    for 146
31127>>>>>>>define lng_norwegian  for 147
31127>>>>>>>define lng_Greek    for 148
31127>>>>>>>define lng_german     for 149
31127>>>>>>>define lng_portuguese for 155
31127>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>define lng_default for !@
31127>>>>>>>
31127>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31127>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31127>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31127>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31127>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31127>>>>>>>
31127>>>>>>>//  FOR_EX (extended FOR command)
31127>>>>>>>//  -----------------------------
31127>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31127>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31127>>>>>>>//> you need to do a decremental loop.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>//  DESKTOP_SECTION
31127>>>>>>>//  ---------------
31127>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31127>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31127>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31127>>>>>>>
31127>>>>>>>
31127>>>>>>>
31127>>>>>
31127>>>>>// Switches
31127>>>>>
31127>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31127>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31127>>>>>
31127>>>>> define t.calendar.year           for "Year"
31127>>>>> define t.calendar.month          for "Month"
31127>>>>> define t.calendar.day            for "Day"
31127>>>>> define t.calendar.week           for "Wk."
31127>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31127>>>>> define t.calendar.Monday         for "Monday"
31127>>>>> define t.calendar.Tuesday        for "Tuesday"
31127>>>>> define t.calendar.Wednesday      for "Wednesday"
31127>>>>> define t.calendar.Thursday       for "Thursday"
31127>>>>> define t.calendar.Friday         for "Friday"
31127>>>>> define t.calendar.Saturday       for "Saturday"
31127>>>>> define t.calendar.Sunday         for "Sunday"
31127>>>>> define t.calendar.January        for "January"
31127>>>>> define t.calendar.February       for "February"
31127>>>>> define t.calendar.March          for "March"
31127>>>>> define t.calendar.April          for "April"
31127>>>>> define t.calendar.May            for "May"
31127>>>>> define t.calendar.June           for "June"
31127>>>>> define t.calendar.July           for "July"
31127>>>>> define t.calendar.August         for "August"
31127>>>>> define t.calendar.September      for "September"
31127>>>>> define t.calendar.October        for "October"
31127>>>>> define t.calendar.November       for "November"
31127>>>>> define t.calendar.December       for "December"
31127>>>>> define t.calendar.ok             for "OK"
31127>>>>> define t.calendar.Cancel         for "Cancel"
31127>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31127>>>>>
31127>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31127>>>>>define Jan1st1900          for 693975
31127>>>>>define Jan1st2000          for 730500
31127>>>>>define Jan1st1000          for 365250
31127>>>>>define Jan1st105           for 38352
31127>>>>>define Jan1st100           for 36525
31127>>>>>
31127>>>>>enumeration_list // Date Segments
31127>>>>>  define DS_DAY
31127>>>>>  define DS_WEEK
31127>>>>>  define DS_MONTH
31127>>>>>  define DS_YEAR
31127>>>>>end_enumeration_list
31127>>>>>
31127>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31127>>>>>
31127>>>>>procedure DateDecompose global date date# //very internal!!
31128>>>>>  local integer pos1# pos2# format#
31129>>>>>  local string str# sep#
31129>>>>>  get_attribute DF_DATE_FORMAT to format#
31132>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31135>>>>>  character pos1# to sep#                  // end overload
31136>>>>>>
31136>>>>>  move date# to str#
31137>>>>>  replace sep# in str# with "$"
31139>>>>>  move strmark to pos1#
31140>>>>>  if [found] begin
31142>>>>>    replace sep# in str# with "$"
31144>>>>>    move strmark to pos2#
31145>>>>>  end
31145>>>>>>
31145>>>>>  else begin
31146>>>>>    move 0 to Dates$Year
31147>>>>>    move 0 to Dates$Month
31148>>>>>    move 0 to Dates$Day
31149>>>>>  end
31149>>>>>>
31149>>>>>  [ found] begin
31151>>>>>>
31151>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31155>>>>>    if format# eq DF_DATE_USA begin
31157>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31160>>>>>>
31160>>>>>          left str# to Dates$Month  (pos1#-1)
31162>>>>>>
31162>>>>>    end
31162>>>>>>
31162>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31166>>>>>
31166>>>>>    if format# eq DF_DATE_MILITARY begin
31168>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31171>>>>>>
31171>>>>>          left str# to Dates$Year   (pos1#-1)
31173>>>>>>
31173>>>>>    end
31173>>>>>>
31173>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31177>>>>>  end
31177>>>>>>
31177>>>>>end_procedure
31178>>>>>
31178>>>>>function DateCompose global integer day# integer month# integer year# returns date
31179>>>>>  local integer format#
31180>>>>>  local date date#
31180>>>>>  local string sep#
31180>>>>>  ifnot (day#*month#*year#) function_return 0
31183>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31186>>>>>  character format# to sep#                  // end overload
31187>>>>>>
31187>>>>>  get_attribute DF_DATE_FORMAT to format#
31190>>>>>  if day# gt 28 begin
31192>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31195>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31198>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31201>>>>>    send DateDecompose date#
31202>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31205>>>>>  end
31205>>>>>>
31205>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31208>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31211>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31212>>>>>end_function
31213>>>>>
31213>>>>>function DateFormatName global integer format# returns string
31214>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31217>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31220>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31223>>>>>end_function
31224>>>>>
31224>>>>>function DateCurrentSeparator global returns string
31225>>>>>  local integer rval#
31226>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31229>>>>>  function_return (character(rval#))
31230>>>>>end_function
31231>>>>>
31231>>>>>function DateCurrentFormat global returns integer
31232>>>>>  local integer rval#
31233>>>>>  get_attribute DF_DATE_FORMAT to rval#
31236>>>>>  function_return rval#
31237>>>>>end_function
31238>>>>>
31238>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31239>>>>>  local string rval# letter#
31240>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31243>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31246>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31249>>>>>  left t.calendar.year to letter# 1
31251>>>>>>
31251>>>>>  replace "1" in rval# with letter#
31253>>>>>  replace "1" in rval# with letter#
31255>>>>>  ifnot long# move "" to letter#
31258>>>>>  move (replaces("1",rval#,letter#)) to rval#
31259>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31260>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31261>>>>>  if sep# eq "" begin
31263>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31266>>>>>    character format# to sep#
31267>>>>>>
31267>>>>>  end
31267>>>>>>
31267>>>>>  move (replaces("4",rval#,sep#)) to rval#
31268>>>>>  function_return rval#
31269>>>>>end_function
31270>>>>>
31270>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31271>>>>>  local integer sep_len# day# month# year#
31272>>>>>  move (length(sep#)) to sep_len#
31273>>>>>  if four_digit_year# move 4 to four_digit_year#
31276>>>>>  else move 2 to four_digit_year#
31278>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31280>>>>>    move (mid(date#,2,1)) to day#
31281>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31282>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31283>>>>>  end
31283>>>>>>
31283>>>>>  if format# eq DF_DATE_USA begin // MDY
31285>>>>>    move (mid(date#,2,1)) to month#
31286>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31287>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31288>>>>>  end
31288>>>>>>
31288>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31290>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31291>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31292>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31293>>>>>  end
31293>>>>>>
31293>>>>>  function_return (DateCompose(day#,month#,year#))
31294>>>>>end_function
31295>>>>>
31295>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31296>>>>>  local string rval# day# month# year#
31297>>>>>  get Date2to4 date# to date#
31298>>>>>  if (integer(date#)) begin
31300>>>>>    send DateDecompose date#
31301>>>>>    move Dates$Day to day#
31302>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31306>>>>>    move Dates$Month to month#
31307>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31311>>>>>    move Dates$Year to year#
31312>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31315>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31318>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31321>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31324>>>>>  end
31324>>>>>>
31324>>>>>  function_return rval#
31325>>>>>end_function
31326>>>>>
31326>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31326>>>>>// Use function DateToString instead.
31326>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31327>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31328>>>>>end_function
31329>>>>>
31329>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31330>>>>>  if (date#=0) function_return 0
31333>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31336>>>>>  if (segment#<>DS_DAY) begin // months or years
31338>>>>>    send DateDecompose date#
31339>>>>>    if segment# eq DS_MONTH begin //months
31341>>>>>      move (Dates$Month+amount#) to Dates$Month
31342>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31345>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31346>>>>>    end //years:
31346>>>>>>
31346>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31349>>>>>  end
31349>>>>>>
31349>>>>>  else function_return (date#+amount#) //days
31351>>>>>end_function
31352>>>>>
31352>>>>>function DateSegment global date date# integer segment# returns integer
31353>>>>>  send DateDecompose date#
31354>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31357>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31360>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31363>>>>>end_function
31364>>>>>
31364>>>>>function DateToInteger global date date# returns integer
31365>>>>>  send DateDecompose date#
31366>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31367>>>>>end_function
31368>>>>>
31368>>>>>function FirstDayInMonth global date date# returns date
31369>>>>>  local integer month# year#
31370>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31371>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31372>>>>>  function_return (DateCompose(1,month#,year#))
31373>>>>>end_function
31374>>>>>
31374>>>>>function LastDayInMonth global date date# returns date
31375>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31376>>>>>  function_return (FirstDayInMonth(date#)-1)
31377>>>>>end_function
31378>>>>>
31378>>>>>function FirstDayInYear global date date# returns date
31379>>>>>  local integer year#
31380>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31381>>>>>  function_return (DateCompose(1,1,year#))
31382>>>>>end_function
31383>>>>>
31383>>>>>function LastDayInYear global date date# returns date
31384>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31385>>>>>  function_return (FirstDayInYear(date#)-1)
31386>>>>>end_function
31387>>>>>
31387>>>>>// Prior to 18/1-99 version of DateWeekNumber
31387>>>>>//function DateWeekNumber global date date# returns integer
31387>>>>>//  local integer week# first_wd# day_of_year# year#
31387>>>>>//  if (date#=0) function_return 0
31387>>>>>//  get Date2to4 date# to date#
31387>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31387>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31387>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31387>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31387>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31387>>>>>//  else move 0 to week#
31387>>>>>//  if first_wd# le 4 increment week#
31387>>>>>//  if week# gt 52 begin
31387>>>>>//    move 1 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  if week# eq 0 begin
31387>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31387>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31387>>>>>//    move 52 to week#
31387>>>>>//    if first_wd# eq 4 move 53 to week#
31387>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31387>>>>>//  end
31387>>>>>//  function_return week#
31387>>>>>//end_function
31387>>>>>
31387>>>>>function DateWeekNumber global date date# returns integer
31388>>>>>  local integer week# first_wd# day_of_year# year# wd#
31389>>>>>  if (date#=0) function_return 0
31392>>>>>  get Date2to4 date# to date#
31393>>>>>  // Leap-year test for actual or previous year
31393>>>>>  // Year# only used for selection between 52 and
31393>>>>>  // Therefore get year# from the first day of actual week
31393>>>>>  get DateDayNumber date# to wd#
31394>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31395>>>>>
31395>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31396>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31397>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31398>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31401>>>>>  else move 0 to week#
31403>>>>>  if first_wd# le 4 increment week#
31406>>>>>  if week# gt 52 begin
31408>>>>>    move 1 to week#
31409>>>>>    if first_wd# eq 4 move 53 to week#
31412>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31419>>>>>  end
31419>>>>>>
31419>>>>>  if week# eq 0 begin
31421>>>>>    // Week 52 or 53
31421>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31422>>>>>    move 52 to week#
31423>>>>>    if first_wd# eq 4 move 53 to week#
31426>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31433>>>>>  end
31433>>>>>>
31433>>>>>  function_return week#
31434>>>>>end_function
31435>>>>>
31435>>>>>function DayName global integer int# returns string
31436>>>>>  if int# eq 1 function_return t.calendar.Monday
31439>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31442>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31445>>>>>  if int# eq 4 function_return t.calendar.Thursday
31448>>>>>  if int# eq 5 function_return t.calendar.Friday
31451>>>>>  if int# eq 6 function_return t.calendar.Saturday
31454>>>>>  if int# eq 7 function_return t.calendar.Sunday
31457>>>>>  function_return ""
31458>>>>>end_function
31459>>>>>
31459>>>>>function DateDayNumber global date date# returns integer
31460>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31461>>>>>  get Date2to4 date# to date#
31462>>>>>  move date# to rval#
31463>>>>>  if rval# begin
31465>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31468>>>>>    move (rval#-((rval#/7)*7)) to rval#
31469>>>>>    if rval# eq 0 move 7 to rval#
31472>>>>>  end
31472>>>>>>
31472>>>>>  function_return rval#
31473>>>>>end_function
31474>>>>>
31474>>>>>function DateDayName global date date# returns string
31475>>>>>  function_return (DayName(DateDayNumber(date#)))
31476>>>>>end_function
31477>>>>>
31477>>>>>function YearMaxWeek global integer year# returns integer
31478>>>>>  local integer wk1# wk2#
31479>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31480>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31481>>>>>  function_return (wk1# max wk2#)
31482>>>>>end_function
31483>>>>>
31483>>>>>function WeekToDate global integer year# integer week# returns date
31484>>>>>  local date date#
31485>>>>>  move (DateCompose(1,1,year#)) to date#
31486>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31489>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31490>>>>>  function_return (week#-1*7+date#)
31491>>>>>end_function
31492>>>>>
31492>>>>>function MonthName global integer int# returns string
31493>>>>>  if int# eq  1 function_return t.calendar.January
31496>>>>>  if int# eq  2 function_return t.calendar.February
31499>>>>>  if int# eq  3 function_return t.calendar.March
31502>>>>>  if int# eq  4 function_return t.calendar.April
31505>>>>>  if int# eq  5 function_return t.calendar.May
31508>>>>>  if int# eq  6 function_return t.calendar.June
31511>>>>>  if int# eq  7 function_return t.calendar.July
31514>>>>>  if int# eq  8 function_return t.calendar.August
31517>>>>>  if int# eq  9 function_return t.calendar.September
31520>>>>>  if int# eq 10 function_return t.calendar.October
31523>>>>>  if int# eq 11 function_return t.calendar.November
31526>>>>>  if int# eq 12 function_return t.calendar.December
31529>>>>>  function_return ""
31530>>>>>end_function
31531>>>>>
31531>>>>>function DateMonthName global date date# returns string
31532>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31533>>>>>end_function
31534>>>>>
31534>>>>>function DateAsText global date date# string format# returns string
31535>>>>>  if date# eq 0 function_return ""
31538>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31539>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31540>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31541>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31542>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31543>>>>>  function_return format#
31544>>>>>end_function
31545>>>>>
31545>>>>>function Year2to4 global integer year# returns integer
31546>>>>>  local integer epoch_value#
31547>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31548>>>>>  if year# lt 100 begin
31550>>>>>    if year# gt epoch_value# function_return (year#+1900)
31553>>>>>    function_return (year#+2000)
31554>>>>>  end
31554>>>>>>
31554>>>>>  function_return year# // No conversion done!
31555>>>>>end_function
31556>>>>>
31556>>>>>function Date2to4 global date date# returns date
31557>>>>>  local integer epoch_value#
31558>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31559>>>>>  if date# gt 0 begin // Only if there is a date to convert
31561>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31563>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31566>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31567>>>>>    end
31567>>>>>>
31567>>>>>    function_return date# // No conversion done!
31568>>>>>  end
31568>>>>>>
31568>>>>>end_function
31569>>>>>
31569>>>>>function Date4to2 global date date# returns date
31570>>>>>  local integer epoch_value# year#
31571>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31572>>>>>  if date# gt 0 begin // Only if there is a date to convert
31574>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31575>>>>>    if year# ge 100 begin // Only then conversion is needed!
31577>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31579>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31582>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31584>>>>>      end
31584>>>>>>
31584>>>>>      else error 301 "Date is out of epoch range"
31586>>>>>    end
31586>>>>>>
31586>>>>>  end
31586>>>>>>
31586>>>>>  function_return date# // No conversion done!
31587>>>>>end_function
31588>>>>>
31588>>>>>function dSysDate global returns date
31589>>>>>  local date date#
31590>>>>>  sysdate4 date#
31591>>>>>  function_return date#
31592>>>>>end_function
31593>>>>>
31593>>>>>function iSysYear global returns integer
31594>>>>>  local date date#
31595>>>>>  sysdate4 date#
31596>>>>>  function_return (DateSegment(date#,DS_YEAR))
31597>>>>>end_function
31598>>>>>
31598>>>>>procedure ItemSysdate for desktop integer itm#
31599>>>>>  local date date#
31600>>>>>  get value item itm# to date#
31601>>>>>  if date# eq 0 begin
31603>>>>>    sysdate4 date#
31604>>>>>    set changed_value item itm# to date#
31605>>>>>  end
31605>>>>>>
31605>>>>>end_procedure
31606>>>>>
31606>>>>>procedure ItemDate2to4 for desktop integer itm#
31607>>>>>  local integer year#
31608>>>>>  local date date# new_date#
31608>>>>>  get value item itm# to date#
31609>>>>>
31609>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31610>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31613>>>>>  else move date# to new_date#
31615>>>>>
31615>>>>>  move (Date2to4(new_date#)) to new_date#
31616>>>>>  move (DateSegment(new_date#,3)) to year#
31617>>>>>  if (year#>99 and year#<1000) begin
31619>>>>>    error 15 // Illegal entry in this window
31620>>>>>>
31620>>>>>    procedure_return 1
31621>>>>>  end
31621>>>>>>
31621>>>>>  if new_date# ne date# set value item itm# to new_date#
31624>>>>>end_procedure
31625>>>>>
31625>>>>>procedure ItemYear2to4 for desktop integer itm#
31626>>>>>  local integer year# new_year#
31627>>>>>  get value item itm# to year#
31628>>>>>  if (year#>99 and year#<1000) begin
31630>>>>>    error 15 // Illegal entry in this window
31631>>>>>>
31631>>>>>    procedure_return 1
31632>>>>>  end
31632>>>>>>
31632>>>>>  move (Year2to4(year#)) to new_year#
31633>>>>>  if new_year# ne year# set value item itm# to new_year#
31636>>>>>end_procedure
31637>>>>>
31637>>>>> procedure FieldSysdate for DataDictionary integer fld#
31638>>>>>   local date date#
31639>>>>>   get field_current_value fld# to date#
31640>>>>>   if date# eq 0 begin
31642>>>>>     sysdate4 date#
31643>>>>>     set field_changed_value fld# to date#
31644>>>>>   end
31644>>>>>>
31644>>>>> end_procedure
31645>>>>>
31645>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31646>>>>>   local integer year#
31647>>>>>   local date date# new_date#
31647>>>>>   get field_current_value fld# to date#
31648>>>>>
31648>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31649>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31652>>>>>   else move date# to new_date#
31654>>>>>
31654>>>>>   move (Date2to4(new_date#)) to new_date#
31655>>>>>   move (DateSegment(new_date#,3)) to year#
31656>>>>>   if (year#>99 and year# <=999) begin
31658>>>>>     error 15 // Illegal entry in this window
31659>>>>>>
31659>>>>>     procedure_return 1
31660>>>>>   end
31660>>>>>>
31660>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31663>>>>> end_procedure
31664>>>>>
31664>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31665>>>>>   local integer year# new_year# changed#
31666>>>>>   get field_current_value fld# to year#
31667>>>>>   get field_changed_state fld# to changed#
31668>>>>>   if changed# begin
31670>>>>>     if (year#>99 and year#<1000) begin
31672>>>>>       error 15 // Illegal entry in this window
31673>>>>>>
31673>>>>>       procedure_return 1
31674>>>>>     end
31674>>>>>>
31674>>>>>     move (Year2to4(year#)) to new_year#
31675>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31678>>>>>   end
31678>>>>>>
31678>>>>> end_procedure
31679>>>>>
31679>>>>> function SysDate global returns date
31680>>>>>   function_return (dSysDate())
31681>>>>> end_function
31682>>>>>
31682>>>>>function sSysTime global returns string
31683>>>>>  local integer h# m# s#
31684>>>>>  sysdate4 h# h# m# s#
31688>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31689>>>>>end_function
31690>>>>>
31690>>>>>function TS_SysTime global returns number
31691>>>>>  local integer d# h# m# s#
31692>>>>>  sysdate4 d# h# m# s#
31696>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31697>>>>>end_function
31698>>>>>
31698>>>>>//> This function returns a TS value composed from the date and time
31698>>>>>//> passed to it. Note that the time variable must be of the format
31698>>>>>//> "hh:mm:ss".
31698>>>>>function TS_Compose global date date# string time# returns number
31699>>>>>  local integer h# m# s#
31700>>>>>  left time# to h# 2
31702>>>>>>
31702>>>>>  mid time# to m# 2 4
31705>>>>>>
31705>>>>>  mid time# to s# 2 7
31708>>>>>>
31708>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31709>>>>>end_function
31710>>>>>
31710>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31711>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31712>>>>>end_function
31713>>>>>
31713>>>>>function TS_ExtractDate global number time# returns date
31714>>>>>  function_return (time#/86400) // 86400=24*60*60
31715>>>>>end_function
31716>>>>>
31716>>>>>function TS_ExtractTime global number time# returns string
31717>>>>>  local integer h# m# s#
31718>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31719>>>>>  move (s#/3600) to h#
31720>>>>>  move (s#-(h#*3600)) to s#
31721>>>>>  move (s#/60) to m#
31722>>>>>  move (s#-(m#*60)) to s#
31723>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31724>>>>>end_function
31725>>>>>
31725>>>>>function TS_ConvertToString global number time# returns string
31726>>>>>  local date d#
31727>>>>>  move (TS_ExtractDate(time#)) to d#
31728>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31731>>>>>  else function_return (TS_ExtractTime(time#))
31733>>>>>end_function
31734>>>>>
31734>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31735>>>>>  local integer h# m#
31736>>>>>  move (ts#/3600) to h#
31737>>>>>  move (ts#-(h#*3600)) to ts#
31738>>>>>  move (ts#/60) to m#
31739>>>>>  move (ts#-(m#*60)) to ts#
31740>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31741>>>>>end_function
31742>>>>>
31742>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31742>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31743>>>>>  local integer obj2# itm2#
31744>>>>>  if num_arguments gt 3 begin
31746>>>>>    move tmp_obj2# to obj2#
31747>>>>>    move tmp_itm2# to itm2#
31748>>>>>  end
31748>>>>>>
31748>>>>>  else begin
31749>>>>>    move obj1# to obj2#
31750>>>>>    move (itm1#+1) to itm2#
31751>>>>>  end
31751>>>>>>
31751>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31752>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31753>>>>>end_procedure
31754>>>>>
31754>>>>>class TS_TimeEstimator is an array
31755>>>>>  procedure construct_object
31756>>>>>    forward send construct_object
31758>>>>>    set delegation_mode to delegate_to_parent
31759>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31760>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31761>>>>>    property number  pnLeft    public 0 // Number of seconds left
31762>>>>>    property number  pnStart   public 0
31763>>>>>    property number  pnPause   public 0
31764>>>>>    property number  pnPercent public 0
31765>>>>>    property integer piMin     public 0
31766>>>>>    property integer piMax     public 0
31767>>>>>  end_procedure
31768>>>>>
31768>>>>>  procedure TS_Start integer min# integer max#
31769>>>>>    set piMin to min#
31770>>>>>    set piMax to max#
31771>>>>>    set pnStart to (TS_SysTime())
31772>>>>>    set pnElapsed to 0
31773>>>>>    set pnPercent to 0
31774>>>>>  end_procedure
31775>>>>>
31775>>>>>  procedure TS_Calculate integer pos#
31776>>>>>    local integer min# max#
31777>>>>>    get piMin to min#
31778>>>>>    get piMax to max#
31779>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31780>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31781>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31782>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31783>>>>>  end_procedure
31784>>>>>
31784>>>>>  procedure TS_Pause
31785>>>>>    set pnPause to (TS_SysTime())
31786>>>>>  end_procedure
31787>>>>>
31787>>>>>  procedure TS_Continue
31788>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31789>>>>>  end_procedure
31790>>>>>end_class
31791>>>>>
31791>>>>>function TS_Module_Compile_Time global string path# returns number
31792>>>>>  local integer pos# day# month# year# seqeof# ch#
31793>>>>>  local string date# str# time#
31793>>>>>  move path# to str#
31794>>>>>  if str# ne "" begin
31796>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31797>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31798>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31800>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31802>>>>>    [ seqeof] move 1 to seqeof#
31803>>>>>    [~seqeof] move 0 to seqeof#
31804>>>>>    [~seqeof] readln str#
31805>>>>>    close_input channel ch#
31807>>>>>  end
31807>>>>>>
31807>>>>>  if seqeof# function_return 0
31810>>>>>  pos "," in str# to pos#
31812>>>>>>
31812>>>>>  move (mid(str#,18,pos#+2)) to str#
31813>>>>>  move (integer(mid(str#,2,4))) to day#
31814>>>>>  move (integer(mid(str#,2,1))) to month#
31815>>>>>  move (integer(mid(str#,2,7))) to year#
31816>>>>>  if year# eq 10 begin
31818>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31819>>>>>    move (mid(str#,8,11)) to str#
31820>>>>>  end
31820>>>>>>
31820>>>>>  else move (mid(str#,8,10)) to str#
31822>>>>>  move (DateCompose(day#,month#,year#)) to date#
31823>>>>>  move (Date2to4(date#)) to date#
31824>>>>>  pos ":" in str# to pos#
31826>>>>>>
31826>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31827>>>>>end_function
31828>>>>>
31828>>>>>string Dates$Module_Compile_Time
31828>>>>>move "" to Dates$Module_Compile_Time
31829>>>>>
31829>>>>>function Module_Compile_Date global returns date
31830>>>>>  local number ts#
31831>>>>>  local string str#
31831>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31832>>>>>  get TS_Module_Compile_Time str# to ts#
31833>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31834>>>>>  function_return (TS_ExtractDate(ts#))
31835>>>>>end_function
31836>>>>>
31836>>>>>function Module_Compile_Time global returns string
31837>>>>>  local date grb#
31838>>>>>  // Module_Compile_Date must be called before this one!
31838>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31841>>>>>  function_return Dates$Module_Compile_Time
31842>>>>>end_function
31843>>>>>
31843>>>>>date   Dates$ModuleStartDate
31843>>>>>string Dates$ModuleStartTime 8
31843>>>>>move (dSysDate()) to Dates$ModuleStartDate
31844>>>>>move (sSysTime()) to Dates$ModuleStartTime
31845>>>>>
31845>>>>>function Module_Start_Date global returns date
31846>>>>>  function_return Dates$ModuleStartDate
31847>>>>>end_function
31848>>>>>
31848>>>>>function Module_Start_Time global returns string
31849>>>>>  function_return Dates$ModuleStartTime
31850>>>>>end_function
31851>>>>>
31851>>>>> register_procedure NotifyPopupCalendarChange date date#
31851>>>>> register_procedure NotifyPopupCalendarSelect date date#
31851>>>>>  use dfAllent
31851>>>>>  class calendar.textbox is a textbox
31852>>>>>    procedure construct_object
31853>>>>>      forward send construct_object
31855>>>>>      Set Auto_Size_State To False
31856>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31857>>>>>    end_procedure
31858>>>>>  end_class
31859>>>>>
31859>>>>>  register_object btn1
31859>>>>>  register_object btn6
31859>>>>>
31859>>>>>  class calendar.button is a button
31860>>>>>
31860>>>>>    procedure construct_object
31861>>>>>      forward send construct_object
31863>>>>>      set size to 15 18
31864>>>>>      on_key kleftarrow   send prev_day
31865>>>>>      on_key krightarrow  send next_day
31866>>>>>      on_key kuparrow     send prev_week
31867>>>>>      on_key kdownarrow   send next_week
31868>>>>>      property date p_assigned_date public 0
31869>>>>>    end_procedure
31870>>>>>
31870>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31871>>>>>      send activate to (btn1(current_object))
31872>>>>>    end_procedure
31873>>>>>    procedure switch_back
31874>>>>>      send activate to (btn6(current_object))
31875>>>>>    end_procedure
31876>>>>>
31876>>>>>    procedure mouse_down
31877>>>>>      local integer current_object#
31878>>>>>      forward send mouse_down
31880>>>>>      move current_object to current_object#
31881>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31883>>>>>    end_procedure
31884>>>>>  end_class
31885>>>>>
31885>>>>>  desktop_section
31891>>>>>    object popup_calendar is a ModalPanel
31893>>>>>      set size to 160 250
31894>>>>>      property date    p_current_date  public 0
31896>>>>>      property integer p_current_year  public -1
31898>>>>>      property integer p_current_month public -1
31900>>>>>      property integer pExportState    public 1
31902>>>>>
31902>>>>>      on_key key_ctrl+key_pgup send prev_year
31903>>>>>      on_key key_ctrl+key_pgdn send next_year
31904>>>>>      on_key          key_pgup send prev_month
31905>>>>>      on_key          key_pgdn send next_month
31906>>>>>      on_key key_ctrl+key_d    send go_today
31907>>>>>      on_key kcancel           send cancel
31908>>>>>
31908>>>>>      object cont3d is a container3d
31910>>>>>        set location to 5 5
31911>>>>>        set size to 120 237
31912>>>>>        object textbox_year is a calendar.textbox
31914>>>>>          set location to 5 5
31915>>>>>          set size to 15 30
31916>>>>>          set border_style to border_staticedge
31917>>>>>          procedure display
31919>>>>>            set value to (p_current_year(current_object))
31920>>>>>          end_procedure
31921>>>>>        end_object
31922>>>>>        object dayname_header is a container3d
31924>>>>>          set location to 5 39
31925>>>>>          set size to 15 126
31926>>>>>          set border_style to border_staticedge
31927>>>>>          procedure initialize
31929>>>>>            local integer itm#
31930>>>>>            for itm# from 0 to 6
31936>>>>>>
31936>>>>>              object txt is a calendar.textbox
31938>>>>>                set size to 12 17
31939>>>>>                set location to 0 (itm#*17.6+1)
31940>>>>>                 set value to (left(DayName(itm#+1),3))
31941>>>>>              end_object
31942>>>>>            loop
31943>>>>>>
31943>>>>>          end_procedure
31944>>>>>          send initialize
31945>>>>>        end_object
31946>>>>>        object weeknumber_header is a container3d
31948>>>>>          set location to 24 5
31949>>>>>          set size     to 89 30
31950>>>>>          set border_style to border_staticedge
31951>>>>>          object obj_id_array is an array
31953>>>>>          end_object
31954>>>>>          procedure initialize
31956>>>>>            local integer itm# obj#
31957>>>>>            move (obj_id_array(current_object)) to obj#
31958>>>>>            for itm# from 0 to 5
31964>>>>>>
31964>>>>>              object txt is a textbox
31966>>>>>                set size to 15 30
31967>>>>>                set location to (itm#*15+1) 1
31968>>>>>                set value of obj# item (item_count(obj#)) to current_object
31969>>>>>              end_object
31970>>>>>            loop
31971>>>>>>
31971>>>>>          end_procedure
31972>>>>>          procedure display
31974>>>>>            local integer itm# obj#
31975>>>>>            local date date# last_date#
31975>>>>>            move (obj_id_array(current_object)) to obj#
31976>>>>>            get p_current_date to date#
31977>>>>>            move (FirstDayInMonth(date#)) to date#
31978>>>>>            move (LastDayInMonth(date#)) to last_date#
31979>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31980>>>>>            for itm# from 0 to 5
31986>>>>>>
31986>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31989>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31991>>>>>            loop
31992>>>>>>
31992>>>>>          end_procedure
31993>>>>>          send initialize
31994>>>>>        end_object
31995>>>>>        object days_grid is a container3d
31997>>>>>          set location to 23 39
31998>>>>>          set size     to 100 127
31999>>>>>          set border_style to border_none
32000>>>>>          object btn_array is an array
32002>>>>>          end_object
32003>>>>>          procedure initialize
32005>>>>>            local integer row# col# button_array#
32006>>>>>            move (btn_array(current_object)) to button_array#
32007>>>>>            for row# from 0 to 5
32013>>>>>>
32013>>>>>              for col# from 0 to 6
32019>>>>>>
32019>>>>>                object btn is a calendar.button
32021>>>>>                  set location to (row#*15) (col#*18)
32022>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
32023>>>>>                  on_item "" send move_value_out_ok
32024>>>>>                end_object
32025>>>>>              loop
32026>>>>>>
32026>>>>>            loop
32027>>>>>>
32027>>>>>          end_procedure
32028>>>>>          send initialize
32029>>>>>
32029>>>>>          procedure display.iii integer itm# integer day# integer activate#
32031>>>>>            local integer obj# current_day#
32032>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
32033>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
32034>>>>>            if activate# begin
32036>>>>>              if day# eq current_day# send activate to obj#
32039>>>>>            end
32039>>>>>>
32039>>>>>            else begin
32040>>>>>              if day# begin
32042>>>>>                set value of obj# to day#
32043>>>>>                set visible_state of obj# to true
32044>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
32045>>>>>              end
32045>>>>>>
32045>>>>>              else set visible_state of obj# to false
32047>>>>>            end
32047>>>>>>
32047>>>>>          end_procedure
32048>>>>>
32048>>>>>          procedure display integer activate#
32050>>>>>            local integer first_item# last_item# itm# day# date#
32051>>>>>            get p_current_date to date#
32052>>>>>            move (FirstDayInMonth(date#)) to date#
32053>>>>>            move (DateDayNumber(date#)-1) to first_item#
32054>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32055>>>>>            ifnot activate# begin
32057>>>>>              for itm# from 0 to (first_item#-1)
32063>>>>>>
32063>>>>>                send display.iii itm# 0 0
32064>>>>>              loop
32065>>>>>>
32065>>>>>            end
32065>>>>>>
32065>>>>>            move 1 to day#
32066>>>>>            for itm# from first_item# to last_item#
32072>>>>>>
32072>>>>>              send display.iii itm# day# activate#
32073>>>>>              increment day#
32074>>>>>            loop
32075>>>>>>
32075>>>>>            ifnot activate# begin
32077>>>>>              for itm# from (last_item#+1) to 41
32083>>>>>>
32083>>>>>                send display.iii itm# 0 0
32084>>>>>              loop
32085>>>>>>
32085>>>>>            end
32085>>>>>>
32085>>>>>          end_procedure
32086>>>>>        end_object
32087>>>>>        object txt_month is a calendar.textbox
32089>>>>>          set size to 12 27
32090>>>>>          set location to 25 185
32091>>>>>          set value to t.calendar.month
32092>>>>>        end_object
32093>>>>>        object btn1 is a button
32095>>>>>          set size to 12 12
32096>>>>>          set location to 40 185
32097>>>>>          on_item "" send prev_month
32098>>>>>          set bitmap to "prev.bmp"
32099>>>>>          procedure switch_back
32101>>>>>            send display_main
32102>>>>>          end_procedure
32103>>>>>        end_object
32104>>>>>        object btn2 is a button
32106>>>>>          set size to 12 12
32107>>>>>          set location to 40 200
32108>>>>>          on_item "" send next_month
32109>>>>>          set bitmap to "next.bmp"
32110>>>>>        end_object
32111>>>>>        object txt_year is a calendar.textbox
32113>>>>>          set size to 12 27
32114>>>>>          set location to 70 185
32115>>>>>          set value to t.calendar.year
32116>>>>>        end_object
32117>>>>>        object btn3 is a button
32119>>>>>          set size to 12 12
32120>>>>>          set location to 85 185
32121>>>>>          on_item "" send prev_year
32122>>>>>          set bitmap to "prev.bmp"
32123>>>>>        end_object
32124>>>>>        object btn4 is a button
32126>>>>>          set size to 12 12
32127>>>>>          set location to 85 200
32128>>>>>          on_item "" send next_year
32129>>>>>          set bitmap to "next.bmp"
32130>>>>>        end_object
32131>>>>>      end_object
32132>>>>>      object btn5 is a button
32134>>>>>        set size to 14 60
32135>>>>>        set location to 129 115
32136>>>>>        on_item t.calendar.ok send move_value_out_ok
32137>>>>>      end_object
32138>>>>>      object btn6 is a button
32140>>>>>        set size to 14 60
32141>>>>>        set location to 129 182
32142>>>>>        on_item t.calendar.cancel send cancel
32143>>>>>        procedure switch
32145>>>>>          send display_main
32146>>>>>        end_procedure
32147>>>>>      end_object
32148>>>>>      procedure next_year
32150>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32151>>>>>        send display_main
32152>>>>>      end_procedure
32153>>>>>      procedure prev_year
32155>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32156>>>>>        send display_main
32157>>>>>      end_procedure
32158>>>>>      procedure next_month
32160>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32161>>>>>        send display_main
32162>>>>>      end_procedure
32163>>>>>      procedure prev_month
32165>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32166>>>>>        send display_main
32167>>>>>      end_procedure
32168>>>>>      procedure next_week
32170>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32171>>>>>        send display_main
32172>>>>>      end_procedure
32173>>>>>      procedure prev_week
32175>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32176>>>>>        send display_main
32177>>>>>      end_procedure
32178>>>>>      procedure next_day
32180>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32181>>>>>        send display_main
32182>>>>>      end_procedure
32183>>>>>      procedure prev_day
32185>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32186>>>>>        send display_main
32187>>>>>      end_procedure
32188>>>>>      procedure go_today
32190>>>>>        local date date#
32191>>>>>        sysdate4 date#
32192>>>>>        set p_current_date to date#
32193>>>>>        send display_main
32194>>>>>      end_procedure
32195>>>>>      property integer invoking_object_id public 0
32197>>>>>      procedure OnChange date date#
32199>>>>>        local integer focus# dm#
32200>>>>>        get invoking_object_id to focus#
32201>>>>>        if focus# gt desktop begin
32203>>>>>          get delegation_mode of focus# to dm#
32204>>>>>          set delegation_mode of focus# to no_delegate_or_error
32205>>>>>          send NotifyPopupCalendarChange to focus# date#
32206>>>>>          set delegation_mode of focus# to dm#
32207>>>>>        end
32207>>>>>>
32207>>>>>      end_procedure
32208>>>>>      procedure display
32210>>>>>        local integer date# month# year#
32211>>>>>        get p_current_date to date#
32212>>>>>        send OnChange date#
32213>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32214>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32215>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32217>>>>>          set p_current_year to year#
32218>>>>>          set p_current_month to month#
32219>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32220>>>>>          send display to (textbox_year(cont3d(current_object)))
32221>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32222>>>>>          send display to (days_grid(cont3d(current_object))) 0
32223>>>>>        end
32223>>>>>>
32223>>>>>      end_procedure
32224>>>>>      procedure display_main
32226>>>>>        send display
32227>>>>>        send display to (days_grid(cont3d(current_object))) 1
32228>>>>>      end_procedure
32229>>>>>      procedure popup_no_export
32231>>>>>        set pExportState to false
32232>>>>>        send popup
32233>>>>>        set pExportState to true
32234>>>>>      end_procedure
32235>>>>>
32235>>>>>      procedure popup_group
32237>>>>>        local integer focus#
32238>>>>>        local date date#
32238>>>>>        move (focus(desktop)) to focus#
32239>>>>>        set invoking_object_id to focus#
32240>>>>>        get value of focus# item current to date#
32241>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32244>>>>>        move (Date2to4(date#)) to date#
32245>>>>>        set p_current_date to date#
32246>>>>>        send display
32247>>>>>        forward send popup_group
32249>>>>>        send display to (days_grid(cont3d(current_object))) 1
32250>>>>>      end_procedure
32251>>>>>
32251>>>>>      procedure move_value_out
32253>>>>>        local integer focus# dm# margin# datatype#
32254>>>>>        if (pExportState(current_object)) begin
32256>>>>>          get invoking_object_id to focus#
32257>>>>>          if focus# gt desktop begin
32259>>>>>            get delegation_mode of focus# to dm#
32260>>>>>            set delegation_mode of focus# to no_delegate_or_error
32261>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32262>>>>>            get form_margin of focus# item current to margin#
32263>>>>>            get form_datatype of focus# item current to datatype#
32264>>>>>            set delegation_mode of focus# to dm#
32265>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32268>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32270>>>>>            set item_changed_state of focus# item current to true
32271>>>>>          end
32271>>>>>>
32271>>>>>        end
32271>>>>>>
32271>>>>>      end_procedure
32272>>>>>
32272>>>>>      procedure move_value_out_ok
32274>>>>>        send move_value_out
32275>>>>>        send deactivate
32276>>>>>      end_procedure
32277>>>>>
32277>>>>>      procedure request_popup
32279>>>>>        local integer focus# type# dm#
32280>>>>>        move (focus(desktop)) to focus#
32281>>>>>        if focus# gt desktop begin
32283>>>>>          get delegation_mode of focus# to dm#
32284>>>>>          set delegation_mode of focus# to no_delegate_or_error
32285>>>>>          get form_datatype of focus# item current to type#
32286>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32289>>>>>          set delegation_mode of focus# to dm#
32290>>>>>        end
32290>>>>>>
32290>>>>>      end_procedure
32291>>>>>    end_object
32292>>>>>  end_desktop_section
32294>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32294>>>>>  // substitute would become negative (because located on the desktop). This
32294>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32294>>>>>  procedure request_popup_calendar for BaseClass
32295>>>>>    send request_popup to (popup_calendar(current_object))
32296>>>>>  end_procedure
32297>>>>>  procedure popup_calendar_no_export
32298>>>>>    send popup_no_export to (popup_calendar(current_object))
32299>>>>>  end_procedure
32300>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32300>>>>>  procedure Add_Calendar_tbButton integer oTb#
32301>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32302>>>>>  end_procedure
32303>>>>> function s.calendar returns integer // Backwards compatible!!
32304>>>>>   function_return (popup_calendar(current_object))
32305>>>>> end_function
32306>>>>>
32306>>>>>// Karl,
32306>>>>>// Structure is as follows,
32306>>>>>//
32306>>>>>// //put this code in the top portion of the view code or in the program
32306>>>>>// code.
32306>>>>>//
32306>>>>>// Type SystemTime
32306>>>>>//   field SystemTime.iYear As Word
32306>>>>>//   field SystemTime.iMonth As Word
32306>>>>>//   field SystemTime.iDayOfWeek As Word
32306>>>>>//   field SystemTime.iDay As Word
32306>>>>>//   field SystemTime.iHour As Word
32306>>>>>//   field SystemTime.iMinute As Word
32306>>>>>//   field SystemTime.iSecond As Word
32306>>>>>//   field SystemTime.iMilliseconds As Word
32306>>>>>// End_Type
32306>>>>>//
32306>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32306>>>>>//
32306>>>>>// //put this code in an onClick or wherever
32306>>>>>// procedure onclick
32306>>>>>//   local integer iRetVal
32306>>>>>//   local string TimeData
32306>>>>>//   local pointer GST
32306>>>>>//
32306>>>>>//   ZeroType SystemTime to TimeData
32306>>>>>//   getAddress from TimeData to GST
32306>>>>>//
32306>>>>>//   move (GetSystemTime(GST)) to iRetVal
32306>>>>>// end_procedure
32306>>>>>//
32306>>>>>// To extract the data from the Structure after calling the function use
32306>>>>>// the getbuff command as follows:
32306>>>>>//
32306>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32306>>>>>//
32306>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32306>>>>>//
32306>>>>>// OLIVER NELSON
32306>>>>>//
32306>>>>>//
32306>>>
32306>>>//AB-StoreTopEnd
32306>>>
32306>>>//AB-IgnoreStart
32306>>>
32306>>>Use DFAllEnt.pkg
32306>>>
32306>>>
32306>>>//AB-IgnoreEnd
32306>>>
32306>>>CD_Popup_Object oCalendar is a dbModalPanel
32325>>>
32325>>>    //AB-StoreTopStart
32325>>>    on_key kcancel           send cancel
32326>>>    //AB-StoreTopEnd
32326>>>
32326>>>    Set Border_Style to Border_Normal
32327>>>    Set Caption_Bar to FALSE
32328>>>    Set Label to "Ÿ­¢ àì, 2001"
32329>>>    Set Size to 98 123
32330>>>    Set Location to 10 22
32331>>>    Set Color to clWhite
32332>>>
32332>>>    //AB-DDOStart
32332>>>
32332>>>
32332>>>    //AB-DDOEnd
32332>>>
32332>>>    Object Container3d1 is a Container3d
32334>>>        Set Size to 88 135
32335>>>        Set Location to -2 -1
32336>>>        Set Color to clWhite
32337>>>        Set Border_Style to Border_None
32338>>>        Object Grid2 is a Grid
32340>>>
32340>>>            //AB-StoreTopStart
32340>>>            property date    p_current_date     public 0
32342>>>            property integer p_current_year     public -1
32344>>>            property integer p_current_month    public -1
32346>>>            property integer p_selected_day     public -1
32348>>>            property integer pExportState       public 1
32350>>>            property integer invoking_object_id public 0
32352>>>            
32352>>>            Set Border_Style To BORDER_NONE
32353>>>            Set header_visible_state To False
32354>>>            set select_mode to no_select
32355>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32356>>>            
32356>>>            on_key Key_F1 Send Help
32357>>>            on_key key_ctrl+key_pgup send prev_year
32358>>>            on_key key_ctrl+key_pgdn send next_year
32359>>>            on_key          key_pgup send prev_month
32360>>>            on_key          key_pgdn send next_month
32361>>>            on_key key_enter         send move_value_out
32362>>>            on_key key_ctrl+key_d    send go_today
32363>>>            
32363>>>            //AB-StoreTopEnd
32363>>>
32363>>>            Set Color to clWhite
32364>>>            Set CurrentCellColor to clWhite
32365>>>            Set CurrentCellTextColor to clWhite
32366>>>            Set Size to 61 145
32367>>>            Set Location to 30 1
32368>>>            Set Resize_Column_state to FALSE
32369>>>
32369>>>            Set Line_Width to 7 0
32370>>>
32370>>>            Set Form_Width    item 0 to 18
32371>>>            Set Header_Label  item 0 to "­"
32372>>>            
32372>>>            Set Form_Width    item 1 to 18
32373>>>            Set Header_Label  item 1 to "‚â"
32374>>>            
32374>>>            Set Form_Width    item 2 to 18
32375>>>            Set Header_Label  item 2 to "‘à"
32376>>>            
32376>>>            Set Form_Width    item 3 to 18
32377>>>            Set Header_Label  item 3 to "—â"
32378>>>            
32378>>>            Set Form_Width    item 4 to 18
32379>>>            Set Header_Label  item 4 to "â"
32380>>>            
32380>>>            Set Form_Width    item 5 to 18
32381>>>            Set Header_Label  item 5 to "‘¡"
32382>>>            
32382>>>            Set Form_Width    item 6 to 18
32383>>>            Set Header_Label  item 6 to "‚á"
32384>>>            
32384>>>
32384>>>            //AB-StoreStart
32384>>>            
32384>>>            procedure go_today
32386>>>                Date date#
32387>>>                sysdate4 date#
32388>>>                set p_current_date to date#
32389>>>                Send Update_Calendar
32390>>>            end_procedure
32391>>>            
32391>>>            procedure next_month
32393>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32394>>>                Send Update_Calendar
32395>>>            end_procedure
32396>>>            
32396>>>            procedure prev_month
32398>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32399>>>                Send Update_Calendar
32400>>>            end_procedure
32401>>>            
32401>>>            procedure next_year
32403>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32404>>>                Send Update_Calendar
32405>>>            end_procedure
32406>>>            
32406>>>            procedure prev_year
32408>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32409>>>                Send Update_Calendar
32410>>>            end_procedure
32411>>>            
32411>>>            Procedure Activate
32413>>>                Date date#
32414>>>                Forward Send Activate
32416>>>                Set current_item to (p_selected_day(Self))
32417>>>            End_Procedure
32418>>>            
32418>>>            Procedure Update_Calendar
32420>>>                Set Dynamic_Update_State To False
32421>>>                send Fill_List
32422>>>                Set Dynamic_Update_State To True
32423>>>                // Send Update_Label
32423>>>                Set current_item to (p_selected_day(Self))
32424>>>                Send Date_Changing to (oYear(Container3d2(self)))
32425>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32426>>>            End_Procedure
32427>>>            
32427>>>            Procedure Fill_List
32429>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32430>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32430>>>                Date dToday
32430>>>                Send Delete_Data
32431>>>            
32431>>>                Get p_current_date to date#
32432>>>            
32432>>>                SysDate4 dToday
32433>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32434>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32435>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32436>>>            
32436>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32437>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32438>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32439>>>                Set p_current_month To sel_month#
32440>>>                Set p_current_year To sel_year#
32441>>>            
32441>>>                move (FirstDayInMonth(date#)) to date#
32442>>>                move (DateDayNumber(date#)-1) to first_item#
32443>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32444>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32445>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32446>>>            
32446>>>                If (first_item# > 0) Begin
32448>>>                    Move (first_item#-1) to day#
32449>>>                    For iFor from 0 to (first_item#-1)
32455>>>>
32455>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32456>>>                        Set Entry_State Item iFor To False
32457>>>                        Set ItemTextColor Item iFor To clGray
32458>>>                        Decrement day#
32459>>>                    Loop
32460>>>>
32460>>>                End
32460>>>>
32460>>>            
32460>>>                Move 1 To day#
32461>>>                For iFor from first_item# to last_item#
32467>>>>
32467>>>                    Send Add_Item Msg_Move_Value_Out day#
32468>>>                    Set Entry_State Item iFor To False
32469>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32472>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32475>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32476>>>                    Set form_datatype item iFor To mask_numeric_window
32477>>>                    Set form_Mask item iFor To "## "
32478>>>                    Increment day#
32479>>>                Loop
32480>>>>
32480>>>            
32480>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32481>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32482>>>            
32482>>>                If (last_item# < 41) Begin
32484>>>                    Move 1 to day#
32485>>>                    For iFor from (last_item#+1) to 41
32491>>>>
32491>>>                        Send Add_Item msg_move_value_out day#
32492>>>                        Set Entry_State Item iFor To False
32493>>>                        Set ItemTextColor Item iFor To clGray
32494>>>                        Increment day#
32495>>>                    Loop
32496>>>>
32496>>>                End
32496>>>>
32496>>>            
32496>>>            End_Procedure
32497>>>            
32497>>>            Procedure Help
32499>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32500>>>            End_Procedure
32501>>>            
32501>>>            procedure mouse_click integer window integer char_pos
32503>>>                Send Move_Value_Out
32504>>>                forward send mouse_click window char_pos
32506>>>            end_procedure
32507>>>            
32507>>>            Procedure Move_Value_Out
32509>>>                Integer iYear iMonth iDay iItm
32510>>>                Date Date# next_date# prev_date#
32510>>>                Get Current_Item To iItm
32511>>>                If (pExportState(Self)) Begin
32513>>>                    Get Value Item iItm To iDay
32514>>>                    Get p_current_month to iMonth
32515>>>                    Get p_current_year  to iYear
32516>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32517>>>            
32517>>>                    If ((iItm>27)and(iDay<15)) Begin
32519>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32520>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32521>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32522>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32523>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32524>>>                    End
32524>>>>
32524>>>                    If ((iItm<7)and(iDay>20)) Begin
32526>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32527>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32528>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32529>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32530>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32531>>>                    End
32531>>>>
32531>>>            
32531>>>                    Send Export_Date date#
32532>>>                End
32532>>>>
32532>>>            End_Procedure
32533>>>            
32533>>>            Procedure Export_Date date date#
32535>>>                local integer focus# dm# margin# datatype#
32536>>>                get invoking_object_id to focus#
32537>>>            
32537>>>                if focus# gt desktop begin
32539>>>                     get delegation_mode of focus# to dm#
32540>>>                     set delegation_mode of focus# to no_delegate_or_error
32541>>>                     get form_margin of focus# item current to margin#
32542>>>                     get form_datatype of focus# item current to datatype#
32543>>>                     set delegation_mode of focus# to dm#
32544>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32547>>>                     else             set value of focus# item current to (Date4to2(date#))
32549>>>                     set item_changed_state of focus# item current to true
32550>>>                end
32550>>>>
32550>>>                Send Close_Calendar
32551>>>            End_Procedure
32552>>>            //AB-StoreEnd
32552>>>
32552>>>        End_Object    // Grid2
32553>>>
32553>>>        Object Textbox2 is a Textbox
32555>>>            Set Label to "­"
32556>>>            Set Auto_Size_State to FALSE
32557>>>            Set Transparent_State to TRUE
32558>>>            Set Color to clWhite
32559>>>            Set TextColor to clNavy
32560>>>            Set Location to 19 4
32561>>>            Set Size to 10 15
32562>>>
32562>>>            //AB-StoreStart
32562>>>                                        
32562>>>            Set Label To (left(t.calendar.Monday,2))
32563>>>            //AB-StoreEnd
32563>>>
32563>>>        End_Object    // Textbox2
32564>>>
32564>>>        Object Textbox3 is a Textbox
32566>>>            Set Label to "‚â"
32567>>>            Set Auto_Size_State to FALSE
32568>>>            Set Transparent_State to TRUE
32569>>>            Set Color to clWhite
32570>>>            Set TextColor to clNavy
32571>>>            Set Location to 19 22
32572>>>            Set Size to 10 12
32573>>>
32573>>>            //AB-StoreStart
32573>>>                                        
32573>>>            Set Label To (left(t.calendar.Tuesday,2))
32574>>>            //AB-StoreEnd
32574>>>
32574>>>        End_Object    // Textbox3
32575>>>
32575>>>        Object Textbox4 is a Textbox
32577>>>            Set Label to "‘à"
32578>>>            Set Auto_Size_State to FALSE
32579>>>            Set Transparent_State to TRUE
32580>>>            Set Color to clWhite
32581>>>            Set TextColor to clNavy
32582>>>            Set Location to 19 39
32583>>>            Set Size to 10 15
32584>>>
32584>>>            //AB-StoreStart
32584>>>                                        
32584>>>            Set Label To (left(t.calendar.Wednesday,2))
32585>>>            //AB-StoreEnd
32585>>>
32585>>>        End_Object    // Textbox4
32586>>>
32586>>>        Object Textbox5 is a Textbox
32588>>>            Set Label to "—â"
32589>>>            Set Auto_Size_State to FALSE
32590>>>            Set Transparent_State to TRUE
32591>>>            Set Color to clWhite
32592>>>            Set TextColor to clNavy
32593>>>            Set Location to 19 57
32594>>>            Set Size to 10 17
32595>>>
32595>>>            //AB-StoreStart
32595>>>                                        
32595>>>            Set Label To (left(t.calendar.Thursday,2))
32596>>>            //AB-StoreEnd
32596>>>
32596>>>        End_Object    // Textbox5
32597>>>
32597>>>        Object Textbox6 is a Textbox
32599>>>            Set Label to "â"
32600>>>            Set Auto_Size_State to FALSE
32601>>>            Set Transparent_State to TRUE
32602>>>            Set Color to clWhite
32603>>>            Set TextColor to clNavy
32604>>>            Set Location to 19 76
32605>>>            Set Size to 10 17
32606>>>
32606>>>            //AB-StoreStart
32606>>>                                        
32606>>>            Set Label To (left(t.calendar.Friday,2))
32607>>>            //AB-StoreEnd
32607>>>
32607>>>        End_Object    // Textbox6
32608>>>
32608>>>        Object Textbox7 is a Textbox
32610>>>            Set Label to "‘¡"
32611>>>            Set Auto_Size_State to FALSE
32612>>>            Set Transparent_State to TRUE
32613>>>            Set Color to clWhite
32614>>>            Set TextColor to clNavy
32615>>>            Set Location to 19 91
32616>>>            Set Size to 10 18
32617>>>
32617>>>            //AB-StoreStart
32617>>>                                        
32617>>>            Set Label To (left(t.calendar.Saturday,2))
32618>>>            //AB-StoreEnd
32618>>>
32618>>>        End_Object    // Textbox7
32619>>>
32619>>>        Object Textbox8 is a Textbox
32621>>>            Set Label to "‚á"
32622>>>            Set Auto_Size_State to FALSE
32623>>>            Set Transparent_State to TRUE
32624>>>            Set Color to clWhite
32625>>>            Set TextColor to clNavy
32626>>>            Set Location to 19 109
32627>>>            Set Size to 10 17
32628>>>
32628>>>            //AB-StoreStart
32628>>>                                        
32628>>>            Set Label To (left(t.calendar.Sunday,2))
32629>>>            //AB-StoreEnd
32629>>>
32629>>>        End_Object    // Textbox8
32630>>>
32630>>>        Object LineControl1 is a LineControl
32632>>>            Set Line_Style to lnSINGLE
32633>>>            Set Size to 1 116
32634>>>            Set Location to 28 4
32635>>>
32635>>>            //AB-StoreStart
32635>>>                                        
32635>>>            //AB-StoreEnd
32635>>>
32635>>>        End_Object    // LineControl1
32636>>>
32636>>>        Object Container3d2 is a Container3d
32638>>>            Set Size to 18 131
32639>>>            Set Location to 1 1
32640>>>            Set Color to clNavy
32641>>>            Set Border_Style to Border_None
32642>>>            Object oRght is a BitmapContainer
32644>>>                Set Size to 10 14
32645>>>                Set Location to 4 105
32646>>>                Set Bitmap to "rght.bmp"
32647>>>                Set Border_Style to Border_None
32648>>>
32648>>>                //AB-StoreStart
32648>>>                Procedure Mouse_Down
32650>>>                    Send Next_Month to Grid2
32651>>>                End_Procedure
32652>>>                //AB-StoreEnd
32652>>>
32652>>>            End_Object    // oRght
32653>>>
32653>>>            Object oLeft is a BitmapContainer
32655>>>                Set Size to 10 14
32656>>>                Set Location to 4 3
32657>>>                Set Bitmap to "lft.bmp"
32658>>>                Set Border_Style to Border_None
32659>>>
32659>>>                //AB-StoreStart
32659>>>                Procedure Mouse_Down
32661>>>                    Send Prev_Month to Grid2
32662>>>                End_Procedure
32663>>>                //AB-StoreEnd
32663>>>
32663>>>            End_Object    // oLeft
32664>>>
32664>>>            Object oMonth is a Textbox
32666>>>
32666>>>                //AB-StoreTopStart
32666>>>                Property integer piSelected_Month public 0
32668>>>                //AB-StoreTopEnd
32668>>>
32668>>>                Set Label to "January"
32669>>>                Set Auto_Size_State to FALSE
32670>>>                Set Transparent_State to TRUE
32671>>>                Set Color to clWhite
32672>>>                Set TextColor to clWhite
32673>>>                Set Location to 4 23
32674>>>                Set Size to 10 43
32675>>>                Set FontWeight to 800
32676>>>                Set Justification_Mode to jMode_Center
32677>>>
32677>>>                //AB-StoreStart
32677>>>                                    
32677>>>                Procedure Mouse_Down
32679>>>                    Integer iState
32680>>>                    Get Visible_State of oSelectYear to iState
32681>>>                    If (iState) Send OnKillFocus to oSelectYear
32684>>>                    Send Popup to oSelectMonth
32685>>>                End_Procedure
32686>>>                
32686>>>                Procedure pSelectJan
32688>>>                    Set Label to t.calendar.january
32689>>>                    Set piSelected_Month to 1
32690>>>                    Send Adjust_Calendar
32691>>>                End_Procedure
32692>>>                Procedure pSelectFeb
32694>>>                    Set Label to t.calendar.february
32695>>>                    Set piSelected_Month to 2
32696>>>                    Send Adjust_Calendar
32697>>>                End_Procedure
32698>>>                Procedure pSelectMar
32700>>>                    Set Label to t.calendar.march
32701>>>                    Set piSelected_Month to 3
32702>>>                    Send Adjust_Calendar
32703>>>                End_Procedure
32704>>>                Procedure pSelectApr
32706>>>                    Set Label to t.calendar.april
32707>>>                    Set piSelected_Month to 4
32708>>>                    Send Adjust_Calendar
32709>>>                End_Procedure
32710>>>                Procedure pSelectMay
32712>>>                    Set Label to t.calendar.may
32713>>>                    Set piSelected_Month to 5
32714>>>                    Send Adjust_Calendar
32715>>>                End_Procedure
32716>>>                Procedure pSelectJun
32718>>>                    Set Label to t.calendar.june
32719>>>                    Set piSelected_Month to 6
32720>>>                    Send Adjust_Calendar
32721>>>                End_Procedure
32722>>>                Procedure pSelectJul
32724>>>                    Set Label to t.calendar.july
32725>>>                    Set piSelected_Month to 7
32726>>>                    Send Adjust_Calendar
32727>>>                End_Procedure
32728>>>                Procedure pSelectAug
32730>>>                    Set Label to t.calendar.august
32731>>>                    Set piSelected_Month to 8
32732>>>                    Send Adjust_Calendar
32733>>>                End_Procedure
32734>>>                Procedure pSelectSep
32736>>>                    Set Label to t.calendar.september
32737>>>                    Set piSelected_Month to 9
32738>>>                    Send Adjust_Calendar
32739>>>                End_Procedure
32740>>>                Procedure pSelectOct
32742>>>                    Set Label to t.calendar.october
32743>>>                    Set piSelected_Month to 10
32744>>>                    Send Adjust_Calendar
32745>>>                End_Procedure
32746>>>                Procedure pSelectNov
32748>>>                    Set Label to t.calendar.november
32749>>>                    Set piSelected_Month to 11
32750>>>                    Send Adjust_Calendar
32751>>>                End_Procedure
32752>>>                Procedure pSelectDec
32754>>>                    Set Label to t.calendar.december
32755>>>                    Set piSelected_Month to 12
32756>>>                    Send Adjust_Calendar
32757>>>                End_Procedure
32758>>>                
32758>>>                Object oSelectMonth is a FloatingPopupMenu
32760>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32761>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32762>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32763>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32764>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32765>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32766>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32767>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32768>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32769>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32770>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32771>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32772>>>                End_Object
32773>>>                
32773>>>                Procedure Adjust_Calendar
32775>>>                    Date date#
32776>>>                    Integer iDay iMonth iYear iItm
32776>>>                    Set Visible_State to false
32777>>>                    Set Visible_State to true
32778>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32779>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32780>>>                    Get piSelected_Month to iMonth
32781>>>                    Get Label of oYear to iYear
32782>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32783>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32784>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32785>>>                End_Procedure
32786>>>                
32786>>>                Procedure Activating
32788>>>                    Forward Send Activating
32790>>>                    Send Date_Changing
32791>>>                End_Procedure
32792>>>                
32792>>>                Procedure Date_Changing
32794>>>                    Set Visible_State to false
32795>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32796>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32797>>>                    Set Visible_State to true
32798>>>                End_Procedure
32799>>>                
32799>>>                
32799>>>                //AB-StoreEnd
32799>>>
32799>>>            End_Object    // oMonth
32800>>>
32800>>>            Object oYear is a Textbox
32802>>>                Set Label to "2001"
32803>>>                Set Transparent_State to TRUE
32804>>>                Set Color to clWhite
32805>>>                Set TextColor to clWhite
32806>>>                Set Location to 4 77
32807>>>                Set Size to 10 18
32808>>>                Set FontWeight to 800
32809>>>
32809>>>                //AB-StoreStart
32809>>>                                                    
32809>>>                Procedure Mouse_Down
32811>>>                    String sVal
32812>>>                    Get Label to sVal
32813>>>                    Set Value of oSelectYear item 0 to sVal
32814>>>                    Set Visible_State of oSelectYear to True
32815>>>                    Send Activate to (oSelectYear(Self))
32816>>>                End_Procedure
32817>>>                
32817>>>                Procedure Activating
32819>>>                    Forward Send Activating
32821>>>                    Send Date_Changing
32822>>>                End_Procedure
32823>>>                
32823>>>                Procedure Date_Changing
32825>>>                    Set Visible_State to false
32826>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32827>>>                    Set Visible_State to true
32828>>>                End_Procedure
32829>>>                //AB-StoreEnd
32829>>>
32829>>>            End_Object    // oYear
32830>>>
32830>>>            Object oSelectYear is a Form
32832>>>
32832>>>                //AB-StoreTopStart
32832>>>                Set Visible_State To False
32833>>>                //AB-StoreTopEnd
32833>>>
32833>>>                Set Size to 10 24
32834>>>                Set Location to 4 75
32835>>>                Set Color to clWhite
32836>>>                Set TextColor to clNavy
32837>>>                Set Form_Border Item 0 to Border_Normal
32838>>>
32838>>>                //AB-StoreStart
32838>>>                                                    
32838>>>                On_Key Key_Enter Send OnKillFocus
32839>>>                On_Key Key_Escape Send OnKillFocus
32840>>>                
32840>>>                Procedure SetFontWeight
32842>>>                    Set Form_FontWeight item 0 to 800
32843>>>                End_Procedure
32844>>>                
32844>>>                Procedure OnKillFocus
32846>>>                    String sVal
32847>>>                    Integer iMonth iDay iYear iItm
32847>>>                    Date date#
32847>>>                    Get Value item 0 to sVal
32848>>>                    Set Visible_State of oYear to false
32849>>>                    Set Label of oYear to sVal
32850>>>                    Set Visible_State of oYear to true
32851>>>                    Set Visible_State to false
32852>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32853>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32854>>>                    Get piSelected_Month of oMonth to iMonth
32855>>>                    Get Value item 0 to iYear
32856>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32857>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32858>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32859>>>                End_Procedure
32860>>>                
32860>>>                Send SetFontWeight
32861>>>                //AB-StoreEnd
32861>>>
32861>>>            End_Object    // oSelectYear
32862>>>
32862>>>
32862>>>            //AB-StoreStart
32862>>>                            
32862>>>            Procedure Mouse_Down
32864>>>                Integer iState
32865>>>                Get Visible_State of oSelectYear to iState
32866>>>                If (iState) Send OnKillFocus to oSelectYear
32869>>>            End_Procedure
32870>>>            
32870>>>            //AB-StoreEnd
32870>>>
32870>>>        End_Object    // Container3d2
32871>>>
32871>>>
32871>>>        //AB-StoreStart
32871>>>                            
32871>>>        //AB-StoreEnd
32871>>>
32871>>>    End_Object    // Container3d1
32872>>>
32872>>>    Object BitmapContainer3 is a BitmapContainer
32874>>>        Set Size to 9 19
32875>>>        Set Location to 88 3
32876>>>        Set Color to clWhite
32877>>>        Set Bitmap to "cdate.bmp"
32878>>>        Set Border_Style to Border_None
32879>>>
32879>>>        //AB-StoreStart
32879>>>        Procedure Mouse_Down
32881>>>            Send go_today to (Grid2(Container3d1(Self)))
32882>>>            Send Adjust_Label to oToday
32883>>>        End_Procedure
32884>>>        //AB-StoreEnd
32884>>>
32884>>>    End_Object    // BitmapContainer3
32885>>>
32885>>>    Object oToday is a Textbox
32887>>>        Set Label to "Today: 01.01.2001"
32888>>>        Set Auto_Size_State to FALSE
32889>>>        Set Color to clWhite
32890>>>        Set Location to 88 22
32891>>>        Set Size to 8 73
32892>>>        Set FontWeight to 800
32893>>>
32893>>>        //AB-StoreStart
32893>>>        Procedure Mouse_Down
32895>>>            Send go_today to (Grid2(Container3d1(Self)))
32896>>>            Send Adjust_Label
32897>>>        End_Procedure
32898>>>        
32898>>>        Procedure Adjust_Label
32900>>>            date date#
32901>>>            SysDate4 date#
32902>>>            Set Visible_State To false
32903>>>            Set Label         to (t.calendar.today+": "+String(date#))
32904>>>            Set Visible_State To true
32905>>>        End_Procedure
32906>>>        
32906>>>        Procedure Activating
32908>>>            Forward Send Activating
32910>>>            Send Adjust_Label
32911>>>        End_Procedure
32912>>>        //AB-StoreEnd
32912>>>
32912>>>    End_Object    // oToday
32913>>>
32913>>>
32913>>>    //AB-StoreStart
32913>>>                
32913>>>    procedure popup
32915>>>        local integer focus# icItm iYear iMonth
32916>>>        local date date#
32916>>>        move (focus(desktop)) to focus#
32917>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32918>>>        get value of focus# item current to date#
32919>>>        ifnot (integer(date#)) sysdate date#
32922>>>        move (Date2to4(date#)) to date#
32923>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32924>>>        send fill_list to (Grid2(Container3d1(self)))
32925>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32926>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32927>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32928>>>        forward send popup
32930>>>    end_procedure
32931>>>    
32931>>>    Procedure Close_Calendar
32933>>>        Send Exit
32934>>>    End_Procedure
32935>>>    //AB-StoreEnd
32935>>>
32935>>>CD_End_Object    // oCalendar
32937>>>>
32937>>>
32937>>>
32937>>>//AB-StoreStart
32937>>>    
32937>>>    
32937>>>//AB-StoreEnd
32937>>>
32937>>>//AB/ End_Object    // prj
32937>Use Dates.Utl
32937>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
32937>>>// ===========================================================================
32937>>>//
32937>>>// The ROUND_NUMBER global function has been designed to return the rounded
32937>>>// value of a given 'numeric' argument at a specified rounding precision.
32937>>>//
32937>>>// ---------------------------------------------------------------------------
32937>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32937>>>// necessary calculations.  It uses a string handling technique instead.
32937>>>// ---------------------------------------------------------------------------
32937>>>//
32937>>>// The function requires two arguments, as follows:-
32937>>>//
32937>>>// (a) The numeric value to be rounded, where the range of valid values is
32937>>>//     +/- 99,999,999,999,999.99999999.
32937>>>//
32937>>>// (b) The rounding precision required.  This must be an integer value in the
32937>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32937>>>//     threshold value is substituted.
32937>>>//
32937>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32937>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32937>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32937>>>//     round progressively to the left of the decimal point (a frequent
32937>>>//     requirement in financial reporting).
32937>>>//
32937>>>// If the result of the rounding produces a value outside the valid numeric
32937>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32937>>>//
32937>>>// Assumptions:-  The only assumptions made have been that the range of
32937>>>// numeric values and the limit of eight decimal places are unlikely to change
32937>>>// in the forseeable future.
32937>>>//
32937>>>// Examples:-
32937>>>//
32937>>>//  1st Argument      2nd Argument   Return Value
32937>>>//  ------------      ------------   ------------
32937>>>//  123456.87654321         8         123456.87654321
32937>>>//  123456.87654321         2         123456.88
32937>>>// -123456.87654321         2        -123456.88
32937>>>//  123456.98765432         0         123457
32937>>>// -123456.98765432        -1        -123460
32937>>>//  123456.98765432        -2         123500
32937>>>//  123456.98765432        -3         123000
32937>>>//  987654                 -4         990000
32937>>>//  987654                 -5        1000000
32937>>>//  987654                 -6        1000000
32937>>>//  987654                 -7              0
32937>>>//
32937>>>// ===========================================================================
32937>>>
32937>>>
32937>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32938>>>
32938>>>  Local Number nAdj
32939>>>
32939>>>  Move 10000000000000 to nAdj
32940>>>
32940>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32940>>>
32940>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32943>>>
32943>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32943>>>
32943>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32946>>>
32946>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32946>>>
32946>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32947>>>
32947>>>End_Function
32948>Use Connect.Dg
INCLUDING FILE: CONNECT.DG
32948>>>//AB/ Project Connect
32948>>>//AB/ Object prj is a Dialog_Project
32948>>>//AB/     Set ProjectName to "Connect"
32948>>>//AB/     Set ProjectFileName to "Connect.dg"
32948>>>
32948>>>// Project Object Structure
32948>>>//   Connect is a BasicPanelSub
32948>>>//     BitmapContainer1 is a BitmapContainerSub
32948>>>//     Textbox5 is a TextBoxSub
32948>>>//     ComboForm2 is a ComboFormSub
32948>>>//     Textbox6 is a TextBoxSub
32948>>>//     Form4 is a FormSub
32948>>>//     Textbox7 is a TextBoxSub
32948>>>//     Form5 is a FormSub
32948>>>//     Textbox8 is a TextBoxSub
32948>>>//     Form6 is a FormSub
32948>>>//     CheckBox1 is a CheckBoxSub
32948>>>//     oOK_bn is a ButtonSub
32948>>>//     oCancel_bn is a ButtonSub
32948>>>
32948>>>// Register all objects
32948>>>Register_Object BitmapContainer1
32948>>>Register_Object CheckBox1
32948>>>Register_Object ComboForm2
32948>>>Register_Object Connect
32948>>>Register_Object Form4
32948>>>Register_Object Form5
32948>>>Register_Object Form6
32948>>>Register_Object oCancel_bn
32948>>>Register_Object oOK_bn
32948>>>Register_Object Textbox5
32948>>>Register_Object Textbox6
32948>>>Register_Object Textbox7
32948>>>Register_Object Textbox8
32948>>>
32948>>>
32948>>>
32948>>>//AB-StoreTopStart
32948>>>
32948>>>///#INCLUDE
32948>>>Use mertech.inc
INCLUDING FILE: MERTECH.INC
32948>>>>>USE UI
32948>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
32948>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
32948>>>>>// This command will issue a properly commands to define the FETCH attribute status
32948>>>>>// for file fields.
32948>>>>>//
32948>>>>>//------------------------------------------------------------------------------
32948>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SQL_FOR_ONEROW <file number>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
32948>>>>>// one ROW for each DataFlex FIND command issued
32948>>>>>// In this case the DBMS optimizer will generate a query with just one row
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------------------------------------------
32948>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
32948>>>>>//
32948>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
32948>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
32948>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
32948>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
32948>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------
32948>>>>>// SQL_SET <stmt>
32948>>>>>//
32948>>>>>//-----------------------------------------
32948>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
32948>>>>>//
32948>>>>>//------------
32948>>>>>// SQL_EXECUTE
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------
32948>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
32948>>>>>//
32948>>>>>// LOCK_TABLE will lock the entire table specified as an argument
32948>>>>>// This command will start a new transaction if it still wasn't done.
32948>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
32948>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
32948>>>>>// rows and then atualize their buffers
32948>>>>>//
32948>>>>>//
32948>>>>>//-------------------------------------------
32948>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
32948>>>>>//
32948>>>>>//-------------------------------
32948>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
32948>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
32948>>>>>//
32948>>>>>//-------------------------------------------------
32948>>>>>// OPEN_INT <DATAFLEX FILE NAME>
32948>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
32948>>>>>//
32948>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
32948>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
32948>>>>>// will issue a OPEN command
32948>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
32948>>>>>//
32948>>>>>//=========================================================================================================
32948>>>>>// SELECT STUFFS
32948>>>>>//--------------
32948>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
32948>>>>>//
32948>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
32948>>>>>//
32948>>>>>//
32948>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
32948>>>>>//
32948>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
32948>>>>>//
32948>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
32948>>>>>//
32948>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>// SQL_COMMIT_STMT
32948>>>>>//
32948>>>>>// SQL_ROLLBACK_STMT
32948>>>>>//
32948>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
32948>>>>>//
32948>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>//
32948>>>>>//
32948>>>>>//---------------------------------------------------------------------------------------------
32948>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
32948>>>>>// Writes a message inside driver log trace file if this is activated
32948>>>>>//
32948>>>>>//-----------------------------------------------------
32948>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
32948>>>>>// Generating the INT file
32948>>>>>//
32948>>>>>// -----------------------
32948>>>>>// SQL_ERROR_MESSAGE <VAR>
32948>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
32948>>>>>
32948>>>>>
32948>>>>>//=======================================================================================
32948>>>>>// SQLFlex Commands
32948>>>>>//-----------------
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// SQLFlex_REVISION <VAR>
32948>>>>>// Retrieves SQLFlex revision
32948>>>>>//
32948>>>>>//-------------------------------------
32948>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
32948>>>>>// Sets current database
32948>>>>>//
32948>>>>>//---------------------------
32948>>>>>// GET_DATABASE_NAME TO <VAR>
32948>>>>>// Gets name of current database
32948>>>>>//
32948>>>>>//----------------------------------
32948>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
32948>>>>>// Sets current schema name
32948>>>>>//
32948>>>>>//-------------------------
32948>>>>>// GET_SCHEMA_NAME TO <VAR>
32948>>>>>// Gets current schema name
32948>>>>>//
32948>>>>>//--------------------------------
32948>>>>>// SQL_USEDATABASE <DATABASE NAME>
32948>>>>>// Specifies the current Database
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// SET_CURRENT_SERVER TO <VAR>
32948>>>>>// Set the current logged server
32948>>>>>//
32948>>>>>//----------------------------
32948>>>>>// GET_CURRENT_SERVER TO <VAR>
32948>>>>>// Retrieves the current logged server
32948>>>>>//
32948>>>>>//-----------------------------
32948>>>>>// SET_HOST_NAME TO <HOST NAME>
32948>>>>>// Defines current host name
32948>>>>>//
32948>>>>>//-----------------------
32948>>>>>// GET_HOST_NAME TO <VAR>
32948>>>>>// Retrieves the current host name
32948>>>>>//
32948>>>>>//---------------------------------------------------------------
32948>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
32948>>>>>// Specifies host name during login process
32948>>>>>//
32948>>>>>// SQL_CANCEL_QUERY_STMT
32948>>>>>//
32948>>>>>//========================================
32948>>>>>// SQL SERVER Stored Procedure Call engine
32948>>>>>//----------------------------------------
32948>>>>>//
32948>>>>>//
32948>>>>>
32948>>>>>//
32948>>>>>//--------------------------------------------------------------------------------------------------------------
32948>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
32948>>>>>//
32948>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
32948>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
32948>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
32948>>>>>//
32948>>>>>//
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// ORAFlex Commands
32948>>>>>//-----------------
32948>>>>>//----------------------------
32948>>>>>// ORAFlex_REVISION <VARIABLE>
32948>>>>>// Retrieves ORAFlex revision
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
32948>>>>>// Keeps all files opened even during a LOGOUT
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
32948>>>>>//
32948>>>>>//---------------------------------------------
32948>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
32948>>>>>// Retrieves the number of opened cursors
32948>>>>>//
32948>>>>>//-----------------------------------------------
32948>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
32948>>>>>// Activates Time stamp for date columns
32948>>>>>//
32948>>>>>//----------------------------------------------------------------------------------------------------
32948>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
32948>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
32948>>>>>//
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>>>//=============================================================================
32948>>>>>// BUFFER save stuffs
32948>>>>>//-------------------
32948>>>>>
32948>>>>>//-------------------------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
32948>>>>>// Initialize the BUFFER buffer
32948>>>>>//
32948>>>>>//---------------------------------
32948>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
32948>>>>>// Moves field buffer values to cache buffer
32948>>>>>//-------------------------------------
32948>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
32948>>>>>// Save rows that remains in cache
32948>>>>>//-----------------------------------------------------------------------------
32948>>>>>
32948>>>
32948>>>//AB-StoreTopEnd
32948>>>
32948>>>//AB-IgnoreStart
32948>>>
32948>>>Use Panel.Sub
32948>>>Use Bitmap.Sub
32948>>>Use Txtbox.Sub
32948>>>Use Cmbfrm.Sub
32948>>>Use Form.Sub
32948>>>Use Chkbox.Sub
32948>>>Use Button.Sub
32948>>>
32948>>>
32948>>>//AB-IgnoreEnd
32948>>>
32948>>>Object Connect is a BasicPanelSub
32950>>>
32950>>>    //AB-StoreTopStart
32950>>>
32950>>>    //AB-StoreTopEnd
32950>>>
32950>>>    Set Sysmenu_Icon to FALSE
32951>>>    Set Minimize_Icon to FALSE
32952>>>    Set Label to "Login"
32953>>>    Set Size to 105 230
32954>>>    Set Location to 20 37
32955>>>
32955>>>    //AB-DDOStart
32955>>>
32955>>>
32955>>>    //AB-DDOEnd
32955>>>
32955>>>    Object BitmapContainer1 is a BitmapContainerSub
32957>>>        Set Size to 21 23
32958>>>        Set Location to 4 4
32959>>>        Set Bitmap to "Login1.bmp"
32960>>>        Set Border_Style to Border_None
32961>>>        Set Bitmap_Style to Bitmap_Center
32962>>>        Set Dialog_Caption to "Select a bitmap file"
32963>>>
32963>>>        //AB-StoreStart
32963>>>
32963>>>
32963>>>
32963>>>
32963>>>        //AB-StoreEnd
32963>>>
32963>>>    End_Object    // BitmapContainer1
32964>>>
32964>>>    Object Textbox5 is a TextBoxSub
32966>>>        Set Label to "Driver:"
32967>>>        Set FontSize to 4 0
32968>>>        Set Location to 6 34
32969>>>        Set Size to 13 40
32970>>>        Set TypeFace to "MS Sans Serif"
32971>>>        Set Enabled_State to TRUE
32972>>>    End_Object    // Textbox5
32973>>>
32973>>>    Object ComboForm2 is a ComboFormSub
32975>>>
32975>>>        //AB-StoreTopStart
32975>>>
32975>>>        Set CapsLock_State to True
32976>>>
32976>>>        //AB-StoreTopEnd
32976>>>
32976>>>        Set Size to 13 85
32977>>>        Set Location to 6 76
32978>>>        Set Label_Col_Offset to 2
32979>>>        Set Label_Justification_Mode to jMode_Right
32980>>>
32980>>>        //AB-StoreStart
32980>>>        Procedure Combo_Fill_List
32982>>>                Local String Availdrv## TempDrv##
32983>>>                Local Integer HowMany i p1## p2##
32983>>>
32983>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
32986>>>                If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
32989>>>                insert "WorkSpaces\" in AvailDrv## at 1
32991>>>                get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
32994>>>
32994>>>                Move Availdrv## to Tempdrv##
32995>>>                Repeat
32995>>>>
32995>>>                    Replace "|" in Tempdrv## With ""
32997>>>                    [Found] Increment HowMany
32998>>>                Until [Finderr]
33000>>>
33000>>>                Send Combo_add_Item ""
33001>>>
33001>>>                If HowMany lt 1 Begin
33003>>>                    If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
33006>>>                End
33006>>>>
33006>>>                Else Begin
33007>>>                    For i From 0 to HowMany
33013>>>>
33013>>>                        If i eq 0 Move 1 to p1##
33016>>>                        Else Begin
33017>>>                            Move ((Pos("|",Availdrv##))+1) to p1##
33018>>>                            Replace "|" in Availdrv## With ","
33020>>>                        End
33020>>>>
33020>>>                        Move ((Pos("|",Availdrv##))) to p2##
33021>>>                        Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
33022>>>                    Loop
33023>>>>
33023>>>                End
33023>>>>
33023>>>        End_Procedure
33024>>>
33024>>>        Set Allow_Blank_state to True
33025>>>
33025>>>
33025>>>
33025>>>        //AB-StoreEnd
33025>>>
33025>>>    End_Object    // ComboForm2
33026>>>
33026>>>    Object Textbox6 is a TextBoxSub
33028>>>        Set Label to "Server:"
33029>>>        Set FontSize to 4 0
33030>>>        Set Location to 22 34
33031>>>        Set Size to 13 40
33032>>>        Set TypeFace to "MS Sans Serif"
33033>>>        Set Enabled_State to TRUE
33034>>>    End_Object    // Textbox6
33035>>>
33035>>>    Object Form4 is a FormSub
33037>>>        Set Size to 13 93
33038>>>        Set Location to 22 76
33039>>>        Set Label_Col_Offset to 2
33040>>>        Set Label_Justification_Mode to jMode_Right
33041>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33042>>>    End_Object    // Form4
33043>>>
33043>>>    Object Textbox7 is a TextBoxSub
33045>>>        Set Label to "User Name:"
33046>>>        Set FontSize to 4 0
33047>>>        Set Location to 38 34
33048>>>        Set Size to 13 40
33049>>>        Set TypeFace to "MS Sans Serif"
33050>>>        Set Enabled_State to TRUE
33051>>>    End_Object    // Textbox7
33052>>>
33052>>>    Object Form5 is a FormSub
33054>>>        Set Size to 13 93
33055>>>        Set Location to 38 76
33056>>>        Set Label_Col_Offset to 2
33057>>>        Set Label_Justification_Mode to jMode_Right
33058>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33059>>>    End_Object    // Form5
33060>>>
33060>>>    Object Textbox8 is a TextBoxSub
33062>>>        Set Label to "Password:"
33063>>>        Set FontSize to 4 0
33064>>>        Set Location to 54 34
33065>>>        Set Size to 13 40
33066>>>        Set TypeFace to "MS Sans Serif"
33067>>>        Set Enabled_State to TRUE
33068>>>    End_Object    // Textbox8
33069>>>
33069>>>    Object Form6 is a FormSub
33071>>>        Set Size to 13 93
33072>>>        Set Location to 54 76
33073>>>        Set Label_Col_Offset to 2
33074>>>        Set Label_Justification_Mode to jMode_Right
33075>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33076>>>
33076>>>        //AB-StoreStart
33076>>>        Set Password_State Item 0 to True
33077>>>
33077>>>        //AB-StoreEnd
33077>>>
33077>>>    End_Object    // Form6
33078>>>
33078>>>    Object CheckBox1 is a CheckBoxSub
33080>>>        Set Label to "Save Password"
33081>>>        Set Size to 10 66
33082>>>        Set Location to 73 76
33083>>>        Set Status_Help to "Remember The Password at Next Login"
33084>>>    End_Object    // CheckBox1
33085>>>
33085>>>    Object oOK_bn is a ButtonSub
33087>>>        Set Label to "Co&nnect"
33088>>>        Set Default_State to TRUE
33089>>>        Set Bitmap to "mcr.bmp"
33090>>>        Set Size to 28 33
33091>>>        Set Location to 9 184
33092>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33093>>>
33093>>>        //AB-StoreStart
33093>>>        Procedure OnClick
33095>>>            Set LoginOk to True
33096>>>            Send Stop_Modal_ui
33097>>>        End_Procedure
33098>>>        Set Status_Help to "Connect"
33099>>>        //AB-StoreEnd
33099>>>
33099>>>    End_Object    // oOK_bn
33100>>>
33100>>>    Object oCancel_bn is a ButtonSub
33102>>>        Set Label to "&Cancel"
33103>>>        Set Bitmap to "exit2.bmp"
33104>>>        Set Size to 28 32
33105>>>        Set Location to 39 184
33106>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
33107>>>
33107>>>        //AB-StoreStart
33107>>>
33107>>>        ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
33108>>>
33108>>>        Procedure OnClick
33110>>>            Set LoginOk to False
33111>>>            Send Exit_Application to (Connect(Current_Object))
33112>>>        End_Procedure
33113>>>
33113>>>        Set Status_Help to "Close Application"
33114>>>
33114>>>
33114>>>        //AB-StoreEnd
33114>>>
33114>>>    End_Object    // oCancel_bn
33115>>>
33115>>>
33115>>>    //AB-StoreStart
33115>>>
33115>>>    Set Modal_State to True
33116>>>
33116>>>    // Now is WorkspaceAware
33116>>>
33116>>>    ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
33117>>>    ON_KEY KSAVE_RECORD SEND OK
33118>>>    ON_KEY KCANCEL SEND EXIT_APPLICATION
33119>>>    ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
33120>>>
33120>>>    Set Locate_Mode to Center_On_Screen
33121>>>    Set Exit_Application_Local_State to False
33122>>>    Set Exit_MSG to Exit
33123>>>    Set Description_State to True
33124>>>
33124>>>    Property Integer LoginOk public false
33126>>>
33126>>>    External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;        Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33127>>>
33127>>>    Function Network_User_Name Returns String
33129>>>        Local String sName sLength
33130>>>        Local Pointer lpName_Addr lpLength_Addr
33130>>>        Local Integer iRetval
33130>>>
33130>>>        Movestr (Repeat (Character (0), 255)) To sName
33131>>>>
33131>>>        GetAddress Of sName To lpName_Addr
33132>>>        Movestr (DwordToBytes (255)) To sLength
33133>>>>
33133>>>        GetAddress Of sLength To lpLength_Addr
33134>>>
33134>>>        Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33135>>>>
33135>>>
33135>>>        If iRetval Eq 0 Function_Return (CString (sName))
33138>>>        Else Function_Return "User Unknown"
33140>>>    End_Function // Network_User_Name
33141>>>
33141>>>    Function fsCrypto String lsWay String lsOld Returns String
33143>>>        Local String lsNew lsTemp
33144>>>        Local Integer liCount
33144>>>           For liCount From 1 to (Length(lsOld))
33150>>>>
33150>>>               Mid lsOld to lsTemp 1 liCount
33153>>>>
33153>>>               If ((Uppercase(lsWay)) eq 'FORWARD') Begin
33155>>>               If ((Ascii(lsTemp) = 255)) Move (Character(32)) to lsTemp
33158>>>               Else Move (Character(Ascii(lsTemp)+1)) to lsTemp
33160>>>               End
33160>>>>
33160>>>               Else Begin
33161>>>                   If ((Uppercase(lsWay)) eq 'BACKWARD') Begin
33163>>>                       If ((Ascii(lsTemp) = 32)) Move (Character(255)) to lsTemp
33166>>>                       Else Move (Character(Ascii(lsTemp)-1)) to lsTemp
33168>>>                   End
33168>>>>
33168>>>               End
33168>>>>
33168>>>               Append lsNew lsTemp
33169>>>           Loop
33170>>>>
33170>>>        Function_Return (lsNew)
33171>>>    End_Function
33172>>>
33172>>>    Procedure Activating
33174>>>        Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
33175>>>        Local String LastLogin## LoginSeq##
33175>>>        Local Integer SavePassword##
33175>>>
33175>>>        Forward Send Activating
33177>>>
33177>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33180>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33183>>>        insert "WorkSpaces\" in LastLogin## at 1
33185>>>        Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
33188>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33191>>>
33191>>>        If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1))) to LoginDriver##
33194>>>        Else Move LoginSeq## to LoginDriver##
33196>>>        get_profile_string LastLogin## "LoginServer"  to LoginServer##
33199>>>        get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
33202>>>        get_profile_string LastLogin## "SavePassword" to SavePassword##
33205>>>        If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
33208>>>
33208>>>        If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
33210>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to ""
33211>>>                Set Value of (Form4(Current_Object))      Item 0 to ""
33212>>>        End
33212>>>>
33212>>>        Else Begin
33213>>>            Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33214>>>            Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
33215>>>        End
33215>>>>
33215>>>        Set Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33216>>>        Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33217>>>        If (SavePassword##) Begin
33219>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33220>>>            get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
33224>>>            Set Value of (Form6(Current_Object))      Item 0 to (fsCrypto(Self,"backward",LoginPassword##))
33225>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33226>>>        End
33226>>>>
33226>>>    End_Procedure
33227>>>
33227>>>    Function LoginUser Returns Integer
33229>>>        Integer SavePassword## Size## PasswordOk
33230>>>        String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
33230>>>        String lsLoginDate lsHH lsMM lsSS sDepartment
33230>>>        Integer liOpenCursors
33230>>>
33230>>>        Send Popup_Modal
33231>>>
33231>>>        Get Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
33232>>>        Get Value of (Form4(Current_Object))      Item 0 to LoginServer##
33233>>>        Get Value of (Form5(Current_Object))      Item 0 to LoginUserID##
33234>>>        Get Value of (Form6(Current_Object))      Item 0 to LoginPassword##
33235>>>        Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
33236>>>        Set Value of (Form6(Current_Object))      Item 0 to ""
33237>>>
33237>>>    //tolis 03/02/2004
33237>>>        If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
33239>>>    //        send ignore_error to (error_info_object(current_object)) 25000
33239>>>    //        send ignore_error to (error_info_object(current_object)) 4255
33239>>>    //        send ignore_error to (error_info_object(current_object)) 12293
33239>>>    //        login LoginServer## LoginUserId## LoginPassword## LoginDriver##
33239>>>    //        send trap_error to (error_info_object(current_object)) 25000
33239>>>    //        send trap_error to (error_info_object(current_object)) 4255
33239>>>    //        send trap_error to (error_info_object(current_object)) 12293
33239>>>    //        If LastErr eq 25000 Begin
33239>>>    //            Error LastErr "Invalid Login Information"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 4255 Begin
33239>>>    //            Error LastErr "Invalid Driver Name"
33239>>>    //            Set LoginOk to False
33239>>>    //            Send Exit_Application
33239>>>    //        End
33239>>>    //        If LastErr eq 12293 Begin
33239>>>    //            Error LastErr "(IBM CLI)Database alias name or Database name not found"
33239>>>    //            Set LoginOk to False
33239>>>    //           Send Exit_Application
33239>>>    //      End
33239>>>            Set LoginOk to True
33240>>>    //        If (UpperCase(LoginDriver##) = "ORA_DRV") Begin
33240>>>    //            GET_MAX_OPEN_CURSORS of LoginServer## to liOpenCursors
33240>>>    //            If (liOpenCursors <> 0) SET_MAX_OPEN_CURSORS of LoginServer## to (liOpenCursors+2)
33240>>>    //        End
33240>>>        End
33240>>>>
33240>>>        Else Begin
33241>>>            Set LoginOk to True
33242>>>            Open "Users" as Users
INCLUDING FILE: USERS.FD
33244>>>            Move "DATAFLEX" To LoginDriver##
33245>>>            Move "" to LoginServer##
33246>>>            File_Size Users to Size##
33249>>>            If Size## ne 0 Begin
33251>>>                 Clear Users
33252>>>                 Move LoginUSerId##   to Users.Login_Id
33253>>>                 Find eq Users by Index.1
33254>>>>
33254>>>                 [Finderr] Begin
33256>>>>
33256>>>                    Error 25000 "Unknown User"
33257>>>>
33257>>>                    Set LoginOk to False
33258>>>                    Get LoginOk to PasswordOk
33259>>>                    Function_Return PasswordOk
33260>>>                 End
33260>>>>
33260>>>                 [Found] Begin
33262>>>>
33262>>>                    If (LoginPassword## ne Users.Password) Begin
33264>>>                        Error 25000 "Invalid Password"
33265>>>>
33265>>>                        Set LoginOk to False
33266>>>                        Get LoginOk to PasswordOk
33267>>>                        Function_Return PasswordOk
33268>>>                    End
33268>>>>
33268>>>                    Else Move Users.Departm_Code to sDepartment
33270>>>                    Move (Trim(sDepartment)) to sDepartment
33271>>>                 End
33271>>>>
33271>>>            End
33271>>>>
33271>>>            Close Users
33272>>>
33272>>>
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>    //            Integer bFileExists
33272>>>    //            Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>    //            If (NOT(bFileExists)) Begin
33272>>>
33272>>>    //                Get Get_File_Exists  "C:\UsrLogin.txt" To bFileExists
33272>>>    //                If (bFileExists) Begin
33272>>>
33272>>>    ////                        If Size## ne 0 Begin
33272>>>
33272>>>    //                            Local String ss1 ss2 ss3 ss4
33272>>>    //                            Local String dd1 dd2 dd3 dd4
33272>>>    //                            Move '' to dd1
33272>>>    //                            Move '' to dd2
33272>>>    //                            Move '' to dd3
33272>>>    //                            Move '' to dd4
33272>>>
33272>>>    //                            Direct_Input Channel 8 "C:\UsrLogin.txt"
33272>>>    //                            Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            While (Not(Seqeof))
33272>>>    //                                Move (Trim(ss1)) to ss1
33272>>>    //                                Move (Trim(ss2)) to ss2
33272>>>    //                                Move (Trim(ss3)) to ss3
33272>>>    //                                Move (Trim(ss4)) to ss4
33272>>>    //                                Append dd1 '"' ss1 '"'
33272>>>    //                                Append dd2 '"' ss2 '"'
33272>>>    //                                Append dd3 '"' ss3 '"'
33272>>>    //                                Append dd4 '"' ss4 '"'
33272>>>    //                                Login dd1 dd2 dd3 dd4
33272>>>    //                                Readln Channel 8 ss1 ss2 ss3 ss4
33272>>>    //                            Loop
33272>>>
33272>>>
33272>>>    ////                            // Only Filmnet Users Log on to SQL
33272>>>    ////                            If (sDepartment='FILMNET') Begin
33272>>>    ////                                ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                                ////// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                                login '192.168.128.5'   'sa'    ''   'SQL_DRV'
33272>>>    ////                                login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            End
33272>>>    ////                            Else login '192.168.128.5'      'sa'    ''   'SQL_DRV'
33272>>>    ////                            //Else login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>
33272>>>    ////                        End
33272>>>    ////                        Else Begin
33272>>>    ////                            ////// 20/06/2001 js Allagh apo Oracle se SQL server
33272>>>    ////                            ///// login 'E-EPG'           'EPGDNS'    'DNS'   'ORA_DRV'
33272>>>    ////                            login '192.168.128.5'       'sa'    ''   'SQL_DRV'
33272>>>    ////                            //login '192.168.128.5'   'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>    ////                        End
33272>>>
33272>>>
33272>>>    //                End
33272>>>
33272>>>    //            End
33272>>>    //            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>            //*Integer bFileExists
33272>>>            //*Get Get_File_Exists  "C:\AutLogIn.txt" To bFileExists
33272>>>            //*If (NOT(bFileExists)) Begin
33272>>>            //*    If Size## ne 0 Begin
33272>>>            //*        // Only Filmnet Users Log on to SQL
33272>>>            //*        If (sDepartment='FILMNET') Begin
33272>>>            //*            login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*            login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*        End
33272>>>            //*        Else login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*    End
33272>>>            //*    Else Begin
33272>>>            //*        login '192.168.126.51'  'sa'        '1'     'SQL_DRV'
33272>>>            //*        login '192.168.119.120' 'EPGDNS'    'DNS'   'SQL_DRV'
33272>>>            //*    End
33272>>>            //*
33272>>>            //*End
33272>>>            ////// 01/03/2001 + 07/05/2001 H diaforopoihsh tou driver ana department
33272>>>
33272>>>
33272>>>
33272>>>        End
33272>>>>
33272>>>
33272>>>        Open Users
33274>>>        //Open "Users" as Users
33274>>>        File_Size Users to Size##
33277>>>        If Size## ne 0 Begin
33279>>>             Clear Users
33280>>>             Move LoginUSerId##   to Users.Login_Id
33281>>>             Find eq Users by Index.1
33282>>>>
33282>>>             [Finderr] Begin
33284>>>>
33284>>>                Error 25000 "Unknown User"
33285>>>>
33285>>>                Set LoginOk to False
33286>>>                Get LoginOk to PasswordOk
33287>>>                Function_Return PasswordOk
33288>>>             End
33288>>>>
33288>>>             [Found] Begin
33290>>>>
33290>>>                If (LoginPassword## ne Users.Password) Begin
33292>>>                    Error 25000 "Invalid Password"
33293>>>>
33293>>>                    Set LoginOk to False
33294>>>                    Get LoginOk to PasswordOk
33295>>>                    Function_Return PasswordOk
33296>>>                End
33296>>>>
33296>>>                Else Move Users.Departm_Code to sDepartment
33298>>>                Move (Trim(sDepartment)) to sDepartment
33299>>>             End
33299>>>>
33299>>>        End
33299>>>>
33299>>>        Close Users
33300>>>
33300>>>        Get LoginOk to PasswordOk
33301>>>        Sysdate lsLoginDate lsHH lsMM lsSS
33305>>>        get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
33308>>>        If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
33311>>>        insert "WorkSpaces\" in LastLogin## at 1
33313>>>        get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33316>>>        If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
33318>>>           If Not LoginDriver## in LoginSeq## Begin
33320>>>                 If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33323>>>                 Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
33325>>>                 set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
33328>>>           End
33328>>>>
33328>>>        End
33328>>>>
33328>>>        Append LastLogin## "\" (Module_Name(Self))
33330>>>        Append LastLogin## "\LastLogin"
33331>>>        get_profile_string LastLogin## "LoginDriver" to LoginSeq##
33334>>>
33334>>>        If "|" in LoginSeq## Begin
33336>>>            If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
33340>>>        End
33340>>>>
33340>>>        Else Begin
33341>>>            If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
33344>>>            Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
33349>>>        End
33349>>>>
33349>>>        Left LoginSeq## to LoginSeq## 250
33351>>>>
33351>>>        set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
33354>>>        set_profile_string LastLogin## "LoginServer" to LoginServer##
33357>>>        set_profile_string LastLogin## "LoginUserId" to LoginUserId##
33360>>>        set_profile_string LastLogin## "SavePassword" to SavePassword##
33363>>>        If lsHH lt 10 Insert 0 in lsHH at 1
33367>>>        If lsMM lt 10 Insert 0 in lsMM at 1
33371>>>        If lsSS lt 10 Insert 0 in lsSS at 1
33375>>>        Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
33381>>>        set_profile_string LastLogin## "LoginTime" to lsLoginDate
33384>>>        If (SavePassword##) Begin
33386>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33387>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCrypto(Self,"forward",LoginPassword##))
33390>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33391>>>        End
33391>>>>
33391>>>        Else Begin
33392>>>            Set_Registry_Root TO HKEY_CURRENT_USER "Software"
33393>>>            set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
33396>>>            SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
33397>>>        End
33397>>>>
33397>>>
33397>>>        Function_Return PasswordOk
33398>>>    End_Function
33399>>>
33399>>>    Procedure Login For Desktop
33400>>>        Local Integer LoginPassword##
33401>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33402>>>        If Not LoginPassword## Send Exit_Application
33405>>>    End_Procedure
33406>>>
33406>>>    Function CheckLogin For Desktop Returns Integer
33407>>>        Local Integer LoginPassword##
33408>>>        Get LoginUser of (Connect(Current_Object)) to LoginPassword##
33409>>>        Function_Return LoginPassword##
33410>>>    End_Function
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>
33411>>>    //AB-StoreEnd
33411>>>
33411>>>End_Object    // Connect
33412>>>
33412>>>
33412>>>//AB-StoreStart
33412>>>
33412>>>
33412>>>
33412>>>//AB-StoreEnd
33412>>>
33412>>>//AB/ End_Object    // prj
33412>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
33412>>>
33412>>>
33412>>>Function Check_Afm Global String Afm_Num Returns Integer
33413>>>    Integer iii Num1 Num2
33414>>>
33414>>>    Move (Trim(Afm_Num)) To Afm_Num
33415>>>
33415>>>    For iii From 1 To (Length(Trim(Afm_Num)))
33421>>>>
33421>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
33424>>>    Loop
33425>>>>
33425>>>
33425>>>    Move (Right(Afm_Num,1)) to Num2
33426>>>
33426>>>    If (Length(Afm_Num)<>9) Function_Return 2
33429>>>
33429>>>    Move 0 to Num1
33430>>>
33430>>>    For iii From 1 to 8
33436>>>>
33436>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
33437>>>    Loop
33438>>>>
33438>>>
33438>>>    Move (Mod(Num1,11)) to Num1
33439>>>    If (Num1=10) Move 0 to Num1
33442>>>
33442>>>    If (Num1=Num2)  Function_Return 0
33445>>>    Else            Function_Return 1
33447>>>End_Function
33448>>>
33448>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
33448>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
33450>>>open syscurxr
33452>>>open gplan
INCLUDING FILE: GPLAN.FD
33454>>>//open gplanl
33454>>>open iteml
INCLUDING FILE: ITEML.FD
33456>>>open cn
INCLUDING FILE: CN.FD
33458>>>open payresp
INCLUDING FILE: PAYRESP.FD
33460>>>open salesmen
INCLUDING FILE: SALESMEN.FD
33462>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
33464>>>open constrct
INCLUDING FILE: CONSTRCT.FD
33466>>>open clients
INCLUDING FILE: CLIENTS.FD
33468>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
33470>>>open wax
INCLUDING FILE: WAX.FD
33472>>>Function Check_log Global String slog Returns Integer
33473>>>    clear gplan
33474>>>    move syscurxr.company_code to gplan.company_code
33475>>>    move syscurxr.branch_code  to gplan.branch_code
33476>>>    move syscurxr.year_year    to gplan.year_year
33477>>>    move slog                  to gplan.gplan_code
33478>>>    find eq gplan by index.1
33479>>>>
33479>>>    if (found=1) function_return 0
33482>>>    else         function_return 1
33484>>>
33484>>>End_Function
33485>>>
33485>>>Function Check_last Global String slog Returns Integer
33486>>>    clear gplan
33487>>>    move syscurxr.company_code to gplan.company_code
33488>>>    move syscurxr.branch_code  to gplan.branch_code
33489>>>    move syscurxr.year_year    to gplan.year_year
33490>>>    move slog                  to gplan.gplan_code
33491>>>    find eq gplan by index.1
33492>>>>
33492>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
33495>>>    else                                         Function_return 1
33497>>>
33497>>>End_Function
33498>>>
33498>>>Function fsgplandescr String slog Returns string
33499>>>    clear gplan
33500>>>    move syscurgl.company_code to gplan.company_code
33501>>>    move syscurgl.branch_code  to gplan.branch_code
33502>>>    move syscurgl.year_year    to gplan.year_year
33503>>>    move slog                  to gplan.gplan_code
33504>>>    find eq gplan by index.1
33505>>>>
33505>>>    if (found=1) function_return gplan.gplan_descr1
33508>>>    else         function_return ''
33510>>>
33510>>>End_Function
33511>>>
33511>>>//Function fsgplanperi String slog Returns string
33511>>>//    string sdescr
33511>>>//    clear gplanl
33511>>>//    move syscurgl.company_code to  gplanl.company_code
33511>>>//    move syscurgl.branch_code  to  gplanl.branch_code
33511>>>//    move slog                  to  gplanl.gplan_code
33511>>>//    find eq gplanl by index.1
33511>>>//    if (found=1) begin
33511>>>//        move gplanl.gplan_descr1 to sdescr
33511>>>//        function_return sdescr
33511>>>//    end
33511>>>//    else         function_return ''
33511>>>//End_Function
33511>>>
33511>>>
33511>>>
33511>>>Function fsclient string code Returns string
33512>>>    string name
33513>>>    clear clients
33514>>>    move code to clients.client_id
33515>>>    find eq clients by index.6
33516>>>>
33516>>>    if (found) move clients.client_name to name
33519>>>    else       move '' to name
33521>>>    function_return name
33522>>>end_Function
33523>>>
33523>>>Function fspayresp string code Returns string
33524>>>    string name
33525>>>    clear payresp
33526>>>    move code to payresp.presp_id
33527>>>    find eq payresp by index.7
33528>>>>
33528>>>    if (found) move payresp.presp_name to name
33531>>>    else       move '' to name
33533>>>    function_return name
33534>>>end_Function
33535>>>
33535>>>Function fssalesmen string code Returns string
33536>>>    string name
33537>>>    clear salesmen
33538>>>    move code to salesmen.sls_id
33539>>>    find eq salesmen by index.4
33540>>>>
33540>>>    if (found) move salesmen.sls_name to name
33543>>>    else       move '' to name
33545>>>    function_return name
33546>>>end_Function
33547>>>
33547>>>Function fsconstrct string code Returns string
33548>>>    string name
33549>>>    clear constrct
33550>>>    move code to constrct.cnt_id
33551>>>    find eq constrct by index.5
33552>>>>
33552>>>    if (found) move constrct.cnt_name to name
33555>>>    else       move '' to name
33557>>>    function_return name
33558>>>end_Function
33559>>>
33559>>>Function fsmhxanik string code Returns string
33560>>>    string name
33561>>>    clear mhxanik
33562>>>    move code to mhxanik.mhx_id
33563>>>    find eq mhxanik by index.4
33564>>>>
33564>>>    if (found) move mhxanik.mhx_name to name
33567>>>    else       move '' to name
33569>>>    function_return name
33570>>>end_Function
33571>>>
33571>>>
33571>>>Function fsptyppar string code Returns string
33572>>>    string sdescr
33573>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33574>>>    move syscurxr.company_code to ptypparl.company_code
33575>>>    move syscurxr.branch_code  to ptypparl.branch_code
33576>>> //   move syscurxr.year_year    to ptypparl.year_year
33576>>>    move code                  to ptypparl.ptyppar_code
33577>>>    find eq ptypparl by index.1
33578>>>>
33578>>>    move ptypparl.ptyppar_descr to sdescr
33579>>>    function_return sdescr
33580>>>end_Function
33581>>>
33581>>>Function fsgplan string code Returns string
33582>>>    string sdescr
33583>>>    clear gplan
33584>>>    move syscurxr.company_code to gplan.company_code
33585>>>    move syscurxr.branch_code  to gplan.branch_code
33586>>>    move syscurxr.year_year    to gplan.year_year
33587>>>    move code                  to gplan.gplan_code
33588>>>    find eq gplan by index.1
33589>>>>
33589>>>    move gplan.gplan_descr1    to sdescr
33590>>>    function_return sdescr
33591>>>end_Function
33592>>>
33592>>>Function fsitem string scode Returns string
33593>>>    clear iteml
33594>>>    move scode to iteml.item_code
33595>>>    find eq iteml by index.5
33596>>>>
33596>>>    function_return iteml.item_descr
33597>>>end_Function
33598>>>
33598>>>Function fswax string srecr Returns string
33599>>>    clear wax
33600>>>    move srecr to wax.wax_recr
33601>>>    find eq wax by index.2
33602>>>>
33602>>>    function_return wax.wax_descr
33603>>>end_Function
33604>>>
33604>>>
33604>>>Function fswitemx string code Returns string
33605>>>    string name
33606>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33607>>>    move syscurxr.company_code to witemx.company_code
33608>>>    move syscurxr.branch_code  to witemx.branch_code
33609>>>    move syscurxr.year_year    to witemx.year_year
33610>>>    move code to witemx.witemx_code
33611>>>    find eq witemx by index.5
33612>>>>
33612>>>    move witemx.witemx_descr to name
33613>>>    function_return name
33614>>>end_Function
33615>>>
33615>>>Function fsCNDescr String asItem Returns String
33616>>>    Clear CN
33617>>>    move asItem to CN.CN_Code
33618>>>    Find Eq CN by Index.5
33619>>>>
33619>>>    Function_Return CN.CN_Descr
33620>>>End_Function
33621>>>
33621>>>Function fswtypkin String askin Returns String
33622>>>    Clear Wtypkin
33623>>>    move askin to Wtypkin.wtypkin_code
33624>>>    Find Eq wtypkin by Index.1
33625>>>>
33625>>>    Function_Return Wtypkin.wtypkin_descr
33626>>>End_Function
33627>>>
33627>>>Function FindGtypkinDescr Integer aiCode Returns String
33628>>>    String lsDescr
33629>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33630>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33631>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33632>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33633>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33634>>>    Find eq Gtypkin by Index.1
33635>>>>
33635>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33636>>>    Function_Return lsDescr
33637>>>End_Function // FindGtypkinDescr
33638>>>
33638>>>Function FindBtypkinDescr Integer aiCode Returns String
33639>>>    String lsDescr
33640>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33641>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33642>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33643>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33644>>>    Move aiCode                   to Btypkin.btypkin_Code
33645>>>    Find eq Btypkin by Index.1
33646>>>>
33646>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33647>>>    Function_Return lsDescr
33648>>>End_Function // FindGtypkinDescr
33649>>>
33649>>>
33649>Send Login
33650>Use TranLock
INCLUDING FILE: TRANLOCK.PKG
33650>>>// Statement of purpose:
33650>>>// When using a reread command in VDF you will unfortunately lock many more
33650>>>// files than are necessary.  In order to only lock the files necessary I
33650>>>// use the following procedure to set all files to readonly, manually set
33650>>>// the files being worked on to (default) and then reset all back at the end.
33650>>>// This is what a data dictionary does in a VDF program for it's ddo tree.
33650>>>
33650>>>// The original package is a contribution of another programmer whom I cannot
33650>>>// remember their name (sorry).  The alteration I have done is to make sure that any file
33650>>>// with a non-default filemode will be set back to it's previous setting.
33650>>>
33650>>>Object FileModeArray Is An Array
33652>>>    // 0 = File Number
33652>>>    // 1 = Non-Default FileMode Existing Before Change By ChangeAllFileModes Procedure
33652>>>End_Object
33653>>>
33653>>>Procedure Write_Attribute_Array Integer iFile Integer iFileMode
33654>>>    Integer iCounter hArray iExists
33655>>>    Move (FileModeArray(Self)) To hArray
33656>>>    For iCounter From 0 To 1000
33662>>>>
33662>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33663>>>        If (Not(iExists) Or (iExists = iFile)) Begin
33665>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 0) To iFile
33666>>>            Set Array_Value Of hArray Item ((iCounter * 2) + 1) To iFileMode
33667>>>        End
33667>>>>
33667>>>        If (Not(iExists) Or (iExists = iFile)) Break
33670>>>    Loop
33671>>>>
33671>>>End_Procedure
33672>>>
33672>>>Procedure Clear_FileModeArray
33673>>>    Send Delete_Data To (FileModeArray(Self))
33674>>>End_Procedure
33675>>>
33675>>>Function Is_NonStandardFileMode Integer iFile Returns Integer
33676>>>    Integer iCounter iExists iNonStandardFileMode hArray
33677>>>    Move (FileModeArray(Self)) To hArray
33678>>>    For iCounter From 0 To 1000
33684>>>>
33684>>>        Get Array_Value Of hArray Item ((iCounter * 2) + 0) To iExists
33685>>>        If (Not(iExists)) Function_Return 0 // Not Listed In Array
33688>>>        If (iExists = iFile) Begin
33690>>>            Get Array_Value Of hArray Item ((iCounter * 2) + 1) To iNonStandardFileMode
33691>>>            Function_Return iNonStandardFileMode
33692>>>        End
33692>>>>
33692>>>    Loop
33693>>>>
33693>>>    Function_Return
33694>>>End_Function
33695>>>
33695>>>Procedure ChangeAllFileModes Integer iMode
33696>>>    Integer iFile iExistingFileMode iNonStandardFileMode
33697>>>    If (iMode = DF_FileMode_ReadOnly) Send Clear_FileModeArray
33700>>>    Repeat
33700>>>>
33700>>>        // Get Each Opened File, One At A Time...
33700>>>        Get_Attribute DF_File_Next_Opened Of iFile To iFile
33703>>>        If (Not(iFile)) Break
33706>>>        If (iMode = DF_Filemode_ReadOnly) Begin  // Setting All Files To Readonly: Check Alias Stuff
33708>>>            Get_Attribute DF_File_Mode Of iFile To iExistingFileMode
33711>>>            If (iExistingFileMode <> DF_Filemode_Default) Send Write_Attribute_Array iFile iExistingFileMode
33714>>>        End
33714>>>>
33714>>>        If (iMode = DF_Filemode_Default) Begin  // Setting All Files Back To Default
33716>>>            Get Is_NonStandardFileMode iFile To iNonStandardFileMode
33717>>>        End
33717>>>>
33717>>>        If (iNonStandardFileMode) Set_Attribute DF_File_Mode Of iFile To iNonStandardFileMode
33722>>>        Else                      Set_Attribute DF_File_Mode Of iFile To iMode
33726>>>    Loop
33727>>>>
33727>>>End_Procedure
33728>>>
33728>>>// // Comment: Example Of Usage:
33728>>>//    Send ChangeAllFileModes DF_Filemode_ReadOnly  // See Stark.Pkg for This Desktop Procedure
33728>>>// // Comment: Set All Open Files To ReadOnly Except For... (Files Used In Transaction Block)
33728>>>//    Set_Attribute DF_File_Mode Of MyFile1.File_Number To DF_Filemode_Default
33728>>>//    Set_Attribute DF_File_Mode Of MyFile2.File_Number  To DF_Filemode_Default
33728>>>//    Indicate Err False
33728>>>//    Begin_Transaction
33728>>>//
33728>>>//        Clear MyFile1
33728>>>//        Move 1 To MyFile1.Key
33728>>>//        Find EQ MyFile1 By Index.1
33728>>>//        Relate MyFile1
33728>>>//        Add MyFile2.Amount To MyFile1.Amount
33728>>>//        Saverecord MyFile1
33728>>>//        Saverecord MyFile2
33728>>>//        If (Condition) Error 300 "Error Message Here" // Saves Rolled Back
33728>>>//
33728>>>//    End_Transaction
33728>>>//    If (Err) Begin
33728>>>//        Send Info_Box "Errors Were Encountered: No Files Were Altered By This Process (All Changes Rolled Back)"
33728>>>//    End
33728>>>//    Send ChangeAllFileModes DF_Filemode_Default  // Set FileModes Back From Readonly To Normal
INCLUDING FILE: XRHSH.PKG
33728>>//------------------------------
33728>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
33728>>>>//AB/ Project Select / Change Xrhsh
33728>>>>//AB/ Object prj is a Dialog_Project
33728>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
33728>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
33728>>>>
33728>>>>// Project Object Structure
33728>>>>//   oSelectYear is a dbModalPanelSub
33728>>>>//     Company_DD is a DataDictionary
33728>>>>//     Branch_DD is a DataDictionary
33728>>>>//     Year_DD is a DataDictionary
33728>>>>//     Company_Company_Code is a dbFormSub
33728>>>>//     Company_Company_Name is a dbFormSub
33728>>>>//     Branch_Branch_Code is a dbFormSub
33728>>>>//     Branch_Branch_Name is a dbFormSub
33728>>>>//     Year_Year_Year is a dbFormSub
33728>>>>//     Year_Year_Descr is a dbFormSub
33728>>>>//     Year_Year_Entrydate is a dbFormSub
33728>>>>//     oOk_bn is a ButtonSub
33728>>>>//     oCancel_bn is a ButtonSub
33728>>>>//     otxtCompany is a TextBoxSub
33728>>>>//     otxtBranch is a TextBoxSub
33728>>>>//     otxtYear is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     otxtWorkingDay is a TextBoxSub
33728>>>>//     chkxr is a CheckBoxSub
33728>>>>
33728>>>>// Register all objects
33728>>>>Register_Object Branch_Branch_Code
33728>>>>Register_Object Branch_Branch_Name
33728>>>>Register_Object Branch_DD
33728>>>>Register_Object Company_Company_Code
33728>>>>Register_Object Company_Company_Name
33728>>>>Register_Object Company_DD
33728>>>>Register_Object chkxr
33728>>>>Register_Object oCancel_bn
33728>>>>Register_Object oOk_bn
33728>>>>Register_Object oSelectYear
33728>>>>Register_Object otxtBranch
33728>>>>Register_Object otxtCompany
33728>>>>Register_Object otxtWorkingDay
33728>>>>Register_Object otxtYear
33728>>>>Register_Object Year_DD
33728>>>>Register_Object Year_Year_Descr
33728>>>>Register_Object Year_Year_Entrydate
33728>>>>Register_Object Year_Year_Year
33728>>>>
33728>>>>
33728>>>>
33728>>>>//AB-StoreTopStart
33728>>>>
33728>>>>
33728>>>>
33728>>>>
33728>>>>       String  gs_selected_beto_site
33728>>>>
33728>>>>Open SysCurXR
33730>>>>Open Nomisma
33732>>>>
33732>>>>//AB-StoreTopEnd
33732>>>>
33732>>>>//AB-IgnoreStart
33732>>>>
33732>>>>Use DFAllEnt.pkg
33732>>>>Use dbForm.Sub
33732>>>>Use Button.Sub
33732>>>>Use Txtbox.Sub
33732>>>>Use Chkbox.Sub
33732>>>>
33732>>>>
33732>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
33732>>>>>>//DDB-FileStart
33732>>>>>>//DDB-HeaderStart
33732>>>>>>
33732>>>>>>// File Name : COMPANY.DD
33732>>>>>>// Class Name: Company_DataDictionary
33732>>>>>>// Revision  : 62
33732>>>>>>// Version   : 2
33732>>>>>>
33732>>>>>>Use  Windows           // Basic Definitions
33732>>>>>>Use  DataDict          // DataDictionary Class Definition
33732>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33732>>>>>>
33732>>>>>>Open Company
INCLUDING FILE: COMPANY.FD
33734>>>>>>Open Branch
33736>>>>>>
33736>>>>>>//DDB-HeaderEnd
33736>>>>>>//DDB-ValidationStart
33736>>>>>>
33736>>>>>>Register_Object Company_Company_Doy_VT
33736>>>>>>Register_Object Company_Company_J_Code_VT
33736>>>>>>
33736>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
33738>>>>>>    Set Type_Value        To "DOY"
33739>>>>>>    Set Allow_Blank_State To TRUE
33740>>>>>>    //DDB-ValidationCustomStart
33740>>>>>>    //DDB-ValidationCustomEnd
33740>>>>>>End_Object   // Company_Company_Doy_VT
33741>>>>>>
33741>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
33743>>>>>>    Set Type_Value        To "JOB"
33744>>>>>>    Set Allow_Blank_State To TRUE
33745>>>>>>    //DDB-ValidationCustomStart
33745>>>>>>    //DDB-ValidationCustomEnd
33745>>>>>>End_Object   // Company_Company_J_Code_VT
33746>>>>>>//DDB-ValidationEnd
33746>>>>>>//DDB-SelectionStart
33746>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
33746>>>>>>Register_Object sl001
33746>>>>>>//DDB-SelectionEnd
33746>>>>>> 
33746>>>>>>Class Company_DataDictionary  is a DataDictionary
33747>>>>>> 
33747>>>>>>    // Update:
33747>>>>>> 
33747>>>>>>    Procedure Update
33748>>>>>>        Forward Send Update
33750>>>>>>        move 'DOY' to company.doy_type
33751>>>>>>        move 'JOB' to company.jcode_type 
33752>>>>>>        // Insert Code Here
33752>>>>>>    End_Procedure   // Update
33753>>>>>> 
33753>>>>>>
33753>>>>>>    // Operation_Not_Allowed:
33753>>>>>>
33753>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33754>>>>>>        // Insert Code Here
33754>>>>>>        Case Begin
33754>>>>>>             Case (iError_Num = 1001)
33756>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
33757>>>>>>>
33757>>>>>>             Case Break
33758>>>>>>
33758>>>>>>             Case Else
33758>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33760>>>>>>        Case End
33760>>>>>>    End_Procedure   // Operation_Not_Allowed
33761>>>>>>
33761>>>>>>
33761>>>>>>    // Validate_Save:
33761>>>>>>
33761>>>>>>    Function Validate_Save  Returns Integer
33762>>>>>>        Local Integer iReturnVal
33763>>>>>>        Forward Get Validate_Save  To iReturnVal
33765>>>>>>        If (Not(iReturnVal)) Begin
33767>>>>>>            // Insert Code Here
33767>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
33770>>>>>>        End
33770>>>>>>>
33770>>>>>>        Function_Return iReturnVal
33771>>>>>>    End_Function   // Validate_Save
33772>>>>>>
33772>>>>>>
33772>>>>>>    // Define_Fields:
33772>>>>>>    // This procedure is used to set up all data-dictionary rules.
33772>>>>>>
33772>>>>>>    Procedure Define_Fields
33773>>>>>>        Forward Send Define_Fields
33775>>>>>>        //DDB-Generated-Code-Location
33775>>>>>>        //DDB-DefineFieldStart
33775>>>>>>
33775>>>>>>        Set Main_File            To Company.File_Number
33776>>>>>>        Set Cascade_Delete_State To FALSE
33777>>>>>>
33777>>>>>>
33777>>>>>>        // Child (Client) file structure................
33777>>>>>>        Send Add_Client_File  Branch.File_Number
33778>>>>>>
33778>>>>>>        // Field-based properties.......................
33778>>>>>>
33778>>>>>>        // Company.Company_Code
33778>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
33779>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
33780>>>>>>
33780>>>>>>        // Company.Company_Name
33780>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
33781>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
33782>>>>>>
33782>>>>>>        // Company.Company_Afm
33782>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
33783>>>>>>
33783>>>>>>        // Company.Company_Addr
33783>>>>>>
33783>>>>>>        // Company.Company_Tk
33783>>>>>>
33783>>>>>>        // Company.Company_Poli
33783>>>>>>
33783>>>>>>        // Company.Company_Doy
33783>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
33784>>>>>>
33784>>>>>>        // Company.Company_J_Code
33784>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
33785>>>>>>
33785>>>>>>        // Company.Company_C_Code0
33785>>>>>>
33785>>>>>>        // Company.Company_C_Cod00
33785>>>>>>
33785>>>>>>        // Company.Company_C_Coder
33785>>>>>>
33785>>>>>>        // Company.Company_Tel
33785>>>>>>
33785>>>>>>        // Company.Company_Fax
33785>>>>>>
33785>>>>>>        // Company.Company_Email
33785>>>>>>
33785>>>>>>        // Company.Company_Resp
33785>>>>>>
33785>>>>>>        // Company.Company_Bitmap
33785>>>>>>
33785>>>>>>        // Company.Beto_Site
33785>>>>>>
33785>>>>>>        // Company.Logo
33785>>>>>>
33785>>>>>>        // Company.Doy_Type
33785>>>>>>
33785>>>>>>        // Company.Jcode_Type
33785>>>>>>
33785>>>>>>        // Company.Sap_Code
33785>>>>>>
33785>>>>>>        // Company.Sap_Path
33785>>>>>>
33785>>>>>>        //DDB-DefineFieldEnd
33785>>>>>>    End_Procedure    // Define_Fields
33786>>>>>>
33786>>>>>>    // Field_Defaults:
33786>>>>>>    // This procedure is used to establish default field values.
33786>>>>>>
33786>>>>>>    Procedure Field_Defaults
33787>>>>>>        Forward Send Field_Defaults
33789>>>>>>        //DDB-Generated-Code-Location
33789>>>>>>        //DDB-FieldDefaultStart
33789>>>>>>        //DDB-FieldDefaultEnd
33789>>>>>>    End_Procedure    // Field_Defaults
33790>>>>>>End_Class    // Company_DataDictionary
33791>>>>>>
33791>>>>>>//DDB-Selection-pkg-Start
33791>>>>>>
33791>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
33791>>>>>>>>//AB/ Project sl001 : Etairies
33791>>>>>>>>//AB/     Object prj is a Lookup_Project
33791>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
33791>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
33791>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
33791>>>>>>>>
33791>>>>>>>>// Project Object Structure
33791>>>>>>>>//   sl001 is a dbModalPanel
33791>>>>>>>>//     Company_DD is a DataDictionary
33791>>>>>>>>//     oSelList is a dbList
33791>>>>>>>>//     oOK_bn is a ButtonSub
33791>>>>>>>>//     oCancel_bn is a ButtonSub
33791>>>>>>>>//     oSearch_bn is a ButtonSub
33791>>>>>>>>
33791>>>>>>>>// Register all objects
33791>>>>>>>>Register_Object Company_DD
33791>>>>>>>>Register_Object oCancel_bn
33791>>>>>>>>Register_Object oOK_bn
33791>>>>>>>>Register_Object oSearch_bn
33791>>>>>>>>Register_Object oSelList
33791>>>>>>>>Register_Object sl001
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    //AB-IgnoreStart
33791>>>>>>>>
33791>>>>>>>>    Use DFAllEnt.pkg
33791>>>>>>>>    Use Button.Sub
33791>>>>>>>>
33791>>>>>>>>
33791>>>>>>>>    Use COMPANY.DD
33791>>>>>>>>    
33791>>>>>>>>    //AB-IgnoreEnd
33791>>>>>>>>
33791>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
33810>>>>>>>>        Set Label to "„«˜ ¨åœª"
33811>>>>>>>>        Set Size to 148 297
33812>>>>>>>>        Set Location to 12 27
33813>>>>>>>>
33813>>>>>>>>        //AB-DDOStart
33813>>>>>>>>
33813>>>>>>>>        Object Company_DD is a Company_DataDictionary
33815>>>>>>>>        End_Object    // Company_DD
33816>>>>>>>>
33816>>>>>>>>        Set Main_DD to (Company_DD(self))
33817>>>>>>>>        Set Server to (Company_DD(self))
33818>>>>>>>>
33818>>>>>>>>        //AB-DDOEnd
33818>>>>>>>>
33818>>>>>>>>        Object oSelList is a dbList
33820>>>>>>>>            Set Main_File to Company.File_Number
33821>>>>>>>>            Set Size to 105 280
33822>>>>>>>>            Set Location to 6 6
33823>>>>>>>>
33823>>>>>>>>            Begin_Row
33826>>>>>>>>                Entry_Item Company.Company_code
33827>>>>>>>>                Entry_Item Company.Company_name
33828>>>>>>>>                Entry_Item Company.Company_afm
33829>>>>>>>>            End_Row
33834>>>>>>>>
33834>>>>>>>>            Set Form_Width    item 0 to 42
33835>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
33836>>>>>>>>            
33836>>>>>>>>            Set Form_Width    item 1 to 150
33837>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
33838>>>>>>>>            
33838>>>>>>>>            Set Form_Width    item 2 to 80
33839>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
33840>>>>>>>>            
33840>>>>>>>>        End_Object    // oSelList
33841>>>>>>>>
33841>>>>>>>>        Object oOK_bn is a ButtonSub
33843>>>>>>>>            Set Label to "&„§ ¢¦šã"
33844>>>>>>>>            Set Location to 115 126
33845>>>>>>>>
33845>>>>>>>>            //AB-StoreStart
33845>>>>>>>>            Procedure OnClick
33847>>>>>>>>                Send OK To (oSelList(current_object))
33848>>>>>>>>            End_Procedure
33849>>>>>>>>            //AB-StoreEnd
33849>>>>>>>>
33849>>>>>>>>        End_Object    // oOK_bn
33850>>>>>>>>
33850>>>>>>>>        Object oCancel_bn is a ButtonSub
33852>>>>>>>>            Set Label to "&€¡ç¨à©ž"
33853>>>>>>>>            Set Location to 115 181
33854>>>>>>>>
33854>>>>>>>>            //AB-StoreStart
33854>>>>>>>>            Procedure OnClick
33856>>>>>>>>                Send Cancel To (oSelList(current_object))
33857>>>>>>>>            End_Procedure
33858>>>>>>>>            //AB-StoreEnd
33858>>>>>>>>
33858>>>>>>>>        End_Object    // oCancel_bn
33859>>>>>>>>
33859>>>>>>>>        Object oSearch_bn is a ButtonSub
33861>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
33862>>>>>>>>            Set Location to 115 236
33863>>>>>>>>
33863>>>>>>>>            //AB-StoreStart
33863>>>>>>>>            Procedure OnClick
33865>>>>>>>>                Send Search To (oSelList(current_object))
33866>>>>>>>>            End_Procedure
33867>>>>>>>>            //AB-StoreEnd
33867>>>>>>>>
33867>>>>>>>>        End_Object    // oSearch_bn
33868>>>>>>>>
33868>>>>>>>>
33868>>>>>>>>        //AB-StoreStart
33868>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
33869>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
33870>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
33871>>>>>>>>        //AB-StoreEnd
33871>>>>>>>>
33871>>>>>>>>    CD_End_Object    // sl001
33873>>>>>>>>>
33873>>>>>>>>
33873>>>>>>>>//AB/     End_Object    // prj
33873>>>>>>
33873>>>>>>//DDB-Selection-pkg-End
33873>>>>>>//DDB-FileEnd
33873>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
33873>>>>>>//DDB-FileStart
33873>>>>>>//DDB-HeaderStart
33873>>>>>>
33873>>>>>>// File Name : BRANCH.DD
33873>>>>>>// Class Name: Branch_DataDictionary
33873>>>>>>// Revision  : 92
33873>>>>>>// Version   : 2
33873>>>>>>
33873>>>>>>Use  Windows           // Basic Definitions
33873>>>>>>Use  DataDict          // DataDictionary Class Definition
33873>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
33873>>>>>>
33873>>>>>>Open Branch
33875>>>>>>Open Year
33877>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
33879>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
33881>>>>>>Open Company
33883>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
33885>>>>>>
33885>>>>>>//DDB-HeaderEnd
33885>>>>>>//DDB-ValidationStart
33885>>>>>>
33885>>>>>>Register_Object Branch_Branch_Doy_VT
33885>>>>>>Register_Object Branch_Branch_C_Code0_VT
33885>>>>>>
33885>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
33887>>>>>>    Set Type_Value        To "DOY"
33888>>>>>>    Set Validate_State    To FALSE
33889>>>>>>    Set Allow_Blank_State To TRUE
33890>>>>>>    //DDB-ValidationCustomStart
33890>>>>>>    //DDB-ValidationCustomEnd
33890>>>>>>End_Object   // Branch_Branch_Doy_VT
33891>>>>>>
33891>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
33893>>>>>>    Set Type_Value        To ""
33894>>>>>>    Set Allow_Blank_State To TRUE
33895>>>>>>    //DDB-ValidationCustomStart
33895>>>>>>    //DDB-ValidationCustomEnd
33895>>>>>>End_Object   // Branch_Branch_C_Code0_VT
33896>>>>>>//DDB-ValidationEnd
33896>>>>>>//DDB-SelectionStart
33896>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
33896>>>>>>Register_Object SL002
33896>>>>>>//DDB-SelectionEnd
33896>>>>>>
33896>>>>>>Class Branch_DataDictionary  is a DataDictionary
33897>>>>>> 
33897>>>>>>    Procedure Save_Main_File
33898>>>>>>        Forward Send Save_Main_File
33900>>>>>>        // Insert Code Here
33900>>>>>>    End_Procedure   // Save_Main_File
33901>>>>>> 
33901>>>>>>    Procedure Creating
33902>>>>>>        Forward Send Creating
33904>>>>>>        // Insert Code Here
33904>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
33905>>>>>>    End_Procedure   // Creating
33906>>>>>>
33906>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
33907>>>>>>        // Insert Code Here
33907>>>>>>        Case Begin
33907>>>>>>             Case (iError_Num = 1001)
33909>>>>>>                  Error 1001 "DDC 052:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
33910>>>>>>>
33910>>>>>>             Case Break
33911>>>>>>
33911>>>>>>             Case Else
33911>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
33913>>>>>>        Case End
33913>>>>>>    End_Procedure   // Operation_Not_Allowed
33914>>>>>>
33914>>>>>>
33914>>>>>>    // Validate_Save:
33914>>>>>>
33914>>>>>>    Function Validate_Save  Returns Integer
33915>>>>>>        Local Integer iReturnVal
33916>>>>>>        Forward Get Validate_Save  To iReturnVal
33918>>>>>>        If (Not(iReturnVal)) Begin
33920>>>>>>            // Insert Code Here
33920>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
33923>>>>>>        End
33923>>>>>>>
33923>>>>>>        Function_Return iReturnVal
33924>>>>>>    End_Function   // Validate_Save
33925>>>>>>
33925>>>>>>
33925>>>>>>    // Define_Fields:
33925>>>>>>    // This procedure is used to set up all data-dictionary rules.
33925>>>>>>
33925>>>>>>    Procedure Define_Fields
33926>>>>>>        Forward Send Define_Fields
33928>>>>>>        //DDB-Generated-Code-Location
33928>>>>>>        //DDB-DefineFieldStart
33928>>>>>>
33928>>>>>>        Set Main_File            To Branch.File_Number
33929>>>>>>        Set Cascade_Delete_State To FALSE
33930>>>>>>
33930>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
33931>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
33932>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
33933>>>>>>
33933>>>>>>        // Child (Client) file structure................
33933>>>>>>        Send Add_Client_File  Year.File_Number
33934>>>>>>        Send Add_Client_File  Brzones.File_Number
33935>>>>>>        Send Add_Client_File  Tpbranch.File_Number
33936>>>>>>
33936>>>>>>        // Parent (Server) file structure...............
33936>>>>>>        Send Add_Server_File  Company.File_Number
33937>>>>>>
33937>>>>>>        // External (System) file structure.............
33937>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
33938>>>>>>
33938>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
33941>>>>>>
33941>>>>>>        // Field-based properties.......................
33941>>>>>>
33941>>>>>>        // Branch.Company_Code
33941>>>>>>
33941>>>>>>        // Branch.Branch_Code
33941>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
33942>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
33943>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
33944>>>>>>
33944>>>>>>        // Branch.Branch_Rec0
33944>>>>>>
33944>>>>>>        // Branch.Branch_Recr
33944>>>>>>
33944>>>>>>        // Branch.Branch_Name
33944>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
33945>>>>>>
33945>>>>>>        // Branch.Branch_Afm
33945>>>>>>
33945>>>>>>        // Branch.Branch_Addr
33945>>>>>>
33945>>>>>>        // Branch.Branch_Tk
33945>>>>>>
33945>>>>>>        // Branch.Branch_Poli
33945>>>>>>
33945>>>>>>        // Branch.Branch_Doy
33945>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
33946>>>>>>
33946>>>>>>        // Branch.Branch_J_Code
33946>>>>>>
33946>>>>>>        // Branch.Branch_C_Code0
33946>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Code00
33947>>>>>>
33947>>>>>>        // Branch.Branch_C_Coder
33947>>>>>>
33947>>>>>>        // Branch.Branch_Tel
33947>>>>>>
33947>>>>>>        // Branch.Branch_Fax
33947>>>>>>
33947>>>>>>        // Branch.Branch_Email
33947>>>>>>
33947>>>>>>        // Branch.Branch_Resp
33947>>>>>>
33947>>>>>>        // Branch.Branch_Bitmap
33947>>>>>>
33947>>>>>>        // Branch.Branch_Site
33947>>>>>>
33947>>>>>>        // Branch.Branch_Apoth
33947>>>>>>
33947>>>>>>        // Branch.Beto_Site
33947>>>>>>
33947>>>>>>        // Branch.Path_Exp
33947>>>>>>
33947>>>>>>        // Branch.Exp_Txtname
33947>>>>>>
33947>>>>>>        // Branch.Send_Phone
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Files
33947>>>>>>
33947>>>>>>        // Branch.Send_Path_Conf
33947>>>>>>
33947>>>>>>        // Branch.Tomeas_Code
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Retry
33947>>>>>>
33947>>>>>>        // Branch.Ftp_Sec_Exit
33947>>>>>>
33947>>>>>>        // Branch.Ras_Name
33947>>>>>>
33947>>>>>>        // Branch.Ras_Passw
33947>>>>>>
33947>>>>>>        // Branch.Ras_Domain
33947>>>>>>
33947>>>>>>        // Branch.Last_Hmnia_Ekt
33947>>>>>>
33947>>>>>>        // Branch.Deop_Logo
33947>>>>>>
33947>>>>>>        // Branch.Entolh
33947>>>>>>
33947>>>>>>        // Branch.Paragogh
33947>>>>>>
33947>>>>>>        // Branch.Locked_Until
33947>>>>>>
33947>>>>>>        // Branch.Sap_Code
33947>>>>>>
33947>>>>>>        // Branch.Perioxh
33947>>>>>>
33947>>>>>>        // Branch.Egkatastash
33947>>>>>>
33947>>>>>>        // Branch.Date_Locked
33947>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
33948>>>>>>
33948>>>>>>        //DDB-DefineFieldEnd
33948>>>>>>    End_Procedure    // Define_Fields
33949>>>>>>
33949>>>>>>    // Field_Defaults:
33949>>>>>>    // This procedure is used to establish default field values.
33949>>>>>>
33949>>>>>>    Procedure Field_Defaults
33950>>>>>>        Forward Send Field_Defaults
33952>>>>>>        //DDB-Generated-Code-Location
33952>>>>>>        //DDB-FieldDefaultStart
33952>>>>>>        //DDB-FieldDefaultEnd
33952>>>>>>    End_Procedure    // Field_Defaults
33953>>>>>>End_Class    // Branch_DataDictionary
33954>>>>>>
33954>>>>>>//DDB-Selection-pkg-Start
33954>>>>>>
33954>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
33954>>>>>>>>//AB/ Project SL002:Branch
33954>>>>>>>>//AB/ Object prj is a Lookup_Project
33954>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
33954>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
33954>>>>>>>>
33954>>>>>>>>// Project Object Structure
33954>>>>>>>>//   SL002 is a dbModalPanelSub
33954>>>>>>>>//     Company_DD is a DataDictionary
33954>>>>>>>>//     Branch_DD is a DataDictionary
33954>>>>>>>>//     oSelList is a dbListSub
33954>>>>>>>>//     oOK_bn is a ButtonSub
33954>>>>>>>>//     oCancel_bn is a ButtonSub
33954>>>>>>>>//     oSearch_bn is a ButtonSub
33954>>>>>>>>
33954>>>>>>>>// Register all objects
33954>>>>>>>>Register_Object Branch_DD
33954>>>>>>>>Register_Object Company_DD
33954>>>>>>>>Register_Object oCancel_bn
33954>>>>>>>>Register_Object oOK_bn
33954>>>>>>>>Register_Object oSearch_bn
33954>>>>>>>>Register_Object oSelList
33954>>>>>>>>Register_Object SL002
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreStart
33954>>>>>>>>
33954>>>>>>>>Use DFAllEnt.pkg
33954>>>>>>>>Use dbList.Sub
33954>>>>>>>>Use Button.Sub
33954>>>>>>>>
33954>>>>>>>>
33954>>>>>>>>Use COMPANY.DD
33954>>>>>>>>Use BRANCH.DD
33954>>>>>>>>
33954>>>>>>>>//AB-IgnoreEnd
33954>>>>>>>>
33954>>>>>>>>Object SL002 is a dbModalPanelSub
33956>>>>>>>>
33956>>>>>>>>    //AB-StoreTopStart
33956>>>>>>>>    Property String psFragmaCompanyCode  ""
33958>>>>>>>>    
33958>>>>>>>>    //AB-StoreTopEnd
33958>>>>>>>>
33958>>>>>>>>    Set Minimize_Icon to FALSE
33959>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
33960>>>>>>>>    Set Size to 146 430
33961>>>>>>>>    Set Location to 4 5
33962>>>>>>>>    Set Exit_Application_Local_State to FALSE
33963>>>>>>>>    Set Modal_State to FALSE
33964>>>>>>>>
33964>>>>>>>>    //AB-DDOStart
33964>>>>>>>>
33964>>>>>>>>    Object Company_DD is a Company_DataDictionary
33966>>>>>>>>    End_Object    // Company_DD
33967>>>>>>>>
33967>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
33969>>>>>>>>        Set DDO_Server to (Company_DD(self))
33970>>>>>>>>
33970>>>>>>>>        //AB-StoreStart
33970>>>>>>>>        Procedure OnConstrain
33972>>>>>>>>             String lsCompanyCode
33973>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
33974>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
33978>>>>>>>>        End_Procedure // OnConstrain
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        
33979>>>>>>>>        //AB-StoreEnd
33979>>>>>>>>
33979>>>>>>>>    End_Object    // Branch_DD
33980>>>>>>>>
33980>>>>>>>>    Set Main_DD to (Branch_DD(self))
33981>>>>>>>>    Set Server to (Branch_DD(self))
33982>>>>>>>>
33982>>>>>>>>    //AB-DDOEnd
33982>>>>>>>>
33982>>>>>>>>    Object oSelList is a dbListSub
33984>>>>>>>>        Set Main_File to Branch.File_Number
33985>>>>>>>>        Set Size to 105 415
33986>>>>>>>>        Set Location to 6 6
33987>>>>>>>>
33987>>>>>>>>        Begin_Row
33990>>>>>>>>            Entry_Item Branch.Branch_code
33991>>>>>>>>            Entry_Item Branch.Branch_name
33992>>>>>>>>            Entry_Item Company.Company_code
33993>>>>>>>>            Entry_Item Company.Company_name
33994>>>>>>>>            Entry_Item Branch.Beto_site
33995>>>>>>>>            Entry_Item Branch.Branch_recr
33996>>>>>>>>        End_Row
34001>>>>>>>>
34001>>>>>>>>        Set Form_Width    item 0 to 60
34002>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
34003>>>>>>>>        
34003>>>>>>>>        Set Form_Width    item 1 to 128
34004>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
34005>>>>>>>>        
34005>>>>>>>>        Set Form_Width    item 2 to 69
34006>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
34007>>>>>>>>        
34007>>>>>>>>        Set Form_Width    item 3 to 109
34008>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34009>>>>>>>>        
34009>>>>>>>>        Set Form_Width    item 4 to 42
34010>>>>>>>>        Set Header_Label  item 4 to "Site"
34011>>>>>>>>        
34011>>>>>>>>        Set Form_Width    item 5 to 0
34012>>>>>>>>        Set Header_Label  item 5 to ""
34013>>>>>>>>        
34013>>>>>>>>
34013>>>>>>>>        //AB-StoreStart
34013>>>>>>>>                
34013>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34015>>>>>>>>        
34015>>>>>>>>        Procedure Store_Defaults
34017>>>>>>>>            forward send Store_Defaults
34019>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34020>>>>>>>>        end_Procedure // Store_Defaults
34021>>>>>>>>        
34021>>>>>>>>        Procedure Restore_Defaults
34023>>>>>>>>            forward send Restore_Defaults
34025>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34026>>>>>>>>        end_Procedure // Restore_Defaults
34027>>>>>>>>        
34027>>>>>>>>        Procedure Activating
34029>>>>>>>>            Forward Send Activating
34031>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
34032>>>>>>>>        End_Procedure // Activating
34033>>>>>>>>        
34033>>>>>>>>        Set Column_Options Item 5 to NoEnter True
34034>>>>>>>>        
34034>>>>>>>>        
34034>>>>>>>>        //AB-StoreEnd
34034>>>>>>>>
34034>>>>>>>>    End_Object    // oSelList
34035>>>>>>>>
34035>>>>>>>>    Object oOK_bn is a ButtonSub
34037>>>>>>>>        Set Label to "&„§ ¢¦šã"
34038>>>>>>>>        Set Location to 112 262
34039>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34040>>>>>>>>
34040>>>>>>>>        //AB-StoreStart
34040>>>>>>>>        Procedure OnClick
34042>>>>>>>>            Send OK To (oSelList(current_object))
34043>>>>>>>>        End_Procedure
34044>>>>>>>>        //AB-StoreEnd
34044>>>>>>>>
34044>>>>>>>>    End_Object    // oOK_bn
34045>>>>>>>>
34045>>>>>>>>    Object oCancel_bn is a ButtonSub
34047>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34048>>>>>>>>        Set Location to 112 317
34049>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34050>>>>>>>>
34050>>>>>>>>        //AB-StoreStart
34050>>>>>>>>        Procedure OnClick
34052>>>>>>>>            Send Cancel To (oSelList(current_object))
34053>>>>>>>>        End_Procedure
34054>>>>>>>>        //AB-StoreEnd
34054>>>>>>>>
34054>>>>>>>>    End_Object    // oCancel_bn
34055>>>>>>>>
34055>>>>>>>>    Object oSearch_bn is a ButtonSub
34057>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34058>>>>>>>>        Set Location to 112 372
34059>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34060>>>>>>>>
34060>>>>>>>>        //AB-StoreStart
34060>>>>>>>>        Procedure OnClick
34062>>>>>>>>            Send Search To (oSelList(current_object))
34063>>>>>>>>        End_Procedure
34064>>>>>>>>        //AB-StoreEnd
34064>>>>>>>>
34064>>>>>>>>    End_Object    // oSearch_bn
34065>>>>>>>>
34065>>>>>>>>
34065>>>>>>>>    //AB-StoreStart
34065>>>>>>>>    
34065>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34066>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34067>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    
34068>>>>>>>>    //AB-StoreEnd
34068>>>>>>>>
34068>>>>>>>>End_Object    // SL002
34069>>>>>>>>
34069>>>>>>>>//AB/ End_Object    // prj
34069>>>>>>
34069>>>>>>//DDB-Selection-pkg-End
34069>>>>>>//DDB-FileEnd
34069>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
34069>>>>>>//DDB-FileStart
34069>>>>>>//DDB-HeaderStart
34069>>>>>>
34069>>>>>>// File Name : YEAR.DD
34069>>>>>>// Class Name: Year_DataDictionary
34069>>>>>>// Revision  : 119
34069>>>>>>// Version   : 2
34069>>>>>>
34069>>>>>>Use  Windows           // Basic Definitions
34069>>>>>>Use  DataDict          // DataDictionary Class Definition
34069>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
34069>>>>>>
34069>>>>>>Open Year
34071>>>>>>Open Branch
34073>>>>>>Open Syscurxr
34075>>>>>>
34075>>>>>>//DDB-HeaderEnd
34075>>>>>>//DDB-ValidationStart
34075>>>>>>
34075>>>>>>Register_Object Year_Year_C_Code0_VT1
34075>>>>>>Register_Object Year_Year_C_Code00_VT1
34075>>>>>>Register_Object Year_Year_C_Coder_VT1
34075>>>>>>
34075>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
34077>>>>>>    Set Type_Value        To "CURRENCY"
34078>>>>>>    //DDB-ValidationCustomStart
34078>>>>>>    //DDB-ValidationCustomEnd
34078>>>>>>End_Object   // Year_Year_C_Code0_VT1
34079>>>>>>
34079>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
34081>>>>>>    Set Type_Value        To "CURRENCY"
34082>>>>>>    //DDB-ValidationCustomStart
34082>>>>>>    //DDB-ValidationCustomEnd
34082>>>>>>End_Object   // Year_Year_C_Code00_VT1
34083>>>>>>
34083>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
34085>>>>>>    Set Type_Value        To "CURRENCY"
34086>>>>>>    //DDB-ValidationCustomStart
34086>>>>>>    //DDB-ValidationCustomEnd
34086>>>>>>End_Object   // Year_Year_C_Coder_VT1
34087>>>>>>//DDB-ValidationEnd
34087>>>>>>//DDB-SelectionStart
34087>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
34087>>>>>>Register_Object SL003
34087>>>>>>//DDB-SelectionEnd
34087>>>>>>            
34087>>>>>>Class Year_DataDictionary  is a DataDictionary
34088>>>>>>    
34088>>>>>>    Procedure Creating
34089>>>>>>        Forward Send Creating
34091>>>>>>        // Insert Code Here
34091>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
34092>>>>>>    End_Procedure   // Creating
34093>>>>>>
34093>>>>>>
34093>>>>>>    // Operation_Not_Allowed:
34093>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34094>>>>>>        // Insert Code Here
34094>>>>>>        Case Begin    
34094>>>>>>             Case (iError_Num = 1001)
34096>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
34097>>>>>>>
34097>>>>>>             Case Break
34098>>>>>>             Case (iError_Num=1002)
34101>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
34102>>>>>>>
34102>>>>>>             Case Break
34103>>>>>>             Case (iError_Num=1003)
34106>>>>>>                Error 1003 "DDC 053:Company Code=0"
34107>>>>>>>
34107>>>>>>             Case Break
34108>>>>>>             Case (iError_Num=1004)
34111>>>>>>                Error 1004 "DDC 053:Branch Code=0"
34112>>>>>>>
34112>>>>>>             Case Break
34113>>>>>>             Case Else
34113>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
34115>>>>>>        Case End
34115>>>>>>    End_Procedure   // Operation_Not_Allowed
34116>>>>>>
34116>>>>>>
34116>>>>>>    // Update:
34116>>>>>>    // Use this message to effect changes in related-to files. The
34116>>>>>>    // Backout message should be designed to reverse the effects of this
34116>>>>>>    // message. It is invoked while the database is locked.
34116>>>>>>
34116>>>>>>    Procedure Update
34117>>>>>>        Forward Send Update
34119>>>>>>        // Insert Code Here
34119>>>>>>        Move Company.Company_Code   to Year.Company_Code
34120>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
34121>>>>>>        move branch.beto_site       to year.beto_site
34122>>>>>>
34122>>>>>>        //sos:parametrika apo sysfile?
34122>>>>>>       
34122>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
34122>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>       // Else Begin
34122>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
34122>>>>>>       // End
34122>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
34122>>>>>>    End_Procedure   // Update
34123>>>>>>
34123>>>>>>    // Validate_Save:
34123>>>>>>
34123>>>>>>    Function Validate_Save  Returns Integer
34124>>>>>>        Local Integer iReturnVal
34125>>>>>>        Forward Get Validate_Save  To iReturnVal
34127>>>>>>        If (Not(iReturnVal)) Begin
34129>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
34132>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
34136>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
34140>>>>>>        End
34140>>>>>>>
34140>>>>>>        Function_Return iReturnVal
34141>>>>>>    End_Function   // Validate_Save
34142>>>>>>
34142>>>>>>
34142>>>>>>    // Define_Fields:
34142>>>>>>    // This procedure is used to set up all data-dictionary rules.
34142>>>>>>
34142>>>>>>    Procedure Define_Fields
34143>>>>>>        Forward Send Define_Fields
34145>>>>>>        //DDB-Generated-Code-Location
34145>>>>>>        //DDB-DefineFieldStart
34145>>>>>>
34145>>>>>>        Set Main_File            To Year.File_Number
34146>>>>>>        Set Cascade_Delete_State To FALSE
34147>>>>>>
34147>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
34148>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
34149>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34150>>>>>>
34150>>>>>>        // Parent (Server) file structure...............
34150>>>>>>        Send Add_Server_File  Branch.File_Number
34151>>>>>>
34151>>>>>>        // External (System) file structure.............
34151>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
34152>>>>>>
34152>>>>>>        // Field-based properties.......................
34152>>>>>>
34152>>>>>>        // Year.Company_Code
34152>>>>>>
34152>>>>>>        // Year.Branch_Code
34152>>>>>>
34152>>>>>>        // Year.Year_Year
34152>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
34153>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
34154>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
34155>>>>>>
34155>>>>>>        // Year.Year_Recr
34155>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
34156>>>>>>
34156>>>>>>        // Year.Branch_Recr
34156>>>>>>
34156>>>>>>        // Year.Year_Descr
34156>>>>>>
34156>>>>>>        // Year.Year_Isolfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Isolto
34156>>>>>>
34156>>>>>>        // Year.Year_Openfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Opento
34156>>>>>>
34156>>>>>>        // Year.Year_Entrydate
34156>>>>>>
34156>>>>>>        // Year.Year_Dateaa
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshfrom
34156>>>>>>
34156>>>>>>        // Year.Year_Xrhshto
34156>>>>>>
34156>>>>>>        // Year.Year_Myflimit
34156>>>>>>
34156>>>>>>        // Year.Year_Numgtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numgarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numgmove
34156>>>>>>
34156>>>>>>        // Year.Year_Numgplan
34156>>>>>>
34156>>>>>>        // Year.Year_Numgformat
34156>>>>>>
34156>>>>>>        // Year.Year_Numgthaa
34156>>>>>>
34156>>>>>>        // Year.Year_Numgopen
34156>>>>>>
34156>>>>>>        // Year.Year_Numbtypkin
34156>>>>>>
34156>>>>>>        // Year.Year_Numbaxio
34156>>>>>>
34156>>>>>>        // Year.Year_Numbarticl
34156>>>>>>
34156>>>>>>        // Year.Year_Numbmove
34156>>>>>>
34156>>>>>>        // Year.Year_Delimiter
34156>>>>>>
34156>>>>>>        // Year.Year_Printer
34156>>>>>>
34156>>>>>>        // Year.Year_Valid_Char
34156>>>>>>
34156>>>>>>        // Year.Year_C_Code0
34156>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
34157>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
34158>>>>>>
34158>>>>>>        // Year.Year_C_Code00
34158>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
34159>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
34160>>>>>>
34160>>>>>>        // Year.Year_C_Coder
34160>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
34161>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
34162>>>>>>
34162>>>>>>        // Year.Beto_Site
34162>>>>>>
34162>>>>>>        // Year.Clients_Plafon
34162>>>>>>
34162>>>>>>        // Year.Payresp_Plafon
34162>>>>>>
34162>>>>>>        // Year.Clients_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Payresp_Ofeilh
34162>>>>>>
34162>>>>>>        // Year.Working
34162>>>>>>
34162>>>>>>        //DDB-DefineFieldEnd
34162>>>>>>
34162>>>>>>        Set Main_File            To Year.File_Number
34163>>>>>>        Set Cascade_Delete_State To FALSE
34164>>>>>>
34164>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
34165>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
34166>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
34167>>>>>>
34167>>>>>>        // Child (Client) file structure................
34167>>>>>>
34167>>>>>>        // Parent (Server) file structure...............
34167>>>>>>        Send Add_Server_File  Branch.File_Number
34168>>>>>>
34168>>>>>>        // Field-based properties.......................
34168>>>>>>
34168>>>>>>        // Year.Company_Code
34168>>>>>>
34168>>>>>>        // Year.Branch_Code
34168>>>>>>
34168>>>>>>        // Year.Year_Year
34168>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
34169>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
34170>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
34171>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
34171>>>>>>
34171>>>>>>        // Year.Year_Descr
34171>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
34172>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
34173>>>>>>
34173>>>>>>        // Year.Year_C_Code0
34173>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
34174>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
34175>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
34176>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
34176>>>>>>
34176>>>>>>        // Year.Year_C_Code00
34176>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
34177>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34178>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
34179>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
34179>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
34179>>>>>>
34179>>>>>>        // Year.Year_C_Coder
34179>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
34180>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
34181>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
34182>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
34182>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
34182>>>>>>
34182>>>>>>        // Year.Year_Isolfrom
34182>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34183>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
34184>>>>>>
34184>>>>>>        // Year.Year_Isolto
34184>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34185>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
34186>>>>>>
34186>>>>>>        // Year.Year_Openfrom
34186>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34187>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
34188>>>>>>
34188>>>>>>        // Year.Year_Opento
34188>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34189>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
34190>>>>>>
34190>>>>>>        // Year.Year_Entrydate
34190>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
34191>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
34192>>>>>>
34192>>>>>>        // Year.Year_Dateaa
34192>>>>>>
34192>>>>>>        // Year.Year_Xrhshfrom
34192>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34193>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
34194>>>>>>
34194>>>>>>        // Year.Year_Xrhshto
34194>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34195>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
34196>>>>>>
34196>>>>>>        // Year.Year_Myflimit
34196>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34197>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
34198>>>>>>
34198>>>>>>        // Year.Year_Numgtypkin
34198>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
34199>>>>>>
34199>>>>>>        // Year.Year_Numgarticl
34199>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
34200>>>>>>
34200>>>>>>        // Year.Year_Numgmove
34200>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
34201>>>>>>
34201>>>>>>        // Year.Year_Numgplan
34201>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
34202>>>>>>
34202>>>>>>        // Year.Year_Numgformat
34202>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
34203>>>>>>
34203>>>>>>        // Year.Year_Numgthaa
34203>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
34204>>>>>>
34204>>>>>>        // Year.Year_Numgopen
34204>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
34205>>>>>>
34205>>>>>>        // Year.Year_Numbaxio
34205>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
34206>>>>>>
34206>>>>>>        // Year.Year_Numbarticl
34206>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
34207>>>>>>
34207>>>>>>        // Year.Year_Numbmove
34207>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
34208>>>>>>
34208>>>>>>        // Year.Year_Delimiter
34208>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
34209>>>>>>
34209>>>>>>        // Year.Year_Printer
34209>>>>>>
34209>>>>>>        // Year.Year_Valid_Char
34209>>>>>>
34209>>>>>>    End_Procedure    // Define_Fields
34210>>>>>>
34210>>>>>>    // Field_Defaults:
34210>>>>>>    // This procedure is used to establish default field values.
34210>>>>>>
34210>>>>>>    Procedure Field_Defaults
34211>>>>>>        Forward Send Field_Defaults
34213>>>>>>        //DDB-Generated-Code-Location
34213>>>>>>        //DDB-FieldDefaultStart
34213>>>>>>        //DDB-FieldDefaultEnd
34213>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
34214>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
34215>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
34216>>>>>>    End_Procedure    // Field_Defaults
34217>>>>>>
34217>>>>>>End_Class    // Year_DataDictionary
34218>>>>>>//DDB-Selection-pkg-Start
34218>>>>>>
34218>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
34218>>>>>>>>//AB/ Project SL003:Year
34218>>>>>>>>//AB/ Object prj is a Lookup_Project
34218>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
34218>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
34218>>>>>>>>
34218>>>>>>>>// Project Object Structure
34218>>>>>>>>//   SL003 is a dbModalPanelSub
34218>>>>>>>>//     Company_DD is a DataDictionary
34218>>>>>>>>//     Branch_DD is a DataDictionary
34218>>>>>>>>//     Year_DD is a DataDictionary
34218>>>>>>>>//     oSelList is a dbListSub
34218>>>>>>>>//     oOK_bn is a ButtonSub
34218>>>>>>>>//     oCancel_bn is a ButtonSub
34218>>>>>>>>//     oSearch_bn is a ButtonSub
34218>>>>>>>>
34218>>>>>>>>// Register all objects
34218>>>>>>>>Register_Object Branch_DD
34218>>>>>>>>Register_Object Company_DD
34218>>>>>>>>Register_Object oCancel_bn
34218>>>>>>>>Register_Object oOK_bn
34218>>>>>>>>Register_Object oSearch_bn
34218>>>>>>>>Register_Object oSelList
34218>>>>>>>>Register_Object SL003
34218>>>>>>>>Register_Object Year_DD
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreStart
34218>>>>>>>>
34218>>>>>>>>Use DFAllEnt.pkg
34218>>>>>>>>Use dbList.Sub
34218>>>>>>>>Use Button.Sub
34218>>>>>>>>
34218>>>>>>>>
34218>>>>>>>>Use COMPANY.DD
34218>>>>>>>>Use BRANCH.DD
34218>>>>>>>>Use YEAR.DD
34218>>>>>>>>
34218>>>>>>>>//AB-IgnoreEnd
34218>>>>>>>>
34218>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
34237>>>>>>>>
34237>>>>>>>>    //AB-StoreTopStart
34237>>>>>>>>    Property String psFragmaCompanyCode  ""
34239>>>>>>>>    Property String psFragmaBranchCode   ""
34241>>>>>>>>    property integer pifragmaactive public 0
34243>>>>>>>>    //AB-StoreTopEnd
34243>>>>>>>>
34243>>>>>>>>    Set Minimize_Icon to FALSE
34244>>>>>>>>    Set Label to "•¨ã©œ ª"
34245>>>>>>>>    Set Size to 149 449
34246>>>>>>>>    Set Location to 4 7
34247>>>>>>>>    Set Exit_Application_Local_State to FALSE
34248>>>>>>>>    Set Modal_State to FALSE
34249>>>>>>>>
34249>>>>>>>>    //AB-DDOStart
34249>>>>>>>>
34249>>>>>>>>    Object Company_DD is a Company_DataDictionary
34251>>>>>>>>    End_Object    // Company_DD
34252>>>>>>>>
34252>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
34254>>>>>>>>        Set DDO_Server to (Company_DD(self))
34255>>>>>>>>    End_Object    // Branch_DD
34256>>>>>>>>
34256>>>>>>>>    Object Year_DD is a Year_DataDictionary
34258>>>>>>>>        Set DDO_Server to (Branch_DD(self))
34259>>>>>>>>
34259>>>>>>>>        //AB-StoreStart
34259>>>>>>>>        Procedure OnConstrain
34261>>>>>>>>             String lsCompanyCode lsBranchCode
34262>>>>>>>>             integer iactive
34262>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
34263>>>>>>>>             get pifragmaactive to iactive
34264>>>>>>>>             If (lsCompanyCode <> "") Begin
34266>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
34267>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
34269>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
34273>>>>>>>>             End
34273>>>>>>>>>
34273>>>>>>>>             if (iactive = 0) constrain year.working ne 1
34277>>>>>>>>        End_Procedure // OnConstrain
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        
34278>>>>>>>>        //AB-StoreEnd
34278>>>>>>>>
34278>>>>>>>>    End_Object    // Year_DD
34279>>>>>>>>
34279>>>>>>>>    Set Main_DD to (Year_DD(self))
34280>>>>>>>>    Set Server to (Year_DD(self))
34281>>>>>>>>
34281>>>>>>>>    //AB-DDOEnd
34281>>>>>>>>
34281>>>>>>>>    Object oSelList is a dbListSub
34283>>>>>>>>        Set Main_File to Year.File_Number
34284>>>>>>>>        Set Size to 105 433
34285>>>>>>>>        Set Location to 6 6
34286>>>>>>>>
34286>>>>>>>>        Begin_Row
34289>>>>>>>>            Entry_Item Year.Year_year
34290>>>>>>>>            Entry_Item Company.Company_code
34291>>>>>>>>            Entry_Item Company.Company_name
34292>>>>>>>>            Entry_Item Branch.Branch_code
34293>>>>>>>>            Entry_Item Branch.Branch_name
34294>>>>>>>>        End_Row
34299>>>>>>>>
34299>>>>>>>>        Set Form_Width    item 0 to 36
34300>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
34301>>>>>>>>        
34301>>>>>>>>        Set Form_Width    item 1 to 71
34302>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
34303>>>>>>>>        
34303>>>>>>>>        Set Form_Width    item 2 to 136
34304>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
34305>>>>>>>>        
34305>>>>>>>>        Set Form_Width    item 3 to 73
34306>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
34307>>>>>>>>        
34307>>>>>>>>        Set Form_Width    item 4 to 109
34308>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
34309>>>>>>>>        
34309>>>>>>>>
34309>>>>>>>>        //AB-StoreStart
34309>>>>>>>>                                                
34309>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
34311>>>>>>>>        Property String psStoreFragmaBranchCode   ""
34313>>>>>>>>        
34313>>>>>>>>        Procedure Store_Defaults
34315>>>>>>>>            forward send Store_Defaults
34317>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
34318>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
34319>>>>>>>>        end_Procedure // Store_Defaults
34320>>>>>>>>        
34320>>>>>>>>        Procedure Restore_Defaults
34322>>>>>>>>            forward send Restore_Defaults
34324>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
34325>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
34326>>>>>>>>        end_Procedure // Restore_Defaults
34327>>>>>>>>        
34327>>>>>>>>        Procedure Activating
34329>>>>>>>>            Forward Send Activating
34331>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
34332>>>>>>>>        End_Procedure // Activating
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        
34333>>>>>>>>        //AB-StoreEnd
34333>>>>>>>>
34333>>>>>>>>    End_Object    // oSelList
34334>>>>>>>>
34334>>>>>>>>    Object oOK_bn is a ButtonSub
34336>>>>>>>>        Set Label to "&„§ ¢¦šã"
34337>>>>>>>>        Set Location to 112 280
34338>>>>>>>>
34338>>>>>>>>        //AB-StoreStart
34338>>>>>>>>        Procedure OnClick
34340>>>>>>>>            Send OK To (oSelList(current_object))
34341>>>>>>>>        End_Procedure
34342>>>>>>>>        //AB-StoreEnd
34342>>>>>>>>
34342>>>>>>>>    End_Object    // oOK_bn
34343>>>>>>>>
34343>>>>>>>>    Object oCancel_bn is a ButtonSub
34345>>>>>>>>        Set Label to "&€¡ç¨à©ž"
34346>>>>>>>>        Set Location to 112 335
34347>>>>>>>>
34347>>>>>>>>        //AB-StoreStart
34347>>>>>>>>        Procedure OnClick
34349>>>>>>>>            Send Cancel To (oSelList(current_object))
34350>>>>>>>>        End_Procedure
34351>>>>>>>>        //AB-StoreEnd
34351>>>>>>>>
34351>>>>>>>>    End_Object    // oCancel_bn
34352>>>>>>>>
34352>>>>>>>>    Object oSearch_bn is a ButtonSub
34354>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
34355>>>>>>>>        Set Location to 112 390
34356>>>>>>>>
34356>>>>>>>>        //AB-StoreStart
34356>>>>>>>>        Procedure OnClick
34358>>>>>>>>            Send Search To (oSelList(current_object))
34359>>>>>>>>        End_Procedure
34360>>>>>>>>        //AB-StoreEnd
34360>>>>>>>>
34360>>>>>>>>    End_Object    // oSearch_bn
34361>>>>>>>>
34361>>>>>>>>
34361>>>>>>>>    //AB-StoreStart
34361>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
34362>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
34363>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    
34364>>>>>>>>    //AB-StoreEnd
34364>>>>>>>>
34364>>>>>>>>CD_End_Object    // SL003
34366>>>>>>>>>
34366>>>>>>>>
34366>>>>>>>>//AB/ End_Object    // prj
34366>>>>>>
34366>>>>>>//DDB-Selection-pkg-End
34366>>>>>>//DDB-FileEnd
34366>>>>
34366>>>>//AB-IgnoreEnd
34366>>>>
34366>>>>Object oSelectYear is a dbModalPanelSub
34368>>>>
34368>>>>    //AB-StoreTopStart
34368>>>>    
34368>>>>    Property String  psSelectedYearRecr  ''
34370>>>>    Property Integer piChangeState False
34372>>>>    
34372>>>>    //AB-StoreTopEnd
34372>>>>
34372>>>>    Set Minimize_Icon to FALSE
34373>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
34374>>>>    Set Size to 111 372
34375>>>>    Set Location to 60 40
34376>>>>    Set Color to 12232306
34377>>>>
34377>>>>    //AB-DDOStart
34377>>>>
34377>>>>    Object Company_DD is a Company_DataDictionary
34379>>>>
34379>>>>        //AB-StoreStart
34379>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
34380>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
34381>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
34382>>>>        
34382>>>>        
34382>>>>        
34382>>>>        //AB-StoreEnd
34382>>>>
34382>>>>    End_Object    // Company_DD
34383>>>>
34383>>>>    Object Branch_DD is a Branch_DataDictionary
34385>>>>        Set DDO_Server to (Company_DD(self))
34386>>>>
34386>>>>        //AB-StoreStart
34386>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
34387>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
34388>>>>        
34388>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
34389>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
34390>>>>        
34390>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
34391>>>>        //AB-StoreEnd
34391>>>>
34391>>>>    End_Object    // Branch_DD
34392>>>>
34392>>>>    Object Year_DD is a Year_DataDictionary
34394>>>>        Set DDO_Server to (Branch_DD(self))
34395>>>>
34395>>>>        //AB-StoreStart
34395>>>>        
34395>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
34396>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
34397>>>>        
34397>>>>        Function Validate_Delete Returns Integer
34399>>>>            Function_Return 1
34400>>>>        End_Function
34401>>>>        
34401>>>>        //AB-StoreEnd
34401>>>>
34401>>>>    End_Object    // Year_DD
34402>>>>
34402>>>>    Set Main_DD to (Year_DD(self))
34403>>>>    Set Server to (Year_DD(self))
34404>>>>
34404>>>>    //AB-DDOEnd
34404>>>>
34404>>>>    Object Company_Company_Code is a dbFormSub
34406>>>>        Entry_Item Company.Company_code
34407>>>>        Set Size to 13 71
34408>>>>        Set Location to 9 112
34409>>>>        Set Color to 12232306
34410>>>>        Set Label_Col_Offset to 2
34411>>>>        Set Label_Justification_Mode to jMode_Right
34412>>>>        Set Prompt_Button_Mode to pb_PromptOn
34413>>>>        Set Auto_Clear_Deo_State to FALSE
34414>>>>        Set Enabled_State to FALSE
34415>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34416>>>>        Set Item_Shadow_State Item 0 to TRUE
34417>>>>        Set Shadow_State Item 0 to TRUE
34418>>>>
34418>>>>        //AB-StoreStart
34418>>>>        
34418>>>>        Set Prompt_Object to (sl001(Self))
34419>>>>        
34419>>>>        
34419>>>>        //AB-StoreEnd
34419>>>>
34419>>>>    End_Object    // Company_Company_Code
34420>>>>
34420>>>>    Object Company_Company_Name is a dbFormSub
34422>>>>        Entry_Item Company.Company_name
34423>>>>        Set Size to 13 168
34424>>>>        Set Location to 9 188
34425>>>>        Set Color to 12232306
34426>>>>        Set Label_Col_Offset to 2
34427>>>>        Set Label_Justification_Mode to jMode_Right
34428>>>>        Set Enabled_State to FALSE
34429>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34430>>>>        Set Item_Shadow_State Item 0 to TRUE
34431>>>>        Set Shadow_State Item 0 to TRUE
34432>>>>
34432>>>>        //AB-StoreStart
34432>>>>        
34432>>>>        //AB-StoreEnd
34432>>>>
34432>>>>    End_Object    // Company_Company_Name
34433>>>>
34433>>>>    Object Branch_Branch_Code is a dbFormSub
34435>>>>        Entry_Item Branch.Branch_code
34436>>>>        Set Size to 13 71
34437>>>>        Set Location to 23 112
34438>>>>        Set Color to 12232306
34439>>>>        Set Label_Col_Offset to 2
34440>>>>        Set Label_Justification_Mode to jMode_Right
34441>>>>        Set Prompt_Button_Mode to pb_PromptOn
34442>>>>        Set Auto_Clear_Deo_State to FALSE
34443>>>>        Set Enabled_State to FALSE
34444>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34445>>>>        Set Item_Shadow_State Item 0 to TRUE
34446>>>>        Set Shadow_State Item 0 to TRUE
34447>>>>
34447>>>>        //AB-StoreStart
34447>>>>        Set Prompt_Object to (sl002(Self))
34448>>>>        
34448>>>>        Procedure Prompt_CallBack Integer hPrompt
34450>>>>            string lsCompanyCode
34451>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34452>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34453>>>>        End_Procedure
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        
34454>>>>        //AB-StoreEnd
34454>>>>
34454>>>>    End_Object    // Branch_Branch_Code
34455>>>>
34455>>>>    Object Branch_Branch_Name is a dbFormSub
34457>>>>        Entry_Item Branch.Branch_name
34458>>>>        Set Size to 13 168
34459>>>>        Set Location to 23 188
34460>>>>        Set Color to 12232306
34461>>>>        Set Label_Justification_Mode to jMode_Right
34462>>>>        Set Enabled_State to FALSE
34463>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34464>>>>        Set Item_Shadow_State Item 0 to TRUE
34465>>>>        Set Shadow_State Item 0 to TRUE
34466>>>>
34466>>>>        //AB-StoreStart
34466>>>>        
34466>>>>        
34466>>>>        //AB-StoreEnd
34466>>>>
34466>>>>    End_Object    // Branch_Branch_Name
34467>>>>
34467>>>>    Object Year_Year_Year is a dbFormSub
34469>>>>        Entry_Item Year.Year_year
34470>>>>        Set Size to 13 71
34471>>>>        Set Location to 37 112
34472>>>>        Set Label_Col_Offset to 2
34473>>>>        Set Label_Justification_Mode to jMode_Right
34474>>>>        Set Prompt_Button_Mode to pb_PromptOn
34475>>>>        Set Auto_Clear_Deo_State to FALSE
34476>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34477>>>>
34477>>>>        //AB-StoreStart
34477>>>>        Set Prompt_Object to (sl003(Self))
34478>>>>        
34478>>>>        Procedure Prompt_CallBack Integer hPrompt
34480>>>>            String lsCompanyCode lsBranchCode
34481>>>>            integer icheck
34481>>>>            get checked_state of (chkxr(self)) to icheck
34482>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
34483>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
34484>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
34485>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
34486>>>>            set pifragmaactive      of hPrompt to icheck
34487>>>>        End_Procedure
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        
34488>>>>        //AB-StoreEnd
34488>>>>
34488>>>>    End_Object    // Year_Year_Year
34489>>>>
34489>>>>    Object Year_Year_Descr is a dbFormSub
34491>>>>        Entry_Item Year.Year_descr
34492>>>>        Set Size to 13 168
34493>>>>        Set Location to 37 188
34494>>>>        Set Color to 12232306
34495>>>>        Set Label_Col_Offset to 2
34496>>>>        Set Label_Justification_Mode to jMode_Right
34497>>>>        Set Enabled_State to FALSE
34498>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34499>>>>        Set Item_Shadow_State Item 0 to TRUE
34500>>>>        Set Shadow_State Item 0 to TRUE
34501>>>>
34501>>>>        //AB-StoreStart
34501>>>>        
34501>>>>        //AB-StoreEnd
34501>>>>
34501>>>>    End_Object    // Year_Year_Descr
34502>>>>
34502>>>>    Object Year_Year_Entrydate is a dbFormSub
34504>>>>        Entry_Item Year.Year_entrydate
34505>>>>        Set Size to 13 71
34506>>>>        Set Location to 52 112
34507>>>>        Set Label_Col_Offset to 2
34508>>>>        Set Label_Justification_Mode to jMode_Right
34509>>>>        Set Auto_Clear_Deo_State to FALSE
34510>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34511>>>>    End_Object    // Year_Year_Entrydate
34512>>>>
34512>>>>    Object oOk_bn is a ButtonSub
34514>>>>        Set Label to "€§¦›¦®ã (F2)"
34515>>>>        Set Size to 17 54
34516>>>>        Set Location to 74 188
34517>>>>        Set Form_FontHeight Item 0 to 14
34518>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34519>>>>
34519>>>>        //AB-StoreStart
34519>>>>        
34519>>>>        Procedure OnClick
34521>>>>            Delegate Send AcceptTheValues
34523>>>>        End_Procedure
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        
34524>>>>        //AB-StoreEnd
34524>>>>
34524>>>>    End_Object    // oOk_bn
34525>>>>
34525>>>>    Object oCancel_bn is a ButtonSub
34527>>>>        Set Label to "„¥¦›¦ª "
34528>>>>        Set Size to 17 54
34529>>>>        Set Location to 74 302
34530>>>>        Set Form_FontHeight Item 0 to 14
34531>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
34532>>>>
34532>>>>        //AB-StoreStart
34532>>>>        
34532>>>>        Procedure OnClick
34534>>>>           Send Exit_Application to oSelectYear
34535>>>>        End_Procedure
34536>>>>        
34536>>>>        
34536>>>>        
34536>>>>        //AB-StoreEnd
34536>>>>
34536>>>>    End_Object    // oCancel_bn
34537>>>>
34537>>>>    Object otxtCompany is a TextBoxSub
34539>>>>        Set Label to "„«˜ ¨œå˜"
34540>>>>        Set Auto_Size_State to FALSE
34541>>>>        Set Color to 12232306
34542>>>>        Set FontSize to 14 8
34543>>>>        Set Location to 9 10
34544>>>>        Set Size to 10 35
34545>>>>        Set FontWeight to 600
34546>>>>        Set TypeFace to "MS Sans Serif"
34547>>>>        Set Enabled_State to TRUE
34548>>>>    End_Object    // otxtCompany
34549>>>>
34549>>>>    Object otxtBranch is a TextBoxSub
34551>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
34552>>>>        Set Auto_Size_State to FALSE
34553>>>>        Set Color to 12232306
34554>>>>        Set FontSize to 14 8
34555>>>>        Set Location to 23 10
34556>>>>        Set Size to 10 63
34557>>>>        Set FontWeight to 600
34558>>>>        Set TypeFace to "MS Sans Serif"
34559>>>>        Set Enabled_State to TRUE
34560>>>>    End_Object    // otxtBranch
34561>>>>
34561>>>>    Object otxtYear is a TextBoxSub
34563>>>>        Set Label to "•¨ã©ž :          "
34564>>>>        Set Auto_Size_State to FALSE
34565>>>>        Set Color to 12232306
34566>>>>        Set FontSize to 14 8
34567>>>>        Set Location to 38 10
34568>>>>        Set Size to 10 40
34569>>>>        Set FontWeight to 600
34570>>>>        Set TypeFace to "MS Sans Serif"
34571>>>>        Set Enabled_State to TRUE
34572>>>>    End_Object    // otxtYear
34573>>>>
34573>>>>    Object otxtWorkingDay is a TextBoxSub
34575>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
34576>>>>        Set Auto_Size_State to FALSE
34577>>>>        Set Color to 12232306
34578>>>>        Set FontSize to 14 8
34579>>>>        Set Location to 52 10
34580>>>>        Set Size to 10 63
34581>>>>        Set FontWeight to 600
34582>>>>        Set TypeFace to "MS Sans Serif"
34583>>>>        Set Enabled_State to TRUE
34584>>>>    End_Object    // otxtWorkingDay
34585>>>>
34585>>>>    Object otxtWorkingDay is a TextBoxSub
34587>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
34588>>>>        Set Auto_Size_State to FALSE
34589>>>>        Set Color to 12232306
34590>>>>        Set FontSize to 14 8
34591>>>>        Set Location to 79 9
34592>>>>        Set Size to 10 63
34593>>>>        Set FontWeight to 600
34594>>>>        Set TypeFace to "MS Sans Serif"
34595>>>>        Set Enabled_State to TRUE
34596>>>>    End_Object    // otxtWorkingDay
34597>>>>
34597>>>>    Object chkxr is a CheckBoxSub
34599>>>>        Set Size to 13 22
34600>>>>        Set Location to 79 113
34601>>>>        Set Color to 12232306
34602>>>>    End_Object    // chkxr
34603>>>>
34603>>>>
34603>>>>    //AB-StoreStart
34603>>>>    
34603>>>>    On_Key Key_Ctrl+Key_X Send None
34604>>>>    On_Key Key_Alt+Key_X  Send None
34605>>>>    
34605>>>>    Function ifSelect_Xrhsh Returns String
34607>>>>        String  lsRecord_id
34608>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
34609>>>>        send popup_modal
34610>>>>        Get psSelectedYearRecr to lsRecord_id
34611>>>>        Function_return lsRecord_Id
34612>>>>    End_Function
34613>>>>    
34613>>>>    Procedure AcceptTheValues
34615>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
34616>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
34616>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
34616>>>>        Move Year_DD to liYearDD
34617>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
34618>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34621>>>>        else begin
34622>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
34623>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
34624>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
34627>>>>            else begin
34628>>>>                Move Company_DD to liCompanyDD
34629>>>>                Move Branch_DD  to liBranchDD
34630>>>>                Move Year_DD    to liYearDD
34631>>>>                send Request_Save to liYearDD
34632>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
34633>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
34634>>>>    
34634>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
34635>>>>    
34635>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
34636>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
34637>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
34638>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
34639>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
34640>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
34641>>>>    
34641>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
34642>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
34643>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
34644>>>>    
34644>>>>    
34644>>>>                Local String    sCode
34644>>>>                Local Integer   iBreak
34644>>>>                Move 0 to iBreak
34645>>>>                Clear Nomisma
34646>>>>                Find Gt Nomisma.Recnum
34647>>>>>
34647>>>>                While ((Found=1) And (iBreak=0))
34651>>>>                    If (Nomisma.Einai_Euro='1') Begin
34653>>>>                        Move 1 to iBreak
34654>>>>                        Move Nomisma.Nomisma_Code to sCode
34655>>>>                    End
34655>>>>>
34655>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
34658>>>>                Loop
34659>>>>>
34659>>>>                Move (Trim(sCode)) to sCode
34660>>>>    
34660>>>>    
34660>>>>                Reread SysCurXR
34664>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
34665>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
34666>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
34667>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
34668>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
34669>>>>                Move lsSite                     to SysCurXR.Branch_Site
34670>>>>    
34670>>>>                Move sCname                     to SysCurXR.Company_Name
34671>>>>                Move sBname                     to SysCurXR.Branch_Name
34672>>>>                Move sYname                     to SysCurXR.Year_Descr
34673>>>>    
34673>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
34674>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
34675>>>>    
34675>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
34676>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
34677>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
34678>>>>    
34678>>>>                Move sCode                      to SysCurXR.Euro_Code
34679>>>>    
34679>>>>                Saverecord SysCurXR
34680>>>>                Unlock
34681>>>>>
34681>>>>    
34681>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
34682>>>>                Set psSelectedYearRecr          to lsYearRecr
34683>>>>    
34683>>>>                Send Stop_Modal_ui
34684>>>>    
34684>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
34685>>>>            End
34685>>>>>
34685>>>>        end
34685>>>>>
34685>>>>    End_Procedure
34686>>>>    
34686>>>>    Set Locate_Mode to Center_On_Screen
34687>>>>    
34687>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
34688>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
34689>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
34690>>>>    
34690>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
34691>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    
34692>>>>    //AB-StoreEnd
34692>>>>
34692>>>>End_Object    // oSelectYear
34693>>>>
34693>>>>
34693>>>>//AB-StoreStart
34693>>>>
34693>>>>
34693>>>>//AB-StoreEnd
34693>>>>
34693>>>>//AB/ End_Object    // prj
34693>>
34693>>Procedure Epelexe_Xrhsh
34694>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
34695>>    String lsCompany lsBranch lsWhatXrhsh
34695>>    Move oSelectYear to liModalId
34696>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
34697>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
34700>>End_Procedure
34701>>
34701>>Procedure Allaxe_Xrhsh
34702>>    Integer rVal liModalId iID
34703>>    If (Close_All_Views(Self,True)=0) Begin
34705>>        Move oSelectYear to liModalId
34706>>        Send Epelexe_Xrhsh
34707>>    End
34707>>>
34707>>End_Procedure
34708>>
34708>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
34709>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
34710>>
34710>>Send Epelexe_Xrhsh
34711>>//------------------------------
34711>>
34711>Set Button_State    of (Wait(Self)) to False
34712>Set BarVisibleState of (Wait(Self)) to '' False
34713>Send Popup                          to (Wait(Self))
34714>Send UpdateWait to (Wait(Self))     '˜¨˜¡˜¢é §œ¨ £â¤œ«œ. „¢œš®¦ª ˜¨®œåà¤ œ­˜¨£¦šãª'
34715>
34715>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
34715>>>
34715>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
34715>>>>>
34715>>>>>Open Users
34717>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
34719>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
34721>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
34723>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
34725>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
34727>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
34729>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
34731>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
34733>>>>>Open Oth
INCLUDING FILE: OTH.FD
34735>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
34737>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
34739>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
34741>>>>>
34741>>>>>
34741>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34742>>>>>
34742>>>>>Function Network_User_Name Returns String
34743>>>>>    Local String sName sLength
34744>>>>>    Local Pointer lpName_Addr lpLength_Addr
34744>>>>>    Local Integer iRetval
34744>>>>>    Movestr (Repeat (Character (0), 255)) To sName
34745>>>>>>
34745>>>>>    GetAddress Of sName To lpName_Addr
34746>>>>>    Movestr (DwordToBytes (255)) To sLength
34747>>>>>>
34747>>>>>    GetAddress Of sLength To lpLength_Addr
34748>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34749>>>>>>
34749>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
34752>>>>>    Else Function_Return "User Unknown"
34754>>>>>End_Function // Network_User_Name
34755>>>>>
34755>>>>>Function fsGetOfficePath Global Returns String
34756>>>>>    String sRegistryKeyPath sRegOfficePath
34757>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
34758>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
34759>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
34763>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
34764>>>>>    If (sRegOfficePath='') Begin
34766>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
34767>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34771>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34772>>>>>        If (sRegOfficePath='') Begin
34774>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
34775>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34779>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34780>>>>>            If (sRegOfficePath='') Begin
34782>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
34783>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
34787>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
34788>>>>>            End
34788>>>>>>
34788>>>>>        End
34788>>>>>>
34788>>>>>    End
34788>>>>>>
34788>>>>>    Function_Return sRegOfficePath
34789>>>>>End_Procedure
34790>>>>>
34790>>>>>
34790>>>>>Function fsGetLastDir Global Returns String
34791>>>>>    String sRegistryKeyPath sRegDir sUserName
34792>>>>>    Get Network_User_Name to sUserName
34793>>>>>
34793>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34796>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34799>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34801>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34803>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34804>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34805>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
34808>>>>>    Function_Return sRegDir
34809>>>>>End_Procedure
34810>>>>>
34810>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
34811>>>>>    String sRegistryKeyPath sRegDir sUserName
34812>>>>>    Get Network_User_Name to sUserName
34813>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
34816>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
34819>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
34821>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
34823>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
34824>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
34825>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
34828>>>>>    Function_Return 0
34829>>>>>End_Procedure
34830>>>>>
34830>>>>>
34830>>>>>Function fsVresExt Global String asFileName Returns String
34831>>>>>    String rVal
34832>>>>>    Integer iPos iLen
34832>>>>>    Move (UpperCase(asFileName)) to asFileName
34833>>>>>    Move (Trim(asFileName)) to asFileName
34834>>>>>    Move 0 to iPos
34835>>>>>    For iLen from 1 to (length(asFileName))
34841>>>>>>
34841>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
34844>>>>>    Loop
34845>>>>>>
34845>>>>>    If (Not(iPos)) Function_Return ''
34848>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
34849>>>>>    Move (Trim(rVal)) to rVal
34850>>>>>    Function_Return rVal
34851>>>>>End_Function
34852>>>>>
34852>>>>>
34852>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
34853>>>>>    Integer rVal iUser iGroup
34854>>>>>    String  sUser sRecr
34854>>>>>    Move (Trim(asViewName))     to asViewName
34855>>>>>    Move (Trim(asDbFormName))   to asDbFormName
34856>>>>>
34856>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
34858>>>>>        Get fsLoginUserID to sUser
34859>>>>>        Clear Users
34860>>>>>        Move sUser        to Users.Login_ID
34861>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34862>>>>>>
34862>>>>>        If (Found=1) Begin
34864>>>>>            Move Users.User_ID  to iUser
34865>>>>>            Move Users.Grp_ID   to iGroup
34866>>>>>            Clear GrpOth
34867>>>>>            Move iUser          to GrpOth.User_ID
34868>>>>>            Move asViewName     to GrpOth.View_Name
34869>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
34870>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
34871>>>>>>
34871>>>>>            If (Found=1) Begin
34873>>>>>                // rVal=1 ==> NO READ ALLOWED
34873>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
34873>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
34873>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
34876>>>>>                Else Begin
34877>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
34879>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
34882>>>>>                        Else                        Move 2 to rVal
34884>>>>>                    End
34884>>>>>>
34884>>>>>                End
34884>>>>>>
34884>>>>>            End
34884>>>>>>
34884>>>>>            Else Begin
34885>>>>>                Clear GrpOth0
34886>>>>>                Move iGroup         to GrpOth0.Group_ID
34887>>>>>                Move asViewName     to GrpOth0.View_Name
34888>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
34889>>>>>
34889>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
34890>>>>>>
34890>>>>>                If (Found=1) Begin
34892>>>>>                    // rVal=1 ==> NO READ ALLOWED
34892>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34892>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34892>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
34895>>>>>                    Else Begin
34896>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
34898>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
34901>>>>>                            Else                         Move 2 to rVal
34903>>>>>                        End
34903>>>>>>
34903>>>>>                    End
34903>>>>>>
34903>>>>>                End
34903>>>>>>
34903>>>>>                Else Move 0 to rVal
34905>>>>>            End
34905>>>>>>
34905>>>>>        End
34905>>>>>>
34905>>>>>        Else Move 0 to rVal
34907>>>>>    End
34907>>>>>>
34907>>>>>    Function_Return rVal
34908>>>>>End_Function
34909>>>>>
34909>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
34910>>>>>    Integer rVal iUser iGroup
34911>>>>>    String  sUser sRecr
34911>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
34913>>>>>        Get fsLoginUserID to sUser
34914>>>>>        Clear Users
34915>>>>>        Move sUser        to Users.Login_ID
34916>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
34917>>>>>>
34917>>>>>        If (Found=1) Begin
34919>>>>>            Move Users.User_ID  to iUser
34920>>>>>            Move Users.Grp_ID   to iGroup
34921>>>>>            Clear Pedia
34922>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
34923>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
34924>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
34925>>>>>>
34925>>>>>            If (Found=1) Begin
34927>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
34928>>>>>                // Find Combination User/File/Field in GRPPEDIA
34928>>>>>                Clear GrpPedia
34929>>>>>                Move iUser                      to GrpPedia.User_ID
34930>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
34931>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
34932>>>>>>
34932>>>>>                If (Found=1) Begin
34934>>>>>                    // rVal=1 ==> NO READ ALLOWED
34934>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
34934>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
34934>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
34937>>>>>                    Else Begin
34938>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
34940>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
34943>>>>>                            Else                            Move 2 to rVal
34945>>>>>                        End
34945>>>>>>
34945>>>>>                    End
34945>>>>>>
34945>>>>>                End
34945>>>>>>
34945>>>>>                Else Begin
34946>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
34946>>>>>                    Clear GrpPed0
34947>>>>>                    Move iGroup         to GrpPed0.Group_ID
34948>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
34949>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
34950>>>>>>
34950>>>>>                    If (Found=1) Begin
34952>>>>>                        // rVal=1 ==> NO READ ALLOWED
34952>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
34952>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
34952>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
34955>>>>>                        Else Begin
34956>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
34958>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
34961>>>>>                                Else                           Move 2 to rVal
34963>>>>>                            End
34963>>>>>>
34963>>>>>                        End
34963>>>>>>
34963>>>>>                    End
34963>>>>>>
34963>>>>>                End
34963>>>>>>
34963>>>>>            End
34963>>>>>>
34963>>>>>            Else Begin
34964>>>>>                Move 0 to rVal
34965>>>>>            End
34965>>>>>>
34965>>>>>        End
34965>>>>>>
34965>>>>>        Else Begin
34966>>>>>            Move 0 to rVal
34967>>>>>        End
34967>>>>>>
34967>>>>>    End
34967>>>>>>
34967>>>>>    Function_Return rVal
34968>>>>>End_Function
34969>>>>>
34969>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
34970>>>>>    String rVal lsDirSep
34971>>>>>    Integer iPos iMet iLen iCnt
34971>>>>>    Move (Trim(asFullPath))                 To rVal
34972>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
34973>>>>>    If (rVal Contains lsDirSep) Begin
34975>>>>>        Move (Length(rVal)) to iLen
34976>>>>>        Move iLen to iCnt
34977>>>>>        While iCnt Gt 0
34981>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
34983>>>>>                If (iCnt=iLen) Function_Return asFullPath
34986>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
34988>>>>>            End
34988>>>>>>
34988>>>>>            Decrement iCnt
34989>>>>>        End // While iCnt Gt 0
34990>>>>>>
34990>>>>>    End
34990>>>>>>
34990>>>>>    Else  Function_Return (Trim(asFullPath))
34992>>>>>    Function_Return rVal
34993>>>>>End_Function
34994>>>>>
34994>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
34995>>>>>    String rVal lsDirSep
34996>>>>>    Integer iPos iMet iLen iCnt
34996>>>>>    Move (Trim(asFullPath))                 To rVal
34997>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
34998>>>>>    If (rVal Contains lsDirSep) Begin
35000>>>>>        Move (Length(rVal)) to iLen
35001>>>>>        Move iLen to iCnt
35002>>>>>        While iCnt Gt 0
35006>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
35009>>>>>            Decrement iCnt
35010>>>>>        End // While iCnt Gt 0
35011>>>>>>
35011>>>>>    End
35011>>>>>>
35011>>>>>    Function_Return rVal
35012>>>>>End_Function
35013>>>>>
35013>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
35013>>>>>//    Local String rVal lsTmp lsOO lsLL
35013>>>>>//    Local Number lnOO lnLL
35013>>>>>
35013>>>>>//    Move '' to lsOO
35013>>>>>//    Move '' to lsLL
35013>>>>>//    Move '' to rVal
35013>>>>>
35013>>>>>//    Move (Integer(anTime))                              to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
35013>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
35013>>>>>//    ////////////////////////////////////////////
35013>>>>>
35013>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
35013>>>>>
35013>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
35013>>>>>//    Else         Move (String(lnOO))                    to lsOO
35013>>>>>//    Move (Trim(lsOO))                                   to lsOO
35013>>>>>
35013>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
35013>>>>>//    Else         Move (String(lnLL))                    to lsLL
35013>>>>>//    Move (Trim(lsLL))                                   to lsLL
35013>>>>>
35013>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
35013>>>>>
35013>>>>>//    Move (Trim(rVal)) to rVal
35013>>>>>
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
35013>>>>>//    Local Number rVal nOres nLepta
35013>>>>>//    Move (Integer(aiMinutes/60))    to nOres
35013>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
35013>>>>>//    Move (nOres+(nLepta/100))       to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
35013>>>>>//    Local Integer rVal
35013>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
35013>>>>>//                                                                    Number anEndTime    ;
35013>>>>>//                                                                    Returns Integer
35013>>>>>//    Local Integer rVal iMinStart iMinEnd
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
35013>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
35013>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
35013>>>>>//                                                                Number anEndTime    ;
35013>>>>>//                                                                Returns Number
35013>>>>>//    Local Integer iTmp
35013>>>>>//    Local Number  rVal
35013>>>>>
35013>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
35013>>>>>
35013>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
35013>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
35013>>>>>//    Function_Return rVal
35013>>>>>//End_Function
35013>>>>>
35013>>>>>
35013>>>>>Function fsLoginUserID Global Returns String
35014>>>>>    Local String LastLogin# LoginUserid#
35015>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
35018>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
35021>>>>>    insert "WorkSpaces\" in LastLogin# at 1
35023>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
35026>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
35029>>>>>    Trim LoginUserID# to LoginUserID#
35030>>>>>>
35030>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
35033>>>>>    Function_Return LoginUserID#
35034>>>>>End_Function
35035>>>>>
35035>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
35036>>>>>    Integer rVal
35037>>>>>    String  lsCurrentWksp
35037>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35040>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35043>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35045>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35045>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35045>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35048>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35051>>>>>    Function_Return rVal
35052>>>>>End_Function
35053>>>>>
35053>>>>>
35053>>>>>Function fsReadRegistryLastSDFPath Global Returns String
35054>>>>>    String rVal lsCurrentWksp
35055>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35058>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35061>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35063>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
35063>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
35063>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
35066>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35069>>>>>    Function_Return (Trim(rVal))
35070>>>>>End_Function
35071>>>>>
35071>>>>>
35071>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
35072>>>>>    Integer rVal
35073>>>>>    String  lsCurrentWksp
35073>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35076>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35079>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35081>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35084>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35087>>>>>    Function_Return rVal
35088>>>>>End_Function
35089>>>>>
35089>>>>>
35089>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
35090>>>>>    String rVal lsCurrentWksp
35091>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35094>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35097>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35099>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
35102>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35105>>>>>    Function_Return (Trim(rVal))
35106>>>>>End_Function
35107>>>>>
35107>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
35108>>>>>    Integer rVal
35109>>>>>    String  lsCurrentWksp
35109>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35112>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35115>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35117>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35120>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
35123>>>>>    Function_Return rVal
35124>>>>>End_Function
35125>>>>>
35125>>>>>
35125>>>>>Function fsReadRegistryLastWEBPath Global Returns String
35126>>>>>    String rVal lsCurrentWksp
35127>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35130>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35133>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35135>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
35138>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
35141>>>>>    Function_Return (Trim(rVal))
35142>>>>>End_Function
35143>>>>>
35143>>>>>Function fsReadRegistryFEMRootDir Global Returns String
35144>>>>>    String rVal lsCurrentWksp
35145>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35148>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35151>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35153>>>>>    Append lsCurrentWksp "\FEM"
35154>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
35157>>>>>    Function_Return (Trim(rVal))
35158>>>>>End_Function
35159>>>>>
35159>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
35160>>>>>    String rVal lsCurrentWksp
35161>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35164>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35167>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35169>>>>>    Append lsCurrentWksp "\FEM"
35170>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
35173>>>>>    Function_Return (Trim(rVal))
35174>>>>>End_Function
35175>>>>>
35175>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
35176>>>>>    Integer rVal
35177>>>>>    String  lsCurrentWksp
35177>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35180>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35183>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35185>>>>>    Append lsCurrentWksp "\FEM"
35186>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
35189>>>>>    Function_Return rVal
35190>>>>>End_Function
35191>>>>>
35191>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
35192>>>>>    Integer rVal
35193>>>>>    String  lsCurrentWksp
35193>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
35196>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
35199>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
35201>>>>>    Append lsCurrentWksp "\FEM"
35202>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
35205>>>>>    Function_Return rVal
35206>>>>>End_Function
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>
35207>>>>>Function fig_Is_Admin Global Returns Integer
35208>>>>>    String sUser
35209>>>>>    Integer rVal
35209>>>>>    Get fsLoginUserID to sUser
35210>>>>>    Move (trim(sUser)) to sUser
35211>>>>>    Clear Users
35212>>>>>    Move sUser to Users.Login_ID
35213>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35214>>>>>>
35214>>>>>    Move Users.Admin_Rights to rVal
35215>>>>>    Function_Return rVal
35216>>>>>End_Function
35217>>>>>
35217>>>>>Function fig_The_User_Group Global Returns Integer
35218>>>>>    String sUser
35219>>>>>    Get fsLoginUserID   to sUser
35220>>>>>    Move (trim(sUser))  to sUser
35221>>>>>    Clear Users
35222>>>>>    Move sUser          to Users.Login_ID
35223>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35224>>>>>>
35224>>>>>    Clear UserGrps
35225>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35226>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35227>>>>>>
35227>>>>>    Function_Return UserGrps.Grp_ID
35228>>>>>End_Function
35229>>>>>
35229>>>>>Function fsg_The_User_Department Global Returns String
35230>>>>>    String sUser
35231>>>>>    Get fsLoginUserID   to sUser
35232>>>>>    Move (trim(sUser))  to sUser
35233>>>>>    Clear Users
35234>>>>>    Move sUser          to Users.Login_ID
35235>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35236>>>>>>
35236>>>>>    Clear Departm
35237>>>>>    Move Users.Departm_Code   to Departm.Code
35238>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35239>>>>>>
35239>>>>>    Function_Return Departm.Code
35240>>>>>End_Function
35241>>>>>
35241>>>>>
35241>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
35242>>>>>    Integer rVal
35243>>>>>    Move (trim(asUser)) to asUser
35244>>>>>    Clear Users
35245>>>>>    Move asUser to Users.Login_ID
35246>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35247>>>>>>
35247>>>>>    Move Users.Admin_Rights to rVal
35248>>>>>    Function_Return rVal
35249>>>>>End_Function
35250>>>>>
35250>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
35251>>>>>    Move (trim(asUser))  to asUser
35252>>>>>    Clear Users
35253>>>>>    Move asUser          to Users.Login_ID
35254>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35255>>>>>>
35255>>>>>    Clear UserGrps
35256>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
35257>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
35258>>>>>>
35258>>>>>    Function_Return UserGrps.Grp_ID
35259>>>>>End_Function
35260>>>>>
35260>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
35261>>>>>    Move (trim(asUser))  to asUser
35262>>>>>    Clear Users
35263>>>>>    Move asUser          to Users.Login_ID
35264>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
35265>>>>>>
35265>>>>>    Clear Departm
35266>>>>>    Move Users.Departm_Code   to Departm.Code
35267>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
35268>>>>>>
35268>>>>>    Function_Return Departm.Code
35269>>>>>End_Function
35270>>>>>
35270>>>>>
35270>>>
35270>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
35271>>>
35271>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
35273>>>    Open Users
35275>>>    Open Views
INCLUDING FILE: VIEWS.FD
35277>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
35279>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
35281>>>    Open Arxeia
35283>>>    Open GrpArx
35285>>>
35285>>>    Function Find_User_Rights_In_Class String asView Returns Integer
35286>>>        String  lsView lsLogin
35287>>>        Integer liUser  liViews iGroup
35287>>>
35287>>>        Move (fsLoginUserID())      to lsLogin
35288>>>        Move (Trim(ToOEM(asView)))  to lsView
35289>>>
35289>>>        //////  /////////////////////////////////////
35289>>>        Clear Users
35290>>>        Move lsLogin    to Users.Login_ID
35291>>>
35291>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
35292>>>>
35292>>>        If (Found=1)  Begin
35294>>>            Move Users.User_ID  to liUser
35295>>>            Move Users.Grp_ID   to iGroup
35296>>>        End
35296>>>>
35296>>>        Else Function_Return 0
35298>>>
35298>>>        Clear Views
35299>>>        Move (Trim(lsView)) to Views.Menu_Name
35300>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
35301>>>>
35301>>>        If (Found=1) Begin
35303>>>            Move Views.View_ID to liViews
35304>>>            Clear GrpViews
35305>>>            Move liUser    to GrpViews.User_ID
35306>>>            Move liViews   to GrpViews.View_ID
35307>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
35308>>>>
35308>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
35310>>>                Function_Return (GrpViews.Allow_Read<>'1')
35311>>>            End
35311>>>>
35311>>>            Else Begin
35312>>>                Clear GrpView0
35313>>>                Move iGroup    to GrpView0.Group_ID
35314>>>                Move liViews   to GrpView0.View_ID
35315>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
35316>>>>
35316>>>                If (Found=1) Begin
35318>>>                    Function_Return (GrpView0.Allow_Read<>'1')
35319>>>                End
35319>>>>
35319>>>                Else         Function_Return 0
35321>>>            End
35321>>>>
35321>>>        End
35321>>>>
35321>>>        Else Function_Return 0
35323>>>    End_Function
35324>>>
35324>>>//    Procedure Enhmerose_Views_File_In_Class
35324>>>//        Integer liCount liInt liLastNo
35324>>>//        String lsStr
35324>>>//        Get Item_Count to liCount
35324>>>//        // find last view_id
35324>>>//        Clear Views
35324>>>//        Move 9999 to Views.View_ID
35324>>>//        Find lt Views by index.1 // view_id
35324>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
35324>>>//        Else            Move 0              to liLastNo
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Begin
35324>>>//                Clear Views
35324>>>//                Move lsStr to Views.Menu_Name
35324>>>//                Find eq Views by index.2 // Views.Menu_Name
35324>>>//                If (NOT(Found)) Begin
35324>>>//                    Add 1 to liLastNo
35324>>>//                    Move liLastNo to Views.View_ID
35324>>>//                    Saverecord Views
35324>>>//                End
35324>>>//            End
35324>>>//        Loop
35324>>>//        For liInt From 0 to (liCount-1)
35324>>>//            Get Value item liInt to lsStr
35324>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
35324>>>//            //Move (Trim(lsStr)) to lsStr
35324>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35324>>>//        Loop
35324>>>//    End_procedure
35324>>>
35324>>>    Procedure OnInitMenu
35325>>>        Integer liCount liInt liLastNo
35326>>>        String lsStr
35326>>>
35326>>>        Get Item_Count to liCount
35327>>>
35327>>>        // find last view_id
35327>>>        Clear Views
35328>>>        Move 9999 to Views.View_ID
35329>>>        Find lt Views by index.1 // view_id
35330>>>>
35330>>>        If (Found=1)    Move Views.View_ID  to liLastNo
35333>>>        Else            Move 0              to liLastNo
35335>>>        For liInt From 0 to (liCount-1)
35341>>>>
35341>>>            Get Value item liInt to lsStr
35342>>>            Move (Trim(lsStr)) to lsStr
35343>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
35345>>>                Clear Views
35346>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
35347>>>                Find eq Views by index.2 // Views.Menu_Name
35348>>>>
35348>>>                If (NOT(Found)) Begin
35350>>>                    Add 1 to liLastNo
35351>>>                    Move liLastNo to Views.View_ID
35352>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
35352>>>                    Saverecord Views
35353>>>                End
35353>>>>
35353>>>            End
35353>>>>
35353>>>        Loop
35354>>>>
35354>>>        For liInt From 0 to (liCount-1)
35360>>>>
35360>>>            Get Value item liInt to lsStr
35361>>>            Move (Trim(lsStr)) to lsStr
35362>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
35363>>>        Loop
35364>>>>
35364>>>
35364>>>    End_procedure
35365>>>
35365>>>//    Procedure End_Construct_Object
35365>>>//        Forward Send End_Construct_Object
35365>>>//        Send Enhmerose_Views_File_In_Class
35365>>>//    End_Procedure
35365>>>
35365>>>End_Class //ButtonSub
35366>>>
35366>>>
35366>
35366>//------------------------------
35366>Use Flexole
INCLUDING FILE: FLEXOLE.PKG
35366>>>//****************************************************************************
35366>>>//
35366>>>// $File name  : FlexOLE
35366>>>// $File title : Base class for OLE Automation in DataFlex under win95/NT
35366>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35366>>>// $Author     : JW, SF
35366>>>// $System     : DFOLE
35366>>>// Created     : 96-05-30 @ 18.12.51
35366>>>// $Last Rev   : 96-10-09 @ 14.59.35
35366>>>//
35366>>>// $Description
35366>>>// This file contains the complete FlexOLE OLE2 implementation in DataFlex.
35366>>>// Including all DLL interface declarations and DataFlex classes
35366>>>//
35366>>>// $Rev History
35366>>>//   96-05-30 File header created
35366>>>//
35366>>>//****************************************************************************
35366>>>
35366>>>USE DLL
35366>>>USE FOLE_API
INCLUDING FILE: FOLE_API.PKG
35366>>>>>//****************************************************************************
35366>>>>>//
35366>>>>>// $File name  : FOLE_API
35366>>>>>// $File title : API for FlexOLE
35366>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1998
35366>>>>>// $Author     : JW, SF
35366>>>>>// $System     : FlexOLE
35366>>>>>// Created     : 96-05-30 @ 18.12.51
35366>>>>>// $Last Rev   : 96-10-09 @ 14.59.35
35366>>>>>//
35366>>>>>// $Description
35366>>>>>//  DLL interface declarations
35366>>>>>//
35366>>>>>// $Rev History
35366>>>>>//   96-05-30 File header created
35366>>>>>//
35366>>>>>//****************************************************************************
35366>>>>>
35366>>>>>
35366>>>>>USE DLL
35366>>>>>
35366>>>>>// Global variable for OLE
35366>>>>>Integer WM_DFOCXEVENT // This is the message sent from the DLL
35366>>>>>Integer WM_DFOCXNOTIFYEVENT // This is the notify message sent from the DLL
35366>>>>>
35366>>>>>//Global integer for objectId
35366>>>>>Integer oOLEVariantId
35366>>>>>
35366>>>>>
35366>>>>>
35366>>>>>// Optional param for OLEVariant.
35366>>>>>// For optional parameters, pass OLE_VT_OPTIONAL instead of an OLEVariant
35366>>>>>
35366>>>>>// DISP_E_PARAMNOTFOUND is the constant used together with OLE_VT_ERROR
35366>>>>>// to signify that this parameter is optional and not specified.
35366>>>>>// It is only used internally, DON'T use it directly, see above constant.
35366>>>>>
35366>>>>>// The current maximum size of strings, used both for String and OLEVariant with OLE_VT_BSTR
35366>>>>>
35366>>>>>// Null terminating for C strings
35366>>>>>
35366>>>>>// Alias data types
35366>>>>>                            // but since DataFlex has no substitute data type
35366>>>>>                            // it is internally casted back and forth
35366>>>>>                            // into an Integer
35366>>>>>                            // NOTE! Might be changed to a one char string
35366>>>>>
35366>>>>>
35366>>>>>
35366>>>>>// Pointers to vars needs to be inside a Type to use GetAddress...
35366>>>>>// It looks like we have to create these anyway (to compile cleanly)
35366>>>>>
35366>>>>>
35366>>>>>Type TP_OLEVariant
35366>>>>>    Field Variant.vt     as DWORD      // An OLE_VT_XXX constant
35366>>>>>    Field Variant.iVal   as DWORD      // If vt is OLE_VT_I2 this field contains a Short value
35366>>>>>    Field Variant.lVal   as DWORD      // If vt is OLE_VT_I4 this field contains an Integer value
35366>>>>>    Field Variant.fltVal as Char 10    // If vt is OLE_VT_R4 this field contains a ShortReal value
35366>>>>>    Field Variant.dblVal as Char 20    // If vt is OLE_VT_R8 this field contains a Real value
35366>>>>>    Field Variant.cyVal  as Char 25    // If vt is OLE_VT_CY this field contains a Currency value
35366>>>>>    Field Variant.dtVal  as Date       // If vt is OLE_VT_DATE this field contains a Date value
35366>>>>>    Field Variant.strVal as Char 255   // If vt is OLE_VT_BSTR this field contains a pointer to a String
35366>>>>>    Field Variant.dspVal as LPDISPATCH // If vt is OLE_VT_DISPATCH this field contains an LPDISPATCH
35366>>>>>    Field Variant.errVal as OLEError   // If vt is OLE_VT_ERROR this field contains an OLEError
35366>>>>>    Field Variant.blVal  as Bool       // If vt is OLE_VT_BOOL this field contains a Bool value
35366>>>>>    Field Variant.uknVal as LPIUNKNOWN // If vt is OLE_VT_UNKNOWN this field contains an LPIUnknown
35366>>>>>    Field Variant.ui1Val as DWORD      // If vt is OLE_VT_UI1 this field contains a UChar value
35366>>>>>End_Type
35366>>>>>
35366>>>>>
35366>>>>>// VARIANT constants used with the vt field in an OLEVariant type
35366>>>>>
35366>>>>>
35366>>>>>
35366>>>>>// SetFocus/KillFocus event, sent in wParam of WM_DFOCXNOTIFYEVENT
35366>>>>>
35366>>>>>// Used to register the OCX event notification messages
35366>>>>>External_Function32 RegisterWindowMessage "RegisterWindowMessageA" USER32.DLL;                    String sWM_MSG;                    Returns Integer
35367>>>>>
35367>>>>>// External functions providing access to DFOLECLN.DLL
35367>>>>>// These functions are normally not accessed directly, they are
35367>>>>>// rather accessed through an Automation_Client/OCX_Client derived class/object
35367>>>>>
35367>>>>>//********DLL Interface OLE Auto General Functions************
35367>>>>>
35367>>>>>External_Function32 CreateAutomationClient "CreateAutomationClient" DFOLECLN.DLL;                    Returns DWORD
35368>>>>>
35368>>>>>
35368>>>>>External_Function32 DestroyAutomationClient "DestroyAutomationClient" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35369>>>>>
35369>>>>>External_Function32 CreateAutoClientDispatch "CreateAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35370>>>>>
35370>>>>>External_Function32 AttachAutoClientDispatch "AttachAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch disp;                    Integer addRef;                    Returns DWORD
35371>>>>>
35371>>>>>External_Function32 AttachAutoClientActiveObject "AttachAutoClientActiveObject" DFOLECLN.DLL;                    Integer clientId;                    String progIdStr;                    Returns DWORD
35372>>>>>
35372>>>>>External_Function32 ReleaseAutoClientDispatch "ReleaseAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns DWORD
35373>>>>>
35373>>>>>External_Function32 GetAutoClientDispatch "GetAutoClientDispatch" DFOLECLN.DLL;                    Integer clientId;                    Returns LPDispatch
35374>>>>>
35374>>>>>//********DLL Interface OLE Auto Get Property Functions**************
35374>>>>>
35374>>>>>External_Function32 GetAutoClientBoolProperty "GetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35375>>>>>
35375>>>>>External_Function32 GetAutoClientCurrencyProperty "GetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35376>>>>>
35376>>>>>External_Function32 GetAutoClientDateProperty "GetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35377>>>>>
35377>>>>>External_Function32 GetAutoClientLPDispatchProperty "GetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35378>>>>>
35378>>>>>External_Function32 GetAutoClientRealProperty "GetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35379>>>>>
35379>>>>>External_Function32 GetAutoClientShortRealProperty "GetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Real
35380>>>>>
35380>>>>>External_Function32 GetAutoClientIntegerProperty "GetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35381>>>>>
35381>>>>>External_Function32 GetAutoClientShortProperty "GetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35382>>>>>
35382>>>>>
35382>>>>>External_Function32 GetAutoClientStringProperty "GetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns DWORD
35383>>>>>
35383>>>>>External_Function32 GetAutoClientOLEVariantProperty "GetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  LPOLEVar
35384>>>>>
35384>>>>>
35384>>>>>//********DLL Interface OLE Auto Set Property Functions**************
35384>>>>>
35384>>>>>External_Function32 SetAutoClientBoolProperty "SetAutoClientBoolProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD    prop;                    Returns DWORD
35385>>>>>
35385>>>>>External_Function32 SetAutoClientCurrencyProperty "SetAutoClientCurrencyProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35386>>>>>
35386>>>>>External_Function32 SetAutoClientDateProperty "SetAutoClientDateProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Date    prop;                    Returns DWORD
35387>>>>>
35387>>>>>External_Function32 SetAutoClientLPDispatchProperty "SetAutoClientLPDispatchProperty" DFOLECLN.DLL;                    Integer    clientId;                    DWORD    dwDispId;                    LPDispatch prop;                    Returns    DWORD
35388>>>>>
35388>>>>>External_Function32 SetAutoClientRealProperty "SetAutoClientRealProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String   prop;                    Returns DWORD
35389>>>>>
35389>>>>>External_Function32 SetAutoClientShortRealProperty "SetAutoClientShortRealProperty" DFOLECLN.DLL;                    Integer   clientId;                    DWORD   dwDispId;                    String prop;                    Returns   DWORD
35390>>>>>
35390>>>>>External_Function32 SetAutoClientIntegerProperty "SetAutoClientIntegerProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    DWORD prop;                    Returns DWORD
35391>>>>>
35391>>>>>External_Function32 SetAutoClientShortProperty "SetAutoClientShortProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Integer   prop;                    Returns DWORD
35392>>>>>
35392>>>>>External_Function32 SetAutoClientStringProperty "SetAutoClientStringProperty" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    String  prop;                    Returns DWORD
35393>>>>>
35393>>>>>External_Function32 SetAutoClientOLEVariantProperty "SetAutoClientOLEVariantProperty" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    String prop;                    Returns  DWORD
35394>>>>>
35394>>>>>
35394>>>>>//******DLL Interface OLE Auto Pre Invoke Functions**************
35394>>>>>
35394>>>>>External_Function32 DeclareAutoClientInvokeParams "DeclareAutoClientInvokeParams" DFOLECLN.DLL;                    Integer clientId;                    DWORD nrOfParams;                    Returns DWORD
35395>>>>>
35395>>>>>External_Function32 DefineAutoClientBoolParam "DefineAutoClientBoolParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD    param;                    Returns DWORD
35396>>>>>
35396>>>>>External_Function32 DefineAutoClientCurrencyParam "DefineAutoClientCurrencyParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35397>>>>>
35397>>>>>External_Function32 DefineAutoClientDateParam "DefineAutoClientDateParam" DFOLECLN.DLL;                    Integer clientId;                    Date    param;                    Returns DWORD
35398>>>>>
35398>>>>>External_Function32 DefineAutoClientRealParam "DefineAutoClientRealParam" DFOLECLN.DLL;                    Integer clientId;                    String    param;                    Returns DWORD
35399>>>>>
35399>>>>>External_Function32 DefineAutoClientShortRealParam "DefineAutoClientShortRealParam" DFOLECLN.DLL;                    Integer   clientId;                    String param;                    Returns   DWORD
35400>>>>>
35400>>>>>External_Function32 DefineAutoClientIntegerParam "DefineAutoClientIntegerParam" DFOLECLN.DLL;                    Integer clientId;                    DWORD param;                    Returns DWORD
35401>>>>>
35401>>>>>External_Function32 DefineAutoClientShortParam "DefineAutoClientShortParam" DFOLECLN.DLL;                    Integer clientId;                    Integer   param;                    Returns DWORD
35402>>>>>
35402>>>>>External_Function32 DefineAutoClientLPDispatchParam "DefineAutoClientLPDispatchParam" DFOLECLN.DLL;                    Integer clientId;                    LPDispatch param;                    Returns DWORD
35403>>>>>
35403>>>>>External_Function32 DefineAutoClientStringParam "DefineAutoClientStringParam" DFOLECLN.DLL;                    Integer clientId;                    String  param;                    Returns DWORD
35404>>>>>
35404>>>>>External_Function32 DefineAutoClientOLEVariantParam "DefineAutoClientOLEVariantParam" DFOLECLN.DLL;                    Integer  clientId;                    OLEVariant param;                    Returns  DWORD
35405>>>>>
35405>>>>>//********DLL Interface OLE Auto Invoke Functions*********************
35405>>>>>
35405>>>>>External_Function32 InvokeAutoClientVoidFunction "InvokeAutoClientVoidFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35406>>>>>
35406>>>>>External_Function32 InvokeAutoClientBoolFunction "InvokeAutoClientBoolFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35407>>>>>
35407>>>>>External_Function32 InvokeAutoClientCurrencyFunction "InvokeAutoClientCurrencyFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35408>>>>>
35408>>>>>External_Function32 InvokeAutoClientDateFunction "InvokeAutoClientDateFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Date
35409>>>>>
35409>>>>>External_Function32 InvokeAutoClientLPDispatchFunction "InvokeAutoClientLPDispatchFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns LPDispatch
35410>>>>>
35410>>>>>External_Function32 InvokeAutoClientRealFunction "InvokeAutoClientRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35411>>>>>
35411>>>>>External_Function32 InvokeAutoClientShortRealFunction "InvokeAutoClientShortRealFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer destStr;                    Returns Integer
35412>>>>>
35412>>>>>External_Function32 InvokeAutoClientIntegerFunction "InvokeAutoClientIntegerFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns DWORD
35413>>>>>
35413>>>>>External_Function32 InvokeAutoClientShortFunction "InvokeAutoClientShortFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Returns Integer
35414>>>>>
35414>>>>>External_Function32 InvokeAutoClientStringFunction "InvokeAutoClientStringFunction" DFOLECLN.DLL;                    Integer clientId;                    DWORD dwDispId;                    Pointer  destStr;                    Returns Integer
35415>>>>>
35415>>>>>
35415>>>>>External_Function32 InvokeAutoClientOLEVariantFunction "InvokeAutoClientOLEVariantFunction" DFOLECLN.DLL;                    Integer  clientId;                    DWORD  dwDispId;                    LPOLEVar destVar;                    Returns  Integer
35416>>>>>
35416>>>>>//********DLL Interface OLE Control Functions*********************
35416>>>>>
35416>>>>>
35416>>>>>External_Function32 CreateOCXClient "CreateOCXClient" DFOLECLN.DLL;                    Returns Integer
35417>>>>>
35417>>>>>
35417>>>>>External_Function32 CreateOCXControl "CreateOCXControl" DFOLECLN.DLL;                    Integer iCId;                    Pointer pPar;                    String  sCId;                    String  sCap;                    Dword   wSty;                    String  sLic;                    String  sFile;                    Returns Integer
35418>>>>>
35418>>>>>External_Function32 DestroyOCXControl "DestroyOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    Returns Integer
35419>>>>>
35419>>>>>External_Function32 GetOCXEventBoolParam "GetOCXEventBoolParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35420>>>>>
35420>>>>>External_Function32 GetOCXEventCurrencyParam "GetOCXEventCurrencyParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35421>>>>>
35421>>>>>External_Function32 GetOCXEventDateParam "GetOCXEventDateParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Date
35422>>>>>
35422>>>>>External_Function32 GetOCXEventRealParam "GetOCXEventRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35423>>>>>
35423>>>>>External_Function32 GetOCXEventShortRealParam "GetOCXEventShortRealParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer destStr;                    Returns Integer
35424>>>>>
35424>>>>>External_Function32 GetOCXEventIntegerParam "GetOCXEventIntegerParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35425>>>>>
35425>>>>>External_Function32 GetOCXEventShortParam "GetOCXEventShortParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Returns Integer
35426>>>>>
35426>>>>>External_Function32 GetOCXEventStringParam "GetOCXEventStringParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    Pointer pDestStr;                    Returns Integer
35427>>>>>
35427>>>>>External_Function32 GetOCXEventOLEVariantParam "GetOCXEventOLEVariantParam" DFOLECLN.DLL;                    Pointer pDispParams;                    Integer param;                    LPOLEVAR pDestVar;                    Returns Integer
35428>>>>>
35428>>>>>External_Function32 EnableOCXControl "EnableOCXControl" DFOLECLN.DLL;                    Integer iClientId;                    BOOL bEnable;                    Returns Integer
35429>>>>>
35429>>>>>External_Function32 GetOCXControlCaption "GetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    Pointer lpDestStr;                    Returns Integer
35430>>>>>
35430>>>>>External_Function32 SetOCXControlCaption "SetOCXControlCaption" DFOLECLN.DLL;                    Integer iClientId;                    String  sCaption;                    Returns Integer
35431>>>>>
35431>>>>>External_Function32 LoadOlePicture "LoadOlePicture" DFOLECLN.DLL;                    String  sFilename;                    Returns LPDispatch
35432>>>>>
35432>>>>>External_Function32 ReleaseComPointer "ReleaseComPtr" DFOLECLN.DLL;                    LPIUnknown  comPtr;                    Returns Integer
35433>>>>>
35433>>>>>External_Function32 DFOleInit "DFOleInit" DFOLECLN.DLL;                    Returns Integer
35434>>>>>
35434>>>>>External_Function32 DFOleUninit "DFOleUninit" DFOLECLN.DLL;                    Returns Integer
35435>>>>>
35435>>>>>External_Function32 AlterOCXEventParam "AlterOCXEventParam" DFOLECLN.DLL;                    Pointer  pdispParams;                    Integer iparam;                    OLEVariant vNewValue;                    Returns  Integer
35436>>>>>
35436>>>>>
35436>>>>>
35436>>>>>// This command is only used internaly and should NOT be used by the developer
35436>>>>>
35436>>>USE DFEXTCLM
35436>>>USE EXTFRM
35436>>>USE DBEXTFRM
35436>>>
35436>>>//**********
35436>>>//*** Error messages***
35436>>>//**********
35436>>>
35436>>>    Enum_List
35436>>>        Define OLE_SV_LANG
35436>>>        Define OLE_US_LANG
35436>>>    End_Enum_List
35436>>>
35436>>>    Define OLE_CURR_LANG For OLE_US_LANG
35436>>>
35436>>>        //*** US
INCLUDING FILE: FLXOLEUS.INC
35436>>>>
35436>>>
35436>>>
35436>>>// This class encapsulates the behaviour of an OLEVariant, and simplifies
35436>>>// tasks involved working with the OLEVariant.
35436>>>Class cOLEVariant is an array
35437>>>    Procedure Construct_Object
35438>>>        Forward Send Construct_Object
35440>>>        Local Integer iRetVal
35441>>>        Move (DFOleInit()) to iRetVal
35442>>>        Send OCXInit
35443>>>    End_Procedure
35444>>>
35444>>>    Procedure Destroy_Object
35445>>>        Local Integer iRetVal
35446>>>        Move (DFOleUninit()) to iRetVal
35447>>>        Forward Send Destroy_Object
35449>>>    End_Procedure
35450>>>
35450>>>    Procedure OCXInit
35451>>>        Move (RegisterWindowMessage("WM_DFOCXEVENT")) to WM_DFOCXEVENT
35452>>>        Move (RegisterWindowMessage("WM_DFOCXNOTIFYEVENT")) to WM_DFOCXNOTIFYEVENT
35453>>>    End_Procedure
35454>>>
35454>>>    Function GetType  OLEVariant var Returns DWORD
35455>>>        Local DWORD varVt
35456>>>        GetBuff from var at Variant.vt to varVt
35457>>>        Function_Return varVt
35458>>>    End_Function
35459>>>
35459>>>    Function GetShort OLEVariant var Returns Integer
35460>>>        Local Integer iVal
35461>>>        GetBuff from var at Variant.iVal to iVal
35462>>>        Function_Return iVal
35463>>>    End_Function
35464>>>
35464>>>    Function GetInteger OLEVariant var Returns Integer
35465>>>        Local Integer lVal
35466>>>        GetBuff from var at Variant.lVal to lVal
35467>>>        Function_Return lVal
35468>>>    End_Function
35469>>>
35469>>>    Function GetFloat OLEVariant var Returns OLEReal
35470>>>        Local OLEReal fltVal
35471>>>        GetBuff_String from var at Variant.fltVal to fltVal
35472>>>        Function_Return fltVal
35473>>>    End_Function
35474>>>
35474>>>    Function GetDouble OLEVariant var Returns OLEReal
35475>>>        Local OLEReal dblVal
35476>>>        GetBuff_String from var at Variant.dblVal to dblVal
35477>>>        Function_Return dblVal
35478>>>    End_Function
35479>>>
35479>>>    Function GetCurrency OLEVariant var Returns Number
35480>>>        Local Number cyVal
35481>>>        GetBuff_String from var at Variant.cyVal to cyVal
35482>>>        Function_Return cyVal
35483>>>    End_Function
35484>>>
35484>>>    Function GetDate OLEVariant var Returns Date
35485>>>        Local Date dtVal
35486>>>        GetBuff from var at Variant.dtVal to dtVal
35487>>>        Function_Return dtVal
35488>>>    End_Function
35489>>>
35489>>>    Function GetString OLEVariant var Returns String
35490>>>        Local String strVal
35491>>>        GetBuff_String from var at Variant.strVal to strVal
35492>>>        Function_Return strVal
35493>>>    End_Function
35494>>>
35494>>>    Function GetLPDispatch OLEVariant var Returns LPDispatch
35495>>>        Local LPDispatch dspVal
35496>>>        GetBuff from var at Variant.dspVal to dspVal
35497>>>        Function_Return dspVal
35498>>>    End_Function
35499>>>
35499>>>    Function GetOLEError OLEVariant var Returns OLEError
35500>>>        Local OLEError errVal
35501>>>        GetBuff from var at Variant.errVal to errVal
35502>>>        Function_Return errVal
35503>>>    End_Function
35504>>>
35504>>>    Function GetBool OLEVariant var Returns Bool
35505>>>        Local Bool blVal
35506>>>        GetBuff from var at Variant.blVal to blVal
35507>>>        Function_Return blVal
35508>>>    End_Function
35509>>>
35509>>>    Function GetLPIUnknown OLEVariant var Returns LPIUnknown
35510>>>        Local LPIUnknown uknVal
35511>>>        GetBuff from var at Variant.uknVal to uknVal
35512>>>        Function_Return uknVal
35513>>>    End_Function
35514>>>
35514>>>    Function GetUChar OLEVariant var Returns UChar
35515>>>        Local UChar ui1Val
35516>>>        GetBuff from var at Variant.ui1Val to ui1Val
35517>>>        Function_Return ui1Val
35518>>>    End_Function
35519>>>
35519>>>    Function GetValue OLEVariant var Returns String
35520>>>        Local DWORD vt
35521>>>        Local String retVal
35521>>>        Get GetType var to vt
35522>>>             If vt Eq OLE_VT_I2        Get GetShort var to retVal
35525>>>        Else If vt Eq OLE_VT_I4        Get GetInteger var to retVal
35529>>>        Else If vt Eq OLE_VT_R4        Get GetFloat var to retVal
35533>>>        Else If vt Eq OLE_VT_R8        Get GetDouble var to retVal
35537>>>        Else If vt Eq OLE_VT_CY        Get GetCurrency var to retVal
35541>>>        Else If vt Eq OLE_VT_DATE      Get GetDate var to retVal
35545>>>        Else If vt Eq OLE_VT_BSTR      Get GetString var to retVal
35549>>>        Else If vt Eq OLE_VT_DISPATCH  Get GetLPDispatch var to retVal
35553>>>        Else If vt Eq OLE_VT_ERROR     Get GetOLEError var to retVal
35557>>>        Else If vt Eq OLE_VT_BOOL      Get GetBool var to retVal
35561>>>        Else If vt Eq OLE_VT_UNKNOWN   Get GetLPIUnknown var to retVal
35565>>>        Else If vt Eq OLE_VT_UI1       Get GetUChar var to retVal
35569>>>        Function_Return retVal
35570>>>    End_Function
35571>>>
35571>>>    Function PutValue DWORD vt String val Returns OLEVariant
35572>>>        Inst_OLEVariant var
35574>>>        Put vt to var at Variant.vt
35575>>>             If vt Eq OLE_VT_I2        Put (Integer(val)) to var at Variant.iVal
35578>>>        Else If vt Eq OLE_VT_I4        Put (Integer(val)) to var at Variant.lVal
35582>>>        Else If vt Eq OLE_VT_R4        Put_String val to var at Variant.fltVal
35586>>>        Else If vt Eq OLE_VT_R8        Put_String val to var at Variant.dblVal
35590>>>        Else If vt Eq OLE_VT_CY        Put_String val to var at Variant.cyVal
35594>>>        Else If vt Eq OLE_VT_DATE      Put (Date(val)) to var at Variant.dtVal
35598>>>        Else If vt Eq OLE_VT_BSTR      Put_String val to var at Variant.strVal
35602>>>        Else If vt Eq OLE_VT_DISPATCH  Put (LPDispatch(val)) to var at Variant.dspVal
35606>>>        Else If vt Eq OLE_VT_ERROR     Put (OLEError(val)) to var at Variant.errVal
35610>>>        Else If vt Eq OLE_VT_BOOL      Put (Bool(val)) to var at Variant.blVal
35614>>>        Else If vt Eq OLE_VT_UNKNOWN   Put (LPIUnknown(val)) to var at Variant.uknVal
35618>>>        Else If vt Eq OLE_VT_UI1       Put (UChar(val)) to var at Variant.ui1Val
35622>>>        Else begin
35623>>>            Put OLE_VT_ERROR to var at Variant.vt
35624>>>            Put DISP_E_PARAMNOTFOUND to var at Variant.errVal
35625>>>        End
35625>>>>
35625>>>        Function_Return var
35626>>>    End_Function
35627>>>
35627>>>End_Class
35628>>>
35628>>>// The one and only cOLEVariant helper object
35628>>>Object oOLEVariant is a cOLEVariant
35630>>>        Move Current_Object to oOLEVariantId
35631>>>End_Object
35632>>>
35632>>>//Command so we get nicer code for the events, only used internally
35632>>>
35632>>>// Command to extract the value of an OLEVariant no matter what datatype its currently holding
35632>>>
35632>>>// Command to both set the datatype and value to an OLEVariant
35632>>>
35632>>>
35632>>>// The OLE Base class, all OLE classes are derived from this class
35632>>>// Defines basic functionality and conversation with DLL interface
35632>>>
35632>>>Class cCOM_IDispatch is a Message
35633>>>
35633>>>    Procedure DefineCOM_IDispatch
35634>>>        Property String  progIdStr Public ""
35635>>>        Property Integer ClientId Public 0
35636>>>        Property Integer AutoAddRef Public 0
35637>>>    End_Procedure
35638>>>
35638>>>// GetProperty functions
35638>>>    Function GetIntegerProperty DWORD dwDispId returns Integer
35639>>>        Local Integer lpropVal iClientId
35640>>>        Get clientId to iClientId
35641>>>        Move (GetAutoClientIntegerProperty (iClientId,dwDispId)) to lpropVal
35642>>>        Function_Return lpropVal
35643>>>    End_Function
35644>>>
35644>>>    Function GetShortProperty DWORD dwDispId returns Integer
35645>>>        Local Integer lpropVal iClientId
35646>>>        Get clientId to iClientId
35647>>>        Move (GetAutoClientShortProperty (iClientId,dwDispId)) to lpropVal
35648>>>        Function_Return lpropVal
35649>>>    End_Function
35650>>>
35650>>>    Function GetBoolProperty DWORD dwDispId returns BOOL
35651>>>        Local BOOL lpropVal
35652>>>        Local Integer iClientId
35652>>>        Get clientId to iClientId
35653>>>        Move (GetAutoClientBoolProperty (iClientId,dwDispId)) to lpropVal
35654>>>        Function_Return lpropVal
35655>>>    End_Function
35656>>>
35656>>>    Function GetCurrencyProperty DWORD dwDispId returns Number
35657>>>        Local Number lpropVal
35658>>>        Local String lsProp
35658>>>        Local Integer iClientId iRetVal
35658>>>        Local Pointer llpsprop
35658>>>        Get clientId to iClientId
35659>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35660>>>        GetAddress of lsprop to llpsprop
35661>>>        Move (GetAutoClientCurrencyProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35662>>>        Move lsProp to lpropVal
35663>>>        Function_Return lpropVal
35664>>>    End_Function
35665>>>
35665>>>    Function GetDateProperty DWORD dwDispId returns Date
35666>>>        Local Date lpropVal
35667>>>        Local Integer iClientId
35667>>>        Get clientId to iClientId
35668>>>        Move (GetAutoClientDateProperty (iClientId,dwDispId)) to lpropVal
35669>>>        Function_Return lpropVal
35670>>>    End_Function
35671>>>
35671>>>    Function GetLPDispatchProperty DWORD dwDispId returns Date
35672>>>        Local LPDispatch lpropVal
35673>>>        Local Integer iClientId
35673>>>        Get clientId to iClientId
35674>>>        Move (GetAutoClientLPDispatchProperty (iClientId,dwDispId)) to lpropVal
35675>>>        Function_Return lpropVal
35676>>>    End_Function
35677>>>
35677>>>    Function GetRealProperty DWORD dwDispId returns OLEReal
35678>>>        Local OLEReal lpropVal
35679>>>        Local Integer iClientId iRetVal
35679>>>        Local String lsProp
35679>>>        Local Pointer llpsprop
35679>>>        Get clientId to iClientId
35680>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35681>>>        GetAddress of lsprop to llpsprop
35682>>>        Move (GetAutoClientRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35683>>>        Move lsProp to lpropVal
35684>>>        Function_Return lpropVal
35685>>>    End_Function
35686>>>
35686>>>    Function GetShortRealProperty DWORD dwDispId returns OLEReal
35687>>>        Local OLEReal lpropVal
35688>>>        Local Integer iClientId iRetVal
35688>>>        Local String lsProp
35688>>>        Local Pointer llpsprop
35688>>>        Get clientId to iClientId
35689>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lsProp
35690>>>        GetAddress of lsprop to llpsprop
35691>>>        Move (GetAutoClientShortRealProperty (iClientId,dwDispId,llpsprop)) to iRetVal
35692>>>        Move lsProp to lpropVal
35693>>>        Function_Return lpropVal
35694>>>    End_Function
35695>>>
35695>>>    Function GetStringProperty DWORD dwDispId returns String
35696>>>        Local String lpropVal
35697>>>        Local Integer iClientId iRetVal
35697>>>        Local Pointer llppropVal
35697>>>        Get clientId to iClientId
35698>>>        Move (Repeat(Character(0),OLESTR_MAX)) to lpropVal
35699>>>        GetAddress of lpropVal to llppropval
35700>>>        Move (GetAutoClientStringProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35701>>>        Function_Return (CString(lpropVal))
35702>>>    End_Function
35703>>>
35703>>>    Function GetOLEVariantProperty DWORD dwDispId returns OLEVariant
35704>>>        Local OLEVariant lpropVal
35705>>>        Local Integer iClientId iRetVal
35705>>>        Local Pointer llppropVal
35705>>>        Get clientId to iClientId
35706>>>        ZeroType TP_OLEVariant to lpropVal
35707>>>        GetAddress of lpropVal to llppropval
35708>>>        Move (GetAutoClientOLEVariantProperty (iClientId,dwDispId,llppropVal)) to iRetVal
35709>>>        Function_Return lpropVal
35710>>>    End_Function
35711>>>
35711>>>// SetProperty procedures
35711>>>    Procedure SetIntegerProperty DWORD dwDispId Integer lpropVal
35712>>>        Local Integer iClientId iRetVal
35713>>>        Get ClientId to iClientId
35714>>>        Move (SetAutoClientIntegerProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35715>>>    End_Procedure
35716>>>
35716>>>    Procedure SetShortProperty DWORD dwDispId Integer lpropVal
35717>>>        Local Integer iClientId iRetVal
35718>>>        Get ClientId to iClientId
35719>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35720>>>    End_Procedure
35721>>>
35721>>>    Procedure SetBoolProperty DWORD dwDispId BOOL lpropVal
35722>>>        Local Integer iClientId iRetVal
35723>>>        Get ClientId to iClientId
35724>>>        Move (SetAutoClientShortProperty (iClientId,dwDispId,lpropVal)) to iRetVal
35725>>>    End_Procedure
35726>>>
35726>>>    Procedure SetCurrencyProperty DWORD dwDispId Number lpropVal
35727>>>        Local Integer iClientId iRetVal
35728>>>        Local String lsprop
35728>>>        Get ClientId to iClientId
35729>>>        Move lpropVal to lsprop
35730>>>        Move (SetAutoClientCurrencyProperty(iClientId,dwDispId,lsprop)) to iRetVal
35731>>>    End_Procedure
35732>>>
35732>>>    Procedure SetDateProperty DWORD dwDispId Date lpropVal
35733>>>        Local Integer iClientId iRetVal
35734>>>        Get ClientId to iClientId
35735>>>        Move (SetAutoClientDateProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35736>>>    End_Procedure
35737>>>
35737>>>    Procedure SetLPDispatchProperty DWORD dwDispId LPDispatch lpropVal
35738>>>        Local Integer iClientId iRetVal
35739>>>        Get ClientId to iClientId
35740>>>        Move (SetAutoClientLPDispatchProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35741>>>    End_Procedure
35742>>>
35742>>>    Procedure SetRealProperty DWORD dwDispId OLEReal lpropVal
35743>>>        Local Integer iClientId iRetVal
35744>>>        Local String lsprop
35744>>>        Get ClientId to iClientId
35745>>>        Move lpropVal to lsprop
35746>>>        Move (SetAutoClientRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
35747>>>    End_Procedure
35748>>>
35748>>>    Procedure SetShortRealProperty DWORD dwDispId OLEReal lpropVal
35749>>>        Local Integer iClientId iRetVal
35750>>>        Local String lsprop
35750>>>        Get ClientId to iClientId
35751>>>        Move lpropVal to lsprop
35752>>>        Move (SetAutoClientShortRealProperty(iClientId,dwDispId,lsprop)) to iRetVal
35753>>>    End_Procedure
35754>>>
35754>>>    Procedure SetStringProperty DWORD dwDispId String lpropVal
35755>>>        Local Integer iClientId iRetVal
35756>>>        Get ClientId to iClientId
35757>>>        Move (SetAutoClientStringProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35758>>>    End_Procedure
35759>>>
35759>>>    Procedure SetOLEVariantProperty DWORD dwDispId OLEVariant lpropVal
35760>>>        Local Integer iClientId iRetVal
35761>>>        Get ClientId to iClientId
35762>>>        If (Length(lpropval)) Lt TP_OLEVariant_Size;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to lpropVal
35765>>>        Move (SetAutoClientOLEVariantProperty(iClientId,dwDispId,lpropVal)) to iRetVal
35766>>>    End_Procedure
35767>>>
35767>>>// Pre-Invoke functions
35767>>>    Procedure DeclareParams Integer nrOfParams
35768>>>        Local Integer iClientId iRetVal
35769>>>        Get ClientId to iCLientId
35770>>>        Move (DeclareAutoClientInvokeParams(iClientId,nrOfParams)) to iRetVal
35771>>>    End_Procedure
35772>>>
35772>>>    Procedure DefineIntegerParam Integer param
35773>>>        Local Integer iClientId iRetVal
35774>>>        Get ClientId to iClientId
35775>>>        Move (DefineAutoClientIntegerParam(iClientId,param)) to iRetVal
35776>>>    End_Procedure
35777>>>
35777>>>    Procedure DefineShortParam Integer param
35778>>>        Local Integer iClientId iRetVal
35779>>>        Get ClientId to iClientId
35780>>>        Move (DefineAutoClientShortParam(iClientId,param)) to iRetVal
35781>>>    End_Procedure
35782>>>
35782>>>    Procedure DefineBoolParam BOOL param
35783>>>        Local Integer iClientId iRetVal
35784>>>        Get ClientId to iClientId
35785>>>        Move (DefineAutoClientBoolParam(iClientId,param)) to iRetVal
35786>>>    End_Procedure
35787>>>
35787>>>    Procedure DefineCurrencyParam Number param
35788>>>        Local Integer iClientId iRetVal
35789>>>        Local String lsparam
35789>>>        Get ClientId to iClientId
35790>>>        Move param to lsparam
35791>>>        Move (DefineAutoClientCurrencyParam(iClientId,lsparam)) to iRetVal
35792>>>    End_Procedure
35793>>>
35793>>>    Procedure DefineDateParam Date param
35794>>>        Local Integer iClientId iRetVal
35795>>>        Get ClientId to iClientId
35796>>>        Move (DefineAutoClientDateParam(iClientId,param)) to iRetVal
35797>>>    End_Procedure
35798>>>
35798>>>    Procedure DefineLPDispatchParam LPDispatch param
35799>>>        Local Integer iClientId iRetVal
35800>>>        Get ClientId to iClientId
35801>>>        Move (DefineAutoClientLPDispatchParam(iClientId,param)) to iRetVal
35802>>>    End_Procedure
35803>>>
35803>>>    Procedure DefineRealParam OLEReal param
35804>>>        Local Integer iClientId iRetVal
35805>>>        Local String lsparam
35805>>>        Get ClientId to iClientId
35806>>>        Move param to lsparam
35807>>>        Move (DefineAutoClientRealParam(iClientId,lsparam)) to iRetVal
35808>>>    End_Procedure
35809>>>
35809>>>    Procedure DefineShortRealParam OLEReal param
35810>>>        Local Integer iClientId iRetVal
35811>>>        Local String lsparam
35811>>>        Get ClientId to iClientId
35812>>>        Move param to lsparam
35813>>>        Move (DefineAutoClientShortRealParam(iClientId,lsparam)) to iRetVal
35814>>>    End_Procedure
35815>>>
35815>>>    Procedure DefineStringParam String param
35816>>>        Local Integer iClientId iRetVal
35817>>>        Get ClientId to iClientId
35818>>>        Append param OLENull
35819>>>        Move (DefineAutoClientStringParam(iClientId,param)) to iRetVal
35820>>>    End_Procedure
35821>>>
35821>>>    Procedure DefineOLEVariantParam OLEVariant param
35822>>>        Local Integer iClientId iRetVal
35823>>>        Get ClientId to iClientId
35824>>>        If (Length(param)) Lt TP_OLEVariant_Size ;            Get PutValue of oOLEVariantId OLE_VT_ERROR DISP_E_PARAMNOTFOUND to param
35827>>>        Move (DefineAutoClientOLEVariantParam(iClientId,param)) to iRetVal
35828>>>    End_Procedure
35829>>>
35829>>>// Invoke functions
35829>>>    Procedure InvokeVoidFunction DWORD dwDispId
35830>>>        Local Integer iClientId iRetVal
35831>>>        Get ClientId to iClientId
35832>>>        Move (InvokeAutoClientVoidFunction(iClientId,dwDispId)) to iRetVal
35833>>>    End_Procedure
35834>>>
35834>>>    Function InvokeIntegerFunction DWORD dwDispId returns Integer
35835>>>        Local Integer iClientId iRetVal
35836>>>        Get ClientId to iClientId
35837>>>        Move (InvokeAutoClientIntegerFunction(iClientId,dwDispId)) to iRetVal
35838>>>        Function_Return iRetVal
35839>>>    End_Function
35840>>>
35840>>>    Function InvokeShortFunction DWORD dwDispId returns Integer
35841>>>        Local Integer iClientId iRetVal
35842>>>        Get ClientId to iClientId
35843>>>        Move (InvokeAutoClientShortFunction(iClientId,dwDispId)) to iRetVal
35844>>>        Function_Return iRetVal
35845>>>    End_Function
35846>>>
35846>>>    Function InvokeBoolFunction DWORD dwDispId returns BOOL
35847>>>        Local Integer iClientId iRetVal
35848>>>        Get ClientId to iClientId
35849>>>        Move (InvokeAutoClientBoolFunction(iClientId,dwDispId)) to iRetVal
35850>>>        Function_Return iRetVal
35851>>>    End_Function
35852>>>
35852>>>    Function InvokeCurrencyFunction DWORD dwDispId returns Number
35853>>>        Local Integer iClientId iRetVal
35854>>>        Local Number nRetVal
35854>>>        Local String sRetVal
35854>>>        Local Pointer psRetVal
35854>>>        Get ClientId to iClientId
35855>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35856>>>        GetAddress of sRetVal to psRetVal
35857>>>        Move (InvokeAutoClientCurrencyFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35858>>>        Move sRetVal to nRetVal
35859>>>        Function_Return nRetVal
35860>>>    End_Function
35861>>>
35861>>>    Function InvokeDateFunction DWORD dwDispId returns Date
35862>>>        Local Integer iClientId
35863>>>        Local Date dRetVal
35863>>>        Get ClientId to iClientId
35864>>>        Move (InvokeAutoClientDateFunction(iClientId,dwDispId)) to dRetVal
35865>>>        Function_Return dRetVal
35866>>>    End_Function
35867>>>
35867>>>    Function InvokeLPDispatchFunction DWORD dwDispId returns LPDispatch
35868>>>        Local Integer iClientId
35869>>>        Local LPDispatch lpdRetVal
35869>>>        Get ClientId to iClientId
35870>>>        Move (InvokeAutoClientLPDispatchFunction(iClientId,dwDispId)) to lpdRetVal
35871>>>        Function_Return lpdRetVal
35872>>>    End_Function
35873>>>
35873>>>    Function InvokeRealFunction DWORD dwDispId returns OLEReal
35874>>>        Local Integer iClientId iRetVal
35875>>>        Local OLEReal rRetVal
35875>>>        Local String sRetVal
35875>>>        Local Pointer psRetVal
35875>>>        Get ClientId to iClientId
35876>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35877>>>        GetAddress of sRetVal to psRetVal
35878>>>        Move (InvokeAutoClientRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35879>>>        Move sRetVal to rRetVal
35880>>>        Function_Return rRetVal
35881>>>    End_Function
35882>>>
35882>>>    Function InvokeShortRealFunction DWORD dwDispId returns OLEReal
35883>>>        Local Integer iClientId iRetVal
35884>>>        Local OLEReal rRetVal
35884>>>        Local String sRetVal
35884>>>        Local Pointer psRetVal
35884>>>        Get ClientId to iClientId
35885>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35886>>>        GetAddress of sRetVal to psRetVal
35887>>>        Move (InvokeAutoClientShortRealFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35888>>>        Move sRetVal to rRetVal
35889>>>        Function_Return rRetVal
35890>>>    End_Function
35891>>>
35891>>>    Function InvokeStringFunction DWORD dwDispId returns String
35892>>>        Local Integer iClientId iRetVal
35893>>>        Local String sRetVal
35893>>>        Local Pointer psRetVal
35893>>>        Get ClientId to iClientId
35894>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35895>>>        GetAddress of sRetVal to psRetVal
35896>>>        Move (InvokeAutoClientStringFunction(iClientId,dwDispId,psRetVal)) to iRetVal
35897>>>        Function_Return (CString(sRetVal))
35898>>>    End_Function
35899>>>
35899>>>    Function InvokeOleVariantFunction DWORD dwDispId returns OLEVariant
35900>>>        Local Integer iClientId iRetVal
35901>>>        Local OLEVariant vRetVal
35901>>>        Local Pointer pvRetVal
35901>>>        Get ClientId to iClientId
35902>>>        ZeroType TP_OLEVariant to vRetVal
35903>>>        GetAddress of vRetVal to pvRetVal
35904>>>        Move (InvokeAutoClientOLEVariantFunction(iClientId,dwDispId,pvRetVal)) to iRetVal
35905>>>        Function_Return vRetVal
35906>>>    End_Function
35907>>>
35907>>>
35907>>>// Event parameter functions, might be moved to cOCX_Client_Mixin or similar
35907>>>    Function GetEventIntegerParam DWORD lParam DWORD iPara returns Integer
35908>>>        Local Integer iRetVal
35909>>>        Move (GetOCXEventIntegerParam(lParam,iPara)) to iRetVal
35910>>>        Function_Return iRetVal
35911>>>    End_Function
35912>>>
35912>>>    Function GetEventShortParam DWORD lParam DWORD iPara returns Integer
35913>>>        Local Integer iRetVal
35914>>>        Move (GetOCXEventShortParam(lParam,iPara)) to iRetVal
35915>>>        Function_Return iRetVal
35916>>>    End_Function
35917>>>
35917>>>    Function GetEventBoolParam DWORD lParam DWORD iPara returns Bool
35918>>>        Local Bool iRetVal
35919>>>        Move (GetOCXEventBoolParam(lParam,iPara)) to iRetVal
35920>>>        Function_Return iRetVal
35921>>>    End_Function
35922>>>
35922>>>    Function GetEventCurrencyParam DWORD lParam DWORD iPara returns Currency
35923>>>        Local Integer iretVal
35924>>>        Local Currency cRetVal
35924>>>        Local String destStr
35924>>>        Local Pointer pdestStr
35924>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35925>>>        GetAddress of destStr to pdestStr
35926>>>        Move (GetOCXEventCurrencyParam(lParam,iPara,pdestStr)) to iRetVal
35927>>>        Move (CString(destStr)) to cRetVal
35928>>>        Function_Return cRetVal
35929>>>    End_Function
35930>>>
35930>>>    Function GetEventDateParam DWORD lParam DWORD iPara returns Date
35931>>>        Local Date dRetVal
35932>>>        Move (GetOCXEventDateParam(lParam,iPara)) to dRetVal
35933>>>        Function_Return dRetVal
35934>>>    End_Function
35935>>>
35935>>>    Function GetEventLPDispatchParam DWORD lParam DWORD iPara returns LPDispatch
35936>>>        Local LPDispatch lpRetVal
35937>>>        Get GetEventIntegerParam lParam iPara to lpRetVal
35938>>>        Function_Return lpRetVal
35939>>>    End_Function
35940>>>
35940>>>    Function GetEventRealParam DWORD lParam DWORD iPara returns OLEReal
35941>>>        Local Integer iretVal
35942>>>        Local OLEReal rRetVal
35942>>>        Local String destStr
35942>>>        Local Pointer pdestStr
35942>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35943>>>        GetAddress of destStr to pdestStr
35944>>>        Move (GetOCXEventRealParam(lParam,iPara,pdestStr)) to iRetVal
35945>>>        Move (CString(destStr)) to rRetVal
35946>>>        Function_Return rRetVal
35947>>>    End_Function
35948>>>
35948>>>    Function GetEventShortRealParam DWORD lParam DWORD iPara returns ShortReal
35949>>>        Local Integer iretVal
35950>>>        Local ShortReal rRetVal
35950>>>        Local String destStr
35950>>>        Local Pointer pdestStr
35950>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
35951>>>        GetAddress of destStr to pdestStr
35952>>>        Move (GetOCXEventShortRealParam(lParam,iPara,pdestStr)) to iRetVal
35953>>>        Move (CString(destStr)) to rRetVal
35954>>>        Function_Return rRetVal
35955>>>    End_Function
35956>>>
35956>>>    Function GetEventStringParam DWORD lParam DWORD iPara returns String
35957>>>        Local Integer iretVal
35958>>>        Local String sRetVal
35958>>>        Local Pointer psRetVal
35958>>>        Move (Repeat(Character(0),OLESTR_MAX)) to sRetVal
35959>>>        GetAddress of sRetVal to psRetVal
35960>>>        Move (GetOCXEventStringParam(lParam,iPara,psRetVal)) to iRetVal
35961>>>        Function_Return (CString(sRetVal))
35962>>>    End_Function
35963>>>
35963>>>    Function GetEventOLEVariantParam DWORD lParam DWORD iPara returns OLEVariant
35964>>>        Local Integer iretVal
35965>>>        Inst_OLEVariant vRetVal
35966>>>        Local Pointer pvRetVal
35966>>>        GetAddress of vRetVal to pvRetVal
35967>>>        Move (GetOCXEventOLEVariantParam(lParam,iPara,pvRetVal)) to iRetVal
35968>>>        Function_Return vRetVal
35969>>>    End_Function
35970>>>
35970>>>End_Class
35971>>>
35971>>>
35971>>>// The OLE Automation base class,
35971>>>// which all automation classes are derived from
35971>>>
35971>>>Class Automation_Client is a cCOM_IDispatch
35972>>>    Procedure Construct_Object
35973>>>        Forward Send Construct_Object
35975>>>        Send DefineCOM_IDispatch
35976>>>        Local Integer iClientId
35977>>>        Move (CreateAutomationClient()) To iClientId
35978>>>        If iClientId Eq 0 Begin
35980>>>            Set ClientId to 0
35981>>>            Error 1002 DFOLEError1002
35982>>>>
35982>>>        End
35982>>>>
35982>>>        Else Set ClientId To iClientId
35984>>>        End_Procedure
35985>>>
35985>>>    Procedure Destroy_Object
35986>>>        Local Integer iRetVal iClientId
35987>>>        Get ClientId to iClientId
35988>>>        Move (DestroyAutomationClient(iClientId)) to iRetVal
35989>>>        Forward Send Destroy_Object
35991>>>    End_Procedure
35992>>>
35992>>>    Procedure CreateDispatch
35993>>>                Local Integer iRetVal
35994>>>                Local Integer iClientId
35994>>>        Local String sCLSID
35994>>>        Get progIdStr to sCLSID
35995>>>        Append sCLSID OLENull
35996>>>
35996>>>                Get clientId to iClientId
35997>>>        Move (CreateAutoClientDispatch (iClientId,sCLSID)) To iRetVal
35998>>>                If iRetVal Eq 0 Begin
36000>>>            Error 1000 DFOLEError1000
36001>>>>
36001>>>                End
36001>>>>
36001>>>        End_Procedure
36002>>>
36002>>>        Procedure AttachDispatch LPDispatch pdisp
36003>>>                Local Integer iRetVal
36004>>>                Local Integer iClientId
36004>>>                Local Integer bAutoAddRef
36004>>>                Get clientId to iClientId
36005>>>                Get AutoAddRef to bAutoAddRef
36006>>>                Move (AttachAutoClientDispatch (iClientId,pdisp,bAutoAddRef)) To iRetVal
36007>>>                If iRetVal Eq 0 Begin
36009>>>                Error 1001 DFOLEError1001
36010>>>>
36010>>>                End
36010>>>>
36010>>>    End_Procedure
36011>>>
36011>>>    Function AttachActiveObject Returns Bool
36012>>>                Local Bool bRetVal
36013>>>                Local Integer iClientId
36013>>>                Local String sCLSID
36013>>>                Get progIdStr to sCLSID
36014>>>                Append sCLSID OLENull
36015>>>                Get clientId to iClientId
36016>>>                Move (AttachAutoClientActiveObject (iClientId,sCLSID)) To bRetVal
36017>>>                Function_Return bRetVal
36018>>>    End_Function
36019>>>
36019>>>    Procedure ReleaseDispatch
36020>>>        Local Integer iRetVal
36021>>>        Local Integer iClientId
36021>>>        Get clientId to iClientId
36022>>>        Move (ReleaseAutoClientDispatch (iClientId)) to iRetVal
36023>>>    End_Procedure
36024>>>
36024>>>    Function GetDispatch returns LPDispatch
36025>>>        Local LPDispatch retVal
36026>>>        Local Integer iClientId
36026>>>        Get clientId to iClientId
36027>>>        Move (GetAutoClientDispatch(iClientId)) to retVal
36028>>>        Function_Return retVal
36029>>>    End_Function
36030>>>
36030>>>End_Class
36031>>>
36031>>>
36031>>>//     cCom_IDispatch  External_Class_Mixin
36031>>>//                 |       |    
36031>>>//                 |       cOCXNavigation_Mixin
36031>>>//                 |         |    
36031>>>//               cOCX_Client_Mixin
36031>>>//                        |    |
36031>>>//                        |    |
36031>>>// Form_External_Control  |    |   dbForm_External_Control
36031>>>//                 |      |    |        |  
36031>>>//                OCX_Client   dbOCX_Client
36031>>>
36031>>>
36031>>>
36031>>>// The focus navigation mixin class for ActiveX controls
36031>>>Class cOCX_Navigation_Class_Mixin is a Mixin 
36032>>>    Import_Class_Protocol External_Class_Mixin
36033>>>    Register_Procedure WMDF_DFOCXNotifyEvent
36033>>>
36033>>>    Procedure WMDF_DFOCXNotifyEvent Integer wParam Integer lParam
36034>>>        ON_EVENT WM_DFOCX_FOCUSCHANGE Fire OCXFocusChange
36037>>>    End_Procedure
36038>>>
36038>>>    Procedure OCXFocusChange Integer lParam
36039>>>        If (lParam);            Send External_SetFocus
36042>>>        Else;            Send External_KillFocus
36044>>>    End_Procedure
36045>>>
36045>>>    //Provided just to cancel the External_Class_Mixin implementation
36045>>>    //It actually gets cancelled in the cOCX_Clint_Mixin, but hey!?
36045>>>    Procedure Page_Object Integer state
36046>>>        Forward Send Page_Object state        
36048>>>    End_Procedure
36049>>>
36049>>>    Procedure Enable_Window integer iState
36050>>>      // Here we switch iState again, for backwards compatibility
36050>>>      Set OcxShadow_State to (Not(iState))
36051>>>    End_procedure
36052>>>
36052>>>End_Class
36053>>>
36053>>>
36053>>>//The standard OCX class mixin, it is the 
36053>>>// OCX base class which all OLE Controls are derived from (read mixin'd)
36053>>>Class cOCX_Client_Mixin is a Mixin
36054>>>
36054>>>    Import_Class_Protocol cCOM_IDispatch
36055>>>    Import_Class_Protocol cOCX_Navigation_Class_Mixin
36056>>>    Register_Procedure WMDF_DFOCXEVENT Integer wParam Integer lParam
36056>>>
36056>>>    Procedure DefineOCX_Client
36057>>>        Send DefineCOM_IDispatch
36058>>>        Local Integer iClientId
36059>>>        Property integer Private.OCXShadowState Public 0
36060>>>        Property String  Private.OCXCaption Public ""
36061>>>        Property String  OCXLicense Public ""
36062>>>        Property String  OCXPropFile Public ""
36063>>>        Move (CreateOCXClient()) to iclientId
36064>>>                Set ClientId to iClientId
36065>>>        Send Use_Parent_Color
36066>>>    End_Procedure
36067>>>
36067>>>    Function OCXShadow_State Returns Integer
36068>>>        Local Integer bEnabled
36069>>>        Get Private.OCXShadowState to bEnabled
36070>>>        Function_Return bEnabled
36071>>>    End_Function
36072>>>
36072>>>    Procedure Set OCXShadow_State Integer bEnable
36073>>>        Local integer hWnd iSuccess iCLientId
36074>>>        Set Private.OCXShadowState to bEnable
36075>>>        Get clientId to iClientId
36076>>>        If bEnable;            Move (false) to bEnable
36079>>>        else;            Move (true) to bEnable
36081>>>        Get Window_Handle to hWnd
36082>>>        If hWnd;            Move (EnableOCXControl(iClientId,bEnable)) To iSuccess
36085>>>    End_Procedure
36086>>>
36086>>>    Procedure SetOCXCaption String sCaption
36087>>>        Local Integer iClientId iRetVal
36088>>>        Get ClientId to iClientId
36089>>>        Append sCaption OLENull
36090>>>        Move (SetOCXControlCaption(iClientId,sCaption)) to iRetVal
36091>>>        If (Not(iRetVal));            Error 1004 DFOLEError1004
36094>>>        Else;            Set Private.OCXCaption to sCaption
36096>>>    End_Procedure
36097>>>
36097>>>    Function GetOCXCaption Returns String
36098>>>        Local Integer iClientId iRetVal
36099>>>        Local String destStr
36099>>>        Local Pointer lpDestStr
36099>>>        Move (Repeat(Character(0),OLESTR_MAX)) to destStr
36100>>>        GetAddress of destStr to lpDestStr
36101>>>        Move (GetOCXControlCaption(iClientId,lpDestStr)) to iRetVal
36102>>>        If (not(iRetVal));            Error 1004 DFOLEError1004
36105>>>        Set Private.OCXCaption to (CString(destStr))
36106>>>        Function_Return (Private.OCXCaption(Current_Object))
36107>>>    End_Function
36108>>>
36108>>>    Procedure SET OCXCaption String sCaption
36109>>>        If (Window_Handle(Current_Object));            Send SetOCXCaption sCaption
36112>>>        Else;            Set Private.OCXCaption to sCaption
36114>>>    End_Procedure
36115>>>
36115>>>    Function OCXCaption Returns String
36116>>>        If (Window_Handle(Current_Object));            Function_Return (GetOCXCaption(Current_Object))
36119>>>        Else;            Function_Return (Private.OCXCaption(Current_Object))
36121>>>    End_Procedure
36122>>>
36122>>>    // To avoid flickering during resize operations
36122>>>    Procedure Use_Parent_Color
36123>>>        Local Integer Clr Txtclr Backclr
36124>>>        Delegate Get Object_Color To Clr
36126>>>        Move (Hi(Clr)) To Txtclr
36127>>>        Move (Low(Clr)) To Backclr
36128>>>        Set Object_Color To Txtclr Backclr
36129>>>    End_Procedure
36130>>>
36130>>>    Procedure Page_Object integer iState
36131>>>        Forward Send Page_Object iState
36133>>>        If iState Eq (True) Send LoadOCX
36136>>>    End_Procedure
36137>>>
36137>>>    Procedure Remove_Object
36138>>>        Send UnloadOCX
36139>>>        Forward send Remove_Object
36141>>>    End_Procedure
36142>>>
36142>>>    Procedure LoadOCX
36143>>>        Local Pointer HWnd
36144>>>        Local Integer iCLientId iRetVal iVisible iShadow dwSty
36144>>>        Local String sPrgId lic sCap sPropFile
36144>>>        Send PreCreateOCX
36145>>>        Get ClientId to iClientId
36146>>>        Get Window_Handle to hwnd
36147>>>        Get progIdStr to sPrgId
36148>>>        Append sPrgId OLENull
36149>>>        Get Private.OCXCaption To sCap
36150>>>        Append sCap OLENull
36151>>>        Get OCXLicense To Lic
36152>>>        Append Lic OLENull
36153>>>        Get OCXPropFile To sPropFile
36154>>>        Append sPropfile OLENull
36155>>>        Get Visible_State to iVisible
36156>>>        If (iVisible) Move WS_VISIBLE to dwSty
36159>>>        Else Move 0 to dwSty
36161>>>        Get Private.OCXShadowState to iShadow
36162>>>        If (iShadow) Move (dwSty ior WS_DISABLED) to dwSty
36165>>>        Move (dwSty ior WS_TABSTOP) to dwSty
36166>>>        Move (CreateOCXControl(iClientId,HWnd,sPrgId,sCap,dwSty,lic,sPropFile)) to iRetVal
36167>>>        Send PostCreateOCX
36168>>>    End_Procedure
36169>>>
36169>>>    Procedure UnloadOCX
36170>>>        Local Integer iRetVal
36171>>>                Local Integer iClientId
36171>>>                Get ClientId to iClientId
36172>>>                Move (DestroyOCXControl(iClientId)) to iRetVal
36173>>>    End_Procedure
36174>>>
36174>>>    //This procedure is triggered before the OCX control is created
36174>>>    Procedure PreCreateOCX
36175>>>    End_Procedure
36176>>>
36176>>>    //This procedure is triggered after the OCX control is created but
36176>>>    //before it's shown
36176>>>    Procedure PostCreateOCX
36177>>>    End_Procedure
36178>>>End_Class
36179>>>
36179>>>// The non data aware OCX class
36179>>>// Derive from this class if you DON'T want your ActiveX control to be data aware
36179>>>Class OCX_Client is a FormExternalControl
36180>>>    Import_Class_Protocol cOCX_Client_Mixin
36181>>>
36181>>>    //These allows us to use the VDF standard 'Value' to get and set the
36181>>>    // caption of the ActiveX control (e.g. Get/Set Value to someVariable)
36181>>>
36181>>>    Procedure Set ControlValue string sVal
36182>>>        Set OCXCaption to sVal
36183>>>    End_Procedure
36184>>>
36184>>>    Function Value Integer item_number Returns String
36185>>>        Function_Return (OCXCaption(Current_Object))
36186>>>    End_Function
36187>>>
36187>>>End_Class
36188>>>
36188>>>
36188>>>// The Data aware OCX class
36188>>>// Derive from this class if you want your ActiveX control to be data aware
36188>>>Class dbOCX_Client is a dbFormExternalControl
36189>>>    Import_Class_Protocol cOCX_Client_Mixin
36190>>>
36190>>>    Procedure DefinedbOCX_Client
36191>>>        Send DefineOCX_Client
36192>>>        Property String  Private.OCXdbValue public ""
36193>>>    End_Procedure
36194>>>
36194>>>    Procedure Set ControlValue string sVal
36195>>>        If (Window_Handle(Current_Object));            Send OnRefreshDbOcxValue sVal
36198>>>    End_Procedure
36199>>>
36199>>>    Function ControlValue Returns String
36200>>>        Function_Return (Private.OCXDbValue(Current_Object))
36201>>>    End_Function
36202>>>
36202>>>    //Triggered when the database value has changed,
36202>>>    // and the ActiveX control needs to be updated
36202>>>    //Override and perform necessary updating to the OCX
36202>>>    Procedure OnRefreshDbOcxValue String sVal
36203>>>    End_Procedure
36204>>>
36204>>>    //Should be called when the ActiveX control's value has changed,
36204>>>    // and the database value needs to be updated
36204>>>    Procedure UpdateDbOcxValue String sVal
36205>>>        Set Private.OCXdbValue to sVal
36206>>>        Send ControlValueChanged
36207>>>    End_Procedure
36208>>>
36208>>>End_Class
36209>>>
36209>>>
36209>>>// Command for common declarations of ActiveX control classes, only used internally
36209>>>
36209>>>
36209>>>Use FontDisp
INCLUDING FILE: FONTDISP.PKG
36209>>>>>// OLEStdFont Charset Constants
36209>>>>>Enum_List
36209>>>>>        Define OLEANSI_CHARSET for 0 
36209>>>>>        Define OLEDEFAULT_CHARSET for 1
36209>>>>>        Define OLESYMBOL_CHARSET for 2
36209>>>>>End_Enum_List
36209>>>>>
36209>>>>>
36209>>>>>// CLSID:{BEF6E003-A874-101A-8BBA-00AA00300CAB}
36209>>>>>// ProgId: 
36209>>>>>Class OLEFontMixin is a Automation_Client
36210>>>>>
36210>>>>>        Function StdFontName Returns String
36211>>>>>                Local String lpropVal
36212>>>>>                Get GetStringProperty 0 to lpropVal
36213>>>>>                Function_Return lpropVal
36214>>>>>        End_Function
36215>>>>>
36215>>>>>        Procedure SET StdFontName String lpropVal
36216>>>>>                Send SetStringProperty 0 lpropVal
36217>>>>>        End_Procedure
36218>>>>>
36218>>>>>        Function StdFontSize Returns Currency
36219>>>>>                Local Currency lpropVal
36220>>>>>                Get GetCurrencyProperty 2 to lpropVal
36221>>>>>                Function_Return lpropVal
36222>>>>>        End_Function
36223>>>>>
36223>>>>>        Procedure SET StdFontSize Currency lpropVal
36224>>>>>                Send SetCurrencyProperty 2 lpropVal
36225>>>>>        End_Procedure
36226>>>>>
36226>>>>>        Function StdFontBold Returns Bool
36227>>>>>                Local Bool lpropVal
36228>>>>>                Get GetBoolProperty 3 to lpropVal
36229>>>>>                Function_Return lpropVal
36230>>>>>        End_Function
36231>>>>>
36231>>>>>        Procedure SET StdFontBold Bool lpropVal
36232>>>>>                Send SetBoolProperty 3 lpropVal
36233>>>>>        End_Procedure
36234>>>>>
36234>>>>>        Function StdFontItalic Returns Bool
36235>>>>>                Local Bool lpropVal
36236>>>>>                Get GetBoolProperty 4 to lpropVal
36237>>>>>                Function_Return lpropVal
36238>>>>>        End_Function
36239>>>>>
36239>>>>>        Procedure SET StdFontItalic Bool lpropVal
36240>>>>>                Send SetBoolProperty 4 lpropVal
36241>>>>>        End_Procedure
36242>>>>>
36242>>>>>        Function StdFontUnderline Returns Bool
36243>>>>>                Local Bool lpropVal
36244>>>>>                Get GetBoolProperty 5 to lpropVal
36245>>>>>                Function_Return lpropVal
36246>>>>>        End_Function
36247>>>>>
36247>>>>>        Procedure SET StdFontUnderline Bool lpropVal
36248>>>>>                Send SetBoolProperty 5 lpropVal
36249>>>>>        End_Procedure
36250>>>>>
36250>>>>>        Function StdFontStrikethrough Returns Bool
36251>>>>>                Local Bool lpropVal
36252>>>>>                Get GetBoolProperty 6 to lpropVal
36253>>>>>                Function_Return lpropVal
36254>>>>>        End_Function
36255>>>>>
36255>>>>>        Procedure SET StdFontStrikethrough Bool lpropVal
36256>>>>>                Send SetBoolProperty 6 lpropVal
36257>>>>>        End_Procedure
36258>>>>>
36258>>>>>        Function StdFontWeight Returns Integer
36259>>>>>                Local Integer lpropVal
36260>>>>>                Get GetShortProperty 7 to lpropVal
36261>>>>>                Function_Return lpropVal
36262>>>>>        End_Function
36263>>>>>
36263>>>>>        Procedure SET StdFontWeight Integer lpropVal
36264>>>>>                Send SetShortProperty 7 lpropVal
36265>>>>>        End_Procedure
36266>>>>>
36266>>>>>        Function StdFontCharset Returns Integer
36267>>>>>                Local Integer lpropVal
36268>>>>>                Get GetShortProperty 8 to lpropVal
36269>>>>>                Function_Return lpropVal
36270>>>>>        End_Function
36271>>>>>
36271>>>>>        Procedure SET StdFontCharset Integer lpropVal
36272>>>>>                Send SetShortProperty 8 lpropVal
36273>>>>>        End_Procedure
36274>>>>>
36274>>>>>End_Class
36275>>>>>
36275>>>>>// CoClass CLSID:{0BE35203-8F91-11CE-9DE3-00AA004BB851}
36275>>>>>// ProgId: StdFont
36275>>>>>// Number of impl.Types:1
36275>>>>>// Referenced class Font
36275>>>>>Class OLEStdFont is a Automation_Client
36276>>>>>        Import_Class_Protocol OLEFontMixin
36277>>>>>
36277>>>>>        Procedure Construct_Object
36278>>>>>                Forward Send Construct_Object
36280>>>>>                Set progIdStr to "StdFont"
36281>>>>>        End_Procedure
36282>>>>>End_Class
36283>>>Use PicDisp
INCLUDING FILE: PICDISP.PKG
36283>>>>>
36283>>>>>// Picture Type Constants
36283>>>>>//Enum_List
36283>>>>>        Define OLEPICTYPE_UNINITIALIZED for -1 // Uninitialized
36283>>>>>        Define OLEPICTYPE_NONE for 0 // None
36283>>>>>        Define OLEPICTYPE_BITMAP for 1 // Bitmap
36283>>>>>        Define OLEPICTYPE_METAFILE for 2 // Windows Metafile
36283>>>>>        Define OLEPICTYPE_ICON for 3 // Icon
36283>>>>>        Define OLEPICTYPE_ENHMETAFILE for 4 // Enhanced Metafile
36283>>>>>//End_Enum_List
36283>>>>>
36283>>>>>// CLSID:{7BF80981-BF32-101A-8BBB-00AA00300CAB}
36283>>>>>// ProgId: 
36283>>>>>Class OLEPictureMixin is a Automation_Client
36284>>>>>
36284>>>>>        Function StdPictureHandle Returns OLE_HANDLE
36285>>>>>                Local OLE_HANDLE lpropVal
36286>>>>>                Get GetIntegerProperty 0 to lpropVal
36287>>>>>                Function_Return lpropVal
36288>>>>>        End_Function
36289>>>>>
36289>>>>>        Function StdPicturehPal Returns OLE_HANDLE
36290>>>>>                Local OLE_HANDLE lpropVal
36291>>>>>                Get GetIntegerProperty 2 to lpropVal
36292>>>>>                Function_Return lpropVal
36293>>>>>        End_Function
36294>>>>>
36294>>>>>        Procedure SET StdPicturehPal OLE_HANDLE lpropVal
36295>>>>>                Send SetIntegerProperty 2 lpropVal
36296>>>>>        End_Procedure
36297>>>>>
36297>>>>>        Function StdPictureType Returns Integer
36298>>>>>                Local Integer lpropVal
36299>>>>>                Get GetShortProperty 3 to lpropVal
36300>>>>>                Function_Return lpropVal
36301>>>>>        End_Function
36302>>>>>
36302>>>>>        Function StdPictureWidth Returns OLE_XSIZE_HIMETRIC
36303>>>>>                Local OLE_XSIZE_HIMETRIC lpropVal
36304>>>>>                Get GetIntegerProperty 4 to lpropVal
36305>>>>>                Function_Return lpropVal
36306>>>>>        End_Function
36307>>>>>
36307>>>>>        Function StdPictureHeight Returns OLE_YSIZE_HIMETRIC
36308>>>>>                Local OLE_YSIZE_HIMETRIC lpropVal
36309>>>>>                Get GetIntegerProperty 5 to lpropVal
36310>>>>>                Function_Return lpropVal
36311>>>>>        End_Function
36312>>>>>
36312>>>>>        Procedure StdPictureRender DWORD lhdc DWORD lx DWORD ly DWORD lcx DWORD lcy OLE_XPOS_HIMETRIC lxSrc OLE_YPOS_HIMETRIC lySrc OLE_XSIZE_HIMETRIC lcxSrc OLE_YSIZE_HIMETRIC lcySrc LPOLE_RECT lprcWBounds
36313>>>>>                Send DeclareParams 10
36314>>>>>                Send DefineIntegerParam lhdc
36315>>>>>                Send DefineIntegerParam lx
36316>>>>>                Send DefineIntegerParam ly
36317>>>>>                Send DefineIntegerParam lcx
36318>>>>>                Send DefineIntegerParam lcy
36319>>>>>                Send DefineIntegerParam lxSrc
36320>>>>>                Send DefineIntegerParam lySrc
36321>>>>>                Send DefineIntegerParam lcxSrc
36322>>>>>                Send DefineIntegerParam lcySrc
36323>>>>>                Send DefineIntegerParam lprcWBounds
36324>>>>>                Send InvokeVoidFunction 6
36325>>>>>        End_Procedure 
36326>>>>>
36326>>>>>End_Class
36327>>>>>
36327>>>>>// CoClass CLSID:{0BE35204-8F91-11CE-9DE3-00AA004BB851}
36327>>>>>// ProgId: StdPicture
36327>>>>>// Number of impl.Types:1
36327>>>>>// Referenced class Picture
36327>>>>>Class OLEStdPicture is a Automation_Client
36328>>>>>        Import_Class_Protocol OLEPictureMixin
36329>>>>>
36329>>>>>        Procedure Construct_Object
36330>>>>>                Forward Send Construct_Object
36332>>>>>                Set progIdStr to "StdPicture"
36333>>>>>        End_Procedure
36334>>>>>End_Class
36335>Use DPDlg    // Full Path Directory Picker
INCLUDING FILE: DPDLG.PKG
36335>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\DPDLG.OCX
36335>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 17:30:33
36335>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36335>>>
36335>>>//Enum_List
36335>>>    Define OLEdpdDesktop        for  0 // Desktop
36335>>>    Define OLEdpdControlPanel   for  1 // Control Panel
36335>>>    Define OLEdpdDesktopDir     for  2 // Desktop Directory
36335>>>    Define OLEdpdMyComputer     for  3 // My Computer
36335>>>    Define OLEdpdFontDir        for  4 // Font Directory
36335>>>    Define OLEdpdNetwork        for  5 // Network Neighborhood
36335>>>    Define OLEdpdPrinters       for  6 // Printers
36335>>>    Define OLEdpdPrograms       for  7 // Programs
36335>>>    Define OLEdpdRecent         for  8 // Recent
36335>>>    Define OLEdpdRecycleBin     for  9 // Recycle Bin
36335>>>    Define OLEdpdSendTo         for 10 // Send To
36335>>>    Define OLEdpdStartMenu      for 11 // Start Menu
36335>>>    Define OLEdpdStartUp        for 12 // Start Up
36335>>>    Define OLEdpdTemplates      for 13 // Templates
36335>>>    Define OLEdpdCustom         for 14 // Custom Root
36335>>>//End_Enum_List
36335>>>
36335>>>// Dispatch interface for DPDlg Control
36335>>>// CLSID:{BE5AB244-F888-11D0-9F5E-B42103C10710}
36335>>>// ProgId:
36335>>>Class OLE_DDPDlg is a Message
36336>>>
36336>>>        Function DPDlgBrowseForComputer Returns Bool
36337>>>                Local Bool lpropVal
36338>>>                Get GetBoolProperty 1 to lpropVal
36339>>>                Function_Return lpropVal
36340>>>        End_Function
36341>>>
36341>>>        Procedure SET DPDlgBrowseForComputer Bool lpropVal
36342>>>                Send SetBoolProperty 1 lpropVal
36343>>>        End_Procedure
36344>>>
36344>>>        Function DPDlgBrowseForPrinter Returns Bool
36345>>>                Local Bool lpropVal
36346>>>                Get GetBoolProperty 2 to lpropVal
36347>>>                Function_Return lpropVal
36348>>>        End_Function
36349>>>
36349>>>        Procedure SET DPDlgBrowseForPrinter Bool lpropVal
36350>>>                Send SetBoolProperty 2 lpropVal
36351>>>        End_Procedure
36352>>>
36352>>>        Function DPDlgDontGoBelowDomain Returns Bool
36353>>>                Local Bool lpropVal
36354>>>                Get GetBoolProperty 3 to lpropVal
36355>>>                Function_Return lpropVal
36356>>>        End_Function
36357>>>
36357>>>        Procedure SET DPDlgDontGoBelowDomain Bool lpropVal
36358>>>                Send SetBoolProperty 3 lpropVal
36359>>>        End_Procedure
36360>>>
36360>>>        Function DPDlgReturnFSAncestors Returns Bool
36361>>>                Local Bool lpropVal
36362>>>                Get GetBoolProperty 4 to lpropVal
36363>>>                Function_Return lpropVal
36364>>>        End_Function
36365>>>
36365>>>        Procedure SET DPDlgReturnFSAncestors Bool lpropVal
36366>>>                Send SetBoolProperty 4 lpropVal
36367>>>        End_Procedure
36368>>>
36368>>>        Function DPDlgReturnOnlyFSDirs Returns Bool
36369>>>                Local Bool lpropVal
36370>>>                Get GetBoolProperty 5 to lpropVal
36371>>>                Function_Return lpropVal
36372>>>        End_Function
36373>>>
36373>>>        Procedure SET DPDlgReturnOnlyFSDirs Bool lpropVal
36374>>>                Send SetBoolProperty 5 lpropVal
36375>>>        End_Procedure
36376>>>
36376>>>        Function DPDlgRoot Returns OLE_ROOTSHORT
36377>>>                Local OLE_ROOTSHORT lpropVal
36378>>>                Get GetIntegerProperty 6 to lpropVal
36379>>>                Function_Return lpropVal
36380>>>        End_Function
36381>>>
36381>>>        Procedure SET DPDlgRoot OLE_ROOTSHORT lpropVal
36382>>>                Send SetIntegerProperty 6 lpropVal
36383>>>        End_Procedure
36384>>>
36384>>>        Function DPDlghWnd Returns OLE_HANDLE
36385>>>                Local OLE_HANDLE lpropVal
36386>>>                Get GetIntegerProperty -515 to lpropVal
36387>>>                Function_Return lpropVal
36388>>>        End_Function
36389>>>
36389>>>        Procedure SET DPDlghWnd OLE_HANDLE lpropVal
36390>>>                Send SetIntegerProperty -515 lpropVal
36391>>>        End_Procedure
36392>>>
36392>>>        Function DPDlgIcon Returns LPDispatch
36393>>>                Local LPDispatch lpropVal
36394>>>                Get GetLPDispatchProperty 7 to lpropVal
36395>>>                Function_Return lpropVal
36396>>>        End_Function
36397>>>
36397>>>        Procedure SET DPDlgIcon LPDispatch lpropVal
36398>>>                Send SetLPDispatchProperty 7 lpropVal
36399>>>        End_Procedure
36400>>>
36400>>>        Function DPDlgFolder Returns String
36401>>>                Local String lpropVal
36402>>>                Get GetStringProperty 8 to lpropVal
36403>>>                Function_Return lpropVal
36404>>>        End_Function
36405>>>
36405>>>        Procedure SET DPDlgFolder String lpropVal
36406>>>                Send SetStringProperty 8 lpropVal
36407>>>        End_Procedure
36408>>>
36408>>>        Function DPDlgCaption Returns String
36409>>>                Local String lpropVal
36410>>>                Get GetStringProperty -518 to lpropVal
36411>>>                Function_Return lpropVal
36412>>>        End_Function
36413>>>
36413>>>        Procedure SET DPDlgCaption String lpropVal
36414>>>                Send SetStringProperty -518 lpropVal
36415>>>        End_Procedure
36416>>>
36416>>>        Function DPDlg_Caption Returns String
36417>>>                Local String lpropVal
36418>>>                Get GetStringProperty 0 to lpropVal
36419>>>                Function_Return lpropVal
36420>>>        End_Function
36421>>>
36421>>>        Procedure SET DPDlg_Caption String lpropVal
36422>>>                Send SetStringProperty 0 lpropVal
36423>>>        End_Procedure
36424>>>
36424>>>        Function DPDlgPath Returns String
36425>>>                Local String lpropVal
36426>>>                Get GetStringProperty 9 to lpropVal
36427>>>                Function_Return lpropVal
36428>>>        End_Function
36429>>>
36429>>>        Procedure SET DPDlgPath String lpropVal
36430>>>                Send SetStringProperty 9 lpropVal
36431>>>        End_Procedure
36432>>>
36432>>>        Function DPDlgCustomRoot Returns String
36433>>>                Local String lpropVal
36434>>>                Get GetStringProperty 10 to lpropVal
36435>>>                Function_Return lpropVal
36436>>>        End_Function
36437>>>
36437>>>        Procedure SET DPDlgCustomRoot String lpropVal
36438>>>                Send SetStringProperty 10 lpropVal
36439>>>        End_Procedure
36440>>>
36440>>>        Function DPDlgShow Returns Bool
36441>>>                Local Bool lretVal
36442>>>                Get InvokeBoolFunction 11 to lretVal
36443>>>                Function_Return lretVal
36444>>>        End_Function
36445>>>
36445>>>        Procedure DPDlgAboutBox
36446>>>                Send InvokeVoidFunction -552
36447>>>        End_Procedure
36448>>>
36448>>>End_Class
36449>>>
36449>>>// Event interface for DPDlg Control
36449>>>// CLSID:{BE5AB245-F888-11D0-9F5E-B42103C10710}
36449>>>// ProgId:
36449>>>Class OLE_DDPDlgEvents is a Message
36450>>>
36450>>>        Procedure OnDPDlgFolderSelected String lPath Bool lAllow
36451>>>        End_Procedure
36452>>>
36452>>>End_Class
36453>>>
36453>>>// DPDlg Control
36453>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36453>>>// ProgId: DPDLG.DPDlgCtrl.1
36453>>>// Number of impl.Types:2
36453>>>// Referenced class _DDPDlg
36453>>>// Referenced class _DDPDlgEvents
36453>>>Class OLEDPDlg is a OCX_Client
36454>>>        Import_Class_Protocol OLE_DDPDlg
36455>>>        Import_Class_Protocol OLE_DDPDlgEvents
36456>>>
36456>>>        Procedure Construct_Object
36457>>>                Forward Send Construct_Object
36459>>>                Send DefineOCX_Client
36460>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36461>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36464>>>        End_Procedure
36465>>>
36465>>>        Procedure PreDPDlgFolderSelected Integer lParam
36466>>>                Local String lPath
36467>>>                Local Bool lAllow
36467>>>                Get GetEventStringParam lParam 0 to lPath
36468>>>                Get GetEventBoolParam lParam 1 to lAllow
36469>>>                Send OnDPDlgFolderSelected lPath lAllow
36470>>>        End_Procedure
36471>>>
36471>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36472>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36475>>>        End_Procedure
36476>>>End_Class
36477>>>
36477>>>// DPDlg Control
36477>>>// CoClass CLSID:{BE5AB246-F888-11D0-9F5E-B42103C10710}
36477>>>// ProgId: DPDLG.DPDlgCtrl.1
36477>>>// Number of impl.Types:2
36477>>>// Referenced class _DDPDlg
36477>>>// Referenced class _DDPDlgEvents
36477>>>Class dbOLEDPDlg is a dbOCX_Client
36478>>>        Import_Class_Protocol OLE_DDPDlg
36479>>>        Import_Class_Protocol OLE_DDPDlgEvents
36480>>>
36480>>>        Procedure Construct_Object
36481>>>                Forward Send Construct_Object
36483>>>                Send DefineDbOCX_Client
36484>>>                Set progIdStr to "DPDLG.DPDlgCtrl.1"
36485>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEDPDlg"
36488>>>        End_Procedure
36489>>>
36489>>>        Procedure PreDPDlgFolderSelected Integer lParam
36490>>>                Local String lPath
36491>>>                Local Bool lAllow
36491>>>                Get GetEventStringParam lParam 0 to lPath
36492>>>                Get GetEventBoolParam lParam 1 to lAllow
36493>>>                Send OnDPDlgFolderSelected lPath lAllow
36494>>>        End_Procedure
36495>>>
36495>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36496>>>                ON_EVENT 1 Fire PreDPDlgFolderSelected
36499>>>        End_Procedure
36500>>>End_Class
36501>Use RasxDll  // Ras Package
INCLUDING FILE: RASXDLL.PKG
36501>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\RASX.DLL
36501>>>// Generated by FlexOLE Class Generator Friday, November 08, 2002 15:47:23
36501>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36501>>>
36501>>>//Enum_List
36501>>>    Define OLERasActionNone         for 0 // No action
36501>>>    Define OLERasActionConnect      for 1 // Connect server
36501>>>    Define OLERasActionGetEntry     for 2 // Get phonebook entry
36501>>>    Define OLERasActionDisconnect   for 3 // Hang up (disconnect from server)
36501>>>    Define OLERasActionRefresh      for 4 // Refresh entries list
36501>>>    Define OLERasActionCreateEntry  for 5 // Create phonebook entry
36501>>>    Define OLERasActionEditEntry    for 6 // Edit phonebook entry
36501>>>//End_Enum_List
36501>>>
36501>>>// IRasXCom Interface
36501>>>// CLSID:{8E71552C-4915-11D3-B4C3-0020AFD69DE6}
36501>>>// ProgId:
36501>>>Class OLEIRasXCom is a Automation_Client
36502>>>
36502>>>// Sets or returns the filename of the phonebook to use.
36502>>>        Function RasXComPhoneBook Returns String
36503>>>                Local String lpropVal
36504>>>                Get GetStringProperty 1 to lpropVal
36505>>>                Function_Return lpropVal
36506>>>        End_Function
36507>>>
36507>>>// Sets or returns the filename of the phonebook to use.
36507>>>        Procedure SET RasXComPhoneBook String lpropVal
36508>>>                Send SetStringProperty 1 lpropVal
36509>>>        End_Procedure
36510>>>
36510>>>// Sets or returns the phone number to dial.
36510>>>        Function RasXComPhoneNumber Returns String
36511>>>                Local String lpropVal
36512>>>                Get GetStringProperty 2 to lpropVal
36513>>>                Function_Return lpropVal
36514>>>        End_Function
36515>>>
36515>>>// Sets or returns the phone number to dial.
36515>>>        Procedure SET RasXComPhoneNumber String lpropVal
36516>>>                Send SetStringProperty 2 lpropVal
36517>>>        End_Procedure
36518>>>
36518>>>// Sets or returns the name to use when logging on.
36518>>>        Function RasXComLogonName Returns String
36519>>>                Local String lpropVal
36520>>>                Get GetStringProperty 3 to lpropVal
36521>>>                Function_Return lpropVal
36522>>>        End_Function
36523>>>
36523>>>// Sets or returns the name to use when logging on.
36523>>>        Procedure SET RasXComLogonName String lpropVal
36524>>>                Send SetStringProperty 3 lpropVal
36525>>>        End_Procedure
36526>>>
36526>>>// Sets or returns the password to use.
36526>>>        Function RasXComLogonPassword Returns String
36527>>>                Local String lpropVal
36528>>>                Get GetStringProperty 4 to lpropVal
36529>>>                Function_Return lpropVal
36530>>>        End_Function
36531>>>
36531>>>// Sets or returns the password to use.
36531>>>        Procedure SET RasXComLogonPassword String lpropVal
36532>>>                Send SetStringProperty 4 lpropVal
36533>>>        End_Procedure
36534>>>
36534>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36534>>>        Function RasXComCallbackNumber Returns String
36535>>>                Local String lpropVal
36536>>>                Get GetStringProperty 5 to lpropVal
36537>>>                Function_Return lpropVal
36538>>>        End_Function
36539>>>
36539>>>// Sets or returns the phone number that a server should call back for certain kinds of verification.
36539>>>        Procedure SET RasXComCallbackNumber String lpropVal
36540>>>                Send SetStringProperty 5 lpropVal
36541>>>        End_Procedure
36542>>>
36542>>>// Sets or returns the name of the current phone book entry.
36542>>>        Function RasXComEntryName Returns String
36543>>>                Local String lpropVal
36544>>>                Get GetStringProperty 6 to lpropVal
36545>>>                Function_Return lpropVal
36546>>>        End_Function
36547>>>
36547>>>// Sets or returns the name of the current phone book entry.
36547>>>        Procedure SET RasXComEntryName String lpropVal
36548>>>                Send SetStringProperty 6 lpropVal
36549>>>        End_Procedure
36550>>>
36550>>>// Sets or returns the domain to use for user authentication.
36550>>>        Function RasXComDomain Returns String
36551>>>                Local String lpropVal
36552>>>                Get GetStringProperty 7 to lpropVal
36553>>>                Function_Return lpropVal
36554>>>        End_Function
36555>>>
36555>>>// Sets or returns the domain to use for user authentication.
36555>>>        Procedure SET RasXComDomain String lpropVal
36556>>>                Send SetStringProperty 7 lpropVal
36557>>>        End_Procedure
36558>>>
36558>>>// Determines if methods are blocking.
36558>>>        Function RasXComBlocking Returns Bool
36559>>>                Local Bool lpropVal
36560>>>                Get GetBoolProperty 8 to lpropVal
36561>>>                Function_Return lpropVal
36562>>>        End_Function
36563>>>
36563>>>// Determines if methods are blocking.
36563>>>        Procedure SET RasXComBlocking Bool lpropVal
36564>>>                Send SetBoolProperty 8 lpropVal
36565>>>        End_Procedure
36566>>>
36566>>>// Returns the version of the control.
36566>>>        Function RasXComVersion Returns String
36567>>>                Local String lpropVal
36568>>>                Get GetStringProperty 9 to lpropVal
36569>>>                Function_Return lpropVal
36570>>>        End_Function
36571>>>
36571>>>// Returns the number of names in the current phonebook.
36571>>>        Function RasXComEntryCount Returns Integer
36572>>>                Local Integer lpropVal
36573>>>                Get GetShortProperty 10 to lpropVal
36574>>>                Function_Return lpropVal
36575>>>        End_Function
36576>>>
36576>>>// Returns whether or not RAS services are available.
36576>>>        Function RasXComRASAvailable Returns Bool
36577>>>                Local Bool lpropVal
36578>>>                Get GetBoolProperty 11 to lpropVal
36579>>>                Function_Return lpropVal
36580>>>        End_Function
36581>>>
36581>>>// Holds the last error number reported.
36581>>>        Function RasXComLastError Returns Integer
36582>>>                Local Integer lpropVal
36583>>>                Get GetShortProperty 12 to lpropVal
36584>>>                Function_Return lpropVal
36585>>>        End_Function
36586>>>
36586>>>// Returns the last method executed.
36586>>>        Function RasXComLastMethod Returns OLE_MethodsEnum
36587>>>                Local OLE_MethodsEnum lpropVal
36588>>>                Get GetIntegerProperty 13 to lpropVal
36589>>>                Function_Return lpropVal
36590>>>        End_Function
36591>>>
36591>>>// Holds a description of the last error number reported.
36591>>>        Function RasXComLastErrorString Returns String
36592>>>                Local String lpropVal
36593>>>                Get GetStringProperty 14 to lpropVal
36594>>>                Function_Return lpropVal
36595>>>        End_Function
36596>>>
36596>>>// The current state of the control.
36596>>>        Function RasXComState Returns Integer
36597>>>                Local Integer lpropVal
36598>>>                Get GetShortProperty 15 to lpropVal
36599>>>                Function_Return lpropVal
36600>>>        End_Function
36601>>>
36601>>>// A user-friendly version of the current state of the control.
36601>>>        Function RasXComStateString Returns String
36602>>>                Local String lpropVal
36603>>>                Get GetStringProperty 16 to lpropVal
36604>>>                Function_Return lpropVal
36605>>>        End_Function
36606>>>
36606>>>// Returns the RAS handle of a connection.
36606>>>        Function RasXComHandle Returns DWORD
36607>>>                Local DWORD lpropVal
36608>>>                Get GetIntegerProperty 17 to lpropVal
36609>>>                Function_Return lpropVal
36610>>>        End_Function
36611>>>
36611>>>// Returns whether or not a connection is active.
36611>>>        Function RasXComEntryConnected Returns Bool
36612>>>                Local Bool lpropVal
36613>>>                Get GetBoolProperty 18 to lpropVal
36614>>>                Function_Return lpropVal
36615>>>        End_Function
36616>>>
36616>>>// Returns the list of names in a phone book.
36616>>>        Function RasXComEntryList Integer lIndex Returns String
36617>>>                Local String lpropVal
36618>>>                Send DeclareParams 1
36619>>>                Send DefineShortParam lIndex
36620>>>                Get GetStringProperty 19 to lpropVal
36621>>>                Function_Return lpropVal
36622>>>        End_Function
36623>>>
36623>>>// Holds licensing information.
36623>>>        Function RasXComLicenseKey Returns String
36624>>>                Local String lpropVal
36625>>>                Get GetStringProperty 20 to lpropVal
36626>>>                Function_Return lpropVal
36627>>>        End_Function
36628>>>
36628>>>// Holds licensing information.
36628>>>        Procedure SET RasXComLicenseKey String lpropVal
36629>>>                Send SetStringProperty 20 lpropVal
36630>>>        End_Procedure
36631>>>
36631>>>// Connects to a server.
36631>>>        Procedure RasXComConnect
36632>>>                Send InvokeVoidFunction 22
36633>>>        End_Procedure
36634>>>
36634>>>// Disconnects (logs off) from the server.
36634>>>        Procedure RasXComDisconnect
36635>>>                Send InvokeVoidFunction 23
36636>>>        End_Procedure
36637>>>
36637>>>// Retrives an entry from the current phonebook.
36637>>>        Procedure RasXComGetEntry
36638>>>                Send InvokeVoidFunction 24
36639>>>        End_Procedure
36640>>>
36640>>>// Creates and entry in the current phone book.
36640>>>        Procedure RasXComCreateEntry
36641>>>                Send InvokeVoidFunction 25
36642>>>        End_Procedure
36643>>>
36643>>>// Allows the user to edit a RAS phone book entry.
36643>>>        Procedure RasXComEditEntry
36644>>>                Send InvokeVoidFunction 26
36645>>>        End_Procedure
36646>>>
36646>>>// Resets the component to its original state and re-loads the phone book.
36646>>>        Procedure RasXComRefresh
36647>>>                Send InvokeVoidFunction -550
36648>>>        End_Procedure
36649>>>
36649>>>// Displays About Box.
36649>>>        Procedure RasXComAbout
36650>>>                Send InvokeVoidFunction -552
36651>>>        End_Procedure
36652>>>
36652>>>// Allows object to unload without disconnecting the current connection.
36652>>>        Function RasXComDisconnectOnDestroy Returns Bool
36653>>>                Local Bool lpropVal
36654>>>                Get GetBoolProperty 28 to lpropVal
36655>>>                Function_Return lpropVal
36656>>>        End_Function
36657>>>
36657>>>// Allows object to unload without disconnecting the current connection.
36657>>>        Procedure SET RasXComDisconnectOnDestroy Bool lpropVal
36658>>>                Send SetBoolProperty 28 lpropVal
36659>>>        End_Procedure
36660>>>
36660>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36660>>>        Function RasXComNotificationObject Returns LPDispatch
36661>>>                Local LPDispatch lpropVal
36662>>>                Get GetLPDispatchProperty 27 to lpropVal
36663>>>                Function_Return lpropVal
36664>>>        End_Function
36665>>>
36665>>>// Sets or returns an object reference to an object supporting the Fast Notification interface.
36665>>>        Procedure SET RasXComNotificationObject LPDispatch lpropVal
36666>>>                Send SetLPDispatchProperty 27 lpropVal
36667>>>        End_Procedure
36668>>>
36668>>>// Returns the version of the control.
36668>>>        Procedure SET RasXComVersion String lpropVal
36669>>>                Send SetStringProperty 9 lpropVal
36670>>>        End_Procedure
36671>>>
36671>>>End_Class
36672>>>
36672>>>// _IRasXComEvents Interface
36672>>>// CLSID:{8E71552E-4915-11D3-B4C3-0020AFD69DE6}
36672>>>// ProgId:
36672>>>Class OLE_IRasXComEvents is a Automation_Client
36673>>>
36673>>>// Fired when a method finishes.
36673>>>        Procedure RasXComDone OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36674>>>                Send DeclareParams 3
36675>>>                Send DefineIntegerParam lLastMethod
36676>>>                Send DefineShortParam lErrorCode
36677>>>                Send DefineStringParam lErrorString
36678>>>                Send InvokeVoidFunction 1
36679>>>        End_Procedure
36680>>>
36680>>>// Fired when the control's internal state changes.
36680>>>        Procedure RasXComStateChanged Integer lNewState Integer lOldState
36681>>>                Send DeclareParams 2
36682>>>                Send DefineShortParam lNewState
36683>>>                Send DefineShortParam lOldState
36684>>>                Send InvokeVoidFunction 2
36685>>>        End_Procedure
36686>>>
36686>>>End_Class
36687>>>
36687>>>// RasXCom Class
36687>>>// CoClass CLSID:{8E71552D-4915-11D3-B4C3-0020AFD69DE6}
36687>>>// ProgId: Mabry.RasXCom.1
36687>>>// Number of impl.Types:2
36687>>>// Referenced class IRasXCom
36687>>>// Referenced class _IRasXComEvents
36687>>>Class OLERasXCom is a Automation_Client
36688>>>        Import_Class_Protocol OLEIRasXCom
36689>>>        Import_Class_Protocol OLE_IRasXComEvents
36690>>>
36690>>>        Procedure Construct_Object
36691>>>                Forward Send Construct_Object
36693>>>        Set progIdStr to "Mabry.RasXCom"
36694>>>        End_Procedure
36695>>>End_Class
36696>>>
36696>>>// IRasXComNotify Interface
36696>>>// CLSID:{40B44160-49E0-11D3-B4C3-0020AFD69DE6}
36696>>>// ProgId:
36696>>>Class OLEIRasXComNotify is a Automation_Client
36697>>>
36697>>>// Done
36697>>>        Procedure IRasXComNotifyDone LPDispatch lPackageObject OLE_MethodsEnum lLastMethod Integer lErrorCode String lErrorString
36698>>>                Send DeclareParams 4
36699>>>                Send DefineLPDispatchParam lPackageObject
36700>>>                Send DefineIntegerParam lLastMethod
36701>>>                Send DefineShortParam lErrorCode
36702>>>                Send DefineStringParam lErrorString
36703>>>                Send InvokeVoidFunction 1
36704>>>        End_Procedure
36705>>>
36705>>>// Fired when the control's internal state changes.
36705>>>        Procedure IRasXComNotifyStateChanged LPDispatch lPackageObject Integer lNewState Integer lOldState
36706>>>                Send DeclareParams 3
36707>>>                Send DefineLPDispatchParam lPackageObject
36708>>>                Send DefineShortParam lNewState
36709>>>                Send DefineShortParam lOldState
36710>>>                Send InvokeVoidFunction 2
36711>>>        End_Procedure
36712>>>
36712>>>End_Class
36713>Use Xfind    // Recursive Directory FILE FINDER
INCLUDING FILE: XFIND.PKG
36713>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\XFIND10DEMO.OCX
36713>>>// Generated by FlexOLE Class Generator Friday, November 10, 2000 16:23:24
36713>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36713>>>
36713>>>// Dispatch interface for xfind Control
36713>>>// CLSID:{DF5A0221-37A0-11D4-881C-E7F891A83074}
36713>>>// ProgId: 
36713>>>Class OLEIxfind is a Message
36714>>>
36714>>>        Procedure xfindAboutBox
36715>>>                Send InvokeVoidFunction -552
36716>>>        End_Procedure 
36717>>>
36717>>>        Function xfindSearchString Returns String
36718>>>                Local String lpropVal
36719>>>                Get GetStringProperty 6 to lpropVal
36720>>>                Function_Return lpropVal
36721>>>        End_Function
36722>>>
36722>>>        Procedure SET xfindSearchString String lpropVal
36723>>>                Send SetStringProperty 6 lpropVal
36724>>>        End_Procedure
36725>>>
36725>>>        Function xfindSearchFrom Returns String
36726>>>                Local String lpropVal
36727>>>                Get GetStringProperty 7 to lpropVal
36728>>>                Function_Return lpropVal
36729>>>        End_Function
36730>>>
36730>>>        Procedure SET xfindSearchFrom String lpropVal
36731>>>                Send SetStringProperty 7 lpropVal
36732>>>        End_Procedure
36733>>>
36733>>>        Function xfindSearchSubDirs Returns Bool
36734>>>                Local Bool lpropVal
36735>>>                Get GetBoolProperty 8 to lpropVal
36736>>>                Function_Return lpropVal
36737>>>        End_Function
36738>>>
36738>>>        Procedure SET xfindSearchSubDirs Bool lpropVal
36739>>>                Send SetBoolProperty 8 lpropVal
36740>>>        End_Procedure
36741>>>
36741>>>        Procedure xfindStartSearching
36742>>>                Send InvokeVoidFunction 2
36743>>>        End_Procedure 
36744>>>
36744>>>        Function xfindIsSearching Returns Bool
36745>>>                Local Bool lpropVal
36746>>>                Get GetBoolProperty 5 to lpropVal
36747>>>                Function_Return lpropVal
36748>>>        End_Function
36749>>>
36749>>>        Procedure xfindAbortSearch
36750>>>                Send InvokeVoidFunction 9
36751>>>        End_Procedure 
36752>>>
36752>>>        Function xfindFileName Returns String
36753>>>                Local String lpropVal
36754>>>                Get GetStringProperty 3 to lpropVal
36755>>>                Function_Return lpropVal
36756>>>        End_Function
36757>>>
36757>>>        Function xfindFileSize Returns DWORD
36758>>>                Local DWORD lpropVal
36759>>>                Get GetIntegerProperty 4 to lpropVal
36760>>>                Function_Return lpropVal
36761>>>        End_Function
36762>>>
36762>>>End_Class
36763>>>
36763>>>// Events interface for xfind Control
36763>>>// CLSID:{DF5A0223-37A0-11D4-881C-E7F891A83074}
36763>>>// ProgId: 
36763>>>Class OLEIxfindEvents is a Message
36764>>>
36764>>>        Procedure OnxfindActivate
36765>>>        End_Procedure
36766>>>
36766>>>        Procedure OnxfindClick
36767>>>        End_Procedure
36768>>>
36768>>>        Procedure OnxfindCreate
36769>>>        End_Procedure
36770>>>
36770>>>        Procedure OnxfindDblClick
36771>>>        End_Procedure
36772>>>
36772>>>        Procedure OnxfindDestroy
36773>>>        End_Procedure
36774>>>
36774>>>        Procedure OnxfindDeactivate
36775>>>        End_Procedure
36776>>>
36776>>>        Procedure OnxfindKeyPress Integer lKey
36777>>>        End_Procedure
36778>>>
36778>>>        Procedure OnxfindPaint
36779>>>        End_Procedure
36780>>>
36780>>>        Procedure OnxfindFinishedSearch
36781>>>        End_Procedure
36782>>>
36782>>>        Procedure OnxfindFoundFile
36783>>>        End_Procedure
36784>>>
36784>>>End_Class
36785>>>
36785>>>// xfind Control
36785>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
36785>>>// ProgId: xfind10.xfind
36785>>>// Number of impl.Types:2
36785>>>// Referenced class Ixfind
36785>>>// Referenced class IxfindEvents
36785>>>Class OLExfind is a OCX_Client
36786>>>        Import_Class_Protocol OLEIxfind
36787>>>        Import_Class_Protocol OLEIxfindEvents
36788>>>
36788>>>        Procedure Construct_Object
36789>>>                Forward Send Construct_Object
36791>>>                Send DefineOCX_Client
36792>>>                Set progIdStr to "xfind10.xfind"
36793>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
36796>>>        End_Procedure
36797>>>
36797>>>        Procedure PrexfindKeyPress Integer lParam
36798>>>                Local Integer lKey
36799>>>                Get GetEventShortParam lParam 0 to lKey
36800>>>                Send OnxfindKeyPress lKey
36801>>>        End_Procedure
36802>>>
36802>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36803>>>                ON_EVENT 1 Fire OnxfindActivate
36806>>>                ON_EVENT 2 Fire OnxfindClick
36809>>>                ON_EVENT 3 Fire OnxfindCreate
36812>>>                ON_EVENT 5 Fire OnxfindDblClick
36815>>>                ON_EVENT 6 Fire OnxfindDestroy
36818>>>                ON_EVENT 7 Fire OnxfindDeactivate
36821>>>                ON_EVENT 11 Fire PrexfindKeyPress
36824>>>                ON_EVENT 16 Fire OnxfindPaint
36827>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
36830>>>                ON_EVENT 8 Fire OnxfindFoundFile
36833>>>        End_Procedure
36834>>>End_Class
36835>>>
36835>>>// xfind Control
36835>>>// CoClass CLSID:{DF5A0225-37A0-11D4-881C-E7F891A83074}
36835>>>// ProgId: xfind10.xfind
36835>>>// Number of impl.Types:2
36835>>>// Referenced class Ixfind
36835>>>// Referenced class IxfindEvents
36835>>>Class dbOLExfind is a dbOCX_Client
36836>>>        Import_Class_Protocol OLEIxfind
36837>>>        Import_Class_Protocol OLEIxfindEvents
36838>>>
36838>>>        Procedure Construct_Object
36839>>>                Forward Send Construct_Object
36841>>>                Send DefineDbOCX_Client
36842>>>                Set progIdStr to "xfind10.xfind"
36843>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLExfind"
36846>>>        End_Procedure
36847>>>
36847>>>        Procedure PrexfindKeyPress Integer lParam
36848>>>                Local Integer lKey
36849>>>                Get GetEventShortParam lParam 0 to lKey
36850>>>                Send OnxfindKeyPress lKey
36851>>>        End_Procedure
36852>>>
36852>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
36853>>>                ON_EVENT 1 Fire OnxfindActivate
36856>>>                ON_EVENT 2 Fire OnxfindClick
36859>>>                ON_EVENT 3 Fire OnxfindCreate
36862>>>                ON_EVENT 5 Fire OnxfindDblClick
36865>>>                ON_EVENT 6 Fire OnxfindDestroy
36868>>>                ON_EVENT 7 Fire OnxfindDeactivate
36871>>>                ON_EVENT 11 Fire PrexfindKeyPress
36874>>>                ON_EVENT 16 Fire OnxfindPaint
36877>>>                ON_EVENT 4 Fire OnxfindFinishedSearch
36880>>>                ON_EVENT 8 Fire OnxfindFoundFile
36883>>>        End_Procedure
36884>>>End_Class
36885>Use EZFTP    // Ftp Package
INCLUDING FILE: EZFTP.PKG
36885>>>// Visual DataFlex OLE Classes generated from C:\WINDOWS\SYSTEM\EZFTP.OCX
36885>>>// Generated by FlexOLE Class Generator Thursday, December 28, 2000 13:30:32
36885>>>// Registered user: 20249-SOLUTION HIGH TECHNOLOGY SYSTEMS
36885>>>
36885>>>// Dispatch interface for EZFTP Control
36885>>>// CLSID:{6580F765-7819-11CF-B86C-444553540000}
36885>>>// ProgId:
36885>>>Class OLE_DEZFTP is a Message
36886>>>
36886>>>        Function EZFTPRemoteAddress Returns String
36887>>>                Local String lpropVal
36888>>>                Get GetStringProperty 1 to lpropVal
36889>>>                Function_Return lpropVal
36890>>>        End_Function
36891>>>
36891>>>        Procedure SET EZFTPRemoteAddress String lpropVal
36892>>>                Send SetStringProperty 1 lpropVal
36893>>>        End_Procedure
36894>>>
36894>>>        Function EZFTPLocalFile Returns String
36895>>>                Local String lpropVal
36896>>>                Get GetStringProperty 2 to lpropVal
36897>>>                Function_Return lpropVal
36898>>>        End_Function
36899>>>
36899>>>        Procedure SET EZFTPLocalFile String lpropVal
36900>>>                Send SetStringProperty 2 lpropVal
36901>>>        End_Procedure
36902>>>
36902>>>        Function EZFTPRemoteFile Returns String
36903>>>                Local String lpropVal
36904>>>                Get GetStringProperty 3 to lpropVal
36905>>>                Function_Return lpropVal
36906>>>        End_Function
36907>>>
36907>>>        Procedure SET EZFTPRemoteFile String lpropVal
36908>>>                Send SetStringProperty 3 lpropVal
36909>>>        End_Procedure
36910>>>
36910>>>        Function EZFTPUserName Returns String
36911>>>                Local String lpropVal
36912>>>                Get GetStringProperty 4 to lpropVal
36913>>>                Function_Return lpropVal
36914>>>        End_Function
36915>>>
36915>>>        Procedure SET EZFTPUserName String lpropVal
36916>>>                Send SetStringProperty 4 lpropVal
36917>>>        End_Procedure
36918>>>
36918>>>        Function EZFTPPassword Returns String
36919>>>                Local String lpropVal
36920>>>                Get GetStringProperty 5 to lpropVal
36921>>>                Function_Return lpropVal
36922>>>        End_Function
36923>>>
36923>>>        Procedure SET EZFTPPassword String lpropVal
36924>>>                Send SetStringProperty 5 lpropVal
36925>>>        End_Procedure
36926>>>
36926>>>        Function EZFTPBinary Returns Bool
36927>>>                Local Bool lpropVal
36928>>>                Get GetBoolProperty 6 to lpropVal
36929>>>                Function_Return lpropVal
36930>>>        End_Function
36931>>>
36931>>>        Procedure SET EZFTPBinary Bool lpropVal
36932>>>                Send SetBoolProperty 6 lpropVal
36933>>>        End_Procedure
36934>>>
36934>>>        Function EZFTPRemoteDirectory Returns String
36935>>>                Local String lpropVal
36936>>>                Get GetStringProperty 9 to lpropVal
36937>>>                Function_Return lpropVal
36938>>>        End_Function
36939>>>
36939>>>        Procedure SET EZFTPRemoteDirectory String lpropVal
36940>>>                Send SetStringProperty 9 lpropVal
36941>>>        End_Procedure
36942>>>
36942>>>        Function EZFTPProfessionalEdition Returns Bool
36943>>>                Local Bool lpropVal
36944>>>                Get GetBoolProperty 10 to lpropVal
36945>>>                Function_Return lpropVal
36946>>>        End_Function
36947>>>
36947>>>        Procedure SET EZFTPProfessionalEdition Bool lpropVal
36948>>>                Send SetBoolProperty 10 lpropVal
36949>>>        End_Procedure
36950>>>
36950>>>        Function EZFTPUseCache Returns Bool
36951>>>                Local Bool lpropVal
36952>>>                Get GetBoolProperty 7 to lpropVal
36953>>>                Function_Return lpropVal
36954>>>        End_Function
36955>>>
36955>>>        Procedure SET EZFTPUseCache Bool lpropVal
36956>>>                Send SetBoolProperty 7 lpropVal
36957>>>        End_Procedure
36958>>>
36958>>>        Function EZFTPCancelTransfer Returns Bool
36959>>>                Local Bool lpropVal
36960>>>                Get GetBoolProperty 8 to lpropVal
36961>>>                Function_Return lpropVal
36962>>>        End_Function
36963>>>
36963>>>        Procedure SET EZFTPCancelTransfer Bool lpropVal
36964>>>                Send SetBoolProperty 8 lpropVal
36965>>>        End_Procedure
36966>>>
36966>>>        Procedure EZFTPConnect
36967>>>                Send InvokeVoidFunction 11
36968>>>        End_Procedure
36969>>>
36969>>>        Procedure EZFTPDisconnect
36970>>>                Send InvokeVoidFunction 12
36971>>>        End_Procedure
36972>>>
36972>>>        Procedure EZFTPGetFile
36973>>>                Send InvokeVoidFunction 13
36974>>>        End_Procedure
36975>>>
36975>>>        Procedure EZFTPPutFile
36976>>>                Send InvokeVoidFunction 14
36977>>>        End_Procedure
36978>>>
36978>>>        Procedure EZFTPDeleteFile String lFileName
36979>>>                Send DeclareParams 1
36980>>>                Send DefineStringParam lFileName
36981>>>                Send InvokeVoidFunction 15
36982>>>        End_Procedure
36983>>>
36983>>>        Procedure EZFTPRenameFile String lOldName String lNewName
36984>>>                Send DeclareParams 2
36985>>>                Send DefineStringParam lOldName
36986>>>                Send DefineStringParam lNewName
36987>>>                Send InvokeVoidFunction 16
36988>>>        End_Procedure
36989>>>
36989>>>        Procedure EZFTPMkDir String lDirectoryName
36990>>>                Send DeclareParams 1
36991>>>                Send DefineStringParam lDirectoryName
36992>>>                Send InvokeVoidFunction 17
36993>>>        End_Procedure
36994>>>
36994>>>        Procedure EZFTPRmDir String lDirectoryName
36995>>>                Send DeclareParams 1
36996>>>                Send DefineStringParam lDirectoryName
36997>>>                Send InvokeVoidFunction 18
36998>>>        End_Procedure
36999>>>
36999>>>        Procedure EZFTPGetDirectory String lFileName
37000>>>                Send DeclareParams 1
37001>>>                Send DefineStringParam lFileName
37002>>>                Send InvokeVoidFunction 19
37003>>>        End_Procedure
37004>>>
37004>>>        Procedure EZFTPAboutBox
37005>>>                Send InvokeVoidFunction -552
37006>>>        End_Procedure
37007>>>
37007>>>End_Class
37008>>>
37008>>>// Event interface for EZFTP Control
37008>>>// CLSID:{6580F766-7819-11CF-B86C-444553540000}
37008>>>// ProgId:
37008>>>Class OLE_DEZFTPEvents is a Message
37009>>>
37009>>>        Procedure OnEZFTPNextDirectoryEntry String lFileName DWORD lAttributes OLEReal lLength
37010>>>        End_Procedure
37011>>>
37011>>>        Procedure OnEZFTPTransferProgress DWORD lBytesTransferred DWORD lTotalBytes
37012>>>        End_Procedure
37013>>>
37013>>>End_Class
37014>>>
37014>>>// EZFTP Control
37014>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37014>>>// ProgId: EZFTP.EZFTPCtrl.1
37014>>>// Number of impl.Types:2
37014>>>// Referenced class _DEZFTP
37014>>>// Referenced class _DEZFTPEvents
37014>>>
37014>>>Class OLEEZFTP is a OCX_Client
37015>>>        Import_Class_Protocol OLE_DEZFTP
37016>>>        Import_Class_Protocol OLE_DEZFTPEvents
37017>>>
37017>>>        Procedure Construct_Object
37018>>>                Forward Send Construct_Object
37020>>>                Send DefineOCX_Client
37021>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37022>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37025>>>        End_Procedure
37026>>>
37026>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37027>>>                Local String lFileName
37028>>>                Local DWORD lAttributes
37028>>>                Local OLEReal lLength
37028>>>                Get GetEventStringParam lParam 0 to lFileName
37029>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37030>>>                Get GetEventRealParam lParam 2 to lLength
37031>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37032>>>        End_Procedure
37033>>>
37033>>>        Procedure PreEZFTPTransferProgress Integer lParam
37034>>>                Local DWORD lBytesTransferred
37035>>>                Local DWORD lTotalBytes
37035>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37036>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37037>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37038>>>        End_Procedure
37039>>>
37039>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37040>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37043>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37046>>>        End_Procedure
37047>>>End_Class
37048>>>
37048>>>// EZFTP Control
37048>>>// CoClass CLSID:{6580F767-7819-11CF-B86C-444553540000}
37048>>>// ProgId: EZFTP.EZFTPCtrl.1
37048>>>// Number of impl.Types:2
37048>>>// Referenced class _DEZFTP
37048>>>// Referenced class _DEZFTPEvents
37048>>>Class dbOLEEZFTP is a dbOCX_Client
37049>>>        Import_Class_Protocol OLE_DEZFTP
37050>>>        Import_Class_Protocol OLE_DEZFTPEvents
37051>>>
37051>>>        Procedure Construct_Object
37052>>>                Forward Send Construct_Object
37054>>>                Send DefineDbOCX_Client
37055>>>                Set progIdStr to "EZFTP.EZFTPCtrl.1"
37056>>>                DECLARE_ACTIVEX_CTRL_CLASS "OLEEZFTP"
37059>>>        End_Procedure
37060>>>
37060>>>        Procedure PreEZFTPNextDirectoryEntry Integer lParam
37061>>>                Local String lFileName
37062>>>                Local DWORD lAttributes
37062>>>                Local OLEReal lLength
37062>>>                Get GetEventStringParam lParam 0 to lFileName
37063>>>                Get GetEventIntegerParam lParam 1 to lAttributes
37064>>>                Get GetEventRealParam lParam 2 to lLength
37065>>>                Send OnEZFTPNextDirectoryEntry lFileName lAttributes lLength
37066>>>        End_Procedure
37067>>>
37067>>>        Procedure PreEZFTPTransferProgress Integer lParam
37068>>>                Local DWORD lBytesTransferred
37069>>>                Local DWORD lTotalBytes
37069>>>                Get GetEventIntegerParam lParam 0 to lBytesTransferred
37070>>>                Get GetEventIntegerParam lParam 1 to lTotalBytes
37071>>>                Send OnEZFTPTransferProgress lBytesTransferred lTotalBytes
37072>>>        End_Procedure
37073>>>
37073>>>        Procedure WMDF_DFOCXEvent Integer wParam Integer lParam
37074>>>                ON_EVENT 1 Fire PreEZFTPNextDirectoryEntry
37077>>>                ON_EVENT 2 Fire PreEZFTPTransferProgress
37080>>>        End_Procedure
37081>>>End_Class
37082>Use dvFTP    // Ftp Package
INCLUDING FILE: DVFTP.PKG
37082>>>// DVFTP.PKG - Internet File Transfer Protocol (FTP) functions
37082>>>//             for Visual Dataflex
37082>>>//
37082>>>// Created by: Marcel J. Zwiebel
37082>>>//             Dataview - The Netherlands
37082>>>// E-mail    : marcel@dataview-sc.com
37082>>>// CIS id    : 100273,2473
37082>>>// Web URL   : http://www.dataview-sc.com
37082>>>//
37082>>>// Date      : 28/07/1997 
37082>>>
37082>>>Use Windows.pkg
37082>>>Use DLL.pkg
37082>>>
37082>>>// register external functions of the dvftp.dll
37082>>>
37082>>>
37082>>>// function   : dvInternetAttemptConnect
37082>>>//
37082>>>// description: Attemps to make a connection to the Internet. If the user has a dialup-connection
37082>>>//              to an Internet Service Provider (ISP) and the computer is not connected to this 
37082>>>//              ISP, the standard dialup dialog box will be evoked.
37082>>>//                   
37082>>>// parameters : none
37082>>>//
37082>>>// returns    : integer - Is 0 (ok) or error-number.
37082>>>//
37082>>>External_Function dvInternetAttemptConnect "dvInternetAttemptConnect" DVFTP.DLL ;     Returns Integer
37083>>>
37083>>>
37083>>>// function   : dvInternetOpen
37083>>>//
37083>>>// description: Initializes the application's use of the WIN32 Internet functions.
37083>>>//
37083>>>// parameters : none
37083>>>//
37083>>>// returns    : integer - Is 0 (ok) or error-number.
37083>>>//
37083>>>External_Function dvInternetOpen "dvInternetOpen" DVFTP.DLL ;     Returns Integer
37084>>>
37084>>>
37084>>>// function   : dvInternetConnect
37084>>>//
37084>>>// description: Opens an FTP-session with a server.
37084>>>//
37084>>>// parameters : string ServerName - Can be a DNS-name (for example: ftp.daccess.com) or 
37084>>>//                                  an ip-number (for example: 145.58.31.4).
37084>>>//              string UserName   - Login-name for the server, can be empty for 
37084>>>//                                  "anonymous" login (default for most FTP servers).
37084>>>//              string Password   - Password for the server, can be empty for 
37084>>>//                                  "anonymous" login (default for most FTP servers).
37084>>>//              integer Firewall  - Must be 1 for connecting through a SOCKS firewall
37084>>>//                                  server, otherwise 0.
37084>>>//
37084>>>// returns    : integer - Is 0 (ok) or error-number.
37084>>>//
37084>>>External_Function dvInternetConnect "dvInternetConnect" DVFTP.DLL ;     String szServerName String szUserName String szPassword Integer iFirewall;     Returns Integer
37085>>>
37085>>>
37085>>>// function   : dvFtpSetCurrentDirectory
37085>>>//
37085>>>// description: Changes to a different working directory on the FTP server.
37085>>>//
37085>>>// parameters : string directory - Name of the directory to change to on the remote system. 
37085>>>//                                 This can be either a fully qualified path or a name 
37085>>>//                                 relative to the current directory. 
37085>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37085>>>//                                 directory separator for either name. dvFtpSetCurrentDirectory
37085>>>//                                 translates the directory name separators to the appropriate 
37085>>>//                                 character before they are used. 
37085>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37085>>>//                                 current working directory (not all remote systems use a
37085>>>//                                 hierarchical naming scheme for directories).
37085>>>//
37085>>>// returns    : integer - Is 0 (ok) or error-number.
37085>>>//
37085>>>External_Function dvFtpSetCurrentDirectory "dvFtpSetCurrentDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37086>>>
37086>>>
37086>>>// function   : dvFtpGetCurrentDirectory
37086>>>//
37086>>>// description: Retrieves the current directory for the specified FTP session.
37086>>>//
37086>>>// parameters : none
37086>>>//
37086>>>// returns    : string - Name of the current directory.
37086>>>//
37086>>>External_Function dvFtpGetCurrentDirectory "dvFtpGetCurrentDirectory" DVFTP.DLL ;     Returns String
37087>>>
37087>>>
37087>>>// function   : dvFtpCreateDirectory
37087>>>//
37087>>>// description: Creates a new directory on the FTP server. 
37087>>>//
37087>>>// parameters : string Directory - The name of the directory to create on the remote system.
37087>>>//                                 This can be either a fully qualified path or a name 
37087>>>//                                 relative to the current directory. 
37087>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37087>>>//                                 directory separator for either name. dvFtpCreateDirectory
37087>>>//                                 translates the directory name separators to the appropriate 
37087>>>//                                 character before they are used. 
37087>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37087>>>//                                 current working directory (not all remote systems use a
37087>>>//                                 hierarchical naming scheme for directories).
37087>>>//
37087>>>// returns    : integer - Is 0 (ok) or error-number.
37087>>>//
37087>>>External_Function dvFtpCreateDirectory "dvFtpCreateDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37088>>>
37088>>>
37088>>>// function   : dvFtpRemoveDirectory
37088>>>//
37088>>>// description: Removes the specified directory on the FTP server. 
37088>>>//
37088>>>// parameters : string Directory - The name of the directory to remove on the remote system.
37088>>>//                                 This can be either a fully qualified path or a name 
37088>>>//                                 relative to the current directory. 
37088>>>//                                 A backslash (\) or forward slash (/) can be used as the 
37088>>>//                                 directory separator for either name. dvFtpRemoveDirectory
37088>>>//                                 translates the directory name separators to the appropriate 
37088>>>//                                 character before they are used. 
37088>>>//                                 Use dvFtpGetCurrentDirectory to determine the remote site's 
37088>>>//                                 current working directory (not all remote systems use a
37088>>>//                                 hierarchical naming scheme for directories).
37088>>>//
37088>>>// returns    : integer - Is 0 (ok) or error-number.
37088>>>//
37088>>>External_Function dvFtpRemoveDirectory "dvFtpRemoveDirectory" DVFTP.DLL ;     String szDirectory Returns Integer
37089>>>
37089>>>
37089>>>// function   : dvFtpFindFirstFile
37089>>>//
37089>>>// description: Searches the specified directory of the given FTP session.
37089>>>//
37089>>>// parameters : string FileSelect - A valid directory path or file name (wildcards allowed) for
37089>>>//                                  the FTP server's file system. If the string is empty the 
37089>>>//                                  first file in the current directory on the server will be 
37089>>>//                                  searched for. 
37089>>>//              integer UseCache  - Indicates using the local computer's cache.
37089>>>//                                  If the value is 0 then the the cache will be used. 
37089>>>//                                  If the value is 1 then a download of the requested file, 
37089>>>//                                  object, or directory listing from the origin server will be 
37089>>>//                                  forced, not from the cache.
37089>>>//
37089>>>// returns    : string - Name of the first file found or empty when no files found. When the 
37089>>>//                       searched directory is empty the string "directory is empty" is returned.
37089>>>//
37089>>>External_Function dvFtpFindFirstFile "dvFtpFindFirstFile" DVFTP.DLL ;     String szFileSelect Integer iUseCache Returns String
37090>>>
37090>>>
37090>>>// function   : dvFtpFindNextFile
37090>>>//
37090>>>// description: Continues a file search started as a result of executing dvFtpFindFirstFile.
37090>>>//
37090>>>// parameters : none
37090>>>//
37090>>>// returns    : string - Name of the next file found or empty when no more files are found.
37090>>>//
37090>>>External_Function dvFtpFindNextFile "dvFtpFindNextFile" DVFTP.DLL ;     Returns String
37091>>>
37091>>>
37091>>>// function   : dvFtpDeleteFile
37091>>>//
37091>>>// description: Deletes a file stored on the FTP server. 
37091>>>//
37091>>>// parameters : string FileSelect - Name of the file to be deleted.
37091>>>//                                  Can be file names relative to the current directory. 
37091>>>//                                  A backslash (\) or forward slash (/) can be used as 
37091>>>//                                  the directory separator. dvFtpDeleteFile translates the 
37091>>>//                                  directory name separators to the appropriate character 
37091>>>//                                  before they are used. 
37091>>>//
37091>>>// returns    : integer - Is 0 (ok) or error-number.
37091>>>//
37091>>>External_Function dvFtpDeleteFile "dvFtpDeleteFile" DVFTP.DLL ;     String szFileSelect Returns Integer
37092>>>
37092>>>
37092>>>// function   : dvFtpRenameFile
37092>>>//
37092>>>// description: Renames a file stored on the FTP server. 
37092>>>//
37092>>>// parameters : string Existing - The name of the file that will have its name changed on the
37092>>>//                                remote FTP server. 
37092>>>//              string New      - The new name for the remote file. 
37092>>>//
37092>>>//                                Both names can be relative to the current directory. A backslash 
37092>>>//                                (\) or forward slash (/) can be used as the directory separator 
37092>>>//                                for either name. dvFtpRenameFile translates the directory name 
37092>>>//                                separators to the appropriate character before they are used. 
37092>>>//
37092>>>// returns    : integer - Is 0 (ok) or error-number.
37092>>>//
37092>>>External_Function dvFtpRenameFile "dvFtpRenameFile" DVFTP.DLL ;     String szExisting String szNew Returns Integer
37093>>>
37093>>>
37093>>>// function   : dvFtpGetFile
37093>>>//
37093>>>// description: Retrieves a file from the FTP server and stores it under the specified file name, 
37093>>>//              creating a new local file in the process. 
37093>>>//
37093>>>// parameters : string  RemoteFile   - The name of the file to retrieve from the remote system. 
37093>>>//              string  NewFile      - The name of the file to create on the local system. 
37093>>>//              integer FailIfExists - Boolean flag that indicates whether the function should 
37093>>>//                                     proceed if a local file of the specified name already exists. 
37093>>>//                                     If value is 1 and the local file exists, dvFtpGetFile fails. 
37093>>>//              integer FileType     - Indicates the transfer method.
37093>>>//                                     If the value is 0 then the function transfers the file using 
37093>>>//                                     FTP's ASCII (Type A) transfer method. Control and formatting 
37093>>>//                                     information is converted to local equivalents. 
37093>>>//                                     If the value is 1 then the function transfers the file using 
37093>>>//                                     FTP's Image (Type I) transfer method. The file is transferred 
37093>>>//                                     exactly as it exists with no changes. 
37093>>>//
37093>>>// returns    : integer - Is 0 (ok) or error-number.
37093>>>//
37093>>>External_Function dvFtpGetFile "dvFtpGetFile" DVFTP.DLL ;     String szRemoteFile String szNewFile Integer bFailIfExists Integer iFileType Returns Integer
37094>>>
37094>>>
37094>>>// function   : dvFtpPutFile
37094>>>//
37094>>>// description: Stores a file on the FTP server. 
37094>>>//
37094>>>// parameters : string  LocalFile     - The name of the file to send from the local system. 
37094>>>//              string  NewRemoteFile - The name of the file to create on the remote system.
37094>>>//              integer FileType      - Indicates the transfer method.
37094>>>//                                      If the value is 0 then the function transfers the 
37094>>>//                                      file as ASCII. 
37094>>>//                                      If the value is 1 then the function transfres the
37094>>>//                                      file as binary. 
37094>>>//
37094>>>// returns    : integer - Is 0 (ok) or error-number.
37094>>>//
37094>>>External_Function dvFtpPutFile "dvFtpPutFile" DVFTP.DLL ;     String szLocalFile String szNewRemoteFile Integer iFileType Returns Integer
37095>>>
37095>>>
37095>>>
37095>>>// The following functions give common file-information after performing dvFtpFindFirstFile
37095>>>// and dvFtpFindNextFile. Because the FTP protocol provides no standard means of enumerating, 
37095>>>// some of the common information about files, such as file creation date and time, is not 
37095>>>// always available or correct. When this happens, dvFtpFindFirstFile and dvFtpFindNextFile 
37095>>>// fill in unavailable information with a best guess based on available information. For example,
37095>>>// creation and last access dates will often be the same as the file's modification date.
37095>>>
37095>>>
37095>>>// function   : dvFtpFilename
37095>>>//
37095>>>// description: The name of the file. 
37095>>>//
37095>>>// parameters : none
37095>>>//
37095>>>// returns    : string - Name of the file
37095>>>//
37095>>>External_Function dvFtpFilename "dvFtpFilename" DVFTP.DLL ;     Returns String
37096>>>
37096>>>
37096>>>// function   : dvFtpAlternateFilename
37096>>>//
37096>>>// description: An alternative name for the file. This name is in the classic 8.3 (filename.ext)
37096>>>//              filename format.
37096>>>//
37096>>>// parameters : none
37096>>>//
37096>>>// returns    : string - Alternate name for the file. If the file has a long filename, the complete 
37096>>>//                       name can be retrieved by the dvFtpFilename function, and the 8.3 format
37096>>>//                       truncated version of the name can be retrieved with this function. Otherwise, 
37096>>>//                       this function returns an empty string.
37096>>>//
37096>>>External_Function dvFtpAlternateFilename "dvFtpAlternateFilename" DVFTP.DLL ;     Returns String
37097>>>
37097>>>
37097>>>// function   : dvFtpFileCreated
37097>>>//              
37097>>>// description: The date/time the file was created in 24-hour format.
37097>>>//
37097>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37097>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37097>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37097>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37097>>>//
37097>>>// returns    : string - The file creation-date/time
37097>>>//
37097>>>External_Function dvFtpFileCreated "dvFtpFileCreated" DVFTP.DLL ;     Integer iDateFormat Returns String
37098>>>
37098>>>
37098>>>// function   : dvFtpFileAccessed
37098>>>//              
37098>>>// description: The last date/time the file was accessed in 24-hour format.
37098>>>//
37098>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37098>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37098>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37098>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37098>>>//
37098>>>// returns    : string - The last file access-date/time
37098>>>//
37098>>>External_Function dvFtpFileAccessed "dvFtpFileAccessed" DVFTP.DLL ;     Integer iDateFormat Returns String
37099>>>
37099>>>
37099>>>// function   : dvFtpFileWritten
37099>>>//              
37099>>>// description: The last date/time the file was written to in 24-hour format.
37099>>>//
37099>>>// parameters : integer DateFormat - The format of the date to be retrieved.
37099>>>//                                   If value is 0 then US-formatted date is returned (mm/dd/yyyy).
37099>>>//                                   If value is 1 then European-formatted date is returned (dd/mm/yyyy).
37099>>>//                                   If value is 2 then military-formatted date is returned (yyyy.mm.dd).
37099>>>//
37099>>>// returns    : string - The last file written to-date/time
37099>>>//
37099>>>External_Function dvFtpFileWritten "dvFtpFileWritten" DVFTP.DLL ;     Integer iDateFormat Returns String
37100>>>
37100>>>
37100>>>// function   : dvFtpFileSize
37100>>>//              
37100>>>// description: The size of the file in bytes.
37100>>>//
37100>>>// parameters : none
37100>>>//
37100>>>// returns    : integer - Filesize in bytes.
37100>>>//
37100>>>External_Function dvFtpFileSize "dvFtpFileSize" DVFTP.DLL ;     Returns Integer
37101>>>
37101>>>
37101>>>// function   : dvFtpIsDirectory
37101>>>//              
37101>>>// description: The file is an directory.
37101>>>//
37101>>>// parameters : none
37101>>>//
37101>>>// returns    : integer - If value is 1 the file is directory, otherwise 0 will be returned.
37101>>>//
37101>>>External_Function dvFtpIsDirectory "dvFtpIsDirectory" DVFTP.DLL ;     Returns Integer
37102>>>
37102>>>
37102>>>// function   : dvGetServerMsg
37102>>>//              
37102>>>// description: Gets the returned message from the FTP server (error-number will
37102>>>//              be 12003 "extended error").
37102>>>//
37102>>>// parameters : none
37102>>>//
37102>>>// returns    : string - Return message from the FTP server.
37102>>>//
37102>>>External_Function dvGetServerMsg "dvGetServerMsg" DVFTP.DLL;     Returns String
37103>>>
37103>>>
37103>>>// error-numbers returned
37103>>>//
37103>>>// 12001  "out of handles"            
37103>>>// 12002  "timeout"
37103>>>// 12003  "extended error"
37103>>>// 12004  "internal error"            
37103>>>// 12005  "invalid url"               
37103>>>// 12006  "unrecognized scheme"       
37103>>>// 12007  "name not resolved"         
37103>>>// 12008  "protocol not found"        
37103>>>// 12009  "invalid option"            
37103>>>// 12010  "bad option length"         
37103>>>// 12011  "option not settable"      
37103>>>// 12012  "shutdown"                  
37103>>>// 12013  "incorrect user name"       
37103>>>// 12014  "incorrect password"
37103>>>// 12015  "login failure"             
37103>>>// 12016  "invalid operation"         
37103>>>// 12017  "operation cancelled"       
37103>>>// 12018  "incorrect handle type"     
37103>>>// 12019  "incorrect handle state"
37103>>>// 12020  "not proxy request"         
37103>>>// 12021  "registry value not found"
37103>>>// 12022  "bad registry parameter"    
37103>>>// 12023  "no direct access"          
37103>>>// 12024  "no context"                
37103>>>// 12025  "no callback"               
37103>>>// 12026  "request pending"           
37103>>>// 12027  "incorrect format"          
37103>>>// 12028  "item not found"            
37103>>>// 12029  "cannot connect"            
37103>>>// 12030  "connection aborted"        
37103>>>// 12031  "connection reset"          
37103>>>// 12032  "force retry"               
37103>>>// 12033  "invalid proxy request"     
37103>>>// 12034  "need ui"                   
37103>>>// 12036  "handle exists"             
37103>>>// 12037  "sec cert date invalid"     
37103>>>// 12038  "sec cert cn invalid"       
37103>>>// 12039  "http to https on redir"    
37103>>>// 12040  "https to http on_redir"    
37103>>>// 12041  "mixed security"            
37103>>>// 12042  "chg post is non secure"    
37103>>>// 12043  "post is non_secure"        
37103>>>// 12044  "client auth cert needed"   
37103>>>// 12045  "invalid ca"                
37103>>>// 12046  "client auth not setup"     
37103>>>// 12047  "async thread failed"       
37103>>>// 12048  "redirect scheme change"    
37103>>>// 12049  "dialog pending"            
37103>>>// 12050  "retry dialog"              
37103>>>// 12110  "ftp transfer in progress"  
37103>>>// 12111  "ftp dropped"               
37103>>>// 12112  "ftp no passive mode"       
37103>>>// 12157  "security channel error"    
37103>>>// 12158  "unable to cache file"      
37103>>>// 12159  "tcpip not installed"       
37103>>>// 12163  "disconnected"              
37103>>>// 12164  "server unreachable"        
37103>>>// 12165  "proxy server unreachable"  
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>>>
37103>Use DVDIALER // Vdf6 Dialer
INCLUDING FILE: DVDIALER.PKG
37103>>>// DVDIALER.PKG - Automatic dialing functions for dial-up access to the Internet
37103>>>//
37103>>>// Created by: Marcel J. Zwiebel
37103>>>//             Dataview - The Netherlands
37103>>>// E-mail    : marcel@dataview-sc.com
37103>>>// Web URL   : http://www.dataview-sc.com
37103>>>//
37103>>>// Date      : 03/24/1999
37103>>>
37103>>>Use Windows.pkg
37103>>>Use DLL.pkg 
37103>>>
37103>>>
37103>>>// register external functions of the dvdailer.dll
37103>>>
37103>>>
37103>>>// function   : dvInternetGetConnectedState
37103>>>//
37103>>>// description: Retrieves the connected state of the local system.
37103>>>//                   
37103>>>// parameters : none
37103>>>//
37103>>>// returns    : integer - value 1 = the local system is (currently) connected by a modem to the Internet.
37103>>>//                              2 = the local system uses a local area network to connect to the Internet.
37103>>>//                              3 = the local system uses a proxy server to connect to the Internet.
37103>>>//                              4 = the local system's modem is busy with a non-Internet connection.
37103>>>//                              0 = there is no Internet connection.
37103>>>//
37103>>>External_Function32 dvInternetGetConnectedState "dvInternetGetConnectedState" DVDIALER.DLL Returns Integer
37104>>>
37104>>>
37104>>>// function   : dvInternetAutodial
37104>>>//
37104>>>// description: Automatically causes the modem to dial the default Internet connection.
37104>>>//              Use the function dvInternetAutodialHangup to hangup this connection.
37104>>>//                   
37104>>>// parameters : none
37104>>>//
37104>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37104>>>//
37104>>>External_Function32 dvInternetAutodial "dvInternetAutodial" DVDIALER.DLL Returns Integer
37105>>>
37105>>>
37105>>>// function   : dvInternetAutodialHangup
37105>>>//
37105>>>// description: Disconnects an automatic dial-up connection invoked by dvInternetAutodial. 
37105>>>//                   
37105>>>// parameters : none
37105>>>//
37105>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37105>>>//
37105>>>External_Function32 dvInternetAutodialHangup "dvInternetAutodialHangup" DVDIALER.DLL Returns Integer
37106>>>
37106>>>
37106>>>// function   : dvInternetDial
37106>>>//
37106>>>// description: Initiates a connection to the Internet using a modem connection and a phonebook entry.
37106>>>//              Use the function dvInternetHangup to hangup this connection.
37106>>>//                   
37106>>>// parameters : string - The name of the dial-up connection to use (phonebook entry).
37106>>>//
37106>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37106>>>//
37106>>>External_Function32 dvInternetDial "dvInternetDial" DVDIALER.DLL String szConnectiontoid Returns Integer
37107>>>
37107>>>
37107>>>// function   : dvInternetHangup
37107>>>//
37107>>>// description: Instructs the modem to disconnect from the Internet (connection invoked by dvInternetDial). 
37107>>>//              
37107>>>// parameters : none
37107>>>//
37107>>>// returns    : integer - Is 0 (successful) or 1 (not successful).
37107>>>//
37107>>>External_Function32 dvInternetHangUp "dvInternetHangUp" DVDIALER.DLL Returns Integer
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>>>
37108>//------------------------------
37108>
37108>
37108>//AB-StoreTopEnd
37108>
37108>
37108>Object Main is a Panelsub
37110>    Set Label To "Kleisimo"
37111>
37111>    DFCreate_Menu Main_Menu
INCLUDING FILE: FILE_PM.INC
37114>>//************************************************************************
37114>>//
37114>>//* Copyright (c) 1997 Data Access Corporation, Miami Florida,
37114>>//* All rights reserved.
37114>>//* DataFlex is a registered trademark of Data Access Corporation.
37114>>//*
37114>>//*
37114>>//*  Module Name:
37114>>//*      FILE_PM.INC
37114>>//*
37114>>//*  Creator:
37114>>//*        LS, MAZ, JJT(changed for windaf)
37114>>//*
37114>>//*  Date:
37114>>//*      November 31, 1992
37114>>//*      10/28/94 03:17 pm - JJT windaf chagges
37114>>//*
37114>>//*  Purpose:
37114>>//*         package for creating generic record_pull_down object for entry
37114>>//*             object actions(assumed to be used as first pull down menu,
37114>>//*             hence EXIT option as last item)
37114>>//*
37114>>//*************************************************************************
37114>>// JJT - Modified to shadow items if not a DEO OR if no server
37114>>//*************************************************************************
37114>>
37114>>
37114>>Object oMyWinPrint is an DF_PRINTER
37116>>
37116>>    Procedure DFPrint
37118>>        Local Integer iRetVal
37119>>
37119>>        Get DFGetPrintDialogFlags To iRetVal
37120>>
37120>>        If iRetVal Begin
37122>>            Send DFPrintDoc
37123>>            Send DFClearDoc
37124>>        End
37124>>>
37124>>    End_Procedure
37125>>    Move Current_Object to WinPrintId
37126>>End_Object
37127>>
37127>>Register_Procedure Set piPropertiesObjectId
37127>>Register_Function piPropertiesObjectId Returns Integer
37127>>
37127>>Register_Function Close_All_Views Integer bWith_Confirmation Returns Integer
37127>>
37127>>DFCreate_Menu "&„šš¨˜­âª" File_Menu is a DEOPopupMenu
37131>>    On_Item "&€¡ç¨à©ž/Add\aF5" send Request_Clear
37132>>        Set Status_Help To '‰˜Ÿ˜¨åœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37133>>
37133>>    On_Item "&Super €¡ç¨à©ž\aCtrl+F5" send Request_Clear_All
37134>>        Set Status_Help To '‰˜Ÿ˜¨åœ  æ¢˜ «˜ ›œ›¦£â¤˜ ˜§æ «ž¤ æ¯ž'
37135>>
37135>>    On_Item "&ƒ ˜š¨˜­ã\aShift+F2" send Request_Delete
37136>>        Set Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37137>>
37137>>    On_Item "&€¤˜ã«ž©ž\aF9" send Find_GE
37138>>        Set Status_Help To '¨å©¡œ  £ á œšš¨˜­ã'
37139>>
37139>>    On_Item "&„§æ£œ¤¦\aF8" send Find_Next
37140>>        Set Status_Help To '¨å©¡œ  «ž¤ œ§æ£œ¤ž œšš¨˜­ã'
37141>>
37141>>    On_Item "&¨¦žš¦ç£œ¤¦\aF7" send Find_Previous
37142>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨¦žš¦ç£œ¤ž œšš¨˜­ã'
37143>>
37143>>    //On_Item "Super ˜¤˜ã«ž©ž\aShift+F9" send Superfind
37143>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž £ áª œšš¨˜­ãª'
37143>>
37143>>    //On_Item "Super œ§æ£œ¤¦\aShift+F8" send Superfind_Next
37143>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž œ§æ£œ¤žª œšš¨˜­ãª'
37143>>
37143>>    //On_Item "Super §¨¦žš¦ç£œ¤¦\aShift+F7" send Superfind_Previous
37143>>    //    Set Status_Help To 'Super_˜¤˜ã«ž©ž §¨¦žš¦ç£œ¤žª œšš¨˜­ãª'
37143>>
37143>>    On_Item "&¨é«¦\aCtrl+Home" send Beginning_Of_Data
37144>>        Set Status_Help To '¨å©¡œ  «ž¤ §¨é«ž œšš¨˜­ã'
37145>>
37145>>    On_Item "’œ&¢œ¬«˜å¦\aCtrl+End" send End_Of_Data
37146>>        Set Status_Help To '¨å©¡œ  «ž¤ «œ¢œ¬«˜¢å˜ œšš¨˜­ã'
37147>>
37147>>    On_Item "&„šš¨˜­ž\aF2" send Request_Save
37148>>        Set Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã'
37149>>
37149>>    On_Item "" send NONE
37150>>
37150>>    //on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  Send Activate_oPrnSetup to (client_area(current_object))
37150>>    on_item   "çŸ£ ©ž œ¡«ç§à©žª  "  send DFPrintSetup       to (oWinPrint(Self))
37151>>    Set Status_Help To "çŸ£ ©ž œ¡«ç§à©žª"
37152>>    on_item   "„¡«ç§à©ž           "  send DFPrint            to (oMyWinPrint(Self))
37153>>    Set Status_Help To "„¡«ç§à©ž œšš¨á­¦¬"
37154>>
37154>>    On_Item "" send NONE
37155>>
37155>>    On_Item "&ˆ› ¦«ž«œª\aAlt+I" send DoShowProperties to Self
37156>>    Set Status_Help To '‰˜Ÿ¦¨ ©£æª ˆ› ¦«ã«à¤ «žª œ­˜¨£¦šãª'
37157>>
37157>>    On_Item "" send NONE
37158>>
37158>>    On_Item "„&¥¦›¦ª\aAlt+F4" send Exit_Application to desktop
37159>>        Set Status_Help To 'š˜å¤œ  ˜§¦ «ž¤ œ­˜¨£¦šã'
37160>>
37160>>    Procedure DoShowProperties
37162>>        If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37165>>    End_Procedure
37166>>
37166>>    On_Key Key_Alt+Key_I Send DoShowProperties
37167>>
37167>>    //  When ever the menu [pulldown] is initialized, check/set
37167>>    //  the state of its items.
37167>>    //
37167>>    Procedure OnInitMenu
37169>>        Local integer Obj# IsDeo Changed NoIndex File# Field# Srvr Itm
37170>>        Local integer IsDeoControl lId liClId
37170>>        Get Focus to Obj#
37171>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37172>>        If IsDeo Get Server of obj# to Srvr          // invoking data-set
37175>>        If (isDeo AND Srvr) Begin
37177>>            // returns T if object in question is a DEO control object (i.e.
37177>>            // understands the data_file, data_field messages).
37177>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37178>>            Get Should_Save of Obj# to changed  // changed file?
37179>>            If IsDEOControl Begin
37181>>                Get data_file of Obj# to file#
37182>>                Get data_field of Obj# to field#
37183>>                Move ( File#=0 OR ;                    (Field_Main_Index(Srvr,File#,Field#)=-1) ;                    ) to NoIndex             // has a find index?
37184>>            End
37184>>>
37184>>            Else ;                Move 1 to NoIndex
37186>>            Set Shadow_state item 0  to False
37187>>            Set Shadow_state item 1  to False
37188>>            Set Shadow_state item 2  to (Current_record(Srvr)=0)
37189>>            Set Shadow_state item 3  to NoIndex
37190>>            Set Shadow_state item 4  to NoIndex
37191>>            Set Shadow_state item 5  to NoIndex
37192>>            Set Shadow_state item 6  to NoIndex
37193>>            Set Shadow_state item 7  to NoIndex
37194>>            Set Shadow_state item 8  to (Should_Save(Srvr)=0)
37195>>         //   Set Shadow_state item 9  to NoIndex
37195>>         //   Set Shadow_state item 10  to NoIndex
37195>>         //   Set Shadow_state item 11 to NoIndex
37195>>         //   Set Shadow_state item 12 to (Should_Save(Srvr)=0)
37195>>        End
37195>>>
37195>>        Else Begin
37196>>            for itm from 0 to 8 //11
37202>>>
37202>>                set shadow_State item itm to TRUE
37203>>            Loop
37204>>>
37204>>        End
37204>>>
37204>>        Set Shadow_State Item 13 to (piPropertiesObjectId(Self)=0)
37205>>    End_Procedure
37206>>
37206>>    Register_Procedure Activate_oPrnSetup
37206>>
37206>>End_Pull_Down
37208>>Set Status_Help to "€¤˜ã«ž©ž, „šš¨˜­ã, ƒ ˜š¨˜­ã, €¡ç¨à©ž ›œ›¦£â¤à¤ ã â¥¦›¦ª ˜§¦ «ž¤ œ­˜¨£¦šã"
37209>
37209>        DFCreate_Menu "&View" ViewPopupMenu is a ViewPopupMenu
37213>            On_Item "&vsapdom:eksagogh eggrafon  domikh\aCtrl+1" Send Activate_vsapdom
37214>        End_Pull_down
37216>        Set Status_Help To "Available Views"
37217>        
37217>        DFCreate_Menu "&Report" ReportPopupMenu is a ViewPopupMenu
37221>            On_Item "&vwKleisimo\aCtrl+2" Send Activate_vwKleisimo
37222>        End_Pull_down
37224>        Set Status_Help To "Available Reports"
37225>        
INCLUDING FILE: NAVI_PM.INC
37225>>Use DFDEOMnu
37225>>
37225>>DFCreate_Menu "&Navigation" NAVIGATE_Menu is a DEOPopupMenu
37229>>    On_Item "&Next Area\aF6"            send Switch_Next_Area
37230>>        Set Status_Help To  'Move to Next Area'
37231>>
37231>>    On_Item "&Previous Area\aShift+F6"  send Switch_Prior_Area
37232>>        Set Status_Help To  'Move to Previous Area'
37233>>
37233>>    On_Item "N&ext View\aAlt+F6"        send Switch_Next_View
37234>>        Set Status_Help To  'Move to Next View'
37235>>
37235>>    On_Item "P&revious View\aCtrl+F6"   send Switch_Prior_View
37236>>        Set Status_Help To  'Move to Previous View'
37237>>
37237>>    On_Item ""                          send none
37238>>
37238>>    On_Item "&List\aF4"               send Prompt
37239>>        Set Status_Help To  'Show Selection Lists'
37240>>
37240>>    On_Item "&Zoom\aAlt+F9"             send Zoom
37241>>        Set Status_Help To  'Show Zoom'
37242>>
37242>>    Procedure OnInitMenu
37244>>        Local integer Obj# IsDeo Itm prmpt zm isDeoControl
37245>>        Get Focus to Obj#
37246>>        Get is_Function Get_DEO_Object Obj# TRUE to IsDeo
37247>>        If IsDeo Begin
37249>>            Get is_Function Get_DEO_Control_Object Obj# False to IsDeoControl
37250>>            If IsDeoControl Begin
37252>>                Get Prompt_Object of Obj# to Prmpt
37253>>                Get Zoom_Object of Obj# to zm
37254>>            End
37254>>>
37254>>            Set Shadow_state item 0  to False
37255>>            Set Shadow_state item 1  to False
37256>>            Set Shadow_state item 2  to False
37257>>            Set Shadow_state item 3  to False
37258>>            Set Shadow_state item 5  to (Prmpt=0)
37259>>            Set Shadow_state item 6  to (Zm=0)
37260>>        End
37260>>>
37260>>        Else Begin
37261>>            for itm from 0 to 6
37267>>>
37267>>                set shadow_State item itm to TRUE
37268>>            Loop
37269>>>
37269>>        End
37269>>>
37269>>    End_Procedure
37270>>
37270>>End_Pull_Down
37272>>Set Status_Help to "Navigation in different areas of the screen"
37273>>
INCLUDING FILE: WIN_PM.INC
37273>>DFCreate_Menu "&Window" Window_Menu
37277>>    Set select_mode to Multi_Select
37278>>    // normal number of items in pulldown (w/ no active views)
37278>>    property integer std_item_count public 0
37280>>
37280>>    DFCreate_Menu "&Preferences" Display_Options_Menu
37284>>        Set select_mode to Multi_Select
37285>>        On_Item "&ToolBar"        Send Toggle_Toolbar             To Self
37286>>        On_Item "&StatusBar"      Send Toggle_Statusbar           To Self
37287>>        On_Item "&Arrange Icons"  Send Toggle_Auto_Arrange_Icons  To Self
37288>>
37288>>        //  When ever the menu [pulldown] is initialized, check/set
37288>>        //  the state of its items.
37288>>        //
37288>>        Procedure OnInitMenu
37290>>            local integer bState
37291>>
37291>>            Get ToolBar_State to bState
37292>>            Set Select_State Item 0 to bState
37293>>            if  bState   Set Status_Help Item 0 To '' //'Hide the ToolBar'
37296>>            Else         Set Status_Help Item 0 to '' //'Show the ToolBar'
37298>>
37298>>            Get Statusbar_State to bState
37299>>            Set Select_State Item 1 to bState
37300>>            if  bState  Set Status_Help Item 1 To ''// 'Hide the StatusBar'
37303>>            Else        Set Status_Help Item 1 to ''// 'Show the StatusBar'
37305>>
37305>>            Get Auto_Arrange_Icons_State to bState
37306>>            Set Select_State Item 2 to bState
37307>>            if  bState  Set Status_Help Item 2 To '' //'Hide AutoArrange Icons'
37310>>            Else        Set Status_Help Item 2 to '' //'Show AutoArrange Icons'
37312>>
37312>>        End_procedure
37313>>
37313>>
37313>>    End_Pull_Down
37315>>    Set Status_Help                                           To '' //"Enable Toolbar, StatusBar, and AutoArrange Icons options"
37316>>
37316>>    On_Item ""
37317>>
37317>>    On_Item "&Cascade" send Cascade_Windows                   To Self
37318>>        Set Status_Help                                       To ''
37319>>
37319>>    On_Item "Tile &Horizontally" send Tile_Windows_Horizontal To Self
37320>>        Set Status_Help                                       To ''
37321>>
37321>>    On_Item "Tile &Vertically" send Tile_Windows_Vertical     To Self
37322>>        Set Status_Help                                       To ''
37323>>
37323>>    On_Item ""
37324>>
37324>>    On_Item "Minimize all" send Minimize_all_Windows          To Current_Object
37325>>        Set Status_Help                                       To ''
37326>>
37326>>    On_Item "&Restore all" send Restore_all_Windows           To Current_Object
37327>>        Set Status_Help                                       To ''
37328>>
37328>>    On_Item ""
37329>>
37329>>    On_Item "&Arrange Icons" send Arrange_Icons               To Current_Object
37330>>        Set Status_Help                                       To ''
37331>>
37331>>    // set this to the number of items in the menu with no views.
37331>>    Set Std_item_count to (item_count(current_object))
37332>>
37332>>    // add all active views to the end of the menu
37332>>    Procedure OnInitMenu
37334>>        local integer iStdCnt iNumCnt hVw hCl iCount
37335>>        Local string sLbl
37335>>        //*** Remove all old view items
37335>>        Get Item_count     to iNumCnt
37336>>        get Std_item_count to iStdCnt
37337>>        For iCount from 1  to (iNumCnt - iStdCnt)
37343>>>
37343>>            Send Delete_item iStdCnt
37344>>        Loop
37345>>>
37345>>
37345>>        Move iStdcnt to iNumCnt
37346>>        get Client_id to hCl // object id of client area
37347>>        If hCl Begin
37349>>           Get Next_Mdi_Dialog of hcl TRUE to hVw // find first view
37350>>           While hVw
37354>>              if (Active_state(hVw)) Begin
37356>>                 if iNumCnt eq iStdCnt Begin // if first view, add separator
37358>>                    send add_item 0 ''
37359>>                    increment iNumCnt
37360>>                 end
37360>>>
37360>>                 Get Label of hVw to sLbl // caption bar (name) of view
37361>>                 // note that all views understand the message activate_view.
37361>>                 send add_item msg_activate_view sLbl // set message, value and destination
37362>>                 set aux_value item iNumcnt to hVw
37363>>                 // if this is the focus view, mark it.
37363>>                 If (current_scope(desktop)=hVw and View_mode(hVw)<>VIEWMODE_ICONIZE) ;                     set select_state item iNumCnt to True
37366>>                 // create status help
37366>>                 Set Status_help item iNumCnt to ("Make this view (" - trim(sLbl) - ") the active window.")
37367>>                 increment iNumCnt
37368>>              end
37368>>>
37368>>              Get Next_Mdi_Dialog of hcl FALSE to hVw // find next
37369>>           End
37370>>>
37370>>        End
37370>>>
37370>>    End_Procedure // OnInitMenu
37371>>
37371>>End_Pull_Down
37373>>Set Status_Help to ''
INCLUDING FILE: HELPA_PM.INC
37374>>
37374>>
37374>>DFCreate_Menu "&Help" Help_Menu
37378>>    on_item "&Help Topic" send Help_on_topic
37379>>        Set Status_Help To "Search for help on a particular subject."
37380>>        on_item "" send NONE
37381>>    on_item "&Context Help"          send Extended_Help
37382>>        Set Status_Help To "Show Context sensitive help."
37383>>
37383>>    on_item "&Files Help"            send File_Help
37384>>        Set Status_Help To "Show Files help."
37385>>
37385>>    on_item "&Keys Help"             send Keys_Help
37386>>        Set Status_Help To "Show Keys help."
37387>>
37387>>    on_item "" send NONE
37388>>
37388>>    on_item "&How to Use Help"       send Help_For_Help
37389>>        Set Status_Help To "How to Use Help"
37390>>
37390>>    on_item "" send NONE
37391>>
37391>>    On_Item "&Tips of the Day" send Activate_TipOfDay
37392>>        Set Status_Help To "Tips of the Day"
37393>>
37393>>    on_item "" send NONE
37394>>
37394>>    On_item "About" Send Activate_About
37395>>        Set Status_Help To "System Information"
37396>>end_pull_down
37398>>Set Status_Help to "Access to the program's help subsystem"
37399>>
37399>>Register_Procedure Activate_TipOfDay
37399>>
37399>>
37399>    End_Menu
37401>
37401>    Use Ewbtnbar.pkg //  Tool-Bar object.
INCLUDING FILE: EWBTNBAR.PKG
37401>>>// 23/07/1998 SPY
37401>>>
37401>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
37401>>>>>//-------------------------------------------------------------------------
37401>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
37401>>>>>//
37401>>>>>//
37401>>>>>// 07/23/96 JJT - New Class names
37401>>>>>//-------------------------------------------------------------------------
37401>>>>>
37401>>>>>Use DfPanel // dfapp_buttonbar
37401>>>>>
37401>>>>>Class ToolBar is a AppToolBar
37402>>>>>
37402>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
37403>>>>>      Local integer rval MainObj#
37404>>>>>      Get Main_Panel_id to MainObj#
37405>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
37408>>>>>      Function_Return rVal
37409>>>>>    End_Function
37410>>>>>
37410>>>>>    Procedure Redirect_Button_Message integer Itm
37411>>>>>         Local integer Msg# Aux# rval Understood
37412>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
37415>>>>>         Get Message   item itm  to Msg#
37416>>>>>         Get Aux_Value item itm  to Aux#
37417>>>>>         If Msg# Begin
37419>>>>>           If Aux# eq 0 Begin
37421>>>>>              Get Focus to Aux#
37422>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
37423>>>>>              If Not Understood Move 0 to Aux#
37426>>>>>           End
37426>>>>>>
37426>>>>>           If Aux# Get Msg# of Aux# to rval
37429>>>>>           Procedure_return rval
37430>>>>>         end
37430>>>>>>
37430>>>>>    End_Procedure // Redirect_Message
37431>>>>>
37431>>>>>End_Class
37432>>>>>
37432>>>>>
37432>>>Use Dates.utl
37432>>>
37432>>>Register_Object CalendarEz
37432>>>Register_Procedure Activate_Sort_Vw
37432>>>Register_Procedure DoPrintScreen
37432>>>
37432>>>Procedure doPopupCalendar
37434>>>    Send request_popup to (Popup_calendar(Self))
37435>>>End_Procedure
37436>>>
37436>>>Procedure doRebuild
37438>>>    Send Activate_Sort_Vw To (Client_Area(Main(Self)))
37439>>>End_Procedure
37440>>>
37440>>>Procedure doExit_Application
37442>>>    send Exit_Application to desktop
37443>>>End_Procedure
37444>>>
37444>>>Procedure DoRefresh_Grids
37446>>>    Integer liObj
37447>>>    
37447>>>    Move (Focus(Desktop)) to liObj
37448>>>    If (Base_class(liObj) = list_class) Send beginning_of_data to liObj
37451>>>End_Procedure
37452>>>
37452>>>Procedure DoPopupCalc
37454>>>    Runprogram background "Calc.exe"
37455>>>End_Procedure
37456>>>
37456>>>Procedure DoPopupSetup
37458>>>    string sRunPath
37459>>>    get_profile_string "workspaces\ad" "dfparamspath" to sRunPath
37462>>>    append sRunPath "\dfparams"
37463>>>    send DoRunApplication sRunPath
37464>>>End_Procedure
37465>>>
37465>>>Object oMyWinPrint is an DF_PRINTER
37467>>>    Procedure DFPrint
37469>>>        Integer iRetVal
37470>>>        Get DFGetPrintDialogFlags To iRetVal
37471>>>        If iRetVal Begin
37473>>>            Send DFPrintDoc
37474>>>            Send DFClearDoc
37475>>>        End
37475>>>>
37475>>>    End_Procedure
37476>>>    Move Current_Object to WinPrintId
37477>>>End_Object
37478>>>
37478>>>
37478>>>Procedure DoPrint
37480>>>    Send DfPrint to (oMyWinPrint(Self))
37481>>>End_Procedure
37482>>>
37482>>>Procedure DoShowPropertiesPage
37484>>>   If (Close_All_Views(Self,True)=0) Send Activate_View to (piPropertiesObjectId(self))
37487>>>End_Procedure
37488>>>
37488>>>   //  Button bar object.
37488>>>//
37488>>>Object Tool_Bar is a ToolBar     
37490>>>    
37490>>>    Property Integer piOutputDestination Public 0
37492>>>
37492>>>    Send ImageList_Add 'bgn.bmp'      // 0
37493>>>    Send ImageList_Add 'end.bmp'      // 1
37494>>>    Send ImageList_Add 'next.bmp'     // 2
37495>>>    Send ImageList_Add 'prev.bmp'     // 3
37496>>>    Send ImageList_Add 'clr.bmp'      // 4
37497>>>    Send ImageList_Add 'clra.bmp'     // 5
37498>>>    Send ImageList_Add 'calend.bmp'   // 6
37499>>>    Send ImageList_Add 'Abfile.bmp'   // 7
37500>>>    Send ImageList_Add 'Dbexplor.bmp' // 8
37501>>>    Send ImageList_Add 'Ddb_find.bmp' // 9
37502>>>    Send ImageList_Add 'Abup.bmp'     // 10
37503>>>    Send ImageList_Add 'Arrow2.bmp'   // 11
37504>>>    Send ImageList_Add 'Save1.bmp'    // 12
37505>>>    Send ImageList_Add 'Exitm.bmp'    // 13
37506>>>    Send ImageList_Add 'include.bmp'  // 14
37507>>>    Send ImageList_Add 'Zoom_m1.bmp'  // 15
37508>>>    Send ImageList_Add 'Zoom2mg.bmp'  // 16
37509>>>    Send ImageList_Add 'DbeRefrh.Bmp' // 17
37510>>>    Send ImageList_Add 'calc1.bmp'    // 18
37511>>>    Send ImageList_Add 'print_m0.bmp' // 19
37512>>>    Send ImageList_Add 'Abcodeed.bmp' // 20
37513>>>    Send ImageList_Add 'vuur.bmp'     // 21
37514>>>    //Send ImageList_Add 'wmsui329.bmp' // 22
37514>>>
37514>>>    send Add_button (ico_user+0) msg_beginning_of_data
37515>>>    Send Add_ToolTip "€¨®ã €¨®œå¦¬ (Ctrl+Home)"
37516>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨é«ž „šš¨˜­ã (Ctrl+Home)'
37517>>>
37517>>>    send Add_button (ico_user+3) msg_find_previous
37518>>>    Send Add_ToolTip "¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)"
37519>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ¨¦žš¦ç£œ¤ž „šš¨˜­ã (F7)'
37520>>>
37520>>>    send Add_button (ico_user+10) msg_find_GE
37521>>>    Send Add_ToolTip "€¤˜ã«ž©ž (F9)"
37522>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „šš¨˜­ã á©œ  «à¤ ‘«¦ ®œåà¤ (F9)'
37523>>>
37523>>>    send Add_button (ico_user+2) msg_find_next
37524>>>    Send Add_ToolTip "„§æ£œ¤ž „šš¨˜­ã (F8)"
37525>>>    Set  Status_Help To '¨å©¡œ  «ž¤ „§æ£œ¤ž „šš¨˜­ã (F8)'
37526>>>
37526>>>    send Add_button (ico_user+1) msg_end_of_data
37527>>>    Send Add_ToolTip "’â¢¦ª €¨®œå¦¬ (Ctrl+End)"
37528>>>    Set  Status_Help To '¨å©¡œ  «ž¤ ’œ¢œ¬«˜å˜ „šš¨˜­ã (Ctrl+End)'
37529>>>
37529>>>    send Add_space
37530>>>
37530>>>    send Add_button ico_std_find msg_prompt
37531>>>    Send Add_ToolTip "Šå©«˜ (F4)"
37532>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª æ¢œª « ª › ˜Ÿâ© £œª œ§ ¢¦šâª (F4)'
37533>>>
37533>>>    send Add_button (ico_User+15) msg_zoom
37534>>>    Send Add_ToolTip "Z¦¦£ (Alt+F9)"
37535>>>    Set  Status_Help To '‹§¦¨œåª ¤˜ ›œåª §¨æ©Ÿœ«œª §¢ž¨¦­¦¨åœª (Alt+F9)'
37536>>>
37536>>>    send Add_button (ico_user+6) msg_doPopupCalendar
37537>>>    Send Add_ToolTip "†£œ¨¦¢æš ¦"
37538>>>    Set  Status_Help To "†£œ¨¦¢æš ¦ ƒ ˜Ÿâ© £¦ £æ¤¦ ©œ §œ›å˜-†£œ¨¦£ž¤åœª"
37539>>>
37539>>>    send Add_space
37540>>>
37540>>>    send Add_button (ico_user+4) msg_request_clear
37541>>>    Send Add_ToolTip "€¡ç¨à©ž (F5)"
37542>>>    Set  Status_Help To '€¡ç¨à©ž «¨â®¦¬©˜ª œšš¨˜­ãª / ¨æ©Ÿœ©ž ¤â˜ª œšš¨˜­ãª (F5)'
37543>>>
37543>>>    send Add_button (ico_user+5) msg_request_clear_all
37544>>>    Send Add_ToolTip "Ž¢ ¡ã €¡ç¨à©ž (Ctrl+F5)"
37545>>>    Set  Status_Help To 'Ž¢ ¡ã ˜¡ç¨à©ž «à¤ ›œ›¦£â¤à¤ ©«ž¤ æ¯ž §¦¬ › ˜®œ ¨åœ«˜  ¦ ®¨ã©«žª (Ctrl+F5)'
37546>>>
37546>>>    send Add_button (ico_user+17) msg_DoRefresh_Grids
37547>>>    Send Add_ToolTip "€¤˜¤âà©ž ƒœ›¦£â¤à¤ (Ctrl+Home)"
37548>>>    Set  Status_Help To '€¤˜¤œé¤œ  «˜ ›œ›¦£â¤˜ ©«˜ Grids (Ctrl+Home)'
37549>>>
37549>>>    send Add_space
37550>>>
37550>>>    send Add_button ico_std_filesave msg_request_save
37551>>>    Send Add_ToolTip "„šš¨˜­ã+€¡ç¨à©ž (F2)"
37552>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ (F2)'
37553>>>
37553>>>    send Add_button ico_std_delete msg_request_delete
37554>>>    Send Add_ToolTip "ƒ ˜š¨˜­ã (Shift+F2)"
37555>>>    Set  Status_Help To 'ƒ ˜š¨á­œ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ˜§æ «¦ ˜¨®œå¦ (Shift+F2)'
37556>>>
37556>>>    send Add_button (ico_user+12) msg_request_save_no_clear
37557>>>    Send Add_ToolTip "„šš¨˜­ã (F12)"
37558>>>    Set  Status_Help To '‘éœ  «ž¤ «¨â®¦¬©˜ œšš¨˜­ã ©«¦ ˜¨®œå¦ ®à¨åª ¤˜ ¡˜Ÿ˜¨åœ  «˜ ›œ›¦£â¤˜ (F12)'
37559>>>
37559>>>    send Add_space
37560>>>
37560>>>    send Add_button ico_std_cut msg_cut
37561>>>    Send Add_ToolTip "€§¦¡¦§ã"
37562>>>    Set  Status_Help To "€§¦¡æ§«œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37563>>>
37563>>>    send Add_button ico_std_copy msg_copy
37564>>>    Send Add_ToolTip "€¤« š¨˜­ã"
37565>>>    Set  Status_Help To "€¤« š¨á­œ  «¦ œ§ ¢œš£â¤¦ ¡¦££á«  ¡˜  «¦ ¡¨˜«áœ  ©«¦ Clipboard"
37566>>>
37566>>>    send Add_button ico_std_paste msg_paste
37567>>>    Send Add_ToolTip "„ ©˜šàšã"
37568>>>    Set  Status_Help To "„ ©ášœ  §œ¨ œ®æ£œ¤˜ ˜§æ «¦ Clipboard"
37569>>>
37569>>>    //send Add_button (ico_user+19) msg_DoPrint
37569>>>    send Add_button ICO_STD_PRINT msg_DoPrint
37570>>>    Send Add_ToolTip "„¡«ç§à©ž"
37571>>>    Set  Status_Help To "„¡«¬§é©œ ª ‰œ £â¤à¤"
37572>>>
37572>>>    send Add_space              
37573>>>
37573>>>    //send Add_button (ico_user+20) msg_DoPrintScreen
37573>>>    send Add_button ICO_STD_PRINTPRE msg_DoPrintScreen
37574>>>    Send Add_ToolTip "„¡«ç§à©ž ¦Ÿæ¤žª"
37575>>>    Set  Status_Help To "„¡«ç§à©ž ¦Ÿæ¤žª ©«¦ Clipboard ã ©«¦¤ „¡«à§à«ã"
37576>>>    
37576>>>    Object oOutputSelector Is A ComboFormSub
37578>>>       Set Entry_State Item 0 to FALSE
37579>>>       Set Combo_Sort_State to FALSE
37580>>>       Set GuiLocation to 1 480
37581>>>       Set Size to 14 55
37582>>>       Set Status_Help to "„§â¢œ¥œ §¦¬ Ÿ˜ šå¤œ  ž œ¡«ç§à©ž «žª ¦Ÿæ¤žª"
37583>>>       Set Focus_Mode to Pointer_Only
37584>>>       Set Skip_State to True
37585>>>       
37585>>>       Procedure Combo_Fill_List
37587>>>       
37587>>>           Send Combo_Add_Item '„¡«¬§à«ãª'
37588>>>           Send Combo_Add_Item 'Clipboard'
37589>>>       
37589>>>       End_Procedure
37590>>>       
37590>>>       Procedure OnChange
37592>>>           String liValue
37593>>>           
37593>>>           Get Value Item 0 to liValue 
37594>>>           If (Combo_Value(Self,0) = liValue) Set piOutputDestination to 0
37597>>>           Else If (Combo_Value(Self,1) = liValue) Set piOutputDestination to 1
37601>>>       End_Procedure
37602>>>       
37602>>>    End_Object   // oReportSelector
37603>>>    
37603>>>    For WindowIndex from 1 to 12
37609>>>>
37609>>>        send Add_space              
37610>>>    Loop
37611>>>>
37611>>>
37611>>>    send Add_button (ico_user+7) msg_DoRebuild
37612>>>    Send Add_ToolTip "„§ › æ¨Ÿà©ž á©žª ƒœ›¦£â¤à¤"
37613>>>    Set  Status_Help To "€¤˜¡˜«˜©¡œ¬ã «à¤ ˆndexes (Reindex) ¡˜  ¡˜Ÿ˜¨ ©£æª «¦¬ª (CleanUp) ˜¤ ®¨œ áœ«˜ "
37614>>>
37614>>>    send Add_button (ico_user+18) msg_DoPopupCalc
37615>>>    Send Add_ToolTip "€¨ Ÿ£¦£ž®˜¤ã"
37616>>>    Set  Status_Help To ""
37617>>>
37617>>>    send Add_button (ico_user+21) msg_DoPopupSetup
37618>>>    Send Add_ToolTip "Setup Client"
37619>>>    Set  Status_Help To "Machine Settings Network Parameter"
37620>>>
37620>>>    send Add_space
37621>>>
37621>>>    send Add_button ico_std_properties msg_DoShowPropertiesPage
37622>>>    Send Add_ToolTip "ˆ› æ«ž«œª"
37623>>>    Set  Status_Help To "ˆ› æ«ž«œª ¡˜  ®˜¨˜¡«ž¨ ©« ¡á «žª œ­˜¨£¦šãª"
37624>>>
37624>>>    send Add_button ico_std_help msg_Help_On_Topic
37625>>>    Send Add_ToolTip "¦ãŸœ ˜ (F1)"
37626>>>    Set  Status_Help To "‰¢ã©ž ©¬©«ã£˜«¦ª ™¦žŸœå˜ª (F1)"
37627>>>
37627>>>    send Add_space
37628>>>
37628>>>    send Add_button (ico_user+13) msg_Exit_Application
37629>>>    Send Add_ToolTip "„¥¦›¦ª (Alt+F4)"
37630>>>    Set  Status_Help To "„¥¦›¦ ˜§æ „­˜¨£¦šã (Alt+F4)"
37631>>>
37631>>>    Procedure DoPrintScreen
37633>>>        Integer iVoid aiWhereTo
37634>>>        
37634>>>        Get piOutputDestination to aiWhereTo
37635>>>        If (aiWhereTo = 0) Send Print_Screen to Desktop ""
37638>>>        Else If (aiWhereTo = 1) Move (Keybd_Event(VK_SNAPSHOT, 0, 0, 0)) To iVoid
37642>>>    End_Procedure
37643>>>
37643>>>
37643>>>    Procedure Redirect_Button_Message integer Itm
37645>>>        Integer msg# liObj liCls
37646>>>        
37646>>>        Get Message   item itm  to Msg#
37647>>>        If (Msg_DoRebuild = Msg#)  Send DoRebuild
37650>>>        Else If (msg_Help_On_Topic = Msg#) Send Help_On_Topic
37654>>>        Else If (msg_Exit_Application = Msg#) Send Exit_Application
37658>>>        Else If (msg_DoPopupCalc = Msg#) Send DoPopupCalc
37662>>>        Else If (msg_DoPrintScreen = Msg#) Send DoPrintScreen
37666>>>        Else If (msg_DoShowPropertiesPage = Msg#) Send DoShowPropertiesPage
37670>>>        Else If (msg_DoPopupSetup = Msg#) Send DoPopupSetup
37674>>>        Else Forward Send Redirect_Button_Message Itm
37677>>>    End_Procedure // Redirect_Message
37678>>>
37678>>>    Procedure DoChangeToolBarIcon Integer iItem Integer iImageIndex
37680>>>        Integer hoClient
37681>>>        
37681>>>        Delegate Get Client_Id To hoClient
37683>>>        Delegate Set Client_Id To 0
37685>>>        //----Changes the Icon
37685>>>        //Set Toolbar_State To False
37685>>>        //Set Form_Image_Index Item iItem To iImageIndex
37685>>>        //Set Toolbar_State To True
37685>>>        //----Changes the Shadow_State
37685>>>        Set Shadow_State Item iItem To iImageIndex
37686>>>        Delegate Set Client_Id To hoClient
37688>>>    End_Procedure // DoChangeToolBarIcon
37689>>>
37689>>>    Procedure Page_Object Integer iState
37691>>>      Integer hoCurrentObject
37692>>>      
37692>>>      Forward Send Page_Object iState
37694>>>      Move (Self) to hoCurrentObject
37695>>>      Send Add_Focus To (oOutputSelector(SELF)) hoCurrentObject
37696>>>    End_Procedure   // Page_Object
37697>>>
37697>>>    
37697>>>    Procedure Page Integer iState
37699>>>        Forward Send Page iState
37701>>>        Set Shadow_State Item 40 to (piPropertiesObjectId(Main_Menu(Self))=0)
37702>>>        If iState Begin
37704>>>             //Set Timer_Active_State Of (oToolBarTimer (Self)) To True
37704>>>        End
37704>>>>
37704>>>    End_Procedure
37705>>>    
37705>>>//    Object oToolBarTimer Is A DfTimer
37705>>>//        Procedure OnTimer
37705>>>//           Local Integer hoFocus bIsDeo bState hoToolBar bIsModal
37705>>>//           
37705>>>//           Get Focus To hoFocus
37705>>>//           If hoFocus Gt Desktop Begin
37705>>>//                Get Is_Function Get_Modal_State hoFocus Dftrue To bIsModal
37705>>>//                // **WvA: 11-10-1999, we should not check the DEO object any more if 
37705>>>//                //                    if it is a modal panel, this could throw up error messages.
37705>>>//                If (bIsModal = DfFalse) Begin
37705>>>//                  Get Is_Function Get_DEO_Object hoFocus Dftrue To bIsDeo
37705>>>//                End
37705>>>//                Move (bIsDeo = Dffalse Or bIsModal = Dftrue) To bState
37705>>>//                Move (Parent (Self)) To hoToolBar
37705>>>//                If (pbToolbarWasDisabled (hoToolBar)) Ne bState Begin
37705>>>//                   Set pbToolbarWasDisabled Of hoToolBar To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 0 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 1 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 2 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 3 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 5 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 6 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 7 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 9 To bState
37705>>>//                   Set Shadow_State Of hoToolBar Item 10 To bState
37705>>>//                End
37705>>>//           End
37705>>>//       End_Procedure // OnTimer
37705>>>//   End_Object // oToolBarTimer
37705>>>   
37705>>>End_Object
37706>>>
37706>>>
37706>    
37706>    Object Client_Area is a AppClientAreasub
37708>
37708>        //AB-ClientStoreTopStart
37708>        
37708>        Function GetTheWorkSpace returns String
37710>            String lsWorkSpace
37711>            get_profile_string "WorkSpaces" "CurrentWorkspace" to lsWorkSpace
37714>            If lsWorkSpace eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to lsWorkSpace
37717>            insert "WorkSpaces\" in lsWorkSpace at 1
37719>            Function_Return lsWorkSpace
37720>        End_Function
37721>        
37721>        Function GetTheAppPath Returns String
37723>           String lsWorkSpace lsModule lsTheAppPath
37724>           Move (GetTheWorkSpace(Self)) to lsWorkSpace
37725>           Move (Module_Name(Self)) to lsModule
37726>           Move (lsWorkSpace + "\" + lsModule) to lsTheAppPath
37727>           Function_Return lsTheAppPath
37728>        End_Function
37729>        
37729>        
37729>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
37729>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
37729>        String Plhktro_SI   Plhktro_DC2     //condesed
37729>        String Plhktro_PAV                  //underline
37729>        String Plhktro_EEE  Plhktro_FFF     //emphasized
37729>        String Plhktro_GGG  Plhktro_HHH     //double strike
37729>        String Plhktro_WWW                  //expanded
37729>        string Plhktro_Q Plhktro_160
37729>        
37729>        External_Function32 MyScriptExec "ScriptExec" ScriptExecute.dll ;            String  ssFile  String  ssODBC Returns Integer
37730>        
37730>        Integer giviewid
37730>        String  gsviewname
37730>        
37730>        Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
37730>>>
37730>>>Open Sysfile
37732>>>Open UserGrps
37734>>>Open Users
37736>>>Open Views
37738>>>Open GrpViews
37740>>>Open Arxeia
37742>>>Open GrpArx
37744>>>Open GrpArx0
37746>>>Open GrpView0
37748>>>
37748>>>Use DD.Sub
37748>>>
37748>>>Class Datadictionary_Sec  Is A DatadictionarySub
37749>>>
37749>>>
37749>>>    Procedure Construct_Object
37750>>>        Forward Send Construct_Object
37752>>>        Property Integer cpiUpdate              0
37753>>>        Property Integer cpiBackout             0
37754>>>        Property Integer cpiEditing             0
37755>>>        Property Integer cpiFileNumber          0
37756>>>        Property String  cpsFileName            ''
37757>>>        Property String  cpsLoginID             ''
37758>>>        Property Integer cpiCannot_Read         0
37759>>>        Property Integer cpiCannot_Create       0
37760>>>        Property Integer cpiCannot_Delete       0
37761>>>        Property Integer cpiCannot_Edit         0
37762>>>        Property Integer piFN                   0
37763>>>    End_Procedure
37764>>>
37764>>>//    Procedure Save_Main_File
37764>>>//        If (Operation_Origin<>Self) Begin
37764>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
37764>>>//        End
37764>>>//        Forward Send Save_Main_File
37764>>>//    End_Procedure
37764>>>
37764>>>
37764>>>
37764>>>    Function Validate_Save Returns Integer
37765>>>        Integer rVal
37766>>>        Forward Get Validate_Save to rVal
37768>>>        If (Not(rVal)) Begin
37770>>>            Get cpiCannot_Read to rVal
37771>>>            If (Not(rVal)) Begin
37773>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
37774>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
37777>>>                Else                    Get cpiCannot_Create    to rVal
37779>>>            End
37779>>>>
37779>>>            If (rVal) Send Operation_Not_Allowed rVal
37782>>>        End
37782>>>>
37782>>>        Function_Return rVal
37783>>>    End_Function
37784>>>
37784>>>    Function Validate_Delete Returns Integer
37785>>>        Integer rVal
37786>>>        Forward Get Validate_Delete to rVal
37788>>>        If (Not(rVal)) Begin
37790>>>            Get cpiCannot_Read to rVal
37791>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
37794>>>            If (rVal) Send Operation_Not_Allowed rVal
37797>>>        End
37797>>>>
37797>>>        Function_Return rVal
37798>>>    End_Function
37799>>>
37799>>>    Procedure End_Construct_Object
37800>>>        Integer liSrv rVal
37801>>>        String lsStr
37801>>>        Forward Send End_Construct_Object
37803>>>        Get Main_File                                   To liSrv
37804>>>        Set cpiFileNumber                               To liSrv
37805>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
37808>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
37809>>>        Set cpsLoginID                                  To (fsLoginUserID())
37810>>>        Send Find_User_Rights
37811>>>        Set piFN to lisrv
37812>>>    End_Procedure
37813>>>
37813>>>    Procedure Find_User_Rights
37814>>>        String lsArxeio lsLogin
37815>>>        Integer liUser liArxeio iGroup
37815>>>
37815>>>        Get cpiFileNumber   to liArxeio
37816>>>        Get cpsFileName     to lsArxeio
37817>>>        Get cpsLoginID      to lsLogin
37818>>>
37818>>>        Clear Users
37819>>>        Move lsLogin    to Users.Login_ID
37820>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
37821>>>>
37821>>>        If (Found=1)  Begin
37823>>>            Move Users.User_ID  to liUser
37824>>>            Move Users.Grp_ID   to iGroup
37825>>>        End
37825>>>>
37825>>>        //Else Send Operation_Not_Allowed 9999
37825>>>
37825>>>        Clear Arxeia
37826>>>
37826>>>        Move liArxeio to Arxeia.Arxeio_ID
37827>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
37828>>>>
37828>>>
37828>>>        If (Found=1) Begin
37830>>>            Move Arxeia.Arxeio_ID to liArxeio
37831>>>
37831>>>            Clear GrpArx
37832>>>            Move liUser     to GrpArx.User_ID
37833>>>            Move liArxeio   to GrpArx.Arxeio_ID
37834>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
37835>>>>
37835>>>            If (Found=1) Begin
37837>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
37840>>>               Else                         Set cpiCannot_Read   to 10003
37842>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
37845>>>               Else                         Set cpiCannot_Create to 10000
37847>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
37850>>>               Else                         Set cpiCannot_Edit   to 10001
37852>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
37855>>>               Else                         Set cpiCannot_Delete to 10002
37857>>>            End
37857>>>>
37857>>>            Else Begin
37858>>>                Clear GrpArx0
37859>>>                Move iGroup   to GrpArx0.Group_ID
37860>>>                Move liArxeio to GrpArx0.Arxeio_ID
37861>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
37862>>>>
37862>>>                If (Found=1) Begin
37864>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
37867>>>                    Else                            Set cpiCannot_Read   to 20003
37869>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
37872>>>                    Else                            Set cpiCannot_Create to 20000
37874>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
37877>>>                    Else                            Set cpiCannot_Edit   to 20001
37879>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
37882>>>                    Else                            Set cpiCannot_Delete to 20002
37884>>>                End
37884>>>>
37884>>>                Else Begin
37885>>>                    Set cpiCannot_Read   to 0
37886>>>                    Set cpiCannot_Edit   to 0
37887>>>                    Set cpiCannot_Create to 0
37888>>>                    Set cpiCannot_Delete to 0
37889>>>                End
37889>>>>
37889>>>            End
37889>>>>
37889>>>        End
37889>>>>
37889>>>        Else Begin
37890>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
37890>>>            Set cpiCannot_Read   to 0
37891>>>            Set cpiCannot_Edit   to 0
37892>>>            Set cpiCannot_Create to 0
37893>>>            Set cpiCannot_Delete to 0
37894>>>        End
37894>>>>
37894>>>    End_Procedure
37895>>>
37895>>>    Procedure Clear_main_file
37896>>>        Forward Send Clear_main_file
37898>>>        Set cpiBackout to 0
37899>>>        Set cpiUpdate  to 0
37900>>>    End_Procedure
37901>>>
37901>>>    Procedure Update
37902>>>        Forward Send Update
37904>>>        Set cpiUpdate to 1
37905>>>    End_Procedure
37906>>>
37906>>>    Procedure Backout
37907>>>        Forward Send Backout
37909>>>        Set cpiBackout to 1
37910>>>    End_Procedure
37911>>>
37911>>>    Procedure OnConstrain
37912>>>        Integer rVal liSrv
37913>>>        Forward Send OnConstrain
37915>>>        Get cpiFileNumber  To liSrv
37916>>>        Move liSrv         To Filenumber
37917>>>        Get cpiCannot_Read to rVal
37918>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
37922>>>    End_Procedure
37923>>>
37923>>>    Procedure Operation_Not_Allowed  Integer iError_Num
37924>>>        String sLektiko
37925>>>        Move '' to sLektiko
37926>>>
37926>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37929>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
37933>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37937>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
37941>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37945>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
37949>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37953>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
37957>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
37961>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
37965>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
37969>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
37973>>>
37973>>>             If iError_Num eq 10000 Error 10000 sLektiko
37976>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
37980>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
37984>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
37988>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
37992>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
37996>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
38000>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
38004>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
38008>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
38012>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
38016>>>
38016>>>        Else Forward Send Operation_Not_Allowed  iError_Num
38019>>>    End_Procedure   // Operation_Not_Allowed
38020>>>
38020>>>
38020>>>End_Class //Datadictionary_Sec
38021>        use dbviews.sub
INCLUDING FILE: DBVIEWS.SUB
38021>>>
38021>>>Class DbviewSubs Is A DbviewSub
38022>>>
38022>>>    Procedure Construct_Object
38023>>>        Integer iPos iCount
38024>>>        Forward Send Construct_Object
38026>>>
38026>>>        Property String     psMyViewName    Public ''
38027>>>        Property Integer    piMyViewID      Public  0
38028>>>
38028>>>        Get Name            to gsViewName
38029>>>        Get Object_ID       to giViewID
38030>>>
38030>>>        Move 0 to iPos
38031>>>        For iCount From 1 to (Length(gsViewName))
38037>>>>
38037>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
38040>>>        Loop
38041>>>>
38041>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
38042>>>        Move (Trim(gsViewName)) to gsViewName
38043>>>
38043>>>        Set psMyViewName    to (Trim(gsViewName))
38044>>>        Set piMyViewID      to giViewID
38045>>>
38045>>>    End_Procedure
38046>>>
38046>>>    Procedure End_Construct_Object
38047>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
38048>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
38048>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
38048>>>
38048>>>        Forward Send End_Construct_Object
38050>>>
38050>>>
38050>>>        Get psMyViewName        to gsViewName
38051>>>        Get piMyViewID          to giViewID
38052>>>        Get Label Of giViewID   to sViewLabel
38053>>>        Move (Trim(sViewLabel)) to sViewLabel
38054>>>
38054>>>        Clear Oth
38055>>>        Move gsViewName to Oth.View_Name
38056>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
38057>>>>
38057>>>        If (Not(Found)) Begin
38059>>>            Move sViewLabel to Oth.View_Label
38060>>>            Move giViewID    to Oth.View_ID
38061>>>            Saverecord Oth
38062>>>        End
38062>>>>
38062>>>
38062>>>    End_Procedure //End_Construct_Object
38063>>>
38063>>>End_Class //dbviewSubs
38064>>>
38064>>>
38064>        use dbforms.sub
INCLUDING FILE: DBFORMS.SUB
38064>>>
38064>>>Class dbFormSubs Is a dbFormSub
38065>>>
38065>>>//    Register_Procedure Set psMyViewName
38065>>>//    Register_Function      psMyViewName Returns String
38065>>>//    Register_Procedure Set piMyViewID
38065>>>//    Register_Function      piMyViewID   Returns Integer
38065>>>
38065>>>    Procedure End_Construct_Object
38066>>>        Integer iFileNumber iFieldNumber iServer
38067>>>        Integer iPos icount iColor iFieldStatus iFileNumber2
38067>>>        String  sStr sDbFormName sViewLabel
38067>>>
38067>>>        Forward Send End_Construct_Object
38069>>>
38069>>>        //If (SysRec.Scr_Fld_Lock='1') Begin
38069>>>
38069>>>            Get Name            to sDbFormName
38070>>>            Get psMyViewName    to gsViewName
38071>>>            Get piMyViewID      to giViewID
38072>>>
38072>>>            Move 0 to iPos
38073>>>            For iCount From 1 to (Length(sDbFormName))
38079>>>>
38079>>>                If (Mid(sDbFormName,1,iCount)='.') Move iCount to iPos
38082>>>            Loop
38083>>>>
38083>>>            Move (Right(sDbFormName,(Length(sDbFormName)-iPos))) to sDbFormName
38084>>>            Move (Trim(sDbFormName)) to sDbFormName
38085>>>
38085>>>            Move (Trim(gsViewName)) to gsViewName
38086>>>
38086>>>            Clear Oth
38087>>>            Move gsViewName to Oth.View_Name
38088>>>            Find eq Oth By Index.2 // Oth:Index.2:View_Name
38089>>>>
38089>>>            Move Oth.View_Label to sViewLabel
38090>>>            Move (Trim(sViewLabel)) to sViewLabel
38091>>>
38091>>>            Clear ViewFlds
38092>>>            Move gsViewName     to ViewFlds.View_Name
38093>>>            Move sDbFormName    to ViewFlds.Scr_Field_Name
38094>>>            Find eq ViewFlds By Index.1 // ViewFlds:Index.1:View_Name+Scr_Field_Name
38095>>>>
38095>>>            If (Not(Found)) Begin
38097>>>                Reread Sysrec
INCLUDING FILE: SYSREC.FD
38101>>>                Move (SysRec.Viewflds_Rec0+1) to ViewFlds.ViewFlds_Rec0
38102>>>                Move (SysRec.Viewflds_Rec0+1) to SysRec.ViewFlds_Rec0
38103>>>                Saverecord SysRec
38104>>>                UnLock
38105>>>>
38105>>>                Move sViewLabel to ViewFlds.View_Label
38106>>>                Saverecord ViewFlds
38107>>>            End
38107>>>>
38107>>>            Else If ((Trim(ViewFlds.View_Label)='') And (sViewLabel<>'')) Begin
38110>>>                Reread ViewFlds
38114>>>                Move sViewLabel to ViewFlds.View_Label
38115>>>                Saverecord ViewFlds
38116>>>                Unlock
38117>>>>
38117>>>            End
38117>>>>
38117>>>            Move (fiScreenFieldStatus(gsViewName,sDbFormName))  to iFieldStatus
38118>>>
38118>>>
38118>>>        // iFieldStatus=0 ==> EVERYTHING IS ALLOWED
38118>>>        // iFieldStatus=1 ==> NO READ ALLOWED
38118>>>        // iFieldStatus=2 ==> NO EDIT BUT CAN COPY
38118>>>        // iFieldStatus=3 ==> NO EDIT AND NO COPY
38118>>>        If (Not(iFieldStatus)) Begin
38120>>>            ////// Field is NORMAL ////////
38120>>>        End
38120>>>>
38120>>>        Else Begin
38121>>>            If (iFieldStatus=1) Begin
38123>>>                ////// Field is NO DISPLAY ////////
38123>>>                Set Enabled_State   Item 0 to False
38124>>>                Set Entry_State     Item 0 to False
38125>>>                Get Color                  to iColor
38126>>>                Set TextColor              to iColor
38127>>>            End
38127>>>>
38127>>>            Else Begin
38128>>>                If (iFieldStatus=2) Begin
38130>>>                    ////// Field is NO EDIT  /////////
38130>>>                    Get Server                                      to iServer
38131>>>                    Get Data_File   Item 0                          to iFileNumber
38132>>>                    If (iServer) Get piFN of iServer                to iFileNumber2
38135>>>
38135>>>                    // €¤ ¦ server œå¤˜  › ˜­¦¨œ« ¡æª ˜§¦ «¦¤ ˜¨ Ÿ£¦ «¦¬ datafile «¦¬ §œ› ¦¬
38135>>>                    // «¦«œ «¦ §œ›å¦ œå¤˜  £§˜£§áª ¡˜  «¦ Noput ›œ¤ §˜ œ  ¦§¦«œ ¡æ™¦¬£œ «¦ Enter
38135>>>                    If (iFileNumber=iFileNumber2)   Set Item_Option Item 0  to Noput True
38138>>>                    Else                            Set Item_Option Item 0  to NoEnter True
38140>>>                End
38140>>>>
38140>>>                Else Begin
38141>>>                    If (iFieldStatus=3) Begin
38143>>>                        ////// Field is NO EDIT AND NO COPY     /////////
38143>>>                        Set Enabled_State   Item 0 to False
38144>>>                        Set Entry_State     Item 0 to False
38145>>>                        Set Shadow_State    Item 0 to True
38146>>>                    End
38146>>>>
38146>>>                End
38146>>>>
38146>>>            End
38146>>>>
38146>>>        End
38146>>>>
38146>>>     End_Procedure
38147>>>
38147>>>End_Class //DbformSubs
38148>>>
38148>        
38148>        Use Stbarpsc.pkg
INCLUDING FILE: STBARPSC.PKG
38148>>>Use DFStatBr.pkg
38148>>>
38148>>>Class BasicPanelStatusBarSub is a BasicStatusBar
38149>>>
38149>>>    Procedure Construct_Object
38150>>>        Forward Send Construct_Object
38152>>>        Property Integer Status_Help_Item Public 0
38153>>>        Property Integer Menu_Simple_State public TRUE
38154>>>        Property Integer Menu_status_State public False
38155>>>        Property Integer Old_Simple_State  public false
38156>>>        Property String  Old_Status_Value  public ''
38157>>>        Set Attach_Parent_State To TRUE
38158>>>        Delegate Set StatusBar_id To Self
38160>>>    End_Procedure
38161>>>
38161>>>    Procedure SET Status_Help_Value String sHelp
38162>>>        Local Integer iPart
38163>>>        Get Status_Help_Item To iPart
38164>>>        Set Value item iPart To sHelp
38165>>>    End_Procedure
38166>>>
38166>>>    Function Status_Help_Value Returns String
38167>>>        Local Integer iPart
38168>>>        Local String sHelp
38168>>>        Get Status_Help_Item To iPart
38169>>>        Get Value item iPart To sHelp
38170>>>        Function_Return sHelp
38171>>>    End_Procedure
38172>>>
38172>>>    Procedure Initialize_Menu
38173>>>       Local integer iState OldState
38174>>>       If Not (Menu_Status_state(Self)) Begin
38176>>>          Get Simple_State to OldState
38177>>>          Set Old_Simple_State to OldState
38178>>>          If OldState   Set Old_Status_Value to (Simple_Value(Self))
38181>>>          Else          Set Old_Status_Value to (Status_Help_Value(Self))
38183>>>          Set Simple_State to (Menu_Simple_State(Self))
38184>>>          Set Menu_Status_State to TRUE
38185>>>       End
38185>>>>
38185>>>    End_Procedure
38186>>>
38186>>>    Procedure Exit_Menu
38187>>>       Local Integer OldState
38188>>>       Local String OldVal
38188>>>       If (Menu_Status_state(Self)) Begin
38190>>>          Get Old_Simple_State to OldState
38191>>>          Set Simple_State     to OldState
38192>>>          Get old_status_Value to oldVal
38193>>>          If OldState ;             Set Simple_Value to OldVal
38196>>>          Else ;             Set Status_Help_Value to OldVal
38198>>>          Set Menu_Status_State to FALSE
38199>>>       End
38199>>>>
38199>>>    End_Procedure // Exit_Menu
38200>>>
38200>>>    Procedure Show_Status_Help String sHelp
38201>>>        Local Integer iState
38202>>>        Get Simple_State to iState
38203>>>        If NOT iState Set Status_Help_Value To sHelp
38206>>>        Else          Set Simple_Value      To sHelp
38208>>>    End_Procedure
38209>>>
38209>>>    Function Current_Status_Help Returns String
38210>>>        Local Integer iState
38211>>>        Local String sHelp
38211>>>        Get Simple_State to iState
38212>>>        If NOT iState Get Status_Help_Value To sHelp
38215>>>        Else          Get Simple_Value      To sHelp
38217>>>        Function_Return sHelp
38218>>>    End_Function
38219>>>
38219>>>
38219>>>End_Class
38220>        
38220>        Open Nomisma
38222>        Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
38224>        
38224>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
38225>        
38225>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
38226>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
38226>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
38226>            String  sCode
38226>        
38226>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
38229>        
38229>            Clear Nomisma
38230>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
38231>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38232>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
38233>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
38234>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
38235>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
38236>            Move Nomisma.Dekadika       to iDekadika_Apo
38237>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
38237>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
38239>                If (adHmnia='') Sysdate            adHmnia
38242>                Move (Trim(asNomismaCodeApo))   to sCode
38243>                Clear Isotimia
38244>                Move sCode                      to Isotimia.Nomisma_Code
38245>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38246>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38247>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
38248>            End
38248>        
38248>            Clear Nomisma
38249>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
38250>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
38251>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
38252>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
38253>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
38254>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
38255>            Move Nomisma.Dekadika       to iDekadika_Se
38256>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
38256>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
38258>                If (adHmnia='') Sysdate            adHmnia
38261>                Move (Trim(asNomismaCodeSe))    to sCode
38262>                Clear Isotimia
38263>                Move sCode                      to Isotimia.Nomisma_Code
38264>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
38265>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
38266>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
38267>            End
38267>        
38267>            Calc (anPoso/nApo_Euro_Isot) to rVal
38268>            Move (Round_Number(rVal,6)) to rVal
38269>            Calc (rVal*nSe_Euro_Isot) to rVal
38270>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
38271>        
38271>            Function_Return rVal
38272>        End_Function
38273>        
38273>        Register_Object oStatusBarSub
38273>        
38273>        Open Syscurxr
38275>        Open SysFile
38277>        Open Sysrecc
INCLUDING FILE: SYSRECC.FD
38279>        Open Sysrecb
INCLUDING FILE: SYSRECB.FD
38281>        Open Sysrecw
INCLUDING FILE: SYSRECW.FD
38283>        
38283>        Procedure Reset_All_Files_Except_System
38285>            Local Integer File# Open# File_Number# liInt iMax iWait isSystem
38286>            Local String Physicalname# DisplayName# Logicalname# Rootname#
38286>            Move 0 To File#
38287>            Repeat
38287>              Get_Attribute Df_File_Next_Opened Of File# To File#
38290>              If (File#) Begin
38292>                Get_Attribute DF_FILE_IS_SYSTEM_FILE    Of File# To isSystem
38295>                If (NOT(isSystem)) Clear File#
38298>              End
38298>            Until File# Eq 0
38300>        End_Procedure
38301>        use v037.vw
INCLUDING FILE: V037.VW
38301>>>//AB/ Project V037:BAXIO
38301>>>//AB/ Object prj is a View_Project
38301>>>//AB/     Set ProjectName to "V037:BAXIO"
38301>>>//AB/     Set ProjectFileName to "V037.VW"
38301>>>
38301>>>// Project Object Structure
38301>>>//   VW037 is a dbViewSub
38301>>>//     Btypkin_DD is a DataDictionary
38301>>>//     Baxiokat_DD is a DataDictionary
38301>>>//     Barticl_DD is a DataDictionary
38301>>>//     Baxio_DD is a DataDictionary
38301>>>//     Syscurxr_DD is a DataDictionary
38301>>>//     Bmove_DD is a DataDictionary
38301>>>//     Baxiokat_Baxiokat_Code is a dbFormSub
38301>>>//     Baxiokat_Baxiokat_Descr is a dbFormSub
38301>>>//     Baxio_Baxio_Code is a dbFormSub
38301>>>//     Baxio_Baxio_Status is a dbFormSub
38301>>>//     Baxio_Baxio_Place is a dbFormSub
38301>>>//     dbTbDlgAxio is a dbTabDialogSub
38301>>>//       TP_Additional is a dbTabPage
38301>>>//         dbGrpObligate is a dbGroupSub
38301>>>//           Baxio_Baxio_Hmnial is a dbFormSub
38301>>>//           Baxio_Baxio_V4 is a dbFormSub
38301>>>//           Rate0 is a dbFormSub
38301>>>//           Rate00 is a dbFormSub
38301>>>//           RateR is a dbFormSub
38301>>>//           TextBoxSub3 is a TextBoxSub
38301>>>//           TextBoxSub4 is a TextBoxSub
38301>>>//           TextBoxSub5 is a TextBoxSub
38301>>>//           txtnom1 is a TextBoxSub
38301>>>//           txtnom2 is a TextBoxSub
38301>>>//           txtnom3 is a TextBoxSub
38301>>>//           Baxio_Baxio_C_Code2 is a dbFormSub
38301>>>//         dbGrpOptional is a dbGroupSub
38301>>>//           Baxio_Baxio_Ekdoths is a dbFormSub
38301>>>//           Baxio_Baxio_Ekdothse is a dbFormSub
38301>>>//           Baxio_Baxio_Sediatagh is a dbFormSub
38301>>>//           Baxio_Baxio_Sdiataghe is a dbFormSub
38301>>>//           Baxio_Baxio_Banka is a dbComboFormSub
38301>>>//           Baxio_Baxio_No is a dbFormSub
38301>>>//           Baxio_Baxio_From is a dbComboFormSub
38301>>>//           Baxio_Baxio_Topos is a dbComboFormSub
38301>>>//           Baxio_Baxio_Opistho is a dbEditSub
38301>>>//           TextBoxSub6 is a TextBoxSub
38301>>>//           TextBoxSub7 is a TextBoxSub
38301>>>//           TextBoxSub8 is a TextBoxSub
38301>>>//           TextBoxSub9 is a TextBoxSub
38301>>>//           TextBoxSub10 is a TextBoxSub
38301>>>//           TextBoxSub11 is a TextBoxSub
38301>>>//           TextBoxSub12 is a TextBoxSub
38301>>>//           Textbox3 is a Textbox
38301>>>//           Textbox4 is a Textbox
38301>>>//       TP_Status is a dbTabPage
38301>>>//         dbGrpEispraktea is a dbGroupSub
38301>>>//           Baxio_Baxio_Fbarticl is a dbFormSub
38301>>>//           Baxio_Baxio_Code_In is a dbFormSub
38301>>>//           Baxio_Baxio_Epon_In is a dbFormSub
38301>>>//           dbFrmHmnia is a dbFormSub
38301>>>//           dbFrmNo is a dbFormSub
38301>>>//           dbFrmGtypkin is a dbFormSub
38301>>>//           TextBoxSub18 is a TextBoxSub
38301>>>//           TextBoxSub19 is a TextBoxSub
38301>>>//           TextBoxSub24 is a TextBoxSub
38301>>>//           TextBoxSub27 is a TextBoxSub
38301>>>//           TextBoxSub30 is a TextBoxSub
38301>>>//         dbGrpPlhrotea is a dbGroupSub
38301>>>//           Baxio_Baxio_Lbarticl is a dbFormSub
38301>>>//           Baxio_Baxio_Code_Out is a dbFormSub
38301>>>//           Baxio_Baxio_Epon_Out is a dbFormSub
38301>>>//           dbFrmHmnia is a dbFormSub
38301>>>//           dbFrmNo is a dbFormSub
38301>>>//           dbFrmGtypkin is a dbFormSub
38301>>>//           TextBoxSub20 is a TextBoxSub
38301>>>//           TextBoxSub21 is a TextBoxSub
38301>>>//           TextBoxSub25 is a TextBoxSub
38301>>>//           TextBoxSub28 is a TextBoxSub
38301>>>//           TextBoxSub31 is a TextBoxSub
38301>>>//         dbGrpCurrentStat is a dbGroupSub
38301>>>//           Baxio_Baxio_Lcode is a dbFormSub
38301>>>//           Baxio_Baxio_Lepon is a dbFormSub
38301>>>//           Baxio_Baxio_Lpar is a dbFormSub
38301>>>//           dbFrmHmnia is a dbFormSub
38301>>>//           dbFrmNo is a dbFormSub
38301>>>//           dbFrmGtypkin is a dbFormSub
38301>>>//           TextBoxSub22 is a TextBoxSub
38301>>>//           TextBoxSub23 is a TextBoxSub
38301>>>//           TextBoxSub26 is a TextBoxSub
38301>>>//           TextBoxSub29 is a TextBoxSub
38301>>>//           TextBoxSub32 is a TextBoxSub
38301>>>//       TP_Bmove is a dbTabPage
38301>>>//         grdBmove is a dbGridSub
38301>>>//     dbGrpYear is a dbGroupSub
38301>>>//       Company_Company_Name is a dbFormSub
38301>>>//       Branch_Branch_Name is a dbFormSub
38301>>>//       Year_Year_Year is a dbFormSub
38301>>>//       otxtCompany is a TextBoxSub
38301>>>//       otxtBranch is a TextBoxSub
38301>>>//       otxtYear is a TextBoxSub
38301>>>//     TextBoxSub1 is a TextBoxSub
38301>>>//     TextBoxSub2 is a TextBoxSub
38301>>>//     TextBoxSub13 is a TextBoxSub
38301>>>//     TextBoxSub14 is a TextBoxSub
38301>>>
38301>>>// Register all objects
38301>>>Register_Object Barticl_DD
38301>>>Register_Object Baxio_Baxio_Banka
38301>>>Register_Object Baxio_Baxio_C_Code2
38301>>>Register_Object Baxio_Baxio_Code
38301>>>Register_Object Baxio_Baxio_Code_In
38301>>>Register_Object Baxio_Baxio_Code_Out
38301>>>Register_Object Baxio_Baxio_Ekdoths
38301>>>Register_Object Baxio_Baxio_Ekdothse
38301>>>Register_Object Baxio_Baxio_Epon_In
38301>>>Register_Object Baxio_Baxio_Epon_Out
38301>>>Register_Object Baxio_Baxio_Fbarticl
38301>>>Register_Object Baxio_Baxio_From
38301>>>Register_Object Baxio_Baxio_Hmnial
38301>>>Register_Object Baxio_Baxio_Lbarticl
38301>>>Register_Object Baxio_Baxio_Lcode
38301>>>Register_Object Baxio_Baxio_Lepon
38301>>>Register_Object Baxio_Baxio_Lpar
38301>>>Register_Object Baxio_Baxio_No
38301>>>Register_Object Baxio_Baxio_Opistho
38301>>>Register_Object Baxio_Baxio_Place
38301>>>Register_Object Baxio_Baxio_Sdiataghe
38301>>>Register_Object Baxio_Baxio_Sediatagh
38301>>>Register_Object Baxio_Baxio_Status
38301>>>Register_Object Baxio_Baxio_Topos
38301>>>Register_Object Baxio_Baxio_V4
38301>>>Register_Object Baxio_DD
38301>>>Register_Object Baxiokat_Baxiokat_Code
38301>>>Register_Object Baxiokat_Baxiokat_Descr
38301>>>Register_Object Baxiokat_DD
38301>>>Register_Object Bmove_DD
38301>>>Register_Object Branch_Branch_Name
38301>>>Register_Object Btypkin_DD
38301>>>Register_Object Company_Company_Name
38301>>>Register_Object dbFrmGtypkin
38301>>>Register_Object dbFrmHmnia
38301>>>Register_Object dbFrmNo
38301>>>Register_Object dbGrpCurrentStat
38301>>>Register_Object dbGrpEispraktea
38301>>>Register_Object dbGrpObligate
38301>>>Register_Object dbGrpOptional
38301>>>Register_Object dbGrpPlhrotea
38301>>>Register_Object dbGrpYear
38301>>>Register_Object dbTbDlgAxio
38301>>>Register_Object grdBmove
38301>>>Register_Object otxtBranch
38301>>>Register_Object otxtCompany
38301>>>Register_Object otxtYear
38301>>>Register_Object Rate0
38301>>>Register_Object Rate00
38301>>>Register_Object RateR
38301>>>Register_Object Syscurxr_DD
38301>>>Register_Object TextBoxSub1
38301>>>Register_Object TextBoxSub10
38301>>>Register_Object TextBoxSub11
38301>>>Register_Object TextBoxSub12
38301>>>Register_Object TextBoxSub13
38301>>>Register_Object TextBoxSub14
38301>>>Register_Object TextBoxSub18
38301>>>Register_Object TextBoxSub19
38301>>>Register_Object TextBoxSub2
38301>>>Register_Object TextBoxSub20
38301>>>Register_Object TextBoxSub21
38301>>>Register_Object TextBoxSub22
38301>>>Register_Object TextBoxSub23
38301>>>Register_Object TextBoxSub24
38301>>>Register_Object TextBoxSub25
38301>>>Register_Object TextBoxSub26
38301>>>Register_Object TextBoxSub27
38301>>>Register_Object TextBoxSub28
38301>>>Register_Object TextBoxSub29
38301>>>Register_Object TextBoxSub3
38301>>>Register_Object TextBoxSub30
38301>>>Register_Object TextBoxSub31
38301>>>Register_Object TextBoxSub32
38301>>>Register_Object TextBoxSub4
38301>>>Register_Object TextBoxSub5
38301>>>Register_Object TextBoxSub6
38301>>>Register_Object TextBoxSub7
38301>>>Register_Object TextBoxSub8
38301>>>Register_Object TextBoxSub9
38301>>>Register_Object Textbox3
38301>>>Register_Object Textbox4
38301>>>Register_Object TP_Additional
38301>>>Register_Object TP_Bmove
38301>>>Register_Object TP_Status
38301>>>Register_Object txtnom1
38301>>>Register_Object txtnom2
38301>>>Register_Object txtnom3
38301>>>Register_Object VW037
38301>>>Register_Object Year_Year_Year
38301>>>
38301>>>
38301>>>//AB/ AppBuild VIEW
38301>>>
38301>>>//AB-IgnoreStart
38301>>>
38301>>>Use dbView.Sub
38301>>>Use DFAllEnt.pkg
38301>>>Use dbForm.Sub
38301>>>Use dbTabdlg.Sub
38301>>>Use dbGroup.Sub
38301>>>Use Txtbox.Sub
38301>>>Use dbCmbfrm.Sub
38301>>>Use dbEdit.Sub
38301>>>Use dbGrid.Sub
38301>>>
38301>>>Use BTYPKIN.DD
INCLUDING FILE: BTYPKIN.DD
38301>>>>>//DDB-FileStart
38301>>>>>//DDB-HeaderStart
38301>>>>>
38301>>>>>// File Name : BTYPKIN.DD
38301>>>>>// Class Name: Btypkin_DataDictionary
38301>>>>>// Revision  : 114
38301>>>>>// Version   : 2
38301>>>>>
38301>>>>>Use  Windows           // Basic Definitions
38301>>>>>Use  DataDict          // DataDictionary Class Definition
38301>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38301>>>>>
38301>>>>>Open Btypkin
38303>>>>>Open Bflagkin
INCLUDING FILE: BFLAGKIN.FD
38305>>>>>Open Bkinkat
INCLUDING FILE: BKINKAT.FD
38307>>>>>Open Barticl
INCLUDING FILE: BARTICL.FD
38309>>>>>Open Sysrecb
38311>>>>>
38311>>>>>//DDB-HeaderEnd
38311>>>>>//DDB-ValidationStart
38311>>>>>
38311>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
38311>>>>>
38311>>>>>Register_Object Bfile_VT
38311>>>>>Register_Object Btypkin_Btypkin_Anti_Xp_VT
38311>>>>>Use Baxio.pkg        // Bfile_VT
INCLUDING FILE: BAXIO.PKG
38311>>>>>>>// **************************************************************************
38311>>>>>>>// *Code Style   : Object                                                   *
38311>>>>>>>// *Name         : Baxio.vts                                                *
38311>>>>>>>// *Revision     : 1                                                        *
38311>>>>>>>// *Main File    :                                                          *
38311>>>>>>>// *Location     : \Home.Win\Easyware\ED\Appsrc                             *
38311>>>>>>>// *Creation Date: 01/09/99                                                 *
38311>>>>>>>// *Last Update  :                                                          *
38311>>>>>>>// *Author       : JA                                                       *
38311>>>>>>>// *Includes     :                                                          *
38311>>>>>>>// *Comments     : œ¨ â®œ  æ¢˜ «˜ static validation tables «¦¬             *
38311>>>>>>>// *             : module «à¤ ˜¥ ¦š¨á­à¤.                                   *
38311>>>>>>>// *             :                                                          *
38311>>>>>>>// *             :                                                          *
38311>>>>>>>// *Returns      :                                                          *
38311>>>>>>>// *             :                                                          *
38311>>>>>>>// *‰nown bugs   :                                                          *
38311>>>>>>>// *             :                                                          *
38311>>>>>>>// *Improvements :                                                          *
38311>>>>>>>// *             :                                                          *
38311>>>>>>>// *             :                                                          *
38311>>>>>>>// **************************************************************************
38311>>>>>>>// *                        A N A L Y S I S                                 *
38311>>>>>>>// **************************************************************************
38311>>>>>>>// *                                                                        *
38311>>>>>>>// **************************************************************************
38311>>>>>>>
38311>>>>>>>
38311>>>>>>>//Set Allow_Blank_State To TRUE
38311>>>>>>>
38311>>>>>>>//used by: 1. baxiokat.baxiokat_type
38311>>>>>>>Object Baxiokat_Type_VT  is a DescriptionValidationTable
38313>>>>>>>       set table_title to "„å›¦ª €¥ ¦š¨á­¦¬"
38314>>>>>>>       Procedure Fill_List
38316>>>>>>>                 Forward Send Fill_List
38318>>>>>>>                 Send Add_Table_Value  "1"  "„ ©§¨˜¡«â¦"
38319>>>>>>>                 send add_table_value  "2"  "¢ž¨à«â¦"
38320>>>>>>>       End_Procedure //fill_list
38321>>>>>>>End_Object   //Baxiokat_Type_VT
38322>>>>>>>
38322>>>>>>>
38322>>>>>>>//¡˜«˜©«á©œ ª ˜¥ ¦š¨á­à¤
38322>>>>>>>//used by: 1. bkinkat.baxio_stat_from :¡˜«á©«˜©ž ˜§æ
38322>>>>>>>//         2. bkinkat.baxio_stat_to   :¡˜«á©«˜©ž ©â
38322>>>>>>>//         3. baxio.baxio_status      :¡˜«á©«˜©ž
38322>>>>>>>//â¤˜ ˜¥ æš¨˜­¦ œå¤˜  § Ÿ˜¤æ ¤˜ ™¨œŸœå ©« ª §˜¨˜¡á«à 3 ¡˜«˜©«á©œ ª:
38322>>>>>>>Object Baxio_Status_VT  is a DescriptionValidationTable
38324>>>>>>>       set table_title to "‰˜«˜©«á©œ ª €¥ ¦š¨á­à¤"
38325>>>>>>>       Procedure Fill_List
38327>>>>>>>                 Forward Send Fill_List
38329>>>>>>>                 Send Add_Table_Value  "1"  "„¡¡¨œ£âª"
38330>>>>>>>                 Send Add_Table_Value  "2"  "„¥¦­¢ž£â¤¦"
38331>>>>>>>                 Send Add_Table_Value  "3"  "ƒ ˜£˜¨«¬¨ž£â¤¦"
38332>>>>>>>                 Send Add_Table_Value  "4"  "’˜£œå¦"
38333>>>>>>>                 Send Add_Table_Value  "5"  "ƒœ©£œ¬£â¤¦"
38334>>>>>>>
38334>>>>>>>       End_Procedure // fill_list
38335>>>>>>>End_Object   //Baxio_Status_VT1
38336>>>>>>>
38336>>>>>>>
38336>>>>>>>
38336>>>>>>>//used by: 1. btypkin.btypkin_anti1
38336>>>>>>>//         2. btypkin.btypkin_anti2
38336>>>>>>>//         3. baxio.baxio_file_in
38336>>>>>>>//         4. baxio.baxio_file_out
38336>>>>>>>//         5. baxio.baxio_lfile
38336>>>>>>>Object Bfile_VT  is a DescriptionValidationTable
38338>>>>>>>       set table_title to "‘¬¤˜¢¢˜©æ£œ¤¦ª/˜¨˜¢ã§«žª ˜§æ"
38339>>>>>>>       Procedure Fill_List
38341>>>>>>>                 Forward Send Fill_List
38343>>>>>>>                 Send Add_Table_Value  "-1" "ƒœ¤ “§á¨®œ "
38344>>>>>>>                 Send Add_Table_Value  "0"  "Data Entry"
38345>>>>>>>                 Send Add_Table_Value  "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
38346>>>>>>>                 send add_table_value  "2"  "”¦¨â˜ª"
38347>>>>>>>                 Send Add_Table_Value  "3"  "¨¦£žŸœ¬«é¤"
38348>>>>>>>                 Send Add_Table_Value  "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
38349>>>>>>>                 Send Add_Table_Value  "6"  "’œ¢.˜¨˜¢ã§«žª"
38350>>>>>>>       End_Procedure // fill_list
38351>>>>>>>End_Object   // Btypkin_Btypkin_Anti_VT
38352>>>>>>>
38352>>>>>
38352>>>>>Object Btypkin_Btypkin_Anti_Xp_VT  is a DescriptionValidationTable
38354>>>>>
38354>>>>>    Procedure Fill_List
38356>>>>>        Forward Send Fill_List
38358>>>>>        Send Add_Table_Value  "1"  "•¨œé¤œ«˜ "
38359>>>>>        Send Add_Table_Value  "2"  " ©«é¤œ«˜ "
38360>>>>>    End_Procedure    // Fill_List
38361>>>>>    //DDB-ValidationCustomStart
38361>>>>>    //DDB-ValidationCustomEnd
38361>>>>>End_Object   // Btypkin_Btypkin_Anti_Xp_VT
38362>>>>>//DDB-ValidationEnd
38362>>>>>//DDB-SelectionStart
38362>>>>>//DDB/ ExternalSelectionList SL031  SL031.SL
38362>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
38362>>>>>//DDB/ ExternalSelectionList sl007r  sl007r.SL
38362>>>>>Register_Object SL031
38362>>>>>Register_Object sl007
38362>>>>>Register_Object sl007r
38362>>>>>//DDB-SelectionEnd
38362>>>>>
38362>>>>>// JSJSJSJS 24/01/2001 Register_Object SL056 //¢å©«˜ gplan
38362>>>>>//Register_Object SL056 //¢å©«˜ vendor
38362>>>>>
38362>>>>>
38362>>>>>Open SysCurXr
38364>>>>>
38364>>>>>Open Barticl //©œ«á¨œ  prompt objects
38366>>>>>// JSJSJSJS 24/01/2001 Open Gtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38366>>>>>//Open Ctypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38366>>>>>//Open Vtypkin //™¨å©¡œ  rec0 ©«ž¤ update, externalyy updated, lock on save
38366>>>>>
38366>>>>>
38366>>>>>// JSJSJSJS 24/01/2001 Use SL056.SL //¢å©«˜ gplan
38366>>>>>//Use SL102.SL //¢å©«˜ customer
38366>>>>>//Use SL???.SL //¢å©«˜ vendor
38366>>>>>Use sl100.sl // Clients selection list
INCLUDING FILE: SL100.SL
38366>>>>>>>//AB/ Project SL100:PELATES
38366>>>>>>>//AB/     Object prj is a Lookup_Project
38366>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
38366>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
38366>>>>>>>
38366>>>>>>>// Project Object Structure
38366>>>>>>>//   sl100 is a dbModalPanelSub
38366>>>>>>>//     Clients_DD is a DataDictionary
38366>>>>>>>//     oSelList is a dbListSub
38366>>>>>>>//     oOK_bn is a ButtonSub
38366>>>>>>>//     oCancel_bn is a ButtonSub
38366>>>>>>>//     oSearch_bn is a ButtonSub
38366>>>>>>>
38366>>>>>>>// Register all objects
38366>>>>>>>Register_Object Clients_DD
38366>>>>>>>Register_Object oCancel_bn
38366>>>>>>>Register_Object oOK_bn
38366>>>>>>>Register_Object oSearch_bn
38366>>>>>>>Register_Object oSelList
38366>>>>>>>Register_Object sl100
38366>>>>>>>
38366>>>>>>>
38366>>>>>>>    //AB-IgnoreStart
38366>>>>>>>
38366>>>>>>>    Use DFAllEnt.pkg
38366>>>>>>>    Use dbList.Sub
38366>>>>>>>    Use Button.Sub
38366>>>>>>>
38366>>>>>>>
38366>>>>>>>    Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
38366>>>>>>>>>//DDB-FileStart
38366>>>>>>>>>//DDB-HeaderStart
38366>>>>>>>>>
38366>>>>>>>>>// File Name : CLIENTS.DD
38366>>>>>>>>>// Class Name: Clients_DataDictionary
38366>>>>>>>>>// Revision  : 241
38366>>>>>>>>>// Version   : 2
38366>>>>>>>>>
38366>>>>>>>>>Use  Windows           // Basic Definitions
38366>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
38366>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38366>>>>>>>>>
38366>>>>>>>>>Open Clients
38368>>>>>>>>>Open Cmoves
INCLUDING FILE: CMOVES.FD
38370>>>>>>>>>Open Particle
INCLUDING FILE: PARTICLE.FD
38372>>>>>>>>>Open Cmovesa
INCLUDING FILE: CMOVESA.FD
38374>>>>>>>>>Open Cn
38376>>>>>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
38378>>>>>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
38380>>>>>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
38382>>>>>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
38384>>>>>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
38386>>>>>>>>>Open Cities
38388>>>>>>>>>Open Areas
38390>>>>>>>>>Open Payresp
38392>>>>>>>>>Open Syscurxr
38394>>>>>>>>>Open Sysrecc
38396>>>>>>>>>Open Ptypparl
38398>>>>>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
38400>>>>>>>>>Open Sysrecg
38402>>>>>>>>>
38402>>>>>>>>>//DDB-HeaderEnd
38402>>>>>>>>>//DDB-ValidationStart
38402>>>>>>>>>
38402>>>>>>>>>Register_Object Clients_Client_Doy_VT
38402>>>>>>>>>Register_Object Clients_Client_Job_VT
38402>>>>>>>>>Register_Object Clients_Client_Categfpa_VT
38402>>>>>>>>>Register_Object Clients_Client_Catjob_VT1
38402>>>>>>>>>Register_Object Clients_Client_Idiot_VT
38402>>>>>>>>>Register_Object Clients_Feregios_VT
38402>>>>>>>>>
38402>>>>>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
38404>>>>>>>>>    Set Type_Value        To "DOY"
38405>>>>>>>>>    Set Validate_State    To FALSE
38406>>>>>>>>>    Set Allow_Blank_State To TRUE
38407>>>>>>>>>    Set Table_Title       To "ƒ.Ž.“"
38408>>>>>>>>>    //DDB-ValidationCustomStart
38408>>>>>>>>>    //DDB-ValidationCustomEnd
38408>>>>>>>>>End_Object   // Clients_Client_Doy_VT
38409>>>>>>>>>
38409>>>>>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
38411>>>>>>>>>    Set Type_Value        To "JOB"
38412>>>>>>>>>    Set Validate_State    To FALSE
38413>>>>>>>>>    Set Allow_Blank_State To TRUE
38414>>>>>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
38415>>>>>>>>>    //DDB-ValidationCustomStart
38415>>>>>>>>>    //DDB-ValidationCustomEnd
38415>>>>>>>>>End_Object   // Clients_Client_Job_VT
38416>>>>>>>>>
38416>>>>>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
38418>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
38419>>>>>>>>>    Set Validate_State    To FALSE
38420>>>>>>>>>    Set Allow_Blank_State To TRUE
38421>>>>>>>>>    //DDB-ValidationCustomStart
38421>>>>>>>>>    //DDB-ValidationCustomEnd
38421>>>>>>>>>End_Object   // Clients_Client_Categfpa_VT
38422>>>>>>>>>
38422>>>>>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
38424>>>>>>>>>    Set Type_Value        To "JOB"
38425>>>>>>>>>    Set Validate_State    To FALSE
38426>>>>>>>>>    Set Allow_Blank_State To TRUE
38427>>>>>>>>>    //DDB-ValidationCustomStart
38427>>>>>>>>>    //DDB-ValidationCustomEnd
38427>>>>>>>>>End_Object   // Clients_Client_Catjob_VT1
38428>>>>>>>>>
38428>>>>>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
38430>>>>>>>>>    Set Type_Value        To "IDIOT"
38431>>>>>>>>>    Set Validate_State    To FALSE
38432>>>>>>>>>    Set Allow_Blank_State To TRUE
38433>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
38434>>>>>>>>>    //DDB-ValidationCustomStart
38434>>>>>>>>>    //DDB-ValidationCustomEnd
38434>>>>>>>>>End_Object   // Clients_Client_Idiot_VT
38435>>>>>>>>>
38435>>>>>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
38437>>>>>>>>>    Set Type_Value        To "FEREGIOS"
38438>>>>>>>>>    Set Allow_Blank_State To TRUE
38439>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
38440>>>>>>>>>    //DDB-ValidationCustomStart
38440>>>>>>>>>    //DDB-ValidationCustomEnd
38440>>>>>>>>>End_Object   // Clients_Feregios_VT
38441>>>>>>>>>//DDB-ValidationEnd
38441>>>>>>>>>//DDB-SelectionStart
38441>>>>>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
38441>>>>>>>>>Register_Object sl100
38441>>>>>>>>>//DDB-SelectionEnd
38441>>>>>>>>>Open Sysfile
38443>>>>>>>>>open year
38445>>>>>>>>>
38445>>>>>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
38446>>>>>>>>>
38446>>>>>>>>>    Procedure Construct_Object
38447>>>>>>>>>        Forward Send Construct_Object
38449>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
38450>>>>>>>>>        Property Integer piCheckPlaf        Public 0
38451>>>>>>>>>        //------------------------------------------------
38451>>>>>>>>>        // Properties gia na kraththoun oi palies times
38451>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
38451>>>>>>>>>        // einai 1     js 03/12/2007
38451>>>>>>>>>        //------------------------------------------------
38451>>>>>>>>>        Property Integer piCreateNew            Public  0
38452>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
38453>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
38454>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
38455>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
38456>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
38457>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
38458>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
38459>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
38460>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
38461>>>>>>>>>        //------------------------------------------------
38461>>>>>>>>>
38461>>>>>>>>>    End_Procedure
38462>>>>>>>>>
38462>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38463>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
38465>>>>>>>>>        //------------------------------------------------
38465>>>>>>>>>        // Properties gia na kraththoun oi palies times
38465>>>>>>>>>        // ton pedion js 03/12/2007
38465>>>>>>>>>        //------------------------------------------------
38465>>>>>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
38466>>>>>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
38467>>>>>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
38468>>>>>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
38469>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
38470>>>>>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
38471>>>>>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
38472>>>>>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
38473>>>>>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
38474>>>>>>>>>        //------------------------------------------------
38474>>>>>>>>>     End_Procedure   // New_Current_Record
38475>>>>>>>>>
38475>>>>>>>>>
38475>>>>>>>>>    // Backout:
38475>>>>>>>>>    Procedure Backout
38476>>>>>>>>>        Forward Send Backout
38478>>>>>>>>>        // Insert Code Here
38478>>>>>>>>>    End_Procedure   // Backout
38479>>>>>>>>>
38479>>>>>>>>>    Procedure Delete_Main_File
38480>>>>>>>>>        //---------------------------------------------
38480>>>>>>>>>        // Auditing / Katagrafh allagon
38480>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38481>>>>>>>>>        Date    dDate  Shmer
38481>>>>>>>>>        Integer iMin iHour iSec iLen
38481>>>>>>>>>        Sysdate dDate iHour iMin iSec
38485>>>>>>>>>        Move iHour  to sHour
38486>>>>>>>>>        Move iMin   to sMin
38487>>>>>>>>>        Move iSec   to sSec
38488>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38492>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38496>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38500>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38501>>>>>>>>>
38501>>>>>>>>>        // Auditing / Diagrafh
38501>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
38503>>>>>>>>>            Get fsLoginUserID to sUser
38504>>>>>>>>>            clear gmove
38505>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
38506>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
38507>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
38508>>>>>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
38509>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
38510>>>>>>>>>            move suser                  to gmove.gplan_code
38511>>>>>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
38512>>>>>>>>>            reread sysrecg
38516>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38517>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38518>>>>>>>>>            saverecord sysrecg
38519>>>>>>>>>            unlock
38520>>>>>>>>>>
38520>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
38521>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
38522>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
38523>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
38524>>>>>>>>>
38524>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38525>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38526>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38527>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
38528>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38529>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38530>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38531>>>>>>>>>
38531>>>>>>>>>
38531>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
38532>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
38533>>>>>>>>>            saverecord gmove
38534>>>>>>>>>        End
38534>>>>>>>>>>
38534>>>>>>>>>
38534>>>>>>>>>        Forward Send Delete_Main_File
38536>>>>>>>>>
38536>>>>>>>>>    End_Procedure
38537>>>>>>>>>
38537>>>>>>>>>
38537>>>>>>>>>    Procedure Update
38538>>>>>>>>>        Forward Send Update
38540>>>>>>>>>        // Insert Code Here
38540>>>>>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
38541>>>>>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
38542>>>>>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
38543>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
38543>>>>>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
38544>>>>>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
38545>>>>>>>>>
38545>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
38545>>>>>>>>>
38545>>>>>>>>>        //betolink
38545>>>>>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
38546>>>>>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
38547>>>>>>>>>        Move Clients.Client_id       to Clients.Client_Repm
38548>>>>>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
38549>>>>>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
38550>>>>>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job             
38550>>>>>>>>>     
38550>>>>>>>>>     
38550>>>>>>>>>        //---------------------------------------------
38550>>>>>>>>>        // Auditing / Katagrafh allagon
38550>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
38551>>>>>>>>>        Date    dDate  Shmer 
38551>>>>>>>>>        Integer iMin iHour iSec iLen
38551>>>>>>>>>        Sysdate dDate iHour iMin iSec 
38555>>>>>>>>>        Move iHour  to sHour
38556>>>>>>>>>        Move iMin   to sMin
38557>>>>>>>>>        Move iSec   to sSec
38558>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
38562>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
38566>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
38570>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
38571>>>>>>>>>        
38571>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
38571>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
38573>>>>>>>>>            Get fsLoginUserID to sUser
38574>>>>>>>>>            If (piCreateNew(Self)=1) Begin
38576>>>>>>>>>                clear gmove
38577>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
38578>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
38579>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
38580>>>>>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
38581>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
38582>>>>>>>>>                move suser                  to gmove.gplan_code
38583>>>>>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
38584>>>>>>>>>                reread sysrecg
38588>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38589>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38590>>>>>>>>>                saverecord sysrecg
38591>>>>>>>>>                unlock
38592>>>>>>>>>>
38592>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
38593>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
38594>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
38595>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
38596>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
38597>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
38598>>>>>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr 
38599>>>>>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr  
38600>>>>>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
38601>>>>>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
38602>>>>>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
38603>>>>>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
38604>>>>>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
38605>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
38606>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
38607>>>>>>>>>                saverecord gmove
38608>>>>>>>>>                Set piCreateNew to 0
38609>>>>>>>>>            End
38609>>>>>>>>>>
38609>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
38612>>>>>>>>>                Integer isChanged
38612>>>>>>>>>                Move 0 to isChanged
38613>>>>>>>>>                
38613>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
38616>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
38620>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
38624>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
38628>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
38632>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
38636>>>>>>>>>                
38636>>>>>>>>>                If (isChanged>0) Begin  
38638>>>>>>>>>                    clear gmove
38639>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
38640>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
38641>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
38642>>>>>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
38643>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
38644>>>>>>>>>                    move suser                  to gmove.gplan_code
38645>>>>>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
38646>>>>>>>>>                    reread sysrecg
38650>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
38651>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
38652>>>>>>>>>                    saverecord sysrecg
38653>>>>>>>>>                    unlock
38654>>>>>>>>>>
38654>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
38655>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
38656>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
38657>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
38658>>>>>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr 
38659>>>>>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr  
38660>>>>>>>>>                    //--
38660>>>>>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
38661>>>>>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
38662>>>>>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
38663>>>>>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
38664>>>>>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
38665>>>>>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
38666>>>>>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
38667>>>>>>>>>                    //--
38667>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
38668>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
38669>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
38670>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
38671>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
38672>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
38673>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
38674>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
38675>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
38676>>>>>>>>>                    saverecord gmove
38677>>>>>>>>>                    Set piCreateNew to 0
38678>>>>>>>>>                End
38678>>>>>>>>>>
38678>>>>>>>>>            End
38678>>>>>>>>>>
38678>>>>>>>>>        End
38678>>>>>>>>>>
38678>>>>>>>>>
38678>>>>>>>>>     
38678>>>>>>>>>    End_Procedure   // Update
38679>>>>>>>>>
38679>>>>>>>>>
38679>>>>>>>>>    Procedure Creating
38680>>>>>>>>>        date ddate iYes
38681>>>>>>>>>        Forward Send Creating
38683>>>>>>>>>        // Insert Code Here
38683>>>>>>>>>
38683>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
38684>>>>>>>>>        Move '1'                    to Clients.Client_Active
38685>>>>>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
38686>>>>>>>>>        sysdate4 ddate
38687>>>>>>>>>        move ddate                  to Clients.Client_Hmnia    
38688>>>>>>>>>        Set piCreateNew to 1
38689>>>>>>>>>    End_Procedure   // Creating
38690>>>>>>>>>
38690>>>>>>>>>    Function Validate_Save  Returns Integer
38691>>>>>>>>>        Integer iReturnVal iCheck iYes
38692>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
38694>>>>>>>>>        If (Not(iReturnVal)) Begin
38696>>>>>>>>>
38696>>>>>>>>>            If (clients.is_eksoter <> '1') begin
38698>>>>>>>>>                If (Clients.Is_Xondr='1') Begin
38700>>>>>>>>>                    If (Sysfile.Check_Afm=1) Begin
38702>>>>>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
38703>>>>>>>>>                        If (iCheck) Begin
38705>>>>>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
38708>>>>>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
38712>>>>>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
38716>>>>>>>>>                        End
38716>>>>>>>>>>
38716>>>>>>>>>                    End
38716>>>>>>>>>>
38716>>>>>>>>>                End
38716>>>>>>>>>>
38716>>>>>>>>>            End
38716>>>>>>>>>>
38716>>>>>>>>>
38716>>>>>>>>>            If (piCheckPlaf(Self)=1) Begin
38718>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
38720>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
38721>>>>>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
38724>>>>>>>>>                End
38724>>>>>>>>>>
38724>>>>>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
38727>>>>>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
38728>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38731>>>>>>>>>                End
38731>>>>>>>>>>
38731>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
38734>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
38735>>>>>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
38738>>>>>>>>>                End
38738>>>>>>>>>>
38738>>>>>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
38741>>>>>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
38742>>>>>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
38745>>>>>>>>>                End
38745>>>>>>>>>>
38745>>>>>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
38747>>>>>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
38748>>>>>>>>>                End
38748>>>>>>>>>>
38748>>>>>>>>>            End
38748>>>>>>>>>>
38748>>>>>>>>>
38748>>>>>>>>>            If (iReturnVal) Begin
38750>>>>>>>>>                Send Operation_Not_Allowed iReturnVal
38751>>>>>>>>>            End
38751>>>>>>>>>>
38751>>>>>>>>>        End
38751>>>>>>>>>>
38751>>>>>>>>>        Function_Return iReturnVal
38752>>>>>>>>>    End_Function   // Validate_Save
38753>>>>>>>>>
38753>>>>>>>>>
38753>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
38754>>>>>>>>>        String lsError_Message
38755>>>>>>>>>
38755>>>>>>>>>        Case Begin
38755>>>>>>>>>            Case (iError_Num = 4001)
38757>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38758>>>>>>>>>              Case Break
38759>>>>>>>>>            Case (iError_Num = 4002)
38762>>>>>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
38763>>>>>>>>>              Case Break
38764>>>>>>>>>            Case (iError_Num = 4003)
38767>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
38768>>>>>>>>>              Case Break
38769>>>>>>>>>            Case (iError_Num = 4004)
38772>>>>>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
38773>>>>>>>>>              Case Break
38774>>>>>>>>>            Case (iError_Num = 4005)
38777>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
38778>>>>>>>>>              Case Break
38779>>>>>>>>>            Case (iError_Num = 4006)
38782>>>>>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
38783>>>>>>>>>              Case Break
38784>>>>>>>>>
38784>>>>>>>>>            Case Else
38784>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
38786>>>>>>>>>        Case End
38786>>>>>>>>>
38786>>>>>>>>>        Error iError_Num lsError_Message
38787>>>>>>>>>>
38787>>>>>>>>>    End_Procedure // operation_not_allowed
38788>>>>>>>>>
38788>>>>>>>>>
38788>>>>>>>>>    // Define_Fields:
38788>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38788>>>>>>>>>
38788>>>>>>>>>    Procedure Define_Fields
38789>>>>>>>>>        Forward Send Define_Fields
38791>>>>>>>>>        //DDB-Generated-Code-Location
38791>>>>>>>>>        //DDB-DefineFieldStart
38791>>>>>>>>>
38791>>>>>>>>>        Set Main_File            To Clients.File_Number
38792>>>>>>>>>        Set Cascade_Delete_State To FALSE
38793>>>>>>>>>
38793>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38794>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38795>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38796>>>>>>>>>
38796>>>>>>>>>        // Child (Client) file structure................
38796>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
38797>>>>>>>>>        Send Add_Client_File  Particle.File_Number
38798>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
38799>>>>>>>>>        Send Add_Client_File  Cn.File_Number
38800>>>>>>>>>        Send Add_Client_File  Particll.File_Number
38801>>>>>>>>>        Send Add_Client_File  Clnbank.File_Number
38802>>>>>>>>>        Send Add_Client_File  Tpclient.File_Number
38803>>>>>>>>>        Send Add_Client_File  Clorder.File_Number
38804>>>>>>>>>        Send Add_Client_File  Clitem.File_Number
38805>>>>>>>>>
38805>>>>>>>>>        // Parent (Server) file structure...............
38805>>>>>>>>>        Send Add_Server_File  Cities.File_Number
38806>>>>>>>>>        Send Add_Server_File  Areas.File_Number
38807>>>>>>>>>        Send Add_Server_File  Payresp.File_Number
38808>>>>>>>>>
38808>>>>>>>>>        // External (System) file structure.............
38808>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
38809>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
38810>>>>>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
38811>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
38812>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
38813>>>>>>>>>
38813>>>>>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
38816>>>>>>>>>
38816>>>>>>>>>        // Field-based properties.......................
38816>>>>>>>>>
38816>>>>>>>>>        // Clients.Company_Code
38816>>>>>>>>>
38816>>>>>>>>>        // Clients.Branch_Code
38816>>>>>>>>>
38816>>>>>>>>>        // Clients.Year_Year
38816>>>>>>>>>
38816>>>>>>>>>        // Clients.Custprom_Code
38816>>>>>>>>>
38816>>>>>>>>>        // Clients.Client_Id
38816>>>>>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
38817>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
38818>>>>>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
38819>>>>>>>>>
38819>>>>>>>>>        // Clients.Client_Name
38819>>>>>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
38820>>>>>>>>>
38820>>>>>>>>>        // Clients.Client_Afm
38820>>>>>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
38821>>>>>>>>>
38821>>>>>>>>>        // Clients.Client_Rec0
38821>>>>>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
38822>>>>>>>>>
38822>>>>>>>>>        // Clients.Custprom_Recr
38822>>>>>>>>>
38822>>>>>>>>>        // Clients.Client_Recr
38822>>>>>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
38823>>>>>>>>>
38823>>>>>>>>>        // Clients.Last_Xreosh
38823>>>>>>>>>
38823>>>>>>>>>        // Clients.Last_Pistosh
38823>>>>>>>>>
38823>>>>>>>>>        // Clients.Last_Order
38823>>>>>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
38824>>>>>>>>>
38824>>>>>>>>>        // Clients.Client_Doy
38824>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
38825>>>>>>>>>
38825>>>>>>>>>        // Clients.Client_Address
38825>>>>>>>>>
38825>>>>>>>>>        // Clients.Client_City_Id
38825>>>>>>>>>
38825>>>>>>>>>        // Clients.Client_Area
38825>>>>>>>>>
38825>>>>>>>>>        // Clients.Client_Job
38825>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Respons
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Zipcode
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Phone
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Fax
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Mobile
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Aoh
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Email
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Class
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Details
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Sitew
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Codem
38826>>>>>>>>>
38826>>>>>>>>>        // Clients.Client_Categfpa
38826>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Fpa
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Public
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Sn
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Repm
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Active
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Reported
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Pelprom
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Lastupd
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Markexp
38827>>>>>>>>>
38827>>>>>>>>>        // Clients.Client_Catjob
38827>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Is_Promhtheyths
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Xreosh
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Pistosh
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Ypoloipo
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Plafon
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Overhead
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Client_Company
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Client_Repmatch
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Client_Hmnia
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Client_Presp
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Client_Locked
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Synolikh_Ofeilh
38828>>>>>>>>>
38828>>>>>>>>>        // Clients.Client_Idiot
38828>>>>>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Add_No
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Nomos
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Xora
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Polh_Recr
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Presp_Id
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Sum_Pct_Tpcl
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Is_Client
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Sysxetish
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Poso_Se_Apait
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Glcode
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Is_Eksoter
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Is_Xondr
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Orio_Syn_Ofeilh
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Posa_Apo_Dap
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Doybtm
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Posa_Apo_Parag
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Ptyppar
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Client_Seira
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Hpso
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Hpal
38829>>>>>>>>>
38829>>>>>>>>>        // Clients.Feregios
38829>>>>>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
38830>>>>>>>>>
38830>>>>>>>>>        // Clients.Diakin
38830>>>>>>>>>
38830>>>>>>>>>        // Clients.Status
38830>>>>>>>>>
38830>>>>>>>>>        // Clients.Anal
38830>>>>>>>>>
38830>>>>>>>>>        // Clients.Endoomil
38830>>>>>>>>>
38830>>>>>>>>>        // Clients.Npdd
38830>>>>>>>>>
38830>>>>>>>>>        // Clients.Sap_Hmnia
38830>>>>>>>>>
38830>>>>>>>>>        //DDB-DefineFieldEnd
38830>>>>>>>>>    End_Procedure    // Define_Fields
38831>>>>>>>>>
38831>>>>>>>>>    // Field_Defaults:
38831>>>>>>>>>    // This procedure is used to establish default field values.
38831>>>>>>>>>
38831>>>>>>>>>    Procedure Field_Defaults
38832>>>>>>>>>        Forward Send Field_Defaults
38834>>>>>>>>>        //DDB-Generated-Code-Location
38834>>>>>>>>>        //DDB-FieldDefaultStart
38834>>>>>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
38835>>>>>>>>>        //DDB-FieldDefaultEnd
38835>>>>>>>>>    End_Procedure    // Field_Defaults
38836>>>>>>>>>
38836>>>>>>>>>End_Class    // Clients_DataDictionary
38837>>>>>>>>>//DDB-Selection-pkg-Start
38837>>>>>>>>>
38837>>>>>>>>>Use sl100.SL         // sl100
38837>>>>>>>>>
38837>>>>>>>>>//DDB-Selection-pkg-End
38837>>>>>>>>>//DDB-FileEnd
38837>>>>>>>    
38837>>>>>>>    //AB-IgnoreEnd
38837>>>>>>>
38837>>>>>>>    Object sl100 is a dbModalPanelSub
38839>>>>>>>
38839>>>>>>>        //AB-StoreTopStart
38839>>>>>>>                
38839>>>>>>>        Property String     FragmaClient        Public ''
38841>>>>>>>        Property String     psIsPromhtheyths    Public ''
38843>>>>>>>        Property Integer    piMustConstrain     Public  0
38845>>>>>>>        Property String     psModule            Public ''
38847>>>>>>>        
38847>>>>>>>        //AB-StoreTopEnd
38847>>>>>>>
38847>>>>>>>        Set Label to "(Xlate(Label(Self)))"
38848>>>>>>>        Set Size to 252 509
38849>>>>>>>        Set Location to 4 5
38850>>>>>>>
38850>>>>>>>        //AB-DDOStart
38850>>>>>>>
38850>>>>>>>        Object Clients_DD is a Clients_DataDictionary
38852>>>>>>>
38852>>>>>>>            //AB-StoreTopStart
38852>>>>>>>                                                        
38852>>>>>>>            //AB-StoreTopEnd
38852>>>>>>>
38852>>>>>>>
38852>>>>>>>            //AB-StoreStart
38852>>>>>>>                                                        
38852>>>>>>>            Begin_Constraints
38854>>>>>>>                     If (psModule(Self)='01') BEGIN
38856>>>>>>>                        Constrain Clients.is_Client        Eq '1'
38858>>>>>>>                     end
38858>>>>>>>>
38858>>>>>>>                     Else If (psModule(Self)='02') begin
38861>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
38863>>>>>>>                     end
38863>>>>>>>>
38863>>>>>>>            End_Constraints
38866>>>>>>>            
38866>>>>>>>            
38866>>>>>>>            
38866>>>>>>>            
38866>>>>>>>            
38866>>>>>>>            //AB-StoreEnd
38866>>>>>>>
38866>>>>>>>        End_Object    // Clients_DD
38867>>>>>>>
38867>>>>>>>        Set Main_DD to (Clients_DD(self))
38868>>>>>>>        Set Server to (Clients_DD(self))
38869>>>>>>>
38869>>>>>>>        //AB-DDOEnd
38869>>>>>>>
38869>>>>>>>        Object oSelList is a dbListSub
38871>>>>>>>            Set Main_File to Clients.File_Number
38872>>>>>>>            Set Size to 204 496
38873>>>>>>>            Set Location to 7 5
38874>>>>>>>            Set Auto_Index_State to FALSE
38875>>>>>>>
38875>>>>>>>            Begin_Row
38878>>>>>>>                Entry_Item Clients.Client_id
38879>>>>>>>                Entry_Item Clients.Client_name
38880>>>>>>>                Entry_Item Clients.Client_afm
38881>>>>>>>                Entry_Item Clients.Last_xreosh
38882>>>>>>>                Entry_Item Clients.Last_pistosh
38883>>>>>>>                Entry_Item Clients.Client_codem
38884>>>>>>>                Entry_Item Clients.Is_client
38885>>>>>>>                Entry_Item Clients.Is_promhtheyths
38886>>>>>>>            End_Row
38891>>>>>>>
38891>>>>>>>            Set Form_Width    item 0 to 64
38892>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
38893>>>>>>>            
38893>>>>>>>            Set Form_Width    item 1 to 133
38894>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
38895>>>>>>>            
38895>>>>>>>            Set Form_Width    item 2 to 62
38896>>>>>>>            Set Header_Label  item 2 to "€”‹"
38897>>>>>>>            
38897>>>>>>>            Set Form_Width    item 3 to 60
38898>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
38899>>>>>>>            
38899>>>>>>>            Set Form_Width    item 4 to 60
38900>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
38901>>>>>>>            
38901>>>>>>>            Set Form_Width    item 5 to 59
38902>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
38903>>>>>>>            
38903>>>>>>>            Set Form_Width    item 6 to 26
38904>>>>>>>            Set Header_Label  item 6 to "œ¢"
38905>>>>>>>            Set Column_Checkbox_State  item 6 to True
38906>>>>>>>            
38906>>>>>>>            Set Form_Width    item 7 to 26
38907>>>>>>>            Set Header_Label  item 7 to "¨¦£"
38908>>>>>>>            Set Column_Checkbox_State  item 7 to True
38909>>>>>>>            
38909>>>>>>>
38909>>>>>>>            //AB-StoreStart
38909>>>>>>>                                                                                
38909>>>>>>>            //Property String StoreFragmaClient   Public ''
38909>>>>>>>            //Property String StorePsModule       Public ''
38909>>>>>>>            
38909>>>>>>>            //Procedure Store_Defaults
38909>>>>>>>            //    Forward Send Store_Defaults
38909>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
38909>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
38909>>>>>>>            //End_Procedure
38909>>>>>>>            
38909>>>>>>>            //Procedure ReStore_Defaults
38909>>>>>>>            //    Forward Send ReStore_Defaults
38909>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
38909>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
38909>>>>>>>            //End_Procedure
38909>>>>>>>            
38909>>>>>>>            Set Column_Option Item 6 to NoEnter True
38910>>>>>>>            Set Column_Option Item 7 to NoEnter True
38911>>>>>>>            
38911>>>>>>>            Procedure Activating
38913>>>>>>>                Forward Send Activating
38915>>>>>>>                Set Auto_Index_State to True
38916>>>>>>>            End_Procedure
38917>>>>>>>            
38917>>>>>>>            Procedure Activate
38919>>>>>>>                Send Rebuild_Constraints    to Clients_DD
38920>>>>>>>                If (FragmaClient(Self)<>'') Begin
38922>>>>>>>                    Clear Clients
38923>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
38924>>>>>>>                    Find Eq Clients By Index.6
38925>>>>>>>>
38925>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
38928>>>>>>>                End
38928>>>>>>>>
38928>>>>>>>                Forward Send Activate
38930>>>>>>>            End_procedure
38931>>>>>>>            
38931>>>>>>>            
38931>>>>>>>            
38931>>>>>>>            
38931>>>>>>>            //AB-StoreEnd
38931>>>>>>>
38931>>>>>>>        End_Object    // oSelList
38932>>>>>>>
38932>>>>>>>        Object oOK_bn is a ButtonSub
38934>>>>>>>            Set Label to "&„§ ¢¦šã"
38935>>>>>>>            Set Location to 218 341
38936>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38937>>>>>>>
38937>>>>>>>            //AB-StoreStart
38937>>>>>>>            Procedure OnClick
38939>>>>>>>                Send OK To (oSelList(current_object))
38940>>>>>>>            End_Procedure
38941>>>>>>>            //AB-StoreEnd
38941>>>>>>>
38941>>>>>>>        End_Object    // oOK_bn
38942>>>>>>>
38942>>>>>>>        Object oCancel_bn is a ButtonSub
38944>>>>>>>            Set Label to "&€¡ç¨à©ž"
38945>>>>>>>            Set Location to 218 396
38946>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38947>>>>>>>
38947>>>>>>>            //AB-StoreStart
38947>>>>>>>            Procedure OnClick
38949>>>>>>>                Send Cancel To (oSelList(current_object))
38950>>>>>>>            End_Procedure
38951>>>>>>>            //AB-StoreEnd
38951>>>>>>>
38951>>>>>>>        End_Object    // oCancel_bn
38952>>>>>>>
38952>>>>>>>        Object oSearch_bn is a ButtonSub
38954>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
38955>>>>>>>            Set Location to 218 451
38956>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38957>>>>>>>
38957>>>>>>>            //AB-StoreStart
38957>>>>>>>            Procedure OnClick
38959>>>>>>>                Send Search To (oSelList(current_object))
38960>>>>>>>            End_Procedure
38961>>>>>>>            //AB-StoreEnd
38961>>>>>>>
38961>>>>>>>        End_Object    // oSearch_bn
38962>>>>>>>
38962>>>>>>>
38962>>>>>>>        //AB-StoreStart
38962>>>>>>>                
38962>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
38963>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
38964>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
38965>>>>>>>        
38965>>>>>>>        Set Modal_State to True
38966>>>>>>>        Set Locate_Mode to Center_On_Screen
38967>>>>>>>        
38967>>>>>>>        
38967>>>>>>>        Procedure Activating Returns Integer
38969>>>>>>>            Integer rVal
38970>>>>>>>            Forward Get Msg_Activating to rVal
38972>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
38975>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
38979>>>>>>>            Procedure_Return rVal
38980>>>>>>>        End_procedure
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        
38981>>>>>>>        //AB-StoreEnd
38981>>>>>>>
38981>>>>>>>    End_Object    // sl100
38982>>>>>>>
38982>>>>>>>//AB/     End_Object    // prj
38982>>>>>
38982>>>>>//*********************************************************************************
38982>>>>>//*          A N A L Y S I S                                                      *
38982>>>>>//*********************************************************************************
38982>>>>>//† ¡áŸœ ¡å¤ž©ž ˜¥ ¦š¨á­à¤ ˜§¦«œ¢œå £å˜ ©¬¤˜¢¢˜šã.
38982>>>>>//„§¦£â¤àª ¦¨åœ«˜  £¦¤¦©ã£˜¤«˜ â¤˜ª ©¬¤˜¢¢˜©æ£œ¤¦ª
38982>>>>>
38982>>>>>//’é¨˜, ¦  › á­¦¨¦  «ç§¦  ©¬¤˜¢¢˜©¦£â¤à¤ §¦¬ ¬§¦©«ž¨åœ  «¦ ©ç©«ž£˜ ©ã£œ¨˜, œå¤˜ 
38982>>>>>//¦  œ¥ãª : 1  "Š¦š˜¨ ˜©£æª ‚Š : contsrained ¢å©«˜ gplan apo-eos Btypkin.Gplan_Code_Apo
38982>>>>>//                                                               Btypkin.Gplan_Code_Apo
38982>>>>>//                               ©«ž¤ §œ¨å§«à©ž ˜¬«ã, ¦ ¢¦š˜¨ ˜©£æª §¦¬ Ÿ˜ œ§ ¢œšœå
38982>>>>>//                               ©«¦ barticl, Ÿ˜ "­áœ " «ž¤ ®¨âà©ž/§å©«à©ž §¦¬ â®¦¬£œ
38982>>>>>//                               ›ž¢é©œ  ©«¦ §œ›å¦ Btypkin.Btypkin_Anti_Xp.
38982>>>>>//          2  "œ¢á«žª        : ¢å©«˜ customer
38982>>>>>//          3  "¨¦£žŸœ¬«ãª    : ¢å©«˜ vendor
38982>>>>>//          4  "Š¦ §¦å         : œá¤ «¦ modula ˜¥ ¦š¨á­à¤ §¦¬¢žŸœå ˜¬«æ¤¦£˜,
38982>>>>>//                               «æ«œ «¦¤ ©¬¤˜¢¢˜©æ£œ¤¦ ˜§¢éª «¦¤ §¢ž¡«¨¦¢¦š¦ç£œ.
38982>>>>>
38982>>>>>//† ©¬¤˜¢¢˜šã šå¤œ«˜  £œ ˜¥ æš¨˜­˜, á¨˜ §¨â§œ  ¤˜ š¤à¨å¦¬£œ œá¤ Ÿ˜ › ˜¡ ¤ã©¦¬£œ
38982>>>>>//£æ¤¦¤ 1 «ç§¦ ˜¥ ¦š¨á­à¤, ã §¦¢¢¦çª (§œ›å¦ Btypkin.Baxiokat_Code).
38982>>>>>//„á¤ ˜¬«æ œå¤˜  0, «æ«œ ©«¦ grid «¦¬ bmove ¦ user £˜ª ›ž¢é¤œ  baxiokat,
38982>>>>>//˜¢¢¦ éª «¦ §œ›å¦ œå¤˜  ¡¢œ ›à£â¤¦.
38982>>>>>
38982>>>>>Class Btypkin_DataDictionary  is a DataDictionary_Sec
38983>>>>>
38983>>>>>    Procedure Construct_Object
38984>>>>>              Forward Send Construct_Object
38986>>>>>
38986>>>>>              //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
38986>>>>>              //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
38986>>>>>              //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
38986>>>>>              //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
38986>>>>>              Property Integer piBarticl_dd  0
38987>>>>>              Property Integer piBmove_dd    0
38988>>>>>              Property Integer piBaxio_dd    0
38989>>>>>              Property Integer piBaxiokat_dd 0
38990>>>>>              Property Integer piMustNOTConstrain Public 0
38991>>>>>    End_Procedure   //construct_object
38992>>>>>
38992>>>>>//      //private
38992>>>>>//      //¡˜¢œå«˜  ˜§¦ «ž¤ private.Exit_Btypkin_Code
38992>>>>>//      Procedure private.Set_Prompt_Objects_of_all_Connected_DEOs Integer liPrompt_Object_id ;
38992>>>>>//                                                                 Integer liField            ;
38992>>>>>//                                                                 Integer iMustConstrain     ;
38992>>>>>//                                                                 String  sPelProm
38992>>>>>//                Integer iMax iCount iDEO liTemp liBarticl_dd iPelListID
38992>>>>>
38992>>>>>//                Move (sl100(Self)) to iPelListID
38992>>>>>//             //   den exei nohma giati den kanoyn tipota sthn lista
38992>>>>>//             //   If (iPelListID) Set piMustConstrain     Of iPelListID to 0
38992>>>>>//             //   If (iPelListID) Set psIsPromhtheyths    Of iPelListID to ''
38992>>>>>
38992>>>>>//                Get piBarticl_dd to liBarticl_dd
38992>>>>>//                If (liBarticl_dd <> 0);
38992>>>>>//                Begin //œá¤ æ¤«àª ¬§á¨®œ  client ddo £œ main file «¦ barticl
38992>>>>>//                     Get Data_Set_User_Interface_Count of liBarticl_dd to iMax
38992>>>>>//                     Decrement iMax
38992>>>>>//                     For iCount from 0 to iMax
38992>>>>>//                         Move (Data_Set_User_Interface(liBarticl_dd ,iCount)) to iDEO
38992>>>>>//                         Get Data_Field of iDEO Item 0 to liTemp
38992>>>>>//                         If (liTemp = liField);
38992>>>>>//                         Begin //œá¤ ™¨ž¡˜ deo (dfform?) §¦¬ ˜¤˜­â¨œ«˜  ©«¦ §œ›å¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
38992>>>>>//                            If (liPrompt_Object_id <> 0);
38992>>>>>//                               Begin
38992>>>>>//                                  Set Prompt_Object      of iDEO to liPrompt_Object_id
38992>>>>>//                                  Set Prompt_Button_Mode of iDEO to PB_promptOn
38992>>>>>//                                  If (iMustConstrain) Begin
38992>>>>>//                                  //   den exei nohma giati den kanoyn tipota sthn lista
38992>>>>>//                                  //  If (liPrompt_Object_id) Set piMustConstrain     Of liPrompt_Object_id to iMustConstrain
38992>>>>>//                                  //  If (liPrompt_Object_id) Set psIsPromhtheyths    Of liPrompt_Object_id to sPelProm
38992>>>>>//                                  End
38992>>>>>//                            End
38992>>>>>//                            Else Begin
38992>>>>>//                                Set Prompt_Object      of iDEO to 0
38992>>>>>//                                Set Prompt_Button_Mode of iDEO to PB_promptOff
38992>>>>>//                            End
38992>>>>>//                         End
38992>>>>>//                     Loop
38992>>>>>//                End
38992>>>>>//      End_Procedure //private.set_prompt_objects_of_all_connected_dEOS
38992>>>>>
38992>>>>>
38992>>>>>//    //private
38992>>>>>//    //¡˜¢œå«˜  ˜§æ: iexit «¦¬ btypkin_code
38992>>>>>//    //¡˜¢œå    «ã¤: private.Set_Prompt_Objects_of_all_Connected_DEOS
38992>>>>>//    //©œ«á¨œ      : «á prompt objects š ˜ «¦ barticl_anti, ˜¤á¢¦š˜ £œ «¦ btypkin_anti.
38992>>>>>//    Procedure private.Exit_Btypkin_Code Integer liField Integer liBtypkin_Code
38992>>>>>//              Integer liBtypkin_Anti1 liBaxiokat_Num liBtypkin_Anti2
38992>>>>>//              Integer liBaxiokat_dd liBarticl_dd
38992>>>>>//              String lsBarticlCode1
38992>>>>>
38992>>>>>//            // btypkin_anti
38992>>>>>//            // "-1" "ƒâ¤ “§á¨®œ "
38992>>>>>//            // "0"  "Data Entry"
38992>>>>>//            // "1"  "Š¦š˜¨ ˜©£é¤ ‚Š"
38992>>>>>//            // "2"  "”¦¨â˜ª"
38992>>>>>//            // "3"  "¨¦£žŸœ¬«é¤"
38992>>>>>//            // "5"  "Ž ‘¬¤˜¢¢˜©æ£œ¤¦ª"
38992>>>>>//            // "6"  "’œ¢.˜¨˜¢ã§«žª"
38992>>>>>
38992>>>>>
38992>>>>>
38992>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti1 to liBtypkin_Anti1
38992>>>>>//              Get Field_Current_Value Field Btypkin.Btypkin_Anti2 to liBtypkin_Anti2
38992>>>>>//              Case Begin
38992>>>>>//                   Case (liBtypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
38992>>>>>//                         Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code1 0 ''
38992>>>>>//                   Case Break
38992>>>>>
38992>>>>>//                   Case (liBtypkin_Anti1 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 ''
38992>>>>>//                   Case Break
38992>>>>>
38992>>>>>//                   Case (liBtypkin_Anti1 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> ¢ ©«˜ §œ¢˜«à¤
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code1 1 '1'
38992>>>>>//                   Case Break
38992>>>>>
38992>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code1 0 ''
38992>>>>>//                   Case Break
38992>>>>>//              Case End
38992>>>>>
38992>>>>>//              Case Begin
38992>>>>>//                   Case (liBtypkin_Anti2 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0 Field Barticl.Barticl_Code2 0 ''
38992>>>>>//                   Case Break
38992>>>>>
38992>>>>>//                   Case (liBtypkin_Anti2 = 2) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §œ¢á«œª
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 ''
38992>>>>>//                   Case Break
38992>>>>>
38992>>>>>//                   Case (liBtypkin_Anti2 = 3) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ §¨¦£žŸœ¬«âª=> Š ©«˜ œ¢˜«é¤
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs (SL100(Self)) Field Barticl.Barticl_Code2 1 '1'
38992>>>>>//                   Case Break
38992>>>>>
38992>>>>>//                   Case Else //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
38992>>>>>//                        Send private.Set_Prompt_Objects_of_all_Connected_DEOs 0  Field Barticl.Barticl_Code2 0 ''
38992>>>>>//                   Case Break
38992>>>>>//              Case End
38992>>>>>//    End_Procedure //private.exit_btypkin_code
38992>>>>>
38992>>>>>//    // New_Current_Record:
38992>>>>>
38992>>>>>//    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
38992>>>>>//        Integer liBtypkinCodeFldNum
38992>>>>>//        Forward Send New_Current_Record  iOldRec iNewRec
38992>>>>>//        Get_FieldNumber Btypkin.Btypkin_Code to liBtypkinCodeFldNum
38992>>>>>//        Send private.Exit_Btypkin_Code liBtypkinCodeFldNum Btypkin.Btypkin_Code
38992>>>>>//        // Insert Code Here
38992>>>>>//    End_Procedure   // New_Current_Record
38992>>>>>
38992>>>>>
38992>>>>>    //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
38992>>>>>    //™) ˜¤áš¤à©ž properties
38992>>>>>    //š) › ˜®œå¨ ©ž calculated §œ›åà¤
38992>>>>>    //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
38992>>>>>    //œ) œ¤ž£â¨à©ž properties after
38992>>>>>    Procedure Update
38993>>>>>
38993>>>>>              Forward Send Update
38995>>>>>
38995>>>>>              //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
38995>>>>>                Move SysCurXR.Company_Code  to Btypkin.Company_Code
38996>>>>>                Move SysCurXR.Branch_Code   to Btypkin.Branch_Code
38997>>>>>                Move SysCurXR.Year_Year     to Btypkin.Year_Year
38998>>>>>                Move SysCurXR.Year_Recr     to Btypkin.Year_Recr
38999>>>>>
38999>>>>>              //™) ˜¤áš¤à©ž properties
38999>>>>>
38999>>>>>              //š) › ˜®œå¨ ©ž calculated §œ›åà¤
38999>>>>>              //š.1:Gplan_Code_Apo1 (conditional)
38999>>>>>              //š.2:Gplan_Code_Eos1 (conditional)
38999>>>>>              If (Btypkin.Btypkin_Anti1 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
39001>>>>>             // gts 02/12/04 oxi gia titana
39001>>>>>             //      Move "" to Btypkin.Gplan_Code_Apo1
39001>>>>>             //      Move "" to Btypkin.Gplan_Code_Eos1
39001>>>>>              End
39001>>>>>>
39001>>>>>
39001>>>>>              //š.3:Gplan_Code_Apo2 (conditional)
39001>>>>>              //š.4:Gplan_Code_Eos2 (conditional)
39001>>>>>              If (Btypkin.Btypkin_Anti2 <> 1);              Begin //æ®  ˜§¦ šœ¤ ¡ã ¢¦š ©« ¡ã
39003>>>>>                   Move "" to Btypkin.Gplan_Code_Apo2
39004>>>>>                   Move "" to Btypkin.Gplan_Code_Eos2
39005>>>>>              End
39005>>>>>>
39005>>>>>
39005>>>>>              //š.3:gtypkin_rec0 (conditional)
39005>>>>>              Case Begin
39005>>>>>                   Case (Btypkin.Gtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
39007>>>>>//jsjsjs 24/01/2001
39007>>>>>//                         Clear Gtypkin
39007>>>>>//                         Move Btypkin.Company_Code to Gtypkin.Company_Code
39007>>>>>//                         Move Btypkin.Branch_Code  to Gtypkin.Branch_Code
39007>>>>>//                         Move Btypkin.Year_Year    to Gtypkin.Year_Year
39007>>>>>//                         Move Btypkin.Gtypkin_Code to Gtypkin.Gtypkin_Code
39007>>>>>//                         Find Eq Gtypkin by Index.1 //company_code+branch_code+year_year+gtypkin_code
39007>>>>>//                         If (Found = 1) Move Gtypkin.Gtypkin_Rec0 to Btypkin.Gtypkin_Rec0
39007>>>>>//                         Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ gtypkin_rec0, please reindex
39007>>>>>//jsjsjs 24/01/2001
39007>>>>>                   Case Break
39008>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  šœ¤ ¡ã ¢¦š ©« ¡ã
39008>>>>>                         Move 0 to Btypkin.Gtypkin_Rec0
39009>>>>>              Case End
39009>>>>>
39009>>>>>              //š.4:ctypkin_rec0 (conditional)
39009>>>>>              Case Begin
39009>>>>>                   Case (Btypkin.Ctypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §œ¢á«œª
39011>>>>>                         Clear Ctypkin
INCLUDING FILE: CTYPKIN.FD
39012>>>>>                         Move Btypkin.Company_Code to Ctypkin.Company_Code
39013>>>>>                         Move Btypkin.Branch_Code  to Ctypkin.Branch_Code
39014>>>>>                         Move Btypkin.Year_Year    to Ctypkin.Year_Year
39015>>>>>                         Move Btypkin.Ctypkin_Code to Ctypkin.Ctypkin_Code
39016>>>>>                         Find Eq Ctypkin by Index.1 //company_code+branch_code+year_year+Ctypkin_code
39017>>>>>>
39017>>>>>                         If (Found = 1) Begin
39019>>>>>                            Move Ctypkin.Ctypkin_Rec0 to Btypkin.Ctypkin_Rec0
39020>>>>>                            Move Ctypkin.Ctypkin_Recr to Btypkin.Ctypkin_Recr
39021>>>>>                         End
39021>>>>>>
39021>>>>>                         Else           Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Ctypkin_rec0, please reindex
39023>>>>>                   Case Break
39024>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §œ¢á«œª
39024>>>>>                         Move  0 to Btypkin.Ctypkin_Rec0
39025>>>>>                         Move '' to Btypkin.Ctypkin_Recr
39026>>>>>              Case End
39026>>>>>
39026>>>>>              //š.5:vtypkin_rec0 (conditional)
39026>>>>>              Case Begin
39026>>>>>                   Case (Btypkin.Vtypkin_Code <> 0) //œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
39028>>>>>                         //Clear Vtypkin
39028>>>>>                         //Move Btypkin.Company_Code to Vtypkin.Company_Code
39028>>>>>                         //Move Btypkin.Branch_Code  to Vtypkin.Branch_Code
39028>>>>>                         //Move Btypkin.Year_Year    to Vtypkin.Year_Year
39028>>>>>                         //Move Btypkin.Vtypkin_Code to Vtypkin.Vtypkin_Code
39028>>>>>                         //Find Eq Vtypkin by Index.1 //company_code+branch_code+year_year+Vtypkin_code
39028>>>>>                         //If (Found = 1) Move Vtypkin.Vtypkin_Rec0 to Btypkin.Vtypkin_Rec0
39028>>>>>                         //Else           Send Operation_Not_Allowed 3003 //›â¤ ™¨âŸž¡œ «¦ Vtypkin_rec0, please reindex
39028>>>>>                   Case Break
39029>>>>>                   Case Else                        //›â¤ œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
39029>>>>>                         Move 0 to Btypkin.Vtypkin_Rec0
39030>>>>>              Case End
39030>>>>>
39030>>>>>              //š.6:btypkin_l_hmnia (conditional)
39030>>>>>              If (Btypkin.Btypkin_L_No = 0) Move 0 to Btypkin.Btypkin_L_Hmnia
39033>>>>>
39033>>>>>
39033>>>>>              //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
39033>>>>>
39033>>>>>              //œ) œ¤ž£â¨à©ž properties after
39033>>>>>    End_Procedure //update
39034>>>>>
39034>>>>>    Procedure Creating
39035>>>>>              Forward Send Creating
39037>>>>>              //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBtypkin //˜¨ Ÿ£æª á¨Ÿ¨à¤ «žª ®¨ã©žª
39037>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Btypkin.Btypkin_Rec0)))))) to Btypkin.Btypkin_Recr
39038>>>>>    End_Procedure //creating
39039>>>>>
39039>>>>>//    Procedure OnConstrain
39039>>>>>//        Set piMustNOTConstrain to True
39039>>>>>        
39039>>>>>//        If (piMustNOTConstrain(Self)) Begin
39039>>>>>//        End
39039>>>>>//        Else Begin
39039>>>>>//            Constrain Btypkin.Company_Code  eq SysCurXR.Company_Code
39039>>>>>//            Constrain Btypkin.Branch_Code   eq SysCurXR.Branch_Code
39039>>>>>//            Constrain Btypkin.Year_Year     eq SysCurXR.Year_Year
39039>>>>>//        End
39039>>>>>//    End_Procedure
39039>>>>>
39039>>>>>
39039>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
39040>>>>>              String lsError_Message
39041>>>>>              Case Begin
39041>>>>>                   //˜§æ validate save
39041>>>>>                   Case (iError_Num = 1001)
39043>>>>>                        //Move ("DDC 141:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
39043>>>>>                        //to lsError_Message
39043>>>>>                   Case Break
39044>>>>>                   Case (iError_Num = 1100)
39047>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39048>>>>>                        Case Break
39049>>>>>
39049>>>>>                   //˜§æ validate delete
39049>>>>>                   Case (iError_Num = 2001)
39052>>>>>                        //Clear Codemast
39052>>>>>                        //Move ("DDC 141:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");
39052>>>>>                        //to lsError_Message
39052>>>>>                   Case Break
39053>>>>>                   Case (iError_Num = 2100)
39056>>>>>                        Move "DDC 141:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
39057>>>>>                        Case Break
39058>>>>>
39058>>>>>                   //˜§æ update
39058>>>>>                   Case (iError_Num = 3001)
39061>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «žª ‚œ¤ ¡ãª Š¦š ©« ¡ãª !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39062>>>>>                   Case Break
39063>>>>>                   Case (iError_Num = 3002)
39066>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ œ¢˜«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39067>>>>>                   Case Break
39068>>>>>                   Case (iError_Num = 3003)
39071>>>>>                        Move ("DDC 141:ƒâ¤ ™¨âŸž¡œ ž ˜¤«å©«¦ ®ž ¡å¤ž©ž «é¤ ¨¦£žŸœ¬«é¤ !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
39072>>>>>                   Case Break
39073>>>>>
39073>>>>>
39073>>>>>
39073>>>>>                   Case Else
39073>>>>>                        Forward Send Operation_Not_Allowed iError_Num
39075>>>>>              Case End
39075>>>>>
39075>>>>>              Error iError_Num lsError_Message
39076>>>>>>
39076>>>>>    End_Procedure // operation_not_allowed
39077>>>>>
39077>>>>>
39077>>>>>//    //1001:
39077>>>>>//    //˜§˜š¦¨œçœ«˜  «¦ btypkin ¤˜ ˜¢¢áœ  parent year
39077>>>>>//    Function Validate_Save Returns Integer
39077>>>>>//             Integer iReturnVal
39077>>>>>
39077>>>>>//             Forward Get Validate_Save to iReturnVal
39077>>>>>
39077>>>>>//             If (Not(iReturnVal));
39077>>>>>//             Begin
39077>>>>>//                  //1100:cby = globals
39077>>>>>//                  If ( ;
39077>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
39077>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
39077>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
39077>>>>>//                      )                                                   Send Operation_Not_Allowed 1100
39077>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
39077>>>>>//             Function_Return iReturnVal
39077>>>>>//    End_Function   // validate_save
39077>>>>>
39077>>>>>
39077>>>>>//    //2001:
39077>>>>>//    Function Validate_Delete  Returns Integer
39077>>>>>//             Integer iReturnVal
39077>>>>>//             Forward Get Validate_Delete  To iReturnVal
39077>>>>>//             If (Not(iReturnVal));
39077>>>>>//             Begin
39077>>>>>
39077>>>>>//                  //2100:cby = globals
39077>>>>>//                  If ( ;
39077>>>>>//                      (Not(Btypkin.Company_Code = SysCurXR.Company_Code))or ;
39077>>>>>//                      (Not(Btypkin.Branch_Code  = SysCurXR.Branch_Code)) or ;
39077>>>>>//                      (Not(Btypkin.Year_Year    = SysCurXR.Year_Year))      ;
39077>>>>>//                      )                                                   Send Operation_Not_Allowed 2100
39077>>>>>//             End //«â¢¦ª ¡é› ¡˜ validation
39077>>>>>//             Function_Return iReturnVal
39077>>>>>//    End_Function   // Validate_Delete
39077>>>>>
39077>>>>>
39077>>>>>    Procedure Define_Fields
39078>>>>>        Forward Send Define_Fields
39080>>>>>        //DDB-Generated-Code-Location
39080>>>>>        //DDB-DefineFieldStart
39080>>>>>
39080>>>>>        Set Main_File            To Btypkin.File_Number
39081>>>>>        Set Cascade_Delete_State To FALSE
39082>>>>>
39082>>>>>
39082>>>>>        // Child (Client) file structure................
39082>>>>>        Send Add_Client_File  Bflagkin.File_Number
39083>>>>>        Send Add_Client_File  Bkinkat.File_Number
39084>>>>>        Send Add_Client_File  Barticl.File_Number
39085>>>>>
39085>>>>>        // External (System) file structure.............
39085>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39086>>>>>
39086>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
39089>>>>>
39089>>>>>        // Field-based properties.......................
39089>>>>>
39089>>>>>        // Btypkin.Company_Code
39089>>>>>        //DDB/ Comment_Short       Field Btypkin.Company_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
39089>>>>>
39089>>>>>        // Btypkin.Branch_Code
39089>>>>>        //DDB/ Comment_Short       Field Btypkin.Branch_Code To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
39089>>>>>
39089>>>>>        // Btypkin.Year_Year
39089>>>>>        //DDB/ Comment_Short       Field Btypkin.Year_Year To "„¤ž£œ¨é¤œ«˜  ©«ž¤ update"
39089>>>>>
39089>>>>>        // Btypkin.Btypkin_Code
39089>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code To (SL031(Self))
39090>>>>>
39090>>>>>        // Btypkin.Btypkin_Rec0
39090>>>>>
39090>>>>>        // Btypkin.Btypkin_Recr
39090>>>>>
39090>>>>>        // Btypkin.Year_Recr
39090>>>>>
39090>>>>>        // Btypkin.Btypkin_Descr
39090>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr To (SL031(Self))
39091>>>>>
39091>>>>>        // Btypkin.Gtypkin_Code
39091>>>>>
39091>>>>>        // Btypkin.Ctypkin_Code
39091>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Code To (sl007(Self))
39092>>>>>
39092>>>>>        // Btypkin.Vtypkin_Code
39092>>>>>
39092>>>>>        // Btypkin.Gtypkin_Rec0
39092>>>>>
39092>>>>>        // Btypkin.Ctypkin_Rec0
39092>>>>>
39092>>>>>        // Btypkin.Vtypkin_Rec0
39092>>>>>
39092>>>>>        // Btypkin.Btypkin_Anti1
39092>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1 To (Bfile_VT(Self))
39093>>>>>
39093>>>>>        // Btypkin.Gplan_Code_Apo1
39093>>>>>
39093>>>>>        // Btypkin.Gplan_Code_Eos1
39093>>>>>
39093>>>>>        // Btypkin.Btypkin_Anti2
39093>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2 To (Bfile_VT(Self))
39094>>>>>
39094>>>>>        // Btypkin.Gplan_Code_Apo2
39094>>>>>
39094>>>>>        // Btypkin.Gplan_Code_Eos2
39094>>>>>
39094>>>>>        // Btypkin.Bflagkin_Num
39094>>>>>
39094>>>>>        // Btypkin.Bkinkat_Num
39094>>>>>        //DDB/ Comment_Short       Field Btypkin.Bkinkat_Num To "“§¦¢¦šåœ«˜  ©«ž¤ update «¦¬ bkinkat."
39094>>>>>
39094>>>>>        // Btypkin.Btypkin_Anti_Xp
39094>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp To (Btypkin_Btypkin_Anti_Xp_VT(Self))
39095>>>>>
39095>>>>>        // Btypkin.Btypkin_Printer
39095>>>>>
39095>>>>>        // Btypkin.Btypkin_Pdescr
39095>>>>>
39095>>>>>        // Btypkin.Btypkin_Form
39095>>>>>
39095>>>>>        // Btypkin.Btypkin_L_No
39095>>>>>
39095>>>>>        // Btypkin.Btypkin_L_Hmnia
39095>>>>>        Set Field_Mask_Type        Field Btypkin.Btypkin_L_Hmnia To MASK_DATE_WINDOW
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Seira
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Abr
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Flag01
39096>>>>>        //DDB/ Comment_Short       Field Btypkin.Btypkin_Flag01 To "“§¦¢¦šåœ«˜  ©«ž¤ update/backout «¦¬ bflagkin."
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Flag02
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Flag03
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Flag04
39096>>>>>
39096>>>>>        // Btypkin.Btypkin_Flag05
39096>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Flag05 To "1"  "0"
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag06
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag07
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag08
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag09
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag10
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag11
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag12
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag13
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag14
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag15
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag16
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag17
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag18
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag19
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Flag20
39097>>>>>
39097>>>>>        // Btypkin.Btypkin_Sign
39097>>>>>        Set Field_Checkbox_Values  Field Btypkin.Btypkin_Sign To "1"  "-1"
39098>>>>>
39098>>>>>        // Btypkin.Ctypkin_Recr
39098>>>>>        Set Field_Prompt_Object    Field Btypkin.Ctypkin_Recr To (sl007r(Self))
39099>>>>>
39099>>>>>        // Btypkin.Label
39099>>>>>
39099>>>>>        // Btypkin.Locked
39099>>>>>
39099>>>>>        // Btypkin.Locked_Date
39099>>>>>        Set Field_Mask_Type        Field Btypkin.Locked_Date To MASK_DATE_WINDOW
39100>>>>>
39100>>>>>        //DDB-DefineFieldEnd
39100>>>>>
39100>>>>>        Set Main_File            To Btypkin.File_Number
39101>>>>>        Set Cascade_Delete_State To FALSE
39102>>>>>
39102>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39103>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39104>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39105>>>>>
39105>>>>>        // Child (Client) file structure................
39105>>>>>        Send Add_Client_File  Bflagkin.File_Number
39106>>>>>        Send Add_Client_File  Barticl.File_Number
39107>>>>>        Send Add_Client_File  Bkinkat.File_Number
39108>>>>>
39108>>>>>        // External (System) file structure.............
39108>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39109>>>>>        //Send Add_System_File  Gtypkin.File_Number  DD_LOCK_ON_SAVE
39109>>>>>
39109>>>>>        Define_Auto_Increment  Sysrecb.Btypkin_Rec0  To Btypkin.Btypkin_Rec0
39112>>>>>
39112>>>>>        // Field-based properties.......................
39112>>>>>
39112>>>>>        // Btypkin.Company_Code
39112>>>>>
39112>>>>>        // Btypkin.Branch_Code
39112>>>>>
39112>>>>>        // Btypkin.Year_Year
39112>>>>>
39112>>>>>        // Btypkin.Btypkin_Code
39112>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Code     To "‰à› ¡æª ‰å¤ž©žª"
39113>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Code     To "‰å¤ž©ž"
39114>>>>>        Set Field_Options          Field Btypkin.Btypkin_Code     To DD_AUTOFIND    DD_REQUIRED
39115>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Code     To (sl031(Self))
39116>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Code     To TRUE
39117>>>>>
39117>>>>>        // Btypkin.Btypkin_Rec0
39117>>>>>        Set Field_Options          Field Btypkin.Btypkin_Rec0     To DD_AUTOFIND    DD_NOPUT       DD_REQUIRED
39118>>>>>        Set Key_Field_State        Field Btypkin.Btypkin_Rec0     To TRUE
39119>>>>>
39119>>>>>        // Btypkin.Year_Rec0
39119>>>>>
39119>>>>>        // Btypkin.Btypkin_Descr
39119>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã ‰å¤ž©žª"
39120>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Descr    To "œ¨ š¨˜­ã"
39121>>>>>        Set Field_Prompt_Object    Field Btypkin.Btypkin_Descr    To (sl031(Self))
39122>>>>>
39122>>>>>        // Btypkin.Gtypkin_Code
39122>>>>>        Set Field_Label_Long       Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
39123>>>>>        Set Field_Label_Short      Field Btypkin.Gtypkin_Code     To "‰å¤ž©ž ‚Š"
39124>>>>>        //Set Field_Prompt_Object    Field Btypkin.Gtypkin_Code     To (SL055(Self))
39124>>>>>
39124>>>>>        // Btypkin.Ctypkin_Code
39124>>>>>        Set Field_Label_Long       Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
39125>>>>>        Set Field_Label_Short      Field Btypkin.Ctypkin_Code     To "‰å¤ž©ž œ¢˜«é¤"
39126>>>>>
39126>>>>>        // Btypkin.Vtypkin_Code
39126>>>>>        Set Field_Label_Long       Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
39127>>>>>        Set Field_Label_Short      Field Btypkin.Vtypkin_Code     To "‰å¤ž©ž ¨¦£žŸœ¬«é¤"
39128>>>>>
39128>>>>>        // Btypkin.Gtypkin_Rec0
39128>>>>>        Set Field_Options          Field Btypkin.Gtypkin_Rec0     To DD_DISPLAYONLY
39129>>>>>
39129>>>>>        // Btypkin.Ctypkin_Rec0
39129>>>>>        Set Field_Options          Field Btypkin.Ctypkin_Rec0     To DD_DISPLAYONLY
39130>>>>>
39130>>>>>        // Btypkin.Vtypkin_Rec0
39130>>>>>        Set Field_Options          Field Btypkin.Vtypkin_Rec0     To DD_DISPLAYONLY
39131>>>>>
39131>>>>>        // Btypkin.Btypkin_Anti1
39131>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti1    To "dbComboForm_EZ"
39132>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª ˜§¦ ˜¨®œå¦:"
39133>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
39134>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti1    To (Bfile_VT(Self))
39135>>>>>
39135>>>>>        // Btypkin.Gplan_Code_Apo1
39135>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
39136>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo1  To "€§¦ ‰à› ¡æ ‚Š"
39137>>>>>
39137>>>>>        // Btypkin.Gplan_Code_Eos1
39137>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
39138>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos1  To "„àª ‰à› ¡æ ‚Š"
39139>>>>>
39139>>>>>        // Btypkin.Btypkin_Anti2
39139>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti2    To "dbComboForm_EZ"
39140>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª ˜§¦ ˜¨®œå¦:"
39141>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti2    To "˜¨˜¢ã§«žª"
39142>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti2    To (Bfile_VT(Self))
39143>>>>>
39143>>>>>        // Btypkin.Gplan_Code_Apo2
39143>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
39144>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Apo2  To "€§¦ ‰à› ¡æ ‚Š"
39145>>>>>
39145>>>>>        // Btypkin.Gplan_Code_Eos2
39145>>>>>        Set Field_Label_Long       Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
39146>>>>>        Set Field_Label_Short      Field Btypkin.Gplan_Code_Eos2  To "„àª ‰à› ¡æ ‚Š"
39147>>>>>
39147>>>>>        // Btypkin.Bflagkin_Num
39147>>>>>        Set Field_Label_Long       Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
39148>>>>>        Set Field_Label_Short      Field Btypkin.Bflagkin_Num     To "¢ãŸ¦ª Flags"
39149>>>>>        Set Field_Options          Field Btypkin.Bflagkin_Num     To DD_DISPLAYONLY
39150>>>>>
39150>>>>>        // Btypkin.Bkinkat_Num
39150>>>>>        Set Field_Label_Long       Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«žš¦¨ é¤ €¥ é¤"
39151>>>>>        Set Field_Label_Short      Field Btypkin.Bkinkat_Num      To "¢ãŸ¦ª ‰˜«.€¥ é¤"
39152>>>>>        Set Field_Options          Field Btypkin.Bkinkat_Num      To DD_DISPLAYONLY
39153>>>>>
39153>>>>>        // Btypkin.Btypkin_Anti_Xp
39153>>>>>        Set Field_Class_Name       Field Btypkin.Btypkin_Anti_Xp  To "dbComboForm_EZ"
39154>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Anti_Xp  To "Ž ©¬¤˜¢¢˜©æ£œ¤¦ª:"
39155>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Anti_Xp  To "• ‘¬¤˜¢¢˜©¦£â¤¦¬"
39156>>>>>        Set Field_Value_Table      Field Btypkin.Btypkin_Anti_Xp  To (Btypkin_Btypkin_Anti_Xp_VT(Self))
39157>>>>>
39157>>>>>        // Btypkin.Btypkin_Printer
39157>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Printer  To "ƒ œçŸ¬¤©ž „¡«¬§à«ã"
39158>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Printer  To "„¡«¬§à«ãª"
39159>>>>>
39159>>>>>        // Btypkin.Btypkin_Pdescr
39159>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
39160>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Pdescr   To "’å«¢¦ª „¡«ç§à©žª"
39161>>>>>
39161>>>>>        // Btypkin.Btypkin_Form
39161>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Form     To "”æ¨£˜ „¡«ç§à©žª"
39162>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Form     To "”æ¨£˜"
39163>>>>>
39163>>>>>        // Btypkin.Btypkin_L_No
39163>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_No     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
39164>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_No     To "’œ¢.€¨."
39165>>>>>        //Set Field_Options          Field Btypkin.Btypkin_L_No     To DD_DISPLAYONLY
39165>>>>>
39165>>>>>        // Btypkin.Btypkin_L_Hmnia
39165>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_L_Hmnia  To "’œ¢œ¬«˜å˜ †£/¤å˜"
39166>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_L_Hmnia  To "’œ¢.†£/¤å˜"
39167>>>>>        Set Field_Options          Field Btypkin.Btypkin_L_Hmnia  To DD_DISPLAYONLY
39168>>>>>
39168>>>>>        // Btypkin.Btypkin_Seira
39168>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
39169>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Seira    To "‘œ ¨á"
39170>>>>>
39170>>>>>        // Btypkin.Btypkin_Abr
39170>>>>>        Set Field_Label_Long       Field Btypkin.Btypkin_Abr      To "‘¬¤«¦£¦š¨˜­å˜"
39171>>>>>        Set Field_Label_Short      Field Btypkin.Btypkin_Abr      To "‘¬¤«/­å˜"
39172>>>>>
39172>>>>>        // Btypkin.Btypkin_Flag01
39172>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag01   To DD_DISPLAYONLY
39173>>>>>
39173>>>>>        // Btypkin.Btypkin_Flag02
39173>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag02   To DD_DISPLAYONLY
39174>>>>>
39174>>>>>        // Btypkin.Btypkin_Flag03
39174>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag03   To DD_DISPLAYONLY
39175>>>>>
39175>>>>>        // Btypkin.Btypkin_Flag04
39175>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag04   To DD_DISPLAYONLY
39176>>>>>
39176>>>>>        // Btypkin.Btypkin_Flag05
39176>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag05   To DD_DISPLAYONLY
39177>>>>>
39177>>>>>        // Btypkin.Btypkin_Flag06
39177>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag06   To DD_DISPLAYONLY
39178>>>>>
39178>>>>>        // Btypkin.Btypkin_Flag07
39178>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag07   To DD_DISPLAYONLY
39179>>>>>
39179>>>>>        // Btypkin.Btypkin_Flag08
39179>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag08   To DD_DISPLAYONLY
39180>>>>>
39180>>>>>        // Btypkin.Btypkin_Flag09
39180>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag09   To DD_DISPLAYONLY
39181>>>>>
39181>>>>>        // Btypkin.Btypkin_Flag10
39181>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag10   To DD_DISPLAYONLY
39182>>>>>
39182>>>>>        // Btypkin.Btypkin_Flag11
39182>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag11   To DD_DISPLAYONLY
39183>>>>>
39183>>>>>        // Btypkin.Btypkin_Flag12
39183>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag12   To DD_DISPLAYONLY
39184>>>>>
39184>>>>>        // Btypkin.Btypkin_Flag13
39184>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag13   To DD_DISPLAYONLY
39185>>>>>
39185>>>>>        // Btypkin.Btypkin_Flag14
39185>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag14   To DD_DISPLAYONLY
39186>>>>>
39186>>>>>        // Btypkin.Btypkin_Flag15
39186>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag15   To DD_DISPLAYONLY
39187>>>>>
39187>>>>>        // Btypkin.Btypkin_Flag16
39187>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag16   To DD_DISPLAYONLY
39188>>>>>
39188>>>>>        // Btypkin.Btypkin_Flag17
39188>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag17   To DD_DISPLAYONLY
39189>>>>>
39189>>>>>        // Btypkin.Btypkin_Flag18
39189>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag18   To DD_DISPLAYONLY
39190>>>>>
39190>>>>>        // Btypkin.Btypkin_Flag19
39190>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag19   To DD_DISPLAYONLY
39191>>>>>
39191>>>>>        // Btypkin.Btypkin_Flag20
39191>>>>>        Set Field_Options          Field Btypkin.Btypkin_Flag20   To DD_DISPLAYONLY
39192>>>>>
39192>>>>>    End_Procedure    // Define_Fields
39193>>>>>
39193>>>>>
39193>>>>>
39193>>>>>    // Field_Defaults:
39193>>>>>    // This procedure is used to establish default field values.
39193>>>>>
39193>>>>>    Procedure Field_Defaults
39194>>>>>        Forward Send Field_Defaults
39196>>>>>        //DDB-Generated-Code-Location
39196>>>>>        //DDB-FieldDefaultStart
39196>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti1 To 0
39197>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti2 To 0
39198>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Anti_Xp To 1
39199>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Flag05 To 0
39200>>>>>        Set Field_Changed_Value   Field Btypkin.Btypkin_Sign To 1
39201>>>>>        //DDB-FieldDefaultEnd
39201>>>>>    End_Procedure    // Field_Defaults
39202>>>>>End_Class    // Btypkin_DataDictionary
39203>>>>>//DDB-Selection-pkg-Start
39203>>>>>
39203>>>>>Use SL031.SL         // SL031
INCLUDING FILE: SL031.SL
39203>>>>>>>//AB/ Project SL031:BTYPKIN
39203>>>>>>>//AB/ Object prj is a Lookup_Project
39203>>>>>>>//AB/     Set ProjectName to "SL031:BTYPKIN"
39203>>>>>>>//AB/     Set ProjectFileName to "SL031.SL"
39203>>>>>>>
39203>>>>>>>// Project Object Structure
39203>>>>>>>//   SL031 is a dbModalPanelSub
39203>>>>>>>//     Btypkin_DD is a DataDictionary
39203>>>>>>>//     oSelList is a dbListSub
39203>>>>>>>//     oOK_bn is a ButtonSub
39203>>>>>>>//     oCancel_bn is a ButtonSub
39203>>>>>>>//     oSearch_bn is a ButtonSub
39203>>>>>>>
39203>>>>>>>// Register all objects
39203>>>>>>>Register_Object Btypkin_DD
39203>>>>>>>Register_Object oCancel_bn
39203>>>>>>>Register_Object oOK_bn
39203>>>>>>>Register_Object oSearch_bn
39203>>>>>>>Register_Object oSelList
39203>>>>>>>Register_Object SL031
39203>>>>>>>
39203>>>>>>>
39203>>>>>>>//AB-IgnoreStart
39203>>>>>>>
39203>>>>>>>Use DFAllEnt.pkg
39203>>>>>>>Use dbList.Sub
39203>>>>>>>Use Button.Sub
39203>>>>>>>
39203>>>>>>>
39203>>>>>>>Use BTYPKIN.DD
39203>>>>>>>
39203>>>>>>>//AB-IgnoreEnd
39203>>>>>>>
39203>>>>>>>CD_Popup_Object SL031 is a dbModalPanelSub
39222>>>>>>>    Set Label to "‰ ¤ã©œ ª  €¥ ¦š¨á­à¤"
39223>>>>>>>    Set Size to 213 506
39224>>>>>>>    Set Location to 4 5
39225>>>>>>>    Set Exit_Application_Local_State to FALSE
39226>>>>>>>    Set Modal_State to FALSE
39227>>>>>>>
39227>>>>>>>    //AB-DDOStart
39227>>>>>>>
39227>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
39229>>>>>>>    End_Object    // Btypkin_DD
39230>>>>>>>
39230>>>>>>>    Set Main_DD to (Btypkin_DD(self))
39231>>>>>>>    Set Server to (Btypkin_DD(self))
39232>>>>>>>
39232>>>>>>>    //AB-DDOEnd
39232>>>>>>>
39232>>>>>>>    Object oSelList is a dbListSub
39234>>>>>>>        Set Main_File to Btypkin.File_Number
39235>>>>>>>        Set Size to 173 491
39236>>>>>>>        Set Location to 3 6
39237>>>>>>>
39237>>>>>>>        Begin_Row
39240>>>>>>>            Entry_Item Btypkin.Btypkin_code
39241>>>>>>>            Entry_Item Btypkin.Btypkin_descr
39242>>>>>>>            Entry_Item Btypkin.Gtypkin_code
39243>>>>>>>            Entry_Item Btypkin.Ctypkin_code
39244>>>>>>>            Entry_Item Btypkin.Vtypkin_code
39245>>>>>>>            Entry_Item Btypkin.Btypkin_anti_xp
39246>>>>>>>            Entry_Item Btypkin.Locked
39247>>>>>>>        End_Row
39252>>>>>>>
39252>>>>>>>        Set Form_Width    item 0 to 39
39253>>>>>>>        Set Header_Label  item 0 to "‰å¤ž©ž"
39254>>>>>>>        
39254>>>>>>>        Set Form_Width    item 1 to 172
39255>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
39256>>>>>>>        
39256>>>>>>>        Set Form_Width    item 2 to 46
39257>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž ‚Š"
39258>>>>>>>        
39258>>>>>>>        Set Form_Width    item 3 to 70
39259>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž œ¢˜«é¤        "
39260>>>>>>>        
39260>>>>>>>        Set Form_Width    item 4 to 53
39261>>>>>>>        Set Header_Label  item 4 to "‰å¤ž©ž ¨¦£."
39262>>>>>>>        
39262>>>>>>>        Set Form_Width    item 5 to 64
39263>>>>>>>        Set Header_Label  item 5 to "• ‘¬¤˜¢¢˜©¦£."
39264>>>>>>>        
39264>>>>>>>        Set Form_Width    item 6 to 42
39265>>>>>>>        Set Header_Label  item 6 to "‰¢œ ›à£â¤ž"
39266>>>>>>>        Set Column_Checkbox_State  item 6 to True
39267>>>>>>>        
39267>>>>>>>    End_Object    // oSelList
39268>>>>>>>
39268>>>>>>>    Object oOK_bn is a ButtonSub
39270>>>>>>>        Set Label to "&„§ ¢¦šã"
39271>>>>>>>        Set Location to 177 337
39272>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39273>>>>>>>
39273>>>>>>>        //AB-StoreStart
39273>>>>>>>        Procedure OnClick
39275>>>>>>>            Send OK To oSelList
39276>>>>>>>        End_Procedure
39277>>>>>>>        //AB-StoreEnd
39277>>>>>>>
39277>>>>>>>    End_Object    // oOK_bn
39278>>>>>>>
39278>>>>>>>    Object oCancel_bn is a ButtonSub
39280>>>>>>>        Set Label to "&€¡ç¨à©ž"
39281>>>>>>>        Set Location to 177 393
39282>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39283>>>>>>>
39283>>>>>>>        //AB-StoreStart
39283>>>>>>>        Procedure OnClick
39285>>>>>>>            Send Cancel To oSelList
39286>>>>>>>        End_Procedure
39287>>>>>>>        //AB-StoreEnd
39287>>>>>>>
39287>>>>>>>    End_Object    // oCancel_bn
39288>>>>>>>
39288>>>>>>>    Object oSearch_bn is a ButtonSub
39290>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39291>>>>>>>        Set Location to 177 447
39292>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39293>>>>>>>
39293>>>>>>>        //AB-StoreStart
39293>>>>>>>        Procedure OnClick
39295>>>>>>>            Send Search To oSelList
39296>>>>>>>        End_Procedure
39297>>>>>>>        //AB-StoreEnd
39297>>>>>>>
39297>>>>>>>    End_Object    // oSearch_bn
39298>>>>>>>
39298>>>>>>>
39298>>>>>>>    //AB-StoreStart
39298>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
39299>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
39300>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
39301>>>>>>>    
39301>>>>>>>    //AB-StoreEnd
39301>>>>>>>
39301>>>>>>>CD_End_Object    // SL031
39303>>>>>>>>
39303>>>>>>>
39303>>>>>>>//AB/ End_Object    // prj
39303>>>>>Use sl007.SL         // sl007
INCLUDING FILE: SL007.SL
39303>>>>>>>//AB/ Project Ctypkin : sl007
39303>>>>>>>//AB/ Object prj is a Lookup_Project
39303>>>>>>>//AB/     Set ProjectName to "Ctypkin : sl007"
39303>>>>>>>//AB/     Set ProjectFileName to "sl007.SL"
39303>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39303>>>>>>>
39303>>>>>>>// Project Object Structure
39303>>>>>>>//   sl007 is a dbModalPanelSub
39303>>>>>>>//     Ctypkin_DD is a DataDictionary
39303>>>>>>>//     oSelList is a dbListSub
39303>>>>>>>//     oOK_bn is a ButtonSub
39303>>>>>>>//     oCancel_bn is a ButtonSub
39303>>>>>>>//     oSearch_bn is a ButtonSub
39303>>>>>>>
39303>>>>>>>// Register all objects
39303>>>>>>>Register_Object Ctypkin_DD
39303>>>>>>>Register_Object oCancel_bn
39303>>>>>>>Register_Object oOK_bn
39303>>>>>>>Register_Object oSearch_bn
39303>>>>>>>Register_Object oSelList
39303>>>>>>>Register_Object sl007
39303>>>>>>>
39303>>>>>>>
39303>>>>>>>//AB-IgnoreStart
39303>>>>>>>
39303>>>>>>>Use DFAllEnt.pkg
39303>>>>>>>Use dbList.Sub
39303>>>>>>>Use Button.Sub
39303>>>>>>>
39303>>>>>>>
39303>>>>>>>Use CTYPKIN.DD
INCLUDING FILE: CTYPKIN.DD
39303>>>>>>>>>//DDB-FileStart
39303>>>>>>>>>//DDB-HeaderStart
39303>>>>>>>>>
39303>>>>>>>>>// File Name : CTYPKIN.DD
39303>>>>>>>>>// Class Name: Ctypkin_DataDictionary
39303>>>>>>>>>// Revision  : 70
39303>>>>>>>>>// Version   : 2
39303>>>>>>>>>
39303>>>>>>>>>Use  Windows           // Basic Definitions
39303>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
39303>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39303>>>>>>>>>
39303>>>>>>>>>Open Ctypkin
39305>>>>>>>>>Open Cmoves
39307>>>>>>>>>Open Cflagkin
INCLUDING FILE: CFLAGKIN.FD
39309>>>>>>>>>Open Ptypparl
39311>>>>>>>>>Open Ptyppar
INCLUDING FILE: PTYPPAR.FD
39313>>>>>>>>>Open Hmctyp
INCLUDING FILE: HMCTYP.FD
39315>>>>>>>>>Open Cmovesa
39317>>>>>>>>>Open Sysrecc
39319>>>>>>>>>Open Syscurxr
39321>>>>>>>>>
39321>>>>>>>>>//DDB-HeaderEnd
39321>>>>>>>>>//DDB-ValidationStart
39321>>>>>>>>>
39321>>>>>>>>>Register_Object Ctypkin_Ctypkin_Module_VT
39321>>>>>>>>>
39321>>>>>>>>>Object Ctypkin_Ctypkin_Module_VT  is a CodeValidationTable
39323>>>>>>>>>    Set Type_Value        To "MODULE"
39324>>>>>>>>>    //DDB-ValidationCustomStart
39324>>>>>>>>>    //DDB-ValidationCustomEnd
39324>>>>>>>>>End_Object   // Ctypkin_Ctypkin_Module_VT
39325>>>>>>>>>//DDB-ValidationEnd
39325>>>>>>>>>//DDB-SelectionStart
39325>>>>>>>>>//DDB/ ExternalSelectionList sl007  sl007.SL
39325>>>>>>>>>Register_Object sl007
39325>>>>>>>>>//DDB-SelectionEnd
39325>>>>>>>>>
39325>>>>>>>>>Class Ctypkin_DataDictionary  is a DataDictionary
39326>>>>>>>>>         
39326>>>>>>>>>    Procedure Construct_Object
39327>>>>>>>>>        Forward Send Construct_Object
39329>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
39330>>>>>>>>>    End_Procedure
39331>>>>>>>>>
39331>>>>>>>>>    Procedure Save_Main_File
39332>>>>>>>>>        If (Operation_Origin<>Self) Begin
39334>>>>>>>>>            If Ctypkin.Recnum Eq 0 Procedure_Return
39337>>>>>>>>>        End
39337>>>>>>>>>>
39337>>>>>>>>>        Forward Send Save_Main_File
39339>>>>>>>>>    End_Procedure
39340>>>>>>>>>
39340>>>>>>>>>     Procedure Creating
39341>>>>>>>>>        Forward Send Creating
39343>>>>>>>>>        // Insert Code Here
39343>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ctypkin.Ctypkin_Rec0)))))) to Ctypkin.Ctypkin_Recr
39344>>>>>>>>>    End_Procedure   // Creating
39345>>>>>>>>>
39345>>>>>>>>>
39345>>>>>>>>>    // Define_Fields:
39345>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39345>>>>>>>>>
39345>>>>>>>>>    Procedure Define_Fields
39346>>>>>>>>>        Forward Send Define_Fields
39348>>>>>>>>>        //DDB-Generated-Code-Location
39348>>>>>>>>>        //DDB-DefineFieldStart
39348>>>>>>>>>
39348>>>>>>>>>        Set Main_File            To Ctypkin.File_Number
39349>>>>>>>>>        Set Cascade_Delete_State To FALSE
39350>>>>>>>>>
39350>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39351>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39352>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39353>>>>>>>>>
39353>>>>>>>>>        // Child (Client) file structure................
39353>>>>>>>>>        Send Add_Client_File  Cmoves.File_Number
39354>>>>>>>>>        Send Add_Client_File  Cflagkin.File_Number
39355>>>>>>>>>        Send Add_Client_File  Ptypparl.File_Number
39356>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
39357>>>>>>>>>        Send Add_Client_File  Hmctyp.File_Number
39358>>>>>>>>>        Send Add_Client_File  Cmovesa.File_Number
39359>>>>>>>>>
39359>>>>>>>>>        // External (System) file structure.............
39359>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
39360>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
39361>>>>>>>>>
39361>>>>>>>>>        Define_Auto_Increment  Sysrecc.Ctypkin_Rec0  To Ctypkin.Ctypkin_Rec0
39364>>>>>>>>>
39364>>>>>>>>>        // Field-based properties.......................
39364>>>>>>>>>
39364>>>>>>>>>        // Ctypkin.Company_Code
39364>>>>>>>>>
39364>>>>>>>>>        // Ctypkin.Branch_Code
39364>>>>>>>>>
39364>>>>>>>>>        // Ctypkin.Year_Year
39364>>>>>>>>>
39364>>>>>>>>>        // Ctypkin.Ctypkin_Code
39364>>>>>>>>>        Set Field_Options          Field Ctypkin.Ctypkin_Code To DD_AUTOFIND   
39365>>>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Code To (sl007(Self))
39366>>>>>>>>>        Set Key_Field_State        Field Ctypkin.Ctypkin_Code To TRUE
39367>>>>>>>>>
39367>>>>>>>>>        // Ctypkin.Ctypkin_Rec0
39367>>>>>>>>>
39367>>>>>>>>>        // Ctypkin.Ctypkin_Recr
39367>>>>>>>>>
39367>>>>>>>>>        // Ctypkin.Year_Recr
39367>>>>>>>>>
39367>>>>>>>>>        // Ctypkin.Ctypkin_Descr
39367>>>>>>>>>        Set Field_Prompt_Object    Field Ctypkin.Ctypkin_Descr To (sl007(Self))
39368>>>>>>>>>
39368>>>>>>>>>        // Ctypkin.Ctypkin_Anti
39368>>>>>>>>>
39368>>>>>>>>>        // Ctypkin.Ctypkin_Flags
39368>>>>>>>>>
39368>>>>>>>>>        // Ctypkin.Ctypkin_Module
39368>>>>>>>>>        Set Field_Value_Table      Field Ctypkin.Ctypkin_Module To (Ctypkin_Ctypkin_Module_VT(Self))
39369>>>>>>>>>
39369>>>>>>>>>        // Ctypkin.Open_Item
39369>>>>>>>>>
39369>>>>>>>>>        // Ctypkin.Check_Overhead
39369>>>>>>>>>
39369>>>>>>>>>        // Ctypkin.Max_Days_Sx_Par
39369>>>>>>>>>
39369>>>>>>>>>        // Ctypkin.Singular
39369>>>>>>>>>
39369>>>>>>>>>        // Ctypkin.Sub
39369>>>>>>>>>
39369>>>>>>>>>        // Ctypkin.Subreport
39369>>>>>>>>>
39369>>>>>>>>>        //DDB-DefineFieldEnd
39369>>>>>>>>>    End_Procedure    // Define_Fields
39370>>>>>>>>>
39370>>>>>>>>>    // Field_Defaults:
39370>>>>>>>>>    // This procedure is used to establish default field values.
39370>>>>>>>>>
39370>>>>>>>>>    Procedure Field_Defaults
39371>>>>>>>>>        Forward Send Field_Defaults
39373>>>>>>>>>        //DDB-Generated-Code-Location
39373>>>>>>>>>        //DDB-FieldDefaultStart
39373>>>>>>>>>        //DDB-FieldDefaultEnd
39373>>>>>>>>>    End_Procedure    // Field_Defaults
39374>>>>>>>>>
39374>>>>>>>>>End_Class    // Ctypkin_DataDictionary
39375>>>>>>>>>//DDB-Selection-pkg-Start
39375>>>>>>>>>
39375>>>>>>>>>Use sl007.SL         // sl007
39375>>>>>>>>>
39375>>>>>>>>>//DDB-Selection-pkg-End
39375>>>>>>>>>//DDB-FileEnd
39375>>>>>>>
39375>>>>>>>//AB-IgnoreEnd
39375>>>>>>>
39375>>>>>>>Object sl007 is a dbModalPanelSub
39377>>>>>>>
39377>>>>>>>    //AB-StoreTopStart
39377>>>>>>>    Property String psModule Public ''
39379>>>>>>>    
39379>>>>>>>    //AB-StoreTopEnd
39379>>>>>>>
39379>>>>>>>    Set Label to "‰ ¤ã©œ ª    "
39380>>>>>>>    Set Size to 148 350
39381>>>>>>>    Set Location to 4 7
39382>>>>>>>    Set Exit_Application_Local_State to FALSE
39383>>>>>>>    Set Modal_State to FALSE
39384>>>>>>>
39384>>>>>>>    //AB-DDOStart
39384>>>>>>>
39384>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
39386>>>>>>>
39386>>>>>>>        //AB-StoreStart
39386>>>>>>>                                
39386>>>>>>>        Begin_Constraints
39388>>>>>>>            If (psModule(sl007(Self))<>'') Constrain Ctypkin.Ctypkin_Module eq (psModule(sl007(Self)))
39392>>>>>>>        End_Constraints
39395>>>>>>>        
39395>>>>>>>        
39395>>>>>>>        
39395>>>>>>>        
39395>>>>>>>        //AB-StoreEnd
39395>>>>>>>
39395>>>>>>>    End_Object    // Ctypkin_DD
39396>>>>>>>
39396>>>>>>>    Set Main_DD to (Ctypkin_DD(self))
39397>>>>>>>    Set Server to (Ctypkin_DD(self))
39398>>>>>>>
39398>>>>>>>    //AB-DDOEnd
39398>>>>>>>
39398>>>>>>>    Object oSelList is a dbListSub
39400>>>>>>>        Set Main_File to Ctypkin.File_Number
39401>>>>>>>        Set Size to 105 335
39402>>>>>>>        Set Location to 6 6
39403>>>>>>>
39403>>>>>>>        Begin_Row
39406>>>>>>>            Entry_Item Ctypkin.Ctypkin_code
39407>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
39408>>>>>>>        End_Row
39413>>>>>>>
39413>>>>>>>        Set Form_Width    item 0 to 71
39414>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª ‰ ¤ã©œàª"
39415>>>>>>>        
39415>>>>>>>        Set Form_Width    item 1 to 255
39416>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã ‰ ¤ã©œàª"
39417>>>>>>>        
39417>>>>>>>
39417>>>>>>>        //AB-StoreStart
39417>>>>>>>                    
39417>>>>>>>                    
39417>>>>>>>        Procedure Activate
39419>>>>>>>            Forward Send Activate
39421>>>>>>>            Send Beginning_Of_Data to oSelList True
39422>>>>>>>        End_Procedure
39423>>>>>>>        
39423>>>>>>>        
39423>>>>>>>        
39423>>>>>>>        
39423>>>>>>>        //AB-StoreEnd
39423>>>>>>>
39423>>>>>>>    End_Object    // oSelList
39424>>>>>>>
39424>>>>>>>    Object oOK_bn is a ButtonSub
39426>>>>>>>        Set Label to "&„§ ¢¦šã"
39427>>>>>>>        Set Location to 113 171
39428>>>>>>>
39428>>>>>>>        //AB-StoreStart
39428>>>>>>>        Procedure OnClick
39430>>>>>>>            Send OK To (oSelList(current_object))
39431>>>>>>>        End_Procedure
39432>>>>>>>        //AB-StoreEnd
39432>>>>>>>
39432>>>>>>>    End_Object    // oOK_bn
39433>>>>>>>
39433>>>>>>>    Object oCancel_bn is a ButtonSub
39435>>>>>>>        Set Label to "&€¡ç¨à©ž"
39436>>>>>>>        Set Location to 113 226
39437>>>>>>>
39437>>>>>>>        //AB-StoreStart
39437>>>>>>>        Procedure OnClick
39439>>>>>>>            Send Cancel To (oSelList(current_object))
39440>>>>>>>        End_Procedure
39441>>>>>>>        //AB-StoreEnd
39441>>>>>>>
39441>>>>>>>    End_Object    // oCancel_bn
39442>>>>>>>
39442>>>>>>>    Object oSearch_bn is a ButtonSub
39444>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
39445>>>>>>>        Set Location to 113 281
39446>>>>>>>
39446>>>>>>>        //AB-StoreStart
39446>>>>>>>        Procedure OnClick
39448>>>>>>>            Send Search To (oSelList(current_object))
39449>>>>>>>        End_Procedure
39450>>>>>>>        //AB-StoreEnd
39450>>>>>>>
39450>>>>>>>    End_Object    // oSearch_bn
39451>>>>>>>
39451>>>>>>>
39451>>>>>>>    //AB-StoreStart
39451>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39452>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39453>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39454>>>>>>>    
39454>>>>>>>    Procedure Activate Returns Integer
39456>>>>>>>        Integer rVal
39457>>>>>>>        Send Rebuild_Constraints to Ctypkin_DD
39458>>>>>>>        Forward Get Msg_Activate to rVal
39460>>>>>>>        Procedure_Return rVal
39461>>>>>>>    End_Procedure
39462>>>>>>>    
39462>>>>>>>    //AB-StoreEnd
39462>>>>>>>
39462>>>>>>>End_Object    // sl007
39463>>>>>>>
39463>>>>>>>//AB/ End_Object    // prj
39463>>>>>Use sl007r.SL        // sl007r
INCLUDING FILE: SL007R.SL
39463>>>>>>>//AB/ Project sl007r:Ctypkin lookup with RecR 1st Col
39463>>>>>>>//AB/     Object prj is a Lookup_Project
39463>>>>>>>//AB/         Set ProjectName to "sl007r:Ctypkin lookup with RecR 1st Col"
39463>>>>>>>//AB/         Set ProjectFileName to "sl007r.SL"
39463>>>>>>>//AB/         Set GenerateFileName to "NONAME"
39463>>>>>>>
39463>>>>>>>// Project Object Structure
39463>>>>>>>//   sl007r is a dbModalPanelSub
39463>>>>>>>//     Ctypkin_DD is a DataDictionary
39463>>>>>>>//     oSelList is a dbListSub
39463>>>>>>>//     oOK_bn is a ButtonSub
39463>>>>>>>//     oCancel_bn is a ButtonSub
39463>>>>>>>//     oSearch_bn is a ButtonSub
39463>>>>>>>
39463>>>>>>>// Register all objects
39463>>>>>>>Register_Object Ctypkin_DD
39463>>>>>>>Register_Object oCancel_bn
39463>>>>>>>Register_Object oOK_bn
39463>>>>>>>Register_Object oSearch_bn
39463>>>>>>>Register_Object oSelList
39463>>>>>>>Register_Object sl007r
39463>>>>>>>
39463>>>>>>>
39463>>>>>>>    //AB-IgnoreStart
39463>>>>>>>
39463>>>>>>>    Use DFAllEnt.pkg
39463>>>>>>>    Use dbList.Sub
39463>>>>>>>    Use Button.Sub
39463>>>>>>>
39463>>>>>>>
39463>>>>>>>    Use CTYPKIN.DD
39463>>>>>>>    
39463>>>>>>>    //AB-IgnoreEnd
39463>>>>>>>
39463>>>>>>>    CD_Popup_Object sl007r is a dbModalPanelSub
39482>>>>>>>        Set Label to "Ctypkin"
39483>>>>>>>        Set Size to 148 480
39484>>>>>>>        Set Location to 12 16
39485>>>>>>>        Set Exit_Application_Local_State to FALSE
39486>>>>>>>        Set Modal_State to FALSE
39487>>>>>>>
39487>>>>>>>        //AB-DDOStart
39487>>>>>>>
39487>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
39489>>>>>>>        End_Object    // Ctypkin_DD
39490>>>>>>>
39490>>>>>>>        Set Main_DD to (Ctypkin_DD(self))
39491>>>>>>>        Set Server to (Ctypkin_DD(self))
39492>>>>>>>
39492>>>>>>>        //AB-DDOEnd
39492>>>>>>>
39492>>>>>>>        Object oSelList is a dbListSub
39494>>>>>>>            Set Main_File to Ctypkin.File_Number
39495>>>>>>>            Set Size to 105 465
39496>>>>>>>            Set Location to 6 6
39497>>>>>>>
39497>>>>>>>            Begin_Row
39500>>>>>>>                Entry_Item Ctypkin.Ctypkin_recr
39501>>>>>>>                Entry_Item Ctypkin.Ctypkin_code
39502>>>>>>>                Entry_Item Ctypkin.Ctypkin_descr
39503>>>>>>>                Entry_Item Ctypkin.Ctypkin_anti
39504>>>>>>>            End_Row
39509>>>>>>>
39509>>>>>>>            Set Form_Width    item 0 to 72
39510>>>>>>>            Set Header_Label  item 0 to "RecR"
39511>>>>>>>            
39511>>>>>>>            Set Form_Width    item 1 to 58
39512>>>>>>>            Set Header_Label  item 1 to "Ctypkin code"
39513>>>>>>>            
39513>>>>>>>            Set Form_Width    item 2 to 209
39514>>>>>>>            Set Header_Label  item 2 to "Ctypkin descr"
39515>>>>>>>            
39515>>>>>>>            Set Form_Width    item 3 to 120
39516>>>>>>>            Set Header_Label  item 3 to "Ctypkin anti"
39517>>>>>>>            
39517>>>>>>>
39517>>>>>>>            //AB-StoreStart
39517>>>>>>>            
39517>>>>>>>            Set Column_Option Item 0 to Noenter True
39518>>>>>>>            
39518>>>>>>>            //AB-StoreEnd
39518>>>>>>>
39518>>>>>>>        End_Object    // oSelList
39519>>>>>>>
39519>>>>>>>        Object oOK_bn is a ButtonSub
39521>>>>>>>            set label to "&„§ ¢¦šã" 
39522>>>>>>>            Set Location to 114 312
39523>>>>>>>
39523>>>>>>>            //AB-StoreStart
39523>>>>>>>            Procedure OnClick
39525>>>>>>>                Send OK To (oSelList(current_object))
39526>>>>>>>            End_Procedure
39527>>>>>>>            //AB-StoreEnd
39527>>>>>>>
39527>>>>>>>        End_Object    // oOK_bn
39528>>>>>>>
39528>>>>>>>        Object oCancel_bn is a ButtonSub
39530>>>>>>>            set label to "&€¡ç¨à©ž" 
39531>>>>>>>            Set Location to 114 367
39532>>>>>>>
39532>>>>>>>            //AB-StoreStart
39532>>>>>>>            Procedure OnClick
39534>>>>>>>                Send Cancel To (oSelList(current_object))
39535>>>>>>>            End_Procedure
39536>>>>>>>            //AB-StoreEnd
39536>>>>>>>
39536>>>>>>>        End_Object    // oCancel_bn
39537>>>>>>>
39537>>>>>>>        Object oSearch_bn is a ButtonSub
39539>>>>>>>            set label to "€&¤˜ã«ž©ž" 
39540>>>>>>>            Set Location to 114 422
39541>>>>>>>
39541>>>>>>>            //AB-StoreStart
39541>>>>>>>            Procedure OnClick
39543>>>>>>>                Send Search To (oSelList(current_object))
39544>>>>>>>            End_Procedure
39545>>>>>>>            //AB-StoreEnd
39545>>>>>>>
39545>>>>>>>        End_Object    // oSearch_bn
39546>>>>>>>
39546>>>>>>>
39546>>>>>>>        //AB-StoreStart
39546>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
39547>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
39548>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
39549>>>>>>>        //AB-StoreEnd
39549>>>>>>>
39549>>>>>>>    CD_End_Object    // sl007r
39551>>>>>>>>
39551>>>>>>>
39551>>>>>>>//AB/     End_Object    // prj
39551>>>>>
39551>>>>>//DDB-Selection-pkg-End
39551>>>>>//DDB-FileEnd
39551>>>Use BAXIOKAT.DD
INCLUDING FILE: BAXIOKAT.DD
39551>>>>>//DDB-FileStart
39551>>>>>//DDB-HeaderStart
39551>>>>>
39551>>>>>// File Name : BAXIOKAT.DD
39551>>>>>// Class Name: Baxiokat_DataDictionary
39551>>>>>// Revision  : 45
39551>>>>>// Version   : 2
39551>>>>>
39551>>>>>Use  Windows           // Basic Definitions
39551>>>>>Use  DataDict          // DataDictionary Class Definition
39551>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39551>>>>>
39551>>>>>Open Baxiokat
INCLUDING FILE: BAXIOKAT.FD
39553>>>>>Open Baxio
INCLUDING FILE: BAXIO.FD
39555>>>>>Open Bkinkat
39557>>>>>Open Tpclient
39559>>>>>Open Tperga
INCLUDING FILE: TPERGA.FD
39561>>>>>Open Tparticl
INCLUDING FILE: TPARTICL.FD
39563>>>>>Open Sysrecb
39565>>>>>
39565>>>>>//DDB-HeaderEnd
39565>>>>>//DDB-ValidationStart
39565>>>>>
39565>>>>>//DDB/ ExternalValidationTable Baxiokat_Type_VT  BAXIO.PKG
39565>>>>>
39565>>>>>Register_Object Baxiokat_Type_VT
39565>>>>>Register_Object Baxiokat_Baxiokat_Yn5390_VT
39565>>>>>Register_Object Baxiokat_Baxiokat_Bank_VT
39565>>>>>Register_Object Baxiokat_Baxiokat_Formul_VT
39565>>>>>Use BAXIO.PKG        // Baxiokat_Type_VT
39565>>>>>
39565>>>>>Object Baxiokat_Baxiokat_Yn5390_VT  is a DescriptionValidationTable
39567>>>>>
39567>>>>>    Procedure Fill_List
39569>>>>>        Forward Send Fill_List
39571>>>>>        Send Add_Table_Value  "0"  "Ž® "
39572>>>>>        Send Add_Table_Value  "1"  "Œ˜ "
39573>>>>>    End_Procedure    // Fill_List
39574>>>>>    //DDB-ValidationCustomStart
39574>>>>>    //DDB-ValidationCustomEnd
39574>>>>>End_Object   // Baxiokat_Baxiokat_Yn5390_VT
39575>>>>>
39575>>>>>Object Baxiokat_Baxiokat_Bank_VT  is a CodeValidationTable
39577>>>>>    Set Type_Value        To "BANK"
39578>>>>>    Set Allow_Blank_State To TRUE
39579>>>>>    //DDB-ValidationCustomStart
39579>>>>>    //DDB-ValidationCustomEnd
39579>>>>>End_Object   // Baxiokat_Baxiokat_Bank_VT
39580>>>>>
39580>>>>>Object Baxiokat_Baxiokat_Formul_VT  is a DescriptionValidationTable
39582>>>>>    Set Allow_Blank_State To TRUE
39583>>>>>
39583>>>>>    Procedure Fill_List
39585>>>>>        Forward Send Fill_List
39587>>>>>        Send Add_Table_Value  "0"  ""
39588>>>>>        Send Add_Table_Value  "1"  "’ç§¦ª 1"
39589>>>>>        Send Add_Table_Value  "2"  "’ç§¦ª 2"
39590>>>>>    End_Procedure    // Fill_List
39591>>>>>    //DDB-ValidationCustomStart
39591>>>>>    //DDB-ValidationCustomEnd
39591>>>>>End_Object   // Baxiokat_Baxiokat_Formul_VT
39592>>>>>//DDB-ValidationEnd
39592>>>>>//DDB-SelectionStart
39592>>>>>//DDB/ ExternalSelectionList SL034  SL034.SL
39592>>>>>Register_Object SL034
39592>>>>>//DDB-SelectionEnd
39592>>>>>
39592>>>>>Open Syscurxr
39594>>>>>Open Btypkin
39596>>>>>Open Bkinkat
39598>>>>>
39598>>>>>
39598>>>>>// Apo Baxio_DD
39598>>>>>Register_Function private.Default_Axio_C_Code2 Returns String
39598>>>>>//
39598>>>>>
39598>>>>>Class Baxiokat_DataDictionary  is a DataDictionary_Sec
39599>>>>>
39599>>>>>     Procedure Creating
39600>>>>>        Forward Send Creating
39602>>>>>        // Insert Code Here
39602>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Baxiokat.Baxiokat_Rec0)))))) to Baxiokat.Baxiokat_Recr
39603>>>>>    End_Procedure   // Creating
39604>>>>>
39604>>>>>     Procedure Construct_Object
39605>>>>>               Forward Send Construct_Object
39607>>>>>
39607>>>>>               //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
39607>>>>>               //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39607>>>>>               //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
39607>>>>>               //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
39607>>>>>               Property Integer piBarticl_dd  0
39608>>>>>               Property Integer piBmove_dd    0
39609>>>>>               Property Integer piBaxio_dd    0
39610>>>>>               Property Integer piBtypkin_dd 0
39611>>>>>     End_Procedure   //construct_object
39612>>>>>
39612>>>>>
39612>>>>>     //private
39612>>>>>     //¡˜¢œå«˜  ˜§æ: iexit «¦¬ baxiokat_code
39612>>>>>     //©œ«á¨œ      : «ž¤ default « £ã «¦¬ baxio_c_code2, ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
39612>>>>>     Procedure private.Exit_Baxiokat_Code Integer liField Integer liBaxiokat_Code
39613>>>>>               String lsBaxio_C_Code_2
39614>>>>>        PROCEDURE_RETURN
39615>>>>>//jsjsjs 24/01/2001
39615>>>>>//               Get File_Field_Current_Value File_Field Year.Year_C_Code0 to lsBaxio_C_Code_2
39615>>>>>
39615>>>>>//               Set Field_Changed_Value of (piBaxio_dd(Self)) Field Baxio.Baxio_C_Code2 to  lsBaxio_C_Code_2 //(private.Default_Axio_C_Code2((piBAxio_dd(Self))))
39615>>>>>//jsjsjs 24/01/2001
39615>>>>>     End_Procedure //private.exit_baxiokat_code
39616>>>>>
39616>>>>>
39616>>>>>    //private
39616>>>>>    //¡˜¢œå«˜  ˜§æ:
39616>>>>>    //©œ«á¨œ : «ž¤ default value to baxiokat_code, ˜¤á¢¦š˜ £œ «¦ btypkin.baxiokat_num
39616>>>>>    Procedure private.Entry_Baxiokat_Code Integer liField Integer liBaxiokat_Code
39617>>>>>              Integer liBtypkin_dd liBkinkat_Num liBtypkin_Rec0
39618>>>>>
39618>>>>>        PROCEDURE_RETURN
39619>>>>>
39619>>>>>
39619>>>>>    End_Procedure //private.entry_gtypkin_code
39620>>>>>
39620>>>>>
39620>>>>>
39620>>>>>
39620>>>>>    Procedure Update
39621>>>>>          Forward Send Update
39623>>>>>          If (Baxiokat.Baxiokat_Yn5390 = 0);          Begin //œá¤ ›â¤ œå¤˜  £ž®˜¤¦š¨˜­ž£â¤œª œ§ «˜šâª, £ž›â¤ ©œ æ¢˜ «˜ ©®œ« ¡á §œ›å˜
39625>>>>>               Move "" to Baxiokat.Baxiokat_Bank
39626>>>>>               Move "" to Baxiokat.Baxiokat_Lno
39627>>>>>               Move 0  to Baxiokat.Baxiokat_Formul
39628>>>>>          End
39628>>>>>>
39628>>>>>    End_Procedure
39629>>>>>
39629>>>>>
39629>>>>>    Procedure Define_Fields
39630>>>>>        Forward Send Define_Fields
39632>>>>>        //DDB-Generated-Code-Location
39632>>>>>        //DDB-DefineFieldStart
39632>>>>>
39632>>>>>        Set Main_File            To Baxiokat.File_Number
39633>>>>>        Set Cascade_Delete_State To FALSE
39634>>>>>
39634>>>>>
39634>>>>>        // Child (Client) file structure................
39634>>>>>        Send Add_Client_File  Baxio.File_Number
39635>>>>>        Send Add_Client_File  Bkinkat.File_Number
39636>>>>>        Send Add_Client_File  Tpclient.File_Number
39637>>>>>        Send Add_Client_File  Tperga.File_Number
39638>>>>>        Send Add_Client_File  Tparticl.File_Number
39639>>>>>
39639>>>>>        // External (System) file structure.............
39639>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
39640>>>>>
39640>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
39643>>>>>
39643>>>>>        // Field-based properties.......................
39643>>>>>
39643>>>>>        // Baxiokat.Baxiokat_Code
39643>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code To (SL034(Self))
39644>>>>>
39644>>>>>        // Baxiokat.Baxiokat_Descr
39644>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr To (SL034(Self))
39645>>>>>
39645>>>>>        // Baxiokat.Baxiokat_Rec0
39645>>>>>
39645>>>>>        // Baxiokat.Baxiokat_Recr
39645>>>>>
39645>>>>>        // Baxiokat.Baxiokat_Type
39645>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type To (Baxiokat_Type_VT(Self))
39646>>>>>
39646>>>>>        // Baxiokat.Baxio_Lcode
39646>>>>>        //DDB/ Comment_Short       Field Baxiokat.Baxio_Lcode To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ creating/deleting «¦¬ baxio)"
39646>>>>>
39646>>>>>        // Baxiokat.Baxiokat_Yn5390
39646>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
39647>>>>>
39647>>>>>        // Baxiokat.Baxiokat_Bank
39647>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank To (Baxiokat_Baxiokat_Bank_VT(Self))
39648>>>>>
39648>>>>>        // Baxiokat.Baxiokat_Lno
39648>>>>>
39648>>>>>        // Baxiokat.Baxiokat_Formul
39648>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
39649>>>>>
39649>>>>>        //DDB-DefineFieldEnd
39649>>>>>
39649>>>>>        Set Main_File            To Baxiokat.File_Number
39650>>>>>        Set Cascade_Delete_State To FALSE
39651>>>>>
39651>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
39652>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
39653>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39654>>>>>
39654>>>>>        // Child (Client) file structure................
39654>>>>>        Send Add_Client_File  Baxio.File_Number
39655>>>>>        Send Add_Client_File  Bkinkat.File_Number
39656>>>>>
39656>>>>>        // External (System) file structure.............
39656>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
39657>>>>>
39657>>>>>        Define_Auto_Increment  Sysrecb.Baxiokat_Rec0  To Baxiokat.Baxiokat_Rec0
39660>>>>>
39660>>>>>        // Field-based properties.......................
39660>>>>>
39660>>>>>        // Baxiokat.Baxiokat_Code
39660>>>>>        Set Field_Entry_msg        Field Baxiokat.Baxiokat_Code   To private.Entry_Baxiokat_Code
39661>>>>>        Set Field_Exit_msg         Field Baxiokat.Baxiokat_Code   To private.Exit_Baxiokat_Code
39662>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Code   To "‰à› ¡æª „å›¦¬ª €¥ ¦š¨á­¦¬"
39663>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Code   To "„å›¦ª"
39664>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Code   To DD_AUTOFIND    DD_REQUIRED
39665>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Code   To (SL034(Self))
39666>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Code   To TRUE
39667>>>>>
39667>>>>>        // Baxiokat.Baxiokat_Descr
39667>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã „å›¦¬ª €¥ ¦š¨á­¦¬"
39668>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Descr  To "œ¨ š¨˜­ã"
39669>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Descr  To (SL034(Self))
39670>>>>>
39670>>>>>        // Baxiokat.Baxiokat_Rec0
39670>>>>>        Set Field_Options          Field Baxiokat.Baxiokat_Rec0   To DD_AUTOFIND    DD_REQUIRED
39671>>>>>        Set Field_Prompt_Object    Field Baxiokat.Baxiokat_Rec0   To (SL034(Self))
39672>>>>>        Set Key_Field_State        Field Baxiokat.Baxiokat_Rec0   To TRUE
39673>>>>>
39673>>>>>        // Baxiokat.Baxiokat_Type
39673>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Type   To "dbComboForm_EZ"
39674>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Type   To "„ ©§¨˜¡«â¦/¢ž¨à«â¦"
39675>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Type   To "„ ©./¢ã¨."
39676>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Type   To (Baxiokat_Type_VT(Self))
39677>>>>>
39677>>>>>        // Baxiokat.Baxio_Lcode
39677>>>>>        Set Field_Label_Long       Field Baxiokat.Baxio_Lcode     To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª €¥ ¦šá­¦¬"
39678>>>>>        Set Field_Label_Short      Field Baxiokat.Baxio_Lcode     To "’œ¢.€¨ Ÿ£æª"
39679>>>>>        //Set Field_Options          Field Baxiokat.Baxio_Lcode     To DD_DISPLAYONLY
39679>>>>>
39679>>>>>        // Baxiokat.Baxiokat_Yn5390
39679>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Yn5390 To "dbComboForm_EZ"
39680>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Yn5390 To "‹ž®˜¤¦š¨˜­ž£â¤œª „§ «˜šâª ?"
39681>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Yn5390 To "‹ž®/¡âª „§ «˜šâª"
39682>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Yn5390 To (Baxiokat_Baxiokat_Yn5390_VT(Self))
39683>>>>>
39683>>>>>        // Baxiokat.Baxiokat_Bank
39683>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Bank   To "dbComboForm_EZ"
39684>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
39685>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Bank   To "’¨á§œ˜"
39686>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Bank   To (Baxiokat_Baxiokat_Bank_VT(Self))
39687>>>>>
39687>>>>>        // Baxiokat.Baxiokat_Lno
39687>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Lno    To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª"
39688>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Lno    To "’œ¢.€¨ Ÿ£æª"
39689>>>>>
39689>>>>>        // Baxiokat.Baxiokat_Formul
39689>>>>>        Set Field_Class_Name       Field Baxiokat.Baxiokat_Formul To "dbComboForm_EZ"
39690>>>>>        Set Field_Label_Long       Field Baxiokat.Baxiokat_Formul To "€¢šæ¨ Ÿ£¦ª Check Digit"
39691>>>>>        Set Field_Label_Short      Field Baxiokat.Baxiokat_Formul To "Check Digit"
39692>>>>>        Set Field_Value_Table      Field Baxiokat.Baxiokat_Formul To (Baxiokat_Baxiokat_Formul_VT(Self))
39693>>>>>
39693>>>>>    End_Procedure    // Define_Fields
39694>>>>>
39694>>>>>
39694>>>>>    Procedure Field_Defaults
39695>>>>>        Forward Send Field_Defaults
39697>>>>>        //DDB-Generated-Code-Location
39697>>>>>        //DDB-FieldDefaultStart
39697>>>>>        //DDB-FieldDefaultEnd
39697>>>>>        Set Field_Changed_Value   Field Baxiokat.Baxiokat_Yn5390 To 0
39698>>>>>    End_Procedure    // Field_Defaults
39699>>>>>
39699>>>>>End_Class    // Baxiokat_DataDictionary
39700>>>>>//DDB-Selection-pkg-Start
39700>>>>>
39700>>>>>Use SL034.SL         // SL034
INCLUDING FILE: SL034.SL
39700>>>>>>>//AB/ Project SL034:BAXIOKAT
39700>>>>>>>//AB/ Object prj is a Lookup_Project
39700>>>>>>>//AB/     Set ProjectName to "SL034:BAXIOKAT"
39700>>>>>>>//AB/     Set ProjectFileName to "SL034.SL"
39700>>>>>>>//AB/     Set GenerateFileName to "NONAME"
39700>>>>>>>
39700>>>>>>>// Project Object Structure
39700>>>>>>>//   SL034 is a dbModalPanelSub
39700>>>>>>>//     Baxiokat_DD is a DataDictionary
39700>>>>>>>//     oSelList is a dbListSub
39700>>>>>>>//     oOK_bn is a ButtonSub
39700>>>>>>>//     oCancel_bn is a ButtonSub
39700>>>>>>>//     oSearch_bn is a ButtonSub
39700>>>>>>>
39700>>>>>>>// Register all objects
39700>>>>>>>Register_Object Baxiokat_DD
39700>>>>>>>Register_Object oCancel_bn
39700>>>>>>>Register_Object oOK_bn
39700>>>>>>>Register_Object oSearch_bn
39700>>>>>>>Register_Object oSelList
39700>>>>>>>Register_Object SL034
39700>>>>>>>
39700>>>>>>>
39700>>>>>>>//AB-IgnoreStart
39700>>>>>>>
39700>>>>>>>Use DFAllEnt.pkg
39700>>>>>>>Use dbList.Sub
39700>>>>>>>Use Button.Sub
39700>>>>>>>
39700>>>>>>>
39700>>>>>>>Use BAXIOKAT.DD
39700>>>>>>>
39700>>>>>>>//AB-IgnoreEnd
39700>>>>>>>
39700>>>>>>>CD_Popup_Object SL034 is a dbModalPanelSub
39719>>>>>>>    set label to "‰˜«žš¦¨åœª €¥ ¦š¨á­à¤" 
39720>>>>>>>    Set Size to 206 347
39721>>>>>>>    Set Location to 4 5
39722>>>>>>>    Set Exit_Application_Local_State to FALSE
39723>>>>>>>    Set Modal_State to FALSE
39724>>>>>>>
39724>>>>>>>    //AB-DDOStart
39724>>>>>>>
39724>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
39726>>>>>>>    End_Object    // Baxiokat_DD
39727>>>>>>>
39727>>>>>>>    Set Main_DD to (Baxiokat_DD(self))
39728>>>>>>>    Set Server to (Baxiokat_DD(self))
39729>>>>>>>
39729>>>>>>>    //AB-DDOEnd
39729>>>>>>>
39729>>>>>>>    Object oSelList is a dbListSub
39731>>>>>>>        Set Main_File to Baxiokat.File_Number
39732>>>>>>>        Set Size to 164 335
39733>>>>>>>        Set Location to 5 4
39734>>>>>>>
39734>>>>>>>        Begin_Row
39737>>>>>>>            Entry_Item Baxiokat.Baxiokat_code
39738>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
39739>>>>>>>            Entry_Item Baxiokat.Baxiokat_type
39740>>>>>>>            Entry_Item (Export_Code_Description(Self,2,Baxiokat.Baxiokat_type))
39741>>>>>>>        End_Row
39746>>>>>>>
39746>>>>>>>        Set Form_Width    item 0 to 55
39747>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
39748>>>>>>>
39748>>>>>>>        Set Form_Width    item 1 to 172
39749>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
39750>>>>>>>
39750>>>>>>>        Set Form_Width    item 2 to 16
39751>>>>>>>        set header_label  item 2 to "’ç§¦ª" 
39752>>>>>>>
39752>>>>>>>        Set Form_Width    item 3 to 83
39753>>>>>>>        set header_label  item 3 to "„ ©./¢ž¨." 
39754>>>>>>>
39754>>>>>>>    End_Object    // oSelList
39755>>>>>>>
39755>>>>>>>    Object oOK_bn is a ButtonSub
39757>>>>>>>        set label to "&„§ ¢¦šã" 
39758>>>>>>>        Set Location to 172 180
39759>>>>>>>
39759>>>>>>>        //AB-StoreStart
39759>>>>>>>        Procedure OnClick
39761>>>>>>>            Send OK To oSelList
39762>>>>>>>        End_Procedure
39763>>>>>>>        //AB-StoreEnd
39763>>>>>>>
39763>>>>>>>    End_Object    // oOK_bn
39764>>>>>>>
39764>>>>>>>    Object oCancel_bn is a ButtonSub
39766>>>>>>>        set label to "&€¡ç¨à©ž" 
39767>>>>>>>        Set Location to 172 234
39768>>>>>>>
39768>>>>>>>        //AB-StoreStart
39768>>>>>>>        Procedure OnClick
39770>>>>>>>            Send Cancel To oSelList
39771>>>>>>>        End_Procedure
39772>>>>>>>        //AB-StoreEnd
39772>>>>>>>
39772>>>>>>>    End_Object    // oCancel_bn
39773>>>>>>>
39773>>>>>>>    Object oSearch_bn is a ButtonSub
39775>>>>>>>        set label to "€&¤˜ã«ž©ž" 
39776>>>>>>>        Set Location to 172 289
39777>>>>>>>
39777>>>>>>>        //AB-StoreStart
39777>>>>>>>        Procedure OnClick
39779>>>>>>>            Send Search To oSelList
39780>>>>>>>        End_Procedure
39781>>>>>>>        //AB-StoreEnd
39781>>>>>>>
39781>>>>>>>    End_Object    // oSearch_bn
39782>>>>>>>
39782>>>>>>>
39782>>>>>>>    //AB-StoreStart
39782>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
39783>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To oCancel_bn
39784>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To oSearch_bn
39785>>>>>>>    //AB-StoreEnd
39785>>>>>>>
39785>>>>>>>CD_End_Object    // SL034
39787>>>>>>>>
39787>>>>>>>
39787>>>>>>>//AB/ End_Object    // prj
39787>>>>>
39787>>>>>//DDB-Selection-pkg-End
39787>>>>>//DDB-FileEnd
39787>>>Use BARTICL.DD
INCLUDING FILE: BARTICL.DD
39787>>>>>//DDB-FileStart
39787>>>>>//DDB-HeaderStart
39787>>>>>
39787>>>>>// File Name : BARTICL.DD
39787>>>>>// Class Name: Barticl_DataDictionary
39787>>>>>// Revision  : 94
39787>>>>>// Version   : 2
39787>>>>>
39787>>>>>Use  Windows           // Basic Definitions
39787>>>>>Use  DataDict          // DataDictionary Class Definition
39787>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39787>>>>>
39787>>>>>Open Barticl
39789>>>>>Open Bmove
INCLUDING FILE: BMOVE.FD
39791>>>>>Open Bsum
INCLUDING FILE: BSUM.FD
39793>>>>>Open Btypkin
39795>>>>>Open Sysrecb
39797>>>>>Open Cn
39799>>>>>
39799>>>>>//DDB-HeaderEnd
39799>>>>>//DDB-ValidationStart
39799>>>>>
39799>>>>>Register_Object Barticl_Barticl_M_Code_VT
39799>>>>>
39799>>>>>Object Barticl_Barticl_M_Code_VT  is a CodeValidationTable
39801>>>>>    Set Type_Value        To "MODULE"
39802>>>>>    Set Allow_Blank_State To TRUE
39803>>>>>    //DDB-ValidationCustomStart
39803>>>>>    //DDB-ValidationCustomEnd
39803>>>>>End_Object   // Barticl_Barticl_M_Code_VT
39804>>>>>//DDB-ValidationEnd
39804>>>>>//DDB-SelectionStart
39804>>>>>//DDB/ ExternalSelectionList Barticl  Barticl.SL
39804>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
39804>>>>>Register_Object Barticl
39804>>>>>Register_Object sl041
39804>>>>>//DDB-SelectionEnd
39804>>>>>
39804>>>>>Class Barticl_DataDictionary  is a DataDictionary_Sec
39805>>>>>
39805>>>>>    Procedure Shmera integer iField  Date dDate
39806>>>>>        Local Integer Changed
39807>>>>>        Get Field_Changed_State iField to Changed
39808>>>>>        If (Changed=0 AND dDate =0) Begin
39810>>>>>            SysDate4 dDate
39811>>>>>            Set Field_Default_Value iField to dDate
39812>>>>>        End
39812>>>>>>
39812>>>>>    End_Procedure   // Shmera
39813>>>>>
39813>>>>>    Procedure Save_Main_File
39814>>>>>        If (Barticl.Cn_Code<>'') Begin  
39816>>>>>            Clear Cn   
39817>>>>>            Move Barticl.Cn_Code to Cn.Cn_Code
39818>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code  
39819>>>>>>
39819>>>>>            Move Cn.Cn_Sls_ID     to Barticl.Sls_ID
39820>>>>>            Move Cn.Cn_Presp_ID   to Barticl.Presp_ID
39821>>>>>            Move Cn.CN_Cnt_ID     to Barticl.Cnt_ID
39822>>>>>        End
39822>>>>>>
39822>>>>>        Forward Send Save_Main_File
39824>>>>>    End_Procedure   // Save_Main_File
39825>>>>>
39825>>>>>      Procedure private.Initialize_Properties
39826>>>>>                 //£ž›œ¤ ©£æª §˜¢˜ é¤
39826>>>>>                 Set psB_Btypkin_Recr    to ''
39827>>>>>                 Set pdB_Barticl_Hmnia   to 0
39828>>>>>                 Set piB_Barticl_No      to 0
39829>>>>>                 Set psB_Barticl_Code1   to ""
39830>>>>>
39830>>>>>                 Set pdB_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39831>>>>>                 Set piB_Garticl_No      to 0
39832>>>>>                 Set psB_Garticl_Aitiol  to ""
39833>>>>>
39833>>>>>                 //£ž›œ¤ ©£æª ¤âà¤
39833>>>>>                 Set psA_Btypkin_Recr    to ''
39834>>>>>                 Set pdA_Barticl_Hmnia   to 0
39835>>>>>                 Set piA_Barticl_No      to 0
39836>>>>>                 Set psA_Barticl_Code1   to ""
39837>>>>>
39837>>>>>                 Set pdA_Garticl_Hmnia   to 0  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39838>>>>>                 Set piA_Garticl_No      to 0
39839>>>>>                 Set psA_Garticl_Aitiol  to ""
39840>>>>>
39840>>>>>                 Set psB_Gplan_Code to ""
39841>>>>>                 Set psA_Gplan_Code to ""
39842>>>>>
39842>>>>>      End_Procedure //private.Initialize_Properties
39843>>>>>
39843>>>>>
39843>>>>>      Procedure Construct_Object
39844>>>>>                Forward Send Construct_Object
39846>>>>>
39846>>>>>                Property String  psA_Btypkin_Recr     ''
39847>>>>>                Property Date    pdA_Barticl_Hmnia    0
39848>>>>>                Property Integer piA_Barticl_No       0
39849>>>>>                Property String  psB_Barticl_Code1    ""
39850>>>>>
39850>>>>>                Property String  psB_Btypkin_Recr     ''
39851>>>>>                Property Date    pdB_Barticl_Hmnia    0
39852>>>>>                Property Integer piB_Barticl_No       0
39853>>>>>                Property String  psA_Barticl_Code1    ""
39854>>>>>
39854>>>>>                Property Date    pdA_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39855>>>>>                Property Integer piA_Garticl_No       0
39856>>>>>                Property String  psA_Garticl_Aitiol   ''
39857>>>>>
39857>>>>>                Property Date    pdB_Garticl_Hmnia    0 //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39858>>>>>                Property Integer piB_Garticl_No       0
39859>>>>>                Property String  psB_Garticl_Aitiol   ''
39860>>>>>
39860>>>>>
39860>>>>>                Property Integer piBaxio_dd           0 //object id «¦¬ ddo server š ˜ «¦ baxio
39861>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39861>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
39861>>>>>                Property Integer piBaxiokat_dd        0 //object id «¦¬ ddo server š ˜ «¦ baxio
39862>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39862>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ ???
39862>>>>>                Property Integer piBmove_dd           0 //object id «¦¬ ddo server š ˜ «¦ bmove
39863>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39863>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
39863>>>>>                Property Integer piBtypkin_dd         0 //object id «¦¬ ddo server š ˜ «¦ btypkin
39864>>>>>                                                        //©œ«á¨œ«˜  ˜§¦ «ž¤ end_construct «¦¬ bmove
39864>>>>>                                                        //®¨ž© £œçœ  ©«ž¤ cascade update
39864>>>>>
39864>>>>>                Property String  psB_Gplan_Code
39865>>>>>                Property String  psA_Gplan_Code
39866>>>>>
39866>>>>>
39866>>>>>                Property Integer piCreated_Barticl 0 //©œ«á¨œ«˜  ©«ž¤ creating,
39867>>>>>                                                     //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
39867>>>>>                                                     //£ž›œ¤åœ«˜  ©«ž¤ request_save «¦¬ bmove
39867>>>>>
39867>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
39868>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
39868>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
39869>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
39869>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
39870>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
39870>>>>>      End_Procedure   //construct_object
39871>>>>>
39871>>>>>      Procedure Update
39872>>>>>                Integer liBAxio_dd liBaxiokat_dd
39873>>>>>                Forward Send Update
39875>>>>>
39875>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
39875>>>>>                Move Syscurxr.Company_Code  to Barticl.Company_Code
39876>>>>>                Move Syscurxr.Branch_Code   to Barticl.Branch_Code
39877>>>>>                Move Syscurxr.Year_Year     to Barticl.Year_Year
39878>>>>>                Move Btypkin.Btypkin_Code   to Barticl.Btypkin_Code
39879>>>>>
39879>>>>>
39879>>>>>                //™) ˜¤áš¤à©ž properties
39879>>>>>                Get piBaxio_dd    to liBaxio_dd    //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxio
39880>>>>>                Get piBaxiokat_dd to liBaxiokat_dd //«¦ ddo §¦¬ "©œ¨™å¨œ " «¦ baxiokat
39881>>>>>
39881>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
39881>>>>>                //š.1:btypkin.btypkin_L_Hmnia //«œ¢œ¬«˜å˜ ž£œ¨¦£ž¤å˜
39881>>>>>                 Move (Barticl.Barticl_Hmnia Max Btypkin.Btypkin_L_Hmnia) to Btypkin.Btypkin_L_Hmnia
39882>>>>>
39882>>>>>                Case Begin
39882>>>>>                    Case (Btypkin.Btypkin_Anti2 = 5) //§˜¨˜¢ã§«žª œå¤˜  ¦ å› ¦ª ¦ ©¬¤˜¢¢˜©æ£œ¤¦ª
39884>>>>>                        Move Barticl.Barticl_Code1 to Barticl.Barticl_Code2
39885>>>>>                        Move Barticl.Barticl_Epon1 to Barticl.Barticl_Epon2
39886>>>>>                      Case Break
39887>>>>>                    Case (Btypkin.Btypkin_Anti2 = (-1)) //›â¤ ¬§á¨®œ  §˜¨˜¢ã§«žª
39890>>>>>                        Move ""                    to Barticl.Barticl_Code2
39891>>>>>                        Move ""                    to Barticl.Barticl_Epon2
39892>>>>>                      Case Break
39893>>>>>                Case End
39893>>>>>
39893>>>>>
39893>>>>>                Case Begin
39893>>>>>                    Case ((Btypkin.Btypkin_Anti1=2) Or (Btypkin.Btypkin_Anti1=3))
39895>>>>>                        Clear Clients
39896>>>>>                        Move Barticl.Barticl_Code1 to Clients.Client_ID
39897>>>>>                        Find Eq Clients by Index.6 //Client_ID
39898>>>>>>
39898>>>>>                        If (Found = 1) Move Clients.Client_Recr to Barticl.Client_Mrecr
39901>>>>>                        Else Send Operation_Not_Allowed 3002 //›â¤ ™¨âŸž¡œ «¦ Master Customer_rec0, please reindex
39903>>>>>                      Case Break
39904>>>>>                Case End
39904>>>>>
39904>>>>>                If (Btypkin.Gtypkin_Code <> 0);                Begin //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã, ®¨œ á¦£˜  ¦§à›ã§¦«œ
39906>>>>>                      //master gplan rec0
39906>>>>>                      Case Begin
39906>>>>>                           Case (Btypkin.Btypkin_Anti1 = 1) //©¬¤˜¢¢˜©æ£œ¤¦ª ˜§æ š¢
39908>>>>>//jsjsjs 24/01/2001
39908>>>>>//                                Clear Gplan
39908>>>>>//                                Move Barticl.Company_Code  to Gplan.Company_Code
39908>>>>>//                                Move Barticl.Branch_Code   to Gplan.Branch_Code
39908>>>>>//                                Move Barticl.Year_Year     to Gplan.Year_Year
39908>>>>>//                                Move Barticl.Barticl_Code1 to Gplan.Gplan_Code
39908>>>>>//                                Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
39908>>>>>//                                If (Found = 1) Move Gplan.Gplan_Rec0 to Barticl.Gplan_Mrec0
39908>>>>>//                                Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ Master Gplan_rec0
39908>>>>>//jsjsjs 24/01/2001
39908>>>>>                           Case Break
39909>>>>>                           Case Else                        //=4 ¢¦ §¦å:©¬¤˜¢¢˜©æ£œ¤¦ª £œ user manual data entry
39909>>>>>                                Move 0 to Barticl.Gplan_Mrec0
39910>>>>>                      Case End
39910>>>>>                End   //please check the logic
39910>>>>>>
39910>>>>>
39910>>>>>
39910>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
39910>>>>>
39910>>>>>                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
39910>>>>>                Set psA_Btypkin_Recr    to Btypkin.Btypkin_Recr
39911>>>>>                Set pdA_Barticl_Hmnia   to Barticl.Barticl_Hmnia
39912>>>>>                Set piA_Barticl_No      to Barticl.Barticl_No
39913>>>>>                Set psA_Barticl_Code1   to Barticl.Barticl_Code1
39914>>>>>
39914>>>>>                Set pdA_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39915>>>>>                Set piA_Garticl_No      to Barticl.Barticl_No
39916>>>>>                Set psA_Garticl_Aitiol  to Barticl.Barticl_Aitiol
39917>>>>>
39917>>>>>      End_Procedure   //update
39918>>>>>
39918>>>>>
39918>>>>>      Procedure Backout
39919>>>>>                Forward Send Backout
39921>>>>>
39921>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
39921>>>>>                Set psB_Btypkin_Recr    to Barticl.Btypkin_Recr
39922>>>>>                Set pdB_Barticl_Hmnia   to Barticl.Barticl_Hmnia
39923>>>>>                Set piB_Barticl_No      to Barticl.Barticl_No
39924>>>>>                Set psB_Barticl_Code1   to Barticl.Barticl_Code1
39925>>>>>
39925>>>>>                Set pdB_Garticl_Hmnia   to Barticl.Barticl_Hmnia  //š ˜ «ž¤ œ¤ž£â¨à©ž «žª š¢
39926>>>>>                Set piB_Garticl_No      to Barticl.Barticl_No
39927>>>>>                Set psB_Garticl_Aitiol  to Barticl.Barticl_Aitiol
39928>>>>>      End_Procedure   // backout
39929>>>>>
39929>>>>>
39929>>>>>      Procedure Creating 
39930>>>>>                string sstr
39931>>>>>                Forward Send Creating
39933>>>>>
39933>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39933>>>>>
39933>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                            (Trim(String(Barticl.Barticl_Rec0)))))) to Barticl.Barticl_Recr
39934>>>>>
39934>>>>>                If (Barticl.Barticl_M_Code='') Move gs_Module_Code to Barticl.Barticl_M_Code
39937>>>>>
39937>>>>>                //************************************************************************
39937>>>>>                //flag 5:˜¬«æ£˜«ž ˜¨åŸ£ž©ž                                               *
39937>>>>>                //************************************************************************
39937>>>>>                If (Btypkin.Btypkin_Flag05 = TRUE);                     Begin //«¦ á¨Ÿ¨¦ â®œ  ˜¬«æ£˜«ž ˜¨åŸ£ž©ž
39939>>>>>                      Add 1 to Btypkin.Btypkin_L_No
39940>>>>>                      Move Btypkin.Btypkin_L_No  to Barticl.Barticl_No
39941>>>>>                     End
39941>>>>>>
39941>>>>>                Else Begin //«¦ á¨Ÿ¨¦ â®œ  ®œ ¨¦¡å¤ž«ž ˜¨åŸ£ž©ž
39942>>>>>                     End
39942>>>>>>
39942>>>>>                if ((btypkin.locked=1) and (barticl.barticl_hmnia ge btypkin.locked_date)) error 1966 '† ¡å¤ž©ž œå¤˜  ¡¢œ ›à£â¤ž' 
39945>>>>>                move '€¨.€„' To sstr 
39946>>>>>                Move (Append(sstr,(' '+(string(barticl.pae_arithm))+' - '+(string(Barticl.pae_hmnia))))) to sstr
39947>>>>>                move sstr to barticl.barticl_aitiol 
39948>>>>>                move 1 to barticl.ekkremes
39949>>>>>                
39949>>>>>                
39949>>>>>                Set piCreated_Barticl to TRUE
39950>>>>>      End_Procedure //creating
39951>>>>>
39951>>>>>
39951>>>>>      Procedure Deleting
39952>>>>>                Forward Send Deleting
39954>>>>>
39954>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBarticl //˜¨ Ÿ£æª á¨Ÿ¨à¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
39954>>>>>                If (Btypkin.Btypkin_L_No = Barticl.Barticl_No);                Begin //œá¤ › ˜š¨á­à «¦¤ «œ¢œ¬«˜å¦ ˜¨ Ÿ£æª !!! sos pleas check the logic!
39956>>>>>                  Sub 1 from Btypkin.Btypkin_L_No
39957>>>>>                  // js 05/09/2002
39957>>>>>                  Saverecord Btypkin
39958>>>>>                End
39958>>>>>>
39958>>>>>      End_Procedure //deleting
39959>>>>>
39959>>>>>
39959>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
39960>>>>>                String lsError_Message
39961>>>>>                Case Begin
39961>>>>>                     //˜§æ validate save
39961>>>>>                     Case (iError_Num = 1001)
39963>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹ ¡¨æ«œ¨ž «žª œ¤á¨¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshFrom))+")") to lsError_Message
39964>>>>>                     Case Break
39965>>>>>                     Case (iError_Num = 1002)
39968>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž †£œ¨¦£ž¤å˜ !\n\n‹œš˜¢ç«œ¨ž «žª ¢ã¥œàª ®¨ã©œàª ("+;                          (String(SysCurXr.Year_XrhshTo))+")") to lsError_Message
39969>>>>>                     Case Break
39970>>>>>                     Case (iError_Num = 1003)
39973>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã «ç§¦¬ ¡å¤ž©žª!");                          to lsError_Message
39974>>>>>                     Case Break
39975>>>>>                     Case (iError_Num = 1004)
39978>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ž£œ¨¦£ž¤å˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39979>>>>>                     Case Break
39980>>>>>                     Case (iError_Num = 1005)
39983>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŽ ˜¨ Ÿ£æª «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39984>>>>>                     Case Break
39985>>>>>                     Case (iError_Num = 1006)
39988>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n† ˜ « ¦¢¦šå˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ «¦ á¨Ÿ¨¦!");                          to lsError_Message
39989>>>>>                     Case Break
39990>>>>>                     Case (iError_Num = 1007)
39993>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n‹ž›œ¤ ¡æª ˜¨ Ÿ£æª §˜¨˜©«˜« ¡¦ç !");                          to lsError_Message
39994>>>>>                     Case Break
39995>>>>>                     Case (iError_Num = 1008)
39998>>>>>                          Move ("DDC 036:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "ƒâ¤ œ§ «¨â§œ«˜  ˜¢˜šã ©¬¤˜¢¢˜©¦£â¤¦¬!");                          to lsError_Message
39999>>>>>                     Case Break
40000>>>>>                     Case (iError_Num = 1009)
40003>>>>>                          Clear Codemast
40004>>>>>                          Move "MODULE" to Codemast.Type
40005>>>>>                          Move Barticl.Barticl_M_Code to Codemast.Code
40006>>>>>                          Find Eq Codemast by Index.1 //type+code
40007>>>>>>
40007>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(’¦ á¨Ÿ¨¦ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§æ "+;                          (Trim(Codemast.Description))+" )") to lsError_Message
40008>>>>>                     Case Break
40009>>>>>                     Case (iError_Num = 1011)
40012>>>>>                          Move ("DDC 036:€›ç¤˜«ž ž „šš¨˜­ã\n\n(ƒœ¤ â®œ  ¦¨ ©Ÿœå «¦ ¡ç¡¢à£˜!)");                          to lsError_Message
40013>>>>>                     Case Break
40014>>>>>                     Case (iError_Num = 1100)
40017>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
40018>>>>>                          Case Break
40019>>>>>                     
40019>>>>>                     Case (iError_Num = 2100)
40022>>>>>                          Move "DDC 036:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
40023>>>>>                          Case Break
40024>>>>>
40024>>>>>                   //˜§æ update
40024>>>>>                   Case (iError_Num = 3001)
40027>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
40028>>>>>                   Case Break
40029>>>>>                   Case (iError_Num = 3002)
40032>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ œ¢á«ž !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
40033>>>>>                   Case Break
40034>>>>>                   Case (iError_Num = 3003)
40037>>>>>                        Move ("DDC 036:ƒâ¤ ™¨âŸž¡œ ¦ ¡à› ¡æª "+ (Trim(Barticl.Barticl_Code1)) + " ©«ã ‚œ¤ ¡ã Š¦š ©« ¡ã š ˜ «¦¤ ¨¦£žŸœ¬«ã !\n\n˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª !");                        to lsError_Message
40038>>>>>                   Case Break
40039>>>>>
40039>>>>>                   Case (iError_Num = 1330)
40042>>>>>                          Move "DDC 036: €¨ Ÿ£æª .€.„. £ž›œ¤ ¡æª ã †£œ¨/¤å˜ .€.„. ¡œ¤ã" to lsError_Message
40043>>>>>                   Case Break
40044>>>>>
40044>>>>>                   Case (iError_Num = 1331)
40047>>>>>                          Move "DDC 036: †£œ¨/¤å˜ .€.„. ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
40048>>>>>                   Case Break
40049>>>>>
40049>>>>>                   Case (iError_Num = 1332)
40052>>>>>                          Move "DDC 036: †£œ¨/¤å˜ §˜¨˜©«˜« ¡¦ç ›œ¤ £§¦¨œå ¤˜ œå¤˜  > ©ã£œ¨˜" to lsError_Message
40053>>>>>                   Case Break
40054>>>>>
40054>>>>>                     Case Else
40054>>>>>                          Forward Send Operation_Not_Allowed iError_Num
40056>>>>>                Case End
40056>>>>>
40056>>>>>                Error iError_Num lsError_Message
40057>>>>>>
40057>>>>>      End_Procedure // operation_not_allowed
40058>>>>>
40058>>>>>      Function Validate_Save Returns Integer
40059>>>>>               Integer iReturnVal  
40060>>>>>               Date dShmera
40060>>>>>               Sysdate dShmera
40061>>>>>
40061>>>>>               Forward Get Validate_Save to iReturnVal
40063>>>>>               //Set piCreated_Barticl to 0
40063>>>>>
40063>>>>>               If (Not(iReturnVal));               Begin
40065>>>>>                //1001+1002:â¢œš®¦  ž£œ¨¦£ž¤å˜ª
40065>>>>>                If (Not(Barticl.Barticl_Hmnia >= SysCurXr.Year_XrhshFrom )) Send Operation_Not_Allowed 1001
40068>>>>>                If (Not(Barticl.Barticl_Hmnia <= SysCurXr.Year_XrhshTo   )) Send Operation_Not_Allowed 1002
40071>>>>>
40071>>>>>                //1007:â¢œš®¦ª ˜¨ Ÿ£¦ç §˜¨˜©«˜« ¡¦ç
40071>>>>>                If (Not(Barticl.Barticl_No     >  0                  )) Send Operation_Not_Allowed 1007
40074>>>>>                
40074>>>>>                
40074>>>>>                //1011:â¢œš®¦ª £ã ¡œ¤¦ç module œšš¨˜­ãª
40074>>>>>                If (Trim(Barticl.Barticl_M_Code)="")       Send Operation_Not_Allowed 1011
40077>>>>>                //---------«â¢¦ª œ¢âš®à¤ create & edit barticl record----------------------
40077>>>>>
40077>>>>>                //---------â¢œš®¦  create barticl record----------------------
40077>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
40077>>>>>                If (Barticl.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
40079>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ barticl record
40079>>>>>>
40079>>>>>
40079>>>>>                //---------â¢œš®¦  editing existing barticl records-------------------
40079>>>>>                Else;                Begin //edit an existing record
40080>>>>>                      //1003:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent btypkin record
40080>>>>>                      If (Not;                          ((psB_Btypkin_Recr(Self)) = Btypkin.Btypkin_Recr);                         )                                              Send Operation_Not_Allowed 1003
40083>>>>>                      //1004:«¨¦§¦§¦åž©ž (edit) barticl_hmnia £æ¤¦¤ ˜§æ barticl_dd
40083>>>>>                      If (;                           ((pdB_Barticl_Hmnia(Self))     <> Barticl.Barticl_Hmnia) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1004
40086>>>>>                      //1005:«¨¦§¦§¦åž©ž (edit) barticl_no £æ¤¦¤ ˜§æ barticl_dd
40086>>>>>                      If (;                           ((piB_Barticl_No   (Self))     <> Barticl.Barticl_No) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number);                         )                                              Send Operation_Not_Allowed 1005
40089>>>>>
40089>>>>>
40089>>>>>                      //1006:«¨¦§¦§¦åž©ž (edit) barticl_aitiol £æ¤¦¤ ˜§æ barticl_dd
40089>>>>>                      If (;                           ((psB_Garticl_Aitiol(Self))    <> Barticl.Barticl_Aitiol) and;                           ((Main_File(OPERATION_ORIGIN)) <> Barticl.File_Number) ;                         )                                              Send Operation_Not_Allowed 1006
40092>>>>>
40092>>>>>
40092>>>>>
40092>>>>>                      //1008:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã barticl_code1 (©¬¤˜¢¢˜©¦£â¤¦¬)
40092>>>>>                      If (Not;                          ((psB_Barticl_Code1(Self)) = Barticl.Barticl_Code1);                         )                                              Send Operation_Not_Allowed 1008
40095>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing barticl record
40095>>>>>>
40095>>>>>                If ( ;                    (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                    (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                    (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
40098>>>>>
40098>>>>>               End //«â¢¦ª ¡é› ¡˜ validation         
40098>>>>>>
40098>>>>>               
40098>>>>>                If (sysfile.serial_number='1') Begin
40100>>>>>                    If ((Barticl.PAE_Arithm=0) Or (Barticl.PAE_Hmnia=""))   Send Operation_Not_Allowed 1330
40103>>>>>                    If (Barticl.PAE_Hmnia>dShmera)                          Send Operation_Not_Allowed 1331
40106>>>>>                End
40106>>>>>>
40106>>>>>
40106>>>>>                If (Barticl.Barticl_Hmnia>dShmera)                          Send Operation_Not_Allowed 1332
40109>>>>>               
40109>>>>>               Function_Return iReturnVal
40110>>>>>      End_Function   // validate_save
40111>>>>>
40111>>>>>
40111>>>>>      Function Validate_Delete  Returns Integer
40112>>>>>               Integer iReturnVal
40113>>>>>               Forward Get Validate_Delete  To iReturnVal
40115>>>>>               If (Not(iReturnVal));               Begin
40117>>>>>                    If ( ;                        (Not(Barticl.Company_Code = Syscurxr.Company_Code)) or;                        (Not(Barticl.Branch_Code  = Syscurxr.Branch_Code )) or;                        (Not(Barticl.Year_Year    = Syscurxr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 2100
40120>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
40120>>>>>>
40120>>>>>               Function_Return iReturnVal
40121>>>>>      End_Function   // Validate_Delete
40122>>>>>
40122>>>>>
40122>>>>>
40122>>>>>      Procedure Request_Save
40123>>>>>               Integer liGarticl_Rec0 liCmove_Rec0 liVmove_Rec0 iErrorObj
40124>>>>>
40124>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
40125>>>>>
40125>>>>>               //ž cascade update «¨â®œ  £æ¤¦¤ ©œ existing barticl records
40125>>>>>               //æ«˜¤ ›ž£ ¦¬¨šé ¤â¦ record, «æ«œ ›â¤ ®¨œ á¦£˜  «å§¦«˜
40125>>>>>               If ((Current_Record(Self)) = 0) Begin
40127>>>>>                    Forward Send Request_Save
40129>>>>>                    Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
40130>>>>>                    Procedure_Return
40131>>>>>               End
40131>>>>>>
40131>>>>>
40131>>>>>               //æ«˜¤ ¡á¤à edit existing record, §¨â§œ  ¤˜ «¨â®à «ž¤ cascade update
40131>>>>>               //š ˜ ¤˜ â¤ž£œ¨é©à (œá¤ ­¬© ¡á ®¨œ áœ«˜ ) «˜ child bmoves
40131>>>>>               //£œ « ª ˜¢¢˜šâª «à¤ 3 foreign §œ›åà¤ «¦¬ barticl
40131>>>>>               //(btypkin_code+barticl_hmnia+barticl_no)
40131>>>>>               //§¨æª «¦ §˜¨æ¤ ›â¤ œ§ «¨â§œ«˜  ˜¢¢˜šã «¦¬ btypkin.
40131>>>>>
40131>>>>>               BEGIN_TRANSACTION
40132>>>>>               Move Error_Object_ID to iErrorObj
40133>>>>>               Forward Send Request_Save
40135>>>>>
40135>>>>>               //˜¤áš¤à©ž rec0's «à¤ ˜¤«å©«¦ ®à¤ articl's «à¤ ¢¦ §é¤ modules
40135>>>>>               Get Field_Current_Value Field Barticl.Garticl_Rec0 to liGarticl_Rec0
40136>>>>>               Get Field_Current_Value Field Barticl.Carticl_Rec0 to liCmove_Rec0
40137>>>>>               Get Field_Current_Value Field Barticl.Varticl_Rec0 to liVmove_Rec0
40138>>>>>
40138>>>>>               Send private.Transaction_Cascade_Update_Bmove //cascade œ¤ž£â¨à©ž bmove
40139>>>>>
40139>>>>>               END_TRANSACTION
40140>>>>>               Move iErrorObj to Error_Object_ID
40141>>>>>               Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
40142>>>>>
40142>>>>>               //œ§˜¤˜­¦¨á «¦¬ system indicator err
40142>>>>>               Indicate Err False
40143>>>>>     End_Procedure   // request_save
40144>>>>>
40144>>>>>
40144>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ ¡á¤œ  cascade update ©«¦ bmove
40144>>>>>     //¡˜¢œå«˜  ˜§æ «ã¤ request save, £â©˜ ˜§æ transaction, £æ¤¦¤ š ˜ existing barticl records.
40144>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
40144>>>>>     Procedure private.Transaction_Cascade_Update_Bmove
40145>>>>>               Integer liBmove_dd
40146>>>>>
40146>>>>>               //§˜¢˜ âª ¡˜  ¤âœª « £âª «¦¬ barticl
40146>>>>>               String   lsB_Btypkin_Recr     lsA_Btypkin_Recr
40146>>>>>               Date     ldB_Barticl_Hmnia    ldA_Barticl_Hmnia
40146>>>>>               Integer  liB_Barticl_No       liA_Barticl_No
40146>>>>>
40146>>>>>               //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤ barticl
40146>>>>>               Get psB_Btypkin_Recr    to lsB_Btypkin_Recr
40147>>>>>               Get pdB_Barticl_Hmnia   to ldB_Barticl_Hmnia
40148>>>>>               Get piB_Barticl_No      to liB_Barticl_No
40149>>>>>
40149>>>>>               //˜¤áš¤à©ž ¤âà¤ « £é¤ barticl
40149>>>>>               Get psA_Btypkin_Recr    to lsA_Btypkin_Recr
40150>>>>>               Get pdA_Barticl_Hmnia   to ldA_Barticl_Hmnia
40151>>>>>               Get piA_Barticl_No      to liA_Barticl_No
40152>>>>>
40152>>>>>               //œá¤ æ¢œª ¦  « £âª before+after œå¤˜  å©œª,
40152>>>>>               //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«¦¤ ¡æ§¦ ¤˜ «¨â¥à,
40152>>>>>               //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
40152>>>>>               If (;                    (lsB_Btypkin_Recr   = lsA_Btypkin_Recr   ) and;                    (ldB_Barticl_Hmnia  = ldA_Barticl_Hmnia  ) and;                    (liB_Barticl_No     = liA_Barticl_No     )    ;                   ) Begin
40154>>>>>                      Procedure_Return
40155>>>>>                     End
40155>>>>>>
40155>>>>>
40155>>>>>
40155>>>>>               //**************************************************************************
40155>>>>>               //02.rebuild constraints, ¢æšà «à¤ ¡¢á©œà¤
40155>>>>>               //**************************************************************************
40155>>>>>               Get piBmove_dd           to liBmove_dd
40156>>>>>               Send Rebuild_Constraints to (piBtypkin_dd(Self))
40157>>>>>               Send Rebuild_Constraints to Self
40158>>>>>               Send Rebuild_Constraints to (piBaxio_dd  (Self))
40159>>>>>               Send Rebuild_Constraints to liBmove_dd
40160>>>>>
40160>>>>>               //**************************************************************************
40160>>>>>               //03.©á¨à©ž Bmove
40160>>>>>               //**************************************************************************
40160>>>>>               Send Clear to liBmove_dd
40161>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_recr+bmove_rec0
40162>>>>>               While (Found=1)
40166>>>>>                      Send Request_Save to liBmove_dd
40167>>>>>                      Send Find to liBmove_dd NEXT_RECORD 3 //Barticl_recr+Bmove_rec0
40168>>>>>               Loop
40169>>>>>>
40169>>>>>               Send Find to liBmove_dd FIRST_RECORD 3 //barticl_rec0+bmove_rec0
40170>>>>>               //send check_arthro_for_ypol (› æ«  £§¦¨œå ¤˜ ˜¢¢á¥œ   ©¦« £å˜ !)
40170>>>>>     End_Procedure //private.transaction_cascade_update_bmove
40171>>>>>
40171>>>>>
40171>>>>>
40171>>>>>     //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
40171>>>>>     //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
40171>>>>>     //¡˜¢œå«˜  ˜§æ «åª request save & delete, £â©˜ ˜§æ transaction.
40171>>>>>     //œ§ ©«¨â­œ  ¢áŸž :
40171>>>>>     Procedure private.Transaction_Update_Other_Modules Integer liGarticl_Rec0;                                                        Integer liCmove_Rec0;                                                        Integer liVmove_Rec0;                                                        Integer liMode
40172>>>>>
40172>>>>>               Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
40173>>>>>               Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
40173>>>>>
40173>>>>>               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
40173>>>>>               Integer liFlag02 liFlag03 liFlag04 liFlag05
40173>>>>>
40173>>>>>               //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
40173>>>>>               Get File_Field_Current_Value File_Field Btypkin.Gtypkin_Rec0   to liMust_Update_GL
40174>>>>>               Get File_Field_Current_Value File_Field Btypkin.Ctypkin_Rec0   to liMust_Update_CUSTOMER
40175>>>>>               Get File_Field_Current_Value File_Field Btypkin.Vtypkin_Rec0   to liMust_Update_VENDOR
40176>>>>>
40176>>>>>               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
40176>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
40177>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
40178>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
40179>>>>>               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
40180>>>>>
40180>>>>>     End_Procedure //private.transaction_update_other_modules
40181>>>>>
40181>>>>>
40181>>>>>    Procedure Define_Fields
40182>>>>>        Forward Send Define_Fields
40184>>>>>        //DDB-Generated-Code-Location
40184>>>>>        //DDB-DefineFieldStart
40184>>>>>
40184>>>>>        Set Main_File            To Barticl.File_Number
40185>>>>>        Set Cascade_Delete_State To FALSE
40186>>>>>
40186>>>>>
40186>>>>>        // Child (Client) file structure................
40186>>>>>        Send Add_Client_File  Bmove.File_Number
40187>>>>>        Send Add_Client_File  Bsum.File_Number
40188>>>>>
40188>>>>>        // Parent (Server) file structure...............
40188>>>>>        Send Add_Server_File  Btypkin.File_Number
40189>>>>>
40189>>>>>        // External (System) file structure.............
40189>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
40190>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
40191>>>>>
40191>>>>>        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
40194>>>>>
40194>>>>>        // Field-based properties.......................
40194>>>>>
40194>>>>>        // Barticl.Company_Code
40194>>>>>
40194>>>>>        // Barticl.Branch_Code
40194>>>>>
40194>>>>>        // Barticl.Year_Year
40194>>>>>
40194>>>>>        // Barticl.Btypkin_Code
40194>>>>>
40194>>>>>        // Barticl.Barticl_Hmnia
40194>>>>>        Set Field_Entry_msg        Field Barticl.Barticl_Hmnia To Shmera
40195>>>>>        Set Field_Mask_Type        Field Barticl.Barticl_Hmnia To MASK_DATE_WINDOW
40196>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia To (Barticl(Self))
40197>>>>>
40197>>>>>        // Barticl.Barticl_No
40197>>>>>
40197>>>>>        // Barticl.Barticl_Rec0
40197>>>>>
40197>>>>>        // Barticl.Barticl_Recr
40197>>>>>
40197>>>>>        // Barticl.Btypkin_Recr
40197>>>>>
40197>>>>>        // Barticl.Barticl_Code1
40197>>>>>
40197>>>>>        // Barticl.Barticl_Epon1
40197>>>>>
40197>>>>>        // Barticl.Barticl_Code2
40197>>>>>
40197>>>>>        // Barticl.Barticl_Epon2
40197>>>>>
40197>>>>>        // Barticl.Barticl_Aitiol
40197>>>>>
40197>>>>>        // Barticl.Barticl_Sv2
40197>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv2 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40197>>>>>
40197>>>>>        // Barticl.Barticl_Sv0
40197>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv0 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40197>>>>>
40197>>>>>        // Barticl.Barticl_Sv00
40197>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Sv00 To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40197>>>>>
40197>>>>>        // Barticl.Barticl_Svr
40197>>>>>        //DDB/ Comment_Short       Field Barticl.Barticl_Svr To "Computed field (œ¤ž£œ¨é¤œ«˜  ©«ž¤ update/backout «¦¬ bmove"
40197>>>>>
40197>>>>>        // Barticl.Barticl_Lines
40197>>>>>
40197>>>>>        // Barticl.Barticl_Bmovela
40197>>>>>
40197>>>>>        // Barticl.Barticl_M_Code
40197>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code To (Barticl_Barticl_M_Code_VT(Self))
40198>>>>>
40198>>>>>        // Barticl.Garticl_Rec0
40198>>>>>
40198>>>>>        // Barticl.Carticl_Rec0
40198>>>>>
40198>>>>>        // Barticl.Varticl_Rec0
40198>>>>>
40198>>>>>        // Barticl.Gmove_Mrec0
40198>>>>>
40198>>>>>        // Barticl.Gplan_Mrec0
40198>>>>>
40198>>>>>        // Barticl.Client_Mrecr
40198>>>>>
40198>>>>>        // Barticl.Barticl_Ekleise
40198>>>>>
40198>>>>>        // Barticl.Cmoves_Recr
40198>>>>>
40198>>>>>        // Barticl.Isotimia
40198>>>>>
40198>>>>>        // Barticl.Cn_Code
40198>>>>>        Set Field_Prompt_Object    Field Barticl.Cn_Code To (sl041(Self))
40199>>>>>
40199>>>>>        // Barticl.Cn_Descr
40199>>>>>
40199>>>>>        // Barticl.Cn_Recr
40199>>>>>
40199>>>>>        // Barticl.Sls_Id
40199>>>>>
40199>>>>>        // Barticl.Cnt_Id
40199>>>>>
40199>>>>>        // Barticl.Presp_Id
40199>>>>>
40199>>>>>        // Barticl.Se_Logik
40199>>>>>
40199>>>>>        // Barticl.Sxolia1
40199>>>>>
40199>>>>>        // Barticl.Sxolia2
40199>>>>>
40199>>>>>        // Barticl.Partl_Akyr_Recr
40199>>>>>
40199>>>>>        // Barticl.Ekkremes
40199>>>>>
40199>>>>>        // Barticl.Arith_Orist
40199>>>>>
40199>>>>>        // Barticl.Hmnia_Orist
40199>>>>>
40199>>>>>        // Barticl.Pae_Arithm
40199>>>>>
40199>>>>>        // Barticl.Pae_Hmnia
40199>>>>>
40199>>>>>        //DDB-DefineFieldEnd
40199>>>>>
40199>>>>>//        Set Main_File            To Barticl.File_Number
40199>>>>>
40199>>>>>//        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
40199>>>>>//        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
40199>>>>>//        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40199>>>>>
40199>>>>>//        // Child (Client) file structure................
40199>>>>>//        Send Add_Client_File  Bsum.File_Number
40199>>>>>//        Send Add_Client_File  Bmove.File_Number
40199>>>>>
40199>>>>>//        // Parent (Server) file structure...............
40199>>>>>//        Send Add_Server_File  Btypkin.File_Number
40199>>>>>
40199>>>>>//        // External (System) file structure.............
40199>>>>>//        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
40199>>>>>//        //Send Add_System_File  Gplan.File_Number  DD_LOCK_ON_SAVE
40199>>>>>
40199>>>>>//        Define_Auto_Increment  Sysrecb.Barticl_Rec0  To Barticl.Barticl_Rec0
40199>>>>>
40199>>>>>        // Field-based properties.......................
40199>>>>>
40199>>>>>        // Barticl.Company_Code
40199>>>>>
40199>>>>>        // Barticl.Branch_Code
40199>>>>>
40199>>>>>        // Barticl.Year_Year
40199>>>>>
40199>>>>>        // Barticl.Btypkin_Code
40199>>>>>
40199>>>>>        // Barticl.Barticl_Hmnia
40199>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
40200>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Hmnia    To "†£/¤å˜"
40201>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Hmnia    To (Barticl(Self))
40202>>>>>
40202>>>>>        // Barticl.Barticl_No
40202>>>>>        Set Field_Label_Long       Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
40203>>>>>        Set Field_Label_Short      Field Barticl.Barticl_No       To "€¨ Ÿ£æª"
40204>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_No       To (Barticl(Self))
40205>>>>>
40205>>>>>        // Barticl.Barticl_Rec0
40205>>>>>        Set Field_Prompt_Object    Field Barticl.Barticl_Rec0     To (Barticl(Self))
40206>>>>>        Set Key_Field_State        Field Barticl.Barticl_Rec0     To TRUE
40207>>>>>
40207>>>>>        // Barticl.Btypkin_Rec0
40207>>>>>
40207>>>>>        // Barticl.Barticl_Code1
40207>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
40208>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code1    To "‘¬¤˜¢¢˜©æ£œ¤¦ª"
40209>>>>>
40209>>>>>        // Barticl.Barticl_Epon1
40209>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
40210>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon1    To "„§à¤¬£å˜"
40211>>>>>
40211>>>>>        // Barticl.Barticl_Code2
40211>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
40212>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Code2    To "˜¨˜¢ã§«žª"
40213>>>>>
40213>>>>>        // Barticl.Barticl_Epon2
40213>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
40214>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Epon2    To "„§à¤¬£å˜"
40215>>>>>
40215>>>>>        // Barticl.Barticl_Aitiol
40215>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
40216>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Aitiol   To "€ « ¦¢¦šå˜"
40217>>>>>
40217>>>>>        // Barticl.Barticl_Sv2
40217>>>>>        Set Field_Options          Field Barticl.Barticl_Sv2      To DD_DISPLAYONLY
40218>>>>>
40218>>>>>        // Barticl.Barticl_Sv0
40218>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜ €¥ é¤ ‘œ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª"
40219>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Sv0      To "‘ç¤¦¢˜"
40220>>>>>        Set Field_Options          Field Barticl.Barticl_Sv0      To DD_DISPLAYONLY
40221>>>>>
40221>>>>>        // Barticl.Barticl_Sv00
40221>>>>>        Set Field_Options          Field Barticl.Barticl_Sv00     To DD_DISPLAYONLY
40222>>>>>
40222>>>>>        // Barticl.Barticl_Svr
40222>>>>>        Set Field_Options          Field Barticl.Barticl_Svr      To DD_DISPLAYONLY
40223>>>>>
40223>>>>>        // Barticl.Barticl_Lines
40223>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Lines    To "’œ£á® ˜"
40224>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Lines    To "’œ£á® ˜"
40225>>>>>        Set Field_Options          Field Barticl.Barticl_Lines    To DD_DISPLAYONLY
40226>>>>>
40226>>>>>        // Barticl.Barticl_Bmovela
40226>>>>>        Set Field_Label_Long       Field Barticl.Barticl_Bmovela  To "’œ¢œ¬«˜å¦ª €¨ Ÿ£æª ‚¨˜££ãª"
40227>>>>>        Set Field_Label_Short      Field Barticl.Barticl_Bmovela  To "’œ¢. €¨.‚¨˜££ãª"
40228>>>>>        Set Field_Options          Field Barticl.Barticl_Bmovela  To DD_DISPLAYONLY
40229>>>>>
40229>>>>>        // Barticl.Barticl_M_Code
40229>>>>>        Set Field_Label_Long       Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
40230>>>>>        Set Field_Label_Short      Field Barticl.Barticl_M_Code   To "Module „šš¨˜­ãª"
40231>>>>>        Set Field_Options          Field Barticl.Barticl_M_Code   To DD_DISPLAYONLY
40232>>>>>        Set Field_Value_Table      Field Barticl.Barticl_M_Code   To (Barticl_Barticl_M_Code_VT(Self))
40233>>>>>
40233>>>>>        // Barticl.Garticl_Rec0
40233>>>>>        Set Field_Options          Field Barticl.Garticl_Rec0     To DD_DISPLAYONLY
40234>>>>>
40234>>>>>        // Barticl.Carticl_Rec0
40234>>>>>        Set Field_Options          Field Barticl.Carticl_Rec0     To DD_DISPLAYONLY
40235>>>>>
40235>>>>>        // Barticl.Varticl_Rec0
40235>>>>>        Set Field_Options          Field Barticl.Varticl_Rec0     To DD_DISPLAYONLY
40236>>>>>
40236>>>>>        // Barticl.Gmove_Mrec0
40236>>>>>        Set Field_Options          Field Barticl.Gmove_Mrec0      To DD_DISPLAYONLY
40237>>>>>
40237>>>>>        // Barticl.Gplan_Mrec0
40237>>>>>        Set Field_Options          Field Barticl.Gplan_Mrec0      To DD_DISPLAYONLY
40238>>>>>
40238>>>>>    End_Procedure    // Define_Fields
40239>>>>>
40239>>>>>
40239>>>>>    Procedure Field_Defaults
40240>>>>>        Forward Send Field_Defaults
40242>>>>>        //DDB-Generated-Code-Location
40242>>>>>        //DDB-FieldDefaultStart
40242>>>>>        Set Field_Changed_Value   Field Barticl.Ekkremes To 1
40243>>>>>        //DDB-FieldDefaultEnd
40243>>>>>    End_Procedure    // Field_Defaults
40244>>>>>
40244>>>>>End_Class    // Barticl_DataDictionary
40245>>>>>//DDB-Selection-pkg-Start
40245>>>>>
40245>>>>>Use Barticl.SL       // Barticl
INCLUDING FILE: BARTICL.SL
40245>>>>>>>//AB/ Project Barticl:Lookup
40245>>>>>>>//AB/ Object prj is a Lookup_Project
40245>>>>>>>//AB/     Set ProjectName to "Barticl:Lookup"
40245>>>>>>>//AB/     Set ProjectFileName to "Barticl.SL"
40245>>>>>>>
40245>>>>>>>// Project Object Structure
40245>>>>>>>//   Barticl is a dbModalPanelSub
40245>>>>>>>//     Btypkin_DD2 is a Btypkin_DataDictionary
40245>>>>>>>//     Btypkin_DD is a DataDictionary
40245>>>>>>>//     Barticl_DD is a DataDictionary
40245>>>>>>>//     Country_DD is a DataDictionary
40245>>>>>>>//     Towns_DD is a DataDictionary
40245>>>>>>>//     Cities_DD is a DataDictionary
40245>>>>>>>//     Areas_DD is a DataDictionary
40245>>>>>>>//     Payresp_DD is a DataDictionary
40245>>>>>>>//     Clients_DD is a DataDictionary
40245>>>>>>>//     oSelList is a dbListSub
40245>>>>>>>//     Btypkin_Btypkin_Code is a dbFormSub
40245>>>>>>>//     Btypkin_Btypkin_Descr is a dbFormSub
40245>>>>>>>//     Clients_Client_Name is a dbFormSub
40245>>>>>>>//     cSyDateForm1 is a cSyDateForm
40245>>>>>>>//     chkOpen is a CheckBoxSub
40245>>>>>>>//     ButtonSub1 is a ButtonSub
40245>>>>>>>//     oOK_bn is a ButtonSub
40245>>>>>>>//     oCancel_bn is a ButtonSub
40245>>>>>>>
40245>>>>>>>// Register all objects
40245>>>>>>>Register_Object Areas_DD
40245>>>>>>>Register_Object Barticl
40245>>>>>>>Register_Object Barticl_DD
40245>>>>>>>Register_Object Btypkin_Btypkin_Code
40245>>>>>>>Register_Object Btypkin_Btypkin_Descr
40245>>>>>>>Register_Object Btypkin_DD
40245>>>>>>>Register_Object Btypkin_DD2
40245>>>>>>>Register_Object ButtonSub1
40245>>>>>>>Register_Object Cities_DD
40245>>>>>>>Register_Object Clients_Client_Name
40245>>>>>>>Register_Object Clients_DD
40245>>>>>>>Register_Object Country_DD
40245>>>>>>>Register_Object chkOpen
40245>>>>>>>Register_Object cSyDateForm1
40245>>>>>>>Register_Object oCancel_bn
40245>>>>>>>Register_Object oOK_bn
40245>>>>>>>Register_Object oSelList
40245>>>>>>>Register_Object Payresp_DD
40245>>>>>>>Register_Object Towns_DD
40245>>>>>>>
40245>>>>>>>
40245>>>>>>>//AB-IgnoreStart
40245>>>>>>>
40245>>>>>>>Use DFAllEnt.pkg
40245>>>>>>>Use dbList.Sub
40245>>>>>>>Use dbForm.Sub
40245>>>>>>>Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
40245>>>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
40245>>>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
40245>>>>>>>>>>>>>//AB/ Project Calendar Outlook
40245>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
40245>>>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
40245>>>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>// Project Object Structure
40245>>>>>>>>>>>>>//   oCalendar is a BasicPanelSub
40245>>>>>>>>>>>>>//     Container3d1 is a Container3d
40245>>>>>>>>>>>>>//       Grid2 is a Grid
40245>>>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
40245>>>>>>>>>>>>>//       Textbox2 is a Textbox
40245>>>>>>>>>>>>>//       Textbox3 is a Textbox
40245>>>>>>>>>>>>>//       Textbox4 is a Textbox
40245>>>>>>>>>>>>>//       Textbox5 is a Textbox
40245>>>>>>>>>>>>>//       Textbox6 is a Textbox
40245>>>>>>>>>>>>>//       Textbox7 is a Textbox
40245>>>>>>>>>>>>>//       Textbox8 is a Textbox
40245>>>>>>>>>>>>>//       LineControl1 is a LineControl
40245>>>>>>>>>>>>>//       Container3d2 is a Container3d
40245>>>>>>>>>>>>>//         oRght is a BitmapContainer
40245>>>>>>>>>>>>>//         oLeft is a BitmapContainer
40245>>>>>>>>>>>>>//         oMonth is a Textbox
40245>>>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
40245>>>>>>>>>>>>>//         oCalendarYear is a Textbox
40245>>>>>>>>>>>>>//         oSelectCalendarYear is a Form
40245>>>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
40245>>>>>>>>>>>>>//     oToday is a Textbox
40245>>>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
40245>>>>>>>>>>>>>//     Help_Container is a Container3d
40245>>>>>>>>>>>>>//       Help_Info is a Edit
40245>>>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>// Register all objects
40245>>>>>>>>>>>>>Register_Object BitmapContainer3
40245>>>>>>>>>>>>>Register_Object Container3d1
40245>>>>>>>>>>>>>Register_Object Container3d2
40245>>>>>>>>>>>>>Register_Object cOutlookFloatingMenu
40245>>>>>>>>>>>>>Register_Object Grid2
40245>>>>>>>>>>>>>Register_Object Help_Container
40245>>>>>>>>>>>>>Register_Object Help_Info
40245>>>>>>>>>>>>>Register_Object HelpFloatingMenu
40245>>>>>>>>>>>>>Register_Object LineControl1
40245>>>>>>>>>>>>>Register_Object oCalendar
40245>>>>>>>>>>>>>Register_Object oCalendarYear
40245>>>>>>>>>>>>>Register_Object oCloseCalendar_bn
40245>>>>>>>>>>>>>Register_Object oLeft
40245>>>>>>>>>>>>>Register_Object oMonth
40245>>>>>>>>>>>>>Register_Object oRght
40245>>>>>>>>>>>>>Register_Object oSelectCalendarYear
40245>>>>>>>>>>>>>Register_Object oSelectMonth
40245>>>>>>>>>>>>>Register_Object oToday
40245>>>>>>>>>>>>>Register_Object Textbox2
40245>>>>>>>>>>>>>Register_Object Textbox3
40245>>>>>>>>>>>>>Register_Object Textbox4
40245>>>>>>>>>>>>>Register_Object Textbox5
40245>>>>>>>>>>>>>Register_Object Textbox6
40245>>>>>>>>>>>>>Register_Object Textbox7
40245>>>>>>>>>>>>>Register_Object Textbox8
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>    //AB-StoreTopStart
40245>>>>>>>>>>>>>    Use dates.utl
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>    //AB-StoreTopEnd
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>    //AB-IgnoreStart
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>    Use Panel.Sub
40245>>>>>>>>>>>>>    Use DFAllEnt.pkg
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>    //AB-IgnoreEnd
40245>>>>>>>>>>>>>
40245>>>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
40247>>>>>>>>>>>>>        Set Border_Style to Border_Normal
40248>>>>>>>>>>>>>        Set Caption_Bar to FALSE
40249>>>>>>>>>>>>>        Set Label to "January, 2001"
40250>>>>>>>>>>>>>        Set Size to 98 123
40251>>>>>>>>>>>>>        Set Location to 10 22
40252>>>>>>>>>>>>>        Set Color to clWhite
40253>>>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
40254>>>>>>>>>>>>>        Set Popup_State to TRUE
40255>>>>>>>>>>>>>
40255>>>>>>>>>>>>>        //AB-DDOStart
40255>>>>>>>>>>>>>
40255>>>>>>>>>>>>>
40255>>>>>>>>>>>>>        //AB-DDOEnd
40255>>>>>>>>>>>>>
40255>>>>>>>>>>>>>        Object Container3d1 is a Container3d
40257>>>>>>>>>>>>>            Set Size to 88 135
40258>>>>>>>>>>>>>            Set Location to -2 -1
40259>>>>>>>>>>>>>            Set Color to clWhite
40260>>>>>>>>>>>>>            Set Border_Style to Border_None
40261>>>>>>>>>>>>>            Object Grid2 is a Grid
40263>>>>>>>>>>>>>
40263>>>>>>>>>>>>>                //AB-StoreTopStart
40263>>>>>>>>>>>>>                property date    p_current_date     0
40265>>>>>>>>>>>>>                property integer p_current_year     -1
40267>>>>>>>>>>>>>                property integer p_current_month    -1
40269>>>>>>>>>>>>>                property integer p_selected_day     -1
40271>>>>>>>>>>>>>                property integer pExportState       1
40273>>>>>>>>>>>>>                property integer invoking_object_id 0
40275>>>>>>>>>>>>>                Property integer piCurrentDayItem   -1
40277>>>>>>>>>>>>>
40277>>>>>>>>>>>>>                Set Border_Style To BORDER_NONE
40278>>>>>>>>>>>>>                Set header_visible_state To False
40279>>>>>>>>>>>>>                set select_mode to no_select
40280>>>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
40281>>>>>>>>>>>>>
40281>>>>>>>>>>>>>                on_key Key_F1 Send Help
40282>>>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
40283>>>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
40284>>>>>>>>>>>>>                on_key          key_pgup send prev_month
40285>>>>>>>>>>>>>                on_key          key_pgdn send next_month
40286>>>>>>>>>>>>>                on_key key_enter         send move_value_out
40287>>>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
40288>>>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
40289>>>>>>>>>>>>>
40289>>>>>>>>>>>>>                //AB-StoreTopEnd
40289>>>>>>>>>>>>>
40289>>>>>>>>>>>>>                Set Color to clWhite
40290>>>>>>>>>>>>>                Set CurrentCellColor to clWhite
40291>>>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
40292>>>>>>>>>>>>>                Set Size to 61 145
40293>>>>>>>>>>>>>                Set Location to 30 1
40294>>>>>>>>>>>>>                Set Resize_Column_state to FALSE
40295>>>>>>>>>>>>>
40295>>>>>>>>>>>>>                Set Line_Width to 7 0
40296>>>>>>>>>>>>>
40296>>>>>>>>>>>>>                Set Form_Width    item 0 to 18
40297>>>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
40298>>>>>>>>>>>>>
40298>>>>>>>>>>>>>                Set Form_Width    item 1 to 18
40299>>>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
40300>>>>>>>>>>>>>
40300>>>>>>>>>>>>>                Set Form_Width    item 2 to 18
40301>>>>>>>>>>>>>                Set Header_Label  item 2 to "We"
40302>>>>>>>>>>>>>
40302>>>>>>>>>>>>>                Set Form_Width    item 3 to 18
40303>>>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
40304>>>>>>>>>>>>>
40304>>>>>>>>>>>>>                Set Form_Width    item 4 to 18
40305>>>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
40306>>>>>>>>>>>>>
40306>>>>>>>>>>>>>                Set Form_Width    item 5 to 18
40307>>>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
40308>>>>>>>>>>>>>
40308>>>>>>>>>>>>>                Set Form_Width    item 6 to 18
40309>>>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
40310>>>>>>>>>>>>>
40310>>>>>>>>>>>>>
40310>>>>>>>>>>>>>                //AB-StoreStart
40310>>>>>>>>>>>>>
40310>>>>>>>>>>>>>                Procedure Change_Year
40312>>>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
40313>>>>>>>>>>>>>                End_Procedure // Change_Year
40314>>>>>>>>>>>>>
40314>>>>>>>>>>>>>                procedure go_today
40316>>>>>>>>>>>>>                    Date date#
40317>>>>>>>>>>>>>                    sysdate4 date#
40318>>>>>>>>>>>>>                    set p_current_date to date#
40319>>>>>>>>>>>>>                    Send Update_Calendar
40320>>>>>>>>>>>>>                end_procedure
40321>>>>>>>>>>>>>
40321>>>>>>>>>>>>>                procedure next_month
40323>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
40324>>>>>>>>>>>>>                    Send Update_Calendar
40325>>>>>>>>>>>>>                end_procedure
40326>>>>>>>>>>>>>
40326>>>>>>>>>>>>>                procedure prev_month
40328>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
40329>>>>>>>>>>>>>                    Send Update_Calendar
40330>>>>>>>>>>>>>                end_procedure
40331>>>>>>>>>>>>>
40331>>>>>>>>>>>>>                procedure next_year
40333>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
40334>>>>>>>>>>>>>                    Send Update_Calendar
40335>>>>>>>>>>>>>                end_procedure
40336>>>>>>>>>>>>>
40336>>>>>>>>>>>>>                procedure prev_year
40338>>>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
40339>>>>>>>>>>>>>                    Send Update_Calendar
40340>>>>>>>>>>>>>                end_procedure
40341>>>>>>>>>>>>>
40341>>>>>>>>>>>>>                Procedure Activate
40343>>>>>>>>>>>>>                    Date date#
40344>>>>>>>>>>>>>                    Forward Send Activate
40346>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40347>>>>>>>>>>>>>                End_Procedure
40348>>>>>>>>>>>>>
40348>>>>>>>>>>>>>                Procedure Update_Calendar
40350>>>>>>>>>>>>>                    Set Dynamic_Update_State To False
40351>>>>>>>>>>>>>                    send Fill_List
40352>>>>>>>>>>>>>                    Set Dynamic_Update_State To True
40353>>>>>>>>>>>>>                    // Send Update_Label
40353>>>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
40354>>>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
40355>>>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
40356>>>>>>>>>>>>>                End_Procedure
40357>>>>>>>>>>>>>
40357>>>>>>>>>>>>>                Procedure Fill_List
40359>>>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
40360>>>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
40360>>>>>>>>>>>>>                    Date dToday
40360>>>>>>>>>>>>>                    Send Delete_Data
40361>>>>>>>>>>>>>
40361>>>>>>>>>>>>>                    Get p_current_date to date#
40362>>>>>>>>>>>>>
40362>>>>>>>>>>>>>                    SysDate4 dToday
40363>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
40364>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
40365>>>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
40366>>>>>>>>>>>>>
40366>>>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
40367>>>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
40368>>>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
40369>>>>>>>>>>>>>                    Set p_current_month To sel_month#
40370>>>>>>>>>>>>>                    Set p_current_year To sel_year#
40371>>>>>>>>>>>>>
40371>>>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
40372>>>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
40373>>>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
40374>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
40375>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
40376>>>>>>>>>>>>>
40376>>>>>>>>>>>>>                    If (first_item# > 0) Begin
40378>>>>>>>>>>>>>                        Move (first_item#-1) to day#
40379>>>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
40385>>>>>>>>>>>>>>
40385>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
40386>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
40387>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40388>>>>>>>>>>>>>                            Decrement day#
40389>>>>>>>>>>>>>                        Loop
40390>>>>>>>>>>>>>>
40390>>>>>>>>>>>>>                    End
40390>>>>>>>>>>>>>>
40390>>>>>>>>>>>>>
40390>>>>>>>>>>>>>                    Move 1 To day#
40391>>>>>>>>>>>>>                    For iFor from first_item# to last_item#
40397>>>>>>>>>>>>>>
40397>>>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
40398>>>>>>>>>>>>>                        Set Entry_State Item iFor To False
40399>>>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
40401>>>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
40402>>>>>>>>>>>>>                            Set piCurrentDayItem to iFor
40403>>>>>>>>>>>>>                        End
40403>>>>>>>>>>>>>>
40403>>>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
40406>>>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
40407>>>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
40408>>>>>>>>>>>>>                        Set form_Mask item iFor To "## "
40409>>>>>>>>>>>>>                        Increment day#
40410>>>>>>>>>>>>>                    Loop
40411>>>>>>>>>>>>>>
40411>>>>>>>>>>>>>
40411>>>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
40412>>>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
40413>>>>>>>>>>>>>
40413>>>>>>>>>>>>>                    If (last_item# < 41) Begin
40415>>>>>>>>>>>>>                        Move 1 to day#
40416>>>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
40422>>>>>>>>>>>>>>
40422>>>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
40423>>>>>>>>>>>>>                            Set Entry_State Item iFor To False
40424>>>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
40425>>>>>>>>>>>>>                            Increment day#
40426>>>>>>>>>>>>>                        Loop
40427>>>>>>>>>>>>>>
40427>>>>>>>>>>>>>                    End
40427>>>>>>>>>>>>>>
40427>>>>>>>>>>>>>
40427>>>>>>>>>>>>>                End_Procedure
40428>>>>>>>>>>>>>
40428>>>>>>>>>>>>>                Procedure Help
40430>>>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
40430>>>>>>>>>>>>>                    Set Visible_State of Help_Container to True
40431>>>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
40432>>>>>>>>>>>>>                    Send Activate to Help_Container
40433>>>>>>>>>>>>>                End_Procedure
40434>>>>>>>>>>>>>
40434>>>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
40436>>>>>>>>>>>>>                    Send Move_Value_Out
40437>>>>>>>>>>>>>                    forward send mouse_click window char_pos
40439>>>>>>>>>>>>>                end_procedure
40440>>>>>>>>>>>>>
40440>>>>>>>>>>>>>                Procedure Move_Value_Out
40442>>>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
40443>>>>>>>>>>>>>                    Date Date# next_date# prev_date#
40443>>>>>>>>>>>>>                    Get Current_Item To iItm
40444>>>>>>>>>>>>>                    If (pExportState(Self)) Begin
40446>>>>>>>>>>>>>                        Get Value Item iItm To iDay
40447>>>>>>>>>>>>>                        Get p_current_month to iMonth
40448>>>>>>>>>>>>>                        Get p_current_year  to iYear
40449>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40450>>>>>>>>>>>>>
40450>>>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
40452>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
40453>>>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
40454>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
40455>>>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
40456>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40457>>>>>>>>>>>>>                        End
40457>>>>>>>>>>>>>>
40457>>>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
40459>>>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
40460>>>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
40461>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
40462>>>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
40463>>>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
40464>>>>>>>>>>>>>                        End
40464>>>>>>>>>>>>>>
40464>>>>>>>>>>>>>
40464>>>>>>>>>>>>>                        Send Export_Date date#
40465>>>>>>>>>>>>>                    End
40465>>>>>>>>>>>>>>
40465>>>>>>>>>>>>>                End_Procedure
40466>>>>>>>>>>>>>
40466>>>>>>>>>>>>>                Procedure Export_Date date date#
40468>>>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
40469>>>>>>>>>>>>>                    get invoking_object_id to focus#
40470>>>>>>>>>>>>>
40470>>>>>>>>>>>>>                    if focus# gt desktop begin
40472>>>>>>>>>>>>>                         get delegation_mode of focus# to dm#
40473>>>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
40474>>>>>>>>>>>>>                         get form_margin of focus# item current to margin#
40475>>>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
40476>>>>>>>>>>>>>                         set delegation_mode of focus# to dm#
40477>>>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
40480>>>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
40482>>>>>>>>>>>>>                         set item_changed_state of focus# item current to true
40483>>>>>>>>>>>>>                    end
40483>>>>>>>>>>>>>>
40483>>>>>>>>>>>>>                    Send Close_Calendar
40484>>>>>>>>>>>>>                End_Procedure
40485>>>>>>>>>>>>>
40485>>>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
40487>>>>>>>>>>>>>
40487>>>>>>>>>>>>>                    Procedure Close_Calendar
40489>>>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
40490>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
40491>>>>>>>>>>>>>
40491>>>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
40492>>>>>>>>>>>>>                    Send Add_item msg_None             ""
40493>>>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
40494>>>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
40495>>>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
40496>>>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
40497>>>>>>>>>>>>>                    Send Add_item msg_None             ""
40498>>>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
40499>>>>>>>>>>>>>                    Send Add_item msg_None             ""
40500>>>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
40501>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40502>>>>>>>>>>>>>
40502>>>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
40503>>>>>>>>>>>>>
40503>>>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
40505>>>>>>>>>>>>>                    Integer new_item liMonth
40506>>>>>>>>>>>>>                    Date    ldSysdate
40506>>>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
40508>>>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
40510>>>>>>>>>>>>>                        If (new_item >= 0) Begin
40512>>>>>>>>>>>>>                            Sysdate4 ldSysdate
40513>>>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
40514>>>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
40517>>>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
40519>>>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
40522>>>>>>>>>>>>>                        End
40522>>>>>>>>>>>>>>
40522>>>>>>>>>>>>>                    End
40522>>>>>>>>>>>>>>
40522>>>>>>>>>>>>>                    procedure_return new_item
40523>>>>>>>>>>>>>                End_Procedure // Current_Item
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>                //AB-StoreEnd
40524>>>>>>>>>>>>>
40524>>>>>>>>>>>>>            End_Object    // Grid2
40525>>>>>>>>>>>>>
40525>>>>>>>>>>>>>            Object Textbox2 is a Textbox
40527>>>>>>>>>>>>>                Set Label to "Mo"
40528>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40529>>>>>>>>>>>>>                Set Transparent_State to TRUE
40530>>>>>>>>>>>>>                Set Color to clWhite
40531>>>>>>>>>>>>>                Set TextColor to clNavy
40532>>>>>>>>>>>>>                Set Location to 19 4
40533>>>>>>>>>>>>>                Set Size to 10 15
40534>>>>>>>>>>>>>
40534>>>>>>>>>>>>>                //AB-StoreStart
40534>>>>>>>>>>>>>
40534>>>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
40535>>>>>>>>>>>>>                //AB-StoreEnd
40535>>>>>>>>>>>>>
40535>>>>>>>>>>>>>            End_Object    // Textbox2
40536>>>>>>>>>>>>>
40536>>>>>>>>>>>>>            Object Textbox3 is a Textbox
40538>>>>>>>>>>>>>                Set Label to "Tu"
40539>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40540>>>>>>>>>>>>>                Set Transparent_State to TRUE
40541>>>>>>>>>>>>>                Set Color to clWhite
40542>>>>>>>>>>>>>                Set TextColor to clNavy
40543>>>>>>>>>>>>>                Set Location to 19 22
40544>>>>>>>>>>>>>                Set Size to 10 12
40545>>>>>>>>>>>>>
40545>>>>>>>>>>>>>                //AB-StoreStart
40545>>>>>>>>>>>>>
40545>>>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
40546>>>>>>>>>>>>>                //AB-StoreEnd
40546>>>>>>>>>>>>>
40546>>>>>>>>>>>>>            End_Object    // Textbox3
40547>>>>>>>>>>>>>
40547>>>>>>>>>>>>>            Object Textbox4 is a Textbox
40549>>>>>>>>>>>>>                Set Label to "We"
40550>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40551>>>>>>>>>>>>>                Set Transparent_State to TRUE
40552>>>>>>>>>>>>>                Set Color to clWhite
40553>>>>>>>>>>>>>                Set TextColor to clNavy
40554>>>>>>>>>>>>>                Set Location to 19 39
40555>>>>>>>>>>>>>                Set Size to 10 15
40556>>>>>>>>>>>>>
40556>>>>>>>>>>>>>                //AB-StoreStart
40556>>>>>>>>>>>>>
40556>>>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
40557>>>>>>>>>>>>>                //AB-StoreEnd
40557>>>>>>>>>>>>>
40557>>>>>>>>>>>>>            End_Object    // Textbox4
40558>>>>>>>>>>>>>
40558>>>>>>>>>>>>>            Object Textbox5 is a Textbox
40560>>>>>>>>>>>>>                Set Label to "Th"
40561>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40562>>>>>>>>>>>>>                Set Transparent_State to TRUE
40563>>>>>>>>>>>>>                Set Color to clWhite
40564>>>>>>>>>>>>>                Set TextColor to clNavy
40565>>>>>>>>>>>>>                Set Location to 19 57
40566>>>>>>>>>>>>>                Set Size to 10 17
40567>>>>>>>>>>>>>
40567>>>>>>>>>>>>>                //AB-StoreStart
40567>>>>>>>>>>>>>
40567>>>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
40568>>>>>>>>>>>>>                //AB-StoreEnd
40568>>>>>>>>>>>>>
40568>>>>>>>>>>>>>            End_Object    // Textbox5
40569>>>>>>>>>>>>>
40569>>>>>>>>>>>>>            Object Textbox6 is a Textbox
40571>>>>>>>>>>>>>                Set Label to "Fr"
40572>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40573>>>>>>>>>>>>>                Set Transparent_State to TRUE
40574>>>>>>>>>>>>>                Set Color to clWhite
40575>>>>>>>>>>>>>                Set TextColor to clNavy
40576>>>>>>>>>>>>>                Set Location to 19 76
40577>>>>>>>>>>>>>                Set Size to 10 17
40578>>>>>>>>>>>>>
40578>>>>>>>>>>>>>                //AB-StoreStart
40578>>>>>>>>>>>>>
40578>>>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
40579>>>>>>>>>>>>>                //AB-StoreEnd
40579>>>>>>>>>>>>>
40579>>>>>>>>>>>>>            End_Object    // Textbox6
40580>>>>>>>>>>>>>
40580>>>>>>>>>>>>>            Object Textbox7 is a Textbox
40582>>>>>>>>>>>>>                Set Label to "Sa"
40583>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40584>>>>>>>>>>>>>                Set Transparent_State to TRUE
40585>>>>>>>>>>>>>                Set Color to clWhite
40586>>>>>>>>>>>>>                Set TextColor to clNavy
40587>>>>>>>>>>>>>                Set Location to 19 91
40588>>>>>>>>>>>>>                Set Size to 10 18
40589>>>>>>>>>>>>>
40589>>>>>>>>>>>>>                //AB-StoreStart
40589>>>>>>>>>>>>>
40589>>>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
40590>>>>>>>>>>>>>                //AB-StoreEnd
40590>>>>>>>>>>>>>
40590>>>>>>>>>>>>>            End_Object    // Textbox7
40591>>>>>>>>>>>>>
40591>>>>>>>>>>>>>            Object Textbox8 is a Textbox
40593>>>>>>>>>>>>>                Set Label to "Su"
40594>>>>>>>>>>>>>                Set Auto_Size_State to FALSE
40595>>>>>>>>>>>>>                Set Transparent_State to TRUE
40596>>>>>>>>>>>>>                Set Color to clWhite
40597>>>>>>>>>>>>>                Set TextColor to clNavy
40598>>>>>>>>>>>>>                Set Location to 19 109
40599>>>>>>>>>>>>>                Set Size to 10 17
40600>>>>>>>>>>>>>
40600>>>>>>>>>>>>>                //AB-StoreStart
40600>>>>>>>>>>>>>
40600>>>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
40601>>>>>>>>>>>>>                //AB-StoreEnd
40601>>>>>>>>>>>>>
40601>>>>>>>>>>>>>            End_Object    // Textbox8
40602>>>>>>>>>>>>>
40602>>>>>>>>>>>>>            Object LineControl1 is a LineControl
40604>>>>>>>>>>>>>                Set Line_Style to lnSINGLE
40605>>>>>>>>>>>>>                Set Size to 1 116
40606>>>>>>>>>>>>>                Set Location to 28 4
40607>>>>>>>>>>>>>
40607>>>>>>>>>>>>>                //AB-StoreStart
40607>>>>>>>>>>>>>
40607>>>>>>>>>>>>>                //AB-StoreEnd
40607>>>>>>>>>>>>>
40607>>>>>>>>>>>>>            End_Object    // LineControl1
40608>>>>>>>>>>>>>
40608>>>>>>>>>>>>>            Object Container3d2 is a Container3d
40610>>>>>>>>>>>>>                Set Size to 18 131
40611>>>>>>>>>>>>>                Set Location to 1 1
40612>>>>>>>>>>>>>                Set Color to clNavy
40613>>>>>>>>>>>>>                Set Border_Style to Border_None
40614>>>>>>>>>>>>>                Object oRght is a BitmapContainer
40616>>>>>>>>>>>>>                    Set Size to 10 14
40617>>>>>>>>>>>>>                    Set Location to 4 105
40618>>>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
40619>>>>>>>>>>>>>                    Set Border_Style to Border_None
40620>>>>>>>>>>>>>
40620>>>>>>>>>>>>>                    //AB-StoreStart
40620>>>>>>>>>>>>>                    Procedure Mouse_Down
40622>>>>>>>>>>>>>                        Send Next_Month to Grid2
40623>>>>>>>>>>>>>                    End_Procedure
40624>>>>>>>>>>>>>                    //AB-StoreEnd
40624>>>>>>>>>>>>>
40624>>>>>>>>>>>>>                End_Object    // oRght
40625>>>>>>>>>>>>>
40625>>>>>>>>>>>>>                Object oLeft is a BitmapContainer
40627>>>>>>>>>>>>>                    Set Size to 10 14
40628>>>>>>>>>>>>>                    Set Location to 4 3
40629>>>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
40630>>>>>>>>>>>>>                    Set Border_Style to Border_None
40631>>>>>>>>>>>>>
40631>>>>>>>>>>>>>                    //AB-StoreStart
40631>>>>>>>>>>>>>                    Procedure Mouse_Down
40633>>>>>>>>>>>>>                        Send Prev_Month to Grid2
40634>>>>>>>>>>>>>                    End_Procedure
40635>>>>>>>>>>>>>                    //AB-StoreEnd
40635>>>>>>>>>>>>>
40635>>>>>>>>>>>>>                End_Object    // oLeft
40636>>>>>>>>>>>>>
40636>>>>>>>>>>>>>                Object oMonth is a Textbox
40638>>>>>>>>>>>>>
40638>>>>>>>>>>>>>                    //AB-StoreTopStart
40638>>>>>>>>>>>>>                    Property integer piSelected_Month public 0
40640>>>>>>>>>>>>>                    //AB-StoreTopEnd
40640>>>>>>>>>>>>>
40640>>>>>>>>>>>>>                    Set Label to "January"
40641>>>>>>>>>>>>>                    Set Auto_Size_State to FALSE
40642>>>>>>>>>>>>>                    Set Transparent_State to TRUE
40643>>>>>>>>>>>>>                    Set Color to clWhite
40644>>>>>>>>>>>>>                    Set TextColor to clWhite
40645>>>>>>>>>>>>>                    Set Location to 4 19
40646>>>>>>>>>>>>>                    Set Size to 10 46
40647>>>>>>>>>>>>>                    Set FontWeight to 800
40648>>>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
40649>>>>>>>>>>>>>
40649>>>>>>>>>>>>>                    //AB-StoreStart
40649>>>>>>>>>>>>>
40649>>>>>>>>>>>>>                    Procedure Mouse_Down
40651>>>>>>>>>>>>>                        Integer iState
40652>>>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
40653>>>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
40656>>>>>>>>>>>>>                        Send Popup to oSelectMonth
40657>>>>>>>>>>>>>                    End_Procedure
40658>>>>>>>>>>>>>
40658>>>>>>>>>>>>>                    Procedure pSelectJan
40660>>>>>>>>>>>>>                        Set Label to t.calendar.january
40661>>>>>>>>>>>>>                        Set piSelected_Month to 1
40662>>>>>>>>>>>>>                        Send Adjust_Calendar
40663>>>>>>>>>>>>>                    End_Procedure
40664>>>>>>>>>>>>>                    Procedure pSelectFeb
40666>>>>>>>>>>>>>                        Set Label to t.calendar.february
40667>>>>>>>>>>>>>                        Set piSelected_Month to 2
40668>>>>>>>>>>>>>                        Send Adjust_Calendar
40669>>>>>>>>>>>>>                    End_Procedure
40670>>>>>>>>>>>>>                    Procedure pSelectMar
40672>>>>>>>>>>>>>                        Set Label to t.calendar.march
40673>>>>>>>>>>>>>                        Set piSelected_Month to 3
40674>>>>>>>>>>>>>                        Send Adjust_Calendar
40675>>>>>>>>>>>>>                    End_Procedure
40676>>>>>>>>>>>>>                    Procedure pSelectApr
40678>>>>>>>>>>>>>                        Set Label to t.calendar.april
40679>>>>>>>>>>>>>                        Set piSelected_Month to 4
40680>>>>>>>>>>>>>                        Send Adjust_Calendar
40681>>>>>>>>>>>>>                    End_Procedure
40682>>>>>>>>>>>>>                    Procedure pSelectMay
40684>>>>>>>>>>>>>                        Set Label to t.calendar.may
40685>>>>>>>>>>>>>                        Set piSelected_Month to 5
40686>>>>>>>>>>>>>                        Send Adjust_Calendar
40687>>>>>>>>>>>>>                    End_Procedure
40688>>>>>>>>>>>>>                    Procedure pSelectJun
40690>>>>>>>>>>>>>                        Set Label to t.calendar.june
40691>>>>>>>>>>>>>                        Set piSelected_Month to 6
40692>>>>>>>>>>>>>                        Send Adjust_Calendar
40693>>>>>>>>>>>>>                    End_Procedure
40694>>>>>>>>>>>>>                    Procedure pSelectJul
40696>>>>>>>>>>>>>                        Set Label to t.calendar.july
40697>>>>>>>>>>>>>                        Set piSelected_Month to 7
40698>>>>>>>>>>>>>                        Send Adjust_Calendar
40699>>>>>>>>>>>>>                    End_Procedure
40700>>>>>>>>>>>>>                    Procedure pSelectAug
40702>>>>>>>>>>>>>                        Set Label to t.calendar.august
40703>>>>>>>>>>>>>                        Set piSelected_Month to 8
40704>>>>>>>>>>>>>                        Send Adjust_Calendar
40705>>>>>>>>>>>>>                    End_Procedure
40706>>>>>>>>>>>>>                    Procedure pSelectSep
40708>>>>>>>>>>>>>                        Set Label to t.calendar.september
40709>>>>>>>>>>>>>                        Set piSelected_Month to 9
40710>>>>>>>>>>>>>                        Send Adjust_Calendar
40711>>>>>>>>>>>>>                    End_Procedure
40712>>>>>>>>>>>>>                    Procedure pSelectOct
40714>>>>>>>>>>>>>                        Set Label to t.calendar.october
40715>>>>>>>>>>>>>                        Set piSelected_Month to 10
40716>>>>>>>>>>>>>                        Send Adjust_Calendar
40717>>>>>>>>>>>>>                    End_Procedure
40718>>>>>>>>>>>>>                    Procedure pSelectNov
40720>>>>>>>>>>>>>                        Set Label to t.calendar.november
40721>>>>>>>>>>>>>                        Set piSelected_Month to 11
40722>>>>>>>>>>>>>                        Send Adjust_Calendar
40723>>>>>>>>>>>>>                    End_Procedure
40724>>>>>>>>>>>>>                    Procedure pSelectDec
40726>>>>>>>>>>>>>                        Set Label to t.calendar.december
40727>>>>>>>>>>>>>                        Set piSelected_Month to 12
40728>>>>>>>>>>>>>                        Send Adjust_Calendar
40729>>>>>>>>>>>>>                    End_Procedure
40730>>>>>>>>>>>>>
40730>>>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
40732>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
40733>>>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
40734>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
40735>>>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
40736>>>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
40737>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
40738>>>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
40739>>>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
40740>>>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
40741>>>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
40742>>>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
40743>>>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
40744>>>>>>>>>>>>>                    End_Object
40745>>>>>>>>>>>>>
40745>>>>>>>>>>>>>                    Procedure Adjust_Calendar
40747>>>>>>>>>>>>>                        Date date#
40748>>>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
40748>>>>>>>>>>>>>                        Set Visible_State to false
40749>>>>>>>>>>>>>                        Set Visible_State to true
40750>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40751>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40752>>>>>>>>>>>>>                        Get piSelected_Month to iMonth
40753>>>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
40754>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40755>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40756>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40757>>>>>>>>>>>>>                    End_Procedure
40758>>>>>>>>>>>>>
40758>>>>>>>>>>>>>                    Procedure Activating
40760>>>>>>>>>>>>>                        Forward Send Activating
40762>>>>>>>>>>>>>                        Send Date_Changing
40763>>>>>>>>>>>>>                    End_Procedure
40764>>>>>>>>>>>>>
40764>>>>>>>>>>>>>                    Procedure Date_Changing
40766>>>>>>>>>>>>>                        Set Visible_State to false
40767>>>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
40768>>>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
40769>>>>>>>>>>>>>                        Set Visible_State to true
40770>>>>>>>>>>>>>                    End_Procedure
40771>>>>>>>>>>>>>
40771>>>>>>>>>>>>>
40771>>>>>>>>>>>>>
40771>>>>>>>>>>>>>                    //AB-StoreEnd
40771>>>>>>>>>>>>>
40771>>>>>>>>>>>>>                End_Object    // oMonth
40772>>>>>>>>>>>>>
40772>>>>>>>>>>>>>                Object oCalendarYear is a Textbox
40774>>>>>>>>>>>>>                    Set Label to "2001"
40775>>>>>>>>>>>>>                    Set Transparent_State to TRUE
40776>>>>>>>>>>>>>                    Set Color to clWhite
40777>>>>>>>>>>>>>                    Set TextColor to clWhite
40778>>>>>>>>>>>>>                    Set Location to 4 77
40779>>>>>>>>>>>>>                    Set Size to 10 18
40780>>>>>>>>>>>>>                    Set FontWeight to 800
40781>>>>>>>>>>>>>
40781>>>>>>>>>>>>>                    //AB-StoreStart
40781>>>>>>>>>>>>>
40781>>>>>>>>>>>>>                    Procedure Mouse_Down
40783>>>>>>>>>>>>>                        String sVal
40784>>>>>>>>>>>>>                        Get Label to sVal
40785>>>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
40786>>>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
40787>>>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
40788>>>>>>>>>>>>>                    End_Procedure
40789>>>>>>>>>>>>>
40789>>>>>>>>>>>>>                    Procedure Activating
40791>>>>>>>>>>>>>                        Forward Send Activating
40793>>>>>>>>>>>>>                        Send Date_Changing
40794>>>>>>>>>>>>>                    End_Procedure
40795>>>>>>>>>>>>>
40795>>>>>>>>>>>>>                    Procedure Date_Changing
40797>>>>>>>>>>>>>                        Set Visible_State to false
40798>>>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
40799>>>>>>>>>>>>>                        Set Visible_State to true
40800>>>>>>>>>>>>>                    End_Procedure
40801>>>>>>>>>>>>>
40801>>>>>>>>>>>>>                    //AB-StoreEnd
40801>>>>>>>>>>>>>
40801>>>>>>>>>>>>>                End_Object    // oCalendarYear
40802>>>>>>>>>>>>>
40802>>>>>>>>>>>>>                Object oSelectCalendarYear is a Form
40804>>>>>>>>>>>>>
40804>>>>>>>>>>>>>                    //AB-StoreTopStart
40804>>>>>>>>>>>>>                    Set Visible_State To False
40805>>>>>>>>>>>>>                    //AB-StoreTopEnd
40805>>>>>>>>>>>>>
40805>>>>>>>>>>>>>                    Set Size to 10 24
40806>>>>>>>>>>>>>                    Set Location to 4 75
40807>>>>>>>>>>>>>                    Set Color to clWhite
40808>>>>>>>>>>>>>                    Set TextColor to clNavy
40809>>>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
40810>>>>>>>>>>>>>
40810>>>>>>>>>>>>>                    //AB-StoreStart
40810>>>>>>>>>>>>>
40810>>>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
40811>>>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
40812>>>>>>>>>>>>>
40812>>>>>>>>>>>>>                    Procedure SetFontWeight
40814>>>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
40815>>>>>>>>>>>>>                    End_Procedure
40816>>>>>>>>>>>>>
40816>>>>>>>>>>>>>                    Procedure OnKillFocus
40818>>>>>>>>>>>>>                        String sVal
40819>>>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
40819>>>>>>>>>>>>>                        Date date#
40819>>>>>>>>>>>>>                        Get Value item 0 to sVal
40820>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
40821>>>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
40822>>>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
40823>>>>>>>>>>>>>                        Set Visible_State to false
40824>>>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
40825>>>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
40826>>>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
40827>>>>>>>>>>>>>                        Get Value item 0 to iYear
40828>>>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
40831>>>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
40832>>>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
40833>>>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
40834>>>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
40835>>>>>>>>>>>>>                    End_Procedure
40836>>>>>>>>>>>>>
40836>>>>>>>>>>>>>                    Send SetFontWeight
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>                    //AB-StoreEnd
40837>>>>>>>>>>>>>
40837>>>>>>>>>>>>>                End_Object    // oSelectCalendarYear
40838>>>>>>>>>>>>>
40838>>>>>>>>>>>>>
40838>>>>>>>>>>>>>                //AB-StoreStart
40838>>>>>>>>>>>>>
40838>>>>>>>>>>>>>                Procedure Mouse_Down
40840>>>>>>>>>>>>>                    Integer iState
40841>>>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
40842>>>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
40845>>>>>>>>>>>>>                End_Procedure
40846>>>>>>>>>>>>>
40846>>>>>>>>>>>>>
40846>>>>>>>>>>>>>                //AB-StoreEnd
40846>>>>>>>>>>>>>
40846>>>>>>>>>>>>>            End_Object    // Container3d2
40847>>>>>>>>>>>>>
40847>>>>>>>>>>>>>
40847>>>>>>>>>>>>>            //AB-StoreStart
40847>>>>>>>>>>>>>
40847>>>>>>>>>>>>>
40847>>>>>>>>>>>>>            //AB-StoreEnd
40847>>>>>>>>>>>>>
40847>>>>>>>>>>>>>        End_Object    // Container3d1
40848>>>>>>>>>>>>>
40848>>>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
40850>>>>>>>>>>>>>            Set Size to 9 19
40851>>>>>>>>>>>>>            Set Location to 88 3
40852>>>>>>>>>>>>>            Set Color to clWhite
40853>>>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
40854>>>>>>>>>>>>>            Set Border_Style to Border_None
40855>>>>>>>>>>>>>
40855>>>>>>>>>>>>>            //AB-StoreStart
40855>>>>>>>>>>>>>            Procedure Mouse_Down
40857>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40858>>>>>>>>>>>>>                Send Adjust_Label to oToday
40859>>>>>>>>>>>>>            End_Procedure
40860>>>>>>>>>>>>>            //AB-StoreEnd
40860>>>>>>>>>>>>>
40860>>>>>>>>>>>>>        End_Object    // BitmapContainer3
40861>>>>>>>>>>>>>
40861>>>>>>>>>>>>>        Object oToday is a Textbox
40863>>>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
40864>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
40865>>>>>>>>>>>>>            Set Color to clWhite
40866>>>>>>>>>>>>>            Set Location to 88 22
40867>>>>>>>>>>>>>            Set Size to 8 70
40868>>>>>>>>>>>>>            Set FontWeight to 800
40869>>>>>>>>>>>>>
40869>>>>>>>>>>>>>            //AB-StoreStart
40869>>>>>>>>>>>>>            Procedure Mouse_Down
40871>>>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
40872>>>>>>>>>>>>>                Send Adjust_Label
40873>>>>>>>>>>>>>            End_Procedure
40874>>>>>>>>>>>>>
40874>>>>>>>>>>>>>            Procedure Adjust_Label
40876>>>>>>>>>>>>>                date date#
40877>>>>>>>>>>>>>                SysDate4 date#
40878>>>>>>>>>>>>>                Set Visible_State To false
40879>>>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
40880>>>>>>>>>>>>>                Set Visible_State To true
40881>>>>>>>>>>>>>            End_Procedure
40882>>>>>>>>>>>>>
40882>>>>>>>>>>>>>            Procedure Activating
40884>>>>>>>>>>>>>                Forward Send Activating
40886>>>>>>>>>>>>>                Send Adjust_Label
40887>>>>>>>>>>>>>            End_Procedure
40888>>>>>>>>>>>>>            //AB-StoreEnd
40888>>>>>>>>>>>>>
40888>>>>>>>>>>>>>        End_Object    // oToday
40889>>>>>>>>>>>>>
40889>>>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
40891>>>>>>>>>>>>>            Set Size to 9 10
40892>>>>>>>>>>>>>            Set Location to 88 112
40893>>>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
40894>>>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
40895>>>>>>>>>>>>>
40895>>>>>>>>>>>>>            //AB-StoreStart
40895>>>>>>>>>>>>>
40895>>>>>>>>>>>>>            Procedure Mouse_Up
40897>>>>>>>>>>>>>                Send Close_Calendar
40898>>>>>>>>>>>>>            End_Procedure // Mouse_Up
40899>>>>>>>>>>>>>
40899>>>>>>>>>>>>>
40899>>>>>>>>>>>>>
40899>>>>>>>>>>>>>
40899>>>>>>>>>>>>>            //AB-StoreEnd
40899>>>>>>>>>>>>>
40899>>>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
40900>>>>>>>>>>>>>
40900>>>>>>>>>>>>>
40900>>>>>>>>>>>>>        //AB-StoreStart
40900>>>>>>>>>>>>>
40900>>>>>>>>>>>>>        Set Block_Mouse_State to True
40901>>>>>>>>>>>>>        Set Popup_State to True
40902>>>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
40903>>>>>>>>>>>>>
40903>>>>>>>>>>>>>        procedure popup
40905>>>>>>>>>>>>>            local integer focus# icItm iYear iMonth
40906>>>>>>>>>>>>>            local date date#
40906>>>>>>>>>>>>>            move (focus(desktop)) to focus#
40907>>>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
40908>>>>>>>>>>>>>            get value of focus# item current to date#
40909>>>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
40912>>>>>>>>>>>>>            move (Date2to4(date#)) to date#
40913>>>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
40914>>>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
40915>>>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
40916>>>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
40917>>>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
40918>>>>>>>>>>>>>            forward send popup
40920>>>>>>>>>>>>>        end_procedure
40921>>>>>>>>>>>>>
40921>>>>>>>>>>>>>        Procedure Close_Calendar
40923>>>>>>>>>>>>>            Send Close_Panel
40924>>>>>>>>>>>>>        End_Procedure // Close_Calendar
40925>>>>>>>>>>>>>
40925>>>>>>>>>>>>>        Object Help_Container is a Container3d
40927>>>>>>>>>>>>>            Set Location to 0 0
40928>>>>>>>>>>>>>            Set Size     to 98 122
40929>>>>>>>>>>>>>            Set Visible_State to False
40930>>>>>>>>>>>>>            Set Enabled_State to False
40931>>>>>>>>>>>>>            Set Border_Style to Border_None
40932>>>>>>>>>>>>>            Set TextColor to clNavy
40933>>>>>>>>>>>>>
40933>>>>>>>>>>>>>            Object Help_Info is an Edit
40935>>>>>>>>>>>>>                Set Location to 0 0
40936>>>>>>>>>>>>>                Set Size     to 98 122
40937>>>>>>>>>>>>>                Set read_only_state to true
40938>>>>>>>>>>>>>                Set Border_Style to Border_None
40939>>>>>>>>>>>>>                Set scroll_bar_visible_state to False
40940>>>>>>>>>>>>>                Set FontWeight to 800
40941>>>>>>>>>>>>>
40941>>>>>>>>>>>>>                Procedure ReadHelpComments
40943>>>>>>>>>>>>>                    String lsFile
40944>>>>>>>>>>>>>
40944>>>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
40945>>>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
40948>>>>>>>>>>>>>                End_Procedure // ReadHelpComments
40949>>>>>>>>>>>>>
40949>>>>>>>>>>>>>                Procedure SetComments
40951>>>>>>>>>>>>>                    Send append_text "Help on Calendar"
40952>>>>>>>>>>>>>                    Send Insert ""
40953>>>>>>>>>>>>>                    Send Insert ""
40954>>>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
40955>>>>>>>>>>>>>                    Send Insert ""
40956>>>>>>>>>>>>>                    Send append_text "  - select date."
40957>>>>>>>>>>>>>                    Send Insert ""
40958>>>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
40959>>>>>>>>>>>>>                    Send Insert ""
40960>>>>>>>>>>>>>                    Send append_text "  - select month."
40961>>>>>>>>>>>>>                    Send Insert ""
40962>>>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
40963>>>>>>>>>>>>>                    Send Insert ""
40964>>>>>>>>>>>>>                    Send append_text "  - set current date."
40965>>>>>>>>>>>>>                    Send Insert ""
40966>>>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
40967>>>>>>>>>>>>>                    Send Insert ""
40968>>>>>>>>>>>>>                    Send append_text "  - Change year."
40969>>>>>>>>>>>>>                    Send Insert ""
40970>>>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
40971>>>>>>>>>>>>>                    Send Insert ""
40972>>>>>>>>>>>>>                    Send append_text "  - Select year."
40973>>>>>>>>>>>>>                End_procedure // SetComments
40974>>>>>>>>>>>>>
40974>>>>>>>>>>>>>                //Send SetComments
40974>>>>>>>>>>>>>                Set Color     to clWhite
40975>>>>>>>>>>>>>                Set TextColor to clNavy
40976>>>>>>>>>>>>>
40976>>>>>>>>>>>>>                Procedure OnSetFocus
40978>>>>>>>>>>>>>                    Send ReadHelpComments
40979>>>>>>>>>>>>>                End_Procedure
40980>>>>>>>>>>>>>
40980>>>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
40982>>>>>>>>>>>>>
40982>>>>>>>>>>>>>                    Procedure Close_Help
40984>>>>>>>>>>>>>                        Send Close_Help to Help_Container
40985>>>>>>>>>>>>>                    End_Procedure // Close_Calendar
40986>>>>>>>>>>>>>
40986>>>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
40987>>>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
40988>>>>>>>>>>>>>
40988>>>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
40990>>>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
40991>>>>>>>>>>>>>                End_Procedure // Mouse_Up2
40992>>>>>>>>>>>>>
40992>>>>>>>>>>>>>            End_Object
40993>>>>>>>>>>>>>
40993>>>>>>>>>>>>>            Procedure Close_Help
40995>>>>>>>>>>>>>                Send Delete_Data to Help_Info
40996>>>>>>>>>>>>>                Set Visible_State to False
40997>>>>>>>>>>>>>                Set Enabled_State to False
40998>>>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
40999>>>>>>>>>>>>>            End_Procedure // Close_Help
41000>>>>>>>>>>>>>
41000>>>>>>>>>>>>>            On_Key kCancel Send Close_Help
41001>>>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
41002>>>>>>>>>>>>>            On_Key kEnter  Send Close_Help
41003>>>>>>>>>>>>>        End_Object // Help_Info
41004>>>>>>>>>>>>>
41004>>>>>>>>>>>>>        on_key kcancel           send Close_Calendar
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>        //AB-StoreEnd
41005>>>>>>>>>>>>>
41005>>>>>>>>>>>>>    End_Object    // oCalendar
41006>>>>>>>>>>>>>
41006>>>>>>>>>>>>>
41006>>>>>>>>>>>>>    //AB-StoreStart
41006>>>>>>>>>>>>>
41006>>>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
41007>>>>>>>>>>>>>        Integer focus# type# dm#
41008>>>>>>>>>>>>>
41008>>>>>>>>>>>>>        move (focus(desktop)) to focus#
41009>>>>>>>>>>>>>        if focus# gt desktop begin
41011>>>>>>>>>>>>>          get delegation_mode of focus# to dm#
41012>>>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
41013>>>>>>>>>>>>>          get form_datatype of focus# item current to type#
41014>>>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
41017>>>>>>>>>>>>>          set delegation_mode of focus# to dm#
41018>>>>>>>>>>>>>        end
41018>>>>>>>>>>>>>>
41018>>>>>>>>>>>>>    End_Procedure
41019>>>>>>>>>>>>>
41019>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
41020>>>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
41021>>>>>>>>>>>>>
41021>>>>>>>>>>>>>
41021>>>>>>>>>>>>>    //AB-StoreEnd
41021>>>>>>>>>>>>>
41021>>>>>>>>>>>>>//AB/     End_Object    // prj
41021>>>>>>>>>>>Use Dates.Utl
41021>>>>>>>>>>>
41021>>>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
41021>>>>>>>>>>>   Define cDateToday        for "T"
41021>>>>>>>>>>>   Define cDateBeginOfMonth for "B"
41021>>>>>>>>>>>   Define cDateEndOfMonth   for "E"
41021>>>>>>>>>>>
41021>>>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
41022>>>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
41023>>>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
41024>>>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
41025>>>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
41026>>>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
41027>>>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
41028>>>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
41029>>>>>>>>>>>
41029>>>>>>>>>>>   Procedure DoAddOneDay
41030>>>>>>>>>>>        Integer rVal
41031>>>>>>>>>>>        Date dHmnia
41031>>>>>>>>>>>
41031>>>>>>>>>>>        Get Value Item 0 to dHmnia
41032>>>>>>>>>>>        Add 1 to dHmnia
41033>>>>>>>>>>>        Set Value Item 0 to dHmnia
41034>>>>>>>>>>>    End_Procedure // Add_One_Day
41035>>>>>>>>>>>
41035>>>>>>>>>>>    Procedure DoSubOneDay
41036>>>>>>>>>>>        Integer rVal
41037>>>>>>>>>>>        Date dHmnia
41037>>>>>>>>>>>
41037>>>>>>>>>>>        Get Value Item 0 to dHmnia
41038>>>>>>>>>>>        Sub 1 to dHmnia
41039>>>>>>>>>>>        Set Value Item 0 to dHmnia
41040>>>>>>>>>>>    End_Procedure // Add_One_Day
41041>>>>>>>>>>>
41041>>>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
41041>>>>>>>>>>>   Procedure Entering returns Integer
41042>>>>>>>>>>>      Integer iRetVal
41043>>>>>>>>>>>      Date    dOriginal
41043>>>>>>>>>>>      Forward Get Msg_Entering to iRetVal
41045>>>>>>>>>>>      If (iRetVal = 0) Begin
41047>>>>>>>>>>>         Send DoStoreOriginalDate
41048>>>>>>>>>>>      End
41048>>>>>>>>>>>>
41048>>>>>>>>>>>      Procedure_Return iRetVal
41049>>>>>>>>>>>   End_Procedure // Entering
41050>>>>>>>>>>>
41050>>>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
41050>>>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
41050>>>>>>>>>>>   Procedure Next
41051>>>>>>>>>>>      Send DoIntelliSenseDate
41052>>>>>>>>>>>      Forward Send Next
41054>>>>>>>>>>>   End_Procedure // Next
41055>>>>>>>>>>>
41055>>>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
41055>>>>>>>>>>>   Procedure DoStoreOriginalDate
41056>>>>>>>>>>>      Date    dOriginal
41057>>>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
41057>>>>>>>>>>>         Get Value Item 0 to dOriginal
41058>>>>>>>>>>>         Set pdOriginal_Value to dOriginal
41059>>>>>>>>>>>      //End
41059>>>>>>>>>>>   End_Procedure // DoStoreOriginalDate
41060>>>>>>>>>>>
41060>>>>>>>>>>>   Procedure DoIntelliSenseDate
41061>>>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
41062>>>>>>>>>>>      Date    dCurrent dOriginal
41062>>>>>>>>>>>      String  sStored  sCurrent sSep sMask
41062>>>>>>>>>>>
41062>>>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
41063>>>>>>>>>>>      Get pdOriginal_Value to dOriginal
41064>>>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
41066>>>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
41069>>>>>>>>>>>
41069>>>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
41069>>>>>>>>>>>         // USA dates.
41069>>>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
41070>>>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
41071>>>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
41074>>>>>>>>>>>         Move (Character(iSep)) to sSep
41075>>>>>>>>>>>
41075>>>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
41075>>>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
41076>>>>>>>>>>>         Move (sSep+sSep) to sMask
41077>>>>>>>>>>>
41077>>>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
41077>>>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
41077>>>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
41077>>>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
41077>>>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
41079>>>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
41080>>>>>>>>>>>            Move sCurrent to iCurrent
41081>>>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
41083>>>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
41086>>>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
41088>>>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
41089>>>>>>>>>>>               End
41089>>>>>>>>>>>>
41089>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
41092>>>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
41093>>>>>>>>>>>               End
41093>>>>>>>>>>>>
41093>>>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
41096>>>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
41097>>>>>>>>>>>               End
41097>>>>>>>>>>>>
41097>>>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
41098>>>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
41098>>>>>>>>>>>>
41098>>>>>>>>>>>         End
41098>>>>>>>>>>>>
41098>>>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
41101>>>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
41104>>>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
41106>>>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
41107>>>>>>>>>>>            End
41107>>>>>>>>>>>>
41107>>>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
41110>>>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
41111>>>>>>>>>>>            End
41111>>>>>>>>>>>>
41111>>>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
41112>>>>>>>>>>>         End
41112>>>>>>>>>>>>
41112>>>>>>>>>>>      End
41112>>>>>>>>>>>>
41112>>>>>>>>>>>   End_Procedure // DoIntelliSenseDate
41113>>>>>>>>>>>
41113>>>>>>>>>>>   Procedure Key Integer iKey Returns Integer
41114>>>>>>>>>>>      Date dToday dTemp
41115>>>>>>>>>>>      Sysdate4 dToday
41116>>>>>>>>>>>
41116>>>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
41118>>>>>>>>>>>         Set Value to dToday
41119>>>>>>>>>>>      End
41119>>>>>>>>>>>>
41119>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
41122>>>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
41123>>>>>>>>>>>         Set Value to dTemp
41124>>>>>>>>>>>      End
41124>>>>>>>>>>>>
41124>>>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
41127>>>>>>>>>>>         Get LastDayInMonth dToday to dTemp
41128>>>>>>>>>>>         Set Value to dTemp
41129>>>>>>>>>>>      End
41129>>>>>>>>>>>>
41129>>>>>>>>>>>      Else Forward Send Key iKey
41132>>>>>>>>>>>   End_procedure
41133>>>>>>>>>>>
41133>>>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
41134>>>>>>>>>
41134>>>>>>>>>Class cSyDateForm Is A FormSub
41135>>>>>>>>>   Procedure Construct_Object
41136>>>>>>>>>      Forward Send Construct_Object
41138>>>>>>>>>
41138>>>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
41139>>>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
41140>>>>>>>>>
41140>>>>>>>>>      Send DoDefineIntelliSenseDateMixin
41141>>>>>>>>>
41141>>>>>>>>>      On_Key kPrompt Send Prompt
41142>>>>>>>>>
41142>>>>>>>>>      Set Prompt_Object to (oCalendar(Self))
41143>>>>>>>>>      Set Status_Help   to cStatusHelp
41144>>>>>>>>>
41144>>>>>>>>>   End_Procedure // Construct_Object
41145>>>>>>>>>
41145>>>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
41146>>>>>>>>>
41146>>>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
41146>>>>>>>>>//      Integer iDatatype
41146>>>>>>>>>//
41146>>>>>>>>>//      If (iItem = Current) Begin
41146>>>>>>>>>//         Get Current_Item to iItem
41146>>>>>>>>>//      End
41146>>>>>>>>>//
41146>>>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
41146>>>>>>>>>//
41146>>>>>>>>>//      Function_Return iDatatype
41146>>>>>>>>>//   End_Function // Form_Datatype
41146>>>>>>>>>
41146>>>>>>>>>End_Class // cSyDateForm
41147>>>>>>>Use Chkbox.Sub
41147>>>>>>>Use Button.Sub
41147>>>>>>>
41147>>>>>>>
41147>>>>>>>Use BTYPKIN.DD
41147>>>>>>>Use BARTICL.DD
41147>>>>>>>Use COUNTRY.DD
INCLUDING FILE: COUNTRY.DD
41147>>>>>>>>>//DDB-FileStart
41147>>>>>>>>>//DDB-HeaderStart
41147>>>>>>>>>
41147>>>>>>>>>// File Name : COUNTRY.DD
41147>>>>>>>>>// Class Name: Country_DataDictionary
41147>>>>>>>>>// Revision  : 3
41147>>>>>>>>>// Version   : 2
41147>>>>>>>>>
41147>>>>>>>>>Use  Windows           // Basic Definitions
41147>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41147>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41147>>>>>>>>>
41147>>>>>>>>>Open Country
41149>>>>>>>>>Open Towns
41151>>>>>>>>>
41151>>>>>>>>>//DDB-HeaderEnd
41151>>>>>>>>>//DDB-SelectionStart
41151>>>>>>>>>//DDB/ ExternalSelectionList sl058  sl058.SL
41151>>>>>>>>>Register_Object sl058
41151>>>>>>>>>//DDB-SelectionEnd
41151>>>>>>>>>
41151>>>>>>>>>Class Country_DataDictionary  is a DataDictionary_Sec
41152>>>>>>>>>
41152>>>>>>>>>    // Define_Fields:
41152>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41152>>>>>>>>>
41152>>>>>>>>>    Procedure Define_Fields
41153>>>>>>>>>        Forward Send Define_Fields
41155>>>>>>>>>        //DDB-Generated-Code-Location
41155>>>>>>>>>        //DDB-DefineFieldStart
41155>>>>>>>>>
41155>>>>>>>>>        Set Main_File            To Country.File_Number
41156>>>>>>>>>        Set Cascade_Delete_State To FALSE
41157>>>>>>>>>
41157>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41158>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41159>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41160>>>>>>>>>
41160>>>>>>>>>        // Child (Client) file structure................
41160>>>>>>>>>        Send Add_Client_File  Towns.File_Number
41161>>>>>>>>>
41161>>>>>>>>>        // Field-based properties.......................
41161>>>>>>>>>
41161>>>>>>>>>        // Country.Country_Id
41161>>>>>>>>>        Set Field_Options          Field Country.Country_Id To DD_AUTOFIND   
41162>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Id To (sl058(Self))
41163>>>>>>>>>
41163>>>>>>>>>        // Country.Country_Descr
41163>>>>>>>>>        Set Field_Prompt_Object    Field Country.Country_Descr To (sl058(Self))
41164>>>>>>>>>
41164>>>>>>>>>        //DDB-DefineFieldEnd
41164>>>>>>>>>    End_Procedure    // Define_Fields
41165>>>>>>>>>
41165>>>>>>>>>    // Field_Defaults:
41165>>>>>>>>>    // This procedure is used to establish default field values.
41165>>>>>>>>>
41165>>>>>>>>>    Procedure Field_Defaults
41166>>>>>>>>>        Forward Send Field_Defaults
41168>>>>>>>>>        //DDB-Generated-Code-Location
41168>>>>>>>>>        //DDB-FieldDefaultStart
41168>>>>>>>>>        //DDB-FieldDefaultEnd
41168>>>>>>>>>    End_Procedure    // Field_Defaults
41169>>>>>>>>>
41169>>>>>>>>>End_Class    // Country_DataDictionary
41170>>>>>>>>>//DDB-Selection-pkg-Start
41170>>>>>>>>>
41170>>>>>>>>>Use sl058.SL         // sl058
INCLUDING FILE: SL058.SL
41170>>>>>>>>>>>//AB/ Project sl058 : Countries - Xores
41170>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41170>>>>>>>>>>>//AB/         Set ProjectName to "sl058 : Countries - Xores"
41170>>>>>>>>>>>//AB/         Set ProjectFileName to "sl058.SL"
41170>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41170>>>>>>>>>>>
41170>>>>>>>>>>>// Project Object Structure
41170>>>>>>>>>>>//   sl058 is a dbModalPanelSub
41170>>>>>>>>>>>//     Country_DD is a DataDictionary
41170>>>>>>>>>>>//     oSelList is a dbListSub
41170>>>>>>>>>>>//     oOK_bn is a ButtonSub
41170>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41170>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41170>>>>>>>>>>>
41170>>>>>>>>>>>// Register all objects
41170>>>>>>>>>>>Register_Object Country_DD
41170>>>>>>>>>>>Register_Object oCancel_bn
41170>>>>>>>>>>>Register_Object oOK_bn
41170>>>>>>>>>>>Register_Object oSearch_bn
41170>>>>>>>>>>>Register_Object oSelList
41170>>>>>>>>>>>Register_Object sl058
41170>>>>>>>>>>>
41170>>>>>>>>>>>
41170>>>>>>>>>>>    //AB-IgnoreStart
41170>>>>>>>>>>>
41170>>>>>>>>>>>    Use DFAllEnt.pkg
41170>>>>>>>>>>>    Use dbList.Sub
41170>>>>>>>>>>>    Use Button.Sub
41170>>>>>>>>>>>
41170>>>>>>>>>>>
41170>>>>>>>>>>>    Use Country.DD
41170>>>>>>>>>>>    
41170>>>>>>>>>>>    //AB-IgnoreEnd
41170>>>>>>>>>>>
41170>>>>>>>>>>>    Object sl058 is a dbModalPanelSub
41172>>>>>>>>>>>        Set Label to "•é¨œª"
41173>>>>>>>>>>>        Set Size to 148 297
41174>>>>>>>>>>>        Set Location to 6 10
41175>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41176>>>>>>>>>>>        Set Modal_State to FALSE
41177>>>>>>>>>>>
41177>>>>>>>>>>>        //AB-DDOStart
41177>>>>>>>>>>>
41177>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
41179>>>>>>>>>>>        End_Object    // Country_DD
41180>>>>>>>>>>>
41180>>>>>>>>>>>        Set Main_DD to (Country_DD(self))
41181>>>>>>>>>>>        Set Server to (Country_DD(self))
41182>>>>>>>>>>>
41182>>>>>>>>>>>        //AB-DDOEnd
41182>>>>>>>>>>>
41182>>>>>>>>>>>        Object oSelList is a dbListSub
41184>>>>>>>>>>>            Set Main_File to Country.File_Number
41185>>>>>>>>>>>            Set Size to 105 280
41186>>>>>>>>>>>            Set Location to 6 6
41187>>>>>>>>>>>
41187>>>>>>>>>>>            Begin_Row
41190>>>>>>>>>>>                Entry_Item Country.Country_id
41191>>>>>>>>>>>                Entry_Item Country.Country_descr
41192>>>>>>>>>>>            End_Row
41197>>>>>>>>>>>
41197>>>>>>>>>>>            Set Form_Width    item 0 to 87
41198>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
41199>>>>>>>>>>>            
41199>>>>>>>>>>>            Set Form_Width    item 1 to 183
41200>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41201>>>>>>>>>>>            
41201>>>>>>>>>>>        End_Object    // oSelList
41202>>>>>>>>>>>
41202>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41204>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41205>>>>>>>>>>>            Set Location to 115 126
41206>>>>>>>>>>>
41206>>>>>>>>>>>            //AB-StoreStart
41206>>>>>>>>>>>            Procedure OnClick
41208>>>>>>>>>>>                Send OK To (oSelList(current_object))
41209>>>>>>>>>>>            End_Procedure
41210>>>>>>>>>>>            //AB-StoreEnd
41210>>>>>>>>>>>
41210>>>>>>>>>>>        End_Object    // oOK_bn
41211>>>>>>>>>>>
41211>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41213>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41214>>>>>>>>>>>            Set Location to 115 181
41215>>>>>>>>>>>
41215>>>>>>>>>>>            //AB-StoreStart
41215>>>>>>>>>>>            Procedure OnClick
41217>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41218>>>>>>>>>>>            End_Procedure
41219>>>>>>>>>>>            //AB-StoreEnd
41219>>>>>>>>>>>
41219>>>>>>>>>>>        End_Object    // oCancel_bn
41220>>>>>>>>>>>
41220>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41222>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41223>>>>>>>>>>>            Set Location to 115 236
41224>>>>>>>>>>>
41224>>>>>>>>>>>            //AB-StoreStart
41224>>>>>>>>>>>            Procedure OnClick
41226>>>>>>>>>>>                Send Search To (oSelList(current_object))
41227>>>>>>>>>>>            End_Procedure
41228>>>>>>>>>>>            //AB-StoreEnd
41228>>>>>>>>>>>
41228>>>>>>>>>>>        End_Object    // oSearch_bn
41229>>>>>>>>>>>
41229>>>>>>>>>>>
41229>>>>>>>>>>>        //AB-StoreStart
41229>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41230>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41231>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41232>>>>>>>>>>>        //AB-StoreEnd
41232>>>>>>>>>>>
41232>>>>>>>>>>>    End_Object    // sl058
41233>>>>>>>>>>>
41233>>>>>>>>>>>//AB/     End_Object    // prj
41233>>>>>>>>>
41233>>>>>>>>>//DDB-Selection-pkg-End
41233>>>>>>>>>//DDB-FileEnd
41233>>>>>>>Use TOWNS.DD
INCLUDING FILE: TOWNS.DD
41233>>>>>>>>>//DDB-FileStart
41233>>>>>>>>>//DDB-HeaderStart
41233>>>>>>>>>
41233>>>>>>>>>// File Name : TOWNS.DD
41233>>>>>>>>>// Class Name: Towns_DataDictionary
41233>>>>>>>>>// Revision  : 8
41233>>>>>>>>>// Version   : 2
41233>>>>>>>>>
41233>>>>>>>>>Use  Windows           // Basic Definitions
41233>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41233>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41233>>>>>>>>>
41233>>>>>>>>>Open Towns
41235>>>>>>>>>Open Cities
41237>>>>>>>>>Open Country
41239>>>>>>>>>
41239>>>>>>>>>//DDB-HeaderEnd
41239>>>>>>>>>//DDB-SelectionStart
41239>>>>>>>>>//DDB/ ExternalSelectionList sl057  sl057.SL
41239>>>>>>>>>Register_Object sl057
41239>>>>>>>>>//DDB-SelectionEnd
41239>>>>>>>>>
41239>>>>>>>>>Class Towns_DataDictionary  is a DataDictionary_Sec
41240>>>>>>>>>
41240>>>>>>>>>    Procedure Save_Main_File
41241>>>>>>>>>        If (Operation_Origin<>Self) Begin
41243>>>>>>>>>            If Towns.Recnum Eq 0 Procedure_Return
41246>>>>>>>>>        End
41246>>>>>>>>>>
41246>>>>>>>>>        Forward Send Save_Main_File
41248>>>>>>>>>    End_Procedure
41249>>>>>>>>>
41249>>>>>>>>>
41249>>>>>>>>>    // Define_Fields:
41249>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41249>>>>>>>>>
41249>>>>>>>>>    Procedure Define_Fields
41250>>>>>>>>>        Forward Send Define_Fields
41252>>>>>>>>>        //DDB-Generated-Code-Location
41252>>>>>>>>>        //DDB-DefineFieldStart
41252>>>>>>>>>
41252>>>>>>>>>        Set Main_File            To Towns.File_Number
41253>>>>>>>>>        Set Cascade_Delete_State To FALSE
41254>>>>>>>>>
41254>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   to DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41255>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD to DD_NOPUT       DD_FINDREQ    
41256>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    to DD_DISPLAYONLY
41257>>>>>>>>>
41257>>>>>>>>>        // Child (Client) file structure................
41257>>>>>>>>>        Send Add_Client_File  Cities.File_Number
41258>>>>>>>>>
41258>>>>>>>>>        // Parent (Server) file structure...............
41258>>>>>>>>>        Send Add_Server_File  Country.File_Number
41259>>>>>>>>>
41259>>>>>>>>>        // Field-based properties.......................
41259>>>>>>>>>
41259>>>>>>>>>        // Towns.Country_Id
41259>>>>>>>>>        Set Key_Field_State        Field Towns.Country_Id To TRUE
41260>>>>>>>>>
41260>>>>>>>>>        // Towns.Town_Id
41260>>>>>>>>>        Set Field_Options          Field Towns.Town_Id To DD_AUTOFIND   
41261>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Id To (sl057(Self))
41262>>>>>>>>>
41262>>>>>>>>>        // Towns.Town_Descr
41262>>>>>>>>>        Set Field_Prompt_Object    Field Towns.Town_Descr To (sl057(Self))
41263>>>>>>>>>
41263>>>>>>>>>        //DDB-DefineFieldEnd
41263>>>>>>>>>    End_Procedure    // Define_Fields
41264>>>>>>>>>
41264>>>>>>>>>    // Field_Defaults:
41264>>>>>>>>>    // This procedure is used to establish default field values.
41264>>>>>>>>>
41264>>>>>>>>>    Procedure Field_Defaults
41265>>>>>>>>>        Forward Send Field_Defaults
41267>>>>>>>>>        //DDB-Generated-Code-Location
41267>>>>>>>>>        //DDB-FieldDefaultStart
41267>>>>>>>>>        //DDB-FieldDefaultEnd
41267>>>>>>>>>    End_Procedure    // Field_Defaults
41268>>>>>>>>>
41268>>>>>>>>>End_Class    // Towns_DataDictionary
41269>>>>>>>>>//DDB-Selection-pkg-Start
41269>>>>>>>>>
41269>>>>>>>>>Use sl057.SL         // sl057
INCLUDING FILE: SL057.SL
41269>>>>>>>>>>>//AB/ Project sl057 : Towns -Nomoi - Eyr Perioxes
41269>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41269>>>>>>>>>>>//AB/         Set ProjectName to "sl057 : Towns -Nomoi - Eyr Perioxes"
41269>>>>>>>>>>>//AB/         Set ProjectFileName to "sl057.SL"
41269>>>>>>>>>>>
41269>>>>>>>>>>>// Project Object Structure
41269>>>>>>>>>>>//   sl057 is a dbModalPanelSub
41269>>>>>>>>>>>//     Country_DD is a DataDictionary
41269>>>>>>>>>>>//     Towns_DD is a DataDictionary
41269>>>>>>>>>>>//     oSelList is a dbListSub
41269>>>>>>>>>>>//     oOK_bn is a ButtonSub
41269>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41269>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41269>>>>>>>>>>>
41269>>>>>>>>>>>// Register all objects
41269>>>>>>>>>>>Register_Object Country_DD
41269>>>>>>>>>>>Register_Object oCancel_bn
41269>>>>>>>>>>>Register_Object oOK_bn
41269>>>>>>>>>>>Register_Object oSearch_bn
41269>>>>>>>>>>>Register_Object oSelList
41269>>>>>>>>>>>Register_Object sl057
41269>>>>>>>>>>>Register_Object Towns_DD
41269>>>>>>>>>>>
41269>>>>>>>>>>>
41269>>>>>>>>>>>    //AB-IgnoreStart
41269>>>>>>>>>>>
41269>>>>>>>>>>>    Use DFAllEnt.pkg
41269>>>>>>>>>>>    Use dbList.Sub
41269>>>>>>>>>>>    Use Button.Sub
41269>>>>>>>>>>>
41269>>>>>>>>>>>
41269>>>>>>>>>>>    Use COUNTRY.DD
41269>>>>>>>>>>>    Use TOWNS.DD
41269>>>>>>>>>>>    
41269>>>>>>>>>>>    //AB-IgnoreEnd
41269>>>>>>>>>>>
41269>>>>>>>>>>>    Object sl057 is a dbModalPanelSub
41271>>>>>>>>>>>        Set Label to "Œ¦£¦å - „¬¨ç«œ¨œª §œ¨ ¦®âª"
41272>>>>>>>>>>>        Set Size to 148 297
41273>>>>>>>>>>>        Set Location to 6 10
41274>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41275>>>>>>>>>>>        Set Modal_State to FALSE
41276>>>>>>>>>>>
41276>>>>>>>>>>>        //AB-DDOStart
41276>>>>>>>>>>>
41276>>>>>>>>>>>        Object Country_DD is a Country_DataDictionary
41278>>>>>>>>>>>        End_Object    // Country_DD
41279>>>>>>>>>>>
41279>>>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
41281>>>>>>>>>>>            Set DDO_Server to (Country_DD(self))
41282>>>>>>>>>>>        End_Object    // Towns_DD
41283>>>>>>>>>>>
41283>>>>>>>>>>>        Set Main_DD to (Towns_DD(self))
41284>>>>>>>>>>>        Set Server to (Towns_DD(self))
41285>>>>>>>>>>>
41285>>>>>>>>>>>        //AB-DDOEnd
41285>>>>>>>>>>>
41285>>>>>>>>>>>        Object oSelList is a dbListSub
41287>>>>>>>>>>>            Set Main_File to Towns.File_Number
41288>>>>>>>>>>>            Set Size to 105 280
41289>>>>>>>>>>>            Set Location to 6 6
41290>>>>>>>>>>>
41290>>>>>>>>>>>            Begin_Row
41293>>>>>>>>>>>                Entry_Item Towns.Town_id
41294>>>>>>>>>>>                Entry_Item Towns.Town_descr
41295>>>>>>>>>>>                Entry_Item Country.Country_descr
41296>>>>>>>>>>>            End_Row
41301>>>>>>>>>>>
41301>>>>>>>>>>>            Set Form_Width    item 0 to 43
41302>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›"
41303>>>>>>>>>>>            
41303>>>>>>>>>>>            Set Form_Width    item 1 to 137
41304>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41305>>>>>>>>>>>            
41305>>>>>>>>>>>            Set Form_Width    item 2 to 94
41306>>>>>>>>>>>            Set Header_Label  item 2 to "•é¨˜"
41307>>>>>>>>>>>            
41307>>>>>>>>>>>        End_Object    // oSelList
41308>>>>>>>>>>>
41308>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41310>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41311>>>>>>>>>>>            Set Location to 115 126
41312>>>>>>>>>>>
41312>>>>>>>>>>>            //AB-StoreStart
41312>>>>>>>>>>>            Procedure OnClick
41314>>>>>>>>>>>                Send OK To (oSelList(current_object))
41315>>>>>>>>>>>            End_Procedure
41316>>>>>>>>>>>            //AB-StoreEnd
41316>>>>>>>>>>>
41316>>>>>>>>>>>        End_Object    // oOK_bn
41317>>>>>>>>>>>
41317>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41319>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41320>>>>>>>>>>>            Set Location to 115 181
41321>>>>>>>>>>>
41321>>>>>>>>>>>            //AB-StoreStart
41321>>>>>>>>>>>            Procedure OnClick
41323>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41324>>>>>>>>>>>            End_Procedure
41325>>>>>>>>>>>            //AB-StoreEnd
41325>>>>>>>>>>>
41325>>>>>>>>>>>        End_Object    // oCancel_bn
41326>>>>>>>>>>>
41326>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41328>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41329>>>>>>>>>>>            Set Location to 115 236
41330>>>>>>>>>>>
41330>>>>>>>>>>>            //AB-StoreStart
41330>>>>>>>>>>>            Procedure OnClick
41332>>>>>>>>>>>                Send Search To (oSelList(current_object))
41333>>>>>>>>>>>            End_Procedure
41334>>>>>>>>>>>            //AB-StoreEnd
41334>>>>>>>>>>>
41334>>>>>>>>>>>        End_Object    // oSearch_bn
41335>>>>>>>>>>>
41335>>>>>>>>>>>
41335>>>>>>>>>>>        //AB-StoreStart
41335>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41336>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41337>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41338>>>>>>>>>>>        //AB-StoreEnd
41338>>>>>>>>>>>
41338>>>>>>>>>>>    End_Object    // sl057
41339>>>>>>>>>>>
41339>>>>>>>>>>>//AB/     End_Object    // prj
41339>>>>>>>>>
41339>>>>>>>>>//DDB-Selection-pkg-End
41339>>>>>>>>>//DDB-FileEnd
41339>>>>>>>Use CITIES.DD
INCLUDING FILE: CITIES.DD
41339>>>>>>>>>//DDB-FileStart
41339>>>>>>>>>//DDB-HeaderStart
41339>>>>>>>>>
41339>>>>>>>>>// File Name : CITIES.DD
41339>>>>>>>>>// Class Name: Cities_DataDictionary
41339>>>>>>>>>// Revision  : 14
41339>>>>>>>>>// Version   : 2
41339>>>>>>>>>
41339>>>>>>>>>Use  Windows           // Basic Definitions
41339>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41339>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41339>>>>>>>>>
41339>>>>>>>>>Open Cities
41341>>>>>>>>>Open Clients
41343>>>>>>>>>Open Towns
41345>>>>>>>>>
41345>>>>>>>>>//DDB-HeaderEnd
41345>>>>>>>>>//DDB-SelectionStart
41345>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.SL
41345>>>>>>>>>Register_Object sl198
41345>>>>>>>>>//DDB-SelectionEnd
41345>>>>>>>>>
41345>>>>>>>>>Class Cities_DataDictionary  is a DataDictionary_Sec
41346>>>>>>>>>
41346>>>>>>>>>    // Define_Fields:
41346>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41346>>>>>>>>>
41346>>>>>>>>>    Procedure Define_Fields
41347>>>>>>>>>        Forward Send Define_Fields
41349>>>>>>>>>        //DDB-Generated-Code-Location
41349>>>>>>>>>        //DDB-DefineFieldStart
41349>>>>>>>>>
41349>>>>>>>>>        Set Main_File            To Cities.File_Number
41350>>>>>>>>>        Set Cascade_Delete_State To FALSE
41351>>>>>>>>>
41351>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41352>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41353>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41354>>>>>>>>>
41354>>>>>>>>>        // Child (Client) file structure................
41354>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41355>>>>>>>>>
41355>>>>>>>>>        // Parent (Server) file structure...............
41355>>>>>>>>>        Send Add_Server_File  Towns.File_Number
41356>>>>>>>>>
41356>>>>>>>>>        // Field-based properties.......................
41356>>>>>>>>>
41356>>>>>>>>>        // Cities.City_Id
41356>>>>>>>>>        Set Field_Options          Field Cities.City_Id To DD_AUTOFIND   
41357>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Id To (sl198(Self))
41358>>>>>>>>>        Set Key_Field_State        Field Cities.City_Id To TRUE
41359>>>>>>>>>
41359>>>>>>>>>        // Cities.City_Descr
41359>>>>>>>>>        Set Field_Prompt_Object    Field Cities.City_Descr To (sl198(Self))
41360>>>>>>>>>
41360>>>>>>>>>        // Cities.Town_Id
41360>>>>>>>>>
41360>>>>>>>>>        //DDB-DefineFieldEnd
41360>>>>>>>>>    End_Procedure    // Define_Fields
41361>>>>>>>>>
41361>>>>>>>>>    // Field_Defaults:
41361>>>>>>>>>    // This procedure is used to establish default field values.
41361>>>>>>>>>
41361>>>>>>>>>    Procedure Field_Defaults
41362>>>>>>>>>        Forward Send Field_Defaults
41364>>>>>>>>>        //DDB-Generated-Code-Location
41364>>>>>>>>>        //DDB-FieldDefaultStart
41364>>>>>>>>>        //DDB-FieldDefaultEnd
41364>>>>>>>>>    End_Procedure    // Field_Defaults
41365>>>>>>>>>
41365>>>>>>>>>End_Class    // Cities_DataDictionary
41366>>>>>>>>>//DDB-Selection-pkg-Start
41366>>>>>>>>>
41366>>>>>>>>>Use sl198.SL         // sl198
INCLUDING FILE: SL198.SL
41366>>>>>>>>>>>//AB/ Project sl198:cities
41366>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41366>>>>>>>>>>>//AB/     Set ProjectName to "sl198:cities"
41366>>>>>>>>>>>//AB/     Set ProjectFileName to "sl198.SL"
41366>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41366>>>>>>>>>>>
41366>>>>>>>>>>>// Project Object Structure
41366>>>>>>>>>>>//   sl198 is a dbModalPanelSub
41366>>>>>>>>>>>//     Cities_DD is a DataDictionary
41366>>>>>>>>>>>//     oSelList is a dbListSub
41366>>>>>>>>>>>//     oOK_bn is a ButtonSub
41366>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41366>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41366>>>>>>>>>>>
41366>>>>>>>>>>>// Register all objects
41366>>>>>>>>>>>Register_Object Cities_DD
41366>>>>>>>>>>>Register_Object oCancel_bn
41366>>>>>>>>>>>Register_Object oOK_bn
41366>>>>>>>>>>>Register_Object oSearch_bn
41366>>>>>>>>>>>Register_Object oSelList
41366>>>>>>>>>>>Register_Object sl198
41366>>>>>>>>>>>
41366>>>>>>>>>>>
41366>>>>>>>>>>>//AB-IgnoreStart
41366>>>>>>>>>>>
41366>>>>>>>>>>>Use DFAllEnt.pkg
41366>>>>>>>>>>>Use dbList.Sub
41366>>>>>>>>>>>Use Button.Sub
41366>>>>>>>>>>>
41366>>>>>>>>>>>
41366>>>>>>>>>>>Use CITIES.DD
41366>>>>>>>>>>>
41366>>>>>>>>>>>//AB-IgnoreEnd
41366>>>>>>>>>>>
41366>>>>>>>>>>>Object sl198 is a dbModalPanelSub
41368>>>>>>>>>>>    Set Label to "€¨®œå¦ æ¢œà¤"
41369>>>>>>>>>>>    Set Size to 148 297
41370>>>>>>>>>>>    Set Location to 4 5
41371>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41372>>>>>>>>>>>    Set Modal_State to FALSE
41373>>>>>>>>>>>
41373>>>>>>>>>>>    //AB-DDOStart
41373>>>>>>>>>>>
41373>>>>>>>>>>>    Object Cities_DD is a Cities_DataDictionary
41375>>>>>>>>>>>
41375>>>>>>>>>>>        //AB-StoreStart
41375>>>>>>>>>>>                
41375>>>>>>>>>>>                
41375>>>>>>>>>>>        //AB-StoreEnd
41375>>>>>>>>>>>
41375>>>>>>>>>>>    End_Object    // Cities_DD
41376>>>>>>>>>>>
41376>>>>>>>>>>>    Set Main_DD to (Cities_DD(self))
41377>>>>>>>>>>>    Set Server to (Cities_DD(self))
41378>>>>>>>>>>>
41378>>>>>>>>>>>    //AB-DDOEnd
41378>>>>>>>>>>>
41378>>>>>>>>>>>    Object oSelList is a dbListSub
41380>>>>>>>>>>>        Set Main_File to Cities.File_Number
41381>>>>>>>>>>>        Set Size to 105 280
41382>>>>>>>>>>>        Set Location to 6 6
41383>>>>>>>>>>>
41383>>>>>>>>>>>        Begin_Row
41386>>>>>>>>>>>            Entry_Item Cities.City_id
41387>>>>>>>>>>>            Entry_Item Cities.City_descr
41388>>>>>>>>>>>        End_Row
41393>>>>>>>>>>>
41393>>>>>>>>>>>        Set Form_Width    item 0 to 50
41394>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41395>>>>>>>>>>>        
41395>>>>>>>>>>>        Set Form_Width    item 1 to 221
41396>>>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
41397>>>>>>>>>>>        
41397>>>>>>>>>>>
41397>>>>>>>>>>>        //AB-StoreStart
41397>>>>>>>>>>>        
41397>>>>>>>>>>>        Set Column_Option Item 0 to NoEnter True
41398>>>>>>>>>>>        
41398>>>>>>>>>>>        
41398>>>>>>>>>>>        
41398>>>>>>>>>>>        
41398>>>>>>>>>>>        
41398>>>>>>>>>>>        //AB-StoreEnd
41398>>>>>>>>>>>
41398>>>>>>>>>>>    End_Object    // oSelList
41399>>>>>>>>>>>
41399>>>>>>>>>>>    Object oOK_bn is a ButtonSub
41401>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41402>>>>>>>>>>>        Set Location to 115 126
41403>>>>>>>>>>>
41403>>>>>>>>>>>        //AB-StoreStart
41403>>>>>>>>>>>        Procedure OnClick
41405>>>>>>>>>>>            Send OK To (oSelList(current_object))
41406>>>>>>>>>>>        End_Procedure
41407>>>>>>>>>>>        //AB-StoreEnd
41407>>>>>>>>>>>
41407>>>>>>>>>>>    End_Object    // oOK_bn
41408>>>>>>>>>>>
41408>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
41410>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41411>>>>>>>>>>>        Set Location to 115 181
41412>>>>>>>>>>>
41412>>>>>>>>>>>        //AB-StoreStart
41412>>>>>>>>>>>        Procedure OnClick
41414>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41415>>>>>>>>>>>        End_Procedure
41416>>>>>>>>>>>        //AB-StoreEnd
41416>>>>>>>>>>>
41416>>>>>>>>>>>    End_Object    // oCancel_bn
41417>>>>>>>>>>>
41417>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
41419>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
41420>>>>>>>>>>>        Set Location to 115 236
41421>>>>>>>>>>>
41421>>>>>>>>>>>        //AB-StoreStart
41421>>>>>>>>>>>        Procedure OnClick
41423>>>>>>>>>>>            Send Search To (oSelList(current_object))
41424>>>>>>>>>>>        End_Procedure
41425>>>>>>>>>>>        //AB-StoreEnd
41425>>>>>>>>>>>
41425>>>>>>>>>>>    End_Object    // oSearch_bn
41426>>>>>>>>>>>
41426>>>>>>>>>>>
41426>>>>>>>>>>>    //AB-StoreStart
41426>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41427>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41428>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41429>>>>>>>>>>>    //AB-StoreEnd
41429>>>>>>>>>>>
41429>>>>>>>>>>>End_Object    // sl198
41430>>>>>>>>>>>
41430>>>>>>>>>>>//AB/ End_Object    // prj
41430>>>>>>>>>
41430>>>>>>>>>//DDB-Selection-pkg-End
41430>>>>>>>>>//DDB-FileEnd
41430>>>>>>>Use AREAS.DD
INCLUDING FILE: AREAS.DD
41430>>>>>>>>>//DDB-FileStart
41430>>>>>>>>>//DDB-HeaderStart
41430>>>>>>>>>
41430>>>>>>>>>// File Name : AREAS.DD
41430>>>>>>>>>// Class Name: Areas_DataDictionary
41430>>>>>>>>>// Revision  : 8
41430>>>>>>>>>// Version   : 2
41430>>>>>>>>>
41430>>>>>>>>>Use  Windows           // Basic Definitions
41430>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41430>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41430>>>>>>>>>
41430>>>>>>>>>Open Areas
41432>>>>>>>>>Open Clients
41434>>>>>>>>>
41434>>>>>>>>>//DDB-HeaderEnd
41434>>>>>>>>>//DDB-SelectionStart
41434>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41434>>>>>>>>>Register_Object sl197
41434>>>>>>>>>//DDB-SelectionEnd
41434>>>>>>>>>
41434>>>>>>>>>Class Areas_DataDictionary  is a DataDictionary_Sec
41435>>>>>>>>>
41435>>>>>>>>>    // Define_Fields:
41435>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41435>>>>>>>>>
41435>>>>>>>>>    Procedure Define_Fields
41436>>>>>>>>>        Forward Send Define_Fields
41438>>>>>>>>>        //DDB-Generated-Code-Location
41438>>>>>>>>>        //DDB-DefineFieldStart
41438>>>>>>>>>
41438>>>>>>>>>        Set Main_File            To Areas.File_Number
41439>>>>>>>>>        Set Cascade_Delete_State To FALSE
41440>>>>>>>>>
41440>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41441>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41442>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41443>>>>>>>>>
41443>>>>>>>>>        // Child (Client) file structure................
41443>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41444>>>>>>>>>
41444>>>>>>>>>        // Field-based properties.......................
41444>>>>>>>>>
41444>>>>>>>>>        // Areas.Area_Id
41444>>>>>>>>>        Set Field_Options          Field Areas.Area_Id To DD_AUTOFIND   
41445>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Id To (sl197(Self))
41446>>>>>>>>>
41446>>>>>>>>>        // Areas.Area_Descr
41446>>>>>>>>>        Set Field_Prompt_Object    Field Areas.Area_Descr To (sl197(Self))
41447>>>>>>>>>
41447>>>>>>>>>        // Areas.Area_Site
41447>>>>>>>>>
41447>>>>>>>>>        //DDB-DefineFieldEnd
41447>>>>>>>>>    End_Procedure    // Define_Fields
41448>>>>>>>>>
41448>>>>>>>>>    // Field_Defaults:
41448>>>>>>>>>    // This procedure is used to establish default field values.
41448>>>>>>>>>
41448>>>>>>>>>    Procedure Field_Defaults
41449>>>>>>>>>        Forward Send Field_Defaults
41451>>>>>>>>>        //DDB-Generated-Code-Location
41451>>>>>>>>>        //DDB-FieldDefaultStart
41451>>>>>>>>>        //DDB-FieldDefaultEnd
41451>>>>>>>>>    End_Procedure    // Field_Defaults
41452>>>>>>>>>
41452>>>>>>>>>End_Class    // Areas_DataDictionary
41453>>>>>>>>>//DDB-Selection-pkg-Start
41453>>>>>>>>>
41453>>>>>>>>>Use sl197.SL         // sl197
INCLUDING FILE: SL197.SL
41453>>>>>>>>>>>//AB/ Project sl197:areas
41453>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
41453>>>>>>>>>>>//AB/         Set ProjectName to "sl197:areas"
41453>>>>>>>>>>>//AB/         Set ProjectFileName to "sl197.SL"
41453>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
41453>>>>>>>>>>>
41453>>>>>>>>>>>// Project Object Structure
41453>>>>>>>>>>>//   sl197 is a dbModalPanelSub
41453>>>>>>>>>>>//     Areas_DD is a DataDictionary
41453>>>>>>>>>>>//     oSelList is a dbListSub
41453>>>>>>>>>>>//     oOK_bn is a ButtonSub
41453>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41453>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41453>>>>>>>>>>>
41453>>>>>>>>>>>// Register all objects
41453>>>>>>>>>>>Register_Object Areas_DD
41453>>>>>>>>>>>Register_Object oCancel_bn
41453>>>>>>>>>>>Register_Object oOK_bn
41453>>>>>>>>>>>Register_Object oSearch_bn
41453>>>>>>>>>>>Register_Object oSelList
41453>>>>>>>>>>>Register_Object sl197
41453>>>>>>>>>>>
41453>>>>>>>>>>>
41453>>>>>>>>>>>    //AB-IgnoreStart
41453>>>>>>>>>>>
41453>>>>>>>>>>>    Use DFAllEnt.pkg
41453>>>>>>>>>>>    Use dbList.Sub
41453>>>>>>>>>>>    Use Button.Sub
41453>>>>>>>>>>>
41453>>>>>>>>>>>
41453>>>>>>>>>>>    Use AREAS.DD
41453>>>>>>>>>>>    
41453>>>>>>>>>>>    //AB-IgnoreEnd
41453>>>>>>>>>>>
41453>>>>>>>>>>>    Object sl197 is a dbModalPanelSub
41455>>>>>>>>>>>
41455>>>>>>>>>>>        //AB-StoreTopStart
41455>>>>>>>>>>>                    
41455>>>>>>>>>>>        //AB-StoreTopEnd
41455>>>>>>>>>>>
41455>>>>>>>>>>>        Set Label to "€¨®œå¦ œ¨ ¦®é¤"
41456>>>>>>>>>>>        Set Size to 148 297
41457>>>>>>>>>>>        Set Location to 4 5
41458>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
41459>>>>>>>>>>>        Set Modal_State to FALSE
41460>>>>>>>>>>>
41460>>>>>>>>>>>        //AB-DDOStart
41460>>>>>>>>>>>
41460>>>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
41462>>>>>>>>>>>
41462>>>>>>>>>>>            //AB-StoreStart
41462>>>>>>>>>>>                                    
41462>>>>>>>>>>>            //AB-StoreEnd
41462>>>>>>>>>>>
41462>>>>>>>>>>>        End_Object    // Areas_DD
41463>>>>>>>>>>>
41463>>>>>>>>>>>        Set Main_DD to (Areas_DD(self))
41464>>>>>>>>>>>        Set Server to (Areas_DD(self))
41465>>>>>>>>>>>
41465>>>>>>>>>>>        //AB-DDOEnd
41465>>>>>>>>>>>
41465>>>>>>>>>>>        Object oSelList is a dbListSub
41467>>>>>>>>>>>            Set Main_File to Areas.File_Number
41468>>>>>>>>>>>            Set Ordering to 2
41469>>>>>>>>>>>            Set Size to 105 280
41470>>>>>>>>>>>            Set Location to 5 5
41471>>>>>>>>>>>            Set Export_Item_State to TRUE
41472>>>>>>>>>>>
41472>>>>>>>>>>>            Begin_Row
41475>>>>>>>>>>>                Entry_Item Areas.Area_id
41476>>>>>>>>>>>                Entry_Item Areas.Area_descr
41477>>>>>>>>>>>                Entry_Item Areas.Area_site
41478>>>>>>>>>>>            End_Row
41483>>>>>>>>>>>
41483>>>>>>>>>>>            Set Form_Width    item 0 to 45
41484>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
41485>>>>>>>>>>>            
41485>>>>>>>>>>>            Set Form_Width    item 1 to 192
41486>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
41487>>>>>>>>>>>            
41487>>>>>>>>>>>            Set Form_Width    item 2 to 35
41488>>>>>>>>>>>            Set Header_Label  item 2 to "’¦£â˜ª"
41489>>>>>>>>>>>            
41489>>>>>>>>>>>
41489>>>>>>>>>>>            //AB-StoreStart
41489>>>>>>>>>>>            
41489>>>>>>>>>>>            Set Column_Option Item 0 to NoEnter True
41490>>>>>>>>>>>            
41490>>>>>>>>>>>            
41490>>>>>>>>>>>            //AB-StoreEnd
41490>>>>>>>>>>>
41490>>>>>>>>>>>        End_Object    // oSelList
41491>>>>>>>>>>>
41491>>>>>>>>>>>        Object oOK_bn is a ButtonSub
41493>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
41494>>>>>>>>>>>            Set Location to 115 126
41495>>>>>>>>>>>
41495>>>>>>>>>>>            //AB-StoreStart
41495>>>>>>>>>>>            Procedure OnClick
41497>>>>>>>>>>>                Send OK To (oSelList(current_object))
41498>>>>>>>>>>>            End_Procedure
41499>>>>>>>>>>>            //AB-StoreEnd
41499>>>>>>>>>>>
41499>>>>>>>>>>>        End_Object    // oOK_bn
41500>>>>>>>>>>>
41500>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
41502>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
41503>>>>>>>>>>>            Set Location to 115 181
41504>>>>>>>>>>>
41504>>>>>>>>>>>            //AB-StoreStart
41504>>>>>>>>>>>            Procedure OnClick
41506>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
41507>>>>>>>>>>>            End_Procedure
41508>>>>>>>>>>>            //AB-StoreEnd
41508>>>>>>>>>>>
41508>>>>>>>>>>>        End_Object    // oCancel_bn
41509>>>>>>>>>>>
41509>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
41511>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41512>>>>>>>>>>>            Set Location to 115 236
41513>>>>>>>>>>>
41513>>>>>>>>>>>            //AB-StoreStart
41513>>>>>>>>>>>            Procedure OnClick
41515>>>>>>>>>>>                Send Search To (oSelList(current_object))
41516>>>>>>>>>>>            End_Procedure
41517>>>>>>>>>>>            //AB-StoreEnd
41517>>>>>>>>>>>
41517>>>>>>>>>>>        End_Object    // oSearch_bn
41518>>>>>>>>>>>
41518>>>>>>>>>>>
41518>>>>>>>>>>>        //AB-StoreStart
41518>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41519>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41520>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41521>>>>>>>>>>>        
41521>>>>>>>>>>>        
41521>>>>>>>>>>>        
41521>>>>>>>>>>>        
41521>>>>>>>>>>>        
41521>>>>>>>>>>>        //AB-StoreEnd
41521>>>>>>>>>>>
41521>>>>>>>>>>>    End_Object    // sl197
41522>>>>>>>>>>>
41522>>>>>>>>>>>//AB/     End_Object    // prj
41522>>>>>>>>>
41522>>>>>>>>>//DDB-Selection-pkg-End
41522>>>>>>>>>//DDB-FileEnd
41522>>>>>>>Use PAYRESP.DD
INCLUDING FILE: PAYRESP.DD
41522>>>>>>>>>//DDB-FileStart
41522>>>>>>>>>//DDB-HeaderStart
41522>>>>>>>>>
41522>>>>>>>>>// File Name : PAYRESP.DD
41522>>>>>>>>>// Class Name: Payresp_DataDictionary
41522>>>>>>>>>// Revision  : 82
41522>>>>>>>>>// Version   : 2
41522>>>>>>>>>
41522>>>>>>>>>Use  Windows           // Basic Definitions
41522>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41522>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41522>>>>>>>>>
41522>>>>>>>>>Open Payresp
41524>>>>>>>>>Open Prspbank
INCLUDING FILE: PRSPBANK.FD
41526>>>>>>>>>Open Tppresp
INCLUDING FILE: TPPRESP.FD
41528>>>>>>>>>Open Clients
41530>>>>>>>>>Open Sysrecc
41532>>>>>>>>>Open Gmove
41534>>>>>>>>>Open Sysrecg
41536>>>>>>>>>
41536>>>>>>>>>//DDB-HeaderEnd
41536>>>>>>>>>//DDB-ValidationStart
41536>>>>>>>>>
41536>>>>>>>>>Register_Object Payresp_Presp_Doy_VT
41536>>>>>>>>>Register_Object Payresp_Presp_Categfpa_VT
41536>>>>>>>>>Register_Object Payresp_Feregios_VT
41536>>>>>>>>>
41536>>>>>>>>>Object Payresp_Presp_Doy_VT  is a CodeValidationTable
41538>>>>>>>>>    Set Type_Value        To "DOY"
41539>>>>>>>>>    Set Allow_Blank_State To TRUE
41540>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
41541>>>>>>>>>    //DDB-ValidationCustomStart
41541>>>>>>>>>    //DDB-ValidationCustomEnd
41541>>>>>>>>>End_Object   // Payresp_Presp_Doy_VT
41542>>>>>>>>>
41542>>>>>>>>>Object Payresp_Presp_Categfpa_VT  is a CodeValidationTable
41544>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
41545>>>>>>>>>    Set Validate_State    To FALSE
41546>>>>>>>>>    Set Allow_Blank_State To TRUE
41547>>>>>>>>>    //DDB-ValidationCustomStart
41547>>>>>>>>>    //DDB-ValidationCustomEnd
41547>>>>>>>>>End_Object   // Payresp_Presp_Categfpa_VT
41548>>>>>>>>>
41548>>>>>>>>>Object Payresp_Feregios_VT  is a CodeValidationTable
41550>>>>>>>>>    Set Type_Value        To "FEREGIOS"
41551>>>>>>>>>    Set Allow_Blank_State To TRUE
41552>>>>>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
41553>>>>>>>>>    //DDB-ValidationCustomStart
41553>>>>>>>>>    //DDB-ValidationCustomEnd
41553>>>>>>>>>End_Object   // Payresp_Feregios_VT
41554>>>>>>>>>//DDB-ValidationEnd
41554>>>>>>>>>//DDB-SelectionStart
41554>>>>>>>>>//DDB/ ExternalSelectionList sl111  sl111.SL
41554>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
41554>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
41554>>>>>>>>>Register_Object sl111
41554>>>>>>>>>Register_Object sl198
41554>>>>>>>>>Register_Object sl197
41554>>>>>>>>>//DDB-SelectionEnd
41554>>>>>>>>>
41554>>>>>>>>>Open Year
41556>>>>>>>>>
41556>>>>>>>>>Class Payresp_DataDictionary  is a DataDictionary_Sec
41557>>>>>>>>>
41557>>>>>>>>>    Procedure Construct_Object
41558>>>>>>>>>        Forward Send Construct_Object
41560>>>>>>>>>        Property Integer piCheckPlaf        Public 0
41561>>>>>>>>>        //------------------------------------------------
41561>>>>>>>>>        // Properties gia na kraththoun oi palies times
41561>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
41561>>>>>>>>>        // einai 1     js 03/12/2007
41561>>>>>>>>>        //------------------------------------------------
41561>>>>>>>>>        Property Integer piCreateNew            Public  0
41562>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
41563>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
41564>>>>>>>>>        Property String  psAud_Old_AFM          Public ""
41565>>>>>>>>>        Property String  psAud_Old_DOY          Public ""
41566>>>>>>>>>        Property String  psAud_Old_DOYN         Public ""
41567>>>>>>>>>        Property Integer piAud_Old_HPAL         Public  0
41568>>>>>>>>>        Property Integer piAud_Old_HPSO         Public  0
41569>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
41570>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
41571>>>>>>>>>        //------------------------------------------------
41571>>>>>>>>>
41571>>>>>>>>>    End_procedure
41572>>>>>>>>>
41572>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
41573>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
41575>>>>>>>>>        //------------------------------------------------
41575>>>>>>>>>        // Properties gia na kraththoun oi palies times
41575>>>>>>>>>        // ton pedion js 03/12/2007
41575>>>>>>>>>        //------------------------------------------------
41575>>>>>>>>>        Set psAud_Old_Pelaths      to Payresp.Presp_ID
41576>>>>>>>>>        Set psAud_Old_PelathsN     to Payresp.Presp_Name
41577>>>>>>>>>        Set psAud_Old_AFM          to Payresp.Presp_AFM
41578>>>>>>>>>        Set psAud_Old_DOY          to Payresp.Presp_Doy
41579>>>>>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Payresp.Presp_Doy))
41580>>>>>>>>>        Set piAud_Old_HPAL         to Payresp.Stoxos_IPAL
41581>>>>>>>>>        Set piAud_Old_HPSO         to Payresp.Stoxos_IPSO
41582>>>>>>>>>        Set psAud_Old_PartlRecr    to Payresp.Presp_Recr
41583>>>>>>>>>        Set psAud_Old_PmsRecr      to Payresp.Presp_Recr
41584>>>>>>>>>        //------------------------------------------------
41584>>>>>>>>>     End_Procedure   // New_Current_Record
41585>>>>>>>>>
41585>>>>>>>>>    Procedure Delete_Main_File
41586>>>>>>>>>        //---------------------------------------------
41586>>>>>>>>>        // Auditing / Katagrafh allagon
41586>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41587>>>>>>>>>        Date    dDate  Shmer
41587>>>>>>>>>        Integer iMin iHour iSec iLen
41587>>>>>>>>>        Sysdate dDate iHour iMin iSec
41591>>>>>>>>>        Move iHour  to sHour
41592>>>>>>>>>        Move iMin   to sMin
41593>>>>>>>>>        Move iSec   to sSec
41594>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41598>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41602>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41606>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41607>>>>>>>>>
41607>>>>>>>>>        // Auditing / Diagrafh
41607>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
41609>>>>>>>>>            Get fsLoginUserID to sUser
41610>>>>>>>>>            clear gmove
41611>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
41612>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
41613>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
41614>>>>>>>>>            move  3                     to gmove.gtypkin_code// Apo Clients
41615>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
41616>>>>>>>>>            move suser                  to gmove.gplan_code
41617>>>>>>>>>            move Payresp.Presp_Recr    to gmove.garticl_recr
41618>>>>>>>>>            reread sysrecg
41622>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41623>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41624>>>>>>>>>            saverecord sysrecg
41625>>>>>>>>>            unlock
41626>>>>>>>>>>
41626>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
41627>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
41628>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
41629>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
41630>>>>>>>>>
41630>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41631>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41632>>>>>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
41633>>>>>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
41634>>>>>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
41635>>>>>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
41636>>>>>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
41637>>>>>>>>>
41637>>>>>>>>>
41637>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"     to gmove.gmove_aitiol
41638>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
41639>>>>>>>>>            saverecord gmove
41640>>>>>>>>>        End
41640>>>>>>>>>>
41640>>>>>>>>>        Forward Send Delete_Main_File
41642>>>>>>>>>
41642>>>>>>>>>    End_Procedure
41643>>>>>>>>>
41643>>>>>>>>>    Procedure Update
41644>>>>>>>>>        Forward Send Update
41646>>>>>>>>>        Move SysCurXR.Company_Code  to payresp.Company_Code
41647>>>>>>>>>        Move SysCurXR.Branch_Code   to payresp.Branch_Code
41648>>>>>>>>>        Move SysCurXR.Year_Year     to payresp.Year_Year
41649>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
41649>>>>>>>>>        Move (payresp.Xreosh-payresp.Pistosh)   to payresp.Ypoloipo
41650>>>>>>>>>        Move (payresp.Plafon-payresp.ypoloipo)  to payresp.Overhead
41651>>>>>>>>>
41651>>>>>>>>>        //betolink
41651>>>>>>>>>        Move SysCurXR.Beto_Site      to payresp.presp_SiteW
41652>>>>>>>>>        Move payresp.presp_Rec0      to payresp.presp_SN
41653>>>>>>>>>        Move payresp.presp_id        to payresp.presp_Repm
41654>>>>>>>>>
41654>>>>>>>>>        //---------------------------------------------
41654>>>>>>>>>        // Auditing / Katagrafh allagon
41654>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
41655>>>>>>>>>        Date    dDate  Shmer
41655>>>>>>>>>        Integer iMin iHour iSec iLen
41655>>>>>>>>>        Sysdate dDate iHour iMin iSec
41659>>>>>>>>>        Move iHour  to sHour
41660>>>>>>>>>        Move iMin   to sMin
41661>>>>>>>>>        Move iSec   to sSec
41662>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
41666>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
41670>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
41674>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
41675>>>>>>>>>
41675>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
41675>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
41677>>>>>>>>>            Get fsLoginUserID to sUser
41678>>>>>>>>>            If (piCreateNew(Self)=1) Begin
41680>>>>>>>>>                clear gmove
41681>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
41682>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
41683>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
41684>>>>>>>>>                move  3                     to gmove.gtypkin_code// Apo Clients
41685>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
41686>>>>>>>>>                move suser                  to gmove.gplan_code
41687>>>>>>>>>                move Payresp.Presp_Recr     to gmove.garticl_recr
41688>>>>>>>>>                reread sysrecg
41692>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41693>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41694>>>>>>>>>                saverecord sysrecg
41695>>>>>>>>>                unlock
41696>>>>>>>>>>
41696>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
41697>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
41698>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
41699>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
41700>>>>>>>>>                Move Payresp.Presp_ID               to Gmove.Cur_ID
41701>>>>>>>>>                Move Payresp.Presp_Name             to Gmove.Cur_Name
41702>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
41703>>>>>>>>>                Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
41704>>>>>>>>>                Move Payresp.Presp_AFM              to Gmove.Cur_AFM
41705>>>>>>>>>                Move Payresp.Presp_DOY              to Gmove.Cur_DOY
41706>>>>>>>>>                Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
41707>>>>>>>>>                Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
41708>>>>>>>>>                Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
41709>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤" to Gmove.Gmove_Aitiol
41710>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
41711>>>>>>>>>                saverecord gmove
41712>>>>>>>>>                Set piCreateNew to 0
41713>>>>>>>>>            End
41713>>>>>>>>>>
41713>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
41716>>>>>>>>>                Integer isChanged
41716>>>>>>>>>                Move 0 to isChanged
41717>>>>>>>>>                
41717>>>>>>>>>                     If (psAud_Old_Pelaths  (Self)<>Payresp.Presp_ID   ) Move 1 to isChanged
41720>>>>>>>>>                Else If (psAud_Old_PelathsN (Self)<>Payresp.Presp_Name ) Move 1 to isChanged
41724>>>>>>>>>                Else If (psAud_Old_AFM      (Self)<>Payresp.Presp_AFM  ) Move 1 to isChanged
41728>>>>>>>>>                Else If (psAud_Old_DOY      (Self)<>Payresp.Presp_DOY  ) Move 1 to isChanged
41732>>>>>>>>>                Else If (piAud_Old_HPAL     (Self)<>Payresp.Stoxos_IPAL) Move 1 to isChanged
41736>>>>>>>>>                Else If (piAud_Old_HPSO     (Self)<>Payresp.Stoxos_IPSO) Move 1 to isChanged
41740>>>>>>>>>                
41740>>>>>>>>>                If (isChanged>0) Begin  
41742>>>>>>>>>                    clear gmove
41743>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
41744>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
41745>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
41746>>>>>>>>>                    move  3                     to gmove.gtypkin_code// Apo Clients
41747>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
41748>>>>>>>>>                    move suser                  to gmove.gplan_code
41749>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
41750>>>>>>>>>                    reread sysrecg
41754>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
41755>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
41756>>>>>>>>>                    saverecord sysrecg
41757>>>>>>>>>                    unlock
41758>>>>>>>>>>
41758>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
41759>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
41760>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
41761>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
41762>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Partl_Recr 
41763>>>>>>>>>                    Move Payresp.Presp_Recr             to Gmove.Pms_Recr          
41764>>>>>>>>>                    //--
41764>>>>>>>>>                    Move Payresp.Presp_ID               to Gmove.Cur_ID
41765>>>>>>>>>                    Move Payresp.Presp_Name             to Gmove.Cur_Name
41766>>>>>>>>>                    Move Payresp.Presp_AFM              to Gmove.Cur_AFM
41767>>>>>>>>>                    Move Payresp.Presp_DOY              to Gmove.Cur_DOY
41768>>>>>>>>>                    Move (gsfCode_Mast("DOY",Payresp.Presp_Doy)) to Gmove.Txt4
41769>>>>>>>>>                    Move Payresp.Stoxos_IPAL            to Gmove.Prev_Stoxos1
41770>>>>>>>>>                    Move Payresp.Stoxos_IPSO            to Gmove.Prev_Stoxos2
41771>>>>>>>>>                    //--
41771>>>>>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
41772>>>>>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
41773>>>>>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
41774>>>>>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy 
41775>>>>>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
41776>>>>>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
41777>>>>>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
41778>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª “§œ¬Ÿç¤¦¬ ¢ž¨à£é¤"  to gmove.gmove_aitiol
41779>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
41780>>>>>>>>>                    saverecord gmove
41781>>>>>>>>>                    Set piCreateNew to 0
41782>>>>>>>>>                End
41782>>>>>>>>>>
41782>>>>>>>>>            End
41782>>>>>>>>>>
41782>>>>>>>>>        End
41782>>>>>>>>>>
41782>>>>>>>>>
41782>>>>>>>>>    End_Procedure   // Update
41783>>>>>>>>>
41783>>>>>>>>>     Procedure Creating
41784>>>>>>>>>        Forward Send Creating
41786>>>>>>>>>        // Insert Code Here
41786>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(payresp.presp_Rec0))))));                                    to payresp.presp_Recr
41787>>>>>>>>>        Move '1'                    to payresp.presp_Active
41788>>>>>>>>>        get fsgCode_With_Zeroes payresp.presp_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to payresp.presp_ID
41789>>>>>>>>>        clear year
41790>>>>>>>>>        move syscurxr.branch_code   to year.branch_code
41791>>>>>>>>>        move syscurxr.company_code  to year.company_code
41792>>>>>>>>>        move syscurxr.year_year     to YEAR.year_year
41793>>>>>>>>>        find eq year by index.1
41794>>>>>>>>>>
41794>>>>>>>>>        if (found=1) begin
41796>>>>>>>>>            move year.payresp_plafon to payresp.plafon
41797>>>>>>>>>            move year.payresp_ofeilh to payresp.orio_syn_ofeilh
41798>>>>>>>>>        end
41798>>>>>>>>>>
41798>>>>>>>>>        Set piCreateNew to 1
41799>>>>>>>>>    End_Procedure   // Creating
41800>>>>>>>>>
41800>>>>>>>>>   Function Validate_Save  Returns Integer
41801>>>>>>>>>        Integer iReturnVal iCheck iYes
41802>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
41804>>>>>>>>>        If (Not(iReturnVal)) Begin
41806>>>>>>>>>
41806>>>>>>>>>            If (Sysfile.Check_Afm=1) Begin
41808>>>>>>>>>                Move (Check_AFM(payresp.presp_Afm)) to iCheck
41809>>>>>>>>>                If (iCheck) Begin
41811>>>>>>>>>                         If (iCheck=1) Move 4001 to iReturnVal
41814>>>>>>>>>                    Else If (iCheck=2) Move 4002 to iReturnVal
41818>>>>>>>>>                    Else If (iCheck=3) Move 4003 to iReturnVal
41822>>>>>>>>>                End
41822>>>>>>>>>>
41822>>>>>>>>>            End
41822>>>>>>>>>>
41822>>>>>>>>>
41822>>>>>>>>>           If (piCheckPlaf(Self)=1) Begin
41824>>>>>>>>>                If ((PayResp.Plafon>0) And ((PayResp.Ypoloipo+PayResp.Posa_Apo_Dap)>PayResp.Plafon)) Begin
41826>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5000 Payresp'  to iYes
41827>>>>>>>>>                        If (iYes=MBR_NO) Error 4004 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4004 to iReturnVal
41830>>>>>>>>>                End
41830>>>>>>>>>>
41830>>>>>>>>>                Else If ((PayResp.Orio_Syn_Ofeilh>0) And (PayResp.Synolikh_Ofeilh>PayResp.Orio_Syn_Ofeilh)) Begin
41833>>>>>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 5001 Payresp' to iYes
41834>>>>>>>>>                        If (iYes=MBR_NO) Error 4005 'DDC111: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
41837>>>>>>>>>                End
41837>>>>>>>>>>
41837>>>>>>>>>           End
41837>>>>>>>>>>
41837>>>>>>>>>        If (iReturnVal) Send Operation_Not_Allowed iReturnVal
41840>>>>>>>>>        End
41840>>>>>>>>>>
41840>>>>>>>>>        Function_Return iReturnVal
41841>>>>>>>>>    End_Function   // Validate_Save
41842>>>>>>>>>
41842>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
41843>>>>>>>>>        String lsError_Message
41844>>>>>>>>>        Case Begin
41844>>>>>>>>>            Case (iError_Num = 4001)
41846>>>>>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤" to lsError_Message
41847>>>>>>>>>              Case Break
41848>>>>>>>>>            Case (iError_Num = 4002)
41851>>>>>>>>>                Move "DDC 100: ’¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ ›œ¤ œå¤˜  9 ¯ã­ ¦" to lsError_Message
41852>>>>>>>>>              Case Break
41853>>>>>>>>>            Case (iError_Num = 4003)
41856>>>>>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ “§œ¬Ÿ.¢ž¨à£é¤ " to lsError_Message
41857>>>>>>>>>              Case Break
41858>>>>>>>>>            Case (iError_Num = 4004)
41861>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç" to lsError_Message
41862>>>>>>>>>              Case Break
41863>>>>>>>>>            Case (iError_Num = 4005)
41866>>>>>>>>>                Move "DDC 100: „š ¤œ ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" to lsError_Message
41867>>>>>>>>>              Case Break
41868>>>>>>>>>            Case Else
41868>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
41870>>>>>>>>>        Case End
41870>>>>>>>>>        Error iError_Num lsError_Message
41871>>>>>>>>>>
41871>>>>>>>>>    End_Procedure // operation_not_allowed
41872>>>>>>>>>
41872>>>>>>>>>
41872>>>>>>>>>
41872>>>>>>>>>    Procedure Define_Fields
41873>>>>>>>>>        Forward Send Define_Fields
41875>>>>>>>>>        //DDB-Generated-Code-Location
41875>>>>>>>>>        //DDB-DefineFieldStart
41875>>>>>>>>>
41875>>>>>>>>>        Set Main_File            To Payresp.File_Number
41876>>>>>>>>>        Set Cascade_Delete_State To FALSE
41877>>>>>>>>>
41877>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41878>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41879>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41880>>>>>>>>>
41880>>>>>>>>>        // Child (Client) file structure................
41880>>>>>>>>>        Send Add_Client_File  Prspbank.File_Number
41881>>>>>>>>>        Send Add_Client_File  Tppresp.File_Number
41882>>>>>>>>>        Send Add_Client_File  Clients.File_Number
41883>>>>>>>>>
41883>>>>>>>>>        // External (System) file structure.............
41883>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
41884>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
41885>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
41886>>>>>>>>>
41886>>>>>>>>>        Define_Auto_Increment  Sysrecc.Payresp_Rec0  To Payresp.Presp_Rec0
41889>>>>>>>>>
41889>>>>>>>>>        // Field-based properties.......................
41889>>>>>>>>>
41889>>>>>>>>>        // Payresp.Company_Code
41889>>>>>>>>>
41889>>>>>>>>>        // Payresp.Branch_Code
41889>>>>>>>>>
41889>>>>>>>>>        // Payresp.Year_Year
41889>>>>>>>>>
41889>>>>>>>>>        // Payresp.Custprom_Code
41889>>>>>>>>>
41889>>>>>>>>>        // Payresp.Presp_Id
41889>>>>>>>>>        Set Field_Options          Field Payresp.Presp_Id To DD_AUTOFIND    DD_NOPUT      
41890>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Id To (sl111(Self))
41891>>>>>>>>>        Set Key_Field_State        Field Payresp.Presp_Id To TRUE
41892>>>>>>>>>
41892>>>>>>>>>        // Payresp.Presp_Name
41892>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Name To (sl111(Self))
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Presp_Afm
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Presp_Rec0
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Custprom_Recr
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Presp_Recr
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Last_Xreosh
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Last_Pistosh
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Last_Order
41893>>>>>>>>>
41893>>>>>>>>>        // Payresp.Presp_Doy
41893>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Doy To (Payresp_Presp_Doy_VT(Self))
41894>>>>>>>>>
41894>>>>>>>>>        // Payresp.Presp_Address
41894>>>>>>>>>
41894>>>>>>>>>        // Payresp.Presp_City_Id
41894>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_City_Id To (sl198(Self))
41895>>>>>>>>>
41895>>>>>>>>>        // Payresp.Presp_Area
41895>>>>>>>>>        Set Field_Prompt_Object    Field Payresp.Presp_Area To (sl197(Self))
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Job
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Respons
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Zipcode
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Phone
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Fax
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Mobile
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Aoh
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Email
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Class
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Details
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Sitew
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Codem
41896>>>>>>>>>
41896>>>>>>>>>        // Payresp.Presp_Categfpa
41896>>>>>>>>>        Set Field_Value_Table      Field Payresp.Presp_Categfpa To (Payresp_Presp_Categfpa_VT(Self))
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Fpa
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Public
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Sn
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Repm
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Active
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Reported
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Pelprom
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Lastupd
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Markexp
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Catjob
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Is_Promhtheyths
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Xreosh
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Pistosh
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Ypoloipo
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Plafon
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Overhead
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Add_No
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Nomos
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Presp_Xora
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Polh_Recr
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Synolikh_Ofeilh
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Stoxos_Ipal
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Stoxos_Ipso
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Poso_Se_Apait
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Orio_Syn_Ofeilh
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Posa_Apo_Dap
41897>>>>>>>>>
41897>>>>>>>>>        // Payresp.Feregios
41897>>>>>>>>>        Set Field_Value_Table      Field Payresp.Feregios To (Payresp_Feregios_VT(Self))
41898>>>>>>>>>
41898>>>>>>>>>        //DDB-DefineFieldEnd
41898>>>>>>>>>    End_Procedure    // Define_Fields
41899>>>>>>>>>
41899>>>>>>>>>    // Field_Defaults:
41899>>>>>>>>>    // This procedure is used to establish default field values.
41899>>>>>>>>>
41899>>>>>>>>>    Procedure Field_Defaults
41900>>>>>>>>>        Forward Send Field_Defaults
41902>>>>>>>>>        //DDB-Generated-Code-Location
41902>>>>>>>>>        //DDB-FieldDefaultStart
41902>>>>>>>>>        Set Field_Changed_Value   Field Payresp.Presp_Doy To "0"
41903>>>>>>>>>        //DDB-FieldDefaultEnd
41903>>>>>>>>>    End_Procedure    // Field_Defaults
41904>>>>>>>>>
41904>>>>>>>>>End_Class    // Payresp_DataDictionary
41905>>>>>>>>>//DDB-Selection-pkg-Start
41905>>>>>>>>>
41905>>>>>>>>>Use sl111.SL         // sl111
INCLUDING FILE: SL111.SL
41905>>>>>>>>>>>//AB/ Project sl111
41905>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
41905>>>>>>>>>>>//AB/     Set ProjectName to "sl111"
41905>>>>>>>>>>>//AB/     Set ProjectFileName to "sl111.SL"
41905>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
41905>>>>>>>>>>>
41905>>>>>>>>>>>// Project Object Structure
41905>>>>>>>>>>>//   sl111 is a dbModalPanelSub
41905>>>>>>>>>>>//     Payresp_DD is a DataDictionary
41905>>>>>>>>>>>//     oSelList is a dbListSub
41905>>>>>>>>>>>//     oOK_bn is a ButtonSub
41905>>>>>>>>>>>//     oCancel_bn is a ButtonSub
41905>>>>>>>>>>>//     oSearch_bn is a ButtonSub
41905>>>>>>>>>>>
41905>>>>>>>>>>>// Register all objects
41905>>>>>>>>>>>Register_Object oCancel_bn
41905>>>>>>>>>>>Register_Object oOK_bn
41905>>>>>>>>>>>Register_Object oSearch_bn
41905>>>>>>>>>>>Register_Object oSelList
41905>>>>>>>>>>>Register_Object Payresp_DD
41905>>>>>>>>>>>Register_Object sl111
41905>>>>>>>>>>>
41905>>>>>>>>>>>
41905>>>>>>>>>>>//AB-IgnoreStart
41905>>>>>>>>>>>
41905>>>>>>>>>>>Use DFAllEnt.pkg
41905>>>>>>>>>>>Use dbList.Sub
41905>>>>>>>>>>>Use Button.Sub
41905>>>>>>>>>>>
41905>>>>>>>>>>>
41905>>>>>>>>>>>Use PAYRESP.DD
41905>>>>>>>>>>>
41905>>>>>>>>>>>//AB-IgnoreEnd
41905>>>>>>>>>>>
41905>>>>>>>>>>>Object sl111 is a dbModalPanelSub
41907>>>>>>>>>>>    Set Label to "“§œçŸ¬¤¦  ¢ž¨à£é¤ "
41908>>>>>>>>>>>    Set Size to 148 443
41909>>>>>>>>>>>    Set Location to 4 5
41910>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
41911>>>>>>>>>>>    Set Modal_State to FALSE
41912>>>>>>>>>>>
41912>>>>>>>>>>>    //AB-DDOStart
41912>>>>>>>>>>>
41912>>>>>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
41914>>>>>>>>>>>    End_Object    // Payresp_DD
41915>>>>>>>>>>>
41915>>>>>>>>>>>    Set Main_DD to (Payresp_DD(self))
41916>>>>>>>>>>>    Set Server to (Payresp_DD(self))
41917>>>>>>>>>>>
41917>>>>>>>>>>>    //AB-DDOEnd
41917>>>>>>>>>>>
41917>>>>>>>>>>>    Object oSelList is a dbListSub
41919>>>>>>>>>>>        Set Main_File to Payresp.File_Number
41920>>>>>>>>>>>        Set Size to 105 430
41921>>>>>>>>>>>        Set Location to 6 6
41922>>>>>>>>>>>
41922>>>>>>>>>>>        Begin_Row
41925>>>>>>>>>>>            Entry_Item Payresp.Presp_id
41926>>>>>>>>>>>            Entry_Item Payresp.Presp_name
41927>>>>>>>>>>>            Entry_Item Payresp.Presp_afm
41928>>>>>>>>>>>            Entry_Item Payresp.Presp_address
41929>>>>>>>>>>>            Entry_Item Payresp.Presp_phone
41930>>>>>>>>>>>        End_Row
41935>>>>>>>>>>>
41935>>>>>>>>>>>        Set Form_Width    item 0 to 60
41936>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41937>>>>>>>>>>>        
41937>>>>>>>>>>>        Set Form_Width    item 1 to 106
41938>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
41939>>>>>>>>>>>        
41939>>>>>>>>>>>        Set Form_Width    item 2 to 60
41940>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
41941>>>>>>>>>>>        
41941>>>>>>>>>>>        Set Form_Width    item 3 to 135
41942>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
41943>>>>>>>>>>>        
41943>>>>>>>>>>>        Set Form_Width    item 4 to 60
41944>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
41945>>>>>>>>>>>        
41945>>>>>>>>>>>    End_Object    // oSelList
41946>>>>>>>>>>>
41946>>>>>>>>>>>    Object oOK_bn is a ButtonSub
41948>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
41949>>>>>>>>>>>        Set Location to 113 277
41950>>>>>>>>>>>
41950>>>>>>>>>>>        //AB-StoreStart
41950>>>>>>>>>>>        Procedure OnClick
41952>>>>>>>>>>>            Send OK To (oSelList(current_object))
41953>>>>>>>>>>>        End_Procedure
41954>>>>>>>>>>>        //AB-StoreEnd
41954>>>>>>>>>>>
41954>>>>>>>>>>>    End_Object    // oOK_bn
41955>>>>>>>>>>>
41955>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
41957>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
41958>>>>>>>>>>>        Set Location to 113 332
41959>>>>>>>>>>>
41959>>>>>>>>>>>        //AB-StoreStart
41959>>>>>>>>>>>        Procedure OnClick
41961>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
41962>>>>>>>>>>>        End_Procedure
41963>>>>>>>>>>>        //AB-StoreEnd
41963>>>>>>>>>>>
41963>>>>>>>>>>>    End_Object    // oCancel_bn
41964>>>>>>>>>>>
41964>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
41966>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
41967>>>>>>>>>>>        Set Location to 113 387
41968>>>>>>>>>>>
41968>>>>>>>>>>>        //AB-StoreStart
41968>>>>>>>>>>>        Procedure OnClick
41970>>>>>>>>>>>            Send Search To (oSelList(current_object))
41971>>>>>>>>>>>        End_Procedure
41972>>>>>>>>>>>        //AB-StoreEnd
41972>>>>>>>>>>>
41972>>>>>>>>>>>    End_Object    // oSearch_bn
41973>>>>>>>>>>>
41973>>>>>>>>>>>
41973>>>>>>>>>>>    //AB-StoreStart
41973>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41974>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41975>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41976>>>>>>>>>>>    //AB-StoreEnd
41976>>>>>>>>>>>
41976>>>>>>>>>>>End_Object    // sl111
41977>>>>>>>>>>>
41977>>>>>>>>>>>//AB/ End_Object    // prj
41977>>>>>>>>>Use sl198.sl         // sl198
41977>>>>>>>>>Use sl197.SL         // sl197
41977>>>>>>>>>
41977>>>>>>>>>//DDB-Selection-pkg-End
41977>>>>>>>>>//DDB-FileEnd
41977>>>>>>>Use CLIENTS.DD
41977>>>>>>>
41977>>>>>>>//AB-IgnoreEnd
41977>>>>>>>
41977>>>>>>>Object Barticl is a dbModalPanelSub
41979>>>>>>>
41979>>>>>>>    //AB-StoreTopStart
41979>>>>>>>                    
41979>>>>>>>    Property Integer    piWhat              Public  0
41981>>>>>>>    Property Integer    FragmaTypkinCode    Public  0
41983>>>>>>>    Property Integer    piIsOpen            Public  0
41985>>>>>>>    Property String     FragmaClientID      Public ''
41987>>>>>>>    Property String     FragmaClientEpon    Public ''
41989>>>>>>>    Property Date       FragmaHmnia         Public ''
41991>>>>>>>    
41991>>>>>>>    Object Btypkin_DD2 is a Btypkin_DataDictionary
41993>>>>>>>    End_Object
41994>>>>>>>    
41994>>>>>>>    
41994>>>>>>>    //AB-StoreTopEnd
41994>>>>>>>
41994>>>>>>>    Set Label to "‰ ¤ã©œ ª €¥ ¦š¨á­à¤"
41995>>>>>>>    Set Size to 289 519
41996>>>>>>>    Set Location to 2 5
41997>>>>>>>    Set Exit_Application_Local_State to FALSE
41998>>>>>>>    Set Modal_State to FALSE
41999>>>>>>>
41999>>>>>>>    //AB-DDOStart
41999>>>>>>>
41999>>>>>>>    Object Btypkin_DD is a Btypkin_DataDictionary
42001>>>>>>>    End_Object    // Btypkin_DD
42002>>>>>>>
42002>>>>>>>    Object Barticl_DD is a Barticl_DataDictionary
42004>>>>>>>        Set DDO_Server to (Btypkin_DD(self))
42005>>>>>>>
42005>>>>>>>        //AB-StoreStart
42005>>>>>>>                                                
42005>>>>>>>        Begin_Constraints
42007>>>>>>>            Integer iTypkinCode iWhat isOpen
42008>>>>>>>            String  sClientID sClientEpon
42008>>>>>>>            Date    dHmnia
42008>>>>>>>        
42008>>>>>>>            Get FragmaTypkinCode    to iTypkinCode
42009>>>>>>>            Get FragmaClientID      to sClientID
42010>>>>>>>            Get FragmaClientEpon    to sClientEpon
42011>>>>>>>            Get FragmaHmnia         to dHmnia
42012>>>>>>>            Get piIsOpen            to isOpen
42013>>>>>>>        
42013>>>>>>>            If (iTypkinCode<>'') Begin
42015>>>>>>>                If (sClientID<>'') Begin
42017>>>>>>>                    Set Ordering Of Barticl_DD to 8
42018>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Epon1+Hmnia+Recnum
42018>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42020>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42022>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42024>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
42026>>>>>>>                    Constrain Barticl.Barticl_Epon1 Eq sClientEpon
42028>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
42032>>>>>>>                End
42032>>>>>>>>
42032>>>>>>>                Else Begin
42033>>>>>>>                    Set Ordering Of Barticl_DD to 11
42034>>>>>>>                    // Comp+Br+Year+Btypkin_Code+Hmnia+Epon1+Recnum
42034>>>>>>>                    Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42036>>>>>>>                    Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42038>>>>>>>                    Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42040>>>>>>>                    Constrain Barticl.Btypkin_Code  Eq iTypkinCode
42042>>>>>>>                    If (dHmnia<>'') Constrain Barticl.Barticl_Hmnia Eq dHmnia
42046>>>>>>>                End
42046>>>>>>>>
42046>>>>>>>            End
42046>>>>>>>>
42046>>>>>>>            Else If (dHmnia<>'') Begin
42049>>>>>>>                Set Ordering Of Barticl_DD to 9
42050>>>>>>>                // Comp+Br+Year+Hmnia+Epon1+Recnum
42050>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42052>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42054>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42056>>>>>>>                Constrain Barticl.Barticl_Hmnia Eq dHmnia
42058>>>>>>>                If (sClientID<>'') Constrain Barticl.Barticl_Epon1 Eq sClientEpon
42062>>>>>>>            End
42062>>>>>>>>
42062>>>>>>>            Else If (sClientID<>'') Begin
42065>>>>>>>                Set Ordering Of Barticl_DD to 8
42066>>>>>>>                // Comp+Br+Year+Epon1+Hmnia+Recnum
42066>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42068>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42070>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42072>>>>>>>                Constrain Barticl.Barticl_Epon1 Eq sClientEpon
42074>>>>>>>            End
42074>>>>>>>>
42074>>>>>>>            Else Begin
42075>>>>>>>                Constrain Barticl.Company_Code  Eq SyscurXr.Company_Code
42077>>>>>>>                Constrain Barticl.Branch_Code   Eq SyscurXr.Branch_Code
42079>>>>>>>                Constrain Barticl.Year_Year     Eq SyscurXr.Year_Year
42081>>>>>>>            End
42081>>>>>>>>
42081>>>>>>>            If (isOpen) Constrain Barticl.Barticl_Ekleise NE '1'
42085>>>>>>>        End_Constraints
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        
42088>>>>>>>        //AB-StoreEnd
42088>>>>>>>
42088>>>>>>>    End_Object    // Barticl_DD
42089>>>>>>>
42089>>>>>>>    Object Country_DD is a Country_DataDictionary
42091>>>>>>>    End_Object    // Country_DD
42092>>>>>>>
42092>>>>>>>    Object Towns_DD is a Towns_DataDictionary
42094>>>>>>>        Set DDO_Server to (Country_DD(self))
42095>>>>>>>    End_Object    // Towns_DD
42096>>>>>>>
42096>>>>>>>    Object Cities_DD is a Cities_DataDictionary
42098>>>>>>>        Set DDO_Server to (Towns_DD(self))
42099>>>>>>>    End_Object    // Cities_DD
42100>>>>>>>
42100>>>>>>>    Object Areas_DD is a Areas_DataDictionary
42102>>>>>>>    End_Object    // Areas_DD
42103>>>>>>>
42103>>>>>>>    Object Payresp_DD is a Payresp_DataDictionary
42105>>>>>>>    End_Object    // Payresp_DD
42106>>>>>>>
42106>>>>>>>    Object Clients_DD is a Clients_DataDictionary
42108>>>>>>>        Set DDO_Server to (Cities_DD(self))
42109>>>>>>>        Set DDO_Server to (Areas_DD(self))
42110>>>>>>>        Set DDO_Server to (Payresp_DD(self))
42111>>>>>>>    End_Object    // Clients_DD
42112>>>>>>>
42112>>>>>>>    Set Main_DD to (Barticl_DD(self))
42113>>>>>>>    Set Server to (Barticl_DD(self))
42114>>>>>>>
42114>>>>>>>    //AB-DDOEnd
42114>>>>>>>
42114>>>>>>>    Object oSelList is a dbListSub
42116>>>>>>>        Set Main_File to Barticl.File_Number
42117>>>>>>>        Set Size to 219 505
42118>>>>>>>        Set Location to 6 6
42119>>>>>>>
42119>>>>>>>        Begin_Row
42122>>>>>>>            Entry_Item Barticl.Barticl_no
42123>>>>>>>            Entry_Item Barticl.Arith_orist
42124>>>>>>>            Entry_Item Barticl.Barticl_hmnia
42125>>>>>>>            Entry_Item Btypkin.Btypkin_code
42126>>>>>>>            Entry_Item Btypkin.Btypkin_descr
42127>>>>>>>            Entry_Item Barticl.Barticl_code1
42128>>>>>>>            Entry_Item Barticl.Barticl_epon1
42129>>>>>>>            Entry_Item Barticl.Barticl_sv0
42130>>>>>>>            Entry_Item Barticl.Barticl_ekleise
42131>>>>>>>            Entry_Item Barticl.Isotimia
42132>>>>>>>        End_Row
42137>>>>>>>
42137>>>>>>>        Set Form_Width    item 0 to 47
42138>>>>>>>        Set Header_Label  item 0 to "€¨ Ÿ£æª"
42139>>>>>>>        
42139>>>>>>>        Set Form_Width    item 1 to 47
42140>>>>>>>        Set Header_Label  item 1 to "Ž¨ ©«.˜¨ Ÿ."
42141>>>>>>>        
42141>>>>>>>        Set Form_Width    item 2 to 48
42142>>>>>>>        Set Header_Label  item 2 to "†£œ¨/¤å˜"
42143>>>>>>>        
42143>>>>>>>        Set Form_Width    item 3 to 39
42144>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž"
42145>>>>>>>        
42145>>>>>>>        Set Form_Width    item 4 to 80
42146>>>>>>>        Set Header_Label  item 4 to "œ¨ š¨˜­ã"
42147>>>>>>>        
42147>>>>>>>        Set Form_Width    item 5 to 55
42148>>>>>>>        Set Header_Label  item 5 to "‘¬¤˜¢/¤¦ª"
42149>>>>>>>        
42149>>>>>>>        Set Form_Width    item 6 to 96
42150>>>>>>>        Set Header_Label  item 6 to "„§à¤¬£å˜"
42151>>>>>>>        
42151>>>>>>>        Set Form_Width    item 7 to 50
42152>>>>>>>        Set Header_Label  item 7 to "¦©æ"
42153>>>>>>>        
42153>>>>>>>        Set Form_Width    item 8 to 16
42154>>>>>>>        Set Header_Label  item 8 to "‰"
42155>>>>>>>        Set Column_Checkbox_State  item 8 to True
42156>>>>>>>        
42156>>>>>>>        Set Form_Width    item 9 to 22
42157>>>>>>>        Set Header_Label  item 9 to "„¡«."
42158>>>>>>>        Set Column_Checkbox_State  item 9 to True
42159>>>>>>>        
42159>>>>>>>
42159>>>>>>>        //AB-StoreStart
42159>>>>>>>        
42159>>>>>>>        //Property Integer StoreFragmaTypkinCode  Public 0
42159>>>>>>>        //Property String  StoreFragmaClientID    Public ''
42159>>>>>>>        //Property String  StoreFragmaClientEpon  Public ''
42159>>>>>>>        //Property Date    StoreFragmaHmnia       Public ''
42159>>>>>>>        
42159>>>>>>>        Procedure End_Construct_Object
42161>>>>>>>            Integer iDecimals
42162>>>>>>>            Forward Send End_Construct_Object
42164>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
42165>>>>>>>            Set Points Item 7 to iDecimals
42166>>>>>>>            Set Numeric_Mask Item 7 to 14 iDecimals ' ,*'
42167>>>>>>>        End_Procedure
42168>>>>>>>        
42168>>>>>>>        //Procedure Store_Defaults
42168>>>>>>>        //       Forward Send Store_Defaults
42168>>>>>>>        //       Set StoreFragmaTypkinCode    to (FragmaTypkinCode(Self))
42168>>>>>>>        //       Set StoreFragmaClientID      to (FragmaClientID  (Self))
42168>>>>>>>        //       Set StoreFragmaClientEpon    to (FragmaClientEpon(Self))
42168>>>>>>>        //       Set StoreFragmaHmnia         to (FragmaHmnia     (Self))
42168>>>>>>>        //End_Procedure
42168>>>>>>>        
42168>>>>>>>        //Procedure ReStore_Defaults
42168>>>>>>>        //       Forward Send ReStore_Defaults
42168>>>>>>>        //       Set FragmaTypkinCode to (StoreFragmaTypkinCode(Self))
42168>>>>>>>        //       Set FragmaClientID   to (StoreFragmaClientID  (Self))
42168>>>>>>>        //       Set FragmaClientEpon to (StoreFragmaClientEpon(Self))
42168>>>>>>>        //       Set FragmaHmnia      to (StoreFragmaHmnia     (Self))
42168>>>>>>>        //End_Procedure
42168>>>>>>>        
42168>>>>>>>        Procedure Activate
42170>>>>>>>            Send Keyaction to ButtonSub1
42171>>>>>>>            Forward Send Activate
42173>>>>>>>        End_procedure
42174>>>>>>>        
42174>>>>>>>        Procedure Activating
42176>>>>>>>            Forward Send Activating
42178>>>>>>>            Set Auto_Index_State to True
42179>>>>>>>        End_Procedure
42180>>>>>>>        
42180>>>>>>>        
42180>>>>>>>        //AB-StoreEnd
42180>>>>>>>
42180>>>>>>>    End_Object    // oSelList
42181>>>>>>>
42181>>>>>>>    Object Btypkin_Btypkin_Code is a dbFormSub
42183>>>>>>>        Entry_Item Btypkin.Btypkin_code
42184>>>>>>>        Set Label to "’ç§¦ª ‰å¤ž©žª"
42185>>>>>>>        Set Size to 13 49
42186>>>>>>>        Set Location to 229 84
42187>>>>>>>        Set Label_Col_Offset to 5
42188>>>>>>>        Set Label_Justification_Mode to jMode_Right
42189>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42190>>>>>>>
42190>>>>>>>        //AB-StoreStart
42190>>>>>>>                                                                                                                        
42190>>>>>>>        Set Server to (Btypkin_DD2(Self))
42191>>>>>>>        
42191>>>>>>>        Procedure Key Integer iKey
42193>>>>>>>            Integer iRetVal
42194>>>>>>>            Forward Send Key iKey
42196>>>>>>>            If (iKey=277) Send Clear to Btypkin_DD2
42199>>>>>>>        End_Procedure
42200>>>>>>>        
42200>>>>>>>        
42200>>>>>>>        //AB-StoreEnd
42200>>>>>>>
42200>>>>>>>    End_Object    // Btypkin_Btypkin_Code
42201>>>>>>>
42201>>>>>>>    Object Btypkin_Btypkin_Descr is a dbFormSub
42203>>>>>>>        Entry_Item Btypkin.Btypkin_descr
42204>>>>>>>        Set Size to 13 133
42205>>>>>>>        Set Location to 229 139
42206>>>>>>>        Set Color to clBtnFace
42207>>>>>>>        Set Label_Col_Offset to 2
42208>>>>>>>        Set Label_Justification_Mode to jMode_Right
42209>>>>>>>        Set Enabled_State to FALSE
42210>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42211>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
42212>>>>>>>        Set Shadow_State Item 0 to TRUE
42213>>>>>>>
42213>>>>>>>        //AB-StoreStart
42213>>>>>>>        Set Server to (Btypkin_DD2(Self))
42214>>>>>>>        
42214>>>>>>>        //AB-StoreEnd
42214>>>>>>>
42214>>>>>>>    End_Object    // Btypkin_Btypkin_Descr
42215>>>>>>>
42215>>>>>>>    Object Clients_Client_Name is a dbFormSub
42217>>>>>>>        Entry_Item Clients.Client_name
42218>>>>>>>        Set Server to (Clients_DD(self))
42219>>>>>>>        Set Label to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
42220>>>>>>>        Set Size to 13 188
42221>>>>>>>        Set Location to 244 84
42222>>>>>>>        Set Label_Col_Offset to 5
42223>>>>>>>        Set Label_Justification_Mode to jMode_Right
42224>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42225>>>>>>>
42225>>>>>>>        //AB-StoreStart
42225>>>>>>>                                                                                                                        
42225>>>>>>>        Procedure Key Integer iKey
42227>>>>>>>            Integer iRetVal
42228>>>>>>>            Forward Send Key iKey
42230>>>>>>>            If (iKey=277) Send Clear to Clients_DD
42233>>>>>>>        End_Procedure
42234>>>>>>>        
42234>>>>>>>        //AB-StoreEnd
42234>>>>>>>
42234>>>>>>>    End_Object    // Clients_Client_Name
42235>>>>>>>
42235>>>>>>>    Object cSyDateForm1 is a cSyDateForm
42237>>>>>>>        Set Label to "†£œ¨¦£ž¤å˜"
42238>>>>>>>        Set Size to 13 66
42239>>>>>>>        Set Location to 258 84
42240>>>>>>>        Set Label_Col_Offset to 5
42241>>>>>>>        Set Label_Justification_Mode to jMode_Right
42242>>>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
42243>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42244>>>>>>>
42244>>>>>>>        //AB-StoreStart
42244>>>>>>>                                                                                                                        
42244>>>>>>>        On_Key KClear Send ClearMe
42245>>>>>>>        
42245>>>>>>>        Procedure ClearMe
42247>>>>>>>            Set Value Item 0 to ''
42248>>>>>>>        End_Procedure
42249>>>>>>>        
42249>>>>>>>        //AB-StoreEnd
42249>>>>>>>
42249>>>>>>>    End_Object    // cSyDateForm1
42250>>>>>>>
42250>>>>>>>    Object chkOpen is a CheckBoxSub
42252>>>>>>>        Set Label to "‹æ¤¦ ˜¤¦ ®«á"
42253>>>>>>>        Set Size to 10 62
42254>>>>>>>        Set Location to 260 156
42255>>>>>>>    End_Object    // chkOpen
42256>>>>>>>
42256>>>>>>>    Object ButtonSub1 is a ButtonSub
42258>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
42259>>>>>>>        Set Size to 13 52
42260>>>>>>>        Set Location to 258 219
42261>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42262>>>>>>>
42262>>>>>>>        //AB-StoreStart
42262>>>>>>>                                                        
42262>>>>>>>        Procedure OnClick
42264>>>>>>>            String  sEpon sID
42265>>>>>>>            Integer iTypkin isOpen
42265>>>>>>>            Date    dHmnia
42265>>>>>>>        
42265>>>>>>>            Get Value Of cSyDateForm1 Item 0                                  to dHmnia
42266>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_ID    to sID
42267>>>>>>>            Get Field_Current_Value Of Clients_DD  Field Clients.Client_Name  to sEpon
42268>>>>>>>            Get Field_Current_Value Of Btypkin_DD2 Field Btypkin.Btypkin_Code to iTypkin
42269>>>>>>>        
42269>>>>>>>            Get Checked_State Of chkOpen to isOpen
42270>>>>>>>        
42270>>>>>>>            Set FragmaTypkinCode    to iTypkin
42271>>>>>>>            Set FragmaClientID      to sID
42272>>>>>>>            Set FragmaClientEpon    to sEpon
42273>>>>>>>            Set FragmaHmnia         to dHmnia
42274>>>>>>>            Set piIsOpen            to isOpen
42275>>>>>>>        
42275>>>>>>>            Send Rebuild_Constraints    to Barticl_DD
42276>>>>>>>            Send Beginning_Of_Data      to oSelList True
42277>>>>>>>        End_Procedure // OnClick
42278>>>>>>>        
42278>>>>>>>        
42278>>>>>>>        
42278>>>>>>>        //AB-StoreEnd
42278>>>>>>>
42278>>>>>>>    End_Object    // ButtonSub1
42279>>>>>>>
42279>>>>>>>    Object oOK_bn is a ButtonSub
42281>>>>>>>        Set Label to "&„§ ¢¦šã"
42282>>>>>>>        Set Size to 13 50
42283>>>>>>>        Set Location to 258 406
42284>>>>>>>        Set Focus_Mode to Pointer_Only
42285>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42286>>>>>>>
42286>>>>>>>        //AB-StoreStart
42286>>>>>>>        Procedure OnClick
42288>>>>>>>            Send OK To (oSelList(current_object))
42289>>>>>>>        End_Procedure
42290>>>>>>>        //AB-StoreEnd
42290>>>>>>>
42290>>>>>>>    End_Object    // oOK_bn
42291>>>>>>>
42291>>>>>>>    Object oCancel_bn is a ButtonSub
42293>>>>>>>        Set Label to "&€¡ç¨à©ž"
42294>>>>>>>        Set Size to 13 50
42295>>>>>>>        Set Location to 258 461
42296>>>>>>>        Set Focus_Mode to Pointer_Only
42297>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
42298>>>>>>>
42298>>>>>>>        //AB-StoreStart
42298>>>>>>>        Procedure OnClick
42300>>>>>>>            Send Cancel To (oSelList(current_object))
42301>>>>>>>        End_Procedure
42302>>>>>>>        //AB-StoreEnd
42302>>>>>>>
42302>>>>>>>    End_Object    // oCancel_bn
42303>>>>>>>
42303>>>>>>>
42303>>>>>>>    //AB-StoreStart
42303>>>>>>>                    
42303>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42304>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42305>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42306>>>>>>>    
42306>>>>>>>    Set Modal_State to True
42307>>>>>>>    
42307>>>>>>>    Procedure Activate
42309>>>>>>>        If (FragmaTypkinCode(Self)<>0) Begin
42311>>>>>>>            Send Clear to Btypkin_DD2
42312>>>>>>>            Move (FragmaTypkinCode(Self)) to Btypkin.Btypkin_Code
42313>>>>>>>            Send Find to Btypkin_DD2 Eq 1
42314>>>>>>>        End
42314>>>>>>>>
42314>>>>>>>        Else Send Clear to Btypkin_DD2
42316>>>>>>>        If (FragmaClientID(Self)<>'') Begin
42318>>>>>>>            Send Clear to Clients_DD
42319>>>>>>>            Move (FragmaClientID(Self)) to Clients.Client_ID
42320>>>>>>>            Send Find to Clients_DD Eq 6
42321>>>>>>>        End
42321>>>>>>>>
42321>>>>>>>        Else Send Clear to Clients_DD
42323>>>>>>>        If (FragmaHmnia(Self)<>'') Set Value Of cSyDateForm1 Item 0 to (FragmaHmnia(Self))
42326>>>>>>>        Else                       Set Value Of cSyDateForm1 Item 0 to ''
42328>>>>>>>        Forward Send Activate
42330>>>>>>>    End_Procedure
42331>>>>>>>    
42331>>>>>>>    //AB-StoreEnd
42331>>>>>>>
42331>>>>>>>End_Object    // Barticl
42332>>>>>>>
42332>>>>>>>//AB/ End_Object    // prj
42332>>>>>Use sl041.SL         // sl041
INCLUDING FILE: SL041.SL
42332>>>>>>>//AB/ Project CN : sl041
42332>>>>>>>//AB/     Object prj is a Lookup_Project
42332>>>>>>>//AB/         Set ProjectName to "CN : sl041"
42332>>>>>>>//AB/         Set ProjectFileName to "sl041.SL"
42332>>>>>>>//AB/         Set GenerateFileName to "NONAME"
42332>>>>>>>
42332>>>>>>>// Project Object Structure
42332>>>>>>>//   sl041 is a dbModalPanelSub
42332>>>>>>>//     Clients_DD is a DataDictionary
42332>>>>>>>//     Cn_DD is a DataDictionary
42332>>>>>>>//     oSelList is a dbListSub
42332>>>>>>>//     oOK_bn is a ButtonSub
42332>>>>>>>//     oCancel_bn is a ButtonSub
42332>>>>>>>//     oSearch_bn is a ButtonSub
42332>>>>>>>
42332>>>>>>>// Register all objects
42332>>>>>>>Register_Object Clients_DD
42332>>>>>>>Register_Object Cn_DD
42332>>>>>>>Register_Object oCancel_bn
42332>>>>>>>Register_Object oOK_bn
42332>>>>>>>Register_Object oSearch_bn
42332>>>>>>>Register_Object oSelList
42332>>>>>>>Register_Object sl041
42332>>>>>>>
42332>>>>>>>
42332>>>>>>>    //AB-IgnoreStart
42332>>>>>>>
42332>>>>>>>    Use DFAllEnt.pkg
42332>>>>>>>    Use dbList.Sub
42332>>>>>>>    Use Button.Sub
42332>>>>>>>
42332>>>>>>>
42332>>>>>>>    Use CLIENTS.DD
42332>>>>>>>    Use CN.DD
INCLUDING FILE: CN.DD
42332>>>>>>>>>//DDB-FileStart
42332>>>>>>>>>//DDB-HeaderStart
42332>>>>>>>>>
42332>>>>>>>>>// File Name : CN.DD
42332>>>>>>>>>// Class Name: Cn_DataDictionary
42332>>>>>>>>>// Revision  : 99
42332>>>>>>>>>// Version   : 2
42332>>>>>>>>>
42332>>>>>>>>>Use  Windows           // Basic Definitions
42332>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
42332>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42332>>>>>>>>>
42332>>>>>>>>>Open Cn
42334>>>>>>>>>Open Cnzones
INCLUDING FILE: CNZONES.FD
42336>>>>>>>>>Open Tperga
42338>>>>>>>>>Open Btnordh
INCLUDING FILE: BTNORDH.FD
42340>>>>>>>>>Open Dorderh
INCLUDING FILE: DORDERH.FD
42342>>>>>>>>>Open Clients
42344>>>>>>>>>Open Salesmen
42346>>>>>>>>>Open Mhxanik
42348>>>>>>>>>Open Constrct
42350>>>>>>>>>Open Sysrecc
42352>>>>>>>>>Open Syscurxr
42354>>>>>>>>>Open Gmove
42356>>>>>>>>>Open Sysrecg
42358>>>>>>>>>
42358>>>>>>>>>//DDB-HeaderEnd
42358>>>>>>>>>//DDB-ValidationStart
42358>>>>>>>>>
42358>>>>>>>>>Register_Object Cn_Cn_Categfpa_VT1
42358>>>>>>>>>Register_Object Cn_Tropos_Metaf_VT
42358>>>>>>>>>Register_Object Cn_Eidos_Cn_VT
42358>>>>>>>>>Register_Object Cn_Yesno_VT
42358>>>>>>>>>
42358>>>>>>>>>Object Cn_Cn_Categfpa_VT1  is a CodeValidationTable
42360>>>>>>>>>    Set Type_Value        To "VAT_STATUS"
42361>>>>>>>>>    Set Validate_State    To FALSE
42362>>>>>>>>>    Set Allow_Blank_State To TRUE
42363>>>>>>>>>    //DDB-ValidationCustomStart
42363>>>>>>>>>    //DDB-ValidationCustomEnd
42363>>>>>>>>>End_Object   // Cn_Cn_Categfpa_VT1
42364>>>>>>>>>
42364>>>>>>>>>Object Cn_Tropos_Metaf_VT  is a CodeValidationTable
42366>>>>>>>>>    Set Type_Value        To "FORTOSH"
42367>>>>>>>>>    Set Allow_Blank_State To TRUE
42368>>>>>>>>>    Set Table_Title       To "’¨æ§¦  ‹œ«˜­¦¨áª"
42369>>>>>>>>>    //DDB-ValidationCustomStart
42369>>>>>>>>>    //DDB-ValidationCustomEnd
42369>>>>>>>>>End_Object   // Cn_Tropos_Metaf_VT
42370>>>>>>>>>
42370>>>>>>>>>Object Cn_Eidos_Cn_VT  is a CodeValidationTable
42372>>>>>>>>>    Set Type_Value        To "EIDOSCN"
42373>>>>>>>>>    Set Allow_Blank_State To TRUE
42374>>>>>>>>>    Set Table_Title       To "„å›¦ª „¨š¦¬"
42375>>>>>>>>>    //DDB-ValidationCustomStart
42375>>>>>>>>>    //DDB-ValidationCustomEnd
42375>>>>>>>>>End_Object   // Cn_Eidos_Cn_VT
42376>>>>>>>>>
42376>>>>>>>>>Object Cn_Yesno_VT  is a CodeValidationTable
42378>>>>>>>>>    Set Type_Value        To "YESNO"
42379>>>>>>>>>    Set Allow_Blank_State To TRUE
42380>>>>>>>>>    //DDB-ValidationCustomStart
42380>>>>>>>>>    //DDB-ValidationCustomEnd
42380>>>>>>>>>End_Object   // Cn_Yesno_VT
42381>>>>>>>>>//DDB-ValidationEnd
42381>>>>>>>>>//DDB-SelectionStart
42381>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.sl
42381>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
42381>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
42381>>>>>>>>>Register_Object sl041
42381>>>>>>>>>Register_Object sl198
42381>>>>>>>>>Register_Object sl197
42381>>>>>>>>>//DDB-SelectionEnd
42381>>>>>>>>>
42381>>>>>>>>>Class Cn_DataDictionary  is a DataDictionary_Sec
42382>>>>>>>>>
42382>>>>>>>>>
42382>>>>>>>>>    Procedure Construct_Object
42383>>>>>>>>>        Forward Send Construct_Object
42385>>>>>>>>>        //------------------------------------------------
42385>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42385>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
42385>>>>>>>>>        // einai 1     js 03/12/2007
42385>>>>>>>>>        //------------------------------------------------  
42385>>>>>>>>>        Property Integer piCreateNew            Public  0
42386>>>>>>>>>        Property String  psAud_Old_CN           Public ""
42387>>>>>>>>>        Property String  psAud_Old_CNAdd        Public ""
42388>>>>>>>>>        Property String  psAud_Old_Chem         Public ""
42389>>>>>>>>>        Property String  psAud_Old_CNRecr       Public ""
42390>>>>>>>>>        //------------------------------------------------
42390>>>>>>>>>
42390>>>>>>>>>    End_procedure
42391>>>>>>>>>
42391>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
42392>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
42394>>>>>>>>>        //------------------------------------------------
42394>>>>>>>>>        // Properties gia na kraththoun oi palies times 
42394>>>>>>>>>        // ton pedion js 03/12/2007
42394>>>>>>>>>        //------------------------------------------------
42394>>>>>>>>>        Set psAud_Old_CN           to CN.CN_Code
42395>>>>>>>>>        Set psAud_Old_CNAdd        to CN.CN_Descr
42396>>>>>>>>>        Set psAud_Old_Chem         to CN.CN_VTicket
42397>>>>>>>>>        Set psAud_Old_CNRecr       to CN.CN_Recr
42398>>>>>>>>>        //------------------------------------------------
42398>>>>>>>>>     End_Procedure   // New_Current_Record
42399>>>>>>>>>
42399>>>>>>>>>    Procedure Delete_Main_File
42400>>>>>>>>>        //---------------------------------------------
42400>>>>>>>>>        // Auditing / Katagrafh allagon
42400>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42401>>>>>>>>>        Date    dDate  Shmer 
42401>>>>>>>>>        Integer iMin iHour iSec iLen
42401>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42405>>>>>>>>>        Move iHour  to sHour
42406>>>>>>>>>        Move iMin   to sMin
42407>>>>>>>>>        Move iSec   to sSec
42408>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42412>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42416>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42420>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42421>>>>>>>>>        
42421>>>>>>>>>        // Auditing / Diagrafh 
42421>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
42423>>>>>>>>>            Get fsLoginUserID to sUser
42424>>>>>>>>>            clear gmove
42425>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
42426>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
42427>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
42428>>>>>>>>>            move  4                     to gmove.gtypkin_code// Apo Clients
42429>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
42430>>>>>>>>>            move suser                  to gmove.gplan_code
42431>>>>>>>>>            move CN.CN_Recr             to gmove.garticl_recr
42432>>>>>>>>>            reread sysrecg
42436>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42437>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42438>>>>>>>>>            saverecord sysrecg
42439>>>>>>>>>            unlock
42440>>>>>>>>>>
42440>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
42441>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
42442>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
42443>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
42444>>>>>>>>>            
42444>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Partl_Recr          
42445>>>>>>>>>            Move CN.CN_Recr                     to Gmove.Pms_Recr          
42446>>>>>>>>>
42446>>>>>>>>>            Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
42447>>>>>>>>>            Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
42448>>>>>>>>>            Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
42449>>>>>>>>>
42449>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
42450>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
42451>>>>>>>>>            saverecord gmove
42452>>>>>>>>>        End
42452>>>>>>>>>>
42452>>>>>>>>>        Forward Send Delete_Main_File
42454>>>>>>>>>
42454>>>>>>>>>    End_Procedure
42455>>>>>>>>>
42455>>>>>>>>>    Procedure Update
42456>>>>>>>>>        Forward Send Update
42458>>>>>>>>>        // Insert Code Here
42458>>>>>>>>>        Move SysCurXR.Company_Code  to CN.Company_Code
42459>>>>>>>>>        Move SysCurXR.Branch_Code   to CN.Branch_Code
42460>>>>>>>>>        Move SysCurXR.Year_Year     to CN.Year_Year
42461>>>>>>>>>        //Move Custprom.Custprom_Code to CN.Custprom_Code
42461>>>>>>>>>        Move Clients.Client_ID      to CN.Client_ID
42462>>>>>>>>>
42462>>>>>>>>>        Move SysCurXR.Beto_Site      to CN.Cn_SiteW
42463>>>>>>>>>        Move Cn.Cn_Rec0              to CN.Cn_SN
42464>>>>>>>>>        Move Cn.Client_id            to Cn.Cn_clientid
42465>>>>>>>>>        Move Cn.cn_code              to Cn.Cn_Repmatch
42466>>>>>>>>>        Move Cn.Cn_Code              to Cn.Constraction_ID
42467>>>>>>>>>        Move PayResp.Presp_ID        to Cn.Cn_Presp_ID
42468>>>>>>>>>        Move Salesmen.Sls_ID         to Cn.Cn_Sls_ID
42469>>>>>>>>>        Move Constrct.Cnt_ID         to Cn.Cn_Cnt_ID
42470>>>>>>>>>        Move mhxanik.mhx_id          to Cn.mhxanik_ID
42471>>>>>>>>>
42471>>>>>>>>>        //---------------------------------------------
42471>>>>>>>>>        // Auditing / Katagrafh allagon
42471>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
42472>>>>>>>>>        Date    dDate  Shmer 
42472>>>>>>>>>        Integer iMin iHour iSec iLen
42472>>>>>>>>>        Sysdate dDate iHour iMin iSec 
42476>>>>>>>>>        Move iHour  to sHour
42477>>>>>>>>>        Move iMin   to sMin
42478>>>>>>>>>        Move iSec   to sSec
42479>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
42483>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
42487>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
42491>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
42492>>>>>>>>>        
42492>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
42492>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
42494>>>>>>>>>            Get fsLoginUserID to sUser
42495>>>>>>>>>            If (piCreateNew(Self)=1) Begin
42497>>>>>>>>>                clear gmove
42498>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
42499>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
42500>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
42501>>>>>>>>>                move  4                     to gmove.gtypkin_code// Apo Clients
42502>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
42503>>>>>>>>>                move suser                  to gmove.gplan_code
42504>>>>>>>>>                move CN.CN_Recr             to gmove.garticl_recr
42505>>>>>>>>>                reread sysrecg
42509>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42510>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42511>>>>>>>>>                saverecord sysrecg
42512>>>>>>>>>                unlock
42513>>>>>>>>>>
42513>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
42514>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
42515>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
42516>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
42517>>>>>>>>>
42517>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Partl_Recr          
42518>>>>>>>>>                Move CN.CN_Recr                 to Gmove.Pms_Recr          
42519>>>>>>>>>
42519>>>>>>>>>                Move CN.CN_Code                 to Gmove.Cur_CN
42520>>>>>>>>>                Move CN.CN_Descr                to Gmove.Cur_CN_Addr
42521>>>>>>>>>                Move CN.CN_VTicket              to Gmove.Cur_CN_Prosth
42522>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ ë¨š¦¬"    to Gmove.Gmove_Aitiol
42523>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
42524>>>>>>>>>                saverecord gmove
42525>>>>>>>>>                Set piCreateNew to 0
42526>>>>>>>>>            End
42526>>>>>>>>>>
42526>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
42529>>>>>>>>>                Integer isChanged
42529>>>>>>>>>                Move 0 to isChanged
42530>>>>>>>>>                
42530>>>>>>>>>                     If (psAud_Old_CN   (Self)<>CN.CN_Code   ) Move 1 to isChanged
42533>>>>>>>>>                Else If (psAud_Old_CNAdd(Self)<>CN.CN_Descr  ) Move 1 to isChanged
42537>>>>>>>>>                Else If (psAud_Old_Chem (Self)<>CN.CN_VTicket) Move 1 to isChanged
42541>>>>>>>>>                
42541>>>>>>>>>                If (isChanged>0) Begin  
42543>>>>>>>>>                    clear gmove
42544>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
42545>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
42546>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
42547>>>>>>>>>                    move  4                     to gmove.gtypkin_code// Apo Clients
42548>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
42549>>>>>>>>>                    move suser                  to gmove.gplan_code
42550>>>>>>>>>                    move Payresp.Presp_Recr    to gmove.garticl_recr
42551>>>>>>>>>                    reread sysrecg
42555>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
42556>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
42557>>>>>>>>>                    saverecord sysrecg
42558>>>>>>>>>                    unlock
42559>>>>>>>>>>
42559>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
42560>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
42561>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
42562>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
42563>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Partl_Recr          
42564>>>>>>>>>                    Move CN.CN_Recr                     to Gmove.Pms_Recr          
42565>>>>>>>>>                    //--                                
42565>>>>>>>>>                    Move CN.CN_Code                     to Gmove.Cur_CN
42566>>>>>>>>>                    Move CN.CN_Descr                    to Gmove.Cur_CN_Addr
42567>>>>>>>>>                    Move CN.CN_VTicket                  to Gmove.Cur_CN_Prosth
42568>>>>>>>>>                    //--
42568>>>>>>>>>                    Move (psAud_Old_CN    (Self))       to Gmove.Prev_CN
42569>>>>>>>>>                    Move (psAud_Old_CNAdd (Self))       to Gmove.Prev_CN_Addr
42570>>>>>>>>>                    Move (psAud_Old_Chem  (Self))       to Gmove.Prev_CN_Prosth
42571>>>>>>>>>
42571>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª ë¨š¦¬"      to gmove.gmove_aitiol
42572>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
42573>>>>>>>>>                    saverecord gmove
42574>>>>>>>>>                    Set piCreateNew to 0
42575>>>>>>>>>                End
42575>>>>>>>>>>
42575>>>>>>>>>            End
42575>>>>>>>>>>
42575>>>>>>>>>        End
42575>>>>>>>>>>
42575>>>>>>>>>
42575>>>>>>>>>
42575>>>>>>>>>    End_Procedure   // Update
42576>>>>>>>>>
42576>>>>>>>>>     Procedure Creating
42577>>>>>>>>>        Forward Send Creating
42579>>>>>>>>>        // Insert Code Here
42579>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(CN.CN_Rec0)))))) to CN.CN_Recr
42580>>>>>>>>>        Get fsgCode_With_Zeroes CN.CN_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to CN.CN_Code
42581>>>>>>>>>        Set piCreateNew to 1
42582>>>>>>>>>    End_Procedure   // Creating
42583>>>>>>>>>
42583>>>>>>>>>
42583>>>>>>>>>
42583>>>>>>>>>    // Define_Fields:
42583>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
42583>>>>>>>>>
42583>>>>>>>>>    Procedure Define_Fields
42584>>>>>>>>>        Forward Send Define_Fields
42586>>>>>>>>>        //DDB-Generated-Code-Location
42586>>>>>>>>>        //DDB-DefineFieldStart
42586>>>>>>>>>
42586>>>>>>>>>        Set Main_File            To Cn.File_Number
42587>>>>>>>>>        Set Cascade_Delete_State To FALSE
42588>>>>>>>>>
42588>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
42589>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
42590>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
42591>>>>>>>>>
42591>>>>>>>>>        // Child (Client) file structure................
42591>>>>>>>>>        Send Add_Client_File  Cnzones.File_Number
42592>>>>>>>>>        Send Add_Client_File  Tperga.File_Number
42593>>>>>>>>>        Send Add_Client_File  Btnordh.File_Number
42594>>>>>>>>>        Send Add_Client_File  Dorderh.File_Number
42595>>>>>>>>>
42595>>>>>>>>>        // Parent (Server) file structure...............
42595>>>>>>>>>        Send Add_Server_File  Clients.File_Number
42596>>>>>>>>>        Send Add_Server_File  Salesmen.File_Number
42597>>>>>>>>>        Send Add_Server_File  Mhxanik.File_Number
42598>>>>>>>>>        Send Add_Server_File  Constrct.File_Number
42599>>>>>>>>>
42599>>>>>>>>>        // External (System) file structure.............
42599>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
42600>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
42601>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
42602>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
42603>>>>>>>>>
42603>>>>>>>>>        Define_Auto_Increment  Sysrecc.Cn_Rec0  To Cn.Cn_Rec0
42606>>>>>>>>>
42606>>>>>>>>>        // Field-based properties.......................
42606>>>>>>>>>
42606>>>>>>>>>        // Cn.Company_Code
42606>>>>>>>>>
42606>>>>>>>>>        // Cn.Branch_Code
42606>>>>>>>>>
42606>>>>>>>>>        // Cn.Year_Year
42606>>>>>>>>>
42606>>>>>>>>>        // Cn.Custprom_Code
42606>>>>>>>>>
42606>>>>>>>>>        // Cn.Client_Id
42606>>>>>>>>>
42606>>>>>>>>>        // Cn.Cn_Code
42606>>>>>>>>>        Set Field_Options          Field Cn.Cn_Code To DD_AUTOFIND    DD_NOPUT      
42607>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Code To (sl041(Self))
42608>>>>>>>>>        Set Key_Field_State        Field Cn.Cn_Code To TRUE
42609>>>>>>>>>
42609>>>>>>>>>        // Cn.Client_Recr
42609>>>>>>>>>
42609>>>>>>>>>        // Cn.Cn_Rec0
42609>>>>>>>>>
42609>>>>>>>>>        // Cn.Cn_Recr
42609>>>>>>>>>
42609>>>>>>>>>        // Cn.Cn_Descr
42609>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Descr To (sl041(Self))
42610>>>>>>>>>
42610>>>>>>>>>        // Cn.Cn_Address
42610>>>>>>>>>
42610>>>>>>>>>        // Cn.Cn_Zipcode
42610>>>>>>>>>
42610>>>>>>>>>        // Cn.Cn_City
42610>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_City To (sl198(Self))
42611>>>>>>>>>
42611>>>>>>>>>        // Cn.Cn_Area
42611>>>>>>>>>        Set Field_Prompt_Object    Field Cn.Cn_Area To (sl197(Self))
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_License
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Responsible
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Cnt_Recr
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Cnt_Id
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Phone
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Zone
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Sls_Recr
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Sls_Id
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Details
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Distance
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Pump
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Pumplicense
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Totalstats
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Analstats
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Coated
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Sitew
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Clientmatch
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Codematch
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Pumpid
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Clientid
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Sn
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Repmatch
42612>>>>>>>>>
42612>>>>>>>>>        // Cn.Cn_Active
42612>>>>>>>>>        Set Field_Checkbox_Values  Field Cn.Cn_Active To "A"  "F"
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Reported
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Lastupdated
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Markexp
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Vdetails
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Vticket
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Constraction_Id
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Presp_Id
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Presp_Recr
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Add_No
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Nomos
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Cn_Xora
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Polh_Recr
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Lic_Number
42613>>>>>>>>>
42613>>>>>>>>>        // Cn.Lic_Date
42613>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Date To MASK_DATE_WINDOW
42614>>>>>>>>>
42614>>>>>>>>>        // Cn.Lic_Lixi
42614>>>>>>>>>        Set Field_Mask_Type        Field Cn.Lic_Lixi To MASK_DATE_WINDOW
42615>>>>>>>>>
42615>>>>>>>>>        // Cn.Lic_Auth
42615>>>>>>>>>
42615>>>>>>>>>        // Cn.Cn_Start_Date
42615>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_Start_Date To MASK_DATE_WINDOW
42616>>>>>>>>>
42616>>>>>>>>>        // Cn.Cn_End_Date
42616>>>>>>>>>        Set Field_Mask_Type        Field Cn.Cn_End_Date To MASK_DATE_WINDOW
42617>>>>>>>>>
42617>>>>>>>>>        // Cn.Cn_Categfpa
42617>>>>>>>>>        Set Field_Value_Table      Field Cn.Cn_Categfpa To (Cn_Cn_Categfpa_VT1(Self))
42618>>>>>>>>>
42618>>>>>>>>>        // Cn.Cn_Tpay
42618>>>>>>>>>
42618>>>>>>>>>        // Cn.Mhxanik_Id
42618>>>>>>>>>
42618>>>>>>>>>        // Cn.Sum_Pct_Tper
42618>>>>>>>>>
42618>>>>>>>>>        // Cn.Cn_M3
42618>>>>>>>>>
42618>>>>>>>>>        // Cn.Aa_Deop
42618>>>>>>>>>
42618>>>>>>>>>        // Cn.Hm_Tel_Fortio
42618>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Tel_Fortio To MASK_DATE_WINDOW
42619>>>>>>>>>
42619>>>>>>>>>        // Cn.Tel_Fortio_No
42619>>>>>>>>>
42619>>>>>>>>>        // Cn.Tropos_Metaf
42619>>>>>>>>>        Set Field_Value_Table      Field Cn.Tropos_Metaf To (Cn_Tropos_Metaf_VT(Self))
42620>>>>>>>>>
42620>>>>>>>>>        // Cn.Eidos_Cn
42620>>>>>>>>>        Set Field_Value_Table      Field Cn.Eidos_Cn To (Cn_Eidos_Cn_VT(Self))
42621>>>>>>>>>
42621>>>>>>>>>        // Cn.Polhths_Constr
42621>>>>>>>>>
42621>>>>>>>>>        // Cn.Polhths_Mhx
42621>>>>>>>>>
42621>>>>>>>>>        // Cn.Hm_Prot_Fortio
42621>>>>>>>>>        Set Field_Mask_Type        Field Cn.Hm_Prot_Fortio To MASK_DATE_WINDOW
42622>>>>>>>>>
42622>>>>>>>>>        // Cn.Mesoskyklos
42622>>>>>>>>>
42622>>>>>>>>>        // Cn.Diodia
42622>>>>>>>>>
42622>>>>>>>>>        // Cn.Yesno
42622>>>>>>>>>        Set Field_Value_Table      Field Cn.Yesno To (Cn_Yesno_VT(Self))
42623>>>>>>>>>
42623>>>>>>>>>        // Cn.Dateeggy
42623>>>>>>>>>        Set Field_Mask_Type        Field Cn.Dateeggy To MASK_DATE_WINDOW
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Branch
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Exfd1
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Exfd2
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Exfd3
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Exfd4
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Exfd5
42624>>>>>>>>>
42624>>>>>>>>>        // Cn.Cn_Exfd6
42624>>>>>>>>>
42624>>>>>>>>>        //DDB-DefineFieldEnd
42624>>>>>>>>>    End_Procedure    // Define_Fields
42625>>>>>>>>>
42625>>>>>>>>>    // Field_Defaults:
42625>>>>>>>>>    // This procedure is used to establish default field values.
42625>>>>>>>>>          
42625>>>>>>>>>    Procedure Field_Defaults
42626>>>>>>>>>        Forward Send Field_Defaults
42628>>>>>>>>>        //DDB-Generated-Code-Location
42628>>>>>>>>>        //DDB-FieldDefaultStart
42628>>>>>>>>>        Set Field_Changed_Value   Field Cn.Cn_Active To "A"
42629>>>>>>>>>        //DDB-FieldDefaultEnd
42629>>>>>>>>>    End_Procedure    // Field_Defaults
42630>>>>>>>>>
42630>>>>>>>>>End_Class    // Cn_DataDictionary
42631>>>>>>>>>//DDB-Selection-pkg-Start
42631>>>>>>>>>
42631>>>>>>>>>Use sl041.sl         // sl041
42631>>>>>>>>>Use sl198.sl         // sl198
42631>>>>>>>>>Use sl197.SL         // sl197
42631>>>>>>>>>
42631>>>>>>>>>//DDB-Selection-pkg-End
42631>>>>>>>>>//DDB-FileEnd
42631>>>>>>>    
42631>>>>>>>    //AB-IgnoreEnd
42631>>>>>>>
42631>>>>>>>    Object sl041 is a dbModalPanelSub
42633>>>>>>>
42633>>>>>>>        //AB-StoreTopStart
42633>>>>>>>        Property String FragmaClient_ID Public ''
42635>>>>>>>        
42635>>>>>>>        //AB-StoreTopEnd
42635>>>>>>>
42635>>>>>>>        Set Label to "„§ ¢¦šã „¨šà¤"
42636>>>>>>>        Set Size to 249 500
42637>>>>>>>        Set Location to 2 6
42638>>>>>>>        Set Exit_Application_Local_State to FALSE
42639>>>>>>>        Set Modal_State to FALSE
42640>>>>>>>
42640>>>>>>>        //AB-DDOStart
42640>>>>>>>
42640>>>>>>>        Object Clients_DD is a Clients_DataDictionary
42642>>>>>>>
42642>>>>>>>            //AB-StoreStart
42642>>>>>>>                                                                                                                                                                                                                                        
42642>>>>>>>                                                                                                                                                                                                                                        
42642>>>>>>>                                                                                                                                                                                                                                        
42642>>>>>>>            //AB-StoreEnd
42642>>>>>>>
42642>>>>>>>        End_Object    // Clients_DD
42643>>>>>>>
42643>>>>>>>        Object Cn_DD is a Cn_DataDictionary
42645>>>>>>>            Set DDO_Server to (Clients_DD(self))
42646>>>>>>>
42646>>>>>>>            //AB-StoreStart
42646>>>>>>>                                            
42646>>>>>>>            Begin_Constraints
42648>>>>>>>                String sID
42649>>>>>>>                Get FragmaClient_ID to sID
42650>>>>>>>                If (sID<>'') begin
42652>>>>>>>                    set ordering to 4
42653>>>>>>>                    Constrain CN.Client_ID eq sID
42655>>>>>>>                end
42655>>>>>>>>
42655>>>>>>>                ELSE SET ORDERING TO -1
42657>>>>>>>            End_Constraints
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            
42660>>>>>>>            //AB-StoreEnd
42660>>>>>>>
42660>>>>>>>        End_Object    // Cn_DD
42661>>>>>>>
42661>>>>>>>        Set Main_DD to (Cn_DD(self))
42662>>>>>>>        Set Server to (Cn_DD(self))
42663>>>>>>>
42663>>>>>>>        //AB-DDOEnd
42663>>>>>>>
42663>>>>>>>        Object oSelList is a dbListSub
42665>>>>>>>            Set Main_File to Cn.File_Number
42666>>>>>>>            Set Ordering to 4
42667>>>>>>>            Set Size to 209 481
42668>>>>>>>            Set Location to 6 6
42669>>>>>>>            Set Auto_Index_State to FALSE
42670>>>>>>>
42670>>>>>>>            Begin_Row
42673>>>>>>>                Entry_Item Cn.Cn_code
42674>>>>>>>                Entry_Item Cn.Cn_descr
42675>>>>>>>                Entry_Item Cn.Client_id
42676>>>>>>>                Entry_Item Clients.Client_name
42677>>>>>>>                Entry_Item Cn.Cn_active
42678>>>>>>>            End_Row
42683>>>>>>>
42683>>>>>>>            Set Form_Width    item 0 to 61
42684>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „¨š¦¬"
42685>>>>>>>            
42685>>>>>>>            Set Form_Width    item 1 to 185
42686>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã „¨š¦¬"
42687>>>>>>>            
42687>>>>>>>            Set Form_Width    item 2 to 60
42688>>>>>>>            Set Header_Label  item 2 to "‰à›.œ¢á«ž"
42689>>>>>>>            
42689>>>>>>>            Set Form_Width    item 3 to 123
42690>>>>>>>            Set Header_Label  item 3 to "„§à¤¬£å˜ œ¢á«ž"
42691>>>>>>>            
42691>>>>>>>            Set Form_Width    item 4 to 44
42692>>>>>>>            Set Header_Label  item 4 to "‘œ „¥â¢ ¥ž"
42693>>>>>>>            Set Column_Checkbox_State  item 4 to True
42694>>>>>>>            
42694>>>>>>>
42694>>>>>>>            //AB-StoreStart
42694>>>>>>>                                            
42694>>>>>>>            Property String StoreFragmaClient_ID Public ''
42696>>>>>>>            
42696>>>>>>>            Procedure Store_Defaults
42698>>>>>>>                   Forward Send Store_Defaults
42700>>>>>>>                   Set StoreFragmaClient_ID to (FragmaClient_ID(Self))
42701>>>>>>>            End_Procedure
42702>>>>>>>            
42702>>>>>>>            Procedure ReStore_Defaults
42704>>>>>>>                   Forward Send ReStore_Defaults
42706>>>>>>>                   Set FragmaClient_ID to (StoreFragmaClient_ID(Self))
42707>>>>>>>            End_Procedure
42708>>>>>>>            
42708>>>>>>>            Procedure Activating Returns Integer
42710>>>>>>>                Integer rVal
42711>>>>>>>                Forward Get Msg_Activating to rVal
42713>>>>>>>                set auto_index_state to true
42714>>>>>>>                SET ORDERING TO -1
42715>>>>>>>                Procedure_Return rVal
42716>>>>>>>            End_Procedure
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            
42717>>>>>>>            //AB-StoreEnd
42717>>>>>>>
42717>>>>>>>        End_Object    // oSelList
42718>>>>>>>
42718>>>>>>>        Object oOK_bn is a ButtonSub
42720>>>>>>>            Set Label to "&„§ ¢¦šã"
42721>>>>>>>            Set Location to 219 327
42722>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42723>>>>>>>
42723>>>>>>>            //AB-StoreStart
42723>>>>>>>            Procedure OnClick
42725>>>>>>>                Send OK To (oSelList(current_object))
42726>>>>>>>            End_Procedure
42727>>>>>>>            //AB-StoreEnd
42727>>>>>>>
42727>>>>>>>        End_Object    // oOK_bn
42728>>>>>>>
42728>>>>>>>        Object oCancel_bn is a ButtonSub
42730>>>>>>>            Set Label to "&€¡ç¨à©ž"
42731>>>>>>>            Set Location to 219 383
42732>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42733>>>>>>>
42733>>>>>>>            //AB-StoreStart
42733>>>>>>>            Procedure OnClick
42735>>>>>>>                Send Cancel To (oSelList(current_object))
42736>>>>>>>            End_Procedure
42737>>>>>>>            //AB-StoreEnd
42737>>>>>>>
42737>>>>>>>        End_Object    // oCancel_bn
42738>>>>>>>
42738>>>>>>>        Object oSearch_bn is a ButtonSub
42740>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
42741>>>>>>>            Set Location to 219 437
42742>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
42743>>>>>>>
42743>>>>>>>            //AB-StoreStart
42743>>>>>>>            Procedure OnClick
42745>>>>>>>                Send Search To (oSelList(current_object))
42746>>>>>>>            End_Procedure
42747>>>>>>>            //AB-StoreEnd
42747>>>>>>>
42747>>>>>>>        End_Object    // oSearch_bn
42748>>>>>>>
42748>>>>>>>
42748>>>>>>>        //AB-StoreStart
42748>>>>>>>                        
42748>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
42749>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
42750>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
42751>>>>>>>        Set Modal_State to True
42752>>>>>>>        Procedure Activating Returns Integer
42754>>>>>>>            Integer rVal
42755>>>>>>>            Forward Get Msg_Activating to rVal
42757>>>>>>>            Send Rebuild_Constraints to (CN_DD(Self))
42758>>>>>>>            Send Beginning_Of_Data to oSelList
42759>>>>>>>            Procedure_Return rVal
42760>>>>>>>        End_Procedure
42761>>>>>>>        
42761>>>>>>>        procedure page integer pagemode
42763>>>>>>>            forward send page pagemode
42765>>>>>>>            set location to 40,40
42766>>>>>>>        end_procedure
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        
42767>>>>>>>        //AB-StoreEnd
42767>>>>>>>
42767>>>>>>>    End_Object    // sl041
42768>>>>>>>
42768>>>>>>>//AB/     End_Object    // prj
42768>>>>>
42768>>>>>//DDB-Selection-pkg-End
42768>>>>>//DDB-FileEnd
42768>>>Use BAXIO.DD
INCLUDING FILE: BAXIO.DD
42768>>>>>//DDB-FileStart
42768>>>>>//DDB-HeaderStart
42768>>>>>
42768>>>>>// File Name : BAXIO.DD
42768>>>>>// Class Name: Baxio_DataDictionary
42768>>>>>// Revision  : 112
42768>>>>>// Version   : 2
42768>>>>>
42768>>>>>Use  Windows           // Basic Definitions
42768>>>>>Use  DataDict          // DataDictionary Class Definition
42768>>>>>Use  DDvalTbl          // Validation Table Class Definitions
42768>>>>>
42768>>>>>Open Baxio
42770>>>>>Open Bmove
42772>>>>>Open Baxiokat
42774>>>>>Open Sysrecb
42776>>>>>
42776>>>>>//DDB-HeaderEnd
42776>>>>>//DDB-ValidationStart
42776>>>>>
42776>>>>>//DDB/ ExternalValidationTable Baxio_Status_VT  Baxio.pkg
42776>>>>>//DDB/ ExternalValidationTable Bfile_VT  Baxio.pkg
42776>>>>>
42776>>>>>Register_Object Baxio_Status_VT
42776>>>>>Register_Object Baxio_Baxio_Place_VT
42776>>>>>Register_Object Bfile_VT
42776>>>>>Register_Object Baxio_Baxio_Bank_VT
42776>>>>>Register_Object Baxio_Baxio_Banka_VT
42776>>>>>Register_Object Baxio_Baxio_From_VT
42776>>>>>Register_Object Baxio_Baxio_Topos_VT1
42776>>>>>Use Baxio.pkg        // Baxio_Status_VT, Bfile_VT
42776>>>>>
42776>>>>>Object Baxio_Baxio_Place_VT  is a CodeValidationTable
42778>>>>>    Set Type_Value        To "BAXIOPLACE"
42779>>>>>    //DDB-ValidationCustomStart
42779>>>>>    //DDB-ValidationCustomEnd
42779>>>>>End_Object   // Baxio_Baxio_Place_VT
42780>>>>>
42780>>>>>Object Baxio_Baxio_Bank_VT  is a CodeValidationTable
42782>>>>>    Set Type_Value        To "BANK"
42783>>>>>    Set Allow_Blank_State To TRUE
42784>>>>>    //DDB-ValidationCustomStart
42784>>>>>    //DDB-ValidationCustomEnd
42784>>>>>End_Object   // Baxio_Baxio_Bank_VT
42785>>>>>
42785>>>>>Object Baxio_Baxio_Banka_VT  is a CodeValidationTable
42787>>>>>    Set Type_Value        To "BANK"
42788>>>>>    Set Allow_Blank_State To TRUE
42789>>>>>    //DDB-ValidationCustomStart
42789>>>>>    //DDB-ValidationCustomEnd
42789>>>>>End_Object   // Baxio_Baxio_Banka_VT
42790>>>>>
42790>>>>>Object Baxio_Baxio_From_VT  is a DescriptionValidationTable
42792>>>>>    Set Allow_Blank_State To TRUE
42793>>>>>    Set Table_Title       To "€¥ æš¨˜­¦  ›å¦¬ / «¨å«¦¬"
42794>>>>>
42794>>>>>    Procedure Fill_List
42796>>>>>        Forward Send Fill_List
42798>>>>>        Send Add_Table_Value  "0"  "ˆ›å¦¬"
42799>>>>>        Send Add_Table_Value  "1"  "’¨å«¦¬"
42800>>>>>    End_Procedure    // Fill_List
42801>>>>>    //DDB-ValidationCustomStart
42801>>>>>    //DDB-ValidationCustomEnd
42801>>>>>End_Object   // Baxio_Baxio_From_VT
42802>>>>>
42802>>>>>Object Baxio_Baxio_Topos_VT1  is a DescriptionValidationTable
42804>>>>>    Set Allow_Blank_State To TRUE
42805>>>>>    Set Table_Title       To "€¥ æš¨˜­¦ €«« ¡ãª / „§˜¨®å˜ª"
42806>>>>>
42806>>>>>    Procedure Fill_List
42808>>>>>        Forward Send Fill_List
42810>>>>>        Send Add_Table_Value  "0"  "€«« ¡ãª"
42811>>>>>        Send Add_Table_Value  "1"  "„§˜¨®å˜ª"
42812>>>>>    End_Procedure    // Fill_List
42813>>>>>    //DDB-ValidationCustomStart
42813>>>>>    //DDB-ValidationCustomEnd
42813>>>>>End_Object   // Baxio_Baxio_Topos_VT1
42814>>>>>//DDB-ValidationEnd
42814>>>>>//DDB-SelectionStart
42814>>>>>//DDB/ ExternalSelectionList SL037  SL037.SL
42814>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
42814>>>>>Register_Object SL037
42814>>>>>Register_Object slNomism
42814>>>>>//DDB-SelectionEnd
42814>>>>>
42814>>>>>Class Baxio_DataDictionary  is a DataDictionary_Sec
42815>>>>>
42815>>>>>      Procedure Construct_Object
42816>>>>>                Forward Send Construct_Object
42818>>>>>
42818>>>>>                //btypkin related properties:
42818>>>>>                //œ¤ž£œ¨é¤¦¤«˜  ©«ã¤: update «¦¬ bmove,
42818>>>>>                //£ž›œ¤å¦¤«˜   ©«ž¤: request save & delete «¦¬ bmove.
42818>>>>>                Property Integer piBtypkin_Flag03 0
42819>>>>>                Property Integer piBtypkin_Flag04 0
42820>>>>>                Property Integer pifromxrhsh      0
42821>>>>>
42821>>>>>                //baxio related properties:
42821>>>>>                //œ¤ž£œ¨é¤œ«˜     ©«ž¤: creating,
42821>>>>>                //®¨ž© £¦§¦ œå«˜  ©«ž¤: update «¦¬ bmove š ˜ ¤˜ œ¤œ¨š¦§¦ ã©œ  «ž¤ private.created_baxio «¦¬ bmove,
42821>>>>>                //£ž›œ¤åœ«˜      ©«ž¤: request save & delete «¦¬ bmove.
42821>>>>>                Property Integer piCreated_Baxio  0
42822>>>>>
42822>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤: backout,
42822>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «¦¬ baxio,
42822>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
42822>>>>>                Property Number  pnB_Baxio_V2      0
42823>>>>>                Property Number  pnB_Baxio_V0      0
42824>>>>>                Property Number  pnB_Baxio_V00     0
42825>>>>>                Property Number  pnB_Baxio_Vr      0
42826>>>>>                Property String  psB_Baxio_C_Code2 ""
42827>>>>>                Property Integer piB_Baxio_Status  0
42828>>>>>                Property Integer piB_Baxio_Place   0
42829>>>>>
42829>>>>>                //properties š ˜ œ¢âš®¦¬ª ˜¢˜ššãª parent records:
42829>>>>>                //œ¤ž£œ¨é¤¦¤«˜     ©«ž¤:backout,
42829>>>>>                //®¨ž© £¦§¦ ¦ç¤«˜  ©«ž¤: validate_save š ˜ «¦¤ â¢œš®¦ editing «à¤ §œ›åà¤,
42829>>>>>                //£ž›œ¤å¦¤«˜      ©«ž¤: request save & delete «¦¬ bmove.
42829>>>>>                Property Integer piB_Baxiokat_Code 0
42830>>>>>                Property Integer piB_Year_Year     0
42831>>>>>                Property Integer piMustNOTConstrain Public 0
42832>>>>>      End_Procedure //construct_object
42833>>>>>
42833>>>>>
42833>>>>>
42833>>>>>//    Function fngConvertPoso_Baxio String asNomismaCodeApo ;
42833>>>>>//                            Number anPoso           ;
42833>>>>>//                            String asNomismaCodeSe  ;
42833>>>>>//                            Date   adHmnia          ;
42833>>>>>//                            Number nIsotimia  Returns Number
42833>>>>>
42833>>>>>//        Number rVal nApo_Euro_Isot nSe_Euro_Isot
42833>>>>>//        Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
42833>>>>>//        Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
42833>>>>>
42833>>>>>//        If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
42833>>>>>
42833>>>>>//        Clear Nomisma
42833>>>>>//        Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
42833>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
42833>>>>>//        Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
42833>>>>>//        Move Nomisma.Einai_DRX      to iApo_Einai_DRX
42833>>>>>//        Move Nomisma.Einai_EURO     to iApo_Einai_Euro
42833>>>>>//        Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
42833>>>>>//        Move Nomisma.Dekadika       to iDekadika_Apo
42833>>>>>
42833>>>>>//        Clear Nomisma
42833>>>>>//        Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
42833>>>>>//        Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
42833>>>>>//        Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
42833>>>>>//        Move Nomisma.Einai_DRX      to iSe_Einai_DRX
42833>>>>>//        Move Nomisma.Einai_EURO     to iSe_Einai_Euro
42833>>>>>//        Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
42833>>>>>//        Move Nomisma.Dekadika       to iDekadika_Se
42833>>>>>
42833>>>>>//        //05a. ??ÿ??? ? --> ??? 
42833>>>>>//        Calc (anPoso/nApo_Euro_Isot) to rVal
42833>>>>>//        Move (Round_Number(rVal,6)) to rVal
42833>>>>>//        //05b. ???         --> ??ÿ??? ?™ *
42833>>>>>//        Calc (rVal*nSe_Euro_Isot) to rVal
42833>>>>>//        Move (Round_Number(rVal,iDekadika_Se)) to rVal
42833>>>>>//        Function_Return rVal
42833>>>>>//    End_Function
42833>>>>>
42833>>>>>
42833>>>>>
42833>>>>>      //¡˜Ÿ¦¨åœ  «ž¤ default « £ã «¦¬ ¤¦£å©£˜«¦ª ˜¤á¢¦š˜ £œ «¦ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
42833>>>>>      Function Default_Axio_C_Code2 Returns String
42834>>>>>               String lsBaxio_C_Code_2
42835>>>>>               //Get File_Field_Current_Value File_Field SyscurXr.C_Code0 to lsBaxio_C_Code_2
42835>>>>>               Move SyscurXr.C_Code0 to lsBaxio_C_Code_2
42836>>>>>               Function_Return (Trim(lsBaxio_C_Code_2))
42837>>>>>      End_Function //default_axio_c_code2
42838>>>>>
42838>>>>>
42838>>>>>      // js 09/02/2002 den yparxei enhmerosh ton nomismatvn xrhshs
42838>>>>>      Procedure Convert_Axio_Values
42839>>>>>
42839>>>>>                Integer liBtypkin_Flag03 liBtypkin_Flag04
42840>>>>>
42840>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code0    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate0       to Baxio.Baxio_V0
42841>>>>>
42841>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_Code00   ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_Rate00      to Baxio.Baxio_V00
42842>>>>>
42842>>>>>                Get fngConvertPoso  Baxio.Baxio_C_Code2 ;                                    Baxio.Baxio_V2      ;                                    SysCurXr.C_CodeR    ;                                    Baxio.Baxio_HmniaE  ;                                    Baxio.Baxio_RateR       to Baxio.Baxio_VR
42843>>>>>
42843>>>>>
42843>>>>>//                Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2,   ;
42843>>>>>//                                     Baxio.Baxio_V2,        ;
42843>>>>>//                                     SyscurXr.C_Code0,      ;
42843>>>>>//                                     Baxio.Baxio_HmniaE,    ;
42843>>>>>//                                     Baxio.Baxio_Rate0)     ;
42843>>>>>//                                    ) to Baxio.Baxio_V0
42843>>>>>//                If (liBtypkin_Flag03 = TRUE);
42843>>>>>//                     Begin
42843>>>>>//                      //˜¥å˜ 2-->00
42843>>>>>//                      Move (fngConvertPoso_Baxio(Self, Baxio.Baxio_C_Code2, ;
42843>>>>>//                                            Baxio.Baxio_V2,      ;
42843>>>>>//                                            SyscurXr.C_Code00,   ;
42843>>>>>//                                            Baxio.Baxio_HmniaE,  ;
42843>>>>>//                                            Baxio.Baxio_Rate00)  ;
42843>>>>>//                                          ) to Baxio.Baxio_V00
42843>>>>>//                     End
42843>>>>>//                Else Begin
42843>>>>>//                      Move 0            to Baxio.Baxio_V00
42843>>>>>//                     End
42843>>>>>//                If (liBtypkin_Flag04 = TRUE);
42843>>>>>//                     Begin
42843>>>>>//                      //˜¥å˜ 2-->r
42843>>>>>//                      Move (fngConvertPoso_Baxio(Self,Baxio.Baxio_C_Code2, ;
42843>>>>>//                                       Baxio.Baxio_V2,      ;
42843>>>>>//                                       SyscurXr.C_CodeR,    ;
42843>>>>>//                                       Baxio.Baxio_HmniaE,  ;
42843>>>>>//                                       Baxio.Baxio_RateR)   ;
42843>>>>>//                                      ) to Baxio.Baxio_VR
42843>>>>>//                     End
42843>>>>>//                Else Begin
42843>>>>>//                      Move 0            to Baxio.Baxio_VR
42843>>>>>//                     End
42843>>>>>      End_Procedure
42844>>>>>
42844>>>>>
42844>>>>>
42844>>>>>      Procedure Constrain
42845>>>>>                Forward Send Constrain
42847>>>>>                If (piMustNOTConstrain(Self)=1) Begin
42849>>>>>                End 
42849>>>>>>
42849>>>>>                else If (piMustNOTConstrain(Self)=2) Begin 
42852>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
42854>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
42856>>>>>                end    
42856>>>>>>
42856>>>>>                Else Begin
42857>>>>>                    Constrain Baxio.Company_Code Eq Syscurxr.Company_Code
42859>>>>>                    Constrain Baxio.Branch_Code  Eq Syscurxr.Branch_Code
42861>>>>>                    Constrain Baxio.Year_Year    Eq Syscurxr.Year_Year
42863>>>>>                End
42863>>>>>>
42863>>>>>      End_Procedure   //constrain
42864>>>>>
42864>>>>>
42864>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
42864>>>>>      //™) ˜¤áš¤à©ž properties
42864>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
42864>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
42864>>>>>      //œ) œ¤ž£â¨à©ž properties after
42864>>>>>      Procedure Update
42865>>>>>                Forward Send Update
42867>>>>>                
42867>>>>>                If (Baxio.Baxio_C_Code2='') Move SyscurXr.C_Code0 to Baxio.Baxio_C_Code2
42870>>>>>                
42870>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
42870>>>>>                Move Syscurxr.Company_Code  to Baxio.Company_Code
42871>>>>>                Move Syscurxr.Branch_Code   to Baxio.Branch_Code
42872>>>>>                Move Syscurxr.Year_Year     to Baxio.Year_Year
42873>>>>>                Move Syscurxr.Year_Recr     to Baxio.Year_Recr
42874>>>>>                Move Baxiokat.Baxiokat_Code to Baxio.Baxiokat_Code
42875>>>>>
42875>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
42875>>>>>                //š01:œ¥ ¦¨ ©£¦ç, «˜ §¢ž¨à«â˜ ›â¤ â®¦¬¤ ©«¦ ®œå˜ §˜¨˜¢¢˜™ãª
42875>>>>>                If (Baxiokat.Baxiokat_Type = 2);                Begin //˜¥ æš¨˜­˜ §¢ž¨à«â˜
42877>>>>>                     Move "" to Baxio.Baxio_Code_In
42878>>>>>                     Move "" to Baxio.Baxio_Epon_In
42879>>>>>                     Move 0  to Baxio.Baxio_Fpar_In
42880>>>>>                End
42880>>>>>>
42880>>>>>                //š02:yyyy + mm + dd ¢ã¥žª š ˜ «˜ reports
42880>>>>>                Move (TheYearSegment (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_YYYY
42881>>>>>                Move (TheMonthSegment(Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_MM
42882>>>>>                Move (TheDaySegment  (Baxio.Baxio_Hmnial)) to Baxio.Baxio_Lixi_DD
42883>>>>>
42883>>>>>                //š03:§¨é«¦ª & «œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª
42883>>>>>                If (Baxio.Baxio_Lcode = "");                Begin
42885>>>>>                     Move (-1) to Baxio.Baxio_File_Out
42886>>>>>                     Move ""   to Baxio.Baxio_Code_Out
42887>>>>>                     Move ""   to Baxio.Baxio_Epon_Out
42888>>>>>                     Move ""   to Baxio.Baxio_Fpar_Out
42889>>>>>
42889>>>>>                     Move (-1) to Baxio.Baxio_Lfile
42890>>>>>                     Move ""   to Baxio.Baxio_Lepon
42891>>>>>                     Move ""   to Baxio.Baxio_Lpar
42892>>>>>                End
42892>>>>>>
42892>>>>>      End_Procedure //update
42893>>>>>
42893>>>>>
42893>>>>>      Procedure Backout
42894>>>>>                Forward Send Backout
42896>>>>>
42896>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
42896>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
42897>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
42898>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
42899>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
42900>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
42901>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
42902>>>>>                Set piB_Baxio_Place   to Baxio.Baxio_Place
42903>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42904>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42905>>>>>      End_Procedure //backout
42906>>>>>
42906>>>>>
42906>>>>>      Procedure New_Current_Record Integer liOld_Record Integer liNew_Record
42907>>>>>                Forward Send New_Current_Record liOld_Record liNew_Record
42909>>>>>                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
42909>>>>>                Set pnB_Baxio_V2      to Baxio.Baxio_V2
42910>>>>>                Set pnB_Baxio_V0      to Baxio.Baxio_V0
42911>>>>>                Set pnB_Baxio_V00     to Baxio.Baxio_V00
42912>>>>>                Set pnB_Baxio_Vr      to Baxio.Baxio_Vr
42913>>>>>                Set psB_Baxio_C_Code2 to Baxio.Baxio_C_Code2
42914>>>>>                Set piB_Baxio_Status  to Baxio.Baxio_Status
42915>>>>>                Set piB_Baxiokat_Code to Baxio.Baxiokat_Code    //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42916>>>>>                Set piB_Year_Year     to Baxio.Year_Year        //š ˜ â¢œš®¦ ˜¢˜ššãª parent
42917>>>>>      End_Procedure //new_current_record
42918>>>>>
42918>>>>>
42918>>>>>      Procedure Creating
42919>>>>>                Forward Send Creating
42921>>>>>
42921>>>>>                //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
42921>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBaxio
42921>>>>>
42921>>>>>                //«œ¢œ¬«˜å¦ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
42921>>>>>                Add 1 to Baxiokat.Baxio_Lcode
42922>>>>>                Move Baxiokat.Baxio_Lcode to Baxio.Baxio_Code
42923>>>>>
42923>>>>>                //«¦ property ˜¬«æ œ¤œ¨š¦§¦ œå «ž¤ private.created_baxio
42923>>>>>                //£â©à «žª update ©«¦ bmove
42923>>>>>                Set piCreated_Baxio to TRUE
42924>>>>>
42924>>>>>//
42924>>>>>//                Move SysCurXr.C_Code0 to Baxio.Baxio_C_Code2
42924>>>>>
42924>>>>>                Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                 (Trim(String(Baxio.Baxio_Rec0)))))) to Baxio.Baxio_Recr
42925>>>>>
42925>>>>>      End_Procedure //creating
42926>>>>>
42926>>>>>
42926>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
42927>>>>>                String lsError_Message
42928>>>>>                Case Begin
42928>>>>>                     //˜§æ validate save
42928>>>>>                     Case (iError_Num = 1001)
42930>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ž£œ¨¦£ž¤å˜ ¢ã¥œàª!");                          to lsError_Message
42931>>>>>                     Case Break
42932>>>>>                     Case (iError_Num = 1002)
42935>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42936>>>>>                     Case Break
42937>>>>>                     Case (iError_Num = 1003)
42940>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  ¦§à©›ã§¦«œ ¤æ£ ©£˜!");                          to lsError_Message
42941>>>>>                     Case Break
42942>>>>>                     Case (iError_Num = 1004)
42945>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42946>>>>>                     Case Break
42947>>>>>                     Case (iError_Num = 1005)
42950>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42951>>>>>                     Case Break
42952>>>>>                     Case (iError_Num = 1006)
42955>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã (Œæ£ ©£˜ Reporting).\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã ˜¥å˜!");                          to lsError_Message
42956>>>>>                     Case Break
42957>>>>>
42957>>>>>                     Case (iError_Num = 1007)
42960>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\nŒâ˜ €¥ æš¨˜­˜ ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42961>>>>>                     Case Break
42962>>>>>                     Case (iError_Num = 1008)
42965>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ¤æ£ ©£˜ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42966>>>>>                     Case Break
42967>>>>>                     Case (iError_Num = 1009)
42970>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ „šš¨˜­ãª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42971>>>>>                     Case Break
42972>>>>>                     Case (iError_Num = 1010)
42975>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42976>>>>>                     Case Break
42977>>>>>                     Case (iError_Num = 1011)
42980>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜ •¨ã©žª) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42981>>>>>                     Case Break
42982>>>>>                     Case (iError_Num = 1012)
42985>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã (Œæ£ ©£˜ Reporting) !\n\n’¦ §¦©æ¤ «¨¦§¦§¦ œå«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
42986>>>>>                     Case Break
42987>>>>>                     Case (iError_Num = 1013)
42990>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž „šš¨˜­ã !\n\n’¦ ˜¥ æš¨˜­¦ â®œ  œ¥¦­¢žŸœå !");                          to lsError_Message
42991>>>>>                     Case Break
42992>>>>>
42992>>>>>                     Case (iError_Num = 1014)
42995>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ¡˜«žš¦¨å˜!");                          to lsError_Message
42996>>>>>                     Case Break
42997>>>>>                     Case (iError_Num = 1015)
43000>>>>>                          Move ("DDC 037:€¡˜«á¢¢ž¢ž œšš¨˜­ã.\n\n"+;                          "’¦ ˜¥ æš¨˜­¦ ›â¤ œ§ «¨â§œ«˜  ¤˜ ˜¢¢á¥œ  ®¨ã©ž!");                          to lsError_Message
43001>>>>>                     Case Break
43002>>>>>                     Case (iError_Num = 1100)
43005>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
43006>>>>>                          Case Break
43007>>>>>
43007>>>>>                     //˜§æ validate delete
43007>>>>>                     Case (iError_Num = 2007)
43010>>>>>                          Move ("DDC 037:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n’¦ €¥ æš¨˜­¦ › ˜š¨á­œ«˜  £æ¤¦¤ ˜§¦ ¡ ¤ã©œ ª !");                          to lsError_Message
43011>>>>>                     Case Break
43012>>>>>                     Case (iError_Num = 2100)
43015>>>>>                          Move "DDC 037:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
43016>>>>>                          Case Break
43017>>>>>
43017>>>>>                     Case Else
43017>>>>>                          Forward Send Operation_Not_Allowed iError_Num
43019>>>>>                Case End
43019>>>>>
43019>>>>>                Error iError_Num lsError_Message
43020>>>>>>
43020>>>>>      End_Procedure // operation_not_allowed
43021>>>>>
43021>>>>>      //1001:baxio_hmnial > 0
43021>>>>>      //1002:baxio_v2 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
43021>>>>>      //1003:baxio_c_code2 <> ""     (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ £ã¤ â®œ  ¤æ£ ©£˜)
43021>>>>>
43021>>>>>      //1004:baxio_v0 > 0            (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
43021>>>>>      //1005:baxio_v00 > 0 if flag 3 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
43021>>>>>      //1006:baxio_vr > 0  of flag 4 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
43021>>>>>
43021>>>>>
43021>>>>>      //1007:›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd, ›ž¢˜›ã §¨â§œ 
43021>>>>>      //       If (baxio.recnum=0) then operation_origin must be = bmove_dd
43021>>>>>      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
43021>>>>>      //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2      £æ¤¦¤ ˜§æ bmove_dd
43021>>>>>      //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0      £æ¤¦¤ ˜§æ bmove_dd
43021>>>>>      //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00     £æ¤¦¤ ˜§æ bmove_dd
43021>>>>>      //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr      £æ¤¦¤ ˜§æ bmove_dd
43021>>>>>
43021>>>>>      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œçœ¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits
43021>>>>>
43021>>>>>      //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
43021>>>>>      //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year     record
43021>>>>>      Function Validate_Save Returns Integer
43022>>>>>               Integer iReturnVal
43023>>>>>
43023>>>>>               Forward Get Validate_Save to iReturnVal
43025>>>>>
43025>>>>>               If (Not(iReturnVal));               Begin
43027>>>>>
43027>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record----------------------
43027>>>>>                //sososo £ž§àª §¨œ§œ  ¤˜ §˜ ¥à £œ «ž¤ current record ????
43027>>>>>                If (Baxio.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ record
43029>>>>>                      //1007:â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§¦ «¦ baxio_dd
43029>>>>>
43029>>>>>                      If (pifromxrhsh(Self)=0) Begin
43031>>>>>                        If (Not((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number)) Send Operation_Not_Allowed 1007
43034>>>>>                      End
43034>>>>>>
43034>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ baxio record
43034>>>>>>
43034>>>>>
43034>>>>>
43034>>>>>                //---------â¢œš®¦  editing existing baxio records---------------------
43034>>>>>                Else;                Begin //edit an existing record
43035>>>>>                      //1008:«¨¦§¦§¦åž©ž (edit) baxio_c_code2 £æ¤¦¤ ˜§æ bmove_dd
43035>>>>>
43035>>>>>                      If (pifromxrhsh(Self)=0) Begin
43037>>>>>
43037>>>>>                        If (;                            ((psB_Baxio_C_Code2(Self))     <> Baxio.Baxio_C_Code2) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1008
43040>>>>>                        //1009:«¨¦§¦§¦åž©ž (edit) baxio_v2 £æ¤¦¤ ˜§æ bmove_dd
43040>>>>>                        If (;                            ((pnB_Baxio_V2(Self))          <> Baxio.Baxio_V2      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1009
43043>>>>>                        //1010:«¨¦§¦§¦åž©ž (edit) baxio_v0 £æ¤¦¤ ˜§æ bmove_dd
43043>>>>>                        If (;                            ((pnB_Baxio_V0(Self))          <> Baxio.Baxio_V0      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1010
43046>>>>>                        //1011:«¨¦§¦§¦åž©ž (edit) baxio_v00 £æ¤¦¤ ˜§æ bmove_dd
43046>>>>>                        If (;                            ((pnB_Baxio_V00(Self))         <> Baxio.Baxio_V00     ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1011
43049>>>>>                        //1012:«¨¦§¦§¦åž©ž (edit) baxio_vr £æ¤¦¤ ˜§æ bmove_dd
43049>>>>>                        If (;                            ((pnB_Baxio_Vr(Self))          <> Baxio.Baxio_Vr      ) and;                            ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number);                            )                                                       Send Operation_Not_Allowed 1012
43052>>>>>
43052>>>>>                      End
43052>>>>>>
43052>>>>>                        // Egine rem 20/12/2001 giati an orisoume sta metrhta gia paradeigma
43052>>>>>                        // oti to status SE einai exoflhmeno, tote xtypaei to validation sto
43052>>>>>                        // kleisimo toy barticle. Alloste den vlepoume giati den mporei na
43052>>>>>                        // anoigokleisei
43052>>>>>//                      //1013:œá¤ «¦ status œå¤˜  œ¥¦­¢ž£â¤¦, ˜§˜š¦¨œç¦¤«˜  æ¢˜ «˜ §œ¨˜ «â¨à edits ˜§¦ «¦ bmove
43052>>>>>//                      If (;
43052>>>>>//                           ((piB_Baxio_Status(Self))      = 2                    ) and;
43052>>>>>//                           ((Main_File(OPERATION_ORIGIN)) =  Bmove.File_Number);
43052>>>>>//                         )                                                       Send Operation_Not_Allowed 1013
43052>>>>>
43052>>>>>                      If (pifromxrhsh(Self)=0) Begin
43054>>>>>                        //1014:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent baxiokat record
43054>>>>>                        If (Not;                            ((piB_Baxiokat_Code(Self)) =  Baxiokat.Baxiokat_Code);                            )                                                       Send Operation_Not_Allowed 1014
43057>>>>>
43057>>>>>                        //1015:˜§˜š¦¨œçœ«˜  ž ˜¢¢˜šã parent year record
43057>>>>>                        If (Not;                            ((piB_Year_Year    (Self)) =  SysCurXr.Year_Year        );                            )                                                       Send Operation_Not_Allowed 1015
43060>>>>>                      End
43060>>>>>>
43060>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing baxio records
43060>>>>>>
43060>>>>>
43060>>>>>                //¢¦§¦å â¢œš®¦ 
43060>>>>>                //1001:baxio_hmnial > 0
43060>>>>>                If (Not(Baxio.Baxio_Hmnial > 0 ))   Send Operation_Not_Allowed 1001
43063>>>>>                //1002:baxio_v2 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ œšš¨˜­ãª
43063>>>>>                If (Not(Baxio.Baxio_V2 > 0))         Send Operation_Not_Allowed 1002
43066>>>>>                //1003:baxio_c_code2 <> ""
43066>>>>>                If (Not(Baxio.Baxio_C_Code2 <>""))    Send Operation_Not_Allowed 1003
43069>>>>>                //1004:baxio_v0 > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©œàª
43069>>>>>//--------------If (Not(Baxio.Baxio_V0 > 0))         Send Operation_Not_Allowed 1004
43069>>>>>                //1005:baxio_v00> 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©œàª
43069>>>>>//--------------If (Not(Baxio.Baxio_V00> 0))         Send Operation_Not_Allowed 1005
43069>>>>>                //1006:baxio_vr > 0 (›â¤ œ§ «¨â§œ«˜  â¤˜ ˜¥ æš¨˜­¦ ¤˜ â®œ  £ž›œ¤ ¡ã ˜¥å˜ ©œ ¤æ£ ©£˜ reporting
43069>>>>>//--------------If (Not(Baxio.Baxio_VR > 0))         Send Operation_Not_Allowed 1006
43069>>>>>                //1100:cby = globals
43069>>>>>
43069>>>>>                If (pifromxrhsh(Self)=0) Begin
43071>>>>>
43071>>>>>                    If ( ;                        (Not(Baxio.Company_Code = SyscurXr.Company_Code)) or;                        (Not(Baxio.Branch_Code  = SyscurXr.Branch_Code )) or;                        (Not(Baxio.Year_Year    = SyscurXr.Year_Year   ));                        )                                                   Send Operation_Not_Allowed 1100
43074>>>>>
43074>>>>>               End
43074>>>>>>
43074>>>>>
43074>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
43074>>>>>>
43074>>>>>               Function_Return iReturnVal
43075>>>>>      End_Function //validate_save
43076>>>>>
43076>>>>>
43076>>>>>      //2007:ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬ œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ «¦ bmove_dd
43076>>>>>      Function Validate_Delete  Returns Integer
43077>>>>>               Integer iReturnVal
43078>>>>>               Forward Get Validate_Delete  To iReturnVal
43080>>>>>               If (Not(iReturnVal));               Begin
43082>>>>>
43082>>>>>                  //2007:â¢œš®¦ª › ˜š¨˜­ãª ˜¥ ¦š¨á­¦¬ (£æ¤¦¤ ˜§¦ bmove_dd)
43082>>>>>                  If ((Main_File(OPERATION_ORIGIN)) <> Bmove.File_Number)          Send Operation_Not_Allowed 2007
43085>>>>>
43085>>>>>                  //2100:cby = globals
43085>>>>>                  If ( ;                      (Not(Baxio.Company_Code = Syscurxr.Company_Code)) or;                      (Not(Baxio.Branch_Code  = Syscurxr.Branch_Code )) or;                      (Not(Baxio.Year_Year    = Syscurxr.Year_Year        ));                      )                                                   Send Operation_Not_Allowed 2100
43088>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
43088>>>>>>
43088>>>>>               Function_Return iReturnVal
43089>>>>>      End_Function //validate_delete
43090>>>>>
43090>>>>>
43090>>>>>//------------------------------------------------------------------
43090>>>>>    Procedure Define_Fields
43091>>>>>        Forward Send Define_Fields
43093>>>>>        //DDB-Generated-Code-Location
43093>>>>>        //DDB-DefineFieldStart
43093>>>>>
43093>>>>>        Set Main_File            To Baxio.File_Number
43094>>>>>        Set Cascade_Delete_State To FALSE
43095>>>>>
43095>>>>>
43095>>>>>        // Child (Client) file structure................
43095>>>>>        Send Add_Client_File  Bmove.File_Number
43096>>>>>
43096>>>>>        // Parent (Server) file structure...............
43096>>>>>        Send Add_Server_File  Baxiokat.File_Number
43097>>>>>
43097>>>>>        // External (System) file structure.............
43097>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
43098>>>>>
43098>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
43101>>>>>
43101>>>>>        // Field-based properties.......................
43101>>>>>
43101>>>>>        // Baxio.Company_Code
43101>>>>>
43101>>>>>        // Baxio.Branch_Code
43101>>>>>
43101>>>>>        // Baxio.Year_Year
43101>>>>>
43101>>>>>        // Baxio.Baxiokat_Code
43101>>>>>
43101>>>>>        // Baxio.Baxio_Code
43101>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code To (SL037(Self))
43102>>>>>
43102>>>>>        // Baxio.Baxio_Rec0
43102>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0 To (SL037(Self))
43103>>>>>
43103>>>>>        // Baxio.Year_Recr
43103>>>>>
43103>>>>>        // Baxio.Baxiokat_Recr
43103>>>>>
43103>>>>>        // Baxio.Baxio_Recr
43103>>>>>
43103>>>>>        // Baxio.Baxio_Status
43103>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status To (Baxio_Status_VT(Self))
43104>>>>>
43104>>>>>        // Baxio.Baxio_Place
43104>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place To (Baxio_Baxio_Place_VT(Self))
43105>>>>>
43105>>>>>        // Baxio.Baxio_File_In
43105>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In To (Bfile_VT(Self))
43106>>>>>
43106>>>>>        // Baxio.Baxio_Code_In
43106>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Code_In To "To BIAXIOKAT_FILE ¡˜Ÿ¦¨åœ  «ž¤ ©®œ« ¡ã ¢å©«˜"
43106>>>>>
43106>>>>>        // Baxio.Baxio_Epon_In
43106>>>>>
43106>>>>>        // Baxio.Baxio_Fpar_In
43106>>>>>
43106>>>>>        // Baxio.Baxio_File_Out
43106>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out To (Bfile_VT(Self))
43107>>>>>
43107>>>>>        // Baxio.Baxio_Code_Out
43107>>>>>
43107>>>>>        // Baxio.Baxio_Epon_Out
43107>>>>>
43107>>>>>        // Baxio.Baxio_Fpar_Out
43107>>>>>
43107>>>>>        // Baxio.Baxio_Lfile
43107>>>>>
43107>>>>>        // Baxio.Baxio_Lcode
43107>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lcode To (Bfile_VT(Self))
43108>>>>>
43108>>>>>        // Baxio.Baxio_Lepon
43108>>>>>
43108>>>>>        // Baxio.Baxio_Lpar
43108>>>>>
43108>>>>>        // Baxio.Baxio_Bank00000
43108>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000 To (Baxio_Baxio_Bank_VT(Self))
43109>>>>>
43109>>>>>        // Baxio.Baxio_Hmniae
43109>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae To (SL037(Self))
43110>>>>>
43110>>>>>        // Baxio.Baxio_Hmniap000
43110>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000 To (SL037(Self))
43111>>>>>
43111>>>>>        // Baxio.Baxio_Hmnial
43111>>>>>        //DDB/ Comment_Short       Field Baxio.Baxio_Hmnial To "†£/¤å˜ Šã¥žª:"
43111>>>>>
43111>>>>>        // Baxio.Baxio_Ekdoths
43111>>>>>
43111>>>>>        // Baxio.Baxio_Ekdothse
43111>>>>>
43111>>>>>        // Baxio.Baxio_Sediatagh
43111>>>>>
43111>>>>>        // Baxio.Baxio_Sdiataghe
43111>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Sdiataghe To (SL037(Self))
43112>>>>>
43112>>>>>        // Baxio.Baxio_Banka
43112>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka To (Baxio_Baxio_Banka_VT(Self))
43113>>>>>
43113>>>>>        // Baxio.Baxio_Opistho
43113>>>>>
43113>>>>>        // Baxio.Baxio_No
43113>>>>>
43113>>>>>        // Baxio.Baxio_V2
43113>>>>>
43113>>>>>        // Baxio.Baxio_V0
43113>>>>>
43113>>>>>        // Baxio.Baxio_V00
43113>>>>>
43113>>>>>        // Baxio.Baxio_Vr
43113>>>>>
43113>>>>>        // Baxio.Baxio_Rate0
43113>>>>>
43113>>>>>        // Baxio.Baxio_Rate00
43113>>>>>
43113>>>>>        // Baxio.Baxio_Rater
43113>>>>>
43113>>>>>        // Baxio.Baxio_C_Code2
43113>>>>>        Set Field_Entry_msg        Field Baxio.Baxio_C_Code2 To get_Default_Axio_C_Code2
43114>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2 To DD_CAPSLOCK   
43115>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_C_Code2 To (slNomism(Self))
43116>>>>>
43116>>>>>        // Baxio.Baxio_Lixi_Yyyy
43116>>>>>
43116>>>>>        // Baxio.Baxio_Lixi_Mm
43116>>>>>
43116>>>>>        // Baxio.Baxio_Lixi_Dd
43116>>>>>
43116>>>>>        // Baxio.Baxio_Bmove_Laa
43116>>>>>
43116>>>>>        // Baxio.Baxio_Desm
43116>>>>>
43116>>>>>        // Baxio.Baxio_From
43116>>>>>        Set Field_Value_Table      Field Baxio.Baxio_From To (Baxio_Baxio_From_VT(Self))
43117>>>>>
43117>>>>>        // Baxio.Baxio_Topos
43117>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Topos To (Baxio_Baxio_Topos_VT1(Self))
43118>>>>>
43118>>>>>        //DDB-DefineFieldEnd
43118>>>>>
43118>>>>>        Set Main_File            To Baxio.File_Number
43119>>>>>        Set Cascade_Delete_State To FALSE
43120>>>>>
43120>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43121>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43122>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43123>>>>>
43123>>>>>        // Child (Client) file structure................
43123>>>>>        Send Add_Client_File  Bmove.File_Number
43124>>>>>
43124>>>>>        // Parent (Server) file structure...............
43124>>>>>        Send Add_Server_File  Baxiokat.File_Number
43125>>>>>
43125>>>>>        // External (System) file structure.............
43125>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
43126>>>>>
43126>>>>>        Define_Auto_Increment  Sysrecb.Baxio_Rec0  To Baxio.Baxio_Rec0
43129>>>>>
43129>>>>>        // Field-based properties.......................
43129>>>>>
43129>>>>>        // Baxio.Company_Code
43129>>>>>
43129>>>>>        // Baxio.Branch_Code
43129>>>>>
43129>>>>>        // Baxio.Year_Year
43129>>>>>
43129>>>>>        // Baxio.Baxiokat_Code
43129>>>>>
43129>>>>>        // Baxio.Baxio_Code
43129>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code         To "‰à› ¡æª €¥ ¦š¨á­¦¬"
43130>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code         To "‰à› ¡æª"
43131>>>>>        Set Field_Options          Field Baxio.Baxio_Code         To DD_AUTOFIND    DD_NOPUT
43132>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Code         To (sl037(Self))
43133>>>>>        Set Key_Field_State        Field Baxio.Baxio_Code         To TRUE
43134>>>>>
43134>>>>>        // Baxio.Baxio_Rec0
43134>>>>>        Set Field_Options          Field Baxio.Baxio_Rec0         To DD_AUTOFIND    DD_REQUIRED
43135>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Rec0         To (sl037(Self))
43136>>>>>        Set Key_Field_State        Field Baxio.Baxio_Rec0         To TRUE
43137>>>>>
43137>>>>>        // Baxio.Year_Rec0
43137>>>>>
43137>>>>>        // Baxio.Baxiokat_Rec0
43137>>>>>
43137>>>>>        // Baxio.Baxio_Status
43137>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Status       To "dbComboForm_EZ"
43138>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
43139>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Status       To "‰˜«á©«˜©ž"
43140>>>>>        Set Field_Options  Field Baxio.Baxio_Status  To DD_DISPLAYONLY
43141>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Status       To (Baxio_Status_VT(Self))
43142>>>>>
43142>>>>>        // Baxio.Baxio_Place
43142>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Place        To "dbComboForm_EZ"
43143>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
43144>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Place        To "„¬¨å©¡œ«˜ "
43145>>>>>        Set Field_Options          Field Baxio.Baxio_Place        To DD_DISPLAYONLY
43146>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Place        To (Baxio_Baxio_Place_VT(Self))
43147>>>>>
43147>>>>>        // Baxio.Baxio_File_In
43147>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_In      To (Bfile_VT(Self))
43148>>>>>
43148>>>>>        // Baxio.Baxio_Code_In
43148>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
43149>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_In      To "˜¨œ¢ã­Ÿž €§æ"
43150>>>>>        Set Field_Options          Field Baxio.Baxio_Code_In      To DD_DISPLAYONLY
43151>>>>>
43151>>>>>        // Baxio.Baxio_Epon_In
43151>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
43152>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_In      To "„§à¤¬£å˜"
43153>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_In      To DD_DISPLAYONLY
43154>>>>>
43154>>>>>        // Baxio.Baxio_Fpar_In
43154>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢˜™ãª"
43155>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Fpar_In      To "˜¨/¡æ ˜¨˜¢."
43156>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_In      To DD_DISPLAYONLY
43157>>>>>
43157>>>>>        // Baxio.Baxio_File_Out
43157>>>>>        Set Field_Value_Table      Field Baxio.Baxio_File_Out     To (Bfile_VT(Self))
43158>>>>>
43158>>>>>        // Baxio.Baxio_Code_Out
43158>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
43159>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Code_Out     To "¨é«¦ª ˜¨˜¢ã§«žª"
43160>>>>>        Set Field_Options          Field Baxio.Baxio_Code_Out     To DD_DISPLAYONLY
43161>>>>>
43161>>>>>        // Baxio.Baxio_Epon_Out
43161>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
43162>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Epon_Out     To "„§à¤¬£å˜"
43163>>>>>        Set Field_Options          Field Baxio.Baxio_Epon_Out     To DD_DISPLAYONLY
43164>>>>>
43164>>>>>        // Baxio.Baxio_Fpar_Out
43164>>>>>        Set Field_Options          Field Baxio.Baxio_Fpar_Out     To DD_DISPLAYONLY
43165>>>>>
43165>>>>>        // Baxio.Baxio_Lfile
43165>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Lfile        To (Bfile_VT(Self))
43166>>>>>
43166>>>>>        // Baxio.Baxio_Lcode
43166>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lcode        To "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª"
43167>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lcode        To "’œ¢.˜¨˜¢ã§«žª"
43168>>>>>        Set Field_Options          Field Baxio.Baxio_Lcode        To DD_DISPLAYONLY
43169>>>>>
43169>>>>>        // Baxio.Baxio_Lepon
43169>>>>>        Set Field_Options          Field Baxio.Baxio_Lepon        To DD_DISPLAYONLY
43170>>>>>
43170>>>>>        // Baxio.Baxio_Lpar
43170>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
43171>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Lpar         To "˜¨/¡æ ˜¨á›¦©žª"
43172>>>>>        Set Field_Options          Field Baxio.Baxio_Lpar         To DD_DISPLAYONLY
43173>>>>>
43173>>>>>        // Baxio.Baxio_Bank00000
43173>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Bank00000    To "dbComboForm_EZ"
43174>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Bank00000    To (Baxio_Baxio_Bank_VT(Self))
43175>>>>>
43175>>>>>        // Baxio.Baxio_Hmniae
43175>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniae       To "dbSpinForm_EZ"
43176>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
43177>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniae       To "†£/¤å˜ „¡›¦©žª"
43178>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniae       To (sl037(Self))
43179>>>>>
43179>>>>>        // Baxio.Baxio_Hmniap000
43179>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmniap000    To "dbSpinForm_EZ"
43180>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
43181>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmniap000    To "†£/¤å˜ ˜¨˜¢˜™ãª"
43182>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmniap000    To (sl037(Self))
43183>>>>>
43183>>>>>        // Baxio.Baxio_Hmnial
43183>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Hmnial       To "dbSpinForm_EZ"
43184>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
43185>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Hmnial       To "†£/¤å˜ Šã¥žª"
43186>>>>>        Set Field_Options          Field Baxio.Baxio_Hmnial       To DD_REQUIRED
43187>>>>>        Set Field_Prompt_Object    Field Baxio.Baxio_Hmnial       To (sl037(Self))
43188>>>>>
43188>>>>>        // Baxio.Baxio_Ekdoths
43188>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdoths      To "€¨® ¡æª „¡›æ«žª"
43189>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdoths      To "€¨®.„¡›æ«žª"
43190>>>>>
43190>>>>>        // Baxio.Baxio_Ekdothse
43190>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜ €¨® ¡¦ç „¡›æ«ž"
43191>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Ekdothse     To "„§à¤¬£å˜"
43192>>>>>
43192>>>>>        // Baxio.Baxio_Sediatagh
43192>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
43193>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sediatagh    To "‘œ ƒ ˜«˜šã"
43194>>>>>
43194>>>>>        // Baxio.Baxio_Sdiataghe
43194>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜ €¨® ¡¦ç ƒ ¡˜ ¦ç®¦¬"
43195>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Sdiataghe    To "„§à¤¬£å˜"
43196>>>>>
43196>>>>>        // Baxio.Baxio_Banka
43196>>>>>        Set Field_Class_Name       Field Baxio.Baxio_Banka        To "dbComboForm_EZ"
43197>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Banka        To "’¨á§œ˜"
43198>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Banka        To "’¨á§œ˜"
43199>>>>>        Set Field_Value_Table      Field Baxio.Baxio_Banka        To (Baxio_Baxio_Banka_VT(Self))
43200>>>>>
43200>>>>>        // Baxio.Baxio_Opistho
43200>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Opistho      To "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
43201>>>>>
43201>>>>>        // Baxio.Baxio_No
43201>>>>>        Set Field_Label_Long       Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
43202>>>>>        Set Field_Label_Short      Field Baxio.Baxio_No           To "€¨ Ÿ£æª"
43203>>>>>
43203>>>>>        // Baxio.Baxio_V2
43203>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V2           To "¦©æ"
43204>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V2           To "¦©æ"
43205>>>>>        Set Field_Options          Field Baxio.Baxio_V2           To DD_REQUIRED
43206>>>>>
43206>>>>>        // Baxio.Baxio_V0
43206>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V0           To "¦©æ ‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª"
43207>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V0           To "¦©æ(‰¬¨. Œæ£.•¨.)"
43208>>>>>
43208>>>>>        // Baxio.Baxio_V00
43208>>>>>        Set Field_Label_Long       Field Baxio.Baxio_V00          To "¦©æ ƒœ¬«œ¨œç¦¤  Œæ£ ©£˜ •¨ã©œàª"
43209>>>>>        Set Field_Label_Short      Field Baxio.Baxio_V00          To "¦©æ(ƒœ¬«. Œæ£.•¨.)"
43210>>>>>
43210>>>>>        // Baxio.Baxio_Vr
43210>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Vr           To "¦©æ Œæ£ ©£˜ Reporting"
43211>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Vr           To "¦©æ( Œæ£.Rep.)"
43212>>>>>
43212>>>>>        // Baxio.Baxio_Rate0
43212>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate0        To "Rate 1"
43213>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate0        To "Rate 1"
43214>>>>>
43214>>>>>        // Baxio.Baxio_Rate00
43214>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rate00       To "Rate 2"
43215>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rate00       To "Rate 2"
43216>>>>>
43216>>>>>        // Baxio.Baxio_Rater
43216>>>>>        Set Field_Label_Long       Field Baxio.Baxio_Rater        To "Rate 3"
43217>>>>>        Set Field_Label_Short      Field Baxio.Baxio_Rater        To "Rate 3"
43218>>>>>
43218>>>>>        // Baxio.Baxio_C_Code2
43218>>>>>        Set Field_Class_Name       Field Baxio.Baxio_C_Code2      To "dbComboForm_EZ"
43219>>>>>        Set Field_Label_Long       Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
43220>>>>>        Set Field_Label_Short      Field Baxio.Baxio_C_Code2      To "Œæ£ ©£˜"
43221>>>>>        Set Field_Options          Field Baxio.Baxio_C_Code2      To DD_REQUIRED
43222>>>>>
43222>>>>>        // Baxio.Baxio_Lixi_Yyyy
43222>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Yyyy    To DD_DISPLAYONLY
43223>>>>>
43223>>>>>        // Baxio.Baxio_Lixi_Mm
43223>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Mm      To DD_DISPLAYONLY
43224>>>>>
43224>>>>>        // Baxio.Baxio_Lixi_Dd
43224>>>>>        Set Field_Options          Field Baxio.Baxio_Lixi_Dd      To DD_DISPLAYONLY
43225>>>>>
43225>>>>>        // Baxio.Baxio_Bmove_Laa
43225>>>>>        Set Field_Options          Field Baxio.Baxio_Bmove_Laa    To DD_DISPLAYONLY
43226>>>>>
43226>>>>>    End_Procedure    // Define_Fields
43227>>>>>
43227>>>>>
43227>>>>>    Procedure Field_Defaults
43228>>>>>        Forward Send Field_Defaults
43230>>>>>        //DDB-Generated-Code-Location
43230>>>>>        //DDB-FieldDefaultStart
43230>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Status To 1
43231>>>>>        Set Field_Changed_Value   Field Baxio.Baxio_Place To 1
43232>>>>>        //DDB-FieldDefaultEnd
43232>>>>>    End_Procedure    // Field_Defaults
43233>>>>>
43233>>>>>End_Class    // Baxio_DataDictionary
43234>>>>>//DDB-Selection-pkg-Start
43234>>>>>
43234>>>>>Use SL037.SL         // SL037
INCLUDING FILE: SL037.SL
43234>>>>>>>//AB/ Project SL037:BAXIO
43234>>>>>>>//AB/ Object prj is a Lookup_Project
43234>>>>>>>//AB/     Set ProjectName to "SL037:BAXIO"
43234>>>>>>>//AB/     Set ProjectFileName to "SL037.SL"
43234>>>>>>>
43234>>>>>>>// Project Object Structure
43234>>>>>>>//   SL037 is a dbModalPanelSub
43234>>>>>>>//     Baxiokat_DD is a DataDictionary
43234>>>>>>>//     Baxio_DD is a DataDictionary
43234>>>>>>>//     oSelList is a dbListSub
43234>>>>>>>//     TextBoxSub1 is a TextBoxSub
43234>>>>>>>//     cSyDateForm1 is a cSyDateForm
43234>>>>>>>//     TextBoxSub2 is a TextBoxSub
43234>>>>>>>//     cSyDateForm2 is a cSyDateForm
43234>>>>>>>//     TextBoxSub4 is a TextBoxSub
43234>>>>>>>//     TextBoxSub5 is a TextBoxSub
43234>>>>>>>//     FormSub1 is a FormSub
43234>>>>>>>//     FormSub2 is a FormSub
43234>>>>>>>//     FormSub3 is a FormSub
43234>>>>>>>//     FormSub4 is a FormSub
43234>>>>>>>//     ButtonSub1 is a ButtonSub
43234>>>>>>>//     oOK_bn is a ButtonSub
43234>>>>>>>
43234>>>>>>>// Register all objects
43234>>>>>>>Register_Object Baxio_DD
43234>>>>>>>Register_Object Baxiokat_DD
43234>>>>>>>Register_Object ButtonSub1
43234>>>>>>>Register_Object cSyDateForm1
43234>>>>>>>Register_Object cSyDateForm2
43234>>>>>>>Register_Object FormSub1
43234>>>>>>>Register_Object FormSub2
43234>>>>>>>Register_Object FormSub3
43234>>>>>>>Register_Object FormSub4
43234>>>>>>>Register_Object oOK_bn
43234>>>>>>>Register_Object oSelList
43234>>>>>>>Register_Object SL037
43234>>>>>>>Register_Object TextBoxSub1
43234>>>>>>>Register_Object TextBoxSub2
43234>>>>>>>Register_Object TextBoxSub4
43234>>>>>>>Register_Object TextBoxSub5
43234>>>>>>>
43234>>>>>>>
43234>>>>>>>
43234>>>>>>>//AB-StoreTopStart
43234>>>>>>>    
43234>>>>>>>Use sl100.sl
43234>>>>>>>
43234>>>>>>>
43234>>>>>>>//AB-StoreTopEnd
43234>>>>>>>
43234>>>>>>>//AB-IgnoreStart
43234>>>>>>>
43234>>>>>>>Use DFAllEnt.pkg
43234>>>>>>>Use dbList.Sub
43234>>>>>>>Use Txtbox.Sub
43234>>>>>>>Use cSyDateForm.Pkg
43234>>>>>>>Use Form.Sub
43234>>>>>>>Use Button.Sub
43234>>>>>>>
43234>>>>>>>
43234>>>>>>>Use BAXIOKAT.DD
43234>>>>>>>Use BAXIO.DD
43234>>>>>>>
43234>>>>>>>//AB-IgnoreEnd
43234>>>>>>>
43234>>>>>>>Object SL037 is a dbModalPanelSub
43236>>>>>>>
43236>>>>>>>    //AB-StoreTopStart
43236>>>>>>>                        
43236>>>>>>>    Property Integer piFragmaBaxiokatRec0 Public  0
43238>>>>>>>    Property Integer piFragmaBaxiokatCode Public  0
43240>>>>>>>    Property Integer piFragmaBaxioStatus  Public  0
43242>>>>>>>    Property Integer piFragmaBaxioPlace   Public  0
43244>>>>>>>    Property string  psfragmaclient       Public ''
43246>>>>>>>    Property String  psFragmaBaxioStatus  Public ''
43248>>>>>>>    Property String  psEkdoths            Public ''
43250>>>>>>>    Property String  psApodekths          Public ''
43252>>>>>>>    Property Date pdApo                   Public ''
43254>>>>>>>    Property Date pdEos                   Public ''
43256>>>>>>>    
43256>>>>>>>    //AB-StoreTopEnd
43256>>>>>>>
43256>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €¥ ¦š¨á­à¤"
43257>>>>>>>    Set Size to 287 527
43258>>>>>>>    Set Location to 2 3
43259>>>>>>>    Set Exit_Application_Local_State to FALSE
43260>>>>>>>    Set Modal_State to FALSE
43261>>>>>>>
43261>>>>>>>    //AB-DDOStart
43261>>>>>>>
43261>>>>>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
43263>>>>>>>    End_Object    // Baxiokat_DD
43264>>>>>>>
43264>>>>>>>    Object Baxio_DD is a Baxio_DataDictionary
43266>>>>>>>        Set DDO_Server to (Baxiokat_DD(self))
43267>>>>>>>
43267>>>>>>>        //AB-StoreStart
43267>>>>>>>                                                    
43267>>>>>>>        Function fiIsOK Returns Integer
43269>>>>>>>            String lsBaxioStatus sclient
43270>>>>>>>            Get psFragmaBaxioStatus  to lsBaxioStatus
43271>>>>>>>            Get psfragmaclient       to sclient
43272>>>>>>>            If (Trim(sClient)='') Begin
43274>>>>>>>                If (lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
43277>>>>>>>            End
43277>>>>>>>>
43277>>>>>>>            Else Begin
43278>>>>>>>                If (baxio.baxio_desm Eq sClient And lsBaxioStatus Contains Baxio.Baxio_Status) Function_Return 1
43281>>>>>>>            End
43281>>>>>>>>
43281>>>>>>>            Function_Return 0
43282>>>>>>>        End_Function
43283>>>>>>>        
43283>>>>>>>        Procedure OnConstrain
43285>>>>>>>        
43285>>>>>>>            Integer liBaxiokatCode liBaxioStatus liBaxioPlace
43286>>>>>>>            string  sclient lsBaxioStatus sApodekths sEkdoths
43286>>>>>>>            Date    dApo dEos
43286>>>>>>>        
43286>>>>>>>            Forward Send OnConstrain
43288>>>>>>>        
43288>>>>>>>            Get piFragmaBaxiokatCode    to liBaxiokatCode
43289>>>>>>>            Get psFragmaBaxioStatus     to lsBaxioStatus
43290>>>>>>>            Get piFragmaBaxioPlace      to liBaxioPlace
43291>>>>>>>        
43291>>>>>>>            Get psApodekths             to sApodekths
43292>>>>>>>            Get psEkdoths               to sEkdoths
43293>>>>>>>            Get pdApo                   to dApo
43294>>>>>>>            Get pdEos                   to dEos
43295>>>>>>>        
43295>>>>>>>            If (liBaxioKatCode <> 0) Begin
43297>>>>>>>                Constrain Baxio.Baxiokat_Code eq liBaxiokatCode
43299>>>>>>>                If (liBaxioPlace  <> 0)  Constrain Baxio.Baxio_Place eq liBaxioPlace
43303>>>>>>>                If (lsBaxioStatus <> '') Constrain Baxio as (fiIsOK(Self)=1)
43306>>>>>>>            End
43306>>>>>>>>
43306>>>>>>>        
43306>>>>>>>            If (sApodekths  <>'') Constrain Baxio.Baxio_Code_Out    Eq sApodekths
43310>>>>>>>            If (sEkdoths    <>'') Constrain Baxio.Baxio_Code_In     Eq sEkdoths
43314>>>>>>>            If (dApo        <>'') Constrain Baxio.Baxio_HmniaL      Ge dApo
43318>>>>>>>            If (dEos        <>'') Constrain Baxio.Baxio_HmniaL      Le dEos
43322>>>>>>>        
43322>>>>>>>        End_Procedure // OnConstrain
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        
43323>>>>>>>        //AB-StoreEnd
43323>>>>>>>
43323>>>>>>>    End_Object    // Baxio_DD
43324>>>>>>>
43324>>>>>>>    Set Main_DD to (Baxio_DD(self))
43325>>>>>>>    Set Server to (Baxio_DD(self))
43326>>>>>>>
43326>>>>>>>    //AB-DDOEnd
43326>>>>>>>
43326>>>>>>>    Object oSelList is a dbListSub
43328>>>>>>>        Set Main_File to Baxio.File_Number
43329>>>>>>>        Set Size to 228 514
43330>>>>>>>        Set Location to 4 6
43331>>>>>>>
43331>>>>>>>        Begin_Row
43334>>>>>>>            Entry_Item Baxio.Baxio_code
43335>>>>>>>            Entry_Item Baxio.Baxio_epon_in
43336>>>>>>>            Entry_Item Baxio.Baxio_epon_out
43337>>>>>>>            Entry_Item Baxiokat.Baxiokat_descr
43338>>>>>>>            Entry_Item Baxio.Baxio_hmnial
43339>>>>>>>            Entry_Item Baxio.Baxio_v2
43340>>>>>>>            Entry_Item Baxio.Baxio_banka
43341>>>>>>>            Entry_Item (Export_Code_Description(Self,6,Baxio.Baxio_banka))
43342>>>>>>>            Entry_Item Baxio.Baxio_no
43343>>>>>>>        End_Row
43348>>>>>>>
43348>>>>>>>        Set Form_Width    item 0 to 41
43349>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
43350>>>>>>>        
43350>>>>>>>        Set Form_Width    item 1 to 98
43351>>>>>>>        Set Header_Label  item 1 to "„¡›æ«žª"
43352>>>>>>>        
43352>>>>>>>        Set Form_Width    item 2 to 94
43353>>>>>>>        Set Header_Label  item 2 to "€§¦›â¡«žª"
43354>>>>>>>        
43354>>>>>>>        Set Form_Width    item 3 to 75
43355>>>>>>>        Set Header_Label  item 3 to "œ¨ š¨˜­ã"
43356>>>>>>>        
43356>>>>>>>        Set Form_Width    item 4 to 47
43357>>>>>>>        Set Header_Label  item 4 to "Šã¥ž"
43358>>>>>>>        
43358>>>>>>>        Set Form_Width    item 5 to 48
43359>>>>>>>        Set Header_Label  item 5 to "¦©æ"
43360>>>>>>>        
43360>>>>>>>        Set Form_Width    item 6 to 12
43361>>>>>>>        Set Header_Label  item 6 to "‰à› ¡æª ’¨á§œ˜"
43362>>>>>>>        
43362>>>>>>>        Set Form_Width    item 7 to 42
43363>>>>>>>        Set Header_Label  item 7 to "’¨á§œ˜"
43364>>>>>>>        
43364>>>>>>>        Set Form_Width    item 8 to 53
43365>>>>>>>        Set Header_Label  item 8 to "€¨ Ÿ£æª"
43366>>>>>>>        
43366>>>>>>>
43366>>>>>>>        //AB-StoreStart
43366>>>>>>>                
43366>>>>>>>        Property Integer piStoreFragmaBaxiokatRec0 Public 0
43368>>>>>>>        Property Integer piStoreFragmaBaxiokatCode Public 0
43370>>>>>>>        Property Integer piStoreFragmaBaxioStatus  Public 0
43372>>>>>>>        Property Integer piStoreFragmaBaxioPlace   Public 0
43374>>>>>>>        Property String  psStoreFragmaBaxioStatus  Public ''
43376>>>>>>>        
43376>>>>>>>        Procedure Store_Defaults
43378>>>>>>>            Forward Send Store_Defaults
43380>>>>>>>            Set piStoreFragmaBaxiokatRec0 to (piFragmaBaxiokatRec0(Self))
43381>>>>>>>            Set piStoreFragmaBaxiokatCode to (piFragmaBaxiokatCode(Self))
43382>>>>>>>            Set piStoreFragmaBaxioStatus  to (piFragmaBaxioStatus(Self))
43383>>>>>>>            Set piStoreFragmaBaxioPlace   to (piFragmaBaxioPlace(Self))
43384>>>>>>>            Set psStoreFragmaBaxioStatus  to (psFragmaBaxioStatus(Self))
43385>>>>>>>        End_Procedure // Store_Defaults
43386>>>>>>>        
43386>>>>>>>        Procedure Restore_Defaults
43388>>>>>>>            Forward Send Restore_Defaults
43390>>>>>>>            Set piFragmaBaxiokatRec0 to (piStoreFragmaBaxiokatRec0(Self))
43391>>>>>>>            Set piFragmaBaxiokatCode to (piStoreFragmaBaxiokatCode(Self))
43392>>>>>>>            Set piFragmaBaxioStatus  to (piStoreFragmaBaxioStatus(Self))
43393>>>>>>>            Set piFragmaBaxioPlace   to (piStoreFragmaBaxioPlace(Self))
43394>>>>>>>            Set psFragmaBaxioStatus  to (psStoreFragmaBaxioStatus(Self))
43395>>>>>>>        End_Procedure // Restore_Defaults
43396>>>>>>>        
43396>>>>>>>        Procedure Activating
43398>>>>>>>            Forward Send Activating
43400>>>>>>>         //   Set Auto_Index_State        to True
43400>>>>>>>            Send Rebuild_Constraints    to Baxio_DD
43401>>>>>>>        End_Procedure
43402>>>>>>>        
43402>>>>>>>        Procedure End_Construct_Object
43404>>>>>>>            Integer iDecs
43405>>>>>>>            Forward Send End_Construct_Object
43407>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0  to    iDecs
43408>>>>>>>            Set Points Item 5 to iDecs
43409>>>>>>>            Set Numeric_Mask Item 5 to 10 iDecs ' ,*'
43410>>>>>>>        End_Procedure
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        
43411>>>>>>>        //AB-StoreEnd
43411>>>>>>>
43411>>>>>>>    End_Object    // oSelList
43412>>>>>>>
43412>>>>>>>    Object TextBoxSub1 is a TextBoxSub
43414>>>>>>>        Set Label to "Šã¥ž ˜§¦"
43415>>>>>>>        Set Location to 241 7
43416>>>>>>>        Set Size to 10 35
43417>>>>>>>        Set TypeFace to "MS Sans Serif"
43418>>>>>>>    End_Object    // TextBoxSub1
43419>>>>>>>
43419>>>>>>>    Object cSyDateForm1 is a cSyDateForm
43421>>>>>>>        Set Size to 13 66
43422>>>>>>>        Set Location to 240 45
43423>>>>>>>        Set Label_Col_Offset to 2
43424>>>>>>>        Set Label_Justification_Mode to jMode_Right
43425>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
43426>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43427>>>>>>>
43427>>>>>>>        //AB-StoreStart
43427>>>>>>>                                                    
43427>>>>>>>        Procedure Key Integer iKey
43429>>>>>>>            Integer iRetVal
43430>>>>>>>            Forward Send Key iKey
43432>>>>>>>            If (iKey=277) Begin
43434>>>>>>>                Set Value Item 0 to ''
43435>>>>>>>                //Send KeyAction to ButtonSub1
43435>>>>>>>            End
43435>>>>>>>>
43435>>>>>>>        End_Procedure
43436>>>>>>>        
43436>>>>>>>        
43436>>>>>>>        //AB-StoreEnd
43436>>>>>>>
43436>>>>>>>    End_Object    // cSyDateForm1
43437>>>>>>>
43437>>>>>>>    Object TextBoxSub2 is a TextBoxSub
43439>>>>>>>        Set Label to "Šã¥ž œàª"
43440>>>>>>>        Set Location to 258 7
43441>>>>>>>        Set Size to 10 35
43442>>>>>>>        Set TypeFace to "MS Sans Serif"
43443>>>>>>>    End_Object    // TextBoxSub2
43444>>>>>>>
43444>>>>>>>    Object cSyDateForm2 is a cSyDateForm
43446>>>>>>>        Set Size to 13 66
43447>>>>>>>        Set Location to 256 45
43448>>>>>>>        Set Label_Col_Offset to 2
43449>>>>>>>        Set Label_Justification_Mode to jMode_Right
43450>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
43451>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43452>>>>>>>
43452>>>>>>>        //AB-StoreStart
43452>>>>>>>                                                    
43452>>>>>>>        Procedure Key Integer iKey
43454>>>>>>>            Integer iRetVal
43455>>>>>>>            Forward Send Key iKey
43457>>>>>>>            If (iKey=277) Begin
43459>>>>>>>                Set Value Item 0 to ''
43460>>>>>>>                //Send KeyAction to ButtonSub1
43460>>>>>>>            End
43460>>>>>>>>
43460>>>>>>>        End_Procedure
43461>>>>>>>        
43461>>>>>>>        
43461>>>>>>>        //AB-StoreEnd
43461>>>>>>>
43461>>>>>>>    End_Object    // cSyDateForm2
43462>>>>>>>
43462>>>>>>>    Object TextBoxSub4 is a TextBoxSub
43464>>>>>>>        Set Label to "„¡›æ«žª"
43465>>>>>>>        Set Location to 241 118
43466>>>>>>>        Set Size to 10 33
43467>>>>>>>        Set TypeFace to "MS Sans Serif"
43468>>>>>>>    End_Object    // TextBoxSub4
43469>>>>>>>
43469>>>>>>>    Object TextBoxSub5 is a TextBoxSub
43471>>>>>>>        Set Label to "€§¦›â¡«žª"
43472>>>>>>>        Set Location to 258 118
43473>>>>>>>        Set Size to 10 39
43474>>>>>>>        Set TypeFace to "MS Sans Serif"
43475>>>>>>>    End_Object    // TextBoxSub5
43476>>>>>>>
43476>>>>>>>    Object FormSub1 is a FormSub
43478>>>>>>>        Set Size to 13 77
43479>>>>>>>        Set Location to 240 159
43480>>>>>>>        Set Label_Col_Offset to 2
43481>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43482>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43483>>>>>>>
43483>>>>>>>        //AB-StoreStart
43483>>>>>>>                                                    
43483>>>>>>>        Set Prompt_Object to (sl100(Self))
43484>>>>>>>        
43484>>>>>>>        Procedure OnChange
43486>>>>>>>            String s1
43487>>>>>>>            Get Value Item 0 to s1
43488>>>>>>>            Set Value Of FormSub2 Item 0 to (fsClient(Self,s1))
43489>>>>>>>            Set psEkdoths to s1
43490>>>>>>>        End_Procedure
43491>>>>>>>        
43491>>>>>>>        
43491>>>>>>>        
43491>>>>>>>        
43491>>>>>>>        
43491>>>>>>>        
43491>>>>>>>        
43491>>>>>>>        //AB-StoreEnd
43491>>>>>>>
43491>>>>>>>    End_Object    // FormSub1
43492>>>>>>>
43492>>>>>>>    Object FormSub2 is a FormSub
43494>>>>>>>        Set Size to 13 187
43495>>>>>>>        Set Location to 240 240
43496>>>>>>>        Set Color to clBtnFace
43497>>>>>>>        Set Label_Col_Offset to 2
43498>>>>>>>        Set Enabled_State to FALSE
43499>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43500>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43501>>>>>>>        Set Shadow_State Item 0 to TRUE
43502>>>>>>>    End_Object    // FormSub2
43503>>>>>>>
43503>>>>>>>    Object FormSub3 is a FormSub
43505>>>>>>>        Set Size to 13 77
43506>>>>>>>        Set Location to 256 159
43507>>>>>>>        Set Label_Col_Offset to 2
43508>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
43509>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43510>>>>>>>
43510>>>>>>>        //AB-StoreStart
43510>>>>>>>                                                    
43510>>>>>>>        Set Prompt_Object to (sl100(Self))
43511>>>>>>>        
43511>>>>>>>        Procedure OnChange
43513>>>>>>>            String s1
43514>>>>>>>            Get Value Item 0 to s1
43515>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
43516>>>>>>>            Set psApodekths to s1
43517>>>>>>>        End_Procedure
43518>>>>>>>        
43518>>>>>>>        
43518>>>>>>>        
43518>>>>>>>        
43518>>>>>>>        
43518>>>>>>>        
43518>>>>>>>        
43518>>>>>>>        //AB-StoreEnd
43518>>>>>>>
43518>>>>>>>    End_Object    // FormSub3
43519>>>>>>>
43519>>>>>>>    Object FormSub4 is a FormSub
43521>>>>>>>        Set Size to 13 187
43522>>>>>>>        Set Location to 256 240
43523>>>>>>>        Set Color to clBtnFace
43524>>>>>>>        Set Label_Col_Offset to 2
43525>>>>>>>        Set Enabled_State to FALSE
43526>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43527>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
43528>>>>>>>        Set Shadow_State Item 0 to TRUE
43529>>>>>>>    End_Object    // FormSub4
43530>>>>>>>
43530>>>>>>>    Object ButtonSub1 is a ButtonSub
43532>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
43533>>>>>>>        Set Size to 14 43
43534>>>>>>>        Set Location to 256 430
43535>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43536>>>>>>>
43536>>>>>>>        //AB-StoreStart
43536>>>>>>>                                                    
43536>>>>>>>        Procedure OnClick
43538>>>>>>>            Date dApo dEos
43539>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dApo
43540>>>>>>>            Get Value Of cSyDateForm2 Item 0 to dEos
43541>>>>>>>            Set pdApo to dApo
43542>>>>>>>            Set pdEos to dEos
43543>>>>>>>            Send Rebuild_Constraints to Baxio_DD
43544>>>>>>>            Send Beginning_Of_Data to oSelList True
43545>>>>>>>        End_Procedure // OnClick
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        
43546>>>>>>>        //AB-StoreEnd
43546>>>>>>>
43546>>>>>>>    End_Object    // ButtonSub1
43547>>>>>>>
43547>>>>>>>    Object oOK_bn is a ButtonSub
43549>>>>>>>        Set Label to "&„§ ¢¦šã"
43550>>>>>>>        Set Size to 14 43
43551>>>>>>>        Set Location to 256 478
43552>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43553>>>>>>>
43553>>>>>>>        //AB-StoreStart
43553>>>>>>>        Procedure OnClick
43555>>>>>>>            Send OK To oSelList
43556>>>>>>>        End_Procedure
43557>>>>>>>        //AB-StoreEnd
43557>>>>>>>
43557>>>>>>>    End_Object    // oOK_bn
43558>>>>>>>
43558>>>>>>>
43558>>>>>>>    //AB-StoreStart
43558>>>>>>>                        
43558>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To oOk_bn
43559>>>>>>>    
43559>>>>>>>    Procedure Request_Cancel
43561>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
43562>>>>>>>        Set Value Of cSyDateForm2 Item 0 to ''
43563>>>>>>>        Set Value Of FormSub1     Item 0 to ''
43564>>>>>>>        Set Value Of FormSub2     Item 0 to ''
43565>>>>>>>        Forward Send Request_Cancel
43567>>>>>>>    End_Procedure
43568>>>>>>>    
43568>>>>>>>    
43568>>>>>>>    
43568>>>>>>>    
43568>>>>>>>    
43568>>>>>>>    //AB-StoreEnd
43568>>>>>>>
43568>>>>>>>End_Object    // SL037
43569>>>>>>>
43569>>>>>>>
43569>>>>>>>//AB-StoreStart
43569>>>>>>>    
43569>>>>>>>//AB-StoreEnd
43569>>>>>>>
43569>>>>>>>//AB/ End_Object    // prj
43569>>>>>Use slnomism.sl      // slNomism
INCLUDING FILE: SLNOMISM.SL
43569>>>>>>>//AB/ Project slNomism
43569>>>>>>>//AB/ Object prj is a Lookup_Project
43569>>>>>>>//AB/     Set ProjectName to "slNomism"
43569>>>>>>>//AB/     Set ProjectFileName to "slNomism.SL"
43569>>>>>>>//AB/     Set GenerateFileName to "NONAME"
43569>>>>>>>
43569>>>>>>>// Project Object Structure
43569>>>>>>>//   slNomism is a dbModalPanelSub
43569>>>>>>>//     Nomisma_DD is a DataDictionary
43569>>>>>>>//     oSelList is a dbListSub
43569>>>>>>>//     oOK_bn is a ButtonSub
43569>>>>>>>//     oSearch_bn is a ButtonSub
43569>>>>>>>
43569>>>>>>>// Register all objects
43569>>>>>>>Register_Object Nomisma_DD
43569>>>>>>>Register_Object oOK_bn
43569>>>>>>>Register_Object oSearch_bn
43569>>>>>>>Register_Object oSelList
43569>>>>>>>Register_Object slNomism
43569>>>>>>>
43569>>>>>>>
43569>>>>>>>//AB-IgnoreStart
43569>>>>>>>
43569>>>>>>>Use DFAllEnt.pkg
43569>>>>>>>Use dbList.Sub
43569>>>>>>>Use Button.Sub
43569>>>>>>>
43569>>>>>>>
43569>>>>>>>Use NOMISMA.DD
INCLUDING FILE: NOMISMA.DD
43569>>>>>>>>>//DDB-FileStart
43569>>>>>>>>>//DDB-HeaderStart
43569>>>>>>>>>
43569>>>>>>>>>// File Name : NOMISMA.DD
43569>>>>>>>>>// Class Name: Nomisma_DataDictionary
43569>>>>>>>>>// Revision  : 52
43569>>>>>>>>>// Version   : 2
43569>>>>>>>>>
43569>>>>>>>>>Use  Windows           // Basic Definitions
43569>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
43569>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43569>>>>>>>>>
43569>>>>>>>>>Open Nomisma
43571>>>>>>>>>Open Isotimia
43573>>>>>>>>>Open Particle
43575>>>>>>>>>
43575>>>>>>>>>//DDB-HeaderEnd
43575>>>>>>>>>//DDB-ValidationStart
43575>>>>>>>>>
43575>>>>>>>>>Register_Object Nomisma_Nomisma_Type_VT
43575>>>>>>>>>Register_Object Nomisma_Nomisma_Sign0_VT
43575>>>>>>>>>Register_Object Nomisma_Nomisma_Sign00_VT
43575>>>>>>>>>Register_Object Nomisma_Nomisma_Signr_VT
43575>>>>>>>>>
43575>>>>>>>>>Object Nomisma_Nomisma_Type_VT  is a DescriptionValidationTable
43577>>>>>>>>>
43577>>>>>>>>>    Procedure Fill_List
43579>>>>>>>>>        Forward Send Fill_List
43581>>>>>>>>>        Send Add_Table_Value  "1"  "Book1"
43582>>>>>>>>>        Send Add_Table_Value  "2"  "Book2"
43583>>>>>>>>>        Send Add_Table_Value  "3"  "Reporting"
43584>>>>>>>>>        Send Add_Table_Value  "0"  "Other"
43585>>>>>>>>>    End_Procedure    // Fill_List
43586>>>>>>>>>    //DDB-ValidationCustomStart
43586>>>>>>>>>    //DDB-ValidationCustomEnd
43586>>>>>>>>>End_Object   // Nomisma_Nomisma_Type_VT
43587>>>>>>>>>
43587>>>>>>>>>Object Nomisma_Nomisma_Sign0_VT  is a DescriptionValidationTable
43589>>>>>>>>>
43589>>>>>>>>>    Procedure Fill_List
43591>>>>>>>>>        Forward Send Fill_List
43593>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
43594>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
43595>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨œ¯ £¦"
43596>>>>>>>>>    End_Procedure    // Fill_List
43597>>>>>>>>>    //DDB-ValidationCustomStart
43597>>>>>>>>>    //DDB-ValidationCustomEnd
43597>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign0_VT
43598>>>>>>>>>
43598>>>>>>>>>Object Nomisma_Nomisma_Sign00_VT  is a DescriptionValidationTable
43600>>>>>>>>>
43600>>>>>>>>>    Procedure Fill_List
43602>>>>>>>>>        Forward Send Fill_List
43604>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
43605>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
43606>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
43607>>>>>>>>>    End_Procedure    // Fill_List
43608>>>>>>>>>    //DDB-ValidationCustomStart
43608>>>>>>>>>    //DDB-ValidationCustomEnd
43608>>>>>>>>>End_Object   // Nomisma_Nomisma_Sign00_VT
43609>>>>>>>>>
43609>>>>>>>>>Object Nomisma_Nomisma_Signr_VT  is a DescriptionValidationTable
43611>>>>>>>>>
43611>>>>>>>>>    Procedure Fill_List
43613>>>>>>>>>        Forward Send Fill_List
43615>>>>>>>>>        Send Add_Table_Value  "1"  "¦¢¢˜§¢˜© ˜æ£œ¤¦ œ§  «¦¬"
43616>>>>>>>>>        Send Add_Table_Value  "2"  "ƒ ˜ ¨¦ç£œ¤¦ › ˜ «¦¬"
43617>>>>>>>>>        Send Add_Table_Value  "0"  "‹ž ‹œ«˜«¨â¯ £¦"
43618>>>>>>>>>    End_Procedure    // Fill_List
43619>>>>>>>>>    //DDB-ValidationCustomStart
43619>>>>>>>>>    //DDB-ValidationCustomEnd
43619>>>>>>>>>End_Object   // Nomisma_Nomisma_Signr_VT
43620>>>>>>>>>//DDB-ValidationEnd
43620>>>>>>>>>//DDB-SelectionStart
43620>>>>>>>>>//DDB/ ExternalSelectionList sl059  sl059.sl
43620>>>>>>>>>Register_Object sl059
43620>>>>>>>>>//DDB-SelectionEnd
43620>>>>>>>>>
43620>>>>>>>>>Class Nomisma_DataDictionary  is a DataDictionary_Sec
43621>>>>>>>>>
43621>>>>>>>>>    Procedure Construct_Object
43622>>>>>>>>>        Forward Send Construct_Object
43624>>>>>>>>>        Property String psOldCode Public ''
43625>>>>>>>>>    End_procedure
43626>>>>>>>>>
43626>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
43627>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
43629>>>>>>>>>        Set psOldCode to Nomisma.Nomisma_Code
43630>>>>>>>>>    End_Procedure   // New_Current_Record
43631>>>>>>>>>
43631>>>>>>>>>    Procedure Save_Main_File
43632>>>>>>>>>        If ((Operation_Origin<>Self) And;             (Nomisma.Recnum=0)) Procedure_Return
43635>>>>>>>>>        Forward Send Save_Main_File
43637>>>>>>>>>    End_Procedure   // Save_Main_File
43638>>>>>>>>>
43638>>>>>>>>>    Function Validate_Save  Returns Integer
43639>>>>>>>>>        Local Integer iReturnVal 
43640>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
43642>>>>>>>>>        If (Not(iReturnVal)) ;            Begin
43644>>>>>>>>>                     If  Nomisma.nomisma_Code eq ''                 Move 6220 to iReturnVal
43647>>>>>>>>>                Else If (Nomisma.Nomisma_Code <>(psOldCode(Self)) And ;                         (psOldCode(Self)<>''))  Move 6030 to iReturnVal
43651>>>>>>>>>                if iReturnVal Send Operation_Not_Allowed iReturnVal
43654>>>>>>>>>            End
43654>>>>>>>>>>
43654>>>>>>>>>        Function_Return iReturnVal
43655>>>>>>>>>    End_Function   // Validate_Save
43656>>>>>>>>>
43656>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
43657>>>>>>>>>             if iError_num eq 6220 error 6220 "Œ¦£ ©£˜«˜ => ‰à› ¡æª ¡œ¤æª "
43660>>>>>>>>>        Else if iError_num eq 6030 error 6030 "„§ ¢â¥«œ ¤æ£ ©£˜ ˜§¦ «ž¤ ¢å©«˜ £œ (F4)\nž §˜«ã©«œ §¨é«˜ F5 ©«¦ ž›ž ¬§á¨®¦¤\nà©«œ ¤˜ ¡˜Ÿ˜¨å©œ  ž ˜¨® ¡ã «¦¬ « £ã\n§¨å¤ œ§ ¢â¥œ«œ á¢¢¦"
43664>>>>>>>>>        //Else if iError_num eq 6030 error 6030 "ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ©«¦ ¡à› ¡æ ¤¦£å©£˜«¦ª"
43664>>>>>>>>>        else Forward Send Operation_Not_Allowed  iError_Num
43667>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
43668>>>>>>>>>
43668>>>>>>>>>    Procedure Update
43669>>>>>>>>>        Forward Send Update
43671>>>>>>>>>        // Insert Code Here
43671>>>>>>>>>        SYSDATE NOMISMA.LUP
43672>>>>>>>>>    End_Procedure   // Update
43673>>>>>>>>>
43673>>>>>>>>>    Procedure Creating
43674>>>>>>>>>        Forward Send Creating
43676>>>>>>>>>        // Insert Code Here
43676>>>>>>>>>        SYSDATE NOMISMA.FUP
43677>>>>>>>>>    End_Procedure   // Creating
43678>>>>>>>>>
43678>>>>>>>>>    // Define_Fields:
43678>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
43678>>>>>>>>>
43678>>>>>>>>>    Procedure Define_Fields
43679>>>>>>>>>        Forward Send Define_Fields
43681>>>>>>>>>        //DDB-Generated-Code-Location
43681>>>>>>>>>        //DDB-DefineFieldStart
43681>>>>>>>>>
43681>>>>>>>>>        Set Main_File            To Nomisma.File_Number
43682>>>>>>>>>        Set Cascade_Delete_State To FALSE
43683>>>>>>>>>
43683>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
43684>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
43685>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43686>>>>>>>>>
43686>>>>>>>>>        // Child (Client) file structure................
43686>>>>>>>>>        Send Add_Client_File  Isotimia.File_Number
43687>>>>>>>>>        Send Add_Client_File  Particle.File_Number
43688>>>>>>>>>
43688>>>>>>>>>        // Field-based properties.......................
43688>>>>>>>>>
43688>>>>>>>>>        // Nomisma.Nomisma_Code
43688>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Code To DD_AUTOFIND    DD_CAPSLOCK   
43689>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Code To (sl059(Self))
43690>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Code To TRUE
43691>>>>>>>>>
43691>>>>>>>>>        // Nomisma.Nomisma_Descr
43691>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Descr To DD_CAPSLOCK   
43692>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Descr To (sl059(Self))
43693>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Descr To TRUE
43694>>>>>>>>>
43694>>>>>>>>>        // Nomisma.Nomisma_Short
43694>>>>>>>>>        Set Field_Options          Field Nomisma.Nomisma_Short To DD_CAPSLOCK   
43695>>>>>>>>>        Set Field_Prompt_Object    Field Nomisma.Nomisma_Short To (sl059(Self))
43696>>>>>>>>>        Set Key_Field_State        Field Nomisma.Nomisma_Short To TRUE
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Dekadika
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Fup
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Lup
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Euro_Zone
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Einai_Drx
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Einai_Euro
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Monades
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Kl_Isot_Euro
43697>>>>>>>>>
43697>>>>>>>>>        // Nomisma.Nomisma_Type
43697>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Type To (Nomisma_Nomisma_Type_VT(Self))
43698>>>>>>>>>
43698>>>>>>>>>        // Nomisma.Nomisma_Sign0
43698>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign0 To (Nomisma_Nomisma_Sign0_VT(Self))
43699>>>>>>>>>
43699>>>>>>>>>        // Nomisma.Nomisma_Sign00
43699>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Sign00 To (Nomisma_Nomisma_Sign00_VT(Self))
43700>>>>>>>>>
43700>>>>>>>>>        // Nomisma.Nomisma_Signr
43700>>>>>>>>>        Set Field_Value_Table      Field Nomisma.Nomisma_Signr To (Nomisma_Nomisma_Signr_VT(Self))
43701>>>>>>>>>
43701>>>>>>>>>        //DDB-DefineFieldEnd
43701>>>>>>>>>    End_Procedure    // Define_Fields
43702>>>>>>>>>
43702>>>>>>>>>    // Field_Defaults:
43702>>>>>>>>>    // This procedure is used to establish default field values.
43702>>>>>>>>>
43702>>>>>>>>>    Procedure Field_Defaults
43703>>>>>>>>>        Forward Send Field_Defaults
43705>>>>>>>>>        //DDB-Generated-Code-Location
43705>>>>>>>>>        //DDB-FieldDefaultStart
43705>>>>>>>>>        //DDB-FieldDefaultEnd
43705>>>>>>>>>    End_Procedure    // Field_Defaults
43706>>>>>>>>>
43706>>>>>>>>>End_Class    // Nomisma_DataDictionary
43707>>>>>>>>>//DDB-Selection-pkg-Start
43707>>>>>>>>>
43707>>>>>>>>>Use sl059.sl         // sl059
INCLUDING FILE: SL059.SL
43707>>>>>>>>>>>//AB/ Project sl059
43707>>>>>>>>>>>//AB/     Object prj is a LOOKUP_Project
43707>>>>>>>>>>>//AB/         Set ProjectName to "sl059"
43707>>>>>>>>>>>//AB/         Set ProjectFileName to "sl059.SL"
43707>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
43707>>>>>>>>>>>
43707>>>>>>>>>>>    //AB-IgnoreStart
43707>>>>>>>>>>>
43707>>>>>>>>>>>
43707>>>>>>>>>>>
43707>>>>>>>>>>>
43707>>>>>>>>>>>    Use NOMISMA.DD
43707>>>>>>>>>>>
43707>>>>>>>>>>>    //AB-IgnoreEnd
43707>>>>>>>>>>>
43707>>>>>>>>>>>    CD_Popup_Object sl059 is a dbModalPanelSub
43726>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
43727>>>>>>>>>>>        Set Modal_State to FALSE
43728>>>>>>>>>>>        Set Popup_State to FALSE
43729>>>>>>>>>>>        Set Minimize_Icon to FALSE
43730>>>>>>>>>>>        set label to "Œ¦£å©£˜«˜" 
43731>>>>>>>>>>>        Set Size to 148 295
43732>>>>>>>>>>>        Set Location to 4 5
43733>>>>>>>>>>>
43733>>>>>>>>>>>        //AB-DDOStart
43733>>>>>>>>>>>
43733>>>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
43735>>>>>>>>>>>        End_Object    // Nomisma_DD
43736>>>>>>>>>>>
43736>>>>>>>>>>>        Set Main_DD to (Nomisma_DD(Current_Object))
43737>>>>>>>>>>>        Set Server to (Nomisma_DD(Current_Object))
43738>>>>>>>>>>>
43738>>>>>>>>>>>        //AB-DDOEnd
43738>>>>>>>>>>>
43738>>>>>>>>>>>        Object oSelList is a dbListSub
43740>>>>>>>>>>>            Set Main_File to Nomisma.File_Number
43741>>>>>>>>>>>            Set Size to 105 278
43742>>>>>>>>>>>            Set Location to 6 6
43743>>>>>>>>>>>
43743>>>>>>>>>>>            Begin_Row
43746>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_code
43747>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_descr
43748>>>>>>>>>>>                Entry_Item Nomisma.Nomisma_short
43749>>>>>>>>>>>                Entry_Item Nomisma.Dekadika
43750>>>>>>>>>>>            End_Row
43755>>>>>>>>>>>
43755>>>>>>>>>>>            Set Form_Width    item 0 to 45
43756>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
43757>>>>>>>>>>>
43757>>>>>>>>>>>            Set Form_Width    item 1 to 115
43758>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
43759>>>>>>>>>>>
43759>>>>>>>>>>>            Set Form_Width    item 2 to 58
43760>>>>>>>>>>>            set header_label  item 2 to "‘ç¤«¦£ž" 
43761>>>>>>>>>>>
43761>>>>>>>>>>>            Set Form_Width    item 3 to 54
43762>>>>>>>>>>>            set header_label  item 3 to "ƒœ¡˜› ¡á" 
43763>>>>>>>>>>>
43763>>>>>>>>>>>        End_Object    // oSelList
43764>>>>>>>>>>>
43764>>>>>>>>>>>        Object oOK_bn is a ButtonSub
43766>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
43767>>>>>>>>>>>            Set Location to 113 124
43768>>>>>>>>>>>
43768>>>>>>>>>>>            //AB-StoreStart
43768>>>>>>>>>>>            Procedure OnClick
43770>>>>>>>>>>>                Send OK To (oSelList(current_object))
43771>>>>>>>>>>>            End_Procedure
43772>>>>>>>>>>>            //AB-StoreEnd
43772>>>>>>>>>>>
43772>>>>>>>>>>>        End_Object    // oOK_bn
43773>>>>>>>>>>>
43773>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
43775>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
43776>>>>>>>>>>>            Set Location to 113 179
43777>>>>>>>>>>>
43777>>>>>>>>>>>            //AB-StoreStart
43777>>>>>>>>>>>            Procedure OnClick
43779>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
43780>>>>>>>>>>>            End_Procedure
43781>>>>>>>>>>>            //AB-StoreEnd
43781>>>>>>>>>>>
43781>>>>>>>>>>>        End_Object    // oCancel_bn
43782>>>>>>>>>>>
43782>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
43784>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
43785>>>>>>>>>>>            Set Location to 113 234
43786>>>>>>>>>>>
43786>>>>>>>>>>>            //AB-StoreStart
43786>>>>>>>>>>>            Procedure OnClick
43788>>>>>>>>>>>                Send Search To (oSelList(current_object))
43789>>>>>>>>>>>            End_Procedure
43790>>>>>>>>>>>            //AB-StoreEnd
43790>>>>>>>>>>>
43790>>>>>>>>>>>        End_Object    // oSearch_bn
43791>>>>>>>>>>>
43791>>>>>>>>>>>
43791>>>>>>>>>>>        //AB-StoreStart
43791>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43792>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
43793>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
43794>>>>>>>>>>>        //AB-StoreEnd
43794>>>>>>>>>>>
43794>>>>>>>>>>>    CD_End_Object    // sl059
43796>>>>>>>>>>>>
43796>>>>>>>>>>>
43796>>>>>>>>>>>//AB/     End_Object    // prj
43796>>>>>>>>>
43796>>>>>>>>>//DDB-Selection-pkg-End
43796>>>>>>>>>//DDB-FileEnd
43796>>>>>>>
43796>>>>>>>//AB-IgnoreEnd
43796>>>>>>>
43796>>>>>>>Object slNomism is a dbModalPanelSub
43798>>>>>>>
43798>>>>>>>    //AB-StoreTopStart
43798>>>>>>>    
43798>>>>>>>    
43798>>>>>>>    
43798>>>>>>>    //AB-StoreTopEnd
43798>>>>>>>
43798>>>>>>>    Set Label to "Œ¦£å©£˜«˜"
43799>>>>>>>    Set Size to 175 397
43800>>>>>>>    Set Location to 5 7
43801>>>>>>>    Set Exit_Application_Local_State to FALSE
43802>>>>>>>    Set Modal_State to FALSE
43803>>>>>>>
43803>>>>>>>    //AB-DDOStart
43803>>>>>>>
43803>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
43805>>>>>>>    End_Object    // Nomisma_DD
43806>>>>>>>
43806>>>>>>>    Set Main_DD to (Nomisma_DD(self))
43807>>>>>>>    Set Server to (Nomisma_DD(self))
43808>>>>>>>
43808>>>>>>>    //AB-DDOEnd
43808>>>>>>>
43808>>>>>>>    Object oSelList is a dbListSub
43810>>>>>>>        Set Main_File to Nomisma.File_Number
43811>>>>>>>        Set Size to 130 382
43812>>>>>>>        Set Location to 6 6
43813>>>>>>>
43813>>>>>>>        Begin_Row
43816>>>>>>>            Entry_Item Nomisma.Nomisma_code
43817>>>>>>>            Entry_Item Nomisma.Nomisma_descr
43818>>>>>>>            Entry_Item Nomisma.Dekadika
43819>>>>>>>            Entry_Item Nomisma.Euro_zone
43820>>>>>>>            Entry_Item Nomisma.Einai_drx
43821>>>>>>>            Entry_Item Nomisma.Einai_euro
43822>>>>>>>        End_Row
43827>>>>>>>
43827>>>>>>>        Set Form_Width    item 0 to 49
43828>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
43829>>>>>>>        
43829>>>>>>>        Set Form_Width    item 1 to 115
43830>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
43831>>>>>>>        
43831>>>>>>>        Set Form_Width    item 2 to 47
43832>>>>>>>        Set Header_Label  item 2 to "ƒœ¡˜› ¡á"
43833>>>>>>>        
43833>>>>>>>        Set Form_Width    item 3 to 55
43834>>>>>>>        Set Header_Label  item 3 to "…é¤ž EURO"
43835>>>>>>>        Set Column_Checkbox_State  item 3 to True
43836>>>>>>>        
43836>>>>>>>        Set Form_Width    item 4 to 55
43837>>>>>>>        Set Header_Label  item 4 to "„å¤˜  ƒ•"
43838>>>>>>>        Set Column_Checkbox_State  item 4 to True
43839>>>>>>>        
43839>>>>>>>        Set Form_Width    item 5 to 55
43840>>>>>>>        Set Header_Label  item 5 to "„å¤˜  „¬¨é"
43841>>>>>>>        Set Column_Checkbox_State  item 5 to True
43842>>>>>>>        
43842>>>>>>>
43842>>>>>>>        //AB-StoreStart
43842>>>>>>>        
43842>>>>>>>        //AB-StoreEnd
43842>>>>>>>
43842>>>>>>>    End_Object    // oSelList
43843>>>>>>>
43843>>>>>>>    Object oOK_bn is a ButtonSub
43845>>>>>>>        Set Label to "&„§ ¢¦šã"
43846>>>>>>>        Set Location to 140 279
43847>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43848>>>>>>>
43848>>>>>>>        //AB-StoreStart
43848>>>>>>>        Procedure OnClick
43850>>>>>>>            Send OK To (oSelList(current_object))
43851>>>>>>>        End_Procedure
43852>>>>>>>        //AB-StoreEnd
43852>>>>>>>
43852>>>>>>>    End_Object    // oOK_bn
43853>>>>>>>
43853>>>>>>>    Object oSearch_bn is a ButtonSub
43855>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
43856>>>>>>>        Set Location to 140 339
43857>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43858>>>>>>>
43858>>>>>>>        //AB-StoreStart
43858>>>>>>>        
43858>>>>>>>        Procedure OnClick
43860>>>>>>>            Send Search To (oSelList(current_object))
43861>>>>>>>        End_Procedure
43862>>>>>>>        
43862>>>>>>>        
43862>>>>>>>        Set Visible_State to False
43863>>>>>>>        Set Enabled_State to False
43864>>>>>>>        //AB-StoreEnd
43864>>>>>>>
43864>>>>>>>    End_Object    // oSearch_bn
43865>>>>>>>
43865>>>>>>>
43865>>>>>>>    //AB-StoreStart
43865>>>>>>>    
43865>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
43866>>>>>>>    
43866>>>>>>>    On_Key Key_Alt+Key_s Send KeyAction To (oSearch_bn(current_object))
43867>>>>>>>    
43867>>>>>>>    
43867>>>>>>>    
43867>>>>>>>    
43867>>>>>>>    //AB-StoreEnd
43867>>>>>>>
43867>>>>>>>End_Object    // slNomism
43868>>>>>>>
43868>>>>>>>//AB/ End_Object    // prj
43868>>>>>
43868>>>>>//DDB-Selection-pkg-End
43868>>>>>//DDB-FileEnd
43868>>>Use SYSCURXR.DD
INCLUDING FILE: SYSCURXR.DD
43868>>>>>//DDB-FileStart
43868>>>>>//DDB-HeaderStart
43868>>>>>
43868>>>>>// File Name : SYSCURXR.DD
43868>>>>>// Class Name: Syscurxr_DataDictionary
43868>>>>>// Revision  : 8
43868>>>>>// Version   : 2
43868>>>>>
43868>>>>>Use  Windows           // Basic Definitions
43868>>>>>Use  DataDict          // DataDictionary Class Definition
43868>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43868>>>>>
43868>>>>>Open Syscurxr
43870>>>>>
43870>>>>>//DDB-HeaderEnd
43870>>>>>
43870>>>>>Class Syscurxr_DataDictionary  is a DataDictionary_Sec
43871>>>>>
43871>>>>>    // Define_Fields:
43871>>>>>    // This procedure is used to set up all data-dictionary rules.
43871>>>>>
43871>>>>>    Procedure Define_Fields
43872>>>>>        Forward Send Define_Fields
43874>>>>>        //DDB-Generated-Code-Location
43874>>>>>        //DDB-DefineFieldStart
43874>>>>>
43874>>>>>        Set Main_File            To Syscurxr.File_Number
43875>>>>>
43875>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
43876>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
43877>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
43878>>>>>
43878>>>>>        // Field-based properties.......................
43878>>>>>
43878>>>>>        // Syscurxr.Company_Code
43878>>>>>
43878>>>>>        // Syscurxr.Branch_Code
43878>>>>>
43878>>>>>        // Syscurxr.Year_Year
43878>>>>>
43878>>>>>        // Syscurxr.Branch_Site
43878>>>>>
43878>>>>>        // Syscurxr.Year_Recr
43878>>>>>
43878>>>>>        // Syscurxr.Company_Name
43878>>>>>
43878>>>>>        // Syscurxr.Branch_Name
43878>>>>>
43878>>>>>        // Syscurxr.Year_Descr
43878>>>>>
43878>>>>>        // Syscurxr.C_Code0
43878>>>>>
43878>>>>>        // Syscurxr.C_Code00
43878>>>>>
43878>>>>>        // Syscurxr.C_Coder
43878>>>>>
43878>>>>>        // Syscurxr.Year_Xrhshfrom
43878>>>>>
43878>>>>>        // Syscurxr.Year_Xrhshto
43878>>>>>
43878>>>>>        // Syscurxr.Beto_Site
43878>>>>>
43878>>>>>        // Syscurxr.Euro_Code
43878>>>>>
43878>>>>>        //DDB-DefineFieldEnd
43878>>>>>    End_Procedure    // Define_Fields
43879>>>>>
43879>>>>>    // Field_Defaults:
43879>>>>>    // This procedure is used to establish default field values.
43879>>>>>
43879>>>>>    Procedure Field_Defaults
43880>>>>>        Forward Send Field_Defaults
43882>>>>>        //DDB-Generated-Code-Location
43882>>>>>        //DDB-FieldDefaultStart
43882>>>>>        //DDB-FieldDefaultEnd
43882>>>>>    End_Procedure    // Field_Defaults
43883>>>>>
43883>>>>>End_Class    // Syscurxr_DataDictionary
43884>>>>>//DDB-FileEnd
43884>>>Use BMOVE.DD
INCLUDING FILE: BMOVE.DD
43884>>>>>//DDB-FileStart
43884>>>>>//DDB-HeaderStart
43884>>>>>
43884>>>>>// File Name : BMOVE.DD
43884>>>>>// Class Name: Bmove_DataDictionary
43884>>>>>// Revision  : 51
43884>>>>>// Version   : 2
43884>>>>>
43884>>>>>Use  Windows           // Basic Definitions
43884>>>>>Use  DataDict          // DataDictionary Class Definition
43884>>>>>Use  DDvalTbl          // Validation Table Class Definitions
43884>>>>>
43884>>>>>Open Bmove
43886>>>>>Open Barticl
43888>>>>>Open Baxio
43890>>>>>Open Sysrecb
43892>>>>>Open Bkinkat
43894>>>>>Open Bsum
43896>>>>>
43896>>>>>//DDB-HeaderEnd
43896>>>>>
43896>>>>>      //§ Ÿ˜¤¦å ©¬¤›¬˜©£¦å « £é¤ «à¤ bkinkat.baxio_stat_from + bkinkat.baxio_stat_to
43896>>>>>      //  ˜§¦          ©œ
43896>>>>>      //    0           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43896>>>>>      //    0           1    â ©˜šàšã ©«¦ ®˜¨«¦­¬¢á¡ ¦ (create a new baxio (33.90))
43896>>>>>      //    0           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦  (create a new baxio (53.90))
43896>>>>>
43896>>>>>      //    1           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43896>>>>>      //    1           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43896>>>>>      //    1           2    â¥˜šàšã ˜§¦ ®˜¨«¦­¬¢á¡ ¦
43896>>>>>
43896>>>>>      //    2           0    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43896>>>>>      //    2           1    ˜ › ç ¤ ˜ « ¦ ¤  (validate save «¦¬ bkinkat)
43896>>>>>      //    2           2    £œ«˜™å™˜©ž §® ˜§¦ «¨á§œ˜ ©œ «¨á§œ˜
43896>>>>>
43896>>>>>
43896>>>>>Open SysCurXr
43898>>>>>Open Baxiokat
43900>>>>>Open Btypkin
43902>>>>>Open Bkinkat
43904>>>>>Open Baxio
43906>>>>>
43906>>>>>Class Bmove_DataDictionary  is a DataDictionary_Sec
43907>>>>>
43907>>>>>      Procedure Construct_Object
43908>>>>>                Forward Send Construct_Object
43910>>>>>
43910>>>>>                Property Integer piCan_Create_Baxio (FALSE)
43911>>>>>
43911>>>>>                //object id «é¤ ddo servers š ˜ «á barticl+bmove+baxio+baxiokat
43911>>>>>                //©œ«á¨¦¤«˜  ˜§¦ «ž¤ end_construct
43911>>>>>                //®¨ž© £œç¦¬¤ ©«ž¤ private.exit_btypkin_code
43911>>>>>                //š ˜ ¤˜ ©œ«á¨¦¬¤ «¦ visual interface
43911>>>>>                Property Integer piBarticl_dd        0
43912>>>>>                Property Integer piBaxio_dd          0
43913>>>>>                Property Integer piBtypkin_dd        0
43914>>>>>                Property Integer piBaxiokat_dd       0
43915>>>>>                Property Integer piBaxio_Status_From 0
43916>>>>>                Property Integer piBaxio_Status_To   0
43917>>>>>
43917>>>>>                Property Integer piCreated_Bmove  0 //©œ«á¨œ«˜  ©«ž¤ creating,
43918>>>>>                                                    //®¨ž© £¦§¦ œå«˜  ©«ž¤ update+validate_save ¡˜ 
43918>>>>>                                                    //£ž›œ¤åœ«˜  ©«ž¤ request_save & delete «¦¬ bmove
43918>>>>>
43918>>>>>                Property Integer piB_Baxio_Status  0
43919>>>>>                Property Integer piA_Baxio_Status  0
43920>>>>>
43920>>>>>                //19 §˜¢˜ âª « £âª
43920>>>>>                Property  Integer piB_Garticl_Rec0           0
43921>>>>>                Property  Integer piB_Gtypkin_Rec0           0
43922>>>>>                Property  Date    pdB_Garticl_Hmnia          0
43923>>>>>                Property  Integer piB_Garticl_No             0
43924>>>>>                Property  String  psB_Garticl_C_Code2        0
43925>>>>>                Property  Number  pnB_Garticl_Rate0          0
43926>>>>>                Property  Number  pnB_Garticl_Rate00         0
43927>>>>>                Property  Number  pnB_Garticl_RateR          0
43928>>>>>                Property  String  psB_Garticl_Aitiol         0
43929>>>>>
43929>>>>>                Property  Integer piB_Gmove_Master_Rec0      0
43930>>>>>                Property  Integer piB_Gplan_Master_Rec0      0
43931>>>>>                Property  Number  pnB_Gmove_Master_X2        0
43932>>>>>                Property  Number  pnB_Gmove_Master_P2        0
43933>>>>>                Property  String  psB_Gmove_Master_Aitiol    0
43934>>>>>
43934>>>>>                Property  Integer piB_Gmove_Slave_Rec0       0
43935>>>>>                Property  Integer piB_Gplan_Slave_Rec0       0
43936>>>>>                Property  Number  pnB_Gmove_Slave_X2         0
43937>>>>>                Property  Number  pnB_Gmove_Slave_P2         0
43938>>>>>                Property  String  psB_Gmove_Slave_Aitiol     0
43939>>>>>
43939>>>>>                //19 ¤âœª « £âª
43939>>>>>                Property  Integer piA_Garticl_Rec0           0
43940>>>>>                Property  Integer piA_Gtypkin_Rec0           0
43941>>>>>                Property  Date    pdA_Garticl_Hmnia          0
43942>>>>>                Property  Integer piA_Garticl_No             0
43943>>>>>                Property  String  psA_Garticl_C_Code2        0
43944>>>>>                Property  Number  pnA_Garticl_Rate0          0
43945>>>>>                Property  Number  pnA_Garticl_Rate00         0
43946>>>>>                Property  Number  pnA_Garticl_RateR          0
43947>>>>>                Property  String  psA_Garticl_Aitiol         0
43948>>>>>
43948>>>>>                Property  Integer piA_Gmove_Master_Rec0      0
43949>>>>>                Property  Integer piA_Gplan_Master_Rec0      0
43950>>>>>                Property  Number  pnA_Gmove_Master_X2        0
43951>>>>>                Property  Number  pnA_Gmove_Master_P2        0
43952>>>>>                Property  String  psA_Gmove_Master_Aitiol    0
43953>>>>>
43953>>>>>                Property  Integer piA_Gmove_Slave_Rec0       0
43954>>>>>                Property  Integer piA_Gplan_Slave_Rec0       0
43955>>>>>                Property  Number  pnA_Gmove_Slave_X2         0
43956>>>>>                Property  Number  pnA_Gmove_Slave_P2         0
43957>>>>>                Property  String  psA_Gmove_Slave_Aitiol     0
43958>>>>>
43958>>>>>                Property  Integer piDo_GL_Maintainance       0 //object id «žª business process
43959>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «ã¤ šœ¤ ¡ã ¢¦š ©« ¡ã
43959>>>>>                Property  Integer piDo_CUSTOMER_Maintainance 0 //object id «žª business process
43960>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
43960>>>>>                Property  Integer piDo_VENDOR_Maintainance   0 //object id «žª business process
43961>>>>>                                                               //§¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
43961>>>>>
43961>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
43961>>>>>                Property Integer  piF_Garticl_Rec0           0
43962>>>>>                Property Integer  piF_Gmove_Master_Rec0      0
43963>>>>>                Property Integer  piF_Gmove_Slave_Rec0       0
43964>>>>>
43964>>>>>                Property Integer  piUpdate                   0
43965>>>>>                Property Integer  piBackout                  0
43966>>>>>
43966>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
43966>>>>>                Property String   psB_Barticl_Recr           ''
43967>>>>>                Property String   psB_Baxiokat_Recr          ''
43968>>>>>                Property Number   pnB_Baxio_V2               0
43969>>>>>                Property Number   pnB_Baxio_V0               0
43970>>>>>                Property Number   pnB_Baxio_V00              0
43971>>>>>                Property Number   pnB_Baxio_VR               0
43972>>>>>
43972>>>>>                Property String   psA_Barticl_Recr           ''
43973>>>>>                Property String   psA_Baxiokat_Recr          ''
43974>>>>>                Property Number   pnA_Baxio_V2               0
43975>>>>>                Property Number   pnA_Baxio_V0               0
43976>>>>>                Property Number   pnA_Baxio_V00              0
43977>>>>>                Property Number   pnA_Baxio_VR               0
43978>>>>>
43978>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ž¤ š¢
43978>>>>>                Property Integer  piGarticl_Delete          0 //©œ«á¨œ«˜  ©«ž¤ backout
43979>>>>>                Property Integer  piGarticl_Edit            0 //˜¤«åŸœ«¦ «¦¬ create (update)
43980>>>>>                Property Integer  piGarticl_Create          0 //©œ«á¨œ«˜  ©«ž¤ update
43981>>>>>
43981>>>>>                Property Integer  piMaster_Gmove_Delete     0 //©œ«á¨œ«˜  ©«ž¤ backout
43982>>>>>                Property Integer  piMaster_Gmove_Edit       0 //˜¤«åŸœ«¦ «¦¬ create (update)
43983>>>>>                Property Integer  piMaster_Gmove_Create     0 //©œ«á¨œ«˜  ©«ž¤ private.creating_barticl
43984>>>>>
43984>>>>>                Property Integer  piSlave_Gmove_Delete      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43985>>>>>                Property Integer  piSlave_Gmove_Edit        0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43986>>>>>                Property Integer  piSlave_Gmove_Create      0 //©œ«á¨¦¤«˜  ©«ž¤ update_bsum
43987>>>>>
43987>>>>>                Property Integer    piMustNotConstrain      0
43988>>>>>
43988>>>>>
43988>>>>>      End_Procedure   //construct_object
43989>>>>>
43989>>>>>
43989>>>>>
43989>>>>>      //****************************************************************************************
43989>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
43989>>>>>      //****************************************************************************************
43989>>>>>
43989>>>>>
43989>>>>>      //¡˜¢œå«˜  ˜§æ save+delete_main_file, «˜ œ£§¢œ¡æ£œ¤˜ ˜¨®œå˜ œå¤˜  locked
43989>>>>>      //¡˜  transaction is enabled !
43989>>>>>      //œ§å©žª â®à current record ©œ æ¢˜ «˜ parents.
43989>>>>>      //¡˜¢œå «ž¤ private.update_bsum
43989>>>>>      //œ§ ©«¨â­œ  «˜ œ¥ãª ¢áŸž:6001:˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
43989>>>>>      //                        6002:ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !
43989>>>>>      //œ§å©žª ˜§¦ ¢áŸ¦ª «¦¬ ¡é› ¡˜, £§¦¨œå ¤˜ ›é©œ  ¡˜  Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
43989>>>>>
43989>>>>>      //¡˜¢œå «ž¤ private.update_bsum 1 ­¦¨á š ˜ backout (˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤) ¡˜ 
43989>>>>>      //                              1 ­¦¨á š ˜ update  (§¨æ©Ÿœ©ž ¤âà¤ « £é¤)
43989>>>>>      //œ¢âš®¦¤«˜  æ¢œª ¦  §˜¨á£œ«¨¦  before+after œá¤ œå¤˜  å©œª,
43989>>>>>      //¦§æ«œ ›â¤ œ¤ž£œ¨é¤à    ‰ € ‡ Ž Š Ž “    «¦ bsum (§® ¡á¤à £æ¤¦¤ ˜¢¢˜šã ˜ « ¦¢¦šå˜ª)
43989>>>>>      Procedure private.Trexe Returns Integer
43990>>>>>                Integer liBackout liUpdate
43991>>>>>
43991>>>>>                String  lsB_Barticl_Recr lsB_Baxiokat_Recr
43991>>>>>                Number  lnB_Baxio_V2
43991>>>>>                Number  lnB_Baxio_V0
43991>>>>>                Number  lnB_Baxio_V00
43991>>>>>                Number  lnB_Baxio_VR
43991>>>>>
43991>>>>>                String  lsA_Barticl_Recr lsA_Baxiokat_Recr
43991>>>>>                Number  lnA_Baxio_V2
43991>>>>>                Number  lnA_Baxio_V0
43991>>>>>                Number  lnA_Baxio_V00
43991>>>>>                Number  lnA_Baxio_VR
43991>>>>>
43991>>>>>                //˜¤áš¤à©ž ¡˜«á©«˜©žª «¦¬ ddo
43991>>>>>                Get piBackout to liBackout
43992>>>>>                Get piUpdate  to liUpdate
43993>>>>>
43993>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, â¢œš®¦ª backout & update
43993>>>>>                If (;                     (liBAckout = 0) and;                     (liUpdate  = 0);                   ) Begin
43995>>>>>                      Send Operation_Not_Allowed 6002 //"ƒâ¤ â«¨œ¥œ ¦ç«œ update ¦ç«œ backout !"
43996>>>>>                      //Procedure_Return    //› ˜¡¦§ã «¦¬ transaction! (£á¢¢¦¤ «œ¢œåàª ˜§åŸ˜¤¦, but who knows!
43996>>>>>                     End
43996>>>>>>
43996>>>>>
43996>>>>>                //˜¤áš¤à©ž §˜¢˜ é¤ « £é¤
43996>>>>>                Get psB_Barticl_Recr  to lsB_Barticl_Recr
43997>>>>>                Get psB_Baxiokat_Recr to lsB_Baxiokat_Recr
43998>>>>>                Get pnB_Baxio_V2      to lnB_Baxio_V2
43999>>>>>                Get pnB_Baxio_V0      to lnB_Baxio_V0
44000>>>>>                Get pnB_Baxio_V00     to lnB_Baxio_V00
44001>>>>>                Get pnB_Baxio_VR      to lnB_Baxio_VR
44002>>>>>
44002>>>>>                //˜¤áš¤à©ž ¤âà¤ « £é¤
44002>>>>>                Get psA_Barticl_Recr  to lsA_Barticl_Recr
44003>>>>>                Get psA_Baxiokat_Recr to lsA_Baxiokat_Recr
44004>>>>>                Get pnA_Baxio_V2      to lnA_Baxio_V2
44005>>>>>                Get pnA_Baxio_V0      to lnA_Baxio_V0
44006>>>>>                Get pnA_Baxio_V00     to lnA_Baxio_V00
44007>>>>>                Get pnA_Baxio_VR      to lnA_Baxio_VR
44008>>>>>
44008>>>>>                //œá¤ æ¢œª ¦  §˜¨á£œ«¨¦  before+after œå¤˜  å©œª,
44008>>>>>                //«æ«œ ›â¤ £§˜å¤à ¡˜Ÿæ¢¦¬ ©«ž¤ œ¤ž£â¨à©ž  ©¦¬šåà¤,
44008>>>>>                //˜¢¢á ­œçšà ...«¨â®¦¤«˜ª!
44008>>>>>                //sosos £ã§àª §¨â§œ  ¤˜ œ¢œš¥à gtypkin + gplan slave master ?
44008>>>>>                If (;                     (lsB_Barticl_Recr  =lsA_Barticl_Recr ) and;                     (lsB_Baxiokat_Recr =lsA_Baxiokat_Recr) and;                     (lnB_Baxio_V2      =lnA_Baxio_V2)      and;                     (lnB_Baxio_V0      =lnA_Baxio_V0)      and;                     (lnB_Baxio_V00     =lnA_Baxio_V00)     and;                     (lnB_Baxio_VR      =lnA_Baxio_VR)         ;                    ) Begin
44010>>>>>                       Procedure_Return
44011>>>>>                      End
44011>>>>>>
44011>>>>>
44011>>>>>                //˜­˜å¨œ©ž §˜¢˜ é¤ « £é¤
44011>>>>>                If (liBackout = 1);                Begin
44013>>>>>                     Send private.Update_Bsum lsB_Barticl_Recr;                                              lsB_Baxiokat_Recr;                                              lnB_Baxio_V2;                                              lnB_Baxio_V0;                                              lnB_Baxio_V00;                                              lnB_Baxio_VR;                                              (-1)
44014>>>>>                End //if (libackout = 1)
44014>>>>>>
44014>>>>>
44014>>>>>                //§¨æ©Ÿœ©ž ¤âà¤ « £é¤
44014>>>>>                If (liUpdate = 1);                Begin
44016>>>>>                     Send private.Update_Bsum lsA_Barticl_Recr;                                              lsA_Baxiokat_Recr;                                              lnA_Baxio_V2;                                              lnA_Baxio_V0;                                              lnA_Baxio_V00;                                              lnA_Baxio_VR;                                              1
44017>>>>>                End //if (liupdate = 1)
44017>>>>>>
44017>>>>>      End_Procedure //private.trexe
44018>>>>>
44018>>>>>
44018>>>>>      //¡˜¢œå«˜  ˜§æ «ž¤ prepare_to_update_bsum
44018>>>>>      //¡˜Ÿ¦¨åœ  «¦ slave operation
44018>>>>>      Procedure private.Update_Bsum String lsBarticl_Recr;                                    String lsBaxiokat_Recr;                                    Number  lnV2;                                    Number  lnV0;                                    Number  lnV00;                                    Number  lnVR;                                    Integer liSign
44019>>>>>
44019>>>>>                Integer liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
44020>>>>>
44020>>>>>                //š ˜ ¢æš¦¬ª ˜©­˜¢œå˜ª, £ã¤ «¬®æ¤ ¥œ§œ¨á©à «¦¬ª 255 ®˜¨˜¡«ã¨œª
44020>>>>>                If (Num_Arguments <> 7 ) Error 10001 "Wrong Num Arguments!\n\nPlease Call Solution!"
44023>>>>>
44023>>>>>                //**************************************************************************
44023>>>>>                //01.¬§¦¢¦š ©£æª & â¢œš®¦ª §¨¦©ã£¦¬ (+ ã -)
44023>>>>>                //**************************************************************************
44023>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
44025>>>>>                      Send Operation_Not_Allowed 6001 //˜¡˜«á¢¢ž¢¦ §¨æ©ž£¦ (¢áŸ¦ª ¡é› ¡˜ª)
44026>>>>>                                                      //› ˜¡¦§ã «¦¬ transaction!
44026>>>>>                     End
44026>>>>>>
44026>>>>>                Move (lnV2  * liSign) to lnV2
44027>>>>>                Move (lnV0  * liSign) to lnV0
44028>>>>>                Move (lnV00 * liSign) to lnV00
44029>>>>>                Move (lnVR  * liSign) to lnVR
44030>>>>>
44030>>>>>                //**************************************************************************
44030>>>>>                //02.œ¤ž£â¨à©ž bsum
44030>>>>>                //**************************************************************************
44030>>>>>
44030>>>>>                //02.1:œç¨œ©ž/›ž£ ¦¬¨šå˜ & œ¤ž£â¨à©ž bsum
44030>>>>>                Clear Bsum
44031>>>>>                Move lsBarticl_Recr  to Bsum.Barticl_Recr
44032>>>>>                Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
44033>>>>>                Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
44034>>>>>>
44034>>>>>                If (Found=0);                Begin //˜¨®ã ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
44036>>>>>
44036>>>>>                      // jsjsjs 27/01/2001
44036>>>>>                      Add 1 to SysrecB.Bsum_Rec0
44037>>>>>                      Saverecord SysrecB
44038>>>>>                      Move SysrecB.Bsum_Rec0  to Bsum.Bsum_Rec0
44039>>>>>                      Move (Append('',((Trim(SysCurXR.Branch_Site))+;                                        (Trim(String(Bsum.Bsum_Rec0)))))) to Bsum.Bsum_Recr
44040>>>>>
44040>>>>>                      //Add 1 to SysrecB.Bsum_Rec0
44040>>>>>                      //Saverecord SysrecB
44040>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à rec mhdenia  ! ! !
44040>>>>>                      //Move SysrecB.Bsum_Rec0       to Bsum.Bsum_Rec0
44040>>>>>                      //œ¤ž£â¨à©ž £ã related §œ›åà¤
44040>>>>>                      //§¨¦©¦®ã ! ›â¤ â®à £ã related §œ›å˜ ! ! !
44040>>>>>                      Set piSlave_Gmove_Create to 1  //›ž£ ¦¬¨šå˜ ¤â¦¬ gmove slave record
44041>>>>>                      Move 1 to liSlave_Gmove_Create //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation
44042>>>>>                End //«â¢¦ª ›ž£ ¦¬¨šå˜s ¤â¦¬ record bsum
44042>>>>>>
44042>>>>>
44042>>>>>                //02.2:œ¤ž£â¨à©ž bsum (update+backout)
44042>>>>>
44042>>>>>                //02.3:©é© £¦ ã › ˜š¨˜­ã «¦¬ bsum
44042>>>>>
44042>>>>>                If (;                     (Bsum.Bsum_SV2 + lnV2  = 0) and;                     ((piUpdate(Self))      = 0);                   );                Begin
44044>>>>>                     Delete Bsum
44045>>>>>                     Set piSlave_Gmove_Delete  to 1 //› ˜š¨˜­ã gmove slave record
44046>>>>>                End
44046>>>>>>
44046>>>>>                Else;                Begin
44047>>>>>                     Add lnV2  to Bsum.Bsum_SV2
44048>>>>>                     Add lnV0  to Bsum.Bsum_SV0
44049>>>>>                     Add lnV00 to Bsum.Bsum_SV00
44050>>>>>                     Add lnVR  to Bsum.Bsum_SVR
44051>>>>>                     Saverecord Bsum
44052>>>>>                     Set piSlave_Gmove_Edit    to (Not(liSlave_Gmove_Create)) //edit gmove slave record
44053>>>>>                End
44053>>>>>>
44053>>>>>
44053>>>>>      End_Procedure //private.update_bsum
44054>>>>>      //****************************************************************************************
44054>>>>>      //**************P R O C E D U R A L    „ Œ † ‹„  — ‘ †    B S U M************************
44054>>>>>      //****************************************************************************************
44054>>>>>
44054>>>>>
44054>>>>>      //private
44054>>>>>      //¡˜¢œå«˜  ˜§æ request save & delete, ˜¡¨ ™éª §¨å¤ ¡˜  £œ«á «¦ forward send
44054>>>>>      Procedure private.Initialize_Properties
44055>>>>>                Integer liBarticl_dd liBaxio_dd
44056>>>>>
44056>>>>>                //barticl related properties
44056>>>>>                Get piBarticl_dd to liBarticl_dd
44057>>>>>                If (liBarticl_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ barticl_server_ddo
44059>>>>>                     Set piCreated_Barticl of liBarticl_dd to 0
44060>>>>>                End
44060>>>>>>
44060>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
44062>>>>>
44062>>>>>                //baxio   related properties
44062>>>>>                Get piBaxio_dd to liBaxio_dd
44063>>>>>                If (liBaxio_dd <> 0);                Begin //œá¤ æ¤«àª ™¨å©¡à ¡á§¦ ¦ baxio_server_ddo
44065>>>>>                     Set piCreated_Baxio   of liBaxio_dd to 0
44066>>>>>                     Set pnB_Baxio_V2      of liBaxio_dd to 0
44067>>>>>                     Set pnB_Baxio_V0      of liBaxio_dd to 0
44068>>>>>                     Set pnB_Baxio_V00     of liBaxio_dd to 0
44069>>>>>                     Set pnB_Baxio_Vr      of liBaxio_dd to 0
44070>>>>>                     Set psB_Baxio_C_Code2 of liBaxio_dd to ""
44071>>>>>                     Set piB_Baxio_Status  of liBaxio_dd to 0
44072>>>>>                     Set piB_Baxiokat_Code of liBaxio_dd to 0
44073>>>>>                     Set piB_Year_Year     of liBaxio_dd to 0
44074>>>>>                     Set piBtypkin_Flag03  of liBaxio_dd to 0
44075>>>>>                     Set piBtypkin_Flag04  of liBaxio_dd to 0
44076>>>>>                End
44076>>>>>>
44076>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
44078>>>>>
44078>>>>>                Set piCreated_Bmove  to 0 //©œ«á¨œ«˜  ©«ž¤ creating,
44079>>>>>
44079>>>>>                //£ž›œ¤ ©£æª 19 §˜¢˜ é¤ « £é¤
44079>>>>>                Set piB_Garticl_Rec0         to 0
44080>>>>>                Set piB_Gtypkin_Rec0         to 0
44081>>>>>                Set pdB_Garticl_Hmnia        to 0
44082>>>>>                Set piB_Garticl_No           to 0
44083>>>>>                Set psB_Garticl_C_Code2      to 0
44084>>>>>                Set pnB_Garticl_Rate0        to 0
44085>>>>>                Set pnB_Garticl_Rate00       to 0
44086>>>>>                Set pnB_Garticl_RateR        to 0
44087>>>>>                Set psB_Garticl_Aitiol       to 0
44088>>>>>
44088>>>>>                Set piB_Gmove_Master_Rec0    to 0
44089>>>>>                Set piB_Gplan_Master_Rec0    to 0
44090>>>>>                Set pnB_Gmove_Master_X2      to 0
44091>>>>>                Set pnB_Gmove_Master_P2      to 0
44092>>>>>                Set psB_Gmove_Master_Aitiol  to 0
44093>>>>>
44093>>>>>                Set piB_Gmove_Slave_Rec0     to 0
44094>>>>>                Set piB_Gplan_Slave_Rec0     to 0
44095>>>>>                Set pnB_Gmove_Slave_X2       to 0
44096>>>>>                Set pnB_Gmove_Slave_P2       to 0
44097>>>>>                Set psB_Gmove_Slave_Aitiol   to 0
44098>>>>>
44098>>>>>                //£ž›œ¤ ©£æª 19 ¤âà¤ « £é¤
44098>>>>>                Set piA_Garticl_Rec0         to 0
44099>>>>>                Set piA_Gtypkin_Rec0         to 0
44100>>>>>                Set pdA_Garticl_Hmnia        to 0
44101>>>>>                Set piA_Garticl_No           to 0
44102>>>>>                Set psA_Garticl_C_Code2      to 0
44103>>>>>                Set pnA_Garticl_Rate0        to 0
44104>>>>>                Set pnA_Garticl_Rate00       to 0
44105>>>>>                Set pnA_Garticl_RateR        to 0
44106>>>>>                Set psA_Garticl_Aitiol       to 0
44107>>>>>
44107>>>>>                Set piA_Gmove_Master_Rec0    to 0
44108>>>>>                Set piA_Gplan_Master_Rec0    to 0
44109>>>>>                Set pnA_Gmove_Master_X2      to 0
44110>>>>>                Set pnA_Gmove_Master_P2      to 0
44111>>>>>                Set psA_Gmove_Master_Aitiol  to 0
44112>>>>>
44112>>>>>                Set piA_Gmove_Slave_Rec0     to 0
44113>>>>>                Set piA_Gplan_Slave_Rec0     to 0
44114>>>>>                Set pnA_Gmove_Slave_X2       to 0
44115>>>>>                Set pnA_Gmove_Slave_P2       to 0
44116>>>>>                Set psA_Gmove_Slave_Aitiol   to 0
44117>>>>>
44117>>>>>                Set piBaxio_Status_From      to 0
44118>>>>>                Set piBaxio_Status_To        to 0
44119>>>>>
44119>>>>>                //3 properties š ˜ «ž¤ feedback œ¤ž£â¨à©ž ˜§¦ «ž¤ š¢
44119>>>>>                Set piF_Garticl_Rec0         to 0
44120>>>>>                Set piF_Gmove_Master_Rec0    to 0
44121>>>>>                Set piF_Gmove_Slave_Rec0     to 0
44122>>>>>
44122>>>>>                Set piUpdate                 to 0
44123>>>>>                Set piBackout                to 0
44124>>>>>
44124>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
44124>>>>>                Set psB_Barticl_Recr         to ''
44125>>>>>                Set psB_Baxiokat_Recr        to ''
44126>>>>>                Set pnB_Baxio_V2             to 0
44127>>>>>                Set pnB_Baxio_V0             to 0
44128>>>>>                Set pnB_Baxio_V00            to 0
44129>>>>>                Set pnB_Baxio_VR             to 0
44130>>>>>
44130>>>>>                Set psA_Barticl_Recr         to ''
44131>>>>>                Set psA_Baxiokat_Recr        to ''
44132>>>>>                Set pnA_Baxio_V2             to 0
44133>>>>>                Set pnA_Baxio_V0             to 0
44134>>>>>                Set pnA_Baxio_V00            to 0
44135>>>>>                Set pnA_Baxio_VR             to 0
44136>>>>>
44136>>>>>                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤œ  ©«¦¤ š¢
44136>>>>>                Set  piGarticl_Delete         to  0
44137>>>>>                Set  piGarticl_Edit           to  0
44138>>>>>                Set  piGarticl_Create         to  0
44139>>>>>
44139>>>>>                Set  piMaster_Gmove_Delete    to  0
44140>>>>>                Set  piMaster_Gmove_Edit      to  0
44141>>>>>                Set  piMaster_Gmove_Create    to  0
44142>>>>>
44142>>>>>                Set  piSlave_Gmove_Delete     to  0
44143>>>>>                Set  piSlave_Gmove_Edit       to  0
44144>>>>>                Set  piSlave_Gmove_Create     to  0
44145>>>>>      End_Procedure //private.Initialize_Properties
44146>>>>>
44146>>>>>
44146>>>>>      //private
44146>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update
44146>>>>>      Procedure private.Creating_Barticl
44147>>>>>      End_Procedure //private.creating_barticl
44148>>>>>
44148>>>>>
44148>>>>>      //private
44148>>>>>      //¡˜¢œå«˜  ˜§¦ «ž¤ update, ˜­¦ç â®œ  ™¨œå kinkat record
44148>>>>>      Procedure private.Creating_Baxio
44149>>>>>                Integer liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
44150>>>>>
44150>>>>>                //¡˜«'˜¨®áª ¤â˜ axio records ›ž£ ¦¬¨š¦ç¤«˜  £æ¤¦¤ æ«˜¤ :
44150>>>>>                //˜) œå¤˜  œ ©§¨˜¡«â˜ + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜, ã
44150>>>>>                //™) œå¤˜  §¢ž¨à«â˜   + «¦ bkinkat œ§ «¨â§œ  ›ž£ ¦¬¨šå˜.
44150>>>>>                //æ«˜¤ ›ž£ ¦¬¨š¦ç£œ ¤â˜ axio records, «æ«œ:
44150>>>>>                //˜)œ¤ž£â¨à©ž §œ›åà¤ first in, £æ¤¦ š ˜ œ ©§¨˜¡«â˜
44150>>>>>                //™)œ¤ž£â¨à©ž §œ›åà¤ first out, £æ¤¦ š ˜ §¢ž¨à«â˜
44150>>>>>                //š) §œ›å˜ status + place (˜¬«á «œ¢ ¡á «˜ œ¤ž£œ¨é¤à ©«ž¤ update)
44150>>>>>                Case Begin
44150>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ œ ©§¨˜¡«â¦¬, œ¡¡¨œ£âª ©«¦ ®˜¨«¦­¬¢á¡ ¦
44150>>>>>                     Case ((Baxiokat.Baxiokat_Type = 1) and (Bkinkat.Bkinkat_Yn_New = 1))
44152>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_In
44153>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_In
44154>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_In
44155>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_In
44156>>>>>
44156>>>>>                          Move (-1)                    to Baxio.Baxio_File_Out //›â¤ ¬§á¨®œ 
44157>>>>>                          Move ""                      to Baxio.Baxio_Code_Out
44158>>>>>                          Move ""                      to Baxio.Baxio_Epon_Out
44159>>>>>                          Move 0                       to Baxio.Baxio_Fpar_Out
44160>>>>>                     Case Break
44161>>>>>
44161>>>>>                     //›ž£ ¦¬¨šå˜ ˜¥ ¦š¨á­¦¬ §¢ž¨à«â¦¬, œ¡¡¨œ£âª ©«¦ bkinkat_plac_to
44161>>>>>                     Case ((Baxiokat.Baxiokat_Type = 2) and (Bkinkat.Bkinkat_Yn_New = 1))
44164>>>>>                          Move (-1)                    to Baxio.Baxio_File_In  //›â¤ ¬§á¨®œ 
44165>>>>>                          Move ""                      to Baxio.Baxio_Code_In
44166>>>>>                          Move ""                      to Baxio.Baxio_Epon_In
44167>>>>>                          Move 0                       to Baxio.Baxio_Fpar_In
44168>>>>>
44168>>>>>                          Move Btypkin.Btypkin_Anti1   to Baxio.Baxio_File_Out
44169>>>>>                          Move Barticl.Barticl_Code1   to Baxio.Baxio_Code_Out
44170>>>>>                          Move Barticl.Barticl_Epon1   to Baxio.Baxio_Epon_Out
44171>>>>>                          Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
44172>>>>>                     Case Break
44173>>>>>
44173>>>>>                     Case Else //§¨¦­˜¤éª ¡á«  ›â¤ §áœ  ¡˜¢á
44173>>>>>                          Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
44174>>>>>                Case End
44174>>>>>
44174>>>>>                If (Trim(Baxio.Baxio_C_Code2)='') Move (Trim(SysCurXr.C_Code0)) to Baxio.Baxio_C_Code2
44177>>>>>                Move barticl.barticl_hmnia  to baxio.baxio_hmniae
44178>>>>>                //›œç«œ¨¦ª â¢œš®¦ª ›ž£ ¦¬¨šå˜ª ¤â¦¬ ˜¥ ¦š¨á­¦¬ ˜§æ «¦ bkinkay_yn_create !
44178>>>>>                Get piCan_Create_Baxio to liCan_Create_Baxio //¡˜Ÿ˜¨á š ˜ ¢æš¦¬ª compilation only
44179>>>>>                If (liCan_Create_Baxio = FALSE) Send Operation_Not_Allowed 3001 //›â¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
44182>>>>>      End_Procedure //private.creating_baxio
44183>>>>>
44183>>>>>
44183>>>>>//      //private
44183>>>>>//      //™¨å©¡œ  ˜§æ «¦ bsum «¦ gmove slave rec0
44183>>>>>//      //¡˜¢œå«˜  ˜§æ update+backout ?
44183>>>>>//      Function private.fiBsum_Gmove_Srec0 String lsBarticl_Recr ;
44183>>>>>//                                          String lsBaxiokat_Recr;
44183>>>>>//                                          Returns Integer
44183>>>>>//               Clear Bsum
44183>>>>>//               Move lsBarticl_Recr  to Bsum.Barticl_Recr
44183>>>>>//               Move lsBaxiokat_Recr to Bsum.Baxiokat_Recr
44183>>>>>//               Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr
44183>>>>>//               Function_Return Bsum.Gmove_Srec0
44183>>>>>//      End_Function //private.fibsum_gmove_srec0
44183>>>>>
44183>>>>>
44183>>>>>      //private
44183>>>>>      //™¨å©¡œ  œá¤ ž ©¬š¡œ¡¨ £â¤ž btypkin ¡ ¤œå «¦ libaxiokat_code
44183>>>>>      //¡˜¢œå«˜  ˜§æ update+validate_save
44183>>>>>      Function private.fiBkinkat_Baxiokat_Code String lsBtypkin_Recr;                                               Integer liBaxiokat_Code;                                               Returns Integer
44184>>>>>               Clear Bkinkat
44185>>>>>               Move SysCurXr.Company_Code   to Bkinkat.Company_Code
44186>>>>>               Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
44187>>>>>               Move SysCurXr.Year_Year      to Bkinkat.Year_year
44188>>>>>               Move lsBtypkin_Recr          to Bkinkat.Btypkin_Recr
44189>>>>>               Move liBaxiokat_Code         to Bkinkat.Baxiokat_Code
44190>>>>>               Find Eq Bkinkat by Index.3 //Company+Branch+Year+btypkin_recr+baxiokat_code
44191>>>>>>
44191>>>>>               If (Found = 0) Begin
44193>>>>>                               Set piBaxio_Status_From to (-1)
44194>>>>>                               Set piBaxio_Status_To   to (-1)
44195>>>>>                               Function_Return 0
44196>>>>>                              End
44196>>>>>>
44196>>>>>               Set piBaxio_Status_From to Bkinkat.Baxio_Stat_From
44197>>>>>               Set piBaxio_Status_To   to Bkinkat.Baxio_Stat_To
44198>>>>>
44198>>>>>
44198>>>>>               Function_Return Bkinkat.Baxiokat_Code
44199>>>>>      End_Function //private.fibkinkat_baxiokat_code
44200>>>>>
44200>>>>>
44200>>>>>      //¡˜¢œå«˜  ˜§æ update & backout
44200>>>>>      //¡˜  œ¤ž£œ¨é¤œ  « ª ©¬¤¦¢ ¡âª ˜¥åœª «¦¬ barticl
44200>>>>>      Procedure private.Adjust_Balances Integer liSign;                                        Number  lnBaxio_V2;                                        Number  lnBaxio_V0;                                        Number  lnBaxio_V00;                                        Number  lnBaxio_VR
44201>>>>>                If (;                     ((Abs(liSign)) <> 1 );                   ) Begin
44203>>>>>                      Error 10000 "€¡˜«á¢¢ž¢¦ §¨æ©ž£¦, ¢áŸ¦ª ¡é› ¡˜" //› ˜¡¦§ã «¦¬ transaction!
44204>>>>>>
44204>>>>>                      Procedure_Return
44205>>>>>                     End
44205>>>>>>
44205>>>>>
44205>>>>>                 //¤æ£ ©£˜ œšš¨˜­ãª
44205>>>>>                Add (lnBaxio_V2  * liSign) to Barticl.Barticl_SV2
44206>>>>>
44206>>>>>                //¡ç¨ ¦ ¤æ£ ©£˜ ®¨ã©žª
44206>>>>>                Add (lnBaxio_V0  * liSign) to Barticl.Barticl_SV0
44207>>>>>
44207>>>>>                //›œ¬«œ¨œç¦¤ ¤æ£ ©£˜ ®¨ã©žª
44207>>>>>                Add (lnBaxio_V00 * liSign) to Barticl.Barticl_SV00
44208>>>>>
44208>>>>>                //¤æ£ ©£˜ reporting
44208>>>>>                Add (lnBaxio_VR  * liSign) to Barticl.Barticl_SVR
44209>>>>>      End_Procedure //private.adjust_balances
44210>>>>>
44210>>>>>
44210>>>>>
44210>>>>>
44210>>>>>      //æ¢˜ «˜ ddo ˜¬«ãª «ãª ¡¢á©žª, œ¤ž£œ¨é¤¦¬¤ «˜ 4 parents ¡˜  «¦¤ œ¬˜«æ «¦¬ª
44210>>>>>      //£œ æ¢˜ «˜ ddo id's
44210>>>>>      //œ§å©žª §¨â§œ  ¤˜ ¬§á¨®¦¬¤ ¡˜  ¦  3 bpo's š ˜ «ž¤ œ¤ž£â¨à©ž «à¤ ¢¦ §é¤ modules
44210>>>>>      Procedure End_Construct_Object
44211>>>>>                Integer liBtypkin_dd liBarticl_dd liBaxio_dd liBaxiokat_dd
44212>>>>>
44212>>>>>                Forward Send End_Construct_Object
44214>>>>>
44214>>>>>                Move (Find_Server_DDO(Self        ,Barticl.File_Number )) to liBarticl_dd
44215>>>>>                Move (Find_Server_DDO(Self        ,Baxio.File_Number   )) to liBaxio_dd
44216>>>>>                Move (Find_Server_DDO(liBarticl_dd,Btypkin.File_Number )) to liBtypkin_dd
44217>>>>>                Move (Find_Server_DDO(liBaxio_dd  ,Baxiokat.File_Number)) to liBaxiokat_dd
44218>>>>>
44218>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
44218>>>>>                //jsjsjs 24/01/2001 Set piDo_GL_Maintainance       to (oDo_GL_Maintainance      (Self))
44218>>>>>
44218>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §œ¢á«œª
44218>>>>>//------------->Set piDo_CUSTOMER_Maintainance to (oDo_CUSTOMER_Maintainance(Self))
44218>>>>>
44218>>>>>                //object id «žª business process §¦¬ œ¤ž£œ¨é¤œ  «¦¬ª §¨¦£žŸœ¬«âª
44218>>>>>//------------->Set piDo_VENDOR_Maintainance   to (oDo_VENDOR_Maintainance  (Self))
44218>>>>>
44218>>>>>                //â¢œš®¦  ¬§¦®¨œà« ¡ãª ç§˜¨¥žª ¡˜  «à¤ 4 ddo'w
44218>>>>>                If (liBarticl_dd  = 0) Error 10000 "Bmove does not have a Barticl  Server ! ! !"
44221>>>>>                If (liBaxio_dd    = 0) Error 10000 "Bmove does not have a Baxio    Server ! ! !"
44224>>>>>                If (liBtypkin_dd  = 0) Error 10000 "Bmove does not have a Btypkin  Server ! ! !"
44227>>>>>                If (liBaxiokat_dd = 0) Error 10000 "Bmove does not have a Baxiokat Server ! ! !"
44230>>>>>
44230>>>>>                //properties › ¡á «¦¬
44230>>>>>                //æ§¦¬ «˜ ®¨ž© £¦§¦ é, Ÿ˜ £§¦¨¦ç©˜ ¤˜ â¡˜¤˜ «ž¤ å› ˜ ›¦¬¢œ á £œ «ž¤ file_field_value ?
44230>>>>>                //æ®  ©« ª §œ¨ §«é©œ ª §¦¬ › ˜®œ ¨å¦£˜¦ properties !
44230>>>>>                Set piBarticl_dd                  to liBarticl_dd
44231>>>>>                Set piBaxio_dd                    to liBaxio_dd
44232>>>>>                Set piBtypkin_dd                  to liBtypkin_dd
44233>>>>>                Set piBaxiokat_dd                 to liBaxiokat_dd
44234>>>>>
44234>>>>>                //properties «¦¬ btypkin
44234>>>>>                Set piBarticl_dd  of liBtypkin_dd to liBarticl_dd
44235>>>>>                Set piBmove_dd    of liBtypkin_dd to Self
44236>>>>>                Set piBaxio_dd    of liBtypkin_dd to liBaxio_dd
44237>>>>>                Set piBaxiokat_dd of liBtypkin_dd to liBaxiokat_dd
44238>>>>>
44238>>>>>                //properties «¦¬ baxiokat
44238>>>>>                Set piBarticl_dd  of liBaxiokat_dd to liBarticl_dd
44239>>>>>                Set piBmove_dd    of liBaxiokat_dd to Self
44240>>>>>                Set piBaxio_dd    of liBaxiokat_dd to liBaxio_dd
44241>>>>>                Set piBtypkin_dd  of liBaxiokat_dd to liBtypkin_dd
44242>>>>>
44242>>>>>                //properties «¦¬ barticl
44242>>>>>                Set piBmove_dd    of liBarticl_dd  to Self
44243>>>>>                Set piBaxio_dd    of liBarticl_dd  to liBaxio_dd
44244>>>>>                Set piBtypkin_dd  of liBarticl_dd  to liBtypkin_dd
44245>>>>>                Set piBaxiokat_dd of liBarticl_dd  to liBaxiokat_dd
44246>>>>>
44246>>>>>      End_Procedure   //end_construct_object
44247>>>>>
44247>>>>>      //£á¢¢¦¤ œå¤˜  á®¨ž©«ž, › æ«  §á¤«˜ «¦ bmove_dd «¦ › ˜®œ ¨å¦£˜ 
44247>>>>>      //œå«˜  ©˜¤ detail «¦¬ barticl, œå«˜  ©˜¤ detail «¦¬ baxio !
44247>>>>>      //ã constrain Ÿ˜ £¦¬ ®¨œ ˜©Ÿœå £æ¤¦¤ œá¤ â®à main server «¦ bmove_dd ! ! !
44247>>>>>      Procedure Constrain
44248>>>>>            Forward Send Constrain
44250>>>>>            If (piMustNotConstrain(Self)=2) Begin
44252>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
44254>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
44256>>>>>            End
44256>>>>>>
44256>>>>>            Else Begin
44257>>>>>                Constrain Bmove.Company_Code  eq SysCurXR.Company_Code
44259>>>>>                Constrain Bmove.Branch_Code   eq SysCurXR.Branch_Code
44261>>>>>                Constrain Bmove.Year_Year     eq SysCurXR.Year_Year
44263>>>>>            End
44263>>>>>>
44263>>>>>      End_Procedure   //constrain
44264>>>>>
44264>>>>>
44264>>>>>      //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
44264>>>>>      //™) ˜¤áš¤à©ž properties
44264>>>>>      //š) › ˜®œå¨ ©ž calculated §œ›åà¤
44264>>>>>      //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
44264>>>>>      //œ) œ¤ž£â¨à©ž properties after
44264>>>>>      Procedure Update
44265>>>>>                Integer liTemp
44266>>>>>                Integer liBarticl_dd      liBaxio_dd
44266>>>>>                Integer liCreated_Barticl liCreated_Baxio
44266>>>>>                String  lsGplan_Slave_Code
44266>>>>>
44266>>>>>                Forward Send Update
44268>>>>>
44268>>>>>                //0)š ˜ ¢æš¦¬ª  › ˜ «œ¨æ«ž«˜ª, æ¢¦ª ¦ ¡é› ¡˜ª
44268>>>>>                //«é¤ creating baxio + barticl  (?) «¨â®œ  «é¨˜, ˜§¦ «ž¤ update «¦¬ bmove ! ! !
44268>>>>>                //§¨é«˜ œ¤«¦§åà bkikat
44268>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
44269>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 3002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
44272>>>>>
44272>>>>>
44272>>>>>                //***********************************************************
44272>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
44272>>>>>                //***********************************************************
44272>>>>>
44272>>>>>
44272>>>>>                //œç¨œ©ž «à¤ 2 server ddo's
44272>>>>>                Get piBarticl_dd to liBarticl_dd
44273>>>>>                Get piBaxio_dd   to liBaxio_dd
44274>>>>>
44274>>>>>                //œ¤ž£â¨à©ž «¦¬ parent barticl dd
44274>>>>>                If (liBarticl_dd <> 0);                Begin
44276>>>>>                    Get piCreated_Barticl of liBarticl_dd to liCreated_Barticl
44277>>>>>                    If (liCreated_Barticl = TRUE)  Send private.Creating_Barticl
44280>>>>>                End
44280>>>>>>
44280>>>>>                Else Error 10000 "Bmove does not have a Barticl Server ! ! !"
44282>>>>>
44282>>>>>                //œ¤ž£â¨à©ž «¦¬ parent baxio dd
44282>>>>>                If (liBaxio_dd   <> 0);                Begin
44284>>>>>                    Get piCreated_Baxio   of liBaxio_dd   to liCreated_Baxio
44285>>>>>                    If (liCreated_Baxio   = TRUE)  Send private.Creating_Baxio
44288>>>>>                    Set piBtypkin_Flag03 of liBaxio_dd to Btypkin.Btypkin_Flag03
44289>>>>>                    Set piBtypkin_Flag04 of liBaxio_dd to Btypkin.Btypkin_Flag04
44290>>>>>                End
44290>>>>>>
44290>>>>>                Else Error 10000 "Bmove does not have a Baxio Server ! ! !"
44292>>>>>
44292>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
44292>>>>>//                //***************************************************************************
44292>>>>>//                //============================================================================
44292>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
44292>>>>>//                //£œ«˜«¨¦§ã «žª ˜¥å˜ª ˜§æ ¤æ£ ©£˜ œšš¨˜­ãª (2) ©«˜ ¢¦ §á 3 ¤¦£å©£˜«˜  (0+00+r)
44292>>>>>//                Move 1                  to Baxio.Baxio_Rate0 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
44292>>>>>//                Move SysCurXr.C_Code0   to Baxio.Baxio_C_Code2 //sosososo §¨¦©à¨ ¤á, £æ¤¦¤ ˜¥ æš¨˜­˜ ©œ ›¨®
44292>>>>>//                //***************************************************************************
44292>>>>>//                //============================================================================
44292>>>>>//                //||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
44292>>>>>// jsjsjs sos energopoihsh xenou nomismatos 29/11/2001
44292>>>>>
44292>>>>>                Send Convert_Axio_Values to liBaxio_dd
44293>>>>>
44293>>>>>
44293>>>>>                //˜) œ¤ž£â¨à©ž £ã related §œ›åà¤
44293>>>>>                Move SysCurXr.Company_Code  to Bmove.Company_Code
44294>>>>>                Move SysCurXr.Branch_Code   to Bmove.Branch_Code
44295>>>>>                Move SysCurXr.Year_Year     to Bmove.Year_Year
44296>>>>>                Move Baxio.Baxio_Code       to Bmove.Baxio_Code
44297>>>>>                Move Btypkin.Btypkin_Code   to Bmove.Btypkin_Code
44298>>>>>                Move Btypkin.Btypkin_Recr   to Bmove.Btypkin_Recr
44299>>>>>                Move Barticl.Barticl_Hmnia  to Bmove.Barticl_Hmnia
44300>>>>>                Move Barticl.Barticl_No     to Bmove.Barticl_No
44301>>>>>
44301>>>>>                Move Barticl.Sls_ID         to Bmove.Sls_ID
44302>>>>>                Move Barticl.Presp_ID       to Bmove.Presp_ID
44303>>>>>                Move Barticl.Cnt_ID         to Bmove.Cnt_ID
44304>>>>>
44304>>>>>
44304>>>>>                //™) ˜¤áš¤à©ž properties
44304>>>>>
44304>>>>>                //š) › ˜®œå¨ ©ž calculated §œ›åà¤
44304>>>>>
44304>>>>>                //š.01:œ¤ž£â¨à©ž §œ›åà¤ previous §˜¨˜¢ã§«žª «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44304>>>>>                //     §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio, «˜ ¡¨˜«áà ©«˜
44304>>>>>                //     previous §œ›å˜ «¦¬ bmove,
44304>>>>>                //     é©«œ ©«ž¤ deleting ¤˜ «˜ œ§˜¤˜­â¨à
44304>>>>>                Move Baxio.Baxio_Lfile      to  Bmove.Baxio_Pfile
44305>>>>>                Move Baxio.Baxio_Lcode      to  Bmove.Baxio_Pcode
44306>>>>>                Move Baxio.Baxio_Lepon      to  Bmove.Baxio_Pepon
44307>>>>>                Move Baxio.Baxio_Lpar       to  Bmove.Baxio_Ppar
44308>>>>>
44308>>>>>                //š.02:œ¤ž£â¨à©ž §œ›åà¤ last («œ¢œ¬«˜å¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44308>>>>>
44308>>>>>// ----------------------------------------------------------------------------
44308>>>>>// js 24/02/2002    Ayth h periptosh den isxyei xoris elegxo giati otan afora
44308>>>>>//                  plhromh dikh mas o promhtheyths mpainei sto 1o koutaki dhladh
44308>>>>>//                  ston ekdoth kai paramenei kenos o apodekths (Code2).
44308>>>>>//                  Otan loipon menei kenos o apodekths den enhmeronei Lcode
44308>>>>>//                  kai an den enhmerosei Lcode tote apo to Baxio_DD katharizontai
44308>>>>>//                  ola ta _Out pedia
44308>>>>>
44308>>>>>//                Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
44308>>>>>//                Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
44308>>>>>//                Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
44308>>>>>//                Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44308>>>>>                if (btypkin.btypkin_code=104) move 1 to baxio.baxio_rater
44311>>>>>                If (Baxiokat.Baxiokat_Type = 2) Begin
44313>>>>>                    If (Trim(Barticl.Barticl_Code2)<>'') Begin
44315>>>>>                        Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
44316>>>>>                        Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
44317>>>>>                        Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
44318>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44319>>>>>                    End
44319>>>>>>
44319>>>>>                    Else Begin
44320>>>>>                        Move Btypkin.Btypkin_Anti1  to Baxio.Baxio_Lfile
44321>>>>>                        Move Barticl.Barticl_Code1  to Baxio.Baxio_Lcode
44322>>>>>                        Move Barticl.Barticl_Epon1  to Baxio.Baxio_Lepon
44323>>>>>                        Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44324>>>>>                    End
44324>>>>>>
44324>>>>>                End
44324>>>>>>
44324>>>>>                Else If (Baxiokat.Baxiokat_Type = 1) Begin
44327>>>>>                    // js 24/02/2002 PARATHRHSEIS
44327>>>>>                    // Edo den kanoume elegxo giati an einai eisprakteo (xoris metavivash)
44327>>>>>                    // tote epeidh den anoigei to Code2 ex orismou tha einai kena
44327>>>>>                    // An tora einai eispraktea pros metavivash tote ex orismou
44327>>>>>                    // to Code2 exei timh apo thn othonh opote kai tha enhmerosei
44327>>>>>                    // me Lcode h update tou Baxio_DD
44327>>>>>                    // to kolpo edo einai oti apitoume apo ton xrhsth sthn periptosh
44327>>>>>                    // metavivashs na plhktrologhsei ston ekdoth KAI ston apodekth
44327>>>>>                    // ton idio kodiko tou promhtheyth ston opoio metavivazei thn epitagh
44327>>>>>
44327>>>>>                    // Ayto prepei sto epomeno version na allaxei opos epishs kai to gegonos
44327>>>>>                    // oti menei panta keno to pedio tou paralhpth stis eispraktees apo pelath
44327>>>>>                    // eno theoro oti tha prepe na mpainei h 'etairia' opos epishs kai
44327>>>>>                    // stis epitages plhrotees dikes mas menei keno o ekdoths pou pali
44327>>>>>                    // tha'prepe na'maste 'emeis' (Mia kartella dhladh opou h 'etairia mas'
44327>>>>>                    // tha emfanizetai kai pelaths kai promhtheyths.
44327>>>>>                    // js 24/02/2002 Parathrhseis
44327>>>>>                    Move Btypkin.Btypkin_Anti2  to Baxio.Baxio_Lfile
44328>>>>>                    Move Barticl.Barticl_Code2  to Baxio.Baxio_Lcode
44329>>>>>                    Move Barticl.Barticl_Epon2  to Baxio.Baxio_Lepon
44330>>>>>                    Move Barticl.Barticl_Recr   to Baxio.Baxio_Lpar
44331>>>>>                End
44331>>>>>>
44331>>>>>
44331>>>>>// ----------------------------------------------------------------------------
44331>>>>>
44331>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ first out (§¨é«¦ª §˜¨˜¢ã§«žª) «¦¬ baxio š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44331>>>>>                //     ¡˜  œ­'æ©¦¤ ›â¤ â®¦¬¤ ã›ž œ¤ž£œ¨àŸœå,
44331>>>>>                //     ›ž¢˜›ã §¨æ¡œ «˜  š ˜ «ž¤ §¨é«ž £œ«˜™å™˜©ž-œ¥˜šàšã
44331>>>>>                If (;                     (Baxio.Baxio_Code_Out = "" );                   );                Begin
44333>>>>>                      Move Btypkin.Btypkin_Anti2   to Baxio.Baxio_File_Out
44334>>>>>                      Move Barticl.Barticl_Code2   to Baxio.Baxio_Code_Out
44335>>>>>                      Move Barticl.Barticl_Epon2   to Baxio.Baxio_Epon_Out
44336>>>>>                      Move Barticl.Barticl_Recr    to Baxio.Baxio_Fpar_Out
44337>>>>>                End
44337>>>>>>
44337>>>>>
44337>>>>>                //š.04:œ¤ž£â¨à©ž §œ›åà¤ status + place «¦¬ baxio, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
44337>>>>>                Move Bkinkat.Baxio_Stat_To  to Baxio.Baxio_Status //¡˜«á©«˜©ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44338>>>>>                Move Bkinkat.Baxio_Plac_To  to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44339>>>>>
44339>>>>>//                //š.05:©«¦ ®œå˜ slave gplan rec0
44339>>>>>//                Case Begin
44339>>>>>//                     Case (Btypkin.Gtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  ‚Š
44339>>>>>////jsjsjs 24/01/2001
44339>>>>>////                          Clear Gplan
44339>>>>>////                          Move Company.Company_Code    to Gplan.Company_Code
44339>>>>>////                          Move Branch.Branch_Code      to Gplan.Branch_Code
44339>>>>>////                          Move Year.Year_Year          to Gplan.Year_Year
44339>>>>>////                          Move Bkinkat.Bkinkat_GplnCod to Gplan.Gplan_Code
44339>>>>>////                          Find Eq Gplan by Index.1 //company_code+branch_code+year_year+Gplan_code
44339>>>>>////                          If (Found = 1) Move Gplan.Gplan_Rec0 to Bmove.Gplan_SRec0
44339>>>>>////                          Else           Send Operation_Not_Allowed 3001 //›â¤ ™¨âŸž¡œ «¦ slave gplan_rec0
44339>>>>>////jsjsjs 24/01/2001
44339>>>>>//                     Case Break //æ® , › æ«  £§¦¨œå ¤˜ œ¤ž£œ¨é¤œ ¡˜  á¢¢˜ modules
44339>>>>>
44339>>>>>//                     Case (Btypkin.Ctypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §œ¢á«œª
44339>>>>>//                     Case Break
44339>>>>>
44339>>>>>//                     Case (Btypkin.Vtypkin_Code <> 0) //œá¤ ž ¡å¤ž©ž œ¤ž£œ¨é¤œ  §¨¦£žŸœ¬«âª
44339>>>>>//                     Case Break
44339>>>>>
44339>>>>>//                     Case Else                        //›â¤ œ¤ž£œ¨é¤œ«˜  ¡˜¤â¤˜ ˜§¦ «˜ 3 modules
44339>>>>>//                          Move 0 to Bmove.Gplan_SRec0
44339>>>>>//                Case End
44339>>>>>
44339>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
44339>>>>>                Send private.Adjust_Balances (1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
44340>>>>>
44340>>>>>//                //œ) œ¤ž£â¨à©ž properties after (˜§æ parent buffers!)
44340>>>>>//                Set piA_Garticl_Rec0         to Barticl.Garticl_Rec0
44340>>>>>//                Set piA_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
44340>>>>>//                Set pdA_Garticl_Hmnia        to Barticl.Barticl_Hmnia
44340>>>>>//                Set piA_Garticl_No           to Barticl.Barticl_No
44340>>>>>//                Set psA_Garticl_C_Code2      to Baxio.Baxio_C_Code2
44340>>>>>//                Set pnA_Garticl_Rate0        to Baxio.Baxio_Rate0
44340>>>>>//                Set pnA_Garticl_Rate00       to Baxio.Baxio_Rate00
44340>>>>>//                Set pnA_Garticl_RateR        to Baxio.Baxio_RateR
44340>>>>>//                Set psA_Garticl_Aitiol       to Barticl.Barticl_Aitiol
44340>>>>>
44340>>>>>//                Set piA_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
44340>>>>>//                Set piA_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
44340>>>>>
44340>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
44340>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
44340>>>>>
44340>>>>>                Case Begin
44340>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
44342>>>>>//                          Set pnA_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44342>>>>>//                          Set pnA_Gmove_Master_P2 to 0
44342>>>>>//                          Set pnA_Gmove_Slave_X2  to 0
44342>>>>>//                          Set pnA_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44342>>>>>                     Case Break
44343>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
44346>>>>>//                          Set pnA_Gmove_Master_X2 to 0
44346>>>>>//                          Set pnA_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44346>>>>>//                          Set pnA_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44346>>>>>//                          Set pnA_Gmove_Slave_P2  to 0
44346>>>>>                     Case Break
44347>>>>>                     Case Else
44347>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
44348>>>>>>
44348>>>>>                Case End
44348>>>>>//                Set psA_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
44348>>>>>
44348>>>>>//                Set piA_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
44348>>>>>//                                                                            Barticl.Barticl_Rec0,;
44348>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
44348>>>>>//                Set piA_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
44348>>>>>//                Set psA_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
44348>>>>>
44348>>>>>                Set piUpdate to 1
44349>>>>>
44349>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
44349>>>>>                Set psA_Barticl_Recr         to Barticl.Barticl_Recr
44350>>>>>                Set psA_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
44351>>>>>                Set pnA_Baxio_V2             to Baxio.Baxio_V2
44352>>>>>                Set pnA_Baxio_V0             to Baxio.Baxio_V0
44353>>>>>                Set pnA_Baxio_V00            to Baxio.Baxio_V00
44354>>>>>                Set pnA_Baxio_VR             to Baxio.Baxio_VR
44355>>>>>
44355>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «˜ operations §¦¬ Ÿ˜ šå¤¦¬¤ ©«ã¤ š¢
44355>>>>>//                If (Barticl.Garticl_Rec0 = 0);
44355>>>>>//                Begin //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
44355>>>>>//                     If (Barticl.Gmove_Mrec0 <> 0) Error 10000 "Master Gmove <> 0 !"
44355>>>>>//                     Set  piGarticl_Create         to  1
44355>>>>>//                     Set  piMaster_Gmove_Create    to  1
44355>>>>>//                End
44355>>>>>//                Set piGarticl_Edit      to  (Not(piGarticl_Create     (Self)))
44355>>>>>//                Set piMaster_Gmove_Edit to  (Not(piMaster_Gmove_Create(Self)))
44355>>>>>      End_Procedure   //update
44356>>>>>
44356>>>>>
44356>>>>>      Procedure Backout
44357>>>>>                Forward Send Backout
44359>>>>>
44359>>>>>                //›) œ¤ž£â¨à©ž ˜Ÿ¨¦ ©«é¤ (adjust_balances)
44359>>>>>                Send private.Adjust_Balances (-1);                                             Baxio.Baxio_V2;                                             Baxio.Baxio_V0;                                             Baxio.Baxio_V00;                                             Baxio.Baxio_VR
44360>>>>>
44360>>>>>
44360>>>>>
44360>>>>>                //******************************
44360>>>>>                //prosoxi ! allagi sto bmove def gia na exo kai ayta ta pedia !!!
44360>>>>>                //******************************
44360>>>>>
44360>>>>>//                //œ) œ¤ž£â¨à©ž properties before (˜§æ current buffer)
44360>>>>>//                Set piB_Garticl_Rec0         to Barticl.Garticl_Rec0
44360>>>>>//                Set piB_Gtypkin_Rec0         to Btypkin.Gtypkin_Rec0
44360>>>>>//                Set pdB_Garticl_Hmnia        to Bmove.Barticl_Hmnia     //sosososo
44360>>>>>//                Set piB_Garticl_No           to Bmove.Barticl_No        //sosososo
44360>>>>>//                Set psB_Garticl_C_Code2      to Baxio.Baxio_C_Code2
44360>>>>>//                Set pnB_Garticl_Rate0        to Baxio.Baxio_Rate0
44360>>>>>//                Set pnB_Garticl_Rate00       to Baxio.Baxio_Rate00
44360>>>>>//                Set pnB_Garticl_RateR        to Baxio.Baxio_RateR
44360>>>>>//                Set psB_Garticl_Aitiol       to Barticl.Barticl_Aitiol
44360>>>>>
44360>>>>>//                Set piB_Gmove_Master_Rec0    to Barticl.Gmove_Mrec0
44360>>>>>//                Set piB_Gplan_Master_Rec0    to Barticl.Gplan_Mrec0
44360>>>>>
44360>>>>>                //â¢œš®¦ª §¨¦©ã£¦¬
44360>>>>>                //If ((Abs(Btypkin.Btypkin_Sign)) <> 1) Error 10000 "To Btypkin Sign œå¤˜  ¢áŸ¦ª !"
44360>>>>>
44360>>>>>                Case Begin
44360>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 1) //®¨âà©ž master, §å©«à©ž slave
44362>>>>>//                          Set pnB_Gmove_Master_X2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44362>>>>>//                          Set pnB_Gmove_Master_P2 to 0
44362>>>>>//                          Set pnB_Gmove_Slave_X2  to 0
44362>>>>>//                          Set pnB_Gmove_Slave_P2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44362>>>>>                     Case Break
44363>>>>>                     Case (Btypkin.Btypkin_Anti_Xp = 2) // §å©«à©ž master, ®¨âà©ž slave
44366>>>>>//                          Set pnB_Gmove_Master_X2 to 0
44366>>>>>//                          Set pnB_Gmove_Master_P2 to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44366>>>>>//                          Set pnB_Gmove_Slave_X2  to (Baxio.Baxio_V2 * Btypkin.Btypkin_Sign)
44366>>>>>//                          Set pnB_Gmove_Slave_P2  to 0
44366>>>>>                     Case Break
44367>>>>>                     Case Else
44367>>>>>                          Error 10000 "To Btypkin XP œå¤˜  ¢áŸ¦ª!"
44368>>>>>>
44368>>>>>                Case End
44368>>>>>//                Set psB_Gmove_Master_Aitiol  to Barticl.Barticl_Aitiol
44368>>>>>
44368>>>>>//                Set piB_Gmove_Slave_Rec0     to (private.fiBsum_Gmove_Srec0(Self,;
44368>>>>>//                                                                            Barticl.Barticl_Rec0,;
44368>>>>>//                                                                            Baxiokat.Baxiokat_Rec0))
44368>>>>>
44368>>>>>//                Set piB_Gplan_Slave_Rec0     to Bmove.Gplan_Srec0
44368>>>>>//                Set psB_Gmove_Slave_Aitiol   to Barticl.Barticl_Aitiol
44368>>>>>
44368>>>>>                Set piBackout to 1
44369>>>>>
44369>>>>>                //properties š ˜ «ž¤ procedural œ¤ž£â¨à©ž «¦¬ bsum
44369>>>>>                Set psB_Barticl_Recr         to Barticl.Barticl_Recr
44370>>>>>                Set psB_Baxiokat_Recr        to Baxiokat.Baxiokat_Recr
44371>>>>>                Set pnB_Baxio_V2             to Baxio.Baxio_V2
44372>>>>>                Set pnB_Baxio_V0             to Baxio.Baxio_V0
44373>>>>>                Set pnB_Baxio_V00            to Baxio.Baxio_V00
44374>>>>>                Set pnB_Baxio_VR             to Baxio.Baxio_VR
44375>>>>>                if (btypkin.btypkin_code=104) move 0 to baxio.baxio_rater
44378>>>>>
44378>>>>>//                //booleans §¦¬ ›ž¢é¤¦¬¤ «¦ operation §¦¬ Ÿ˜ šå¤œ  ©«ã¤ š¢
44378>>>>>//                Case Begin
44378>>>>>//                     Case  (Barticl.Barticl_Lines = 0) //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ š¨˜££ã «¦¬ barticl, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  «¦ garticl
44378>>>>>//                           Set  piGarticl_Delete         to  1
44378>>>>>//                           Set  piMaster_Gmove_Delete    to  1
44378>>>>>//                     Case Break
44378>>>>>//                     Case  (Barticl.Barticl_Lines > 0) //˜¢¢¦ éª Ÿ˜ ¡á¤à edit ©«¦ garticl
44378>>>>>//                           Set  piGarticl_Edit           to  1
44378>>>>>//                           Set  piMaster_Gmove_Edit      to  1
44378>>>>>//                     Case Break
44378>>>>>//                     Case  (Barticl.Barticl_Lines < 0) //§¨æ™¢ž£˜, ¡á«  «¨â®œ 
44378>>>>>//                           Send Operation_Not_Allowed 9999 //«¨â¥«œ ¦¢ ¡á â¢œš®¦ ™á©žª
44378>>>>>//                     Case Break
44378>>>>>//                Case End
44378>>>>>
44378>>>>>/////////////////////Case (Barticl.Garticl_Rec0 = 0) //«¦ barticl ›â¤ â®œ  ©¬¤›œŸœå £œ master gmove
44378>>>>>/////////////////////     //If (Barticl.Gmove_Mrec0 <> 0) Error 1000 " djfdfsdds"
44378>>>>>/////////////////////Case Break
44378>>>>>      End_Procedure   // backout
44379>>>>>
44379>>>>>
44379>>>>>      Procedure Creating
44380>>>>>                Integer liBaxio_Status_From liBaxio_Status_To
44381>>>>>
44381>>>>>                Forward Send Creating
44383>>>>>
44383>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                             (Trim(String(Bmove.Bmove_Rec0)))))) to Bmove.Bmove_Recr
44384>>>>>
44384>>>>>
44384>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
44384>>>>>                //jsjsjs 24/01/2001 Add 1 to Year.Year_NumBmove
44384>>>>>
44384>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
44384>>>>>                Add 1 to Barticl.Barticl_Lines
44385>>>>>
44385>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
44385>>>>>                Add 1 to Barticl.Barticl_BmoveLa
44386>>>>>                Move Barticl.Barticl_BmoveLa to Bmove.Bmove_AA
44387>>>>>
44387>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
44387>>>>>                Add 1 to Baxio.Baxio_Bmove_Laa
44388>>>>>                Move Baxio.Baxio_Bmove_Laa to Bmove.Baxio_AA
44389>>>>>
44389>>>>>                //pourqua ??????
44389>>>>>                Get piBaxio_Status_From to liBaxio_Status_From
44390>>>>>                Get piBaxio_Status_To   to liBaxio_Status_To
44391>>>>>                //Set biBaxio_Status of liBaxio_dd to liBaxio_Status_From
44391>>>>>      End_Procedure //creating
44392>>>>>
44392>>>>>
44392>>>>>      Procedure Deleting
44393>>>>>                Integer liTemp
44394>>>>>
44394>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬,
44394>>>>>                //æ¢˜ œå¤˜  ok, œå«œ «¦ ¡á¤à ˜§¦ «¦ bmove, œå«œ ˜§¦ «¦ barticl,
44394>>>>>                //œå«œ «œ¢ ¡á ˜§æ ¦§¦¬›ã§¦«œ !
44394>>>>>                //œá¤ æ£àª ›â¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, ˜¢¢á ¡á§¦ ˜ á¢¢ž,
44394>>>>>                //§¨â§œ  ¤˜ › ˜¡æ¯à «¦ transaction, ˜¤˜¥á¨«ž«˜ ˜§¦ §¦ç «¦ â®à ¡˜¢â©œ .
44394>>>>>                //˜¬«æ ™â™˜ ˜ œ¢âš®œ«˜  ¡˜  ©«ž¤ validate delete, ˜¢¢á ¦¬© ˜©« ¡á §¨â§œ 
44394>>>>>                //¤˜ œ¢œšŸœå œ›é, › æ«  ž › ˜š¨˜­ã £§¦¨œå ¤˜ ¥œ¡ ¤ã©œ  ˜§æ cascade delete
44394>>>>>                //«¦¬ barticl.
44394>>>>>                //£œ á¢¢˜ ¢æš ˜ œ¤œ¨š¦§¦ é «ž¤ validate delete æ«˜¤ ž › ˜š¨˜­ã
44394>>>>>                //›â¤ ¥œ¡ ¤áœ  ˜§¦ «¦ bmove !
44394>>>>>                If (OPERATION_ORIGIN <> (Self));                Begin
44396>>>>>                     Get Validate_Delete to liTemp
44397>>>>>                     If (liTemp <> 0) Send Operation_Not_Allowed liTemp //á®¨ž©«¦
44400>>>>>                End
44400>>>>>>
44400>>>>>
44400>>>>>                Forward Send Deleting
44402>>>>>
44402>>>>>                //§¨é«˜ œ¤«¦§åà bkinkat
44402>>>>>                Move (private.fiBkinkat_Baxiokat_Code(Self,;                                    Btypkin.Btypkin_Recr,;                                    Baxiokat.Baxiokat_Code);                     ) to liTemp
44403>>>>>                If (liTemp = 0) Send Operation_Not_Allowed 4002 //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
44406>>>>>
44406>>>>>
44406>>>>>                //***********************************************************
44406>>>>>                //*    ˜§æ œ›é ¡˜  ¡á«à, â®à §¢â¦¤ active bkinkat record    *
44406>>>>>                //***********************************************************
44406>>>>>
44406>>>>>                //˜¨ Ÿ£æª ¡ ¤ã©œà¤ ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
44406>>>>>                //jsjsjs 24/01/2001 Sub 1 from Year.Year_NumBmove
44406>>>>>
44406>>>>>                //˜¨ Ÿ£æª š¨˜££é¤ barticl
44406>>>>>                Sub 1 from Barticl.Barticl_Lines
44407>>>>>
44407>>>>>                //˜/˜ š¨˜££ãª á¨Ÿ¨¦¬
44407>>>>>                If (Bmove.Bmove_AA = Barticl.Barticl_BmoveLa);                Sub 1 from Barticl.Barticl_BmoveLa
44410>>>>>
44410>>>>>                //˜/˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
44410>>>>>                If (Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa);                Sub 1 from Baxio.Baxio_Bmove_Laa
44413>>>>>
44413>>>>>                //š.03:œ¤ž£â¨à©ž §œ›åà¤ status + place, ˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž (bkinkat)
44413>>>>>                //     ›ž¢˜›ã œ§˜¤˜­â¨à «¦ status ¡˜  «¦ place ˜§¦ œ¡â  §¦¬ «˜ §ã¨˜.
44413>>>>>                //     ™œ™˜åàª, › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬
44413>>>>>                Move Bkinkat.Baxio_Stat_From to Baxio.Baxio_Status //¡˜«á©«˜ž :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44414>>>>>                Move Bkinkat.Baxio_Plac_From to Baxio.Baxio_Place  //œ¬¨å¡œ«˜ :˜¤á¢¦š˜ £œ «ž¤ ¡å¤ž©ž
44415>>>>>
44415>>>>>                //œ›é Ÿ˜ §¨â§œ  ¤˜ ™á¢à ¡˜  «¦¤ §¨¦žš¦ç£œ¤¦ ˜§¦›â¡«ž ! ! ! !
44415>>>>>                //     ž œ¤ž£â¨à©ž §œ›åà¤ previous «¦¬ bmove š ˜ æ¢˜ «˜ ˜¥ æš¨˜­˜
44415>>>>>                //     âš ¤œ ©«ž¤ update §¨¦«¦ç ˜¢¢á¥à «˜ last §œ›å˜ «¦¬ baxio,
44415>>>>>                //     «˜ ¡¨˜«áà ©«˜
44415>>>>>                //     previous §œ›å˜ «¦¬ bmove,
44415>>>>>                //     â«©  é©«œ ©«ž¤ deleteig ¤˜ «˜ œ§˜¤˜­â¨à ©«¦ baxio
44415>>>>>                Move Bmove.Baxio_Pfile to Baxio.Baxio_Lfile
44416>>>>>                Move Bmove.Baxio_Pcode to Baxio.Baxio_Lcode
44417>>>>>                Move Bmove.Baxio_Pepon to Baxio.Baxio_Lepon
44418>>>>>                Move Bmove.Baxio_Ppar  to Baxio.Baxio_Lpar
44419>>>>>
44419>>>>>                // js 05/09/2002
44419>>>>>                Saverecord Barticl
44420>>>>>                Saverecord Baxio
44421>>>>>
44421>>>>>      End_Procedure //deleting
44422>>>>>
44422>>>>>
44422>>>>>      Procedure Save_Main_File
44423>>>>>                Forward Send Save_Main_File
44425>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
44426>>>>>      End_Procedure//save_main_file
44427>>>>>
44427>>>>>
44427>>>>>      Procedure Delete_Main_File
44428>>>>>                Integer liTemp
44429>>>>>
44429>>>>>                Forward Send Delete_Main_File
44431>>>>>                Send private.Trexe //procedural › ˜®œå¨ ©ž bsums
44432>>>>>
44432>>>>>                //œá¤ › ˜š¨á­à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬, «æ«œ Ÿ˜ › ˜š¨á¯à ¡˜  ˜¬«æ
44432>>>>>                //¦¬© ˜©« ¡á ˜§æ œ›é ¡˜  £æ¤¦¤ ˜§¦ œ›é šå¤œ«˜  ž › ˜š¨˜­ã ˜¥ ¦š¨á­¦¬,
44432>>>>>                //œå¤˜  ¢¦ §æ¤ ž deleteing «¦¬ baxio !
44432>>>>>                If (Baxio.Baxio_Bmove_Laa = 0);                Begin
44434>>>>>
44434>>>>>                     //˜¨ Ÿ£æª ˜¥ ¦š¨á­à¤ «žª ®¨ã©žª
44434>>>>>                     //jsjsjs 26/01/2001
44434>>>>>                     //Sub 1 from Year.Year_NumBaxio
44434>>>>>
44434>>>>>                     //«œ¢œ¬«˜å˜ª ¡à› ¡æª ˜¨ Ÿ£æª ˜¥ ¦š¨á­¦¬
44434>>>>>                     If (Baxiokat.Baxio_Lcode = Baxio.Baxio_Code);                     Sub 1 from Baxiokat.Baxio_Lcode
44437>>>>>
44437>>>>>                     Delete Baxio
44438>>>>>                End
44438>>>>>>
44438>>>>>      End_Procedure //delete_main_file
44439>>>>>
44439>>>>>
44439>>>>>      Procedure Operation_Not_Allowed Integer iError_Num
44440>>>>>                String lsError_Message
44441>>>>>                Case Begin
44441>>>>>                     //˜§æ validate save
44441>>>>>                     Case (iError_Num = 5555)
44443>>>>>                          Move ("† ˜§¦Ÿã¡œ¬©ž ˜¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž");                          to lsError_Message
44444>>>>>                     Case Break
44445>>>>>                     Case (iError_Num = 1001)
44448>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† «¨¦§¦§¦åž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
44449>>>>>                     Case Break
44450>>>>>                     Case (iError_Num = 1004)
44453>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æš¨˜­¦ !");                          to lsError_Message
44454>>>>>                     Case Break
44455>>>>>                     Case (iError_Num = 1005)
44458>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n† ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æš¨˜­¦ !");                          to lsError_Message
44459>>>>>                     Case Break
44460>>>>>                     Case (iError_Num = 1006)
44463>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\n’¦ barticl â®œ  «¨¦§¦§¦ žŸœå!");                          to lsError_Message
44464>>>>>                     Case Break
44465>>>>>                     Case (iError_Num = 1100)
44468>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
44469>>>>>                     Case Break
44470>>>>>
44470>>>>>                     //˜§æ validate delete
44470>>>>>                     Case (iError_Num = 2001)
44473>>>>>                          Move ("DDC 44:€›ç¤˜«ž ž › ˜š¨˜­ã !\n\n† › ˜š¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
44474>>>>>                     Case Break
44475>>>>>                     Case (iError_Num = 2100)
44478>>>>>                          Move "DDC 44:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž" to lsError_Message
44479>>>>>                     Case Break
44480>>>>>
44480>>>>>                     //˜§æ update
44480>>>>>                     Case (iError_Num = 3001)
44483>>>>>                          Move ("DDC 44:€¡˜«á¢¢ž¢ž ‰å¤ž©ž !\n\nƒâ¤ œ§ «¨â§œ«˜  ž ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬ !");                          to lsError_Message
44484>>>>>                     Case Break
44485>>>>>                     Case (iError_Num = 3002)
44488>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ‰å¤ž©ž !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
44489>>>>>                     Case Break
44490>>>>>
44490>>>>>                     //˜§æ deleting
44490>>>>>                     Case (iError_Num = 4002)
44493>>>>>                          Move ("DDC 44:‹ã €§¦›œ¡«æª «ç§¦ª €¥ ¦š¨á­¦¬ š ˜ «ž¤ ƒ ˜š¨˜­ã !\n\n‹œ "+(Trim(Btypkin.Btypkin_Descr))+;                          " ›â¤ ¡ ¤¦ç¤«˜  " + (Trim(Baxiokat.Baxiokat_Descr)));                          to lsError_Message
44494>>>>>                     Case Break
44495>>>>>
44495>>>>>                     //˜§æ private.Transaction_Update_Other_Modules
44495>>>>>                     Case (iError_Num = 5001) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é barticl by recnum!
44498>>>>>                          Move ("DDC 44:Transaction Aborted! (Barticl Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44499>>>>>                     Case Break
44500>>>>>                     Case (iError_Num = 5002) //›â¤ £§æ¨œ©˜ ¤˜ ¥˜¤˜™¨é bsum by recnum!
44503>>>>>                          Move ("DDC 44:Transaction Aborted! (Bsum Recnum Not Found)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44504>>>>>                     Case Break
44505>>>>>                     Case (iError_Num = 5003) //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
44508>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44509>>>>>                     Case Break
44510>>>>>                     Case (iError_Num = 5004) //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
44513>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Master on Non Positive GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44514>>>>>                     Case Break
44515>>>>>                     Case (iError_Num = 5005) //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ barticl records
44518>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44519>>>>>                     Case Break
44520>>>>>                     Case (iError_Num = 5006) //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
44523>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Master not on Same Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44524>>>>>                     Case Break
44525>>>>>                     Case (iError_Num = 5007) //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
44528>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44529>>>>>                     Case Break
44530>>>>>                     Case (iError_Num = 5008) //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
44533>>>>>                          Move ("DDC 44:Transaction Aborted! (Create Slave on Non Positive GL Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44534>>>>>                     Case Break
44535>>>>>                     Case (iError_Num = 5009) //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
44538>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave on Non Connected B Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44539>>>>>                     Case Break
44540>>>>>                     Case (iError_Num = 5010) //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
44543>>>>>                          Move ("DDC 44:Transaction Aborted! (Edit Slave not on Same Record)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44544>>>>>                     Case Break
44545>>>>>                     Case (iError_Num = 5011) //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
44548>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master on Non Connected B Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44549>>>>>                     Case Break
44550>>>>>                     Case (iError_Num = 5012) //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
44553>>>>>                          Move ("DDC 44:Transaction Aborted! (Delete Master not with 0 GL Records)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «¨â¥«œ «¦¤ Ž¢ ¡æ „¢œš®¦ «žª «žª á©žª!") to lsError_Message
44554>>>>>                     Case Break
44555>>>>>
44555>>>>>                     //˜§æ private.trexe (save+delete main file)
44555>>>>>                     Case (iError_Num = 6001) //¢áŸ¦ª «¦¬ ¡é› ¡˜
44558>>>>>                          Move ("DDC 44:Transaction Aborted! (€¡˜«á¢¢ž¢¦ §¨æ©ž£¦)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
44559>>>>>                     Case Break
44560>>>>>                     Case (iError_Num = 6002) //¢áŸ¦ª «¦¬ ¡é› ¡˜
44563>>>>>                          Move ("DDC 44:Transaction Aborted! (update=0 + backout=0)\n\n"+;                                "˜¨˜¡˜¢¦ç£œ «ž¢œ­à¤ã©«œ ©«ž¤ Solution!") to lsError_Message
44564>>>>>                     Case Break
44565>>>>>
44565>>>>>                     Case Else
44565>>>>>                          Forward Send Operation_Not_Allowed iError_Num
44567>>>>>                Case End
44567>>>>>
44567>>>>>                Error iError_Num lsError_Message
44568>>>>>>
44568>>>>>      End_Procedure // operation_not_allowed
44569>>>>>
44569>>>>>
44569>>>>>
44569>>>>>
44569>>>>>     //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
44569>>>>>     //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
44569>>>>>     //1003:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent barticl
44569>>>>>     //1004:˜§˜š¦¨œçœ«˜  «¦ bmove ¤˜ ˜¢¢áœ  parent baxiokat
44569>>>>>     //1005:œá¤ ž ¡å¤ž©ž ž«áœ  ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬
44569>>>>>     //     ¡˜  ¡á¤à create bmove, §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio
44569>>>>>     //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
44569>>>>>     //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
44569>>>>>     //1007
44569>>>>>     //1008
44569>>>>>     //?1009:m_code:ž œšš¨˜­ã œ§ «¨â§œ«˜  £æ¤¦¤ ˜§¦ ¦ module §¦¬ «ž¤ ›ž£ ¦ç¨šž©œ
44569>>>>>      Function Validate_Save Returns Integer
44570>>>>>               Integer iReturnVal liBarticl_dd_Changed isNO
44571>>>>>
44571>>>>>               Forward Get Validate_Save to iReturnVal
44573>>>>>
44573>>>>>               If (Not(iReturnVal));               Begin
44575>>>>>
44575>>>>>//                If (Baxio.Baxio_HmniaL<Barticl.Barticl_Hmnia) Begin
44575>>>>>//                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ «žª œ§ «˜šãª œå¤˜ \n§¨¦šœ¤â©«œ¨ž «žª ž£œ¨¦£ž¤å˜ª «¦¬ §˜¨˜©«˜« ¡¦ç.\nŒ˜ ©¬¤œ®å©à ?' to isNO
44575>>>>>//                    If (isNO=MBR_NO) Send Operation_Not_Allowed 5555
44575>>>>>//                End
44575>>>>>
44575>>>>>                //---------â¢œš®¦  ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record----------------------
44575>>>>>                If (Bmove.Recnum =  0);                Begin //œá¤ ›ž£ ¦¬¨šé ¤â¦ bmove record
44577>>>>>                      //1005:š ˜ ¤˜ ›œ®Ÿé «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ baxio record, §¨â§œ :
44577>>>>>                      //     1.œá¤ ž ¡å¤ž©ž ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
44577>>>>>                      //       «æ«œ §¨â§œ  ¤˜ â®à æ¤«àª ¡á¤œ  ¡˜  create baxio.
44577>>>>>                      //     2.œá¤ ž ¡å¤ž©ž ›â¤ ž«áœ  «ž¤ ›ž£ ¦¬¨šå˜ ¤â¦¬ ˜¥ ¦š¨á­¦¬,
44577>>>>>                      //       «æ«œ ›â¤ §¨â§œ  ¤˜ â®à ¡á¤œ  ¡˜  create baxio.
44577>>>>>                      If ((piCan_Create_Baxio(Self)) = TRUE);                      Begin
44579>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = TRUE);                         )) Send Operation_Not_Allowed 1004 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ £œ ¤â˜ ˜¥ æ§š¨˜­¦
44582>>>>>                      End
44582>>>>>>
44582>>>>>                      Else;                      Begin
44583>>>>>                      If (Not(;                              ((piCreated_Baxio(piBaxio_dd(Self))) = FALSE);                         )) Send Operation_Not_Allowed 1005 //ž ¡å¤ž©ž œ§ «¨â§œ«˜  £æ¤¦¤ ©œ ¬§á¨®¦¤ ˜¥ æ§š¨˜­¦
44586>>>>>                      End
44586>>>>>>
44586>>>>>
44586>>>>>                      //1002:create a new bmove £æ¤¦¤ œá¤ «¦ baxio_status <> œ¥¦­¢ž£â¤¦
44586>>>>>                      //If (Not(;
44586>>>>>                      //        (Baxio.Baxio_Old_Status <> 2);
44586>>>>>                      //   )) Send Operation_Not_Allowed 1002
44586>>>>>                End   //«â¢¦ª œ¢âš®à¤ ›ž£ ¦¬¨šå˜ª ¤â¦¬ bmove record
44586>>>>>>
44586>>>>>
44586>>>>>
44586>>>>>                //---------â¢œš®¦  editing existing bmove records---------------------
44586>>>>>                Else;                Begin //edit an existing record
44587>>>>>                      //1001:Baxio_AA = baxio_bmove_laa (editing £æ¤¦¤ ©«¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
44587>>>>>                      If (Not(;                              (Baxio.Baxio_Bmove_Laa = Bmove.Baxio_AA);                         )) Send Operation_Not_Allowed 1001
44590>>>>>                End   //«â¢¦ª œ¢âš®à¤ editing existing bmove records
44590>>>>>>
44590>>>>>
44590>>>>>/////////////// js 07/08/2001  07-08-2001
44590>>>>>             // Ž ¡à› ¡˜ª ˜¬«¦ª £§ž¡œ remarks š ˜«  ž ¢¦š ¡ž £˜ª £œ©à «¦¬ ˜¤¦ ¥œ / ¡¢œ ©œ
44590>>>>>             // ¡˜  «¦ ©«ž© £¦ «žª œ­˜¨£¦šžª œ ¤˜  «œ«¦ ˜ §¦¬ ›œ¤ š ¤œ«˜  ˜¢¢ à©ž
44590>>>>>             // ˜§¦ ˜¢¢¦ ©ž£œ ¦ ©«¦ Barticl, ¡˜  œ§ §¢œ¦¤ ™˜¨˜œ  ¦«˜¤ ˜¤¦ š¦¡¢œ ¤œ 
44590>>>>>             // «¦ §˜¨˜©«˜« ¡¦ (§¨¦­˜¤àª š ˜«  £ž›œ¤ ¦¬¤ «˜ properties §¨¦ ¡˜  £œ«˜
44590>>>>>             // ˜§¦ «ž¤ private.Initialize_Properties
44590>>>>>//                //1006:›â¤ œ§ «¨â§œ«˜  save ©«¦ bmove, œá¤ «¦ barticl â®œ  šå¤œ  edit
44590>>>>>//                //     ¡˜  ›â¤ â®œ  «¨â¥œ  ž request_save
44590>>>>>//                Get Changed_State of (piBarticl_dd(Self)) to liBarticl_dd_Changed
44590>>>>>//                If (liBarticl_dd_Changed = TRUE) Send Operation_Not_Allowed 1006
44590>>>>>/////////////// js 07/08/2001  07-08-2001
44590>>>>>
44590>>>>>
44590>>>>>
44590>>>>>
44590>>>>>                //1100:cby = globals
44590>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 1100
44593>>>>>
44593>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
44593>>>>>>
44593>>>>>               Function_Return iReturnVal
44594>>>>>      End_Function //validate_save
44595>>>>>
44595>>>>>
44595>>>>>      //2001:Baxio_AA = baxio_bmove_laa (delete £æ¤¦¤ «¦¤ «œ¢œ¬«˜å¦ ˜˜ ¡å¤ž©žª «¦¬ ˜¥ ¦š¨á­¦¬)
44595>>>>>      Function Validate_Delete  Returns Integer
44596>>>>>               Integer iReturnVal
44597>>>>>               Forward Get Validate_Delete  To iReturnVal
44599>>>>>               If (Not(iReturnVal));               Begin
44601>>>>>
44601>>>>>                //2001:â¢œš®¦ª «œ¢œ¬«˜å¦¬ ˜˜ ¡å¤ž©žª ˜¥ ¦š¨á­¦¬
44601>>>>>                If (Not(Bmove.Baxio_AA = Baxio.Baxio_Bmove_Laa))       Send Operation_Not_Allowed 2001
44604>>>>>                If ( ;                    (Not(Bmove.Company_Code = SysCurXr.Company_Code)) or;                    (Not(Bmove.Branch_Code  = SysCurXr.Branch_Code )) or;                    (Not(Bmove.Year_Year    = SysCurXr.Year_Year   ));                    )                                                   Send Operation_Not_Allowed 2100
44607>>>>>
44607>>>>>               End //«â¢¦ª ¡é› ¡˜ validation
44607>>>>>>
44607>>>>>               Function_Return iReturnVal
44608>>>>>      End_Function //validate_delete
44609>>>>>
44609>>>>>
44609>>>>>      Procedure Request_Save
44610>>>>>                Integer liBaxiokat_Code liBaxio_Allow_Foreign_New_Save_State iErrorObj
44611>>>>>                String  lsBtypkin_Recr
44611>>>>>                //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties §¦¬ ˜­¦¨¦ç¤ «¦ transaction
44611>>>>>                Send private.Initialize_Properties
44612>>>>>                //˜¤áš¤à©ž «¨â®¦¬©˜ª ¡˜«á©«˜©žª «¦¬ baxio_dd
44612>>>>>                Get Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
44613>>>>>
44613>>>>>                //«¦ bkinkat_yn_new ¨¬Ÿ£åœ  œá¤ Ÿ˜ ¡á¤à œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬
44613>>>>>                Get File_Field_Current_Value File_Field Btypkin.Btypkin_Recr   to lsBtypkin_Recr
44614>>>>>                Get File_Field_Current_Value File_Field Baxiokat.Baxiokat_Code to liBaxiokat_Code
44615>>>>>
44615>>>>>                Clear Bkinkat
44616>>>>>                Move SysCurXr.Company_Code   to Bkinkat.Company_Code
44617>>>>>                Move SysCurXr.Branch_Code    to Bkinkat.Branch_Code
44618>>>>>                Move SysCurXr.Year_Year      to Bkinkat.Year_Year
44619>>>>>                Move lsBtypkin_Recr  to Bkinkat.Btypkin_Recr
44620>>>>>                Move liBaxiokat_Code to Bkinkat.Baxiokat_Code
44621>>>>>                Find Eq Bkinkat by Index.3 //company+branch+Year+btypkin_recr+baxiokat_code
44622>>>>>>
44622>>>>>                If (Found = 0) Begin //›â¤ œ§ «¨â§œ«˜  ž ¡å¤ž©ž baxiokat_code £œ «¦ btypkin
44624>>>>>                                Send Operation_Not_Allowed 3002
44625>>>>>                               End
44625>>>>>>
44625>>>>>
44625>>>>>                If (Bkinkat.Bkinkat_YN_New  = TRUE);                     Begin //œ ©˜šàšã ¤â¦¬ ˜¥ ¦š¨á­¦¬, á¨˜ œ§ «¨â§à «¦ create ©«¦ baxio
44627>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to TRUE
44628>>>>>                      Set piCan_Create_Baxio                                 to TRUE
44629>>>>>                     End
44629>>>>>>
44629>>>>>                Else Begin //› ˜¡å¤ž©ž ¬§á¨®¦¤«¦ª ˜¥ ¦š¨á­¦¬, á¨˜ ›â¤ œ§ «¨â§à «¦ create ©«¦ baxio
44630>>>>>                      Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to FALSE
44631>>>>>                      Set piCan_Create_Baxio                                 to FALSE
44632>>>>>                     End
44632>>>>>>
44632>>>>>
44632>>>>>                Forward Send Request_Save
44634>>>>>
44634>>>>>                //œ§˜¤˜¤˜­¦¨á ˜¨® ¡ãª ¡˜«á©«˜©žª «¦¬ baxio_dd
44634>>>>>                Set Allow_Foreign_New_Save_State of (piBaxio_dd(Self)) to liBaxio_Allow_Foreign_New_Save_State
44635>>>>>                Set Smart_Filemode_State to True
44636>>>>>                //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
44636>>>>>                Send private.Initialize_Properties
44637>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
44637>>>>>                Indicate Err False
44638>>>>>      End_Procedure //request_save
44639>>>>>
44639>>>>>
44639>>>>>      Procedure Request_Delete
44640>>>>>                Integer iErrorObj
44641>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª æ¢à¤ «à¤ ©®œ« ¡é¤ properties
44642>>>>>                Forward Send Request_Delete
44644>>>>>                Send private.Initialize_Properties //£ž›œ¤ ©£æª properties š ˜ œ§æ£œ¤ž ¡å¤ž©ž
44645>>>>>                //œ§˜¤˜­¦¨á «¦¬ system indicator err
44645>>>>>                Indicate Err False
44646>>>>>      End_Procedure   //request_delete
44647>>>>>
44647>>>>>
44647>>>>>//      //ž ¨¦¬«å¤˜ ˜¬«ã ˜¤˜¢˜£™á¤œ  ¤˜ œ¤ž£œ¨é©œ  æ©˜ ˜§¦ «˜ ¬§æ¢¦ §˜ 3 modules «¦¬ ©¬©«ã£˜«¦ª
44647>>>>>//      //§¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤.
44647>>>>>//      //¡˜¢œå«˜  ˜§æ « ª request save & delete, £â©˜ ˜§æ transaction.
44647>>>>>//      //œ§ ©«¨â­œ  ¢áŸž : 5001 - 5012 š ˜ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
44647>>>>>//      Procedure private.Transaction_Update_Other_Modules
44647>>>>>//                Integer liDo_GL_Maintainance liDo_CUSTOMER_Maintainance liDo_VENDOR_Maintainance
44647>>>>>//                Integer liMust_Update_GL     liMust_Update_CUSTOMER     liMust_Update_VENDOR
44647>>>>>
44647>>>>>//                //š ˜ «ž¤ œç¨œ©ž «¦¬ bsum
44647>>>>>//                String lsBaxiokat_Recr
44647>>>>>
44647>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl & bsum ˜§¦ «ž¤ šœ¤ ¡ã ¢¦š ©« ¡ã
44647>>>>>//                Integer liF_Garticl_Rec0 liF_Gmove_Master_Rec0 liF_Gmove_Slave_Rec0
44647>>>>>
44647>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §œ¢á«œª
44647>>>>>//                Integer liF_Carticl_Rec0 liF_Cmove_Rec0
44647>>>>>
44647>>>>>//                //final values, š ˜ «ã¤ feedback œ¤ž£â¨à©ž «¦¬ barticl ˜§¦ «¦çª §¨¦£žŸœ¬«âª
44647>>>>>//                Integer liF_Varticl_Rec0 liF_Vmove_Rec0
44647>>>>>
44647>>>>>//               //4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
44647>>>>>//               Integer liFlag02 liFlag03 liFlag04 liFlag05
44647>>>>>
44647>>>>>
44647>>>>>//                //œç¨œ©ž «à¤ ¢¦ §é¤ modules §¦¬ §¨â§œ  ¤˜ œ¤ž£œ¨àŸ¦ç¤
44647>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Gtypkin_Rec0 to liMust_Update_GL
44647>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Ctypkin_Rec0 to liMust_Update_CUSTOMER
44647>>>>>//                Get Field_Current_Value of (piBtypkin_dd(Self)) Field Btypkin.Vtypkin_Rec0 to liMust_Update_VENDOR
44647>>>>>
44647>>>>>//               //˜¤áš¤à©ž «à¤ 4 flags §¦¬ §œ¨¤á¤œ £œ ¦¨å©£˜«˜ ©« ª bpo «žª š¢
44647>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag02 to liFlag02
44647>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag03 to liFlag03
44647>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag04 to liFlag04
44647>>>>>//               Get File_Field_Current_Value File_Field Btypkin.Btypkin_Flag05 to liFlag05
44647>>>>>
44647>>>>>
44647>>>>>//                //                                                  s  l  a  v  e  = bsum
44647>>>>>//                //                                        edit        create        delete
44647>>>>>//                //                                       -----        ------        ------
44647>>>>>//                // master garticl + gmove     edit         x            x              x
44647>>>>>//                //                            create                    x
44647>>>>>//                //                            delete                                   x
44647>>>>>//                // slave  gmove               edit         x            x              x
44647>>>>>//                //                            create                    x
44647>>>>>//                //                            delete                                   x
44647>>>>>
44647>>>>>
44647>>>>>//                If (;
44647>>>>>//                    ( liMust_Update_Gl     > 0                   ) and;
44647>>>>>//                    ((pnB_Baxio_V2(Self)) <> (pnA_Baxio_V2(Self)));
44647>>>>>//                   );
44647>>>>>//                Begin //edit œ§ «¨â§œ«˜  £æ¤¦¤ ©«ž¤ ˜¥å˜ v2 !
44647>>>>>//                //***************************************************************************
44647>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
44647>>>>>//                //***************************************************************************
44647>>>>>//                //œ­'æ©¦¤ «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á, §¨¦®à¨áà ©«ž¤ bpo
44647>>>>>//                //š ˜ «ž¤ œ¤ž£â¨à©ž «žª šœ¤ ¡ãª ¢¦š ©« ¡ãª, œá¤ æ£àª ®¨œ áœ«˜ ]
44647>>>>>
44647>>>>>//// jsjsjs 24/01/2001
44647>>>>>////                Send Transaction_BCVWmove_Update_GL to (piDo_GL_Maintainance(Self)) (Self);
44647>>>>>////                                                                                    liFlag02;
44647>>>>>////                                                                                    liFlag03;
44647>>>>>////                                                                                    liFlag04;
44647>>>>>////                                                                                    liFlag05
44647>>>>>//// jsjsjs 24/01/2001
44647>>>>>
44647>>>>>//                //œ­'æ©¦¤ ¡˜  «¦ bmove record ©éŸž¡œ/› ˜š¨á­ž¡œ ¡˜¤¦¤ ¡á,
44647>>>>>//                //¡˜  ž bpo â«¨œ¥œ ®à¨åª error,  ¡˜«˜®à¨é «¦ transaction
44647>>>>>//                //¡˜  œ¤ž£œ¨é¤à «© ©®œ« ¡á ˜¨®œå˜, › ˜™á¦¤«˜ª «˜
44647>>>>>//                //3 properties §¦¬ â®œ  œ§ ©«¨â¯œ  ž bpo œ¤ž£â¨à©žª «žª š¢
44647>>>>>//                Get piF_Garticl_Rec0      to liF_Garticl_Rec0       //barticl
44647>>>>>//                Get piF_Gmove_Master_Rec0 to liF_Gmove_Master_Rec0  //barticl
44647>>>>>//                Get piF_Gmove_Slave_Rec0  to liF_Gmove_Slave_Rec0   //bmove
44647>>>>>
44647>>>>>//                //œ¤ž£â¨à©ž bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
44647>>>>>//                //œç¨œ©ž barticl, › æ«  œå¤˜  ˜§˜¨˜å«ž«¦ ©œ æ¢˜ «˜ operations
44647>>>>>//                Clear Barticl
44647>>>>>//                Get Current_Record of (piBarticl_dd(Self)) to Barticl.Recnum
44647>>>>>//                Find Eq Barticl.Recnum
44647>>>>>//                If (Found = 0);
44647>>>>>//                Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é barticl by recnum
44647>>>>>//                      Send Operation_Not_Allowed 5001
44647>>>>>//                End
44647>>>>>
44647>>>>>//                //=======================================================================
44647>>>>>//                //œ­'æ©¦¤ ¡á¤à create or edit ©«¦ bmove,
44647>>>>>//                //™á©œ  «¦¬ §å¤˜¡˜ ©«¦ master ¡á¤à create or edit
44647>>>>>//                If ((piUpdate(Self)) = TRUE);
44647>>>>>//                Begin
44647>>>>>//                     //œç¨œ©ž bsum, «¦ ¦§¦å¦ ®¨œ áœ«˜  £æ¤¦¤ œ›é ¡˜  æ®  ©«ž¤ ¦¢ ¡ã › ˜š¨˜­ã «¦¬ garticl
44647>>>>>//                     Get Field_Current_Value of (piBaxiokat_dd(Self)) Field Baxiokat.Baxiokat_Recr to lsBaxiokat_Recr
44647>>>>>//                     Clear Bsum
44647>>>>>//                     Move Barticl.Barticl_Recr to Bsum.Barticl_Recr
44647>>>>>//                     Move lsBaxiokat_Recr      to Bsum.Baxiokat_Recr
44647>>>>>//                     Find Eq Bsum by Index.1 //barticl_recr+baxiokat_recr !!!!!!
44647>>>>>//                     If (Found=0);
44647>>>>>//                     Begin //›â¤ £§æ¨œ©˜ ¤˜ ™¨é bsum by recnum
44647>>>>>//                           Send Operation_Not_Allowed 5002
44647>>>>>//                     End
44647>>>>>
44647>>>>>//                     //œ¤ž£â¨à©ž master (create or edit)
44647>>>>>//                     Case Begin
44647>>>>>//                          //©«¦ create master, §¨â§œ  ž ©ç¤›œ©ž ¤© šå¤œ  «é¨˜,
44647>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  0,
44647>>>>>//                          //œ¤é «˜ master records «žª š¢ §¨â§œ  ¤˜ â®¦¬¤ Ÿœ« ¡ã « £ã.
44647>>>>>//                          Case ((piGarticl_Create(Self)) = TRUE)
44647>>>>>//                               If (;
44647>>>>>//                                    (Barticl.Garticl_Rec0 <> 0) or;
44647>>>>>//                                    (Barticl.Gmove_Mrec0  <> 0);
44647>>>>>//                                  ) Send Operation_Not_Allowed 5003 //«¦ create master âš ¤œ ©œ ã›ž ©¬¤›œ›œ£â¤¦ barticl
44647>>>>>//                               If (;
44647>>>>>//                                    (liF_Garticl_Rec0       <= 0) or;
44647>>>>>//                                    (liF_Gmove_Master_Rec0  <= 0);
44647>>>>>//                                  ) Send Operation_Not_Allowed 5004 //«¦ create master âš ¤œ ©œ £ã Ÿœ« ¡á gl records
44647>>>>>//                               Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //©ç¤›œ©ž £œ garticl
44647>>>>>//                               Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //©ç¤›œ©ž £œ master gmove
44647>>>>>//                               Saverecord Barticl
44647>>>>>//                          Case Break
44647>>>>>
44647>>>>>//                          //©«¦ edit master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
44647>>>>>//                          //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
44647>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«˜ å› ˜ master records
44647>>>>>//                          Case Else
44647>>>>>//                               If (;
44647>>>>>//                                    (Barticl.Garticl_Rec0 <= 0) or;
44647>>>>>//                                    (Barticl.Gmove_Mrec0  <= 0);
44647>>>>>//                                  ) Send Operation_Not_Allowed 5005 //«¦ edit master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
44647>>>>>//                               If (;
44647>>>>>//                                    (liF_Garticl_Rec0      <> Barticl.Garticl_Rec0) or;
44647>>>>>//                                    (liF_Gmove_Master_Rec0 <> Barticl.Gmove_Mrec0 );
44647>>>>>//                                  ) Send Operation_Not_Allowed 5006 //«¦ edit master ›â¤ âš ¤œ ©«˜ å› ˜ master records
44647>>>>>//                          Case Break
44647>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª master
44647>>>>>
44647>>>>>//                     //œ¤ž£â¨à©ž slave (create or edit)
44647>>>>>//                     Case Begin
44647>>>>>//                          //©«¦ create slave, §¨â§œ  ž ©ç¤›œ©ž ¤˜ šå¤œ  «é¨˜,
44647>>>>>//                          //›ž¢˜›ã §¨â§œ  «o 1 §œ›åo ¤˜ œå¤˜  0,
44647>>>>>//                          //œ¤é «o slave record «žª š¢ §¨â§œ  ¤˜ â®œ  Ÿœ« ¡ã « £ã.
44647>>>>>//                          Case ((piSlave_Gmove_Create(Self)) = TRUE)
44647>>>>>//                               If (Bsum.Gmove_Srec0 <> 0);
44647>>>>>//                                    Send Operation_Not_Allowed 5007 //«¦ create slave âš ¤œ ©œ œå¤˜  ã›ž ©¬¤›œ›œ£â¤¦ bsum
44647>>>>>//                               If (liF_Gmove_Slave_Rec0  <= 0);
44647>>>>>//                                    Send Operation_Not_Allowed 5008 //«¦ create slave âš ¤œ ©œ £ã Ÿœ« ¡æ gl record
44647>>>>>//                               Move liF_Gmove_Slave_Rec0  to Bsum.Gmove_Srec0     //©ç¤›œ©ž £œ slave gmove
44647>>>>>//                               Saverecord Bsum
44647>>>>>//                          Case Break
44647>>>>>
44647>>>>>//                          //©«¦ edit slave, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
44647>>>>>//                          //›ž¢˜›ã §¨â§œ  «¦ 1 §œ›å¦ ¤˜ œå¤˜  > 0
44647>>>>>//                          //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  ¡á¤˜£œ œ¤ž£â¨à©ž «žª š¢ ©«¦ å› ¦ slave record
44647>>>>>//                          Case Else
44647>>>>>//                               If (Bsum.Gmove_Srec0 =  0);
44647>>>>>//                                    Send Operation_Not_Allowed 5009 //«¦ edit slave âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤¦ record
44647>>>>>//                               If (liF_Gmove_Slave_Rec0  <> Bsum.Gmove_Srec0);
44647>>>>>//                                    Send Operation_Not_Allowed 5010 //«¦ edit slave ›â¤ âš ¤œ ©«¦ å› ¦ slave record
44647>>>>>//                          Case Break
44647>>>>>//                     Case End //«â¢¦ª œ¤ž£â¨à©žª slave
44647>>>>>//                End //«â¢¦ª œ¤ž£â¨à©žª edit or create bmove & barticl & bsum š ˜ « ª œšš¨˜­âª ©«á á¢¢˜ modules
44647>>>>>//                //=======================================================================
44647>>>>>
44647>>>>>//                //œ­'æ©¦¤ ©™ã¤à «ž¤ «œ¢œ¬«˜å˜ ¡å¤ž©ž «¦¬ barticl,
44647>>>>>//                //®à¨åª æ£àª ¤˜ ©™ã©à ˜¬«æ,
44647>>>>>//                //£ž›œ¤åà ©«¦ barticl «¦ Garticl_Rec0 & Gmove_Mrec0,
44647>>>>>//                //š ˜ ¤˜ ˜§¦©¬¤›â©à «¦ barticl ˜§¦ «¦ garticl & «¦ gmove
44647>>>>>//                If ((piGarticl_Delete(Self)) = TRUE);
44647>>>>>//                Begin
44647>>>>>//                     //©«¦ delete master, §¨â§œ  ž ©ç¤›œ©ž ã›ž ¤˜ ¬§á¨®œ ,
44647>>>>>//                     //›ž¢˜›ã §¨â§œ  ¡˜  «˜ 2 §œ›å˜ ¤˜ œå¤˜  > 0
44647>>>>>//                     //¡˜  £á¢ ©«˜ ¤˜ © š¦¬¨œ¬«¦ç£œ æ«  «˜ master records «žª š¢ œå¤˜  £ž›œ¤ ¡á
44647>>>>>//                     If (;
44647>>>>>//                          (Barticl.Garticl_Rec0 <= 0) or;
44647>>>>>//                          (Barticl.Gmove_Mrec0  <= 0);
44647>>>>>//                        ) Send Operation_Not_Allowed 5011 //«¦ delete master âš ¤œ ©œ £ã ©¬¤›œ›œ£â¤˜ records
44647>>>>>//                     If (;
44647>>>>>//                          (liF_Garticl_Rec0      <> 0) or;
44647>>>>>//                          (liF_Gmove_Master_Rec0 <> 0);
44647>>>>>//                        ) Send Operation_Not_Allowed 5012 //«¦ delete master ›â¤ â›à©œ £ž›œ¤ ¡á master records «žª š¢
44647>>>>>//                     Move liF_Garticl_Rec0      to Barticl.Garticl_Rec0 //˜§¦©ç¤›œ©ž £œ garticl
44647>>>>>//                     Move liF_Gmove_Master_Rec0 to Barticl.Gmove_Mrec0  //˜§¦˜ç¤›œ©ž £œ master gmove
44647>>>>>//                     Saverecord Barticl
44647>>>>>//                End //«â¢¦ª ˜§¦©ç¤›œ©žª barticl ˜§¦ garticl & gmove
44647>>>>>//                //****************************************************************************
44647>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘    ‚ „ Œ ˆ ‰ † ‘    Š Ž ‚ ˆ ‘ ’ ˆ ‰ † ‘ *
44647>>>>>//                //****************************************************************************
44647>>>>>//                End //if (liMust_Update_Gl > 0) and ...
44647>>>>>
44647>>>>>
44647>>>>>
44647>>>>>//                If (liMust_Update_CUSTOMER > 0);
44647>>>>>//                Begin
44647>>>>>//                //****************************************************************************
44647>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                         *
44647>>>>>//                //****************************************************************************
44647>>>>>//                //****************************************************************************
44647>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘     „ Š € ’ — Œ                        *
44647>>>>>//                //****************************************************************************
44647>>>>>//                End //if (liMust_Update_CUSTOMER > 0)
44647>>>>>
44647>>>>>
44647>>>>>
44647>>>>>//                If (liMust_Update_VENDOR  > 0);
44647>>>>>//                Begin
44647>>>>>//                //****************************************************************************
44647>>>>>//                //*  €  • †    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                 *
44647>>>>>//                //****************************************************************************
44647>>>>>//                //****************************************************************************
44647>>>>>//                //* ’ „ Š Ž ‘    „ Œ † ‹ „  — ‘ † ‘      Ž ‹ † ‡ „ “ ’ — Œ                *
44647>>>>>//                //****************************************************************************
44647>>>>>//                End //if (liMust_Update_VENDOR > 0)
44647>>>>>
44647>>>>>//      End_Procedure //private.transaction_update_other_modules
44647>>>>>
44647>>>>>
44647>>>>>              //§˜¨'æ¢¦ §¦¬ œå¤˜  ..›ç¤˜£ž, ›â¤ §˜å¦¬¤ › æ«  «˜ §œ›å˜ œå¤˜  display only ! ¡˜  foreign fields
44647>>>>>              //Set File_Field_Entry File_Field Barticl.Garticl_Rec0 FALSE to liF_Garticl_Rec0
44647>>>>>              //Set File_Field_Entry File_Field Barticl.Gmove_Mrec0  FALSE to liF_Gmove_Master_Rec0
44647>>>>>              //Set File_Field_Entry File_Field Barticl.Gplan_Mrec0  FALSE to liF_Gplan_Master_Rec0
44647>>>>>
44647>>>>>              //Set File_Field_Entry File_Field Bmove.Gmove_Srec0    FALSE to liF_Gmove_Slave_Rec0
44647>>>>>              //Set File_Field_Entry File_Field Bmove.Gplan_Srec0    FALSE to liF_Gplan_Slave_Rec0
44647>>>>>
44647>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Garticl_Rec0 to liF_Garticl_Rec0
44647>>>>>               //Set File_Field_Changed_Value File_Field Barticl.Gmove_Mrec0  to liF_Gmove_Master_Rec0
44647>>>>>              //Set File_Field_Changed_Value File_Field Barticl.Gplan_Mrec0  to liF_Gplan_Master_Rec0
44647>>>>>
44647>>>>>               //Set Field_Changed_Value      Field      Bmove.Gmove_Srec0    to liF_Gmove_Slave_Rec0
44647>>>>>               //Set Field_Changed_Value      Field      Bmove.Gplan_Srec0    to liF_Gplan_Slave_Rec0
44647>>>>>
44647>>>>>
44647>>>>>               //Forward Send Request_Save
44647>>>>>
44647>>>>>
44647>>>>>
44647>>>>>
44647>>>>>
44647>>>>>//--------------------------------------------------------------------------------
44647>>>>>    Procedure Define_Fields
44648>>>>>        Forward Send Define_Fields
44650>>>>>        //DDB-Generated-Code-Location
44650>>>>>        //DDB-DefineFieldStart
44650>>>>>
44650>>>>>        Set Main_File            To Bmove.File_Number
44651>>>>>        Set Cascade_Delete_State To FALSE
44652>>>>>
44652>>>>>
44652>>>>>        // Parent (Server) file structure...............
44652>>>>>        Send Add_Server_File  Barticl.File_Number
44653>>>>>        Send Add_Server_File  Baxio.File_Number
44654>>>>>
44654>>>>>        // External (System) file structure.............
44654>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_ALL
44655>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
44656>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
44657>>>>>
44657>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
44660>>>>>
44660>>>>>        // Field-based properties.......................
44660>>>>>
44660>>>>>        // Bmove.Company_Code
44660>>>>>
44660>>>>>        // Bmove.Branch_Code
44660>>>>>
44660>>>>>        // Bmove.Year_Year
44660>>>>>
44660>>>>>        // Bmove.Btypkin_Code
44660>>>>>
44660>>>>>        // Bmove.Barticl_Hmnia
44660>>>>>
44660>>>>>        // Bmove.Barticl_No
44660>>>>>
44660>>>>>        // Bmove.Baxio_Code
44660>>>>>
44660>>>>>        // Bmove.Barticl_Recr
44660>>>>>
44660>>>>>        // Bmove.Baxio_Recr
44660>>>>>
44660>>>>>        // Bmove.Bmove_Rec0
44660>>>>>
44660>>>>>        // Bmove.Bmove_Recr
44660>>>>>
44660>>>>>        // Bmove.Bmove_Aa
44660>>>>>
44660>>>>>        // Bmove.Baxio_Aa
44660>>>>>
44660>>>>>        // Bmove.Gplan_Srec0
44660>>>>>
44660>>>>>        // Bmove.Baxio_Pfile
44660>>>>>
44660>>>>>        // Bmove.Baxio_Pcode
44660>>>>>
44660>>>>>        // Bmove.Baxio_Pepon
44660>>>>>
44660>>>>>        // Bmove.Baxio_Ppar
44660>>>>>
44660>>>>>        // Bmove.Btypkin_Recr
44660>>>>>
44660>>>>>        // Bmove.Sls_Id
44660>>>>>
44660>>>>>        // Bmove.Cnt_Id
44660>>>>>
44660>>>>>        // Bmove.Presp_Id
44660>>>>>
44660>>>>>        // Bmove.Bmove_M_Code
44660>>>>>
44660>>>>>        // Bmove.Cmoves_Recr
44660>>>>>
44660>>>>>        // Bmove.Exei_Enhmerosei
44660>>>>>
44660>>>>>        // Bmove.Hmnia_Enhmeros
44660>>>>>
44660>>>>>        //DDB-DefineFieldEnd
44660>>>>>
44660>>>>>        Set Main_File            To Bmove.File_Number
44661>>>>>        Set Cascade_Delete_State To FALSE
44662>>>>>
44662>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
44663>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
44664>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
44665>>>>>
44665>>>>>        // Parent (Server) file structure...............
44665>>>>>        Send Add_Server_File  Baxio.File_Number
44666>>>>>        Send Add_Server_File  Barticl.File_Number
44667>>>>>
44667>>>>>        // External (System) file structure.............
44667>>>>>        Send Add_System_File  Sysrecb.File_Number  DD_LOCK_ON_NEW_SAVE
44668>>>>>        Send Add_System_File  Bkinkat.File_Number  DD_LOCK_ON_ALL
44669>>>>>        Send Add_System_File  Bsum.File_Number  DD_LOCK_ON_ALL
44670>>>>>
44670>>>>>        Define_Auto_Increment  Sysrecb.Bmove_Rec0  To Bmove.Bmove_Rec0
44673>>>>>
44673>>>>>        // Field-based properties.......................
44673>>>>>
44673>>>>>        // Bmove.Company_Code
44673>>>>>
44673>>>>>        // Bmove.Branch_Code
44673>>>>>
44673>>>>>        // Bmove.Year_Year
44673>>>>>
44673>>>>>        // Bmove.Btypkin_Code
44673>>>>>
44673>>>>>        // Bmove.Barticl_Hmnia
44673>>>>>
44673>>>>>        // Bmove.Barticl_No
44673>>>>>
44673>>>>>        // Bmove.Barticl_Rec0
44673>>>>>
44673>>>>>        // Bmove.Baxio_Rec0
44673>>>>>
44673>>>>>        // Bmove.Bmove_Rec0
44673>>>>>
44673>>>>>        // Bmove.Bmove_Aa
44673>>>>>        Set Field_Options          Field Bmove.Bmove_Aa           To DD_DISPLAYONLY
44674>>>>>
44674>>>>>        // Bmove.Baxio_Aa
44674>>>>>        Set Field_Options          Field Bmove.Baxio_Aa           To DD_DISPLAYONLY
44675>>>>>
44675>>>>>        // Bmove.Gplan_Srec0
44675>>>>>        Set Field_Options          Field Bmove.Gplan_Srec0        To DD_DISPLAYONLY
44676>>>>>
44676>>>>>        // Bmove.Baxio_Pfile
44676>>>>>
44676>>>>>        // Bmove.Baxio_Pcode
44676>>>>>
44676>>>>>        // Bmove.Baxio_Pepon
44676>>>>>
44676>>>>>        // Bmove.Baxio_Ppar
44676>>>>>
44676>>>>>    End_Procedure    // Define_Fields
44677>>>>>
44677>>>>>
44677>>>>>    Procedure Field_Defaults
44678>>>>>        Forward Send Field_Defaults
44680>>>>>        //DDB-Generated-Code-Location
44680>>>>>        //DDB-FieldDefaultStart
44680>>>>>        //DDB-FieldDefaultEnd
44680>>>>>    End_Procedure    // Field_Defaults
44681>>>>>
44681>>>>>End_Class    // Bmove_DataDictionary
44682>>>>>//DDB-FileEnd
44682>>>
44682>>>//AB-IgnoreEnd
44682>>>
44682>>>ACTIVATE_VIEW Activate_VW037 FOR VW037
44686>>>
44686>>>Object VW037 is a dbViewSub
44688>>>
44688>>>    //AB-StoreTopStart
44688>>>                                            
44688>>>    //AB-StoreTopEnd
44688>>>
44688>>>    Set Label to "V037:€¥ æš¨˜­˜"
44689>>>    Set Size to 278 515
44690>>>    Set Location to 0 5
44691>>>
44691>>>    //AB-DDOStart
44691>>>
44691>>>    Object Btypkin_DD is a Btypkin_DataDictionary
44693>>>
44693>>>        //AB-StoreStart
44693>>>                                                                                                                                                                                                        
44693>>>        Set Field_Prompt_Object Field Btypkin.Btypkin_Code to None
44694>>>        
44694>>>        
44694>>>        
44694>>>        //AB-StoreEnd
44694>>>
44694>>>    End_Object    // Btypkin_DD
44695>>>
44695>>>    Object Baxiokat_DD is a Baxiokat_DataDictionary
44697>>>
44697>>>        //AB-StoreStart
44697>>>                                                                                                                                                                                                        
44697>>>        Set Field_Options Field Baxiokat.Baxiokat_Code  to DD_Clear_Field_Options DD_Required
44698>>>        
44698>>>        Set Foreign_Field_Options DD_IndexField         to DD_Clear_Field_Options DD_FindReq
44699>>>        Set Foreign_Field_Options DD_KeyField           to DD_Clear_Field_Options DD_FindReq
44700>>>        
44700>>>        
44700>>>        //AB-StoreEnd
44700>>>
44700>>>    End_Object    // Baxiokat_DD
44701>>>
44701>>>    Object Barticl_DD is a Barticl_DataDictionary
44703>>>        Set DDO_Server to (Btypkin_DD(self))
44704>>>
44704>>>        //AB-StoreStart
44704>>>                                                                                                                                                                                                        
44704>>>        Set Field_Prompt_Object Field Barticl.Barticl_Hmnia to None
44705>>>        Set Field_Prompt_Object Field Barticl.Barticl_No    to None
44706>>>        
44706>>>        //AB-StoreEnd
44706>>>
44706>>>    End_Object    // Barticl_DD
44707>>>
44707>>>    Object Baxio_DD is a Baxio_DataDictionary
44709>>>        Set DDO_Server to (Baxiokat_DD(self))
44710>>>
44710>>>        //AB-StoreStart
44710>>>        set pimustnotconstrain to 2
44711>>>        Function Validate_Save Returns Integer
44713>>>            Integer rVal
44714>>>            Forward Get Validate_Save to rVal
44716>>>            If (Not(rval)) If (Not(Current_Record(Self))) Move 1 to rVal
44721>>>            Function_Return rVal
44722>>>        End_Procedure // Validate_Save
44723>>>        
44723>>>        
44723>>>        // AYTA ENERGOPOIOYNTAI MONO GIA KOZANH KAI APENERGOPOIOYME THN
44723>>>        // VALIDATE_SAVE APO PANO
44723>>>        // GIA NA MPORESEI NA DIAGRAPSEI 2PLO PERASMENA SOMATA
44723>>>        // APO 2PLH METAFORA AXIOGRAFON STHN ALLAGH THS XRHSHS
44723>>>        //Function Validate_Delete  Returns Integer
44723>>>        //       Integer iReturnVal
44723>>>        //       Function_Return iReturnVal
44723>>>        //End_Function //validate_delete
44723>>>        
44723>>>        //Procedure Request_Save
44723>>>        //End_Procedure
44723>>>        
44723>>>        
44723>>>        
44723>>>        
44723>>>        
44723>>>        
44723>>>        
44723>>>        //AB-StoreEnd
44723>>>
44723>>>    End_Object    // Baxio_DD
44724>>>
44724>>>    Object Syscurxr_DD is a Syscurxr_DataDictionary
44726>>>    End_Object    // Syscurxr_DD
44727>>>
44727>>>    Object Bmove_DD is a Bmove_DataDictionary
44729>>>        Set DDO_Server to (Barticl_DD(self))
44730>>>        Set DDO_Server to (Baxio_DD(self))
44731>>>        Set Constrain_File to Baxio.File_Number
44732>>>
44732>>>        //AB-StoreStart
44732>>>        set pimustnotconstrain to 2
44733>>>        Set Ordering to 4
44734>>>        
44734>>>        Function Validate_Save Returns Integer
44736>>>            Function_Return 1
44737>>>        End_Procedure // Validate_Save
44738>>>        
44738>>>        Function Validate_Delete  Returns Integer
44740>>>            Function_Return 1
44741>>>        End_Function // Validate_Delete
44742>>>        
44742>>>        
44742>>>        
44742>>>        
44742>>>        
44742>>>        
44742>>>        //AB-StoreEnd
44742>>>
44742>>>    End_Object    // Bmove_DD
44743>>>
44743>>>    Set Main_DD to (Baxio_DD(self))
44744>>>    Set Server to (Baxio_DD(self))
44745>>>
44745>>>    //AB-DDOEnd
44745>>>
44745>>>    Object Baxiokat_Baxiokat_Code is a dbFormSub
44747>>>        Entry_Item Baxiokat.Baxiokat_code
44748>>>        Set Size to 13 42
44749>>>        Set Location to 36 41
44750>>>        Set Label_Col_Offset to 35
44751>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44752>>>    End_Object    // Baxiokat_Baxiokat_Code
44753>>>
44753>>>    Object Baxiokat_Baxiokat_Descr is a dbFormSub
44755>>>        Entry_Item Baxiokat.Baxiokat_descr
44756>>>        Set Size to 13 182
44757>>>        Set Location to 36 86
44758>>>        Set Label_Col_Offset to 2
44759>>>        Set Label_Justification_Mode to jMode_Right
44760>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44761>>>    End_Object    // Baxiokat_Baxiokat_Descr
44762>>>
44762>>>    Object Baxio_Baxio_Code is a dbFormSub
44764>>>        Entry_Item Baxio.Baxio_code
44765>>>        Set Size to 13 116
44766>>>        Set Location to 50 41
44767>>>        Set Label_Col_Offset to 35
44768>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44769>>>
44769>>>        //AB-StoreStart
44769>>>                                                                                                                                                                                                        
44769>>>        Procedure Prompt_Callback Integer hPrompt
44771>>>            Integer liBaxiokatCode
44772>>>            Get Field_Current_Value of Baxiokat_DD Field Baxiokat.Baxiokat_Code to liBaxiokatCode
44773>>>            Set piFragmaBaxiokatCode of hPrompt to liBaxiokatCode
44774>>>            Set Auto_Index_State of hPrompt to False
44775>>>        End_Procedure // Prompt_Callback
44776>>>        
44776>>>        
44776>>>        
44776>>>        
44776>>>        
44776>>>        
44776>>>        //AB-StoreEnd
44776>>>
44776>>>    End_Object    // Baxio_Baxio_Code
44777>>>
44777>>>    Object Baxio_Baxio_Status is a dbFormSub
44779>>>
44779>>>        //AB-StoreTopStart
44779>>>                                                                                                                                                                                                        
44779>>>        Function Show_Status_Descr Returns String
44781>>>            Integer iValue iSrv iField iObj liStatusId
44782>>>            String sDesc sVal
44782>>>            If (Current_Record(Baxio_DD(Self))) Begin
44784>>>                Get Server of Baxio_Baxio_Status to iSrv
44785>>>                Get_FieldNumber Baxio.Baxio_Status to iField
44786>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Status to sVal
44787>>>                Move Baxio_Status_VT to iObj
44788>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
44791>>>                Function_Return sDesc
44792>>>            End
44792>>>>
44792>>>        End_Function // Show_Status_Descr
44793>>>        
44793>>>        //AB-StoreTopEnd
44793>>>
44793>>>        Entry_Item (Show_Status_Descr(Self))
44794>>>        Set Size to 13 116
44795>>>        Set Location to 36 340
44796>>>        Set Label_Col_Offset to 50
44797>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44798>>>
44798>>>        //AB-StoreStart
44798>>>                                                                                                                                                                                                        
44798>>>                                                                                                                                                                                                        
44798>>>        //AB-StoreEnd
44798>>>
44798>>>    End_Object    // Baxio_Baxio_Status
44799>>>
44799>>>    Object Baxio_Baxio_Place is a dbFormSub
44801>>>
44801>>>        //AB-StoreTopStart
44801>>>                                                                                                                                                                                                        
44801>>>        Function Show_Place_Descr Returns String
44803>>>            Integer iValue iSrv iField iObj liStatusId
44804>>>            String sDesc sVal
44804>>>            If (Current_Record(Baxio_DD(Self))) Begin
44806>>>                Get Server of Baxio_Baxio_Place to iSrv
44807>>>                Get_FieldNumber Baxio.Baxio_Place to iField
44808>>>                Get Field_Current_Value of iSrv Field Baxio.Baxio_Place to sVal
44809>>>                Move Baxio_Baxio_Place_VT to iObj
44810>>>                If (iObj) get Find_Code_Description of iObj sVal to sDesc
44813>>>                Function_Return sDesc
44814>>>            End
44814>>>>
44814>>>        End_Function // Show_Place_Descr
44815>>>        
44815>>>        //AB-StoreTopEnd
44815>>>
44815>>>        Entry_Item (Show_Place_Descr(Self))
44816>>>        Set Size to 13 116
44817>>>        Set Location to 50 340
44818>>>        Set Label_Col_Offset to 50
44819>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44820>>>
44820>>>        //AB-StoreStart
44820>>>                                                                                                                                                                                                        
44820>>>                                                                                                                                                                                                        
44820>>>                                                                                                                                                                                                        
44820>>>                                                                                                                                                                                                        
44820>>>                                                                                                                                                                                                        
44820>>>                                                                                                                                                                                                        
44820>>>        //AB-StoreEnd
44820>>>
44820>>>    End_Object    // Baxio_Baxio_Place
44821>>>
44821>>>    Object dbTbDlgAxio is a dbTabDialogSub
44823>>>        Set Size to 191 507
44824>>>        Set Location to 70 2
44825>>>        Object TP_Additional is a dbTabPage
44827>>>            Set Label to "¨æ©Ÿœ«˜"
44828>>>            Object dbGrpObligate is a dbGroupSub
44830>>>                Set Label to "“§¦®¨œà« ¡á ‘«¦ ®œå˜"
44831>>>                Set Size to 60 492
44832>>>                Set Location to 3 4
44833>>>                Set TextColor to clNavy
44834>>>                Object Baxio_Baxio_Hmnial is a dbFormSub
44836>>>                    Entry_Item Baxio.Baxio_hmnial
44837>>>                    Set Size to 13 66
44838>>>                    Set Location to 10 82
44839>>>                    Set Label_Col_Offset to 70
44840>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44841>>>                End_Object    // Baxio_Baxio_Hmnial
44842>>>
44842>>>                Object Baxio_Baxio_V4 is a dbFormSub
44844>>>                    Entry_Item Baxio.Baxio_v2
44845>>>                    Set Size to 13 66
44846>>>                    Set Location to 40 82
44847>>>                    Set Label_Col_Offset to 70
44848>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44849>>>
44849>>>                    //AB-StoreStart
44849>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                        
44849>>>                    //Set Points Item 0 to 0
44849>>>                    //Set Numeric_Mask Item 0 to 14  0 ' ,*'
44849>>>                    
44849>>>                    Procedure End_Construct_Object
44851>>>                        Integer iDecimals
44852>>>                        Forward Send End_Construct_Object
44854>>>                        Get fiDekadika_Nomismatos  SysCurXr.C_Code0  to    iDecimals
44855>>>                        Set Points Item 0 to iDecimals
44856>>>                        Set Numeric_Mask Item 0 to 14 iDecimals ' ,*'
44857>>>                    End_Procedure
44858>>>                    
44858>>>                    
44858>>>                    //AB-StoreEnd
44858>>>
44858>>>                End_Object    // Baxio_Baxio_V4
44859>>>
44859>>>                Object Rate0 is a dbFormSub
44861>>>                    Entry_Item Baxio.Baxio_rate0
44862>>>                    Set Size to 13 46
44863>>>                    Set Location to 11 440
44864>>>                    Set Label_Col_Offset to 35
44865>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44866>>>
44866>>>                    //AB-StoreStart
44866>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                        
44866>>>                    Set Points Item 0 to 0
44867>>>                    Set Visible_State to False
44868>>>                    Set Enabled_State to False
44869>>>                    
44869>>>                    
44869>>>                    
44869>>>                    //AB-StoreEnd
44869>>>
44869>>>                End_Object    // Rate0
44870>>>
44870>>>                Object Rate00 is a dbFormSub
44872>>>                    Entry_Item Baxio.Baxio_rate00
44873>>>                    Set Size to 13 46
44874>>>                    Set Location to 26 440
44875>>>                    Set Label_Col_Offset to 35
44876>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44877>>>
44877>>>                    //AB-StoreStart
44877>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                        
44877>>>                    Set Points Item 0 to 2
44878>>>                    Set Visible_State to False
44879>>>                    Set Enabled_State to False
44880>>>                    
44880>>>                    //AB-StoreEnd
44880>>>
44880>>>                End_Object    // Rate00
44881>>>
44881>>>                Object RateR is a dbFormSub
44883>>>                    Entry_Item Baxio.Baxio_rater
44884>>>                    Set Size to 13 46
44885>>>                    Set Location to 41 440
44886>>>                    Set Label_Col_Offset to 35
44887>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44888>>>
44888>>>                    //AB-StoreStart
44888>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                        
44888>>>                    Set Points Item 0 to 2
44889>>>                    Set Visible_State to False
44890>>>                    Set Enabled_State to False
44891>>>                    
44891>>>                    
44891>>>                    //AB-StoreEnd
44891>>>
44891>>>                End_Object    // RateR
44892>>>
44892>>>                Object TextBoxSub3 is a TextBoxSub
44894>>>                    Set Label to "†£/¤å˜ Šã¥žª"
44895>>>                    Set Location to 11 18
44896>>>                    Set Size to 10 57
44897>>>                    Set TypeFace to "MS Sans Serif"
44898>>>                End_Object    // TextBoxSub3
44899>>>
44899>>>                Object TextBoxSub4 is a TextBoxSub
44901>>>                    Set Label to "Œæ£ ©£˜"
44902>>>                    Set Location to 24 18
44903>>>                    Set Size to 10 32
44904>>>                    Set TypeFace to "MS Sans Serif"
44905>>>                End_Object    // TextBoxSub4
44906>>>
44906>>>                Object TextBoxSub5 is a TextBoxSub
44908>>>                    Set Label to "¦©æ"
44909>>>                    Set Location to 39 18
44910>>>                    Set Size to 10 32
44911>>>                    Set TypeFace to "MS Sans Serif"
44912>>>                End_Object    // TextBoxSub5
44913>>>
44913>>>                Object txtnom1 is a TextBoxSub
44915>>>                    Set Label to "ˆ©¦« £å˜1"
44916>>>                    Set Location to 13 405
44917>>>                    Set Size to 10 31
44918>>>                    Set TypeFace to "MS Sans Serif"
44919>>>
44919>>>                    //AB-StoreStart
44919>>>                    Set Visible_State to False
44920>>>                    
44920>>>                    //AB-StoreEnd
44920>>>
44920>>>                End_Object    // txtnom1
44921>>>
44921>>>                Object txtnom2 is a TextBoxSub
44923>>>                    Set Label to "ˆ©¦« £å˜2"
44924>>>                    Set Location to 28 405
44925>>>                    Set Size to 10 31
44926>>>                    Set TypeFace to "MS Sans Serif"
44927>>>
44927>>>                    //AB-StoreStart
44927>>>                    Set Visible_State to False
44928>>>                    
44928>>>                    //AB-StoreEnd
44928>>>
44928>>>                End_Object    // txtnom2
44929>>>
44929>>>                Object txtnom3 is a TextBoxSub
44931>>>                    Set Label to "ˆ©¦« £å˜3"
44932>>>                    Set Location to 43 405
44933>>>                    Set Size to 10 31
44934>>>                    Set TypeFace to "MS Sans Serif"
44935>>>
44935>>>                    //AB-StoreStart
44935>>>                    Set Visible_State to False
44936>>>                    
44936>>>                    //AB-StoreEnd
44936>>>
44936>>>                End_Object    // txtnom3
44937>>>
44937>>>                Object Baxio_Baxio_C_Code2 is a dbFormSub
44939>>>
44939>>>                    //AB-StoreTopStart
44939>>>                    //Procedure Set_The_Decimal_Points
44939>>>                    //    Integer iContID
44939>>>                    //    String  sCode sPartlRecr
44939>>>                    //    date    dHmnia
44939>>>                    
44939>>>                    //    Move (dbGrpObligate(TP_Additional(dbtbDlgAxio(Self)))) to iContID
44939>>>                    
44939>>>                    //    Get Field_Current_Value Of Baxio_DD Field Baxio.Baxio_Sc_Code2 to sCode
44939>>>                    //    Move (Trim(sCode))  to sCode
44939>>>                    
44939>>>                    //    Clear Nomisma
44939>>>                    //    Move sCode to Nomisma.Nomisma_Code
44939>>>                    //    Find eq Nomisma by Index.1
44939>>>                    //    Set Points          Of (Axia(iContID)) Item  0 to Nomisma.Dekadika
44939>>>                    //    Set Numeric_Mask    Of (Axia(iContID)) Item  0 to 12 Nomisma.Dekadika "*,"
44939>>>                    
44939>>>                    //    Get Label Of (TxtNom1(iContID)) Item 0 to sCode
44939>>>                    //    Move (Trim(sCode))  to sCode
44939>>>                    //    Clear Nomisma
44939>>>                    //    Move sCode to Nomisma.Nomisma_Code
44939>>>                    //    Find eq Nomisma by Index.1
44939>>>                    //    Set Points          Of (X0(iContID)) Item  0 to Nomisma.Dekadika
44939>>>                    //    Set Points          Of (P0(iContID)) Item  0 to Nomisma.Dekadika
44939>>>                    //    Set Numeric_Mask Of (X0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
44939>>>                    //    Set Numeric_Mask Of (P0(iContID))          Item  0  to 12 Nomisma.Dekadika "*,"
44939>>>                    
44939>>>                    //    Get Label Of (TxtNom2(iContID)) Item 0 to sCode
44939>>>                    //    Move (Trim(sCode))  to sCode
44939>>>                    //    Clear Nomisma
44939>>>                    //    Move sCode to Nomisma.Nomisma_Code
44939>>>                    //    Find eq Nomisma by Index.1
44939>>>                    //    Set Points          Of (X00(iContID)) Item  0 to Nomisma.Dekadika
44939>>>                    //    Set Numeric_Mask Of (X00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
44939>>>                    //    Set Points          Of (P00(iContID)) Item  0 to Nomisma.Dekadika
44939>>>                    //    Set Numeric_Mask Of (P00(iContID))         Item  0  to 12 Nomisma.Dekadika "*,"
44939>>>                    
44939>>>                    //    Get Label Of (TxtNom3(iContID)) Item 0 to sCode
44939>>>                    //    Move (Trim(sCode))  to sCode
44939>>>                    //    Clear Nomisma
44939>>>                    //    Move sCode to Nomisma.Nomisma_Code
44939>>>                    //    Find eq Nomisma by Index.1
44939>>>                    //    Set Points          Of (X1(iContID)) Item  0 to     Nomisma.Dekadika
44939>>>                    //    Set Numeric_Mask Of (X1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
44939>>>                    //    Set Points          Of (P1(iContID)) Item  0 to     Nomisma.Dekadika
44939>>>                    //    Set Numeric_Mask Of (P1(iContID))    Item  0 to 12  Nomisma.Dekadika "*,"
44939>>>                    //End_procedure
44939>>>                    
44939>>>                    
44939>>>                    //AB-StoreTopEnd
44939>>>
44939>>>                    Entry_Item Baxio.Baxio_c_code2
44940>>>                    Set Size to 13 66
44941>>>                    Set Location to 25 82
44942>>>                    Set Label_Col_Offset to 2
44943>>>                    Set Label_Justification_Mode to jMode_Right
44944>>>                    Set Prompt_Button_Mode to pb_PromptOff
44945>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44946>>>
44946>>>                    //AB-StoreStart
44946>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                        
44946>>>                    //Procedure OnChange
44946>>>                    //    Send Set_The_Decimal_Points
44946>>>                    //End_Procedure
44946>>>                    
44946>>>                    
44946>>>                    //AB-StoreEnd
44946>>>
44946>>>                End_Object    // Baxio_Baxio_C_Code2
44947>>>
44947>>>
44947>>>                //AB-StoreStart
44947>>>                                                
44947>>>                //AB-StoreEnd
44947>>>
44947>>>            End_Object    // dbGrpObligate
44948>>>
44948>>>            Object dbGrpOptional is a dbGroupSub
44950>>>                Set Label to "¨¦˜ ¨œ« ¡á ‘«¦ ®œå˜"
44951>>>                Set Size to 106 492
44952>>>                Set Location to 65 4
44953>>>                Set TextColor to clNavy
44954>>>                Object Baxio_Baxio_Ekdoths is a dbFormSub
44956>>>                    Entry_Item Baxio.Baxio_ekdoths
44957>>>                    Set Size to 13 126
44958>>>                    Set Location to 10 81
44959>>>                    Set Label_Col_Offset to 70
44960>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44961>>>                End_Object    // Baxio_Baxio_Ekdoths
44962>>>
44962>>>                Object Baxio_Baxio_Ekdothse is a dbFormSub
44964>>>                    Entry_Item Baxio.Baxio_ekdothse
44965>>>                    Set Size to 13 208
44966>>>                    Set Location to 10 264
44967>>>                    Set Label_Col_Offset to 35
44968>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44969>>>                End_Object    // Baxio_Baxio_Ekdothse
44970>>>
44970>>>                Object Baxio_Baxio_Sediatagh is a dbFormSub
44972>>>                    Entry_Item Baxio.Baxio_sediatagh
44973>>>                    Set Size to 13 126
44974>>>                    Set Location to 26 81
44975>>>                    Set Label_Col_Offset to 70
44976>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44977>>>                End_Object    // Baxio_Baxio_Sediatagh
44978>>>
44978>>>                Object Baxio_Baxio_Sdiataghe is a dbFormSub
44980>>>                    Entry_Item Baxio.Baxio_sdiataghe
44981>>>                    Set Size to 13 208
44982>>>                    Set Location to 26 264
44983>>>                    Set Label_Col_Offset to 35
44984>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
44985>>>                End_Object    // Baxio_Baxio_Sdiataghe
44986>>>
44986>>>                Object Baxio_Baxio_Banka is a dbComboFormSub
44988>>>                    Entry_Item Baxio.Baxio_banka
44989>>>                    Set Size to 13 126
44990>>>                    Set Location to 40 81
44991>>>                    Set Label_Col_Offset to 70
44992>>>                End_Object    // Baxio_Baxio_Banka
44993>>>
44993>>>                Object Baxio_Baxio_No is a dbFormSub
44995>>>                    Entry_Item Baxio.Baxio_no
44996>>>                    Set Size to 13 126
44997>>>                    Set Location to 55 81
44998>>>                    Set Label_Col_Offset to 70
44999>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45000>>>                End_Object    // Baxio_Baxio_No
45001>>>
45001>>>                Object Baxio_Baxio_From is a dbComboFormSub
45003>>>                    Entry_Item Baxio.Baxio_from
45004>>>                    Set Size to 13 54
45005>>>                    Set Location to 70 81
45006>>>                    Set Label_Col_Offset to 2
45007>>>
45007>>>                    //AB-StoreStart
45007>>>                                                                                                                                                                                                                                                                
45007>>>                    Procedure Combo_Fill_List
45009>>>                        Send Combo_Add_Item  "ˆ›å¦¬" "0"
45010>>>                        Send Combo_Add_Item  "’¨å«¦¬" "1"
45011>>>                    End_Procedure
45012>>>                    
45012>>>                    
45012>>>                    
45012>>>                    
45012>>>                    
45012>>>                    
45012>>>                    //AB-StoreEnd
45012>>>
45012>>>                End_Object    // Baxio_Baxio_From
45013>>>
45013>>>                Object Baxio_Baxio_Topos is a dbComboFormSub
45015>>>                    Entry_Item Baxio.Baxio_topos
45016>>>                    Set Size to 13 54
45017>>>                    Set Location to 84 81
45018>>>                    Set Label_Col_Offset to 2
45019>>>
45019>>>                    //AB-StoreStart
45019>>>                    Procedure Combo_Fill_List
45021>>>                        Send Combo_Add_Item  "€«« ¡ãª" "0"
45022>>>                        Send Combo_Add_Item  "„§˜¨®å˜ª" "1"
45023>>>                    End_Procedure
45024>>>                    
45024>>>                    
45024>>>                    
45024>>>                    
45024>>>                    
45024>>>                    
45024>>>                    //AB-StoreEnd
45024>>>
45024>>>                End_Object    // Baxio_Baxio_Topos
45025>>>
45025>>>                Object Baxio_Baxio_Opistho is a dbEditSub
45027>>>                    Entry_Item Baxio.Baxio_opistho
45028>>>                    Set Size to 48 211
45029>>>                    Set Location to 50 263
45030>>>                End_Object    // Baxio_Baxio_Opistho
45031>>>
45031>>>                Object TextBoxSub6 is a TextBoxSub
45033>>>                    Set Label to "€¨® ¡æª „¡›æ«žª:"
45034>>>                    Set Location to 11 10
45035>>>                    Set Size to 10 63
45036>>>                    Set TypeFace to "MS Sans Serif"
45037>>>                End_Object    // TextBoxSub6
45038>>>
45038>>>                Object TextBoxSub7 is a TextBoxSub
45040>>>                    Set Label to "‘œ ƒ ˜«˜šã:"
45041>>>                    Set Location to 25 10
45042>>>                    Set Size to 10 56
45043>>>                    Set TypeFace to "MS Sans Serif"
45044>>>                End_Object    // TextBoxSub7
45045>>>
45045>>>                Object TextBoxSub8 is a TextBoxSub
45047>>>                    Set Label to "’¨á§œ˜"
45048>>>                    Set Location to 40 10
45049>>>                    Set Size to 10 35
45050>>>                    Set TypeFace to "MS Sans Serif"
45051>>>                End_Object    // TextBoxSub8
45052>>>
45052>>>                Object TextBoxSub9 is a TextBoxSub
45054>>>                    Set Label to "€¨ Ÿ£æª"
45055>>>                    Set Location to 55 10
45056>>>                    Set Size to 10 47
45057>>>                    Set TypeFace to "MS Sans Serif"
45058>>>                End_Object    // TextBoxSub9
45059>>>
45059>>>                Object TextBoxSub10 is a TextBoxSub
45061>>>                    Set Label to "„§à¤¬£å˜"
45062>>>                    Set Location to 12 224
45063>>>                    Set Size to 10 36
45064>>>                    Set TypeFace to "MS Sans Serif"
45065>>>                End_Object    // TextBoxSub10
45066>>>
45066>>>                Object TextBoxSub11 is a TextBoxSub
45068>>>                    Set Label to "„§à¤¬£å˜"
45069>>>                    Set Location to 28 224
45070>>>                    Set Size to 10 36
45071>>>                    Set TypeFace to "MS Sans Serif"
45072>>>                End_Object    // TextBoxSub11
45073>>>
45073>>>                Object TextBoxSub12 is a TextBoxSub
45075>>>                    Set Label to "Š¦ §¦å Ž§ ©Ÿ¦š¨á­¦ "
45076>>>                    Set Location to 41 265
45077>>>                    Set Size to 10 79
45078>>>                    Set TypeFace to "MS Sans Serif"
45079>>>                End_Object    // TextBoxSub12
45080>>>
45080>>>                Object Textbox3 is a Textbox
45082>>>                    Set Label to "ˆ›å¦¬/’¨å«¦¬"
45083>>>                    Set Location to 71 10
45084>>>                    Set Size to 10 46
45085>>>                    Set TypeFace to "MS Sans Serif"
45086>>>                End_Object    // Textbox3
45087>>>
45087>>>                Object Textbox4 is a Textbox
45089>>>                    Set Label to "€«« ¡ãª/„§˜¨®å˜ª"
45090>>>                    Set Location to 86 10
45091>>>                    Set Size to 10 63
45092>>>                    Set TypeFace to "MS Sans Serif"
45093>>>                End_Object    // Textbox4
45094>>>
45094>>>            End_Object    // dbGrpOptional
45095>>>
45095>>>
45095>>>            //AB-StoreStart
45095>>>            set label to "‘«â¢œ®¦ª/‘é£˜ €¥ ¦š¨á­¦¬"
45096>>>            
45096>>>            //AB-StoreEnd
45096>>>
45096>>>        End_Object    // TP_Additional
45097>>>
45097>>>        Object TP_Status is a dbTabPage
45099>>>            Set Label to "‰˜«á©«˜©ž"
45100>>>            Object dbGrpEispraktea is a dbGroupSub
45102>>>                Set Label to "„ ©§¨˜¡«â˜"
45103>>>                Set Size to 44 493
45104>>>                Set Location to 4 3
45105>>>                Set TextColor to clNavy
45106>>>                Object Baxio_Baxio_Fbarticl is a dbFormSub
45108>>>
45108>>>                    //AB-StoreTopStart
45108>>>                    Procedure Find_Barticls
45110>>>                        Integer liBarticlRec0 liWhichBarticl
45111>>>                        Date ldHmnia
45111>>>                        String liNo liBtypkin
45111>>>                    
45111>>>                        Move Barticl.Barticl_Rec0 to liBarticlRec0
45112>>>                    
45112>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_In to liWhichBarticl
45113>>>                        If (liWhichBarticl <> 0) Begin
45115>>>                            Clear Barticl
45116>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
45117>>>                            Find eq Barticl by Index.2
45118>>>>
45118>>>                            [Found] Begin
45120>>>>
45120>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
45121>>>                                Move Barticl.Barticl_No      to liNo
45122>>>                                Move Barticl.Btypkin_Code    to liBtypkin
45123>>>                            End
45123>>>>
45123>>>                        End
45123>>>>
45123>>>                        Set Value of dbfrmHmnia   Item 0 to ldHmnia
45124>>>                        Set Value of dbfrmNo      Item 0 to liNo
45125>>>                        Set Value of dbfrmGtypkin Item 0 to liBtypkin
45126>>>                    
45126>>>                        Move "" to ldHmnia
45127>>>                        Move "" to liNo
45128>>>                        Move "" to liBtypkin
45129>>>                    
45129>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Fpar_Out to liWhichBarticl
45130>>>                        If (liWhichBarticl <> 0) Begin
45132>>>                            Clear Barticl
45133>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
45134>>>                            Find eq Barticl by Index.2
45135>>>>
45135>>>                            [Found] Begin
45137>>>>
45137>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
45138>>>                                Move Barticl.Barticl_No      to liNo
45139>>>                                Move Barticl.Btypkin_Code    to liBtypkin
45140>>>                            End
45140>>>>
45140>>>                        End
45140>>>>
45140>>>                        Set Value of (dbfrmHmnia(dbGrpPlhrotea(Self)))   Item 0 to ldHmnia
45141>>>                        Set Value of (dbfrmNo(dbGrpPlhrotea(Self)))      Item 0 to liNo
45142>>>                        Set Value of (dbfrmGtypkin(dbGrpPlhrotea(Self))) Item 0 to liBtypkin
45143>>>                    
45143>>>                        Move "" to ldHmnia
45144>>>                        Move "" to liNo
45145>>>                        Move "" to liBtypkin
45146>>>                    
45146>>>                        Get Field_Current_Value of Baxio_DD Field Baxio.Baxio_Lpar to liWhichBarticl
45147>>>                        If (liWhichBarticl <> 0) Begin
45149>>>                            Clear Barticl
45150>>>                            Move liWhichBarticl to Barticl.Barticl_Rec0
45151>>>                            Find eq Barticl by Index.2
45152>>>>
45152>>>                            [Found] Begin
45154>>>>
45154>>>                                Move Barticl.Barticl_Hmnia   to ldHmnia
45155>>>                                Move Barticl.Barticl_No      to liNo
45156>>>                                Move Barticl.Btypkin_Code    to liBtypkin
45157>>>                            End
45157>>>>
45157>>>                        End
45157>>>>
45157>>>                        Set Value of (dbfrmHmnia(dbGrpCurrentStat(Self)))   Item 0 to ldHmnia
45158>>>                        Set Value of (dbfrmNo(dbGrpCurrentStat(Self)))      Item 0 to liNo
45159>>>                        Set Value of (dbfrmGtypkin(dbGrpCurrentStat(Self))) Item 0 to liBtypkin
45160>>>                    
45160>>>                        Clear Barticl
45161>>>                        Move liBarticlRec0 to Barticl.Barticl_Rec0
45162>>>                        Find eq Barticl by Index.2
45163>>>>
45163>>>                    End_Procedure
45164>>>                    
45164>>>                    //AB-StoreTopEnd
45164>>>
45164>>>                    Entry_Item Baxio.Baxio_fpar_in
45165>>>                    Set Size to 13 90
45166>>>                    Set Location to 10 109
45167>>>                    Set Label_Col_Offset to 90
45168>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45169>>>
45169>>>                    //AB-StoreStart
45169>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                        
45169>>>                    Procedure Refresh Integer iMode
45171>>>                        Forward Send Refresh iMode
45173>>>                        Send Find_Barticls
45174>>>                    End_Procedure // Refresh
45175>>>                    
45175>>>                    
45175>>>                    
45175>>>                    
45175>>>                    
45175>>>                    //AB-StoreEnd
45175>>>
45175>>>                End_Object    // Baxio_Baxio_Fbarticl
45176>>>
45176>>>                Object Baxio_Baxio_Code_In is a dbFormSub
45178>>>                    Entry_Item Baxio.Baxio_code_in
45179>>>                    Set Size to 13 126
45180>>>                    Set Location to 24 109
45181>>>                    Set Label_Col_Offset to 90
45182>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45183>>>                End_Object    // Baxio_Baxio_Code_In
45184>>>
45184>>>                Object Baxio_Baxio_Epon_In is a dbFormSub
45186>>>                    Entry_Item Baxio.Baxio_epon_in
45187>>>                    Set Size to 13 192
45188>>>                    Set Location to 24 283
45189>>>                    Set Color to clBtnFace
45190>>>                    Set Label_Col_Offset to 40
45191>>>                    Set Enabled_State to FALSE
45192>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45193>>>                    Set Item_Shadow_State Item 0 to TRUE
45194>>>                    Set Shadow_State Item 0 to TRUE
45195>>>                End_Object    // Baxio_Baxio_Epon_In
45196>>>
45196>>>                Object dbFrmHmnia is a dbFormSub
45198>>>                    Set Size to 13 65
45199>>>                    Set Location to 10 231
45200>>>                    Set Color to clBtnFace
45201>>>                    Set Label_Col_Offset to 2
45202>>>                    Set Label_Justification_Mode to jMode_Right
45203>>>                    Set Enabled_State to FALSE
45204>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45205>>>                    Set Item_Shadow_State Item 0 to TRUE
45206>>>                    Set Shadow_State Item 0 to TRUE
45207>>>                End_Object    // dbFrmHmnia
45208>>>
45208>>>                Object dbFrmNo is a dbFormSub
45210>>>                    Set Size to 13 65
45211>>>                    Set Location to 10 318
45212>>>                    Set Color to clBtnFace
45213>>>                    Set Label_Col_Offset to 2
45214>>>                    Set Label_Justification_Mode to jMode_Right
45215>>>                    Set Enabled_State to FALSE
45216>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45217>>>                    Set Item_Shadow_State Item 0 to TRUE
45218>>>                    Set Shadow_State Item 0 to TRUE
45219>>>                End_Object    // dbFrmNo
45220>>>
45220>>>                Object dbFrmGtypkin is a dbFormSub
45222>>>                    Set Label to "‰å¤ž©ž"
45223>>>                    Set Size to 13 57
45224>>>                    Set Location to 10 418
45225>>>                    Set Color to clBtnFace
45226>>>                    Set Label_Col_Offset to 2
45227>>>                    Set Label_Justification_Mode to jMode_Right
45228>>>                    Set Enabled_State to FALSE
45229>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45230>>>                    Set Item_Shadow_State Item 0 to TRUE
45231>>>                    Set Shadow_State Item 0 to TRUE
45232>>>                End_Object    // dbFrmGtypkin
45233>>>
45233>>>                Object TextBoxSub18 is a TextBoxSub
45235>>>                    Set Label to "˜¨/¡æ ˜¨˜¢˜™ãª:"
45236>>>                    Set Location to 12 18
45237>>>                    Set Size to 10 69
45238>>>                    Set TypeFace to "MS Sans Serif"
45239>>>                End_Object    // TextBoxSub18
45240>>>
45240>>>                Object TextBoxSub19 is a TextBoxSub
45242>>>                    Set Label to "˜¨˜¢ã­Ÿž¡œ ˜§æ:"
45243>>>                    Set Location to 25 18
45244>>>                    Set Size to 10 67
45245>>>                    Set TypeFace to "MS Sans Serif"
45246>>>                End_Object    // TextBoxSub19
45247>>>
45247>>>                Object TextBoxSub24 is a TextBoxSub
45249>>>                    Set Label to "†£-¤å˜"
45250>>>                    Set Location to 12 201
45251>>>                    Set Size to 10 26
45252>>>                    Set TypeFace to "MS Sans Serif"
45253>>>                End_Object    // TextBoxSub24
45254>>>
45254>>>                Object TextBoxSub27 is a TextBoxSub
45256>>>                    Set Label to "„§à¤¬£å˜"
45257>>>                    Set Location to 26 239
45258>>>                    Set Size to 10 39
45259>>>                    Set TypeFace to "MS Sans Serif"
45260>>>                End_Object    // TextBoxSub27
45261>>>
45261>>>                Object TextBoxSub30 is a TextBoxSub
45263>>>                    Set Label to "Œ¦:"
45264>>>                    Set Location to 11 298
45265>>>                    Set Size to 10 15
45266>>>                    Set TypeFace to "MS Sans Serif"
45267>>>                End_Object    // TextBoxSub30
45268>>>
45268>>>            End_Object    // dbGrpEispraktea
45269>>>
45269>>>            Object dbGrpPlhrotea is a dbGroupSub
45271>>>                Set Label to "„ ©§¨˜¡«â˜/¢ž¨à«â˜"
45272>>>                Set Size to 44 493
45273>>>                Set Location to 51 3
45274>>>                Set TextColor to clNavy
45275>>>                Object Baxio_Baxio_Lbarticl is a dbFormSub
45277>>>                    Entry_Item Baxio.Baxio_fpar_out
45278>>>                    Set Size to 13 90
45279>>>                    Set Location to 10 109
45280>>>                    Set Label_Col_Offset to 90
45281>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45282>>>                End_Object    // Baxio_Baxio_Lbarticl
45283>>>
45283>>>                Object Baxio_Baxio_Code_Out is a dbFormSub
45285>>>                    Entry_Item Baxio.Baxio_code_out
45286>>>                    Set Size to 13 126
45287>>>                    Set Location to 25 109
45288>>>                    Set Label_Col_Offset to 90
45289>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45290>>>                End_Object    // Baxio_Baxio_Code_Out
45291>>>
45291>>>                Object Baxio_Baxio_Epon_Out is a dbFormSub
45293>>>                    Entry_Item Baxio.Baxio_epon_out
45294>>>                    Set Size to 13 192
45295>>>                    Set Location to 25 283
45296>>>                    Set Color to clBtnFace
45297>>>                    Set Label_Col_Offset to 40
45298>>>                    Set Enabled_State to FALSE
45299>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45300>>>                    Set Item_Shadow_State Item 0 to TRUE
45301>>>                    Set Shadow_State Item 0 to TRUE
45302>>>                End_Object    // Baxio_Baxio_Epon_Out
45303>>>
45303>>>                Object dbFrmHmnia is a dbFormSub
45305>>>                    Set Size to 13 65
45306>>>                    Set Location to 10 231
45307>>>                    Set Color to clBtnFace
45308>>>                    Set Label_Col_Offset to 2
45309>>>                    Set Label_Justification_Mode to jMode_Right
45310>>>                    Set Enabled_State to FALSE
45311>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45312>>>                    Set Item_Shadow_State Item 0 to TRUE
45313>>>                    Set Shadow_State Item 0 to TRUE
45314>>>                End_Object    // dbFrmHmnia
45315>>>
45315>>>                Object dbFrmNo is a dbFormSub
45317>>>                    Set Size to 13 65
45318>>>                    Set Location to 10 318
45319>>>                    Set Color to clBtnFace
45320>>>                    Set Label_Col_Offset to 2
45321>>>                    Set Label_Justification_Mode to jMode_Right
45322>>>                    Set Enabled_State to FALSE
45323>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45324>>>                    Set Item_Shadow_State Item 0 to TRUE
45325>>>                    Set Shadow_State Item 0 to TRUE
45326>>>                End_Object    // dbFrmNo
45327>>>
45327>>>                Object dbFrmGtypkin is a dbFormSub
45329>>>                    Set Label to "‰å¤ž©ž"
45330>>>                    Set Size to 13 57
45331>>>                    Set Location to 10 418
45332>>>                    Set Color to clBtnFace
45333>>>                    Set Label_Col_Offset to 2
45334>>>                    Set Label_Justification_Mode to jMode_Right
45335>>>                    Set Enabled_State to FALSE
45336>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45337>>>                    Set Item_Shadow_State Item 0 to TRUE
45338>>>                    Set Shadow_State Item 0 to TRUE
45339>>>                End_Object    // dbFrmGtypkin
45340>>>
45340>>>                Object TextBoxSub20 is a TextBoxSub
45342>>>                    Set Label to "˜¨/¡æ ˜¨á›¦©žª:"
45343>>>                    Set Location to 10 19
45344>>>                    Set Size to 10 71
45345>>>                    Set TypeFace to "MS Sans Serif"
45346>>>                End_Object    // TextBoxSub20
45347>>>
45347>>>                Object TextBoxSub21 is a TextBoxSub
45349>>>                    Set Label to "¨é«¦ª ˜¨˜¢ã§«žª:"
45350>>>                    Set Location to 24 19
45351>>>                    Set Size to 10 78
45352>>>                    Set TypeFace to "MS Sans Serif"
45353>>>                End_Object    // TextBoxSub21
45354>>>
45354>>>                Object TextBoxSub25 is a TextBoxSub
45356>>>                    Set Label to "†£-¤å˜"
45357>>>                    Set Location to 10 201
45358>>>                    Set Size to 10 26
45359>>>                    Set TypeFace to "MS Sans Serif"
45360>>>                End_Object    // TextBoxSub25
45361>>>
45361>>>                Object TextBoxSub28 is a TextBoxSub
45363>>>                    Set Label to "„§à¤¬£å˜"
45364>>>                    Set Location to 27 237
45365>>>                    Set Size to 10 41
45366>>>                    Set TypeFace to "MS Sans Serif"
45367>>>                End_Object    // TextBoxSub28
45368>>>
45368>>>                Object TextBoxSub31 is a TextBoxSub
45370>>>                    Set Label to "Œ¦:"
45371>>>                    Set Location to 12 298
45372>>>                    Set Size to 9 15
45373>>>                    Set TypeFace to "MS Sans Serif"
45374>>>                End_Object    // TextBoxSub31
45375>>>
45375>>>            End_Object    // dbGrpPlhrotea
45376>>>
45376>>>            Object dbGrpCurrentStat is a dbGroupSub
45378>>>                Set Label to "’¨â®¦¬©˜ ‰˜«á©«˜©ž"
45379>>>                Set Size to 44 493
45380>>>                Set Location to 98 3
45381>>>                Set TextColor to clNavy
45382>>>                Object Baxio_Baxio_Lcode is a dbFormSub
45384>>>                    Entry_Item Baxio.Baxio_lcode
45385>>>                    Set Size to 13 126
45386>>>                    Set Location to 24 109
45387>>>                    Set Label_Col_Offset to 90
45388>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45389>>>                End_Object    // Baxio_Baxio_Lcode
45390>>>
45390>>>                Object Baxio_Baxio_Lepon is a dbFormSub
45392>>>                    Entry_Item Baxio.Baxio_lepon
45393>>>                    Set Size to 13 192
45394>>>                    Set Location to 24 283
45395>>>                    Set Color to clBtnFace
45396>>>                    Set Label_Col_Offset to 40
45397>>>                    Set Enabled_State to FALSE
45398>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45399>>>                    Set Item_Shadow_State Item 0 to TRUE
45400>>>                    Set Shadow_State Item 0 to TRUE
45401>>>                End_Object    // Baxio_Baxio_Lepon
45402>>>
45402>>>                Object Baxio_Baxio_Lpar is a dbFormSub
45404>>>                    Entry_Item Baxio.Baxio_lpar
45405>>>                    Set Size to 13 90
45406>>>                    Set Location to 9 109
45407>>>                    Set Label_Col_Offset to 90
45408>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45409>>>                End_Object    // Baxio_Baxio_Lpar
45410>>>
45410>>>                Object dbFrmHmnia is a dbFormSub
45412>>>                    Set Size to 13 65
45413>>>                    Set Location to 10 231
45414>>>                    Set Color to clBtnFace
45415>>>                    Set Label_Col_Offset to 2
45416>>>                    Set Label_Justification_Mode to jMode_Right
45417>>>                    Set Enabled_State to FALSE
45418>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45419>>>                    Set Item_Shadow_State Item 0 to TRUE
45420>>>                    Set Shadow_State Item 0 to TRUE
45421>>>                End_Object    // dbFrmHmnia
45422>>>
45422>>>                Object dbFrmNo is a dbFormSub
45424>>>                    Set Size to 13 65
45425>>>                    Set Location to 10 318
45426>>>                    Set Color to clBtnFace
45427>>>                    Set Label_Col_Offset to 2
45428>>>                    Set Label_Justification_Mode to jMode_Right
45429>>>                    Set Enabled_State to FALSE
45430>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45431>>>                    Set Item_Shadow_State Item 0 to TRUE
45432>>>                    Set Shadow_State Item 0 to TRUE
45433>>>                End_Object    // dbFrmNo
45434>>>
45434>>>                Object dbFrmGtypkin is a dbFormSub
45436>>>                    Set Label to "‰å¤ž©ž"
45437>>>                    Set Size to 13 57
45438>>>                    Set Location to 10 418
45439>>>                    Set Color to clBtnFace
45440>>>                    Set Label_Col_Offset to 2
45441>>>                    Set Label_Justification_Mode to jMode_Right
45442>>>                    Set Enabled_State to FALSE
45443>>>                    Set Form_TypeFace Item 0 to "MS Sans Serif"
45444>>>                    Set Item_Shadow_State Item 0 to TRUE
45445>>>                    Set Shadow_State Item 0 to TRUE
45446>>>                End_Object    // dbFrmGtypkin
45447>>>
45447>>>                Object TextBoxSub22 is a TextBoxSub
45449>>>                    Set Label to "’œ¢œ¬«˜å¦ ˜¨/¡æ:"
45450>>>                    Set Location to 11 13
45451>>>                    Set Size to 10 68
45452>>>                    Set TypeFace to "MS Sans Serif"
45453>>>                End_Object    // TextBoxSub22
45454>>>
45454>>>                Object TextBoxSub23 is a TextBoxSub
45456>>>                    Set Label to "’œ¢œ¬«˜å¦ª ˜¨˜¢ã§«žª:"
45457>>>                    Set Location to 24 13
45458>>>                    Set Size to 10 90
45459>>>                    Set TypeFace to "MS Sans Serif"
45460>>>                End_Object    // TextBoxSub23
45461>>>
45461>>>                Object TextBoxSub26 is a TextBoxSub
45463>>>                    Set Label to "†£-¤å˜"
45464>>>                    Set Location to 11 200
45465>>>                    Set Size to 10 27
45466>>>                    Set TypeFace to "MS Sans Serif"
45467>>>                End_Object    // TextBoxSub26
45468>>>
45468>>>                Object TextBoxSub29 is a TextBoxSub
45470>>>                    Set Label to "„§à¤¬£å˜"
45471>>>                    Set Location to 26 239
45472>>>                    Set Size to 10 40
45473>>>                    Set TypeFace to "MS Sans Serif"
45474>>>                End_Object    // TextBoxSub29
45475>>>
45475>>>                Object TextBoxSub32 is a TextBoxSub
45477>>>                    Set Label to "Œ¦:"
45478>>>                    Set Location to 11 297
45479>>>                    Set Size to 10 15
45480>>>                    Set TypeFace to "MS Sans Serif"
45481>>>                End_Object    // TextBoxSub32
45482>>>
45482>>>            End_Object    // dbGrpCurrentStat
45483>>>
45483>>>
45483>>>            //AB-StoreStart
45483>>>            set label to "Š¦ §á ‘«¦ ®œå˜"
45484>>>            
45484>>>            //AB-StoreEnd
45484>>>
45484>>>        End_Object    // TP_Status
45485>>>
45485>>>        Object TP_Bmove is a dbTabPage
45487>>>            Set Label to "‰å¤ž©ž"
45488>>>            Object grdBmove is a dbGridSub
45490>>>                Set Main_File to Bmove.File_Number
45491>>>                Set Server to (Bmove_DD(self))
45492>>>                Set Ordering to 4
45493>>>                Set Size to 159 489
45494>>>                Set Location to 7 5
45495>>>                Set Wrap_State to TRUE
45496>>>                Set Read_Only_State to TRUE
45497>>>
45497>>>                Begin_Row
45500>>>                    Entry_Item Btypkin.Btypkin_code
45501>>>                    Entry_Item Btypkin.Btypkin_descr
45502>>>                    Entry_Item Barticl.Barticl_hmnia
45503>>>                    Entry_Item Barticl.Barticl_no
45504>>>                    Entry_Item Barticl.Barticl_code1
45505>>>                    Entry_Item Barticl.Barticl_code2
45506>>>                End_Row
45511>>>
45511>>>                Set Form_Width    item 0 to 38
45512>>>                Set Header_Label  item 0 to "‰å¤ž©ž"
45513>>>                
45513>>>                Set Form_Width    item 1 to 197
45514>>>                Set Header_Label  item 1 to "œ¨ š¨˜­ã"
45515>>>                
45515>>>                Set Form_Width    item 2 to 45
45516>>>                Set Header_Label  item 2 to "†£-¤å˜"
45517>>>                
45517>>>                Set Form_Width    item 3 to 45
45518>>>                Set Header_Label  item 3 to "€¨ Ÿ£æª"
45519>>>                
45519>>>                Set Form_Width    item 4 to 82
45520>>>                Set Header_Label  item 4 to "‘¬¤˜¢¢˜©©æ£œ¤¦ª"
45521>>>                
45521>>>                Set Form_Width    item 5 to 76
45522>>>                Set Header_Label  item 5 to "˜¨˜¢ã§«žª"
45523>>>                
45523>>>
45523>>>                //AB-StoreStart
45523>>>                                                
45523>>>                Procedure Set Col_Entry_State Integer iItem Integer iState
45525>>>                    Integer liPrototype
45526>>>                    Get Prototype_Object to liPrototype
45527>>>                    Set Entry_State of liPrototype Item iItem to iState
45528>>>                End_Procedure // Col_Entry_State
45529>>>                
45529>>>                Set Col_Entry_State to 0 False
45530>>>                Set Col_Entry_State to 1 False
45531>>>                Set Col_Entry_State to 2 False
45532>>>                Set Col_Entry_State to 3 False
45533>>>                Set Col_Entry_State to 4 False
45534>>>                Set Col_Entry_State to 5 False
45535>>>                
45535>>>                Procedure Mouse_Up Integer aiWindow Integer iChar_Pos
45537>>>                End_Procedure // Mouse_Up
45538>>>                
45538>>>                
45538>>>                Procedure Request_Clear_All
45540>>>                End_Procedure // Request_Clear_All
45541>>>                
45541>>>                
45541>>>                //AB-StoreEnd
45541>>>
45541>>>            End_Object    // grdBmove
45542>>>
45542>>>
45542>>>            //AB-StoreStart
45542>>>            set label to "‰ ¤ã©œ ª    "
45543>>>            //AB-StoreEnd
45543>>>
45543>>>        End_Object    // TP_Bmove
45544>>>
45544>>>    End_Object    // dbTbDlgAxio
45545>>>
45545>>>    Object dbGrpYear is a dbGroupSub
45547>>>        Set Size to 26 505
45548>>>        Set Location to 2 3
45549>>>        Object Company_Company_Name is a dbFormSub
45551>>>            Entry_Item Syscurxr.Company_name
45552>>>            Set Server to (Syscurxr_DD(self))
45553>>>            Set Size to 13 139
45554>>>            Set Location to 9 47
45555>>>            Set Color to clBtnFace
45556>>>            Set Label_Col_Offset to 2
45557>>>            Set Label_Justification_Mode to jMode_Right
45558>>>            Set Enabled_State to FALSE
45559>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45560>>>            Set Item_Shadow_State Item 0 to TRUE
45561>>>            Set Shadow_State Item 0 to TRUE
45562>>>        End_Object    // Company_Company_Name
45563>>>
45563>>>        Object Branch_Branch_Name is a dbFormSub
45565>>>            Entry_Item Syscurxr.Branch_name
45566>>>            Set Server to (Syscurxr_DD(self))
45567>>>            Set Size to 13 141
45568>>>            Set Location to 9 241
45569>>>            Set Color to clBtnFace
45570>>>            Set Label_Col_Offset to 2
45571>>>            Set Label_Justification_Mode to jMode_Right
45572>>>            Set Enabled_State to FALSE
45573>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45574>>>            Set Item_Shadow_State Item 0 to TRUE
45575>>>            Set Shadow_State Item 0 to TRUE
45576>>>        End_Object    // Branch_Branch_Name
45577>>>
45577>>>        Object Year_Year_Year is a dbFormSub
45579>>>            Entry_Item Syscurxr.Year_year
45580>>>            Set Server to (Syscurxr_DD(self))
45581>>>            Set Size to 13 61
45582>>>            Set Location to 9 440
45583>>>            Set Color to clBtnFace
45584>>>            Set Label_Col_Offset to 2
45585>>>            Set Label_Justification_Mode to jMode_Right
45586>>>            Set Enabled_State to FALSE
45587>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
45588>>>            Set Item_Shadow_State Item 0 to TRUE
45589>>>            Set Shadow_State Item 0 to TRUE
45590>>>
45590>>>            //AB-StoreStart
45590>>>                                                                                                                                                                                                                                                                                        
45590>>>                                                                                                                                                                                                                                                                                        
45590>>>                                                                                                                                                                                                                                                                                        
45590>>>            //AB-StoreEnd
45590>>>
45590>>>        End_Object    // Year_Year_Year
45591>>>
45591>>>        Object otxtCompany is a TextBoxSub
45593>>>            Set Label to "„«˜ ¨œå˜"
45594>>>            Set Auto_Size_State to FALSE
45595>>>            Set TextColor to clNavy
45596>>>            Set FontSize to 4 0
45597>>>            Set Location to 10 8
45598>>>            Set Size to 10 31
45599>>>            Set FontWeight to 800
45600>>>            Set Justification_Mode to jMode_Right
45601>>>            Set TypeFace to "MS Sans Serif"
45602>>>            Set Enabled_State to TRUE
45603>>>        End_Object    // otxtCompany
45604>>>
45604>>>        Object otxtBranch is a TextBoxSub
45606>>>            Set Label to "“§¦¡/£˜ :"
45607>>>            Set Auto_Size_State to FALSE
45608>>>            Set TextColor to clNavy
45609>>>            Set FontSize to 4 0
45610>>>            Set Location to 10 200
45611>>>            Set Size to 10 31
45612>>>            Set FontWeight to 800
45613>>>            Set Justification_Mode to jMode_Right
45614>>>            Set TypeFace to "MS Sans Serif"
45615>>>            Set Enabled_State to TRUE
45616>>>        End_Object    // otxtBranch
45617>>>
45617>>>        Object otxtYear is a TextBoxSub
45619>>>            Set Label to "•¨ã©ž :          "
45620>>>            Set Auto_Size_State to FALSE
45621>>>            Set TextColor to clNavy
45622>>>            Set FontSize to 4 0
45623>>>            Set Location to 10 408
45624>>>            Set Size to 10 24
45625>>>            Set FontWeight to 800
45626>>>            Set Justification_Mode to jMode_Right
45627>>>            Set TypeFace to "MS Sans Serif"
45628>>>            Set Enabled_State to TRUE
45629>>>        End_Object    // otxtYear
45630>>>
45630>>>    End_Object    // dbGrpYear
45631>>>
45631>>>    Object TextBoxSub1 is a TextBoxSub
45633>>>        Set Label to "„å›¦ª"
45634>>>        Set Location to 36 5
45635>>>        Set Size to 10 35
45636>>>        Set TypeFace to "MS Sans Serif"
45637>>>    End_Object    // TextBoxSub1
45638>>>
45638>>>    Object TextBoxSub2 is a TextBoxSub
45640>>>        Set Label to "‰à› ¡æª"
45641>>>        Set Location to 49 5
45642>>>        Set Size to 10 33
45643>>>        Set TypeFace to "MS Sans Serif"
45644>>>    End_Object    // TextBoxSub2
45645>>>
45645>>>    Object TextBoxSub13 is a TextBoxSub
45647>>>        Set Label to "‰˜«á©«˜©ž"
45648>>>        Set Location to 37 285
45649>>>        Set Size to 10 51
45650>>>        Set TypeFace to "MS Sans Serif"
45651>>>    End_Object    // TextBoxSub13
45652>>>
45652>>>    Object TextBoxSub14 is a TextBoxSub
45654>>>        Set Label to "¨å©¡œ«˜ "
45655>>>        Set Location to 49 285
45656>>>        Set Size to 12 39
45657>>>        Set TypeFace to "MS Sans Serif"
45658>>>    End_Object    // TextBoxSub14
45659>>>
45659>>>
45659>>>    //AB-StoreStart
45659>>>                                            
45659>>>                                            
45659>>>    //AB-StoreEnd
45659>>>
45659>>>End_Object    // VW037
45660>>>
45660>>>//AB/ End_Object    // prj
INCLUDING FILE: FEM.PKG
45660>>///////////////////////////////////////////////
45660>>// Ginetai #Include sto Program //
45660>>///////////////////////////////////////////////
45660>>Use Idiotht.pkg
45660>>
45660>>Integer igC
45660>>String  sgC sgFull sgRootDir sgDevicePath
45660>>Move 0 to igC
45661>>
45661>>Move (fsReadRegistryFEMRootDir   ()) To sgRootDir
45662>>Move (fsReadRegistryFEMDevicePath()) To sgDevicePath
45663>>
45663>>// An den yparxoun ta settings sto registry (apo Setup Egkatastashs)
45663>>// Tote ta ftiaxnoume me ex orismou C:\FEM_ROOT\ & C:\FEM_ROOT\Device_File1.dat
45663>>// mesa apo tis 2 parakato functions (sto Idiotht.pkg)
45663>>If (Trim(sgRootDir)   ='') Get fiWriteRegistryFEMRootDir    to iGC
45666>>If (Trim(sgDevicePath)='') Get fiWriteRegistryFEMDevicePath to iGC
45669>>//
45669>>
45669>>// ** START ** Function ths forologikhs ektypotikhs mhxanhs
45669>>External_Function32 FSL_Command "FSL_Command" rapidsign.dll;                    String  sBaseDir    ;                    String  sCommand    ;                    String  sDevFile    ;                    String  sParam1     ;                    String  sParam2     ;                    Returns Integer
45670>>
45670>>External_Function32 FSL_SignDocument "FSL_SignDocument" rapidsign.dll;                    String  sDevFile    ;                    String  sParam      ;                    String  sResult     ;                    Returns Integer
45671>>// ** END ** Function ths forologikhs ektypotikhs mhxanhs
45671>>
45671>>
45671>>// ** START ** Gemisma global string me escape xarakthron gia afairesh tous apo to ascii ths forologikhs
45671>>Move '' to sgC
45672>>For igC From 1 to 254
45678>>>
45678>>    If ((igC<32) Or ((igC>175) And (igC<224)) Or (igC>240)) Begin
45680>>        Move (Append(sgC,Character(igC))) to sgC
45681>>    End
45681>>>
45681>>Loop
45682>>>
45682>>// ** END ** Gemisma escape xarakthron gia afairesh tous apo to ascii ths forologikhs
45682>>
45682>>
45682>>Function fiEtoimaseTaAscii Returns Integer
45684>>    Integer iFileExist iii iii2 isOK
45685>>    String  sLine sLine2 sLetter sLetter2
45685>>    // 1. Check if file was outputed (C:\##Parast.txt)
45685>>    Get Get_File_Exists 'C:\##Parast.txt' to iFileExist
45686>>    If (Not(iFileExist)) Function_Return 12556
45689>>
45689>>    // 2. Check if file is outputed but empty
45689>>    Direct_Input Channel 7 "C:\##Parast.txt"
45691>>    If (Seqeof) Begin
45693>>        Close_Input Channel 7
45695>>        Function_Return 12557
45696>>    End
45696>>>
45696>>
45696>>    // 3. Strip file from escape sequences
45696>>    Direct_Output Channel 9 "C:\##Parast0.txt"
45698>>    Repeat
45698>>>
45698>>        Readln Channel 7 sLine
45700>>        For iii From 1 to (Length(sgC))
45706>>>
45706>>            Move (Replaces((Mid(sgC,1,iii)),sLine,' ')) to sLine
45707>>        Loop
45708>>>
45708>>        Writeln Channel 9 sLine
45711>>    Until (Seqeof)
45713>>    Close_Input Channel 7
45715>>    Close_Output Channel 9
45717>>
45717>>    // 4. Check if new ascii without escape
45717>>    //    sequences is outputed (C:\##Parast0.txt)
45717>>    Get Get_File_Exists 'C:\##Parast0.txt' to iFileExist
45718>>    If (Not(iFileExist)) Function_Return 12558
45721>>
45721>>    // 5. Check if new file is outputed but empty
45721>>    Direct_Input Channel 7 "C:\##Parast0.txt"
45723>>    If (Seqeof) Begin
45725>>        Close_Input Channel 7
45727>>        Function_Return 12559
45728>>    End
45728>>>
45728>>
45728>>    // 6. Convert file to ELOT
45728>>    Direct_Output Channel 9 "C:\##Parast1.txt"
45730>>    Repeat
45730>>>
45730>>        Readln Channel 7        sLine
45732>>        Move (ToAnsi(sLine)) to sLine2
45733>>        Writeln Channel 9       sLine2
45736>>    Until (Seqeof)
45738>>    Close_Input  Channel 7
45740>>    Close_Output Channel 9
45742>>
45742>>    // 7. Check if converted ELOT ascii is outputed (C:\##Parast1.txt)
45742>>    Get Get_File_Exists 'C:\##Parast1.txt' to iFileExist
45743>>    If (Not(iFileExist)) Function_Return 12560
45746>>
45746>>    // 8. Check if converted ELOT ascii is NOT Empty
45746>>    Direct_Input Channel 7 "C:\##Parast1.txt"
45748>>    If (Seqeof) Begin
45750>>        Close_Output Channel 7
45752>>        Function_Return 12561
45753>>    End
45753>>>
45753>>    Close_Output Channel 7
45755>>
45755>>    Function_Return 1 // Everything OK
45756>>End_function
45757>>
45757>>Function fiPareYpografh Returns String
45759>>    Integer iFileExist iii iii2 isOK
45760>>    String  sLine sLine2 sLetter sLetter2
45760>>    Move 0 to isOK
45761>>
45761>>    Move (FSL_Command(sgRootDir,'SIGN',sgDevicePath ,'C:\##Parast1.txt','C:\##Signature.txt')) to isOK
45762>>    If (isOK<>0) Function_Return ''
45765>>
45765>>    Direct_Input Channel 7 'C:\##Signature.txt'
45767>>    If (Seqeof) Function_Return '12562'
45770>>    Readln Channel 7 sLine
45772>>    Move (Trim(sLine)) to sLine
45773>>    If (Length(sLine)<>77) Function_Return '12563'
45776>>
45776>>    EraseFile "C:\##Parast*.txt"
45777>>>
45777>>    EraseFile "C:\##Signature.txt"
45778>>>
45778>>
45778>>    Function_return (Trim(sLine))
45779>>End_function
45780>>
45780>>Function fiVgaleZ Returns Integer
45782>>    Integer isOK
45783>>    Move 0 to isOK
45784>>    Move (FSL_Command(sgRootDir,'Z',sgDevicePath ,'','')) to isOK
45785>>    Function_return isOK
45786>>    // 0= ok
45786>>End_function
45787>>
45787>>Function fiShowCTL Returns Integer
45789>>    Integer isOK
45790>>    Move 0 to isOK
45791>>    Move (FSL_Command(sgRootDir,'CTL',sgDevicePath ,'','')) to isOK
45792>>    Function_return isOK
45793>>    // 0= ok
45793>>End_function
45794>>
45794>>Use RptVwFem.Sub
INCLUDING FILE: RPTVWFEM.SUB
45794>>>>Use DFRptvw.pkg
45794>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
45794>>>>>>
45794>>>>>>Use Windows
45794>>>>>>Use DfPanel
45794>>>>>>Use EnClient
45794>>>>>>Use DFNav_mx
45794>>>>>>Use dfConfrm
45794>>>>>>Use dfRptVw
45794>>>>>>Use DFGSINI
45794>>>>>>
45794>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
45795>>>>>>    Import_Class_Protocol Entry_Client
45796>>>>>>    //  Defeat the activating augmentation for auto-locate
45796>>>>>>    Procedure Activating Returns Integer
45797>>>>>>      local integer RVal
45798>>>>>>      forward get MSG_activating to rVal
45800>>>>>>      Procedure_Return rVal
45801>>>>>>    End_Procedure
45802>>>>>>End_Class // dbReportAppClient_
45803>>>>>>
45803>>>>>>Class dbReportAppView_ is a dbReportAppClient_
45804>>>>>>  import_Class_protocol entry_view_Client
45805>>>>>>End_Class // dbReportAppView_
45806>>>>>>
45806>>>>>>
45806>>>>>>Class dbReportView is a dbReportAppView_
45807>>>>>>
45807>>>>>>     Procedure Construct_Object
45808>>>>>>      Forward Send Construct_Object No_Image
45810>>>>>>      Send Define_DFNavigation  // GUI navigate changes
45811>>>>>>      // dialog views get activated as popup objects.
45811>>>>>>      set Dso_Detach_Mode to Detach_Always
45812>>>>>>
45812>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
45813>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
45814>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
45815>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
45816>>>>>>      //
45816>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
45816>>>>>>      // is out of the question...
45816>>>>>>      Set Minimize_Icon To False
45817>>>>>>      Set Maximize_Icon To False
45818>>>>>>   End_Procedure // Construct_Object
45819>>>>>>
45819>>>>>>   Procedure Request_Delete
45820>>>>>>   End_Procedure // request_delete
45821>>>>>>
45821>>>>>>   Procedure Request_Save
45822>>>>>>   End_Procedure // request_save
45823>>>>>>
45823>>>>>>   Function Exit_Application_Check Returns Integer
45824>>>>>>     Function_return 0
45825>>>>>>   End_Function
45826>>>>>>
45826>>>>>>   Import_Class_Protocol DFNavigate_Mixin
45827>>>>>>
45827>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
45827>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
45827>>>>>>  //  send a DEO message. DEO clients set this true
45827>>>>>>  Function DEO_Object Returns integer
45828>>>>>>    Function_Return 1
45829>>>>>>  End_Function // DEO_Object
45830>>>>>>
45830>>>>>>  //
45830>>>>>>  //  Activate message for views that:
45830>>>>>>  //  1. restores the view if it is minimized
45830>>>>>>  //  2. Maintains the current scope's focus.
45830>>>>>>  //
45830>>>>>>  Procedure Activate_current_scope
45831>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
45834>>>>>>    Set Current_Scope to Current_Object
45835>>>>>>  End_Procedure // Activate_current_scope
45836>>>>>>
45836>>>>>>  //  Pass full object name - return the relative name
45836>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
45836>>>>>>  Function Local_Object_name string nm returns string
45837>>>>>>     local integer ps
45838>>>>>>     Repeat
45838>>>>>>>
45838>>>>>>       pos "." in nm to ps
45840>>>>>>>
45840>>>>>>       If ps eq 0 function_return nm
45843>>>>>>       increment ps
45844>>>>>>       Mid Nm to Nm 255 ps
45847>>>>>>>
45847>>>>>>     Loop
45848>>>>>>>
45848>>>>>>  end_function
45849>>>>>>
45849>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
45849>>>>>>  Function Parse_Complex string sVal returns integer
45850>>>>>>     Local integer ps
45851>>>>>>     Pos "," in sVal to ps
45853>>>>>>>
45853>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
45856>>>>>>  End_Function // Parse_Complex
45857>>>>>>
45857>>>>>>  // Convert a complex integer to a string "hi,Low"
45857>>>>>>  //
45857>>>>>>  Function Complex_to_String integer i1 returns string
45858>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
45859>>>>>>  End_function
45860>>>>>>
45860>>>>>>
45860>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
45860>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
45860>>>>>>  // sense to clutter up the registry with this kind of nonsense.
45860>>>>>>  ////
45860>>>>>>  ////  Save View information to dfwin.ini file. Save as:
45860>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
45860>>>>>>  ////     Leaving room for growth here.
45860>>>>>>  ////
45860>>>>>>  Procedure Save_Environment
45861>>>>>>  //   Local String nm Vn st
45861>>>>>>  //   Local Integer H
45861>>>>>>  //
45861>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
45861>>>>>>  //   Move (Uppercase(trim(st))) to st
45861>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
45861>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
45861>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
45861>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
45861>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
45861>>>>>>  //     // button).
45861>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
45861>>>>>>  //
45861>>>>>>  //       Get Name to Vn // full name of object
45861>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
45861>>>>>>  //       Get GUILocation to H             // complex location
45861>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
45861>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
45861>>>>>>  //     End
45861>>>>>>  //   End
45861>>>>>>  //
45861>>>>>>  End_Procedure
45862>>>>>>  //
45862>>>>>>  //// Augment to check for view string in .INI. Currently, if found
45862>>>>>>  //// set the location
45862>>>>>>  ////
45862>>>>>>  Procedure Load_Environment
45863>>>>>>  //   Local String nm Vn Lc
45863>>>>>>  //   Local Integer H ps
45863>>>>>>  //   // see above for reasoning on this
45863>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
45863>>>>>>  //     Get Name to Vn
45863>>>>>>  //     Get Local_Object_Name Vn to Vn
45863>>>>>>  //     Get System_Profile_String Vn to Nm
45863>>>>>>  //     IF Nm ne '' Begin
45863>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
45863>>>>>>  //        If Ps Begin
45863>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
45863>>>>>>  //           Pos " " in Lc to ps
45863>>>>>>  //           if Ps left lc to lc (ps-1)
45863>>>>>>  //           Get Parse_Complex lc to H
45863>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
45863>>>>>>  //           Send Adjust_Logicals
45863>>>>>>  //        End
45863>>>>>>  //     End
45863>>>>>>  //   End
45863>>>>>>  End_Procedure
45864>>>>>>
45864>>>>>>  Function View_Changed returns Integer
45865>>>>>>     Local Integer Changed
45866>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
45868>>>>>>     Function_Return Changed
45869>>>>>>  End_Function
45870>>>>>>
45870>>>>>>  Procedure Notify_Exit_Application
45871>>>>>>    Send Save_Environment
45872>>>>>>  End_procedure
45873>>>>>>
45873>>>>>>  Procedure End_Construct_Object
45874>>>>>>     Send Load_Environment
45875>>>>>>     //Send Define_SysMenu
45875>>>>>>     Forward Send End_Construct_Object
45877>>>>>>  End_Procedure // End_Construct_Object
45878>>>>>>
45878>>>>>>  Procedure Close_Client
45879>>>>>>     Send Exit_Function
45880>>>>>>  End_Procedure
45881>>>>>>
45881>>>>>>  Procedure Entering_Scope returns Integer
45882>>>>>>     Local Integer rVal
45883>>>>>>     Forward Get MSG_Entering_Scope to rVal
45885>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
45888>>>>>>  End_Procedure
45889>>>>>>
45889>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
45890>>>>>>     Local Integer rVal
45891>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
45893>>>>>>     If not rVal Send Show_View_Name ''
45896>>>>>>  End_Procedure
45897>>>>>>
45897>>>>>>  Procedure Show_view_Name string sHelp
45898>>>>>>     Local Integer rVal Id
45899>>>>>>     Get Statusbar_id to id
45900>>>>>>     If Id Send Show_View_Name to Id sHelp
45903>>>>>>  End_Procedure
45904>>>>>>
45904>>>>>>  Function Should_Save_Recursive returns integer
45905>>>>>>    Function_return (View_Changed(Current_Object))
45906>>>>>>  End_Function
45907>>>>>>
45907>>>>>>End_Class // dbReportView
45908>>>>
45908>>>>Use RptVW.Sub
INCLUDING FILE: RPTVW.SUB
45908>>>>>>Use DFRptvw.pkg
45908>>>>>>Use dbRptvw.pkg
45908>>>>>>
45908>>>>>>Class ReportViewSub is a ReportView
45909>>>>>>
45909>>>>>>    Procedure Construct_Object
45910>>>>>>        Forward Send Construct_Object
45912>>>>>>        Property Integer Server 0
45913>>>>>>    End_Procedure // Construct_Object
45914>>>>>>
45914>>>>>>    Procedure Page Integer PageMode
45915>>>>>>        Integer hWnd
45916>>>>>>        Forward Send Page PageMode
45918>>>>>>        Get Window_Handle to hWnd
45919>>>>>>        If (hWnd) Begin
45921>>>>>>            Send GreekSysMenu
45922>>>>>>        End
45922>>>>>>>
45922>>>>>>    End_Procedure
45923>>>>>>
45923>>>>>>    Procedure Close_Panel
45924>>>>>>        Local Integer liScope
45925>>>>>>        Move (Prior_Scope(Desktop)) To liScope
45926>>>>>>        Move (Scope_Focus(liScope)) To liScope
45927>>>>>>        Forward Send Close_Panel
45929>>>>>>        Send Activate To liScope
45930>>>>>>    End_Procedure // Close_Panel
45931>>>>>>
45931>>>>>>End_Class
45932>>>>>>
45932>>>>>>Class dbReportViewSub is a dbReportView
45933>>>>>>
45933>>>>>>    Procedure Construct_Object
45934>>>>>>        Forward Send Construct_Object
45936>>>>>>        Property Integer Server 0
45937>>>>>>    End_Procedure // Construct_Object
45938>>>>>>
45938>>>>>>    Procedure Page Integer PageMode
45939>>>>>>        Integer hWnd
45940>>>>>>        Forward Send Page PageMode
45942>>>>>>        Get Window_Handle to hWnd
45943>>>>>>        If (hWnd) Begin
45945>>>>>>            Send GreekSysMenu
45946>>>>>>        End
45946>>>>>>>
45946>>>>>>    End_Procedure
45947>>>>>>
45947>>>>>>    Procedure Close_Panel
45948>>>>>>        Local Integer liScope
45949>>>>>>        Move (Prior_Scope(Desktop)) To liScope
45950>>>>>>        Move (Scope_Focus(liScope)) To liScope
45951>>>>>>        Forward Send Close_Panel
45953>>>>>>        Send Activate To liScope
45954>>>>>>    End_Procedure // Close_Panel
45955>>>>>>End_Class
45956>>>>>>
45956>>>>
45956>>>>Class ReportViewFEMSub is a ReportViewSub    
45957>>>>
45957>>>>    Procedure Construct_Object
45958>>>>        Forward Send Construct_Object
45960>>>>
45960>>>>        Property Integer    piIsReportCancelled     Public  0
45961>>>>        Property Integer    piAsciiOrPrinter        Public  0
45962>>>>    
45962>>>>    End_Procedure
45963>>>>    
45963>>>>
45963>>>>// ‡˜ â§¨œ§œ ž procedure ˜¬«ž
45963>>>>//
45963>>>>//    Procedure StartReport
45963>>>>//        send Gemise_Escape_Characters
45963>>>>//        String Whme_APO sRecr
45963>>>>//        integer wnees wclose
45963>>>>//        Local Integer iOutputDevice
45963>>>>//        Local String  FileName
45963>>>>//        local integer inew_state
45963>>>>//        Get Output_Device_Mode To iOutputDevice
45963>>>>//        get new_state to inew_state
45963>>>>//        set piprinter to 0
45963>>>>//        //?????????????????????????????????????????????
45963>>>>//        Get Output_Device_Mode To iOutputDevice
45963>>>>
45963>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
45963>>>>//            Set piAsciiOrPrinter    to 0
45963>>>>//            Make_Temp_File "TXT" FileName
45963>>>>//            Move (".\" - FileName)  To FileName
45963>>>>//            Set Output_Device_Name  To FileName
45963>>>>//        End
45963>>>>//        Else Begin
45963>>>>
45963>>>>//            If (Sysfile.Use_Sql_Reports='1') Begin
45963>>>>//                If (piAsciiOrPrinter(Self)=0) Error 7000 'ƒœ¤ ©œ«á¨˜«œ «¦ piAsciiOrPrinter\n(ƒœ¤ §¨¦©› ¦¨å©«ž¡œ ˜¤ ˜­¦¨á ASCII ã „¡«¬§à«ã)'
45963>>>>//            End
45963>>>>
45963>>>>//            Get psRecr Of TIMOLOGIO_BasicReport to sRecr
45963>>>>//            Move (Trim(sRecr)) to sRecr
45963>>>>
45963>>>>//            If (sRecr='') Error 7003 'ƒœ¤ ¬§á¨®œ  Recr š ˜ «¦ §˜¨˜©«˜« ¡æ'
45963>>>>
45963>>>>//            Clear Particle
45963>>>>//            Move sRecr to Particle.Partl_Recr
45963>>>>//            Find Eq Particle by index.2
45963>>>>//            If (Not(Found)) Error 7001 'ƒœ¤ ™¨âŸž¡œ «¦ §˜¨˜©«˜« ¡æ'
45963>>>>
45963>>>>//            Clear Pseira
45963>>>>//            Move SyscurXr.Company_Code  to Pseira.Company_Code
45963>>>>//            Move SyscurXr.Branch_Code   to Pseira.Branch_Code
45963>>>>//            Move Particle.Ptyppar_Code  to Pseira.Ptyppar_Code
45963>>>>//            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
45963>>>>//            Find Eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+Ptyppar_Code+Pseira_Seira
45963>>>>//            If (Not(Found)) Error 7002 'ƒœ¤ ™¨âŸž¡œ ž ©œ ¨á'
45963>>>>
45963>>>>//            If (piAsciiOrPrinter(Self)=1) Begin
45963>>>>//                // 1= Output ©œ Ascii
45963>>>>//                Set Output_Device_Name  To 'C:\##Parast.txt'
45963>>>>//            End
45963>>>>//            Else If (piAsciiOrPrinter(Self)=2) Begin
45963>>>>//                // 2= Output ©œ Printer
45963>>>>//                Set Output_Device_Name  To Pseira.Pseira_Printer
45963>>>>//            End
45963>>>>//            Else Error 7004 '’¦ Flag piAsciiOrPrinter ›œ¤ œå¤˜  ©à©«æ'
45963>>>>//        End
45963>>>>
45963>>>>//        Send Run_Report  //record
45963>>>>
45963>>>>//        If iOutputDevice EQ PRINT_TO_WINDOW Begin
45963>>>>//            RunProgram background "notepad" FileName
45963>>>>//            EraseFile FileName
45963>>>>//        End
45963>>>>
45963>>>>//    End_Procedure   // StartReport
45963>>>>
45963>>>>
45963>>>>End_Class
45964>>>>
45964>>>>Class dbReportViewFEMSub is a dbReportViewSub
45965>>>>    Procedure Construct_Object
45966>>>>        Forward Send Construct_Object
45968>>>>
45968>>>>        Property Integer    piIsReportCancelled     Public  0
45969>>>>        Property Integer    piAsciiOrPrinter        Public  0
45970>>>>    
45970>>>>    End_Procedure
45971>>>>End_Class
45972>>>>
45972>>Use BasrpFem.Sub
INCLUDING FILE: BASRPFEM.SUB
45972>>>>Use Dfrpt.pkg
45972>>>>
45972>>>>Use BasicRpt.Sub
INCLUDING FILE: BASICRPT.SUB
45972>>>>>>Use Dfrpt.pkg
45972>>>>>>
45972>>>>>>Class BasicReportSub is a BasicReport
45973>>>>>>
45973>>>>>>    Procedure Start_Log
45974>>>>>>        Send Log_Status ("Starting Report:"+Report_Title(Current_Object))
45975>>>>>>    End_Procedure // Start_Log
45976>>>>>>
45976>>>>>>    Procedure End_Log
45977>>>>>>        Send Log_Status ("Ending Report:  " + Report_Title(Current_Object))
45978>>>>>>    End_Procedure // End_Log
45979>>>>>>
45979>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
45980>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
45981>>>>>>    End_Procedure // Error_Log_Status
45982>>>>>>
45982>>>>>>    Procedure Update_Status_Page
45983>>>>>>        If (Page_End(Current_Object)) EQ 0 ;             Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
45986>>>>>>        Else Send Update_Status ("Page: "   + String(Page_Count(Current_Object)))
45988>>>>>>    End_Procedure // Update_Status_Page
45989>>>>>>
45989>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
45990>>>>>>        If (Display_Error_State(Self)) Send End_Status
45993>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
45994>>>>>>>
45994>>>>>>    End_procedure
45995>>>>>>
45995>>>>>>    Function Report_Interrupt Returns Integer
45996>>>>>>        Integer rVal
45997>>>>>>        String Mess
45997>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46000>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46002>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46003>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46006>>>>>>        Function_Return (Rval=MBR_YES)
46007>>>>>>    End_Function  // Report_Interrupt
46008>>>>>>
46008>>>>>>
46008>>>>>>    Procedure Initialize_Output_Device
46009>>>>>>        string sopenpath
46010>>>>>>        get_attribute Df_Open_path to sopenpath
46013>>>>>>        set_attribute Df_Open_path to ""
46016>>>>>>        Direct_Output (Output_Device(current_Object))
46017>>>>>>        Set_Attribute DF_open_path to sopenpath
46020>>>>>>    End_procedure
46021>>>>>>End_Class // BasicReportSub
46022>>>>>>
46022>>>>>>Class WinReportSub is a WinReport
46023>>>>>>
46023>>>>>>    Procedure Start_Log
46024>>>>>>        Send Log_Status ("Start Report:"+Report_Title(Current_Object))
46025>>>>>>    End_Procedure // Start_Log
46026>>>>>>
46026>>>>>>    Procedure End_Log
46027>>>>>>        Send Log_Status ("End Report:  " + Report_Title(Current_Object))
46028>>>>>>    End_Procedure // End_Log
46029>>>>>>
46029>>>>>>    Procedure Error_Log_Status integer ErrNum integer Err_Line string ErrMsg
46030>>>>>>        Send Log_Status ("Error #"* String(ErrNum) + "." * ErrMsg)
46031>>>>>>    End_Procedure // Error_Log_Status
46032>>>>>>
46032>>>>>>    Procedure Update_Status_Page
46033>>>>>>        If (Page_End(Current_Object)) EQ 0 ;            Send Update_Status ("Record: " + String(Page_Count(Current_Object)))
46036>>>>>>        Else Send Update_Status ("Page: " + String(Page_Count(Current_Object)))
46038>>>>>>    End_Procedure // Update_Status_Page
46039>>>>>>
46039>>>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
46040>>>>>>        If (Display_Error_State(Self)) Send End_Status
46043>>>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46044>>>>>>>
46044>>>>>>    End_procedure
46045>>>>>>
46045>>>>>>    Function Report_Interrupt Returns Integer
46046>>>>>>        Integer rVal
46047>>>>>>        String Mess
46047>>>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46050>>>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46052>>>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46053>>>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46056>>>>>>        Function_Return (Rval=MBR_YES)
46057>>>>>>    End_Function  // Report_Interrupt
46058>>>>>>
46058>>>>>>    Procedure Initialize_Output_Device
46059>>>>>>        string sopenpath
46060>>>>>>        get_attribute Df_Open_path to sopenpath
46063>>>>>>        set_attribute Df_Open_path to ""
46066>>>>>>        Direct_Output (Output_Device(current_Object))
46067>>>>>>        Set_Attribute DF_open_path to sopenpath
46070>>>>>>    End_procedure
46071>>>>>>
46071>>>>>>End_Class // WinReportSub
46072>>>>>>
46072>>>>
46072>>>>Class BasicReportFemSub is a BasicReportSub
46073>>>>
46073>>>>    Function Starting_Main_Report Returns Integer
46074>>>>        Integer   iRetVal iindexr14_1
46075>>>>        Forward Get Starting_Main_Report to iRetval
46077>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
46080>>>>        Function_Return iRetval
46081>>>>    End_Function
46082>>>>
46082>>>>    Procedure Ending_Report
46083>>>>        Integer isCancelled
46084>>>>        Get Cancelled_State         to isCancelled
46085>>>>        //If Already with error do not touch
46085>>>>        If (Report_View_Id(Self)) Begin
46087>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
46089>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
46090>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
46091>>>>>
46091>>>>            End
46091>>>>>
46091>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
46093>>>>        End
46093>>>>>
46093>>>>        Forward Send Ending_Report
46095>>>>    End_Procedure
46096>>>>
46096>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
46097>>>>        If (Display_Error_State(Self)) Send End_Status
46100>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
46101>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46102>>>>>
46102>>>>    End_procedure
46103>>>>
46103>>>>    Function Report_Interrupt Returns Integer
46104>>>>        Integer rVal
46105>>>>        String Mess
46105>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46108>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46110>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46111>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46114>>>>        Function_Return (Rval=MBR_YES)
46115>>>>    End_Function  // Report_Interrupt
46116>>>>
46116>>>>
46116>>>>
46116>>>>End_Class
46117>>>>
46117>>>>Class WinReportFEMSub is a WinReportSUB
46118>>>>
46118>>>>    Function Starting_Main_Report Returns Integer
46119>>>>        Integer   iRetVal iindexr14_1
46120>>>>        Forward Get Starting_Main_Report to iRetval
46122>>>>        If (Report_View_Id(Self)) Set piIsReportCancelled Of (Report_View_Id(Self)) to 0
46125>>>>        Function_Return iRetval
46126>>>>    End_Function
46127>>>>
46127>>>>    Procedure Ending_Report
46128>>>>        Integer isCancelled
46129>>>>        Get Cancelled_State         to isCancelled
46130>>>>        //If Already with error do not touch
46130>>>>        If (Report_View_Id(Self)) Begin
46132>>>>            If (piIsReportCancelled(Report_View_Id(Self))<>1) Begin
46134>>>>                Set piIsReportCancelled Of (Report_View_ID(Self)) to (isCancelled=1)
46135>>>>                Error 9999 '€¡ç¨à©ž „¡«ç§à©žª'
46136>>>>>
46136>>>>            End
46136>>>>>
46136>>>>            Else Error 7777 '‘­á¢£˜ ¡˜«á «ž¤ œ¡«ç§à©ž'
46138>>>>        End
46138>>>>>
46138>>>>        Forward Send Ending_Report
46140>>>>    End_Procedure
46141>>>>
46141>>>>    Procedure onError integer ErrNum integer Err_Line string ErrMsg
46142>>>>        If (Display_Error_State(Self)) Send End_Status
46145>>>>        Set piIsReportCancelled Of (Report_View_ID(Self)) to 1
46146>>>>        Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46147>>>>>
46147>>>>    End_procedure  
46148>>>>
46148>>>>    Function Report_Interrupt Returns Integer
46149>>>>        Integer rVal
46150>>>>        String Mess
46150>>>>        If (Error_Check_State(Current_Object)) ;            Move "„£­˜¤å©«ž¡œ œ¤˜ ©­á¢£˜ ¡˜«˜ «ž¤ œ§œ¥œ¨š˜©å˜. Œ˜ › ˜¡¦§œå ž œ¡«ç§à©ž ?" to Mess
46153>>>>        Else   Move  "Œ˜ ˜¡¬¨é©à «ž¤ œ¡«ç§à©ž ?" to Mess
46155>>>>        Get YesNo_Box Mess "ƒ ˜¡¦§ã „§œ¥œ¨š˜©å˜ª" to rVal
46156>>>>        If (rVal=MBR_YES) Error 8888 '€¡ç¨à©ž „¡«ç§à©žª'
46159>>>>        Function_Return (Rval=MBR_YES)
46160>>>>    End_Function  // Report_Interrupt
46161>>>>
46161>>>>End_Class
46162>>>>
46162>>
46162>        
46162>        //AB-ClientStoreTopEnd
46162>
46162>        //  Include all views
46162>
46162>        //  Include all reports
46162>        Use vwKleisimo.RV                                                                   
INCLUDING FILE: VWKLEISIMO.RV
46162>>>//AB/ Project vwKleisimo
46162>>>//AB/     Object prj is a Report_Project
46162>>>//AB/         Set ProjectName to "vwKleisimo"
46162>>>//AB/         Set ProjectFileName to "vwKleisimo.RV"
46162>>>
46162>>>// Project Object Structure
46162>>>//   vwKleisimo is a ReportViewSub
46162>>>//     value_date is a FormSub
46162>>>//     date_apo is a FormSub
46162>>>//     date_eos is a FormSub
46162>>>//     FormSub3 is a FormSub
46162>>>//       oOpenFile is a OpenDialog
46162>>>//     ButtonSub3 is a ButtonSub
46162>>>//     Chkshm is a CheckBoxSub
46162>>>//     Chkeisa is a CheckBoxSub
46162>>>//     TextBoxSub5 is a TextBoxSub
46162>>>//     TextBoxSub6 is a TextBoxSub
46162>>>//     TextBoxSub7 is a TextBoxSub
46162>>>//     TextBoxSub8 is a TextBoxSub
46162>>>//     ButtonSub5 is a ButtonSub
46162>>>//     Chkkl is a CheckBoxSub
46162>>>//     Areas_DD is a Areas_DataDictionary
46162>>>//     Payresp_DD is a Payresp_DataDictionary
46162>>>//     syscurxr_DD is a syscurxr_DataDictionary
46162>>>//     Country_DD is a Country_DataDictionary
46162>>>//     Towns_DD is a Towns_DataDictionary
46162>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
46162>>>//     Cities_DD is a Cities_DataDictionary
46162>>>//     Clients_DD is a Clients_DataDictionary
46162>>>//     Cmoves_DD is a Cmoves_DataDictionary
46162>>>//     metafyp_BasicReport is a BasicReport
46162>>>//       Areas_DD is a Areas_DataDictionary
46162>>>//       Payresp_DD is a Payresp_DataDictionary
46162>>>//       syscurxr_DD is a syscurxr_DataDictionary
46162>>>//       Country_DD is a Country_DataDictionary
46162>>>//       Towns_DD is a Towns_DataDictionary
46162>>>//       Ctypkin_DD is a Ctypkin_DataDictionary
46162>>>//       Cities_DD is a Cities_DataDictionary
46162>>>//       Clients_DD is a Clients_DataDictionary
46162>>>//       Cmoves_DD is a Cmoves_DataDictionary
46162>>>//       Cmovesa_DD is a Cmovesa_DataDictionary
46162>>>
46162>>>// Register all objects
46162>>>Register_Object Areas_DD
46162>>>Register_Object ButtonSub3
46162>>>Register_Object ButtonSub5
46162>>>Register_Object Chkeisa
46162>>>Register_Object Chkkl
46162>>>Register_Object Chkshm
46162>>>Register_Object Cities_DD
46162>>>Register_Object Clients_DD
46162>>>Register_Object Cmoves_DD
46162>>>Register_Object Cmovesa_DD
46162>>>Register_Object Country_DD
46162>>>Register_Object Ctypkin_DD
46162>>>Register_Object date_apo
46162>>>Register_Object date_eos
46162>>>Register_Object FormSub3
46162>>>Register_Object metafyp_BasicReport
46162>>>Register_Object oOpenFile
46162>>>Register_Object Payresp_DD
46162>>>Register_Object syscurxr_DD
46162>>>Register_Object TextBoxSub5
46162>>>Register_Object TextBoxSub6
46162>>>Register_Object TextBoxSub7
46162>>>Register_Object TextBoxSub8
46162>>>Register_Object Towns_DD
46162>>>Register_Object value_date
46162>>>Register_Object vwKleisimo
46162>>>
46162>>>
46162>>>//AB/     Report View
46162>>>
46162>>>
46162>>>    //AB-StoreTopStart
46162>>>    Use dfallrpt.pkg
46162>>>    use areas.dd
46162>>>    use country.dd
46162>>>    use towns.dd
46162>>>    use payresp.dd
46162>>>    Use cities.DD
46162>>>    Use clients.DD
46162>>>    Use ctypkin.DD
46162>>>    Use cmoves.DD
INCLUDING FILE: CMOVES.DD
46162>>>>>//DDB-FileStart
46162>>>>>//DDB-HeaderStart
46162>>>>>
46162>>>>>// File Name : CMOVES.DD
46162>>>>>// Class Name: Cmoves_DataDictionary
46162>>>>>// Revision  : 148
46162>>>>>// Version   : 2
46162>>>>>
46162>>>>>Use  Windows           // Basic Definitions
46162>>>>>Use  DataDict          // DataDictionary Class Definition
46162>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46162>>>>>
46162>>>>>Open Cmoves
46164>>>>>Open Copen
INCLUDING FILE: COPEN.FD
46166>>>>>Open Ctypkin
46168>>>>>Open Clients
46170>>>>>Open Sysrecc
46172>>>>>Open Syscurxr
46174>>>>>
46174>>>>>//DDB-HeaderEnd
46174>>>>>//DDB-SelectionStart
46174>>>>>//DDB/ ExternalSelectionList sl006  sl006.SL
46174>>>>>//DDB/ ExternalSelectionList slNomism  slnomism.sl
46174>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46174>>>>>Register_Object sl006
46174>>>>>Register_Object slNomism
46174>>>>>Register_Object sl041
46174>>>>>//DDB-SelectionEnd
46174>>>>> 
46174>>>>>Use Payresp.DD
46174>>>>>Use PmsSxet.DD
INCLUDING FILE: PMSSXET.DD
46174>>>>>>>//DDB-FileStart
46174>>>>>>>//DDB-HeaderStart
46174>>>>>>>
46174>>>>>>>// File Name : PMSSXET.DD
46174>>>>>>>// Class Name: PmsSxet_DataDictionary
46174>>>>>>>// Revision  : 27
46174>>>>>>>// Version   : 2
46174>>>>>>>
46174>>>>>>>Use  Windows           // Basic Definitions
46174>>>>>>>Use  DataDict          // DataDictionary Class Definition
46174>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46174>>>>>>>
46174>>>>>>>Open Pmssxet
INCLUDING FILE: PMSSXET.FD
46176>>>>>>>Open Pmoves
INCLUDING FILE: PMOVES.FD
46178>>>>>>>Open Psxetika
INCLUDING FILE: PSXETIKA.FD
46180>>>>>>>Open Pmoves
46182>>>>>>>
46182>>>>>>>//DDB-HeaderEnd
46182>>>>>>>
46182>>>>>>>Use bpEnYpol.dg
INCLUDING FILE: BPENYPOL.DG
46182>>>>>>>>>//AB/ Project bpEnYpol
46182>>>>>>>>>//AB/ Object prj is a Dialog_Project
46182>>>>>>>>>//AB/     Set ProjectName to "bpEnYpol"
46182>>>>>>>>>//AB/     Set ProjectFileName to "bpEnYpol.DG"
46182>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
46182>>>>>>>>>
46182>>>>>>>>>// Project Object Structure
46182>>>>>>>>>//   bpEnYpol is a BusinessProcessSub
46182>>>>>>>>>
46182>>>>>>>>>// Register all objects
46182>>>>>>>>>Register_Object bpEnYpol
46182>>>>>>>>>
46182>>>>>>>>>
46182>>>>>>>>>//AB-IgnoreStart
46182>>>>>>>>>
46182>>>>>>>>>Use Bproces.Sub
46182>>>>>>>>>
46182>>>>>>>>>
46182>>>>>>>>>//AB-IgnoreEnd
46182>>>>>>>>>
46182>>>>>>>>>Object bpEnYpol is a BusinessProcessSub
46184>>>>>>>>>
46184>>>>>>>>>    //AB-StoreTopStart
46184>>>>>>>>>
46184>>>>>>>>>    Open Pmoves
46186>>>>>>>>>    Open Psxetika
46188>>>>>>>>>
46188>>>>>>>>>    Set Status_Panel_State to False
46189>>>>>>>>>    //Set Allow_Cancel_State  to True
46189>>>>>>>>>    Set Display_Error_State to True
46190>>>>>>>>>    //Set Process_Title to "               "
46190>>>>>>>>>    //Set Status_Log_id to (status_log(Self)) //Use statlog.pkg
46190>>>>>>>>>    //Set Status_log_state to True
46190>>>>>>>>>
46190>>>>>>>>>    Property Integer    piFromAkyrosh       Public  0
46192>>>>>>>>>    Property Integer    piLathos            Public  0
46194>>>>>>>>>    Property Number     pnQty               Public  0
46196>>>>>>>>>    Property Integer    piCurrentPartl      Public  0
46198>>>>>>>>>    Property Integer    piCurrentPmoves     Public  0
46200>>>>>>>>>    Property Integer    piCurrentPmsSxet    Public  0
46202>>>>>>>>>    Property String     psRecr              Public ''
46204>>>>>>>>>
46204>>>>>>>>>
46204>>>>>>>>>    //AB-StoreTopEnd
46204>>>>>>>>>
46204>>>>>>>>>    Set Size to 60 100
46205>>>>>>>>>    Set Location to 4 5
46206>>>>>>>>>
46206>>>>>>>>>    //AB-DDOStart
46206>>>>>>>>>
46206>>>>>>>>>
46206>>>>>>>>>    //AB-DDOEnd
46206>>>>>>>>>
46206>>>>>>>>>
46206>>>>>>>>>    //AB-StoreStart
46206>>>>>>>>>
46206>>>>>>>>>    Function fiUpdate_Pmoves_Qty String asRecr Number anQty Integer aiDoNotOpen Returns Integer
46208>>>>>>>>>        Clear Pmoves
46209>>>>>>>>>        Move asRecr to Pmoves.Pms_Recr
46210>>>>>>>>>        Find Eq Pmoves by index.2
46211>>>>>>>>>>
46211>>>>>>>>>        If (Found) Begin
46213>>>>>>>>>            If ((Pmoves.Timol_Qty+anQty) > Pmoves.Pms_Qty)      Function_Return 40001
46216>>>>>>>>>            Else Begin
46217>>>>>>>>>                Add anQty to Pmoves.Timol_Qty
46218>>>>>>>>>                Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty) to Pmoves.Timol_Ypol
46219>>>>>>>>>                If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)  Function_Return 40003
46222>>>>>>>>>                Saverecord Pmoves
46223>>>>>>>>>
46223>>>>>>>>>                Clear Particle
46224>>>>>>>>>                Move Pmoves.Partl_Recr to Particle.Partl_Recr
46225>>>>>>>>>                Find Eq Particle by Index.2
46226>>>>>>>>>>
46226>>>>>>>>>                If (Found) Begin
46228>>>>>>>>>                   // Reread
46228>>>>>>>>>                    Add anQty to Particle.Timol_Qty
46229>>>>>>>>>                    If (Particle.Partl_TotTem>0) Begin
46231>>>>>>>>>                        Move (Particle.Partl_TotTem-Particle.Timol_Qty)     to Particle.Timol_Ypol
46232>>>>>>>>>
46232>>>>>>>>>                        If (aiDoNotOpen=1)  Move 1                          to Particle.Partl_Timol
46235>>>>>>>>>                        Else                Move (Particle.Timol_Ypol=0 )   to Particle.Partl_Timol
46237>>>>>>>>>
46237>>>>>>>>>                    End
46237>>>>>>>>>>
46237>>>>>>>>>                    Else Move 0 to Particle.Partl_Timol
46239>>>>>>>>>                    Saverecord Particle
46240>>>>>>>>>                   // Unlock
46240>>>>>>>>>                End
46240>>>>>>>>>>
46240>>>>>>>>>                Else Function_Return 40002
46242>>>>>>>>>            End
46242>>>>>>>>>>
46242>>>>>>>>>        End
46242>>>>>>>>>>
46242>>>>>>>>>        Else Function_Return 40000
46244>>>>>>>>>        Function_Return 0
46245>>>>>>>>>    End_Function
46246>>>>>>>>>
46246>>>>>>>>>    Procedure OnProcess
46248>>>>>>>>>        Integer iLathos iSub iAkyro
46249>>>>>>>>>        String  sCurr sRecr sPmoveRecr sParticleRecr
46249>>>>>>>>>        Number  nQty nQty2
46249>>>>>>>>>
46249>>>>>>>>>        Set piLathos        to 0
46250>>>>>>>>>        Get pnQty           to nQty2
46251>>>>>>>>>        Get psRecr          to sRecr
46252>>>>>>>>>        Get piFromAkyrosh   to iAkyro
46253>>>>>>>>>
46253>>>>>>>>>        // An h posothta einai setarismenh thetika shmainei pos klhthike
46253>>>>>>>>>        // apo thn Update tou PmsSxet, allios an erthei arnhtikh apo thn Backout
46253>>>>>>>>>        // Prepei na to xeroume gia thn periptosh tou akyrotikou, opou tha trexei
46253>>>>>>>>>        // apanota h function kai tha antistrpsei to proshmo ths posothtas.
46253>>>>>>>>>        Move (nQty2<0)   to iSub
46254>>>>>>>>>
46254>>>>>>>>>
46254>>>>>>>>>        Get fiUpdate_Pmoves_Qty sRecr nQty2 0 to iLathos
46255>>>>>>>>>
46255>>>>>>>>>        If (iLathos) Begin
46257>>>>>>>>>            Set piLathos to iLathos
46258>>>>>>>>>            Procedure_Return
46259>>>>>>>>>        End
46259>>>>>>>>>>
46259>>>>>>>>>
46259>>>>>>>>>
46259>>>>>>>>>        // js 30/08/2002 Enhmerosh ena bhma pio piso sthn periptosh pou
46259>>>>>>>>>        // h enhmerosh ton pmoves apo backout kai update tou PmsSxet,
46259>>>>>>>>>        // afora Akyrotiko. (DAP --> TIM --> AKYROTIKO). Erxomaste dhladh edo apo
46259>>>>>>>>>        // AKYROTIKO na enhmerosoume tis posothtes tou TIMOLOGIOU.
46259>>>>>>>>>        // Sthn periptosh ayth prepei na kanoume ta exhs:
46259>>>>>>>>>        // 1. Eyresh ton sxetikon tou trxontos pmove TIMOLOGIOU
46259>>>>>>>>>        // 2. Antistrofh tou proshmou ths posothtas tous
46259>>>>>>>>>        // 3. Eyresh tou arxikou Pmoves (DAP) kai enhmerosh posothtas kinhshs
46259>>>>>>>>>
46259>>>>>>>>>        If (iAkyro) Begin
46261>>>>>>>>>            Clear Pmoves
46262>>>>>>>>>            Move sRecr to Pmoves.Pms_Recr
46263>>>>>>>>>            Find Eq Pmoves by index.2
46264>>>>>>>>>>
46264>>>>>>>>>            If (Found) Begin
46266>>>>>>>>>                Clear PmsSxet
46267>>>>>>>>>                Move sRecr to PmsSxet.Pms_Recr
46268>>>>>>>>>                Find Gt PmsSxet by Index.1
46269>>>>>>>>>>
46269>>>>>>>>>                While ((Found=1) And (PmsSxet.Pms_Recr=sRecr))
46273>>>>>>>>>                    Move PmsSxet.Sxetiko_Recr   to sCurr
46274>>>>>>>>>                    Move PmsSxet.Posothta       to nQty
46275>>>>>>>>>                    If (iSub) Begin
46277>>>>>>>>>                        // An Exei erthei apo Backout tou PmsSxet (to gnorizoume apo thn posothta
46277>>>>>>>>>                        // h opoia sto property einai arnhtikh) tote gyrname thn posothta tou
46277>>>>>>>>>                        // PmsSxet thetikh (Ousiastika thn afhnoume opos einai dhladh).
46277>>>>>>>>>                    End
46277>>>>>>>>>>
46277>>>>>>>>>                    Else Begin
46278>>>>>>>>>                        // An Exei erthei apo Update tou PmsSxet (to gnorizoume apo thn posothta
46278>>>>>>>>>                        // h opoia sto property einai thetikh) tote gyrname thn posothta tou
46278>>>>>>>>>                        // PmsSxet arnhtikh.
46278>>>>>>>>>                        Move (nQty*(-1)) to nQty
46279>>>>>>>>>                    End
46279>>>>>>>>>>
46279>>>>>>>>>
46279>>>>>>>>>                    //Get fiUpdate_Pmoves_Qty sCurr nQty 1 to iLathos
46279>>>>>>>>>                    // 07/01/2003 //
46279>>>>>>>>>                    Get fiUpdate_Pmoves_Qty sCurr nQty 0 to iLathos
46280>>>>>>>>>
46280>>>>>>>>>                    If (iLathos) Begin
46282>>>>>>>>>                        Set piLathos to (iLathos+3)
46283>>>>>>>>>                        // An Gyrisei Pmoves Not Found      (40000) To kanoume 40003
46283>>>>>>>>>                        // An Gyrisei problhma sto ypoloipo (40001) To kanoume 40004
46283>>>>>>>>>                        // An Gyrisei problhma sto particle (40002) To kanoume 40005
46283>>>>>>>>>                        // An Gyrisei problhma sto particle (40003) To kanoume 40006
46283>>>>>>>>>                        Procedure_Return
46284>>>>>>>>>                    End
46284>>>>>>>>>>
46284>>>>>>>>>
46284>>>>>>>>>                    Clear PmsSxet
46285>>>>>>>>>                    Move sRecr      to PmsSxet.Pms_Recr
46286>>>>>>>>>                    Move sCurr      to PmsSxet.Sxetiko_Recr
46287>>>>>>>>>                    Find Eq PmsSxet by Index.1
46288>>>>>>>>>>
46288>>>>>>>>>                    Find Gt PmsSxet by Index.1
46289>>>>>>>>>>
46289>>>>>>>>>                Loop
46290>>>>>>>>>>
46290>>>>>>>>>            End
46290>>>>>>>>>>
46290>>>>>>>>>            Else Set piLathos to 40007
46292>>>>>>>>>        End
46292>>>>>>>>>>
46292>>>>>>>>>
46292>>>>>>>>>        If (piLathos(Self)<>0) Procedure_Return
46295>>>>>>>>>
46295>>>>>>>>>    End_Procedure
46296>>>>>>>>>
46296>>>>>>>>>    Procedure OnError integer error_info string errMsg
46298>>>>>>>>>    End_Procedure
46299>>>>>>>>>
46299>>>>>>>>>    Procedure Start_Process
46301>>>>>>>>>        Forward Send Start_Process
46303>>>>>>>>>    End_Procedure
46304>>>>>>>>>
46304>>>>>>>>>    Procedure End_Process
46306>>>>>>>>>        Forward Send End_Process
46308>>>>>>>>>        If (piCurrentPartl(Self)) Begin
46310>>>>>>>>>            Clear Particle
46311>>>>>>>>>            Move (piCurrentPartl(Self)) to Particle.Recnum
46312>>>>>>>>>            Find Eq Particle.Recnum
46313>>>>>>>>>>
46313>>>>>>>>>        End
46313>>>>>>>>>>
46313>>>>>>>>>        If (piCurrentPmoves(Self)) Begin
46315>>>>>>>>>            Clear Pmoves
46316>>>>>>>>>            Move (piCurrentPmoves(Self)) to Pmoves.Recnum
46317>>>>>>>>>            Find Eq Pmoves.Recnum
46318>>>>>>>>>>
46318>>>>>>>>>        End
46318>>>>>>>>>>
46318>>>>>>>>>        If (piCurrentPmsSxet(Self)<>0) Begin
46320>>>>>>>>>            Clear PmsSxet
46321>>>>>>>>>            Move (piCurrentPmsSxet(Self)) to PmsSxet.Recnum
46322>>>>>>>>>            Find Eq PmsSxet.Recnum
46323>>>>>>>>>>
46323>>>>>>>>>        End
46323>>>>>>>>>>
46323>>>>>>>>>    End_Procedure
46324>>>>>>>>>
46324>>>>>>>>>    //AB-StoreEnd
46324>>>>>>>>>
46324>>>>>>>>>End_Object    // bpEnYpol
46325>>>>>>>>>
46325>>>>>>>>>//AB/ End_Object    // prj
46325>>>>>>>Use MyArray.dg
INCLUDING FILE: MYARRAY.DG
46325>>>>>>>>>//AB/ Project MyArray
46325>>>>>>>>>//AB/     Object prj is a Dialog_Project
46325>>>>>>>>>//AB/         Set ProjectName to "MyArray"
46325>>>>>>>>>//AB/         Set ProjectFileName to "MyArray.DG"
46325>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46325>>>>>>>>>
46325>>>>>>>>>// Project Object Structure
46325>>>>>>>>>//   Psx_Array is a BusinessProcessSub
46325>>>>>>>>>//     Ctypkin_DD2 is a Ctypkin_DataDictionary
46325>>>>>>>>>//     Wtypkin_DD2 is a Wtypkin_DataDictionary
46325>>>>>>>>>//     Ptyppar_DD2 is a Ptyppar_DataDictionary
46325>>>>>>>>>//     Country_DD2 is a Country_DataDictionary
46325>>>>>>>>>//     Towns_DD2 is a Towns_DataDictionary
46325>>>>>>>>>//     Cities_DD2 is a Cities_DataDictionary
46325>>>>>>>>>//     Areas_DD2 is a Areas_DataDictionary
46325>>>>>>>>>//     Payresp_DD2 is a Payresp_DataDictionary
46325>>>>>>>>>//     Clients_DD2 is a Clients_DataDictionary
46325>>>>>>>>>//     Nomisma_DD2 is a Nomisma_DataDictionary
46325>>>>>>>>>//     Particle_DD2 is a Particle_DataDictionary
46325>>>>>>>>>//     Ctypkin_DD is a Ctypkin_DataDictionary
46325>>>>>>>>>//     Wtypkin_DD is a Wtypkin_DataDictionary
46325>>>>>>>>>//     Ptyppar_DD is a Ptyppar_DataDictionary
46325>>>>>>>>>//     Country_DD is a Country_DataDictionary
46325>>>>>>>>>//     Towns_DD is a Towns_DataDictionary
46325>>>>>>>>>//     Cities_DD is a Cities_DataDictionary
46325>>>>>>>>>//     Areas_DD is a Areas_DataDictionary
46325>>>>>>>>>//     Payresp_DD is a Payresp_DataDictionary
46325>>>>>>>>>//     Clients_DD is a Clients_DataDictionary
46325>>>>>>>>>//     Nomisma_DD is a Nomisma_DataDictionary
46325>>>>>>>>>//     Particle_DD is a Particle_DataDictionary
46325>>>>>>>>>//     Psxetika_DD is a Psxetika_DataDictionary
46325>>>>>>>>>
46325>>>>>>>>>// Register all objects
46325>>>>>>>>>Register_Object Areas_DD
46325>>>>>>>>>Register_Object Areas_DD2
46325>>>>>>>>>Register_Object Cities_DD
46325>>>>>>>>>Register_Object Cities_DD2
46325>>>>>>>>>Register_Object Clients_DD
46325>>>>>>>>>Register_Object Clients_DD2
46325>>>>>>>>>Register_Object Country_DD
46325>>>>>>>>>Register_Object Country_DD2
46325>>>>>>>>>Register_Object Ctypkin_DD
46325>>>>>>>>>Register_Object Ctypkin_DD2
46325>>>>>>>>>Register_Object Nomisma_DD
46325>>>>>>>>>Register_Object Nomisma_DD2
46325>>>>>>>>>Register_Object Particle_DD
46325>>>>>>>>>Register_Object Particle_DD2
46325>>>>>>>>>Register_Object Payresp_DD
46325>>>>>>>>>Register_Object Payresp_DD2
46325>>>>>>>>>Register_Object Psx_Array
46325>>>>>>>>>Register_Object Psxetika_DD
46325>>>>>>>>>Register_Object Ptyppar_DD
46325>>>>>>>>>Register_Object Ptyppar_DD2
46325>>>>>>>>>Register_Object Towns_DD
46325>>>>>>>>>Register_Object Towns_DD2
46325>>>>>>>>>Register_Object Wtypkin_DD
46325>>>>>>>>>Register_Object Wtypkin_DD2
46325>>>>>>>>>
46325>>>>>>>>>
46325>>>>>>>>>
46325>>>>>>>>>    //AB-StoreTopStart
46325>>>>>>>>>
46325>>>>>>>>>    Use CTYPKIN.DD
46325>>>>>>>>>    Use WTYPKIN.DD
INCLUDING FILE: WTYPKIN.DD
46325>>>>>>>>>>>//DDB-FileStart
46325>>>>>>>>>>>//DDB-HeaderStart
46325>>>>>>>>>>>
46325>>>>>>>>>>>// File Name : WTYPKIN.DD
46325>>>>>>>>>>>// Class Name: Wtypkin_DataDictionary
46325>>>>>>>>>>>// Revision  : 49
46325>>>>>>>>>>>// Version   : 2
46325>>>>>>>>>>>
46325>>>>>>>>>>>Use  Windows           // Basic Definitions
46325>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46325>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46325>>>>>>>>>>>
46325>>>>>>>>>>>Open Wtypkin
46327>>>>>>>>>>>Open Ptyppar
46329>>>>>>>>>>>Open Wcmoves
INCLUDING FILE: WCMOVES.FD
46331>>>>>>>>>>>Open Hmwtyp
INCLUDING FILE: HMWTYP.FD
46333>>>>>>>>>>>Open Wflagkin
INCLUDING FILE: WFLAGKIN.FD
46335>>>>>>>>>>>Open Sysrecw
46337>>>>>>>>>>>Open Syscurxr
46339>>>>>>>>>>>
46339>>>>>>>>>>>//DDB-HeaderEnd
46339>>>>>>>>>>>//DDB-ValidationStart
46339>>>>>>>>>>>
46339>>>>>>>>>>>Register_Object Wtypkin_Wtypkin_Module_VT
46339>>>>>>>>>>>
46339>>>>>>>>>>>Object Wtypkin_Wtypkin_Module_VT  is a CodeValidationTable
46341>>>>>>>>>>>    Set Type_Value        To "MODULE"
46342>>>>>>>>>>>    //DDB-ValidationCustomStart
46342>>>>>>>>>>>    //DDB-ValidationCustomEnd
46342>>>>>>>>>>>End_Object   // Wtypkin_Wtypkin_Module_VT
46343>>>>>>>>>>>//DDB-ValidationEnd
46343>>>>>>>>>>>//DDB-SelectionStart
46343>>>>>>>>>>>//DDB/ ExternalSelectionList sl029a  sl029a.SL
46343>>>>>>>>>>>Register_Object sl029a
46343>>>>>>>>>>>//DDB-SelectionEnd
46343>>>>>>>>>>>
46343>>>>>>>>>>>Class Wtypkin_DataDictionary  is a DataDictionary
46344>>>>>>>>>>>               
46344>>>>>>>>>>>    Procedure Construct_Object
46345>>>>>>>>>>>        Forward Send Construct_Object
46347>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
46348>>>>>>>>>>>    End_Procedure
46349>>>>>>>>>>>
46349>>>>>>>>>>>    Procedure Save_Main_File
46350>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46352>>>>>>>>>>>            If Wtypkin.Recnum Eq 0 Procedure_Return
46355>>>>>>>>>>>        End
46355>>>>>>>>>>>>
46355>>>>>>>>>>>        Forward Send Save_Main_File
46357>>>>>>>>>>>    End_Procedure
46358>>>>>>>>>>>
46358>>>>>>>>>>>
46358>>>>>>>>>>>     Procedure Creating
46359>>>>>>>>>>>        Forward Send Creating
46361>>>>>>>>>>>        // Insert Code Here
46361>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wtypkin.Wtypkin_Rec0)))))) to Wtypkin.Wtypkin_Recr
46362>>>>>>>>>>>    End_Procedure   // Creating
46363>>>>>>>>>>>
46363>>>>>>>>>>>    // Define_Fields:
46363>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46363>>>>>>>>>>>
46363>>>>>>>>>>>    Procedure Define_Fields
46364>>>>>>>>>>>        Forward Send Define_Fields
46366>>>>>>>>>>>        //DDB-Generated-Code-Location
46366>>>>>>>>>>>        //DDB-DefineFieldStart
46366>>>>>>>>>>>
46366>>>>>>>>>>>        Set Main_File            To Wtypkin.File_Number
46367>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46368>>>>>>>>>>>
46368>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46369>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46370>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46371>>>>>>>>>>>
46371>>>>>>>>>>>        // Child (Client) file structure................
46371>>>>>>>>>>>        Send Add_Client_File  Ptyppar.File_Number
46372>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
46373>>>>>>>>>>>        Send Add_Client_File  Hmwtyp.File_Number
46374>>>>>>>>>>>        Send Add_Client_File  Wflagkin.File_Number
46375>>>>>>>>>>>
46375>>>>>>>>>>>        // External (System) file structure.............
46375>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
46376>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46377>>>>>>>>>>>
46377>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wtypkin_Rec0  To Wtypkin.Wtypkin_Rec0
46380>>>>>>>>>>>
46380>>>>>>>>>>>        // Field-based properties.......................
46380>>>>>>>>>>>
46380>>>>>>>>>>>        // Wtypkin.Company_Code
46380>>>>>>>>>>>
46380>>>>>>>>>>>        // Wtypkin.Branch_Code
46380>>>>>>>>>>>
46380>>>>>>>>>>>        // Wtypkin.Year_Year
46380>>>>>>>>>>>
46380>>>>>>>>>>>        // Wtypkin.Wtypkin_Code
46380>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Code To DD_AUTOFIND   
46381>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Code To (sl029a(Self))
46382>>>>>>>>>>>        Set Key_Field_State        Field Wtypkin.Wtypkin_Code To TRUE
46383>>>>>>>>>>>
46383>>>>>>>>>>>        // Wtypkin.Wtypkin_Rec0
46383>>>>>>>>>>>        Set Field_Options          Field Wtypkin.Wtypkin_Rec0 To DD_AUTOFIND   
46384>>>>>>>>>>>
46384>>>>>>>>>>>        // Wtypkin.Wtypkin_Recr
46384>>>>>>>>>>>
46384>>>>>>>>>>>        // Wtypkin.Year_Recr
46384>>>>>>>>>>>
46384>>>>>>>>>>>        // Wtypkin.Wtypkin_Descr
46384>>>>>>>>>>>        Set Field_Prompt_Object    Field Wtypkin.Wtypkin_Descr To (sl029a(Self))
46385>>>>>>>>>>>
46385>>>>>>>>>>>        // Wtypkin.Wtypkin_Anti
46385>>>>>>>>>>>
46385>>>>>>>>>>>        // Wtypkin.Wtypkin_Module
46385>>>>>>>>>>>        Set Field_Value_Table      Field Wtypkin.Wtypkin_Module To (Wtypkin_Wtypkin_Module_VT(Self))
46386>>>>>>>>>>>
46386>>>>>>>>>>>        // Wtypkin.Max_Days_Sx_Par
46386>>>>>>>>>>>
46386>>>>>>>>>>>        //DDB-DefineFieldEnd
46386>>>>>>>>>>>    End_Procedure    // Define_Fields
46387>>>>>>>>>>>
46387>>>>>>>>>>>    // Field_Defaults:
46387>>>>>>>>>>>    // This procedure is used to establish default field values.
46387>>>>>>>>>>>
46387>>>>>>>>>>>    Procedure Field_Defaults
46388>>>>>>>>>>>        Forward Send Field_Defaults
46390>>>>>>>>>>>        //DDB-Generated-Code-Location
46390>>>>>>>>>>>        //DDB-FieldDefaultStart
46390>>>>>>>>>>>        //DDB-FieldDefaultEnd
46390>>>>>>>>>>>    End_Procedure    // Field_Defaults
46391>>>>>>>>>>>
46391>>>>>>>>>>>End_Class    // Wtypkin_DataDictionary
46392>>>>>>>>>>>//DDB-Selection-pkg-Start
46392>>>>>>>>>>>
46392>>>>>>>>>>>Use sl029a.SL        // sl029a
INCLUDING FILE: SL029A.SL
46392>>>>>>>>>>>>>//AB/ Project sl029a:wtypkin
46392>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46392>>>>>>>>>>>>>//AB/         Set ProjectName to "sl029a:wtypkin"
46392>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl029a.SL"
46392>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>// Project Object Structure
46392>>>>>>>>>>>>>//   sl029a is a dbModalPanelSub
46392>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46392>>>>>>>>>>>>>//     oSelList is a dbListSub
46392>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46392>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46392>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>// Register all objects
46392>>>>>>>>>>>>>Register_Object oCancel_bn
46392>>>>>>>>>>>>>Register_Object oOK_bn
46392>>>>>>>>>>>>>Register_Object oSearch_bn
46392>>>>>>>>>>>>>Register_Object oSelList
46392>>>>>>>>>>>>>Register_Object sl029a
46392>>>>>>>>>>>>>Register_Object Wtypkin_DD
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>    //AB-IgnoreStart
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>    Use DFAllEnt.pkg
46392>>>>>>>>>>>>>    Use dbList.Sub
46392>>>>>>>>>>>>>    Use Button.Sub
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>    Use WTYPKIN.DD
46392>>>>>>>>>>>>>    
46392>>>>>>>>>>>>>    //AB-IgnoreEnd
46392>>>>>>>>>>>>>
46392>>>>>>>>>>>>>    Object sl029a is a dbModalPanelSub
46394>>>>>>>>>>>>>        set label to "Ž¨ ©£æª ‰ ¤ã©œà¤ €§¦Ÿã¡žª" 
46395>>>>>>>>>>>>>        Set Size to 148 297
46396>>>>>>>>>>>>>        Set Location to 4 5
46397>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46398>>>>>>>>>>>>>        Set Modal_State to FALSE
46399>>>>>>>>>>>>>
46399>>>>>>>>>>>>>        //AB-DDOStart
46399>>>>>>>>>>>>>
46399>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
46401>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
46402>>>>>>>>>>>>>
46402>>>>>>>>>>>>>        Set Main_DD to (Wtypkin_DD(self))
46403>>>>>>>>>>>>>        Set Server to (Wtypkin_DD(self))
46404>>>>>>>>>>>>>
46404>>>>>>>>>>>>>        //AB-DDOEnd
46404>>>>>>>>>>>>>
46404>>>>>>>>>>>>>        Object oSelList is a dbListSub
46406>>>>>>>>>>>>>            Set Main_File to Wtypkin.File_Number
46407>>>>>>>>>>>>>            Set Size to 105 280
46408>>>>>>>>>>>>>            Set Location to 6 6
46409>>>>>>>>>>>>>
46409>>>>>>>>>>>>>            Begin_Row
46412>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_code
46413>>>>>>>>>>>>>                Entry_Item Wtypkin.Wtypkin_descr
46414>>>>>>>>>>>>>            End_Row
46419>>>>>>>>>>>>>
46419>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
46420>>>>>>>>>>>>>            set header_label  item 0 to "‰à› ¡¦ª" 
46421>>>>>>>>>>>>>            
46421>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
46422>>>>>>>>>>>>>            set header_label  item 1 to "œ¨ š¨˜­ã" 
46423>>>>>>>>>>>>>            
46423>>>>>>>>>>>>>        End_Object    // oSelList
46424>>>>>>>>>>>>>
46424>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46426>>>>>>>>>>>>>            set label to "&„§ ¢¦šã" 
46427>>>>>>>>>>>>>            Set Location to 115 126
46428>>>>>>>>>>>>>
46428>>>>>>>>>>>>>            //AB-StoreStart
46428>>>>>>>>>>>>>            Procedure OnClick
46430>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46431>>>>>>>>>>>>>            End_Procedure
46432>>>>>>>>>>>>>            //AB-StoreEnd
46432>>>>>>>>>>>>>
46432>>>>>>>>>>>>>        End_Object    // oOK_bn
46433>>>>>>>>>>>>>
46433>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46435>>>>>>>>>>>>>            set label to "&€¡ç¨à©ž" 
46436>>>>>>>>>>>>>            Set Location to 115 181
46437>>>>>>>>>>>>>
46437>>>>>>>>>>>>>            //AB-StoreStart
46437>>>>>>>>>>>>>            Procedure OnClick
46439>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46440>>>>>>>>>>>>>            End_Procedure
46441>>>>>>>>>>>>>            //AB-StoreEnd
46441>>>>>>>>>>>>>
46441>>>>>>>>>>>>>        End_Object    // oCancel_bn
46442>>>>>>>>>>>>>
46442>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46444>>>>>>>>>>>>>            set label to "€&¤˜ã«ž©ž" 
46445>>>>>>>>>>>>>            Set Location to 115 236
46446>>>>>>>>>>>>>
46446>>>>>>>>>>>>>            //AB-StoreStart
46446>>>>>>>>>>>>>            Procedure OnClick
46448>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46449>>>>>>>>>>>>>            End_Procedure
46450>>>>>>>>>>>>>            //AB-StoreEnd
46450>>>>>>>>>>>>>
46450>>>>>>>>>>>>>        End_Object    // oSearch_bn
46451>>>>>>>>>>>>>
46451>>>>>>>>>>>>>
46451>>>>>>>>>>>>>        //AB-StoreStart
46451>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46452>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46453>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46454>>>>>>>>>>>>>        //AB-StoreEnd
46454>>>>>>>>>>>>>
46454>>>>>>>>>>>>>    End_Object    // sl029a
46455>>>>>>>>>>>>>
46455>>>>>>>>>>>>>//AB/     End_Object    // prj
46455>>>>>>>>>>>
46455>>>>>>>>>>>//DDB-Selection-pkg-End
46455>>>>>>>>>>>//DDB-FileEnd
46455>>>>>>>>>    Use PTYPPAR.DD
INCLUDING FILE: PTYPPAR.DD
46455>>>>>>>>>>>//DDB-FileStart
46455>>>>>>>>>>>//DDB-HeaderStart
46455>>>>>>>>>>>
46455>>>>>>>>>>>// File Name : PTYPPAR.DD
46455>>>>>>>>>>>// Class Name: Ptyppar_DataDictionary
46455>>>>>>>>>>>// Revision  : 88
46455>>>>>>>>>>>// Version   : 2
46455>>>>>>>>>>>
46455>>>>>>>>>>>Use  Windows           // Basic Definitions
46455>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46455>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46455>>>>>>>>>>>
46455>>>>>>>>>>>Open Ptyppar
46457>>>>>>>>>>>Open Particle
46459>>>>>>>>>>>Open Pseira
INCLUDING FILE: PSEIRA.FD
46461>>>>>>>>>>>Open Ptypmet
INCLUDING FILE: PTYPMET.FD
46463>>>>>>>>>>>Open Ptypparh
INCLUDING FILE: PTYPPARH.FD
46465>>>>>>>>>>>Open Ctypkin
46467>>>>>>>>>>>Open Wtypkin
46469>>>>>>>>>>>Open Sysrecp
INCLUDING FILE: SYSRECP.FD
46471>>>>>>>>>>>Open Syscurxr
46473>>>>>>>>>>>
46473>>>>>>>>>>>//DDB-HeaderEnd
46473>>>>>>>>>>>//DDB-ValidationStart
46473>>>>>>>>>>>
46473>>>>>>>>>>>Register_Object Ptyppar_Year_Recr_VT
46473>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Is_What_VT
46473>>>>>>>>>>>Register_Object Ptyppar_Ptyppar_Module_VT
46473>>>>>>>>>>>Register_Object Ptyppar_Ti_Typonei_Pms_VT1
46473>>>>>>>>>>>
46473>>>>>>>>>>>Object Ptyppar_Year_Recr_VT  is a DescriptionValidationTable
46475>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46476>>>>>>>>>>>
46476>>>>>>>>>>>    Procedure Fill_List
46478>>>>>>>>>>>        Forward Send Fill_List
46480>>>>>>>>>>>        Send Add_Table_Value  ""  "ƒœ¤ ‘¬££œ«â®œ "
46481>>>>>>>>>>>        Send Add_Table_Value  "1"  "¨¦©Ÿœ« ¡á"
46482>>>>>>>>>>>        Send Add_Table_Value  "2"  "€­˜ ¨œ« ¡á"
46483>>>>>>>>>>>    End_Procedure    // Fill_List
46484>>>>>>>>>>>    //DDB-ValidationCustomStart
46484>>>>>>>>>>>    //DDB-ValidationCustomEnd
46484>>>>>>>>>>>End_Object   // Ptyppar_Year_Recr_VT
46485>>>>>>>>>>>
46485>>>>>>>>>>>Object Ptyppar_Ptyppar_Is_What_VT  is a DescriptionValidationTable
46487>>>>>>>>>>>
46487>>>>>>>>>>>    Procedure Fill_List
46489>>>>>>>>>>>        Forward Send Fill_List
46491>>>>>>>>>>>        Send Add_Table_Value  "1"  "€š¦¨á"
46492>>>>>>>>>>>        Send Add_Table_Value  "2"  "é¢ž©ž"
46493>>>>>>>>>>>        Send Add_Table_Value  "3"  "€ŠŠŽ"
46494>>>>>>>>>>>    End_Procedure    // Fill_List
46495>>>>>>>>>>>    //DDB-ValidationCustomStart
46495>>>>>>>>>>>    //DDB-ValidationCustomEnd
46495>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Is_What_VT
46496>>>>>>>>>>>
46496>>>>>>>>>>>Object Ptyppar_Ptyppar_Module_VT  is a CodeValidationTable
46498>>>>>>>>>>>    Set Type_Value        To "MODULE"
46499>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46500>>>>>>>>>>>    //DDB-ValidationCustomStart
46500>>>>>>>>>>>    //DDB-ValidationCustomEnd
46500>>>>>>>>>>>End_Object   // Ptyppar_Ptyppar_Module_VT
46501>>>>>>>>>>>
46501>>>>>>>>>>>Object Ptyppar_Ti_Typonei_Pms_VT1  is a DescriptionValidationTable
46503>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46504>>>>>>>>>>>
46504>>>>>>>>>>>    Procedure Fill_List
46506>>>>>>>>>>>        Forward Send Fill_List
46508>>>>>>>>>>>        Send Add_Table_Value  ""  "¦©æ«ž«œª ¡˜  €¥åœª"
46509>>>>>>>>>>>        Send Add_Table_Value  "1"  "¦©æ«ž«œª"
46510>>>>>>>>>>>        Send Add_Table_Value  "2"  "€¥åœª"
46511>>>>>>>>>>>    End_Procedure    // Fill_List
46512>>>>>>>>>>>    //DDB-ValidationCustomStart
46512>>>>>>>>>>>    //DDB-ValidationCustomEnd
46512>>>>>>>>>>>End_Object   // Ptyppar_Ti_Typonei_Pms_VT1
46513>>>>>>>>>>>//DDB-ValidationEnd
46513>>>>>>>>>>>//DDB-SelectionStart
46513>>>>>>>>>>>//DDB/ ExternalSelectionList sl012  sl012.SL
46513>>>>>>>>>>>Register_Object sl012
46513>>>>>>>>>>>//DDB-SelectionEnd
46513>>>>>>>>>>>
46513>>>>>>>>>>>Class Ptyppar_DataDictionary  is a DataDictionary_Sec
46514>>>>>>>>>>>
46514>>>>>>>>>>>    Procedure Construct_Object
46515>>>>>>>>>>>        Forward Send Construct_Object
46517>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
46518>>>>>>>>>>>        Property Integer piOldCtypkin       Public 0
46519>>>>>>>>>>>        Property Integer piOldWtypkin       Public 0
46520>>>>>>>>>>>    End_Procedure
46521>>>>>>>>>>>
46521>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
46522>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
46524>>>>>>>>>>>        Set piOldCtypkin to Ctypkin.Ctypkin_Code
46525>>>>>>>>>>>        Set piOldWtypkin to Wtypkin.Wtypkin_Code
46526>>>>>>>>>>>    End_Procedure   // New_Current_Record
46527>>>>>>>>>>>
46527>>>>>>>>>>>    Procedure OnConstrain
46528>>>>>>>>>>>        If (piMustNotConstrain(Self)=0) Begin
46530>>>>>>>>>>>            Constrain Ptyppar.Company_Code  eq SysCurXR.Company_Code
46532>>>>>>>>>>>            Constrain Ptyppar.Branch_Code   eq SysCurXR.Branch_Code
46534>>>>>>>>>>>        End
46534>>>>>>>>>>>>
46534>>>>>>>>>>>    End_Procedure
46535>>>>>>>>>>>
46535>>>>>>>>>>>    Procedure Clear_Main_File
46536>>>>>>>>>>>        Forward Send Clear_Main_File
46538>>>>>>>>>>>        Set piOldCtypkin to 0
46539>>>>>>>>>>>        Set piOldWtypkin to 0
46540>>>>>>>>>>>    End_Procedure
46541>>>>>>>>>>>
46541>>>>>>>>>>>    Procedure Save_Main_File
46542>>>>>>>>>>>        Integer isAdmin iYes
46543>>>>>>>>>>>        String  sStr
46543>>>>>>>>>>>        Get fig_Is_Admin to isAdmin
46544>>>>>>>>>>>
46544>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46546>>>>>>>>>>>            If Ptyppar.Recnum Eq 0 Procedure_Return
46549>>>>>>>>>>>        End
46549>>>>>>>>>>>>
46549>>>>>>>>>>>
46549>>>>>>>>>>>        If (Operation_Origin=Self) Begin
46551>>>>>>>>>>>            If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code)) Begin
46553>>>>>>>>>>>                If (Not(isAdmin)) Error 1001 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª §œ¢á«ž'
46556>>>>>>>>>>>                Else Begin
46557>>>>>>>>>>>                    Move '' to sStr
46558>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
46559>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
46560>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
46563>>>>>>>>>>>                End
46563>>>>>>>>>>>>
46563>>>>>>>>>>>            End // If ((piOldCtypkin(Self)<>0) And (piOldCtypkin(Self)<>Ctypkin.Ctypkin_Code))
46563>>>>>>>>>>>>
46563>>>>>>>>>>>            If ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code)) Begin
46565>>>>>>>>>>>                If (Not(isAdmin)) Error 1002 'ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã ¡å¤ž©žª ˜§¦Ÿã¡žª'
46568>>>>>>>>>>>                Else Begin
46569>>>>>>>>>>>                    Move '' to sStr
46570>>>>>>>>>>>                    Append sStr '€¤ ˜¢¢á¥œ«œ ¡å¤ž©ž, £§¦¨œå ¤˜ œ§ž¨œá©œ  ã›ž ¡˜«˜®à¨ž£â¤˜ §˜¨˜©«˜« ¡á\n «˜ ¦§¦å˜ â®¦¬¤ ­« ˜®«œå £œ « ª §˜¢ âª ¡ ¤ã©œ ª §¦¬ «é¨˜ ˜¢¢áœ«œ\n„å©«œ ™â™˜ ¦  §àª Ÿâ¢œ«œ ¤˜ ©¬¤œ®å©à ?'
46571>>>>>>>>>>>                    Get YesNo_Box sStr to iYes
46572>>>>>>>>>>>                    If (iYes=MBR_NO) Error 1000 '€¡¬¨éŸž¡œ ž › ˜› ¡˜©å˜ ˜¢¢˜šãª ˜§¦ «¦¤ ®¨ã©«ž'
46575>>>>>>>>>>>                End
46575>>>>>>>>>>>>
46575>>>>>>>>>>>            End // ((piOldWtypkin(Self)<>0) And (piOldWtypkin(Self)<>Wtypkin.Wtypkin_Code))
46575>>>>>>>>>>>>
46575>>>>>>>>>>>        End // If (Operation_Origin=Self)
46575>>>>>>>>>>>>
46575>>>>>>>>>>>        Forward Send Save_Main_File
46577>>>>>>>>>>>    End_Procedure // Save_Main_File
46578>>>>>>>>>>>
46578>>>>>>>>>>>
46578>>>>>>>>>>>    Procedure Update
46579>>>>>>>>>>>        Forward Send Update
46581>>>>>>>>>>>        // Insert Code Here
46581>>>>>>>>>>>//        If (piMustNotConstrain(Self)=0) Begin
46581>>>>>>>>>>>            Move SysCurXR.Company_Code  to Ptyppar.Company_Code
46582>>>>>>>>>>>            Move SysCurXR.Branch_Code   to Ptyppar.Branch_Code
46583>>>>>>>>>>>//        end
46583>>>>>>>>>>>//        Move SysCurXR.Year_Year     to Ptyppar.Year_Year
46583>>>>>>>>>>>//        Move SysCurXR.Year_Recr     to Ptyppar.Year_Recr
46583>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Ptyppar.Ctypkin_Code
46584>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Ptyppar.Wtypkin_Code
46585>>>>>>>>>>>        if (ptyppar.sysxet_ptyppar='');            move '' to ptyppar.sysx_ptyp_recr
46588>>>>>>>>>>>    End_Procedure   // Update
46589>>>>>>>>>>>
46589>>>>>>>>>>>    Procedure Creating
46590>>>>>>>>>>>        Forward Send Creating
46592>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Ptyppar.Ptyppar_Rec0)))))) to Ptyppar.Ptyppar_Recr
46593>>>>>>>>>>>    End_Procedure   // Creating
46594>>>>>>>>>>>
46594>>>>>>>>>>>
46594>>>>>>>>>>>    // Define_Fields:
46594>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46594>>>>>>>>>>>    Procedure Define_Fields
46595>>>>>>>>>>>        Forward Send Define_Fields
46597>>>>>>>>>>>        //DDB-Generated-Code-Location
46597>>>>>>>>>>>        //DDB-DefineFieldStart
46597>>>>>>>>>>>
46597>>>>>>>>>>>        Set Main_File            To Ptyppar.File_Number
46598>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46599>>>>>>>>>>>
46599>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
46600>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
46601>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46602>>>>>>>>>>>
46602>>>>>>>>>>>        // Child (Client) file structure................
46602>>>>>>>>>>>        Send Add_Client_File  Particle.File_Number
46603>>>>>>>>>>>        Send Add_Client_File  Pseira.File_Number
46604>>>>>>>>>>>        Send Add_Client_File  Ptypmet.File_Number
46605>>>>>>>>>>>        Send Add_Client_File  Ptypparh.File_Number
46606>>>>>>>>>>>
46606>>>>>>>>>>>        // Parent (Server) file structure...............
46606>>>>>>>>>>>        Send Add_Server_File  Ctypkin.File_Number
46607>>>>>>>>>>>        Send Add_Server_File  Wtypkin.File_Number
46608>>>>>>>>>>>
46608>>>>>>>>>>>        // External (System) file structure.............
46608>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
46609>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46610>>>>>>>>>>>
46610>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Ptyppar_Rec0  To Ptyppar.Ptyppar_Rec0
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Field-based properties.......................
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Ptyppar.Company_Code
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Ptyppar.Branch_Code
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Ptyppar.Year_Year
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Ptyppar.Ctypkin_Code
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Ptyppar.Wtypkin_Code
46613>>>>>>>>>>>
46613>>>>>>>>>>>        // Ptyppar.Year_Recr
46613>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Year_Recr To (Ptyppar_Year_Recr_VT(Self))
46614>>>>>>>>>>>
46614>>>>>>>>>>>        // Ptyppar.Ctypkin_Recr
46614>>>>>>>>>>>
46614>>>>>>>>>>>        // Ptyppar.Wtypkin_Recr
46614>>>>>>>>>>>
46614>>>>>>>>>>>        // Ptyppar.Ptyppar_Code
46614>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Code To DD_AUTOFIND
46615>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Code To (sl012(Self))
46616>>>>>>>>>>>        Set Key_Field_State        Field Ptyppar.Ptyppar_Code To TRUE
46617>>>>>>>>>>>
46617>>>>>>>>>>>        // Ptyppar.Ptyppar_Rec0
46617>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Rec0 To DD_AUTOFIND
46618>>>>>>>>>>>
46618>>>>>>>>>>>        // Ptyppar.Ptyppar_Descr
46618>>>>>>>>>>>        Set Field_Prompt_Object    Field Ptyppar.Ptyppar_Descr To (sl012(Self))
46619>>>>>>>>>>>
46619>>>>>>>>>>>        // Ptyppar.Ptyppar_Recr
46619>>>>>>>>>>>        Set Field_Options          Field Ptyppar.Ptyppar_Recr To DD_AUTOFIND
46620>>>>>>>>>>>
46620>>>>>>>>>>>        // Ptyppar.Ptyppar_Is_What
46620>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Is_What To (Ptyppar_Ptyppar_Is_What_VT(Self))
46621>>>>>>>>>>>
46621>>>>>>>>>>>        // Ptyppar.Ptyppar_Module
46621>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ptyppar_Module To (Ptyppar_Ptyppar_Module_VT(Self))
46622>>>>>>>>>>>
46622>>>>>>>>>>>        // Ptyppar.Ptyppar_Abrev
46622>>>>>>>>>>>
46622>>>>>>>>>>>        // Ptyppar.Ftiaxnei_Tpay
46622>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Ftiaxnei_Tpay To "dbCheckBoxsub"
46623>>>>>>>>>>>
46623>>>>>>>>>>>        // Ptyppar.Ti_Typonei_Pms
46623>>>>>>>>>>>        Set Field_Value_Table      Field Ptyppar.Ti_Typonei_Pms To (Ptyppar_Ti_Typonei_Pms_VT1(Self))
46624>>>>>>>>>>>
46624>>>>>>>>>>>        // Ptyppar.Einai_Paroxh_Yp
46624>>>>>>>>>>>        Set Field_Checkbox_Values  Field Ptyppar.Einai_Paroxh_Yp To "1"  "0"
46625>>>>>>>>>>>        Set Field_Class_Name       Field Ptyppar.Einai_Paroxh_Yp To "dbCheckBoxsub"
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Gtypkin_Code
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Sysxet_Ptyppar
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Sysx_Ptyp_Recr
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Check_Posa_Plaf
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Singular
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Sub
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Constrain
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Label
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Label1
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Sap
46626>>>>>>>>>>>
46626>>>>>>>>>>>        // Ptyppar.Is_Xondr
46626>>>>>>>>>>>
46626>>>>>>>>>>>        //DDB-DefineFieldEnd
46626>>>>>>>>>>>    End_Procedure    // Define_Fields
46627>>>>>>>>>>>
46627>>>>>>>>>>>    // Field_Defaults:
46627>>>>>>>>>>>    // This procedure is used to establish default field values.
46627>>>>>>>>>>>
46627>>>>>>>>>>>    Procedure Field_Defaults
46628>>>>>>>>>>>        Forward Send Field_Defaults
46630>>>>>>>>>>>        //DDB-Generated-Code-Location
46630>>>>>>>>>>>        //DDB-FieldDefaultStart
46630>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Ftiaxnei_Tpay To "1"
46631>>>>>>>>>>>        Set Field_Changed_Value   Field Ptyppar.Einai_Paroxh_Yp To 0
46632>>>>>>>>>>>        //DDB-FieldDefaultEnd
46632>>>>>>>>>>>    End_Procedure    // Field_Defaults
46633>>>>>>>>>>>
46633>>>>>>>>>>>End_Class    // Ptyppar_DataDictionary
46634>>>>>>>>>>>//DDB-Selection-pkg-Start
46634>>>>>>>>>>>
46634>>>>>>>>>>>Use sl012.SL         // sl012
INCLUDING FILE: SL012.SL
46634>>>>>>>>>>>>>//AB/ Project sl012 : Ptyppar
46634>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
46634>>>>>>>>>>>>>//AB/     Set ProjectName to "sl012 : Ptyppar"
46634>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl012.SL"
46634>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>// Project Object Structure
46634>>>>>>>>>>>>>//   sl012 is a dbModalPanelSub
46634>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
46634>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46634>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
46634>>>>>>>>>>>>>//     oSelList is a dbListSub
46634>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46634>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46634>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>// Register all objects
46634>>>>>>>>>>>>>Register_Object Ctypkin_DD
46634>>>>>>>>>>>>>Register_Object oCancel_bn
46634>>>>>>>>>>>>>Register_Object oOK_bn
46634>>>>>>>>>>>>>Register_Object oSearch_bn
46634>>>>>>>>>>>>>Register_Object oSelList
46634>>>>>>>>>>>>>Register_Object Ptyppar_DD
46634>>>>>>>>>>>>>Register_Object sl012
46634>>>>>>>>>>>>>Register_Object Wtypkin_DD
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>//AB-IgnoreStart
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>Use DFAllEnt.pkg
46634>>>>>>>>>>>>>Use dbList.Sub
46634>>>>>>>>>>>>>Use Button.Sub
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>Use CTYPKIN.DD
46634>>>>>>>>>>>>>Use WTYPKIN.DD
46634>>>>>>>>>>>>>Use PTYPPAR.DD
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>//AB-IgnoreEnd
46634>>>>>>>>>>>>>
46634>>>>>>>>>>>>>Object sl012 is a dbModalPanelSub
46636>>>>>>>>>>>>>
46636>>>>>>>>>>>>>    //AB-StoreTopStart
46636>>>>>>>>>>>>>    Property String psModule Public ''
46638>>>>>>>>>>>>>    Property integer pifromclient Public 0
46640>>>>>>>>>>>>>    
46640>>>>>>>>>>>>>    //AB-StoreTopEnd
46640>>>>>>>>>>>>>
46640>>>>>>>>>>>>>    Set Label to "’ç§¦  §˜¨˜©«˜« ¡é¤"
46641>>>>>>>>>>>>>    Set Size to 203 490
46642>>>>>>>>>>>>>    Set Location to 4 4
46643>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
46644>>>>>>>>>>>>>    Set Modal_State to FALSE
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>    //AB-DDOStart
46645>>>>>>>>>>>>>
46645>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
46647>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
46648>>>>>>>>>>>>>
46648>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
46650>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
46651>>>>>>>>>>>>>
46651>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
46653>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
46654>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
46655>>>>>>>>>>>>>
46655>>>>>>>>>>>>>        //AB-StoreStart
46655>>>>>>>>>>>>>        
46655>>>>>>>>>>>>>        Procedure OnConstrain
46657>>>>>>>>>>>>>            Forward Send OnConstrain
46659>>>>>>>>>>>>>            If (psModule(Self)<>'') Begin
46661>>>>>>>>>>>>>                Constrain Ptyppar.Ptyppar_Module eq (psModule(Self))
46663>>>>>>>>>>>>>            End
46663>>>>>>>>>>>>>>
46663>>>>>>>>>>>>>            If (pifromclient(self)=1) Begin
46665>>>>>>>>>>>>>                Constrain Ptyppar.constrain eq '1'
46667>>>>>>>>>>>>>            End
46667>>>>>>>>>>>>>>
46667>>>>>>>>>>>>>        End_Procedure
46668>>>>>>>>>>>>>        
46668>>>>>>>>>>>>>        
46668>>>>>>>>>>>>>        
46668>>>>>>>>>>>>>        
46668>>>>>>>>>>>>>        //AB-StoreEnd
46668>>>>>>>>>>>>>
46668>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
46669>>>>>>>>>>>>>
46669>>>>>>>>>>>>>    Set Main_DD to (Ptyppar_DD(self))
46670>>>>>>>>>>>>>    Set Server to (Ptyppar_DD(self))
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>    //AB-DDOEnd
46671>>>>>>>>>>>>>
46671>>>>>>>>>>>>>    Object oSelList is a dbListSub
46673>>>>>>>>>>>>>        Set Main_File to Ptyppar.File_Number
46674>>>>>>>>>>>>>        Set Size to 161 474
46675>>>>>>>>>>>>>        Set Location to 6 6
46676>>>>>>>>>>>>>
46676>>>>>>>>>>>>>        Begin_Row
46679>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_code
46680>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
46681>>>>>>>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
46682>>>>>>>>>>>>>            Entry_Item Wtypkin.Wtypkin_descr
46683>>>>>>>>>>>>>        End_Row
46688>>>>>>>>>>>>>
46688>>>>>>>>>>>>>        Set Form_Width    item 0 to 77
46689>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›. ˜¨˜©«˜« ¡¦ç"
46690>>>>>>>>>>>>>        
46690>>>>>>>>>>>>>        Set Form_Width    item 1 to 125
46691>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
46692>>>>>>>>>>>>>        
46692>>>>>>>>>>>>>        Set Form_Width    item 2 to 137
46693>>>>>>>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
46694>>>>>>>>>>>>>        
46694>>>>>>>>>>>>>        Set Form_Width    item 3 to 129
46695>>>>>>>>>>>>>        Set Header_Label  item 3 to "‰å¤ž©ž €§¦Ÿã¡žª"
46696>>>>>>>>>>>>>        
46696>>>>>>>>>>>>>
46696>>>>>>>>>>>>>        //AB-StoreStart
46696>>>>>>>>>>>>>        
46696>>>>>>>>>>>>>        Procedure Activate
46698>>>>>>>>>>>>>            Forward Send Activate
46700>>>>>>>>>>>>>            Send Rebuild_Constraints to Ptyppar_DD
46701>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
46702>>>>>>>>>>>>>        End_Procedure
46703>>>>>>>>>>>>>        
46703>>>>>>>>>>>>>        //AB-StoreEnd
46703>>>>>>>>>>>>>
46703>>>>>>>>>>>>>    End_Object    // oSelList
46704>>>>>>>>>>>>>
46704>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
46706>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
46707>>>>>>>>>>>>>        Set Location to 171 323
46708>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46709>>>>>>>>>>>>>
46709>>>>>>>>>>>>>        //AB-StoreStart
46709>>>>>>>>>>>>>        Procedure OnClick
46711>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
46712>>>>>>>>>>>>>        End_Procedure
46713>>>>>>>>>>>>>        //AB-StoreEnd
46713>>>>>>>>>>>>>
46713>>>>>>>>>>>>>    End_Object    // oOK_bn
46714>>>>>>>>>>>>>
46714>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
46716>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
46717>>>>>>>>>>>>>        Set Location to 171 377
46718>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46719>>>>>>>>>>>>>
46719>>>>>>>>>>>>>        //AB-StoreStart
46719>>>>>>>>>>>>>        Procedure OnClick
46721>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
46722>>>>>>>>>>>>>        End_Procedure
46723>>>>>>>>>>>>>        //AB-StoreEnd
46723>>>>>>>>>>>>>
46723>>>>>>>>>>>>>    End_Object    // oCancel_bn
46724>>>>>>>>>>>>>
46724>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
46726>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
46727>>>>>>>>>>>>>        Set Location to 171 433
46728>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
46729>>>>>>>>>>>>>
46729>>>>>>>>>>>>>        //AB-StoreStart
46729>>>>>>>>>>>>>        Procedure OnClick
46731>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
46732>>>>>>>>>>>>>        End_Procedure
46733>>>>>>>>>>>>>        //AB-StoreEnd
46733>>>>>>>>>>>>>
46733>>>>>>>>>>>>>    End_Object    // oSearch_bn
46734>>>>>>>>>>>>>
46734>>>>>>>>>>>>>
46734>>>>>>>>>>>>>    //AB-StoreStart
46734>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46735>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46736>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46737>>>>>>>>>>>>>    
46737>>>>>>>>>>>>>    
46737>>>>>>>>>>>>>    //AB-StoreEnd
46737>>>>>>>>>>>>>
46737>>>>>>>>>>>>>End_Object    // sl012
46738>>>>>>>>>>>>>
46738>>>>>>>>>>>>>//AB/ End_Object    // prj
46738>>>>>>>>>>>
46738>>>>>>>>>>>//DDB-Selection-pkg-End
46738>>>>>>>>>>>//DDB-FileEnd
46738>>>>>>>>>    Use PSEIRA.DD
INCLUDING FILE: PSEIRA.DD
46738>>>>>>>>>>>//DDB-FileStart
46738>>>>>>>>>>>//DDB-HeaderStart
46738>>>>>>>>>>>
46738>>>>>>>>>>>// File Name : PSEIRA.DD
46738>>>>>>>>>>>// Class Name: Pseira_DataDictionary
46738>>>>>>>>>>>// Revision  : 34
46738>>>>>>>>>>>// Version   : 2
46738>>>>>>>>>>>
46738>>>>>>>>>>>Use  Windows           // Basic Definitions
46738>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46738>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46738>>>>>>>>>>>
46738>>>>>>>>>>>Open Pseira
46740>>>>>>>>>>>Open Ptyppar
46742>>>>>>>>>>>Open Sysrecp
46744>>>>>>>>>>>Open Syscurxr
46746>>>>>>>>>>>
46746>>>>>>>>>>>//DDB-HeaderEnd
46746>>>>>>>>>>>//DDB-SelectionStart
46746>>>>>>>>>>>//DDB/ ExternalSelectionList sl013  sl013.SL
46746>>>>>>>>>>>Register_Object sl013
46746>>>>>>>>>>>//DDB-SelectionEnd
46746>>>>>>>>>>>
46746>>>>>>>>>>>Class Pseira_DataDictionary  is a DataDictionary
46747>>>>>>>>>>>
46747>>>>>>>>>>>    Procedure Save_Main_File
46748>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
46750>>>>>>>>>>>            If Pseira.Recnum Eq 0 Procedure_Return
46753>>>>>>>>>>>        End
46753>>>>>>>>>>>>
46753>>>>>>>>>>>        Forward Send Save_Main_File
46755>>>>>>>>>>>    End_Procedure
46756>>>>>>>>>>>
46756>>>>>>>>>>>    Procedure Update
46757>>>>>>>>>>>        Forward Send Update
46759>>>>>>>>>>>        // Insert Code Here
46759>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pseira.Company_Code
46760>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Pseira.Branch_Code
46761>>>>>>>>>>>        Move SysCurXR.Year_Year     to Pseira.Year_Year
46762>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
46763>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
46764>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
46765>>>>>>>>>>>    End_Procedure   // Update
46766>>>>>>>>>>>
46766>>>>>>>>>>>
46766>>>>>>>>>>>     Procedure Creating
46767>>>>>>>>>>>        Forward Send Creating
46769>>>>>>>>>>>        // Insert Code Here
46769>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pseira.Pseira_Rec0)))))) to Pseira.Pseira_Recr
46770>>>>>>>>>>>    End_Procedure   // Creating
46771>>>>>>>>>>>
46771>>>>>>>>>>>
46771>>>>>>>>>>>    // Define_Fields:
46771>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
46771>>>>>>>>>>>
46771>>>>>>>>>>>    Procedure Define_Fields
46772>>>>>>>>>>>        Forward Send Define_Fields
46774>>>>>>>>>>>        //DDB-Generated-Code-Location
46774>>>>>>>>>>>        //DDB-DefineFieldStart
46774>>>>>>>>>>>
46774>>>>>>>>>>>        Set Main_File            To Pseira.File_Number
46775>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
46776>>>>>>>>>>>
46776>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
46777>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
46778>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
46779>>>>>>>>>>>
46779>>>>>>>>>>>        // Parent (Server) file structure...............
46779>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
46780>>>>>>>>>>>
46780>>>>>>>>>>>        // External (System) file structure.............
46780>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
46781>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
46782>>>>>>>>>>>
46782>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pseira_Rec0  To Pseira.Pseira_Rec0
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Field-based properties.......................
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Company_Code
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Branch_Code
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Year_Year
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Ctypkin_Code
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Wtypkin_Code
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Ptyppar_Code
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Ptyppar_Recr
46785>>>>>>>>>>>
46785>>>>>>>>>>>        // Pseira.Pseira_Seira
46785>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Seira To DD_AUTOFIND   
46786>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Seira To (sl013(Self))
46787>>>>>>>>>>>
46787>>>>>>>>>>>        // Pseira.Pseira_Rec0
46787>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Rec0 To DD_AUTOFIND   
46788>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Rec0 To (sl013(Self))
46789>>>>>>>>>>>
46789>>>>>>>>>>>        // Pseira.Pseira_Recr
46789>>>>>>>>>>>        Set Field_Options          Field Pseira.Pseira_Recr To DD_AUTOFIND   
46790>>>>>>>>>>>        Set Field_Prompt_Object    Field Pseira.Pseira_Recr To (sl013(Self))
46791>>>>>>>>>>>
46791>>>>>>>>>>>        // Pseira.Pseira_Printer
46791>>>>>>>>>>>
46791>>>>>>>>>>>        // Pseira.Pseira_Form
46791>>>>>>>>>>>
46791>>>>>>>>>>>        // Pseira.Pseira_Autonum
46791>>>>>>>>>>>
46791>>>>>>>>>>>        // Pseira.Autonum_Plus
46791>>>>>>>>>>>
46791>>>>>>>>>>>        // Pseira.Autonum_Minus
46791>>>>>>>>>>>
46791>>>>>>>>>>>        // Pseira.Auto_Plus_Last
46791>>>>>>>>>>>
46791>>>>>>>>>>>        //DDB-DefineFieldEnd
46791>>>>>>>>>>>    End_Procedure    // Define_Fields
46792>>>>>>>>>>>
46792>>>>>>>>>>>    // Field_Defaults:
46792>>>>>>>>>>>    // This procedure is used to establish default field values.
46792>>>>>>>>>>>
46792>>>>>>>>>>>    Procedure Field_Defaults
46793>>>>>>>>>>>        Forward Send Field_Defaults
46795>>>>>>>>>>>        //DDB-Generated-Code-Location
46795>>>>>>>>>>>        //DDB-FieldDefaultStart
46795>>>>>>>>>>>        //DDB-FieldDefaultEnd
46795>>>>>>>>>>>    End_Procedure    // Field_Defaults
46796>>>>>>>>>>>
46796>>>>>>>>>>>End_Class    // Pseira_DataDictionary
46797>>>>>>>>>>>//DDB-Selection-pkg-Start
46797>>>>>>>>>>>
46797>>>>>>>>>>>Use sl013.SL         // sl013
INCLUDING FILE: SL013.SL
46797>>>>>>>>>>>>>//AB/ Project sl013:SeiraP
46797>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
46797>>>>>>>>>>>>>//AB/         Set ProjectName to "sl013:SeiraP"
46797>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl013.SL"
46797>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>// Project Object Structure
46797>>>>>>>>>>>>>//   sl013 is a dbModalPanelSub
46797>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
46797>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
46797>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
46797>>>>>>>>>>>>>//     Pseira_DD is a DataDictionary
46797>>>>>>>>>>>>>//     oSelList is a dbListSub
46797>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
46797>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
46797>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>// Register all objects
46797>>>>>>>>>>>>>Register_Object Ctypkin_DD
46797>>>>>>>>>>>>>Register_Object oCancel_bn
46797>>>>>>>>>>>>>Register_Object oOK_bn
46797>>>>>>>>>>>>>Register_Object oSearch_bn
46797>>>>>>>>>>>>>Register_Object oSelList
46797>>>>>>>>>>>>>Register_Object Pseira_DD
46797>>>>>>>>>>>>>Register_Object Ptyppar_DD
46797>>>>>>>>>>>>>Register_Object sl013
46797>>>>>>>>>>>>>Register_Object Wtypkin_DD
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>    //AB-IgnoreStart
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>    Use DFAllEnt.pkg
46797>>>>>>>>>>>>>    Use dbList.Sub
46797>>>>>>>>>>>>>    Use Button.Sub
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>    Use CTYPKIN.DD
46797>>>>>>>>>>>>>    Use WTYPKIN.DD
46797>>>>>>>>>>>>>    Use PTYPPAR.DD
46797>>>>>>>>>>>>>    Use PSEIRA.DD
46797>>>>>>>>>>>>>    
46797>>>>>>>>>>>>>    //AB-IgnoreEnd
46797>>>>>>>>>>>>>
46797>>>>>>>>>>>>>    Object sl013 is a dbModalPanelSub
46799>>>>>>>>>>>>>
46799>>>>>>>>>>>>>        //AB-StoreTopStart
46799>>>>>>>>>>>>>        Property String FragmaPtyppar_Recr Public ''
46801>>>>>>>>>>>>>        
46801>>>>>>>>>>>>>        //AB-StoreTopEnd
46801>>>>>>>>>>>>>
46801>>>>>>>>>>>>>        Set Label to "‰˜«á¢¦š¦ª ‘œ ¨é¤"
46802>>>>>>>>>>>>>        Set Size to 148 214
46803>>>>>>>>>>>>>        Set Location to 1 7
46804>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
46805>>>>>>>>>>>>>        Set Modal_State to FALSE
46806>>>>>>>>>>>>>
46806>>>>>>>>>>>>>        //AB-DDOStart
46806>>>>>>>>>>>>>
46806>>>>>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
46808>>>>>>>>>>>>>        End_Object    // Ctypkin_DD
46809>>>>>>>>>>>>>
46809>>>>>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
46811>>>>>>>>>>>>>        End_Object    // Wtypkin_DD
46812>>>>>>>>>>>>>
46812>>>>>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
46814>>>>>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
46815>>>>>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
46816>>>>>>>>>>>>>        End_Object    // Ptyppar_DD
46817>>>>>>>>>>>>>
46817>>>>>>>>>>>>>        Object Pseira_DD is a Pseira_DataDictionary
46819>>>>>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
46820>>>>>>>>>>>>>
46820>>>>>>>>>>>>>            //AB-StoreStart
46820>>>>>>>>>>>>>            Procedure OnConstrain
46822>>>>>>>>>>>>>                String sID
46823>>>>>>>>>>>>>                Forward Send OnConstrain
46825>>>>>>>>>>>>>                Get FragmaPtyppar_Recr to sID
46826>>>>>>>>>>>>>                Move (trim(sID)) to sID
46827>>>>>>>>>>>>>                If (sID<>'') Constrain Pseira.Ptyppar_Recr eq sID
46831>>>>>>>>>>>>>            End_procedure
46832>>>>>>>>>>>>>            
46832>>>>>>>>>>>>>            //AB-StoreEnd
46832>>>>>>>>>>>>>
46832>>>>>>>>>>>>>        End_Object    // Pseira_DD
46833>>>>>>>>>>>>>
46833>>>>>>>>>>>>>        Set Main_DD to (Pseira_DD(self))
46834>>>>>>>>>>>>>        Set Server to (Pseira_DD(self))
46835>>>>>>>>>>>>>
46835>>>>>>>>>>>>>        //AB-DDOEnd
46835>>>>>>>>>>>>>
46835>>>>>>>>>>>>>        Object oSelList is a dbListSub
46837>>>>>>>>>>>>>            Set Main_File to Pseira.File_Number
46838>>>>>>>>>>>>>            Set Size to 105 197
46839>>>>>>>>>>>>>            Set Location to 6 6
46840>>>>>>>>>>>>>
46840>>>>>>>>>>>>>            Begin_Row
46843>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_seira
46844>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_printer
46845>>>>>>>>>>>>>                Entry_Item Pseira.Pseira_autonum
46846>>>>>>>>>>>>>            End_Row
46851>>>>>>>>>>>>>
46851>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
46852>>>>>>>>>>>>>            Set Header_Label  item 0 to "‘œ ¨á"
46853>>>>>>>>>>>>>            
46853>>>>>>>>>>>>>            Set Form_Width    item 1 to 135
46854>>>>>>>>>>>>>            Set Header_Label  item 1 to "„¡«¬§à«ãª"
46855>>>>>>>>>>>>>            
46855>>>>>>>>>>>>>            Set Form_Width    item 2 to 16
46856>>>>>>>>>>>>>            Set Header_Label  item 2 to "Autonum"
46857>>>>>>>>>>>>>            Set Column_Checkbox_State  item 2 to True
46858>>>>>>>>>>>>>            
46858>>>>>>>>>>>>>
46858>>>>>>>>>>>>>            //AB-StoreStart
46858>>>>>>>>>>>>>                    
46858>>>>>>>>>>>>>            Property String StoreFragmaPtyppar_Recr Public ''
46860>>>>>>>>>>>>>            
46860>>>>>>>>>>>>>            Procedure Store_Defaults
46862>>>>>>>>>>>>>                   Forward Send Store_Defaults
46864>>>>>>>>>>>>>                   Set StoreFragmaPtyppar_Recr to (FragmaPtyppar_Recr(Self))
46865>>>>>>>>>>>>>            End_Procedure
46866>>>>>>>>>>>>>            
46866>>>>>>>>>>>>>            Procedure ReStore_Defaults
46868>>>>>>>>>>>>>                   Forward Send ReStore_Defaults
46870>>>>>>>>>>>>>                   Set FragmaPtyppar_Recr to (StoreFragmaPtyppar_Recr(Self))
46871>>>>>>>>>>>>>            End_Procedure
46872>>>>>>>>>>>>>            
46872>>>>>>>>>>>>>            Procedure Activating
46874>>>>>>>>>>>>>                Forward Send Activating
46876>>>>>>>>>>>>>                Send Rebuild_Constraints to (Pseira_DD(Self))
46877>>>>>>>>>>>>>            End_Procedure
46878>>>>>>>>>>>>>            
46878>>>>>>>>>>>>>            
46878>>>>>>>>>>>>>            //AB-StoreEnd
46878>>>>>>>>>>>>>
46878>>>>>>>>>>>>>        End_Object    // oSelList
46879>>>>>>>>>>>>>
46879>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
46881>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
46882>>>>>>>>>>>>>            Set Location to 114 42
46883>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46884>>>>>>>>>>>>>
46884>>>>>>>>>>>>>            //AB-StoreStart
46884>>>>>>>>>>>>>            Procedure OnClick
46886>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
46887>>>>>>>>>>>>>            End_Procedure
46888>>>>>>>>>>>>>            //AB-StoreEnd
46888>>>>>>>>>>>>>
46888>>>>>>>>>>>>>        End_Object    // oOK_bn
46889>>>>>>>>>>>>>
46889>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
46891>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
46892>>>>>>>>>>>>>            Set Location to 114 98
46893>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46894>>>>>>>>>>>>>
46894>>>>>>>>>>>>>            //AB-StoreStart
46894>>>>>>>>>>>>>            Procedure OnClick
46896>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
46897>>>>>>>>>>>>>            End_Procedure
46898>>>>>>>>>>>>>            //AB-StoreEnd
46898>>>>>>>>>>>>>
46898>>>>>>>>>>>>>        End_Object    // oCancel_bn
46899>>>>>>>>>>>>>
46899>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
46901>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
46902>>>>>>>>>>>>>            Set Location to 114 153
46903>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
46904>>>>>>>>>>>>>
46904>>>>>>>>>>>>>            //AB-StoreStart
46904>>>>>>>>>>>>>            Procedure OnClick
46906>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
46907>>>>>>>>>>>>>            End_Procedure
46908>>>>>>>>>>>>>            //AB-StoreEnd
46908>>>>>>>>>>>>>
46908>>>>>>>>>>>>>        End_Object    // oSearch_bn
46909>>>>>>>>>>>>>
46909>>>>>>>>>>>>>
46909>>>>>>>>>>>>>        //AB-StoreStart
46909>>>>>>>>>>>>>            
46909>>>>>>>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
46910>>>>>>>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
46911>>>>>>>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        
46912>>>>>>>>>>>>>        //AB-StoreEnd
46912>>>>>>>>>>>>>
46912>>>>>>>>>>>>>    End_Object    // sl013
46913>>>>>>>>>>>>>
46913>>>>>>>>>>>>>//AB/     End_Object    // prj
46913>>>>>>>>>>>
46913>>>>>>>>>>>//DDB-Selection-pkg-End
46913>>>>>>>>>>>//DDB-FileEnd
46913>>>>>>>>>    Use NOMISMA.DD
46913>>>>>>>>>    Use COUNTRY.DD
46913>>>>>>>>>    Use TOWNS.DD
46913>>>>>>>>>    Use CITIES.DD
46913>>>>>>>>>    Use PAYRESP.DD
46913>>>>>>>>>    Use AREAS.DD
46913>>>>>>>>>    Use CLIENTS.DD
46913>>>>>>>>>    Use PARTICLE.DD
INCLUDING FILE: PARTICLE.DD
46913>>>>>>>>>>>//DDB-FileStart
46913>>>>>>>>>>>//DDB-HeaderStart
46913>>>>>>>>>>>
46913>>>>>>>>>>>// File Name : PARTICLE.DD
46913>>>>>>>>>>>// Class Name: Particle_DataDictionary
46913>>>>>>>>>>>// Revision  : 262
46913>>>>>>>>>>>// Version   : 2
46913>>>>>>>>>>>
46913>>>>>>>>>>>Use  Windows           // Basic Definitions
46913>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
46913>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
46913>>>>>>>>>>>
46913>>>>>>>>>>>Open Particle
46915>>>>>>>>>>>Open Pmoves
46917>>>>>>>>>>>Open Tparticl
46919>>>>>>>>>>>Open Partlfpa
INCLUDING FILE: PARTLFPA.FD
46921>>>>>>>>>>>Open Pmovesl
INCLUDING FILE: PMOVESL.FD
46923>>>>>>>>>>>Open Psxetika
46925>>>>>>>>>>>Open Clients
46927>>>>>>>>>>>Open Ptyppar
46929>>>>>>>>>>>Open Nomisma
46931>>>>>>>>>>>Open Sysrecp
46933>>>>>>>>>>>Open Syscurxr
46935>>>>>>>>>>>Open Pseira
46937>>>>>>>>>>>Open Cn
46939>>>>>>>>>>>Open Partlfpa
46941>>>>>>>>>>>Open Clorder
46943>>>>>>>>>>>Open Clorderd
INCLUDING FILE: CLORDERD.FD
46945>>>>>>>>>>>Open Ypoprosf
INCLUDING FILE: YPOPROSF.FD
46947>>>>>>>>>>>Open Psxetika
46949>>>>>>>>>>>Open Pmoves
46951>>>>>>>>>>>Open Gmove
46953>>>>>>>>>>>Open Sysrecg
46955>>>>>>>>>>>
46955>>>>>>>>>>>//DDB-HeaderEnd
46955>>>>>>>>>>>//DDB-ValidationStart
46955>>>>>>>>>>>
46955>>>>>>>>>>>Register_Object Particle_Tropos_Diakin_VT
46955>>>>>>>>>>>Register_Object Particle_Skopos_Diakin_VT
46955>>>>>>>>>>>Register_Object Particle_Tropos_Plhromhs_VT
46955>>>>>>>>>>>
46955>>>>>>>>>>>Object Particle_Tropos_Diakin_VT  is a CodeValidationTable
46957>>>>>>>>>>>    Set Type_Value        To "SEND_TERMS"
46958>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46959>>>>>>>>>>>    //DDB-ValidationCustomStart
46959>>>>>>>>>>>    //DDB-ValidationCustomEnd
46959>>>>>>>>>>>End_Object   // Particle_Tropos_Diakin_VT
46960>>>>>>>>>>>
46960>>>>>>>>>>>Object Particle_Skopos_Diakin_VT  is a CodeValidationTable
46962>>>>>>>>>>>    Set Type_Value        To "SKOPOS"
46963>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46964>>>>>>>>>>>    //DDB-ValidationCustomStart
46964>>>>>>>>>>>    //DDB-ValidationCustomEnd
46964>>>>>>>>>>>End_Object   // Particle_Skopos_Diakin_VT
46965>>>>>>>>>>>
46965>>>>>>>>>>>Object Particle_Tropos_Plhromhs_VT  is a CodeValidationTable
46967>>>>>>>>>>>    Set Type_Value        To "PAY_TERMS"
46968>>>>>>>>>>>    Set Validate_State    To FALSE
46969>>>>>>>>>>>    Set Allow_Blank_State To TRUE
46970>>>>>>>>>>>    //DDB-ValidationCustomStart
46970>>>>>>>>>>>    //DDB-ValidationCustomEnd
46970>>>>>>>>>>>End_Object   // Particle_Tropos_Plhromhs_VT
46971>>>>>>>>>>>//DDB-ValidationEnd
46971>>>>>>>>>>>//DDB-SelectionStart
46971>>>>>>>>>>>//DDB/ ExternalSelectionList sl041  sl041.SL
46971>>>>>>>>>>>//DDB/ ExternalSelectionList sl014  sl014.SL
46971>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
46971>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
46971>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
46971>>>>>>>>>>>Register_Object sl041
46971>>>>>>>>>>>Register_Object sl014
46971>>>>>>>>>>>Register_Object sl054
46971>>>>>>>>>>>Register_Object sl053
46971>>>>>>>>>>>Register_Object sl064
46971>>>>>>>>>>>//DDB-SelectionEnd
46971>>>>>>>>>>>
46971>>>>>>>>>>>//Object oValidateSeira is a FileValidationTable
46971>>>>>>>>>>>//    Set Table_Title         to "„§ ¢¦šã ‘œ ¨áª ˜¨˜©«˜« ¡¦ç"
46971>>>>>>>>>>>//    Set Main_File           to Pseira.File_Number
46971>>>>>>>>>>>//    Set Code_Field          to  8 //Pseira.Pseira_Seira
46971>>>>>>>>>>>//    Set Description_Field   to 11 //Pseira.Pseira_Printer
46971>>>>>>>>>>>//    Set Ordering            to  1
46971>>>>>>>>>>>//    Set Static_State to False
46971>>>>>>>>>>>//End_Object
46971>>>>>>>>>>>
46971>>>>>>>>>>>Open Cars
INCLUDING FILE: CARS.FD
46973>>>>>>>>>>>Open Drivers
INCLUDING FILE: DRIVERS.FD
46975>>>>>>>>>>>Open Pumps
INCLUDING FILE: PUMPS.FD
46977>>>>>>>>>>>Open SysCurXr
46979>>>>>>>>>>>
46979>>>>>>>>>>>Class Particle_DataDictionary  is a DataDictionary_Sec
46980>>>>>>>>>>>
46980>>>>>>>>>>>    Function fsVresCNDescr String asCNCode Returns String
46981>>>>>>>>>>>        String rVal
46982>>>>>>>>>>>        Clear CN
46983>>>>>>>>>>>        Move asCNCode            to Cn.Cn_Code
46984>>>>>>>>>>>        Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
46985>>>>>>>>>>>>
46985>>>>>>>>>>>        If (Found) Move (Trim(CN.CN_Descr)) to rVal
46988>>>>>>>>>>>        Else Move '' to rVal
46990>>>>>>>>>>>        Function_Return rVal
46991>>>>>>>>>>>    End_Function
46992>>>>>>>>>>>
46992>>>>>>>>>>>    Function fsVresAntliaDescr String asOxhmaCode Returns String
46993>>>>>>>>>>>        String rVal
46994>>>>>>>>>>>        Clear Pumps
46995>>>>>>>>>>>        Move SysCurXr.Company_Code  to Pumps.Pump_Company
46996>>>>>>>>>>>        Move asOxhmaCode            to Pumps.Pump_ID
46997>>>>>>>>>>>        Find Eq Pumps By Index.1 // Pump_Company + Pump_ID
46998>>>>>>>>>>>>
46998>>>>>>>>>>>        If (Found) Move (Trim(Pumps.Pump_Descr)) to rVal
47001>>>>>>>>>>>        Else Move '' to rVal
47003>>>>>>>>>>>        Function_Return rVal
47004>>>>>>>>>>>    End_Function
47005>>>>>>>>>>>
47005>>>>>>>>>>>    Function fsVresOxhmaDescr String asOxhmaCode Returns String
47006>>>>>>>>>>>        String rVal
47007>>>>>>>>>>>        Clear Cars
47008>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
47009>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
47010>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
47011>>>>>>>>>>>>
47011>>>>>>>>>>>
47011>>>>>>>>>>>        If (Found) Move (Trim(Cars.Car_License)) to rVal
47014>>>>>>>>>>>        Else Move '' to rVal
47016>>>>>>>>>>>        Function_Return rVal
47017>>>>>>>>>>>    End_Function
47018>>>>>>>>>>>
47018>>>>>>>>>>>    Function fsVresDriverCode String asOxhmaCode Returns String
47019>>>>>>>>>>>        String rVal
47020>>>>>>>>>>>        Clear Cars
47021>>>>>>>>>>>        Move SysCurXr.Company_Code  to Cars.Car_Company
47022>>>>>>>>>>>        Move asOxhmaCode            to Cars.Car_ID
47023>>>>>>>>>>>        Find Eq Cars By Index.1 // Car_Company + Car_ID
47024>>>>>>>>>>>>
47024>>>>>>>>>>>        If (Found)  Move (Trim(Cars.Car_DriverID)) to rVal
47027>>>>>>>>>>>        Else        Move '' to rVal
47029>>>>>>>>>>>        Function_Return rVal
47030>>>>>>>>>>>    End_Function
47031>>>>>>>>>>>
47031>>>>>>>>>>>    Function fsVresDriverDescr String asDriverCode Returns String
47032>>>>>>>>>>>        String rVal
47033>>>>>>>>>>>        Clear Drivers
47034>>>>>>>>>>>        Move SysCurXr.Company_Code  to Drivers.Driver_Company
47035>>>>>>>>>>>        Move asDriverCode           to Drivers.Driver_ID
47036>>>>>>>>>>>        Find Eq Drivers By Index.1 // Driver_Company + Driver_ID
47037>>>>>>>>>>>>
47037>>>>>>>>>>>        If (Found) Move (Trim(Drivers.Driver_Name)) to rVal
47040>>>>>>>>>>>        Else Move '' to rVal
47042>>>>>>>>>>>        Function_Return rVal
47043>>>>>>>>>>>    End_Function
47044>>>>>>>>>>>
47044>>>>>>>>>>>    Procedure Construct_Object
47045>>>>>>>>>>>        Forward Send Construct_Object
47047>>>>>>>>>>>        Property String     psOldCode       Public ''
47048>>>>>>>>>>>        Property Integer    piPmovesID      Public  0
47049>>>>>>>>>>>        Property String     psOldUserID     Public ''
47050>>>>>>>>>>>        Property Integer    piOldSelected   Public  0
47051>>>>>>>>>>>        Property Integer    piFromMetasx    Public  0 
47052>>>>>>>>>>>        Property Integer    PifromBhma1     Public  0 
47053>>>>>>>>>>>        //------------------------------------------------
47053>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47053>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
47053>>>>>>>>>>>        // einai 1     js 03/12/2007
47053>>>>>>>>>>>        //------------------------------------------------  
47053>>>>>>>>>>>        Property Integer piCreateNew            Public  0
47054>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
47055>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
47056>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
47057>>>>>>>>>>>        Property String  psAud_Old_ErgoDescr    Public ""
47058>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
47059>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
47060>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
47061>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
47062>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
47063>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
47064>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
47065>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
47066>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
47067>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0     
47068>>>>>>>>>>>        Property String  psAud_Old_Ektyposh     Public "" 
47069>>>>>>>>>>>        Property Integer piAud_Old_Timol        Public  0
47070>>>>>>>>>>>        Property Date    pdAud_Old_SapHmnia     Public ""
47071>>>>>>>>>>>        //------------------------------------------------
47071>>>>>>>>>>>    End_procedure
47072>>>>>>>>>>> 
47072>>>>>>>>>>> 
47072>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
47073>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
47075>>>>>>>>>>>        Set psOldCode       to Particle.Nomisma_Code
47076>>>>>>>>>>>        Set psOldUserID     to Particle.Partl_ToposF
47077>>>>>>>>>>>        Set piOldSelected   to Particle.Partl_Selected
47078>>>>>>>>>>>        //------------------------------------------------
47078>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
47078>>>>>>>>>>>        // ton pedion js 03/12/2007
47078>>>>>>>>>>>        //------------------------------------------------
47078>>>>>>>>>>>        Set psAud_Old_Pelaths       to Particle.Client_ID
47079>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
47080>>>>>>>>>>>        Set psAud_Old_Ergo          to Particle.CN_Code     
47081>>>>>>>>>>>        Set psAud_Old_ErgoDescr     to (fsVresCNDescr(Self,Particle.CN_Code))
47082>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Particle.Partl_Recr 
47083>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Particle.Partl_Recr 
47084>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
47085>>>>>>>>>>>        Set psAud_Old_Zonh          to Particle.Zone_ID
47086>>>>>>>>>>>        Set psAud_Old_Antlia        to Particle.Antlia_code
47087>>>>>>>>>>>        Set psAud_Old_Oxhma         to Particle.Oxhma_code
47088>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
47089>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
47090>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
47091>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No    
47092>>>>>>>>>>>        Set psAud_Old_Ektyposh      to Particle.Partl_Ektyposh 
47093>>>>>>>>>>>        Set piAud_Old_Timol         to Particle.Partl_Timol
47094>>>>>>>>>>>        Set pdAud_Old_SapHmnia      to Particle.Sap_hmnia
47095>>>>>>>>>>>
47095>>>>>>>>>>>        
47095>>>>>>>>>>>        //------------------------------------------------
47095>>>>>>>>>>>     End_Procedure   // New_Current_Record
47096>>>>>>>>>>>
47096>>>>>>>>>>>    Procedure Shmera integer iField  Date dDate
47097>>>>>>>>>>>        Local Integer Changed
47098>>>>>>>>>>>        Get Field_Changed_State iField to Changed
47099>>>>>>>>>>>        If (Changed=0 AND dDate =0) Begin
47101>>>>>>>>>>>            SysDate4 dDate
47102>>>>>>>>>>>            Set Field_Default_Value iField to dDate
47103>>>>>>>>>>>        End
47103>>>>>>>>>>>>
47103>>>>>>>>>>>    End_Procedure   // Shmera
47104>>>>>>>>>>>
47104>>>>>>>>>>>    Procedure Shmera_Ora integer iField  Number nOra
47105>>>>>>>>>>>        Local Integer Changed
47106>>>>>>>>>>>        Date dDate
47106>>>>>>>>>>>        Number nHour nMin
47106>>>>>>>>>>>        Get Field_Changed_State iField to Changed
47107>>>>>>>>>>>        If (Changed=0 AND nOra =0) Begin
47109>>>>>>>>>>>            SysDate4 dDate nHour nMin
47112>>>>>>>>>>>            Set Field_Default_Value iField to (nHour+(nMin/100))
47113>>>>>>>>>>>        End
47113>>>>>>>>>>>>
47113>>>>>>>>>>>    End_Procedure   // Shmera
47114>>>>>>>>>>>
47114>>>>>>>>>>>    Procedure Shmera_Ora_String integer iField  String asOra
47115>>>>>>>>>>>        Local Integer Changed
47116>>>>>>>>>>>        Date dDate
47116>>>>>>>>>>>        Number nHour nMin nTotal
47116>>>>>>>>>>>        String sOra sMin
47116>>>>>>>>>>>        Get Field_Changed_State iField to Changed
47117>>>>>>>>>>>        If (Changed=0 AND asOra='') Begin
47119>>>>>>>>>>>            SysDate4 dDate nHour nMin
47122>>>>>>>>>>>            Move (nHour+(nMin/100)) to nTotal
47123>>>>>>>>>>>            Set Field_Default_Value iField to (fsConvert_Time_Number_To_String_With_Zeroes(nTotal))
47124>>>>>>>>>>>        End
47124>>>>>>>>>>>>
47124>>>>>>>>>>>    End_Procedure   // Shmera
47125>>>>>>>>>>>
47125>>>>>>>>>>>    Procedure Save_Main_File
47126>>>>>>>>>>>        String  sCodeApo sCodeEos sOldUserID sCurrentUserID
47127>>>>>>>>>>>        Integer iBreak iPmoves iSelected iOldSelected
47127>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia nPosothtaKin
47127>>>>>>>>>>>        Date    dHmnia
47127>>>>>>>>>>>
47127>>>>>>>>>>>        If ((Operation_Origin<>Self) And ;            (Particle.Recnum=0)) Procedure_Return
47130>>>>>>>>>>>
47130>>>>>>>>>>>        If (Particle.Cn_Code<>'') Begin
47132>>>>>>>>>>>            Clear Cn
47133>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
47134>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
47135>>>>>>>>>>>>
47135>>>>>>>>>>>            If (Found) Begin
47137>>>>>>>>>>>                Move Cn.Cn_Sls_ID       to Particle.Sls_ID
47138>>>>>>>>>>>                Move Cn.CN_Cnt_ID       to Particle.Cnt_ID
47139>>>>>>>>>>>                Move Cn.CN_Recr         to Particle.CN_Recr
47140>>>>>>>>>>>            End
47140>>>>>>>>>>>>
47140>>>>>>>>>>>            Else Begin
47141>>>>>>>>>>>                Move ''                 to Particle.Sls_ID
47142>>>>>>>>>>>                Move ''                 to Particle.Cnt_ID
47143>>>>>>>>>>>                Move ''                 to Particle.CN_Recr
47144>>>>>>>>>>>            End
47144>>>>>>>>>>>>
47144>>>>>>>>>>>        End
47144>>>>>>>>>>>>
47144>>>>>>>>>>>        Else Begin
47145>>>>>>>>>>>            Move ''                 to Particle.Sls_ID
47146>>>>>>>>>>>            Move ''                 to Particle.Cnt_ID
47147>>>>>>>>>>>            Move ''                 to Particle.CN_Recr
47148>>>>>>>>>>>        End
47148>>>>>>>>>>>>
47148>>>>>>>>>>>
47148>>>>>>>>>>>        Move Pmoves.Recnum              to iPmoves
47149>>>>>>>>>>>
47149>>>>>>>>>>>        Move Particle.Partl_Selected    to iSelected
47150>>>>>>>>>>>        Get piOldSelected               to iOldSelected
47151>>>>>>>>>>>        Get fsLoginUserID               to sCurrentUserID
47152>>>>>>>>>>>        Get psOldUserID                 to sOldUserID
47153>>>>>>>>>>>
47153>>>>>>>>>>>        If (Particle.Partl_Disctof<>0) Begin
47155>>>>>>>>>>>            If (sOldUserID='') Move sCurrentUserID to Particle.Partl_Toposf
47158>>>>>>>>>>>        End
47158>>>>>>>>>>>>
47158>>>>>>>>>>>        Else Begin
47159>>>>>>>>>>>            Move '' to Particle.Partl_Toposf
47160>>>>>>>>>>>        End
47160>>>>>>>>>>>>
47160>>>>>>>>>>>
47160>>>>>>>>>>>        Move 0 to nPosothtaKin
47161>>>>>>>>>>>        If ((piFromMetasx(Self)) Or (iSelected<>iOldSelected))Begin
47163>>>>>>>>>>>            If ((Particle.Partl_Toposf=sCurrentUserID) Or (Particle.Partl_Toposf='')) Begin
47165>>>>>>>>>>>                If (iSelected) Begin
47167>>>>>>>>>>>                    Clear Pmoves
47168>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
47169>>>>>>>>>>>                    Find Gt Pmoves by index.3
47170>>>>>>>>>>>>
47170>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
47174>>>>>>>>>>>                        Move Pmoves.Timol_Ypol  to Pmoves.Qty_Kinhshs
47175>>>>>>>>>>>                        Add  Pmoves.Timol_Ypol  to nPosothtaKin
47176>>>>>>>>>>>                        Move 1              to Pmoves.Pms_Selected
47177>>>>>>>>>>>                        Saverecord Pmoves
47178>>>>>>>>>>>                        Find Gt Pmoves by index.3
47179>>>>>>>>>>>>
47179>>>>>>>>>>>                    Loop
47180>>>>>>>>>>>>
47180>>>>>>>>>>>                    Move sCurrentUserID to Particle.Partl_Toposf
47181>>>>>>>>>>>                    Move nPosothtaKin   to Particle.Partl_Disctof
47182>>>>>>>>>>>                End
47182>>>>>>>>>>>>
47182>>>>>>>>>>>                Else Begin
47183>>>>>>>>>>>                    Clear Pmoves
47184>>>>>>>>>>>                    Move Particle.Partl_Recr to Pmoves.Partl_Recr
47185>>>>>>>>>>>                    Find Gt Pmoves by index.3
47186>>>>>>>>>>>>
47186>>>>>>>>>>>                    While ((Found=1) And (Pmoves.Partl_Recr=Particle.Partl_Recr))
47190>>>>>>>>>>>                        Move 0 to Pmoves.Qty_Kinhshs
47191>>>>>>>>>>>                        Move 0 to Pmoves.Pms_Selected
47192>>>>>>>>>>>                        Saverecord Pmoves
47193>>>>>>>>>>>                        Find Gt Pmoves by index.3
47194>>>>>>>>>>>>
47194>>>>>>>>>>>                    Loop
47195>>>>>>>>>>>>
47195>>>>>>>>>>>                    Move '' to Particle.Partl_Toposf
47196>>>>>>>>>>>                    Move 0  to Particle.Partl_Disctof
47197>>>>>>>>>>>                End
47197>>>>>>>>>>>>
47197>>>>>>>>>>>
47197>>>>>>>>>>>//                // js 11/04/2003
47197>>>>>>>>>>>//                If (iPmoves) Begin
47197>>>>>>>>>>>//                    Clear Pmoves
47197>>>>>>>>>>>//                    Move iPmoves to Pmoves.Recnum
47197>>>>>>>>>>>//                    Find Eq Pmoves.Recnum
47197>>>>>>>>>>>//                End
47197>>>>>>>>>>>
47197>>>>>>>>>>>            End
47197>>>>>>>>>>>>
47197>>>>>>>>>>>            Set piFromMetasx to 0
47198>>>>>>>>>>>        End
47198>>>>>>>>>>>>
47198>>>>>>>>>>>
47198>>>>>>>>>>>        Forward Send Save_Main_File
47200>>>>>>>>>>>
47200>>>>>>>>>>>    End_Procedure   // Save_Main_File
47201>>>>>>>>>>>
47201>>>>>>>>>>>
47201>>>>>>>>>>>    Procedure Calc_The_Totals
47202>>>>>>>>>>>        Number nPct nPoso nAxia nTmp
47203>>>>>>>>>>>
47203>>>>>>>>>>>        Move (Particle.Partl_AMDISCPMS  + ;              Particle.Partl_TotDiscPc)         to Particle.Partl_DiscAm
47204>>>>>>>>>>>
47204>>>>>>>>>>>        Move (Particle.Partl_TotAmBD    - ;              Particle.Partl_DiscAm)            to Particle.Partl_TotAmAd
47205>>>>>>>>>>>
47205>>>>>>>>>>>        Move (Particle.Partl_TotAmAd    + ;              Particle.Partl_Extra)             to Particle.Partl_GenAm
47206>>>>>>>>>>>
47206>>>>>>>>>>>        If ((Particle.Partl_Extra<>0) And (Particle.Partl_ExtraVatP<>0)) Begin
47208>>>>>>>>>>>            Move (Round(Particle.Partl_Extra        *;                        Particle.Partl_ExtraVatP    /;                  100))                         to Particle.Partl_ExtraVat
47209>>>>>>>>>>>        End
47209>>>>>>>>>>>>
47209>>>>>>>>>>>
47209>>>>>>>>>>>        If ((Particle.Partl_TotDiscPC<>0) And (Particle.Disc_Vat_Pct<>0)) Begin
47211>>>>>>>>>>>            Move (Round(Particle.Partl_TotDiscPC    *;                        Particle.Disc_Vat_Pct       /;                  100))                         to Particle.Disc_Vat_Poso
47212>>>>>>>>>>>        End
47212>>>>>>>>>>>>
47212>>>>>>>>>>>
47212>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47212>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47212>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47212>>>>>>>>>>>        If (Sysfile.Fpa_On_Total=0) Begin
47214>>>>>>>>>>>            Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                to Particle.Total_Vat_Poso
47215>>>>>>>>>>>        End
47215>>>>>>>>>>>>
47215>>>>>>>>>>>        Else Begin
47216>>>>>>>>>>>            If (Particle.Fpa_On_Total<>0) ;                Move (Particle.Fpa_On_Total-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
47219>>>>>>>>>>>            Else ;                Move (Particle.Partl_Vatam-Particle.Disc_Vat_Poso+Particle.Partl_ExtraVat) ;                    to Particle.Total_Vat_Poso
47221>>>>>>>>>>>        End
47221>>>>>>>>>>>>
47221>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47221>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47221>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47221>>>>>>>>>>>
47221>>>>>>>>>>>        Move (Particle.Partl_GenAm      + ;              Particle.Total_Vat_Poso ) to Particle.Partl_PayAm
47222>>>>>>>>>>>
47222>>>>>>>>>>>        If (Particle.PARTL_TOTTEM>0) Begin
47224>>>>>>>>>>>            Move (Particle.PARTL_TOTTEM-Particle.Timol_Qty) ;                                            to Particle.Timol_Ypol
47225>>>>>>>>>>>
47225>>>>>>>>>>>            Move (Particle.Timol_Ypol=0)    to Particle.Partl_Timol
47226>>>>>>>>>>>
47226>>>>>>>>>>>        End
47226>>>>>>>>>>>>
47226>>>>>>>>>>>        Else Move 0 to Particle.Partl_Timol
47228>>>>>>>>>>>
47228>>>>>>>>>>>        Move Particle.Partl_TotAmAD  to nAxia
47229>>>>>>>>>>>        Move Particle.Parakrat_Pct   to nPct
47230>>>>>>>>>>>        Move (Round_Number(((nAxia*nPct)/100),2)) to nTmp
47231>>>>>>>>>>>        Move nTmp to Particle.Parakrat_Poso
47232>>>>>>>>>>>    End_Procedure
47233>>>>>>>>>>>
47233>>>>>>>>>>>    Procedure Find_The_Rate
47234>>>>>>>>>>>        String  sCode sWhat
47235>>>>>>>>>>>        Integer iRateID
47235>>>>>>>>>>>        Number nEuro nIsot nRate
47235>>>>>>>>>>>        Date dHmnia
47235>>>>>>>>>>>        Move Nomisma.Nomisma_Code                   to sCode
47236>>>>>>>>>>>        If (Trim(sCode)='') Move SysCurXr.C_Code0   to sCode
47239>>>>>>>>>>>        Move Particle.Partl_Hmnia       to dHmnia
47240>>>>>>>>>>>        Move Particle.Isotimia          to nIsot
47241>>>>>>>>>>>        If (nIsot=0) Begin
47243>>>>>>>>>>>            If (dHmnia='') Sysdate dHmnia
47246>>>>>>>>>>>            Move (Trim(sCode)) to sCode
47247>>>>>>>>>>>            Clear Isotimia
47248>>>>>>>>>>>            Move sCode      to Isotimia.Nomisma_Code
47249>>>>>>>>>>>            Move (dHmnia+1) to Isotimia.Isotimia_Hmnia
47250>>>>>>>>>>>            Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
47251>>>>>>>>>>>>
47251>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
47254>>>>>>>>>>>            Else Begin
47255>>>>>>>>>>>                Case Begin
47255>>>>>>>>>>>                    case (isotimia.poia_metatrepei='€') // Agora
47257>>>>>>>>>>>                        Move Isotimia.Isotimia_Agora to Particle.Isotimia
47258>>>>>>>>>>>                        Case Break
47259>>>>>>>>>>>                    case (isotimia.poia_metatrepei='') // Polhsh
47262>>>>>>>>>>>                        Move Isotimia.Isotimia_Polhsh to Particle.Isotimia
47263>>>>>>>>>>>                        Case Break
47264>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='F') // Fixing
47267>>>>>>>>>>>                        Move Isotimia.Isotimia_Fixing to Particle.Isotimia
47268>>>>>>>>>>>                        Case Break
47269>>>>>>>>>>>                    Case (Isotimia.Poia_Metatrepei='P') // Private
47272>>>>>>>>>>>                        Move Isotimia.Isotimia_Privat to Particle.Isotimia
47273>>>>>>>>>>>                        Case Break
47274>>>>>>>>>>>                Case End
47274>>>>>>>>>>>            End
47274>>>>>>>>>>>>
47274>>>>>>>>>>>        End
47274>>>>>>>>>>>>
47274>>>>>>>>>>>        Else Begin
47275>>>>>>>>>>>            If (dHmnia='') Sysdate      dHmnia
47278>>>>>>>>>>>            Move (Trim(sCode))      to  sCode
47279>>>>>>>>>>>            Clear Nomisma
47280>>>>>>>>>>>            Move sCode              to Nomisma.Nomisma_Code
47281>>>>>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
47282>>>>>>>>>>>>
47282>>>>>>>>>>>            If (Nomisma.Einai_Drx) Move 1 to Particle.Isotimia
47285>>>>>>>>>>>        End
47285>>>>>>>>>>>>
47285>>>>>>>>>>>    End_Procedure
47286>>>>>>>>>>>
47286>>>>>>>>>>>    Procedure Update
47287>>>>>>>>>>>        String  sCodeApo sCodeEos
47288>>>>>>>>>>>        String  sCar sCarDescr sDriver sDriverDescr
47288>>>>>>>>>>>        Integer iBreak iPmovesID
47288>>>>>>>>>>>        Number  nPoso nPosoEuro nIsotimia
47288>>>>>>>>>>>        Date    dHmnia
47288>>>>>>>>>>>
47288>>>>>>>>>>>        Forward Send Update
47290>>>>>>>>>>>
47290>>>>>>>>>>>        Send Find_The_Rate
47291>>>>>>>>>>>
47291>>>>>>>>>>>        Move SysCurXR.Company_Code  to Particle.Company_Code
47292>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Particle.Branch_Code
47293>>>>>>>>>>>        Move SysCurXR.Year_Year     to Particle.Year_Year
47294>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Particle.Ctypkin_Code
47295>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Particle.Wtypkin_Code
47296>>>>>>>>>>>        //Move Custprom.Custprom_Code to Particle.Custprom_Code
47296>>>>>>>>>>>        Move Clients.Client_ID      to Particle.Client_ID
47297>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Particle.Ptyppar_Code
47298>>>>>>>>>>>        Move Ptyppar.Ptyppar_Module to Particle.Partl_Module
47299>>>>>>>>>>>
47299>>>>>>>>>>>        Move Payresp.Presp_ID       to Particle.Presp_ID
47300>>>>>>>>>>>
47300>>>>>>>>>>>        Send Calc_The_Totals
47301>>>>>>>>>>>
47301>>>>>>>>>>>        Move    Particle.Oxhma_Code             to sCar
47302>>>>>>>>>>>        Get     fsVresOxhmaDescr sCar           to Particle.Oxhma_Descr
47303>>>>>>>>>>>        Get     fsVresDriverCode sCar           to Particle.Odhgos_Code
47304>>>>>>>>>>>        Move    Particle.Odhgos_Code            to sDriver
47305>>>>>>>>>>>        Get     fsVresDriverDescr sDriver       to Particle.Odhgos_Name
47306>>>>>>>>>>>        Move    Particle.Antlia_Code            to sCar
47307>>>>>>>>>>>        Get     fsVresAntliaDescr sCar          to sCarDescr
47308>>>>>>>>>>>        Move    sCarDescr                       to Particle.Antlia_Descr
47309>>>>>>>>>>>
47309>>>>>>>>>>>
47309>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47309>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47309>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47309>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
47309>>>>>>>>>>>//            Clear PartlFpa
47309>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47309>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
47309>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47309>>>>>>>>>>>//            Add Particle.Partl_ExtraVat     to PartlFpa.PartlFpa_Poso
47309>>>>>>>>>>>//            Saverecord PartlFpa
47309>>>>>>>>>>>//        End
47309>>>>>>>>>>>
47309>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
47309>>>>>>>>>>>//            Clear PartlFpa
47309>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47309>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
47309>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47309>>>>>>>>>>>//            Add Particle.Disc_Vat_Poso      to PartlFpa.PartlFpa_Poso
47309>>>>>>>>>>>//            Saverecord PartlFpa
47309>>>>>>>>>>>//        End
47309>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47309>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47309>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47309>>>>>>>>>>>
47309>>>>>>>>>>>        // 01/10/2001 Mphke edo anti gia thn creating gia na kalipsei to problhma
47309>>>>>>>>>>>        // pou proekeipte an gia kapoio logo den symplhrvnotan seira kai o arithmos
47309>>>>>>>>>>>        // emene 0 eprepe na sbhstoun OLA ta lines kai to idio to parastatiko gia na
47309>>>>>>>>>>>        // xanatrexei o kodikas elegxou seiras kai arithmou
47309>>>>>>>>>>>        // Tora trexei sthn Update (giati sthn Save_Main_File kanei validation
47309>>>>>>>>>>>        // PRIN kai kobei thn eggrafh epeidh o arithmos einai 0
47309>>>>>>>>>>>        If ( ((Operation_Origin=Self) Or                 ;             (Operation_Origin=(piPmovesID(Self)))) And  ;             (Particle.Partl_No=0)) Send Kathorise_Thn_Seira
47312>>>>>>>>>>>        // 01/10/2001
47312>>>>>>>>>>>
47312>>>>>>>>>>>
47312>>>>>>>>>>>        //---------------------------------------------
47312>>>>>>>>>>>        // Auditing / Katagrafh allagon
47312>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47312>>>>>>>>>>>            //MODE_WAITING  
47312>>>>>>>>>>>            //MODE_FINDING  
47312>>>>>>>>>>>            //MODE_CLEARING 
47312>>>>>>>>>>>            //MODE_CREATING 
47312>>>>>>>>>>>            //MODE_SAVING   
47312>>>>>>>>>>>            //MODE_DELETING 
47312>>>>>>>>>>>            //MODE_ABORTING 
47312>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47312>>>>>>>>>>>        Date    dDate  Shmer 
47312>>>>>>>>>>>        Integer iMin iHour iSec iLen
47312>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47316>>>>>>>>>>>        Move iHour  to sHour
47317>>>>>>>>>>>        Move iMin   to sMin
47318>>>>>>>>>>>        Move iSec   to sSec
47319>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47323>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47327>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47331>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47332>>>>>>>>>>>        
47332>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
47332>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
47334>>>>>>>>>>>            Get fsLoginUserID to sUser
47335>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
47337>>>>>>>>>>>                clear gmove
47338>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
47339>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
47340>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
47341>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
47342>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
47343>>>>>>>>>>>                move Particle.partl_no      to gmove.garticl_no
47344>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
47345>>>>>>>>>>>                move suser                  to gmove.gplan_code
47346>>>>>>>>>>>                move Particle.Partl_Recr    to gmove.garticl_recr
47347>>>>>>>>>>>                reread sysrecg
47351>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47352>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47353>>>>>>>>>>>                saverecord sysrecg
47354>>>>>>>>>>>                unlock
47355>>>>>>>>>>>>
47355>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
47356>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
47357>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
47358>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
47359>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
47360>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
47361>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
47362>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
47363>>>>>>>>>>>                Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                    to gmove.Cur_CN_Addr 
47364>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47365>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Pms_Recr  
47366>>>>>>>>>>>                Move Particle.Zone_ID               to Gmove.Cur_Zonh
47367>>>>>>>>>>>                Move Particle.Antlia_code           to Gmove.Cur_Antlia
47368>>>>>>>>>>>                Move Particle.Oxhma_code            to Gmove.Cur_Oxhma       
47369>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
47370>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
47371>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
47372>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ §˜¨˜©«˜« ¡¦ç" to sText
47373>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
47374>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
47375>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
47376>>>>>>>>>>>                saverecord gmove
47377>>>>>>>>>>>                Set piCreateNew to 0
47378>>>>>>>>>>>            End
47378>>>>>>>>>>>>
47378>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
47381>>>>>>>>>>>                Integer isChanged
47381>>>>>>>>>>>                Move 0 to isChanged
47382>>>>>>>>>>>                
47382>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths (Self))<>Trim(Clients.Client_ID      ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Particle.CN_Code    ))) Move 1 to isChanged    
47385>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh    (Self))<>Trim(Particle.Zone_ID       ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Particle.Antlia_code))) Move 1 to isChanged   
47389>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma   (Self))<>Trim(Particle.Oxhma_code    ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
47393>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira   (Self))<>Trim(Particle.Pseira_Seira  ))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
47397>>>>>>>>>>>                Else If  (piAud_Old_No           (Self) <>Particle.Partl_No)                                                                                 Move 1 to isChanged
47401>>>>>>>>>>>                Else If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh))   Or  (piAud_Old_Timol(Self)<>Particle.Partl_Timol               )) Move 1 to isChanged  
47405>>>>>>>>>>>                Else If  (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia) Move 1 to isChanged
47409>>>>>>>>>>>
47409>>>>>>>>>>>                If (isChanged>0) Begin  
47411>>>>>>>>>>>                    clear gmove
47412>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
47413>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
47414>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
47415>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
47416>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
47417>>>>>>>>>>>                    move Particle.partl_no      to gmove.garticl_no
47418>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
47419>>>>>>>>>>>                    move suser                  to gmove.gplan_code
47420>>>>>>>>>>>                    move Particle.Partl_Recr    to gmove.garticl_recr
47421>>>>>>>>>>>                    reread sysrecg
47425>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47426>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47427>>>>>>>>>>>                    saverecord sysrecg
47428>>>>>>>>>>>                    unlock
47429>>>>>>>>>>>>
47429>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
47430>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
47431>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
47432>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
47433>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
47434>>>>>>>>>>>                    //--
47434>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
47435>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Pms_Recr  
47436>>>>>>>>>>>                    //--
47436>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
47437>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
47438>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
47439>>>>>>>>>>>                    Move (fsVresCNDescr(Self,Particle.CN_Code)) ;                                                        to gmove.Cur_CN_Addr 
47440>>>>>>>>>>>                    Move (Trim(Particle.Zone_ID     ))  to Gmove.Cur_Zonh
47441>>>>>>>>>>>                    Move (Trim(Particle.Antlia_code ))  to Gmove.Cur_Antlia
47442>>>>>>>>>>>                    Move (Trim(Particle.Oxhma_code  ))  to Gmove.Cur_Oxhma       
47443>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
47444>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
47445>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
47446>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No     
47447>>>>>>>>>>>                    Move Particle.Sap_hmnia             to Gmove.Date1
47448>>>>>>>>>>>                    //--
47448>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
47449>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
47450>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
47451>>>>>>>>>>>                    Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                          to gmove.Prev_CN_Addr 
47452>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
47453>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
47454>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
47455>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
47456>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
47457>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
47458>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
47459>>>>>>>>>>>                    Move (pdAud_Old_SapHmnia     (Self )) to gmove.Date2 
47460>>>>>>>>>>>                    
47460>>>>>>>>>>>                    //--  
47460>>>>>>>>>>>                    If ((Trim(psAud_Old_Ektyposh(Self))<>Trim(Particle.Partl_Ektyposh)) Or (piAud_Old_Timol(Self)<>Particle.Partl_Timol) Or ;                        (pdAud_Old_SapHmnia     (Self) <>Particle.Sap_hmnia)) Move "€¤¦ š£˜ ˜¨˜©«˜« ¡¦ç - BACK DOOR"    to sText 
47463>>>>>>>>>>>                    Else Move "ƒ æ¨Ÿà©ž ˜¨˜©«˜« ¡¦ç"               to sText 
47465>>>>>>>>>>>                    
47465>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
47466>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
47467>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
47468>>>>>>>>>>>                    saverecord gmove
47469>>>>>>>>>>>                    Set piCreateNew to 0
47470>>>>>>>>>>>                End
47470>>>>>>>>>>>>
47470>>>>>>>>>>>            End
47470>>>>>>>>>>>>
47470>>>>>>>>>>>        End
47470>>>>>>>>>>>>
47470>>>>>>>>>>>
47470>>>>>>>>>>>
47470>>>>>>>>>>>    End_Procedure   // Update
47471>>>>>>>>>>>
47471>>>>>>>>>>>    Procedure Delete_Main_File
47472>>>>>>>>>>>        //---------------------------------------------
47472>>>>>>>>>>>        // Auditing / Katagrafh allagon
47472>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
47472>>>>>>>>>>>            //MODE_WAITING  
47472>>>>>>>>>>>            //MODE_FINDING  
47472>>>>>>>>>>>            //MODE_CLEARING 
47472>>>>>>>>>>>            //MODE_CREATING 
47472>>>>>>>>>>>            //MODE_SAVING   
47472>>>>>>>>>>>            //MODE_DELETING 
47472>>>>>>>>>>>            //MODE_ABORTING 
47472>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
47473>>>>>>>>>>>        Date    dDate  Shmer 
47473>>>>>>>>>>>        Integer iMin iHour iSec iLen
47473>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
47477>>>>>>>>>>>        Move iHour  to sHour
47478>>>>>>>>>>>        Move iMin   to sMin
47479>>>>>>>>>>>        Move iSec   to sSec
47480>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
47484>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
47488>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
47492>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
47493>>>>>>>>>>>        
47493>>>>>>>>>>>        // Auditing / Diagrafh 
47493>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
47495>>>>>>>>>>>            Get fsLoginUserID to sUser
47496>>>>>>>>>>>
47496>>>>>>>>>>>            clear gmove
47497>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
47498>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
47499>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
47500>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
47501>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
47502>>>>>>>>>>>            move Particle.partl_no      to gmove.garticl_no
47503>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
47504>>>>>>>>>>>            move suser                  to gmove.gplan_code
47505>>>>>>>>>>>            move Particle.Partl_Recr    to gmove.garticl_recr
47506>>>>>>>>>>>            reread sysrecg
47510>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
47511>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
47512>>>>>>>>>>>            saverecord sysrecg
47513>>>>>>>>>>>            unlock
47514>>>>>>>>>>>>
47514>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
47515>>>>>>>>>>>
47515>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
47516>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
47517>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
47518>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
47519>>>>>>>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
47520>>>>>>>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
47521>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
47522>>>>>>>>>>>            Move (fsVresCNDescr(Self,(psAud_Old_Ergo(Self)))) ;                                                to gmove.Prev_CN_Addr 
47523>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
47524>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
47525>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
47526>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
47527>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
47528>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
47529>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
47530>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
47531>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
47532>>>>>>>>>>>            Move (pdAud_Old_SapHmnia (Self ))   to gmove.Date2 
47533>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã ˜¨˜©«˜« ¡¦ç" to sText
47534>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
47535>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
47536>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
47537>>>>>>>>>>>            saverecord gmove
47538>>>>>>>>>>>        End
47538>>>>>>>>>>>>
47538>>>>>>>>>>>
47538>>>>>>>>>>>        Forward Send Delete_Main_File
47540>>>>>>>>>>>
47540>>>>>>>>>>>    End_Procedure
47541>>>>>>>>>>>
47541>>>>>>>>>>>    Procedure Backout
47542>>>>>>>>>>>        Forward Send Backout
47544>>>>>>>>>>>        Send Calc_The_Totals
47545>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47545>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47545>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47545>>>>>>>>>>>//        If (Particle.Partl_ExtraVat) Begin
47545>>>>>>>>>>>//            Clear PartlFpa
47545>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47545>>>>>>>>>>>//            Move Particle.Partl_ExtraVatP   to PartlFpa.Fpa_Pososto
47545>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47545>>>>>>>>>>>//            Sub Particle.Partl_ExtraVat   From PartlFpa.PartlFpa_Poso
47545>>>>>>>>>>>//            Saverecord PartlFpa
47545>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
47545>>>>>>>>>>>//        End
47545>>>>>>>>>>>
47545>>>>>>>>>>>//        If (Particle.Disc_Vat_Poso) Begin
47545>>>>>>>>>>>//            Clear PartlFpa
47545>>>>>>>>>>>//            Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
47545>>>>>>>>>>>//            Move Particle.Disc_Vat_Pct      to PartlFpa.Fpa_Pososto
47545>>>>>>>>>>>//            Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
47545>>>>>>>>>>>//            Sub Particle.Disc_Vat_Poso    From PartlFpa.PartlFpa_Poso
47545>>>>>>>>>>>//            Saverecord PartlFpa
47545>>>>>>>>>>>//            If (PartlFpa.PartlFpa_Poso=0) Delete PartlFpa
47545>>>>>>>>>>>//        End
47545>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47545>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
47545>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
47545>>>>>>>>>>>
47545>>>>>>>>>>>
47545>>>>>>>>>>>    End_Procedure
47546>>>>>>>>>>>
47546>>>>>>>>>>>    Procedure Kathorise_Thn_Seira
47547>>>>>>>>>>>        Integer iNextNo iSeiraRecnum iPtypparRecnum
47548>>>>>>>>>>>
47548>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
47548>>>>>>>>>>>        If (Ptyppar.Ptyppar_Is_What='2') Begin
47550>>>>>>>>>>>            Clear Pseira
47551>>>>>>>>>>>            Move SysCurXr.Company_Code  to Pseira.Company_Code
47552>>>>>>>>>>>            Move SysCurXr.Branch_Code   to Pseira.Branch_Code
47553>>>>>>>>>>>            //Move SysCurXr.Year_Year     to Pseira.Year_Year
47553>>>>>>>>>>>            //Move Ctypkin.Ctypkin_Code   to Pseira.Ctypkin_Code
47553>>>>>>>>>>>            //Move Wtypkin.Wtypkin_Code   to Pseira.Wtypkin_Code
47553>>>>>>>>>>>            Move Ptyppar.Ptyppar_Code   to Pseira.Ptyppar_Code
47554>>>>>>>>>>>            Move Particle.Pseira_Seira  to Pseira.Pseira_Seira
47555>>>>>>>>>>>            Find eq Pseira By Index.1 // Pseira:Index.1:Company_Code+Branch_Code+Year_Year+;
47556>>>>>>>>>>>>
47556>>>>>>>>>>>                                    //                Ctypkin_Code+Wtypkin_Code+Ptyppar_Code+Seira_Seira
47556>>>>>>>>>>>            If (Found=1) Begin
47558>>>>>>>>>>>                // €¤ ž ©œ ¨˜ œ ¤˜  autonum ¡˜  «¦ §˜¨˜©«˜« ¡¦ œ ¤˜  «¬§¦¬ 2 —Š†‘†
47558>>>>>>>>>>>                If ((Pseira.Pseira_Autonum  = 1)    And ;                    (Particle.Partl_No      = 0 )) Begin
47560>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to iNextNo
47561>>>>>>>>>>>                    Move (Pseira.Autonum_Minus-1) to Pseira.Autonum_Minus
47562>>>>>>>>>>>                    Saverecord Pseira
47563>>>>>>>>>>>                    Move iNextNo to Particle.Partl_No
47564>>>>>>>>>>>                End
47564>>>>>>>>>>>>
47564>>>>>>>>>>>            End
47564>>>>>>>>>>>>
47564>>>>>>>>>>>        End
47564>>>>>>>>>>>>
47564>>>>>>>>>>>        Else Begin
47565>>>>>>>>>>>//       js 25/04/2002 Prosthikh gia na ypostirixei ektyposh promhtheyton
47565>>>>>>>>>>>            If ((Ptyppar.Ptyppar_Is_What='1') And (Trim(Ptyppar.Sysxet_Ptyppar)<>'')) Begin
47567>>>>>>>>>>>                Move (Random(-10000000)-1) To Particle.Partl_No
47568>>>>>>>>>>>            End
47568>>>>>>>>>>>>
47568>>>>>>>>>>>        End
47568>>>>>>>>>>>>
47568>>>>>>>>>>>    End_Procedure
47569>>>>>>>>>>>
47569>>>>>>>>>>>    Procedure Creating
47570>>>>>>>>>>>        Integer iNextNo
47571>>>>>>>>>>>        String  sNo sSeira
47571>>>>>>>>>>>        Forward Send Creating
47573>>>>>>>>>>>        // Insert Code Here
47573>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Particle.Partl_Rec0)))))) to Particle.Partl_Recr
47574>>>>>>>>>>>
47574>>>>>>>>>>>        If (Particle.Disc_Vat_Pct   =0) Move 19 to Particle.Disc_Vat_Pct
47577>>>>>>>>>>>        If (Particle.Partl_ExtraVatP=0) Move 19 to Particle.Partl_ExtraVatP
47580>>>>>>>>>>>
47580>>>>>>>>>>>        Move Clients.Ypoloipo to Particle.Prohg_Ypol
47581>>>>>>>>>>>
47581>>>>>>>>>>>        If ((Trim(Ptyppar.Ti_Typonei_Pms)<>'2') And (Trim(Particle.Cn_Code)<>'')) Begin
47583>>>>>>>>>>>            Clear Cn
47584>>>>>>>>>>>            Move Particle.Cn_Code   to Cn.Cn_Code
47585>>>>>>>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
47586>>>>>>>>>>>>
47586>>>>>>>>>>>            If (Found) Begin
47588>>>>>>>>>>>                Move Particle.Partl_No      to sNo
47589>>>>>>>>>>>                Move Particle.Pseira_Seira  to sSeira
47590>>>>>>>>>>>                Move (Trim(sNo))            to sNo
47591>>>>>>>>>>>                Move (Trim(sSeira))         to sSeira
47592>>>>>>>>>>>                if (cn.hm_prot_fortio='')   Move Particle.Partl_Hmnia   to Cn.Hm_prot_Fortio
47595>>>>>>>>>>>                Move Particle.Partl_Hmnia   to Cn.Hm_Tel_Fortio
47596>>>>>>>>>>>                Move (Trim(sSeira+' '+sNo)) to Cn.Tel_Fortio_No
47597>>>>>>>>>>>                Saverecord CN
47598>>>>>>>>>>>            End
47598>>>>>>>>>>>>
47598>>>>>>>>>>>        End 
47598>>>>>>>>>>>>
47598>>>>>>>>>>>        // sta deltia apostolhs bhma1 den theloyme na ginetai elegxos opos
47598>>>>>>>>>>>        // kai sta aytonoma deltia apostolhs
47598>>>>>>>>>>>        if (PifromBhma1(self)=0) begin
47600>>>>>>>>>>>            if (clients.client_ptyppar='100') begin
47602>>>>>>>>>>>                if (ptyppar.is_xondr<>'1');                    error 5716 '‘œ œ¢á«ž •¦¤›¨ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ Š ˜¤ ¡ãª !!' 
47605>>>>>>>>>>>            end
47605>>>>>>>>>>>>
47605>>>>>>>>>>>            else if (clients.client_ptyppar='113') begin 
47608>>>>>>>>>>>                if (ptyppar.is_xondr='1');                    error 5717 '‘œ œ¢á«ž Š ˜¤ ¡ãª ›œ¤ £§¦¨œåª ¤˜ ¡æ¯œ ª ˜¨˜©«˜« ¡æ •¦¤›¨ ¡ãª !!' 
47611>>>>>>>>>>>            end
47611>>>>>>>>>>>>
47611>>>>>>>>>>>        End
47611>>>>>>>>>>>>
47611>>>>>>>>>>>        
47611>>>>>>>>>>>        Set piCreateNew to 1
47612>>>>>>>>>>>    
47612>>>>>>>>>>>    End_Procedure   // Creating
47613>>>>>>>>>>>
47613>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
47614>>>>>>>>>>>        String sStr
47615>>>>>>>>>>>        Move '' to sStr
47616>>>>>>>>>>>        Append sStr "DDC 14: ’¦ §˜¨˜©«˜« ¡æ §œ¨ â®œ  œ¤˜ œå›¦ª «¦ ¦§¦å¦\n"
47617>>>>>>>>>>>        Append sStr "§˜¨¦¬© áœ  ¡å¤ž©ž §¨¦ª £œ«˜©®ž£˜« ©£æ ˜§¦ «¦¤ ®¨ã©«ž\n"
47618>>>>>>>>>>>        Append sStr Particle.Partl_Toposf ". ˜«ã©«œ F5 £œ«˜ «¦ Ž‰"
47620>>>>>>>>>>>
47620>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ˜¨˜©«˜« ¡¦ç"
47623>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ”¦¨â˜"
47627>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 14: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã Œ¦£å©£˜«¦ª"
47631>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 14: †£œ¨¦£ž¤å˜ §˜¨˜©«˜« ¡¦ç ¡œ¤ã"
47635>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47639>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
47643>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 14: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47647>>>>>>>>>>>        Else If (iError_Num = 1008) Error 1008 "DDC 14: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
47651>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 14: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
47655>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 14: † é¨˜ §¨â§œ  ¤˜ ›¦Ÿœå\n£œ 2 ¯ž­å˜ š ˜ «ž¤ é¨˜ ¡˜  2 š ˜ «˜ ¢œ§«á"
47659>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 14: †£œ¨¦£ž¤å˜ §¨¦šœ¤â©«œ¨ž «žª «œ¢œ¬«˜å˜ª œ¡«ç§à©žª"
47663>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 sStr
47667>>>>>>>>>>>        Else If (iError_Num = 1055) Error 1055 "DDC 14: †£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª"
47671>>>>>>>>>>>        Else If (iError_Num = 1060) Error 1060 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¦§¦ ˜›ã§¦«œ ˜¢¢˜šã ©«¦ ®œåà¤"
47675>>>>>>>>>>>        Else If (iError_Num = 1061) Error 1061 "DDC 14: ˜¨˜©«˜« ¡æ £œ«˜©®ž£˜« ©£â¤¦.\nƒœ¤ œ§ «¨â§œ«˜  ¤˜ › ˜š¨˜­œå"
47679>>>>>>>>>>>        Else If (iError_Num = 6040) Error 6040 "DDC 14: ƒœ¤ â®œ  §¨¦©› ¦¨ ©«œå ¡à› ¡æª ¤¦£å©£˜«¦ª"
47683>>>>>>>>>>>        Else If (iError_Num = 6050) Error 6050 "DDC 14: Ž œ¢á«žª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
47687>>>>>>>>>>>        Else If (iError_Num = 6051) Error 6051 "DDC 14: ’¦ §˜¨˜©«˜« ¡æ ¡ ¤œå ˜¥åœª ˜¢¢á «¦ ©ç¤¦¢¦ «à¤ ˜¥ é¤ «¦¬ œå¤˜  £ž›œ¤ ¡æ"
47691>>>>>>>>>>>        Else If (iError_Num = 6060) Error 6060 "DDC 14: Ž “§œçŸ¬¤¦ª ¢ž¨à£é¤ ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž"
47695>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 14: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
47699>>>>>>>>>>>        Else If (iError_Num = 1065) Error 1065 "DDC 14: Ž €¨ Ÿ£æª «¦¬ §˜¨˜©«˜« ¡¦ç \nƒ„Œ §¨â§œ  ¡˜  ›œ¤ £§¦¨œå ¤˜ œå¤˜  £ž›œ¤ ¡æª"
47703>>>>>>>>>>>        Else If (iError_Num = 1099) Error 1099 "DDC 14: ‰˜«žš¦¨å˜ œ¢á«ž › ˜­¦¨œ« ¡ã ¡˜«žš¦¨å˜ª ˜¨˜©«˜« ¡¦ç.\n„¢œš®¦ª ¡˜«žš¦¨å˜ª Š ˜¤ ¡ãª / •¦¤›¨ ¡ãª"
47707>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
47710>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
47711>>>>>>>>>>>
47711>>>>>>>>>>>    Function Validate_Save Returns Integer
47712>>>>>>>>>>>        Number nqty
47713>>>>>>>>>>>        Integer iReturnVal iYes
47713>>>>>>>>>>>        String  sCurrentUserID sOldUserID
47713>>>>>>>>>>>
47713>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
47715>>>>>>>>>>>
47715>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47717>>>>>>>>>>>                 If (Ptyppar.Recnum      = 0)   Move 1001 to iReturnVal
47720>>>>>>>>>>>            Else If (Clients.Recnum      = 0)   Move 1002 to iReturnVal
47724>>>>>>>>>>>            Else If (Nomisma.Recnum      = 0)   Move 1003 to iReturnVal
47728>>>>>>>>>>>            Else If (Particle.Partl_Hmnia='')   Move 1004 to iReturnVal
47732>>>>>>>>>>>            Else If  Nomisma.nomisma_Code eq '' Move 6040 to iReturnVal
47736>>>>>>>>>>>          //  else if (clients.is_xondr ne ptyppar.is_xondr) move 1099 to iReturnVal
47736>>>>>>>>>>>            Else Begin
47737>>>>>>>>>>>//                If ((Clients.Plafon>0) And (Clients.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
47737>>>>>>>>>>>//                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47737>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6050 to iReturnVal
47737>>>>>>>>>>>//                End
47737>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And (PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) Begin
47737>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47737>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
47737>>>>>>>>>>>//                End
47737>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And (PayResp.OverHead<1) And (Sysfile.Over_OverHead<>'1')) begin
47737>>>>>>>>>>>//                    Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
47737>>>>>>>>>>>//                    If (iYes=MBR_NO) Move 6060 to iReturnVal
47737>>>>>>>>>>>//                End
47737>>>>>>>>>>>
47737>>>>>>>>>>>                If ((Particle.Partl_Hmnia<SYSCURXR.YEAR_XRHSHFROM) Or ;                    (Particle.Partl_Hmnia>SYSCURXR.YEAR_XRHSHTO))     ;                                                Move 1055 to iReturnVal
47740>>>>>>>>>>>                Else Begin
47741>>>>>>>>>>>                    If (Particle.Partl_Disctof<>0) Begin
47743>>>>>>>>>>>                        Get fsLoginUserID to sCurrentUserID
47744>>>>>>>>>>>                        Get psOldUserID   to sOldUserID
47745>>>>>>>>>>>                        If (sOldUserID<>'') Begin
47747>>>>>>>>>>>                            If (sOldUserID<>sCurrentUserID) Move 1012 to iReturnVal
47750>>>>>>>>>>>                        End
47750>>>>>>>>>>>>
47750>>>>>>>>>>>                        //Else Move sCurrentUserID to Particle.Partl_Toposf
47750>>>>>>>>>>>                    End
47750>>>>>>>>>>>>
47750>>>>>>>>>>>                    //Else Move '' to Particle.Partl_Toposf
47750>>>>>>>>>>>                End
47750>>>>>>>>>>>>
47750>>>>>>>>>>>            End
47750>>>>>>>>>>>>
47750>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
47750>>>>>>>>>>>// js 26/08/2002 Erothsh: Pos tha piaso ena parastatiko to opoio kinei
47750>>>>>>>>>>>//               axies alla katalhgei na exei geniko synolo 0 (an p.x.
47750>>>>>>>>>>>//               ginoun ekptoseis 100%.
47750>>>>>>>>>>>//               Apanthsh: To piano edo me ton oro oti den mporei na kopsei
47750>>>>>>>>>>>//               timologio m'ena eidos mono to opoio exei ekptosh 100%, opote
47750>>>>>>>>>>>//               ef'oson tha yparxoun pano apo ena eidos, to eidos me thn
47750>>>>>>>>>>>//               ekptosh prepei na kataxorithei san 2o kai meta.POTE proto
47750>>>>>>>>>>>//               giati etsi tha exei 0 to synolo tou parastatikou kai tha
47750>>>>>>>>>>>//               varesei to validation.
47750>>>>>>>>>>>
47750>>>>>>>>>>>// Rem giati sthn fash metasxhmatismou apo DAP se TIM den yparxoun times sto DAP
47750>>>>>>>>>>>// opote kai to TIM pou paragetai den exei times (Eno leme pos TIM xoris times den ginetai
47750>>>>>>>>>>>// Bebaia edo mporoume na elegxoume epipleon an to paragomeno erxetai apo metasxhmatismo
47750>>>>>>>>>>>// opote kai tha to afhname. NA TO DOUME.
47750>>>>>>>>>>>//            Else If ((Sysfile.Mhdeniko_Partl=0) And (Ptyppar.Ti_Typonei_Pms<>'1') And ;
47750>>>>>>>>>>>//                     (Particle.Partl_Payam=0)   And (Particle.Partl_NoOfLines>0)) ;
47750>>>>>>>>>>>//                    Move 6051 to iReturnVal
47750>>>>>>>>>>>
47750>>>>>>>>>>>/////////////////////////////////////////////////////////////////////////////
47750>>>>>>>>>>>
47750>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
47753>>>>>>>>>>>        End
47753>>>>>>>>>>>>
47753>>>>>>>>>>>        Function_Return iReturnVal
47754>>>>>>>>>>>    End_Function   // Validate_Save
47755>>>>>>>>>>>
47755>>>>>>>>>>>
47755>>>>>>>>>>>    Function Validate_Delete  Returns Integer
47756>>>>>>>>>>>        Integer iReturnVal
47757>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
47759>>>>>>>>>>>        If (Not(iReturnVal)) Begin
47761>>>>>>>>>>>            If (Particle.Partl_Timol = 1) Move 1009 to iReturnVal
47764>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
47768>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
47771>>>>>>>>>>>        End
47771>>>>>>>>>>>>
47771>>>>>>>>>>>        Function_Return iReturnVal
47772>>>>>>>>>>>    End_Function   // Validate_Delete
47773>>>>>>>>>>>
47773>>>>>>>>>>>
47773>>>>>>>>>>>    // Define_Fields:
47773>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
47773>>>>>>>>>>>
47773>>>>>>>>>>>    Procedure Define_Fields
47774>>>>>>>>>>>        Forward Send Define_Fields
47776>>>>>>>>>>>        //DDB-Generated-Code-Location
47776>>>>>>>>>>>        //DDB-DefineFieldStart
47776>>>>>>>>>>>
47776>>>>>>>>>>>        Set Main_File            To Particle.File_Number
47777>>>>>>>>>>>
47777>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
47778>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
47779>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
47780>>>>>>>>>>>
47780>>>>>>>>>>>        // Child (Client) file structure................
47780>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
47781>>>>>>>>>>>        Send Add_Client_File  Tparticl.File_Number
47782>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
47783>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
47784>>>>>>>>>>>        Send Add_Client_File  Psxetika.File_Number
47785>>>>>>>>>>>
47785>>>>>>>>>>>        // Parent (Server) file structure...............
47785>>>>>>>>>>>        Send Add_Server_File  Clients.File_Number
47786>>>>>>>>>>>        Send Add_Server_File  Ptyppar.File_Number
47787>>>>>>>>>>>        Send Add_Server_File  Nomisma.File_Number
47788>>>>>>>>>>>
47788>>>>>>>>>>>        // External (System) file structure.............
47788>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
47789>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
47790>>>>>>>>>>>        Send Add_System_File  Pseira.File_Number  DD_LOCK_ON_ALL
47791>>>>>>>>>>>        Send Add_System_File  Cn.File_Number  DD_LOCK_ON_ALL
47792>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
47793>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
47794>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
47795>>>>>>>>>>>        Send Add_System_File  Ypoprosf.File_Number  DD_LOCK_ON_ALL
47796>>>>>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
47797>>>>>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
47798>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
47799>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
47800>>>>>>>>>>>
47800>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Particle_Rec0  To Particle.Partl_Rec0
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Field-based properties.......................
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Company_Code
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Branch_Code
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Year_Year
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Ctypkin_Code
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Wtypkin_Code
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Ptyppar_Code
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Pseira_Seira
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Custprom_Code
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Client_Id
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Partl_No
47803>>>>>>>>>>>
47803>>>>>>>>>>>        // Particle.Cn_Recr
47803>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Recr To (sl041(Self))
47804>>>>>>>>>>>
47804>>>>>>>>>>>        // Particle.Pseira_Recr
47804>>>>>>>>>>>
47804>>>>>>>>>>>        // Particle.Partl_Hmnia
47804>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Partl_Hmnia To Shmera
47805>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Hmnia To (sl014(Self))
47806>>>>>>>>>>>
47806>>>>>>>>>>>        // Particle.Partl_Rec0
47806>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Rec0 To DD_AUTOFIND   
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Lastno
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Tdiakin
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Car
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Reldoc
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Toposf
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Toposa
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Troposa
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Tof
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Disctof
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Disccl
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Autodisc
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Time
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Totambd
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Amdiscpms
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Totdiscpc
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Discam
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Totamad
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Vatpct
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Vatam
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Genam
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Extra
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Extravatp
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Extravat
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Payam
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Befypol
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Currypol
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Tottem
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Det
47807>>>>>>>>>>>
47807>>>>>>>>>>>        // Particle.Partl_Recr
47807>>>>>>>>>>>        Set Field_Options          Field Particle.Partl_Recr To DD_AUTOFIND   
47808>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Partl_Recr To (sl014(Self))
47809>>>>>>>>>>>
47809>>>>>>>>>>>        // Particle.Cn_Code
47809>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Cn_Code To (sl041(Self))
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Client_Recr
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Ptyppar_Recr
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Ekleise
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Ekl_Recr
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Ektyposh
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Akyrosh
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Akyr_Recr
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Nooflines
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Cmoves_Recr
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Nomisma_Code
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Isotimia
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Wcmoves_Recr
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Module
47810>>>>>>>>>>>
47810>>>>>>>>>>>        // Particle.Partl_Timol
47810>>>>>>>>>>>        Set Field_Mask             Field Particle.Partl_Timol To "#"
47811>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Partl_Timol To MASK_NUMERIC_WINDOW
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Partl_Selected
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Partl_Tim_Recr
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Partl_Vsn
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Sls_Id
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Presp_Id
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Cnt_Id
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Topos_Apostolhs
47812>>>>>>>>>>>
47812>>>>>>>>>>>        // Particle.Tropos_Diakin
47812>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Tropos_Diakin To "dbComboFormsub"
47813>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Diakin To (Particle_Tropos_Diakin_VT(Self))
47814>>>>>>>>>>>
47814>>>>>>>>>>>        // Particle.Ora_Apostolhs
47814>>>>>>>>>>>        Set Field_Entry_msg        Field Particle.Ora_Apostolhs To Shmera_Ora_String
47815>>>>>>>>>>>        Set Field_Mask             Field Particle.Ora_Apostolhs To "##:##"
47816>>>>>>>>>>>
47816>>>>>>>>>>>        // Particle.Skopos_Diakin
47816>>>>>>>>>>>        Set Field_Class_Name       Field Particle.Skopos_Diakin To "dbComboFormsub"
47817>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Skopos_Diakin To (Particle_Skopos_Diakin_VT(Self))
47818>>>>>>>>>>>
47818>>>>>>>>>>>        // Particle.Tropos_Plhromhs
47818>>>>>>>>>>>        Set Field_Value_Table      Field Particle.Tropos_Plhromhs To (Particle_Tropos_Plhromhs_VT(Self))
47819>>>>>>>>>>>
47819>>>>>>>>>>>        // Particle.Odhgos_Code
47819>>>>>>>>>>>
47819>>>>>>>>>>>        // Particle.Odhgos_Name
47819>>>>>>>>>>>
47819>>>>>>>>>>>        // Particle.Oxhma_Code
47819>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Oxhma_Code To (sl054(Self))
47820>>>>>>>>>>>
47820>>>>>>>>>>>        // Particle.Oxhma_Descr
47820>>>>>>>>>>>
47820>>>>>>>>>>>        // Particle.Antlia_Code
47820>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Antlia_Code To (sl053(Self))
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Antlia_Descr
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Partl_Euro
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Disc_Vat_Pct
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Disc_Vat_Poso
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Total_Vat_Poso
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Exei_Sxetika
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Aitiol
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Max_Days_Date
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Timol_Qty
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Timol_Ypol
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Epilogh_Ekkrem
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.No_Print_Module
47821>>>>>>>>>>>        //DDB/ Comment_Short       Field Particle.No_Print_Module To "Œ˜ £ž¤ «¬§é¤œ«˜  (˜§¦ ˜¢¢¦ ¡ç¡¢à£˜ §.®.§˜¨˜š ©œ ¨¦£)"
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Prohg_Ypol
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Trex_Ypol
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Parakrat_Pct
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Parakrat_Poso
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Cms_Parak_Recr
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Enhm_Logik
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Se_Logik
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Akyro
47821>>>>>>>>>>>
47821>>>>>>>>>>>        // Particle.Zone_Id
47821>>>>>>>>>>>        Set Field_Prompt_Object    Field Particle.Zone_Id To (sl064(Self))
47822>>>>>>>>>>>
47822>>>>>>>>>>>        // Particle.Fpa_On_Total
47822>>>>>>>>>>>
47822>>>>>>>>>>>        // Particle.Ss_Arithmos
47822>>>>>>>>>>>
47822>>>>>>>>>>>        // Particle.Sap_Hmnia
47822>>>>>>>>>>>        Set Field_Mask_Type        Field Particle.Sap_Hmnia To MASK_DATE_WINDOW
47823>>>>>>>>>>>
47823>>>>>>>>>>>        //DDB-DefineFieldEnd
47823>>>>>>>>>>>    End_Procedure    // Define_Fields
47824>>>>>>>>>>>
47824>>>>>>>>>>>    // Field_Defaults:
47824>>>>>>>>>>>    // This procedure is used to establish default field values.
47824>>>>>>>>>>>
47824>>>>>>>>>>>    Procedure Field_Defaults
47825>>>>>>>>>>>        Forward Send Field_Defaults
47827>>>>>>>>>>>        //DDB-Generated-Code-Location
47827>>>>>>>>>>>        //DDB-FieldDefaultStart
47827>>>>>>>>>>>        //DDB-FieldDefaultEnd
47827>>>>>>>>>>>        Set Field_Changed_Value Field Particle.Nomisma_Code to SyscurXr.C_Code0
47828>>>>>>>>>>>    End_Procedure    // Field_Defaults
47829>>>>>>>>>>>
47829>>>>>>>>>>>End_Class    // Particle_DataDictionary
47830>>>>>>>>>>>//DDB-Selection-pkg-Start
47830>>>>>>>>>>>
47830>>>>>>>>>>>Use sl041.SL         // sl041
47830>>>>>>>>>>>Use sl014.SL         // sl014
INCLUDING FILE: SL014.SL
47830>>>>>>>>>>>>>//AB/ Project sl014:Particle Lookup
47830>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
47830>>>>>>>>>>>>>//AB/     Set ProjectName to "sl014:Particle Lookup"
47830>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl014.SL"
47830>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
47830>>>>>>>>>>>>>
47830>>>>>>>>>>>>>// Project Object Structure
47830>>>>>>>>>>>>>//   sl014 is a dbModalPanelSub
47830>>>>>>>>>>>>>//     Ctypkin_DD is a DataDictionary
47830>>>>>>>>>>>>>//     Wtypkin_DD is a DataDictionary
47830>>>>>>>>>>>>>//     Ptyppar_DD is a DataDictionary
47830>>>>>>>>>>>>>//     Clients_DD is a DataDictionary
47830>>>>>>>>>>>>>//     Nomisma_DD is a DataDictionary
47830>>>>>>>>>>>>>//     Particle_DD is a DataDictionary
47830>>>>>>>>>>>>>//     oSelList is a dbListSub
47830>>>>>>>>>>>>>//     cSyDateForm1 is a cSyDateForm
47830>>>>>>>>>>>>>//     FormSub1 is a FormSub
47830>>>>>>>>>>>>>//     FormSub3 is a FormSub
47830>>>>>>>>>>>>>//     FormSub2 is a FormSub
47830>>>>>>>>>>>>>//     FormSub4 is a FormSub
47830>>>>>>>>>>>>>//     FormSub5 is a FormSub
47830>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
47830>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
47830>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
47830>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
47830>>>>>>>>>>>>>//     oOk_bn is a ButtonSub
47830>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
47830>>>>>>>>>>>>>//     TextBoxSub4 is a TextBoxSub
47830>>>>>>>>>>>>>
47830>>>>>>>>>>>>>// Register all objects
47830>>>>>>>>>>>>>Register_Object ButtonSub1
47830>>>>>>>>>>>>>Register_Object Clients_DD
47830>>>>>>>>>>>>>Register_Object Ctypkin_DD
47830>>>>>>>>>>>>>Register_Object cSyDateForm1
47830>>>>>>>>>>>>>Register_Object FormSub1
47830>>>>>>>>>>>>>Register_Object FormSub2
47830>>>>>>>>>>>>>Register_Object FormSub3
47830>>>>>>>>>>>>>Register_Object FormSub4
47830>>>>>>>>>>>>>Register_Object FormSub5
47830>>>>>>>>>>>>>Register_Object Nomisma_DD
47830>>>>>>>>>>>>>Register_Object oOk_bn
47830>>>>>>>>>>>>>Register_Object oSearch_bn
47830>>>>>>>>>>>>>Register_Object oSelList
47830>>>>>>>>>>>>>Register_Object Particle_DD
47830>>>>>>>>>>>>>Register_Object Ptyppar_DD
47830>>>>>>>>>>>>>Register_Object sl014
47830>>>>>>>>>>>>>Register_Object TextBoxSub1
47830>>>>>>>>>>>>>Register_Object TextBoxSub2
47830>>>>>>>>>>>>>Register_Object TextBoxSub3
47830>>>>>>>>>>>>>Register_Object TextBoxSub4
47830>>>>>>>>>>>>>Register_Object Wtypkin_DD
47830>>>>>>>>>>>>>
47830>>>>>>>>>>>>>
47830>>>>>>>>>>>>>
47830>>>>>>>>>>>>>//AB-StoreTopStart
47830>>>>>>>>>>>>>            
47830>>>>>>>>>>>>>Open PtypparL
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>Use sl100.sl
47832>>>>>>>>>>>>>Use sl012.sl
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>//AB-StoreTopEnd
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>//AB-IgnoreStart
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>Use DFAllEnt.pkg
47832>>>>>>>>>>>>>Use dbList.Sub
47832>>>>>>>>>>>>>Use cSyDateForm.Pkg
47832>>>>>>>>>>>>>Use Form.Sub
47832>>>>>>>>>>>>>Use Txtbox.Sub
47832>>>>>>>>>>>>>Use Button.Sub
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>Use CTYPKIN.DD
47832>>>>>>>>>>>>>Use WTYPKIN.DD
47832>>>>>>>>>>>>>Use PTYPPAR.DD
47832>>>>>>>>>>>>>Use CLIENTS.DD
47832>>>>>>>>>>>>>Use NOMISMA.DD
47832>>>>>>>>>>>>>Use PARTICLE.DD
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>//AB-IgnoreEnd
47832>>>>>>>>>>>>>
47832>>>>>>>>>>>>>Object sl014 is a dbModalPanelSub
47834>>>>>>>>>>>>>
47834>>>>>>>>>>>>>    //AB-StoreTopStart
47834>>>>>>>>>>>>>                                
47834>>>>>>>>>>>>>    Property String psModule        Public ''
47836>>>>>>>>>>>>>    Property String psClient        Public ''
47838>>>>>>>>>>>>>    Property String psPtyppar       Public ''
47840>>>>>>>>>>>>>    Property String psCtypkin       Public ''
47842>>>>>>>>>>>>>    Property String psWtypkin       Public ''
47844>>>>>>>>>>>>>    Property String psPtypparRecr   Public ''
47846>>>>>>>>>>>>>    Property Integer Pino           Public 0
47848>>>>>>>>>>>>>    Property Date   pdHmnia         Public ''
47850>>>>>>>>>>>>>    
47850>>>>>>>>>>>>>    //AB-StoreTopEnd
47850>>>>>>>>>>>>>
47850>>>>>>>>>>>>>    Set Label to "˜¨˜©«˜« ¡á"
47851>>>>>>>>>>>>>    Set Size to 294 523
47852>>>>>>>>>>>>>    Set Location to 0 3
47853>>>>>>>>>>>>>    Set Color to 12363657
47854>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
47855>>>>>>>>>>>>>    Set Modal_State to FALSE
47856>>>>>>>>>>>>>
47856>>>>>>>>>>>>>    //AB-DDOStart
47856>>>>>>>>>>>>>
47856>>>>>>>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
47858>>>>>>>>>>>>>    End_Object    // Ctypkin_DD
47859>>>>>>>>>>>>>
47859>>>>>>>>>>>>>    Object Wtypkin_DD is a Wtypkin_DataDictionary
47861>>>>>>>>>>>>>    End_Object    // Wtypkin_DD
47862>>>>>>>>>>>>>
47862>>>>>>>>>>>>>    Object Ptyppar_DD is a Ptyppar_DataDictionary
47864>>>>>>>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
47865>>>>>>>>>>>>>        Set DDO_Server to (Wtypkin_DD(self))
47866>>>>>>>>>>>>>    End_Object    // Ptyppar_DD
47867>>>>>>>>>>>>>
47867>>>>>>>>>>>>>    Object Clients_DD is a Clients_DataDictionary
47869>>>>>>>>>>>>>    End_Object    // Clients_DD
47870>>>>>>>>>>>>>
47870>>>>>>>>>>>>>    Object Nomisma_DD is a Nomisma_DataDictionary
47872>>>>>>>>>>>>>    End_Object    // Nomisma_DD
47873>>>>>>>>>>>>>
47873>>>>>>>>>>>>>    Object Particle_DD is a Particle_DataDictionary
47875>>>>>>>>>>>>>        Set DDO_Server to (Clients_DD(self))
47876>>>>>>>>>>>>>        Set DDO_Server to (Ptyppar_DD(self))
47877>>>>>>>>>>>>>        Set DDO_Server to (Nomisma_DD(self))
47878>>>>>>>>>>>>>
47878>>>>>>>>>>>>>        //AB-StoreStart
47878>>>>>>>>>>>>>                                                        
47878>>>>>>>>>>>>>        Procedure OnConstrain
47880>>>>>>>>>>>>>            String  sPtyppar sWtypkin sCtypkin sClientID sPtypparRecr
47881>>>>>>>>>>>>>            Date    dHmnia
47881>>>>>>>>>>>>>            Integer Ino
47881>>>>>>>>>>>>>            Get psClient        to sClientID
47882>>>>>>>>>>>>>            Get psPtyppar       to sPtyppar
47883>>>>>>>>>>>>>            Get psPtypparRecr   to sPtypparRecr
47884>>>>>>>>>>>>>            Get psCtypkin       to sCtypkin
47885>>>>>>>>>>>>>            Get psWtypkin       to sWtypkin
47886>>>>>>>>>>>>>            Get Value Of cSyDateForm1 Item 0 to dHmnia
47887>>>>>>>>>>>>>            get Pino            to Ino
47888>>>>>>>>>>>>>            If (sClientID<>'') Begin
47890>>>>>>>>>>>>>                If (sPtypparRecr<>'') Begin
47892>>>>>>>>>>>>>                    Set Ordering to 1
47893>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47895>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47897>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47899>>>>>>>>>>>>>                    Constrain Particle.CustProm_Code    Eq ''
47901>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
47903>>>>>>>>>>>>>                    Constrain Particle.Ctypkin_Code     Eq sCtypkin
47905>>>>>>>>>>>>>                    Constrain Particle.Wtypkin_Code     Eq sWtypkin
47907>>>>>>>>>>>>>                    Constrain Particle.Ptyppar_Code     Eq sPtyppar
47909>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
47913>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
47917>>>>>>>>>>>>>                End
47917>>>>>>>>>>>>>>
47917>>>>>>>>>>>>>                Else Begin
47918>>>>>>>>>>>>>                    Set Ordering to 13
47919>>>>>>>>>>>>>                    Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47921>>>>>>>>>>>>>                    Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47923>>>>>>>>>>>>>                    Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47925>>>>>>>>>>>>>                    Constrain Particle.Client_ID        Eq sClientID
47927>>>>>>>>>>>>>                    If (dHmnia<>'') ;                        Constrain Particle.Partl_Hmnia  Eq dHmnia
47931>>>>>>>>>>>>>                    If (Ino<>0) ;                        Constrain Particle.Partl_no     Eq Ino
47935>>>>>>>>>>>>>                End
47935>>>>>>>>>>>>>>
47935>>>>>>>>>>>>>            End
47935>>>>>>>>>>>>>>
47935>>>>>>>>>>>>>            Else If (sPtypparRecr<>'') Begin
47938>>>>>>>>>>>>>                Set Ordering to 12
47939>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47941>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47943>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47945>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
47947>>>>>>>>>>>>>                Constrain Particle.Ptyppar_Recr     Eq sPtypparRecr
47949>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
47953>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
47957>>>>>>>>>>>>>            End
47957>>>>>>>>>>>>>>
47957>>>>>>>>>>>>>            Else  Begin
47958>>>>>>>>>>>>>                Set Ordering to 14
47959>>>>>>>>>>>>>                Constrain Particle.Company_Code     Eq SysCurXR.Company_Code
47961>>>>>>>>>>>>>                Constrain Particle.Branch_Code      Eq SysCurXR.Branch_Code
47963>>>>>>>>>>>>>                Constrain Particle.Year_Year        Eq SysCurXR.Year_Year
47965>>>>>>>>>>>>>                Constrain Particle.Partl_Module     Eq (psModule(Self))
47967>>>>>>>>>>>>>                If (dHmnia<>'') ;                    Constrain Particle.Partl_Hmnia  Eq dHmnia
47971>>>>>>>>>>>>>                If (Ino<>0) ;                    Constrain Particle.Partl_no     Eq Ino
47975>>>>>>>>>>>>>            End
47975>>>>>>>>>>>>>>
47975>>>>>>>>>>>>>        
47975>>>>>>>>>>>>>        End_Procedure
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        
47976>>>>>>>>>>>>>        //AB-StoreEnd
47976>>>>>>>>>>>>>
47976>>>>>>>>>>>>>    End_Object    // Particle_DD
47977>>>>>>>>>>>>>
47977>>>>>>>>>>>>>    Set Main_DD to (Particle_DD(self))
47978>>>>>>>>>>>>>    Set Server to (Particle_DD(self))
47979>>>>>>>>>>>>>
47979>>>>>>>>>>>>>    //AB-DDOEnd
47979>>>>>>>>>>>>>
47979>>>>>>>>>>>>>    Object oSelList is a dbListSub
47981>>>>>>>>>>>>>        Set Main_File to Particle.File_Number
47982>>>>>>>>>>>>>        Set Size to 208 511
47983>>>>>>>>>>>>>        Set Location to 6 5
47984>>>>>>>>>>>>>        Set Auto_Index_State to FALSE
47985>>>>>>>>>>>>>
47985>>>>>>>>>>>>>        Begin_Row
47988>>>>>>>>>>>>>            Entry_Item Particle.Partl_hmnia
47989>>>>>>>>>>>>>            Entry_Item Ptyppar.Ptyppar_descr
47990>>>>>>>>>>>>>            Entry_Item Particle.Pseira_seira
47991>>>>>>>>>>>>>            Entry_Item Particle.Partl_no
47992>>>>>>>>>>>>>            Entry_Item Clients.Client_id
47993>>>>>>>>>>>>>            Entry_Item Clients.Client_name
47994>>>>>>>>>>>>>            Entry_Item Particle.Partl_payam
47995>>>>>>>>>>>>>            Entry_Item Particle.Partl_ekleise
47996>>>>>>>>>>>>>        End_Row
48001>>>>>>>>>>>>>
48001>>>>>>>>>>>>>        Set Form_Width    item 0 to 55
48002>>>>>>>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
48003>>>>>>>>>>>>>        
48003>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
48004>>>>>>>>>>>>>        Set Header_Label  item 1 to "˜¨˜©«˜« ¡æ"
48005>>>>>>>>>>>>>        
48005>>>>>>>>>>>>>        Set Form_Width    item 2 to 36
48006>>>>>>>>>>>>>        Set Header_Label  item 2 to "‘œ ¨á"
48007>>>>>>>>>>>>>        
48007>>>>>>>>>>>>>        Set Form_Width    item 3 to 55
48008>>>>>>>>>>>>>        Set Header_Label  item 3 to "€¨ Ÿ£æª"
48009>>>>>>>>>>>>>        
48009>>>>>>>>>>>>>        Set Form_Width    item 4 to 57
48010>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à› ¡æª"
48011>>>>>>>>>>>>>        
48011>>>>>>>>>>>>>        Set Form_Width    item 5 to 140
48012>>>>>>>>>>>>>        Set Header_Label  item 5 to "œ¢á«žª / ¨¦£žŸœ¬«ãª"
48013>>>>>>>>>>>>>        
48013>>>>>>>>>>>>>        Set Form_Width    item 6 to 48
48014>>>>>>>>>>>>>        Set Header_Label  item 6 to "€¥å˜"
48015>>>>>>>>>>>>>        
48015>>>>>>>>>>>>>        Set Form_Width    item 7 to 16
48016>>>>>>>>>>>>>        Set Header_Label  item 7 to "K"
48017>>>>>>>>>>>>>        Set Column_Checkbox_State  item 7 to True
48018>>>>>>>>>>>>>        
48018>>>>>>>>>>>>>
48018>>>>>>>>>>>>>        //AB-StoreStart
48018>>>>>>>>>>>>>        Set Column_Option       Item  1 to NoEnter  True
48019>>>>>>>>>>>>>        Procedure End_Construct_Object
48021>>>>>>>>>>>>>            Integer iDecimals
48022>>>>>>>>>>>>>            Forward Send End_Construct_Object
48024>>>>>>>>>>>>>            Get fiDekadika_Nomismatos SysCurXr.C_Code0   to    iDecimals
48025>>>>>>>>>>>>>            Set Points Item 6 to iDecimals
48026>>>>>>>>>>>>>            Set Numeric_Mask Item 6 to 14 iDecimals ' ,*'
48027>>>>>>>>>>>>>        End_Procedure
48028>>>>>>>>>>>>>        
48028>>>>>>>>>>>>>        
48028>>>>>>>>>>>>>        Procedure Activate
48030>>>>>>>>>>>>>            Send Keyaction to ButtonSub1
48031>>>>>>>>>>>>>            Forward Send Activate
48033>>>>>>>>>>>>>        End_procedure
48034>>>>>>>>>>>>>        
48034>>>>>>>>>>>>>        Procedure Activating
48036>>>>>>>>>>>>>            Forward Send Activating
48038>>>>>>>>>>>>>            Set Auto_Index_State to True
48039>>>>>>>>>>>>>        End_Procedure
48040>>>>>>>>>>>>>        
48040>>>>>>>>>>>>>        
48040>>>>>>>>>>>>>        
48040>>>>>>>>>>>>>        
48040>>>>>>>>>>>>>        //AB-StoreEnd
48040>>>>>>>>>>>>>
48040>>>>>>>>>>>>>    End_Object    // oSelList
48041>>>>>>>>>>>>>
48041>>>>>>>>>>>>>    Object cSyDateForm1 is a cSyDateForm
48043>>>>>>>>>>>>>        Set Size to 13 85
48044>>>>>>>>>>>>>        Set Location to 222 54
48045>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48046>>>>>>>>>>>>>        Set Label_Justification_Mode to jMode_Right
48047>>>>>>>>>>>>>        Set Form_Mask Item 0 to "d/M/yyyy"
48048>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48049>>>>>>>>>>>>>
48049>>>>>>>>>>>>>        //AB-StoreStart
48049>>>>>>>>>>>>>                                                                                                        
48049>>>>>>>>>>>>>        Procedure Key Integer iKey
48051>>>>>>>>>>>>>            Integer iRetVal
48052>>>>>>>>>>>>>            Forward Send Key iKey
48054>>>>>>>>>>>>>            If (iKey=277) Begin
48056>>>>>>>>>>>>>                Send Clear_Me
48057>>>>>>>>>>>>>            End
48057>>>>>>>>>>>>>>
48057>>>>>>>>>>>>>        End_Procedure
48058>>>>>>>>>>>>>        
48058>>>>>>>>>>>>>        Procedure Clear_Me
48060>>>>>>>>>>>>>            Set Value Item 0 to ''
48061>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
48062>>>>>>>>>>>>>        End_Procedure
48063>>>>>>>>>>>>>        
48063>>>>>>>>>>>>>        Procedure Exiting00000
48065>>>>>>>>>>>>>            Forward Send Exiting
48067>>>>>>>>>>>>>            Send KeyAction to ButtonSub1
48068>>>>>>>>>>>>>        End_procedure
48069>>>>>>>>>>>>>        
48069>>>>>>>>>>>>>        
48069>>>>>>>>>>>>>        
48069>>>>>>>>>>>>>        //AB-StoreEnd
48069>>>>>>>>>>>>>
48069>>>>>>>>>>>>>    End_Object    // cSyDateForm1
48070>>>>>>>>>>>>>
48070>>>>>>>>>>>>>    Object FormSub1 is a FormSub
48072>>>>>>>>>>>>>        Set Size to 13 85
48073>>>>>>>>>>>>>        Set Location to 236 54
48074>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48075>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48076>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48077>>>>>>>>>>>>>
48077>>>>>>>>>>>>>        //AB-StoreStart
48077>>>>>>>>>>>>>                                                                                                
48077>>>>>>>>>>>>>        Set Prompt_Object to (sl012(Self))
48078>>>>>>>>>>>>>        
48078>>>>>>>>>>>>>        Procedure Prompt
48080>>>>>>>>>>>>>            String sModule
48081>>>>>>>>>>>>>            Get psModule Of (sl012(Self)) to sModule
48082>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to (psModule(Self))
48083>>>>>>>>>>>>>            Forward Send Prompt
48085>>>>>>>>>>>>>            Set psModule Of (sl012(Self)) to sModule
48086>>>>>>>>>>>>>        End_Procedure
48087>>>>>>>>>>>>>        
48087>>>>>>>>>>>>>        Procedure OnChange
48089>>>>>>>>>>>>>            String s1
48090>>>>>>>>>>>>>            Get Value Item 0 to s1
48091>>>>>>>>>>>>>            Set Value Of FormSub3 Item 0 to (fsPtyppar(Self,s1))
48092>>>>>>>>>>>>>            Clear Ptypparl
48093>>>>>>>>>>>>>            Move Syscurxr.Company_Code  to ptypparl.Company_Code
48094>>>>>>>>>>>>>            Move Syscurxr.Branch_Code   to ptypparl.Branch_Code
48095>>>>>>>>>>>>>            Move s1                     to Ptypparl.Ptyppar_Code
48096>>>>>>>>>>>>>            Find Eq Ptypparl by index.1
48097>>>>>>>>>>>>>>
48097>>>>>>>>>>>>>            Set psPtyppar       to s1
48098>>>>>>>>>>>>>            Set psPtypparRecr   to Ptypparl.Ptyppar_Recr
48099>>>>>>>>>>>>>            Set psWtypkin       to PtypparL.Wtypkin_Code
48100>>>>>>>>>>>>>            Set psCtypkin       to PtypparL.Ctypkin_Code
48101>>>>>>>>>>>>>        End_Procedure
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        
48102>>>>>>>>>>>>>        //AB-StoreEnd
48102>>>>>>>>>>>>>
48102>>>>>>>>>>>>>    End_Object    // FormSub1
48103>>>>>>>>>>>>>
48103>>>>>>>>>>>>>    Object FormSub3 is a FormSub
48105>>>>>>>>>>>>>        Set Size to 13 195
48106>>>>>>>>>>>>>        Set Location to 236 145
48107>>>>>>>>>>>>>        Set Color to 12363657
48108>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48109>>>>>>>>>>>>>        Set Enabled_State to FALSE
48110>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48111>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
48112>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
48113>>>>>>>>>>>>>    End_Object    // FormSub3
48114>>>>>>>>>>>>>
48114>>>>>>>>>>>>>    Object FormSub2 is a FormSub
48116>>>>>>>>>>>>>        Set Size to 13 85
48117>>>>>>>>>>>>>        Set Location to 250 54
48118>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48119>>>>>>>>>>>>>        Set Prompt_Button_Mode to pb_PromptOn
48120>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48121>>>>>>>>>>>>>
48121>>>>>>>>>>>>>        //AB-StoreStart
48121>>>>>>>>>>>>>                                                                                                
48121>>>>>>>>>>>>>        Set Prompt_Object to (sl100(Self))
48122>>>>>>>>>>>>>        
48122>>>>>>>>>>>>>        Procedure Prompt
48124>>>>>>>>>>>>>            String sModule
48125>>>>>>>>>>>>>            Get psModule Of (sl100(Self)) to sModule
48126>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to (psModule(Self))
48127>>>>>>>>>>>>>            Forward Send Prompt
48129>>>>>>>>>>>>>            Set psModule Of (sl100(Self)) to sModule
48130>>>>>>>>>>>>>        End_Procedure
48131>>>>>>>>>>>>>        
48131>>>>>>>>>>>>>        Procedure OnChange
48133>>>>>>>>>>>>>            String s1
48134>>>>>>>>>>>>>            Get Value Item 0 to s1
48135>>>>>>>>>>>>>            Set Value Of FormSub4 Item 0 to (fsClient(Self,s1))
48136>>>>>>>>>>>>>            Set psClient to s1
48137>>>>>>>>>>>>>        End_Procedure
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        
48138>>>>>>>>>>>>>        //AB-StoreEnd
48138>>>>>>>>>>>>>
48138>>>>>>>>>>>>>    End_Object    // FormSub2
48139>>>>>>>>>>>>>
48139>>>>>>>>>>>>>    Object FormSub4 is a FormSub
48141>>>>>>>>>>>>>        Set Size to 13 195
48142>>>>>>>>>>>>>        Set Location to 250 145
48143>>>>>>>>>>>>>        Set Color to 12363657
48144>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48145>>>>>>>>>>>>>        Set Enabled_State to FALSE
48146>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48147>>>>>>>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
48148>>>>>>>>>>>>>        Set Shadow_State Item 0 to TRUE
48149>>>>>>>>>>>>>    End_Object    // FormSub4
48150>>>>>>>>>>>>>
48150>>>>>>>>>>>>>    Object FormSub5 is a FormSub
48152>>>>>>>>>>>>>        Set Size to 13 85
48153>>>>>>>>>>>>>        Set Location to 263 54
48154>>>>>>>>>>>>>        Set Label_Col_Offset to 2
48155>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48156>>>>>>>>>>>>>
48156>>>>>>>>>>>>>        //AB-StoreStart
48156>>>>>>>>>>>>>        Procedure OnChange
48158>>>>>>>>>>>>>            integer ino
48159>>>>>>>>>>>>>            Get Value Item 0 to ino
48160>>>>>>>>>>>>>            Set pino to ino
48161>>>>>>>>>>>>>        End_Procedure
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        
48162>>>>>>>>>>>>>        //AB-StoreEnd
48162>>>>>>>>>>>>>
48162>>>>>>>>>>>>>    End_Object    // FormSub5
48163>>>>>>>>>>>>>
48163>>>>>>>>>>>>>    Object TextBoxSub1 is a TextBoxSub
48165>>>>>>>>>>>>>        Set Label to "†£œ¨/¤å˜"
48166>>>>>>>>>>>>>        Set Color to 12363657
48167>>>>>>>>>>>>>        Set Location to 222 5
48168>>>>>>>>>>>>>        Set Size to 10 35
48169>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48170>>>>>>>>>>>>>    End_Object    // TextBoxSub1
48171>>>>>>>>>>>>>
48171>>>>>>>>>>>>>    Object TextBoxSub2 is a TextBoxSub
48173>>>>>>>>>>>>>        Set Label to "˜¨˜©«/¡æ"
48174>>>>>>>>>>>>>        Set Color to 12363657
48175>>>>>>>>>>>>>        Set Location to 237 4
48176>>>>>>>>>>>>>        Set Size to 10 41
48177>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48178>>>>>>>>>>>>>    End_Object    // TextBoxSub2
48179>>>>>>>>>>>>>
48179>>>>>>>>>>>>>    Object TextBoxSub3 is a TextBoxSub
48181>>>>>>>>>>>>>        Set Label to "”¦¨â˜ª"
48182>>>>>>>>>>>>>        Set Color to 12363657
48183>>>>>>>>>>>>>        Set Location to 252 4
48184>>>>>>>>>>>>>        Set Size to 10 31
48185>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48186>>>>>>>>>>>>>    End_Object    // TextBoxSub3
48187>>>>>>>>>>>>>
48187>>>>>>>>>>>>>    Object ButtonSub1 is a ButtonSub
48189>>>>>>>>>>>>>        Set Label to "œ¨ æ¨ ©œ"
48190>>>>>>>>>>>>>        Set Size to 13 50
48191>>>>>>>>>>>>>        Set Location to 252 355
48192>>>>>>>>>>>>>        Set Form_FontWeight Item 0 to 600
48193>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48194>>>>>>>>>>>>>
48194>>>>>>>>>>>>>        //AB-StoreStart
48194>>>>>>>>>>>>>                
48194>>>>>>>>>>>>>        Procedure OnClick
48196>>>>>>>>>>>>>            Send Rebuild_Constraints to Particle_DD
48197>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
48198>>>>>>>>>>>>>        End_Procedure // OnClick
48199>>>>>>>>>>>>>        
48199>>>>>>>>>>>>>        
48199>>>>>>>>>>>>>        
48199>>>>>>>>>>>>>        
48199>>>>>>>>>>>>>        
48199>>>>>>>>>>>>>        //AB-StoreEnd
48199>>>>>>>>>>>>>
48199>>>>>>>>>>>>>    End_Object    // ButtonSub1
48200>>>>>>>>>>>>>
48200>>>>>>>>>>>>>    Object oOk_bn is a ButtonSub
48202>>>>>>>>>>>>>
48202>>>>>>>>>>>>>        //AB-StoreTopStart
48202>>>>>>>>>>>>>                
48202>>>>>>>>>>>>>        //AB-StoreTopEnd
48202>>>>>>>>>>>>>
48202>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48203>>>>>>>>>>>>>        Set Location to 252 412
48204>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48205>>>>>>>>>>>>>
48205>>>>>>>>>>>>>        //AB-StoreStart
48205>>>>>>>>>>>>>                
48205>>>>>>>>>>>>>        Procedure OnClick
48207>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48208>>>>>>>>>>>>>        End_Procedure
48209>>>>>>>>>>>>>        
48209>>>>>>>>>>>>>        //AB-StoreEnd
48209>>>>>>>>>>>>>
48209>>>>>>>>>>>>>    End_Object    // oOk_bn
48210>>>>>>>>>>>>>
48210>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48212>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
48213>>>>>>>>>>>>>        Set Size to 13 50
48214>>>>>>>>>>>>>        Set Location to 252 466
48215>>>>>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
48216>>>>>>>>>>>>>
48216>>>>>>>>>>>>>        //AB-StoreStart
48216>>>>>>>>>>>>>        Procedure OnClick
48218>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48219>>>>>>>>>>>>>        End_Procedure
48220>>>>>>>>>>>>>        //AB-StoreEnd
48220>>>>>>>>>>>>>
48220>>>>>>>>>>>>>    End_Object    // oSearch_bn
48221>>>>>>>>>>>>>
48221>>>>>>>>>>>>>    Object TextBoxSub4 is a TextBoxSub
48223>>>>>>>>>>>>>        Set Label to "€¨ Ÿ£æª"
48224>>>>>>>>>>>>>        Set Color to 12363657
48225>>>>>>>>>>>>>        Set Location to 265 4
48226>>>>>>>>>>>>>        Set Size to 10 31
48227>>>>>>>>>>>>>        Set TypeFace to "MS Sans Serif"
48228>>>>>>>>>>>>>    End_Object    // TextBoxSub4
48229>>>>>>>>>>>>>
48229>>>>>>>>>>>>>
48229>>>>>>>>>>>>>    //AB-StoreStart
48229>>>>>>>>>>>>>                                
48229>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48230>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48231>>>>>>>>>>>>>    
48231>>>>>>>>>>>>>    Set Locate_Mode to Center_On_Screen
48232>>>>>>>>>>>>>    Set Modal_State to True
48233>>>>>>>>>>>>>    
48233>>>>>>>>>>>>>    Procedure Request_Cancel
48235>>>>>>>>>>>>>        Set Value Of cSyDateForm1 Item 0 to ''
48236>>>>>>>>>>>>>        Send Clear to Particle_DD
48237>>>>>>>>>>>>>        Forward Send Request_Cancel
48239>>>>>>>>>>>>>    End_Procedure
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    
48240>>>>>>>>>>>>>    //AB-StoreEnd
48240>>>>>>>>>>>>>
48240>>>>>>>>>>>>>End_Object    // sl014
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>//AB-StoreStart
48241>>>>>>>>>>>>>            
48241>>>>>>>>>>>>>            
48241>>>>>>>>>>>>>//AB-StoreEnd
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>//AB/ End_Object    // prj
48241>>>>>>>>>>>Use sl054.SL         // sl054
INCLUDING FILE: SL054.SL
48241>>>>>>>>>>>>>//AB/ Project sl054:cars
48241>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48241>>>>>>>>>>>>>//AB/     Set ProjectName to "sl054:cars"
48241>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl054.SL"
48241>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>// Project Object Structure
48241>>>>>>>>>>>>>//   sl054 is a dbModalPanelSub
48241>>>>>>>>>>>>>//     Cars_DD is a DataDictionary
48241>>>>>>>>>>>>>//     oSelList is a dbListSub
48241>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48241>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48241>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>// Register all objects
48241>>>>>>>>>>>>>Register_Object Cars_DD
48241>>>>>>>>>>>>>Register_Object oCancel_bn
48241>>>>>>>>>>>>>Register_Object oOK_bn
48241>>>>>>>>>>>>>Register_Object oSearch_bn
48241>>>>>>>>>>>>>Register_Object oSelList
48241>>>>>>>>>>>>>Register_Object sl054
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>//AB-IgnoreStart
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>Use DFAllEnt.pkg
48241>>>>>>>>>>>>>Use dbList.Sub
48241>>>>>>>>>>>>>Use Button.Sub
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>
48241>>>>>>>>>>>>>Use Cars.DD
INCLUDING FILE: CARS.DD
48241>>>>>>>>>>>>>>>//DDB-FileStart
48241>>>>>>>>>>>>>>>//DDB-HeaderStart
48241>>>>>>>>>>>>>>>
48241>>>>>>>>>>>>>>>// File Name : CARS.DD
48241>>>>>>>>>>>>>>>// Class Name: Cars_DataDictionary
48241>>>>>>>>>>>>>>>// Revision  : 16
48241>>>>>>>>>>>>>>>// Version   : 2
48241>>>>>>>>>>>>>>>
48241>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48241>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48241>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48241>>>>>>>>>>>>>>>
48241>>>>>>>>>>>>>>>Open Cars
48243>>>>>>>>>>>>>>>Open Gmove
48245>>>>>>>>>>>>>>>Open Sysrecg
48247>>>>>>>>>>>>>>>
48247>>>>>>>>>>>>>>>//DDB-HeaderEnd
48247>>>>>>>>>>>>>>>//DDB-ValidationStart
48247>>>>>>>>>>>>>>>
48247>>>>>>>>>>>>>>>Register_Object Cars_Ctype_Id_VT
48247>>>>>>>>>>>>>>>
48247>>>>>>>>>>>>>>>Object Cars_Ctype_Id_VT  is a CodeValidationTable
48249>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
48250>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
48251>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48252>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48252>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48252>>>>>>>>>>>>>>>End_Object   // Cars_Ctype_Id_VT
48253>>>>>>>>>>>>>>>//DDB-ValidationEnd
48253>>>>>>>>>>>>>>>//DDB-SelectionStart
48253>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl054  sl054.SL
48253>>>>>>>>>>>>>>>Register_Object sl054
48253>>>>>>>>>>>>>>>//DDB-SelectionEnd
48253>>>>>>>>>>>>>>>
48253>>>>>>>>>>>>>>>Class Cars_DataDictionary  is a DataDictionary_Sec
48254>>>>>>>>>>>>>>>
48254>>>>>>>>>>>>>>>
48254>>>>>>>>>>>>>>>    Procedure Construct_Object
48255>>>>>>>>>>>>>>>        Forward Send Construct_Object
48257>>>>>>>>>>>>>>>        //------------------------------------------------
48257>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48257>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
48257>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
48257>>>>>>>>>>>>>>>        //------------------------------------------------  
48257>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
48258>>>>>>>>>>>>>>>        Property Integer piAud_Old_Tare         Public  0
48259>>>>>>>>>>>>>>>        Property Number  pnAud_Old_Pagio        Public  0
48260>>>>>>>>>>>>>>>        Property String  psAud_Old_CarID        Public ""
48261>>>>>>>>>>>>>>>        Property String  psAud_Old_CarLicense   Public ""
48262>>>>>>>>>>>>>>>        //------------------------------------------------
48262>>>>>>>>>>>>>>>
48262>>>>>>>>>>>>>>>    End_procedure
48263>>>>>>>>>>>>>>>
48263>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
48264>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
48266>>>>>>>>>>>>>>>        //------------------------------------------------
48266>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48266>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
48266>>>>>>>>>>>>>>>        //------------------------------------------------
48266>>>>>>>>>>>>>>>        Set piAud_Old_Tare          to Cars.Car_Tare
48267>>>>>>>>>>>>>>>        Set pnAud_Old_Pagio         to Cars.Pagio
48268>>>>>>>>>>>>>>>        Set psAud_Old_CarID         to Cars.Car_ID
48269>>>>>>>>>>>>>>>        Set psAud_Old_CarLicense    to Cars.Car_License
48270>>>>>>>>>>>>>>>        //------------------------------------------------
48270>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
48271>>>>>>>>>>>>>>>
48271>>>>>>>>>>>>>>>    Procedure Delete_Main_File
48272>>>>>>>>>>>>>>>        //---------------------------------------------
48272>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48272>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48273>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48273>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48273>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48277>>>>>>>>>>>>>>>        Move iHour  to sHour
48278>>>>>>>>>>>>>>>        Move iMin   to sMin
48279>>>>>>>>>>>>>>>        Move iSec   to sSec
48280>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48284>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48288>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48292>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48293>>>>>>>>>>>>>>>        
48293>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
48293>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
48295>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48296>>>>>>>>>>>>>>>            clear gmove
48297>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
48298>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
48299>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
48300>>>>>>>>>>>>>>>            move  5                     to gmove.gtypkin_code// Apo Clients
48301>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
48302>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
48303>>>>>>>>>>>>>>>            move Cars.Car_ID            to gmove.garticl_recr
48304>>>>>>>>>>>>>>>            reread sysrecg
48308>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48309>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48310>>>>>>>>>>>>>>>            saverecord sysrecg
48311>>>>>>>>>>>>>>>            unlock
48312>>>>>>>>>>>>>>>>
48312>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
48313>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
48314>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
48315>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
48316>>>>>>>>>>>>>>>            
48316>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Partl_Recr          
48317>>>>>>>>>>>>>>>            Move Cars.Car_ID                    to Gmove.Pms_Recr          
48318>>>>>>>>>>>>>>>
48318>>>>>>>>>>>>>>>            Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro
48319>>>>>>>>>>>>>>>            Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1
48320>>>>>>>>>>>>>>>            Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma
48321>>>>>>>>>>>>>>>            Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
48322>>>>>>>>>>>>>>>
48322>>>>>>>>>>>>>>>
48322>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª Ž®ã£˜«¦ª"    to gmove.gmove_aitiol
48323>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
48324>>>>>>>>>>>>>>>            saverecord gmove
48325>>>>>>>>>>>>>>>        End
48325>>>>>>>>>>>>>>>>
48325>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
48327>>>>>>>>>>>>>>>
48327>>>>>>>>>>>>>>>    End_Procedure
48328>>>>>>>>>>>>>>>
48328>>>>>>>>>>>>>>>     Procedure Creating
48329>>>>>>>>>>>>>>>        Forward Send Creating
48331>>>>>>>>>>>>>>>        Set piCreateNew to 1
48332>>>>>>>>>>>>>>>    End_Procedure   // Creating
48333>>>>>>>>>>>>>>>
48333>>>>>>>>>>>>>>>
48333>>>>>>>>>>>>>>>
48333>>>>>>>>>>>>>>>
48333>>>>>>>>>>>>>>>    // Update:
48333>>>>>>>>>>>>>>>    Procedure Update
48334>>>>>>>>>>>>>>>        Forward Send Update
48336>>>>>>>>>>>>>>>        move syscurxr.company_code  to cars.car_company
48337>>>>>>>>>>>>>>>        move syscurxr.beto_site     to cars.car_bsite
48338>>>>>>>>>>>>>>>        // Insert Code Here
48338>>>>>>>>>>>>>>>        
48338>>>>>>>>>>>>>>>        //---------------------------------------------
48338>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48338>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48339>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48339>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48339>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48343>>>>>>>>>>>>>>>        Move iHour  to sHour
48344>>>>>>>>>>>>>>>        Move iMin   to sMin
48345>>>>>>>>>>>>>>>        Move iSec   to sSec
48346>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48350>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48354>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48358>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48359>>>>>>>>>>>>>>>        
48359>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
48359>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
48361>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48362>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
48364>>>>>>>>>>>>>>>                clear gmove
48365>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
48366>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
48367>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
48368>>>>>>>>>>>>>>>                move  5                     to gmove.gtypkin_code// Apo Clients
48369>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
48370>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
48371>>>>>>>>>>>>>>>                move Cars.Car_ID            to gmove.garticl_recr
48372>>>>>>>>>>>>>>>                reread sysrecg
48376>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48377>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48378>>>>>>>>>>>>>>>                saverecord sysrecg
48379>>>>>>>>>>>>>>>                unlock
48380>>>>>>>>>>>>>>>>
48380>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
48381>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
48382>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
48383>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
48384>>>>>>>>>>>>>>>
48384>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Partl_Recr          
48385>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Pms_Recr          
48386>>>>>>>>>>>>>>>
48386>>>>>>>>>>>>>>>                Move Cars.Car_Tare          to Gmove.Cur_Ox_Apobaro
48387>>>>>>>>>>>>>>>                Move Cars.Pagio             to Gmove.Cur_Stoxos1
48388>>>>>>>>>>>>>>>                Move Cars.Car_ID            to Gmove.Cur_Oxhma
48389>>>>>>>>>>>>>>>                Move Cars.Car_License       to Gmove.Cur_CN_Prosth
48390>>>>>>>>>>>>>>>                
48390>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª Ž®ã£˜«¦ª" to Gmove.Gmove_Aitiol
48391>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
48392>>>>>>>>>>>>>>>                saverecord gmove
48393>>>>>>>>>>>>>>>                Set piCreateNew to 0
48394>>>>>>>>>>>>>>>            End
48394>>>>>>>>>>>>>>>>
48394>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
48397>>>>>>>>>>>>>>>                Integer isChanged
48397>>>>>>>>>>>>>>>                Move 0 to isChanged
48398>>>>>>>>>>>>>>>                
48398>>>>>>>>>>>>>>>                     If (pnAud_Old_Pagio     (Self)<>Cars.Pagio        ) Move 1 to isChanged
48401>>>>>>>>>>>>>>>                Else If (piAud_Old_Tare      (Self)<>Cars.Car_Tare     ) Move 1 to isChanged
48405>>>>>>>>>>>>>>>                Else If (psAud_Old_CarID     (Self)<>Cars.Car_ID       ) Move 1 to isChanged
48409>>>>>>>>>>>>>>>                Else If (psAud_Old_CarLicense(Self)<>Cars.Car_License  ) Move 1 to isChanged
48413>>>>>>>>>>>>>>>                
48413>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
48415>>>>>>>>>>>>>>>                    clear gmove
48416>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
48417>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
48418>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
48419>>>>>>>>>>>>>>>                    move  5                     to gmove.gtypkin_code// Apo Clients
48420>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
48421>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
48422>>>>>>>>>>>>>>>                    move Cars.Car_ID          to gmove.garticl_recr
48423>>>>>>>>>>>>>>>                    reread sysrecg
48427>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48428>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48429>>>>>>>>>>>>>>>                    saverecord sysrecg
48430>>>>>>>>>>>>>>>                    unlock
48431>>>>>>>>>>>>>>>>
48431>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
48432>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
48433>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
48434>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
48435>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Partl_Recr          
48436>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Pms_Recr          
48437>>>>>>>>>>>>>>>                    //--                                
48437>>>>>>>>>>>>>>>                    Move Cars.Car_Tare                  to Gmove.Cur_Ox_Apobaro
48438>>>>>>>>>>>>>>>                    Move Cars.Pagio                     to Gmove.Cur_Stoxos1
48439>>>>>>>>>>>>>>>                    Move Cars.Car_ID                    to Gmove.Cur_Oxhma
48440>>>>>>>>>>>>>>>                    Move Cars.Car_License               to Gmove.Cur_CN_Prosth
48441>>>>>>>>>>>>>>>                    //--
48441>>>>>>>>>>>>>>>                    Move (piAud_Old_Tare      (Self))   to Gmove.Prev_Ox_Apobaro    
48442>>>>>>>>>>>>>>>                    Move (pnAud_Old_Pagio     (Self))   to Gmove.Prev_Stoxos1       
48443>>>>>>>>>>>>>>>                    Move (psAud_Old_CarID     (Self))   to Gmove.Prev_Oxhma         
48444>>>>>>>>>>>>>>>                    Move (psAud_Old_CarLicense(Self))   to Gmove.Prev_CN_Prosth
48445>>>>>>>>>>>>>>>                                                         
48445>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª Ž®ã£˜«¦ª"   to gmove.gmove_aitiol
48446>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
48447>>>>>>>>>>>>>>>                    saverecord gmove
48448>>>>>>>>>>>>>>>                    Set piCreateNew to 0
48449>>>>>>>>>>>>>>>                End
48449>>>>>>>>>>>>>>>>
48449>>>>>>>>>>>>>>>            End
48449>>>>>>>>>>>>>>>>
48449>>>>>>>>>>>>>>>        End
48449>>>>>>>>>>>>>>>>
48449>>>>>>>>>>>>>>>        
48449>>>>>>>>>>>>>>>    End_Procedure   // Update
48450>>>>>>>>>>>>>>>
48450>>>>>>>>>>>>>>>
48450>>>>>>>>>>>>>>>    // Define_Fields:
48450>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48450>>>>>>>>>>>>>>>
48450>>>>>>>>>>>>>>>    Procedure Define_Fields
48451>>>>>>>>>>>>>>>        Forward Send Define_Fields
48453>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48453>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48453>>>>>>>>>>>>>>>
48453>>>>>>>>>>>>>>>        Set Main_File            To Cars.File_Number
48454>>>>>>>>>>>>>>>
48454>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48455>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48456>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48457>>>>>>>>>>>>>>>
48457>>>>>>>>>>>>>>>        // External (System) file structure.............
48457>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
48458>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48459>>>>>>>>>>>>>>>
48459>>>>>>>>>>>>>>>        // Field-based properties.......................
48459>>>>>>>>>>>>>>>
48459>>>>>>>>>>>>>>>        // Cars.Car_Recnum
48459>>>>>>>>>>>>>>>
48459>>>>>>>>>>>>>>>        // Cars.Car_Company
48459>>>>>>>>>>>>>>>
48459>>>>>>>>>>>>>>>        // Cars.Car_Id
48459>>>>>>>>>>>>>>>        Set Field_Options          Field Cars.Car_Id To DD_AUTOFIND   
48460>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Id To (sl054(Self))
48461>>>>>>>>>>>>>>>        Set Key_Field_State        Field Cars.Car_Id To TRUE
48462>>>>>>>>>>>>>>>
48462>>>>>>>>>>>>>>>        // Cars.Car_Descr
48462>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Cars.Car_Descr To (sl054(Self))
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_License
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Driverrecn
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Details
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Maxm3
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Sitew
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Tare
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Codematch
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Driverid
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Sn
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Lastupdated
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Markexp
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_748tare1
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_748tare2
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_748sign
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Car_Bsite
48463>>>>>>>>>>>>>>>
48463>>>>>>>>>>>>>>>        // Cars.Ctype_Id
48463>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Cars.Ctype_Id To "dbComboFormsub"
48464>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Cars.Ctype_Id To (Cars_Ctype_Id_VT(Self))
48465>>>>>>>>>>>>>>>
48465>>>>>>>>>>>>>>>        // Cars.Pagio
48465>>>>>>>>>>>>>>>
48465>>>>>>>>>>>>>>>        // Cars.Parakrat
48465>>>>>>>>>>>>>>>
48465>>>>>>>>>>>>>>>        // Cars.Car_What
48465>>>>>>>>>>>>>>>
48465>>>>>>>>>>>>>>>        // Cars.Car_Lc
48465>>>>>>>>>>>>>>>
48465>>>>>>>>>>>>>>>        // Cars.Car_Ln
48465>>>>>>>>>>>>>>>
48465>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48465>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48466>>>>>>>>>>>>>>>
48466>>>>>>>>>>>>>>>    // Field_Defaults:
48466>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48466>>>>>>>>>>>>>>>
48466>>>>>>>>>>>>>>>    Procedure Field_Defaults
48467>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48469>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48469>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48469>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48469>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48470>>>>>>>>>>>>>>>
48470>>>>>>>>>>>>>>>End_Class    // Cars_DataDictionary
48471>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48471>>>>>>>>>>>>>>>
48471>>>>>>>>>>>>>>>Use sl054.SL         // sl054
48471>>>>>>>>>>>>>>>
48471>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
48471>>>>>>>>>>>>>>>//DDB-FileEnd
48471>>>>>>>>>>>>>
48471>>>>>>>>>>>>>//AB-IgnoreEnd
48471>>>>>>>>>>>>>
48471>>>>>>>>>>>>>Object sl054 is a dbModalPanelSub
48473>>>>>>>>>>>>>    Set Label to "€¨®œå¦ Ž®ž£á«à¤"
48474>>>>>>>>>>>>>    Set Size to 148 420
48475>>>>>>>>>>>>>    Set Location to 4 5
48476>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48477>>>>>>>>>>>>>    Set Modal_State to FALSE
48478>>>>>>>>>>>>>
48478>>>>>>>>>>>>>    //AB-DDOStart
48478>>>>>>>>>>>>>
48478>>>>>>>>>>>>>    Object Cars_DD is a Cars_DataDictionary
48480>>>>>>>>>>>>>    End_Object    // Cars_DD
48481>>>>>>>>>>>>>
48481>>>>>>>>>>>>>    Set Main_DD to (Cars_DD(self))
48482>>>>>>>>>>>>>    Set Server to (Cars_DD(self))
48483>>>>>>>>>>>>>
48483>>>>>>>>>>>>>    //AB-DDOEnd
48483>>>>>>>>>>>>>
48483>>>>>>>>>>>>>    Object oSelList is a dbListSub
48485>>>>>>>>>>>>>        Set Main_File to Cars.File_Number
48486>>>>>>>>>>>>>        Set Size to 105 403
48487>>>>>>>>>>>>>        Set Location to 6 6
48488>>>>>>>>>>>>>
48488>>>>>>>>>>>>>        Begin_Row
48491>>>>>>>>>>>>>            Entry_Item Cars.Car_id
48492>>>>>>>>>>>>>            Entry_Item Cars.Car_descr
48493>>>>>>>>>>>>>            Entry_Item Cars.Car_license
48494>>>>>>>>>>>>>            Entry_Item Cars.Car_maxm3
48495>>>>>>>>>>>>>            Entry_Item Cars.Car_driverid
48496>>>>>>>>>>>>>        End_Row
48501>>>>>>>>>>>>>
48501>>>>>>>>>>>>>        Set Form_Width    item 0 to 80
48502>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à›.Ž®ã£˜«¦ª"
48503>>>>>>>>>>>>>        
48503>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
48504>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48505>>>>>>>>>>>>>        
48505>>>>>>>>>>>>>        Set Form_Width    item 2 to 80
48506>>>>>>>>>>>>>        Set Header_Label  item 2 to "€¨ Ÿ.‰¬¡¢¦­¦¨å˜ª"
48507>>>>>>>>>>>>>        
48507>>>>>>>>>>>>>        Set Form_Width    item 3 to 50
48508>>>>>>>>>>>>>        Set Header_Label  item 3 to "Max.m3"
48509>>>>>>>>>>>>>        
48509>>>>>>>>>>>>>        Set Form_Width    item 4 to 65
48510>>>>>>>>>>>>>        Set Header_Label  item 4 to "‰à›.Ž›žš¦ç"
48511>>>>>>>>>>>>>        
48511>>>>>>>>>>>>>    End_Object    // oSelList
48512>>>>>>>>>>>>>
48512>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48514>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48515>>>>>>>>>>>>>        Set Location to 114 249
48516>>>>>>>>>>>>>
48516>>>>>>>>>>>>>        //AB-StoreStart
48516>>>>>>>>>>>>>        Procedure OnClick
48518>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48519>>>>>>>>>>>>>        End_Procedure
48520>>>>>>>>>>>>>        //AB-StoreEnd
48520>>>>>>>>>>>>>
48520>>>>>>>>>>>>>    End_Object    // oOK_bn
48521>>>>>>>>>>>>>
48521>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48523>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48524>>>>>>>>>>>>>        Set Location to 114 305
48525>>>>>>>>>>>>>
48525>>>>>>>>>>>>>        //AB-StoreStart
48525>>>>>>>>>>>>>        Procedure OnClick
48527>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48528>>>>>>>>>>>>>        End_Procedure
48529>>>>>>>>>>>>>        //AB-StoreEnd
48529>>>>>>>>>>>>>
48529>>>>>>>>>>>>>    End_Object    // oCancel_bn
48530>>>>>>>>>>>>>
48530>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48532>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
48533>>>>>>>>>>>>>        Set Location to 114 359
48534>>>>>>>>>>>>>
48534>>>>>>>>>>>>>        //AB-StoreStart
48534>>>>>>>>>>>>>        Procedure OnClick
48536>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48537>>>>>>>>>>>>>        End_Procedure
48538>>>>>>>>>>>>>        //AB-StoreEnd
48538>>>>>>>>>>>>>
48538>>>>>>>>>>>>>    End_Object    // oSearch_bn
48539>>>>>>>>>>>>>
48539>>>>>>>>>>>>>
48539>>>>>>>>>>>>>    //AB-StoreStart
48539>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48540>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48541>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48542>>>>>>>>>>>>>    //AB-StoreEnd
48542>>>>>>>>>>>>>
48542>>>>>>>>>>>>>End_Object    // sl054
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>//AB/ End_Object    // prj
48543>>>>>>>>>>>Use sl053.SL         // sl053
INCLUDING FILE: SL053.SL
48543>>>>>>>>>>>>>//AB/ Project sl053:pumps
48543>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48543>>>>>>>>>>>>>//AB/     Set ProjectName to "sl053:pumps"
48543>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl053.SL"
48543>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>// Project Object Structure
48543>>>>>>>>>>>>>//   sl053 is a dbModalPanelSub
48543>>>>>>>>>>>>>//     Pumps_DD is a DataDictionary
48543>>>>>>>>>>>>>//     oSelList is a dbListSub
48543>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48543>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48543>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>// Register all objects
48543>>>>>>>>>>>>>Register_Object oCancel_bn
48543>>>>>>>>>>>>>Register_Object oOK_bn
48543>>>>>>>>>>>>>Register_Object oSearch_bn
48543>>>>>>>>>>>>>Register_Object oSelList
48543>>>>>>>>>>>>>Register_Object Pumps_DD
48543>>>>>>>>>>>>>Register_Object sl053
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>//AB-IgnoreStart
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>Use DFAllEnt.pkg
48543>>>>>>>>>>>>>Use dbList.Sub
48543>>>>>>>>>>>>>Use Button.Sub
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>
48543>>>>>>>>>>>>>Use Pumps.DD
INCLUDING FILE: PUMPS.DD
48543>>>>>>>>>>>>>>>//DDB-FileStart
48543>>>>>>>>>>>>>>>//DDB-HeaderStart
48543>>>>>>>>>>>>>>>
48543>>>>>>>>>>>>>>>// File Name : PUMPS.DD
48543>>>>>>>>>>>>>>>// Class Name: Pumps_DataDictionary
48543>>>>>>>>>>>>>>>// Revision  : 18
48543>>>>>>>>>>>>>>>// Version   : 2
48543>>>>>>>>>>>>>>>
48543>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48543>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48543>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48543>>>>>>>>>>>>>>>
48543>>>>>>>>>>>>>>>Open Pumps
48545>>>>>>>>>>>>>>>Open Gmove
48547>>>>>>>>>>>>>>>Open Sysrecg
48549>>>>>>>>>>>>>>>
48549>>>>>>>>>>>>>>>//DDB-HeaderEnd
48549>>>>>>>>>>>>>>>//DDB-ValidationStart
48549>>>>>>>>>>>>>>>
48549>>>>>>>>>>>>>>>Register_Object Pumps_Ctype_Id_VT
48549>>>>>>>>>>>>>>>
48549>>>>>>>>>>>>>>>Object Pumps_Ctype_Id_VT  is a CodeValidationTable
48551>>>>>>>>>>>>>>>    Set Type_Value        To "PUMPSTYPE"
48552>>>>>>>>>>>>>>>    Set Validate_State    To FALSE
48553>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
48554>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
48554>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
48554>>>>>>>>>>>>>>>End_Object   // Pumps_Ctype_Id_VT
48555>>>>>>>>>>>>>>>//DDB-ValidationEnd
48555>>>>>>>>>>>>>>>//DDB-SelectionStart
48555>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl053  sl053.SL
48555>>>>>>>>>>>>>>>Register_Object sl053
48555>>>>>>>>>>>>>>>//DDB-SelectionEnd
48555>>>>>>>>>>>>>>>
48555>>>>>>>>>>>>>>>Class Pumps_DataDictionary  is a DataDictionary_Sec
48556>>>>>>>>>>>>>>>
48556>>>>>>>>>>>>>>>    Procedure Construct_Object
48557>>>>>>>>>>>>>>>        Forward Send Construct_Object
48559>>>>>>>>>>>>>>>        //------------------------------------------------
48559>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48559>>>>>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
48559>>>>>>>>>>>>>>>        // einai 1     js 03/12/2007
48559>>>>>>>>>>>>>>>        //------------------------------------------------  
48559>>>>>>>>>>>>>>>        Property Integer piCreateNew            Public  0
48560>>>>>>>>>>>>>>>        Property Number  pnAud_Old_M3           Public  0
48561>>>>>>>>>>>>>>>        Property Integer piAud_Old_Pagio        Public  0
48562>>>>>>>>>>>>>>>        Property String  psAud_Old_PumpID       Public ""
48563>>>>>>>>>>>>>>>        Property String  psAud_Old_License      Public ""
48564>>>>>>>>>>>>>>>        //------------------------------------------------
48564>>>>>>>>>>>>>>>
48564>>>>>>>>>>>>>>>    End_procedure
48565>>>>>>>>>>>>>>>
48565>>>>>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
48566>>>>>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
48568>>>>>>>>>>>>>>>        //------------------------------------------------
48568>>>>>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
48568>>>>>>>>>>>>>>>        // ton pedion js 03/12/2007
48568>>>>>>>>>>>>>>>        //------------------------------------------------
48568>>>>>>>>>>>>>>>        Set pnAud_Old_M3        to Pumps.PriceM3
48569>>>>>>>>>>>>>>>        Set piAud_Old_Pagio     to Pumps.PagioMin
48570>>>>>>>>>>>>>>>        Set psAud_Old_PumpID    to Pumps.Pump_ID
48571>>>>>>>>>>>>>>>        Set psAud_Old_License   to Pumps.Pump_License
48572>>>>>>>>>>>>>>>        //------------------------------------------------
48572>>>>>>>>>>>>>>>     End_Procedure   // New_Current_Record
48573>>>>>>>>>>>>>>>
48573>>>>>>>>>>>>>>>    Procedure Delete_Main_File
48574>>>>>>>>>>>>>>>        //---------------------------------------------
48574>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48574>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48575>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48575>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48575>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48579>>>>>>>>>>>>>>>        Move iHour  to sHour
48580>>>>>>>>>>>>>>>        Move iMin   to sMin
48581>>>>>>>>>>>>>>>        Move iSec   to sSec
48582>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48586>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48590>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48594>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48595>>>>>>>>>>>>>>>        
48595>>>>>>>>>>>>>>>        // Auditing / Diagrafh 
48595>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
48597>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48598>>>>>>>>>>>>>>>            clear gmove
48599>>>>>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
48600>>>>>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
48601>>>>>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
48602>>>>>>>>>>>>>>>            move  6                     to gmove.gtypkin_code// Apo Clients
48603>>>>>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
48604>>>>>>>>>>>>>>>            move suser                  to gmove.gplan_code
48605>>>>>>>>>>>>>>>            move Pumps.Pump_ID          to gmove.garticl_recr
48606>>>>>>>>>>>>>>>            reread sysrecg
48610>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48611>>>>>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48612>>>>>>>>>>>>>>>            saverecord sysrecg
48613>>>>>>>>>>>>>>>            unlock
48614>>>>>>>>>>>>>>>>
48614>>>>>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
48615>>>>>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
48616>>>>>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
48617>>>>>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
48618>>>>>>>>>>>>>>>            
48618>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
48619>>>>>>>>>>>>>>>            Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
48620>>>>>>>>>>>>>>>
48620>>>>>>>>>>>>>>>            Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Ant_Min_M3
48621>>>>>>>>>>>>>>>            Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Stoxos1
48622>>>>>>>>>>>>>>>            Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
48623>>>>>>>>>>>>>>>            Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
48624>>>>>>>>>>>>>>>
48624>>>>>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
48625>>>>>>>>>>>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
48626>>>>>>>>>>>>>>>            saverecord gmove
48627>>>>>>>>>>>>>>>        End
48627>>>>>>>>>>>>>>>>
48627>>>>>>>>>>>>>>>        Forward Send Delete_Main_File
48629>>>>>>>>>>>>>>>
48629>>>>>>>>>>>>>>>    End_Procedure
48630>>>>>>>>>>>>>>>
48630>>>>>>>>>>>>>>>     Procedure Creating
48631>>>>>>>>>>>>>>>        Forward Send Creating
48633>>>>>>>>>>>>>>>        Set piCreateNew to 1
48634>>>>>>>>>>>>>>>    End_Procedure   // Creating
48635>>>>>>>>>>>>>>>
48635>>>>>>>>>>>>>>>
48635>>>>>>>>>>>>>>>    // Update:
48635>>>>>>>>>>>>>>>    Procedure Update
48636>>>>>>>>>>>>>>>        Forward Send Update
48638>>>>>>>>>>>>>>>        Move SysCurXR.Company_Code  to Pumps.Pump_Company
48639>>>>>>>>>>>>>>>        Move SysCurXR.Beto_Site     to Pumps.Pump_SiteW
48640>>>>>>>>>>>>>>>
48640>>>>>>>>>>>>>>>
48640>>>>>>>>>>>>>>>        //---------------------------------------------
48640>>>>>>>>>>>>>>>        // Auditing / Katagrafh allagon
48640>>>>>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
48641>>>>>>>>>>>>>>>        Date    dDate  Shmer 
48641>>>>>>>>>>>>>>>        Integer iMin iHour iSec iLen
48641>>>>>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
48645>>>>>>>>>>>>>>>        Move iHour  to sHour
48646>>>>>>>>>>>>>>>        Move iMin   to sMin
48647>>>>>>>>>>>>>>>        Move iSec   to sSec
48648>>>>>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
48652>>>>>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
48656>>>>>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
48660>>>>>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
48661>>>>>>>>>>>>>>>        
48661>>>>>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
48661>>>>>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
48663>>>>>>>>>>>>>>>            Get fsLoginUserID to sUser
48664>>>>>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
48666>>>>>>>>>>>>>>>                clear gmove
48667>>>>>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
48668>>>>>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
48669>>>>>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
48670>>>>>>>>>>>>>>>                move  6                     to gmove.gtypkin_code// Apo Clients
48671>>>>>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
48672>>>>>>>>>>>>>>>                move suser                  to gmove.gplan_code
48673>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.garticl_recr
48674>>>>>>>>>>>>>>>                reread sysrecg
48678>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48679>>>>>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48680>>>>>>>>>>>>>>>                saverecord sysrecg
48681>>>>>>>>>>>>>>>                unlock
48682>>>>>>>>>>>>>>>>
48682>>>>>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
48683>>>>>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
48684>>>>>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
48685>>>>>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
48686>>>>>>>>>>>>>>>
48686>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Partl_Recr          
48687>>>>>>>>>>>>>>>                Move Pumps.Pump_ID         to Gmove.Pms_Recr          
48688>>>>>>>>>>>>>>>
48688>>>>>>>>>>>>>>>                move Pumps.Pump_ID          to gmove.Cur_Antlia
48689>>>>>>>>>>>>>>>                Move Pumps.PriceM3          to Gmove.Cur_Stoxos1
48690>>>>>>>>>>>>>>>                Move Pumps.PagioMin         to Gmove.Cur_Ant_Min_M3
48691>>>>>>>>>>>>>>>                Move Pumps.Pump_License     to Gmove.Cur_CN_Prosth
48692>>>>>>>>>>>>>>>
48692>>>>>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â˜ª €¤«¢å˜ª" to Gmove.Gmove_Aitiol
48693>>>>>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs  
48694>>>>>>>>>>>>>>>                saverecord gmove
48695>>>>>>>>>>>>>>>                Set piCreateNew to 0
48696>>>>>>>>>>>>>>>            End
48696>>>>>>>>>>>>>>>>
48696>>>>>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin                                
48699>>>>>>>>>>>>>>>                Integer isChanged
48699>>>>>>>>>>>>>>>                Move 0 to isChanged
48700>>>>>>>>>>>>>>>                
48700>>>>>>>>>>>>>>>                     If (pnAud_Old_M3      (Self)<>Pumps.PriceM3     ) Move 1 to isChanged
48703>>>>>>>>>>>>>>>                Else If (piAud_Old_Pagio   (Self)<>Pumps.PagioMin    ) Move 1 to isChanged
48707>>>>>>>>>>>>>>>                Else If (psAud_Old_PumpID  (Self)<>Pumps.Pump_ID     ) Move 1 to isChanged
48711>>>>>>>>>>>>>>>                Else If (psAud_Old_License (Self)<>Pumps.Pump_License) Move 1 to isChanged
48715>>>>>>>>>>>>>>>
48715>>>>>>>>>>>>>>>                If (isChanged>0) Begin  
48717>>>>>>>>>>>>>>>                    clear gmove
48718>>>>>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
48719>>>>>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
48720>>>>>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
48721>>>>>>>>>>>>>>>                    move  6                     to gmove.gtypkin_code// Apo Clients
48722>>>>>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
48723>>>>>>>>>>>>>>>                    move suser                  to gmove.gplan_code
48724>>>>>>>>>>>>>>>                    move Pumps.Pump_ID          to gmove.garticl_recr
48725>>>>>>>>>>>>>>>                    reread sysrecg
48729>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
48730>>>>>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
48731>>>>>>>>>>>>>>>                    saverecord sysrecg
48732>>>>>>>>>>>>>>>                    unlock
48733>>>>>>>>>>>>>>>>
48733>>>>>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
48734>>>>>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
48735>>>>>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
48736>>>>>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
48737>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Partl_Recr          
48738>>>>>>>>>>>>>>>                    Move Pumps.Pump_ID                  to Gmove.Pms_Recr          
48739>>>>>>>>>>>>>>>                    //--                                
48739>>>>>>>>>>>>>>>                    move Pumps.Pump_ID                  to gmove.Cur_Antlia
48740>>>>>>>>>>>>>>>                    Move Pumps.PriceM3                  to Gmove.Cur_Stoxos1
48741>>>>>>>>>>>>>>>                    Move Pumps.PagioMin                 to Gmove.Cur_Ant_Min_M3
48742>>>>>>>>>>>>>>>                    Move Pumps.Pump_License             to Gmove.Cur_CN_Prosth
48743>>>>>>>>>>>>>>>                    //--
48743>>>>>>>>>>>>>>>                    Move (pnAud_Old_M3     (Self))      to Gmove.Prev_Stoxos1      
48744>>>>>>>>>>>>>>>                    Move (piAud_Old_Pagio  (Self))      to Gmove.Prev_Ant_Min_M3   
48745>>>>>>>>>>>>>>>                    Move (psAud_Old_License(Self))      to Gmove.Prev_CN_Prosth
48746>>>>>>>>>>>>>>>                    Move (psAud_Old_PumpID (Self))      to Gmove.Prev_Antlia
48747>>>>>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª €¤«¢å˜ª"    to gmove.gmove_aitiol
48748>>>>>>>>>>>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
48749>>>>>>>>>>>>>>>                    saverecord gmove
48750>>>>>>>>>>>>>>>                    Set piCreateNew to 0
48751>>>>>>>>>>>>>>>                End
48751>>>>>>>>>>>>>>>>
48751>>>>>>>>>>>>>>>            End
48751>>>>>>>>>>>>>>>>
48751>>>>>>>>>>>>>>>        End
48751>>>>>>>>>>>>>>>>
48751>>>>>>>>>>>>>>>
48751>>>>>>>>>>>>>>>
48751>>>>>>>>>>>>>>>
48751>>>>>>>>>>>>>>>    End_Procedure   // Update
48752>>>>>>>>>>>>>>>
48752>>>>>>>>>>>>>>>
48752>>>>>>>>>>>>>>>    // Define_Fields:
48752>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48752>>>>>>>>>>>>>>>
48752>>>>>>>>>>>>>>>    Procedure Define_Fields
48753>>>>>>>>>>>>>>>        Forward Send Define_Fields
48755>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48755>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48755>>>>>>>>>>>>>>>
48755>>>>>>>>>>>>>>>        Set Main_File            To Pumps.File_Number
48756>>>>>>>>>>>>>>>
48756>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48757>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48758>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48759>>>>>>>>>>>>>>>
48759>>>>>>>>>>>>>>>        // External (System) file structure.............
48759>>>>>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
48760>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
48761>>>>>>>>>>>>>>>
48761>>>>>>>>>>>>>>>        // Field-based properties.......................
48761>>>>>>>>>>>>>>>
48761>>>>>>>>>>>>>>>        // Pumps.Pump_Recnum
48761>>>>>>>>>>>>>>>
48761>>>>>>>>>>>>>>>        // Pumps.Pump_Company
48761>>>>>>>>>>>>>>>
48761>>>>>>>>>>>>>>>        // Pumps.Pump_Id
48761>>>>>>>>>>>>>>>        Set Field_Options          Field Pumps.Pump_Id To DD_AUTOFIND   
48762>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Id To (sl053(Self))
48763>>>>>>>>>>>>>>>        Set Key_Field_State        Field Pumps.Pump_Id To TRUE
48764>>>>>>>>>>>>>>>
48764>>>>>>>>>>>>>>>        // Pumps.Pump_Descr
48764>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Pumps.Pump_Descr To (sl053(Self))
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_License
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkos
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_Mhkosch
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_Codematch
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_Sitew
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_Driver
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Pump_Bsite
48765>>>>>>>>>>>>>>>
48765>>>>>>>>>>>>>>>        // Pumps.Ctype_Id
48765>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Pumps.Ctype_Id To "dbComboFormsub"
48766>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Pumps.Ctype_Id To (Pumps_Ctype_Id_VT(Self))
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        // Pumps.Pagiomin
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        // Pumps.Pricem3
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        // Pumps.Parakrat
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        // Pumps.Pump_What
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        // Pumps.Pump_Lc
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        // Pumps.Pump_Ln
48767>>>>>>>>>>>>>>>
48767>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48767>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48768>>>>>>>>>>>>>>>
48768>>>>>>>>>>>>>>>    // Field_Defaults:
48768>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48768>>>>>>>>>>>>>>>
48768>>>>>>>>>>>>>>>    Procedure Field_Defaults
48769>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48771>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48771>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48771>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48771>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48772>>>>>>>>>>>>>>>
48772>>>>>>>>>>>>>>>End_Class    // Pumps_DataDictionary
48773>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48773>>>>>>>>>>>>>>>
48773>>>>>>>>>>>>>>>Use sl053.SL         // sl053
48773>>>>>>>>>>>>>>>
48773>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
48773>>>>>>>>>>>>>>>//DDB-FileEnd
48773>>>>>>>>>>>>>
48773>>>>>>>>>>>>>//AB-IgnoreEnd
48773>>>>>>>>>>>>>
48773>>>>>>>>>>>>>Object sl053 is a dbModalPanelSub
48775>>>>>>>>>>>>>    Set Label to "€¨®œå¦ €¤«¢ é¤"
48776>>>>>>>>>>>>>    Set Size to 148 325
48777>>>>>>>>>>>>>    Set Location to 4 5
48778>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48779>>>>>>>>>>>>>    Set Modal_State to FALSE
48780>>>>>>>>>>>>>
48780>>>>>>>>>>>>>    //AB-DDOStart
48780>>>>>>>>>>>>>
48780>>>>>>>>>>>>>    Object Pumps_DD is a Pumps_DataDictionary
48782>>>>>>>>>>>>>    End_Object    // Pumps_DD
48783>>>>>>>>>>>>>
48783>>>>>>>>>>>>>    Set Main_DD to (Pumps_DD(self))
48784>>>>>>>>>>>>>    Set Server to (Pumps_DD(self))
48785>>>>>>>>>>>>>
48785>>>>>>>>>>>>>    //AB-DDOEnd
48785>>>>>>>>>>>>>
48785>>>>>>>>>>>>>    Object oSelList is a dbListSub
48787>>>>>>>>>>>>>        Set Main_File to Pumps.File_Number
48788>>>>>>>>>>>>>        Set Size to 105 309
48789>>>>>>>>>>>>>        Set Location to 6 6
48790>>>>>>>>>>>>>
48790>>>>>>>>>>>>>        Begin_Row
48793>>>>>>>>>>>>>            Entry_Item Pumps.Pump_id
48794>>>>>>>>>>>>>            Entry_Item Pumps.Pump_descr
48795>>>>>>>>>>>>>            Entry_Item Pumps.Pump_license
48796>>>>>>>>>>>>>            Entry_Item Pumps.Pump_mhkos
48797>>>>>>>>>>>>>        End_Row
48802>>>>>>>>>>>>>
48802>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
48803>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª €¤«¢å˜ª"
48804>>>>>>>>>>>>>        
48804>>>>>>>>>>>>>        Set Form_Width    item 1 to 120
48805>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48806>>>>>>>>>>>>>        
48806>>>>>>>>>>>>>        Set Form_Width    item 2 to 65
48807>>>>>>>>>>>>>        Set Header_Label  item 2 to " ¤˜¡å›˜"
48808>>>>>>>>>>>>>        
48808>>>>>>>>>>>>>        Set Form_Width    item 3 to 46
48809>>>>>>>>>>>>>        Set Header_Label  item 3 to "‹ã¡¦ª"
48810>>>>>>>>>>>>>        
48810>>>>>>>>>>>>>    End_Object    // oSelList
48811>>>>>>>>>>>>>
48811>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48813>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48814>>>>>>>>>>>>>        Set Location to 114 157
48815>>>>>>>>>>>>>
48815>>>>>>>>>>>>>        //AB-StoreStart
48815>>>>>>>>>>>>>        Procedure OnClick
48817>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48818>>>>>>>>>>>>>        End_Procedure
48819>>>>>>>>>>>>>        //AB-StoreEnd
48819>>>>>>>>>>>>>
48819>>>>>>>>>>>>>    End_Object    // oOK_bn
48820>>>>>>>>>>>>>
48820>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48822>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48823>>>>>>>>>>>>>        Set Location to 114 212
48824>>>>>>>>>>>>>
48824>>>>>>>>>>>>>        //AB-StoreStart
48824>>>>>>>>>>>>>        Procedure OnClick
48826>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48827>>>>>>>>>>>>>        End_Procedure
48828>>>>>>>>>>>>>        //AB-StoreEnd
48828>>>>>>>>>>>>>
48828>>>>>>>>>>>>>    End_Object    // oCancel_bn
48829>>>>>>>>>>>>>
48829>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48831>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
48832>>>>>>>>>>>>>        Set Location to 114 267
48833>>>>>>>>>>>>>
48833>>>>>>>>>>>>>        //AB-StoreStart
48833>>>>>>>>>>>>>        Procedure OnClick
48835>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48836>>>>>>>>>>>>>        End_Procedure
48837>>>>>>>>>>>>>        //AB-StoreEnd
48837>>>>>>>>>>>>>
48837>>>>>>>>>>>>>    End_Object    // oSearch_bn
48838>>>>>>>>>>>>>
48838>>>>>>>>>>>>>
48838>>>>>>>>>>>>>    //AB-StoreStart
48838>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48839>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48840>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48841>>>>>>>>>>>>>    //AB-StoreEnd
48841>>>>>>>>>>>>>
48841>>>>>>>>>>>>>End_Object    // sl053
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>//AB/ End_Object    // prj
48842>>>>>>>>>>>Use sl064.SL         // sl064
INCLUDING FILE: SL064.SL
48842>>>>>>>>>>>>>//AB/ Project sl064 : Zones
48842>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48842>>>>>>>>>>>>>//AB/     Set ProjectName to "sl064 : Zones"
48842>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl064.SL"
48842>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>// Project Object Structure
48842>>>>>>>>>>>>>//   sl064 is a dbModalPanelSub
48842>>>>>>>>>>>>>//     Zones_DD is a DataDictionary
48842>>>>>>>>>>>>>//     oSelList is a dbListSub
48842>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48842>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48842>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>// Register all objects
48842>>>>>>>>>>>>>Register_Object oCancel_bn
48842>>>>>>>>>>>>>Register_Object oOK_bn
48842>>>>>>>>>>>>>Register_Object oSearch_bn
48842>>>>>>>>>>>>>Register_Object oSelList
48842>>>>>>>>>>>>>Register_Object sl064
48842>>>>>>>>>>>>>Register_Object Zones_DD
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>//AB-IgnoreStart
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>Use DFAllEnt.pkg
48842>>>>>>>>>>>>>Use dbList.Sub
48842>>>>>>>>>>>>>Use Button.Sub
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>
48842>>>>>>>>>>>>>Use ZONES.DD
INCLUDING FILE: ZONES.DD
48842>>>>>>>>>>>>>>>//DDB-FileStart
48842>>>>>>>>>>>>>>>//DDB-HeaderStart
48842>>>>>>>>>>>>>>>
48842>>>>>>>>>>>>>>>// File Name : ZONES.DD
48842>>>>>>>>>>>>>>>// Class Name: Zones_DataDictionary
48842>>>>>>>>>>>>>>>// Revision  : 4
48842>>>>>>>>>>>>>>>// Version   : 2
48842>>>>>>>>>>>>>>>
48842>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
48842>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48842>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48842>>>>>>>>>>>>>>>
48842>>>>>>>>>>>>>>>Open Zones
INCLUDING FILE: ZONES.FD
48844>>>>>>>>>>>>>>>Open Brzones
48846>>>>>>>>>>>>>>>
48846>>>>>>>>>>>>>>>//DDB-HeaderEnd
48846>>>>>>>>>>>>>>>//DDB-SelectionStart
48846>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl064  sl064.SL
48846>>>>>>>>>>>>>>>Register_Object sl064
48846>>>>>>>>>>>>>>>//DDB-SelectionEnd
48846>>>>>>>>>>>>>>>
48846>>>>>>>>>>>>>>>Class Zones_DataDictionary  is a DataDictionary_Sec
48847>>>>>>>>>>>>>>>
48847>>>>>>>>>>>>>>>    // Define_Fields:
48847>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48847>>>>>>>>>>>>>>>
48847>>>>>>>>>>>>>>>    Procedure Define_Fields
48848>>>>>>>>>>>>>>>        Forward Send Define_Fields
48850>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48850>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
48850>>>>>>>>>>>>>>>
48850>>>>>>>>>>>>>>>        Set Main_File            To Zones.File_Number
48851>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48852>>>>>>>>>>>>>>>
48852>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48853>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48854>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48855>>>>>>>>>>>>>>>
48855>>>>>>>>>>>>>>>        // Child (Client) file structure................
48855>>>>>>>>>>>>>>>        Send Add_Client_File  Brzones.File_Number
48856>>>>>>>>>>>>>>>
48856>>>>>>>>>>>>>>>        // Field-based properties.......................
48856>>>>>>>>>>>>>>>
48856>>>>>>>>>>>>>>>        // Zones.Zone_Id
48856>>>>>>>>>>>>>>>        Set Field_Options          Field Zones.Zone_Id To DD_AUTOFIND   
48857>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Id To (sl064(Self))
48858>>>>>>>>>>>>>>>        Set Key_Field_State        Field Zones.Zone_Id To TRUE
48859>>>>>>>>>>>>>>>
48859>>>>>>>>>>>>>>>        // Zones.Zone_Descr
48859>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Zones.Zone_Descr To (sl064(Self))
48860>>>>>>>>>>>>>>>
48860>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
48860>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
48861>>>>>>>>>>>>>>>
48861>>>>>>>>>>>>>>>    // Field_Defaults:
48861>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
48861>>>>>>>>>>>>>>>
48861>>>>>>>>>>>>>>>    Procedure Field_Defaults
48862>>>>>>>>>>>>>>>        Forward Send Field_Defaults
48864>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
48864>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
48864>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
48864>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
48865>>>>>>>>>>>>>>>
48865>>>>>>>>>>>>>>>End_Class    // Zones_DataDictionary
48866>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
48866>>>>>>>>>>>>>>>
48866>>>>>>>>>>>>>>>Use sl064.SL         // sl064
48866>>>>>>>>>>>>>>>
48866>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
48866>>>>>>>>>>>>>>>//DDB-FileEnd
48866>>>>>>>>>>>>>
48866>>>>>>>>>>>>>//AB-IgnoreEnd
48866>>>>>>>>>>>>>
48866>>>>>>>>>>>>>CD_Popup_Object sl064 is a dbModalPanelSub
48885>>>>>>>>>>>>>    Set Label to "…é¤œª"
48886>>>>>>>>>>>>>    Set Size to 148 297
48887>>>>>>>>>>>>>    Set Location to 4 5
48888>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
48889>>>>>>>>>>>>>    Set Modal_State to FALSE
48890>>>>>>>>>>>>>
48890>>>>>>>>>>>>>    //AB-DDOStart
48890>>>>>>>>>>>>>
48890>>>>>>>>>>>>>    Object Zones_DD is a Zones_DataDictionary
48892>>>>>>>>>>>>>    End_Object    // Zones_DD
48893>>>>>>>>>>>>>
48893>>>>>>>>>>>>>    Set Main_DD to (Zones_DD(self))
48894>>>>>>>>>>>>>    Set Server to (Zones_DD(self))
48895>>>>>>>>>>>>>
48895>>>>>>>>>>>>>    //AB-DDOEnd
48895>>>>>>>>>>>>>
48895>>>>>>>>>>>>>    Object oSelList is a dbListSub
48897>>>>>>>>>>>>>        Set Main_File to Zones.File_Number
48898>>>>>>>>>>>>>        Set Size to 105 280
48899>>>>>>>>>>>>>        Set Location to 6 6
48900>>>>>>>>>>>>>
48900>>>>>>>>>>>>>        Begin_Row
48903>>>>>>>>>>>>>            Entry_Item Zones.Zone_id
48904>>>>>>>>>>>>>            Entry_Item Zones.Zone_descr
48905>>>>>>>>>>>>>        End_Row
48910>>>>>>>>>>>>>
48910>>>>>>>>>>>>>        Set Form_Width    item 0 to 73
48911>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
48912>>>>>>>>>>>>>        
48912>>>>>>>>>>>>>        Set Form_Width    item 1 to 199
48913>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
48914>>>>>>>>>>>>>        
48914>>>>>>>>>>>>>    End_Object    // oSelList
48915>>>>>>>>>>>>>
48915>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
48917>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
48918>>>>>>>>>>>>>        Set Location to 115 126
48919>>>>>>>>>>>>>
48919>>>>>>>>>>>>>        //AB-StoreStart
48919>>>>>>>>>>>>>        Procedure OnClick
48921>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
48922>>>>>>>>>>>>>        End_Procedure
48923>>>>>>>>>>>>>        //AB-StoreEnd
48923>>>>>>>>>>>>>
48923>>>>>>>>>>>>>    End_Object    // oOK_bn
48924>>>>>>>>>>>>>
48924>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
48926>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
48927>>>>>>>>>>>>>        Set Location to 115 181
48928>>>>>>>>>>>>>
48928>>>>>>>>>>>>>        //AB-StoreStart
48928>>>>>>>>>>>>>        Procedure OnClick
48930>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
48931>>>>>>>>>>>>>        End_Procedure
48932>>>>>>>>>>>>>        //AB-StoreEnd
48932>>>>>>>>>>>>>
48932>>>>>>>>>>>>>    End_Object    // oCancel_bn
48933>>>>>>>>>>>>>
48933>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
48935>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
48936>>>>>>>>>>>>>        Set Location to 115 236
48937>>>>>>>>>>>>>
48937>>>>>>>>>>>>>        //AB-StoreStart
48937>>>>>>>>>>>>>        Procedure OnClick
48939>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
48940>>>>>>>>>>>>>        End_Procedure
48941>>>>>>>>>>>>>        //AB-StoreEnd
48941>>>>>>>>>>>>>
48941>>>>>>>>>>>>>    End_Object    // oSearch_bn
48942>>>>>>>>>>>>>
48942>>>>>>>>>>>>>
48942>>>>>>>>>>>>>    //AB-StoreStart
48942>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
48943>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
48944>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
48945>>>>>>>>>>>>>    //AB-StoreEnd
48945>>>>>>>>>>>>>
48945>>>>>>>>>>>>>CD_End_Object    // sl064
48947>>>>>>>>>>>>>>
48947>>>>>>>>>>>>>
48947>>>>>>>>>>>>>//AB/ End_Object    // prj
48947>>>>>>>>>>>
48947>>>>>>>>>>>//DDB-Selection-pkg-End
48947>>>>>>>>>>>//DDB-FileEnd
48947>>>>>>>>>    Use WAPOKAT.DD
INCLUDING FILE: WAPOKAT.DD
48947>>>>>>>>>>>//DDB-FileStart
48947>>>>>>>>>>>//DDB-HeaderStart
48947>>>>>>>>>>>
48947>>>>>>>>>>>// File Name : WAPOKAT.DD
48947>>>>>>>>>>>// Class Name: Wapokat_DataDictionary
48947>>>>>>>>>>>// Revision  : 21
48947>>>>>>>>>>>// Version   : 2
48947>>>>>>>>>>>
48947>>>>>>>>>>>Use  Windows           // Basic Definitions
48947>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
48947>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
48947>>>>>>>>>>>
48947>>>>>>>>>>>Open Wapokat
INCLUDING FILE: WAPOKAT.FD
48949>>>>>>>>>>>Open Wapomast
INCLUDING FILE: WAPOMAST.FD
48951>>>>>>>>>>>Open Sysrecw
48953>>>>>>>>>>>Open Syscurxr
48955>>>>>>>>>>>
48955>>>>>>>>>>>//DDB-HeaderEnd
48955>>>>>>>>>>>//DDB-SelectionStart
48955>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
48955>>>>>>>>>>>Register_Object sl022
48955>>>>>>>>>>>//DDB-SelectionEnd
48955>>>>>>>>>>>
48955>>>>>>>>>>>Class Wapokat_DataDictionary  is a DataDictionary
48956>>>>>>>>>>>
48956>>>>>>>>>>>    // Update:
48956>>>>>>>>>>>    Procedure Update
48957>>>>>>>>>>>        Forward Send Update
48959>>>>>>>>>>>        // Insert Code Here
48959>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapokat.Company_Code
48959>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapokat.Branch_Code
48959>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapokat.Year_Year
48959>>>>>>>>>>>    End_Procedure   // Update
48960>>>>>>>>>>> 
48960>>>>>>>>>>>     Procedure Creating
48961>>>>>>>>>>>        Forward Send Creating
48963>>>>>>>>>>>        // Insert Code Here
48963>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapokat.Wapokat_Rec0)))))) to Wapokat.Wapokat_Recr
48964>>>>>>>>>>>    End_Procedure   // Creating
48965>>>>>>>>>>>
48965>>>>>>>>>>>
48965>>>>>>>>>>>    // Define_Fields:
48965>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
48965>>>>>>>>>>>
48965>>>>>>>>>>>    Procedure Define_Fields
48966>>>>>>>>>>>        Forward Send Define_Fields
48968>>>>>>>>>>>        //DDB-Generated-Code-Location
48968>>>>>>>>>>>        //DDB-DefineFieldStart
48968>>>>>>>>>>>
48968>>>>>>>>>>>        Set Main_File            To Wapokat.File_Number
48969>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
48970>>>>>>>>>>>
48970>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
48971>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
48972>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
48973>>>>>>>>>>>
48973>>>>>>>>>>>        // Child (Client) file structure................
48973>>>>>>>>>>>        Send Add_Client_File  Wapomast.File_Number
48974>>>>>>>>>>>
48974>>>>>>>>>>>        // External (System) file structure.............
48974>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
48975>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
48976>>>>>>>>>>>
48976>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapokat_Rec0  To Wapokat.Wapokat_Rec0
48979>>>>>>>>>>>
48979>>>>>>>>>>>        // Field-based properties.......................
48979>>>>>>>>>>>
48979>>>>>>>>>>>        // Wapokat.Wapokat_Code
48979>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Code To DD_AUTOFIND   
48980>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Code To (sl022(Self))
48981>>>>>>>>>>>
48981>>>>>>>>>>>        // Wapokat.Wapokat_Rec0
48981>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Rec0 To DD_AUTOFIND   
48982>>>>>>>>>>>
48982>>>>>>>>>>>        // Wapokat.Wapokat_Descr
48982>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapokat.Wapokat_Descr To (sl022(Self))
48983>>>>>>>>>>>
48983>>>>>>>>>>>        // Wapokat.Wapokat_Recr
48983>>>>>>>>>>>        Set Field_Options          Field Wapokat.Wapokat_Recr To DD_AUTOFIND   
48984>>>>>>>>>>>
48984>>>>>>>>>>>        // Wapokat.Enhm_Sap
48984>>>>>>>>>>>
48984>>>>>>>>>>>        // Wapokat.Sap_Descr
48984>>>>>>>>>>>
48984>>>>>>>>>>>        // Wapokat.Gl
48984>>>>>>>>>>>
48984>>>>>>>>>>>        // Wapokat.Glzz
48984>>>>>>>>>>>
48984>>>>>>>>>>>        // Wapokat.Oximm1
48984>>>>>>>>>>>
48984>>>>>>>>>>>        //DDB-DefineFieldEnd
48984>>>>>>>>>>>    End_Procedure    // Define_Fields
48985>>>>>>>>>>>
48985>>>>>>>>>>>    // Field_Defaults:
48985>>>>>>>>>>>    // This procedure is used to establish default field values.
48985>>>>>>>>>>>
48985>>>>>>>>>>>    Procedure Field_Defaults
48986>>>>>>>>>>>        Forward Send Field_Defaults
48988>>>>>>>>>>>        //DDB-Generated-Code-Location
48988>>>>>>>>>>>        //DDB-FieldDefaultStart
48988>>>>>>>>>>>        //DDB-FieldDefaultEnd
48988>>>>>>>>>>>    End_Procedure    // Field_Defaults
48989>>>>>>>>>>>
48989>>>>>>>>>>>End_Class    // Wapokat_DataDictionary
48990>>>>>>>>>>>//DDB-Selection-pkg-Start
48990>>>>>>>>>>>
48990>>>>>>>>>>>Use sl022.SL         // sl022
INCLUDING FILE: SL022.SL
48990>>>>>>>>>>>>>//AB/ Project sl022:kathg-apothkon
48990>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
48990>>>>>>>>>>>>>//AB/     Set ProjectName to "sl022:kathg-apothkon"
48990>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl022.SL"
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>// Project Object Structure
48990>>>>>>>>>>>>>//   sl022 is a dbModalPanelSub
48990>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
48990>>>>>>>>>>>>>//     oSelList is a dbListSub
48990>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
48990>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
48990>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>// Register all objects
48990>>>>>>>>>>>>>Register_Object oCancel_bn
48990>>>>>>>>>>>>>Register_Object oOK_bn
48990>>>>>>>>>>>>>Register_Object oSearch_bn
48990>>>>>>>>>>>>>Register_Object oSelList
48990>>>>>>>>>>>>>Register_Object sl022
48990>>>>>>>>>>>>>Register_Object Wapokat_DD
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>//AB-IgnoreStart
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>Use DFAllEnt.pkg
48990>>>>>>>>>>>>>Use dbList.Sub
48990>>>>>>>>>>>>>Use Button.Sub
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>Use WAPOKAT.DD
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>//AB-IgnoreEnd
48990>>>>>>>>>>>>>
48990>>>>>>>>>>>>>CD_Popup_Object sl022 is a dbModalPanelSub
49009>>>>>>>>>>>>>    set label to "‰˜«žš¦¨åœª €§¦Ÿž¡é¤" 
49010>>>>>>>>>>>>>    Set Size to 148 297
49011>>>>>>>>>>>>>    Set Location to 12 19
49012>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49013>>>>>>>>>>>>>    Set Modal_State to FALSE
49014>>>>>>>>>>>>>
49014>>>>>>>>>>>>>    //AB-DDOStart
49014>>>>>>>>>>>>>
49014>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
49016>>>>>>>>>>>>>    End_Object    // Wapokat_DD
49017>>>>>>>>>>>>>
49017>>>>>>>>>>>>>    Set Main_DD to (Wapokat_DD(self))
49018>>>>>>>>>>>>>    Set Server to (Wapokat_DD(self))
49019>>>>>>>>>>>>>
49019>>>>>>>>>>>>>    //AB-DDOEnd
49019>>>>>>>>>>>>>
49019>>>>>>>>>>>>>    Object oSelList is a dbListSub
49021>>>>>>>>>>>>>        Set Main_File to Wapokat.File_Number
49022>>>>>>>>>>>>>        Set Size to 105 280
49023>>>>>>>>>>>>>        Set Location to 6 6
49024>>>>>>>>>>>>>
49024>>>>>>>>>>>>>        Begin_Row
49027>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_code
49028>>>>>>>>>>>>>            Entry_Item Wapokat.Wapokat_descr
49029>>>>>>>>>>>>>        End_Row
49034>>>>>>>>>>>>>
49034>>>>>>>>>>>>>        Set Form_Width    item 0 to 42
49035>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
49036>>>>>>>>>>>>>        
49036>>>>>>>>>>>>>        Set Form_Width    item 1 to 228
49037>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49038>>>>>>>>>>>>>        
49038>>>>>>>>>>>>>    End_Object    // oSelList
49039>>>>>>>>>>>>>
49039>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49041>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49042>>>>>>>>>>>>>        Set Location to 115 126
49043>>>>>>>>>>>>>
49043>>>>>>>>>>>>>        //AB-StoreStart
49043>>>>>>>>>>>>>        Procedure OnClick
49045>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49046>>>>>>>>>>>>>        End_Procedure
49047>>>>>>>>>>>>>        //AB-StoreEnd
49047>>>>>>>>>>>>>
49047>>>>>>>>>>>>>    End_Object    // oOK_bn
49048>>>>>>>>>>>>>
49048>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49050>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49051>>>>>>>>>>>>>        Set Location to 115 181
49052>>>>>>>>>>>>>
49052>>>>>>>>>>>>>        //AB-StoreStart
49052>>>>>>>>>>>>>        Procedure OnClick
49054>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49055>>>>>>>>>>>>>        End_Procedure
49056>>>>>>>>>>>>>        //AB-StoreEnd
49056>>>>>>>>>>>>>
49056>>>>>>>>>>>>>    End_Object    // oCancel_bn
49057>>>>>>>>>>>>>
49057>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49059>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49060>>>>>>>>>>>>>        Set Location to 115 236
49061>>>>>>>>>>>>>
49061>>>>>>>>>>>>>        //AB-StoreStart
49061>>>>>>>>>>>>>        Procedure OnClick
49063>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49064>>>>>>>>>>>>>        End_Procedure
49065>>>>>>>>>>>>>        //AB-StoreEnd
49065>>>>>>>>>>>>>
49065>>>>>>>>>>>>>    End_Object    // oSearch_bn
49066>>>>>>>>>>>>>
49066>>>>>>>>>>>>>
49066>>>>>>>>>>>>>    //AB-StoreStart
49066>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49067>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49068>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49069>>>>>>>>>>>>>    //AB-StoreEnd
49069>>>>>>>>>>>>>
49069>>>>>>>>>>>>>CD_End_Object    // sl022
49071>>>>>>>>>>>>>>
49071>>>>>>>>>>>>>
49071>>>>>>>>>>>>>//AB/ End_Object    // prj
49071>>>>>>>>>>>
49071>>>>>>>>>>>//DDB-Selection-pkg-End
49071>>>>>>>>>>>//DDB-FileEnd
49071>>>>>>>>>    Use WAPOMAST.DD
INCLUDING FILE: WAPOMAST.DD
49071>>>>>>>>>>>//DDB-FileStart
49071>>>>>>>>>>>//DDB-HeaderStart
49071>>>>>>>>>>>
49071>>>>>>>>>>>// File Name : WAPOMAST.DD
49071>>>>>>>>>>>// Class Name: Wapomast_DataDictionary
49071>>>>>>>>>>>// Revision  : 13
49071>>>>>>>>>>>// Version   : 2
49071>>>>>>>>>>>
49071>>>>>>>>>>>Use  Windows           // Basic Definitions
49071>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49071>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49071>>>>>>>>>>>
49071>>>>>>>>>>>Open Wapomast
49073>>>>>>>>>>>Open Wax
49075>>>>>>>>>>>Open Wapokat
49077>>>>>>>>>>>Open Sysrecw
49079>>>>>>>>>>>
49079>>>>>>>>>>>//DDB-HeaderEnd
49079>>>>>>>>>>>//DDB-SelectionStart
49079>>>>>>>>>>>//DDB/ ExternalSelectionList sl023  sl023.SL
49079>>>>>>>>>>>Register_Object sl023
49079>>>>>>>>>>>//DDB-SelectionEnd
49079>>>>>>>>>>>
49079>>>>>>>>>>>Class Wapomast_DataDictionary  is a DataDictionary
49080>>>>>>>>>>>    // Update:
49080>>>>>>>>>>>    Procedure Update
49081>>>>>>>>>>>        Forward Send Update
49083>>>>>>>>>>>        // Insert Code Here
49083>>>>>>>>>>>//        Move SysCurXR.Company_Code   to Wapomast.Company_Code
49083>>>>>>>>>>>//        Move SysCurXR.Branch_Code     to Wapomast.Branch_Code
49083>>>>>>>>>>>//        Move SysCurXR.Year_Year         to Wapomast.Year_Year
49083>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wapomast.Wapokat_Code
49084>>>>>>>>>>>    End_Procedure   // Update
49085>>>>>>>>>>> 
49085>>>>>>>>>>>     Procedure Creating
49086>>>>>>>>>>>        Forward Send Creating
49088>>>>>>>>>>>        // Insert Code Here
49088>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wapomast.Wapomast_Rec0)))))) to Wapomast.Wapomast_Recr
49089>>>>>>>>>>>    End_Procedure   // Creating
49090>>>>>>>>>>>
49090>>>>>>>>>>>
49090>>>>>>>>>>>    // Define_Fields:
49090>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49090>>>>>>>>>>>
49090>>>>>>>>>>>    Procedure Define_Fields
49091>>>>>>>>>>>        Forward Send Define_Fields
49093>>>>>>>>>>>        //DDB-Generated-Code-Location
49093>>>>>>>>>>>        //DDB-DefineFieldStart
49093>>>>>>>>>>>
49093>>>>>>>>>>>        Set Main_File            To Wapomast.File_Number
49094>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49095>>>>>>>>>>>
49095>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49096>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49097>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49098>>>>>>>>>>>
49098>>>>>>>>>>>        // Child (Client) file structure................
49098>>>>>>>>>>>        Send Add_Client_File  Wax.File_Number
49099>>>>>>>>>>>
49099>>>>>>>>>>>        // Parent (Server) file structure...............
49099>>>>>>>>>>>        Send Add_Server_File  Wapokat.File_Number
49100>>>>>>>>>>>
49100>>>>>>>>>>>        // External (System) file structure.............
49100>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49101>>>>>>>>>>>
49101>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wapomast_Rec0  To Wapomast.Wapomast_Rec0
49104>>>>>>>>>>>
49104>>>>>>>>>>>        // Field-based properties.......................
49104>>>>>>>>>>>
49104>>>>>>>>>>>        // Wapomast.Wapokat_Code
49104>>>>>>>>>>>
49104>>>>>>>>>>>        // Wapomast.Wapokat_Recr
49104>>>>>>>>>>>
49104>>>>>>>>>>>        // Wapomast.Wapomast_Code
49104>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Code To DD_AUTOFIND   
49105>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Code To (sl023(Self))
49106>>>>>>>>>>>
49106>>>>>>>>>>>        // Wapomast.Wapomast_Rec0
49106>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Rec0 To DD_AUTOFIND   
49107>>>>>>>>>>>
49107>>>>>>>>>>>        // Wapomast.Wapomast_Descr
49107>>>>>>>>>>>        Set Field_Prompt_Object    Field Wapomast.Wapomast_Descr To (sl023(Self))
49108>>>>>>>>>>>
49108>>>>>>>>>>>        // Wapomast.Wapomast_Recr
49108>>>>>>>>>>>        Set Field_Options          Field Wapomast.Wapomast_Recr To DD_AUTOFIND   
49109>>>>>>>>>>>
49109>>>>>>>>>>>        //DDB-DefineFieldEnd
49109>>>>>>>>>>>    End_Procedure    // Define_Fields
49110>>>>>>>>>>>
49110>>>>>>>>>>>    // Field_Defaults:
49110>>>>>>>>>>>    // This procedure is used to establish default field values.
49110>>>>>>>>>>>
49110>>>>>>>>>>>    Procedure Field_Defaults
49111>>>>>>>>>>>        Forward Send Field_Defaults
49113>>>>>>>>>>>        //DDB-Generated-Code-Location
49113>>>>>>>>>>>        //DDB-FieldDefaultStart
49113>>>>>>>>>>>        //DDB-FieldDefaultEnd
49113>>>>>>>>>>>    End_Procedure    // Field_Defaults
49114>>>>>>>>>>>
49114>>>>>>>>>>>End_Class    // Wapomast_DataDictionary
49115>>>>>>>>>>>//DDB-Selection-pkg-Start
49115>>>>>>>>>>>
49115>>>>>>>>>>>Use sl023.SL         // sl023
INCLUDING FILE: SL023.SL
49115>>>>>>>>>>>>>//AB/ Project sl023:apothkes
49115>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49115>>>>>>>>>>>>>//AB/     Set ProjectName to "sl023:apothkes"
49115>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl023.SL"
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>// Project Object Structure
49115>>>>>>>>>>>>>//   sl023 is a dbModalPanelSub
49115>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
49115>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
49115>>>>>>>>>>>>>//     oSelList is a dbListSub
49115>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49115>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49115>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>// Register all objects
49115>>>>>>>>>>>>>Register_Object oCancel_bn
49115>>>>>>>>>>>>>Register_Object oOK_bn
49115>>>>>>>>>>>>>Register_Object oSearch_bn
49115>>>>>>>>>>>>>Register_Object oSelList
49115>>>>>>>>>>>>>Register_Object sl023
49115>>>>>>>>>>>>>Register_Object Wapokat_DD
49115>>>>>>>>>>>>>Register_Object Wapomast_DD
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>//AB-IgnoreStart
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>Use DFAllEnt.pkg
49115>>>>>>>>>>>>>Use dbList.Sub
49115>>>>>>>>>>>>>Use Button.Sub
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>Use WAPOKAT.DD
49115>>>>>>>>>>>>>Use WAPOMAST.DD
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>//AB-IgnoreEnd
49115>>>>>>>>>>>>>
49115>>>>>>>>>>>>>Object sl023 is a dbModalPanelSub
49117>>>>>>>>>>>>>
49117>>>>>>>>>>>>>    //AB-StoreTopStart
49117>>>>>>>>>>>>>    property string psapokat public ''
49119>>>>>>>>>>>>>    //AB-StoreTopEnd
49119>>>>>>>>>>>>>
49119>>>>>>>>>>>>>    Set Label to "€§¦Ÿã¡œª"
49120>>>>>>>>>>>>>    Set Size to 126 260
49121>>>>>>>>>>>>>    Set Location to 4 19
49122>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49123>>>>>>>>>>>>>    Set Modal_State to FALSE
49124>>>>>>>>>>>>>
49124>>>>>>>>>>>>>    //AB-DDOStart
49124>>>>>>>>>>>>>
49124>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
49126>>>>>>>>>>>>>    End_Object    // Wapokat_DD
49127>>>>>>>>>>>>>
49127>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
49129>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
49130>>>>>>>>>>>>>
49130>>>>>>>>>>>>>        //AB-StoreStart
49130>>>>>>>>>>>>>        
49130>>>>>>>>>>>>>        begin_constraints
49132>>>>>>>>>>>>>          if (psapokat(self) <> '') constrain wapomast.wapokat_code eq (psapokat(self))
49136>>>>>>>>>>>>>        
49136>>>>>>>>>>>>>        end_constraints
49139>>>>>>>>>>>>>        
49139>>>>>>>>>>>>>        //AB-StoreEnd
49139>>>>>>>>>>>>>
49139>>>>>>>>>>>>>    End_Object    // Wapomast_DD
49140>>>>>>>>>>>>>
49140>>>>>>>>>>>>>    Set Main_DD to (Wapomast_DD(self))
49141>>>>>>>>>>>>>    Set Server to (Wapomast_DD(self))
49142>>>>>>>>>>>>>
49142>>>>>>>>>>>>>    //AB-DDOEnd
49142>>>>>>>>>>>>>
49142>>>>>>>>>>>>>    Object oSelList is a dbListSub
49144>>>>>>>>>>>>>        Set Main_File to Wapomast.File_Number
49145>>>>>>>>>>>>>        Set Server to (Wapokat_DD(self))
49146>>>>>>>>>>>>>        Set Size to 89 240
49147>>>>>>>>>>>>>        Set Location to 6 6
49148>>>>>>>>>>>>>
49148>>>>>>>>>>>>>        Begin_Row
49151>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_code
49152>>>>>>>>>>>>>            Entry_Item Wapomast.Wapomast_descr
49153>>>>>>>>>>>>>        End_Row
49158>>>>>>>>>>>>>
49158>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
49159>>>>>>>>>>>>>        Set Header_Label  item 0 to "€§¦Ÿã¡ž      :"
49160>>>>>>>>>>>>>        
49160>>>>>>>>>>>>>        Set Form_Width    item 1 to 160
49161>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49162>>>>>>>>>>>>>        
49162>>>>>>>>>>>>>
49162>>>>>>>>>>>>>        //AB-StoreStart
49162>>>>>>>>>>>>>                    
49162>>>>>>>>>>>>>                    
49162>>>>>>>>>>>>>        //AB-StoreEnd
49162>>>>>>>>>>>>>
49162>>>>>>>>>>>>>    End_Object    // oSelList
49163>>>>>>>>>>>>>
49163>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49165>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49166>>>>>>>>>>>>>        Set Location to 92 81
49167>>>>>>>>>>>>>
49167>>>>>>>>>>>>>        //AB-StoreStart
49167>>>>>>>>>>>>>        Procedure OnClick
49169>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49170>>>>>>>>>>>>>        End_Procedure
49171>>>>>>>>>>>>>        //AB-StoreEnd
49171>>>>>>>>>>>>>
49171>>>>>>>>>>>>>    End_Object    // oOK_bn
49172>>>>>>>>>>>>>
49172>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49174>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49175>>>>>>>>>>>>>        Set Location to 92 135
49176>>>>>>>>>>>>>
49176>>>>>>>>>>>>>        //AB-StoreStart
49176>>>>>>>>>>>>>        Procedure OnClick
49178>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49179>>>>>>>>>>>>>        End_Procedure
49180>>>>>>>>>>>>>        //AB-StoreEnd
49180>>>>>>>>>>>>>
49180>>>>>>>>>>>>>    End_Object    // oCancel_bn
49181>>>>>>>>>>>>>
49181>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49183>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49184>>>>>>>>>>>>>        Set Location to 92 191
49185>>>>>>>>>>>>>
49185>>>>>>>>>>>>>        //AB-StoreStart
49185>>>>>>>>>>>>>        Procedure OnClick
49187>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49188>>>>>>>>>>>>>        End_Procedure
49189>>>>>>>>>>>>>        //AB-StoreEnd
49189>>>>>>>>>>>>>
49189>>>>>>>>>>>>>    End_Object    // oSearch_bn
49190>>>>>>>>>>>>>
49190>>>>>>>>>>>>>
49190>>>>>>>>>>>>>    //AB-StoreStart
49190>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49191>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49192>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49193>>>>>>>>>>>>>    
49193>>>>>>>>>>>>>    procedure activate
49195>>>>>>>>>>>>>        send rebuild_constraints to wapomast_dd
49196>>>>>>>>>>>>>        send beginning_of_data to osellist true
49197>>>>>>>>>>>>>        forward send activate
49199>>>>>>>>>>>>>    end_procedure
49200>>>>>>>>>>>>>    
49200>>>>>>>>>>>>>    
49200>>>>>>>>>>>>>    //AB-StoreEnd
49200>>>>>>>>>>>>>
49200>>>>>>>>>>>>>End_Object    // sl023
49201>>>>>>>>>>>>>
49201>>>>>>>>>>>>>//AB/ End_Object    // prj
49201>>>>>>>>>>>
49201>>>>>>>>>>>//DDB-Selection-pkg-End
49201>>>>>>>>>>>//DDB-FileEnd
49201>>>>>>>>>    Use WAX.DD
INCLUDING FILE: WAX.DD
49201>>>>>>>>>>>//DDB-FileStart
49201>>>>>>>>>>>//DDB-HeaderStart
49201>>>>>>>>>>>
49201>>>>>>>>>>>// File Name : WAX.DD
49201>>>>>>>>>>>// Class Name: Wax_DataDictionary
49201>>>>>>>>>>>// Revision  : 39
49201>>>>>>>>>>>// Version   : 2
49201>>>>>>>>>>>
49201>>>>>>>>>>>Use  Windows           // Basic Definitions
49201>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49201>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49201>>>>>>>>>>>
49201>>>>>>>>>>>Open Wax
49203>>>>>>>>>>>Open Pmoves
49205>>>>>>>>>>>Open Wcmoves
49207>>>>>>>>>>>Open Wam
INCLUDING FILE: WAM.FD
49209>>>>>>>>>>>Open Pmovesl
49211>>>>>>>>>>>Open Wapomast
49213>>>>>>>>>>>Open Sysrecw
49215>>>>>>>>>>>Open Syscurxr
49217>>>>>>>>>>>
49217>>>>>>>>>>>//DDB-HeaderEnd
49217>>>>>>>>>>>//DDB-SelectionStart
49217>>>>>>>>>>>//DDB/ ExternalSelectionList Wax  Wax.SL
49217>>>>>>>>>>>Register_Object Wax
49217>>>>>>>>>>>//DDB-SelectionEnd
49217>>>>>>>>>>>
49217>>>>>>>>>>>Open Units
INCLUDING FILE: UNITS.FD
49219>>>>>>>>>>>Open Wapokat
49221>>>>>>>>>>>Open WitemKat
INCLUDING FILE: WITEMKAT.FD
49223>>>>>>>>>>>
49223>>>>>>>>>>>Class Wax_DataDictionary  is a DataDictionary_Sec
49224>>>>>>>>>>>
49224>>>>>>>>>>>    Procedure Construct_Object
49225>>>>>>>>>>>        Forward Send Construct_Object
49227>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
49228>>>>>>>>>>>    End_Procedure //construct_object
49229>>>>>>>>>>>
49229>>>>>>>>>>>    Procedure OnConstrain
49230>>>>>>>>>>>        Forward Send OnConstrain
49232>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
49234>>>>>>>>>>>        End
49234>>>>>>>>>>>>
49234>>>>>>>>>>>        Else Begin
49235>>>>>>>>>>>            Constrain Wax.Company_Code  eq SysCurXR.Company_Code
49237>>>>>>>>>>>            Constrain Wax.Branch_Code   eq SysCurXR.Branch_Code
49239>>>>>>>>>>>            Constrain Wax.Year_Year     eq SysCurXR.Year_Year
49241>>>>>>>>>>>        End
49241>>>>>>>>>>>>
49241>>>>>>>>>>>    End_Procedure
49242>>>>>>>>>>>
49242>>>>>>>>>>>
49242>>>>>>>>>>>    // Update:
49242>>>>>>>>>>>    Procedure Update
49243>>>>>>>>>>>        Forward Send Update
49245>>>>>>>>>>>        // Insert Code Here
49245>>>>>>>>>>>        Move SysCurXR.Company_Code  to Wax.Company_Code
49246>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Wax.Branch_Code
49247>>>>>>>>>>>        Move SysCurXR.Year_Year     to Wax.Year_Year
49248>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Wax.Year_Recr
49249>>>>>>>>>>>        Move Wapokat.Wapokat_Code   to Wax.Wapokat_Code
49250>>>>>>>>>>>        Move Wapomast.Wapomast_Code to Wax.Wapomast_Code
49251>>>>>>>>>>>    End_Procedure   // Update
49252>>>>>>>>>>>
49252>>>>>>>>>>>     Procedure Creating
49253>>>>>>>>>>>        Forward Send Creating
49255>>>>>>>>>>>        // Insert Code Here
49255>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Wax.Wax_Rec0)))))) to Wax.Wax_Recr
49256>>>>>>>>>>>    End_Procedure   // Creating
49257>>>>>>>>>>>
49257>>>>>>>>>>>
49257>>>>>>>>>>>
49257>>>>>>>>>>>    // Define_Fields:
49257>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49257>>>>>>>>>>>
49257>>>>>>>>>>>    Procedure Define_Fields
49258>>>>>>>>>>>        Forward Send Define_Fields
49260>>>>>>>>>>>        //DDB-Generated-Code-Location
49260>>>>>>>>>>>        //DDB-DefineFieldStart
49260>>>>>>>>>>>
49260>>>>>>>>>>>        Set Main_File            To Wax.File_Number
49261>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49262>>>>>>>>>>>
49262>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49263>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49264>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49265>>>>>>>>>>>
49265>>>>>>>>>>>        // Child (Client) file structure................
49265>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
49266>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
49267>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
49268>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
49269>>>>>>>>>>>
49269>>>>>>>>>>>        // Parent (Server) file structure...............
49269>>>>>>>>>>>        Send Add_Server_File  Wapomast.File_Number
49270>>>>>>>>>>>
49270>>>>>>>>>>>        // External (System) file structure.............
49270>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49271>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49272>>>>>>>>>>>
49272>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Wax_Rec0  To Wax.Wax_Rec0
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Field-based properties.......................
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Wax.Company_Code
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Wax.Branch_Code
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Wax.Year_Year
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Wax.Wapokat_Code
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Wax.Wapomast_Code
49275>>>>>>>>>>>
49275>>>>>>>>>>>        // Wax.Wax_Code
49275>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Code To DD_AUTOFIND   
49276>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Code To (Wax(Self))
49277>>>>>>>>>>>
49277>>>>>>>>>>>        // Wax.Year_Recr
49277>>>>>>>>>>>
49277>>>>>>>>>>>        // Wax.Wapomast_Recr
49277>>>>>>>>>>>
49277>>>>>>>>>>>        // Wax.Wax_Rec0
49277>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Rec0 To DD_AUTOFIND   
49278>>>>>>>>>>>
49278>>>>>>>>>>>        // Wax.Wax_Recr
49278>>>>>>>>>>>        Set Field_Options          Field Wax.Wax_Recr To DD_AUTOFIND   
49279>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Recr To (Wax(Self))
49280>>>>>>>>>>>
49280>>>>>>>>>>>        // Wax.Wax_Descr
49280>>>>>>>>>>>        Set Field_Prompt_Object    Field Wax.Wax_Descr To (Wax(Self))
49281>>>>>>>>>>>
49281>>>>>>>>>>>        //DDB-DefineFieldEnd
49281>>>>>>>>>>>    End_Procedure    // Define_Fields
49282>>>>>>>>>>>
49282>>>>>>>>>>>    // Field_Defaults:
49282>>>>>>>>>>>    // This procedure is used to establish default field values.
49282>>>>>>>>>>>
49282>>>>>>>>>>>    Procedure Field_Defaults
49283>>>>>>>>>>>        Forward Send Field_Defaults
49285>>>>>>>>>>>        //DDB-Generated-Code-Location
49285>>>>>>>>>>>        //DDB-FieldDefaultStart
49285>>>>>>>>>>>        //DDB-FieldDefaultEnd
49285>>>>>>>>>>>    End_Procedure    // Field_Defaults
49286>>>>>>>>>>>
49286>>>>>>>>>>>End_Class    // Wax_DataDictionary
49287>>>>>>>>>>>//DDB-Selection-pkg-Start
49287>>>>>>>>>>>
49287>>>>>>>>>>>Use Wax.SL           // Wax
INCLUDING FILE: WAX.SL
49287>>>>>>>>>>>>>//AB/ Project Wax:Lookup Apothikhs
49287>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49287>>>>>>>>>>>>>//AB/     Set ProjectName to "Wax:Lookup Apothikhs"
49287>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Wax.SL"
49287>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>// Project Object Structure
49287>>>>>>>>>>>>>//   Wax is a dbModalPanelSub
49287>>>>>>>>>>>>>//     Wapokat_DD is a DataDictionary
49287>>>>>>>>>>>>>//     Wapomast_DD is a DataDictionary
49287>>>>>>>>>>>>>//     Wax_DD is a DataDictionary
49287>>>>>>>>>>>>>//     oSelList is a dbListSub
49287>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49287>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49287>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>// Register all objects
49287>>>>>>>>>>>>>Register_Object oCancel_bn
49287>>>>>>>>>>>>>Register_Object oOK_bn
49287>>>>>>>>>>>>>Register_Object oSearch_bn
49287>>>>>>>>>>>>>Register_Object oSelList
49287>>>>>>>>>>>>>Register_Object Wapokat_DD
49287>>>>>>>>>>>>>Register_Object Wapomast_DD
49287>>>>>>>>>>>>>Register_Object Wax
49287>>>>>>>>>>>>>Register_Object Wax_DD
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>//AB-IgnoreStart
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>Use DFAllEnt.pkg
49287>>>>>>>>>>>>>Use dbList.Sub
49287>>>>>>>>>>>>>Use Button.Sub
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>Use WAPOKAT.DD
49287>>>>>>>>>>>>>Use WAPOMAST.DD
49287>>>>>>>>>>>>>Use WAX.DD
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>//AB-IgnoreEnd
49287>>>>>>>>>>>>>
49287>>>>>>>>>>>>>Object Wax is a dbModalPanelSub
49289>>>>>>>>>>>>>
49289>>>>>>>>>>>>>    //AB-StoreTopStart
49289>>>>>>>>>>>>>                                    
49289>>>>>>>>>>>>>    Property Integer    piMustConstrain Public  0
49291>>>>>>>>>>>>>    Property Integer    piYear          Public  0
49293>>>>>>>>>>>>>    Property String     psCompany       Public ''
49295>>>>>>>>>>>>>    Property String     psBranch        Public ''
49297>>>>>>>>>>>>>    Property String     psWapokat       Public ''
49299>>>>>>>>>>>>>    
49299>>>>>>>>>>>>>    //AB-StoreTopEnd
49299>>>>>>>>>>>>>
49299>>>>>>>>>>>>>    Set Label to "‰˜«á¢¦š¦ª €§¦Ÿž¡é¤"
49300>>>>>>>>>>>>>    Set Size to 148 355
49301>>>>>>>>>>>>>    Set Location to 8 21
49302>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49303>>>>>>>>>>>>>    Set Modal_State to FALSE
49304>>>>>>>>>>>>>
49304>>>>>>>>>>>>>    //AB-DDOStart
49304>>>>>>>>>>>>>
49304>>>>>>>>>>>>>    Object Wapokat_DD is a Wapokat_DataDictionary
49306>>>>>>>>>>>>>    End_Object    // Wapokat_DD
49307>>>>>>>>>>>>>
49307>>>>>>>>>>>>>    Object Wapomast_DD is a Wapomast_DataDictionary
49309>>>>>>>>>>>>>        Set DDO_Server to (Wapokat_DD(self))
49310>>>>>>>>>>>>>    End_Object    // Wapomast_DD
49311>>>>>>>>>>>>>
49311>>>>>>>>>>>>>    Object Wax_DD is a Wax_DataDictionary
49313>>>>>>>>>>>>>        Set DDO_Server to (Wapomast_DD(self))
49314>>>>>>>>>>>>>
49314>>>>>>>>>>>>>        //AB-StoreStart
49314>>>>>>>>>>>>>        
49314>>>>>>>>>>>>>        Begin_Constraints
49316>>>>>>>>>>>>>            Integer iMustConstrain iYear
49317>>>>>>>>>>>>>            String  sCompany sBranch sWapokat
49317>>>>>>>>>>>>>            Get piMustConstrain to iMustConstrain
49318>>>>>>>>>>>>>            If (iMustConstrain) Begin
49320>>>>>>>>>>>>>                Get piYear     to  iYear
49321>>>>>>>>>>>>>                Get psCompany  to  sCompany
49322>>>>>>>>>>>>>                Get psBranch   to  sBranch
49323>>>>>>>>>>>>>                Get psWapokat  to  sWapokat
49324>>>>>>>>>>>>>                If (sCompany<>'') Begin
49326>>>>>>>>>>>>>                    Constrain Wax.Company_Code eq sCompany
49328>>>>>>>>>>>>>                    If (sBranch<>'') Begin
49330>>>>>>>>>>>>>                        Constrain Wax.Branch_Code eq sBranch
49332>>>>>>>>>>>>>                        If (iYear<>0) Begin
49334>>>>>>>>>>>>>                            Constrain Wax.Year_Year eq iYear
49336>>>>>>>>>>>>>                            If (sWapokat<>'') Begin
49338>>>>>>>>>>>>>                                Constrain Wax.Wapokat_Code eq sWapokat
49340>>>>>>>>>>>>>                            End
49340>>>>>>>>>>>>>>
49340>>>>>>>>>>>>>                        End
49340>>>>>>>>>>>>>>
49340>>>>>>>>>>>>>                    End
49340>>>>>>>>>>>>>>
49340>>>>>>>>>>>>>                End
49340>>>>>>>>>>>>>>
49340>>>>>>>>>>>>>            End
49340>>>>>>>>>>>>>>
49340>>>>>>>>>>>>>        End_Constraints
49343>>>>>>>>>>>>>        
49343>>>>>>>>>>>>>        
49343>>>>>>>>>>>>>        
49343>>>>>>>>>>>>>        
49343>>>>>>>>>>>>>        
49343>>>>>>>>>>>>>        
49343>>>>>>>>>>>>>        //AB-StoreEnd
49343>>>>>>>>>>>>>
49343>>>>>>>>>>>>>    End_Object    // Wax_DD
49344>>>>>>>>>>>>>
49344>>>>>>>>>>>>>    Set Main_DD to (Wax_DD(self))
49345>>>>>>>>>>>>>    Set Server to (Wax_DD(self))
49346>>>>>>>>>>>>>
49346>>>>>>>>>>>>>    //AB-DDOEnd
49346>>>>>>>>>>>>>
49346>>>>>>>>>>>>>    Object oSelList is a dbListSub
49348>>>>>>>>>>>>>        Set Main_File to Wax.File_Number
49349>>>>>>>>>>>>>        Set Size to 105 340
49350>>>>>>>>>>>>>        Set Location to 5 6
49351>>>>>>>>>>>>>
49351>>>>>>>>>>>>>        Begin_Row
49354>>>>>>>>>>>>>            Entry_Item Wax.Wax_recr
49355>>>>>>>>>>>>>            Entry_Item Wax.Wax_code
49356>>>>>>>>>>>>>            Entry_Item Wax.Wax_descr
49357>>>>>>>>>>>>>        End_Row
49362>>>>>>>>>>>>>
49362>>>>>>>>>>>>>        Set Form_Width    item 0 to 33
49363>>>>>>>>>>>>>        Set Header_Label  item 0 to "Recr"
49364>>>>>>>>>>>>>        
49364>>>>>>>>>>>>>        Set Form_Width    item 1 to 80
49365>>>>>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª"
49366>>>>>>>>>>>>>        
49366>>>>>>>>>>>>>        Set Form_Width    item 2 to 219
49367>>>>>>>>>>>>>        Set Header_Label  item 2 to "œ¨ š¨˜­ã"
49368>>>>>>>>>>>>>        
49368>>>>>>>>>>>>>
49368>>>>>>>>>>>>>        //AB-StoreStart
49368>>>>>>>>>>>>>        
49368>>>>>>>>>>>>>        Procedure Activate
49370>>>>>>>>>>>>>            Send Rebuild_Constraints to Wax_DD
49371>>>>>>>>>>>>>            Send Beginning_Of_Data to oSelList True
49372>>>>>>>>>>>>>            Forward Send Activate
49374>>>>>>>>>>>>>        End_procedure
49375>>>>>>>>>>>>>        
49375>>>>>>>>>>>>>        //AB-StoreEnd
49375>>>>>>>>>>>>>
49375>>>>>>>>>>>>>    End_Object    // oSelList
49376>>>>>>>>>>>>>
49376>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49378>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49379>>>>>>>>>>>>>        Set Location to 113 186
49380>>>>>>>>>>>>>
49380>>>>>>>>>>>>>        //AB-StoreStart
49380>>>>>>>>>>>>>        Procedure OnClick
49382>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49383>>>>>>>>>>>>>        End_Procedure
49384>>>>>>>>>>>>>        //AB-StoreEnd
49384>>>>>>>>>>>>>
49384>>>>>>>>>>>>>    End_Object    // oOK_bn
49385>>>>>>>>>>>>>
49385>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49387>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49388>>>>>>>>>>>>>        Set Location to 113 241
49389>>>>>>>>>>>>>
49389>>>>>>>>>>>>>        //AB-StoreStart
49389>>>>>>>>>>>>>        Procedure OnClick
49391>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49392>>>>>>>>>>>>>        End_Procedure
49393>>>>>>>>>>>>>        //AB-StoreEnd
49393>>>>>>>>>>>>>
49393>>>>>>>>>>>>>    End_Object    // oCancel_bn
49394>>>>>>>>>>>>>
49394>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49396>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49397>>>>>>>>>>>>>        Set Location to 113 296
49398>>>>>>>>>>>>>
49398>>>>>>>>>>>>>        //AB-StoreStart
49398>>>>>>>>>>>>>        Procedure OnClick
49400>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49401>>>>>>>>>>>>>        End_Procedure
49402>>>>>>>>>>>>>        //AB-StoreEnd
49402>>>>>>>>>>>>>
49402>>>>>>>>>>>>>    End_Object    // oSearch_bn
49403>>>>>>>>>>>>>
49403>>>>>>>>>>>>>
49403>>>>>>>>>>>>>    //AB-StoreStart
49403>>>>>>>>>>>>>                                    
49403>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49404>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49405>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49406>>>>>>>>>>>>>    
49406>>>>>>>>>>>>>    
49406>>>>>>>>>>>>>    
49406>>>>>>>>>>>>>    
49406>>>>>>>>>>>>>    
49406>>>>>>>>>>>>>    
49406>>>>>>>>>>>>>    //AB-StoreEnd
49406>>>>>>>>>>>>>
49406>>>>>>>>>>>>>End_Object    // Wax
49407>>>>>>>>>>>>>
49407>>>>>>>>>>>>>//AB/ End_Object    // prj
49407>>>>>>>>>>>
49407>>>>>>>>>>>//DDB-Selection-pkg-End
49407>>>>>>>>>>>//DDB-FileEnd
49407>>>>>>>>>    Use UNITS.DD
INCLUDING FILE: UNITS.DD
49407>>>>>>>>>>>//DDB-FileStart
49407>>>>>>>>>>>//DDB-HeaderStart
49407>>>>>>>>>>>
49407>>>>>>>>>>>// File Name : UNITS.DD
49407>>>>>>>>>>>// Class Name: Units_DataDictionary
49407>>>>>>>>>>>// Revision  : 17
49407>>>>>>>>>>>// Version   : 2
49407>>>>>>>>>>>
49407>>>>>>>>>>>Use  Windows           // Basic Definitions
49407>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49407>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49407>>>>>>>>>>>
49407>>>>>>>>>>>Open Units
49409>>>>>>>>>>>Open Item
INCLUDING FILE: ITEM.FD
49411>>>>>>>>>>>Open Sysrecw
49413>>>>>>>>>>>Open Syscurxr
49415>>>>>>>>>>>
49415>>>>>>>>>>>//DDB-HeaderEnd
49415>>>>>>>>>>>//DDB-SelectionStart
49415>>>>>>>>>>>//DDB/ ExternalSelectionList sl025  sl025.SL
49415>>>>>>>>>>>Register_Object sl025
49415>>>>>>>>>>>//DDB-SelectionEnd
49415>>>>>>>>>>>
49415>>>>>>>>>>>Class Units_DataDictionary  is a DataDictionary
49416>>>>>>>>>>>
49416>>>>>>>>>>>    Procedure Save_Main_File
49417>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
49419>>>>>>>>>>>            If Units.Recnum Eq 0 Procedure_Return
49422>>>>>>>>>>>        End
49422>>>>>>>>>>>>
49422>>>>>>>>>>>        Forward Send Save_Main_File
49424>>>>>>>>>>>    End_Procedure
49425>>>>>>>>>>>
49425>>>>>>>>>>>
49425>>>>>>>>>>>     Procedure Creating
49426>>>>>>>>>>>        Forward Send Creating
49428>>>>>>>>>>>        // Insert Code Here
49428>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Units.Units_Rec0)))))) to Units.Units_Recr
49429>>>>>>>>>>>    End_Procedure   // Creating
49430>>>>>>>>>>>
49430>>>>>>>>>>>
49430>>>>>>>>>>>
49430>>>>>>>>>>>    // Define_Fields:
49430>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49430>>>>>>>>>>>
49430>>>>>>>>>>>    Procedure Define_Fields
49431>>>>>>>>>>>        Forward Send Define_Fields
49433>>>>>>>>>>>        //DDB-Generated-Code-Location
49433>>>>>>>>>>>        //DDB-DefineFieldStart
49433>>>>>>>>>>>
49433>>>>>>>>>>>        Set Main_File            To Units.File_Number
49434>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49435>>>>>>>>>>>
49435>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49436>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49437>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49438>>>>>>>>>>>
49438>>>>>>>>>>>        // Child (Client) file structure................
49438>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49439>>>>>>>>>>>
49439>>>>>>>>>>>        // External (System) file structure.............
49439>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49440>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49441>>>>>>>>>>>
49441>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Units_Rec0  To Units.Units_Rec0
49444>>>>>>>>>>>
49444>>>>>>>>>>>        // Field-based properties.......................
49444>>>>>>>>>>>
49444>>>>>>>>>>>        // Units.Units_Code
49444>>>>>>>>>>>        Set Field_Options          Field Units.Units_Code To DD_AUTOFIND   
49445>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Code To (sl025(Self))
49446>>>>>>>>>>>
49446>>>>>>>>>>>        // Units.Units_Rec0
49446>>>>>>>>>>>        Set Field_Options          Field Units.Units_Rec0 To DD_AUTOFIND   
49447>>>>>>>>>>>
49447>>>>>>>>>>>        // Units.Units_Descr
49447>>>>>>>>>>>        Set Field_Prompt_Object    Field Units.Units_Descr To (sl025(Self))
49448>>>>>>>>>>>
49448>>>>>>>>>>>        // Units.Units_Recr
49448>>>>>>>>>>>        Set Field_Options          Field Units.Units_Recr To DD_AUTOFIND   
49449>>>>>>>>>>>
49449>>>>>>>>>>>        //DDB-DefineFieldEnd
49449>>>>>>>>>>>    End_Procedure    // Define_Fields
49450>>>>>>>>>>>
49450>>>>>>>>>>>    // Field_Defaults:
49450>>>>>>>>>>>    // This procedure is used to establish default field values.
49450>>>>>>>>>>>
49450>>>>>>>>>>>    Procedure Field_Defaults
49451>>>>>>>>>>>        Forward Send Field_Defaults
49453>>>>>>>>>>>        //DDB-Generated-Code-Location
49453>>>>>>>>>>>        //DDB-FieldDefaultStart
49453>>>>>>>>>>>        //DDB-FieldDefaultEnd
49453>>>>>>>>>>>    End_Procedure    // Field_Defaults
49454>>>>>>>>>>>
49454>>>>>>>>>>>End_Class    // Units_DataDictionary
49455>>>>>>>>>>>//DDB-Selection-pkg-Start
49455>>>>>>>>>>>
49455>>>>>>>>>>>Use sl025.SL         // sl025
INCLUDING FILE: SL025.SL
49455>>>>>>>>>>>>>//AB/ Project sl025
49455>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49455>>>>>>>>>>>>>//AB/     Set ProjectName to "sl025"
49455>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl025.SL"
49455>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>// Project Object Structure
49455>>>>>>>>>>>>>//   sl025 is a dbModalPanelSub
49455>>>>>>>>>>>>>//     Units_DD is a DataDictionary
49455>>>>>>>>>>>>>//     oSelList is a dbListSub
49455>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49455>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49455>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>// Register all objects
49455>>>>>>>>>>>>>Register_Object oCancel_bn
49455>>>>>>>>>>>>>Register_Object oOK_bn
49455>>>>>>>>>>>>>Register_Object oSearch_bn
49455>>>>>>>>>>>>>Register_Object oSelList
49455>>>>>>>>>>>>>Register_Object sl025
49455>>>>>>>>>>>>>Register_Object Units_DD
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>//AB-IgnoreStart
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>Use DFAllEnt.pkg
49455>>>>>>>>>>>>>Use dbList.Sub
49455>>>>>>>>>>>>>Use Button.Sub
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>Use UNITS.DD
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>//AB-IgnoreEnd
49455>>>>>>>>>>>>>
49455>>>>>>>>>>>>>Object sl025 is a dbModalPanelSub
49457>>>>>>>>>>>>>    set label to "‹¦¤á›œª ‹â«¨ž©žª" 
49458>>>>>>>>>>>>>    Set Size to 148 297
49459>>>>>>>>>>>>>    Set Location to 4 5
49460>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49461>>>>>>>>>>>>>    Set Modal_State to FALSE
49462>>>>>>>>>>>>>
49462>>>>>>>>>>>>>    //AB-DDOStart
49462>>>>>>>>>>>>>
49462>>>>>>>>>>>>>    Object Units_DD is a Units_DataDictionary
49464>>>>>>>>>>>>>    End_Object    // Units_DD
49465>>>>>>>>>>>>>
49465>>>>>>>>>>>>>    Set Main_DD to (Units_DD(self))
49466>>>>>>>>>>>>>    Set Server to (Units_DD(self))
49467>>>>>>>>>>>>>
49467>>>>>>>>>>>>>    //AB-DDOEnd
49467>>>>>>>>>>>>>
49467>>>>>>>>>>>>>    Object oSelList is a dbListSub
49469>>>>>>>>>>>>>        set main_file to units.file_number 
49470>>>>>>>>>>>>>        Set Size to 105 280
49471>>>>>>>>>>>>>        Set Location to 6 6
49472>>>>>>>>>>>>>
49472>>>>>>>>>>>>>        Begin_Row
49475>>>>>>>>>>>>>            entry_item units.units_code 
49476>>>>>>>>>>>>>            entry_item units.units_descr 
49477>>>>>>>>>>>>>        End_Row
49482>>>>>>>>>>>>>
49482>>>>>>>>>>>>>        Set Form_Width    item 0 to 91
49483>>>>>>>>>>>>>        set header_label  item 0 to "‰à› ¡¦ª" 
49484>>>>>>>>>>>>>        
49484>>>>>>>>>>>>>        Set Form_Width    item 1 to 180
49485>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49486>>>>>>>>>>>>>        
49486>>>>>>>>>>>>>    End_Object    // oSelList
49487>>>>>>>>>>>>>
49487>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49489>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49490>>>>>>>>>>>>>        Set Location to 115 126
49491>>>>>>>>>>>>>
49491>>>>>>>>>>>>>        //AB-StoreStart
49491>>>>>>>>>>>>>        Procedure OnClick
49493>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49494>>>>>>>>>>>>>        End_Procedure
49495>>>>>>>>>>>>>        //AB-StoreEnd
49495>>>>>>>>>>>>>
49495>>>>>>>>>>>>>    End_Object    // oOK_bn
49496>>>>>>>>>>>>>
49496>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49498>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49499>>>>>>>>>>>>>        Set Location to 115 181
49500>>>>>>>>>>>>>
49500>>>>>>>>>>>>>        //AB-StoreStart
49500>>>>>>>>>>>>>        Procedure OnClick
49502>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49503>>>>>>>>>>>>>        End_Procedure
49504>>>>>>>>>>>>>        //AB-StoreEnd
49504>>>>>>>>>>>>>
49504>>>>>>>>>>>>>    End_Object    // oCancel_bn
49505>>>>>>>>>>>>>
49505>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49507>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49508>>>>>>>>>>>>>        Set Location to 115 236
49509>>>>>>>>>>>>>
49509>>>>>>>>>>>>>        //AB-StoreStart
49509>>>>>>>>>>>>>        Procedure OnClick
49511>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49512>>>>>>>>>>>>>        End_Procedure
49513>>>>>>>>>>>>>        //AB-StoreEnd
49513>>>>>>>>>>>>>
49513>>>>>>>>>>>>>    End_Object    // oSearch_bn
49514>>>>>>>>>>>>>
49514>>>>>>>>>>>>>
49514>>>>>>>>>>>>>    //AB-StoreStart
49514>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49515>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49516>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49517>>>>>>>>>>>>>    //AB-StoreEnd
49517>>>>>>>>>>>>>
49517>>>>>>>>>>>>>End_Object    // sl025
49518>>>>>>>>>>>>>
49518>>>>>>>>>>>>>//AB/ End_Object    // prj
49518>>>>>>>>>>>
49518>>>>>>>>>>>//DDB-Selection-pkg-End
49518>>>>>>>>>>>//DDB-FileEnd
49518>>>>>>>>>    Use WITEMKAT.DD
INCLUDING FILE: WITEMKAT.DD
49518>>>>>>>>>>>//DDB-FileStart
49518>>>>>>>>>>>//DDB-HeaderStart
49518>>>>>>>>>>>
49518>>>>>>>>>>>// File Name : WITEMKAT.DD
49518>>>>>>>>>>>// Class Name: Witemkat_DataDictionary
49518>>>>>>>>>>>// Revision  : 26
49518>>>>>>>>>>>
49518>>>>>>>>>>>Use  Windows           // Basic Definitions
49518>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49518>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49518>>>>>>>>>>>
49518>>>>>>>>>>>Open Witemkat
49520>>>>>>>>>>>Open Item
49522>>>>>>>>>>>Open Sysrecw
49524>>>>>>>>>>>Open Syscurxr
49526>>>>>>>>>>>
49526>>>>>>>>>>>//DDB-HeaderEnd
49526>>>>>>>>>>>//DDB-SelectionStart
49526>>>>>>>>>>>//DDB/ ExternalSelectionList sl024  sl024.SL
49526>>>>>>>>>>>Register_Object sl024
49526>>>>>>>>>>>//DDB-SelectionEnd
49526>>>>>>>>>>>
49526>>>>>>>>>>>Class Witemkat_DataDictionary  is a DataDictionary
49527>>>>>>>>>>>
49527>>>>>>>>>>>     Procedure Creating
49528>>>>>>>>>>>        Forward Send Creating
49530>>>>>>>>>>>        // Insert Code Here
49530>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(WitemKat.WitemKat_Rec0)))))) to WitemKat.WitemKat_Recr
49531>>>>>>>>>>>    End_Procedure   // Creating
49532>>>>>>>>>>>   
49532>>>>>>>>>>>    Function Validate_Save  Returns Integer
49533>>>>>>>>>>>        Local Integer iReturnVal icheck
49534>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
49536>>>>>>>>>>>        If (Not(iReturnVal)) Begin
49538>>>>>>>>>>>            // Insert Code Here
49538>>>>>>>>>>>//           if (witemkat.codegl <> '') begin
49538>>>>>>>>>>>//              Move (Check_log(witemkat.codegl)) to iCheck  
49538>>>>>>>>>>>//              if (icheck) Move 24001 to iReturnVal 
49538>>>>>>>>>>>//           end
49538>>>>>>>>>>>           If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49541>>>>>>>>>>>        End
49541>>>>>>>>>>>>
49541>>>>>>>>>>>        Function_Return iReturnVal
49542>>>>>>>>>>>    End_Function   // Validate_Save
49543>>>>>>>>>>> 
49543>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49544>>>>>>>>>>>        String lsError_Message
49545>>>>>>>>>>>        Case Begin
49545>>>>>>>>>>>            Case (iError_Num = 24001)
49547>>>>>>>>>>>                Move "DDC 24: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ¡˜«žš¦¨å˜ª œå›¦¬ª" to lsError_Message
49548>>>>>>>>>>>              Case Break
49549>>>>>>>>>>>            Case Else
49549>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
49551>>>>>>>>>>>        Case End
49551>>>>>>>>>>>        Error iError_Num lsError_Message
49552>>>>>>>>>>>>
49552>>>>>>>>>>>    End_Procedure // operation_not_allowed
49553>>>>>>>>>>>
49553>>>>>>>>>>>
49553>>>>>>>>>>>
49553>>>>>>>>>>>    // Define_Fields:
49553>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49553>>>>>>>>>>>
49553>>>>>>>>>>>    Procedure Define_Fields
49554>>>>>>>>>>>        Forward Send Define_Fields
49556>>>>>>>>>>>        //DDB-Generated-Code-Location
49556>>>>>>>>>>>        //DDB-DefineFieldStart
49556>>>>>>>>>>>
49556>>>>>>>>>>>        Set Main_File            To Witemkat.File_Number
49557>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49558>>>>>>>>>>>
49558>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49559>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49560>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49561>>>>>>>>>>>
49561>>>>>>>>>>>        // Child (Client) file structure................
49561>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49562>>>>>>>>>>>
49562>>>>>>>>>>>        // External (System) file structure.............
49562>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
49563>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
49564>>>>>>>>>>>
49564>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemkat_Rec0  To Witemkat.Witemkat_Rec0
49567>>>>>>>>>>>
49567>>>>>>>>>>>        // Field-based properties.......................
49567>>>>>>>>>>>
49567>>>>>>>>>>>        // Witemkat.Witemkat_Code  
49567>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Code   To DD_AUTOFIND   
49568>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Code   To (sl024(Self))
49569>>>>>>>>>>>
49569>>>>>>>>>>>        // Witemkat.Witemkat_Rec0  
49569>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Rec0   To DD_AUTOFIND   
49570>>>>>>>>>>>
49570>>>>>>>>>>>        // Witemkat.Witemkat_Descr 
49570>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemkat.Witemkat_Descr  To (sl024(Self))
49571>>>>>>>>>>>
49571>>>>>>>>>>>        // Witemkat.Witemkat_Recr  
49571>>>>>>>>>>>        Set Field_Options          Field Witemkat.Witemkat_Recr   To DD_AUTOFIND   
49572>>>>>>>>>>>
49572>>>>>>>>>>>        // Witemkat.Codeglpol      
49572>>>>>>>>>>>
49572>>>>>>>>>>>        // Witemkat.Codeglago      
49572>>>>>>>>>>>
49572>>>>>>>>>>>        //DDB-DefineFieldEnd
49572>>>>>>>>>>>    End_Procedure    // Define_Fields
49573>>>>>>>>>>>
49573>>>>>>>>>>>    // Field_Defaults:
49573>>>>>>>>>>>    // This procedure is used to establish default field values.
49573>>>>>>>>>>>
49573>>>>>>>>>>>    Procedure Field_Defaults
49574>>>>>>>>>>>        Forward Send Field_Defaults
49576>>>>>>>>>>>        //DDB-Generated-Code-Location
49576>>>>>>>>>>>        //DDB-FieldDefaultStart
49576>>>>>>>>>>>        //DDB-FieldDefaultEnd
49576>>>>>>>>>>>    End_Procedure    // Field_Defaults
49577>>>>>>>>>>>
49577>>>>>>>>>>>End_Class    // Witemkat_DataDictionary
49578>>>>>>>>>>>//DDB-Selection-pkg-Start
49578>>>>>>>>>>>Use sl024.SL         // sl024
INCLUDING FILE: SL024.SL
49578>>>>>>>>>>>>>//AB/ Project sl024:kathgories eidon
49578>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49578>>>>>>>>>>>>>//AB/     Set ProjectName to "sl024:kathgories eidon"
49578>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl024.SL"
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>// Project Object Structure
49578>>>>>>>>>>>>>//   sl024 is a dbModalPanelSub
49578>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
49578>>>>>>>>>>>>>//     oSelList is a dbListSub
49578>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49578>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49578>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>// Register all objects
49578>>>>>>>>>>>>>Register_Object oCancel_bn
49578>>>>>>>>>>>>>Register_Object oOK_bn
49578>>>>>>>>>>>>>Register_Object oSearch_bn
49578>>>>>>>>>>>>>Register_Object oSelList
49578>>>>>>>>>>>>>Register_Object sl024
49578>>>>>>>>>>>>>Register_Object Witemkat_DD
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>//AB-IgnoreStart
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>Use DFAllEnt.pkg
49578>>>>>>>>>>>>>Use dbList.Sub
49578>>>>>>>>>>>>>Use Button.Sub
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>Use WITEMKAT.DD
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>//AB-IgnoreEnd
49578>>>>>>>>>>>>>
49578>>>>>>>>>>>>>Object sl024 is a dbModalPanelSub
49580>>>>>>>>>>>>>    Set Label to "‰˜«žš¦¨åœª „ ›é¤"
49581>>>>>>>>>>>>>    Set Size to 217 375
49582>>>>>>>>>>>>>    Set Location to 4 5
49583>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49584>>>>>>>>>>>>>    Set Modal_State to FALSE
49585>>>>>>>>>>>>>
49585>>>>>>>>>>>>>    //AB-DDOStart
49585>>>>>>>>>>>>>
49585>>>>>>>>>>>>>    Object Witemkat_DD is a Witemkat_DataDictionary
49587>>>>>>>>>>>>>    End_Object    // Witemkat_DD
49588>>>>>>>>>>>>>
49588>>>>>>>>>>>>>    Set Main_DD to (Witemkat_DD(self))
49589>>>>>>>>>>>>>    Set Server to (Witemkat_DD(self))
49590>>>>>>>>>>>>>
49590>>>>>>>>>>>>>    //AB-DDOEnd
49590>>>>>>>>>>>>>
49590>>>>>>>>>>>>>    Object oSelList is a dbListSub
49592>>>>>>>>>>>>>        Set Main_File to Witemkat.File_Number
49593>>>>>>>>>>>>>        Set Size to 175 357
49594>>>>>>>>>>>>>        Set Location to 6 6
49595>>>>>>>>>>>>>
49595>>>>>>>>>>>>>        Begin_Row
49598>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_code
49599>>>>>>>>>>>>>            Entry_Item Witemkat.Witemkat_descr
49600>>>>>>>>>>>>>        End_Row
49605>>>>>>>>>>>>>
49605>>>>>>>>>>>>>        Set Form_Width    item 0 to 124
49606>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
49607>>>>>>>>>>>>>        
49607>>>>>>>>>>>>>        Set Form_Width    item 1 to 223
49608>>>>>>>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
49609>>>>>>>>>>>>>        
49609>>>>>>>>>>>>>    End_Object    // oSelList
49610>>>>>>>>>>>>>
49610>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49612>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
49613>>>>>>>>>>>>>        Set Location to 186 210
49614>>>>>>>>>>>>>
49614>>>>>>>>>>>>>        //AB-StoreStart
49614>>>>>>>>>>>>>        Procedure OnClick
49616>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49617>>>>>>>>>>>>>        End_Procedure
49618>>>>>>>>>>>>>        //AB-StoreEnd
49618>>>>>>>>>>>>>
49618>>>>>>>>>>>>>    End_Object    // oOK_bn
49619>>>>>>>>>>>>>
49619>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49621>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
49622>>>>>>>>>>>>>        Set Location to 186 265
49623>>>>>>>>>>>>>
49623>>>>>>>>>>>>>        //AB-StoreStart
49623>>>>>>>>>>>>>        Procedure OnClick
49625>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49626>>>>>>>>>>>>>        End_Procedure
49627>>>>>>>>>>>>>        //AB-StoreEnd
49627>>>>>>>>>>>>>
49627>>>>>>>>>>>>>    End_Object    // oCancel_bn
49628>>>>>>>>>>>>>
49628>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49630>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
49631>>>>>>>>>>>>>        Set Location to 186 320
49632>>>>>>>>>>>>>
49632>>>>>>>>>>>>>        //AB-StoreStart
49632>>>>>>>>>>>>>        Procedure OnClick
49634>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49635>>>>>>>>>>>>>        End_Procedure
49636>>>>>>>>>>>>>        //AB-StoreEnd
49636>>>>>>>>>>>>>
49636>>>>>>>>>>>>>    End_Object    // oSearch_bn
49637>>>>>>>>>>>>>
49637>>>>>>>>>>>>>
49637>>>>>>>>>>>>>    //AB-StoreStart
49637>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49638>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49639>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49640>>>>>>>>>>>>>    //AB-StoreEnd
49640>>>>>>>>>>>>>
49640>>>>>>>>>>>>>End_Object    // sl024
49641>>>>>>>>>>>>>
49641>>>>>>>>>>>>>//AB/ End_Object    // prj
49641>>>>>>>>>>>//DDB-Selection-pkg-End
49641>>>>>>>>>>>//DDB-FileEnd
49641>>>>>>>>>    Use FPA.DD
INCLUDING FILE: FPA.DD
49641>>>>>>>>>>>//DDB-FileStart
49641>>>>>>>>>>>//DDB-HeaderStart
49641>>>>>>>>>>>
49641>>>>>>>>>>>// File Name : FPA.DD
49641>>>>>>>>>>>// Class Name: Fpa_DataDictionary
49641>>>>>>>>>>>// Revision  : 34
49641>>>>>>>>>>>// Version   : 2
49641>>>>>>>>>>>
49641>>>>>>>>>>>Use  Windows           // Basic Definitions
49641>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49641>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49641>>>>>>>>>>>
49641>>>>>>>>>>>Open Fpa
INCLUDING FILE: FPA.FD
49643>>>>>>>>>>>Open Iteml
49645>>>>>>>>>>>Open Partlfpa
49647>>>>>>>>>>>Open Item
49649>>>>>>>>>>>
49649>>>>>>>>>>>//DDB-HeaderEnd
49649>>>>>>>>>>>//DDB-SelectionStart
49649>>>>>>>>>>>//DDB/ ExternalSelectionList Fpa  Fpa.SL
49649>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.SL
49649>>>>>>>>>>>Register_Object Fpa
49649>>>>>>>>>>>Register_Object sl150
49649>>>>>>>>>>>//DDB-SelectionEnd
49649>>>>>>>>>>>
49649>>>>>>>>>>>Class Fpa_DataDictionary  is a DataDictionary_Sec
49650>>>>>>>>>>> 
49650>>>>>>>>>>>    // Validate_Save:
49650>>>>>>>>>>> 
49650>>>>>>>>>>>    Function Validate_Save  Returns Integer
49651>>>>>>>>>>>        Local Integer iReturnVal icheck
49652>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
49654>>>>>>>>>>>        If (Not(iReturnVal)) Begin
49656>>>>>>>>>>>            // Insert Code Here
49656>>>>>>>>>>>         //  if (fpa.agora_codegl <> '') begin
49656>>>>>>>>>>>         //     Move (Check_log(fpa.agora_codegl)) to iCheck  
49656>>>>>>>>>>>         //     if (icheck) Move 104001 to iReturnVal 
49656>>>>>>>>>>>         //  end
49656>>>>>>>>>>>         //  if (fpa.polhsh_codegl <> '') begin
49656>>>>>>>>>>>         //     Move (Check_log(fpa.polhsh_codegl)) to iCheck  
49656>>>>>>>>>>>         //     if (icheck) Move 104002 to iReturnVal
49656>>>>>>>>>>>         //  end   
49656>>>>>>>>>>>         //  If (iReturnVal) Send Operation_Not_Allowed iReturnVal
49656>>>>>>>>>>>        End
49656>>>>>>>>>>>>
49656>>>>>>>>>>>        Function_Return iReturnVal
49657>>>>>>>>>>>    End_Function   // Validate_Save
49658>>>>>>>>>>> 
49658>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49659>>>>>>>>>>>        String lsError_Message
49660>>>>>>>>>>>        Case Begin
49660>>>>>>>>>>>            Case (iError_Num = 104001)
49662>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ ˜š¦¨é¤" to lsError_Message
49663>>>>>>>>>>>              Case Break
49664>>>>>>>>>>>            Case (iError_Num = 104002)
49667>>>>>>>>>>>                Move "DDC 104: €¤ç§˜¨¡«¦ª ¢¦š. ‚.Š ”..€ §à¢ã©œà¤" to lsError_Message
49668>>>>>>>>>>>              Case Break
49669>>>>>>>>>>>            Case Else
49669>>>>>>>>>>>                Forward Send Operation_Not_Allowed iError_Num
49671>>>>>>>>>>>        Case End
49671>>>>>>>>>>>        Error iError_Num lsError_Message
49672>>>>>>>>>>>>
49672>>>>>>>>>>>    End_Procedure // operation_not_allowed
49673>>>>>>>>>>>
49673>>>>>>>>>>>    // Define_Fields:
49673>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
49673>>>>>>>>>>>
49673>>>>>>>>>>>    Procedure Define_Fields
49674>>>>>>>>>>>        Forward Send Define_Fields
49676>>>>>>>>>>>        //DDB-Generated-Code-Location
49676>>>>>>>>>>>        //DDB-DefineFieldStart
49676>>>>>>>>>>>
49676>>>>>>>>>>>        Set Main_File            To Fpa.File_Number
49677>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
49678>>>>>>>>>>>
49678>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
49679>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
49680>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
49681>>>>>>>>>>>
49681>>>>>>>>>>>        // Child (Client) file structure................
49681>>>>>>>>>>>        Send Add_Client_File  Iteml.File_Number
49682>>>>>>>>>>>        Send Add_Client_File  Partlfpa.File_Number
49683>>>>>>>>>>>        Send Add_Client_File  Item.File_Number
49684>>>>>>>>>>>
49684>>>>>>>>>>>        // Field-based properties.......................
49684>>>>>>>>>>>
49684>>>>>>>>>>>        // Fpa.Fpa_Pososto
49684>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Pososto To DD_AUTOFIND    DD_REQUIRED   
49685>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Pososto To (Fpa(Self))
49686>>>>>>>>>>>        Set Key_Field_State        Field Fpa.Fpa_Pososto To TRUE
49687>>>>>>>>>>>
49687>>>>>>>>>>>        // Fpa.Fpa_Descr
49687>>>>>>>>>>>        Set Field_Options          Field Fpa.Fpa_Descr To DD_AUTOFIND   
49688>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Fpa_Descr To (Fpa(Self))
49689>>>>>>>>>>>
49689>>>>>>>>>>>        // Fpa.Agora_Codegl
49689>>>>>>>>>>>        Set Field_Prompt_Object    Field Fpa.Agora_Codegl To (sl150(Self))
49690>>>>>>>>>>>
49690>>>>>>>>>>>        // Fpa.Polhsh_Codegl
49690>>>>>>>>>>>
49690>>>>>>>>>>>        //DDB-DefineFieldEnd
49690>>>>>>>>>>>    End_Procedure    // Define_Fields
49691>>>>>>>>>>>
49691>>>>>>>>>>>    // Field_Defaults:
49691>>>>>>>>>>>    // This procedure is used to establish default field values.
49691>>>>>>>>>>>
49691>>>>>>>>>>>    Procedure Field_Defaults
49692>>>>>>>>>>>        Forward Send Field_Defaults
49694>>>>>>>>>>>        //DDB-Generated-Code-Location
49694>>>>>>>>>>>        //DDB-FieldDefaultStart
49694>>>>>>>>>>>        //DDB-FieldDefaultEnd
49694>>>>>>>>>>>    End_Procedure    // Field_Defaults
49695>>>>>>>>>>>
49695>>>>>>>>>>>End_Class    // Fpa_DataDictionary
49696>>>>>>>>>>>//DDB-Selection-pkg-Start
49696>>>>>>>>>>>
49696>>>>>>>>>>>Use Fpa.SL           // Fpa
INCLUDING FILE: FPA.SL
49696>>>>>>>>>>>>>//AB/ Project Fpa:Lookup
49696>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
49696>>>>>>>>>>>>>//AB/     Set ProjectName to "Fpa:Lookup"
49696>>>>>>>>>>>>>//AB/     Set ProjectFileName to "Fpa.SL"
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>// Project Object Structure
49696>>>>>>>>>>>>>//   Fpa is a dbModalPanelSub
49696>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
49696>>>>>>>>>>>>>//     oSelList is a dbListSub
49696>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
49696>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
49696>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>// Register all objects
49696>>>>>>>>>>>>>Register_Object Fpa
49696>>>>>>>>>>>>>Register_Object Fpa_DD
49696>>>>>>>>>>>>>Register_Object oCancel_bn
49696>>>>>>>>>>>>>Register_Object oOK_bn
49696>>>>>>>>>>>>>Register_Object oSearch_bn
49696>>>>>>>>>>>>>Register_Object oSelList
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>//AB-IgnoreStart
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>Use DFAllEnt.pkg
49696>>>>>>>>>>>>>Use dbList.Sub
49696>>>>>>>>>>>>>Use Button.Sub
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>Use FPA.DD
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>//AB-IgnoreEnd
49696>>>>>>>>>>>>>
49696>>>>>>>>>>>>>CD_Popup_Object Fpa is a dbModalPanelSub
49715>>>>>>>>>>>>>    set label to "¦©¦©«á ”..€." 
49716>>>>>>>>>>>>>    Set Size to 148 181
49717>>>>>>>>>>>>>    Set Location to 4 5
49718>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
49719>>>>>>>>>>>>>    Set Modal_State to FALSE
49720>>>>>>>>>>>>>
49720>>>>>>>>>>>>>    //AB-DDOStart
49720>>>>>>>>>>>>>
49720>>>>>>>>>>>>>    Object Fpa_DD is a Fpa_DataDictionary
49722>>>>>>>>>>>>>    End_Object    // Fpa_DD
49723>>>>>>>>>>>>>
49723>>>>>>>>>>>>>    Set Main_DD to (Fpa_DD(self))
49724>>>>>>>>>>>>>    Set Server to (Fpa_DD(self))
49725>>>>>>>>>>>>>
49725>>>>>>>>>>>>>    //AB-DDOEnd
49725>>>>>>>>>>>>>
49725>>>>>>>>>>>>>    Object oSelList is a dbListSub
49727>>>>>>>>>>>>>        Set Main_File to Fpa.File_Number
49728>>>>>>>>>>>>>        Set Size to 105 165
49729>>>>>>>>>>>>>        Set Location to 6 6
49730>>>>>>>>>>>>>
49730>>>>>>>>>>>>>        Begin_Row
49733>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_pososto
49734>>>>>>>>>>>>>            Entry_Item Fpa.Fpa_descr
49735>>>>>>>>>>>>>        End_Row
49740>>>>>>>>>>>>>
49740>>>>>>>>>>>>>        Set Form_Width    item 0 to 66
49741>>>>>>>>>>>>>        set header_label  item 0 to "% ”€" 
49742>>>>>>>>>>>>>        
49742>>>>>>>>>>>>>        Set Form_Width    item 1 to 90
49743>>>>>>>>>>>>>        set header_label  item 1 to "œ¨ š¨˜­ã" 
49744>>>>>>>>>>>>>        
49744>>>>>>>>>>>>>    End_Object    // oSelList
49745>>>>>>>>>>>>>
49745>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
49747>>>>>>>>>>>>>        set label to "&„§ ¢¦šã" 
49748>>>>>>>>>>>>>        Set Size to 14 46
49749>>>>>>>>>>>>>        Set Location to 113 26
49750>>>>>>>>>>>>>
49750>>>>>>>>>>>>>        //AB-StoreStart
49750>>>>>>>>>>>>>        Procedure OnClick
49752>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
49753>>>>>>>>>>>>>        End_Procedure
49754>>>>>>>>>>>>>        //AB-StoreEnd
49754>>>>>>>>>>>>>
49754>>>>>>>>>>>>>    End_Object    // oOK_bn
49755>>>>>>>>>>>>>
49755>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
49757>>>>>>>>>>>>>        set label to "&€¡ç¨à©ž" 
49758>>>>>>>>>>>>>        Set Size to 14 46
49759>>>>>>>>>>>>>        Set Location to 113 75
49760>>>>>>>>>>>>>
49760>>>>>>>>>>>>>        //AB-StoreStart
49760>>>>>>>>>>>>>        Procedure OnClick
49762>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
49763>>>>>>>>>>>>>        End_Procedure
49764>>>>>>>>>>>>>        //AB-StoreEnd
49764>>>>>>>>>>>>>
49764>>>>>>>>>>>>>    End_Object    // oCancel_bn
49765>>>>>>>>>>>>>
49765>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
49767>>>>>>>>>>>>>        set label to "€&¤˜ã«ž©ž" 
49768>>>>>>>>>>>>>        Set Size to 14 46
49769>>>>>>>>>>>>>        Set Location to 113 126
49770>>>>>>>>>>>>>
49770>>>>>>>>>>>>>        //AB-StoreStart
49770>>>>>>>>>>>>>        Procedure OnClick
49772>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
49773>>>>>>>>>>>>>        End_Procedure
49774>>>>>>>>>>>>>        //AB-StoreEnd
49774>>>>>>>>>>>>>
49774>>>>>>>>>>>>>    End_Object    // oSearch_bn
49775>>>>>>>>>>>>>
49775>>>>>>>>>>>>>
49775>>>>>>>>>>>>>    //AB-StoreStart
49775>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
49776>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
49777>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
49778>>>>>>>>>>>>>    //AB-StoreEnd
49778>>>>>>>>>>>>>
49778>>>>>>>>>>>>>CD_End_Object    // Fpa
49780>>>>>>>>>>>>>>
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>//AB/ End_Object    // prj
49780>>>>>>>>>>>Use sl150.SL         // sl150
INCLUDING FILE: SL150.SL
49780>>>>>>>>>>>>>//AB/ Project sl150:GL Gplan
49780>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
49780>>>>>>>>>>>>>//AB/         Set ProjectName to "sl150:GL Gplan"
49780>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl150.SL"
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>// Project Object Structure
49780>>>>>>>>>>>>>//   sl150 is a dbModalPanelSub
49780>>>>>>>>>>>>>//     Gplan_DD is a DataDictionary
49780>>>>>>>>>>>>>//     oSelList is a dbListSub
49780>>>>>>>>>>>>>//     oOK_bn is a Button
49780>>>>>>>>>>>>>//     oCancel_bn is a Button
49780>>>>>>>>>>>>>//     oSearch_bn is a Button
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>// Register all objects
49780>>>>>>>>>>>>>Register_Object Gplan_DD
49780>>>>>>>>>>>>>Register_Object oCancel_bn
49780>>>>>>>>>>>>>Register_Object oOK_bn
49780>>>>>>>>>>>>>Register_Object oSearch_bn
49780>>>>>>>>>>>>>Register_Object oSelList
49780>>>>>>>>>>>>>Register_Object sl150
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>    //AB-IgnoreStart
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>    Use DFAllEnt.pkg
49780>>>>>>>>>>>>>    Use dbList.Sub
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>
49780>>>>>>>>>>>>>    Use GPLAN.DD
INCLUDING FILE: GPLAN.DD
49780>>>>>>>>>>>>>>>//DDB-FileStart
49780>>>>>>>>>>>>>>>//DDB-HeaderStart
49780>>>>>>>>>>>>>>>
49780>>>>>>>>>>>>>>>// File Name : GPLAN.DD
49780>>>>>>>>>>>>>>>// Class Name: Gplan_DataDictionary
49780>>>>>>>>>>>>>>>// Revision  : 132
49780>>>>>>>>>>>>>>>// Version   : 2
49780>>>>>>>>>>>>>>>
49780>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49780>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49780>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49780>>>>>>>>>>>>>>>
49780>>>>>>>>>>>>>>>Open Gplan
49782>>>>>>>>>>>>>>>Open Gmovea
INCLUDING FILE: GMOVEA.FD
49784>>>>>>>>>>>>>>>Open Gplanmod
INCLUDING FILE: GPLANMOD.FD
49786>>>>>>>>>>>>>>>Open Gmhnes
INCLUDING FILE: GMHNES.FD
49788>>>>>>>>>>>>>>>Open Gvatd
INCLUDING FILE: GVATD.FD
49790>>>>>>>>>>>>>>>Open Gpmoves
INCLUDING FILE: GPMOVES.FD
49792>>>>>>>>>>>>>>>Open Sysrecg
49794>>>>>>>>>>>>>>>Open Syscurgl
49796>>>>>>>>>>>>>>>
49796>>>>>>>>>>>>>>>//DDB-HeaderEnd
49796>>>>>>>>>>>>>>>//DDB-ValidationStart
49796>>>>>>>>>>>>>>>
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_O_Code_VT
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Yn_VT
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Xpm_VT
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Doy_VT
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_J_Code_VT
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_C_Code2_VT
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_I_A_Code_VT2
49796>>>>>>>>>>>>>>>Register_Object Gplan_Gplan_Myf_Sum_VT
49796>>>>>>>>>>>>>>>
49796>>>>>>>>>>>>>>>Object Gplan_Gplan_O_Code_VT  is a CodeValidationTable
49798>>>>>>>>>>>>>>>    Set Type_Value        To "OMADA"
49799>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49800>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49800>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49800>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_O_Code_VT
49801>>>>>>>>>>>>>>>
49801>>>>>>>>>>>>>>>Object Gplan_Gplan_Yn_VT  is a CodeValidationTable
49803>>>>>>>>>>>>>>>    Set Type_Value        To "YESNO"
49804>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49804>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49804>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Yn_VT
49805>>>>>>>>>>>>>>>
49805>>>>>>>>>>>>>>>Object Gplan_Gplan_Xpm_VT  is a DescriptionValidationTable
49807>>>>>>>>>>>>>>>
49807>>>>>>>>>>>>>>>    Procedure Fill_List
49809>>>>>>>>>>>>>>>        Forward Send Fill_List
49811>>>>>>>>>>>>>>>        Send Add_Table_Value  "1"  "•¨œ¦ç£œ¤¦ª"
49812>>>>>>>>>>>>>>>        Send Add_Table_Value  "2"  " ©«¦ç£œ¤¦ª"
49813>>>>>>>>>>>>>>>        Send Add_Table_Value  "3"  "‹ ¡«æª"
49814>>>>>>>>>>>>>>>    End_Procedure    // Fill_List
49815>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49815>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49815>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Xpm_VT
49816>>>>>>>>>>>>>>>
49816>>>>>>>>>>>>>>>Object Gplan_Gplan_Doy_VT  is a CodeValidationTable
49818>>>>>>>>>>>>>>>    Set Type_Value        To "DOY"
49819>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49820>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49820>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49820>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Doy_VT
49821>>>>>>>>>>>>>>>
49821>>>>>>>>>>>>>>>Object Gplan_Gplan_J_Code_VT  is a CodeValidationTable
49823>>>>>>>>>>>>>>>    Set Type_Value        To "JOB"
49824>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49825>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49825>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49825>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_J_Code_VT
49826>>>>>>>>>>>>>>>
49826>>>>>>>>>>>>>>>Object Gplan_Gplan_C_Code2_VT  is a CodeValidationTable
49828>>>>>>>>>>>>>>>    Set Type_Value        To "CURRENCY"
49829>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49830>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49830>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49830>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_C_Code2_VT
49831>>>>>>>>>>>>>>>
49831>>>>>>>>>>>>>>>Object Gplan_Gplan_I_A_Code_VT2  is a CodeValidationTable
49833>>>>>>>>>>>>>>>    Set Type_Value        To "AITIOL"
49834>>>>>>>>>>>>>>>    Set Allow_Blank_State To TRUE
49835>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49835>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49835>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_I_A_Code_VT2
49836>>>>>>>>>>>>>>>
49836>>>>>>>>>>>>>>>Object Gplan_Gplan_Myf_Sum_VT  is a CodeValidationTable
49838>>>>>>>>>>>>>>>    Set Type_Value        To "MYF"
49839>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
49839>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
49839>>>>>>>>>>>>>>>End_Object   // Gplan_Gplan_Myf_Sum_VT
49840>>>>>>>>>>>>>>>//DDB-ValidationEnd
49840>>>>>>>>>>>>>>>//DDB-SelectionStart
49840>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList sl150  sl150.sl
49840>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gtypkin  Gtypkin.sl
49840>>>>>>>>>>>>>>>Register_Object sl150
49840>>>>>>>>>>>>>>>Register_Object Gtypkin
49840>>>>>>>>>>>>>>>//DDB-SelectionEnd
49840>>>>>>>>>>>>>>>Use arrays.Sub
49840>>>>>>>>>>>>>>>
49840>>>>>>>>>>>>>>>Use Gmovea.dd //®¨œ áœ«˜  ¦§à›ã§¦«œ, › æ«  œå¤˜  alias file ¡˜ 
INCLUDING FILE: GMOVEA.DD
49840>>>>>>>>>>>>>>>>>//DDB-FileStart
49840>>>>>>>>>>>>>>>>>//DDB-HeaderStart
49840>>>>>>>>>>>>>>>>>
49840>>>>>>>>>>>>>>>>>// File Name : GMOVEA.DD
49840>>>>>>>>>>>>>>>>>// Class Name: Gmovea_DataDictionary
49840>>>>>>>>>>>>>>>>>// Revision  : 17
49840>>>>>>>>>>>>>>>>>// Version   : 2
49840>>>>>>>>>>>>>>>>>
49840>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
49840>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
49840>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
49840>>>>>>>>>>>>>>>>>
49840>>>>>>>>>>>>>>>>>Open Gmovea
49842>>>>>>>>>>>>>>>>>Open Gopen
INCLUDING FILE: GOPEN.FD
49844>>>>>>>>>>>>>>>>>Open Garticl
INCLUDING FILE: GARTICL.FD
49846>>>>>>>>>>>>>>>>>Open Gplan
49848>>>>>>>>>>>>>>>>>
49848>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
49848>>>>>>>>>>>>>>>>>
49848>>>>>>>>>>>>>>>>>//open master file
49848>>>>>>>>>>>>>>>>>Open Gmove
49850>>>>>>>>>>>>>>>>>
49850>>>>>>>>>>>>>>>>>//define alias-master condition
49850>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmovea.File_Number to DF_FILE_IS_ALIAS
49853>>>>>>>>>>>>>>>>>Set_Attribute DF_FILE_ALIAS of Gmove.File_Number  to DF_FILE_IS_MASTER
49856>>>>>>>>>>>>>>>>>
49856>>>>>>>>>>>>>>>>>//clear all relationships from the alias file
49856>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Garticl_Recr to |FN0,0
49857>>>>>>>>>>>>>>>>>>
49857>>>>>>>>>>>>>>>>>Set_Relate Gmovea.Gplan_Recr   to |FN0,0
49858>>>>>>>>>>>>>>>>>>
49858>>>>>>>>>>>>>>>>>
49858>>>>>>>>>>>>>>>>>
49858>>>>>>>>>>>>>>>>>Class Gmovea_DataDictionary  is a DataDictionary_Sec
49859>>>>>>>>>>>>>>>>>
49859>>>>>>>>>>>>>>>>>
49859>>>>>>>>>>>>>>>>>      //private
49859>>>>>>>>>>>>>>>>>      //œ¤ž£œ¨é¤œ  «˜ 13 §œ›å˜ open item
49859>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ update
49859>>>>>>>>>>>>>>>>>      Procedure private.Do_Compute_Open_Itemsa
49860>>>>>>>>>>>>>>>>>                Case Begin
49860>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
49862>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
49863>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_X0  - Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
49864>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
49865>>>>>>>>>>>>>>>>>                     Case Break
49866>>>>>>>>>>>>>>>>>
49866>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
49869>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
49870>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_X0))- Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
49871>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
49872>>>>>>>>>>>>>>>>>                     Case Break
49873>>>>>>>>>>>>>>>>>
49873>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
49876>>>>>>>>>>>>>>>>>                          Move "-"                                                 to Gmovea.Gmove_Topen
49877>>>>>>>>>>>>>>>>>                          Move (     Gmovea.Gmove_P0  - Gmovea.Gmove_Open_Sp0) to Gmovea.Gmove_Open_Yp0
49878>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yx0
49879>>>>>>>>>>>>>>>>>                     Case Break
49880>>>>>>>>>>>>>>>>>
49880>>>>>>>>>>>>>>>>>                     Case (Gmovea.Gmove_P0 < 0) //¯œç«¦- ®¨œà©« ¡æ record
49883>>>>>>>>>>>>>>>>>                          Move "+"                                                 to Gmovea.Gmove_Topen
49884>>>>>>>>>>>>>>>>>                          Move ((Abs(Gmovea.Gmove_P0))- Gmovea.Gmove_Open_Sx0) to Gmovea.Gmove_Open_Yx0
49885>>>>>>>>>>>>>>>>>                          Move 0                                                   to Gmovea.Gmove_Open_Yp0
49886>>>>>>>>>>>>>>>>>                     Case Break
49887>>>>>>>>>>>>>>>>>                Case End
49887>>>>>>>>>>>>>>>>>      End_Procedure //private.do_compute_open_itemsa
49888>>>>>>>>>>>>>>>>>
49888>>>>>>>>>>>>>>>>>
49888>>>>>>>>>>>>>>>>>
49888>>>>>>>>>>>>>>>>>      //private
49888>>>>>>>>>>>>>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
49888>>>>>>>>>>>>>>>>>      //¡˜¢œå«˜  ˜§æ validate save
49888>>>>>>>>>>>>>>>>>      Function  private.fi_Validate_Open_Itemsa Returns Integer
49889>>>>>>>>>>>>>>>>>
49889>>>>>>>>>>>>>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
49889>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 >= 0                       )) Function_Return 1101
49892>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 >= 0                       )) Function_Return 1102
49895>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 >= 0                       )) Function_Return 1103
49898>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 >= 0                       )) Function_Return 1104
49901>>>>>>>>>>>>>>>>>
49901>>>>>>>>>>>>>>>>>                 Case Begin
49901>>>>>>>>>>>>>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
49901>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 > 0)
49903>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <=      Gmovea.Gmove_X0  )) Function_Return 1105
49906>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <=      Gmovea.Gmove_X0  )) Function_Return 1106
49909>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1107
49912>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1108
49915>>>>>>>>>>>>>>>>>                      Case Break
49916>>>>>>>>>>>>>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
49916>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_X0 < 0)
49919>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1109
49922>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1110
49925>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1111
49928>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <= (Abs(Gmovea.Gmove_X0)))) Function_Return 1112
49931>>>>>>>>>>>>>>>>>                      Case Break
49932>>>>>>>>>>>>>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
49932>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 > 0)
49935>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0  = 0                       )) Function_Return 1113
49938>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0  = 0                       )) Function_Return 1114
49941>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0 <=      Gmovea.Gmove_P0  )) Function_Return 1115
49944>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0 <=      Gmovea.Gmove_P0  )) Function_Return 1116
49947>>>>>>>>>>>>>>>>>                      Case Break
49948>>>>>>>>>>>>>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
49948>>>>>>>>>>>>>>>>>                      Case (Gmovea.Gmove_P0 < 0)
49951>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1117
49954>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sx0 <= (Abs(Gmovea.Gmove_P0)))) Function_Return 1118
49957>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Yp0  = 0                       )) Function_Return 1119
49960>>>>>>>>>>>>>>>>>                           If (Not(Gmovea.Gmove_Open_Sp0  = 0                       )) Function_Return 1120
49963>>>>>>>>>>>>>>>>>                      Case Break
49964>>>>>>>>>>>>>>>>>                 Case End
49964>>>>>>>>>>>>>>>>>
49964>>>>>>>>>>>>>>>>>                 Function_Return 0 //æ¢˜ ok
49965>>>>>>>>>>>>>>>>>      End_Function //private.fi_validate_open_itemsa
49966>>>>>>>>>>>>>>>>>
49966>>>>>>>>>>>>>>>>>    Procedure Update
49967>>>>>>>>>>>>>>>>>          Send private.Do_Compute_Open_Itemsa
49968>>>>>>>>>>>>>>>>>    End_Procedure //update
49969>>>>>>>>>>>>>>>>>
49969>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
49970>>>>>>>>>>>>>>>>>              String lsError_Message
49971>>>>>>>>>>>>>>>>>              Case Begin
49971>>>>>>>>>>>>>>>>>                   //˜§æ validate save
49971>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1101)
49973>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
49974>>>>>>>>>>>>>>>>>                   Case Break
49975>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1102)
49978>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ œå¤˜  ˜¨¤ž« ¡æ !");                        to lsError_Message
49979>>>>>>>>>>>>>>>>>                   Case Break
49980>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1103)
49983>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
49984>>>>>>>>>>>>>>>>>                   Case Break
49985>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1104)
49988>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª œå¤˜  ˜¨¤ž« ¡ã !");                        to lsError_Message
49989>>>>>>>>>>>>>>>>>                   Case Break
49990>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª ®¨œé©œ ª-----------------
49990>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1105)
49993>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
49994>>>>>>>>>>>>>>>>>                   Case Break
49995>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1106)
49998>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã ®¨âà©ž !");                        to lsError_Message
49999>>>>>>>>>>>>>>>>>                   Case Break
50000>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1107)
50003>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
50004>>>>>>>>>>>>>>>>>                   Case Break
50005>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1108)
50008>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
50009>>>>>>>>>>>>>>>>>                   Case Break
50010>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨¤ž« ¡âª ®¨œé©œ ª---------------
50010>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1109)
50013>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
50014>>>>>>>>>>>>>>>>>                   Case Break
50015>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1110)
50018>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
50019>>>>>>>>>>>>>>>>>                   Case Break
50020>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1111)
50023>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
50024>>>>>>>>>>>>>>>>>                   Case Break
50025>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1112)
50028>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã •¨œà©« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª ®¨âà©žª !");                        to lsError_Message
50029>>>>>>>>>>>>>>>>>                   Case Break
50030>>>>>>>>>>>>>>>>>                   //---------------------------------------Ÿœ« ¡âª § ©«é©œ ª----------------
50030>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1113)
50033>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ !");                        to lsError_Message
50034>>>>>>>>>>>>>>>>>                   Case Break
50035>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1114)
50038>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
50039>>>>>>>>>>>>>>>>>                   Case Break
50040>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1115)
50043>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
50044>>>>>>>>>>>>>>>>>                   Case Break
50045>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1116)
50048>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ¦¢ ¡ã §å©«à©ž !");                        to lsError_Message
50049>>>>>>>>>>>>>>>>>                   Case Break
50050>>>>>>>>>>>>>>>>>                   //---------------------------------------˜¨àž« ¡âª § ©«é©œ ª----------------
50050>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1117)
50053>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ ®¨œà©« ¡æ ¬§æ¢¦ §¦ ›â¤ œå¤˜  £ž›œ¤ ¡æ!");                        to lsError_Message
50054>>>>>>>>>>>>>>>>>                   Case Break
50055>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1118)
50058>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª ®¨âà©žª ›â¤ œå¤˜  £ž›œ¤ ¡ã !");                        to lsError_Message
50059>>>>>>>>>>>>>>>>>                   Case Break
50060>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1119)
50063>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "’¦ ˜©¬©®â« ©«¦ § ©«à« ¡æ ¬§æ¢¦ §¦ ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
50064>>>>>>>>>>>>>>>>>                   Case Break
50065>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1120) //soso ayto den xoraei display stin othoni !
50068>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€¡˜«á¢¢ž¢ž €¨¤ž« ¡ã  ©«à« ¡ã „šš¨˜­ã (‰ç¨ ¦ Œæ£ ©£˜ •¨ã©œàª).\n\n"+;                        "† ¡á¢¬¯ž «žª §å©«à©žª ¬§œ¨™˜å¤œ  «ž¤ ˜§æ¢¬«ž « £ã «žª ˜¨¤ž« ¡ãª §å©«à©žª !");                        to lsError_Message
50069>>>>>>>>>>>>>>>>>                   Case Break
50070>>>>>>>>>>>>>>>>>
50070>>>>>>>>>>>>>>>>>
50070>>>>>>>>>>>>>>>>>                   //˜§æ validate delete
50070>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2001)
50073>>>>>>>>>>>>>>>>>                        Move ("DDC 067:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n˜¨˜¡˜¢é ¡˜¢â©˜«œ «ž¤ Solution !");                        to lsError_Message
50074>>>>>>>>>>>>>>>>>                   Case Break
50075>>>>>>>>>>>>>>>>>
50075>>>>>>>>>>>>>>>>>                   Case Else
50075>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed iError_Num
50077>>>>>>>>>>>>>>>>>              Case End
50077>>>>>>>>>>>>>>>>>
50077>>>>>>>>>>>>>>>>>              Error iError_Num lsError_Message
50078>>>>>>>>>>>>>>>>>>
50078>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
50079>>>>>>>>>>>>>>>>>
50079>>>>>>>>>>>>>>>>>
50079>>>>>>>>>>>>>>>>>    Function Validate_Save Returns Integer
50080>>>>>>>>>>>>>>>>>             Integer iReturnVal liOpen_Itemsa
50081>>>>>>>>>>>>>>>>>             Forward Get Validate_Save to iReturnVal
50083>>>>>>>>>>>>>>>>>
50083>>>>>>>>>>>>>>>>>             If (Not(iReturnVal));             Begin
50085>>>>>>>>>>>>>>>>>             //1101-1120:â¢œš®¦  open item
50085>>>>>>>>>>>>>>>>>              Move (private.fi_Validate_Open_Itemsa(Self)) to liOpen_Itemsa
50086>>>>>>>>>>>>>>>>>              If (liOpen_Itemsa <> 0) Send Operation_Not_Allowed liOpen_Itemsa
50089>>>>>>>>>>>>>>>>>             End //«â¢¦ª ¡é› ¡˜ validation
50089>>>>>>>>>>>>>>>>>>
50089>>>>>>>>>>>>>>>>>
50089>>>>>>>>>>>>>>>>>
50089>>>>>>>>>>>>>>>>>             Function_Return iReturnVal
50090>>>>>>>>>>>>>>>>>    End_Function //validate_save
50091>>>>>>>>>>>>>>>>>
50091>>>>>>>>>>>>>>>>>
50091>>>>>>>>>>>>>>>>>    //2001:«¦ alias Gmovea ›â¤ œ§ «¨â§œ  ‰ € ‹ ˆ €   › ˜š¨˜­ã
50091>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
50092>>>>>>>>>>>>>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
50093>>>>>>>>>>>>>>>>>    End_Function //validate_delete
50094>>>>>>>>>>>>>>>>>
50094>>>>>>>>>>>>>>>>>
50094>>>>>>>>>>>>>>>>>    // Define_Fields:
50094>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50094>>>>>>>>>>>>>>>>>
50094>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50095>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50097>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50097>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50097>>>>>>>>>>>>>>>>>
50097>>>>>>>>>>>>>>>>>        Set Main_File            To Gmovea.File_Number
50098>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50099>>>>>>>>>>>>>>>>>
50099>>>>>>>>>>>>>>>>>
50099>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50099>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gopen.File_Number
50100>>>>>>>>>>>>>>>>>
50100>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
50100>>>>>>>>>>>>>>>>>        Send Add_Server_File  Garticl.File_Number
50101>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gplan.File_Number
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Company_Code
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Branch_Code
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Year_Year
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Code
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Hmnia
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_No
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Garticl_Recr
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Recr
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Rec0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Code
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aitiol
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X0k
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P0k
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X00k
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P00k
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X1
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P1
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_X2k
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_P2k
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xr
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Pr
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Xrk
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Prk
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Dlixis
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_A_Code
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Code
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aa
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp0
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx1
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp1
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx1
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp1
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sx2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Sp2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yx2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open_Yp2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Sc_Code2
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Open
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Aopen
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Topen
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Kk
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gthhmgio_Period
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfp
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Yn_Myfa
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Sump
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gplan_Myf_Suma
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag01
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag02
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag03
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag04
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag05
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag06
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag07
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag08
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag09
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag10
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag11
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag12
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag13
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag14
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag15
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag16
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag17
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag18
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag19
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gtypkin_Flag20
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Year_Recr
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        // Gmovea.Gmove_Recr
50102>>>>>>>>>>>>>>>>>
50102>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50102>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50103>>>>>>>>>>>>>>>>>
50103>>>>>>>>>>>>>>>>>    // Field_Defaults:
50103>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50103>>>>>>>>>>>>>>>>>
50103>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50104>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50106>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50106>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50106>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50106>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50107>>>>>>>>>>>>>>>>>End_Class    // Gmovea_DataDictionary
50108>>>>>>>>>>>>>>>>>//DDB-FileEnd
50108>>>>>>>>>>>>>>>              //©«ž¤ begin_transaction §¨¦¡˜¢œå deadlock
50108>>>>>>>>>>>>>>>
50108>>>>>>>>>>>>>>>Class Gplan_DataDictionary  is a DataDictionary_Sec
50109>>>>>>>>>>>>>>>
50109>>>>>>>>>>>>>>>    Procedure Construct_Object
50110>>>>>>>>>>>>>>>        Forward Send Construct_Object
50112>>>>>>>>>>>>>>>        Object oarrayGplan_Aux is a cPinakas
50114>>>>>>>>>>>>>>>        End_Object
50115>>>>>>>>>>>>>>>        Property Integer    pioarray_Gplan_Aux (oarrayGplan_Aux(self))
50116>>>>>>>>>>>>>>>        Property String     psValidChars ""
50117>>>>>>>>>>>>>>>        Property Integer    piMustNOTConstrain Public 0 
50118>>>>>>>>>>>>>>>        Property String     psBranch 
50119>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
50120>>>>>>>>>>>>>>>
50120>>>>>>>>>>>>>>>    Procedure OnConstrain
50121>>>>>>>>>>>>>>>        Forward Send OnConstrain
50123>>>>>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
50125>>>>>>>>>>>>>>>        End
50125>>>>>>>>>>>>>>>>
50125>>>>>>>>>>>>>>>        Else Begin
50126>>>>>>>>>>>>>>>            Constrain Gplan.Company_Code  eq SysCurGL.Company_Code
50128>>>>>>>>>>>>>>>            Constrain Gplan.Branch_Code   eq SysCurGL.Branch_Code
50130>>>>>>>>>>>>>>>        End
50130>>>>>>>>>>>>>>>>
50130>>>>>>>>>>>>>>>    End_Procedure
50131>>>>>>>>>>>>>>>
50131>>>>>>>>>>>>>>>    Procedure Update
50132>>>>>>>>>>>>>>>        Forward Send Update
50134>>>>>>>>>>>>>>>        // Insert Code Here
50134>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gplan.Company_Code
50135>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gplan.Branch_Code
50136>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gplan.Year_Year
50137>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gplan.Year_Recr
50138>>>>>>>>>>>>>>>    End_Procedure   // Update
50139>>>>>>>>>>>>>>>
50139>>>>>>>>>>>>>>>    Procedure Creating
50140>>>>>>>>>>>>>>>        Forward Send Creating
50142>>>>>>>>>>>>>>>        // Insert Code Here
50142>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gplan.Gplan_Rec0)))))) to Gplan.Gplan_Recr
50143>>>>>>>>>>>>>>>    End_Procedure   // Creating
50144>>>>>>>>>>>>>>>
50144>>>>>>>>>>>>>>>
50144>>>>>>>>>>>>>>>//////////////////////////////////////
50144>>>>>>>>>>>>>>>//////////////////////////////////////
50144>>>>>>>>>>>>>>>
50144>>>>>>>>>>>>>>>    Function fiCheckValidChars String asGplanCode String asValChars Returns Integer
50145>>>>>>>>>>>>>>>        String lsChar
50146>>>>>>>>>>>>>>>        Integer liLen liCharPos rVal
50146>>>>>>>>>>>>>>>        If (asGplanCode <> "") Begin
50148>>>>>>>>>>>>>>>            Move (Trim(asGplanCode)) to asGplanCode
50149>>>>>>>>>>>>>>>            Move (Length(asGplanCode)) to liLen
50150>>>>>>>>>>>>>>>            For liCharPos From 1 to liLen
50156>>>>>>>>>>>>>>>>
50156>>>>>>>>>>>>>>>               Move (Mid(asGplanCode,1,liCharPos)) to lsChar
50157>>>>>>>>>>>>>>>               If (Not(asValChars contains lsChar)) Begin
50159>>>>>>>>>>>>>>>                    Set psValidChars to asValChars
50160>>>>>>>>>>>>>>>                    Function_Return 1001
50161>>>>>>>>>>>>>>>               End
50161>>>>>>>>>>>>>>>>
50161>>>>>>>>>>>>>>>            Loop
50162>>>>>>>>>>>>>>>>
50162>>>>>>>>>>>>>>>        End
50162>>>>>>>>>>>>>>>>
50162>>>>>>>>>>>>>>>        Function_Return rVal
50163>>>>>>>>>>>>>>>    End_Function // fiCheckValidChars
50164>>>>>>>>>>>>>>>
50164>>>>>>>>>>>>>>>    // private_Do_Restore_Fields:
50164>>>>>>>>>>>>>>>    Procedure private_Do_Restore_Fields for Gplan_DataDictionary
50165>>>>>>>>>>>>>>>        // Insert Code Here
50165>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
50166>>>>>>>>>>>>>>>        Local Integer liFile##
50166>>>>>>>>>>>>>>>        Local Integer liField_Count##
50166>>>>>>>>>>>>>>>        Local Integer liField_Type##
50166>>>>>>>>>>>>>>>        Local Integer liField##
50166>>>>>>>>>>>>>>>
50166>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
50167>>>>>>>>>>>>>>>        Get Main_File to liFile##
50168>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
50171>>>>>>>>>>>>>>>
50171>>>>>>>>>>>>>>>
50171>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
50177>>>>>>>>>>>>>>>>
50177>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
50177>>>>>>>>>>>>>>>            move liField## to Fieldindex
50178>>>>>>>>>>>>>>>            Get Array_Value of lioarray_Gplan_Aux## Item (liField##+1) to Gplan.Company_Code&
50179>>>>>>>>>>>>>>>        Loop
50180>>>>>>>>>>>>>>>>
50180>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
50181>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Restore_Fields
50182>>>>>>>>>>>>>>>
50182>>>>>>>>>>>>>>>    // private_Do_Keep_Fields:
50182>>>>>>>>>>>>>>>
50182>>>>>>>>>>>>>>>    Procedure private_Do_Keep_Fields for Gplan_DataDictionary
50183>>>>>>>>>>>>>>>        // Insert Code Here
50183>>>>>>>>>>>>>>>        Local Integer lioarray_Gplan_Aux##
50184>>>>>>>>>>>>>>>        Local Integer liFile##
50184>>>>>>>>>>>>>>>        Local Integer liField_Count##
50184>>>>>>>>>>>>>>>        Local Integer liField_Type##
50184>>>>>>>>>>>>>>>        Local Integer liField##
50184>>>>>>>>>>>>>>>
50184>>>>>>>>>>>>>>>        Get pioarray_Gplan_Aux to lioarray_Gplan_Aux##
50185>>>>>>>>>>>>>>>        Get Main_File to liFile##
50186>>>>>>>>>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of liFile## to liField_Count##
50189>>>>>>>>>>>>>>>
50189>>>>>>>>>>>>>>>        Send Delete_Data to lioarray_Gplan_Aux##
50190>>>>>>>>>>>>>>>        Send Add_Item to lioarray_Gplan_Aux## 0 //sos.sos
50191>>>>>>>>>>>>>>>
50191>>>>>>>>>>>>>>>        For liField## from 0 to (liField_Count##-1)
50197>>>>>>>>>>>>>>>>
50197>>>>>>>>>>>>>>>            //Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
50197>>>>>>>>>>>>>>>            move liField## to Fieldindex
50198>>>>>>>>>>>>>>>            Send Add_Item to lioarray_Gplan_Aux## Gplan.Company_Code&
50199>>>>>>>>>>>>>>>        Loop
50200>>>>>>>>>>>>>>>>
50200>>>>>>>>>>>>>>>    End_Procedure   // private_Do_Keep_Fields
50201>>>>>>>>>>>>>>>
50201>>>>>>>>>>>>>>>    // Request_Save:
50201>>>>>>>>>>>>>>>
50201>>>>>>>>>>>>>>>
50201>>>>>>>>>>>>>>>
50201>>>>>>>>>>>>>>>//-----------------------------------------------------------------------------
50201>>>>>>>>>>>>>>>    FUNCTION Compute_Bathmos for Gplan_DataDictionary STRING KODIKOS## RETURNS INTEGER
50202>>>>>>>>>>>>>>>             LOCAL INTEGER BATHMOS##
50203>>>>>>>>>>>>>>>             REPEAT
50203>>>>>>>>>>>>>>>>
50203>>>>>>>>>>>>>>>                   REPLACE "." IN KODIKOS## WITH ""
50205>>>>>>>>>>>>>>>                   [FOUND] INCREMENT BATHMOS##
50206>>>>>>>>>>>>>>>             UNTIL (FINDERR=1)
50208>>>>>>>>>>>>>>>             FUNCTION_RETURN (BATHMOS##+1)
50209>>>>>>>>>>>>>>>    END_FUNCTION //compute_bathmos
50210>>>>>>>>>>>>>>>
50210>>>>>>>>>>>>>>>    FUNCTION Find_Previous for Gplan_DataDictionary STRING LS_CODE1## RETURNS STRING
50211>>>>>>>>>>>>>>>        LOCAL STRING LS_TEMP_CODE1## LS_TEMP_CODE2##
50212>>>>>>>>>>>>>>>        LOCAL INTEGER LI_COUNTER##
50212>>>>>>>>>>>>>>>
50212>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_CODE1##))
50218>>>>>>>>>>>>>>>>
50218>>>>>>>>>>>>>>>             INSERT (MID(LS_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE1## AT 1
50220>>>>>>>>>>>>>>>        LOOP
50221>>>>>>>>>>>>>>>>
50221>>>>>>>>>>>>>>>        MOVE (RIGHT(LS_TEMP_CODE1##,(LENGTH(LS_TEMP_CODE1##)-(POS(".",LS_TEMP_CODE1##))))) ;             TO LS_TEMP_CODE1##
50222>>>>>>>>>>>>>>>        FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_TEMP_CODE1##))
50228>>>>>>>>>>>>>>>>
50228>>>>>>>>>>>>>>>            INSERT (MID(LS_TEMP_CODE1##,1,LI_COUNTER##)) IN LS_TEMP_CODE2## AT 1
50230>>>>>>>>>>>>>>>        LOOP
50231>>>>>>>>>>>>>>>>
50231>>>>>>>>>>>>>>>        FUNCTION_RETURN LS_TEMP_CODE2##
50232>>>>>>>>>>>>>>>    END_FUNCTION
50233>>>>>>>>>>>>>>>
50233>>>>>>>>>>>>>>>    FUNCTION fiCheck_Format STRING  LS_CODE1##;                            STRING  LS_MASK##;                            INTEGER LI_BATHMOS##;                            RETURNS INTEGER
50234>>>>>>>>>>>>>>>             String  LS_TEMP_CODE1## LS_TEMP_CODE2## LS_MASK2##
50235>>>>>>>>>>>>>>>             Integer LI_COUNTER## LI_BATHMOS1##
50235>>>>>>>>>>>>>>>             Move (Trim(ls_Code1##)) to ls_Code1##
50236>>>>>>>>>>>>>>>             Move (Trim(ls_Mask##))  to ls_Mask##
50237>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK##))
50243>>>>>>>>>>>>>>>>
50243>>>>>>>>>>>>>>>                  IF ((MID(LS_MASK##,1,LI_COUNTER##)) = ".") INCREMENT LI_BATHMOS1##
50246>>>>>>>>>>>>>>>                  IF (LI_BATHMOS1## < LI_BATHMOS##) ;                  INSERT (MID(LS_MASK##,1,LI_COUNTER##)) IN LS_MASK2## AT LI_COUNTER##
50250>>>>>>>>>>>>>>>             LOOP
50251>>>>>>>>>>>>>>>>
50251>>>>>>>>>>>>>>>             IF (;                  (LENGTH(LS_CODE1##)) <> (LENGTH(LS_MASK2##));                ) FUNCTION_RETURN 1000
50254>>>>>>>>>>>>>>>             FOR LI_COUNTER## FROM 1 TO (LENGTH(LS_MASK2##))
50260>>>>>>>>>>>>>>>>
50260>>>>>>>>>>>>>>>                  IF (;                      ((MID(LS_MASK2##,1,LI_COUNTER##)) = ".") AND;                      ((MID(LS_CODE1##,1,LI_COUNTER##)) <> ".");                     ) FUNCTION_RETURN 1000
50263>>>>>>>>>>>>>>>             LOOP
50264>>>>>>>>>>>>>>>>
50264>>>>>>>>>>>>>>>             FUNCTION_RETURN 0
50265>>>>>>>>>>>>>>>    END_FUNCTION //fiCHECK_FORMAT
50266>>>>>>>>>>>>>>>
50266>>>>>>>>>>>>>>>    Function fiBackward_Check for Gplan_DataDictionary String LsGplanCode_Back integer liBathmos Returns Integer
50267>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
50268>>>>>>>>>>>>>>>        Number liGplanRecnum
50268>>>>>>>>>>>>>>>        String LsSearch_CodePrevious
50268>>>>>>>>>>>>>>>
50268>>>>>>>>>>>>>>>        if (liBathmos > 1) begin
50270>>>>>>>>>>>>>>>
50270>>>>>>>>>>>>>>>            move (Current_Record(Self)) to liGplanRecnum
50271>>>>>>>>>>>>>>>            move gplan.Gplan_Yn_Last to liGplan_Yn_Last
50272>>>>>>>>>>>>>>>            Send private_Do_Keep_Fields
50273>>>>>>>>>>>>>>>
50273>>>>>>>>>>>>>>>            Move (Find_Previous(self,lsGplanCode_Back)) to lsSearch_CodePrevious
50274>>>>>>>>>>>>>>>
50274>>>>>>>>>>>>>>>            clear Gplan
50275>>>>>>>>>>>>>>>            move gs_Selected_Company_Code  to Gplan.Company_Code
50276>>>>>>>>>>>>>>>            move gs_Selected_Branch_Code   to Gplan.Branch_Code
50277>>>>>>>>>>>>>>>            move gi_Selected_Year          to Gplan.Year_Year
50278>>>>>>>>>>>>>>>            move lsSearch_CodePrevious     to Gplan.Gplan_Code
50279>>>>>>>>>>>>>>>            Find eq Gplan by index.1 // pkid
50280>>>>>>>>>>>>>>>>
50280>>>>>>>>>>>>>>>            If (Found = 0) begin
50282>>>>>>>>>>>>>>>                clear gplan
50283>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50284>>>>>>>>>>>>>>>                find eq gplan.recnum
50285>>>>>>>>>>>>>>>>
50285>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
50286>>>>>>>>>>>>>>>                Function_return  7001 //return to fiValidate
50287>>>>>>>>>>>>>>>            end
50287>>>>>>>>>>>>>>>>
50287>>>>>>>>>>>>>>>            else begin
50288>>>>>>>>>>>>>>>               // The  previous logar marked last  and current greater bathmos
50288>>>>>>>>>>>>>>>               if   (Gplan.Gplan_yn_Last = 1) begin
50290>>>>>>>>>>>>>>>                   Send private_Do_Restore_Fields
50291>>>>>>>>>>>>>>>                   Function_return 7003
50292>>>>>>>>>>>>>>>               end
50292>>>>>>>>>>>>>>>>
50292>>>>>>>>>>>>>>>               clear gplan
50293>>>>>>>>>>>>>>>               move liGplanRecnum to gplan.recnum
50294>>>>>>>>>>>>>>>               find eq gplan.recnum
50295>>>>>>>>>>>>>>>>
50295>>>>>>>>>>>>>>>               Send private_Do_Restore_Fields
50296>>>>>>>>>>>>>>>               function_Return 0 //ok
50297>>>>>>>>>>>>>>>            end
50297>>>>>>>>>>>>>>>>
50297>>>>>>>>>>>>>>>        end
50297>>>>>>>>>>>>>>>>
50297>>>>>>>>>>>>>>>        Function_Return 0
50298>>>>>>>>>>>>>>>    End_Function  // fiBackward_Check
50299>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
50299>>>>>>>>>>>>>>>
50299>>>>>>>>>>>>>>>
50299>>>>>>>>>>>>>>>    //-----------------------------------------------------------------------------
50299>>>>>>>>>>>>>>>    FUNCTION fiForward_Check for Gplan_DataDictionary STRING LS_GplanCode integer liMode Returns Integer
50300>>>>>>>>>>>>>>>        String lsNext_Anoep
50301>>>>>>>>>>>>>>>        Integer liGplan_Yn_Last
50301>>>>>>>>>>>>>>>        Number liGplanRecnum
50301>>>>>>>>>>>>>>>
50301>>>>>>>>>>>>>>>
50301>>>>>>>>>>>>>>>        //move gplan.recnum to liGplanRecnum
50301>>>>>>>>>>>>>>>        move (Current_Record(Self)) to liGplanRecnum
50302>>>>>>>>>>>>>>>        move gplan.Gplan_Code to lsNext_Anoep
50303>>>>>>>>>>>>>>>        move gplan.Gplan_Yn_Last to liGplan_Yn_Last
50304>>>>>>>>>>>>>>>        Send private_Do_Keep_Fields
50305>>>>>>>>>>>>>>>
50305>>>>>>>>>>>>>>>        if (liGplan_Yn_Last = 1)  begin
50307>>>>>>>>>>>>>>>            find gt gplan by index.1
50308>>>>>>>>>>>>>>>>
50308>>>>>>>>>>>>>>>            if (found = 0) begin
50310>>>>>>>>>>>>>>>                clear gplan
50311>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50312>>>>>>>>>>>>>>>                find eq gplan.recnum
50313>>>>>>>>>>>>>>>>
50313>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
50314>>>>>>>>>>>>>>>            end
50314>>>>>>>>>>>>>>>>
50314>>>>>>>>>>>>>>>            else begin
50315>>>>>>>>>>>>>>>                // The Current and the previous logar marked last
50315>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
50317>>>>>>>>>>>>>>>                    clear gplan
50318>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
50319>>>>>>>>>>>>>>>                    find eq gplan.recnum
50320>>>>>>>>>>>>>>>>
50320>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
50321>>>>>>>>>>>>>>>                    Function_return 7004
50322>>>>>>>>>>>>>>>                end
50322>>>>>>>>>>>>>>>>
50322>>>>>>>>>>>>>>>                else begin
50323>>>>>>>>>>>>>>>                    clear gplan
50324>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
50325>>>>>>>>>>>>>>>                    find eq gplan.recnum
50326>>>>>>>>>>>>>>>>
50326>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
50327>>>>>>>>>>>>>>>                end
50327>>>>>>>>>>>>>>>>
50327>>>>>>>>>>>>>>>            end
50327>>>>>>>>>>>>>>>>
50327>>>>>>>>>>>>>>>        end
50327>>>>>>>>>>>>>>>>
50327>>>>>>>>>>>>>>>
50327>>>>>>>>>>>>>>>        if (liMode = 1) begin
50329>>>>>>>>>>>>>>>            find gt gplan by index.1
50330>>>>>>>>>>>>>>>>
50330>>>>>>>>>>>>>>>            if (Found = 0) begin
50332>>>>>>>>>>>>>>>                clear gplan
50333>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50334>>>>>>>>>>>>>>>                find eq gplan.recnum
50335>>>>>>>>>>>>>>>>
50335>>>>>>>>>>>>>>>                Send private_Do_Restore_Fields
50336>>>>>>>>>>>>>>>            end
50336>>>>>>>>>>>>>>>>
50336>>>>>>>>>>>>>>>            else begin
50337>>>>>>>>>>>>>>>                if (Gplan.Gplan_Anoep = lsNext_Anoep) begin
50339>>>>>>>>>>>>>>>                    move liGplanRecnum to gplan.recnum
50340>>>>>>>>>>>>>>>                    find eq gplan.recnum
50341>>>>>>>>>>>>>>>>
50341>>>>>>>>>>>>>>>                    Send private_Do_Restore_Fields
50342>>>>>>>>>>>>>>>                    Function_return 7010 //called from validate delete
50343>>>>>>>>>>>>>>>                end
50343>>>>>>>>>>>>>>>>
50343>>>>>>>>>>>>>>>                move liGplanRecnum to gplan.recnum
50344>>>>>>>>>>>>>>>                find eq gplan.recnum
50345>>>>>>>>>>>>>>>>
50345>>>>>>>>>>>>>>>                //Send private_Do_Restore_Fields
50345>>>>>>>>>>>>>>>            end
50345>>>>>>>>>>>>>>>>
50345>>>>>>>>>>>>>>>        end
50345>>>>>>>>>>>>>>>>
50345>>>>>>>>>>>>>>>        Function_return 0
50346>>>>>>>>>>>>>>>    End_Function // fiForward_Check
50347>>>>>>>>>>>>>>>
50347>>>>>>>>>>>>>>>
50347>>>>>>>>>>>>>>>    Function private_Man_Gplan_Code for Gplan_DataDictionary integer liField## String lsGplan_Code integer liModeGplan Returns Integer
50348>>>>>>>>>>>>>>>
50348>>>>>>>>>>>>>>>        // Insert Code Here
50348>>>>>>>>>>>>>>>        Integer liCounter liPosition liLength liBathmos liRetVal
50349>>>>>>>>>>>>>>>        string lsMask lsCkeckChar lsSearchCode
50349>>>>>>>>>>>>>>>
50349>>>>>>>>>>>>>>>        Trim lsGplan_code to lsGplan_code
50350>>>>>>>>>>>>>>>>
50350>>>>>>>>>>>>>>>        Move lsGplan_Code to lsSearchCode
50351>>>>>>>>>>>>>>>    Search_Again:
50351>>>>>>>>>>>>>>>        clear Gformat
INCLUDING FILE: GFORMAT.FD
50352>>>>>>>>>>>>>>>        move SysCurGL.Company_Code  to Gformat.Company_Code
50353>>>>>>>>>>>>>>>        move SysCurGL.Branch_Code   to Gformat.Branch_Code
50354>>>>>>>>>>>>>>>        move SysCurGL.Year_Year     to Gformat.Year_Year
50355>>>>>>>>>>>>>>>        move lsSearchCode           to Gformat.Gformat_Code
50356>>>>>>>>>>>>>>>        Find eq Gformat by index.1
50357>>>>>>>>>>>>>>>>
50357>>>>>>>>>>>>>>>
50357>>>>>>>>>>>>>>>        if (Found = 1) begin
50359>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50360>>>>>>>>>>>>>>>            Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
50361>>>>>>>>>>>>>>>            if (liRetVal = 0) begin
50363>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50364>>>>>>>>>>>>>>>                if (liModeGplan = 0) Begin
50366>>>>>>>>>>>>>>>                    if (Not(Current_Record(self))) begin
50368>>>>>>>>>>>>>>>                        set field_default_value field Gplan.gplan_Bathmos to libathmos //from deo
50369>>>>>>>>>>>>>>>                    end
50369>>>>>>>>>>>>>>>>
50369>>>>>>>>>>>>>>>                end
50369>>>>>>>>>>>>>>>>
50369>>>>>>>>>>>>>>>                if (libathmos > 1) begin
50371>>>>>>>>>>>>>>>                    Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
50372>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
50374>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
50376>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
50377>>>>>>>>>>>>>>>                        End
50377>>>>>>>>>>>>>>>>
50377>>>>>>>>>>>>>>>                    End
50377>>>>>>>>>>>>>>>>
50377>>>>>>>>>>>>>>>                end
50377>>>>>>>>>>>>>>>>
50377>>>>>>>>>>>>>>>            function_return 0
50378>>>>>>>>>>>>>>>            end
50378>>>>>>>>>>>>>>>>
50378>>>>>>>>>>>>>>>            else begin
50379>>>>>>>>>>>>>>>                function_return 127
50380>>>>>>>>>>>>>>>            end
50380>>>>>>>>>>>>>>>>
50380>>>>>>>>>>>>>>>        end
50380>>>>>>>>>>>>>>>>
50380>>>>>>>>>>>>>>>        else begin
50381>>>>>>>>>>>>>>>            Move (Compute_Bathmos(self,lsSearchCode)) to liBathmos
50382>>>>>>>>>>>>>>>            if ((liBathmos-1) <> 0) begin
50384>>>>>>>>>>>>>>>                Move (Find_Previous(self,lsSearchCode)) to lsSearchCode
50385>>>>>>>>>>>>>>>                Goto Search_Again
50386>>>>>>>>>>>>>>>>
50386>>>>>>>>>>>>>>>            end
50386>>>>>>>>>>>>>>>>
50386>>>>>>>>>>>>>>>            else begin
50387>>>>>>>>>>>>>>>                clear Gformat
50388>>>>>>>>>>>>>>>                move SysCurGL.Company_Code  to Gformat.Company_Code
50389>>>>>>>>>>>>>>>                move SysCurGL.Branch_Code   to Gformat.Branch_Code
50390>>>>>>>>>>>>>>>                move SysCurGL.Year_Year     to Gformat.Year_Year
50391>>>>>>>>>>>>>>>                move "@@"                   to Gformat.Gformat_Code
50392>>>>>>>>>>>>>>>                Find eq Gformat by index.1 // pkid
50393>>>>>>>>>>>>>>>>
50393>>>>>>>>>>>>>>>//* to be a function
50393>>>>>>>>>>>>>>>                Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50394>>>>>>>>>>>>>>>                Move (fiCheck_Format(self,lsGplan_Code,gformat.gformat_mask,liBathmos)) to liRetVal
50395>>>>>>>>>>>>>>>                if (liRetVal = 0) begin
50397>>>>>>>>>>>>>>>                    Move (Compute_Bathmos(self,lsGplan_Code)) to liBathmos
50398>>>>>>>>>>>>>>>                    if (liModeGplan = 0) Begin
50400>>>>>>>>>>>>>>>                        if (Not(Current_Record(self))) begin
50402>>>>>>>>>>>>>>>                            set field_default_value field Gplan.gplan_Bathmos to libathmos //from Deo
50403>>>>>>>>>>>>>>>                        end
50403>>>>>>>>>>>>>>>>
50403>>>>>>>>>>>>>>>                    end
50403>>>>>>>>>>>>>>>>
50403>>>>>>>>>>>>>>>                    if (libathmos > 1) begin
50405>>>>>>>>>>>>>>>                        Move (Find_Previous(self,lsGplan_Code)) to lsSearchCode
50406>>>>>>>>>>>>>>>                        if (liModeGplan = 0) Begin
50408>>>>>>>>>>>>>>>                            if (Not(Current_Record(self))) begin
50410>>>>>>>>>>>>>>>                                set field_default_value field Gplan.gplan_Anoep to lsSearchCode //from Deo
50411>>>>>>>>>>>>>>>                            end
50411>>>>>>>>>>>>>>>>
50411>>>>>>>>>>>>>>>                        end
50411>>>>>>>>>>>>>>>>
50411>>>>>>>>>>>>>>>                    end
50411>>>>>>>>>>>>>>>>
50411>>>>>>>>>>>>>>>                function_return 0
50412>>>>>>>>>>>>>>>                end
50412>>>>>>>>>>>>>>>>
50412>>>>>>>>>>>>>>>                else begin
50413>>>>>>>>>>>>>>>                    function_return 127
50414>>>>>>>>>>>>>>>                end
50414>>>>>>>>>>>>>>>>
50414>>>>>>>>>>>>>>>
50414>>>>>>>>>>>>>>>                //* emd to be a function
50414>>>>>>>>>>>>>>>                function_return 0
50415>>>>>>>>>>>>>>>            end
50415>>>>>>>>>>>>>>>>
50415>>>>>>>>>>>>>>>        end
50415>>>>>>>>>>>>>>>>
50415>>>>>>>>>>>>>>>        Function_return 0    //ok
50416>>>>>>>>>>>>>>>    End_Function   // private_Man_Gplan_Code
50417>>>>>>>>>>>>>>>
50417>>>>>>>>>>>>>>>
50417>>>>>>>>>>>>>>>
50417>>>>>>>>>>>>>>>    // fiValidateGplanFields:
50417>>>>>>>>>>>>>>>
50417>>>>>>>>>>>>>>>    Function fiValidateGplanFields for Gplan_DataDictionary integer liField string lsFieldvalue Returns Integer
50418>>>>>>>>>>>>>>>        String  sName lsAnoep lsGplan_Code
50419>>>>>>>>>>>>>>>        Integer iMainFile liGplanRecnum liReturnVal liReturnValb liBathmos1
50419>>>>>>>>>>>>>>>        String lsValidChar lsDelimiter
50419>>>>>>>>>>>>>>>
50419>>>>>>>>>>>>>>>        Get Main_File to iMainFile
50420>>>>>>>>>>>>>>>        Get_Attribute DF_FIELD_NAME of iMainFile liField to sName
50423>>>>>>>>>>>>>>>
50423>>>>>>>>>>>>>>>        If (sName = 'GPLAN_CODE') Begin
50425>>>>>>>>>>>>>>>            move (trim(lsFieldvalue)) to lsFieldvalue //from deo
50426>>>>>>>>>>>>>>>            if (lsFieldvalue <>  "") begin //new
50428>>>>>>>>>>>>>>>                Move SyscurGL.Year_Valid_Char to lsValidChar
50429>>>>>>>>>>>>>>>                Move SyscurGL.Year_Delimiter  to lsDelimiter
50430>>>>>>>>>>>>>>>                Move (fiCheckValidChars(Self,lsFieldvalue,((Trim(lsValidChar))+(Trim(lsDelimiter))))) to liReturnVal
50431>>>>>>>>>>>>>>>                if (liReturnVal = '1001') begin
50433>>>>>>>>>>>>>>>                               error liReturnVal ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
50434>>>>>>>>>>>>>>>>
50434>>>>>>>>>>>>>>>                               Function_Return liReturnVal
50435>>>>>>>>>>>>>>>                            end
50435>>>>>>>>>>>>>>>>
50435>>>>>>>>>>>>>>>
50435>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,liField,lsFieldvalue,0)) to liReturnVal
50436>>>>>>>>>>>>>>>                if (lireturnval <> 0) begin
50438>>>>>>>>>>>>>>>                                        error 127 ("ŠáŸ¦ª £¦¨­ã ¡à› ¡¦ç !\n\n"+Gplan.Gplan_Code)
50439>>>>>>>>>>>>>>>>
50439>>>>>>>>>>>>>>>                                        function_return 127
50440>>>>>>>>>>>>>>>                                      end
50440>>>>>>>>>>>>>>>>
50440>>>>>>>>>>>>>>>
50440>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Code to lsGplan_Code
50441>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_Bathmos to liBathmos1
50442>>>>>>>>>>>>>>>                get field_current_value field Gplan.gplan_anoep to lsAnoep
50443>>>>>>>>>>>>>>>                Move (fiBackward_Check(self,lsGplan_Code,liBathmos1)) to liReturnValb
50444>>>>>>>>>>>>>>>                if (liReturnValb = '7001') begin
50446>>>>>>>>>>>>>>>                                               error 7001 "ƒœ¤ ¬§á¨®œ  ¦ §œ¨ ¢ž§« ¡æª ™˜Ÿ£æª !"
50447>>>>>>>>>>>>>>>>
50447>>>>>>>>>>>>>>>                                               Function_Return 8001
50448>>>>>>>>>>>>>>>                                            end
50448>>>>>>>>>>>>>>>>
50448>>>>>>>>>>>>>>>                if (liReturnValb = '7002') begin
50450>>>>>>>>>>>>>>>                                               error 7002 "“§á¨®œ  ¡à› ¡æª «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
50451>>>>>>>>>>>>>>>>
50451>>>>>>>>>>>>>>>                                               Function_Return 8002
50452>>>>>>>>>>>>>>>                                          end
50452>>>>>>>>>>>>>>>>
50452>>>>>>>>>>>>>>>                if (liReturnValb = '7003') begin
50454>>>>>>>>>>>>>>>                                               error 7003 "Ž §¨¦žš¦ç£œ¤¦ª œå¤˜  «œ¢œ¬«˜å¦¬ ™˜Ÿ£¦ç !"
50455>>>>>>>>>>>>>>>>
50455>>>>>>>>>>>>>>>                                               Function_Return 8003
50456>>>>>>>>>>>>>>>                                          end
50456>>>>>>>>>>>>>>>>
50456>>>>>>>>>>>>>>>
50456>>>>>>>>>>>>>>>                Move (fiForward_Check(self,lsGplan_Code,0)) to liReturnValb
50457>>>>>>>>>>>>>>>                if (liReturnValb = '7004') begin
50459>>>>>>>>>>>>>>>                                               error 7004 "“§á¨®œ  ¦ ˜¤é«œ¨¦ª ™˜Ÿ£æª !"
50460>>>>>>>>>>>>>>>>
50460>>>>>>>>>>>>>>>                                               Function_Return 8004
50461>>>>>>>>>>>>>>>                                            end
50461>>>>>>>>>>>>>>>>
50461>>>>>>>>>>>>>>>
50461>>>>>>>>>>>>>>>            end
50461>>>>>>>>>>>>>>>>
50461>>>>>>>>>>>>>>>            else Function_Return 0  //exit function ok!!!
50463>>>>>>>>>>>>>>>         end
50463>>>>>>>>>>>>>>>>
50463>>>>>>>>>>>>>>>         function_return 0
50464>>>>>>>>>>>>>>>    End_Function   // fiValidateGplanFields
50465>>>>>>>>>>>>>>>
50465>>>>>>>>>>>>>>>
50465>>>>>>>>>>>>>>>//-----------------------------------------------Save Operation ----------------------------------------------------
50465>>>>>>>>>>>>>>>
50465>>>>>>>>>>>>>>>
50465>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
50466>>>>>>>>>>>>>>>        //Forward Send Operation_Not_Allowed  iError_Num
50466>>>>>>>>>>>>>>>        // Insert Code Here
50466>>>>>>>>>>>>>>>                 if iError_num eq 127  error 127 ((Trim(Gplan.Gplan_Code))+" Wrong Format !!!! \n\n")
50469>>>>>>>>>>>>>>>            Else if iError_num eq 128  error 128 ("Not a valid Data Entry.  Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
50473>>>>>>>>>>>>>>>            Else if iError_num eq 129  error 129 ("Not a valid Data Entry.  Bathmos is Missing !!!!\n\n"+Gplan.Gplan_Code)
50477>>>>>>>>>>>>>>>            Else if iError_num eq 130  error 130 ("Not a valid Data Entry.  Previews Account is Missing !!!!\n\n"+Gplan.Gplan_Code)
50481>>>>>>>>>>>>>>>            Else if iError_num eq 1100  error 1100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50485>>>>>>>>>>>>>>>            Else if iError_num eq 2100  error 2100 "DDC:150 - ‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50489>>>>>>>>>>>>>>>            Else if iError_num eq 7001 error 8001 ("Anoep Does not Exist !!!!\n\n"+Gplan.Gplan_Code)
50493>>>>>>>>>>>>>>>            Else if iError_num eq 7002 error 8002 ("Last Exists\n\n!!!! "+Gplan.Gplan_Code)
50497>>>>>>>>>>>>>>>            Else if iError_num eq 7003 error 8003 ("Previous batmos is last  !!!!\n\n"+Gplan.Gplan_Code)
50501>>>>>>>>>>>>>>>            Else if iError_num eq 7004 error 8004 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
50505>>>>>>>>>>>>>>>            Else if iError_num eq 7010 error 7010 ("Greater bathmos exists  !!!!\n\n"+Gplan.Gplan_Code)
50509>>>>>>>>>>>>>>>            Else if (iError_num = 1001) error 1001 ("‹ž ˜§¦›œ¡«æª ®˜¨˜¡«ã¨˜ª š ˜ ¡à› ¡æ Š.‘ !\n\n€§¦›œ¡«¦å ®˜¨˜¡«ã¨œª : '" + (psValidChars(Self)) + "'")
50513>>>>>>>>>>>>>>>            Else Forward Send Operation_Not_Allowed  iError_Num
50516>>>>>>>>>>>>>>>    End_Procedure
50517>>>>>>>>>>>>>>>
50517>>>>>>>>>>>>>>>
50517>>>>>>>>>>>>>>>    Procedure Clear_From_Bpo
50518>>>>>>>>>>>>>>>        Clear Gplan
50519>>>>>>>>>>>>>>>    End_Procedure
50520>>>>>>>>>>>>>>>
50520>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
50521>>>>>>>>>>>>>>>        Local Integer iReturnVal iField##
50522>>>>>>>>>>>>>>>        locaL string lsVal##
50522>>>>>>>>>>>>>>>
50522>>>>>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
50524>>>>>>>>>>>>>>>
50524>>>>>>>>>>>>>>>
50524>>>>>>>>>>>>>>>        If (Not(iReturnVal))Begin
50526>>>>>>>>>>>>>>>        //    If (Not(Current_Record(Self))) Move (fiCheckValidChars(Self,Gplan.Gplan_Code,((Trim(Year.Year_Valid_Char))+(Trim(Year.Year_Delimiter))))) to iReturnVal
50526>>>>>>>>>>>>>>>        //    If (iReturnVal) Send Operation_Not_Allowed iReturnVal
50526>>>>>>>>>>>>>>>            If (Gplan.Gplan_Code    = "") Send Operation_Not_Allowed 128
50529>>>>>>>>>>>>>>>            If (Gplan.Gplan_Bathmos = 0 ) Send Operation_Not_Allowed 129
50532>>>>>>>>>>>>>>>            If (;                 (Gplan.Gplan_Bathmos <> 1) and;                 (Gplan.Gplan_Anoep = "");               ) Send Operation_Not_Allowed 130
50535>>>>>>>>>>>>>>>            For iField## from 4 to 4   // Field number for Starting and Ending pp's ???????
50541>>>>>>>>>>>>>>>>
50541>>>>>>>>>>>>>>>
50541>>>>>>>>>>>>>>>                Move (private_Man_Gplan_Code(self,iField##,Gplan.Gplan_Code,1))     to iReturnVal
50542>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
50545>>>>>>>>>>>>>>>
50545>>>>>>>>>>>>>>>                Move (fiBACKWARD_CHECK(self,Gplan.Gplan_Code,Gplan.Gplan_Bathmos)) to iReturnVal
50546>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
50549>>>>>>>>>>>>>>>
50549>>>>>>>>>>>>>>>                Move (fiFORWARD_CHECK(self,Gplan.Gplan_Code,0))                     to iReturnVal
50550>>>>>>>>>>>>>>>                If iReturnVal Send Operation_Not_Allowed iReturnVal
50553>>>>>>>>>>>>>>>
50553>>>>>>>>>>>>>>>            Loop
50554>>>>>>>>>>>>>>>>
50554>>>>>>>>>>>>>>>              //1100:cby = globals
50554>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 1100
50557>>>>>>>>>>>>>>>        End
50557>>>>>>>>>>>>>>>>
50557>>>>>>>>>>>>>>>        Function_Return iReturnVal
50558>>>>>>>>>>>>>>>    End_Function
50559>>>>>>>>>>>>>>>
50559>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
50560>>>>>>>>>>>>>>>        Local Integer iReturnVal liReturnValb##
50561>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
50563>>>>>>>>>>>>>>>
50563>>>>>>>>>>>>>>>        If (Not(iReturnVal)) Begin
50565>>>>>>>>>>>>>>>            // Insert Code Here
50565>>>>>>>>>>>>>>>               Move (fiFORWARD_CHECK(Self,Gplan.Gplan_Code,1)) to liReturnValb##
50566>>>>>>>>>>>>>>>               If (liReturnValb##>1) Send Operation_Not_Allowed liReturnValb##
50569>>>>>>>>>>>>>>>              //2100:cby = globals
50569>>>>>>>>>>>>>>>              If ( ;                   (Not(Gplan.Company_Code = SysCurGL.Company_Code)) or;                   (Not(Gplan.Branch_Code  = SysCurGL.Branch_Code )) ;                  ) Send Operation_Not_Allowed 2100
50572>>>>>>>>>>>>>>>        End
50572>>>>>>>>>>>>>>>>
50572>>>>>>>>>>>>>>>
50572>>>>>>>>>>>>>>>        Function_Return iReturnVal
50573>>>>>>>>>>>>>>>    End_Function
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>//    Procedure Update
50574>>>>>>>>>>>>>>>//        Forward Send Update
50574>>>>>>>>>>>>>>>//        // Insert Code Here
50574>>>>>>>>>>>>>>>//        Move Company.Company_Code  to Gplan.Company_Code
50574>>>>>>>>>>>>>>>//        Move Branch.Branch_Code    to Gplan.Branch_Code
50574>>>>>>>>>>>>>>>//        Move Year.Year_Year        to Gplan.Year_Year
50574>>>>>>>>>>>>>>>//        Add 1 to Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
50574>>>>>>>>>>>>>>>//    End_Procedure   // Update
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>//    Procedure Backout
50574>>>>>>>>>>>>>>>//        Forward Send Backout
50574>>>>>>>>>>>>>>>//        Sub 1 from Year.Year_NumGplan //˜¨ Ÿ£æª ¢¦š˜¨ ˜©£é¤ «žª ®¨ã©žª
50574>>>>>>>>>>>>>>>//    End_Procedure //deleting
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>    // Define_Fields:
50574>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50574>>>>>>>>>>>>>>>
50574>>>>>>>>>>>>>>>    Procedure Define_Fields
50575>>>>>>>>>>>>>>>        Forward Send Define_Fields
50577>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50577>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50577>>>>>>>>>>>>>>>
50577>>>>>>>>>>>>>>>        Set Main_File            To Gplan.File_Number
50578>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50579>>>>>>>>>>>>>>>
50579>>>>>>>>>>>>>>>
50579>>>>>>>>>>>>>>>        // Child (Client) file structure................
50579>>>>>>>>>>>>>>>        Send Add_Client_File  Gmovea.File_Number
50580>>>>>>>>>>>>>>>        Send Add_Client_File  Gplanmod.File_Number
50581>>>>>>>>>>>>>>>        Send Add_Client_File  Gmhnes.File_Number
50582>>>>>>>>>>>>>>>        Send Add_Client_File  Gvatd.File_Number
50583>>>>>>>>>>>>>>>        Send Add_Client_File  Gpmoves.File_Number
50584>>>>>>>>>>>>>>>
50584>>>>>>>>>>>>>>>        // External (System) file structure.............
50584>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
50585>>>>>>>>>>>>>>>        Send Add_System_File  Syscurgl.File_Number  DD_LOCK_ON_ALL
50586>>>>>>>>>>>>>>>
50586>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gplan_Rec0  To Gplan.Gplan_Rec0
50589>>>>>>>>>>>>>>>
50589>>>>>>>>>>>>>>>        // Field-based properties.......................
50589>>>>>>>>>>>>>>>
50589>>>>>>>>>>>>>>>        // Gplan.Company_Code
50589>>>>>>>>>>>>>>>
50589>>>>>>>>>>>>>>>        // Gplan.Branch_Code
50589>>>>>>>>>>>>>>>
50589>>>>>>>>>>>>>>>        // Gplan.Year_Year
50589>>>>>>>>>>>>>>>
50589>>>>>>>>>>>>>>>        // Gplan.Gplan_Code
50589>>>>>>>>>>>>>>>        Set Field_Exit_msg         Field Gplan.Gplan_Code To get_fiValidateGplanFields
50590>>>>>>>>>>>>>>>        Set Field_Options          Field Gplan.Gplan_Code To DD_AUTOFIND    DD_REQUIRED   
50591>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Code To (sl150(Self))
50592>>>>>>>>>>>>>>>
50592>>>>>>>>>>>>>>>        // Gplan.Gplan_Rec0
50592>>>>>>>>>>>>>>>
50592>>>>>>>>>>>>>>>        // Gplan.Year_Recr
50592>>>>>>>>>>>>>>>
50592>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr1
50592>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr1 To (sl150(Self))
50593>>>>>>>>>>>>>>>
50593>>>>>>>>>>>>>>>        // Gplan.Gplan_Descr2
50593>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Descr2 To (sl150(Self))
50594>>>>>>>>>>>>>>>
50594>>>>>>>>>>>>>>>        // Gplan.Gplan_Bathmos
50594>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Bathmos To "Calulated"
50594>>>>>>>>>>>>>>>
50594>>>>>>>>>>>>>>>        // Gplan.Gplan_Anoep
50594>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Anoep To "Calulated"
50594>>>>>>>>>>>>>>>
50594>>>>>>>>>>>>>>>        // Gplan.Gplan_O_Code
50594>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_O_Code To "dbComboFormSub"
50595>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_O_Code To (Gplan_Gplan_O_Code_VT(Self))
50596>>>>>>>>>>>>>>>
50596>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xfer
50596>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xfer To "dbComboFormSub"
50597>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xfer To (Gplan_Gplan_Yn_VT(Self))
50598>>>>>>>>>>>>>>>
50598>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Last
50598>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Last To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1013)"
50598>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Last To "dbComboFormSub"
50599>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Last To (Gplan_Gplan_Yn_VT(Self))
50600>>>>>>>>>>>>>>>
50600>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kin
50600>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Kin To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1014)"
50600>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kin To "dbComboFormSub"
50601>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kin To (Gplan_Gplan_Yn_VT(Self))
50602>>>>>>>>>>>>>>>
50602>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Kk
50602>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Kk To "dbComboFormSub"
50603>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Kk To (Gplan_Gplan_Yn_VT(Self))
50604>>>>>>>>>>>>>>>
50604>>>>>>>>>>>>>>>        // Gplan.Gplan_Xpm
50604>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Xpm To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1015+1016)"
50604>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Xpm To "dbComboFormSub"
50605>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Xpm To (Gplan_Gplan_Xpm_VT(Self))
50606>>>>>>>>>>>>>>>
50606>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Xy
50606>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Xy To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1017)"
50606>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Xy To "dbComboFormSub"
50607>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Xy To (Gplan_Gplan_Yn_VT(Self))
50608>>>>>>>>>>>>>>>
50608>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Py
50608>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Yn_Py To "•¨ž© £¦§¦ œå«˜  ©«ž¤ private.trexe «¦¬ Gmove (1018)"
50608>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Py To "dbComboFormSub"
50609>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Py To (Gplan_Gplan_Yn_VT(Self))
50610>>>>>>>>>>>>>>>
50610>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent
50610>>>>>>>>>>>>>>>
50610>>>>>>>>>>>>>>>        // Gplan.Gplan_Fpaent_Yn
50610>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Fpaent_Yn To (Gplan_Gplan_Yn_VT(Self))
50611>>>>>>>>>>>>>>>
50611>>>>>>>>>>>>>>>        // Gplan.Gplan_Afm
50611>>>>>>>>>>>>>>>
50611>>>>>>>>>>>>>>>        // Gplan.Gplan_Addr
50611>>>>>>>>>>>>>>>
50611>>>>>>>>>>>>>>>        // Gplan.Gplan_Tk
50611>>>>>>>>>>>>>>>
50611>>>>>>>>>>>>>>>        // Gplan.Gplan_Poli
50611>>>>>>>>>>>>>>>
50611>>>>>>>>>>>>>>>        // Gplan.Gplan_Doy
50611>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Doy To "dbComboFormSub"
50612>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Doy To (Gplan_Gplan_Doy_VT(Self))
50613>>>>>>>>>>>>>>>
50613>>>>>>>>>>>>>>>        // Gplan.Gplan_J_Code
50613>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_J_Code To "dbComboFormSub"
50614>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_J_Code To (Gplan_Gplan_J_Code_VT(Self))
50615>>>>>>>>>>>>>>>
50615>>>>>>>>>>>>>>>        // Gplan.Gplan_C_Code2
50615>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_C_Code2 To "•¨ž© £¦§¦ œå«˜  ©«ž¤ validate save «¦¬ Gmove (1019)"
50615>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_C_Code2 To "dbComboFormSub"
50616>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_C_Code2 To (Gplan_Gplan_C_Code2_VT(Self))
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_Tel
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_Email
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_Resp
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_Bitmap
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Code
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_Rep_Pct
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Xy_Code
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Py_Code
50617>>>>>>>>>>>>>>>
50617>>>>>>>>>>>>>>>        // Gplan.Gplan_I_Ctypkin
50617>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_I_Ctypkin To (Gtypkin(Self))
50618>>>>>>>>>>>>>>>
50618>>>>>>>>>>>>>>>        // Gplan.Gplan_I_A_Code
50618>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_I_A_Code To "dbComboFormSub"
50619>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_I_A_Code To (Gplan_Gplan_I_A_Code_VT2(Self))
50620>>>>>>>>>>>>>>>
50620>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfp
50620>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfp To "dbComboFormSub"
50621>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfp To (Gplan_Gplan_Yn_VT(Self))
50622>>>>>>>>>>>>>>>
50622>>>>>>>>>>>>>>>        // Gplan.Gplan_Yn_Myfa
50622>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Yn_Myfa To "dbComboFormSub"
50623>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Yn_Myfa To (Gplan_Gplan_Yn_VT(Self))
50624>>>>>>>>>>>>>>>
50624>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnump
50624>>>>>>>>>>>>>>>
50624>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvalp
50624>>>>>>>>>>>>>>>
50624>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfnuma
50624>>>>>>>>>>>>>>>
50624>>>>>>>>>>>>>>>        // Gplan.Gplan_Myfvala
50624>>>>>>>>>>>>>>>
50624>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Sump
50624>>>>>>>>>>>>>>>        //DDB/ Comment_Short       Field Gplan.Gplan_Myf_Sump To "‰˜Ÿ¦¨åœ  œá¤ ¦  ®¨œé©œ ª/§ ©«é©œ ª Ÿ˜ ˜Ÿ¨¦ ©«¦ç¤ ©«ž¤ ‹“”"
50624>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Sump To "dbComboFormSub"
50625>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Sump To (Gplan_Gplan_Myf_Sum_VT(Self))
50626>>>>>>>>>>>>>>>
50626>>>>>>>>>>>>>>>        // Gplan.Gplan_Myf_Suma
50626>>>>>>>>>>>>>>>        Set Field_Class_Name       Field Gplan.Gplan_Myf_Suma To "dbComboFormSub"
50627>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gplan.Gplan_Myf_Suma To (Gplan_Gplan_Myf_Sum_VT(Self))
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx0
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp0
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx00
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp00
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sxr
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Spr
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sx2
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Sp2
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Gmhnnorec
50628>>>>>>>>>>>>>>>
50628>>>>>>>>>>>>>>>        // Gplan.Gplan_Recr
50628>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gplan.Gplan_Recr To (sl150(Self))
50629>>>>>>>>>>>>>>>
50629>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50629>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50630>>>>>>>>>>>>>>>
50630>>>>>>>>>>>>>>>    // Field_Defaults:
50630>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50630>>>>>>>>>>>>>>>
50630>>>>>>>>>>>>>>>    Procedure Field_Defaults
50631>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50633>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50633>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50633>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xfer To 0
50634>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Last To 0
50635>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kin To 1
50636>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Kk To 0
50637>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Xpm To 3
50638>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Xy To 1
50639>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Py To 1
50640>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Fpaent_Yn To 0
50641>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Rep_Pct To 100
50642>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfp To 0
50643>>>>>>>>>>>>>>>        Set Field_Changed_Value   Field Gplan.Gplan_Yn_Myfa To 0
50644>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50644>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50645>>>>>>>>>>>>>>>End_Class    // Gplan_DataDictionary
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50646>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>Use sl150.sl         // sl150
50646>>>>>>>>>>>>>>>Use Gtypkin.sl       // Gtypkin
INCLUDING FILE: GTYPKIN.SL
50646>>>>>>>>>>>>>>>>>//AB/ Project gtypkin:Gtypkin
50646>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
50646>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "gtypkin:Gtypkin"
50646>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "gtypkin.SL"
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>// Project Object Structure
50646>>>>>>>>>>>>>>>>>//   gtypkin is a dbModalPanel
50646>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
50646>>>>>>>>>>>>>>>>>//     Gtypkin_DD is a DataDictionary
50646>>>>>>>>>>>>>>>>>//     oSelList is a dbList
50646>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
50646>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
50646>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>// Register all objects
50646>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
50646>>>>>>>>>>>>>>>>>Register_Object Gtypkin_DD
50646>>>>>>>>>>>>>>>>>Register_Object gtypkin
50646>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
50646>>>>>>>>>>>>>>>>>Register_Object oOK_bn
50646>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
50646>>>>>>>>>>>>>>>>>Register_Object oSelList
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
INCLUDING FILE: GTHHMGIO.DD
50646>>>>>>>>>>>>>>>>>>>//DDB-FileStart
50646>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
50646>>>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>>>// File Name : GTHHMGIO.DD
50646>>>>>>>>>>>>>>>>>>>// Class Name: Gthhmgio_DataDictionary
50646>>>>>>>>>>>>>>>>>>>// Revision  : 33
50646>>>>>>>>>>>>>>>>>>>// Version   : 2
50646>>>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
50646>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50646>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50646>>>>>>>>>>>>>>>>>>>
50646>>>>>>>>>>>>>>>>>>>Open Gthhmgio
INCLUDING FILE: GTHHMGIO.FD
50648>>>>>>>>>>>>>>>>>>>Open Gtypkin
50650>>>>>>>>>>>>>>>>>>>Open Gthaa
INCLUDING FILE: GTHAA.FD
50652>>>>>>>>>>>>>>>>>>>Open Sysrecg
50654>>>>>>>>>>>>>>>>>>>
50654>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
50654>>>>>>>>>>>>>>>>>>>//DDB-ValidationStart
50654>>>>>>>>>>>>>>>>>>>
50654>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_Gthhmgio_Period_VT
50654>>>>>>>>>>>>>>>>>>>
50654>>>>>>>>>>>>>>>>>>>Object Gthhmgio_Gthhmgio_Period_VT  is a CodeValidationTable
50656>>>>>>>>>>>>>>>>>>>    Set Type_Value        To "PERIOD"
50657>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomStart
50657>>>>>>>>>>>>>>>>>>>    //DDB-ValidationCustomEnd
50657>>>>>>>>>>>>>>>>>>>End_Object   // Gthhmgio_Gthhmgio_Period_VT
50658>>>>>>>>>>>>>>>>>>>//DDB-ValidationEnd
50658>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
50658>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList Gthhmgio  Gthhmgio.SL
50658>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
50658>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
50658>>>>>>>>>>>>>>>>>>>
50658>>>>>>>>>>>>>>>>>>>Class Gthhmgio_DataDictionary  is a DataDictionary_Sec
50659>>>>>>>>>>>>>>>>>>>
50659>>>>>>>>>>>>>>>>>>>
50659>>>>>>>>>>>>>>>>>>>    // Define_Fields:
50659>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50659>>>>>>>>>>>>>>>>>>>
50659>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50660>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50662>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50662>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50662>>>>>>>>>>>>>>>>>>>
50662>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gthhmgio.File_Number
50663>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50664>>>>>>>>>>>>>>>>>>>
50664>>>>>>>>>>>>>>>>>>>
50664>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50664>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gtypkin.File_Number
50665>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gthaa.File_Number
50666>>>>>>>>>>>>>>>>>>>
50666>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
50666>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
50667>>>>>>>>>>>>>>>>>>>
50667>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gthhmgio_Rec0  To Gthhmgio.Gthhmgio_Rec0
50670>>>>>>>>>>>>>>>>>>>
50670>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50670>>>>>>>>>>>>>>>>>>>
50670>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Code
50670>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Code To DD_AUTOFIND   
50671>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Code To (Gthhmgio(Self))
50672>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Code To TRUE
50673>>>>>>>>>>>>>>>>>>>
50673>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Rec0
50673>>>>>>>>>>>>>>>>>>>
50673>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Descr
50673>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gthhmgio.Gthhmgio_Descr To (Gthhmgio(Self))
50674>>>>>>>>>>>>>>>>>>>
50674>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Period
50674>>>>>>>>>>>>>>>>>>>        Set Field_Value_Table      Field Gthhmgio.Gthhmgio_Period To (Gthhmgio_Gthhmgio_Period_VT(Self))
50675>>>>>>>>>>>>>>>>>>>
50675>>>>>>>>>>>>>>>>>>>        // Gthhmgio.Gthhmgio_Recr
50675>>>>>>>>>>>>>>>>>>>        Set Field_Options          Field Gthhmgio.Gthhmgio_Recr To DD_AUTOFIND   
50676>>>>>>>>>>>>>>>>>>>        Set Key_Field_State        Field Gthhmgio.Gthhmgio_Recr To TRUE
50677>>>>>>>>>>>>>>>>>>>
50677>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50677>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50678>>>>>>>>>>>>>>>>>>>
50678>>>>>>>>>>>>>>>>>>>    // Field_Defaults:
50678>>>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
50678>>>>>>>>>>>>>>>>>>>
50678>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50679>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50681>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50681>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50681>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50681>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50682>>>>>>>>>>>>>>>>>>>End_Class    // Gthhmgio_DataDictionary
50683>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50683>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>Use Gthhmgio.SL      // Gthhmgio
INCLUDING FILE: GTHHMGIO.SL
50683>>>>>>>>>>>>>>>>>>>>>//AB/ Project Gthhmgio:Gthhmgio
50683>>>>>>>>>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
50683>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectName to "Gthhmgio:Gthhmgio"
50683>>>>>>>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "Gthhmgio.SL"
50683>>>>>>>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>// Project Object Structure
50683>>>>>>>>>>>>>>>>>>>>>//   Gthhmgio is a dbModalPanel
50683>>>>>>>>>>>>>>>>>>>>>//     Gthhmgio_DD is a DataDictionary
50683>>>>>>>>>>>>>>>>>>>>>//     oSelList is a dbList
50683>>>>>>>>>>>>>>>>>>>>>//     oOK_bn is a Button
50683>>>>>>>>>>>>>>>>>>>>>//     oCancel_bn is a Button
50683>>>>>>>>>>>>>>>>>>>>>//     oSearch_bn is a Button
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>// Register all objects
50683>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio_DD
50683>>>>>>>>>>>>>>>>>>>>>Register_Object oCancel_bn
50683>>>>>>>>>>>>>>>>>>>>>Register_Object oOK_bn
50683>>>>>>>>>>>>>>>>>>>>>Register_Object oSearch_bn
50683>>>>>>>>>>>>>>>>>>>>>Register_Object oSelList
50683>>>>>>>>>>>>>>>>>>>>>Register_Object Gthhmgio
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreStart
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>    Use GTHHMGIO.DD
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
50683>>>>>>>>>>>>>>>>>>>>>
50683>>>>>>>>>>>>>>>>>>>>>    CD_Popup_Object Gthhmgio is a dbModalPanel
50702>>>>>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50703>>>>>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ †£œ¨¦¢¦šåà¤"
50704>>>>>>>>>>>>>>>>>>>>>        Set Size to 148 297
50705>>>>>>>>>>>>>>>>>>>>>        Set Location to 4 5
50706>>>>>>>>>>>>>>>>>>>>>
50706>>>>>>>>>>>>>>>>>>>>>        //AB-DDOStart
50706>>>>>>>>>>>>>>>>>>>>>
50706>>>>>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
50708>>>>>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
50709>>>>>>>>>>>>>>>>>>>>>
50709>>>>>>>>>>>>>>>>>>>>>        Set Main_DD to (Gthhmgio_DD(self))
50710>>>>>>>>>>>>>>>>>>>>>        Set Server to (Gthhmgio_DD(self))
50711>>>>>>>>>>>>>>>>>>>>>
50711>>>>>>>>>>>>>>>>>>>>>        //AB-DDOEnd
50711>>>>>>>>>>>>>>>>>>>>>
50711>>>>>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
50713>>>>>>>>>>>>>>>>>>>>>            Set Main_File to Gthhmgio.File_Number
50714>>>>>>>>>>>>>>>>>>>>>            Set Size to 105 280
50715>>>>>>>>>>>>>>>>>>>>>            Set Location to 6 6
50716>>>>>>>>>>>>>>>>>>>>>
50716>>>>>>>>>>>>>>>>>>>>>            Begin_Row
50719>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
50720>>>>>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
50721>>>>>>>>>>>>>>>>>>>>>            End_Row
50726>>>>>>>>>>>>>>>>>>>>>
50726>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 52
50727>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
50728>>>>>>>>>>>>>>>>>>>>>
50728>>>>>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 220
50729>>>>>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50730>>>>>>>>>>>>>>>>>>>>>
50730>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSelList
50731>>>>>>>>>>>>>>>>>>>>>
50731>>>>>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
50733>>>>>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50734>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 127
50735>>>>>>>>>>>>>>>>>>>>>
50735>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50735>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50737>>>>>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
50738>>>>>>>>>>>>>>>>>>>>>            End_Procedure
50739>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50739>>>>>>>>>>>>>>>>>>>>>
50739>>>>>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
50740>>>>>>>>>>>>>>>>>>>>>
50740>>>>>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
50742>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50743>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 181
50744>>>>>>>>>>>>>>>>>>>>>
50744>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50744>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50746>>>>>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
50747>>>>>>>>>>>>>>>>>>>>>            End_Procedure
50748>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50748>>>>>>>>>>>>>>>>>>>>>
50748>>>>>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
50749>>>>>>>>>>>>>>>>>>>>>
50749>>>>>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
50751>>>>>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
50752>>>>>>>>>>>>>>>>>>>>>            Set Location to 111 237
50753>>>>>>>>>>>>>>>>>>>>>
50753>>>>>>>>>>>>>>>>>>>>>            //AB-StoreStart
50753>>>>>>>>>>>>>>>>>>>>>            Procedure OnClick
50755>>>>>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
50756>>>>>>>>>>>>>>>>>>>>>            End_Procedure
50757>>>>>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50757>>>>>>>>>>>>>>>>>>>>>
50757>>>>>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
50758>>>>>>>>>>>>>>>>>>>>>
50758>>>>>>>>>>>>>>>>>>>>>
50758>>>>>>>>>>>>>>>>>>>>>        //AB-StoreStart
50758>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50759>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50760>>>>>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50761>>>>>>>>>>>>>>>>>>>>>        //AB-StoreEnd
50761>>>>>>>>>>>>>>>>>>>>>
50761>>>>>>>>>>>>>>>>>>>>>    CD_End_Object    // Gthhmgio
50763>>>>>>>>>>>>>>>>>>>>>>
50763>>>>>>>>>>>>>>>>>>>>>
50763>>>>>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
50763>>>>>>>>>>>>>>>>>>>
50763>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50763>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
50763>>>>>>>>>>>>>>>>>    Use GTYPKIN.DD
INCLUDING FILE: GTYPKIN.DD
50763>>>>>>>>>>>>>>>>>>>//DDB-FileStart
50763>>>>>>>>>>>>>>>>>>>//DDB-HeaderStart
50763>>>>>>>>>>>>>>>>>>>
50763>>>>>>>>>>>>>>>>>>>// File Name : GTYPKIN.DD
50763>>>>>>>>>>>>>>>>>>>// Class Name: Gtypkin_DataDictionary
50763>>>>>>>>>>>>>>>>>>>// Revision  : 45
50763>>>>>>>>>>>>>>>>>>>// Version   : 2
50763>>>>>>>>>>>>>>>>>>>
50763>>>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
50763>>>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
50763>>>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
50763>>>>>>>>>>>>>>>>>>>
50763>>>>>>>>>>>>>>>>>>>Open Gtypkin
50765>>>>>>>>>>>>>>>>>>>Open Garticl
50767>>>>>>>>>>>>>>>>>>>Open Gflagkin
INCLUDING FILE: GFLAGKIN.FD
50769>>>>>>>>>>>>>>>>>>>Open Gparticl
INCLUDING FILE: GPARTICL.FD
50771>>>>>>>>>>>>>>>>>>>Open Gthhmgio
50773>>>>>>>>>>>>>>>>>>>Open Sysrecg
50775>>>>>>>>>>>>>>>>>>>
50775>>>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
50775>>>>>>>>>>>>>>>>>>>//DDB-SelectionStart
50775>>>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList gtypkin  gtypkin.SL
50775>>>>>>>>>>>>>>>>>>>Register_Object gtypkin
50775>>>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
50775>>>>>>>>>>>>>>>>>>>Open SysCurGL
50777>>>>>>>>>>>>>>>>>>>
50777>>>>>>>>>>>>>>>>>>>Class Gtypkin_DataDictionary  is a DataDictionary_Sec
50778>>>>>>>>>>>>>>>>>>>
50778>>>>>>>>>>>>>>>>>>>    Procedure Entry_Order_Date  Integer iField  Date dDate
50779>>>>>>>>>>>>>>>>>>>         // Add a default date if the field is blank
50779>>>>>>>>>>>>>>>>>>>         Integer Changed
50780>>>>>>>>>>>>>>>>>>>         Get Field_Changed_State iField to Changed
50781>>>>>>>>>>>>>>>>>>>         If (Changed=0 AND dDate =0) Begin
50783>>>>>>>>>>>>>>>>>>>             SysDate4 dDate
50784>>>>>>>>>>>>>>>>>>>             Set Field_Default_Value iField to dDate
50785>>>>>>>>>>>>>>>>>>>         End
50785>>>>>>>>>>>>>>>>>>>>
50785>>>>>>>>>>>>>>>>>>>    End_Procedure
50786>>>>>>>>>>>>>>>>>>>
50786>>>>>>>>>>>>>>>>>>>    Procedure Construct_Object
50787>>>>>>>>>>>>>>>>>>>        Forward Send Construct_Object
50789>>>>>>>>>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
50790>>>>>>>>>>>>>>>>>>>        Property Date    pdDefault_Hmnia    Public 0
50791>>>>>>>>>>>>>>>>>>>        Property Integer piRate             Public 0
50792>>>>>>>>>>>>>>>>>>>        Property Integer piGthhmgio_dd      Public 0
50793>>>>>>>>>>>>>>>>>>>    End_Procedure   // Construct_Object
50794>>>>>>>>>>>>>>>>>>>
50794>>>>>>>>>>>>>>>>>>>//    Procedure OnConstrain
50794>>>>>>>>>>>>>>>>>>>//        Forward Send OnConstrain
50794>>>>>>>>>>>>>>>>>>>//        If (piMustNOTConstrain(Self)) Begin
50794>>>>>>>>>>>>>>>>>>>//        End
50794>>>>>>>>>>>>>>>>>>>//        Else Begin
50794>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Company_Code  eq SysCurGL.Company_Code
50794>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Branch_Code   eq SysCurGL.Branch_Code
50794>>>>>>>>>>>>>>>>>>>//            Constrain Gtypkin.Year_Year     eq SysCurGL.Year_Year
50794>>>>>>>>>>>>>>>>>>>//        End
50794>>>>>>>>>>>>>>>>>>>//    End_Procedure
50794>>>>>>>>>>>>>>>>>>>
50794>>>>>>>>>>>>>>>>>>>    Procedure Update
50795>>>>>>>>>>>>>>>>>>>        Forward Send Update
50797>>>>>>>>>>>>>>>>>>>        // Insert Code Here
50797>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Company_Code  to Gtypkin.Company_Code
50798>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Branch_Code   to Gtypkin.Branch_Code
50799>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Year     to Gtypkin.Year_Year
50800>>>>>>>>>>>>>>>>>>>        Move SysCurGL.Year_Recr     to Gtypkin.Year_Recr
50801>>>>>>>>>>>>>>>>>>>        Move Gthhmgio.Gthhmgio_Code to Gtypkin.Gthhmgio_Code
50802>>>>>>>>>>>>>>>>>>>    End_Procedure   // Update
50803>>>>>>>>>>>>>>>>>>>
50803>>>>>>>>>>>>>>>>>>>    Procedure Creating
50804>>>>>>>>>>>>>>>>>>>        Forward Send Creating
50806>>>>>>>>>>>>>>>>>>>        // Insert Code Here
50806>>>>>>>>>>>>>>>>>>>        Move (Append('',((Trim(SysCurGL.Branch_Site))+;                         (Trim(String(Gtypkin.Gtypkin_Rec0)))))) to Gtypkin.Gtypkin_Recr
50807>>>>>>>>>>>>>>>>>>>    End_Procedure   // Creating
50808>>>>>>>>>>>>>>>>>>>
50808>>>>>>>>>>>>>>>>>>>
50808>>>>>>>>>>>>>>>>>>>
50808>>>>>>>>>>>>>>>>>>>//----------------------------------------------------------------------------
50808>>>>>>>>>>>>>>>>>>>
50808>>>>>>>>>>>>>>>>>>>//    Procedure Creating
50808>>>>>>>>>>>>>>>>>>>//              Forward Send Creating
50808>>>>>>>>>>>>>>>>>>>//              Add 1 to Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
50808>>>>>>>>>>>>>>>>>>>//    End_Procedure //creating
50808>>>>>>>>>>>>>>>>>>>//    Procedure Deleting
50808>>>>>>>>>>>>>>>>>>>//              Forward Send Deleting
50808>>>>>>>>>>>>>>>>>>>//              Sub 1 from Year.Year_NumGtypkin //˜¨ Ÿ£æª «ç§à¤ ¡ ¤ã©œà¤ «žª ®¨ã©žª
50808>>>>>>>>>>>>>>>>>>>//    End_Procedure //deleting
50808>>>>>>>>>>>>>>>>>>>
50808>>>>>>>>>>>>>>>>>>>    Function Validate_Save  Returns Integer
50809>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
50810>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Save To iReturnVal
50812>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
50812>>>>>>>>>>>>>>>>>>>//            //1100:cby = globals
50812>>>>>>>>>>>>>>>>>>>//            If ( ;
50812>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
50812>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
50812>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
50812>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 1100
50812>>>>>>>>>>>>>>>>>>>//        End
50812>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
50813>>>>>>>>>>>>>>>>>>>    End_Function   //validate_save
50814>>>>>>>>>>>>>>>>>>>
50814>>>>>>>>>>>>>>>>>>>
50814>>>>>>>>>>>>>>>>>>>    Function Validate_Delete  Returns Integer
50815>>>>>>>>>>>>>>>>>>>        Integer iReturnVal
50816>>>>>>>>>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
50818>>>>>>>>>>>>>>>>>>>//        If (Not(iReturnVal)) Begin
50818>>>>>>>>>>>>>>>>>>>//            //2100:cby = globals
50818>>>>>>>>>>>>>>>>>>>//            If ( ;
50818>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Company_Code = SysCurGL.Company_Code)) or;
50818>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Branch_Code  = SysCurGL.Branch_Code )) or;
50818>>>>>>>>>>>>>>>>>>>//                (Not(Gtypkin.Year_Year    = SysCurGL.Year_Year   ));
50818>>>>>>>>>>>>>>>>>>>//                ) Send Operation_Not_Allowed 2100
50818>>>>>>>>>>>>>>>>>>>//        End
50818>>>>>>>>>>>>>>>>>>>        Function_Return iReturnVal
50819>>>>>>>>>>>>>>>>>>>    End_Function   // validate_delete
50820>>>>>>>>>>>>>>>>>>>
50820>>>>>>>>>>>>>>>>>>>
50820>>>>>>>>>>>>>>>>>>>
50820>>>>>>>>>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
50821>>>>>>>>>>>>>>>>>>>              Case Begin
50821>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 1100)
50823>>>>>>>>>>>>>>>>>>>                        Error 1100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50824>>>>>>>>>>>>>>>>>>>>
50824>>>>>>>>>>>>>>>>>>>                        Case Break
50825>>>>>>>>>>>>>>>>>>>                   Case (iError_Num = 2100)
50828>>>>>>>>>>>>>>>>>>>                        Error 2100 "DDC 151:‹ž ˜§¦›œ¡«ã „«˜ ¨å˜-•¨ã©ž"
50829>>>>>>>>>>>>>>>>>>>>
50829>>>>>>>>>>>>>>>>>>>                        Case Break
50830>>>>>>>>>>>>>>>>>>>                   Case Else
50830>>>>>>>>>>>>>>>>>>>                        Forward Send Operation_Not_Allowed  iError_Num
50832>>>>>>>>>>>>>>>>>>>              Case End
50832>>>>>>>>>>>>>>>>>>>    End_Procedure   //operation_not_allowed
50833>>>>>>>>>>>>>>>>>>>
50833>>>>>>>>>>>>>>>>>>>
50833>>>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
50834>>>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
50836>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50836>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
50836>>>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
50836>>>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
50837>>>>>>>>>>>>>>>>>>>
50837>>>>>>>>>>>>>>>>>>>
50837>>>>>>>>>>>>>>>>>>>
50837>>>>>>>>>>>>>>>>>>>    // Define_Fields:
50837>>>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
50837>>>>>>>>>>>>>>>>>>>
50837>>>>>>>>>>>>>>>>>>>    Procedure Define_Fields
50838>>>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
50840>>>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
50840>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
50840>>>>>>>>>>>>>>>>>>>
50840>>>>>>>>>>>>>>>>>>>        Set Main_File            To Gtypkin.File_Number
50841>>>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
50842>>>>>>>>>>>>>>>>>>>
50842>>>>>>>>>>>>>>>>>>>
50842>>>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
50842>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Garticl.File_Number
50843>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gflagkin.File_Number
50844>>>>>>>>>>>>>>>>>>>        Send Add_Client_File  Gparticl.File_Number
50845>>>>>>>>>>>>>>>>>>>
50845>>>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
50845>>>>>>>>>>>>>>>>>>>        Send Add_Server_File  Gthhmgio.File_Number
50846>>>>>>>>>>>>>>>>>>>
50846>>>>>>>>>>>>>>>>>>>        // External (System) file structure.............
50846>>>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
50847>>>>>>>>>>>>>>>>>>>
50847>>>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecg.Gtypkin_Rec0  To Gtypkin.Gtypkin_Rec0
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        // Field-based properties.......................
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        // Gtypkin.Company_Code
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        // Gtypkin.Branch_Code
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Year
50850>>>>>>>>>>>>>>>>>>>
50850>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Code
50850>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Code To (gtypkin(Self))
50851>>>>>>>>>>>>>>>>>>>
50851>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Rec0
50851>>>>>>>>>>>>>>>>>>>
50851>>>>>>>>>>>>>>>>>>>        // Gtypkin.Year_Recr
50851>>>>>>>>>>>>>>>>>>>
50851>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Code
50851>>>>>>>>>>>>>>>>>>>
50851>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gthhmgio_Recr
50851>>>>>>>>>>>>>>>>>>>
50851>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Descr
50851>>>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Gtypkin.Gtypkin_Descr To (gtypkin(Self))
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Anti
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Printer
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Form
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_No
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_L_Hmnia
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Seira
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Abr
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag01
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag02
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag03
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag04
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag05
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag06
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag07
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag08
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag09
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag10
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag11
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag12
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag13
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag14
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag15
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag16
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag17
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag18
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag19
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Flag20
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        // Gtypkin.Gtypkin_Recr
50852>>>>>>>>>>>>>>>>>>>
50852>>>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
50852>>>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
50853>>>>>>>>>>>>>>>>>>>End_Class    // Gtypkin_DataDictionary
50854>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
50854>>>>>>>>>>>>>>>>>>>
50854>>>>>>>>>>>>>>>>>>>Use gtypkin.SL       // gtypkin
50854>>>>>>>>>>>>>>>>>>>
50854>>>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50854>>>>>>>>>>>>>>>>>>>//DDB-FileEnd
50854>>>>>>>>>>>>>>>>>    
50854>>>>>>>>>>>>>>>>>    //AB-IgnoreEnd
50854>>>>>>>>>>>>>>>>>
50854>>>>>>>>>>>>>>>>>    CD_Popup_Object gtypkin is a dbModalPanel
50873>>>>>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50874>>>>>>>>>>>>>>>>>        Set Label to "Šå©«˜ ‰ ¤ã©œà¤"
50875>>>>>>>>>>>>>>>>>        Set Size to 171 467
50876>>>>>>>>>>>>>>>>>        Set Location to 4 5
50877>>>>>>>>>>>>>>>>>
50877>>>>>>>>>>>>>>>>>        //AB-DDOStart
50877>>>>>>>>>>>>>>>>>
50877>>>>>>>>>>>>>>>>>        Object Gthhmgio_DD is a Gthhmgio_DataDictionary
50879>>>>>>>>>>>>>>>>>        End_Object    // Gthhmgio_DD
50880>>>>>>>>>>>>>>>>>
50880>>>>>>>>>>>>>>>>>        Object Gtypkin_DD is a Gtypkin_DataDictionary
50882>>>>>>>>>>>>>>>>>            Set DDO_Server to (Gthhmgio_DD(self))
50883>>>>>>>>>>>>>>>>>        End_Object    // Gtypkin_DD
50884>>>>>>>>>>>>>>>>>
50884>>>>>>>>>>>>>>>>>        Set Main_DD to (Gtypkin_DD(self))
50885>>>>>>>>>>>>>>>>>        Set Server to (Gtypkin_DD(self))
50886>>>>>>>>>>>>>>>>>
50886>>>>>>>>>>>>>>>>>        //AB-DDOEnd
50886>>>>>>>>>>>>>>>>>
50886>>>>>>>>>>>>>>>>>        Object oSelList is a dbList
50888>>>>>>>>>>>>>>>>>            Set Main_File to Gtypkin.File_Number
50889>>>>>>>>>>>>>>>>>            Set Size to 132 450
50890>>>>>>>>>>>>>>>>>            Set Location to 6 6
50891>>>>>>>>>>>>>>>>>
50891>>>>>>>>>>>>>>>>>            Begin_Row
50894>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_code
50895>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_descr
50896>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_abr
50897>>>>>>>>>>>>>>>>>                Entry_Item Gtypkin.Gtypkin_seira
50898>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_code
50899>>>>>>>>>>>>>>>>>                Entry_Item Gthhmgio.Gthhmgio_descr
50900>>>>>>>>>>>>>>>>>            End_Row
50905>>>>>>>>>>>>>>>>>
50905>>>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 40
50906>>>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
50907>>>>>>>>>>>>>>>>>            
50907>>>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 150
50908>>>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
50909>>>>>>>>>>>>>>>>>            
50909>>>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 68
50910>>>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "‘¬¤«¦£¦š¨˜­å˜"
50911>>>>>>>>>>>>>>>>>            
50911>>>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 30
50912>>>>>>>>>>>>>>>>>            Set Header_Label  item 3 to "‘œ ¨á"
50913>>>>>>>>>>>>>>>>>            
50913>>>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 55
50914>>>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "‰à› ¡æª †£/š ¦¬"
50915>>>>>>>>>>>>>>>>>            
50915>>>>>>>>>>>>>>>>>            Set Form_Width    item 5 to 99
50916>>>>>>>>>>>>>>>>>            Set Header_Label  item 5 to "œ¨ š¨˜­ã †£/šå¦¬"
50917>>>>>>>>>>>>>>>>>            
50917>>>>>>>>>>>>>>>>>        End_Object    // oSelList
50918>>>>>>>>>>>>>>>>>
50918>>>>>>>>>>>>>>>>>        Object oOK_bn is a Button
50920>>>>>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
50921>>>>>>>>>>>>>>>>>            Set Location to 140 298
50922>>>>>>>>>>>>>>>>>
50922>>>>>>>>>>>>>>>>>            //AB-StoreStart
50922>>>>>>>>>>>>>>>>>            Procedure OnClick
50924>>>>>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
50925>>>>>>>>>>>>>>>>>            End_Procedure
50926>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50926>>>>>>>>>>>>>>>>>
50926>>>>>>>>>>>>>>>>>        End_Object    // oOK_bn
50927>>>>>>>>>>>>>>>>>
50927>>>>>>>>>>>>>>>>>        Object oCancel_bn is a Button
50929>>>>>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
50930>>>>>>>>>>>>>>>>>            Set Location to 140 353
50931>>>>>>>>>>>>>>>>>
50931>>>>>>>>>>>>>>>>>            //AB-StoreStart
50931>>>>>>>>>>>>>>>>>            Procedure OnClick
50933>>>>>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
50934>>>>>>>>>>>>>>>>>            End_Procedure
50935>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50935>>>>>>>>>>>>>>>>>
50935>>>>>>>>>>>>>>>>>        End_Object    // oCancel_bn
50936>>>>>>>>>>>>>>>>>
50936>>>>>>>>>>>>>>>>>        Object oSearch_bn is a Button
50938>>>>>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
50939>>>>>>>>>>>>>>>>>            Set Location to 140 408
50940>>>>>>>>>>>>>>>>>
50940>>>>>>>>>>>>>>>>>            //AB-StoreStart
50940>>>>>>>>>>>>>>>>>            Procedure OnClick
50942>>>>>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
50943>>>>>>>>>>>>>>>>>            End_Procedure
50944>>>>>>>>>>>>>>>>>            //AB-StoreEnd
50944>>>>>>>>>>>>>>>>>
50944>>>>>>>>>>>>>>>>>        End_Object    // oSearch_bn
50945>>>>>>>>>>>>>>>>>
50945>>>>>>>>>>>>>>>>>
50945>>>>>>>>>>>>>>>>>        //AB-StoreStart
50945>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
50946>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
50947>>>>>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
50948>>>>>>>>>>>>>>>>>        //AB-StoreEnd
50948>>>>>>>>>>>>>>>>>
50948>>>>>>>>>>>>>>>>>    CD_End_Object    // gtypkin
50950>>>>>>>>>>>>>>>>>>
50950>>>>>>>>>>>>>>>>>
50950>>>>>>>>>>>>>>>>>//AB/     End_Object    // prj
50950>>>>>>>>>>>>>>>
50950>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
50950>>>>>>>>>>>>>>>//DDB-FileEnd
50950>>>>>>>>>>>>>    
50950>>>>>>>>>>>>>    //AB-IgnoreEnd
50950>>>>>>>>>>>>>
50950>>>>>>>>>>>>>    CD_Popup_Object sl150 is a dbModalPanelSub
50969>>>>>>>>>>>>>
50969>>>>>>>>>>>>>        //AB-StoreTopStart
50969>>>>>>>>>>>>>        Property Integer piFragmaLast -1
50971>>>>>>>>>>>>>        Property String  psFragmaFromCode ""
50973>>>>>>>>>>>>>        Property String  psFragmaToCode ""
50975>>>>>>>>>>>>>        
50975>>>>>>>>>>>>>        //AB-StoreTopEnd
50975>>>>>>>>>>>>>
50975>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
50976>>>>>>>>>>>>>        Set Label to "Šå©«˜ Š¦š˜¨ ˜©£é¤"
50977>>>>>>>>>>>>>        Set Size to 204 393
50978>>>>>>>>>>>>>        Set Location to 5 16
50979>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
50980>>>>>>>>>>>>>        Set Modal_State to FALSE
50981>>>>>>>>>>>>>
50981>>>>>>>>>>>>>        //AB-DDOStart
50981>>>>>>>>>>>>>
50981>>>>>>>>>>>>>        Object Gplan_DD is a Gplan_DataDictionary
50983>>>>>>>>>>>>>
50983>>>>>>>>>>>>>            //AB-StoreStart
50983>>>>>>>>>>>>>                        
50983>>>>>>>>>>>>>            Procedure OnConstrain
50985>>>>>>>>>>>>>                Integer liFragmaLast
50986>>>>>>>>>>>>>                String lsFragmaFromCode lsFragmaToCode
50986>>>>>>>>>>>>>                Get piFragmaLast     to liFragmaLast
50987>>>>>>>>>>>>>                Get psFragmaFromCode to lsFragmaFromCode
50988>>>>>>>>>>>>>                Get psFragmaToCode   to lsFragmaToCode
50989>>>>>>>>>>>>>                If (liFragmaLast <> -1)     Constrain Gplan.Gplan_Yn_Last eq liFragmaLast
50993>>>>>>>>>>>>>                If (lsFragmaFromCode <> "") Constrain Gplan.Gplan_Code    ge lsFragmaFromCode
50997>>>>>>>>>>>>>                If (lsFragmaToCode <> "")   Constrain Gplan.Gplan_Code    le lsFragmaToCode
51001>>>>>>>>>>>>>            End_Procedure // OnConstrain
51002>>>>>>>>>>>>>            
51002>>>>>>>>>>>>>            
51002>>>>>>>>>>>>>            //AB-StoreEnd
51002>>>>>>>>>>>>>
51002>>>>>>>>>>>>>        End_Object    // Gplan_DD
51003>>>>>>>>>>>>>
51003>>>>>>>>>>>>>        Set Main_DD to (Gplan_DD(self))
51004>>>>>>>>>>>>>        Set Server to (Gplan_DD(self))
51005>>>>>>>>>>>>>
51005>>>>>>>>>>>>>        //AB-DDOEnd
51005>>>>>>>>>>>>>
51005>>>>>>>>>>>>>        Object oSelList is a dbListSub
51007>>>>>>>>>>>>>            Set Main_File to Gplan.File_Number
51008>>>>>>>>>>>>>            Set Ordering to 3
51009>>>>>>>>>>>>>            Set Size to 164 378
51010>>>>>>>>>>>>>            Set Location to 4 6
51011>>>>>>>>>>>>>
51011>>>>>>>>>>>>>            Begin_Row
51014>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_code
51015>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_descr1
51016>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_bathmos
51017>>>>>>>>>>>>>                Entry_Item Gplan.Gplan_yn_last
51018>>>>>>>>>>>>>            End_Row
51023>>>>>>>>>>>>>
51023>>>>>>>>>>>>>            Set Form_Width    item 0 to 105
51024>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
51025>>>>>>>>>>>>>            
51025>>>>>>>>>>>>>            Set Form_Width    item 1 to 212
51026>>>>>>>>>>>>>            Set Header_Label  item 1 to "Ž¤¦£˜©å˜"
51027>>>>>>>>>>>>>            
51027>>>>>>>>>>>>>            Set Form_Width    item 2 to 34
51028>>>>>>>>>>>>>            Set Header_Label  item 2 to "˜Ÿ£æª"
51029>>>>>>>>>>>>>            
51029>>>>>>>>>>>>>            Set Form_Width    item 3 to 19
51030>>>>>>>>>>>>>            Set Header_Label  item 3 to " ’"
51031>>>>>>>>>>>>>            Set Column_Checkbox_State  item 3 to True
51032>>>>>>>>>>>>>            
51032>>>>>>>>>>>>>
51032>>>>>>>>>>>>>            //AB-StoreStart
51032>>>>>>>>>>>>>                        
51032>>>>>>>>>>>>>            Property String piStoredFragmaLast -1
51034>>>>>>>>>>>>>            Property String psStoredFragmaFromCode ""
51036>>>>>>>>>>>>>            Property String psStoredFragmaToCode ""
51038>>>>>>>>>>>>>            
51038>>>>>>>>>>>>>            Procedure Store_Defaults
51040>>>>>>>>>>>>>                forward send Store_Defaults
51042>>>>>>>>>>>>>                Set piStoredFragmaLast     to (piFragmaLast(Self))
51043>>>>>>>>>>>>>                Set psStoredFragmaFromCode to (psFragmaFromCode(Self))
51044>>>>>>>>>>>>>                Set psStoredFragmaToCode   to (psFragmaToCode(Self))
51045>>>>>>>>>>>>>            end_Procedure // Store_Defaults
51046>>>>>>>>>>>>>            
51046>>>>>>>>>>>>>            Procedure Restore_Defaults
51048>>>>>>>>>>>>>                forward send Restore_Defaults
51050>>>>>>>>>>>>>                Set piFragmaLast     to (piStoredFragmaLast(self))
51051>>>>>>>>>>>>>                Set psFragmaFromCode to (psStoredFragmaFromCode(self))
51052>>>>>>>>>>>>>                Set psFragmaToCode   to (psStoredFragmaToCode(self))
51053>>>>>>>>>>>>>            end_Procedure // Restore_Defaults
51054>>>>>>>>>>>>>            
51054>>>>>>>>>>>>>            Procedure Activating
51056>>>>>>>>>>>>>                Forward Send Activating
51058>>>>>>>>>>>>>                Send Rebuild_Constraints to (Gplan_DD(self))
51059>>>>>>>>>>>>>            End_Procedure // Activating
51060>>>>>>>>>>>>>            
51060>>>>>>>>>>>>>            
51060>>>>>>>>>>>>>            
51060>>>>>>>>>>>>>            
51060>>>>>>>>>>>>>            //AB-StoreEnd
51060>>>>>>>>>>>>>
51060>>>>>>>>>>>>>        End_Object    // oSelList
51061>>>>>>>>>>>>>
51061>>>>>>>>>>>>>        Object oOK_bn is a Button
51063>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
51064>>>>>>>>>>>>>            Set Location to 170 226
51065>>>>>>>>>>>>>
51065>>>>>>>>>>>>>            //AB-StoreStart
51065>>>>>>>>>>>>>            Procedure OnClick
51067>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
51068>>>>>>>>>>>>>            End_Procedure
51069>>>>>>>>>>>>>            //AB-StoreEnd
51069>>>>>>>>>>>>>
51069>>>>>>>>>>>>>        End_Object    // oOK_bn
51070>>>>>>>>>>>>>
51070>>>>>>>>>>>>>        Object oCancel_bn is a Button
51072>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
51073>>>>>>>>>>>>>            Set Location to 170 279
51074>>>>>>>>>>>>>
51074>>>>>>>>>>>>>            //AB-StoreStart
51074>>>>>>>>>>>>>            Procedure OnClick
51076>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
51077>>>>>>>>>>>>>            End_Procedure
51078>>>>>>>>>>>>>            //AB-StoreEnd
51078>>>>>>>>>>>>>
51078>>>>>>>>>>>>>        End_Object    // oCancel_bn
51079>>>>>>>>>>>>>
51079>>>>>>>>>>>>>        Object oSearch_bn is a Button
51081>>>>>>>>>>>>>            Set Label to "&€¤˜ã«ž©ž..."
51082>>>>>>>>>>>>>            Set Location to 170 334
51083>>>>>>>>>>>>>
51083>>>>>>>>>>>>>            //AB-StoreStart
51083>>>>>>>>>>>>>            Procedure OnClick
51085>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
51086>>>>>>>>>>>>>            End_Procedure
51087>>>>>>>>>>>>>            //AB-StoreEnd
51087>>>>>>>>>>>>>
51087>>>>>>>>>>>>>        End_Object    // oSearch_bn
51088>>>>>>>>>>>>>
51088>>>>>>>>>>>>>
51088>>>>>>>>>>>>>        //AB-StoreStart
51088>>>>>>>>>>>>>                
51088>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
51089>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
51090>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
51091>>>>>>>>>>>>>        
51091>>>>>>>>>>>>>        
51091>>>>>>>>>>>>>        
51091>>>>>>>>>>>>>        //AB-StoreEnd
51091>>>>>>>>>>>>>
51091>>>>>>>>>>>>>    CD_End_Object    // sl150
51093>>>>>>>>>>>>>>
51093>>>>>>>>>>>>>
51093>>>>>>>>>>>>>//AB/     End_Object    // prj
51093>>>>>>>>>>>
51093>>>>>>>>>>>//DDB-Selection-pkg-End
51093>>>>>>>>>>>//DDB-FileEnd
51093>>>>>>>>>    Use ITEM.DD
INCLUDING FILE: ITEM.DD
51093>>>>>>>>>>>//DDB-FileStart
51093>>>>>>>>>>>//DDB-HeaderStart
51093>>>>>>>>>>>
51093>>>>>>>>>>>// File Name : ITEM.DD
51093>>>>>>>>>>>// Class Name: Item_DataDictionary
51093>>>>>>>>>>>// Revision  : 63
51093>>>>>>>>>>>// Version   : 2
51093>>>>>>>>>>>
51093>>>>>>>>>>>Use  Windows           // Basic Definitions
51093>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51093>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51093>>>>>>>>>>>
51093>>>>>>>>>>>Open Item
51095>>>>>>>>>>>Open Witemx
51097>>>>>>>>>>>Open Witemcl
51099>>>>>>>>>>>Open Itemtehn
INCLUDING FILE: ITEMTEHN.FD
51101>>>>>>>>>>>Open Units
51103>>>>>>>>>>>Open Witemkat
51105>>>>>>>>>>>Open Fpa
51107>>>>>>>>>>>Open Sysrecw
51109>>>>>>>>>>>Open Witemx
51111>>>>>>>>>>>
51111>>>>>>>>>>>//DDB-HeaderEnd
51111>>>>>>>>>>>//DDB-ValidationStart
51111>>>>>>>>>>>
51111>>>>>>>>>>>Register_Object Item_Item_Qual_VT
51111>>>>>>>>>>>Register_Object Item_Item_Analysh_VT
51111>>>>>>>>>>>
51111>>>>>>>>>>>Object Item_Item_Qual_VT  is a CodeValidationTable
51113>>>>>>>>>>>    Set Type_Value        To "QUAL"
51114>>>>>>>>>>>    Set Validate_State    To FALSE
51115>>>>>>>>>>>    Set Allow_Blank_State To TRUE
51116>>>>>>>>>>>    //DDB-ValidationCustomStart
51116>>>>>>>>>>>    //DDB-ValidationCustomEnd
51116>>>>>>>>>>>End_Object   // Item_Item_Qual_VT
51117>>>>>>>>>>>
51117>>>>>>>>>>>Object Item_Item_Analysh_VT  is a CodeValidationTable
51119>>>>>>>>>>>    Set Type_Value        To "ITEMANAL"
51120>>>>>>>>>>>    Set Table_Title       To "€¤á¢¬©ž „å›¦¬ª"
51121>>>>>>>>>>>    //DDB-ValidationCustomStart
51121>>>>>>>>>>>    //DDB-ValidationCustomEnd
51121>>>>>>>>>>>End_Object   // Item_Item_Analysh_VT
51122>>>>>>>>>>>//DDB-ValidationEnd
51122>>>>>>>>>>>//DDB-SelectionStart
51122>>>>>>>>>>>//DDB/ ExternalSelectionList SL22s  sl22s.sl
51122>>>>>>>>>>>//DDB/ ExternalSelectionList sl022  sl022.SL
51122>>>>>>>>>>>Register_Object SL22s
51122>>>>>>>>>>>Register_Object sl022
51122>>>>>>>>>>>//DDB-SelectionEnd
51122>>>>>>>>>>>
51122>>>>>>>>>>>Class Item_DataDictionary  is a DataDictionary
51123>>>>>>>>>>>
51123>>>>>>>>>>>    Procedure Update
51124>>>>>>>>>>>        Forward Send Update
51126>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Item.Witemkat_Code
51127>>>>>>>>>>>        Move Units.Units_Code       to Item.Units_Code
51128>>>>>>>>>>>    End_Procedure   // Update
51129>>>>>>>>>>>
51129>>>>>>>>>>>    Procedure Creating
51130>>>>>>>>>>>        Date dHmnia
51131>>>>>>>>>>>        Forward Send Creating
51133>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                         (Trim(String(Item.Item_Rec0)))))) to Item.Item_Recr
51134>>>>>>>>>>>        
51134>>>>>>>>>>>        Clear Branch
51135>>>>>>>>>>>        Move SysCurXR.Company_Code    to Branch.Company_Code
51136>>>>>>>>>>>        Find Gt Branch By Index.1 
51137>>>>>>>>>>>>
51137>>>>>>>>>>>        While ((Found=1) And (Branch.Company_Code=SysCurXR.Company_Code))
51141>>>>>>>>>>>            Clear Witemx
51142>>>>>>>>>>>            Move SysCurXR.Company_Code      to Witemx.Company_Code
51143>>>>>>>>>>>            Move Branch.Branch_Code         to Witemx.Branch_Code
51144>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Year_Year
51145>>>>>>>>>>>            Move SysCurXR.Year_Year         to Witemx.Witemx_YearDesc
51146>>>>>>>>>>>            Move SysCurXR.Year_Recr         to Witemx.Year_Recr
51147>>>>>>>>>>>            Move Witemkat.Witemkat_Code     to Witemx.Witemkat_Code
51148>>>>>>>>>>>            Move Units.Units_Code           to Witemx.Units_Code
51149>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Item_Code
51150>>>>>>>>>>>            Move Item.Item_Code             to Witemx.Witemx_Code
51151>>>>>>>>>>>            Move Item.Item_Descr            to Witemx.Witemx_Descr
51152>>>>>>>>>>>            Move Item.Wapokat_Code          to Witemx.ITEM_APOKAT_COD
51153>>>>>>>>>>>            Move Item.link1                 to Witemx.link1
51154>>>>>>>>>>>            Move Item.link2                 to Witemx.link2
51155>>>>>>>>>>>            Move Item.Item_Recr             to Witemx.Item_Recr
51156>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Witemx.Witemx_Rec0
51157>>>>>>>>>>>            Move (Sysrecw.Witemx_Rec0+1)    to Sysrecw.Witemx_Rec0
51158>>>>>>>>>>>            Move (Append('',((Trim(SysCurXR.Branch_Site))+;                           (Trim(String(Witemx.Witemx_Rec0)))))) ;                                          to Witemx.Witemx_Recr
51159>>>>>>>>>>>            Saverecord Sysrecw
51160>>>>>>>>>>>            Saverecord Witemx
51161>>>>>>>>>>>            
51161>>>>>>>>>>>            Find Gt Branch By Index.1 
51162>>>>>>>>>>>>
51162>>>>>>>>>>>        Loop
51163>>>>>>>>>>>>
51163>>>>>>>>>>>    End_Procedure   // Creating
51164>>>>>>>>>>>
51164>>>>>>>>>>>
51164>>>>>>>>>>>    // Define_Fields:
51164>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51164>>>>>>>>>>>
51164>>>>>>>>>>>    Procedure Define_Fields
51165>>>>>>>>>>>        Forward Send Define_Fields
51167>>>>>>>>>>>        //DDB-Generated-Code-Location
51167>>>>>>>>>>>        //DDB-DefineFieldStart
51167>>>>>>>>>>>
51167>>>>>>>>>>>        Set Main_File            To Item.File_Number
51168>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51169>>>>>>>>>>>
51169>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51170>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51171>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51172>>>>>>>>>>>
51172>>>>>>>>>>>        // Child (Client) file structure................
51172>>>>>>>>>>>        Send Add_Client_File  Witemx.File_Number
51173>>>>>>>>>>>        Send Add_Client_File  Witemcl.File_Number
51174>>>>>>>>>>>        Send Add_Client_File  Itemtehn.File_Number
51175>>>>>>>>>>>
51175>>>>>>>>>>>        // Parent (Server) file structure...............
51175>>>>>>>>>>>        Send Add_Server_File  Units.File_Number
51176>>>>>>>>>>>        Send Add_Server_File  Witemkat.File_Number
51177>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
51178>>>>>>>>>>>
51178>>>>>>>>>>>        // External (System) file structure.............
51178>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51179>>>>>>>>>>>        Send Add_System_File  Witemx.File_Number  DD_LOCK_ON_ALL
51180>>>>>>>>>>>
51180>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Item_Rec0  To Item.Item_Rec0
51183>>>>>>>>>>>
51183>>>>>>>>>>>        // Field-based properties.......................
51183>>>>>>>>>>>
51183>>>>>>>>>>>        // Item.Units_Code
51183>>>>>>>>>>>
51183>>>>>>>>>>>        // Item.Units_Recr
51183>>>>>>>>>>>
51183>>>>>>>>>>>        // Item.Witemkat_Code
51183>>>>>>>>>>>
51183>>>>>>>>>>>        // Item.Witemkat_Recr
51183>>>>>>>>>>>
51183>>>>>>>>>>>        // Item.Item_Code
51183>>>>>>>>>>>        Set Field_Options          Field Item.Item_Code To DD_AUTOFIND   
51184>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Code To (SL22s(Self))
51185>>>>>>>>>>>        Set Key_Field_State        Field Item.Item_Code To TRUE
51186>>>>>>>>>>>
51186>>>>>>>>>>>        // Item.Item_Rec0
51186>>>>>>>>>>>        Set Field_Options          Field Item.Item_Rec0 To DD_AUTOFIND   
51187>>>>>>>>>>>
51187>>>>>>>>>>>        // Item.Item_Descr
51187>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Item_Descr To (SL22s(Self))
51188>>>>>>>>>>>
51188>>>>>>>>>>>        // Item.Item_Recr
51188>>>>>>>>>>>        Set Field_Options          Field Item.Item_Recr To DD_AUTOFIND   
51189>>>>>>>>>>>
51189>>>>>>>>>>>        // Item.Fpa_Pososto
51189>>>>>>>>>>>        Set Key_Field_State        Field Item.Fpa_Pososto To TRUE
51190>>>>>>>>>>>
51190>>>>>>>>>>>        // Item.Item_Qual
51190>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Qual To (Item_Item_Qual_VT(Self))
51191>>>>>>>>>>>
51191>>>>>>>>>>>        // Item.Wapokat_Code
51191>>>>>>>>>>>        Set Field_Prompt_Object    Field Item.Wapokat_Code To (sl022(Self))
51192>>>>>>>>>>>
51192>>>>>>>>>>>        // Item.Item_Analysh
51192>>>>>>>>>>>        Set Field_Class_Name       Field Item.Item_Analysh To "dbComboFormsub"
51193>>>>>>>>>>>        Set Field_Value_Table      Field Item.Item_Analysh To (Item_Item_Analysh_VT(Self))
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Item_Orio
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Codeglpol
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Codeglago
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Link1
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Link2
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Group
51194>>>>>>>>>>>
51194>>>>>>>>>>>        // Item.Sap
51194>>>>>>>>>>>
51194>>>>>>>>>>>        //DDB-DefineFieldEnd
51194>>>>>>>>>>>    End_Procedure    // Define_Fields
51195>>>>>>>>>>>
51195>>>>>>>>>>>    // Field_Defaults:
51195>>>>>>>>>>>    // This procedure is used to establish default field values.
51195>>>>>>>>>>>
51195>>>>>>>>>>>    Procedure Field_Defaults
51196>>>>>>>>>>>        Forward Send Field_Defaults
51198>>>>>>>>>>>        //DDB-Generated-Code-Location
51198>>>>>>>>>>>        //DDB-FieldDefaultStart
51198>>>>>>>>>>>        Set Field_Changed_Value   Field Item.Item_Analysh To "0"
51199>>>>>>>>>>>        //DDB-FieldDefaultEnd
51199>>>>>>>>>>>    End_Procedure    // Field_Defaults
51200>>>>>>>>>>>
51200>>>>>>>>>>>End_Class    // Item_DataDictionary
51201>>>>>>>>>>>//DDB-Selection-pkg-Start
51201>>>>>>>>>>>
51201>>>>>>>>>>>Use sl22s.sl         // SL22s
INCLUDING FILE: SL22S.SL
51201>>>>>>>>>>>>>//AB/ Project SL22s:ITEM
51201>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
51201>>>>>>>>>>>>>//AB/         Set ProjectName to "SL22s:ITEM"
51201>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl22s.sl"
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>// Project Object Structure
51201>>>>>>>>>>>>>//   SL22s is a dbModalPanel
51201>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
51201>>>>>>>>>>>>>//     Units_DD is a DataDictionary
51201>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
51201>>>>>>>>>>>>>//     Item_DD is a DataDictionary
51201>>>>>>>>>>>>>//     oSelList is a dbListSub
51201>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51201>>>>>>>>>>>>>//     ocode is a FormSub
51201>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51201>>>>>>>>>>>>>//     operi is a FormSub
51201>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
51201>>>>>>>>>>>>>//       Radio1 is a RadioSub
51201>>>>>>>>>>>>>//       Radio2 is a RadioSub
51201>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
51201>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
51201>>>>>>>>>>>>>//     ocodekat is a FormSub
51201>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
51201>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
51201>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>// Register all objects
51201>>>>>>>>>>>>>Register_Object ButtonSub1
51201>>>>>>>>>>>>>Register_Object Fpa_DD
51201>>>>>>>>>>>>>Register_Object Item_DD
51201>>>>>>>>>>>>>Register_Object oCancel_bn
51201>>>>>>>>>>>>>Register_Object ocode
51201>>>>>>>>>>>>>Register_Object ocodekat
51201>>>>>>>>>>>>>Register_Object oOK_bn
51201>>>>>>>>>>>>>Register_Object operi
51201>>>>>>>>>>>>>Register_Object oSearch_bn
51201>>>>>>>>>>>>>Register_Object oSelList
51201>>>>>>>>>>>>>Register_Object Radio1
51201>>>>>>>>>>>>>Register_Object Radio2
51201>>>>>>>>>>>>>Register_Object RadioGroupSub1
51201>>>>>>>>>>>>>Register_Object SL22s
51201>>>>>>>>>>>>>Register_Object TextBoxSub1
51201>>>>>>>>>>>>>Register_Object TextBoxSub2
51201>>>>>>>>>>>>>Register_Object TextBoxSub3
51201>>>>>>>>>>>>>Register_Object Units_DD
51201>>>>>>>>>>>>>Register_Object Witemkat_DD
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>    //AB-StoreTopStart
51201>>>>>>>>>>>>>                                
51201>>>>>>>>>>>>>                                
51201>>>>>>>>>>>>>    //AB-StoreTopEnd
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>    //AB-IgnoreStart
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>    Use DFAllEnt.pkg
51201>>>>>>>>>>>>>    Use dbList.Sub
51201>>>>>>>>>>>>>    Use Txtbox.Sub
51201>>>>>>>>>>>>>    Use Form.Sub
51201>>>>>>>>>>>>>    Use Rgroup.Sub
51201>>>>>>>>>>>>>    Use Radio.Sub
51201>>>>>>>>>>>>>    Use Button.Sub
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>    Use WITEMKAT.DD
51201>>>>>>>>>>>>>    Use UNITS.DD
51201>>>>>>>>>>>>>    Use FPA.DD
51201>>>>>>>>>>>>>    Use ITEM.DD
51201>>>>>>>>>>>>>    
51201>>>>>>>>>>>>>    //AB-IgnoreEnd
51201>>>>>>>>>>>>>
51201>>>>>>>>>>>>>    CD_Popup_Object SL22s is a dbModalPanel
51220>>>>>>>>>>>>>
51220>>>>>>>>>>>>>        //AB-StoreTopStart
51220>>>>>>>>>>>>>        Property String     pscode                  ''
51222>>>>>>>>>>>>>        Property String     psperi                  ''
51224>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
51226>>>>>>>>>>>>>        Property String     pscodekat               ''
51228>>>>>>>>>>>>>        
51228>>>>>>>>>>>>>        //AB-StoreTopEnd
51228>>>>>>>>>>>>>
51228>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
51229>>>>>>>>>>>>>        Set Label to "€¨®œå¦ „ ›é¤"
51230>>>>>>>>>>>>>        Set Size to 270 484
51231>>>>>>>>>>>>>        Set Location to 5 7
51232>>>>>>>>>>>>>
51232>>>>>>>>>>>>>        //AB-DDOStart
51232>>>>>>>>>>>>>
51232>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51234>>>>>>>>>>>>>        End_Object    // Witemkat_DD
51235>>>>>>>>>>>>>
51235>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
51237>>>>>>>>>>>>>        End_Object    // Units_DD
51238>>>>>>>>>>>>>
51238>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
51240>>>>>>>>>>>>>        End_Object    // Fpa_DD
51241>>>>>>>>>>>>>
51241>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
51243>>>>>>>>>>>>>
51243>>>>>>>>>>>>>            //AB-StoreTopStart
51243>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
51245>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
51246>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
51246>>>>>>>>>>>>>                       Move 0 to rVal
51247>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
51248>>>>>>>>>>>>>                       Get psperi to lsperi
51249>>>>>>>>>>>>>                       Get pscode to lscode
51250>>>>>>>>>>>>>                       Get pscodekat to lscodekat
51251>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51252>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51253>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
51253>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
51255>>>>>>>>>>>>>                           If ((Trim(item.item_descr)) Contains lsperi) Begin
51257>>>>>>>>>>>>>                               If ((Trim(item.item_code)) Contains lscode) Move 1 to rVal
51260>>>>>>>>>>>>>                           End
51260>>>>>>>>>>>>>>
51260>>>>>>>>>>>>>            
51260>>>>>>>>>>>>>                       End
51260>>>>>>>>>>>>>>
51260>>>>>>>>>>>>>                       Else Begin
51261>>>>>>>>>>>>>                           If (Left(item.item_descr,(Length(lsperi)))=lsperi) Begin
51263>>>>>>>>>>>>>                               If (Left(item.item_code,(Length(lscode)))=lscode) Move 1 to rVal
51266>>>>>>>>>>>>>                           End
51266>>>>>>>>>>>>>>
51266>>>>>>>>>>>>>            
51266>>>>>>>>>>>>>                       End
51266>>>>>>>>>>>>>>
51266>>>>>>>>>>>>>                       Function_Return rVal
51267>>>>>>>>>>>>>                   End_Function
51268>>>>>>>>>>>>>            
51268>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
51270>>>>>>>>>>>>>                       String lsperi
51271>>>>>>>>>>>>>                       Get psperi to lsperi
51272>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51273>>>>>>>>>>>>>                       Function_Return (Left(item.item_descr,(Length(lsperi)))=lsperi)
51274>>>>>>>>>>>>>                   End_Function
51275>>>>>>>>>>>>>            
51275>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
51277>>>>>>>>>>>>>                       String lscode lscodekat
51278>>>>>>>>>>>>>                       Get pscode to lscode
51279>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51280>>>>>>>>>>>>>                       Function_Return (Left(item.item_code,(Length(lscode)))=lscode)
51281>>>>>>>>>>>>>                   End_Function
51282>>>>>>>>>>>>>            
51282>>>>>>>>>>>>>            //AB-StoreTopEnd
51282>>>>>>>>>>>>>
51282>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
51283>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
51284>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
51285>>>>>>>>>>>>>
51285>>>>>>>>>>>>>            //AB-StoreStart
51285>>>>>>>>>>>>>                                                                                                
51285>>>>>>>>>>>>>                                                                                                
51285>>>>>>>>>>>>>                                                                                                
51285>>>>>>>>>>>>>            Begin_Constraints
51287>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
51288>>>>>>>>>>>>>               Integer liContains_Or_Starts
51288>>>>>>>>>>>>>             //  Get FragmaItem  to lsValue
51288>>>>>>>>>>>>>            
51288>>>>>>>>>>>>>                   Get psperi  to lsperi
51289>>>>>>>>>>>>>                   Get pscode  to lscode
51290>>>>>>>>>>>>>                   Get pscodekat  to lscodekat
51291>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
51292>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
51293>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
51294>>>>>>>>>>>>>                   Move (Trim(lscodekat)) to lscodekat
51295>>>>>>>>>>>>>                   If ((lsperi<>'') and (lscode<>'')) begin
51297>>>>>>>>>>>>>                        set ordering to 5
51298>>>>>>>>>>>>>                        Constrain item as (fiPeriexei(Self)=1)
51299>>>>>>>>>>>>>                   end
51299>>>>>>>>>>>>>>
51299>>>>>>>>>>>>>                   Else Begin
51300>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
51302>>>>>>>>>>>>>                        If (lsperi<>'') begin
51304>>>>>>>>>>>>>                            set ordering to 3
51305>>>>>>>>>>>>>                            Constrain item.item_descr Contains lsperi
51307>>>>>>>>>>>>>                        end
51307>>>>>>>>>>>>>>
51307>>>>>>>>>>>>>                        Else If (lscode<>'') begin
51310>>>>>>>>>>>>>                            set ordering to 5
51311>>>>>>>>>>>>>                            Constrain item.item_code Contains lscode
51313>>>>>>>>>>>>>                        end
51313>>>>>>>>>>>>>>
51313>>>>>>>>>>>>>                      End
51313>>>>>>>>>>>>>>
51313>>>>>>>>>>>>>                      Else Begin
51314>>>>>>>>>>>>>                           If (lsperi<>'') begin
51316>>>>>>>>>>>>>                                set ordering to 3
51317>>>>>>>>>>>>>                                Constrain item as (fiArxizeiperi(Self)=1) //item.item_descr
51318>>>>>>>>>>>>>                           end
51318>>>>>>>>>>>>>>
51318>>>>>>>>>>>>>                           Else If (lscode<>'') begin
51321>>>>>>>>>>>>>                                set ordering to 5
51322>>>>>>>>>>>>>                                Constrain item as (fiArxizeicode(Self)=1) //item.item_code
51323>>>>>>>>>>>>>                           end
51323>>>>>>>>>>>>>>
51323>>>>>>>>>>>>>                      End
51323>>>>>>>>>>>>>>
51323>>>>>>>>>>>>>                   End
51323>>>>>>>>>>>>>>
51323>>>>>>>>>>>>>                   If (lscodekat<>'') Constrain item.witemkat_code Contains lscodekat
51327>>>>>>>>>>>>>            
51327>>>>>>>>>>>>>            End_Constraints
51330>>>>>>>>>>>>>            
51330>>>>>>>>>>>>>            
51330>>>>>>>>>>>>>            
51330>>>>>>>>>>>>>            
51330>>>>>>>>>>>>>            //AB-StoreEnd
51330>>>>>>>>>>>>>
51330>>>>>>>>>>>>>        End_Object    // Item_DD
51331>>>>>>>>>>>>>
51331>>>>>>>>>>>>>        Set Main_DD to (Item_DD(self))
51332>>>>>>>>>>>>>        Set Server to (Item_DD(self))
51333>>>>>>>>>>>>>
51333>>>>>>>>>>>>>        //AB-DDOEnd
51333>>>>>>>>>>>>>
51333>>>>>>>>>>>>>        Object oSelList is a dbListSub
51335>>>>>>>>>>>>>            Set Main_File to Item.File_Number
51336>>>>>>>>>>>>>            Set Ordering to 5
51337>>>>>>>>>>>>>            Set Size to 190 475
51338>>>>>>>>>>>>>            Set Location to -1 2
51339>>>>>>>>>>>>>            Set Color to 14280447
51340>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
51341>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
51342>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
51343>>>>>>>>>>>>>
51343>>>>>>>>>>>>>            Begin_Row
51346>>>>>>>>>>>>>                Entry_Item Item.Item_code
51347>>>>>>>>>>>>>                Entry_Item Item.Item_descr
51348>>>>>>>>>>>>>                Entry_Item Item.Witemkat_code
51349>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
51350>>>>>>>>>>>>>                Entry_Item Item.Item_qual
51351>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
51352>>>>>>>>>>>>>            End_Row
51357>>>>>>>>>>>>>
51357>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
51358>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
51359>>>>>>>>>>>>>            
51359>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
51360>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
51361>>>>>>>>>>>>>            
51361>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
51362>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
51363>>>>>>>>>>>>>            
51363>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
51364>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
51365>>>>>>>>>>>>>            
51365>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
51366>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
51367>>>>>>>>>>>>>            
51367>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
51368>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
51369>>>>>>>>>>>>>            
51369>>>>>>>>>>>>>
51369>>>>>>>>>>>>>            //AB-StoreStart
51369>>>>>>>>>>>>>            
51369>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
51371>>>>>>>>>>>>>            
51371>>>>>>>>>>>>>            set export_item_state to true
51372>>>>>>>>>>>>>            
51372>>>>>>>>>>>>>            Procedure Activating
51374>>>>>>>>>>>>>               Forward send Activating
51376>>>>>>>>>>>>>               Send Rebuild_Constraints to (Item_DD(Self))
51377>>>>>>>>>>>>>            End_Procedure
51378>>>>>>>>>>>>>            
51378>>>>>>>>>>>>>            Function Child_Exiting Integer iWhere Returns Integer
51380>>>>>>>>>>>>>                local integer Rval
51381>>>>>>>>>>>>>                Forward get Child_Exiting iWhere  to Rval
51383>>>>>>>>>>>>>                set value of (ocode   (self))   to ''
51384>>>>>>>>>>>>>                set value of (operi   (self))   to ''
51385>>>>>>>>>>>>>                set value of (ocodekat(self))   to ''
51386>>>>>>>>>>>>>                set psperi                      to ''
51387>>>>>>>>>>>>>                set pscode                      to ''
51388>>>>>>>>>>>>>                set pscodekat                   to ''
51389>>>>>>>>>>>>>                function_return Rval // if non-zero do not enter
51390>>>>>>>>>>>>>            End_function
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            
51391>>>>>>>>>>>>>            //AB-StoreEnd
51391>>>>>>>>>>>>>
51391>>>>>>>>>>>>>        End_Object    // oSelList
51392>>>>>>>>>>>>>
51392>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
51394>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
51395>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51396>>>>>>>>>>>>>            Set Location to 192 6
51397>>>>>>>>>>>>>            Set Size to 13 78
51398>>>>>>>>>>>>>        End_Object    // TextBoxSub1
51399>>>>>>>>>>>>>
51399>>>>>>>>>>>>>        Object ocode is a FormSub
51401>>>>>>>>>>>>>            Set Size to 13 197
51402>>>>>>>>>>>>>            Set Location to 192 79
51403>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51404>>>>>>>>>>>>>
51404>>>>>>>>>>>>>            //AB-StoreStart
51404>>>>>>>>>>>>>                                                
51404>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51406>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51407>>>>>>>>>>>>>            End_Procedure
51408>>>>>>>>>>>>>            
51408>>>>>>>>>>>>>            
51408>>>>>>>>>>>>>            
51408>>>>>>>>>>>>>            
51408>>>>>>>>>>>>>            //AB-StoreEnd
51408>>>>>>>>>>>>>
51408>>>>>>>>>>>>>        End_Object    // ocode
51409>>>>>>>>>>>>>
51409>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
51411>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
51412>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51413>>>>>>>>>>>>>            Set Location to 207 6
51414>>>>>>>>>>>>>            Set Size to 13 83
51415>>>>>>>>>>>>>        End_Object    // TextBoxSub2
51416>>>>>>>>>>>>>
51416>>>>>>>>>>>>>        Object operi is a FormSub
51418>>>>>>>>>>>>>            Set Size to 13 197
51419>>>>>>>>>>>>>            Set Location to 207 79
51420>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51421>>>>>>>>>>>>>
51421>>>>>>>>>>>>>            //AB-StoreStart
51421>>>>>>>>>>>>>                                                
51421>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51423>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51424>>>>>>>>>>>>>            End_Procedure
51425>>>>>>>>>>>>>            
51425>>>>>>>>>>>>>            
51425>>>>>>>>>>>>>            
51425>>>>>>>>>>>>>            
51425>>>>>>>>>>>>>            //AB-StoreEnd
51425>>>>>>>>>>>>>
51425>>>>>>>>>>>>>        End_Object    // operi
51426>>>>>>>>>>>>>
51426>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
51428>>>>>>>>>>>>>            Set Size to 32 77
51429>>>>>>>>>>>>>            Set Location to 193 277
51430>>>>>>>>>>>>>            Object Radio1 is a RadioSub
51432>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
51433>>>>>>>>>>>>>                Set Size to 10 53
51434>>>>>>>>>>>>>                Set Location to 7 5
51435>>>>>>>>>>>>>            End_Object    // Radio1
51436>>>>>>>>>>>>>
51436>>>>>>>>>>>>>            Object Radio2 is a RadioSub
51438>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
51439>>>>>>>>>>>>>                Set Size to 10 51
51440>>>>>>>>>>>>>                Set Location to 21 5
51441>>>>>>>>>>>>>            End_Object    // Radio2
51442>>>>>>>>>>>>>
51442>>>>>>>>>>>>>
51442>>>>>>>>>>>>>            //AB-StoreStart
51442>>>>>>>>>>>>>                                                
51442>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
51444>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
51445>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51446>>>>>>>>>>>>>            End_Procedure
51447>>>>>>>>>>>>>            
51447>>>>>>>>>>>>>            
51447>>>>>>>>>>>>>            
51447>>>>>>>>>>>>>            
51447>>>>>>>>>>>>>            //AB-StoreEnd
51447>>>>>>>>>>>>>
51447>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
51448>>>>>>>>>>>>>
51448>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
51450>>>>>>>>>>>>>            Set Label to "Search"
51451>>>>>>>>>>>>>            Set Size to 28 37
51452>>>>>>>>>>>>>            Set Location to 198 357
51453>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
51454>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
51455>>>>>>>>>>>>>
51455>>>>>>>>>>>>>            //AB-StoreStart
51455>>>>>>>>>>>>>                                                                                                
51455>>>>>>>>>>>>>            Set Visible_State to False
51456>>>>>>>>>>>>>            
51456>>>>>>>>>>>>>            Procedure OnClick
51458>>>>>>>>>>>>>                Forward Send OnClick
51460>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
51461>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
51462>>>>>>>>>>>>>                Set pscodekat  to (Value(ocodekat(Self),0))
51463>>>>>>>>>>>>>                send Rebuild_Constraints    to (item_DD(Self))
51464>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
51465>>>>>>>>>>>>>            End_Procedure // OnClick
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            
51466>>>>>>>>>>>>>            //AB-StoreEnd
51466>>>>>>>>>>>>>
51466>>>>>>>>>>>>>        End_Object    // ButtonSub1
51467>>>>>>>>>>>>>
51467>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
51469>>>>>>>>>>>>>            Set Label to "‰à›.‰˜«žš¦¨å˜ª ‚ á"
51470>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51471>>>>>>>>>>>>>            Set Location to 221 5
51472>>>>>>>>>>>>>            Set Size to 13 78
51473>>>>>>>>>>>>>        End_Object    // TextBoxSub3
51474>>>>>>>>>>>>>
51474>>>>>>>>>>>>>        Object ocodekat is a FormSub
51476>>>>>>>>>>>>>            Set Size to 13 197
51477>>>>>>>>>>>>>            Set Location to 221 78
51478>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51479>>>>>>>>>>>>>
51479>>>>>>>>>>>>>            //AB-StoreStart
51479>>>>>>>>>>>>>                                                
51479>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51481>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
51482>>>>>>>>>>>>>            End_Procedure
51483>>>>>>>>>>>>>            
51483>>>>>>>>>>>>>            
51483>>>>>>>>>>>>>            
51483>>>>>>>>>>>>>            //AB-StoreEnd
51483>>>>>>>>>>>>>
51483>>>>>>>>>>>>>        End_Object    // ocodekat
51484>>>>>>>>>>>>>
51484>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
51486>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
51487>>>>>>>>>>>>>            Set Location to 237 316
51488>>>>>>>>>>>>>
51488>>>>>>>>>>>>>            //AB-StoreStart
51488>>>>>>>>>>>>>            Procedure OnClick
51490>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
51491>>>>>>>>>>>>>            End_Procedure
51492>>>>>>>>>>>>>            //AB-StoreEnd
51492>>>>>>>>>>>>>
51492>>>>>>>>>>>>>        End_Object    // oOK_bn
51493>>>>>>>>>>>>>
51493>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
51495>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
51496>>>>>>>>>>>>>            Set Location to 237 371
51497>>>>>>>>>>>>>
51497>>>>>>>>>>>>>            //AB-StoreStart
51497>>>>>>>>>>>>>            Procedure OnClick
51499>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
51500>>>>>>>>>>>>>            End_Procedure
51501>>>>>>>>>>>>>            //AB-StoreEnd
51501>>>>>>>>>>>>>
51501>>>>>>>>>>>>>        End_Object    // oCancel_bn
51502>>>>>>>>>>>>>
51502>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
51504>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
51505>>>>>>>>>>>>>            Set Location to 237 426
51506>>>>>>>>>>>>>
51506>>>>>>>>>>>>>            //AB-StoreStart
51506>>>>>>>>>>>>>            Procedure OnClick
51508>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
51509>>>>>>>>>>>>>            End_Procedure
51510>>>>>>>>>>>>>            //AB-StoreEnd
51510>>>>>>>>>>>>>
51510>>>>>>>>>>>>>        End_Object    // oSearch_bn
51511>>>>>>>>>>>>>
51511>>>>>>>>>>>>>
51511>>>>>>>>>>>>>        //AB-StoreStart
51511>>>>>>>>>>>>>                
51511>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
51512>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
51513>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
51514>>>>>>>>>>>>>        
51514>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        
51515>>>>>>>>>>>>>        //AB-StoreEnd
51515>>>>>>>>>>>>>
51515>>>>>>>>>>>>>    CD_End_Object    // SL22s
51517>>>>>>>>>>>>>>
51517>>>>>>>>>>>>>
51517>>>>>>>>>>>>>
51517>>>>>>>>>>>>>    //AB-StoreStart
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>                                
51517>>>>>>>>>>>>>    //AB-StoreEnd
51517>>>>>>>>>>>>>
51517>>>>>>>>>>>>>//AB/     End_Object    // prj
51517>>>>>>>>>>>Use sl022.SL         // sl022
51517>>>>>>>>>>>
51517>>>>>>>>>>>//DDB-Selection-pkg-End
51517>>>>>>>>>>>//DDB-FileEnd
51517>>>>>>>>>    Use WITEMX.DD
INCLUDING FILE: WITEMX.DD
51517>>>>>>>>>>>//DDB-FileStart
51517>>>>>>>>>>>//DDB-HeaderStart
51517>>>>>>>>>>>
51517>>>>>>>>>>>// File Name : WITEMX.DD
51517>>>>>>>>>>>// Class Name: Witemx_DataDictionary
51517>>>>>>>>>>>// Revision  : 77
51517>>>>>>>>>>>// Version   : 2
51517>>>>>>>>>>>
51517>>>>>>>>>>>Use  Windows           // Basic Definitions
51517>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51517>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51517>>>>>>>>>>>
51517>>>>>>>>>>>Open Witemx
51519>>>>>>>>>>>Open Witemxt
51521>>>>>>>>>>>Open Pmoves
51523>>>>>>>>>>>Open Wam
51525>>>>>>>>>>>Open Pmovesl
51527>>>>>>>>>>>Open Witemxen
INCLUDING FILE: WITEMXEN.FD
51529>>>>>>>>>>>Open Camovedd
INCLUDING FILE: CAMOVEDD.FD
51531>>>>>>>>>>>Open Wcmoves
51533>>>>>>>>>>>Open Item
51535>>>>>>>>>>>Open Sysrecw
51537>>>>>>>>>>>Open Syscurxr
51539>>>>>>>>>>>
51539>>>>>>>>>>>//DDB-HeaderEnd
51539>>>>>>>>>>>//DDB-SelectionStart
51539>>>>>>>>>>>//DDB/ ExternalSelectionList SL17  sl17.SL
51539>>>>>>>>>>>Register_Object SL17
51539>>>>>>>>>>>//DDB-SelectionEnd
51539>>>>>>>>>>>
51539>>>>>>>>>>>Class Witemx_DataDictionary  is a DataDictionary
51540>>>>>>>>>>>
51540>>>>>>>>>>>    Procedure Construct_Object
51541>>>>>>>>>>>        Forward Send Construct_Object
51543>>>>>>>>>>>        Property Integer piMustNOTConstrain Public 0
51544>>>>>>>>>>>    End_Procedure //construct_object
51545>>>>>>>>>>>
51545>>>>>>>>>>>    Procedure OnConstrain
51546>>>>>>>>>>>        Forward Send OnConstrain
51548>>>>>>>>>>>        If (piMustNOTConstrain(Self)) Begin
51550>>>>>>>>>>>        End
51550>>>>>>>>>>>>
51550>>>>>>>>>>>        Else Begin
51551>>>>>>>>>>>            Constrain Witemx.Company_Code  eq SysCurXR.Company_Code
51553>>>>>>>>>>>            Constrain Witemx.Branch_Code   eq SysCurXR.Branch_Code
51555>>>>>>>>>>>            Constrain Witemx.Year_Year     eq SysCurXR.Year_Year
51557>>>>>>>>>>>        End
51557>>>>>>>>>>>>
51557>>>>>>>>>>>    End_Procedure
51558>>>>>>>>>>>
51558>>>>>>>>>>>    Procedure Save_Main_File
51559>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
51561>>>>>>>>>>>            If Witemx.Recnum Eq 0 Procedure_Return
51564>>>>>>>>>>>        End
51564>>>>>>>>>>>>
51564>>>>>>>>>>>        Forward Send Save_Main_File
51566>>>>>>>>>>>    End_Procedure
51567>>>>>>>>>>>
51567>>>>>>>>>>>    // Update:
51567>>>>>>>>>>>    Procedure Update
51568>>>>>>>>>>>        Forward Send Update
51570>>>>>>>>>>>        // Insert Code Here
51570>>>>>>>>>>>        Move SysCurXR.Company_Code  to Witemx.Company_Code
51571>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Witemx.Branch_Code
51572>>>>>>>>>>>        Move SysCurXR.Year_Year     to Witemx.Year_Year
51573>>>>>>>>>>>        Move SysCurXR.Year_Recr     to Witemx.Year_Recr
51574>>>>>>>>>>>        Move Witemkat.Witemkat_Code to Witemx.Witemkat_Code
51575>>>>>>>>>>>        Move Units.Units_Code       to Witemx.Units_Code
51576>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Item_Code
51577>>>>>>>>>>>        Move Item.Item_Code         to Witemx.Witemx_Code
51578>>>>>>>>>>>        Move Item.Item_Descr        to Witemx.Witemx_Descr
51579>>>>>>>>>>>        Move Item.Wapokat_Code      to Witemx.ITEM_APOKAT_COD 
51580>>>>>>>>>>>        Move Item.link1             to witemx.link1
51581>>>>>>>>>>>        move Item.link2             to witemx.link2
51582>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
51583>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
51584>>>>>>>>>>>    End_Procedure   // Update
51585>>>>>>>>>>>
51585>>>>>>>>>>>
51585>>>>>>>>>>>    Procedure Backout
51586>>>>>>>>>>>        Forward Send Backout
51588>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Xre/Witemx.Qty_Xre),4))  to Witemx.Mesosta_Xre
51589>>>>>>>>>>>        Move (Round_Number((Witemx.Axia_Pis/Witemx.Qty_Pis),4))  to Witemx.Mesosta_Pis
51590>>>>>>>>>>>    End_Procedure   // Update
51591>>>>>>>>>>>
51591>>>>>>>>>>>    Procedure Creating
51592>>>>>>>>>>>        Forward Send Creating
51594>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                       (Trim(String(Witemx.Witemx_Rec0)))))) to Witemx.Witemx_Recr
51595>>>>>>>>>>>    End_Procedure   // Creating
51596>>>>>>>>>>>
51596>>>>>>>>>>>
51596>>>>>>>>>>>
51596>>>>>>>>>>>    // Define_Fields:
51596>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51596>>>>>>>>>>>
51596>>>>>>>>>>>    Procedure Define_Fields
51597>>>>>>>>>>>        Forward Send Define_Fields
51599>>>>>>>>>>>        //DDB-Generated-Code-Location
51599>>>>>>>>>>>        //DDB-DefineFieldStart
51599>>>>>>>>>>>
51599>>>>>>>>>>>        Set Main_File            To Witemx.File_Number
51600>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51601>>>>>>>>>>>
51601>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51602>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51603>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51604>>>>>>>>>>>
51604>>>>>>>>>>>        // Child (Client) file structure................
51604>>>>>>>>>>>        Send Add_Client_File  Witemxt.File_Number
51605>>>>>>>>>>>        Send Add_Client_File  Pmoves.File_Number
51606>>>>>>>>>>>        Send Add_Client_File  Wam.File_Number
51607>>>>>>>>>>>        Send Add_Client_File  Pmovesl.File_Number
51608>>>>>>>>>>>        Send Add_Client_File  Witemxen.File_Number
51609>>>>>>>>>>>        Send Add_Client_File  Camovedd.File_Number
51610>>>>>>>>>>>        Send Add_Client_File  Wcmoves.File_Number
51611>>>>>>>>>>>
51611>>>>>>>>>>>        // Parent (Server) file structure...............
51611>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
51612>>>>>>>>>>>
51612>>>>>>>>>>>        // External (System) file structure.............
51612>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51613>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
51614>>>>>>>>>>>
51614>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemx_Rec0  To Witemx.Witemx_Rec0
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Field-based properties.......................
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Company_Code
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Branch_Code
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Year_Year
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Units_Code
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Witemkat_Code
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Item_Code
51617>>>>>>>>>>>
51617>>>>>>>>>>>        // Witemx.Witemx_Code
51617>>>>>>>>>>>        Set Field_Options          Field Witemx.Witemx_Code To DD_AUTOFIND   
51618>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Code To (SL17(Self))
51619>>>>>>>>>>>        Set Key_Field_State        Field Witemx.Witemx_Code To TRUE
51620>>>>>>>>>>>
51620>>>>>>>>>>>        // Witemx.Witemx_Recr
51620>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Recr To (SL17(Self))
51621>>>>>>>>>>>
51621>>>>>>>>>>>        // Witemx.Year_Recr
51621>>>>>>>>>>>
51621>>>>>>>>>>>        // Witemx.Item_Recr
51621>>>>>>>>>>>
51621>>>>>>>>>>>        // Witemx.Witemx_Descr
51621>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemx.Witemx_Descr To (SL17(Self))
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Witemx_Rec0
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Witemx_Yeardesc
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Item_Apokat_Cod
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Qty_Xre
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Qty_Pis
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Axia_Xre
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Axia_Pis
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Mesosta_Xre
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Mesosta_Pis
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Link1
51622>>>>>>>>>>>
51622>>>>>>>>>>>        // Witemx.Link2
51622>>>>>>>>>>>
51622>>>>>>>>>>>        //DDB-DefineFieldEnd
51622>>>>>>>>>>>    End_Procedure    // Define_Fields
51623>>>>>>>>>>>
51623>>>>>>>>>>>    // Field_Defaults:
51623>>>>>>>>>>>    // This procedure is used to establish default field values.
51623>>>>>>>>>>>
51623>>>>>>>>>>>    Procedure Field_Defaults
51624>>>>>>>>>>>        Forward Send Field_Defaults
51626>>>>>>>>>>>        //DDB-Generated-Code-Location
51626>>>>>>>>>>>        //DDB-FieldDefaultStart
51626>>>>>>>>>>>        //DDB-FieldDefaultEnd
51626>>>>>>>>>>>    End_Procedure    // Field_Defaults
51627>>>>>>>>>>>
51627>>>>>>>>>>>End_Class    // Witemx_DataDictionary
51628>>>>>>>>>>>//DDB-Selection-pkg-Start
51628>>>>>>>>>>>
51628>>>>>>>>>>>Use sl17.SL          // SL17
INCLUDING FILE: SL17.SL
51628>>>>>>>>>>>>>//AB/ Project SL17:witemx
51628>>>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
51628>>>>>>>>>>>>>//AB/         Set ProjectName to "SL17:witemx"
51628>>>>>>>>>>>>>//AB/         Set ProjectFileName to "sl17.SL"
51628>>>>>>>>>>>>>
51628>>>>>>>>>>>>>// Project Object Structure
51628>>>>>>>>>>>>>//   SL17 is a dbModalPanelSub
51628>>>>>>>>>>>>>//     Units_DD is a DataDictionary
51628>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
51628>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
51628>>>>>>>>>>>>>//     Item_DD is a DataDictionary
51628>>>>>>>>>>>>>//     Witemx_DD is a DataDictionary
51628>>>>>>>>>>>>>//     oSelList is a dbListSub
51628>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51628>>>>>>>>>>>>>//     ocode is a FormSub
51628>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51628>>>>>>>>>>>>>//     operi is a FormSub
51628>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
51628>>>>>>>>>>>>>//       Radio1 is a RadioSub
51628>>>>>>>>>>>>>//       Radio2 is a RadioSub
51628>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
51628>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
51628>>>>>>>>>>>>>//     ocodekat is a FormSub
51628>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
51628>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
51628>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
51628>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
51628>>>>>>>>>>>>>
51628>>>>>>>>>>>>>// Register all objects
51628>>>>>>>>>>>>>Register_Object ButtonSub1
51628>>>>>>>>>>>>>Register_Object btnwitemcl
51628>>>>>>>>>>>>>Register_Object Fpa_DD
51628>>>>>>>>>>>>>Register_Object Item_DD
51628>>>>>>>>>>>>>Register_Object oCancel_bn
51628>>>>>>>>>>>>>Register_Object ocode
51628>>>>>>>>>>>>>Register_Object ocodekat
51628>>>>>>>>>>>>>Register_Object oOK_bn
51628>>>>>>>>>>>>>Register_Object operi
51628>>>>>>>>>>>>>Register_Object oSearch_bn
51628>>>>>>>>>>>>>Register_Object oSelList
51628>>>>>>>>>>>>>Register_Object Radio1
51628>>>>>>>>>>>>>Register_Object Radio2
51628>>>>>>>>>>>>>Register_Object RadioGroupSub1
51628>>>>>>>>>>>>>Register_Object SL17
51628>>>>>>>>>>>>>Register_Object TextBoxSub1
51628>>>>>>>>>>>>>Register_Object TextBoxSub2
51628>>>>>>>>>>>>>Register_Object TextBoxSub3
51628>>>>>>>>>>>>>Register_Object Units_DD
51628>>>>>>>>>>>>>Register_Object Witemkat_DD
51628>>>>>>>>>>>>>Register_Object Witemx_DD
51628>>>>>>>>>>>>>
51628>>>>>>>>>>>>>
51628>>>>>>>>>>>>>
51628>>>>>>>>>>>>>    //AB-StoreTopStart
51628>>>>>>>>>>>>>    use dg186.dg
INCLUDING FILE: DG186.DG
51628>>>>>>>>>>>>>>>//AB/ Project dg186
51628>>>>>>>>>>>>>>>//AB/     Object prj is a Dialog_Project
51628>>>>>>>>>>>>>>>//AB/         Set ProjectName to "dg186"
51628>>>>>>>>>>>>>>>//AB/         Set ProjectFileName to "dg186.DG"
51628>>>>>>>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
51628>>>>>>>>>>>>>>>
51628>>>>>>>>>>>>>>>// Project Object Structure
51628>>>>>>>>>>>>>>>//   dg186 is a dbModalPanelSub
51628>>>>>>>>>>>>>>>//     Witemkat_DD is a DataDictionary
51628>>>>>>>>>>>>>>>//     Units_DD is a DataDictionary
51628>>>>>>>>>>>>>>>//     Fpa_DD is a DataDictionary
51628>>>>>>>>>>>>>>>//     Item_DD is a DataDictionary
51628>>>>>>>>>>>>>>>//     Witemcl_DD is a DataDictionary
51628>>>>>>>>>>>>>>>//     The_Table is a dbGrid
51628>>>>>>>>>>>>>>>//     TextBoxSub1 is a TextBoxSub
51628>>>>>>>>>>>>>>>//     TextBoxSub2 is a TextBoxSub
51628>>>>>>>>>>>>>>>//     TextBoxSub3 is a TextBoxSub
51628>>>>>>>>>>>>>>>//     ocode is a FormSub
51628>>>>>>>>>>>>>>>//     operi is a FormSub
51628>>>>>>>>>>>>>>>//     ocodeprom is a FormSub
51628>>>>>>>>>>>>>>>//     RadioGroupSub1 is a RadioGroupSub
51628>>>>>>>>>>>>>>>//       Radio1 is a RadioSub
51628>>>>>>>>>>>>>>>//       Radio2 is a RadioSub
51628>>>>>>>>>>>>>>>//     ButtonSub1 is a ButtonSub
51628>>>>>>>>>>>>>>>//     btnwitemcl is a ButtonSub
51628>>>>>>>>>>>>>>>
51628>>>>>>>>>>>>>>>// Register all objects
51628>>>>>>>>>>>>>>>Register_Object ButtonSub1
51628>>>>>>>>>>>>>>>Register_Object btnwitemcl
51628>>>>>>>>>>>>>>>Register_Object dg186
51628>>>>>>>>>>>>>>>Register_Object Fpa_DD
51628>>>>>>>>>>>>>>>Register_Object Item_DD
51628>>>>>>>>>>>>>>>Register_Object ocode
51628>>>>>>>>>>>>>>>Register_Object ocodeprom
51628>>>>>>>>>>>>>>>Register_Object operi
51628>>>>>>>>>>>>>>>Register_Object Radio1
51628>>>>>>>>>>>>>>>Register_Object Radio2
51628>>>>>>>>>>>>>>>Register_Object RadioGroupSub1
51628>>>>>>>>>>>>>>>Register_Object TextBoxSub1
51628>>>>>>>>>>>>>>>Register_Object TextBoxSub2
51628>>>>>>>>>>>>>>>Register_Object TextBoxSub3
51628>>>>>>>>>>>>>>>Register_Object The_Table
51628>>>>>>>>>>>>>>>Register_Object Units_DD
51628>>>>>>>>>>>>>>>Register_Object Witemcl_DD
51628>>>>>>>>>>>>>>>Register_Object Witemkat_DD
51628>>>>>>>>>>>>>>>
51628>>>>>>>>>>>>>>>
51628>>>>>>>>>>>>>>>
51628>>>>>>>>>>>>>>>    //AB-StoreTopStart
51628>>>>>>>>>>>>>>>    open clients
51630>>>>>>>>>>>>>>>    use sl17.sl
51630>>>>>>>>>>>>>>>    //AB-StoreTopEnd
51630>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>    //AB-IgnoreStart
51630>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>    Use DFAllEnt.pkg
51630>>>>>>>>>>>>>>>    Use Txtbox.Sub
51630>>>>>>>>>>>>>>>    Use Form.Sub
51630>>>>>>>>>>>>>>>    Use Rgroup.Sub
51630>>>>>>>>>>>>>>>    Use Radio.Sub
51630>>>>>>>>>>>>>>>    Use Button.Sub
51630>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>    Use WITEMKAT.DD
51630>>>>>>>>>>>>>>>    Use UNITS.DD
51630>>>>>>>>>>>>>>>    Use FPA.DD
51630>>>>>>>>>>>>>>>    Use ITEM.DD
51630>>>>>>>>>>>>>>>    Use WITEMCL.DD
INCLUDING FILE: WITEMCL.DD
51630>>>>>>>>>>>>>>>>>//DDB-FileStart
51630>>>>>>>>>>>>>>>>>//DDB-HeaderStart
51630>>>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>>>// File Name : WITEMCL.DD
51630>>>>>>>>>>>>>>>>>// Class Name: Witemcl_DataDictionary
51630>>>>>>>>>>>>>>>>>// Revision  : 16
51630>>>>>>>>>>>>>>>>>// Version   : 2
51630>>>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>>>Use  Windows           // Basic Definitions
51630>>>>>>>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
51630>>>>>>>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
51630>>>>>>>>>>>>>>>>>
51630>>>>>>>>>>>>>>>>>Open Witemcl
51632>>>>>>>>>>>>>>>>>Open Witemcld
51634>>>>>>>>>>>>>>>>>Open Item
51636>>>>>>>>>>>>>>>>>Open Sysrecw
51638>>>>>>>>>>>>>>>>>
51638>>>>>>>>>>>>>>>>>//DDB-HeaderEnd
51638>>>>>>>>>>>>>>>>>//DDB-SelectionStart
51638>>>>>>>>>>>>>>>>>//DDB/ ExternalSelectionList SL100  sl100.sl
51638>>>>>>>>>>>>>>>>>Register_Object SL100
51638>>>>>>>>>>>>>>>>>//DDB-SelectionEnd
51638>>>>>>>>>>>>>>>>>
51638>>>>>>>>>>>>>>>>>Class Witemcl_DataDictionary  is a DataDictionary_Sec
51639>>>>>>>>>>>>>>>>> 
51639>>>>>>>>>>>>>>>>>    // Update:
51639>>>>>>>>>>>>>>>>> 
51639>>>>>>>>>>>>>>>>>    Procedure Update
51640>>>>>>>>>>>>>>>>>        Forward Send Update  
51642>>>>>>>>>>>>>>>>>        move item.item_descr to witemcl.item_descr
51643>>>>>>>>>>>>>>>>>    End_Procedure   // Update
51644>>>>>>>>>>>>>>>>> 
51644>>>>>>>>>>>>>>>>>
51644>>>>>>>>>>>>>>>>>    // Define_Fields:
51644>>>>>>>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
51644>>>>>>>>>>>>>>>>>
51644>>>>>>>>>>>>>>>>>    Procedure Define_Fields
51645>>>>>>>>>>>>>>>>>        Forward Send Define_Fields
51647>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51647>>>>>>>>>>>>>>>>>        //DDB-DefineFieldStart
51647>>>>>>>>>>>>>>>>>
51647>>>>>>>>>>>>>>>>>        Set Main_File            To Witemcl.File_Number
51648>>>>>>>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
51649>>>>>>>>>>>>>>>>>
51649>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
51650>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
51651>>>>>>>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
51652>>>>>>>>>>>>>>>>>
51652>>>>>>>>>>>>>>>>>        // Child (Client) file structure................
51652>>>>>>>>>>>>>>>>>        Send Add_Client_File  Witemcld.File_Number
51653>>>>>>>>>>>>>>>>>
51653>>>>>>>>>>>>>>>>>        // Parent (Server) file structure...............
51653>>>>>>>>>>>>>>>>>        Send Add_Server_File  Item.File_Number
51654>>>>>>>>>>>>>>>>>
51654>>>>>>>>>>>>>>>>>        // External (System) file structure.............
51654>>>>>>>>>>>>>>>>>        Send Add_System_File  Sysrecw.File_Number  DD_LOCK_ON_ALL
51655>>>>>>>>>>>>>>>>>
51655>>>>>>>>>>>>>>>>>        Define_Auto_Increment  Sysrecw.Witemcl_Rec0  To Witemcl.Rec0
51658>>>>>>>>>>>>>>>>>
51658>>>>>>>>>>>>>>>>>        // Field-based properties.......................
51658>>>>>>>>>>>>>>>>>
51658>>>>>>>>>>>>>>>>>        // Witemcl.Item_Code
51658>>>>>>>>>>>>>>>>>
51658>>>>>>>>>>>>>>>>>        // Witemcl.Client_Code
51658>>>>>>>>>>>>>>>>>        Set Field_Prompt_Object    Field Witemcl.Client_Code To (SL100(Self))
51659>>>>>>>>>>>>>>>>>
51659>>>>>>>>>>>>>>>>>        // Witemcl.Client_Itemcode
51659>>>>>>>>>>>>>>>>>
51659>>>>>>>>>>>>>>>>>        // Witemcl.Client_Date
51659>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Date To MASK_DATE_WINDOW
51660>>>>>>>>>>>>>>>>>
51660>>>>>>>>>>>>>>>>>        // Witemcl.Client_Price
51660>>>>>>>>>>>>>>>>>        Set Field_Mask_Type        Field Witemcl.Client_Price To MASK_NUMERIC_WINDOW
51661>>>>>>>>>>>>>>>>>
51661>>>>>>>>>>>>>>>>>        // Witemcl.Item_Descr
51661>>>>>>>>>>>>>>>>>
51661>>>>>>>>>>>>>>>>>        // Witemcl.Rec0
51661>>>>>>>>>>>>>>>>>
51661>>>>>>>>>>>>>>>>>        // Witemcl.Is_Client
51661>>>>>>>>>>>>>>>>>
51661>>>>>>>>>>>>>>>>>        //DDB-DefineFieldEnd
51661>>>>>>>>>>>>>>>>>    End_Procedure    // Define_Fields
51662>>>>>>>>>>>>>>>>>
51662>>>>>>>>>>>>>>>>>    // Field_Defaults:
51662>>>>>>>>>>>>>>>>>    // This procedure is used to establish default field values.
51662>>>>>>>>>>>>>>>>>
51662>>>>>>>>>>>>>>>>>    Procedure Field_Defaults
51663>>>>>>>>>>>>>>>>>        Forward Send Field_Defaults
51665>>>>>>>>>>>>>>>>>        //DDB-Generated-Code-Location
51665>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultStart
51665>>>>>>>>>>>>>>>>>        //DDB-FieldDefaultEnd
51665>>>>>>>>>>>>>>>>>    End_Procedure    // Field_Defaults
51666>>>>>>>>>>>>>>>>>
51666>>>>>>>>>>>>>>>>>End_Class    // Witemcl_DataDictionary
51667>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-Start
51667>>>>>>>>>>>>>>>>>
51667>>>>>>>>>>>>>>>>>Use sl100.sl         // SL100
51667>>>>>>>>>>>>>>>>>
51667>>>>>>>>>>>>>>>>>//DDB-Selection-pkg-End
51667>>>>>>>>>>>>>>>>>//DDB-FileEnd
51667>>>>>>>>>>>>>>>    
51667>>>>>>>>>>>>>>>    //AB-IgnoreEnd
51667>>>>>>>>>>>>>>>
51667>>>>>>>>>>>>>>>    Object dg186 is a dbModalPanelSub
51669>>>>>>>>>>>>>>>
51669>>>>>>>>>>>>>>>        //AB-StoreTopStart
51669>>>>>>>>>>>>>>>        Function fsclient string code Returns string
51671>>>>>>>>>>>>>>>            string name
51672>>>>>>>>>>>>>>>            clear clients
51673>>>>>>>>>>>>>>>            move code to clients.client_id
51674>>>>>>>>>>>>>>>            find eq clients by index.6
51675>>>>>>>>>>>>>>>>
51675>>>>>>>>>>>>>>>            move clients.client_name to name
51676>>>>>>>>>>>>>>>            function_return name
51677>>>>>>>>>>>>>>>        end_Function
51678>>>>>>>>>>>>>>>        
51678>>>>>>>>>>>>>>>        Property String     pscode                  ''
51680>>>>>>>>>>>>>>>        Property String     psperi                  ''
51682>>>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
51684>>>>>>>>>>>>>>>        Property String     pscodeprom              ''
51686>>>>>>>>>>>>>>>        
51686>>>>>>>>>>>>>>>        
51686>>>>>>>>>>>>>>>        //AB-StoreTopEnd
51686>>>>>>>>>>>>>>>
51686>>>>>>>>>>>>>>>        Set Label to "‘¬©®œ«å©œ ª „ ›é¤ €§¦Ÿã¡žª"
51687>>>>>>>>>>>>>>>        Set Size to 289 527
51688>>>>>>>>>>>>>>>        Set Location to 0 2
51689>>>>>>>>>>>>>>>
51689>>>>>>>>>>>>>>>        //AB-DDOStart
51689>>>>>>>>>>>>>>>
51689>>>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51691>>>>>>>>>>>>>>>        End_Object    // Witemkat_DD
51692>>>>>>>>>>>>>>>
51692>>>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
51694>>>>>>>>>>>>>>>        End_Object    // Units_DD
51695>>>>>>>>>>>>>>>
51695>>>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
51697>>>>>>>>>>>>>>>        End_Object    // Fpa_DD
51698>>>>>>>>>>>>>>>
51698>>>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
51700>>>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
51701>>>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
51702>>>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
51703>>>>>>>>>>>>>>>        End_Object    // Item_DD
51704>>>>>>>>>>>>>>>
51704>>>>>>>>>>>>>>>        Object Witemcl_DD is a Witemcl_DataDictionary
51706>>>>>>>>>>>>>>>
51706>>>>>>>>>>>>>>>            //AB-StoreTopStart
51706>>>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
51708>>>>>>>>>>>>>>>                       String lsperi lscode  lscodeprom
51709>>>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
51709>>>>>>>>>>>>>>>                       Move 0 to rVal
51710>>>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
51711>>>>>>>>>>>>>>>                       Get psperi to lsperi
51712>>>>>>>>>>>>>>>                       Get pscode to lscode
51713>>>>>>>>>>>>>>>                       Get pscodeprom to lscodeprom
51714>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51715>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51716>>>>>>>>>>>>>>>                  //     Move (Trim(lscodekat)) to lscodekat
51716>>>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
51718>>>>>>>>>>>>>>>                           If ((Trim(witemcl.item_descr)) Contains lsperi) Begin
51720>>>>>>>>>>>>>>>                               If ((Trim(witemcl.item_code)) Contains lscode) Move 1 to rVal
51723>>>>>>>>>>>>>>>                           End
51723>>>>>>>>>>>>>>>>
51723>>>>>>>>>>>>>>>            
51723>>>>>>>>>>>>>>>                       End
51723>>>>>>>>>>>>>>>>
51723>>>>>>>>>>>>>>>                       Else Begin
51724>>>>>>>>>>>>>>>                           If (Left(witemcl.item_descr,(Length(lsperi)))=lsperi) Begin
51726>>>>>>>>>>>>>>>                               If (Left(witemcl.item_code,(Length(lscode)))=lscode) Move 1 to rVal
51729>>>>>>>>>>>>>>>                           End
51729>>>>>>>>>>>>>>>>
51729>>>>>>>>>>>>>>>            
51729>>>>>>>>>>>>>>>                       End
51729>>>>>>>>>>>>>>>>
51729>>>>>>>>>>>>>>>                       Function_Return rVal
51730>>>>>>>>>>>>>>>                   End_Function
51731>>>>>>>>>>>>>>>            
51731>>>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
51733>>>>>>>>>>>>>>>                       String lsperi
51734>>>>>>>>>>>>>>>                       Get psperi to lsperi
51735>>>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51736>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_descr,(Length(lsperi)))=lsperi)
51737>>>>>>>>>>>>>>>                   End_Function
51738>>>>>>>>>>>>>>>            
51738>>>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
51740>>>>>>>>>>>>>>>                       String lscode lscodeprom
51741>>>>>>>>>>>>>>>                       Get pscode to lscode
51742>>>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51743>>>>>>>>>>>>>>>                       Function_Return (Left(witemcl.item_code,(Length(lscode)))=lscode)
51744>>>>>>>>>>>>>>>                   End_Function
51745>>>>>>>>>>>>>>>            
51745>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51745>>>>>>>>>>>>>>>
51745>>>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
51746>>>>>>>>>>>>>>>
51746>>>>>>>>>>>>>>>            //AB-StoreStart
51746>>>>>>>>>>>>>>>                                                                
51746>>>>>>>>>>>>>>>                                                                
51746>>>>>>>>>>>>>>>            Begin_Constraints
51748>>>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodeprom
51749>>>>>>>>>>>>>>>               Integer liContains_Or_Starts
51749>>>>>>>>>>>>>>>                   Get psperi  to lsperi
51750>>>>>>>>>>>>>>>                   Get pscode  to lscode
51751>>>>>>>>>>>>>>>                   Get pscodeprom  to lscodeprom
51752>>>>>>>>>>>>>>>                   Get piContains_Or_Starts to liContains_Or_Starts
51753>>>>>>>>>>>>>>>                   Move (Trim(lsperi)) to lsperi
51754>>>>>>>>>>>>>>>                   Move (Trim(lscode)) to lscode
51755>>>>>>>>>>>>>>>                   Move (Trim(lscodeprom)) to lscodeprom
51756>>>>>>>>>>>>>>>                   If ((lsperi<>'') and ;                      (lscode<>'')) Constrain witemcl as (fiPeriexei(Self)=1)
51759>>>>>>>>>>>>>>>                   Else Begin
51760>>>>>>>>>>>>>>>                      If (liContains_Or_Starts=0) Begin
51762>>>>>>>>>>>>>>>                      If (lsperi<>'') Constrain witemcl.item_descr Contains lsperi
51766>>>>>>>>>>>>>>>                      Else If (lscode<>'') Constrain witemcl.item_code Contains lscode
51771>>>>>>>>>>>>>>>                      End
51771>>>>>>>>>>>>>>>>
51771>>>>>>>>>>>>>>>                   Else Begin
51772>>>>>>>>>>>>>>>                       If (lsperi<>'') Constrain witemcl as (fiArxizeiperi(Self)=1) //witemcl.item_descr
51775>>>>>>>>>>>>>>>                       Else If (lscode<>'') Constrain witemcl as (fiArxizeicode(Self)=1) //witemcl.item_code
51779>>>>>>>>>>>>>>>                       End
51779>>>>>>>>>>>>>>>>
51779>>>>>>>>>>>>>>>                   End
51779>>>>>>>>>>>>>>>>
51779>>>>>>>>>>>>>>>                   If (lscodeprom<>'') Constrain witemcl.client_itemcode Contains lscodeprom
51783>>>>>>>>>>>>>>>            
51783>>>>>>>>>>>>>>>            End_Constraints
51786>>>>>>>>>>>>>>>            
51786>>>>>>>>>>>>>>>            
51786>>>>>>>>>>>>>>>            //AB-StoreEnd
51786>>>>>>>>>>>>>>>
51786>>>>>>>>>>>>>>>        End_Object    // Witemcl_DD
51787>>>>>>>>>>>>>>>
51787>>>>>>>>>>>>>>>        Set Main_DD to (Witemcl_DD(self))
51788>>>>>>>>>>>>>>>        Set Server to (Witemcl_DD(self))
51789>>>>>>>>>>>>>>>
51789>>>>>>>>>>>>>>>        //AB-DDOEnd
51789>>>>>>>>>>>>>>>
51789>>>>>>>>>>>>>>>        Object The_Table is a dbGrid
51791>>>>>>>>>>>>>>>            Set Main_File to Witemcl.File_Number
51792>>>>>>>>>>>>>>>            Set Size to 201 519
51793>>>>>>>>>>>>>>>            Set Location to 3 2
51794>>>>>>>>>>>>>>>            Set Color to 14280447
51795>>>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
51796>>>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
51797>>>>>>>>>>>>>>>            Set Wrap_State to TRUE
51798>>>>>>>>>>>>>>>
51798>>>>>>>>>>>>>>>            Begin_Row
51801>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_code
51802>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_itemcode
51803>>>>>>>>>>>>>>>                Entry_Item Witemcl.Item_descr
51804>>>>>>>>>>>>>>>                Entry_Item Witemcl.Client_code
51805>>>>>>>>>>>>>>>                Entry_Item (fsclient(self,witemcl.client_code))
51806>>>>>>>>>>>>>>>            End_Row
51811>>>>>>>>>>>>>>>
51811>>>>>>>>>>>>>>>            Set Form_Width    item 0 to 100
51812>>>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª „å›¦¬ª"
51813>>>>>>>>>>>>>>>            
51813>>>>>>>>>>>>>>>            Set Form_Width    item 1 to 100
51814>>>>>>>>>>>>>>>            Set Header_Label  item 1 to "„å›¦ª ¨¦£žŸœ¬«ã"
51815>>>>>>>>>>>>>>>            
51815>>>>>>>>>>>>>>>            Set Form_Width    item 2 to 200
51816>>>>>>>>>>>>>>>            Set Header_Label  item 2 to "œ¨ š¨˜­ã „å›¦¬ª"
51817>>>>>>>>>>>>>>>            
51817>>>>>>>>>>>>>>>            Set Form_Width    item 3 to 0
51818>>>>>>>>>>>>>>>            Set Header_Label  item 3 to ""
51819>>>>>>>>>>>>>>>            
51819>>>>>>>>>>>>>>>            Set Form_Width    item 4 to 111
51820>>>>>>>>>>>>>>>            Set Header_Label  item 4 to "¨¦£žŸœ¬«ãª"
51821>>>>>>>>>>>>>>>            
51821>>>>>>>>>>>>>>>
51821>>>>>>>>>>>>>>>            //AB-StoreStart
51821>>>>>>>>>>>>>>>            Set Column_Option Item 3 to NoEnter True
51822>>>>>>>>>>>>>>>            //set read_only_state to true
51822>>>>>>>>>>>>>>>            set no_create_state to true
51823>>>>>>>>>>>>>>>            set no_delete_state to true
51824>>>>>>>>>>>>>>>            //AB-StoreEnd
51824>>>>>>>>>>>>>>>
51824>>>>>>>>>>>>>>>        End_Object    // The_Table
51825>>>>>>>>>>>>>>>
51825>>>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
51827>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ‰à› ¡¦ç ‚ á"
51828>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51829>>>>>>>>>>>>>>>            Set Location to 208 5
51830>>>>>>>>>>>>>>>            Set Size to 13 78
51831>>>>>>>>>>>>>>>        End_Object    // TextBoxSub1
51832>>>>>>>>>>>>>>>
51832>>>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
51834>>>>>>>>>>>>>>>            Set Label to "‘á¨à©ž œ¨ š¨˜­ãª "
51835>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51836>>>>>>>>>>>>>>>            Set Location to 223 5
51837>>>>>>>>>>>>>>>            Set Size to 13 83
51838>>>>>>>>>>>>>>>        End_Object    // TextBoxSub2
51839>>>>>>>>>>>>>>>
51839>>>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
51841>>>>>>>>>>>>>>>            Set Label to "„å›¦ª ¨¦£žŸœ¬«ã ‚ á"
51842>>>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
51843>>>>>>>>>>>>>>>            Set Location to 237 5
51844>>>>>>>>>>>>>>>            Set Size to 13 78
51845>>>>>>>>>>>>>>>        End_Object    // TextBoxSub3
51846>>>>>>>>>>>>>>>
51846>>>>>>>>>>>>>>>        Object ocode is a FormSub
51848>>>>>>>>>>>>>>>            Set Size to 13 197
51849>>>>>>>>>>>>>>>            Set Location to 209 91
51850>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51851>>>>>>>>>>>>>>>
51851>>>>>>>>>>>>>>>            //AB-StoreStart
51851>>>>>>>>>>>>>>>                                                                                                                                                                                                    
51851>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51853>>>>>>>>>>>>>>>               Send KeyAction to ButtonSub1
51854>>>>>>>>>>>>>>>            End_Procedure
51855>>>>>>>>>>>>>>>            
51855>>>>>>>>>>>>>>>            
51855>>>>>>>>>>>>>>>            
51855>>>>>>>>>>>>>>>            
51855>>>>>>>>>>>>>>>            //AB-StoreEnd
51855>>>>>>>>>>>>>>>
51855>>>>>>>>>>>>>>>        End_Object    // ocode
51856>>>>>>>>>>>>>>>
51856>>>>>>>>>>>>>>>        Object operi is a FormSub
51858>>>>>>>>>>>>>>>            Set Size to 13 197
51859>>>>>>>>>>>>>>>            Set Location to 223 91
51860>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51861>>>>>>>>>>>>>>>
51861>>>>>>>>>>>>>>>            //AB-StoreStart
51861>>>>>>>>>>>>>>>                                                                                                                                                                                                    
51861>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51863>>>>>>>>>>>>>>>              Send KeyAction to ButtonSub1
51864>>>>>>>>>>>>>>>            End_Procedure
51865>>>>>>>>>>>>>>>            
51865>>>>>>>>>>>>>>>            
51865>>>>>>>>>>>>>>>            
51865>>>>>>>>>>>>>>>            
51865>>>>>>>>>>>>>>>            //AB-StoreEnd
51865>>>>>>>>>>>>>>>
51865>>>>>>>>>>>>>>>        End_Object    // operi
51866>>>>>>>>>>>>>>>
51866>>>>>>>>>>>>>>>        Object ocodeprom is a FormSub
51868>>>>>>>>>>>>>>>            Set Size to 13 197
51869>>>>>>>>>>>>>>>            Set Location to 238 91
51870>>>>>>>>>>>>>>>            Set Label_Col_Offset to 2
51871>>>>>>>>>>>>>>>
51871>>>>>>>>>>>>>>>            //AB-StoreStart
51871>>>>>>>>>>>>>>>                                                                                                                                                                                                    
51871>>>>>>>>>>>>>>>            Procedure OnKILLFOCUS
51873>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51874>>>>>>>>>>>>>>>            End_Procedure
51875>>>>>>>>>>>>>>>            
51875>>>>>>>>>>>>>>>            
51875>>>>>>>>>>>>>>>            
51875>>>>>>>>>>>>>>>            //AB-StoreEnd
51875>>>>>>>>>>>>>>>
51875>>>>>>>>>>>>>>>        End_Object    // ocodeprom
51876>>>>>>>>>>>>>>>
51876>>>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
51878>>>>>>>>>>>>>>>            Set Size to 32 77
51879>>>>>>>>>>>>>>>            Set Location to 209 296
51880>>>>>>>>>>>>>>>            Object Radio1 is a RadioSub
51882>>>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
51883>>>>>>>>>>>>>>>                Set Size to 10 53
51884>>>>>>>>>>>>>>>                Set Location to 7 5
51885>>>>>>>>>>>>>>>            End_Object    // Radio1
51886>>>>>>>>>>>>>>>
51886>>>>>>>>>>>>>>>            Object Radio2 is a RadioSub
51888>>>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§æ"
51889>>>>>>>>>>>>>>>                Set Size to 10 51
51890>>>>>>>>>>>>>>>                Set Location to 21 5
51891>>>>>>>>>>>>>>>            End_Object    // Radio2
51892>>>>>>>>>>>>>>>
51892>>>>>>>>>>>>>>>
51892>>>>>>>>>>>>>>>            //AB-StoreStart
51892>>>>>>>>>>>>>>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
51892>>>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
51894>>>>>>>>>>>>>>>                //iToItem=0 => Contains, =1 => Starts with
51894>>>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
51895>>>>>>>>>>>>>>>                Send KeyAction to ButtonSub1
51896>>>>>>>>>>>>>>>            End_Procedure
51897>>>>>>>>>>>>>>>            
51897>>>>>>>>>>>>>>>            // If you set Current_radio you must set this after the
51897>>>>>>>>>>>>>>>            // radio objects have been created AND after Notify_select_State has been
51897>>>>>>>>>>>>>>>            // created. i.e. Set in bottom-code at end!!
51897>>>>>>>>>>>>>>>            //Set Current_Radio to 0
51897>>>>>>>>>>>>>>>            
51897>>>>>>>>>>>>>>>            
51897>>>>>>>>>>>>>>>            //AB-StoreEnd
51897>>>>>>>>>>>>>>>
51897>>>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
51898>>>>>>>>>>>>>>>
51898>>>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
51900>>>>>>>>>>>>>>>            Set Label to "Search"
51901>>>>>>>>>>>>>>>            Set Size to 28 37
51902>>>>>>>>>>>>>>>            Set Location to 210 413
51903>>>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
51904>>>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
51905>>>>>>>>>>>>>>>
51905>>>>>>>>>>>>>>>            //AB-StoreStart
51905>>>>>>>>>>>>>>>                                        
51905>>>>>>>>>>>>>>>            Set Visible_State to False
51906>>>>>>>>>>>>>>>            
51906>>>>>>>>>>>>>>>            Procedure OnClick
51908>>>>>>>>>>>>>>>                Forward Send OnClick
51910>>>>>>>>>>>>>>>                Set pscode  to (Value(ocode(Self),0))
51911>>>>>>>>>>>>>>>                Set psperi  to (Value(operi(Self),0))
51912>>>>>>>>>>>>>>>                Set pscodeprom  to (Value(ocodeprom(Self),0))
51913>>>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemcl_DD(Self))
51914>>>>>>>>>>>>>>>                Send Beginning_Of_Data      to the_table
51915>>>>>>>>>>>>>>>            End_Procedure // OnClick
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            
51916>>>>>>>>>>>>>>>            //AB-StoreEnd
51916>>>>>>>>>>>>>>>
51916>>>>>>>>>>>>>>>        End_Object    // ButtonSub1
51917>>>>>>>>>>>>>>>
51917>>>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
51919>>>>>>>>>>>>>>>
51919>>>>>>>>>>>>>>>            //AB-StoreTopStart
51919>>>>>>>>>>>>>>>                                                                                    
51919>>>>>>>>>>>>>>>            //AB-StoreTopEnd
51919>>>>>>>>>>>>>>>
51919>>>>>>>>>>>>>>>            Set Label to "ButtonSub1"
51920>>>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
51921>>>>>>>>>>>>>>>            Set Size to 22 25
51922>>>>>>>>>>>>>>>            Set Location to 214 482
51923>>>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
51924>>>>>>>>>>>>>>>
51924>>>>>>>>>>>>>>>            //AB-StoreStart
51924>>>>>>>>>>>>>>>                                                                                    
51924>>>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤"
51925>>>>>>>>>>>>>>>            
51925>>>>>>>>>>>>>>>            Procedure OnClick
51927>>>>>>>>>>>>>>>                String  scode speri
51928>>>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
51929>>>>>>>>>>>>>>>                Get value of (operi(self)) to speri
51930>>>>>>>>>>>>>>>                set pscode of (sl17(self)) to scode
51931>>>>>>>>>>>>>>>                set psperi of (sl17(self)) to speri
51932>>>>>>>>>>>>>>>                send request_cancel to dg186
51933>>>>>>>>>>>>>>>            End_Procedure // OnClick
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            
51934>>>>>>>>>>>>>>>            //AB-StoreEnd
51934>>>>>>>>>>>>>>>
51934>>>>>>>>>>>>>>>        End_Object    // btnwitemcl
51935>>>>>>>>>>>>>>>
51935>>>>>>>>>>>>>>>
51935>>>>>>>>>>>>>>>        //AB-StoreStart
51935>>>>>>>>>>>>>>>        Procedure Activating
51937>>>>>>>>>>>>>>>           integer rval
51938>>>>>>>>>>>>>>>           set value of (ocode(self)) to (pscode(self))
51939>>>>>>>>>>>>>>>           set value of (operi(self)) to (psperi(self))
51940>>>>>>>>>>>>>>>           Send Rebuild_Constraints to (witemcl_DD(Self))
51941>>>>>>>>>>>>>>>           Forward send Activating
51943>>>>>>>>>>>>>>>        
51943>>>>>>>>>>>>>>>        End_Procedure
51944>>>>>>>>>>>>>>>        
51944>>>>>>>>>>>>>>>        
51944>>>>>>>>>>>>>>>        
51944>>>>>>>>>>>>>>>        
51944>>>>>>>>>>>>>>>        
51944>>>>>>>>>>>>>>>        
51944>>>>>>>>>>>>>>>        //AB-StoreEnd
51944>>>>>>>>>>>>>>>
51944>>>>>>>>>>>>>>>    End_Object    // dg186
51945>>>>>>>>>>>>>>>
51945>>>>>>>>>>>>>>>
51945>>>>>>>>>>>>>>>    //AB-StoreStart
51945>>>>>>>>>>>>>>>        
51945>>>>>>>>>>>>>>>    //AB-StoreEnd
51945>>>>>>>>>>>>>>>
51945>>>>>>>>>>>>>>>//AB/     End_Object    // prj
51945>>>>>>>>>>>>>    //AB-StoreTopEnd
51945>>>>>>>>>>>>>
51945>>>>>>>>>>>>>    //AB-IgnoreStart
51945>>>>>>>>>>>>>
51945>>>>>>>>>>>>>    Use DFAllEnt.pkg
51945>>>>>>>>>>>>>    Use dbList.Sub
51945>>>>>>>>>>>>>    Use Txtbox.Sub
51945>>>>>>>>>>>>>    Use Form.Sub
51945>>>>>>>>>>>>>    Use Rgroup.Sub
51945>>>>>>>>>>>>>    Use Radio.Sub
51945>>>>>>>>>>>>>    Use Button.Sub
51945>>>>>>>>>>>>>
51945>>>>>>>>>>>>>
51945>>>>>>>>>>>>>    Use UNITS.DD
51945>>>>>>>>>>>>>    Use WITEMKAT.DD
51945>>>>>>>>>>>>>    Use FPA.DD
51945>>>>>>>>>>>>>    Use ITEM.DD
51945>>>>>>>>>>>>>    Use WITEMX.DD
51945>>>>>>>>>>>>>    
51945>>>>>>>>>>>>>    //AB-IgnoreEnd
51945>>>>>>>>>>>>>
51945>>>>>>>>>>>>>    Object SL17 is a dbModalPanelSub
51947>>>>>>>>>>>>>
51947>>>>>>>>>>>>>        //AB-StoreTopStart
51947>>>>>>>>>>>>>                
51947>>>>>>>>>>>>>        Property String     pscode                  ''
51949>>>>>>>>>>>>>        Property String     psperi                  ''
51951>>>>>>>>>>>>>        Property Integer    piContains_Or_Starts     0
51953>>>>>>>>>>>>>        Property String     pscodekat               ''
51955>>>>>>>>>>>>>        
51955>>>>>>>>>>>>>        //AB-StoreTopEnd
51955>>>>>>>>>>>>>
51955>>>>>>>>>>>>>        Set Minimize_Icon to FALSE
51956>>>>>>>>>>>>>        Set Label to "„¬¨œ«ã¨ ¦ €¨®œå¦¬ „ ›é¤"
51957>>>>>>>>>>>>>        Set Size to 266 484
51958>>>>>>>>>>>>>        Set Location to 9 14
51959>>>>>>>>>>>>>        Set Exit_Application_Local_State to FALSE
51960>>>>>>>>>>>>>        Set Modal_State to FALSE
51961>>>>>>>>>>>>>
51961>>>>>>>>>>>>>        //AB-DDOStart
51961>>>>>>>>>>>>>
51961>>>>>>>>>>>>>        Object Units_DD is a Units_DataDictionary
51963>>>>>>>>>>>>>        End_Object    // Units_DD
51964>>>>>>>>>>>>>
51964>>>>>>>>>>>>>        Object Witemkat_DD is a Witemkat_DataDictionary
51966>>>>>>>>>>>>>        End_Object    // Witemkat_DD
51967>>>>>>>>>>>>>
51967>>>>>>>>>>>>>        Object Fpa_DD is a Fpa_DataDictionary
51969>>>>>>>>>>>>>        End_Object    // Fpa_DD
51970>>>>>>>>>>>>>
51970>>>>>>>>>>>>>        Object Item_DD is a Item_DataDictionary
51972>>>>>>>>>>>>>
51972>>>>>>>>>>>>>            //AB-StoreTopStart
51972>>>>>>>>>>>>>                                                                                                    
51972>>>>>>>>>>>>>                                                                                                    
51972>>>>>>>>>>>>>            //AB-StoreTopEnd
51972>>>>>>>>>>>>>
51972>>>>>>>>>>>>>            Set DDO_Server to (Units_DD(self))
51973>>>>>>>>>>>>>            Set DDO_Server to (Witemkat_DD(self))
51974>>>>>>>>>>>>>            Set DDO_Server to (Fpa_DD(self))
51975>>>>>>>>>>>>>
51975>>>>>>>>>>>>>            //AB-StoreStart
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>                                                                                                    
51975>>>>>>>>>>>>>            //AB-StoreEnd
51975>>>>>>>>>>>>>
51975>>>>>>>>>>>>>        End_Object    // Item_DD
51976>>>>>>>>>>>>>
51976>>>>>>>>>>>>>        Object Witemx_DD is a Witemx_DataDictionary
51978>>>>>>>>>>>>>
51978>>>>>>>>>>>>>            //AB-StoreTopStart
51978>>>>>>>>>>>>>            Function fiPeriexei Returns Integer
51980>>>>>>>>>>>>>                       String lsperi lscode  lscodekat
51981>>>>>>>>>>>>>                       Integer rVal liContains_Or_Starts
51981>>>>>>>>>>>>>                       Move 0 to rVal
51982>>>>>>>>>>>>>                       Get piContains_Or_Starts to liContains_Or_Starts
51983>>>>>>>>>>>>>                       Get psperi to lsperi
51984>>>>>>>>>>>>>                       Get pscode to lscode
51985>>>>>>>>>>>>>                       Get pscodekat to lscodekat
51986>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
51987>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
51988>>>>>>>>>>>>>                       If (liContains_Or_Starts=0) Begin
51990>>>>>>>>>>>>>                           If ((Trim(witemx.witemx_descr)) Contains lsperi) Begin
51992>>>>>>>>>>>>>                               If ((Trim(witemx.witemx_code)) Contains lscode) Move 1 to rVal
51995>>>>>>>>>>>>>                           End
51995>>>>>>>>>>>>>>
51995>>>>>>>>>>>>>                       End
51995>>>>>>>>>>>>>>
51995>>>>>>>>>>>>>                       Else Begin
51996>>>>>>>>>>>>>                           If (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi) Begin
51998>>>>>>>>>>>>>                               If (Left(witemx.witemx_code,(Length(lscode)))=lscode) Move 1 to rVal
52001>>>>>>>>>>>>>                           End
52001>>>>>>>>>>>>>>
52001>>>>>>>>>>>>>                       End
52001>>>>>>>>>>>>>>
52001>>>>>>>>>>>>>                       Function_Return rVal
52002>>>>>>>>>>>>>                   End_Function
52003>>>>>>>>>>>>>            
52003>>>>>>>>>>>>>                   Function fiArxizeiperi Returns Integer
52005>>>>>>>>>>>>>                       String lsperi
52006>>>>>>>>>>>>>                       Get psperi to lsperi
52007>>>>>>>>>>>>>                       Move (Trim(lsperi)) to lsperi
52008>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_descr,(Length(lsperi)))=lsperi)
52009>>>>>>>>>>>>>                   End_Function
52010>>>>>>>>>>>>>            
52010>>>>>>>>>>>>>                   Function fiArxizeicode Returns Integer
52012>>>>>>>>>>>>>                       String lscode lscodekat
52013>>>>>>>>>>>>>                       Get pscode to lscode
52014>>>>>>>>>>>>>                       Move (Trim(lscode)) to lscode
52015>>>>>>>>>>>>>                       Function_Return (Left(witemx.witemx_code,(Length(lscode)))=lscode)
52016>>>>>>>>>>>>>                   End_Function
52017>>>>>>>>>>>>>            //AB-StoreTopEnd
52017>>>>>>>>>>>>>
52017>>>>>>>>>>>>>            Set DDO_Server to (Item_DD(self))
52018>>>>>>>>>>>>>
52018>>>>>>>>>>>>>            //AB-StoreStart
52018>>>>>>>>>>>>>                                                                                
52018>>>>>>>>>>>>>            Begin_Constraints
52020>>>>>>>>>>>>>               String lsperi lscode lsvalue lstype lscodekat
52021>>>>>>>>>>>>>               Integer liContains_Or_Starts
52021>>>>>>>>>>>>>               Get psperi               to lsperi
52022>>>>>>>>>>>>>               Get pscode               to lscode
52023>>>>>>>>>>>>>               Get pscodekat            to lscodekat
52024>>>>>>>>>>>>>               Get piContains_Or_Starts to liContains_Or_Starts
52025>>>>>>>>>>>>>               Move (Trim(lsperi))      to lsperi
52026>>>>>>>>>>>>>               Move (Trim(lscode))      to lscode
52027>>>>>>>>>>>>>               Move (Trim(lscodekat))   to lscodekat
52028>>>>>>>>>>>>>               Set Ordering to 4
52029>>>>>>>>>>>>>               If ((lsperi<>'') and (lscode<>'')) Begin
52031>>>>>>>>>>>>>                    Set Ordering to 4
52032>>>>>>>>>>>>>                    Constrain witemx as (fiPeriexei(Self)=1)
52033>>>>>>>>>>>>>               End
52033>>>>>>>>>>>>>>
52033>>>>>>>>>>>>>               Else Begin
52034>>>>>>>>>>>>>                  If (liContains_Or_Starts=0) Begin
52036>>>>>>>>>>>>>                        If (lsperi<>'') Begin
52038>>>>>>>>>>>>>                            Set Ordering to 3
52039>>>>>>>>>>>>>                            Constrain witemx.witemx_descr Contains lsperi
52041>>>>>>>>>>>>>                        End
52041>>>>>>>>>>>>>>
52041>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
52044>>>>>>>>>>>>>                            Set Ordering to 4
52045>>>>>>>>>>>>>                            Constrain witemx.witemx_code Contains lscode
52047>>>>>>>>>>>>>                        End
52047>>>>>>>>>>>>>>
52047>>>>>>>>>>>>>                  End
52047>>>>>>>>>>>>>>
52047>>>>>>>>>>>>>                  Else Begin
52048>>>>>>>>>>>>>                        If (lsperi<>'') Begin
52050>>>>>>>>>>>>>                            Set Ordering to 3
52051>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeiperi(Self)=1) //witemx.witemx_descr
52052>>>>>>>>>>>>>                        End
52052>>>>>>>>>>>>>>
52052>>>>>>>>>>>>>                        Else If (lscode<>'') Begin
52055>>>>>>>>>>>>>                            Set Ordering to 4
52056>>>>>>>>>>>>>                            Constrain witemx as (fiArxizeicode(Self)=1) //witemx.witemx_code
52057>>>>>>>>>>>>>                        End
52057>>>>>>>>>>>>>>
52057>>>>>>>>>>>>>                  End
52057>>>>>>>>>>>>>>
52057>>>>>>>>>>>>>                  If (lscodekat<>'') Begin
52059>>>>>>>>>>>>>                        Constrain witemx.witemkat_code Contains lscodekat
52061>>>>>>>>>>>>>                  End
52061>>>>>>>>>>>>>>
52061>>>>>>>>>>>>>               End
52061>>>>>>>>>>>>>>
52061>>>>>>>>>>>>>            End_Constraints
52064>>>>>>>>>>>>>            
52064>>>>>>>>>>>>>            
52064>>>>>>>>>>>>>            //AB-StoreEnd
52064>>>>>>>>>>>>>
52064>>>>>>>>>>>>>        End_Object    // Witemx_DD
52065>>>>>>>>>>>>>
52065>>>>>>>>>>>>>        Set Main_DD to (Witemx_DD(self))
52066>>>>>>>>>>>>>        Set Server to (Witemx_DD(self))
52067>>>>>>>>>>>>>
52067>>>>>>>>>>>>>        //AB-DDOEnd
52067>>>>>>>>>>>>>
52067>>>>>>>>>>>>>        Object oSelList is a dbListSub
52069>>>>>>>>>>>>>            Set Main_File to Witemx.File_Number
52070>>>>>>>>>>>>>            Set Ordering to 5
52071>>>>>>>>>>>>>            Set Size to 190 475
52072>>>>>>>>>>>>>            Set Location to 1 1
52073>>>>>>>>>>>>>            Set Color to 14280447
52074>>>>>>>>>>>>>            Set CurrentRowColor to 11783679
52075>>>>>>>>>>>>>            Set CurrentCellColor to 11783679
52076>>>>>>>>>>>>>            Set Auto_Index_State to FALSE
52077>>>>>>>>>>>>>
52077>>>>>>>>>>>>>            Begin_Row
52080>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_code
52081>>>>>>>>>>>>>                Entry_Item Witemx.Witemx_descr
52082>>>>>>>>>>>>>                Entry_Item Witemx.Witemkat_code
52083>>>>>>>>>>>>>                Entry_Item Witemkat.Witemkat_descr
52084>>>>>>>>>>>>>                Entry_Item Item.Item_qual
52085>>>>>>>>>>>>>                Entry_Item Fpa.Fpa_pososto
52086>>>>>>>>>>>>>            End_Row
52091>>>>>>>>>>>>>
52091>>>>>>>>>>>>>            Set Form_Width    item 0 to 60
52092>>>>>>>>>>>>>            Set Header_Label  item 0 to "‰à›. „å›¦¬ª"
52093>>>>>>>>>>>>>            
52093>>>>>>>>>>>>>            Set Form_Width    item 1 to 140
52094>>>>>>>>>>>>>            Set Header_Label  item 1 to "œ¨ š¨˜­ã"
52095>>>>>>>>>>>>>            
52095>>>>>>>>>>>>>            Set Form_Width    item 2 to 70
52096>>>>>>>>>>>>>            Set Header_Label  item 2 to "‰à›. ‰˜«žš¦¨å˜ª"
52097>>>>>>>>>>>>>            
52097>>>>>>>>>>>>>            Set Form_Width    item 3 to 88
52098>>>>>>>>>>>>>            Set Header_Label  item 3 to "œ¨ š¨˜­ã ‰˜«žš."
52099>>>>>>>>>>>>>            
52099>>>>>>>>>>>>>            Set Form_Width    item 4 to 64
52100>>>>>>>>>>>>>            Set Header_Label  item 4 to "¦ æ«ž«˜"
52101>>>>>>>>>>>>>            
52101>>>>>>>>>>>>>            Set Form_Width    item 5 to 45
52102>>>>>>>>>>>>>            Set Header_Label  item 5 to "‰˜«.”..€"
52103>>>>>>>>>>>>>            
52103>>>>>>>>>>>>>
52103>>>>>>>>>>>>>            //AB-StoreStart
52103>>>>>>>>>>>>>            Property String Store_Fragma_Items public ""
52105>>>>>>>>>>>>>            set export_item_state to true
52106>>>>>>>>>>>>>            
52106>>>>>>>>>>>>>            Procedure End_Construct_Object
52108>>>>>>>>>>>>>                Forward Send End_Construct_Object
52110>>>>>>>>>>>>>                Set Color               to 14280447
52111>>>>>>>>>>>>>                Set CurrentRowColor     to 11783679
52112>>>>>>>>>>>>>                Set CurrentCellColor    to 11783679
52113>>>>>>>>>>>>>            End_Procedure
52114>>>>>>>>>>>>>            
52114>>>>>>>>>>>>>            Procedure Activating Returns Integer
52116>>>>>>>>>>>>>                Integer rVal
52117>>>>>>>>>>>>>                Forward Get Msg_Activating to rVal
52119>>>>>>>>>>>>>                set auto_index_state to true
52120>>>>>>>>>>>>>                Procedure_Return rVal
52121>>>>>>>>>>>>>            End_Procedure
52122>>>>>>>>>>>>>            
52122>>>>>>>>>>>>>            procedure move_value_out
52124>>>>>>>>>>>>>                forward send move_value_out
52126>>>>>>>>>>>>>                set value of (ocode(self)) to ''
52127>>>>>>>>>>>>>                set value of (operi(self)) to ''
52128>>>>>>>>>>>>>                set value of (ocodekat(self)) to ''
52129>>>>>>>>>>>>>                set psperi to ''
52130>>>>>>>>>>>>>                set pscode to ''
52131>>>>>>>>>>>>>                set pscodekat to ''
52132>>>>>>>>>>>>>            end_procedure
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            
52133>>>>>>>>>>>>>            //AB-StoreEnd
52133>>>>>>>>>>>>>
52133>>>>>>>>>>>>>        End_Object    // oSelList
52134>>>>>>>>>>>>>
52134>>>>>>>>>>>>>        Object TextBoxSub1 is a TextBoxSub
52136>>>>>>>>>>>>>            Set Label to "‘á¨à©ž ¡à› ¡¦ç š ˜"
52137>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
52138>>>>>>>>>>>>>            Set Location to 192 6
52139>>>>>>>>>>>>>            Set Size to 13 69
52140>>>>>>>>>>>>>        End_Object    // TextBoxSub1
52141>>>>>>>>>>>>>
52141>>>>>>>>>>>>>        Object ocode is a FormSub
52143>>>>>>>>>>>>>            Set Size to 13 197
52144>>>>>>>>>>>>>            Set Location to 192 79
52145>>>>>>>>>>>>>            Set Label_Col_Offset to 2
52146>>>>>>>>>>>>>
52146>>>>>>>>>>>>>            //AB-StoreStart
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            
52146>>>>>>>>>>>>>            //AB-StoreEnd
52146>>>>>>>>>>>>>
52146>>>>>>>>>>>>>        End_Object    // ocode
52147>>>>>>>>>>>>>
52147>>>>>>>>>>>>>        Object TextBoxSub2 is a TextBoxSub
52149>>>>>>>>>>>>>            Set Label to "‘á¨à©ž §œ¨ š¨˜­ãª "
52150>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
52151>>>>>>>>>>>>>            Set Location to 207 6
52152>>>>>>>>>>>>>            Set Size to 13 71
52153>>>>>>>>>>>>>        End_Object    // TextBoxSub2
52154>>>>>>>>>>>>>
52154>>>>>>>>>>>>>        Object operi is a FormSub
52156>>>>>>>>>>>>>            Set Size to 13 197
52157>>>>>>>>>>>>>            Set Location to 207 79
52158>>>>>>>>>>>>>            Set Label_Col_Offset to 2
52159>>>>>>>>>>>>>
52159>>>>>>>>>>>>>            //AB-StoreStart
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            
52159>>>>>>>>>>>>>            //AB-StoreEnd
52159>>>>>>>>>>>>>
52159>>>>>>>>>>>>>        End_Object    // operi
52160>>>>>>>>>>>>>
52160>>>>>>>>>>>>>        Object RadioGroupSub1 is a RadioGroupSub
52162>>>>>>>>>>>>>            Set Size to 32 77
52163>>>>>>>>>>>>>            Set Location to 191 279
52164>>>>>>>>>>>>>            Object Radio1 is a RadioSub
52166>>>>>>>>>>>>>                Set Label to "œ¨ â®œ«˜ "
52167>>>>>>>>>>>>>                Set Size to 10 53
52168>>>>>>>>>>>>>                Set Location to 7 5
52169>>>>>>>>>>>>>            End_Object    // Radio1
52170>>>>>>>>>>>>>
52170>>>>>>>>>>>>>            Object Radio2 is a RadioSub
52172>>>>>>>>>>>>>                Set Label to "€¨®åœ  €§¦"
52173>>>>>>>>>>>>>                Set Size to 10 52
52174>>>>>>>>>>>>>                Set Location to 21 5
52175>>>>>>>>>>>>>            End_Object    // Radio2
52176>>>>>>>>>>>>>
52176>>>>>>>>>>>>>
52176>>>>>>>>>>>>>            //AB-StoreStart
52176>>>>>>>>>>>>>            
52176>>>>>>>>>>>>>            Procedure Notify_Select_State integer iToItem integer iFromItem
52178>>>>>>>>>>>>>                Set piContains_Or_Starts to iToItem
52179>>>>>>>>>>>>>            End_Procedure
52180>>>>>>>>>>>>>            
52180>>>>>>>>>>>>>            
52180>>>>>>>>>>>>>            
52180>>>>>>>>>>>>>            
52180>>>>>>>>>>>>>            
52180>>>>>>>>>>>>>            //AB-StoreEnd
52180>>>>>>>>>>>>>
52180>>>>>>>>>>>>>        End_Object    // RadioGroupSub1
52181>>>>>>>>>>>>>
52181>>>>>>>>>>>>>        Object ButtonSub1 is a ButtonSub
52183>>>>>>>>>>>>>            Set Label to "œ¨ æ¨ ©œ"
52184>>>>>>>>>>>>>            Set Size to 15 197
52185>>>>>>>>>>>>>            Set Location to 236 79
52186>>>>>>>>>>>>>            Set Form_FontWeight Item 0 to 800
52187>>>>>>>>>>>>>            Set Form_TypeFace Item 0 to "ms sans serif"
52188>>>>>>>>>>>>>
52188>>>>>>>>>>>>>            //AB-StoreStart
52188>>>>>>>>>>>>>            
52188>>>>>>>>>>>>>            Procedure OnClick
52190>>>>>>>>>>>>>                Forward Send OnClick
52192>>>>>>>>>>>>>                Set pscode      to (Value(ocode(Self),0))
52193>>>>>>>>>>>>>                Set psperi      to (Value(operi(Self),0))
52194>>>>>>>>>>>>>                Set pscodekat   to (Value(ocodekat(Self),0))
52195>>>>>>>>>>>>>                send Rebuild_Constraints    to (witemx_DD(Self))
52196>>>>>>>>>>>>>                Send Beginning_Of_Data      to oSelList True
52197>>>>>>>>>>>>>            End_Procedure // OnClick
52198>>>>>>>>>>>>>            
52198>>>>>>>>>>>>>            
52198>>>>>>>>>>>>>            //AB-StoreEnd
52198>>>>>>>>>>>>>
52198>>>>>>>>>>>>>        End_Object    // ButtonSub1
52199>>>>>>>>>>>>>
52199>>>>>>>>>>>>>        Object TextBoxSub3 is a TextBoxSub
52201>>>>>>>>>>>>>            Set Label to "‰à›. ¡˜«žš¦¨å˜ª š ˜"
52202>>>>>>>>>>>>>            Set Auto_Size_State to FALSE
52203>>>>>>>>>>>>>            Set Location to 221 5
52204>>>>>>>>>>>>>            Set Size to 13 70
52205>>>>>>>>>>>>>        End_Object    // TextBoxSub3
52206>>>>>>>>>>>>>
52206>>>>>>>>>>>>>        Object ocodekat is a FormSub
52208>>>>>>>>>>>>>            Set Size to 13 197
52209>>>>>>>>>>>>>            Set Location to 221 79
52210>>>>>>>>>>>>>            Set Label_Col_Offset to 2
52211>>>>>>>>>>>>>
52211>>>>>>>>>>>>>            //AB-StoreStart
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            
52211>>>>>>>>>>>>>            //AB-StoreEnd
52211>>>>>>>>>>>>>
52211>>>>>>>>>>>>>        End_Object    // ocodekat
52212>>>>>>>>>>>>>
52212>>>>>>>>>>>>>        Object oOK_bn is a ButtonSub
52214>>>>>>>>>>>>>            Set Label to "&„§ ¢¦šã"
52215>>>>>>>>>>>>>            Set Location to 232 318
52216>>>>>>>>>>>>>
52216>>>>>>>>>>>>>            //AB-StoreStart
52216>>>>>>>>>>>>>            Procedure OnClick
52218>>>>>>>>>>>>>                Send OK To (oSelList(current_object))
52219>>>>>>>>>>>>>            End_Procedure
52220>>>>>>>>>>>>>            //AB-StoreEnd
52220>>>>>>>>>>>>>
52220>>>>>>>>>>>>>        End_Object    // oOK_bn
52221>>>>>>>>>>>>>
52221>>>>>>>>>>>>>        Object oCancel_bn is a ButtonSub
52223>>>>>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
52224>>>>>>>>>>>>>            Set Location to 232 373
52225>>>>>>>>>>>>>
52225>>>>>>>>>>>>>            //AB-StoreStart
52225>>>>>>>>>>>>>            Procedure OnClick
52227>>>>>>>>>>>>>                Send Cancel To (oSelList(current_object))
52228>>>>>>>>>>>>>            End_Procedure
52229>>>>>>>>>>>>>            //AB-StoreEnd
52229>>>>>>>>>>>>>
52229>>>>>>>>>>>>>        End_Object    // oCancel_bn
52230>>>>>>>>>>>>>
52230>>>>>>>>>>>>>        Object oSearch_bn is a ButtonSub
52232>>>>>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
52233>>>>>>>>>>>>>            Set Location to 232 428
52234>>>>>>>>>>>>>
52234>>>>>>>>>>>>>            //AB-StoreStart
52234>>>>>>>>>>>>>            Procedure OnClick
52236>>>>>>>>>>>>>                Send Search To (oSelList(current_object))
52237>>>>>>>>>>>>>            End_Procedure
52238>>>>>>>>>>>>>            //AB-StoreEnd
52238>>>>>>>>>>>>>
52238>>>>>>>>>>>>>        End_Object    // oSearch_bn
52239>>>>>>>>>>>>>
52239>>>>>>>>>>>>>        Object btnwitemcl is a ButtonSub
52241>>>>>>>>>>>>>
52241>>>>>>>>>>>>>            //AB-StoreTopStart
52241>>>>>>>>>>>>>            
52241>>>>>>>>>>>>>            //AB-StoreTopEnd
52241>>>>>>>>>>>>>
52241>>>>>>>>>>>>>            Set Label to "ButtonSub1"
52242>>>>>>>>>>>>>            Set Bitmap to "Filesys3.bmp"
52243>>>>>>>>>>>>>            Set Size to 22 25
52244>>>>>>>>>>>>>            Set Location to 196 443
52245>>>>>>>>>>>>>            Set Focus_Mode to Pointer_Only
52246>>>>>>>>>>>>>
52246>>>>>>>>>>>>>            //AB-StoreStart
52246>>>>>>>>>>>>>            
52246>>>>>>>>>>>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«¦ œ¬¨œ«ã¨ ¦ „ ›é¤ / ¨¦£žŸœ¬«ã"
52247>>>>>>>>>>>>>            
52247>>>>>>>>>>>>>            Procedure OnClick
52249>>>>>>>>>>>>>                String  scode speri
52250>>>>>>>>>>>>>                Get value of (ocode(self)) to scode
52251>>>>>>>>>>>>>                Get value of (operi(self)) to speri
52252>>>>>>>>>>>>>                set pscode of (dg186(self)) to scode
52253>>>>>>>>>>>>>                set psperi of (dg186(self)) to speri
52254>>>>>>>>>>>>>               Send popup_modal to (dg186(self))
52255>>>>>>>>>>>>>            End_Procedure // OnClick
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            
52256>>>>>>>>>>>>>            //AB-StoreEnd
52256>>>>>>>>>>>>>
52256>>>>>>>>>>>>>        End_Object    // btnwitemcl
52257>>>>>>>>>>>>>
52257>>>>>>>>>>>>>
52257>>>>>>>>>>>>>        //AB-StoreStart
52257>>>>>>>>>>>>>                
52257>>>>>>>>>>>>>        Set Locate_Mode to Center_On_Screen
52258>>>>>>>>>>>>>        
52258>>>>>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
52259>>>>>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To (oCancel_bn(current_object))
52260>>>>>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To (oSearch_bn(current_object))
52261>>>>>>>>>>>>>        
52261>>>>>>>>>>>>>        Procedure Activate
52263>>>>>>>>>>>>>            Send Rebuild_Constraints    to Witemx_DD
52264>>>>>>>>>>>>>            Send Beginning_Of_Data      to oSelList True
52265>>>>>>>>>>>>>            Forward Send Activate
52267>>>>>>>>>>>>>        End_Procedure
52268>>>>>>>>>>>>>        
52268>>>>>>>>>>>>>        procedure request_cancel
52270>>>>>>>>>>>>>            forward send request_cancel
52272>>>>>>>>>>>>>            set value of (ocode(self)) to ''
52273>>>>>>>>>>>>>            set value of (operi(self)) to ''
52274>>>>>>>>>>>>>            set value of (ocodekat(self)) to ''
52275>>>>>>>>>>>>>            Set psperi  to ''
52276>>>>>>>>>>>>>            Set pscode  to ''
52277>>>>>>>>>>>>>            Set pscodekat TO ''
52278>>>>>>>>>>>>>        end_procedure
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        
52279>>>>>>>>>>>>>        //AB-StoreEnd
52279>>>>>>>>>>>>>
52279>>>>>>>>>>>>>    End_Object    // SL17
52280>>>>>>>>>>>>>
52280>>>>>>>>>>>>>
52280>>>>>>>>>>>>>    //AB-StoreStart
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    
52280>>>>>>>>>>>>>    //AB-StoreEnd
52280>>>>>>>>>>>>>
52280>>>>>>>>>>>>>//AB/     End_Object    // prj
52280>>>>>>>>>>>
52280>>>>>>>>>>>//DDB-Selection-pkg-End
52280>>>>>>>>>>>//DDB-FileEnd
52280>>>>>>>>>    Use PMOVES.DD
INCLUDING FILE: PMOVES.DD
52280>>>>>>>>>>>//DDB-FileStart
52280>>>>>>>>>>>//DDB-HeaderStart
52280>>>>>>>>>>>
52280>>>>>>>>>>>// File Name : PMOVES.DD
52280>>>>>>>>>>>// Class Name: Pmoves_DataDictionary
52280>>>>>>>>>>>// Revision  : 157
52280>>>>>>>>>>>// Version   : 2
52280>>>>>>>>>>>
52280>>>>>>>>>>>Use  Windows           // Basic Definitions
52280>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
52280>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
52280>>>>>>>>>>>
52280>>>>>>>>>>>Open Pmoves
52282>>>>>>>>>>>Open Pmsdtl
INCLUDING FILE: PMSDTL.FD
52284>>>>>>>>>>>Open Pmssxet
52286>>>>>>>>>>>Open Wax
52288>>>>>>>>>>>Open Witemx
52290>>>>>>>>>>>Open Particle
52292>>>>>>>>>>>Open Sysrecp
52294>>>>>>>>>>>Open Syscurxr
52296>>>>>>>>>>>Open Partlfpa
52298>>>>>>>>>>>Open Clorder
52300>>>>>>>>>>>Open Clorderd
52302>>>>>>>>>>>Open Btnemp
INCLUDING FILE: BTNEMP.FD
52304>>>>>>>>>>>Open Gmove
52306>>>>>>>>>>>Open Sysrecg
52308>>>>>>>>>>>
52308>>>>>>>>>>>//DDB-HeaderEnd
52308>>>>>>>>>>>Open Fpa
52310>>>>>>>>>>>Open PartlFpa
52312>>>>>>>>>>>Open Item
52314>>>>>>>>>>>Open Wtypkin
52316>>>>>>>>>>>Open Witemkat
52318>>>>>>>>>>>Open Wapomast
52320>>>>>>>>>>>Open Wapokat
52322>>>>>>>>>>>Open Payresp
52324>>>>>>>>>>>
52324>>>>>>>>>>>Class Pmoves_DataDictionary  is a DataDictionary_Sec
52325>>>>>>>>>>>
52325>>>>>>>>>>>
52325>>>>>>>>>>>    Procedure Construct_Object
52326>>>>>>>>>>>        Forward Send Construct_Object
52328>>>>>>>>>>>        Property Number  pnoQty         Public  0
52329>>>>>>>>>>>        Property integer pifromclorder  Public  0
52330>>>>>>>>>>>        Property Integer piCheckZeroFpa Public  0
52331>>>>>>>>>>>        Property Integer piPmsSxetID    Public  0
52332>>>>>>>>>>>        Property integer piFromMetasx   Public  0
52333>>>>>>>>>>>        Property String  psOldItem      Public ''        
52334>>>>>>>>>>>        //------------------------------------------------
52334>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
52334>>>>>>>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio 
52334>>>>>>>>>>>        // einai 1     js 03/12/2007
52334>>>>>>>>>>>        //------------------------------------------------  
52334>>>>>>>>>>>        Property Integer piCreateNew            Public  0
52335>>>>>>>>>>>        Property String  psAud_Old_Pelaths      Public ""
52336>>>>>>>>>>>        Property String  psAud_Old_PelathsN     Public ""
52337>>>>>>>>>>>        Property String  psAud_Old_Ergo         Public ""
52338>>>>>>>>>>>        Property String  psAud_Old_Poiothta     Public ""
52339>>>>>>>>>>>        Property String  psAud_Old_Eidos        Public ""
52340>>>>>>>>>>>
52340>>>>>>>>>>>        Property String  psAud_Old_Zonh         Public ""
52341>>>>>>>>>>>        Property String  psAud_Old_Antlia       Public ""
52342>>>>>>>>>>>        Property String  psAud_Old_Oxhma        Public ""
52343>>>>>>>>>>>
52343>>>>>>>>>>>        Property Number  pnAud_Old_Qty          Public  0
52344>>>>>>>>>>>        Property Number  pnAud_Old_Timh         Public  0
52345>>>>>>>>>>>        Property String  psAud_Old_PartlRecr    Public ""
52346>>>>>>>>>>>        Property String  psAud_Old_PmsRecr      Public ""
52347>>>>>>>>>>>        Property String  psAud_Old_Module       Public ""
52348>>>>>>>>>>>        Property String  psAud_Old_Parast       Public ""
52349>>>>>>>>>>>        Property String  psAud_Old_Seira        Public ""
52350>>>>>>>>>>>        Property Date    pdAud_Old_Hmnia        Public ""  
52351>>>>>>>>>>>        Property Integer piAud_Old_No           Public  0
52352>>>>>>>>>>>        //------------------------------------------------
52352>>>>>>>>>>>    End_Procedure
52353>>>>>>>>>>>
52353>>>>>>>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
52354>>>>>>>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
52356>>>>>>>>>>>        Set pnoQty      to Pmoves.Pms_Qty
52357>>>>>>>>>>>        Set psOldItem   to Item.Item_Code           
52358>>>>>>>>>>>        //------------------------------------------------
52358>>>>>>>>>>>        // Properties gia na kraththoun oi palies times 
52358>>>>>>>>>>>        // ton pedion js 03/12/2007
52358>>>>>>>>>>>        //------------------------------------------------
52358>>>>>>>>>>>        Set psAud_Old_Pelaths       to Pmoves.Client_ID
52359>>>>>>>>>>>        Set psAud_Old_PelathsN      to Clients.Client_Name
52360>>>>>>>>>>>        Set psAud_Old_Ergo          to Pmoves.CN_Code
52361>>>>>>>>>>>        Set psAud_Old_Eidos         to Pmoves.Witemx_Code   
52362>>>>>>>>>>>        Set psAud_Old_Poiothta      to Item.Item_Qual 
52363>>>>>>>>>>>        Set pnAud_Old_Qty           to Pmoves.Pms_Qty 
52364>>>>>>>>>>>        Set pnAud_Old_Timh          to Pmoves.Pms_UnitPrice 
52365>>>>>>>>>>>        Set psAud_Old_PartlRecr     to Pmoves.Partl_Recr 
52366>>>>>>>>>>>        Set psAud_Old_PmsRecr       to Pmoves.Pms_Recr 
52367>>>>>>>>>>>        Set psAud_Old_Module        to Particle.Partl_Module
52368>>>>>>>>>>>        Set psAud_Old_Zonh          to Pmoves.Zone
52369>>>>>>>>>>>        Set psAud_Old_Antlia        to Pmoves.Pump_ID
52370>>>>>>>>>>>        Set psAud_Old_Oxhma         to Pmoves.Car_ID
52371>>>>>>>>>>>        Set psAud_Old_Parast        to Ptyppar.Ptyppar_Code
52372>>>>>>>>>>>        Set psAud_Old_Seira         to Particle.Pseira_Seira
52373>>>>>>>>>>>        Set pdAud_Old_Hmnia         to Particle.Partl_Hmnia
52374>>>>>>>>>>>        Set piAud_Old_No            to Particle.Partl_No
52375>>>>>>>>>>>        //------------------------------------------------
52375>>>>>>>>>>>    End_Procedure   // New_Current_Record
52376>>>>>>>>>>>
52376>>>>>>>>>>>
52376>>>>>>>>>>>    // Delete_Main_File:
52376>>>>>>>>>>>    Procedure Delete_Main_File
52377>>>>>>>>>>>        clear btnemp
52378>>>>>>>>>>>        move pmoves.pms_recr to btnemp.pms_recr
52379>>>>>>>>>>>        find ge btnemp by index.11
52380>>>>>>>>>>>>
52380>>>>>>>>>>>        if ((found=1) and (pmoves.pms_recr=btnemp.pms_recr)) begin
52382>>>>>>>>>>>           move 0 to btnemp.pms_recr
52383>>>>>>>>>>>           saverecord btnemp
52384>>>>>>>>>>>        end                             
52384>>>>>>>>>>>>
52384>>>>>>>>>>>
52384>>>>>>>>>>>        //---------------------------------------------
52384>>>>>>>>>>>        // Auditing / Katagrafh allagon
52384>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52384>>>>>>>>>>>            //MODE_WAITING  
52384>>>>>>>>>>>            //MODE_FINDING  
52384>>>>>>>>>>>            //MODE_CLEARING 
52384>>>>>>>>>>>            //MODE_CREATING 
52384>>>>>>>>>>>            //MODE_SAVING   
52384>>>>>>>>>>>            //MODE_DELETING 
52384>>>>>>>>>>>            //MODE_ABORTING 
52384>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
52385>>>>>>>>>>>        Date    dDate  Shmer 
52385>>>>>>>>>>>        Integer iMin iHour iSec iLen
52385>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
52389>>>>>>>>>>>        Move iHour  to sHour
52390>>>>>>>>>>>        Move iMin   to sMin
52391>>>>>>>>>>>        Move iSec   to sSec
52392>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52396>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52400>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52404>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52405>>>>>>>>>>>        
52405>>>>>>>>>>>        // Auditing / Diagrafh - Diorthosh
52405>>>>>>>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING)) Begin
52407>>>>>>>>>>>            Get fsLoginUserID to sUser
52408>>>>>>>>>>>
52408>>>>>>>>>>>            clear gmove
52409>>>>>>>>>>>            move syscurxr.company_code  to gmove.company_code
52410>>>>>>>>>>>            move syscurxr.branch_code   to gmove.branch_code
52411>>>>>>>>>>>            move syscurxr.year_year     to gmove.year_year
52412>>>>>>>>>>>            move  1                     to gmove.gtypkin_code// Apo Parastatika
52413>>>>>>>>>>>            move ddate                  to gmove.garticl_hmnia
52414>>>>>>>>>>>            move pmoves.partl_no        to gmove.garticl_no
52415>>>>>>>>>>>            move Particle.CN_Code       to gmove.gplan_recr
52416>>>>>>>>>>>            move suser                  to gmove.gplan_code
52417>>>>>>>>>>>            move pmoves.pms_recr        to gmove.garticl_recr
52418>>>>>>>>>>>            reread sysrecg
52422>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52423>>>>>>>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52424>>>>>>>>>>>            saverecord sysrecg
52425>>>>>>>>>>>            unlock
52426>>>>>>>>>>>>
52426>>>>>>>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                        to Gmove.Gmove_Recr
52427>>>>>>>>>>>
52427>>>>>>>>>>>            Move (psAud_Old_Module(Self))       to Gmove.Module
52428>>>>>>>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
52429>>>>>>>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs    
52430>>>>>>>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
52431>>>>>>>>>>>            Move (psAud_Old_Pelaths (Self))     to Gmove.Prev_ID
52432>>>>>>>>>>>            Move (psAud_Old_PelathsN(Self))     to Gmove.Prev_Name
52433>>>>>>>>>>>            Move (psAud_Old_Ergo     (Self))    to Gmove.Prev_CN
52434>>>>>>>>>>>            Move (psAud_Old_Eidos    (Self))    to Gmove.Prev_Item
52435>>>>>>>>>>>            Move (psAud_Old_Poiothta (Self))    to Gmove.Prev_Qual 
52436>>>>>>>>>>>            Move (pnAud_Old_Qty      (Self))    to Gmove.Prev_M3 
52437>>>>>>>>>>>            Move (pnAud_Old_Timh     (Self))    to Gmove.Prev_UnitPrice
52438>>>>>>>>>>>            Move (psAud_Old_PartlRecr(Self))    to Gmove.Partl_Recr 
52439>>>>>>>>>>>            Move (psAud_Old_PmsRecr  (Self))    to Gmove.Pms_Recr  
52440>>>>>>>>>>>            Move (psAud_Old_Zonh     (Self))    to Gmove.Prev_Zonh
52441>>>>>>>>>>>            Move (psAud_Old_Antlia   (Self))    to Gmove.Prev_Antlia
52442>>>>>>>>>>>            Move (psAud_Old_Oxhma    (Self))    to Gmove.Prev_Oxhma
52443>>>>>>>>>>>            Move (psAud_Old_Parast   (Self))    to Gmove.Prev_Parast
52444>>>>>>>>>>>            Move (psAud_Old_Seira    (Self))    to Gmove.Prev_Seira
52445>>>>>>>>>>>            Move (pdAud_Old_Hmnia    (Self))    to Gmove.Prev_Hmnia
52446>>>>>>>>>>>            Move (piAud_Old_No       (Self))    to Gmove.Prev_No
52447>>>>>>>>>>>            Move "ƒ ˜š¨˜­ã š¨˜££ãª  ˜¨˜©«˜« ¡¦ç)" to sText
52448>>>>>>>>>>>            Move "D" to Gmove.Eidos_Metabolhs
52449>>>>>>>>>>>            move (trim(stext))          to gmove.gmove_aitiol
52450>>>>>>>>>>>            Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                to Gmove.Txt1
52451>>>>>>>>>>>            saverecord gmove
52452>>>>>>>>>>>        End
52452>>>>>>>>>>>>
52452>>>>>>>>>>>
52452>>>>>>>>>>>        Forward Send Delete_Main_File
52454>>>>>>>>>>>        // Insert Code Here
52454>>>>>>>>>>>    End_Procedure   // Delete_Main_File
52455>>>>>>>>>>>                      
52455>>>>>>>>>>>
52455>>>>>>>>>>>    Procedure Save_Main_File
52456>>>>>>>>>>>        Integer iYes
52457>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
52459>>>>>>>>>>>            If Pmoves.Recnum Eq 0 Procedure_Return
52462>>>>>>>>>>>        End
52462>>>>>>>>>>>>
52462>>>>>>>>>>>
52462>>>>>>>>>>>        If ((Operation_Origin=Self) And (piCheckZeroFpa(Self))) Begin
52464>>>>>>>>>>>            // Elegxos FPA
52464>>>>>>>>>>>            // An typonei otidhpote ektos apo 1 (mono Posothtes)
52464>>>>>>>>>>>            If ((Ptyppar.Ti_Typonei_Pms<>'1')   And ;                (Pmoves.Pms_Vatam=0)            And ;                (Operation_Mode<>MODE_DELETING)) Begin
52466>>>>>>>>>>>                Move (YesNo_Box("¦©æ ”€ £ž›œ¤ ¡æ. Œ˜ ©¬¤œ®å©à ;", ;                                     "¨¦©¦®ã",  MB_DEFBUTTON2) ) to iYes
52467>>>>>>>>>>>                If (iYes=MBR_NO)  Send Operation_Not_Allowed 8000
52470>>>>>>>>>>>            End
52470>>>>>>>>>>>>
52470>>>>>>>>>>>        End
52470>>>>>>>>>>>>
52470>>>>>>>>>>>        Forward Send Save_Main_File
52472>>>>>>>>>>>    End_Procedure
52473>>>>>>>>>>>
52473>>>>>>>>>>>    Function fnTeleytaiaTimh Returns Number
52474>>>>>>>>>>>        Number  rVal nQty
52475>>>>>>>>>>>        String  sClientID sWitemxCode
52475>>>>>>>>>>>        Date    dHmnia
52475>>>>>>>>>>>        String  sWhat sRecr sClientCode sItemCode sCN
52475>>>>>>>>>>>
52475>>>>>>>>>>>        Get File_Field_Current_Value File_Field Ptyppar.Ptyppar_Is_What to sWhat
52476>>>>>>>>>>>        If (Trim(sWhat)='1') Begin
52478>>>>>>>>>>>            // 1=€š¦¨œª
52478>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52479>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52480>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52481>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52482>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientCode
52483>>>>>>>>>>>            // Sto arxeio Globals.inc
52483>>>>>>>>>>>            Get fnTeleytaiaTimhAgoras sClientCode sItemCode dHmnia nQty to rVal
52484>>>>>>>>>>>        End
52484>>>>>>>>>>>>
52484>>>>>>>>>>>        Else If (Trim(sWhat)='2') Begin
52487>>>>>>>>>>>            // 2=à¢ã©œ ª
52487>>>>>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Qty          to nQty
52488>>>>>>>>>>>            Get File_Field_Current_Value File_Field Item.Item_Code          to sItemCode
52489>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Hmnia    to dHmnia
52490>>>>>>>>>>>            Get File_Field_Current_Value File_Field Particle.Cn_Code        to sCN
52491>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Recr      to sRecr
52492>>>>>>>>>>>            Get File_Field_Current_Value File_Field Clients.Client_ID       to sClientID
52493>>>>>>>>>>>            Get File_Field_Current_Value File_Field Witemx.Witemx_Code      to sWitemxCode
52494>>>>>>>>>>>            // Sto arxeio Globals.inc
52494>>>>>>>>>>>            Get fnTeleytaiaTimhPolhshs sRecr sClientID sWitemxCode dHmnia sItemCode nQty sCN to rVal
52495>>>>>>>>>>>        End
52495>>>>>>>>>>>>
52495>>>>>>>>>>>        Function_Return rVal
52496>>>>>>>>>>>    End_Function
52497>>>>>>>>>>>
52497>>>>>>>>>>>    Procedure Creating
52498>>>>>>>>>>>        Forward Send Creating
52500>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Pmoves.Pms_Rec0)))))) to Pmoves.Pms_Recr
52501>>>>>>>>>>>        Set piCreateNew to 1
52502>>>>>>>>>>>    End_Procedure   // Creating
52503>>>>>>>>>>>
52503>>>>>>>>>>>    Procedure Update
52504>>>>>>>>>>>        Integer iDecimals
52505>>>>>>>>>>>        Number  nInt nFpaOnTotal
52505>>>>>>>>>>>        String  sCurrentUser
52505>>>>>>>>>>>
52505>>>>>>>>>>>        Forward Send Update
52507>>>>>>>>>>>
52507>>>>>>>>>>>        Move SysCurXR.Company_Code                          to Pmoves.Company_Code
52508>>>>>>>>>>>        Move SysCurXR.Branch_Code                           to Pmoves.Branch_Code
52509>>>>>>>>>>>        Move SysCurXR.Year_Year                             to Pmoves.Year_Year
52510>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code                           to Pmoves.Ctypkin_Code
52511>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code                           to Pmoves.Wtypkin_Code
52512>>>>>>>>>>>
52512>>>>>>>>>>>        Move Witemkat.Witemkat_Code                         to Pmoves.Witemkat_Code
52513>>>>>>>>>>>        Move Item.Item_Code                                 to Pmoves.Item_Code
52514>>>>>>>>>>>        Move Witemx.Witemx_Code                             to Pmoves.Witemx_Code
52515>>>>>>>>>>>        Move Wapokat.Wapokat_Code                           to Pmoves.Wapokat_Code
52516>>>>>>>>>>>        Move Wapomast.Wapomast_Code                         to Pmoves.Wapomast_Code
52517>>>>>>>>>>>        Move Wax.Wax_Code                                   to Pmoves.Wax_Code
52518>>>>>>>>>>>
52518>>>>>>>>>>>        //Move Custprom.Custprom_Code                         to Pmoves.Custprom_Code
52518>>>>>>>>>>>        Move Clients.Client_ID                              to Pmoves.Client_ID
52519>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code                           to Pmoves.Ptyppar_Code
52520>>>>>>>>>>>        Move Ptyppar.TI_TYPONEI_PMS                         to Pmoves.TI_TYPONEI_PMS
52521>>>>>>>>>>>        Move Particle.PSeira_Seira                          to Pmoves.Pseira_Seira
52522>>>>>>>>>>>
52522>>>>>>>>>>>        Move Nomisma.Nomisma_Code                           to Pmoves.Pms_Sc_Code2
52523>>>>>>>>>>>        Move Nomisma.Dekadika                               To iDecimals
52524>>>>>>>>>>>
52524>>>>>>>>>>>        Move Particle.CN_Code                               to Pmoves.CN_Code
52525>>>>>>>>>>>        Move Particle.Partl_No                              to Pmoves.Partl_No
52526>>>>>>>>>>>        Move Particle.Partl_Hmnia                           to Pmoves.Partl_Hmnia
52527>>>>>>>>>>>        Move Particle.Partl_Module                          to Pmoves.Pms_Module
52528>>>>>>>>>>>        Move Particle.Partl_Rec0                            to Pmoves.Partl_Rec0
52529>>>>>>>>>>>
52529>>>>>>>>>>>        Move Particle.Sls_ID                                to Pmoves.Sls_ID
52530>>>>>>>>>>>        Move Particle.Presp_ID                              to Pmoves.Presp_ID
52531>>>>>>>>>>>        Move Particle.Cnt_ID                                to Pmoves.Cnt_ID
52532>>>>>>>>>>>        Move Item.Units_Code                                to Pmoves.Pms_UnitCode
52533>>>>>>>>>>>        move witemx.witemx_descr                            to pmoves.witemx_descr
52534>>>>>>>>>>>        move ptyppar.ptyppar_descr                          to pmoves.ptyppar_descr
52535>>>>>>>>>>>        move clients.client_name                            to pmoves.client_name
52536>>>>>>>>>>>
52536>>>>>>>>>>>        if (Trim(pmoves.pump_id)='') ;            move particle.antlia_code                       to pmoves.pump_id
52539>>>>>>>>>>>        If (Trim(pmoves.car_id)='') ;            move particle.oxhma_code                        to pmoves.car_id
52542>>>>>>>>>>>        If (Trim(pmoves.zone)='') ;            move particle.zone_id                           to pmoves.zone
52545>>>>>>>>>>>
52545>>>>>>>>>>>      //  if (particle.zone_id='') move pmoves.zone           to particle.zone_id
52545>>>>>>>>>>>      //  else move particle.Zone_ID                          to pmoves.Zone
52545>>>>>>>>>>>
52545>>>>>>>>>>>        Move (Pmoves.Pms_Qty-Pmoves.Timol_Qty)              to Pmoves.Timol_Ypol
52546>>>>>>>>>>>
52546>>>>>>>>>>>        Move (Pmoves.Qty_Kinhshs>0)                         to Pmoves.pms_Selected
52547>>>>>>>>>>>
52547>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Qty*Pmoves.Pms_UnitPrice),iDecimals))    ;                                                            to Pmoves.Pms_Ambd
52548>>>>>>>>>>>
52548>>>>>>>>>>>        If (Pmoves.Pms_PctDisc<>0) ;            Move (Round_Number((Pmoves.Pms_Ambd*Pmoves.Pms_PctDisc/100),iDecimals)) ;                                                            to Pmoves.Pms_Discam
52551>>>>>>>>>>>        Else ;            Move (Round_Number( ((Pmoves.Pms_Discam/Pmoves.Pms_Ambd)*100),iDecimals)) ;                                                            to Pmoves.Pms_PctDisc
52553>>>>>>>>>>>
52553>>>>>>>>>>>        Move (Pmoves.Pms_Ambd-Pmoves.Pms_Discam)            to Pmoves.Pms_Amaftdisc
52554>>>>>>>>>>>
52554>>>>>>>>>>>        Move (Round_Number((Pmoves.Pms_Amaftdisc*Pmoves.Pms_Vatpct/100),iDecimals));                                                            to Pmoves.Pms_Vatam
52555>>>>>>>>>>>        Move (Pmoves.Pms_Amaftdisc+Pmoves.Pms_Vatam)        to Pmoves.Pms_Payable
52556>>>>>>>>>>>        Move Pmoves.Pms_Payable                             to Pmoves.Pms_Axia
52557>>>>>>>>>>>
52557>>>>>>>>>>>        Add Pmoves.Pms_Qty                                  to Particle.Partl_TotTem
52558>>>>>>>>>>>        Add Pmoves.Timol_Qty                                to Particle.Timol_Qty
52559>>>>>>>>>>>
52559>>>>>>>>>>>        Add Pmoves.Pms_Ambd                                 to Particle.Partl_TotAmBD
52560>>>>>>>>>>>        Add Pmoves.Pms_DiscAm                               to Particle.Partl_AMDISCPMS
52561>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc                            to Particle.Partl_TotAmAd
52562>>>>>>>>>>>        Add 1                                               to Particle.Partl_NoOfLines
52563>>>>>>>>>>>
52563>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52563>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52563>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh apo
52563>>>>>>>>>>>        // function timokatalogon kai na thn krathsoume sto pedio
52563>>>>>>>>>>>        // Pmoves.Posa_apo_dap
52563>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52565>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52565>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52565>>>>>>>>>>>            // h update prepei na prosthesei sto antistoixo pedio client
52565>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52565>>>>>>>>>>>            // Timologio) tote  prepei h update na afairesei apo to pedio
52565>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe prosthesei.
52565>>>>>>>>>>>
52565>>>>>>>>>>>            Move (Round_Number(Pmoves.Pms_Payable,2)) to Pmoves.Posa_Apo_Dap
52566>>>>>>>>>>>
52566>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52568>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52569>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52570>>>>>>>>>>>            End
52570>>>>>>>>>>>>
52570>>>>>>>>>>>            Else Begin
52571>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52572>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52573>>>>>>>>>>>            End
52573>>>>>>>>>>>>
52573>>>>>>>>>>>        End
52573>>>>>>>>>>>>
52573>>>>>>>>>>>
52573>>>>>>>>>>>        Add Pmoves.Qty_Kinhshs  to Particle.Partl_Disctof
52574>>>>>>>>>>>
52574>>>>>>>>>>>
52574>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52574>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52574>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52574>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to Particle.Partl_Vatam
52575>>>>>>>>>>>
52575>>>>>>>>>>>        Clear PartlFpa
52576>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52577>>>>>>>>>>>        Move Pmoves.Pms_VatPct          to PartlFpa.Fpa_Pososto
52578>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52579>>>>>>>>>>>>
52579>>>>>>>>>>>        Add Pmoves.Pms_Vatam            to PartlFpa.PartlFpa_Poso
52580>>>>>>>>>>>        Add Pmoves.Pms_Amaftdisc        to PartlFpa.Poso_Pro_Fpa
52581>>>>>>>>>>>        Saverecord PartlFpa
52582>>>>>>>>>>>
52582>>>>>>>>>>>        Move 0 to nFpaOnTotal
52583>>>>>>>>>>>        Clear PartlFpa
52584>>>>>>>>>>>        Move Particle.Partl_Recr        to PartlFpa.Partl_Recr
52585>>>>>>>>>>>        Find Gt PartlFpa By Index.1
52586>>>>>>>>>>>>
52586>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52590>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52591>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52592>>>>>>>>>>>            Saverecord PartlFpa
52593>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52594>>>>>>>>>>>            Find Gt PartlFpa By Index.1
52595>>>>>>>>>>>>
52595>>>>>>>>>>>        Loop
52596>>>>>>>>>>>>
52596>>>>>>>>>>>
52596>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total
52597>>>>>>>>>>>
52597>>>>>>>>>>>
52597>>>>>>>>>>>        //---------------------------------------------
52597>>>>>>>>>>>        // Auditing / Katagrafh allagon
52597>>>>>>>>>>>        //OPERATION_MODE       OPERATION_ORIGIN
52597>>>>>>>>>>>            //MODE_WAITING  
52597>>>>>>>>>>>            //MODE_FINDING  
52597>>>>>>>>>>>            //MODE_CLEARING 
52597>>>>>>>>>>>            //MODE_CREATING 
52597>>>>>>>>>>>            //MODE_SAVING   
52597>>>>>>>>>>>            //MODE_DELETING 
52597>>>>>>>>>>>            //MODE_ABORTING 
52597>>>>>>>>>>>        String  sUser sText sTime sMin sHour sSec
52597>>>>>>>>>>>        Date    dDate  Shmer 
52597>>>>>>>>>>>        Integer iMin iHour iSec iLen
52597>>>>>>>>>>>        Sysdate dDate iHour iMin iSec 
52601>>>>>>>>>>>        Move iHour  to sHour
52602>>>>>>>>>>>        Move iMin   to sMin
52603>>>>>>>>>>>        Move iSec   to sSec
52604>>>>>>>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
52608>>>>>>>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
52612>>>>>>>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
52616>>>>>>>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
52617>>>>>>>>>>>        
52617>>>>>>>>>>>        // Auditing / Dhmiourgia - Diorthosh
52617>>>>>>>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
52619>>>>>>>>>>>            Get fsLoginUserID to sUser
52620>>>>>>>>>>>            If (piCreateNew(Self)=1) Begin
52622>>>>>>>>>>>                clear gmove
52623>>>>>>>>>>>                move syscurxr.company_code  to gmove.company_code
52624>>>>>>>>>>>                move syscurxr.branch_code   to gmove.branch_code
52625>>>>>>>>>>>                move syscurxr.year_year     to gmove.year_year
52626>>>>>>>>>>>                move  1                     to gmove.gtypkin_code// Apo Parastatika
52627>>>>>>>>>>>                move ddate                  to gmove.garticl_hmnia
52628>>>>>>>>>>>                move pmoves.partl_no        to gmove.garticl_no
52629>>>>>>>>>>>                move Particle.CN_Code       to gmove.gplan_recr
52630>>>>>>>>>>>                move suser                  to gmove.gplan_code
52631>>>>>>>>>>>                move pmoves.pms_recr        to gmove.garticl_recr
52632>>>>>>>>>>>                reread sysrecg
52636>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52637>>>>>>>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52638>>>>>>>>>>>                saverecord sysrecg
52639>>>>>>>>>>>                unlock
52640>>>>>>>>>>>>
52640>>>>>>>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                            to Gmove.Gmove_Recr
52641>>>>>>>>>>>                Move Particle.Partl_Module          to Gmove.Module
52642>>>>>>>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
52643>>>>>>>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs    
52644>>>>>>>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
52645>>>>>>>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
52646>>>>>>>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
52647>>>>>>>>>>>                Move Particle.CN_Code               to Gmove.Cur_CN
52648>>>>>>>>>>>                Move Item.Item_Code                 to Gmove.Cur_Item
52649>>>>>>>>>>>                Move Item.Item_Qual                 to Gmove.Cur_Qual 
52650>>>>>>>>>>>                Move Pmoves.Pms_Qty                 to Gmove.Cur_M3 
52651>>>>>>>>>>>                Move Pmoves.Pms_UnitPrice           to Gmove.Cur_UnitPrice
52652>>>>>>>>>>>                Move Particle.Partl_Recr            to Gmove.Partl_Recr 
52653>>>>>>>>>>>                Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
52654>>>>>>>>>>>                
52654>>>>>>>>>>>                Move Pmoves.Zone                    to Gmove.Cur_Zonh
52655>>>>>>>>>>>                Move Pmoves.Pump_ID                 to Gmove.Cur_Antlia
52656>>>>>>>>>>>                Move Pmoves.Car_ID                  to Gmove.Cur_Oxhma       
52657>>>>>>>>>>>                
52657>>>>>>>>>>>                Move Ptyppar.Ptyppar_Code           to Gmove.Cur_Parast
52658>>>>>>>>>>>                Move Particle.Pseira_Seira          to Gmove.Cur_Seira
52659>>>>>>>>>>>                Move Particle.Partl_Hmnia           to Gmove.Cur_Hmnia
52660>>>>>>>>>>>                Move "ƒž£ ¦¬¨šå˜ š¨˜££ãª §˜¨˜©«˜« ¡¦ç)" to sText
52661>>>>>>>>>>>                Move "N" to Gmove.Eidos_Metabolhs
52662>>>>>>>>>>>                move (trim(stext))          to gmove.gmove_aitiol
52663>>>>>>>>>>>                Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                    to Gmove.Txt1
52664>>>>>>>>>>>                saverecord gmove
52665>>>>>>>>>>>                Set piCreateNew to 0
52666>>>>>>>>>>>            End
52666>>>>>>>>>>>>
52666>>>>>>>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1)) Begin                                
52669>>>>>>>>>>>                Integer isChanged
52669>>>>>>>>>>>                Move 0 to isChanged
52670>>>>>>>>>>>                
52670>>>>>>>>>>>                     If ((Trim(psAud_Old_Pelaths(Self))<>Trim(Clients.Client_ID    ))   Or  (Trim(psAud_Old_Ergo    (Self))<>Trim(Pmoves.CN_Code      ))) Move 1 to isChanged    
52673>>>>>>>>>>>                Else If ((Trim(psAud_Old_Eidos  (Self))<>Trim(Item.Item_Code       ))   Or  (Trim(psAud_Old_Poiothta(Self))<>Trim(Item.Item_Qual      ))) Move 1 to isChanged   
52677>>>>>>>>>>>                Else If ((pnAud_Old_Qty         (Self) <>Pmoves.Pms_Qty             )   Or  (pnAud_Old_Timh         (Self) <>Pmoves.Pms_UnitPrice      )) Move 1 to isChanged   
52681>>>>>>>>>>>                Else If ((Trim(psAud_Old_Zonh   (Self))<>Trim(Pmoves.Zone          ))   Or  (Trim(psAud_Old_Antlia  (Self))<>Trim(Pmoves.Pump_ID      ))) Move 1 to isChanged   
52685>>>>>>>>>>>                Else If ((Trim(psAud_Old_Oxhma  (Self))<>Trim(Pmoves.Car_ID        ))   Or  (Trim(psAud_Old_Parast  (Self))<>Trim(Ptyppar.Ptyppar_Code))) Move 1 to isChanged   
52689>>>>>>>>>>>                Else If ((Trim(psAud_Old_Seira  (Self))<>Trim(Particle.Pseira_Seira))   Or  (Trim(pdAud_Old_Hmnia   (Self))<>Particle.Partl_Hmnia      )) Move 1 to isChanged  
52693>>>>>>>>>>>                Else If  (piAud_Old_No          (Self) <>Particle.Partl_No)                                                                               Move 1 to isChanged
52697>>>>>>>>>>>
52697>>>>>>>>>>>                If (isChanged>0) Begin  
52699>>>>>>>>>>>                    clear gmove
52700>>>>>>>>>>>                    move syscurxr.company_code  to gmove.company_code
52701>>>>>>>>>>>                    move syscurxr.branch_code   to gmove.branch_code
52702>>>>>>>>>>>                    move syscurxr.year_year     to gmove.year_year
52703>>>>>>>>>>>                    move  1                     to gmove.gtypkin_code// Apo Parastatika
52704>>>>>>>>>>>                    move ddate                  to gmove.garticl_hmnia
52705>>>>>>>>>>>                    move pmoves.partl_no        to gmove.garticl_no
52706>>>>>>>>>>>                    move Particle.CN_Code       to gmove.gplan_recr
52707>>>>>>>>>>>                    move suser                  to gmove.gplan_code
52708>>>>>>>>>>>                    move pmoves.pms_recr        to gmove.garticl_recr
52709>>>>>>>>>>>                    reread sysrecg
52713>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
52714>>>>>>>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
52715>>>>>>>>>>>                    saverecord sysrecg
52716>>>>>>>>>>>                    unlock
52717>>>>>>>>>>>>
52717>>>>>>>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
52718>>>>>>>>>>>                    Move Particle.Partl_Module          to Gmove.Module
52719>>>>>>>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
52720>>>>>>>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs    
52721>>>>>>>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
52722>>>>>>>>>>>                    //--
52722>>>>>>>>>>>                    Move Particle.Partl_Recr            to Gmove.Partl_Recr 
52723>>>>>>>>>>>                    Move Pmoves.Pms_Recr                to Gmove.Pms_Recr  
52724>>>>>>>>>>>                    //--
52724>>>>>>>>>>>                    Move (Trim(Clients.Client_ID    ))  to Gmove.Cur_ID
52725>>>>>>>>>>>                    Move (Trim(Clients.CLient_Name  ))  to Gmove.Cur_Name
52726>>>>>>>>>>>                    Move (Trim(Particle.CN_Code     ))  to Gmove.Cur_CN
52727>>>>>>>>>>>                    Move (Trim(Item.Item_Code       ))  to Gmove.Cur_Item
52728>>>>>>>>>>>                    Move (Trim(Item.Item_Qual       ))  to Gmove.Cur_Qual 
52729>>>>>>>>>>>                    Move       Pmoves.Pms_Qty           to Gmove.Cur_M3 
52730>>>>>>>>>>>                    Move       Pmoves.Pms_UnitPrice     to Gmove.Cur_UnitPrice
52731>>>>>>>>>>>
52731>>>>>>>>>>>                    Move (Trim(Pmoves.Zone          ))  to Gmove.Cur_Zonh
52732>>>>>>>>>>>                    Move (Trim(Pmoves.Pump_ID       ))  to Gmove.Cur_Antlia
52733>>>>>>>>>>>                    Move (Trim(Pmoves.Car_ID        ))  to Gmove.Cur_Oxhma       
52734>>>>>>>>>>>
52734>>>>>>>>>>>                    Move (Trim(Ptyppar.Ptyppar_Code ))  to Gmove.Cur_Parast
52735>>>>>>>>>>>                    Move (Trim(Particle.Pseira_Seira))  to Gmove.Cur_Seira
52736>>>>>>>>>>>                    Move       Particle.Partl_Hmnia     to Gmove.Cur_Hmnia
52737>>>>>>>>>>>                    Move       Particle.Partl_No        to Gmove.Cur_No
52738>>>>>>>>>>>                    //--
52738>>>>>>>>>>>                    Move (Trim(psAud_Old_Pelaths (Self))) to Gmove.Prev_ID
52739>>>>>>>>>>>                    Move (Trim(psAud_Old_PelathsN(Self))) to Gmove.Prev_Name
52740>>>>>>>>>>>                    Move (Trim(psAud_Old_Ergo    (Self))) to Gmove.Prev_CN
52741>>>>>>>>>>>                    Move (Trim(psAud_Old_Eidos   (Self))) to Gmove.Prev_Item
52742>>>>>>>>>>>                    Move (Trim(psAud_Old_Poiothta(Self))) to Gmove.Prev_Qual 
52743>>>>>>>>>>>                    Move      (pnAud_Old_Qty     (Self )) to Gmove.Prev_M3 
52744>>>>>>>>>>>                    Move      (pnAud_Old_Timh    (Self )) to Gmove.Prev_UnitPrice
52745>>>>>>>>>>>                    Move (Trim(psAud_Old_Zonh    (Self))) to Gmove.Prev_Zonh
52746>>>>>>>>>>>                    Move (Trim(psAud_Old_Antlia  (Self))) to Gmove.Prev_Antlia
52747>>>>>>>>>>>                    Move (Trim(psAud_Old_Oxhma   (Self))) to Gmove.Prev_Oxhma
52748>>>>>>>>>>>                    Move (Trim(psAud_Old_Parast  (Self))) to Gmove.Prev_Parast
52749>>>>>>>>>>>                    Move (Trim(psAud_Old_Seira   (Self))) to Gmove.Prev_Seira
52750>>>>>>>>>>>                    Move      (pdAud_Old_Hmnia   (Self )) to Gmove.Prev_Hmnia
52751>>>>>>>>>>>                    Move      (piAud_Old_No      (Self )) to Gmove.Prev_No
52752>>>>>>>>>>>                    //--
52752>>>>>>>>>>>                    Move "ƒ æ¨Ÿà©ž š¨˜££ãª ˜¨˜©«˜« ¡¦ç)" to sText 
52753>>>>>>>>>>>                    Move "E" to Gmove.Eidos_Metabolhs
52754>>>>>>>>>>>                    move (trim(stext))          to gmove.gmove_aitiol
52755>>>>>>>>>>>                    Move ("€¨:"+String(Particle.Partl_No)+"  ‘œ ¨˜:"+Trim(Particle.Pseira_Seira)+"   †£œ¨:"+String(Particle.Partl_Hmnia)) ;                                                        to Gmove.Txt1
52756>>>>>>>>>>>                    saverecord gmove
52757>>>>>>>>>>>                    Set piCreateNew to 0
52758>>>>>>>>>>>                End
52758>>>>>>>>>>>>
52758>>>>>>>>>>>            End
52758>>>>>>>>>>>>
52758>>>>>>>>>>>        End
52758>>>>>>>>>>>>
52758>>>>>>>>>>>    End_Procedure   // Update
52759>>>>>>>>>>>
52759>>>>>>>>>>>    // Backout:
52759>>>>>>>>>>>    Procedure Backout
52760>>>>>>>>>>>        Number nFpaOnTotal
52761>>>>>>>>>>>        Forward Send Backout
52763>>>>>>>>>>>
52763>>>>>>>>>>>        Sub Pmoves.Pms_Qty        From Particle.Partl_TotTem
52764>>>>>>>>>>>        Sub Pmoves.Timol_Qty      From Particle.Timol_Qty
52765>>>>>>>>>>>        Sub Pmoves.Pms_Ambd       From Particle.Partl_TotAmBD
52766>>>>>>>>>>>        Sub Pmoves.Pms_DiscAm     From Particle.Partl_AMDISCPMS
52767>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From Particle.Partl_TotAmAd
52768>>>>>>>>>>>        Sub 1                     From Particle.Partl_NoOfLines
52769>>>>>>>>>>>
52769>>>>>>>>>>>        // An einai parastatiko polhshs kai to ptyppar einai flagarismeno oti
52769>>>>>>>>>>>        // prepei na enhmerosh to pedio Clients.Posa_apo_dap
52769>>>>>>>>>>>        // tote theoroume oti ypoxreotika prepei na vroume timh sto pedio
52769>>>>>>>>>>>        // Pmoves.Posa_apo_dap
52769>>>>>>>>>>>        If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52771>>>>>>>>>>>            // An to pedio Particle.Partl_Vsn einai 0 tote shmainei
52771>>>>>>>>>>>            // oti den einai parastatiko metasxhmatismeno (px D.AP) ara
52771>>>>>>>>>>>            // h backout prepei na afairesei apo antistoixo pedio client
52771>>>>>>>>>>>            // An omos einai metasxhmatismeno (px apo D.AP tora einai
52771>>>>>>>>>>>            // Timologio) tote  prepei h backout na prosthesi sto pedio
52771>>>>>>>>>>>            // tou client dioti to arxiko D.AP eixe afairethei.
52771>>>>>>>>>>>            If (Particle.Partl_Vsn=0) Begin
52773>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Clients.Posa_Apo_Dap
52774>>>>>>>>>>>                Sub Pmoves.Posa_Apo_Dap From Payresp.Posa_Apo_Dap
52775>>>>>>>>>>>            End
52775>>>>>>>>>>>>
52775>>>>>>>>>>>            Else Begin
52776>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Clients.Posa_Apo_Dap
52777>>>>>>>>>>>                Add Pmoves.Posa_Apo_Dap to Payresp.Posa_Apo_Dap
52778>>>>>>>>>>>            End
52778>>>>>>>>>>>>
52778>>>>>>>>>>>        End
52778>>>>>>>>>>>>
52778>>>>>>>>>>>
52778>>>>>>>>>>>        Sub Pmoves.Qty_Kinhshs From Particle.Partl_Disctof
52779>>>>>>>>>>>
52779>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52779>>>>>>>>>>>        // SOS js 21/05/2003 DIAXEIRISH FPA
52779>>>>>>>>>>>        ////////////////////////////////////////////////////////////////////////
52779>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From Particle.Partl_Vatam
52780>>>>>>>>>>>
52780>>>>>>>>>>>        Clear PartlFpa
52781>>>>>>>>>>>        Move Particle.Partl_Recr    to PartlFpa.Partl_Recr
52782>>>>>>>>>>>        Move Pmoves.Pms_VatPct      to PartlFpa.Fpa_Pososto
52783>>>>>>>>>>>        Find eq PartlFpa By Index.1 // PartlFpa:Index.1:Partl_Recr+Fpa_Pososto
52784>>>>>>>>>>>>
52784>>>>>>>>>>>        Sub Pmoves.Pms_Vatam      From PartlFpa.PartlFpa_Poso
52785>>>>>>>>>>>        Sub Pmoves.Pms_Amaftdisc  From PartlFpa.Poso_Pro_Fpa
52786>>>>>>>>>>>        Saverecord PartlFpa
52787>>>>>>>>>>>
52787>>>>>>>>>>>        Move 0 to nFpaOnTotal
52788>>>>>>>>>>>        Clear PartlFpa
52789>>>>>>>>>>>        Move Particle.Partl_Recr  to PartlFpa.Partl_Recr
52790>>>>>>>>>>>        Find Gt PartlFpa By Index.1
52791>>>>>>>>>>>>
52791>>>>>>>>>>>        While ((Found=1) And (PartlFpa.Partl_Recr=Particle.Partl_Recr))
52795>>>>>>>>>>>            Move (Round_Number(((PartlFpa.Fpa_Pososto*PartlFpa.Poso_Pro_Fpa)/100),2)) to PartlFpa.POSO_FPA
52796>>>>>>>>>>>            Move (PartlFpa.Poso_Pro_Fpa+PartlFpa.POSO_FPA) to PartlFpa.POSO_ME_FPA
52797>>>>>>>>>>>            Saverecord PartlFpa
52798>>>>>>>>>>>            Add PartlFpa.POSO_FPA to nFpaOnTotal
52799>>>>>>>>>>>            Find Gt PartlFpa By Index.1
52800>>>>>>>>>>>>
52800>>>>>>>>>>>        Loop
52801>>>>>>>>>>>>
52801>>>>>>>>>>>
52801>>>>>>>>>>>        Move nFpaOnTotal to Particle.Fpa_On_Total     
52802>>>>>>>>>>>        
52802>>>>>>>>>>>    End_Procedure   // Backout
52803>>>>>>>>>>>
52803>>>>>>>>>>>
52803>>>>>>>>>>>
52803>>>>>>>>>>>
52803>>>>>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
52804>>>>>>>>>>>             If (iError_Num = 1001) Error 1001 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Wax"
52807>>>>>>>>>>>        Else If (iError_Num = 1002) Error 1002 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Witemx"
52811>>>>>>>>>>>        Else If (iError_Num = 1003) Error 1003 "DDC 18: ƒœ¤ â®à œ¤œ¨šã œšš¨˜­ã ©«¦ Particle"
52815>>>>>>>>>>>        Else If (iError_Num = 1004) Error 1004 "DDC 18: ¦©æ«ž«˜ „å›¦¬ª ‹ž›œ¤ ¡ã\nƒ ˜š¨á¯«œ ˜¤ Ÿâ¢œ«œ, «ž š¨˜££ã «¦¬ œå›¦¬ª"
52819>>>>>>>>>>>        Else If (iError_Num = 1005) Error 1005 "DDC 18: ¦©æ §¨¦ „¡§«à©žª ‹ž›œ¤ ¡æ"
52823>>>>>>>>>>>        Else If (iError_Num = 1006) Error 1006 "DDC 18: ¦©æ §¨¦ ”€ ‹ž›œ¤ ¡æ"
52827>>>>>>>>>>>        Else If (iError_Num = 1007) Error 1007 "DDC 18: ¦©æ ¢ž¨à«â¦ „å›¦¬ª ‹ž›œ¤ ¡æ"
52831>>>>>>>>>>>        Else If (iError_Num = 1009) Error 1009 "DDC 18: ƒœ¤ œå¤˜  œ­ ¡«ã ž › ˜š¨˜­ã \n„®œ  ›ž£ ¦¬¨šžŸœå £œ«˜©®ž£˜« ©£â¤¦ §˜¨˜©«˜« ¡æ"
52835>>>>>>>>>>>        Else If (iError_Num = 1010) Error 1010 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž"
52839>>>>>>>>>>>        Else If (iError_Num = 1011) Error 1011 "DDC 18: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ ¬§. §¢ž¨à£ãª"
52843>>>>>>>>>>>        Else If (iError_Num = 1012) Error 1012 "DDC 18: ’¦ œå›¦ª ˜¬«æ §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ ¡˜  ›œ¤ › ˜š¨á­œ«˜ .\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52847>>>>>>>>>>>        Else If (iError_Num = 1013) Error 1013 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\n‰ ¤ãŸž¡œ §¦©æ«ž«˜ > ˜§¦ «ž › ˜Ÿâ© £ž"
52851>>>>>>>>>>>        Else If (iError_Num = 1111) Error 1111 "DDC 18: ƒœ¤ â®œ  ¡˜«˜®à¨žŸœå ©«¦ ©ç©«ž£˜ «â«¦ ¦ §¦©¦©«æ ”€"
52855>>>>>>>>>>>        Else If (iError_Num = 1105) Error 1105 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52859>>>>>>>>>>>        Else If (iError_Num = 1106) Error 1106 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ ƒ ˜š¨á­œ«˜ "
52863>>>>>>>>>>>        Else If (iError_Num = 1107) Error 1107 "DDC 18: ˜¨˜©«˜« ¡æ ¡¢œ ©£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52867>>>>>>>>>>>        Else If (iError_Num = 1108) Error 1108 "DDC 18: ˜¨˜©«˜« ¡æ «¬§à£â¤¦. ƒœ¤ «¨¦§¦§¦ œå«˜ "
52871>>>>>>>>>>>        Else If (iError_Num = 1110) Error 1110 "DDC 18: †£/¤å˜ §˜¨˜©«˜« ¡¦ç <= †£/¤å˜ª ¡¢œ ©å£˜«¦ª\nƒœ¤ œ§ «¨â§œ«˜  ¡˜££å˜ «¨¦§¦§¦åž©ž ©«¦ §˜¨˜©«˜« ¡æ"
52875>>>>>>>>>>>        Else If (iError_Num = 6001) Error 6001 "DDC 18: ƒœ¤ §¨¦¡ç§«œ  §¦©¦ ˜§¦ « £¦¡˜«á¢¦š¦"
52879>>>>>>>>>>>        Else If (iError_Num = 7000) Error 7000 "DDC 18: ¨¦â¨®œ«˜  ˜§¦ ˜¨˜ššœ¢å˜. † š¨˜££ã ˜¬«ã £æ¤¦ › ˜š¨á­œ«˜ "
52883>>>>>>>>>>>        Else If (iError_Num = 7001) Error 7001 "DDC 18: ’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ."
52887>>>>>>>>>>>        Else If (iError_Num = 7005) Error 7005 "DDC 18: † §¦©æ«ž«˜ ›œ¤ «¨¦§¦§¦ œå«˜  š ˜«  §¨¦ã¢Ÿœ ˜§¦ £œ«˜©®ž£˜« ©£æ.\nƒ ˜š¨á¯«œ «¦ §˜¨˜©«˜« ¡æ ¡˜  ¥˜¤˜£œ«˜©®ž£˜«å©«œ «¦ ˜¨® ¡æ."
52891>>>>>>>>>>>        Else If (iError_Num = 8000) Error 8000 "DDC 18: €¡¬¨éŸž¡œ ž ¡˜«˜®é¨ž©ž «¦¬ œå›¦¬ª ˜§¦ «¦¤ ®¨ã©«ž\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52895>>>>>>>>>>>        Else If (iError_Num = 8001) Error 8001 "DDC 18: ƒœ¤ œ§ «¨â§œ«˜  ˜¢¢˜šã œå›¦¬ª\n‹œ«˜ «¦ Ž‰, §˜«ã©«œ F5"
52899>>>>>>>>>>>        Else If (iError_Num = 6655) Error 6655 "DDC 18: ¨¦¡ç§«œ  ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž > ˜¨® ¡ãª §¦©æ«ž«˜ª"
52903>>>>>>>>>>>        Else Forward Send Operation_Not_Allowed  iError_Num
52906>>>>>>>>>>>    End_Procedure   // Operation_Not_Allowed
52907>>>>>>>>>>>
52907>>>>>>>>>>>    Function Validate_Save  Returns Integer
52908>>>>>>>>>>>        Integer iReturnVal iFpaRecnum iYes
52909>>>>>>>>>>>        Number  nInt nqty nQtyKin
52909>>>>>>>>>>>        String  sUserID sOldUserID sOldItem
52909>>>>>>>>>>>
52909>>>>>>>>>>>        Forward Get Validate_Save  To iReturnVal
52911>>>>>>>>>>>
52911>>>>>>>>>>>        If (Not(iReturnVal)) Begin
52913>>>>>>>>>>>
52913>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52913>>>>>>>>>>>        // Egine rem o kodikas pou elegxei to pososto fpa giati sto shmeio ayto
52913>>>>>>>>>>>        // dhmiourgouse parenergeia an o xrhsths allaze to pososto fpa pou erxotan
52913>>>>>>>>>>>        // apo to eidos, tote allaze kai sto record tou eidous
52913>>>>>>>>>>>
52913>>>>>>>>>>>//            If (Pmoves.Pms_VatPct) Begin
52913>>>>>>>>>>>//                Move Fpa.Recnum to iFpaRecnum
52913>>>>>>>>>>>//                Clear Fpa
52913>>>>>>>>>>>//                Move Pmoves.Pms_VatPct      to Fpa.Fpa_Pososto
52913>>>>>>>>>>>//                Find eq Fpa By Index.1 // Fpa:Index.1:Fpa_Pososto
52913>>>>>>>>>>>//                If (Not(Found)) Move 1111 to iReturnVal
52913>>>>>>>>>>>//                If (iFpaRecnum) Begin
52913>>>>>>>>>>>//                    Clear Fpa
52913>>>>>>>>>>>//                    Move iFpaRecnum to Fpa.Recnum
52913>>>>>>>>>>>//                    Find Eq Fpa.Recnum
52913>>>>>>>>>>>//                End
52913>>>>>>>>>>>//            End
52913>>>>>>>>>>>//////////////////////////////////////////////////////////////////////////////////////
52913>>>>>>>>>>>
52913>>>>>>>>>>>                 If (Wax.Recnum          =0) Move 1001 to iReturnVal
52916>>>>>>>>>>>            Else If (Witemx.Recnum       =0) Move 1002 to iReturnVal
52920>>>>>>>>>>>            Else If (Particle.Recnum     =0) Move 1003 to iReturnVal
52924>>>>>>>>>>>            Else If (Pmoves.Pms_Qty      =0) Move 1004 to iReturnVal
52928>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                     Move 1110 to iReturnVal
52932>>>>>>>>>>>            Else Begin
52933>>>>>>>>>>>                //If (Pmoves.Timol_Ypol<0)                        Move 7001 to iReturnVal
52933>>>>>>>>>>>                If (Pmoves.Qty_Kinhshs>Pmoves.Timol_Ypol)  Move 1013 to iReturnVal
52936>>>>>>>>>>>                Else If (Pmoves.Timol_Ypol>Pmoves.Pms_Qty)      Move 6655 to iReturnVal
52940>>>>>>>>>>>                // SOS SOS SOS 24/10/2002 ¨¦©¦¨ ¤˜ Off š ˜«  ®«¬§˜œ  ©« ª ˜¤«¢ œª
52940>>>>>>>>>>>
52940>>>>>>>>>>>//                Else If ((Ptyppar.Ptyppar_Is_What='2') And (Ptyppar.Check_Posa_Plaf='1')) Begin
52940>>>>>>>>>>>//                    If (Pmoves.Posa_Apo_Dap=0) Begin
52940>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52940>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 6001 to iReturnVal
52940>>>>>>>>>>>//                    End
52940>>>>>>>>>>>//                End
52940>>>>>>>>>>>//                Else If ((Clients.Plafon>0) And ;
52940>>>>>>>>>>>//                    ((Clients.Ypoloipo+Pmoves.Posa_Apo_Dap)>Clients.Plafon) And ;
52940>>>>>>>>>>>//                    (Ptyppar.Check_Posa_Plaf='1')) Begin
52940>>>>>>>>>>>//                        Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52940>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1010 to iReturnVal
52940>>>>>>>>>>>//                End
52940>>>>>>>>>>>//                Else If ((PayResp.Plafon>0) And ;
52940>>>>>>>>>>>//                        ((PayResp.Ypoloipo+Pmoves.Posa_Apo_Dap)>PayResp.Plafon) And ;
52940>>>>>>>>>>>//                         (Ptyppar.Check_Posa_Plaf='1')) Begin
52940>>>>>>>>>>>//                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' to iYes
52940>>>>>>>>>>>//                        If (iYes=MBR_NO) Move 1011 to iReturnVal
52940>>>>>>>>>>>//                End
52940>>>>>>>>>>>                Else If ((pmoves.clorderd_recr <> '') and (pifromclorder(self)<>1)) begin //?? Pmoves ???ÿ????š???? ? ???????êœ??
52943>>>>>>>>>>>                    get pnoqty to nqty
52944>>>>>>>>>>>                    if (nqty <> pmoves.pms_qty)                 Move 7000 to iReturnVal
52947>>>>>>>>>>>                End
52947>>>>>>>>>>>>
52947>>>>>>>>>>>
52947>>>>>>>>>>>                Else If ((Pmoves.Qty_Ypol=1) And (piFromMetasx(Self)=0)) begin
52950>>>>>>>>>>>                    // js 28/08/2002
52950>>>>>>>>>>>                    // To pedio Qty_Ypol xrhsimopoihtai gia na flagarei an ena Pmove
52950>>>>>>>>>>>                    // exei proelthei apo metasxhmatismo (Eite sygkentrotika, eite analytika)
52950>>>>>>>>>>>                    // To xrhsimopoihsame ayto gia na mhn anoixtei neo pedio.
52950>>>>>>>>>>>                    // An loipon exei proelthei apo metasxhmatismo DEN epitrepetai tropopoihsh
52950>>>>>>>>>>>                    // ths posothtas tou ap' eutheias alla mono meso ths posothtas mias
52950>>>>>>>>>>>                    // sygkekrimenhs eggrafhs tou arxeiou PmsSxet
52950>>>>>>>>>>>                    If (Operation_Origin=Self) Begin
52952>>>>>>>>>>>                        get pnoqty to nqty
52953>>>>>>>>>>>                        if (nqty <> pmoves.pms_qty)             Move 7005 to iReturnVal
52956>>>>>>>>>>>                        // js 22/12/2003
52956>>>>>>>>>>>                        // Epishs DEN epitrepetai allagh eidous
52956>>>>>>>>>>>                        // Pianoume to bug pou se metasxhmatismeno parastatiko
52956>>>>>>>>>>>                        // mporouse na allaxei to eidos me F7/F8
52956>>>>>>>>>>>                        Get psOldItem to sOldItem
52957>>>>>>>>>>>                        If (Item.Item_Code<>sOldItem) Move 8001 to iReturnVal
52960>>>>>>>>>>>                    End
52960>>>>>>>>>>>>
52960>>>>>>>>>>>                End
52960>>>>>>>>>>>>
52960>>>>>>>>>>>            End
52960>>>>>>>>>>>>
52960>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52963>>>>>>>>>>>        End
52963>>>>>>>>>>>>
52963>>>>>>>>>>>        Function_Return iReturnVal
52964>>>>>>>>>>>    End_Function   // Validate_Save
52965>>>>>>>>>>>
52965>>>>>>>>>>>    Function Validate_Delete  Returns Integer
52966>>>>>>>>>>>        Integer iReturnVal
52967>>>>>>>>>>>        Forward Get Validate_Delete  To iReturnVal
52969>>>>>>>>>>>        If (Not(iReturnVal)) Begin
52971>>>>>>>>>>>            If (Particle.Partl_Timol=1) Move 1009 to iReturnVal
52974>>>>>>>>>>>            Else If ( (Sysfile.Hm_Kleisimatos<>'') And ;                      (Particle.Partl_Hmnia<=Sysfile.Hm_Kleisimatos) ) ;                Move 1110 to iReturnVal
52978>>>>>>>>>>>            Else If ((pmoves.qty_ypol=1) And (Operation_Origin=Self)) Move 1012 to iReturnVal
52982>>>>>>>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
52985>>>>>>>>>>>        End
52985>>>>>>>>>>>>
52985>>>>>>>>>>>        Function_Return iReturnVal
52986>>>>>>>>>>>    End_Function   // Validate_Delete
52987>>>>>>>>>>>
52987>>>>>>>>>>>    Procedure Set_UnitPrice integer iField  Number nNum
52988>>>>>>>>>>>        Local Integer   Changed
52989>>>>>>>>>>>        Local Number    nInt
52989>>>>>>>>>>>        Get Field_Changed_State iField to Changed
52990>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
52992>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
52993>>>>>>>>>>>            Set Field_Default_Value iField to nInt
52994>>>>>>>>>>>        End
52994>>>>>>>>>>>>
52994>>>>>>>>>>>    End_Procedure   // Shmera
52995>>>>>>>>>>>
52995>>>>>>>>>>>    Procedure Set_Discount integer iField  Number nNum
52996>>>>>>>>>>>        Local Integer Changed
52997>>>>>>>>>>>        Local Number nInt
52997>>>>>>>>>>>        Get Field_Changed_State iField to Changed
52998>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
53000>>>>>>>>>>>            Get fnTeleytaiaTimh to nInt
53001>>>>>>>>>>>            If (nInt<0) Begin
53003>>>>>>>>>>>                Move (nInt*(-1)) to nInt
53004>>>>>>>>>>>                Set Field_Default_Value iField to nInt
53005>>>>>>>>>>>            End
53005>>>>>>>>>>>>
53005>>>>>>>>>>>        End
53005>>>>>>>>>>>>
53005>>>>>>>>>>>    End_Procedure   // Shmera
53006>>>>>>>>>>>
53006>>>>>>>>>>>    Procedure Set_FPA integer iField  Number nNum
53007>>>>>>>>>>>        Local Integer Changed
53008>>>>>>>>>>>        Local Number nInt
53008>>>>>>>>>>>        Get Field_Changed_State iField to Changed
53009>>>>>>>>>>>        If (Changed=0 AND nNum=0) Begin
53011>>>>>>>>>>>            Move Item.Fpa_Pososto to nInt
53012>>>>>>>>>>>            Set Field_Default_Value iField to nInt
53013>>>>>>>>>>>        End
53013>>>>>>>>>>>>
53013>>>>>>>>>>>    End_Procedure   // Shmera
53014>>>>>>>>>>>
53014>>>>>>>>>>>    // Define_Fields:
53014>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53014>>>>>>>>>>>
53014>>>>>>>>>>>    Procedure Define_Fields
53015>>>>>>>>>>>        Forward Send Define_Fields
53017>>>>>>>>>>>        //DDB-Generated-Code-Location
53017>>>>>>>>>>>        //DDB-DefineFieldStart
53017>>>>>>>>>>>
53017>>>>>>>>>>>        Set Main_File            To Pmoves.File_Number
53018>>>>>>>>>>>
53018>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53019>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53020>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53021>>>>>>>>>>>
53021>>>>>>>>>>>        // Child (Client) file structure................
53021>>>>>>>>>>>        Send Add_Client_File  Pmsdtl.File_Number
53022>>>>>>>>>>>        Send Add_Client_File  Pmssxet.File_Number
53023>>>>>>>>>>>
53023>>>>>>>>>>>        // Parent (Server) file structure...............
53023>>>>>>>>>>>        Send Add_Server_File  Wax.File_Number
53024>>>>>>>>>>>        Send Add_Server_File  Witemx.File_Number
53025>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53026>>>>>>>>>>>
53026>>>>>>>>>>>        // External (System) file structure.............
53026>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_NEW_SAVE
53027>>>>>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
53028>>>>>>>>>>>        Send Add_System_File  Partlfpa.File_Number  DD_LOCK_ON_ALL
53029>>>>>>>>>>>        Send Add_System_File  Clorder.File_Number  DD_LOCK_ON_ALL
53030>>>>>>>>>>>        Send Add_System_File  Clorderd.File_Number  DD_LOCK_ON_ALL
53031>>>>>>>>>>>        Send Add_System_File  Btnemp.File_Number  DD_LOCK_ON_ALL
53032>>>>>>>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
53033>>>>>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
53034>>>>>>>>>>>
53034>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Pmoves_Rec0  To Pmoves.Pms_Rec0
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Field-based properties.......................
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Company_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Branch_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Year_Year
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Ctypkin_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Wtypkin_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Custprom_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Client_Id
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Cn_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Ptyppar_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Partl_Hmnia
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Pseira_Seira
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Partl_No
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Partl_Rec0
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Witemkat_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Units_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Item_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Witemx_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Wapokat_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Wapomast_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Wax_Code
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Wax_Recr
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Witemx_Recr
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Partl_Recr
53037>>>>>>>>>>>
53037>>>>>>>>>>>        // Pmoves.Pms_Rec0
53037>>>>>>>>>>>        Set Field_Options          Field Pmoves.Pms_Rec0 To DD_AUTOFIND   
53038>>>>>>>>>>>
53038>>>>>>>>>>>        // Pmoves.Pms_No
53038>>>>>>>>>>>
53038>>>>>>>>>>>        // Pmoves.Pms_Recr
53038>>>>>>>>>>>
53038>>>>>>>>>>>        // Pmoves.Pms_Unitcode
53038>>>>>>>>>>>
53038>>>>>>>>>>>        // Pmoves.Pms_Qty
53038>>>>>>>>>>>
53038>>>>>>>>>>>        // Pmoves.Pms_Unitprice
53038>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Unitprice To Set_UnitPrice
53039>>>>>>>>>>>
53039>>>>>>>>>>>        // Pmoves.Pms_Ambd
53039>>>>>>>>>>>
53039>>>>>>>>>>>        // Pmoves.Pms_Pctdisc
53039>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Pctdisc To Set_Discount
53040>>>>>>>>>>>
53040>>>>>>>>>>>        // Pmoves.Pms_Discam
53040>>>>>>>>>>>
53040>>>>>>>>>>>        // Pmoves.Pms_Amaftdisc
53040>>>>>>>>>>>
53040>>>>>>>>>>>        // Pmoves.Pms_Vatpct
53040>>>>>>>>>>>        Set Field_Entry_msg        Field Pmoves.Pms_Vatpct To Set_FPA
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Vatam
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Exrampct
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Exdet
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Payable
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Axia
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_X0
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_P0
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_X00
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_P00
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_X1
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_P1
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_X2
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_P2
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Dlixis
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_A_Code
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Status_E
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Status_A
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_S0
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Ys0
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_S1
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Ys1
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_S2
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Ys2
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Sc_Code2
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Open
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Aopen
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_M_Code
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Yn_Myf
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Myf_Axia
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Kk
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_C_Code2
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Cn_Code
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Wcmoves_Recr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Module
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Btnl2_Recr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Btnemp_Recr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Btarticle_Recr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Sls_Id
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Presp_Id
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Cnt_Id
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Mhxanik_Id
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Extra_Epimer
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Ekpt_Epimer
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Clorderd_Recr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Witemx_Descr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Ptyppar_Descr
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Ti_Typonei_Pms
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Timol_Qty
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Timol_Ypol
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Posa_Apo_Dap
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Qty_Ypol
53041>>>>>>>>>>>
53041>>>>>>>>>>>        // Pmoves.Pms_Selected
53041>>>>>>>>>>>        Set Field_Class_Name       Field Pmoves.Pms_Selected To "dbCheckBoxsub"
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Qty_Kinhshs
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Sx_Parast
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Sx_Hmnia
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Sx_Seira
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Sx_Arithmos
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Pump_Id
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Car_Id
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Item_Ypot
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Qty_Return
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Client_Name
53042>>>>>>>>>>>
53042>>>>>>>>>>>        // Pmoves.Zone
53042>>>>>>>>>>>
53042>>>>>>>>>>>        //DDB-DefineFieldEnd
53042>>>>>>>>>>>    End_Procedure    // Define_Fields
53043>>>>>>>>>>>
53043>>>>>>>>>>>    // Field_Defaults:
53043>>>>>>>>>>>    // This procedure is used to establish default field values.
53043>>>>>>>>>>>
53043>>>>>>>>>>>    Procedure Field_Defaults
53044>>>>>>>>>>>        Forward Send Field_Defaults
53046>>>>>>>>>>>        //DDB-Generated-Code-Location
53046>>>>>>>>>>>        //DDB-FieldDefaultStart
53046>>>>>>>>>>>        //DDB-FieldDefaultEnd
53046>>>>>>>>>>>        //Set Field_Changed_Value Field Pmoves.Pms_VatPct to Item.Fpa_Pososto
53046>>>>>>>>>>>    End_Procedure    // Field_Defaults
53047>>>>>>>>>>>
53047>>>>>>>>>>>End_Class    // Pmoves_DataDictionary
53048>>>>>>>>>>>//DDB-FileEnd
53048>>>>>>>>>    Use PmsDtl.DD
INCLUDING FILE: PMSDTL.DD
53048>>>>>>>>>>>//DDB-FileStart
53048>>>>>>>>>>>//DDB-HeaderStart
53048>>>>>>>>>>>
53048>>>>>>>>>>>// File Name : PmsDtl.DD
53048>>>>>>>>>>>// Class Name: Pmsdtl_DataDictionary
53048>>>>>>>>>>>// Revision  : 0
53048>>>>>>>>>>>// Version   : 2
53048>>>>>>>>>>>
53048>>>>>>>>>>>Use  Windows           // Basic Definitions
53048>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53048>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53048>>>>>>>>>>>
53048>>>>>>>>>>>Open Pmsdtl
53050>>>>>>>>>>>Open Pmoves
53052>>>>>>>>>>>
53052>>>>>>>>>>>//DDB-HeaderEnd
53052>>>>>>>>>>>
53052>>>>>>>>>>>Class Pmsdtl_DataDictionary  is a DataDictionary_Sec
53053>>>>>>>>>>>
53053>>>>>>>>>>>    // Define_Fields:
53053>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53053>>>>>>>>>>>
53053>>>>>>>>>>>    Procedure Define_Fields
53054>>>>>>>>>>>        Forward Send Define_Fields
53056>>>>>>>>>>>        //DDB-Generated-Code-Location
53056>>>>>>>>>>>        //DDB-DefineFieldStart
53056>>>>>>>>>>>
53056>>>>>>>>>>>        Set Main_File            To Pmsdtl.File_Number
53057>>>>>>>>>>>
53057>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53058>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53059>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53060>>>>>>>>>>>
53060>>>>>>>>>>>        // Parent (Server) file structure...............
53060>>>>>>>>>>>        Send Add_Server_File  Pmoves.File_Number
53061>>>>>>>>>>>
53061>>>>>>>>>>>        // Field-based properties.......................
53061>>>>>>>>>>>
53061>>>>>>>>>>>        // Pmsdtl.Pms_Recr
53061>>>>>>>>>>>        Set Field_Options          Field Pmsdtl.Pms_Recr To DD_AUTOFIND   
53062>>>>>>>>>>>        Set Key_Field_State        Field Pmsdtl.Pms_Recr To TRUE
53063>>>>>>>>>>>
53063>>>>>>>>>>>        // Pmsdtl.Line1
53063>>>>>>>>>>>
53063>>>>>>>>>>>        // Pmsdtl.Line2
53063>>>>>>>>>>>
53063>>>>>>>>>>>        // Pmsdtl.Line3
53063>>>>>>>>>>>
53063>>>>>>>>>>>        // Pmsdtl.Line4
53063>>>>>>>>>>>
53063>>>>>>>>>>>        // Pmsdtl.Line5
53063>>>>>>>>>>>
53063>>>>>>>>>>>        //DDB-DefineFieldEnd
53063>>>>>>>>>>>    End_Procedure    // Define_Fields
53064>>>>>>>>>>>
53064>>>>>>>>>>>    // Field_Defaults:
53064>>>>>>>>>>>    // This procedure is used to establish default field values.
53064>>>>>>>>>>>
53064>>>>>>>>>>>    Procedure Field_Defaults
53065>>>>>>>>>>>        Forward Send Field_Defaults
53067>>>>>>>>>>>        //DDB-Generated-Code-Location
53067>>>>>>>>>>>        //DDB-FieldDefaultStart
53067>>>>>>>>>>>        //DDB-FieldDefaultEnd
53067>>>>>>>>>>>    End_Procedure    // Field_Defaults
53068>>>>>>>>>>>
53068>>>>>>>>>>>End_Class    // Pmsdtl_DataDictionary
53069>>>>>>>>>>>//DDB-FileEnd
53069>>>>>>>>>    Use BAXIOKAT.DD
53069>>>>>>>>>    Use SYSCURXR.DD
53069>>>>>>>>>    Use PMSSXET.DD
53069>>>>>>>>>    Use SALESMEN.DD
INCLUDING FILE: SALESMEN.DD
53069>>>>>>>>>>>//DDB-FileStart
53069>>>>>>>>>>>//DDB-HeaderStart
53069>>>>>>>>>>>
53069>>>>>>>>>>>// File Name : SALESMEN.DD
53069>>>>>>>>>>>// Class Name: Salesmen_DataDictionary
53069>>>>>>>>>>>// Revision  : 57
53069>>>>>>>>>>>// Version   : 2
53069>>>>>>>>>>>
53069>>>>>>>>>>>Use  Windows           // Basic Definitions
53069>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53069>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53069>>>>>>>>>>>
53069>>>>>>>>>>>Open Salesmen
53071>>>>>>>>>>>Open Cn
53073>>>>>>>>>>>Open Sysrecc
53075>>>>>>>>>>>
53075>>>>>>>>>>>//DDB-HeaderEnd
53075>>>>>>>>>>>//DDB-ValidationStart
53075>>>>>>>>>>>
53075>>>>>>>>>>>Register_Object Salesmen_Sls_Doy_VT
53075>>>>>>>>>>>
53075>>>>>>>>>>>Object Salesmen_Sls_Doy_VT  is a CodeValidationTable
53077>>>>>>>>>>>    Set Type_Value        To "DOY"
53078>>>>>>>>>>>    Set Allow_Blank_State To TRUE
53079>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
53080>>>>>>>>>>>    //DDB-ValidationCustomStart
53080>>>>>>>>>>>    //DDB-ValidationCustomEnd
53080>>>>>>>>>>>End_Object   // Salesmen_Sls_Doy_VT
53081>>>>>>>>>>>//DDB-ValidationEnd
53081>>>>>>>>>>>//DDB-SelectionStart
53081>>>>>>>>>>>//DDB/ ExternalSelectionList sl108  sl108.sl
53081>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
53081>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
53081>>>>>>>>>>>Register_Object sl108
53081>>>>>>>>>>>Register_Object sl198
53081>>>>>>>>>>>Register_Object sl197
53081>>>>>>>>>>>//DDB-SelectionEnd
53081>>>>>>>>>>>
53081>>>>>>>>>>>Class Salesmen_DataDictionary  is a DataDictionary_Sec
53082>>>>>>>>>>> 
53082>>>>>>>>>>>    // Save_Main_File:
53082>>>>>>>>>>> 
53082>>>>>>>>>>>    Procedure Save_Main_File
53083>>>>>>>>>>>        If ((Operation_Origin<>Self) And (Salesmen.Sls_ID='')) Procedure_Return
53086>>>>>>>>>>>        Forward Send Save_Main_File
53088>>>>>>>>>>>    End_Procedure   // Save_Main_File
53089>>>>>>>>>>> 
53089>>>>>>>>>>>    // Define_Fields:
53089>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53089>>>>>>>>>>>     Procedure Update
53090>>>>>>>>>>>        Forward Send Update
53092>>>>>>>>>>>        // Insert Code Here
53092>>>>>>>>>>>        Move SysCurXR.Company_Code  to salesmen.Company_Code
53093>>>>>>>>>>>        Move SysCurXR.Branch_Code   to salesmen.Branch_Code
53094>>>>>>>>>>>        Move SysCurXR.Year_Year     to salesmen.Year_Year
53095>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
53095>>>>>>>>>>>        Move (salesmen.Xreosh-salesmen.Pistosh)   to salesmen.Ypoloipo
53096>>>>>>>>>>>        Move (salesmen.Plafon-salesmen.ypoloipo)  to salesmen.Overhead
53097>>>>>>>>>>>
53097>>>>>>>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
53097>>>>>>>>>>>
53097>>>>>>>>>>>        //betolink
53097>>>>>>>>>>>        Move SysCurXR.Beto_Site      to salesmen.sls_SiteW
53098>>>>>>>>>>>        Move salesmen.sls_Rec0       to salesmen.sls_SN
53099>>>>>>>>>>>        Move salesmen.sls_id         to salesmen.sls_Repm
53100>>>>>>>>>>>
53100>>>>>>>>>>>    End_Procedure   // Update
53101>>>>>>>>>>>
53101>>>>>>>>>>>     Procedure Creating
53102>>>>>>>>>>>        Forward Send Creating
53104>>>>>>>>>>>        // Insert Code Here
53104>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(salesmen.sls_Rec0))))));                                    to salesmen.sls_Recr
53105>>>>>>>>>>>        Move '1'                    to salesmen.sls_Active
53106>>>>>>>>>>>        get fsgCode_With_Zeroes salesmen.sls_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to salesmen.sls_ID
53107>>>>>>>>>>>    End_Procedure   // Creating
53108>>>>>>>>>>>
53108>>>>>>>>>>>    Procedure Define_Fields
53109>>>>>>>>>>>        Forward Send Define_Fields
53111>>>>>>>>>>>        //DDB-Generated-Code-Location
53111>>>>>>>>>>>        //DDB-DefineFieldStart
53111>>>>>>>>>>>
53111>>>>>>>>>>>        Set Main_File            To Salesmen.File_Number
53112>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
53113>>>>>>>>>>>
53113>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53114>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53115>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53116>>>>>>>>>>>
53116>>>>>>>>>>>        // Child (Client) file structure................
53116>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
53117>>>>>>>>>>>
53117>>>>>>>>>>>        // External (System) file structure.............
53117>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53118>>>>>>>>>>>
53118>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Salesmen_Rec0  To Salesmen.Sls_Rec0
53121>>>>>>>>>>>
53121>>>>>>>>>>>        // Field-based properties.......................
53121>>>>>>>>>>>
53121>>>>>>>>>>>        // Salesmen.Company_Code
53121>>>>>>>>>>>
53121>>>>>>>>>>>        // Salesmen.Branch_Code
53121>>>>>>>>>>>
53121>>>>>>>>>>>        // Salesmen.Year_Year
53121>>>>>>>>>>>
53121>>>>>>>>>>>        // Salesmen.Sls_Id
53121>>>>>>>>>>>        Set Field_Options          Field Salesmen.Sls_Id To DD_AUTOFIND    DD_FINDREQ    
53122>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Id To (sl108(Self))
53123>>>>>>>>>>>        Set Key_Field_State        Field Salesmen.Sls_Id To TRUE
53124>>>>>>>>>>>
53124>>>>>>>>>>>        // Salesmen.Sls_Name
53124>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Name To (sl108(Self))
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Sls_Afm
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Sls_Rec0
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Sls_Recr
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Last_Xreosh
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Last_Pistosh
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Last_Order
53125>>>>>>>>>>>
53125>>>>>>>>>>>        // Salesmen.Sls_Doy
53125>>>>>>>>>>>        Set Field_Value_Table      Field Salesmen.Sls_Doy To (Salesmen_Sls_Doy_VT(Self))
53126>>>>>>>>>>>
53126>>>>>>>>>>>        // Salesmen.Sls_Address
53126>>>>>>>>>>>
53126>>>>>>>>>>>        // Salesmen.Sls_City
53126>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_City To (sl198(Self))
53127>>>>>>>>>>>
53127>>>>>>>>>>>        // Salesmen.Sls_Area
53127>>>>>>>>>>>        Set Field_Prompt_Object    Field Salesmen.Sls_Area To (sl197(Self))
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Job
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Respons
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Zipcode
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Phone
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Fax
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Mobile
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Aoh
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Email
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Class
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Details
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Sitew
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Codem
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Categfpa
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Fpa
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Public
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Sn
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Repm
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Active
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Reported
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Lastupd
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Markexp
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Catjob
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Xreosh
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Pistosh
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Ypoloipo
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Plafon
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Overhead
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Add_No
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Nomos
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Sls_Xora
53128>>>>>>>>>>>
53128>>>>>>>>>>>        // Salesmen.Polh_Recr
53128>>>>>>>>>>>
53128>>>>>>>>>>>        //DDB-DefineFieldEnd
53128>>>>>>>>>>>    End_Procedure    // Define_Fields
53129>>>>>>>>>>>
53129>>>>>>>>>>>    // Field_Defaults:
53129>>>>>>>>>>>    // This procedure is used to establish default field values.
53129>>>>>>>>>>>
53129>>>>>>>>>>>    Procedure Field_Defaults
53130>>>>>>>>>>>        Forward Send Field_Defaults
53132>>>>>>>>>>>        //DDB-Generated-Code-Location
53132>>>>>>>>>>>        //DDB-FieldDefaultStart
53132>>>>>>>>>>>        Set Field_Changed_Value   Field Salesmen.Sls_Doy To "0"
53133>>>>>>>>>>>        //DDB-FieldDefaultEnd
53133>>>>>>>>>>>    End_Procedure    // Field_Defaults
53134>>>>>>>>>>>
53134>>>>>>>>>>>End_Class    // Salesmen_DataDictionary
53135>>>>>>>>>>>//DDB-Selection-pkg-Start
53135>>>>>>>>>>>
53135>>>>>>>>>>>Use sl108.sl         // sl108
INCLUDING FILE: SL108.SL
53135>>>>>>>>>>>>>//AB/ Project sl108:polhtes
53135>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
53135>>>>>>>>>>>>>//AB/     Set ProjectName to "sl108:polhtes"
53135>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl108.SL"
53135>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>// Project Object Structure
53135>>>>>>>>>>>>>//   sl108 is a dbModalPanelSub
53135>>>>>>>>>>>>>//     Salesmen_DD is a DataDictionary
53135>>>>>>>>>>>>>//     oSelList is a dbListSub
53135>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
53135>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
53135>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>// Register all objects
53135>>>>>>>>>>>>>Register_Object oCancel_bn
53135>>>>>>>>>>>>>Register_Object oOK_bn
53135>>>>>>>>>>>>>Register_Object oSearch_bn
53135>>>>>>>>>>>>>Register_Object oSelList
53135>>>>>>>>>>>>>Register_Object Salesmen_DD
53135>>>>>>>>>>>>>Register_Object sl108
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>//AB-IgnoreStart
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>Use DFAllEnt.pkg
53135>>>>>>>>>>>>>Use dbList.Sub
53135>>>>>>>>>>>>>Use Button.Sub
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>Use SALESMEN.DD
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>//AB-IgnoreEnd
53135>>>>>>>>>>>>>
53135>>>>>>>>>>>>>Object sl108 is a dbModalPanelSub
53137>>>>>>>>>>>>>    Set Label to "‹ž«¨é¦ à¢ž«é¤"
53138>>>>>>>>>>>>>    Set Size to 148 421
53139>>>>>>>>>>>>>    Set Location to 4 5
53140>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
53141>>>>>>>>>>>>>    Set Modal_State to FALSE
53142>>>>>>>>>>>>>
53142>>>>>>>>>>>>>    //AB-DDOStart
53142>>>>>>>>>>>>>
53142>>>>>>>>>>>>>    Object Salesmen_DD is a Salesmen_DataDictionary
53144>>>>>>>>>>>>>    End_Object    // Salesmen_DD
53145>>>>>>>>>>>>>
53145>>>>>>>>>>>>>    Set Main_DD to (Salesmen_DD(self))
53146>>>>>>>>>>>>>    Set Server to (Salesmen_DD(self))
53147>>>>>>>>>>>>>
53147>>>>>>>>>>>>>    //AB-DDOEnd
53147>>>>>>>>>>>>>
53147>>>>>>>>>>>>>    Object oSelList is a dbListSub
53149>>>>>>>>>>>>>        Set Main_File to Salesmen.File_Number
53150>>>>>>>>>>>>>        Set Size to 105 408
53151>>>>>>>>>>>>>        Set Location to 6 6
53152>>>>>>>>>>>>>
53152>>>>>>>>>>>>>        Begin_Row
53155>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_id
53156>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_name
53157>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_afm
53158>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_address
53159>>>>>>>>>>>>>            Entry_Item Salesmen.Sls_phone
53160>>>>>>>>>>>>>        End_Row
53165>>>>>>>>>>>>>
53165>>>>>>>>>>>>>        Set Form_Width    item 0 to 60
53166>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡¦ª"
53167>>>>>>>>>>>>>        
53167>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
53168>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
53169>>>>>>>>>>>>>        
53169>>>>>>>>>>>>>        Set Form_Width    item 2 to 60
53170>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
53171>>>>>>>>>>>>>        
53171>>>>>>>>>>>>>        Set Form_Width    item 3 to 125
53172>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
53173>>>>>>>>>>>>>        
53173>>>>>>>>>>>>>        Set Form_Width    item 4 to 54
53174>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
53175>>>>>>>>>>>>>        
53175>>>>>>>>>>>>>    End_Object    // oSelList
53176>>>>>>>>>>>>>
53176>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
53178>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
53179>>>>>>>>>>>>>        Set Location to 117 255
53180>>>>>>>>>>>>>
53180>>>>>>>>>>>>>        //AB-StoreStart
53180>>>>>>>>>>>>>        Procedure OnClick
53182>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
53183>>>>>>>>>>>>>        End_Procedure
53184>>>>>>>>>>>>>        //AB-StoreEnd
53184>>>>>>>>>>>>>
53184>>>>>>>>>>>>>    End_Object    // oOK_bn
53185>>>>>>>>>>>>>
53185>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
53187>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
53188>>>>>>>>>>>>>        Set Location to 117 310
53189>>>>>>>>>>>>>
53189>>>>>>>>>>>>>        //AB-StoreStart
53189>>>>>>>>>>>>>        Procedure OnClick
53191>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
53192>>>>>>>>>>>>>        End_Procedure
53193>>>>>>>>>>>>>        //AB-StoreEnd
53193>>>>>>>>>>>>>
53193>>>>>>>>>>>>>    End_Object    // oCancel_bn
53194>>>>>>>>>>>>>
53194>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
53196>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
53197>>>>>>>>>>>>>        Set Location to 117 365
53198>>>>>>>>>>>>>
53198>>>>>>>>>>>>>        //AB-StoreStart
53198>>>>>>>>>>>>>        Procedure OnClick
53200>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
53201>>>>>>>>>>>>>        End_Procedure
53202>>>>>>>>>>>>>        //AB-StoreEnd
53202>>>>>>>>>>>>>
53202>>>>>>>>>>>>>    End_Object    // oSearch_bn
53203>>>>>>>>>>>>>
53203>>>>>>>>>>>>>
53203>>>>>>>>>>>>>    //AB-StoreStart
53203>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
53204>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
53205>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
53206>>>>>>>>>>>>>    //AB-StoreEnd
53206>>>>>>>>>>>>>
53206>>>>>>>>>>>>>End_Object    // sl108
53207>>>>>>>>>>>>>
53207>>>>>>>>>>>>>//AB/ End_Object    // prj
53207>>>>>>>>>>>Use sl198.sl         // sl198
53207>>>>>>>>>>>Use sl197.SL         // sl197
53207>>>>>>>>>>>
53207>>>>>>>>>>>//DDB-Selection-pkg-End
53207>>>>>>>>>>>//DDB-FileEnd
53207>>>>>>>>>    Use CONSTRCT.DD
INCLUDING FILE: CONSTRCT.DD
53207>>>>>>>>>>>//DDB-FileStart
53207>>>>>>>>>>>//DDB-HeaderStart
53207>>>>>>>>>>>
53207>>>>>>>>>>>// File Name : CONSTRCT.DD
53207>>>>>>>>>>>// Class Name: Constrct_DataDictionary
53207>>>>>>>>>>>// Revision  : 49
53207>>>>>>>>>>>// Version   : 2
53207>>>>>>>>>>>
53207>>>>>>>>>>>Use  Windows           // Basic Definitions
53207>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53207>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53207>>>>>>>>>>>
53207>>>>>>>>>>>Open Constrct
53209>>>>>>>>>>>Open Cn
53211>>>>>>>>>>>Open Sysrecc
53213>>>>>>>>>>>
53213>>>>>>>>>>>//DDB-HeaderEnd
53213>>>>>>>>>>>//DDB-ValidationStart
53213>>>>>>>>>>>
53213>>>>>>>>>>>Register_Object Constrct_Cnt_Doy_VT1
53213>>>>>>>>>>>
53213>>>>>>>>>>>Object Constrct_Cnt_Doy_VT1  is a CodeValidationTable
53215>>>>>>>>>>>    Set Type_Value        To "DOY"
53216>>>>>>>>>>>    Set Allow_Blank_State To TRUE
53217>>>>>>>>>>>    Set Table_Title       To "€¨®œå¦ ƒ.Ž.“"
53218>>>>>>>>>>>    //DDB-ValidationCustomStart
53218>>>>>>>>>>>    //DDB-ValidationCustomEnd
53218>>>>>>>>>>>End_Object   // Constrct_Cnt_Doy_VT1
53219>>>>>>>>>>>//DDB-ValidationEnd
53219>>>>>>>>>>>//DDB-SelectionStart
53219>>>>>>>>>>>//DDB/ ExternalSelectionList sl109  sl109.SL
53219>>>>>>>>>>>//DDB/ ExternalSelectionList sl198  sl198.sl
53219>>>>>>>>>>>//DDB/ ExternalSelectionList sl197  sl197.SL
53219>>>>>>>>>>>Register_Object sl109
53219>>>>>>>>>>>Register_Object sl198
53219>>>>>>>>>>>Register_Object sl197
53219>>>>>>>>>>>//DDB-SelectionEnd
53219>>>>>>>>>>>
53219>>>>>>>>>>>Class Constrct_DataDictionary  is a DataDictionary_Sec
53220>>>>>>>>>>>    Procedure Update
53221>>>>>>>>>>>        Forward Send Update
53223>>>>>>>>>>>        // Insert Code Here
53223>>>>>>>>>>>        Move SysCurXR.Company_Code  to constrct.Company_Code
53224>>>>>>>>>>>        Move SysCurXR.Branch_Code   to constrct.Branch_Code
53225>>>>>>>>>>>        Move SysCurXR.Year_Year     to constrct.Year_Year
53226>>>>>>>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
53226>>>>>>>>>>>        Move (constrct.Xreosh-Constrct.Pistosh)   to Constrct.Ypoloipo
53227>>>>>>>>>>>        Move (constrct.Plafon-Constrct.Ypoloipo)  to Constrct.Overhead
53228>>>>>>>>>>>
53228>>>>>>>>>>>        //betolink
53228>>>>>>>>>>>        Move SysCurXR.Beto_Site      to Constrct.cnt_SiteW
53229>>>>>>>>>>>        Move Constrct.cnt_Rec0        to Constrct.cnt_SN
53230>>>>>>>>>>>        Move Constrct.cnt_id          to constrct.cnt_Repm
53231>>>>>>>>>>>
53231>>>>>>>>>>>    End_Procedure   // Update
53232>>>>>>>>>>>
53232>>>>>>>>>>>     Procedure Creating
53233>>>>>>>>>>>        Forward Send Creating
53235>>>>>>>>>>>        // Insert Code Here
53235>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Constrct.cnt_Rec0))))));                                    to Constrct.Cnt_Recr
53236>>>>>>>>>>>        Move '1'                    to Constrct.Cnt_Active
53237>>>>>>>>>>>        Get fsgCode_With_Zeroes Constrct.Cnt_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Constrct.cnt_ID
53238>>>>>>>>>>>    End_Procedure   // Creating
53239>>>>>>>>>>>
53239>>>>>>>>>>>
53239>>>>>>>>>>>    Procedure Define_Fields
53240>>>>>>>>>>>        Forward Send Define_Fields
53242>>>>>>>>>>>        //DDB-Generated-Code-Location
53242>>>>>>>>>>>        //DDB-DefineFieldStart
53242>>>>>>>>>>>
53242>>>>>>>>>>>        Set Main_File            To Constrct.File_Number
53243>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
53244>>>>>>>>>>>
53244>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53245>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53246>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53247>>>>>>>>>>>
53247>>>>>>>>>>>        // Child (Client) file structure................
53247>>>>>>>>>>>        Send Add_Client_File  Cn.File_Number
53248>>>>>>>>>>>
53248>>>>>>>>>>>        // External (System) file structure.............
53248>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53249>>>>>>>>>>>
53249>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Constrct_Rec0  To Constrct.Cnt_Rec0
53252>>>>>>>>>>>
53252>>>>>>>>>>>        // Field-based properties.......................
53252>>>>>>>>>>>
53252>>>>>>>>>>>        // Constrct.Company_Code
53252>>>>>>>>>>>
53252>>>>>>>>>>>        // Constrct.Branch_Code
53252>>>>>>>>>>>
53252>>>>>>>>>>>        // Constrct.Year_Year
53252>>>>>>>>>>>
53252>>>>>>>>>>>        // Constrct.Cnt_Id
53252>>>>>>>>>>>        Set Field_Options          Field Constrct.Cnt_Id To DD_AUTOFIND    DD_NOPUT      
53253>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Id To (sl109(Self))
53254>>>>>>>>>>>        Set Key_Field_State        Field Constrct.Cnt_Id To TRUE
53255>>>>>>>>>>>
53255>>>>>>>>>>>        // Constrct.Cnt_Name
53255>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Name To (sl109(Self))
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Cnt_Afm
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Cnt_Rec0
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Cnt_Recr
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Last_Xreosh
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Last_Pistosh
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Last_Order
53256>>>>>>>>>>>
53256>>>>>>>>>>>        // Constrct.Cnt_Doy
53256>>>>>>>>>>>        Set Field_Value_Table      Field Constrct.Cnt_Doy To (Constrct_Cnt_Doy_VT1(Self))
53257>>>>>>>>>>>
53257>>>>>>>>>>>        // Constrct.Cnt_Address
53257>>>>>>>>>>>
53257>>>>>>>>>>>        // Constrct.Cnt_City
53257>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_City To (sl198(Self))
53258>>>>>>>>>>>
53258>>>>>>>>>>>        // Constrct.Cnt_Area
53258>>>>>>>>>>>        Set Field_Prompt_Object    Field Constrct.Cnt_Area To (sl197(Self))
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Job
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Respons
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Zipcode
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Phone
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Fax
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Mobile
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Aoh
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Email
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Class
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Details
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Sitew
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Codem
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Categfpa
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Fpa
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Public
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Sn
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Repm
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Active
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Reported
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Pelprom
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Lastupdated
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Markexp
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Catjob
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Xreosh
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Pistosh
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Ypoloipo
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Plafon
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Overhead
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Add_No
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Nomos
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Cnt_Xora
53259>>>>>>>>>>>
53259>>>>>>>>>>>        // Constrct.Polh_Recr
53259>>>>>>>>>>>
53259>>>>>>>>>>>        //DDB-DefineFieldEnd
53259>>>>>>>>>>>    End_Procedure    // Define_Fields
53260>>>>>>>>>>>
53260>>>>>>>>>>>    // Field_Defaults:
53260>>>>>>>>>>>    // This procedure is used to establish default field values.
53260>>>>>>>>>>>
53260>>>>>>>>>>>    Procedure Field_Defaults
53261>>>>>>>>>>>        Forward Send Field_Defaults
53263>>>>>>>>>>>        //DDB-Generated-Code-Location
53263>>>>>>>>>>>        //DDB-FieldDefaultStart
53263>>>>>>>>>>>        Set Field_Changed_Value   Field Constrct.Cnt_Doy To "0"
53264>>>>>>>>>>>        //DDB-FieldDefaultEnd
53264>>>>>>>>>>>    End_Procedure    // Field_Defaults
53265>>>>>>>>>>>
53265>>>>>>>>>>>End_Class    // Constrct_DataDictionary
53266>>>>>>>>>>>//DDB-Selection-pkg-Start
53266>>>>>>>>>>>
53266>>>>>>>>>>>Use sl109.SL         // sl109
INCLUDING FILE: SL109.SL
53266>>>>>>>>>>>>>//AB/ Project sl109
53266>>>>>>>>>>>>>//AB/ Object prj is a Lookup_Project
53266>>>>>>>>>>>>>//AB/     Set ProjectName to "sl109"
53266>>>>>>>>>>>>>//AB/     Set ProjectFileName to "sl109.SL"
53266>>>>>>>>>>>>>//AB/     Set GenerateFileName to "NONAME"
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>// Project Object Structure
53266>>>>>>>>>>>>>//   sl109 is a dbModalPanelSub
53266>>>>>>>>>>>>>//     Constrct_DD is a DataDictionary
53266>>>>>>>>>>>>>//     oSelList is a dbListSub
53266>>>>>>>>>>>>>//     oOK_bn is a ButtonSub
53266>>>>>>>>>>>>>//     oCancel_bn is a ButtonSub
53266>>>>>>>>>>>>>//     oSearch_bn is a ButtonSub
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>// Register all objects
53266>>>>>>>>>>>>>Register_Object Constrct_DD
53266>>>>>>>>>>>>>Register_Object oCancel_bn
53266>>>>>>>>>>>>>Register_Object oOK_bn
53266>>>>>>>>>>>>>Register_Object oSearch_bn
53266>>>>>>>>>>>>>Register_Object oSelList
53266>>>>>>>>>>>>>Register_Object sl109
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>//AB-IgnoreStart
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>Use DFAllEnt.pkg
53266>>>>>>>>>>>>>Use dbList.Sub
53266>>>>>>>>>>>>>Use Button.Sub
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>Use CONSTRCT.DD
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>//AB-IgnoreEnd
53266>>>>>>>>>>>>>
53266>>>>>>>>>>>>>Object sl109 is a dbModalPanelSub
53268>>>>>>>>>>>>>    Set Label to "„¨š¦¢á™¦  "
53269>>>>>>>>>>>>>    Set Size to 148 427
53270>>>>>>>>>>>>>    Set Location to 4 5
53271>>>>>>>>>>>>>    Set Exit_Application_Local_State to FALSE
53272>>>>>>>>>>>>>    Set Modal_State to FALSE
53273>>>>>>>>>>>>>
53273>>>>>>>>>>>>>    //AB-DDOStart
53273>>>>>>>>>>>>>
53273>>>>>>>>>>>>>    Object Constrct_DD is a Constrct_DataDictionary
53275>>>>>>>>>>>>>    End_Object    // Constrct_DD
53276>>>>>>>>>>>>>
53276>>>>>>>>>>>>>    Set Main_DD to (Constrct_DD(self))
53277>>>>>>>>>>>>>    Set Server to (Constrct_DD(self))
53278>>>>>>>>>>>>>
53278>>>>>>>>>>>>>    //AB-DDOEnd
53278>>>>>>>>>>>>>
53278>>>>>>>>>>>>>    Object oSelList is a dbListSub
53280>>>>>>>>>>>>>        Set Main_File to Constrct.File_Number
53281>>>>>>>>>>>>>        Set Size to 105 415
53282>>>>>>>>>>>>>        Set Location to 6 6
53283>>>>>>>>>>>>>
53283>>>>>>>>>>>>>        Begin_Row
53286>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_id
53287>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_name
53288>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_afm
53289>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_address
53290>>>>>>>>>>>>>            Entry_Item Constrct.Cnt_phone
53291>>>>>>>>>>>>>        End_Row
53296>>>>>>>>>>>>>
53296>>>>>>>>>>>>>        Set Form_Width    item 0 to 70
53297>>>>>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
53298>>>>>>>>>>>>>        
53298>>>>>>>>>>>>>        Set Form_Width    item 1 to 100
53299>>>>>>>>>>>>>        Set Header_Label  item 1 to "„§à¤¬£å˜"
53300>>>>>>>>>>>>>        
53300>>>>>>>>>>>>>        Set Form_Width    item 2 to 50
53301>>>>>>>>>>>>>        Set Header_Label  item 2 to "€.”.‹"
53302>>>>>>>>>>>>>        
53302>>>>>>>>>>>>>        Set Form_Width    item 3 to 135
53303>>>>>>>>>>>>>        Set Header_Label  item 3 to "ƒ œçŸ¬¤©ž"
53304>>>>>>>>>>>>>        
53304>>>>>>>>>>>>>        Set Form_Width    item 4 to 52
53305>>>>>>>>>>>>>        Set Header_Label  item 4 to "’ž¢â­à¤¦"
53306>>>>>>>>>>>>>        
53306>>>>>>>>>>>>>    End_Object    // oSelList
53307>>>>>>>>>>>>>
53307>>>>>>>>>>>>>    Object oOK_bn is a ButtonSub
53309>>>>>>>>>>>>>        Set Label to "&„§ ¢¦šã"
53310>>>>>>>>>>>>>        Set Location to 116 261
53311>>>>>>>>>>>>>
53311>>>>>>>>>>>>>        //AB-StoreStart
53311>>>>>>>>>>>>>        Procedure OnClick
53313>>>>>>>>>>>>>            Send OK To (oSelList(current_object))
53314>>>>>>>>>>>>>        End_Procedure
53315>>>>>>>>>>>>>        //AB-StoreEnd
53315>>>>>>>>>>>>>
53315>>>>>>>>>>>>>    End_Object    // oOK_bn
53316>>>>>>>>>>>>>
53316>>>>>>>>>>>>>    Object oCancel_bn is a ButtonSub
53318>>>>>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
53319>>>>>>>>>>>>>        Set Location to 116 315
53320>>>>>>>>>>>>>
53320>>>>>>>>>>>>>        //AB-StoreStart
53320>>>>>>>>>>>>>        Procedure OnClick
53322>>>>>>>>>>>>>            Send Cancel To (oSelList(current_object))
53323>>>>>>>>>>>>>        End_Procedure
53324>>>>>>>>>>>>>        //AB-StoreEnd
53324>>>>>>>>>>>>>
53324>>>>>>>>>>>>>    End_Object    // oCancel_bn
53325>>>>>>>>>>>>>
53325>>>>>>>>>>>>>    Object oSearch_bn is a ButtonSub
53327>>>>>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
53328>>>>>>>>>>>>>        Set Location to 116 371
53329>>>>>>>>>>>>>
53329>>>>>>>>>>>>>        //AB-StoreStart
53329>>>>>>>>>>>>>        Procedure OnClick
53331>>>>>>>>>>>>>            Send Search To (oSelList(current_object))
53332>>>>>>>>>>>>>        End_Procedure
53333>>>>>>>>>>>>>        //AB-StoreEnd
53333>>>>>>>>>>>>>
53333>>>>>>>>>>>>>    End_Object    // oSearch_bn
53334>>>>>>>>>>>>>
53334>>>>>>>>>>>>>
53334>>>>>>>>>>>>>    //AB-StoreStart
53334>>>>>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
53335>>>>>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
53336>>>>>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
53337>>>>>>>>>>>>>    //AB-StoreEnd
53337>>>>>>>>>>>>>
53337>>>>>>>>>>>>>End_Object    // sl109
53338>>>>>>>>>>>>>
53338>>>>>>>>>>>>>//AB/ End_Object    // prj
53338>>>>>>>>>>>Use sl198.sl         // sl198
53338>>>>>>>>>>>Use sl197.SL         // sl197
53338>>>>>>>>>>>
53338>>>>>>>>>>>//DDB-Selection-pkg-End
53338>>>>>>>>>>>//DDB-FileEnd
53338>>>>>>>>>    Use CN.DD
53338>>>>>>>>>    Use PSXETIKA.DD
INCLUDING FILE: PSXETIKA.DD
53338>>>>>>>>>>>//DDB-FileStart
53338>>>>>>>>>>>//DDB-HeaderStart
53338>>>>>>>>>>>
53338>>>>>>>>>>>// File Name : PSXETIKA.DD
53338>>>>>>>>>>>// Class Name: Psxetika_DataDictionary
53338>>>>>>>>>>>// Revision  : 14
53338>>>>>>>>>>>// Version   : 2
53338>>>>>>>>>>>
53338>>>>>>>>>>>Use  Windows           // Basic Definitions
53338>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53338>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53338>>>>>>>>>>>
53338>>>>>>>>>>>Open Psxetika
53340>>>>>>>>>>>Open Particle
53342>>>>>>>>>>>Open Sysrecp
53344>>>>>>>>>>>
53344>>>>>>>>>>>//DDB-HeaderEnd
53344>>>>>>>>>>>
53344>>>>>>>>>>>Class Psxetika_DataDictionary  is a DataDictionary_Sec
53345>>>>>>>>>>>
53345>>>>>>>>>>>    Procedure Creating
53346>>>>>>>>>>>        Integer iNextNo
53347>>>>>>>>>>>        Forward Send Creating
53349>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Psxetika.Psxetika_Rec0)))))) to Psxetika.Psxetika_Recr
53350>>>>>>>>>>>    End_Procedure   // Creating
53351>>>>>>>>>>>
53351>>>>>>>>>>>    Procedure Update
53352>>>>>>>>>>>        Forward Send Update
53354>>>>>>>>>>>        Move SysCurXR.Company_Code  to Psxetika.Company_Code
53355>>>>>>>>>>>        Move SysCurXR.Branch_Code   to Psxetika.Branch_Code
53356>>>>>>>>>>>        Move SysCurXR.Year_Year     to Psxetika.Year_Year
53357>>>>>>>>>>>        Move Clients.Client_ID      to Psxetika.Client_ID
53358>>>>>>>>>>>        Move Ctypkin.Ctypkin_Code   to Psxetika.Ctypkin_Code
53359>>>>>>>>>>>        Move Wtypkin.Wtypkin_Code   to Psxetika.Wtypkin_Code
53360>>>>>>>>>>>        Move Ptyppar.Ptyppar_Code   to Psxetika.Ptyppar_Code
53361>>>>>>>>>>>        Move Particle.Partl_Hmnia   to Psxetika.Partl_Hmnia
53362>>>>>>>>>>>        Move Particle.Pseira_Seira  to Psxetika.Pseira_Seira
53363>>>>>>>>>>>        Move Particle.Partl_No      to Psxetika.Partl_No
53364>>>>>>>>>>>    End_Procedure   // Update
53365>>>>>>>>>>>
53365>>>>>>>>>>>
53365>>>>>>>>>>>    Procedure Request_Save
53366>>>>>>>>>>>        Number  nQty
53367>>>>>>>>>>>        String  sParticleRecr sPsxetikaRecr
53367>>>>>>>>>>>
53367>>>>>>>>>>>        Forward Send Request_Save
53369>>>>>>>>>>>
53369>>>>>>>>>>>        Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
53370>>>>>>>>>>>        Get File_Field_Current_Value File_Field Psxetika.Psx_Partl_Recr to sPsxetikaRecr
53371>>>>>>>>>>>        If ((Trim(sParticleRecr)<>'') And (Trim(sPsxetikaRecr)<>'')) Begin
53373>>>>>>>>>>>            Get File_Field_Current_Value File_Field Psxetika.Pms_Sx_Qty to nQty
53374>>>>>>>>>>>            If (nQty=0) Begin
53376>>>>>>>>>>>                // An h posothta pou menei apo to athroisma posothtas ton Pmoves Sxetika
53376>>>>>>>>>>>                // Mhdenisei, ayto shmainei pos den yparxoun alla Pmoves Sxetika, ara
53376>>>>>>>>>>>                // prepei na diagrafei ayto to Psxetika record kai to antistrofo tou.
53376>>>>>>>>>>>                Delete Psxetika
53377>>>>>>>>>>>                Clear Psxetika
53378>>>>>>>>>>>                Move sPsxetikaRecr  to Psxetika.Partl_Recr
53379>>>>>>>>>>>                Move sParticleRecr  to Psxetika.Psx_Partl_Recr
53380>>>>>>>>>>>                Find Eq Psxetika by Index.4
53381>>>>>>>>>>>>
53381>>>>>>>>>>>                If (Found) Delete Psxetika
53384>>>>>>>>>>>            End
53384>>>>>>>>>>>>
53384>>>>>>>>>>>        End
53384>>>>>>>>>>>>
53384>>>>>>>>>>>    End_Procedure
53385>>>>>>>>>>>
53385>>>>>>>>>>>
53385>>>>>>>>>>>    // Define_Fields:
53385>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53385>>>>>>>>>>>
53385>>>>>>>>>>>    Procedure Define_Fields
53386>>>>>>>>>>>        Forward Send Define_Fields
53388>>>>>>>>>>>        //DDB-Generated-Code-Location
53388>>>>>>>>>>>        //DDB-DefineFieldStart
53388>>>>>>>>>>>
53388>>>>>>>>>>>        Set Main_File            To Psxetika.File_Number
53389>>>>>>>>>>>
53389>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53390>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53391>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53392>>>>>>>>>>>
53392>>>>>>>>>>>        // Parent (Server) file structure...............
53392>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53393>>>>>>>>>>>
53393>>>>>>>>>>>        // External (System) file structure.............
53393>>>>>>>>>>>        Send Add_System_File  Sysrecp.File_Number  DD_LOCK_ON_ALL
53394>>>>>>>>>>>
53394>>>>>>>>>>>        Define_Auto_Increment  Sysrecp.Psxetika_Rec0  To Psxetika.Psxetika_Rec0
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Field-based properties.......................
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Company_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Branch_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Year_Year
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Ctypkin_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Wtypkin_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Ptyppar_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Pseira_Seira
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Custprom_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Client_Id
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Partl_No
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Partl_Hmnia
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Partl_Recr
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Psx_Partl_Recr
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Psxetika_Recr
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Psxetika_Rec0
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Company_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Branch_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Year_Year
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Code
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Pseira_Seira
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Custpromcode
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Client_Id
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Partl_No
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Partl_Hmnia
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Ctypkin_Desc
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Wtypkin_Desc
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Ptyppar_Desc
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Custpromdesc
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Sx_Client_Desc
53397>>>>>>>>>>>
53397>>>>>>>>>>>        // Psxetika.Pms_Sx_Qty
53397>>>>>>>>>>>
53397>>>>>>>>>>>        //DDB-DefineFieldEnd
53397>>>>>>>>>>>    End_Procedure    // Define_Fields
53398>>>>>>>>>>>
53398>>>>>>>>>>>    // Field_Defaults:
53398>>>>>>>>>>>    // This procedure is used to establish default field values.
53398>>>>>>>>>>>
53398>>>>>>>>>>>    Procedure Field_Defaults
53399>>>>>>>>>>>        Forward Send Field_Defaults
53401>>>>>>>>>>>        //DDB-Generated-Code-Location
53401>>>>>>>>>>>        //DDB-FieldDefaultStart
53401>>>>>>>>>>>        //DDB-FieldDefaultEnd
53401>>>>>>>>>>>    End_Procedure    // Field_Defaults
53402>>>>>>>>>>>
53402>>>>>>>>>>>End_Class    // Psxetika_DataDictionary
53403>>>>>>>>>>>//DDB-FileEnd
53403>>>>>>>>>    Use TPARTICL.DD
INCLUDING FILE: TPARTICL.DD
53403>>>>>>>>>>>//DDB-FileStart
53403>>>>>>>>>>>//DDB-HeaderStart
53403>>>>>>>>>>>
53403>>>>>>>>>>>// File Name : TPARTICL.DD
53403>>>>>>>>>>>// Class Name: Tparticl_DataDictionary
53403>>>>>>>>>>>// Revision  : 28
53403>>>>>>>>>>>// Version   : 2
53403>>>>>>>>>>>
53403>>>>>>>>>>>Use  Windows           // Basic Definitions
53403>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53403>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53403>>>>>>>>>>>
53403>>>>>>>>>>>Open Tparticl
53405>>>>>>>>>>>Open Particle
53407>>>>>>>>>>>Open Baxiokat
53409>>>>>>>>>>>Open Sysrecc
53411>>>>>>>>>>>
53411>>>>>>>>>>>//DDB-HeaderEnd
53411>>>>>>>>>>>//DDB-ValidationStart
53411>>>>>>>>>>>
53411>>>>>>>>>>>Register_Object Mera_Tou_Mhna_VT
53411>>>>>>>>>>>
53411>>>>>>>>>>>Object Mera_Tou_Mhna_VT  is a CodeValidationTable
53413>>>>>>>>>>>    Set Type_Value        To "HMERES"
53414>>>>>>>>>>>    Set Allow_Blank_State To TRUE
53415>>>>>>>>>>>    //DDB-ValidationCustomStart
53415>>>>>>>>>>>    //DDB-ValidationCustomEnd
53415>>>>>>>>>>>End_Object   // Mera_Tou_Mhna_VT
53416>>>>>>>>>>>//DDB-ValidationEnd
53416>>>>>>>>>>>
53416>>>>>>>>>>>Class Tparticl_DataDictionary  is a DataDictionary_Sec
53417>>>>>>>>>>>
53417>>>>>>>>>>>    Procedure Construct_Object
53418>>>>>>>>>>>        Forward Send Construct_Object
53420>>>>>>>>>>>        Property Integer piParticleID Public 0
53421>>>>>>>>>>>        Property Integer piBaxiokatID Public 0
53422>>>>>>>>>>>    End_Procedure
53423>>>>>>>>>>>
53423>>>>>>>>>>>    Procedure End_Construct_Object
53424>>>>>>>>>>>        Integer iID
53425>>>>>>>>>>>        Forward Send End_Construct_Object
53427>>>>>>>>>>>        Move (Find_Server_DDO(Self,Particle.File_Number )) to iID
53428>>>>>>>>>>>        Set piParticleID to iID
53429>>>>>>>>>>>        Move (Find_Server_DDO(Self,Baxiokat.File_Number )) to iID
53430>>>>>>>>>>>        Set piBaxiokatID to iID
53431>>>>>>>>>>>    End_Procedure
53432>>>>>>>>>>>
53432>>>>>>>>>>>    Procedure Calc_All_The_Fields
53433>>>>>>>>>>>        Number  nSynolo nPoso nPososto naxia
53434>>>>>>>>>>>        Date    dHmniaPlhromhs dHmniaParalabhs dHmniaTimologiou
53434>>>>>>>>>>>        Date    dProkeiptei dProsDate dAddDate dStartDate dEndDate
53434>>>>>>>>>>>        Integer iMeresXaritos iMeratouMhna iMeresParalabhs iID iInt iAdd
53434>>>>>>>>>>>        Integer iMeresPlhroteo iCode iXhmero iMhnasTimologiou  iMet
53434>>>>>>>>>>>
53434>>>>>>>>>>>        Get piBaxiokatID                                                to iID
53435>>>>>>>>>>>        Get Field_Current_Value Of iID Field Baxiokat.Baxiokat_Code     to iCode
53436>>>>>>>>>>>
53436>>>>>>>>>>>
53436>>>>>>>>>>>        Get piParticleID                                                to iID
53437>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Payam       to nSynolo
53438>>>>>>>>>>>        Get Field_Current_Value Of iID Field Particle.Partl_Hmnia       to dHmniaTimologiou
53439>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Pct_Epi_Synolou   to nPososto
53440>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Paralabh_Meres    to iMeresParalabhs
53441>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Xarhtos_Meres     to iMeresXaritos
53442>>>>>>>>>>>        Get Field_Current_Value        Field TParticl.Plhroteo_Meres    to iMeresPlhroteo
53443>>>>>>>>>>>
53443>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
53443>>>>>>>>>>>        /////        10 (x)     -      10 (y)         /          30 (z)      /////
53443>>>>>>>>>>>        /////  iMeresParalabhs    iMeresXaritos              iMeresPlhroteo  /////
53443>>>>>>>>>>>        //////////////////////////////////////////////////////////////////////////
53443>>>>>>>>>>>
53443>>>>>>>>>>>        //  1. Kathorise thn 1h tou mhna, hmeromhniaka
53443>>>>>>>>>>>        Move ('01'+'/'+(String(TheMonthSegment(dHmniaTimologiou)))+'/'+;                       (String(TheYearSegment(dHmniaTimologiou)))) to dStartDate
53444>>>>>>>>>>>
53444>>>>>>>>>>>//        //  2. Vres thn Hmeromhnia paralabhs (Teleytaia hmera tou epomenou y hmerou
53444>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres paralabhs (x) )
53444>>>>>>>>>>>//        Move dStartDate to dHmniaParalabhs
53444>>>>>>>>>>>//        While (dHmniaParalabhs<(dHmniaTimologiou+iMeresXaritos))
53444>>>>>>>>>>>//            Add iMeresXaritos to dHmniaParalabhs
53444>>>>>>>>>>>//        Loop
53444>>>>>>>>>>>//        Add iMeresParalabhs to dHmniaParalabhs
53444>>>>>>>>>>>
53444>>>>>>>>>>>//        //  3. Vres thn Hmeromhnia Lhxhs ths epitaghs  (Teleytaia hmera tou trxontos y hmerou
53444>>>>>>>>>>>//        //     sthn opoia meta tha prosthesoume tis hmeres plhroteo (z) )
53444>>>>>>>>>>>//        Move dStartDate to dHmniaPlhromhs
53444>>>>>>>>>>>//        While (dHmniaPlhromhs<dHmniaTimologiou)
53444>>>>>>>>>>>//            Add iMeresXaritos to dHmniaPlhromhs
53444>>>>>>>>>>>//        Loop
53444>>>>>>>>>>>//        Add iMeresPlhroteo  to dHmniaPlhromhs
53444>>>>>>>>>>>
53444>>>>>>>>>>>        //  2. Vres thn Hmeromhnia  ths teleytaias hmera tou trexontos y hmerou
53444>>>>>>>>>>>        Move dStartDate to dHmniaParalabhs
53445>>>>>>>>>>>        If (iMeresXaritos<>0) Begin
53447>>>>>>>>>>>            While (dHmniaParalabhs<dHmniaTimologiou)
53451>>>>>>>>>>>                Add iMeresXaritos   to dHmniaParalabhs
53452>>>>>>>>>>>            Loop
53453>>>>>>>>>>>>
53453>>>>>>>>>>>        End
53453>>>>>>>>>>>>
53453>>>>>>>>>>>        Move dHmniaParalabhs    to dHmniaPlhromhs
53454>>>>>>>>>>>
53454>>>>>>>>>>>        Add (iMeresParalabhs-1) to dHmniaParalabhs
53455>>>>>>>>>>>        Add (iMeresPlhroteo-1)  to dHmniaPlhromhs
53456>>>>>>>>>>>
53456>>>>>>>>>>>        // Ypologise prota to poso bash posostou se sxesh me synolo parastatikou
53456>>>>>>>>>>>        Move (Round_number((nSynolo*nPososto/100),2))   to naxia
53457>>>>>>>>>>>
53457>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Poso     to naxia
53458>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Paralabh to dHmniaParalabhs
53459>>>>>>>>>>>        Set Field_Changed_Value Field TParticl.Exoflhsh to dHmniaPlhromhs
53460>>>>>>>>>>>
53460>>>>>>>>>>>    End_Procedure
53461>>>>>>>>>>>
53461>>>>>>>>>>>
53461>>>>>>>>>>>    Procedure Creating
53462>>>>>>>>>>>        Forward Send Creating
53464>>>>>>>>>>>        // Insert Code Here
53464>>>>>>>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Tparticl.Tparticl_Rec0))))));                                    to Tparticl.Tparticl_Recr
53465>>>>>>>>>>>    End_Procedure   // Creating
53466>>>>>>>>>>>
53466>>>>>>>>>>>
53466>>>>>>>>>>>    Procedure Save_Main_File
53467>>>>>>>>>>>        If (tparticl.isok <> '1') move ' ' to tparticl.isok
53470>>>>>>>>>>>        If (Operation_Origin<>Self) Begin
53472>>>>>>>>>>>            If tparticl.Recnum Eq 0 Procedure_Return
53475>>>>>>>>>>>        End
53475>>>>>>>>>>>>
53475>>>>>>>>>>>      Forward Send Save_Main_File
53477>>>>>>>>>>>    End_Procedure   // Save_Main_File
53478>>>>>>>>>>>
53478>>>>>>>>>>>
53478>>>>>>>>>>>    // Define_Fields:
53478>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53478>>>>>>>>>>>
53478>>>>>>>>>>>    Procedure Define_Fields
53479>>>>>>>>>>>        Forward Send Define_Fields
53481>>>>>>>>>>>        //DDB-Generated-Code-Location
53481>>>>>>>>>>>        //DDB-DefineFieldStart
53481>>>>>>>>>>>
53481>>>>>>>>>>>        Set Main_File            To Tparticl.File_Number
53482>>>>>>>>>>>        Set Cascade_Delete_State To FALSE
53483>>>>>>>>>>>
53483>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53484>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53485>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53486>>>>>>>>>>>
53486>>>>>>>>>>>        // Parent (Server) file structure...............
53486>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53487>>>>>>>>>>>        Send Add_Server_File  Baxiokat.File_Number
53488>>>>>>>>>>>
53488>>>>>>>>>>>        // External (System) file structure.............
53488>>>>>>>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
53489>>>>>>>>>>>
53489>>>>>>>>>>>        Define_Auto_Increment  Sysrecc.Tparticl_Rec0  To Tparticl.Tparticl_Rec0
53492>>>>>>>>>>>
53492>>>>>>>>>>>        // Field-based properties.......................
53492>>>>>>>>>>>
53492>>>>>>>>>>>        // Tparticl.Partl_Recr
53492>>>>>>>>>>>
53492>>>>>>>>>>>        // Tparticl.Baxiokat_Code
53492>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Baxiokat_Code To Calc_All_The_Fields
53493>>>>>>>>>>>
53493>>>>>>>>>>>        // Tparticl.Pct_Epi_Synolou
53493>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Pct_Epi_Synolou To Calc_All_The_Fields
53494>>>>>>>>>>>
53494>>>>>>>>>>>        // Tparticl.Paralabh_Meres
53494>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Paralabh_Meres To Calc_All_The_Fields
53495>>>>>>>>>>>
53495>>>>>>>>>>>        // Tparticl.Xarhtos_Meres
53495>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Xarhtos_Meres To Calc_All_The_Fields
53496>>>>>>>>>>>
53496>>>>>>>>>>>        // Tparticl.Plhroteo_Meres
53496>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Plhroteo_Meres To Calc_All_The_Fields
53497>>>>>>>>>>>
53497>>>>>>>>>>>        // Tparticl.Tparticl_Rec0
53497>>>>>>>>>>>
53497>>>>>>>>>>>        // Tparticl.Tparticl_Recr
53497>>>>>>>>>>>
53497>>>>>>>>>>>        // Tparticl.Mera_Tou_Mhna
53497>>>>>>>>>>>        Set Field_Exit_msg         Field Tparticl.Mera_Tou_Mhna To Calc_All_The_Fields
53498>>>>>>>>>>>        Set Field_Value_Table      Field Tparticl.Mera_Tou_Mhna To (Mera_Tou_Mhna_VT(Self))
53499>>>>>>>>>>>
53499>>>>>>>>>>>        // Tparticl.Poso
53499>>>>>>>>>>>
53499>>>>>>>>>>>        // Tparticl.Paralabh
53499>>>>>>>>>>>
53499>>>>>>>>>>>        // Tparticl.Exoflhsh
53499>>>>>>>>>>>
53499>>>>>>>>>>>        // Tparticl.Isok
53499>>>>>>>>>>>
53499>>>>>>>>>>>        //DDB-DefineFieldEnd
53499>>>>>>>>>>>    End_Procedure    // Define_Fields
53500>>>>>>>>>>>
53500>>>>>>>>>>>    // Field_Defaults:
53500>>>>>>>>>>>    // This procedure is used to establish default field values.
53500>>>>>>>>>>>
53500>>>>>>>>>>>    Procedure Field_Defaults
53501>>>>>>>>>>>        Forward Send Field_Defaults
53503>>>>>>>>>>>        //DDB-Generated-Code-Location
53503>>>>>>>>>>>        //DDB-FieldDefaultStart
53503>>>>>>>>>>>        //DDB-FieldDefaultEnd
53503>>>>>>>>>>>    End_Procedure    // Field_Defaults
53504>>>>>>>>>>>
53504>>>>>>>>>>>End_Class    // Tparticl_DataDictionary
53505>>>>>>>>>>>//DDB-FileEnd
53505>>>>>>>>>    Use PARTLFPA.DD
INCLUDING FILE: PARTLFPA.DD
53505>>>>>>>>>>>//DDB-FileStart
53505>>>>>>>>>>>//DDB-HeaderStart
53505>>>>>>>>>>>
53505>>>>>>>>>>>// File Name : PARTLFPA.DD
53505>>>>>>>>>>>// Class Name: Partlfpa_DataDictionary
53505>>>>>>>>>>>// Revision  : 7
53505>>>>>>>>>>>// Version   : 2
53505>>>>>>>>>>>
53505>>>>>>>>>>>Use  Windows           // Basic Definitions
53505>>>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
53505>>>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
53505>>>>>>>>>>>
53505>>>>>>>>>>>Open Partlfpa
53507>>>>>>>>>>>Open Particle
53509>>>>>>>>>>>Open Fpa
53511>>>>>>>>>>>
53511>>>>>>>>>>>//DDB-HeaderEnd
53511>>>>>>>>>>> 
53511>>>>>>>>>>>Class Partlfpa_DataDictionary  is a DataDictionary_Sec
53512>>>>>>>>>>>
53512>>>>>>>>>>>
53512>>>>>>>>>>>    // Define_Fields:
53512>>>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
53512>>>>>>>>>>>
53512>>>>>>>>>>>    Procedure Define_Fields
53513>>>>>>>>>>>        Forward Send Define_Fields
53515>>>>>>>>>>>        //DDB-Generated-Code-Location
53515>>>>>>>>>>>        //DDB-DefineFieldStart
53515>>>>>>>>>>>
53515>>>>>>>>>>>        Set Main_File            To Partlfpa.File_Number
53516>>>>>>>>>>>
53516>>>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
53517>>>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
53518>>>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53519>>>>>>>>>>>
53519>>>>>>>>>>>        // Parent (Server) file structure...............
53519>>>>>>>>>>>        Send Add_Server_File  Particle.File_Number
53520>>>>>>>>>>>        Send Add_Server_File  Fpa.File_Number
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Field-based properties.......................
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Partl_Recr
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Fpa_Pososto
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Partlfpa_Poso
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Poso_Pro_Ekpt
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Poso_Ekpt
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Poso_Pro_Fpa
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Poso_Fpa
53521>>>>>>>>>>>
53521>>>>>>>>>>>        // Partlfpa.Poso_Me_Fpa
53521>>>>>>>>>>>
53521>>>>>>>>>>>        //DDB-DefineFieldEnd
53521>>>>>>>>>>>    End_Procedure    // Define_Fields
53522>>>>>>>>>>>
53522>>>>>>>>>>>    // Field_Defaults:
53522>>>>>>>>>>>    // This procedure is used to establish default field values.
53522>>>>>>>>>>>
53522>>>>>>>>>>>    Procedure Field_Defaults
53523>>>>>>>>>>>        Forward Send Field_Defaults
53525>>>>>>>>>>>        //DDB-Generated-Code-Location
53525>>>>>>>>>>>        //DDB-FieldDefaultStart
53525>>>>>>>>>>>        //DDB-FieldDefaultEnd
53525>>>>>>>>>>>    End_Procedure    // Field_Defaults
53526>>>>>>>>>>>
53526>>>>>>>>>>>End_Class    // Partlfpa_DataDictionary
53527>>>>>>>>>>>//DDB-FileEnd
53527>>>>>>>>>
53527>>>>>>>>>    //AB-StoreTopEnd
53527>>>>>>>>>
53527>>>>>>>>>    //AB-IgnoreStart
53527>>>>>>>>>
53527>>>>>>>>>    Use Bproces.Sub
53527>>>>>>>>>
53527>>>>>>>>>
53527>>>>>>>>>    //AB-IgnoreEnd
53527>>>>>>>>>
53527>>>>>>>>>    Object Psx_Array is a BusinessProcessSub
53529>>>>>>>>>
53529>>>>>>>>>        //AB-StoreTopStart
53529>>>>>>>>>
53529>>>>>>>>>        Property    String  psParticleRecr0 Public ''
53531>>>>>>>>>        Property    String  psPsxetikaRecr0 Public ''
53533>>>>>>>>>        Property    String  psClient_Desc   Public ''
53535>>>>>>>>>        Property    String  psPtyppar_Desc  Public ''
53537>>>>>>>>>        Property    String  psSeira_Seira   Public ''
53539>>>>>>>>>        Property    Date    pdPartl_Hmnia   Public ''
53541>>>>>>>>>        Property    Integer piPartl_No      Public  0
53543>>>>>>>>>        Property    Number  pnPosothta      Public  0
53545>>>>>>>>>
53545>>>>>>>>>        Object Ctypkin_DD2 is a Ctypkin_DataDictionary
53547>>>>>>>>>        End_Object    // Ctypkin_DD2
53548>>>>>>>>>
53548>>>>>>>>>        Object Wtypkin_DD2 is a Wtypkin_DataDictionary
53550>>>>>>>>>        End_Object    // Wtypkin_DD2
53551>>>>>>>>>
53551>>>>>>>>>        Object Ptyppar_DD2 is a Ptyppar_DataDictionary
53553>>>>>>>>>            Set DDO_Server to (Ctypkin_DD2(self))
53554>>>>>>>>>            Set DDO_Server to (Wtypkin_DD2(self))
53555>>>>>>>>>        End_Object    // Ptyppar_DD2
53556>>>>>>>>>
53556>>>>>>>>>        Object Country_DD2 is a Country_DataDictionary
53558>>>>>>>>>        End_Object    // Country_DD2
53559>>>>>>>>>
53559>>>>>>>>>        Object Towns_DD2 is a Towns_DataDictionary
53561>>>>>>>>>            Set DDO_Server to (Country_DD2(self))
53562>>>>>>>>>        End_Object    // Towns_DD2
53563>>>>>>>>>
53563>>>>>>>>>        Object Cities_DD2 is a Cities_DataDictionary
53565>>>>>>>>>            Set DDO_Server to (Towns_DD2(self))
53566>>>>>>>>>        End_Object    // Cities_DD2
53567>>>>>>>>>
53567>>>>>>>>>        Object Areas_DD2 is a Areas_DataDictionary
53569>>>>>>>>>        End_Object    // Areas_DD2
53570>>>>>>>>>
53570>>>>>>>>>        Object Payresp_DD2 is a Payresp_DataDictionary
53572>>>>>>>>>        End_Object    // Payresp_DD2
53573>>>>>>>>>
53573>>>>>>>>>        Object Clients_DD2 is a Clients_DataDictionary
53575>>>>>>>>>            Set DDO_Server to (Cities_DD2(self))
53576>>>>>>>>>            Set DDO_Server to (Areas_DD2(self))
53577>>>>>>>>>            Set DDO_Server to (Payresp_DD2(self))
53578>>>>>>>>>        End_Object    // Clients_DD2
53579>>>>>>>>>
53579>>>>>>>>>        Object Nomisma_DD2 is a Nomisma_DataDictionary
53581>>>>>>>>>        End_Object    // Nomisma_DD2
53582>>>>>>>>>
53582>>>>>>>>>        Object Particle_DD2 is a Particle_DataDictionary
53584>>>>>>>>>            Set DDO_Server to (Clients_DD2(self))
53585>>>>>>>>>            Set DDO_Server to (Ptyppar_DD2(self))
53586>>>>>>>>>            Set DDO_Server to (Nomisma_DD2(self))
53587>>>>>>>>>        End_Object    // Particle_DD2
53588>>>>>>>>>
53588>>>>>>>>>
53588>>>>>>>>>        /////////////////////////////////////////////
53588>>>>>>>>>
53588>>>>>>>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
53590>>>>>>>>>        End_Object    // Ctypkin_DD
53591>>>>>>>>>
53591>>>>>>>>>        Object Wtypkin_DD is a Wtypkin_DataDictionary
53593>>>>>>>>>        End_Object    // Wtypkin_DD
53594>>>>>>>>>
53594>>>>>>>>>        Object Ptyppar_DD is a Ptyppar_DataDictionary
53596>>>>>>>>>            Set DDO_Server to (Ctypkin_DD(self))
53597>>>>>>>>>            Set DDO_Server to (Wtypkin_DD(self))
53598>>>>>>>>>        End_Object    // Ptyppar_DD
53599>>>>>>>>>
53599>>>>>>>>>        Object Country_DD is a Country_DataDictionary
53601>>>>>>>>>        End_Object    // Country_DD
53602>>>>>>>>>
53602>>>>>>>>>        Object Towns_DD is a Towns_DataDictionary
53604>>>>>>>>>            Set DDO_Server to (Country_DD(self))
53605>>>>>>>>>        End_Object    // Towns_DD
53606>>>>>>>>>
53606>>>>>>>>>        Object Cities_DD is a Cities_DataDictionary
53608>>>>>>>>>            Set DDO_Server to (Towns_DD(self))
53609>>>>>>>>>        End_Object    // Cities_DD
53610>>>>>>>>>
53610>>>>>>>>>        Object Areas_DD is a Areas_DataDictionary
53612>>>>>>>>>        End_Object    // Areas_DD
53613>>>>>>>>>
53613>>>>>>>>>        Object Payresp_DD is a Payresp_DataDictionary
53615>>>>>>>>>        End_Object    // Payresp_DD
53616>>>>>>>>>
53616>>>>>>>>>        Object Clients_DD is a Clients_DataDictionary
53618>>>>>>>>>            Set DDO_Server to (Cities_DD(self))
53619>>>>>>>>>            Set DDO_Server to (Areas_DD(self))
53620>>>>>>>>>            Set DDO_Server to (Payresp_DD(self))
53621>>>>>>>>>        End_Object    // Clients_DD
53622>>>>>>>>>
53622>>>>>>>>>        Object Nomisma_DD is a Nomisma_DataDictionary
53624>>>>>>>>>        End_Object    // Nomisma_DD
53625>>>>>>>>>
53625>>>>>>>>>        Object Particle_DD is a Particle_DataDictionary
53627>>>>>>>>>            Set DDO_Server to (Clients_DD(self))
53628>>>>>>>>>            Set DDO_Server to (Ptyppar_DD(self))
53629>>>>>>>>>            Set DDO_Server to (Nomisma_DD(self))
53630>>>>>>>>>        End_Object    // Particle_DD
53631>>>>>>>>>
53631>>>>>>>>>        Object Psxetika_DD is a Psxetika_DataDictionary
53633>>>>>>>>>            Set DDO_Server      to (Particle_DD(self))
53634>>>>>>>>>            Set Constrain_File  to Particle.File_Number
53635>>>>>>>>>        End_Object
53636>>>>>>>>>
53636>>>>>>>>>
53636>>>>>>>>>        //AB-StoreTopEnd
53636>>>>>>>>>
53636>>>>>>>>>        Set Size to 60 100
53637>>>>>>>>>
53637>>>>>>>>>        //AB-DDOStart
53637>>>>>>>>>
53637>>>>>>>>>
53637>>>>>>>>>        //AB-DDOEnd
53637>>>>>>>>>
53637>>>>>>>>>
53637>>>>>>>>>        //AB-StoreStart
53637>>>>>>>>>
53637>>>>>>>>>        Procedure Find_Sxetika_Data String asParentRecr
53639>>>>>>>>>            String  sClient_Desc sPtyppar_Desc sPseira_Seira
53640>>>>>>>>>            Date    dPartl_Hmnia
53640>>>>>>>>>            Integer iPartl_No
53640>>>>>>>>>
53640>>>>>>>>>            Send Clear          to Particle_DD2
53641>>>>>>>>>            Move asParentRecr   to Particle.Partl_Recr
53642>>>>>>>>>            Send Find           to Particle_DD2 Eq 2
53643>>>>>>>>>
53643>>>>>>>>>            Get Field_Current_Value Of Clients_DD2  Field Clients.Client_Name   to sClient_Desc
53644>>>>>>>>>            Get Field_Current_Value Of Ptyppar_DD2  Field Ptyppar.Ptyppar_Descr to sPtyppar_Desc
53645>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Pseira_Seira to sPseira_Seira
53646>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_Hmnia  to dPartl_Hmnia
53647>>>>>>>>>            Get Field_Current_Value Of Particle_DD2 Field Particle.Partl_No     to iPartl_No
53648>>>>>>>>>
53648>>>>>>>>>            Set psPtyppar_Desc      to sPtyppar_Desc
53649>>>>>>>>>            Set psClient_Desc       to sClient_Desc
53650>>>>>>>>>            Set psSeira_Seira       to sPseira_Seira
53651>>>>>>>>>            Set pdPartl_Hmnia       to dPartl_Hmnia
53652>>>>>>>>>            Set piPartl_No          to iPartl_No
53653>>>>>>>>>        End_Procedure
53654>>>>>>>>>
53654>>>>>>>>>
53654>>>>>>>>>        Procedure Make_The_Record
53656>>>>>>>>>
53656>>>>>>>>>            Set psPtyppar_Desc      to ''
53657>>>>>>>>>            Set psClient_Desc       to ''
53658>>>>>>>>>            Set psSeira_Seira       to ''
53659>>>>>>>>>            Set pdPartl_Hmnia       to ''
53660>>>>>>>>>            Set piPartl_No          to 0
53661>>>>>>>>>
53661>>>>>>>>>            Clear Psxetika
53662>>>>>>>>>            Move (psParticleRecr0(Self)) to Psxetika.Partl_Recr
53663>>>>>>>>>            Move (psPsxetikaRecr0(Self)) to Psxetika.Psx_Partl_Recr
53664>>>>>>>>>            Find Eq Psxetika by index.4
53665>>>>>>>>>>
53665>>>>>>>>>
53665>>>>>>>>>            If (Not(Found)) Begin
53667>>>>>>>>>
53667>>>>>>>>>                Send Find_Sxetika_Data (psPsxetikaRecr0(Self))
53668>>>>>>>>>
53668>>>>>>>>>                Send Clear to Particle_DD
53669>>>>>>>>>                Send Clear to Psxetika_DD
53670>>>>>>>>>
53670>>>>>>>>>                // Vres ton mpampa
53670>>>>>>>>>                Move (psParticleRecr0(Self)) to Particle.Partl_Recr
53671>>>>>>>>>                Send Find to Particle_DD Eq 2
53672>>>>>>>>>
53672>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                to (psPsxetikaRecr0(Self))
53673>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                to (psClient_Desc(Self))
53674>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                to (psPtyppar_Desc(Self))
53675>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                to (pdPartl_Hmnia(Self))
53676>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                to (piPartl_No(Self))
53677>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                to (psSeira_Seira(Self))
53678>>>>>>>>>                Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                to (pnPosothta(Self))
53679>>>>>>>>>
53679>>>>>>>>>                Send Request_Save               to Psxetika_DD
53680>>>>>>>>>
53680>>>>>>>>>
53680>>>>>>>>>                // Make also 2nd Record
53680>>>>>>>>>                Clear Psxetika
53681>>>>>>>>>                Move (psPsxetikaRecr0(Self)) to Psxetika.Partl_Recr
53682>>>>>>>>>                Move (psParticleRecr0(Self)) to Psxetika.Psx_Partl_Recr
53683>>>>>>>>>                Find Eq Psxetika by index.4
53684>>>>>>>>>>
53684>>>>>>>>>
53684>>>>>>>>>                If (Not(Found)) Begin
53686>>>>>>>>>
53686>>>>>>>>>                    Send Find_Sxetika_Data (psParticleRecr0(Self))
53687>>>>>>>>>
53687>>>>>>>>>                    Send Clear to Particle_DD
53688>>>>>>>>>                    Send Clear to Psxetika_DD
53689>>>>>>>>>
53689>>>>>>>>>                    Move (psPsxetikaRecr0(Self)) to Particle.Partl_Recr
53690>>>>>>>>>                    Send Find to Particle_DD Eq 2
53691>>>>>>>>>
53691>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Psx_Partl_Recr    ;                                                    to (psParticleRecr0(Self))
53692>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Client_Desc    ;                                                    to (psClient_Desc(Self))
53693>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Ptyppar_Desc   ;                                                    to (psPtyppar_Desc(Self))
53694>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_Hmnia    ;                                                    to (pdPartl_Hmnia(Self))
53695>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Sx_Partl_No       ;                                                    to (piPartl_No(Self))
53696>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.SX_Pseira_Seira   ;                                                    to (psSeira_Seira(Self))
53697>>>>>>>>>                    Set Field_Changed_Value Of Psxetika_DD Field Psxetika.Pms_Sx_Qty        ;                                                    to (pnPosothta(Self))
53698>>>>>>>>>                    Send Request_Save               to Psxetika_DD
53699>>>>>>>>>                End
53699>>>>>>>>>>
53699>>>>>>>>>            End
53699>>>>>>>>>>
53699>>>>>>>>>        End_Procedure
53700>>>>>>>>>
53700>>>>>>>>>        //AB-StoreEnd
53700>>>>>>>>>
53700>>>>>>>>>    End_Object    // Psx_Array
53701>>>>>>>>>
53701>>>>>>>>>
53701>>>>>>>>>    //AB-StoreStart
53701>>>>>>>>>
53701>>>>>>>>>    //AB-StoreEnd
53701>>>>>>>>>
53701>>>>>>>>>//AB/     End_Object    // prj
53701>>>>>>>//Use bpMakeSx.dg
53701>>>>>>>
53701>>>>>>>Class PmsSxet_DataDictionary  is a DataDictionary_Sec
53702>>>>>>>
53702>>>>>>>    Procedure Construct_Object
53703>>>>>>>        Forward Send Construct_Object
53705>>>>>>>        Property Integer piFromCreate   Public 0
53706>>>>>>>    End_Procedure
53707>>>>>>>
53707>>>>>>>    Procedure Creating
53708>>>>>>>        Forward Send Creating
53710>>>>>>>        Set piFromCreate to 1
53711>>>>>>>    End_Procedure
53712>>>>>>>
53712>>>>>>>    Procedure Update
53713>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
53714>>>>>>>        Number  nQty
53714>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53714>>>>>>>
53714>>>>>>>        Forward Send Update
53716>>>>>>>
53716>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
53717>>>>>>>        Move Particle.Partl_Recr                to sRecr1
53718>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
53719>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
53720>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
53721>>>>>>>        Move PmsSxet.Posothta                   to nQty
53722>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
53723>>>>>>>
53723>>>>>>>
53723>>>>>>>        If (piFromCreate(Self)<>1) Begin
53725>>>>>>>            Add nQty to Pmoves.Pms_Qty
53726>>>>>>>            Saverecord Pmoves
53727>>>>>>>
53727>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53728>>>>>>>            Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
53729>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53730>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53731>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53732>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53733>>>>>>>            Send DoProcess          to bpEnYpol
53734>>>>>>>
53734>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53735>>>>>>>
53735>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53738>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53742>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53746>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53750>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53754>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53758>>>>>>>            Else If (iLathos=40006) Error 8006 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53762>>>>>>>
53762>>>>>>>        End
53762>>>>>>>>
53762>>>>>>>
53762>>>>>>>        // Epanafora posothtas giati afou trexei h backout me timh px 3 eno h update exei timh 4
53762>>>>>>>        // sthn epanatopothethsh ths bpenypol xanavriskei to current pmssxet record
53762>>>>>>>        // kai xanei thn posothta thn kainourgia opote epanerxetai me thn posothta ths
53762>>>>>>>        // backout pou einai 3.
53762>>>>>>>        Move nQty to PmsSxet.Posothta
53763>>>>>>>
53763>>>>>>>
53763>>>>>>>        Clear Psxetika
53764>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53765>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53766>>>>>>>        Find Eq Psxetika by index.4
53767>>>>>>>>
53767>>>>>>>        If (Found) Begin
53769>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
53770>>>>>>>            Saverecord Psxetika
53771>>>>>>>        End
53771>>>>>>>>
53771>>>>>>>
53771>>>>>>>        Clear Psxetika
53772>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53773>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53774>>>>>>>        Find Eq Psxetika by index.4
53775>>>>>>>>
53775>>>>>>>        If (Found) Begin
53777>>>>>>>            Add nQty to Psxetika.Pms_Sx_Qty
53778>>>>>>>            Saverecord Psxetika
53779>>>>>>>        End
53779>>>>>>>>
53779>>>>>>>    End_Procedure
53780>>>>>>>
53780>>>>>>>    Procedure Backout
53781>>>>>>>        String  sRecr1 sRecr2 sPmsSxet
53782>>>>>>>        Number  nQty
53782>>>>>>>        Integer iLathos iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53782>>>>>>>
53782>>>>>>>        Move (Trim(Particle.Partl_LastNo)='1')  to iAkyro
53783>>>>>>>        Move Particle.Partl_Recr                to sRecr1
53784>>>>>>>        Move Pmoves.Recnum                      to iCurrentPmoves
53785>>>>>>>        Move PmsSxet.Recnum                     to iCurrentPmsSxet
53786>>>>>>>        Move PmsSxet.Arx_Partl_Recr             to sRecr2
53787>>>>>>>        Move PmsSxet.Posothta                   to nQty
53788>>>>>>>        Move Particle.Recnum                    to iCurrentPartl
53789>>>>>>>
53789>>>>>>>        Forward Send Backout
53791>>>>>>>
53791>>>>>>>        Set pnQty               Of bpEnYpol to (nQty*(-1))
53792>>>>>>>        Set psRecr              Of bpEnYpol to PmsSxet.Sxetiko_Recr
53793>>>>>>>        Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53794>>>>>>>        Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53795>>>>>>>        Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53796>>>>>>>        Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53797>>>>>>>        Send DoProcess          to bpEnYpol
53798>>>>>>>
53798>>>>>>>        Get piLathos            Of bpEnYpol to iLathos
53799>>>>>>>
53799>>>>>>>             If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53802>>>>>>>        Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53806>>>>>>>        Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53810>>>>>>>        Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53814>>>>>>>        Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nBackout PmsSxet'
53818>>>>>>>        Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nBackout PmsSxet'
53822>>>>>>>        Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nBackout PmsSxet'
53826>>>>>>>        Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nBackout PmsSxet'
53830>>>>>>>
53830>>>>>>>        Clear Psxetika
53831>>>>>>>        Move sRecr1 to Psxetika.Partl_Recr
53832>>>>>>>        Move sRecr2 to Psxetika.Psx_Partl_Recr
53833>>>>>>>        Find Eq Psxetika by index.4
53834>>>>>>>>
53834>>>>>>>        If (Found) Begin
53836>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53837>>>>>>>            Saverecord Psxetika
53838>>>>>>>        End
53838>>>>>>>>
53838>>>>>>>
53838>>>>>>>        Clear Psxetika
53839>>>>>>>        Move sRecr2 to Psxetika.Partl_Recr
53840>>>>>>>        Move sRecr1 to Psxetika.Psx_Partl_Recr
53841>>>>>>>        Find Eq Psxetika by index.4
53842>>>>>>>>
53842>>>>>>>        If (Found) Begin
53844>>>>>>>            Sub nQty from Psxetika.Pms_Sx_Qty
53845>>>>>>>            Saverecord Psxetika
53846>>>>>>>        End
53846>>>>>>>>
53846>>>>>>>    End_Procedure
53847>>>>>>>
53847>>>>>>>    Procedure Request_Save
53848>>>>>>>        Integer iInt iLathos iMustDelete iCurrentPmoves iAkyro iCurrentPmsSxet iCurrentPartl
53849>>>>>>>        String  sParticleRecr sPmsSxetRecr sPmovesRecr sArxPartlRecr sRecr1 sRecr2 sPmsSxet
53849>>>>>>>        Number  nQty
53849>>>>>>>
53849>>>>>>>        Set piFromCreate to 0
53850>>>>>>>
53850>>>>>>>        Forward Send Request_Save
53852>>>>>>>
53852>>>>>>>        If (piFromCreate(Self)=1) Begin
53854>>>>>>>            Set piFromCreate                                                to 0
53855>>>>>>>
53855>>>>>>>            Get File_Field_Current_Value File_Field Particle.Recnum         to iCurrentPartl
53856>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_Recr     to sParticleRecr
53857>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Pms_Recr         to sPmovesRecr
53858>>>>>>>            Get File_Field_Current_Value File_Field Pmoves.Recnum           to iCurrentPmoves
53859>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Recnum          to iCurrentPmsSxet
53860>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Sxetiko_Recr    to sPmsSxetRecr
53861>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Arx_Partl_Recr  to sArxPartlRecr
53862>>>>>>>            Get File_Field_Current_Value File_Field PmsSxet.Posothta        to nQty
53863>>>>>>>            Get File_Field_Current_Value File_Field Particle.Partl_LastNo   to iAkyro
53864>>>>>>>            Move (iAkyro=1)                                                 to iAkyro
53865>>>>>>>
53865>>>>>>>            Set pnQty               Of bpEnYpol to nQty
53866>>>>>>>            Set psRecr              Of bpEnYpol to sPmsSxetRecr
53867>>>>>>>            Set piFromAkyrosh       Of bpEnYpol to (iAkyro=1)
53868>>>>>>>            Set piCurrentPartl      Of bpEnYpol to iCurrentPartl
53869>>>>>>>            Set piCurrentPmoves     Of bpEnYpol to iCurrentPmoves
53870>>>>>>>            Set piCurrentPmsSxet    Of bpEnYpol to iCurrentPmsSxet
53871>>>>>>>            Send DoProcess          to bpEnYpol
53872>>>>>>>            Get piLathos            Of bpEnYpol to iLathos
53873>>>>>>>
53873>>>>>>>                 If (iLathos=40000) Error 8000 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53876>>>>>>>            Else If (iLathos=40001) Error 8001 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53880>>>>>>>            Else If (iLathos=40002) Error 8002 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53884>>>>>>>            Else If (iLathos=40003) Error 8003 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53888>>>>>>>            Else If (iLathos=40004) Error 8004 '’¦ §¨à«˜¨® ¡æ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  ˜¨¤ž« ¡æ.\nUpdate PmsSxet'
53892>>>>>>>            Else If (iLathos=40005) Error 8005 'ƒœ¤ ™¨âŸž¡œ Particle\nUpdate PmsSxet'
53896>>>>>>>            Else If (iLathos=40006) Error 8006 '’¦ ¬§æ¢¦ §¦ §¨¦ª « £¦¢æšž©ž §¨¦¡ç§«œ  > ˜¨® ¡ã §¦©æ«ž«˜.\nUpdate PmsSxet'
53900>>>>>>>            Else If (iLathos=40007) Error 8007 'ƒœ¤ ™¨âŸž¡œ œšš¨˜­ã ˜¨® ¡¦ç Pmoves\nUpdate PmsSxet'
53904>>>>>>>
53904>>>>>>>            Set psParticleRecr0     Of Psx_Array to sParticleRecr
53905>>>>>>>            Set psPsxetikaRecr0     Of Psx_Array to sArxPartlRecr
53906>>>>>>>            Set pnPosothta          Of Psx_Array to nQty
53907>>>>>>>            Send Make_The_Record    Of Psx_Array
53908>>>>>>>
53908>>>>>>>            // Xana vres tis eggrafes
53908>>>>>>>            Clear Particle
53909>>>>>>>            Move sParticleRecr  to Particle.Partl_Recr
53910>>>>>>>            Find Eq Particle by index.2
53911>>>>>>>>
53911>>>>>>>
53911>>>>>>>            Clear Pmoves
53912>>>>>>>            Move sPmovesRecr    to Pmoves.Pms_Recr
53913>>>>>>>            Find Eq Pmoves by index.2
53914>>>>>>>>
53914>>>>>>>
53914>>>>>>>            Clear PmsSxet
53915>>>>>>>            Move sPmovesRecr    to PmsSxet.Pms_Recr
53916>>>>>>>            Move sPmsSxetRecr   to PmsSxet.Sxetiko_Recr
53917>>>>>>>            Find Eq PmsSxet by Index.1
53918>>>>>>>>
53918>>>>>>>
53918>>>>>>>        End
53918>>>>>>>>
53918>>>>>>>    End_Procedure
53919>>>>>>>
53919>>>>>>>
53919>>>>>>>    Procedure Define_Fields
53920>>>>>>>        Forward Send Define_Fields
53922>>>>>>>        //DDB-Generated-Code-Location
53922>>>>>>>        //DDB-DefineFieldStart
53922>>>>>>>
53922>>>>>>>        Set Main_File            To Pmssxet.File_Number
53923>>>>>>>
53923>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
53924>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
53925>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
53926>>>>>>>
53926>>>>>>>        // Parent (Server) file structure...............
53926>>>>>>>        Send Add_Server_File  Pmoves.File_Number
53927>>>>>>>
53927>>>>>>>        // External (System) file structure.............
53927>>>>>>>        Send Add_System_File  Psxetika.File_Number  DD_LOCK_ON_ALL
53928>>>>>>>        Send Add_System_File  Pmoves.File_Number  DD_LOCK_ON_ALL
53929>>>>>>>
53929>>>>>>>        // Field-based properties.......................
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Pms_Recr
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sxetiko_Recr
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Posothta
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Arx_Partl_Recr
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sx_Parast
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sx_Hmnia
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sx_Foreas
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sx_Arithmos
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sx_Seira
53929>>>>>>>
53929>>>>>>>        // Pmssxet.Sx_Posothta
53929>>>>>>>
53929>>>>>>>        //DDB-DefineFieldEnd
53929>>>>>>>    End_Procedure    // Define_Fields
53930>>>>>>>
53930>>>>>>>    Procedure Field_Defaults
53931>>>>>>>        Forward Send Field_Defaults
53933>>>>>>>        //DDB-Generated-Code-Location
53933>>>>>>>        //DDB-FieldDefaultStart
53933>>>>>>>        //DDB-FieldDefaultEnd
53933>>>>>>>    End_Procedure    // Field_Defaults
53934>>>>>>>
53934>>>>>>>End_Class    // Pmssxet_DataDictionary
53935>>>>>>>//DDB-FileEnd
53935>>>>>
53935>>>>>Class Cmoves_DataDictionary  is a DataDictionary
53936>>>>>
53936>>>>>    Procedure Construct_Object
53937>>>>>        Forward Send Construct_Object
53939>>>>>        Property Integer piFromBP           Public 0
53940>>>>>        Property Integer piNotMoveSyscurXr  Public 0   
53941>>>>>        Property Integer piFromSysxet       Public 0   
53942>>>>>        Property Integer piFromxrhsh        Public 0  //œ¤›œ ¥ž ¦«  œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤
53943>>>>>    End_Procedure
53944>>>>>
53944>>>>>    Function Validate_Save  Returns Integer
53945>>>>>        Integer iReturnVal iOpen_Items iCheck ifromxrhsh iYes
53946>>>>>        String sModule
53946>>>>>        get pifromxrhsh to ifromxrhsh
53947>>>>>        Forward Get Validate_Save  To iReturnVal
53949>>>>>        If (Not(iReturnVal)) Begin
53951>>>>>            if (cmoves.cmoves_recr='')  Send Operation_Not_Allowed 3263
53954>>>>>            Clear Branch
53955>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
53956>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
53957>>>>>            Find Eq Branch By Index.1
53958>>>>>>
53958>>>>>            If (Not(Found)) Move 6666 to iReturnVal
53961>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6667 to iReturnVal
53965>>>>>            
53965>>>>>            If (Cmoves.Axia_Ypol_Sysx<0) Begin
53967>>>>>                Move 10101 to iReturnVal
53968>>>>>            End
53968>>>>>>
53968>>>>>            Else Begin
53969>>>>>                
53969>>>>>                Move Ctypkin.Check_Overhead to iCheck
53970>>>>>                If (iCheck) Begin
53972>>>>>                    If ((Clients.Plafon>0) And (Clients.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
53974>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3000 Cmoves' to iYes
53975>>>>>                        If (iYes=MBR_NO) Move 11170 to iReturnVal
53978>>>>>                    End
53978>>>>>>
53978>>>>>                    Else If ((PayResp.Plafon>0) And (PayResp.Overhead<0) And (Sysfile.Over_Overhead<>'1')) Begin
53981>>>>>                        Get YesNo_Box 'Ž ¬§.§¢ž¨à£é¤ â®œ  ¬§â¨™˜©ž §¢˜­æ¤\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 3001 Cmoves' to iYes
53982>>>>>                        If (iYes=MBR_NO) Move 11171 to iReturnVal
53985>>>>>                    End
53985>>>>>>
53985>>>>>                End
53985>>>>>>
53985>>>>>                
53985>>>>>                If (iReturnVal) Send Operation_Not_Allowed iReturnVal
53988>>>>>                
53988>>>>>                If ((Cmoves.Prn_Theor='1') And (piFromBP(Self)<>1)) Move 22278 to iReturnVal
53991>>>>>                Else If ((Clients.Client_Locked='1') And (piFromBP(Self)<>1)) Move 11172 to iReturnVal
53995>>>>>                
53995>>>>>                // ˜¤ œ¨®œ«˜  ˜§¦ £œ«˜­¦¨á ¬§¦¢¦å§à¤ £ž¤ «¦¤ ¡¦™œ ª ã ˜§¦ open items (©¬©®œ« ©œ ª)
53995>>>>>                Else If ((Cmoves.Cmoves_Hmnia<syscurxr.Year_Xrhshfrom and ifromxrhsh<>1 And (piFromSysxet(Self)<>1)) Or ;                         (Cmoves.Cmoves_Hmnia>Syscurxr.Year_Xrhshto and ifromxrhsh<>1 And (piFromSysxet(Self)<>1))) Move 22277 to iReturnVal
53999>>>>>                Else Begin
54000>>>>>                    If (Cmoves.Module_From='') Move 22250 to iReturnVal
54003>>>>>                    Else Begin
54004>>>>>                        If (piFromBP(Self)<>1) Begin // €¤ ›œ¤ §¨¦œ¨®œ«˜  ˜§¦ « ª 2 Business Process
54006>>>>>                            If (Cmoves.Module_From<>gs_Module_Code) Move 22288 to iReturnVal
54009>>>>>                            Else If (Cmoves.Recnum<>0) Begin // €¤ ›œ¤ ¡˜¤œ  create ¤œ˜ œšš¨˜­ž
54012>>>>>                                If (Cmoves.Barticl_Recr<>'') Move 22284 to iReturnVal
54015>>>>>                                Else If (Cmoves.Partl_Recr  <>'') Begin
54018>>>>>                                    If (Cmoves.Module_From='01') Move 22283 to iReturnVal
54021>>>>>                                    Else If (Cmoves.Module_From='02') Move 22282 to iReturnVal
54025>>>>>                                End
54025>>>>>>
54025>>>>>                            End
54025>>>>>>
54025>>>>>                        End
54025>>>>>>
54025>>>>>                    End
54025>>>>>>
54025>>>>>                End
54025>>>>>>
54025>>>>>            End
54025>>>>>>
54025>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54028>>>>>        End
54028>>>>>>
54028>>>>>        Function_Return iReturnVal
54029>>>>>    End_Function   // Validate_Save
54030>>>>>
54030>>>>>    Function Validate_Delete  Returns Integer
54031>>>>>        Integer iReturnVal
54032>>>>>        String sModule
54032>>>>>        Forward Get Validate_Delete  To iReturnVal
54034>>>>>        If (Not(iReturnVal)) Begin
54036>>>>>
54036>>>>>            Clear Branch
54037>>>>>            Move SyscurXr.Company_Code  to Branch.Company_Code
54038>>>>>            Move SyscurXr.Branch_Code   to Branch.Branch_Code
54039>>>>>            Find Eq Branch By Index.1
54040>>>>>>
54040>>>>>            If (Not(Found)) Move 6668 to iReturnVal
54043>>>>>            Else If ((Branch.Locked_Until<>'') And (Cmoves.Cmoves_Hmnia<=Branch.Locked_Until)) Move 6669 to iReturnVal
54047>>>>>            
54047>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54050>>>>>            
54050>>>>>            If (Cmoves.Prn_Theor='1') Move 22279 to iReturnVal
54053>>>>>            Else If (piFromBP(Self)<>1) Begin
54056>>>>>                If (Cmoves.Module_From<>gs_Module_Code) Move 22289 to iReturnVal
54059>>>>>                Else Begin
54060>>>>>                    If (Cmoves.Barticl_Recr<>'') Move 22287 to iReturnVal
54063>>>>>                    Else If (Cmoves.Partl_Recr  <>'') Begin
54066>>>>>                        If (Cmoves.Module_From='01') Move 22286 to iReturnVal
54069>>>>>                        Else If (Cmoves.Module_From='02') Move 22285 to iReturnVal
54073>>>>>                    End
54073>>>>>>
54073>>>>>                End
54073>>>>>>
54073>>>>>            End
54073>>>>>>
54073>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54076>>>>>        End
54076>>>>>>
54076>>>>>        Function_Return iReturnVal
54077>>>>>    End_Function   // Validate_Delete
54078>>>>>
54078>>>>>    Procedure Save_Main_File
54079>>>>>        If (Operation_Origin<>Self) Begin
54081>>>>>            If Cmoves.Recnum Eq 0 Procedure_Return
54084>>>>>        End
54084>>>>>>
54084>>>>>        If (Cmoves.Cn_Code<>'') Begin
54086>>>>>            Clear Cn
54087>>>>>            Move Cmoves.Cn_Code to Cn.Cn_Code
54088>>>>>            Find Eq Cn By Index.5 // Cn:Index.5:Cn_Code
54089>>>>>>
54089>>>>>            Move Cn.Cn_Sls_ID      to Cmoves.Sls_ID
54090>>>>>            Move cn.Mhxanik_id     to Cmoves.Mhxanik_Id
54091>>>>>            Move Cn.CN_Cnt_ID      to Cmoves.Cnt_ID
54092>>>>>            Move Cn.Cn_Recr        to Cmoves.Cn_Recr
54093>>>>>        End
54093>>>>>>
54093>>>>>        Else Begin
54094>>>>>            Move ''     to Cmoves.Sls_ID
54095>>>>>            Move ''     to Cmoves.Cnt_ID
54096>>>>>            Move ''     to Cmoves.Cn_Recr
54097>>>>>            Move ''     to Cmoves.Mhxanik_id
54098>>>>>        End
54098>>>>>>
54098>>>>>        Forward Send Save_Main_File
54100>>>>>    End_Procedure   // Save_Main_File
54101>>>>>
54101>>>>>
54101>>>>>    Procedure Update
54102>>>>>        String sNomisma
54103>>>>>        Forward Send Update
54105>>>>>        
54105>>>>>        If (piNotMoveSyscurXr(Self)=0) Begin
54107>>>>>            Move SysCurXR.Company_Code      to Cmoves.Company_Code
54108>>>>>            Move SysCurXR.Branch_Code       to Cmoves.Branch_Code
54109>>>>>        End
54109>>>>>>
54109>>>>>        
54109>>>>>        //˜¤ šå¤œ«˜  £œ«˜­¦¨á ¬§¦¢¦å§à¤
54109>>>>>        if (pifromxrhsh(self)=1)            Move (SysCurXR.Year_Year+1) to Cmoves.Year_Year
54112>>>>>        else If (piNotMoveSyscurXr(Self)=0) Move SysCurXR.Year_Year     to Cmoves.Year_Year
54116>>>>>        
54116>>>>>        //Move Custprom.Custprom_Code to Cmoves.Custprom_Code
54116>>>>>        Move Clients.Client_ID          to Cmoves.Client_ID
54117>>>>>        Move Clients.Client_Name        to Cmoves.Client_Name
54118>>>>>        Move Ctypkin.Ctypkin_Descr      to Cmoves.Ctypkin_Descr
54119>>>>>
54119>>>>>        // js 28/03/2002 Gia na mhn allazei sta Copen me to Ctypkin tou CmovesA
54119>>>>>        If (Cmoves.Ctypkin_Code='') ;            Move Ctypkin.Ctypkin_Code   to Cmoves.Ctypkin_Code
54122>>>>>
54122>>>>>
54122>>>>>        Move payresp.presp_ID           to Cmoves.Presp_ID
54123>>>>>
54123>>>>>        ///an enhmeronei synolikh ofeilh pelath
54123>>>>>        if (Cmoves.enhm_ofeilh='1') begin
54125>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Clients.Synolikh_ofeilh
54126>>>>>            Add (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) to Payresp.Synolikh_ofeilh
54127>>>>>        end
54127>>>>>>
54127>>>>>
54127>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
54129>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
54131>>>>>                Add Cmoves.Cmoves_x0 to Clients.Xreosh
54132>>>>>                Add Cmoves.Cmoves_x0 to PayResp.Xreosh
54133>>>>>            End
54133>>>>>>
54133>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
54136>>>>>                Add Cmoves.Cmoves_p0 to Clients.Pistosh
54137>>>>>                Add Cmoves.Cmoves_p0 to PayResp.Pistosh
54138>>>>>            End
54138>>>>>>
54138>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin
54140>>>>>                move 1 to clients.client_public  
54141>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
54142>>>>>                move '' to clients.status
54143>>>>>            end     
54143>>>>>>
54143>>>>>        End
54143>>>>>>
54143>>>>>        If (Cmoves.Enhm_Hmnies_Pel='1') Begin
54145>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
54147>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Xreosh
54148>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Xreosh
54149>>>>>            End
54149>>>>>>
54149>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
54152>>>>>                Move Cmoves.Cmoves_Hmnia   to Clients.Last_Pistosh
54153>>>>>                Move Cmoves.Cmoves_Hmnia   to PayResp.Last_Pistosh
54154>>>>>            End
54154>>>>>>
54154>>>>>            if ((clients.client_ptyppar='113') and (clients.client_public<>1)) begin 
54156>>>>>                move 1 to clients.client_public
54157>>>>>                move '' to clients.status  
54158>>>>>                Move '01/01/1753'   to Clients.SAP_Hmnia
54159>>>>>            end 
54159>>>>>>
54159>>>>>        End
54159>>>>>>
54159>>>>>
54159>>>>>             If ((Cmoves.Cmoves_M_Code='') And (Cmoves.Module_From  <>'')) Move Cmoves.Module_From     to Cmoves.Cmoves_M_Code
54162>>>>>        Else If ((Cmoves.Module_From  ='') And (Cmoves.Cmoves_M_Code<>'')) Move Cmoves.Cmoves_M_Code   to Cmoves.Module_From
54166>>>>>
54166>>>>>        If (Ctypkin.Open_Item='1') Move (Cmoves.Axia_Pros_Sysx-Cmoves.Axia_Sysxet) to Cmoves.Axia_Ypol_Sysx
54169>>>>>        Else Begin
54170>>>>>            Move 0 to Cmoves.Axia_Pros_Sysx
54171>>>>>            Move 0 to Cmoves.Axia_Sysxet
54172>>>>>            Move 0 to Cmoves.Axia_Ypol_Sysx
54173>>>>>        End
54173>>>>>>
54173>>>>>
54173>>>>>        // js 23/01/2002
54173>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
54173>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
54173>>>>>        Move (Cmoves.Axia_Ypol_Sysx<>0) to Cmoves.Flag_Ypol
54174>>>>>
54174>>>>>        // js 23/01/2002
54174>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
54174>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
54174>>>>>        // gia na emfanizei ta antistrofa sto copen
54174>>>>>        If (Ctypkin.Open_Item='1') Begin
54176>>>>>            If ((Cmoves.Cmoves_X0<>0) And ((Cmoves.Cmoves_P0=0))) Begin
54178>>>>>                Move 1                          to Cmoves.Flag_Copen
54179>>>>>                If (Cmoves.Cmoves_X0<0) Move 2  to Cmoves.Flag_Copen
54182>>>>>            End
54182>>>>>>
54182>>>>>            Else If ((Cmoves.Cmoves_P0<>0) And ((Cmoves.Cmoves_X0=0))) Begin
54185>>>>>                Move 2                          to Cmoves.Flag_Copen
54186>>>>>                If (Cmoves.Cmoves_P0<0) Move 1  to Cmoves.Flag_Copen
54189>>>>>            End
54189>>>>>>
54189>>>>>            Else Move 0 to Cmoves.Flag_Copen
54191>>>>>        End
54191>>>>>>
54191>>>>>        Else Move 0 to Cmoves.Flag_Copen
54193>>>>>    End_Procedure   // Update
54194>>>>>
54194>>>>>    Procedure Backout
54195>>>>>        Forward Send Backout
54197>>>>>
54197>>>>>        if (Cmoves.enhm_ofeilh='1') begin
54199>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Clients.Synolikh_ofeilh
54200>>>>>            sub (Cmoves.Cmoves_x0-Cmoves.cmoves_p0) from Payresp.Synolikh_ofeilh
54201>>>>>        end
54201>>>>>>
54201>>>>>
54201>>>>>//        if (Cmoves.enhm_ofeilh='2') begin
54201>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Clients.Synolikh_ofeilh
54201>>>>>//            sub ((Cmoves.Cmoves_x0-Cmoves.cmoves_p0)*-1) from Payresp.Synolikh_ofeilh
54201>>>>>//        end
54201>>>>>
54201>>>>>        If (Cmoves.Enhm_Ypol_Pel='1') Begin
54203>>>>>            If (Cmoves.Cmoves_x0<>0) Begin
54205>>>>>                Sub Cmoves.Cmoves_x0 From Clients.Xreosh
54206>>>>>                Sub Cmoves.Cmoves_x0 From PayResp.Xreosh
54207>>>>>            End
54207>>>>>>
54207>>>>>            Else If (Cmoves.Cmoves_p0<>0) Begin
54210>>>>>                Sub Cmoves.Cmoves_p0 From Clients.Pistosh
54211>>>>>                Sub Cmoves.Cmoves_p0 From PayResp.Pistosh
54212>>>>>            End
54212>>>>>>
54212>>>>>        End
54212>>>>>>
54212>>>>>    End_Procedure
54213>>>>>
54213>>>>>    Procedure Creating
54214>>>>>        Forward Send Creating
54216>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Cmoves.Cmoves_Rec0)))))) to Cmoves.Cmoves_Recr
54217>>>>>
54217>>>>>        //If ((Cmoves.Module_From='' ) Or (piFromBP(Self)<>1)) Move gs_Module_Code to Cmoves.Module_From
54217>>>>>
54217>>>>>        If (Ctypkin.Open_Item ='1') Begin
54219>>>>>                 If (Cmoves.Cmoves_x0<>0) Move (Abs(Cmoves.Cmoves_x0)) to Cmoves.Axia_Pros_Sysx
54222>>>>>            Else If (Cmoves.Cmoves_p0<>0) Move (Abs(Cmoves.Cmoves_p0)) to Cmoves.Axia_Pros_Sysx
54226>>>>>        End
54226>>>>>>
54226>>>>>    End_Procedure   // Creating
54227>>>>>
54227>>>>>
54227>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
54228>>>>>        String lsError_Message
54229>>>>>
54229>>>>>        Case Begin
54229>>>>>            
54229>>>>>            Case (iError_Num = 3263)
54231>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\n‰œ¤æ Cmoverecr!! Protem !!" to lsError_Message
54232>>>>>            Case Break
54233>>>>>            
54233>>>>>            Case (iError_Num = 6666)
54236>>>>>                Move "DDC 006: ‘­á¢£˜ 6666 €›ç¤˜«ž ž œšš¨˜­ž!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
54237>>>>>            Case Break
54238>>>>>
54238>>>>>            Case (iError_Num = 6667)
54241>>>>>                Move "DDC 006: ‘­á¢£˜ 6667 €›ç¤˜«ž ž œšš¨˜­ž!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
54242>>>>>            Case Break
54243>>>>>
54243>>>>>            Case (iError_Num = 6668)
54246>>>>>                Move "DDC 006: ‘­á¢£˜ 6668 €›ç¤˜«ž ž › ˜š¨˜­ã!\nƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ ¬§¦¡˜«˜©«ž£á«à¤" to lsError_Message
54247>>>>>            Case Break
54248>>>>>
54248>>>>>            Case (iError_Num = 6669)
54251>>>>>                Move "DDC 006: ‘­á¢£˜ 6669 €›ç¤˜«ž ž › ˜š¨˜­ã!\n†£/¤å˜ ¡å¤ž©žª §¨¦šœ¤â©«œ¨ž ž£/¤å˜ª ¡¢œ ›é£˜«¦ª" to lsError_Message
54252>>>>>            Case Break
54253>>>>>
54253>>>>>            Case (iError_Num = 22277)
54256>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n†£œ¨¦£ž¤åœª œ¡«æª ¦¨åà¤ ®¨ã©žª" to lsError_Message
54257>>>>>            Case Break
54258>>>>>
54258>>>>>            Case (iError_Num = 22278)
54261>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
54262>>>>>            Case Break
54263>>>>>
54263>>>>>            Case (iError_Num = 22279)
54266>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\„®œ  «¬§àŸœ  Ÿœà¨ž£â¤¦" to lsError_Message
54267>>>>>            Case Break
54268>>>>>
54268>>>>>            Case (iError_Num = 11170)
54271>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ ­¦¨â˜ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
54272>>>>>            Case Break
54273>>>>>
54273>>>>>            Case (iError_Num = 11171)
54276>>>>>                Move "DDC 006:’¦ § ©«à« ¡æ æ¨ ¦ «¦¬ “§. ¢ž¨à£é¤ â®œ  œ¥˜¤«¢žŸœå" to lsError_Message
54277>>>>>            Case Break
54278>>>>>
54278>>>>>            Case (iError_Num = 11172)
54281>>>>>                Move "DDC 006:Ž ­¦¨â˜ª œå¤˜  ¡¢œ ›à£â¤¦ª ¢æšà § ©«à« ¡¦ç ¦¨å¦¬" to lsError_Message
54282>>>>>            Case Break
54283>>>>>
54283>>>>>            Case (iError_Num = 22288)
54286>>>>>                Clear Codemast
54287>>>>>                Move "MODULE" to Codemast.Type
54288>>>>>                Move Cmoves.Module_From to Codemast.Code
54289>>>>>                Find Eq Codemast by Index.1 //type+code
54290>>>>>>
54290>>>>>                Move ("DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
54291>>>>>            Case Break
54292>>>>>
54292>>>>>            Case (iError_Num = 22250)
54295>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå¤˜  ¡œ¤æ" to lsError_Message
54296>>>>>            Case Break
54297>>>>>
54297>>>>>            Case (iError_Num = 22284)
54300>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
54301>>>>>            Case Break
54302>>>>>            Case (iError_Num = 22283)
54305>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
54306>>>>>            Case Break
54307>>>>>            Case (iError_Num = 22282)
54310>>>>>                Move "DDC 006:€›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
54311>>>>>            Case Break
54312>>>>>
54312>>>>>            //˜§æ validate delete
54312>>>>>            Case (iError_Num = 22289)
54315>>>>>                Clear Codemast
54316>>>>>                Move "MODULE" to Codemast.Type
54317>>>>>                Move Cmoves.Module_From to Codemast.Code
54318>>>>>                Find Eq Codemast by Index.1 //type+code
54319>>>>>>
54319>>>>>                Move ("DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
54320>>>>>            Case Break
54321>>>>>
54321>>>>>            Case (iError_Num = 22287)
54324>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ €¥ æš¨˜­˜" to lsError_Message
54325>>>>>            Case Break
54326>>>>>            Case (iError_Num = 22286)
54329>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
54330>>>>>            Case Break
54331>>>>>            Case (iError_Num = 22285)
54334>>>>>                Move "DDC 006:€›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª €š¦¨âª" to lsError_Message
54335>>>>>            Case Break
54336>>>>>
54336>>>>>            //â¢œš®¦  open items
54336>>>>>            Case (iError_Num = 10101)
54339>>>>>                Move ("DDC 006:€¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
54340>>>>>            Case Break
54341>>>>>
54341>>>>>            Case Else
54341>>>>>                Forward Send Operation_Not_Allowed iError_Num
54343>>>>>        Case End
54343>>>>>
54343>>>>>        Error iError_Num lsError_Message
54344>>>>>>
54344>>>>>    End_Procedure // operation_not_allowed
54345>>>>>
54345>>>>>
54345>>>>>    // Define_Fields:
54345>>>>>    // This procedure is used to set up all data-dictionary rules.
54345>>>>>
54345>>>>>    Procedure Define_Fields
54346>>>>>        Forward Send Define_Fields
54348>>>>>        //DDB-Generated-Code-Location
54348>>>>>        //DDB-DefineFieldStart
54348>>>>>
54348>>>>>        Set Main_File            To Cmoves.File_Number
54349>>>>>        Set Cascade_Delete_State To FALSE
54350>>>>>
54350>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
54351>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
54352>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
54353>>>>>
54353>>>>>        // Child (Client) file structure................
54353>>>>>        Send Add_Client_File  Copen.File_Number
54354>>>>>
54354>>>>>        // Parent (Server) file structure...............
54354>>>>>        Send Add_Server_File  Ctypkin.File_Number
54355>>>>>        Send Add_Server_File  Clients.File_Number
54356>>>>>
54356>>>>>        // External (System) file structure.............
54356>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_NEW_SAVE_DELETE
54357>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
54358>>>>>
54358>>>>>        Define_Auto_Increment  Sysrecc.Cmoves_Rec0  To Cmoves.Cmoves_Rec0
54361>>>>>
54361>>>>>        // Field-based properties.......................
54361>>>>>
54361>>>>>        // Cmoves.Company_Code
54361>>>>>
54361>>>>>        // Cmoves.Branch_Code
54361>>>>>
54361>>>>>        // Cmoves.Year_Year
54361>>>>>
54361>>>>>        // Cmoves.Custprom_Code
54361>>>>>
54361>>>>>        // Cmoves.Client_Id
54361>>>>>
54361>>>>>        // Cmoves.Ctypkin_Code
54361>>>>>
54361>>>>>        // Cmoves.Cmoves_Recr
54361>>>>>
54361>>>>>        // Cmoves.Cmoves_Rec0
54361>>>>>        Set Field_Options          Field Cmoves.Cmoves_Rec0 To DD_AUTOFIND   
54362>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Rec0 To (sl006(Self))
54363>>>>>
54363>>>>>        // Cmoves.Cmoves_Hmnia
54363>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Hmnia To (sl006(Self))
54364>>>>>
54364>>>>>        // Cmoves.Ctypkin_Recr
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Par
54364>>>>>
54364>>>>>        // Cmoves.Partl_Recr
54364>>>>>        //DDB/ Comment_Short       Field Cmoves.Partl_Recr To "‘¬¤›œ©ž record £œ ¡ç¡¢à£˜ à¢ã©œà¤"
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Axia
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_X0
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_P0
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_X00
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_P00
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_X1
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_P1
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_X2
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_P2
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Dlixis
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_A_Code
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Status_E
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Status_A
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_S0
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Ys0
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_S1
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Ys1
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_S2
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Ys2
54364>>>>>
54364>>>>>        // Cmoves.Cmoves_Sc_Code2
54364>>>>>        Set Field_Prompt_Object    Field Cmoves.Cmoves_Sc_Code2 To (slNomism(Self))
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_Open
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_Aopen
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_M_Code
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_Yn_Myf
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_Myf_Axia
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_Kk
54365>>>>>
54365>>>>>        // Cmoves.Cmoves_C_Code2
54365>>>>>
54365>>>>>        // Cmoves.Cn_Code
54365>>>>>        Set Field_Prompt_Object    Field Cmoves.Cn_Code To (sl041(Self))
54366>>>>>
54366>>>>>        // Cmoves.Client_Recr
54366>>>>>
54366>>>>>        // Cmoves.Barticl_Recr
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Qty
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Totambd0
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Discam0
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Totamad0
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Vatam0
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Extra0
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Totambd00
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Discam00
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Totamad00
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Vatam00
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Extra00
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Totambd1
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Discam1
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Totamad1
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Vatam1
54366>>>>>
54366>>>>>        // Cmoves.Cmove_Extra1
54366>>>>>
54366>>>>>        // Cmoves.Module_From
54366>>>>>
54366>>>>>        // Cmoves.Parast_Abrev
54366>>>>>
54366>>>>>        // Cmoves.Enhm_Ypol_Pel
54366>>>>>
54366>>>>>        // Cmoves.Enhm_Hmnies_Pel
54366>>>>>
54366>>>>>        // Cmoves.Sls_Id
54366>>>>>
54366>>>>>        // Cmoves.Presp_Id
54366>>>>>
54366>>>>>        // Cmoves.Cnt_Id
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Sx0
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Sp0
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Yx0
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Yp0
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Sx1
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Sp1
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Sx2
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Open_Sp2
54366>>>>>
54366>>>>>        // Cmoves.Cmoves_Topen
54366>>>>>
54366>>>>>        // Cmoves.Cn_Recr
54366>>>>>
54366>>>>>        // Cmoves.Axia_Pros_Sysx
54366>>>>>
54366>>>>>        // Cmoves.Axia_Sysxet
54366>>>>>
54366>>>>>        // Cmoves.Axia_Ypol_Sysx
54366>>>>>
54366>>>>>        // Cmoves.Axia_Pros_Sys00
54366>>>>>
54366>>>>>        // Cmoves.Axia_Sysxet00
54366>>>>>
54366>>>>>        // Cmoves.Axia_Ypol_Sys00
54366>>>>>
54366>>>>>        // Cmoves.Axia_Pros_Sysr
54366>>>>>
54366>>>>>        // Cmoves.Axia_Sysxetr
54366>>>>>
54366>>>>>        // Cmoves.Axia_Ypol_Sysr
54366>>>>>
54366>>>>>        // Cmoves.Mhxanik_Id
54366>>>>>
54366>>>>>        // Cmoves.Prn_Theor
54366>>>>>
54366>>>>>        // Cmoves.Is_Closed
54366>>>>>
54366>>>>>        // Cmoves.Flag_Copen
54366>>>>>
54366>>>>>        // Cmoves.Flag_Ypol
54366>>>>>
54366>>>>>        // Cmoves.Ctypkin_Descr
54366>>>>>
54366>>>>>        // Cmoves.Client_Name
54366>>>>>
54366>>>>>        // Cmoves.Enhm_Ofeilh
54366>>>>>
54366>>>>>        // Cmoves.Sap_Hmnia
54366>>>>>
54366>>>>>        //DDB-DefineFieldEnd
54366>>>>>    End_Procedure    // Define_Fields
54367>>>>>
54367>>>>>    // Field_Defaults:
54367>>>>>    // This procedure is used to establish default field values.
54367>>>>>
54367>>>>>    Procedure Field_Defaults
54368>>>>>        Forward Send Field_Defaults
54370>>>>>        //DDB-Generated-Code-Location
54370>>>>>        //DDB-FieldDefaultStart
54370>>>>>        //DDB-FieldDefaultEnd
54370>>>>>    End_Procedure    // Field_Defaults
54371>>>>>
54371>>>>>End_Class    // Cmoves_DataDictionary
54372>>>>>//DDB-Selection-pkg-Start
54372>>>>>
54372>>>>>Use sl006.SL         // sl006
INCLUDING FILE: SL006.SL
54372>>>>>>>//AB/ Project sl006:Cmoves lookup
54372>>>>>>>//AB/ Object prj is a Lookup_Project
54372>>>>>>>//AB/     Set ProjectName to "sl006:Cmoves lookup"
54372>>>>>>>//AB/     Set ProjectFileName to "sl006.SL"
54372>>>>>>>//AB/     Set GenerateFileName to "NONAME"
54372>>>>>>>
54372>>>>>>>// Project Object Structure
54372>>>>>>>//   sl006 is a dbModalPanelSub
54372>>>>>>>//     Ctypkin_DD is a DataDictionary
54372>>>>>>>//     Clients_DD is a DataDictionary
54372>>>>>>>//     Cmoves_DD is a DataDictionary
54372>>>>>>>//     oSelList is a dbListSub
54372>>>>>>>//     oOK_bn is a ButtonSub
54372>>>>>>>//     oCancel_bn is a ButtonSub
54372>>>>>>>//     oSearch_bn is a ButtonSub
54372>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
54372>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
54372>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
54372>>>>>>>//     TextBoxSub1 is a TextBoxSub
54372>>>>>>>//     TextBoxSub2 is a TextBoxSub
54372>>>>>>>//     TextBoxSub3 is a TextBoxSub
54372>>>>>>>//     RadioGroupSub2 is a RadioGroupSub
54372>>>>>>>//       Radio4 is a RadioSub
54372>>>>>>>//       Radio5 is a RadioSub
54372>>>>>>>//       Radio6 is a RadioSub
54372>>>>>>>
54372>>>>>>>// Register all objects
54372>>>>>>>Register_Object Clients_DD
54372>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
54372>>>>>>>Register_Object Cmoves_Axia_Sysxet
54372>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
54372>>>>>>>Register_Object Cmoves_DD
54372>>>>>>>Register_Object Ctypkin_DD
54372>>>>>>>Register_Object oCancel_bn
54372>>>>>>>Register_Object oOK_bn
54372>>>>>>>Register_Object oSearch_bn
54372>>>>>>>Register_Object oSelList
54372>>>>>>>Register_Object Radio4
54372>>>>>>>Register_Object Radio5
54372>>>>>>>Register_Object Radio6
54372>>>>>>>Register_Object RadioGroupSub2
54372>>>>>>>Register_Object sl006
54372>>>>>>>Register_Object TextBoxSub1
54372>>>>>>>Register_Object TextBoxSub2
54372>>>>>>>Register_Object TextBoxSub3
54372>>>>>>>
54372>>>>>>>
54372>>>>>>>//AB-IgnoreStart
54372>>>>>>>
54372>>>>>>>Use DFAllEnt.pkg
54372>>>>>>>Use dbList.Sub
54372>>>>>>>Use Button.Sub
54372>>>>>>>Use dbForm.Sub
54372>>>>>>>Use Txtbox.Sub
54372>>>>>>>Use Rgroup.Sub
54372>>>>>>>Use Radio.Sub
54372>>>>>>>
54372>>>>>>>
54372>>>>>>>Use CTYPKIN.DD
54372>>>>>>>Use CLIENTS.DD
54372>>>>>>>Use CMOVES.DD
54372>>>>>>>
54372>>>>>>>//AB-IgnoreEnd
54372>>>>>>>
54372>>>>>>>Object sl006 is a dbModalPanelSub
54374>>>>>>>
54374>>>>>>>    //AB-StoreTopStart
54374>>>>>>>                                        
54374>>>>>>>    Property String     psModule    Public ''
54376>>>>>>>    Property String     psClientID  Public ''
54378>>>>>>>    Property Date       pdApo       public ''
54380>>>>>>>    Property Date       pdEos       public ''
54382>>>>>>>    Property Integer    piXr_Or_Pi  public  0
54384>>>>>>>    Property Integer    piWhat      public  0
54386>>>>>>>    
54386>>>>>>>    //AB-StoreTopEnd
54386>>>>>>>
54386>>>>>>>    Set Label to "‰ ¤ã©œ ª ”¦¨âà¤"
54387>>>>>>>    Set Size to 270 519
54388>>>>>>>    Set Location to 5 7
54389>>>>>>>    Set Exit_Application_Local_State to FALSE
54390>>>>>>>    Set Modal_State to FALSE
54391>>>>>>>
54391>>>>>>>    //AB-DDOStart
54391>>>>>>>
54391>>>>>>>    Object Ctypkin_DD is a Ctypkin_DataDictionary
54393>>>>>>>    End_Object    // Ctypkin_DD
54394>>>>>>>
54394>>>>>>>    Object Clients_DD is a Clients_DataDictionary
54396>>>>>>>    End_Object    // Clients_DD
54397>>>>>>>
54397>>>>>>>    Object Cmoves_DD is a Cmoves_DataDictionary
54399>>>>>>>        Set DDO_Server to (Ctypkin_DD(self))
54400>>>>>>>        Set DDO_Server to (Clients_DD(self))
54401>>>>>>>
54401>>>>>>>        //AB-StoreStart
54401>>>>>>>        
54401>>>>>>>        Begin_Constraints
54403>>>>>>>        
54403>>>>>>>            Constrain Cmoves.Company_Code   Eq SyscurXr.Company_Code
54405>>>>>>>            Constrain Cmoves.Year_Year      Eq SyscurXr.Year_Year
54407>>>>>>>        
54407>>>>>>>            If (psClientID(Self)<>'')   Constrain Cmoves.Client_ID      Eq (psClientID(Self))
54411>>>>>>>            If (pdApo(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
54415>>>>>>>            If (pdEos(Self)<>'')        Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
54419>>>>>>>        
54419>>>>>>>            Constrain Cmoves.Module_From    Eq (psModule(Self))
54421>>>>>>>        
54421>>>>>>>                 If (piWhat(Self)=1) Constrain Cmoves.Flag_Ypol Eq 1
54425>>>>>>>            Else If (piWhat(Self)=2) Constrain Cmoves.Flag_Ypol Eq 0
54430>>>>>>>        
54430>>>>>>>        End_Constraints
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        
54433>>>>>>>        //AB-StoreEnd
54433>>>>>>>
54433>>>>>>>    End_Object    // Cmoves_DD
54434>>>>>>>
54434>>>>>>>    Set Main_DD to (Cmoves_DD(self))
54435>>>>>>>    Set Server to (Cmoves_DD(self))
54436>>>>>>>
54436>>>>>>>    //AB-DDOEnd
54436>>>>>>>
54436>>>>>>>    Object oSelList is a dbListSub
54438>>>>>>>
54438>>>>>>>        //AB-StoreTopStart
54438>>>>>>>                                                                                                                                                                                                                                                                                                                            
54438>>>>>>>        //AB-StoreTopEnd
54438>>>>>>>
54438>>>>>>>        Set Main_File to Cmoves.File_Number
54439>>>>>>>        Set Ordering to 4
54440>>>>>>>        Set Size to 199 505
54441>>>>>>>        Set Location to 31 7
54442>>>>>>>        Set Auto_Index_State to FALSE
54443>>>>>>>
54443>>>>>>>        Begin_Row
54446>>>>>>>            Entry_Item Cmoves.Cmoves_hmnia
54447>>>>>>>            Entry_Item Cmoves.Cmoves_par
54448>>>>>>>            Entry_Item Ctypkin.Ctypkin_descr
54449>>>>>>>            Entry_Item Clients.Client_name
54450>>>>>>>            Entry_Item Cmoves.Cmoves_axia
54451>>>>>>>            Entry_Item Cmoves.Cmoves_sc_code2
54452>>>>>>>            Entry_Item Cmoves.Branch_code
54453>>>>>>>        End_Row
54458>>>>>>>
54458>>>>>>>        Set Form_Width    item 0 to 57
54459>>>>>>>        Set Header_Label  item 0 to "†£œ¨/¤å˜"
54460>>>>>>>        
54460>>>>>>>        Set Form_Width    item 1 to 121
54461>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
54462>>>>>>>        
54462>>>>>>>        Set Form_Width    item 2 to 65
54463>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
54464>>>>>>>        
54464>>>>>>>        Set Form_Width    item 3 to 107
54465>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
54466>>>>>>>        
54466>>>>>>>        Set Form_Width    item 4 to 63
54467>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
54468>>>>>>>        
54468>>>>>>>        Set Form_Width    item 5 to 42
54469>>>>>>>        Set Header_Label  item 5 to "Œæ£ ©£˜"
54470>>>>>>>        
54470>>>>>>>        Set Form_Width    item 6 to 45
54471>>>>>>>        Set Header_Label  item 6 to "“§¦¡/£˜"
54472>>>>>>>        
54472>>>>>>>
54472>>>>>>>        //AB-StoreStart
54472>>>>>>>                                                                                                                                                                                                                                                                                                                            
54472>>>>>>>        Procedure End_Construct_Object
54474>>>>>>>            String  sNom
54475>>>>>>>            Integer iDecs
54475>>>>>>>            Forward Send End_Construct_Object
54477>>>>>>>            Move SysCurxr.C_Code0 to sNom
54478>>>>>>>            Clear Nomisma
54479>>>>>>>            Move sNom to Nomisma.Nomisma_Code
54480>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
54481>>>>>>>>
54481>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
54484>>>>>>>            Else            Move 0 to iDecs
54486>>>>>>>        
54486>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
54486>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
54486>>>>>>>            If (iDecs=0) Move 2 to iDecs
54489>>>>>>>            //
54489>>>>>>>        
54489>>>>>>>            Set Points          Item 4 to       iDecs
54490>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs '*, '
54491>>>>>>>        End_Procedure
54492>>>>>>>        
54492>>>>>>>        
54492>>>>>>>        
54492>>>>>>>        
54492>>>>>>>        
54492>>>>>>>        //AB-StoreEnd
54492>>>>>>>
54492>>>>>>>    End_Object    // oSelList
54493>>>>>>>
54493>>>>>>>    Object oOK_bn is a ButtonSub
54495>>>>>>>        Set Label to "&„§ ¢¦šã"
54496>>>>>>>        Set Location to 236 350
54497>>>>>>>
54497>>>>>>>        //AB-StoreStart
54497>>>>>>>        Procedure OnClick
54499>>>>>>>            Send OK To (oSelList(current_object))
54500>>>>>>>        End_Procedure
54501>>>>>>>        //AB-StoreEnd
54501>>>>>>>
54501>>>>>>>    End_Object    // oOK_bn
54502>>>>>>>
54502>>>>>>>    Object oCancel_bn is a ButtonSub
54504>>>>>>>        Set Label to "&€¡ç¨à©ž"
54505>>>>>>>        Set Location to 236 404
54506>>>>>>>
54506>>>>>>>        //AB-StoreStart
54506>>>>>>>        Procedure OnClick
54508>>>>>>>            Send Cancel To (oSelList(current_object))
54509>>>>>>>        End_Procedure
54510>>>>>>>        //AB-StoreEnd
54510>>>>>>>
54510>>>>>>>    End_Object    // oCancel_bn
54511>>>>>>>
54511>>>>>>>    Object oSearch_bn is a ButtonSub
54513>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
54514>>>>>>>        Set Location to 236 460
54515>>>>>>>
54515>>>>>>>        //AB-StoreStart
54515>>>>>>>        Procedure OnClick
54517>>>>>>>            Send Search To (oSelList(current_object))
54518>>>>>>>        End_Procedure
54519>>>>>>>        //AB-StoreEnd
54519>>>>>>>
54519>>>>>>>    End_Object    // oSearch_bn
54520>>>>>>>
54520>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
54522>>>>>>>        Entry_Item Cmoves.Axia_pros_sysx
54523>>>>>>>        Set Size to 13 54
54524>>>>>>>        Set Location to 236 24
54525>>>>>>>        Set Color to clBtnFace
54526>>>>>>>        Set Label_Col_Offset to 2
54527>>>>>>>        Set Label_Justification_Mode to jMode_Right
54528>>>>>>>        Set Enabled_State to FALSE
54529>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
54530>>>>>>>        Set Shadow_State Item 0 to TRUE
54531>>>>>>>
54531>>>>>>>        //AB-StoreStart
54531>>>>>>>        Set points item 0 to 2
54532>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
54533>>>>>>>        
54533>>>>>>>        //AB-StoreEnd
54533>>>>>>>
54533>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
54534>>>>>>>
54534>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
54536>>>>>>>        Entry_Item Cmoves.Axia_sysxet
54537>>>>>>>        Set Size to 13 54
54538>>>>>>>        Set Location to 236 140
54539>>>>>>>        Set Color to clBtnFace
54540>>>>>>>        Set Label_Col_Offset to 2
54541>>>>>>>        Set Label_Justification_Mode to jMode_Right
54542>>>>>>>        Set Enabled_State to FALSE
54543>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
54544>>>>>>>        Set Shadow_State Item 0 to TRUE
54545>>>>>>>
54545>>>>>>>        //AB-StoreStart
54545>>>>>>>        Set points item 0 to 2
54546>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
54547>>>>>>>        
54547>>>>>>>        //AB-StoreEnd
54547>>>>>>>
54547>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
54548>>>>>>>
54548>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
54550>>>>>>>        Entry_Item Cmoves.Axia_ypol_sysx
54551>>>>>>>        Set Size to 13 54
54552>>>>>>>        Set Location to 236 248
54553>>>>>>>        Set Color to clBtnFace
54554>>>>>>>        Set Label_Col_Offset to 2
54555>>>>>>>        Set Label_Justification_Mode to jMode_Right
54556>>>>>>>        Set Enabled_State to FALSE
54557>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
54558>>>>>>>        Set Shadow_State Item 0 to TRUE
54559>>>>>>>
54559>>>>>>>        //AB-StoreStart
54559>>>>>>>                                                                                                    
54559>>>>>>>        Set points item 0 to 2
54560>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
54561>>>>>>>        
54561>>>>>>>        //AB-StoreEnd
54561>>>>>>>
54561>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
54562>>>>>>>
54562>>>>>>>    Object TextBoxSub1 is a TextBoxSub
54564>>>>>>>        Set Label to "€¥å˜"
54565>>>>>>>        Set Location to 238 7
54566>>>>>>>        Set Size to 10 15
54567>>>>>>>    End_Object    // TextBoxSub1
54568>>>>>>>
54568>>>>>>>    Object TextBoxSub2 is a TextBoxSub
54570>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
54571>>>>>>>        Set Location to 238 89
54572>>>>>>>        Set Size to 10 49
54573>>>>>>>    End_Object    // TextBoxSub2
54574>>>>>>>
54574>>>>>>>    Object TextBoxSub3 is a TextBoxSub
54576>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
54577>>>>>>>        Set Location to 238 210
54578>>>>>>>        Set Size to 10 35
54579>>>>>>>    End_Object    // TextBoxSub3
54580>>>>>>>
54580>>>>>>>    Object RadioGroupSub2 is a RadioGroupSub
54582>>>>>>>        Set Label to "„§ ¢¦šã ‰ ¤ã©œà¤"
54583>>>>>>>        Set Size to 24 497
54584>>>>>>>        Set Location to 3 9
54585>>>>>>>        Object Radio4 is a RadioSub
54587>>>>>>>            Set Label to "Ž¢œª"
54588>>>>>>>            Set Size to 10 37
54589>>>>>>>            Set Location to 10 97
54590>>>>>>>        End_Object    // Radio4
54591>>>>>>>
54591>>>>>>>        Object Radio5 is a RadioSub
54593>>>>>>>            Set Label to "‹œ ¬§æ¢¦ §¦ ©¬©®â« ©žª"
54594>>>>>>>            Set Size to 10 97
54595>>>>>>>            Set Location to 10 167
54596>>>>>>>        End_Object    // Radio5
54597>>>>>>>
54597>>>>>>>        Object Radio6 is a RadioSub
54599>>>>>>>            Set Label to "•à¨åª ¬§æ¢¦ §¦ ©¬©®â« ©žª"
54600>>>>>>>            Set Size to 10 111
54601>>>>>>>            Set Location to 10 278
54602>>>>>>>        End_Object    // Radio6
54603>>>>>>>
54603>>>>>>>
54603>>>>>>>        //AB-StoreStart
54603>>>>>>>                                                                                        
54603>>>>>>>        Procedure Notify_Select_State integer iToItem integer iFromItem
54605>>>>>>>            Set piWhat to iToItem
54606>>>>>>>            Send Rebuild_Constraints to Cmoves_DD
54607>>>>>>>            Send Beginning_Of_Data To oSelList True
54608>>>>>>>        End_Procedure
54609>>>>>>>        
54609>>>>>>>        Set Current_Radio to 1
54610>>>>>>>        
54610>>>>>>>        
54610>>>>>>>        
54610>>>>>>>        
54610>>>>>>>        //AB-StoreEnd
54610>>>>>>>
54610>>>>>>>    End_Object    // RadioGroupSub2
54611>>>>>>>
54611>>>>>>>
54611>>>>>>>    //AB-StoreStart
54611>>>>>>>                                        
54611>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
54612>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
54613>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
54614>>>>>>>    
54614>>>>>>>    Set Modal_State to True
54615>>>>>>>    
54615>>>>>>>    Procedure Activate
54617>>>>>>>        String  sNom
54618>>>>>>>        Integer iDecs rVal
54618>>>>>>>        Set piWhat to 1
54619>>>>>>>        Set Current_Radio Of RadioGroupSub2 to 1
54620>>>>>>>        Forward Send Activate
54622>>>>>>>        Send Rebuild_Constraints        to Cmoves_DD
54623>>>>>>>        Send Beginning_Of_Data          to oSelList True
54624>>>>>>>    End_procedure
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    
54625>>>>>>>    //AB-StoreEnd
54625>>>>>>>
54625>>>>>>>End_Object    // sl006
54626>>>>>>>
54626>>>>>>>//AB/ End_Object    // prj
54626>>>>>Use slnomism.sl      // slNomism
54626>>>>>Use sl041.SL         // sl041
54626>>>>>
54626>>>>>//DDB-Selection-pkg-End
54626>>>>>//DDB-FileEnd
54626>>>    USE CMOVESA.DD
INCLUDING FILE: CMOVESA.DD
54626>>>>>//DDB-FileStart
54626>>>>>//DDB-HeaderStart
54626>>>>>
54626>>>>>// File Name : CMOVESA.DD
54626>>>>>// Class Name: Cmovesa_DataDictionary
54626>>>>>// Revision  : 58
54626>>>>>// Version   : 2
54626>>>>>
54626>>>>>Use  Windows           // Basic Definitions
54626>>>>>Use  DataDict          // DataDictionary Class Definition
54626>>>>>Use  DDvalTbl          // Validation Table Class Definitions
54626>>>>>
54626>>>>>Open Cmovesa
54628>>>>>Open Copen
54630>>>>>
54630>>>>>//DDB-HeaderEnd
54630>>>>>//DDB-SelectionStart
54630>>>>>//DDB/ ExternalSelectionList sl006a1  sl006a1.SL
54630>>>>>Register_Object sl006a1
54630>>>>>//DDB-SelectionEnd
54630>>>>>//open master file
54630>>>>>Open Cmoves
54632>>>>>
54632>>>>>//define alias-master condition
54632>>>>>Set_Attribute DF_FILE_ALIAS of Cmoves.File_Number  to DF_FILE_IS_MASTER
54635>>>>>Set_Attribute DF_FILE_ALIAS of Cmovesa.File_Number to DF_FILE_IS_ALIAS
54638>>>>>
54638>>>>>Set_Relate Cmovesa.Ctypkin_Recr     to |FN0,0
54639>>>>>>
54639>>>>>Set_Relate Cmovesa.Client_Recr      to |FN0,0
54640>>>>>>
54640>>>>>
54640>>>>>Class Cmovesa_DataDictionary  is a DataDictionary_Sec
54641>>>>>
54641>>>>>//    Procedure Do_Compute_Open_Itemsa
54641>>>>>//        Case Begin
54641>>>>>//                Case (Cmovesa.Cmoves_X0 > 0) //˜«æ­ ¦ ®¨œà©« ¡æ record
54641>>>>>//                    Move "+"                                              to Cmovesa.Cmoves_Topen
54641>>>>>//                    Move (Cmovesa.Cmoves_X0 - Cmovesa.Cmoves_Open_Sx0)    to Cmovesa.Cmoves_Open_Yx0
54641>>>>>//                    Move 0                                                to Cmovesa.Cmoves_Open_Yp0
54641>>>>>//                Case Break
54641>>>>>
54641>>>>>//                Case (Cmovesa.Cmoves_X0 < 0) //¯œ¬«¦- ®¨œà©« ¡æ record
54641>>>>>//                    Move "-"                                                 to Cmovesa.Cmoves_Topen
54641>>>>>//                    Move ((Abs(Cmovesa.Cmoves_X0))- Cmovesa.Cmoves_Open_Sp0) to Cmovesa.Cmoves_Open_Yp0
54641>>>>>//                    Move 0                                                   to Cmovesa.Cmoves_Open_Yx0
54641>>>>>//                Case Break
54641>>>>>
54641>>>>>//                Case (Cmovesa.Cmoves_P0 > 0) //˜«æ­ ¦ § ©«à« ¡æ record
54641>>>>>//                    Move "-"                                              to Cmovesa.Cmoves_Topen
54641>>>>>//                    Move (Cmovesa.Cmoves_P0 - Cmovesa.Cmoves_Open_Sp0)    to Cmovesa.Cmoves_Open_Yp0
54641>>>>>//                    Move 0                                                to Cmovesa.Cmoves_Open_Yx0
54641>>>>>//                Case Break
54641>>>>>
54641>>>>>//                Case (Cmovesa.Cmoves_P0 < 0) //¯œç«¦- § ©«à« ¡æ record
54641>>>>>//                    Move "+"                                                 to Cmovesa.Cmoves_Topen
54641>>>>>//                    Move ((Abs(Cmovesa.Cmoves_P0))-Cmovesa.Cmoves_Open_Sx0)  to Cmovesa.Cmoves_Open_Yx0
54641>>>>>//                    Move 0                                                   to Cmovesa.Cmoves_Open_Yp0
54641>>>>>//                Case Break
54641>>>>>//        Case End
54641>>>>>//    End_Procedure //do_compute_open_itemsa
54641>>>>>
54641>>>>>
54641>>>>>      //œ¢âš®œ  «˜ 13 §œ›å˜ open item
54641>>>>>      //¡˜¢œå«˜  ˜§æ validate save
54641>>>>>      Function  fi_Validate_Open_Itemsa Returns Integer
54642>>>>>
54642>>>>>                 //1101+1102+1103+1104:â¢œš®¦  £ã ˜¨¤ž« ¡é¤ ¬§¦¢¦å§à¤ §¨¦ª ©¬©®â« ©ž ¡˜  ©¬©®œ« ©Ÿâ¤«à¤ §¦©é¤
54642>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 >= 0                       )) Function_Return 1101
54645>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 >= 0                       )) Function_Return 1102
54648>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 >= 0                       )) Function_Return 1103
54651>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 >= 0                       )) Function_Return 1104
54654>>>>>
54654>>>>>                 Case Begin
54654>>>>>                      //1105+1106+1107+1108:â¢œš®¦  š ˜ ˜«æ­ ¦ ®¨œà©« ¡æ record
54654>>>>>                      Case (Cmovesa.Cmoves_X0 > 0)
54656>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 <=      Cmovesa.Cmoves_X0  )) Function_Return 1105
54659>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 <=      Cmovesa.Cmoves_X0  )) Function_Return 1106
54662>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0  = 0                       )) Function_Return 1107
54665>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0  = 0                       )) Function_Return 1108
54668>>>>>                      Case Break
54669>>>>>                      //1109+1110+1111+1112:â¢œš®¦  š ˜ ¯œ¬«¦- ®¨œà©« ¡æ record
54669>>>>>                      Case (Cmovesa.Cmoves_X0 < 0)
54672>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0  = 0                       )) Function_Return 1109
54675>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0  = 0                       )) Function_Return 1110
54678>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 <= (Abs(Cmovesa.Cmoves_X0)))) Function_Return 1111
54681>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 <= (Abs(Cmovesa.Cmoves_X0)))) Function_Return 1112
54684>>>>>                      Case Break
54685>>>>>                      //1113+1114+1115+1116:â¢œš®¦  š ˜ ˜«æ­ ¦ § ©«à« ¡æ record
54685>>>>>                      Case (Cmovesa.Cmoves_P0 > 0)
54688>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0  = 0                       )) Function_Return 1113
54691>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0  = 0                       )) Function_Return 1114
54694>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0 <=      Cmovesa.Cmoves_P0  )) Function_Return 1115
54697>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0 <=      Cmovesa.Cmoves_P0  )) Function_Return 1116
54700>>>>>                      Case Break
54701>>>>>                      //1117+1118+1119+1120:â¢œš®¦  š ˜ ¯œç«¦- ®¨œà©« ¡æ record
54701>>>>>                      Case (Cmovesa.Cmoves_P0 < 0)
54704>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yx0 <= (Abs(Cmovesa.Cmoves_P0)))) Function_Return 1117
54707>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sx0 <= (Abs(Cmovesa.Cmoves_P0)))) Function_Return 1118
54710>>>>>                           If (Not(Cmovesa.Cmoves_Open_Yp0  = 0                       )) Function_Return 1119
54713>>>>>                           If (Not(Cmovesa.Cmoves_Open_Sp0  = 0                       )) Function_Return 1120
54716>>>>>                      Case Break
54717>>>>>                 Case End
54717>>>>>
54717>>>>>                 Function_Return 0 //æ¢˜ ok
54718>>>>>      End_Function //fi_validate_open_itemsa
54719>>>>>
54719>>>>>
54719>>>>>    Procedure Update 
54720>>>>>        
54720>>>>>        Forward Send Update
54722>>>>>                        
54722>>>>>        If (Cmovesa.Cmoves_M_Code='') Move Cmovesa.Module_From to Cmovesa.Cmoves_M_Code
54725>>>>>//        Send Do_Compute_Open_Itemsa
54725>>>>>
54725>>>>>        If (Ctypkin.Open_Item='1') Move (CmovesA.Axia_Pros_Sysx-CmovesA.Axia_Sysxet) to CmovesA.Axia_Ypol_Sysx
54728>>>>>        Else Begin
54729>>>>>            Move 0 to CmovesA.Axia_Pros_Sysx
54730>>>>>            Move 0 to CmovesA.Axia_Sysxet 
54731>>>>>            Move 0 to CmovesA.Axia_Ypol_Sysx
54732>>>>>        End
54732>>>>>>
54732>>>>>
54732>>>>>        // js 23/01/2002
54732>>>>>        // Enhmerosh Pediou Flag_Ypol to opoio antiprosopeyei
54732>>>>>        // to an h eggrafh exei diathesimo ypoloipo pros sysxetish
54732>>>>>        Move (CmovesA.Axia_Ypol_Sysx<>0) to CmovesA.Flag_Ypol
54733>>>>>
54733>>>>>        // js 23/01/2002
54733>>>>>        // Enhmerosh Pediou Flag_Open to opoio antiprosopeyei
54733>>>>>        // an einai xreosh=1, pistosh=2, arnhtikh xreosh=2 arnhtikh Pistosh=1
54733>>>>>        // gia na emfanizei ta antistrofa sto copen
54733>>>>>        If (Ctypkin.Open_Item='1') Begin
54735>>>>>            If ((CmovesA.Cmoves_X0<>0) And ((CmovesA.Cmoves_P0=0))) Begin
54737>>>>>                Move 1                          to CmovesA.Flag_Copen
54738>>>>>                If (CmovesA.Cmoves_X0<0) Move 2 to CmovesA.Flag_Copen
54741>>>>>            End
54741>>>>>>
54741>>>>>            Else If ((CmovesA.Cmoves_P0<>0) And ((CmovesA.Cmoves_X0=0))) Begin
54744>>>>>                Move 2                          to CmovesA.Flag_Copen
54745>>>>>                If (CmovesA.Cmoves_P0<0) Move 1 to CmovesA.Flag_Copen
54748>>>>>            End
54748>>>>>>
54748>>>>>            Else Move 0 to CmovesA.Flag_Copen
54750>>>>>        End 
54750>>>>>>
54750>>>>>        Else Move 0 to CmovesA.Flag_Copen
54752>>>>>    End_Procedure //update
54753>>>>>
54753>>>>>
54753>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
54754>>>>>        String lsError_Message
54755>>>>>        Case Begin
54755>>>>>            //˜§æ validate save
54755>>>>>            Case (iError_Num = 88888)
54757>>>>>                Clear Codemast
54758>>>>>                Move "MODULE" to Codemast.Type
54759>>>>>                Move Cmovesa.Module_From to Codemast.Code
54760>>>>>                Find Eq Codemast by Index.1 //type+code
54761>>>>>>
54761>>>>>                Move ("DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n(† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
54762>>>>>            Case Break
54763>>>>>
54763>>>>>            Case (iError_Num = 88850)
54766>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n’¦ ¡ç¡¢à£˜ (Module) «žª œšš¨˜­ãª œå˜¤  ¡œ¤æ" to lsError_Message
54767>>>>>            Case Break
54768>>>>>
54768>>>>>            Case (iError_Num = 88884)
54771>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ «˜ A¥ æš¨˜­˜" to lsError_Message
54772>>>>>            Case Break
54773>>>>>            Case (iError_Num = 88883)
54776>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
54777>>>>>            Case Break
54778>>>>>            Case (iError_Num = 88882)
54781>>>>>                Move "DDC 006:A›ç¤˜«ž ž œšš¨˜­ž!\n\n† ¡å¤ž©ž ˜¢¢áœ  £æ¤¦¤ ˜§æ « ª Aš¦¨âª" to lsError_Message
54782>>>>>            Case Break
54783>>>>>
54783>>>>>            //˜§æ validate delete
54783>>>>>            Case (iError_Num = 88889)
54786>>>>>                Clear Codemast
54787>>>>>                Move "MODULE" to Codemast.Type
54788>>>>>                Move Cmovesa.Module_From to Codemast.Code
54789>>>>>                Find Eq Codemast by Index.1 //type+code
54790>>>>>>
54790>>>>>                Move ("DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n(† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ "+;                (Trim(Codemast.Description))+" )") to lsError_Message
54791>>>>>            Case Break
54792>>>>>
54792>>>>>            Case (iError_Num = 88887)
54795>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ «˜ A¥ æš¨˜­˜" to lsError_Message
54796>>>>>            Case Break
54797>>>>>            Case (iError_Num = 88886)
54800>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª à¢ã©œ ª" to lsError_Message
54801>>>>>            Case Break
54802>>>>>            Case (iError_Num = 88885)
54805>>>>>                Move "DDC 006:A›ç¤˜«ž ž › ˜š¨˜­ã!\n\n† ¡å¤ž©ž › ˜š¨á­œ«˜  £æ¤¦¤ ˜§æ « ª Aš¦¨âª" to lsError_Message
54806>>>>>            Case Break
54807>>>>>
54807>>>>>            //â¢œš®¦  open items
54807>>>>>            Case (iError_Num = 10101)
54810>>>>>                Move ("DDC 006:A¡˜«á¢¢ž¢ž „šš¨˜­ã.\n\n"+;                "’¦ ©¬©®œ« ©£â¤¦ §¦©æ œå¤˜  £œš˜¢ç«œ¨¦\n˜§¦ «¦ ˜¨® ¡á › ˜Ÿâ© £¦ §¨¦ª ©¬©®â« ©ž");                to lsError_Message
54811>>>>>            Case Break
54812>>>>>
54812>>>>>            Case Else
54812>>>>>                Forward Send Operation_Not_Allowed iError_Num
54814>>>>>        Case End
54814>>>>>
54814>>>>>        Error iError_Num lsError_Message
54815>>>>>>
54815>>>>>    End_Procedure // operation_not_allowed
54816>>>>>
54816>>>>>
54816>>>>>    Function Validate_Save Returns Integer
54817>>>>>         Integer iReturnVal liOpen_Itemsa
54818>>>>>         Forward Get Validate_Save to iReturnVal
54820>>>>>         If (Not(iReturnVal)) Begin
54822>>>>>            If (CmovesA.Axia_Ypol_Sysx<0) Move 10101 to ireturnVal
54825>>>>>            If (iReturnVal) Send Operation_Not_Allowed iReturnVal
54828>>>>>         End //«â¢¦ª ¡é› ¡˜ validation
54828>>>>>>
54828>>>>>         Function_Return iReturnVal
54829>>>>>    End_Function //validate_save
54830>>>>>
54830>>>>>
54830>>>>>    Function Validate_Delete  Returns Integer
54831>>>>>             Send Operation_Not_Allowed 2001 //¢áŸ¦ª «¦¬ ¡é› ¡˜ !!!
54832>>>>>    End_Function //validate_delete
54833>>>>>
54833>>>>>
54833>>>>>
54833>>>>>    // Define_Fields:
54833>>>>>    // This procedure is used to set up all data-dictionary rules.
54833>>>>>
54833>>>>>    Procedure Define_Fields
54834>>>>>        Forward Send Define_Fields
54836>>>>>        //DDB-Generated-Code-Location
54836>>>>>        //DDB-DefineFieldStart
54836>>>>>
54836>>>>>        Set Main_File            To Cmovesa.File_Number
54837>>>>>        Set Cascade_Delete_State To FALSE
54838>>>>>
54838>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
54839>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
54840>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
54841>>>>>
54841>>>>>        // Child (Client) file structure................
54841>>>>>        Send Add_Client_File  Copen.File_Number
54842>>>>>
54842>>>>>        // Field-based properties.......................
54842>>>>>
54842>>>>>        // Cmovesa.Company_Code
54842>>>>>
54842>>>>>        // Cmovesa.Branch_Code
54842>>>>>
54842>>>>>        // Cmovesa.Year_Year
54842>>>>>
54842>>>>>        // Cmovesa.Custprom_Code
54842>>>>>
54842>>>>>        // Cmovesa.Client_Id
54842>>>>>
54842>>>>>        // Cmovesa.Ctypkin_Code
54842>>>>>
54842>>>>>        // Cmovesa.Cmoves_Recr
54842>>>>>        Set Field_Prompt_Object    Field Cmovesa.Cmoves_Recr To (sl006a1(Self))
54843>>>>>
54843>>>>>        // Cmovesa.Cmoves_Rec0
54843>>>>>
54843>>>>>        // Cmovesa.Cmoves_Hmnia
54843>>>>>        Set Field_Prompt_Object    Field Cmovesa.Cmoves_Hmnia To (sl006a1(Self))
54844>>>>>
54844>>>>>        // Cmovesa.Ctypkin_Recr
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Par
54844>>>>>
54844>>>>>        // Cmovesa.Partl_Recr
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Axia
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_X0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_P0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_X00
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_P00
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_X1
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_P1
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_X2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_P2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Dlixis
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_A_Code
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Status_E
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Status_A
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_S0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Ys0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_S1
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Ys1
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_S2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Ys2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Sc_Code2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Aopen
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_M_Code
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Yn_Myf
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Myf_Axia
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Kk
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_C_Code2
54844>>>>>
54844>>>>>        // Cmovesa.Cn_Code
54844>>>>>
54844>>>>>        // Cmovesa.Client_Recr
54844>>>>>
54844>>>>>        // Cmovesa.Barticl_Recr
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Qty
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Totambd0
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Discam0
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Totamad0
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Vatam0
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Extra0
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Totambd00
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Discam00
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Totamad00
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Vatam00
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Extra00
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Totambd1
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Discam1
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Totamad1
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Vatam1
54844>>>>>
54844>>>>>        // Cmovesa.Cmove_Extra1
54844>>>>>
54844>>>>>        // Cmovesa.Module_From
54844>>>>>
54844>>>>>        // Cmovesa.Parast_Abrev
54844>>>>>
54844>>>>>        // Cmovesa.Enhm_Ypol_Pel
54844>>>>>
54844>>>>>        // Cmovesa.Enhm_Hmnies_Pel
54844>>>>>
54844>>>>>        // Cmovesa.Sls_Id
54844>>>>>
54844>>>>>        // Cmovesa.Presp_Id
54844>>>>>
54844>>>>>        // Cmovesa.Cnt_Id
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Sx0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Sp0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Yx0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Yp0
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Sx1
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Sp1
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Sx2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Open_Sp2
54844>>>>>
54844>>>>>        // Cmovesa.Cmoves_Topen
54844>>>>>
54844>>>>>        // Cmovesa.Cn_Recr
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Pros_Sysx
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Sysxet
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Ypol_Sysx
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Pros_Sys00
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Sysxet00
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Ypol_Sys00
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Pros_Sysr
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Sysxetr
54844>>>>>
54844>>>>>        // Cmovesa.Axia_Ypol_Sysr
54844>>>>>
54844>>>>>        // Cmovesa.Mhxanik_Id
54844>>>>>
54844>>>>>        // Cmovesa.Prn_Theor
54844>>>>>
54844>>>>>        // Cmovesa.Is_Closed
54844>>>>>
54844>>>>>        // Cmovesa.Flag_Copen
54844>>>>>
54844>>>>>        // Cmovesa.Flag_Ypol
54844>>>>>
54844>>>>>        // Cmovesa.Ctypkin_Descr
54844>>>>>
54844>>>>>        // Cmovesa.Client_Name
54844>>>>>
54844>>>>>        // Cmovesa.Enhm_Ofeilh
54844>>>>>
54844>>>>>        //DDB-DefineFieldEnd
54844>>>>>    End_Procedure    // Define_Fields
54845>>>>>
54845>>>>>    // Field_Defaults:
54845>>>>>    // This procedure is used to establish default field values.
54845>>>>>
54845>>>>>    Procedure Field_Defaults
54846>>>>>        Forward Send Field_Defaults
54848>>>>>        //DDB-Generated-Code-Location
54848>>>>>        //DDB-FieldDefaultStart
54848>>>>>        //DDB-FieldDefaultEnd
54848>>>>>    End_Procedure    // Field_Defaults
54849>>>>>
54849>>>>>End_Class    // Cmovesa_DataDictionary
54850>>>>>//DDB-Selection-pkg-Start
54850>>>>>
54850>>>>>Use sl006a1.SL       // sl006a1
INCLUDING FILE: SL006A1.SL
54850>>>>>>>//AB/ Project sl006a1
54850>>>>>>>//AB/ Object prj is a Lookup_Project
54850>>>>>>>//AB/     Set ProjectName to "sl006a1"
54850>>>>>>>//AB/     Set ProjectFileName to "sl006a1.SL"
54850>>>>>>>//AB/     Set GenerateFileName to "NONAME"
54850>>>>>>>
54850>>>>>>>// Project Object Structure
54850>>>>>>>//   sl006a1 is a dbModalPanelSub
54850>>>>>>>//     Cmovesa_DD is a DataDictionary
54850>>>>>>>//     oSelList is a dbListSub
54850>>>>>>>//     oOK_bn is a ButtonSub
54850>>>>>>>//     oCancel_bn is a ButtonSub
54850>>>>>>>//     oSearch_bn is a ButtonSub
54850>>>>>>>//     Cmoves_Axia_Ypol_Sysx is a dbFormSub
54850>>>>>>>//     TextBoxSub1 is a TextBoxSub
54850>>>>>>>//     Cmoves_Axia_Sysxet is a dbFormSub
54850>>>>>>>//     TextBoxSub2 is a TextBoxSub
54850>>>>>>>//     Cmoves_Axia_Pros_Sysx is a dbFormSub
54850>>>>>>>//     TextBoxSub3 is a TextBoxSub
54850>>>>>>>
54850>>>>>>>// Register all objects
54850>>>>>>>Register_Object Cmoves_Axia_Pros_Sysx
54850>>>>>>>Register_Object Cmoves_Axia_Sysxet
54850>>>>>>>Register_Object Cmoves_Axia_Ypol_Sysx
54850>>>>>>>Register_Object Cmovesa_DD
54850>>>>>>>Register_Object oCancel_bn
54850>>>>>>>Register_Object oOK_bn
54850>>>>>>>Register_Object oSearch_bn
54850>>>>>>>Register_Object oSelList
54850>>>>>>>Register_Object sl006a1
54850>>>>>>>Register_Object TextBoxSub1
54850>>>>>>>Register_Object TextBoxSub2
54850>>>>>>>Register_Object TextBoxSub3
54850>>>>>>>
54850>>>>>>>
54850>>>>>>>//AB-IgnoreStart
54850>>>>>>>
54850>>>>>>>Use DFAllEnt.pkg
54850>>>>>>>Use dbList.Sub
54850>>>>>>>Use Button.Sub
54850>>>>>>>Use dbForm.Sub
54850>>>>>>>Use Txtbox.Sub
54850>>>>>>>
54850>>>>>>>
54850>>>>>>>Use CMOVESA.DD
54850>>>>>>>
54850>>>>>>>//AB-IgnoreEnd
54850>>>>>>>
54850>>>>>>>CD_Popup_Object sl006a1 is a dbModalPanelSub
54869>>>>>>>
54869>>>>>>>    //AB-StoreTopStart
54869>>>>>>>                                                        
54869>>>>>>>    Property String     FragmaClientID  Public ''
54871>>>>>>>    Property Integer    piXr_Or_Pi      Public  0
54873>>>>>>>    Property String     psModule        Public ''
54875>>>>>>>    Property Date       pdApo           public ''
54877>>>>>>>    Property Date       pdEos           public ''
54879>>>>>>>    Property Integer    piWhat          public  0
54881>>>>>>>    
54881>>>>>>>    
54881>>>>>>>    //AB-StoreTopEnd
54881>>>>>>>
54881>>>>>>>    Set Label to "‰ ¤ã©œ ª"
54882>>>>>>>    Set Size to 231 495
54883>>>>>>>    Set Location to 4 6
54884>>>>>>>    Set Exit_Application_Local_State to FALSE
54885>>>>>>>    Set Modal_State to FALSE
54886>>>>>>>
54886>>>>>>>    //AB-DDOStart
54886>>>>>>>
54886>>>>>>>    Object Cmovesa_DD is a Cmovesa_DataDictionary
54888>>>>>>>
54888>>>>>>>        //AB-StoreStart
54888>>>>>>>                    
54888>>>>>>>        Begin_Constraints
54890>>>>>>>            Constrain Cmovesa.Company_Code  Eq SyscurXr.Company_Code
54892>>>>>>>            Constrain Cmovesa.Year_Year     Eq SyscurXr.Year_Year
54894>>>>>>>            Constrain Cmovesa.Flag_Ypol     Eq 1
54896>>>>>>>            Constrain CmovesA.Client_ID     Eq (FragmaClientID(Self))
54898>>>>>>>            Constrain CmovesA.Module_From   Eq (psModule(Self))
54900>>>>>>>                 If (piXr_or_Pi(Self)=1)    Constrain Cmovesa.Flag_Copen Eq 2
54904>>>>>>>            Else If (piXr_or_Pi(Self)=2)    Constrain Cmovesa.Flag_Copen Eq 1
54909>>>>>>>            If (pdApo(Self)<>'')            Constrain Cmoves.Cmoves_Hmnia   Ge (pdApo(Self))
54913>>>>>>>            If (pdEos(Self)<>'')            Constrain Cmoves.Cmoves_Hmnia   Le (pdEos(Self))
54917>>>>>>>        End_Constraints
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        
54920>>>>>>>        //AB-StoreEnd
54920>>>>>>>
54920>>>>>>>    End_Object    // Cmovesa_DD
54921>>>>>>>
54921>>>>>>>    Set Main_DD to (Cmovesa_DD(self))
54922>>>>>>>    Set Server to (Cmovesa_DD(self))
54923>>>>>>>
54923>>>>>>>    //AB-DDOEnd
54923>>>>>>>
54923>>>>>>>    Object oSelList is a dbListSub
54925>>>>>>>
54925>>>>>>>        //AB-StoreTopStart
54925>>>>>>>                                                                                                                                                        
54925>>>>>>>                                                                                                                                                        
54925>>>>>>>        //AB-StoreTopEnd
54925>>>>>>>
54925>>>>>>>        Set Main_File to Cmovesa.File_Number
54926>>>>>>>        Set Size to 191 478
54927>>>>>>>        Set Location to 6 6
54928>>>>>>>
54928>>>>>>>        Begin_Row
54931>>>>>>>            Entry_Item Cmovesa.Cmoves_hmnia
54932>>>>>>>            Entry_Item Cmovesa.Cmoves_par
54933>>>>>>>            Entry_Item Cmovesa.Ctypkin_descr
54934>>>>>>>            Entry_Item Cmovesa.Client_name
54935>>>>>>>            Entry_Item Cmovesa.Cmoves_axia
54936>>>>>>>            Entry_Item Cmovesa.Branch_code
54937>>>>>>>        End_Row
54942>>>>>>>
54942>>>>>>>        Set Form_Width    item 0 to 57
54943>>>>>>>        Set Header_Label  item 0 to "†£/¤å˜"
54944>>>>>>>        
54944>>>>>>>        Set Form_Width    item 1 to 102
54945>>>>>>>        Set Header_Label  item 1 to "€ « ¦¢¦šå˜"
54946>>>>>>>        
54946>>>>>>>        Set Form_Width    item 2 to 98
54947>>>>>>>        Set Header_Label  item 2 to "‰å¤ž©ž"
54948>>>>>>>        
54948>>>>>>>        Set Form_Width    item 3 to 111
54949>>>>>>>        Set Header_Label  item 3 to "‘¬¤˜¢¢˜©æ£œ¤¦ª"
54950>>>>>>>        
54950>>>>>>>        Set Form_Width    item 4 to 64
54951>>>>>>>        Set Header_Label  item 4 to " €¥å˜"
54952>>>>>>>        
54952>>>>>>>        Set Form_Width    item 5 to 40
54953>>>>>>>        Set Header_Label  item 5 to "“§¦¡/£˜"
54954>>>>>>>        
54954>>>>>>>
54954>>>>>>>        //AB-StoreStart
54954>>>>>>>                                                                                                                                                        
54954>>>>>>>        Property String StoreFragmaClientID Public ''
54956>>>>>>>        Property String StorepsModule       Public ''
54958>>>>>>>        //
54958>>>>>>>        Procedure Store_Defaults
54960>>>>>>>               Forward Send Store_Defaults
54962>>>>>>>               Set StoreFragmaClientID  to (FragmaClientID  (Self))
54963>>>>>>>               Set StorepsModule        to (psModule        (Self))
54964>>>>>>>        End_Procedure
54965>>>>>>>        //
54965>>>>>>>        Procedure ReStore_Defaults
54967>>>>>>>               Forward Send ReStore_Defaults
54969>>>>>>>               Set FragmaClientID   to (StoreFragmaClientID (Self))
54970>>>>>>>               Set psModule         to (StorepsModule       (Self))
54971>>>>>>>        End_Procedure
54972>>>>>>>        //
54972>>>>>>>        Procedure Activating
54974>>>>>>>           Forward Send Activating
54976>>>>>>>           Send Rebuild_Constraints to (Cmovesa_DD(Self))
54977>>>>>>>        End_Procedure
54978>>>>>>>        //
54978>>>>>>>        Procedure Activate
54980>>>>>>>            Forward Send Activate
54982>>>>>>>            Send Beginning_Of_Data          to oSelList True
54983>>>>>>>        End_procedure
54984>>>>>>>        
54984>>>>>>>        Procedure End_Construct_Object
54986>>>>>>>            String  sNom
54987>>>>>>>            Integer iDecs
54987>>>>>>>            Forward Send End_Construct_Object
54989>>>>>>>            Move SysCurxr.C_Code0 to sNom
54990>>>>>>>            Clear Nomisma
54991>>>>>>>            Move sNom to Nomisma.Nomisma_Code
54992>>>>>>>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
54993>>>>>>>>
54993>>>>>>>            If (Found=1)    Move Nomisma.Dekadika to iDecs
54996>>>>>>>            Else            Move 0 to iDecs
54998>>>>>>>        
54998>>>>>>>            // Ž¨ ¦¬£œ §àª ˜¤ «¦ ™˜© ¡æ ¤¦£ ©£˜ ®¨ã©žª ƒ„Œ œ®œ  ›œ¡˜› ¡á
54998>>>>>>>            // «æ«œ œ¥' ¦¨ ©£¦ç ™á¦¬£œ œ£œ ª 2
54998>>>>>>>            If (iDecs=0) Move 2 to iDecs
55001>>>>>>>            //
55001>>>>>>>        
55001>>>>>>>            Set Points          Item 4 to       iDecs
55002>>>>>>>            Set Numeric_Mask    Item 4 to 14    iDecs ' ,*'
55003>>>>>>>        End_Procedure
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        
55004>>>>>>>        //AB-StoreEnd
55004>>>>>>>
55004>>>>>>>    End_Object    // oSelList
55005>>>>>>>
55005>>>>>>>    Object oOK_bn is a ButtonSub
55007>>>>>>>        Set Label to "&„§ ¢¦šã"
55008>>>>>>>        Set Location to 199 325
55009>>>>>>>
55009>>>>>>>        //AB-StoreStart
55009>>>>>>>        Procedure OnClick
55011>>>>>>>            Send OK To (oSelList(current_object))
55012>>>>>>>        End_Procedure
55013>>>>>>>        //AB-StoreEnd
55013>>>>>>>
55013>>>>>>>    End_Object    // oOK_bn
55014>>>>>>>
55014>>>>>>>    Object oCancel_bn is a ButtonSub
55016>>>>>>>        Set Label to "&€¡ç¨à©ž"
55017>>>>>>>        Set Location to 199 379
55018>>>>>>>
55018>>>>>>>        //AB-StoreStart
55018>>>>>>>        Procedure OnClick
55020>>>>>>>            Send Cancel To (oSelList(current_object))
55021>>>>>>>        End_Procedure
55022>>>>>>>        //AB-StoreEnd
55022>>>>>>>
55022>>>>>>>    End_Object    // oCancel_bn
55023>>>>>>>
55023>>>>>>>    Object oSearch_bn is a ButtonSub
55025>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
55026>>>>>>>        Set Location to 199 435
55027>>>>>>>
55027>>>>>>>        //AB-StoreStart
55027>>>>>>>        Procedure OnClick
55029>>>>>>>            Send Search To (oSelList(current_object))
55030>>>>>>>        End_Procedure
55031>>>>>>>        //AB-StoreEnd
55031>>>>>>>
55031>>>>>>>    End_Object    // oSearch_bn
55032>>>>>>>
55032>>>>>>>    Object Cmoves_Axia_Ypol_Sysx is a dbFormSub
55034>>>>>>>        Entry_Item Cmovesa.Axia_ypol_sysx
55035>>>>>>>        Set Size to 13 54
55036>>>>>>>        Set Location to 199 249
55037>>>>>>>        Set Color to clBtnFace
55038>>>>>>>        Set Label_Col_Offset to 2
55039>>>>>>>        Set Label_Justification_Mode to jMode_Right
55040>>>>>>>        Set Enabled_State to FALSE
55041>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
55042>>>>>>>        Set Shadow_State Item 0 to TRUE
55043>>>>>>>
55043>>>>>>>        //AB-StoreStart
55043>>>>>>>                                                                                                
55043>>>>>>>        Set points item 0 to 2
55044>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
55045>>>>>>>        
55045>>>>>>>        //AB-StoreEnd
55045>>>>>>>
55045>>>>>>>    End_Object    // Cmoves_Axia_Ypol_Sysx
55046>>>>>>>
55046>>>>>>>    Object TextBoxSub1 is a TextBoxSub
55048>>>>>>>        Set Label to "ƒ ˜Ÿâ© £ž"
55049>>>>>>>        Set Location to 201 211
55050>>>>>>>        Set Size to 10 35
55051>>>>>>>    End_Object    // TextBoxSub1
55052>>>>>>>
55052>>>>>>>    Object Cmoves_Axia_Sysxet is a dbFormSub
55054>>>>>>>        Entry_Item Cmovesa.Axia_sysxet
55055>>>>>>>        Set Size to 13 54
55056>>>>>>>        Set Location to 199 141
55057>>>>>>>        Set Color to clBtnFace
55058>>>>>>>        Set Label_Col_Offset to 2
55059>>>>>>>        Set Label_Justification_Mode to jMode_Right
55060>>>>>>>        Set Enabled_State to FALSE
55061>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
55062>>>>>>>        Set Shadow_State Item 0 to TRUE
55063>>>>>>>
55063>>>>>>>        //AB-StoreStart
55063>>>>>>>        Set points item 0 to 2
55064>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
55065>>>>>>>        
55065>>>>>>>        //AB-StoreEnd
55065>>>>>>>
55065>>>>>>>    End_Object    // Cmoves_Axia_Sysxet
55066>>>>>>>
55066>>>>>>>    Object TextBoxSub2 is a TextBoxSub
55068>>>>>>>        Set Label to "‘¬©®œ« ©£â¤ž"
55069>>>>>>>        Set Location to 201 90
55070>>>>>>>        Set Size to 10 49
55071>>>>>>>    End_Object    // TextBoxSub2
55072>>>>>>>
55072>>>>>>>    Object Cmoves_Axia_Pros_Sysx is a dbFormSub
55074>>>>>>>        Entry_Item Cmovesa.Axia_pros_sysx
55075>>>>>>>        Set Size to 13 54
55076>>>>>>>        Set Location to 199 25
55077>>>>>>>        Set Color to clBtnFace
55078>>>>>>>        Set Label_Col_Offset to 2
55079>>>>>>>        Set Label_Justification_Mode to jMode_Right
55080>>>>>>>        Set Enabled_State to FALSE
55081>>>>>>>        Set Item_Shadow_State Item 0 to TRUE
55082>>>>>>>        Set Shadow_State Item 0 to TRUE
55083>>>>>>>
55083>>>>>>>        //AB-StoreStart
55083>>>>>>>        Set points item 0 to 2
55084>>>>>>>        Set Numeric_Mask Item 0 to 8 2 ' ,*'
55085>>>>>>>        
55085>>>>>>>        //AB-StoreEnd
55085>>>>>>>
55085>>>>>>>    End_Object    // Cmoves_Axia_Pros_Sysx
55086>>>>>>>
55086>>>>>>>    Object TextBoxSub3 is a TextBoxSub
55088>>>>>>>        Set Label to "€¥å˜"
55089>>>>>>>        Set Location to 201 6
55090>>>>>>>        Set Size to 10 15
55091>>>>>>>    End_Object    // TextBoxSub3
55092>>>>>>>
55092>>>>>>>
55092>>>>>>>    //AB-StoreStart
55092>>>>>>>                                                        
55092>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
55093>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
55094>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
55095>>>>>>>    
55095>>>>>>>    
55095>>>>>>>    
55095>>>>>>>    
55095>>>>>>>    
55095>>>>>>>    
55095>>>>>>>    
55095>>>>>>>    //AB-StoreEnd
55095>>>>>>>
55095>>>>>>>CD_End_Object    // sl006a1
55097>>>>>>>>
55097>>>>>>>
55097>>>>>>>//AB/ End_Object    // prj
55097>>>>>
55097>>>>>//DDB-Selection-pkg-End
55097>>>>>//DDB-FileEnd
55097>>>    USE SYSCURXR.DD
55097>>>    use docpresp.dg
INCLUDING FILE: DOCPRESP.DG
55097>>>>>
55097>>>>>// Register all objects
55097>>>>>Register_Object syscurxr_DD
55097>>>>>Register_Object Docpresp
55097>>>>>Register_Object payresp_DD
55097>>>>>Register_Object year_DD
55097>>>>>Register_Object rmetafyp.rv
55097>>>>>
55097>>>>>
55097>>>>>
55097>>>>>//AB-IgnoreStart
55097>>>>>
55097>>>>>Use Bproces.Sub
55097>>>>>Use DFAllEnt.pkg
55097>>>>>use syscurxr.dd
55097>>>>>use payresp.dd
55097>>>>>use year.dd
55097>>>>>
55097>>>>>//AB-IgnoreEnd
55097>>>>>
55097>>>>>Object Docpresp is a BusinessProcessSub
55099>>>>>
55099>>>>>    //AB-StoreTopStart
55099>>>>>
55099>>>>>    Property    Integer piError       Public  0
55101>>>>>    property    string  datefrom      public ''
55103>>>>>    property    integer piTxtID       public 0
55105>>>>>    property    integer piLathos      public 0
55107>>>>>    property    string  psclient      public ''
55109>>>>>    property    string  psmodule      public ''
55111>>>>>    property    string  pscode        public ''
55113>>>>>
55113>>>>>    Open SysCurXr
55115>>>>>    //reread syscurxr
55115>>>>>    //unlock
55115>>>>>
55115>>>>>    Set Status_Panel_State to False
55116>>>>>    Set Display_Error_State to True
55117>>>>>
55117>>>>>    //AB-StoreTopEnd
55117>>>>>
55117>>>>>    Set Size to 82 140
55118>>>>>    Set Location to 72 182
55119>>>>>
55119>>>>>    //AB-DDOStart
55119>>>>>
55119>>>>>
55119>>>>>    Object Payresp_DD is a Payresp_DataDictionary
55121>>>>>
55121>>>>>    End_Object    // Payresp_DD
55122>>>>>
55122>>>>>    Object year_DD is a year_DataDictionary
55124>>>>>
55124>>>>>    End_Object    // year_DD
55125>>>>>
55125>>>>>    Object syscurxr_DD is a syscurxr_DataDictionary
55127>>>>>
55127>>>>>    End_Object    // syscurxr
55128>>>>>
55128>>>>>
55128>>>>>    //AB-StoreEnd
55128>>>>>
55128>>>>>
55128>>>>>    //AB-DDOEnd
55128>>>>>
55128>>>>>
55128>>>>>    //AB-StoreStart
55128>>>>>
55128>>>>>    Procedure Start_Processing
55130>>>>>     String  scode smodule spar
55131>>>>>     Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1 nplafon nofeilh
55131>>>>>     Date    dHmnia
55131>>>>>     string  serr
55131>>>>>     integer iyear icount nyear ctypkinyear
55131>>>>>     Clear payresp
55132>>>>>     move syscurxr.company_code     to payresp.company_code
55133>>>>>     find gt payresp by index.5
55134>>>>>>
55134>>>>>     While ((found=1)and (syscurxr.company_code eq payresp.company_code))
55138>>>>>         add 1 to icount
55139>>>>>         clear year
55140>>>>>         move syscurxr.company_code     to year.company_code
55141>>>>>         move syscurxr.branch_code      to year.branch_code
55142>>>>>         move (syscurxr.year_year+1)    to year.year_year
55143>>>>>         find eq year by index.1
55144>>>>>>
55144>>>>>         if (not(found)) error 3002 'ƒœ¤ â®œ«œ ˜¤¦å¥œ  ¤â˜ ®¨ã©ž ©«¦ ¬§¦¡˜«á©«ž£˜ !!'
55147>>>>>         move payresp.presp_id to scode
55148>>>>>         move year.payresp_plafon to nplafon
55149>>>>>         move year.payresp_ofeilh to nofeilh
55150>>>>>         reread payresp
55154>>>>>         move 0 to payresp.pistosh
55155>>>>>         move 0 to payresp.xreosh
55156>>>>>         move 0 to payresp.ypoloipo
55157>>>>>         move 0 to payresp.overhead
55158>>>>>         // ›œ¤ ¥â¨à ˜¤ §¨â§œ  ¤˜ £ž›œ¤å¦¬¤ «˜ œ§ ©­˜¢ã §¦©á ¡˜  §¦©á ˜§¦ ƒ.€///
55158>>>>>     //    move 0 to payresp.poso_se_apait
55158>>>>>     //    move 0 to payresp.posa_apo_dap
55158>>>>>         move nplafon to payresp.plafon
55159>>>>>         move nofeilh to payresp.orio_syn_ofeilh
55160>>>>>         saverecord payresp
55161>>>>>         unlock
55162>>>>>>
55162>>>>>         Send UpdateWait to (piTxtID(Self))  ('‹ž›œ¤ ©£æª ¬§¦¢.¬§œ¬Ÿ.§¢ž¨à£ãª '+(String(scode)+ ' '+(string(icount))))
55163>>>>>     Find  gt payresp by index.5
55164>>>>>>
55164>>>>>     loop
55165>>>>>>
55165>>>>>
55165>>>>>      if (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
55168>>>>>    End_Procedure
55169>>>>>
55169>>>>>
55169>>>>>    Procedure OnProcess
55171>>>>>        Send Start_Processing
55172>>>>>    End_Procedure
55173>>>>>
55173>>>>>    Procedure Start_Process
55175>>>>>         Set piTxtID                         to (Wait(Self))
55176>>>>>         Set Button_State    of (Wait(Self)) to False
55177>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
55178>>>>>         Send Popup                          to (Wait(Self))
55179>>>>>         Set piLathos                        to 0
55180>>>>>         Forward Send Start_Process
55182>>>>>    End_Procedure
55183>>>>>
55183>>>>>    Procedure OnError integer error_info string errMsg
55185>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
55188>>>>>    End_Procedure
55189>>>>>
55189>>>>>
55189>>>>>    Procedure End_Process
55191>>>>>       Forward Send End_Process
55193>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
55196>>>>>    End_Procedure
55197>>>>>
55197>>>>>
55197>>>>>    //AB-StoreEnd
55197>>>>>
55197>>>>>End_Object
55198>>>>>
55198>>>>>//AB/ End_Object    // prj
55198>>>    use docclients.dg
INCLUDING FILE: DOCCLIENTS.DG
55198>>>>>
55198>>>>>// Register all objects
55198>>>>>Register_Object syscurxr_DD
55198>>>>>Register_Object Docclients
55198>>>>>Register_Object clients_DD
55198>>>>>Register_Object year_DD
55198>>>>>Register_Object rmetafyp.rv
55198>>>>>
55198>>>>>
55198>>>>>
55198>>>>>//AB-IgnoreStart
55198>>>>>
55198>>>>>Use Bproces.Sub
55198>>>>>Use DFAllEnt.pkg
55198>>>>>use syscurxr.dd
55198>>>>>use clients.dd
55198>>>>>use year.dd
55198>>>>>
55198>>>>>//AB-IgnoreEnd
55198>>>>>
55198>>>>>Object Docclients is a BusinessProcessSub
55200>>>>>
55200>>>>>    //AB-StoreTopStart
55200>>>>>
55200>>>>>    Property    Integer piError       Public  0
55202>>>>>    property    string  datefrom      public ''
55204>>>>>    property    integer piTxtID       public 0
55206>>>>>    property    integer piLathos      public 0
55208>>>>>    property    string  psclient      public ''
55210>>>>>    property    string  psmodule      public ''
55212>>>>>    property    string  pscode        public ''
55214>>>>>
55214>>>>>    Open SysCurXr
55216>>>>>    //reread syscurxr
55216>>>>>    //unlock
55216>>>>>
55216>>>>>    Set Status_Panel_State to False
55217>>>>>    Set Display_Error_State to True
55218>>>>>
55218>>>>>    //AB-StoreTopEnd
55218>>>>>
55218>>>>>    Set Size to 82 140
55219>>>>>    Set Location to 72 182
55220>>>>>
55220>>>>>    //AB-DDOStart
55220>>>>>
55220>>>>>
55220>>>>>    Object clients_DD is a clients_DataDictionary
55222>>>>>
55222>>>>>    End_Object    // clients_DD
55223>>>>>
55223>>>>>    Object year_DD is a year_DataDictionary
55225>>>>>
55225>>>>>    End_Object    // year_DD
55226>>>>>
55226>>>>>    Object syscurxr_DD is a syscurxr_DataDictionary
55228>>>>>
55228>>>>>    End_Object    // syscurxr
55229>>>>>
55229>>>>>
55229>>>>>    //AB-StoreEnd
55229>>>>>
55229>>>>>
55229>>>>>    //AB-DDOEnd
55229>>>>>
55229>>>>>
55229>>>>>    //AB-StoreStart
55229>>>>>
55229>>>>>    Procedure Start_Processing
55231>>>>>     String  scode smodule spar
55232>>>>>     Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1 nplafon nofeilh
55232>>>>>     Date    dHmnia
55232>>>>>     string  serr
55232>>>>>     integer iyear icount nyear ctypkinyear
55232>>>>>
55232>>>>>     Get psModule to sModule
55233>>>>>     If (Trim(sModule)='') Error 1001 'ƒœ¤ ¬§á¨®œ  Module'
55236>>>>>
55236>>>>>     Clear clients
55237>>>>>     move syscurxr.company_code     to clients.company_code
55238>>>>>   //  move syscurxr.branch_code      to clients.branch_code
55238>>>>>  //   move 0                         to clients.year_year
55238>>>>>     find gt clients by index.5
55239>>>>>>
55239>>>>>     While ((found) and (syscurxr.company_code eq clients.company_code))
55243>>>>>
55243>>>>>         add 1 to icount
55244>>>>>
55244>>>>>         If (;            ((sModule='01') And (Clients.is_Client      ='1')) Or ;            ((sModule='02') And (Clients.is_Promhtheyths='1')) ;            ) Begin
55246>>>>>
55246>>>>>                clear year
55247>>>>>                move syscurxr.company_code     to year.company_code
55248>>>>>                move syscurxr.branch_code      to year.branch_code
55249>>>>>                move (syscurxr.year_year+1)    to year.year_year
55250>>>>>                find eq year by index.1
55251>>>>>>
55251>>>>>                if (not(found)) error 3002 'ƒœ¤ â®œ«œ ˜¤¦å¥œ  ¤â˜ ®¨ã©ž ©«¦ ¬§¦¡˜«á©«ž£˜ !!'
55254>>>>>                move clients.client_id to scode
55255>>>>>                move year.clients_plafon to nplafon
55256>>>>>                move year.clients_ofeilh to nofeilh
55257>>>>>                reread clients
55261>>>>>                move 0 to clients.pistosh
55262>>>>>                move 0 to clients.xreosh
55263>>>>>                move 0 to clients.ypoloipo
55264>>>>>                move 0 to clients.overhead
55265>>>>>                // ›œ¤ ¥â¨à ˜¤ §¨â§œ  ¤˜ £ž›œ¤å¦¬¤ «˜ œ§ ©­˜¢ã §¦©á ¡˜  §¦©á ˜§¦ ƒ.€///
55265>>>>>            //    move 0 to clients.poso_se_apait
55265>>>>>            //    move 0 to clients.posa_apo_dap
55265>>>>>
55265>>>>>                if (clients.is_client = '1') begin
55267>>>>>                    move nplafon to clients.plafon
55268>>>>>                    move nofeilh to clients.orio_syn_ofeilh
55269>>>>>                end
55269>>>>>>
55269>>>>>                saverecord clients
55270>>>>>                unlock
55271>>>>>>
55271>>>>>                Send UpdateWait to (piTxtID(Self))  ('‹ž›œ¤ ©£æª ¬§¦¢.”¦¨â˜ '+(String(scode)+ ' '+(string(icount))))
55272>>>>>
55272>>>>>         End
55272>>>>>>
55272>>>>>        Find  gt clients by index.5
55273>>>>>>
55273>>>>>     loop
55274>>>>>>
55274>>>>>
55274>>>>>      if (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
55277>>>>>    End_Procedure
55278>>>>>
55278>>>>>
55278>>>>>    Procedure OnProcess
55280>>>>>        Send Start_Processing
55281>>>>>    End_Procedure
55282>>>>>
55282>>>>>    Procedure Start_Process
55284>>>>>         Set piTxtID                         to (Wait(Self))
55285>>>>>         Set Button_State    of (Wait(Self)) to False
55286>>>>>         Set BarVisibleState of (Wait(Self)) to '' False
55287>>>>>         Send Popup                          to (Wait(Self))
55288>>>>>         Set piLathos                        to 0
55289>>>>>         Forward Send Start_Process
55291>>>>>    End_Procedure
55292>>>>>
55292>>>>>    Procedure OnError integer error_info string errMsg
55294>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
55297>>>>>    End_Procedure
55298>>>>>
55298>>>>>
55298>>>>>    Procedure End_Process
55300>>>>>       Forward Send End_Process
55302>>>>>       If (piTxtID(Self)<>0) Send Deactivate to (piTxtID(Self))
55305>>>>>    End_Procedure
55306>>>>>
55306>>>>>
55306>>>>>    //AB-StoreEnd
55306>>>>>
55306>>>>>End_Object
55307>>>>>
55307>>>>>//AB/ End_Object    // prj
55307>>>    OPEN CN
55309>>>    //AB-StoreTopEnd
55309>>>
55309>>>    //AB-IgnoreStart
55309>>>
55309>>>    Use Rptvw.Sub
55309>>>    Use Form.Sub
55309>>>    Use Button.Sub
55309>>>    Use Chkbox.Sub
55309>>>    Use Txtbox.Sub
55309>>>
55309>>>    //AB-IgnoreEnd
55309>>>
55309>>>    ACTIVATE_VIEW Activate_vwKleisimo FOR vwKleisimo
55313>>>
55313>>>    Object vwKleisimo is a ReportViewSub
55315>>>
55315>>>        //AB-StoreTopStart
55315>>>        property integer pierr              public 0
55317>>>        Property Integer Sort_IndexRlog     Public 1
55319>>>        property integer pipayresp          public 0
55321>>>        property integer picount            public 0
55323>>>        property string  psmodule           public '01'
55325>>>        property date    pddate             public ''
55327>>>        property number  px0                public 0
55329>>>        property number  pp0                public 0
55331>>>        property number  px00               public 0
55333>>>        property number  pp00               public 0
55335>>>        property number  px1                public 0
55337>>>        property number  pp1                public 0
55339>>>        
55339>>>        Property String psFileExair
55341>>>        Property String psClientToSkip Public ""
55343>>>        
55343>>>        
55343>>>        //AB-StoreTopEnd
55343>>>
55343>>>        Set Label to "‰¢œå© £¦ „šš¨˜­é¤ ˆ„ && …Ž”ŽŽˆ ˜¤˜ “§¦¡˜«˜©«ž£˜"
55344>>>        Set Size to 159 387
55345>>>        Set Location to 5 12
55346>>>        Set Color to 12380096
55347>>>
55347>>>        //AB-DDOStart
55347>>>
55347>>>
55347>>>        //AB-DDOEnd
55347>>>
55347>>>        Object value_date is a FormSub
55349>>>            Set Size to 13 71
55350>>>            Set Location to 4 221
55351>>>            Set Label_Col_Offset to 2
55352>>>            Set Form_Datatype Item 0 to Mask_Date_Window
55353>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
55354>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55355>>>
55355>>>            //AB-StoreStart
55355>>>                                                                                
55355>>>                                                                                
55355>>>                                                                                
55355>>>                                                                                
55355>>>            //AB-StoreEnd
55355>>>
55355>>>        End_Object    // value_date
55356>>>
55356>>>        Object date_apo is a FormSub
55358>>>            Set Size to 13 63
55359>>>            Set Location to 26 92
55360>>>            Set Label_Col_Offset to 2
55361>>>            Set Form_Datatype Item 0 to Mask_Date_Window
55362>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
55363>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55364>>>
55364>>>            //AB-StoreStart
55364>>>                                                                                                                                                                                                                                                                                                                                                                                                
55364>>>            //AB-StoreEnd
55364>>>
55364>>>        End_Object    // date_apo
55365>>>
55365>>>        Object date_eos is a FormSub
55367>>>            Set Size to 13 71
55368>>>            Set Location to 26 222
55369>>>            Set Label_Col_Offset to 2
55370>>>            Set Form_Datatype Item 0 to Mask_Date_Window
55371>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
55372>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55373>>>
55373>>>            //AB-StoreStart
55373>>>                                                                                                                                                                                                                                                                                                                                                                                                
55373>>>                                                                                                                                                                                                                                                                                                                                                                                                
55373>>>            //AB-StoreEnd
55373>>>
55373>>>        End_Object    // date_eos
55374>>>
55374>>>        Object FormSub3 is a FormSub
55376>>>
55376>>>            //AB-StoreTopStart
55376>>>                                                                                            
55376>>>                                                                                            
55376>>>            Object oOpenFile is a OpenDialog
55378>>>                Set Location to 2 407
55379>>>                Set Dialog_Caption to "Select a file"
55380>>>            
55380>>>                Set Filter_String   To 'Text Files|*.txt|All Files|*.*'
55381>>>                Set Initial_Folder  To 'C:\'
55382>>>                Set Filter_Index    To 1
55383>>>            
55383>>>            End_Object    // oOpenFile
55384>>>            
55384>>>            
55384>>>            
55384>>>            //AB-StoreTopEnd
55384>>>
55384>>>            Set Size to 13 201
55385>>>            Set Location to 49 92
55386>>>            Set Label_Col_Offset to 2
55387>>>            Set Prompt_Button_Mode to pb_PromptOn
55388>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55389>>>
55389>>>            //AB-StoreStart
55389>>>                                                                                            
55389>>>            Procedure Prompt
55391>>>                String  sFileName
55392>>>                Integer bOpen
55392>>>                Get Show_Dialog Of oOpenFile To bOpen
55393>>>                If bOpen Begin
55395>>>                    Get File_Name Of oOpenFile To sFileName
55396>>>                    If (Trim(sFileName)<>'') Begin
55398>>>                        Set Value Item 0 To sFileName
55399>>>                        Set psFileExair to sFileName
55400>>>                    End
55400>>>>
55400>>>                    Else     Set psFileExair to ""
55402>>>                End
55402>>>>
55402>>>            End_Procedure
55403>>>            
55403>>>            
55403>>>            
55403>>>            
55403>>>            
55403>>>            
55403>>>            //AB-StoreEnd
55403>>>
55403>>>        End_Object    // FormSub3
55404>>>
55404>>>        Object ButtonSub3 is a ButtonSub
55406>>>
55406>>>            //AB-StoreTopStart
55406>>>                                                                                                        
55406>>>            //AB-StoreTopEnd
55406>>>
55406>>>            Set Bitmap to "RUNPROG.BMP"
55407>>>            Set Size to 20 23
55408>>>            Set Location to 70 269
55409>>>            Set Border_Style to Border_StaticEdge
55410>>>            Set Focus_Mode to Pointer_Only
55411>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55412>>>
55412>>>            //AB-StoreStart
55412>>>                                                                                                        
55412>>>            Set TooltipValue to "„¥˜šàšã-„ ©˜šàšã ©œ ASCII ˜¨®œå¦"
55413>>>            
55413>>>            Procedure OnClick
55415>>>                integer irecnum  idecs ilines iint ilen iYes inum  ipis
55416>>>                number nxre npis x0 p0 x00 p00 x1 p1
55416>>>                String sPath sFullName sBranch sunit slogik sid sstr Spartlrecr sbr  sposo
55416>>>                string sline skin spar scn scnrecr ssls spayresp scnt  smhxanik  msgstr
55416>>>                indicate err false
55417>>>                date dapod deosd
55417>>>            
55417>>>                Get Value Of FormSub3 Item 0 to sPath
55418>>>                Move (Trim(sPath)) to sPath
55419>>>                If (sPath='') Begin
55421>>>                    Send Info_Box 'ƒœ¤ œ§ ¢â¥˜«œ ˜¨®œå¦ š ˜ «¦¬ª §œ¢á«œª §¦¬ ƒ„Œ Ÿ˜ £ž›œ¤ ©¦¬¤\nASCII ˜¨®œå˜ œ¥˜ ¨â©œà¤ "Exaireseis Ypok 81 - BIPE.TXT"' '¢ž¨¦­¦¨å˜'
55422>>>                    Procedure_Return
55423>>>                End
55423>>>>
55423>>>            
55423>>>                Set psFileExair to (Trim(sPath))
55424>>>            
55424>>>                Get Value Of date_apo Item 0 to dapod
55425>>>                get value of date_eos item 0 to deosd
55426>>>            
55426>>>            
55426>>>                get checked_state of chkshm  item 0 to  ipis
55427>>>            
55427>>>                if ((dapod='') or (deosd='')) begin
55429>>>                    send info_box '†£/¤åœª „šš¨˜­é¤ ˜§˜¨˜å«ž«œª' '¢ž¨¦­¦¨å˜'
55430>>>                    procedure_return
55431>>>                end
55431>>>>
55431>>>            
55431>>>                Get YesNo_Box 'Œ˜ ¥œ¡ ¤ã©œ  ž › ˜› ¡˜©å˜ ?' to iYes
55432>>>                If (iYes=MBR_NO) Procedure_Return
55435>>>            
55435>>>                begin_transaction
55436>>>            
55436>>>                    Send StartReport
55437>>>            
55437>>>                End_Transaction
55438>>>            
55438>>>                set label of buttonsub5 to ''
55439>>>                send info_box '’â¢¦ª „§œ¥œ¨š˜©å˜ª' '¢ž¨¦­¦¨å˜'
55440>>>            End_Procedure
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            
55441>>>            //AB-StoreEnd
55441>>>
55441>>>        End_Object    // ButtonSub3
55442>>>
55442>>>        Object Chkshm is a CheckBoxSub
55444>>>            Set Label to "•¨œà©« ¡æ- ©«à« ¡æ ‘ž£œåà£˜ „¥˜šàšã"
55445>>>            Set Size to 10 155
55446>>>            Set Location to 67 92
55447>>>            Set Color to 12380096
55448>>>            Set Checked_State to TRUE
55449>>>            Set Enabled_State to FALSE
55450>>>            Set Item_Shadow_State Item 0 to TRUE
55451>>>            Set Shadow_State Item 0 to TRUE
55452>>>        End_Object    // Chkshm
55453>>>
55453>>>        Object Chkeisa is a CheckBoxSub
55455>>>
55455>>>            //AB-StoreTopStart
55455>>>                                                                                                                    
55455>>>            //AB-StoreTopEnd
55455>>>
55455>>>            Set Label to "„ ©˜šàšã"
55456>>>            Set Size to 10 52
55457>>>            Set Location to 126 312
55458>>>            Set Color to 12380096
55459>>>
55459>>>            //AB-StoreStart
55459>>>                                                                                                                    
55459>>>            Set Visible_State to False
55460>>>            Set Enabled_State to False
55461>>>            
55461>>>            
55461>>>            
55461>>>            
55461>>>            //AB-StoreEnd
55461>>>
55461>>>        End_Object    // Chkeisa
55462>>>
55462>>>        Object TextBoxSub5 is a TextBoxSub
55464>>>            Set Label to "†£/¤å˜ „šš¨˜­é¤ €§æ"
55465>>>            Set Color to 12380096
55466>>>            Set Location to 28 8
55467>>>            Set Size to 10 80
55468>>>            Set TypeFace to "MS Sans Serif"
55469>>>        End_Object    // TextBoxSub5
55470>>>
55470>>>        Object TextBoxSub6 is a TextBoxSub
55472>>>            Set Label to "„éª"
55473>>>            Set Color to 12380096
55474>>>            Set Location to 28 203
55475>>>            Set Size to 10 14
55476>>>            Set TypeFace to "MS Sans Serif"
55477>>>        End_Object    // TextBoxSub6
55478>>>
55478>>>        Object TextBoxSub7 is a TextBoxSub
55480>>>            Set Label to "†£/¤å˜ „šš¨˜­ãª «à¤ ‰ ¤ã©œà¤"
55481>>>            Set Color to 12380096
55482>>>            Set Location to 6 97
55483>>>            Set Size to 10 115
55484>>>            Set TypeFace to "MS Sans Serif"
55485>>>
55485>>>            //AB-StoreStart
55485>>>                                                
55485>>>                                                
55485>>>                                                
55485>>>                                                
55485>>>                                                
55485>>>                                                
55485>>>            //AB-StoreEnd
55485>>>
55485>>>        End_Object    // TextBoxSub7
55486>>>
55486>>>        Object TextBoxSub8 is a TextBoxSub
55488>>>            Set Label to "€¨®œå¦ „¥˜ ¨â©œà¤"
55489>>>            Set Color to 12380096
55490>>>            Set Location to 50 19
55491>>>            Set Size to 10 67
55492>>>            Set TypeFace to "MS Sans Serif"
55493>>>        End_Object    // TextBoxSub8
55494>>>
55494>>>        Object ButtonSub5 is a ButtonSub
55496>>>            Set Size to 14 203
55497>>>            Set Location to 102 93
55498>>>            Set Border_Style to Border_Normal
55499>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
55500>>>
55500>>>            //AB-StoreStart
55500>>>            Procedure OnClick
55502>>>            
55502>>>            End_Procedure // OnClick
55503>>>            //AB-StoreEnd
55503>>>
55503>>>        End_Object    // ButtonSub5
55504>>>
55504>>>        Object Chkkl is a CheckBoxSub
55506>>>            Set Label to "‰¢œå© £¦ œšš¨˜­é¤ “§¦¡˜«˜©«ã£˜«¦ª"
55507>>>            Set Size to 10 153
55508>>>            Set Location to 81 92
55509>>>            Set Color to 12380096
55510>>>            Set Checked_State to TRUE
55511>>>            Set Enabled_State to FALSE
55512>>>            Set Item_Shadow_State Item 0 to TRUE
55513>>>            Set Shadow_State Item 0 to TRUE
55514>>>        End_Object    // Chkkl
55515>>>
55515>>>
55515>>>        //AB-StoreStart
55515>>>        
55515>>>        Set Output_Device_Name to None
55516>>>        
55516>>>        ////////////////////////////////////////////
55516>>>        // Omada DD gia thn akyrosh ths diadikasia
55516>>>        // metaforas ypoloipon
55516>>>        ////////////////////////////////////////////
55516>>>        Object Areas_DD is a Areas_DataDictionary
55518>>>        End_Object
55519>>>        Object Payresp_DD is a Payresp_DataDictionary
55521>>>        End_Object
55522>>>        Object syscurxr_DD is a syscurxr_DataDictionary
55524>>>        End_Object
55525>>>        Object Country_DD is a Country_DataDictionary
55527>>>        End_Object
55528>>>        Object Towns_DD is a Towns_DataDictionary
55530>>>            Set DDO_Server to (Country_DD(self))
55531>>>        End_Object
55532>>>        Object Ctypkin_DD is a Ctypkin_DataDictionary
55534>>>            set piMustNOTConstrain to 1
55535>>>            Procedure Update
55537>>>            End_Procedure
55538>>>            Procedure Creating
55540>>>            End_Procedure
55541>>>        End_Object
55542>>>        Object Cities_DD is a Cities_DataDictionary
55544>>>            Set DDO_Server to (Towns_DD(self))
55545>>>        End_Object
55546>>>        Object Clients_DD is a Clients_DataDictionary
55548>>>            Set DDO_Server to (Cities_DD(self))
55549>>>            Set DDO_Server to (Payresp_DD(self))
55550>>>            Set DDO_Server to (Areas_DD(self))
55551>>>        End_Object
55552>>>        Object Cmoves_DD is a Cmoves_DataDictionary
55554>>>            Set DDO_Server to (Ctypkin_DD(self))
55555>>>            Set DDO_Server to (Clients_DD(self))
55556>>>        //            set pifromxrhsh to 1
55556>>>            set pifrombp    to 1
55557>>>        End_Object
55558>>>        ////////////////////////////////////////////
55558>>>        ////////////////////////////////////////////
55558>>>        
55558>>>        
55558>>>        
55558>>>        Procedure Activate_View Returns Integer
55560>>>            String sStr sModule StrDisp
55561>>>            Integer rVal
55561>>>        
55561>>>            Forward Get Msg_Activate_View to rVal
55563>>>        
55563>>>            Move '01'       to sModule
55564>>>            Move '01'       to gs_Module_Code
55565>>>            Set psModule    to sModule
55566>>>        
55566>>>        End_Procedure
55567>>>        
55567>>>        Procedure StartReport
55569>>>            Local Integer iOutputDevice ipayresp
55570>>>            Local String  FileName
55570>>>            local date ddate
55570>>>            SEND RUN_REPORT
55571>>>        End_Procedure   // StartReport
55572>>>        
55572>>>        
55572>>>        Object metafyp_BasicReport is a BasicReport
55574>>>        
55574>>>            Set Report_Title to "„§œ¥œ¨š˜©å˜ „šš¨˜­é¤                                  "
55575>>>            Set Report_Caption to "ƒ ˜› ¡˜©å˜ ©œ „¥â¢ ¥ž    "
55576>>>        
55576>>>            Object Areas_DD is a Areas_DataDictionary
55578>>>            End_Object    // Areas_DD
55579>>>        
55579>>>            Object Payresp_DD is a Payresp_DataDictionary
55581>>>            End_Object    // Payresp_DD
55582>>>        
55582>>>            Object syscurxr_DD is a syscurxr_DataDictionary
55584>>>            End_Object    // syscurxr
55585>>>        
55585>>>            Object Country_DD is a Country_DataDictionary
55587>>>            End_Object    // Country_DD
55588>>>        
55588>>>            Object Towns_DD is a Towns_DataDictionary
55590>>>                Set DDO_Server to (Country_DD(self))
55591>>>            End_Object    // Towns_DD
55592>>>        
55592>>>            Object Ctypkin_DD is a Ctypkin_DataDictionary
55594>>>                set piMustNOTConstrain to 1
55595>>>        
55595>>>                Procedure Update
55597>>>                End_Procedure
55598>>>        
55598>>>                Procedure Creating
55600>>>                End_Procedure
55601>>>            End_Object    // Ctypkin_DD
55602>>>        
55602>>>            Object Cities_DD is a Cities_DataDictionary
55604>>>                Set DDO_Server to (Towns_DD(self))
55605>>>            End_Object    // Cities_DD
55606>>>        
55606>>>            Object Clients_DD is a Clients_DataDictionary
55608>>>                Set DDO_Server to (Cities_DD(self))
55609>>>                Set DDO_Server to (Payresp_DD(self))
55610>>>                Set DDO_Server to (Areas_DD(self))
55611>>>            End_Object    // Clients_DD
55612>>>        
55612>>>            Object Cmoves_DD is a Cmoves_DataDictionary
55614>>>                Set DDO_Server to (Ctypkin_DD(self))
55615>>>                Set DDO_Server to (Clients_DD(self))
55616>>>        //        set pifromxrhsh to 1
55616>>>        //                set pifrombp    to 1
55616>>>            End_Object    // Cmoves_DD
55617>>>        
55617>>>            Object Cmovesa_DD is a Cmovesa_DataDictionary
55619>>>                //AB-StoreStart
55619>>>                Begin_Constraints
55621>>>                    date dapoe deose dvaluee
55622>>>                    string smodule
55622>>>                    get psmodule to smodule
55623>>>                    Get Value Of date_apo Item 0 to dapoe
55624>>>                    get value of date_eos item 0 to deose
55625>>>                    set ordering to 13
55626>>>                    constrain cmovesa.company_code eq syscurxr.company_code
55628>>>                    constrain cmovesa.branch_code  eq syscurxr.branch_code
55630>>>                    constrain cmovesa.year_year    eq syscurxr.year_year
55632>>>                    constrain cmovesa.module_from  eq '01'
55634>>>                    constrain cmovesa.cmoves_hmnia ge dapoe
55636>>>                    constrain cmovesa.cmoves_hmnia le deose
55638>>>                End_Constraints
55641>>>            end_object
55642>>>            Set Server To (cmovesa_dd(Current_Object))
55643>>>        
55643>>>            //Breaks and Index for the report
55643>>>            Report_Index By Index.11
55645>>>            Report_breaks cmovesa.company_code cmovesa.branch_code cmovesa.module_from cmovesa.client_id cmovesa.cn_code
55662>>>        
55662>>>            Function Starting_Main_Report Returns Integer
55664>>>              REREAD SYSCURXR
55668>>>              UNLOCK
55669>>>>
55669>>>              Integer iIndexRlog
55670>>>              Local Integer iRetVal
55670>>>              Forward Get Starting_Main_Report to iRetval
55672>>>              send rebuild_constraints to cmovesa_dd
55673>>>              Send Find to (cmovesa_dd(self)) First_Record 13
55674>>>            End_Function
55675>>>        
55675>>>            Procedure_Section subheader1
55677>>>                set px0  to 0
55678>>>                set px1  to 0
55679>>>                set px00 to 0
55680>>>                set pp0  to 0
55681>>>                set pp1  to 0
55682>>>                set pp00 to 0
55683>>>                set picount to 0
55684>>>            End_Procedure
55685>>>        
55685>>>            Procedure_Section subheader2
55687>>>                set px0  to 0
55688>>>                set px1  to 0
55689>>>                set px00 to 0
55690>>>                set pp0  to 0
55691>>>                set pp1  to 0
55692>>>                set pp00 to 0
55693>>>                set picount to 0
55694>>>            End_Procedure
55695>>>        
55695>>>            Procedure_Section subheader3
55697>>>                set px0  to 0
55698>>>                set px1  to 0
55699>>>                set px00 to 0
55700>>>                set pp0  to 0
55701>>>                set pp1  to 0
55702>>>                set pp00 to 0
55703>>>                set picount to 0
55704>>>            End_Procedure
55705>>>        
55705>>>            Procedure_Section subheader4
55707>>>                set px0  to 0
55708>>>                set px1  to 0
55709>>>                set px00 to 0
55710>>>                set pp0  to 0
55711>>>                set pp1  to 0
55712>>>                set pp00 to 0
55713>>>                set picount to 0
55714>>>        
55714>>>                String scode
55715>>>                Integer iSkip
55715>>>                Move 0 to iSkip
55716>>>        
55716>>>                Set psClientToSkip to ""
55717>>>        
55717>>>                If (psFileExair(Self)<>"") Begin
55719>>>        
55719>>>                    Direct_Input Channel 7 (psFileExair(Self))
55721>>>                    Readln Channel 7 scode
55723>>>                    While ( (not(Seqeof)) And (iSkip=0))
55727>>>                        If (Trim(sCode)=cmovesa.client_id) Begin
55729>>>                            Set psClientToSkip to cmovesa.client_id
55730>>>                            Goto Ante_apo_edo
55731>>>>
55731>>>                        End
55731>>>>
55731>>>                        Readln Channel 7 scode
55733>>>                    Loop
55734>>>>
55734>>>                    Ante_apo_edo:
55734>>>                    Close_Input Channel 7
55736>>>                 End
55736>>>>
55736>>>        
55736>>>        
55736>>>                If (psClientToSkip(vwKleisimo(Self))<>"") Begin
55738>>>                    STring sClSk
55738>>>                    Get psClientToSkip to sClSk
55739>>>                    Showln "Skipping Client ID = " (Trim(sClSk))
55742>>>                End
55742>>>>
55742>>>            End_Procedure
55743>>>        
55743>>>            Procedure_Section subheader5
55745>>>                set px0  to 0
55746>>>                set px1  to 0
55747>>>                set px00 to 0
55748>>>                set pp0  to 0
55749>>>                set pp1  to 0
55750>>>                set pp00 to 0
55751>>>                set picount to 0
55752>>>            End_Procedure
55753>>>        
55753>>>            Procedure_Section  Body
55755>>>                String  scode smodule spar serr
55756>>>                Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1
55756>>>                Date    dHmnia
55756>>>                integer iyear icount nyear ctypkinyear
55756>>>        
55756>>>                If (psClientToSkip(vwKleisimo(Self))=CmovesA.Client_ID) Procedure_Return
55759>>>        
55759>>>                get px0    to nx0
55760>>>                get px1    to nx1
55761>>>                get px00   to nx00
55762>>>                get pp0    to np0
55763>>>                get pp1    to np1
55764>>>                get pp00   to np00
55765>>>                add cmovesa.cmoves_x0     to nx0
55766>>>                add cmovesa.cmoves_p0     to np0
55767>>>                add cmovesa.cmoves_x00    to nx00
55768>>>                add cmovesa.cmoves_p00    to np00
55769>>>                add cmovesa.cmoves_x1     to nx1
55770>>>                add cmovesa.cmoves_p1     to np1
55771>>>                set px0    to nx0
55772>>>                set px1    to nx1
55773>>>                set px00   to nx00
55774>>>                set pp0    to np0
55775>>>                set pp1    to np1
55776>>>                set pp00   to np00
55777>>>            End_Procedure
55778>>>        
55778>>>            Procedure_Section subTOTAL5
55780>>>        
55780>>>                Number  naxia nx0 np0 nx00 np00 nx1 np1 ndiaf tx0 tp0 tx00 tp00 tx1 tp1
55781>>>                integer icount ieisa ipis ikl
55781>>>                string smodule spar msgstr SID scn   sposo spath scode
55781>>>                date dvaluee dHmniaEis
55781>>>                String sTypkinCode sClientToSkip
55781>>>        
55781>>>                If (psClientToSkip(vwKleisimo(Self))=CmovesA.Client_ID) Procedure_Return
55784>>>        
55784>>>                Get Value Of (value_date(vwKleisimo(Self))) Item 0 to dHmniaEis
55785>>>        
55785>>>                Get Value Of FormSub3 Item 0 to sPath
55786>>>                Move (Trim(sPath)) to sPath
55787>>>                Move '01' to smodule
55788>>>                get value of value_date to dvaluee
55789>>>                get checked_state of chkeisa item 0 to  ieisa
55790>>>                get checked_state of chkshm  item 0 to  ipis
55791>>>                get checked_state of chkkl   item 0 to  ikl
55792>>>                get picount to icount
55793>>>                move (icount+1) to icount
55794>>>                set picount to icount
55795>>>                get px0    to nx0
55796>>>                get px1    to nx1
55797>>>                get px00   to nx00
55798>>>                get pp0    to np0
55799>>>                get pp1    to np1
55800>>>                get pp00   to np00
55801>>>        
55801>>>                if (((nx0 <> 0) or (np0 <>0)) And ((nx0-np0)<>0) ) begin
55803>>>        
55803>>>                    clear clients
55804>>>                    move cmovesa.client_id to clients.client_id
55805>>>                    find eq clients by index.6
55806>>>>
55806>>>                    if (not(found)) error 2999 'ƒœ¤ ™¨å©¡à œ¢á«ž'
55809>>>        
55809>>>                    if (nx0 > np0) begin
55811>>>                        move '104'          to sTypkinCode
55812>>>                        move (nx0-np0)      to np0
55813>>>                        move (nx00-np00)    to np00
55814>>>                        move (nx1-np1)      to np1
55815>>>                        move 0              to nx0
55816>>>                        move 0              to nx00
55817>>>                        move 0              to nx1
55818>>>                        goto epomenok5
55819>>>>
55819>>>                    end
55819>>>>
55819>>>        
55819>>>                    if (np0 > nx0) begin
55821>>>                        move  '103'         to sTypkinCode
55822>>>                        move (np0-nx0)      to nx0
55823>>>                        move (np00-nx00)    to nx00
55824>>>                        move (np1-nx1)      to nx1
55825>>>                        move 0 to np0
55826>>>                        move 0 to np00
55827>>>                        move 0 to np1
55828>>>                    end
55828>>>>
55828>>>        
55828>>>                    epomenok5:
55828>>>        
55828>>>        
55828>>>                    If (Trim(sTypkinCode)="") Begin
55830>>>                        Showln (Trim(cmovesa.client_id)) "    " (Trim(cmovesa.Ctypkin_Code)) '    '  (Trim(sTypkinCode)) '    ' cmovesa.cmoves_hmnia '    '   cmovesa.cmoves_Recr  "    "  cmovesa.cmoves_x0  "   " cmovesa.cmoves_p0
55844>>>                        Error 8800 'Ctypkin problem'
55845>>>>
55845>>>                    End
55845>>>>
55845>>>        
55845>>>        
55845>>>                    move '' to spar
55846>>>        
55846>>>                          if (sTypkinCode='103') move (Append(sPar,('*•-‘†‹*'+ (String(dvaluee))))) to sPar
55849>>>                    else  if (sTypkinCode='104') move (Append(sPar,('*‘-‘†‹*'+ (String(dvaluee))))) to sPar
55853>>>        
55853>>>                    MOVE cmovesa.client_id to sid
55854>>>                    MOVE cmovesa.cn_code to scn
55855>>>                    send update_status ('„šš¨˜­ã   ' + string(sid) + " : " + string(scn))
55856>>>        
55856>>>        
55856>>>                    Send Clear To Ctypkin_DD
55857>>>                    Send Clear To Clients_DD
55858>>>                    Send Clear To Cmoves_DD
55859>>>        
55859>>>                    Move sID   To Clients.Client_Id
55860>>>                    Send Find To Clients_DD eq 6 // Client_ID
55861>>>                    If (not(Found)) Begin
55863>>>                        move 'ƒœ¤ ™¨âŸž¡œ ¦ œ¢á«žª ©«¦ €¨®œå¦ ! œ¢á«žª = ' to msgstr
55864>>>                        append msgstr sid
55865>>>                        error 2319 msgstr
55866>>>>
55866>>>                    End
55866>>>>
55866>>>        
55866>>>                    Move sTypkinCode To Ctypkin.Ctypkin_Code
55867>>>                    Send Find To Ctypkin_DD eq 1
55868>>>                    If (not(Found)) Begin
55870>>>                        move 'ƒœ¤ ™¨âŸž¡œ ž ‰å¤ž©ž ©«¦ €¨®œå¦ ! ‰å¤ž©ž = ' to msgstr
55871>>>                        append msgstr sTypkinCode
55872>>>                        error 2320 msgstr
55873>>>>
55873>>>                    End
55873>>>>
55873>>>        
55873>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cn_code      To CmovesA.Cn_code
55874>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cn_recr      To CmovesA.cn_recr
55875>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.sls_id       To CmovesA.sls_id
55876>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.presp_id     To CmovesA.presp_id
55877>>>        
55877>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.cnt_id       To CmovesA.cnt_id
55878>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.mhxanik_id   To CmovesA.mhxanik_id
55879>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.presp_id     To CmovesA.presp_id
55880>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_Hmnia To dHmniaEis
55881>>>        
55881>>>        
55881>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_M_Code   To '01'
55882>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Module_From     To '01'
55883>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_par      To sPar
55884>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Cmoves_sc_code2 To 'EUR'
55885>>>        
55885>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.enhm_ofeilh       To '1'
55886>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Ypol_Pel     To '1'
55887>>>                    Set Field_Changed_Value Of Cmoves_DD Field Cmoves.Enhm_Hmnies_Pel   To '1'
55888>>>        
55888>>>        
55888>>>                    If (nx0>0) Begin
55890>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_axia   to nx0
55891>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x0     to nx0
55892>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p0     to 0
55893>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x00    to nx00
55894>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p00    to 0
55895>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x1     to nx1
55896>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p1     to 0
55897>>>        
55897>>>                        goto epomenok2
55898>>>>
55898>>>        
55898>>>                    End
55898>>>>
55898>>>        
55898>>>                    If (np0>0) Begin
55900>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_axia   to np0
55901>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x0     to 0
55902>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p0     to np0
55903>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x00    to 0
55904>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p00    to np00
55905>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_x1     to 0
55906>>>                        set field_changed_value of cmoves_dd field cmoves.cmoves_p1     to np1
55907>>>                    End
55907>>>>
55907>>>        
55907>>>                    epomenok2:
55907>>>        
55907>>>                    Send Request_Save to Cmoves_DD
55908>>>        
55908>>>                 end
55908>>>>
55908>>>        
55908>>>            End_Procedure
55909>>>        
55909>>>        
55909>>>            Procedure_Section subtotal4
55911>>>            End_Procedure
55912>>>        
55912>>>        
55912>>>            Procedure_Section subtotal3
55914>>>            End_Procedure
55915>>>        
55915>>>            Procedure_Section subtotal2
55917>>>            End_Procedure
55918>>>        
55918>>>            Procedure_Section subtotal1
55920>>>            End_Procedure
55921>>>        
55921>>>        End_Object
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        
55922>>>        //AB-StoreEnd
55922>>>
55922>>>    End_Object    // vwKleisimo
55923>>>
55923>>>
55923>>>    //AB-StoreStart
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>                                                                                                    
55923>>>    //AB-StoreEnd
55923>>>
55923>>>//AB/     End_Object    // prj
55923>        Use vsapdom.VW                                                                      
INCLUDING FILE: VSAPDOM.VW
55923>>>//AB/ Project vsapdom:eksagogh eggrafon  domikh
55923>>>//AB/     Object prj is a View_Project
55923>>>//AB/         Set ProjectName to "vsapdom:eksagogh eggrafon  domikh"
55923>>>//AB/         Set ProjectFileName to "vsapdom.VW"
55923>>>//AB/         Set GenerateFileName to "NONAME"
55923>>>
55923>>>// Project Object Structure
55923>>>//   vsapdom is a dbViewSub
55923>>>//     Clients_DD is a DataDictionary
55923>>>//     Tempitel_DD is a DataDictionary
55923>>>//     Tempitem_DD is a DataDictionary
55923>>>//     frmapo is a FormSub
55923>>>//     RadioGroupSub1 is a RadioGroupSub
55923>>>//       Radio1 is a RadioSub
55923>>>//       Radio3 is a RadioSub
55923>>>//       RadioSub1 is a RadioSub
55923>>>//       RadioSub4 is a RadioSub
55923>>>//       RadioSub5 is a RadioSub
55923>>>//       RadioSub6 is a RadioSub
55923>>>//       Radio7 is a RadioSub
55923>>>//     btnMetasx is a ButtonSub
55923>>>//     btnekt is a ButtonSub
55923>>>//     frmShow is a ButtonSub
55923>>>//     ButtonSub1 is a ButtonSub
55923>>>//     Textbox1 is a Textbox
55923>>>//     btnPartl is a ButtonSub
55923>>>//     frmPath is a FormSub
55923>>>//     TextBoxSub1 is a TextBoxSub
55923>>>//     oDirectoryPicker is a OLEDPDlg
55923>>>
55923>>>// Register all objects
55923>>>Register_Object ButtonSub1
55923>>>Register_Object btnekt
55923>>>Register_Object btnMetasx
55923>>>Register_Object btnPartl
55923>>>Register_Object Clients_DD
55923>>>Register_Object frmapo
55923>>>Register_Object frmPath
55923>>>Register_Object frmShow
55923>>>Register_Object oDirectoryPicker
55923>>>Register_Object Radio1
55923>>>Register_Object Radio3
55923>>>Register_Object Radio7
55923>>>Register_Object RadioGroupSub1
55923>>>Register_Object RadioSub1
55923>>>Register_Object RadioSub4
55923>>>Register_Object RadioSub5
55923>>>Register_Object RadioSub6
55923>>>Register_Object Tempitel_DD
55923>>>Register_Object Tempitem_DD
55923>>>Register_Object TextBoxSub1
55923>>>Register_Object Textbox1
55923>>>Register_Object vsapdom
55923>>>
55923>>>
55923>>>//AB/     AppBuild VIEW
55923>>>
55923>>>
55923>>>    //AB-StoreTopStart
55923>>>    open    TmpclSap
INCLUDING FILE: TMPCLSAP.FD
55925>>>    Open    Wapokat
55927>>>    Open    Wtypkin
55929>>>    Open    Wcmoves
55931>>>    Open    sysfile
55933>>>    Open    codemast
55935>>>    Open    cities
55937>>>    Use     rclsap.rv
INCLUDING FILE: RCLSAP.RV
55937>>>>>//AB/ Project Rclsap:ektyposh pelatonsap
55937>>>>>//AB/ Object prj is a Report_Project
55937>>>>>//AB/     Set ProjectName to "Rclsap:ektyposh pelatonsap"
55937>>>>>//AB/     Set ProjectFileName to "Rclsap.RV"
55937>>>>>
55937>>>>>// Project Object Structure
55937>>>>>//   Rclsap is a ReportView
55937>>>>>//     DestRadio is a RadioGroup
55937>>>>>//       WindowRadio is a Radio
55937>>>>>//     ButtonSub1 is a Button
55937>>>>>//     ButtonSub3 is a ButtonSub
55937>>>>>//     prom1WQLReport is a crystalreportSubSQL
55937>>>>>
55937>>>>>// Register all objects
55937>>>>>Register_Object ButtonSub1
55937>>>>>Register_Object ButtonSub3
55937>>>>>Register_Object DestRadio
55937>>>>>Register_Object prom1WQLReport
55937>>>>>Register_Object Rclsap
55937>>>>>Register_Object WindowRadio
55937>>>>>
55937>>>>>
55937>>>>>//AB/ Report View
55937>>>>>
55937>>>>>
55937>>>>>//AB-StoreTopStart
55937>>>>>Use dfallrpt
55937>>>>>//AB-StoreTopEnd
55937>>>>>
55937>>>>>//AB-IgnoreStart
55937>>>>>
55937>>>>>Use DFAllEnt.pkg
55937>>>>>Use Button.Sub
55937>>>>>
55937>>>>>//AB-IgnoreEnd
55937>>>>>
55937>>>>>ACTIVATE_VIEW Activate_Rclsap FOR Rclsap
55941>>>>>
55941>>>>>Object Rclsap is a ReportView
55943>>>>>
55943>>>>>    //AB-StoreTopStart
55943>>>>>    property integer piti public 0
55945>>>>>    property date pddate public ''
55947>>>>>    
55947>>>>>    //AB-StoreTopEnd
55947>>>>>
55947>>>>>    Set Label to "ts.ektyposh_paraggelias_promhtheyth"
55948>>>>>    Set Size to 48 191
55949>>>>>    Set Location to 9 165
55950>>>>>
55950>>>>>    //AB-DDOStart
55950>>>>>
55950>>>>>
55950>>>>>    //AB-DDOEnd
55950>>>>>
55950>>>>>    Object DestRadio is a RadioGroup
55952>>>>>
55952>>>>>        //AB-StoreTopStart
55952>>>>>                                            
55952>>>>>        //AB-StoreTopEnd
55952>>>>>
55952>>>>>        Set Label to "tz.ektyposh"
55953>>>>>        Set Size to 29 49
55954>>>>>        Set Location to 2 1
55955>>>>>        Object WindowRadio is a Radio
55957>>>>>            Set Size to 13 30
55958>>>>>            Set Location to 12 12
55959>>>>>            Set Bitmap to "screen4.bmp"
55960>>>>>        End_Object    // WindowRadio
55961>>>>>
55961>>>>>
55961>>>>>        //AB-StoreStart
55961>>>>>        set visible_state of (destradio(self)) to false
55962>>>>>        Set Output_Device_Mode To WQL_PRINT_TO_WINDOW
55963>>>>>        
55963>>>>>        //AB-StoreEnd
55963>>>>>
55963>>>>>    End_Object    // DestRadio
55964>>>>>
55964>>>>>    Object ButtonSub1 is a Button
55966>>>>>
55966>>>>>        //AB-StoreTopStart
55966>>>>>                                            
55966>>>>>        //AB-StoreTopEnd
55966>>>>>
55966>>>>>        Set Bitmap to "RUNPROG.BMP"
55967>>>>>        Set Size to 18 29
55968>>>>>        Set Location to 6 55
55969>>>>>
55969>>>>>        //AB-StoreStart
55969>>>>>        Procedure OnClick
55971>>>>>           Send Runprom1report To (prom1WQLReport(Current_Object))
55972>>>>>        End_Procedure
55973>>>>>        
55973>>>>>        //AB-StoreEnd
55973>>>>>
55973>>>>>    End_Object    // ButtonSub1
55974>>>>>
55974>>>>>    Object ButtonSub3 is a ButtonSub
55976>>>>>
55976>>>>>        //AB-StoreTopStart
55976>>>>>                                            
55976>>>>>        //AB-StoreTopEnd
55976>>>>>
55976>>>>>        Set Bitmap to "CANCEL.BMP"
55977>>>>>        Set Size to 18 29
55978>>>>>        Set Location to 6 89
55979>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
55980>>>>>
55980>>>>>        //AB-StoreStart
55980>>>>>        Procedure OnClick
55982>>>>>            Send Request_Cancel
55983>>>>>        End_Procedure
55984>>>>>        
55984>>>>>        //AB-StoreEnd
55984>>>>>
55984>>>>>    End_Object    // ButtonSub3
55985>>>>>
55985>>>>>
55985>>>>>    //AB-StoreStart
55985>>>>>    
55985>>>>>    Object prom1WQLReport Is A crystalreportSubSQL
55987>>>>>         Property Integer ReportReady Public False
55989>>>>>         Set Report_View_id To (Parent(Current_object))
55990>>>>>         Procedure OnStartPrinting
55992>>>>>             Local String  Selection FileName lsdate sitem spay  stype
55993>>>>>             local number  nypoprosf npelates ncn
55993>>>>>             Local Integer FileType Destination SortOrder NumSortFields CurSortField
55993>>>>>             Local Integer SortDirection ifrom datefrom istadio
55993>>>>>             date dapo
55993>>>>>             get pddate to dapo
55994>>>>>             move '9999' to stype
55995>>>>>             move (trim(stype)) to stype
55996>>>>>             if (piti(self)=2) begin
55998>>>>>                Set Formula "fapo"  To (winql_date(dapo))
55999>>>>>             end
55999>>>>>>
55999>>>>>             if (piti(self)=3) begin
56001>>>>>                Set Formula "fapo"  To (winql_date(dapo))
56002>>>>>             end
56002>>>>>>
56002>>>>>             if (piti(self)=4) begin
56004>>>>>                Set Formula "fapo"  To (winql_date(dapo))
56005>>>>>             end
56005>>>>>>
56005>>>>>    
56005>>>>>             if (piti(self)=5) begin
56007>>>>>                Set Formula "fapo"  To (winql_date(dapo))
56008>>>>>             end
56008>>>>>>
56008>>>>>    
56008>>>>>             if (piti(self)=6) begin
56010>>>>>                Set Formula "fapo"  To (winql_date(dapo))
56011>>>>>             end
56011>>>>>>
56011>>>>>    
56011>>>>>             if (piti(self)=7) begin
56013>>>>>                Set Formula "fafm"  To (winql_number(1))
56014>>>>>             end
56014>>>>>>
56014>>>>>             if (piti(self)=1) begin
56016>>>>>                Set Formula "fafm"  To (winql_number(0))
56017>>>>>             end
56017>>>>>>
56017>>>>>              //*** Setup the selection formula
56017>>>>>                move WQL_PRINT_TO_WINDOW to destination
56018>>>>>                If Destination EQ WQL_PRINT_TO_WINDOW ;                    Set ReportReady To False
56021>>>>>                Else ;                    Set ReportReady To True
56023>>>>>        End_procedure // OnStartPrinting
56024>>>>>    
56024>>>>>        Procedure Runprom1Report
56026>>>>>     //       Send Cursor_Wait To (Cursor_Control(Current_Object))
56026>>>>>            if (piti(self)=1);                set Report_name    To "Rclsap.rpt"
56029>>>>>            else if (piti(self)=2);                set Report_name    To "Reispsap.rpt"
56033>>>>>            else if (piti(self)=3);                set Report_name    To "Rtimsap.rpt"
56037>>>>>            else if (piti(self)=4);                set Report_name    To "Rapothsap.rpt"
56041>>>>>            else if (piti(self)=5);                set Report_name    To "Rtehnsap.rpt"
56045>>>>>            else if (piti(self)=6);                set Report_name    To "Ranalsap.rpt"
56049>>>>>             if (piti(self)=7);                set Report_name    To "Rclsap.rpt"
56052>>>>>            Send Run_report
56053>>>>>    //        Send Cursor_Ready To (Cursor_Control(Current_Object))
56053>>>>>            If (ReportReady(Current_object)) ;                Send Info_box "WinQL report ready."
56056>>>>>        End_procedure //
56057>>>>>    
56057>>>>>    End_object
56058>>>>>    
56058>>>>>    
56058>>>>>    
56058>>>>>    
56058>>>>>    
56058>>>>>    //AB-StoreEnd
56058>>>>>
56058>>>>>End_Object    // Rclsap
56059>>>>>
56059>>>>>
56059>>>>>//AB-StoreStart
56059>>>>>    
56059>>>>>//AB-StoreEnd
56059>>>>>
56059>>>>>//AB/ End_Object    // prj
56059>>>    Open    Clients
56061>>>    Use     Vwsap.vw
INCLUDING FILE: VWSAP.VW
56061>>>>>//AB/ Project Vwsap
56061>>>>>//AB/     Object prj is a View_Project
56061>>>>>//AB/         Set ProjectName to "Vwsap"
56061>>>>>//AB/         Set ProjectFileName to "Vwsap.vw"
56061>>>>>//AB/         Set GenerateFileName to "Vwsap.vw"
56061>>>>>
56061>>>>>// Project Object Structure
56061>>>>>//   Vwsap is a dbView
56061>>>>>//     oInternetErrorArray is a Array
56061>>>>>//     Tmpsap_DD is a DataDictionary
56061>>>>>//     frmPassw is a FormSub
56061>>>>>//     frmHmnia is a cSyDateForm
56061>>>>>//     btnDelete is a ButtonSub
56061>>>>>//     btnSend is a ButtonSub
56061>>>>>//     TextBoxSub1 is a TextBoxSub
56061>>>>>//     The_Table is a dbGrid
56061>>>>>//     btnMess is a ButtonSub
56061>>>>>//     TextBoxSub2 is a TextBoxSub
56061>>>>>//     frmAddress is a FormSub
56061>>>>>//     frmConn is a FormSub
56061>>>>>//     frmUserName is a FormSub
56061>>>>>//     frmPassword is a FormSub
56061>>>>>//     frmDirectory is a FormSub
56061>>>>>//     TextBoxSub3 is a TextBoxSub
56061>>>>>//     TextBoxSub4 is a TextBoxSub
56061>>>>>//     frmMessage is a FormSub
56061>>>>>//     oStatusForm is a EditSub
56061>>>>>
56061>>>>>// Register all objects
56061>>>>>Register_Object btnDelete
56061>>>>>Register_Object btnMess
56061>>>>>Register_Object btnSend
56061>>>>>Register_Object frmAddress
56061>>>>>Register_Object frmConn
56061>>>>>Register_Object frmDirectory
56061>>>>>Register_Object frmHmnia
56061>>>>>Register_Object frmMessage
56061>>>>>Register_Object frmPassw
56061>>>>>Register_Object frmPassword
56061>>>>>Register_Object frmUserName
56061>>>>>Register_Object oInternetErrorArray
56061>>>>>Register_Object oStatusForm
56061>>>>>Register_Object TextBoxSub1
56061>>>>>Register_Object TextBoxSub2
56061>>>>>Register_Object TextBoxSub3
56061>>>>>Register_Object TextBoxSub4
56061>>>>>Register_Object The_Table
56061>>>>>Register_Object Tmpsap_DD
56061>>>>>Register_Object Vwsap
56061>>>>>
56061>>>>>
56061>>>>>//AB/     AppBuild VIEW
56061>>>>>
56061>>>>>
56061>>>>>    //AB-StoreTopStart
56061>>>>>                        
56061>>>>>    Open Particle
56063>>>>>    Open Cmoves
56065>>>>>    Open wcmoves
56067>>>>>    Open WitemxTr
INCLUDING FILE: WITEMXTR.FD
56069>>>>>    Open ItemTehn
56071>>>>>    Use Keimeno.dg
INCLUDING FILE: KEIMENO.DG
56071>>>>>>>//AB/ Project keimeno
56071>>>>>>>//AB/     Object prj is a Dialog_Project
56071>>>>>>>//AB/         Set ProjectName to "keimeno"
56071>>>>>>>//AB/         Set ProjectFileName to "Keimeno.dg"
56071>>>>>>>
56071>>>>>>>// Project Object Structure
56071>>>>>>>//   keimeno is a BasicPanelSub
56071>>>>>>>//     EditSub1 is a EditSub
56071>>>>>>>
56071>>>>>>>// Register all objects
56071>>>>>>>Register_Object EditSub1
56071>>>>>>>Register_Object keimeno
56071>>>>>>>
56071>>>>>>>
56071>>>>>>>    //AB-IgnoreStart
56071>>>>>>>
56071>>>>>>>    Use Panel.Sub
56071>>>>>>>    Use Edit.Sub
56071>>>>>>>
56071>>>>>>>    //AB-IgnoreEnd
56071>>>>>>>
56071>>>>>>>
56071>>>>>>>    //AB-IgnoreEnd
56071>>>>>>>
56071>>>>>>>    Object keimeno is a BasicPanelSub
56073>>>>>>>
56073>>>>>>>        //AB-StoreTopStart
56073>>>>>>>
56073>>>>>>>        //AB-StoreTopEnd
56073>>>>>>>
56073>>>>>>>        Set Minimize_Icon to FALSE
56074>>>>>>>        Set Label to "‰œå£œ¤¦"
56075>>>>>>>        Set Size to 170 449
56076>>>>>>>        Set Location to 3 20
56077>>>>>>>        Set Exit_Application_Local_State to TRUE
56078>>>>>>>        Set Popup_State to TRUE
56079>>>>>>>
56079>>>>>>>        //AB-DDOStart
56079>>>>>>>
56079>>>>>>>
56079>>>>>>>        //AB-DDOEnd
56079>>>>>>>
56079>>>>>>>        Object EditSub1 is a editSub
56081>>>>>>>
56081>>>>>>>            //AB-StoreTopStart
56081>>>>>>>
56081>>>>>>>            //AB-StoreTopEnd
56081>>>>>>>
56081>>>>>>>            Set Size to 147 437
56082>>>>>>>            Set Location to 4 5
56083>>>>>>>            Set Color to 15400959
56084>>>>>>>            Set File_Name to "ErrText.log"
56085>>>>>>>            Set Read_Only_State to TRUE
56086>>>>>>>
56086>>>>>>>            //AB-StoreStart
56086>>>>>>>            Send DoRegAlign Self amtopleft
56087>>>>>>>            Send DoRegSize  Self smbottomright
56088>>>>>>>            //AB-StoreEnd
56088>>>>>>>
56088>>>>>>>        End_Object    // EditSub1
56089>>>>>>>
56089>>>>>>>
56089>>>>>>>        //AB-StoreStart
56089>>>>>>>        Set Minimize_Icon to True
56090>>>>>>>        Set Maximize_Icon to True
56091>>>>>>>        Set Border_Style to Border_Thick
56092>>>>>>>        //AB-StoreEnd
56092>>>>>>>
56092>>>>>>>    End_Object    // keimeno
56093>>>>>>>
56093>>>>>>>//AB/     End_Object    // prj
56093>>>>>    
56093>>>>>    //AB-StoreTopEnd
56093>>>>>
56093>>>>>    //AB-IgnoreStart
56093>>>>>
56093>>>>>    Use DFAllEnt.pkg
56093>>>>>    Use Form.Sub
56093>>>>>    Use cSyDateForm.Pkg
56093>>>>>    Use Button.Sub
56093>>>>>    Use Txtbox.Sub
56093>>>>>    Use Edit.Sub
56093>>>>>
56093>>>>>    Use TMPSAP.DD
INCLUDING FILE: TMPSAP.DD
56093>>>>>>>//DDB-FileStart
56093>>>>>>>//DDB-HeaderStart
56093>>>>>>>
56093>>>>>>>// File Name : TMPSAP.DD
56093>>>>>>>// Class Name: Tmpsap_DataDictionary
56093>>>>>>>// Revision  : 3
56093>>>>>>>// Version   : 2
56093>>>>>>>
56093>>>>>>>Use  Windows           // Basic Definitions
56093>>>>>>>Use  DataDict          // DataDictionary Class Definition
56093>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56093>>>>>>>
56093>>>>>>>Open Tmpsap
INCLUDING FILE: TMPSAP.FD
56095>>>>>>>
56095>>>>>>>//DDB-HeaderEnd
56095>>>>>>>
56095>>>>>>>Class Tmpsap_DataDictionary  is a DataDictionary_sec
56096>>>>>>>
56096>>>>>>>    // Define_Fields:
56096>>>>>>>    // This procedure is used to set up all data-dictionary rules.
56096>>>>>>>
56096>>>>>>>    Procedure Define_Fields
56097>>>>>>>        Forward Send Define_Fields
56099>>>>>>>        //DDB-Generated-Code-Location
56099>>>>>>>        //DDB-DefineFieldStart
56099>>>>>>>
56099>>>>>>>        Set Main_File            To Tmpsap.File_Number
56100>>>>>>>
56100>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
56101>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
56102>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56103>>>>>>>
56103>>>>>>>        // Field-based properties.......................
56103>>>>>>>
56103>>>>>>>        // Tmpsap.Date
56103>>>>>>>        Set Field_Mask_Type        Field Tmpsap.Date To MASK_DATE_WINDOW
56104>>>>>>>
56104>>>>>>>        // Tmpsap.Apestalei
56104>>>>>>>        Set Field_Checkbox_Values  Field Tmpsap.Apestalei To "1"  "0"
56105>>>>>>>        Set Field_Class_Name       Field Tmpsap.Apestalei To "dbCheckBoxSub"
56106>>>>>>>
56106>>>>>>>        // Tmpsap.Kleidomeno
56106>>>>>>>        Set Field_Checkbox_Values  Field Tmpsap.Kleidomeno To "1"  "0"
56107>>>>>>>        Set Field_Class_Name       Field Tmpsap.Kleidomeno To "dbCheckBoxSub"
56108>>>>>>>
56108>>>>>>>        //DDB-DefineFieldEnd
56108>>>>>>>    End_Procedure    // Define_Fields
56109>>>>>>>
56109>>>>>>>    // Field_Defaults:
56109>>>>>>>    // This procedure is used to establish default field values.
56109>>>>>>>
56109>>>>>>>    Procedure Field_Defaults
56110>>>>>>>        Forward Send Field_Defaults
56112>>>>>>>        //DDB-Generated-Code-Location
56112>>>>>>>        //DDB-FieldDefaultStart
56112>>>>>>>        Set Field_Changed_Value   Field Tmpsap.Apestalei To 0
56113>>>>>>>        Set Field_Changed_Value   Field Tmpsap.Kleidomeno To 0
56114>>>>>>>        //DDB-FieldDefaultEnd
56114>>>>>>>    End_Procedure    // Field_Defaults
56115>>>>>>>
56115>>>>>>>End_Class    // Tmpsap_DataDictionary
56116>>>>>>>//DDB-FileEnd
56116>>>>>    
56116>>>>>    //AB-IgnoreEnd
56116>>>>>
56116>>>>>    ACTIVATE_VIEW Activate_Vwsap FOR Vwsap
56120>>>>>
56120>>>>>    Object Vwsap is a dbView
56122>>>>>
56122>>>>>        //AB-StoreTopStart
56122>>>>>            
56122>>>>>        Property Integer    piCount                 Public  0
56124>>>>>        Property String     psBranchPhone           Public ''
56126>>>>>        Property String     psSysfileFilesSendPath  Public ''
56128>>>>>        Property String     psBranchSendPathFiles   Public ''
56130>>>>>        Property String     psBranchSendPathConf    Public ''
56132>>>>>        Property Integer    piFtpSecondsRetry       Public  0
56134>>>>>        Property Integer    piFtpTimesExit          Public  0
56136>>>>>        Property Integer    piReceivedOK            Public  0
56138>>>>>        Property Integer    piTimesCount            Public  0
56140>>>>>        Property Integer    piFileRetreived         Public  0
56142>>>>>        Property Integer    piFromProgrammatismo    Public  0
56144>>>>>        Property Integer    piErrorOccured          Public  0
56146>>>>>        Property String     psBranchRecr            Public ''
56148>>>>>        property Integer    bConnectionStatus       public False
56150>>>>>        
56150>>>>>        External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;            Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
56151>>>>>        
56151>>>>>        Function Network_User_Name Returns String
56153>>>>>            Local String sName sLength
56154>>>>>            Local Pointer lpName_Addr lpLength_Addr
56154>>>>>            Local Integer iRetval
56154>>>>>            Movestr (Repeat (Character (0), 255)) To sName
56155>>>>>>
56155>>>>>            GetAddress Of sName To lpName_Addr
56156>>>>>            Movestr (DwordToBytes (255)) To sLength
56157>>>>>>
56157>>>>>            GetAddress Of sLength To lpLength_Addr
56158>>>>>            Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
56159>>>>>>
56159>>>>>            If iRetval Eq 0 Function_Return (CString (sName))
56162>>>>>            Else Function_Return "User Unknown"
56164>>>>>        End_Function // Network_User_Name
56165>>>>>        
56165>>>>>        Function fsVresEggrafh String asFileName returns Integer
56167>>>>>            Integer rVal
56168>>>>>            Move (UpperCase(asFileName)) to asFileName
56169>>>>>            Move (Trim(asFileName)) to asFileName
56170>>>>>            Function_Return rVal
56171>>>>>        End_Procedure
56172>>>>>        
56172>>>>>        Function fsVresExt String asFileName Returns String
56174>>>>>            String rVal
56175>>>>>            Integer iPos iLen
56175>>>>>            Move (UpperCase(asFileName)) to asFileName
56176>>>>>            Move (Trim(asFileName)) to asFileName
56177>>>>>            Move 0 to iPos
56178>>>>>            For iLen from 1 to (length(asFileName))
56184>>>>>>
56184>>>>>                If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
56187>>>>>            Loop
56188>>>>>>
56188>>>>>            If (Not(iPos)) Function_Return ''
56191>>>>>            Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
56192>>>>>            Move (Trim(rVal)) to rVal
56193>>>>>            Function_Return rVal
56194>>>>>        End_Function
56195>>>>>        
56195>>>>>        Set Verify_Exit_Msg         to Get_No_Confirmation
56196>>>>>        Set Verify_Save_Msg         to Get_No_Confirmation
56197>>>>>        Set Verify_Data_Loss_Msg    to Get_No_Confirmation
56198>>>>>        
56198>>>>>        Register_Object     oInternetErrorArray
56198>>>>>        Register_Procedure  ShowInternetErrorMessage integer iInetError
56198>>>>>        
56198>>>>>        Function fiCloseDialup Returns Integer
56200>>>>>            Integer rVal iStat
56201>>>>>            If (psBranchPhone(self)<>'') Begin
56203>>>>>                If (bConnectionStatus(Self)) begin
56205>>>>>                   Move (dvInternetHangup())    to iStat
56206>>>>>                   If iStat Eq 0 Begin
56208>>>>>                        Set bConnectionStatus   to False
56209>>>>>                        Move 1 to rVal
56210>>>>>                   End
56210>>>>>>
56210>>>>>                   Else Begin
56211>>>>>                        Move 0 to rVal
56212>>>>>                        Send Info_Box "ƒœ¤ £§¦¨é ¤˜ ¡¢œå©à «ž¤ š¨˜££ã" "¢ž¨¦­¦¨å˜"
56213>>>>>                   End
56213>>>>>>
56213>>>>>                End
56213>>>>>>
56213>>>>>                Else Move 1 to rVal
56215>>>>>            End
56215>>>>>>
56215>>>>>            Else Move 1 to rVal
56217>>>>>            Function_Return rVal
56218>>>>>        End_Function
56219>>>>>        
56219>>>>>        Function fiGetFile String asRemoteFile String asLocalFile Integer aiCancelIfExist Integer aiType Returns Integer
56221>>>>>            // aiCancelIfExist  =0 Overwrites local file if already exists
56221>>>>>            // aiCancelIfExist  =1 Cancel transfer if local file already exists
56221>>>>>            // aiType           =0 ASCII transfer method (Control and formatting
56221>>>>>            //                     information is converted to local equivalents.
56221>>>>>            //                  =1 BINARY transfer method. The file is
56221>>>>>            //                     transferred exactly as it exists with no changes.
56221>>>>>            Integer iRetVal
56222>>>>>            send AddInfo to (oStatusForm(Self)) ;                ("Šã¯ž"*asRemoteFile*"©œ"*asLocalFile-"...")
56223>>>>>            move ( dvFtpGetFile (asRemoteFile,asLocalFile,0,1)) to iRetVal
56224>>>>>            if iRetVal begin
56226>>>>>                Function_Return iRetVal
56227>>>>>            end
56227>>>>>>
56227>>>>>            send AddInfo to (oStatusForm(Self)) ("’¦ ˜¨®œå¦"*asRemoteFile*"œ¢ã­Ÿœ ")
56228>>>>>            Function_Return 0
56229>>>>>        End_Function
56230>>>>>        
56230>>>>>        Function fiSendFile String asLocalFile String asRemoteFile Integer aiMode Returns Integer
56232>>>>>            // aiType           =0 ASCII transfer method (Control and formatting
56232>>>>>            //                     information is converted to local equivalents.
56232>>>>>            //                  =1 BINARY transfer method. The file is
56232>>>>>            //                     transferred exactly as it exists with no changes.
56232>>>>>            Integer iRetVal
56233>>>>>            send AddInfo to (oStatusForm(Self)) ;                ("€§¦©«¦¢ã ˜¨®œå¦¬ "*asLocalFile*"©œ"*asRemoteFile-"...")
56234>>>>>            move (dvFtpPutFile(asLocalFile,asRemoteFile,1)) to iRetVal
56235>>>>>            if iRetVal begin
56237>>>>>                Function_Return iRetVal
56238>>>>>            end
56238>>>>>>
56238>>>>>            send AddInfo to (oStatusForm (Self)) ("’¦ ˜¨®œå¦"*asLocalFile*"œ©«á¢œ ")
56239>>>>>            Function_Return 0
56240>>>>>        End_Function
56241>>>>>        
56241>>>>>        
56241>>>>>        Procedure ShowInternetErrorMessage integer iInetError
56243>>>>>            local string sMsg
56244>>>>>            move (dvGetServerMsg()) to sMsg
56245>>>>>            if (trim(sMsg)) eq "" get array_value of (oInternetErrorArray(Self)) ;                item (iInetError - 12000) to sMsg
56248>>>>>            send AddInfo to (oStatusForm(Self)) ("Error:"*sMsg) true
56249>>>>>        End_Procedure
56250>>>>>        
56250>>>>>        Object oInternetErrorArray is an Array
56252>>>>>            Procedure InitializeErrorArray
56254>>>>>                set array_value item 1   to "out of handles"
56255>>>>>                set array_value item 2   to "timeout"
56256>>>>>                set array_value item 3   to "extended error"
56257>>>>>                set array_value item 4   to "internal error"
56258>>>>>                set array_value item 5   to "invalid url"
56259>>>>>                set array_value item 6   to "unrecognized scheme"
56260>>>>>                set array_value item 7   to "name not resolved"
56261>>>>>                set array_value item 8   to "protocol not found"
56262>>>>>                set array_value item 9   to "invalid option"
56263>>>>>                set array_value item 10  to "bad option length"
56264>>>>>                set array_value item 11  to "option not settable"
56265>>>>>                set array_value item 12  to "shutdown"
56266>>>>>                set array_value item 13  to "incorrect user name"
56267>>>>>                set array_value item 14  to "incorrect password"
56268>>>>>                set array_value item 15  to "login failure"
56269>>>>>                set array_value item 16  to "invalid operation"
56270>>>>>                set array_value item 17  to "operation cancelled"
56271>>>>>                set array_value item 18  to "incorrect handle type"
56272>>>>>                set array_value item 19  to "incorrect handle state"
56273>>>>>                set array_value item 20  to "not proxy request"
56274>>>>>                set array_value item 21  to "registry value not found"
56275>>>>>                set array_value item 22  to "bad registry parameter"
56276>>>>>                set array_value item 23  to "no direct access"
56277>>>>>                set array_value item 24  to "no context"
56278>>>>>                set array_value item 25  to "no callback"
56279>>>>>                set array_value item 26  to "request pending"
56280>>>>>                set array_value item 27  to "incorrect format"
56281>>>>>                set array_value item 28  to "item not found"
56282>>>>>                set array_value item 29  to "cannot connect"
56283>>>>>                set array_value item 30  to "connection aborted"
56284>>>>>                set array_value item 31  to "connection reset"
56285>>>>>                set array_value item 32  to "force retry"
56286>>>>>                set array_value item 33  to "invalid proxy request"
56287>>>>>                set array_value item 34  to "need ui"
56288>>>>>                set array_value item 36  to "handle exists"
56289>>>>>                set array_value item 37  to "sec cert date invalid"
56290>>>>>                set array_value item 38  to "sec cert cn invalid"
56291>>>>>                set array_value item 39  to "http to https on redir"
56292>>>>>                set array_value item 40  to "https to http on_redir"
56293>>>>>                set array_value item 41  to "mixed security"
56294>>>>>                set array_value item 42  to "chg post is non secure"
56295>>>>>                set array_value item 43  to "post is non_secure"
56296>>>>>                set array_value item 44  to "client auth cert needed"
56297>>>>>                set array_value item 45  to "invalid ca"
56298>>>>>                set array_value item 46  to "client auth not setup"
56299>>>>>                set array_value item 47  to "async thread failed"
56300>>>>>                set array_value item 48  to "redirect scheme change"
56301>>>>>                set array_value item 49  to "dialog pending"
56302>>>>>                set array_value item 50  to "retry dialog"
56303>>>>>                set array_value item 110 to "ftp transfer in progress"
56304>>>>>                set array_value item 111 to "ftp dropped"
56305>>>>>                set array_value item 112 to "ftp no passive mode"
56306>>>>>                set array_value item 157 to "security channel error"
56307>>>>>                set array_value item 158 to "unable to cache file"
56308>>>>>                set array_value item 159 to "tcpip not installed"
56309>>>>>                set array_value item 163 to "disconnected"
56310>>>>>                set array_value item 164 to "server unreachable"
56311>>>>>                set array_value item 165 to "proxy server unreachable"
56312>>>>>            End_Procedure
56313>>>>>        End_Object
56314>>>>>        
56314>>>>>        
56314>>>>>        
56314>>>>>        
56314>>>>>        //////////////////////////////////////////////////////
56314>>>>>        
56314>>>>>        Register_Function Validate_Password Returns Integer
56314>>>>>        Register_Function fisapok Returns Integer
56314>>>>>        
56314>>>>>        Property Integer piLathi Public 0
56316>>>>>        
56316>>>>>        //AB-StoreTopEnd
56316>>>>>
56316>>>>>        Set Label to "˜¨˜®Ÿâ¤«˜ €¨®œå˜ ‘€"
56317>>>>>        Set Size to 282 521
56318>>>>>        Set Location to 1 5
56319>>>>>
56319>>>>>        //AB-DDOStart
56319>>>>>
56319>>>>>        Object Tmpsap_DD is a Tmpsap_DataDictionary
56321>>>>>
56321>>>>>            //AB-StoreTopStart
56321>>>>>                                                                                                                                                                                                                            
56321>>>>>            //AB-StoreTopEnd
56321>>>>>
56321>>>>>
56321>>>>>            //AB-StoreStart
56321>>>>>                                                                                                                                                                                                                            
56321>>>>>            Procedure Request_Save
56323>>>>>            End_Procedure
56324>>>>>            
56324>>>>>            Procedure Request_Delete
56326>>>>>            End_Procedure
56327>>>>>            
56327>>>>>            
56327>>>>>            //AB-StoreEnd
56327>>>>>
56327>>>>>        End_Object    // Tmpsap_DD
56328>>>>>
56328>>>>>        Set Main_DD to (Tmpsap_DD(self))
56329>>>>>        Set Server to (Tmpsap_DD(self))
56330>>>>>
56330>>>>>        //AB-DDOEnd
56330>>>>>
56330>>>>>        Object frmPassw is a FormSub
56332>>>>>
56332>>>>>            //AB-StoreTopStart
56332>>>>>                                                                                                                                                                                                                                                                                                        
56332>>>>>            //AB-StoreTopEnd
56332>>>>>
56332>>>>>            Set Size to 13 85
56333>>>>>            Set Location to 29 200
56334>>>>>            Set Label_Col_Offset to 2
56335>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56336>>>>>            Set Password_State Item 0 to TRUE
56337>>>>>
56337>>>>>            //AB-StoreStart
56337>>>>>                                                                                                                                                                                                                                                                                                        
56337>>>>>            Procedure OnChange
56339>>>>>                Integer isValid
56340>>>>>                Move (Validate_Password(Self))  to isValid
56341>>>>>                Set Enabled_State Of btnDelete  to (isValid=1)
56342>>>>>                Set Enabled_State Of btnSend    to (isValid=1)
56343>>>>>            
56343>>>>>                If (isValid=1) Begin
56345>>>>>                    Set Enabled_State Of frmHmnia to True
56346>>>>>                End
56346>>>>>>
56346>>>>>                Else Begin
56347>>>>>                    Set Value Of frmHmnia Item 0 to ''
56348>>>>>                    Set Enabled_State Of frmHmnia to False
56349>>>>>                End
56349>>>>>>
56349>>>>>            End_Procedure
56350>>>>>            
56350>>>>>            
56350>>>>>            
56350>>>>>            
56350>>>>>            //AB-StoreEnd
56350>>>>>
56350>>>>>        End_Object    // frmPassw
56351>>>>>
56351>>>>>        Object frmHmnia is a cSyDateForm
56353>>>>>            Set Size to 13 66
56354>>>>>            Set Location to 28 310
56355>>>>>            Set Label_Col_Offset to 2
56356>>>>>            Set Label_Justification_Mode to jMode_Right
56357>>>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
56358>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56359>>>>>        End_Object    // frmHmnia
56360>>>>>
56360>>>>>        Object btnDelete is a ButtonSub
56362>>>>>
56362>>>>>            //AB-StoreTopStart
56362>>>>>                                                
56362>>>>>            //AB-StoreTopEnd
56362>>>>>
56362>>>>>            Set Label to "€¤˜å¨œ©ž ‚â­¬¨˜ª"
56363>>>>>            Set Size to 14 94
56364>>>>>            Set Location to 26 417
56365>>>>>            Set Focus_Mode to Pointer_Only
56366>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56367>>>>>
56367>>>>>            //AB-StoreStart
56367>>>>>                                                
56367>>>>>            Procedure OnClick
56369>>>>>                Integer iID iErr iYes iInt
56370>>>>>                Date    dHmnia
56370>>>>>                String  sMess
56370>>>>>                Get Value Of frmHmnia Item 0 to dHmnia
56371>>>>>                If (dHmnia='') Begin
56373>>>>>                    Send Stop_Box '†£œ¨¦£ž¤å˜ ¡œ¤ã' '‘­á¢£˜ 5555'
56374>>>>>                    Procedure_Return
56375>>>>>                End
56375>>>>>>
56375>>>>>            
56375>>>>>                Get fisapok Of vwSap dHmnia to iInt
56376>>>>>            
56376>>>>>                // 1. Elegxos an yparxei progenesterh hmeromhnia anoixth
56376>>>>>                //If (iInt=1) Send Stop_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '‘­á¢£˜ 4001'
56376>>>>>                // 2. Elegxos an yparxei h sygkekrimenh hmeromhnia kai einai kleidomenh
56376>>>>>                //If (iInt=2) Send Stop_Box '“§á¨®œ  ã›ž ž ž£œ¨¦£ž¤å˜ ¡˜  œå¤˜  ¡¢œ ›à£â¤ž' '‘­á¢£˜ 4002'
56376>>>>>                // 3. Elegxos an yparxei epomenh hmeromhnia
56376>>>>>                If (iInt=4) Send Stop_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ©«¦ ˜¨®œå¦' '‘­á¢£˜ 4004'
56379>>>>>                // 4. Elegxos an exei trexei h prohgoumenh hmera
56379>>>>>                If (iInt=3) Send Stop_Box '¨¦¡ç§«œ  › ˜­¦¨á ž£œ¨¦£ž¤ é¤ > 1' '‘­á¢£˜ 4003'
56382>>>>>            
56382>>>>>                If (iInt<>0) Procedure_Return
56385>>>>>            
56385>>>>>                Move ('Œ˜ œ¢œ¬Ÿœ¨é©à æ¢œª « ª œšš¨˜­âª §¦¬ œ®¦¬¤ ©«˜¢œå ©«¦ ‘€ £œ ž£œ¨/¤å˜ '+String(dHmnia)+' ?') to sMess
56386>>>>>                Get YesNo_Box sMess to iYes
56387>>>>>                If (iYes=MBR_NO) Procedure_Return
56390>>>>>            
56390>>>>>                Indicate Err False
56391>>>>>                Move Error_Object_ID to iID
56392>>>>>            
56392>>>>>                Send ChangeAllFileModes DF_Filemode_ReadOnly
56393>>>>>                Set_Attribute DF_File_Mode Of tmpSap.File_Number    To DF_Filemode_Default
56396>>>>>                Set_Attribute DF_File_Mode Of Particle.File_Number  To DF_Filemode_Default
56399>>>>>                Set_Attribute DF_File_Mode Of Cmoves.File_Number    To DF_Filemode_Default
56402>>>>>                Set_Attribute DF_File_Mode Of Wcmoves.File_Number   To DF_Filemode_Default
56405>>>>>                Set_Attribute DF_File_Mode Of WitemxTr.File_Number  To DF_Filemode_Default
56408>>>>>                Set_Attribute DF_File_Mode Of ItemTehn.File_Number  To DF_Filemode_Default
56411>>>>>                Set_Attribute DF_File_Mode Of Clients.File_Number   To DF_Filemode_Default
56414>>>>>                Begin_Transaction
56415>>>>>                    Send Eleyterose_Kinhseis_Sap dHmnia
56416>>>>>                    Clear tmpSap
56417>>>>>                    Move dHmnia to tmpSap.Date
56418>>>>>                    Find Eq tmpSap By Index.1
56419>>>>>>
56419>>>>>                    If (Not(Found)) Error 5000
56422>>>>>                    Delete tmpSap
56423>>>>>                    Move (Err) to iErr
56424>>>>>                    If (iErr<>0) Error 5006
56427>>>>>                    Send Beginning_Of_Data to The_Table True
56428>>>>>                End_Transaction
56429>>>>>            
56429>>>>>                Unlock
56430>>>>>>
56430>>>>>                If (Err) Begin
56432>>>>>                    Send Stop_Box 'Ž  œšš¨˜­âª ƒ„Œ œ¢œ¬Ÿœ¨éŸž¡˜¤ ¢æšà ©­á¢£˜«¦ª' ('‘­á¢£˜ '+(String(iErr)))
56433>>>>>                End
56433>>>>>>
56433>>>>>            
56433>>>>>                Send ChangeAllFileModes DF_Filemode_Default
56434>>>>>                Move iID to  Error_Object_ID
56435>>>>>            End_Procedure // OnClick
56436>>>>>            
56436>>>>>            Procedure Eleyterose_Kinhseis_Sap Date adHmnia
56438>>>>>                Integer iID iErr inum
56439>>>>>                Date dNullHmnia
56439>>>>>                Move '01/01/1753' to dNullHmnia
56440>>>>>            
56440>>>>>                // Clients
56440>>>>>                Clear Clients
56441>>>>>                Move adHmnia to Clients.Sap_Hmnia
56442>>>>>                Find Gt Clients By index.11
56443>>>>>>
56443>>>>>                While ((Found) And (Clients.Sap_Hmnia=adHmnia))
56447>>>>>                    Set Label Of btnMess    to ('œ¢á«œª '+String(Clients.Recnum))
56448>>>>>                    Move dNullHmnia         to Clients.Sap_Hmnia
56449>>>>>                    if (clients.status = '3') move '1' to clients.status
56452>>>>>                    else if (clients.status = '2') move '' to clients.status
56456>>>>>                    Saverecord Clients
56457>>>>>                    //Unlock
56457>>>>>                    Move (Err) to iErr
56458>>>>>                    If (iErr<>0) Error 5001
56461>>>>>                    Clear Clients
56462>>>>>                    Move adHmnia            to Clients.Sap_Hmnia
56463>>>>>                    Find Gt Clients By Index.11
56464>>>>>>
56464>>>>>                Loop
56465>>>>>>
56465>>>>>            
56465>>>>>                // Particle
56465>>>>>                Clear Particle
56466>>>>>                Move adHmnia to Particle.Sap_Hmnia
56467>>>>>                Find Gt Particle By 17
56468>>>>>>
56468>>>>>                While ((Found) And (Particle.Sap_Hmnia=adHmnia))
56472>>>>>                    //Reread Particle
56472>>>>>                    Set Label Of btnMess    to ('˜¨˜©«˜« ¡á '+String(Particle.Recnum))
56473>>>>>                    Move dNullHmnia         to Particle.Sap_Hmnia
56474>>>>>                    Saverecord Particle
56475>>>>>                    //Unlock
56475>>>>>                    Move (Err) to iErr
56476>>>>>                    If (iErr<>0) Error 5001
56479>>>>>                    Clear Particle
56480>>>>>                    Move adHmnia            to Particle.Sap_Hmnia
56481>>>>>                    Find Gt Particle By 17
56482>>>>>>
56482>>>>>                Loop
56483>>>>>>
56483>>>>>            
56483>>>>>                // Cmoves
56483>>>>>                Clear Cmoves
56484>>>>>                Move adHmnia to Cmoves.Sap_Hmnia
56485>>>>>                Find Gt Cmoves By 16
56486>>>>>>
56486>>>>>                While ((Found) And (Cmoves.Sap_Hmnia=adHmnia))
56490>>>>>                    //Reread Cmoves
56490>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª œ¢˜«é¤ '+String(Cmoves.Recnum))
56491>>>>>                    Move dNullHmnia to Cmoves.Sap_Hmnia
56492>>>>>                    Saverecord Cmoves
56493>>>>>                    //Unlock
56493>>>>>                    Move (Err) to iErr
56494>>>>>                    If (iErr<>0) Error 5002
56497>>>>>                    Clear Cmoves
56498>>>>>                    Move adHmnia to Cmoves.Sap_Hmnia
56499>>>>>                    Find Gt Cmoves By 16
56500>>>>>>
56500>>>>>                Loop
56501>>>>>>
56501>>>>>            
56501>>>>>                // wcmoves
56501>>>>>                Clear wcmoves
56502>>>>>                Move adHmnia to wcmoves.Sap_Hmnia
56503>>>>>                Find Gt wcmoves By 16
56504>>>>>>
56504>>>>>                While ((Found) And (wcmoves.Sap_Hmnia=adHmnia))
56508>>>>>                    //Reread wcmoves
56508>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª €§¦Ÿž¡é¤ '+String(wcmoves.Recnum))
56509>>>>>                    Move dNullHmnia to wcmoves.Sap_Hmnia
56510>>>>>                    Saverecord wcmoves
56511>>>>>                    //Unlock
56511>>>>>                    Move (Err) to iErr
56512>>>>>                    If (iErr<>0) Error 5003
56515>>>>>                    Clear wcmoves
56516>>>>>                    Move adHmnia to wcmoves.Sap_Hmnia
56517>>>>>                    Find Gt wcmoves By 16
56518>>>>>>
56518>>>>>                Loop
56519>>>>>>
56519>>>>>            
56519>>>>>                // WitemxTr
56519>>>>>                Clear WitemxTr
56520>>>>>                Move adHmnia to WitemxTr.Sap_Hmnia
56521>>>>>                Find Gt WitemxTr By Index.4
56522>>>>>>
56522>>>>>                While ((Found) And (WitemxTr.Sap_Hmnia=adHmnia))
56526>>>>>                    //Reread WitemxTr
56526>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª ƒ ˜¡ ¤ã©œà¤ '+String(WitemxTr.Recnum))
56527>>>>>                    Move dNullHmnia to WitemxTr.Sap_Hmnia
56528>>>>>                    Saverecord WitemxTr
56529>>>>>                    //Unlock
56529>>>>>                    Move (Err) to iErr
56530>>>>>                    If (iErr<>0) Error 5004
56533>>>>>                    Clear WitemxTr
56534>>>>>                    Move adHmnia to WitemxTr.Sap_Hmnia
56535>>>>>                    Find Gt WitemxTr By Index.4
56536>>>>>>
56536>>>>>                Loop
56537>>>>>>
56537>>>>>            
56537>>>>>                // ItemTehn
56537>>>>>                Clear ItemTehn
56538>>>>>                Move adHmnia to ItemTehn.Sap_Hmnia
56539>>>>>                Find Gt ItemTehn By Index.4
56540>>>>>>
56540>>>>>                While ((Found) And (ItemTehn.Sap_Hmnia=adHmnia))
56544>>>>>                    //Reread ItemTehn
56544>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª ¨¦› ˜š¨˜­é¤ '+String(ItemTehn.Recnum))
56545>>>>>                    Move dNullHmnia to ItemTehn.Sap_Hmnia
56546>>>>>                    Saverecord ItemTehn
56547>>>>>                    //Unlock
56547>>>>>                    Move (Err) to iErr
56548>>>>>                    If (iErr<>0) Error 5005
56551>>>>>                    Clear ItemTehn
56552>>>>>                    Move adHmnia to ItemTehn.Sap_Hmnia
56553>>>>>                    Find Gt ItemTehn By Index.4
56554>>>>>>
56554>>>>>                Loop
56555>>>>>>
56555>>>>>            End_Procedure
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            
56556>>>>>            //AB-StoreEnd
56556>>>>>
56556>>>>>        End_Object    // btnDelete
56557>>>>>
56557>>>>>        Object btnSend is a ButtonSub
56559>>>>>
56559>>>>>            //AB-StoreTopStart
56559>>>>>                                                                                                                                                        
56559>>>>>            //AB-StoreTopEnd
56559>>>>>
56559>>>>>            Set Label to "€§¦©«¦¢ã €¨®œåà¤ ASCII"
56560>>>>>            Set Size to 14 94
56561>>>>>            Set Location to 52 302
56562>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56563>>>>>
56563>>>>>            //AB-StoreStart
56563>>>>>                                                                                                                                                        
56563>>>>>            Procedure OnClick
56565>>>>>                Date    dHmnia
56566>>>>>                Integer iYear iMonth iDay iYes iCount iFileExist
56566>>>>>                String  sYear sMonth sDay sHmnia sCode
56566>>>>>                String  sFile1 sFile2 sFile3 sFile4 sFile5 sFile6
56566>>>>>                // Panta 6 arxeia to onoma ton opoion apoteleitai apo 15 psifia kai einai sto C:\ (Root)
56566>>>>>                // 4 xar    Kodikos Etairias    =   Company.Company_C_Code0
56566>>>>>                // 3 xar    Kodikos Arxeiou     =   FI1 /FI2 / FI3 / MM1 / PP1 / PP2
56566>>>>>                // 4 xar    Etos                =   Data Entry Othonis = Hmeromhnia Apostolhs/Kleisimatos
56566>>>>>                // 2 xar    Mhnas               =   Data Entry Othonis = Hmeromhnia Apostolhs/Kleisimatos
56566>>>>>                // 2 xar    Hmera               =   Data Entry Othonis = Hmeromhnia Apostolhs/Kleisimatos
56566>>>>>            
56566>>>>>                // Ftiaxnoume ta onomata ton 6 arxeion pou perimenoume na vroume
56566>>>>>                Clear Company
56567>>>>>                Move SyscurXR.Company_Code to Company.Company_Code
56568>>>>>                Find Eq Company By Index.1
56569>>>>>>
56569>>>>>                If (Not(Found)) Begin
56571>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡˜¤ «˜ ©«¦ ®œå˜ «žª œ«˜ ¨å˜ª' '‘­á¢£˜ 1001'
56572>>>>>                    Procedure_Return
56573>>>>>                End
56573>>>>>>
56573>>>>>                If (Trim(Company.Company_C_Code0)='') Begin
56575>>>>>                    Send Stop_Box 'ƒœ¤ ¬§á¨®œ  ¡à› ¡æª ‘€\n©«˜ ©«¦ ®œå˜ «žª œ«˜ ¨å˜ª\n(Company.Company_C_Code0)' '‘­á¢£˜ 1002'
56576>>>>>                    Procedure_Return
56577>>>>>                End
56577>>>>>>
56577>>>>>            
56577>>>>>                Move (Trim(Company.Company_C_Code0)) to sCode
56578>>>>>                Move (Trim(sCode))  to sCode
56579>>>>>                If (Length(sCode)<>4) Begin
56581>>>>>                    Send Stop_Box 'Ž ¡à› ¡æª ‘€ ›œ¤ œå¤˜  4 ¯ã­ ¦ª\n©«˜ ©«¦ ®œå˜ «žª œ«˜ ¨å˜ª\n(Company.Company_C_Code0)' '‘­á¢£˜ 1003'
56582>>>>>                    Procedure_Return
56583>>>>>                End
56583>>>>>>
56583>>>>>            
56583>>>>>                Get Value Of frmHmnia Item 0 to dHmnia
56584>>>>>                If (dHmnia='') Begin
56586>>>>>                    Send Stop_Box 'ƒœ¤ §¢ž¡«¦¢¦šã©˜«œ ž£œ¨¦£ž¤å˜ ˜§¦©«¦¢ãª' '‘­á¢£˜ 1004'
56587>>>>>                    Procedure_Return
56588>>>>>                End
56588>>>>>>
56588>>>>>            
56588>>>>>                Clear tmpSap
56589>>>>>                Move dHmnia to tmpSap.Date
56590>>>>>                Find Eq tmpSap By Index.1
56591>>>>>>
56591>>>>>                If (Not(Found)) Begin
56593>>>>>                    Send Stop_Box '€¤ç§˜¨¡«ž ž£œ¨¦£ž¤å˜ ˜§¦©«¦¢ãª\n©«¦ §¨¦©à¨ ¤æ ˜¨®œå¦ tmpSap' '‘­á¢£˜ 1005'
56594>>>>>                    Procedure_Return
56595>>>>>                End
56595>>>>>>
56595>>>>>                If (tmpSap.Kleidomeno<>1) Begin
56597>>>>>                    Send Stop_Box '† ž£œ¨¦£ž¤å˜ §¦¬ ž«ã©˜«œ ƒ„Œ â®œ  ¡¢œ ›àŸœå.' '‘­á¢£˜ 1006'
56598>>>>>                    Procedure_Return
56599>>>>>                End
56599>>>>>>
56599>>>>>                If (tmpSap.Apestalei=1) Begin
56601>>>>>                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ §¦¬ ž«ã©˜«œ â®œ  ã›ž ˜§¦©«˜¢œå\nŒ˜ ©«˜¢œå œ¡ ¤â¦¬ ?' to iYes
56602>>>>>                    If (iYes=MBR_NO) Procedure_Return
56605>>>>>                End
56605>>>>>>
56605>>>>>                Move (TheYearSegment (dHmnia)) to iYear
56606>>>>>                Move (TheMonthSegment(dHmnia)) to iMonth
56607>>>>>                Move (TheDaySegment  (dHmnia)) to iDay
56608>>>>>                Move iYear  to sYear
56609>>>>>                Move iMonth to sMonth
56610>>>>>                Move iDay   to sDay
56611>>>>>                If (Length(iMonth)=1) Insert '0' in sMonth  at 1
56615>>>>>                If (Length(iDay  )=1) Insert '0' in sDay    at 1
56619>>>>>                Move (Trim(sMonth)) to sMonth
56620>>>>>                Move (Trim(sDay))   to sDay
56621>>>>>                If ((Length(sMonth)<>2) Or (Length(sDay)<>2)) Begin
56623>>>>>                    Send Stop_Box '¨¦¡ç§«œ  §¨æ™¢ž£˜ ©«¦¤ £ã¤˜ ã ©«ž¤ ž£â¨˜' '‘­á¢£˜ 1007'
56624>>>>>                    Procedure_Return
56625>>>>>                End
56625>>>>>>
56625>>>>>                Move ('C:\'+Trim(sCode)+'FI1'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile1
56626>>>>>                Move ('C:\'+Trim(sCode)+'FI2'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile2
56627>>>>>                Move ('C:\'+Trim(sCode)+'FI3'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile3
56628>>>>>                Move ('C:\'+Trim(sCode)+'MM1'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile4
56629>>>>>                Move ('C:\'+Trim(sCode)+'PP1'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile5
56630>>>>>                Move ('C:\'+Trim(sCode)+'PP2'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile6
56631>>>>>            
56631>>>>>                Get Get_File_Exists sFile1 to iFileExist
56632>>>>>                If (Not(iFileExist)) Begin
56634>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ FI1' '‘­á¢£˜ 1008'
56635>>>>>                    Procedure_Return
56636>>>>>                End
56636>>>>>>
56636>>>>>                Get Get_File_Exists sFile2 to iFileExist
56637>>>>>                If (Not(iFileExist)) Begin
56639>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ FI2' '‘­á¢£˜ 1009'
56640>>>>>                    Procedure_Return
56641>>>>>                End
56641>>>>>>
56641>>>>>                Get Get_File_Exists sFile3 to iFileExist
56642>>>>>                If (Not(iFileExist)) Begin
56644>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ FI3' '‘­á¢£˜ 1010'
56645>>>>>                    Procedure_Return
56646>>>>>                End
56646>>>>>>
56646>>>>>                Get Get_File_Exists sFile4 to iFileExist
56647>>>>>                If (Not(iFileExist)) Begin
56649>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ MM1' '‘­á¢£˜ 1011'
56650>>>>>                    Procedure_Return
56651>>>>>                End
56651>>>>>>
56651>>>>>                Get Get_File_Exists sFile5 to iFileExist
56652>>>>>                If (Not(iFileExist)) Begin
56654>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ PP1' '‘­á¢£˜ 1012'
56655>>>>>                    Procedure_Return
56656>>>>>                End
56656>>>>>>
56656>>>>>                Get Get_File_Exists sFile6 to iFileExist
56657>>>>>                If (Not(iFileExist)) Begin
56659>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ PP2' '‘­á¢£˜ 1013'
56660>>>>>                    Procedure_Return
56661>>>>>                End
56661>>>>>>
56661>>>>>            
56661>>>>>                Send Info_Box 'ALL FILES OK' 'INFO'
56662>>>>>            
56662>>>>>            
56662>>>>>            End_Procedure // OnClick
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            //Object TimerObj Is A DFTimer
56663>>>>>            
56663>>>>>            //    Property Integer piForesCount   Public  0
56663>>>>>            //    Property String  psRemFile   Public ''
56663>>>>>            //    Property String  psLocFile    Public ''
56663>>>>>            
56663>>>>>            //    Set Auto_Start_State    to False
56663>>>>>            //    Set Auto_Stop_State     to False
56663>>>>>            
56663>>>>>            //    Procedure OnTimer
56663>>>>>            //        Integer iCount rVal
56663>>>>>            //        Get piForesCount to iCount
56663>>>>>            //        // Anamonh gia arxeio epibebaioshs
56663>>>>>            //        send AddInfo to (oStatusForm (Self)) ("œ¨ £â¤à ¢ã¯ž ˜¨®œå¦¬ "*(Trim(psRemFile(Self)))-"...")
56663>>>>>            //        Increment iCount
56663>>>>>            //        Get fiGetFile Of FtpView (psRemFile(Self)) (psLocFile(Self)) 0 1 to rVal
56663>>>>>            //        If (Not(rVal)) Begin
56663>>>>>            //            Set piFileRetreived to 1
56663>>>>>            //            Send Stop_Timer
56663>>>>>            //        End
56663>>>>>            //        Set piForesCount to iCount
56663>>>>>            //        If (iCount>(piFtpTimesExit(Self))) Send Stop_Timer
56663>>>>>            //    End_Procedure
56663>>>>>            
56663>>>>>            //End_Object
56663>>>>>            
56663>>>>>            //Procedure Start_Timer String asRemoteFile String asLocalFile
56663>>>>>            //    Set piFileRetreived                         to 0
56663>>>>>            //    Set piForesCount        of (TimerObj(Self)) to 0
56663>>>>>            //    Set psRemFile           of (TimerObj(Self)) to (Trim(asRemoteFile))
56663>>>>>            //    Set psLocFile           of (TimerObj(Self)) to (Trim(asLocalFile))
56663>>>>>            //    Set Timeout             of (TimerObj(Self)) to (piFtpSecondsRetry(Self)*1000)
56663>>>>>            //    Set Timer_Active_State  of (TimerObj(Self)) to True // Starts timer
56663>>>>>            //End_Procedure
56663>>>>>            
56663>>>>>            
56663>>>>>            //Procedure Stop_Timer
56663>>>>>            //    Integer iFileRetreived iMetr iRecnum iStat
56663>>>>>            //    String  sFile
56663>>>>>            //    Date    dHmnia dHmnia2
56663>>>>>            
56663>>>>>            //    Get Value Of frmHmnia Item 0 to dHmnia2
56663>>>>>            //    Set Timer_Active_State of (TimerObj(Self)) to False // Stops Timer
56663>>>>>            //    // Check property set by timer if zrok.txt is received
56663>>>>>            
56663>>>>>            //    Get fiCloseDialup   to iStat
56663>>>>>            
56663>>>>>            //    Get piFileRetreived to iFileRetreived
56663>>>>>            
56663>>>>>            //    If (Not(iFileRetreived)) Begin
56663>>>>>            //        Send Info_Box 'ƒœ¤ œ¢ã­Ÿœ  «¦ ˜¨®œå¦ œ§ ™œ™˜åà©žª' '¢ž¨¦­¦¨å˜'
56663>>>>>            //        Procedure_Return
56663>>>>>            //    End
56663>>>>>            //    Get psLocFile Of TimerObj   to sFile
56663>>>>>            //    Move (Trim(sFile))          to sFile
56663>>>>>            //    send AddInfo to (oStatusForm (Self)) ("’¦ ˜¨®œå¦ œ¢ã­Ÿœ  - "*sFile-" - ...")
56663>>>>>            //    // Read zrok.txt and flag Hmerprog for all recnums
56663>>>>>            //    // in zrok.txt that records were correctly sent
56663>>>>>            //    Direct_Input Channel 9 sFile
56663>>>>>            //    Move 0 to iMetr
56663>>>>>            //    Readln Channel 9 dHmnia
56663>>>>>            //    If (Seqeof) Begin
56663>>>>>            //        Send Info_Box '’¦ ˜¨®œå¦ zrok.txt ›œ¤ ¬§á¨®œ  ã œå¤˜  á›œ ¦' '¢ž¨¦­¦¨å˜'
56663>>>>>            //        Procedure_Return
56663>>>>>            //    End
56663>>>>>            
56663>>>>>            //    If (dHmnia=dHmnia2) Begin
56663>>>>>            
56663>>>>>            //        Send Info_Box '† ˜§¦©«¦¢ã ¡˜  ž ¢ã¯ž ¦¢¦¡¢ž¨éŸž¡˜¤' '¢ž¨¦­¦¨å˜'
56663>>>>>            //    End
56663>>>>>            
56663>>>>>            //    Send Delete_Data    to oStatusForm
56663>>>>>            //    Set Value of frmMessage Item 0 to ''
56663>>>>>            //    Send Paint          to oStatusForm
56663>>>>>            //    Send KeyAction to btn_Select
56663>>>>>            //End_Procedure
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            ////    Integer isOK rVal iMetr iRecnum iFileRetreived isAvailable iStat
56663>>>>>            ////    String  sFtp sUser sPassword sDir sConnectString sConnectCommand
56663>>>>>            ////    String  sBranchSendPathFiles sBranchSendPathConf sLocalFile sRemoteFile
56663>>>>>            ////    String  sSysfileFilesSendPath sFullFileName sFileName sStr
56663>>>>>            ////    Integer isConnected iSelectCount iInt iSelRec iErr iClientId iObj
56663>>>>>            
56663>>>>>            ////    Set Value of frmMessage Item 0 to ''
56663>>>>>            ////    Send Delete_Data    to oStatusForm
56663>>>>>            ////    Send Paint          to oStatusForm
56663>>>>>            
56663>>>>>            ////    Clear Branch
56663>>>>>            ////    Move Syscurxr.Company_Code      to Branch.Company_Code
56663>>>>>            ////    Move Syscurxr.Branch_Code       to Branch.Branch_Code
56663>>>>>            ////    Find Eq Branch By Index.1
56663>>>>>            
56663>>>>>            ////    Move Branch.SEND_PATH_FILES     to sBranchSendPathFiles
56663>>>>>            ////    Move Branch.SEND_PATH_CONF      to sBranchSendPathConf
56663>>>>>            ////    Move Sysfile.FILES_SEND_PATH    to sSysfileFilesSendPath
56663>>>>>            
56663>>>>>            ////    Get Value Of frmAddress     to sFtp
56663>>>>>            ////    Get Value Of frmUserName    to sUser
56663>>>>>            ////    Get Value Of frmPassword    to sPassword
56663>>>>>            ////    Get Value Of frmDirectory   to sDir
56663>>>>>            
56663>>>>>            ////    Move (Trim(sFtp))           to sFtp
56663>>>>>            ////    Move (Trim(sUser))          to sUser
56663>>>>>            ////    Move (Trim(sPassword))      to sPassword
56663>>>>>            ////    Move (Trim(sDir))           to sDir
56663>>>>>            
56663>>>>>            ////    Move sSysfileFilesSendPath  to sLocalFile
56663>>>>>            ////    Move (Trim(sLocalFile))     to sLocalFile
56663>>>>>            ////    Append sLocalFile 'zsok.txt'
56663>>>>>            ////    Move (Trim(sLocalFile)) to sLocalFile
56663>>>>>            ////    EraseFile sLocalFile
56663>>>>>            
56663>>>>>            ////    Move sSysfileFilesSendPath  to sLocalFile
56663>>>>>            ////    Move (Trim(sLocalFile))     to sLocalFile
56663>>>>>            ////    Append sLocalFile 'zsendd.txt'
56663>>>>>            ////    EraseFile sLocalFile
56663>>>>>            
56663>>>>>            ////    Move sSysfileFilesSendPath  to sLocalFile
56663>>>>>            ////    Move (Trim(sLocalFile))     to sLocalFile
56663>>>>>            ////    Append sLocalFile 'zbtnemp.txt'
56663>>>>>            ////    EraseFile sLocalFile
56663>>>>>            
56663>>>>>            ////    EraseFile 'C:\Welcome.txt'
56663>>>>>            ////    Send Delete_Data    to oStatusForm
56663>>>>>            ////    Set Value of frmMessage Item 0 to ''
56663>>>>>            
56663>>>>>            ////    Get fiFTPVerify to isOK
56663>>>>>            
56663>>>>>            ////    If (isOK=1) Begin
56663>>>>>            
56663>>>>>            //////////////////////////////////////////////////////////////////////
56663>>>>>            ////        If (psBranchPhone(self)<>'') Begin
56663>>>>>            
56663>>>>>            ////           set bConnectionStatus to FALSE
56663>>>>>            
56663>>>>>            ////           //first get the connect state of the local system
56663>>>>>            ////           move (dvInternetGetConnectedState()) to iStat
56663>>>>>            
56663>>>>>            //////           if iStat eq 1 begin
56663>>>>>            //////              send Info_Box "You have already a connection to the Internet by modem." "dvdialer"
56663>>>>>            //////              procedure_return
56663>>>>>            //////           end
56663>>>>>            //////           if iStat eq 2 begin
56663>>>>>            //////              send Info_Box "You are connected to the Internet by a LAN." "dvdialer"
56663>>>>>            //////              procedure_return
56663>>>>>            //////           end
56663>>>>>            //////           if iStat eq 3 begin
56663>>>>>            //////              send Info_Box "You are connected to the Internet by a through a proxy server." "dvdialer"
56663>>>>>            //////              procedure_return
56663>>>>>            //////           end
56663>>>>>            
56663>>>>>            ////           if iStat eq 4 begin
56663>>>>>            ////              send Info_Box "’¦ modem œå¤˜  ˜§˜©®¦¢ž£â¤¦." "¢ž¨¦­¦¨å˜"
56663>>>>>            ////              procedure_return
56663>>>>>            ////           end
56663>>>>>            
56663>>>>>            ////           If iStat eq 0 begin
56663>>>>>            ////              // there is no Internet connection and the modem is not busy, so let's dial...
56663>>>>>            ////              // phonebook entry this would be something like this
56663>>>>>            ////              // move (dvInternetAutodial()) to iStat
56663>>>>>            ////              move (dvInternetDial((psBranchPhone(self)))) to iStat
56663>>>>>            
56663>>>>>            ////              If iStat eq 0 set bConnectionStatus to True
56663>>>>>            ////              Else Begin
56663>>>>>            ////                 Send Info_Box "† ©ç¤›œ©ž ›œ¤ £§¦¨œå ¤˜ ¦¢¦¡¢ž¨àŸœå" "¢ž¨¦­¦¨å˜"
56663>>>>>            ////                 Procedure_Return
56663>>>>>            ////              End
56663>>>>>            ////           End
56663>>>>>            
56663>>>>>            ///////////////////////
56663>>>>>            //////            Send OpenDialUp Of MyRas
56663>>>>>            //////            Get RasXComRASAvailable Of MyRas to isAvailable
56663>>>>>            //////            Get RasXComStateString  Of MyRas to sStr
56663>>>>>            //////            Pause 24 00 '*' (Trim(sStr)) '*'
56663>>>>>            //////            If (Not(isAvailable)) Begin
56663>>>>>            //////                Send Stop_Box 'Ras Connection Not Available'
56663>>>>>            //////                Procedure_Return
56663>>>>>            //////            End
56663>>>>>            ///////////////////////
56663>>>>>            ////        End
56663>>>>>            //////////////////////////////////////////////////////////////////////
56663>>>>>            
56663>>>>>            
56663>>>>>            //////        Get piErrorOccured to iErr
56663>>>>>            //////        If (iErr) Begin
56663>>>>>            //////            If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
56663>>>>>            //////            Procedure_Return
56663>>>>>            //////        End
56663>>>>>            ////        //Send OpenDialUp                 Of MyRas
56663>>>>>            ////        //Send RasXComConnect             Of MyRas
56663>>>>>            
56663>>>>>            ////        Move '' to sConnectCommand
56663>>>>>            ////        Move '' to sConnectString
56663>>>>>            
56663>>>>>            ////        send AddInfo to (oStatusForm (Self)) ("‘ç¤›œ©ž "*sFtp-"...")
56663>>>>>            
56663>>>>>            ////        // Connect to ftp site
56663>>>>>            ////        if (trim(sFtp)<>'') begin
56663>>>>>            ////            if ( sUser<>"") begin
56663>>>>>            ////               Move (dvInternetConnect(sFtp,sUser,sPassword,0)) to rVal
56663>>>>>            ////            end
56663>>>>>            ////            else move (dvInternetConnect(sFtp,"","",0)) to rVal //anonymous login
56663>>>>>            ////        end
56663>>>>>            ////        if rVal begin
56663>>>>>            ////            send ShowInternetErrorMessage rVal
56663>>>>>            ////            Get fiCloseDialup to iStat
56663>>>>>            ////            procedure_return
56663>>>>>            ////        end
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            ////        Move 'Welcome.txt'      to sRemoteFile
56663>>>>>            ////        Move 'C:\Welcome.txt'   to sLocalFile
56663>>>>>            ////        Get fiGetFile Of FtpView sRemoteFile sLocalFile 0 1 to rVal
56663>>>>>            ////        If (rVal) Begin
56663>>>>>            ////            Send ShowInternetErrorMessage rVal
56663>>>>>            ////            Get fiCloseDialup to iStat
56663>>>>>            ////            //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
56663>>>>>            ////            //Send RasXComDisConnect Of MyRas
56663>>>>>            ////            Procedure_Return
56663>>>>>            ////        End
56663>>>>>            
56663>>>>>            ////        Direct_Input    Channel 9 sLocalFile
56663>>>>>            ////        Readln          Channel 9 sStr
56663>>>>>            ////        Close_Input     Channel 9
56663>>>>>            ////        Set Value of frmMessage Item 0 to (Trim(sStr))
56663>>>>>            
56663>>>>>            ////        Move 0 to iInt
56663>>>>>            ////        Move 0 to iSelectCount
56663>>>>>            ////        Clear TmpSel
56663>>>>>            ////        Move '1' to TmpSel.Is_Selected
56663>>>>>            ////        Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
56663>>>>>            ////        While ((Found=1) And (TmpSel.Is_Selected='1'))
56663>>>>>            ////            Add 1 to iSelectCount
56663>>>>>            ////            Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
56663>>>>>            ////        Loop
56663>>>>>            
56663>>>>>            ////        If (iSelectCount>0) Begin
56663>>>>>            ////            Clear TmpSel
56663>>>>>            ////            Move '1' to TmpSel.Is_Selected
56663>>>>>            ////            Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
56663>>>>>            ////            While ((Found=1) And (TmpSel.Is_Selected='1'))
56663>>>>>            ////                Move (Trim(TmpSel.Full_Path_Name))                  to sFullFileName
56663>>>>>            ////                Move (Trim(fsReturnFileFromPath(sFullFileName)))    to sFileName
56663>>>>>            ////                Move sFullFileName  to sLocalFile
56663>>>>>            ////                Move sFileName      to sRemoteFile
56663>>>>>            //////                Insert '/' in sRemoteFile   at 1
56663>>>>>            ////                Insert sDir in sRemoteFile  at 1
56663>>>>>            ////                Get fiSendFile Of FtpView sLocalFile sRemoteFile 1 to rVal
56663>>>>>            ////                If (rVal) Begin
56663>>>>>            ////                    Send ShowInternetErrorMessage rVal
56663>>>>>            ////                    Get fiCloseDialup to iStat
56663>>>>>            ////                    //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
56663>>>>>            ////                    //Send RasXComDisConnect Of MyRas
56663>>>>>            ////                    Procedure_Return
56663>>>>>            ////                End
56663>>>>>            ////                Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
56663>>>>>            ////            Loop
56663>>>>>            
56663>>>>>            ////            // Prepare zsok.txt filename
56663>>>>>            ////            Move sSysfileFilesSendPath                  to sLocalFile
56663>>>>>            ////            Move (Trim(sLocalFile))                     to sLocalFile
56663>>>>>            ////            Append sLocalFile 'zsok.txt'
56663>>>>>            ////            Move (Trim(sLocalFile))                     to sLocalFile
56663>>>>>            
56663>>>>>            ////            Move (Trim(sBranchSendPathConf)+'zsok.txt') to sRemoteFile
56663>>>>>            
56663>>>>>            ////            // Create zsok.txt file
56663>>>>>            ////            Direct_Output   Channel 9 sLocalFile
56663>>>>>            ////            Write           Channel 9 '1234'
56663>>>>>            ////            Writeln         Channel 9
56663>>>>>            ////            Close_Output    Channel 9
56663>>>>>            
56663>>>>>            ////            // Send zsok.txt file
56663>>>>>            ////            Get fiSendFile Of FtpView sLocalFile sRemoteFile 1 to rVal
56663>>>>>            ////            If (rVal) Begin
56663>>>>>            ////                Send ShowInternetErrorMessage rVal
56663>>>>>            ////                Get fiCloseDialup to iStat
56663>>>>>            ////                //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
56663>>>>>            ////                //Send RasXComDisConnect Of MyRas
56663>>>>>            ////                Procedure_Return
56663>>>>>            ////            End
56663>>>>>            
56663>>>>>            ////            // Prepare zrok.txt filename
56663>>>>>            ////            Move (Trim(sSysfileFilesSendPath))  to sLocalFile
56663>>>>>            ////            Append sLocalFile 'zrok.txt'
56663>>>>>            ////            Move (Trim(sBranchSendPathConf)+'zrok.txt') to sRemoteFile
56663>>>>>            
56663>>>>>            ////            // Delete previous local zrok.txt
56663>>>>>            ////            EraseFile sLocalFile
56663>>>>>            
56663>>>>>            ////            // Call timer event to bring zrok.txt file
56663>>>>>            ////            // Program flow control continues in Stop_Timer
56663>>>>>            ////            Send Start_Timer sRemoteFile sLocalFile
56663>>>>>            
56663>>>>>            ////        End
56663>>>>>            ////        Else Begin
56663>>>>>            ////            Send Info_Box 'ƒœ¤ ™¨âŸž¡œ ˜¨®œå¦ §¨¦ª ˜§¦©«¦¢ã'
56663>>>>>            ////            Get fiCloseDialup to iStat
56663>>>>>            ////            //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
56663>>>>>            ////            //Send RasXComDisConnect Of MyRas
56663>>>>>            ////            Procedure_Return
56663>>>>>            ////        End
56663>>>>>            ////    End
56663>>>>>            ////    Else Begin
56663>>>>>            ////        If (isOK=(-1)) Begin
56663>>>>>            ////            Send Info_Box "ƒœ¤ ™¨âŸž¡œ ¡á§¦ ˜ œ§ ¢œš£â¤ž œšš¨˜­ã"
56663>>>>>            ////        End
56663>>>>>            ////        Else If (sFtp='') Begin
56663>>>>>            ////            Send Info_Box "FTP Address field is empty"
56663>>>>>            ////            Send Activate to frmAddress
56663>>>>>            ////        End
56663>>>>>            ////        Else If (sUser='') Begin
56663>>>>>            ////            Send Info_Box "User field is empty"
56663>>>>>            ////            Send Activate to frmUserName
56663>>>>>            ////        End
56663>>>>>            ////        Else If (sPassword='') Begin
56663>>>>>            ////            Send Info_Box "Password field is empty"
56663>>>>>            ////            Send Activate to frmPassword
56663>>>>>            ////        End
56663>>>>>            ////        Else If (sDir='') Begin
56663>>>>>            ////            Send Info_Box "Directory field is empty"
56663>>>>>            ////            Send Activate to frmDirectory
56663>>>>>            ////        End
56663>>>>>            ////    End
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            
56663>>>>>            //AB-StoreEnd
56663>>>>>
56663>>>>>        End_Object    // btnSend
56664>>>>>
56664>>>>>        Object TextBoxSub1 is a TextBoxSub
56666>>>>>            Set Label to "‰à› ¡æª „¤œ¨š¦§¦åž©žª ƒ ˜› ¡˜©å˜ª €§¦©«¦¢ãª && €¤˜å¨œ©žª"
56667>>>>>            Set TextColor to 2577645
56668>>>>>            Set Location to 2 200
56669>>>>>            Set Size to 25 84
56670>>>>>            Set FontWeight to 600
56671>>>>>            Set Justification_Mode to jMode_Left
56672>>>>>            Set TypeFace to "MS Sans Serif"
56673>>>>>        End_Object    // TextBoxSub1
56674>>>>>
56674>>>>>        Object The_Table is a dbGrid
56676>>>>>
56676>>>>>            //AB-StoreTopStart
56676>>>>>                                                        
56676>>>>>            //AB-StoreTopEnd
56676>>>>>
56676>>>>>            Set Main_File to Tmpsap.File_Number
56677>>>>>            Set Ordering to 1
56678>>>>>            Set Size to 258 188
56679>>>>>            Set Location to 2 6
56680>>>>>            Set Wrap_State to TRUE
56681>>>>>
56681>>>>>            Begin_Row
56684>>>>>                Entry_Item Tmpsap.Kleidomeno
56685>>>>>                Entry_Item Tmpsap.Date
56686>>>>>                Entry_Item Tmpsap.Apestalei
56687>>>>>            End_Row
56692>>>>>
56692>>>>>            Set Form_Width    item 0 to 56
56693>>>>>            Set Header_Label  item 0 to "K¢œ ›à£â¤ž"
56694>>>>>            Set Column_Checkbox_State  item 0 to True
56695>>>>>            
56695>>>>>            Set Form_Width    item 1 to 78
56696>>>>>            Set Header_Label  item 1 to "†£/¤å˜ „šš¨˜­é¤"
56697>>>>>            
56697>>>>>            Set Form_Width    item 2 to 48
56698>>>>>            Set Header_Label  item 2 to "€§¦©«¦¢ã"
56699>>>>>            Set Column_Checkbox_State  item 2 to True
56700>>>>>            
56700>>>>>
56700>>>>>            //AB-StoreStart
56700>>>>>                                                        
56700>>>>>            Set Column_Option Item 0 to NoEnter True
56701>>>>>            Set Column_Option Item 1 to NoPut   True
56702>>>>>            //Set Column_Option Item 2 to NoEnter True
56702>>>>>            
56702>>>>>            //Procedure Item_Change Integer FromI Integer ToI Returns Integer
56702>>>>>            //    Integer iCol rVal isValid
56702>>>>>            //    Date    dHmnia
56702>>>>>            //    Forward Get Msg_Item_Change Fromi toi to rVal
56702>>>>>            //    If (Current_Record(tmpSap_DD(Self))) Begin
56702>>>>>            //        Get Field_Current_Value Of tmpSap_DD Field tmpSap.Date to dHmnia
56702>>>>>            //        If (Validate_Password(vwSap(Self))=1)   Set Value Of frmHmnia Item 0 to dHmnia
56702>>>>>            //        Else                                    Set Value Of frmHmnia Item 0 to ''
56702>>>>>            //    End
56702>>>>>            //    Else Set Value Of frmHmnia Item 0 to ''
56702>>>>>            //    Procedure_return rVal
56702>>>>>            //End_Procedure
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            
56702>>>>>            //AB-StoreEnd
56702>>>>>
56702>>>>>        End_Object    // The_Table
56703>>>>>
56703>>>>>        Object btnMess is a ButtonSub
56705>>>>>            Set Size to 14 311
56706>>>>>            Set Location to 246 201
56707>>>>>            Set Border_Style to Border_StaticEdge
56708>>>>>            Set Focus_Mode to No_Activate
56709>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56710>>>>>
56710>>>>>            //AB-StoreStart
56710>>>>>            Procedure OnClick
56712>>>>>            
56712>>>>>            End_Procedure // OnClick
56713>>>>>            //AB-StoreEnd
56713>>>>>
56713>>>>>        End_Object    // btnMess
56714>>>>>
56714>>>>>        Object TextBoxSub2 is a TextBoxSub
56716>>>>>            Set Label to "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª „šš¨˜­é¤ ‘€"
56717>>>>>            Set TextColor to 10056008
56718>>>>>            Set Location to 10 311
56719>>>>>            Set Size to 17 75
56720>>>>>            Set FontWeight to 600
56721>>>>>            Set Justification_Mode to jMode_Left
56722>>>>>            Set TypeFace to "MS Sans Serif"
56723>>>>>        End_Object    // TextBoxSub2
56724>>>>>
56724>>>>>        Object frmAddress is a FormSub
56726>>>>>            Set Size to 13 98
56727>>>>>            Set Location to 70 201
56728>>>>>            Set Label_Col_Offset to 10
56729>>>>>            Set Label_Justification_Mode to jMode_Right
56730>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56731>>>>>
56731>>>>>            //AB-StoreStart
56731>>>>>                                                                                                                                                                                                                                
56731>>>>>            //AB-StoreEnd
56731>>>>>
56731>>>>>        End_Object    // frmAddress
56732>>>>>
56732>>>>>        Object frmConn is a FormSub
56734>>>>>            Set Size to 13 98
56735>>>>>            Set Location to 70 297
56736>>>>>            Set Label_Col_Offset to 10
56737>>>>>            Set Label_Justification_Mode to jMode_Right
56738>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56739>>>>>
56739>>>>>            //AB-StoreStart
56739>>>>>                                                                                                                                                                                                                                
56739>>>>>            Procedure OnChange
56741>>>>>                String sStr
56742>>>>>                Get Value Item 0 to sStr
56743>>>>>                Set psBranchPhone to (Trim(sStr))
56744>>>>>            End_Procedure
56745>>>>>            
56745>>>>>            //AB-StoreEnd
56745>>>>>
56745>>>>>        End_Object    // frmConn
56746>>>>>
56746>>>>>        Object frmUserName is a FormSub
56748>>>>>            Set Size to 13 195
56749>>>>>            Set Location to 84 201
56750>>>>>            Set Label_Col_Offset to 10
56751>>>>>            Set Label_Justification_Mode to jMode_Right
56752>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56753>>>>>        End_Object    // frmUserName
56754>>>>>
56754>>>>>        Object frmPassword is a FormSub
56756>>>>>            Set Size to 13 195
56757>>>>>            Set Location to 98 201
56758>>>>>            Set Label_Col_Offset to 10
56759>>>>>            Set Label_Justification_Mode to jMode_Right
56760>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56761>>>>>            Set Password_State Item 0 to TRUE
56762>>>>>
56762>>>>>            //AB-StoreStart
56762>>>>>                                                                                                                                                                                                                                
56762>>>>>            Set Password_State to True
56763>>>>>            
56763>>>>>            //AB-StoreEnd
56763>>>>>
56763>>>>>        End_Object    // frmPassword
56764>>>>>
56764>>>>>        Object frmDirectory is a FormSub
56766>>>>>            Set Size to 13 195
56767>>>>>            Set Location to 113 201
56768>>>>>            Set Label_Col_Offset to 10
56769>>>>>            Set Label_Justification_Mode to jMode_Right
56770>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56771>>>>>        End_Object    // frmDirectory
56772>>>>>
56772>>>>>        Object TextBoxSub3 is a TextBoxSub
56774>>>>>            Set Label to "ƒ œçŸ¬¤©ž FTP"
56775>>>>>            Set Location to 56 201
56776>>>>>            Set Size to 10 55
56777>>>>>            Set TypeFace to "MS Sans Serif"
56778>>>>>        End_Object    // TextBoxSub3
56779>>>>>
56779>>>>>        Object TextBoxSub4 is a TextBoxSub
56781>>>>>            Set Label to "‘ç¤›œ©ž ©«¦¤ ¬§¦¢¦š ©«ã"
56782>>>>>            Set Location to 201 201
56783>>>>>            Set Size to 10 94
56784>>>>>            Set TypeFace to "MS Sans Serif"
56785>>>>>        End_Object    // TextBoxSub4
56786>>>>>
56786>>>>>        Object frmMessage is a FormSub
56788>>>>>            Set Size to 13 311
56789>>>>>            Set Location to 213 201
56790>>>>>            Set Color to clBtnFace
56791>>>>>            Set Label_Col_Offset to 2
56792>>>>>            Set Enabled_State to FALSE
56793>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
56794>>>>>            Set Item_Shadow_State Item 0 to TRUE
56795>>>>>            Set Shadow_State Item 0 to TRUE
56796>>>>>        End_Object    // frmMessage
56797>>>>>
56797>>>>>        Object oStatusForm is a editSub
56799>>>>>            Set Size to 61 311
56800>>>>>            Set Location to 130 201
56801>>>>>            Set Color to clBtnFace
56802>>>>>            Set Enabled_State to FALSE
56803>>>>>            Set Read_Only_State to TRUE
56804>>>>>
56804>>>>>            //AB-StoreStart
56804>>>>>                                                                                                                                                                                                                                
56804>>>>>            Procedure AddInfo string sInfo
56806>>>>>                Send beginning_of_data
56807>>>>>                append sInfo (character(13)+character(10))
56808>>>>>                send insert sInfo
56809>>>>>                send paint
56810>>>>>            End_Procedure
56811>>>>>            
56811>>>>>            
56811>>>>>            //AB-StoreEnd
56811>>>>>
56811>>>>>        End_Object    // oStatusForm
56812>>>>>
56812>>>>>
56812>>>>>        //AB-StoreStart
56812>>>>>            
56812>>>>>            
56812>>>>>        Function fisapok Date adHmnia Returns Integer
56814>>>>>            Integer iDay iDiff
56815>>>>>            // Kaleitai kata thn fash mazematos ton eggrafon, prin ftiaxtoun ta ascii arxeia
56815>>>>>            // Den yparxei eggrafh gia thn hmeromhnia ayth sto tmpSap arxeio
56815>>>>>        
56815>>>>>        //    // 1. Elegxos an yparxei progenesterh hmeromhnia anoixth
56815>>>>>        //    Clear tmpSap
56815>>>>>        //    Find GT tmpSap By Index.4
56815>>>>>        //    If ((Found) And (tmpSap.Kleidomeno=0) And (tmpSap.Date<adHmnia)) Function_Return 1
56815>>>>>        
56815>>>>>        //    // 2. Elegxos an yparxei h sygkekrimenh hmeromhnia kai einai kleidomenh
56815>>>>>        //    Clear tmpSap
56815>>>>>        //    Move adHmnia to tmpSap.Date
56815>>>>>        //    Find Eq tmpSap By Index.1
56815>>>>>        //    If ((Found) And (tmpSap.Kleidomeno=1)) Function_Return 2
56815>>>>>        
56815>>>>>            // 3. Elegxos an yparxei epomenh hmeromhnia
56815>>>>>            Clear tmpSap
56816>>>>>            Move adHmnia to tmpSap.Date
56817>>>>>            Find Gt tmpSap By Index.1
56818>>>>>>
56818>>>>>            If (Found) Function_Return 4
56821>>>>>        
56821>>>>>            // 4. Elegxos an exei trexei h prohgoumenh hmera
56821>>>>>            Clear tmpSap
56822>>>>>            Move adHmnia to tmpSap.Date
56823>>>>>            Find LT tmpSap By Index.1
56824>>>>>>
56824>>>>>            If (Found) Begin
56826>>>>>                If ((adHmnia-tmpSap.Date) <>1) Function_Return 3
56829>>>>>            End
56829>>>>>>
56829>>>>>        
56829>>>>>            Function_Return 0
56830>>>>>        End_Function
56831>>>>>        
56831>>>>>        Procedure Deixe_Ta_Anoixta
56833>>>>>            Integer liLathi
56834>>>>>            Set piLathi to 0
56835>>>>>            send Delete_Data to (EditSub1(Keimeno(Self)))
56836>>>>>            send read to (EditSub1(Keimeno(Self))) "C:\OpenSap.log"
56837>>>>>            Send popup to (Keimeno(Self))
56838>>>>>        End_Procedure
56839>>>>>        
56839>>>>>        Procedure Activate_View Returns Integer
56841>>>>>            Integer rVal iCount
56842>>>>>            String  sMess
56842>>>>>            Move '' to sMess
56843>>>>>            Forward Get Msg_Activate_View to rVal
56845>>>>>            Set Value Of frmPassw   Item 0  to ''
56846>>>>>            Set Value Of frmHmnia   Item 0  to ''
56847>>>>>            Set Label Of btnMess            to ''
56848>>>>>            Set piLathi             to 0
56849>>>>>            Move 0 to iCount
56850>>>>>            Direct_Output Channel 7 "C:\OpenSap.log"
56852>>>>>            Writeln Channel 7 '---------------------------------------------------------'
56855>>>>>            Writeln Channel 7 'Ž‘Ž•† - €¤¦ ®«âª †£œ¨¦£ž¤åœª'
56858>>>>>            Writeln Channel 7 '---------------------------------------------------------'
56861>>>>>            Writeln Channel 7 '                              '
56864>>>>>            Clear tmpSap
56865>>>>>            Move 0 to tmpSap.Kleidomeno
56866>>>>>            Find GT tmpSap By index.4
56867>>>>>>
56867>>>>>            While ((Found) And (tmpSap.Kleidomeno=0))
56871>>>>>                Add 1 to iCount
56872>>>>>                Writeln Channel 7 tmpSap.Date
56875>>>>>                Find GT tmpSap By index.4
56876>>>>>>
56876>>>>>            Loop
56877>>>>>>
56877>>>>>            Close_Output Channel 7
56879>>>>>        
56879>>>>>            If (iCount<>0) Send Deixe_Ta_Anoixta
56882>>>>>            Else EraseFile "C:\OpenSap.log"
56884>>>>>        
56884>>>>>            Procedure_Return rVal
56885>>>>>        End_Procedure
56886>>>>>        
56886>>>>>        
56886>>>>>        Function Validate_Password Returns Integer
56888>>>>>            String sPassw
56889>>>>>            Get Value Of frmPassw Item 0 to sPassw
56890>>>>>            Set Enabled_State Of btnDelete  to (Trim(Uppercase(sPassw))='PROTEM PIS')
56891>>>>>            Set Enabled_State Of btnSend    to (Trim(Uppercase(sPassw))='PROTEM PIS')
56892>>>>>            If (Trim(Uppercase(sPassw))='PROTEM PIS') Begin
56894>>>>>                Set Enabled_State Of frmHmnia to True
56895>>>>>                Function_Return 1
56896>>>>>            End
56896>>>>>>
56896>>>>>            Else Begin
56897>>>>>                Set Value Of frmHmnia Item 0 to ''
56898>>>>>                Set Enabled_State Of frmHmnia to False
56899>>>>>                Function_Return 0
56900>>>>>            End
56900>>>>>>
56900>>>>>        End_Function
56901>>>>>        
56901>>>>>        
56901>>>>>        
56901>>>>>        //AB-StoreEnd
56901>>>>>
56901>>>>>    End_Object    // Vwsap
56902>>>>>
56902>>>>>
56902>>>>>    //AB-StoreStart
56902>>>>>                        
56902>>>>>                        
56902>>>>>                        
56902>>>>>                        
56902>>>>>                        
56902>>>>>    //AB-StoreEnd
56902>>>>>
56902>>>>>//AB/     End_Object    // prj
56902>>>    Open    Tmpsap
56904>>>    Open    Tmpaxio
INCLUDING FILE: TMPAXIO.FD
56906>>>    Open    Tmppol
INCLUDING FILE: TMPPOL.FD
56908>>>    Open    Tmpapoth
INCLUDING FILE: TMPAPOTH.FD
56910>>>    Open    Tmpanal
INCLUDING FILE: TMPANAL.FD
56912>>>    Open    Cmoves
56914>>>    Open    Cmovesa
56916>>>    Open    Cmovesa2
INCLUDING FILE: CMOVESA2.FD
56918>>>    Open    Cflagkin
56920>>>    Open    Company
56922>>>    Open    Branch
56924>>>    Open    Bmove
56926>>>    Open    Particle
56928>>>    Open    Pmovesl
56930>>>    Open    Pmoves
56932>>>    Open    Tperga
56934>>>    Open    Pumps
56936>>>    Open    Cars
56938>>>    Open    Units
56940>>>    Open    Item
56942>>>    Open    Psxetika
56944>>>    Open    Tmptehn
INCLUDING FILE: TMPTEHN.FD
56946>>>    Open    Witemxtr
56948>>>    Open    Witemxtd
INCLUDING FILE: WITEMXTD.FD
56950>>>    Open    anprod
INCLUDING FILE: ANPROD.FD
56952>>>    use     ranal.rv
INCLUDING FILE: RANAL.RV
56952>>>>>//AB/ Project ranal:analoseon
56952>>>>>//AB/     Object prj is a Report_Project
56952>>>>>//AB/         Set ProjectName to "ranal:analoseon"
56952>>>>>//AB/         Set ProjectFileName to "ranal.RV"
56952>>>>>
56952>>>>>// Project Object Structure
56952>>>>>//   ranal is a ReportViewSub
56952>>>>>//     ButtonSub3 is a ButtonSub
56952>>>>>//     ButtonSub4 is a ButtonSub
56952>>>>>//     rtehn_BasicReport is a BasicReport
56952>>>>>//       Tmpanal_DD is a Tmpanal_DataDictionary
56952>>>>>
56952>>>>>// Register all objects
56952>>>>>Register_Object ButtonSub3
56952>>>>>Register_Object ButtonSub4
56952>>>>>Register_Object ranal
56952>>>>>Register_Object rtehn_BasicReport
56952>>>>>Register_Object Tmpanal_DD
56952>>>>>
56952>>>>>
56952>>>>>//AB/     Report View
56952>>>>>
56952>>>>>
56952>>>>>    //AB-StoreTopStart
56952>>>>>    Use dfallrpt.pkg
56952>>>>>    use tmpanal.dd
INCLUDING FILE: TMPANAL.DD
56952>>>>>>>//DDB-FileStart
56952>>>>>>>//DDB-HeaderStart
56952>>>>>>>
56952>>>>>>>// File Name : TMPANAL.DD
56952>>>>>>>// Class Name: Tmpanal_DataDictionary
56952>>>>>>>// Revision  : 1
56952>>>>>>>// Version   : 2
56952>>>>>>>
56952>>>>>>>Use  Windows           // Basic Definitions
56952>>>>>>>Use  DataDict          // DataDictionary Class Definition
56952>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
56952>>>>>>>
56952>>>>>>>Open Tmpanal
56954>>>>>>>
56954>>>>>>>//DDB-HeaderEnd
56954>>>>>>>
56954>>>>>>>Class Tmpanal_DataDictionary  is a DataDictionary_sec
56955>>>>>>>
56955>>>>>>>    // Define_Fields:
56955>>>>>>>    // This procedure is used to set up all data-dictionary rules.
56955>>>>>>>
56955>>>>>>>    Procedure Define_Fields
56956>>>>>>>        Forward Send Define_Fields
56958>>>>>>>        //DDB-Generated-Code-Location
56958>>>>>>>        //DDB-DefineFieldStart
56958>>>>>>>
56958>>>>>>>        Set Main_File            To Tmpanal.File_Number
56959>>>>>>>
56959>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
56960>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
56961>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
56962>>>>>>>
56962>>>>>>>        // Field-based properties.......................
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Onoma
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Typos
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Egkatastash
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Hmnia
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Trmetaf
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Item
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Qty
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Prodiagrafh
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Posoths
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Mm
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Aa
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Itemd
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Mmitemd
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Index
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Product
56962>>>>>>>
56962>>>>>>>        // Tmpanal.Gqty
56962>>>>>>>
56962>>>>>>>        //DDB-DefineFieldEnd
56962>>>>>>>    End_Procedure    // Define_Fields
56963>>>>>>>
56963>>>>>>>    // Field_Defaults:
56963>>>>>>>    // This procedure is used to establish default field values.
56963>>>>>>>
56963>>>>>>>    Procedure Field_Defaults
56964>>>>>>>        Forward Send Field_Defaults
56966>>>>>>>        //DDB-Generated-Code-Location
56966>>>>>>>        //DDB-FieldDefaultStart
56966>>>>>>>        //DDB-FieldDefaultEnd
56966>>>>>>>    End_Procedure    // Field_Defaults
56967>>>>>>>
56967>>>>>>>End_Class    // Tmpanal_DataDictionary
56968>>>>>>>//DDB-FileEnd
56968>>>>>    //AB-StoreTopEnd
56968>>>>>
56968>>>>>    //AB-IgnoreStart
56968>>>>>
56968>>>>>    Use Rptvw.Sub
56968>>>>>    Use Button.Sub
56968>>>>>
56968>>>>>    //AB-IgnoreEnd
56968>>>>>
56968>>>>>    ACTIVATE_VIEW Activate_ranal FOR ranal
56972>>>>>
56972>>>>>    Object ranal is a ReportViewSub
56974>>>>>
56974>>>>>        //AB-StoreTopStart
56974>>>>>        
56974>>>>>        Property Integer Sort_IndexRlog     Public 1
56976>>>>>        property number  pnqty              public 0
56978>>>>>        property integer pino               public 0
56980>>>>>        property string  pscode             public ''
56982>>>>>        property string  psitem             public ''
56984>>>>>        property date    pddate             public ''
56986>>>>>        property string  psbranch           public ''
56988>>>>>        property string psrecr              public ''
56990>>>>>        //AB-StoreTopEnd
56990>>>>>
56990>>>>>        Set Label to "€¤˜¢é©œ ª"
56991>>>>>        Set Size to 39 186
56992>>>>>        Set Location to 1 23
56993>>>>>        Set Color to 16744448
56994>>>>>
56994>>>>>        //AB-DDOStart
56994>>>>>
56994>>>>>
56994>>>>>        //AB-DDOEnd
56994>>>>>
56994>>>>>        Object ButtonSub3 is a ButtonSub
56996>>>>>
56996>>>>>            //AB-StoreTopStart
56996>>>>>                                                                                                                                                                                                                                                                                                                            
56996>>>>>            //AB-StoreTopEnd
56996>>>>>
56996>>>>>            Set Bitmap to "RUNPROG.BMP"
56997>>>>>            Set Size to 18 27
56998>>>>>            Set Location to 3 119
56999>>>>>            Set Border_Style to Border_StaticEdge
57000>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
57001>>>>>
57001>>>>>            //AB-StoreStart
57001>>>>>                                                                                                                                                                                                                                                                                                                            
57001>>>>>            Procedure OnClick
57003>>>>>            
57003>>>>>            End_Procedure
57004>>>>>            
57004>>>>>            //AB-StoreEnd
57004>>>>>
57004>>>>>        End_Object    // ButtonSub3
57005>>>>>
57005>>>>>        Object ButtonSub4 is a ButtonSub
57007>>>>>
57007>>>>>            //AB-StoreTopStart
57007>>>>>                                                                                                                                                                                                                                                                                                                            
57007>>>>>            //AB-StoreTopEnd
57007>>>>>
57007>>>>>            Set Bitmap to "CANCEL.BMP"
57008>>>>>            Set Size to 18 27
57009>>>>>            Set Location to 3 153
57010>>>>>            Set Border_Style to Border_StaticEdge
57011>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
57012>>>>>
57012>>>>>            //AB-StoreStart
57012>>>>>            Procedure OnClick
57014>>>>>                Send Request_Cancel
57015>>>>>            End_Procedure
57016>>>>>            
57016>>>>>            
57016>>>>>            //AB-StoreEnd
57016>>>>>
57016>>>>>        End_Object    // ButtonSub4
57017>>>>>
57017>>>>>
57017>>>>>        //AB-StoreStart
57017>>>>>        set output_device_name to none
57018>>>>>        Procedure StartReport
57020>>>>>            Local Integer iOutputDevice
57021>>>>>            Local String  FileName
57021>>>>>            SEND RUN_REPORT
57022>>>>>        End_Procedure   // StartReport
57023>>>>>        
57023>>>>>        
57023>>>>>        Object rtehn_BasicReport is a BasicReport
57025>>>>>        
57025>>>>>            Set Report_Title to "„¤ž£â¨à©ž €¤˜¢é©œà¤ ‘ç¤¦¢˜                   "
57026>>>>>            Set Report_Caption to "„¤ž£â¨à©ž €¤˜¢é©œà¤ ‘ç¤¦¢˜ "
57027>>>>>        
57027>>>>>            Set Status_Panel_State  to true
57028>>>>>            Set Display_Error_State to True
57029>>>>>        
57029>>>>>        
57029>>>>>        
57029>>>>>        
57029>>>>>            Object Tmpanal_DD is a Tmpanal_DataDictionary
57031>>>>>                 begin_constraints
57033>>>>>                    constrain tmpanal.typos eq '09'
57035>>>>>                 end_constraints
57038>>>>>            End_Object    // tmpanal
57039>>>>>        
57039>>>>>            Set Server To (tmpanal_dd(Self))
57040>>>>>        
57040>>>>>            //Breaks and Index for the report
57040>>>>>            Report_Index By Index.4
57042>>>>>            Report_breaks tmpanal.hmnia tmpanal.egkatastash tmpanal.itemd
57057>>>>>        
57057>>>>>            Function Starting_Main_Report Returns Integer
57059>>>>>              Integer iIndexRlog
57060>>>>>              Local Integer iRetVal
57060>>>>>              Forward Get Starting_Main_Report to iRetval
57062>>>>>              send rebuild_constraints to tmpanal_dd
57063>>>>>              Send Find to (tmpanal_dd(self)) First_Record 4
57064>>>>>            End_Function
57065>>>>>        
57065>>>>>            Procedure_Section subheader1
57067>>>>>                set pddate to tmpanal.hmnia
57068>>>>>                set pnqty to 0
57069>>>>>        
57069>>>>>            End_Procedure
57070>>>>>        
57070>>>>>            Procedure_Section subheader2
57072>>>>>                set psbranch to tmpanal.egkatastash
57073>>>>>                set pnqty to 0
57074>>>>>            End_Procedure
57075>>>>>        
57075>>>>>            Procedure_Section subheader3
57077>>>>>                set psitem to tmpanal.itemd
57078>>>>>            End_Procedure
57079>>>>>        
57079>>>>>            Procedure_Section  Body
57081>>>>>                integer ino
57082>>>>>                number nqty
57082>>>>>                set pino  to (pino(self)+1)
57083>>>>>                set pnqty to (pnqty(self)+Tmpanal.posoths)
57084>>>>>                send update_status ('Ešš¨˜­ã ' + string(Tmpanal.itemd))
57085>>>>>            End_Procedure
57086>>>>>            Procedure_Section subtotal3
57088>>>>>                string sbranch sitem
57089>>>>>                number nqty
57089>>>>>                date ddate
57089>>>>>                get psbranch to sbranch
57090>>>>>                get psitem to sitem
57091>>>>>                get pnqty to nqty
57092>>>>>                get pddate to ddate
57093>>>>>                clear tmpanal
57094>>>>>                move 'PP2'                              to Tmpanal.onoma
57095>>>>>                move '91'                               to Tmpanal.typos
57096>>>>>                move sbranch                            to Tmpanal.egkatastash
57097>>>>>                move nqty                               to tmpanal.posoths
57098>>>>>                move sitem                              to Tmpanal.itemd
57099>>>>>                move ddate                              to Tmpanal.hmnia
57100>>>>>                set pnqty to 0
57101>>>>>                saverecord tmpanal
57102>>>>>                set pnqty to 0
57103>>>>>            End_Procedure
57104>>>>>        
57104>>>>>            Procedure_Section subtotal2
57106>>>>>            End_Procedure
57107>>>>>        
57107>>>>>            Procedure_Section subtotal1
57109>>>>>        
57109>>>>>            End_Procedure
57110>>>>>        
57110>>>>>           Procedure Ending_Report
57112>>>>>                integer ino
57113>>>>>        
57113>>>>>                date ddate
57113>>>>>                get pddate to ddate
57114>>>>>        
57114>>>>>                get pino to ino
57115>>>>>                clear tmpanal
57116>>>>>                move 'PP2'                              to Tmpanal.onoma
57117>>>>>                move '92'                               to Tmpanal.typos
57118>>>>>                move 'ZZZZ'                             to tmpanal.egkatastash
57119>>>>>                move ddate                              to Tmpanal.hmnia
57120>>>>>                move ino                                to tmpanal.qty
57121>>>>>                saverecord tmpanal
57122>>>>>                SET pINO TO 0
57123>>>>>           End_Procedure
57124>>>>>        
57124>>>>>        End_Object
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        
57125>>>>>        //AB-StoreEnd
57125>>>>>
57125>>>>>    End_Object    // ranal
57126>>>>>
57126>>>>>
57126>>>>>    //AB-StoreStart
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>                
57126>>>>>    //AB-StoreEnd
57126>>>>>
57126>>>>>//AB/     End_Object    // prj
57126>>>    use     ranal90.rv
INCLUDING FILE: RANAL90.RV
57126>>>>>//AB/ Project ranal90:analoseon
57126>>>>>//AB/ Object prj is a Report_Project
57126>>>>>//AB/     Set ProjectName to "ranal90:analoseon"
57126>>>>>//AB/     Set ProjectFileName to "ranal90.RV"
57126>>>>>
57126>>>>>// Project Object Structure
57126>>>>>//   ranal90 is a ReportViewSub
57126>>>>>//     ButtonSub3 is a ButtonSub
57126>>>>>//     ButtonSub4 is a ButtonSub
57126>>>>>//     rtehn_BasicReport is a BasicReport
57126>>>>>//       Tmpanal_DD is a Tmpanal_DataDictionary
57126>>>>>
57126>>>>>// Register all objects
57126>>>>>Register_Object ButtonSub3
57126>>>>>Register_Object ButtonSub4
57126>>>>>Register_Object ranal90
57126>>>>>Register_Object rtehn_BasicReport
57126>>>>>Register_Object Tmpanal_DD
57126>>>>>
57126>>>>>
57126>>>>>//AB/ Report View
57126>>>>>
57126>>>>>
57126>>>>>//AB-StoreTopStart
57126>>>>>Use dfallrpt.pkg
57126>>>>>use tmpanal.dd
57126>>>>>//AB-StoreTopEnd
57126>>>>>
57126>>>>>//AB-IgnoreStart
57126>>>>>
57126>>>>>Use Rptvw.Sub
57126>>>>>Use Button.Sub
57126>>>>>
57126>>>>>//AB-IgnoreEnd
57126>>>>>
57126>>>>>ACTIVATE_VIEW Activate_ranal90 FOR ranal90
57130>>>>>
57130>>>>>Object ranal90 is a ReportViewSub
57132>>>>>
57132>>>>>    //AB-StoreTopStart
57132>>>>>    
57132>>>>>    Property Integer Sort_IndexRlog     Public 1
57134>>>>>    property number  pnqty              public 0
57136>>>>>    property integer pino               public 0
57138>>>>>    property string  pscode             public ''
57140>>>>>    property string  psitem             public ''
57142>>>>>    property date    pddate             public ''
57144>>>>>    property string  psbranch           public ''
57146>>>>>    property string psrecr              public ''
57148>>>>>    //AB-StoreTopEnd
57148>>>>>
57148>>>>>    Set Label to "€¤˜¢é©œ ª"
57149>>>>>    Set Size to 39 186
57150>>>>>    Set Location to 1 23
57151>>>>>    Set Color to 16744448
57152>>>>>
57152>>>>>    //AB-DDOStart
57152>>>>>
57152>>>>>
57152>>>>>    //AB-DDOEnd
57152>>>>>
57152>>>>>    Object ButtonSub3 is a ButtonSub
57154>>>>>        Set Bitmap to "RUNPROG.BMP"
57155>>>>>        Set Size to 18 27
57156>>>>>        Set Location to 3 119
57157>>>>>        Set Border_Style to Border_StaticEdge
57158>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57159>>>>>
57159>>>>>        //AB-StoreStart
57159>>>>>        Procedure OnClick
57161>>>>>        End_Procedure
57162>>>>>        
57162>>>>>        
57162>>>>>        //AB-StoreEnd
57162>>>>>
57162>>>>>    End_Object    // ButtonSub3
57163>>>>>
57163>>>>>    Object ButtonSub4 is a ButtonSub
57165>>>>>        Set Bitmap to "CANCEL.BMP"
57166>>>>>        Set Size to 18 27
57167>>>>>        Set Location to 3 153
57168>>>>>        Set Border_Style to Border_StaticEdge
57169>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57170>>>>>
57170>>>>>        //AB-StoreStart
57170>>>>>        Procedure OnClick
57172>>>>>            Send Request_Cancel
57173>>>>>        End_Procedure
57174>>>>>        
57174>>>>>        //AB-StoreEnd
57174>>>>>
57174>>>>>    End_Object    // ButtonSub4
57175>>>>>
57175>>>>>
57175>>>>>    //AB-StoreStart
57175>>>>>    set output_device_name to none
57176>>>>>    Procedure StartReport
57178>>>>>        Local Integer iOutputDevice
57179>>>>>        Local String  FileName
57179>>>>>        SEND RUN_REPORT
57180>>>>>    End_Procedure   // StartReport
57181>>>>>    
57181>>>>>    
57181>>>>>    Object rtehn_BasicReport is a BasicReport
57183>>>>>    
57183>>>>>        Set Report_Title to "„¤ž£â¨à©ž Record 90                   "
57184>>>>>        Set Report_Caption to "„¤ž£â¨à©ž Record 90  "
57185>>>>>    
57185>>>>>        Set Status_Panel_State  to true
57186>>>>>        Set Display_Error_State to True
57187>>>>>    
57187>>>>>        Object Tmpanal_DD is a Tmpanal_DataDictionary
57189>>>>>             begin_constraints
57191>>>>>                constrain tmpanal.typos eq '09'
57193>>>>>             end_constraints
57196>>>>>        End_Object    // tmpanal
57197>>>>>    
57197>>>>>        Set Server To (tmpanal_dd(Self))
57198>>>>>    
57198>>>>>        //Breaks and Index for the report
57198>>>>>        Report_Index By Index.5
57200>>>>>        Report_breaks tmpanal.hmnia tmpanal.typos tmpanal.egkatastash tmpanal.item
57216>>>>>    
57216>>>>>        Function Starting_Main_Report Returns Integer
57218>>>>>          Integer iIndexRlog
57219>>>>>          Local Integer iRetVal
57219>>>>>          Forward Get Starting_Main_Report to iRetval
57221>>>>>          send rebuild_constraints to tmpanal_dd
57222>>>>>          Send Find to (tmpanal_dd(self)) First_Record 5
57223>>>>>        End_Function
57224>>>>>    
57224>>>>>        Procedure_Section subheader1
57226>>>>>            set pddate to tmpanal.hmnia
57227>>>>>            set pnqty to 0
57228>>>>>    
57228>>>>>        End_Procedure
57229>>>>>    
57229>>>>>        Procedure_Section subheader2
57231>>>>>        End_procedure
57232>>>>>    
57232>>>>>        Procedure_Section subheader3
57234>>>>>            set psbranch to tmpanal.egkatastash
57235>>>>>            set pnqty to 0
57236>>>>>        End_Procedure
57237>>>>>    
57237>>>>>        Procedure_Section subheader4
57239>>>>>            set psitem to tmpanal.item
57240>>>>>        End_Procedure
57241>>>>>    
57241>>>>>        Procedure_Section  Body
57243>>>>>            integer ino
57244>>>>>            number nqty
57244>>>>>            if (tmpanal.aa=1);                set pnqty to (pnqty(self)+Tmpanal.qty)
57247>>>>>            send update_status ('Ešš¨˜­ã ' + string(Tmpanal.item))
57248>>>>>        End_Procedure
57249>>>>>    
57249>>>>>        Procedure_Section subtotal4
57251>>>>>            string sbranch sitem
57252>>>>>            number nqty
57252>>>>>            date ddate
57252>>>>>            get psbranch to sbranch
57253>>>>>            get psitem to sitem
57254>>>>>            get pnqty to nqty
57255>>>>>            get pddate to ddate
57256>>>>>            clear tmpanal
57257>>>>>            move 'PP2'                              to Tmpanal.onoma
57258>>>>>            move '90'                               to Tmpanal.typos
57259>>>>>            move sbranch                            to Tmpanal.egkatastash
57260>>>>>            move nqty                               to tmpanal.qty
57261>>>>>            move sitem                              to Tmpanal.item
57262>>>>>            move ddate                              to Tmpanal.hmnia
57263>>>>>            set pnqty to 0
57264>>>>>            saverecord tmpanal
57265>>>>>            set pnqty to 0
57266>>>>>        End_Procedure
57267>>>>>    
57267>>>>>        Procedure_Section subtotal3
57269>>>>>        End_Procedure
57270>>>>>    
57270>>>>>        Procedure_Section subtotal2
57272>>>>>        End_Procedure
57273>>>>>    
57273>>>>>        Procedure_Section subtotal1
57275>>>>>    
57275>>>>>        End_Procedure
57276>>>>>    
57276>>>>>       Procedure Ending_Report
57278>>>>>    
57278>>>>>       End_Procedure
57279>>>>>    
57279>>>>>    End_Object
57280>>>>>    
57280>>>>>    //AB-StoreEnd
57280>>>>>
57280>>>>>End_Object    // ranal90
57281>>>>>
57281>>>>>
57281>>>>>//AB-StoreStart
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>                    
57281>>>>>//AB-StoreEnd
57281>>>>>
57281>>>>>//AB/ End_Object    // prj
57281>>>    use     rapoth.rv
INCLUDING FILE: RAPOTH.RV
57281>>>>>//AB/ Project Rapoth:synola mm1
57281>>>>>//AB/     Object prj is a Report_Project
57281>>>>>//AB/         Set ProjectName to "Rapoth:synola mm1"
57281>>>>>//AB/         Set ProjectFileName to "Rapoth.RV"
57281>>>>>
57281>>>>>// Project Object Structure
57281>>>>>//   Rapoth is a ReportViewSub
57281>>>>>//     ButtonSub3 is a ButtonSub
57281>>>>>//     ButtonSub4 is a ButtonSub
57281>>>>>//     rapoth_BasicReport is a BasicReport
57281>>>>>//       Tmpapoth_DD is a Tmpapoth_DataDictionary
57281>>>>>
57281>>>>>// Register all objects
57281>>>>>Register_Object ButtonSub3
57281>>>>>Register_Object ButtonSub4
57281>>>>>Register_Object Rapoth
57281>>>>>Register_Object rapoth_BasicReport
57281>>>>>Register_Object Tmpapoth_DD
57281>>>>>
57281>>>>>
57281>>>>>//AB/     Report View
57281>>>>>
57281>>>>>
57281>>>>>    //AB-StoreTopStart
57281>>>>>    Use dfallrpt.pkg
57281>>>>>    use tmpapoth.dd
INCLUDING FILE: TMPAPOTH.DD
57281>>>>>>>//DDB-FileStart
57281>>>>>>>//DDB-HeaderStart
57281>>>>>>>
57281>>>>>>>// File Name : TMPAPOTH.DD
57281>>>>>>>// Class Name: Tmpapoth_DataDictionary
57281>>>>>>>// Revision  : 3
57281>>>>>>>// Version   : 2
57281>>>>>>>
57281>>>>>>>Use  Windows           // Basic Definitions
57281>>>>>>>Use  DataDict          // DataDictionary Class Definition
57281>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57281>>>>>>>
57281>>>>>>>Open Tmpapoth
57283>>>>>>>
57283>>>>>>>//DDB-HeaderEnd
57283>>>>>>>
57283>>>>>>>Class Tmpapoth_DataDictionary  is a DataDictionary_sec
57284>>>>>>>
57284>>>>>>>    // Define_Fields:
57284>>>>>>>    // This procedure is used to set up all data-dictionary rules.
57284>>>>>>>
57284>>>>>>>    Procedure Define_Fields
57285>>>>>>>        Forward Send Define_Fields
57287>>>>>>>        //DDB-Generated-Code-Location
57287>>>>>>>        //DDB-DefineFieldStart
57287>>>>>>>
57287>>>>>>>        Set Main_File            To Tmpapoth.File_Number
57288>>>>>>>
57288>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57289>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57290>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57291>>>>>>>
57291>>>>>>>        // Field-based properties.......................
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Onoma
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Typos
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Egkatastash
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Arithmos
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Hmnia
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Type
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Code
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Item
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Qty
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Monada
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Paralabh
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Name
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Item_Descr
57291>>>>>>>
57291>>>>>>>        // Tmpapoth.Pinakida
57291>>>>>>>
57291>>>>>>>        //DDB-DefineFieldEnd
57291>>>>>>>    End_Procedure    // Define_Fields
57292>>>>>>>
57292>>>>>>>    // Field_Defaults:
57292>>>>>>>    // This procedure is used to establish default field values.
57292>>>>>>>
57292>>>>>>>    Procedure Field_Defaults
57293>>>>>>>        Forward Send Field_Defaults
57295>>>>>>>        //DDB-Generated-Code-Location
57295>>>>>>>        //DDB-FieldDefaultStart
57295>>>>>>>        //DDB-FieldDefaultEnd
57295>>>>>>>    End_Procedure    // Field_Defaults
57296>>>>>>>
57296>>>>>>>End_Class    // Tmpapoth_DataDictionary
57297>>>>>>>//DDB-FileEnd
57297>>>>>    //AB-StoreTopEnd
57297>>>>>
57297>>>>>    //AB-IgnoreStart
57297>>>>>
57297>>>>>    Use Rptvw.Sub
57297>>>>>    Use Button.Sub
57297>>>>>
57297>>>>>    //AB-IgnoreEnd
57297>>>>>
57297>>>>>    ACTIVATE_VIEW Activate_Rapoth FOR Rapoth
57301>>>>>
57301>>>>>    Object Rapoth is a ReportViewSub
57303>>>>>
57303>>>>>        //AB-StoreTopStart
57303>>>>>        
57303>>>>>        Property Integer Sort_IndexRlog     Public 1
57305>>>>>        property number  pnqty              public 0
57307>>>>>        property integer pino               public 0
57309>>>>>        property string  pscode             public ''
57311>>>>>        property string  psitem             public ''
57313>>>>>        property date    pddate             public ''
57315>>>>>        property string  psbranch           public ''
57317>>>>>        property string  pstype             public ''
57319>>>>>        property string psrecr              public ''
57321>>>>>        //AB-StoreTopEnd
57321>>>>>
57321>>>>>        Set Label to "‘ç¤¦¢˜ MM1"
57322>>>>>        Set Size to 39 186
57323>>>>>        Set Location to 1 23
57324>>>>>        Set Color to 16744448
57325>>>>>
57325>>>>>        //AB-DDOStart
57325>>>>>
57325>>>>>
57325>>>>>        //AB-DDOEnd
57325>>>>>
57325>>>>>        Object ButtonSub3 is a ButtonSub
57327>>>>>
57327>>>>>            //AB-StoreTopStart
57327>>>>>                                                                                                                                                                                                                                                                                                                                
57327>>>>>            //AB-StoreTopEnd
57327>>>>>
57327>>>>>            Set Bitmap to "RUNPROG.BMP"
57328>>>>>            Set Size to 18 27
57329>>>>>            Set Location to 3 119
57330>>>>>            Set Border_Style to Border_StaticEdge
57331>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
57332>>>>>
57332>>>>>            //AB-StoreStart
57332>>>>>                                                                                                                                                                                                                                                                                                                                
57332>>>>>            Procedure OnClick
57334>>>>>            
57334>>>>>            End_Procedure
57335>>>>>            
57335>>>>>            //AB-StoreEnd
57335>>>>>
57335>>>>>        End_Object    // ButtonSub3
57336>>>>>
57336>>>>>        Object ButtonSub4 is a ButtonSub
57338>>>>>
57338>>>>>            //AB-StoreTopStart
57338>>>>>                                                                                                                                                                                                                                                                                                                                
57338>>>>>            //AB-StoreTopEnd
57338>>>>>
57338>>>>>            Set Bitmap to "CANCEL.BMP"
57339>>>>>            Set Size to 18 27
57340>>>>>            Set Location to 3 153
57341>>>>>            Set Border_Style to Border_StaticEdge
57342>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
57343>>>>>
57343>>>>>            //AB-StoreStart
57343>>>>>            Procedure OnClick
57345>>>>>                Send Request_Cancel
57346>>>>>            End_Procedure
57347>>>>>            
57347>>>>>            
57347>>>>>            //AB-StoreEnd
57347>>>>>
57347>>>>>        End_Object    // ButtonSub4
57348>>>>>
57348>>>>>
57348>>>>>        //AB-StoreStart
57348>>>>>        set output_device_name to none
57349>>>>>        Procedure StartReport
57351>>>>>            Local Integer iOutputDevice
57352>>>>>            Local String  FileName
57352>>>>>            SEND RUN_REPORT
57353>>>>>        End_Procedure   // StartReport
57354>>>>>        
57354>>>>>        
57354>>>>>        Object rapoth_BasicReport is a BasicReport
57356>>>>>        
57356>>>>>            Set Report_Title to "„¤ž£â¨à©ž MM1 ‘ç¤¦¢˜                   "
57357>>>>>            Set Report_Caption to "„¤ž£â¨à©ž MM1 ‘ç¤¦¢˜ "
57358>>>>>        
57358>>>>>            Set Status_Panel_State  to true
57359>>>>>            Set Display_Error_State to True
57360>>>>>        
57360>>>>>        
57360>>>>>        
57360>>>>>        
57360>>>>>            Object Tmpapoth_DD is a Tmpapoth_DataDictionary
57362>>>>>                 begin_constraints
57364>>>>>                    constrain tmpapoth.typos eq '01'
57366>>>>>                 end_constraints
57369>>>>>            End_Object    // tmpapoth
57370>>>>>        
57370>>>>>            Set Server To (tmpapoth_dd(Self))
57371>>>>>        
57371>>>>>            //Breaks and Index for the report
57371>>>>>            Report_Index By Index.3
57373>>>>>            Report_breaks tmpapoth.egkatastash tmpapoth.hmnia tmpapoth.type tmpapoth.item
57389>>>>>        
57389>>>>>            Function Starting_Main_Report Returns Integer
57391>>>>>              Integer iIndexRlog
57392>>>>>              Local Integer iRetVal
57392>>>>>              Forward Get Starting_Main_Report to iRetval
57394>>>>>              send rebuild_constraints to tmpapoth_dd
57395>>>>>              Send Find to (tmpapoth_dd(self)) First_Record 3
57396>>>>>            End_Function
57397>>>>>        
57397>>>>>        
57397>>>>>        
57397>>>>>            Procedure_Section subheader1
57399>>>>>                set psbranch to tmpapoth.egkatastash
57400>>>>>                set pnqty to 0
57401>>>>>            End_Procedure
57402>>>>>        
57402>>>>>            Procedure_Section subheader2
57404>>>>>                set pddate to tmpapoth.hmnia
57405>>>>>                set pnqty to 0
57406>>>>>            End_Procedure
57407>>>>>        
57407>>>>>            Procedure_Section subheader3
57409>>>>>                set pstype to tmpapoth.type
57410>>>>>                set pnqty to 0
57411>>>>>            End_Procedure
57412>>>>>        
57412>>>>>        
57412>>>>>        
57412>>>>>            Procedure_Section subheader4
57414>>>>>                set psitem to tmpapoth.item
57415>>>>>                set pnqty to 0
57416>>>>>            End_Procedure
57417>>>>>        
57417>>>>>            Procedure_Section  Body
57419>>>>>                number nqty
57420>>>>>                set pnqty to (pnqty(self)+Tmpapoth.qty)
57421>>>>>                send update_status ('Ešš¨˜­ã ' + string(Tmpapoth.item))
57422>>>>>            End_Procedure
57423>>>>>            Procedure_Section subtotal4
57425>>>>>                string sbranch sitem stype smm
57426>>>>>                number nqty
57426>>>>>                date ddate
57426>>>>>                move tmpapoth.monada to smm
57427>>>>>                get psbranch to sbranch
57428>>>>>                get psitem to sitem
57429>>>>>                get pnqty to nqty
57430>>>>>                get pddate to ddate
57431>>>>>                get pstype to stype
57432>>>>>                clear tmpapoth
57433>>>>>                move 'MM1'                              to tmpapoth.onoma
57434>>>>>                move '91'                               to Tmpapoth.typos
57435>>>>>                move '9999999999'                       to Tmpapoth.arithmos
57436>>>>>                move stype                              to tmpapoth.type
57437>>>>>                move nqty                               to Tmpapoth.qty
57438>>>>>                move ''                                 to Tmpapoth.code
57439>>>>>                move ddate                              to tmpapoth.hmnia
57440>>>>>                move sitem                              to Tmpapoth.item
57441>>>>>                move sbranch                            to Tmpapoth.egkatastash
57442>>>>>                move smm                                to Tmpapoth.monada
57443>>>>>                move ''                                 to Tmpapoth.paralabh
57444>>>>>                saverecord tmpapoth
57445>>>>>                set pnqty to 0
57446>>>>>            End_Procedure
57447>>>>>        
57447>>>>>            Procedure_Section subtotal3
57449>>>>>        //        string sbranch sitem stype smm
57449>>>>>        //        date ddate
57449>>>>>        //        number nqty
57449>>>>>        //        move tmpapoth.monada to smm
57449>>>>>        //        get psbranch to sbranch
57449>>>>>        //        get psitem to sitem
57449>>>>>        //        get pnqty to nqty
57449>>>>>        //        get pddate to ddate
57449>>>>>        //        get pstype to stype
57449>>>>>        //        clear tmpapoth
57449>>>>>        //        move '91'                               to Tmpapoth.typos
57449>>>>>        //        move '9999999999'                       to Tmpapoth.arithmos
57449>>>>>        //        move stype                              to tmpapoth.type
57449>>>>>        //        move nqty                               to Tmpapoth.qty
57449>>>>>        //        move ''                                 to Tmpapoth.code
57449>>>>>        //        move ddate                              to tmpapoth.hmnia
57449>>>>>        //        move sitem                              to Tmpapoth.item
57449>>>>>        //        move sbranch                            to Tmpapoth.egkatastash
57449>>>>>        //        move smm                                to Tmpapoth.monada
57449>>>>>        //        move ''                                 to Tmpapoth.paralabh
57449>>>>>        //        saverecord tmpapoth
57449>>>>>        //        set pnqty to 0
57449>>>>>        
57449>>>>>        
57449>>>>>            End_Procedure
57450>>>>>        
57450>>>>>            Procedure_Section subtotal2
57452>>>>>         //       string sbranch sitem stype smm
57452>>>>>         //       date ddate
57452>>>>>         //       number nqty
57452>>>>>         //       move tmpapoth.monada to smm
57452>>>>>         //       get psbranch to sbranch
57452>>>>>         //       get psitem to sitem
57452>>>>>         //       get pnqty to nqty
57452>>>>>         //       get pddate to ddate
57452>>>>>         //       get pstype to stype
57452>>>>>         //       clear tmpapoth
57452>>>>>         //       move '91'                               to Tmpapoth.typos
57452>>>>>         //       move '9999999999'                       to Tmpapoth.arithmos
57452>>>>>         //       move stype                              to tmpapoth.type
57452>>>>>         //       move nqty                               to Tmpapoth.qty
57452>>>>>         //       move ''                                 to Tmpapoth.code
57452>>>>>         //       move ddate                              to tmpapoth.hmnia
57452>>>>>         //       move sitem                              to Tmpapoth.item
57452>>>>>         //       move sbranch                            to Tmpapoth.egkatastash
57452>>>>>         //       move smm                                to Tmpapoth.monada
57452>>>>>         //       move ''                                 to Tmpapoth.paralabh
57452>>>>>         //       saverecord tmpapoth
57452>>>>>         //       set pnqty to 0
57452>>>>>        
57452>>>>>            End_Procedure
57453>>>>>        
57453>>>>>            Procedure_Section subtotal1
57455>>>>>        //        string sbranch sitem stype smm
57455>>>>>        //        date ddate
57455>>>>>        //        number nqty
57455>>>>>        //        move tmpapoth.monada to smm
57455>>>>>        //        get psbranch to sbranch
57455>>>>>        //        get psitem to sitem
57455>>>>>        //        get pddate to ddate
57455>>>>>        //        get pnqty to nqty
57455>>>>>        //        get pstype to stype
57455>>>>>        //        clear tmpapoth
57455>>>>>        //        move '91'                               to Tmpapoth.typos
57455>>>>>        //        move '9999999999'                       to Tmpapoth.arithmos
57455>>>>>        //        move stype                              to tmpapoth.type
57455>>>>>        //        move nqty                               to Tmpapoth.qty
57455>>>>>        //        move ''                                 to Tmpapoth.code
57455>>>>>        //        move ddate                              to tmpapoth.hmnia
57455>>>>>        //        move sitem                              to Tmpapoth.item
57455>>>>>        //        move sbranch                            to Tmpapoth.egkatastash
57455>>>>>        //        move smm                                to Tmpapoth.monada
57455>>>>>        //        move ''                                 to Tmpapoth.paralabh
57455>>>>>        //        saverecord tmpapoth
57455>>>>>        //        set pnqty to 0
57455>>>>>        
57455>>>>>        End_Procedure
57456>>>>>        
57456>>>>>        
57456>>>>>        
57456>>>>>        Procedure Ending_Report
57458>>>>>            set psbranch    to ''
57459>>>>>            set psitem      to ''
57460>>>>>            set pddate      to ''
57461>>>>>            set pnqty       to 0
57462>>>>>            set pstype      to ''
57463>>>>>        End_Procedure
57464>>>>>        
57464>>>>>        End_Object
57465>>>>>        
57465>>>>>        
57465>>>>>        
57465>>>>>        
57465>>>>>        
57465>>>>>        //AB-StoreEnd
57465>>>>>
57465>>>>>    End_Object    // Rapoth
57466>>>>>
57466>>>>>
57466>>>>>    //AB-StoreStart
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    
57466>>>>>    //AB-StoreEnd
57466>>>>>
57466>>>>>//AB/     End_Object    // prj
57466>>>    use     ranald.rv
INCLUDING FILE: RANALD.RV
57466>>>>>//AB/ Project ranald:analoseon synola itemd
57466>>>>>//AB/ Object prj is a Report_Project
57466>>>>>//AB/     Set ProjectName to "ranald:analoseon synola itemd"
57466>>>>>//AB/     Set ProjectFileName to "ranald.RV"
57466>>>>>
57466>>>>>// Project Object Structure
57466>>>>>//   ranald is a ReportViewSub
57466>>>>>//     ButtonSub3 is a ButtonSub
57466>>>>>//     ButtonSub4 is a ButtonSub
57466>>>>>//     rtehn_BasicReport is a BasicReport
57466>>>>>//       Tmpanal_DD is a Tmpanal_DataDictionary
57466>>>>>
57466>>>>>// Register all objects
57466>>>>>Register_Object ButtonSub3
57466>>>>>Register_Object ButtonSub4
57466>>>>>Register_Object ranald
57466>>>>>Register_Object rtehn_BasicReport
57466>>>>>Register_Object Tmpanal_DD
57466>>>>>
57466>>>>>
57466>>>>>//AB/ Report View
57466>>>>>
57466>>>>>
57466>>>>>//AB-StoreTopStart
57466>>>>>Use dfallrpt.pkg
57466>>>>>use tmpanal.dd
57466>>>>>//AB-StoreTopEnd
57466>>>>>
57466>>>>>//AB-IgnoreStart
57466>>>>>
57466>>>>>Use Rptvw.Sub
57466>>>>>Use Button.Sub
57466>>>>>
57466>>>>>//AB-IgnoreEnd
57466>>>>>
57466>>>>>ACTIVATE_VIEW Activate_ranald FOR ranald
57470>>>>>
57470>>>>>Object ranald is a ReportViewSub
57472>>>>>
57472>>>>>    //AB-StoreTopStart
57472>>>>>    Property Integer Sort_IndexRlog     Public 1
57474>>>>>    property number  pnqty              public 0
57476>>>>>    property integer pino               public 0
57478>>>>>    property string  pscode             public ''
57480>>>>>    property string  psitem             public ''
57482>>>>>    property date    pddate             public ''
57484>>>>>    property string  psbranch           public ''
57486>>>>>    property string psrecr              public ''
57488>>>>>    //AB-StoreTopEnd
57488>>>>>
57488>>>>>    Set Label to "€¤˜¢é©œ ª RECORD 09"
57489>>>>>    Set Size to 39 186
57490>>>>>    Set Location to 1 23
57491>>>>>    Set Color to 16744448
57492>>>>>
57492>>>>>    //AB-DDOStart
57492>>>>>
57492>>>>>
57492>>>>>    //AB-DDOEnd
57492>>>>>
57492>>>>>    Object ButtonSub3 is a ButtonSub
57494>>>>>        Set Bitmap to "RUNPROG.BMP"
57495>>>>>        Set Size to 18 27
57496>>>>>        Set Location to 3 119
57497>>>>>        Set Border_Style to Border_StaticEdge
57498>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57499>>>>>
57499>>>>>        //AB-StoreStart
57499>>>>>        Procedure OnClick
57501>>>>>        End_Procedure
57502>>>>>        
57502>>>>>        
57502>>>>>        
57502>>>>>        //AB-StoreEnd
57502>>>>>
57502>>>>>    End_Object    // ButtonSub3
57503>>>>>
57503>>>>>    Object ButtonSub4 is a ButtonSub
57505>>>>>        Set Bitmap to "CANCEL.BMP"
57506>>>>>        Set Size to 18 27
57507>>>>>        Set Location to 3 153
57508>>>>>        Set Border_Style to Border_StaticEdge
57509>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57510>>>>>
57510>>>>>        //AB-StoreStart
57510>>>>>        Procedure OnClick
57512>>>>>            Send Request_Cancel
57513>>>>>        End_Procedure
57514>>>>>        
57514>>>>>        
57514>>>>>        //AB-StoreEnd
57514>>>>>
57514>>>>>    End_Object    // ButtonSub4
57515>>>>>
57515>>>>>
57515>>>>>    //AB-StoreStart
57515>>>>>    set output_device_name to none
57516>>>>>    Procedure StartReport
57518>>>>>        Local Integer iOutputDevice
57519>>>>>        Local String  FileName
57519>>>>>        SEND RUN_REPORT
57520>>>>>    End_Procedure   // StartReport
57521>>>>>    
57521>>>>>    Object rtehn_BasicReport is a BasicReport
57523>>>>>    
57523>>>>>        Set Report_Title to "„¤ž£â¨à©ž €¤˜¢é©œà¤ RECORD 09                   "
57524>>>>>        Set Report_Caption to "„¤ž£â¨à©ž €¤˜¢é©œà¤ RECORD 09 "
57525>>>>>    
57525>>>>>        Set Status_Panel_State  to true
57526>>>>>        Set Display_Error_State to True
57527>>>>>    
57527>>>>>        Object Tmpanal_DD is a Tmpanal_DataDictionary
57529>>>>>             begin_constraints
57531>>>>>                constrain tmpanal.typos eq '09'
57533>>>>>             end_constraints
57536>>>>>        End_Object    // tmpanal
57537>>>>>    
57537>>>>>        Set Server To (tmpanal_dd(Self))
57538>>>>>    
57538>>>>>        //Breaks and Index for the report
57538>>>>>        Report_Index By Index.5
57540>>>>>        Report_breaks tmpanal.hmnia tmpanal.typos tmpanal.egkatastash tmpanal.item tmpanal.trmetaf tmpanal.prodiagrafh tmpanal.itemd
57559>>>>>    
57559>>>>>        Function Starting_Main_Report Returns Integer
57561>>>>>          Integer iIndexRlog
57562>>>>>          Local Integer iRetVal
57562>>>>>          Forward Get Starting_Main_Report to iRetval
57564>>>>>          send rebuild_constraints to tmpanal_dd
57565>>>>>          Send Find to (tmpanal_dd(self)) First_Record 5
57566>>>>>        End_Function
57567>>>>>    
57567>>>>>        Procedure_Section subheader1
57569>>>>>        End_Procedure
57570>>>>>    
57570>>>>>        Procedure_Section subheader2
57572>>>>>        End_Procedure
57573>>>>>    
57573>>>>>        Procedure_Section subheader3
57575>>>>>        End_Procedure
57576>>>>>    
57576>>>>>        Procedure_Section subheader4
57578>>>>>        End_Procedure
57579>>>>>    
57579>>>>>        Procedure_Section subheader5
57581>>>>>        End_Procedure
57582>>>>>    
57582>>>>>        Procedure_Section subheader6
57584>>>>>            set pino to 0
57585>>>>>        End_Procedure
57586>>>>>    
57586>>>>>        Procedure_Section subheader7
57588>>>>>            set pnqty to 0
57589>>>>>        End_Procedure
57590>>>>>    
57590>>>>>        Procedure_Section  Body
57592>>>>>            integer ino
57593>>>>>            number nqty
57593>>>>>            set pnqty to (pnqty(self)+Tmpanal.posoths)
57594>>>>>            send update_status ('Ešš¨˜­ã ' + string(Tmpanal.itemd))
57595>>>>>        End_Procedure
57596>>>>>    
57596>>>>>        Procedure_Section subtotal7
57598>>>>>            string sbranch sitem
57599>>>>>            number nqty ino
57599>>>>>            date ddate
57599>>>>>            get psbranch to sbranch
57600>>>>>            set  pino to (pino(self)+1)
57601>>>>>            get pino to ino
57602>>>>>            get pnqty to nqty
57603>>>>>            move 0 to tmpanal.recnum
57604>>>>>            move nqty                               to tmpanal.posoths
57605>>>>>            move ino                                to tmpanal.aa
57606>>>>>            move '50' to tmpanal.typos
57607>>>>>            saverecord tmpanal
57608>>>>>        End_Procedure
57609>>>>>    
57609>>>>>        Procedure_Section subtotal6
57611>>>>>        End_Procedure
57612>>>>>    
57612>>>>>        Procedure_Section subtotal5
57614>>>>>    
57614>>>>>        End_Procedure
57615>>>>>    
57615>>>>>        Procedure_Section subtotal4
57617>>>>>        End_Procedure
57618>>>>>    
57618>>>>>        Procedure_Section subtotal3
57620>>>>>    
57620>>>>>        End_Procedure
57621>>>>>    
57621>>>>>        Procedure_Section subtotal2
57623>>>>>        End_Procedure
57624>>>>>    
57624>>>>>        Procedure_Section subtotal1
57626>>>>>    
57626>>>>>        End_Procedure
57627>>>>>       Procedure Ending_Report
57629>>>>>            clear tmpanal
57630>>>>>            find gt tmpanal.recnum
57631>>>>>>
57631>>>>>            while (found)
57635>>>>>                if (tmpanal.typos='09') delete tmpanal
57638>>>>>                else if (tmpanal.typos='50') begin
57641>>>>>                    move '09' to tmpanal.typos
57642>>>>>                    saverecord tmpanal
57643>>>>>                end
57643>>>>>>
57643>>>>>                find gt tmpanal.recnum
57644>>>>>>
57644>>>>>            Loop
57645>>>>>>
57645>>>>>       End_Procedure
57646>>>>>    
57646>>>>>    End_Object
57647>>>>>    
57647>>>>>    
57647>>>>>    //AB-StoreEnd
57647>>>>>
57647>>>>>End_Object    // ranald
57648>>>>>
57648>>>>>
57648>>>>>//AB-StoreStart
57648>>>>>
57648>>>>>//AB-StoreEnd
57648>>>>>
57648>>>>>//AB/ End_Object    // prj
57648>>>    open    itemtehn
57650>>>    open    itemd
INCLUDING FILE: ITEMD.FD
57652>>>    Open    Pseira
57654>>>    Use     Keimeno.dg
57654>>>    Open    Tmplg
INCLUDING FILE: TMPLG.FD
57656>>>    use     saprep.rv
INCLUDING FILE: SAPREP.RV
57656>>>>>//AB/ Project Saprep:sap report
57656>>>>>//AB/ Object prj is a Report_Project
57656>>>>>//AB/     Set ProjectName to "Saprep:sap report"
57656>>>>>//AB/     Set ProjectFileName to "Saprep.RV"
57656>>>>>
57656>>>>>// Project Object Structure
57656>>>>>//   Saprep is a ReportViewSub
57656>>>>>//     ButtonSub3 is a ButtonSub
57656>>>>>//     ButtonSub4 is a ButtonSub
57656>>>>>//     RadioGroupSub1 is a RadioGroupSub
57656>>>>>//       RadioSub1 is a RadioSub
57656>>>>>//       RadioSub2 is a RadioSub
57656>>>>>//       TextBoxSub1 is a TextBoxSub
57656>>>>>//       TextBoxSub2 is a TextBoxSub
57656>>>>>//     Sap_BasicReport is a BasicReport
57656>>>>>//       sysrep_DD is a sysrep_DataDictionary
57656>>>>>
57656>>>>>// Register all objects
57656>>>>>Register_Object ButtonSub3
57656>>>>>Register_Object ButtonSub4
57656>>>>>Register_Object RadioGroupSub1
57656>>>>>Register_Object RadioSub1
57656>>>>>Register_Object RadioSub2
57656>>>>>Register_Object Sap_BasicReport
57656>>>>>Register_Object Saprep
57656>>>>>Register_Object sysrep_DD
57656>>>>>Register_Object TextBoxSub1
57656>>>>>Register_Object TextBoxSub2
57656>>>>>
57656>>>>>
57656>>>>>//AB/ Report View
57656>>>>>
57656>>>>>
57656>>>>>//AB-StoreTopStart
57656>>>>>Use dfallrpt.pkg
57656>>>>>use sysrep.dd
INCLUDING FILE: SYSREP.DD
57656>>>>>>>//DDB-FileStart
57656>>>>>>>//DDB-HeaderStart
57656>>>>>>>
57656>>>>>>>// File Name : SYSREP.DD
57656>>>>>>>// Class Name: Sysrep_DataDictionary
57656>>>>>>>// Revision  : 11
57656>>>>>>>// Version   : 2
57656>>>>>>>
57656>>>>>>>Use  Windows           // Basic Definitions
57656>>>>>>>Use  DataDict          // DataDictionary Class Definition
57656>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
57656>>>>>>>
57656>>>>>>>Open Sysrep
INCLUDING FILE: SYSREP.FD
57658>>>>>>>
57658>>>>>>>//DDB-HeaderEnd
57658>>>>>>>
57658>>>>>>>Class Sysrep_DataDictionary  is a DataDictionary_Sec
57659>>>>>>>
57659>>>>>>>    // Define_Fields:
57659>>>>>>>    // This procedure is used to set up all data-dictionary rules.
57659>>>>>>>
57659>>>>>>>    Procedure Define_Fields
57660>>>>>>>        Forward Send Define_Fields
57662>>>>>>>        //DDB-Generated-Code-Location
57662>>>>>>>        //DDB-DefineFieldStart
57662>>>>>>>
57662>>>>>>>        Set Main_File            To Sysrep.File_Number
57663>>>>>>>        Set Cascade_Delete_State To FALSE
57664>>>>>>>
57664>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
57665>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
57666>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
57667>>>>>>>
57667>>>>>>>        // Field-based properties.......................
57667>>>>>>>
57667>>>>>>>        // Sysrep.View
57667>>>>>>>
57667>>>>>>>        // Sysrep.Descr
57667>>>>>>>
57667>>>>>>>        // Sysrep.Name
57667>>>>>>>
57667>>>>>>>        // Sysrep.Titan
57667>>>>>>>
57667>>>>>>>        // Sysrep.Descr1
57667>>>>>>>
57667>>>>>>>        //DDB-DefineFieldEnd
57667>>>>>>>    End_Procedure    // Define_Fields
57668>>>>>>>
57668>>>>>>>    // Field_Defaults:
57668>>>>>>>    // This procedure is used to establish default field values.
57668>>>>>>>
57668>>>>>>>    Procedure Field_Defaults
57669>>>>>>>        Forward Send Field_Defaults
57671>>>>>>>        //DDB-Generated-Code-Location
57671>>>>>>>        //DDB-FieldDefaultStart
57671>>>>>>>        //DDB-FieldDefaultEnd
57671>>>>>>>    End_Procedure    // Field_Defaults
57672>>>>>>>
57672>>>>>>>End_Class    // Sysrep_DataDictionary
57673>>>>>>>//DDB-FileEnd
57673>>>>>use rvisap.pkg
INCLUDING FILE: RVISAP.PKG
/HEADERSAP_1
Image 2, HEADERSAP_1
!
                                              „Š„‚•Ž‘ „€‚—‹„Œ—Œ „‚‚€”—Œ ’†Œ __/__/____
                                              ------------------------------------------
/Bodysap_1
Image 3, BODYSAP_1
 _____ ______
/totalsap_1
Image 4, TOTALSAP_1
=========================================================================================
¢ãŸ¦ª „šš¨˜­é¤  œ¢˜«é¤  ASCII        __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  ˜¨˜©«˜« ¡é¤ ASCII    __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  „ ©§¨á¥œà¤ ASCII      __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  A§¦Ÿã¡žª   ASCII      __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  A¤˜¢é©œà¤  ASCII      __z___    €•„ˆ—Œ   __z___
=========================================================================================
!
/Footersap_1
Image 5, FOOTERSAP_1
/*
57673>>>>>open company
57675>>>>>open tmpclsap
57677>>>>>open tmppol
57679>>>>>open tmpaxio
57681>>>>>open tmpapoth
57683>>>>>open tmpanal
57685>>>>>//AB-StoreTopEnd
57685>>>>>
57685>>>>>//AB-IgnoreStart
57685>>>>>
57685>>>>>Use Rptvw.Sub
57685>>>>>Use Button.Sub
57685>>>>>Use Rgroup.Sub
57685>>>>>Use Radio.Sub
57685>>>>>Use Txtbox.Sub
57685>>>>>
57685>>>>>//AB-IgnoreEnd
57685>>>>>
57685>>>>>ACTIVATE_VIEW Activate_Saprep FOR Saprep
57689>>>>>
57689>>>>>Object Saprep is a ReportViewSub
57691>>>>>
57691>>>>>    //AB-StoreTopStart
57691>>>>>    property date    pddate             public ''
57693>>>>>    property string pspath              public ''
57695>>>>>    //AB-StoreTopEnd
57695>>>>>
57695>>>>>    Set Label to "„¢œš®¦ª ˜¨˜šé£œ¤à¤ €¨®œåà¤"
57696>>>>>    Set Size to 72 186
57697>>>>>    Set Location to 1 23
57698>>>>>    Set Color to 16744448
57699>>>>>
57699>>>>>    //AB-DDOStart
57699>>>>>
57699>>>>>
57699>>>>>    //AB-DDOEnd
57699>>>>>
57699>>>>>    Object ButtonSub3 is a ButtonSub
57701>>>>>        Set Bitmap to "RUNPROG.BMP"
57702>>>>>        Set Size to 18 27
57703>>>>>        Set Location to 14 91
57704>>>>>        Set Border_Style to Border_StaticEdge
57705>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57706>>>>>
57706>>>>>        //AB-StoreStart
57706>>>>>        Procedure OnClick
57708>>>>>            send startreport
57709>>>>>        End_Procedure
57710>>>>>        
57710>>>>>        
57710>>>>>        
57710>>>>>        //AB-StoreEnd
57710>>>>>
57710>>>>>    End_Object    // ButtonSub3
57711>>>>>
57711>>>>>    Object ButtonSub4 is a ButtonSub
57713>>>>>        Set Bitmap to "CANCEL.BMP"
57714>>>>>        Set Size to 18 27
57715>>>>>        Set Location to 14 130
57716>>>>>        Set Border_Style to Border_StaticEdge
57717>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
57718>>>>>
57718>>>>>        //AB-StoreStart
57718>>>>>        Procedure OnClick
57720>>>>>            Send Request_Cancel
57721>>>>>        End_Procedure
57722>>>>>        
57722>>>>>        //AB-StoreEnd
57722>>>>>
57722>>>>>    End_Object    // ButtonSub4
57723>>>>>
57723>>>>>    Object RadioGroupSub1 is a RadioGroupSub
57725>>>>>
57725>>>>>        //AB-StoreTopStart
57725>>>>>                                                                                                                                                                                                                                                                
57725>>>>>        //AB-StoreTopEnd
57725>>>>>
57725>>>>>        Set Label to "„¡«ç&§à©ž"
57726>>>>>        Set Size to 42 78
57727>>>>>        Set Location to 4 3
57728>>>>>        Object RadioSub1 is a RadioSub
57730>>>>>            Set Size to 10 13
57731>>>>>            Set Location to 12 63
57732>>>>>        End_Object    // RadioSub1
57733>>>>>
57733>>>>>        Object RadioSub2 is a RadioSub
57735>>>>>            Set Size to 10 13
57736>>>>>            Set Location to 28 63
57737>>>>>        End_Object    // RadioSub2
57738>>>>>
57738>>>>>        Object TextBoxSub1 is a TextBoxSub
57740>>>>>            Set Label to "ŽŸæ¤ž :"
57741>>>>>            Set Auto_Size_State to FALSE
57742>>>>>            Set FontSize to 4 0
57743>>>>>            Set Location to 10 5
57744>>>>>            Set Size to 12 45
57745>>>>>            Set TypeFace to "MS Sans Serif"
57746>>>>>            Set Enabled_State to TRUE
57747>>>>>        End_Object    // TextBoxSub1
57748>>>>>
57748>>>>>        Object TextBoxSub2 is a TextBoxSub
57750>>>>>            Set Label to "„¡«¬§à«ãª : "
57751>>>>>            Set Auto_Size_State to FALSE
57752>>>>>            Set FontSize to 4 0
57753>>>>>            Set Location to 24 5
57754>>>>>            Set Size to 12 45
57755>>>>>            Set TypeFace to "MS Sans Serif"
57756>>>>>            Set Enabled_State to TRUE
57757>>>>>        End_Object    // TextBoxSub2
57758>>>>>
57758>>>>>
57758>>>>>        //AB-StoreStart
57758>>>>>        Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
57760>>>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
57762>>>>>            If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
57765>>>>>            Else             Set Output_Device_Mode  To PRINT_TO_PRINTER
57767>>>>>        End_Procedure
57768>>>>>        //AB-StoreEnd
57768>>>>>
57768>>>>>    End_Object    // RadioGroupSub1
57769>>>>>
57769>>>>>
57769>>>>>    //AB-StoreStart
57769>>>>>    Procedure StartReport
57771>>>>>          String  FileName lsdatetor6_1## lsdatefromr6_1## lsctypkinfromr6_1##
57772>>>>>          string lsctypkintor6_1## limonthr6_1## lscustfromr6_1## lscusttor6_1##
57772>>>>>          integer lizeror6_1## iOutputDevice epil##
57772>>>>>          string datehh## datemm## dateyy## dateapo## dateeos##
57772>>>>>    
57772>>>>>          Get Output_Device_Mode To iOutputDevice
57773>>>>>          If iOutputDevice EQ PRINT_TO_WINDOW Begin
57775>>>>>             Make_Temp_File "TXT" FileName
57776>>>>>             Move (".\" - FileName)  To FileName
57777>>>>>             Set Output_Device_Name  To FileName
57778>>>>>          End
57778>>>>>>
57778>>>>>          Else ;          Set Output_Device_Name  To "Lpt1:"
57780>>>>>    
57780>>>>>        Send Run_Report
57781>>>>>         If iOutputDevice EQ PRINT_TO_WINDOW Begin
57783>>>>>             RunProgram background "notepad" FileName
57784>>>>>             EraseFile FileName
57785>>>>>>
57785>>>>>          End
57785>>>>>>
57785>>>>>      End_Procedure
57786>>>>>    
57786>>>>>    
57786>>>>>    
57786>>>>>    
57786>>>>>    Object Sap_BasicReport is a BasicReport
57788>>>>>    
57788>>>>>      Set Report_Title to "„¢œš®¦ª „šš¨˜­é¤ Assci €¨®œåà¤                   "
57789>>>>>      Set Report_Caption to "„¢œš®¦ª €¨®œåà¤  "
57790>>>>>    
57790>>>>>      Set Status_Panel_State  to true
57791>>>>>      Set Display_Error_State to True
57792>>>>>    
57792>>>>>      Object sysrep_DD is a sysrep_DataDictionary
57794>>>>>      End_Object    // tmpanal
57795>>>>>    
57795>>>>>      Set Server To (sysrep_dd(Self))
57796>>>>>    
57796>>>>>      //Breaks and Index for the report
57796>>>>>      Report_Index By Index.1
57798>>>>>    
57798>>>>>      Function Starting_Main_Report Returns Integer
57800>>>>>        Integer iIndexRlog
57801>>>>>        Local Integer iRetVal
57801>>>>>        blankform headersap_1.1
57802>>>>>>
57802>>>>>        blankform bodysap_1.1 thru bodysap_1.2
57803>>>>>>
57803>>>>>        blankform totalsap_1.1 thru totalsap_1.10
57804>>>>>>
57804>>>>>        Forward Get Starting_Main_Report to iRetval
57806>>>>>        Send Find to (sysrep_dd(self)) First_Record 1
57807>>>>>      End_Function
57808>>>>>    
57808>>>>>       Procedure_Section Page_Top as Headersap_1
57813>>>>>          date ddate
57813>>>>>          get pddate to ddate
57814>>>>>          print ddate to headersap_1.1
57815>>>>>          OutPut_PageCheck
57816>>>>>      End_Procedure
57817>>>>>    
57817>>>>>      Procedure_Section  Body as Bodysap_1
57822>>>>>      End_procedure
57823>>>>>    
57823>>>>>      Procedure_Section  total as totalsap_1
57828>>>>>        Integer rVal iMhnas iEtos iHmera iNum  Inum1 ierr
57828>>>>>        string stomeas spath shmera smhnas setos  sstr SFILENAME STYPOS
57828>>>>>        date dAPO
57828>>>>>        move 0 to ierr
57829>>>>>        get pspath to spath
57830>>>>>        get pddate to dAPO
57831>>>>>        clear Company
57832>>>>>        move syscurxr.company_code      to Company.company_code
57833>>>>>        find eq company by index.1
57834>>>>>>
57834>>>>>        move Company.company_c_code0    to stomeas
57835>>>>>        Move (TheDaySegment  (dapo))    to iHmera
57836>>>>>        Move (TheMonthSegment(dapo))    to iMhnas
57837>>>>>        Move (TheYearSegment(dapo))     to ietos
57838>>>>>        Move iHmera                     to sHmera
57839>>>>>        Move iMhnas                     to sMhnas
57840>>>>>        Move iEtos                      to sEtos
57841>>>>>        If (Length(sHmera)=1) Insert '0' in sHmera at 1
57845>>>>>        If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
57849>>>>>        //FI1
57849>>>>>        move 0 to inum
57850>>>>>        move 0 to inum1
57851>>>>>        Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
57852>>>>>         Direct_Input Channel 9 sFileName
57854>>>>>         Readln Channel 9 sStr
57856>>>>>         While (Not(Seqeof))
57860>>>>>             Move (Mid(sstr,2,04))  to stypos
57861>>>>>             move (trim(stypos)) to stypos
57862>>>>>             if (stypos<>'90');                Add 1 to iNum
57865>>>>>             Readln Channel 9 sStr
57867>>>>>         Loop
57868>>>>>>
57868>>>>>         Close_Input Channel 9
57870>>>>>         print iNum to totalsap_1.1
57871>>>>>         clear tmpclsap
57872>>>>>         find gt tmpclsap.recnum
57873>>>>>>
57873>>>>>         while (found)
57877>>>>>             Move (trim(tmpclsap.typos))  to stypos
57878>>>>>             move (trim(stypos)) to stypos
57879>>>>>             if (stypos<>'90');                Add 1 to iNum1
57882>>>>>             find gt tmpclsap.recnum
57883>>>>>>
57883>>>>>         Loop
57884>>>>>>
57884>>>>>         print iNum1 to totalsap_1.2
57885>>>>>         //FI2
57885>>>>>         MOVE 0 TO INUM
57886>>>>>         move 0 to inum1
57887>>>>>         Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
57888>>>>>         Direct_Input Channel 9 sFileName
57890>>>>>         Readln Channel 9 sStr
57892>>>>>         While (Not(Seqeof))
57896>>>>>             Move (Mid(sstr,2,04))  to stypos
57897>>>>>             move (trim(stypos)) to stypos
57898>>>>>             if (stypos='01');                Add 1 to iNum
57901>>>>>             Readln Channel 9 sStr
57903>>>>>         Loop
57904>>>>>>
57904>>>>>         Close_Input Channel 9
57906>>>>>         print iNum to totalsap_1.3
57907>>>>>         clear tmppol
57908>>>>>         find gt tmppol.recnum
57909>>>>>>
57909>>>>>         while (found)
57913>>>>>             Move (trim(tmppol.typos))  to stypos
57914>>>>>             move (trim(stypos)) to stypos
57915>>>>>             if (stypos='01');                Add 1 to iNum1
57918>>>>>             find gt tmppol.recnum
57919>>>>>>
57919>>>>>         Loop
57920>>>>>>
57920>>>>>         print iNum1 to totalsap_1.4
57921>>>>>    
57921>>>>>    
57921>>>>>         //FI3
57921>>>>>         MOVE 0 TO INUM
57922>>>>>         move 0 to inum1
57923>>>>>         Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
57924>>>>>         Direct_Input Channel 9 sFileName
57926>>>>>         Readln Channel 9 sStr
57928>>>>>         While (Not(Seqeof))
57932>>>>>             Move (Mid(sstr,2,04))  to stypos
57933>>>>>             move (trim(stypos)) to stypos
57934>>>>>             if (stypos='01');                Add 1 to iNum
57937>>>>>             Readln Channel 9 sStr
57939>>>>>         Loop
57940>>>>>>
57940>>>>>         Close_Input Channel 9
57942>>>>>         print iNum to totalsap_1.5
57943>>>>>         clear tmpaxio
57944>>>>>         find gt tmpaxio.recnum
57945>>>>>>
57945>>>>>         while (found)
57949>>>>>             Move (trim(tmpaxio.typos))  to stypos
57950>>>>>             move (trim(stypos)) to stypos
57951>>>>>             if (stypos='01');                Add 1 to iNum1
57954>>>>>             find gt tmpaxio.recnum
57955>>>>>>
57955>>>>>         Loop
57956>>>>>>
57956>>>>>         print iNum1 to totalsap_1.6
57957>>>>>         //MM1
57957>>>>>         MOVE 0 TO INUM
57958>>>>>         move 0 to inum1
57959>>>>>         Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
57960>>>>>         Direct_Input Channel 9 sFileName
57962>>>>>         Readln Channel 9 sStr
57964>>>>>         While (Not(Seqeof))
57968>>>>>             Move (Mid(sstr,2,04))  to stypos
57969>>>>>             move (trim(stypos)) to stypos
57970>>>>>             if (stypos='01');                Add 1 to iNum
57973>>>>>             Readln Channel 9 sStr
57975>>>>>         Loop
57976>>>>>>
57976>>>>>         Close_Input Channel 9
57978>>>>>         print iNum to totalsap_1.7
57979>>>>>         clear tmpapoth
57980>>>>>         find gt tmpapoth.recnum
57981>>>>>>
57981>>>>>         while (found)
57985>>>>>             Move (trim(tmpapoth.typos))  to stypos
57986>>>>>             move (trim(stypos)) to stypos
57987>>>>>             if (stypos='01');                Add 1 to iNum1
57990>>>>>             find gt tmpapoth.recnum
57991>>>>>>
57991>>>>>         Loop
57992>>>>>>
57992>>>>>         print iNum1 to totalsap_1.8
57993>>>>>         //PP2
57993>>>>>         MOVE 0 TO INUM
57994>>>>>         move 0 to inum1
57995>>>>>         Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
57996>>>>>         Direct_Input Channel 9 sFileName
57998>>>>>         Readln Channel 9 sStr
58000>>>>>         While (Not(Seqeof))
58004>>>>>             Move (Mid(sstr,2,04))  to stypos
58005>>>>>             move (trim(stypos)) to stypos
58006>>>>>             if (stypos='09');                Add 1 to iNum
58009>>>>>             Readln Channel 9 sStr
58011>>>>>         Loop
58012>>>>>>
58012>>>>>         Close_Input Channel 9
58014>>>>>         print iNum to totalsap_1.9
58015>>>>>         clear tmpanal
58016>>>>>         find gt tmpanal.recnum
58017>>>>>>
58017>>>>>         while (found)
58021>>>>>             Move (trim(tmpanal.typos))  to stypos
58022>>>>>             move (trim(stypos)) to stypos
58023>>>>>             if (stypos='09');                Add 1 to iNum1
58026>>>>>             find gt tmpanal.recnum
58027>>>>>>
58027>>>>>         Loop
58028>>>>>>
58028>>>>>         print iNum1 to totalsap_1.10
58029>>>>>         OutPut_PageCheck
58030>>>>>         if (totalsap_1.1 <> totalsap_1.2) move 1 to ierr
58033>>>>>         if (totalsap_1.3 <> totalsap_1.4) move 2 to ierr
58036>>>>>         if (totalsap_1.5 <> totalsap_1.6) move 3 to ierr
58039>>>>>         if (totalsap_1.7 <> totalsap_1.8) move 4 to ierr
58042>>>>>         if (totalsap_1.9 <> totalsap_1.10) move 5 to ierr
58045>>>>>         if (ierr) begin
58047>>>>>                   if (ierr=1) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ „Š€’—Œ' '‘”€Š‹€'
58050>>>>>              else if (ierr=2) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ —Š†‘„—Œ' '‘”€Š‹€'
58054>>>>>              else if (ierr=3) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ „ˆ‘€„—Œ' '‘”€Š‹€'
58058>>>>>              else if (ierr=4) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ €Ž‡†‰†‘' '‘”€Š‹€'
58062>>>>>              else if (ierr=5) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ €Œ€Š—‘„—Œ ' '‘”€Š‹€'
58066>>>>>         END
58066>>>>>>
58066>>>>>      End_Procedure
58067>>>>>    
58067>>>>>    
58067>>>>>     Procedure Ending_Report
58069>>>>>    
58069>>>>>     End_Procedure
58070>>>>>    
58070>>>>>    End_Object
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    
58071>>>>>    //AB-StoreEnd
58071>>>>>
58071>>>>>End_Object    // Saprep
58072>>>>>
58072>>>>>
58072>>>>>//AB-StoreStart
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>    
58072>>>>>//AB-StoreEnd
58072>>>>>
58072>>>>>//AB/ End_Object    // prj
58072>>>    open    wflagkin
58074>>>    open branchl
INCLUDING FILE: BRANCHL.FD
58076>>>    open    sysrecw
58078>>>    Use vsapexp.vw
INCLUDING FILE: VSAPEXP.VW
58078>>>>>//AB/ Project Vsapexp:eksagogh eggrafon  Sap
58078>>>>>//AB/ Object prj is a View_Project
58078>>>>>//AB/     Set ProjectName to "Vsapexp:eksagogh eggrafon  Sap"
58078>>>>>//AB/     Set ProjectFileName to "vsapexp.VW"
58078>>>>>//AB/     Set GenerateFileName to "NONAME"
58078>>>>>
58078>>>>>// Project Object Structure
58078>>>>>//   Vsapexp is a dbViewSub
58078>>>>>//     Clients_DD is a DataDictionary
58078>>>>>//     Tempitel_DD is a DataDictionary
58078>>>>>//     Tempitem_DD is a DataDictionary
58078>>>>>//     frmapo is a FormSub
58078>>>>>//     frmeos is a FormSub
58078>>>>>//     RadioGroupSub1 is a RadioGroupSub
58078>>>>>//       Radio1 is a RadioSub
58078>>>>>//       Radio3 is a RadioSub
58078>>>>>//       RadioSub1 is a RadioSub
58078>>>>>//       RadioSub4 is a RadioSub
58078>>>>>//       RadioSub5 is a RadioSub
58078>>>>>//       RadioSub6 is a RadioSub
58078>>>>>//       Radio7 is a RadioSub
58078>>>>>//     btnMetasx is a ButtonSub
58078>>>>>//     btnekt is a ButtonSub
58078>>>>>//     frmShow is a ButtonSub
58078>>>>>//     ButtonSub1 is a ButtonSub
58078>>>>>//     Textbox1 is a Textbox
58078>>>>>//     btnPartl is a ButtonSub
58078>>>>>//     frmPath is a FormSub
58078>>>>>//     TextBoxSub1 is a TextBoxSub
58078>>>>>//     Textbox2 is a Textbox
58078>>>>>//     oDirectoryPicker is a OLEDPDlg
58078>>>>>
58078>>>>>// Register all objects
58078>>>>>Register_Object ButtonSub1
58078>>>>>Register_Object btnekt
58078>>>>>Register_Object btnMetasx
58078>>>>>Register_Object btnPartl
58078>>>>>Register_Object Clients_DD
58078>>>>>Register_Object frmapo
58078>>>>>Register_Object frmeos
58078>>>>>Register_Object frmPath
58078>>>>>Register_Object frmShow
58078>>>>>Register_Object oDirectoryPicker
58078>>>>>Register_Object Radio1
58078>>>>>Register_Object Radio3
58078>>>>>Register_Object Radio7
58078>>>>>Register_Object RadioGroupSub1
58078>>>>>Register_Object RadioSub1
58078>>>>>Register_Object RadioSub4
58078>>>>>Register_Object RadioSub5
58078>>>>>Register_Object RadioSub6
58078>>>>>Register_Object Tempitel_DD
58078>>>>>Register_Object Tempitem_DD
58078>>>>>Register_Object TextBoxSub1
58078>>>>>Register_Object Textbox1
58078>>>>>Register_Object Textbox2
58078>>>>>Register_Object Vsapexp
58078>>>>>
58078>>>>>
58078>>>>>//AB/ AppBuild VIEW
58078>>>>>
58078>>>>>
58078>>>>>//AB-StoreTopStart
58078>>>>>open    TmpclSap
58080>>>>>Open    Wapokat
58082>>>>>Open    Wtypkin
58084>>>>>Open    Wcmoves
58086>>>>>Open    sysfile
58088>>>>>Open    codemast
58090>>>>>Open    cities
58092>>>>>Use     rclsap.rv
58092>>>>>Open    Clients
58094>>>>>Use     Vwsap.vw
58094>>>>>Open    Tmpsap
58096>>>>>Open    Tmpaxio
58098>>>>>Open    Tmppol
58100>>>>>Open    Tmpapoth
58102>>>>>Open    Tmpanal
58104>>>>>Open    Cmoves
58106>>>>>Open    Cmovesa
58108>>>>>Open    Cmovesa2
58110>>>>>Open    Cflagkin
58112>>>>>Open    Company
58114>>>>>Open    Branch
58116>>>>>Open    Bmove
58118>>>>>Open    Particle
58120>>>>>Open    Pmovesl
58122>>>>>Open    Pmoves
58124>>>>>Open    Tperga
58126>>>>>Open    Pumps
58128>>>>>Open    Cars
58130>>>>>Open    Units
58132>>>>>Open    Item
58134>>>>>Open    Psxetika
58136>>>>>Open    Tmptehn
58138>>>>>Open    Witemxtr
58140>>>>>Open    Witemxtd
58142>>>>>Open    anprod
58144>>>>>use     ranal.rv
58144>>>>>use     ranal90.rv
58144>>>>>use     rapoth.rv
58144>>>>>use     ranald.rv
58144>>>>>open    itemtehn
58146>>>>>open    itemd
58148>>>>>Open    Pseira
58150>>>>>Use     Keimeno.dg
58150>>>>>Open    Tmplg
58152>>>>>use     saprep.rv
58152>>>>>open    wflagkin
58154>>>>>open branchl
58156>>>>>//AB-StoreTopEnd
58156>>>>>
58156>>>>>//AB-IgnoreStart
58156>>>>>
58156>>>>>Use dbView.Sub
58156>>>>>Use DFAllEnt.pkg
58156>>>>>Use Form.Sub
58156>>>>>Use Rgroup.Sub
58156>>>>>Use Radio.Sub
58156>>>>>Use Button.Sub
58156>>>>>Use Txtbox.Sub
58156>>>>>
58156>>>>>Use CLIENTS.DD
58156>>>>>Use TEMPITEL.DD
INCLUDING FILE: TEMPITEL.DD
58156>>>>>>>//DDB-FileStart
58156>>>>>>>//DDB-HeaderStart
58156>>>>>>>
58156>>>>>>>// File Name : TEMPITEL.DD
58156>>>>>>>// Class Name: Tempitel_DataDictionary
58156>>>>>>>// Revision  : 0
58156>>>>>>>// Version   : 2
58156>>>>>>>
58156>>>>>>>Use  Windows           // Basic Definitions
58156>>>>>>>Use  DataDict          // DataDictionary Class Definition
58156>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
58156>>>>>>>
58156>>>>>>>Open Tempitel
INCLUDING FILE: TEMPITEL.FD
58158>>>>>>>
58158>>>>>>>//DDB-HeaderEnd
58158>>>>>>>open Tempitem
INCLUDING FILE: TEMPITEM.FD
58160>>>>>>>
58160>>>>>>>Set_attribute  DF_FILE_ALIAS of Tempitel.File_number to DF_FILE_IS_ALIAS
58163>>>>>>>Set_attribute  DF_FILE_ALIAS of Tempitem.File_number  to DF_FILE_IS_MASTER
58166>>>>>>>
58166>>>>>>>Class Tempitel_DataDictionary  is a DataDictionary_sec
58167>>>>>>>
58167>>>>>>>    // Define_Fields:
58167>>>>>>>    // This procedure is used to set up all data-dictionary rules.
58167>>>>>>>
58167>>>>>>>    Procedure Define_Fields
58168>>>>>>>        Forward Send Define_Fields
58170>>>>>>>        //DDB-Generated-Code-Location
58170>>>>>>>        //DDB-DefineFieldStart
58170>>>>>>>
58170>>>>>>>        Set Main_File            To Tempitel.File_Number
58171>>>>>>>
58171>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
58172>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
58173>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
58174>>>>>>>
58174>>>>>>>        // Field-based properties.......................
58174>>>>>>>
58174>>>>>>>        // Tempitel.Company_Code
58174>>>>>>>
58174>>>>>>>        // Tempitel.Branch_Code
58174>>>>>>>
58174>>>>>>>        // Tempitel.Year_Year
58174>>>>>>>
58174>>>>>>>        // Tempitel.Item_Code
58174>>>>>>>
58174>>>>>>>        // Tempitel.Witemx_Code
58174>>>>>>>
58174>>>>>>>        // Tempitel.Wax_Recr
58174>>>>>>>
58174>>>>>>>        // Tempitel.Wcmove_Axia
58174>>>>>>>
58174>>>>>>>        // Tempitel.Wcmove_Status_E
58174>>>>>>>
58174>>>>>>>        // Tempitel.Wcmove_Qty
58174>>>>>>>
58174>>>>>>>        // Tempitel.Wcmove_Qty_Exa
58174>>>>>>>
58174>>>>>>>        // Tempitel.Wcmove_Qty_Eisa
58174>>>>>>>
58174>>>>>>>        // Tempitel.Client_Id
58174>>>>>>>
58174>>>>>>>        //DDB-DefineFieldEnd
58174>>>>>>>    End_Procedure    // Define_Fields
58175>>>>>>>
58175>>>>>>>    // Field_Defaults:
58175>>>>>>>    // This procedure is used to establish default field values.
58175>>>>>>>
58175>>>>>>>    Procedure Field_Defaults
58176>>>>>>>        Forward Send Field_Defaults
58178>>>>>>>        //DDB-Generated-Code-Location
58178>>>>>>>        //DDB-FieldDefaultStart
58178>>>>>>>        //DDB-FieldDefaultEnd
58178>>>>>>>    End_Procedure    // Field_Defaults
58179>>>>>>>
58179>>>>>>>End_Class    // Tempitel_DataDictionary
58180>>>>>>>//DDB-FileEnd
58180>>>>>Use Tempitem.DD
INCLUDING FILE: TEMPITEM.DD
58180>>>>>>>//DDB-FileStart
58180>>>>>>>//DDB-HeaderStart
58180>>>>>>>
58180>>>>>>>// File Name : Tempitem.DD
58180>>>>>>>// Class Name: Tempitem_DataDictionary
58180>>>>>>>// Revision  : 0
58180>>>>>>>// Version   : 2
58180>>>>>>>
58180>>>>>>>Use  Windows           // Basic Definitions
58180>>>>>>>Use  DataDict          // DataDictionary Class Definition
58180>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
58180>>>>>>>
58180>>>>>>>Open Tempitem
58182>>>>>>>
58182>>>>>>>//DDB-HeaderEnd
58182>>>>>>>
58182>>>>>>>Class Tempitem_DataDictionary  is a DataDictionary_sec
58183>>>>>>>
58183>>>>>>>    // Define_Fields:
58183>>>>>>>    // This procedure is used to set up all data-dictionary rules.
58183>>>>>>>
58183>>>>>>>    Procedure Define_Fields
58184>>>>>>>        Forward Send Define_Fields
58186>>>>>>>        //DDB-Generated-Code-Location
58186>>>>>>>        //DDB-DefineFieldStart
58186>>>>>>>
58186>>>>>>>        Set Main_File            To Tempitem.File_Number
58187>>>>>>>
58187>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
58188>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
58189>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
58190>>>>>>>
58190>>>>>>>        // Field-based properties.......................
58190>>>>>>>
58190>>>>>>>        // Tempitem.Company_Code
58190>>>>>>>
58190>>>>>>>        // Tempitem.Branch_Code
58190>>>>>>>
58190>>>>>>>        // Tempitem.Year_Year
58190>>>>>>>
58190>>>>>>>        // Tempitem.Item_Code
58190>>>>>>>
58190>>>>>>>        // Tempitem.Witemx_Code
58190>>>>>>>
58190>>>>>>>        // Tempitem.Wax_Recr
58190>>>>>>>
58190>>>>>>>        // Tempitem.Wcmove_Axia
58190>>>>>>>
58190>>>>>>>        // Tempitem.Wcmove_Status_E
58190>>>>>>>
58190>>>>>>>        // Tempitem.Wcmove_Qty
58190>>>>>>>
58190>>>>>>>        // Tempitem.Wcmove_Qty_Exa
58190>>>>>>>
58190>>>>>>>        // Tempitem.Wcmove_Qty_Eisa
58190>>>>>>>
58190>>>>>>>        // Tempitem.Client_Id
58190>>>>>>>
58190>>>>>>>        //DDB-DefineFieldEnd
58190>>>>>>>    End_Procedure    // Define_Fields
58191>>>>>>>
58191>>>>>>>    // Field_Defaults:
58191>>>>>>>    // This procedure is used to establish default field values.
58191>>>>>>>
58191>>>>>>>    Procedure Field_Defaults
58192>>>>>>>        Forward Send Field_Defaults
58194>>>>>>>        //DDB-Generated-Code-Location
58194>>>>>>>        //DDB-FieldDefaultStart
58194>>>>>>>        //DDB-FieldDefaultEnd
58194>>>>>>>    End_Procedure    // Field_Defaults
58195>>>>>>>
58195>>>>>>>End_Class    // Tempitem_DataDictionary
58196>>>>>>>//DDB-FileEnd
58196>>>>>
58196>>>>>//AB-IgnoreEnd
58196>>>>>
58196>>>>>ACTIVATE_VIEW Activate_Vsapexp FOR Vsapexp
58200>>>>>
58200>>>>>Object Vsapexp is a dbViewSub
58202>>>>>
58202>>>>>    //AB-StoreTopStart
58202>>>>>    
58202>>>>>    Property Integer piLathi    Public 0
58204>>>>>    property integer piepil     public 0
58206>>>>>    Property Integer piSfalma   Public 0
58208>>>>>    
58208>>>>>    Register_Object oDirectoryPicker
58208>>>>>    
58208>>>>>    Function Check_Afm_Local String Afm_Num Returns Integer
58210>>>>>        Integer iii Num1 Num2
58211>>>>>    
58211>>>>>        Move (Trim(Afm_Num)) To Afm_Num
58212>>>>>    
58212>>>>>        For iii From 1 To (Length(Trim(Afm_Num)))
58218>>>>>>
58218>>>>>            If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
58221>>>>>        Loop
58222>>>>>>
58222>>>>>    
58222>>>>>        Move (Right(Afm_Num,1)) to Num2
58223>>>>>    
58223>>>>>        If (Length(Afm_Num)<>9) Function_Return 2
58226>>>>>    
58226>>>>>        Move 0 to Num1
58227>>>>>    
58227>>>>>        For iii From 1 to 8
58233>>>>>>
58233>>>>>            Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
58234>>>>>        Loop
58235>>>>>>
58235>>>>>    
58235>>>>>        Move (Mod(Num1,11)) to Num1
58236>>>>>        If (Num1=10) Move 0 to Num1
58239>>>>>    
58239>>>>>        If (Num1=Num2)  Function_Return 0
58242>>>>>        Else            Function_Return 1
58244>>>>>    End_Function
58245>>>>>    
58245>>>>>    Function Validate_AFM String asAFM String asPel Returns Integer
58247>>>>>        Integer rVal iCheck
58248>>>>>        // Elegxos gia sosto AFM
58248>>>>>        Move (Check_AFM(asAFM)) to iCheck
58249>>>>>        If (iCheck=1) Begin
58251>>>>>            Set piLathi to (piLathi(Self)+1)
58252>>>>>            Write   Channel 7 '’¦ €”‹ «¦¬ '
58254>>>>>            Write   Channel 7 (Trim(asPel)+' ')
58256>>>>>            Write   Channel 7 'œå¤˜  ¢˜¤Ÿ˜©£â¤¦'
58258>>>>>            Writeln Channel 7
58260>>>>>            Function_Return 0
58261>>>>>        End
58261>>>>>>
58261>>>>>        Else If (iCheck=2) Begin
58264>>>>>            Set piLathi to (piLathi(Self)+1)
58265>>>>>            Write   Channel 7 '’¦ €”‹ «¦¬ '
58267>>>>>            Write   Channel 7 (Trim(asPel)+' ')
58269>>>>>            Writeln Channel 7 '›œ¤ œå¤˜  9 ¯ã­ ¦'
58272>>>>>            Function_Return 0
58273>>>>>        End
58273>>>>>>
58273>>>>>        Else If (iCheck=3) Begin
58276>>>>>            Set piLathi to (piLathi(Self)+1)
58277>>>>>            Write   Channel 7 '’¦ €”‹ «¦¬ '
58279>>>>>            Write   Channel 7 (Trim(asPel)+' ')
58281>>>>>            Writeln Channel 7 '§œ¨ â®œ  £ž ˜§¦›œ¡«¦çª ®˜¨˜¡«ã¨œª'
58284>>>>>            Function_Return 0
58285>>>>>        End
58285>>>>>>
58285>>>>>        Function_Return 1
58286>>>>>    End_Function
58287>>>>>    
58287>>>>>    //AB-StoreTopEnd
58287>>>>>
58287>>>>>    Set Label to "„¥˜šàšã €¨®œåà¤ œ¢˜«é¤ Š ˜¤ ¡ãª š ˜ SAP"
58288>>>>>    Set Size to 245 405
58289>>>>>    Set Location to 1 9
58290>>>>>
58290>>>>>    //AB-DDOStart
58290>>>>>
58290>>>>>    Object Clients_DD is a Clients_DataDictionary
58292>>>>>
58292>>>>>        //AB-StoreStart
58292>>>>>        
58292>>>>>        //AB-StoreEnd
58292>>>>>
58292>>>>>    End_Object    // Clients_DD
58293>>>>>
58293>>>>>    Object Tempitel_DD is a Tempitel_DataDictionary
58295>>>>>    End_Object    // Tempitel_DD
58296>>>>>
58296>>>>>    Object Tempitem_DD is a Tempitem_DataDictionary
58298>>>>>    End_Object    // Tempitem_DD
58299>>>>>
58299>>>>>    Set Main_DD to (Clients_DD(self))
58300>>>>>    Set Server to (Clients_DD(self))
58301>>>>>
58301>>>>>    //AB-DDOEnd
58301>>>>>
58301>>>>>    Object frmapo is a FormSub
58303>>>>>        Set Size to 13 61
58304>>>>>        Set Location to 11 91
58305>>>>>        Set Label_Col_Offset to 2
58306>>>>>        Set Form_Datatype Item 0 to Mask_Date_Window
58307>>>>>        Set Prompt_Button_Mode to pb_PromptOn
58308>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
58309>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58310>>>>>
58310>>>>>        //AB-StoreStart
58310>>>>>        set prompt_object to (ocalendar(self))
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        
58311>>>>>        //AB-StoreEnd
58311>>>>>
58311>>>>>    End_Object    // frmapo
58312>>>>>
58312>>>>>    Object frmeos is a FormSub
58314>>>>>        Set Size to 13 61
58315>>>>>        Set Location to 11 291
58316>>>>>        Set Label_Col_Offset to 2
58317>>>>>        Set Form_Datatype Item 0 to Mask_Date_Window
58318>>>>>        Set Prompt_Button_Mode to pb_PromptOn
58319>>>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
58320>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58321>>>>>
58321>>>>>        //AB-StoreStart
58321>>>>>        set prompt_object to (ocalendar(self))
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        
58322>>>>>        //AB-StoreEnd
58322>>>>>
58322>>>>>    End_Object    // frmeos
58323>>>>>
58323>>>>>    Object RadioGroupSub1 is a RadioGroupSub
58325>>>>>        Set Size to 105 361
58326>>>>>        Set Location to 33 10
58327>>>>>        Object Radio1 is a RadioSub
58329>>>>>            Set Label to "„¡«ç§à©ž  €¨®œå¦¬ œ¢˜«é¤"
58330>>>>>            Set Size to 10 116
58331>>>>>            Set Location to 10 5
58332>>>>>            Set TextColor to clRed
58333>>>>>        End_Object    // Radio1
58334>>>>>
58334>>>>>        Object Radio3 is a RadioSub
58336>>>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ „ ©§¨á¥œà¤ œ¢˜«é¤"
58337>>>>>            Set Size to 10 152
58338>>>>>            Set Location to 24 5
58339>>>>>        End_Object    // Radio3
58340>>>>>
58340>>>>>        Object RadioSub1 is a RadioSub
58342>>>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ à¢ã©œà¤ œ¢˜«é¤"
58343>>>>>            Set Size to 10 169
58344>>>>>            Set Location to 38 5
58345>>>>>            Set Auto_Size_State to FALSE
58346>>>>>        End_Object    // RadioSub1
58347>>>>>
58347>>>>>        Object RadioSub4 is a RadioSub
58349>>>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ ‰ ¤ã©œà¤ €§¦Ÿã¡žª"
58350>>>>>            Set Size to 10 169
58351>>>>>            Set Location to 52 5
58352>>>>>            Set Auto_Size_State to FALSE
58353>>>>>
58353>>>>>            //AB-StoreStart
58353>>>>>            
58353>>>>>            
58353>>>>>            
58353>>>>>            //AB-StoreEnd
58353>>>>>
58353>>>>>        End_Object    // RadioSub4
58354>>>>>
58354>>>>>        Object RadioSub5 is a RadioSub
58356>>>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ ’œ®¤.¨¦› ˜š¨˜­é¤"
58357>>>>>            Set Size to 10 169
58358>>>>>            Set Location to 64 5
58359>>>>>            Set Auto_Size_State to FALSE
58360>>>>>
58360>>>>>            //AB-StoreStart
58360>>>>>            
58360>>>>>            
58360>>>>>            
58360>>>>>            //AB-StoreEnd
58360>>>>>
58360>>>>>        End_Object    // RadioSub5
58361>>>>>
58361>>>>>        Object RadioSub6 is a RadioSub
58363>>>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ ‰˜«˜¤˜¢é©œà¤"
58364>>>>>            Set Size to 10 169
58365>>>>>            Set Location to 78 5
58366>>>>>            Set Auto_Size_State to FALSE
58367>>>>>
58367>>>>>            //AB-StoreStart
58367>>>>>            
58367>>>>>            
58367>>>>>            //AB-StoreEnd
58367>>>>>
58367>>>>>        End_Object    // RadioSub6
58368>>>>>
58368>>>>>        Object Radio7 is a RadioSub
58370>>>>>            Set Label to "„¡«ç§à©ž  œ¢˜«é¤ £œ ŠáŸ¦ª €.”.‹"
58371>>>>>            Set Size to 12 147
58372>>>>>            Set Location to 91 5
58373>>>>>            Set TextColor to clRed
58374>>>>>        End_Object    // Radio7
58375>>>>>
58375>>>>>
58375>>>>>        //AB-StoreStart
58375>>>>>        
58375>>>>>        Procedure Notify_Select_State integer inewItem integer ioldItem
58377>>>>>            local integer licount
58378>>>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
58380>>>>>            Set piEpil to (iNewItem+1)
58381>>>>>        End_Procedure
58382>>>>>        
58382>>>>>        
58382>>>>>        //AB-StoreEnd
58382>>>>>
58382>>>>>    End_Object    // RadioGroupSub1
58383>>>>>
58383>>>>>    Object btnMetasx is a ButtonSub
58385>>>>>
58385>>>>>        //AB-StoreTopStart
58385>>>>>        
58385>>>>>        //AB-StoreTopEnd
58385>>>>>
58385>>>>>        Set Label to "‹œ«˜©®ž£˜« ©£æª ‘œ ˜¨˜ššœ¢åœª ¨¦£žŸœ¬«é¤"
58386>>>>>        Set Bitmap to "AGGEL.BMP"
58387>>>>>        Set Size to 20 22
58388>>>>>        Set Location to 148 11
58389>>>>>        Set Focus_Mode to Pointer_Only
58390>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
58391>>>>>
58391>>>>>        //AB-StoreStart
58391>>>>>        
58391>>>>>        Set TooltipValue to "„§œ¥œ¨š˜©å˜ „šš¨˜­é¤"
58392>>>>>        
58392>>>>>        Procedure Deixe_Ta_Lathi
58394>>>>>            Integer liLathi
58395>>>>>            Set piLathi to 0
58396>>>>>            send Delete_Data to (EditSub1(Keimeno(Self)))
58397>>>>>            send read to (EditSub1(Keimeno(Self))) 'C:\SapAFM.txt'
58398>>>>>            Send popup to (Keimeno(Self))
58399>>>>>        End_Procedure
58400>>>>>        
58400>>>>>        Procedure OnClick
58402>>>>>            Set Label Of frmShow to ''
58403>>>>>            integer libpo05 listatus retval irecnum  ibpoid ierr  iok iYes icount
58404>>>>>            string msgstr wrecr edate mdate ename mname scodem srecr sdescr  spar
58404>>>>>            date dapod deosd
58404>>>>>            integer iepil
58404>>>>>            get piepil to iepil
58405>>>>>            get value of frmapo to dapod
58406>>>>>            get value of frmeos to deosd
58407>>>>>            REREAD SYSFILE
58411>>>>>            unlock
58412>>>>>>
58412>>>>>            indicate err false
58413>>>>>            If (dapod='') Begin
58415>>>>>                Send Info_Box '† ž£œ¨¦£ž¤å˜ „šš¨˜­é¤ œå¤˜  ¡œ¤ã' '¢ž¨¦­¦¨å˜'
58416>>>>>                Send Activate to frmApo
58417>>>>>                Procedure_Return
58418>>>>>            End
58418>>>>>>
58418>>>>>        //    Clear tmpSap
58418>>>>>        //    Move dapod to tmpSap.Date
58418>>>>>        //    Find Eq tmpSap By Index.1
58418>>>>>        //    If ((Found) And (tmpSap.Kleidomeno=1)) begin
58418>>>>>        //        send info_box '† †£/¤å˜ €¬«ã œå¤˜  ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
58418>>>>>        //        procedure_return
58418>>>>>        //    end
58418>>>>>        //    Get fiSapOK Of vwSap dapod to iOK
58418>>>>>        //    If (iOK<>0) Begin
58418>>>>>        //        If (iOK=1)      Send Info_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '¢ž¨¦­¦¨å˜'
58418>>>>>        //        Else If (iOK=2) Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜¬«ã œå¤˜  ã›ž ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
58418>>>>>        //        Else If (iOK=3) Send Info_Box '¨¦¡ç§«œ  ¡œ¤æ ž£œ¨¦£ž¤ é¤.\n‰á§¦ ˜ §¨¦žš¦ç£œ¤ž ƒ„Œ â«¨œ¥œ' '¢ž¨¦­¦¨å˜'
58418>>>>>        //        Else If (iOK=4) Send Info_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜' '¢ž¨¦­¦¨å˜'
58418>>>>>        //        procedure_return
58418>>>>>        //    end
58418>>>>>        
58418>>>>>            Get YesNo_Box '€¨®åœ  ž „§œ¥œ¨š˜©å˜ „šš¨˜­é¤ !!\nŒ˜ ©¬¤œ®å©à ??' to RetVal
58419>>>>>            If (RetVal =MBR_yes) begin
58421>>>>>                Zerofile TmpclSap
58422>>>>>                Zerofile TmpAxio
58423>>>>>                Zerofile Tmppol
58424>>>>>                Zerofile Tmpapoth
58425>>>>>                Zerofile Tmptehn
58426>>>>>                Zerofile Tmpanal
58427>>>>>                begin_transaction
58428>>>>>        //            Send enhmerose_axio
58428>>>>>        //            Send Enhmerose_polhseis
58428>>>>>        //            Send enhmerose_apoth
58428>>>>>        //            Send enhmerose_itemtehn
58428>>>>>        //            Send enhmerose_anal
58428>>>>>                    Set piLathi to 0
58429>>>>>                    Direct_Output Channel 7 'C:\SapAFM.txt'
58431>>>>>                    Send Ftiakse_Pelates
58432>>>>>                    Close_Output Channel 7
58434>>>>>                    If (piLathi(Self)<>0) Begin
58436>>>>>                        Send Deixe_Ta_Lathi
58437>>>>>                        Get YesNo_Box '“§ã¨¥˜¤ ¢˜¤Ÿ˜©£â¤˜ €”‹.\€¤ ©¬¤œ®å©à, «˜ €”‹ ˜¬«á Ÿ˜ §œ¨á©¦¬¤ £œ ‹ž›œ¤ ¡á ©«¦ SAP.\nŒ˜ ©¬¤œ®å©à ?' to iYes
58438>>>>>                        If (iYes=MBR_NO) Begin
58440>>>>>                            Move MBR_NO to RetVal
58441>>>>>                            Abort_Transaction
58442>>>>>                        End
58442>>>>>>
58442>>>>>                    End
58442>>>>>>
58442>>>>>                    If (RetVal=MBR_YES) Begin
58444>>>>>        
58444>>>>>                    End
58444>>>>>>
58444>>>>>                // ’œ©«á¨¦¬£œ «¦ fi2 š ˜ §œ¨ ««âª œšš¨˜­âª «¨æ£§˜ª
58444>>>>>        
58444>>>>>                end_transaction
58445>>>>>                Unlock
58446>>>>>>
58446>>>>>                Close_Output Channel 7
58448>>>>>                send check_the_records
58449>>>>>            end
58449>>>>>>
58449>>>>>            If (RetVal=MBR_NO) Begin
58451>>>>>                send info_box 'ƒ ˜› ¡˜©å˜ €¡¬¨éŸž¡œ ˜§¦ «¦¤ •¨ã©«ž' '¢ž¨¦­¦¨å˜'
58452>>>>>                Procedure_Return
58453>>>>>            End
58453>>>>>>
58453>>>>>        
58453>>>>>            if ((not(err)) And (RetVal=MBR_YES)) begin
58455>>>>>                Move "„¤ž£â¨à©ž €¨®œåà¤ ¦¢¦¡¢ž¨éŸž¡œ"  to MsgStr
58456>>>>>                Send Info_Box MsgStr
58457>>>>>            end
58457>>>>>>
58457>>>>>            else begin
58458>>>>>                 Move "† › ˜› ¡˜©å˜ ›œ¤ ¦¢¦¡¢ž¨éŸž¡œ ©à©«á" to MsgStr
58459>>>>>                 Send Info_Box MsgStr
58460>>>>>            end
58460>>>>>>
58460>>>>>        End_Procedure // OnClick
58461>>>>>        
58461>>>>>        
58461>>>>>        Procedure Ftiakse_Pelates
58463>>>>>             string srecr scode sstr stomeas  sperioxh segkatastash sperioxhb
58464>>>>>             integer Imet Ikod isok Inum  iyear inai icount
58464>>>>>             date ddate deosd
58464>>>>>             number nxreosh npistosh ntotal nxre npis
58464>>>>>             move 0 to icount
58465>>>>>             get value of frmapo item 0 to ddate
58466>>>>>             get value of frmeos item 0 to deosd
58467>>>>>             move Sysfile.Client_Digits to Ikod
58468>>>>>             move (TheYearSegment(ddate))            to iyear
58469>>>>>             clear Company
58470>>>>>             move syscurxr.company_code to Company.company_code
58471>>>>>             find eq company by index.1
58472>>>>>>
58472>>>>>             move Company.company_c_code0 to stomeas
58473>>>>>             set piLathi to 0
58474>>>>>             move 0 to imet
58475>>>>>             add 3 to ikod // gia na paroyme kai to AX ektos tomea
58476>>>>>             clear branch
58477>>>>>             move syscurxr.company_code to branch.company_code
58478>>>>>             move syscurxr.branch_code  to branch.branch_code
58479>>>>>             find eq branch by index.1
58480>>>>>>
58480>>>>>             move branch.PERIOXH    to sperioxhb
58481>>>>>             clear clients
58482>>>>>        
58482>>>>>             find gt clients by index.6
58483>>>>>>
58483>>>>>             while (found)
58487>>>>>                move 0 to inai
58488>>>>>                IF (clients.client_fpa=1) goto next_clientsdd
58491>>>>>                IF (clients.client_ptyppar<>'113') goto next_clientsdd
58494>>>>>                clear branch
58495>>>>>        
58495>>>>>                move 0 to inai
58496>>>>>                find gt branch by index.1
58497>>>>>>
58497>>>>>        
58497>>>>>                move 0 to nxreosh
58498>>>>>                move 0 to npistosh
58499>>>>>                while (found)
58503>>>>>                    move branch.PERIOXH         to sperioxh
58504>>>>>                    move branch.egkatastash     to segkatastash
58505>>>>>                    clear cmoves
58506>>>>>                    move branch.company_code to cmoves.company_code
58507>>>>>                    move branch.branch_code  to cmoves.branch_code
58508>>>>>                    move iyear               to cmoves.year_year
58509>>>>>                    move '01'                to cmoves.module_from
58510>>>>>                    move clients.client_id   to cmoves.client_id
58511>>>>>                    find gt cmoves by index.13
58512>>>>>>
58512>>>>>                    while ((found) and (branch.company_code=cmoves.company_code) and;                                       (branch.branch_code=cmoves.branch_code)   and;                                       (iyear=cmoves.year_year)                  and;                                       (cmoves.module_from='01')                 and;                                       (clients.client_id=cmoves.client_id))
58516>>>>>                           if ((deosd<>'') and (deosd>cmoves.cmoves_hmnia)) goto fyge_edo
58519>>>>>                           add cmoves.cmoves_x0 to nxreosh
58520>>>>>                           add cmoves.cmoves_p0 to npistosh
58521>>>>>                           fyge_edo:
58521>>>>>                           find gt cmoves by index.13
58522>>>>>>
58522>>>>>                    loop
58523>>>>>>
58523>>>>>                    move (nxreosh-npistosh) to ntotal
58524>>>>>                    add nxreosh to nxre
58525>>>>>                    add npistosh to npis
58526>>>>>                    if (ntotal<>0) move 1 to inai
58529>>>>>                    if (inai=1) begin// prepei na grapso fi2 kai prin allaksei pelaths 1 fora sto fi1 an kinitike
58531>>>>>                        clear tmppol
58532>>>>>                        move 'FI2'                              to TmpPol.onoma
58533>>>>>                        move '01'                               to TmpPol.typos
58534>>>>>                        if (sysrecw.wmoves_rec0=1) move 'TRD1'  to Tmppol.etairia
58537>>>>>                        else move 'idy1'                        to Tmppol.etairia
58539>>>>>                        move segkatastash                       to TmpPol.perioxh
58540>>>>>                        move sPERIOXH                           to TmpPol.egkatastash
58541>>>>>                        move segkatastash                       to TmpPol.tomeas
58542>>>>>                        if (ntotal>0) begin
58544>>>>>                            move '•„—‘’ˆ‰Ž ‘†‹„ˆ—‹€' to tmppol.descr
58545>>>>>                            move 'B200'               to tmppol.type
58546>>>>>                        end
58546>>>>>>
58546>>>>>                        else begin
58547>>>>>                            move 'ˆ‘’—’ˆ‰Ž ‘†‹„ˆ—‹€' to tmppol.descr
58548>>>>>                            move 'B201' to tmppol.type
58549>>>>>                        end
58549>>>>>>
58549>>>>>                        move (trim(clients.client_id))          to scode
58550>>>>>                        Move (Right(scode, Ikod))               To scode
58551>>>>>                        move (replaces('.',scode,'')) to scode
58552>>>>>                        insert '01' in scode at 1
58554>>>>>                        if (Sysfile.Client_Digits<6);                            insert '0' in scode at 5
58558>>>>>                            move (trim(scode))                 to Tmppol.code
58559>>>>>                 //      move tmpaxio.arithmos                   to Tmppol.arithmos
58559>>>>>                       move ddate                              to Tmppol.hmnia
58560>>>>>                       move ''                                 to Tmppol.kodikos
58561>>>>>                       move (abs(ntotal))            to Tmppol.axia
58562>>>>>                       if (ntotal <> 0) begin
58564>>>>>        //                   if (cmoves.cmoves_p0 <> 0);
58564>>>>>        //                       move '_'                        to Tmppol.kinhsh
58564>>>>>                           if (ntotal > 0);                               move  '+'                        to Tmppol.sign
58567>>>>>                           else move '-'                        to Tmppol.sign
58569>>>>>        //                   if (cmoves.cmoves_x0 < 0);
58569>>>>>        //                       move '-'                        to Tmppol.sign
58569>>>>>                        end
58569>>>>>>
58569>>>>>        
58569>>>>>        //                move (trim(tmpaxio.code))              to Tmppol.code
58569>>>>>                        move '01'                      to Tmppol.kodikos2
58570>>>>>                        move clients.client_name       to Tmppol.name
58571>>>>>                        move 'EUR'                              To Tmppol.nomisma
58572>>>>>                        if (ntotal<>0) begin
58574>>>>>                            add 1 to icount
58575>>>>>                            move icount to tmppol.arithmos
58576>>>>>                            saverecord Tmppol
58577>>>>>                        end
58577>>>>>>
58577>>>>>                        move  0 to tmppol.recnum
58578>>>>>                        if (tmppol.type='B200');                            move '00001' to tmppol.kodikos
58581>>>>>                        else if (tmppol.type='B201');                            move '00002' to tmppol.kodikos
58585>>>>>               //         move btypkin.gplan_code_apo1            to Tmppol.kodikos
58585>>>>>                        move ''                                 to tmppol.code
58586>>>>>                        move '03' to tmppol.typos
58587>>>>>                        if (ntotal<>0) begin
58589>>>>>                            move  icount to tmppol.arithmos
58590>>>>>                            saverecord Tmppol
58591>>>>>                        end
58591>>>>>>
58591>>>>>        
58591>>>>>                    end
58591>>>>>>
58591>>>>>                    move 0 to nxreosh
58592>>>>>                    move 0 to npistosh
58593>>>>>                    find gt branch by index.1
58594>>>>>>
58594>>>>>                loop
58595>>>>>>
58595>>>>>                next_clientsdd:
58595>>>>>                if (inai=1) begin
58597>>>>>        
58597>>>>>                    clear TmpclSap
58598>>>>>                    move 'FI1'                              to TmpclSap.onoma
58599>>>>>                    move '01'                               to TmpclSap.typos
58600>>>>>                    if (sysrecw.wmoves_rec0=1) move 'TRD1'  to TmpclSap.etairia
58603>>>>>                    else move 'idy1'                        to TmpclSap.etairia
58605>>>>>                    move sPERIOXHb    to TmpclSap.branch_site
58606>>>>>             //       move stomeas                            to TmpclSap.branch_site
58606>>>>>                    move '0' to TmpclSap.type
58607>>>>>        
58607>>>>>                    move (trim(clients.client_id))          to Tmpclsap.oldcode
58608>>>>>                    move (trim(clients.client_id))          to scode
58609>>>>>                    Move (Right(scode, Ikod))               To scode
58610>>>>>                    move (replaces('.',scode,'')) to scode
58611>>>>>                    insert '01' in scode at 1
58613>>>>>                    if (Sysfile.Client_Digits<6);                        insert '0' in scode at 5
58617>>>>>                    move (trim(scode))                      to TmpclSap.code
58618>>>>>                    if (sysrecw.wmoves_rec0=1) move 'MB01'  to TmpclSap.group
58621>>>>>                    else move 'MB00'                        to TmpclSap.group
58623>>>>>        
58623>>>>>                    if (clients.endoomil='1');                         move 'CSTIT'  to Tmpclsap.endoomil
58626>>>>>                    else;                         move ''       to Tmpclsap.endoomil
58628>>>>>        
58628>>>>>                    if (clients.is_xondr='1')     move '1'      to Tmpclsap.anal
58631>>>>>                    else                          move '2'      to Tmpclsap.anal
58633>>>>>                    If (sysfile.company_name='1') move '1'      to Tmpclsap.anal
58636>>>>>        
58636>>>>>                         if (clients.npdd         ='1') move 'B4'   to Tmpclsap.category
58639>>>>>                    else if (clients.custprom_code='1') move 'B3'   to Tmpclsap.category
58643>>>>>                    else if (clients.is_xondr     ='1') move 'B1'   to Tmpclsap.category
58647>>>>>                    else                                move 'B2'   to Tmpclsap.category
58649>>>>>        //            If ((sysfile.company_name='1') and (clients.anal='1')) move 'B2'  to Tmpclsap.category
58649>>>>>                    move clients.client_afm                         to Tmpclsap.afm
58650>>>>>                    Get Validate_Afm tmpCLSAP.AFM tmpCLSAP.oldcode  to isOk
58651>>>>>                    If (isOK=0) Move '000000000'                    to Tmpclsap.afm
58654>>>>>        
58654>>>>>                    clear Codemast
58655>>>>>                    move 'DOY' to   codemast.type
58656>>>>>                    move clients.client_doy to codemast.code
58657>>>>>                    find eq codemast by index.1
58658>>>>>>
58658>>>>>                    move (trim(codemast.description))       to Tmpclsap.doy
58659>>>>>                    move (trim(clients.client_name))        to Tmpclsap.name
58660>>>>>                    clear Codemast
58661>>>>>                    move 'JOB' to codemast.type
58662>>>>>                    move clients.client_job to codemast.code
58663>>>>>                    find eq codemast by index.1
58664>>>>>>
58664>>>>>                    move (trim(codemast.description))       to Tmpclsap.occup
58665>>>>>                    clear cities
58666>>>>>                    move clients.client_city_id to cities.city_id
58667>>>>>                    find eq cities by index.1
58668>>>>>>
58668>>>>>                    move (trim(cities.city_descr))          to Tmpclsap.city
58669>>>>>                    move (trim(clients.client_address))     to sstr
58670>>>>>                    move (replaces('  ',sStr,'')) to sStr
58671>>>>>                    move (trim(sStr)) to Tmpclsap.address
58672>>>>>                    move (trim(clients.client_add_no))      to Tmpclsap.add_no
58673>>>>>                    move (trim(clients.client_zipcode))     to Tmpclsap.zipcode
58674>>>>>        
58674>>>>>                    If (length(trim(tmpclsap.zipcode))<>5) Move '00000' to Tmpclsap.zipcode
58677>>>>>                    move (trim(clients.client_phone))       to Tmpclsap.telfax
58678>>>>>                    move 'GR'                               to Tmpclsap.country
58679>>>>>                    move 'EL'                               TO Tmpclsap.language
58680>>>>>                    saverecord Tmpclsap
58681>>>>>                    add 1 to Imet
58682>>>>>                    Set Label Of frmShow to ('œ¢á«œª' + '-' + String(iMet)+'-'+String(scode))
58683>>>>>                    move 1 to clients.client_public
58684>>>>>                    saverecord clients
58685>>>>>        
58685>>>>>                end
58685>>>>>>
58685>>>>>                find gt clients by index.6
58686>>>>>>
58686>>>>>            Loop
58687>>>>>>
58687>>>>>            clear TmpclSap
58688>>>>>            move 'FI1'                              to TmpclSap.onoma
58689>>>>>            move 90                                 to TmpclSap.typos
58690>>>>>            if (sysrecw.wmoves_rec0=1) move 'TRD1'  to TmpclSap.etairia
58693>>>>>            else move 'idy1'                        to TmpclSap.etairia
58695>>>>>        //    move 'DMK1'                             to TmpclSap.etairia
58695>>>>>            move stomeas                            to TmpclSap.branch_site
58696>>>>>            move Imet                               to Tmpclsap.afm
58697>>>>>            move 'GR'                               to Tmpclsap.country
58698>>>>>            move 'EL'                               TO Tmpclsap.language
58699>>>>>            saverecord Tmpclsap
58700>>>>>        End_Procedure
58701>>>>>        
58701>>>>>        Procedure enhmerose_axio
58703>>>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo stomeas
58704>>>>>             integer Imet Ikod ienhsap isChecked
58704>>>>>             number nmetrhta nepitages nsynal nembasma nposo
58704>>>>>             date dapod ddate dkenhdate
58704>>>>>             string soroi sclient msgstr sclientid lsTheAppPath
58704>>>>>             get value of frmapo to dapod
58705>>>>>             move '01/01/2005' to ddate
58706>>>>>             move '01/01/1753' to dkenhdate
58707>>>>>             move Sysfile.Client_Digits to Ikod
58708>>>>>             add 3 to ikod // gia na paroyme kai to AX ektos yomea
58709>>>>>             clear Company
58710>>>>>             move syscurxr.company_code to Company.company_code
58711>>>>>             find eq company by index.1
58712>>>>>>
58712>>>>>             move Company.company_c_code0 to stomeas
58713>>>>>        
58713>>>>>             clear cmoves
58714>>>>>             find gt cmoves by 16
58715>>>>>>
58715>>>>>             while ((found) and (cmoves.sap_hmnia=''))
58719>>>>>                move '' to sclientid
58720>>>>>                move 0 to ienhsap
58721>>>>>                if  (cmoves.cmoves_hmnia  > dapod);                    goto nextcmovesdd
58724>>>>>                if (cmoves.barticl_recr='');                    goto nextcmovesdd
58727>>>>>                if (syscurxr.company_code<>cmoves.company_code);                    goto nextcmovesdd
58730>>>>>        
58730>>>>>                //gts 03-12-07 ‰ ¤ã©œ ª §¦¬ œå¤˜  locked ¡˜  ž ž£/¤å˜ «žª ¡å¤ž©žª œ ©§¨á¥œà¤ => «žª ž£/¤å˜ª
58730>>>>>                //¡¢œ ›é£˜«¦ª §¨â§œ  ¤˜ §¨¦©§œ¨¤ ¦ç¤«œ
58730>>>>>                if (cmoves.barticl_recr<>'') begin
58732>>>>>                    clear barticl
58733>>>>>                    move cmoves.barticl_recr to barticl.barticl_recr
58734>>>>>                    find eq barticl by index.2
58735>>>>>>
58735>>>>>                    if (found) begin
58737>>>>>                        If (barticl.ekkremes=1) goto nextcmovesdd
58740>>>>>                        relate barticl
58741>>>>>                        if (btypkin.locked=1) begin
58743>>>>>                            if (btypkin.locked_date<>'');                                if (cmoves.cmoves_hmnia ge btypkin.locked_date);                                    goto nextcmovesdd
58748>>>>>                        End
58748>>>>>>
58748>>>>>                    end
58748>>>>>>
58748>>>>>                End
58748>>>>>>
58748>>>>>                clear branch
58749>>>>>                move Cmoves.company_code    to branch.company_code
58750>>>>>                move cmoves.branch_code     to branch.branch_code
58751>>>>>                find eq branch by index.1
58752>>>>>>
58752>>>>>                move branch.PERIOXH         to sperioxh
58753>>>>>                move branch.egkatastash     to segkatastash
58754>>>>>        
58754>>>>>                clear TmpAxio
58755>>>>>                move 'FI3'                              to Tmpaxio.onoma
58756>>>>>                move '01'                               to Tmpaxio.typos
58757>>>>>                move 'TRD1'                             to Tmpaxio.etairia
58758>>>>>                move sPERIOXH                           to Tmpaxio.perioxh
58759>>>>>                move segkatastash                       to Tmpaxio.egkatastash
58760>>>>>                move segkatastash                       to Tmpaxio.tomeas
58761>>>>>        
58761>>>>>                relate cmoves
58762>>>>>                if (clients.is_xondr='1');                     move '01' to Tmpaxio.anal
58765>>>>>                else;                     move '02' to Tmpaxio.anal
58767>>>>>                If (sysfile.company_name='1') move '01'      to Tmpaxio.anal
58770>>>>>                if ((clients.status='') and (clients.sap_hmnia<=ddate)) begin
58772>>>>>                    move 1 to ienhsap
58773>>>>>                    move cmoves.client_id to sclientid
58774>>>>>                    if (clients.client_ptyppar='') begin
58776>>>>>                       move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå §˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž = ' to msgstr
58777>>>>>                       append msgstr clients.client_id
58778>>>>>                       error 3330 msgstr
58779>>>>>>
58779>>>>>                    end
58779>>>>>>
58779>>>>>                    if (clients.client_ptyppar='100') begin
58781>>>>>                            move '' to msgstr
58782>>>>>                            if (clients.is_xondr<>'1') begin
58784>>>>>                                move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
58785>>>>>                                append msgstr clients.client_id
58786>>>>>                                error 3333 msgstr
58787>>>>>>
58787>>>>>                            end
58787>>>>>>
58787>>>>>                    end
58787>>>>>>
58787>>>>>                    else begin
58788>>>>>                            if (clients.client_ptyppar<>'113') begin
58790>>>>>                                move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
58791>>>>>                                append msgstr clients.client_id
58792>>>>>                                error 3334 msgstr
58793>>>>>>
58793>>>>>                            end
58793>>>>>>
58793>>>>>                    end
58793>>>>>>
58793>>>>>                end
58793>>>>>>
58793>>>>>        
58793>>>>>                move (trim(ctypkin.sub))                to stype
58794>>>>>                if (stype='');                    goto nextcmovesdd
58797>>>>>                insert 'B' in stype at 1
58799>>>>>                move (trim(stype))                      to Tmpaxio.type
58800>>>>>        
58800>>>>>                clear bmove
58801>>>>>                move cmoves.custprom_code to bmove.bmove_recr
58802>>>>>                find eq bmove by index.2
58803>>>>>>
58803>>>>>                move bmove.barticl_no                   to Tmpaxio.arithmos
58804>>>>>                move cmoves.cmoves_hmnia                to Tmpaxio.hmnia
58805>>>>>                move '' to sper
58806>>>>>                clear cflagkin
58807>>>>>                move cmoves.ctypkin_code to cflagkin.ctypkin_code
58808>>>>>                find gt cflagkin by index.1
58809>>>>>>
58809>>>>>                while ((found) and (cmoves.ctypkin_code=cflagkin.ctypkin_code))
58813>>>>>                         if (trim(cflagkin.cflagkin_flag)='91') move '1' to sper
58816>>>>>                    else if (trim(cflagkin.cflagkin_flag)='92') move '2' to sper
58820>>>>>                    else if (trim(cflagkin.cflagkin_flag)='93') move '3' to sper
58824>>>>>                    else if (trim(cflagkin.cflagkin_flag)='94') move '4' to sper
58828>>>>>                    find gt cflagkin by index.1
58829>>>>>>
58829>>>>>                Loop
58830>>>>>>
58830>>>>>                move (trim(sper))                            to Tmpaxio.perigrafh
58831>>>>>                     if (sper='1') add cmoves.cmoves_axia    to nmetrhta
58834>>>>>                else if (sper='2') add cmoves.cmoves_axia    to nepitages
58838>>>>>                else if (sper='3') add cmoves.cmoves_axia    to nsynal
58842>>>>>                else if (sper='4') add cmoves.cmoves_axia    to nembasma
58846>>>>>                move cmoves.cmoves_axia                      to Tmpaxio.axia
58847>>>>>        
58847>>>>>                //gts 13-03-08
58847>>>>>                // ©ç¤¦¢˜ ˜¤á œš¡˜«á©«˜©ž
58847>>>>>        
58847>>>>>                move (trim(cmoves.client_id))           to scode
58848>>>>>                Move (Right(scode, Ikod))               To scode
58849>>>>>                move (replaces('.',scode,'')) to scode
58850>>>>>                insert '01' in scode at 1
58852>>>>>                if (Sysfile.Client_Digits<6);                    insert '0' in scode at 5
58856>>>>>                move (trim(scode))                      to TmpAxio.code
58857>>>>>                move (trim(cmoves.client_name))         to TmpAxio.apodekths
58858>>>>>                move '„¤˜¤«  ¢¦š˜¨ ˜©£¦¬'              to TmpAxio.Aitiol
58859>>>>>                if (sper='1') begin
58861>>>>>                    move ''                             to Tmpaxio.lhxh
58862>>>>>                    move ''                             to Tmpaxio.bank
58863>>>>>                    move ''                             to Tmpaxio.ekdoths
58864>>>>>                    move ''                             to Tmpaxio.noepit
58865>>>>>                    move ''                             to Tmpaxio.xora
58866>>>>>                    move ''                             to Tmpaxio.idioy
58867>>>>>                    move ''                             to Tmpaxio.eparxia
58868>>>>>                end
58868>>>>>>
58868>>>>>                else begin
58869>>>>>                    Relate Bmove
58870>>>>>                    move Baxio.baxio_hmnial             to Tmpaxio.lhxh
58871>>>>>                    move baxio.baxio_banka              to Tmpaxio.bank
58872>>>>>                    move (trim(baxio.baxio_ekdothse))   to Tmpaxio.ekdoths
58873>>>>>                    move (trim(baxio.baxio_no))         to Tmpaxio.noepit
58874>>>>>                    move 'GR'                           to Tmpaxio.xora
58875>>>>>                    if (baxio.baxio_from='0') move '1'  to Tmpaxio.idioy
58878>>>>>                    else if (baxio.baxio_from='1') move '2' to Tmpaxio.idioy
58882>>>>>                    else if (baxio.baxio_from='')  move ''  to Tmpaxio.idioy
58886>>>>>                    if (baxio.baxio_topos='0') move '2'  to Tmpaxio.eparxia
58889>>>>>                    else if (baxio.baxio_topos='1') move '1' to Tmpaxio.eparxia
58893>>>>>                    else if (baxio.baxio_topos='')  move ''  to Tmpaxio.eparxia
58897>>>>>        
58897>>>>>                end
58897>>>>>>
58897>>>>>                move 'EUR'                              To Tmpaxio.nomisma
58898>>>>>                move barticl.pae_arithm                 to tmpaxio.pae_arithm
58899>>>>>                move barticl.pae_hmnia                  to tmpaxio.pae_hmnia
58900>>>>>                If ((tmpaxio.type = 'B200') or (tmpaxio.type = 'B201')) BEGIN
58902>>>>>                   if (btypkin.gplan_code_apo1 <> '') begin
58904>>>>>                       clear tmppol
58905>>>>>                       move 'FI2'                              to TmpPol.onoma
58906>>>>>                       move '01'                               to TmpPol.typos
58907>>>>>                       move 'TRD1'                             to TmpPol.etairia
58908>>>>>                       move segkatastash                       to TmpPol.perioxh
58909>>>>>                       move sPERIOXH                           to TmpPol.egkatastash
58910>>>>>                       move segkatastash                       to TmpPol.tomeas
58911>>>>>                       move btypkin.btypkin_descr              to tmppol.descr
58912>>>>>                       move tmpaxio.type                       to tmppol.type
58913>>>>>                       move tmpaxio.arithmos                   to Tmppol.arithmos
58914>>>>>                       move tmpaxio.hmnia                      to Tmppol.hmnia
58915>>>>>                       MOVE barticl.sxolia1                    to tmppol.sxolia
58916>>>>>                       move ''                                 to Tmppol.kodikos
58917>>>>>                       move tmpaxio.axia                       to Tmppol.axia
58918>>>>>                       if (Tmppol.axia <> 0) begin
58920>>>>>                           if (cmoves.cmoves_p0 <> 0);                               move '_'                        to Tmppol.kinhsh
58923>>>>>                           if (cmoves.cmoves_p0 < 0);                               move '-'                        to Tmppol.sign
58926>>>>>                           if (cmoves.cmoves_x0 <> 0);                               move ''                        to Tmppol.kinhsh
58929>>>>>                           if (cmoves.cmoves_x0 < 0);                               move '-'                        to Tmppol.sign
58932>>>>>                        end
58932>>>>>>
58932>>>>>        
58932>>>>>                        move (trim(tmpaxio.code))              to Tmppol.code
58933>>>>>                        move tmpaxio.anal                      to Tmppol.kodikos2
58934>>>>>                        move tmpaxio.apodekths                 to Tmppol.name
58935>>>>>                        Clear Tperga
58936>>>>>                        move barticl.cn_code  to tperga.cn_code
58937>>>>>                        find gt tperga by index.1
58938>>>>>>
58938>>>>>                        while ((found) and (barticl.cn_code=tperga.cn_code))
58942>>>>>                            if ((tperga.xarhtos_meres<>0) and (tperga.plhroteo_meres<>0)) begin
58944>>>>>                                move '' to soroi
58945>>>>>                                move tperga.xarhtos_meres to soroi
58946>>>>>                                insert tperga.plhroteo_meres in soroi at 3
58948>>>>>                                move (trim(soroi)) to soroi
58949>>>>>                            end
58949>>>>>>
58949>>>>>                            find gt tperga by index.1
58950>>>>>>
58950>>>>>                        loop
58951>>>>>>
58951>>>>>                        move soroi                              to Tmppol.Oroi
58952>>>>>                        move 'EUR'                              To Tmppol.nomisma
58953>>>>>                        saverecord Tmppol
58954>>>>>                        move  0 to tmppol.recnum
58955>>>>>                        if (tmpaxio.type='B200');                            move '00001' to tmppol.kodikos
58958>>>>>                        else if (tmpaxio.type='B201');                            move '00002' to tmppol.kodikos
58962>>>>>               //         move btypkin.gplan_code_apo1            to Tmppol.kodikos
58962>>>>>                        move ''                                 to tmppol.code
58963>>>>>                        move '03' to tmppol.typos
58964>>>>>                        saverecord tmppol
58965>>>>>        
58965>>>>>                   End
58965>>>>>>
58965>>>>>                End
58965>>>>>>
58965>>>>>                else begin
58966>>>>>                    saverecord TmpAxio
58967>>>>>                    add 1 to Imet
58968>>>>>                end
58968>>>>>>
58968>>>>>        
58968>>>>>                nextcmovesdd:
58968>>>>>                Set Label Of frmShow to ('€¥ æš¨˜­˜' + '-' + String(iMet)+'-'+String(cmoves.cmoves_hmnia))
58969>>>>>                if (ienhsap=1) begin
58971>>>>>                    clear clients
58972>>>>>                    move sclientid to clients.client_id
58973>>>>>                    find eq clients by index.6
58974>>>>>>
58974>>>>>                    if (found=1) begin
58976>>>>>                        move dkenhdate to clients.sap_hmnia
58977>>>>>                        saverecord clients
58978>>>>>                    end
58978>>>>>>
58978>>>>>                end
58978>>>>>>
58978>>>>>                find gt cmoves by 16
58979>>>>>>
58979>>>>>        
58979>>>>>             Loop
58980>>>>>>
58980>>>>>                clear TmpAxio
58981>>>>>                move segkatastash                       to Tmpaxio.EGKATASTASH
58982>>>>>                move ''                                 to tmpaxio.anal
58983>>>>>                move 'FI3'                              to Tmpaxio.onoma
58984>>>>>                move '90'      to Tmpaxio.typos
58985>>>>>                move 'TRD1'                             to Tmpaxio.etairia
58986>>>>>                MOVE STOMEAS                            to Tmpaxio.perioxh
58987>>>>>                move '9999'                             to Tmpaxio.type
58988>>>>>                move '9999999999'                       to Tmpaxio.arithmos
58989>>>>>            move '1'                                to Tmpaxio.perigrafh
58990>>>>>            move nmetrhta                           to Tmpaxio.axia
58991>>>>>            saverecord TmpAxio
58992>>>>>            clear TmpAxio
58993>>>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
58994>>>>>            move 'FI3'                              to Tmpaxio.onoma
58995>>>>>            move ''                                 to tmpaxio.anal
58996>>>>>            MOVE STOMEAS                           to Tmpaxio.perioxh
58997>>>>>            move '91'                               to Tmpaxio.typos
58998>>>>>            move 'TRD1'                             to Tmpaxio.etairia
58999>>>>>            move '9999'                             to Tmpaxio.type
59000>>>>>            move '9999999999'                       to Tmpaxio.arithmos
59001>>>>>            move '2'                                to Tmpaxio.perigrafh
59002>>>>>            move nepitages                          to Tmpaxio.axia
59003>>>>>            move 'EUR'                              To Tmpaxio.nomisma
59004>>>>>            saverecord TmpAxio
59005>>>>>            clear TmpAxio
59006>>>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
59007>>>>>            move 'FI3'                              to Tmpaxio.onoma
59008>>>>>            move '92'                               to Tmpaxio.typos
59009>>>>>            move ''                                 to tmpaxio.anal
59010>>>>>            move 'TRD1'                             to Tmpaxio.etairia
59011>>>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
59012>>>>>            move '9999'                             to Tmpaxio.type
59013>>>>>            move '9999999999'                       to Tmpaxio.arithmos
59014>>>>>            move '3'                                to Tmpaxio.perigrafh
59015>>>>>            move nsynal                             to Tmpaxio.axia
59016>>>>>            move 'EUR'                              To Tmpaxio.nomisma
59017>>>>>            saverecord TmpAxio
59018>>>>>            clear TmpAxio
59019>>>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
59020>>>>>            move 'FI3'                              to Tmpaxio.onoma
59021>>>>>        
59021>>>>>            move '93'                               to Tmpaxio.typos
59022>>>>>            move 'TRD1'                             to Tmpaxio.etairia
59023>>>>>            move '9999'                             to Tmpaxio.type
59024>>>>>            move ''                                 to tmpaxio.anal
59025>>>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
59026>>>>>            move '9999999999'                       to Tmpaxio.arithmos
59027>>>>>            move '4'                                to Tmpaxio.perigrafh
59028>>>>>            move nembasma                           to Tmpaxio.axia
59029>>>>>            move 'EUR'                              To Tmpaxio.nomisma
59030>>>>>            saverecord TmpAxio
59031>>>>>            clear TmpAxio
59032>>>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
59033>>>>>            move 'FI3'                              to Tmpaxio.onoma
59034>>>>>            move '94'                               to Tmpaxio.typos
59035>>>>>            move ''                                 to tmpaxio.anal
59036>>>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
59037>>>>>            move 'TRD1'                             to Tmpaxio.etairia
59038>>>>>            move '9999'                             to Tmpaxio.type
59039>>>>>            move '9999999999'                       to Tmpaxio.arithmos
59040>>>>>            move imet                               to Tmpaxio.axia
59041>>>>>            saverecord TmpAxio
59042>>>>>        
59042>>>>>        End_Procedure
59043>>>>>        
59043>>>>>        
59043>>>>>        Procedure enhmerose_polhseis
59045>>>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo SSIGN sptyp
59046>>>>>             string stomeas soroi scmoves skod sitem spar sparast skodikos sclientid spmsrecr  spartlrecr
59046>>>>>             NUMBER npartlfpa npmsfpa
59046>>>>>             integer Imet Ikod  irecnum  ino ienhsap iarnhtika
59046>>>>>             number  ntot nfpa nnet nqty nhqty
59046>>>>>             date dapod ddate dkenhdate
59046>>>>>             string msgstr
59046>>>>>             move '01/01/2005' to ddate
59047>>>>>             move '01/01/1753' to dkenhdate
59048>>>>>             clear tmppol
59049>>>>>             find gt tmppol.recnum
59050>>>>>>
59050>>>>>             while (found)
59054>>>>>                if (tmppol.typos='01');                    add tmppol.axia to ntot
59057>>>>>                find gt tmppol.recnum
59058>>>>>>
59058>>>>>             Loop
59059>>>>>>
59059>>>>>             get value of frmapo to dapod
59060>>>>>             move Sysfile.Client_Digits to Ikod
59061>>>>>             add 3 to ikod // gia na paroyme kai to AX ektos yomea
59062>>>>>             clear Company
59063>>>>>             move syscurxr.company_code to Company.company_code
59064>>>>>             find eq company by index.1
59065>>>>>>
59065>>>>>             move Company.company_c_code0 to stomeas
59066>>>>>             clear Particle
59067>>>>>             find gt particle by 17
59068>>>>>>
59068>>>>>             while ((found) and (particle.sap_hmnia = ''))
59072>>>>>                if  (particle.partl_hmnia  > dapod);                    goto nextpmovesdd
59075>>>>>                if (syscurxr.company_code<>particle.company_code);                    goto nextpmovesdd
59078>>>>>                if (particle.partl_no < 1);                    goto nextpmovesdd
59081>>>>>                move '' to sclientid
59082>>>>>                move 0 to ienhsap
59083>>>>>                clear tempitem
59084>>>>>                find gt tempitem.recnum
59085>>>>>>
59085>>>>>                while (found)
59089>>>>>                    delete tempitem
59090>>>>>                    find gt tempitem.recnum
59091>>>>>>
59091>>>>>                Loop
59092>>>>>>
59092>>>>>        
59092>>>>>                clear tmplg
59093>>>>>                find gt tmplg.recnum
59094>>>>>>
59094>>>>>                while (found)
59098>>>>>                    delete tmplg
59099>>>>>                    find gt tmplg.recnum
59100>>>>>>
59100>>>>>                Loop
59101>>>>>>
59101>>>>>                move 0 to npartlfpa
59102>>>>>                move 0 to npmsfpa
59103>>>>>                clear branch
59104>>>>>                move particle.company_code to branch.company_code
59105>>>>>                move particle.branch_code  to branch.branch_code
59106>>>>>                find eq branch by index.1
59107>>>>>>
59107>>>>>        
59107>>>>>        
59107>>>>>                move branch.PERIOXH            to sperioxh
59108>>>>>                move branch.egkatastash        to segkatastash
59109>>>>>                move particle.partl_recr                to srecr
59110>>>>>             //   move particle.partl_vatam      to npartlfpa
59110>>>>>                clear TmpPol
59111>>>>>                MOVE '' to  ssign
59112>>>>>                move 'FI2'                              to TmpPol.onoma
59113>>>>>                move '01'                               to TmpPol.typos
59114>>>>>                move 'TRD1'                             to TmpPol.etairia
59115>>>>>                move segkatastash                       to TmpPol.perioxh
59116>>>>>                move sPERIOXH                           to TmpPol.egkatastash
59117>>>>>                move segkatastash                       to TmpPol.tomeas
59118>>>>>                relate Particle
59119>>>>>                if (trim(ptyppar.sap)='');                    goto nextpmovesdd
59122>>>>>                IF (clients.client_fpa=1);                    goto nextpmovesdd
59125>>>>>        
59125>>>>>        
59125>>>>>                move (trim(ptyppar.ptyppar_descr))      to Tmppol.descr
59126>>>>>                move (trim(Ptyppar.ptyppar_code))       to stype
59127>>>>>                move '' to spartlrecr
59128>>>>>                move '' to sptyp
59129>>>>>                if (ptyppar.sub='1') insert 'C' in stype at 1
59133>>>>>                else insert 'B' in stype at 1
59136>>>>>                if (stype<>'C') begin
59138>>>>>                    clear psxetika
59139>>>>>                    move particle.partl_recr to spartlrecr
59140>>>>>                    move spartlrecr to psxetika.psx_partl_recr
59141>>>>>                    find gt psxetika by index.3
59142>>>>>>
59142>>>>>                    while ((found) and (spartlrecr=psxetika.psx_partl_recr))
59146>>>>>                        move psxetika.ptyppar_code to sptyp
59147>>>>>                        clear ptypparl
59148>>>>>                        move particle.company_code to ptypparl.company_code
59149>>>>>                        move particle.branch_code  to ptypparl.branch_code
59150>>>>>                        move sptyp                 to ptypparl.ptyppar_code
59151>>>>>                        find eq ptypparl by index.1
59152>>>>>>
59152>>>>>                        if (found) begin
59154>>>>>                           if (ptypparl.sub='1') begin
59156>>>>>                                move '' to stype
59157>>>>>                                move (trim(Ptyppar.ptyppar_code))       to stype
59158>>>>>                                insert 'C' in stype at 1
59160>>>>>                           end
59160>>>>>>
59160>>>>>                        End
59160>>>>>>
59160>>>>>                        find gt psxetika by index.3
59161>>>>>>
59161>>>>>                    Loop
59162>>>>>>
59162>>>>>        
59162>>>>>                end
59162>>>>>>
59162>>>>>        
59162>>>>>                move (trim(stype))                      to Tmppol.type
59163>>>>>                move '' to spar
59164>>>>>                // gts 1/10/08 ž«ãŸž¡œ ¤˜ šå¤œ«˜  export ¡˜  ž ©œ ¨á
59164>>>>>                //move particle.pseira_seira              to tmppol.sxrecr
59164>>>>>                sTRING S1 S2 s3
59164>>>>>                Move "" to s1
59165>>>>>                Move "" to s2
59166>>>>>                Move "" to s3
59167>>>>>        
59167>>>>>                clear pseira
59168>>>>>                move particle.company_code to pseira.company_code
59169>>>>>                move particle.branch_code  to pseira.branch_code
59170>>>>>                move particle.ptyppar_code to pseira.ptyppar_code
59171>>>>>                move particle.pseira_seira to pseira.pseira_seira
59172>>>>>                find eq pseira by index.1
59173>>>>>>
59173>>>>>                if (found) begin
59175>>>>>        //             SHOWLN PSEIRA.PSEIRA_FORM
59175>>>>>        //             SHOWLN particle.partl_no
59175>>>>>                    Move (Trim(pseira.pseira_form)) to s1
59176>>>>>                    Move (Trim(String(particle.partl_no))) to s2
59177>>>>>                    Move (Trim(s1+s2)) to s3
59178>>>>>                    Move (Trim(s3)) to tmppol.arithmos
59179>>>>>                    //Move (Append(tmppol.arithmos,(trim(pseira.pseira_form)+STRING(particle.partl_no)))) to tmppol.arithmos
59179>>>>>        
59179>>>>>                end
59179>>>>>>
59179>>>>>                //move particle.partl_no                  to Tmppol.arithmos
59179>>>>>                move Particle.Partl_hmnia               to Tmppol.hmnia
59180>>>>>                MOVE PARTICLE.AITIOL                    to tmppol.sxolia
59181>>>>>                move ''                                 to Tmppol.kodikos
59182>>>>>                move Particle.partl_payam               to Tmppol.axia
59183>>>>>                add Tmppol.axia                         to ntot
59184>>>>>                move (trim(Particle.client_id))         to scode
59185>>>>>                move Particle.partl_totamad             to Tmppol.posonet
59186>>>>>                move '' to skodikos
59187>>>>>                if (Tmppol.axia <> 0) begin
59189>>>>>                    move particle.cmoves_recr           to scmoves
59190>>>>>                    clear cmoves
59191>>>>>                    move scmoves to cmoves.cmoves_recr
59192>>>>>                    find eq cmoves by index.2
59193>>>>>>
59193>>>>>                    if (cmoves.cmoves_p0 <> 0);                        move ''                        to Tmppol.kinhsh
59196>>>>>                    if (cmoves.cmoves_p0 < 0) begin
59198>>>>>                        move '-'                        to Tmppol.sign
59199>>>>>                        move '-'                        to ssign
59200>>>>>                    end
59200>>>>>>
59200>>>>>                    if (cmoves.cmoves_x0 <> 0);                        move '•'                        to Tmppol.kinhsh
59203>>>>>                    if (cmoves.cmoves_x0 < 0) begin
59205>>>>>                        move '-'                        to Tmppol.sign
59206>>>>>                        move '-'                        to ssign
59207>>>>>                    end
59207>>>>>>
59207>>>>>                end
59207>>>>>>
59207>>>>>                Move (Right(scode, Ikod))               To scode
59208>>>>>                move (replaces('.',scode,'')) to scode
59209>>>>>                insert '01' in scode at 1
59211>>>>>                if (Sysfile.Client_Digits<6);                    insert '0' in scode at 5
59215>>>>>                move (trim(scode))                      to Tmppol.code
59216>>>>>                Relate Particle
59217>>>>>                if (clients.is_xondr='1')     move '1'     to skodikos
59220>>>>>                else                          move '2'     to skodikos
59222>>>>>           //     If (sysfile.company_name='1') move '1'     to skodikos
59222>>>>>                if (clients.is_xondr='1')     move '01'     to Tmppol.kodikos2
59225>>>>>                else                          move '02'     to Tmppol.kodikos2
59227>>>>>                If (sysfile.company_name='1') move '01'     to Tmppol.kodikos2
59230>>>>>                if ((particle.ptyppar_code='100') or (particle.ptyppar_code='113')) begin
59232>>>>>                    if (particle.ptyppar_code<>clients.client_ptyppar) begin
59234>>>>>                       move '˜¨˜©«˜« ¡æ <> ˜§æ æ«  ¦¨å©«ž¡œ ©«¦¤ œ¢á«ž. ˜¨˜©«˜« ¡æ = ' to msgstr
59235>>>>>                       append msgstr tmppol.arithmos
59236>>>>>                       error 5690 msgstr
59237>>>>>>
59237>>>>>                    end
59237>>>>>>
59237>>>>>                End
59237>>>>>>
59237>>>>>                if ((clients.status='') and (clients.sap_hmnia<=ddate)) begin
59239>>>>>                    move 1 to ienhsap
59240>>>>>                    move Particle.client_id to sclientid
59241>>>>>                    if (clients.client_ptyppar='') begin
59243>>>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå §˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž = ' to msgstr
59244>>>>>                        append msgstr clients.client_id
59245>>>>>                        error 4330 msgstr
59246>>>>>>
59246>>>>>                    end
59246>>>>>>
59246>>>>>                    if (clients.client_ptyppar='100') begin
59248>>>>>                            move '' to msgstr
59249>>>>>                            if (clients.is_xondr<>'1') begin
59251>>>>>                                move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
59252>>>>>                                append msgstr clients.client_id
59253>>>>>                                error 4333 msgstr
59254>>>>>>
59254>>>>>                            end
59254>>>>>>
59254>>>>>                    end
59254>>>>>>
59254>>>>>                    else begin
59255>>>>>                        if (clients.client_ptyppar<>'113') begin
59257>>>>>                            move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
59258>>>>>                            append msgstr clients.client_id
59259>>>>>                            error 4334 msgstr
59260>>>>>>
59260>>>>>                        end
59260>>>>>>
59260>>>>>                    end
59260>>>>>>
59260>>>>>                end
59260>>>>>>
59260>>>>>                move ''                                 to Tmppol.apoth
59261>>>>>                move 0                                  to Tmppol.qty
59262>>>>>                move clients.client_name                to Tmppol.name
59263>>>>>                Clear Tperga
59264>>>>>                move Particle.cn_code  to tperga.cn_code
59265>>>>>                find gt tperga by index.1
59266>>>>>>
59266>>>>>                while ((found) and (particle.cn_code=tperga.cn_code))
59270>>>>>                    if ((tperga.xarhtos_meres<>0) and (tperga.plhroteo_meres<>0)) begin
59272>>>>>                        move '' to soroi
59273>>>>>                        move tperga.xarhtos_meres to soroi
59274>>>>>                        insert tperga.plhroteo_meres in soroi at 3
59276>>>>>                        move (trim(soroi)) to soroi
59277>>>>>                    end
59277>>>>>>
59277>>>>>                    find gt tperga by index.1
59278>>>>>>
59278>>>>>                loop
59279>>>>>>
59279>>>>>                move soroi                              to Tmppol.Oroi
59280>>>>>                move 'EUR'                              To Tmppol.nomisma
59281>>>>>                saverecord Tmppol
59282>>>>>                add 1 to ino
59283>>>>>                add 1 to Imet
59284>>>>>                move 0 to iarnhtika
59285>>>>>                clear pmoves
59286>>>>>                move srecr to pmoves.partl_recr
59287>>>>>                find gt pmoves by index.3
59288>>>>>>
59288>>>>>                while ((found) and (srecr=pmoves.partl_recr))
59292>>>>>                    clear TmpPol
59293>>>>>                    move 'FI2'                              to TmpPol.onoma
59294>>>>>                    move '03'                               to TmpPol.typos
59295>>>>>                    move 'TRD1'                             to TmpPol.etairia
59296>>>>>                    move segkatastash                       to TmpPol.perioxh
59297>>>>>                    move sPERIOXH                           to TmpPol.egkatastash
59298>>>>>                    move segkatastash                       to TmpPol.tomeas
59299>>>>>                    move (trim(stype))                      to Tmppol.type
59300>>>>>                    move ssign                              to tmppol.sign
59301>>>>>                    move (TRIM(S3))                         to Tmppol.arithmos
59302>>>>>                  //  move pmoves.partl_no                    to Tmppol.arithmos
59302>>>>>                    move Pmoves.Partl_hmnia                 to Tmppol.hmnia
59303>>>>>                    move pmoves.pms_unitprice               to tmppol.unitpr
59304>>>>>                    move iarnhtika                          to tmppol.neo
59305>>>>>                    Relate Pmoves
59306>>>>>                    move '' to skod
59307>>>>>                    move (trim(wapokat.gl))                 to skod
59308>>>>>                    IF (pmoves.pms_status_e=1);                        move '1'                            to skod
59311>>>>>                    insert ptyppar.sap in skod at 2
59313>>>>>                    move skodikos to sstr
59314>>>>>                    insert sstr              in skod at 3
59316>>>>>                    insert Item.link2        in skod at 4
59318>>>>>                    if (particle.skopos_diakin='9') move '2' to sstr
59321>>>>>                    else                            move '1' to sstr
59323>>>>>                    insert sstr              in skod at 5
59325>>>>>                    if (trim(wapokat.gl)='') begin
59327>>>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©« ª €§¦Ÿã¡œª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
59328>>>>>                        append msgstr tmppol.arithmos
59329>>>>>                        error 4441 msgstr
59330>>>>>>
59330>>>>>                    End
59330>>>>>>
59330>>>>>                    if (trim(item.link2)='') begin
59332>>>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª ‘ç¤›œ©žª SAP ©«¦ „å›¦ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
59333>>>>>                        append msgstr tmppol.arithmos
59334>>>>>                        error 4443 msgstr
59335>>>>>>
59335>>>>>                    End
59335>>>>>>
59335>>>>>                    move skod                               to Tmppol.kodikos
59336>>>>>                    move Pmoves.pms_amaftdisc               to Tmppol.axia
59337>>>>>               //     add  pmoves.pms_vatam                   to npmsfpa
59337>>>>>                    move Pmoves.pms_VATAM                   to Tmppol.POSOFPA
59338>>>>>                    add  Tmppol.axia                        to nnet
59339>>>>>                    move 'B'                                to sitem
59340>>>>>                    IF (pmoves.pms_status_e=1);                        move 'G'                            to sstr
59343>>>>>                    else;                        move wapokat.sap_descr              to sstr
59345>>>>>                    insert sstr in sitem at 2
59347>>>>>                    if (trim(wapokat.sap_descr)='') begin
59349>>>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©«ã¤ ‰˜«žš¦¨å˜ „å›¦¬ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
59350>>>>>                        append msgstr tmppol.arithmos
59351>>>>>                        error 4459 msgstr
59352>>>>>>
59352>>>>>                    End
59352>>>>>>
59352>>>>>                    insert 'O' in sitem at 3
59354>>>>>                    insert item.sap in sitem at 4
59356>>>>>                    if (trim(item.sap)='') begin
59358>>>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP „å›¦¬ª ©«æ „å›¦ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
59359>>>>>                        append msgstr tmppol.arithmos
59360>>>>>                        error 4446 msgstr
59361>>>>>>
59361>>>>>                    End
59361>>>>>>
59361>>>>>                    if (pmoves.wapokat_code='05') begin
59363>>>>>                        clear tmplg
59364>>>>>                        move item.sap to tmplg.company_code
59365>>>>>                        move  Pmoves.pms_VATAM to tmplg.gmove_x0
59366>>>>>                        saverecord tmplg
59367>>>>>                    end
59367>>>>>>
59367>>>>>                    string spinak
59367>>>>>                    move '' to spinak
59368>>>>>                    move sitem                              to tmppol.apoth
59369>>>>>                    move pmoves.pms_qty                     to Tmppol.qty
59370>>>>>                    move pmoves.wapokat_code                to tmppol.wapokat_code
59371>>>>>                    move pmoves.sx_arithmos                 to Tmppol.sxetiko
59372>>>>>                    move item.item_code                     to Tmppol.item
59373>>>>>                    move item.item_descr                    to Tmppol.item_descr
59374>>>>>                    move Units.Units_Descr                  to Tmppol.mm
59375>>>>>                    if (trim(pmoves.car_id)<>'')  begin
59377>>>>>                        Clear Cars
59378>>>>>                        move (trim(pmoves.car_id))  to Cars.car_id
59379>>>>>                        Find eq Cars by index.2
59380>>>>>>
59380>>>>>                        Move (Append(spinak,(cars.car_what+'_'+cars.car_lc+cars.car_ln)))  to spinak
59381>>>>>                        if ((cars.car_what='') and (cars.car_ln=''));                            move '' to spinak
59384>>>>>                        MOVE SPINAK to Tmppol.pinakida
59385>>>>>        
59385>>>>>                        If (trim(cars.ctype_id)='1');                            move '1' to Tmppol.kathgoria
59388>>>>>                        else if (trim(cars.ctype_id)='2');                            move '2' to Tmppol.kathgoria
59392>>>>>                        else if (trim(cars.ctype_id)='3');                            move '3' to tmppol.kathgoria
59396>>>>>                        else;                            move '4' to tmppol.kathgoria
59398>>>>>                    end
59398>>>>>>
59398>>>>>                    if (pmoves.wapokat_code='04') begin
59400>>>>>                        move '' to tmppol.pinakida
59401>>>>>                        move '' to tmppol.kathgoria
59402>>>>>                    end
59402>>>>>>
59402>>>>>                    if (pmoves.wapokat_code='05') begin
59404>>>>>                        move '' to tmppol.kathgoria
59405>>>>>                        move pmoves.pump_id to pumps.pump_id
59406>>>>>                        find eq pumps by index.3
59407>>>>>>
59407>>>>>                        if (found=1) begin
59409>>>>>                            MOVE '' to spinak
59410>>>>>                            Move (Append(spinak,(pumps.pump_what+pumps.pump_lc+pumps.pump_ln))) to spinak
59411>>>>>                            move spinak to Tmppol.pinakida
59412>>>>>                         end
59412>>>>>>
59412>>>>>                         If (trim(pumps.ctype_id)='1');                            move '1' to Tmppol.antlhsh
59415>>>>>                         else if (trim(pumps.ctype_id)='2');                            move '2' to Tmppol.antlhsh
59419>>>>>                         else if (trim(pumps.ctype_id)='4');                            move '3' to Tmppol.antlhsh
59423>>>>>                         else move '' to tmppol.antlhsh
59425>>>>>                    END
59425>>>>>>
59425>>>>>                    move soroi                              to Tmppol.Oroi
59426>>>>>                    move (abs(pmoves.pms_vatpct))           to Tmppol.fpa
59427>>>>>                    move 'EUR'                              To Tmppol.nomisma
59428>>>>>                    move particle.aitiol                    to tmppol.sxolia
59429>>>>>                    saverecord Tmppol
59430>>>>>                    add 1 to imet
59431>>>>>                    if (pmoves.wapokat_code='05') begin
59433>>>>>                        clear tempitem
59434>>>>>                        move tmppol.recnum to tempitem.wcmove_qty_eisa
59435>>>>>                        move '1' to tempitem.wcmove_status_e
59436>>>>>                        move item.sap to tempitem.witemx_code
59437>>>>>                        move soroi to tempitem.client_id
59438>>>>>                        move (abs(pmoves.pms_vatpct))           to Tempitem.company_code
59439>>>>>                        move Units.Units_Descr to tempitem.branch_code
59440>>>>>                        move pmoves.pms_qty                     to tempitem.wcmove_qty
59441>>>>>                        move Pmoves.pms_amaftdisc               to tempitem.wcmove_axia
59442>>>>>                        move Pmoves.pms_VATAM                   to Tempitem.wcmove_qty_exa
59443>>>>>                        saverecord tempitem
59444>>>>>                    end
59444>>>>>>
59444>>>>>                    Set Label Of frmShow to ('à¢ã©œ ª' + '-' + String(iMet)+'-'+String(Tmppol.arithmos))
59445>>>>>                    find gt pmoves by index.3
59446>>>>>>
59446>>>>>                Loop
59447>>>>>>
59447>>>>>        
59447>>>>>                move 0                                  to tmppol.recnum
59448>>>>>                move particle.partl_vatam               to Tmppol.axia
59449>>>>>                add Tmppol.axia                         to nfpa
59450>>>>>                move sEGKATASTASH                       to TmpPol.perioxh
59451>>>>>                move ''                                 to tmppol.code
59452>>>>>                move ''                                 to tmppol.kodikos2
59453>>>>>                move ''                                 to tmppol.apoth
59454>>>>>                move 0                                  to tmppol.qty
59455>>>>>                move 0                                  to tmppol.unitpr
59456>>>>>                move ''                                 to tmppol.mm
59457>>>>>                move ''                                 to tmppol.kathgoria
59458>>>>>                move ''                                 to tmppol.pinakida
59459>>>>>                move ''                                 to tmppol.ANTLHSH
59460>>>>>                move 0                                  to tmppol.posofpa
59461>>>>>                move ''                                 to tmppol.item
59462>>>>>                move ''                                 to tmppol.wapokat_code
59463>>>>>                move ''                                 to tmppol.sxetiko
59464>>>>>                move '05'                               to TmpPol.typos
59465>>>>>                move '' to tmppol.kodikos
59466>>>>>                saverecord Tmppol
59467>>>>>                add 1 to imet
59468>>>>>                clear Psxetika
59469>>>>>                move srecr to Psxetika.partl_recr
59470>>>>>                Find gt Psxetika by index.4
59471>>>>>>
59471>>>>>                while ((found) and (srecr=Psxetika.partl_recr))
59475>>>>>                        move 0                              to tmppol.recnum
59476>>>>>                        move '06'                           to TmpPol.typos
59477>>>>>                        move sEGKATASTASH                   to TmpPol.perioxh
59478>>>>>                        move 0                              to tmppol.axia
59479>>>>>                        move ''                             to tmppol.oroi
59480>>>>>                        move ''                             to tmppol.nomisma
59481>>>>>                        move 0                              to Tmppol.posofpa
59482>>>>>                        move 0                              to Tmppol.fpa
59483>>>>>                        move ''                             to tmppol.item
59484>>>>>                        move ''                             to tmppol.wapokat_code
59485>>>>>                        move ''                             to tmppol.sxolia
59486>>>>>                        move ''                             to tmppol.sxetiko
59487>>>>>                        move '' to sparast
59488>>>>>                        move psxetika.sx_pseira_seira       to sparast
59489>>>>>                        append sparast Psxetika.sx_partl_no
59490>>>>>                        move sparast                        to Tmppol.deltia
59491>>>>>                        move psxetika.psx_partl_recr        to Tmppol.sxrecr
59492>>>>>                        Clear pmovesl
59493>>>>>                        move tmppol.sxrecr to pmovesl.partl_recr
59494>>>>>                        find gt pmovesl by index.3
59495>>>>>>
59495>>>>>                        while ((found) and (tmppol.sxrecr=pmovesl.partl_recr))
59499>>>>>                            if (pmovesl.wapokat_code='05') begin
59501>>>>>                                clear iteml
59502>>>>>                                move pmovesl.item_code to iteml.item_code
59503>>>>>                                find EQ iteml by index.5
59504>>>>>>
59504>>>>>                                move iteml.sap to Tmppol.item
59505>>>>>                                move pmovesl.pms_qty to tmppol.qty
59506>>>>>                                clear pumps
59507>>>>>                                move pmovesl.pump_id to pumps.pump_id
59508>>>>>                                find eq pumps by index.3
59509>>>>>>
59509>>>>>                                if (found=1) begin
59511>>>>>                                    MOVE '' to spinak
59512>>>>>                                    Move (Append(spinak,(pumps.pump_what+pumps.pump_lc+pumps.pump_ln))) to spinak
59513>>>>>                                    move spinak to Tmppol.pinakida
59514>>>>>        
59514>>>>>                                end
59514>>>>>>
59514>>>>>                                If (trim(pumps.ctype_id)='1');                                    move '1' to Tmppol.antlhsh
59517>>>>>                                else if (trim(pumps.ctype_id)='2');                                    move '2' to Tmppol.antlhsh
59521>>>>>                                else if (trim(pumps.ctype_id)='4');                                    move '3' to Tmppol.antlhsh
59525>>>>>                                else move '' to tmppol.antlhsh
59527>>>>>                                move '' to tmppol.kathgoria
59528>>>>>                                clear tempitem
59529>>>>>                                move '2' to tempitem.wcmove_status_e
59530>>>>>                                move (trim(iteml.sap)) to tempitem.witemx_code
59531>>>>>                                move (trim(spinak)) to tempitem.item_code
59532>>>>>        
59532>>>>>                                move (trim(tmppol.antlhsh)) to tempitem.year_year
59533>>>>>                                find eq tempitem by index.4
59534>>>>>>
59534>>>>>                                if (found) begin
59536>>>>>                                    add  pmovesl.pms_qty to tempitem.wcmove_qty
59537>>>>>                                    saverecord tempitem
59538>>>>>                                end
59538>>>>>>
59538>>>>>                                else begin
59539>>>>>                                    move '2' to tempitem.wcmove_status_e
59540>>>>>                                    move iteml.sap to tempitem.witemx_code
59541>>>>>                                    move pmovesl.pms_qty                   to tempitem.wcmove_qty
59542>>>>>                                    move Pmovesl.pms_amaftdisc             to tempitem.wcmove_axia
59543>>>>>                                    move Pmovesl.pms_VATAM                 to Tempitem.wcmove_qty_exa
59544>>>>>                                    saverecord tempitem
59545>>>>>                                end
59545>>>>>>
59545>>>>>                            end
59545>>>>>>
59545>>>>>                            find gt pmovesl by index.3
59546>>>>>>
59546>>>>>                        Loop
59547>>>>>>
59547>>>>>                        add 1 to imet
59548>>>>>                        saverecord Tmppol
59549>>>>>                    find gt Psxetika by index.4
59550>>>>>>
59550>>>>>                Loop
59551>>>>>>
59551>>>>>        
59551>>>>>                // œ›à œ®œ  › ˜£¦¨­àŸœå «¦ ˜¨®œ ¦ £œ œšš¨˜­œª 1 ¡˜  2
59551>>>>>                // 1 ˜¨® ¡ã œšš¨˜­ã ¡˜  2= «˜ ›ç¦ ¦®ã£˜«˜
59551>>>>>                clear tempitem
59552>>>>>                move '1' to tempitem.wcmove_status_e
59553>>>>>                find gt tempitem by index.4
59554>>>>>>
59554>>>>>                while ((found) and (tempitem.wcmove_status_e='1'))
59558>>>>>                    move tempitem.wcmove_qty to nqty
59559>>>>>                    move tempitem.witemx_code to sitem
59560>>>>>                    MOVE TEMPITEM.wcmove_qty_eisa to irecnum
59561>>>>>                    clear tempitel
59562>>>>>                    move '2' to tempitel.wcmove_status_e
59563>>>>>                    move sitem to tempitel.witemx_code
59564>>>>>                    move 0 to nhqty
59565>>>>>                    find gt tempitel by index.4
59566>>>>>>
59566>>>>>                    while ((found) and (tempitel.wcmove_status_e='2') and (sitem=tempitel.witemx_code))
59570>>>>>                        add tempitel.wcmove_qty to nhqty
59571>>>>>                        find gt tempitel by index.4
59572>>>>>>
59572>>>>>                    Loop
59573>>>>>>
59573>>>>>                    if  (nhqty=0) begin
59575>>>>>                    end
59575>>>>>>
59575>>>>>                    else begin
59576>>>>>                        move 0 to npartlfpa
59577>>>>>                        integer iTrecnum
59577>>>>>                        move 0 to itrecnum
59578>>>>>                        move (nqty-nhqty) to nqty
59579>>>>>                        clear tempitel
59580>>>>>                        move '2' to tempitel.wcmove_status_e
59581>>>>>                        move sitem to tempitel.witemx_code
59582>>>>>                        move 0 to nhqty
59583>>>>>                        move 0 to ino
59584>>>>>                        find gt tempitel by index.4
59585>>>>>>
59585>>>>>                        while ((found) and (tempitel.wcmove_status_e='2') and (sitem=tempitel.witemx_code))
59589>>>>>        
59589>>>>>                            add 1 to ino
59590>>>>>                            clear tmppol
59591>>>>>                            move  irecnum to tmppol.recnum
59592>>>>>                            find eq tmppol.recnum
59593>>>>>>
59593>>>>>                            if (found) begin
59595>>>>>                                move 0 to tmppol.recnum
59596>>>>>                                if (ino=1) Move (tempitel.wcmove_qty+nqty)  to tmpPol.qty
59599>>>>>                                else       move tempitel.wcmove_qty         to tmpPol.qty
59601>>>>>                                Move (ROUnD_number((tmpPol.qty*tmppol.unitpr),2))  to tmppol.axia
59602>>>>>                                Move (ROUnD_number(((tmppol.axia*tmppol.fpa)/100),2))  to tmppol.posofpa
59603>>>>>                                move tempitel.item_code to tmppol.pinakida
59604>>>>>                                move tempitel.year_year to tmppol.antlhsh
59605>>>>>                                add 1 to imet
59606>>>>>                                saverecord tmppol
59607>>>>>                                add tmppol.posofpa to npartlfpa
59608>>>>>                                move tmppol.recnum to itrecnum
59609>>>>>                            end
59609>>>>>>
59609>>>>>                            find gt tempitel by index.4
59610>>>>>>
59610>>>>>        
59610>>>>>                        Loop
59611>>>>>>
59611>>>>>                        clear tmplg
59612>>>>>                        move sitem to tmplg.company_code
59613>>>>>                        find ge tmplg by index.1
59614>>>>>>
59614>>>>>                        while ((found) and (tmplg.company_code=sitem))
59618>>>>>                            if (tmplg.gmove_x0 <> npartlfpa) begin
59620>>>>>                                clear tmppol
59621>>>>>                                move itrecnum to tmppol.recnum
59622>>>>>                                find eq tmppol.recnum
59623>>>>>>
59623>>>>>                                move (tmplg.gmove_x0-npartlfpa) to npartlfpa
59624>>>>>                                add npartlfpa to tmppol.posofpa
59625>>>>>                                saverecord tmppol
59626>>>>>                            end
59626>>>>>>
59626>>>>>                            find gt tmplg by index.1
59627>>>>>>
59627>>>>>                        Loop
59628>>>>>>
59628>>>>>                        clear tmppol
59629>>>>>                        move irecnum to tmppol.recnum
59630>>>>>                        find eq tmppol.recnum
59631>>>>>>
59631>>>>>                        if (found) begin
59633>>>>>                            delete tmppol
59634>>>>>                            sub 1 from imet
59635>>>>>                        end
59635>>>>>>
59635>>>>>                    end
59635>>>>>>
59635>>>>>                    find gt tempitem by index.4
59636>>>>>>
59636>>>>>                Loop
59637>>>>>>
59637>>>>>                nextpmovesdd:
59637>>>>>                Set Label Of frmShow to ('à¢ã©œ ª' + '-' +string(particle.partl_hmnia)+'-'+String(particle.recnum))
59638>>>>>                if (ienhsap=1) begin
59640>>>>>                    clear clients
59641>>>>>                    move sclientid to clients.client_id
59642>>>>>                    find eq clients by index.6
59643>>>>>>
59643>>>>>                    if (found=1) begin
59645>>>>>                        move dkenhdate to clients.sap_hmnia
59646>>>>>                        saverecord clients
59647>>>>>                    end
59647>>>>>>
59647>>>>>                end
59647>>>>>>
59647>>>>>                find gt Particle by 17
59648>>>>>>
59648>>>>>             Loop
59649>>>>>>
59649>>>>>        
59649>>>>>             clear Tmppol
59650>>>>>             move 'FI2'                              to Tmppol.onoma
59651>>>>>             move '90'                               to Tmppol.typos
59652>>>>>             move 'TRD1'                             to Tmppol.etairia
59653>>>>>             move '9999'                             to Tmppol.type
59654>>>>>             move '9999999999'                       to Tmppol.arithmos
59655>>>>>             move segkatastash                       to Tmppol.EGKATASTASH
59656>>>>>          //   move sPERIOXH                            to TmpPol.perioxh
59656>>>>>             move sTOMEAS                            to TmpPol.perioxh
59657>>>>>             move ntot                               to Tmppol.axia
59658>>>>>             move 'EUR'                              To Tmppol.nomisma
59659>>>>>             move dapod                               to Tmppol.hmnia
59660>>>>>             saverecord Tmppol
59661>>>>>             move 0                                  to Tmppol.recnum
59662>>>>>             move '91'                               to Tmppol.typos
59663>>>>>             move nfpa                               to Tmppol.axia
59664>>>>>             saverecord Tmppol
59665>>>>>             move 0                                  to Tmppol.recnum
59666>>>>>             move '92'                               to Tmppol.typos
59667>>>>>             move nnet                               to Tmppol.axia
59668>>>>>             saverecord Tmppol
59669>>>>>        
59669>>>>>             move 0 to imet
59670>>>>>             clear tmppol
59671>>>>>             find gt tmppol.recnum
59672>>>>>>
59672>>>>>             while (found)
59676>>>>>                if ((tmppol.typos='01') or (tmppol.typos='03') or (tmppol.typos='05') or (tmppol.typos='06'));                    add 1 to imet
59679>>>>>                if (tmppol.typos='92') begin
59681>>>>>                    move 0                                  to Tmppol.recnum
59682>>>>>                    move '93'                               to Tmppol.typos
59683>>>>>                    move imet                               to Tmppol.axia
59684>>>>>                    move ''                                 to Tmppol.nomisma
59685>>>>>                    saverecord Tmppol
59686>>>>>                    goto next_loopdd
59687>>>>>>
59687>>>>>                end
59687>>>>>>
59687>>>>>                IF (tmppol.typos='06') begin
59689>>>>>                   move tmppol.recnum to irecnum
59690>>>>>                   if (tmppol.sxrecr<>'') begin
59692>>>>>                       clear particle
59693>>>>>                       move tmppol.sxrecr to particle.partl_recr
59694>>>>>                       find eq particle by index.2
59695>>>>>>
59695>>>>>                       if (found) begin
59697>>>>>                            if (particle.ptyppar_code<>'099') begin
59699>>>>>                                delete tmppol
59700>>>>>                                sub 1 from imet
59701>>>>>                                clear tmppol
59702>>>>>                                move irecnum to tmppol.recnum
59703>>>>>                            end
59703>>>>>>
59703>>>>>                       end
59703>>>>>>
59703>>>>>                    end
59703>>>>>>
59703>>>>>                end
59703>>>>>>
59703>>>>>                find gt tmppol.recnum
59704>>>>>>
59704>>>>>             Loop
59705>>>>>>
59705>>>>>             next_loopdd:
59705>>>>>        End_Procedure
59706>>>>>        
59706>>>>>        Procedure enhmerose_apoth
59708>>>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo spinak
59709>>>>>             string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
59709>>>>>             STRING sLetter sEnglish sGreek sid spar msgstr
59709>>>>>        
59709>>>>>             integer Imet Ikod Ino iLen iFirst iRecnum IINT ipos isygk
59709>>>>>             number  ntot nfpa nqty
59709>>>>>             date dapod ddate dhdate
59709>>>>>             Move 'ABCDEFGHIJKLMNOPRSTUVWXYZ' to sEnglish
59710>>>>>             Move '€–ƒ„”‚†ˆ‰Š‹ŒŽ‘’‡—‘•“…' to sGreek
59711>>>>>             get value of frmapo to dapod
59712>>>>>             move Sysfile.Client_Digits to Ikod
59713>>>>>             add 3 to ikod // gia na paroyme kai to AX ektos yomea
59714>>>>>             clear Company
59715>>>>>             move syscurxr.company_code to Company.company_code
59716>>>>>             find eq company by index.1
59717>>>>>>
59717>>>>>             move Company.company_c_code0 to stomeas
59718>>>>>             clear Wcmoves
59719>>>>>             find gt wcmoves by 16
59720>>>>>>
59720>>>>>             while ((found) and (wcmoves.sap_hmnia=''))
59724>>>>>                if  (wcmoves.wcmove_hmnia  > dapod);                    goto nextwcmovesdd
59727>>>>>                if (syscurxr.company_code<>Wcmoves.company_code);                    goto nextwcmovesdd
59730>>>>>                relate Wcmoves
59731>>>>>                if (Wcmoves.module_from<>'01');                    goto nextwcmovesdd
59734>>>>>                if (Wapokat.OXIMM1='1') BEGIN
59736>>>>>                    goto nextwcmovesdd
59737>>>>>>
59737>>>>>                END
59737>>>>>>
59737>>>>>                ELSE BEGIN
59738>>>>>                    if (Wapokat.enhm_sap<>'1');                        goto nextwcmovesdd
59741>>>>>                end
59741>>>>>>
59741>>>>>                if ((Wcmoves.wcmove_qty_eisa=0) and (Wcmoves.wcmove_qty_exa=0));                    goto nextwcmovesdd
59744>>>>>                if (Wtypkin.wtypkin_anti='');                    goto nextwcmovesdd
59747>>>>>                move (trim(Wcmoves.client_id))          to scode
59748>>>>>                move Wcmoves.Wcmove_recr                to srecr
59749>>>>>                clear branch
59750>>>>>                move wcmoves.company_code to branch.company_code
59751>>>>>                move wcmoves.branch_code  to branch.branch_code
59752>>>>>                find eq branch by index.1
59753>>>>>>
59753>>>>>                move branch.PERIOXH        to segkatastash
59754>>>>>                clear Tmpapoth
59755>>>>>                move wtypkin.Wtypkin_anti               to Tmpapoth.type
59756>>>>>                move 'MM1'                              to Tmpapoth.onoma
59757>>>>>                move '01'                               to Tmpapoth.typos
59758>>>>>                move segkatastash                       to Tmpapoth.egkatastash
59759>>>>>                clear pmoves
59760>>>>>                move wcmoves.partl_recr to pmoves.pms_recr
59761>>>>>                find eq pmoves by index.2
59762>>>>>>
59762>>>>>                if (not(found)) begin
59764>>>>>                    move 'ƒœ¤ ™¨å©¡à recr ©ç¤›œ©žª £œ pmoves wcmoves.particle_recr = ' to msgstr
59765>>>>>                    append msgstr wcmoves.particle_recr
59766>>>>>                    error 4499 msgstr
59767>>>>>>
59767>>>>>                End
59767>>>>>>
59767>>>>>        
59767>>>>>                move pmoves.pseira_seira to spar
59768>>>>>                append spar pmoves.partl_no
59769>>>>>                move spar                               to Tmpapoth.arithmos
59770>>>>>                MOVE '' TO SPINAK
59771>>>>>                Clear Cars
59772>>>>>                move (trim(pmoves.car_id))  to Cars.car_id
59773>>>>>                Find eq Cars by index.2
59774>>>>>>
59774>>>>>                Move (trim(Cars.Car_license)) to spinak
59775>>>>>                For iInt From 1 to (Length(spinak))
59781>>>>>>
59781>>>>>                    Move (Mid(spinak,1,iInt)) to sLetter
59782>>>>>                    If (sGREEK Contains sLetter) Begin
59784>>>>>                         Move (Pos(sLetter,sgreek)) to iPos
59785>>>>>                         Move (Replaces(sLetter,spinak,(Mid(senglish,1,iPos)))) to spinak
59786>>>>>                    End
59786>>>>>>
59786>>>>>                Loop
59787>>>>>>
59787>>>>>        
59787>>>>>                move spinak                             to Tmpapoth.pinakida
59788>>>>>                move Wcmoves.Wcmove_hmnia               to Tmpapoth.hmnia
59789>>>>>                move wtypkin.Wtypkin_anti               to Tmpapoth.type
59790>>>>>        
59790>>>>>                if (Wtypkin.wtypkin_anti='');                    goto nextwcmovesdd
59793>>>>>                relate pmoves
59794>>>>>                if (particle.skopos_diakin='2');                    move 'Z17'                          to Tmpapoth.type
59797>>>>>                if (particle.skopos_diakin='3');                    move 'Z15'                          to Tmpapoth.type
59800>>>>>                if (clients.anal='1');                    move 1 to isygk
59803>>>>>                else;                    move 0 to isygk
59805>>>>>                If (sysfile.company_name='1') move 0     to isygk
59808>>>>>                Move (Right(scode, Ikod))                To scode
59809>>>>>                move (replaces('.',scode,'')) to scode
59810>>>>>                insert '01' in scode at 1
59812>>>>>                if (Sysfile.Client_Digits<6);                    insert '0' in scode at 5
59816>>>>>                if (wcmoves.client_id='');                    move '' to scode
59819>>>>>                if (trim(scode)<>'') begin
59821>>>>>                    if (isygk=1) begin
59823>>>>>                        left scode to sid 4
59825>>>>>>
59825>>>>>                        append sid '999999'
59826>>>>>                        move (trim(sid)) to scode
59827>>>>>                    end
59827>>>>>>
59827>>>>>                end
59827>>>>>>
59827>>>>>                if ((tmpapoth.type='Z17') or (Tmpapoth.type='Z15'));                    move '' to scode
59830>>>>>                if ((tmpapoth.type='…17') or (Tmpapoth.type='…15'));                    move '' to scode
59833>>>>>                move (trim(scode))                      to Tmpapoth.code
59834>>>>>        
59834>>>>>                move 'B'                                to sitem
59835>>>>>                if (wcmoves.wcmove_status_e=1);                    move 'G'                            to sti
59838>>>>>                else;                    move wapokat.sap_descr              to sti
59840>>>>>                if (trim(wapokat.sap_descr)='') begin
59842>>>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©«ã¤ ‰˜«žš¦¨å˜ „å›¦¬ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
59843>>>>>                        append msgstr tmpapoth.arithmos
59844>>>>>                        error 4488 msgstr
59845>>>>>>
59845>>>>>                End
59845>>>>>>
59845>>>>>                insert sti in sitem at 2
59847>>>>>                insert 'O' in sitem at 3
59849>>>>>                insert item.sap in sitem at 4
59851>>>>>                move sitem                              to Tmpapoth.item
59852>>>>>                if (wcmoves.wcmove_qty_eisa<> 0);                    move (ABS(wcmoves.wcmove_qty_eisa))        to Tmpapoth.qty
59855>>>>>                else;                    move (ABS(wcmoves.wcmove_qty_exa))         to Tmpapoth.qty
59857>>>>>                move UNITS.UNITS_DESCR                  to Tmpapoth.monada
59858>>>>>                saverecord Tmpapoth
59859>>>>>                add 1 to ino
59860>>>>>                add 1 to Imet
59861>>>>>                nextwcmovesdd:
59861>>>>>                move (trim(wcmoves.wcmove_par)) to sno
59862>>>>>                Set Label Of frmShow to ('‰ ¤ã©œ ª €§¦Ÿã¡žª' + '-' + String(iMet)+'-'+String(sno))
59863>>>>>                find gt Wcmoves by 16
59864>>>>>>
59864>>>>>             Loop
59865>>>>>>
59865>>>>>             move 0                                  to Tmpapoth.recnum
59866>>>>>             move ''                                 to Tmpapoth.hmnia
59867>>>>>             move '90'                               to Tmpapoth.typos
59868>>>>>             move '9999999999'                       to Tmpapoth.arithmos
59869>>>>>             move ''                                 to tmpapoth.type
59870>>>>>             move imet                               to Tmpapoth.qty
59871>>>>>             move ''                                 to Tmpapoth.code
59872>>>>>             move ''                                 to Tmpapoth.item
59873>>>>>             move ''                                 to Tmpapoth.egkatastash
59874>>>>>             move ''                                 to Tmpapoth.monada
59875>>>>>             move ''                                 to Tmpapoth.paralabh
59876>>>>>             saverecord Tmpapoth
59877>>>>>             Send StartReport to Rapoth
59878>>>>>        End_Procedure
59879>>>>>        
59879>>>>>        Procedure enhmerose_itemtehn
59881>>>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo
59882>>>>>             string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
59882>>>>>             integer Imet Ikod Ino iLen iFirst iRecnum
59882>>>>>             number  ntot nfpa nqty
59882>>>>>             date dapod
59882>>>>>             get value of frmapo to dapod
59883>>>>>             clear Company
59884>>>>>             move syscurxr.company_code to Company.company_code
59885>>>>>             find eq company by index.1
59886>>>>>>
59886>>>>>             move Company.company_c_code0 to stomeas
59887>>>>>             clear itemtehn
59888>>>>>             find gt itemtehn by index.4
59889>>>>>>
59889>>>>>             while ((found) and (itemtehn.sap_hmnia=''))
59893>>>>>                if  (itemtehn.hmnia  > dapod);                    goto nextitemtehndd
59896>>>>>                if (syscurxr.company_code<>itemtehn.company);                    goto nextitemtehndd
59899>>>>>                relate itemtehn
59900>>>>>                clear branch
59901>>>>>                move itemtehn.company to branch.company_code
59902>>>>>                move itemtehn.branch  to branch.branch_code
59903>>>>>                find eq branch by index.1
59904>>>>>>
59904>>>>>                move branch.PERIOXH        to segkatastash
59905>>>>>                clear Tmptehn
59906>>>>>                move 'PP1'                              to Tmptehn.onoma
59907>>>>>                move '09'                               to Tmptehn.typos
59908>>>>>                move segkatastash                       to Tmptehn.egkatastash
59909>>>>>                move itemtehn.hmnia                     to Tmptehn.hmnia
59910>>>>>                move 'B'                                to sitem
59911>>>>>                clear wapokat
59912>>>>>                move item.wapokat_code to wapokat.wapokat_code
59913>>>>>                find eq wapokat by index.1
59914>>>>>>
59914>>>>>                move wapokat.sap_descr                  to sti
59915>>>>>                insert sti in sitem at 2
59917>>>>>                insert 'O' in sitem at 3
59919>>>>>                insert itemtehn.item_code in sitem at 4
59921>>>>>                move sitem                              to Tmptehn.item
59922>>>>>                move itemtehn.code                      to tmptehn.prodiagrafh
59923>>>>>                move UNITS.UNITS_DESCR                  to Tmptehn.mm
59924>>>>>                move '1'                                to tmptehn.type
59925>>>>>                clear itemd
59926>>>>>                move itemtehn.recr to srecr
59927>>>>>                move 0 to Ino
59928>>>>>                move srecr to itemd.itemtehn_recr
59929>>>>>                find gt itemd by index.5
59930>>>>>>
59930>>>>>                while ((found) and (itemd.itemtehn_recr=srecr))
59934>>>>>                    add 1 to ifirst
59935>>>>>                    add 1 to ino
59936>>>>>                    if (ino>1) begin
59938>>>>>                        move 0 to tmptehn.recnum
59939>>>>>                        saverecord tmptehn
59940>>>>>                    end
59940>>>>>>
59940>>>>>                    clear iteml
59941>>>>>                    move itemd.itemd_code to iteml.item_code
59942>>>>>                    find eq iteml by index.5
59943>>>>>>
59943>>>>>                    clear wapokat
59944>>>>>                    move iteml.wapokat_code to wapokat.wapokat_code
59945>>>>>                    find eq wapokat by index.1
59946>>>>>>
59946>>>>>                    clear units
59947>>>>>                    move iteml.units_code to units.units_code
59948>>>>>                    find eq units by index.1
59949>>>>>>
59949>>>>>                    move 'B'                                to sitem
59950>>>>>                    move wapokat.sap_descr                  to sti
59951>>>>>                    insert sti in sitem at 2
59953>>>>>                    insert 'O' in sitem at 3
59955>>>>>                    insert itemd.itemd_code in sitem at 4
59957>>>>>                    move sitem                              to Tmptehn.itemd
59958>>>>>                    move units.units_descr                  to Tmptehn.mmitemd
59959>>>>>                    move itemd.itemd_qty                    to Tmptehn.qty
59960>>>>>                    move ino                                to tmptehn.aa
59961>>>>>                    move itemd.sap_aa  to sno
59962>>>>>                    move sno                                to Tmptehn.index
59963>>>>>                    saverecord Tmptehn
59964>>>>>                    move (trim(itemd.itemtehn_code)) to sno
59965>>>>>                    move itemd.recnum to imet
59966>>>>>                    Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(iMet)+'-'+String(sno))
59967>>>>>                    find gt itemd by index.5
59968>>>>>>
59968>>>>>                Loop
59969>>>>>>
59969>>>>>                nextitemtehndd:
59969>>>>>                move (trim(itemd.itemtehn_code)) to sno
59970>>>>>                move itemd.recnum to imet
59971>>>>>                Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(iMet)+'-'+String(sno))
59972>>>>>                find gt itemtehn by index.4
59973>>>>>>
59973>>>>>            Loop
59974>>>>>>
59974>>>>>            move 0                                  to Tmptehn.recnum
59975>>>>>            move '90'                               to Tmptehn.typos
59976>>>>>            move ifirst                             to Tmptehn.type
59977>>>>>            move ''                                 to Tmptehn.item
59978>>>>>            move ''                                 to Tmptehn.prodiagrafh
59979>>>>>            move ''                                 to Tmptehn.mm
59980>>>>>            move ''                                 to Tmptehn.egkatastash
59981>>>>>            move ''                                 to Tmptehn.itemd
59982>>>>>            move 0                                  to Tmptehn.aa
59983>>>>>            move ''                                 to Tmptehn.mmitemd
59984>>>>>            move 0                                  to Tmptehn.index
59985>>>>>            move 0                                  to Tmptehn.qty
59986>>>>>            saverecord Tmptehn
59987>>>>>        End_Procedure
59988>>>>>        
59988>>>>>        Procedure enhmerose_anal
59990>>>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo snext
59991>>>>>             string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
59991>>>>>             string seidos
59991>>>>>             integer Imet Ikod Ino itot iFirst iRecnum Icount ifound
59991>>>>>             number  ntot nfpa nqty
59991>>>>>             date dapod ddate
59991>>>>>             move '27/04/2005' to ddate
59992>>>>>             string stexnikh  msgstr
59992>>>>>             get value of frmapo to dapod
59993>>>>>             clear Company
59994>>>>>             move syscurxr.company_code to Company.company_code
59995>>>>>             find eq company by index.1
59996>>>>>>
59996>>>>>             move Company.company_c_code0 to stomeas
59997>>>>>             clear witemxtr
59998>>>>>             find gt witemxtr by index.4
59999>>>>>>
59999>>>>>             while ((found) and (witemxtr.sap_hmnia=''))
60003>>>>>                if  (witemxtr.hmnia  > dapod);                    goto nextanaldd
60006>>>>>                if (syscurxr.company_code<>witemxtr.company_code);                    goto nextanaldd
60009>>>>>                move witemxtr.recr to srecr
60010>>>>>                move '' to snext
60011>>>>>                move '' to stexnikh
60012>>>>>                clear witemxtd
60013>>>>>                move srecr to witemxtd.witemxtr_recr
60014>>>>>                find gt witemxtd by index.1
60015>>>>>>
60015>>>>>                while ((found) and (witemxtd.witemxtr_recr=srecr))
60019>>>>>                    clear branch
60020>>>>>                    move witemxtr.company_code to branch.company_code
60021>>>>>                    move witemxtr.branch_code  to branch.branch_code
60022>>>>>                    find eq branch by index.1
60023>>>>>>
60023>>>>>                    move branch.PERIOXH                 to segkatastash
60024>>>>>                    clear Tmpanal
60025>>>>>                    move 'PP2'                              to Tmpanal.onoma
60026>>>>>                    move '09'                               to Tmpanal.typos
60027>>>>>                    move segkatastash                       to Tmpanal.egkatastash
60028>>>>>                    move witemxtr.hmnia                     to Tmpanal.hmnia
60029>>>>>                    move 'B'                                to sitem
60030>>>>>                    move witemxtd.witemx_code               to shitem
60031>>>>>                    clear iteml
60032>>>>>                    move shitem to iteml.item_code
60033>>>>>                    find eq iteml by index.5
60034>>>>>>
60034>>>>>                    clear units
60035>>>>>                    move iteml.units_code to units.units_code
60036>>>>>                    find eq units by index.1
60037>>>>>>
60037>>>>>                    move UNITS.UNITS_DESCR                  to Tmpanal.mm
60038>>>>>                    clear wapokat
60039>>>>>                    move iteml.wapokat_code to wapokat.wapokat_code
60040>>>>>                    find eq wapokat by index.1
60041>>>>>>
60041>>>>>                    move wapokat.sap_descr                  to sti
60042>>>>>                    insert sti in sitem at 2
60044>>>>>                    insert 'O' in sitem at 3
60046>>>>>                    insert shitem in sitem at 4
60048>>>>>                    move 0 to Ino
60049>>>>>                    move 0 to icount
60050>>>>>                    move sitem                              to Tmpanal.item
60051>>>>>        //            move sitem                              to seidos
60051>>>>>                    clear anprod
60052>>>>>                    move srecr                      to anprod.entolh_recr
60053>>>>>                    move witemxtd.witemx_code       to anprod.anprod_form
60054>>>>>                    move witemxtd.fpa_from          to anprod.anprod_cartp
60055>>>>>                    move witemxtd.texnikh           to anprod.anprod_itemtn
60056>>>>>                    find gt anprod by index.4
60057>>>>>>
60057>>>>>                    while ((found) and (anprod.entolh_recr=srecr) and;                          (witemxtd.witemx_code=anprod.anprod_form) and;                          (witemxtd.fpa_from=anprod.anprod_cartp) and;                          (witemxtd.texnikh=anprod.anprod_itemtn))
60061>>>>>                        add 1 to icount
60062>>>>>                        if (sperioxh<>anprod.anprod_itemtn) begin
60064>>>>>                            move 0 to ino
60065>>>>>                            move 0 to ikod
60066>>>>>                            move anprod.anprod_itemtn to sperioxh
60067>>>>>                            move 0 to tmpanal.recnum
60068>>>>>                            saverecord tmpanal
60069>>>>>                         end
60069>>>>>>
60069>>>>>                        add 1 to ifirst
60070>>>>>                        add 1 to ino
60071>>>>>                        if ((ino>1) and (ikod=0)) begin
60073>>>>>                            move 0 to tmpanal.recnum
60074>>>>>                            saverecord tmpanal
60075>>>>>                        end
60075>>>>>>
60075>>>>>                        move anprod.anprod_itemtn to Tmpanal.prodiagrafh
60076>>>>>                        clear iteml
60077>>>>>                        move anprod.anprod_item to iteml.item_code
60078>>>>>                        find eq iteml by index.5
60079>>>>>>
60079>>>>>                        clear wapokat
60080>>>>>                        move iteml.wapokat_code to wapokat.wapokat_code
60081>>>>>                        find eq wapokat by index.1
60082>>>>>>
60082>>>>>                        clear units
60083>>>>>                        move iteml.units_code to units.units_code
60084>>>>>                        find eq units by index.1
60085>>>>>>
60085>>>>>                        move 'B'                                to sitem
60086>>>>>                        move wapokat.sap_descr                  to sti
60087>>>>>                        insert sti in sitem at 2
60089>>>>>                        insert 'O' in sitem at 3
60091>>>>>                        insert anprod.anprod_item in sitem at 4
60093>>>>>                        move sitem                              to Tmpanal.itemd
60094>>>>>                        move units.units_descr                  to Tmpanal.mmitemd
60095>>>>>                        move witemxtd.qty_from                  to Tmpanal.qty
60096>>>>>                        move anprod.anprod_qty                  to tmpanal.posoths
60097>>>>>                        move anprod.anprod_cartp                to Tmpanal.trmetaf
60098>>>>>                        move ino                                to tmpanal.aa
60099>>>>>        
60099>>>>>        //               integer iok
60099>>>>>        //               move 0 to iok
60099>>>>>        //               clear tmpanala
60099>>>>>        //               move witemxtr.hmnia to tmpanala.hmnia
60099>>>>>        //
60099>>>>>        //               move '09' to tmpanala.typos
60099>>>>>        //               move segkatastash to tmpanala.egkatastash
60099>>>>>        //               move witemxtd.witemx_code to tmpanala.item
60099>>>>>        //               move anprod.anprod_cartp   to tmpanala.trmetaf
60099>>>>>        //               move anprod.anprod_itemtn to Tmpanala.prodiagrafh
60099>>>>>        //               find gt tmpanala by index.5
60099>>>>>        //               while ((found) and (tmpanala.hmnia=witemxtr.hmnia)          and;
60099>>>>>        //                                 (tmpanala.typos='09')                     and;
60099>>>>>        //                                 (tmpanala.egkatastash=segkatastash)       and;
60099>>>>>        //                                 (tmpanala.item=seidos)                    and;
60099>>>>>        //                                 (tmpanala.trmetaf=anprod.anprod_cartp)    and;
60099>>>>>        //                                 (anprod.anprod_itemtn=Tmpanala.prodiagrafh))
60099>>>>>        //                   move 1 to iok
60099>>>>>        //                   if (tmpanala.itemd=sitem) begin
60099>>>>>        //                       add anprod.anprod_qty to tmpanal.posoths
60099>>>>>        //                       sub 1 from ino
60099>>>>>        //                       saverecord tmpanal
60099>>>>>        //                   end
60099>>>>>        //                   else begin
60099>>>>>        //                       move anprod.entolh_recr                 to Tmpanal.product
60099>>>>>        //                       saverecord Tmpanal
60099>>>>>        //                   end
60099>>>>>        //                   find gt tmpanal by index.5
60099>>>>>        //               Loop
60099>>>>>        //               if (iok=0) begin
60099>>>>>        //                  move anprod.entolh_recr to Tmpanal.product
60099>>>>>        //                  saverecord tmpanal
60099>>>>>        //               end
60099>>>>>                        move anprod.entolh_recr to Tmpanal.product
60100>>>>>                        saverecord tmpanal
60101>>>>>                        move (trim(anprod.anprod_item)) to sno
60102>>>>>                        move itemd.recnum to imet
60103>>>>>                        Set Label Of frmShow to ('†£œ¨ã© œª ‰˜«˜¤˜¢é©œ ª' + '-' + String(iMet)+'-'+String(sno))
60104>>>>>                        find gt anprod by index.4
60105>>>>>>
60105>>>>>                    Loop
60106>>>>>>
60106>>>>>                    if (icount=0) begin
60108>>>>>                        move 'ƒœ¤ ™¨âŸž¡˜¤ €¤˜¢é©œ ª ©«¦ „å›¦ª = ' to msgstr
60109>>>>>                        append msgstr witemxtd.witemx_code
60110>>>>>                        append msgstr ' ’. = '
60111>>>>>                        APPEND msgstr witemxtd.texnikh
60112>>>>>                        append msgstr ' “§¦¡˜« = '
60113>>>>>                        append msgstr witemxtr.branch_code
60114>>>>>                        error 3691 msgstr
60115>>>>>>
60115>>>>>                    End
60115>>>>>>
60115>>>>>                    find gt witemxtd by index.1
60116>>>>>>
60116>>>>>                Loop
60117>>>>>>
60117>>>>>                nextanaldd:
60117>>>>>                move (trim(anprod.anprod_item)) to sno
60118>>>>>                move anprod.recnum to imet
60119>>>>>                Set Label Of frmShow to ('†£œ¨ã© œª ‰˜«˜¤˜¢é©œ ª' + '-' + String(iMet)+'-'+String(sno))
60120>>>>>                find gt witemxtr by index.4
60121>>>>>>
60121>>>>>             Loop
60122>>>>>>
60122>>>>>             Send StartReport to Ranald
60123>>>>>             Send StartReport to Ranal90
60124>>>>>             Send StartReport to Ranal
60125>>>>>        End_Procedure
60126>>>>>        
60126>>>>>        procedure check_the_records
60128>>>>>            number nfpa nfpatot
60129>>>>>            integer iint
60129>>>>>            move 0 to iint
60130>>>>>            clear tmppol
60131>>>>>            find gt tmppol by index.1
60132>>>>>>
60132>>>>>            while (found)
60136>>>>>               if (tmppol.typos='01');                     move 0 to nfpa
60139>>>>>               if (tmppol.typos='03');                    add tmppol.posofpa to nfpa
60142>>>>>               if (tmppol.typos='05') begin
60144>>>>>                    move (abs(nfpa-tmppol.axia)) to nfpatot
60145>>>>>                    if (nfpatot > 1) move 1 to iint
60148>>>>>               end
60148>>>>>>
60148>>>>>               Set Label Of frmShow to ('„¢œš®¦ª à¢ã©œà¤' + '-' +String(Tmppol.arithmos))
60149>>>>>        
60149>>>>>               find gt tmppol by index.1
60150>>>>>>
60150>>>>>            Loop
60151>>>>>>
60151>>>>>            if (iint=1) ;               send info_box 'Ž‘Ž•† ˆ‡€ŒŽ ‘”€Š‹€ ‘’Ž €•„ˆŽ FI2. „Š„‚’„ ’Ž ”€ ‘’ˆ‘ „‰’“—‘„ˆ‘ —Š†‘„—Œ' 'Š†Ž”Žˆ€'
60154>>>>>        
60154>>>>>        end_procedure
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        
60155>>>>>        //AB-StoreEnd
60155>>>>>
60155>>>>>    End_Object    // btnMetasx
60156>>>>>
60156>>>>>    Object btnekt is a ButtonSub
60158>>>>>        Set Label to "ButtonSub1"
60159>>>>>        Set Bitmap to "printer.bmp"
60160>>>>>        Set Size to 21 24
60161>>>>>        Set Location to 183 11
60162>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
60163>>>>>
60163>>>>>        //AB-StoreStart
60163>>>>>        Set TooltipValue to "„¡«ç§à©ž ¡ ¤ã©œà¤ §¨¦ª „¢œš®¦ ! "
60164>>>>>        Procedure OnClick
60166>>>>>            date dapod
60167>>>>>            get value of frmapo to dapod
60168>>>>>            set pddate of rclsap to dapod
60169>>>>>            set piti of rclsap to (piepil(self))
60170>>>>>            Send runprom1Report to (prom1WQLReport(rclsap(Self)))
60171>>>>>        End_Procedure // OnClick
60172>>>>>        
60172>>>>>        
60172>>>>>        //AB-StoreEnd
60172>>>>>
60172>>>>>    End_Object    // btnekt
60173>>>>>
60173>>>>>    Object frmShow is a ButtonSub
60175>>>>>        Set Size to 14 267
60176>>>>>        Set Location to 146 57
60177>>>>>        Set Border_Style to Border_StaticEdge
60178>>>>>        Set Focus_Mode to Pointer_Only
60179>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
60180>>>>>
60180>>>>>        //AB-StoreStart
60180>>>>>        Procedure OnClick
60182>>>>>        
60182>>>>>        End_Procedure // OnClick
60183>>>>>        //AB-StoreEnd
60183>>>>>
60183>>>>>    End_Object    // frmShow
60184>>>>>
60184>>>>>    Object ButtonSub1 is a ButtonSub
60186>>>>>
60186>>>>>        //AB-StoreTopStart
60186>>>>>        
60186>>>>>        Property String psPath Public ''
60188>>>>>        
60188>>>>>        //AB-StoreTopEnd
60188>>>>>
60188>>>>>        Set Label to "ButtonSub1"
60189>>>>>        Set Bitmap to "AutoCopen.bmp"
60190>>>>>        Set Size to 21 24
60191>>>>>        Set Location to 173 354
60192>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
60193>>>>>
60193>>>>>        //AB-StoreStart
60193>>>>>        
60193>>>>>        Set TooltipValue to '„¥˜šàšã ©«¦ ˜¨®œå¦'
60194>>>>>        
60194>>>>>        
60194>>>>>        Function Verify_Ascii Integer aiFlag Returns Integer
60196>>>>>            Number  nPoso
60197>>>>>            Integer iDecs iLen iInt Imet iNum FileSize
60197>>>>>            Integer rVal iMhnas iEtos iHmera
60197>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
60197>>>>>            String sStr
60197>>>>>            Date    dapod deosd dhmnia
60197>>>>>            Move 0 to iNum
60198>>>>>        
60198>>>>>            Get value of frmapo item 0      to dapod
60199>>>>>            Get value of frmeos item 0      to deosd
60200>>>>>            clear Company
60201>>>>>            move syscurxr.company_code      to Company.company_code
60202>>>>>            find eq company by index.1
60203>>>>>>
60203>>>>>            move Company.company_c_code0    to stomeas
60204>>>>>            Move (TheDaySegment  (dapod))    to iHmera
60205>>>>>            Move (TheMonthSegment(dapod))    to iMhnas
60206>>>>>            Move (TheYearSegment(dapod))     to ietos
60207>>>>>            Move iHmera                     to sHmera
60208>>>>>            Move iMhnas                     to sMhnas
60209>>>>>            Move iEtos                      to sEtos
60210>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
60214>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
60218>>>>>        
60218>>>>>            If aiFlag Eq 1 Begin
60220>>>>>                Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt')   to sFileName
60221>>>>>                File_Size tmpclsap          to FileSize
60224>>>>>                Direct_Input Channel 9 sFileName
60226>>>>>                Readln Channel 9 sStr
60228>>>>>                While (Not(Seqeof))
60232>>>>>                    Add 1 to iNum
60233>>>>>                    Readln Channel 9 sStr
60235>>>>>                Loop
60236>>>>>>
60236>>>>>                Close_Input Channel 9
60238>>>>>                Function_Return (iNum=FileSize)
60239>>>>>            End
60239>>>>>>
60239>>>>>            Else If aiFlag Eq 2 Begin
60242>>>>>                Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
60243>>>>>                File_Size TmpPol          to FileSize
60246>>>>>                Direct_Input Channel 9 sFileName
60248>>>>>                Readln Channel 9 sStr
60250>>>>>                While (Not(Seqeof))
60254>>>>>                    Add 1 to iNum
60255>>>>>                    Readln Channel 9 sStr
60257>>>>>                Loop
60258>>>>>>
60258>>>>>                Close_Input Channel 9
60260>>>>>                Function_Return (iNum=FileSize)
60261>>>>>            End
60261>>>>>>
60261>>>>>            Else If aiFlag Eq 3 Begin
60264>>>>>                Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
60265>>>>>                File_Size tmpAxio         to FileSize
60268>>>>>                Direct_Input Channel 9 sFileName
60270>>>>>                Readln Channel 9 sStr
60272>>>>>                While (Not(Seqeof))
60276>>>>>                    Add 1 to iNum
60277>>>>>                    Readln Channel 9 sStr
60279>>>>>                Loop
60280>>>>>>
60280>>>>>                Close_Input Channel 9
60282>>>>>                Function_Return (iNum=FileSize)
60283>>>>>            End
60283>>>>>>
60283>>>>>            Else If aiFlag Eq 4 Begin
60286>>>>>                Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
60287>>>>>                File_Size Tmpapoth        to FileSize
60290>>>>>                Direct_Input Channel 9 sFileName
60292>>>>>                Readln Channel 9 sStr
60294>>>>>                While (Not(Seqeof))
60298>>>>>                    Add 1 to iNum
60299>>>>>                    Readln Channel 9 sStr
60301>>>>>                Loop
60302>>>>>>
60302>>>>>                Close_Input Channel 9
60304>>>>>                Function_Return (iNum=FileSize)
60305>>>>>            End
60305>>>>>>
60305>>>>>            Else If aiFlag Eq 5 Begin
60308>>>>>                Move (psPath(Self)+Trim(stomeas)+'PP1'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
60309>>>>>                File_Size Tmptehn         to FileSize
60312>>>>>                Direct_Input Channel 9 sFileName
60314>>>>>                Readln Channel 9 sStr
60316>>>>>                While (Not(Seqeof))
60320>>>>>                    Add 1 to iNum
60321>>>>>                    Readln Channel 9 sStr
60323>>>>>                Loop
60324>>>>>>
60324>>>>>                Close_Input Channel 9
60326>>>>>                Function_Return (iNum=FileSize)
60327>>>>>            End
60327>>>>>>
60327>>>>>            Else If aiFlag Eq 6 Begin
60330>>>>>                Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
60331>>>>>                File_Size TmpAnal         to FileSize
60334>>>>>                Direct_Input Channel 9 sFileName
60336>>>>>                Readln Channel 9 sStr
60338>>>>>                While (Not(Seqeof))
60342>>>>>                    Add 1 to iNum
60343>>>>>                    Readln Channel 9 sStr
60345>>>>>                Loop
60346>>>>>>
60346>>>>>                Close_Input Channel 9
60348>>>>>                Function_Return (iNum=FileSize)
60349>>>>>            End
60349>>>>>>
60349>>>>>            Function_Return 1
60350>>>>>        End_function
60351>>>>>        
60351>>>>>        
60351>>>>>        // Grapsimo ton records
60351>>>>>        // na arxeio xexoristo ana hmera
60351>>>>>        // me onoma xxxxzzzyyyymmhh opou xxxx=Branch.code zzz onoma arxeioy
60351>>>>>        // yyyymmhh etos-mhnas-mera eggrafon
60351>>>>>        Procedure Write_Record_Pel
60353>>>>>            Number  nPoso
60354>>>>>            Integer iDecs iLen iInt Imet Inum  isChecked
60354>>>>>            Integer rVal iMhnas iEtos iHmera
60354>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas  lsTheAppPath
60354>>>>>            String sstr scodem  skeno
60354>>>>>            Date    dapod deosd dhmnia
60354>>>>>            Get value of frmapo item 0 to dapod
60355>>>>>            Get value of frmeos item 0 to deosd
60356>>>>>        
60356>>>>>            Set Label Of frmShow to ''
60357>>>>>            clear Company
60358>>>>>            move syscurxr.company_code to Company.company_code
60359>>>>>            find eq company by index.1
60360>>>>>>
60360>>>>>            move Company.company_c_code0 to stomeas
60361>>>>>        
60361>>>>>        //    move syscurxr.branch_code       to sbranch
60361>>>>>            Move (TheDaySegment  (dapod))    to iHmera
60362>>>>>            Move (TheMonthSegment(dapod))    to iMhnas
60363>>>>>            Move (TheYearSegment(dapod))     to ietos
60364>>>>>            Move iHmera                     to sHmera
60365>>>>>            Move iMhnas                     to sMhnas
60366>>>>>            Move iEtos                      to sEtos
60367>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
60371>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
60375>>>>>        //    Move ('C:\'+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
60375>>>>>            Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
60376>>>>>            EraseFile sFileName
60377>>>>>>
60377>>>>>            Append_Output Channel 9 sFileName
60379>>>>>            clear tmpclsap
60380>>>>>            find gt tmpclsap.recnum
60381>>>>>>
60381>>>>>            while (found)
60385>>>>>                Write   Channel 9 (Pad(Trim(tmpclsap.onoma)                ,  3))
60387>>>>>                move tmpclsap.typos to sposo
60388>>>>>                Write   Channel 9 (Pad(sposo                               ,  2))
60390>>>>>                Write   Channel 9 (Pad(tmpclsap.etairia                    ,  4))
60392>>>>>                Write   Channel 9 (Pad(tmpclsap.branch_site                ,  4))
60394>>>>>                Write   Channel 9 (Pad(tmpclsap.type                       ,  1))
60396>>>>>                Write   Channel 9 (Pad(tmpclsap.code                       , 10))
60398>>>>>                move    tmpclsap.code to sid
60399>>>>>                move syscurxr.company_code to scomp
60400>>>>>                insert '.' in scomp at 3
60402>>>>>                Write   Channel 9 (Pad(sstr                                , 10))
60404>>>>>                Write   Channel 9 (Pad(tmpclsap.group                      ,  4))
60406>>>>>                Write   Channel 9 (Pad(tmpclsap.endoomil                    , 6))
60408>>>>>                Write   Channel 9 (Pad(tmpclsap.anal                        , 1))
60410>>>>>                Write   Channel 9 (Pad(tmpclsap.category                    , 2))
60412>>>>>                Write   Channel 9 (Pad(tmpclsap.afm                         ,11))
60414>>>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.name)                ,40))
60416>>>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.occup)               ,40))
60418>>>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.city)                ,40))
60420>>>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.address)             ,60))
60422>>>>>                Move (trim(tmpclsap.add_no))            to sPoso
60423>>>>>                Write   Channel 9 (Pad(ToAnsi(sPoso)                        ,03))
60425>>>>>                Move (trim(tmpclsap.zipcode))            to sPoso
60426>>>>>                if ((sposo='') and (tmpclsap.typos='01'));                    move '00000' to sposo
60429>>>>>                Write   Channel 9 (Pad(sPoso                                ,10))
60431>>>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.doy)                 ,40))
60433>>>>>                Move (trim(tmpclsap.telfax))            to sPoso
60434>>>>>                Move (Trim(sPoso))                      to sPoso
60435>>>>>                Move (Length(sPoso))                    to iLen
60436>>>>>                For iInt From 1 to (14-iLen)
60442>>>>>>
60442>>>>>                    Move (Insert(" ", sPoso,1))         to sPoso
60443>>>>>                Loop
60444>>>>>>
60444>>>>>                Write   Channel 9 (Pad(ToAnsi(sPoso)                        ,14))
60446>>>>>                Write   Channel 9 (Pad(tmpclsap.country                     , 2))
60448>>>>>                Write   Channel 9 (Pad(tmpclsap.language                    , 2))
60450>>>>>        
60450>>>>>                Move (GetTheAppPath(Self)) to lsTheAppPath
60451>>>>>                if (sysfile.serial_number='1')begin
60453>>>>>                    IF (TMPCLSAP.TYPOS='90') BEGIN
60455>>>>>                        Write   Channel 9 (Pad(skeno      , 10))
60457>>>>>                    end
60457>>>>>>
60457>>>>>                    else begin
60458>>>>>                        Clear clients
60459>>>>>                        Move Tmpclsap.oldcode to scodem
60460>>>>>                        move (trim(scodem)) to scodem
60461>>>>>                        move scodem to clients.client_id
60462>>>>>                        find eq clients by index.6
60463>>>>>>
60463>>>>>                        if (found);                              Write   Channel 9 (Pad(clients.client_codem      , 10))
60467>>>>>                        else;                              Write   Channel 9 (Pad(skeno      , 10))
60470>>>>>                    End
60470>>>>>>
60470>>>>>                End
60470>>>>>>
60470>>>>>        
60470>>>>>        
60470>>>>>                Writeln Channel 9
60472>>>>>                add 1 to imet
60473>>>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpclsap.code))
60474>>>>>                find gt tmpclsap.recnum
60475>>>>>>
60475>>>>>            Loop
60476>>>>>>
60476>>>>>            Close_Output Channel 9
60478>>>>>        End_Procedure
60479>>>>>        
60479>>>>>        
60479>>>>>        // Grapsimo ton eisprakseon
60479>>>>>        Procedure Write_Record_Axio
60481>>>>>            Number  nPoso
60482>>>>>            Integer iDecs iLen iInt Imet ipos idiafora  isChecked
60482>>>>>            Integer rVal iMhnas iEtos iHmera
60482>>>>>            string sperioxh lsTheAppPath
60482>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
60482>>>>>            Date    dapod
60482>>>>>            get value of frmapo to dapod
60483>>>>>            clear Company
60484>>>>>            move syscurxr.company_code to Company.company_code
60485>>>>>            find eq company by index.1
60486>>>>>>
60486>>>>>            move Company.company_c_code0 to stomeas
60487>>>>>            Move (TheDaySegment  (dapod))  to iHmera
60488>>>>>            Move (TheMonthSegment(dapod))  to iMhnas
60489>>>>>            Move (TheYearSegment(dapod))   to ietos
60490>>>>>            Move iHmera                     to sHmera
60491>>>>>            Move iMhnas                     to sMhnas
60492>>>>>            Move iEtos                      to sEtos
60493>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
60497>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
60501>>>>>            Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
60502>>>>>            EraseFile sFileName
60503>>>>>>
60503>>>>>            Append_Output Channel 8 sFileName
60505>>>>>            clear TmpAxio
60506>>>>>            find gt TmpAxio.recnum
60507>>>>>>
60507>>>>>            while (found)
60511>>>>>                Write   Channel 8 (Pad(Trim(TmpAxio.onoma)                 ,  3))
60513>>>>>                Write   Channel 8 (Pad(Trim(TmpAxio.typos)                 ,  2))
60515>>>>>                Write   Channel 8 (Pad(tmpaxio.etairia                     ,  4))
60517>>>>>                MOVE tmpaxio.typos to sposo
60518>>>>>                if ((sposo='90') or (sposo='91') or (sposo='92') or (sposo='93') or (sposo='94')) begin
60520>>>>>                     move tmpaxio.egkatastash to sposo
60521>>>>>                   //  move stomeas to sposo
60521>>>>>                     Write   Channel 8 (Pad(trim(sposo)                    ,  4))
60523>>>>>                     move '' to sposo
60524>>>>>                     Write   Channel 8 (Pad(trim(sposo)                    ,  4))
60526>>>>>                end
60526>>>>>>
60526>>>>>                else begin
60527>>>>>                    move tmpaxio.perioxh to sposo
60528>>>>>                    Write   Channel 8 (Pad(trim(sposo)                     ,  4))
60530>>>>>                    move tmpaxio.egkatastash to sposo
60531>>>>>                    Write   Channel 8 (Pad(trim(sposo)                     ,  4))
60533>>>>>                end
60533>>>>>>
60533>>>>>                Write   Channel 8 (Pad(trim(tmpaxio.type)                  ,  4))
60535>>>>>        
60535>>>>>                Move TmpAxio.arithmos                 to sPoso
60536>>>>>                Move (Trim(sPoso))                    to sPoso
60537>>>>>                Move (Length(sPoso))                  to iLen
60538>>>>>                For iInt From 1 to (10-iLen)
60544>>>>>>
60544>>>>>                    Move (Insert(" ", sPoso,1))       to sPoso
60545>>>>>                Loop
60546>>>>>>
60546>>>>>                Write   Channel 8 (Pad(sposo                               , 10))
60548>>>>>                Move Tmpaxio.Hmnia         to sHmnia
60549>>>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
60550>>>>>                Write   Channel 8 (Pad(sHmnia                               , 8))
60552>>>>>                Write   Channel 8 (Pad(tmpaxio.perigrafh                    , 1))
60554>>>>>                Move (ROUnD_number(tmpaxio.axia,2))     to nPoso
60555>>>>>                move nposo to sposo
60556>>>>>                Move (Trim(sPoso))                      to sPoso
60557>>>>>                Move (Pos('.',sPoso))   to iPos
60558>>>>>                Move (Length(sPoso))    to iLen
60559>>>>>                Move (iLen-iPos)       to iDiafora
60560>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.00'
60563>>>>>                Else Begin
60564>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
60564>>>>>                If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
60567>>>>>                End
60567>>>>>>
60567>>>>>            // 24/03/2004 allagh. Ta dekadika einai panta ta 2 teleytaia
60567>>>>>            // psifia ara h teleia feygei
60567>>>>>                Move (Replace('.',sPoso,'')) to sPoso
60568>>>>>                Move (Length(sPoso))                    to iLen
60569>>>>>                For iInt From 1 to (16-iLen)
60575>>>>>>
60575>>>>>                    Move (Insert(" ", sPoso,1))         to sPoso
60576>>>>>                Loop
60577>>>>>>
60577>>>>>        
60577>>>>>        
60577>>>>>                Write   Channel 8 (Pad(sPoso                                ,16))
60579>>>>>                Write   Channel 8 (Pad(tmpaxio.code                         ,10))
60581>>>>>                Write   Channel 8 (Pad(ToAnsi(tmpaxio.aitiol)               ,50))
60583>>>>>                Move Tmpaxio.lhxh     to sHmnia
60584>>>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
60585>>>>>                Write   Channel 8 (Pad(sHmnia                               , 8))
60587>>>>>                Write   Channel 8 (Pad(trim(tmpaxio.bank)                   ,15))
60589>>>>>                move '' to sid
60590>>>>>                Write   Channel 8 (Pad(sid                                  ,25))
60592>>>>>                Write   Channel 8 (Pad(ToAnsi(tmpaxio.apodekths)            ,25))
60594>>>>>                Write   Channel 8 (Pad(trim(tmpaxio.noepit)                 ,18))
60596>>>>>                Write   Channel 8 (Pad(tmpaxio.xora                         , 2))
60598>>>>>                Write   Channel 8 (Pad(tmpaxio.idioy                        , 1))
60600>>>>>                Write   Channel 8 (Pad(tmpaxio.eparxia                      , 1))
60602>>>>>                Write   Channel 8 (Pad(trim(tmpaxio.nomisma)                , 3))
60604>>>>>                Write   Channel 8 (Pad(trim(tmpaxio.anal)                   , 2))
60606>>>>>        
60606>>>>>                if (sysfile.serial_number='1') begin
60608>>>>>                    Move TmpAxio.pae_arithm           to sPoso
60609>>>>>                    Move (Trim(sPoso))                to sPoso
60610>>>>>                    Move (Length(sPoso))              to iLen
60611>>>>>                    For iInt From 1 to (10-iLen)
60617>>>>>>
60617>>>>>                        Move (Insert(" ", sPoso,1))       to sPoso
60618>>>>>                    Loop
60619>>>>>>
60619>>>>>        
60619>>>>>                    Write   Channel 8 (Pad(sposo                               , 10))
60621>>>>>                    Move Tmpaxio.pae_hmnia     to sHmnia
60622>>>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
60623>>>>>                    Write   Channel 8 (Pad(sHmnia                               , 8))
60625>>>>>        
60625>>>>>                End
60625>>>>>>
60625>>>>>                Writeln Channel 8
60627>>>>>                add 1 to imet
60628>>>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpaxio.code))
60629>>>>>                find gt Tmpaxio.recnum
60630>>>>>>
60630>>>>>            Loop
60631>>>>>>
60631>>>>>            Close_Output Channel 8
60633>>>>>        End_Procedure
60634>>>>>        
60634>>>>>        Procedure Write_record_polhseon
60636>>>>>            Number  nPoso
60637>>>>>            Integer iDecs iLen iInt Imet ipos idiafora
60637>>>>>            Integer rVal iMhnas iEtos iHmera
60637>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
60637>>>>>            string skeno senter stext sstr
60637>>>>>            Date    dapod
60637>>>>>            get value of frmapo to dapod
60638>>>>>            clear Company
60639>>>>>            move syscurxr.company_code to Company.company_code
60640>>>>>            find eq company by index.1
60641>>>>>>
60641>>>>>            move Company.company_c_code0 to stomeas
60642>>>>>            Move (TheDaySegment  (dapod))  to iHmera
60643>>>>>            Move (TheMonthSegment(dapod))  to iMhnas
60644>>>>>            Move (TheYearSegment(dapod))   to ietos
60645>>>>>            Move iHmera                   to sHmera
60646>>>>>            Move iMhnas                   to sMhnas
60647>>>>>            Move iEtos                    to sEtos
60648>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
60652>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
60656>>>>>            Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
60657>>>>>            EraseFile sFileName
60658>>>>>>
60658>>>>>            Append_Output Channel 7 sFileName
60660>>>>>            clear TmpPol
60661>>>>>            find gt Tmppol by index.1
60662>>>>>>
60662>>>>>        
60662>>>>>            while (found)
60666>>>>>                Write   Channel 7 (Pad(Trim(Tmppol.onoma)                 ,  3))
60668>>>>>                Write   Channel 7 (Pad(Trim(Tmppol.typos)                 ,  2))
60670>>>>>                Write   Channel 7 (Pad(tmppol.etairia                     ,  4))
60672>>>>>                Write   Channel 7 (Pad(trim(tmppol.egkatastash)           ,  4))
60674>>>>>                if (tmppol.type ='9999');                   Write   Channel 7 (Pad(trim(skeno)                     ,  4))
60678>>>>>                else;                   Write   Channel 7 (Pad(trim(tmppol.perioxh)        ,  4))
60681>>>>>                Write   Channel 7 (Pad(trim(tmppol.type)                  ,  4))
60683>>>>>        
60683>>>>>        
60683>>>>>                Move Tmppol.arithmos                 to sPoso
60684>>>>>                Move (Trim(sPoso))                   to sPoso
60685>>>>>                Move (Length(sPoso))                 to iLen
60686>>>>>                For iInt From 1 to (10-iLen)
60692>>>>>>
60692>>>>>                    Move (Insert(" ", sPoso,1))       to sPoso
60693>>>>>                Loop
60694>>>>>>
60694>>>>>                Write   Channel 7 (Pad(ToAnsi(sposo)                       , 10))
60696>>>>>        
60696>>>>>                Move Tmppol.Hmnia         to sHmnia
60697>>>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
60698>>>>>                Write   Channel 7 (Pad(sHmnia                               , 8))
60700>>>>>                Write   Channel 7 (Pad(trim(tmppol.kodikos)                 , 5))
60702>>>>>        
60702>>>>>        
60702>>>>>                //**************************************
60702>>>>>                Move (ROUnD_number(tmppol.axia,2))     to nPoso
60703>>>>>                move nposo to sposo
60704>>>>>                Move (Trim(sPoso))                      to sPoso
60705>>>>>                Move (Pos('.',sPoso))   to iPos
60706>>>>>                Move (Length(sPoso))    to iLen
60707>>>>>                Move (iLen-iPos)       to iDiafora
60708>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.00'
60711>>>>>                Else Begin
60712>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
60712>>>>>                If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
60715>>>>>                End
60715>>>>>>
60715>>>>>            // 24/03/2004 allagh. Ta dekadika einai panta ta 2 teleytaia
60715>>>>>            // psifia ara h teleia feygei
60715>>>>>                Move (Replace('.',sPoso,'')) to sPoso
60716>>>>>                Move (Length(sPoso))                    to iLen
60717>>>>>                For iInt From 1 to (16-iLen)
60723>>>>>>
60723>>>>>                    Move (Insert(" ", sPoso,1))         to sPoso
60724>>>>>                Loop
60725>>>>>>
60725>>>>>                //**************************************
60725>>>>>                if (tmppol.typos='06') move '' to sposo
60728>>>>>                Write   Channel 7 (Pad(sPoso                                ,16))
60730>>>>>                Write   Channel 7 (Pad(tmppol.code                          ,10))
60732>>>>>                Write   Channel 7 (Pad(tmppol.kodikos2                      , 2))
60734>>>>>                Write   Channel 7 (Pad(ToAnsi(tmppol.apoth)                 ,18))
60736>>>>>                Move (Round_Number(tmppol.qty,3))   to nPoso
60737>>>>>                MOVE nposo  TO SPOSO
60738>>>>>                Move (Trim(sPoso))                    to sPoso
60739>>>>>                Move (Pos('.',sPoso))   to iPos
60740>>>>>                Move (Length(sPoso))    to iLen
60741>>>>>                Move (iLen-iPos)     to iDiafora
60742>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
60745>>>>>                Else Begin
60746>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
60746>>>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
60749>>>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
60753>>>>>                End
60753>>>>>>
60753>>>>>                Move (Replace('.',sPoso,'')) to sPoso
60754>>>>>                Move (Length(sPoso))                   to iLen
60755>>>>>                For iInt From 1 to (13-iLen)
60761>>>>>>
60761>>>>>                   Move (Insert(" ", sPoso,1))         to sPoso
60762>>>>>                Loop
60763>>>>>>
60763>>>>>                if (tmppol.typos='06') move '' to sposo
60766>>>>>                Write   Channel 7 (Pad(sPoso                                ,13))
60768>>>>>                Write   Channel 7 (Pad(trim(tmppol.mm)                      , 3))
60770>>>>>                if (tmppol.typos='06') begin
60772>>>>>                    move '' to tmppol.kathgoria
60773>>>>>                    move '' to tmppol.antlhsh
60774>>>>>                    move '' to tmppol.pinakida
60775>>>>>                    move '' to tmppol.fpa
60776>>>>>                end
60776>>>>>>
60776>>>>>                Write   Channel 7 (Pad(trim(tmppol.kathgoria)               , 1))
60778>>>>>                Write   Channel 7 (Pad(trim(tmppol.antlhsh)                 , 1))
60780>>>>>                Write   Channel 7 (Pad(ToAnsi(tmppol.pinakida)              ,12))
60782>>>>>                Write   Channel 7 (Pad(trim(tmppol.oroi)                    , 4))
60784>>>>>                Write   Channel 7 (Pad(trim(tmppol.fpa)                     , 2))
60786>>>>>                Move (ROUnD_number(tmppol.posofpa,2))     to nPoso
60787>>>>>                move nposo to sposo
60788>>>>>                Move (Trim(sPoso))                      to sPoso
60789>>>>>                Move (Pos('.',sPoso))   to iPos
60790>>>>>                Move (Length(sPoso))    to iLen
60791>>>>>                Move (iLen-iPos)       to iDiafora
60792>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.00'
60795>>>>>                Else Begin
60796>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
60796>>>>>                If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
60799>>>>>                End
60799>>>>>>
60799>>>>>                Move (Replace('.',sPoso,'')) to sPoso
60800>>>>>                Move (Length(sPoso))                    to iLen
60801>>>>>                For iInt From 1 to (16-iLen)
60807>>>>>>
60807>>>>>                    Move (Insert(" ", sPoso,1))         to sPoso
60808>>>>>                Loop
60809>>>>>>
60809>>>>>                if ((tmppol.typos='06')or(tmppol.typos='05')or(tmppol.typos='01'));                      move '' to sposo
60812>>>>>                Write   Channel 7 (Pad(sPoso                                ,16))
60814>>>>>                Write   Channel 7 (Pad(trim(tmppol.nomisma)                 , 5))
60816>>>>>                Write   Channel 7 (Pad(toansi(tmppol.deltia)                ,10))
60818>>>>>                Move '' to sEnter
60819>>>>>                move tmppol.sxolia to stext
60820>>>>>                Append sEnter (Character(13)) (Character(10))
60822>>>>>                Move (Replaces(sEnter,sText,' ')) to sText
60823>>>>>                Move stext to sStr
60824>>>>>                Append sStr ' '
60825>>>>>                move (Length(sStr)) to iLen
60826>>>>>                For iInt From 1 to iLen
60832>>>>>>
60832>>>>>                    If (iInt>50) Break
60835>>>>>                Loop
60836>>>>>>
60836>>>>>        
60836>>>>>                Write   Channel 7 (Pad(ToAnsi(sstr)                        ,50))
60838>>>>>                Writeln Channel 7
60840>>>>>                add 1 to imet
60841>>>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmppol.code))
60842>>>>>                find gt Tmppol by index.1
60843>>>>>>
60843>>>>>            Loop
60844>>>>>>
60844>>>>>            Close_Output Channel 7
60846>>>>>        
60846>>>>>        End_Procedure
60847>>>>>        
60847>>>>>        Procedure Write_Record_Apoth
60849>>>>>            Number  nPoso
60850>>>>>            Integer iDecs iLen iInt Imet idiafora ipos
60850>>>>>            Integer rVal iMhnas iEtos iHmera
60850>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
60850>>>>>            Date    dapod
60850>>>>>            get value of frmapo to dapod
60851>>>>>            clear Company
60852>>>>>            move syscurxr.company_code to Company.company_code
60853>>>>>            find eq company by index.1
60854>>>>>>
60854>>>>>            move Company.company_c_code0 to stomeas
60855>>>>>        
60855>>>>>            Move (TheDaySegment  (dapod))  to iHmera
60856>>>>>            Move (TheMonthSegment(dapod))  to iMhnas
60857>>>>>            Move (TheYearSegment(dapod))   to ietos
60858>>>>>            Move iHmera                     to sHmera
60859>>>>>            Move iMhnas                     to sMhnas
60860>>>>>            Move iEtos                      to sEtos
60861>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
60865>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
60869>>>>>            Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
60870>>>>>            EraseFile sFileName
60871>>>>>>
60871>>>>>            Append_Output Channel 5 sFileName
60873>>>>>            clear Tmpapoth
60874>>>>>            find gt TmpApoth.recnum
60875>>>>>>
60875>>>>>            while (found)
60879>>>>>                Write   Channel 5 (Pad(Trim(Tmpapoth.onoma)                ,  3))
60881>>>>>                Write   Channel 5 (Pad(Trim(Tmpapoth.typos)                ,  2))
60883>>>>>                if (Tmpapoth.typos='90');                    move stomeas to sposo
60886>>>>>                else;                    move tmpapoth.egkatastash to sposo
60888>>>>>                Write   Channel 5 (Pad(trim(sposo)                        ,  4))
60890>>>>>        
60890>>>>>                Move TmpApoth.arithmos                to sPoso
60891>>>>>        
60891>>>>>                Write   Channel 5 (Pad(ToAnsi(sposo)                      , 16))
60893>>>>>                Move Tmpapoth.Hmnia         to sHmnia
60894>>>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
60895>>>>>                Write   Channel 5 (Pad(sHmnia                               , 8))
60897>>>>>                Write   Channel 5 (Pad(trim(tmpapoth.type)                  , 3))
60899>>>>>                Write   Channel 5 (Pad(tmpapoth.code                        ,10))
60901>>>>>                Write   Channel 5 (Pad(ToAnsi(tmpapoth.item)                ,18))
60903>>>>>                Move (Round_Number(tmpapoth.qty,3))   to nPoso
60904>>>>>                MOVE nposo  TO SPOSO
60905>>>>>                Move (Trim(sPoso))                    to sPoso
60906>>>>>                Move (Pos('.',sPoso))   to iPos
60907>>>>>                Move (Length(sPoso))    to iLen
60908>>>>>                Move (iLen-iPos)     to iDiafora
60909>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
60912>>>>>                Else Begin
60913>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
60913>>>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
60916>>>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
60920>>>>>                End
60920>>>>>>
60920>>>>>                Move (Replace('.',sPoso,'')) to sPoso
60921>>>>>                Move (Length(sPoso))                   to iLen
60922>>>>>                For iInt From 1 to (13-iLen)
60928>>>>>>
60928>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
60929>>>>>                Loop
60930>>>>>>
60930>>>>>        
60930>>>>>                Write   Channel 5 (Pad(sPoso                                ,13))
60932>>>>>                Write   Channel 5 (Pad(trim(tmpapoth.monada)                ,03))
60934>>>>>                Write   Channel 5 (Pad(trim(tmpapoth.paralabh)              ,04))
60936>>>>>                move tmpapoth.pinakida to sposo
60937>>>>>                if ((Tmpapoth.typos='90') or (tmpapoth.typos='91'));                    move '' to sposo
60940>>>>>                Move (Replace(' ',sPoso,'')) to sPoso
60941>>>>>                Write   Channel 5 (Pad(ToAnsi(sposo)                        ,10))
60943>>>>>                Writeln Channel 5
60945>>>>>                add 1 to imet
60946>>>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpapoth.code))
60947>>>>>                find gt Tmpapoth.recnum
60948>>>>>>
60948>>>>>            Loop
60949>>>>>>
60949>>>>>            Close_Output Channel 5
60951>>>>>        End_Procedure
60952>>>>>        // grapsimo arxeioy texn.prodiagrafon
60952>>>>>        Procedure Write_Record_tehn
60954>>>>>            Number  nPoso
60955>>>>>            Integer iDecs iLen iInt Imet idiafora ipos
60955>>>>>            Integer rVal iMhnas iEtos iHmera
60955>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
60955>>>>>            Date    dapod
60955>>>>>            get value of frmapo to dapod
60956>>>>>            clear Company
60957>>>>>            move syscurxr.company_code to Company.company_code
60958>>>>>            find eq company by index.1
60959>>>>>>
60959>>>>>            move Company.company_c_code0 to stomeas
60960>>>>>        
60960>>>>>            Move (TheDaySegment  (dapod))  to iHmera
60961>>>>>            Move (TheMonthSegment(dapod))  to iMhnas
60962>>>>>            Move (TheYearSegment(dapod))   to ietos
60963>>>>>            Move iHmera                     to sHmera
60964>>>>>            Move iMhnas                     to sMhnas
60965>>>>>            Move iEtos                      to sEtos
60966>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
60970>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
60974>>>>>            Move (psPath(Self)+Trim(stomeas)+'PP1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
60975>>>>>            EraseFile sFileName
60976>>>>>>
60976>>>>>            Append_Output Channel 5 sFileName
60978>>>>>            clear Tmptehn
60979>>>>>            find gt Tmptehn by index.3
60980>>>>>>
60980>>>>>            while (found)
60984>>>>>                Write   Channel 5 (Pad(Trim(Tmptehn.onoma)                ,  3))
60986>>>>>                Write   Channel 5 (Pad(Trim(Tmptehn.typos)                ,  2))
60988>>>>>                if (tmptehn.typos='90') move stomeas to sposo
60991>>>>>                else move  tmptehn.egkatastash to sposo
60993>>>>>                Write   Channel 5 (Pad(trim(sposo)                        ,  4))
60995>>>>>                Write   Channel 5 (Pad(ToAnsi(tmptehn.item)                ,18))
60997>>>>>                Write   Channel 5 (Pad(trim(tmptehn.prodiagrafh)           ,12))
60999>>>>>                Move tmptehn.type   to nPoso
61000>>>>>                MOVE nposo  TO SPOSO
61001>>>>>                Move (Trim(sPoso))                    to sPoso
61002>>>>>                Move (Pos('.',sPoso))   to iPos
61003>>>>>                Move (Length(sPoso))    to iLen
61004>>>>>                Move (iLen-iPos)     to iDiafora
61005>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
61008>>>>>                Else Begin
61009>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
61009>>>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
61012>>>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
61016>>>>>                End
61016>>>>>>
61016>>>>>                Move (Replace('.',sPoso,'')) to sPoso
61017>>>>>                Move (Length(sPoso))                   to iLen
61018>>>>>                For iInt From 1 to (13-iLen)
61024>>>>>>
61024>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
61025>>>>>                Loop
61026>>>>>>
61026>>>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
61028>>>>>                Write   Channel 5 (Pad(trim(tmptehn.mm)                ,03))
61030>>>>>        
61030>>>>>                move tmptehn.aa to sposo
61031>>>>>                Move (Length(sPoso))                   to iLen
61032>>>>>                For iInt From 1 to (4-iLen)
61038>>>>>>
61038>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
61039>>>>>                Loop
61040>>>>>>
61040>>>>>                if (tmptehn.typos='90');                    move '' to sposo
61043>>>>>                Write   Channel 5 (Pad(sPoso                            ,4))
61045>>>>>                Write   Channel 5 (Pad(ToAnsi(tmptehn.itemd)            ,18))
61047>>>>>                move tmptehn.qty to nposo
61048>>>>>                MOVE nposo  TO SPOSO
61049>>>>>                Move (Trim(sPoso))                    to sPoso
61050>>>>>                Move (Pos('.',sPoso))   to iPos
61051>>>>>                Move (Length(sPoso))    to iLen
61052>>>>>                Move (iLen-iPos)     to iDiafora
61053>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
61056>>>>>                Else Begin
61057>>>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
61060>>>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
61064>>>>>                End
61064>>>>>>
61064>>>>>                Move (Replace('.',sPoso,'')) to sPoso
61065>>>>>                Move (Length(sPoso))                   to iLen
61066>>>>>                For iInt From 1 to (13-iLen)
61072>>>>>>
61072>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
61073>>>>>                Loop
61074>>>>>>
61074>>>>>                if (tmptehn.typos='90');                    move '' to sposo
61077>>>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
61079>>>>>        
61079>>>>>                Write   Channel 5 (Pad(trim(tmptehn.mmitemd)           ,03))
61081>>>>>                if (tmptehn.typos='90') begin
61083>>>>>                    move '' to sposo
61084>>>>>                    Write   Channel 5 (Pad(sposo                       ,01))
61086>>>>>                end
61086>>>>>>
61086>>>>>                else;                    Write   Channel 5 (Pad(tmptehn.index               ,01))
61089>>>>>                Writeln Channel 5
61091>>>>>                add 1 to imet
61092>>>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmptehn.recnum))
61093>>>>>                find gt Tmptehn by index.3
61094>>>>>>
61094>>>>>            Loop
61095>>>>>>
61095>>>>>            Close_Output Channel 5
61097>>>>>        End_Procedure
61098>>>>>        
61098>>>>>        Procedure Write_Record_Anal
61100>>>>>            Number  nPoso
61101>>>>>            Integer iDecs iLen iInt Imet idiafora ipos
61101>>>>>            Integer rVal iMhnas iEtos iHmera
61101>>>>>            string s1 s2
61101>>>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
61101>>>>>            Date    dapod
61101>>>>>            get value of frmapo to dapod
61102>>>>>            clear Company
61103>>>>>            move syscurxr.company_code to Company.company_code
61104>>>>>            find eq company by index.1
61105>>>>>>
61105>>>>>            move Company.company_c_code0 to stomeas
61106>>>>>        
61106>>>>>            Move (TheDaySegment  (dapod))  to iHmera
61107>>>>>            Move (TheMonthSegment(dapod))  to iMhnas
61108>>>>>            Move (TheYearSegment(dapod))   to ietos
61109>>>>>            Move iHmera                     to sHmera
61110>>>>>            Move iMhnas                     to sMhnas
61111>>>>>            Move iEtos                      to sEtos
61112>>>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
61116>>>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
61120>>>>>            Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
61121>>>>>            EraseFile sFileName
61122>>>>>>
61122>>>>>            Append_Output Channel 5 sFileName
61124>>>>>            clear TmpAnal
61125>>>>>            find gt TmpAnal by index.5
61126>>>>>>
61126>>>>>            while (found)
61130>>>>>                Write   Channel 5 (Pad(Trim(TmpAnal.onoma)                ,  3))
61132>>>>>                Write   Channel 5 (Pad(Trim(TmpAnal.typos)                ,  2))
61134>>>>>                Move Tmpanal.Hmnia         to sHmnia
61135>>>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
61136>>>>>                Write   Channel 5 (Pad(sHmnia                              , 8))
61138>>>>>                move stomeas to sposo
61139>>>>>                if (tmpanal.typos='92');                    Write   Channel 5 (Pad(trim(sposo)                    ,  4))
61143>>>>>                else;                    Write   Channel 5 (Pad(trim(tmpAnal.egkatastash)      ,  4))
61146>>>>>                Write   Channel 5 (Pad(ToAnsi(tmpANAL.item)                ,18))
61148>>>>>                Write   Channel 5 (Pad(trim(tmpAnal.trmetaf)              ,  4))
61150>>>>>                Write   Channel 5 (Pad(trim(tmpanal.prodiagrafh)           ,12))
61152>>>>>                Move tmpanal.qty   to nPoso
61153>>>>>                MOVE nposo  TO SPOSO
61154>>>>>                Move (Trim(sPoso))                    to sPoso
61155>>>>>                Move (Pos('.',sPoso))   to iPos
61156>>>>>                Move (Length(sPoso))    to iLen
61157>>>>>                Move (iLen-iPos)     to iDiafora
61158>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
61161>>>>>                Else Begin
61162>>>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
61162>>>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
61165>>>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
61169>>>>>                End
61169>>>>>>
61169>>>>>                Move (Replace('.',sPoso,'')) to sPoso
61170>>>>>                Move (Length(sPoso))                   to iLen
61171>>>>>                For iInt From 1 to (13-iLen)
61177>>>>>>
61177>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
61178>>>>>                Loop
61179>>>>>>
61179>>>>>                if (tmpanal.typos='91');                    move '' to sposo
61182>>>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
61184>>>>>                Write   Channel 5 (Pad(trim(tmpanal.mm)                ,03))
61186>>>>>                move tmpanal.aa to sposo
61187>>>>>                Move (Length(sPoso))                   to iLen
61188>>>>>                For iInt From 1 to (4-iLen)
61194>>>>>>
61194>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
61195>>>>>                Loop
61196>>>>>>
61196>>>>>                if ((tmpanal.typos='90') or (tmpanal.typos='91') or (tmpanal.typos='92'));                    move '' to sposo
61199>>>>>                Write   Channel 5 (Pad(sPoso                            ,4))
61201>>>>>                Write   Channel 5 (Pad(ToAnsi(tmpanal.itemd)           ,18))
61203>>>>>                move tmpanal.posoths to nposo
61204>>>>>                MOVE nposo  TO SPOSO
61205>>>>>                Move (Trim(sPoso))                    to sPoso
61206>>>>>                Move (Pos('.',sPoso))   to iPos
61207>>>>>                Move (Length(sPoso))    to iLen
61208>>>>>                Move (iLen-iPos)     to iDiafora
61209>>>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
61212>>>>>                Else Begin
61213>>>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
61216>>>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
61220>>>>>                End
61220>>>>>>
61220>>>>>                Move (Replace('.',sPoso,'')) to sPoso
61221>>>>>                Move (Length(sPoso))                   to iLen
61222>>>>>                For iInt From 1 to (13-iLen)
61228>>>>>>
61228>>>>>                   Move (Insert("0", sPoso,1))         to sPoso
61229>>>>>                Loop
61230>>>>>>
61230>>>>>                if ((tmpanal.typos='90') or (tmpanal.typos='92'));                    move '' to sposo
61233>>>>>                Write   Channel 5 (Pad(trim(tmpanal.mmitemd)           ,03))
61235>>>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
61237>>>>>                move  tmpanal.product to sposo
61238>>>>>                if (sposo<>'');                    insert '' in  sposo at 1
61242>>>>>                Move (Replace('.',sPoso,'')) to sPoso
61243>>>>>                left sposo to s1 3
61245>>>>>>
61245>>>>>                right sposo to s2 12
61247>>>>>>
61247>>>>>                move s1 to sposo
61248>>>>>                append sposo s2
61249>>>>>                Write   Channel 5 (Pad(toansi(sposo)                   ,16))
61251>>>>>                move  tmpanal.product to sposo
61252>>>>>                if (sposo<>'');                    insert '€' in  sposo at 1
61256>>>>>                Move (Replace('.',sPoso,'')) to sPoso
61257>>>>>                left sposo to s1 3
61259>>>>>>
61259>>>>>                right sposo to s2 12
61261>>>>>>
61261>>>>>                move s1 to sposo
61262>>>>>                append sposo s2
61263>>>>>                Write   Channel 5 (Pad(toansi(sposo)                   ,16))
61265>>>>>                Writeln Channel 5
61267>>>>>                add 1 to imet
61268>>>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpanal.recnum))
61269>>>>>                find gt Tmpanal by index.5
61270>>>>>>
61270>>>>>            Loop
61271>>>>>>
61271>>>>>            Close_Output Channel 5
61273>>>>>        End_Procedure
61274>>>>>        
61274>>>>>        Procedure OnClick
61276>>>>>            String  sFile sBranch sText sBaxiokatRecr sFile2 sStr
61277>>>>>            String  sCompany sRec sLabel sPlace sPath
61277>>>>>            Date    dapod deosd
61277>>>>>            Integer iInt iCount iRec iMet iPos iPlaceCode retval isOK iOk
61277>>>>>            indicate err false
61278>>>>>            Get Value Of frmApo         Item 0 to dapod
61279>>>>>        //    Clear tmpSap
61279>>>>>        //    Move dapod to tmpSap.Date
61279>>>>>        //    Find Eq tmpSap By Index.1
61279>>>>>        //    If ((Found) And (tmpSap.Kleidomeno=1)) begin
61279>>>>>        //        send info_box '† †£/¤å˜ €¬«ã œå¤˜  ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
61279>>>>>        //        procedure_return
61279>>>>>        //    end
61279>>>>>        //    if (not(found)) begin
61279>>>>>        //       send info_box 'ƒœ¤ â®¦¬¤ «¨â¥œ  ¦  œ¤ž£œ¨é©œ ª €¨®œåà¤ † §˜¨¦¬© á©«ž¡œ ‘­á¢£˜!\n ’¨â¥«œ œ¤ž£œ¨é©œ ª €¨®œåà¤ H ƒ ¦¨Ÿé©«œ «¦ ‘­á¢£˜!!' '¢ž¨¦­¦¨å˜'
61279>>>>>        //       procedure_return
61279>>>>>        //    end
61279>>>>>        //    Move '' to sStr
61279>>>>>        //    Get fiSapOK Of vwSap dapod to iOK
61279>>>>>        //    If (iOK<>0) Begin
61279>>>>>        //        If (iOK=1)      Send Info_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '¢ž¨¦­¦¨å˜'
61279>>>>>        //        Else If (iOK=2) Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜¬«ã œå¤˜  ã›ž ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
61279>>>>>        //        Else If (iOK=3) Send Info_Box '¨¦¡ç§«œ  ¡œ¤æ ž£œ¨¦£ž¤ é¤.\n‰á§¦ ˜ §¨¦žš¦ç£œ¤ž ƒ„Œ â«¨œ¥œ' '¢ž¨¦­¦¨å˜'
61279>>>>>        //        Else If (iOK=4) Send Info_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜' '¢ž¨¦­¦¨å˜'
61279>>>>>        //        procedure_return
61279>>>>>        //    end
61279>>>>>            Get Value Of frmPath to sPath
61280>>>>>            Set psPath to (Trim(sPath)+'\')
61281>>>>>        
61281>>>>>        
61281>>>>>            Get YesNo_Box '€¨®åœ  ž œ¥˜šàšã „šš¨˜­é¤ !!\nŒ˜ ©¬¤œ®å©à ??' to RetVal
61282>>>>>                If (dapod='') Begin
61284>>>>>                    Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜§¦ œå¤˜  ¡œ¤ã' '¢ž¨¦­¦¨å˜'
61285>>>>>                    Send Activate to frmApo
61286>>>>>                    Procedure_Return
61287>>>>>                End
61287>>>>>>
61287>>>>>            indicate err false
61288>>>>>            If (RetVal =MBR_yes) begin
61290>>>>>              begin_transaction
61291>>>>>                Send Write_Record_Pel
61292>>>>>                Get Verify_Ascii 1 to isOK
61293>>>>>                If (Not(isOK)) Begin
61295>>>>>                    Error 6001 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
61296>>>>>>
61296>>>>>                //    Procedure_Return
61296>>>>>                End
61296>>>>>>
61296>>>>>        
61296>>>>>        
61296>>>>>                Send Write_record_polhseon
61297>>>>>                Get Verify_Ascii 2 to isOK
61298>>>>>                If (Not(isOK)) Begin
61300>>>>>                    Error 6002 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI2. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
61301>>>>>>
61301>>>>>                //    Procedure_Return
61301>>>>>                End
61301>>>>>>
61301>>>>>        
61301>>>>>                Send Write_record_axio
61302>>>>>            //    Get Verify_Ascii 3 to isOK
61302>>>>>            //    If (Not(isOK)) Begin
61302>>>>>            //        Error 6003 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI3. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
61302>>>>>            //    //    Procedure_Return
61302>>>>>            //    End
61302>>>>>        
61302>>>>>                Send Write_record_apoth
61303>>>>>                Get Verify_Ascii 4 to isOK
61304>>>>>                If (Not(isOK)) Begin
61306>>>>>                    Error 6004 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ MM1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
61307>>>>>>
61307>>>>>                //    Procedure_Return
61307>>>>>                End
61307>>>>>>
61307>>>>>        
61307>>>>>                Send Write_record_tehn
61308>>>>>                Get Verify_Ascii 5 to isOK
61309>>>>>                If (Not(isOK)) Begin
61311>>>>>                    Error 6005 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ PP1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
61312>>>>>>
61312>>>>>                //    Procedure_Return
61312>>>>>                End
61312>>>>>>
61312>>>>>        
61312>>>>>                Send Write_record_Anal
61313>>>>>                Get Verify_Ascii 6 to isOK
61314>>>>>                If (Not(isOK)) Begin
61316>>>>>                    Error 6006 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ PP2. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
61317>>>>>>
61317>>>>>                //    Procedure_Return
61317>>>>>                End
61317>>>>>>
61317>>>>>        
61317>>>>>        
61317>>>>>        //      move 0 to iint
61317>>>>>        //      clear clients
61317>>>>>        //      find GT  clients by index.11
61317>>>>>        //      while ((found) and (clients.sap_hmnia =''))
61317>>>>>        //          move clients.recnum to irec
61317>>>>>        //          if (clients.status='') move '2' to clients.status
61317>>>>>        //          else if (clients.status='1') move '3' to clients.status
61317>>>>>        //          move dapod to clients.sap_hmnia
61317>>>>>        //          saverecord clients
61317>>>>>        //          move  '€¢¢˜šã Status œ¢˜«é¤' to sstr
61317>>>>>        //          Set Label Of frmShow to (sstr+'-'+CLIENTS.client_id)
61317>>>>>        //          clear clients
61317>>>>>        //          move irec to clients.recnum
61317>>>>>        //          find gt clients by index.11
61317>>>>>        //      Loop
61317>>>>>        //
61317>>>>>        //      // INDEX 16 ‹„ SAP-HMNIA
61317>>>>>        //      clear cmoves
61317>>>>>        //      find gt cmoves by 16
61317>>>>>        //      while ((found) and (cmoves.sap_hmnia =''))
61317>>>>>        //          if  (cmoves.cmoves_hmnia  > dapod);
61317>>>>>        //              goto nextreaddd
61317>>>>>        //
61317>>>>>        //           //œš¨¨˜­âª ¡¢œ ›é£˜«¦ª §¨â§œ  ¤˜ §¨¦©§œ¨¤ ¦ç¤«œ
61317>>>>>        //          if (cmoves.barticl_recr<>'') begin
61317>>>>>        //              clear barticl
61317>>>>>        //              move cmoves.barticl_recr to barticl.barticl_recr
61317>>>>>        //              find eq barticl by index.2
61317>>>>>        //              if (found) begin
61317>>>>>        //                  If (barticl.ekkremes=1) goto nextreaddd
61317>>>>>        //              end
61317>>>>>        //          End
61317>>>>>        //          move cmoves.recnum to irec
61317>>>>>        //          move dapod to cmoves.sap_hmnia
61317>>>>>        //          saverecord cmoves
61317>>>>>        //          move 1 to iint
61317>>>>>        //          nextreaddd:
61317>>>>>        //              Set Label Of frmShow to ('€¥ æš¨˜­˜' + '-' + String(cmoves.recnum)+'-'+String(cmoves.cmoves_hmnia))
61317>>>>>        //              if (iint=1) begin
61317>>>>>        //                 clear cmoves
61317>>>>>        //                 move irec to cmoves.recnum
61317>>>>>        //              end
61317>>>>>        //              find gt cmoves by 16
61317>>>>>        //              move 0 to iint
61317>>>>>        //      Loop
61317>>>>>        //      move 0 to iint
61317>>>>>        //      clear particle
61317>>>>>        //      find gt particle by 17
61317>>>>>        //      while ((found) and (particle.sap_hmnia =''))
61317>>>>>        //          if  (particle.partl_hmnia  > dapod) ;
61317>>>>>        //              goto nextpartldd
61317>>>>>        //          if (particle.partl_no < 1);
61317>>>>>        //              goto nextpartldd
61317>>>>>        //          move particle.recnum to irec
61317>>>>>        //      //    Reread Particle
61317>>>>>        //          move dapod to particle.sap_hmnia
61317>>>>>        //          saverecord particle
61317>>>>>        //      //    Unlock
61317>>>>>        //          move 1 to iint
61317>>>>>        //          nextpartldd:
61317>>>>>        //              Set Label Of frmShow to ('à¢ã©œ ª' + '-' + String(particle.recnum)+'-'+String(particle.partl_hmnia))
61317>>>>>        //              if (iint=1) begin
61317>>>>>        //                 clear particle
61317>>>>>        //                 move irec to particle.recnum
61317>>>>>        //              end
61317>>>>>        //              move 0 to iint
61317>>>>>        //              find gt particle by 17
61317>>>>>        //
61317>>>>>        //      Loop
61317>>>>>        //
61317>>>>>        //    move 0 to iint
61317>>>>>        //    clear wcmoves
61317>>>>>        //    find GT wcmoves by 16
61317>>>>>        //    while ((found) and (wcmoves.sap_hmnia =''))
61317>>>>>        //        if  (wcmoves.wcmove_hmnia  > dapod) ;
61317>>>>>        //            goto nextwmovesdd
61317>>>>>        //        move wcmoves.recnum to irec
61317>>>>>        //     //   Reread Wcmoves
61317>>>>>        //        move dapod to wcmoves.sap_hmnia
61317>>>>>        //        saverecord wcmoves
61317>>>>>        //     //   Unlock
61317>>>>>        //        move 1 to iint
61317>>>>>        //        nextwmovesdd:
61317>>>>>        //            Set Label Of frmShow to ('€§¦Ÿã¡ž' + '-' + String(wcmoves.recnum)+'-'+String(wcmoves.wcmove_hmnia))
61317>>>>>        //            if (iint=1) begin
61317>>>>>        //               clear wcmoves
61317>>>>>        //               move irec to wcmoves.recnum
61317>>>>>        //            end
61317>>>>>        //            move 0 to iint
61317>>>>>        //            find Gt wcmoves by 16
61317>>>>>        //    Loop
61317>>>>>        //
61317>>>>>        //    move 0 to iint
61317>>>>>        //    clear itemtehn
61317>>>>>        //    find GT itemtehn by index.4
61317>>>>>        //    while ((found) and (itemtehn.sap_hmnia =''))
61317>>>>>        //        if  (itemtehn.hmnia  > dapod) ;
61317>>>>>        //            goto nextitemdd
61317>>>>>        //        move itemtehn.recnum to irec
61317>>>>>        //    //    Reread ItemTehn
61317>>>>>        //        move dapod to itemtehn.sap_hmnia
61317>>>>>        //        saverecord itemtehn
61317>>>>>        //    //    Unlock
61317>>>>>        //        move 1 to iint
61317>>>>>        //        nextitemdd:
61317>>>>>        //            Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(itemtehn.recnum)+'-'+String(itemtehn.hmnia))
61317>>>>>        //            if (iint=1) begin
61317>>>>>        //               clear itemtehn
61317>>>>>        //               move irec to itemtehn.recnum
61317>>>>>        //            end
61317>>>>>        //            move 0 to iint
61317>>>>>        //            find Gt itemtehn by index.4
61317>>>>>        //    Loop
61317>>>>>        //
61317>>>>>        //    move 0 to iint
61317>>>>>        //    clear witemxtr
61317>>>>>        //    find GT witemxtr by index.4
61317>>>>>        //    while ((found) and (witemxtr.sap_hmnia =''))
61317>>>>>        //        if  (witemxtr.hmnia  > dapod) ;
61317>>>>>        //            goto nextwitemdd
61317>>>>>        //        move witemxtr.recnum to irec
61317>>>>>        //    //    Reread WitemxTr
61317>>>>>        //        move dapod to witemxtr.sap_hmnia
61317>>>>>        //        saverecord witemxtr
61317>>>>>        //   //     Unlock
61317>>>>>        //        move 1 to iint
61317>>>>>        //        nextwitemdd:
61317>>>>>        //            Set Label Of frmShow to ('ƒ ˜¡ ¤ã©œ ª' + '-' + String(witemxtr.recnum)+'-'+String(witemxtr.hmnia))
61317>>>>>        //            if (iint=1) begin
61317>>>>>        //               clear witemxtr
61317>>>>>        //               move irec to witemxtr.recnum
61317>>>>>        //            end
61317>>>>>        //            move 0 to iint
61317>>>>>        //            find Gt witemxtr by index.4
61317>>>>>        //    Loop
61317>>>>>        //
61317>>>>>        
61317>>>>>        //   clear tmpsap
61317>>>>>        //   move dapod to tmpsap.date
61317>>>>>        //   move 1 to tmpsap.kleidomeno
61317>>>>>        //   saverecord tmpsap
61317>>>>>        //   SEND IGNORE_ERROR TO ERROR_INFO_OBJECT 4358
61317>>>>>        //   Make_Directory "C:\PISBACKUPASCCI"
61317>>>>>        //   SEND TRAP_ERROR TO ERROR_INFO_OBJECT 4358
61317>>>>>        //   Copyfile (PSPATH(SELF)+'*.*') to  "C:\PISBACKUPASCCI"
61317>>>>>        
61317>>>>>           end_transaction
61318>>>>>           unlock
61319>>>>>>
61319>>>>>           if (not(err)) begin
61321>>>>>              SEND IGNORE_ERROR TO ERROR_INFO_OBJECT 4358
61322>>>>>              Make_Directory "C:\PISBACKUPASCCI"
61323>>>>>              Copyfile (PSPATH(SELF)+'*.*') to  "C:\PISBACKUPASCCI"
61324>>>>>>
61324>>>>>              SEND TRAP_ERROR TO ERROR_INFO_OBJECT 4358
61325>>>>>        
61325>>>>>              Send Info_Box ('† œ¥˜šàšã ©«¦ ®œåà¤ ¦¢¦¡¢ž¨éŸž¡œ\n‡˜ ™¨œå«œ «˜ ˜¨®œå˜ ©«¦\n'+(psPath(Self))) '¢ž¨¦­¦¨å˜'
61326>>>>>           end
61326>>>>>>
61326>>>>>           else  begin
61327>>>>>              erasefile (PSPATH(SELF)+'*.txt')
61328>>>>>>
61328>>>>>              Send Info_Box '˜¨¦¬© á©«ž¡œ ¡á§¦ ¦ ¢áŸ¦ª ©«ž¤ „¥˜šàšã' '¢ž¨¦­¦¨å˜'
61329>>>>>           end
61329>>>>>>
61329>>>>>           set pddate of (saprep(self)) to dapod
61330>>>>>           set pspath of (saprep(self)) to (pspath(self))
61331>>>>>           send ACTIVATE_saprep
61332>>>>>        
61332>>>>>          end
61332>>>>>>
61332>>>>>        
61332>>>>>        End_Procedure // OnClick
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        
61333>>>>>        //AB-StoreEnd
61333>>>>>
61333>>>>>    End_Object    // ButtonSub1
61334>>>>>
61334>>>>>    Object Textbox1 is a Textbox
61336>>>>>        Set Label to "†£/¤å˜ „šš¨˜­é¤ "
61337>>>>>        Set Location to 12 11
61338>>>>>        Set Size to 10 66
61339>>>>>        Set FontWeight to 800
61340>>>>>        Set TypeFace to "MS Sans Serif"
61341>>>>>    End_Object    // Textbox1
61342>>>>>
61342>>>>>    Object btnPartl is a ButtonSub
61344>>>>>
61344>>>>>        //AB-StoreTopStart
61344>>>>>        
61344>>>>>        //AB-StoreTopEnd
61344>>>>>
61344>>>>>        Set Label to "ButtonSub1"
61345>>>>>        Set Bitmap to "Filesys3.bmp"
61346>>>>>        Set Size to 22 25
61347>>>>>        Set Location to 174 11
61348>>>>>        Set Focus_Mode to Pointer_Only
61349>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61350>>>>>        Set Visible_State to FALSE
61351>>>>>
61351>>>>>        //AB-StoreStart
61351>>>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«˜ ˜¨˜šé£œ¤˜ €¨®œå˜"
61352>>>>>        Procedure OnClick
61354>>>>>             send activate_vwsap
61355>>>>>        End_Procedure // OnClick
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        
61356>>>>>        //AB-StoreEnd
61356>>>>>
61356>>>>>    End_Object    // btnPartl
61357>>>>>
61357>>>>>    Object frmPath is a FormSub
61359>>>>>
61359>>>>>        //AB-StoreTopStart
61359>>>>>        
61359>>>>>        //AB-StoreTopEnd
61359>>>>>
61359>>>>>        Set Size to 13 223
61360>>>>>        Set Location to 212 95
61361>>>>>        Set Color to clBtnFace
61362>>>>>        Set Label_Col_Offset to 2
61363>>>>>        Set Prompt_Button_Mode to pb_PromptOn
61364>>>>>        Set Enabled_State to FALSE
61365>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
61366>>>>>        Set Item_Shadow_State Item 0 to TRUE
61367>>>>>        Set Shadow_State Item 0 to TRUE
61368>>>>>
61368>>>>>        //AB-StoreStart
61368>>>>>        
61368>>>>>        Procedure Prompt
61370>>>>>            String sStr sStr2
61371>>>>>            Move (DPDlgShow(oDirectoryPicker(Self)))  to sStr
61372>>>>>            GET DPDlgPath Of (oDirectoryPicker(Self)) to sStr2  // Full Path
61373>>>>>            Move (Trim(sStr2)) to sStr2
61374>>>>>            Set Value Of frmPath Item 0 to (Uppercase(TOOEM(sStr2)))
61375>>>>>        End_Procedure
61376>>>>>        
61376>>>>>        
61376>>>>>        
61376>>>>>        
61376>>>>>        //AB-StoreEnd
61376>>>>>
61376>>>>>    End_Object    // frmPath
61377>>>>>
61377>>>>>    Object TextBoxSub1 is a TextBoxSub
61379>>>>>        Set Label to "Path SAP"
61380>>>>>        Set Location to 213 58
61381>>>>>        Set Size to 10 32
61382>>>>>        Set TypeFace to "MS Sans Serif"
61383>>>>>    End_Object    // TextBoxSub1
61384>>>>>
61384>>>>>    Object Textbox2 is a Textbox
61386>>>>>        Set Label to "†£/¤å˜ „šš¨˜­é¤  „éª"
61387>>>>>        Set Location to 12 187
61388>>>>>        Set Size to 12 82
61389>>>>>        Set FontWeight to 800
61390>>>>>        Set TypeFace to "MS Sans Serif"
61391>>>>>    End_Object    // Textbox2
61392>>>>>
61392>>>>>
61392>>>>>    //AB-StoreStart
61392>>>>>    
61392>>>>>    Object oDirectoryPicker is a OLEDPDlg
61394>>>>>        Set Size            to 0 0
61395>>>>>        Set Location        to 0 0
61396>>>>>        Set Visible_State   to False
61397>>>>>        Procedure Activate
61399>>>>>            Forward Send Activate
61401>>>>>            Set Location    to 1 1
61402>>>>>            Set Size        to 190 190
61403>>>>>            SET DPDlgRoot   to 0
61404>>>>>        End_procedure
61405>>>>>    End_Object
61406>>>>>    
61406>>>>>    Procedure Activate_View Returns Integer
61408>>>>>        Integer rVal
61409>>>>>        date ddate
61409>>>>>        sysdate4 ddate
61410>>>>>        CLEAR company
61411>>>>>        move syscurxr.company_code to company.company_code
61412>>>>>        find eq company by index.1
61413>>>>>>
61413>>>>>        if (found);            set value of frmpath to company.sap_path
61416>>>>>        else;            set value of frmpath to ''
61418>>>>>        set value of frmapo to ddate
61419>>>>>        Forward Get Msg_Activate_View to rVal
61421>>>>>        Reread Sysfile
61425>>>>>        Unlock
61426>>>>>>
61426>>>>>        reread sysrecw
61430>>>>>        unlock
61431>>>>>>
61431>>>>>        Send Activate to oDirectoryPicker
61432>>>>>        Send Activate to (frmapo(vsapexp(Self)))
61433>>>>>    End_Procedure
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    
61434>>>>>    //AB-StoreEnd
61434>>>>>
61434>>>>>End_Object    // Vsapexp
61435>>>>>
61435>>>>>
61435>>>>>//AB-StoreStart
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>
61435>>>>>//AB-StoreEnd
61435>>>>>
61435>>>>>//AB/ End_Object    // prj
61435>>>    
61435>>>    //AB-StoreTopEnd
61435>>>
61435>>>    //AB-IgnoreStart
61435>>>
61435>>>    Use dbView.Sub
61435>>>    Use DFAllEnt.pkg
61435>>>    Use Form.Sub
61435>>>    Use Rgroup.Sub
61435>>>    Use Radio.Sub
61435>>>    Use Button.Sub
61435>>>    Use Txtbox.Sub
61435>>>
61435>>>    Use CLIENTS.DD
61435>>>    Use TEMPITEL.DD
61435>>>    Use Tempitem.DD
61435>>>    
61435>>>    //AB-IgnoreEnd
61435>>>
61435>>>    ACTIVATE_VIEW Activate_vsapdom FOR vsapdom
61439>>>
61439>>>    Object vsapdom is a dbViewSub
61441>>>
61441>>>        //AB-StoreTopStart
61441>>>        
61441>>>        Property Integer piLathi    Public 0
61443>>>        property integer piepil     public 0
61445>>>        Property Integer piSfalma   Public 0
61447>>>        
61447>>>        Register_Object oDirectoryPicker
61447>>>        
61447>>>        Function Check_Afm_Local String Afm_Num Returns Integer
61449>>>            Integer iii Num1 Num2
61450>>>        
61450>>>            Move (Trim(Afm_Num)) To Afm_Num
61451>>>        
61451>>>            For iii From 1 To (Length(Trim(Afm_Num)))
61457>>>>
61457>>>                If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
61460>>>            Loop
61461>>>>
61461>>>        
61461>>>            Move (Right(Afm_Num,1)) to Num2
61462>>>        
61462>>>            If (Length(Afm_Num)<>9) Function_Return 2
61465>>>        
61465>>>            Move 0 to Num1
61466>>>        
61466>>>            For iii From 1 to 8
61472>>>>
61472>>>                Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
61473>>>            Loop
61474>>>>
61474>>>        
61474>>>            Move (Mod(Num1,11)) to Num1
61475>>>            If (Num1=10) Move 0 to Num1
61478>>>        
61478>>>            If (Num1=Num2)  Function_Return 0
61481>>>            Else            Function_Return 1
61483>>>        End_Function
61484>>>        
61484>>>        
61484>>>        
61484>>>        Function Validate_AFM String asAFM String asPel Returns Integer
61486>>>            Integer rVal iCheck
61487>>>            // Elegxos gia sosto AFM
61487>>>            Move (Check_AFM(asAFM)) to iCheck
61488>>>            If (iCheck=1) Begin
61490>>>                Set piLathi to (piLathi(Self)+1)
61491>>>                Write   Channel 7 '’¦ €”‹ «¦¬ '
61493>>>                Write   Channel 7 (Trim(asPel)+' ')
61495>>>                Write   Channel 7 'œå¤˜  ¢˜¤Ÿ˜©£â¤¦'
61497>>>                Writeln Channel 7
61499>>>                Function_Return 0
61500>>>            End
61500>>>>
61500>>>            Else If (iCheck=2) Begin
61503>>>                Set piLathi to (piLathi(Self)+1)
61504>>>                Write   Channel 7 '’¦ €”‹ «¦¬ '
61506>>>                Write   Channel 7 (Trim(asPel)+' ')
61508>>>                Writeln Channel 7 '›œ¤ œå¤˜  9 ¯ã­ ¦'
61511>>>                Function_Return 0
61512>>>            End
61512>>>>
61512>>>            Else If (iCheck=3) Begin
61515>>>                Set piLathi to (piLathi(Self)+1)
61516>>>                Write   Channel 7 '’¦ €”‹ «¦¬ '
61518>>>                Write   Channel 7 (Trim(asPel)+' ')
61520>>>                Writeln Channel 7 '§œ¨ â®œ  £ž ˜§¦›œ¡«¦çª ®˜¨˜¡«ã¨œª'
61523>>>                Function_Return 0
61524>>>            End
61524>>>>
61524>>>            Function_Return 1
61525>>>        End_Function
61526>>>        
61526>>>        //AB-StoreTopEnd
61526>>>
61526>>>        Set Label to "„¥˜šàšã ‰ ¤ã©œà¤ •- €§¦š¨˜­é¤"
61527>>>        Set Size to 245 405
61528>>>        Set Location to 1 9
61529>>>
61529>>>        //AB-DDOStart
61529>>>
61529>>>        Object Clients_DD is a Clients_DataDictionary
61531>>>
61531>>>            //AB-StoreStart
61531>>>                                                                
61531>>>            //AB-StoreEnd
61531>>>
61531>>>        End_Object    // Clients_DD
61532>>>
61532>>>        Object Tempitel_DD is a Tempitel_DataDictionary
61534>>>        End_Object    // Tempitel_DD
61535>>>
61535>>>        Object Tempitem_DD is a Tempitem_DataDictionary
61537>>>        End_Object    // Tempitem_DD
61538>>>
61538>>>        Set Main_DD to (Clients_DD(self))
61539>>>        Set Server to (Clients_DD(self))
61540>>>
61540>>>        //AB-DDOEnd
61540>>>
61540>>>        Object frmapo is a FormSub
61542>>>            Set Size to 13 61
61543>>>            Set Location to 15 178
61544>>>            Set Label_Col_Offset to 2
61545>>>            Set Form_Datatype Item 0 to Mask_Date_Window
61546>>>            Set Prompt_Button_Mode to pb_PromptOn
61547>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
61548>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
61549>>>
61549>>>            //AB-StoreStart
61549>>>            set prompt_object to (ocalendar(self))
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            
61550>>>            //AB-StoreEnd
61550>>>
61550>>>        End_Object    // frmapo
61551>>>
61551>>>        Object RadioGroupSub1 is a RadioGroupSub
61553>>>            Set Size to 105 361
61554>>>            Set Location to 33 10
61555>>>            Object Radio1 is a RadioSub
61557>>>                Set Label to "„¡«ç§à©ž  €¨®œå¦¬ œ¢˜«é¤"
61558>>>                Set Size to 10 116
61559>>>                Set Location to 10 5
61560>>>                Set TextColor to clRed
61561>>>            End_Object    // Radio1
61562>>>
61562>>>            Object Radio3 is a RadioSub
61564>>>                Set Label to "„¡«ç§à©ž €¨®œå¦¬ „ ©§¨á¥œà¤ œ¢˜«é¤"
61565>>>                Set Size to 10 152
61566>>>                Set Location to 24 5
61567>>>            End_Object    // Radio3
61568>>>
61568>>>            Object RadioSub1 is a RadioSub
61570>>>                Set Label to "„¡«ç§à©ž €¨®œå¦¬ à¢ã©œà¤ œ¢˜«é¤"
61571>>>                Set Size to 10 169
61572>>>                Set Location to 38 5
61573>>>                Set Auto_Size_State to FALSE
61574>>>            End_Object    // RadioSub1
61575>>>
61575>>>            Object RadioSub4 is a RadioSub
61577>>>                Set Label to "„¡«ç§à©ž €¨®œå¦¬ ‰ ¤ã©œà¤ €§¦Ÿã¡žª"
61578>>>                Set Size to 10 169
61579>>>                Set Location to 52 5
61580>>>                Set Auto_Size_State to FALSE
61581>>>
61581>>>                //AB-StoreStart
61581>>>                                                                                        
61581>>>                                                                                        
61581>>>                                                                                        
61581>>>                //AB-StoreEnd
61581>>>
61581>>>            End_Object    // RadioSub4
61582>>>
61582>>>            Object RadioSub5 is a RadioSub
61584>>>                Set Label to "„¡«ç§à©ž €¨®œå¦¬ ’œ®¤.¨¦› ˜š¨˜­é¤"
61585>>>                Set Size to 10 169
61586>>>                Set Location to 64 5
61587>>>                Set Auto_Size_State to FALSE
61588>>>
61588>>>                //AB-StoreStart
61588>>>                                                                                        
61588>>>                                                                                        
61588>>>                                                                                        
61588>>>                //AB-StoreEnd
61588>>>
61588>>>            End_Object    // RadioSub5
61589>>>
61589>>>            Object RadioSub6 is a RadioSub
61591>>>                Set Label to "„¡«ç§à©ž €¨®œå¦¬ ‰˜«˜¤˜¢é©œà¤"
61592>>>                Set Size to 10 169
61593>>>                Set Location to 78 5
61594>>>                Set Auto_Size_State to FALSE
61595>>>
61595>>>                //AB-StoreStart
61595>>>                                                                                        
61595>>>                                                                                        
61595>>>                //AB-StoreEnd
61595>>>
61595>>>            End_Object    // RadioSub6
61596>>>
61596>>>            Object Radio7 is a RadioSub
61598>>>                Set Label to "„¡«ç§à©ž  œ¢˜«é¤ £œ ŠáŸ¦ª €.”.‹"
61599>>>                Set Size to 12 147
61600>>>                Set Location to 91 5
61601>>>                Set TextColor to clRed
61602>>>            End_Object    // Radio7
61603>>>
61603>>>
61603>>>            //AB-StoreStart
61603>>>                                                                
61603>>>            Procedure Notify_Select_State integer inewItem integer ioldItem
61605>>>                local integer licount
61606>>>                Forward Send Notify_Select_State  iNewItem  iOldItem
61608>>>                Set piEpil to (iNewItem+1)
61609>>>            End_Procedure
61610>>>            
61610>>>            
61610>>>            //AB-StoreEnd
61610>>>
61610>>>        End_Object    // RadioGroupSub1
61611>>>
61611>>>        Object btnMetasx is a ButtonSub
61613>>>
61613>>>            //AB-StoreTopStart
61613>>>                                        
61613>>>            //AB-StoreTopEnd
61613>>>
61613>>>            Set Label to "‹œ«˜©®ž£˜« ©£æª ‘œ ˜¨˜ššœ¢åœª ¨¦£žŸœ¬«é¤"
61614>>>            Set Bitmap to "AGGEL.BMP"
61615>>>            Set Size to 20 22
61616>>>            Set Location to 148 11
61617>>>            Set Focus_Mode to Pointer_Only
61618>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
61619>>>
61619>>>            //AB-StoreStart
61619>>>                                        
61619>>>            Set TooltipValue to "„§œ¥œ¨š˜©å˜ „šš¨˜­é¤"
61620>>>            
61620>>>            Procedure Deixe_Ta_Lathi
61622>>>                Integer liLathi
61623>>>                Set piLathi to 0
61624>>>                send Delete_Data to (EditSub1(Keimeno(Self)))
61625>>>                send read to (EditSub1(Keimeno(Self))) 'C:\SapAFM.txt'
61626>>>                Send popup to (Keimeno(Self))
61627>>>            End_Procedure
61628>>>            
61628>>>            Procedure OnClick
61630>>>                Set Label Of frmShow to ''
61631>>>                integer libpo05 listatus retval irecnum  ibpoid ierr  iok iYes icount
61632>>>                string msgstr wrecr edate mdate ename mname scodem srecr sdescr  spar
61632>>>                date dapod
61632>>>                integer iepil
61632>>>                get piepil to iepil
61633>>>                get value of frmapo to dapod
61634>>>                REREAD SYSFILE
61638>>>                unlock
61639>>>>
61639>>>                indicate err false
61640>>>                If (dapod='') Begin
61642>>>                    Send Info_Box '† ž£œ¨¦£ž¤å˜ „šš¨˜­é¤ œå¤˜  ¡œ¤ã' '¢ž¨¦­¦¨å˜'
61643>>>                    Send Activate to frmApo
61644>>>                    Procedure_Return
61645>>>                End
61645>>>>
61645>>>            //    Clear tmpSap
61645>>>            //    Move dapod to tmpSap.Date
61645>>>            //    Find Eq tmpSap By Index.1
61645>>>            //    If ((Found) And (tmpSap.Kleidomeno=1)) begin
61645>>>            //        send info_box '† †£/¤å˜ €¬«ã œå¤˜  ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
61645>>>            //        procedure_return
61645>>>            //    end
61645>>>            //    Get fiSapOK Of vwSap dapod to iOK
61645>>>            //    If (iOK<>0) Begin
61645>>>            //        If (iOK=1)      Send Info_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '¢ž¨¦­¦¨å˜'
61645>>>            //        Else If (iOK=2) Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜¬«ã œå¤˜  ã›ž ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
61645>>>            //        Else If (iOK=3) Send Info_Box '¨¦¡ç§«œ  ¡œ¤æ ž£œ¨¦£ž¤ é¤.\n‰á§¦ ˜ §¨¦žš¦ç£œ¤ž ƒ„Œ â«¨œ¥œ' '¢ž¨¦­¦¨å˜'
61645>>>            //        Else If (iOK=4) Send Info_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜' '¢ž¨¦­¦¨å˜'
61645>>>            //        procedure_return
61645>>>            //    end
61645>>>            
61645>>>                Get YesNo_Box '€¨®åœ  ž „§œ¥œ¨š˜©å˜ „šš¨˜­é¤ !!\nŒ˜ ©¬¤œ®å©à ??' to RetVal
61646>>>                If (RetVal =MBR_yes) begin
61648>>>                    Zerofile TmpclSap
61649>>>                    Zerofile TmpAxio
61650>>>                    Zerofile Tmppol
61651>>>                    Zerofile Tmpapoth
61652>>>                    Zerofile Tmptehn
61653>>>                    Zerofile Tmpanal
61654>>>                    begin_transaction
61655>>>            //            Send enhmerose_axio
61655>>>            //            Send Enhmerose_polhseis
61655>>>            //            Send enhmerose_apoth
61655>>>            //            Send enhmerose_itemtehn
61655>>>            //            Send enhmerose_anal
61655>>>                        Set piLathi to 0
61656>>>                        Direct_Output Channel 7 'C:\SapAFM.txt'
61658>>>                        Send Ftiakse_Pelates
61659>>>                        Close_Output Channel 7
61661>>>                        If (piLathi(Self)<>0) Begin
61663>>>                            Send Deixe_Ta_Lathi
61664>>>                            Get YesNo_Box '“§ã¨¥˜¤ ¢˜¤Ÿ˜©£â¤˜ €”‹.\€¤ ©¬¤œ®å©à, «˜ €”‹ ˜¬«á Ÿ˜ §œ¨á©¦¬¤ £œ ‹ž›œ¤ ¡á ©«¦ SAP.\nŒ˜ ©¬¤œ®å©à ?' to iYes
61665>>>                            If (iYes=MBR_NO) Begin
61667>>>                                Move MBR_NO to RetVal
61668>>>                                Abort_Transaction
61669>>>                            End
61669>>>>
61669>>>                        End
61669>>>>
61669>>>                        If (RetVal=MBR_YES) Begin
61671>>>            
61671>>>                        End
61671>>>>
61671>>>                    // ’œ©«á¨¦¬£œ «¦ fi2 š ˜ §œ¨ ««âª œšš¨˜­âª «¨æ£§˜ª
61671>>>            
61671>>>                    end_transaction
61672>>>                    Unlock
61673>>>>
61673>>>                    Close_Output Channel 7
61675>>>                    send check_the_records
61676>>>                end
61676>>>>
61676>>>                If (RetVal=MBR_NO) Begin
61678>>>                    send info_box 'ƒ ˜› ¡˜©å˜ €¡¬¨éŸž¡œ ˜§¦ «¦¤ •¨ã©«ž' '¢ž¨¦­¦¨å˜'
61679>>>                    Procedure_Return
61680>>>                End
61680>>>>
61680>>>            
61680>>>                if ((not(err)) And (RetVal=MBR_YES)) begin
61682>>>                    Move "„¤ž£â¨à©ž €¨®œåà¤ ¦¢¦¡¢ž¨éŸž¡œ"  to MsgStr
61683>>>                    Send Info_Box MsgStr
61684>>>                end
61684>>>>
61684>>>                else begin
61685>>>                     Move "† › ˜› ¡˜©å˜ ›œ¤ ¦¢¦¡¢ž¨éŸž¡œ ©à©«á" to MsgStr
61686>>>                     Send Info_Box MsgStr
61687>>>                end
61687>>>>
61687>>>            End_Procedure // OnClick
61688>>>            
61688>>>            
61688>>>            Procedure Ftiakse_Pelates
61690>>>                 string srecr scode sstr stomeas  sperioxh segkatastash sperioxhb
61691>>>                 integer Imet Ikod isok Inum  iyear inai icount
61691>>>                 date ddate
61691>>>                 number nxreosh npistosh ntotal nxre npis
61691>>>                 move 0 to icount
61692>>>                 get value of frmapo item 0 to ddate
61693>>>                 move Sysfile.Client_Digits to Ikod
61694>>>                 move (TheYearSegment(ddate))            to iyear
61695>>>                 clear Company
61696>>>                 move syscurxr.company_code to Company.company_code
61697>>>                 find eq company by index.1
61698>>>>
61698>>>                 move Company.company_c_code0 to stomeas
61699>>>                 set piLathi to 0
61700>>>                 move 0 to imet
61701>>>                 add 3 to ikod // gia na paroyme kai to AX ektos tomea
61702>>>                 clear branch
61703>>>                 move syscurxr.company_code to branch.company_code
61704>>>                 move syscurxr.branch_code  to branch.branch_code
61705>>>                 find eq branch by index.1
61706>>>>
61706>>>                 move branch.PERIOXH         to sperioxh
61707>>>                 move branch.egkatastash     to segkatastash
61708>>>                 clear cmoves
61709>>>                 move ddate to cmoves.Cmoves_hmnia
61710>>>                 find ge cmoves by index.3
61711>>>>
61711>>>                 while ((found) and (ddate=cmoves.cmoves_hmnia))
61715>>>                    if ((cmoves.ctypkin_code='101') or (cmoves.ctypkin_code='102') or;                       (cmoves.ctypkin_code='103') or (cmoves.ctypkin_code='104')) begin
61717>>>                            clear tmppol
61718>>>                            move 'FI2'                              to TmpPol.onoma
61719>>>                            move '01'                               to TmpPol.typos
61720>>>                            if (sysrecw.wmoves_rec0=1) move 'TRD1'  to Tmppol.etairia
61723>>>                            else move 'idy1'                        to Tmppol.etairia
61725>>>                            CLEAR BRANCH
61726>>>                            move cmoves.company_code to branch.company_code
61727>>>                            move cmoves.branch_code  to branch.branch_code
61728>>>                            find eq branch by index.1
61729>>>>
61729>>>                            move branch.PERIOXH         to sperioxh
61730>>>                            move branch.egkatastash     to segkatastash
61731>>>                            move segkatastash                       to TmpPol.perioxh
61732>>>                            move sPERIOXH                           to TmpPol.egkatastash
61733>>>                            move segkatastash                       to TmpPol.tomeas
61734>>>                            if (cmoves.cmoves_x0>0) begin
61736>>>                                move '•„—‘’ˆ‰Ž ‘†‹„ˆ—‹€' to tmppol.descr
61737>>>                                move 'B200'               to tmppol.type
61738>>>                            end
61738>>>>
61738>>>                            else begin
61739>>>                                move 'ˆ‘’—’ˆ‰Ž ‘†‹„ˆ—‹€' to tmppol.descr
61740>>>                                move 'B201' to tmppol.type
61741>>>                            end
61741>>>>
61741>>>                            move (trim(cmoves.client_id))          to scode
61742>>>                            Move (Right(scode, Ikod))              To scode
61743>>>                            move (replaces('.',scode,'')) to scode
61744>>>                            insert '01' in scode at 1
61746>>>                            if (Sysfile.Client_Digits<6);                                insert '0' in scode at 5
61750>>>                           move (trim(scode))                      to Tmppol.code
61751>>>                           move ddate                              to Tmppol.hmnia
61752>>>                           move ''                                 to Tmppol.kodikos
61753>>>            
61753>>>                           if (cmoves.cmoves_x0>0) move (cmoves.cmoves_x0)   to Tmppol.axia
61756>>>                           else                    move (cmoves.cmoves_p0)   to Tmppol.axia
61758>>>                           if (cmoves.cmoves_x0 > 0) move  '+'    to Tmppol.sign
61761>>>                           else move '-'                          to Tmppol.sign
61763>>>                           move '01'                      to Tmppol.kodikos2
61764>>>                           move clients.client_name       to Tmppol.name
61765>>>                           move 'EUR'                              To Tmppol.nomisma
61766>>>                           reread sysrecw
61770>>>                           move (sysrecw.warticle_rec0+1)          to sysrecw.warticle_rec0
61771>>>                           saverecord sysrecw
61772>>>                           unlock
61773>>>>
61773>>>                           move sysrecw.warticle_rec0 to tmppol.arithmos
61774>>>                           if ((cmoves.cmoves_x0 - cmoves.cmoves_p0)<>0) saverecord Tmppol
61777>>>                           move  0 to tmppol.recnum
61778>>>                           if (tmppol.type='B200');                               move '00001' to tmppol.kodikos
61781>>>                           else if (tmppol.type='B201');                               move '00002' to tmppol.kodikos
61785>>>                            move ''                                 to tmppol.code
61786>>>                            move '03' to tmppol.typos
61787>>>                            move  sysrecw.warticle_rec0 to tmppol.arithmos
61788>>>                            if ((cmoves.cmoves_x0 - cmoves.cmoves_p0)<>0) saverecord Tmppol
61791>>>            
61791>>>                    end
61791>>>>
61791>>>                    find gt cmoves by index.3
61792>>>>
61792>>>                 Loop
61793>>>>
61793>>>            End_Procedure
61794>>>            
61794>>>            //Procedure enhmerose_axio
61794>>>            //     string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo stomeas
61794>>>            //     integer Imet Ikod ienhsap isChecked
61794>>>            //     number nmetrhta nepitages nsynal nembasma nposo
61794>>>            //     date dapod ddate dkenhdate
61794>>>            //     string soroi sclient msgstr sclientid lsTheAppPath
61794>>>            //     get value of frmapo to dapod
61794>>>            //     move '01/01/2005' to ddate
61794>>>            //     move '01/01/1753' to dkenhdate
61794>>>            //     move Sysfile.Client_Digits to Ikod
61794>>>            //     add 3 to ikod // gia na paroyme kai to AX ektos yomea
61794>>>            //     clear Company
61794>>>            //     move syscurxr.company_code to Company.company_code
61794>>>            //     find eq company by index.1
61794>>>            //     move Company.company_c_code0 to stomeas
61794>>>            //
61794>>>            //     clear cmoves
61794>>>            //     find gt cmoves by 16
61794>>>            //     while ((found) and (cmoves.sap_hmnia=''))
61794>>>            //        move '' to sclientid
61794>>>            //        move 0 to ienhsap
61794>>>            //        if  (cmoves.cmoves_hmnia  > dapod);
61794>>>            //            goto nextcmovesdd
61794>>>            //        if (cmoves.barticl_recr='');
61794>>>            //            goto nextcmovesdd
61794>>>            //        if (syscurxr.company_code<>cmoves.company_code);
61794>>>            //            goto nextcmovesdd
61794>>>            //
61794>>>            //        //gts 03-12-07 ‰ ¤ã©œ ª §¦¬ œå¤˜  locked ¡˜  ž ž£/¤å˜ «žª ¡å¤ž©žª œ ©§¨á¥œà¤ => «žª ž£/¤å˜ª
61794>>>            //        //¡¢œ ›é£˜«¦ª §¨â§œ  ¤˜ §¨¦©§œ¨¤ ¦ç¤«œ
61794>>>            //        if (cmoves.barticl_recr<>'') begin
61794>>>            //            clear barticl
61794>>>            //            move cmoves.barticl_recr to barticl.barticl_recr
61794>>>            //            find eq barticl by index.2
61794>>>            //            if (found) begin
61794>>>            //                If (barticl.ekkremes=1) goto nextcmovesdd
61794>>>            //                relate barticl
61794>>>            //                if (btypkin.locked=1) begin
61794>>>            //                    if (btypkin.locked_date<>'');
61794>>>            //                        if (cmoves.cmoves_hmnia ge btypkin.locked_date);
61794>>>            //                            goto nextcmovesdd
61794>>>            //                End
61794>>>            //            end
61794>>>            //        End
61794>>>            //        clear branch
61794>>>            //        move Cmoves.company_code    to branch.company_code
61794>>>            //        move cmoves.branch_code     to branch.branch_code
61794>>>            //        find eq branch by index.1
61794>>>            //        move branch.PERIOXH         to sperioxh
61794>>>            //        move branch.egkatastash     to segkatastash
61794>>>            //
61794>>>            //        clear TmpAxio
61794>>>            //        move 'FI3'                              to Tmpaxio.onoma
61794>>>            //        move '01'                               to Tmpaxio.typos
61794>>>            //        move 'DMK1'                             to Tmpaxio.etairia
61794>>>            //        move sPERIOXH                           to Tmpaxio.perioxh
61794>>>            //        move segkatastash                       to Tmpaxio.egkatastash
61794>>>            //        move segkatastash                       to Tmpaxio.tomeas
61794>>>            //
61794>>>            //        relate cmoves
61794>>>            //        if (clients.is_xondr='1');
61794>>>            //             move '01' to Tmpaxio.anal
61794>>>            //        else;
61794>>>            //             move '02' to Tmpaxio.anal
61794>>>            //        If (sysfile.company_name='1') move '01'      to Tmpaxio.anal
61794>>>            //        if ((clients.status='') and (clients.sap_hmnia<=ddate)) begin
61794>>>            //            move 1 to ienhsap
61794>>>            //            move cmoves.client_id to sclientid
61794>>>            //            if (clients.client_ptyppar='') begin
61794>>>            //               move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå §˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž = ' to msgstr
61794>>>            //               append msgstr clients.client_id
61794>>>            //               error 3330 msgstr
61794>>>            //            end
61794>>>            //            if (clients.client_ptyppar='100') begin
61794>>>            //                    move '' to msgstr
61794>>>            //                    if (clients.is_xondr<>'1') begin
61794>>>            //                        move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
61794>>>            //                        append msgstr clients.client_id
61794>>>            //                        error 3333 msgstr
61794>>>            //                    end
61794>>>            //            end
61794>>>            //            else begin
61794>>>            //                    if (clients.client_ptyppar<>'113') begin
61794>>>            //                        move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
61794>>>            //                        append msgstr clients.client_id
61794>>>            //                        error 3334 msgstr
61794>>>            //                    end
61794>>>            //            end
61794>>>            //        end
61794>>>            //
61794>>>            //        move (trim(ctypkin.sub))                to stype
61794>>>            //        if (stype='');
61794>>>            //            goto nextcmovesdd
61794>>>            //        insert 'B' in stype at 1
61794>>>            //        move (trim(stype))                      to Tmpaxio.type
61794>>>            //
61794>>>            //        clear bmove
61794>>>            //        move cmoves.custprom_code to bmove.bmove_recr
61794>>>            //        find eq bmove by index.2
61794>>>            //        move bmove.barticl_no                   to Tmpaxio.arithmos
61794>>>            //        move cmoves.cmoves_hmnia                to Tmpaxio.hmnia
61794>>>            //        move '' to sper
61794>>>            //        clear cflagkin
61794>>>            //        move cmoves.ctypkin_code to cflagkin.ctypkin_code
61794>>>            //        find gt cflagkin by index.1
61794>>>            //        while ((found) and (cmoves.ctypkin_code=cflagkin.ctypkin_code))
61794>>>            //                 if (trim(cflagkin.cflagkin_flag)='91') move '1' to sper
61794>>>            //            else if (trim(cflagkin.cflagkin_flag)='92') move '2' to sper
61794>>>            //            else if (trim(cflagkin.cflagkin_flag)='93') move '3' to sper
61794>>>            //            else if (trim(cflagkin.cflagkin_flag)='94') move '4' to sper
61794>>>            //            find gt cflagkin by index.1
61794>>>            //        Loop
61794>>>            //        move (trim(sper))                            to Tmpaxio.perigrafh
61794>>>            //             if (sper='1') add cmoves.cmoves_axia    to nmetrhta
61794>>>            //        else if (sper='2') add cmoves.cmoves_axia    to nepitages
61794>>>            //        else if (sper='3') add cmoves.cmoves_axia    to nsynal
61794>>>            //        else if (sper='4') add cmoves.cmoves_axia    to nembasma
61794>>>            //        move cmoves.cmoves_axia                      to Tmpaxio.axia
61794>>>            //
61794>>>            //        //gts 13-03-08
61794>>>            //        // ©ç¤¦¢˜ ˜¤á œš¡˜«á©«˜©ž
61794>>>            //
61794>>>            //        move (trim(cmoves.client_id))           to scode
61794>>>            //        Move (Right(scode, Ikod))               To scode
61794>>>            //        move (replaces('.',scode,'')) to scode
61794>>>            //        insert '01' in scode at 1
61794>>>            //        if (Sysfile.Client_Digits<6);
61794>>>            //            insert '0' in scode at 5
61794>>>            //        move (trim(scode))                      to TmpAxio.code
61794>>>            //        move (trim(cmoves.client_name))         to TmpAxio.apodekths
61794>>>            //        move '„¤˜¤«  ¢¦š˜¨ ˜©£¦¬'              to TmpAxio.Aitiol
61794>>>            //        if (sper='1') begin
61794>>>            //            move ''                             to Tmpaxio.lhxh
61794>>>            //            move ''                             to Tmpaxio.bank
61794>>>            //            move ''                             to Tmpaxio.ekdoths
61794>>>            //            move ''                             to Tmpaxio.noepit
61794>>>            //            move ''                             to Tmpaxio.xora
61794>>>            //            move ''                             to Tmpaxio.idioy
61794>>>            //            move ''                             to Tmpaxio.eparxia
61794>>>            //        end
61794>>>            //        else begin
61794>>>            //            Relate Bmove
61794>>>            //            move Baxio.baxio_hmnial             to Tmpaxio.lhxh
61794>>>            //            move baxio.baxio_banka              to Tmpaxio.bank
61794>>>            //            move (trim(baxio.baxio_ekdothse))   to Tmpaxio.ekdoths
61794>>>            //            move (trim(baxio.baxio_no))         to Tmpaxio.noepit
61794>>>            //            move 'GR'                           to Tmpaxio.xora
61794>>>            //            if (baxio.baxio_from='0') move '1'  to Tmpaxio.idioy
61794>>>            //            else if (baxio.baxio_from='1') move '2' to Tmpaxio.idioy
61794>>>            //            else if (baxio.baxio_from='')  move ''  to Tmpaxio.idioy
61794>>>            //            if (baxio.baxio_topos='0') move '2'  to Tmpaxio.eparxia
61794>>>            //            else if (baxio.baxio_topos='1') move '1' to Tmpaxio.eparxia
61794>>>            //            else if (baxio.baxio_topos='')  move ''  to Tmpaxio.eparxia
61794>>>            //
61794>>>            //        end
61794>>>            //        move 'EUR'                              To Tmpaxio.nomisma
61794>>>            //        move barticl.pae_arithm                 to tmpaxio.pae_arithm
61794>>>            //        move barticl.pae_hmnia                  to tmpaxio.pae_hmnia
61794>>>            //        If ((tmpaxio.type = 'B200') or (tmpaxio.type = 'B201')) BEGIN
61794>>>            //           if (btypkin.gplan_code_apo1 <> '') begin
61794>>>            //               clear tmppol
61794>>>            //               move 'FI2'                              to TmpPol.onoma
61794>>>            //               move '01'                               to TmpPol.typos
61794>>>            //               move 'DMK1'                             to TmpPol.etairia
61794>>>            //               move segkatastash                       to TmpPol.perioxh
61794>>>            //               move sPERIOXH                           to TmpPol.egkatastash
61794>>>            //               move segkatastash                       to TmpPol.tomeas
61794>>>            //               move btypkin.btypkin_descr              to tmppol.descr
61794>>>            //               move tmpaxio.type                       to tmppol.type
61794>>>            //               move tmpaxio.arithmos                   to Tmppol.arithmos
61794>>>            //               move tmpaxio.hmnia                      to Tmppol.hmnia
61794>>>            //               MOVE barticl.sxolia1                    to tmppol.sxolia
61794>>>            //               move ''                                 to Tmppol.kodikos
61794>>>            //               move tmpaxio.axia                       to Tmppol.axia
61794>>>            //               if (Tmppol.axia <> 0) begin
61794>>>            //                   if (cmoves.cmoves_p0 <> 0);
61794>>>            //                       move '_'                        to Tmppol.kinhsh
61794>>>            //                   if (cmoves.cmoves_p0 < 0);
61794>>>            //                       move '-'                        to Tmppol.sign
61794>>>            //                   if (cmoves.cmoves_x0 <> 0);
61794>>>            //                       move ''                        to Tmppol.kinhsh
61794>>>            //                   if (cmoves.cmoves_x0 < 0);
61794>>>            //                       move '-'                        to Tmppol.sign
61794>>>            //                end
61794>>>            //
61794>>>            //                move (trim(tmpaxio.code))              to Tmppol.code
61794>>>            //                move tmpaxio.anal                      to Tmppol.kodikos2
61794>>>            //                move tmpaxio.apodekths                 to Tmppol.name
61794>>>            //                Clear Tperga
61794>>>            //                move barticl.cn_code  to tperga.cn_code
61794>>>            //                find gt tperga by index.1
61794>>>            //                while ((found) and (barticl.cn_code=tperga.cn_code))
61794>>>            //                    if ((tperga.xarhtos_meres<>0) and (tperga.plhroteo_meres<>0)) begin
61794>>>            //                        move '' to soroi
61794>>>            //                        move tperga.xarhtos_meres to soroi
61794>>>            //                        insert tperga.plhroteo_meres in soroi at 3
61794>>>            //                        move (trim(soroi)) to soroi
61794>>>            //                    end
61794>>>            //                    find gt tperga by index.1
61794>>>            //                loop
61794>>>            //                move soroi                              to Tmppol.Oroi
61794>>>            //                move 'EUR'                              To Tmppol.nomisma
61794>>>            //                saverecord Tmppol
61794>>>            //                move  0 to tmppol.recnum
61794>>>            //                if (tmpaxio.type='B200');
61794>>>            //                    move '00001' to tmppol.kodikos
61794>>>            //                else if (tmpaxio.type='B201');
61794>>>            //                    move '00002' to tmppol.kodikos
61794>>>            //       //         move btypkin.gplan_code_apo1            to Tmppol.kodikos
61794>>>            //                move ''                                 to tmppol.code
61794>>>            //                move '03' to tmppol.typos
61794>>>            //                saverecord tmppol
61794>>>            //
61794>>>            //           End
61794>>>            //        End
61794>>>            //        else begin
61794>>>            //            saverecord TmpAxio
61794>>>            //            add 1 to Imet
61794>>>            //        end
61794>>>            //
61794>>>            //        nextcmovesdd:
61794>>>            //        Set Label Of frmShow to ('€¥ æš¨˜­˜' + '-' + String(iMet)+'-'+String(cmoves.cmoves_hmnia))
61794>>>            //        if (ienhsap=1) begin
61794>>>            //            clear clients
61794>>>            //            move sclientid to clients.client_id
61794>>>            //            find eq clients by index.6
61794>>>            //            if (found=1) begin
61794>>>            //                move dkenhdate to clients.sap_hmnia
61794>>>            //                saverecord clients
61794>>>            //            end
61794>>>            //        end
61794>>>            //        find gt cmoves by 16
61794>>>            //
61794>>>            //     Loop
61794>>>            //        clear TmpAxio
61794>>>            //        move segkatastash                       to Tmpaxio.EGKATASTASH
61794>>>            //        move ''                                 to tmpaxio.anal
61794>>>            //        move 'FI3'                              to Tmpaxio.onoma
61794>>>            //        move '90'      to Tmpaxio.typos
61794>>>            //        move 'DMK1'                             to Tmpaxio.etairia
61794>>>            //        MOVE STOMEAS                            to Tmpaxio.perioxh
61794>>>            //        move '9999'                             to Tmpaxio.type
61794>>>            //        move '9999999999'                       to Tmpaxio.arithmos
61794>>>            //    move '1'                                to Tmpaxio.perigrafh
61794>>>            //    move nmetrhta                           to Tmpaxio.axia
61794>>>            //    saverecord TmpAxio
61794>>>            //    clear TmpAxio
61794>>>            //    move segkatastash                       to Tmpaxio.EGKATASTASH
61794>>>            //    move 'FI3'                              to Tmpaxio.onoma
61794>>>            //    move ''                                 to tmpaxio.anal
61794>>>            //    MOVE STOMEAS                           to Tmpaxio.perioxh
61794>>>            //    move '91'                               to Tmpaxio.typos
61794>>>            //    move 'DMK1'                             to Tmpaxio.etairia
61794>>>            //    move '9999'                             to Tmpaxio.type
61794>>>            //    move '9999999999'                       to Tmpaxio.arithmos
61794>>>            //    move '2'                                to Tmpaxio.perigrafh
61794>>>            //    move nepitages                          to Tmpaxio.axia
61794>>>            //    move 'EUR'                              To Tmpaxio.nomisma
61794>>>            //    saverecord TmpAxio
61794>>>            //    clear TmpAxio
61794>>>            //    move segkatastash                       to Tmpaxio.EGKATASTASH
61794>>>            //    move 'FI3'                              to Tmpaxio.onoma
61794>>>            //    move '92'                               to Tmpaxio.typos
61794>>>            //    move ''                                 to tmpaxio.anal
61794>>>            //    move 'DMK1'                             to Tmpaxio.etairia
61794>>>            //    MOVE STOMEAS                            to Tmpaxio.perioxh
61794>>>            //    move '9999'                             to Tmpaxio.type
61794>>>            //    move '9999999999'                       to Tmpaxio.arithmos
61794>>>            //    move '3'                                to Tmpaxio.perigrafh
61794>>>            //    move nsynal                             to Tmpaxio.axia
61794>>>            //    move 'EUR'                              To Tmpaxio.nomisma
61794>>>            //    saverecord TmpAxio
61794>>>            //    clear TmpAxio
61794>>>            //    move segkatastash                       to Tmpaxio.EGKATASTASH
61794>>>            //    move 'FI3'                              to Tmpaxio.onoma
61794>>>            //
61794>>>            //    move '93'                               to Tmpaxio.typos
61794>>>            //    move 'DMK1'                             to Tmpaxio.etairia
61794>>>            //    move '9999'                             to Tmpaxio.type
61794>>>            //    move ''                                 to tmpaxio.anal
61794>>>            //    MOVE STOMEAS                            to Tmpaxio.perioxh
61794>>>            //    move '9999999999'                       to Tmpaxio.arithmos
61794>>>            //    move '4'                                to Tmpaxio.perigrafh
61794>>>            //    move nembasma                           to Tmpaxio.axia
61794>>>            //    move 'EUR'                              To Tmpaxio.nomisma
61794>>>            //    saverecord TmpAxio
61794>>>            //    clear TmpAxio
61794>>>            //    move segkatastash                       to Tmpaxio.EGKATASTASH
61794>>>            //    move 'FI3'                              to Tmpaxio.onoma
61794>>>            //    move '94'                               to Tmpaxio.typos
61794>>>            //    move ''                                 to tmpaxio.anal
61794>>>            //    MOVE STOMEAS                            to Tmpaxio.perioxh
61794>>>            //    move 'DMK1'                             to Tmpaxio.etairia
61794>>>            //    move '9999'                             to Tmpaxio.type
61794>>>            //    move '9999999999'                       to Tmpaxio.arithmos
61794>>>            //    move imet                               to Tmpaxio.axia
61794>>>            //    saverecord TmpAxio
61794>>>            //
61794>>>            //End_Procedure
61794>>>            //
61794>>>            //
61794>>>            //Procedure enhmerose_polhseis
61794>>>            //     string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo SSIGN sptyp
61794>>>            //     string stomeas soroi scmoves skod sitem spar sparast skodikos sclientid spmsrecr  spartlrecr
61794>>>            //     NUMBER npartlfpa npmsfpa
61794>>>            //     integer Imet Ikod  irecnum  ino ienhsap iarnhtika
61794>>>            //     number  ntot nfpa nnet nqty nhqty
61794>>>            //     date dapod ddate dkenhdate
61794>>>            //     string msgstr
61794>>>            //     move '01/01/2005' to ddate
61794>>>            //     move '01/01/1753' to dkenhdate
61794>>>            //     clear tmppol
61794>>>            //     find gt tmppol.recnum
61794>>>            //     while (found)
61794>>>            //        if (tmppol.typos='01');
61794>>>            //            add tmppol.axia to ntot
61794>>>            //        find gt tmppol.recnum
61794>>>            //     Loop
61794>>>            //     get value of frmapo to dapod
61794>>>            //     move Sysfile.Client_Digits to Ikod
61794>>>            //     add 3 to ikod // gia na paroyme kai to AX ektos yomea
61794>>>            //     clear Company
61794>>>            //     move syscurxr.company_code to Company.company_code
61794>>>            //     find eq company by index.1
61794>>>            //     move Company.company_c_code0 to stomeas
61794>>>            //     clear Particle
61794>>>            //     find gt particle by 17
61794>>>            //     while ((found) and (particle.sap_hmnia = ''))
61794>>>            //        if  (particle.partl_hmnia  > dapod);
61794>>>            //            goto nextpmovesdd
61794>>>            //        if (syscurxr.company_code<>particle.company_code);
61794>>>            //            goto nextpmovesdd
61794>>>            //        if (particle.partl_no < 1);
61794>>>            //            goto nextpmovesdd
61794>>>            //        move '' to sclientid
61794>>>            //        move 0 to ienhsap
61794>>>            //        clear tempitem
61794>>>            //        find gt tempitem.recnum
61794>>>            //        while (found)
61794>>>            //            delete tempitem
61794>>>            //            find gt tempitem.recnum
61794>>>            //        Loop
61794>>>            //
61794>>>            //        clear tmplg
61794>>>            //        find gt tmplg.recnum
61794>>>            //        while (found)
61794>>>            //            delete tmplg
61794>>>            //            find gt tmplg.recnum
61794>>>            //        Loop
61794>>>            //        move 0 to npartlfpa
61794>>>            //        move 0 to npmsfpa
61794>>>            //        clear branch
61794>>>            //        move particle.company_code to branch.company_code
61794>>>            //        move particle.branch_code  to branch.branch_code
61794>>>            //        find eq branch by index.1
61794>>>            //
61794>>>            //
61794>>>            //        move branch.PERIOXH            to sperioxh
61794>>>            //        move branch.egkatastash        to segkatastash
61794>>>            //        move particle.partl_recr                to srecr
61794>>>            //     //   move particle.partl_vatam      to npartlfpa
61794>>>            //        clear TmpPol
61794>>>            //        MOVE '' to  ssign
61794>>>            //        move 'FI2'                              to TmpPol.onoma
61794>>>            //        move '01'                               to TmpPol.typos
61794>>>            //        move 'DMK1'                             to TmpPol.etairia
61794>>>            //        move segkatastash                       to TmpPol.perioxh
61794>>>            //        move sPERIOXH                           to TmpPol.egkatastash
61794>>>            //        move segkatastash                       to TmpPol.tomeas
61794>>>            //        relate Particle
61794>>>            //        if (trim(ptyppar.sap)='');
61794>>>            //            goto nextpmovesdd
61794>>>            //        IF (clients.client_fpa=1);
61794>>>            //            goto nextpmovesdd
61794>>>            //
61794>>>            //
61794>>>            //        move (trim(ptyppar.ptyppar_descr))      to Tmppol.descr
61794>>>            //        move (trim(Ptyppar.ptyppar_code))       to stype
61794>>>            //        move '' to spartlrecr
61794>>>            //        move '' to sptyp
61794>>>            //        if (ptyppar.sub='1') insert 'C' in stype at 1
61794>>>            //        else insert 'B' in stype at 1
61794>>>            //        if (stype<>'C') begin
61794>>>            //            clear psxetika
61794>>>            //            move particle.partl_recr to spartlrecr
61794>>>            //            move spartlrecr to psxetika.psx_partl_recr
61794>>>            //            find gt psxetika by index.3
61794>>>            //            while ((found) and (spartlrecr=psxetika.psx_partl_recr))
61794>>>            //                move psxetika.ptyppar_code to sptyp
61794>>>            //                clear ptypparl
61794>>>            //                move particle.company_code to ptypparl.company_code
61794>>>            //                move particle.branch_code  to ptypparl.branch_code
61794>>>            //                move sptyp                 to ptypparl.ptyppar_code
61794>>>            //                find eq ptypparl by index.1
61794>>>            //                if (found) begin
61794>>>            //                   if (ptypparl.sub='1') begin
61794>>>            //                        move '' to stype
61794>>>            //                        move (trim(Ptyppar.ptyppar_code))       to stype
61794>>>            //                        insert 'C' in stype at 1
61794>>>            //                   end
61794>>>            //                End
61794>>>            //                find gt psxetika by index.3
61794>>>            //            Loop
61794>>>            //
61794>>>            //        end
61794>>>            //
61794>>>            //        move (trim(stype))                      to Tmppol.type
61794>>>            //        move '' to spar
61794>>>            //        // gts 1/10/08 ž«ãŸž¡œ ¤˜ šå¤œ«˜  export ¡˜  ž ©œ ¨á
61794>>>            //        //move particle.pseira_seira              to tmppol.sxrecr
61794>>>            //        sTRING S1 S2 s3
61794>>>            //        Move "" to s1
61794>>>            //        Move "" to s2
61794>>>            //        Move "" to s3
61794>>>            //
61794>>>            //        clear pseira
61794>>>            //        move particle.company_code to pseira.company_code
61794>>>            //        move particle.branch_code  to pseira.branch_code
61794>>>            //        move particle.ptyppar_code to pseira.ptyppar_code
61794>>>            //        move particle.pseira_seira to pseira.pseira_seira
61794>>>            //        find eq pseira by index.1
61794>>>            //        if (found) begin
61794>>>            ////             SHOWLN PSEIRA.PSEIRA_FORM
61794>>>            ////             SHOWLN particle.partl_no
61794>>>            //            Move (Trim(pseira.pseira_form)) to s1
61794>>>            //            Move (Trim(String(particle.partl_no))) to s2
61794>>>            //            Move (Trim(s1+s2)) to s3
61794>>>            //            Move (Trim(s3)) to tmppol.arithmos
61794>>>            //            //Move (Append(tmppol.arithmos,(trim(pseira.pseira_form)+STRING(particle.partl_no)))) to tmppol.arithmos
61794>>>            //
61794>>>            //        end
61794>>>            //        //move particle.partl_no                  to Tmppol.arithmos
61794>>>            //        move Particle.Partl_hmnia               to Tmppol.hmnia
61794>>>            //        MOVE PARTICLE.AITIOL                    to tmppol.sxolia
61794>>>            //        move ''                                 to Tmppol.kodikos
61794>>>            //        move Particle.partl_payam               to Tmppol.axia
61794>>>            //        add Tmppol.axia                         to ntot
61794>>>            //        move (trim(Particle.client_id))         to scode
61794>>>            //        move Particle.partl_totamad             to Tmppol.posonet
61794>>>            //        move '' to skodikos
61794>>>            //        if (Tmppol.axia <> 0) begin
61794>>>            //            move particle.cmoves_recr           to scmoves
61794>>>            //            clear cmoves
61794>>>            //            move scmoves to cmoves.cmoves_recr
61794>>>            //            find eq cmoves by index.2
61794>>>            //            if (cmoves.cmoves_p0 <> 0);
61794>>>            //                move ''                        to Tmppol.kinhsh
61794>>>            //            if (cmoves.cmoves_p0 < 0) begin
61794>>>            //                move '-'                        to Tmppol.sign
61794>>>            //                move '-'                        to ssign
61794>>>            //            end
61794>>>            //            if (cmoves.cmoves_x0 <> 0);
61794>>>            //                move '•'                        to Tmppol.kinhsh
61794>>>            //            if (cmoves.cmoves_x0 < 0) begin
61794>>>            //                move '-'                        to Tmppol.sign
61794>>>            //                move '-'                        to ssign
61794>>>            //            end
61794>>>            //        end
61794>>>            //        Move (Right(scode, Ikod))               To scode
61794>>>            //        move (replaces('.',scode,'')) to scode
61794>>>            //        insert '01' in scode at 1
61794>>>            //        if (Sysfile.Client_Digits<6);
61794>>>            //            insert '0' in scode at 5
61794>>>            //        move (trim(scode))                      to Tmppol.code
61794>>>            //        Relate Particle
61794>>>            //        if (clients.is_xondr='1')     move '1'     to skodikos
61794>>>            //        else                          move '2'     to skodikos
61794>>>            //   //     If (sysfile.company_name='1') move '1'     to skodikos
61794>>>            //        if (clients.is_xondr='1')     move '01'     to Tmppol.kodikos2
61794>>>            //        else                          move '02'     to Tmppol.kodikos2
61794>>>            //        If (sysfile.company_name='1') move '01'     to Tmppol.kodikos2
61794>>>            //        if ((particle.ptyppar_code='100') or (particle.ptyppar_code='113')) begin
61794>>>            //            if (particle.ptyppar_code<>clients.client_ptyppar) begin
61794>>>            //               move '˜¨˜©«˜« ¡æ <> ˜§æ æ«  ¦¨å©«ž¡œ ©«¦¤ œ¢á«ž. ˜¨˜©«˜« ¡æ = ' to msgstr
61794>>>            //               append msgstr tmppol.arithmos
61794>>>            //               error 5690 msgstr
61794>>>            //            end
61794>>>            //        End
61794>>>            //        if ((clients.status='') and (clients.sap_hmnia<=ddate)) begin
61794>>>            //            move 1 to ienhsap
61794>>>            //            move Particle.client_id to sclientid
61794>>>            //            if (clients.client_ptyppar='') begin
61794>>>            //                move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå §˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž = ' to msgstr
61794>>>            //                append msgstr clients.client_id
61794>>>            //                error 4330 msgstr
61794>>>            //            end
61794>>>            //            if (clients.client_ptyppar='100') begin
61794>>>            //                    move '' to msgstr
61794>>>            //                    if (clients.is_xondr<>'1') begin
61794>>>            //                        move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
61794>>>            //                        append msgstr clients.client_id
61794>>>            //                        error 4333 msgstr
61794>>>            //                    end
61794>>>            //            end
61794>>>            //            else begin
61794>>>            //                if (clients.client_ptyppar<>'113') begin
61794>>>            //                    move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
61794>>>            //                    append msgstr clients.client_id
61794>>>            //                    error 4334 msgstr
61794>>>            //                end
61794>>>            //            end
61794>>>            //        end
61794>>>            //        move ''                                 to Tmppol.apoth
61794>>>            //        move 0                                  to Tmppol.qty
61794>>>            //        move clients.client_name                to Tmppol.name
61794>>>            //        Clear Tperga
61794>>>            //        move Particle.cn_code  to tperga.cn_code
61794>>>            //        find gt tperga by index.1
61794>>>            //        while ((found) and (particle.cn_code=tperga.cn_code))
61794>>>            //            if ((tperga.xarhtos_meres<>0) and (tperga.plhroteo_meres<>0)) begin
61794>>>            //                move '' to soroi
61794>>>            //                move tperga.xarhtos_meres to soroi
61794>>>            //                insert tperga.plhroteo_meres in soroi at 3
61794>>>            //                move (trim(soroi)) to soroi
61794>>>            //            end
61794>>>            //            find gt tperga by index.1
61794>>>            //        loop
61794>>>            //        move soroi                              to Tmppol.Oroi
61794>>>            //        move 'EUR'                              To Tmppol.nomisma
61794>>>            //        saverecord Tmppol
61794>>>            //        add 1 to ino
61794>>>            //        add 1 to Imet
61794>>>            //        move 0 to iarnhtika
61794>>>            //        clear pmoves
61794>>>            //        move srecr to pmoves.partl_recr
61794>>>            //        find gt pmoves by index.3
61794>>>            //        while ((found) and (srecr=pmoves.partl_recr))
61794>>>            //            clear TmpPol
61794>>>            //            move 'FI2'                              to TmpPol.onoma
61794>>>            //            move '03'                               to TmpPol.typos
61794>>>            //            move 'DMK1'                             to TmpPol.etairia
61794>>>            //            move segkatastash                       to TmpPol.perioxh
61794>>>            //            move sPERIOXH                           to TmpPol.egkatastash
61794>>>            //            move segkatastash                       to TmpPol.tomeas
61794>>>            //            move (trim(stype))                      to Tmppol.type
61794>>>            //            move ssign                              to tmppol.sign
61794>>>            //            move (TRIM(S3))                         to Tmppol.arithmos
61794>>>            //          //  move pmoves.partl_no                    to Tmppol.arithmos
61794>>>            //            move Pmoves.Partl_hmnia                 to Tmppol.hmnia
61794>>>            //            move pmoves.pms_unitprice               to tmppol.unitpr
61794>>>            //            move iarnhtika                          to tmppol.neo
61794>>>            //            Relate Pmoves
61794>>>            //            move '' to skod
61794>>>            //            move (trim(wapokat.gl))                 to skod
61794>>>            //            IF (pmoves.pms_status_e=1);
61794>>>            //                move '1'                            to skod
61794>>>            //            insert ptyppar.sap in skod at 2
61794>>>            //            move skodikos to sstr
61794>>>            //            insert sstr              in skod at 3
61794>>>            //            insert Item.link2        in skod at 4
61794>>>            //            if (particle.skopos_diakin='9') move '2' to sstr
61794>>>            //            else                            move '1' to sstr
61794>>>            //            insert sstr              in skod at 5
61794>>>            //            if (trim(wapokat.gl)='') begin
61794>>>            //                move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©« ª €§¦Ÿã¡œª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
61794>>>            //                append msgstr tmppol.arithmos
61794>>>            //                error 4441 msgstr
61794>>>            //            End
61794>>>            //            if (trim(item.link2)='') begin
61794>>>            //                move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª ‘ç¤›œ©žª SAP ©«¦ „å›¦ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
61794>>>            //                append msgstr tmppol.arithmos
61794>>>            //                error 4443 msgstr
61794>>>            //            End
61794>>>            //            move skod                               to Tmppol.kodikos
61794>>>            //            move Pmoves.pms_amaftdisc               to Tmppol.axia
61794>>>            //       //     add  pmoves.pms_vatam                   to npmsfpa
61794>>>            //            move Pmoves.pms_VATAM                   to Tmppol.POSOFPA
61794>>>            //            add  Tmppol.axia                        to nnet
61794>>>            //            move 'B'                                to sitem
61794>>>            //            IF (pmoves.pms_status_e=1);
61794>>>            //                move 'G'                            to sstr
61794>>>            //            else;
61794>>>            //                move wapokat.sap_descr              to sstr
61794>>>            //            insert sstr in sitem at 2
61794>>>            //            if (trim(wapokat.sap_descr)='') begin
61794>>>            //                move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©«ã¤ ‰˜«žš¦¨å˜ „å›¦¬ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
61794>>>            //                append msgstr tmppol.arithmos
61794>>>            //                error 4459 msgstr
61794>>>            //            End
61794>>>            //            insert 'O' in sitem at 3
61794>>>            //            insert item.sap in sitem at 4
61794>>>            //            if (trim(item.sap)='') begin
61794>>>            //                move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP „å›¦¬ª ©«æ „å›¦ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
61794>>>            //                append msgstr tmppol.arithmos
61794>>>            //                error 4446 msgstr
61794>>>            //            End
61794>>>            //            if (pmoves.wapokat_code='05') begin
61794>>>            //                clear tmplg
61794>>>            //                move item.sap to tmplg.company_code
61794>>>            //                move  Pmoves.pms_VATAM to tmplg.gmove_x0
61794>>>            //                saverecord tmplg
61794>>>            //            end
61794>>>            //            string spinak
61794>>>            //            move '' to spinak
61794>>>            //            move sitem                              to tmppol.apoth
61794>>>            //            move pmoves.pms_qty                     to Tmppol.qty
61794>>>            //            move pmoves.wapokat_code                to tmppol.wapokat_code
61794>>>            //            move pmoves.sx_arithmos                 to Tmppol.sxetiko
61794>>>            //            move item.item_code                     to Tmppol.item
61794>>>            //            move item.item_descr                    to Tmppol.item_descr
61794>>>            //            move Units.Units_Descr                  to Tmppol.mm
61794>>>            //            if (trim(pmoves.car_id)<>'')  begin
61794>>>            //                Clear Cars
61794>>>            //                move (trim(pmoves.car_id))  to Cars.car_id
61794>>>            //                Find eq Cars by index.2
61794>>>            //                Move (Append(spinak,(cars.car_what+'_'+cars.car_lc+cars.car_ln)))  to spinak
61794>>>            //                if ((cars.car_what='') and (cars.car_ln=''));
61794>>>            //                    move '' to spinak
61794>>>            //                MOVE SPINAK to Tmppol.pinakida
61794>>>            //
61794>>>            //                If (trim(cars.ctype_id)='1');
61794>>>            //                    move '1' to Tmppol.kathgoria
61794>>>            //                else if (trim(cars.ctype_id)='2');
61794>>>            //                    move '2' to Tmppol.kathgoria
61794>>>            //                else if (trim(cars.ctype_id)='3');
61794>>>            //                    move '3' to tmppol.kathgoria
61794>>>            //                else;
61794>>>            //                    move '4' to tmppol.kathgoria
61794>>>            //            end
61794>>>            //            if (pmoves.wapokat_code='04') begin
61794>>>            //                move '' to tmppol.pinakida
61794>>>            //                move '' to tmppol.kathgoria
61794>>>            //            end
61794>>>            //            if (pmoves.wapokat_code='05') begin
61794>>>            //                move '' to tmppol.kathgoria
61794>>>            //                move pmoves.pump_id to pumps.pump_id
61794>>>            //                find eq pumps by index.3
61794>>>            //                if (found=1) begin
61794>>>            //                    MOVE '' to spinak
61794>>>            //                    Move (Append(spinak,(pumps.pump_what+pumps.pump_lc+pumps.pump_ln))) to spinak
61794>>>            //                    move spinak to Tmppol.pinakida
61794>>>            //                 end
61794>>>            //                 If (trim(pumps.ctype_id)='1');
61794>>>            //                    move '1' to Tmppol.antlhsh
61794>>>            //                 else if (trim(pumps.ctype_id)='2');
61794>>>            //                    move '2' to Tmppol.antlhsh
61794>>>            //                 else if (trim(pumps.ctype_id)='4');
61794>>>            //                    move '3' to Tmppol.antlhsh
61794>>>            //                 else move '' to tmppol.antlhsh
61794>>>            //            END
61794>>>            //            move soroi                              to Tmppol.Oroi
61794>>>            //            move (abs(pmoves.pms_vatpct))           to Tmppol.fpa
61794>>>            //            move 'EUR'                              To Tmppol.nomisma
61794>>>            //            move particle.aitiol                    to tmppol.sxolia
61794>>>            //            saverecord Tmppol
61794>>>            //            add 1 to imet
61794>>>            //            if (pmoves.wapokat_code='05') begin
61794>>>            //                clear tempitem
61794>>>            //                move tmppol.recnum to tempitem.wcmove_qty_eisa
61794>>>            //                move '1' to tempitem.wcmove_status_e
61794>>>            //                move item.sap to tempitem.witemx_code
61794>>>            //                move soroi to tempitem.client_id
61794>>>            //                move (abs(pmoves.pms_vatpct))           to Tempitem.company_code
61794>>>            //                move Units.Units_Descr to tempitem.branch_code
61794>>>            //                move pmoves.pms_qty                     to tempitem.wcmove_qty
61794>>>            //                move Pmoves.pms_amaftdisc               to tempitem.wcmove_axia
61794>>>            //                move Pmoves.pms_VATAM                   to Tempitem.wcmove_qty_exa
61794>>>            //                saverecord tempitem
61794>>>            //            end
61794>>>            //            Set Label Of frmShow to ('à¢ã©œ ª' + '-' + String(iMet)+'-'+String(Tmppol.arithmos))
61794>>>            //            find gt pmoves by index.3
61794>>>            //        Loop
61794>>>            //
61794>>>            //        move 0                                  to tmppol.recnum
61794>>>            //        move particle.partl_vatam               to Tmppol.axia
61794>>>            //        add Tmppol.axia                         to nfpa
61794>>>            //        move sEGKATASTASH                       to TmpPol.perioxh
61794>>>            //        move ''                                 to tmppol.code
61794>>>            //        move ''                                 to tmppol.kodikos2
61794>>>            //        move ''                                 to tmppol.apoth
61794>>>            //        move 0                                  to tmppol.qty
61794>>>            //        move 0                                  to tmppol.unitpr
61794>>>            //        move ''                                 to tmppol.mm
61794>>>            //        move ''                                 to tmppol.kathgoria
61794>>>            //        move ''                                 to tmppol.pinakida
61794>>>            //        move ''                                 to tmppol.ANTLHSH
61794>>>            //        move 0                                  to tmppol.posofpa
61794>>>            //        move ''                                 to tmppol.item
61794>>>            //        move ''                                 to tmppol.wapokat_code
61794>>>            //        move ''                                 to tmppol.sxetiko
61794>>>            //        move '05'                               to TmpPol.typos
61794>>>            //        move '' to tmppol.kodikos
61794>>>            //        saverecord Tmppol
61794>>>            //        add 1 to imet
61794>>>            //        clear Psxetika
61794>>>            //        move srecr to Psxetika.partl_recr
61794>>>            //        Find gt Psxetika by index.4
61794>>>            //        while ((found) and (srecr=Psxetika.partl_recr))
61794>>>            //                move 0                              to tmppol.recnum
61794>>>            //                move '06'                           to TmpPol.typos
61794>>>            //                move sEGKATASTASH                   to TmpPol.perioxh
61794>>>            //                move 0                              to tmppol.axia
61794>>>            //                move ''                             to tmppol.oroi
61794>>>            //                move ''                             to tmppol.nomisma
61794>>>            //                move 0                              to Tmppol.posofpa
61794>>>            //                move 0                              to Tmppol.fpa
61794>>>            //                move ''                             to tmppol.item
61794>>>            //                move ''                             to tmppol.wapokat_code
61794>>>            //                move ''                             to tmppol.sxolia
61794>>>            //                move ''                             to tmppol.sxetiko
61794>>>            //                move '' to sparast
61794>>>            //                move psxetika.sx_pseira_seira       to sparast
61794>>>            //                append sparast Psxetika.sx_partl_no
61794>>>            //                move sparast                        to Tmppol.deltia
61794>>>            //                move psxetika.psx_partl_recr        to Tmppol.sxrecr
61794>>>            //                Clear pmovesl
61794>>>            //                move tmppol.sxrecr to pmovesl.partl_recr
61794>>>            //                find gt pmovesl by index.3
61794>>>            //                while ((found) and (tmppol.sxrecr=pmovesl.partl_recr))
61794>>>            //                    if (pmovesl.wapokat_code='05') begin
61794>>>            //                        clear iteml
61794>>>            //                        move pmovesl.item_code to iteml.item_code
61794>>>            //                        find EQ iteml by index.5
61794>>>            //                        move iteml.sap to Tmppol.item
61794>>>            //                        move pmovesl.pms_qty to tmppol.qty
61794>>>            //                        clear pumps
61794>>>            //                        move pmovesl.pump_id to pumps.pump_id
61794>>>            //                        find eq pumps by index.3
61794>>>            //                        if (found=1) begin
61794>>>            //                            MOVE '' to spinak
61794>>>            //                            Move (Append(spinak,(pumps.pump_what+pumps.pump_lc+pumps.pump_ln))) to spinak
61794>>>            //                            move spinak to Tmppol.pinakida
61794>>>            //
61794>>>            //                        end
61794>>>            //                        If (trim(pumps.ctype_id)='1');
61794>>>            //                            move '1' to Tmppol.antlhsh
61794>>>            //                        else if (trim(pumps.ctype_id)='2');
61794>>>            //                            move '2' to Tmppol.antlhsh
61794>>>            //                        else if (trim(pumps.ctype_id)='4');
61794>>>            //                            move '3' to Tmppol.antlhsh
61794>>>            //                        else move '' to tmppol.antlhsh
61794>>>            //                        move '' to tmppol.kathgoria
61794>>>            //                        clear tempitem
61794>>>            //                        move '2' to tempitem.wcmove_status_e
61794>>>            //                        move (trim(iteml.sap)) to tempitem.witemx_code
61794>>>            //                        move (trim(spinak)) to tempitem.item_code
61794>>>            //
61794>>>            //                        move (trim(tmppol.antlhsh)) to tempitem.year_year
61794>>>            //                        find eq tempitem by index.4
61794>>>            //                        if (found) begin
61794>>>            //                            add  pmovesl.pms_qty to tempitem.wcmove_qty
61794>>>            //                            saverecord tempitem
61794>>>            //                        end
61794>>>            //                        else begin
61794>>>            //                            move '2' to tempitem.wcmove_status_e
61794>>>            //                            move iteml.sap to tempitem.witemx_code
61794>>>            //                            move pmovesl.pms_qty                   to tempitem.wcmove_qty
61794>>>            //                            move Pmovesl.pms_amaftdisc             to tempitem.wcmove_axia
61794>>>            //                            move Pmovesl.pms_VATAM                 to Tempitem.wcmove_qty_exa
61794>>>            //                            saverecord tempitem
61794>>>            //                        end
61794>>>            //                    end
61794>>>            //                    find gt pmovesl by index.3
61794>>>            //                Loop
61794>>>            //                add 1 to imet
61794>>>            //                saverecord Tmppol
61794>>>            //            find gt Psxetika by index.4
61794>>>            //        Loop
61794>>>            //
61794>>>            //        // œ›à œ®œ  › ˜£¦¨­àŸœå «¦ ˜¨®œ ¦ £œ œšš¨˜­œª 1 ¡˜  2
61794>>>            //        // 1 ˜¨® ¡ã œšš¨˜­ã ¡˜  2= «˜ ›ç¦ ¦®ã£˜«˜
61794>>>            //        clear tempitem
61794>>>            //        move '1' to tempitem.wcmove_status_e
61794>>>            //        find gt tempitem by index.4
61794>>>            //        while ((found) and (tempitem.wcmove_status_e='1'))
61794>>>            //            move tempitem.wcmove_qty to nqty
61794>>>            //            move tempitem.witemx_code to sitem
61794>>>            //            MOVE TEMPITEM.wcmove_qty_eisa to irecnum
61794>>>            //            clear tempitel
61794>>>            //            move '2' to tempitel.wcmove_status_e
61794>>>            //            move sitem to tempitel.witemx_code
61794>>>            //            move 0 to nhqty
61794>>>            //            find gt tempitel by index.4
61794>>>            //            while ((found) and (tempitel.wcmove_status_e='2') and (sitem=tempitel.witemx_code))
61794>>>            //                add tempitel.wcmove_qty to nhqty
61794>>>            //                find gt tempitel by index.4
61794>>>            //            Loop
61794>>>            //            if  (nhqty=0) begin
61794>>>            //            end
61794>>>            //            else begin
61794>>>            //                move 0 to npartlfpa
61794>>>            //                integer iTrecnum
61794>>>            //                move 0 to itrecnum
61794>>>            //                move (nqty-nhqty) to nqty
61794>>>            //                clear tempitel
61794>>>            //                move '2' to tempitel.wcmove_status_e
61794>>>            //                move sitem to tempitel.witemx_code
61794>>>            //                move 0 to nhqty
61794>>>            //                move 0 to ino
61794>>>            //                find gt tempitel by index.4
61794>>>            //                while ((found) and (tempitel.wcmove_status_e='2') and (sitem=tempitel.witemx_code))
61794>>>            //
61794>>>            //                    add 1 to ino
61794>>>            //                    clear tmppol
61794>>>            //                    move  irecnum to tmppol.recnum
61794>>>            //                    find eq tmppol.recnum
61794>>>            //                    if (found) begin
61794>>>            //                        move 0 to tmppol.recnum
61794>>>            //                        if (ino=1) Move (tempitel.wcmove_qty+nqty)  to tmpPol.qty
61794>>>            //                        else       move tempitel.wcmove_qty         to tmpPol.qty
61794>>>            //                        Move (ROUnD_number((tmpPol.qty*tmppol.unitpr),2))  to tmppol.axia
61794>>>            //                        Move (ROUnD_number(((tmppol.axia*tmppol.fpa)/100),2))  to tmppol.posofpa
61794>>>            //                        move tempitel.item_code to tmppol.pinakida
61794>>>            //                        move tempitel.year_year to tmppol.antlhsh
61794>>>            //                        add 1 to imet
61794>>>            //                        saverecord tmppol
61794>>>            //                        add tmppol.posofpa to npartlfpa
61794>>>            //                        move tmppol.recnum to itrecnum
61794>>>            //                    end
61794>>>            //                    find gt tempitel by index.4
61794>>>            //
61794>>>            //                Loop
61794>>>            //                clear tmplg
61794>>>            //                move sitem to tmplg.company_code
61794>>>            //                find ge tmplg by index.1
61794>>>            //                while ((found) and (tmplg.company_code=sitem))
61794>>>            //                    if (tmplg.gmove_x0 <> npartlfpa) begin
61794>>>            //                        clear tmppol
61794>>>            //                        move itrecnum to tmppol.recnum
61794>>>            //                        find eq tmppol.recnum
61794>>>            //                        move (tmplg.gmove_x0-npartlfpa) to npartlfpa
61794>>>            //                        add npartlfpa to tmppol.posofpa
61794>>>            //                        saverecord tmppol
61794>>>            //                    end
61794>>>            //                    find gt tmplg by index.1
61794>>>            //                Loop
61794>>>            //                clear tmppol
61794>>>            //                move irecnum to tmppol.recnum
61794>>>            //                find eq tmppol.recnum
61794>>>            //                if (found) begin
61794>>>            //                    delete tmppol
61794>>>            //                    sub 1 from imet
61794>>>            //                end
61794>>>            //            end
61794>>>            //            find gt tempitem by index.4
61794>>>            //        Loop
61794>>>            //        nextpmovesdd:
61794>>>            //        Set Label Of frmShow to ('à¢ã©œ ª' + '-' +string(particle.partl_hmnia)+'-'+String(particle.recnum))
61794>>>            //        if (ienhsap=1) begin
61794>>>            //            clear clients
61794>>>            //            move sclientid to clients.client_id
61794>>>            //            find eq clients by index.6
61794>>>            //            if (found=1) begin
61794>>>            //                move dkenhdate to clients.sap_hmnia
61794>>>            //                saverecord clients
61794>>>            //            end
61794>>>            //        end
61794>>>            //        find gt Particle by 17
61794>>>            //     Loop
61794>>>            //
61794>>>            //     clear Tmppol
61794>>>            //     move 'FI2'                              to Tmppol.onoma
61794>>>            //     move '90'                               to Tmppol.typos
61794>>>            //     move 'DMK1'                             to Tmppol.etairia
61794>>>            //     move '9999'                             to Tmppol.type
61794>>>            //     move '9999999999'                       to Tmppol.arithmos
61794>>>            //     move segkatastash                       to Tmppol.EGKATASTASH
61794>>>            //  //   move sPERIOXH                            to TmpPol.perioxh
61794>>>            //     move sTOMEAS                            to TmpPol.perioxh
61794>>>            //     move ntot                               to Tmppol.axia
61794>>>            //     move 'EUR'                              To Tmppol.nomisma
61794>>>            //     move dapod                               to Tmppol.hmnia
61794>>>            //     saverecord Tmppol
61794>>>            //     move 0                                  to Tmppol.recnum
61794>>>            //     move '91'                               to Tmppol.typos
61794>>>            //     move nfpa                               to Tmppol.axia
61794>>>            //     saverecord Tmppol
61794>>>            //     move 0                                  to Tmppol.recnum
61794>>>            //     move '92'                               to Tmppol.typos
61794>>>            //     move nnet                               to Tmppol.axia
61794>>>            //     saverecord Tmppol
61794>>>            //
61794>>>            //     move 0 to imet
61794>>>            //     clear tmppol
61794>>>            //     find gt tmppol.recnum
61794>>>            //     while (found)
61794>>>            //        if ((tmppol.typos='01') or (tmppol.typos='03') or (tmppol.typos='05') or (tmppol.typos='06'));
61794>>>            //            add 1 to imet
61794>>>            //        if (tmppol.typos='92') begin
61794>>>            //            move 0                                  to Tmppol.recnum
61794>>>            //            move '93'                               to Tmppol.typos
61794>>>            //            move imet                               to Tmppol.axia
61794>>>            //            move ''                                 to Tmppol.nomisma
61794>>>            //            saverecord Tmppol
61794>>>            //            goto next_loopdd
61794>>>            //        end
61794>>>            //        IF (tmppol.typos='06') begin
61794>>>            //           move tmppol.recnum to irecnum
61794>>>            //           if (tmppol.sxrecr<>'') begin
61794>>>            //               clear particle
61794>>>            //               move tmppol.sxrecr to particle.partl_recr
61794>>>            //               find eq particle by index.2
61794>>>            //               if (found) begin
61794>>>            //                    if (particle.ptyppar_code<>'099') begin
61794>>>            //                        delete tmppol
61794>>>            //                        sub 1 from imet
61794>>>            //                        clear tmppol
61794>>>            //                        move irecnum to tmppol.recnum
61794>>>            //                    end
61794>>>            //               end
61794>>>            //            end
61794>>>            //        end
61794>>>            //        find gt tmppol.recnum
61794>>>            //     Loop
61794>>>            //     next_loopdd:
61794>>>            //End_Procedure
61794>>>            //
61794>>>            //Procedure enhmerose_apoth
61794>>>            //     string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo spinak
61794>>>            //     string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
61794>>>            //     STRING sLetter sEnglish sGreek sid spar msgstr
61794>>>            //
61794>>>            //     integer Imet Ikod Ino iLen iFirst iRecnum IINT ipos isygk
61794>>>            //     number  ntot nfpa nqty
61794>>>            //     date dapod ddate dhdate
61794>>>            //     Move 'ABCDEFGHIJKLMNOPRSTUVWXYZ' to sEnglish
61794>>>            //     Move '€–ƒ„”‚†ˆ‰Š‹ŒŽ‘’‡—‘•“…' to sGreek
61794>>>            //     get value of frmapo to dapod
61794>>>            //     move Sysfile.Client_Digits to Ikod
61794>>>            //     add 3 to ikod // gia na paroyme kai to AX ektos yomea
61794>>>            //     clear Company
61794>>>            //     move syscurxr.company_code to Company.company_code
61794>>>            //     find eq company by index.1
61794>>>            //     move Company.company_c_code0 to stomeas
61794>>>            //     clear Wcmoves
61794>>>            //     find gt wcmoves by 16
61794>>>            //     while ((found) and (wcmoves.sap_hmnia=''))
61794>>>            //        if  (wcmoves.wcmove_hmnia  > dapod);
61794>>>            //            goto nextwcmovesdd
61794>>>            //        if (syscurxr.company_code<>Wcmoves.company_code);
61794>>>            //            goto nextwcmovesdd
61794>>>            //        relate Wcmoves
61794>>>            //        if (Wcmoves.module_from<>'01');
61794>>>            //            goto nextwcmovesdd
61794>>>            //        if (Wapokat.OXIMM1='1') BEGIN
61794>>>            //            goto nextwcmovesdd
61794>>>            //        END
61794>>>            //        ELSE BEGIN
61794>>>            //            if (Wapokat.enhm_sap<>'1');
61794>>>            //                goto nextwcmovesdd
61794>>>            //        end
61794>>>            //        if ((Wcmoves.wcmove_qty_eisa=0) and (Wcmoves.wcmove_qty_exa=0));
61794>>>            //            goto nextwcmovesdd
61794>>>            //        if (Wtypkin.wtypkin_anti='');
61794>>>            //            goto nextwcmovesdd
61794>>>            //        move (trim(Wcmoves.client_id))          to scode
61794>>>            //        move Wcmoves.Wcmove_recr                to srecr
61794>>>            //        clear branch
61794>>>            //        move wcmoves.company_code to branch.company_code
61794>>>            //        move wcmoves.branch_code  to branch.branch_code
61794>>>            //        find eq branch by index.1
61794>>>            //        move branch.PERIOXH        to segkatastash
61794>>>            //        clear Tmpapoth
61794>>>            //        move wtypkin.Wtypkin_anti               to Tmpapoth.type
61794>>>            //        move 'MM1'                              to Tmpapoth.onoma
61794>>>            //        move '01'                               to Tmpapoth.typos
61794>>>            //        move segkatastash                       to Tmpapoth.egkatastash
61794>>>            //        clear pmoves
61794>>>            //        move wcmoves.partl_recr to pmoves.pms_recr
61794>>>            //        find eq pmoves by index.2
61794>>>            //        if (not(found)) begin
61794>>>            //            move 'ƒœ¤ ™¨å©¡à recr ©ç¤›œ©žª £œ pmoves wcmoves.particle_recr = ' to msgstr
61794>>>            //            append msgstr wcmoves.particle_recr
61794>>>            //            error 4499 msgstr
61794>>>            //        End
61794>>>            //
61794>>>            //        move pmoves.pseira_seira to spar
61794>>>            //        append spar pmoves.partl_no
61794>>>            //        move spar                               to Tmpapoth.arithmos
61794>>>            //        MOVE '' TO SPINAK
61794>>>            //        Clear Cars
61794>>>            //        move (trim(pmoves.car_id))  to Cars.car_id
61794>>>            //        Find eq Cars by index.2
61794>>>            //        Move (trim(Cars.Car_license)) to spinak
61794>>>            //        For iInt From 1 to (Length(spinak))
61794>>>            //            Move (Mid(spinak,1,iInt)) to sLetter
61794>>>            //            If (sGREEK Contains sLetter) Begin
61794>>>            //                 Move (Pos(sLetter,sgreek)) to iPos
61794>>>            //                 Move (Replaces(sLetter,spinak,(Mid(senglish,1,iPos)))) to spinak
61794>>>            //            End
61794>>>            //        Loop
61794>>>            //
61794>>>            //        move spinak                             to Tmpapoth.pinakida
61794>>>            //        move Wcmoves.Wcmove_hmnia               to Tmpapoth.hmnia
61794>>>            //        move wtypkin.Wtypkin_anti               to Tmpapoth.type
61794>>>            //
61794>>>            //        if (Wtypkin.wtypkin_anti='');
61794>>>            //            goto nextwcmovesdd
61794>>>            //        relate pmoves
61794>>>            //        if (particle.skopos_diakin='2');
61794>>>            //            move 'Z17'                          to Tmpapoth.type
61794>>>            //        if (particle.skopos_diakin='3');
61794>>>            //            move 'Z15'                          to Tmpapoth.type
61794>>>            //        if (clients.anal='1');
61794>>>            //            move 1 to isygk
61794>>>            //        else;
61794>>>            //            move 0 to isygk
61794>>>            //        If (sysfile.company_name='1') move 0     to isygk
61794>>>            //        Move (Right(scode, Ikod))                To scode
61794>>>            //        move (replaces('.',scode,'')) to scode
61794>>>            //        insert '01' in scode at 1
61794>>>            //        if (Sysfile.Client_Digits<6);
61794>>>            //            insert '0' in scode at 5
61794>>>            //        if (wcmoves.client_id='');
61794>>>            //            move '' to scode
61794>>>            //        if (trim(scode)<>'') begin
61794>>>            //            if (isygk=1) begin
61794>>>            //                left scode to sid 4
61794>>>            //                append sid '999999'
61794>>>            //                move (trim(sid)) to scode
61794>>>            //            end
61794>>>            //        end
61794>>>            //        if ((tmpapoth.type='Z17') or (Tmpapoth.type='Z15'));
61794>>>            //            move '' to scode
61794>>>            //        if ((tmpapoth.type='…17') or (Tmpapoth.type='…15'));
61794>>>            //            move '' to scode
61794>>>            //        move (trim(scode))                      to Tmpapoth.code
61794>>>            //
61794>>>            //        move 'B'                                to sitem
61794>>>            //        if (wcmoves.wcmove_status_e=1);
61794>>>            //            move 'G'                            to sti
61794>>>            //        else;
61794>>>            //            move wapokat.sap_descr              to sti
61794>>>            //        if (trim(wapokat.sap_descr)='') begin
61794>>>            //                move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©«ã¤ ‰˜«žš¦¨å˜ „å›¦¬ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
61794>>>            //                append msgstr tmpapoth.arithmos
61794>>>            //                error 4488 msgstr
61794>>>            //        End
61794>>>            //        insert sti in sitem at 2
61794>>>            //        insert 'O' in sitem at 3
61794>>>            //        insert item.sap in sitem at 4
61794>>>            //        move sitem                              to Tmpapoth.item
61794>>>            //        if (wcmoves.wcmove_qty_eisa<> 0);
61794>>>            //            move (ABS(wcmoves.wcmove_qty_eisa))        to Tmpapoth.qty
61794>>>            //        else;
61794>>>            //            move (ABS(wcmoves.wcmove_qty_exa))         to Tmpapoth.qty
61794>>>            //        move UNITS.UNITS_DESCR                  to Tmpapoth.monada
61794>>>            //        saverecord Tmpapoth
61794>>>            //        add 1 to ino
61794>>>            //        add 1 to Imet
61794>>>            //        nextwcmovesdd:
61794>>>            //        move (trim(wcmoves.wcmove_par)) to sno
61794>>>            //        Set Label Of frmShow to ('‰ ¤ã©œ ª €§¦Ÿã¡žª' + '-' + String(iMet)+'-'+String(sno))
61794>>>            //        find gt Wcmoves by 16
61794>>>            //     Loop
61794>>>            //     move 0                                  to Tmpapoth.recnum
61794>>>            //     move ''                                 to Tmpapoth.hmnia
61794>>>            //     move '90'                               to Tmpapoth.typos
61794>>>            //     move '9999999999'                       to Tmpapoth.arithmos
61794>>>            //     move ''                                 to tmpapoth.type
61794>>>            //     move imet                               to Tmpapoth.qty
61794>>>            //     move ''                                 to Tmpapoth.code
61794>>>            //     move ''                                 to Tmpapoth.item
61794>>>            //     move ''                                 to Tmpapoth.egkatastash
61794>>>            //     move ''                                 to Tmpapoth.monada
61794>>>            //     move ''                                 to Tmpapoth.paralabh
61794>>>            //     saverecord Tmpapoth
61794>>>            //     Send StartReport to Rapoth
61794>>>            //End_Procedure
61794>>>            //
61794>>>            //Procedure enhmerose_itemtehn
61794>>>            //     string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo
61794>>>            //     string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
61794>>>            //     integer Imet Ikod Ino iLen iFirst iRecnum
61794>>>            //     number  ntot nfpa nqty
61794>>>            //     date dapod
61794>>>            //     get value of frmapo to dapod
61794>>>            //     clear Company
61794>>>            //     move syscurxr.company_code to Company.company_code
61794>>>            //     find eq company by index.1
61794>>>            //     move Company.company_c_code0 to stomeas
61794>>>            //     clear itemtehn
61794>>>            //     find gt itemtehn by index.4
61794>>>            //     while ((found) and (itemtehn.sap_hmnia=''))
61794>>>            //        if  (itemtehn.hmnia  > dapod);
61794>>>            //            goto nextitemtehndd
61794>>>            //        if (syscurxr.company_code<>itemtehn.company);
61794>>>            //            goto nextitemtehndd
61794>>>            //        relate itemtehn
61794>>>            //        clear branch
61794>>>            //        move itemtehn.company to branch.company_code
61794>>>            //        move itemtehn.branch  to branch.branch_code
61794>>>            //        find eq branch by index.1
61794>>>            //        move branch.PERIOXH        to segkatastash
61794>>>            //        clear Tmptehn
61794>>>            //        move 'PP1'                              to Tmptehn.onoma
61794>>>            //        move '09'                               to Tmptehn.typos
61794>>>            //        move segkatastash                       to Tmptehn.egkatastash
61794>>>            //        move itemtehn.hmnia                     to Tmptehn.hmnia
61794>>>            //        move 'B'                                to sitem
61794>>>            //        clear wapokat
61794>>>            //        move item.wapokat_code to wapokat.wapokat_code
61794>>>            //        find eq wapokat by index.1
61794>>>            //        move wapokat.sap_descr                  to sti
61794>>>            //        insert sti in sitem at 2
61794>>>            //        insert 'O' in sitem at 3
61794>>>            //        insert itemtehn.item_code in sitem at 4
61794>>>            //        move sitem                              to Tmptehn.item
61794>>>            //        move itemtehn.code                      to tmptehn.prodiagrafh
61794>>>            //        move UNITS.UNITS_DESCR                  to Tmptehn.mm
61794>>>            //        move '1'                                to tmptehn.type
61794>>>            //        clear itemd
61794>>>            //        move itemtehn.recr to srecr
61794>>>            //        move 0 to Ino
61794>>>            //        move srecr to itemd.itemtehn_recr
61794>>>            //        find gt itemd by index.5
61794>>>            //        while ((found) and (itemd.itemtehn_recr=srecr))
61794>>>            //            add 1 to ifirst
61794>>>            //            add 1 to ino
61794>>>            //            if (ino>1) begin
61794>>>            //                move 0 to tmptehn.recnum
61794>>>            //                saverecord tmptehn
61794>>>            //            end
61794>>>            //            clear iteml
61794>>>            //            move itemd.itemd_code to iteml.item_code
61794>>>            //            find eq iteml by index.5
61794>>>            //            clear wapokat
61794>>>            //            move iteml.wapokat_code to wapokat.wapokat_code
61794>>>            //            find eq wapokat by index.1
61794>>>            //            clear units
61794>>>            //            move iteml.units_code to units.units_code
61794>>>            //            find eq units by index.1
61794>>>            //            move 'B'                                to sitem
61794>>>            //            move wapokat.sap_descr                  to sti
61794>>>            //            insert sti in sitem at 2
61794>>>            //            insert 'O' in sitem at 3
61794>>>            //            insert itemd.itemd_code in sitem at 4
61794>>>            //            move sitem                              to Tmptehn.itemd
61794>>>            //            move units.units_descr                  to Tmptehn.mmitemd
61794>>>            //            move itemd.itemd_qty                    to Tmptehn.qty
61794>>>            //            move ino                                to tmptehn.aa
61794>>>            //            move itemd.sap_aa  to sno
61794>>>            //            move sno                                to Tmptehn.index
61794>>>            //            saverecord Tmptehn
61794>>>            //            move (trim(itemd.itemtehn_code)) to sno
61794>>>            //            move itemd.recnum to imet
61794>>>            //            Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(iMet)+'-'+String(sno))
61794>>>            //            find gt itemd by index.5
61794>>>            //        Loop
61794>>>            //        nextitemtehndd:
61794>>>            //        move (trim(itemd.itemtehn_code)) to sno
61794>>>            //        move itemd.recnum to imet
61794>>>            //        Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(iMet)+'-'+String(sno))
61794>>>            //        find gt itemtehn by index.4
61794>>>            //    Loop
61794>>>            //    move 0                                  to Tmptehn.recnum
61794>>>            //    move '90'                               to Tmptehn.typos
61794>>>            //    move ifirst                             to Tmptehn.type
61794>>>            //    move ''                                 to Tmptehn.item
61794>>>            //    move ''                                 to Tmptehn.prodiagrafh
61794>>>            //    move ''                                 to Tmptehn.mm
61794>>>            //    move ''                                 to Tmptehn.egkatastash
61794>>>            //    move ''                                 to Tmptehn.itemd
61794>>>            //    move 0                                  to Tmptehn.aa
61794>>>            //    move ''                                 to Tmptehn.mmitemd
61794>>>            //    move 0                                  to Tmptehn.index
61794>>>            //    move 0                                  to Tmptehn.qty
61794>>>            //    saverecord Tmptehn
61794>>>            //End_Procedure
61794>>>            //
61794>>>            //Procedure enhmerose_anal
61794>>>            //     string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo snext
61794>>>            //     string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
61794>>>            //     string seidos
61794>>>            //     integer Imet Ikod Ino itot iFirst iRecnum Icount ifound
61794>>>            //     number  ntot nfpa nqty
61794>>>            //     date dapod ddate
61794>>>            //     move '27/04/2005' to ddate
61794>>>            //     string stexnikh  msgstr
61794>>>            //     get value of frmapo to dapod
61794>>>            //     clear Company
61794>>>            //     move syscurxr.company_code to Company.company_code
61794>>>            //     find eq company by index.1
61794>>>            //     move Company.company_c_code0 to stomeas
61794>>>            //     clear witemxtr
61794>>>            //     find gt witemxtr by index.4
61794>>>            //     while ((found) and (witemxtr.sap_hmnia=''))
61794>>>            //        if  (witemxtr.hmnia  > dapod);
61794>>>            //            goto nextanaldd
61794>>>            //        if (syscurxr.company_code<>witemxtr.company_code);
61794>>>            //            goto nextanaldd
61794>>>            //        move witemxtr.recr to srecr
61794>>>            //        move '' to snext
61794>>>            //        move '' to stexnikh
61794>>>            //        clear witemxtd
61794>>>            //        move srecr to witemxtd.witemxtr_recr
61794>>>            //        find gt witemxtd by index.1
61794>>>            //        while ((found) and (witemxtd.witemxtr_recr=srecr))
61794>>>            //            clear branch
61794>>>            //            move witemxtr.company_code to branch.company_code
61794>>>            //            move witemxtr.branch_code  to branch.branch_code
61794>>>            //            find eq branch by index.1
61794>>>            //            move branch.PERIOXH                 to segkatastash
61794>>>            //            clear Tmpanal
61794>>>            //            move 'PP2'                              to Tmpanal.onoma
61794>>>            //            move '09'                               to Tmpanal.typos
61794>>>            //            move segkatastash                       to Tmpanal.egkatastash
61794>>>            //            move witemxtr.hmnia                     to Tmpanal.hmnia
61794>>>            //            move 'B'                                to sitem
61794>>>            //            move witemxtd.witemx_code               to shitem
61794>>>            //            clear iteml
61794>>>            //            move shitem to iteml.item_code
61794>>>            //            find eq iteml by index.5
61794>>>            //            clear units
61794>>>            //            move iteml.units_code to units.units_code
61794>>>            //            find eq units by index.1
61794>>>            //            move UNITS.UNITS_DESCR                  to Tmpanal.mm
61794>>>            //            clear wapokat
61794>>>            //            move iteml.wapokat_code to wapokat.wapokat_code
61794>>>            //            find eq wapokat by index.1
61794>>>            //            move wapokat.sap_descr                  to sti
61794>>>            //            insert sti in sitem at 2
61794>>>            //            insert 'O' in sitem at 3
61794>>>            //            insert shitem in sitem at 4
61794>>>            //            move 0 to Ino
61794>>>            //            move 0 to icount
61794>>>            //            move sitem                              to Tmpanal.item
61794>>>            ////            move sitem                              to seidos
61794>>>            //            clear anprod
61794>>>            //            move srecr                      to anprod.entolh_recr
61794>>>            //            move witemxtd.witemx_code       to anprod.anprod_form
61794>>>            //            move witemxtd.fpa_from          to anprod.anprod_cartp
61794>>>            //            move witemxtd.texnikh           to anprod.anprod_itemtn
61794>>>            //            find gt anprod by index.4
61794>>>            //            while ((found) and (anprod.entolh_recr=srecr) and;
61794>>>            //                  (witemxtd.witemx_code=anprod.anprod_form) and;
61794>>>            //                  (witemxtd.fpa_from=anprod.anprod_cartp) and;
61794>>>            //                  (witemxtd.texnikh=anprod.anprod_itemtn))
61794>>>            //                add 1 to icount
61794>>>            //                if (sperioxh<>anprod.anprod_itemtn) begin
61794>>>            //                    move 0 to ino
61794>>>            //                    move 0 to ikod
61794>>>            //                    move anprod.anprod_itemtn to sperioxh
61794>>>            //                    move 0 to tmpanal.recnum
61794>>>            //                    saverecord tmpanal
61794>>>            //                 end
61794>>>            //                add 1 to ifirst
61794>>>            //                add 1 to ino
61794>>>            //                if ((ino>1) and (ikod=0)) begin
61794>>>            //                    move 0 to tmpanal.recnum
61794>>>            //                    saverecord tmpanal
61794>>>            //                end
61794>>>            //                move anprod.anprod_itemtn to Tmpanal.prodiagrafh
61794>>>            //                clear iteml
61794>>>            //                move anprod.anprod_item to iteml.item_code
61794>>>            //                find eq iteml by index.5
61794>>>            //                clear wapokat
61794>>>            //                move iteml.wapokat_code to wapokat.wapokat_code
61794>>>            //                find eq wapokat by index.1
61794>>>            //                clear units
61794>>>            //                move iteml.units_code to units.units_code
61794>>>            //                find eq units by index.1
61794>>>            //                move 'B'                                to sitem
61794>>>            //                move wapokat.sap_descr                  to sti
61794>>>            //                insert sti in sitem at 2
61794>>>            //                insert 'O' in sitem at 3
61794>>>            //                insert anprod.anprod_item in sitem at 4
61794>>>            //                move sitem                              to Tmpanal.itemd
61794>>>            //                move units.units_descr                  to Tmpanal.mmitemd
61794>>>            //                move witemxtd.qty_from                  to Tmpanal.qty
61794>>>            //                move anprod.anprod_qty                  to tmpanal.posoths
61794>>>            //                move anprod.anprod_cartp                to Tmpanal.trmetaf
61794>>>            //                move ino                                to tmpanal.aa
61794>>>            //
61794>>>            ////               integer iok
61794>>>            ////               move 0 to iok
61794>>>            ////               clear tmpanala
61794>>>            ////               move witemxtr.hmnia to tmpanala.hmnia
61794>>>            ////
61794>>>            ////               move '09' to tmpanala.typos
61794>>>            ////               move segkatastash to tmpanala.egkatastash
61794>>>            ////               move witemxtd.witemx_code to tmpanala.item
61794>>>            ////               move anprod.anprod_cartp   to tmpanala.trmetaf
61794>>>            ////               move anprod.anprod_itemtn to Tmpanala.prodiagrafh
61794>>>            ////               find gt tmpanala by index.5
61794>>>            ////               while ((found) and (tmpanala.hmnia=witemxtr.hmnia)          and;
61794>>>            ////                                 (tmpanala.typos='09')                     and;
61794>>>            ////                                 (tmpanala.egkatastash=segkatastash)       and;
61794>>>            ////                                 (tmpanala.item=seidos)                    and;
61794>>>            ////                                 (tmpanala.trmetaf=anprod.anprod_cartp)    and;
61794>>>            ////                                 (anprod.anprod_itemtn=Tmpanala.prodiagrafh))
61794>>>            ////                   move 1 to iok
61794>>>            ////                   if (tmpanala.itemd=sitem) begin
61794>>>            ////                       add anprod.anprod_qty to tmpanal.posoths
61794>>>            ////                       sub 1 from ino
61794>>>            ////                       saverecord tmpanal
61794>>>            ////                   end
61794>>>            ////                   else begin
61794>>>            ////                       move anprod.entolh_recr                 to Tmpanal.product
61794>>>            ////                       saverecord Tmpanal
61794>>>            ////                   end
61794>>>            ////                   find gt tmpanal by index.5
61794>>>            ////               Loop
61794>>>            ////               if (iok=0) begin
61794>>>            ////                  move anprod.entolh_recr to Tmpanal.product
61794>>>            ////                  saverecord tmpanal
61794>>>            ////               end
61794>>>            //                move anprod.entolh_recr to Tmpanal.product
61794>>>            //                saverecord tmpanal
61794>>>            //                move (trim(anprod.anprod_item)) to sno
61794>>>            //                move itemd.recnum to imet
61794>>>            //                Set Label Of frmShow to ('†£œ¨ã© œª ‰˜«˜¤˜¢é©œ ª' + '-' + String(iMet)+'-'+String(sno))
61794>>>            //                find gt anprod by index.4
61794>>>            //            Loop
61794>>>            //            if (icount=0) begin
61794>>>            //                move 'ƒœ¤ ™¨âŸž¡˜¤ €¤˜¢é©œ ª ©«¦ „å›¦ª = ' to msgstr
61794>>>            //                append msgstr witemxtd.witemx_code
61794>>>            //                append msgstr ' ’. = '
61794>>>            //                APPEND msgstr witemxtd.texnikh
61794>>>            //                append msgstr ' “§¦¡˜« = '
61794>>>            //                append msgstr witemxtr.branch_code
61794>>>            //                error 3691 msgstr
61794>>>            //            End
61794>>>            //            find gt witemxtd by index.1
61794>>>            //        Loop
61794>>>            //        nextanaldd:
61794>>>            //        move (trim(anprod.anprod_item)) to sno
61794>>>            //        move anprod.recnum to imet
61794>>>            //        Set Label Of frmShow to ('†£œ¨ã© œª ‰˜«˜¤˜¢é©œ ª' + '-' + String(iMet)+'-'+String(sno))
61794>>>            //        find gt witemxtr by index.4
61794>>>            //     Loop
61794>>>            //     Send StartReport to Ranald
61794>>>            //     Send StartReport to Ranal90
61794>>>            //     Send StartReport to Ranal
61794>>>            //End_Procedure
61794>>>            
61794>>>            procedure check_the_records
61796>>>                number nfpa nfpatot
61797>>>                integer iint
61797>>>                move 0 to iint
61798>>>                clear tmppol
61799>>>                find gt tmppol by index.1
61800>>>>
61800>>>                while (found)
61804>>>                   if (tmppol.typos='01');                         move 0 to nfpa
61807>>>                   if (tmppol.typos='03');                        add tmppol.posofpa to nfpa
61810>>>                   if (tmppol.typos='05') begin
61812>>>                        move (abs(nfpa-tmppol.axia)) to nfpatot
61813>>>                        if (nfpatot > 1) move 1 to iint
61816>>>                   end
61816>>>>
61816>>>                   Set Label Of frmShow to ('„¢œš®¦ª à¢ã©œà¤' + '-' +String(Tmppol.arithmos))
61817>>>            
61817>>>                   find gt tmppol by index.1
61818>>>>
61818>>>                Loop
61819>>>>
61819>>>                if (iint=1) ;                   send info_box 'Ž‘Ž•† ˆ‡€ŒŽ ‘”€Š‹€ ‘’Ž €•„ˆŽ FI2. „Š„‚’„ ’Ž ”€ ‘’ˆ‘ „‰’“—‘„ˆ‘ —Š†‘„—Œ' 'Š†Ž”Žˆ€'
61822>>>            
61822>>>            end_procedure
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            
61823>>>            //AB-StoreEnd
61823>>>
61823>>>        End_Object    // btnMetasx
61824>>>
61824>>>        Object btnekt is a ButtonSub
61826>>>            Set Label to "ButtonSub1"
61827>>>            Set Bitmap to "printer.bmp"
61828>>>            Set Size to 21 24
61829>>>            Set Location to 183 11
61830>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
61831>>>
61831>>>            //AB-StoreStart
61831>>>            Set TooltipValue to "„¡«ç§à©ž ¡ ¤ã©œà¤ §¨¦ª „¢œš®¦ ! "
61832>>>            Procedure OnClick
61834>>>                date dapod
61835>>>                get value of frmapo to dapod
61836>>>                set pddate of rclsap to dapod
61837>>>                set piti of rclsap to (piepil(self))
61838>>>                Send runprom1Report to (prom1WQLReport(rclsap(Self)))
61839>>>            End_Procedure // OnClick
61840>>>            
61840>>>            
61840>>>            //AB-StoreEnd
61840>>>
61840>>>        End_Object    // btnekt
61841>>>
61841>>>        Object frmShow is a ButtonSub
61843>>>            Set Size to 14 267
61844>>>            Set Location to 146 57
61845>>>            Set Border_Style to Border_StaticEdge
61846>>>            Set Focus_Mode to Pointer_Only
61847>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
61848>>>
61848>>>            //AB-StoreStart
61848>>>            Procedure OnClick
61850>>>            
61850>>>            End_Procedure // OnClick
61851>>>            //AB-StoreEnd
61851>>>
61851>>>        End_Object    // frmShow
61852>>>
61852>>>        Object ButtonSub1 is a ButtonSub
61854>>>
61854>>>            //AB-StoreTopStart
61854>>>            
61854>>>            Property String psPath Public ''
61856>>>            
61856>>>            //AB-StoreTopEnd
61856>>>
61856>>>            Set Label to "ButtonSub1"
61857>>>            Set Bitmap to "AutoCopen.bmp"
61858>>>            Set Size to 21 24
61859>>>            Set Location to 173 354
61860>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
61861>>>
61861>>>            //AB-StoreStart
61861>>>            
61861>>>            Set TooltipValue to '„¥˜šàšã ©«¦ ˜¨®œå¦'
61862>>>            
61862>>>            
61862>>>            Function Verify_Ascii Integer aiFlag Returns Integer
61864>>>                Number  nPoso
61865>>>                Integer iDecs iLen iInt Imet iNum FileSize
61865>>>                Integer rVal iMhnas iEtos iHmera
61865>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
61865>>>                String sStr
61865>>>                Date    dapod deosd dhmnia
61865>>>                Move 0 to iNum
61866>>>            
61866>>>                Get value of frmapo item 0      to dapod
61867>>>                clear Company
61868>>>                move syscurxr.company_code      to Company.company_code
61869>>>                find eq company by index.1
61870>>>>
61870>>>                move Company.company_c_code0    to stomeas
61871>>>                Move (TheDaySegment  (dapod))    to iHmera
61872>>>                Move (TheMonthSegment(dapod))    to iMhnas
61873>>>                Move (TheYearSegment(dapod))     to ietos
61874>>>                Move iHmera                     to sHmera
61875>>>                Move iMhnas                     to sMhnas
61876>>>                Move iEtos                      to sEtos
61877>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
61881>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
61885>>>            
61885>>>                If aiFlag Eq 1 Begin
61887>>>                    Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas);                        +Trim(sHmera)+'.txt')   to sFileName
61888>>>                    File_Size tmpclsap          to FileSize
61891>>>                    Direct_Input Channel 9 sFileName
61893>>>                    Readln Channel 9 sStr
61895>>>                    While (Not(Seqeof))
61899>>>                        Add 1 to iNum
61900>>>                        Readln Channel 9 sStr
61902>>>                    Loop
61903>>>>
61903>>>                    Close_Input Channel 9
61905>>>                    Function_Return (iNum=FileSize)
61906>>>                End
61906>>>>
61906>>>                Else If aiFlag Eq 2 Begin
61909>>>                    Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas);                        +Trim(sHmera)+'.txt') to sFileName
61910>>>                    File_Size TmpPol          to FileSize
61913>>>                    Direct_Input Channel 9 sFileName
61915>>>                    Readln Channel 9 sStr
61917>>>                    While (Not(Seqeof))
61921>>>                        Add 1 to iNum
61922>>>                        Readln Channel 9 sStr
61924>>>                    Loop
61925>>>>
61925>>>                    Close_Input Channel 9
61927>>>                    Function_Return (iNum=FileSize)
61928>>>                End
61928>>>>
61928>>>                Else If aiFlag Eq 3 Begin
61931>>>                    Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas);                        +Trim(sHmera)+'.txt') to sFileName
61932>>>                    File_Size tmpAxio         to FileSize
61935>>>                    Direct_Input Channel 9 sFileName
61937>>>                    Readln Channel 9 sStr
61939>>>                    While (Not(Seqeof))
61943>>>                        Add 1 to iNum
61944>>>                        Readln Channel 9 sStr
61946>>>                    Loop
61947>>>>
61947>>>                    Close_Input Channel 9
61949>>>                    Function_Return (iNum=FileSize)
61950>>>                End
61950>>>>
61950>>>                Else If aiFlag Eq 4 Begin
61953>>>                    Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas);                        +Trim(sHmera)+'.txt') to sFileName
61954>>>                    File_Size Tmpapoth        to FileSize
61957>>>                    Direct_Input Channel 9 sFileName
61959>>>                    Readln Channel 9 sStr
61961>>>                    While (Not(Seqeof))
61965>>>                        Add 1 to iNum
61966>>>                        Readln Channel 9 sStr
61968>>>                    Loop
61969>>>>
61969>>>                    Close_Input Channel 9
61971>>>                    Function_Return (iNum=FileSize)
61972>>>                End
61972>>>>
61972>>>                Else If aiFlag Eq 5 Begin
61975>>>                    Move (psPath(Self)+Trim(stomeas)+'PP1'+Trim(sEtos)+Trim(sMhnas);                        +Trim(sHmera)+'.txt') to sFileName
61976>>>                    File_Size Tmptehn         to FileSize
61979>>>                    Direct_Input Channel 9 sFileName
61981>>>                    Readln Channel 9 sStr
61983>>>                    While (Not(Seqeof))
61987>>>                        Add 1 to iNum
61988>>>                        Readln Channel 9 sStr
61990>>>                    Loop
61991>>>>
61991>>>                    Close_Input Channel 9
61993>>>                    Function_Return (iNum=FileSize)
61994>>>                End
61994>>>>
61994>>>                Else If aiFlag Eq 6 Begin
61997>>>                    Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas);                        +Trim(sHmera)+'.txt') to sFileName
61998>>>                    File_Size TmpAnal         to FileSize
62001>>>                    Direct_Input Channel 9 sFileName
62003>>>                    Readln Channel 9 sStr
62005>>>                    While (Not(Seqeof))
62009>>>                        Add 1 to iNum
62010>>>                        Readln Channel 9 sStr
62012>>>                    Loop
62013>>>>
62013>>>                    Close_Input Channel 9
62015>>>                    Function_Return (iNum=FileSize)
62016>>>                End
62016>>>>
62016>>>                Function_Return 1
62017>>>            End_function
62018>>>            
62018>>>            
62018>>>            // Grapsimo ton records
62018>>>            // na arxeio xexoristo ana hmera
62018>>>            // me onoma xxxxzzzyyyymmhh opou xxxx=Branch.code zzz onoma arxeioy
62018>>>            // yyyymmhh etos-mhnas-mera eggrafon
62018>>>            Procedure Write_Record_Pel
62020>>>                Number  nPoso
62021>>>                Integer iDecs iLen iInt Imet Inum  isChecked
62021>>>                Integer rVal iMhnas iEtos iHmera
62021>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas  lsTheAppPath
62021>>>                String sstr scodem  skeno
62021>>>                Date    dapod deosd dhmnia
62021>>>                Get value of frmapo item 0 to dapod
62022>>>             //   Get value of frmeos item 0 to deosd
62022>>>            
62022>>>                Set Label Of frmShow to ''
62023>>>                clear Company
62024>>>                move syscurxr.company_code to Company.company_code
62025>>>                find eq company by index.1
62026>>>>
62026>>>                move Company.company_c_code0 to stomeas
62027>>>            
62027>>>            //    move syscurxr.branch_code       to sbranch
62027>>>                Move (TheDaySegment  (dapod))    to iHmera
62028>>>                Move (TheMonthSegment(dapod))    to iMhnas
62029>>>                Move (TheYearSegment(dapod))     to ietos
62030>>>                Move iHmera                     to sHmera
62031>>>                Move iMhnas                     to sMhnas
62032>>>                Move iEtos                      to sEtos
62033>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
62037>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
62041>>>            //    Move ('C:\'+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62041>>>                Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62042>>>                EraseFile sFileName
62043>>>>
62043>>>                Append_Output Channel 9 sFileName
62045>>>                clear tmpclsap
62046>>>                find gt tmpclsap.recnum
62047>>>>
62047>>>                while (found)
62051>>>                    Write   Channel 9 (Pad(Trim(tmpclsap.onoma)                ,  3))
62053>>>                    move tmpclsap.typos to sposo
62054>>>                    Write   Channel 9 (Pad(sposo                               ,  2))
62056>>>                    Write   Channel 9 (Pad(tmpclsap.etairia                    ,  4))
62058>>>                    Write   Channel 9 (Pad(tmpclsap.branch_site                ,  4))
62060>>>                    Write   Channel 9 (Pad(tmpclsap.type                       ,  1))
62062>>>                    Write   Channel 9 (Pad(tmpclsap.code                       , 10))
62064>>>                    move    tmpclsap.code to sid
62065>>>                    move syscurxr.company_code to scomp
62066>>>                    insert '.' in scomp at 3
62068>>>                    Write   Channel 9 (Pad(sstr                                , 10))
62070>>>                    Write   Channel 9 (Pad(tmpclsap.group                      ,  4))
62072>>>                    Write   Channel 9 (Pad(tmpclsap.endoomil                    , 6))
62074>>>                    Write   Channel 9 (Pad(tmpclsap.anal                        , 1))
62076>>>                    Write   Channel 9 (Pad(tmpclsap.category                    , 2))
62078>>>                    Write   Channel 9 (Pad(tmpclsap.afm                         ,11))
62080>>>                    Write   Channel 9 (Pad(ToAnsi(tmpclsap.name)                ,40))
62082>>>                    Write   Channel 9 (Pad(ToAnsi(tmpclsap.occup)               ,40))
62084>>>                    Write   Channel 9 (Pad(ToAnsi(tmpclsap.city)                ,40))
62086>>>                    Write   Channel 9 (Pad(ToAnsi(tmpclsap.address)             ,60))
62088>>>                    Move (trim(tmpclsap.add_no))            to sPoso
62089>>>                    Write   Channel 9 (Pad(ToAnsi(sPoso)                        ,03))
62091>>>                    Move (trim(tmpclsap.zipcode))            to sPoso
62092>>>                    if ((sposo='') and (tmpclsap.typos='01'));                        move '00000' to sposo
62095>>>                    Write   Channel 9 (Pad(sPoso                                ,10))
62097>>>                    Write   Channel 9 (Pad(ToAnsi(tmpclsap.doy)                 ,40))
62099>>>                    Move (trim(tmpclsap.telfax))            to sPoso
62100>>>                    Move (Trim(sPoso))                      to sPoso
62101>>>                    Move (Length(sPoso))                    to iLen
62102>>>                    For iInt From 1 to (14-iLen)
62108>>>>
62108>>>                        Move (Insert(" ", sPoso,1))         to sPoso
62109>>>                    Loop
62110>>>>
62110>>>                    Write   Channel 9 (Pad(ToAnsi(sPoso)                        ,14))
62112>>>                    Write   Channel 9 (Pad(tmpclsap.country                     , 2))
62114>>>                    Write   Channel 9 (Pad(tmpclsap.language                    , 2))
62116>>>            
62116>>>                    Move (GetTheAppPath(Self)) to lsTheAppPath
62117>>>                    if (sysfile.serial_number='1')begin
62119>>>                        IF (TMPCLSAP.TYPOS='90') BEGIN
62121>>>                            Write   Channel 9 (Pad(skeno      , 10))
62123>>>                        end
62123>>>>
62123>>>                        else begin
62124>>>                            Clear clients
62125>>>                            Move Tmpclsap.oldcode to scodem
62126>>>                            move (trim(scodem)) to scodem
62127>>>                            move scodem to clients.client_id
62128>>>                            find eq clients by index.6
62129>>>>
62129>>>                            if (found);                                  Write   Channel 9 (Pad(clients.client_codem      , 10))
62133>>>                            else;                                  Write   Channel 9 (Pad(skeno      , 10))
62136>>>                        End
62136>>>>
62136>>>                    End
62136>>>>
62136>>>            
62136>>>            
62136>>>                    Writeln Channel 9
62138>>>                    add 1 to imet
62139>>>                    Set Label Of frmShow to (String(iMet)+'-'+String(tmpclsap.code))
62140>>>                    find gt tmpclsap.recnum
62141>>>>
62141>>>                Loop
62142>>>>
62142>>>                Close_Output Channel 9
62144>>>            End_Procedure
62145>>>            
62145>>>            
62145>>>            // Grapsimo ton eisprakseon
62145>>>            Procedure Write_Record_Axio
62147>>>                Number  nPoso
62148>>>                Integer iDecs iLen iInt Imet ipos idiafora  isChecked
62148>>>                Integer rVal iMhnas iEtos iHmera
62148>>>                string sperioxh lsTheAppPath
62148>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
62148>>>                Date    dapod
62148>>>                get value of frmapo to dapod
62149>>>                clear Company
62150>>>                move syscurxr.company_code to Company.company_code
62151>>>                find eq company by index.1
62152>>>>
62152>>>                move Company.company_c_code0 to stomeas
62153>>>                Move (TheDaySegment  (dapod))  to iHmera
62154>>>                Move (TheMonthSegment(dapod))  to iMhnas
62155>>>                Move (TheYearSegment(dapod))   to ietos
62156>>>                Move iHmera                     to sHmera
62157>>>                Move iMhnas                     to sMhnas
62158>>>                Move iEtos                      to sEtos
62159>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
62163>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
62167>>>                Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62168>>>                EraseFile sFileName
62169>>>>
62169>>>                Append_Output Channel 8 sFileName
62171>>>                clear TmpAxio
62172>>>                find gt TmpAxio.recnum
62173>>>>
62173>>>                while (found)
62177>>>                    Write   Channel 8 (Pad(Trim(TmpAxio.onoma)                 ,  3))
62179>>>                    Write   Channel 8 (Pad(Trim(TmpAxio.typos)                 ,  2))
62181>>>                    Write   Channel 8 (Pad(tmpaxio.etairia                     ,  4))
62183>>>                    MOVE tmpaxio.typos to sposo
62184>>>                    if ((sposo='90') or (sposo='91') or (sposo='92') or (sposo='93') or (sposo='94')) begin
62186>>>                         move tmpaxio.egkatastash to sposo
62187>>>                       //  move stomeas to sposo
62187>>>                         Write   Channel 8 (Pad(trim(sposo)                    ,  4))
62189>>>                         move '' to sposo
62190>>>                         Write   Channel 8 (Pad(trim(sposo)                    ,  4))
62192>>>                    end
62192>>>>
62192>>>                    else begin
62193>>>                        move tmpaxio.perioxh to sposo
62194>>>                        Write   Channel 8 (Pad(trim(sposo)                     ,  4))
62196>>>                        move tmpaxio.egkatastash to sposo
62197>>>                        Write   Channel 8 (Pad(trim(sposo)                     ,  4))
62199>>>                    end
62199>>>>
62199>>>                    Write   Channel 8 (Pad(trim(tmpaxio.type)                  ,  4))
62201>>>            
62201>>>                    Move TmpAxio.arithmos                 to sPoso
62202>>>                    Move (Trim(sPoso))                    to sPoso
62203>>>                    Move (Length(sPoso))                  to iLen
62204>>>                    For iInt From 1 to (10-iLen)
62210>>>>
62210>>>                        Move (Insert(" ", sPoso,1))       to sPoso
62211>>>                    Loop
62212>>>>
62212>>>                    Write   Channel 8 (Pad(sposo                               , 10))
62214>>>                    Move Tmpaxio.Hmnia         to sHmnia
62215>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
62216>>>                    Write   Channel 8 (Pad(sHmnia                               , 8))
62218>>>                    Write   Channel 8 (Pad(tmpaxio.perigrafh                    , 1))
62220>>>                    Move (ROUnD_number(tmpaxio.axia,2))     to nPoso
62221>>>                    move nposo to sposo
62222>>>                    Move (Trim(sPoso))                      to sPoso
62223>>>                    Move (Pos('.',sPoso))   to iPos
62224>>>                    Move (Length(sPoso))    to iLen
62225>>>                    Move (iLen-iPos)       to iDiafora
62226>>>                    If (Pos('.',sPoso)=0) Append sPoso '.00'
62229>>>                    Else Begin
62230>>>                    // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
62230>>>                    If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
62233>>>                    End
62233>>>>
62233>>>                // 24/03/2004 allagh. Ta dekadika einai panta ta 2 teleytaia
62233>>>                // psifia ara h teleia feygei
62233>>>                    Move (Replace('.',sPoso,'')) to sPoso
62234>>>                    Move (Length(sPoso))                    to iLen
62235>>>                    For iInt From 1 to (16-iLen)
62241>>>>
62241>>>                        Move (Insert(" ", sPoso,1))         to sPoso
62242>>>                    Loop
62243>>>>
62243>>>            
62243>>>            
62243>>>                    Write   Channel 8 (Pad(sPoso                                ,16))
62245>>>                    Write   Channel 8 (Pad(tmpaxio.code                         ,10))
62247>>>                    Write   Channel 8 (Pad(ToAnsi(tmpaxio.aitiol)               ,50))
62249>>>                    Move Tmpaxio.lhxh     to sHmnia
62250>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
62251>>>                    Write   Channel 8 (Pad(sHmnia                               , 8))
62253>>>                    Write   Channel 8 (Pad(trim(tmpaxio.bank)                   ,15))
62255>>>                    move '' to sid
62256>>>                    Write   Channel 8 (Pad(sid                                  ,25))
62258>>>                    Write   Channel 8 (Pad(ToAnsi(tmpaxio.apodekths)            ,25))
62260>>>                    Write   Channel 8 (Pad(trim(tmpaxio.noepit)                 ,18))
62262>>>                    Write   Channel 8 (Pad(tmpaxio.xora                         , 2))
62264>>>                    Write   Channel 8 (Pad(tmpaxio.idioy                        , 1))
62266>>>                    Write   Channel 8 (Pad(tmpaxio.eparxia                      , 1))
62268>>>                    Write   Channel 8 (Pad(trim(tmpaxio.nomisma)                , 3))
62270>>>                    Write   Channel 8 (Pad(trim(tmpaxio.anal)                   , 2))
62272>>>            
62272>>>                    if (sysfile.serial_number='1') begin
62274>>>                        Move TmpAxio.pae_arithm           to sPoso
62275>>>                        Move (Trim(sPoso))                to sPoso
62276>>>                        Move (Length(sPoso))              to iLen
62277>>>                        For iInt From 1 to (10-iLen)
62283>>>>
62283>>>                            Move (Insert(" ", sPoso,1))       to sPoso
62284>>>                        Loop
62285>>>>
62285>>>            
62285>>>                        Write   Channel 8 (Pad(sposo                               , 10))
62287>>>                        Move Tmpaxio.pae_hmnia     to sHmnia
62288>>>                        Move (Replaces('/',sHmnia,''))  to sHmnia
62289>>>                        Write   Channel 8 (Pad(sHmnia                               , 8))
62291>>>            
62291>>>                    End
62291>>>>
62291>>>                    Writeln Channel 8
62293>>>                    add 1 to imet
62294>>>                    Set Label Of frmShow to (String(iMet)+'-'+String(tmpaxio.code))
62295>>>                    find gt Tmpaxio.recnum
62296>>>>
62296>>>                Loop
62297>>>>
62297>>>                Close_Output Channel 8
62299>>>            End_Procedure
62300>>>            
62300>>>            Procedure Write_record_polhseon
62302>>>                Number  nPoso
62303>>>                Integer iDecs iLen iInt Imet ipos idiafora
62303>>>                Integer rVal iMhnas iEtos iHmera
62303>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
62303>>>                string skeno senter stext sstr s1 s2 s3
62303>>>                Date    dapod
62303>>>                get value of frmapo to dapod
62304>>>                clear Company
62305>>>                move syscurxr.company_code to Company.company_code
62306>>>                find eq company by index.1
62307>>>>
62307>>>                move Company.company_c_code0 to stomeas
62308>>>                Move (TheDaySegment  (dapod))  to iHmera
62309>>>                Move (TheMonthSegment(dapod))  to iMhnas
62310>>>                Move (TheYearSegment(dapod))   to ietos
62311>>>                Move iHmera                   to sHmera
62312>>>                Move iMhnas                   to sMhnas
62313>>>                Move iEtos                    to sEtos
62314>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
62318>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
62322>>>                Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62323>>>                EraseFile sFileName
62324>>>>
62324>>>                Append_Output Channel 7 sFileName
62326>>>                clear TmpPol
62327>>>                find gt Tmppol by index.1
62328>>>>
62328>>>            
62328>>>                while (found)
62332>>>                    Write   Channel 7 (Pad(Trim(Tmppol.onoma)                 ,  3))
62334>>>                    Write   Channel 7 (Pad(Trim(Tmppol.typos)                 ,  2))
62336>>>                    Write   Channel 7 (Pad(tmppol.etairia                     ,  4))
62338>>>                    Write   Channel 7 (Pad(trim(tmppol.egkatastash)           ,  4))
62340>>>                    if (tmppol.type ='9999');                       Write   Channel 7 (Pad(trim(skeno)                     ,  4))
62344>>>                    else;                       Write   Channel 7 (Pad(trim(tmppol.perioxh)        ,  4))
62347>>>                    Write   Channel 7 (Pad(trim(tmppol.type)                  ,  4))
62349>>>                    Move 'C' to s1
62350>>>                    Move (Trim(String(TMPPOL.arithmos))) to s2
62351>>>                    Move (Trim(s1+s2)) to s3
62352>>>            
62352>>>                    Move S3                 to sPoso
62353>>>                    Move (Trim(sPoso))                   to sPoso
62354>>>                    Move (Length(sPoso))                 to iLen
62355>>>                    For iInt From 1 to (10-iLen)
62361>>>>
62361>>>                        Move (Insert(" ", sPoso,1))       to sPoso
62362>>>                    Loop
62363>>>>
62363>>>                    Write   Channel 7 (Pad(ToAnsi(sposo)                       , 10))
62365>>>            
62365>>>                    Move Tmppol.Hmnia         to sHmnia
62366>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
62367>>>                    Write   Channel 7 (Pad(sHmnia                               , 8))
62369>>>                    Write   Channel 7 (Pad(trim(tmppol.kodikos)                 , 5))
62371>>>            
62371>>>            
62371>>>                    //**************************************
62371>>>                    Move (ROUnD_number(tmppol.axia,2))     to nPoso
62372>>>                    move nposo to sposo
62373>>>                    Move (Trim(sPoso))                      to sPoso
62374>>>                    Move (Pos('.',sPoso))   to iPos
62375>>>                    Move (Length(sPoso))    to iLen
62376>>>                    Move (iLen-iPos)       to iDiafora
62377>>>                    If (Pos('.',sPoso)=0) Append sPoso '.00'
62380>>>                    Else Begin
62381>>>                    // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
62381>>>                    If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
62384>>>                    End
62384>>>>
62384>>>                // 24/03/2004 allagh. Ta dekadika einai panta ta 2 teleytaia
62384>>>                // psifia ara h teleia feygei
62384>>>                    Move (Replace('.',sPoso,'')) to sPoso
62385>>>                    Move (Length(sPoso))                    to iLen
62386>>>                    For iInt From 1 to (16-iLen)
62392>>>>
62392>>>                        Move (Insert(" ", sPoso,1))         to sPoso
62393>>>                    Loop
62394>>>>
62394>>>                    //**************************************
62394>>>                    if (tmppol.typos='06') move '' to sposo
62397>>>                    Write   Channel 7 (Pad(sPoso                                ,16))
62399>>>                    Write   Channel 7 (Pad(tmppol.code                          ,10))
62401>>>                    Write   Channel 7 (Pad(tmppol.kodikos2                      , 2))
62403>>>                    Write   Channel 7 (Pad(ToAnsi(tmppol.apoth)                 ,18))
62405>>>                    Move (Round_Number(tmppol.qty,3))   to nPoso
62406>>>                    MOVE nposo  TO SPOSO
62407>>>                    Move (Trim(sPoso))                    to sPoso
62408>>>                    Move (Pos('.',sPoso))   to iPos
62409>>>                    Move (Length(sPoso))    to iLen
62410>>>                    Move (iLen-iPos)     to iDiafora
62411>>>                    If (Pos('.',sPoso)=0) Append sPoso '.000'
62414>>>                    Else Begin
62415>>>                  // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
62415>>>                        If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
62418>>>                        else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
62422>>>                    End
62422>>>>
62422>>>                   Move (Replace('.',sPoso,'')) to sPoso
62423>>>                   Move (Replace('0',sPoso,'')) to sPoso
62424>>>                   Move (Length(sPoso))                   to iLen
62425>>>                   For iInt From 1 to (13-iLen)
62431>>>>
62431>>>                      Move (Insert(" ", sPoso,1))         to sPoso
62432>>>                   Loop
62433>>>>
62433>>>                    move '' to sposo
62434>>>                    Write   Channel 7 (Pad(sPoso                                ,13))
62436>>>                    Write   Channel 7 (Pad(trim(tmppol.mm)                      , 3))
62438>>>                    move '' to tmppol.kathgoria
62439>>>                    move '' to tmppol.antlhsh
62440>>>                    move '' to tmppol.pinakida
62441>>>                    move '' to tmppol.fpa
62442>>>            
62442>>>                    Write   Channel 7 (Pad(trim(tmppol.kathgoria)               , 1))
62444>>>                    Write   Channel 7 (Pad(trim(tmppol.antlhsh)                 , 1))
62446>>>                    Write   Channel 7 (Pad(ToAnsi(tmppol.pinakida)              ,12))
62448>>>                    Write   Channel 7 (Pad(trim(tmppol.oroi)                    , 4))
62450>>>                    Write   Channel 7 (Pad(trim(tmppol.fpa)                     , 2))
62452>>>                    Move (ROUnD_number(tmppol.posofpa,2))     to nPoso
62453>>>                    move nposo to sposo
62454>>>                    Move (Trim(sPoso))                      to sPoso
62455>>>                   Move (Pos('.',sPoso))   to iPos
62456>>>                   Move (Length(sPoso))    to iLen
62457>>>                   Move (iLen-iPos)       to iDiafora
62458>>>                   If (Pos('.',sPoso)=0) Append sPoso '.00'
62461>>>                   Else Begin
62462>>>                   // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
62462>>>                   If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
62465>>>                   End
62465>>>>
62465>>>                    Move (Replace('.',sPoso,'')) to sPoso
62466>>>                    Move (Replace('0',sPoso,'')) to sPoso
62467>>>                    Move (Length(sPoso))                    to iLen
62468>>>                    For iInt From 1 to (16-iLen)
62474>>>>
62474>>>                        Move (Insert(" ", sPoso,1))         to sPoso
62475>>>                    Loop
62476>>>>
62476>>>                    move '' to sposo
62477>>>                    Write   Channel 7 (Pad(sPoso                                ,16))
62479>>>                    Write   Channel 7 (Pad(trim(tmppol.nomisma)                 , 5))
62481>>>                    Write   Channel 7 (Pad(toansi(tmppol.deltia)                ,10))
62483>>>                    Move '' to sEnter
62484>>>                    move tmppol.sxolia to stext
62485>>>                    Append sEnter (Character(13)) (Character(10))
62487>>>                    Move (Replaces(sEnter,sText,' ')) to sText
62488>>>                    Move stext to sStr
62489>>>                    Append sStr ' '
62490>>>                    move (Length(sStr)) to iLen
62491>>>                    For iInt From 1 to iLen
62497>>>>
62497>>>                        If (iInt>50) Break
62500>>>                    Loop
62501>>>>
62501>>>            
62501>>>                    Write   Channel 7 (Pad(ToAnsi(sstr)                        ,50))
62503>>>                    Writeln Channel 7
62505>>>                    add 1 to imet
62506>>>                    Set Label Of frmShow to (String(iMet)+'-'+String(tmppol.code))
62507>>>                    find gt Tmppol by index.1
62508>>>>
62508>>>                Loop
62509>>>>
62509>>>                Close_Output Channel 7
62511>>>            
62511>>>            End_Procedure
62512>>>            
62512>>>            Procedure Write_Record_Apoth
62514>>>                Number  nPoso
62515>>>                Integer iDecs iLen iInt Imet idiafora ipos
62515>>>                Integer rVal iMhnas iEtos iHmera
62515>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
62515>>>                Date    dapod
62515>>>                get value of frmapo to dapod
62516>>>                clear Company
62517>>>                move syscurxr.company_code to Company.company_code
62518>>>                find eq company by index.1
62519>>>>
62519>>>                move Company.company_c_code0 to stomeas
62520>>>            
62520>>>                Move (TheDaySegment  (dapod))  to iHmera
62521>>>                Move (TheMonthSegment(dapod))  to iMhnas
62522>>>                Move (TheYearSegment(dapod))   to ietos
62523>>>                Move iHmera                     to sHmera
62524>>>                Move iMhnas                     to sMhnas
62525>>>                Move iEtos                      to sEtos
62526>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
62530>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
62534>>>                Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62535>>>                EraseFile sFileName
62536>>>>
62536>>>                Append_Output Channel 5 sFileName
62538>>>                clear Tmpapoth
62539>>>                find gt TmpApoth.recnum
62540>>>>
62540>>>                while (found)
62544>>>                    Write   Channel 5 (Pad(Trim(Tmpapoth.onoma)                ,  3))
62546>>>                    Write   Channel 5 (Pad(Trim(Tmpapoth.typos)                ,  2))
62548>>>                    if (Tmpapoth.typos='90');                        move stomeas to sposo
62551>>>                    else;                        move tmpapoth.egkatastash to sposo
62553>>>                    Write   Channel 5 (Pad(trim(sposo)                        ,  4))
62555>>>            
62555>>>                    Move TmpApoth.arithmos                to sPoso
62556>>>            
62556>>>                    Write   Channel 5 (Pad(ToAnsi(sposo)                      , 16))
62558>>>                    Move Tmpapoth.Hmnia         to sHmnia
62559>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
62560>>>                    Write   Channel 5 (Pad(sHmnia                               , 8))
62562>>>                    Write   Channel 5 (Pad(trim(tmpapoth.type)                  , 3))
62564>>>                    Write   Channel 5 (Pad(tmpapoth.code                        ,10))
62566>>>                    Write   Channel 5 (Pad(ToAnsi(tmpapoth.item)                ,18))
62568>>>                    Move (Round_Number(tmpapoth.qty,3))   to nPoso
62569>>>                    MOVE nposo  TO SPOSO
62570>>>                    Move (Trim(sPoso))                    to sPoso
62571>>>                    Move (Pos('.',sPoso))   to iPos
62572>>>                    Move (Length(sPoso))    to iLen
62573>>>                    Move (iLen-iPos)     to iDiafora
62574>>>                    If (Pos('.',sPoso)=0) Append sPoso '.000'
62577>>>                    Else Begin
62578>>>                    // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
62578>>>                        If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
62581>>>                        else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
62585>>>                    End
62585>>>>
62585>>>                    Move (Replace('.',sPoso,'')) to sPoso
62586>>>                    Move (Length(sPoso))                   to iLen
62587>>>                    For iInt From 1 to (13-iLen)
62593>>>>
62593>>>                       Move (Insert("0", sPoso,1))         to sPoso
62594>>>                    Loop
62595>>>>
62595>>>            
62595>>>                    Write   Channel 5 (Pad(sPoso                                ,13))
62597>>>                    Write   Channel 5 (Pad(trim(tmpapoth.monada)                ,03))
62599>>>                    Write   Channel 5 (Pad(trim(tmpapoth.paralabh)              ,04))
62601>>>                    move tmpapoth.pinakida to sposo
62602>>>                    if ((Tmpapoth.typos='90') or (tmpapoth.typos='91'));                        move '' to sposo
62605>>>                    Move (Replace(' ',sPoso,'')) to sPoso
62606>>>                    Write   Channel 5 (Pad(ToAnsi(sposo)                        ,10))
62608>>>                    Writeln Channel 5
62610>>>                    add 1 to imet
62611>>>                    Set Label Of frmShow to (String(iMet)+'-'+String(tmpapoth.code))
62612>>>                    find gt Tmpapoth.recnum
62613>>>>
62613>>>                Loop
62614>>>>
62614>>>                Close_Output Channel 5
62616>>>            End_Procedure
62617>>>            // grapsimo arxeioy texn.prodiagrafon
62617>>>            Procedure Write_Record_tehn
62619>>>                Number  nPoso
62620>>>                Integer iDecs iLen iInt Imet idiafora ipos
62620>>>                Integer rVal iMhnas iEtos iHmera
62620>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
62620>>>                Date    dapod
62620>>>                get value of frmapo to dapod
62621>>>                clear Company
62622>>>                move syscurxr.company_code to Company.company_code
62623>>>                find eq company by index.1
62624>>>>
62624>>>                move Company.company_c_code0 to stomeas
62625>>>            
62625>>>                Move (TheDaySegment  (dapod))  to iHmera
62626>>>                Move (TheMonthSegment(dapod))  to iMhnas
62627>>>                Move (TheYearSegment(dapod))   to ietos
62628>>>                Move iHmera                     to sHmera
62629>>>                Move iMhnas                     to sMhnas
62630>>>                Move iEtos                      to sEtos
62631>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
62635>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
62639>>>                Move (psPath(Self)+Trim(stomeas)+'PP1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62640>>>                EraseFile sFileName
62641>>>>
62641>>>                Append_Output Channel 5 sFileName
62643>>>                clear Tmptehn
62644>>>                find gt Tmptehn by index.3
62645>>>>
62645>>>                while (found)
62649>>>                    Write   Channel 5 (Pad(Trim(Tmptehn.onoma)                ,  3))
62651>>>                    Write   Channel 5 (Pad(Trim(Tmptehn.typos)                ,  2))
62653>>>                    if (tmptehn.typos='90') move stomeas to sposo
62656>>>                    else move  tmptehn.egkatastash to sposo
62658>>>                    Write   Channel 5 (Pad(trim(sposo)                        ,  4))
62660>>>                    Write   Channel 5 (Pad(ToAnsi(tmptehn.item)                ,18))
62662>>>                    Write   Channel 5 (Pad(trim(tmptehn.prodiagrafh)           ,12))
62664>>>                    Move tmptehn.type   to nPoso
62665>>>                    MOVE nposo  TO SPOSO
62666>>>                    Move (Trim(sPoso))                    to sPoso
62667>>>                    Move (Pos('.',sPoso))   to iPos
62668>>>                    Move (Length(sPoso))    to iLen
62669>>>                    Move (iLen-iPos)     to iDiafora
62670>>>                    If (Pos('.',sPoso)=0) Append sPoso '.000'
62673>>>                    Else Begin
62674>>>                    // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
62674>>>                        If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
62677>>>                        else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
62681>>>                    End
62681>>>>
62681>>>                    Move (Replace('.',sPoso,'')) to sPoso
62682>>>                    Move (Length(sPoso))                   to iLen
62683>>>                    For iInt From 1 to (13-iLen)
62689>>>>
62689>>>                       Move (Insert("0", sPoso,1))         to sPoso
62690>>>                    Loop
62691>>>>
62691>>>                    Write   Channel 5 (Pad(trim(sposo)                     ,13))
62693>>>                    Write   Channel 5 (Pad(trim(tmptehn.mm)                ,03))
62695>>>            
62695>>>                    move tmptehn.aa to sposo
62696>>>                    Move (Length(sPoso))                   to iLen
62697>>>                    For iInt From 1 to (4-iLen)
62703>>>>
62703>>>                       Move (Insert("0", sPoso,1))         to sPoso
62704>>>                    Loop
62705>>>>
62705>>>                    if (tmptehn.typos='90');                        move '' to sposo
62708>>>                    Write   Channel 5 (Pad(sPoso                            ,4))
62710>>>                    Write   Channel 5 (Pad(ToAnsi(tmptehn.itemd)            ,18))
62712>>>                    move tmptehn.qty to nposo
62713>>>                    MOVE nposo  TO SPOSO
62714>>>                    Move (Trim(sPoso))                    to sPoso
62715>>>                    Move (Pos('.',sPoso))   to iPos
62716>>>                    Move (Length(sPoso))    to iLen
62717>>>                    Move (iLen-iPos)     to iDiafora
62718>>>                    If (Pos('.',sPoso)=0) Append sPoso '.000'
62721>>>                    Else Begin
62722>>>                        If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
62725>>>                        else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
62729>>>                    End
62729>>>>
62729>>>                    Move (Replace('.',sPoso,'')) to sPoso
62730>>>                    Move (Length(sPoso))                   to iLen
62731>>>                    For iInt From 1 to (13-iLen)
62737>>>>
62737>>>                       Move (Insert("0", sPoso,1))         to sPoso
62738>>>                    Loop
62739>>>>
62739>>>                    if (tmptehn.typos='90');                        move '' to sposo
62742>>>                    Write   Channel 5 (Pad(trim(sposo)                     ,13))
62744>>>            
62744>>>                    Write   Channel 5 (Pad(trim(tmptehn.mmitemd)           ,03))
62746>>>                    if (tmptehn.typos='90') begin
62748>>>                        move '' to sposo
62749>>>                        Write   Channel 5 (Pad(sposo                       ,01))
62751>>>                    end
62751>>>>
62751>>>                    else;                        Write   Channel 5 (Pad(tmptehn.index               ,01))
62754>>>                    Writeln Channel 5
62756>>>                    add 1 to imet
62757>>>                    Set Label Of frmShow to (String(iMet)+'-'+String(tmptehn.recnum))
62758>>>                    find gt Tmptehn by index.3
62759>>>>
62759>>>                Loop
62760>>>>
62760>>>                Close_Output Channel 5
62762>>>            End_Procedure
62763>>>            
62763>>>            Procedure Write_Record_Anal
62765>>>                Number  nPoso
62766>>>                Integer iDecs iLen iInt Imet idiafora ipos
62766>>>                Integer rVal iMhnas iEtos iHmera
62766>>>                string s1 s2
62766>>>                String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
62766>>>                Date    dapod
62766>>>                get value of frmapo to dapod
62767>>>                clear Company
62768>>>                move syscurxr.company_code to Company.company_code
62769>>>                find eq company by index.1
62770>>>>
62770>>>                move Company.company_c_code0 to stomeas
62771>>>            
62771>>>                Move (TheDaySegment  (dapod))  to iHmera
62772>>>                Move (TheMonthSegment(dapod))  to iMhnas
62773>>>                Move (TheYearSegment(dapod))   to ietos
62774>>>                Move iHmera                     to sHmera
62775>>>                Move iMhnas                     to sMhnas
62776>>>                Move iEtos                      to sEtos
62777>>>                If (Length(sHmera)=1) Insert '0' in sHmera at 1
62781>>>                If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
62785>>>                Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
62786>>>                EraseFile sFileName
62787>>>>
62787>>>                Append_Output Channel 5 sFileName
62789>>>                clear TmpAnal
62790>>>                find gt TmpAnal by index.5
62791>>>>
62791>>>                while (found)
62795>>>                    Write   Channel 5 (Pad(Trim(TmpAnal.onoma)                ,  3))
62797>>>                    Write   Channel 5 (Pad(Trim(TmpAnal.typos)                ,  2))
62799>>>                    Move Tmpanal.Hmnia         to sHmnia
62800>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
62801>>>                    Write   Channel 5 (Pad(sHmnia                              , 8))
62803>>>                    move stomeas to sposo
62804>>>                    if (tmpanal.typos='92');                        Write   Channel 5 (Pad(trim(sposo)                    ,  4))
62808>>>                    else;                        Write   Channel 5 (Pad(trim(tmpAnal.egkatastash)      ,  4))
62811>>>                    Write   Channel 5 (Pad(ToAnsi(tmpANAL.item)                ,18))
62813>>>                    Write   Channel 5 (Pad(trim(tmpAnal.trmetaf)              ,  4))
62815>>>                    Write   Channel 5 (Pad(trim(tmpanal.prodiagrafh)           ,12))
62817>>>                    Move tmpanal.qty   to nPoso
62818>>>                    MOVE nposo  TO SPOSO
62819>>>                    Move (Trim(sPoso))                    to sPoso
62820>>>                    Move (Pos('.',sPoso))   to iPos
62821>>>                    Move (Length(sPoso))    to iLen
62822>>>                    Move (iLen-iPos)     to iDiafora
62823>>>                    If (Pos('.',sPoso)=0) Append sPoso '.000'
62826>>>                    Else Begin
62827>>>                    // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
62827>>>                        If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
62830>>>                        else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
62834>>>                    End
62834>>>>
62834>>>                    Move (Replace('.',sPoso,'')) to sPoso
62835>>>                    Move (Length(sPoso))                   to iLen
62836>>>                    For iInt From 1 to (13-iLen)
62842>>>>
62842>>>                       Move (Insert("0", sPoso,1))         to sPoso
62843>>>                    Loop
62844>>>>
62844>>>                    if (tmpanal.typos='91');                        move '' to sposo
62847>>>                    Write   Channel 5 (Pad(trim(sposo)                     ,13))
62849>>>                    Write   Channel 5 (Pad(trim(tmpanal.mm)                ,03))
62851>>>                    move tmpanal.aa to sposo
62852>>>                    Move (Length(sPoso))                   to iLen
62853>>>                    For iInt From 1 to (4-iLen)
62859>>>>
62859>>>                       Move (Insert("0", sPoso,1))         to sPoso
62860>>>                    Loop
62861>>>>
62861>>>                    if ((tmpanal.typos='90') or (tmpanal.typos='91') or (tmpanal.typos='92'));                        move '' to sposo
62864>>>                    Write   Channel 5 (Pad(sPoso                            ,4))
62866>>>                    Write   Channel 5 (Pad(ToAnsi(tmpanal.itemd)           ,18))
62868>>>                    move tmpanal.posoths to nposo
62869>>>                    MOVE nposo  TO SPOSO
62870>>>                    Move (Trim(sPoso))                    to sPoso
62871>>>                    Move (Pos('.',sPoso))   to iPos
62872>>>                    Move (Length(sPoso))    to iLen
62873>>>                    Move (iLen-iPos)     to iDiafora
62874>>>                    If (Pos('.',sPoso)=0) Append sPoso '.000'
62877>>>                    Else Begin
62878>>>                        If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
62881>>>                        else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
62885>>>                    End
62885>>>>
62885>>>                    Move (Replace('.',sPoso,'')) to sPoso
62886>>>                    Move (Length(sPoso))                   to iLen
62887>>>                    For iInt From 1 to (13-iLen)
62893>>>>
62893>>>                       Move (Insert("0", sPoso,1))         to sPoso
62894>>>                    Loop
62895>>>>
62895>>>                    if ((tmpanal.typos='90') or (tmpanal.typos='92'));                        move '' to sposo
62898>>>                    Write   Channel 5 (Pad(trim(tmpanal.mmitemd)           ,03))
62900>>>                    Write   Channel 5 (Pad(trim(sposo)                     ,13))
62902>>>                    move  tmpanal.product to sposo
62903>>>                    if (sposo<>'');                        insert '' in  sposo at 1
62907>>>                    Move (Replace('.',sPoso,'')) to sPoso
62908>>>                    left sposo to s1 3
62910>>>>
62910>>>                    right sposo to s2 12
62912>>>>
62912>>>                    move s1 to sposo
62913>>>                    append sposo s2
62914>>>                    Write   Channel 5 (Pad(toansi(sposo)                   ,16))
62916>>>                    move  tmpanal.product to sposo
62917>>>                    if (sposo<>'');                        insert '€' in  sposo at 1
62921>>>                    Move (Replace('.',sPoso,'')) to sPoso
62922>>>                    left sposo to s1 3
62924>>>>
62924>>>                    right sposo to s2 12
62926>>>>
62926>>>                    move s1 to sposo
62927>>>                    append sposo s2
62928>>>                    Write   Channel 5 (Pad(toansi(sposo)                   ,16))
62930>>>                    Writeln Channel 5
62932>>>                    add 1 to imet
62933>>>                    Set Label Of frmShow to (String(iMet)+'-'+String(tmpanal.recnum))
62934>>>                    find gt Tmpanal by index.5
62935>>>>
62935>>>                Loop
62936>>>>
62936>>>                Close_Output Channel 5
62938>>>            End_Procedure
62939>>>            
62939>>>            Procedure OnClick
62941>>>                String  sFile sBranch sText sBaxiokatRecr sFile2 sStr
62942>>>                String  sCompany sRec sLabel sPlace sPath
62942>>>                Date    dapod deosd
62942>>>                Integer iInt iCount iRec iMet iPos iPlaceCode retval isOK iOk
62942>>>                indicate err false
62943>>>                Get Value Of frmApo         Item 0 to dapod
62944>>>            //    Clear tmpSap
62944>>>            //    Move dapod to tmpSap.Date
62944>>>            //    Find Eq tmpSap By Index.1
62944>>>            //    If ((Found) And (tmpSap.Kleidomeno=1)) begin
62944>>>            //        send info_box '† †£/¤å˜ €¬«ã œå¤˜  ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
62944>>>            //        procedure_return
62944>>>            //    end
62944>>>            //    if (not(found)) begin
62944>>>            //       send info_box 'ƒœ¤ â®¦¬¤ «¨â¥œ  ¦  œ¤ž£œ¨é©œ ª €¨®œåà¤ † §˜¨¦¬© á©«ž¡œ ‘­á¢£˜!\n ’¨â¥«œ œ¤ž£œ¨é©œ ª €¨®œåà¤ H ƒ ¦¨Ÿé©«œ «¦ ‘­á¢£˜!!' '¢ž¨¦­¦¨å˜'
62944>>>            //       procedure_return
62944>>>            //    end
62944>>>            //    Move '' to sStr
62944>>>            //    Get fiSapOK Of vwSap dapod to iOK
62944>>>            //    If (iOK<>0) Begin
62944>>>            //        If (iOK=1)      Send Info_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '¢ž¨¦­¦¨å˜'
62944>>>            //        Else If (iOK=2) Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜¬«ã œå¤˜  ã›ž ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
62944>>>            //        Else If (iOK=3) Send Info_Box '¨¦¡ç§«œ  ¡œ¤æ ž£œ¨¦£ž¤ é¤.\n‰á§¦ ˜ §¨¦žš¦ç£œ¤ž ƒ„Œ â«¨œ¥œ' '¢ž¨¦­¦¨å˜'
62944>>>            //        Else If (iOK=4) Send Info_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜' '¢ž¨¦­¦¨å˜'
62944>>>            //        procedure_return
62944>>>            //    end
62944>>>                Get Value Of frmPath to sPath
62945>>>                Set psPath to (Trim(sPath)+'\')
62946>>>            
62946>>>            
62946>>>                Get YesNo_Box '€¨®åœ  ž œ¥˜šàšã „šš¨˜­é¤ !!\nŒ˜ ©¬¤œ®å©à ??' to RetVal
62947>>>                    If (dapod='') Begin
62949>>>                        Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜§¦ œå¤˜  ¡œ¤ã' '¢ž¨¦­¦¨å˜'
62950>>>                        Send Activate to frmApo
62951>>>                        Procedure_Return
62952>>>                    End
62952>>>>
62952>>>                indicate err false
62953>>>                If (RetVal =MBR_yes) begin
62955>>>                  begin_transaction
62956>>>                    Send Write_Record_Pel
62957>>>                    Get Verify_Ascii 1 to isOK
62958>>>                    If (Not(isOK)) Begin
62960>>>                        Error 6001 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
62961>>>>
62961>>>                    //    Procedure_Return
62961>>>                    End
62961>>>>
62961>>>            
62961>>>            
62961>>>                    Send Write_record_polhseon
62962>>>                    Get Verify_Ascii 2 to isOK
62963>>>                    If (Not(isOK)) Begin
62965>>>                        Error 6002 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI2. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
62966>>>>
62966>>>                    //    Procedure_Return
62966>>>                    End
62966>>>>
62966>>>            
62966>>>                    Send Write_record_axio
62967>>>                //    Get Verify_Ascii 3 to isOK
62967>>>                //    If (Not(isOK)) Begin
62967>>>                //        Error 6003 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI3. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
62967>>>                //    //    Procedure_Return
62967>>>                //    End
62967>>>            
62967>>>                    Send Write_record_apoth
62968>>>                    Get Verify_Ascii 4 to isOK
62969>>>                    If (Not(isOK)) Begin
62971>>>                        Error 6004 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ MM1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
62972>>>>
62972>>>                    //    Procedure_Return
62972>>>                    End
62972>>>>
62972>>>            
62972>>>                    Send Write_record_tehn
62973>>>                    Get Verify_Ascii 5 to isOK
62974>>>                    If (Not(isOK)) Begin
62976>>>                        Error 6005 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ PP1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
62977>>>>
62977>>>                    //    Procedure_Return
62977>>>                    End
62977>>>>
62977>>>            
62977>>>                    Send Write_record_Anal
62978>>>                    Get Verify_Ascii 6 to isOK
62979>>>                    If (Not(isOK)) Begin
62981>>>                        Error 6006 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ PP2. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
62982>>>>
62982>>>                    //    Procedure_Return
62982>>>                    End
62982>>>>
62982>>>            
62982>>>            
62982>>>            //      move 0 to iint
62982>>>            //      clear clients
62982>>>            //      find GT  clients by index.11
62982>>>            //      while ((found) and (clients.sap_hmnia =''))
62982>>>            //          move clients.recnum to irec
62982>>>            //          if (clients.status='') move '2' to clients.status
62982>>>            //          else if (clients.status='1') move '3' to clients.status
62982>>>            //          move dapod to clients.sap_hmnia
62982>>>            //          saverecord clients
62982>>>            //          move  '€¢¢˜šã Status œ¢˜«é¤' to sstr
62982>>>            //          Set Label Of frmShow to (sstr+'-'+CLIENTS.client_id)
62982>>>            //          clear clients
62982>>>            //          move irec to clients.recnum
62982>>>            //          find gt clients by index.11
62982>>>            //      Loop
62982>>>            //
62982>>>            //      // INDEX 16 ‹„ SAP-HMNIA
62982>>>            //      clear cmoves
62982>>>            //      find gt cmoves by 16
62982>>>            //      while ((found) and (cmoves.sap_hmnia =''))
62982>>>            //          if  (cmoves.cmoves_hmnia  > dapod);
62982>>>            //              goto nextreaddd
62982>>>            //
62982>>>            //           //œš¨¨˜­âª ¡¢œ ›é£˜«¦ª §¨â§œ  ¤˜ §¨¦©§œ¨¤ ¦ç¤«œ
62982>>>            //          if (cmoves.barticl_recr<>'') begin
62982>>>            //              clear barticl
62982>>>            //              move cmoves.barticl_recr to barticl.barticl_recr
62982>>>            //              find eq barticl by index.2
62982>>>            //              if (found) begin
62982>>>            //                  If (barticl.ekkremes=1) goto nextreaddd
62982>>>            //              end
62982>>>            //          End
62982>>>            //          move cmoves.recnum to irec
62982>>>            //          move dapod to cmoves.sap_hmnia
62982>>>            //          saverecord cmoves
62982>>>            //          move 1 to iint
62982>>>            //          nextreaddd:
62982>>>            //              Set Label Of frmShow to ('€¥ æš¨˜­˜' + '-' + String(cmoves.recnum)+'-'+String(cmoves.cmoves_hmnia))
62982>>>            //              if (iint=1) begin
62982>>>            //                 clear cmoves
62982>>>            //                 move irec to cmoves.recnum
62982>>>            //              end
62982>>>            //              find gt cmoves by 16
62982>>>            //              move 0 to iint
62982>>>            //      Loop
62982>>>            //      move 0 to iint
62982>>>            //      clear particle
62982>>>            //      find gt particle by 17
62982>>>            //      while ((found) and (particle.sap_hmnia =''))
62982>>>            //          if  (particle.partl_hmnia  > dapod) ;
62982>>>            //              goto nextpartldd
62982>>>            //          if (particle.partl_no < 1);
62982>>>            //              goto nextpartldd
62982>>>            //          move particle.recnum to irec
62982>>>            //      //    Reread Particle
62982>>>            //          move dapod to particle.sap_hmnia
62982>>>            //          saverecord particle
62982>>>            //      //    Unlock
62982>>>            //          move 1 to iint
62982>>>            //          nextpartldd:
62982>>>            //              Set Label Of frmShow to ('à¢ã©œ ª' + '-' + String(particle.recnum)+'-'+String(particle.partl_hmnia))
62982>>>            //              if (iint=1) begin
62982>>>            //                 clear particle
62982>>>            //                 move irec to particle.recnum
62982>>>            //              end
62982>>>            //              move 0 to iint
62982>>>            //              find gt particle by 17
62982>>>            //
62982>>>            //      Loop
62982>>>            //
62982>>>            //    move 0 to iint
62982>>>            //    clear wcmoves
62982>>>            //    find GT wcmoves by 16
62982>>>            //    while ((found) and (wcmoves.sap_hmnia =''))
62982>>>            //        if  (wcmoves.wcmove_hmnia  > dapod) ;
62982>>>            //            goto nextwmovesdd
62982>>>            //        move wcmoves.recnum to irec
62982>>>            //     //   Reread Wcmoves
62982>>>            //        move dapod to wcmoves.sap_hmnia
62982>>>            //        saverecord wcmoves
62982>>>            //     //   Unlock
62982>>>            //        move 1 to iint
62982>>>            //        nextwmovesdd:
62982>>>            //            Set Label Of frmShow to ('€§¦Ÿã¡ž' + '-' + String(wcmoves.recnum)+'-'+String(wcmoves.wcmove_hmnia))
62982>>>            //            if (iint=1) begin
62982>>>            //               clear wcmoves
62982>>>            //               move irec to wcmoves.recnum
62982>>>            //            end
62982>>>            //            move 0 to iint
62982>>>            //            find Gt wcmoves by 16
62982>>>            //    Loop
62982>>>            //
62982>>>            //    move 0 to iint
62982>>>            //    clear itemtehn
62982>>>            //    find GT itemtehn by index.4
62982>>>            //    while ((found) and (itemtehn.sap_hmnia =''))
62982>>>            //        if  (itemtehn.hmnia  > dapod) ;
62982>>>            //            goto nextitemdd
62982>>>            //        move itemtehn.recnum to irec
62982>>>            //    //    Reread ItemTehn
62982>>>            //        move dapod to itemtehn.sap_hmnia
62982>>>            //        saverecord itemtehn
62982>>>            //    //    Unlock
62982>>>            //        move 1 to iint
62982>>>            //        nextitemdd:
62982>>>            //            Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(itemtehn.recnum)+'-'+String(itemtehn.hmnia))
62982>>>            //            if (iint=1) begin
62982>>>            //               clear itemtehn
62982>>>            //               move irec to itemtehn.recnum
62982>>>            //            end
62982>>>            //            move 0 to iint
62982>>>            //            find Gt itemtehn by index.4
62982>>>            //    Loop
62982>>>            //
62982>>>            //    move 0 to iint
62982>>>            //    clear witemxtr
62982>>>            //    find GT witemxtr by index.4
62982>>>            //    while ((found) and (witemxtr.sap_hmnia =''))
62982>>>            //        if  (witemxtr.hmnia  > dapod) ;
62982>>>            //            goto nextwitemdd
62982>>>            //        move witemxtr.recnum to irec
62982>>>            //    //    Reread WitemxTr
62982>>>            //        move dapod to witemxtr.sap_hmnia
62982>>>            //        saverecord witemxtr
62982>>>            //   //     Unlock
62982>>>            //        move 1 to iint
62982>>>            //        nextwitemdd:
62982>>>            //            Set Label Of frmShow to ('ƒ ˜¡ ¤ã©œ ª' + '-' + String(witemxtr.recnum)+'-'+String(witemxtr.hmnia))
62982>>>            //            if (iint=1) begin
62982>>>            //               clear witemxtr
62982>>>            //               move irec to witemxtr.recnum
62982>>>            //            end
62982>>>            //            move 0 to iint
62982>>>            //            find Gt witemxtr by index.4
62982>>>            //    Loop
62982>>>            //
62982>>>            
62982>>>            //   clear tmpsap
62982>>>            //   move dapod to tmpsap.date
62982>>>            //   move 1 to tmpsap.kleidomeno
62982>>>            //   saverecord tmpsap
62982>>>            //   SEND IGNORE_ERROR TO ERROR_INFO_OBJECT 4358
62982>>>            //   Make_Directory "C:\PISBACKUPASCCI"
62982>>>            //   SEND TRAP_ERROR TO ERROR_INFO_OBJECT 4358
62982>>>            //   Copyfile (PSPATH(SELF)+'*.*') to  "C:\PISBACKUPASCCI"
62982>>>            
62982>>>               end_transaction
62983>>>               unlock
62984>>>>
62984>>>               if (not(err)) begin
62986>>>                  SEND IGNORE_ERROR TO ERROR_INFO_OBJECT 4358
62987>>>                  Make_Directory "C:\PISBACKUPASCCI"
62988>>>                  Copyfile (PSPATH(SELF)+'*.*') to  "C:\PISBACKUPASCCI"
62989>>>>
62989>>>                  SEND TRAP_ERROR TO ERROR_INFO_OBJECT 4358
62990>>>            
62990>>>                  Send Info_Box ('† œ¥˜šàšã ©«¦ ®œåà¤ ¦¢¦¡¢ž¨éŸž¡œ\n‡˜ ™¨œå«œ «˜ ˜¨®œå˜ ©«¦\n'+(psPath(Self))) '¢ž¨¦­¦¨å˜'
62991>>>               end
62991>>>>
62991>>>               else  begin
62992>>>                  erasefile (PSPATH(SELF)+'*.txt')
62993>>>>
62993>>>                  Send Info_Box '˜¨¦¬© á©«ž¡œ ¡á§¦ ¦ ¢áŸ¦ª ©«ž¤ „¥˜šàšã' '¢ž¨¦­¦¨å˜'
62994>>>               end
62994>>>>
62994>>>               set pddate of (saprep(self)) to dapod
62995>>>               set pspath of (saprep(self)) to (pspath(self))
62996>>>               //send ACTIVATE_saprep
62996>>>            
62996>>>              end
62996>>>>
62996>>>            
62996>>>            End_Procedure // OnClick
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            
62997>>>            //AB-StoreEnd
62997>>>
62997>>>        End_Object    // ButtonSub1
62998>>>
62998>>>        Object Textbox1 is a Textbox
63000>>>            Set Label to "†£/¤å˜ „šš¨˜­é¤ "
63001>>>            Set Location to 17 84
63002>>>            Set Size to 10 66
63003>>>            Set FontWeight to 800
63004>>>            Set TypeFace to "MS Sans Serif"
63005>>>        End_Object    // Textbox1
63006>>>
63006>>>        Object btnPartl is a ButtonSub
63008>>>
63008>>>            //AB-StoreTopStart
63008>>>                                                                
63008>>>            //AB-StoreTopEnd
63008>>>
63008>>>            Set Label to "ButtonSub1"
63009>>>            Set Bitmap to "Filesys3.bmp"
63010>>>            Set Size to 22 25
63011>>>            Set Location to 174 11
63012>>>            Set Focus_Mode to Pointer_Only
63013>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
63014>>>            Set Visible_State to FALSE
63015>>>
63015>>>            //AB-StoreStart
63015>>>            Set TooltipValue to "‹œ«˜­¦¨á ©«˜ ˜¨˜šé£œ¤˜ €¨®œå˜"
63016>>>            Procedure OnClick
63018>>>                 send activate_vwsap
63019>>>            End_Procedure // OnClick
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            
63020>>>            //AB-StoreEnd
63020>>>
63020>>>        End_Object    // btnPartl
63021>>>
63021>>>        Object frmPath is a FormSub
63023>>>
63023>>>            //AB-StoreTopStart
63023>>>                                                                
63023>>>            //AB-StoreTopEnd
63023>>>
63023>>>            Set Size to 13 223
63024>>>            Set Location to 212 95
63025>>>            Set Color to clBtnFace
63026>>>            Set Label_Col_Offset to 2
63027>>>            Set Prompt_Button_Mode to pb_PromptOn
63028>>>            Set Enabled_State to FALSE
63029>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
63030>>>            Set Item_Shadow_State Item 0 to TRUE
63031>>>            Set Shadow_State Item 0 to TRUE
63032>>>
63032>>>            //AB-StoreStart
63032>>>                                                                
63032>>>            Procedure Prompt
63034>>>                String sStr sStr2
63035>>>                Move (DPDlgShow(oDirectoryPicker(Self)))  to sStr
63036>>>                GET DPDlgPath Of (oDirectoryPicker(Self)) to sStr2  // Full Path
63037>>>                Move (Trim(sStr2)) to sStr2
63038>>>                Set Value Of frmPath Item 0 to (Uppercase(TOOEM(sStr2)))
63039>>>            End_Procedure
63040>>>            
63040>>>            
63040>>>            
63040>>>            
63040>>>            //AB-StoreEnd
63040>>>
63040>>>        End_Object    // frmPath
63041>>>
63041>>>        Object TextBoxSub1 is a TextBoxSub
63043>>>            Set Label to "Path SAP"
63044>>>            Set Location to 213 58
63045>>>            Set Size to 10 32
63046>>>            Set TypeFace to "MS Sans Serif"
63047>>>        End_Object    // TextBoxSub1
63048>>>
63048>>>
63048>>>        //AB-StoreStart
63048>>>        
63048>>>        Object oDirectoryPicker is a OLEDPDlg
63050>>>            Set Size            to 0 0
63051>>>            Set Location        to 0 0
63052>>>            Set Visible_State   to False
63053>>>            Procedure Activate
63055>>>                Forward Send Activate
63057>>>                Set Location    to 1 1
63058>>>                Set Size        to 190 190
63059>>>                SET DPDlgRoot   to 0
63060>>>            End_procedure
63061>>>        End_Object
63062>>>        
63062>>>        Procedure Activate_View Returns Integer
63064>>>            Integer rVal
63065>>>            date ddate
63065>>>            sysdate4 ddate
63066>>>            CLEAR company
63067>>>            move syscurxr.company_code to company.company_code
63068>>>            find eq company by index.1
63069>>>>
63069>>>            if (found);                set value of frmpath to company.sap_path
63072>>>            else;                set value of frmpath to ''
63074>>>            set value of frmapo to ddate
63075>>>            Forward Get Msg_Activate_View to rVal
63077>>>            Reread Sysfile
63081>>>            Unlock
63082>>>>
63082>>>            reread sysrecw
63086>>>            unlock
63087>>>>
63087>>>            Send Activate to oDirectoryPicker
63088>>>        End_Procedure
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        
63089>>>        //AB-StoreEnd
63089>>>
63089>>>    End_Object    // vsapdom
63090>>>
63090>>>
63090>>>    //AB-StoreStart
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>        
63090>>>    //AB-StoreEnd
63090>>>
63090>>>//AB/     End_Object    // prj
63090>
63090>        //AB-ClientStoreStart
63090>        
63090>        if (wait(self)) send deactivate to (wait(self))
63093>        
63093>        
63093>        
63093>        
63093>        
63093>        
63093>        
63093>        
63093>        //AB-ClientStoreEnd
63093>
63093>
63093>    End_Object  // Client_Area
63094>    
63094>    On_Key Key_Ctrl+Key_1 Send Activate_vsapdom To Client_Area
63095>    On_Key Key_Ctrl+Key_2 Send Activate_vwKleisimo To Client_Area
63096>    
63096>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
63096>>>// 07/23/96 JJT - New Class names
63096>>>// Very prototype global status bar
63096>>>//
63096>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
63096>>>>>// 07/23/96 JJT - New Class names
63096>>>>>Use dfAstbar.pkg
63096>>>>>
63096>>>>>Class StatusBar is a AppStatusBar
63097>>>>>
63097>>>>>    Procedure Construct_Object
63098>>>>>       Forward Send Construct_Object
63100>>>>>       //
63100>>>>>       Send Add_Item 350  ''     // micro-help
63101>>>>>       Send Add_Item  40  'View:'
63102>>>>>       Set Item_Display_Style To sbNORMAL
63103>>>>>       Send Add_Item 200  ''     // view name
63104>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
63105>>>>>       Set Item_Display_Style To sbNORMAL
63106>>>>>    End_Procedure // Construct_Object
63107>>>>>
63107>>>>>    Procedure Show_View_Name String sName
63108>>>>>        Set Value item 2 to sName
63109>>>>>    End_Procedure
63110>>>>>
63110>>>>>End_Class
63111>>>
63111>>>If (Wait(Self)) Send Deactivate to (Wait(Self))
63114>>>
63114>>>Object oStatusBarSub  is a StatusBar
63116>>>    Use DFTimer // DfTimer Manager Must Have a WindowHandle
63116>>>    
63116>>>    Property Integer piStdPanes Public (PaneCount(Self))
63118>>>    
63118>>>    //Set Value     Item 1 to (ToANSI("„§ ¢¦šã:"))
63118>>>    Set PaneWidth item 1 to 50
63119>>>    
63119>>>    Send AddPane 55  ""        sbLOWERED
63120>>>    Send AddPane 70  ""        sbLOWERED
63121>>>    Send AddPane 55  ""        sbLOWERED
63122>>>    
63122>>>    Procedure pTimer
63124>>>        String lsDay lsHour lsHH lsMM lsSS
63125>>>        Integer liStdPanes lbState
63125>>>    
63125>>>        Get piStdPanes to liStdPanes
63126>>>        Sysdate lsDay lsHH lsMM lsSS
63130>>>        If (Length(lsHH)=1) Insert "0" In lsHH At 1
63134>>>        If (Length(lsMM)=1) Insert "0" In lsMM At 1
63138>>>        If (Length(lsSS)=1) Insert "0" In lsSS At 1
63142>>>        Move (lsHH+":"+lsMM+":"+lsSS) to lsHour
63143>>>        Get Simple_state to lbState
63144>>>        If  Not (lbState) Begin
63146>>>            Set Value Item liStdPanes     to lsHour
63147>>>            Set Value Item (liStdPanes+1) to lsDay
63148>>>        End
63148>>>>
63148>>>    
63148>>>    End_Procedure // pTimer
63149>>>    
63149>>>    
63149>>>    Object oTimerObj Is A DFTimer
63151>>>        Set Timeout to 1000
63152>>>        Set Timer_Active_State to TRUE
63153>>>        Set Timer_Object to (oStatusBarSub(Current_Object))
63154>>>        Set Timer_Message to pTimer
63155>>>    End_Object // oTimerOdj
63156>>>End_Object // oStatusBar
63157>>>
63157>>>
63157>
63157>    //AB-PanelStoreStart
63157>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
63157>>>//************************************************************************
63157>>>// Confidential Trade Secret.
63157>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
63157>>>// as an unpublished work.  All rights reserved.
63157>>>// DataFlex is a registered trademark of Data Access Corporation.
63157>>>//
63157>>>//************************************************************************
63157>>>//************************************************************************
63157>>>//
63157>>>// $File name  : StdAbout.pkg
63157>>>// $File title : Standard about object package for VDF
63157>>>// Notice      :
63157>>>// $Author(s)  : John Tuohy
63157>>>//
63157>>>// $Rev History
63157>>>//
63157>>>// JT 06/27/97   File created
63157>>>//************************************************************************
63157>>>
63157>>>// This provides a quick and simple way to create an about package for a program.
63157>>>// You need to create a message inside you client area called Activate_About.
63157>>>// Within this message you should send the message DoAbout passing needed
63157>>>// string information.
63157>>>//
63157>>>//       Procedure Activate_About
63157>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
63157>>>//       End_Procedure
63157>>>//    where: sTitle =     Name of application. If none provided, uses caption
63157>>>//                        bar title
63157>>>//           sVersion   = Version Line. If none provided, will be blank
63157>>>//           sCopyRight = Copyright Line. If none provided, will be blank
63157>>>//           sAuthor    = Author name, blank if none provided
63157>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
63157>>>//                        is used.
63157>>>// It is expected that you will place this in your own object package. For
63157>>>// example an order about package may look like this:
63157>>>//
63157>>>//   // OrderAbout.pkg
63157>>>//   Use StdAbout.pkg
63157>>>//   Procedure Activate_About
63157>>>//      Local String sTitle sCopyright sVersion sAuthor
63157>>>//      Move "My Order Entry System" to sTitle
63157>>>//      Move "Version 2.1" to sVersion
63157>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
63157>>>//      Move "John Smith"  to sAuthor
63157>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
63157>>>//   end_procedure
63157>>>//   // end of file.
63157>>>
63157>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
63157>>>>>//************************************************************************
63157>>>>>// Confidential Trade Secret.
63157>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
63157>>>>>// as an unpublished work.  All rights reserved.
63157>>>>>// DataFlex is a registered trademark of Data Access Corporation.
63157>>>>>//
63157>>>>>//************************************************************************
63157>>>>>//************************************************************************
63157>>>>>//
63157>>>>>// $File name  : DfAbout.pkg
63157>>>>>// $File title : About class support
63157>>>>>// Notice      :
63157>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
63157>>>>>//
63157>>>>>// $Rev History
63157>>>>>//
63157>>>>>// JJT 11/5/98    Added version information
63157>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
63157>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
63157>>>>>//                workspace package.
63157>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
63157>>>>>//                class can create this object.
63157>>>>>//                Cleaned up the interface (used correct classes and messages)
63157>>>>>//                Added workspace reporting support to sys-info.
63157>>>>>//                Turned off wrapping in the sys-info editor.
63157>>>>>// KR  ??/??/96   File created
63157>>>>>//************************************************************************
63157>>>>>Use windows.pkg
63157>>>>>Use DFbitmap.pkg
63157>>>>>
63157>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
63158>>>>>
63158>>>>>//****************************************************************************
63158>>>>>// $Module type: FUNCTION
63158>>>>>// $Module name: Network_User_Name
63158>>>>>// $Author     : AK/VOO/KCR
63158>>>>>// Created     : 24-09-96 @ 19:17
63158>>>>>//
63158>>>>>// Description
63158>>>>>//    This function reads the current username of windows and returns that
63158>>>>>//    name or an text unknown user
63158>>>>>//
63158>>>>>// $Rev History
63158>>>>>//    24-09-96  Module header created
63158>>>>>//****************************************************************************
63158>>>>>Function Network_User_Name Returns String
63160>>>>>    Local String sName sLength
63161>>>>>    Local Pointer lpName_Addr lpLength_Addr
63161>>>>>    Local Integer iRetval
63161>>>>>
63161>>>>>    Movestr (Repeat (Character (0), 255)) To sName
63162>>>>>>
63162>>>>>    GetAddress Of sName To lpName_Addr
63163>>>>>    Movestr (DwordToBytes (255)) To sLength
63164>>>>>>
63164>>>>>    GetAddress Of sLength To lpLength_Addr
63165>>>>>
63165>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
63166>>>>>>
63166>>>>>
63166>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
63169>>>>>    Else Function_Return "User Unknown"
63171>>>>>End_Function // Network_User_Name
63172>>>>>
63172>>>>>Type MEMORYSTATUS
63172>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
63172>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
63172>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
63172>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
63172>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
63172>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
63172>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
63172>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
63172>>>>>End_Type // MEMORYSTATUS
63172>>>>>
63172>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
63173>>>>>
63173>>>>>// If a global workspace object exists it will use this variable to store
63173>>>>>// its object id.
63173>>>>>
63173>>>>>Class SysinfoDisplay Is An Edit
63174>>>>>    Procedure Construct_Object
63175>>>>>        forward send construct_object
63177>>>>>
63177>>>>>        Set Location To 6 6
63178>>>>>        Set Size To 110 255
63179>>>>>        Set Read_Only_State To True
63180>>>>>        Set wrap_state to False
63181>>>>>    end_Procedure
63182>>>>>
63182>>>>>    //****************************************************************************
63182>>>>>    // $Module type: PROCEDURE
63182>>>>>    // $Module name: Add_Line
63182>>>>>    // $Author     : VOO
63182>>>>>    // Created     : 06-10-96 @ 15:23
63182>>>>>    //
63182>>>>>    // Description
63182>>>>>    //    This method will add a line to this edit object, it should go simpler
63182>>>>>    //    but it seems to be done this way.
63182>>>>>    //
63182>>>>>    // $Rev History
63182>>>>>    //    06-10-96  Module header created
63182>>>>>    //****************************************************************************
63182>>>>>    Procedure Add_Line String sVal
63183>>>>>        Local Integer iLine
63184>>>>>
63184>>>>>        Moveint (Line_Count (Current_Object)) To iLine
63185>>>>>>
63185>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
63188>>>>>        Set Value Item iLine To sVal
63189>>>>>    End_Procedure // Add_Line
63190>>>>>
63190>>>>>    //****************************************************************************
63190>>>>>    // $Module type: PROCEDURE
63190>>>>>    // $Module name: Show_Current_Directory
63190>>>>>    // $Author     : VOO
63190>>>>>    // Created     : 06-10-96 @ 15:24
63190>>>>>    //
63190>>>>>    // Description
63190>>>>>    //    This method will show the name of the current directory in the system
63190>>>>>    //    information box
63190>>>>>    //
63190>>>>>    // $Rev History
63190>>>>>    //    06-10-96  Module header created
63190>>>>>    //****************************************************************************
63190>>>>>    Procedure Show_Current_Directory
63191>>>>>        Local String sDir
63192>>>>>
63192>>>>>        Get_Current_Directory To sDir
63193>>>>>        Send Add_Line ("Current Directory: " + sDir)
63194>>>>>    End_Procedure // Show_Current_Directory
63195>>>>>
63195>>>>>    Procedure Show_Windows_Directory
63196>>>>>        Local String sWindir
63197>>>>>
63197>>>>>        Get_Windows_Directory To sWindir
63198>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
63199>>>>>    End_Procedure // Show_Windows_Directory
63200>>>>>
63200>>>>>    Procedure Show_Current_User
63201>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
63202>>>>>    End_Procedure // Show_Current_User
63203>>>>>
63203>>>>>    Procedure Show_Number_Format
63204>>>>>        Local Integer iFormat
63205>>>>>
63205>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
63208>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
63209>>>>>        Get_Number_Format To iFormat
63210>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
63211>>>>>    End_Procedure // Show_Number_Format
63212>>>>>
63212>>>>>    Procedure Show_Filelist_Name
63213>>>>>        Local String sFilename
63214>>>>>
63214>>>>>        Get_Attribute Df_Filelist_Name To sFilename
63217>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
63218>>>>>    End_Procedure // Show_Filelist_Name
63219>>>>>
63219>>>>>    Procedure Show_Lock_Delay
63220>>>>>        Local Integer iLockdelay
63221>>>>>
63221>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
63224>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
63225>>>>>    End_Procedure // Show_Lock_Delay
63226>>>>>
63226>>>>>    Procedure Show_Lock_Timeout
63227>>>>>        Local Integer iLockTimeout
63228>>>>>
63228>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
63231>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
63232>>>>>    End_Procedure // Show_Lock_Timeout
63233>>>>>
63233>>>>>    Procedure Show_Screen_Size
63234>>>>>        Local Integer iYscreensize iXscreensize
63235>>>>>
63235>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
63236>>>>>>
63236>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
63237>>>>>>
63237>>>>>
63237>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
63238>>>>>    End_Procedure // Show_Screen_Size
63239>>>>>
63239>>>>>    Procedure Show_Page_Size
63240>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
63241>>>>>    End_procedure
63242>>>>>
63242>>>>>    Procedure Show_Date
63243>>>>>        Local Date dToday
63244>>>>>
63244>>>>>        Sysdate4 dToday
63245>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
63246>>>>>    End_procedure // Show_Date
63247>>>>>
63247>>>>>    Procedure Show_Date_Format
63248>>>>>        Local Integer iDateFormat
63249>>>>>        Local String sDateFormat
63249>>>>>
63249>>>>>        Get_Attribute Df_Date_Format To iDateFormat
63252>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
63255>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
63259>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
63263>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
63265>>>>>        Send Add_Line ("Date Format: " * sDateformat)
63266>>>>>    End_Procedure // Show_Date_Format
63267>>>>>
63267>>>>>    Procedure Show_Memavail
63268>>>>>        Local Integer iMem
63269>>>>>
63269>>>>>        Memory iMem
63270>>>>>>
63270>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
63271>>>>>    End_Procedure // Show_Memavail
63272>>>>>
63272>>>>>    Procedure Show_Systemresources
63273>>>>>        Local String sMemoryStatus
63274>>>>>        Local Pointer lpsMemoryStatus
63274>>>>>        Local Integer iVoid
63274>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
63274>>>>>
63274>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
63275>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
63276>>>>>
63276>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
63277>>>>>>
63277>>>>>
63277>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
63278>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
63279>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
63280>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
63281>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
63282>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
63283>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
63284>>>>>
63284>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
63285>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
63286>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
63287>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
63288>>>>>    End_Procedure // Show_Systemresources
63289>>>>>
63289>>>>>    Procedure Show_Registration
63290>>>>>        Local String sRegName
63291>>>>>        Local Integer iSN
63291>>>>>        Registration sRegName iSN
63292>>>>>>
63292>>>>>
63292>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
63293>>>>>        Send Add_Line ("Reg Name: " + sRegName)
63294>>>>>
63294>>>>>    End_Procedure // Show_Current_Directory
63295>>>>>
63295>>>>>
63295>>>>>
63295>>>>>    //****************************************************************************
63295>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
63295>>>>>    // to the workspace object passing the an object and message to send back
63295>>>>>    // to this object. It is expected that the workspace object will send this
63295>>>>>    // message for every line of information it wants displayed (passing the
63295>>>>>    // information to be displayed
63295>>>>>    //****************************************************************************
63295>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
63295>>>>>    Procedure Show_WorkspaceInformation
63296>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
63299>>>>>    End_Procedure
63300>>>>>
63300>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
63301>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
63302>>>>>    End_Function
63303>>>>>
63303>>>>>    Procedure Show_Versions
63304>>>>>        local integer iVersion iRevision iBuild
63305>>>>>        Version_information iVersion iRevision iBuild
63307>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
63308>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
63309>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
63310>>>>>    End_Procedure
63311>>>>>
63311>>>>>
63311>>>>>    //***
63311>>>>>    //*** BW
63311>>>>>    //*** Procedure: Show_Drivers
63311>>>>>    //*** Purpose  : Show loaed database drivers
63311>>>>>    //***
63311>>>>>
63311>>>>>    Procedure Show_Drivers
63312>>>>>        Local String  Current_drvr
63313>>>>>        Local String  Loadeddrvrs
63313>>>>>        Local Integer Number_of_drvrs
63313>>>>>        Local Integer Count
63313>>>>>
63313>>>>>        Move "" To Loadeddrvrs
63314>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
63317>>>>>        For Count From 1 To Number_of_drvrs
63323>>>>>>
63323>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
63326>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
63329>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
63330>>>>>        Loop
63331>>>>>>
63331>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
63332>>>>>    End_Procedure // Show_Drivers
63333>>>>>
63333>>>>>    //****************************************************************************
63333>>>>>    // $Module type: PROCEDURE
63333>>>>>    // $Module name: Add_Focus
63333>>>>>    // $Author     : VOO
63333>>>>>    // Created     : 24-09-96 @ 19:43
63333>>>>>    //
63333>>>>>    // Description
63333>>>>>    //    During activation we will remove the old information and add the newly
63333>>>>>    //    found systeminformation
63333>>>>>    //
63333>>>>>    // $Rev History
63333>>>>>    //    24-09-96  Module header created
63333>>>>>    //****************************************************************************
63333>>>>>    Procedure Add_Focus Integer hoRoot
63334>>>>>        Forward Send Add_Focus hoRoot
63336>>>>>
63336>>>>>        Send Delete_Data
63337>>>>>        Set Changed_State To False
63338>>>>>        Set Read_Only_State To True
63339>>>>>        Send Show_WorkSpaceInformation // added to show WS info
63340>>>>>        SEnd Show_Drivers
63341>>>>>        Send Show_Current_User
63342>>>>>        Send Show_Windows_Directory
63343>>>>>        Send Show_Current_Directory
63344>>>>>        Send Show_Filelist_Name
63345>>>>>        Send Show_Versions
63346>>>>>        Send Show_Memavail
63347>>>>>        Send Show_Screen_Size
63348>>>>>        Send Show_Page_Size
63349>>>>>        Send Show_Number_Format
63350>>>>>        Send Show_Date_Format
63351>>>>>        Send Show_Lock_Delay
63352>>>>>        Send Show_Lock_Timeout
63353>>>>>        Send Show_Date
63354>>>>>        Send Show_Systemresources
63355>>>>>        Send Show_Registration
63356>>>>>    End_Procedure // Show_All_Info
63357>>>>>
63357>>>>>End_Class // SysinfoDisplay
63358>>>>>
63358>>>>>
63358>>>>>//****************************************************************************
63358>>>>>// $Module type: OBJECT
63358>>>>>// $Module name: Sysinfo_Dialog
63358>>>>>// $Author     : VOO
63358>>>>>// Created     : 24-09-96 @ 18:47
63358>>>>>//
63358>>>>>// Description
63358>>>>>//    This object shows the systeminformation on the screen
63358>>>>>//
63358>>>>>// $Rev History
63358>>>>>//    24-09-96  Module header created
63358>>>>>//****************************************************************************
63358>>>>>Class SysInfoDialog Is A ModalPanel
63359>>>>>    Procedure Construct_Object
63360>>>>>        forward send construct_object
63362>>>>>
63362>>>>>        Set Caption_Bar To True
63363>>>>>        Set Sysmenu_Icon To True
63364>>>>>        Set Label To "System Information"
63365>>>>>        Set Size To 152 270
63366>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
63367>>>>>        Set Minimize_Icon To False
63368>>>>>        Set Maximize_Icon To False
63369>>>>>        Set Border_Style To Border_Dialog
63370>>>>>
63370>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
63372>>>>>        End_Object
63373>>>>>
63373>>>>>        Object Close_Button Is A Button
63375>>>>>            Set Label to "&Close"
63376>>>>>            Set Location To 120 212
63377>>>>>            Set Message item 0 to msg_Close_Panel
63378>>>>>            Set default_action_button to current_object
63379>>>>>        End_Object // Close_Button
63380>>>>>
63380>>>>>        On_Key Kcancel       Send Close_Panel
63381>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
63382>>>>>    End_procedure
63383>>>>>
63383>>>>>End_Class // SysinfoDialog
63384>>>>>
63384>>>>>// Purpose:
63384>>>>>//
63384>>>>>// Ken Ross 12/17/96 5:16PM
63384>>>>>//
63384>>>>>Class AboutDialog Is A ModalPanel
63385>>>>>
63385>>>>>    Procedure construct_object
63386>>>>>        String sVdfRootDir
63387>>>>>        forward send construct_object
63389>>>>>        Set Label to "About..."
63390>>>>>        Set Size to 100 217
63391>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
63392>>>>>
63392>>>>>        Object SysInfo_Dialog is a SysInfoDialog
63394>>>>>        End_Object
63395>>>>>
63395>>>>>        Object oBox is a Container3d
63397>>>>>            Set Border_Style to Border_StaticEdge
63398>>>>>            Set Size to 63 202
63399>>>>>            Set Location to 4 5
63400>>>>>
63400>>>>>            Object AboutGraphic is a BitmapContainer
63402>>>>>                Set Border_Style to Border_None
63403>>>>>                Set Bitmap_Style to Bitmap_Center
63404>>>>>                Set Size to 48 48
63405>>>>>                Set Location to 7 2
63406>>>>>            End_Object    // AboutGraphic
63407>>>>>
63407>>>>>            Object ProductName is a TextBox
63409>>>>>                Set label to "ProductName"
63410>>>>>                Set Size to 10 45
63411>>>>>                Set Location to 8 53
63412>>>>>            End_Object    // ProductName
63413>>>>>
63413>>>>>            Object Version is a TextBox
63415>>>>>                Set label to "Version"
63416>>>>>                Set Size to 10 25
63417>>>>>                Set Location to 21 53
63418>>>>>            End_Object    // Version
63419>>>>>
63419>>>>>            Object Copyright is a TextBox
63421>>>>>                Set label to "Copyright"
63422>>>>>                Set Size to 10 31
63423>>>>>                Set Location to 34 53
63424>>>>>            End_Object    // Copyright
63425>>>>>
63425>>>>>            Object Author is a TextBox
63427>>>>>                Set label to "Author"
63428>>>>>                Set Size to 10 22
63429>>>>>                Set Location to 46 53
63430>>>>>            End_Object    // Author
63431>>>>>
63431>>>>>        End_Object    // oBox
63432>>>>>
63432>>>>>        Object OK_bn is a Button
63434>>>>>            On_Item "&OK" Send Close_Panel
63435>>>>>            Set Size to 14 50
63436>>>>>            Set Location to 71 157
63437>>>>>        End_Object    // OK_bn
63438>>>>>
63438>>>>>        Object SysInfo_bn is a Button
63440>>>>>            On_Item "&System Info" Send Show_Sysinfo
63441>>>>>            Set Size to 14 50
63442>>>>>            Set Location to 71 101
63443>>>>>        End_Object    // SysInfo_bn
63444>>>>>
63444>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
63445>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
63446>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
63447>>>>>
63447>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
63450>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
63451>>>>>
63451>>>>>    End_Procedure
63452>>>>>
63452>>>>>    Procedure set productname string sval
63453>>>>>        set label of (productname(oBox(current_object))) to sval
63454>>>>>    End_Procedure
63455>>>>>
63455>>>>>    Procedure set version string sval
63456>>>>>        set label of (version(oBox(current_object))) to sval
63457>>>>>    End_Procedure
63458>>>>>
63458>>>>>    Procedure set copyright string sval
63459>>>>>        set label of (copyright(oBox(current_object))) to sval
63460>>>>>    End_Procedure
63461>>>>>
63461>>>>>    Procedure set author string sval
63462>>>>>        set label of (author(oBox(current_object))) to sval
63463>>>>>    End_Procedure
63464>>>>>
63464>>>>>    // square bitmaps of 42x42 work best
63464>>>>>    //
63464>>>>>    Procedure set logo string sval
63465>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
63466>>>>>    End_Procedure
63467>>>>>
63467>>>>>    Procedure Show_Sysinfo
63468>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
63469>>>>>    End_Procedure // Show_Sysinfo
63470>>>>>
63470>>>>>End_Class
63471>>>>>
63471>>>>>
63471>>>>>//Object About_Dialog is an AboutDialog
63471>>>>>//    set productname to "Visual DataFlex"
63471>>>>>//    set version to "version 4.0"
63471>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
63471>>>>>//    set author to ""
63471>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
63471>>>>>//End_Object
63471>>>>>
63471>>>>>//Procedure Activate_About
63471>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
63471>>>>>//End_Procedure
63471>>>
63471>>>// *************************************************************************
63471>>>//  Public message. This is the default message. It is expected that you will
63471>>>//   create your own message to override this
63471>>>// *************************************************************************
63471>>>
63471>>>Procedure Activate_About
63473>>>   Send DoAbout "" "" "" "" "" ""
63474>>>End_Procedure
63475>>>
63475>>>// *************************************************************************
63475>>>//  Public message. It is expected that you will send this message (most
63475>>>//  likely from Activate_About. This creates an about object, activates it
63475>>>//  and destroys it when done. It is not exepected that you will augment this.
63475>>>// *************************************************************************
63475>>>
63475>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
63477>>>        Local integer hoObj hoMain
63478>>>
63478>>>        // create object
63478>>>        Object About is an AboutDialog
63480>>>            // if no title passed use the label of the main panel
63480>>>            // (if a main panel exists).
63480>>>            if sTitle     eq '' Begin
63482>>>                Get Main_Window to hoMain
63483>>>                if hoMain Get Label of hoMain to sTitle
63486>>>            end
63486>>>>
63486>>>            set productname to sTitle
63487>>>            set version     to sVersion
63488>>>            set copyright   to sCopyRight
63489>>>            set author      to sAuthor
63490>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
63493>>>            Move Current_Object to hoObj // object Id
63494>>>        End_Object
63495>>>        Send Popup to hoObj    // popup the about object
63496>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
63497>>>End_procedure
63498>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
63498>>>Use Tooltip.pkg
63498>>>
63498>>>object StandardToolTip is a StandardToolTip000
63500>>>    move (current_object) to DefaultTooltipHintID
63501>>>end_object
63502>>>
63502>>>object ToolTipTimer is a ToolTipTimer000
63504>>>    move (current_object) to TooltipControllerID
63505>>>end_object
63506>    
63506>    
63506>    
63506>    
63506>    //AB-PanelStoreEnd
63506>
63506>
63506>End_Object
63507>
63507>
63507>//AB-StoreStart
63507>set bitmap of (client_area(main(self))) to "protem1.bmp"
63508>
63508>Send DoStoreFileModeInfo to ghoFileModeInfo
63509>
63509>
63509>Start_UI
63510>
63510>
63510>//AB-StoreEnd
63510>
63510>
Summary
Memory Available: 2147483647
Total Errors   : 0
Total Symbols  : 30905
Total Resources: 0
Total Commands : 63509
Total Windows  : 14
Total Pages    : 5
Static Data    : 453996
Message area   : 339772
Total Blocks   : 20209
