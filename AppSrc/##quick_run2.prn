Compiling Program: L:\Vdf6\Develop\Empor\AppSrc\##quick_run2.src
Memory Available: 2147483647
1>Use AllEntSc
Using pre-compiled package ALLENTSC
INCLUDING FILE: ALLENTSC.PKI
30333>
30333>Register_Object Client_Area
30333>
30333>//AB-StoreTopStart
30333>Use Workspc.pkg
30333>
30333>//  Set date attributes as needed
30333>Set_Date_Attribute sysdate4_State to (TRUE)
30334>Set_Date_Attribute Date4_State    to (TRUE)
30335>Set_Date_Attribute epoch_value    to 30
30336>
30336>Object ProgramWorkspace is a WorkspaceSub
30338>    Set WorkspaceName to CURRENT$WORKSPACE
30339>    Set kEnter_Next_State to True
30340>//    Set ModuleName    to 'ProgramName' // Special module name.
30340>//    Set HelpName      to 'HelpName.hlp'// Please provide the name of your Windows help file.
30340>End_Object
30341>
30341>Use Help_Ids.inc // Developer should provide this file of help context links.
INCLUDING FILE: HELP_IDS.INC
30341>>>// Help_ids.inc
30341>>>//
30341>>>// Context ids for the order entry system. This uses
30341>>>// help file ordentry.hlp.
30341>>>//
30341>>>// This is a sample version. YOU must supply
30341>>>// the ID values
30341>>>
30341>>>//  Generic Context Ids
30341>>>//
30341>>>
30341>>>// It is expected that file-names ids will be the same as their
30341>>>// filenumber.
30341>>>
30341>>>
30341>>>//  View and selection-list specific context ids
30341>>>//
30341>>>//..........add view, object, selection-list ids here....
30341>Use Std_Help.pkg
INCLUDING FILE: STD_HELP.PKG
30341>>>// STD_HELP.PKG
30341>>>//
30341>>>// Global Help Object
30341>>>//
30341>>>//  Creates all Help Support required to access WINDOWs help system
30341>>>//  with DataFlex. Creates a global object named Help_Object.
30341>>>//
30341>>>//  9/19/97 JJT - Modified to define stadnard help Ids if they are undefined
30341>>>
30341>>>use DFHlpSys // Context Sensitive Help Support
30341>>>
30341>>>
30341>>>// This file needs to be provided by the developer. It will contain
30341>>>// symbolic replacements for the ID integer values used to access the
30341>>>// the windows help file's topics.
30341>>>//
30341>>>use Help_ids.inc
30341>>>
30341>>>// If the following are not defined in help_ids.inc,
30341>>>//  create default 0 values for them
30341>>>Define GeneralHelpId    for    0
30341>>>Define KeysHelpId       for    0
30341>>>Define FileHelpId       for    0
30341>>>Define ErrorHelpId      for    0  // probably not used in VDF
30341>>>Define IndexHelpId      for    0  // probably not used in VDF
30341>>>
30341>>>object Help_Object is a HelpSystem // global help object
30343>>>
30343>>>   Set Help_Id_General to GeneralHelpId    // these should all be defined
30344>>>   Set Help_Id_Index   to IndexHelpId      // in help_ids.inc.
30345>>>   Set Help_Id_Keys    to KeysHelpId       //
30346>>>   Set Help_Id_Files   to FileHelpId       //
30347>>>   Set Help_Id_Errors  to ErrorHelpId      //
30348>>>
30348>>>end_object
30349>
30349>
30349>Integer giWait_Obj
30349>string sXrhs sKodi sDeCryptoPassw
30349>String gsMyStr
30349>//-----
30349>
30349>Open Sysrec
INCLUDING FILE: SYSREC.FD
30351>Open Users
INCLUDING FILE: USERS.FD
30353>
30353>
30353>// General Functions-Procedures and Variables
30353>Use Globals.Inc
INCLUDING FILE: GLOBALS.INC
30353>>>
30353>>>        String  gs_Selected_Company_Code
30353>>>        String  gs_Selected_Branch_Code
30353>>>        Integer gi_Selected_Year
30353>>>        String gs_Selected_Year_Recr
30353>>>        String  gs_Module_Code
30353>>>
30353>>>
30353>>>//Open Currency
30353>>>//Function CurrDigits Global String asCurr Returns Integer
30353>>>//    Integer liDecX
30353>>>//    Clear Currency
30353>>>//    move asCurr to Currency.Currency_C_Code
30353>>>//    Find Eq Currency By Index.1
30353>>>//    move Currency.Currency_Dec to liDecX
30353>>>//    Function_Return liDecX
30353>>>//End_Function // CurrDigits
30353>>>
30353>>>Open Nomisma
INCLUDING FILE: NOMISMA.FD
30355>>>Open SysCurXr
INCLUDING FILE: SYSCURXR.FD
30357>>>
30357>>>Function fiDekadika_Nomismatos Global String asNomisma Returns Integer
30358>>>    Move (Trim(asNomisma)) to asNomisma
30359>>>    Clear Nomisma
30360>>>    If ( asNomisma<>'' ) Move asNomisma         to Nomisma.Nomisma_Code
30363>>>    Else                 Move SysCurXr.C_Code0  to Nomisma.Nomisma_Code
30365>>>    Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
30366>>>>
30366>>>    Function_Return Nomisma.Dekadika
30367>>>End_Function //
30368>>>
30368>>>Function fsgCode_W_Zeroes Global Integer aiCode Integer aiPlaces Returns String
30369>>>    String rVal
30370>>>    Integer iLength iInt
30370>>>    Move aiCode to rVal
30371>>>    Move (trim(rVal)) to rVal
30372>>>    For iInt From 1 to (aiPlaces-(Length(rVal)))
30378>>>>
30378>>>        Move (Insert('0',rVal,1)) to rVal
30379>>>    Loop
30380>>>>
30380>>>    Function_Return rVal
30381>>>End_Function
30382>>>
30382>>>Function fsgCode_n_Zeroes Global number aiCode Integer aiPlaces Returns String
30383>>>    String rVal
30384>>>    Integer iLength iInt ipos
30384>>>    Move aiCode to rVal
30385>>>    Move (trim(rVal)) to rVal
30386>>>    MOVE (aiPlaces-(Length(rVal))) to ipos
30387>>>    For iInt From 1 to ipos
30393>>>>
30393>>>        Move (Insert('0',rVal,1)) to rVal
30394>>>    Loop
30395>>>>
30395>>>    Function_Return rVal
30396>>>End_Function
30397>>>
30397>>>
30397>>>Open Year
INCLUDING FILE: YEAR.FD
30399>>>Procedure EnumDDsForRebuildConstrain for DataDictionary integer aiMsg integer ahId
30400>>>    Send aiMsg to Self
30401>>>End_Procedure
30402>>>
30402>>>Procedure DoRefindYear for baseclass Integer aiPanel Integer aiYearDD
30403>>>    Integer liChanged
30404>>>
30404>>>    If ((aiYearDD = 0) or (Main_File(aiYearDD)<>Year.File_Number)) ;        Procedure_Return (Message_Box("Invalid Year_DD","Developer's Warning",MB_OK,MB_ICONWARNING))
30407>>>    If (Not(Current_Record(aiYearDD))) Begin
30409>>>        Get Should_Save of aiPanel to liChanged
30410>>>        Send Clear to aiYearDD
30411>>>        Move gs_Selected_Company_Code to Year.Company_Code
30412>>>        Move gs_Selected_Branch_Code  to Year.Branch_Code
30413>>>        Move gi_Selected_Year         to Year.Year_Year
30414>>>        Send Find to aiYearDD Eq 1 //Year.Index.1 - company_code+ranch_code+year_year
30415>>>        If (Not(liChanged)) Set Changed_State of aiPanel to False
30418>>>    End
30418>>>>
30418>>>End_Procedure
30419>>>
30419>>>Procedure RebuildConstrainIfYearChanged for baseclass Integer aiPanel String asCurrentYearRecr Integer aiYearDDId
30420>>>    Integer liSrvr
30421>>>    String  lsCurrentYearRecr
30421>>>
30421>>>    If (asCurrentYearRecr <> gs_Selected_Year_Recr) Begin
30423>>>        Broadcast Send EnumDDsForRebuildConstrain to aiPanel msg_Rebuild_Constraints Self
30425>>>    End
30425>>>>
30425>>>    Send DoRefindYear aiPanel aiYearDDId //(Year_DD(Self))
30426>>>    Get Server of aiPanel to liSrvr
30427>>>    // Respects Default values
30427>>>    If (liSrvr) If (Not(Current_Record(liSrvr))) Send Request_Clear to aiPanel
30432>>>End_Procedure
30433>>>
30433>>>//                                       ’¦ View            Property «¦¬ View             ’¦ Year DDO «¦¬ View
30433>>>//                                                          Holds the current year rec0
30433>>>// ‰¢ã©ž : Send RbldConstrIfYearChanged (Gplan_Test(Self))  (psCurrentYearRecr(Self))     (Year_DD(Self))
30433>>>
30433>>>
30433>>>Function fiRefindYear Global Returns Integer
30434>>>    Clear Year
30435>>>    Move gs_Selected_Company_Code to Year.Company_Code
30436>>>    Move gs_Selected_Branch_Code  to Year.Branch_Code
30437>>>    Move gi_Selected_Year         to Year.Year_Year
30438>>>    Find eq Year by Index.1 //company_code+ranch_code+year_year
30439>>>>
30439>>>    Function_Return (Found = 0)
30440>>>End_Function //fiRefindYear
30441>>>
30441>>>Procedure DoRunApplication for Baseclass String sAppName
30442>>>    string sRuntime  lsStr
30443>>>
30443>>>    Append lsStr 'C:\Dns.bat ' sAppName
30445>>>    RunProgram Wait  lsStr
30446>>>
30446>>>//    get_profile_string "defaults" "VDFBinDir" to sRuntime
30446>>>//    append sRuntime "\dfrun " sAppName
30446>>>    Append sRuntime 'C:\Program Files\Accessories\WORDPAD.EXE ' sAppName
30448>>>    runprogram background sRuntime
30449>>>End_procedure // DoRunApplication
30450>>>
30450>>>// Run the Editor
30450>>>Procedure DoRunEditor for Baseclass String asFile
30451>>>    string sRunPath lsWspcName
30452>>>    Move (WorkspaceName(ProgramWorkspace(Self))) to lsWspcName
30453>>>    get_profile_string ("workspaces\"+lsWspcName) "programpath" to sRunPath
30456>>>    //append sRunPath "\Editor "  asFile //// js 15/03/2002 " " lsWspcName
30456>>>    Move (Replace('.',asFile,'')) to asFile
30457>>>    append sRunPath asFile //// js 15/03/2002 " " lsWspcName
30458>>>    send DoRunApplication sRunPath
30459>>>End_Procedure // DoRunEditor
30460>>>
30460>>>//--------------------------------------
30460>>>
30460>>>//start of global functions and procedures
30460>>>
30460>>>
30460>>>//®¨ž© £¦§¦ œå«˜  ˜§æ: ˜) gmoves.dd    :private.update_gmhnes_ghmnies
30460>>>Function gsfFind_Previous Global String lsCode;                                 String lsDelimiter;                                 Returns String
30461>>>         String  lsTemp_Code1 lsTemp_Code2
30462>>>         Integer liCounter
30462>>>
30462>>>         //1.˜­˜å¨œ©ž ¡œ¤é¤
30462>>>         Move (Trim(lsCode)) to lsCode                                  //§® 30.12.345
30463>>>
30463>>>         //2.˜¤« ©«¨¦­ã
30463>>>         For liCounter From 1 to (Length(lsCode))
30469>>>>
30469>>>             Move (Insert(;                           (Mid(lsCode,1,liCounter)),;                           lsTemp_Code1,;                           1;                         )) to lsTemp_Code1                             //§® 543.21.03
30470>>>         Loop
30471>>>>
30471>>>
30471>>>         //3.˜­˜å¨œ©ž ¡œ¤é¤ (›â¤ ®¨œ áœ«˜ , safety only)
30471>>>         Move (Trim(lsTemp_Code1)) to lsTemp_Code1
30472>>>
30472>>>         //4.§˜å¨¤à £æ¤¦ «¦ ›œ¥ æ £â¨¦ª «¦¬ ˜¤«å©«¨¦­¦¬, £œ«á «¦ §¨é«¦ delimiter
30472>>>         Move (Right(;                      lsTemp_Code1,;                      ((Length(lsTemp_Code1))-((Pos(lsDelimiter,lsTemp_Code1))));                    )) to lsTemp_Code1                                  // §® 21.03
30473>>>
30473>>>         //5.¥˜¤á ˜¤« ©«¨¦­ã «¦¬ ˜¤«å©«¨¦­¦¬
30473>>>         For liCounter from 1 to (Length(lsTemp_Code1))
30479>>>>
30479>>>             Move (Insert(;                           (Mid(lsTemp_Code1,1,liCounter)),;                           lsTemp_Code2,;                           1;                         )) to lsTemp_Code2                             //§® 30.12
30480>>>         Loop
30481>>>>
30481>>>
30481>>>         Function_Return (Trim(lsTemp_Code2))
30482>>>End_Function //gsffind_previous
30483>>>
30483>>>
30483>>>Function gifSystem_Check Returns Integer
30484>>>         Integer liF_Gtypkins liF_Garicls liF_Gmoves liF_Gplans liF_Gmhnes liF_Ghmnies
30485>>>         Integer liS_Gtypkins liS_Garicls liS_Gmoves liS_Gplans liS_Gmhnes liS_Ghmnies
30485>>>//       Clear Company
30485>>>//       Find Gt Company.Recnum
30485>>>//       While (Found = 1)
30485>>>//             Add Company.Company_NumGtypkin to liS_Gtypkins § Ÿ˜¤é© ©«¦ sysfile ¤˜ «˜ ¡˜¨˜«áà ˜¬«á
30485>>>//             Add Company.Company_NumGarticl to liS_Garticls
30485>>>//             Add Company.Company_NumGmoves  to liS_Gmoves
30485>>>//             //d Company.Company_NumGtypkin to liS_Gtypkins
30485>>>//             Add Company.Company_NumGplan   to liS_GPlans
30485>>>//             Add Company.Company_NumGmhnes  to liS_Gmhnes
30485>>>//             Add Company.Company_NumGhmnies to liS_Ghmnies
30485>>>//             Find Gt Company.Recnum
30485>>>//       Loop
30485>>>//
30485>>>//       Get_Attribute {attribute} [of {file-handle} ;
30485>>>//                        [{field-num} | {index-num} [{segment-num}]]] ;
30485>>>//                        To {variable}
30485>>>//
30485>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30485>>>//       Get_Attribute DF_FILE_RECORDS_USED of Garticl.File_Number to liF_Garticls
30485>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmoves.File_Number  to liF_Gmoves
30485>>>//       //t_Attribute DF_FILE_RECORDS_USED of Gtypkin.File_Number to liF_Gtypkins
30485>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gplan.File_Number   to liF_Gplans
30485>>>//       Get_Attribute DF_FILE_RECORDS_USED of Gmhnes.File_Number  to liF_Gmhnes
30485>>>//       Get_Attribute DF_FILE_RECORDS_USED of Ghmnies.File_Number to liF_Ghmnies
30485>>>//
30485>>>
30485>>>//       //â¢œš®¦ª DF_FILE_MAX_RECORDS+ £œ records used
30485>>>
30485>>>//       //â¢œš®¦ª last rec0 = sysrec rec0
30485>>>
30485>>>    Function_Return 0
30486>>>End_Function //gifSystem_Check
30487>>>
30487>>>/////////////////////////////////////////////////////////////////
30487>>>//‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª, £œ ž ®à¨åª ›œ¡˜› ¡á  JS
30487>>>Function Sfi_All_Numbers Global Number anValue Integer aiLengthAkeraios Integer aiLengthDekadika Returns String
30488>>>
30488>>>    String  lsRetval lsValue lsAkeraios lsDekadika
30489>>>    Integer liInt liInteger iTimes iStart
30489>>>    Number  lnDecimals
30489>>>
30489>>>    Move (Integer(anValue))                                         to liInteger
30490>>>    Move (Round(AnValue-(Integer(anValue))*(10^aiLengthDekadika)))  to lnDecimals
30491>>>
30491>>>    Move liInteger              to lsAkeraios
30492>>>    Move lnDecimals             to lsDekadika
30493>>>    Move (Trim(lsAkeraios))     to lsAkeraios
30494>>>    Move (Trim(lsDekadika))     to lsDekadika
30495>>>
30495>>>    Move (Length(lsAkeraios)) to iStart
30496>>>    For iTimes From iStart to (aiLengthAkeraios-1)
30502>>>>
30502>>>        Insert "0" in lsAkeraios at 1
30504>>>    Loop
30505>>>>
30505>>>    Move (Trim(lsAkeraios)) to lsAkeraios
30506>>>
30506>>>    Move (Length(lsDekadika)) to iStart
30507>>>    For iTimes From iStart to (aiLengthDekadika-1)
30513>>>>
30513>>>        Move (Append(lsDekadika,"0")) to lsDekadika
30514>>>    Loop
30515>>>>
30515>>>    Move (Trim(lsDekadika)) to lsDekadika
30516>>>
30516>>>    If (aiLengthDekadika=0) Move '' to lsDekadika
30519>>>    Move '' to lsRetVal
30520>>>    Move (Pad((lsAkeraios-lsDekadika),(aiLengthAkeraios+aiLengthDekadika))) to lsRetval
30521>>>    Function_Return lsRetval
30522>>>End_Function //sfi_All_Numbers  ‚ ˜ §œ› ˜ Numeric £œ«˜™¢ž«¦¬ £ã¡¦¬ª
30523>>>              //                 £œ ž ®à¨åª ›œ¡˜› ¡á (JS)
30523>>>
30523>>>Open Codemast
30525>>>
30525>>>
30525>>>Function gsfCode_Mast Global String lsType String lsValue Returns String
30526>>>         Clear Codemast
30527>>>         Move lsType  to Codemast.Type
30528>>>         Move lsValue to Codemast.Code
30529>>>         Find Eq Codemast by Index.1 //type+code
30530>>>>
30530>>>         Function_Return Codemast.Description
30531>>>End_Function //code_mast
30532>>>
30532>>>
30532>>>Open Branch
INCLUDING FILE: BRANCH.FD
30534>>>Function fsgCode_With_Zeroes Global Integer aiCode    ;                                    Integer aiPlaces  ;                                    String asCompany  ;                                    String asBranch   ;                               Returns String
30535>>>    String rVal
30536>>>    Integer iInt
30536>>>    Clear Branch
30537>>>    Move asCompany  to Branch.Company_Code
30538>>>    Move asBranch   to Branch.Branch_Code
30539>>>    Find Eq Branch by Index.1
30540>>>>
30540>>>    If (Trim(Branch.Tomeas_Code)<>'') Move (Trim(Branch.Tomeas_Code)) to asBranch
30543>>>    Move (Trim(asCompany))  to asCompany
30544>>>    Move (Trim(asBranch))   to asBranch
30545>>>    If (Length(asCompany)=1) Insert '0' In asCompany At 1
30549>>>    If (Length(asBranch) =1) Insert '0' In asBranch  At 1
30553>>>    Move ''                                           to rVal
30554>>>    Move (Sfi_All_Numbers(aiCode,aiPlaces,0))         to rVal
30555>>>    Move (Append((asCompany+'.'+asBranch+'.'),rVal))  to rVal
30556>>>    Move (Trim(rVal))                                 to rVal
30557>>>    Function_Return rVal
30558>>>End_Function
30559>>>
30559>>>Function fsgStripCodeFromID Global String asID Returns Integer
30560>>>      Integer iLen iPos iInt
30561>>>      If (Trim(asID)='') Function_Return 0
30564>>>      Move (Trim  (asID)) to asID
30565>>>      Move (Length(asID)) to iLen
30566>>>      For iInt From 1     to iLen
30572>>>>
30572>>>          If (Mid(asID,1,iInt)='.') Move iInt to iPos
30575>>>      Loop
30576>>>>
30576>>>      Function_Return (Right(asID,(iLen-iPos)))
30577>>>End_Function
30578>>>
30578>>>Function fsCityDescr Global Integer aiCityID Returns String
30579>>>    String rVal
30580>>>    Open Cities
INCLUDING FILE: CITIES.FD
30582>>>    Clear Cities
30583>>>    Move aiCityID to Cities.City_ID
30584>>>    Find Eq Cities By Index.1
30585>>>>
30585>>>    If (Found=1) Move Cities.City_descr to rVal
30588>>>    Else         Move '' to rVal
30590>>>    Function_Return rVal
30591>>>End_Function
30592>>>
30592>>>Function fiTownIDFromCity Global Integer aiCityID Returns Integer
30593>>>    Open Cities
30595>>>    Clear Cities
30596>>>    Move aiCityID to Cities.City_ID
30597>>>    Find Eq Cities By Index.1
30598>>>>
30598>>>    Function_Return Cities.Town_ID
30599>>>End_Function
30600>>>
30600>>>Function fiCountryIDFromTown Global Integer aiTownID Returns Integer
30601>>>    Open Towns
INCLUDING FILE: TOWNS.FD
30603>>>    Clear Towns
30604>>>    Move aiTownID to Towns.Town_ID
30605>>>    Find Eq Towns By Index.1
30606>>>>
30606>>>    Function_Return Towns.Country_ID
30607>>>End_Function
30608>>>
30608>>>Function fsTownDescr Global Integer aiTownID Returns String
30609>>>    String rVal
30610>>>    Open Towns
30612>>>    Clear Towns
30613>>>    Move aiTownID to Towns.Town_ID
30614>>>    Find Eq Towns By Index.1
30615>>>>
30615>>>    If (Found=1) Move Towns.Town_descr to rVal
30618>>>    Else         Move '' to rVal
30620>>>    Function_Return rVal
30621>>>End_Function
30622>>>
30622>>>Function fsCountryDescr Global Integer aiCountryID Returns String
30623>>>    String rVal
30624>>>    Open Country
INCLUDING FILE: COUNTRY.FD
30626>>>    Clear Country
30627>>>    Move aiCountryID to Country.Country_ID
30628>>>    Find Eq Country By Index.1
30629>>>>
30629>>>    If (Found=1) Move Country.Country_descr to rVal
30632>>>    Else         Move '' to rVal
30634>>>    Function_Return rVal
30635>>>End_Function
30636>>>
30636>>>Function fsAreaDescr Global Integer aiAreaID Returns String
30637>>>    String rVal
30638>>>    Open Areas
INCLUDING FILE: AREAS.FD
30640>>>    Clear Areas
30641>>>    Move aiAreaID to Areas.Area_ID
30642>>>    Find Eq Areas By Index.1
30643>>>>
30643>>>    If (Found=1) Move Areas.Area_descr to rVal
30646>>>    Else         Move '' to rVal
30648>>>    Function_Return rVal
30649>>>End_Function
30650>>>
30650>>>Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
30651>>>    Local String rVal lsTmp lsOO lsLL
30652>>>    Local Number lnOO lnLL
30652>>>
30652>>>    Move '' to lsOO
30653>>>    Move '' to lsLL
30654>>>    Move '' to rVal
30655>>>
30655>>>    Move (Integer(anTime))                              to lnOO
30656>>>
30656>>>    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
30657>>>
30657>>>    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
30660>>>    Else         Move (String(lnOO))                    to lsOO
30662>>>    Move (Trim(lsOO))                                   to lsOO
30663>>>
30663>>>    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
30666>>>    Else         Move (String(lnLL))                    to lsLL
30668>>>    Move (Trim(lsLL))                                   to lsLL
30669>>>
30669>>>    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
30670>>>
30670>>>    Move (Trim(rVal)) to rVal
30671>>>
30671>>>    Function_Return rVal
30672>>>End_Function
30673>>>
30673>>>Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
30674>>>    Local Number rVal nOres nLepta
30675>>>    Move (Integer(aiMinutes/60))    to nOres
30676>>>    Move (    Mod(aiMinutes,60))    to nLepta
30677>>>    Move (nOres+(nLepta/100))       to rVal
30678>>>    Function_Return rVal
30679>>>End_Function
30680>>>
30680>>>Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
30681>>>    Local Integer rVal
30682>>>    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
30683>>>    Function_Return rVal
30684>>>End_Function
30685>>>
30685>>>Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;                                                                    Number anEndTime    ;                                                                    Returns Integer
30686>>>    Local Integer rVal iMinStart iMinEnd
30687>>>
30687>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30690>>>
30690>>>    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
30691>>>    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
30692>>>    Move (iMinEnd-iMinStart)                                                     to rVal
30693>>>    Function_Return rVal
30694>>>End_Function
30695>>>
30695>>>
30695>>>Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;                                                                Number anEndTime    ;                                                                Returns Number
30696>>>    Local Integer iTmp
30697>>>    Local Number  rVal
30697>>>
30697>>>    If (anStartTime >= anEndTime) Add 24 to anEndTime
30700>>>
30700>>>    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
30701>>>    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
30702>>>    Function_Return rVal
30703>>>End_Function
30704>>>
30704>>>
30704>>>Open WitemCL
INCLUDING FILE: WITEMCL.FD
30706>>>Open WitemCld
INCLUDING FILE: WITEMCLD.FD
30708>>>Open WitemxT
INCLUDING FILE: WITEMXT.FD
30710>>>
30710>>>Function fnTeleytaiaTimhAgoras String asPromCode String asItemCode  ;                               Date   adHmnia    Number anQty       ;                               Returns Number
30711>>>  Integer iExodos
30712>>>  Number nPoso nPct
30712>>>  Move 0 to nPoso
30713>>>  Move 0 to nPct
30714>>>  Move 0 to iExodos
30715>>>
30715>>>  Move (Trim(asItemCode)) to asItemCode
30716>>>  Move (Trim(asPromCode)) to asPromCode
30717>>>
30717>>>  // 1.Anazhthsh sto arxeio Witemcld
30717>>>  Clear Witemcld
30718>>>  Move asItemCode to Witemcld.Item_Code
30719>>>  Move asPromCode to Witemcld.Client_Code
30720>>>  Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30721>>>>
30721>>>  While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;                       (Witemcld.Client_Code= asPromCode) And ;                       (iExodos=0))
30725>>>      If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30727>>>          Move 1 to iExodos
30728>>>               If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30731>>>          Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30735>>>      End
30735>>>>
30735>>>      Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30736>>>>
30736>>>  Loop
30737>>>>
30737>>>  If (iExodos) Begin
30739>>>      If (nPoso) Function_Return nPoso
30742>>>      Else Function_Return nPct
30744>>>  End
30744>>>>
30744>>>
30744>>>  // 2.Anazhthsh sto arxeio Witemcl
30744>>>  Clear WitemCL
30745>>>  Move (Trim(asPromCode)) to WitemCL.Client_Code
30746>>>  Move (Trim(asItemCode)) to WitemCL.Item_Code
30747>>>  Find Eq WitemCL By Index.1
30748>>>>
30748>>>  If (Found=1) Function_Return WitemCL.Client_Price
30751>>>
30751>>>  Function_Return 0
30752>>>End_Function
30753>>>
30753>>>
30753>>>Open BtnOrdd
INCLUDING FILE: BTNORDD.FD
30755>>>
30755>>>Function fnTeleytaiaTimhPolhshs String asWitemxRecr String asClientID ;                                String asWitemxCode Date   adHmnia    ;                                String asItemCode   Number anQty      ;                                String asCNCode     Returns Number
30756>>>
30756>>>  Integer iExodos iCheckDeop
30757>>>  Number nPoso nPct
30757>>>
30757>>>  Move (Num_Arguments=7) to iCheckDeop
30758>>>
30758>>>  Move 0 to nPoso
30759>>>  Move 0 to nPct
30760>>>  Move 0 to iExodos
30761>>>
30761>>>  Move (Trim(asItemCode))                 to asItemCode
30762>>>  Move (Trim(asClientID))                 to asClientID
30763>>>  Move (Trim(asWitemxRecr))               to asWitemxRecr
30764>>>  Move (Trim(asWitemxCode))               to asWitemxCode
30765>>>  If (iCheckDeop) Move (Trim(asCNCode))   to asCNCode
30768>>>
30768>>>  // 1. Anazhthsh apo DEOP ef' oson yparxei kodikos ergou
30768>>>  If (iCheckDeop) Begin
30770>>>      Clear btnordd
30771>>>      Move asClientID   to btnordd.vclient_id
30772>>>      Move asCNCode     to btnordd.vcn_code
30773>>>      Move asWitemxCode to btnordd.vitem
30774>>>      Move 0            to btnordd.vactive
30775>>>      Move adHmnia      to btnordd.arxh_date
30776>>>      Find LE btnordd by index.4//client_id+cn_code+item+arxh_date
30777>>>>
30777>>>      If ((found=1) and (asWitemxCode=btnordd.vitem)    and (adHmnia>=btnordd.arxh_date) ;                    and (adHmnia<=btnordd.deop_date)    and (btnordd.vactive=0)          ;                    and (asCNCode=btnordd.vcn_code)) begin
30779>>>          move btnordd.vprice to nPoso
30780>>>          If (nPoso) Function_Return nPoso
30783>>>      End
30783>>>>
30783>>>  End
30783>>>>
30783>>>  // 19-03-2007 Tolhs na pernei times mono an brei apo deop
30783>>>  // 2.Anazhthsh sto arxeio Witemcld (Timokatalogos Pelath/Eidous)
30783>>> // Clear Witemcld
30783>>> // Move asItemCode to Witemcld.Item_Code
30783>>> // Move asClientID to Witemcld.Client_Code
30783>>> // Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30783>>> // While ((Found=1) And (Witemcld.Item_Code  = asItemCode) And ;
30783>>> //                      (Witemcld.Client_Code= asClientID) And ;
30783>>> //                      (iExodos=0))
30783>>> //     If ((adHmnia>=Witemcld.Value_Date) And (anQty<=Witemcld.Qty)) Begin
30783>>> //         Move 1 to iExodos
30783>>> //              If (Witemcld.Axia00<>0) Move Witemcld.Axia00         to nPoso
30783>>> //         Else If (Witemcld.PcDisc<>0) Move (Witemcld.PcDisc*(-1))  to nPct
30783>>> //     End
30783>>> //     Find Gt Witemcld By Index.1 // Witemcld:Index.1:Item_Code+Client_Code+Value_Date+Qty
30783>>> // Loop
30783>>> // If (iExodos) Begin
30783>>> //     If (nPoso) Function_Return nPoso
30783>>> //     Else Function_Return nPct
30783>>> // End
30783>>>
30783>>>
30783>>>  // 3.Anazhthsh sto arxeio Witemxt (Timokatalogos Eidous)
30783>>>  //Clear Witemxt
30783>>>  //Move SysCurXr.Company_Code  to Witemxt.Company_Code
30783>>>  //Move SysCurXr.Branch_Code   to Witemxt.Branch_Code
30783>>>  //Move SysCurXr.Year_Year     to Witemxt.Year_Year
30783>>>  //Move asWitemxRecr           to Witemxt.Witemx_Recr
30783>>>  //Find Gt Witemxt By Index.1 // Witemxt:Index.1
30783>>>  //While ((Found=1) And (Witemxt.Company_Code = SysCurXr.Company_Code) And ;
30783>>>  //                     (Witemxt.Branch_Code  = SysCurXr.Branch_Code ) And ;
30783>>>  //                     (Witemxt.Year_Year    = SysCurXr.Year_Year   ) And ;
30783>>>  //                     (Witemxt.Witemx_Recr  = asWitemxRecr         ) And ;
30783>>>  //                     (iExodos=0))
30783>>>  //    If ((adHmnia>=Witemxt.Value_Date) And (anQty<=Witemxt.Qty)) Begin
30783>>>  //        Move 1 to iExodos
30783>>>  //             If (Witemxt.Axia0 <>0) Move  Witemxt.Axia0         to nPoso
30783>>>  //        Else If (Witemxt.PcDisc<>0) Move (Witemxt.PcDisc*(-1))  to nPct
30783>>>  //    End
30783>>>  //    Find Gt Witemxt By Index.1 // Witemxt:Index.1
30783>>>  //Loop
30783>>>  //If (iExodos) Begin
30783>>>  //    If (nPoso) Function_Return nPoso
30783>>>  //    Else Function_Return nPct
30783>>>  //End
30783>>>
30783>>>
30783>>>  // 4.Anazhthsh sto arxeio Witemcl (Teleytaia Timh Agoras)
30783>>>  //Clear WitemCL
30783>>>  //Move (Trim(asClientID)) to WitemCL.Client_Code
30783>>>  //Move (Trim(asItemCode)) to WitemCL.Item_Code
30783>>>  //Find Eq WitemCL By Index.1
30783>>>  //If (Found=1) Function_Return WitemCL.Client_Price
30783>>>
30783>>>  Function_Return 0
30784>>>End_Function
30785>>>
30785>>>Function fsStripTextFieldFromEnter Global String asStr Returns String
30786>>>    String sEnter
30787>>>    Move '' to sEnter
30788>>>    Move (Trim(asStr)) to asStr
30789>>>    Append sEnter (Character(13)) (Character(10))
30791>>>    Move (Replaces(sEnter,asStr,' ')) to asStr
30792>>>    Function_return (Trim(asStr))
30793>>>End_function
30794>>>
30794>>>
30794>>>//end   of global functions and procedures
30794>>>Use Wait.DG
INCLUDING FILE: WAIT.DG
30794>>>>>USE AllEntSc
30794>>>>>
30794>>>>>//AB-IgnoreEnd
30794>>>>>
30794>>>>>
30794>>>>>//AB-IgnoreEnd
30794>>>>>
30794>>>>>Object Wait is a ModalPanelSub
30796>>>>>
30796>>>>>    //AB-StoreTopStart
30796>>>>>
30796>>>>>    // How to Use It
30796>>>>>    // Get the maximum position of the bar
30796>>>>>    // Move (Bar_Maximum_position(Wait(self))) to iMax
30796>>>>>    //
30796>>>>>    // Set the maximum position of the bar
30796>>>>>    // Set Bar_Maximum_position of (Wait(self)) to iMax
30796>>>>>    //
30796>>>>>    // Start Bar Progress from beginning
30796>>>>>    // Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30796>>>>>    //
30796>>>>>    // End Bar Progress
30796>>>>>    // Send Bar_Current_Position to (Wait(Self)) iMax iMax iMax False
30796>>>>>    //
30796>>>>>    // Update Bar Progress
30796>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax True OR
30796>>>>>    // Send Bar_Current_Position to (Wait(Self)) i iCounter iMax False
30796>>>>>    // When you want the update to be done for every i (this is slower)
30796>>>>>    // Where i=Counter's current value, icounter=Counter's Max Value and iMax=Bar Max Position
30796>>>>>    //
30796>>>>>    // Display Buttons on the object
30796>>>>>    // Set Button_State of (Wait(Self)) to False/True
30796>>>>>    // If the Progress Bar gets initialized without buttons, it MUST be Deactivated
30796>>>>>    //
30796>>>>>    // Initialization of the Progress Bar
30796>>>>>    // Send Popup to (Wait(Self))
30796>>>>>    //
30796>>>>>    // Deactivation of the Progress Bar
30796>>>>>    // Send Deactivate to (Wait(Self))
30796>>>>>    //
30796>>>>>    // Message during the process
30796>>>>>    // Set Wait_Message of (Wait(Self)) to "Now Processing..."
30796>>>>>    //
30796>>>>>    // Extra Info for button "Info >>"
30796>>>>>    // Send Wait_Details to (Wait(Self)) sFile sDetail bInitData
30796>>>>>    // If sFile<>'' then reads the contents of the file
30796>>>>>    // Else Fills the Edit with the string of sDetail
30796>>>>>    // If bInitData is True then the edit object is cleared first else extra info is appended
30796>>>>>    //
30796>>>>>    // Remarks instead of Progress Bar
30796>>>>>    // Set Button_State of (Wait(Self))     to False
30796>>>>>    // Set BarVisibleState of (Wait(Self))  to 'Remarks' False
30796>>>>>    // Update During Process
30796>>>>>    // Send UpdateWait to (Wait(Self)) 'Remarks'
30796>>>>>
30796>>>>>    //AB-StoreTopEnd
30796>>>>>
30796>>>>>    Set Exit_Application_Local_State to FALSE
30797>>>>>    Set Modal_State to FALSE
30798>>>>>    Set Popup_State to TRUE
30799>>>>>    Set Border_Style to Border_Thick
30800>>>>>    Set Minimize_Icon to FALSE
30801>>>>>    Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30802>>>>>    Set Size to 138 256
30803>>>>>
30803>>>>>    //AB-DDOStart
30803>>>>>
30803>>>>>
30803>>>>>    //AB-DDOEnd
30803>>>>>
30803>>>>>    Object WaitBar is a ProgressBarSub
30805>>>>>
30805>>>>>        //AB-StoreTopStart
30805>>>>>
30805>>>>>        //AB-StoreTopEnd
30805>>>>>
30805>>>>>        Set Size to 21 243
30806>>>>>        Set Location to 7 4
30807>>>>>
30807>>>>>        //AB-StoreStart
30807>>>>>        Send DoRegSize  self smTopRight
30808>>>>>        //AB-StoreEnd
30808>>>>>
30808>>>>>    End_Object
30809>>>>>
30809>>>>>    Object WaitText is a TextBoxSub
30811>>>>>
30811>>>>>        //AB-StoreTopStart
30811>>>>>
30811>>>>>        //AB-StoreTopEnd
30811>>>>>
30811>>>>>        Set Enabled_State to TRUE
30812>>>>>        Set Label to "Processing"
30813>>>>>        Set FontSize to 4 0
30814>>>>>        Set Size to 10 81
30815>>>>>        Set Location to 36 5
30816>>>>>
30816>>>>>        //AB-StoreStart
30816>>>>>
30816>>>>>        //AB-StoreEnd
30816>>>>>
30816>>>>>    End_Object
30817>>>>>
30817>>>>>    Object bnCancel is a ButtonSub
30819>>>>>
30819>>>>>        //AB-StoreTopStart
30819>>>>>
30819>>>>>        //AB-StoreTopEnd
30819>>>>>
30819>>>>>        Set Default_State to TRUE
30820>>>>>        Set Label to "OK"
30821>>>>>        Set Location to 34 143
30822>>>>>
30822>>>>>        //AB-StoreStart
30822>>>>>
30822>>>>>        Procedure OnClick
30824>>>>>             Send Deactivate to (Wait(Self))
30825>>>>>        End_Procedure
30826>>>>>
30826>>>>>        Send DoRegAlign self amTopRight
30827>>>>>        //AB-StoreEnd
30827>>>>>
30827>>>>>    End_Object
30828>>>>>
30828>>>>>    Object bnDetail is a ButtonSub
30830>>>>>
30830>>>>>        //AB-StoreTopStart
30830>>>>>
30830>>>>>        //AB-StoreTopEnd
30830>>>>>
30830>>>>>        Set Focus_Mode to Pointer_Only
30831>>>>>        Set Label to "Info >>"
30832>>>>>        Set Location to 34 197
30833>>>>>
30833>>>>>        //AB-StoreStart
30833>>>>>
30833>>>>>        Procedure OnClick
30835>>>>>            Delegate Send Show_Details False
30837>>>>>        End_Procedure
30838>>>>>
30838>>>>>        Send DoRegAlign self amTopRight
30839>>>>>        //AB-StoreEnd
30839>>>>>
30839>>>>>    End_Object
30840>>>>>
30840>>>>>    Object LineControlSub1 is a LineControlSub
30842>>>>>
30842>>>>>        //AB-StoreTopStart
30842>>>>>
30842>>>>>        //AB-StoreTopEnd
30842>>>>>
30842>>>>>        Set Size to 2 243
30843>>>>>        Set Location to 54 4
30844>>>>>
30844>>>>>        //AB-StoreStart
30844>>>>>
30844>>>>>        Send DoRegSize  self smTopRight
30845>>>>>        //AB-StoreEnd
30845>>>>>
30845>>>>>    End_Object
30846>>>>>
30846>>>>>    Object WaitEdit is a editSub
30848>>>>>
30848>>>>>        //AB-StoreTopStart
30848>>>>>
30848>>>>>        //AB-StoreTopEnd
30848>>>>>
30848>>>>>        Set Enabled_State to FALSE
30849>>>>>        Set Read_Only_State to TRUE
30850>>>>>        Set Size to 58 243
30851>>>>>        Set Location to 60 4
30852>>>>>        Set Color to clWhite
30853>>>>>
30853>>>>>        //AB-StoreStart
30853>>>>>
30853>>>>>        Send DoRegSize Self amBottomRight
30854>>>>>        Delegate Set Size to 66 256
30856>>>>>
30856>>>>>        //AB-StoreEnd
30856>>>>>
30856>>>>>    End_Object
30857>>>>>
30857>>>>>    Object oTxtAntiBar is a TextBoxSub
30859>>>>>        Set Enabled_State to TRUE
30860>>>>>        Set Visible_State to FALSE
30861>>>>>        Set Label to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..."
30862>>>>>        Set Justification_Mode to (jMode_Center IOR jMode_VCenter)
30863>>>>>        Set Auto_Size_State to FALSE
30864>>>>>        Set FontWeight to 600
30865>>>>>        Set FontSize to 4 0
30866>>>>>        Set Size to 10 209
30867>>>>>        Set Location to 10 4
30868>>>>>        Set TextColor to clNavy
30869>>>>>    End_Object
30870>>>>>
30870>>>>>
30870>>>>>    //AB-StoreStart
30870>>>>>    Property Integer piWaitSize  Public (Size(Self))
30872>>>>>    Property Integer piPrevSize  Public (Size(Self))
30874>>>>>    Property Integer piState     Public False
30876>>>>>
30876>>>>>    Set Locate_Mode to Center_On_Screen
30877>>>>>    Set Destroy_Object_State to True
30878>>>>>
30878>>>>>    Procedure Show_Details Integer bAlways
30880>>>>>        Local Integer liOriSize liSize hiSize hiOriSize lowSize bState
30881>>>>>        Local String sLabel
30881>>>>>        Get Size                to liSize
30882>>>>>        Get piState             to bState
30883>>>>>        Get piWaitSize          to liOriSize
30884>>>>>        Move (Hi(liSize))       to hiSize
30885>>>>>        Move (Low(liSize))      to lowSize
30886>>>>>        Move (Hi(liOriSize))    to hiOriSize
30887>>>>>        If (bAlways) Begin
30889>>>>>            Set piState         to False
30890>>>>>            Move 0              to bState
30891>>>>>        End
30891>>>>>>
30891>>>>>        If bState Begin
30893>>>>>             Set Size to hiOriSize lowSize
30894>>>>>             Set Label of (bnDetail(Self)) to "Info >>"
30895>>>>>        End
30895>>>>>>
30895>>>>>        Else Begin
30896>>>>>             Set Size to 138 lowSize
30897>>>>>             Set Label of (bnDetail(Self)) to "<< Info"
30898>>>>>        End
30898>>>>>>
30898>>>>>        Set piState to (1-bState)
30899>>>>>    End_Procedure
30900>>>>>
30900>>>>>    Procedure Bar_Current_Position Integer iCount Integer iOccurances Integer iMaximum Integer bState
30902>>>>>       If (bState) Begin
30904>>>>>         If (Mod(iCount,(iCount*((Number(iMaximum))/(Number(iOccurances)))))=0) ;            Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30907>>>>>       End
30907>>>>>>
30907>>>>>       Else Set Current_Position of (WaitBar(Self)) to (iCount*((Number(iMaximum))/(Number(iOccurances))))
30909>>>>>    End_Procedure
30910>>>>>
30910>>>>>    Procedure DoInitialize_WaitBar
30912>>>>>        Send Bar_Current_Position to (Wait(Self)) 0 0 0 False
30913>>>>>    End_Procedure
30914>>>>>
30914>>>>>    Procedure DoTerminate_WaitBar
30916>>>>>        Local Integer iMax
30917>>>>>        Get Maximum_position of (WaitBar(Self)) to iMax
30918>>>>>        Send Bar_Current_Position to (Wait(Self)) iMax iMax Imax False
30919>>>>>    End_Procedure
30920>>>>>
30920>>>>>    Procedure Set Bar_Maximum_Position Integer iMaximum
30922>>>>>         Set Maximum_position of (WaitBar(Self)) to iMaximum
30923>>>>>    End_Procedure
30924>>>>>
30924>>>>>    Function Bar_Maximum_Position Returns Integer
30926>>>>>        Function_Return (Maximum_position(WaitBar(Self)))
30927>>>>>    End_Function
30928>>>>>
30928>>>>>    Procedure Set Bar_Minimum_Position Integer iMinimum
30930>>>>>         Set Minimum_position of (WaitBar(Self)) to iMinimum
30931>>>>>    End_Procedure
30932>>>>>
30932>>>>>    Function Bar_Minimum_Position Returns Integer
30934>>>>>        Function_Return (Minimum_position(WaitBar(Self)))
30935>>>>>    End_Function
30936>>>>>
30936>>>>>    Procedure Set Bar_Step_Value Integer iStep
30938>>>>>         Set Step_Value of (WaitBar(Self)) to iStep
30939>>>>>    End_Procedure
30940>>>>>
30940>>>>>    Function Bar_Step_Value Returns Integer
30942>>>>>        Function_Return (Step_Value(WaitBar(Self)))
30943>>>>>    End_Function
30944>>>>>
30944>>>>>    Procedure Set Wait_Message String sMessage
30946>>>>>        Set Value of (WaitText(Self)) to sMessage
30947>>>>>    End_Procedure
30948>>>>>
30948>>>>>    Procedure Wait_Details String sFile String sDetail Integer bInitData
30950>>>>>        Local Integer liEditId
30951>>>>>        Move (WaitEdit(Self)) to liEditId
30952>>>>>        If bInitData Send Delete_Data to liEditId
30955>>>>>        If sFile ne "" Begin
30957>>>>>           Send Read to liEditId sFile
30958>>>>>           Send Beginning_Of_Data to liEditId
30959>>>>>        End
30959>>>>>>
30959>>>>>        Else Begin
30960>>>>>           Send Insert to liEditId sDetail
30961>>>>>        End
30961>>>>>>
30961>>>>>    End_Procedure
30962>>>>>
30962>>>>>    Procedure OnResize
30964>>>>>        Local Integer liSize liHiSize liPrevSize liHiPrevSize bState liHiLoc liLoc
30965>>>>>        Get Size to liPrevSize
30966>>>>>        Move (Hi(liPrevSize)) to liHiPrevSize
30967>>>>>        Forward Send OnResize
30969>>>>>        Get Location of (WaitEdit(Self)) to liLoc
30970>>>>>        Move (Hi(liLoc)) to liHiLoc
30971>>>>>        Get piState to bState
30972>>>>>        Get Size to liSize
30973>>>>>        Move (Hi(liSize)) to liHiSize
30974>>>>>        If (liHiSize > (liHiLoc +30)) Begin
30976>>>>>            Set Value of (bnDetail(Self)) to "<< Info"
30977>>>>>            If (liHiPrevSize <= (liHiLoc +30)) Set piState to (1-bState)
30980>>>>>        End
30980>>>>>>
30980>>>>>        Else Begin
30981>>>>>            Set Value of (bnDetail(Self)) to "Info >>"
30982>>>>>            If (liHiPrevSize > (liHiLoc +30)) Set piState to (1-bState)
30985>>>>>        End
30985>>>>>>
30985>>>>>    End_Procedure
30986>>>>>
30986>>>>>    Procedure Set Button_State Integer bState
30988>>>>>        If bState Begin
30990>>>>>            Set Caption_Bar to True
30991>>>>>            Set Size to 66 256
30992>>>>>        End
30992>>>>>>
30992>>>>>        Else Begin
30993>>>>>            Set Caption_Bar to False
30994>>>>>            Set Size to 38 256
30995>>>>>        End
30995>>>>>>
30995>>>>>    End_Procedure
30996>>>>>
30996>>>>>    Procedure Set BarVisibleState String sMsg Integer bState
30998>>>>>        Set Visible_State of (oTxtAntiBar(Self)) to (bState = 0)
30999>>>>>        Set Visible_State of (WaitBar(Self))     to (bState = 1)
31000>>>>>        If (bState = 0) Begin
31002>>>>>            Set Size to 24 256
31003>>>>>            Set Location of (oTxtAntiBar(Self)) to 6 5
31004>>>>>        End
31004>>>>>>
31004>>>>>        If sMsg ne "" Set Value of (oTxtAntiBar(Self)) to sMsg
31007>>>>>    End_Procedure
31008>>>>>
31008>>>>>    Procedure Deactivating integer search_mode Returns Integer
31010>>>>>        local integer rval
31011>>>>>        Forward Get MSG_Deactivating search_mode to rval
31013>>>>>        Set Modal_State of (Wait(Self)) to False
31014>>>>>        Set BarVisibleState of (Wait(Self)) to "˜¨˜¡˜¢é §œ¨ £â¤œ«œ..." True
31015>>>>>        Procedure_Return rval
31016>>>>>    End_Procedure
31017>>>>>
31017>>>>>    Procedure UpdateWait String sMsg
31019>>>>>        Set Value of (oTxtAntiBar(Self)) to sMsg
31020>>>>>    End_Procedure
31021>>>>>
31021>>>>>
31021>>>>>    Procedure Set Horizontal_Justification Integer aiMode
31023>>>>>        Set Justification_Mode of oTxtAntiBar to (jMode_VCenter IOR aiMode)
31024>>>>>    End_Procedure
31025>>>>>
31025>>>>>
31025>>>>>
31025>>>>>
31025>>>>>
31025>>>>>
31025>>>>>    //AB-StoreEnd
31025>>>>>
31025>>>>>End_Object
31026>>>>>
31026>>>>>
31026>>>>>//AB-StoreStart
31026>>>>>
31026>>>>>//AB-StoreEnd
31026>>>>>
31026>>>>>//AB/ End_Object    // prj
31026>>>
31026>Use Calendar.sl
INCLUDING FILE: CALENDAR.SL
31026>>>//AB/ Project Calendar
31026>>>//AB/ Object prj is a Lookup_Project
31026>>>//AB/     Set ProjectName to "Calendar"
31026>>>//AB/     Set ProjectFileName to "Calendar.sl"
31026>>>
31026>>>// Project Object Structure
31026>>>//   oCalendar is a dbModalPanel
31026>>>//     Container3d1 is a Container3d
31026>>>//       Grid2 is a Grid
31026>>>//       Textbox2 is a Textbox
31026>>>//       Textbox3 is a Textbox
31026>>>//       Textbox4 is a Textbox
31026>>>//       Textbox5 is a Textbox
31026>>>//       Textbox6 is a Textbox
31026>>>//       Textbox7 is a Textbox
31026>>>//       Textbox8 is a Textbox
31026>>>//       LineControl1 is a LineControl
31026>>>//       Container3d2 is a Container3d
31026>>>//         oRght is a BitmapContainer
31026>>>//         oLeft is a BitmapContainer
31026>>>//         oMonth is a Textbox
31026>>>//           oSelectMonth is a FloatingPopupMenu
31026>>>//         oYear is a Textbox
31026>>>//         oSelectYear is a Form
31026>>>//     BitmapContainer3 is a BitmapContainer
31026>>>//     oToday is a Textbox
31026>>>
31026>>>// Register all objects
31026>>>Register_Object BitmapContainer3
31026>>>Register_Object Container3d1
31026>>>Register_Object Container3d2
31026>>>Register_Object Grid2
31026>>>Register_Object LineControl1
31026>>>Register_Object oCalendar
31026>>>Register_Object oLeft
31026>>>Register_Object oMonth
31026>>>Register_Object oRght
31026>>>Register_Object oSelectMonth
31026>>>Register_Object oSelectYear
31026>>>Register_Object oToday
31026>>>Register_Object oYear
31026>>>Register_Object Textbox2
31026>>>Register_Object Textbox3
31026>>>Register_Object Textbox4
31026>>>Register_Object Textbox5
31026>>>Register_Object Textbox6
31026>>>Register_Object Textbox7
31026>>>Register_Object Textbox8
31026>>>
31026>>>
31026>>>
31026>>>//AB-StoreTopStart
31026>>>Use dates.utl
INCLUDING FILE: DATES.UTL
31026>>>>>// **********************************************************************
31026>>>>>// Use Dates.utl    // Date manipulation for VDF and DF3.1
31026>>>>>//
31026>>>>>// by Sture Andersen (sa1@vd.dk)
31026>>>>>//
31026>>>>>// The file contains a number of global functions for manipulating
31026>>>>>// dates. The package may be used with DataFlex 3.1 and Visual DataFlex.
31026>>>>>// This package is public domain.
31026>>>>>//
31026>>>>>// The package file is accompanied by a Word document (dfutil.doc)
31026>>>>>// listing the functions and their use.
31026>>>>>//
31026>>>>>//
31026>>>>>// Create: Fri  06-06-1997 - Merger of s_utl020, 021, 022, 023, 024, 025.
31026>>>>>// Update: Thu  26-06-1997 - Fixes for strange behavior when date4_state is set.
31026>>>>>//                         - Addition of popup_calendar to VDF.
31026>>>>>//         Sun  29-06-1997 - Character mode popup calender.
31026>>>>>//         Fri  04-07-1997 - Function WeekToDate added.
31026>>>>>//         Thu  10-07-1997 - Fixes.
31026>>>>>//         Mon  11-08-1997 - WeekToDate fixed.
31026>>>>>//         Sun  24-08-1997 - Character mode popup calender finished.
31026>>>>>//         Mon  15-12-1997 - Procedure Request_Popup_Calendar added.
31026>>>>>//         Mon  29-12-1997 - Procedures ItemYear2to4, ItemDate2to4 and
31026>>>>>//                           ItemSysdate added.
31026>>>>>//         Mon  29-12-1997 - Procedures FieldYear2to4, FieldDate2to4 and
31026>>>>>//                           FieldSysdate added.
31026>>>>>//         Sun  01-02-1998 - Functions Module_Compile_Date and
31026>>>>>//                           Module_Compile_Time added.
31026>>>>>//         Wed  25-02-1998 - Request_Popup in calendar object now only
31026>>>>>//                           responds if entry_state of the calling object
31026>>>>>//                           is true (VDF version). (No apparent effect)
31026>>>>>//         Sat  28-03-1998 - Added the following functions:
31026>>>>>//                             TS_SysTime      TS_ExtractDate
31026>>>>>//                             TS_ExtractTime  TS_ConvertToString
31026>>>>>//         Tue  26-05-1998 - Procedure TS_UI_Update added
31026>>>>>//         Sat  01-08-1998 - mask_date_window taken into account
31026>>>>>//         Mon  10-08-1998 - Functions Module_Start_Date and
31026>>>>>//                           Module_Start_Time added.
31026>>>>>//         Wed  02-09-1998 - Parameter for Module_Start_Date removed
31026>>>>>//         Mon  12-10-1998 - Portuguese added
31026>>>>>//         Wed  04-11-1998 - TS_TimeEstimator class added
31026>>>>>//         Tue  29-12-1998 - Function DateAsString added
31026>>>>>//         Wed  13-01-1999 - Function DateWeekNumber changed according to
31026>>>>>//                           Kjetil Johanson
31026>>>>>//         Mon  18-01-1999 - Function DateWeekNumber changed according to
31026>>>>>//                           Kjetil Johanson (again)
31026>>>>>//         Tue  19-01-1999 - Changed procedure names in TS_TimeEstimator
31026>>>>>//                           class (Continue->TS_Continue and Pause->
31026>>>>>//                           TS_Pause)
31026>>>>>//         Thu  21-01-1999 - Procedures DateFormatAsString and DateFormatName
31026>>>>>//                           added.
31026>>>>>//                         - Procedures DateCurrentSeparator and
31026>>>>>//                           DateCurrentFormat added.
31026>>>>>//         Tue  13-04-1999 - Julian constants added: Jan1st1900, Jan1st2000
31026>>>>>//                           Jan1st1000 and Jan1st100
31026>>>>>//         Mon  26-04-1999 - Changed procedure FieldYear2to4 and ItemYear2to4
31026>>>>>//                           to trap 3 digit years.
31026>>>>>//         Wed  27-04-1999 - Changed Dutch abbriviated day names (to 2 characters)
31026>>>>>//         Sun  02-05-1999 - Added function TS_Compose2
31026>>>>>//                         - Fixed error in TS_ConvertToString
31026>>>>>//         Tue  01-06-1999 - Added procedure popup_no_export to calendar.
31026>>>>>//         Thu  15-06-1999 - Fixed Date4to2 function and exporting dates
31026>>>>>//                           from the calendar to forms with no form_margin.
31026>>>>>//         Tue  07-09-1999 - Added function DateAsText
31026>>>>>//         Wed  27-10-1999 - Temporary fix for Module_Compile_Date function
31026>>>>>//                           in combination with y2k.
31026>>>>>//         Wed  19-12-1999 - Function StringToDate added.
31026>>>>>//                         - Existing function DateAsString renamed to
31026>>>>>//                           DateToString.
31026>>>>>//         Mon  03-01-2000 - Fix for VDF4. Popup calendar on empty date field
31026>>>>>//                           would result in seeding the calendar on year 100.
31026>>>>>//                           This error was caused by the fact that VDF 4
31026>>>>>//                           ignores SYSDATE4_STATE such that the sysdate
31026>>>>>//                           command returns 03-01-100
31026>>>>>//         Wed  01-02-2000 - Define instead of #REPLACE
31026>>>>>//         Wed  23-08-2000 - Function TS_Module_Compile_Time added
31026>>>>>//
31026>>>>>// NOTE:  There is language dependent string constants in this file.
31026>>>>>//        Currently there are sections for dutch, english, danish, swedish,
31026>>>>>//        norwegian, spanish, german and portuguese
31026>>>>>//
31026>>>>>//        These sections may be identified by searching the symbol LNG_DEFAULT
31026>>>>>//
31026>>>>>// ***********************************************************************
31026>>>>>
31026>>>>>Use ui
31026>>>>>Use Language    // Set default languange if not set by compiler command line
INCLUDING FILE: LANGUAGE.PKG
31026>>>>>>>// Use Language     // Default language setup
31026>>>>>>>// Sets default languange if not set by compiler command line
31026>>>>>>>
31026>>>>>>>define lng_dutch      for 131
31026>>>>>>>define lng_french     for 133 // NOT TRANSLATED. DO NOT SELECT!
31026>>>>>>>define lng_spanish    for 134
31026>>>>>>>define lng_italian    for 139 // NOT TRANSLATED. DO NOT SELECT!
31026>>>>>>>define lng_english    for 144
31026>>>>>>>define lng_danish     for 145
31026>>>>>>>define lng_swedish    for 146
31026>>>>>>>define lng_norwegian  for 147
31026>>>>>>>define lng_Greek    for 148
31026>>>>>>>define lng_german     for 149
31026>>>>>>>define lng_portuguese for 155
31026>>>>>>>define lng_papiamentu for 199 // NOT TRANSLATED. DO NOT SELECT!
31026>>>>>>>
31026>>>>>>>
31026>>>>>>>define lng_default for !@
31026>>>>>>>
31026>>>>>>>  define _LANGUAGE_ for $ENGLISH$
31026>>>>>>>
#REM LANGUAGE SET BY LANGUAGE.PKG: $ENGLISH$
31026>>>>>Use Seq_Chnl    // Defines global sequential device management operations (DAC)
31026>>>>>Use Macros.utl  // Various macros (DESKTOP_SECTION)
INCLUDING FILE: MACROS.UTL
31026>>>>>>>// Use Macros.utl   // Various macros (FOR_EX...)
31026>>>>>>>
31026>>>>>>>//  FOR_EX (extended FOR command)
31026>>>>>>>//  -----------------------------
31026>>>>>>>//> The FOR_EX command is exactly like the standard FOR command except
31026>>>>>>>//> that it will allow you to use keyword "DOWN_TO" instead of "TO" if
31026>>>>>>>//> you need to do a decremental loop.
31026>>>>>>>
31026>>>>>>>
31026>>>>>>>//  DESKTOP_SECTION
31026>>>>>>>//  ---------------
31026>>>>>>>//> The DESKTOP_SECTION/END_DESKTOP_SECTION commands will make a sequence of
31026>>>>>>>//> code compile (or rather instantiate) as if it was situated on the DESKTOP
31026>>>>>>>//> even when it isn't. DESKTOP_SECTION's may not be nested.
31026>>>>>>>
31026>>>>>>>
31026>>>>>>>
31026>>>>>
31026>>>>>// Switches
31026>>>>>
31026>>>>>define DATES_INCLUDE_POPUP for 1   // If set to 0 the popup calendar will not be included
31026>>>>>define DATES_DF31B_EPOCH   for 40  // DF3.1b didn't have an epoch setting. Therefore this symbol defines the epoch value for that version.
31026>>>>>
31026>>>>> define t.calendar.year           for "Year"
31026>>>>> define t.calendar.month          for "Month"
31026>>>>> define t.calendar.day            for "Day"
31026>>>>> define t.calendar.week           for "Wk."
31026>>>>> define t.calendar.calendar_popup for "Calendar Popup"
31026>>>>> define t.calendar.Monday         for "Monday"
31026>>>>> define t.calendar.Tuesday        for "Tuesday"
31026>>>>> define t.calendar.Wednesday      for "Wednesday"
31026>>>>> define t.calendar.Thursday       for "Thursday"
31026>>>>> define t.calendar.Friday         for "Friday"
31026>>>>> define t.calendar.Saturday       for "Saturday"
31026>>>>> define t.calendar.Sunday         for "Sunday"
31026>>>>> define t.calendar.January        for "January"
31026>>>>> define t.calendar.February       for "February"
31026>>>>> define t.calendar.March          for "March"
31026>>>>> define t.calendar.April          for "April"
31026>>>>> define t.calendar.May            for "May"
31026>>>>> define t.calendar.June           for "June"
31026>>>>> define t.calendar.July           for "July"
31026>>>>> define t.calendar.August         for "August"
31026>>>>> define t.calendar.September      for "September"
31026>>>>> define t.calendar.October        for "October"
31026>>>>> define t.calendar.November       for "November"
31026>>>>> define t.calendar.December       for "December"
31026>>>>> define t.calendar.ok             for "OK"
31026>>>>> define t.calendar.Cancel         for "Cancel"
31026>>>>> define t.calendar.Activate       for "Activate popup calendar (Ctrl+D)"
31026>>>>>
31026>>>>>define LargestPossibleDate for 913490 // December 31st 2500
31026>>>>>define Jan1st1900          for 693975
31026>>>>>define Jan1st2000          for 730500
31026>>>>>define Jan1st1000          for 365250
31026>>>>>define Jan1st105           for 38352
31026>>>>>define Jan1st100           for 36525
31026>>>>>
31026>>>>>enumeration_list // Date Segments
31026>>>>>  define DS_DAY
31026>>>>>  define DS_WEEK
31026>>>>>  define DS_MONTH
31026>>>>>  define DS_YEAR
31026>>>>>end_enumeration_list
31026>>>>>
31026>>>>>integer Dates$Year Dates$Month Dates$Day // internal use
31026>>>>>
31026>>>>>procedure DateDecompose global date date# //very internal!!
31027>>>>>  local integer pos1# pos2# format#
31028>>>>>  local string str# sep#
31028>>>>>  get_attribute DF_DATE_FORMAT to format#
31031>>>>>  get_attribute DF_DATE_SEPARATOR to pos1# // overload
31034>>>>>  character pos1# to sep#                  // end overload
31035>>>>>>
31035>>>>>  move date# to str#
31036>>>>>  replace sep# in str# with "$"
31038>>>>>  move strmark to pos1#
31039>>>>>  if [found] begin
31041>>>>>    replace sep# in str# with "$"
31043>>>>>    move strmark to pos2#
31044>>>>>  end
31044>>>>>>
31044>>>>>  else begin
31045>>>>>    move 0 to Dates$Year
31046>>>>>    move 0 to Dates$Month
31047>>>>>    move 0 to Dates$Day
31048>>>>>  end
31048>>>>>>
31048>>>>>  [ found] begin
31050>>>>>>
31050>>>>>    if format# eq DF_DATE_EUROPEAN ;          left str# to Dates$Day    (pos1#-1)
31054>>>>>    if format# eq DF_DATE_USA begin
31056>>>>>          mid  str# to Dates$Day    (pos2#-pos1#-1) (pos1#+1)
31059>>>>>>
31059>>>>>          left str# to Dates$Month  (pos1#-1)
31061>>>>>>
31061>>>>>    end
31061>>>>>>
31061>>>>>    else  mid  str# to Dates$Month  (pos2#-pos1#-1) (pos1#+1)
31065>>>>>
31065>>>>>    if format# eq DF_DATE_MILITARY begin
31067>>>>>          mid  str# to Dates$Day  2 (pos2#+1)
31070>>>>>>
31070>>>>>          left str# to Dates$Year   (pos1#-1)
31072>>>>>>
31072>>>>>    end
31072>>>>>>
31072>>>>>    else  mid  str# to Dates$Year 4 (pos2#+1)
31076>>>>>  end
31076>>>>>>
31076>>>>>end_procedure
31077>>>>>
31077>>>>>function DateCompose global integer day# integer month# integer year# returns date
31078>>>>>  local integer format#
31079>>>>>  local date date#
31079>>>>>  local string sep#
31079>>>>>  ifnot (day#*month#*year#) function_return 0
31082>>>>>  get_attribute DF_DATE_SEPARATOR to format# // overload
31085>>>>>  character format# to sep#                  // end overload
31086>>>>>>
31086>>>>>  get_attribute DF_DATE_FORMAT to format#
31089>>>>>  if day# gt 28 begin
31091>>>>>    if format# eq DF_DATE_EUROPEAN move (date(string(day#)+sep#+string(month#)+sep#+string(year#))) to date# // DMY
31094>>>>>    if format# eq DF_DATE_USA      move (date(string(month#)+sep#+string(day#)+sep#+string(year#))) to date# // MDY
31097>>>>>    if format# eq DF_DATE_MILITARY move (date(string(year#)+sep#+string(month#)+sep#+string(day#))) to date# // YMD
31100>>>>>    send DateDecompose date#
31101>>>>>    if Dates$Month ne month# move (day#-Dates$Day) to day#
31104>>>>>  end
31104>>>>>>
31104>>>>>  if format# eq DF_DATE_EUROPEAN function_return (date(string(day#)+sep#+string(month#)+sep#+string(year#))) // DMY
31107>>>>>  if format# eq DF_DATE_USA function_return (date(string(month#)+sep#+string(day#)+sep#+string(year#))) // MDY
31110>>>>>  function_return (date(string(year#)+sep#+string(month#)+sep#+string(day#))) // YMD
31111>>>>>end_function
31112>>>>>
31112>>>>>function DateFormatName global integer format# returns string
31113>>>>>  if format# eq DF_DATE_EUROPEAN function_return "European"
31116>>>>>  if format# eq DF_DATE_USA      function_return "United States"
31119>>>>>  if format# eq DF_DATE_MILITARY function_return "Military"
31122>>>>>end_function
31123>>>>>
31123>>>>>function DateCurrentSeparator global returns string
31124>>>>>  local integer rval#
31125>>>>>  get_attribute DF_DATE_SEPARATOR to rval#
31128>>>>>  function_return (character(rval#))
31129>>>>>end_function
31130>>>>>
31130>>>>>function DateCurrentFormat global returns integer
31131>>>>>  local integer rval#
31132>>>>>  get_attribute DF_DATE_FORMAT to rval#
31135>>>>>  function_return rval#
31136>>>>>end_function
31137>>>>>
31137>>>>>function DateFormatAsString global integer format# integer long# string sep# returns string
31138>>>>>  local string rval# letter#
31139>>>>>  if format# eq DF_DATE_EUROPEAN move "3342241111" to rval#
31142>>>>>  if format# eq DF_DATE_USA      move "2243341111" to rval#
31145>>>>>  if format# eq DF_DATE_MILITARY move "1111422433" to rval#
31148>>>>>  left t.calendar.year to letter# 1
31150>>>>>>
31150>>>>>  replace "1" in rval# with letter#
31152>>>>>  replace "1" in rval# with letter#
31154>>>>>  ifnot long# move "" to letter#
31157>>>>>  move (replaces("1",rval#,letter#)) to rval#
31158>>>>>  move (replaces("2",rval#,left(t.calendar.month,1))) to rval#
31159>>>>>  move (replaces("3",rval#,left(t.calendar.day,1))) to rval#
31160>>>>>  if sep# eq "" begin
31162>>>>>    get_attribute DF_DATE_SEPARATOR to format#
31165>>>>>    character format# to sep#
31166>>>>>>
31166>>>>>  end
31166>>>>>>
31166>>>>>  move (replaces("4",rval#,sep#)) to rval#
31167>>>>>  function_return rval#
31168>>>>>end_function
31169>>>>>
31169>>>>>function StringToDate global string date# integer format# integer four_digit_year# string sep# returns date
31170>>>>>  local integer sep_len# day# month# year#
31171>>>>>  move (length(sep#)) to sep_len#
31172>>>>>  if four_digit_year# move 4 to four_digit_year#
31175>>>>>  else move 2 to four_digit_year#
31177>>>>>  if format# eq DF_DATE_EUROPEAN begin // DMY
31179>>>>>    move (mid(date#,2,1)) to day#
31180>>>>>    move (mid(date#,2,3+sep_len#)) to month#
31181>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31182>>>>>  end
31182>>>>>>
31182>>>>>  if format# eq DF_DATE_USA begin // MDY
31184>>>>>    move (mid(date#,2,1)) to month#
31185>>>>>    move (mid(date#,2,3+sep_len#)) to year#
31186>>>>>    move (mid(date#,four_digit_year#,5+sep_len#+sep_len#)) to year#
31187>>>>>  end
31187>>>>>>
31187>>>>>  if format# eq DF_DATE_MILITARY begin // YMD
31189>>>>>    move (mid(date#,four_digit_year#,1)) to year#
31190>>>>>    move (mid(date#,2,1+four_digit_year#+sep_len#)) to month#
31191>>>>>    move (mid(date#,2,3+four_digit_year#+sep_len#+sep_len#)) to day#
31192>>>>>  end
31192>>>>>>
31192>>>>>  function_return (DateCompose(day#,month#,year#))
31193>>>>>end_function
31194>>>>>
31194>>>>>function DateToString global date date# integer format# integer four_digit_year# string sep# returns string
31195>>>>>  local string rval# day# month# year#
31196>>>>>  get Date2to4 date# to date#
31197>>>>>  if (integer(date#)) begin
31199>>>>>    send DateDecompose date#
31200>>>>>    move Dates$Day to day#
31201>>>>>    if Dates$Day lt 10 insert "0" in day# at 1
31205>>>>>    move Dates$Month to month#
31206>>>>>    if Dates$Month lt 10 insert "0" in month# at 1
31210>>>>>    move Dates$Year to year#
31211>>>>>    ifnot four_digit_year# move (right(year#,2)) to year#
31214>>>>>    if format# eq DF_DATE_EUROPEAN move (day#+sep#+month#+sep#+year#) to rval# // DMY
31217>>>>>    if format# eq DF_DATE_USA      move (month#+sep#+day#+sep#+year#) to rval# // MDY
31220>>>>>    if format# eq DF_DATE_MILITARY move (year#+sep#+month#+sep#+day#) to rval# // YMD
31223>>>>>  end
31223>>>>>>
31223>>>>>  function_return rval#
31224>>>>>end_function
31225>>>>>
31225>>>>>// Function DateAsString is only here for compatibility with earlier versions.
31225>>>>>// Use function DateToString instead.
31225>>>>>function DateAsString global date date# integer format# integer four_digit_year# string sep# returns string
31226>>>>>  function_return (DateToString(date#,format#,four_digit_year#,sep#))
31227>>>>>end_function
31228>>>>>
31228>>>>>function DateIncrement global date date# integer segment# integer amount# returns date
31229>>>>>  if (date#=0) function_return 0
31232>>>>>  if segment# eq DS_WEEK function_return (date#+(amount#*7)) //weeks
31235>>>>>  if (segment#<>DS_DAY) begin // months or years
31237>>>>>    send DateDecompose date#
31238>>>>>    if segment# eq DS_MONTH begin //months
31240>>>>>      move (Dates$Month+amount#) to Dates$Month
31241>>>>>      if amount# ge 0 function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-1)/12)*12),Dates$Year+((Dates$Month-1)/12)))
31244>>>>>      function_return (DateCompose(Dates$Day,Dates$Month-(((Dates$Month-12)/12)*12),Dates$Year+((Dates$Month-12)/12)))
31245>>>>>    end //years:
31245>>>>>>
31245>>>>>    if segment# eq DS_YEAR function_return (DateCompose(Dates$Day,Dates$Month,Dates$Year+amount#))
31248>>>>>  end
31248>>>>>>
31248>>>>>  else function_return (date#+amount#) //days
31250>>>>>end_function
31251>>>>>
31251>>>>>function DateSegment global date date# integer segment# returns integer
31252>>>>>  send DateDecompose date#
31253>>>>>  if segment# eq DS_DAY   function_return Dates$Day
31256>>>>>  if segment# eq DS_MONTH function_return Dates$Month
31259>>>>>  if segment# eq DS_YEAR  function_return Dates$Year
31262>>>>>end_function
31263>>>>>
31263>>>>>function DateToInteger global date date# returns integer
31264>>>>>  send DateDecompose date#
31265>>>>>  function_return (Dates$Year*100+Dates$Month*100+Dates$Day)
31266>>>>>end_function
31267>>>>>
31267>>>>>function FirstDayInMonth global date date# returns date
31268>>>>>  local integer month# year#
31269>>>>>  move (DateSegment(date#,DS_MONTH)) to month#
31270>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31271>>>>>  function_return (DateCompose(1,month#,year#))
31272>>>>>end_function
31273>>>>>
31273>>>>>function LastDayInMonth global date date# returns date
31274>>>>>  move (DateIncrement(date#,DS_MONTH,1)) to date#
31275>>>>>  function_return (FirstDayInMonth(date#)-1)
31276>>>>>end_function
31277>>>>>
31277>>>>>function FirstDayInYear global date date# returns date
31278>>>>>  local integer year#
31279>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31280>>>>>  function_return (DateCompose(1,1,year#))
31281>>>>>end_function
31282>>>>>
31282>>>>>function LastDayInYear global date date# returns date
31283>>>>>  move (DateIncrement(date#,DS_YEAR,1)) to date#
31284>>>>>  function_return (FirstDayInYear(date#)-1)
31285>>>>>end_function
31286>>>>>
31286>>>>>// Prior to 18/1-99 version of DateWeekNumber
31286>>>>>//function DateWeekNumber global date date# returns integer
31286>>>>>//  local integer week# first_wd# day_of_year# year#
31286>>>>>//  if (date#=0) function_return 0
31286>>>>>//  get Date2to4 date# to date#
31286>>>>>//  move (DateSegment(date#,DS_YEAR)) to year#
31286>>>>>//  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31286>>>>>//  move (date#-FirstDayInYear(date#)) to day_of_year#
31286>>>>>//  move (day_of_year#-1-7+first_wd#) to day_of_year#
31286>>>>>//  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31286>>>>>//  else move 0 to week#
31286>>>>>//  if first_wd# le 4 increment week#
31286>>>>>//  if week# gt 52 begin
31286>>>>>//    move 1 to week#
31286>>>>>//    if first_wd# eq 4 move 53 to week#
31286>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31286>>>>>//  end
31286>>>>>//  if week# eq 0 begin
31286>>>>>//    //get DateWeekNumber (DateIncrement(date#,DS_YEAR,-1)) to first_wd# // Original line
31286>>>>>//    get DateDayNumber  (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#ÿ // changed line
31286>>>>>//    move 52 to week#
31286>>>>>//    if first_wd# eq 4 move 53 to week#
31286>>>>>//    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31286>>>>>//  end
31286>>>>>//  function_return week#
31286>>>>>//end_function
31286>>>>>
31286>>>>>function DateWeekNumber global date date# returns integer
31287>>>>>  local integer week# first_wd# day_of_year# year# wd#
31288>>>>>  if (date#=0) function_return 0
31291>>>>>  get Date2to4 date# to date#
31292>>>>>  // Leap-year test for actual or previous year
31292>>>>>  // Year# only used for selection between 52 and
31292>>>>>  // Therefore get year# from the first day of actual week
31292>>>>>  get DateDayNumber date# to wd#
31293>>>>>  move (DateSegment(date#-wd#+1,DS_YEAR)) to year#
31294>>>>>
31294>>>>>  get DateDayNumber (FirstDayInYear(date#)) to first_wd#
31295>>>>>  move (date#-FirstDayInYear(date#)) to day_of_year#
31296>>>>>  move (day_of_year#-1-7+first_wd#) to day_of_year#
31297>>>>>  if (day_of_year#/7.0) ge 0 move (day_of_year#/7+1) to week#
31300>>>>>  else move 0 to week#
31302>>>>>  if first_wd# le 4 increment week#
31305>>>>>  if week# gt 52 begin
31307>>>>>    move 1 to week#
31308>>>>>    if first_wd# eq 4 move 53 to week#
31311>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq year# ifnot ((year#/100)*100) eq year# move 53 to week#
31318>>>>>  end
31318>>>>>>
31318>>>>>  if week# eq 0 begin
31320>>>>>    // Week 52 or 53
31320>>>>>    get DateDayNumber (DateIncrement(FirstDayInYear(date#),DS_YEAR,-1)) to first_wd#
31321>>>>>    move 52 to week#
31322>>>>>    if first_wd# eq 4 move 53 to week#
31325>>>>>    if first_wd# eq 3 if ((year#/4)*4) eq Year# ifnot ((Year#/100)*100) eq Year# move 53 to week#
31332>>>>>  end
31332>>>>>>
31332>>>>>  function_return week#
31333>>>>>end_function
31334>>>>>
31334>>>>>function DayName global integer int# returns string
31335>>>>>  if int# eq 1 function_return t.calendar.Monday
31338>>>>>  if int# eq 2 function_return t.calendar.Tuesday
31341>>>>>  if int# eq 3 function_return t.calendar.Wednesday
31344>>>>>  if int# eq 4 function_return t.calendar.Thursday
31347>>>>>  if int# eq 5 function_return t.calendar.Friday
31350>>>>>  if int# eq 6 function_return t.calendar.Saturday
31353>>>>>  if int# eq 7 function_return t.calendar.Sunday
31356>>>>>  function_return ""
31357>>>>>end_function
31358>>>>>
31358>>>>>function DateDayNumber global date date# returns integer
31359>>>>>  local integer rval# // 1=Monday, ... , 7=Sunday
31360>>>>>  get Date2to4 date# to date#
31361>>>>>  move date# to rval#
31362>>>>>  if rval# begin
31364>>>>>    if rval# gt 693975 move (rval#-2) to rval#
31367>>>>>    move (rval#-((rval#/7)*7)) to rval#
31368>>>>>    if rval# eq 0 move 7 to rval#
31371>>>>>  end
31371>>>>>>
31371>>>>>  function_return rval#
31372>>>>>end_function
31373>>>>>
31373>>>>>function DateDayName global date date# returns string
31374>>>>>  function_return (DayName(DateDayNumber(date#)))
31375>>>>>end_function
31376>>>>>
31376>>>>>function YearMaxWeek global integer year# returns integer
31377>>>>>  local integer wk1# wk2#
31378>>>>>  get DateWeekNumber (DateCompose(31,12,year#)) to wk1#
31379>>>>>  get DateWeekNumber (DateCompose(24,12,year#)) to wk2#
31380>>>>>  function_return (wk1# max wk2#)
31381>>>>>end_function
31382>>>>>
31382>>>>>function WeekToDate global integer year# integer week# returns date
31383>>>>>  local date date#
31384>>>>>  move (DateCompose(1,1,year#)) to date#
31385>>>>>  if (DateWeekNumber(date#)) ne 1 move (date#+7) to date# // week 52 or 53
31388>>>>>  move (date#-DateDayNumber(date#)+1) to date# // Now it's a Monday
31389>>>>>  function_return (week#-1*7+date#)
31390>>>>>end_function
31391>>>>>
31391>>>>>function MonthName global integer int# returns string
31392>>>>>  if int# eq  1 function_return t.calendar.January
31395>>>>>  if int# eq  2 function_return t.calendar.February
31398>>>>>  if int# eq  3 function_return t.calendar.March
31401>>>>>  if int# eq  4 function_return t.calendar.April
31404>>>>>  if int# eq  5 function_return t.calendar.May
31407>>>>>  if int# eq  6 function_return t.calendar.June
31410>>>>>  if int# eq  7 function_return t.calendar.July
31413>>>>>  if int# eq  8 function_return t.calendar.August
31416>>>>>  if int# eq  9 function_return t.calendar.September
31419>>>>>  if int# eq 10 function_return t.calendar.October
31422>>>>>  if int# eq 11 function_return t.calendar.November
31425>>>>>  if int# eq 12 function_return t.calendar.December
31428>>>>>  function_return ""
31429>>>>>end_function
31430>>>>>
31430>>>>>function DateMonthName global date date# returns string
31431>>>>>  function_return (MonthName(DateSegment(date#,DS_MONTH)))
31432>>>>>end_function
31433>>>>>
31433>>>>>function DateAsText global date date# string format# returns string
31434>>>>>  if date# eq 0 function_return ""
31437>>>>>  move (replace("#DN",format#,DateDayName(date#)))                  to format#
31438>>>>>  move (replace("#MN",format#,DateMonthName(date#)))                to format#
31439>>>>>  move (replace("#D" ,format#,string(DateSegment(date#,DS_DAY))))   to format#
31440>>>>>  move (replace("#Y" ,format#,string(DateSegment(date#,DS_YEAR))))  to format#
31441>>>>>  move (replace("#M" ,format#,string(DateSegment(date#,DS_MONTH)))) to format#
31442>>>>>  function_return format#
31443>>>>>end_function
31444>>>>>
31444>>>>>function Year2to4 global integer year# returns integer
31445>>>>>  local integer epoch_value#
31446>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31447>>>>>  if year# lt 100 begin
31449>>>>>    if year# gt epoch_value# function_return (year#+1900)
31452>>>>>    function_return (year#+2000)
31453>>>>>  end
31453>>>>>>
31453>>>>>  function_return year# // No conversion done!
31454>>>>>end_function
31455>>>>>
31455>>>>>function Date2to4 global date date# returns date
31456>>>>>  local integer epoch_value#
31457>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31458>>>>>  if date# gt 0 begin // Only if there is a date to convert
31460>>>>>    if (DateSegment(date#,DS_YEAR)) lt 105 begin
31462>>>>>      if Dates$Year gt epoch_value# function_return (DateIncrement(date#,DS_YEAR,1900))
31465>>>>>      function_return (DateIncrement(date#,DS_YEAR,2000))
31466>>>>>    end
31466>>>>>>
31466>>>>>    function_return date# // No conversion done!
31467>>>>>  end
31467>>>>>>
31467>>>>>end_function
31468>>>>>
31468>>>>>function Date4to2 global date date# returns date
31469>>>>>  local integer epoch_value# year#
31470>>>>>   get_date_attribute EPOCH_VALUE to epoch_value#
31471>>>>>  if date# gt 0 begin // Only if there is a date to convert
31473>>>>>    move (DateSegment(date#,DS_YEAR)) to year#
31474>>>>>    if year# ge 100 begin // Only then conversion is needed!
31476>>>>>      if (year#>=(1900+epoch_value#) and year#<(2000+epoch_value#)) begin
31478>>>>>        if year# lt 2000 function_return (DateIncrement(date#,DS_YEAR,-1900))
31481>>>>>        else             function_return (DateIncrement(date#,DS_YEAR,-2000))
31483>>>>>      end
31483>>>>>>
31483>>>>>      else error 301 "Date is out of epoch range"
31485>>>>>    end
31485>>>>>>
31485>>>>>  end
31485>>>>>>
31485>>>>>  function_return date# // No conversion done!
31486>>>>>end_function
31487>>>>>
31487>>>>>function dSysDate global returns date
31488>>>>>  local date date#
31489>>>>>  sysdate4 date#
31490>>>>>  function_return date#
31491>>>>>end_function
31492>>>>>
31492>>>>>function iSysYear global returns integer
31493>>>>>  local date date#
31494>>>>>  sysdate4 date#
31495>>>>>  function_return (DateSegment(date#,DS_YEAR))
31496>>>>>end_function
31497>>>>>
31497>>>>>procedure ItemSysdate for desktop integer itm#
31498>>>>>  local date date#
31499>>>>>  get value item itm# to date#
31500>>>>>  if date# eq 0 begin
31502>>>>>    sysdate4 date#
31503>>>>>    set changed_value item itm# to date#
31504>>>>>  end
31504>>>>>>
31504>>>>>end_procedure
31505>>>>>
31505>>>>>procedure ItemDate2to4 for desktop integer itm#
31506>>>>>  local integer year#
31507>>>>>  local date date# new_date#
31507>>>>>  get value item itm# to date#
31508>>>>>
31508>>>>>  move (DateSegment(date#,DS_YEAR)) to year#
31509>>>>>  if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31512>>>>>  else move date# to new_date#
31514>>>>>
31514>>>>>  move (Date2to4(new_date#)) to new_date#
31515>>>>>  move (DateSegment(new_date#,3)) to year#
31516>>>>>  if (year#>99 and year#<1000) begin
31518>>>>>    error 15 // Illegal entry in this window
31519>>>>>>
31519>>>>>    procedure_return 1
31520>>>>>  end
31520>>>>>>
31520>>>>>  if new_date# ne date# set value item itm# to new_date#
31523>>>>>end_procedure
31524>>>>>
31524>>>>>procedure ItemYear2to4 for desktop integer itm#
31525>>>>>  local integer year# new_year#
31526>>>>>  get value item itm# to year#
31527>>>>>  if (year#>99 and year#<1000) begin
31529>>>>>    error 15 // Illegal entry in this window
31530>>>>>>
31530>>>>>    procedure_return 1
31531>>>>>  end
31531>>>>>>
31531>>>>>  move (Year2to4(year#)) to new_year#
31532>>>>>  if new_year# ne year# set value item itm# to new_year#
31535>>>>>end_procedure
31536>>>>>
31536>>>>> procedure FieldSysdate for DataDictionary integer fld#
31537>>>>>   local date date#
31538>>>>>   get field_current_value fld# to date#
31539>>>>>   if date# eq 0 begin
31541>>>>>     sysdate4 date#
31542>>>>>     set field_changed_value fld# to date#
31543>>>>>   end
31543>>>>>>
31543>>>>> end_procedure
31544>>>>>
31544>>>>> procedure FieldDate2to4 for DataDictionary integer fld#
31545>>>>>   local integer year#
31546>>>>>   local date date# new_date#
31546>>>>>   get field_current_value fld# to date#
31547>>>>>
31547>>>>>   move (DateSegment(date#,DS_YEAR)) to year#
31548>>>>>   if (year#=0 and date#<>0) move (DateIncrement(date#,3,iSysYear())) to new_date#
31551>>>>>   else move date# to new_date#
31553>>>>>
31553>>>>>   move (Date2to4(new_date#)) to new_date#
31554>>>>>   move (DateSegment(new_date#,3)) to year#
31555>>>>>   if (year#>99 and year# <=999) begin
31557>>>>>     error 15 // Illegal entry in this window
31558>>>>>>
31558>>>>>     procedure_return 1
31559>>>>>   end
31559>>>>>>
31559>>>>>   if new_date# ne date# set field_changed_value fld# to new_date#
31562>>>>> end_procedure
31563>>>>>
31563>>>>> procedure FieldYear2to4 for DataDictionary integer fld#
31564>>>>>   local integer year# new_year# changed#
31565>>>>>   get field_current_value fld# to year#
31566>>>>>   get field_changed_state fld# to changed#
31567>>>>>   if changed# begin
31569>>>>>     if (year#>99 and year#<1000) begin
31571>>>>>       error 15 // Illegal entry in this window
31572>>>>>>
31572>>>>>       procedure_return 1
31573>>>>>     end
31573>>>>>>
31573>>>>>     move (Year2to4(year#)) to new_year#
31574>>>>>     if new_year# ne year# set field_changed_value fld# to new_year#
31577>>>>>   end
31577>>>>>>
31577>>>>> end_procedure
31578>>>>>
31578>>>>> function SysDate global returns date
31579>>>>>   function_return (dSysDate())
31580>>>>> end_function
31581>>>>>
31581>>>>>function sSysTime global returns string
31582>>>>>  local integer h# m# s#
31583>>>>>  sysdate4 h# h# m# s#
31587>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31588>>>>>end_function
31589>>>>>
31589>>>>>function TS_SysTime global returns number
31590>>>>>  local integer d# h# m# s#
31591>>>>>  sysdate4 d# h# m# s#
31595>>>>>  function_return (d#*24.0+h#*60+m#*60+s#)
31596>>>>>end_function
31597>>>>>
31597>>>>>//> This function returns a TS value composed from the date and time
31597>>>>>//> passed to it. Note that the time variable must be of the format
31597>>>>>//> "hh:mm:ss".
31597>>>>>function TS_Compose global date date# string time# returns number
31598>>>>>  local integer h# m# s#
31599>>>>>  left time# to h# 2
31601>>>>>>
31601>>>>>  mid time# to m# 2 4
31604>>>>>>
31604>>>>>  mid time# to s# 2 7
31607>>>>>>
31607>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31608>>>>>end_function
31609>>>>>
31609>>>>>function TS_Compose2 global date date# integer h# integer m# integer s# returns number
31610>>>>>  function_return (integer(date#)*24.0+h#*60+m#*60+s#)
31611>>>>>end_function
31612>>>>>
31612>>>>>function TS_ExtractDate global number time# returns date
31613>>>>>  function_return (time#/86400) // 86400=24*60*60
31614>>>>>end_function
31615>>>>>
31615>>>>>function TS_ExtractTime global number time# returns string
31616>>>>>  local integer h# m# s#
31617>>>>>  move (time#-(86400.0*integer(TS_ExtractDate(time#)))) to s#
31618>>>>>  move (s#/3600) to h#
31619>>>>>  move (s#-(h#*3600)) to s#
31620>>>>>  move (s#/60) to m#
31621>>>>>  move (s#-(m#*60)) to s#
31622>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(s#<10,"0","")+string(s#))
31623>>>>>end_function
31624>>>>>
31624>>>>>function TS_ConvertToString global number time# returns string
31625>>>>>  local date d#
31626>>>>>  move (TS_ExtractDate(time#)) to d#
31627>>>>>  if (integer(d#)) function_return (string(d#)+" "+TS_ExtractTime(time#))
31630>>>>>  else function_return (TS_ExtractTime(time#))
31632>>>>>end_function
31633>>>>>
31633>>>>>function TS_ConvertToStringNoDate global number ts# returns string
31634>>>>>  local integer h# m#
31635>>>>>  move (ts#/3600) to h#
31636>>>>>  move (ts#-(h#*3600)) to ts#
31637>>>>>  move (ts#/60) to m#
31638>>>>>  move (ts#-(m#*60)) to ts#
31639>>>>>  function_return (if(h#<10,"0","")+string(h#)+":"+if(m#<10,"0","")+string(m#)+":"+if(ts#<10,"0","")+string(ts#))
31640>>>>>end_function
31641>>>>>
31641>>>>>// This procedure is used when a TS-variable must be displayed on screen.
31641>>>>>procedure TS_UI_Update global number TS# integer obj1# integer itm1# integer tmp_obj2# integer tmp_itm2#
31642>>>>>  local integer obj2# itm2#
31643>>>>>  if num_arguments gt 3 begin
31645>>>>>    move tmp_obj2# to obj2#
31646>>>>>    move tmp_itm2# to itm2#
31647>>>>>  end
31647>>>>>>
31647>>>>>  else begin
31648>>>>>    move obj1# to obj2#
31649>>>>>    move (itm1#+1) to itm2#
31650>>>>>  end
31650>>>>>>
31650>>>>>  set value of obj1# item itm1# to (TS_ExtractDate(TS#))
31651>>>>>  set value of obj2# item itm2# to (TS_ExtractTime(TS#))
31652>>>>>end_procedure
31653>>>>>
31653>>>>>class TS_TimeEstimator is an array
31654>>>>>  procedure construct_object
31655>>>>>    forward send construct_object
31657>>>>>    set delegation_mode to delegate_to_parent
31658>>>>>    property number  pnTotal   public 0 // Seconds needed to run the loop.
31659>>>>>    property number  pnElapsed public 0 // Seconds elapsed so far.
31660>>>>>    property number  pnLeft    public 0 // Number of seconds left
31661>>>>>    property number  pnStart   public 0
31662>>>>>    property number  pnPause   public 0
31663>>>>>    property number  pnPercent public 0
31664>>>>>    property integer piMin     public 0
31665>>>>>    property integer piMax     public 0
31666>>>>>  end_procedure
31667>>>>>
31667>>>>>  procedure TS_Start integer min# integer max#
31668>>>>>    set piMin to min#
31669>>>>>    set piMax to max#
31670>>>>>    set pnStart to (TS_SysTime())
31671>>>>>    set pnElapsed to 0
31672>>>>>    set pnPercent to 0
31673>>>>>  end_procedure
31674>>>>>
31674>>>>>  procedure TS_Calculate integer pos#
31675>>>>>    local integer min# max#
31676>>>>>    get piMin to min#
31677>>>>>    get piMax to max#
31678>>>>>    set pnElapsed to (TS_SysTime()-pnStart(current_object))
31679>>>>>    set pnTotal   to (pnElapsed(current_object)*(max#-min#)/number(pos#-min#))
31680>>>>>    set pnLeft    to (pnTotal(current_object)-pnElapsed(current_object))
31681>>>>>    set pnPercent to (100.0*(pos#-min#)/(max#-min#))
31682>>>>>  end_procedure
31683>>>>>
31683>>>>>  procedure TS_Pause
31684>>>>>    set pnPause to (TS_SysTime())
31685>>>>>  end_procedure
31686>>>>>
31686>>>>>  procedure TS_Continue
31687>>>>>    set pnStart to (pnStart(current_object)+TS_SysTime()-pnPause(current_object))
31688>>>>>  end_procedure
31689>>>>>end_class
31690>>>>>
31690>>>>>function TS_Module_Compile_Time global string path# returns number
31691>>>>>  local integer pos# day# month# year# seqeof# ch#
31692>>>>>  local string date# str# time#
31692>>>>>  move path# to str#
31693>>>>>  if str# ne "" begin
31695>>>>>    get Seq_New_Channel to ch#   // This method and Seq_Release_Channel are
31696>>>>>    send Seq_Release_Channel ch# // We only need it for a second
31697>>>>>      direct_input channel ch# (trim(str#)+".vd6") // VDF 6
31699>>>>>      [seqeof] direct_input channel ch# (trim(str#)+".vd5") // VDF 5
31701>>>>>    [ seqeof] move 1 to seqeof#
31702>>>>>    [~seqeof] move 0 to seqeof#
31703>>>>>    [~seqeof] readln str#
31704>>>>>    close_input channel ch#
31706>>>>>  end
31706>>>>>>
31706>>>>>  if seqeof# function_return 0
31709>>>>>  pos "," in str# to pos#
31711>>>>>>
31711>>>>>  move (mid(str#,18,pos#+2)) to str#
31712>>>>>  move (integer(mid(str#,2,4))) to day#
31713>>>>>  move (integer(mid(str#,2,1))) to month#
31714>>>>>  move (integer(mid(str#,2,7))) to year#
31715>>>>>  if year# eq 10 begin
31717>>>>>    move (integer(mid(str#,3,7))+1900) to year#
31718>>>>>    move (mid(str#,8,11)) to str#
31719>>>>>  end
31719>>>>>>
31719>>>>>  else move (mid(str#,8,10)) to str#
31721>>>>>  move (DateCompose(day#,month#,year#)) to date#
31722>>>>>  move (Date2to4(date#)) to date#
31723>>>>>  pos ":" in str# to pos#
31725>>>>>>
31725>>>>>  function_return (TS_Compose(date#,mid(str#,8,pos#-2)))
31726>>>>>end_function
31727>>>>>
31727>>>>>string Dates$Module_Compile_Time
31727>>>>>move "" to Dates$Module_Compile_Time
31728>>>>>
31728>>>>>function Module_Compile_Date global returns date
31729>>>>>  local number ts#
31730>>>>>  local string str#
31730>>>>>  get module_name to str# // 'module_name' is most likely the name of the .flx file.
31731>>>>>  get TS_Module_Compile_Time str# to ts#
31732>>>>>  move (TS_ExtractTime(ts#)) to Dates$Module_Compile_Time
31733>>>>>  function_return (TS_ExtractDate(ts#))
31734>>>>>end_function
31735>>>>>
31735>>>>>function Module_Compile_Time global returns string
31736>>>>>  local date grb#
31737>>>>>  // Module_Compile_Date must be called before this one!
31737>>>>>  if Dates$Module_Compile_Time eq "" move (Module_Compile_Date()) to grb#
31740>>>>>  function_return Dates$Module_Compile_Time
31741>>>>>end_function
31742>>>>>
31742>>>>>date   Dates$ModuleStartDate
31742>>>>>string Dates$ModuleStartTime 8
31742>>>>>move (dSysDate()) to Dates$ModuleStartDate
31743>>>>>move (sSysTime()) to Dates$ModuleStartTime
31744>>>>>
31744>>>>>function Module_Start_Date global returns date
31745>>>>>  function_return Dates$ModuleStartDate
31746>>>>>end_function
31747>>>>>
31747>>>>>function Module_Start_Time global returns string
31748>>>>>  function_return Dates$ModuleStartTime
31749>>>>>end_function
31750>>>>>
31750>>>>> register_procedure NotifyPopupCalendarChange date date#
31750>>>>> register_procedure NotifyPopupCalendarSelect date date#
31750>>>>>  use dfAllent
31750>>>>>  class calendar.textbox is a textbox
31751>>>>>    procedure construct_object
31752>>>>>      forward send construct_object
31754>>>>>      Set Auto_Size_State To False
31755>>>>>      Set Justification_Mode To (jMode_vCenter+jMode_Center)
31756>>>>>    end_procedure
31757>>>>>  end_class
31758>>>>>
31758>>>>>  register_object btn1
31758>>>>>  register_object btn6
31758>>>>>
31758>>>>>  class calendar.button is a button
31759>>>>>
31759>>>>>    procedure construct_object
31760>>>>>      forward send construct_object
31762>>>>>      set size to 15 18
31763>>>>>      on_key kleftarrow   send prev_day
31764>>>>>      on_key krightarrow  send next_day
31765>>>>>      on_key kuparrow     send prev_week
31766>>>>>      on_key kdownarrow   send next_week
31767>>>>>      property date p_assigned_date public 0
31768>>>>>    end_procedure
31769>>>>>
31769>>>>>    procedure switch // This makes all 42 buttons act as if they are one focus
31770>>>>>      send activate to (btn1(current_object))
31771>>>>>    end_procedure
31772>>>>>    procedure switch_back
31773>>>>>      send activate to (btn6(current_object))
31774>>>>>    end_procedure
31775>>>>>
31775>>>>>    procedure mouse_down
31776>>>>>      local integer current_object#
31777>>>>>      forward send mouse_down
31779>>>>>      move current_object to current_object#
31780>>>>>      delegate set p_current_date to (p_assigned_date(current_object#))
31782>>>>>    end_procedure
31783>>>>>  end_class
31784>>>>>
31784>>>>>  desktop_section
31790>>>>>    object popup_calendar is a ModalPanel
31792>>>>>      set size to 160 250
31793>>>>>      property date    p_current_date  public 0
31795>>>>>      property integer p_current_year  public -1
31797>>>>>      property integer p_current_month public -1
31799>>>>>      property integer pExportState    public 1
31801>>>>>
31801>>>>>      on_key key_ctrl+key_pgup send prev_year
31802>>>>>      on_key key_ctrl+key_pgdn send next_year
31803>>>>>      on_key          key_pgup send prev_month
31804>>>>>      on_key          key_pgdn send next_month
31805>>>>>      on_key key_ctrl+key_d    send go_today
31806>>>>>      on_key kcancel           send cancel
31807>>>>>
31807>>>>>      object cont3d is a container3d
31809>>>>>        set location to 5 5
31810>>>>>        set size to 120 237
31811>>>>>        object textbox_year is a calendar.textbox
31813>>>>>          set location to 5 5
31814>>>>>          set size to 15 30
31815>>>>>          set border_style to border_staticedge
31816>>>>>          procedure display
31818>>>>>            set value to (p_current_year(current_object))
31819>>>>>          end_procedure
31820>>>>>        end_object
31821>>>>>        object dayname_header is a container3d
31823>>>>>          set location to 5 39
31824>>>>>          set size to 15 126
31825>>>>>          set border_style to border_staticedge
31826>>>>>          procedure initialize
31828>>>>>            local integer itm#
31829>>>>>            for itm# from 0 to 6
31835>>>>>>
31835>>>>>              object txt is a calendar.textbox
31837>>>>>                set size to 12 17
31838>>>>>                set location to 0 (itm#*17.6+1)
31839>>>>>                 set value to (left(DayName(itm#+1),3))
31840>>>>>              end_object
31841>>>>>            loop
31842>>>>>>
31842>>>>>          end_procedure
31843>>>>>          send initialize
31844>>>>>        end_object
31845>>>>>        object weeknumber_header is a container3d
31847>>>>>          set location to 24 5
31848>>>>>          set size     to 89 30
31849>>>>>          set border_style to border_staticedge
31850>>>>>          object obj_id_array is an array
31852>>>>>          end_object
31853>>>>>          procedure initialize
31855>>>>>            local integer itm# obj#
31856>>>>>            move (obj_id_array(current_object)) to obj#
31857>>>>>            for itm# from 0 to 5
31863>>>>>>
31863>>>>>              object txt is a textbox
31865>>>>>                set size to 15 30
31866>>>>>                set location to (itm#*15+1) 1
31867>>>>>                set value of obj# item (item_count(obj#)) to current_object
31868>>>>>              end_object
31869>>>>>            loop
31870>>>>>>
31870>>>>>          end_procedure
31871>>>>>          procedure display
31873>>>>>            local integer itm# obj#
31874>>>>>            local date date# last_date#
31874>>>>>            move (obj_id_array(current_object)) to obj#
31875>>>>>            get p_current_date to date#
31876>>>>>            move (FirstDayInMonth(date#)) to date#
31877>>>>>            move (LastDayInMonth(date#)) to last_date#
31878>>>>>            move (date#-DateDayNumber(date#)+1) to date#
31879>>>>>            for itm# from 0 to 5
31885>>>>>>
31885>>>>>              if (itm#*7+date#) le last_date# ;                set value of (integer(value(obj#,itm#))) to (t.calendar.week*string(DateWeekNumber(itm#*7+date#)))
31888>>>>>              else set value of (integer(value(obj#,itm#))) to ""
31890>>>>>            loop
31891>>>>>>
31891>>>>>          end_procedure
31892>>>>>          send initialize
31893>>>>>        end_object
31894>>>>>        object days_grid is a container3d
31896>>>>>          set location to 23 39
31897>>>>>          set size     to 100 127
31898>>>>>          set border_style to border_none
31899>>>>>          object btn_array is an array
31901>>>>>          end_object
31902>>>>>          procedure initialize
31904>>>>>            local integer row# col# button_array#
31905>>>>>            move (btn_array(current_object)) to button_array#
31906>>>>>            for row# from 0 to 5
31912>>>>>>
31912>>>>>              for col# from 0 to 6
31918>>>>>>
31918>>>>>                object btn is a calendar.button
31920>>>>>                  set location to (row#*15) (col#*18)
31921>>>>>                  set value of button_array# item (item_count(button_array#)) to current_object
31922>>>>>                  on_item "" send move_value_out_ok
31923>>>>>                end_object
31924>>>>>              loop
31925>>>>>>
31925>>>>>            loop
31926>>>>>>
31926>>>>>          end_procedure
31927>>>>>          send initialize
31928>>>>>
31928>>>>>          procedure display.iii integer itm# integer day# integer activate#
31930>>>>>            local integer obj# current_day#
31931>>>>>            move (integer(value(btn_array(current_object),itm#))) to obj#
31932>>>>>            move (DateSegment(p_current_date(current_object),DS_DAY)) to current_day#
31933>>>>>            if activate# begin
31935>>>>>              if day# eq current_day# send activate to obj#
31938>>>>>            end
31938>>>>>>
31938>>>>>            else begin
31939>>>>>              if day# begin
31941>>>>>                set value of obj# to day#
31942>>>>>                set visible_state of obj# to true
31943>>>>>                set p_assigned_date of obj# to (DateCompose(day#,p_current_month(current_object),p_current_year(current_object)))
31944>>>>>              end
31944>>>>>>
31944>>>>>              else set visible_state of obj# to false
31946>>>>>            end
31946>>>>>>
31946>>>>>          end_procedure
31947>>>>>
31947>>>>>          procedure display integer activate#
31949>>>>>            local integer first_item# last_item# itm# day# date#
31950>>>>>            get p_current_date to date#
31951>>>>>            move (FirstDayInMonth(date#)) to date#
31952>>>>>            move (DateDayNumber(date#)-1) to first_item#
31953>>>>>            move (LastDayInMonth(date#)-date#+first_item#) to last_item#
31954>>>>>            ifnot activate# begin
31956>>>>>              for itm# from 0 to (first_item#-1)
31962>>>>>>
31962>>>>>                send display.iii itm# 0 0
31963>>>>>              loop
31964>>>>>>
31964>>>>>            end
31964>>>>>>
31964>>>>>            move 1 to day#
31965>>>>>            for itm# from first_item# to last_item#
31971>>>>>>
31971>>>>>              send display.iii itm# day# activate#
31972>>>>>              increment day#
31973>>>>>            loop
31974>>>>>>
31974>>>>>            ifnot activate# begin
31976>>>>>              for itm# from (last_item#+1) to 41
31982>>>>>>
31982>>>>>                send display.iii itm# 0 0
31983>>>>>              loop
31984>>>>>>
31984>>>>>            end
31984>>>>>>
31984>>>>>          end_procedure
31985>>>>>        end_object
31986>>>>>        object txt_month is a calendar.textbox
31988>>>>>          set size to 12 27
31989>>>>>          set location to 25 185
31990>>>>>          set value to t.calendar.month
31991>>>>>        end_object
31992>>>>>        object btn1 is a button
31994>>>>>          set size to 12 12
31995>>>>>          set location to 40 185
31996>>>>>          on_item "" send prev_month
31997>>>>>          set bitmap to "prev.bmp"
31998>>>>>          procedure switch_back
32000>>>>>            send display_main
32001>>>>>          end_procedure
32002>>>>>        end_object
32003>>>>>        object btn2 is a button
32005>>>>>          set size to 12 12
32006>>>>>          set location to 40 200
32007>>>>>          on_item "" send next_month
32008>>>>>          set bitmap to "next.bmp"
32009>>>>>        end_object
32010>>>>>        object txt_year is a calendar.textbox
32012>>>>>          set size to 12 27
32013>>>>>          set location to 70 185
32014>>>>>          set value to t.calendar.year
32015>>>>>        end_object
32016>>>>>        object btn3 is a button
32018>>>>>          set size to 12 12
32019>>>>>          set location to 85 185
32020>>>>>          on_item "" send prev_year
32021>>>>>          set bitmap to "prev.bmp"
32022>>>>>        end_object
32023>>>>>        object btn4 is a button
32025>>>>>          set size to 12 12
32026>>>>>          set location to 85 200
32027>>>>>          on_item "" send next_year
32028>>>>>          set bitmap to "next.bmp"
32029>>>>>        end_object
32030>>>>>      end_object
32031>>>>>      object btn5 is a button
32033>>>>>        set size to 14 60
32034>>>>>        set location to 129 115
32035>>>>>        on_item t.calendar.ok send move_value_out_ok
32036>>>>>      end_object
32037>>>>>      object btn6 is a button
32039>>>>>        set size to 14 60
32040>>>>>        set location to 129 182
32041>>>>>        on_item t.calendar.cancel send cancel
32042>>>>>        procedure switch
32044>>>>>          send display_main
32045>>>>>        end_procedure
32046>>>>>      end_object
32047>>>>>      procedure next_year
32049>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32050>>>>>        send display_main
32051>>>>>      end_procedure
32052>>>>>      procedure prev_year
32054>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32055>>>>>        send display_main
32056>>>>>      end_procedure
32057>>>>>      procedure next_month
32059>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32060>>>>>        send display_main
32061>>>>>      end_procedure
32062>>>>>      procedure prev_month
32064>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32065>>>>>        send display_main
32066>>>>>      end_procedure
32067>>>>>      procedure next_week
32069>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,1))
32070>>>>>        send display_main
32071>>>>>      end_procedure
32072>>>>>      procedure prev_week
32074>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_WEEK,-1))
32075>>>>>        send display_main
32076>>>>>      end_procedure
32077>>>>>      procedure next_day
32079>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,1))
32080>>>>>        send display_main
32081>>>>>      end_procedure
32082>>>>>      procedure prev_day
32084>>>>>        set p_current_date to (DateIncrement(p_current_date(current_object),DS_DAY,-1))
32085>>>>>        send display_main
32086>>>>>      end_procedure
32087>>>>>      procedure go_today
32089>>>>>        local date date#
32090>>>>>        sysdate4 date#
32091>>>>>        set p_current_date to date#
32092>>>>>        send display_main
32093>>>>>      end_procedure
32094>>>>>      property integer invoking_object_id public 0
32096>>>>>      procedure OnChange date date#
32098>>>>>        local integer focus# dm#
32099>>>>>        get invoking_object_id to focus#
32100>>>>>        if focus# gt desktop begin
32102>>>>>          get delegation_mode of focus# to dm#
32103>>>>>          set delegation_mode of focus# to no_delegate_or_error
32104>>>>>          send NotifyPopupCalendarChange to focus# date#
32105>>>>>          set delegation_mode of focus# to dm#
32106>>>>>        end
32106>>>>>>
32106>>>>>      end_procedure
32107>>>>>      procedure display
32109>>>>>        local integer date# month# year#
32110>>>>>        get p_current_date to date#
32111>>>>>        send OnChange date#
32112>>>>>        move (DateSegment(date#,DS_YEAR)) to year#
32113>>>>>        move (DateSegment(date#,DS_MONTH)) to month#
32114>>>>>        if (p_current_year(current_object)<>year# or p_current_month(current_object)<>month#) begin
32116>>>>>          set p_current_year to year#
32117>>>>>          set p_current_month to month#
32118>>>>>          set value to (t.calendar.calendar_popup+", "+MonthName(month#))
32119>>>>>          send display to (textbox_year(cont3d(current_object)))
32120>>>>>          send display to (weeknumber_header(cont3d(current_object)))
32121>>>>>          send display to (days_grid(cont3d(current_object))) 0
32122>>>>>        end
32122>>>>>>
32122>>>>>      end_procedure
32123>>>>>      procedure display_main
32125>>>>>        send display
32126>>>>>        send display to (days_grid(cont3d(current_object))) 1
32127>>>>>      end_procedure
32128>>>>>      procedure popup_no_export
32130>>>>>        set pExportState to false
32131>>>>>        send popup
32132>>>>>        set pExportState to true
32133>>>>>      end_procedure
32134>>>>>
32134>>>>>      procedure popup_group
32136>>>>>        local integer focus#
32137>>>>>        local date date#
32137>>>>>        move (focus(desktop)) to focus#
32138>>>>>        set invoking_object_id to focus#
32139>>>>>        get value of focus# item current to date#
32140>>>>>        ifnot (integer(date#)) move (dSysdate()) to date#
32143>>>>>        move (Date2to4(date#)) to date#
32144>>>>>        set p_current_date to date#
32145>>>>>        send display
32146>>>>>        forward send popup_group
32148>>>>>        send display to (days_grid(cont3d(current_object))) 1
32149>>>>>      end_procedure
32150>>>>>
32150>>>>>      procedure move_value_out
32152>>>>>        local integer focus# dm# margin# datatype#
32153>>>>>        if (pExportState(current_object)) begin
32155>>>>>          get invoking_object_id to focus#
32156>>>>>          if focus# gt desktop begin
32158>>>>>            get delegation_mode of focus# to dm#
32159>>>>>            set delegation_mode of focus# to no_delegate_or_error
32160>>>>>            send NotifyPopupCalendarSelect to focus# (p_current_date(current_object))
32161>>>>>            get form_margin of focus# item current to margin#
32162>>>>>            get form_datatype of focus# item current to datatype#
32163>>>>>            set delegation_mode of focus# to dm#
32164>>>>>            if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to (p_current_date(current_object))
32167>>>>>            else             set value of focus# item current to (Date4to2(p_current_date(current_object)))
32169>>>>>            set item_changed_state of focus# item current to true
32170>>>>>          end
32170>>>>>>
32170>>>>>        end
32170>>>>>>
32170>>>>>      end_procedure
32171>>>>>
32171>>>>>      procedure move_value_out_ok
32173>>>>>        send move_value_out
32174>>>>>        send deactivate
32175>>>>>      end_procedure
32176>>>>>
32176>>>>>      procedure request_popup
32178>>>>>        local integer focus# type# dm#
32179>>>>>        move (focus(desktop)) to focus#
32180>>>>>        if focus# gt desktop begin
32182>>>>>          get delegation_mode of focus# to dm#
32183>>>>>          set delegation_mode of focus# to no_delegate_or_error
32184>>>>>          get form_datatype of focus# item current to type#
32185>>>>>          if (type#=date_window or type#=mask_date_window) send popup
32188>>>>>          set delegation_mode of focus# to dm#
32189>>>>>        end
32189>>>>>>
32189>>>>>      end_procedure
32190>>>>>    end_object
32191>>>>>  end_desktop_section
32193>>>>>  // If the procedure below was not defined "for BaseClass" its symbolic
32193>>>>>  // substitute would become negative (because located on the desktop). This
32193>>>>>  // would result in the toolbar object not being able to handle it. Therefore:
32193>>>>>  procedure request_popup_calendar for BaseClass
32194>>>>>    send request_popup to (popup_calendar(current_object))
32195>>>>>  end_procedure
32196>>>>>  procedure popup_calendar_no_export
32197>>>>>    send popup_no_export to (popup_calendar(current_object))
32198>>>>>  end_procedure
32199>>>>>  register_procedure Add_Toolbar_Button_Bitmap string bmp# string Tip# string StHlp# integer msg# integer obj#
32199>>>>>  procedure Add_Calendar_tbButton integer oTb#
32200>>>>>    send Add_Toolbar_Button_Bitmap to oTb# "DfCalend.bmp" t.calendar.calendar_popup t.calendar.Activate msg_request_popup_calendar
32201>>>>>  end_procedure
32202>>>>> function s.calendar returns integer // Backwards compatible!!
32203>>>>>   function_return (popup_calendar(current_object))
32204>>>>> end_function
32205>>>>>
32205>>>>>// Karl,
32205>>>>>// Structure is as follows,
32205>>>>>//
32205>>>>>// //put this code in the top portion of the view code or in the program
32205>>>>>// code.
32205>>>>>//
32205>>>>>// Type SystemTime
32205>>>>>//   field SystemTime.iYear As Word
32205>>>>>//   field SystemTime.iMonth As Word
32205>>>>>//   field SystemTime.iDayOfWeek As Word
32205>>>>>//   field SystemTime.iDay As Word
32205>>>>>//   field SystemTime.iHour As Word
32205>>>>>//   field SystemTime.iMinute As Word
32205>>>>>//   field SystemTime.iSecond As Word
32205>>>>>//   field SystemTime.iMilliseconds As Word
32205>>>>>// End_Type
32205>>>>>//
32205>>>>>// external_function GetSystemTime "GetSystemTime" kernel32.dll Pointer lpGST Returns VOID_TYPE
32205>>>>>//
32205>>>>>// //put this code in an onClick or wherever
32205>>>>>// procedure onclick
32205>>>>>//   local integer iRetVal
32205>>>>>//   local string TimeData
32205>>>>>//   local pointer GST
32205>>>>>//
32205>>>>>//   ZeroType SystemTime to TimeData
32205>>>>>//   getAddress from TimeData to GST
32205>>>>>//
32205>>>>>//   move (GetSystemTime(GST)) to iRetVal
32205>>>>>// end_procedure
32205>>>>>//
32205>>>>>// To extract the data from the Structure after calling the function use
32205>>>>>// the getbuff command as follows:
32205>>>>>//
32205>>>>>// getbuff from TimeData as SystemTime.IVAL to var
32205>>>>>//
32205>>>>>// where IVAL is one of the vars such as iYear or iDay, etc.
32205>>>>>//
32205>>>>>// OLIVER NELSON
32205>>>>>//
32205>>>>>//
32205>>>
32205>>>//AB-StoreTopEnd
32205>>>
32205>>>//AB-IgnoreStart
32205>>>
32205>>>Use DFAllEnt.pkg
32205>>>
32205>>>
32205>>>//AB-IgnoreEnd
32205>>>
32205>>>CD_Popup_Object oCalendar is a dbModalPanel
32224>>>
32224>>>    //AB-StoreTopStart
32224>>>    on_key kcancel           send cancel
32225>>>    //AB-StoreTopEnd
32225>>>
32225>>>    Set Border_Style to Border_Normal
32226>>>    Set Caption_Bar to FALSE
32227>>>    Set Label to "Ÿ­¢ àì, 2001"
32228>>>    Set Size to 98 123
32229>>>    Set Location to 10 22
32230>>>    Set Color to clWhite
32231>>>
32231>>>    //AB-DDOStart
32231>>>
32231>>>
32231>>>    //AB-DDOEnd
32231>>>
32231>>>    Object Container3d1 is a Container3d
32233>>>        Set Size to 88 135
32234>>>        Set Location to -2 -1
32235>>>        Set Color to clWhite
32236>>>        Set Border_Style to Border_None
32237>>>        Object Grid2 is a Grid
32239>>>
32239>>>            //AB-StoreTopStart
32239>>>            property date    p_current_date     public 0
32241>>>            property integer p_current_year     public -1
32243>>>            property integer p_current_month    public -1
32245>>>            property integer p_selected_day     public -1
32247>>>            property integer pExportState       public 1
32249>>>            property integer invoking_object_id public 0
32251>>>            
32251>>>            Set Border_Style To BORDER_NONE
32252>>>            Set header_visible_state To False
32253>>>            set select_mode to no_select
32254>>>            Set Gridline_mode To GRID_VISIBLE_NONE
32255>>>            
32255>>>            on_key Key_F1 Send Help
32256>>>            on_key key_ctrl+key_pgup send prev_year
32257>>>            on_key key_ctrl+key_pgdn send next_year
32258>>>            on_key          key_pgup send prev_month
32259>>>            on_key          key_pgdn send next_month
32260>>>            on_key key_enter         send move_value_out
32261>>>            on_key key_ctrl+key_d    send go_today
32262>>>            
32262>>>            //AB-StoreTopEnd
32262>>>
32262>>>            Set Color to clWhite
32263>>>            Set CurrentCellColor to clWhite
32264>>>            Set CurrentCellTextColor to clWhite
32265>>>            Set Size to 61 145
32266>>>            Set Location to 30 1
32267>>>            Set Resize_Column_state to FALSE
32268>>>
32268>>>            Set Line_Width to 7 0
32269>>>
32269>>>            Set Form_Width    item 0 to 18
32270>>>            Set Header_Label  item 0 to "­"
32271>>>            
32271>>>            Set Form_Width    item 1 to 18
32272>>>            Set Header_Label  item 1 to "‚â"
32273>>>            
32273>>>            Set Form_Width    item 2 to 18
32274>>>            Set Header_Label  item 2 to "‘à"
32275>>>            
32275>>>            Set Form_Width    item 3 to 18
32276>>>            Set Header_Label  item 3 to "—â"
32277>>>            
32277>>>            Set Form_Width    item 4 to 18
32278>>>            Set Header_Label  item 4 to "â"
32279>>>            
32279>>>            Set Form_Width    item 5 to 18
32280>>>            Set Header_Label  item 5 to "‘¡"
32281>>>            
32281>>>            Set Form_Width    item 6 to 18
32282>>>            Set Header_Label  item 6 to "‚á"
32283>>>            
32283>>>
32283>>>            //AB-StoreStart
32283>>>            
32283>>>            procedure go_today
32285>>>                Date date#
32286>>>                sysdate4 date#
32287>>>                set p_current_date to date#
32288>>>                Send Update_Calendar
32289>>>            end_procedure
32290>>>            
32290>>>            procedure next_month
32292>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
32293>>>                Send Update_Calendar
32294>>>            end_procedure
32295>>>            
32295>>>            procedure prev_month
32297>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
32298>>>                Send Update_Calendar
32299>>>            end_procedure
32300>>>            
32300>>>            procedure next_year
32302>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
32303>>>                Send Update_Calendar
32304>>>            end_procedure
32305>>>            
32305>>>            procedure prev_year
32307>>>                set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
32308>>>                Send Update_Calendar
32309>>>            end_procedure
32310>>>            
32310>>>            Procedure Activate
32312>>>                Date date#
32313>>>                Forward Send Activate
32315>>>                Set current_item to (p_selected_day(Self))
32316>>>            End_Procedure
32317>>>            
32317>>>            Procedure Update_Calendar
32319>>>                Set Dynamic_Update_State To False
32320>>>                send Fill_List
32321>>>                Set Dynamic_Update_State To True
32322>>>                // Send Update_Label
32322>>>                Set current_item to (p_selected_day(Self))
32323>>>                Send Date_Changing to (oYear(Container3d2(self)))
32324>>>                Send Date_Changing to (oMonth(Container3d2(self)))
32325>>>            End_Procedure
32326>>>            
32326>>>            Procedure Fill_List
32328>>>                Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
32329>>>                Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
32329>>>                Date dToday
32329>>>                Send Delete_Data
32330>>>            
32330>>>                Get p_current_date to date#
32331>>>            
32331>>>                SysDate4 dToday
32332>>>                move (DateSegment(dToday,DS_DAY)) to cur_day#
32333>>>                move (DateSegment(dToday,DS_MONTH)) to cur_month#
32334>>>                move (DateSegment(dToday,DS_YEAR)) to cur_year#
32335>>>            
32335>>>                move (DateSegment(date#,DS_DAY)) to sel_day#
32336>>>                move (DateSegment(date#,DS_MONTH)) to sel_month#
32337>>>                move (DateSegment(date#,DS_YEAR)) to sel_year#
32338>>>                Set p_current_month To sel_month#
32339>>>                Set p_current_year To sel_year#
32340>>>            
32340>>>                move (FirstDayInMonth(date#)) to date#
32341>>>                move (DateDayNumber(date#)-1) to first_item#
32342>>>                move (LastDayInMonth(date#)-date#+first_item#) to last_item#
32343>>>                move (DateIncrement(date#,DS_Month,-1)) To prevdate#
32344>>>                move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
32345>>>            
32345>>>                If (first_item# > 0) Begin
32347>>>                    Move (first_item#-1) to day#
32348>>>                    For iFor from 0 to (first_item#-1)
32354>>>>
32354>>>                        Send Add_Item msg_move_value_out (prev_last#-day#)
32355>>>                        Set Entry_State Item iFor To False
32356>>>                        Set ItemTextColor Item iFor To clGray
32357>>>                        Decrement day#
32358>>>                    Loop
32359>>>>
32359>>>                End
32359>>>>
32359>>>            
32359>>>                Move 1 To day#
32360>>>                For iFor from first_item# to last_item#
32366>>>>
32366>>>                    Send Add_Item Msg_Move_Value_Out day#
32367>>>                    Set Entry_State Item iFor To False
32368>>>                    If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Set Form_Bitmap Item iFor To "cdate.bmp"
32371>>>                    If Day# eq sel_day# Set p_selected_day To iFor
32374>>>                    Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
32375>>>                    Set form_datatype item iFor To mask_numeric_window
32376>>>                    Set form_Mask item iFor To "## "
32377>>>                    Increment day#
32378>>>                Loop
32379>>>>
32379>>>            
32379>>>                move (DateIncrement(date#,DS_Month,1)) To nextdate#
32380>>>                move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
32381>>>            
32381>>>                If (last_item# < 41) Begin
32383>>>                    Move 1 to day#
32384>>>                    For iFor from (last_item#+1) to 41
32390>>>>
32390>>>                        Send Add_Item msg_move_value_out day#
32391>>>                        Set Entry_State Item iFor To False
32392>>>                        Set ItemTextColor Item iFor To clGray
32393>>>                        Increment day#
32394>>>                    Loop
32395>>>>
32395>>>                End
32395>>>>
32395>>>            
32395>>>            End_Procedure
32396>>>            
32396>>>            Procedure Help
32398>>>                Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<PgUp>, <PgDn> - Select year.\n\n(c) 2001, SCR. Special thanks to Sture Andersen.") ("Help on Calendar")
32399>>>            End_Procedure
32400>>>            
32400>>>            procedure mouse_click integer window integer char_pos
32402>>>                Send Move_Value_Out
32403>>>                forward send mouse_click window char_pos
32405>>>            end_procedure
32406>>>            
32406>>>            Procedure Move_Value_Out
32408>>>                Integer iYear iMonth iDay iItm
32409>>>                Date Date# next_date# prev_date#
32409>>>                Get Current_Item To iItm
32410>>>                If (pExportState(Self)) Begin
32412>>>                    Get Value Item iItm To iDay
32413>>>                    Get p_current_month to iMonth
32414>>>                    Get p_current_year  to iYear
32415>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32416>>>            
32416>>>                    If ((iItm>27)and(iDay<15)) Begin
32418>>>                        Move (DateCompose(1,iMonth,iYear)) To next_date#
32419>>>                        move (DateIncrement(next_date#,DS_Month,1)) To next_date#
32420>>>                        move (DateSegment(next_date#,DS_MONTH)) to iMonth
32421>>>                        move (DateSegment(next_date#,DS_YEAR)) to iYear
32422>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32423>>>                    End
32423>>>>
32423>>>                    If ((iItm<7)and(iDay>20)) Begin
32425>>>                        Move (DateCompose(1,iMonth,iYear)) To prev_date#
32426>>>                        move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
32427>>>                        move (DateSegment(prev_date#,DS_MONTH)) to iMonth
32428>>>                        move (DateSegment(prev_date#,DS_YEAR)) to iYear
32429>>>                        move (DateCompose(iDay,iMonth,iYear)) to date#
32430>>>                    End
32430>>>>
32430>>>            
32430>>>                    Send Export_Date date#
32431>>>                End
32431>>>>
32431>>>            End_Procedure
32432>>>            
32432>>>            Procedure Export_Date date date#
32434>>>                local integer focus# dm# margin# datatype#
32435>>>                get invoking_object_id to focus#
32436>>>            
32436>>>                if focus# gt desktop begin
32438>>>                     get delegation_mode of focus# to dm#
32439>>>                     set delegation_mode of focus# to no_delegate_or_error
32440>>>                     get form_margin of focus# item current to margin#
32441>>>                     get form_datatype of focus# item current to datatype#
32442>>>                     set delegation_mode of focus# to dm#
32443>>>                     if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
32446>>>                     else             set value of focus# item current to (Date4to2(date#))
32448>>>                     set item_changed_state of focus# item current to true
32449>>>                end
32449>>>>
32449>>>                Send Close_Calendar
32450>>>            End_Procedure
32451>>>            //AB-StoreEnd
32451>>>
32451>>>        End_Object    // Grid2
32452>>>
32452>>>        Object Textbox2 is a Textbox
32454>>>            Set Label to "­"
32455>>>            Set Auto_Size_State to FALSE
32456>>>            Set Transparent_State to TRUE
32457>>>            Set Color to clWhite
32458>>>            Set TextColor to clNavy
32459>>>            Set Location to 19 4
32460>>>            Set Size to 10 15
32461>>>
32461>>>            //AB-StoreStart
32461>>>                                        
32461>>>            Set Label To (left(t.calendar.Monday,2))
32462>>>            //AB-StoreEnd
32462>>>
32462>>>        End_Object    // Textbox2
32463>>>
32463>>>        Object Textbox3 is a Textbox
32465>>>            Set Label to "‚â"
32466>>>            Set Auto_Size_State to FALSE
32467>>>            Set Transparent_State to TRUE
32468>>>            Set Color to clWhite
32469>>>            Set TextColor to clNavy
32470>>>            Set Location to 19 22
32471>>>            Set Size to 10 12
32472>>>
32472>>>            //AB-StoreStart
32472>>>                                        
32472>>>            Set Label To (left(t.calendar.Tuesday,2))
32473>>>            //AB-StoreEnd
32473>>>
32473>>>        End_Object    // Textbox3
32474>>>
32474>>>        Object Textbox4 is a Textbox
32476>>>            Set Label to "‘à"
32477>>>            Set Auto_Size_State to FALSE
32478>>>            Set Transparent_State to TRUE
32479>>>            Set Color to clWhite
32480>>>            Set TextColor to clNavy
32481>>>            Set Location to 19 39
32482>>>            Set Size to 10 15
32483>>>
32483>>>            //AB-StoreStart
32483>>>                                        
32483>>>            Set Label To (left(t.calendar.Wednesday,2))
32484>>>            //AB-StoreEnd
32484>>>
32484>>>        End_Object    // Textbox4
32485>>>
32485>>>        Object Textbox5 is a Textbox
32487>>>            Set Label to "—â"
32488>>>            Set Auto_Size_State to FALSE
32489>>>            Set Transparent_State to TRUE
32490>>>            Set Color to clWhite
32491>>>            Set TextColor to clNavy
32492>>>            Set Location to 19 57
32493>>>            Set Size to 10 17
32494>>>
32494>>>            //AB-StoreStart
32494>>>                                        
32494>>>            Set Label To (left(t.calendar.Thursday,2))
32495>>>            //AB-StoreEnd
32495>>>
32495>>>        End_Object    // Textbox5
32496>>>
32496>>>        Object Textbox6 is a Textbox
32498>>>            Set Label to "â"
32499>>>            Set Auto_Size_State to FALSE
32500>>>            Set Transparent_State to TRUE
32501>>>            Set Color to clWhite
32502>>>            Set TextColor to clNavy
32503>>>            Set Location to 19 76
32504>>>            Set Size to 10 17
32505>>>
32505>>>            //AB-StoreStart
32505>>>                                        
32505>>>            Set Label To (left(t.calendar.Friday,2))
32506>>>            //AB-StoreEnd
32506>>>
32506>>>        End_Object    // Textbox6
32507>>>
32507>>>        Object Textbox7 is a Textbox
32509>>>            Set Label to "‘¡"
32510>>>            Set Auto_Size_State to FALSE
32511>>>            Set Transparent_State to TRUE
32512>>>            Set Color to clWhite
32513>>>            Set TextColor to clNavy
32514>>>            Set Location to 19 91
32515>>>            Set Size to 10 18
32516>>>
32516>>>            //AB-StoreStart
32516>>>                                        
32516>>>            Set Label To (left(t.calendar.Saturday,2))
32517>>>            //AB-StoreEnd
32517>>>
32517>>>        End_Object    // Textbox7
32518>>>
32518>>>        Object Textbox8 is a Textbox
32520>>>            Set Label to "‚á"
32521>>>            Set Auto_Size_State to FALSE
32522>>>            Set Transparent_State to TRUE
32523>>>            Set Color to clWhite
32524>>>            Set TextColor to clNavy
32525>>>            Set Location to 19 109
32526>>>            Set Size to 10 17
32527>>>
32527>>>            //AB-StoreStart
32527>>>                                        
32527>>>            Set Label To (left(t.calendar.Sunday,2))
32528>>>            //AB-StoreEnd
32528>>>
32528>>>        End_Object    // Textbox8
32529>>>
32529>>>        Object LineControl1 is a LineControl
32531>>>            Set Line_Style to lnSINGLE
32532>>>            Set Size to 1 116
32533>>>            Set Location to 28 4
32534>>>
32534>>>            //AB-StoreStart
32534>>>                                        
32534>>>            //AB-StoreEnd
32534>>>
32534>>>        End_Object    // LineControl1
32535>>>
32535>>>        Object Container3d2 is a Container3d
32537>>>            Set Size to 18 131
32538>>>            Set Location to 1 1
32539>>>            Set Color to clNavy
32540>>>            Set Border_Style to Border_None
32541>>>            Object oRght is a BitmapContainer
32543>>>                Set Size to 10 14
32544>>>                Set Location to 4 105
32545>>>                Set Bitmap to "rght.bmp"
32546>>>                Set Border_Style to Border_None
32547>>>
32547>>>                //AB-StoreStart
32547>>>                Procedure Mouse_Down
32549>>>                    Send Next_Month to Grid2
32550>>>                End_Procedure
32551>>>                //AB-StoreEnd
32551>>>
32551>>>            End_Object    // oRght
32552>>>
32552>>>            Object oLeft is a BitmapContainer
32554>>>                Set Size to 10 14
32555>>>                Set Location to 4 3
32556>>>                Set Bitmap to "lft.bmp"
32557>>>                Set Border_Style to Border_None
32558>>>
32558>>>                //AB-StoreStart
32558>>>                Procedure Mouse_Down
32560>>>                    Send Prev_Month to Grid2
32561>>>                End_Procedure
32562>>>                //AB-StoreEnd
32562>>>
32562>>>            End_Object    // oLeft
32563>>>
32563>>>            Object oMonth is a Textbox
32565>>>
32565>>>                //AB-StoreTopStart
32565>>>                Property integer piSelected_Month public 0
32567>>>                //AB-StoreTopEnd
32567>>>
32567>>>                Set Label to "January"
32568>>>                Set Auto_Size_State to FALSE
32569>>>                Set Transparent_State to TRUE
32570>>>                Set Color to clWhite
32571>>>                Set TextColor to clWhite
32572>>>                Set Location to 4 23
32573>>>                Set Size to 10 43
32574>>>                Set FontWeight to 800
32575>>>                Set Justification_Mode to jMode_Center
32576>>>
32576>>>                //AB-StoreStart
32576>>>                                    
32576>>>                Procedure Mouse_Down
32578>>>                    Integer iState
32579>>>                    Get Visible_State of oSelectYear to iState
32580>>>                    If (iState) Send OnKillFocus to oSelectYear
32583>>>                    Send Popup to oSelectMonth
32584>>>                End_Procedure
32585>>>                
32585>>>                Procedure pSelectJan
32587>>>                    Set Label to t.calendar.january
32588>>>                    Set piSelected_Month to 1
32589>>>                    Send Adjust_Calendar
32590>>>                End_Procedure
32591>>>                Procedure pSelectFeb
32593>>>                    Set Label to t.calendar.february
32594>>>                    Set piSelected_Month to 2
32595>>>                    Send Adjust_Calendar
32596>>>                End_Procedure
32597>>>                Procedure pSelectMar
32599>>>                    Set Label to t.calendar.march
32600>>>                    Set piSelected_Month to 3
32601>>>                    Send Adjust_Calendar
32602>>>                End_Procedure
32603>>>                Procedure pSelectApr
32605>>>                    Set Label to t.calendar.april
32606>>>                    Set piSelected_Month to 4
32607>>>                    Send Adjust_Calendar
32608>>>                End_Procedure
32609>>>                Procedure pSelectMay
32611>>>                    Set Label to t.calendar.may
32612>>>                    Set piSelected_Month to 5
32613>>>                    Send Adjust_Calendar
32614>>>                End_Procedure
32615>>>                Procedure pSelectJun
32617>>>                    Set Label to t.calendar.june
32618>>>                    Set piSelected_Month to 6
32619>>>                    Send Adjust_Calendar
32620>>>                End_Procedure
32621>>>                Procedure pSelectJul
32623>>>                    Set Label to t.calendar.july
32624>>>                    Set piSelected_Month to 7
32625>>>                    Send Adjust_Calendar
32626>>>                End_Procedure
32627>>>                Procedure pSelectAug
32629>>>                    Set Label to t.calendar.august
32630>>>                    Set piSelected_Month to 8
32631>>>                    Send Adjust_Calendar
32632>>>                End_Procedure
32633>>>                Procedure pSelectSep
32635>>>                    Set Label to t.calendar.september
32636>>>                    Set piSelected_Month to 9
32637>>>                    Send Adjust_Calendar
32638>>>                End_Procedure
32639>>>                Procedure pSelectOct
32641>>>                    Set Label to t.calendar.october
32642>>>                    Set piSelected_Month to 10
32643>>>                    Send Adjust_Calendar
32644>>>                End_Procedure
32645>>>                Procedure pSelectNov
32647>>>                    Set Label to t.calendar.november
32648>>>                    Set piSelected_Month to 11
32649>>>                    Send Adjust_Calendar
32650>>>                End_Procedure
32651>>>                Procedure pSelectDec
32653>>>                    Set Label to t.calendar.december
32654>>>                    Set piSelected_Month to 12
32655>>>                    Send Adjust_Calendar
32656>>>                End_Procedure
32657>>>                
32657>>>                Object oSelectMonth is a FloatingPopupMenu
32659>>>                    Send Add_Item msg_pSelectJan t.calendar.january
32660>>>                    Send Add_Item msg_pSelectFeb t.calendar.february
32661>>>                    Send Add_Item msg_pSelectMar t.calendar.march
32662>>>                    Send Add_Item msg_pSelectApr t.calendar.april
32663>>>                    Send Add_Item msg_pSelectMay t.calendar.may
32664>>>                    Send Add_Item msg_pSelectJun t.calendar.june
32665>>>                    Send Add_Item msg_pSelectJul t.calendar.july
32666>>>                    Send Add_Item msg_pSelectAug t.calendar.august
32667>>>                    Send Add_Item msg_pSelectSep t.calendar.september
32668>>>                    Send Add_Item msg_pSelectOct t.calendar.october
32669>>>                    Send Add_Item msg_pSelectNov t.calendar.november
32670>>>                    Send Add_Item msg_pSelectDec t.calendar.december
32671>>>                End_Object
32672>>>                
32672>>>                Procedure Adjust_Calendar
32674>>>                    Date date#
32675>>>                    Integer iDay iMonth iYear iItm
32675>>>                    Set Visible_State to false
32676>>>                    Set Visible_State to true
32677>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32678>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32679>>>                    Get piSelected_Month to iMonth
32680>>>                    Get Label of oYear to iYear
32681>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32682>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32683>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32684>>>                End_Procedure
32685>>>                
32685>>>                Procedure Activating
32687>>>                    Forward Send Activating
32689>>>                    Send Date_Changing
32690>>>                End_Procedure
32691>>>                
32691>>>                Procedure Date_Changing
32693>>>                    Set Visible_State to false
32694>>>                    Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
32695>>>                    Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
32696>>>                    Set Visible_State to true
32697>>>                End_Procedure
32698>>>                
32698>>>                
32698>>>                //AB-StoreEnd
32698>>>
32698>>>            End_Object    // oMonth
32699>>>
32699>>>            Object oYear is a Textbox
32701>>>                Set Label to "2001"
32702>>>                Set Transparent_State to TRUE
32703>>>                Set Color to clWhite
32704>>>                Set TextColor to clWhite
32705>>>                Set Location to 4 77
32706>>>                Set Size to 10 18
32707>>>                Set FontWeight to 800
32708>>>
32708>>>                //AB-StoreStart
32708>>>                                                    
32708>>>                Procedure Mouse_Down
32710>>>                    String sVal
32711>>>                    Get Label to sVal
32712>>>                    Set Value of oSelectYear item 0 to sVal
32713>>>                    Set Visible_State of oSelectYear to True
32714>>>                    Send Activate to (oSelectYear(Self))
32715>>>                End_Procedure
32716>>>                
32716>>>                Procedure Activating
32718>>>                    Forward Send Activating
32720>>>                    Send Date_Changing
32721>>>                End_Procedure
32722>>>                
32722>>>                Procedure Date_Changing
32724>>>                    Set Visible_State to false
32725>>>                    Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
32726>>>                    Set Visible_State to true
32727>>>                End_Procedure
32728>>>                //AB-StoreEnd
32728>>>
32728>>>            End_Object    // oYear
32729>>>
32729>>>            Object oSelectYear is a Form
32731>>>
32731>>>                //AB-StoreTopStart
32731>>>                Set Visible_State To False
32732>>>                //AB-StoreTopEnd
32732>>>
32732>>>                Set Size to 10 24
32733>>>                Set Location to 4 75
32734>>>                Set Color to clWhite
32735>>>                Set TextColor to clNavy
32736>>>                Set Form_Border Item 0 to Border_Normal
32737>>>
32737>>>                //AB-StoreStart
32737>>>                                                    
32737>>>                On_Key Key_Enter Send OnKillFocus
32738>>>                On_Key Key_Escape Send OnKillFocus
32739>>>                
32739>>>                Procedure SetFontWeight
32741>>>                    Set Form_FontWeight item 0 to 800
32742>>>                End_Procedure
32743>>>                
32743>>>                Procedure OnKillFocus
32745>>>                    String sVal
32746>>>                    Integer iMonth iDay iYear iItm
32746>>>                    Date date#
32746>>>                    Get Value item 0 to sVal
32747>>>                    Set Visible_State of oYear to false
32748>>>                    Set Label of oYear to sVal
32749>>>                    Set Visible_State of oYear to true
32750>>>                    Set Visible_State to false
32751>>>                    Get Current_Item of (Grid2(Container3D1(Self))) to iItm
32752>>>                    Get value of (Grid2(Container3D1(Self))) item iItm to iDay
32753>>>                    Get piSelected_Month of oMonth to iMonth
32754>>>                    Get Value item 0 to iYear
32755>>>                    Move (DateCompose(iDay,iMonth,iYear)) To date#
32756>>>                    Set p_current_date of (Grid2(Container3D1(Self))) to date#
32757>>>                    Send Update_Calendar to (Grid2(Container3D1(Self)))
32758>>>                End_Procedure
32759>>>                
32759>>>                Send SetFontWeight
32760>>>                //AB-StoreEnd
32760>>>
32760>>>            End_Object    // oSelectYear
32761>>>
32761>>>
32761>>>            //AB-StoreStart
32761>>>                            
32761>>>            Procedure Mouse_Down
32763>>>                Integer iState
32764>>>                Get Visible_State of oSelectYear to iState
32765>>>                If (iState) Send OnKillFocus to oSelectYear
32768>>>            End_Procedure
32769>>>            
32769>>>            //AB-StoreEnd
32769>>>
32769>>>        End_Object    // Container3d2
32770>>>
32770>>>
32770>>>        //AB-StoreStart
32770>>>                            
32770>>>        //AB-StoreEnd
32770>>>
32770>>>    End_Object    // Container3d1
32771>>>
32771>>>    Object BitmapContainer3 is a BitmapContainer
32773>>>        Set Size to 9 19
32774>>>        Set Location to 88 3
32775>>>        Set Color to clWhite
32776>>>        Set Bitmap to "cdate.bmp"
32777>>>        Set Border_Style to Border_None
32778>>>
32778>>>        //AB-StoreStart
32778>>>        Procedure Mouse_Down
32780>>>            Send go_today to (Grid2(Container3d1(Self)))
32781>>>            Send Adjust_Label to oToday
32782>>>        End_Procedure
32783>>>        //AB-StoreEnd
32783>>>
32783>>>    End_Object    // BitmapContainer3
32784>>>
32784>>>    Object oToday is a Textbox
32786>>>        Set Label to "Today: 01.01.2001"
32787>>>        Set Auto_Size_State to FALSE
32788>>>        Set Color to clWhite
32789>>>        Set Location to 88 22
32790>>>        Set Size to 8 73
32791>>>        Set FontWeight to 800
32792>>>
32792>>>        //AB-StoreStart
32792>>>        Procedure Mouse_Down
32794>>>            Send go_today to (Grid2(Container3d1(Self)))
32795>>>            Send Adjust_Label
32796>>>        End_Procedure
32797>>>        
32797>>>        Procedure Adjust_Label
32799>>>            date date#
32800>>>            SysDate4 date#
32801>>>            Set Visible_State To false
32802>>>            Set Label         to (t.calendar.today+": "+String(date#))
32803>>>            Set Visible_State To true
32804>>>        End_Procedure
32805>>>        
32805>>>        Procedure Activating
32807>>>            Forward Send Activating
32809>>>            Send Adjust_Label
32810>>>        End_Procedure
32811>>>        //AB-StoreEnd
32811>>>
32811>>>    End_Object    // oToday
32812>>>
32812>>>
32812>>>    //AB-StoreStart
32812>>>                
32812>>>    procedure popup
32814>>>        local integer focus# icItm iYear iMonth
32815>>>        local date date#
32815>>>        move (focus(desktop)) to focus#
32816>>>        set invoking_object_id of (Grid2(Container3d1(self))) to focus#
32817>>>        get value of focus# item current to date#
32818>>>        ifnot (integer(date#)) sysdate date#
32821>>>        move (Date2to4(date#)) to date#
32822>>>        set p_current_date of (Grid2(Container3d1(self))) to date#
32823>>>        send fill_list to (Grid2(Container3d1(self)))
32824>>>        move (DateSegment(date#,DS_YEAR)) to iYear
32825>>>        move (DateSegment(date#,DS_MONTH)) to iMonth
32826>>>        Set Label To (MonthName(iMonth)+', '+String(iYear))
32827>>>        forward send popup
32829>>>    end_procedure
32830>>>    
32830>>>    Procedure Close_Calendar
32832>>>        Send Exit
32833>>>    End_Procedure
32834>>>    //AB-StoreEnd
32834>>>
32834>>>CD_End_Object    // oCalendar
32836>>>>
32836>>>
32836>>>
32836>>>//AB-StoreStart
32836>>>    
32836>>>    
32836>>>//AB-StoreEnd
32836>>>
32836>>>//AB/ End_Object    // prj
32836>Use Dates.Utl
32836>Use Roundfn.Fnc
INCLUDING FILE: ROUNDFN.FNC
32836>>>// ===========================================================================
32836>>>//
32836>>>// The ROUND_NUMBER global function has been designed to return the rounded
32836>>>// value of a given 'numeric' argument at a specified rounding precision.
32836>>>//
32836>>>// ---------------------------------------------------------------------------
32836>>>// This version dispenses with the use of powers (10 ^ n) to perform the
32836>>>// necessary calculations.  It uses a string handling technique instead.
32836>>>// ---------------------------------------------------------------------------
32836>>>//
32836>>>// The function requires two arguments, as follows:-
32836>>>//
32836>>>// (a) The numeric value to be rounded, where the range of valid values is
32836>>>//     +/- 99,999,999,999,999.99999999.
32836>>>//
32836>>>// (b) The rounding precision required.  This must be an integer value in the
32836>>>//     range -13 to +8.  If a value outside this range is used, the nearest
32836>>>//     threshold value is substituted.
32836>>>//
32836>>>//     Values in the range +1 to +7 perform rounding on the decimal part of
32836>>>//     the number.  A value of +8 will perform no rounding at all.  A zero
32836>>>//     value will round to the nearest whole number.  Values -1 to -13 will
32836>>>//     round progressively to the left of the decimal point (a frequent
32836>>>//     requirement in financial reporting).
32836>>>//
32836>>>// If the result of the rounding produces a value outside the valid numeric
32836>>>// range (+/- 99,999,999,999,999.99999999) then a zero value is returned.
32836>>>//
32836>>>// Assumptions:-  The only assumptions made have been that the range of
32836>>>// numeric values and the limit of eight decimal places are unlikely to change
32836>>>// in the forseeable future.
32836>>>//
32836>>>// Examples:-
32836>>>//
32836>>>//  1st Argument      2nd Argument   Return Value
32836>>>//  ------------      ------------   ------------
32836>>>//  123456.87654321         8         123456.87654321
32836>>>//  123456.87654321         2         123456.88
32836>>>// -123456.87654321         2        -123456.88
32836>>>//  123456.98765432         0         123457
32836>>>// -123456.98765432        -1        -123460
32836>>>//  123456.98765432        -2         123500
32836>>>//  123456.98765432        -3         123000
32836>>>//  987654                 -4         990000
32836>>>//  987654                 -5        1000000
32836>>>//  987654                 -6        1000000
32836>>>//  987654                 -7              0
32836>>>//
32836>>>// ===========================================================================
32836>>>
32836>>>
32836>>>Function Round_Number GLOBAL number nVal integer iRnd returns Number
32837>>>
32837>>>  Local Number nAdj
32838>>>
32838>>>  Move 10000000000000 to nAdj
32839>>>
32839>>>  // If the rounding precision falls in the range 0 to 8, then return:-
32839>>>
32839>>>  If (iRnd >= 0) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 / (Number(Left(nAdj, ((iRnd + 1) ;      min 9)))) + nVal / (Number(Left(nAdj, (9 - (iRnd min 8))))) ;        * (Number(Left(nAdj, (9 - (iRnd min 8))))))
32842>>>
32842>>>  // Else, where the rounding precision is in the range -1 to -5, return:-
32842>>>
32842>>>  If (iRnd >= -5) Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(Left(nAdj, (Abs(iRnd) + 9)))) ;        * (Number(Left(nAdj, (Abs(iRnd) + 9)))))
32845>>>
32845>>>  // Else, where the rounding precision is in the range -6 to -13, return:-
32845>>>
32845>>>  Function_Return ;    (Number(Abs(nVal) / nVal) * 0.5 * (Number(Left(nAdj, (Abs(iRnd) + 1)))) ;      + nVal / (Number(nAdj)) / (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))) ;        * (Number(nAdj)) * (Number(Left(nAdj, ((Abs(iRnd) - 4) min 9)))))
32846>>>
32846>>>End_Function
32847>
32847>use checkafm.pkg
INCLUDING FILE: CHECKAFM.PKG
32847>>>
32847>>>
32847>>>Function Check_Afm Global String Afm_Num Returns Integer
32848>>>    Integer iii Num1 Num2
32849>>>
32849>>>    Move (Trim(Afm_Num)) To Afm_Num
32850>>>
32850>>>    For iii From 1 To (Length(Trim(Afm_Num)))
32856>>>>
32856>>>        If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
32859>>>    Loop
32860>>>>
32860>>>
32860>>>    Move (Right(Afm_Num,1)) to Num2
32861>>>
32861>>>    If (Length(Afm_Num)<>9) Function_Return 2
32864>>>
32864>>>    Move 0 to Num1
32865>>>
32865>>>    For iii From 1 to 8
32871>>>>
32871>>>        Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
32872>>>    Loop
32873>>>>
32873>>>
32873>>>    Move (Mod(Num1,11)) to Num1
32874>>>    If (Num1=10) Move 0 to Num1
32877>>>
32877>>>    If (Num1=Num2)  Function_Return 0
32880>>>    Else            Function_Return 1
32882>>>End_Function
32883>>>
32883>use checklog.pkg
INCLUDING FILE: CHECKLOG.PKG
32883>>>open syscurgl
INCLUDING FILE: SYSCURGL.FD
32885>>>open syscurxr
32887>>>open gplan
INCLUDING FILE: GPLAN.FD
32889>>>//open gplanl
32889>>>open iteml
INCLUDING FILE: ITEML.FD
32891>>>open cn
INCLUDING FILE: CN.FD
32893>>>open payresp
INCLUDING FILE: PAYRESP.FD
32895>>>open salesmen
INCLUDING FILE: SALESMEN.FD
32897>>>open mhxanik
INCLUDING FILE: MHXANIK.FD
32899>>>open constrct
INCLUDING FILE: CONSTRCT.FD
32901>>>open clients
INCLUDING FILE: CLIENTS.FD
32903>>>open wtypkin
INCLUDING FILE: WTYPKIN.FD
32905>>>open wax
INCLUDING FILE: WAX.FD
32907>>>Function Check_log Global String slog Returns Integer
32908>>>    clear gplan
32909>>>    move syscurxr.company_code to gplan.company_code
32910>>>    move syscurxr.branch_code  to gplan.branch_code
32911>>>    move syscurxr.year_year    to gplan.year_year
32912>>>    move slog                  to gplan.gplan_code
32913>>>    find eq gplan by index.1
32914>>>>
32914>>>    if (found=1) function_return 0
32917>>>    else         function_return 1
32919>>>
32919>>>End_Function
32920>>>
32920>>>Function Check_last Global String slog Returns Integer
32921>>>    clear gplan
32922>>>    move syscurxr.company_code to gplan.company_code
32923>>>    move syscurxr.branch_code  to gplan.branch_code
32924>>>    move syscurxr.year_year    to gplan.year_year
32925>>>    move slog                  to gplan.gplan_code
32926>>>    find eq gplan by index.1
32927>>>>
32927>>>    if ((found=1) and (Gplan.Gplan_Yn_Last = 1)) Function_Return 0
32930>>>    else                                         Function_return 1
32932>>>
32932>>>End_Function
32933>>>
32933>>>Function fsgplandescr String slog Returns string
32934>>>    clear gplan
32935>>>    move syscurgl.company_code to gplan.company_code
32936>>>    move syscurgl.branch_code  to gplan.branch_code
32937>>>    move syscurgl.year_year    to gplan.year_year
32938>>>    move slog                  to gplan.gplan_code
32939>>>    find eq gplan by index.1
32940>>>>
32940>>>    if (found=1) function_return gplan.gplan_descr1
32943>>>    else         function_return ''
32945>>>
32945>>>End_Function
32946>>>
32946>>>
32946>>>
32946>>>Function fsclientAFM string code Returns string
32947>>>    string name
32948>>>    clear clients
32949>>>    move code to clients.client_id
32950>>>    find eq clients by index.6
32951>>>>
32951>>>    if (found) move clients.client_afm to name
32954>>>    else       move '' to name
32956>>>    function_return name
32957>>>end_Function
32958>>>
32958>>>Function fspayrespAFM string code Returns string
32959>>>    string name
32960>>>    clear payresp
32961>>>    move code to payresp.presp_id
32962>>>    find eq payresp by index.7
32963>>>>
32963>>>    if (found) move payresp.presp_AFM to name
32966>>>    else       move '' to name
32968>>>    function_return name
32969>>>end_Function
32970>>>
32970>>>Function fssalesmenAFM string code Returns string
32971>>>    string name
32972>>>    clear salesmen
32973>>>    move code to salesmen.sls_id
32974>>>    find eq salesmen by index.4
32975>>>>
32975>>>    if (found) move salesmen.sls_AFM to name
32978>>>    else       move '' to name
32980>>>    function_return name
32981>>>end_Function
32982>>>
32982>>>
32982>>>
32982>>>//Function fsgplanperi String slog Returns string
32982>>>//    string sdescr
32982>>>//    clear gplanl
32982>>>//    move syscurgl.company_code to  gplanl.company_code
32982>>>//    move syscurgl.branch_code  to  gplanl.branch_code
32982>>>//    move slog                  to  gplanl.gplan_code
32982>>>//    find eq gplanl by index.1
32982>>>//    if (found=1) begin
32982>>>//        move gplanl.gplan_descr1 to sdescr
32982>>>//        function_return sdescr
32982>>>//    end
32982>>>//    else         function_return ''
32982>>>//End_Function
32982>>>
32982>>>
32982>>>
32982>>>Function fsclient string code Returns string
32983>>>    string name
32984>>>    clear clients
32985>>>    move code to clients.client_id
32986>>>    find eq clients by index.6
32987>>>>
32987>>>    if (found) move clients.client_name to name
32990>>>    else       move '' to name
32992>>>    function_return name
32993>>>end_Function
32994>>>
32994>>>Function fspayresp string code Returns string
32995>>>    string name
32996>>>    clear payresp
32997>>>    move code to payresp.presp_id
32998>>>    find eq payresp by index.7
32999>>>>
32999>>>    if (found) move payresp.presp_name to name
33002>>>    else       move '' to name
33004>>>    function_return name
33005>>>end_Function
33006>>>
33006>>>Function fssalesmen string code Returns string
33007>>>    string name
33008>>>    clear salesmen
33009>>>    move code to salesmen.sls_id
33010>>>    find eq salesmen by index.4
33011>>>>
33011>>>    if (found) move salesmen.sls_name to name
33014>>>    else       move '' to name
33016>>>    function_return name
33017>>>end_Function
33018>>>
33018>>>Function fsconstrct string code Returns string
33019>>>    string name
33020>>>    clear constrct
33021>>>    move code to constrct.cnt_id
33022>>>    find eq constrct by index.5
33023>>>>
33023>>>    if (found) move constrct.cnt_name to name
33026>>>    else       move '' to name
33028>>>    function_return name
33029>>>end_Function
33030>>>
33030>>>Function fsmhxanik string code Returns string
33031>>>    string name
33032>>>    clear mhxanik
33033>>>    move code to mhxanik.mhx_id
33034>>>    find eq mhxanik by index.4
33035>>>>
33035>>>    if (found) move mhxanik.mhx_name to name
33038>>>    else       move '' to name
33040>>>    function_return name
33041>>>end_Function
33042>>>
33042>>>
33042>>>Function fsptyppar string code Returns string
33043>>>    string sdescr
33044>>>    clear ptypparl
INCLUDING FILE: PTYPPARL.FD
33045>>>    move syscurxr.company_code to ptypparl.company_code
33046>>>    move syscurxr.branch_code  to ptypparl.branch_code
33047>>> //   move syscurxr.year_year    to ptypparl.year_year
33047>>>    move code                  to ptypparl.ptyppar_code
33048>>>    find eq ptypparl by index.1
33049>>>>
33049>>>    move ptypparl.ptyppar_descr to sdescr
33050>>>    function_return sdescr
33051>>>end_Function
33052>>>
33052>>>Function fsgplan string code Returns string
33053>>>    string sdescr
33054>>>    clear gplan
33055>>>    move syscurxr.company_code to gplan.company_code
33056>>>    move syscurxr.branch_code  to gplan.branch_code
33057>>>    move syscurxr.year_year    to gplan.year_year
33058>>>    move code                  to gplan.gplan_code
33059>>>    find eq gplan by index.1
33060>>>>
33060>>>    move gplan.gplan_descr1    to sdescr
33061>>>    function_return sdescr
33062>>>end_Function
33063>>>
33063>>>Function fsitem string scode Returns string
33064>>>    clear iteml
33065>>>    move scode to iteml.item_code
33066>>>    find eq iteml by index.5
33067>>>>
33067>>>    function_return iteml.item_descr
33068>>>end_Function
33069>>>
33069>>>Function fswax string srecr Returns string
33070>>>    clear wax
33071>>>    move srecr to wax.wax_recr
33072>>>    find eq wax by index.2
33073>>>>
33073>>>    function_return wax.wax_descr
33074>>>end_Function
33075>>>
33075>>>
33075>>>Function fswitemx string code Returns string
33076>>>    string name
33077>>>    clear witemx
INCLUDING FILE: WITEMX.FD
33078>>>    move syscurxr.company_code to witemx.company_code
33079>>>    move syscurxr.branch_code  to witemx.branch_code
33080>>>    move syscurxr.year_year    to witemx.year_year
33081>>>    move code to witemx.witemx_code
33082>>>    find eq witemx by index.5
33083>>>>
33083>>>    move witemx.witemx_descr to name
33084>>>    function_return name
33085>>>end_Function
33086>>>
33086>>>Function fsCNDescr String asItem Returns String
33087>>>    Clear CN
33088>>>    move asItem to CN.CN_Code
33089>>>    Find Eq CN by Index.5
33090>>>>
33090>>>    Function_Return CN.CN_Descr
33091>>>End_Function
33092>>>
33092>>>Function fswtypkin String askin Returns String
33093>>>    Clear Wtypkin
33094>>>    move askin to Wtypkin.wtypkin_code
33095>>>    Find Eq wtypkin by Index.1
33096>>>>
33096>>>    Function_Return Wtypkin.wtypkin_descr
33097>>>End_Function
33098>>>
33098>>>Function FindGtypkinDescr Integer aiCode Returns String
33099>>>    String lsDescr
33100>>>    Clear Gtypkin
INCLUDING FILE: GTYPKIN.FD
33101>>>    Move syscurxr.company_code    to Gtypkin.Company_Code
33102>>>    Move syscurxr.Branch_Code     to Gtypkin.Branch_Code
33103>>>    Move syscurxr.Year_year       to Gtypkin.Year_Year
33104>>>    Move aiCode                   to Gtypkin.Gtypkin_Code
33105>>>    Find eq Gtypkin by Index.1
33106>>>>
33106>>>    [Found] Move Gtypkin.Gtypkin_Descr to lsDescr
33107>>>    Function_Return lsDescr
33108>>>End_Function // FindGtypkinDescr
33109>>>
33109>>>Function FindBtypkinDescr Integer aiCode Returns String
33110>>>    String lsDescr
33111>>>    Clear Btypkin
INCLUDING FILE: BTYPKIN.FD
33112>>>    Move syscurxr.company_code    to Btypkin.Company_Code
33113>>>    Move syscurxr.Branch_Code     to Btypkin.Branch_Code
33114>>>    Move syscurxr.Year_year       to Btypkin.Year_Year
33115>>>    Move aiCode                   to Btypkin.btypkin_Code
33116>>>    Find eq Btypkin by Index.1
33117>>>>
33117>>>    [Found] Move Btypkin.Btypkin_Descr to lsDescr
33118>>>    Function_Return lsDescr
33119>>>End_Function // FindGtypkinDescr
33120>>>
33120>>>
33120>
33120>Use Menu_Sec.Sub
INCLUDING FILE: MENU_SEC.SUB
33120>>>
33120>>>Use Idiotht.pkg
INCLUDING FILE: IDIOTHT.PKG
33120>>>>>
33120>>>>>Open Users
33122>>>>>Open UserGrps
INCLUDING FILE: USERGRPS.FD
33124>>>>>Open Pedia
INCLUDING FILE: PEDIA.FD
33126>>>>>Open Arxeia
INCLUDING FILE: ARXEIA.FD
33128>>>>>Open GrpPedia
INCLUDING FILE: GRPPEDIA.FD
33130>>>>>Open GrpPed0
INCLUDING FILE: GRPPED0.FD
33132>>>>>Open GrpArx
INCLUDING FILE: GRPARX.FD
33134>>>>>Open GrpArx0
INCLUDING FILE: GRPARX0.FD
33136>>>>>Open ViewFlds
INCLUDING FILE: VIEWFLDS.FD
33138>>>>>Open Oth
INCLUDING FILE: OTH.FD
33140>>>>>Open GrpOth
INCLUDING FILE: GRPOTH.FD
33142>>>>>Open GrpOth0
INCLUDING FILE: GRPOTH0.FD
33144>>>>>Open Departm
INCLUDING FILE: DEPARTM.FD
33146>>>>>
33146>>>>>
33146>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
33147>>>>>
33147>>>>>Function Network_User_Name Returns String
33148>>>>>    Local String sName sLength
33149>>>>>    Local Pointer lpName_Addr lpLength_Addr
33149>>>>>    Local Integer iRetval
33149>>>>>    Movestr (Repeat (Character (0), 255)) To sName
33150>>>>>>
33150>>>>>    GetAddress Of sName To lpName_Addr
33151>>>>>    Movestr (DwordToBytes (255)) To sLength
33152>>>>>>
33152>>>>>    GetAddress Of sLength To lpLength_Addr
33153>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
33154>>>>>>
33154>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
33157>>>>>    Else Function_Return "User Unknown"
33159>>>>>End_Function // Network_User_Name
33160>>>>>
33160>>>>>Function fsGetOfficePath Global Returns String
33161>>>>>    String sRegistryKeyPath sRegOfficePath
33162>>>>>    Set_Registry_Root                                                   to HKEY_LOCAL_MACHINE "Software"
33163>>>>>    Move "Microsoft\Office\9.0\Word"                                    to sRegistryKeyPath
33164>>>>>    Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path"    to sRegOfficePath
33168>>>>>    Move (Trim(sRegOfficePath))                                         to sRegOfficePath
33169>>>>>    If (sRegOfficePath='') Begin
33171>>>>>        Move "Microsoft\Office\8.0\Word"                                to sRegistryKeyPath
33172>>>>>        Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33176>>>>>        Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33177>>>>>        If (sRegOfficePath='') Begin
33179>>>>>            Move "Microsoft\Office\7.0\Word"                             to sRegistryKeyPath
33180>>>>>            Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33184>>>>>            Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33185>>>>>            If (sRegOfficePath='') Begin
33187>>>>>                Move "Microsoft\Office\10.0\Word"                                to sRegistryKeyPath
33188>>>>>                Get_Foreign_Profile_String sRegistryKeyPath "InstallRoot" "Path" to sRegOfficePath
33192>>>>>                Move (Trim(sRegOfficePath))                                     to sRegOfficePath
33193>>>>>            End
33193>>>>>>
33193>>>>>        End
33193>>>>>>
33193>>>>>    End
33193>>>>>>
33193>>>>>    Function_Return sRegOfficePath
33194>>>>>End_Procedure
33195>>>>>
33195>>>>>
33195>>>>>Function fsGetLastDir Global Returns String
33196>>>>>    String sRegistryKeyPath sRegDir sUserName
33197>>>>>    Get Network_User_Name to sUserName
33198>>>>>
33198>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33201>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33204>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33206>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33208>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33209>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33210>>>>>    Get_profile_string sRegistryKeyPath "Path" to sRegDir
33213>>>>>    Function_Return sRegDir
33214>>>>>End_Procedure
33215>>>>>
33215>>>>>Function fiPutLastDir Global String asDirectory Returns Integer
33216>>>>>    String sRegistryKeyPath sRegDir sUserName
33217>>>>>    Get Network_User_Name to sUserName
33218>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to sRegistryKeyPath
33221>>>>>    If sRegistryKeyPath eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to sRegistryKeyPath
33224>>>>>    insert "WorkSpaces\" in sRegistryKeyPath at 1
33226>>>>>    Append sRegistryKeyPath  "\" (Module_Name(Self))
33228>>>>>    Append sRegistryKeyPath  "\LastDirUsed\"
33229>>>>>    Append sRegistryKeyPath  (Trim(sUserName))
33230>>>>>    Set_profile_string sRegistryKeyPath "Path" to asDirectory
33233>>>>>    Function_Return 0
33234>>>>>End_Procedure
33235>>>>>
33235>>>>>
33235>>>>>Function fsVresExt Global String asFileName Returns String
33236>>>>>    String rVal
33237>>>>>    Integer iPos iLen
33237>>>>>    Move (UpperCase(asFileName)) to asFileName
33238>>>>>    Move (Trim(asFileName)) to asFileName
33239>>>>>    Move 0 to iPos
33240>>>>>    For iLen from 1 to (length(asFileName))
33246>>>>>>
33246>>>>>        If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
33249>>>>>    Loop
33250>>>>>>
33250>>>>>    If (Not(iPos)) Function_Return ''
33253>>>>>    Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
33254>>>>>    Move (Trim(rVal)) to rVal
33255>>>>>    Function_Return rVal
33256>>>>>End_Function
33257>>>>>
33257>>>>>
33257>>>>>Function fiScreenFieldStatus Global String asViewName String asDbFormName Returns Integer
33258>>>>>    Integer rVal iUser iGroup
33259>>>>>    String  sUser sRecr
33259>>>>>    Move (Trim(asViewName))     to asViewName
33260>>>>>    Move (Trim(asDbFormName))   to asDbFormName
33261>>>>>
33261>>>>>    If ((asViewName<>'') And (asDbFormName<>'')) Begin
33263>>>>>        Get fsLoginUserID to sUser
33264>>>>>        Clear Users
33265>>>>>        Move sUser        to Users.Login_ID
33266>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33267>>>>>>
33267>>>>>        If (Found=1) Begin
33269>>>>>            Move Users.User_ID  to iUser
33270>>>>>            Move Users.Grp_ID   to iGroup
33271>>>>>            Clear GrpOth
33272>>>>>            Move iUser          to GrpOth.User_ID
33273>>>>>            Move asViewName     to GrpOth.View_Name
33274>>>>>            Move asDbFormName   to GrpOth.Scr_Field_Name
33275>>>>>            Find eq GrpOth by Index.2 // GrpOth:Index.2:User_ID+View_Name+Scr_Field_Name
33276>>>>>>
33276>>>>>            If (Found=1) Begin
33278>>>>>                // rVal=1 ==> NO READ ALLOWED
33278>>>>>                // rVal=2 ==> NO EDIT BUT CAN COPY
33278>>>>>                // rVal=3 ==> NO EDIT AND NO COPY
33278>>>>>                If (GrpOth.Allow_Read <>'1') Move 1 to rVal
33281>>>>>                Else Begin
33282>>>>>                    If (GrpOth.Allow_Change<>'1') Begin
33284>>>>>                        If (GrpOth.Allow_Copy<>'1') Move 3 to rVal
33287>>>>>                        Else                        Move 2 to rVal
33289>>>>>                    End
33289>>>>>>
33289>>>>>                End
33289>>>>>>
33289>>>>>            End
33289>>>>>>
33289>>>>>            Else Begin
33290>>>>>                Clear GrpOth0
33291>>>>>                Move iGroup         to GrpOth0.Group_ID
33292>>>>>                Move asViewName     to GrpOth0.View_Name
33293>>>>>                Move asDbFormName   to GrpOth0.Scr_Field_Name
33294>>>>>
33294>>>>>                Find eq GrpOth0 by Index.2 // GrpOth0:Index.2:Group_ID+View_Name+Scr_Field_Name
33295>>>>>>
33295>>>>>                If (Found=1) Begin
33297>>>>>                    // rVal=1 ==> NO READ ALLOWED
33297>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33297>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33297>>>>>                    If (GrpOth0.Allow_Read <>'1') Move 1 to rVal
33300>>>>>                    Else Begin
33301>>>>>                        If (GrpOth0.Allow_Change<>'1') Begin
33303>>>>>                            If (GrpOth0.Allow_Copy<>'1') Move 3 to rVal
33306>>>>>                            Else                         Move 2 to rVal
33308>>>>>                        End
33308>>>>>>
33308>>>>>                    End
33308>>>>>>
33308>>>>>                End
33308>>>>>>
33308>>>>>                Else Move 0 to rVal
33310>>>>>            End
33310>>>>>>
33310>>>>>        End
33310>>>>>>
33310>>>>>        Else Move 0 to rVal
33312>>>>>    End
33312>>>>>>
33312>>>>>    Function_Return rVal
33313>>>>>End_Function
33314>>>>>
33314>>>>>Function fiFieldStatus Global Integer aiFileNumber Integer aiFieldNumber Returns Integer
33315>>>>>    Integer rVal iUser iGroup
33316>>>>>    String  sUser sRecr
33316>>>>>    If ((aiFileNumber) And (aiFieldNumber)) Begin
33318>>>>>        Get fsLoginUserID to sUser
33319>>>>>        Clear Users
33320>>>>>        Move sUser        to Users.Login_ID
33321>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33322>>>>>>
33322>>>>>        If (Found=1) Begin
33324>>>>>            Move Users.User_ID  to iUser
33325>>>>>            Move Users.Grp_ID   to iGroup
33326>>>>>            Clear Pedia
33327>>>>>            Move aiFileNumber  to Pedia.Arxeio_ID
33328>>>>>            Move aiFieldNumber to Pedia.Pedio_Number
33329>>>>>            Find eq Pedia By Index.1 // Pedia:Index.1:Arxeio_ID+Pedio_Number
33330>>>>>>
33330>>>>>            If (Found=1) Begin
33332>>>>>                Move (Trim(Pedia.Pedio_Recr))   to sRecr
33333>>>>>                // Find Combination User/File/Field in GRPPEDIA
33333>>>>>                Clear GrpPedia
33334>>>>>                Move iUser                      to GrpPedia.User_ID
33335>>>>>                Move (Trim(sRecr))              to GrpPedia.Pedio_Recr
33336>>>>>                Find eq GrpPedia by Index.4 // GrpPedia:Index.4:Pedio_Recr + User_ID
33337>>>>>>
33337>>>>>                If (Found=1) Begin
33339>>>>>                    // rVal=1 ==> NO READ ALLOWED
33339>>>>>                    // rVal=2 ==> NO EDIT BUT CAN COPY
33339>>>>>                    // rVal=3 ==> NO EDIT AND NO COPY
33339>>>>>                    If (GrpPedia.Allow_Read <>'1') Move 1 to rVal
33342>>>>>                    Else Begin
33343>>>>>                        If (GrpPedia.Allow_Change<>'1') Begin
33345>>>>>                            If (GrpPedia.Allow_Copy<>'1')   Move 3 to rVal
33348>>>>>                            Else                            Move 2 to rVal
33350>>>>>                        End
33350>>>>>>
33350>>>>>                    End
33350>>>>>>
33350>>>>>                End
33350>>>>>>
33350>>>>>                Else Begin
33351>>>>>                    // Find Combination UserGrps/File/Field in GRPPED0
33351>>>>>                    Clear GrpPed0
33352>>>>>                    Move iGroup         to GrpPed0.Group_ID
33353>>>>>                    Move (Trim(sRecr))  to GrpPed0.Pedio_Recr
33354>>>>>                    Find eq GrpPed0 by Index.4 // GrpPed0:Index.4:Pedio_Recr + Group_ID
33355>>>>>>
33355>>>>>                    If (Found=1) Begin
33357>>>>>                        // rVal=1 ==> NO READ ALLOWED
33357>>>>>                        // rVal=2 ==> NO EDIT BUT CAN COPY
33357>>>>>                        // rVal=3 ==> NO EDIT AND NO COPY
33357>>>>>                        If (GrpPed0.Allow_Read <>'1') Move 1 to rVal
33360>>>>>                        Else Begin
33361>>>>>                            If (GrpPed0.Allow_Change<>'1') Begin
33363>>>>>                                If (GrpPed0.Allow_Copy<>'1')   Move 3 to rVal
33366>>>>>                                Else                           Move 2 to rVal
33368>>>>>                            End
33368>>>>>>
33368>>>>>                        End
33368>>>>>>
33368>>>>>                    End
33368>>>>>>
33368>>>>>                End
33368>>>>>>
33368>>>>>            End
33368>>>>>>
33368>>>>>            Else Begin
33369>>>>>                Move 0 to rVal
33370>>>>>            End
33370>>>>>>
33370>>>>>        End
33370>>>>>>
33370>>>>>        Else Begin
33371>>>>>            Move 0 to rVal
33372>>>>>        End
33372>>>>>>
33372>>>>>    End
33372>>>>>>
33372>>>>>    Function_Return rVal
33373>>>>>End_Function
33374>>>>>
33374>>>>>Function fsReturnFileFromPath Global String asFullPath Returns String
33375>>>>>    String rVal lsDirSep
33376>>>>>    Integer iPos iMet iLen iCnt
33376>>>>>    Move (Trim(asFullPath))                 To rVal
33377>>>>>    Move (Sysconf(SYSCONF_DIR_SEPARATOR))   To lsDirSep
33378>>>>>    If (rVal Contains lsDirSep) Begin
33380>>>>>        Move (Length(rVal)) to iLen
33381>>>>>        Move iLen to iCnt
33382>>>>>        While iCnt Gt 0
33386>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Begin
33388>>>>>                If (iCnt=iLen) Function_Return asFullPath
33391>>>>>                Else Function_Return (Right(rVal,(iLen-iCnt)))
33393>>>>>            End
33393>>>>>>
33393>>>>>            Decrement iCnt
33394>>>>>        End // While iCnt Gt 0
33395>>>>>>
33395>>>>>    End
33395>>>>>>
33395>>>>>    Else  Function_Return (Trim(asFullPath))
33397>>>>>    Function_Return rVal
33398>>>>>End_Function
33399>>>>>
33399>>>>>Function fsReturnDirectoriesFromPath Global String asFullPath Returns String
33400>>>>>    String rVal lsDirSep
33401>>>>>    Integer iPos iMet iLen iCnt
33401>>>>>    Move (Trim(asFullPath))                 To rVal
33402>>>>>    Move (Sysconf(SYSCOnF_DIR_SEPARATOR))   To lsDirSep
33403>>>>>    If (rVal Contains lsDirSep) Begin
33405>>>>>        Move (Length(rVal)) to iLen
33406>>>>>        Move iLen to iCnt
33407>>>>>        While iCnt Gt 0
33411>>>>>            If (Mid(rVal,1,iCnt)=lsDirSep) Function_Return (Left(rVal,iCnt))
33414>>>>>            Decrement iCnt
33415>>>>>        End // While iCnt Gt 0
33416>>>>>>
33416>>>>>    End
33416>>>>>>
33416>>>>>    Function_Return rVal
33417>>>>>End_Function
33418>>>>>
33418>>>>>//Function fsConvert_Time_Number_To_String_With_Zeroes Global Number anTime Returns String
33418>>>>>//    Local String rVal lsTmp lsOO lsLL
33418>>>>>//    Local Number lnOO lnLL
33418>>>>>
33418>>>>>//    Move '' to lsOO
33418>>>>>//    Move '' to lsLL
33418>>>>>//    Move '' to rVal
33418>>>>>
33418>>>>>//    Move (Integer(anTime))                              to lnOO
33418>>>>>//    ////////////////////////////////////////////
33418>>>>>//    // sos sos sos jsjsjsjsjs yannis 30/03/2000
33418>>>>>//    //If ((lnOO=24) and (lnll=0)) Move 0 to lnOO
33418>>>>>//    ////////////////////////////////////////////
33418>>>>>
33418>>>>>//    Move ((anTime - (Integer(anTime))) * 100)           to lnLL
33418>>>>>
33418>>>>>//    If (lnOO<10) Move (Append(lsOO,'0'+(String(lnOO)))) to lsOO
33418>>>>>//    Else         Move (String(lnOO))                    to lsOO
33418>>>>>//    Move (Trim(lsOO))                                   to lsOO
33418>>>>>
33418>>>>>//    If (lnLL<10) Move (Append(lsLL,'0'+(String(lnLL)))) to lsLL
33418>>>>>//    Else         Move (String(lnLL))                    to lsLL
33418>>>>>//    Move (Trim(lsLL))                                   to lsLL
33418>>>>>
33418>>>>>//    Move (Append(rVal,(lsOO+':'+lsLL))) to rVal
33418>>>>>
33418>>>>>//    Move (Trim(rVal)) to rVal
33418>>>>>
33418>>>>>//    Function_Return rVal
33418>>>>>//End_Function
33418>>>>>
33418>>>>>//Function fnConvert_Minutes_to_Time Global Integer aiMinutes Returns Number
33418>>>>>//    Local Number rVal nOres nLepta
33418>>>>>//    Move (Integer(aiMinutes/60))    to nOres
33418>>>>>//    Move (    Mod(aiMinutes,60))    to nLepta
33418>>>>>//    Move (nOres+(nLepta/100))       to rVal
33418>>>>>//    Function_Return rVal
33418>>>>>//End_Function
33418>>>>>
33418>>>>>//Function fiConvert_Time_to_Minutes Global Number anTime Returns Integer
33418>>>>>//    Local Integer rVal
33418>>>>>//    Move ((Integer(anTime)*60)+((anTime-(Integer(anTime)))*100)) to rVal
33418>>>>>//    Function_Return rVal
33418>>>>>//End_Function
33418>>>>>
33418>>>>>//Function fiConvert_Difference_StartTime_EndTime_to_Minutes Global   Number anStartTime  ;
33418>>>>>//                                                                    Number anEndTime    ;
33418>>>>>//                                                                    Returns Integer
33418>>>>>//    Local Integer rVal iMinStart iMinEnd
33418>>>>>
33418>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33418>>>>>
33418>>>>>//    Move ((Integer(anStartTime)*60)+((anStartTime-(Integer(anStartTime)))*100))  to iMinStart
33418>>>>>//    Move ((Integer(anEndTime  )*60)+((anEndTime  -(Integer(anEndTime  )))*100))  to iMinEnd
33418>>>>>//    Move (iMinEnd-iMinStart)                                                     to rVal
33418>>>>>//    Function_Return rVal
33418>>>>>//End_Function
33418>>>>>
33418>>>>>
33418>>>>>//Function fnConvert_Difference_StartTime_EndTime_to_Time Global  Number anStartTime  ;
33418>>>>>//                                                                Number anEndTime    ;
33418>>>>>//                                                                Returns Number
33418>>>>>//    Local Integer iTmp
33418>>>>>//    Local Number  rVal
33418>>>>>
33418>>>>>//    If (anStartTime >= anEndTime) Add 24 to anEndTime
33418>>>>>
33418>>>>>//    Move (fiConvert_Difference_StartTime_EndTime_to_Minutes(anStartTime,anEndTime)) to iTmp
33418>>>>>//    Move (fnConvert_Minutes_to_Time(iTmp))                                          to rVal
33418>>>>>//    Function_Return rVal
33418>>>>>//End_Function
33418>>>>>
33418>>>>>
33418>>>>>Function fsLoginUserID Global Returns String
33419>>>>>    Local String LastLogin# LoginUserid#
33420>>>>>    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin#
33423>>>>>    If LastLogin# eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin#
33426>>>>>    insert "WorkSpaces\" in LastLogin# at 1
33428>>>>>    Append LastLogin# "\" (Module_Name(Self)) "\LastLogin"
33431>>>>>    get_profile_string LastLogin# "LoginUserId"  to LoginUserId#
33434>>>>>    Trim LoginUserID# to LoginUserID#
33435>>>>>>
33435>>>>>    If LoginUserId# eq "" Move (Network_User_Name(Current_Object)) to LoginUserId#
33438>>>>>    Function_Return LoginUserID#
33439>>>>>End_Function
33440>>>>>
33440>>>>>Function fiWriteRegistryLastSDFPath Global String asLastPath Returns Integer
33441>>>>>    Integer rVal
33442>>>>>    String  lsCurrentWksp
33442>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33445>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33448>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33450>>>>>    // Œœ¦ ¡¢œ ›   - Last_SDF_Path -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33450>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33450>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33453>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33456>>>>>    Function_Return rVal
33457>>>>>End_Function
33458>>>>>
33458>>>>>
33458>>>>>Function fsReadRegistryLastSDFPath Global Returns String
33459>>>>>    String rVal lsCurrentWksp
33460>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33463>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33466>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33468>>>>>    // Œœ¦ ¡¢œ ›   - LastParastUsed -  ¡˜«à ˜§¦ «¦ ©¬š¡œ¡¨ £œ¤¦
33468>>>>>    // workspace §¦¬ ›¦¬¢œ¬¦¬£œ
33468>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_SDF_Path"
33471>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33474>>>>>    Function_Return (Trim(rVal))
33475>>>>>End_Function
33476>>>>>
33476>>>>>
33476>>>>>Function fiWriteRegistryLastMCryptPath Global String asLastPath Returns Integer
33477>>>>>    Integer rVal
33478>>>>>    String  lsCurrentWksp
33478>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33481>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33484>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33486>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33489>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33492>>>>>    Function_Return rVal
33493>>>>>End_Function
33494>>>>>
33494>>>>>
33494>>>>>Function fsReadRegistryLastMCryptPath Global Returns String
33495>>>>>    String rVal lsCurrentWksp
33496>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33499>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33502>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33504>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_MCrypt_Path"
33507>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33510>>>>>    Function_Return (Trim(rVal))
33511>>>>>End_Function
33512>>>>>
33512>>>>>Function fiWriteRegistryLastWEBPath Global String asLastPath Returns Integer
33513>>>>>    Integer rVal
33514>>>>>    String  lsCurrentWksp
33514>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33517>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33520>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33522>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33525>>>>>    Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33528>>>>>    Function_Return rVal
33529>>>>>End_Function
33530>>>>>
33530>>>>>
33530>>>>>Function fsReadRegistryLastWEBPath Global Returns String
33531>>>>>    String rVal lsCurrentWksp
33532>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33535>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33538>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33540>>>>>    Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_WEB_Path"
33543>>>>>    Get_Profile_String lsCurrentWksp "Path"  to rVal
33546>>>>>    Function_Return (Trim(rVal))
33547>>>>>End_Function
33548>>>>>
33548>>>>>Function fsReadRegistryFEMRootDir Global Returns String
33549>>>>>    String rVal lsCurrentWksp
33550>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33553>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33556>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33558>>>>>    Append lsCurrentWksp "\FEM"
33559>>>>>    Get_Profile_String lsCurrentWksp "RootDir"  to rVal
33562>>>>>    Function_Return (Trim(rVal))
33563>>>>>End_Function
33564>>>>>
33564>>>>>Function fsReadRegistryFEMDevicePath Global Returns String
33565>>>>>    String rVal lsCurrentWksp
33566>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33569>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33572>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33574>>>>>    Append lsCurrentWksp "\FEM"
33575>>>>>    Get_Profile_String lsCurrentWksp "DevicePath"  to rVal
33578>>>>>    Function_Return (Trim(rVal))
33579>>>>>End_Function
33580>>>>>
33580>>>>>Function fiWriteRegistryFEMRootDir Global Returns Integer
33581>>>>>    Integer rVal
33582>>>>>    String  lsCurrentWksp
33582>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33585>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33588>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33590>>>>>    Append lsCurrentWksp "\FEM"
33591>>>>>    Set_Profile_String lsCurrentWksp "RootDir"  to "C:\FEM_ROOT\"
33594>>>>>    Function_Return rVal
33595>>>>>End_Function
33596>>>>>
33596>>>>>Function fiWriteRegistryFEMDevicePath Global Returns Integer
33597>>>>>    Integer rVal
33598>>>>>    String  lsCurrentWksp
33598>>>>>    Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33601>>>>>    If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33604>>>>>    Insert "WorkSpaces\" in lsCurrentWksp at 1
33606>>>>>    Append lsCurrentWksp "\FEM"
33607>>>>>    Set_Profile_String lsCurrentWksp "DevicePath"  to "C:\FEM_ROOT\Device_File1.dat"
33610>>>>>    Function_Return rVal
33611>>>>>End_Function
33612>>>>>
33612>>>>>
33612>>>>>
33612>>>>>
33612>>>>>        Function fiWriteRegistryLastDEDPath Global String asLastPath Returns Integer
33613>>>>>            Integer rVal
33614>>>>>            String  lsCurrentWksp
33614>>>>>            Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33617>>>>>            If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33620>>>>>            Insert "WorkSpaces\" in lsCurrentWksp at 1
33622>>>>>            Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_DED_Path"
33625>>>>>            Set_Profile_String lsCurrentWksp "Path"  to (Trim(asLastPath))
33628>>>>>            Function_Return rVal
33629>>>>>        End_Function
33630>>>>>
33630>>>>>
33630>>>>>        Function fsReadRegistryLastDEDPath Global Returns String
33631>>>>>            String rVal lsCurrentWksp
33632>>>>>            Get_Profile_String "WorkSpaces" "CurrentWorkspace" to lsCurrentWksp
33635>>>>>            If (lsCurrentWksp="") Get WorkspaceName of (ProgramWorkspace(Self)) to lsCurrentWksp
33638>>>>>            Insert "WorkSpaces\" in lsCurrentWksp at 1
33640>>>>>            Append lsCurrentWksp "\" (Module_Name(Self)) "\Last_DED_Path"
33643>>>>>            Get_Profile_String lsCurrentWksp "Path"  to rVal
33646>>>>>            Function_Return (Trim(rVal))
33647>>>>>        End_Function
33648>>>>>
33648>>>>>
33648>>>>>
33648>>>>>Function fig_Is_Admin Global Returns Integer
33649>>>>>    String sUser
33650>>>>>    Integer rVal
33650>>>>>    Get fsLoginUserID to sUser
33651>>>>>    Move (trim(sUser)) to sUser
33652>>>>>    Clear Users
33653>>>>>    Move sUser to Users.Login_ID
33654>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33655>>>>>>
33655>>>>>    Move Users.Admin_Rights to rVal
33656>>>>>    Function_Return rVal
33657>>>>>End_Function
33658>>>>>
33658>>>>>Function fig_The_User_Group Global Returns Integer
33659>>>>>    String sUser
33660>>>>>    Get fsLoginUserID   to sUser
33661>>>>>    Move (trim(sUser))  to sUser
33662>>>>>    Clear Users
33663>>>>>    Move sUser          to Users.Login_ID
33664>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33665>>>>>>
33665>>>>>    Clear UserGrps
33666>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33667>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33668>>>>>>
33668>>>>>    Function_Return UserGrps.Grp_ID
33669>>>>>End_Function
33670>>>>>
33670>>>>>Function fsg_The_User_Department Global Returns String
33671>>>>>    String sUser
33672>>>>>    Get fsLoginUserID   to sUser
33673>>>>>    Move (trim(sUser))  to sUser
33674>>>>>    Clear Users
33675>>>>>    Move sUser          to Users.Login_ID
33676>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33677>>>>>>
33677>>>>>    Clear Departm
33678>>>>>    Move Users.Departm_Code   to Departm.Code
33679>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33680>>>>>>
33680>>>>>    Function_Return Departm.Code
33681>>>>>End_Function
33682>>>>>
33682>>>>>
33682>>>>>Function fig_Is_Specific_Admin Global String asUser Returns Integer
33683>>>>>    Integer rVal
33684>>>>>    Move (trim(asUser)) to asUser
33685>>>>>    Clear Users
33686>>>>>    Move asUser to Users.Login_ID
33687>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33688>>>>>>
33688>>>>>    Move Users.Admin_Rights to rVal
33689>>>>>    Function_Return rVal
33690>>>>>End_Function
33691>>>>>
33691>>>>>Function fig_The_Specific_User_Group Global String asUser Returns Integer
33692>>>>>    Move (trim(asUser))  to asUser
33693>>>>>    Clear Users
33694>>>>>    Move asUser          to Users.Login_ID
33695>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33696>>>>>>
33696>>>>>    Clear UserGrps
33697>>>>>    Move Users.Grp_ID   to UserGrps.Grp_ID
33698>>>>>    Find eq UserGrps By Index.1 // UserGrps:Index.1:Grp_ID
33699>>>>>>
33699>>>>>    Function_Return UserGrps.Grp_ID
33700>>>>>End_Function
33701>>>>>
33701>>>>>Function fsg_The_Specific_User_Department Global String asUser Returns String
33702>>>>>    Move (trim(asUser))  to asUser
33703>>>>>    Clear Users
33704>>>>>    Move asUser          to Users.Login_ID
33705>>>>>    Find eq Users By Index.1 // Users:Index.1:Login_ID
33706>>>>>>
33706>>>>>    Clear Departm
33707>>>>>    Move Users.Departm_Code   to Departm.Code
33708>>>>>    Find eq Departm By Index.1 // Departm:Index.1:Code
33709>>>>>>
33709>>>>>    Function_Return Departm.Code
33710>>>>>End_Function
33711>>>>>
33711>>>>>
33711>>>
33711>>>Class ViewPopupMenu_Sec Is A ViewPopupMenu
33712>>>
33712>>>    Open Sysfile
INCLUDING FILE: SYSFILE.FD
33714>>>    Open Users
33716>>>    Open Views
INCLUDING FILE: VIEWS.FD
33718>>>    Open GrpViews
INCLUDING FILE: GRPVIEWS.FD
33720>>>    Open GrpView0
INCLUDING FILE: GRPVIEW0.FD
33722>>>    Open Arxeia
33724>>>    Open GrpArx
33726>>>
33726>>>    Function Find_User_Rights_In_Class String asView Returns Integer
33727>>>        String  lsView lsLogin
33728>>>        Integer liUser  liViews iGroup
33728>>>
33728>>>        Move (fsLoginUserID())      to lsLogin
33729>>>        Move (Trim(ToOEM(asView)))  to lsView
33730>>>
33730>>>        //////  /////////////////////////////////////
33730>>>        Clear Users
33731>>>        Move lsLogin    to Users.Login_ID
33732>>>
33732>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33733>>>>
33733>>>        If (Found=1)  Begin
33735>>>            Move Users.User_ID  to liUser
33736>>>            Move Users.Grp_ID   to iGroup
33737>>>        End
33737>>>>
33737>>>        Else Function_Return 0
33739>>>
33739>>>        Clear Views
33740>>>        Move (Trim(lsView)) to Views.Menu_Name
33741>>>        Find eq Views by Index.2 // Views:Index.2:Views.Menu_Name
33742>>>>
33742>>>        If (Found=1) Begin
33744>>>            Move Views.View_ID to liViews
33745>>>            Clear GrpViews
33746>>>            Move liUser    to GrpViews.User_ID
33747>>>            Move liViews   to GrpViews.View_ID
33748>>>            Find Eq GrpViews by Index.1 // GrpViews:Index.1:GrpViews.User_ID+GrpViews.View_ID
33749>>>>
33749>>>            If (Found=1) Begin // And (liUser=GrpViews.User_ID) And (liViews=GrpViews.View_ID)) Begin
33751>>>                Function_Return (GrpViews.Allow_Read<>'1')
33752>>>            End
33752>>>>
33752>>>            Else Begin
33753>>>                Clear GrpView0
33754>>>                Move iGroup    to GrpView0.Group_ID
33755>>>                Move liViews   to GrpView0.View_ID
33756>>>                Find eq GrpView0 by Index.1 // GrpView0:Index.1:Group_ID+View_ID
33757>>>>
33757>>>                If (Found=1) Begin
33759>>>                    Function_Return (GrpView0.Allow_Read<>'1')
33760>>>                End
33760>>>>
33760>>>                Else         Function_Return 0
33762>>>            End
33762>>>>
33762>>>        End
33762>>>>
33762>>>        Else Function_Return 0
33764>>>    End_Function
33765>>>
33765>>>//    Procedure Enhmerose_Views_File_In_Class
33765>>>//        Integer liCount liInt liLastNo
33765>>>//        String lsStr
33765>>>//        Get Item_Count to liCount
33765>>>//        // find last view_id
33765>>>//        Clear Views
33765>>>//        Move 9999 to Views.View_ID
33765>>>//        Find lt Views by index.1 // view_id
33765>>>//        If (Found=1)    Move Views.View_ID  to liLastNo
33765>>>//        Else            Move 0              to liLastNo
33765>>>//        For liInt From 0 to (liCount-1)
33765>>>//            Get Value item liInt to lsStr
33765>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
33765>>>//            //Move (Trim(lsStr)) to lsStr
33765>>>//            If (lsStr<>'') Begin
33765>>>//                Clear Views
33765>>>//                Move lsStr to Views.Menu_Name
33765>>>//                Find eq Views by index.2 // Views.Menu_Name
33765>>>//                If (NOT(Found)) Begin
33765>>>//                    Add 1 to liLastNo
33765>>>//                    Move liLastNo to Views.View_ID
33765>>>//                    Saverecord Views
33765>>>//                End
33765>>>//            End
33765>>>//        Loop
33765>>>//        For liInt From 0 to (liCount-1)
33765>>>//            Get Value item liInt to lsStr
33765>>>//            Move (Trim(ToOEM(lsStr))) to lsStr
33765>>>//            //Move (Trim(lsStr)) to lsStr
33765>>>//            If (lsStr<>'') Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
33765>>>//        Loop
33765>>>//    End_procedure
33765>>>
33765>>>    Procedure OnInitMenu
33766>>>        Integer liCount liInt liLastNo
33767>>>        String lsStr
33767>>>
33767>>>        Get Item_Count to liCount
33768>>>
33768>>>        // find last view_id
33768>>>        Clear Views
33769>>>        Move 9999 to Views.View_ID
33770>>>        Find lt Views by index.1 // view_id
33771>>>>
33771>>>        If (Found=1)    Move Views.View_ID  to liLastNo
33774>>>        Else            Move 0              to liLastNo
33776>>>        For liInt From 0 to (liCount-1)
33782>>>>
33782>>>            Get Value item liInt to lsStr
33783>>>            Move (Trim(lsStr)) to lsStr
33784>>>            If ((lsStr<>'') and (Length(lsStr)>2)) Begin
33786>>>                Clear Views
33787>>>                Move (ToOEM(lsStr)) to Views.Menu_Name
33788>>>                Find eq Views by index.2 // Views.Menu_Name
33789>>>>
33789>>>                If (NOT(Found)) Begin
33791>>>                    Add 1 to liLastNo
33792>>>                    Move liLastNo to Views.View_ID
33793>>>                    //Move (ToOEM(lsStr)) to Views.Menu_Name
33793>>>                    Saverecord Views
33794>>>                End
33794>>>>
33794>>>            End
33794>>>>
33794>>>        Loop
33795>>>>
33795>>>        For liInt From 0 to (liCount-1)
33801>>>>
33801>>>            Get Value item liInt to lsStr
33802>>>            Move (Trim(lsStr)) to lsStr
33803>>>            Set Shadow_State item liInt to (Find_User_Rights_In_Class(Self,lsStr))
33804>>>        Loop
33805>>>>
33805>>>
33805>>>    End_procedure
33806>>>
33806>>>//    Procedure End_Construct_Object
33806>>>//        Forward Send End_Construct_Object
33806>>>//        Send Enhmerose_Views_File_In_Class
33806>>>//    End_Procedure
33806>>>
33806>>>End_Class //ButtonSub
33807>>>
33807>>>
33807>Use DD_Sec.Sub
INCLUDING FILE: DD_SEC.SUB
33807>>>
33807>>>Open Sysfile
33809>>>Open UserGrps
33811>>>Open Users
33813>>>Open Views
33815>>>Open GrpViews
33817>>>Open Arxeia
33819>>>Open GrpArx
33821>>>Open GrpArx0
33823>>>Open GrpView0
33825>>>
33825>>>Use DD.Sub
33825>>>
33825>>>Class Datadictionary_Sec  Is A DatadictionarySub
33826>>>
33826>>>
33826>>>    Procedure Construct_Object
33827>>>        Forward Send Construct_Object
33829>>>        Property Integer cpiUpdate              0
33830>>>        Property Integer cpiBackout             0
33831>>>        Property Integer cpiEditing             0
33832>>>        Property Integer cpiFileNumber          0
33833>>>        Property String  cpsFileName            ''
33834>>>        Property String  cpsLoginID             ''
33835>>>        Property Integer cpiCannot_Read         0
33836>>>        Property Integer cpiCannot_Create       0
33837>>>        Property Integer cpiCannot_Delete       0
33838>>>        Property Integer cpiCannot_Edit         0
33839>>>        Property Integer piFN                   0
33840>>>    End_Procedure
33841>>>
33841>>>//    Procedure Save_Main_File
33841>>>//        If (Operation_Origin<>Self) Begin
33841>>>//            If Indirect_File.Recnum Eq 0 Procedure_Return
33841>>>//        End
33841>>>//        Forward Send Save_Main_File
33841>>>//    End_Procedure
33841>>>
33841>>>
33841>>>
33841>>>    Function Validate_Save Returns Integer
33842>>>        Integer rVal
33843>>>        Forward Get Validate_Save to rVal
33845>>>        If (Not(rVal)) Begin
33847>>>            Get cpiCannot_Read to rVal
33848>>>            If (Not(rVal)) Begin
33850>>>                Set cpiEditing to ((cpiBackout(Self)=1) and (cpiUpdate(Self)=1))
33851>>>                If (cpiEditing(Self)=1) Get cpiCannot_Edit      to rVal
33854>>>                Else                    Get cpiCannot_Create    to rVal
33856>>>            End
33856>>>>
33856>>>            If (rVal) Send Operation_Not_Allowed rVal
33859>>>        End
33859>>>>
33859>>>        Function_Return rVal
33860>>>    End_Function
33861>>>
33861>>>    Function Validate_Delete Returns Integer
33862>>>        Integer rVal
33863>>>        Forward Get Validate_Delete to rVal
33865>>>        If (Not(rVal)) Begin
33867>>>            Get cpiCannot_Read to rVal
33868>>>            If (Not(rVal)) Get cpiCannot_Delete to rVal
33871>>>            If (rVal) Send Operation_Not_Allowed rVal
33874>>>        End
33874>>>>
33874>>>        Function_Return rVal
33875>>>    End_Function
33876>>>
33876>>>    Procedure End_Construct_Object
33877>>>        Integer liSrv rVal
33878>>>        String lsStr
33878>>>        Forward Send End_Construct_Object
33880>>>        Get Main_File                                   To liSrv
33881>>>        Set cpiFileNumber                               To liSrv
33882>>>        Get_Attribute DF_FILE_PHYSICAL_NAME Of liSrv    To lsStr
33885>>>        Set cpsFileName                                 To (Trim(Uppercase(lsStr)))
33886>>>        Set cpsLoginID                                  To (fsLoginUserID())
33887>>>        Send Find_User_Rights
33888>>>        Set piFN to lisrv
33889>>>    End_Procedure
33890>>>
33890>>>    Procedure Find_User_Rights
33891>>>        String lsArxeio lsLogin
33892>>>        Integer liUser liArxeio iGroup
33892>>>
33892>>>        Get cpiFileNumber   to liArxeio
33893>>>        Get cpsFileName     to lsArxeio
33894>>>        Get cpsLoginID      to lsLogin
33895>>>
33895>>>        Clear Users
33896>>>        Move lsLogin    to Users.Login_ID
33897>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
33898>>>>
33898>>>        If (Found=1)  Begin
33900>>>            Move Users.User_ID  to liUser
33901>>>            Move Users.Grp_ID   to iGroup
33902>>>        End
33902>>>>
33902>>>        //Else Send Operation_Not_Allowed 9999
33902>>>
33902>>>        Clear Arxeia
33903>>>
33903>>>        Move liArxeio to Arxeia.Arxeio_ID
33904>>>        Find eq Arxeia by Index.1 // Arxeia:Index.1:Arxeia.Arxeio_ID
33905>>>>
33905>>>
33905>>>        If (Found=1) Begin
33907>>>            Move Arxeia.Arxeio_ID to liArxeio
33908>>>
33908>>>            Clear GrpArx
33909>>>            Move liUser     to GrpArx.User_ID
33910>>>            Move liArxeio   to GrpArx.Arxeio_ID
33911>>>            Find eq GrpArx by Index.1 // GrpArx:Index.1:GrpArx.User_ID+GrpArx.Arxeio_ID
33912>>>>
33912>>>            If (Found=1) Begin
33914>>>               If (GrpArx.Allow_Read  ='1') Set cpiCannot_Read   to 0
33917>>>               Else                         Set cpiCannot_Read   to 10003
33919>>>               If (GrpArx.Allow_Create='1') Set cpiCannot_Create to 0
33922>>>               Else                         Set cpiCannot_Create to 10000
33924>>>               If (GrpArx.Allow_Change='1') Set cpiCannot_Edit   to 0
33927>>>               Else                         Set cpiCannot_Edit   to 10001
33929>>>               If (GrpArx.Allow_Delete='1') Set cpiCannot_Delete to 0
33932>>>               Else                         Set cpiCannot_Delete to 10002
33934>>>            End
33934>>>>
33934>>>            Else Begin
33935>>>                Clear GrpArx0
33936>>>                Move iGroup   to GrpArx0.Group_ID
33937>>>                Move liArxeio to GrpArx0.Arxeio_ID
33938>>>                Find eq GrpArx0 by Index.1 // GrpArx0:Index.1:Group_ID+Arxeio_ID
33939>>>>
33939>>>                If (Found=1) Begin
33941>>>                    If (GrpArx0.Allow_Read  ='1')   Set cpiCannot_Read   to 0
33944>>>                    Else                            Set cpiCannot_Read   to 20003
33946>>>                    If (GrpArx0.Allow_Create='1')   Set cpiCannot_Create to 0
33949>>>                    Else                            Set cpiCannot_Create to 20000
33951>>>                    If (GrpArx0.Allow_Change='1')   Set cpiCannot_Edit   to 0
33954>>>                    Else                            Set cpiCannot_Edit   to 20001
33956>>>                    If (GrpArx0.Allow_Delete='1')   Set cpiCannot_Delete to 0
33959>>>                    Else                            Set cpiCannot_Delete to 20002
33961>>>                End
33961>>>>
33961>>>                Else Begin
33962>>>                    Set cpiCannot_Read   to 0
33963>>>                    Set cpiCannot_Edit   to 0
33964>>>                    Set cpiCannot_Create to 0
33965>>>                    Set cpiCannot_Delete to 0
33966>>>                End
33966>>>>
33966>>>            End
33966>>>>
33966>>>        End
33966>>>>
33966>>>        Else Begin
33967>>>            // €¤ ›œ¤ ™¨œŸœ  «¦ ˜¨®œ ¦ «¦«œ Ÿœà¨¦¬£œ ¦«  ¦ ®¨ž©«žª œ®œ  §¨¦©™˜©ž ©'˜¬«¦
33967>>>            Set cpiCannot_Read   to 0
33968>>>            Set cpiCannot_Edit   to 0
33969>>>            Set cpiCannot_Create to 0
33970>>>            Set cpiCannot_Delete to 0
33971>>>        End
33971>>>>
33971>>>    End_Procedure
33972>>>
33972>>>    Procedure Clear_main_file
33973>>>        Forward Send Clear_main_file
33975>>>        Set cpiBackout to 0
33976>>>        Set cpiUpdate  to 0
33977>>>    End_Procedure
33978>>>
33978>>>    Procedure Update
33979>>>        Forward Send Update
33981>>>        Set cpiUpdate to 1
33982>>>    End_Procedure
33983>>>
33983>>>    Procedure Backout
33984>>>        Forward Send Backout
33986>>>        Set cpiBackout to 1
33987>>>    End_Procedure
33988>>>
33988>>>    Procedure OnConstrain
33989>>>        Integer rVal liSrv
33990>>>        Forward Send OnConstrain
33992>>>        Get cpiFileNumber  To liSrv
33993>>>        Move liSrv         To Filenumber
33994>>>        Get cpiCannot_Read to rVal
33995>>>        If (rVal) Constrain Indirect_File.Recnum eq 0
33999>>>    End_Procedure
34000>>>
34000>>>    Procedure Operation_Not_Allowed  Integer iError_Num
34001>>>        String sLektiko
34002>>>        Move '' to sLektiko
34003>>>
34003>>>             If iError_Num eq 10000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34006>>>        Else If iError_Num eq 10001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Users permissions. Check with your Administrator"    to sLektiko
34010>>>        Else If iError_Num eq 10002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34014>>>        Else If iError_Num eq 10003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Users permissions. Check with your Administrator" to sLektiko
34018>>>        Else If iError_Num eq 20000 Move "Unsufficient Rights For Creating Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34022>>>        Else If iError_Num eq 20001 Move "Unsufficient Rights For Changing Data in This File.\nFrom Group permissions. Check with your Administrator"    to sLektiko
34026>>>        Else If iError_Num eq 20002 Move "Unsufficient Rights For Deleting Records in This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34030>>>        Else If iError_Num eq 20003 Move "Unsufficient Rights For Accessing Data From This File.\nFrom Group permissions. Check with your Administrator" to sLektiko
34034>>>        Else If iError_Num eq  9999 Move "Unknown User in Users File"                                                                                    to sLektiko
34038>>>        Else If iError_Num eq 20101 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Change its Data"                 to sLektiko
34042>>>        Else If iError_Num eq 20102 Move "Only Users Belonging to the Initial Department \nThat Created This Record can Delete It"                       to sLektiko
34046>>>        Append sLektiko '\nFile = ' (String(cpiFileNumber(Self))) ' - ' (CpsFileName(Self))
34050>>>
34050>>>             If iError_Num eq 10000 Error 10000 sLektiko
34053>>>        Else If iError_Num eq 10001 Error 10001 sLektiko
34057>>>        Else If iError_Num eq 10002 Error 10002 sLektiko
34061>>>        Else If iError_Num eq 10003 Error 10003 sLektiko
34065>>>        Else If iError_Num eq 20000 Error 20000 sLektiko
34069>>>        Else If iError_Num eq 20001 Error 20001 sLektiko
34073>>>        Else If iError_Num eq 20002 Error 20002 sLektiko
34077>>>        Else If iError_Num eq 20003 Error 20003 sLektiko
34081>>>        Else If iError_Num eq  9999 Error  9999 sLektiko
34085>>>        Else If iError_Num eq 20101 Error 20101 sLektiko
34089>>>        Else If iError_Num eq 20102 Error 20102 sLektiko
34093>>>
34093>>>        Else Forward Send Operation_Not_Allowed  iError_Num
34096>>>    End_Procedure   // Operation_Not_Allowed
34097>>>
34097>>>
34097>>>End_Class //Datadictionary_Sec
34098>
34098>Use WinQlSQL.Sub
INCLUDING FILE: WINQLSQL.SUB
34098>>>Use CrystalReport.pkg
34098>>>
34098>>>Define PE_SUBREPORT_NAME_LEN       for 128
34098>>>
34098>>>Type PESubreportInfo
34098>>>  Field PESubreportInfo.structSize as Word
34098>>>  Field PESubreportInfo.name       as Char PE_SUBREPORT_NAME_LEN
34098>>>  Field PESubreportInfo.NLinks     as Short
34098>>>  Field PESubreportInfo.IsOnDemand as Short
34098>>>End_Type // PESubreportInfo
34098>>>
34098>>>
34098>>>External_Function PEGetNSections "PEGetNSections" CRPE32.DLL ;  Integer printJob ;  Returns Integer
34099>>>
34099>>>External_Function PEGetSectionCode "PEGetSectionCode" CRPE32.DLL ;  Integer printJob ;  Integer sectionN ;  Returns Integer
34100>>>
34100>>>External_Function PECloseSubreport "PECloseSubreport" CRPE32.DLL ;  Integer printJob ;  Returns Integer
34101>>>
34101>>>External_Function PEGetNSubreportsInSection "PEGetNSubreportsInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Returns Integer
34102>>>
34102>>>External_Function PEGetNthSubreportInSection "PEGetNthSubreportInSection" CRPE32.DLL ;  Integer printJob ;  Integer sectionCode ;  Integer subreportN ;  Returns Integer
34103>>>
34103>>>External_Function PEGetSubreportInfo "PEGetSubreportInfo" CRPE32.DLL ;  Integer printJob ;  Integer subreportHandle ;  Pointer subreportInfo ;  Returns Integer
34104>>>
34104>>>External_Function PEOpenSubreport "PEOpenSubreport" CRPE32.DLL ;  Integer parentJob ;  Pointer subreportName ;  Returns Integer
34105>>>
34105>>>
34105>>>Type PEWindowOptions
34105>>>  Field PEWindowOptions.StructSize As Word
34105>>>  Field PEWindowOptions.hasGroupTree As Word
34105>>>  Field PEWindowOptions.canDrillDown As Word
34105>>>  Field PEWindowOptions.hasNavigationControls As Word
34105>>>  Field PEWindowOptions.hasCancelButton As Word
34105>>>  Field PEWindowOptions.hasPrintButton As Word
34105>>>  Field PEWindowOptions.hasExportButton As Word
34105>>>  Field PEWindowOptions.hasZoomControl As Word
34105>>>  Field PEWindowOptions.hasCloseButton As Word
34105>>>  Field PEWindowOptions.hasProgressControls As Word
34105>>>  Field PEWindowOptions.hasSearchButton As Word
34105>>>  Field PEWindowOptions.hasPrintSetupButton As Word
34105>>>  Field PEWindowOptions.hasRefreshButton As Word
34105>>>End_Type // PEWindowOptions
34105>>>
34105>>>External_Function32 PESetWindowOptions "PESetWindowOptions" CRPE32.DLL ;  Integer printJob pointer Options Returns Integer
34106>>>
34106>>>Class CrystalReportSubSQL Is A CrystalReport
34107>>>
34107>>>    Procedure Construct_Object
34108>>>        Forward send Construct_Object
34110>>>        // Everything on except hasGroupTree by default
34110>>>        property integer hasGroupTree 0
34111>>>        property integer canDrillDown 1
34112>>>        property integer hasNavigationControls 1
34113>>>        property integer hasCancelButton 1
34114>>>        property integer hasPrintButton 1
34115>>>        property integer hasExportButton 1
34116>>>        property integer hasZoomControl 1
34117>>>        property integer hasCloseButton 1
34118>>>        property integer hasProgressControls 1
34119>>>        property integer hasSearchButton 1
34120>>>        property integer hasPrintSetupButton 1
34121>>>        property integer hasRefreshButton 1
34122>>>
34122>>>        Set WindowStyle To (WS_MAXIMIZE iOr WS_OVERLAPPEDWINDOW)
34123>>>    End_Procedure // Construct_Object
34124>>>
34124>>>    Procedure OutputToWindow String sTitle Integer iLeft Integer iTop Integer iWidth Integer iHeight Integer iStyle Handle hParent
34125>>>        Integer iPrintJob iResult
34126>>>        String sPEWindowOptions
34126>>>        Pointer pPeWindowOptions
34126>>>
34126>>>        Get PrintJob To iPrintJob
34127>>>        FillType PEWindowOptions with 0     to sPEWindowOptions
34128>>>        put PEWindowOptions_Size            to sPEWindowOptions at PEWindowOptions.StructSize
34129>>>        put (hasGroupTree(self))            to sPEWindowOptions at PEWindowOptions.hasGroupTree
34130>>>        put (canDrillDown(self))            to sPEWindowOptions at PEWindowOptions.canDrillDown
34131>>>        put (hasNavigationControls(self))   to sPEWindowOptions at PEWindowOptions.hasNavigationControls
34132>>>        put (hasCancelButton(self))         to sPEWindowOptions at PEWindowOptions.hasCancelButton
34133>>>        put (hasPrintButton(self))          to sPEWindowOptions at PEWindowOptions.hasPrintButton
34134>>>        put (hasExportButton(self))         to sPEWindowOptions at PEWindowOptions.hasExportButton
34135>>>        put (hasZoomControl(self))          to sPEWindowOptions at PEWindowOptions.hasZoomControl
34136>>>        put (hasCloseButton(self))          to sPEWindowOptions at PEWindowOptions.hasCloseButton
34137>>>        put (hasProgressControls(self))     to sPEWindowOptions at PEWindowOptions.hasProgressControls
34138>>>        put (hasSearchButton(self))         to sPEWindowOptions at PEWindowOptions.hasSearchButton
34139>>>        put (hasPrintSetupButton(self))     to sPEWindowOptions at PEWindowOptions.hasPrintSetupButton
34140>>>        put (hasRefreshButton(self))        to sPEWindowOptions at PEWindowOptions.hasrefreshButton
34141>>>        GetAddress of sPEWindowOptions      to pPEWindowOptions
34142>>>        Move (PESetWindowOptions(iPrintJob, pPEWindowOptions)) to iResult
34143>>>        Forward Send OutputToWindow sTitle iLeft iTop iWidth iHeight iStyle hParent
34145>>>    End_Procedure // OutputToWindow
34146>>>
34146>>>    Procedure Set TmpFileDir String aDir
34147>>>        String lsCurrWspc lsDir
34148>>>
34148>>>//        If (ghoWorkSpace <> 0) Begin
34148>>>//            Get WorkSpaceName of ghoWorkSpace to lsCurrWspc
34148>>>//            Insert "WorkSpaces\" in lsCurrWspc at 1
34148>>>//            Get_Profile_String lsCurrWspc aDir to lsDir
34148>>>//            Set Report_Data_Path to lsDir
34148>>>//        End
34148>>>    End_Procedure
34149>>>
34149>>>    Procedure DoWinQLReport
34150>>>        // This can be used when reports must be able to run in different data directories
34150>>>        Set TmpFileDir to "TmpFileDir"
34151>>>        Forward Send DoWinQLReport
34153>>>    End_Procedure
34154>>>
34154>>>
34154>>>  Function NSections Returns Integer
34155>>>    Integer iPrintJob iResult
34156>>>
34156>>>    Get PrintJob To iPrintJob
34157>>>    Move (PEGetNSections(iPrintJob)) To iResult
34158>>>    Move (Low(iResult)) To iResult
34159>>>    Function_Return iResult
34160>>>  End_Function // NSections
34161>>>
34161>>>  Function SectionCode Integer iSectionN Returns Integer
34162>>>    Integer iPrintJob iResult
34163>>>
34163>>>    Get PrintJob To iPrintJob
34164>>>    Move (PEGetSectionCode(iPrintJob,iSectionN)) To iResult
34165>>>    Move (Low(iResult)) To iResult
34166>>>    Function_Return iResult
34167>>>  End_Function // SectionCode
34168>>>
34168>>>  Function CloseSubreport Integer iSubreport Returns Integer
34169>>>    Integer iResult
34170>>>
34170>>>    Move (PECloseSubreport(iSubreport)) To iResult
34171>>>    Function_Return iResult
34172>>>  End_Function // CloseSubreport
34173>>>
34173>>>  Function NSubreportsInSection Integer iSectionCode Returns Integer
34174>>>    Integer iPrintJob iResult
34175>>>
34175>>>    Get PrintJob To iPrintJob
34176>>>    Move (PEGetNSubreportsInSection(iPrintJob,iSectionCode)) To iResult
34177>>>    Move (Low(iResult)) To iResult
34178>>>    Function_Return iResult
34179>>>  End_Function // nSubreportsInSection
34180>>>
34180>>>  Function NthSubreportInSection Integer iSectionCode Integer iSubreportN Returns Integer
34181>>>    Integer iPrintJob iResult
34182>>>
34182>>>    Get PrintJob To iPrintJob
34183>>>    Move (PEGetNthSubreportInSection(iPrintJob,iSectionCode,iSubreportN)) To iResult
34184>>>    Function_Return iResult
34185>>>  End_Function // NthSubreportInSection
34186>>>
34186>>>  Function SubreportName Integer iSubreportHandle Returns String
34187>>>    String sPESubreportInfo sResult
34188>>>    Pointer pPESubreportInfo
34188>>>    Integer iPrintJob iResult
34188>>>
34188>>>    ZeroType PESubreportInfo To sPESubreportInfo
34189>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
34190>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
34191>>>
34191>>>    Get PrintJob To iPrintJob
34192>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
34193>>>    If iResult GetBuff_String From sPESubreportInfo at PESubreportInfo.name To sResult
34196>>>    Function_Return (ToOEM(sResult))
34197>>>  End_Function // SubreportName
34198>>>
34198>>>  Function SubreportNLinks Integer iSubreportHandle Returns Integer
34199>>>    String sPESubreportInfo
34200>>>    Pointer pPESubreportInfo
34200>>>    Integer iPrintJob iResult
34200>>>
34200>>>    ZeroType PESubreportInfo To sPESubreportInfo
34201>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
34202>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
34203>>>
34203>>>    Get PrintJob To iPrintJob
34204>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
34205>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.NLinks To iResult
34208>>>    Function_Return iResult
34209>>>  End_Function // SubreportNLinks
34210>>>
34210>>>  Function SubreportIsOnDemand Integer iSubreportHandle Returns Integer
34211>>>    String sPESubreportInfo
34212>>>    Pointer pPESubreportInfo
34212>>>    Integer iPrintJob iResult
34212>>>
34212>>>    ZeroType PESubreportInfo To sPESubreportInfo
34213>>>    Put PESubreportInfo_Size To sPESubreportInfo at PESubreportInfo.structSize
34214>>>    GetAddress Of sPESubreportInfo to pPESubreportInfo
34215>>>
34215>>>    Get PrintJob To iPrintJob
34216>>>    Move (PEGetsubreportInfo(iPrintJob,iSubreportHandle,pPESubreportInfo)) To iResult
34217>>>    If iResult GetBuff From sPESubreportInfo at PESubreportInfo.IsOnDemand To iResult
34220>>>    Function_Return iResult
34221>>>  End_Function // SubreportIsOnDemand
34222>>>
34222>>>  Function OpenSubReport String sSubreport Returns Integer
34223>>>    Integer iPrintJob iResult
34224>>>    Pointer pSubreport
34224>>>
34224>>>    Get PrintJob To iPrintJob
34225>>>    GetAddress Of sSubreport To pSubreport
34226>>>    Move (PEOpenSubreport(iPrintJob,pSubreport)) To iResult
34227>>>    Move (Low(iResult)) To iResult
34228>>>    Function_Return iResult
34229>>>  End_Function // OpenSubReport
34230>>>
34230>>>  Function NTablesInSubreport Integer iSubreportHandle Returns Integer
34231>>>    Local Integer iResult
34232>>>
34232>>>    Move (PEGetNTables(iSubreportHandle)) To iResult
34233>>>    Move (Low(iResult)) To iResult
34234>>>    Function_Return iResult
34235>>>  End_Function // NTablesInSubreport
34236>>>
34236>>>  Function NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN Returns String
34237>>>    Local String sPETableLocation sReturn
34238>>>    Local Pointer pPETableLocation
34238>>>    Local Integer iResult
34238>>>
34238>>>    FillType PETableLocation With 0 To sPETableLocation
34239>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
34240>>>    GetAddress Of sPETableLocation To pPETableLocation
34241>>>    Move (PEGetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
34242>>>    If iResult GetBuff_String From sPETableLocation At PETableLocation.Location To sReturn
34245>>>    Function_Return (ToOEM(sReturn))
34246>>>  End_Function // NthTableLocationInSubreport
34247>>>
34247>>>  Procedure Set NthTableLocationInSubreport Integer iSubreportHandle Integer iTableN String sLocation
34248>>>    Local String sPETableLocation
34249>>>    Local Pointer pPETableLocation
34249>>>    Local Integer iResult
34249>>>
34249>>>    Move (ToANSI(sLocation+Character(0))) To sLocation
34250>>>    FillType PETableLocation With 0 To sPETableLocation
34251>>>    Put PETableLocation_Size To sPETableLocation At PETableLocation.StructSize
34252>>>    Put_String sLocation To sPETableLocation At PETableLocation.Location
34253>>>    GetAddress Of sPETableLocation To pPETableLocation
34254>>>    Move (PESetNthTableLocation(iSubreportHandle,iTableN,pPETableLocation)) To iResult
34255>>>  End_Procedure // Set NthTableLocationInSubreport
34256>>>
34256>>>
34256>>>    // This hook procedure is called after the print job has been opened.
34256>>>
34256>>>    Procedure OnInitializeReport
34257>>>
34257>>>    ////// SOS Na ginei xana OnInitializeReport ///////////
34257>>>
34257>>>        Integer iTables iMax iCount iType
34258>>>        String  sLocation sLocation2 sPath DirSep sPassw
34258>>>        String  sNewPath sNewLocation sDataPath sMyLocation
34258>>>
34258>>>        Integer lnSections lnSubreports lnTables iPrintJob iPath
34258>>>        Integer iSection iCode iSubreport iTable iNumPaths bExists
34258>>>        Handle hSubreport
34258>>>        String sTable sSubreport sTempFilePath sSApassw
34258>>>        Boolean bCheckforTempfile bTemp
34258>>>
34258>>>
34258>>>
34258>>>        Forward Send OnInitializeReport
34260>>>
34260>>>
34260>>>        Open Company
INCLUDING FILE: COMPANY.FD
34262>>>        Open Syscurxr
34264>>>
34264>>>        Clear Company
34265>>>        Move SyscurXr.Company_Code to Company.Company_Code
34266>>>        Find Eq Company By Index.1
34267>>>>
34267>>>
34267>>>
34267>>>        If ((Found) And (Company.Company_C_CodeR='')) Procedure_Return
34270>>>
34270>>>        Move (Trim(COMPANY.COMPANY_EMAIL)) to sSApassw
34271>>>
34271>>>
34271>>>        String  sActualSQL
34271>>>        String  sActualTemp
34271>>>        String  sOldSQL
34271>>>        String  sOldTemp
34271>>>        String  sServerName
34271>>>        String  sDatabaseName
34271>>>        String  sUserID
34271>>>
34271>>>        //Move Company.Company_C_CodeR    to sServerName          // ODBC sto 1o pedio
34271>>>        //Move Company.Company_C_CodER    to sActualSQL           // Database sto 2o pedio
34271>>>        //Move Company.Company_C_CodER    to sDatabaseName        // Database sto 2o pedio
34271>>>
34271>>>        Move 'SMS'              to sOldSQL
34272>>>        Move 'C:\Dns_tmp\'      to sOldTemp
34273>>>
34273>>>
34273>>>        Move 'C:\Dns_tmp\'      to sActualTemp
34274>>>
34274>>>        Move (Trim(sActualSQL   )) to sActualSQL
34275>>>        Move (Trim(sActualTemp  )) to sActualTemp
34276>>>        Move (Trim(sOldSQL      )) to sOldSQL
34277>>>        Move (Trim(sOldTemp     )) to sOldTemp
34278>>>        Move (Trim(sServerName  )) to sServerName
34279>>>        Move (Trim(sDatabaseName)) to sDatabaseName
34280>>>        Move (Trim(sUserID      )) to sUserID
34281>>>
34281>>>
34281>>>
34281>>>        Move "SMSNT"    to sServerName
34282>>>        Move "SMS"      to sDatabaseName
34283>>>        Move "SMS"      to sActualSQL
34284>>>
34284>>>        Move "sa"       to sUserID
34285>>>        //////////  06/09/2011   Move "123"      to sPassw
34285>>>        Move sSApassw   to sPassw
34286>>>
34286>>>        Send LogOnServer "SQL_DRV" sServerName sDatabaseName sUserID sPassw
34287>>>
34287>>>
34287>>>        Move (Sysconf(SYSCONF_DIR_SEPARATOR)) To DirSep
34288>>>
34288>>>        Get NTables To iMax
34289>>>        Decrement iMax
34290>>>        Get Report_Data_Path                                    To sPath
34291>>>        If Not (Right(sPath,1)) Eq DirSep Move (sPath-DirSep)   To sPath
34294>>>        For iCount From 0 To iMax
34300>>>>
34300>>>            Get NthTableLocation iCount         To sLocation
34301>>>            Get Report_Base_File_Name sLocation To sLocation2
34302>>>            Get NthTableDBType           iCount to iType
34303>>>
34303>>>            // An einai type 1 topiko
34303>>>            //               2=SQL
34303>>>            If (iType=2) Begin
34305>>>                If (sLocation contains sOldSQL) Begin
34307>>>                    Move (Replace(sOldSQL,sLocation,sActualSQL))    to sLocation
34308>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
34309>>>                End
34309>>>>
34309>>>            End
34309>>>>
34309>>>            Else If (iType=1) Begin
34312>>>                If (sLocation contains sOldTemp) Begin
34314>>>                    Move (Replace(sOldTemp,sLocation,sActualTemp))  to sLocation
34315>>>                    Set NthTableLocation iCount                     to (Trim(sLocation))
34316>>>                End
34316>>>>
34316>>>            End
34316>>>>
34316>>>            Set nthTableLogOnServerName     iCount to sServerName     0
34317>>>            Set nthTableLogOnDataBaseName   iCount to sDatabaseName   0
34318>>>            Set nthTableLogOnUserID         iCount to sUserID         0 // 'sa'     0
34319>>>
34319>>>            // 2011
34319>>>            Set nthTableLogOnPassword       iCount to sPassw       0
34320>>>            // 2011
34320>>>
34320>>>
34320>>>        Loop // For iCount From 0 To iMax
34321>>>>
34321>>>
34321>>>        // Set the location of the tables for the subreports
34321>>>        Get NSections To lnSections
34322>>>        For iSection From 0 To (lnSections-1)
34328>>>>
34328>>>            Get SectionCode iSection To iCode
34329>>>            Get NSubreportsInSection iCode To lnSubreports
34330>>>            For iSubreport From 0 To (lnSubreports-1)
34336>>>>
34336>>>                Get NthSubreportInSection iCode iSubreport To hSubreport
34337>>>                Get SubreportName hSubreport To sSubreport
34338>>>                Get OpenSubreport sSubreport To iPrintJob
34339>>>                Get NTablesInSubreport iPrintJob To lnTables
34340>>>                For iTable From 0 To (lnTables-1)
34346>>>>
34346>>>                    Get NthTableLocationInSubreport iPrintJob iTable To sTable
34347>>>                    If (sTable contains sOldSQL) Begin
34349>>>                            Move '' to sLocation
34350>>>                            Move (Replace(sOldSQL,sTable,sActualSQL)) to sLocation
34351>>>                            Set NthTableLocationInSubreport iPrintJob iTable To (Trim(sLocation))
34352>>>                            Set nthTableLogOnServerName     iTable to sServerName     0
34353>>>                            Set nthTableLogOnDataBaseName   iTable to sDatabaseName   0
34354>>>                            Set nthTableLogOnUserID         iTable to sUserID         0 // 'sa'     0
34355>>>                                // 2011
34355>>>                                Set nthTableLogOnPassword       iTable to sPassw   0
34356>>>                                // 2011
34356>>>                    End
34356>>>>
34356>>>                Loop // For iTable From 0 To nTables
34357>>>>
34357>>>            Loop // For iSubreport From 0 To nSubreports
34358>>>>
34358>>>        Loop // For iSection From 0 To (iSections-1)
34359>>>>
34359>>>
34359>>>    End_Procedure // OnInitializeReport
34360>>>
34360>>>
34360>>>    // This hook procedure is called just before a print job is closed.
34360>>>    Procedure OnDeInitializeReport
34361>>>        Forward Send OnDEInitializeReport
34363>>>    End_Procedure // OnDeInitializeReport
34364>>>
34364>>>    // This hook procedure is called just before a the print job is started.
34364>>>    Procedure OnStartPrinting
34365>>>        Forward Send OnStartPrinting
34367>>>    End_Procedure // OnStartPrinting
34368>>>
34368>>>    // This hook procedure is called just after a print job has finished.
34368>>>    Procedure OnStopPrinting
34369>>>        Forward Send OnStopPrinting
34371>>>    End_Procedure // OnStopPrinting
34372>>>End_Class // CrystalReportSubSQL
34373>>>
34373>
34373>Function GetTheWorkSpace returns String
34374>    String lsWorkSpace
34375>    get_profile_string "WorkSpaces" "CurrentWorkspace" to lsWorkSpace
34378>    If lsWorkSpace eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to lsWorkSpace
34381>    insert "WorkSpaces\" in lsWorkSpace at 1
34383>    Function_Return lsWorkSpace
34384>End_Function
34385>
34385>Function GetTheAppPath Returns String
34386>   String lsWorkSpace lsModule lsTheAppPath
34387>   Move (GetTheWorkSpace(Self)) to lsWorkSpace
34388>   Move (Module_Name(Self)) to lsModule
34389>   Move (lsWorkSpace + "\" + lsModule) to lsTheAppPath
34390>   Function_Return lsTheAppPath
34391>End_Function
34392>
34392>
34392>
34392>//===========================================================
34392>//===========================================================
34392>Integer iMetrhthsProsp iHasAPassword
34392>Integer iMax00 iApotel iCountRemain iMustResetPass iAnenergos
34392>//--
34392>
34392>Open Sysrec
34394>Open Users
34396>
34396>Register_Procedure ChangeMyPassword
34396>
34396>//--
34396>Use PasswVerif.pkg
INCLUDING FILE: PASSWVERIF.PKG
34396>>>
34396>>>
34396>>>Function fsCryptoNew String lsWay String lsOld Returns String
34397>>>    Local String lsNew sToumpa sStringEncrypted sTemp sStringDecrypted
34398>>>    Integer iCount iAsciiNum
34398>>>
34398>>>    Move (Trim(lsOld)) to lsOld
34399>>>    Move (Trim(lsWay)) to lsWay
34400>>>
34400>>>    If ((Uppercase(lsWay)) eq 'ENCRYPT') Begin
34402>>>        Move lsOld  to sStringDecrypted
34403>>>        Move ""     to sStringEncrypted
34404>>>        Move ""     to sToumpa
34405>>>
34405>>>        // 1. Prota to fernoume anapoda / toumpa
34405>>>        For iCount From 1 to (Length(sStringDecrypted))
34411>>>>
34411>>>            Move (Mid(sStringDecrypted,1,iCount))   to sTemp
34412>>>            Move (Insert(sTemp,sToumpa,1))          to sToumpa
34413>>>        Loop
34414>>>>
34414>>>
34414>>>        // 2. Ftiaxnoume to neo string prosthetontas ton xarakthra pou prokyptei
34414>>>        //    apo ton Ascii kodiko tou xarakthra + thn thesi tou mesa sto string
34414>>>        For iCount From 1 to (Length(sToumpa))
34420>>>>
34420>>>            Move (Mid(sToumpa,1,iCount))            to sTemp
34421>>>            Move (Ascii(sTemp) + iCount)            to iAsciiNum
34422>>>            Move (Character(iAsciiNum))             to sTemp
34423>>>            Move (Append(sStringEncrypted,sTemp))   to sStringEncrypted
34424>>>        Loop
34425>>>>
34425>>>        Move sStringEncrypted to lsNew
34426>>>    End
34426>>>>
34426>>>    Else If ((Uppercase(lsWay)) eq 'DECRYPT') Begin
34429>>>        Move lsOld to sStringEncrypted
34430>>>        Move "" to sStringDecrypted
34431>>>        Move "" to sToumpa
34432>>>
34432>>>        // 1. Ftiaxnoume to palio string afairontas ton xarakthra pou prokyptei
34432>>>        //    apo ton Ascii kodiko tou xarakthra + thn thesi tou mesa sto string
34432>>>        For iCount From 1 to (Length(sStringEncrypted))
34438>>>>
34438>>>            Move (Mid(sStringEncrypted,1,iCount))       to sTemp
34439>>>            Move (Ascii(sTemp) - iCount)                to iAsciiNum
34440>>>            Move (Character(iAsciiNum))                 to sTemp
34441>>>            Move (Append(sStringDecrypted,sTemp))       to sStringDecrypted
34442>>>        Loop
34443>>>>
34443>>>
34443>>>        // 2. Meta, to fernoume anapoda / toumpa
34443>>>        For iCount From 1 to (Length(sStringDecrypted))
34449>>>>
34449>>>            Move (Mid(sStringDecrypted,1,iCount))   to sTemp
34450>>>            Move (Insert(sTemp,sToumpa,1))          to sToumpa
34451>>>        Loop
34452>>>>
34452>>>        Move sToumpa to lsNew
34453>>>    End
34453>>>>
34453>>>    Else Send Info_Box ("The parameter lsWay must be ENCRYPT or DECRYPT\nThe returned string will be incorrect since you passed "+Trim(lsWay)) "Error 1001"
34455>>>    Function_Return (Trim(lsNew))
34456>>>End_Function
34457>>>
34457>>>
34457>>>Function HasOneCap string asPassw Integer aiGreek Returns Integer
34458>>>    Integer rVal
34459>>>    Integer iLength x
34459>>>    String  sChar
34459>>>    Move (Length(asPassw))  to iLength
34460>>>    Move 0                  to rVal
34461>>>    For x From 1 to iLength
34467>>>>
34467>>>        Move (Mid(asPassw,1,x)) to sChar
34468>>>        If (aiGreek=0) Begin
34470>>>            If ( ;                 ( (Ascii(sChar)>=65 ) And (Ascii(sChar)<= 90)) Or  ;                 ( (Ascii(ToAnsi(sChar))>=193) And (Ascii(ToAnsi(sChar))<=219))  ;               ) Begin
34472>>>                Move 1      to rVal
34473>>>                Move 9999   to x
34474>>>            End
34474>>>>
34474>>>        End
34474>>>>
34474>>>        Else Begin
34475>>>            If ( (Ascii(sChar)>=65) And (Ascii(sChar)<=90) ) Begin
34477>>>                Move 1      to rVal
34478>>>                Move 9999   to x
34479>>>            End
34479>>>>
34479>>>        End
34479>>>>
34479>>>    Loop
34480>>>>
34480>>>    Function_Return rVal
34481>>>End_Function
34482>>>
34482>>>Function HasOneSmall string asPassw Integer aiGreek Returns Integer
34483>>>    Integer rVal
34484>>>    Integer iLength x
34484>>>    String  sChar
34484>>>    Move (Length(asPassw))  to iLength
34485>>>    Move 0                  to rVal
34486>>>    For x From 1 to iLength
34492>>>>
34492>>>        Move (Mid(asPassw,1,x)) to sChar
34493>>>        If (aiGreek=0) Begin
34495>>>            If ( ;                 ( (Ascii(sChar)>= 97) And (Ascii(sChar)<=122)) Or ;                 ( (Ascii(ToAnsi(sChar))>=220) And (Ascii(ToAnsi(sChar))<=254))    ;               ) Begin
34497>>>                Move 1      to rVal
34498>>>                Move 9999   to x
34499>>>            End
34499>>>>
34499>>>        End
34499>>>>
34499>>>        Else Begin
34500>>>            If ( (Ascii(sChar)>=97) And (Ascii(sChar)<=122)) Begin
34502>>>                Move 1      to rVal
34503>>>                Move 9999   to x
34504>>>            End
34504>>>>
34504>>>        End
34504>>>>
34504>>>    Loop
34505>>>>
34505>>>    Function_Return rVal
34506>>>End_Function
34507>>>
34507>>>Function HasOneNumber string asPassw Returns Integer
34508>>>    Integer rVal
34509>>>    Integer iLength x
34509>>>    String  sChar
34509>>>    Move (Length(asPassw))  to iLength
34510>>>    Move 0                  to rVal
34511>>>    For x From 1 to iLength
34517>>>>
34517>>>        Move (Mid(asPassw,1,x)) to sChar
34518>>>        If ( (Ascii(sChar)>=48) And (Ascii(sChar)<=57)) Begin
34520>>>            Move 1      to rVal
34521>>>            Move 9999   to x
34522>>>        End
34522>>>>
34522>>>    Loop
34523>>>>
34523>>>    Function_Return rVal
34524>>>End_Function
34525>>>
34525>>>Function HasOneSpecial string asPassw Returns Integer
34526>>>    Integer rVal
34527>>>    Integer iLength x
34527>>>    String  sChar
34527>>>    Move (Length(asPassw))  to iLength
34528>>>    Move 0                  to rVal
34529>>>    For x From 1 to iLength
34535>>>>
34535>>>        Move (Mid(asPassw,1,x)) to sChar
34536>>>        If ( ;             ( (Ascii(sChar)>=33) And (Ascii(sChar)<=47)) Or ;             ( (Ascii(sChar)>=58) And (Ascii(sChar)<=64)) Or ;             ( (Ascii(sChar)>=91) And (Ascii(sChar)<=96))    ;           ) Begin
34538>>>            Move 1      to rVal
34539>>>            Move 9999   to x
34540>>>        End
34540>>>>
34540>>>
34540>>>    Loop
34541>>>>
34541>>>    Function_Return rVal
34542>>>End_Function
34543>>>
34543>>>Function HasOneGreek string asPassw Returns Integer
34544>>>    Integer rVal
34545>>>    Integer iLength x
34545>>>    String  sChar
34545>>>    Move (Length(asPassw))  to iLength
34546>>>    Move 0                  to rVal
34547>>>    For x From 1 to iLength
34553>>>>
34553>>>        Move (Mid(asPassw,1,x)) to sChar
34554>>>        If ( ;             ((Ascii(ToAnsi(sChar))>=193) And (Ascii(ToAnsi(sChar))<=219)) Or ;             ((Ascii(ToAnsi(sChar))>=220) And (Ascii(ToAnsi(sChar))<=254))    ;           ) Begin
34556>>>            Move 1      to rVal
34557>>>            Move 9999   to x
34558>>>            Move sChar to gsMyStr
34559>>>        End
34559>>>>
34559>>>    Loop
34560>>>>
34560>>>    Function_Return rVal
34561>>>End_Function
34562>>>
34562>>>Function HasDuplicates String asPassw Returns Integer
34563>>>    Integer iLength x
34564>>>    String  s1 s2
34564>>>    Move (Length(asPassw)) to iLength
34565>>>    If (iLength > 2) Begin
34567>>>        For x From 1 to iLength
34573>>>>
34573>>>            Move (Mid(asPassw, 1, x  )) to s1
34574>>>            If ((x+1)<=iLength) ;                Move (Mid(asPassw, 1, x+1)) to s2
34577>>>            Else Function_Return 0
34579>>>            If (s1=s2) Begin
34581>>>                Move (s1+s2) to gsMyStr
34582>>>                Function_Return 1
34583>>>            End
34583>>>>
34583>>>        Loop
34584>>>>
34584>>>    End
34584>>>>
34584>>>    Function_Return 0
34585>>>End_Function
34586>>>
34586>>>Function HasInRow string asPassw Integer aiGreek Returns Integer
34587>>>    Integer rVal iNum
34588>>>    Integer iLength x
34588>>>    String  sChar  sChar2  sChar3  sSet1  sSet2
34588>>>    String  ssChar ssChar2 ssChar3 ssSet1 ssSet2
34588>>>    String  s1 s2 s3 s4 s5
34588>>>
34588>>>    Move (Length(asPassw))  to iLength
34589>>>    Move 0                  to rVal
34590>>>
34590>>>    Move "" to gsMyStr
34591>>>
34591>>>    For x From 1 to iLength
34597>>>>
34597>>>        Move 0 to iNum
34598>>>        // Keep 3 consecutive characters
34598>>>        Move (Mid(asPassw,1,x))                         to sChar
34599>>>        If ((x+1)<=iLength) Move (Mid(asPassw,1,x+1))   to sChar2
34602>>>        Else                Move 1                      to iNum
34604>>>        If ((x+2)<=iLength) Move (Mid(asPassw,1,x+2))   to sChar3
34607>>>        Else                Move 1                      to iNum
34609>>>
34609>>>        If (iNum=0) Begin
34611>>>            // check if same type of character (Numbers)
34611>>>            If ( ((Ascii(sChar )>=48) And (Ascii(sChar )<=57)) And ;                 ((Ascii(sChar2)>=48) And (Ascii(sChar2)<=57)) And ;                 ((Ascii(sChar3)>=48) And (Ascii(sChar3)<=57))     ;               ) Begin
34613>>>                If (    ((Integer(sChar3)-Integer(sChar2))=1) And ;                        ((Integer(sChar2)-Integer(sChar ))=1)     ;                   ) Begin
34615>>>                   Move 1       to rVal
34616>>>                   Move 9999    to x
34617>>>                   Move (sChar+sChar2+sChar3) to gsMyStr
34618>>>
34618>>>                End
34618>>>>
34618>>>                Else If (    ((Integer(sChar2)-Integer(sChar3))=1) And ;                             ((Integer(sChar )-Integer(sChar2))=1)     ;                        ) Begin
34621>>>                   Move 1       to rVal
34622>>>                   Move 9999    to x
34623>>>                   Move (sChar+sChar2+sChar3) to gsMyStr
34624>>>                End
34624>>>>
34624>>>            End
34624>>>>
34624>>>            // check if same type of character (Capital Letters)
34624>>>            Else Begin
34625>>>                Move "ABCDEFGHIJKLMNOPQRSTUVWXYZ"   to s1
34626>>>                Move "QWERTYUIOPASDFGHJKLZXCVBNM"   to s2
34627>>>                Move (UpperCase(sChar ))        to ssChar
34628>>>                Move (UpperCase(sChar2))        to ssChar2
34629>>>                Move (UpperCase(sChar3))        to ssChar3
34630>>>                Move (sChar +sChar2+sChar3)     to sSet1
34631>>>                Move (sChar3+sChar2+sChar )     to sSet2
34632>>>                Move (ssChar +ssChar2+ssChar3)  to ssSet1
34633>>>                Move (ssChar3+ssChar2+ssChar )  to ssSet2
34634>>>
34634>>>                If ( ((Ascii(ssChar )>=65) And (Ascii(ssChar )<=90)) And ;                     ((Ascii(ssChar2)>=65) And (Ascii(ssChar2)<=90)) And ;                     ((Ascii(ssChar3)>=65) And (Ascii(ssChar2)<=90))     ;                   ) Begin
34636>>>                    If ( (Pos(ssSet1,s1)>0) Or (Pos(ssSet2,s1)>0) Or ;                         (Pos(ssSet1,s2)>0) Or (Pos(ssSet2,s2)>0)  ) Begin
34638>>>                        Move 1      to rVal
34639>>>                        Move 9999   to x
34640>>>                        Move sSet1 to gsMyStr
34641>>>                    End
34641>>>>
34641>>>                End
34641>>>>
34641>>>            End
34641>>>>
34641>>>        End
34641>>>>
34641>>>    Loop
34642>>>>
34642>>>    Function_Return rVal
34643>>>End_Function
34644>>>
34644>>>
34644>>>Function HasPasswordProblems string asPassw Integer i8Char    Integer i2Same  Integer iOneCap ;                                            Integer iOneSmall Integer iOneNum Integer iOneSpe ;                                            Integer iGreek    Integer iSeira  Integer iBlanks Returns Integer
34645>>>    Integer iHasProblems
34646>>>    Move 0 to iHasProblems
34647>>>
34647>>>         If ((i8Char   =1) And (Length(asPassw)<8))                     Move 1 to iHasProblems
34650>>>    Else If ((i2Same   =1) And (HasDuplicates (Self,asPassw       )=1)) Move 2 to iHasProblems
34654>>>    Else If ((iGreek   =1) And (HasOneGreek   (Self,asPassw       )=1)) Move 7 to iHasProblems
34658>>>    Else If ((iBlanks  =1) And (Pos(" ",asPassw)>0))                    Move 9 to iHasProblems
34662>>>    Else If ((iOneCap  =1) And (HasOneCap     (Self,asPassw,iGreek)=0)) Move 3 to iHasProblems
34666>>>    Else If ((iOneSmall=1) And (HasOneSmall   (Self,asPassw,iGreek)=0)) Move 4 to iHasProblems
34670>>>    Else If ((iOneNum  =1) And (HasOneNumber  (Self,asPassw       )=0)) Move 5 to iHasProblems
34674>>>    Else If ((iOneSpe  =1) And (HasOneSpecial (Self,asPassw       )=0)) Move 6 to iHasProblems
34678>>>    Else If ((iSeira   =1) And (HasInRow      (Self,asPassw,iGreek)=1)) Move 8 to iHasProblems
34682>>>
34682>>>    Function_Return iHasProblems
34683>>>End_Function
34684>>>
34684>>>
34684>>>Function fsVerifyThePasswordValidity String asPassword Returns Integer
34685>>>    Integer rVal bState
34686>>>    String  lsTheAppPath sPassw sMess
34686>>>    Integer i1 i2 i3 i4 i5 i6 i7 i8 i9 iMax iDays iResult
34686>>>
34686>>>    Reread Sysrec
34690>>>    Unlock
34691>>>>
34691>>>
34691>>>    Move Sysrec.LIBCAST_CODE    to i1
34692>>>    Move Sysrec.AWARD_CODE      to i2
34693>>>    Move Sysrec.GIVAWRD_CODE    to i3
34694>>>    Move Sysrec.MOVIE_LNK_CODE  to i4
34695>>>    Move Sysrec.CAST_LNK_CODE   to i5
34696>>>    Move Sysrec.AWARDTP_CODE    to i6
34697>>>    Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
34698>>>    Move Sysrec.STWHAT_CODE     to i8
34699>>>    Move Sysrec.SNWHAT_CODE     to i9
34700>>>    Move Sysrec.LIBVIS_CODE     to iDays
34701>>>    Move Sysrec.TIKANEI_CODE    to iMax
34702>>>
34702>>>    Move "" to gsMyStr
34703>>>    Move 0  to iResult
34704>>>
34704>>>    Move (HasPasswordProblems(Self,asPassword,i1,i2,i3,i4,i5,i6,i7,i8,i9)) to iResult
34705>>>
34705>>>    Move gsMyStr        to sMess
34706>>>    Move (Trim(sMess))  to sMess
34707>>>
34707>>>         If (iResult=7) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  „¢¢ž¤ ¡¦å ®˜¨˜¡«ã¨œª"                   ("‘­á¢£˜ 1007  -> "+sMess+" <-")
34710>>>    Else If (iResult=1) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ œå¤˜  á¤à «à¤ 8 ®˜¨˜¡«ã¨à¤ "          "‘­á¢£˜ 1001"
34714>>>    Else If (iResult=2) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  2 å› ¦  ®˜¨˜¡«ã¨œª ›å§¢˜ ›å§¢˜"         ("‘­á¢£˜ 1002  -> "+sMess+" <-")
34718>>>    Else If (iResult=3) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 ¡œ­˜¢˜å¦ š¨á££˜"   "‘­á¢£˜ 1003"
34722>>>    Else If (iResult=4) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 §œæ š¨á££˜"       "‘­á¢£˜ 1004"
34726>>>    Else If (iResult=5) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 ˜¨ Ÿ£æ"            "‘­á¢£˜ 1005"
34730>>>    Else If (iResult=6) Send Stop_Box "Ž ¡à› ¡æª §¨â§œ  ¤˜ â®œ  «¦¬¢á® ©«¦¤ 1 œ › ¡æ ®˜¨˜¡«ã¨˜"  "‘­á¢£˜ 1006"
34734>>>    Else If (iResult=8) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  §á¤à ˜§¦ 2 ©¬¤œ®æ£œ¤¦  ®˜¨˜¡«ã¨œª"      ("‘­á¢£˜ 1008  -> "+sMess+" <-")
34738>>>    Else If (iResult=9) Send Stop_Box "ƒœ¤ œ§ «¨â§¦¤«˜  ¡œ¤á ˜¤á£œ©˜ ©«¦¬ª ®˜¨˜¡«ã¨œª"           "‘­á¢£˜ 1009"
34742>>>
34742>>>
34742>>>    Function_return iResult
34743>>>End_function
34744>>>
34744>//--
34744>
34744>Use Connect.dg
INCLUDING FILE: CONNECT.DG
34744>>>//AB/ Project Connect
34744>>>//AB/     Object prj is a Dialog_Project
34744>>>//AB/         Set ProjectName to "Connect"
34744>>>//AB/         Set ProjectFileName to "Connect.dg"
34744>>>
34744>>>// Project Object Structure
34744>>>//   Connect is a BasicPanelSub
34744>>>//     frmUser is a FormSub
34744>>>//     frmKodikos is a FormSub
34744>>>//     CheckBox1 is a CheckBoxSub
34744>>>//     oOK_bn is a ButtonSub
34744>>>//     oCancel_bn is a ButtonSub
34744>>>//     Textbox5 is a TextBoxSub
34744>>>//     ComboForm2 is a ComboFormSub
34744>>>//     Textbox6 is a TextBoxSub
34744>>>//     Form4 is a FormSub
34744>>>//     Textbox7 is a TextBoxSub
34744>>>//     Textbox8 is a TextBoxSub
34744>>>//     BitmapContainerSub2 is a BitmapContainerSub
34744>>>
34744>>>// Register all objects
34744>>>Register_Object BitmapContainerSub2
34744>>>Register_Object CheckBox1
34744>>>Register_Object ComboForm2
34744>>>Register_Object Connect
34744>>>Register_Object Form4
34744>>>Register_Object frmKodikos
34744>>>Register_Object frmUser
34744>>>Register_Object oCancel_bn
34744>>>Register_Object oOK_bn
34744>>>Register_Object Textbox5
34744>>>Register_Object Textbox6
34744>>>Register_Object Textbox7
34744>>>Register_Object Textbox8
34744>>>
34744>>>
34744>>>
34744>>>    //AB-StoreTopStart
34744>>>            
34744>>>    Use mertech.inc
INCLUDING FILE: MERTECH.INC
34744>>>>>USE UI
34744>>>>>
#REM -----------------------------------------------
#REM MERTECH DATA SYSTEMS INC. - WWW.MERTECHDATA.COM
#REM MERTECH.INC VERSION 2.1.9
#REM -----------------------------------------------
34744>>>>>
34744>>>>>
34744>>>>>
34744>>>>>
34744>>>>>
34744>>>>>//
34744>>>>>//
34744>>>>>//
34744>>>>>//
34744>>>>>//
34744>>>>>//-----------------------------------------------
34744>>>>>// SELECT_COLUMNS_FIND <FILE> <START> THRU <END>
34744>>>>>// SELECT_COLUMNS_FIND <FILE> <FIELD>
34744>>>>>// This command will issue a properly commands to define the FETCH attribute status
34744>>>>>// for file fields.
34744>>>>>//
34744>>>>>//------------------------------------------------------------------------------
34744>>>>>// RESET_FETCH_FIELDS <FILE NAME>|<FILE NUMBER> <DF_FETCH_TRUE>|<DF_FETCH_FALSE>
34744>>>>>//
34744>>>>>//
34744>>>>>//-----------------------------
34744>>>>>// SQL_FOR_ONEROW <file number>
34744>>>>>//
34744>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get just
34744>>>>>// one ROW for each DataFlex FIND command issued
34744>>>>>// In this case the DBMS optimizer will generate a query with just one row
34744>>>>>//
34744>>>>>//
34744>>>>>//-------------------------------------------------------------------------------
34744>>>>>// SQL_FOR_SET <file number> MAXROWS <number of rows> CACHE|NOCACHE <return code>
34744>>>>>//
34744>>>>>// this command will indicate for ORAFlex to make a SELECT statement to get a SET of rows.
34744>>>>>// In this case the DBMS optimizer will generate a query with <number of rows> Rows.
34744>>>>>// if CACHE is passed as argument, all these rows will be transfered to ORAFlex and then it will
34744>>>>>// save them in a local CACHE buffer. Just the FIND GT and FIND LT will get local cache.
34744>>>>>// Otherwise, i.e NOCACHE,  ORAFLex won't create a local cache.
34744>>>>>//
34744>>>>>//
34744>>>>>//---------------
34744>>>>>// SQL_SET <stmt>
34744>>>>>//
34744>>>>>//-----------------------------------------
34744>>>>>// SQL_APPEND <stmt1> <stmt2> .... <stmtn>
34744>>>>>//
34744>>>>>//------------
34744>>>>>// SQL_EXECUTE
34744>>>>>//
34744>>>>>//----------------------------------------------------------------------
34744>>>>>// LOCK_TABLE [<FILE NAME>|<FILE NUMBER> <FILE NAME>|<FILE NUMBER> ....]
34744>>>>>//
34744>>>>>// LOCK_TABLE will lock the entire table specified as an argument
34744>>>>>// This command will start a new transaction if it still wasn't done.
34744>>>>>// LOCK_TABLE won't lock the other opened tables or the current rows present
34744>>>>>// in their buffers it will be necessary issue a REREAD command to Lock the current
34744>>>>>// rows and then atualize their buffers
34744>>>>>//
34744>>>>>//
34744>>>>>//-------------------------------------------
34744>>>>>// SQL_CHECK_TABLE <SCHEMA NAME> <TABLE NAME>
34744>>>>>//
34744>>>>>//-------------------------------
34744>>>>>// CREATE_TD_FILE  DFTRUE|DFFALSE
34744>>>>>// SET A GLOBAL ATTRIBUTE TO CREATE THE TD FILE AFTER CLOSING AN OPENED FILE
34744>>>>>//
34744>>>>>//-------------------------------------------------
34744>>>>>// OPEN_INT <DATAFLEX FILE NAME>
34744>>>>>// OPEN_INT <PHYSICAL NAME> AS <DATAFLEX FILE NAME>
34744>>>>>//
34744>>>>>// OPEN_INT will check if the OPEN done is an OPEN AS. IF it's true, OPEN_INT
34744>>>>>// will try to open an intermediate file, if there is one. Otherwise OPEN_INT
34744>>>>>// will issue a OPEN command
34744>>>>>// OPEN_INT must be inserted into FMAC file instead OPEN COMMAND
34744>>>>>//
34744>>>>>//=========================================================================================================
34744>>>>>// SELECT STUFFS
34744>>>>>//--------------
34744>>>>>// SQL_SET_STMT OF FILENAME|FILENUMBER TO <STATMENT1>
34744>>>>>//
34744>>>>>// SQL_APPEND_ OF FILENAME|FILENUMBER TO <STATMENT1> <STATMENT2> ... <STATMENTn>
34744>>>>>//
34744>>>>>//
34744>>>>>// SQL_APPEND_UPDCOL_STMT OF FILENAME|FILENUMBER VALUE EXPRESSION WITH FIELD1 FIELD2 ... FIELDN
34744>>>>>//
34744>>>>>// SQL_PREPARE_STMT OF FILENAME|FILENUMBER
34744>>>>>//
34744>>>>>// SQL_BIND_COLUMN [FILENAME|FILENUMBER] [FIELDNAME|FIELDNUMBER]
34744>>>>>//
34744>>>>>// SQL_BINDCOLUMNS_STMT OF FILENAME|FILENUMBER TO <COLUMN1> <COLUMN2> ... <COLUMNn>
34744>>>>>//
34744>>>>>// SQL_EXECUTE_STMT OF FILENAME|FILENUMBER
34744>>>>>//
34744>>>>>// SQL_COMMIT_STMT
34744>>>>>//
34744>>>>>// SQL_ROLLBACK_STMT
34744>>>>>//
34744>>>>>// SQL_FETCH_NEXT_ROW OF FILENAME|FILENUMBER
34744>>>>>//
34744>>>>>//
34744>>>>>//
34744>>>>>//
34744>>>>>// CALL_STORED_PROCEDURE will call a stored procedure passing arguments
34744>>>>>//
34744>>>>>// FORMAT TO USE : CALL_STORED_PROCEDURE <STORED_PROC_NAME> [PASSING <ARG1> <ARG2> ....<ARGn>]
34744>>>>>//
34744>>>>>//
34744>>>>>//---------------------------------------------------------------------------------------------
34744>>>>>// CALL_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
34744>>>>>// CALL_STORED_FUNCTION will call an Oracle stored function passing arguments
34744>>>>>//
34744>>>>>//---------------------------
34744>>>>>// SQL_TEXT_MESSAGE <MESSAGE>
34744>>>>>// Writes a message inside driver log trace file if this is activated
34744>>>>>//
34744>>>>>//-----------------------------------------------------
34744>>>>>// OUTPUT_INT_FILE FOR <FILE NUMBER> TO <INT FILE NAME>
34744>>>>>// Generating the INT file
34744>>>>>//
34744>>>>>// -----------------------
34744>>>>>// SQL_ERROR_MESSAGE <VAR>
34744>>>>>// SQL_ERROR_MESSAGE retrieve the native error message issued by server for error number 25000
34744>>>>>
34744>>>>>
34744>>>>>//=======================================================================================
34744>>>>>// SQLFlex Commands
34744>>>>>//-----------------
34744>>>>>//
34744>>>>>//-----------------------
34744>>>>>// SQLFlex_REVISION <VAR>
34744>>>>>// Retrieves SQLFlex revision
34744>>>>>//
34744>>>>>//-------------------------------------
34744>>>>>// SET_DATABASE_NAME TO <DATABASE NAME>
34744>>>>>// Sets current database
34744>>>>>//
34744>>>>>//---------------------------
34744>>>>>// GET_DATABASE_NAME TO <VAR>
34744>>>>>// Gets name of current database
34744>>>>>//
34744>>>>>//----------------------------------
34744>>>>>// SET_SCHEMA_NAME TO <SCHEMA NAME>
34744>>>>>// Sets current schema name
34744>>>>>//
34744>>>>>//-------------------------
34744>>>>>// GET_SCHEMA_NAME TO <VAR>
34744>>>>>// Gets current schema name
34744>>>>>//
34744>>>>>//--------------------------------
34744>>>>>// SQL_USEDATABASE <DATABASE NAME>
34744>>>>>// Specifies the current Database
34744>>>>>//
34744>>>>>//----------------------------
34744>>>>>// SET_CURRENT_SERVER TO <VAR>
34744>>>>>// Set the current logged server
34744>>>>>//
34744>>>>>//----------------------------
34744>>>>>// GET_CURRENT_SERVER TO <VAR>
34744>>>>>// Retrieves the current logged server
34744>>>>>//
34744>>>>>//-----------------------------
34744>>>>>// SET_HOST_NAME TO <HOST NAME>
34744>>>>>// Defines current host name
34744>>>>>//
34744>>>>>//-----------------------
34744>>>>>// GET_HOST_NAME TO <VAR>
34744>>>>>// Retrieves the current host name
34744>>>>>//
34744>>>>>//---------------------------------------------------------------
34744>>>>>// LOGIN_SQLFLEX <SERVER NAME> <USER NAME> <PASSWORD> <HOST NAME>
34744>>>>>// Specifies host name during login process
34744>>>>>//
34744>>>>>// SQL_CANCEL_QUERY_STMT
34744>>>>>//
34744>>>>>//========================================
34744>>>>>// SQL SERVER Stored Procedure Call engine
34744>>>>>//----------------------------------------
34744>>>>>//
34744>>>>>//
34744>>>>>
34744>>>>>//
34744>>>>>//--------------------------------------------------------------------------------------------------------------
34744>>>>>// CALL_SQLSERVER_PROCEDURE <procedure name> PASSING <VALUE1|VARIABLE1> [SQLOUT] <VALUE2|VARIABLE2> [SQLOUT] ...
34744>>>>>//
34744>>>>>// Executes a stored procedure. SQLOUT will be used to indicate that the stored procedure
34744>>>>>// returns a parameter. The matching parameter in the stored proceudre must have been created with
34744>>>>>// the keyword OUTPUT. Call all procedures that doesn't returns any query with this syntax
34744>>>>>//
34744>>>>>//
34744>>>>>//
34744>>>>>//-----------------------------------------------------------------------------
34744>>>>>
34744>>>>>
34744>>>>>//=============================================================================
34744>>>>>// ORAFlex Commands
34744>>>>>//-----------------
34744>>>>>//----------------------------
34744>>>>>// ORAFlex_REVISION <VARIABLE>
34744>>>>>// Retrieves ORAFlex revision
34744>>>>>//
34744>>>>>//---------------------------------
34744>>>>>// KEEP_FILES_OPEN OF <SERVER NAME>
34744>>>>>// Keeps all files opened even during a LOGOUT
34744>>>>>//
34744>>>>>//-----------------------------------------------
34744>>>>>// SET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
34744>>>>>// Defines the maximum number of cursors that ORAFlex will be allowed for using
34744>>>>>//
34744>>>>>//-----------------------------------------------
34744>>>>>// GET_MAX_OPEN_CURSORS OF <SERVER NAME> TO <VAR>
34744>>>>>// Retrieves the maximum number of cursors allowed for ORAFlex use
34744>>>>>//
34744>>>>>//---------------------------------------------
34744>>>>>// GET_OPENED_CURSORS OF <SERVER NAME> TO <VAR>
34744>>>>>// Retrieves the number of opened cursors
34744>>>>>//
34744>>>>>//-----------------------------------------------
34744>>>>>// ACTIVATE_TIME_STAMP OF <SERVER NAME> TO ON|OFF
34744>>>>>// Activates Time stamp for date columns
34744>>>>>//
34744>>>>>//----------------------------------------------------------------------------------------------------
34744>>>>>// CALL_ORACLE_STORED_FUNCTION <STORED_FUNC_NAME> RETURNS <VAR_RET> [PASSING <ARG1> <ARG2> ....<ARGn>]
34744>>>>>// CALL_ORACLE_STORED_FUNCTION will call an Oracle stored function passing arguments
34744>>>>>//
34744>>>>>//-----------------------------------------------------------------------------
34744>>>>>
34744>>>>>//=============================================================================
34744>>>>>// BUFFER save stuffs
34744>>>>>//-------------------
34744>>>>>
34744>>>>>//-------------------------------------------------------
34744>>>>>// SQL_SAVE_BUFFER_BEGIN OF <FILE NUMBER> TO <CACHE SIZE>
34744>>>>>// Initialize the BUFFER buffer
34744>>>>>//
34744>>>>>//---------------------------------
34744>>>>>// SQL_SAVE_BUFFER OF <FILE NUMBER>
34744>>>>>// Moves field buffer values to cache buffer
34744>>>>>//-------------------------------------
34744>>>>>// SQL_SAVE_BUFFER_END OF <FILE NUMBER>
34744>>>>>// Save rows that remains in cache
34744>>>>>//-----------------------------------------------------------------------------
34744>>>>>
34744>>>    //Use FlexOle
34744>>>    //Use ChilkatCrypt
34744>>>    
34744>>>    Open UsersH
INCLUDING FILE: USERSH.FD
34746>>>    
34746>>>    
34746>>>    //AB-StoreTopEnd
34746>>>
34746>>>    //AB-IgnoreStart
34746>>>
34746>>>    Use Panel.Sub
34746>>>    Use Form.Sub
34746>>>    Use Chkbox.Sub
34746>>>    Use Button.Sub
34746>>>    Use Txtbox.Sub
34746>>>    Use Cmbfrm.Sub
34746>>>    Use Bitmap.Sub
34746>>>
34746>>>
34746>>>    //AB-IgnoreEnd
34746>>>
34746>>>    Object Connect is a BasicPanelSub
34748>>>
34748>>>        //AB-StoreTopStart
34748>>>                
34748>>>                
34748>>>        //AB-StoreTopEnd
34748>>>
34748>>>        Set Sysmenu_Icon to FALSE
34749>>>        Set Minimize_Icon to FALSE
34750>>>        Set Label to "„§ ™œ™˜åà©ž ‘«¦ ®œåà¤ •¨ã©«ž"
34751>>>        Set Size to 85 340
34752>>>        Set Location to 17 12
34753>>>        Set Color to 13688273
34754>>>
34754>>>        //AB-DDOStart
34754>>>
34754>>>
34754>>>        //AB-DDOEnd
34754>>>
34754>>>        Object frmUser is a FormSub
34756>>>            Set Size to 13 163
34757>>>            Set Location to 12 118
34758>>>            Set Label_Col_Offset to 2
34759>>>            Set Label_Justification_Mode to jMode_Right
34760>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34761>>>        End_Object    // frmUser
34762>>>
34762>>>        Object frmKodikos is a FormSub
34764>>>
34764>>>            //AB-StoreTopStart
34764>>>                                                                                                
34764>>>            //AB-StoreTopEnd
34764>>>
34764>>>            Set Size to 13 163
34765>>>            Set Location to 36 118
34766>>>            Set Label_Col_Offset to 2
34767>>>            Set Label_Justification_Mode to jMode_Right
34768>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34769>>>
34769>>>            //AB-StoreStart
34769>>>                                                                                                
34769>>>            Set Password_State Item 0 to True
34770>>>            
34770>>>            
34770>>>            
34770>>>            
34770>>>            //AB-StoreEnd
34770>>>
34770>>>        End_Object    // frmKodikos
34771>>>
34771>>>        Object CheckBox1 is a CheckBoxSub
34773>>>
34773>>>            //AB-StoreTopStart
34773>>>                        
34773>>>            //AB-StoreTopEnd
34773>>>
34773>>>            Set Label to "€§¦Ÿã¡œ¬©ž ‰à› ¡¦ç"
34774>>>            Set Size to 10 88
34775>>>            Set Location to 57 118
34776>>>            Set Status_Help to "Remember The Password at Next Login"
34777>>>            Set Color to 15395562
34778>>>
34778>>>            //AB-StoreStart
34778>>>                        
34778>>>            Set Checked_State to False
34779>>>            Set Visible_State to False
34780>>>            
34780>>>            
34780>>>            //AB-StoreEnd
34780>>>
34780>>>        End_Object    // CheckBox1
34781>>>
34781>>>        Object oOK_bn is a ButtonSub
34783>>>
34783>>>            //AB-StoreTopStart
34783>>>                                                                                                
34783>>>            //AB-StoreTopEnd
34783>>>
34783>>>            Set Label to "Co&nnect"
34784>>>            Set Default_State to TRUE
34785>>>            Set Bitmap to "Login-233.bmp"
34786>>>            Set Size to 26 28
34787>>>            Set Location to 7 296
34788>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34789>>>
34789>>>            //AB-StoreStart
34789>>>                                                                                                
34789>>>            Set tooltipvalue to "„ˆ‘ŽƒŽ‘ ‘’†Œ „”€‹Ž‚†"
34790>>>            
34790>>>            
34790>>>            Procedure OnClick
34792>>>                Set LoginOk to True
34793>>>                Send Stop_Modal_ui
34794>>>            End_Procedure
34795>>>            
34795>>>            Set Status_Help to "‘ç¤›œ©ž / „å©¦›¦ª"
34796>>>            
34796>>>            
34796>>>            //AB-StoreEnd
34796>>>
34796>>>        End_Object    // oOK_bn
34797>>>
34797>>>        Object oCancel_bn is a ButtonSub
34799>>>            Set Label to "&Cancel"
34800>>>            Set Bitmap to "Exit-233.bmp"
34801>>>            Set Size to 26 28
34802>>>            Set Location to 40 297
34803>>>            Set Focus_Mode to Pointer_Only
34804>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34805>>>
34805>>>            //AB-StoreStart
34805>>>                                                                                                
34805>>>            Set tooltipvalue to "„ŽƒŽ‘ €Ž ’†Œ „”€‹Ž‚†"
34806>>>            
34806>>>            ON_KEY KENTER SEND Exit_Application to (Connect(Current_Object))
34807>>>            
34807>>>            Procedure OnClick
34809>>>                Set LoginOk to False
34810>>>                Send Exit_Application to (Connect(Current_Object))
34811>>>            End_Procedure
34812>>>            
34812>>>            Set Status_Help to "€¡ç¨à©ž / „¥¦›¦ª"
34813>>>            
34813>>>            
34813>>>            
34813>>>            
34813>>>            //AB-StoreEnd
34813>>>
34813>>>        End_Object    // oCancel_bn
34814>>>
34814>>>        Object Textbox5 is a TextBoxSub
34816>>>            Set Label to "Ž›žšæª"
34817>>>            Set Color to 13688273
34818>>>            Set FontSize to 4 0
34819>>>            Set Location to 79 83
34820>>>            Set Size to 10 44
34821>>>            Set Justification_Mode to jMode_Left
34822>>>            Set TypeFace to "MS Sans Serif"
34823>>>            Set Enabled_State to TRUE
34824>>>        End_Object    // Textbox5
34825>>>
34825>>>        Object ComboForm2 is a ComboFormSub
34827>>>
34827>>>            //AB-StoreTopStart
34827>>>                                                                                                
34827>>>            Set CapsLock_State to True
34828>>>            
34828>>>            //AB-StoreTopEnd
34828>>>
34828>>>            Set Size to 13 175
34829>>>            Set Location to 79 136
34830>>>            Set Label_Col_Offset to 2
34831>>>            Set Label_Justification_Mode to jMode_Right
34832>>>
34832>>>            //AB-StoreStart
34832>>>                                                                                                
34832>>>            Set Enabled_State to False
34833>>>            Set Visible_State to False
34834>>>            
34834>>>            Procedure Combo_Fill_List
34836>>>                    Local String Availdrv## TempDrv##
34837>>>                    Local Integer HowMany i p1## p2##
34837>>>            
34837>>>                    get_profile_string "WorkSpaces" "CurrentWorkspace" to AvailDrv##
34840>>>                    If AvailDrv## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to AvailDrv##
34843>>>                    insert "WorkSpaces\" in AvailDrv## at 1
34845>>>                    get_profile_string AvailDrv## "AvailableDrivers" to AvailDrv##
34848>>>            
34848>>>                    Move Availdrv## to Tempdrv##
34849>>>                    Repeat
34849>>>>
34849>>>                        Replace "|" in Tempdrv## With ""
34851>>>                        [Found] Increment HowMany
34852>>>                    Until [Finderr]
34854>>>            
34854>>>                    Send Combo_add_Item ""
34855>>>            
34855>>>                    If HowMany lt 1 Begin
34857>>>                        If Availdrv## ne "" Send Combo_Add_Item (UpperCase(Availdrv##))
34860>>>                    End
34860>>>>
34860>>>                    Else Begin
34861>>>                        For i From 0 to HowMany
34867>>>>
34867>>>                            If i eq 0 Move 1 to p1##
34870>>>                            Else Begin
34871>>>                                Move ((Pos("|",Availdrv##))+1) to p1##
34872>>>                                Replace "|" in Availdrv## With ","
34874>>>                            End
34874>>>>
34874>>>                            Move ((Pos("|",Availdrv##))) to p2##
34875>>>                            Send Combo_Add_Item (UpperCase(Mid(Availdrv##,(p2##-p1##),p1##)))
34876>>>                        Loop
34877>>>>
34877>>>                    End
34877>>>>
34877>>>            End_Procedure
34878>>>            
34878>>>            Set Allow_Blank_state to True
34879>>>            
34879>>>            
34879>>>            
34879>>>            
34879>>>            
34879>>>            //AB-StoreEnd
34879>>>
34879>>>        End_Object    // ComboForm2
34880>>>
34880>>>        Object Textbox6 is a TextBoxSub
34882>>>            Set Label to "ƒ ˜¡¦£ ©«ãª"
34883>>>            Set Color to 13688273
34884>>>            Set FontSize to 4 0
34885>>>            Set Location to 66 -21787
34886>>>            Set Size to 10 44
34887>>>            Set Justification_Mode to jMode_Left
34888>>>            Set TypeFace to "MS Sans Serif"
34889>>>            Set Enabled_State to TRUE
34890>>>        End_Object    // Textbox6
34891>>>
34891>>>        Object Form4 is a FormSub
34893>>>
34893>>>            //AB-StoreTopStart
34893>>>                                                                                                
34893>>>            //AB-StoreTopEnd
34893>>>
34893>>>            Set Size to 13 175
34894>>>            Set Location to 63 124
34895>>>            Set Label_Col_Offset to 2
34896>>>            Set Label_Justification_Mode to jMode_Right
34897>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
34898>>>
34898>>>            //AB-StoreStart
34898>>>                                                                                                
34898>>>                                                                                                
34898>>>            Set Enabled_State to False
34899>>>            Set Visible_State to False
34900>>>            
34900>>>            
34900>>>            //AB-StoreEnd
34900>>>
34900>>>        End_Object    // Form4
34901>>>
34901>>>        Object Textbox7 is a TextBoxSub
34903>>>            Set Label to "•¨ã©«žª"
34904>>>            Set Color to 13688273
34905>>>            Set FontSize to 4 0
34906>>>            Set Location to 14 81
34907>>>            Set Size to 10 33
34908>>>            Set Justification_Mode to jMode_Left
34909>>>            Set TypeFace to "MS Sans Serif"
34910>>>            Set Enabled_State to TRUE
34911>>>        End_Object    // Textbox7
34912>>>
34912>>>        Object Textbox8 is a TextBoxSub
34914>>>            Set Label to "‰à› ¡æª"
34915>>>            Set Color to 13688273
34916>>>            Set FontSize to 4 0
34917>>>            Set Location to 37 81
34918>>>            Set Size to 10 33
34919>>>            Set Justification_Mode to jMode_Left
34920>>>            Set TypeFace to "MS Sans Serif"
34921>>>            Set Enabled_State to TRUE
34922>>>        End_Object    // Textbox8
34923>>>
34923>>>        Object BitmapContainerSub2 is a BitmapContainerSub
34925>>>            Set Size to 60 71
34926>>>            Set Location to 6 4
34927>>>            Set Bitmap to "Protem-233.bmp"
34928>>>            Set Border_Style to Border_None
34929>>>            Set Bitmap_Style to Bitmap_Stretch
34930>>>        End_Object    // BitmapContainerSub2
34931>>>
34931>>>
34931>>>        //AB-StoreStart
34931>>>                
34931>>>        Set Modal_State to True
34932>>>        
34932>>>        ON_KEY KENTER SEND OnClick to (oOk_bn(Current_Object))
34933>>>        ON_KEY KSAVE_RECORD SEND OK
34934>>>        ON_KEY KCANCEL SEND EXIT_APPLICATION
34935>>>        ON_KEY KCLOSE_PANEL SEND EXIT_APPLICATION
34936>>>        
34936>>>        Set Locate_Mode to Center_On_Screen
34937>>>        Set Exit_Application_Local_State to False
34938>>>        Set Exit_MSG to Exit
34939>>>        Set Description_State to True
34940>>>        
34940>>>        Property Integer LoginOk public false
34942>>>        
34942>>>        External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;            Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
34943>>>        
34943>>>        Function Network_User_Name Returns String
34945>>>            Local String sName sLength
34946>>>            Local Pointer lpName_Addr lpLength_Addr
34946>>>            Local Integer iRetval
34946>>>        
34946>>>            Movestr (Repeat (Character (0), 255)) To sName
34947>>>>
34947>>>            GetAddress Of sName To lpName_Addr
34948>>>            Movestr (DwordToBytes (255)) To sLength
34949>>>>
34949>>>            GetAddress Of sLength To lpLength_Addr
34950>>>        
34950>>>            Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
34951>>>>
34951>>>        
34951>>>            If iRetval Eq 0 Function_Return (CString (sName))
34954>>>            Else Function_Return "User Unknown"
34956>>>        End_Function // Network_User_Name
34957>>>        
34957>>>        
34957>>>        //Object oCrypt is a dbOLEChilkatCrypt2
34957>>>        //End_Object
34957>>>        
34957>>>        //Function fsEncryptOrDecryptMyString Integer aiEncryptOrDecrypt String asText Returns String
34957>>>        //    String password sReturnText
34957>>>        //    Move "" to sReturnText
34957>>>        
34957>>>        //    //------------------------------------------------------------------------
34957>>>        //    // „«¦ £˜©œ « ª §˜¨˜£œ«¨¦¬ª š ˜ «¦ encryption / decryption
34957>>>        //    //------------------------------------------------------------------------
34957>>>        //    SET ChilkatCrypt2CryptAlgorithm Of oCrypt to "ARC4" //"aes"
34957>>>        //    SET ChilkatCrypt2CipherMode     Of oCrypt to "cbc"
34957>>>        //    SET ChilkatCrypt2KeyLength      Of oCrypt to  16
34957>>>        //    Move "YannisSecretPhrase"                 to password
34957>>>        //    //  Generate a binary secret key from a password string
34957>>>        //    //  of any length.  For 128-bit encryption, GenEncodedSecretKey
34957>>>        //    //  generates the MD5 hash of the password and returns it
34957>>>        //    //  in the encoded form requested.  The 2nd param can be
34957>>>        //    //  "hex", "base64", "url", "quoted-printable", etc.
34957>>>        //    String hexKey
34957>>>        //    Get ChilkatCrypt2GenEncodedSecretKey    Of oCrypt password "hex" to hexKey
34957>>>        //    Send ChilkatCrypt2SetEncodedKey         Of oCrypt hexKey   "hex"
34957>>>        //    SET ChilkatCrypt2EncodingMode           Of oCrypt                to "base32"
34957>>>        //    //------------------------------------------------------------------------
34957>>>        //    // „«¦ £˜©œ « ª §˜¨˜£œ«¨¦¬ª š ˜ «¦ encryption / decryption
34957>>>        //    //------------------------------------------------------------------------
34957>>>        
34957>>>        //    If (aiEncryptOrDecrypt=1) Begin
34957>>>        //        // Encrypt a string and return the binary encrypted data
34957>>>        //        //  in a base-64 encoded string.
34957>>>        //        Get ChilkatCrypt2EncryptStringENC Of oCrypt asText to sReturnText
34957>>>        //    End
34957>>>        //    Else If (aiEncryptOrDecrypt=2) Begin
34957>>>        //        //  Decrypt and show the original string:
34957>>>        //        Get ChilkatCrypt2DecryptStringENC Of oCrypt asText to sReturnText
34957>>>        //    End
34957>>>        //    Function_Return sReturnText
34957>>>        //End_Function
34957>>>        
34957>>>        
34957>>>        Procedure Activating
34959>>>            Local String LoginDriver## LoginServer## LoginUserid## LoginPassword##
34960>>>            Local String LastLogin## LoginSeq##
34960>>>            Local Integer SavePassword##
34960>>>        
34960>>>            Forward Send Activating
34962>>>        
34962>>>            Set Value of frmUser    Item 0 to ""
34963>>>            Set Value of frmKodikos Item 0 to ""
34964>>>        
34964>>>        //---------------
34964>>>        // REM 14/11/2011
34964>>>        //    get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
34964>>>        //    If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
34964>>>        //    insert "WorkSpaces\" in LastLogin## at 1
34964>>>        //    Append LastLogin## "\" (Module_Name(Self)) "\LastLogin"
34964>>>        //    get_profile_string LastLogin## "LoginDriver" to LoginSeq##
34964>>>        
34964>>>            Move "DATAFLEX|SQL_DRV.DLL|DATAFLEX"    to LoginSeq##
34965>>>            Move ""                                 to LoginServer##
34966>>>        
34966>>>            If "|" in LoginSeq## move (left(LoginSeq##,(pos("|",LoginSeq##) -1)))   to LoginDriver##
34969>>>            Else Move LoginSeq##                                                    to LoginDriver##
34971>>>        
34971>>>        //    get_profile_string LastLogin## "LoginServer"  to LoginServer##
34971>>>        //    get_profile_string LastLogin## "LoginUserId"  to LoginUserId##
34971>>>        //    get_profile_string LastLogin## "SavePassword" to SavePassword##
34971>>>        
34971>>>        //    If LoginUserId## eq "" Move (Network_User_Name(Current_Object)) to LoginUserId##
34971>>>        
34971>>>            If (((UpperCase(LoginDriver##)) eq "DATAFLEX") or (LoginDriver## eq "")) Begin
34973>>>                    Set Value of (ComboForm2(Current_Object)) Item 0 to ""
34974>>>                    Set Value of (Form4(Current_Object))      Item 0 to ""
34975>>>            End
34975>>>>
34975>>>            Else Begin
34976>>>                Set Value of (ComboForm2(Current_Object)) Item 0 to LoginDriver##
34977>>>                Set Value of (Form4(Current_Object))      Item 0 to LoginServer##
34978>>>            End
34978>>>>
34978>>>        
34978>>>        //    Set Value of (frmUser(Current_Object))          Item 0 to LoginUserID##
34978>>>        //    Set Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
34978>>>        
34978>>>        //    If (SavePassword##) Begin
34978>>>        //        Set_Registry_Root TO HKEY_CURRENT_USER "Software"
34978>>>        //        get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
34978>>>        
34978>>>        //        // 28/07/2011
34978>>>        //        //Set Value of (frmKodikos(Self)) Item 0 to LoginPassword##
34978>>>        
34978>>>        //        Clear Users
34978>>>        //        Move LoginUserId## to Users.Login_ID
34978>>>        //        Find Eq Users by Index.1
34978>>>        //        If (Trim(Users.Password)<>"") Set Value of (frmKodikos(Self)) Item 0 to (fsCryptoNew(Self,"Decrypt",LoginPassword##))
34978>>>        //        Else                          Set Value of (frmKodikos(Self)) Item 0 to ""
34978>>>        
34978>>>        //        // 28/07/2011 REM until we finish the securities
34978>>>        //        //Set Value of (frmKodikos(Self)) Item 0 to (fsCrypto(Self,"Backward",LoginPassword##))
34978>>>        //                                                  //(fsEncryptOrDecryptMyString(Self,2,LoginPassword##))
34978>>>        
34978>>>        //        SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
34978>>>        //    End
34978>>>        End_Procedure
34979>>>        
34979>>>        Function LoginUser Returns Integer
34981>>>            Integer SavePassword## Size## PasswordOk success
34982>>>            String LoginDriver## LoginServer## LoginUserid## LoginPassword## LoginSeq## LastLogin##
34982>>>            String lsLoginDate lsHH lsMM lsSS sDepartment
34982>>>            Integer liOpenCursors
34982>>>            String sUsrP
34982>>>            //String sDeCryptoPassw
34982>>>        
34982>>>            Send Popup_Modal
34983>>>        
34983>>>            // Trexei thn Activating kai meta epanerxetai edo
34983>>>        
34983>>>            //Send Activate Of oCrypt
34983>>>            //Get ChilkatCrypt2UnlockComponent Of oCrypt "Crypt12345678_4CC88148VHXA" to success
34983>>>        
34983>>>            //Get Checked_State Of CheckBox1 to SavePassword##
34983>>>        
34983>>>            //If (SavePassword##) Begin
34983>>>            //    Set_Registry_Root TO HKEY_CURRENT_USER "Software"
34983>>>            //    get_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
34983>>>            //    Set Value of (frmKodikos(Current_Object)) Item 0 to (fsEncryptOrDecryptMyString(Self,2,LoginPassword##))
34983>>>            //    SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
34983>>>            //End
34983>>>        
34983>>>            Get Value of (ComboForm2(Current_Object))       Item 0 to LoginDriver##
34984>>>            Get Value of (Form4(Current_Object))            Item 0 to LoginServer##
34985>>>        
34985>>>            Get Value of (frmUser(Current_Object))          Item 0 to LoginUserID##
34986>>>            Get Value of (frmKodikos(Current_Object))       Item 0 to LoginPassword##
34987>>>        
34987>>>            Get Select_State of (CheckBox1(Current_Object)) Item 0 to SavePassword##
34988>>>        
34988>>>            //---------------
34988>>>            // REM 14/11/2011
34988>>>            //Set Value of (frmKodikos(Current_Object))       Item 0 to ""
34988>>>                get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
34991>>>                If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
34994>>>                insert "WorkSpaces\" in LastLogin## at 1
34996>>>                Append LastLogin## "\" (Module_Name(Self))
34998>>>                Append LastLogin## "\LastLogin"
34999>>>                set_profile_string LastLogin## "LoginUserId" to LoginUserId##
35002>>>            //---------------
35002>>>            // REM 14/11/2011
35002>>>        
35002>>>        
35002>>>            If ((LoginDriver## <> "") and (UpperCase(LoginDriver##)<>"DATAFLEX"))  begin
35004>>>                Set LoginOk to True
35005>>>            End
35005>>>>
35005>>>            Else Begin
35006>>>                Set LoginOk to True
35007>>>                Open "Users" as Users
35009>>>                Move "DATAFLEX" To LoginDriver##
35010>>>                Move "" to LoginServer##
35011>>>                File_Size Users to Size##
35014>>>                If Size## ne 0 Begin
35016>>>                     Clear Users
35017>>>                     Move LoginUSerId##   to Users.Login_Id
35018>>>                     Find eq Users by Index.1
35019>>>>
35019>>>                     [Finderr] Begin
35021>>>>
35021>>>                        Error 9001 "Ž ®¨ã©«žª œå¤˜  áš¤à©«¦ª"
35022>>>>
35022>>>                        Set LoginOk to False
35023>>>                        Get LoginOk to PasswordOk
35024>>>                        Function_Return PasswordOk
35025>>>                     End
35025>>>>
35025>>>        
35025>>>                     [Found] Begin
35027>>>>
35027>>>        
35027>>>                        If (Users.Anenergos="1") Begin
35029>>>                            Move 1 to iAnenergos
35030>>>                            Error 9669 "Ž ®¨ã©«žª œå¤˜  ˜¤œ¤œ¨šæª"
35031>>>>
35031>>>                            Move 1 to iHasAPassword
35032>>>                            Set LoginOk to False
35033>>>                            Get LoginOk to PasswordOk
35034>>>                            Function_Return PasswordOk
35035>>>                        End
35035>>>>
35035>>>        
35035>>>                        Move (Trim(Users.Password)) to sUsrP
35036>>>        
35036>>>                        // 28/07/2011 REM until we finish the securities
35036>>>                        Move (fsCryptoNew(Self,"Decrypt",sUsrP))  to sUsrP
35037>>>        
35037>>>                        //If ((LoginPassword## <> sUsrP) And (Trim(sUsrP)<>"")) Begin
35037>>>                        If (LoginPassword## <> sUsrP) Begin
35039>>>                            Error 9002 "Ž ¡à› ¡æª œå¤˜  ¢˜¤Ÿ˜©£â¤¦ª"
35040>>>>
35040>>>                            Move 1 to iHasAPassword
35041>>>                            Set LoginOk to False
35042>>>                            Get LoginOk to PasswordOk
35043>>>                            Function_Return PasswordOk
35044>>>                        End
35044>>>>
35044>>>        //                Else If ((LoginPassword## <> sUsrP) And (Trim(LoginPassword##)<>"") And (Trim(sUsrP)<>"")) Begin
35044>>>        //                    Error 9002 "Ž ¡à› ¡æª œå¤˜  ¢˜¤Ÿ˜©£â¤¦ª"
35044>>>        //                    Move 1 to iHasAPassword
35044>>>        //                    Set LoginOk to False
35044>>>        //                    Get LoginOk to PasswordOk
35044>>>        //                    Function_Return PasswordOk
35044>>>        //                End
35044>>>                        Else Begin
35045>>>                            //If (LoginPassword## = sUsrP) Begin
35045>>>                            //And (Trim(LoginPassword##)<>"")) OR ;
35045>>>                            //      ((LoginPassword##=sUsrP) And (Trim(LoginPassword##) ="")) Begin
35045>>>                            Date dShmera
35045>>>                            String sHH sMM sSS sTime
35045>>>                            Sysdate dShmera sHH sMM sSS
35049>>>                            Move (Trim(sHH)) to sHH
35050>>>                            Move (Trim(sMM)) to sMM
35051>>>                            Move (Trim(sSS)) to sSS
35052>>>                            If (Length(sHH)=1) Insert '0' in sHH at 1
35056>>>                            If (Length(sMM)=1) Insert '0' in sMM at 1
35060>>>                            If (Length(sSS)=1) Insert '0' in sSS at 1
35064>>>                            Move (sHH+":"+sMM+"."+sSS) to sTime
35065>>>        
35065>>>                            Reread Users
35069>>>        
35069>>>                            If (Users.Next_Change<>"") Begin
35071>>>                                Reread Sysrec
35075>>>                                Unlock
35076>>>>
35076>>>                                Move (Users.Next_Change<dShmera) to iMustResetPass
35077>>>                            End
35077>>>>
35077>>>        
35077>>>                            Move dShmera                    to Users.Last_Login_Date
35078>>>                            Move sTime                      to Users.Last_Login_Time
35079>>>        
35079>>>                            If ((iMustResetPass) Or (Trim(sUsrP)="")) Begin
35081>>>        
35081>>>                                If (Trim(Users.Password)<>"") ;                                    Move Users.Password to Users.Last_Password
35084>>>        
35084>>>                                //Move ""                 to Users.Password
35084>>>                                Move ""                 to sUsrP
35085>>>        
35085>>>                                Send Info_Box "Ž › á¨¡œ ˜ «¦¬ §¨¦žš¦ç£œ¤¦¬ ¡à› ¡¦ç §˜¨ã¢Ÿœ\n¨â§œ  ¤˜ ¡˜«˜®à¨ã©œ«œ ¤œ¦ ¡à› ¡æ œ ©æ›¦¬" "¢ž¨¦­¦¨å˜"
35086>>>        
35086>>>        
35086>>>                                Saverecord Users
35087>>>                                Unlock
35088>>>>
35088>>>        
35088>>>                                Move 0 to iHasAPassword
35089>>>                                Set LoginOk to False
35090>>>                                Get LoginOk to PasswordOk
35091>>>                                Function_Return PasswordOk
35092>>>        
35092>>>                            End
35092>>>>
35092>>>                            Saverecord Users
35093>>>                            Unlock
35094>>>>
35094>>>                            //End
35094>>>                        End
35094>>>>
35094>>>                        Move (Trim(sUsrP)<>"")   to iHasAPassword
35095>>>                        Move Users.Departm_Code  to sDepartment
35096>>>                        Move (Trim(sDepartment)) to sDepartment
35097>>>                     End
35097>>>>
35097>>>                End
35097>>>>
35097>>>                Close Users
35098>>>            End
35098>>>>
35098>>>        
35098>>>            Open Users
35100>>>            File_Size Users to Size##
35103>>>            If Size## ne 0 Begin
35105>>>                Clear Users
35106>>>                Move LoginUSerId##   to Users.Login_Id
35107>>>                Find eq Users by Index.1
35108>>>>
35108>>>                [Finderr] Begin
35110>>>>
35110>>>                    Error 9003 "Ž ®¨ã©«žª œå¤˜  áš¤à©«¦ª"
35111>>>>
35111>>>                    Set LoginOk to False
35112>>>                    Get LoginOk to PasswordOk
35113>>>                    Function_Return PasswordOk
35114>>>                 End
35114>>>>
35114>>>                 [Found] Begin
35116>>>>
35116>>>                    Move (Trim(Users.Password)) to sUsrP
35117>>>        
35117>>>                    // 28/07/2011 REM until we finish the securities
35117>>>                    Move (fsCryptoNew(Self,"Decrypt",sUsrP))  to sUsrP
35118>>>        
35118>>>                    If ((LoginPassword## <> sUsrP) And (Trim(LoginPassword##)<>"")) Begin
35120>>>                        Error 9002 "Ž ¡à› ¡æª œå¤˜  ¢˜¤Ÿ˜©£â¤¦ª"
35121>>>>
35121>>>                        Move 1 to iHasAPassword
35122>>>                        Set LoginOk to False
35123>>>                        Get LoginOk to PasswordOk
35124>>>                        Function_Return PasswordOk
35125>>>                    End
35125>>>>
35125>>>                    Else Begin
35126>>>                        If ((LoginPassword## = sUsrP) And (Trim(LoginPassword##)<>"")) Begin
35128>>>                                Sysdate dShmera sHH sMM sSS
35132>>>                                Move (Trim(sHH)) to sHH
35133>>>                                Move (Trim(sMM)) to sMM
35134>>>                                Move (Trim(sSS)) to sSS
35135>>>                                If (Length(sHH)=1) Insert '0' in sHH at 1
35139>>>                                If (Length(sMM)=1) Insert '0' in sMM at 1
35143>>>                                If (Length(sSS)=1) Insert '0' in sSS at 1
35147>>>                                Move (sHH+":"+sMM+"."+sSS) to sTime
35148>>>        
35148>>>                                Reread Users
35152>>>        
35152>>>                                If (Users.Next_Change<>"") Begin
35154>>>                                    Reread Sysrec
35158>>>                                    Unlock
35159>>>>
35159>>>                                    Move (Users.Next_Change<dShmera) to iMustResetPass
35160>>>                                End
35160>>>>
35160>>>        
35160>>>                                Move dShmera                    to Users.Last_Login_Date
35161>>>                                Move sTime                      to Users.Last_Login_Time
35162>>>        
35162>>>                                If (iMustResetPass) Begin
35164>>>        
35164>>>                                    If (Trim(Users.Password)<>"") ;                                        Move Users.Password to Users.Last_Password
35167>>>        
35167>>>                                    Move ""                 to Users.Password
35168>>>                                    Move ""                 to sUsrP
35169>>>                                End
35169>>>>
35169>>>        
35169>>>                                Saverecord Users
35170>>>                                Unlock
35171>>>>
35171>>>        
35171>>>                        End
35171>>>>
35171>>>                    End
35171>>>>
35171>>>                    Move (Trim(sUsrP)<>"")   to iHasAPassword
35172>>>                    Move Users.Departm_Code  to sDepartment
35173>>>                    Move (Trim(sDepartment)) to sDepartment
35174>>>                End
35174>>>>
35174>>>            End
35174>>>>
35174>>>            Close Users
35175>>>        
35175>>>            Get LoginOk to PasswordOk
35176>>>            Sysdate lsLoginDate lsHH lsMM lsSS
35180>>>            get_profile_string "WorkSpaces" "CurrentWorkspace" to LastLogin##
35183>>>            If LastLogin## eq "" Get WorkspaceName of (ProgramWorkspace(Self)) to LastLogin##
35186>>>            insert "WorkSpaces\" in LastLogin## at 1
35188>>>            get_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
35191>>>            If ((LoginDriver## ne "") and ((UpperCase(LoginDriver##)) ne "DATAFLEX")) Begin
35193>>>               If Not LoginDriver## in LoginSeq## Begin
35195>>>                     If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
35198>>>                     Else Move (LoginSeq##+"|"+LoginDriver##) to LoginSeq##
35200>>>                     set_profile_string LastLogin## "AvailableDrivers" to LoginSeq##
35203>>>               End
35203>>>>
35203>>>            End
35203>>>>
35203>>>            Append LastLogin## "\" (Module_Name(Self))
35205>>>            Append LastLogin## "\LastLogin"
35206>>>            get_profile_string LastLogin## "LoginDriver" to LoginSeq##
35209>>>        
35209>>>            If "|" in LoginSeq## Begin
35211>>>                If ((left(LoginSeq##,(pos("|",LoginSeq##) -1))) ne LoginDriver##) Insert (LoginDriver##+"|") in LoginSeq## at 1
35215>>>            End
35215>>>>
35215>>>            Else Begin
35216>>>                If LoginSeq## eq "" Move LoginDriver## to LoginSeq##
35219>>>                Else If LoginSeq## ne LoginDriver## Insert (LoginDriver##+"|") in LoginSeq## at 1
35224>>>            End
35224>>>>
35224>>>            Left LoginSeq## to LoginSeq## 250
35226>>>>
35226>>>            set_profile_string LastLogin## "LoginDriver" to (UpperCase(LoginSeq##))
35229>>>            set_profile_string LastLogin## "LoginServer" to LoginServer##
35232>>>            set_profile_string LastLogin## "LoginUserId" to LoginUserId##
35235>>>            set_profile_string LastLogin## "SavePassword" to SavePassword##
35238>>>            If lsHH lt 10 Insert 0 in lsHH at 1
35242>>>            If lsMM lt 10 Insert 0 in lsMM at 1
35246>>>            If lsSS lt 10 Insert 0 in lsSS at 1
35250>>>            Append lsLoginDate " - " lsHH ":" lsMM ":" lsSS
35256>>>            set_profile_string LastLogin## "LoginTime" to lsLoginDate
35259>>>            If (SavePassword##) Begin
35261>>>                Set_Registry_Root TO HKEY_CURRENT_USER "Software"
35262>>>        
35262>>>                // 28/07/2011 REM until we finish the securities and cryptography
35262>>>                //set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to LoginPassword##
35262>>>                set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to (fsCryptoNew(Self,"Encrypt",LoginPassword##))
35265>>>        
35265>>>                SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
35266>>>            End
35266>>>>
35266>>>            Else Begin
35267>>>                Set_Registry_Root TO HKEY_CURRENT_USER "Software"
35268>>>                set_foreign_profile_string ("SubNet Hellas\"+(WorkspaceName(ProgramWorkspace(Self)))+"\"+(Module_Name(Self))) LoginUserID## "Access" to ""
35271>>>                SET_REGISTRY_ROOT to HKEY_LOCAL_MACHINE "SOFTWARE"
35272>>>            End
35272>>>>
35272>>>        
35272>>>            Function_Return PasswordOk
35273>>>        End_Function
35274>>>        
35274>>>        
35274>>>        Procedure Login For Desktop
35275>>>            Local Integer LoginPassword##
35276>>>        
35276>>>            Add 1 to iMetrhthsProsp
35277>>>        
35277>>>            Get LoginUser of (Connect(Current_Object)) to LoginPassword##
35278>>>        
35278>>>            If Not LoginPassword## Move 99 to iApotel // 30-08-2011  Send Exit_Application
35281>>>        End_Procedure
35282>>>        
35282>>>        Function CheckLogin For Desktop Returns Integer
35283>>>            Local Integer LoginPassword##
35284>>>            Get LoginUser of (Connect(Current_Object)) to LoginPassword##
35285>>>            Function_Return LoginPassword##
35286>>>        End_Function
35287>>>        
35287>>>        
35287>>>        
35287>>>        //AB-StoreEnd
35287>>>
35287>>>    End_Object    // Connect
35288>>>
35288>>>
35288>>>    //AB-StoreStart
35288>>>            
35288>>>            
35288>>>            
35288>>>            
35288>>>            
35288>>>            
35288>>>            
35288>>>    //AB-StoreEnd
35288>>>
35288>>>//AB/     End_Object    // prj
35288>//use checkafm.pkg
35288>//use checklog.pkg
35288>
35288>Reread Sysrec
35292>Unlock
35293>Move Sysrec.TIKANEI_CODE    to iMax00
35294>Move 1                      to iMetrhthsProsp
35295>
35295>Use PASSDLG2.DG
INCLUDING FILE: PASSDLG2.DG
35295>>>//AB/ Project Password Dialog
35295>>>//AB/     Object prj is a Dialog_Project
35295>>>//AB/         Set ProjectName to "Password Dialog"
35295>>>//AB/         Set ProjectFileName to "PASSDLG2.DG"
35295>>>
35295>>>// Project Object Structure
35295>>>//   oNewPassDlg is a ModalPanelSub
35295>>>//     ConfirmPassForm is a FormSub
35295>>>//     NewPassForm is a FormSub
35295>>>//     NewPassForm2 is a FormSub
35295>>>//     oOK_bn is a ButtonSub
35295>>>//     TextBox_EZ1 is a TextBoxSub
35295>>>//     TextBox_EZ2 is a TextBoxSub
35295>>>//     TextBox_EZ3 is a TextBoxSub
35295>>>//     oCancel_bn is a ButtonSub
35295>>>//     chkLengthOverEight is a CheckBoxSub
35295>>>//     chk3Consecutive is a CheckBoxSub
35295>>>//     chkAtLeast1Upper is a CheckBoxSub
35295>>>//     chkAtLeast1Lower is a CheckBoxSub
35295>>>//     chkAtLeast1Number is a CheckBoxSub
35295>>>//     chkAtLeast1Special is a CheckBoxSub
35295>>>//     chkNoGreek is a CheckBoxSub
35295>>>//     chkSeiriakous is a CheckBoxSub
35295>>>//     chkBlanks is a CheckBoxSub
35295>>>//     TextBoxSub4 is a TextBoxSub
35295>>>//     TextBoxSub5 is a TextBoxSub
35295>>>//     TextBoxSub6 is a TextBoxSub
35295>>>//     TextBoxSub7 is a TextBoxSub
35295>>>//     TextBoxSub8 is a TextBoxSub
35295>>>//     TextBoxSub9 is a TextBoxSub
35295>>>//     TextBoxSub10 is a TextBoxSub
35295>>>//     TextBoxSub11 is a TextBoxSub
35295>>>//     TextBoxSub12 is a TextBoxSub
35295>>>//     TextBoxSub13 is a TextBoxSub
35295>>>//     TextBoxSub14 is a TextBoxSub
35295>>>//     TextBoxSub15 is a TextBoxSub
35295>>>//     TextBoxSub16 is a TextBoxSub
35295>>>//     txt1 is a TextBoxSub
35295>>>//     txt2 is a TextBoxSub
35295>>>//     txt3 is a TextBoxSub
35295>>>//     txt4 is a TextBoxSub
35295>>>//     txt5 is a TextBoxSub
35295>>>//     txt6 is a TextBoxSub
35295>>>//     txt7 is a TextBoxSub
35295>>>//     txt8 is a TextBoxSub
35295>>>//     txt9 is a TextBoxSub
35295>>>//     ButtonSub1 is a ButtonSub
35295>>>
35295>>>// Register all objects
35295>>>Register_Object ButtonSub1
35295>>>Register_Object ConfirmPassForm
35295>>>Register_Object chk3Consecutive
35295>>>Register_Object chkAtLeast1Lower
35295>>>Register_Object chkAtLeast1Number
35295>>>Register_Object chkAtLeast1Special
35295>>>Register_Object chkAtLeast1Upper
35295>>>Register_Object chkBlanks
35295>>>Register_Object chkLengthOverEight
35295>>>Register_Object chkNoGreek
35295>>>Register_Object chkSeiriakous
35295>>>Register_Object NewPassForm
35295>>>Register_Object NewPassForm2
35295>>>Register_Object oCancel_bn
35295>>>Register_Object oNewPassDlg
35295>>>Register_Object oOK_bn
35295>>>Register_Object TextBox_EZ1
35295>>>Register_Object TextBox_EZ2
35295>>>Register_Object TextBox_EZ3
35295>>>Register_Object TextBoxSub10
35295>>>Register_Object TextBoxSub11
35295>>>Register_Object TextBoxSub12
35295>>>Register_Object TextBoxSub13
35295>>>Register_Object TextBoxSub14
35295>>>Register_Object TextBoxSub15
35295>>>Register_Object TextBoxSub16
35295>>>Register_Object TextBoxSub4
35295>>>Register_Object TextBoxSub5
35295>>>Register_Object TextBoxSub6
35295>>>Register_Object TextBoxSub7
35295>>>Register_Object TextBoxSub8
35295>>>Register_Object TextBoxSub9
35295>>>Register_Object txt1
35295>>>Register_Object txt2
35295>>>Register_Object txt3
35295>>>Register_Object txt4
35295>>>Register_Object txt5
35295>>>Register_Object txt6
35295>>>Register_Object txt7
35295>>>Register_Object txt8
35295>>>Register_Object txt9
35295>>>
35295>>>
35295>>>
35295>>>    //AB-StoreTopStart
35295>>>            
35295>>>    Open Sysrec
35297>>>    Open Users
35299>>>    Open UsersH
35301>>>    
35301>>>    //Use FlexOle
35301>>>    //Use ChilkatCrypt
35301>>>    
35301>>>    //AB-StoreTopEnd
35301>>>
35301>>>    //AB-IgnoreStart
35301>>>
35301>>>    Use Panel.Sub
35301>>>    Use Form.Sub
35301>>>    Use Button.Sub
35301>>>    Use Txtbox.Sub
35301>>>    Use Chkbox.Sub
35301>>>
35301>>>
35301>>>    //AB-IgnoreEnd
35301>>>
35301>>>    Object oNewPassDlg is a ModalPanelSub
35303>>>
35303>>>        //AB-StoreTopStart
35303>>>        
35303>>>        Property String     psOldPassword   Public ""
35305>>>        Property String     psNewPassword   Public ""
35307>>>        Property String     piCanceled      Public False
35309>>>        Property String     piState         Public 0
35311>>>        Property Integer    piPasswordState Public 1
35313>>>        
35313>>>        Enum_List
35313>>>            Define All_Ok           // 0
35313>>>            Define Canceled         // 1
35313>>>            Define Same_Password    // 2
35313>>>            Define Wrong_Password   // 3
35313>>>            Define Not_Match        // 4
35313>>>            Define No_Password      // 5
35313>>>            Define Wrong_Prev_Passw // 6
35313>>>            Define Already_Used     // 7
35313>>>        End_Enum_List
35313>>>        
35313>>>        //AB-StoreTopEnd
35313>>>
35313>>>        Set Minimize_Icon to FALSE
35314>>>        Set Label to "€¢¢˜šã ‰à› ¡¦ç ¨æ©™˜©žª"
35315>>>        Set Size to 233 387
35316>>>        Set Location to 9 31
35317>>>        Set Color to 13688273
35318>>>        Set Popup_State to TRUE
35319>>>
35319>>>        //AB-DDOStart
35319>>>
35319>>>
35319>>>        //AB-DDOEnd
35319>>>
35319>>>        Object ConfirmPassForm is a FormSub
35321>>>
35321>>>            //AB-StoreTopStart
35321>>>                                            
35321>>>            //AB-StoreTopEnd
35321>>>
35321>>>            Set Size to 13 110
35322>>>            Set Location to 14 157
35323>>>            Set Label_Col_Offset to 2
35324>>>            Set Label_Justification_Mode to jMode_Right
35325>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35326>>>
35326>>>            //AB-StoreStart
35326>>>                                            
35326>>>            Set Password_State to True
35327>>>            
35327>>>            //AB-StoreEnd
35327>>>
35327>>>        End_Object    // ConfirmPassForm
35328>>>
35328>>>        Object NewPassForm is a FormSub
35330>>>
35330>>>            //AB-StoreTopStart
35330>>>                                            
35330>>>            //AB-StoreTopEnd
35330>>>
35330>>>            Set Size to 13 110
35331>>>            Set Location to 34 157
35332>>>            Set Label_Col_Offset to 2
35333>>>            Set Label_Justification_Mode to jMode_Right
35334>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35335>>>
35335>>>            //AB-StoreStart
35335>>>                                            
35335>>>            Set Password_State to True
35336>>>            
35336>>>            Procedure OnChange
35338>>>            
35338>>>                Integer rVal bState i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iMax iHasProblems
35339>>>                Integer iHasProblems1 iHasProblems2 iHasProblems3 iHasProblems4 iHasProblems5
35339>>>                Integer iHasProblems6 iHasProblems7 iHasProblems8 iHasProblems9
35339>>>                String  asPassw
35339>>>            
35339>>>                Move 0 to iHasProblems1
35340>>>                Move 0 to iHasProblems2
35341>>>                Move 0 to iHasProblems3
35342>>>                Move 0 to iHasProblems4
35343>>>                Move 0 to iHasProblems5
35344>>>                Move 0 to iHasProblems6
35345>>>                Move 0 to iHasProblems7
35346>>>                Move 0 to iHasProblems8
35347>>>                Move 0 to iHasProblems9
35348>>>            
35348>>>                Get Value Item 0 to asPassw
35349>>>                Move (Trim(asPassw)) to asPassw
35350>>>            
35350>>>                Reread Sysrec
35354>>>                Unlock
35355>>>>
35355>>>                Move Sysrec.LIBCAST_CODE    to i1
35356>>>                Move Sysrec.AWARD_CODE      to i2
35357>>>                Move Sysrec.GIVAWRD_CODE    to i3
35358>>>                Move Sysrec.MOVIE_LNK_CODE  to i4
35359>>>                Move Sysrec.CAST_LNK_CODE   to i5
35360>>>                Move Sysrec.AWARDTP_CODE    to i6
35361>>>                Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
35362>>>                Move Sysrec.STWHAT_CODE     to i8
35363>>>                Move Sysrec.SNWHAT_CODE     to i9
35364>>>            
35364>>>                If ((i1=1) And (Length(asPassw)<8))                Move 1 to iHasProblems1
35367>>>                If ((i2=1) And (HasDuplicates (Self,asPassw  )=1)) Move 1 to iHasProblems2
35370>>>                If ((i3=1) And (HasOneCap     (Self,asPassw,1)=0)) Move 1 to iHasProblems3
35373>>>                If ((i4=1) And (HasOneSmall   (Self,asPassw,1)=0)) Move 1 to iHasProblems4
35376>>>                If ((i5=1) And (HasOneNumber  (Self,asPassw  )=0)) Move 1 to iHasProblems5
35379>>>                If ((i6=1) And (HasOneSpecial (Self,asPassw  )=0)) Move 1 to iHasProblems6
35382>>>                If ((i7=1) And (HasOneGreek   (Self,asPassw  )=1)) Move 1 to iHasProblems7
35385>>>                If ((i8=1) And (HasInRow      (Self,asPassw,1)=1)) Move 1 to iHasProblems8
35388>>>                If ((i9=1) And (Pos(" ",asPassw)>0))               Move 1 to iHasProblems9
35391>>>            
35391>>>                If (iHasProblems1=1) Set TextColor Of txt1 to clRed
35394>>>                Else                 Set TextColor Of txt1 to clBlack
35396>>>            
35396>>>                If (iHasProblems2=1) Set TextColor Of txt2 to clRed
35399>>>                Else                 Set TextColor Of txt2 to clBlack
35401>>>            
35401>>>                If (iHasProblems3=1) Set TextColor Of txt3 to clRed
35404>>>                Else                 Set TextColor Of txt3 to clBlack
35406>>>            
35406>>>                If (iHasProblems4=1) Set TextColor Of txt4 to clRed
35409>>>                Else                 Set TextColor Of txt4 to clBlack
35411>>>            
35411>>>                If (iHasProblems5=1) Set TextColor Of txt5 to clRed
35414>>>                Else                 Set TextColor Of txt5 to clBlack
35416>>>            
35416>>>                If (iHasProblems6=1) Set TextColor Of txt6 to clRed
35419>>>                Else                 Set TextColor Of txt6 to clBlack
35421>>>            
35421>>>                If (iHasProblems7=1) Set TextColor Of txt7 to clRed
35424>>>                Else                 Set TextColor Of txt7 to clBlack
35426>>>            
35426>>>                If (iHasProblems8=1) Set TextColor Of txt8 to clRed
35429>>>                Else                 Set TextColor Of txt8 to clBlack
35431>>>            
35431>>>                If (iHasProblems9=1) Set TextColor Of txt9 to clRed
35434>>>                Else                 Set TextColor Of txt9 to clBlack
35436>>>            
35436>>>            
35436>>>            End_Procedure
35437>>>            
35437>>>            
35437>>>            
35437>>>            //AB-StoreEnd
35437>>>
35437>>>        End_Object    // NewPassForm
35438>>>
35438>>>        Object NewPassForm2 is a FormSub
35440>>>
35440>>>            //AB-StoreTopStart
35440>>>                                            
35440>>>            //AB-StoreTopEnd
35440>>>
35440>>>            Set Size to 13 110
35441>>>            Set Location to 49 157
35442>>>            Set Label_Col_Offset to 2
35443>>>            Set Label_Justification_Mode to jMode_Right
35444>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35445>>>
35445>>>            //AB-StoreStart
35445>>>                                            
35445>>>            Set Password_State to True
35446>>>            
35446>>>            //AB-StoreEnd
35446>>>
35446>>>        End_Object    // NewPassForm2
35447>>>
35447>>>        Object oOK_bn is a ButtonSub
35449>>>
35449>>>            //AB-StoreTopStart
35449>>>                                            
35449>>>            //AB-StoreTopEnd
35449>>>
35449>>>            Set Label to "€§¦›¦®ã"
35450>>>            Set Default_State to TRUE
35451>>>            Set Location to 70 217
35452>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35453>>>
35453>>>            //AB-StoreStart
35453>>>                                            
35453>>>            Procedure OnClick
35455>>>                Set piState to All_Ok
35456>>>                Delegate Send Stop_Modal_UI
35458>>>            End_Procedure
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            
35459>>>            //AB-StoreEnd
35459>>>
35459>>>        End_Object    // oOK_bn
35460>>>
35460>>>        Object TextBox_EZ1 is a TextBoxSub
35462>>>            Set Label to "˜¢ æª ‰à› ¡æª"
35463>>>            Set Auto_Size_State to FALSE
35464>>>            Set Color to 13688273
35465>>>            Set FontSize to 4 0
35466>>>            Set Location to 14 51
35467>>>            Set Size to 13 85
35468>>>            Set TypeFace to "MS Sans Serif"
35469>>>            Set Enabled_State to TRUE
35470>>>        End_Object    // TextBox_EZ1
35471>>>
35471>>>        Object TextBox_EZ2 is a TextBoxSub
35473>>>            Set Label to "Œâ¦ª ‰à› ¡æª"
35474>>>            Set Color to 13688273
35475>>>            Set FontSize to 4 0
35476>>>            Set Location to 35 51
35477>>>            Set Size to 10 63
35478>>>            Set TypeFace to "MS Sans Serif"
35479>>>            Set Enabled_State to TRUE
35480>>>        End_Object    // TextBox_EZ2
35481>>>
35481>>>        Object TextBox_EZ3 is a TextBoxSub
35483>>>            Set Label to "Œâ¦ª ‰à› ¡æª („§ ™œ™˜åà©ž)"
35484>>>            Set Color to 13688273
35485>>>            Set FontSize to 4 0
35486>>>            Set Location to 50 51
35487>>>            Set Size to 10 98
35488>>>            Set TypeFace to "MS Sans Serif"
35489>>>            Set Enabled_State to TRUE
35490>>>        End_Object    // TextBox_EZ3
35491>>>
35491>>>        Object oCancel_bn is a ButtonSub
35493>>>
35493>>>            //AB-StoreTopStart
35493>>>                                            
35493>>>            //AB-StoreTopEnd
35493>>>
35493>>>            Set Label to "€¡ç¨à©ž"
35494>>>            Set Location to 70 157
35495>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35496>>>
35496>>>            //AB-StoreStart
35496>>>                                            
35496>>>            Procedure OnClick
35498>>>                Set piState to Canceled
35499>>>                Delegate Send Stop_Modal_UI
35501>>>            End_Procedure
35502>>>            
35502>>>            
35502>>>            
35502>>>            
35502>>>            //AB-StoreEnd
35502>>>
35502>>>        End_Object    // oCancel_bn
35503>>>
35503>>>        Object chkLengthOverEight is a CheckBoxSub
35505>>>
35505>>>            //AB-StoreTopStart
35505>>>                                            
35505>>>            //AB-StoreTopEnd
35505>>>
35505>>>            Set Size to 10 11
35506>>>            Set Location to 116 7
35507>>>            Set Checked_State to TRUE
35508>>>            Set Enabled_State to FALSE
35509>>>            Set Item_Shadow_State Item 0 to TRUE
35510>>>            Set Shadow_State Item 0 to TRUE
35511>>>
35511>>>            //AB-StoreStart
35511>>>                                            
35511>>>            Procedure OnChange
35513>>>                Integer isChecked
35514>>>                String lsTheAppPath
35514>>>                Get Checked_State                                       To isChecked
35515>>>                Move (GetTheAppPath(Self))                              To lsTheAppPath
35516>>>                Set_Profile_String lsTheAppPath "Passw_LengthOverEight" To isChecked
35519>>>            End_Procedure
35520>>>            
35520>>>            
35520>>>            
35520>>>            //AB-StoreEnd
35520>>>
35520>>>        End_Object    // chkLengthOverEight
35521>>>
35521>>>        Object chk3Consecutive is a CheckBoxSub
35523>>>
35523>>>            //AB-StoreTopStart
35523>>>                                            
35523>>>            //AB-StoreTopEnd
35523>>>
35523>>>            Set Size to 10 11
35524>>>            Set Location to 127 7
35525>>>            Set Checked_State to TRUE
35526>>>            Set Enabled_State to FALSE
35527>>>            Set Item_Shadow_State Item 0 to TRUE
35528>>>            Set Shadow_State Item 0 to TRUE
35529>>>
35529>>>            //AB-StoreStart
35529>>>                                            
35529>>>            Procedure OnChange
35531>>>                Integer isChecked
35532>>>                String lsTheAppPath
35532>>>                Get Checked_State                                   To isChecked
35533>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35534>>>                Set_Profile_String lsTheAppPath "Passw_3Consecutive"          To isChecked
35537>>>            End_Procedure
35538>>>            
35538>>>            
35538>>>            
35538>>>            //AB-StoreEnd
35538>>>
35538>>>        End_Object    // chk3Consecutive
35539>>>
35539>>>        Object chkAtLeast1Upper is a CheckBoxSub
35541>>>
35541>>>            //AB-StoreTopStart
35541>>>                                            
35541>>>            //AB-StoreTopEnd
35541>>>
35541>>>            Set Size to 10 11
35542>>>            Set Location to 138 7
35543>>>            Set Checked_State to TRUE
35544>>>            Set Enabled_State to FALSE
35545>>>            Set Item_Shadow_State Item 0 to TRUE
35546>>>            Set Shadow_State Item 0 to TRUE
35547>>>
35547>>>            //AB-StoreStart
35547>>>                                            
35547>>>            Procedure OnChange
35549>>>                Integer isChecked
35550>>>                String lsTheAppPath
35550>>>                Get Checked_State                                   To isChecked
35551>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35552>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Upper"          To isChecked
35555>>>            End_Procedure
35556>>>            
35556>>>            
35556>>>            
35556>>>            //AB-StoreEnd
35556>>>
35556>>>        End_Object    // chkAtLeast1Upper
35557>>>
35557>>>        Object chkAtLeast1Lower is a CheckBoxSub
35559>>>
35559>>>            //AB-StoreTopStart
35559>>>                                            
35559>>>            //AB-StoreTopEnd
35559>>>
35559>>>            Set Size to 10 11
35560>>>            Set Location to 150 7
35561>>>            Set Checked_State to TRUE
35562>>>            Set Enabled_State to FALSE
35563>>>            Set Item_Shadow_State Item 0 to TRUE
35564>>>            Set Shadow_State Item 0 to TRUE
35565>>>
35565>>>            //AB-StoreStart
35565>>>                                            
35565>>>            Procedure OnChange
35567>>>                Integer isChecked
35568>>>                String lsTheAppPath
35568>>>                Get Checked_State                                   To isChecked
35569>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35570>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Lower"          To isChecked
35573>>>            End_Procedure
35574>>>            
35574>>>            
35574>>>            
35574>>>            //AB-StoreEnd
35574>>>
35574>>>        End_Object    // chkAtLeast1Lower
35575>>>
35575>>>        Object chkAtLeast1Number is a CheckBoxSub
35577>>>
35577>>>            //AB-StoreTopStart
35577>>>                                            
35577>>>            //AB-StoreTopEnd
35577>>>
35577>>>            Set Size to 10 11
35578>>>            Set Location to 161 7
35579>>>            Set Checked_State to TRUE
35580>>>            Set Enabled_State to FALSE
35581>>>            Set Item_Shadow_State Item 0 to TRUE
35582>>>            Set Shadow_State Item 0 to TRUE
35583>>>
35583>>>            //AB-StoreStart
35583>>>                                            
35583>>>            Procedure OnChange
35585>>>                Integer isChecked
35586>>>                String lsTheAppPath
35586>>>                Get Checked_State                                   To isChecked
35587>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35588>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Number"          To isChecked
35591>>>            End_Procedure
35592>>>            
35592>>>            
35592>>>            
35592>>>            //AB-StoreEnd
35592>>>
35592>>>        End_Object    // chkAtLeast1Number
35593>>>
35593>>>        Object chkAtLeast1Special is a CheckBoxSub
35595>>>
35595>>>            //AB-StoreTopStart
35595>>>                                            
35595>>>            //AB-StoreTopEnd
35595>>>
35595>>>            Set Size to 10 11
35596>>>            Set Location to 172 7
35597>>>            Set Checked_State to TRUE
35598>>>            Set Enabled_State to FALSE
35599>>>            Set Item_Shadow_State Item 0 to TRUE
35600>>>            Set Shadow_State Item 0 to TRUE
35601>>>
35601>>>            //AB-StoreStart
35601>>>                                            
35601>>>            Procedure OnChange
35603>>>                Integer isChecked
35604>>>                String lsTheAppPath
35604>>>                Get Checked_State                                   To isChecked
35605>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35606>>>                Set_Profile_String lsTheAppPath "Passw_AtLeast1Special"          To isChecked
35609>>>            End_Procedure
35610>>>            
35610>>>            
35610>>>            
35610>>>            //AB-StoreEnd
35610>>>
35610>>>        End_Object    // chkAtLeast1Special
35611>>>
35611>>>        Object chkNoGreek is a CheckBoxSub
35613>>>
35613>>>            //AB-StoreTopStart
35613>>>                                            
35613>>>            //AB-StoreTopEnd
35613>>>
35613>>>            Set Size to 10 11
35614>>>            Set Location to 182 7
35615>>>            Set Checked_State to TRUE
35616>>>            Set Enabled_State to FALSE
35617>>>            Set Item_Shadow_State Item 0 to TRUE
35618>>>            Set Shadow_State Item 0 to TRUE
35619>>>
35619>>>            //AB-StoreStart
35619>>>                                            
35619>>>                                            
35619>>>                                            
35619>>>                                            
35619>>>                                            
35619>>>                                            
35619>>>            //AB-StoreEnd
35619>>>
35619>>>        End_Object    // chkNoGreek
35620>>>
35620>>>        Object chkSeiriakous is a CheckBoxSub
35622>>>
35622>>>            //AB-StoreTopStart
35622>>>                                            
35622>>>            //AB-StoreTopEnd
35622>>>
35622>>>            Set Size to 10 11
35623>>>            Set Location to 193 7
35624>>>            Set Checked_State to TRUE
35625>>>            Set Enabled_State to FALSE
35626>>>            Set Item_Shadow_State Item 0 to TRUE
35627>>>            Set Shadow_State Item 0 to TRUE
35628>>>
35628>>>            //AB-StoreStart
35628>>>                                            
35628>>>            Procedure OnChange
35630>>>                Integer isChecked
35631>>>                String lsTheAppPath
35631>>>                Get Checked_State                                   To isChecked
35632>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35633>>>                Set_Profile_String lsTheAppPath "Passw_Seiriakous"          To isChecked
35636>>>            End_Procedure
35637>>>            
35637>>>            
35637>>>            
35637>>>            //AB-StoreEnd
35637>>>
35637>>>        End_Object    // chkSeiriakous
35638>>>
35638>>>        Object chkBlanks is a CheckBoxSub
35640>>>
35640>>>            //AB-StoreTopStart
35640>>>                                            
35640>>>            //AB-StoreTopEnd
35640>>>
35640>>>            Set Size to 10 11
35641>>>            Set Location to 204 7
35642>>>            Set Checked_State to TRUE
35643>>>            Set Enabled_State to FALSE
35644>>>            Set Item_Shadow_State Item 0 to TRUE
35645>>>            Set Shadow_State Item 0 to TRUE
35646>>>
35646>>>            //AB-StoreStart
35646>>>                                            
35646>>>            Procedure OnChange
35648>>>                Integer isChecked
35649>>>                String lsTheAppPath
35649>>>                Get Checked_State                                   To isChecked
35650>>>                Move (GetTheAppPath(Self))                          To lsTheAppPath
35651>>>                Set_Profile_String lsTheAppPath "Passw_Blanks"          To isChecked
35654>>>            End_Procedure
35655>>>            
35655>>>            
35655>>>            
35655>>>            //AB-StoreEnd
35655>>>
35655>>>        End_Object    // chkBlanks
35656>>>
35656>>>        Object TextBoxSub4 is a TextBoxSub
35658>>>            Set Label to "________________________"
35659>>>            Set Color to 13688273
35660>>>            Set Location to 191 257
35661>>>            Set Size to 10 32
35662>>>            Set Justification_Mode to jMode_Left
35663>>>            Set TypeFace to "MS Sans Serif"
35664>>>        End_Object    // TextBoxSub4
35665>>>
35665>>>        Object TextBoxSub5 is a TextBoxSub
35667>>>            Set Label to "_________________________"
35668>>>            Set Color to 13688273
35669>>>            Set Location to 170 193
35670>>>            Set Size to 10 94
35671>>>            Set Justification_Mode to jMode_Left
35672>>>            Set TypeFace to "MS Sans Serif"
35673>>>        End_Object    // TextBoxSub5
35674>>>
35674>>>        Object TextBoxSub6 is a TextBoxSub
35676>>>            Set Label to "_________________________________"
35677>>>            Set Color to 13688273
35678>>>            Set Location to 159 158
35679>>>            Set Size to 10 129
35680>>>            Set Justification_Mode to jMode_Left
35681>>>            Set TypeFace to "MS Sans Serif"
35682>>>        End_Object    // TextBoxSub6
35683>>>
35683>>>        Object TextBoxSub7 is a TextBoxSub
35685>>>            Set Label to "____________________________"
35686>>>            Set Color to 13688273
35687>>>            Set Location to 148 191
35688>>>            Set Size to 10 97
35689>>>            Set Justification_Mode to jMode_Left
35690>>>            Set TypeFace to "MS Sans Serif"
35691>>>        End_Object    // TextBoxSub7
35692>>>
35692>>>        Object TextBoxSub8 is a TextBoxSub
35694>>>            Set Label to "_______________________________________________"
35695>>>            Set Color to 13688273
35696>>>            Set Location to 138 207
35697>>>            Set Size to 10 82
35698>>>            Set Justification_Mode to jMode_Left
35699>>>            Set TypeFace to "MS Sans Serif"
35700>>>        End_Object    // TextBoxSub8
35701>>>
35701>>>        Object TextBoxSub9 is a TextBoxSub
35703>>>            Set Label to "______________"
35704>>>            Set Color to 13688273
35705>>>            Set Location to 126 249
35706>>>            Set Size to 10 41
35707>>>            Set Justification_Mode to jMode_Center
35708>>>            Set TypeFace to "MS Sans Serif"
35709>>>        End_Object    // TextBoxSub9
35710>>>
35710>>>        Object TextBoxSub10 is a TextBoxSub
35712>>>            Set Label to "(˜˜, LL, 44...)"
35713>>>            Set Color to 13688273
35714>>>            Set Location to 127 293
35715>>>            Set Size to 10 63
35716>>>            Set FontWeight to 600
35717>>>            Set TypeFace to "MS Sans Serif"
35718>>>        End_Object    // TextBoxSub10
35719>>>
35719>>>        Object TextBoxSub11 is a TextBoxSub
35721>>>            Set Label to "(AB...YZ)"
35722>>>            Set Color to 13688273
35723>>>            Set Location to 137 295
35724>>>            Set Size to 10 41
35725>>>            Set FontWeight to 600
35726>>>            Set TypeFace to "MS Sans Serif"
35727>>>        End_Object    // TextBoxSub11
35728>>>
35728>>>        Object TextBoxSub12 is a TextBoxSub
35730>>>            Set Label to "(ab...yz)"
35731>>>            Set Color to 13688273
35732>>>            Set Location to 148 295
35733>>>            Set Size to 10 28
35734>>>            Set FontWeight to 600
35735>>>            Set TypeFace to "MS Sans Serif"
35736>>>        End_Object    // TextBoxSub12
35737>>>
35737>>>        Object TextBoxSub13 is a TextBoxSub
35739>>>            Set Label to "(1234567890)"
35740>>>            Set Color to 13688273
35741>>>            Set Location to 159 293
35742>>>            Set Size to 10 73
35743>>>            Set FontWeight to 600
35744>>>            Set TypeFace to "MS Sans Serif"
35745>>>        End_Object    // TextBoxSub13
35746>>>
35746>>>        Object TextBoxSub14 is a TextBoxSub
35748>>>            Set Label to "(!@#$%^&/*)(_\=+-><|)"
35749>>>            Set Color to 13688273
35750>>>            Set Location to 172 292
35751>>>            Set Size to 10 75
35752>>>            Set FontWeight to 600
35753>>>            Set TypeFace to "MS Sans Serif"
35754>>>        End_Object    // TextBoxSub14
35755>>>
35755>>>        Object TextBoxSub15 is a TextBoxSub
35757>>>            Set Label to "(123...876...efg....MLK)"
35758>>>            Set Color to 13688273
35759>>>            Set Location to 193 293
35760>>>            Set Size to 10 78
35761>>>            Set FontWeight to 600
35762>>>            Set TypeFace to "MS Sans Serif"
35763>>>        End_Object    // TextBoxSub15
35764>>>
35764>>>        Object TextBoxSub16 is a TextBoxSub
35766>>>            Set Label to "‰˜¤æ¤œª ¡˜  œ¨ ¦¨ ©£¦å š ˜ «¦¤ ¡à› ¡æ œ ©æ›¦¬"
35767>>>            Set Color to 13688273
35768>>>            Set Location to 102 7
35769>>>            Set Size to 10 173
35770>>>            Set FontWeight to 600
35771>>>            Set TypeFace to "MS Sans Serif"
35772>>>        End_Object    // TextBoxSub16
35773>>>
35773>>>        Object txt1 is a TextBoxSub
35775>>>            Set Label to "Œ˜ â®œ  £ã¡¦ª ˜§¦ 8 ¡˜  §á¤à ®˜¨˜¡«ã¨œª"
35776>>>            Set Color to 13688273
35777>>>            Set Location to 114 21
35778>>>            Set Size to 10 179
35779>>>            Set TypeFace to "MS Sans Serif"
35780>>>        End_Object    // txt1
35781>>>
35781>>>        Object txt2 is a TextBoxSub
35783>>>            Set Label to "Œ˜ £ž¤ œ§˜¤˜¢˜£™á¤œ«˜  â¤˜ª ®˜¨˜¡«ã¨˜ª 2 ©¬¤œ®æ£œ¤œª ­¦¨âª"
35784>>>            Set Color to 13688273
35785>>>            Set Location to 127 21
35786>>>            Set Size to 10 225
35787>>>            Set TypeFace to "MS Sans Serif"
35788>>>        End_Object    // txt2
35789>>>
35789>>>        Object txt3 is a TextBoxSub
35791>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª ¡œ­˜¢˜å¦ª ®˜¨˜¡«ã¨˜ª"
35792>>>            Set Color to 13688273
35793>>>            Set Location to 138 21
35794>>>            Set Size to 10 184
35795>>>            Set TypeFace to "MS Sans Serif"
35796>>>        End_Object    // txt3
35797>>>
35797>>>        Object txt4 is a TextBoxSub
35799>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª §œæª ®˜¨˜¡«ã¨˜ª"
35800>>>            Set Color to 13688273
35801>>>            Set Location to 148 21
35802>>>            Set Size to 10 173
35803>>>            Set TypeFace to "MS Sans Serif"
35804>>>        End_Object    // txt4
35805>>>
35805>>>        Object txt5 is a TextBoxSub
35807>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª ˜¨ Ÿ£æª"
35808>>>            Set Color to 13688273
35809>>>            Set Location to 161 21
35810>>>            Set Size to 10 139
35811>>>            Set TypeFace to "MS Sans Serif"
35812>>>        End_Object    // txt5
35813>>>
35813>>>        Object txt6 is a TextBoxSub
35815>>>            Set Label to "Œ˜ ¬§á¨®œ  «¦¬¢á® ©«¦¤ â¤˜ª œ › ¡æª ®˜¨˜¡«ã¨˜ª"
35816>>>            Set Color to 13688273
35817>>>            Set Location to 172 21
35818>>>            Set Size to 10 176
35819>>>            Set TypeFace to "MS Sans Serif"
35820>>>        End_Object    // txt6
35821>>>
35821>>>        Object txt7 is a TextBoxSub
35823>>>
35823>>>            //AB-StoreTopStart
35823>>>                                            
35823>>>            //AB-StoreTopEnd
35823>>>
35823>>>            Set Label to "Œ˜ £ž¤ ®¨ž© £¦§¦ ¦ç¤«˜  „¢¢ž¤ ¡¦å ®˜¨˜¡«ã¨œª"
35824>>>            Set Color to 13688273
35825>>>            Set Location to 182 21
35826>>>            Set Size to 10 171
35827>>>            Set TypeFace to "MS Sans Serif"
35828>>>
35828>>>            //AB-StoreStart
35828>>>                                            
35828>>>                                            
35828>>>            //AB-StoreEnd
35828>>>
35828>>>        End_Object    // txt7
35829>>>
35829>>>        Object txt8 is a TextBoxSub
35831>>>            Set Label to "Œ˜ £ž¤ œ§ «â§¦¤«˜  §á¤à ˜§¦ 2 ©¬¤œ®æ£œ¤¦¬ª ©œ ©œ ¨á ®˜¨˜¡«ã¨œª"
35832>>>            Set Color to 13688273
35833>>>            Set Location to 193 21
35834>>>            Set Size to 10 238
35835>>>            Set TypeFace to "MS Sans Serif"
35836>>>        End_Object    // txt8
35837>>>
35837>>>        Object txt9 is a TextBoxSub
35839>>>            Set Label to "Œ˜ £ž¤ œ§ «¨â§¦¤«˜  ¡œ¤á"
35840>>>            Set Color to 13688273
35841>>>            Set Location to 204 21
35842>>>            Set Size to 10 93
35843>>>            Set TypeFace to "MS Sans Serif"
35844>>>        End_Object    // txt9
35845>>>
35845>>>        Object ButtonSub1 is a ButtonSub
35847>>>
35847>>>            //AB-StoreTopStart
35847>>>                                            
35847>>>            //AB-StoreTopEnd
35847>>>
35847>>>            Set Label to "Show Passwords"
35848>>>            Set Size to 14 72
35849>>>            Set Location to 212 218
35850>>>            Set Focus_Mode to Pointer_Only
35851>>>            Set Form_FontWeight Item 0 to 600
35852>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
35853>>>
35853>>>            //AB-StoreStart
35853>>>                                            
35853>>>            Set Enabled_State to False
35854>>>            Set Visible_State to False
35855>>>            
35855>>>            // To-Do Mallon den paizei dynamika to password state
35855>>>            // opote den mporeis na emfanizeis dynamika ta asterakia
35855>>>            Procedure OnClick00
35857>>>                Integer iState
35858>>>                String sLabel
35858>>>                Get Password_State Of NewPassForm to iState
35859>>>                Set piPasswordState to (1-iState)
35860>>>                If (piPasswordState(Self)=1) Set Label to "Show Passwords"
35863>>>                Else                         Set Label to "Hide Passwords"
35865>>>                Set Password_State Of NewPassForm       to (piPasswordState(Self)=1)
35866>>>                Set Password_State Of NewPassForm2      to (piPasswordState(Self)=1)
35867>>>                Set Password_State Of ConfirmPassForm   to (piPasswordState(Self)=1)
35868>>>            End_Procedure // OnClick
35869>>>            
35869>>>            
35869>>>            
35869>>>            //AB-StoreEnd
35869>>>
35869>>>        End_Object    // ButtonSub1
35870>>>
35870>>>
35870>>>        //AB-StoreStart
35870>>>        
35870>>>        Function ConfirmNewCustomPass Returns Integer
35872>>>            Local Integer   bPasswordGood i1 i2 i3 i4 i5 i6 i7 i8 i9 iDays iTries success iMax
35873>>>            Local String    sNewPassword sNewPassword2 sConfirmPassword sOldPassword sPassw lsTheAppPath
35873>>>            Local String    sNewPasswordC sNewPassword2C sConfirmPasswordC sPasswC sLogin
35873>>>        
35873>>>            Date    dHmnia
35873>>>            String  sHH sMM sSS sTime
35873>>>            Sysdate dHmnia sHH sMM sSS
35877>>>            Move (Trim(sHH)) to sHH
35878>>>            Move (Trim(sMM)) to sMM
35879>>>            Move (Trim(sSS)) to sSS
35880>>>            If (Length(sHH)=1) Insert '0' in sHH at 1
35884>>>            If (Length(sMM)=1) Insert '0' in sMM at 1
35888>>>            If (Length(sSS)=1) Insert '0' in sSS at 1
35892>>>            Move (sHH+":"+sMM+"."+sSS) to sTime
35893>>>        
35893>>>        
35893>>>            Move "" to sConfirmPassword
35894>>>            Move "" to sNewPassword
35895>>>            Move "" to sNewPassword2
35896>>>            Move "" to sConfirmPasswordC
35897>>>            Move "" to sNewPasswordC
35898>>>            Move "" to sNewPassword2C
35899>>>            Move "" to sPasswC
35900>>>        
35900>>>        
35900>>>            Set value of (NewPassForm    (Current_Object)) item 0 to ""
35901>>>            Set value of (NewPassForm2   (Current_Object)) item 0 to ""
35902>>>            Set value of (ConfirmPassForm(Current_Object)) item 0 to ""
35903>>>        
35903>>>            Set piPasswordState to 1
35904>>>        
35904>>>            Set Password_State Of NewPassForm       to (piPasswordState(Self)=1)
35905>>>            Set Password_State Of NewPassForm2      to (piPasswordState(Self)=1)
35906>>>            Set Password_State Of ConfirmPassForm   to (piPasswordState(Self)=1)
35907>>>        
35907>>>            Open Sysrec
35909>>>            Open Users
35911>>>        
35911>>>            Move (fsLoginUserID())  to sLogin
35912>>>            Clear Users
35913>>>            Move sLogin    to Users.Login_ID
35914>>>            Find eq Users by Index.1
35915>>>>
35915>>>        
35915>>>            If (iCountRemain>0) Set Label of oNewPassDlg to ("‚œ ˜ ©¦¬ "+Trim(Users.NAME)+" - €¢¢˜šã ‰à› ¡¦ç ¨æ©™˜©žª, ˜§¦£â¤¦¬¤ "+String(iCountRemain)+" §¨¦©§áŸœ œª")
35918>>>            Else                Set Label of oNewPassDlg to ("‚œ ˜ ©¦¬ "+Trim(Users.NAME)+" - €¢¢˜šã ‰à› ¡¦ç ¨æ©™˜©žª")
35920>>>        
35920>>>            Reread Sysrec
35924>>>            Unlock
35925>>>>
35925>>>        
35925>>>            Set Locate_Mode to CENTER_ON_SCREEN
35926>>>        
35926>>>            Move Sysrec.LIBCAST_CODE    to i1
35927>>>            Move Sysrec.AWARD_CODE      to i2
35928>>>            Move Sysrec.GIVAWRD_CODE    to i3
35929>>>            Move Sysrec.MOVIE_LNK_CODE  to i4
35930>>>            Move Sysrec.CAST_LNK_CODE   to i5
35931>>>            Move Sysrec.AWARDTP_CODE    to i6
35932>>>            Move Sysrec.FESTIVAL_CODE   to i7 // No Greek characters Hard Coded to 1
35933>>>            Move Sysrec.STWHAT_CODE     to i8
35934>>>            Move Sysrec.SNWHAT_CODE     to i9
35935>>>            Move Sysrec.LIBVIS_CODE     to iDays
35936>>>            Move Sysrec.TIKANEI_CODE    to iMax
35937>>>        
35937>>>            Set Checked_State Of (chkLengthOverEight(Self))         To i1
35938>>>            Set Checked_State Of (chk3Consecutive(Self))            To i2
35939>>>            Set Checked_State Of (chkAtLeast1Upper(Self))           To i3
35940>>>            Set Checked_State Of (chkAtLeast1Lower(Self))           To i4
35941>>>            Set Checked_State Of (chkAtLeast1Number(Self))          To i5
35942>>>            Set Checked_State Of (chkAtLeast1Special(Self))         To i6
35943>>>            Set Checked_State Of (ChkNoGreek(Self))                 To i7
35944>>>            Set Checked_State Of (chkSeiriakous(Self))              To i8
35945>>>            Set Checked_State Of (chkBlanks(Self))                  To i9
35946>>>        //    Set Value Of frmChangePasswordEveryDays Item 0          to iDays
35946>>>        //    Set Value Of frmAttempts                Item 0          to iMax
35946>>>        
35946>>>            Send Popup_Modal
35947>>>        
35947>>>            Open Sysrec
35949>>>            Open Users
35951>>>        
35951>>>            Get value of (ConfirmPassForm(Current_Object)) item 0 to sConfirmPassword
35952>>>            Get value of (NewPassForm    (Current_Object)) item 0 to sNewPassword
35953>>>            Get value of (NewPassForm2   (Current_Object)) item 0 to sNewPassword2
35954>>>        
35954>>>            Move (Trim(sConfirmPassword))   to sConfirmPassword
35955>>>            Move (Trim(sNewPassword))       to sNewPassword
35956>>>            Move (Trim(sNewPassword2))      to sNewPassword2
35957>>>        
35957>>>            If (sConfirmPassword<>"") Move (fsCryptoNew(Self,"Encrypt",sConfirmPassword)) to sConfirmPasswordC
35960>>>            If (sNewPassword    <>"") Move (fsCryptoNew(Self,"Encrypt",sNewPassword ))    to sNewPasswordC
35963>>>            If (sNewPassword2   <>"") Move (fsCryptoNew(Self,"Encrypt",sNewPassword2))    to sNewPassword2C
35966>>>        
35966>>>            If (piState(Self)<>Canceled) Begin
35968>>>        
35968>>>                Move (fsLoginUserID())  to sLogin
35969>>>                Clear Users
35970>>>                Move sLogin    to Users.Login_ID
35971>>>                Find eq Users by Index.1
35972>>>>
35972>>>                If (Found) Begin
35974>>>        
35974>>>                    If (Trim(Users.PASSWORD)<>"") Move Users.PASSWORD to sPasswC
35977>>>        
35977>>>                    // --------------------------------------------------
35977>>>                    // Verify if not used in the last 5 passwords history
35977>>>                    Integer iRecs isAlreadyUsed
35977>>>                    Move 0 to iRecs
35978>>>                    Move 0 to isAlreadyUsed
35979>>>        
35979>>>                    Clear UsersH
35980>>>                    Move Users.Login_ID to UsersH.Login_ID
35981>>>                    Find GE UsersH By Index.1
35982>>>>
35982>>>                    While ((Found) And (Users.Login_ID=UsersH.Login_ID) And (isAlreadyUsed=0))
35986>>>                        Add 1 to iRecs
35987>>>                        If ((Trim(UsersH.New_Password)=sNewPasswordC) And (UsersH.Changed_Date<dHmnia)) Move 1 to isAlreadyUsed
35990>>>                        Find GT UsersH By Index.1
35991>>>>
35991>>>                    Loop
35992>>>>
35992>>>        
35992>>>                    If (isAlreadyUsed) Begin
35994>>>                        Set piState to Already_Used // 7
35995>>>                        Function_Return (piState(Self))
35996>>>                    End
35996>>>>
35996>>>        
35996>>>                    If ((Trim(Users.Password)<>"") And (Trim(Users.Password)<>sConfirmPasswordC)) Begin
35998>>>                        Set piState to Wrong_Prev_Passw // 6
35999>>>                    End
35999>>>>
35999>>>                    Else If (sNewPasswordC<>sNewPassword2C)  Begin
36002>>>                        Set piState to Not_Match // 4
36003>>>                    End
36003>>>>
36003>>>                    Else Begin
36004>>>                        If (Trim(sNewPasswordC)="") Begin
36006>>>                            Set piState to No_Password // 5
36007>>>                        End
36007>>>>
36007>>>                        Else If (sPasswC=sNewPasswordC) Begin
36010>>>                            Set piState to Same_Password // 2
36011>>>                        End
36011>>>>
36011>>>                        Else Begin
36012>>>        
36012>>>                            Integer isCheckedOK
36012>>>                            Move (fsVerifyThePasswordValidity(Self,sNewPassword)) to isCheckedOK
36013>>>                            If (isCheckedOK=0) Begin
36015>>>        
36015>>>                                Set piState to All_Ok // 0
36016>>>        
36016>>>                                Reread Users
36020>>>                                If (Trim(Users.Password)<>"")   Move Users.Password to Users.Last_Password
36023>>>                                Else                            Move sNewPasswordC  to Users.Last_Password
36025>>>                                Move sNewPasswordC                                  to Users.PASSWORD
36026>>>                                Move  dHmnia                                        to Users.Last_Change
36027>>>                                Move (dHmnia+iDays)                                 to Users.Next_Change
36028>>>                                Move  dHmnia                                        to Users.Last_Login_Date
36029>>>                                Move (Trim(sTime))                                  to Users.Last_Login_Time
36030>>>                                SaveRecord Users
36031>>>                                Unlock
36032>>>>
36032>>>        
36032>>>        
36032>>>                                Move 0 to iRecs
36033>>>                                Clear UsersH
36034>>>                                Move Users.Login_ID to UsersH.Login_ID
36035>>>                                Find GE UsersH By Index.1
36036>>>>
36036>>>                                While ((Found) And (Users.Login_ID=UsersH.Login_ID))
36040>>>                                    Add 1 to iRecs
36041>>>                                    If (UsersH.Is_Last=1) Begin
36043>>>                                        Reread UsersH
36047>>>                                        Move 0 to UsersH.Is_Last
36048>>>                                        Saverecord UsersH
36049>>>                                        Unlock
36050>>>>
36050>>>                                    End
36050>>>>
36050>>>                                    Find GT UsersH By Index.1
36051>>>>
36051>>>                                Loop
36052>>>>
36052>>>        
36052>>>                                If (iRecs<5) Begin
36054>>>                                        Clear UsersH
36055>>>                                        Move Users.Login_ID     to UsersH.Login_ID
36056>>>                                        Move dHmnia             to UsersH.Changed_Date
36057>>>                                        Find Eq UsersH By Index.1
36058>>>>
36058>>>                                        If (Found) Reread UsersH
36064>>>                                        Move sNewPasswordC      to UsersH.New_Password
36065>>>                                        Move 1                  to UsersH.Is_Last
36066>>>                                        Saverecord UsersH
36067>>>                                        If (Found) Unlock
36070>>>                                End
36070>>>>
36070>>>                                Else Begin
36071>>>                                    Integer   iX
36071>>>                                    Move 0 to iX
36072>>>                                    Move 0 to iRecs
36073>>>        
36073>>>                                    Clear UsersH
36074>>>                                    Move Users.Login_ID     to UsersH.Login_ID
36075>>>                                    Move dHmnia             to UsersH.Changed_Date
36076>>>                                    Find Eq UsersH By Index.1
36077>>>>
36077>>>                                    If (Found) Begin
36079>>>                                        Reread UsersH
36083>>>                                        Move sNewPasswordC  to UsersH.New_Password
36084>>>                                        Move 1              to UsersH.Is_Last
36085>>>                                        Saverecord UsersH
36086>>>                                        Unlock
36087>>>>
36087>>>                                    End
36087>>>>
36087>>>                                    Else Begin
36088>>>                                        Clear UsersH
36089>>>                                        Move Users.Login_ID to UsersH.Login_ID
36090>>>                                        Move ""             to UsersH.Changed_Date
36091>>>                                        Find GE UsersH By Index.1
36092>>>>
36092>>>                                        If ((Found) And (Users.Login_ID=UsersH.Login_ID) And (UsersH.Changed_Date<dHmnia)) Begin
36094>>>                                            Reread UsersH
36098>>>                                            Move dHmnia             to UsersH.Changed_Date
36099>>>                                            Move sNewPasswordC      to UsersH.New_Password
36100>>>                                            Move 1                  to UsersH.Is_Last
36101>>>                                            Saverecord UsersH
36102>>>                                            Unlock
36103>>>>
36103>>>                                        End
36103>>>>
36103>>>                                    End
36103>>>>
36103>>>                                End
36103>>>>
36103>>>                            End
36103>>>>
36103>>>                            Else Set piState to Canceled
36105>>>                        End
36105>>>>
36105>>>                    End
36105>>>>
36105>>>                End
36105>>>>
36105>>>                Else Set piState to Canceled
36107>>>            End
36107>>>>
36107>>>            // If Cancelled piState = 1
36107>>>            Function_Return (piState(Self))
36108>>>        End_Function
36109>>>        
36109>>>        On_Key Key_Alt+Key_O Send KeyAction To (oOk_bn(current_object))
36110>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36111>>>        
36111>>>        
36111>>>        
36111>>>        
36111>>>        
36111>>>        
36111>>>        
36111>>>        
36111>>>        
36111>>>        //AB-StoreEnd
36111>>>
36111>>>    End_Object    // oNewPassDlg
36112>>>
36112>>>
36112>>>    //AB-StoreStart
36112>>>            
36112>>>            
36112>>>            
36112>>>            
36112>>>            
36112>>>            
36112>>>    //AB-StoreEnd
36112>>>
36112>>>//AB/     End_Object    // prj
36112>
36112>Procedure ChangeMyPassword
36113>    Integer iResult
36114>    Get ConfirmNewCustomPass of oNewPassDlg to iResult
36115>         If (iResult=0) Send Info_Box "Ž ¡à› ¡æª ©˜ª «¨¦§¦§¦ ãŸž¡œ œ§ «¬®éª"    "¢ž¨¦­¦¨å˜"
36118>    Else If (iResult=1) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "€¡¬¨éŸž¡œ ˜§¦ «¦¤ ®¨ã©«ž"
36122>    Else If (iResult=2) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "Ž ¤â¦ª ¡à› ¡æª œå¤˜  å› ¦ª £œ «¦¤ §˜¢ æ"
36126>    Else If (iResult=3) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "Ž ¡à› ¡æª œ ©æ›¦¬ œå˜¤  ¢áŸ¦ª"
36130>    Else If (iResult=4) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "Ž ¡à› ¡æª œ§ ™œ™˜åà©žª › ˜­â¨œ  ˜§¦ «¦¤ ¡à› ¡æ œ ©æ›¦¬"
36134>    Else If (iResult=5) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "Ž ¡à› ¡æª œå¤˜  ¡œ¤æª"
36138>    Else If (iResult=6) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "Ž §˜¢ æª ¡à› ¡æª œå˜¤  ¢áŸ¦ª"
36142>    Else If (iResult=7) Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "Ž ¡à› ¡æª â®œ  ã›ž ¥˜¤˜®¨ž© £¦§¦ žŸœå £œ«˜¥ç «à¤ 5 «œ¢œ¬«˜åà¤ ˜¢¢˜šé¤"
36146>    Else                Send Info_Box "Ž ¡à› ¡æª ©˜ª ƒ„Œ âš ¤œ ›œ¡«æª"         "êš¤à©«¦ ‘­á¢£˜"
36148>    Move iResult to iApotel
36149>End_Procedure
36150>
36150>
36150>Move 0 to iMetrhthsProsp
36151>
36151>//=======================
36151>Start_Entry_Validation:
36151>//-----------------------
36151>Move 0 to iMustResetPass
36152>Move 0 to iAnenergos
36153>Move (iMax00-iMetrhthsProsp+1)  to iCountRemain
36154>If (iMetrhthsProsp>iMax00)      Send Exit_Application
36157>Send Login
36158>If (iHasAPassword=0) Send ChangeMyPassword
36161>If (iAnenergos   =1) Goto Start_Entry_Validation
36164>If (iApotel      >0) Goto Start_Entry_Validation
36167>
36167>Move 0 to iApotel
36168>Move 0 to iMetrhthsProsp
36169>Move 0 to iAnenergos
36170>Move 0 to iMustResetPass
36171>//=======================
36171>
36171>Use Xrhsh.pkg
INCLUDING FILE: XRHSH.PKG
36171>>>//------------------------------
36171>>>Use SelectXr.Dg
INCLUDING FILE: SELECTXR.DG
36171>>>>>//AB/ Project Select / Change Xrhsh
36171>>>>>//AB/ Object prj is a Dialog_Project
36171>>>>>//AB/     Set ProjectName to "Select / Change Xrhsh"
36171>>>>>//AB/     Set ProjectFileName to "SelectXR.DG"
36171>>>>>
36171>>>>>// Project Object Structure
36171>>>>>//   oSelectYear is a dbModalPanelSub
36171>>>>>//     Company_DD is a DataDictionary
36171>>>>>//     Branch_DD is a DataDictionary
36171>>>>>//     Year_DD is a DataDictionary
36171>>>>>//     Company_Company_Code is a dbFormSub
36171>>>>>//     Company_Company_Name is a dbFormSub
36171>>>>>//     Branch_Branch_Code is a dbFormSub
36171>>>>>//     Branch_Branch_Name is a dbFormSub
36171>>>>>//     Year_Year_Year is a dbFormSub
36171>>>>>//     Year_Year_Descr is a dbFormSub
36171>>>>>//     Year_Year_Entrydate is a dbFormSub
36171>>>>>//     oOk_bn is a ButtonSub
36171>>>>>//     oCancel_bn is a ButtonSub
36171>>>>>//     otxtCompany is a TextBoxSub
36171>>>>>//     otxtBranch is a TextBoxSub
36171>>>>>//     otxtYear is a TextBoxSub
36171>>>>>//     otxtWorkingDay is a TextBoxSub
36171>>>>>//     otxtWorkingDay is a TextBoxSub
36171>>>>>//     chkxr is a CheckBoxSub
36171>>>>>
36171>>>>>// Register all objects
36171>>>>>Register_Object Branch_Branch_Code
36171>>>>>Register_Object Branch_Branch_Name
36171>>>>>Register_Object Branch_DD
36171>>>>>Register_Object Company_Company_Code
36171>>>>>Register_Object Company_Company_Name
36171>>>>>Register_Object Company_DD
36171>>>>>Register_Object chkxr
36171>>>>>Register_Object oCancel_bn
36171>>>>>Register_Object oOk_bn
36171>>>>>Register_Object oSelectYear
36171>>>>>Register_Object otxtBranch
36171>>>>>Register_Object otxtCompany
36171>>>>>Register_Object otxtWorkingDay
36171>>>>>Register_Object otxtYear
36171>>>>>Register_Object Year_DD
36171>>>>>Register_Object Year_Year_Descr
36171>>>>>Register_Object Year_Year_Entrydate
36171>>>>>Register_Object Year_Year_Year
36171>>>>>
36171>>>>>
36171>>>>>
36171>>>>>//AB-StoreTopStart
36171>>>>>
36171>>>>>
36171>>>>>
36171>>>>>
36171>>>>>       String  gs_selected_beto_site
36171>>>>>
36171>>>>>Open SysCurXR
36173>>>>>Open Nomisma
36175>>>>>
36175>>>>>//AB-StoreTopEnd
36175>>>>>
36175>>>>>//AB-IgnoreStart
36175>>>>>
36175>>>>>Use DFAllEnt.pkg
36175>>>>>Use dbForm.Sub
36175>>>>>Use Button.Sub
36175>>>>>Use Txtbox.Sub
36175>>>>>Use Chkbox.Sub
36175>>>>>
36175>>>>>
36175>>>>>Use COMPANY.DD
INCLUDING FILE: COMPANY.DD
36175>>>>>>>//DDB-FileStart
36175>>>>>>>//DDB-HeaderStart
36175>>>>>>>
36175>>>>>>>// File Name : COMPANY.DD
36175>>>>>>>// Class Name: Company_DataDictionary
36175>>>>>>>// Revision  : 64
36175>>>>>>>// Version   : 2
36175>>>>>>>
36175>>>>>>>Use  Windows           // Basic Definitions
36175>>>>>>>Use  DataDict          // DataDictionary Class Definition
36175>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36175>>>>>>>
36175>>>>>>>Open Company
36177>>>>>>>Open Branch
36179>>>>>>>
36179>>>>>>>//DDB-HeaderEnd
36179>>>>>>>//DDB-ValidationStart
36179>>>>>>>
36179>>>>>>>Register_Object Company_Company_Doy_VT
36179>>>>>>>Register_Object Company_Company_J_Code_VT
36179>>>>>>>
36179>>>>>>>Object Company_Company_Doy_VT  is a CodeValidationTable
36181>>>>>>>    Set Type_Value        To "DOY"
36182>>>>>>>    Set Allow_Blank_State To TRUE
36183>>>>>>>    //DDB-ValidationCustomStart
36183>>>>>>>    //DDB-ValidationCustomEnd
36183>>>>>>>End_Object   // Company_Company_Doy_VT
36184>>>>>>>
36184>>>>>>>Object Company_Company_J_Code_VT  is a CodeValidationTable
36186>>>>>>>    Set Type_Value        To "JOB"
36187>>>>>>>    Set Allow_Blank_State To TRUE
36188>>>>>>>    //DDB-ValidationCustomStart
36188>>>>>>>    //DDB-ValidationCustomEnd
36188>>>>>>>End_Object   // Company_Company_J_Code_VT
36189>>>>>>>//DDB-ValidationEnd
36189>>>>>>>//DDB-SelectionStart
36189>>>>>>>//DDB/ ExternalSelectionList sl001  sl001.sl
36189>>>>>>>Register_Object sl001
36189>>>>>>>//DDB-SelectionEnd
36189>>>>>>> 
36189>>>>>>>Class Company_DataDictionary  is a DataDictionary
36190>>>>>>> 
36190>>>>>>>    // Update:
36190>>>>>>> 
36190>>>>>>>    Procedure Update
36191>>>>>>>        Forward Send Update
36193>>>>>>>        move 'DOY' to company.doy_type
36194>>>>>>>        move 'JOB' to company.jcode_type 
36195>>>>>>>        // Insert Code Here
36195>>>>>>>    End_Procedure   // Update
36196>>>>>>> 
36196>>>>>>>
36196>>>>>>>    // Operation_Not_Allowed:
36196>>>>>>>
36196>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
36197>>>>>>>        // Insert Code Here
36197>>>>>>>        Case Begin
36197>>>>>>>             Case (iError_Num = 1001)
36199>>>>>>>                  Error 1001 "DDC 051:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª „«˜ ¨œå˜ª!\n\n‰œ¤æª ‰à› ¡æª"
36200>>>>>>>>
36200>>>>>>>             Case Break
36201>>>>>>>
36201>>>>>>>             Case Else
36201>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
36203>>>>>>>        Case End
36203>>>>>>>    End_Procedure   // Operation_Not_Allowed
36204>>>>>>>
36204>>>>>>>
36204>>>>>>>    // Validate_Save:
36204>>>>>>>
36204>>>>>>>    Function Validate_Save  Returns Integer
36205>>>>>>>        Local Integer iReturnVal
36206>>>>>>>        Forward Get Validate_Save  To iReturnVal
36208>>>>>>>        If (Not(iReturnVal)) Begin
36210>>>>>>>            // Insert Code Here
36210>>>>>>>            If (Company.Company_Code="") Send Operation_Not_Allowed 1001
36213>>>>>>>        End
36213>>>>>>>>
36213>>>>>>>        Function_Return iReturnVal
36214>>>>>>>    End_Function   // Validate_Save
36215>>>>>>>
36215>>>>>>>
36215>>>>>>>    // Define_Fields:
36215>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36215>>>>>>>
36215>>>>>>>    Procedure Define_Fields
36216>>>>>>>        Forward Send Define_Fields
36218>>>>>>>        //DDB-Generated-Code-Location
36218>>>>>>>        //DDB-DefineFieldStart
36218>>>>>>>
36218>>>>>>>        Set Main_File            To Company.File_Number
36219>>>>>>>        Set Cascade_Delete_State To FALSE
36220>>>>>>>
36220>>>>>>>
36220>>>>>>>        // Child (Client) file structure................
36220>>>>>>>        Send Add_Client_File  Branch.File_Number
36221>>>>>>>
36221>>>>>>>        // Field-based properties.......................
36221>>>>>>>
36221>>>>>>>        // Company.Company_Code
36221>>>>>>>        Set Field_Options          Field Company.Company_Code To DD_AUTOFIND   
36222>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Code To (sl001(Self))
36223>>>>>>>
36223>>>>>>>        // Company.Company_Name
36223>>>>>>>        Set Field_Options          Field Company.Company_Name To DD_REQUIRED   
36224>>>>>>>        Set Field_Prompt_Object    Field Company.Company_Name To (sl001(Self))
36225>>>>>>>
36225>>>>>>>        // Company.Company_Afm
36225>>>>>>>        Set Field_Options          Field Company.Company_Afm To DD_AUTOFIND   
36226>>>>>>>
36226>>>>>>>        // Company.Company_Addr
36226>>>>>>>
36226>>>>>>>        // Company.Company_Tk
36226>>>>>>>
36226>>>>>>>        // Company.Company_Poli
36226>>>>>>>
36226>>>>>>>        // Company.Company_Doy
36226>>>>>>>        Set Field_Value_Table      Field Company.Company_Doy To (Company_Company_Doy_VT(Self))
36227>>>>>>>
36227>>>>>>>        // Company.Company_J_Code
36227>>>>>>>        Set Field_Value_Table      Field Company.Company_J_Code To (Company_Company_J_Code_VT(Self))
36228>>>>>>>
36228>>>>>>>        // Company.Company_C_Code0
36228>>>>>>>
36228>>>>>>>        // Company.Company_C_Cod00
36228>>>>>>>
36228>>>>>>>        // Company.Company_C_Coder
36228>>>>>>>
36228>>>>>>>        // Company.Company_Tel
36228>>>>>>>
36228>>>>>>>        // Company.Company_Fax
36228>>>>>>>
36228>>>>>>>        // Company.Company_Email
36228>>>>>>>
36228>>>>>>>        // Company.Company_Resp
36228>>>>>>>
36228>>>>>>>        // Company.Company_Bitmap
36228>>>>>>>
36228>>>>>>>        // Company.Beto_Site
36228>>>>>>>
36228>>>>>>>        // Company.Logo
36228>>>>>>>
36228>>>>>>>        // Company.Doy_Type
36228>>>>>>>
36228>>>>>>>        // Company.Jcode_Type
36228>>>>>>>
36228>>>>>>>        // Company.Sap_Code
36228>>>>>>>
36228>>>>>>>        // Company.Sap_Path
36228>>>>>>>
36228>>>>>>>        //DDB-DefineFieldEnd
36228>>>>>>>    End_Procedure    // Define_Fields
36229>>>>>>>
36229>>>>>>>    // Field_Defaults:
36229>>>>>>>    // This procedure is used to establish default field values.
36229>>>>>>>
36229>>>>>>>    Procedure Field_Defaults
36230>>>>>>>        Forward Send Field_Defaults
36232>>>>>>>        //DDB-Generated-Code-Location
36232>>>>>>>        //DDB-FieldDefaultStart
36232>>>>>>>        //DDB-FieldDefaultEnd
36232>>>>>>>    End_Procedure    // Field_Defaults
36233>>>>>>>End_Class    // Company_DataDictionary
36234>>>>>>>
36234>>>>>>>//DDB-Selection-pkg-Start
36234>>>>>>>
36234>>>>>>>Use sl001.sl         // sl001
INCLUDING FILE: SL001.SL
36234>>>>>>>>>//AB/ Project sl001 : Etairies
36234>>>>>>>>>//AB/     Object prj is a Lookup_Project
36234>>>>>>>>>//AB/         Set ProjectName to "sl001 : Etairies"
36234>>>>>>>>>//AB/         Set ProjectFileName to "sl001.SL"
36234>>>>>>>>>//AB/         Set GenerateFileName to "NONAME"
36234>>>>>>>>>
36234>>>>>>>>>// Project Object Structure
36234>>>>>>>>>//   sl001 is a dbModalPanel
36234>>>>>>>>>//     Company_DD is a DataDictionary
36234>>>>>>>>>//     oSelList is a dbList
36234>>>>>>>>>//     oOK_bn is a ButtonSub
36234>>>>>>>>>//     oCancel_bn is a ButtonSub
36234>>>>>>>>>//     oSearch_bn is a ButtonSub
36234>>>>>>>>>
36234>>>>>>>>>// Register all objects
36234>>>>>>>>>Register_Object Company_DD
36234>>>>>>>>>Register_Object oCancel_bn
36234>>>>>>>>>Register_Object oOK_bn
36234>>>>>>>>>Register_Object oSearch_bn
36234>>>>>>>>>Register_Object oSelList
36234>>>>>>>>>Register_Object sl001
36234>>>>>>>>>
36234>>>>>>>>>
36234>>>>>>>>>    //AB-IgnoreStart
36234>>>>>>>>>
36234>>>>>>>>>    Use DFAllEnt.pkg
36234>>>>>>>>>    Use Button.Sub
36234>>>>>>>>>
36234>>>>>>>>>
36234>>>>>>>>>    Use COMPANY.DD
36234>>>>>>>>>    
36234>>>>>>>>>    //AB-IgnoreEnd
36234>>>>>>>>>
36234>>>>>>>>>    CD_Popup_Object sl001 is a dbModalPanel
36253>>>>>>>>>        Set Label to "„«˜ ¨åœª"
36254>>>>>>>>>        Set Size to 148 297
36255>>>>>>>>>        Set Location to 12 27
36256>>>>>>>>>
36256>>>>>>>>>        //AB-DDOStart
36256>>>>>>>>>
36256>>>>>>>>>        Object Company_DD is a Company_DataDictionary
36258>>>>>>>>>        End_Object    // Company_DD
36259>>>>>>>>>
36259>>>>>>>>>        Set Main_DD to (Company_DD(self))
36260>>>>>>>>>        Set Server to (Company_DD(self))
36261>>>>>>>>>
36261>>>>>>>>>        //AB-DDOEnd
36261>>>>>>>>>
36261>>>>>>>>>        Object oSelList is a dbList
36263>>>>>>>>>            Set Main_File to Company.File_Number
36264>>>>>>>>>            Set Size to 105 280
36265>>>>>>>>>            Set Location to 6 6
36266>>>>>>>>>
36266>>>>>>>>>            Begin_Row
36269>>>>>>>>>                Entry_Item Company.Company_code
36270>>>>>>>>>                Entry_Item Company.Company_name
36271>>>>>>>>>                Entry_Item Company.Company_afm
36272>>>>>>>>>            End_Row
36277>>>>>>>>>
36277>>>>>>>>>            Set Form_Width    item 0 to 42
36278>>>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
36279>>>>>>>>>            
36279>>>>>>>>>            Set Form_Width    item 1 to 150
36280>>>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
36281>>>>>>>>>            
36281>>>>>>>>>            Set Form_Width    item 2 to 80
36282>>>>>>>>>            Set Header_Label  item 2 to "€.”.‹"
36283>>>>>>>>>            
36283>>>>>>>>>        End_Object    // oSelList
36284>>>>>>>>>
36284>>>>>>>>>        Object oOK_bn is a ButtonSub
36286>>>>>>>>>            Set Label to "&„§ ¢¦šã"
36287>>>>>>>>>            Set Location to 115 126
36288>>>>>>>>>
36288>>>>>>>>>            //AB-StoreStart
36288>>>>>>>>>            Procedure OnClick
36290>>>>>>>>>                Send OK To (oSelList(current_object))
36291>>>>>>>>>            End_Procedure
36292>>>>>>>>>            //AB-StoreEnd
36292>>>>>>>>>
36292>>>>>>>>>        End_Object    // oOK_bn
36293>>>>>>>>>
36293>>>>>>>>>        Object oCancel_bn is a ButtonSub
36295>>>>>>>>>            Set Label to "&€¡ç¨à©ž"
36296>>>>>>>>>            Set Location to 115 181
36297>>>>>>>>>
36297>>>>>>>>>            //AB-StoreStart
36297>>>>>>>>>            Procedure OnClick
36299>>>>>>>>>                Send Cancel To (oSelList(current_object))
36300>>>>>>>>>            End_Procedure
36301>>>>>>>>>            //AB-StoreEnd
36301>>>>>>>>>
36301>>>>>>>>>        End_Object    // oCancel_bn
36302>>>>>>>>>
36302>>>>>>>>>        Object oSearch_bn is a ButtonSub
36304>>>>>>>>>            Set Label to "€&¤˜ã«ž©ž"
36305>>>>>>>>>            Set Location to 115 236
36306>>>>>>>>>
36306>>>>>>>>>            //AB-StoreStart
36306>>>>>>>>>            Procedure OnClick
36308>>>>>>>>>                Send Search To (oSelList(current_object))
36309>>>>>>>>>            End_Procedure
36310>>>>>>>>>            //AB-StoreEnd
36310>>>>>>>>>
36310>>>>>>>>>        End_Object    // oSearch_bn
36311>>>>>>>>>
36311>>>>>>>>>
36311>>>>>>>>>        //AB-StoreStart
36311>>>>>>>>>        On_Key Key_Alt+Key_O Send KeyAction To oOk_bn
36312>>>>>>>>>        On_Key Key_Alt+Key_C Send KeyAction To oCancel_bn
36313>>>>>>>>>        On_Key Key_Alt+Key_S Send KeyAction To oSearch_bn
36314>>>>>>>>>        //AB-StoreEnd
36314>>>>>>>>>
36314>>>>>>>>>    CD_End_Object    // sl001
36316>>>>>>>>>>
36316>>>>>>>>>
36316>>>>>>>>>//AB/     End_Object    // prj
36316>>>>>>>
36316>>>>>>>//DDB-Selection-pkg-End
36316>>>>>>>//DDB-FileEnd
36316>>>>>Use BRANCH.DD
INCLUDING FILE: BRANCH.DD
36316>>>>>>>//DDB-FileStart
36316>>>>>>>//DDB-HeaderStart
36316>>>>>>>
36316>>>>>>>// File Name : BRANCH.DD
36316>>>>>>>// Class Name: Branch_DataDictionary
36316>>>>>>>// Revision  : 96
36316>>>>>>>// Version   : 2
36316>>>>>>>
36316>>>>>>>Use  Windows           // Basic Definitions
36316>>>>>>>Use  DataDict          // DataDictionary Class Definition
36316>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36316>>>>>>>
36316>>>>>>>Open Branch
36318>>>>>>>Open Year
36320>>>>>>>Open Brzones
INCLUDING FILE: BRZONES.FD
36322>>>>>>>Open Tpbranch
INCLUDING FILE: TPBRANCH.FD
36324>>>>>>>Open Company
36326>>>>>>>Open Sysrecg
INCLUDING FILE: SYSRECG.FD
36328>>>>>>>
36328>>>>>>>//DDB-HeaderEnd
36328>>>>>>>//DDB-ValidationStart
36328>>>>>>>
36328>>>>>>>Register_Object Branch_Branch_Doy_VT
36328>>>>>>>Register_Object Branch_Branch_C_Code0_VT
36328>>>>>>>
36328>>>>>>>Object Branch_Branch_Doy_VT  is a CodeValidationTable
36330>>>>>>>    Set Type_Value        To "DOY"
36331>>>>>>>    Set Validate_State    To FALSE
36332>>>>>>>    Set Allow_Blank_State To TRUE
36333>>>>>>>    //DDB-ValidationCustomStart
36333>>>>>>>    //DDB-ValidationCustomEnd
36333>>>>>>>End_Object   // Branch_Branch_Doy_VT
36334>>>>>>>
36334>>>>>>>Object Branch_Branch_C_Code0_VT  is a CodeValidationTable
36336>>>>>>>    Set Type_Value        To ""
36337>>>>>>>    Set Allow_Blank_State To TRUE
36338>>>>>>>    //DDB-ValidationCustomStart
36338>>>>>>>    //DDB-ValidationCustomEnd
36338>>>>>>>End_Object   // Branch_Branch_C_Code0_VT
36339>>>>>>>//DDB-ValidationEnd
36339>>>>>>>//DDB-SelectionStart
36339>>>>>>>//DDB/ ExternalSelectionList SL002  Sl002.sl
36339>>>>>>>Register_Object SL002
36339>>>>>>>//DDB-SelectionEnd
36339>>>>>>>
36339>>>>>>>Class Branch_DataDictionary  is a DataDictionary
36340>>>>>>> 
36340>>>>>>>    Procedure Save_Main_File
36341>>>>>>>        Forward Send Save_Main_File
36343>>>>>>>        // Insert Code Here
36343>>>>>>>    End_Procedure   // Save_Main_File
36344>>>>>>> 
36344>>>>>>>    Procedure Creating
36345>>>>>>>        Forward Send Creating
36347>>>>>>>        // Insert Code Here
36347>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Branch.Branch_Rec0)))))) to Branch.Branch_Recr
36348>>>>>>>    End_Procedure   // Creating
36349>>>>>>>
36349>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
36350>>>>>>>        // Insert Code Here
36350>>>>>>>        Case Begin
36350>>>>>>>             Case (iError_Num = 1001)
36352>>>>>>>                  Error 1001 "DDC 002:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
36353>>>>>>>>
36353>>>>>>>             Case Break
36354>>>>>>>
36354>>>>>>>             Case Else
36354>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
36356>>>>>>>        Case End
36356>>>>>>>    End_Procedure   // Operation_Not_Allowed
36357>>>>>>>
36357>>>>>>>
36357>>>>>>>    // Validate_Save:
36357>>>>>>>
36357>>>>>>>    Function Validate_Save  Returns Integer
36358>>>>>>>        Local Integer iReturnVal
36359>>>>>>>        Forward Get Validate_Save  To iReturnVal
36361>>>>>>>        If (Not(iReturnVal)) Begin
36363>>>>>>>            // Insert Code Here
36363>>>>>>>            If (Branch.Branch_Code="") Send Operation_Not_Allowed 1001
36366>>>>>>>        End
36366>>>>>>>>
36366>>>>>>>        Function_Return iReturnVal
36367>>>>>>>    End_Function   // Validate_Save
36368>>>>>>>
36368>>>>>>>
36368>>>>>>>    // Define_Fields:
36368>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36368>>>>>>>
36368>>>>>>>    Procedure Define_Fields
36369>>>>>>>        Forward Send Define_Fields
36371>>>>>>>        //DDB-Generated-Code-Location
36371>>>>>>>        //DDB-DefineFieldStart
36371>>>>>>>
36371>>>>>>>        Set Main_File            To Branch.File_Number
36372>>>>>>>        Set Cascade_Delete_State To FALSE
36373>>>>>>>
36373>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36374>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOENTER     DD_FINDREQ    
36375>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36376>>>>>>>
36376>>>>>>>        // Child (Client) file structure................
36376>>>>>>>        Send Add_Client_File  Year.File_Number
36377>>>>>>>        Send Add_Client_File  Brzones.File_Number
36378>>>>>>>        Send Add_Client_File  Tpbranch.File_Number
36379>>>>>>>
36379>>>>>>>        // Parent (Server) file structure...............
36379>>>>>>>        Send Add_Server_File  Company.File_Number
36380>>>>>>>
36380>>>>>>>        // External (System) file structure.............
36380>>>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
36381>>>>>>>
36381>>>>>>>        Define_Auto_Increment  Sysrecg.Branch_Rec0  To Branch.Branch_Rec0
36384>>>>>>>
36384>>>>>>>        // Field-based properties.......................
36384>>>>>>>
36384>>>>>>>        // Branch.Company_Code
36384>>>>>>>
36384>>>>>>>        // Branch.Branch_Code
36384>>>>>>>        Set Field_Options          Field Branch.Branch_Code To DD_AUTOFIND   
36385>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Code To (SL002(Self))
36386>>>>>>>        Set Key_Field_State        Field Branch.Branch_Code To TRUE
36387>>>>>>>
36387>>>>>>>        // Branch.Branch_Rec0
36387>>>>>>>
36387>>>>>>>        // Branch.Branch_Recr
36387>>>>>>>
36387>>>>>>>        // Branch.Branch_Name
36387>>>>>>>        Set Field_Prompt_Object    Field Branch.Branch_Name To (SL002(Self))
36388>>>>>>>
36388>>>>>>>        // Branch.Branch_Afm
36388>>>>>>>
36388>>>>>>>        // Branch.Branch_Addr
36388>>>>>>>
36388>>>>>>>        // Branch.Branch_Tk
36388>>>>>>>
36388>>>>>>>        // Branch.Branch_Poli
36388>>>>>>>
36388>>>>>>>        // Branch.Branch_Doy
36388>>>>>>>        Set Field_Value_Table      Field Branch.Branch_Doy To (Branch_Branch_Doy_VT(Self))
36389>>>>>>>
36389>>>>>>>        // Branch.Branch_J_Code
36389>>>>>>>
36389>>>>>>>        // Branch.Branch_C_Code0
36389>>>>>>>        Set Field_Value_Table      Field Branch.Branch_C_Code0 To (Branch_Branch_C_Code0_VT(Self))
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_C_Code00
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_C_Coder
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Tel
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Fax
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Email
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Resp
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Bitmap
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Site
36390>>>>>>>
36390>>>>>>>        // Branch.Branch_Apoth
36390>>>>>>>
36390>>>>>>>        // Branch.Beto_Site
36390>>>>>>>
36390>>>>>>>        // Branch.Path_Exp
36390>>>>>>>
36390>>>>>>>        // Branch.Exp_Txtname
36390>>>>>>>
36390>>>>>>>        // Branch.Send_Phone
36390>>>>>>>
36390>>>>>>>        // Branch.Send_Path_Files
36390>>>>>>>
36390>>>>>>>        // Branch.Send_Path_Conf
36390>>>>>>>
36390>>>>>>>        // Branch.Tomeas_Code
36390>>>>>>>
36390>>>>>>>        // Branch.Ftp_Sec_Retry
36390>>>>>>>
36390>>>>>>>        // Branch.Ftp_Sec_Exit
36390>>>>>>>
36390>>>>>>>        // Branch.Ras_Name
36390>>>>>>>
36390>>>>>>>        // Branch.Ras_Passw
36390>>>>>>>
36390>>>>>>>        // Branch.Ras_Domain
36390>>>>>>>
36390>>>>>>>        // Branch.Last_Hmnia_Ekt
36390>>>>>>>
36390>>>>>>>        // Branch.Deop_Logo
36390>>>>>>>
36390>>>>>>>        // Branch.Entolh
36390>>>>>>>
36390>>>>>>>        // Branch.Paragogh
36390>>>>>>>
36390>>>>>>>        // Branch.Locked_Until
36390>>>>>>>
36390>>>>>>>        // Branch.Sap_Code
36390>>>>>>>
36390>>>>>>>        // Branch.Perioxh
36390>>>>>>>
36390>>>>>>>        // Branch.Egkatastash
36390>>>>>>>
36390>>>>>>>        // Branch.Date_Locked
36390>>>>>>>        Set Field_Mask_Type        Field Branch.Date_Locked To MASK_DATE_WINDOW
36391>>>>>>>
36391>>>>>>>        // Branch.Ypokat1
36391>>>>>>>
36391>>>>>>>        // Branch.Ypokat1a
36391>>>>>>>
36391>>>>>>>        // Branch.Ypokat2
36391>>>>>>>
36391>>>>>>>        // Branch.Edra1
36391>>>>>>>
36391>>>>>>>        // Branch.Edra1a
36391>>>>>>>
36391>>>>>>>        // Branch.Edra2
36391>>>>>>>
36391>>>>>>>        //DDB-DefineFieldEnd
36391>>>>>>>    End_Procedure    // Define_Fields
36392>>>>>>>
36392>>>>>>>    // Field_Defaults:
36392>>>>>>>    // This procedure is used to establish default field values.
36392>>>>>>>
36392>>>>>>>    Procedure Field_Defaults
36393>>>>>>>        Forward Send Field_Defaults
36395>>>>>>>        //DDB-Generated-Code-Location
36395>>>>>>>        //DDB-FieldDefaultStart
36395>>>>>>>        //DDB-FieldDefaultEnd
36395>>>>>>>    End_Procedure    // Field_Defaults
36396>>>>>>>End_Class    // Branch_DataDictionary
36397>>>>>>>
36397>>>>>>>//DDB-Selection-pkg-Start
36397>>>>>>>
36397>>>>>>>Use Sl002.sl         // SL002
INCLUDING FILE: SL002.SL
36397>>>>>>>>>//AB/ Project SL002:Branch
36397>>>>>>>>>//AB/ Object prj is a Lookup_Project
36397>>>>>>>>>//AB/     Set ProjectName to "SL002:Branch"
36397>>>>>>>>>//AB/     Set ProjectFileName to "Sl002.sl"
36397>>>>>>>>>
36397>>>>>>>>>// Project Object Structure
36397>>>>>>>>>//   SL002 is a dbModalPanelSub
36397>>>>>>>>>//     Company_DD is a DataDictionary
36397>>>>>>>>>//     Branch_DD is a DataDictionary
36397>>>>>>>>>//     oSelList is a dbListSub
36397>>>>>>>>>//     oOK_bn is a ButtonSub
36397>>>>>>>>>//     oCancel_bn is a ButtonSub
36397>>>>>>>>>//     oSearch_bn is a ButtonSub
36397>>>>>>>>>
36397>>>>>>>>>// Register all objects
36397>>>>>>>>>Register_Object Branch_DD
36397>>>>>>>>>Register_Object Company_DD
36397>>>>>>>>>Register_Object oCancel_bn
36397>>>>>>>>>Register_Object oOK_bn
36397>>>>>>>>>Register_Object oSearch_bn
36397>>>>>>>>>Register_Object oSelList
36397>>>>>>>>>Register_Object SL002
36397>>>>>>>>>
36397>>>>>>>>>
36397>>>>>>>>>//AB-IgnoreStart
36397>>>>>>>>>
36397>>>>>>>>>Use DFAllEnt.pkg
36397>>>>>>>>>Use dbList.Sub
36397>>>>>>>>>Use Button.Sub
36397>>>>>>>>>
36397>>>>>>>>>
36397>>>>>>>>>Use COMPANY.DD
36397>>>>>>>>>Use BRANCH.DD
36397>>>>>>>>>
36397>>>>>>>>>//AB-IgnoreEnd
36397>>>>>>>>>
36397>>>>>>>>>Object SL002 is a dbModalPanelSub
36399>>>>>>>>>
36399>>>>>>>>>    //AB-StoreTopStart
36399>>>>>>>>>    Property String psFragmaCompanyCode  ""
36401>>>>>>>>>    
36401>>>>>>>>>    //AB-StoreTopEnd
36401>>>>>>>>>
36401>>>>>>>>>    Set Minimize_Icon to FALSE
36402>>>>>>>>>    Set Label to "“§¦¡˜«˜©«ã£˜«˜"
36403>>>>>>>>>    Set Size to 146 430
36404>>>>>>>>>    Set Location to 4 5
36405>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36406>>>>>>>>>    Set Modal_State to FALSE
36407>>>>>>>>>
36407>>>>>>>>>    //AB-DDOStart
36407>>>>>>>>>
36407>>>>>>>>>    Object Company_DD is a Company_DataDictionary
36409>>>>>>>>>    End_Object    // Company_DD
36410>>>>>>>>>
36410>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
36412>>>>>>>>>        Set DDO_Server to (Company_DD(self))
36413>>>>>>>>>
36413>>>>>>>>>        //AB-StoreStart
36413>>>>>>>>>        Procedure OnConstrain
36415>>>>>>>>>             String lsCompanyCode
36416>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
36417>>>>>>>>>             If (lsCompanyCode <> "") Constrain Branch.Company_code eq lsCompanyCode
36421>>>>>>>>>        End_Procedure // OnConstrain
36422>>>>>>>>>        
36422>>>>>>>>>        
36422>>>>>>>>>        
36422>>>>>>>>>        //AB-StoreEnd
36422>>>>>>>>>
36422>>>>>>>>>    End_Object    // Branch_DD
36423>>>>>>>>>
36423>>>>>>>>>    Set Main_DD to (Branch_DD(self))
36424>>>>>>>>>    Set Server to (Branch_DD(self))
36425>>>>>>>>>
36425>>>>>>>>>    //AB-DDOEnd
36425>>>>>>>>>
36425>>>>>>>>>    Object oSelList is a dbListSub
36427>>>>>>>>>        Set Main_File to Branch.File_Number
36428>>>>>>>>>        Set Size to 105 415
36429>>>>>>>>>        Set Location to 6 6
36430>>>>>>>>>
36430>>>>>>>>>        Begin_Row
36433>>>>>>>>>            Entry_Item Branch.Branch_code
36434>>>>>>>>>            Entry_Item Branch.Branch_name
36435>>>>>>>>>            Entry_Item Company.Company_code
36436>>>>>>>>>            Entry_Item Company.Company_name
36437>>>>>>>>>            Entry_Item Branch.Beto_site
36438>>>>>>>>>            Entry_Item Branch.Branch_recr
36439>>>>>>>>>        End_Row
36444>>>>>>>>>
36444>>>>>>>>>        Set Form_Width    item 0 to 60
36445>>>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
36446>>>>>>>>>        
36446>>>>>>>>>        Set Form_Width    item 1 to 128
36447>>>>>>>>>        Set Header_Label  item 1 to "Ž¤¦£˜"
36448>>>>>>>>>        
36448>>>>>>>>>        Set Form_Width    item 2 to 69
36449>>>>>>>>>        Set Header_Label  item 2 to "‰à› ¡æª „«˜ ¨å˜ª"
36450>>>>>>>>>        
36450>>>>>>>>>        Set Form_Width    item 3 to 109
36451>>>>>>>>>        Set Header_Label  item 3 to "Ž¤¦£˜ „«˜ ¨å˜ª"
36452>>>>>>>>>        
36452>>>>>>>>>        Set Form_Width    item 4 to 42
36453>>>>>>>>>        Set Header_Label  item 4 to "Site"
36454>>>>>>>>>        
36454>>>>>>>>>        Set Form_Width    item 5 to 0
36455>>>>>>>>>        Set Header_Label  item 5 to ""
36456>>>>>>>>>        
36456>>>>>>>>>
36456>>>>>>>>>        //AB-StoreStart
36456>>>>>>>>>                
36456>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
36458>>>>>>>>>        
36458>>>>>>>>>        Procedure Store_Defaults
36460>>>>>>>>>            forward send Store_Defaults
36462>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
36463>>>>>>>>>        end_Procedure // Store_Defaults
36464>>>>>>>>>        
36464>>>>>>>>>        Procedure Restore_Defaults
36466>>>>>>>>>            forward send Restore_Defaults
36468>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
36469>>>>>>>>>        end_Procedure // Restore_Defaults
36470>>>>>>>>>        
36470>>>>>>>>>        Procedure Activating
36472>>>>>>>>>            Forward Send Activating
36474>>>>>>>>>            Send Rebuild_Constraints to (Branch_DD(self))
36475>>>>>>>>>        End_Procedure // Activating
36476>>>>>>>>>        
36476>>>>>>>>>        Set Column_Options Item 5 to NoEnter True
36477>>>>>>>>>        
36477>>>>>>>>>        
36477>>>>>>>>>        //AB-StoreEnd
36477>>>>>>>>>
36477>>>>>>>>>    End_Object    // oSelList
36478>>>>>>>>>
36478>>>>>>>>>    Object oOK_bn is a ButtonSub
36480>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36481>>>>>>>>>        Set Location to 112 262
36482>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36483>>>>>>>>>
36483>>>>>>>>>        //AB-StoreStart
36483>>>>>>>>>        Procedure OnClick
36485>>>>>>>>>            Send OK To (oSelList(current_object))
36486>>>>>>>>>        End_Procedure
36487>>>>>>>>>        //AB-StoreEnd
36487>>>>>>>>>
36487>>>>>>>>>    End_Object    // oOK_bn
36488>>>>>>>>>
36488>>>>>>>>>    Object oCancel_bn is a ButtonSub
36490>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36491>>>>>>>>>        Set Location to 112 317
36492>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36493>>>>>>>>>
36493>>>>>>>>>        //AB-StoreStart
36493>>>>>>>>>        Procedure OnClick
36495>>>>>>>>>            Send Cancel To (oSelList(current_object))
36496>>>>>>>>>        End_Procedure
36497>>>>>>>>>        //AB-StoreEnd
36497>>>>>>>>>
36497>>>>>>>>>    End_Object    // oCancel_bn
36498>>>>>>>>>
36498>>>>>>>>>    Object oSearch_bn is a ButtonSub
36500>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36501>>>>>>>>>        Set Location to 112 372
36502>>>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36503>>>>>>>>>
36503>>>>>>>>>        //AB-StoreStart
36503>>>>>>>>>        Procedure OnClick
36505>>>>>>>>>            Send Search To (oSelList(current_object))
36506>>>>>>>>>        End_Procedure
36507>>>>>>>>>        //AB-StoreEnd
36507>>>>>>>>>
36507>>>>>>>>>    End_Object    // oSearch_bn
36508>>>>>>>>>
36508>>>>>>>>>
36508>>>>>>>>>    //AB-StoreStart
36508>>>>>>>>>    
36508>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36509>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36510>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36511>>>>>>>>>    
36511>>>>>>>>>    
36511>>>>>>>>>    
36511>>>>>>>>>    //AB-StoreEnd
36511>>>>>>>>>
36511>>>>>>>>>End_Object    // SL002
36512>>>>>>>>>
36512>>>>>>>>>//AB/ End_Object    // prj
36512>>>>>>>
36512>>>>>>>//DDB-Selection-pkg-End
36512>>>>>>>//DDB-FileEnd
36512>>>>>Use YEAR.DD
INCLUDING FILE: YEAR.DD
36512>>>>>>>//DDB-FileStart
36512>>>>>>>//DDB-HeaderStart
36512>>>>>>>
36512>>>>>>>// File Name : YEAR.DD
36512>>>>>>>// Class Name: Year_DataDictionary
36512>>>>>>>// Revision  : 119
36512>>>>>>>// Version   : 2
36512>>>>>>>
36512>>>>>>>Use  Windows           // Basic Definitions
36512>>>>>>>Use  DataDict          // DataDictionary Class Definition
36512>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
36512>>>>>>>
36512>>>>>>>Open Year
36514>>>>>>>Open Branch
36516>>>>>>>Open Syscurxr
36518>>>>>>>
36518>>>>>>>//DDB-HeaderEnd
36518>>>>>>>//DDB-ValidationStart
36518>>>>>>>
36518>>>>>>>Register_Object Year_Year_C_Code0_VT1
36518>>>>>>>Register_Object Year_Year_C_Code00_VT1
36518>>>>>>>Register_Object Year_Year_C_Coder_VT1
36518>>>>>>>
36518>>>>>>>Object Year_Year_C_Code0_VT1  is a CodeValidationTable
36520>>>>>>>    Set Type_Value        To "CURRENCY"
36521>>>>>>>    //DDB-ValidationCustomStart
36521>>>>>>>    //DDB-ValidationCustomEnd
36521>>>>>>>End_Object   // Year_Year_C_Code0_VT1
36522>>>>>>>
36522>>>>>>>Object Year_Year_C_Code00_VT1  is a CodeValidationTable
36524>>>>>>>    Set Type_Value        To "CURRENCY"
36525>>>>>>>    //DDB-ValidationCustomStart
36525>>>>>>>    //DDB-ValidationCustomEnd
36525>>>>>>>End_Object   // Year_Year_C_Code00_VT1
36526>>>>>>>
36526>>>>>>>Object Year_Year_C_Coder_VT1  is a CodeValidationTable
36528>>>>>>>    Set Type_Value        To "CURRENCY"
36529>>>>>>>    //DDB-ValidationCustomStart
36529>>>>>>>    //DDB-ValidationCustomEnd
36529>>>>>>>End_Object   // Year_Year_C_Coder_VT1
36530>>>>>>>//DDB-ValidationEnd
36530>>>>>>>//DDB-SelectionStart
36530>>>>>>>//DDB/ ExternalSelectionList SL003  Sl003.sl
36530>>>>>>>Register_Object SL003
36530>>>>>>>//DDB-SelectionEnd
36530>>>>>>>            
36530>>>>>>>Class Year_DataDictionary  is a DataDictionary
36531>>>>>>>    
36531>>>>>>>    Procedure Creating
36532>>>>>>>        Forward Send Creating
36534>>>>>>>        // Insert Code Here
36534>>>>>>>        Move (Append('',((Trim(Branch.Branch_Site))+;                          (Trim(String(Year.Year_Year)))))) to Year.Year_Recr
36535>>>>>>>    End_Procedure   // Creating
36536>>>>>>>
36536>>>>>>>
36536>>>>>>>    // Operation_Not_Allowed:
36536>>>>>>>    Procedure Operation_Not_Allowed  Integer iError_Num
36537>>>>>>>        // Insert Code Here
36537>>>>>>>        Case Begin    
36537>>>>>>>             Case (iError_Num = 1001)
36539>>>>>>>                  Error 1001 "DDC 053:€¡˜«á¢¢ž¢¦ª ‰à› ¡æª “§¦¡˜«˜©«ã£˜«¦ª!\n\n‰œ¤æª ‰à› ¡æª"
36540>>>>>>>>
36540>>>>>>>             Case Break
36541>>>>>>>             Case (iError_Num=1002)
36544>>>>>>>                Error 1002 "DDC 053:Branch Site ¡˜«œ™˜å¤œ  ©«¦ Year ¡œ¤æ"
36545>>>>>>>>
36545>>>>>>>             Case Break
36546>>>>>>>             Case (iError_Num=1003)
36549>>>>>>>                Error 1003 "DDC 053:Company Code=0"
36550>>>>>>>>
36550>>>>>>>             Case Break
36551>>>>>>>             Case (iError_Num=1004)
36554>>>>>>>                Error 1004 "DDC 053:Branch Code=0"
36555>>>>>>>>
36555>>>>>>>             Case Break
36556>>>>>>>             Case Else
36556>>>>>>>                  Forward Send Operation_Not_Allowed  iError_Num
36558>>>>>>>        Case End
36558>>>>>>>    End_Procedure   // Operation_Not_Allowed
36559>>>>>>>
36559>>>>>>>
36559>>>>>>>    // Update:
36559>>>>>>>    // Use this message to effect changes in related-to files. The
36559>>>>>>>    // Backout message should be designed to reverse the effects of this
36559>>>>>>>    // message. It is invoked while the database is locked.
36559>>>>>>>
36559>>>>>>>    Procedure Update
36560>>>>>>>        Forward Send Update
36562>>>>>>>        // Insert Code Here
36562>>>>>>>        Move Company.Company_Code   to Year.Company_Code
36563>>>>>>>        Move Branch.Branch_Code     to Year.Branch_Code
36564>>>>>>>        move branch.beto_site       to year.beto_site
36565>>>>>>>
36565>>>>>>>        //sos:parametrika apo sysfile?
36565>>>>>>>       
36565>>>>>>>       // If ((Year.Year_EntryDate-14) < Year.Year_XrhshFrom) Begin
36565>>>>>>>       //     Move Year.Year_XrhshFrom to Year.Year_OpenFrom
36565>>>>>>>       // End
36565>>>>>>>       // Else Begin
36565>>>>>>>       //     Move (Year.Year_EntryDate-14) to Year.Year_OpenFrom
36565>>>>>>>       // End
36565>>>>>>>      //  Move Year.Year_EntryDate      to Year.Year_OpenTo
36565>>>>>>>    End_Procedure   // Update
36566>>>>>>>
36566>>>>>>>    // Validate_Save:
36566>>>>>>>
36566>>>>>>>    Function Validate_Save  Returns Integer
36567>>>>>>>        Local Integer iReturnVal
36568>>>>>>>        Forward Get Validate_Save  To iReturnVal
36570>>>>>>>        If (Not(iReturnVal)) Begin
36572>>>>>>>                 If (Year.Year_Year   = 0) Send Operation_Not_Allowed 1001
36575>>>>>>>            Else If (Year.Company_Code='') Send Operation_Not_Allowed 1003
36579>>>>>>>            Else If (Year.Branch_Code ='') Send Operation_Not_Allowed 1004
36583>>>>>>>        End
36583>>>>>>>>
36583>>>>>>>        Function_Return iReturnVal
36584>>>>>>>    End_Function   // Validate_Save
36585>>>>>>>
36585>>>>>>>
36585>>>>>>>    // Define_Fields:
36585>>>>>>>    // This procedure is used to set up all data-dictionary rules.
36585>>>>>>>
36585>>>>>>>    Procedure Define_Fields
36586>>>>>>>        Forward Send Define_Fields
36588>>>>>>>        //DDB-Generated-Code-Location
36588>>>>>>>        //DDB-DefineFieldStart
36588>>>>>>>
36588>>>>>>>        Set Main_File            To Year.File_Number
36589>>>>>>>        Set Cascade_Delete_State To FALSE
36590>>>>>>>
36590>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
36591>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
36592>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36593>>>>>>>
36593>>>>>>>        // Parent (Server) file structure...............
36593>>>>>>>        Send Add_Server_File  Branch.File_Number
36594>>>>>>>
36594>>>>>>>        // External (System) file structure.............
36594>>>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
36595>>>>>>>
36595>>>>>>>        // Field-based properties.......................
36595>>>>>>>
36595>>>>>>>        // Year.Company_Code
36595>>>>>>>
36595>>>>>>>        // Year.Branch_Code
36595>>>>>>>
36595>>>>>>>        // Year.Year_Year
36595>>>>>>>        Set Field_Options          Field Year.Year_Year To DD_AUTOFIND    DD_REQUIRED   
36596>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Year To (SL003(Self))
36597>>>>>>>        Set Key_Field_State        Field Year.Year_Year To TRUE
36598>>>>>>>
36598>>>>>>>        // Year.Year_Recr
36598>>>>>>>        Set Field_Prompt_Object    Field Year.Year_Recr To (SL003(Self))
36599>>>>>>>
36599>>>>>>>        // Year.Branch_Recr
36599>>>>>>>
36599>>>>>>>        // Year.Year_Descr
36599>>>>>>>
36599>>>>>>>        // Year.Year_Isolfrom
36599>>>>>>>
36599>>>>>>>        // Year.Year_Isolto
36599>>>>>>>
36599>>>>>>>        // Year.Year_Openfrom
36599>>>>>>>
36599>>>>>>>        // Year.Year_Opento
36599>>>>>>>
36599>>>>>>>        // Year.Year_Entrydate
36599>>>>>>>
36599>>>>>>>        // Year.Year_Dateaa
36599>>>>>>>
36599>>>>>>>        // Year.Year_Xrhshfrom
36599>>>>>>>
36599>>>>>>>        // Year.Year_Xrhshto
36599>>>>>>>
36599>>>>>>>        // Year.Year_Myflimit
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgtypkin
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgarticl
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgmove
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgplan
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgformat
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgthaa
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numgopen
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numbtypkin
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numbaxio
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numbarticl
36599>>>>>>>
36599>>>>>>>        // Year.Year_Numbmove
36599>>>>>>>
36599>>>>>>>        // Year.Year_Delimiter
36599>>>>>>>
36599>>>>>>>        // Year.Year_Printer
36599>>>>>>>
36599>>>>>>>        // Year.Year_Valid_Char
36599>>>>>>>
36599>>>>>>>        // Year.Year_C_Code0
36599>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0 To "dbComboFormSub"
36600>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code0 To (Year_Year_C_Code0_VT1(Self))
36601>>>>>>>
36601>>>>>>>        // Year.Year_C_Code00
36601>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00 To "dbComboFormSub"
36602>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Code00 To (Year_Year_C_Code00_VT1(Self))
36603>>>>>>>
36603>>>>>>>        // Year.Year_C_Coder
36603>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder To "dbComboFormSub"
36604>>>>>>>        Set Field_Value_Table      Field Year.Year_C_Coder To (Year_Year_C_Coder_VT1(Self))
36605>>>>>>>
36605>>>>>>>        // Year.Beto_Site
36605>>>>>>>
36605>>>>>>>        // Year.Clients_Plafon
36605>>>>>>>
36605>>>>>>>        // Year.Payresp_Plafon
36605>>>>>>>
36605>>>>>>>        // Year.Clients_Ofeilh
36605>>>>>>>
36605>>>>>>>        // Year.Payresp_Ofeilh
36605>>>>>>>
36605>>>>>>>        // Year.Working
36605>>>>>>>
36605>>>>>>>        //DDB-DefineFieldEnd
36605>>>>>>>
36605>>>>>>>        Set Main_File            To Year.File_Number
36606>>>>>>>        Set Cascade_Delete_State To FALSE
36607>>>>>>>
36607>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ
36608>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ
36609>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
36610>>>>>>>
36610>>>>>>>        // Child (Client) file structure................
36610>>>>>>>
36610>>>>>>>        // Parent (Server) file structure...............
36610>>>>>>>        Send Add_Server_File  Branch.File_Number
36611>>>>>>>
36611>>>>>>>        // Field-based properties.......................
36611>>>>>>>
36611>>>>>>>        // Year.Company_Code
36611>>>>>>>
36611>>>>>>>        // Year.Branch_Code
36611>>>>>>>
36611>>>>>>>        // Year.Year_Year
36611>>>>>>>        Set Field_Label_Long       Field Year.Year_Year           To "•¨ã©ž"
36612>>>>>>>        Set Field_Label_Short      Field Year.Year_Year           To "•¨ã©ž"
36613>>>>>>>        Set Field_Options          Field Year.Year_Year           To DD_REQUIRED
36614>>>>>>>        //Set Field_Prompt_Object    Field Year.Year_Year           To (SL053(Self))
36614>>>>>>>
36614>>>>>>>        // Year.Year_Descr
36614>>>>>>>        Set Field_Label_Long       Field Year.Year_Descr          To "œ¨ š¨˜­ã •¨ã©žª"
36615>>>>>>>        Set Field_Label_Short      Field Year.Year_Descr          To "œ¨.•¨ã©žª"
36616>>>>>>>
36616>>>>>>>        // Year.Year_C_Code0
36616>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code0        To "dbComboForm"
36617>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code0        To "‰ç¨ ¦ Œæ£ ©£˜"
36618>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code0        To "‰¬¨.Œ¦£ ©£˜"
36619>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code0        To (Year_Year_C_Code0_VT(Self))
36619>>>>>>>
36619>>>>>>>        // Year.Year_C_Code00
36619>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Code00       To "dbComboForm"
36620>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
36621>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Code00       To "ƒœ¬«œ¨œç¦¤ Œæ£ ©£˜"
36622>>>>>>>        //Set Field_Options          Field Year.Year_C_Code00       To DD_REQUIRED
36622>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Code00       To (Year_Year_C_Code1_VT(Self))
36622>>>>>>>
36622>>>>>>>        // Year.Year_C_Coder
36622>>>>>>>        Set Field_Class_Name       Field Year.Year_C_Coder        To "dbComboForm"
36623>>>>>>>        Set Field_Label_Long       Field Year.Year_C_Coder        To "Œæ£ ©£˜ REPORTING"
36624>>>>>>>        Set Field_Label_Short      Field Year.Year_C_Coder        To "Œæ£ ©£˜ REP"
36625>>>>>>>        //Set Field_Options          Field Year.Year_C_Coder        To DD_REQUIRED
36625>>>>>>>        //Set Field_Value_Table      Field Year.Year_C_Coder        To (Year_Year_C_Coder_VT(Self))
36625>>>>>>>
36625>>>>>>>        // Year.Year_Isolfrom
36625>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
36626>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolfrom       To "ˆ©¦¢¦š ©£æª €§æ"
36627>>>>>>>
36627>>>>>>>        // Year.Year_Isolto
36627>>>>>>>        Set Field_Label_Long       Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
36628>>>>>>>        Set Field_Label_Short      Field Year.Year_Isolto         To "ˆ©¦¢¦š ©£æª „àª"
36629>>>>>>>
36629>>>>>>>        // Year.Year_Openfrom
36629>>>>>>>        Set Field_Label_Long       Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
36630>>>>>>>        Set Field_Label_Short      Field Year.Year_Openfrom       To "„šš¨˜­âª €§æ"
36631>>>>>>>
36631>>>>>>>        // Year.Year_Opento
36631>>>>>>>        Set Field_Label_Long       Field Year.Year_Opento         To "„šš¨˜­âª „àª"
36632>>>>>>>        Set Field_Label_Short      Field Year.Year_Opento         To "„šš¨˜­âª „àª"
36633>>>>>>>
36633>>>>>>>        // Year.Year_Entrydate
36633>>>>>>>        Set Field_Label_Long       Field Year.Year_Entrydate      To "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª"
36634>>>>>>>        Set Field_Label_Short      Field Year.Year_Entrydate      To "†£/¤å˜ „¨š˜©å˜ª"
36635>>>>>>>
36635>>>>>>>        // Year.Year_Dateaa
36635>>>>>>>
36635>>>>>>>        // Year.Year_Xrhshfrom
36635>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
36636>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshfrom      To "•¨ã©ž €§æ"
36637>>>>>>>
36637>>>>>>>        // Year.Year_Xrhshto
36637>>>>>>>        Set Field_Label_Long       Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
36638>>>>>>>        Set Field_Label_Short      Field Year.Year_Xrhshto        To "•¨ã©ž „àª"
36639>>>>>>>
36639>>>>>>>        // Year.Year_Myflimit
36639>>>>>>>        Set Field_Label_Long       Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
36640>>>>>>>        Set Field_Label_Short      Field Year.Year_Myflimit       To "Ž¨ ¦ ‹“”"
36641>>>>>>>
36641>>>>>>>        // Year.Year_Numgtypkin
36641>>>>>>>        Set Field_Options          Field Year.Year_Numgtypkin     To DD_DISPLAYONLY
36642>>>>>>>
36642>>>>>>>        // Year.Year_Numgarticl
36642>>>>>>>        Set Field_Options          Field Year.Year_Numgarticl     To DD_DISPLAYONLY
36643>>>>>>>
36643>>>>>>>        // Year.Year_Numgmove
36643>>>>>>>        Set Field_Options          Field Year.Year_Numgmove       To DD_DISPLAYONLY
36644>>>>>>>
36644>>>>>>>        // Year.Year_Numgplan
36644>>>>>>>        Set Field_Options          Field Year.Year_Numgplan       To DD_DISPLAYONLY
36645>>>>>>>
36645>>>>>>>        // Year.Year_Numgformat
36645>>>>>>>        Set Field_Options          Field Year.Year_Numgformat     To DD_DISPLAYONLY
36646>>>>>>>
36646>>>>>>>        // Year.Year_Numgthaa
36646>>>>>>>        Set Field_Options          Field Year.Year_Numgthaa       To DD_DISPLAYONLY
36647>>>>>>>
36647>>>>>>>        // Year.Year_Numgopen
36647>>>>>>>        Set Field_Options          Field Year.Year_Numgopen       To DD_DISPLAYONLY
36648>>>>>>>
36648>>>>>>>        // Year.Year_Numbaxio
36648>>>>>>>        Set Field_Options          Field Year.Year_Numbaxio       To DD_DISPLAYONLY
36649>>>>>>>
36649>>>>>>>        // Year.Year_Numbarticl
36649>>>>>>>        Set Field_Options          Field Year.Year_Numbarticl     To DD_DISPLAYONLY
36650>>>>>>>
36650>>>>>>>        // Year.Year_Numbmove
36650>>>>>>>        Set Field_Options          Field Year.Year_Numbmove       To DD_DISPLAYONLY
36651>>>>>>>
36651>>>>>>>        // Year.Year_Delimiter
36651>>>>>>>        Set Status_Help            Field Year.Year_Delimiter      To "ƒ ˜®à¨ ©« ¡æ š ˜ «¦ Š‘ «žª •¨ã©œàª"
36652>>>>>>>
36652>>>>>>>        // Year.Year_Printer
36652>>>>>>>
36652>>>>>>>        // Year.Year_Valid_Char
36652>>>>>>>
36652>>>>>>>    End_Procedure    // Define_Fields
36653>>>>>>>
36653>>>>>>>    // Field_Defaults:
36653>>>>>>>    // This procedure is used to establish default field values.
36653>>>>>>>
36653>>>>>>>    Procedure Field_Defaults
36654>>>>>>>        Forward Send Field_Defaults
36656>>>>>>>        //DDB-Generated-Code-Location
36656>>>>>>>        //DDB-FieldDefaultStart
36656>>>>>>>        //DDB-FieldDefaultEnd
36656>>>>>>>        Set Field_Changed_Value   Field Year.Year_Delimiter      To "."
36657>>>>>>>        Set Field_Changed_Value   Field Year.Year_Printer        To "LPT1:"
36658>>>>>>>        Set Field_Changed_Value   Field Year.Year_Valid_Char     To "1234567890"
36659>>>>>>>    End_Procedure    // Field_Defaults
36660>>>>>>>
36660>>>>>>>End_Class    // Year_DataDictionary
36661>>>>>>>//DDB-Selection-pkg-Start
36661>>>>>>>
36661>>>>>>>Use Sl003.sl         // SL003
INCLUDING FILE: SL003.SL
36661>>>>>>>>>//AB/ Project SL003:Year
36661>>>>>>>>>//AB/ Object prj is a Lookup_Project
36661>>>>>>>>>//AB/     Set ProjectName to "SL003:Year"
36661>>>>>>>>>//AB/     Set ProjectFileName to "Sl003.sl"
36661>>>>>>>>>
36661>>>>>>>>>// Project Object Structure
36661>>>>>>>>>//   SL003 is a dbModalPanelSub
36661>>>>>>>>>//     Company_DD is a DataDictionary
36661>>>>>>>>>//     Branch_DD is a DataDictionary
36661>>>>>>>>>//     Year_DD is a DataDictionary
36661>>>>>>>>>//     oSelList is a dbListSub
36661>>>>>>>>>//     oOK_bn is a ButtonSub
36661>>>>>>>>>//     oCancel_bn is a ButtonSub
36661>>>>>>>>>//     oSearch_bn is a ButtonSub
36661>>>>>>>>>
36661>>>>>>>>>// Register all objects
36661>>>>>>>>>Register_Object Branch_DD
36661>>>>>>>>>Register_Object Company_DD
36661>>>>>>>>>Register_Object oCancel_bn
36661>>>>>>>>>Register_Object oOK_bn
36661>>>>>>>>>Register_Object oSearch_bn
36661>>>>>>>>>Register_Object oSelList
36661>>>>>>>>>Register_Object SL003
36661>>>>>>>>>Register_Object Year_DD
36661>>>>>>>>>
36661>>>>>>>>>
36661>>>>>>>>>//AB-IgnoreStart
36661>>>>>>>>>
36661>>>>>>>>>Use DFAllEnt.pkg
36661>>>>>>>>>Use dbList.Sub
36661>>>>>>>>>Use Button.Sub
36661>>>>>>>>>
36661>>>>>>>>>
36661>>>>>>>>>Use COMPANY.DD
36661>>>>>>>>>Use BRANCH.DD
36661>>>>>>>>>Use YEAR.DD
36661>>>>>>>>>
36661>>>>>>>>>//AB-IgnoreEnd
36661>>>>>>>>>
36661>>>>>>>>>CD_Popup_Object SL003 is a dbModalPanelSub
36680>>>>>>>>>
36680>>>>>>>>>    //AB-StoreTopStart
36680>>>>>>>>>    Property String psFragmaCompanyCode  ""
36682>>>>>>>>>    Property String psFragmaBranchCode   ""
36684>>>>>>>>>    property integer pifragmaactive public 0
36686>>>>>>>>>    //AB-StoreTopEnd
36686>>>>>>>>>
36686>>>>>>>>>    Set Minimize_Icon to FALSE
36687>>>>>>>>>    Set Label to "•¨ã©œ ª"
36688>>>>>>>>>    Set Size to 149 449
36689>>>>>>>>>    Set Location to 4 7
36690>>>>>>>>>    Set Exit_Application_Local_State to FALSE
36691>>>>>>>>>    Set Modal_State to FALSE
36692>>>>>>>>>
36692>>>>>>>>>    //AB-DDOStart
36692>>>>>>>>>
36692>>>>>>>>>    Object Company_DD is a Company_DataDictionary
36694>>>>>>>>>    End_Object    // Company_DD
36695>>>>>>>>>
36695>>>>>>>>>    Object Branch_DD is a Branch_DataDictionary
36697>>>>>>>>>        Set DDO_Server to (Company_DD(self))
36698>>>>>>>>>    End_Object    // Branch_DD
36699>>>>>>>>>
36699>>>>>>>>>    Object Year_DD is a Year_DataDictionary
36701>>>>>>>>>        Set DDO_Server to (Branch_DD(self))
36702>>>>>>>>>
36702>>>>>>>>>        //AB-StoreStart
36702>>>>>>>>>        Procedure OnConstrain
36704>>>>>>>>>             String lsCompanyCode lsBranchCode
36705>>>>>>>>>             integer iactive
36705>>>>>>>>>             Get psFragmaCompanyCode to lsCompanyCode
36706>>>>>>>>>             get pifragmaactive to iactive
36707>>>>>>>>>             If (lsCompanyCode <> "") Begin
36709>>>>>>>>>                Get psFragmaBranchCode  to lsBranchCode
36710>>>>>>>>>                Constrain Year.Company_Code eq lsCompanyCode
36712>>>>>>>>>                If (lsBranchCode <> "") Constrain Year.Branch_code eq lsBranchCode
36716>>>>>>>>>             End
36716>>>>>>>>>>
36716>>>>>>>>>             if (iactive = 0) constrain year.working ne 1
36720>>>>>>>>>        End_Procedure // OnConstrain
36721>>>>>>>>>        
36721>>>>>>>>>        
36721>>>>>>>>>        
36721>>>>>>>>>        
36721>>>>>>>>>        
36721>>>>>>>>>        //AB-StoreEnd
36721>>>>>>>>>
36721>>>>>>>>>    End_Object    // Year_DD
36722>>>>>>>>>
36722>>>>>>>>>    Set Main_DD to (Year_DD(self))
36723>>>>>>>>>    Set Server to (Year_DD(self))
36724>>>>>>>>>
36724>>>>>>>>>    //AB-DDOEnd
36724>>>>>>>>>
36724>>>>>>>>>    Object oSelList is a dbListSub
36726>>>>>>>>>        Set Main_File to Year.File_Number
36727>>>>>>>>>        Set Size to 105 433
36728>>>>>>>>>        Set Location to 6 6
36729>>>>>>>>>
36729>>>>>>>>>        Begin_Row
36732>>>>>>>>>            Entry_Item Year.Year_year
36733>>>>>>>>>            Entry_Item Company.Company_code
36734>>>>>>>>>            Entry_Item Company.Company_name
36735>>>>>>>>>            Entry_Item Branch.Branch_code
36736>>>>>>>>>            Entry_Item Branch.Branch_name
36737>>>>>>>>>        End_Row
36742>>>>>>>>>
36742>>>>>>>>>        Set Form_Width    item 0 to 36
36743>>>>>>>>>        Set Header_Label  item 0 to "•¨ã©ž :          "
36744>>>>>>>>>        
36744>>>>>>>>>        Set Form_Width    item 1 to 71
36745>>>>>>>>>        Set Header_Label  item 1 to "‰à› ¡æª „«˜ ¨å˜ª"
36746>>>>>>>>>        
36746>>>>>>>>>        Set Form_Width    item 2 to 136
36747>>>>>>>>>        Set Header_Label  item 2 to "Ž¤¦£˜ „«˜ ¨å˜ª"
36748>>>>>>>>>        
36748>>>>>>>>>        Set Form_Width    item 3 to 73
36749>>>>>>>>>        Set Header_Label  item 3 to "‰à› ¡æª “§¦¡/«¦ª"
36750>>>>>>>>>        
36750>>>>>>>>>        Set Form_Width    item 4 to 109
36751>>>>>>>>>        Set Header_Label  item 4 to "Ž¤¦£˜ “§¦¡/«¦ª"
36752>>>>>>>>>        
36752>>>>>>>>>
36752>>>>>>>>>        //AB-StoreStart
36752>>>>>>>>>                                                
36752>>>>>>>>>        Property String psStoreFragmaCompanyCode  ""
36754>>>>>>>>>        Property String psStoreFragmaBranchCode   ""
36756>>>>>>>>>        
36756>>>>>>>>>        Procedure Store_Defaults
36758>>>>>>>>>            forward send Store_Defaults
36760>>>>>>>>>            Set psStoreFragmaCompanyCode to (psFragmaCompanyCode(Self))
36761>>>>>>>>>            Set psStoreFragmaBranchCode  to (psFragmaBranchCode(Self))
36762>>>>>>>>>        end_Procedure // Store_Defaults
36763>>>>>>>>>        
36763>>>>>>>>>        Procedure Restore_Defaults
36765>>>>>>>>>            forward send Restore_Defaults
36767>>>>>>>>>            Set psFragmaCompanyCode to (psStoreFragmaCompanyCode(self))
36768>>>>>>>>>            Set psFragmaBranchCode  to (psStoreFragmaBranchCode(self))
36769>>>>>>>>>        end_Procedure // Restore_Defaults
36770>>>>>>>>>        
36770>>>>>>>>>        Procedure Activating
36772>>>>>>>>>            Forward Send Activating
36774>>>>>>>>>            Send Rebuild_Constraints to (Year_DD(self))
36775>>>>>>>>>        End_Procedure // Activating
36776>>>>>>>>>        
36776>>>>>>>>>        
36776>>>>>>>>>        
36776>>>>>>>>>        //AB-StoreEnd
36776>>>>>>>>>
36776>>>>>>>>>    End_Object    // oSelList
36777>>>>>>>>>
36777>>>>>>>>>    Object oOK_bn is a ButtonSub
36779>>>>>>>>>        Set Label to "&„§ ¢¦šã"
36780>>>>>>>>>        Set Location to 112 280
36781>>>>>>>>>
36781>>>>>>>>>        //AB-StoreStart
36781>>>>>>>>>        Procedure OnClick
36783>>>>>>>>>            Send OK To (oSelList(current_object))
36784>>>>>>>>>        End_Procedure
36785>>>>>>>>>        //AB-StoreEnd
36785>>>>>>>>>
36785>>>>>>>>>    End_Object    // oOK_bn
36786>>>>>>>>>
36786>>>>>>>>>    Object oCancel_bn is a ButtonSub
36788>>>>>>>>>        Set Label to "&€¡ç¨à©ž"
36789>>>>>>>>>        Set Location to 112 335
36790>>>>>>>>>
36790>>>>>>>>>        //AB-StoreStart
36790>>>>>>>>>        Procedure OnClick
36792>>>>>>>>>            Send Cancel To (oSelList(current_object))
36793>>>>>>>>>        End_Procedure
36794>>>>>>>>>        //AB-StoreEnd
36794>>>>>>>>>
36794>>>>>>>>>    End_Object    // oCancel_bn
36795>>>>>>>>>
36795>>>>>>>>>    Object oSearch_bn is a ButtonSub
36797>>>>>>>>>        Set Label to "€&¤˜ã«ž©ž"
36798>>>>>>>>>        Set Location to 112 390
36799>>>>>>>>>
36799>>>>>>>>>        //AB-StoreStart
36799>>>>>>>>>        Procedure OnClick
36801>>>>>>>>>            Send Search To (oSelList(current_object))
36802>>>>>>>>>        End_Procedure
36803>>>>>>>>>        //AB-StoreEnd
36803>>>>>>>>>
36803>>>>>>>>>    End_Object    // oSearch_bn
36804>>>>>>>>>
36804>>>>>>>>>
36804>>>>>>>>>    //AB-StoreStart
36804>>>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
36805>>>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
36806>>>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
36807>>>>>>>>>    
36807>>>>>>>>>    
36807>>>>>>>>>    
36807>>>>>>>>>    //AB-StoreEnd
36807>>>>>>>>>
36807>>>>>>>>>CD_End_Object    // SL003
36809>>>>>>>>>>
36809>>>>>>>>>
36809>>>>>>>>>//AB/ End_Object    // prj
36809>>>>>>>
36809>>>>>>>//DDB-Selection-pkg-End
36809>>>>>>>//DDB-FileEnd
36809>>>>>
36809>>>>>//AB-IgnoreEnd
36809>>>>>
36809>>>>>Object oSelectYear is a dbModalPanelSub
36811>>>>>
36811>>>>>    //AB-StoreTopStart
36811>>>>>    
36811>>>>>    Property String  psSelectedYearRecr  ''
36813>>>>>    Property Integer piChangeState False
36815>>>>>    
36815>>>>>    //AB-StoreTopEnd
36815>>>>>
36815>>>>>    Set Minimize_Icon to FALSE
36816>>>>>    Set Label to "„§ ¢¦šã „«˜ ¨œå˜ª - “§¦¡˜«˜©«ã£˜«¦ª - •¨ã©žª"
36817>>>>>    Set Size to 111 372
36818>>>>>    Set Location to 60 40
36819>>>>>    Set Color to 12232306
36820>>>>>
36820>>>>>    //AB-DDOStart
36820>>>>>
36820>>>>>    Object Company_DD is a Company_DataDictionary
36822>>>>>
36822>>>>>        //AB-StoreStart
36822>>>>>        Set Foreign_Field_Options DD_KEYFIELD                   to DD_Clear_Field_Options DD_FindReq
36823>>>>>        Set Foreign_Field_Options DD_INDEXFIELD                 to DD_Clear_Field_Options DD_FindReq
36824>>>>>        Set Foreign_Field_Options Field Company.Company_Name    to DD_DisplayOnly
36825>>>>>        
36825>>>>>        
36825>>>>>        
36825>>>>>        //AB-StoreEnd
36825>>>>>
36825>>>>>    End_Object    // Company_DD
36826>>>>>
36826>>>>>    Object Branch_DD is a Branch_DataDictionary
36828>>>>>        Set DDO_Server to (Company_DD(self))
36829>>>>>
36829>>>>>        //AB-StoreStart
36829>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_Clear_Field_Options DD_FindReq
36830>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_Clear_Field_Options DD_FindReq
36831>>>>>        
36831>>>>>        Set Foreign_Field_Options DD_KEYFIELD   to DD_AutoFind_GE
36832>>>>>        Set Foreign_Field_Options DD_INDEXFIELD to DD_AutoFind_GE
36833>>>>>        
36833>>>>>        Set Foreign_Field_Options Field Branch.Branch_Name to DD_DisplayOnly
36834>>>>>        //AB-StoreEnd
36834>>>>>
36834>>>>>    End_Object    // Branch_DD
36835>>>>>
36835>>>>>    Object Year_DD is a Year_DataDictionary
36837>>>>>        Set DDO_Server to (Branch_DD(self))
36838>>>>>
36838>>>>>        //AB-StoreStart
36838>>>>>        
36838>>>>>        Set Field_Options Field Year.Year_Descr to DD_DisplayOnly
36839>>>>>        Set Field_Options Field Year.Year_Year to DD_AutoFind_GE
36840>>>>>        
36840>>>>>        Function Validate_Delete Returns Integer
36842>>>>>            Function_Return 1
36843>>>>>        End_Function
36844>>>>>        
36844>>>>>        //AB-StoreEnd
36844>>>>>
36844>>>>>    End_Object    // Year_DD
36845>>>>>
36845>>>>>    Set Main_DD to (Year_DD(self))
36846>>>>>    Set Server to (Year_DD(self))
36847>>>>>
36847>>>>>    //AB-DDOEnd
36847>>>>>
36847>>>>>    Object Company_Company_Code is a dbFormSub
36849>>>>>        Entry_Item Company.Company_code
36850>>>>>        Set Size to 13 71
36851>>>>>        Set Location to 9 112
36852>>>>>        Set Color to 12232306
36853>>>>>        Set Label_Col_Offset to 2
36854>>>>>        Set Label_Justification_Mode to jMode_Right
36855>>>>>        Set Prompt_Button_Mode to pb_PromptOn
36856>>>>>        Set Auto_Clear_Deo_State to FALSE
36857>>>>>        Set Enabled_State to FALSE
36858>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36859>>>>>        Set Item_Shadow_State Item 0 to TRUE
36860>>>>>        Set Shadow_State Item 0 to TRUE
36861>>>>>
36861>>>>>        //AB-StoreStart
36861>>>>>        
36861>>>>>        Set Prompt_Object to (sl001(Self))
36862>>>>>        
36862>>>>>        
36862>>>>>        //AB-StoreEnd
36862>>>>>
36862>>>>>    End_Object    // Company_Company_Code
36863>>>>>
36863>>>>>    Object Company_Company_Name is a dbFormSub
36865>>>>>        Entry_Item Company.Company_name
36866>>>>>        Set Size to 13 168
36867>>>>>        Set Location to 9 188
36868>>>>>        Set Color to 12232306
36869>>>>>        Set Label_Col_Offset to 2
36870>>>>>        Set Label_Justification_Mode to jMode_Right
36871>>>>>        Set Enabled_State to FALSE
36872>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36873>>>>>        Set Item_Shadow_State Item 0 to TRUE
36874>>>>>        Set Shadow_State Item 0 to TRUE
36875>>>>>
36875>>>>>        //AB-StoreStart
36875>>>>>        
36875>>>>>        //AB-StoreEnd
36875>>>>>
36875>>>>>    End_Object    // Company_Company_Name
36876>>>>>
36876>>>>>    Object Branch_Branch_Code is a dbFormSub
36878>>>>>        Entry_Item Branch.Branch_code
36879>>>>>        Set Size to 13 71
36880>>>>>        Set Location to 23 112
36881>>>>>        Set Color to 12232306
36882>>>>>        Set Label_Col_Offset to 2
36883>>>>>        Set Label_Justification_Mode to jMode_Right
36884>>>>>        Set Prompt_Button_Mode to pb_PromptOn
36885>>>>>        Set Auto_Clear_Deo_State to FALSE
36886>>>>>        Set Enabled_State to FALSE
36887>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36888>>>>>        Set Item_Shadow_State Item 0 to TRUE
36889>>>>>        Set Shadow_State Item 0 to TRUE
36890>>>>>
36890>>>>>        //AB-StoreStart
36890>>>>>        Set Prompt_Object to (sl002(Self))
36891>>>>>        
36891>>>>>        Procedure Prompt_CallBack Integer hPrompt
36893>>>>>            string lsCompanyCode
36894>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
36895>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
36896>>>>>        End_Procedure
36897>>>>>        
36897>>>>>        
36897>>>>>        
36897>>>>>        
36897>>>>>        //AB-StoreEnd
36897>>>>>
36897>>>>>    End_Object    // Branch_Branch_Code
36898>>>>>
36898>>>>>    Object Branch_Branch_Name is a dbFormSub
36900>>>>>        Entry_Item Branch.Branch_name
36901>>>>>        Set Size to 13 168
36902>>>>>        Set Location to 23 188
36903>>>>>        Set Color to 12232306
36904>>>>>        Set Label_Justification_Mode to jMode_Right
36905>>>>>        Set Enabled_State to FALSE
36906>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36907>>>>>        Set Item_Shadow_State Item 0 to TRUE
36908>>>>>        Set Shadow_State Item 0 to TRUE
36909>>>>>
36909>>>>>        //AB-StoreStart
36909>>>>>        
36909>>>>>        
36909>>>>>        //AB-StoreEnd
36909>>>>>
36909>>>>>    End_Object    // Branch_Branch_Name
36910>>>>>
36910>>>>>    Object Year_Year_Year is a dbFormSub
36912>>>>>        Entry_Item Year.Year_year
36913>>>>>        Set Size to 13 71
36914>>>>>        Set Location to 37 112
36915>>>>>        Set Label_Col_Offset to 2
36916>>>>>        Set Label_Justification_Mode to jMode_Right
36917>>>>>        Set Prompt_Button_Mode to pb_PromptOn
36918>>>>>        Set Auto_Clear_Deo_State to FALSE
36919>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36920>>>>>
36920>>>>>        //AB-StoreStart
36920>>>>>        Set Prompt_Object to (sl003(Self))
36921>>>>>        
36921>>>>>        Procedure Prompt_CallBack Integer hPrompt
36923>>>>>            String lsCompanyCode lsBranchCode
36924>>>>>            integer icheck
36924>>>>>            get checked_state of (chkxr(self)) to icheck
36925>>>>>            Get Field_Current_Value of Company_DD Field Company.Company_Code to lsCompanyCode
36926>>>>>            Get Field_Current_Value of Branch_DD  Field Branch.Branch_Code   to lsBranchCode
36927>>>>>            Set psFragmaCompanyCode of hPrompt to lsCompanyCode
36928>>>>>            Set psFragmaBranchCode  of hPrompt to lsBranchCode
36929>>>>>            set pifragmaactive      of hPrompt to icheck
36930>>>>>        End_Procedure
36931>>>>>        
36931>>>>>        
36931>>>>>        
36931>>>>>        
36931>>>>>        
36931>>>>>        
36931>>>>>        //AB-StoreEnd
36931>>>>>
36931>>>>>    End_Object    // Year_Year_Year
36932>>>>>
36932>>>>>    Object Year_Year_Descr is a dbFormSub
36934>>>>>        Entry_Item Year.Year_descr
36935>>>>>        Set Size to 13 168
36936>>>>>        Set Location to 37 188
36937>>>>>        Set Color to 12232306
36938>>>>>        Set Label_Col_Offset to 2
36939>>>>>        Set Label_Justification_Mode to jMode_Right
36940>>>>>        Set Enabled_State to FALSE
36941>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36942>>>>>        Set Item_Shadow_State Item 0 to TRUE
36943>>>>>        Set Shadow_State Item 0 to TRUE
36944>>>>>
36944>>>>>        //AB-StoreStart
36944>>>>>        
36944>>>>>        //AB-StoreEnd
36944>>>>>
36944>>>>>    End_Object    // Year_Year_Descr
36945>>>>>
36945>>>>>    Object Year_Year_Entrydate is a dbFormSub
36947>>>>>        Entry_Item Year.Year_entrydate
36948>>>>>        Set Size to 13 71
36949>>>>>        Set Location to 52 112
36950>>>>>        Set Label_Col_Offset to 2
36951>>>>>        Set Label_Justification_Mode to jMode_Right
36952>>>>>        Set Auto_Clear_Deo_State to FALSE
36953>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36954>>>>>    End_Object    // Year_Year_Entrydate
36955>>>>>
36955>>>>>    Object oOk_bn is a ButtonSub
36957>>>>>        Set Label to "€§¦›¦®ã (F2)"
36958>>>>>        Set Size to 17 54
36959>>>>>        Set Location to 74 188
36960>>>>>        Set Form_FontHeight Item 0 to 14
36961>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36962>>>>>
36962>>>>>        //AB-StoreStart
36962>>>>>        
36962>>>>>        Procedure OnClick
36964>>>>>            Delegate Send AcceptTheValues
36966>>>>>        End_Procedure
36967>>>>>        
36967>>>>>        
36967>>>>>        
36967>>>>>        
36967>>>>>        //AB-StoreEnd
36967>>>>>
36967>>>>>    End_Object    // oOk_bn
36968>>>>>
36968>>>>>    Object oCancel_bn is a ButtonSub
36970>>>>>        Set Label to "„¥¦›¦ª "
36971>>>>>        Set Size to 17 54
36972>>>>>        Set Location to 74 302
36973>>>>>        Set Form_FontHeight Item 0 to 14
36974>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
36975>>>>>
36975>>>>>        //AB-StoreStart
36975>>>>>        
36975>>>>>        Procedure OnClick
36977>>>>>           Send Exit_Application to oSelectYear
36978>>>>>        End_Procedure
36979>>>>>        
36979>>>>>        
36979>>>>>        
36979>>>>>        //AB-StoreEnd
36979>>>>>
36979>>>>>    End_Object    // oCancel_bn
36980>>>>>
36980>>>>>    Object otxtCompany is a TextBoxSub
36982>>>>>        Set Label to "„«˜ ¨œå˜"
36983>>>>>        Set Auto_Size_State to FALSE
36984>>>>>        Set Color to 12232306
36985>>>>>        Set FontSize to 14 8
36986>>>>>        Set Location to 9 10
36987>>>>>        Set Size to 10 35
36988>>>>>        Set FontWeight to 600
36989>>>>>        Set TypeFace to "MS Sans Serif"
36990>>>>>        Set Enabled_State to TRUE
36991>>>>>    End_Object    // otxtCompany
36992>>>>>
36992>>>>>    Object otxtBranch is a TextBoxSub
36994>>>>>        Set Label to "“§¦¡˜«˜©«ã£˜«˜"
36995>>>>>        Set Auto_Size_State to FALSE
36996>>>>>        Set Color to 12232306
36997>>>>>        Set FontSize to 14 8
36998>>>>>        Set Location to 23 10
36999>>>>>        Set Size to 10 63
37000>>>>>        Set FontWeight to 600
37001>>>>>        Set TypeFace to "MS Sans Serif"
37002>>>>>        Set Enabled_State to TRUE
37003>>>>>    End_Object    // otxtBranch
37004>>>>>
37004>>>>>    Object otxtYear is a TextBoxSub
37006>>>>>        Set Label to "•¨ã©ž :          "
37007>>>>>        Set Auto_Size_State to FALSE
37008>>>>>        Set Color to 12232306
37009>>>>>        Set FontSize to 14 8
37010>>>>>        Set Location to 38 10
37011>>>>>        Set Size to 10 40
37012>>>>>        Set FontWeight to 600
37013>>>>>        Set TypeFace to "MS Sans Serif"
37014>>>>>        Set Enabled_State to TRUE
37015>>>>>    End_Object    // otxtYear
37016>>>>>
37016>>>>>    Object otxtWorkingDay is a TextBoxSub
37018>>>>>        Set Label to "†£/¤å˜ „¨š˜©å˜ª"
37019>>>>>        Set Auto_Size_State to FALSE
37020>>>>>        Set Color to 12232306
37021>>>>>        Set FontSize to 14 8
37022>>>>>        Set Location to 52 10
37023>>>>>        Set Size to 10 63
37024>>>>>        Set FontWeight to 600
37025>>>>>        Set TypeFace to "MS Sans Serif"
37026>>>>>        Set Enabled_State to TRUE
37027>>>>>    End_Object    // otxtWorkingDay
37028>>>>>
37028>>>>>    Object otxtWorkingDay is a TextBoxSub
37030>>>>>        Set Label to "Ž¢œª ¦  ®¨ã©œ ª"
37031>>>>>        Set Auto_Size_State to FALSE
37032>>>>>        Set Color to 12232306
37033>>>>>        Set FontSize to 14 8
37034>>>>>        Set Location to 79 9
37035>>>>>        Set Size to 10 63
37036>>>>>        Set FontWeight to 600
37037>>>>>        Set TypeFace to "MS Sans Serif"
37038>>>>>        Set Enabled_State to TRUE
37039>>>>>    End_Object    // otxtWorkingDay
37040>>>>>
37040>>>>>    Object chkxr is a CheckBoxSub
37042>>>>>        Set Size to 13 22
37043>>>>>        Set Location to 79 113
37044>>>>>        Set Color to 12232306
37045>>>>>    End_Object    // chkxr
37046>>>>>
37046>>>>>
37046>>>>>    //AB-StoreStart
37046>>>>>    
37046>>>>>    On_Key Key_Ctrl+Key_X Send None
37047>>>>>    On_Key Key_Alt+Key_X  Send None
37048>>>>>    
37048>>>>>    Function ifSelect_Xrhsh Returns String
37050>>>>>        String  lsRecord_id
37051>>>>>        Set psSelectedYearRecr to gs_Selected_Year_Recr
37052>>>>>        send popup_modal
37053>>>>>        Get psSelectedYearRecr to lsRecord_id
37054>>>>>        Function_return lsRecord_Id
37055>>>>>    End_Function
37056>>>>>    
37056>>>>>    Procedure AcceptTheValues
37058>>>>>        Integer iRetVal liYearDD liCompanyDD liBranchDD
37059>>>>>        String ldcheck lsYearRecr lsSite sCname sBname sYname sNom1 sNom2 sNom3
37059>>>>>        Date ldYearXrhsh_From ldYearXrhsh_To
37059>>>>>        Move Year_DD to liYearDD
37060>>>>>        Get Field_Current_Value of liYearDD Field Year.Year_EntryDate to ldcheck
37061>>>>>        if (ldcheck = "") ;            Get Message_Box "ƒœ¤ œ§ ¢â¥˜«œ ©à©«ã ž£œ¨¦£ž¤å˜." "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
37064>>>>>        else begin
37065>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshFrom   to ldYearXrhsh_From
37066>>>>>            Get Field_Current_Value of liYearDD Field Year.Year_XrhshTo     to ldYearXrhsh_To
37067>>>>>            if ((ldcheck < ldYearXrhsh_From) or (ldcheck > ldYearXrhsh_To)) ;                Get Message_Box "†£œ¨/¤å˜ œ¡«éª ¦¨åà¤" "¨¦©¦®ã" MB_OK MB_ICONWARNING to iRetVal
37070>>>>>            else begin
37071>>>>>                Move Company_DD to liCompanyDD
37072>>>>>                Move Branch_DD  to liBranchDD
37073>>>>>                Move Year_DD    to liYearDD
37074>>>>>                send Request_Save to liYearDD
37075>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Code to gs_Selected_Company_Code
37076>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Code   to gs_Selected_Branch_Code
37077>>>>>    
37077>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Beto_Site   to gs_Selected_Beto_Site
37078>>>>>    
37078>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_Site   to lsSite
37079>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Year       to gi_Selected_Year
37080>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Recr       to lsYearRecr
37081>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code0    to sNom1
37082>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_Code00   to sNom2
37083>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_C_CodeR    to sNom3
37084>>>>>    
37084>>>>>                Get Field_Current_Value of liCompanyDD Field Company.Company_Name to sCname
37085>>>>>                Get Field_Current_Value of liBranchDD  Field Branch.Branch_name   to sBname
37086>>>>>                Get Field_Current_Value of liYearDD    Field Year.Year_Descr      to sYname
37087>>>>>    
37087>>>>>    
37087>>>>>                Local String    sCode
37087>>>>>                Local Integer   iBreak
37087>>>>>                Move 0 to iBreak
37088>>>>>                Clear Nomisma
37089>>>>>                Find Gt Nomisma.Recnum
37090>>>>>>
37090>>>>>                While ((Found=1) And (iBreak=0))
37094>>>>>                    If (Nomisma.Einai_Euro='1') Begin
37096>>>>>                        Move 1 to iBreak
37097>>>>>                        Move Nomisma.Nomisma_Code to sCode
37098>>>>>                    End
37098>>>>>>
37098>>>>>                    If (Not(iBreak)) Find Gt Nomisma.Recnum
37101>>>>>                Loop
37102>>>>>>
37102>>>>>                Move (Trim(sCode)) to sCode
37103>>>>>    
37103>>>>>    
37103>>>>>                Reread SysCurXR
37107>>>>>                Move gs_Selected_Company_Code   to SysCurXR.Company_Code
37108>>>>>                Move gs_Selected_beto_site      to SysCurXR.beto_site
37109>>>>>                Move gs_Selected_Branch_Code    to SysCurXR.Branch_Code
37110>>>>>                Move gi_Selected_Year           to SysCurXR.Year_Year
37111>>>>>                Move lsYearRecr                 to SysCurXR.Year_Recr
37112>>>>>                Move lsSite                     to SysCurXR.Branch_Site
37113>>>>>    
37113>>>>>                Move sCname                     to SysCurXR.Company_Name
37114>>>>>                Move sBname                     to SysCurXR.Branch_Name
37115>>>>>                Move sYname                     to SysCurXR.Year_Descr
37116>>>>>    
37116>>>>>                Move ldYearXrhsh_From           to SysCurXr.Year_XrhshFrom
37117>>>>>                Move ldYearXrhsh_To             to SysCurXr.Year_XrhshTo
37118>>>>>    
37118>>>>>                Move  (Trim(sNom1))             to SysCurXR.C_Code0
37119>>>>>                Move  (Trim(sNom2))             to SysCurXR.C_Code00
37120>>>>>                Move  (Trim(sNom3))             to SysCurXR.C_CodeR
37121>>>>>    
37121>>>>>                Move sCode                      to SysCurXR.Euro_Code
37122>>>>>    
37122>>>>>                Saverecord SysCurXR
37123>>>>>                Unlock
37124>>>>>>
37124>>>>>    
37124>>>>>                Move lsYearRecr                 to gs_Selected_Year_Recr
37125>>>>>                Set psSelectedYearRecr          to lsYearRecr
37126>>>>>    
37126>>>>>                Send Stop_Modal_ui
37127>>>>>    
37127>>>>>                Set kEnter_Next_State of ghoWorkSpace to TRUE
37128>>>>>            End
37128>>>>>>
37128>>>>>        end
37128>>>>>>
37128>>>>>    End_Procedure
37129>>>>>    
37129>>>>>    Set Locate_Mode to Center_On_Screen
37130>>>>>    
37130>>>>>    On_Key KCancel      Send KeyAction to (oCancel_Bn(Self))
37131>>>>>    On_Key KClose_Panel Send KeyAction to (oCancel_Bn(Self))
37132>>>>>    On_Key Ksave_record send KeyAction to (oOK_Bn(Self))
37133>>>>>    
37133>>>>>    On_Key Key_alt+Key_A send KeyAction to (oOK_Bn(Self))
37134>>>>>    On_Key Key_alt+Key_Q send KeyAction to (oCancel_Bn(Self))
37135>>>>>    
37135>>>>>    
37135>>>>>    
37135>>>>>    
37135>>>>>    
37135>>>>>    
37135>>>>>    
37135>>>>>    //AB-StoreEnd
37135>>>>>
37135>>>>>End_Object    // oSelectYear
37136>>>>>
37136>>>>>
37136>>>>>//AB-StoreStart
37136>>>>>
37136>>>>>
37136>>>>>//AB-StoreEnd
37136>>>>>
37136>>>>>//AB/ End_Object    // prj
37136>>>
37136>>>Procedure Epelexe_Xrhsh
37137>>>    Integer liCompanyDD liBranchDD liYearDD liYear liModalId
37138>>>    String lsCompany lsBranch lsWhatXrhsh
37138>>>    Move oSelectYear to liModalId
37139>>>    Get ifSelect_Xrhsh Of liModalId to lsWhatXrhsh
37140>>>    if (Trim(lsWhatXrhsh)='') Send Exit_Application
37143>>>End_Procedure
37144>>>
37144>>>Procedure Allaxe_Xrhsh
37145>>>    Integer rVal liModalId iID
37146>>>    If (Close_All_Views(Self,True)=0) Begin
37148>>>        Move oSelectYear to liModalId
37149>>>        Send Epelexe_Xrhsh
37150>>>    End
37150>>>>
37150>>>End_Procedure
37151>>>
37151>>>On_Key Key_Ctrl+Key_X Send Allaxe_Xrhsh
37152>>>On_Key Key_Alt+Key_X  Send Allaxe_Xrhsh
37153>>>
37153>>>Send Epelexe_Xrhsh
37154>>>//------------------------------
37154>>>
37154>
37154>
37154>Use vsapdomikh.vw
INCLUDING FILE: VSAPDOMIKH.VW
37154>>>//AB/ Project Vsapdomikh:eksagogh eggrafon gia Sap
37154>>>//AB/ Object prj is a View_Project
37154>>>//AB/     Set ProjectName to "Vsapdomikh:eksagogh eggrafon gia Sap"
37154>>>//AB/     Set ProjectFileName to "Vsapdomikh.VW"
37154>>>//AB/     Set GenerateFileName to "NONAME"
37154>>>
37154>>>// Project Object Structure
37154>>>//   Vsapdomikh is a dbViewSubs
37154>>>//     Clients_DD is a DataDictionary
37154>>>//     Tempitel_DD is a DataDictionary
37154>>>//     Tempitem_DD is a DataDictionary
37154>>>//     frmapo is a FormSub
37154>>>//     RadioGroupSub1 is a RadioGroupSub
37154>>>//       Radio1 is a RadioSub
37154>>>//       Radio3 is a RadioSub
37154>>>//       RadioSub1 is a RadioSub
37154>>>//       RadioSub4 is a RadioSub
37154>>>//       RadioSub5 is a RadioSub
37154>>>//       RadioSub6 is a RadioSub
37154>>>//       Radio7 is a RadioSub
37154>>>//     btnMetasx is a ButtonSub
37154>>>//     btnekt is a ButtonSub
37154>>>//     frmShow is a ButtonSub
37154>>>//     ButtonSub1 is a ButtonSub
37154>>>//     Textbox1 is a Textbox
37154>>>//     btnPartl is a ButtonSub
37154>>>//     frmPath is a FormSub
37154>>>//     TextBoxSub1 is a TextBoxSub
37154>>>//     frmPassw is a FormSub
37154>>>//     chkLog is a CheckBoxSub
37154>>>//     oDirectoryPicker is a OLEDPDlg
37154>>>
37154>>>// Register all objects
37154>>>Register_Object ButtonSub1
37154>>>Register_Object btnekt
37154>>>Register_Object btnMetasx
37154>>>Register_Object btnPartl
37154>>>Register_Object Clients_DD
37154>>>Register_Object chkLog
37154>>>Register_Object frmapo
37154>>>Register_Object frmPassw
37154>>>Register_Object frmPath
37154>>>Register_Object frmShow
37154>>>Register_Object oDirectoryPicker
37154>>>Register_Object Radio1
37154>>>Register_Object Radio3
37154>>>Register_Object Radio7
37154>>>Register_Object RadioGroupSub1
37154>>>Register_Object RadioSub1
37154>>>Register_Object RadioSub4
37154>>>Register_Object RadioSub5
37154>>>Register_Object RadioSub6
37154>>>Register_Object Tempitel_DD
37154>>>Register_Object Tempitem_DD
37154>>>Register_Object TextBoxSub1
37154>>>Register_Object Textbox1
37154>>>Register_Object Vsapdomikh
37154>>>
37154>>>
37154>>>//AB/ AppBuild VIEW
37154>>>
37154>>>
37154>>>//AB-StoreTopStart
37154>>>open    wflagkin
INCLUDING FILE: WFLAGKIN.FD
37156>>>open    TmpclSap
INCLUDING FILE: TMPCLSAP.FD
37158>>>Open    Wapokat
INCLUDING FILE: WAPOKAT.FD
37160>>>Open    Wtypkin
37162>>>Open    Wcmoves
INCLUDING FILE: WCMOVES.FD
37164>>>Open    sysfile
37166>>>Open    codemast
37168>>>Open    cities
37170>>>Use     rclsap.rv
INCLUDING FILE: RCLSAP.RV
37170>>>>>//AB/ Project Rclsap:ektyposh pelatonsap
37170>>>>>//AB/ Object prj is a Report_Project
37170>>>>>//AB/     Set ProjectName to "Rclsap:ektyposh pelatonsap"
37170>>>>>//AB/     Set ProjectFileName to "Rclsap.RV"
37170>>>>>
37170>>>>>// Project Object Structure
37170>>>>>//   Rclsap is a ReportView
37170>>>>>//     DestRadio is a RadioGroup
37170>>>>>//       WindowRadio is a Radio
37170>>>>>//     ButtonSub1 is a Button
37170>>>>>//     ButtonSub3 is a ButtonSub
37170>>>>>//     prom1WQLReport is a crystalreportSubSQL
37170>>>>>
37170>>>>>// Register all objects
37170>>>>>Register_Object ButtonSub1
37170>>>>>Register_Object ButtonSub3
37170>>>>>Register_Object DestRadio
37170>>>>>Register_Object prom1WQLReport
37170>>>>>Register_Object Rclsap
37170>>>>>Register_Object WindowRadio
37170>>>>>
37170>>>>>
37170>>>>>//AB/ Report View
37170>>>>>
37170>>>>>
37170>>>>>//AB-StoreTopStart
37170>>>>>Use dfallrpt
37170>>>>>//AB-StoreTopEnd
37170>>>>>
37170>>>>>//AB-IgnoreStart
37170>>>>>
37170>>>>>Use DFAllEnt.pkg
37170>>>>>Use Button.Sub
37170>>>>>
37170>>>>>//AB-IgnoreEnd
37170>>>>>
37170>>>>>ACTIVATE_VIEW Activate_Rclsap FOR Rclsap
37173>>>>>
37173>>>>>Object Rclsap is a ReportView
37175>>>>>
37175>>>>>    //AB-StoreTopStart
37175>>>>>    property integer piti public 0
37177>>>>>    property date pddate public ''
37179>>>>>    
37179>>>>>    //AB-StoreTopEnd
37179>>>>>
37179>>>>>    Set Label to "ts.ektyposh_paraggelias_promhtheyth"
37180>>>>>    Set Size to 48 191
37181>>>>>    Set Location to 9 165
37182>>>>>
37182>>>>>    //AB-DDOStart
37182>>>>>
37182>>>>>
37182>>>>>    //AB-DDOEnd
37182>>>>>
37182>>>>>    Object DestRadio is a RadioGroup
37184>>>>>
37184>>>>>        //AB-StoreTopStart
37184>>>>>                                            
37184>>>>>        //AB-StoreTopEnd
37184>>>>>
37184>>>>>        Set Label to "tz.ektyposh"
37185>>>>>        Set Size to 29 49
37186>>>>>        Set Location to 2 1
37187>>>>>        Object WindowRadio is a Radio
37189>>>>>            Set Size to 13 30
37190>>>>>            Set Location to 12 12
37191>>>>>            Set Bitmap to "screen4.bmp"
37192>>>>>        End_Object    // WindowRadio
37193>>>>>
37193>>>>>
37193>>>>>        //AB-StoreStart
37193>>>>>        set visible_state of (destradio(self)) to false
37194>>>>>        Set Output_Device_Mode To WQL_PRINT_TO_WINDOW
37195>>>>>        
37195>>>>>        //AB-StoreEnd
37195>>>>>
37195>>>>>    End_Object    // DestRadio
37196>>>>>
37196>>>>>    Object ButtonSub1 is a Button
37198>>>>>
37198>>>>>        //AB-StoreTopStart
37198>>>>>                                            
37198>>>>>        //AB-StoreTopEnd
37198>>>>>
37198>>>>>        Set Bitmap to "RUNPROG.BMP"
37199>>>>>        Set Size to 18 29
37200>>>>>        Set Location to 6 55
37201>>>>>
37201>>>>>        //AB-StoreStart
37201>>>>>        Procedure OnClick
37203>>>>>           Send Runprom1report To (prom1WQLReport(Current_Object))
37204>>>>>        End_Procedure
37205>>>>>        
37205>>>>>        //AB-StoreEnd
37205>>>>>
37205>>>>>    End_Object    // ButtonSub1
37206>>>>>
37206>>>>>    Object ButtonSub3 is a ButtonSub
37208>>>>>
37208>>>>>        //AB-StoreTopStart
37208>>>>>                                            
37208>>>>>        //AB-StoreTopEnd
37208>>>>>
37208>>>>>        Set Bitmap to "CANCEL.BMP"
37209>>>>>        Set Size to 18 29
37210>>>>>        Set Location to 6 89
37211>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
37212>>>>>
37212>>>>>        //AB-StoreStart
37212>>>>>        Procedure OnClick
37214>>>>>            Send Request_Cancel
37215>>>>>        End_Procedure
37216>>>>>        
37216>>>>>        //AB-StoreEnd
37216>>>>>
37216>>>>>    End_Object    // ButtonSub3
37217>>>>>
37217>>>>>
37217>>>>>    //AB-StoreStart
37217>>>>>    
37217>>>>>    Object prom1WQLReport Is A crystalreportSubSQL
37219>>>>>         Property Integer ReportReady Public False
37221>>>>>         Set Report_View_id To (Parent(Current_object))
37222>>>>>         Procedure OnStartPrinting
37224>>>>>             Local String  Selection FileName lsdate sitem spay  stype
37225>>>>>             local number  nypoprosf npelates ncn
37225>>>>>             Local Integer FileType Destination SortOrder NumSortFields CurSortField
37225>>>>>             Local Integer SortDirection ifrom datefrom istadio
37225>>>>>             date dapo
37225>>>>>             get pddate to dapo
37226>>>>>             move '9999' to stype
37227>>>>>             move (trim(stype)) to stype
37228>>>>>             if (piti(self)=2) begin
37230>>>>>                Set Formula "fapo"  To (winql_date(dapo))
37231>>>>>             end
37231>>>>>>
37231>>>>>             if (piti(self)=3) begin
37233>>>>>                Set Formula "fapo"  To (winql_date(dapo))
37234>>>>>             end
37234>>>>>>
37234>>>>>             if (piti(self)=4) begin
37236>>>>>                Set Formula "fapo"  To (winql_date(dapo))
37237>>>>>             end
37237>>>>>>
37237>>>>>    
37237>>>>>             if (piti(self)=5) begin
37239>>>>>                Set Formula "fapo"  To (winql_date(dapo))
37240>>>>>             end
37240>>>>>>
37240>>>>>    
37240>>>>>             if (piti(self)=6) begin
37242>>>>>                Set Formula "fapo"  To (winql_date(dapo))
37243>>>>>             end
37243>>>>>>
37243>>>>>    
37243>>>>>             if (piti(self)=7) begin
37245>>>>>                Set Formula "fafm"  To (winql_number(1))
37246>>>>>             end
37246>>>>>>
37246>>>>>             if (piti(self)=1) begin
37248>>>>>                Set Formula "fafm"  To (winql_number(0))
37249>>>>>             end
37249>>>>>>
37249>>>>>              //*** Setup the selection formula
37249>>>>>                move WQL_PRINT_TO_WINDOW to destination
37250>>>>>                If Destination EQ WQL_PRINT_TO_WINDOW ;                    Set ReportReady To False
37253>>>>>                Else ;                    Set ReportReady To True
37255>>>>>        End_procedure // OnStartPrinting
37256>>>>>    
37256>>>>>        Procedure Runprom1Report
37258>>>>>     //       Send Cursor_Wait To (Cursor_Control(Current_Object))
37258>>>>>            if (piti(self)=1);                set Report_name    To "Rclsap.rpt"
37261>>>>>            else if (piti(self)=2);                set Report_name    To "Reispsap.rpt"
37265>>>>>            else if (piti(self)=3);                set Report_name    To "Rtimsap.rpt"
37269>>>>>            else if (piti(self)=4);                set Report_name    To "Rapothsap.rpt"
37273>>>>>            else if (piti(self)=5);                set Report_name    To "Rtehnsap.rpt"
37277>>>>>            else if (piti(self)=6);                set Report_name    To "Ranalsap.rpt"
37281>>>>>             if (piti(self)=7);                set Report_name    To "Rclsap.rpt"
37284>>>>>            Send Run_report
37285>>>>>    //        Send Cursor_Ready To (Cursor_Control(Current_Object))
37285>>>>>            If (ReportReady(Current_object)) ;                Send Info_box "WinQL report ready."
37288>>>>>        End_procedure //
37289>>>>>    
37289>>>>>    End_object
37290>>>>>    
37290>>>>>    
37290>>>>>    
37290>>>>>    
37290>>>>>    
37290>>>>>    //AB-StoreEnd
37290>>>>>
37290>>>>>End_Object    // Rclsap
37291>>>>>
37291>>>>>
37291>>>>>//AB-StoreStart
37291>>>>>    
37291>>>>>//AB-StoreEnd
37291>>>>>
37291>>>>>//AB/ End_Object    // prj
37291>>>Open    Clients
37293>>>Use     Vwsap.vw
INCLUDING FILE: VWSAP.VW
37293>>>>>//AB/ Project Vwsap
37293>>>>>//AB/     Object prj is a View_Project
37293>>>>>//AB/         Set ProjectName to "Vwsap"
37293>>>>>//AB/         Set ProjectFileName to "Vwsap.vw"
37293>>>>>//AB/         Set GenerateFileName to "Vwsap.vw"
37293>>>>>
37293>>>>>// Project Object Structure
37293>>>>>//   Vwsap is a dbView
37293>>>>>//     oInternetErrorArray is a Array
37293>>>>>//     Tmpsap_DD is a DataDictionary
37293>>>>>//     frmPassw is a FormSub
37293>>>>>//     frmHmnia is a cSyDateForm
37293>>>>>//     btnDelete is a ButtonSub
37293>>>>>//     btnSend is a ButtonSub
37293>>>>>//     TextBoxSub1 is a TextBoxSub
37293>>>>>//     The_Table is a dbGrid
37293>>>>>//     btnMess is a ButtonSub
37293>>>>>//     TextBoxSub2 is a TextBoxSub
37293>>>>>//     frmAddress is a FormSub
37293>>>>>//     frmConn is a FormSub
37293>>>>>//     frmUserName is a FormSub
37293>>>>>//     frmPassword is a FormSub
37293>>>>>//     frmDirectory is a FormSub
37293>>>>>//     TextBoxSub3 is a TextBoxSub
37293>>>>>//     TextBoxSub4 is a TextBoxSub
37293>>>>>//     frmMessage is a FormSub
37293>>>>>//     oStatusForm is a EditSub
37293>>>>>
37293>>>>>// Register all objects
37293>>>>>Register_Object btnDelete
37293>>>>>Register_Object btnMess
37293>>>>>Register_Object btnSend
37293>>>>>Register_Object frmAddress
37293>>>>>Register_Object frmConn
37293>>>>>Register_Object frmDirectory
37293>>>>>Register_Object frmHmnia
37293>>>>>Register_Object frmMessage
37293>>>>>Register_Object frmPassw
37293>>>>>Register_Object frmPassword
37293>>>>>Register_Object frmUserName
37293>>>>>Register_Object oInternetErrorArray
37293>>>>>Register_Object oStatusForm
37293>>>>>Register_Object TextBoxSub1
37293>>>>>Register_Object TextBoxSub2
37293>>>>>Register_Object TextBoxSub3
37293>>>>>Register_Object TextBoxSub4
37293>>>>>Register_Object The_Table
37293>>>>>Register_Object Tmpsap_DD
37293>>>>>Register_Object Vwsap
37293>>>>>
37293>>>>>
37293>>>>>//AB/     AppBuild VIEW
37293>>>>>
37293>>>>>
37293>>>>>    //AB-StoreTopStart
37293>>>>>                            
37293>>>>>    Open Particle
INCLUDING FILE: PARTICLE.FD
37295>>>>>    Open Cmoves
INCLUDING FILE: CMOVES.FD
37297>>>>>    Open wcmoves
37299>>>>>    Open WitemxTr
INCLUDING FILE: WITEMXTR.FD
37301>>>>>    Open ItemTehn
INCLUDING FILE: ITEMTEHN.FD
37303>>>>>    Use Keimeno.dg
INCLUDING FILE: KEIMENO.DG
37303>>>>>>>//AB/ Project keimeno
37303>>>>>>>//AB/     Object prj is a Dialog_Project
37303>>>>>>>//AB/         Set ProjectName to "keimeno"
37303>>>>>>>//AB/         Set ProjectFileName to "Keimeno.dg"
37303>>>>>>>
37303>>>>>>>// Project Object Structure
37303>>>>>>>//   keimeno is a BasicPanelSub
37303>>>>>>>//     EditSub1 is a EditSub
37303>>>>>>>
37303>>>>>>>// Register all objects
37303>>>>>>>Register_Object EditSub1
37303>>>>>>>Register_Object keimeno
37303>>>>>>>
37303>>>>>>>
37303>>>>>>>    //AB-IgnoreStart
37303>>>>>>>
37303>>>>>>>    Use Panel.Sub
37303>>>>>>>    Use Edit.Sub
37303>>>>>>>
37303>>>>>>>    //AB-IgnoreEnd
37303>>>>>>>
37303>>>>>>>
37303>>>>>>>    //AB-IgnoreEnd
37303>>>>>>>
37303>>>>>>>    Object keimeno is a BasicPanelSub
37305>>>>>>>
37305>>>>>>>        //AB-StoreTopStart
37305>>>>>>>
37305>>>>>>>        //AB-StoreTopEnd
37305>>>>>>>
37305>>>>>>>        Set Minimize_Icon to FALSE
37306>>>>>>>        Set Label to "‰œå£œ¤¦"
37307>>>>>>>        Set Size to 170 449
37308>>>>>>>        Set Location to 3 20
37309>>>>>>>        Set Exit_Application_Local_State to TRUE
37310>>>>>>>        Set Popup_State to TRUE
37311>>>>>>>
37311>>>>>>>        //AB-DDOStart
37311>>>>>>>
37311>>>>>>>
37311>>>>>>>        //AB-DDOEnd
37311>>>>>>>
37311>>>>>>>        Object EditSub1 is a editSub
37313>>>>>>>
37313>>>>>>>            //AB-StoreTopStart
37313>>>>>>>
37313>>>>>>>            //AB-StoreTopEnd
37313>>>>>>>
37313>>>>>>>            Set Size to 147 437
37314>>>>>>>            Set Location to 4 5
37315>>>>>>>            Set Color to 15400959
37316>>>>>>>            Set File_Name to "ErrText.log"
37317>>>>>>>            Set Read_Only_State to TRUE
37318>>>>>>>
37318>>>>>>>            //AB-StoreStart
37318>>>>>>>            Send DoRegAlign Self amtopleft
37319>>>>>>>            Send DoRegSize  Self smbottomright
37320>>>>>>>            //AB-StoreEnd
37320>>>>>>>
37320>>>>>>>        End_Object    // EditSub1
37321>>>>>>>
37321>>>>>>>
37321>>>>>>>        //AB-StoreStart
37321>>>>>>>        Set Minimize_Icon to True
37322>>>>>>>        Set Maximize_Icon to True
37323>>>>>>>        Set Border_Style to Border_Thick
37324>>>>>>>        //AB-StoreEnd
37324>>>>>>>
37324>>>>>>>    End_Object    // keimeno
37325>>>>>>>
37325>>>>>>>//AB/     End_Object    // prj
37325>>>>>    
37325>>>>>    //AB-StoreTopEnd
37325>>>>>
37325>>>>>    //AB-IgnoreStart
37325>>>>>
37325>>>>>    Use DFAllEnt.pkg
37325>>>>>    Use Form.Sub
37325>>>>>    Use cSyDateForm.Pkg
INCLUDING FILE: CSYDATEFORM.PKG
37325>>>>>>>Use cSyDateIntelliMix.pkg
INCLUDING FILE: CSYDATEINTELLIMIX.PKG
37325>>>>>>>>>Use cOutlook.Sl // Needed for date prompt.
INCLUDING FILE: COUTLOOK.SL
37325>>>>>>>>>>>//AB/ Project Calendar Outlook
37325>>>>>>>>>>>//AB/     Object prj is a Lookup_Project
37325>>>>>>>>>>>//AB/         Set ProjectName to "Calendar Outlook"
37325>>>>>>>>>>>//AB/         Set ProjectFileName to "coutlook.sl"
37325>>>>>>>>>>>
37325>>>>>>>>>>>// Project Object Structure
37325>>>>>>>>>>>//   oCalendar is a BasicPanelSub
37325>>>>>>>>>>>//     Container3d1 is a Container3d
37325>>>>>>>>>>>//       Grid2 is a Grid
37325>>>>>>>>>>>//         cOutlookFloatingMenu is a FloatingPopupMenu
37325>>>>>>>>>>>//       Textbox2 is a Textbox
37325>>>>>>>>>>>//       Textbox3 is a Textbox
37325>>>>>>>>>>>//       Textbox4 is a Textbox
37325>>>>>>>>>>>//       Textbox5 is a Textbox
37325>>>>>>>>>>>//       Textbox6 is a Textbox
37325>>>>>>>>>>>//       Textbox7 is a Textbox
37325>>>>>>>>>>>//       Textbox8 is a Textbox
37325>>>>>>>>>>>//       LineControl1 is a LineControl
37325>>>>>>>>>>>//       Container3d2 is a Container3d
37325>>>>>>>>>>>//         oRght is a BitmapContainer
37325>>>>>>>>>>>//         oLeft is a BitmapContainer
37325>>>>>>>>>>>//         oMonth is a Textbox
37325>>>>>>>>>>>//           oSelectMonth is a FloatingPopupMenu
37325>>>>>>>>>>>//         oCalendarYear is a Textbox
37325>>>>>>>>>>>//         oSelectCalendarYear is a Form
37325>>>>>>>>>>>//     BitmapContainer3 is a BitmapContainer
37325>>>>>>>>>>>//     oToday is a Textbox
37325>>>>>>>>>>>//     oCloseCalendar_bn is a BitmapContainer
37325>>>>>>>>>>>//     Help_Container is a Container3d
37325>>>>>>>>>>>//       Help_Info is a Edit
37325>>>>>>>>>>>//         HelpFloatingMenu is a FloatingPopupMenu
37325>>>>>>>>>>>
37325>>>>>>>>>>>// Register all objects
37325>>>>>>>>>>>Register_Object BitmapContainer3
37325>>>>>>>>>>>Register_Object Container3d1
37325>>>>>>>>>>>Register_Object Container3d2
37325>>>>>>>>>>>Register_Object cOutlookFloatingMenu
37325>>>>>>>>>>>Register_Object Grid2
37325>>>>>>>>>>>Register_Object Help_Container
37325>>>>>>>>>>>Register_Object Help_Info
37325>>>>>>>>>>>Register_Object HelpFloatingMenu
37325>>>>>>>>>>>Register_Object LineControl1
37325>>>>>>>>>>>Register_Object oCalendar
37325>>>>>>>>>>>Register_Object oCalendarYear
37325>>>>>>>>>>>Register_Object oCloseCalendar_bn
37325>>>>>>>>>>>Register_Object oLeft
37325>>>>>>>>>>>Register_Object oMonth
37325>>>>>>>>>>>Register_Object oRght
37325>>>>>>>>>>>Register_Object oSelectCalendarYear
37325>>>>>>>>>>>Register_Object oSelectMonth
37325>>>>>>>>>>>Register_Object oToday
37325>>>>>>>>>>>Register_Object Textbox2
37325>>>>>>>>>>>Register_Object Textbox3
37325>>>>>>>>>>>Register_Object Textbox4
37325>>>>>>>>>>>Register_Object Textbox5
37325>>>>>>>>>>>Register_Object Textbox6
37325>>>>>>>>>>>Register_Object Textbox7
37325>>>>>>>>>>>Register_Object Textbox8
37325>>>>>>>>>>>
37325>>>>>>>>>>>
37325>>>>>>>>>>>
37325>>>>>>>>>>>    //AB-StoreTopStart
37325>>>>>>>>>>>    Use dates.utl
37325>>>>>>>>>>>
37325>>>>>>>>>>>
37325>>>>>>>>>>>    //AB-StoreTopEnd
37325>>>>>>>>>>>
37325>>>>>>>>>>>    //AB-IgnoreStart
37325>>>>>>>>>>>
37325>>>>>>>>>>>    Use Panel.Sub
37325>>>>>>>>>>>    Use DFAllEnt.pkg
37325>>>>>>>>>>>
37325>>>>>>>>>>>
37325>>>>>>>>>>>
37325>>>>>>>>>>>    //AB-IgnoreEnd
37325>>>>>>>>>>>
37325>>>>>>>>>>>    Object oCalendar is a BasicPanelSub
37327>>>>>>>>>>>        Set Border_Style to Border_Normal
37328>>>>>>>>>>>        Set Caption_Bar to FALSE
37329>>>>>>>>>>>        Set Label to "January, 2001"
37330>>>>>>>>>>>        Set Size to 98 123
37331>>>>>>>>>>>        Set Location to 10 22
37332>>>>>>>>>>>        Set Color to clWhite
37333>>>>>>>>>>>        Set Exit_Application_Local_State to TRUE
37334>>>>>>>>>>>        Set Popup_State to TRUE
37335>>>>>>>>>>>
37335>>>>>>>>>>>        //AB-DDOStart
37335>>>>>>>>>>>
37335>>>>>>>>>>>
37335>>>>>>>>>>>        //AB-DDOEnd
37335>>>>>>>>>>>
37335>>>>>>>>>>>        Object Container3d1 is a Container3d
37337>>>>>>>>>>>            Set Size to 88 135
37338>>>>>>>>>>>            Set Location to -2 -1
37339>>>>>>>>>>>            Set Color to clWhite
37340>>>>>>>>>>>            Set Border_Style to Border_None
37341>>>>>>>>>>>            Object Grid2 is a Grid
37343>>>>>>>>>>>
37343>>>>>>>>>>>                //AB-StoreTopStart
37343>>>>>>>>>>>                property date    p_current_date     0
37345>>>>>>>>>>>                property integer p_current_year     -1
37347>>>>>>>>>>>                property integer p_current_month    -1
37349>>>>>>>>>>>                property integer p_selected_day     -1
37351>>>>>>>>>>>                property integer pExportState       1
37353>>>>>>>>>>>                property integer invoking_object_id 0
37355>>>>>>>>>>>                Property integer piCurrentDayItem   -1
37357>>>>>>>>>>>
37357>>>>>>>>>>>                Set Border_Style To BORDER_NONE
37358>>>>>>>>>>>                Set header_visible_state To False
37359>>>>>>>>>>>                set select_mode to no_select
37360>>>>>>>>>>>                Set Gridline_mode To GRID_VISIBLE_NONE
37361>>>>>>>>>>>
37361>>>>>>>>>>>                on_key Key_F1 Send Help
37362>>>>>>>>>>>                on_key key_ctrl+key_pgup send prev_year
37363>>>>>>>>>>>                on_key key_ctrl+key_pgdn send next_year
37364>>>>>>>>>>>                on_key          key_pgup send prev_month
37365>>>>>>>>>>>                on_key          key_pgdn send next_month
37366>>>>>>>>>>>                on_key key_enter         send move_value_out
37367>>>>>>>>>>>                on_key key_ctrl+key_d    send go_today
37368>>>>>>>>>>>                on_key key_ctrl+key_y    send Change_Year
37369>>>>>>>>>>>
37369>>>>>>>>>>>                //AB-StoreTopEnd
37369>>>>>>>>>>>
37369>>>>>>>>>>>                Set Color to clWhite
37370>>>>>>>>>>>                Set CurrentCellColor to clWhite
37371>>>>>>>>>>>                Set CurrentCellTextColor to clWhite
37372>>>>>>>>>>>                Set Size to 61 145
37373>>>>>>>>>>>                Set Location to 30 1
37374>>>>>>>>>>>                Set Resize_Column_state to FALSE
37375>>>>>>>>>>>
37375>>>>>>>>>>>                Set Line_Width to 7 0
37376>>>>>>>>>>>
37376>>>>>>>>>>>                Set Form_Width    item 0 to 18
37377>>>>>>>>>>>                Set Header_Label  item 0 to "Mo"
37378>>>>>>>>>>>
37378>>>>>>>>>>>                Set Form_Width    item 1 to 18
37379>>>>>>>>>>>                Set Header_Label  item 1 to "Tu"
37380>>>>>>>>>>>
37380>>>>>>>>>>>                Set Form_Width    item 2 to 18
37381>>>>>>>>>>>                Set Header_Label  item 2 to "We"
37382>>>>>>>>>>>
37382>>>>>>>>>>>                Set Form_Width    item 3 to 18
37383>>>>>>>>>>>                Set Header_Label  item 3 to "Th"
37384>>>>>>>>>>>
37384>>>>>>>>>>>                Set Form_Width    item 4 to 18
37385>>>>>>>>>>>                Set Header_Label  item 4 to "Fr"
37386>>>>>>>>>>>
37386>>>>>>>>>>>                Set Form_Width    item 5 to 18
37387>>>>>>>>>>>                Set Header_Label  item 5 to "Sa"
37388>>>>>>>>>>>
37388>>>>>>>>>>>                Set Form_Width    item 6 to 18
37389>>>>>>>>>>>                Set Header_Label  item 6 to "Su"
37390>>>>>>>>>>>
37390>>>>>>>>>>>
37390>>>>>>>>>>>                //AB-StoreStart
37390>>>>>>>>>>>
37390>>>>>>>>>>>                Procedure Change_Year
37392>>>>>>>>>>>                    Send Mouse_Down to (oCalendarYear(Container3d2(Self)))
37393>>>>>>>>>>>                End_Procedure // Change_Year
37394>>>>>>>>>>>
37394>>>>>>>>>>>                procedure go_today
37396>>>>>>>>>>>                    Date date#
37397>>>>>>>>>>>                    sysdate4 date#
37398>>>>>>>>>>>                    set p_current_date to date#
37399>>>>>>>>>>>                    Send Update_Calendar
37400>>>>>>>>>>>                end_procedure
37401>>>>>>>>>>>
37401>>>>>>>>>>>                procedure next_month
37403>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,1))
37404>>>>>>>>>>>                    Send Update_Calendar
37405>>>>>>>>>>>                end_procedure
37406>>>>>>>>>>>
37406>>>>>>>>>>>                procedure prev_month
37408>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_MONTH,-1))
37409>>>>>>>>>>>                    Send Update_Calendar
37410>>>>>>>>>>>                end_procedure
37411>>>>>>>>>>>
37411>>>>>>>>>>>                procedure next_year
37413>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,1))
37414>>>>>>>>>>>                    Send Update_Calendar
37415>>>>>>>>>>>                end_procedure
37416>>>>>>>>>>>
37416>>>>>>>>>>>                procedure prev_year
37418>>>>>>>>>>>                    set p_current_date to (DateIncrement(p_current_date(current_object),DS_YEAR,-1))
37419>>>>>>>>>>>                    Send Update_Calendar
37420>>>>>>>>>>>                end_procedure
37421>>>>>>>>>>>
37421>>>>>>>>>>>                Procedure Activate
37423>>>>>>>>>>>                    Date date#
37424>>>>>>>>>>>                    Forward Send Activate
37426>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
37427>>>>>>>>>>>                End_Procedure
37428>>>>>>>>>>>
37428>>>>>>>>>>>                Procedure Update_Calendar
37430>>>>>>>>>>>                    Set Dynamic_Update_State To False
37431>>>>>>>>>>>                    send Fill_List
37432>>>>>>>>>>>                    Set Dynamic_Update_State To True
37433>>>>>>>>>>>                    // Send Update_Label
37433>>>>>>>>>>>                    Set current_item to (p_selected_day(Self))
37434>>>>>>>>>>>                    Send Date_Changing to (oCalendarYear(Container3d2(self)))
37435>>>>>>>>>>>                    Send Date_Changing to (oMonth(Container3d2(self)))
37436>>>>>>>>>>>                End_Procedure
37437>>>>>>>>>>>
37437>>>>>>>>>>>                Procedure Fill_List
37439>>>>>>>>>>>                    Integer iFor prevdate# date# first_item# last_item# day# prev_last# nextdate# next_first#
37440>>>>>>>>>>>                    Integer cur_year# cur_month# cur_day# sel_month# sel_day# sel_year#
37440>>>>>>>>>>>                    Date dToday
37440>>>>>>>>>>>                    Send Delete_Data
37441>>>>>>>>>>>
37441>>>>>>>>>>>                    Get p_current_date to date#
37442>>>>>>>>>>>
37442>>>>>>>>>>>                    SysDate4 dToday
37443>>>>>>>>>>>                    move (DateSegment(dToday,DS_DAY)) to cur_day#
37444>>>>>>>>>>>                    move (DateSegment(dToday,DS_MONTH)) to cur_month#
37445>>>>>>>>>>>                    move (DateSegment(dToday,DS_YEAR)) to cur_year#
37446>>>>>>>>>>>
37446>>>>>>>>>>>                    move (DateSegment(date#,DS_DAY)) to sel_day#
37447>>>>>>>>>>>                    move (DateSegment(date#,DS_MONTH)) to sel_month#
37448>>>>>>>>>>>                    move (DateSegment(date#,DS_YEAR)) to sel_year#
37449>>>>>>>>>>>                    Set p_current_month To sel_month#
37450>>>>>>>>>>>                    Set p_current_year To sel_year#
37451>>>>>>>>>>>
37451>>>>>>>>>>>                    move (FirstDayInMonth(date#)) to date#
37452>>>>>>>>>>>                    move (DateDayNumber(date#)-1) to first_item#
37453>>>>>>>>>>>                    move (LastDayInMonth(date#)-date#+first_item#) to last_item#
37454>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,-1)) To prevdate#
37455>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(prevdate#)),DS_DAY)) to prev_last#
37456>>>>>>>>>>>
37456>>>>>>>>>>>                    If (first_item# > 0) Begin
37458>>>>>>>>>>>                        Move (first_item#-1) to day#
37459>>>>>>>>>>>                        For iFor from 0 to (first_item#-1)
37465>>>>>>>>>>>>
37465>>>>>>>>>>>                            Send Add_Item msg_move_value_out (prev_last#-day#)
37466>>>>>>>>>>>                            Set Entry_State Item iFor To False
37467>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
37468>>>>>>>>>>>                            Decrement day#
37469>>>>>>>>>>>                        Loop
37470>>>>>>>>>>>>
37470>>>>>>>>>>>                    End
37470>>>>>>>>>>>>
37470>>>>>>>>>>>
37470>>>>>>>>>>>                    Move 1 To day#
37471>>>>>>>>>>>                    For iFor from first_item# to last_item#
37477>>>>>>>>>>>>
37477>>>>>>>>>>>                        Send Add_Item Msg_Move_Value_Out day#
37478>>>>>>>>>>>                        Set Entry_State Item iFor To False
37479>>>>>>>>>>>                        If ((cur_month# eq sel_month#)and(cur_year# eq sel_year#)and(Day# eq cur_day#)) Begin
37481>>>>>>>>>>>                            Set Form_Bitmap Item iFor To "cdate.bmp"
37482>>>>>>>>>>>                            Set piCurrentDayItem to iFor
37483>>>>>>>>>>>                        End
37483>>>>>>>>>>>>
37483>>>>>>>>>>>                        If Day# eq sel_day# Set p_selected_day To iFor
37486>>>>>>>>>>>                        Set Form_justification_mode Item iFor To FORM_DISPLAYRIGHT
37487>>>>>>>>>>>                        Set form_datatype item iFor To mask_numeric_window
37488>>>>>>>>>>>                        Set form_Mask item iFor To "## "
37489>>>>>>>>>>>                        Increment day#
37490>>>>>>>>>>>                    Loop
37491>>>>>>>>>>>>
37491>>>>>>>>>>>
37491>>>>>>>>>>>                    move (DateIncrement(date#,DS_Month,1)) To nextdate#
37492>>>>>>>>>>>                    move (DateSegment((LastDayInMonth(nextdate#)),DS_DAY)) to next_first#
37493>>>>>>>>>>>
37493>>>>>>>>>>>                    If (last_item# < 41) Begin
37495>>>>>>>>>>>                        Move 1 to day#
37496>>>>>>>>>>>                        For iFor from (last_item#+1) to 41
37502>>>>>>>>>>>>
37502>>>>>>>>>>>                            Send Add_Item msg_move_value_out day#
37503>>>>>>>>>>>                            Set Entry_State Item iFor To False
37504>>>>>>>>>>>                            Set ItemTextColor Item iFor To clGray
37505>>>>>>>>>>>                            Increment day#
37506>>>>>>>>>>>                        Loop
37507>>>>>>>>>>>>
37507>>>>>>>>>>>                    End
37507>>>>>>>>>>>>
37507>>>>>>>>>>>
37507>>>>>>>>>>>                End_Procedure
37508>>>>>>>>>>>
37508>>>>>>>>>>>                Procedure Help
37510>>>>>>>>>>>                    //Send Info_Box ("<Up>, <Dn>, <Lft>, <Rgt> - select date.\n<PgUp>, <PgDn> - select month.\n<Ctrl>+<D> - set current date.\n<Ctrl>+<Y> - select year.\n<Ctrl>+<PgUp>, <PgDn> - Select year.") ("Help on Calendar")
37510>>>>>>>>>>>                    Set Visible_State of Help_Container to True
37511>>>>>>>>>>>                    Set Enabled_State of Help_Container to True
37512>>>>>>>>>>>                    Send Activate to Help_Container
37513>>>>>>>>>>>                End_Procedure
37514>>>>>>>>>>>
37514>>>>>>>>>>>                procedure mouse_click integer window integer char_pos
37516>>>>>>>>>>>                    Send Move_Value_Out
37517>>>>>>>>>>>                    forward send mouse_click window char_pos
37519>>>>>>>>>>>                end_procedure
37520>>>>>>>>>>>
37520>>>>>>>>>>>                Procedure Move_Value_Out
37522>>>>>>>>>>>                    Integer iYear iMonth iDay iItm
37523>>>>>>>>>>>                    Date Date# next_date# prev_date#
37523>>>>>>>>>>>                    Get Current_Item To iItm
37524>>>>>>>>>>>                    If (pExportState(Self)) Begin
37526>>>>>>>>>>>                        Get Value Item iItm To iDay
37527>>>>>>>>>>>                        Get p_current_month to iMonth
37528>>>>>>>>>>>                        Get p_current_year  to iYear
37529>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
37530>>>>>>>>>>>
37530>>>>>>>>>>>                        If ((iItm>27)and(iDay<15)) Begin
37532>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To next_date#
37533>>>>>>>>>>>                            move (DateIncrement(next_date#,DS_Month,1)) To next_date#
37534>>>>>>>>>>>                            move (DateSegment(next_date#,DS_MONTH)) to iMonth
37535>>>>>>>>>>>                            move (DateSegment(next_date#,DS_YEAR)) to iYear
37536>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
37537>>>>>>>>>>>                        End
37537>>>>>>>>>>>>
37537>>>>>>>>>>>                        If ((iItm<7)and(iDay>20)) Begin
37539>>>>>>>>>>>                            Move (DateCompose(1,iMonth,iYear)) To prev_date#
37540>>>>>>>>>>>                            move (DateIncrement(prev_date#,DS_Month,-1)) To prev_date#
37541>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_MONTH)) to iMonth
37542>>>>>>>>>>>                            move (DateSegment(prev_date#,DS_YEAR)) to iYear
37543>>>>>>>>>>>                            move (DateCompose(iDay,iMonth,iYear)) to date#
37544>>>>>>>>>>>                        End
37544>>>>>>>>>>>>
37544>>>>>>>>>>>
37544>>>>>>>>>>>                        Send Export_Date date#
37545>>>>>>>>>>>                    End
37545>>>>>>>>>>>>
37545>>>>>>>>>>>                End_Procedure
37546>>>>>>>>>>>
37546>>>>>>>>>>>                Procedure Export_Date date date#
37548>>>>>>>>>>>                    local integer focus# dm# margin# datatype#
37549>>>>>>>>>>>                    get invoking_object_id to focus#
37550>>>>>>>>>>>
37550>>>>>>>>>>>                    if focus# gt desktop begin
37552>>>>>>>>>>>                         get delegation_mode of focus# to dm#
37553>>>>>>>>>>>                         set delegation_mode of focus# to no_delegate_or_error
37554>>>>>>>>>>>                         get form_margin of focus# item current to margin#
37555>>>>>>>>>>>                         get form_datatype of focus# item current to datatype#
37556>>>>>>>>>>>                         set delegation_mode of focus# to dm#
37557>>>>>>>>>>>                         if (margin#>=10 or datatype#=mask_date_window or datatype#=date_window) set value of focus# item current to date#
37560>>>>>>>>>>>                         else             set value of focus# item current to (Date4to2(date#))
37562>>>>>>>>>>>                         set item_changed_state of focus# item current to true
37563>>>>>>>>>>>                    end
37563>>>>>>>>>>>>
37563>>>>>>>>>>>                    Send Close_Calendar
37564>>>>>>>>>>>                End_Procedure
37565>>>>>>>>>>>
37565>>>>>>>>>>>                Object cOutlookFloatingMenu is a FloatingPopupMenu
37567>>>>>>>>>>>
37567>>>>>>>>>>>                    Procedure Close_Calendar
37569>>>>>>>>>>>                        Send Close_Calendar to (oCalendar(Self))
37570>>>>>>>>>>>                    End_Procedure // Close_Calendar
37571>>>>>>>>>>>
37571>>>>>>>>>>>                    Send Add_item msg_go_today         t.calendar.today
37572>>>>>>>>>>>                    Send Add_item msg_None             ""
37573>>>>>>>>>>>                    Send Add_Item msg_prev_year        t.calendar.PrevYear
37574>>>>>>>>>>>                    Send Add_Item msg_next_year        t.calendar.NextYear
37575>>>>>>>>>>>                    Send Add_Item msg_prev_month       t.calendar.PrevMonth
37576>>>>>>>>>>>                    Send Add_Item msg_next_month       t.calendar.NextMonth
37577>>>>>>>>>>>                    Send Add_item msg_None             ""
37578>>>>>>>>>>>                    Send Add_Item msg_move_value_out   t.calendar.Select
37579>>>>>>>>>>>                    Send Add_item msg_None             ""
37580>>>>>>>>>>>                    Send Add_item msg_Close_Calendar   t.calendar.Cancel
37581>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
37582>>>>>>>>>>>
37582>>>>>>>>>>>                Set floating_menu_object to (cOutlookFloatingMenu(Self))
37583>>>>>>>>>>>
37583>>>>>>>>>>>                procedure item_change integer fromi integer toi returns integer
37585>>>>>>>>>>>                    Integer new_item liMonth
37586>>>>>>>>>>>                    Date    ldSysdate
37586>>>>>>>>>>>                    forward get msg_item_change fromi toi to new_item
37588>>>>>>>>>>>                    If (Focus(Desktop) = Self) Begin
37590>>>>>>>>>>>                        If (new_item >= 0) Begin
37592>>>>>>>>>>>                            Sysdate4 ldSysdate
37593>>>>>>>>>>>                            Move (TheMonthSegment(ldSysdate)) to liMonth
37594>>>>>>>>>>>                            If ((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) = fromi)) Set Form_Bitmap Item fromi to "Cdate.bmp"
37597>>>>>>>>>>>                            Else Set Form_Bitmap Item fromi to ""
37599>>>>>>>>>>>                            If (((p_current_month(Self) = liMonth) and (piCurrentDayItem(Self) <> new_item)) or;                                 (p_current_month(Self) <> liMonth)) Set Form_Bitmap Item new_item   to "Cdate1.bmp"
37602>>>>>>>>>>>                        End
37602>>>>>>>>>>>>
37602>>>>>>>>>>>                    End
37602>>>>>>>>>>>>
37602>>>>>>>>>>>                    procedure_return new_item
37603>>>>>>>>>>>                End_Procedure // Current_Item
37604>>>>>>>>>>>
37604>>>>>>>>>>>
37604>>>>>>>>>>>
37604>>>>>>>>>>>                //AB-StoreEnd
37604>>>>>>>>>>>
37604>>>>>>>>>>>            End_Object    // Grid2
37605>>>>>>>>>>>
37605>>>>>>>>>>>            Object Textbox2 is a Textbox
37607>>>>>>>>>>>                Set Label to "Mo"
37608>>>>>>>>>>>                Set Auto_Size_State to FALSE
37609>>>>>>>>>>>                Set Transparent_State to TRUE
37610>>>>>>>>>>>                Set Color to clWhite
37611>>>>>>>>>>>                Set TextColor to clNavy
37612>>>>>>>>>>>                Set Location to 19 4
37613>>>>>>>>>>>                Set Size to 10 15
37614>>>>>>>>>>>
37614>>>>>>>>>>>                //AB-StoreStart
37614>>>>>>>>>>>
37614>>>>>>>>>>>                Set Label To (left(t.calendar.Monday,2))
37615>>>>>>>>>>>                //AB-StoreEnd
37615>>>>>>>>>>>
37615>>>>>>>>>>>            End_Object    // Textbox2
37616>>>>>>>>>>>
37616>>>>>>>>>>>            Object Textbox3 is a Textbox
37618>>>>>>>>>>>                Set Label to "Tu"
37619>>>>>>>>>>>                Set Auto_Size_State to FALSE
37620>>>>>>>>>>>                Set Transparent_State to TRUE
37621>>>>>>>>>>>                Set Color to clWhite
37622>>>>>>>>>>>                Set TextColor to clNavy
37623>>>>>>>>>>>                Set Location to 19 22
37624>>>>>>>>>>>                Set Size to 10 12
37625>>>>>>>>>>>
37625>>>>>>>>>>>                //AB-StoreStart
37625>>>>>>>>>>>
37625>>>>>>>>>>>                Set Label To (left(t.calendar.Tuesday,2))
37626>>>>>>>>>>>                //AB-StoreEnd
37626>>>>>>>>>>>
37626>>>>>>>>>>>            End_Object    // Textbox3
37627>>>>>>>>>>>
37627>>>>>>>>>>>            Object Textbox4 is a Textbox
37629>>>>>>>>>>>                Set Label to "We"
37630>>>>>>>>>>>                Set Auto_Size_State to FALSE
37631>>>>>>>>>>>                Set Transparent_State to TRUE
37632>>>>>>>>>>>                Set Color to clWhite
37633>>>>>>>>>>>                Set TextColor to clNavy
37634>>>>>>>>>>>                Set Location to 19 39
37635>>>>>>>>>>>                Set Size to 10 15
37636>>>>>>>>>>>
37636>>>>>>>>>>>                //AB-StoreStart
37636>>>>>>>>>>>
37636>>>>>>>>>>>                Set Label To (left(t.calendar.Wednesday,2))
37637>>>>>>>>>>>                //AB-StoreEnd
37637>>>>>>>>>>>
37637>>>>>>>>>>>            End_Object    // Textbox4
37638>>>>>>>>>>>
37638>>>>>>>>>>>            Object Textbox5 is a Textbox
37640>>>>>>>>>>>                Set Label to "Th"
37641>>>>>>>>>>>                Set Auto_Size_State to FALSE
37642>>>>>>>>>>>                Set Transparent_State to TRUE
37643>>>>>>>>>>>                Set Color to clWhite
37644>>>>>>>>>>>                Set TextColor to clNavy
37645>>>>>>>>>>>                Set Location to 19 57
37646>>>>>>>>>>>                Set Size to 10 17
37647>>>>>>>>>>>
37647>>>>>>>>>>>                //AB-StoreStart
37647>>>>>>>>>>>
37647>>>>>>>>>>>                Set Label To (left(t.calendar.Thursday,2))
37648>>>>>>>>>>>                //AB-StoreEnd
37648>>>>>>>>>>>
37648>>>>>>>>>>>            End_Object    // Textbox5
37649>>>>>>>>>>>
37649>>>>>>>>>>>            Object Textbox6 is a Textbox
37651>>>>>>>>>>>                Set Label to "Fr"
37652>>>>>>>>>>>                Set Auto_Size_State to FALSE
37653>>>>>>>>>>>                Set Transparent_State to TRUE
37654>>>>>>>>>>>                Set Color to clWhite
37655>>>>>>>>>>>                Set TextColor to clNavy
37656>>>>>>>>>>>                Set Location to 19 76
37657>>>>>>>>>>>                Set Size to 10 17
37658>>>>>>>>>>>
37658>>>>>>>>>>>                //AB-StoreStart
37658>>>>>>>>>>>
37658>>>>>>>>>>>                Set Label To (left(t.calendar.Friday,2))
37659>>>>>>>>>>>                //AB-StoreEnd
37659>>>>>>>>>>>
37659>>>>>>>>>>>            End_Object    // Textbox6
37660>>>>>>>>>>>
37660>>>>>>>>>>>            Object Textbox7 is a Textbox
37662>>>>>>>>>>>                Set Label to "Sa"
37663>>>>>>>>>>>                Set Auto_Size_State to FALSE
37664>>>>>>>>>>>                Set Transparent_State to TRUE
37665>>>>>>>>>>>                Set Color to clWhite
37666>>>>>>>>>>>                Set TextColor to clNavy
37667>>>>>>>>>>>                Set Location to 19 91
37668>>>>>>>>>>>                Set Size to 10 18
37669>>>>>>>>>>>
37669>>>>>>>>>>>                //AB-StoreStart
37669>>>>>>>>>>>
37669>>>>>>>>>>>                Set Label To (left(t.calendar.Saturday,2))
37670>>>>>>>>>>>                //AB-StoreEnd
37670>>>>>>>>>>>
37670>>>>>>>>>>>            End_Object    // Textbox7
37671>>>>>>>>>>>
37671>>>>>>>>>>>            Object Textbox8 is a Textbox
37673>>>>>>>>>>>                Set Label to "Su"
37674>>>>>>>>>>>                Set Auto_Size_State to FALSE
37675>>>>>>>>>>>                Set Transparent_State to TRUE
37676>>>>>>>>>>>                Set Color to clWhite
37677>>>>>>>>>>>                Set TextColor to clNavy
37678>>>>>>>>>>>                Set Location to 19 109
37679>>>>>>>>>>>                Set Size to 10 17
37680>>>>>>>>>>>
37680>>>>>>>>>>>                //AB-StoreStart
37680>>>>>>>>>>>
37680>>>>>>>>>>>                Set Label To (left(t.calendar.Sunday,2))
37681>>>>>>>>>>>                //AB-StoreEnd
37681>>>>>>>>>>>
37681>>>>>>>>>>>            End_Object    // Textbox8
37682>>>>>>>>>>>
37682>>>>>>>>>>>            Object LineControl1 is a LineControl
37684>>>>>>>>>>>                Set Line_Style to lnSINGLE
37685>>>>>>>>>>>                Set Size to 1 116
37686>>>>>>>>>>>                Set Location to 28 4
37687>>>>>>>>>>>
37687>>>>>>>>>>>                //AB-StoreStart
37687>>>>>>>>>>>
37687>>>>>>>>>>>                //AB-StoreEnd
37687>>>>>>>>>>>
37687>>>>>>>>>>>            End_Object    // LineControl1
37688>>>>>>>>>>>
37688>>>>>>>>>>>            Object Container3d2 is a Container3d
37690>>>>>>>>>>>                Set Size to 18 131
37691>>>>>>>>>>>                Set Location to 1 1
37692>>>>>>>>>>>                Set Color to clNavy
37693>>>>>>>>>>>                Set Border_Style to Border_None
37694>>>>>>>>>>>                Object oRght is a BitmapContainer
37696>>>>>>>>>>>                    Set Size to 10 14
37697>>>>>>>>>>>                    Set Location to 4 105
37698>>>>>>>>>>>                    Set Bitmap to "rght.bmp"
37699>>>>>>>>>>>                    Set Border_Style to Border_None
37700>>>>>>>>>>>
37700>>>>>>>>>>>                    //AB-StoreStart
37700>>>>>>>>>>>                    Procedure Mouse_Down
37702>>>>>>>>>>>                        Send Next_Month to Grid2
37703>>>>>>>>>>>                    End_Procedure
37704>>>>>>>>>>>                    //AB-StoreEnd
37704>>>>>>>>>>>
37704>>>>>>>>>>>                End_Object    // oRght
37705>>>>>>>>>>>
37705>>>>>>>>>>>                Object oLeft is a BitmapContainer
37707>>>>>>>>>>>                    Set Size to 10 14
37708>>>>>>>>>>>                    Set Location to 4 3
37709>>>>>>>>>>>                    Set Bitmap to "lft.bmp"
37710>>>>>>>>>>>                    Set Border_Style to Border_None
37711>>>>>>>>>>>
37711>>>>>>>>>>>                    //AB-StoreStart
37711>>>>>>>>>>>                    Procedure Mouse_Down
37713>>>>>>>>>>>                        Send Prev_Month to Grid2
37714>>>>>>>>>>>                    End_Procedure
37715>>>>>>>>>>>                    //AB-StoreEnd
37715>>>>>>>>>>>
37715>>>>>>>>>>>                End_Object    // oLeft
37716>>>>>>>>>>>
37716>>>>>>>>>>>                Object oMonth is a Textbox
37718>>>>>>>>>>>
37718>>>>>>>>>>>                    //AB-StoreTopStart
37718>>>>>>>>>>>                    Property integer piSelected_Month public 0
37720>>>>>>>>>>>                    //AB-StoreTopEnd
37720>>>>>>>>>>>
37720>>>>>>>>>>>                    Set Label to "January"
37721>>>>>>>>>>>                    Set Auto_Size_State to FALSE
37722>>>>>>>>>>>                    Set Transparent_State to TRUE
37723>>>>>>>>>>>                    Set Color to clWhite
37724>>>>>>>>>>>                    Set TextColor to clWhite
37725>>>>>>>>>>>                    Set Location to 4 19
37726>>>>>>>>>>>                    Set Size to 10 46
37727>>>>>>>>>>>                    Set FontWeight to 800
37728>>>>>>>>>>>                    Set Justification_Mode to jMode_Center
37729>>>>>>>>>>>
37729>>>>>>>>>>>                    //AB-StoreStart
37729>>>>>>>>>>>
37729>>>>>>>>>>>                    Procedure Mouse_Down
37731>>>>>>>>>>>                        Integer iState
37732>>>>>>>>>>>                        Get Visible_State of oSelectCalendarYear to iState
37733>>>>>>>>>>>                        If (iState) Send OnKillFocus to oSelectCalendarYear
37736>>>>>>>>>>>                        Send Popup to oSelectMonth
37737>>>>>>>>>>>                    End_Procedure
37738>>>>>>>>>>>
37738>>>>>>>>>>>                    Procedure pSelectJan
37740>>>>>>>>>>>                        Set Label to t.calendar.january
37741>>>>>>>>>>>                        Set piSelected_Month to 1
37742>>>>>>>>>>>                        Send Adjust_Calendar
37743>>>>>>>>>>>                    End_Procedure
37744>>>>>>>>>>>                    Procedure pSelectFeb
37746>>>>>>>>>>>                        Set Label to t.calendar.february
37747>>>>>>>>>>>                        Set piSelected_Month to 2
37748>>>>>>>>>>>                        Send Adjust_Calendar
37749>>>>>>>>>>>                    End_Procedure
37750>>>>>>>>>>>                    Procedure pSelectMar
37752>>>>>>>>>>>                        Set Label to t.calendar.march
37753>>>>>>>>>>>                        Set piSelected_Month to 3
37754>>>>>>>>>>>                        Send Adjust_Calendar
37755>>>>>>>>>>>                    End_Procedure
37756>>>>>>>>>>>                    Procedure pSelectApr
37758>>>>>>>>>>>                        Set Label to t.calendar.april
37759>>>>>>>>>>>                        Set piSelected_Month to 4
37760>>>>>>>>>>>                        Send Adjust_Calendar
37761>>>>>>>>>>>                    End_Procedure
37762>>>>>>>>>>>                    Procedure pSelectMay
37764>>>>>>>>>>>                        Set Label to t.calendar.may
37765>>>>>>>>>>>                        Set piSelected_Month to 5
37766>>>>>>>>>>>                        Send Adjust_Calendar
37767>>>>>>>>>>>                    End_Procedure
37768>>>>>>>>>>>                    Procedure pSelectJun
37770>>>>>>>>>>>                        Set Label to t.calendar.june
37771>>>>>>>>>>>                        Set piSelected_Month to 6
37772>>>>>>>>>>>                        Send Adjust_Calendar
37773>>>>>>>>>>>                    End_Procedure
37774>>>>>>>>>>>                    Procedure pSelectJul
37776>>>>>>>>>>>                        Set Label to t.calendar.july
37777>>>>>>>>>>>                        Set piSelected_Month to 7
37778>>>>>>>>>>>                        Send Adjust_Calendar
37779>>>>>>>>>>>                    End_Procedure
37780>>>>>>>>>>>                    Procedure pSelectAug
37782>>>>>>>>>>>                        Set Label to t.calendar.august
37783>>>>>>>>>>>                        Set piSelected_Month to 8
37784>>>>>>>>>>>                        Send Adjust_Calendar
37785>>>>>>>>>>>                    End_Procedure
37786>>>>>>>>>>>                    Procedure pSelectSep
37788>>>>>>>>>>>                        Set Label to t.calendar.september
37789>>>>>>>>>>>                        Set piSelected_Month to 9
37790>>>>>>>>>>>                        Send Adjust_Calendar
37791>>>>>>>>>>>                    End_Procedure
37792>>>>>>>>>>>                    Procedure pSelectOct
37794>>>>>>>>>>>                        Set Label to t.calendar.october
37795>>>>>>>>>>>                        Set piSelected_Month to 10
37796>>>>>>>>>>>                        Send Adjust_Calendar
37797>>>>>>>>>>>                    End_Procedure
37798>>>>>>>>>>>                    Procedure pSelectNov
37800>>>>>>>>>>>                        Set Label to t.calendar.november
37801>>>>>>>>>>>                        Set piSelected_Month to 11
37802>>>>>>>>>>>                        Send Adjust_Calendar
37803>>>>>>>>>>>                    End_Procedure
37804>>>>>>>>>>>                    Procedure pSelectDec
37806>>>>>>>>>>>                        Set Label to t.calendar.december
37807>>>>>>>>>>>                        Set piSelected_Month to 12
37808>>>>>>>>>>>                        Send Adjust_Calendar
37809>>>>>>>>>>>                    End_Procedure
37810>>>>>>>>>>>
37810>>>>>>>>>>>                    Object oSelectMonth is a FloatingPopupMenu
37812>>>>>>>>>>>                        Send Add_Item msg_pSelectJan t.calendar.january
37813>>>>>>>>>>>                        Send Add_Item msg_pSelectFeb t.calendar.february
37814>>>>>>>>>>>                        Send Add_Item msg_pSelectMar t.calendar.march
37815>>>>>>>>>>>                        Send Add_Item msg_pSelectApr t.calendar.april
37816>>>>>>>>>>>                        Send Add_Item msg_pSelectMay t.calendar.may
37817>>>>>>>>>>>                        Send Add_Item msg_pSelectJun t.calendar.june
37818>>>>>>>>>>>                        Send Add_Item msg_pSelectJul t.calendar.july
37819>>>>>>>>>>>                        Send Add_Item msg_pSelectAug t.calendar.august
37820>>>>>>>>>>>                        Send Add_Item msg_pSelectSep t.calendar.september
37821>>>>>>>>>>>                        Send Add_Item msg_pSelectOct t.calendar.october
37822>>>>>>>>>>>                        Send Add_Item msg_pSelectNov t.calendar.november
37823>>>>>>>>>>>                        Send Add_Item msg_pSelectDec t.calendar.december
37824>>>>>>>>>>>                    End_Object
37825>>>>>>>>>>>
37825>>>>>>>>>>>                    Procedure Adjust_Calendar
37827>>>>>>>>>>>                        Date date#
37828>>>>>>>>>>>                        Integer iDay iMonth iYear iItm
37828>>>>>>>>>>>                        Set Visible_State to false
37829>>>>>>>>>>>                        Set Visible_State to true
37830>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
37831>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
37832>>>>>>>>>>>                        Get piSelected_Month to iMonth
37833>>>>>>>>>>>                        Get Label of oCalendarYear to iYear
37834>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
37835>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
37836>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
37837>>>>>>>>>>>                    End_Procedure
37838>>>>>>>>>>>
37838>>>>>>>>>>>                    Procedure Activating
37840>>>>>>>>>>>                        Forward Send Activating
37842>>>>>>>>>>>                        Send Date_Changing
37843>>>>>>>>>>>                    End_Procedure
37844>>>>>>>>>>>
37844>>>>>>>>>>>                    Procedure Date_Changing
37846>>>>>>>>>>>                        Set Visible_State to false
37847>>>>>>>>>>>                        Set Label to (MonthName(p_current_Month(Grid2(Container3D1(Self)))))
37848>>>>>>>>>>>                        Set piSelected_Month to (p_current_Month(Grid2(Container3D1(Self))))
37849>>>>>>>>>>>                        Set Visible_State to true
37850>>>>>>>>>>>                    End_Procedure
37851>>>>>>>>>>>
37851>>>>>>>>>>>
37851>>>>>>>>>>>
37851>>>>>>>>>>>                    //AB-StoreEnd
37851>>>>>>>>>>>
37851>>>>>>>>>>>                End_Object    // oMonth
37852>>>>>>>>>>>
37852>>>>>>>>>>>                Object oCalendarYear is a Textbox
37854>>>>>>>>>>>                    Set Label to "2001"
37855>>>>>>>>>>>                    Set Transparent_State to TRUE
37856>>>>>>>>>>>                    Set Color to clWhite
37857>>>>>>>>>>>                    Set TextColor to clWhite
37858>>>>>>>>>>>                    Set Location to 4 77
37859>>>>>>>>>>>                    Set Size to 10 18
37860>>>>>>>>>>>                    Set FontWeight to 800
37861>>>>>>>>>>>
37861>>>>>>>>>>>                    //AB-StoreStart
37861>>>>>>>>>>>
37861>>>>>>>>>>>                    Procedure Mouse_Down
37863>>>>>>>>>>>                        String sVal
37864>>>>>>>>>>>                        Get Label to sVal
37865>>>>>>>>>>>                        Set Value of oSelectCalendarYear item 0 to sVal
37866>>>>>>>>>>>                        Set Visible_State of oSelectCalendarYear to True
37867>>>>>>>>>>>                        Send Activate to (oSelectCalendarYear(Self))
37868>>>>>>>>>>>                    End_Procedure
37869>>>>>>>>>>>
37869>>>>>>>>>>>                    Procedure Activating
37871>>>>>>>>>>>                        Forward Send Activating
37873>>>>>>>>>>>                        Send Date_Changing
37874>>>>>>>>>>>                    End_Procedure
37875>>>>>>>>>>>
37875>>>>>>>>>>>                    Procedure Date_Changing
37877>>>>>>>>>>>                        Set Visible_State to false
37878>>>>>>>>>>>                        Set Label to (String(p_current_Year(Grid2(Container3D1(Self)))))
37879>>>>>>>>>>>                        Set Visible_State to true
37880>>>>>>>>>>>                    End_Procedure
37881>>>>>>>>>>>
37881>>>>>>>>>>>                    //AB-StoreEnd
37881>>>>>>>>>>>
37881>>>>>>>>>>>                End_Object    // oCalendarYear
37882>>>>>>>>>>>
37882>>>>>>>>>>>                Object oSelectCalendarYear is a Form
37884>>>>>>>>>>>
37884>>>>>>>>>>>                    //AB-StoreTopStart
37884>>>>>>>>>>>                    Set Visible_State To False
37885>>>>>>>>>>>                    //AB-StoreTopEnd
37885>>>>>>>>>>>
37885>>>>>>>>>>>                    Set Size to 10 24
37886>>>>>>>>>>>                    Set Location to 4 75
37887>>>>>>>>>>>                    Set Color to clWhite
37888>>>>>>>>>>>                    Set TextColor to clNavy
37889>>>>>>>>>>>                    Set Form_Border Item 0 to Border_Normal
37890>>>>>>>>>>>
37890>>>>>>>>>>>                    //AB-StoreStart
37890>>>>>>>>>>>
37890>>>>>>>>>>>                    On_Key Key_Enter Send OnKillFocus
37891>>>>>>>>>>>                    On_Key Key_Escape Send OnKillFocus
37892>>>>>>>>>>>
37892>>>>>>>>>>>                    Procedure SetFontWeight
37894>>>>>>>>>>>                        Set Form_FontWeight item 0 to 800
37895>>>>>>>>>>>                    End_Procedure
37896>>>>>>>>>>>
37896>>>>>>>>>>>                    Procedure OnKillFocus
37898>>>>>>>>>>>                        String sVal
37899>>>>>>>>>>>                        Integer iMonth iDay iYear iItm
37899>>>>>>>>>>>                        Date date#
37899>>>>>>>>>>>                        Get Value item 0 to sVal
37900>>>>>>>>>>>                        Set Visible_State of oCalendarYear to false
37901>>>>>>>>>>>                        Set Label of oCalendarYear to sVal
37902>>>>>>>>>>>                        Set Visible_State of oCalendarYear to true
37903>>>>>>>>>>>                        Set Visible_State to false
37904>>>>>>>>>>>                        Get Current_Item of (Grid2(Container3D1(Self))) to iItm
37905>>>>>>>>>>>                        Get value of (Grid2(Container3D1(Self))) item iItm to iDay
37906>>>>>>>>>>>                        Get piSelected_Month of oMonth to iMonth
37907>>>>>>>>>>>                        Get Value item 0 to iYear
37908>>>>>>>>>>>                        If (iYear = 0) Move 2000 to iYear
37911>>>>>>>>>>>                        Move (DateCompose(iDay,iMonth,iYear)) To date#
37912>>>>>>>>>>>                        Set p_current_date of (Grid2(Container3D1(Self))) to date#
37913>>>>>>>>>>>                        Send Update_Calendar to (Grid2(Container3D1(Self)))
37914>>>>>>>>>>>                        Send Activate        to (Grid2(Container3D1(Self)))
37915>>>>>>>>>>>                    End_Procedure
37916>>>>>>>>>>>
37916>>>>>>>>>>>                    Send SetFontWeight
37917>>>>>>>>>>>
37917>>>>>>>>>>>
37917>>>>>>>>>>>
37917>>>>>>>>>>>                    //AB-StoreEnd
37917>>>>>>>>>>>
37917>>>>>>>>>>>                End_Object    // oSelectCalendarYear
37918>>>>>>>>>>>
37918>>>>>>>>>>>
37918>>>>>>>>>>>                //AB-StoreStart
37918>>>>>>>>>>>
37918>>>>>>>>>>>                Procedure Mouse_Down
37920>>>>>>>>>>>                    Integer iState
37921>>>>>>>>>>>                    Get Visible_State of oSelectCalendarYear to iState
37922>>>>>>>>>>>                    If (iState) Send OnKillFocus to oSelectCalendarYear
37925>>>>>>>>>>>                End_Procedure
37926>>>>>>>>>>>
37926>>>>>>>>>>>
37926>>>>>>>>>>>                //AB-StoreEnd
37926>>>>>>>>>>>
37926>>>>>>>>>>>            End_Object    // Container3d2
37927>>>>>>>>>>>
37927>>>>>>>>>>>
37927>>>>>>>>>>>            //AB-StoreStart
37927>>>>>>>>>>>
37927>>>>>>>>>>>
37927>>>>>>>>>>>            //AB-StoreEnd
37927>>>>>>>>>>>
37927>>>>>>>>>>>        End_Object    // Container3d1
37928>>>>>>>>>>>
37928>>>>>>>>>>>        Object BitmapContainer3 is a BitmapContainer
37930>>>>>>>>>>>            Set Size to 9 19
37931>>>>>>>>>>>            Set Location to 88 3
37932>>>>>>>>>>>            Set Color to clWhite
37933>>>>>>>>>>>            Set Bitmap to "cdate.bmp"
37934>>>>>>>>>>>            Set Border_Style to Border_None
37935>>>>>>>>>>>
37935>>>>>>>>>>>            //AB-StoreStart
37935>>>>>>>>>>>            Procedure Mouse_Down
37937>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
37938>>>>>>>>>>>                Send Adjust_Label to oToday
37939>>>>>>>>>>>            End_Procedure
37940>>>>>>>>>>>            //AB-StoreEnd
37940>>>>>>>>>>>
37940>>>>>>>>>>>        End_Object    // BitmapContainer3
37941>>>>>>>>>>>
37941>>>>>>>>>>>        Object oToday is a Textbox
37943>>>>>>>>>>>            Set Label to "Today: 01.01.2001"
37944>>>>>>>>>>>            Set Auto_Size_State to FALSE
37945>>>>>>>>>>>            Set Color to clWhite
37946>>>>>>>>>>>            Set Location to 88 22
37947>>>>>>>>>>>            Set Size to 8 70
37948>>>>>>>>>>>            Set FontWeight to 800
37949>>>>>>>>>>>
37949>>>>>>>>>>>            //AB-StoreStart
37949>>>>>>>>>>>            Procedure Mouse_Down
37951>>>>>>>>>>>                Send go_today to (Grid2(Container3d1(Self)))
37952>>>>>>>>>>>                Send Adjust_Label
37953>>>>>>>>>>>            End_Procedure
37954>>>>>>>>>>>
37954>>>>>>>>>>>            Procedure Adjust_Label
37956>>>>>>>>>>>                date date#
37957>>>>>>>>>>>                SysDate4 date#
37958>>>>>>>>>>>                Set Visible_State To false
37959>>>>>>>>>>>                Set Label         to (t.calendar.today+": "+String(date#))
37960>>>>>>>>>>>                Set Visible_State To true
37961>>>>>>>>>>>            End_Procedure
37962>>>>>>>>>>>
37962>>>>>>>>>>>            Procedure Activating
37964>>>>>>>>>>>                Forward Send Activating
37966>>>>>>>>>>>                Send Adjust_Label
37967>>>>>>>>>>>            End_Procedure
37968>>>>>>>>>>>            //AB-StoreEnd
37968>>>>>>>>>>>
37968>>>>>>>>>>>        End_Object    // oToday
37969>>>>>>>>>>>
37969>>>>>>>>>>>        Object oCloseCalendar_bn is a BitmapContainer
37971>>>>>>>>>>>            Set Size to 9 10
37972>>>>>>>>>>>            Set Location to 88 112
37973>>>>>>>>>>>            Set Bitmap to "Cdate1.bmp"
37974>>>>>>>>>>>            Set Bitmap_Style to Bitmap_Center
37975>>>>>>>>>>>
37975>>>>>>>>>>>            //AB-StoreStart
37975>>>>>>>>>>>
37975>>>>>>>>>>>            Procedure Mouse_Up
37977>>>>>>>>>>>                Send Close_Calendar
37978>>>>>>>>>>>            End_Procedure // Mouse_Up
37979>>>>>>>>>>>
37979>>>>>>>>>>>
37979>>>>>>>>>>>
37979>>>>>>>>>>>
37979>>>>>>>>>>>            //AB-StoreEnd
37979>>>>>>>>>>>
37979>>>>>>>>>>>        End_Object    // oCloseCalendar_bn
37980>>>>>>>>>>>
37980>>>>>>>>>>>
37980>>>>>>>>>>>        //AB-StoreStart
37980>>>>>>>>>>>
37980>>>>>>>>>>>        Set Block_Mouse_State to True
37981>>>>>>>>>>>        Set Popup_State to True
37982>>>>>>>>>>>        Set Locate_Mode to Popup_Locate
37983>>>>>>>>>>>
37983>>>>>>>>>>>        procedure popup
37985>>>>>>>>>>>            local integer focus# icItm iYear iMonth
37986>>>>>>>>>>>            local date date#
37986>>>>>>>>>>>            move (focus(desktop)) to focus#
37987>>>>>>>>>>>            set invoking_object_id of (Grid2(Container3d1(self))) to focus#
37988>>>>>>>>>>>            get value of focus# item current to date#
37989>>>>>>>>>>>            ifnot (integer(date#)) sysdate date#
37992>>>>>>>>>>>            move (Date2to4(date#)) to date#
37993>>>>>>>>>>>            set p_current_date of (Grid2(Container3d1(self))) to date#
37994>>>>>>>>>>>            send fill_list to (Grid2(Container3d1(self)))
37995>>>>>>>>>>>            move (DateSegment(date#,DS_YEAR)) to iYear
37996>>>>>>>>>>>            move (DateSegment(date#,DS_MONTH)) to iMonth
37997>>>>>>>>>>>            Set Label To (MonthName(iMonth)+', '+String(iYear))
37998>>>>>>>>>>>            forward send popup
38000>>>>>>>>>>>        end_procedure
38001>>>>>>>>>>>
38001>>>>>>>>>>>        Procedure Close_Calendar
38003>>>>>>>>>>>            Send Close_Panel
38004>>>>>>>>>>>        End_Procedure // Close_Calendar
38005>>>>>>>>>>>
38005>>>>>>>>>>>        Object Help_Container is a Container3d
38007>>>>>>>>>>>            Set Location to 0 0
38008>>>>>>>>>>>            Set Size     to 98 122
38009>>>>>>>>>>>            Set Visible_State to False
38010>>>>>>>>>>>            Set Enabled_State to False
38011>>>>>>>>>>>            Set Border_Style to Border_None
38012>>>>>>>>>>>            Set TextColor to clNavy
38013>>>>>>>>>>>
38013>>>>>>>>>>>            Object Help_Info is an Edit
38015>>>>>>>>>>>                Set Location to 0 0
38016>>>>>>>>>>>                Set Size     to 98 122
38017>>>>>>>>>>>                Set read_only_state to true
38018>>>>>>>>>>>                Set Border_Style to Border_None
38019>>>>>>>>>>>                Set scroll_bar_visible_state to False
38020>>>>>>>>>>>                Set FontWeight to 800
38021>>>>>>>>>>>
38021>>>>>>>>>>>                Procedure ReadHelpComments
38023>>>>>>>>>>>                    String lsFile
38024>>>>>>>>>>>
38024>>>>>>>>>>>                    Get_File_Path "Calendar.txt" to lsFile
38025>>>>>>>>>>>                    If (lsFile <> "") Send read lsFile
38028>>>>>>>>>>>                End_Procedure // ReadHelpComments
38029>>>>>>>>>>>
38029>>>>>>>>>>>                Procedure SetComments
38031>>>>>>>>>>>                    Send append_text "Help on Calendar"
38032>>>>>>>>>>>                    Send Insert ""
38033>>>>>>>>>>>                    Send Insert ""
38034>>>>>>>>>>>                    Send append_text "1.<Up>,<Dn>,<Lft>,<Rgt>"
38035>>>>>>>>>>>                    Send Insert ""
38036>>>>>>>>>>>                    Send append_text "  - select date."
38037>>>>>>>>>>>                    Send Insert ""
38038>>>>>>>>>>>                    Send append_text "2.<PgUp>,<PgDn>"
38039>>>>>>>>>>>                    Send Insert ""
38040>>>>>>>>>>>                    Send append_text "  - select month."
38041>>>>>>>>>>>                    Send Insert ""
38042>>>>>>>>>>>                    Send append_text "3.<Ctrl>+<D>"
38043>>>>>>>>>>>                    Send Insert ""
38044>>>>>>>>>>>                    Send append_text "  - set current date."
38045>>>>>>>>>>>                    Send Insert ""
38046>>>>>>>>>>>                    Send append_text "4.<Ctrl>+<Y>"
38047>>>>>>>>>>>                    Send Insert ""
38048>>>>>>>>>>>                    Send append_text "  - Change year."
38049>>>>>>>>>>>                    Send Insert ""
38050>>>>>>>>>>>                    Send append_text "5.<Ctrl>+<PgUp>,<PgDn>"
38051>>>>>>>>>>>                    Send Insert ""
38052>>>>>>>>>>>                    Send append_text "  - Select year."
38053>>>>>>>>>>>                End_procedure // SetComments
38054>>>>>>>>>>>
38054>>>>>>>>>>>                //Send SetComments
38054>>>>>>>>>>>                Set Color     to clWhite
38055>>>>>>>>>>>                Set TextColor to clNavy
38056>>>>>>>>>>>
38056>>>>>>>>>>>                Procedure OnSetFocus
38058>>>>>>>>>>>                    Send ReadHelpComments
38059>>>>>>>>>>>                End_Procedure
38060>>>>>>>>>>>
38060>>>>>>>>>>>                Object HelpFloatingMenu is a FloatingPopupMenu
38062>>>>>>>>>>>
38062>>>>>>>>>>>                    Procedure Close_Help
38064>>>>>>>>>>>                        Send Close_Help to Help_Container
38065>>>>>>>>>>>                    End_Procedure // Close_Calendar
38066>>>>>>>>>>>
38066>>>>>>>>>>>                    Send Add_item msg_Close_Help   t.calendar.Ok
38067>>>>>>>>>>>                End_Object // cOutlookFloatingMenu
38068>>>>>>>>>>>
38068>>>>>>>>>>>                Procedure Mouse_Up2 Integer aiWindow Integer aiChar_Pos
38070>>>>>>>>>>>                    Send Popup to HelpFloatingMenu
38071>>>>>>>>>>>                End_Procedure // Mouse_Up2
38072>>>>>>>>>>>
38072>>>>>>>>>>>            End_Object
38073>>>>>>>>>>>
38073>>>>>>>>>>>            Procedure Close_Help
38075>>>>>>>>>>>                Send Delete_Data to Help_Info
38076>>>>>>>>>>>                Set Visible_State to False
38077>>>>>>>>>>>                Set Enabled_State to False
38078>>>>>>>>>>>                Send Activate to (Grid2(Container3D1(Self)))
38079>>>>>>>>>>>            End_Procedure // Close_Help
38080>>>>>>>>>>>
38080>>>>>>>>>>>            On_Key kCancel Send Close_Help
38081>>>>>>>>>>>            On_Key Key_F1  Send Close_Help
38082>>>>>>>>>>>            On_Key kEnter  Send Close_Help
38083>>>>>>>>>>>        End_Object // Help_Info
38084>>>>>>>>>>>
38084>>>>>>>>>>>        on_key kcancel           send Close_Calendar
38085>>>>>>>>>>>
38085>>>>>>>>>>>
38085>>>>>>>>>>>
38085>>>>>>>>>>>
38085>>>>>>>>>>>
38085>>>>>>>>>>>
38085>>>>>>>>>>>        //AB-StoreEnd
38085>>>>>>>>>>>
38085>>>>>>>>>>>    End_Object    // oCalendar
38086>>>>>>>>>>>
38086>>>>>>>>>>>
38086>>>>>>>>>>>    //AB-StoreStart
38086>>>>>>>>>>>
38086>>>>>>>>>>>    Procedure Request_Popup_cOutlookCalendar for BaseClass
38087>>>>>>>>>>>        Integer focus# type# dm#
38088>>>>>>>>>>>
38088>>>>>>>>>>>        move (focus(desktop)) to focus#
38089>>>>>>>>>>>        if focus# gt desktop begin
38091>>>>>>>>>>>          get delegation_mode of focus# to dm#
38092>>>>>>>>>>>          set delegation_mode of focus# to no_delegate_or_error
38093>>>>>>>>>>>          get form_datatype of focus# item current to type#
38094>>>>>>>>>>>          if (type#=date_window or type#=mask_date_window) send popup to oCalendar
38097>>>>>>>>>>>          set delegation_mode of focus# to dm#
38098>>>>>>>>>>>        end
38098>>>>>>>>>>>>
38098>>>>>>>>>>>    End_Procedure
38099>>>>>>>>>>>
38099>>>>>>>>>>>    On_Key Key_Ctrl+Key_F1 Send Request_Popup_cOutlookCalendar
38100>>>>>>>>>>>    On_Key Key_Ctrl+Key_H  Send Request_Popup_cOutlookCalendar
38101>>>>>>>>>>>
38101>>>>>>>>>>>
38101>>>>>>>>>>>    //AB-StoreEnd
38101>>>>>>>>>>>
38101>>>>>>>>>>>//AB/     End_Object    // prj
38101>>>>>>>>>Use Dates.Utl
38101>>>>>>>>>
38101>>>>>>>>>   Define cStatusHelp       for "F4 = Calendar. T = Today, B = Begin of month, E = End of month."
38101>>>>>>>>>   Define cDateToday        for "T"
38101>>>>>>>>>   Define cDateBeginOfMonth for "B"
38101>>>>>>>>>   Define cDateEndOfMonth   for "E"
38101>>>>>>>>>
38101>>>>>>>>>Class cSyIntelliSense_Date_Mixin is a Message
38102>>>>>>>>>   Procedure DoDefineIntelliSenseDateMixin
38103>>>>>>>>>      Property Date    pdOriginal_Value          Public 0
38104>>>>>>>>>      Property Integer pbIntelliSense_Date_State Public dfTrue
38105>>>>>>>>>      Property Integer pbEnableCalendarPrompt    Public dfTrue
38106>>>>>>>>>      On_Key KUpArrow         Send DoAddOneDay
38107>>>>>>>>>      On_Key KDownArrow       Send DoSubOneDay
38108>>>>>>>>>   End_Procedure // DoDefineIntelliSenseDateMixin
38109>>>>>>>>>
38109>>>>>>>>>   Procedure DoAddOneDay
38110>>>>>>>>>        Integer rVal
38111>>>>>>>>>        Date dHmnia
38111>>>>>>>>>
38111>>>>>>>>>        Get Value Item 0 to dHmnia
38112>>>>>>>>>        Add 1 to dHmnia
38113>>>>>>>>>        Set Value Item 0 to dHmnia
38114>>>>>>>>>    End_Procedure // Add_One_Day
38115>>>>>>>>>
38115>>>>>>>>>    Procedure DoSubOneDay
38116>>>>>>>>>        Integer rVal
38117>>>>>>>>>        Date dHmnia
38117>>>>>>>>>
38117>>>>>>>>>        Get Value Item 0 to dHmnia
38118>>>>>>>>>        Sub 1 to dHmnia
38119>>>>>>>>>        Set Value Item 0 to dHmnia
38120>>>>>>>>>    End_Procedure // Add_One_Day
38121>>>>>>>>>
38121>>>>>>>>>   // **WvA: Augmented to store the current date-value before any changes are made
38121>>>>>>>>>   Procedure Entering returns Integer
38122>>>>>>>>>      Integer iRetVal
38123>>>>>>>>>      Date    dOriginal
38123>>>>>>>>>      Forward Get Msg_Entering to iRetVal
38125>>>>>>>>>      If (iRetVal = 0) Begin
38127>>>>>>>>>         Send DoStoreOriginalDate
38128>>>>>>>>>      End
38128>>>>>>>>>>
38128>>>>>>>>>      Procedure_Return iRetVal
38129>>>>>>>>>   End_Procedure // Entering
38130>>>>>>>>>
38130>>>>>>>>>   //**WvA: This procedure is augmented to see if the user entered a 1 or 2 digit
38130>>>>>>>>>   //       value with the intention to only change the day-part of the current date.
38130>>>>>>>>>   Procedure Next
38131>>>>>>>>>      Send DoIntelliSenseDate
38132>>>>>>>>>      Forward Send Next
38134>>>>>>>>>   End_Procedure // Next
38135>>>>>>>>>
38135>>>>>>>>>   // **WvA: Store the current date-value before any changes are made
38135>>>>>>>>>   Procedure DoStoreOriginalDate
38136>>>>>>>>>      Date    dOriginal
38137>>>>>>>>>      //If (pbIntelliSense_Date_State(Self)) Begin
38137>>>>>>>>>         Get Value Item 0 to dOriginal
38138>>>>>>>>>         Set pdOriginal_Value to dOriginal
38139>>>>>>>>>      //End
38139>>>>>>>>>   End_Procedure // DoStoreOriginalDate
38140>>>>>>>>>
38140>>>>>>>>>   Procedure DoIntelliSenseDate
38141>>>>>>>>>      Integer iCurrent iStored iDaysOffSet iSep iDate_Format bChanged iYear
38142>>>>>>>>>      Date    dCurrent dOriginal
38142>>>>>>>>>      String  sStored  sCurrent sSep sMask
38142>>>>>>>>>
38142>>>>>>>>>      Get Item_Changed_State Item 0 to bChanged
38143>>>>>>>>>      Get pdOriginal_Value to dOriginal
38144>>>>>>>>>      If (pbIntelliSense_Date_State(Self) And (bChanged)) Begin
38146>>>>>>>>>         If (dOriginal Eq 0) Sysdate4 dOriginal
38149>>>>>>>>>
38149>>>>>>>>>         // We need the masked value, because the normal value is corrected by the runtime for
38149>>>>>>>>>         // USA dates.
38149>>>>>>>>>         Get Masked_Value Item 0 to sCurrent // getting a 2 digit entered date to a datavariable results in an error.
38150>>>>>>>>>         Move (Replaces(" ",sCurrent,"")) to sCurrent
38151>>>>>>>>>         Get_Attribute DF_DATE_SEPARATOR to iSep
38154>>>>>>>>>         Move (Character(iSep)) to sSep
38155>>>>>>>>>
38155>>>>>>>>>         // Although the sep value is "/" in the European date format, the mask seperator is "-".
38155>>>>>>>>>         Move (Replaces("-",sCurrent,sSep)) to sCurrent
38156>>>>>>>>>         Move (sSep+sSep) to sMask
38157>>>>>>>>>
38157>>>>>>>>>         // Now check if the user just entered a day or a day and a month.
38157>>>>>>>>>         // Something very special is going on here. We are interpreting a string, so the format
38157>>>>>>>>>         // will always be the same, even for USA or Military dates. "99//" where 9 can be any number
38157>>>>>>>>>         //If ( (length(sCurrent) > 2) And (Right(sCurrent,2) = sMask)  ) Begin
38157>>>>>>>>>         If ((length(sCurrent) <= 4) And (Right(sCurrent,2) = sMask)) Begin
38159>>>>>>>>>            Move (replace(sMask,sCurrent,"")) to sCurrent
38160>>>>>>>>>            Move sCurrent to iCurrent
38161>>>>>>>>>            If ((iCurrent >= 1) And (iCurrent <= 31)) Begin
38163>>>>>>>>>               Get_Attribute DF_DATE_FORMAT to iDate_Format
38166>>>>>>>>>               If (iDate_Format = DF_DATE_USA) Begin
38168>>>>>>>>>                  Move (Mid( String(dOriginal),2,4)) to iDaysOffSet
38169>>>>>>>>>               End
38169>>>>>>>>>>
38169>>>>>>>>>               Else If (iDate_Format = DF_DATE_EUROPEAN) Begin
38172>>>>>>>>>                  Move (Left( String(dOriginal),2 )) to iDaysOffSet
38173>>>>>>>>>               End
38173>>>>>>>>>>
38173>>>>>>>>>               Else If (iDate_Format = DF_DATE_MILITARY) Begin
38176>>>>>>>>>                  Move (Right( String(dOriginal),2 )) to iDaysOffSet
38177>>>>>>>>>               End
38177>>>>>>>>>>
38177>>>>>>>>>               Set Value Item 0 to (Date(dOriginal - iDaysOffSet + iCurrent))
38178>>>>>>>>>            End // Let the runtime handle the error if value not in the range 1..31
38178>>>>>>>>>>
38178>>>>>>>>>         End
38178>>>>>>>>>>
38178>>>>>>>>>         Else If ((length(sCurrent) > 4) And (Right(sCurrent,1) = sSep)) Begin
38181>>>>>>>>>            Get_Attribute DF_DATE_FORMAT to iDate_Format
38184>>>>>>>>>            If ((iDate_Format = DF_DATE_USA) Or (iDate_Format = DF_DATE_EUROPEAN)) Begin
38186>>>>>>>>>               Move (Right(dOriginal,4)) to iYear
38187>>>>>>>>>            End
38187>>>>>>>>>>
38187>>>>>>>>>            Else If (iDate_Format = DF_DATE_MILITARY) Begin
38190>>>>>>>>>               Move (Left(dOriginal,4))  to iYear
38191>>>>>>>>>            End
38191>>>>>>>>>>
38191>>>>>>>>>            Set Value Item 0 to (Date(sCurrent + String(iYear)))
38192>>>>>>>>>         End
38192>>>>>>>>>>
38192>>>>>>>>>      End
38192>>>>>>>>>>
38192>>>>>>>>>   End_Procedure // DoIntelliSenseDate
38193>>>>>>>>>
38193>>>>>>>>>   Procedure Key Integer iKey Returns Integer
38194>>>>>>>>>      Date dToday dTemp
38195>>>>>>>>>      Sysdate4 dToday
38196>>>>>>>>>
38196>>>>>>>>>      If ((Character(iKey) EQ cDateToday) OR (Character(iKey) EQ Lowercase(cDateToday))) Begin
38198>>>>>>>>>         Set Value to dToday
38199>>>>>>>>>      End
38199>>>>>>>>>>
38199>>>>>>>>>      Else If ((Character(iKey) EQ cDateBeginOfMonth) OR (Character(iKey) EQ Lowercase(cDateBeginOfMonth))) Begin
38202>>>>>>>>>         Get FirstDayInMonth dToday to dTemp
38203>>>>>>>>>         Set Value to dTemp
38204>>>>>>>>>      End
38204>>>>>>>>>>
38204>>>>>>>>>      Else If ((Character(iKey) EQ cDateEndOfMonth) OR (Character(iKey) EQ Lowercase(cDateEndOfMonth))) Begin
38207>>>>>>>>>         Get LastDayInMonth dToday to dTemp
38208>>>>>>>>>         Set Value to dTemp
38209>>>>>>>>>      End
38209>>>>>>>>>>
38209>>>>>>>>>      Else Forward Send Key iKey
38212>>>>>>>>>   End_procedure
38213>>>>>>>>>
38213>>>>>>>>>End_Class // cSyIntelliSense_Date_Mixin
38214>>>>>>>
38214>>>>>>>Class cSyDateForm Is A FormSub
38215>>>>>>>   Procedure Construct_Object
38216>>>>>>>      Forward Send Construct_Object
38218>>>>>>>
38218>>>>>>>      Set Prompt_Button_Mode   to PB_PromptOn
38219>>>>>>>      Set Form_Datatype Item 0 to Mask_Date_Window
38220>>>>>>>
38220>>>>>>>      Send DoDefineIntelliSenseDateMixin
38221>>>>>>>
38221>>>>>>>      On_Key kPrompt Send Prompt
38222>>>>>>>
38222>>>>>>>      Set Prompt_Object to (oCalendar(Self))
38223>>>>>>>      Set Status_Help   to cStatusHelp
38224>>>>>>>
38224>>>>>>>   End_Procedure // Construct_Object
38225>>>>>>>
38225>>>>>>>   Import_Class_Protocol cSyIntelliSense_Date_Mixin
38226>>>>>>>
38226>>>>>>>//   Function Form_Datatype Integer iItem Returns Integer
38226>>>>>>>//      Integer iDatatype
38226>>>>>>>//
38226>>>>>>>//      If (iItem = Current) Begin
38226>>>>>>>//         Get Current_Item to iItem
38226>>>>>>>//      End
38226>>>>>>>//
38226>>>>>>>//      Forward Get Form_Datatype Item iItem to iDataType
38226>>>>>>>//
38226>>>>>>>//      Function_Return iDatatype
38226>>>>>>>//   End_Function // Form_Datatype
38226>>>>>>>
38226>>>>>>>End_Class // cSyDateForm
38227>>>>>    Use Button.Sub
38227>>>>>    Use Txtbox.Sub
38227>>>>>    Use Edit.Sub
38227>>>>>
38227>>>>>    Use TMPSAP.DD
INCLUDING FILE: TMPSAP.DD
38227>>>>>>>//DDB-FileStart
38227>>>>>>>//DDB-HeaderStart
38227>>>>>>>
38227>>>>>>>// File Name : TMPSAP.DD
38227>>>>>>>// Class Name: Tmpsap_DataDictionary
38227>>>>>>>// Revision  : 3
38227>>>>>>>// Version   : 2
38227>>>>>>>
38227>>>>>>>Use  Windows           // Basic Definitions
38227>>>>>>>Use  DataDict          // DataDictionary Class Definition
38227>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
38227>>>>>>>
38227>>>>>>>Open Tmpsap
INCLUDING FILE: TMPSAP.FD
38229>>>>>>>
38229>>>>>>>//DDB-HeaderEnd
38229>>>>>>>
38229>>>>>>>Class Tmpsap_DataDictionary  is a DataDictionary_sec
38230>>>>>>>
38230>>>>>>>    // Define_Fields:
38230>>>>>>>    // This procedure is used to set up all data-dictionary rules.
38230>>>>>>>
38230>>>>>>>    Procedure Define_Fields
38231>>>>>>>        Forward Send Define_Fields
38233>>>>>>>        //DDB-Generated-Code-Location
38233>>>>>>>        //DDB-DefineFieldStart
38233>>>>>>>
38233>>>>>>>        Set Main_File            To Tmpsap.File_Number
38234>>>>>>>
38234>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
38235>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
38236>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
38237>>>>>>>
38237>>>>>>>        // Field-based properties.......................
38237>>>>>>>
38237>>>>>>>        // Tmpsap.Date
38237>>>>>>>        Set Field_Mask_Type        Field Tmpsap.Date To MASK_DATE_WINDOW
38238>>>>>>>
38238>>>>>>>        // Tmpsap.Apestalei
38238>>>>>>>        Set Field_Checkbox_Values  Field Tmpsap.Apestalei To "1"  "0"
38239>>>>>>>        Set Field_Class_Name       Field Tmpsap.Apestalei To "dbCheckBoxSub"
38240>>>>>>>
38240>>>>>>>        // Tmpsap.Kleidomeno
38240>>>>>>>        Set Field_Checkbox_Values  Field Tmpsap.Kleidomeno To "1"  "0"
38241>>>>>>>        Set Field_Class_Name       Field Tmpsap.Kleidomeno To "dbCheckBoxSub"
38242>>>>>>>
38242>>>>>>>        //DDB-DefineFieldEnd
38242>>>>>>>    End_Procedure    // Define_Fields
38243>>>>>>>
38243>>>>>>>    // Field_Defaults:
38243>>>>>>>    // This procedure is used to establish default field values.
38243>>>>>>>
38243>>>>>>>    Procedure Field_Defaults
38244>>>>>>>        Forward Send Field_Defaults
38246>>>>>>>        //DDB-Generated-Code-Location
38246>>>>>>>        //DDB-FieldDefaultStart
38246>>>>>>>        Set Field_Changed_Value   Field Tmpsap.Apestalei To 0
38247>>>>>>>        Set Field_Changed_Value   Field Tmpsap.Kleidomeno To 0
38248>>>>>>>        //DDB-FieldDefaultEnd
38248>>>>>>>    End_Procedure    // Field_Defaults
38249>>>>>>>
38249>>>>>>>End_Class    // Tmpsap_DataDictionary
38250>>>>>>>//DDB-FileEnd
38250>>>>>    
38250>>>>>    //AB-IgnoreEnd
38250>>>>>
38250>>>>>    ACTIVATE_VIEW Activate_Vwsap FOR Vwsap
38253>>>>>
38253>>>>>    Object Vwsap is a dbView
38255>>>>>
38255>>>>>        //AB-StoreTopStart
38255>>>>>                    
38255>>>>>        Property Integer    piCount                 Public  0
38257>>>>>        Property String     psBranchPhone           Public ''
38259>>>>>        Property String     psSysfileFilesSendPath  Public ''
38261>>>>>        Property String     psBranchSendPathFiles   Public ''
38263>>>>>        Property String     psBranchSendPathConf    Public ''
38265>>>>>        Property Integer    piFtpSecondsRetry       Public  0
38267>>>>>        Property Integer    piFtpTimesExit          Public  0
38269>>>>>        Property Integer    piReceivedOK            Public  0
38271>>>>>        Property Integer    piTimesCount            Public  0
38273>>>>>        Property Integer    piFileRetreived         Public  0
38275>>>>>        Property Integer    piFromProgrammatismo    Public  0
38277>>>>>        Property Integer    piErrorOccured          Public  0
38279>>>>>        Property String     psBranchRecr            Public ''
38281>>>>>        property Integer    bConnectionStatus       public False
38283>>>>>        
38283>>>>>        External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;            Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
38284>>>>>        
38284>>>>>        Function Network_User_Name Returns String
38286>>>>>            Local String sName sLength
38287>>>>>            Local Pointer lpName_Addr lpLength_Addr
38287>>>>>            Local Integer iRetval
38287>>>>>            Movestr (Repeat (Character (0), 255)) To sName
38288>>>>>>
38288>>>>>            GetAddress Of sName To lpName_Addr
38289>>>>>            Movestr (DwordToBytes (255)) To sLength
38290>>>>>>
38290>>>>>            GetAddress Of sLength To lpLength_Addr
38291>>>>>            Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
38292>>>>>>
38292>>>>>            If iRetval Eq 0 Function_Return (CString (sName))
38295>>>>>            Else Function_Return "User Unknown"
38297>>>>>        End_Function // Network_User_Name
38298>>>>>        
38298>>>>>        Function fsVresEggrafh String asFileName returns Integer
38300>>>>>            Integer rVal
38301>>>>>            Move (UpperCase(asFileName)) to asFileName
38302>>>>>            Move (Trim(asFileName)) to asFileName
38303>>>>>            Function_Return rVal
38304>>>>>        End_Procedure
38305>>>>>        
38305>>>>>        Function fsVresExt String asFileName Returns String
38307>>>>>            String rVal
38308>>>>>            Integer iPos iLen
38308>>>>>            Move (UpperCase(asFileName)) to asFileName
38309>>>>>            Move (Trim(asFileName)) to asFileName
38310>>>>>            Move 0 to iPos
38311>>>>>            For iLen from 1 to (length(asFileName))
38317>>>>>>
38317>>>>>                If (Mid(asFileName,1,iLen)='.') Move iLen to iPos
38320>>>>>            Loop
38321>>>>>>
38321>>>>>            If (Not(iPos)) Function_Return ''
38324>>>>>            Move (Right(asFileName,(Length(asFileName)-iPos))) to rVal
38325>>>>>            Move (Trim(rVal)) to rVal
38326>>>>>            Function_Return rVal
38327>>>>>        End_Function
38328>>>>>        
38328>>>>>        Set Verify_Exit_Msg         to Get_No_Confirmation
38329>>>>>        Set Verify_Save_Msg         to Get_No_Confirmation
38330>>>>>        Set Verify_Data_Loss_Msg    to Get_No_Confirmation
38331>>>>>        
38331>>>>>        Register_Object     oInternetErrorArray
38331>>>>>        Register_Procedure  ShowInternetErrorMessage integer iInetError
38331>>>>>        
38331>>>>>        Function fiCloseDialup Returns Integer
38333>>>>>            Integer rVal iStat
38334>>>>>            If (psBranchPhone(self)<>'') Begin
38336>>>>>                If (bConnectionStatus(Self)) begin
38338>>>>>                   Move (dvInternetHangup())    to iStat
ERROR: 54 Invalid symbol in expression DVINTERNETHANGUP ON LINE: 149 (38338) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VWSAP.VW
38339>>>>>                   If iStat Eq 0 Begin
38341>>>>>                        Set bConnectionStatus   to False
38342>>>>>                        Move 1 to rVal
38343>>>>>                   End
38343>>>>>>
38343>>>>>                   Else Begin
38344>>>>>                        Move 0 to rVal
38345>>>>>                        Send Info_Box "ƒœ¤ £§¦¨é ¤˜ ¡¢œå©à «ž¤ š¨˜££ã" "¢ž¨¦­¦¨å˜"
38346>>>>>                   End
38346>>>>>>
38346>>>>>                End
38346>>>>>>
38346>>>>>                Else Move 1 to rVal
38348>>>>>            End
38348>>>>>>
38348>>>>>            Else Move 1 to rVal
38350>>>>>            Function_Return rVal
38351>>>>>        End_Function
38352>>>>>        
38352>>>>>        Function fiGetFile String asRemoteFile String asLocalFile Integer aiCancelIfExist Integer aiType Returns Integer
38354>>>>>            // aiCancelIfExist  =0 Overwrites local file if already exists
38354>>>>>            // aiCancelIfExist  =1 Cancel transfer if local file already exists
38354>>>>>            // aiType           =0 ASCII transfer method (Control and formatting
38354>>>>>            //                     information is converted to local equivalents.
38354>>>>>            //                  =1 BINARY transfer method. The file is
38354>>>>>            //                     transferred exactly as it exists with no changes.
38354>>>>>            Integer iRetVal
38355>>>>>            send AddInfo to (oStatusForm(Self)) ;                ("Šã¯ž"*asRemoteFile*"©œ"*asLocalFile-"...")
38356>>>>>            move ( dvFtpGetFile (asRemoteFile,asLocalFile,0,1)) to iRetVal
ERROR: 54 Invalid symbol in expression DVFTPGETFILE ON LINE: 175 (38356) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VWSAP.VW
38357>>>>>            if iRetVal begin
38359>>>>>                Function_Return iRetVal
38360>>>>>            end
38360>>>>>>
38360>>>>>            send AddInfo to (oStatusForm(Self)) ("’¦ ˜¨®œå¦"*asRemoteFile*"œ¢ã­Ÿœ ")
38361>>>>>            Function_Return 0
38362>>>>>        End_Function
38363>>>>>        
38363>>>>>        Function fiSendFile String asLocalFile String asRemoteFile Integer aiMode Returns Integer
38365>>>>>            // aiType           =0 ASCII transfer method (Control and formatting
38365>>>>>            //                     information is converted to local equivalents.
38365>>>>>            //                  =1 BINARY transfer method. The file is
38365>>>>>            //                     transferred exactly as it exists with no changes.
38365>>>>>            Integer iRetVal
38366>>>>>            send AddInfo to (oStatusForm(Self)) ;                ("€§¦©«¦¢ã ˜¨®œå¦¬ "*asLocalFile*"©œ"*asRemoteFile-"...")
38367>>>>>            move (dvFtpPutFile(asLocalFile,asRemoteFile,1)) to iRetVal
ERROR: 54 Invalid symbol in expression DVFTPPUTFILE ON LINE: 191 (38367) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VWSAP.VW
38368>>>>>            if iRetVal begin
38370>>>>>                Function_Return iRetVal
38371>>>>>            end
38371>>>>>>
38371>>>>>            send AddInfo to (oStatusForm (Self)) ("’¦ ˜¨®œå¦"*asLocalFile*"œ©«á¢œ ")
38372>>>>>            Function_Return 0
38373>>>>>        End_Function
38374>>>>>        
38374>>>>>        
38374>>>>>        Procedure ShowInternetErrorMessage integer iInetError
38376>>>>>            local string sMsg
38377>>>>>            move (dvGetServerMsg()) to sMsg
ERROR: 54 Invalid symbol in expression DVGETSERVERMSG ON LINE: 202 (38377) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VWSAP.VW
38378>>>>>            if (trim(sMsg)) eq "" get array_value of (oInternetErrorArray(Self)) ;                item (iInetError - 12000) to sMsg
38381>>>>>            send AddInfo to (oStatusForm(Self)) ("Error:"*sMsg) true
38382>>>>>        End_Procedure
38383>>>>>        
38383>>>>>        Object oInternetErrorArray is an Array
38385>>>>>            Procedure InitializeErrorArray
38387>>>>>                set array_value item 1   to "out of handles"
38388>>>>>                set array_value item 2   to "timeout"
38389>>>>>                set array_value item 3   to "extended error"
38390>>>>>                set array_value item 4   to "internal error"
38391>>>>>                set array_value item 5   to "invalid url"
38392>>>>>                set array_value item 6   to "unrecognized scheme"
38393>>>>>                set array_value item 7   to "name not resolved"
38394>>>>>                set array_value item 8   to "protocol not found"
38395>>>>>                set array_value item 9   to "invalid option"
38396>>>>>                set array_value item 10  to "bad option length"
38397>>>>>                set array_value item 11  to "option not settable"
38398>>>>>                set array_value item 12  to "shutdown"
38399>>>>>                set array_value item 13  to "incorrect user name"
38400>>>>>                set array_value item 14  to "incorrect password"
38401>>>>>                set array_value item 15  to "login failure"
38402>>>>>                set array_value item 16  to "invalid operation"
38403>>>>>                set array_value item 17  to "operation cancelled"
38404>>>>>                set array_value item 18  to "incorrect handle type"
38405>>>>>                set array_value item 19  to "incorrect handle state"
38406>>>>>                set array_value item 20  to "not proxy request"
38407>>>>>                set array_value item 21  to "registry value not found"
38408>>>>>                set array_value item 22  to "bad registry parameter"
38409>>>>>                set array_value item 23  to "no direct access"
38410>>>>>                set array_value item 24  to "no context"
38411>>>>>                set array_value item 25  to "no callback"
38412>>>>>                set array_value item 26  to "request pending"
38413>>>>>                set array_value item 27  to "incorrect format"
38414>>>>>                set array_value item 28  to "item not found"
38415>>>>>                set array_value item 29  to "cannot connect"
38416>>>>>                set array_value item 30  to "connection aborted"
38417>>>>>                set array_value item 31  to "connection reset"
38418>>>>>                set array_value item 32  to "force retry"
38419>>>>>                set array_value item 33  to "invalid proxy request"
38420>>>>>                set array_value item 34  to "need ui"
38421>>>>>                set array_value item 36  to "handle exists"
38422>>>>>                set array_value item 37  to "sec cert date invalid"
38423>>>>>                set array_value item 38  to "sec cert cn invalid"
38424>>>>>                set array_value item 39  to "http to https on redir"
38425>>>>>                set array_value item 40  to "https to http on_redir"
38426>>>>>                set array_value item 41  to "mixed security"
38427>>>>>                set array_value item 42  to "chg post is non secure"
38428>>>>>                set array_value item 43  to "post is non_secure"
38429>>>>>                set array_value item 44  to "client auth cert needed"
38430>>>>>                set array_value item 45  to "invalid ca"
38431>>>>>                set array_value item 46  to "client auth not setup"
38432>>>>>                set array_value item 47  to "async thread failed"
38433>>>>>                set array_value item 48  to "redirect scheme change"
38434>>>>>                set array_value item 49  to "dialog pending"
38435>>>>>                set array_value item 50  to "retry dialog"
38436>>>>>                set array_value item 110 to "ftp transfer in progress"
38437>>>>>                set array_value item 111 to "ftp dropped"
38438>>>>>                set array_value item 112 to "ftp no passive mode"
38439>>>>>                set array_value item 157 to "security channel error"
38440>>>>>                set array_value item 158 to "unable to cache file"
38441>>>>>                set array_value item 159 to "tcpip not installed"
38442>>>>>                set array_value item 163 to "disconnected"
38443>>>>>                set array_value item 164 to "server unreachable"
38444>>>>>                set array_value item 165 to "proxy server unreachable"
38445>>>>>            End_Procedure
38446>>>>>        End_Object
38447>>>>>        
38447>>>>>        
38447>>>>>        
38447>>>>>        
38447>>>>>        //////////////////////////////////////////////////////
38447>>>>>        
38447>>>>>        Register_Function Validate_Password Returns Integer
38447>>>>>        Register_Function fisapok Returns Integer
38447>>>>>        
38447>>>>>        Property Integer piLathi Public 0
38449>>>>>        
38449>>>>>        //AB-StoreTopEnd
38449>>>>>
38449>>>>>        Set Label to "˜¨˜®Ÿâ¤«˜ €¨®œå˜ ‘€"
38450>>>>>        Set Size to 282 521
38451>>>>>        Set Location to 1 5
38452>>>>>
38452>>>>>        //AB-DDOStart
38452>>>>>
38452>>>>>        Object Tmpsap_DD is a Tmpsap_DataDictionary
38454>>>>>
38454>>>>>            //AB-StoreTopStart
38454>>>>>                                                                                                                                                                                                                                        
38454>>>>>            //AB-StoreTopEnd
38454>>>>>
38454>>>>>
38454>>>>>            //AB-StoreStart
38454>>>>>                                                                                                                                                                                                                                        
38454>>>>>            Procedure Request_Save
38456>>>>>            End_Procedure
38457>>>>>            
38457>>>>>            Procedure Request_Delete
38459>>>>>            End_Procedure
38460>>>>>            
38460>>>>>            
38460>>>>>            //AB-StoreEnd
38460>>>>>
38460>>>>>        End_Object    // Tmpsap_DD
38461>>>>>
38461>>>>>        Set Main_DD to (Tmpsap_DD(self))
38462>>>>>        Set Server to (Tmpsap_DD(self))
38463>>>>>
38463>>>>>        //AB-DDOEnd
38463>>>>>
38463>>>>>        Object frmPassw is a FormSub
38465>>>>>
38465>>>>>            //AB-StoreTopStart
38465>>>>>                                                                                                                                                                                                                                                                                                                    
38465>>>>>            //AB-StoreTopEnd
38465>>>>>
38465>>>>>            Set Size to 13 85
38466>>>>>            Set Location to 29 200
38467>>>>>            Set Label_Col_Offset to 2
38468>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38469>>>>>            Set Password_State Item 0 to TRUE
38470>>>>>
38470>>>>>            //AB-StoreStart
38470>>>>>                                                                                                                                                                                                                                                                                                                    
38470>>>>>            Procedure OnChange
38472>>>>>                Integer isValid
38473>>>>>                Move (Validate_Password(Self))  to isValid
38474>>>>>                Set Enabled_State Of btnDelete  to (isValid=1)
38475>>>>>                Set Enabled_State Of btnSend    to (isValid=1)
38476>>>>>            
38476>>>>>                If (isValid=1) Begin
38478>>>>>                    Set Enabled_State Of frmHmnia to True
38479>>>>>                End
38479>>>>>>
38479>>>>>                Else Begin
38480>>>>>                    Set Value Of frmHmnia Item 0 to ''
38481>>>>>                    Set Enabled_State Of frmHmnia to False
38482>>>>>                End
38482>>>>>>
38482>>>>>            End_Procedure
38483>>>>>            
38483>>>>>            
38483>>>>>            
38483>>>>>            
38483>>>>>            //AB-StoreEnd
38483>>>>>
38483>>>>>        End_Object    // frmPassw
38484>>>>>
38484>>>>>        Object frmHmnia is a cSyDateForm
38486>>>>>            Set Size to 13 66
38487>>>>>            Set Location to 28 310
38488>>>>>            Set Label_Col_Offset to 2
38489>>>>>            Set Label_Justification_Mode to jMode_Right
38490>>>>>            Set Form_Mask Item 0 to "dd/MM/yyyy"
38491>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38492>>>>>        End_Object    // frmHmnia
38493>>>>>
38493>>>>>        Object btnDelete is a ButtonSub
38495>>>>>
38495>>>>>            //AB-StoreTopStart
38495>>>>>            
38495>>>>>            //AB-StoreTopEnd
38495>>>>>
38495>>>>>            Set Label to "€¤˜å¨œ©ž ‚â­¬¨˜ª"
38496>>>>>            Set Size to 14 94
38497>>>>>            Set Location to 26 417
38498>>>>>            Set Focus_Mode to Pointer_Only
38499>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38500>>>>>
38500>>>>>            //AB-StoreStart
38500>>>>>            
38500>>>>>            
38500>>>>>            //Procedure Anoixe_Hmeromhnies Date adHmnia
38500>>>>>            //    String sComp sBranch
38500>>>>>            //    clear Branch
38500>>>>>            //    move SysCurXR.Company_Code to Branch.Company_Code
38500>>>>>            //    Find GE Branch By Index.1
38500>>>>>            //    While ((Found) And (Branch.Company_Code=SysCurXR.Company_Code))
38500>>>>>            //        Reread Branch
38500>>>>>            //        If (Branch.Date_Locked   =adHmnia) Move (adHmnia-1) to Branch.Date_Locked
38500>>>>>            //        If (Branch.Last_Hmnia_Ekt=adHmnia) Move (adHmnia-1) to Branch.Last_Hmnia_Ekt
38500>>>>>            //        Saverecord branch
38500>>>>>            //        Unlock
38500>>>>>            //        Find GT Branch By Index.1
38500>>>>>            //    Loop
38500>>>>>            //End_Procedure
38500>>>>>            
38500>>>>>            
38500>>>>>            Procedure OnClick
38502>>>>>                Integer iID iErr iYes iInt
38503>>>>>                Date    dHmnia
38503>>>>>                String  sMess
38503>>>>>                Get Value Of frmHmnia Item 0 to dHmnia
38504>>>>>                If (dHmnia='') Begin
38506>>>>>                    Send Stop_Box '†£œ¨¦£ž¤å˜ ¡œ¤ã' '‘­á¢£˜ 5555'
38507>>>>>                    Procedure_Return
38508>>>>>                End
38508>>>>>>
38508>>>>>            
38508>>>>>                Get fisapok Of vwSap dHmnia to iInt
38509>>>>>            
38509>>>>>                // 1. Elegxos an yparxei progenesterh hmeromhnia anoixth
38509>>>>>                //If (iInt=1) Send Stop_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '‘­á¢£˜ 4001'
38509>>>>>                // 2. Elegxos an yparxei h sygkekrimenh hmeromhnia kai einai kleidomenh
38509>>>>>                //If (iInt=2) Send Stop_Box '“§á¨®œ  ã›ž ž ž£œ¨¦£ž¤å˜ ¡˜  œå¤˜  ¡¢œ ›à£â¤ž' '‘­á¢£˜ 4002'
38509>>>>>                // 3. Elegxos an yparxei epomenh hmeromhnia
38509>>>>>                If (iInt=4) Send Stop_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ©«¦ ˜¨®œå¦' '‘­á¢£˜ 4004'
38512>>>>>                // 4. Elegxos an exei trexei h prohgoumenh hmera
38512>>>>>                If (iInt=3) Send Stop_Box '¨¦¡ç§«œ  › ˜­¦¨á ž£œ¨¦£ž¤ é¤ > 1' '‘­á¢£˜ 4003'
38515>>>>>            
38515>>>>>                If (iInt<>0) Procedure_Return
38518>>>>>            
38518>>>>>                Move ('Œ˜ œ¢œ¬Ÿœ¨é©à æ¢œª « ª œšš¨˜­âª §¦¬ œ®¦¬¤ ©«˜¢œå ©«¦ ‘€ £œ ž£œ¨/¤å˜ '+String(dHmnia)+' ?') to sMess
38519>>>>>                Get YesNo_Box sMess to iYes
38520>>>>>                If (iYes=MBR_NO) Procedure_Return
38523>>>>>            
38523>>>>>                Indicate Err False
38524>>>>>                Move Error_Object_ID to iID
38525>>>>>            
38525>>>>>                Send ChangeAllFileModes DF_Filemode_ReadOnly
38526>>>>>                Set_Attribute DF_File_Mode Of tmpSap.File_Number    To DF_Filemode_Default
38529>>>>>                Set_Attribute DF_File_Mode Of Particle.File_Number  To DF_Filemode_Default
38532>>>>>                Set_Attribute DF_File_Mode Of Cmoves.File_Number    To DF_Filemode_Default
38535>>>>>                Set_Attribute DF_File_Mode Of Wcmoves.File_Number   To DF_Filemode_Default
38538>>>>>                Set_Attribute DF_File_Mode Of WitemxTr.File_Number  To DF_Filemode_Default
38541>>>>>                Set_Attribute DF_File_Mode Of ItemTehn.File_Number  To DF_Filemode_Default
38544>>>>>                Set_Attribute DF_File_Mode Of Clients.File_Number   To DF_Filemode_Default
38547>>>>>                Set_Attribute DF_File_Mode Of Company.File_Number   To DF_Filemode_Default
38550>>>>>                Set_Attribute DF_File_Mode Of Branch.File_Number    To DF_Filemode_Default
38553>>>>>            
38553>>>>>                Begin_Transaction
38554>>>>>                    Send Eleyterose_Kinhseis_Sap dHmnia
38555>>>>>                    Clear tmpSap
38556>>>>>                    Move dHmnia to tmpSap.Date
38557>>>>>                    Find Eq tmpSap By Index.1
38558>>>>>>
38558>>>>>                    If (Not(Found)) Error 5000
38561>>>>>                    Delete tmpSap
38562>>>>>                    Move (Err) to iErr
38563>>>>>                    If (iErr<>0) Error 5006
38566>>>>>            //--------
38566>>>>>            // Telika eipame na mhn anoixoume tis hmeromhnies kleidomatos
38566>>>>>            // parastatikon kai oristikopoihshs axiografon giati mporei na
38566>>>>>            // mhn prepei. An xreiastei, tha pame apo tis epimerous piso
38566>>>>>            // portes na ta anoixoume
38566>>>>>            //        Send Anoixe_Hmeromhnies dHmnia
38566>>>>>            //        Move (Err) to iErr
38566>>>>>            //        If (iErr<>0) Error 5007
38566>>>>>            //--------
38566>>>>>                    Send Beginning_Of_Data to The_Table True
38567>>>>>                End_Transaction
38568>>>>>            
38568>>>>>                Unlock
38569>>>>>>
38569>>>>>                If (Err) Begin
38571>>>>>                    Send Stop_Box 'Ž  œšš¨˜­âª ƒ„Œ œ¢œ¬Ÿœ¨éŸž¡˜¤ ¢æšà ©­á¢£˜«¦ª' ('‘­á¢£˜ '+(String(iErr)))
38572>>>>>                End
38572>>>>>>
38572>>>>>            
38572>>>>>                Send ChangeAllFileModes DF_Filemode_Default
38573>>>>>                Move iID to  Error_Object_ID
38574>>>>>            End_Procedure // OnClick
38575>>>>>            
38575>>>>>            Procedure Eleyterose_Kinhseis_Sap Date adHmnia
38577>>>>>                Integer iID iErr inum
38578>>>>>                Date dNullHmnia
38578>>>>>                Move '01/01/1753' to dNullHmnia
38579>>>>>            
38579>>>>>                // Clients
38579>>>>>                Clear Clients
38580>>>>>                Move adHmnia to Clients.Sap_Hmnia
38581>>>>>                Find Gt Clients By index.11
38582>>>>>>
38582>>>>>                While ((Found) And (Clients.Sap_Hmnia=adHmnia))
38586>>>>>                    Set Label Of btnMess    to ('œ¢á«œª '+String(Clients.Recnum))
38587>>>>>                    Move dNullHmnia         to Clients.Sap_Hmnia
38588>>>>>                    if (clients.status = '3') move '1' to clients.status
38591>>>>>                    else if (clients.status = '2') move '' to clients.status
38595>>>>>                    Saverecord Clients
38596>>>>>                    //Unlock
38596>>>>>                    Move (Err) to iErr
38597>>>>>                    If (iErr<>0) Error 5001
38600>>>>>                    Clear Clients
38601>>>>>                    Move adHmnia            to Clients.Sap_Hmnia
38602>>>>>                    Find Gt Clients By Index.11
38603>>>>>>
38603>>>>>                Loop
38604>>>>>>
38604>>>>>            
38604>>>>>                // Particle
38604>>>>>                Clear Particle
38605>>>>>                Move adHmnia to Particle.Sap_Hmnia
38606>>>>>                Find Gt Particle By 17
38607>>>>>>
38607>>>>>                While ((Found) And (Particle.Sap_Hmnia=adHmnia))
38611>>>>>                    //Reread Particle
38611>>>>>                    Set Label Of btnMess    to ('˜¨˜©«˜« ¡á '+String(Particle.Recnum))
38612>>>>>                    Move dNullHmnia         to Particle.Sap_Hmnia
38613>>>>>                    Saverecord Particle
38614>>>>>                    //Unlock
38614>>>>>                    Move (Err) to iErr
38615>>>>>                    If (iErr<>0) Error 5001
38618>>>>>                    Clear Particle
38619>>>>>                    Move adHmnia            to Particle.Sap_Hmnia
38620>>>>>                    Find Gt Particle By 17
38621>>>>>>
38621>>>>>                Loop
38622>>>>>>
38622>>>>>            
38622>>>>>                // Cmoves
38622>>>>>                Clear Cmoves
38623>>>>>                Move adHmnia to Cmoves.Sap_Hmnia
38624>>>>>                Find Gt Cmoves By 16
38625>>>>>>
38625>>>>>                While ((Found) And (Cmoves.Sap_Hmnia=adHmnia))
38629>>>>>                    //Reread Cmoves
38629>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª œ¢˜«é¤ '+String(Cmoves.Recnum))
38630>>>>>                    Move dNullHmnia to Cmoves.Sap_Hmnia
38631>>>>>                    Saverecord Cmoves
38632>>>>>                    //Unlock
38632>>>>>                    Move (Err) to iErr
38633>>>>>                    If (iErr<>0) Error 5002
38636>>>>>                    Clear Cmoves
38637>>>>>                    Move adHmnia to Cmoves.Sap_Hmnia
38638>>>>>                    Find Gt Cmoves By 16
38639>>>>>>
38639>>>>>                Loop
38640>>>>>>
38640>>>>>            
38640>>>>>                // wcmoves
38640>>>>>                Clear wcmoves
38641>>>>>                Move adHmnia to wcmoves.Sap_Hmnia
38642>>>>>                Find Gt wcmoves By 16
38643>>>>>>
38643>>>>>                While ((Found) And (wcmoves.Sap_Hmnia=adHmnia))
38647>>>>>                    //Reread wcmoves
38647>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª €§¦Ÿž¡é¤ '+String(wcmoves.Recnum))
38648>>>>>                    Move dNullHmnia to wcmoves.Sap_Hmnia
38649>>>>>                    Saverecord wcmoves
38650>>>>>                    //Unlock
38650>>>>>                    Move (Err) to iErr
38651>>>>>                    If (iErr<>0) Error 5003
38654>>>>>                    Clear wcmoves
38655>>>>>                    Move adHmnia to wcmoves.Sap_Hmnia
38656>>>>>                    Find Gt wcmoves By 16
38657>>>>>>
38657>>>>>                Loop
38658>>>>>>
38658>>>>>            
38658>>>>>                // WitemxTr
38658>>>>>                Clear WitemxTr
38659>>>>>                Move adHmnia to WitemxTr.Sap_Hmnia
38660>>>>>                Find Gt WitemxTr By Index.4
38661>>>>>>
38661>>>>>                While ((Found) And (WitemxTr.Sap_Hmnia=adHmnia))
38665>>>>>                    //Reread WitemxTr
38665>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª ƒ ˜¡ ¤ã©œà¤ '+String(WitemxTr.Recnum))
38666>>>>>                    Move dNullHmnia to WitemxTr.Sap_Hmnia
38667>>>>>                    Saverecord WitemxTr
38668>>>>>                    //Unlock
38668>>>>>                    Move (Err) to iErr
38669>>>>>                    If (iErr<>0) Error 5004
38672>>>>>                    Clear WitemxTr
38673>>>>>                    Move adHmnia to WitemxTr.Sap_Hmnia
38674>>>>>                    Find Gt WitemxTr By Index.4
38675>>>>>>
38675>>>>>                Loop
38676>>>>>>
38676>>>>>            
38676>>>>>                // ItemTehn
38676>>>>>                Clear ItemTehn
38677>>>>>                Move adHmnia to ItemTehn.Sap_Hmnia
38678>>>>>                Find Gt ItemTehn By Index.4
38679>>>>>>
38679>>>>>                While ((Found) And (ItemTehn.Sap_Hmnia=adHmnia))
38683>>>>>                    //Reread ItemTehn
38683>>>>>                    Set Label Of btnMess    to ('‰ ¤ã©œ ª ¨¦› ˜š¨˜­é¤ '+String(ItemTehn.Recnum))
38684>>>>>                    Move dNullHmnia to ItemTehn.Sap_Hmnia
38685>>>>>                    Saverecord ItemTehn
38686>>>>>                    //Unlock
38686>>>>>                    Move (Err) to iErr
38687>>>>>                    If (iErr<>0) Error 5005
38690>>>>>                    Clear ItemTehn
38691>>>>>                    Move adHmnia to ItemTehn.Sap_Hmnia
38692>>>>>                    Find Gt ItemTehn By Index.4
38693>>>>>>
38693>>>>>                Loop
38694>>>>>>
38694>>>>>            End_Procedure
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            
38695>>>>>            //AB-StoreEnd
38695>>>>>
38695>>>>>        End_Object    // btnDelete
38696>>>>>
38696>>>>>        Object btnSend is a ButtonSub
38698>>>>>
38698>>>>>            //AB-StoreTopStart
38698>>>>>                                                                                                                                                                    
38698>>>>>            //AB-StoreTopEnd
38698>>>>>
38698>>>>>            Set Label to "€§¦©«¦¢ã €¨®œåà¤ ASCII"
38699>>>>>            Set Size to 14 94
38700>>>>>            Set Location to 52 302
38701>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38702>>>>>
38702>>>>>            //AB-StoreStart
38702>>>>>                                                                                                                                                                    
38702>>>>>            Procedure OnClick
38704>>>>>                Date    dHmnia
38705>>>>>                Integer iYear iMonth iDay iYes iCount iFileExist
38705>>>>>                String  sYear sMonth sDay sHmnia sCode
38705>>>>>                String  sFile1 sFile2 sFile3 sFile4 sFile5 sFile6
38705>>>>>                // Panta 6 arxeia to onoma ton opoion apoteleitai apo 15 psifia kai einai sto C:\ (Root)
38705>>>>>                // 4 xar    Kodikos Etairias    =   Company.Company_C_Code0
38705>>>>>                // 3 xar    Kodikos Arxeiou     =   FI1 /FI2 / FI3 / MM1 / PP1 / PP2
38705>>>>>                // 4 xar    Etos                =   Data Entry Othonis = Hmeromhnia Apostolhs/Kleisimatos
38705>>>>>                // 2 xar    Mhnas               =   Data Entry Othonis = Hmeromhnia Apostolhs/Kleisimatos
38705>>>>>                // 2 xar    Hmera               =   Data Entry Othonis = Hmeromhnia Apostolhs/Kleisimatos
38705>>>>>            
38705>>>>>                // Ftiaxnoume ta onomata ton 6 arxeion pou perimenoume na vroume
38705>>>>>                Clear Company
38706>>>>>                Move SyscurXR.Company_Code to Company.Company_Code
38707>>>>>                Find Eq Company By Index.1
38708>>>>>>
38708>>>>>                If (Not(Found)) Begin
38710>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡˜¤ «˜ ©«¦ ®œå˜ «žª œ«˜ ¨å˜ª' '‘­á¢£˜ 1001'
38711>>>>>                    Procedure_Return
38712>>>>>                End
38712>>>>>>
38712>>>>>                If (Trim(Company.Company_C_Code0)='') Begin
38714>>>>>                    Send Stop_Box 'ƒœ¤ ¬§á¨®œ  ¡à› ¡æª ‘€\n©«˜ ©«¦ ®œå˜ «žª œ«˜ ¨å˜ª\n(Company.Company_C_Code0)' '‘­á¢£˜ 1002'
38715>>>>>                    Procedure_Return
38716>>>>>                End
38716>>>>>>
38716>>>>>            
38716>>>>>                Move (Trim(Company.Company_C_Code0)) to sCode
38717>>>>>                Move (Trim(sCode))  to sCode
38718>>>>>                If (Length(sCode)<>4) Begin
38720>>>>>                    Send Stop_Box 'Ž ¡à› ¡æª ‘€ ›œ¤ œå¤˜  4 ¯ã­ ¦ª\n©«˜ ©«¦ ®œå˜ «žª œ«˜ ¨å˜ª\n(Company.Company_C_Code0)' '‘­á¢£˜ 1003'
38721>>>>>                    Procedure_Return
38722>>>>>                End
38722>>>>>>
38722>>>>>            
38722>>>>>                Get Value Of frmHmnia Item 0 to dHmnia
38723>>>>>                If (dHmnia='') Begin
38725>>>>>                    Send Stop_Box 'ƒœ¤ §¢ž¡«¦¢¦šã©˜«œ ž£œ¨¦£ž¤å˜ ˜§¦©«¦¢ãª' '‘­á¢£˜ 1004'
38726>>>>>                    Procedure_Return
38727>>>>>                End
38727>>>>>>
38727>>>>>            
38727>>>>>                Clear tmpSap
38728>>>>>                Move dHmnia to tmpSap.Date
38729>>>>>                Find Eq tmpSap By Index.1
38730>>>>>>
38730>>>>>                If (Not(Found)) Begin
38732>>>>>                    Send Stop_Box '€¤ç§˜¨¡«ž ž£œ¨¦£ž¤å˜ ˜§¦©«¦¢ãª\n©«¦ §¨¦©à¨ ¤æ ˜¨®œå¦ tmpSap' '‘­á¢£˜ 1005'
38733>>>>>                    Procedure_Return
38734>>>>>                End
38734>>>>>>
38734>>>>>                If (tmpSap.Kleidomeno<>1) Begin
38736>>>>>                    Send Stop_Box '† ž£œ¨¦£ž¤å˜ §¦¬ ž«ã©˜«œ ƒ„Œ â®œ  ¡¢œ ›àŸœå.' '‘­á¢£˜ 1006'
38737>>>>>                    Procedure_Return
38738>>>>>                End
38738>>>>>>
38738>>>>>                If (tmpSap.Apestalei=1) Begin
38740>>>>>                    Get YesNo_Box '† ž£œ¨¦£ž¤å˜ §¦¬ ž«ã©˜«œ â®œ  ã›ž ˜§¦©«˜¢œå\nŒ˜ ©«˜¢œå œ¡ ¤â¦¬ ?' to iYes
38741>>>>>                    If (iYes=MBR_NO) Procedure_Return
38744>>>>>                End
38744>>>>>>
38744>>>>>                Move (TheYearSegment (dHmnia)) to iYear
38745>>>>>                Move (TheMonthSegment(dHmnia)) to iMonth
38746>>>>>                Move (TheDaySegment  (dHmnia)) to iDay
38747>>>>>                Move iYear  to sYear
38748>>>>>                Move iMonth to sMonth
38749>>>>>                Move iDay   to sDay
38750>>>>>                If (Length(iMonth)=1) Insert '0' in sMonth  at 1
38754>>>>>                If (Length(iDay  )=1) Insert '0' in sDay    at 1
38758>>>>>                Move (Trim(sMonth)) to sMonth
38759>>>>>                Move (Trim(sDay))   to sDay
38760>>>>>                If ((Length(sMonth)<>2) Or (Length(sDay)<>2)) Begin
38762>>>>>                    Send Stop_Box '¨¦¡ç§«œ  §¨æ™¢ž£˜ ©«¦¤ £ã¤˜ ã ©«ž¤ ž£â¨˜' '‘­á¢£˜ 1007'
38763>>>>>                    Procedure_Return
38764>>>>>                End
38764>>>>>>
38764>>>>>                Move ('C:\'+Trim(sCode)+'FI1'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile1
38765>>>>>                Move ('C:\'+Trim(sCode)+'FI2'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile2
38766>>>>>                Move ('C:\'+Trim(sCode)+'FI3'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile3
38767>>>>>                Move ('C:\'+Trim(sCode)+'MM1'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile4
38768>>>>>                Move ('C:\'+Trim(sCode)+'PP1'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile5
38769>>>>>                Move ('C:\'+Trim(sCode)+'PP2'+Trim(sYear)+Trim(sMonth)+Trim(sDay)+'.txt') to sFile6
38770>>>>>            
38770>>>>>                Get Get_File_Exists sFile1 to iFileExist
38771>>>>>                If (Not(iFileExist)) Begin
38773>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ FI1' '‘­á¢£˜ 1008'
38774>>>>>                    Procedure_Return
38775>>>>>                End
38775>>>>>>
38775>>>>>                Get Get_File_Exists sFile2 to iFileExist
38776>>>>>                If (Not(iFileExist)) Begin
38778>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ FI2' '‘­á¢£˜ 1009'
38779>>>>>                    Procedure_Return
38780>>>>>                End
38780>>>>>>
38780>>>>>                Get Get_File_Exists sFile3 to iFileExist
38781>>>>>                If (Not(iFileExist)) Begin
38783>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ FI3' '‘­á¢£˜ 1010'
38784>>>>>                    Procedure_Return
38785>>>>>                End
38785>>>>>>
38785>>>>>                Get Get_File_Exists sFile4 to iFileExist
38786>>>>>                If (Not(iFileExist)) Begin
38788>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ MM1' '‘­á¢£˜ 1011'
38789>>>>>                    Procedure_Return
38790>>>>>                End
38790>>>>>>
38790>>>>>                Get Get_File_Exists sFile5 to iFileExist
38791>>>>>                If (Not(iFileExist)) Begin
38793>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ PP1' '‘­á¢£˜ 1012'
38794>>>>>                    Procedure_Return
38795>>>>>                End
38795>>>>>>
38795>>>>>                Get Get_File_Exists sFile6 to iFileExist
38796>>>>>                If (Not(iFileExist)) Begin
38798>>>>>                    Send Stop_Box 'ƒœ¤ ™¨âŸž¡œ «¦ ˜¨®œå¦ PP2' '‘­á¢£˜ 1013'
38799>>>>>                    Procedure_Return
38800>>>>>                End
38800>>>>>>
38800>>>>>            
38800>>>>>                Send Info_Box 'ALL FILES OK' 'INFO'
38801>>>>>            
38801>>>>>            
38801>>>>>            End_Procedure // OnClick
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            //Object TimerObj Is A DFTimer
38802>>>>>            
38802>>>>>            //    Property Integer piForesCount   Public  0
38802>>>>>            //    Property String  psRemFile   Public ''
38802>>>>>            //    Property String  psLocFile    Public ''
38802>>>>>            
38802>>>>>            //    Set Auto_Start_State    to False
38802>>>>>            //    Set Auto_Stop_State     to False
38802>>>>>            
38802>>>>>            //    Procedure OnTimer
38802>>>>>            //        Integer iCount rVal
38802>>>>>            //        Get piForesCount to iCount
38802>>>>>            //        // Anamonh gia arxeio epibebaioshs
38802>>>>>            //        send AddInfo to (oStatusForm (Self)) ("œ¨ £â¤à ¢ã¯ž ˜¨®œå¦¬ "*(Trim(psRemFile(Self)))-"...")
38802>>>>>            //        Increment iCount
38802>>>>>            //        Get fiGetFile Of FtpView (psRemFile(Self)) (psLocFile(Self)) 0 1 to rVal
38802>>>>>            //        If (Not(rVal)) Begin
38802>>>>>            //            Set piFileRetreived to 1
38802>>>>>            //            Send Stop_Timer
38802>>>>>            //        End
38802>>>>>            //        Set piForesCount to iCount
38802>>>>>            //        If (iCount>(piFtpTimesExit(Self))) Send Stop_Timer
38802>>>>>            //    End_Procedure
38802>>>>>            
38802>>>>>            //End_Object
38802>>>>>            
38802>>>>>            //Procedure Start_Timer String asRemoteFile String asLocalFile
38802>>>>>            //    Set piFileRetreived                         to 0
38802>>>>>            //    Set piForesCount        of (TimerObj(Self)) to 0
38802>>>>>            //    Set psRemFile           of (TimerObj(Self)) to (Trim(asRemoteFile))
38802>>>>>            //    Set psLocFile           of (TimerObj(Self)) to (Trim(asLocalFile))
38802>>>>>            //    Set Timeout             of (TimerObj(Self)) to (piFtpSecondsRetry(Self)*1000)
38802>>>>>            //    Set Timer_Active_State  of (TimerObj(Self)) to True // Starts timer
38802>>>>>            //End_Procedure
38802>>>>>            
38802>>>>>            
38802>>>>>            //Procedure Stop_Timer
38802>>>>>            //    Integer iFileRetreived iMetr iRecnum iStat
38802>>>>>            //    String  sFile
38802>>>>>            //    Date    dHmnia dHmnia2
38802>>>>>            
38802>>>>>            //    Get Value Of frmHmnia Item 0 to dHmnia2
38802>>>>>            //    Set Timer_Active_State of (TimerObj(Self)) to False // Stops Timer
38802>>>>>            //    // Check property set by timer if zrok.txt is received
38802>>>>>            
38802>>>>>            //    Get fiCloseDialup   to iStat
38802>>>>>            
38802>>>>>            //    Get piFileRetreived to iFileRetreived
38802>>>>>            
38802>>>>>            //    If (Not(iFileRetreived)) Begin
38802>>>>>            //        Send Info_Box 'ƒœ¤ œ¢ã­Ÿœ  «¦ ˜¨®œå¦ œ§ ™œ™˜åà©žª' '¢ž¨¦­¦¨å˜'
38802>>>>>            //        Procedure_Return
38802>>>>>            //    End
38802>>>>>            //    Get psLocFile Of TimerObj   to sFile
38802>>>>>            //    Move (Trim(sFile))          to sFile
38802>>>>>            //    send AddInfo to (oStatusForm (Self)) ("’¦ ˜¨®œå¦ œ¢ã­Ÿœ  - "*sFile-" - ...")
38802>>>>>            //    // Read zrok.txt and flag Hmerprog for all recnums
38802>>>>>            //    // in zrok.txt that records were correctly sent
38802>>>>>            //    Direct_Input Channel 9 sFile
38802>>>>>            //    Move 0 to iMetr
38802>>>>>            //    Readln Channel 9 dHmnia
38802>>>>>            //    If (Seqeof) Begin
38802>>>>>            //        Send Info_Box '’¦ ˜¨®œå¦ zrok.txt ›œ¤ ¬§á¨®œ  ã œå¤˜  á›œ ¦' '¢ž¨¦­¦¨å˜'
38802>>>>>            //        Procedure_Return
38802>>>>>            //    End
38802>>>>>            
38802>>>>>            //    If (dHmnia=dHmnia2) Begin
38802>>>>>            
38802>>>>>            //        Send Info_Box '† ˜§¦©«¦¢ã ¡˜  ž ¢ã¯ž ¦¢¦¡¢ž¨éŸž¡˜¤' '¢ž¨¦­¦¨å˜'
38802>>>>>            //    End
38802>>>>>            
38802>>>>>            //    Send Delete_Data    to oStatusForm
38802>>>>>            //    Set Value of frmMessage Item 0 to ''
38802>>>>>            //    Send Paint          to oStatusForm
38802>>>>>            //    Send KeyAction to btn_Select
38802>>>>>            //End_Procedure
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            ////    Integer isOK rVal iMetr iRecnum iFileRetreived isAvailable iStat
38802>>>>>            ////    String  sFtp sUser sPassword sDir sConnectString sConnectCommand
38802>>>>>            ////    String  sBranchSendPathFiles sBranchSendPathConf sLocalFile sRemoteFile
38802>>>>>            ////    String  sSysfileFilesSendPath sFullFileName sFileName sStr
38802>>>>>            ////    Integer isConnected iSelectCount iInt iSelRec iErr iClientId iObj
38802>>>>>            
38802>>>>>            ////    Set Value of frmMessage Item 0 to ''
38802>>>>>            ////    Send Delete_Data    to oStatusForm
38802>>>>>            ////    Send Paint          to oStatusForm
38802>>>>>            
38802>>>>>            ////    Clear Branch
38802>>>>>            ////    Move Syscurxr.Company_Code      to Branch.Company_Code
38802>>>>>            ////    Move Syscurxr.Branch_Code       to Branch.Branch_Code
38802>>>>>            ////    Find Eq Branch By Index.1
38802>>>>>            
38802>>>>>            ////    Move Branch.SEND_PATH_FILES     to sBranchSendPathFiles
38802>>>>>            ////    Move Branch.SEND_PATH_CONF      to sBranchSendPathConf
38802>>>>>            ////    Move Sysfile.FILES_SEND_PATH    to sSysfileFilesSendPath
38802>>>>>            
38802>>>>>            ////    Get Value Of frmAddress     to sFtp
38802>>>>>            ////    Get Value Of frmUserName    to sUser
38802>>>>>            ////    Get Value Of frmPassword    to sPassword
38802>>>>>            ////    Get Value Of frmDirectory   to sDir
38802>>>>>            
38802>>>>>            ////    Move (Trim(sFtp))           to sFtp
38802>>>>>            ////    Move (Trim(sUser))          to sUser
38802>>>>>            ////    Move (Trim(sPassword))      to sPassword
38802>>>>>            ////    Move (Trim(sDir))           to sDir
38802>>>>>            
38802>>>>>            ////    Move sSysfileFilesSendPath  to sLocalFile
38802>>>>>            ////    Move (Trim(sLocalFile))     to sLocalFile
38802>>>>>            ////    Append sLocalFile 'zsok.txt'
38802>>>>>            ////    Move (Trim(sLocalFile)) to sLocalFile
38802>>>>>            ////    EraseFile sLocalFile
38802>>>>>            
38802>>>>>            ////    Move sSysfileFilesSendPath  to sLocalFile
38802>>>>>            ////    Move (Trim(sLocalFile))     to sLocalFile
38802>>>>>            ////    Append sLocalFile 'zsendd.txt'
38802>>>>>            ////    EraseFile sLocalFile
38802>>>>>            
38802>>>>>            ////    Move sSysfileFilesSendPath  to sLocalFile
38802>>>>>            ////    Move (Trim(sLocalFile))     to sLocalFile
38802>>>>>            ////    Append sLocalFile 'zbtnemp.txt'
38802>>>>>            ////    EraseFile sLocalFile
38802>>>>>            
38802>>>>>            ////    EraseFile 'C:\Welcome.txt'
38802>>>>>            ////    Send Delete_Data    to oStatusForm
38802>>>>>            ////    Set Value of frmMessage Item 0 to ''
38802>>>>>            
38802>>>>>            ////    Get fiFTPVerify to isOK
38802>>>>>            
38802>>>>>            ////    If (isOK=1) Begin
38802>>>>>            
38802>>>>>            //////////////////////////////////////////////////////////////////////
38802>>>>>            ////        If (psBranchPhone(self)<>'') Begin
38802>>>>>            
38802>>>>>            ////           set bConnectionStatus to FALSE
38802>>>>>            
38802>>>>>            ////           //first get the connect state of the local system
38802>>>>>            ////           move (dvInternetGetConnectedState()) to iStat
38802>>>>>            
38802>>>>>            //////           if iStat eq 1 begin
38802>>>>>            //////              send Info_Box "You have already a connection to the Internet by modem." "dvdialer"
38802>>>>>            //////              procedure_return
38802>>>>>            //////           end
38802>>>>>            //////           if iStat eq 2 begin
38802>>>>>            //////              send Info_Box "You are connected to the Internet by a LAN." "dvdialer"
38802>>>>>            //////              procedure_return
38802>>>>>            //////           end
38802>>>>>            //////           if iStat eq 3 begin
38802>>>>>            //////              send Info_Box "You are connected to the Internet by a through a proxy server." "dvdialer"
38802>>>>>            //////              procedure_return
38802>>>>>            //////           end
38802>>>>>            
38802>>>>>            ////           if iStat eq 4 begin
38802>>>>>            ////              send Info_Box "’¦ modem œå¤˜  ˜§˜©®¦¢ž£â¤¦." "¢ž¨¦­¦¨å˜"
38802>>>>>            ////              procedure_return
38802>>>>>            ////           end
38802>>>>>            
38802>>>>>            ////           If iStat eq 0 begin
38802>>>>>            ////              // there is no Internet connection and the modem is not busy, so let's dial...
38802>>>>>            ////              // phonebook entry this would be something like this
38802>>>>>            ////              // move (dvInternetAutodial()) to iStat
38802>>>>>            ////              move (dvInternetDial((psBranchPhone(self)))) to iStat
38802>>>>>            
38802>>>>>            ////              If iStat eq 0 set bConnectionStatus to True
38802>>>>>            ////              Else Begin
38802>>>>>            ////                 Send Info_Box "† ©ç¤›œ©ž ›œ¤ £§¦¨œå ¤˜ ¦¢¦¡¢ž¨àŸœå" "¢ž¨¦­¦¨å˜"
38802>>>>>            ////                 Procedure_Return
38802>>>>>            ////              End
38802>>>>>            ////           End
38802>>>>>            
38802>>>>>            ///////////////////////
38802>>>>>            //////            Send OpenDialUp Of MyRas
38802>>>>>            //////            Get RasXComRASAvailable Of MyRas to isAvailable
38802>>>>>            //////            Get RasXComStateString  Of MyRas to sStr
38802>>>>>            //////            Pause 24 00 '*' (Trim(sStr)) '*'
38802>>>>>            //////            If (Not(isAvailable)) Begin
38802>>>>>            //////                Send Stop_Box 'Ras Connection Not Available'
38802>>>>>            //////                Procedure_Return
38802>>>>>            //////            End
38802>>>>>            ///////////////////////
38802>>>>>            ////        End
38802>>>>>            //////////////////////////////////////////////////////////////////////
38802>>>>>            
38802>>>>>            
38802>>>>>            //////        Get piErrorOccured to iErr
38802>>>>>            //////        If (iErr) Begin
38802>>>>>            //////            If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
38802>>>>>            //////            Procedure_Return
38802>>>>>            //////        End
38802>>>>>            ////        //Send OpenDialUp                 Of MyRas
38802>>>>>            ////        //Send RasXComConnect             Of MyRas
38802>>>>>            
38802>>>>>            ////        Move '' to sConnectCommand
38802>>>>>            ////        Move '' to sConnectString
38802>>>>>            
38802>>>>>            ////        send AddInfo to (oStatusForm (Self)) ("‘ç¤›œ©ž "*sFtp-"...")
38802>>>>>            
38802>>>>>            ////        // Connect to ftp site
38802>>>>>            ////        if (trim(sFtp)<>'') begin
38802>>>>>            ////            if ( sUser<>"") begin
38802>>>>>            ////               Move (dvInternetConnect(sFtp,sUser,sPassword,0)) to rVal
38802>>>>>            ////            end
38802>>>>>            ////            else move (dvInternetConnect(sFtp,"","",0)) to rVal //anonymous login
38802>>>>>            ////        end
38802>>>>>            ////        if rVal begin
38802>>>>>            ////            send ShowInternetErrorMessage rVal
38802>>>>>            ////            Get fiCloseDialup to iStat
38802>>>>>            ////            procedure_return
38802>>>>>            ////        end
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            ////        Move 'Welcome.txt'      to sRemoteFile
38802>>>>>            ////        Move 'C:\Welcome.txt'   to sLocalFile
38802>>>>>            ////        Get fiGetFile Of FtpView sRemoteFile sLocalFile 0 1 to rVal
38802>>>>>            ////        If (rVal) Begin
38802>>>>>            ////            Send ShowInternetErrorMessage rVal
38802>>>>>            ////            Get fiCloseDialup to iStat
38802>>>>>            ////            //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
38802>>>>>            ////            //Send RasXComDisConnect Of MyRas
38802>>>>>            ////            Procedure_Return
38802>>>>>            ////        End
38802>>>>>            
38802>>>>>            ////        Direct_Input    Channel 9 sLocalFile
38802>>>>>            ////        Readln          Channel 9 sStr
38802>>>>>            ////        Close_Input     Channel 9
38802>>>>>            ////        Set Value of frmMessage Item 0 to (Trim(sStr))
38802>>>>>            
38802>>>>>            ////        Move 0 to iInt
38802>>>>>            ////        Move 0 to iSelectCount
38802>>>>>            ////        Clear TmpSel
38802>>>>>            ////        Move '1' to TmpSel.Is_Selected
38802>>>>>            ////        Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
38802>>>>>            ////        While ((Found=1) And (TmpSel.Is_Selected='1'))
38802>>>>>            ////            Add 1 to iSelectCount
38802>>>>>            ////            Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
38802>>>>>            ////        Loop
38802>>>>>            
38802>>>>>            ////        If (iSelectCount>0) Begin
38802>>>>>            ////            Clear TmpSel
38802>>>>>            ////            Move '1' to TmpSel.Is_Selected
38802>>>>>            ////            Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
38802>>>>>            ////            While ((Found=1) And (TmpSel.Is_Selected='1'))
38802>>>>>            ////                Move (Trim(TmpSel.Full_Path_Name))                  to sFullFileName
38802>>>>>            ////                Move (Trim(fsReturnFileFromPath(sFullFileName)))    to sFileName
38802>>>>>            ////                Move sFullFileName  to sLocalFile
38802>>>>>            ////                Move sFileName      to sRemoteFile
38802>>>>>            //////                Insert '/' in sRemoteFile   at 1
38802>>>>>            ////                Insert sDir in sRemoteFile  at 1
38802>>>>>            ////                Get fiSendFile Of FtpView sLocalFile sRemoteFile 1 to rVal
38802>>>>>            ////                If (rVal) Begin
38802>>>>>            ////                    Send ShowInternetErrorMessage rVal
38802>>>>>            ////                    Get fiCloseDialup to iStat
38802>>>>>            ////                    //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
38802>>>>>            ////                    //Send RasXComDisConnect Of MyRas
38802>>>>>            ////                    Procedure_Return
38802>>>>>            ////                End
38802>>>>>            ////                Find Gt TmpSel By Index.2 // TmpSel:Index.2:Is_Selected+Full_Path_Name
38802>>>>>            ////            Loop
38802>>>>>            
38802>>>>>            ////            // Prepare zsok.txt filename
38802>>>>>            ////            Move sSysfileFilesSendPath                  to sLocalFile
38802>>>>>            ////            Move (Trim(sLocalFile))                     to sLocalFile
38802>>>>>            ////            Append sLocalFile 'zsok.txt'
38802>>>>>            ////            Move (Trim(sLocalFile))                     to sLocalFile
38802>>>>>            
38802>>>>>            ////            Move (Trim(sBranchSendPathConf)+'zsok.txt') to sRemoteFile
38802>>>>>            
38802>>>>>            ////            // Create zsok.txt file
38802>>>>>            ////            Direct_Output   Channel 9 sLocalFile
38802>>>>>            ////            Write           Channel 9 '1234'
38802>>>>>            ////            Writeln         Channel 9
38802>>>>>            ////            Close_Output    Channel 9
38802>>>>>            
38802>>>>>            ////            // Send zsok.txt file
38802>>>>>            ////            Get fiSendFile Of FtpView sLocalFile sRemoteFile 1 to rVal
38802>>>>>            ////            If (rVal) Begin
38802>>>>>            ////                Send ShowInternetErrorMessage rVal
38802>>>>>            ////                Get fiCloseDialup to iStat
38802>>>>>            ////                //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
38802>>>>>            ////                //Send RasXComDisConnect Of MyRas
38802>>>>>            ////                Procedure_Return
38802>>>>>            ////            End
38802>>>>>            
38802>>>>>            ////            // Prepare zrok.txt filename
38802>>>>>            ////            Move (Trim(sSysfileFilesSendPath))  to sLocalFile
38802>>>>>            ////            Append sLocalFile 'zrok.txt'
38802>>>>>            ////            Move (Trim(sBranchSendPathConf)+'zrok.txt') to sRemoteFile
38802>>>>>            
38802>>>>>            ////            // Delete previous local zrok.txt
38802>>>>>            ////            EraseFile sLocalFile
38802>>>>>            
38802>>>>>            ////            // Call timer event to bring zrok.txt file
38802>>>>>            ////            // Program flow control continues in Stop_Timer
38802>>>>>            ////            Send Start_Timer sRemoteFile sLocalFile
38802>>>>>            
38802>>>>>            ////        End
38802>>>>>            ////        Else Begin
38802>>>>>            ////            Send Info_Box 'ƒœ¤ ™¨âŸž¡œ ˜¨®œå¦ §¨¦ª ˜§¦©«¦¢ã'
38802>>>>>            ////            Get fiCloseDialup to iStat
38802>>>>>            ////            //If (psBranchPhone(self)<>'') Send CloseDialUp Of MyRas
38802>>>>>            ////            //Send RasXComDisConnect Of MyRas
38802>>>>>            ////            Procedure_Return
38802>>>>>            ////        End
38802>>>>>            ////    End
38802>>>>>            ////    Else Begin
38802>>>>>            ////        If (isOK=(-1)) Begin
38802>>>>>            ////            Send Info_Box "ƒœ¤ ™¨âŸž¡œ ¡á§¦ ˜ œ§ ¢œš£â¤ž œšš¨˜­ã"
38802>>>>>            ////        End
38802>>>>>            ////        Else If (sFtp='') Begin
38802>>>>>            ////            Send Info_Box "FTP Address field is empty"
38802>>>>>            ////            Send Activate to frmAddress
38802>>>>>            ////        End
38802>>>>>            ////        Else If (sUser='') Begin
38802>>>>>            ////            Send Info_Box "User field is empty"
38802>>>>>            ////            Send Activate to frmUserName
38802>>>>>            ////        End
38802>>>>>            ////        Else If (sPassword='') Begin
38802>>>>>            ////            Send Info_Box "Password field is empty"
38802>>>>>            ////            Send Activate to frmPassword
38802>>>>>            ////        End
38802>>>>>            ////        Else If (sDir='') Begin
38802>>>>>            ////            Send Info_Box "Directory field is empty"
38802>>>>>            ////            Send Activate to frmDirectory
38802>>>>>            ////        End
38802>>>>>            ////    End
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            
38802>>>>>            //AB-StoreEnd
38802>>>>>
38802>>>>>        End_Object    // btnSend
38803>>>>>
38803>>>>>        Object TextBoxSub1 is a TextBoxSub
38805>>>>>            Set Label to "‰à› ¡æª „¤œ¨š¦§¦åž©žª ƒ ˜› ¡˜©å˜ª €§¦©«¦¢ãª && €¤˜å¨œ©žª"
38806>>>>>            Set TextColor to 2577645
38807>>>>>            Set Location to 2 200
38808>>>>>            Set Size to 25 84
38809>>>>>            Set FontWeight to 600
38810>>>>>            Set Justification_Mode to jMode_Left
38811>>>>>            Set TypeFace to "MS Sans Serif"
38812>>>>>        End_Object    // TextBoxSub1
38813>>>>>
38813>>>>>        Object The_Table is a dbGrid
38815>>>>>
38815>>>>>            //AB-StoreTopStart
38815>>>>>                                                                    
38815>>>>>            //AB-StoreTopEnd
38815>>>>>
38815>>>>>            Set Main_File to Tmpsap.File_Number
38816>>>>>            Set Ordering to 1
38817>>>>>            Set Size to 258 188
38818>>>>>            Set Location to 2 6
38819>>>>>            Set Wrap_State to TRUE
38820>>>>>
38820>>>>>            Begin_Row
38823>>>>>                Entry_Item Tmpsap.Kleidomeno
38824>>>>>                Entry_Item Tmpsap.Date
38825>>>>>                Entry_Item Tmpsap.Apestalei
38826>>>>>            End_Row
38831>>>>>
38831>>>>>            Set Form_Width    item 0 to 56
38832>>>>>            Set Header_Label  item 0 to "K¢œ ›à£â¤ž"
38833>>>>>            Set Column_Checkbox_State  item 0 to True
38834>>>>>            
38834>>>>>            Set Form_Width    item 1 to 78
38835>>>>>            Set Header_Label  item 1 to "†£/¤å˜ „šš¨˜­é¤"
38836>>>>>            
38836>>>>>            Set Form_Width    item 2 to 48
38837>>>>>            Set Header_Label  item 2 to "€§¦©«¦¢ã"
38838>>>>>            Set Column_Checkbox_State  item 2 to True
38839>>>>>            
38839>>>>>
38839>>>>>            //AB-StoreStart
38839>>>>>                                                                    
38839>>>>>            Set Column_Option Item 0 to NoEnter True
38840>>>>>            Set Column_Option Item 1 to NoPut   True
38841>>>>>            //Set Column_Option Item 2 to NoEnter True
38841>>>>>            
38841>>>>>            //Procedure Item_Change Integer FromI Integer ToI Returns Integer
38841>>>>>            //    Integer iCol rVal isValid
38841>>>>>            //    Date    dHmnia
38841>>>>>            //    Forward Get Msg_Item_Change Fromi toi to rVal
38841>>>>>            //    If (Current_Record(tmpSap_DD(Self))) Begin
38841>>>>>            //        Get Field_Current_Value Of tmpSap_DD Field tmpSap.Date to dHmnia
38841>>>>>            //        If (Validate_Password(vwSap(Self))=1)   Set Value Of frmHmnia Item 0 to dHmnia
38841>>>>>            //        Else                                    Set Value Of frmHmnia Item 0 to ''
38841>>>>>            //    End
38841>>>>>            //    Else Set Value Of frmHmnia Item 0 to ''
38841>>>>>            //    Procedure_return rVal
38841>>>>>            //End_Procedure
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            
38841>>>>>            //AB-StoreEnd
38841>>>>>
38841>>>>>        End_Object    // The_Table
38842>>>>>
38842>>>>>        Object btnMess is a ButtonSub
38844>>>>>            Set Size to 14 311
38845>>>>>            Set Location to 246 201
38846>>>>>            Set Border_Style to Border_StaticEdge
38847>>>>>            Set Focus_Mode to No_Activate
38848>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38849>>>>>
38849>>>>>            //AB-StoreStart
38849>>>>>            Procedure OnClick
38851>>>>>            
38851>>>>>            End_Procedure // OnClick
38852>>>>>            //AB-StoreEnd
38852>>>>>
38852>>>>>        End_Object    // btnMess
38853>>>>>
38853>>>>>        Object TextBoxSub2 is a TextBoxSub
38855>>>>>            Set Label to "†£œ¨¦£ž¤å˜ „¨š˜©å˜ª „šš¨˜­é¤ ‘€"
38856>>>>>            Set TextColor to 10056008
38857>>>>>            Set Location to 10 311
38858>>>>>            Set Size to 17 75
38859>>>>>            Set FontWeight to 600
38860>>>>>            Set Justification_Mode to jMode_Left
38861>>>>>            Set TypeFace to "MS Sans Serif"
38862>>>>>        End_Object    // TextBoxSub2
38863>>>>>
38863>>>>>        Object frmAddress is a FormSub
38865>>>>>            Set Size to 13 98
38866>>>>>            Set Location to 70 201
38867>>>>>            Set Label_Col_Offset to 10
38868>>>>>            Set Label_Justification_Mode to jMode_Right
38869>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38870>>>>>
38870>>>>>            //AB-StoreStart
38870>>>>>                                                                                                                                                                                                                                            
38870>>>>>            //AB-StoreEnd
38870>>>>>
38870>>>>>        End_Object    // frmAddress
38871>>>>>
38871>>>>>        Object frmConn is a FormSub
38873>>>>>            Set Size to 13 98
38874>>>>>            Set Location to 70 297
38875>>>>>            Set Label_Col_Offset to 10
38876>>>>>            Set Label_Justification_Mode to jMode_Right
38877>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38878>>>>>
38878>>>>>            //AB-StoreStart
38878>>>>>                                                                                                                                                                                                                                            
38878>>>>>            Procedure OnChange
38880>>>>>                String sStr
38881>>>>>                Get Value Item 0 to sStr
38882>>>>>                Set psBranchPhone to (Trim(sStr))
38883>>>>>            End_Procedure
38884>>>>>            
38884>>>>>            //AB-StoreEnd
38884>>>>>
38884>>>>>        End_Object    // frmConn
38885>>>>>
38885>>>>>        Object frmUserName is a FormSub
38887>>>>>            Set Size to 13 195
38888>>>>>            Set Location to 84 201
38889>>>>>            Set Label_Col_Offset to 10
38890>>>>>            Set Label_Justification_Mode to jMode_Right
38891>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38892>>>>>        End_Object    // frmUserName
38893>>>>>
38893>>>>>        Object frmPassword is a FormSub
38895>>>>>            Set Size to 13 195
38896>>>>>            Set Location to 98 201
38897>>>>>            Set Label_Col_Offset to 10
38898>>>>>            Set Label_Justification_Mode to jMode_Right
38899>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38900>>>>>            Set Password_State Item 0 to TRUE
38901>>>>>
38901>>>>>            //AB-StoreStart
38901>>>>>                                                                                                                                                                                                                                            
38901>>>>>            Set Password_State to True
38902>>>>>            
38902>>>>>            //AB-StoreEnd
38902>>>>>
38902>>>>>        End_Object    // frmPassword
38903>>>>>
38903>>>>>        Object frmDirectory is a FormSub
38905>>>>>            Set Size to 13 195
38906>>>>>            Set Location to 113 201
38907>>>>>            Set Label_Col_Offset to 10
38908>>>>>            Set Label_Justification_Mode to jMode_Right
38909>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38910>>>>>        End_Object    // frmDirectory
38911>>>>>
38911>>>>>        Object TextBoxSub3 is a TextBoxSub
38913>>>>>            Set Label to "ƒ œçŸ¬¤©ž FTP"
38914>>>>>            Set Location to 56 201
38915>>>>>            Set Size to 10 55
38916>>>>>            Set TypeFace to "MS Sans Serif"
38917>>>>>        End_Object    // TextBoxSub3
38918>>>>>
38918>>>>>        Object TextBoxSub4 is a TextBoxSub
38920>>>>>            Set Label to "‘ç¤›œ©ž ©«¦¤ ¬§¦¢¦š ©«ã"
38921>>>>>            Set Location to 201 201
38922>>>>>            Set Size to 10 94
38923>>>>>            Set TypeFace to "MS Sans Serif"
38924>>>>>        End_Object    // TextBoxSub4
38925>>>>>
38925>>>>>        Object frmMessage is a FormSub
38927>>>>>            Set Size to 13 311
38928>>>>>            Set Location to 213 201
38929>>>>>            Set Color to clBtnFace
38930>>>>>            Set Label_Col_Offset to 2
38931>>>>>            Set Enabled_State to FALSE
38932>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
38933>>>>>            Set Item_Shadow_State Item 0 to TRUE
38934>>>>>            Set Shadow_State Item 0 to TRUE
38935>>>>>        End_Object    // frmMessage
38936>>>>>
38936>>>>>        Object oStatusForm is a editSub
38938>>>>>            Set Size to 61 311
38939>>>>>            Set Location to 130 201
38940>>>>>            Set Color to clBtnFace
38941>>>>>            Set Enabled_State to FALSE
38942>>>>>            Set Read_Only_State to TRUE
38943>>>>>
38943>>>>>            //AB-StoreStart
38943>>>>>                                                                                                                                                                                                                                            
38943>>>>>            Procedure AddInfo string sInfo
38945>>>>>                Send beginning_of_data
38946>>>>>                append sInfo (character(13)+character(10))
38947>>>>>                send insert sInfo
38948>>>>>                send paint
38949>>>>>            End_Procedure
38950>>>>>            
38950>>>>>            
38950>>>>>            //AB-StoreEnd
38950>>>>>
38950>>>>>        End_Object    // oStatusForm
38951>>>>>
38951>>>>>
38951>>>>>        //AB-StoreStart
38951>>>>>                    
38951>>>>>                    
38951>>>>>        Function fisapok Date adHmnia Returns Integer
38953>>>>>            Integer iDay iDiff
38954>>>>>            // Kaleitai kata thn fash mazematos ton eggrafon, prin ftiaxtoun ta ascii arxeia
38954>>>>>            // Den yparxei eggrafh gia thn hmeromhnia ayth sto tmpSap arxeio
38954>>>>>        
38954>>>>>        //    // 1. Elegxos an yparxei progenesterh hmeromhnia anoixth
38954>>>>>        //    Clear tmpSap
38954>>>>>        //    Find GT tmpSap By Index.4
38954>>>>>        //    If ((Found) And (tmpSap.Kleidomeno=0) And (tmpSap.Date<adHmnia)) Function_Return 1
38954>>>>>        
38954>>>>>        //    // 2. Elegxos an yparxei h sygkekrimenh hmeromhnia kai einai kleidomenh
38954>>>>>        //    Clear tmpSap
38954>>>>>        //    Move adHmnia to tmpSap.Date
38954>>>>>        //    Find Eq tmpSap By Index.1
38954>>>>>        //    If ((Found) And (tmpSap.Kleidomeno=1)) Function_Return 2
38954>>>>>        
38954>>>>>            // 3. Elegxos an yparxei epomenh hmeromhnia
38954>>>>>            Clear tmpSap
38955>>>>>            Move adHmnia to tmpSap.Date
38956>>>>>            Find Gt tmpSap By Index.1
38957>>>>>>
38957>>>>>            If (Found) Function_Return 4
38960>>>>>        
38960>>>>>            // 4. Elegxos an exei trexei h prohgoumenh hmera
38960>>>>>            Clear tmpSap
38961>>>>>            Move adHmnia to tmpSap.Date
38962>>>>>            Find LT tmpSap By Index.1
38963>>>>>>
38963>>>>>            If (Found) Begin
38965>>>>>                If ((adHmnia-tmpSap.Date) <>1) Function_Return 3
38968>>>>>            End
38968>>>>>>
38968>>>>>        
38968>>>>>            Function_Return 0
38969>>>>>        End_Function
38970>>>>>        
38970>>>>>        Procedure Deixe_Ta_Anoixta
38972>>>>>            Integer liLathi
38973>>>>>            Set piLathi to 0
38974>>>>>            send Delete_Data to (EditSub1(Keimeno(Self)))
38975>>>>>            send read to (EditSub1(Keimeno(Self))) "C:\OpenSap.log"
38976>>>>>            Send popup to (Keimeno(Self))
38977>>>>>        End_Procedure
38978>>>>>        
38978>>>>>        Procedure Activate_View Returns Integer
38980>>>>>            Integer rVal iCount
38981>>>>>            String  sMess
38981>>>>>            Move '' to sMess
38982>>>>>            Forward Get Msg_Activate_View to rVal
38984>>>>>            Set Value Of frmPassw   Item 0  to ''
38985>>>>>            Set Value Of frmHmnia   Item 0  to ''
38986>>>>>            Set Label Of btnMess            to ''
38987>>>>>            Set piLathi             to 0
38988>>>>>            Move 0 to iCount
38989>>>>>            Direct_Output Channel 7 "C:\OpenSap.log"
38991>>>>>            Writeln Channel 7 '---------------------------------------------------------'
38994>>>>>            Writeln Channel 7 'Ž‘Ž•† - €¤¦ ®«âª †£œ¨¦£ž¤åœª'
38997>>>>>            Writeln Channel 7 '---------------------------------------------------------'
39000>>>>>            Writeln Channel 7 '                              '
39003>>>>>            Clear tmpSap
39004>>>>>            Move 0 to tmpSap.Kleidomeno
39005>>>>>            Find GT tmpSap By index.4
39006>>>>>>
39006>>>>>            While ((Found) And (tmpSap.Kleidomeno=0))
39010>>>>>                Add 1 to iCount
39011>>>>>                Writeln Channel 7 tmpSap.Date
39014>>>>>                Find GT tmpSap By index.4
39015>>>>>>
39015>>>>>            Loop
39016>>>>>>
39016>>>>>            Close_Output Channel 7
39018>>>>>        
39018>>>>>            If (iCount<>0) Send Deixe_Ta_Anoixta
39021>>>>>            Else EraseFile "C:\OpenSap.log"
39023>>>>>        
39023>>>>>            Procedure_Return rVal
39024>>>>>        End_Procedure
39025>>>>>        
39025>>>>>        
39025>>>>>        Function Validate_Password Returns Integer
39027>>>>>            String sPassw
39028>>>>>            Get Value Of frmPassw Item 0 to sPassw
39029>>>>>            Set Enabled_State Of btnDelete  to (Trim(Uppercase(sPassw))='PROTEM PIS')
39030>>>>>            Set Enabled_State Of btnSend    to (Trim(Uppercase(sPassw))='PROTEM PIS')
39031>>>>>            If (Trim(Uppercase(sPassw))='PROTEM PIS') Begin
39033>>>>>                Set Enabled_State Of frmHmnia to True
39034>>>>>                Function_Return 1
39035>>>>>            End
39035>>>>>>
39035>>>>>            Else Begin
39036>>>>>                Set Value Of frmHmnia Item 0 to ''
39037>>>>>                Set Enabled_State Of frmHmnia to False
39038>>>>>                Function_Return 0
39039>>>>>            End
39039>>>>>>
39039>>>>>        End_Function
39040>>>>>        
39040>>>>>        
39040>>>>>        
39040>>>>>        //AB-StoreEnd
39040>>>>>
39040>>>>>    End_Object    // Vwsap
39041>>>>>
39041>>>>>
39041>>>>>    //AB-StoreStart
39041>>>>>                            
39041>>>>>                            
39041>>>>>                            
39041>>>>>                            
39041>>>>>                            
39041>>>>>    //AB-StoreEnd
39041>>>>>
39041>>>>>//AB/     End_Object    // prj
39041>>>Open    Tmpsap
39043>>>Open    Tmpaxio
INCLUDING FILE: TMPAXIO.FD
39045>>>Open    Tmppol
INCLUDING FILE: TMPPOL.FD
39047>>>Open    Tmpapoth
INCLUDING FILE: TMPAPOTH.FD
39049>>>Open    Tmpanal
INCLUDING FILE: TMPANAL.FD
39051>>>Open    Cmoves
39053>>>Open    Cmovesa
INCLUDING FILE: CMOVESA.FD
39055>>>Open    Cmovesa2
INCLUDING FILE: CMOVESA2.FD
39057>>>Open    Cflagkin
INCLUDING FILE: CFLAGKIN.FD
39059>>>Open    Company
39061>>>Open    Branch
39063>>>Open    Bmove
INCLUDING FILE: BMOVE.FD
39065>>>Open    Particle
39067>>>Open    Pmovesl
INCLUDING FILE: PMOVESL.FD
39069>>>Open    Pmoves
INCLUDING FILE: PMOVES.FD
39071>>>Open    Tperga
INCLUDING FILE: TPERGA.FD
39073>>>Open    Pumps
INCLUDING FILE: PUMPS.FD
39075>>>Open    Cars
INCLUDING FILE: CARS.FD
39077>>>Open    Units
INCLUDING FILE: UNITS.FD
39079>>>Open    Item
INCLUDING FILE: ITEM.FD
39081>>>Open    Psxetika
INCLUDING FILE: PSXETIKA.FD
39083>>>Open    Tmptehn
INCLUDING FILE: TMPTEHN.FD
39085>>>Open    Witemxtr
39087>>>Open    Witemxtd
INCLUDING FILE: WITEMXTD.FD
39089>>>Open    anprod
INCLUDING FILE: ANPROD.FD
39091>>>use     ranal.rv
INCLUDING FILE: RANAL.RV
39091>>>>>//AB/ Project ranal:analoseon
39091>>>>>//AB/     Object prj is a Report_Project
39091>>>>>//AB/         Set ProjectName to "ranal:analoseon"
39091>>>>>//AB/         Set ProjectFileName to "ranal.RV"
39091>>>>>
39091>>>>>// Project Object Structure
39091>>>>>//   ranal is a ReportViewSub
39091>>>>>//     ButtonSub3 is a ButtonSub
39091>>>>>//     ButtonSub4 is a ButtonSub
39091>>>>>//     rtehn_BasicReport is a BasicReport
39091>>>>>//       Tmpanal_DD is a Tmpanal_DataDictionary
39091>>>>>
39091>>>>>// Register all objects
39091>>>>>Register_Object ButtonSub3
39091>>>>>Register_Object ButtonSub4
39091>>>>>Register_Object ranal
39091>>>>>Register_Object rtehn_BasicReport
39091>>>>>Register_Object Tmpanal_DD
39091>>>>>
39091>>>>>
39091>>>>>//AB/     Report View
39091>>>>>
39091>>>>>
39091>>>>>    //AB-StoreTopStart
39091>>>>>    Use dfallrpt.pkg
39091>>>>>    use tmpanal.dd
INCLUDING FILE: TMPANAL.DD
39091>>>>>>>//DDB-FileStart
39091>>>>>>>//DDB-HeaderStart
39091>>>>>>>
39091>>>>>>>// File Name : TMPANAL.DD
39091>>>>>>>// Class Name: Tmpanal_DataDictionary
39091>>>>>>>// Revision  : 4
39091>>>>>>>// Version   : 2
39091>>>>>>>
39091>>>>>>>Use  Windows           // Basic Definitions
39091>>>>>>>Use  DataDict          // DataDictionary Class Definition
39091>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39091>>>>>>>
39091>>>>>>>Open Tmpanal
39093>>>>>>>
39093>>>>>>>//DDB-HeaderEnd
39093>>>>>>>
39093>>>>>>>Class Tmpanal_DataDictionary  is a DataDictionary_sec
39094>>>>>>>
39094>>>>>>>    // Define_Fields:
39094>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39094>>>>>>>
39094>>>>>>>    Procedure Define_Fields
39095>>>>>>>        Forward Send Define_Fields
39097>>>>>>>        //DDB-Generated-Code-Location
39097>>>>>>>        //DDB-DefineFieldStart
39097>>>>>>>
39097>>>>>>>        Set Main_File            To Tmpanal.File_Number
39098>>>>>>>
39098>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39099>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39100>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39101>>>>>>>
39101>>>>>>>        // Field-based properties.......................
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Onoma
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Typos
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Egkatastash
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Hmnia
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Trmetaf
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Item
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Qty
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Prodiagrafh
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Posoths
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Mm
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Aa
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Itemd
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Mmitemd
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Index
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Product
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Gqty
39101>>>>>>>
39101>>>>>>>        // Tmpanal.Itemsap
39101>>>>>>>
39101>>>>>>>        //DDB-DefineFieldEnd
39101>>>>>>>    End_Procedure    // Define_Fields
39102>>>>>>>
39102>>>>>>>    // Field_Defaults:
39102>>>>>>>    // This procedure is used to establish default field values.
39102>>>>>>>
39102>>>>>>>    Procedure Field_Defaults
39103>>>>>>>        Forward Send Field_Defaults
39105>>>>>>>        //DDB-Generated-Code-Location
39105>>>>>>>        //DDB-FieldDefaultStart
39105>>>>>>>        //DDB-FieldDefaultEnd
39105>>>>>>>    End_Procedure    // Field_Defaults
39106>>>>>>>
39106>>>>>>>End_Class    // Tmpanal_DataDictionary
39107>>>>>>>//DDB-FileEnd
39107>>>>>    //AB-StoreTopEnd
39107>>>>>
39107>>>>>    //AB-IgnoreStart
39107>>>>>
39107>>>>>    Use Rptvw.Sub
INCLUDING FILE: RPTVW.SUB
39107>>>>>>>Use DFRptvw.pkg
39107>>>>>>>Use dbRptvw.pkg
INCLUDING FILE: DBRPTVW.PKG
39107>>>>>>>>>
39107>>>>>>>>>Use Windows
39107>>>>>>>>>Use DfPanel
39107>>>>>>>>>Use EnClient
39107>>>>>>>>>Use DFNav_mx
39107>>>>>>>>>Use dfConfrm
39107>>>>>>>>>Use dfRptVw
39107>>>>>>>>>Use DFGSINI
39107>>>>>>>>>
39107>>>>>>>>>Class dbReportAppClient_ is a ReportView STARTMAC ECstart
39108>>>>>>>>>    Import_Class_Protocol Entry_Client
39109>>>>>>>>>    //  Defeat the activating augmentation for auto-locate
39109>>>>>>>>>    Procedure Activating Returns Integer
39110>>>>>>>>>      local integer RVal
39111>>>>>>>>>      forward get MSG_activating to rVal
39113>>>>>>>>>      Procedure_Return rVal
39114>>>>>>>>>    End_Procedure
39115>>>>>>>>>End_Class // dbReportAppClient_
39116>>>>>>>>>
39116>>>>>>>>>Class dbReportAppView_ is a dbReportAppClient_
39117>>>>>>>>>  import_Class_protocol entry_view_Client
39118>>>>>>>>>End_Class // dbReportAppView_
39119>>>>>>>>>
39119>>>>>>>>>
39119>>>>>>>>>Class dbReportView is a dbReportAppView_
39120>>>>>>>>>
39120>>>>>>>>>     Procedure Construct_Object
39121>>>>>>>>>      Forward Send Construct_Object No_Image
39123>>>>>>>>>      Send Define_DFNavigation  // GUI navigate changes
39124>>>>>>>>>      // dialog views get activated as popup objects.
39124>>>>>>>>>      set Dso_Detach_Mode to Detach_Always
39125>>>>>>>>>
39125>>>>>>>>>      Set Verify_Data_Loss_Msg TO GET_No_Confirmation
39126>>>>>>>>>      Set Verify_Delete_Msg    TO GET_No_Confirmation
39127>>>>>>>>>      Set Verify_Save_Msg      TO GET_No_Confirmation
39128>>>>>>>>>      Set Verify_Exit_Msg      TO GET_No_confirmation
39129>>>>>>>>>      //
39129>>>>>>>>>      // This reportview-client will almost always be a modalpanel, therefore minimizing
39129>>>>>>>>>      // is out of the question...
39129>>>>>>>>>      Set Minimize_Icon To False
39130>>>>>>>>>      Set Maximize_Icon To False
39131>>>>>>>>>   End_Procedure // Construct_Object
39132>>>>>>>>>
39132>>>>>>>>>   Procedure Request_Delete
39133>>>>>>>>>   End_Procedure // request_delete
39134>>>>>>>>>
39134>>>>>>>>>   Procedure Request_Save
39135>>>>>>>>>   End_Procedure // request_save
39136>>>>>>>>>
39136>>>>>>>>>   Function Exit_Application_Check Returns Integer
39137>>>>>>>>>     Function_return 0
39138>>>>>>>>>   End_Function
39139>>>>>>>>>
39139>>>>>>>>>   Import_Class_Protocol DFNavigate_Mixin
39140>>>>>>>>>
39140>>>>>>>>>  //  Returns TRUE to indicate that this is a DEO. This is used by
39140>>>>>>>>>  //  delegation to figure out if you are within a DEO and should therefore
39140>>>>>>>>>  //  send a DEO message. DEO clients set this true
39140>>>>>>>>>  Function DEO_Object Returns integer
39141>>>>>>>>>    Function_Return 1
39142>>>>>>>>>  End_Function // DEO_Object
39143>>>>>>>>>
39143>>>>>>>>>  //
39143>>>>>>>>>  //  Activate message for views that:
39143>>>>>>>>>  //  1. restores the view if it is minimized
39143>>>>>>>>>  //  2. Maintains the current scope's focus.
39143>>>>>>>>>  //
39143>>>>>>>>>  Procedure Activate_current_scope
39144>>>>>>>>>    If ( View_mode(Current_Object)=VIEWMODE_ICONIZE ) ;       Set view_mode to viewmode_normal
39147>>>>>>>>>    Set Current_Scope to Current_Object
39148>>>>>>>>>  End_Procedure // Activate_current_scope
39149>>>>>>>>>
39149>>>>>>>>>  //  Pass full object name - return the relative name
39149>>>>>>>>>  //  e.g.,  Main.View.Obj1 --> Obj1
39149>>>>>>>>>  Function Local_Object_name string nm returns string
39150>>>>>>>>>     local integer ps
39151>>>>>>>>>     Repeat
39151>>>>>>>>>>
39151>>>>>>>>>       pos "." in nm to ps
39153>>>>>>>>>>
39153>>>>>>>>>       If ps eq 0 function_return nm
39156>>>>>>>>>       increment ps
39157>>>>>>>>>       Mid Nm to Nm 255 ps
39160>>>>>>>>>>
39160>>>>>>>>>     Loop
39161>>>>>>>>>>
39161>>>>>>>>>  end_function
39162>>>>>>>>>
39162>>>>>>>>>  //  Take string "#1,#2" and return integer hi #1 + #2
39162>>>>>>>>>  Function Parse_Complex string sVal returns integer
39163>>>>>>>>>     Local integer ps
39164>>>>>>>>>     Pos "," in sVal to ps
39166>>>>>>>>>>
39166>>>>>>>>>     if ps ;        Function_Return ( integer(left(sVal,ps-1))*65536 + ;                          integer(mid(sVal,255,ps+1)) )
39169>>>>>>>>>  End_Function // Parse_Complex
39170>>>>>>>>>
39170>>>>>>>>>  // Convert a complex integer to a string "hi,Low"
39170>>>>>>>>>  //
39170>>>>>>>>>  Function Complex_to_String integer i1 returns string
39171>>>>>>>>>     function_return ( string(hi(i1)) - "," - String(low(i1)) )
39172>>>>>>>>>  End_function
39173>>>>>>>>>
39173>>>>>>>>>
39173>>>>>>>>>  // *WvA: I don't want to save locations of a reportview noted in the registry.
39173>>>>>>>>>  // These printing dialogs are centered on the panel anyway, so it doesn't make any
39173>>>>>>>>>  // sense to clutter up the registry with this kind of nonsense.
39173>>>>>>>>>  ////
39173>>>>>>>>>  ////  Save View information to dfwin.ini file. Save as:
39173>>>>>>>>>  ////  View_ObjectName=LOC:Row,Col  e.g., Cust_Ent=LOC:10,20
39173>>>>>>>>>  ////     Leaving room for growth here.
39173>>>>>>>>>  ////
39173>>>>>>>>>  Procedure Save_Environment
39174>>>>>>>>>  //   Local String nm Vn st
39174>>>>>>>>>  //   Local Integer H
39174>>>>>>>>>  //
39174>>>>>>>>>  //   Get System_Profile_String "SaveEnvironment" to St
39174>>>>>>>>>  //   Move (Uppercase(trim(st))) to st
39174>>>>>>>>>  //   If (st="YES" or st="ON" or st="TRUE") Begin
39174>>>>>>>>>  //     // Note with the 3.05 version we will have problems if the view has
39174>>>>>>>>>  //     // been maximized and then iconized. We still don't know what the normal
39174>>>>>>>>>  //     // size/loc is when maximized. We will take a chance and assume that an
39174>>>>>>>>>  //     // iconized view is always non-zoomed (since views don't support the zoom
39174>>>>>>>>>  //     // button).
39174>>>>>>>>>  //     If (View_mode(Current_Object)<>VIEWMODE_ZOOM) Begin
39174>>>>>>>>>  //
39174>>>>>>>>>  //       Get Name to Vn // full name of object
39174>>>>>>>>>  //       Get Local_Object_Name Vn to Vn   // just get the local name
39174>>>>>>>>>  //       Get GUILocation to H             // complex location
39174>>>>>>>>>  //       Get Complex_to_String h to nm    // convert complex to "hi,low"
39174>>>>>>>>>  //       Set System_Profile_String VN to ("LOC:"+Nm)
39174>>>>>>>>>  //     End
39174>>>>>>>>>  //   End
39174>>>>>>>>>  //
39174>>>>>>>>>  End_Procedure
39175>>>>>>>>>  //
39175>>>>>>>>>  //// Augment to check for view string in .INI. Currently, if found
39175>>>>>>>>>  //// set the location
39175>>>>>>>>>  ////
39175>>>>>>>>>  Procedure Load_Environment
39176>>>>>>>>>  //   Local String nm Vn Lc
39176>>>>>>>>>  //   Local Integer H ps
39176>>>>>>>>>  //   // see above for reasoning on this
39176>>>>>>>>>  //   If (View_mode(Current_Object)=VIEWMODE_NORMAL) Begin
39176>>>>>>>>>  //     Get Name to Vn
39176>>>>>>>>>  //     Get Local_Object_Name Vn to Vn
39176>>>>>>>>>  //     Get System_Profile_String Vn to Nm
39176>>>>>>>>>  //     IF Nm ne '' Begin
39176>>>>>>>>>  //        Pos "LOC:" in Nm to Ps   // look for LOC:row,col
39176>>>>>>>>>  //        If Ps Begin
39176>>>>>>>>>  //           Mid Nm to Lc 255 (Ps+4)
39176>>>>>>>>>  //           Pos " " in Lc to ps
39176>>>>>>>>>  //           if Ps left lc to lc (ps-1)
39176>>>>>>>>>  //           Get Parse_Complex lc to H
39176>>>>>>>>>  //           Set GUILocation to (Hi(H)) (Low(H))
39176>>>>>>>>>  //           Send Adjust_Logicals
39176>>>>>>>>>  //        End
39176>>>>>>>>>  //     End
39176>>>>>>>>>  //   End
39176>>>>>>>>>  End_Procedure
39177>>>>>>>>>
39177>>>>>>>>>  Function View_Changed returns Integer
39178>>>>>>>>>     Local Integer Changed
39179>>>>>>>>>     Broadcast Get Data_Set_Should_Save to Changed // Ask for changes in Data-sets
39181>>>>>>>>>     Function_Return Changed
39182>>>>>>>>>  End_Function
39183>>>>>>>>>
39183>>>>>>>>>  Procedure Notify_Exit_Application
39184>>>>>>>>>    Send Save_Environment
39185>>>>>>>>>  End_procedure
39186>>>>>>>>>
39186>>>>>>>>>  Procedure End_Construct_Object
39187>>>>>>>>>     Send Load_Environment
39188>>>>>>>>>     //Send Define_SysMenu
39188>>>>>>>>>     Forward Send End_Construct_Object
39190>>>>>>>>>  End_Procedure // End_Construct_Object
39191>>>>>>>>>
39191>>>>>>>>>  Procedure Close_Client
39192>>>>>>>>>     Send Exit_Function
39193>>>>>>>>>  End_Procedure
39194>>>>>>>>>
39194>>>>>>>>>  Procedure Entering_Scope returns Integer
39195>>>>>>>>>     Local Integer rVal
39196>>>>>>>>>     Forward Get MSG_Entering_Scope to rVal
39198>>>>>>>>>     If not rVal send Show_View_Name (Label(Current_Object))
39201>>>>>>>>>  End_Procedure
39202>>>>>>>>>
39202>>>>>>>>>  Procedure Exiting_Scope integer whereto returns Integer
39203>>>>>>>>>     Local Integer rVal
39204>>>>>>>>>     Forward Get MSG_Exiting_Scope whereto to rVal
39206>>>>>>>>>     If not rVal Send Show_View_Name ''
39209>>>>>>>>>  End_Procedure
39210>>>>>>>>>
39210>>>>>>>>>  Procedure Show_view_Name string sHelp
39211>>>>>>>>>     Local Integer rVal Id
39212>>>>>>>>>     Get Statusbar_id to id
39213>>>>>>>>>     If Id Send Show_View_Name to Id sHelp
39216>>>>>>>>>  End_Procedure
39217>>>>>>>>>
39217>>>>>>>>>  Function Should_Save_Recursive returns integer
39218>>>>>>>>>    Function_return (View_Changed(Current_Object))
39219>>>>>>>>>  End_Function
39220>>>>>>>>>
39220>>>>>>>>>End_Class // dbReportView
39221>>>>>>>
39221>>>>>>>Class ReportViewSub is a ReportView
39222>>>>>>>
39222>>>>>>>    Procedure Construct_Object
39223>>>>>>>        Forward Send Construct_Object
39225>>>>>>>        Property Integer Server 0
39226>>>>>>>    End_Procedure // Construct_Object
39227>>>>>>>
39227>>>>>>>    Procedure Page Integer PageMode
39228>>>>>>>        Integer hWnd
39229>>>>>>>        Forward Send Page PageMode
39231>>>>>>>        Get Window_Handle to hWnd
39232>>>>>>>        If (hWnd) Begin
39234>>>>>>>            Send GreekSysMenu
39235>>>>>>>        End
39235>>>>>>>>
39235>>>>>>>    End_Procedure
39236>>>>>>>
39236>>>>>>>    Procedure Close_Panel
39237>>>>>>>        Local Integer liScope
39238>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
39239>>>>>>>        Move (Scope_Focus(liScope)) To liScope
39240>>>>>>>        Forward Send Close_Panel
39242>>>>>>>        Send Activate To liScope
39243>>>>>>>    End_Procedure // Close_Panel
39244>>>>>>>
39244>>>>>>>End_Class
39245>>>>>>>
39245>>>>>>>Class dbReportViewSub is a dbReportView
39246>>>>>>>
39246>>>>>>>    Procedure Construct_Object
39247>>>>>>>        Forward Send Construct_Object
39249>>>>>>>        Property Integer Server 0
39250>>>>>>>    End_Procedure // Construct_Object
39251>>>>>>>
39251>>>>>>>    Procedure Page Integer PageMode
39252>>>>>>>        Integer hWnd
39253>>>>>>>        Forward Send Page PageMode
39255>>>>>>>        Get Window_Handle to hWnd
39256>>>>>>>        If (hWnd) Begin
39258>>>>>>>            Send GreekSysMenu
39259>>>>>>>        End
39259>>>>>>>>
39259>>>>>>>    End_Procedure
39260>>>>>>>
39260>>>>>>>    Procedure Close_Panel
39261>>>>>>>        Local Integer liScope
39262>>>>>>>        Move (Prior_Scope(Desktop)) To liScope
39263>>>>>>>        Move (Scope_Focus(liScope)) To liScope
39264>>>>>>>        Forward Send Close_Panel
39266>>>>>>>        Send Activate To liScope
39267>>>>>>>    End_Procedure // Close_Panel
39268>>>>>>>End_Class
39269>>>>>>>
39269>>>>>    Use Button.Sub
39269>>>>>
39269>>>>>    //AB-IgnoreEnd
39269>>>>>
39269>>>>>    ACTIVATE_VIEW Activate_ranal FOR ranal
39272>>>>>
39272>>>>>    Object ranal is a ReportViewSub
39274>>>>>
39274>>>>>        //AB-StoreTopStart
39274>>>>>        
39274>>>>>        Property Integer Sort_IndexRlog     Public 1
39276>>>>>        property number  pnqty              public 0
39278>>>>>        property integer pino               public 0
39280>>>>>        property string  pscode             public ''
39282>>>>>        property string  psitem             public ''
39284>>>>>        property date    pddate             public ''
39286>>>>>        property string  psbranch           public ''
39288>>>>>        property string psrecr              public ''
39290>>>>>        //AB-StoreTopEnd
39290>>>>>
39290>>>>>        Set Label to "€¤˜¢é©œ ª"
39291>>>>>        Set Size to 39 186
39292>>>>>        Set Location to 1 23
39293>>>>>        Set Color to 16744448
39294>>>>>
39294>>>>>        //AB-DDOStart
39294>>>>>
39294>>>>>
39294>>>>>        //AB-DDOEnd
39294>>>>>
39294>>>>>        Object ButtonSub3 is a ButtonSub
39296>>>>>
39296>>>>>            //AB-StoreTopStart
39296>>>>>                                                                                                                                                                                                                                                                                                                            
39296>>>>>            //AB-StoreTopEnd
39296>>>>>
39296>>>>>            Set Bitmap to "RUNPROG.BMP"
39297>>>>>            Set Size to 18 27
39298>>>>>            Set Location to 3 119
39299>>>>>            Set Border_Style to Border_StaticEdge
39300>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39301>>>>>
39301>>>>>            //AB-StoreStart
39301>>>>>                                                                                                                                                                                                                                                                                                                            
39301>>>>>            Procedure OnClick
39303>>>>>            
39303>>>>>            End_Procedure
39304>>>>>            
39304>>>>>            //AB-StoreEnd
39304>>>>>
39304>>>>>        End_Object    // ButtonSub3
39305>>>>>
39305>>>>>        Object ButtonSub4 is a ButtonSub
39307>>>>>
39307>>>>>            //AB-StoreTopStart
39307>>>>>                                                                                                                                                                                                                                                                                                                            
39307>>>>>            //AB-StoreTopEnd
39307>>>>>
39307>>>>>            Set Bitmap to "CANCEL.BMP"
39308>>>>>            Set Size to 18 27
39309>>>>>            Set Location to 3 153
39310>>>>>            Set Border_Style to Border_StaticEdge
39311>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39312>>>>>
39312>>>>>            //AB-StoreStart
39312>>>>>            Procedure OnClick
39314>>>>>                Send Request_Cancel
39315>>>>>            End_Procedure
39316>>>>>            
39316>>>>>            
39316>>>>>            //AB-StoreEnd
39316>>>>>
39316>>>>>        End_Object    // ButtonSub4
39317>>>>>
39317>>>>>
39317>>>>>        //AB-StoreStart
39317>>>>>        set output_device_name to none
39318>>>>>        Procedure StartReport
39320>>>>>            Local Integer iOutputDevice
39321>>>>>            Local String  FileName
39321>>>>>            SEND RUN_REPORT
39322>>>>>        End_Procedure   // StartReport
39323>>>>>        
39323>>>>>        
39323>>>>>        Object rtehn_BasicReport is a BasicReport
39325>>>>>        
39325>>>>>            Set Report_Title to "„¤ž£â¨à©ž €¤˜¢é©œà¤ ‘ç¤¦¢˜                   "
39326>>>>>            Set Report_Caption to "„¤ž£â¨à©ž €¤˜¢é©œà¤ ‘ç¤¦¢˜ "
39327>>>>>        
39327>>>>>            Set Status_Panel_State  to true
39328>>>>>            Set Display_Error_State to True
39329>>>>>        
39329>>>>>        
39329>>>>>        
39329>>>>>        
39329>>>>>            Object Tmpanal_DD is a Tmpanal_DataDictionary
39331>>>>>                 begin_constraints
39333>>>>>                    constrain tmpanal.typos eq '09'
39335>>>>>                 end_constraints
39338>>>>>            End_Object    // tmpanal
39339>>>>>        
39339>>>>>            Set Server To (tmpanal_dd(Self))
39340>>>>>        
39340>>>>>            //Breaks and Index for the report
39340>>>>>            Report_Index By Index.4
39342>>>>>            Report_breaks tmpanal.hmnia tmpanal.egkatastash tmpanal.itemd
39357>>>>>        
39357>>>>>            Function Starting_Main_Report Returns Integer
39359>>>>>              Integer iIndexRlog
39360>>>>>              Local Integer iRetVal
39360>>>>>              Forward Get Starting_Main_Report to iRetval
39362>>>>>              send rebuild_constraints to tmpanal_dd
39363>>>>>              Send Find to (tmpanal_dd(self)) First_Record 4
39364>>>>>            End_Function
39365>>>>>        
39365>>>>>            Procedure_Section subheader1
39367>>>>>                set pddate to tmpanal.hmnia
39368>>>>>                set pnqty to 0
39369>>>>>        
39369>>>>>            End_Procedure
39370>>>>>        
39370>>>>>            Procedure_Section subheader2
39372>>>>>                set psbranch to tmpanal.egkatastash
39373>>>>>                set pnqty to 0
39374>>>>>            End_Procedure
39375>>>>>        
39375>>>>>            Procedure_Section subheader3
39377>>>>>                set psitem to tmpanal.itemd
39378>>>>>            End_Procedure
39379>>>>>        
39379>>>>>            Procedure_Section  Body
39381>>>>>                integer ino
39382>>>>>                number nqty
39382>>>>>                set pino  to (pino(self)+1)
39383>>>>>                set pnqty to (pnqty(self)+Tmpanal.posoths)
39384>>>>>                send update_status ('Ešš¨˜­ã ' + string(Tmpanal.itemd))
39385>>>>>            End_Procedure
39386>>>>>            Procedure_Section subtotal3
39388>>>>>                string sbranch sitem
39389>>>>>                number nqty
39389>>>>>                date ddate
39389>>>>>                get psbranch to sbranch
39390>>>>>                get psitem to sitem
39391>>>>>                get pnqty to nqty
39392>>>>>                get pddate to ddate
39393>>>>>                clear tmpanal
39394>>>>>                move 'PP2'                              to Tmpanal.onoma
39395>>>>>                move '91'                               to Tmpanal.typos
39396>>>>>                move sbranch                            to Tmpanal.egkatastash
39397>>>>>                move nqty                               to tmpanal.posoths
39398>>>>>                move sitem                              to Tmpanal.itemd
39399>>>>>                move ddate                              to Tmpanal.hmnia
39400>>>>>                set pnqty to 0
39401>>>>>                saverecord tmpanal
39402>>>>>                set pnqty to 0
39403>>>>>            End_Procedure
39404>>>>>        
39404>>>>>            Procedure_Section subtotal2
39406>>>>>            End_Procedure
39407>>>>>        
39407>>>>>            Procedure_Section subtotal1
39409>>>>>        
39409>>>>>            End_Procedure
39410>>>>>        
39410>>>>>           Procedure Ending_Report
39412>>>>>                integer ino
39413>>>>>        
39413>>>>>                date ddate
39413>>>>>                get pddate to ddate
39414>>>>>        
39414>>>>>                get pino to ino
39415>>>>>                clear tmpanal
39416>>>>>                move 'PP2'                              to Tmpanal.onoma
39417>>>>>                move '92'                               to Tmpanal.typos
39418>>>>>                move 'ZZZZ'                             to tmpanal.egkatastash
39419>>>>>                move ddate                              to Tmpanal.hmnia
39420>>>>>                move ino                                to tmpanal.qty
39421>>>>>                saverecord tmpanal
39422>>>>>                SET pINO TO 0
39423>>>>>           End_Procedure
39424>>>>>        
39424>>>>>        End_Object
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        
39425>>>>>        //AB-StoreEnd
39425>>>>>
39425>>>>>    End_Object    // ranal
39426>>>>>
39426>>>>>
39426>>>>>    //AB-StoreStart
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>                
39426>>>>>    //AB-StoreEnd
39426>>>>>
39426>>>>>//AB/     End_Object    // prj
39426>>>use     ranal90.rv
INCLUDING FILE: RANAL90.RV
39426>>>>>//AB/ Project ranal90:analoseon
39426>>>>>//AB/ Object prj is a Report_Project
39426>>>>>//AB/     Set ProjectName to "ranal90:analoseon"
39426>>>>>//AB/     Set ProjectFileName to "ranal90.RV"
39426>>>>>
39426>>>>>// Project Object Structure
39426>>>>>//   ranal90 is a ReportViewSub
39426>>>>>//     ButtonSub3 is a ButtonSub
39426>>>>>//     ButtonSub4 is a ButtonSub
39426>>>>>//     rtehn_BasicReport is a BasicReport
39426>>>>>//       Tmpanal_DD is a Tmpanal_DataDictionary
39426>>>>>
39426>>>>>// Register all objects
39426>>>>>Register_Object ButtonSub3
39426>>>>>Register_Object ButtonSub4
39426>>>>>Register_Object ranal90
39426>>>>>Register_Object rtehn_BasicReport
39426>>>>>Register_Object Tmpanal_DD
39426>>>>>
39426>>>>>
39426>>>>>//AB/ Report View
39426>>>>>
39426>>>>>
39426>>>>>//AB-StoreTopStart
39426>>>>>Use dfallrpt.pkg
39426>>>>>use tmpanal.dd
39426>>>>>//AB-StoreTopEnd
39426>>>>>
39426>>>>>//AB-IgnoreStart
39426>>>>>
39426>>>>>Use Rptvw.Sub
39426>>>>>Use Button.Sub
39426>>>>>
39426>>>>>//AB-IgnoreEnd
39426>>>>>
39426>>>>>ACTIVATE_VIEW Activate_ranal90 FOR ranal90
39429>>>>>
39429>>>>>Object ranal90 is a ReportViewSub
39431>>>>>
39431>>>>>    //AB-StoreTopStart
39431>>>>>    
39431>>>>>    Property Integer Sort_IndexRlog     Public 1
39433>>>>>    property number  pnqty              public 0
39435>>>>>    property integer pino               public 0
39437>>>>>    property string  pscode             public ''
39439>>>>>    property string  psitem             public ''
39441>>>>>    property date    pddate             public ''
39443>>>>>    property string  psbranch           public ''
39445>>>>>    property string psrecr              public ''
39447>>>>>    //AB-StoreTopEnd
39447>>>>>
39447>>>>>    Set Label to "€¤˜¢é©œ ª"
39448>>>>>    Set Size to 39 186
39449>>>>>    Set Location to 1 23
39450>>>>>    Set Color to 16744448
39451>>>>>
39451>>>>>    //AB-DDOStart
39451>>>>>
39451>>>>>
39451>>>>>    //AB-DDOEnd
39451>>>>>
39451>>>>>    Object ButtonSub3 is a ButtonSub
39453>>>>>        Set Bitmap to "RUNPROG.BMP"
39454>>>>>        Set Size to 18 27
39455>>>>>        Set Location to 3 119
39456>>>>>        Set Border_Style to Border_StaticEdge
39457>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39458>>>>>
39458>>>>>        //AB-StoreStart
39458>>>>>        Procedure OnClick
39460>>>>>        End_Procedure
39461>>>>>        
39461>>>>>        
39461>>>>>        //AB-StoreEnd
39461>>>>>
39461>>>>>    End_Object    // ButtonSub3
39462>>>>>
39462>>>>>    Object ButtonSub4 is a ButtonSub
39464>>>>>        Set Bitmap to "CANCEL.BMP"
39465>>>>>        Set Size to 18 27
39466>>>>>        Set Location to 3 153
39467>>>>>        Set Border_Style to Border_StaticEdge
39468>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39469>>>>>
39469>>>>>        //AB-StoreStart
39469>>>>>        Procedure OnClick
39471>>>>>            Send Request_Cancel
39472>>>>>        End_Procedure
39473>>>>>        
39473>>>>>        //AB-StoreEnd
39473>>>>>
39473>>>>>    End_Object    // ButtonSub4
39474>>>>>
39474>>>>>
39474>>>>>    //AB-StoreStart
39474>>>>>    set output_device_name to none
39475>>>>>    Procedure StartReport
39477>>>>>        Local Integer iOutputDevice
39478>>>>>        Local String  FileName
39478>>>>>        SEND RUN_REPORT
39479>>>>>    End_Procedure   // StartReport
39480>>>>>    
39480>>>>>    
39480>>>>>    Object rtehn_BasicReport is a BasicReport
39482>>>>>    
39482>>>>>        Set Report_Title to "„¤ž£â¨à©ž Record 90                   "
39483>>>>>        Set Report_Caption to "„¤ž£â¨à©ž Record 90  "
39484>>>>>    
39484>>>>>        Set Status_Panel_State  to true
39485>>>>>        Set Display_Error_State to True
39486>>>>>    
39486>>>>>        Object Tmpanal_DD is a Tmpanal_DataDictionary
39488>>>>>             begin_constraints
39490>>>>>                constrain tmpanal.typos eq '09'
39492>>>>>             end_constraints
39495>>>>>        End_Object    // tmpanal
39496>>>>>    
39496>>>>>        Set Server To (tmpanal_dd(Self))
39497>>>>>    
39497>>>>>        //Breaks and Index for the report
39497>>>>>        Report_Index By Index.5
39499>>>>>        Report_breaks tmpanal.hmnia tmpanal.typos tmpanal.egkatastash tmpanal.item
39515>>>>>    
39515>>>>>        Function Starting_Main_Report Returns Integer
39517>>>>>          Integer iIndexRlog
39518>>>>>          Local Integer iRetVal
39518>>>>>          Forward Get Starting_Main_Report to iRetval
39520>>>>>          send rebuild_constraints to tmpanal_dd
39521>>>>>          Send Find to (tmpanal_dd(self)) First_Record 5
39522>>>>>        End_Function
39523>>>>>    
39523>>>>>        Procedure_Section subheader1
39525>>>>>            set pddate to tmpanal.hmnia
39526>>>>>            set pnqty to 0
39527>>>>>    
39527>>>>>        End_Procedure
39528>>>>>    
39528>>>>>        Procedure_Section subheader2
39530>>>>>        End_procedure
39531>>>>>    
39531>>>>>        Procedure_Section subheader3
39533>>>>>            set psbranch to tmpanal.egkatastash
39534>>>>>            set pnqty to 0
39535>>>>>        End_Procedure
39536>>>>>    
39536>>>>>        Procedure_Section subheader4
39538>>>>>            set psitem to tmpanal.item
39539>>>>>        End_Procedure
39540>>>>>    
39540>>>>>        Procedure_Section  Body
39542>>>>>            integer ino
39543>>>>>            number nqty
39543>>>>>            if (tmpanal.aa=1);                set pnqty to (pnqty(self)+Tmpanal.qty)
39546>>>>>            send update_status ('Ešš¨˜­ã ' + string(Tmpanal.item))
39547>>>>>        End_Procedure
39548>>>>>    
39548>>>>>        Procedure_Section subtotal4
39550>>>>>            string sbranch sitem
39551>>>>>            number nqty
39551>>>>>            date ddate
39551>>>>>            get psbranch to sbranch
39552>>>>>            get psitem to sitem
39553>>>>>            get pnqty to nqty
39554>>>>>            get pddate to ddate
39555>>>>>            clear tmpanal
39556>>>>>            move 'PP2'                              to Tmpanal.onoma
39557>>>>>            move '90'                               to Tmpanal.typos
39558>>>>>            move sbranch                            to Tmpanal.egkatastash
39559>>>>>            move nqty                               to tmpanal.qty
39560>>>>>            move sitem                              to Tmpanal.item
39561>>>>>            move ddate                              to Tmpanal.hmnia
39562>>>>>            set pnqty to 0
39563>>>>>            saverecord tmpanal
39564>>>>>            set pnqty to 0
39565>>>>>        End_Procedure
39566>>>>>    
39566>>>>>        Procedure_Section subtotal3
39568>>>>>        End_Procedure
39569>>>>>    
39569>>>>>        Procedure_Section subtotal2
39571>>>>>        End_Procedure
39572>>>>>    
39572>>>>>        Procedure_Section subtotal1
39574>>>>>    
39574>>>>>        End_Procedure
39575>>>>>    
39575>>>>>       Procedure Ending_Report
39577>>>>>    
39577>>>>>       End_Procedure
39578>>>>>    
39578>>>>>    End_Object
39579>>>>>    
39579>>>>>    //AB-StoreEnd
39579>>>>>
39579>>>>>End_Object    // ranal90
39580>>>>>
39580>>>>>
39580>>>>>//AB-StoreStart
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>                    
39580>>>>>//AB-StoreEnd
39580>>>>>
39580>>>>>//AB/ End_Object    // prj
39580>>>use     rapoth.rv
INCLUDING FILE: RAPOTH.RV
39580>>>>>//AB/ Project Rapoth:synola mm1
39580>>>>>//AB/     Object prj is a Report_Project
39580>>>>>//AB/         Set ProjectName to "Rapoth:synola mm1"
39580>>>>>//AB/         Set ProjectFileName to "Rapoth.RV"
39580>>>>>
39580>>>>>// Project Object Structure
39580>>>>>//   Rapoth is a ReportViewSub
39580>>>>>//     ButtonSub3 is a ButtonSub
39580>>>>>//     ButtonSub4 is a ButtonSub
39580>>>>>//     rapoth_BasicReport is a BasicReport
39580>>>>>//       Tmpapoth_DD is a Tmpapoth_DataDictionary
39580>>>>>
39580>>>>>// Register all objects
39580>>>>>Register_Object ButtonSub3
39580>>>>>Register_Object ButtonSub4
39580>>>>>Register_Object Rapoth
39580>>>>>Register_Object rapoth_BasicReport
39580>>>>>Register_Object Tmpapoth_DD
39580>>>>>
39580>>>>>
39580>>>>>//AB/     Report View
39580>>>>>
39580>>>>>
39580>>>>>    //AB-StoreTopStart
39580>>>>>    Use dfallrpt.pkg
39580>>>>>    use tmpapoth.dd
INCLUDING FILE: TMPAPOTH.DD
39580>>>>>>>//DDB-FileStart
39580>>>>>>>//DDB-HeaderStart
39580>>>>>>>
39580>>>>>>>// File Name : TMPAPOTH.DD
39580>>>>>>>// Class Name: Tmpapoth_DataDictionary
39580>>>>>>>// Revision  : 3
39580>>>>>>>// Version   : 2
39580>>>>>>>
39580>>>>>>>Use  Windows           // Basic Definitions
39580>>>>>>>Use  DataDict          // DataDictionary Class Definition
39580>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39580>>>>>>>
39580>>>>>>>Open Tmpapoth
39582>>>>>>>
39582>>>>>>>//DDB-HeaderEnd
39582>>>>>>>
39582>>>>>>>Class Tmpapoth_DataDictionary  is a DataDictionary_sec
39583>>>>>>>
39583>>>>>>>    // Define_Fields:
39583>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39583>>>>>>>
39583>>>>>>>    Procedure Define_Fields
39584>>>>>>>        Forward Send Define_Fields
39586>>>>>>>        //DDB-Generated-Code-Location
39586>>>>>>>        //DDB-DefineFieldStart
39586>>>>>>>
39586>>>>>>>        Set Main_File            To Tmpapoth.File_Number
39587>>>>>>>
39587>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39588>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39589>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39590>>>>>>>
39590>>>>>>>        // Field-based properties.......................
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Onoma
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Typos
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Egkatastash
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Arithmos
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Hmnia
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Type
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Code
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Item
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Qty
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Monada
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Paralabh
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Name
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Item_Descr
39590>>>>>>>
39590>>>>>>>        // Tmpapoth.Pinakida
39590>>>>>>>
39590>>>>>>>        //DDB-DefineFieldEnd
39590>>>>>>>    End_Procedure    // Define_Fields
39591>>>>>>>
39591>>>>>>>    // Field_Defaults:
39591>>>>>>>    // This procedure is used to establish default field values.
39591>>>>>>>
39591>>>>>>>    Procedure Field_Defaults
39592>>>>>>>        Forward Send Field_Defaults
39594>>>>>>>        //DDB-Generated-Code-Location
39594>>>>>>>        //DDB-FieldDefaultStart
39594>>>>>>>        //DDB-FieldDefaultEnd
39594>>>>>>>    End_Procedure    // Field_Defaults
39595>>>>>>>
39595>>>>>>>End_Class    // Tmpapoth_DataDictionary
39596>>>>>>>//DDB-FileEnd
39596>>>>>    //AB-StoreTopEnd
39596>>>>>
39596>>>>>    //AB-IgnoreStart
39596>>>>>
39596>>>>>    Use Rptvw.Sub
39596>>>>>    Use Button.Sub
39596>>>>>
39596>>>>>    //AB-IgnoreEnd
39596>>>>>
39596>>>>>    ACTIVATE_VIEW Activate_Rapoth FOR Rapoth
39599>>>>>
39599>>>>>    Object Rapoth is a ReportViewSub
39601>>>>>
39601>>>>>        //AB-StoreTopStart
39601>>>>>        
39601>>>>>        Property Integer Sort_IndexRlog     Public 1
39603>>>>>        property number  pnqty              public 0
39605>>>>>        property integer pino               public 0
39607>>>>>        property string  pscode             public ''
39609>>>>>        property string  psitem             public ''
39611>>>>>        property date    pddate             public ''
39613>>>>>        property string  psbranch           public ''
39615>>>>>        property string  pstype             public ''
39617>>>>>        property string psrecr              public ''
39619>>>>>        //AB-StoreTopEnd
39619>>>>>
39619>>>>>        Set Label to "‘ç¤¦¢˜ MM1"
39620>>>>>        Set Size to 39 186
39621>>>>>        Set Location to 1 23
39622>>>>>        Set Color to 16744448
39623>>>>>
39623>>>>>        //AB-DDOStart
39623>>>>>
39623>>>>>
39623>>>>>        //AB-DDOEnd
39623>>>>>
39623>>>>>        Object ButtonSub3 is a ButtonSub
39625>>>>>
39625>>>>>            //AB-StoreTopStart
39625>>>>>                                                                                                                                                                                                                                                                                                                                
39625>>>>>            //AB-StoreTopEnd
39625>>>>>
39625>>>>>            Set Bitmap to "RUNPROG.BMP"
39626>>>>>            Set Size to 18 27
39627>>>>>            Set Location to 3 119
39628>>>>>            Set Border_Style to Border_StaticEdge
39629>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39630>>>>>
39630>>>>>            //AB-StoreStart
39630>>>>>                                                                                                                                                                                                                                                                                                                                
39630>>>>>            Procedure OnClick
39632>>>>>            
39632>>>>>            End_Procedure
39633>>>>>            
39633>>>>>            //AB-StoreEnd
39633>>>>>
39633>>>>>        End_Object    // ButtonSub3
39634>>>>>
39634>>>>>        Object ButtonSub4 is a ButtonSub
39636>>>>>
39636>>>>>            //AB-StoreTopStart
39636>>>>>                                                                                                                                                                                                                                                                                                                                
39636>>>>>            //AB-StoreTopEnd
39636>>>>>
39636>>>>>            Set Bitmap to "CANCEL.BMP"
39637>>>>>            Set Size to 18 27
39638>>>>>            Set Location to 3 153
39639>>>>>            Set Border_Style to Border_StaticEdge
39640>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
39641>>>>>
39641>>>>>            //AB-StoreStart
39641>>>>>            Procedure OnClick
39643>>>>>                Send Request_Cancel
39644>>>>>            End_Procedure
39645>>>>>            
39645>>>>>            
39645>>>>>            //AB-StoreEnd
39645>>>>>
39645>>>>>        End_Object    // ButtonSub4
39646>>>>>
39646>>>>>
39646>>>>>        //AB-StoreStart
39646>>>>>        set output_device_name to none
39647>>>>>        Procedure StartReport
39649>>>>>            Local Integer iOutputDevice
39650>>>>>            Local String  FileName
39650>>>>>            SEND RUN_REPORT
39651>>>>>        End_Procedure   // StartReport
39652>>>>>        
39652>>>>>        
39652>>>>>        Object rapoth_BasicReport is a BasicReport
39654>>>>>        
39654>>>>>            Set Report_Title to "„¤ž£â¨à©ž MM1 ‘ç¤¦¢˜                   "
39655>>>>>            Set Report_Caption to "„¤ž£â¨à©ž MM1 ‘ç¤¦¢˜ "
39656>>>>>        
39656>>>>>            Set Status_Panel_State  to true
39657>>>>>            Set Display_Error_State to True
39658>>>>>        
39658>>>>>        
39658>>>>>        
39658>>>>>        
39658>>>>>            Object Tmpapoth_DD is a Tmpapoth_DataDictionary
39660>>>>>                 begin_constraints
39662>>>>>                    constrain tmpapoth.typos eq '01'
39664>>>>>                 end_constraints
39667>>>>>            End_Object    // tmpapoth
39668>>>>>        
39668>>>>>            Set Server To (tmpapoth_dd(Self))
39669>>>>>        
39669>>>>>            //Breaks and Index for the report
39669>>>>>            Report_Index By Index.3
39671>>>>>            Report_breaks tmpapoth.egkatastash tmpapoth.hmnia tmpapoth.type tmpapoth.item
39687>>>>>        
39687>>>>>            Function Starting_Main_Report Returns Integer
39689>>>>>              Integer iIndexRlog
39690>>>>>              Local Integer iRetVal
39690>>>>>              Forward Get Starting_Main_Report to iRetval
39692>>>>>              send rebuild_constraints to tmpapoth_dd
39693>>>>>              Send Find to (tmpapoth_dd(self)) First_Record 3
39694>>>>>            End_Function
39695>>>>>        
39695>>>>>        
39695>>>>>        
39695>>>>>            Procedure_Section subheader1
39697>>>>>                set psbranch to tmpapoth.egkatastash
39698>>>>>                set pnqty to 0
39699>>>>>            End_Procedure
39700>>>>>        
39700>>>>>            Procedure_Section subheader2
39702>>>>>                set pddate to tmpapoth.hmnia
39703>>>>>                set pnqty to 0
39704>>>>>            End_Procedure
39705>>>>>        
39705>>>>>            Procedure_Section subheader3
39707>>>>>                set pstype to tmpapoth.type
39708>>>>>                set pnqty to 0
39709>>>>>            End_Procedure
39710>>>>>        
39710>>>>>        
39710>>>>>        
39710>>>>>            Procedure_Section subheader4
39712>>>>>                set psitem to tmpapoth.item
39713>>>>>                set pnqty to 0
39714>>>>>            End_Procedure
39715>>>>>        
39715>>>>>            Procedure_Section  Body
39717>>>>>                number nqty
39718>>>>>                set pnqty to (pnqty(self)+Tmpapoth.qty)
39719>>>>>                send update_status ('Ešš¨˜­ã ' + string(Tmpapoth.item))
39720>>>>>            End_Procedure
39721>>>>>            Procedure_Section subtotal4
39723>>>>>                string sbranch sitem stype smm
39724>>>>>                number nqty
39724>>>>>                date ddate
39724>>>>>                move tmpapoth.monada to smm
39725>>>>>                get psbranch to sbranch
39726>>>>>                get psitem to sitem
39727>>>>>                get pnqty to nqty
39728>>>>>                get pddate to ddate
39729>>>>>                get pstype to stype
39730>>>>>                clear tmpapoth
39731>>>>>                move 'MM1'                              to tmpapoth.onoma
39732>>>>>                move '91'                               to Tmpapoth.typos
39733>>>>>                move '9999999999'                       to Tmpapoth.arithmos
39734>>>>>                move stype                              to tmpapoth.type
39735>>>>>                move nqty                               to Tmpapoth.qty
39736>>>>>                move ''                                 to Tmpapoth.code
39737>>>>>                move ddate                              to tmpapoth.hmnia
39738>>>>>                move sitem                              to Tmpapoth.item
39739>>>>>                move sbranch                            to Tmpapoth.egkatastash
39740>>>>>                move smm                                to Tmpapoth.monada
39741>>>>>                move ''                                 to Tmpapoth.paralabh
39742>>>>>                saverecord tmpapoth
39743>>>>>                set pnqty to 0
39744>>>>>            End_Procedure
39745>>>>>        
39745>>>>>            Procedure_Section subtotal3
39747>>>>>        //        string sbranch sitem stype smm
39747>>>>>        //        date ddate
39747>>>>>        //        number nqty
39747>>>>>        //        move tmpapoth.monada to smm
39747>>>>>        //        get psbranch to sbranch
39747>>>>>        //        get psitem to sitem
39747>>>>>        //        get pnqty to nqty
39747>>>>>        //        get pddate to ddate
39747>>>>>        //        get pstype to stype
39747>>>>>        //        clear tmpapoth
39747>>>>>        //        move '91'                               to Tmpapoth.typos
39747>>>>>        //        move '9999999999'                       to Tmpapoth.arithmos
39747>>>>>        //        move stype                              to tmpapoth.type
39747>>>>>        //        move nqty                               to Tmpapoth.qty
39747>>>>>        //        move ''                                 to Tmpapoth.code
39747>>>>>        //        move ddate                              to tmpapoth.hmnia
39747>>>>>        //        move sitem                              to Tmpapoth.item
39747>>>>>        //        move sbranch                            to Tmpapoth.egkatastash
39747>>>>>        //        move smm                                to Tmpapoth.monada
39747>>>>>        //        move ''                                 to Tmpapoth.paralabh
39747>>>>>        //        saverecord tmpapoth
39747>>>>>        //        set pnqty to 0
39747>>>>>        
39747>>>>>        
39747>>>>>            End_Procedure
39748>>>>>        
39748>>>>>            Procedure_Section subtotal2
39750>>>>>         //       string sbranch sitem stype smm
39750>>>>>         //       date ddate
39750>>>>>         //       number nqty
39750>>>>>         //       move tmpapoth.monada to smm
39750>>>>>         //       get psbranch to sbranch
39750>>>>>         //       get psitem to sitem
39750>>>>>         //       get pnqty to nqty
39750>>>>>         //       get pddate to ddate
39750>>>>>         //       get pstype to stype
39750>>>>>         //       clear tmpapoth
39750>>>>>         //       move '91'                               to Tmpapoth.typos
39750>>>>>         //       move '9999999999'                       to Tmpapoth.arithmos
39750>>>>>         //       move stype                              to tmpapoth.type
39750>>>>>         //       move nqty                               to Tmpapoth.qty
39750>>>>>         //       move ''                                 to Tmpapoth.code
39750>>>>>         //       move ddate                              to tmpapoth.hmnia
39750>>>>>         //       move sitem                              to Tmpapoth.item
39750>>>>>         //       move sbranch                            to Tmpapoth.egkatastash
39750>>>>>         //       move smm                                to Tmpapoth.monada
39750>>>>>         //       move ''                                 to Tmpapoth.paralabh
39750>>>>>         //       saverecord tmpapoth
39750>>>>>         //       set pnqty to 0
39750>>>>>        
39750>>>>>            End_Procedure
39751>>>>>        
39751>>>>>            Procedure_Section subtotal1
39753>>>>>        //        string sbranch sitem stype smm
39753>>>>>        //        date ddate
39753>>>>>        //        number nqty
39753>>>>>        //        move tmpapoth.monada to smm
39753>>>>>        //        get psbranch to sbranch
39753>>>>>        //        get psitem to sitem
39753>>>>>        //        get pddate to ddate
39753>>>>>        //        get pnqty to nqty
39753>>>>>        //        get pstype to stype
39753>>>>>        //        clear tmpapoth
39753>>>>>        //        move '91'                               to Tmpapoth.typos
39753>>>>>        //        move '9999999999'                       to Tmpapoth.arithmos
39753>>>>>        //        move stype                              to tmpapoth.type
39753>>>>>        //        move nqty                               to Tmpapoth.qty
39753>>>>>        //        move ''                                 to Tmpapoth.code
39753>>>>>        //        move ddate                              to tmpapoth.hmnia
39753>>>>>        //        move sitem                              to Tmpapoth.item
39753>>>>>        //        move sbranch                            to Tmpapoth.egkatastash
39753>>>>>        //        move smm                                to Tmpapoth.monada
39753>>>>>        //        move ''                                 to Tmpapoth.paralabh
39753>>>>>        //        saverecord tmpapoth
39753>>>>>        //        set pnqty to 0
39753>>>>>        
39753>>>>>        End_Procedure
39754>>>>>        
39754>>>>>        
39754>>>>>        
39754>>>>>        Procedure Ending_Report
39756>>>>>            set psbranch    to ''
39757>>>>>            set psitem      to ''
39758>>>>>            set pddate      to ''
39759>>>>>            set pnqty       to 0
39760>>>>>            set pstype      to ''
39761>>>>>        End_Procedure
39762>>>>>        
39762>>>>>        End_Object
39763>>>>>        
39763>>>>>        
39763>>>>>        
39763>>>>>        
39763>>>>>        
39763>>>>>        //AB-StoreEnd
39763>>>>>
39763>>>>>    End_Object    // Rapoth
39764>>>>>
39764>>>>>
39764>>>>>    //AB-StoreStart
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    
39764>>>>>    //AB-StoreEnd
39764>>>>>
39764>>>>>//AB/     End_Object    // prj
39764>>>use     ranald.rv
INCLUDING FILE: RANALD.RV
39764>>>>>//AB/ Project ranald:analoseon synola itemd
39764>>>>>//AB/ Object prj is a Report_Project
39764>>>>>//AB/     Set ProjectName to "ranald:analoseon synola itemd"
39764>>>>>//AB/     Set ProjectFileName to "ranald.RV"
39764>>>>>
39764>>>>>// Project Object Structure
39764>>>>>//   ranald is a ReportViewSub
39764>>>>>//     ButtonSub3 is a ButtonSub
39764>>>>>//     ButtonSub4 is a ButtonSub
39764>>>>>//     rtehn_BasicReport is a BasicReport
39764>>>>>//       Tmpanal_DD is a Tmpanal_DataDictionary
39764>>>>>
39764>>>>>// Register all objects
39764>>>>>Register_Object ButtonSub3
39764>>>>>Register_Object ButtonSub4
39764>>>>>Register_Object ranald
39764>>>>>Register_Object rtehn_BasicReport
39764>>>>>Register_Object Tmpanal_DD
39764>>>>>
39764>>>>>
39764>>>>>//AB/ Report View
39764>>>>>
39764>>>>>
39764>>>>>//AB-StoreTopStart
39764>>>>>Use dfallrpt.pkg
39764>>>>>use tmpanal.dd
39764>>>>>//AB-StoreTopEnd
39764>>>>>
39764>>>>>//AB-IgnoreStart
39764>>>>>
39764>>>>>Use Rptvw.Sub
39764>>>>>Use Button.Sub
39764>>>>>
39764>>>>>//AB-IgnoreEnd
39764>>>>>
39764>>>>>ACTIVATE_VIEW Activate_ranald FOR ranald
39767>>>>>
39767>>>>>Object ranald is a ReportViewSub
39769>>>>>
39769>>>>>    //AB-StoreTopStart
39769>>>>>    Property Integer Sort_IndexRlog     Public 1
39771>>>>>    property number  pnqty              public 0
39773>>>>>    property integer pino               public 0
39775>>>>>    property string  pscode             public ''
39777>>>>>    property string  psitem             public ''
39779>>>>>    property date    pddate             public ''
39781>>>>>    property string  psbranch           public ''
39783>>>>>    property string psrecr              public ''
39785>>>>>    //AB-StoreTopEnd
39785>>>>>
39785>>>>>    Set Label to "€¤˜¢é©œ ª RECORD 09"
39786>>>>>    Set Size to 39 186
39787>>>>>    Set Location to 1 23
39788>>>>>    Set Color to 16744448
39789>>>>>
39789>>>>>    //AB-DDOStart
39789>>>>>
39789>>>>>
39789>>>>>    //AB-DDOEnd
39789>>>>>
39789>>>>>    Object ButtonSub3 is a ButtonSub
39791>>>>>        Set Bitmap to "RUNPROG.BMP"
39792>>>>>        Set Size to 18 27
39793>>>>>        Set Location to 3 119
39794>>>>>        Set Border_Style to Border_StaticEdge
39795>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39796>>>>>
39796>>>>>        //AB-StoreStart
39796>>>>>        Procedure OnClick
39798>>>>>        End_Procedure
39799>>>>>        
39799>>>>>        
39799>>>>>        
39799>>>>>        //AB-StoreEnd
39799>>>>>
39799>>>>>    End_Object    // ButtonSub3
39800>>>>>
39800>>>>>    Object ButtonSub4 is a ButtonSub
39802>>>>>        Set Bitmap to "CANCEL.BMP"
39803>>>>>        Set Size to 18 27
39804>>>>>        Set Location to 3 153
39805>>>>>        Set Border_Style to Border_StaticEdge
39806>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
39807>>>>>
39807>>>>>        //AB-StoreStart
39807>>>>>        Procedure OnClick
39809>>>>>            Send Request_Cancel
39810>>>>>        End_Procedure
39811>>>>>        
39811>>>>>        
39811>>>>>        //AB-StoreEnd
39811>>>>>
39811>>>>>    End_Object    // ButtonSub4
39812>>>>>
39812>>>>>
39812>>>>>    //AB-StoreStart
39812>>>>>    set output_device_name to none
39813>>>>>    Procedure StartReport
39815>>>>>        Local Integer iOutputDevice
39816>>>>>        Local String  FileName
39816>>>>>        SEND RUN_REPORT
39817>>>>>    End_Procedure   // StartReport
39818>>>>>    
39818>>>>>    Object rtehn_BasicReport is a BasicReport
39820>>>>>    
39820>>>>>        Set Report_Title to "„¤ž£â¨à©ž €¤˜¢é©œà¤ RECORD 09                   "
39821>>>>>        Set Report_Caption to "„¤ž£â¨à©ž €¤˜¢é©œà¤ RECORD 09 "
39822>>>>>    
39822>>>>>        Set Status_Panel_State  to true
39823>>>>>        Set Display_Error_State to True
39824>>>>>    
39824>>>>>        Object Tmpanal_DD is a Tmpanal_DataDictionary
39826>>>>>             begin_constraints
39828>>>>>                constrain tmpanal.typos eq '09'
39830>>>>>             end_constraints
39833>>>>>        End_Object    // tmpanal
39834>>>>>    
39834>>>>>        Set Server To (tmpanal_dd(Self))
39835>>>>>    
39835>>>>>        //Breaks and Index for the report
39835>>>>>        Report_Index By Index.5
39837>>>>>        Report_breaks tmpanal.hmnia tmpanal.typos tmpanal.egkatastash tmpanal.item tmpanal.trmetaf tmpanal.prodiagrafh tmpanal.itemd
39856>>>>>    
39856>>>>>        Function Starting_Main_Report Returns Integer
39858>>>>>          Integer iIndexRlog
39859>>>>>          Local Integer iRetVal
39859>>>>>          Forward Get Starting_Main_Report to iRetval
39861>>>>>          send rebuild_constraints to tmpanal_dd
39862>>>>>          Send Find to (tmpanal_dd(self)) First_Record 5
39863>>>>>        End_Function
39864>>>>>    
39864>>>>>        Procedure_Section subheader1
39866>>>>>        End_Procedure
39867>>>>>    
39867>>>>>        Procedure_Section subheader2
39869>>>>>        End_Procedure
39870>>>>>    
39870>>>>>        Procedure_Section subheader3
39872>>>>>        End_Procedure
39873>>>>>    
39873>>>>>        Procedure_Section subheader4
39875>>>>>        End_Procedure
39876>>>>>    
39876>>>>>        Procedure_Section subheader5
39878>>>>>        End_Procedure
39879>>>>>    
39879>>>>>        Procedure_Section subheader6
39881>>>>>            set pino to 0
39882>>>>>        End_Procedure
39883>>>>>    
39883>>>>>        Procedure_Section subheader7
39885>>>>>            set pnqty to 0
39886>>>>>        End_Procedure
39887>>>>>    
39887>>>>>        Procedure_Section  Body
39889>>>>>            integer ino
39890>>>>>            number nqty
39890>>>>>            set pnqty to (pnqty(self)+Tmpanal.posoths)
39891>>>>>            send update_status ('Ešš¨˜­ã ' + string(Tmpanal.itemd))
39892>>>>>        End_Procedure
39893>>>>>    
39893>>>>>        Procedure_Section subtotal7
39895>>>>>            string sbranch sitem
39896>>>>>            number nqty ino
39896>>>>>            date ddate
39896>>>>>            get psbranch to sbranch
39897>>>>>            set  pino to (pino(self)+1)
39898>>>>>            get pino to ino
39899>>>>>            get pnqty to nqty
39900>>>>>            move 0 to tmpanal.recnum
39901>>>>>            move nqty                               to tmpanal.posoths
39902>>>>>            move ino                                to tmpanal.aa
39903>>>>>            move '50' to tmpanal.typos
39904>>>>>            saverecord tmpanal
39905>>>>>        End_Procedure
39906>>>>>    
39906>>>>>        Procedure_Section subtotal6
39908>>>>>        End_Procedure
39909>>>>>    
39909>>>>>        Procedure_Section subtotal5
39911>>>>>    
39911>>>>>        End_Procedure
39912>>>>>    
39912>>>>>        Procedure_Section subtotal4
39914>>>>>        End_Procedure
39915>>>>>    
39915>>>>>        Procedure_Section subtotal3
39917>>>>>    
39917>>>>>        End_Procedure
39918>>>>>    
39918>>>>>        Procedure_Section subtotal2
39920>>>>>        End_Procedure
39921>>>>>    
39921>>>>>        Procedure_Section subtotal1
39923>>>>>    
39923>>>>>        End_Procedure
39924>>>>>       Procedure Ending_Report
39926>>>>>            clear tmpanal
39927>>>>>            find gt tmpanal.recnum
39928>>>>>>
39928>>>>>            while (found)
39932>>>>>                if (tmpanal.typos='09') delete tmpanal
39935>>>>>                else if (tmpanal.typos='50') begin
39938>>>>>                    move '09' to tmpanal.typos
39939>>>>>                    saverecord tmpanal
39940>>>>>                end
39940>>>>>>
39940>>>>>                find gt tmpanal.recnum
39941>>>>>>
39941>>>>>            Loop
39942>>>>>>
39942>>>>>       End_Procedure
39943>>>>>    
39943>>>>>    End_Object
39944>>>>>    
39944>>>>>    
39944>>>>>    //AB-StoreEnd
39944>>>>>
39944>>>>>End_Object    // ranald
39945>>>>>
39945>>>>>
39945>>>>>//AB-StoreStart
39945>>>>>
39945>>>>>//AB-StoreEnd
39945>>>>>
39945>>>>>//AB/ End_Object    // prj
39945>>>open    itemtehn
39947>>>open    itemd
INCLUDING FILE: ITEMD.FD
39949>>>Open    Pseira
INCLUDING FILE: PSEIRA.FD
39951>>>Use     Keimeno.dg
39951>>>Open    Tmplg
INCLUDING FILE: TMPLG.FD
39953>>>use     saprep.rv
INCLUDING FILE: SAPREP.RV
39953>>>>>//AB/ Project Saprep:sap report
39953>>>>>//AB/ Object prj is a Report_Project
39953>>>>>//AB/     Set ProjectName to "Saprep:sap report"
39953>>>>>//AB/     Set ProjectFileName to "Saprep.RV"
39953>>>>>
39953>>>>>// Project Object Structure
39953>>>>>//   Saprep is a ReportViewSub
39953>>>>>//     ButtonSub3 is a ButtonSub
39953>>>>>//     ButtonSub4 is a ButtonSub
39953>>>>>//     RadioGroupSub1 is a RadioGroupSub
39953>>>>>//       RadioSub1 is a RadioSub
39953>>>>>//       RadioSub2 is a RadioSub
39953>>>>>//       TextBoxSub1 is a TextBoxSub
39953>>>>>//       TextBoxSub2 is a TextBoxSub
39953>>>>>//     Sap_BasicReport is a BasicReport
39953>>>>>//       sysrep_DD is a sysrep_DataDictionary
39953>>>>>
39953>>>>>// Register all objects
39953>>>>>Register_Object ButtonSub3
39953>>>>>Register_Object ButtonSub4
39953>>>>>Register_Object RadioGroupSub1
39953>>>>>Register_Object RadioSub1
39953>>>>>Register_Object RadioSub2
39953>>>>>Register_Object Sap_BasicReport
39953>>>>>Register_Object Saprep
39953>>>>>Register_Object sysrep_DD
39953>>>>>Register_Object TextBoxSub1
39953>>>>>Register_Object TextBoxSub2
39953>>>>>
39953>>>>>
39953>>>>>//AB/ Report View
39953>>>>>
39953>>>>>
39953>>>>>//AB-StoreTopStart
39953>>>>>Use dfallrpt.pkg
39953>>>>>use sysrep.dd
INCLUDING FILE: SYSREP.DD
39953>>>>>>>//DDB-FileStart
39953>>>>>>>//DDB-HeaderStart
39953>>>>>>>
39953>>>>>>>// File Name : SYSREP.DD
39953>>>>>>>// Class Name: Sysrep_DataDictionary
39953>>>>>>>// Revision  : 11
39953>>>>>>>// Version   : 2
39953>>>>>>>
39953>>>>>>>Use  Windows           // Basic Definitions
39953>>>>>>>Use  DataDict          // DataDictionary Class Definition
39953>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
39953>>>>>>>
39953>>>>>>>Open Sysrep
INCLUDING FILE: SYSREP.FD
39955>>>>>>>
39955>>>>>>>//DDB-HeaderEnd
39955>>>>>>>
39955>>>>>>>Class Sysrep_DataDictionary  is a DataDictionary_Sec
39956>>>>>>>
39956>>>>>>>    // Define_Fields:
39956>>>>>>>    // This procedure is used to set up all data-dictionary rules.
39956>>>>>>>
39956>>>>>>>    Procedure Define_Fields
39957>>>>>>>        Forward Send Define_Fields
39959>>>>>>>        //DDB-Generated-Code-Location
39959>>>>>>>        //DDB-DefineFieldStart
39959>>>>>>>
39959>>>>>>>        Set Main_File            To Sysrep.File_Number
39960>>>>>>>        Set Cascade_Delete_State To FALSE
39961>>>>>>>
39961>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
39962>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
39963>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
39964>>>>>>>
39964>>>>>>>        // Field-based properties.......................
39964>>>>>>>
39964>>>>>>>        // Sysrep.View
39964>>>>>>>
39964>>>>>>>        // Sysrep.Descr
39964>>>>>>>
39964>>>>>>>        // Sysrep.Name
39964>>>>>>>
39964>>>>>>>        // Sysrep.Titan
39964>>>>>>>
39964>>>>>>>        // Sysrep.Descr1
39964>>>>>>>
39964>>>>>>>        //DDB-DefineFieldEnd
39964>>>>>>>    End_Procedure    // Define_Fields
39965>>>>>>>
39965>>>>>>>    // Field_Defaults:
39965>>>>>>>    // This procedure is used to establish default field values.
39965>>>>>>>
39965>>>>>>>    Procedure Field_Defaults
39966>>>>>>>        Forward Send Field_Defaults
39968>>>>>>>        //DDB-Generated-Code-Location
39968>>>>>>>        //DDB-FieldDefaultStart
39968>>>>>>>        //DDB-FieldDefaultEnd
39968>>>>>>>    End_Procedure    // Field_Defaults
39969>>>>>>>
39969>>>>>>>End_Class    // Sysrep_DataDictionary
39970>>>>>>>//DDB-FileEnd
39970>>>>>use rvisap.pkg
INCLUDING FILE: RVISAP.PKG
/HEADERSAP_1
Image 2, HEADERSAP_1
!
                                              „Š„‚•Ž‘ „€‚—‹„Œ—Œ „‚‚€”—Œ ’†Œ __/__/____
                                              ------------------------------------------
/Bodysap_1
Image 3, BODYSAP_1
 _____ ______
/totalsap_1
Image 4, TOTALSAP_1
=========================================================================================
¢ãŸ¦ª „šš¨˜­é¤  œ¢˜«é¤  ASCII        __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  ˜¨˜©«˜« ¡é¤ ASCII    __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  „ ©§¨á¥œà¤ ASCII      __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  A§¦Ÿã¡žª   ASCII      __z___    €•„ˆ—Œ   __z___
¢ãŸ¦ª „šš¨˜­é¤  A¤˜¢é©œà¤  ASCII      __z___    €•„ˆ—Œ   __z___
=========================================================================================
!
/Footersap_1
Image 5, FOOTERSAP_1
/*
39970>>>>>open company
39972>>>>>open tmpclsap
39974>>>>>open tmppol
39976>>>>>open tmpaxio
39978>>>>>open tmpapoth
39980>>>>>open tmpanal
39982>>>>>//AB-StoreTopEnd
39982>>>>>
39982>>>>>//AB-IgnoreStart
39982>>>>>
39982>>>>>Use Rptvw.Sub
39982>>>>>Use Button.Sub
39982>>>>>Use Rgroup.Sub
39982>>>>>Use Radio.Sub
39982>>>>>Use Txtbox.Sub
39982>>>>>
39982>>>>>//AB-IgnoreEnd
39982>>>>>
39982>>>>>ACTIVATE_VIEW Activate_Saprep FOR Saprep
39985>>>>>
39985>>>>>Object Saprep is a ReportViewSub
39987>>>>>
39987>>>>>    //AB-StoreTopStart
39987>>>>>    
39987>>>>>    property date    pddate             public ''
39989>>>>>    property string pspath              public ''
39991>>>>>    
39991>>>>>    //AB-StoreTopEnd
39991>>>>>
39991>>>>>    Set Label to "„¢œš®¦ª ˜¨˜šé£œ¤à¤ €¨®œåà¤"
39992>>>>>    Set Size to 72 186
39993>>>>>    Set Location to 1 23
39994>>>>>    Set Color to 16744448
39995>>>>>
39995>>>>>    //AB-DDOStart
39995>>>>>
39995>>>>>
39995>>>>>    //AB-DDOEnd
39995>>>>>
39995>>>>>    Object ButtonSub3 is a ButtonSub
39997>>>>>        Set Bitmap to "RUNPROG.BMP"
39998>>>>>        Set Size to 18 27
39999>>>>>        Set Location to 14 91
40000>>>>>        Set Border_Style to Border_StaticEdge
40001>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40002>>>>>
40002>>>>>        //AB-StoreStart
40002>>>>>        Procedure OnClick
40004>>>>>            send startreport
40005>>>>>        End_Procedure
40006>>>>>        
40006>>>>>        
40006>>>>>        
40006>>>>>        //AB-StoreEnd
40006>>>>>
40006>>>>>    End_Object    // ButtonSub3
40007>>>>>
40007>>>>>    Object ButtonSub4 is a ButtonSub
40009>>>>>        Set Bitmap to "CANCEL.BMP"
40010>>>>>        Set Size to 18 27
40011>>>>>        Set Location to 14 130
40012>>>>>        Set Border_Style to Border_StaticEdge
40013>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
40014>>>>>
40014>>>>>        //AB-StoreStart
40014>>>>>        Procedure OnClick
40016>>>>>            Send Request_Cancel
40017>>>>>        End_Procedure
40018>>>>>        
40018>>>>>        //AB-StoreEnd
40018>>>>>
40018>>>>>    End_Object    // ButtonSub4
40019>>>>>
40019>>>>>    Object RadioGroupSub1 is a RadioGroupSub
40021>>>>>
40021>>>>>        //AB-StoreTopStart
40021>>>>>                                                                                                                                                                                                                                                                        
40021>>>>>        //AB-StoreTopEnd
40021>>>>>
40021>>>>>        Set Label to "„¡«ç&§à©ž"
40022>>>>>        Set Size to 42 78
40023>>>>>        Set Location to 4 3
40024>>>>>        Object RadioSub1 is a RadioSub
40026>>>>>            Set Size to 10 13
40027>>>>>            Set Location to 12 63
40028>>>>>        End_Object    // RadioSub1
40029>>>>>
40029>>>>>        Object RadioSub2 is a RadioSub
40031>>>>>            Set Size to 10 13
40032>>>>>            Set Location to 28 63
40033>>>>>        End_Object    // RadioSub2
40034>>>>>
40034>>>>>        Object TextBoxSub1 is a TextBoxSub
40036>>>>>            Set Label to "ŽŸæ¤ž :"
40037>>>>>            Set Auto_Size_State to FALSE
40038>>>>>            Set FontSize to 4 0
40039>>>>>            Set Location to 10 5
40040>>>>>            Set Size to 12 45
40041>>>>>            Set TypeFace to "MS Sans Serif"
40042>>>>>            Set Enabled_State to TRUE
40043>>>>>        End_Object    // TextBoxSub1
40044>>>>>
40044>>>>>        Object TextBoxSub2 is a TextBoxSub
40046>>>>>            Set Label to "„¡«¬§à«ãª : "
40047>>>>>            Set Auto_Size_State to FALSE
40048>>>>>            Set FontSize to 4 0
40049>>>>>            Set Location to 24 5
40050>>>>>            Set Size to 12 45
40051>>>>>            Set TypeFace to "MS Sans Serif"
40052>>>>>            Set Enabled_State to TRUE
40053>>>>>        End_Object    // TextBoxSub2
40054>>>>>
40054>>>>>
40054>>>>>        //AB-StoreStart
40054>>>>>        Procedure Notify_Select_State  Integer iNewItem  Integer iOldItem
40056>>>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
40058>>>>>            If iNewItem EQ 0 Set Output_Device_Mode  To PRINT_TO_WINDOW
40061>>>>>            Else             Set Output_Device_Mode  To PRINT_TO_PRINTER
40063>>>>>        End_Procedure
40064>>>>>        //AB-StoreEnd
40064>>>>>
40064>>>>>    End_Object    // RadioGroupSub1
40065>>>>>
40065>>>>>
40065>>>>>    //AB-StoreStart
40065>>>>>    
40065>>>>>    Procedure StartReport
40067>>>>>        String  FileName lsdatetor6_1## lsdatefromr6_1## lsctypkinfromr6_1##
40068>>>>>        string lsctypkintor6_1## limonthr6_1## lscustfromr6_1## lscusttor6_1##
40068>>>>>        integer lizeror6_1## iOutputDevice epil##
40068>>>>>        string datehh## datemm## dateyy## dateapo## dateeos##
40068>>>>>    
40068>>>>>        Get Output_Device_Mode To iOutputDevice
40069>>>>>    
40069>>>>>        If iOutputDevice EQ PRINT_TO_WINDOW Begin
40071>>>>>            Make_Temp_File "TXT" FileName
40072>>>>>            Move (".\" - FileName)  To FileName
40073>>>>>            Set Output_Device_Name  To FileName
40074>>>>>        End
40074>>>>>>
40074>>>>>        Else Set Output_Device_Name  To "Lpt1:"
40076>>>>>    
40076>>>>>        Send Run_Report
40077>>>>>    
40077>>>>>        If iOutputDevice EQ PRINT_TO_WINDOW Begin
40079>>>>>            RunProgram background "notepad" FileName
40080>>>>>            EraseFile FileName
40081>>>>>>
40081>>>>>        End
40081>>>>>>
40081>>>>>    End_Procedure
40082>>>>>    
40082>>>>>    
40082>>>>>    
40082>>>>>    Object Sap_BasicReport is a BasicReport
40084>>>>>    
40084>>>>>      Set Report_Title to "„¢œš®¦ª „šš¨˜­é¤ ASCII €¨®œåà¤                   "
40085>>>>>      Set Report_Caption to "„¢œš®¦ª €¨®œåà¤  "
40086>>>>>    
40086>>>>>      Set Status_Panel_State  to true
40087>>>>>      Set Display_Error_State to True
40088>>>>>    
40088>>>>>      Object sysrep_DD is a sysrep_DataDictionary
40090>>>>>      End_Object    // tmpanal
40091>>>>>    
40091>>>>>      Set Server To (sysrep_dd(Self))
40092>>>>>    
40092>>>>>      //Breaks and Index for the report
40092>>>>>      Report_Index By Index.1
40094>>>>>    
40094>>>>>      Function Starting_Main_Report Returns Integer
40096>>>>>        Integer iIndexRlog
40097>>>>>        Local Integer iRetVal
40097>>>>>        blankform headersap_1.1
40098>>>>>>
40098>>>>>        blankform bodysap_1.1 thru bodysap_1.2
40099>>>>>>
40099>>>>>        blankform totalsap_1.1 thru totalsap_1.10
40100>>>>>>
40100>>>>>        Forward Get Starting_Main_Report to iRetval
40102>>>>>        Send Find to (sysrep_dd(self)) First_Record 1
40103>>>>>      End_Function
40104>>>>>    
40104>>>>>       Procedure_Section Page_Top as Headersap_1
40109>>>>>          date ddate
40109>>>>>          get pddate to ddate
40110>>>>>          print ddate to headersap_1.1
40111>>>>>          OutPut_PageCheck
40112>>>>>      End_Procedure
40113>>>>>    
40113>>>>>      Procedure_Section  Body as Bodysap_1
40118>>>>>      End_procedure
40119>>>>>    
40119>>>>>      Procedure_Section  total as totalsap_1
40124>>>>>        Integer rVal iMhnas iEtos iHmera iNum  Inum1 ierr
40124>>>>>        string stomeas spath shmera smhnas setos  sstr SFILENAME STYPOS
40124>>>>>        date dAPO
40124>>>>>        move 0 to ierr
40125>>>>>        get pspath to spath
40126>>>>>        get pddate to dAPO
40127>>>>>        clear Company
40128>>>>>        move syscurxr.company_code      to Company.company_code
40129>>>>>        find eq company by index.1
40130>>>>>>
40130>>>>>        move Company.company_c_code0    to stomeas
40131>>>>>        Move (TheDaySegment  (dapo))    to iHmera
40132>>>>>        Move (TheMonthSegment(dapo))    to iMhnas
40133>>>>>        Move (TheYearSegment(dapo))     to ietos
40134>>>>>        Move iHmera                     to sHmera
40135>>>>>        Move iMhnas                     to sMhnas
40136>>>>>        Move iEtos                      to sEtos
40137>>>>>        If (Length(sHmera)=1) Insert '0' in sHmera at 1
40141>>>>>        If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
40145>>>>>        //FI1
40145>>>>>        move 0 to inum
40146>>>>>        move 0 to inum1
40147>>>>>        Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
40148>>>>>         Direct_Input Channel 9 sFileName
40150>>>>>         Readln Channel 9 sStr
40152>>>>>         While (Not(Seqeof))
40156>>>>>             Move (Mid(sstr,2,04))  to stypos
40157>>>>>             move (trim(stypos)) to stypos
40158>>>>>             if (stypos<>'90');                Add 1 to iNum
40161>>>>>             Readln Channel 9 sStr
40163>>>>>         Loop
40164>>>>>>
40164>>>>>         Close_Input Channel 9
40166>>>>>         print iNum to totalsap_1.1
40167>>>>>         clear tmpclsap
40168>>>>>         find gt tmpclsap.recnum
40169>>>>>>
40169>>>>>         while (found)
40173>>>>>             Move (trim(tmpclsap.typos))  to stypos
40174>>>>>             move (trim(stypos)) to stypos
40175>>>>>             if (stypos<>'90');                Add 1 to iNum1
40178>>>>>             find gt tmpclsap.recnum
40179>>>>>>
40179>>>>>         Loop
40180>>>>>>
40180>>>>>         print iNum1 to totalsap_1.2
40181>>>>>         //FI2
40181>>>>>         MOVE 0 TO INUM
40182>>>>>         move 0 to inum1
40183>>>>>         Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
40184>>>>>         Direct_Input Channel 9 sFileName
40186>>>>>         Readln Channel 9 sStr
40188>>>>>         While (Not(Seqeof))
40192>>>>>             Move (Mid(sstr,2,04))  to stypos
40193>>>>>             move (trim(stypos)) to stypos
40194>>>>>             if (stypos='01');                Add 1 to iNum
40197>>>>>             Readln Channel 9 sStr
40199>>>>>         Loop
40200>>>>>>
40200>>>>>         Close_Input Channel 9
40202>>>>>         print iNum to totalsap_1.3
40203>>>>>         clear tmppol
40204>>>>>         find gt tmppol.recnum
40205>>>>>>
40205>>>>>         while (found)
40209>>>>>             Move (trim(tmppol.typos))  to stypos
40210>>>>>             move (trim(stypos)) to stypos
40211>>>>>             if (stypos='01');                Add 1 to iNum1
40214>>>>>             find gt tmppol.recnum
40215>>>>>>
40215>>>>>         Loop
40216>>>>>>
40216>>>>>         print iNum1 to totalsap_1.4
40217>>>>>    
40217>>>>>    
40217>>>>>         //FI3
40217>>>>>         MOVE 0 TO INUM
40218>>>>>         move 0 to inum1
40219>>>>>         Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
40220>>>>>         Direct_Input Channel 9 sFileName
40222>>>>>         Readln Channel 9 sStr
40224>>>>>         While (Not(Seqeof))
40228>>>>>             Move (Mid(sstr,2,04))  to stypos
40229>>>>>             move (trim(stypos)) to stypos
40230>>>>>             if (stypos='01');                Add 1 to iNum
40233>>>>>             Readln Channel 9 sStr
40235>>>>>         Loop
40236>>>>>>
40236>>>>>         Close_Input Channel 9
40238>>>>>         print iNum to totalsap_1.5
40239>>>>>         clear tmpaxio
40240>>>>>         find gt tmpaxio.recnum
40241>>>>>>
40241>>>>>         while (found)
40245>>>>>             Move (trim(tmpaxio.typos))  to stypos
40246>>>>>             move (trim(stypos)) to stypos
40247>>>>>             if (stypos='01');                Add 1 to iNum1
40250>>>>>             find gt tmpaxio.recnum
40251>>>>>>
40251>>>>>         Loop
40252>>>>>>
40252>>>>>         print iNum1 to totalsap_1.6
40253>>>>>         //MM1
40253>>>>>         MOVE 0 TO INUM
40254>>>>>         move 0 to inum1
40255>>>>>         Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
40256>>>>>         Direct_Input Channel 9 sFileName
40258>>>>>         Readln Channel 9 sStr
40260>>>>>         While (Not(Seqeof))
40264>>>>>             Move (Mid(sstr,2,04))  to stypos
40265>>>>>             move (trim(stypos)) to stypos
40266>>>>>             if (stypos='01');                Add 1 to iNum
40269>>>>>             Readln Channel 9 sStr
40271>>>>>         Loop
40272>>>>>>
40272>>>>>         Close_Input Channel 9
40274>>>>>         print iNum to totalsap_1.7
40275>>>>>         clear tmpapoth
40276>>>>>         find gt tmpapoth.recnum
40277>>>>>>
40277>>>>>         while (found)
40281>>>>>             Move (trim(tmpapoth.typos))  to stypos
40282>>>>>             move (trim(stypos)) to stypos
40283>>>>>             if (stypos='01');                Add 1 to iNum1
40286>>>>>             find gt tmpapoth.recnum
40287>>>>>>
40287>>>>>         Loop
40288>>>>>>
40288>>>>>         print iNum1 to totalsap_1.8
40289>>>>>         //PP2
40289>>>>>         MOVE 0 TO INUM
40290>>>>>         move 0 to inum1
40291>>>>>         Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas);                +Trim(sHmera)+'.txt')   to sFileName
40292>>>>>         Direct_Input Channel 9 sFileName
40294>>>>>         Readln Channel 9 sStr
40296>>>>>         While (Not(Seqeof))
40300>>>>>             Move (Mid(sstr,2,04))  to stypos
40301>>>>>             move (trim(stypos)) to stypos
40302>>>>>             if (stypos='09');                Add 1 to iNum
40305>>>>>             Readln Channel 9 sStr
40307>>>>>         Loop
40308>>>>>>
40308>>>>>         Close_Input Channel 9
40310>>>>>         print iNum to totalsap_1.9
40311>>>>>         clear tmpanal
40312>>>>>         find gt tmpanal.recnum
40313>>>>>>
40313>>>>>         while (found)
40317>>>>>             Move (trim(tmpanal.typos))  to stypos
40318>>>>>             move (trim(stypos)) to stypos
40319>>>>>             if (stypos='09');                Add 1 to iNum1
40322>>>>>             find gt tmpanal.recnum
40323>>>>>>
40323>>>>>         Loop
40324>>>>>>
40324>>>>>         print iNum1 to totalsap_1.10
40325>>>>>         OutPut_PageCheck
40326>>>>>         if (totalsap_1.1 <> totalsap_1.2) move 1 to ierr
40329>>>>>         if (totalsap_1.3 <> totalsap_1.4) move 2 to ierr
40332>>>>>         if (totalsap_1.5 <> totalsap_1.6) move 3 to ierr
40335>>>>>         if (totalsap_1.7 <> totalsap_1.8) move 4 to ierr
40338>>>>>         if (totalsap_1.9 <> totalsap_1.10) move 5 to ierr
40341>>>>>         if (ierr) begin
40343>>>>>                   if (ierr=1) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ „Š€’—Œ' '‘”€Š‹€'
40346>>>>>              else if (ierr=2) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ —Š†‘„—Œ' '‘”€Š‹€'
40350>>>>>              else if (ierr=3) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ „ˆ‘€„—Œ' '‘”€Š‹€'
40354>>>>>              else if (ierr=4) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ €Ž‡†‰†‘' '‘”€Š‹€'
40358>>>>>              else if (ierr=5) send info_box '€‘“‹”—Œˆ€ „‚‚€”—Œ ‘’Ž €•„ˆŽ €Œ€Š—‘„—Œ ' '‘”€Š‹€'
40362>>>>>         END
40362>>>>>>
40362>>>>>      End_Procedure
40363>>>>>    
40363>>>>>    
40363>>>>>        Procedure Ending_Report
40365>>>>>        End_Procedure
40366>>>>>    
40366>>>>>    End_Object
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    
40367>>>>>    //AB-StoreEnd
40367>>>>>
40367>>>>>End_Object    // Saprep
40368>>>>>
40368>>>>>
40368>>>>>//AB-StoreStart
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>    
40368>>>>>//AB-StoreEnd
40368>>>>>
40368>>>>>//AB/ End_Object    // prj
40368>>>
40368>>>//AB-StoreTopEnd
40368>>>
40368>>>//AB-IgnoreStart
40368>>>
40368>>>Use dbViews.Sub
INCLUDING FILE: DBVIEWS.SUB
40368>>>>>Open Oth 
40370>>>>>Open GrpAct
INCLUDING FILE: GRPACT.FD
40372>>>>>Open GrpAct0
INCLUDING FILE: GRPACT0.FD
40374>>>>>
40374>>>>>Class DbviewSubs Is A DbviewSub
40375>>>>>
40375>>>>>    Procedure Construct_Object
40376>>>>>        Integer iPos iCount
40377>>>>>        Forward Send Construct_Object
40379>>>>>
40379>>>>>        Property String     psMyViewName        Public ''
40380>>>>>        Property Integer    piMyViewID          Public  0
40381>>>>>        Property Integer    piDoNotActivateView Public  0
40382>>>>>
40382>>>>>        Get Name            to gsViewName
40383>>>>>        Get Object_ID       to giViewID
40384>>>>>
40384>>>>>        Move 0 to iPos
40385>>>>>        For iCount From 1 to (Length(gsViewName))
ERROR: 54 Invalid symbol in expression GSVIEWNAME ON LINE: 19 (40385) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40391>>>>>>
40391>>>>>            If (Mid(gsViewName,1,iCount)='.') Move iCount to iPos
ERROR: 54 Invalid symbol in expression GSVIEWNAME ON LINE: 20 (40391) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40394>>>>>        Loop
40395>>>>>>
40395>>>>>        Move (Right(gsViewName,(Length(gsViewName)-iPos))) to gsViewName
ERROR: 54 Invalid symbol in expression GSVIEWNAME ON LINE: 22 (40395) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4345 Type check error GSVIEWNAME, GSVIEWNAME,  ON LINE: 22 (40395) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4328 Undefined symbol in argument GSVIEWNAME ON LINE: 22 (40395) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40396>>>>>        Move (Trim(gsViewName)) to gsViewName
ERROR: 54 Invalid symbol in expression GSVIEWNAME ON LINE: 23 (40396) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4345 Type check error GSVIEWNAME, GSVIEWNAME,  ON LINE: 23 (40396) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4328 Undefined symbol in argument GSVIEWNAME ON LINE: 23 (40396) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40397>>>>>
40397>>>>>        Set psMyViewName    to (Trim(gsViewName))
ERROR: 54 Invalid symbol in expression GSVIEWNAME ON LINE: 25 (40397) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40398>>>>>        Set piMyViewID      to giViewID
40399>>>>>
40399>>>>>    End_Procedure
40400>>>>>
40400>>>>>    Procedure End_Construct_Object
40401>>>>>        Integer iFileNumber iFieldNumber iUser iColor iLimit iBase iCurr iCol iDeo iPos
40402>>>>>        Integer iObj iPrototype iColumn iItem iInt iFieldStatus iCurCol iCount
40402>>>>>        String  sFileName sFieldName sUser sRecr sStr sDbFormName sViewLabel sDeo svn
40402>>>>>
40402>>>>>        Forward Send End_Construct_Object
40404>>>>>
40404>>>>>        Get psMyViewName        to gsViewName
40405>>>>>        Get piMyViewID          to giViewID
40406>>>>>        Get Label Of giViewID   to sViewLabel
ERROR: 300 INVALID OBJECT REFERENCE ON LINE: 39 (40406) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40406>>>>>        Move (Trim(sViewLabel)) to sViewLabel
40407>>>>>
40407>>>>>        Clear Oth
40408>>>>>        Move gsViewName to Oth.View_Name
ERROR: 4328 Undefined symbol in argument GSVIEWNAME ON LINE: 43 (40408) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40409>>>>>        Find eq Oth By Index.2 // Oth:Index.2:View_Name
40410>>>>>>
40410>>>>>        If (Not(Found)) Begin
40412>>>>>            Move sViewLabel to Oth.View_Label
40413>>>>>            Move giViewID   to Oth.View_ID
ERROR: 4328 Undefined symbol in argument GIVIEWID ON LINE: 47 (40413) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
40414>>>>>            Saverecord Oth
40415>>>>>        End
40415>>>>>>
40415>>>>>
40415>>>>>//        Set piDoNotActivateView to 0
40415>>>>>//        Send DisableActivateView
40415>>>>>
40415>>>>>    End_Procedure //End_Construct_Object
40416>>>>>
40416>>>>>    Procedure Activate_View Returns Integer
40417>>>>>        String  lsLogin
40418>>>>>        String sLektiko
40418>>>>>        Integer liUser iGroup rVal
40418>>>>>        Set piDoNotActivateView to 0
40419>>>>>        Send DisableActivateView
40420>>>>>        If (piDoNotActivateView(Self)=0) Forward get Msg_Activate_View to rVal
40424>>>>>        Else Move -1 to rVal
40426>>>>>        Procedure_Return rVal
40427>>>>>    End_procedure
40428>>>>>
40428>>>>>
40428>>>>>    Procedure DisableActivateView
40429>>>>>        String  lsLogin
40430>>>>>        String sLektiko
40430>>>>>        Integer liUser iGroup rVal
40430>>>>>
40430>>>>>        Move (fsLoginUserID())      to lsLogin
40431>>>>>        Clear Users
40432>>>>>        Move lsLogin    to Users.Login_ID
40433>>>>>        Find eq Users by Index.1 // Users:Index.1:Users.Login_ID
40434>>>>>>
40434>>>>>        If (Found=1)  Begin
40436>>>>>            Move Users.User_ID  to liUser
40437>>>>>            Move Users.Grp_ID   to iGroup
40438>>>>>        End
40438>>>>>>
40438>>>>>        
40438>>>>>        Clear GrpAct
40439>>>>>        Move liUser                 to GrpAct.User_ID
40440>>>>>        Move (psMyViewName(Self))   to GrpAct.View_Name
40441>>>>>        Find Eq GrpAct By Index.1
40442>>>>>>
40442>>>>>        If (Found) Begin
40444>>>>>            If (GrpAct.Allow=0) Begin
40446>>>>>                Set piDoNotActivateView to 1
40447>>>>>                Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ •¨ã©«ž š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
40448>>>>>                Send Stop_Box sLektiko "Error 30001"
40449>>>>>                Procedure_Return -1
40450>>>>>            End
40450>>>>>>
40450>>>>>        End
40450>>>>>>
40450>>>>>
40450>>>>>        Clear GrpAct0
40451>>>>>        Move iGroup                 to GrpAct0.Group_ID
40452>>>>>        Move (psMyViewName(Self))   to GrpAct0.View_Name
40453>>>>>        Find Eq GrpAct0 By Index.1
40454>>>>>>
40454>>>>>        If ((Found) And (GrpAct0.Allow=0)) Begin
40456>>>>>            Set piDoNotActivateView to 1
40457>>>>>            Move "€¤œ§˜¨¡ã › ˜¡ é£˜«˜ Ž£á›˜ª š ˜ œ¤œ¨š¦§¦åž©ž «¦¬ §˜¨˜Ÿç¨¦¬\n„§ ¡¦ ¤à¤ã©«œ £œ «¦¤ ƒ ˜®œ ¨ ©«ã «¦¬ ©¬©«ã£˜«¦ª" to sLektiko
40458>>>>>            Send Stop_Box sLektiko "Error 30002"
40459>>>>>            Procedure_Return -1
40460>>>>>        End
40460>>>>>>
40460>>>>>    End_procedure
40461>>>>>
40461>>>>>
40461>>>>>End_Class //dbviewSubs
40462>>>>>
40462>>>>>
40462>>>Use DFAllEnt.pkg
40462>>>Use Form.Sub
40462>>>Use Rgroup.Sub
40462>>>Use Radio.Sub
40462>>>Use Button.Sub
40462>>>Use Txtbox.Sub
40462>>>Use Chkbox.Sub
40462>>>
40462>>>Use CLIENTS.DD
INCLUDING FILE: CLIENTS.DD
40462>>>>>//DDB-FileStart
40462>>>>>//DDB-HeaderStart
40462>>>>>
40462>>>>>// File Name : CLIENTS.DD
40462>>>>>// Class Name: Clients_DataDictionary
40462>>>>>// Revision  : 245
40462>>>>>// Version   : 2
40462>>>>>
40462>>>>>Use  Windows           // Basic Definitions
40462>>>>>Use  DataDict          // DataDictionary Class Definition
40462>>>>>Use  DDvalTbl          // Validation Table Class Definitions
40462>>>>>
40462>>>>>Open Clients
40464>>>>>Open Cmoves
40466>>>>>Open Particle
40468>>>>>Open Cmovesa
40470>>>>>Open Cn
40472>>>>>Open Particll
INCLUDING FILE: PARTICLL.FD
40474>>>>>Open Clnbank
INCLUDING FILE: CLNBANK.FD
40476>>>>>Open Tpclient
INCLUDING FILE: TPCLIENT.FD
40478>>>>>Open Clorder
INCLUDING FILE: CLORDER.FD
40480>>>>>Open Clitem
INCLUDING FILE: CLITEM.FD
40482>>>>>Open Cities
40484>>>>>Open Areas
40486>>>>>Open Payresp
40488>>>>>Open Syscurxr
40490>>>>>Open Sysrecc
INCLUDING FILE: SYSRECC.FD
40492>>>>>Open Ptypparl
40494>>>>>Open Gmove
INCLUDING FILE: GMOVE.FD
40496>>>>>Open Sysrecg
40498>>>>>
40498>>>>>//DDB-HeaderEnd
40498>>>>>//DDB-ValidationStart
40498>>>>>
40498>>>>>Register_Object Clients_Client_Doy_VT
40498>>>>>Register_Object Clients_Client_Job_VT
40498>>>>>Register_Object Clients_Client_Categfpa_VT
40498>>>>>Register_Object Clients_Client_Catjob_VT1
40498>>>>>Register_Object Clients_Client_Idiot_VT
40498>>>>>Register_Object Clients_Feregios_VT
40498>>>>>
40498>>>>>Object Clients_Client_Doy_VT  is a CodeValidationTable
40500>>>>>    Set Type_Value        To "DOY"
40501>>>>>    Set Validate_State    To FALSE
40502>>>>>    Set Allow_Blank_State To TRUE
40503>>>>>    Set Table_Title       To "ƒ.Ž.“"
40504>>>>>    //DDB-ValidationCustomStart
40504>>>>>    //DDB-ValidationCustomEnd
40504>>>>>End_Object   // Clients_Client_Doy_VT
40505>>>>>
40505>>>>>Object Clients_Client_Job_VT  is a CodeValidationTable
40507>>>>>    Set Type_Value        To "JOB"
40508>>>>>    Set Validate_State    To FALSE
40509>>>>>    Set Allow_Blank_State To TRUE
40510>>>>>    Set Table_Title       To "„§˜ššâ¢£˜«˜"
40511>>>>>    //DDB-ValidationCustomStart
40511>>>>>    //DDB-ValidationCustomEnd
40511>>>>>End_Object   // Clients_Client_Job_VT
40512>>>>>
40512>>>>>Object Clients_Client_Categfpa_VT  is a CodeValidationTable
40514>>>>>    Set Type_Value        To "VAT_STATUS"
40515>>>>>    Set Validate_State    To FALSE
40516>>>>>    Set Allow_Blank_State To TRUE
40517>>>>>    //DDB-ValidationCustomStart
40517>>>>>    //DDB-ValidationCustomEnd
40517>>>>>End_Object   // Clients_Client_Categfpa_VT
40518>>>>>
40518>>>>>Object Clients_Client_Catjob_VT1  is a CodeValidationTable
40520>>>>>    Set Type_Value        To "JOB"
40521>>>>>    Set Validate_State    To FALSE
40522>>>>>    Set Allow_Blank_State To TRUE
40523>>>>>    //DDB-ValidationCustomStart
40523>>>>>    //DDB-ValidationCustomEnd
40523>>>>>End_Object   // Clients_Client_Catjob_VT1
40524>>>>>
40524>>>>>Object Clients_Client_Idiot_VT  is a CodeValidationTable
40526>>>>>    Set Type_Value        To "IDIOT"
40527>>>>>    Set Validate_State    To FALSE
40528>>>>>    Set Allow_Blank_State To TRUE
40529>>>>>    Set Table_Title       To "€¨®œå¦ ˆ› ¦«ã«à¤"
40530>>>>>    //DDB-ValidationCustomStart
40530>>>>>    //DDB-ValidationCustomEnd
40530>>>>>End_Object   // Clients_Client_Idiot_VT
40531>>>>>
40531>>>>>Object Clients_Feregios_VT  is a CodeValidationTable
40533>>>>>    Set Type_Value        To "FEREGIOS"
40534>>>>>    Set Allow_Blank_State To TRUE
40535>>>>>    Set Table_Title       To "ƒœå¡«œª ”œ¨œšš¬æ«ž«˜ª ”¦¨âà¤"
40536>>>>>    //DDB-ValidationCustomStart
40536>>>>>    //DDB-ValidationCustomEnd
40536>>>>>End_Object   // Clients_Feregios_VT
40537>>>>>//DDB-ValidationEnd
40537>>>>>//DDB-SelectionStart
40537>>>>>//DDB/ ExternalSelectionList sl100  sl100.SL
40537>>>>>//DDB/ ExternalSelectionList slPayTerms  slPayTerms.SL
40537>>>>>Register_Object sl100
40537>>>>>Register_Object slPayTerms
40537>>>>>//DDB-SelectionEnd
40537>>>>>
40537>>>>>Open Sysfile
40539>>>>>open year
40541>>>>>
40541>>>>>Class Clients_DataDictionary  is a DataDictionary_Sec
40542>>>>>
40542>>>>>    Procedure Construct_Object
40543>>>>>        Forward Send Construct_Object
40545>>>>>        Property Integer piMustNOTConstrain Public 0
40546>>>>>        Property Integer piCheckPlaf        Public 0
40547>>>>>        //------------------------------------------------
40547>>>>>        // Properties gia na kraththoun oi palies times
40547>>>>>        // ton pedion Ef' oson to Sysfile.Use_Audit pedio
40547>>>>>        // einai 1     js 03/12/2007
40547>>>>>        //------------------------------------------------
40547>>>>>        Property Integer piCreateNew            Public  0
40548>>>>>        Property String  psAud_Old_Pelaths      Public ""
40549>>>>>        Property String  psAud_Old_PelathsN     Public ""
40550>>>>>        Property String  psAud_Old_AFM          Public ""
40551>>>>>        Property String  psAud_Old_DOY          Public ""
40552>>>>>        Property String  psAud_Old_DOYN         Public ""
40553>>>>>        Property Integer piAud_Old_HPAL         Public  0
40554>>>>>        Property Integer piAud_Old_HPSO         Public  0
40555>>>>>        Property String  psAud_Old_PartlRecr    Public ""
40556>>>>>        Property String  psAud_Old_PmsRecr      Public ""
40557>>>>>        //------------------------------------------------
40557>>>>>
40557>>>>>    End_Procedure
40558>>>>>
40558>>>>>    Procedure New_Current_Record  Integer iOldRec  Integer iNewRec
40559>>>>>        Forward Send New_Current_Record  iOldRec iNewRec
40561>>>>>        //------------------------------------------------
40561>>>>>        // Properties gia na kraththoun oi palies times
40561>>>>>        // ton pedion js 03/12/2007
40561>>>>>        //------------------------------------------------
40561>>>>>        Set psAud_Old_Pelaths      to Clients.Client_ID
40562>>>>>        Set psAud_Old_PelathsN     to Clients.Client_Name
40563>>>>>        Set psAud_Old_AFM          to Clients.Client_AFM
40564>>>>>        Set psAud_Old_DOY          to Clients.Client_Doy
40565>>>>>        Set psAud_Old_DOYN         to (gsfCode_Mast("DOY",Clients.Client_Doy))
40566>>>>>        Set piAud_Old_HPAL         to Clients.HPAL
40567>>>>>        Set piAud_Old_HPSO         to Clients.HPSO
40568>>>>>        Set psAud_Old_PartlRecr    to Clients.Client_Recr
40569>>>>>        Set psAud_Old_PmsRecr      to Clients.Client_Recr
40570>>>>>        //------------------------------------------------
40570>>>>>     End_Procedure   // New_Current_Record
40571>>>>>
40571>>>>>
40571>>>>>    // Backout:
40571>>>>>    Procedure Backout
40572>>>>>        Forward Send Backout
40574>>>>>        // Insert Code Here
40574>>>>>    End_Procedure   // Backout
40575>>>>>
40575>>>>>    Procedure Delete_Main_File
40576>>>>>        //---------------------------------------------
40576>>>>>        // Auditing / Katagrafh allagon
40576>>>>>        String  sUser sText sTime sMin sHour sSec
40577>>>>>        Date    dDate  Shmer
40577>>>>>        Integer iMin iHour iSec iLen
40577>>>>>        Sysdate dDate iHour iMin iSec
40581>>>>>        Move iHour  to sHour
40582>>>>>        Move iMin   to sMin
40583>>>>>        Move iSec   to sSec
40584>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
40588>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
40592>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
40596>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
40597>>>>>
40597>>>>>        // Auditing / Diagrafh
40597>>>>>        If ((Sysfile.Use_Audit=1) And (Operation_Mode=MODE_DELETING) And (OPERATION_ORIGIN=Self)) Begin
40599>>>>>            Get fsLoginUserID to sUser
40600>>>>>            clear gmove
40601>>>>>            move syscurxr.company_code  to gmove.company_code
40602>>>>>            move syscurxr.branch_code   to gmove.branch_code
40603>>>>>            move syscurxr.year_year     to gmove.year_year
40604>>>>>            move  2                     to gmove.gtypkin_code// Apo Clients
40605>>>>>            move ddate                  to gmove.garticl_hmnia
40606>>>>>            move suser                  to gmove.gplan_code
40607>>>>>            move Clients.Client_Recr    to gmove.garticl_recr
40608>>>>>            reread sysrecg
40612>>>>>            move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
40613>>>>>            move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
40614>>>>>            saverecord sysrecg
40615>>>>>            unlock
40616>>>>>>
40616>>>>>            Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                to Gmove.Gmove_Recr
40617>>>>>            Move (Trim(sUser))                  to Gmove.Login_ID
40618>>>>>            Move dDate                          to Gmove.Hmnia_Metabolhs
40619>>>>>            Move sTime                          to Gmove.Ora_Metabolhs
40620>>>>>
40620>>>>>            Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
40621>>>>>            Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
40622>>>>>            Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
40623>>>>>            Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
40624>>>>>            Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
40625>>>>>            Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
40626>>>>>            Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
40627>>>>>
40627>>>>>
40627>>>>>            Move "ƒ ˜š¨˜­ã œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
40628>>>>>            Move "D"                            to Gmove.Eidos_Metabolhs
40629>>>>>            saverecord gmove
40630>>>>>        End
40630>>>>>>
40630>>>>>
40630>>>>>        Forward Send Delete_Main_File
40632>>>>>
40632>>>>>    End_Procedure
40633>>>>>
40633>>>>>
40633>>>>>    Procedure Update
40634>>>>>        Forward Send Update
40636>>>>>        // Insert Code Here
40636>>>>>        Move SysCurXR.Company_Code  to Clients.Company_Code
40637>>>>>        Move SysCurXR.Branch_Code   to Clients.Branch_Code
40638>>>>>        Move SysCurXR.Year_Year     to Clients.Year_Year
40639>>>>>        //Move Custprom.Custprom_Code to Clients.Custprom_Code
40639>>>>>        Move (Clients.Xreosh-Clients.Pistosh)   to Clients.Ypoloipo
40640>>>>>        Move (Clients.Plafon-Clients.Ypoloipo)  to Clients.Overhead
40641>>>>>
40641>>>>>        //Move Clients.Client_Address     to Clients.Client_LastUpd
40641>>>>>
40641>>>>>        //betolink
40641>>>>>        Move SysCurXR.Beto_Site      to Clients.Client_SiteW
40642>>>>>        Move Clients.Client_Rec0     to Clients.Client_SN
40643>>>>>        Move Clients.Client_id       to Clients.Client_Repm
40644>>>>>        Move Clients.Company_Code    to Clients.CLIENT_COMPANY
40645>>>>>        Move Clients.Client_id       to Clients.Client_RepMatch
40646>>>>>     //   Move (gsfCode_Mast('JOB',Clients.Client_CatJob)) to Clients.Client_Job
40646>>>>>
40646>>>>>        //---------------------------------------------
40646>>>>>        // Auditing / Katagrafh allagon
40646>>>>>        String  sUser sText sTime sMin sHour sSec
40647>>>>>        Date    dDate  Shmer
40647>>>>>        Integer iMin iHour iSec iLen
40647>>>>>        Sysdate dDate iHour iMin iSec
40651>>>>>        Move iHour  to sHour
40652>>>>>        Move iMin   to sMin
40653>>>>>        Move iSec   to sSec
40654>>>>>        If (Length(sHour)=1) Insert "0" in sHour at 1
40658>>>>>        If (Length(sMin )=1) Insert "0" in sMin  at 1
40662>>>>>        If (Length(sSec )=1) Insert "0" in sSec  at 1
40666>>>>>        Move (Trim(sHour)+":"+Trim(sMin)+"."+Trim(sSec)) to sTime
40667>>>>>
40667>>>>>        // Auditing / Dhmiourgia - Diorthosh
40667>>>>>        If ((Sysfile.Use_Audit=1)  And (Operation_ORIGIN=Self)) Begin
40669>>>>>            Get fsLoginUserID to sUser
40670>>>>>            If (piCreateNew(Self)=1) Begin
40672>>>>>                clear gmove
40673>>>>>                move syscurxr.company_code  to gmove.company_code
40674>>>>>                move syscurxr.branch_code   to gmove.branch_code
40675>>>>>                move syscurxr.year_year     to gmove.year_year
40676>>>>>                move  2                     to gmove.gtypkin_code// Apo Clients
40677>>>>>                move ddate                  to gmove.garticl_hmnia
40678>>>>>                move suser                  to gmove.gplan_code
40679>>>>>                move Clients.Client_Recr    to gmove.garticl_recr
40680>>>>>                reread sysrecg
40684>>>>>                move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
40685>>>>>                move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
40686>>>>>                saverecord sysrecg
40687>>>>>                unlock
40688>>>>>>
40688>>>>>                Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                    to Gmove.Gmove_Recr
40689>>>>>                Move (Trim(sUser))                  to Gmove.Login_ID
40690>>>>>                Move dDate                          to Gmove.Hmnia_Metabolhs
40691>>>>>                Move sTime                          to Gmove.Ora_Metabolhs
40692>>>>>                Move Clients.Client_ID              to Gmove.Cur_ID
40693>>>>>                Move Clients.CLient_Name            to Gmove.Cur_Name
40694>>>>>                Move Clients.Client_Recr            to Gmove.Partl_Recr
40695>>>>>                Move Clients.Client_Recr            to Gmove.Pms_Recr
40696>>>>>                Move Clients.Client_AFM             to Gmove.Cur_AFM
40697>>>>>                Move Clients.Client_DOY             to Gmove.Cur_DOY
40698>>>>>                Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
40699>>>>>                Move Clients.HPAL                   to Gmove.Prev_Stoxos1
40700>>>>>                Move Clients.HPSO                   to Gmove.Prev_Stoxos2
40701>>>>>                Move "ƒž£ ¦¬¨šå˜ ¤â¦¬ œ¢á«ž"       to Gmove.Gmove_Aitiol
40702>>>>>                Move "N" to Gmove.Eidos_Metabolhs
40703>>>>>                saverecord gmove
40704>>>>>                Set piCreateNew to 0
40705>>>>>            End
40705>>>>>>
40705>>>>>            Else If ((Operation_Mode=MODE_SAVING) And (piCreateNew(Self)<>1) And (OPERATION_ORIGIN=Self)) Begin
40708>>>>>                Integer isChanged
40708>>>>>                Move 0 to isChanged
40709>>>>>
40709>>>>>                     If (psAud_Old_Pelaths  (Self)<>Clients.Client_ID   ) Move 1 to isChanged
40712>>>>>                Else If (psAud_Old_PelathsN (Self)<>Clients.Client_Name ) Move 1 to isChanged
40716>>>>>                Else If (psAud_Old_AFM      (Self)<>Clients.Client_AFM  ) Move 1 to isChanged
40720>>>>>                Else If (psAud_Old_DOY      (Self)<>Clients.Client_DOY  ) Move 1 to isChanged
40724>>>>>                Else If (piAud_Old_HPAL     (Self)<>Clients.HPAL        ) Move 1 to isChanged
40728>>>>>                Else If (piAud_Old_HPSO     (Self)<>Clients.HPSO        ) Move 1 to isChanged
40732>>>>>
40732>>>>>                If (isChanged>0) Begin
40734>>>>>                    clear gmove
40735>>>>>                    move syscurxr.company_code  to gmove.company_code
40736>>>>>                    move syscurxr.branch_code   to gmove.branch_code
40737>>>>>                    move syscurxr.year_year     to gmove.year_year
40738>>>>>                    move  2                     to gmove.gtypkin_code// Apo Clients
40739>>>>>                    move ddate                  to gmove.garticl_hmnia
40740>>>>>                    move suser                  to gmove.gplan_code
40741>>>>>                    move Clients.Client_Recr    to gmove.garticl_recr
40742>>>>>                    reread sysrecg
40746>>>>>                    move (sysrecg.gmove_rec0+1) to sysrecg.gmove_rec0
40747>>>>>                    move (sysrecg.gmove_rec0+1) to gmove.gmove_rec0
40748>>>>>                    saverecord sysrecg
40749>>>>>                    unlock
40750>>>>>>
40750>>>>>                    Move (Append('',((Trim(SysCurxr.Branch_Site))+(Trim(String(Gmove.Gmove_Rec0)))))) ;                                                        to Gmove.Gmove_Recr
40751>>>>>                    Move (Trim(sUser))                  to Gmove.Login_ID
40752>>>>>                    Move dDate                          to Gmove.Hmnia_Metabolhs
40753>>>>>                    Move sTime                          to Gmove.Ora_Metabolhs
40754>>>>>                    Move Clients.Client_Recr            to Gmove.Partl_Recr
40755>>>>>                    Move Clients.Client_Recr            to Gmove.Pms_Recr
40756>>>>>                    //--
40756>>>>>                    Move Clients.Client_ID              to Gmove.Cur_ID
40757>>>>>                    Move Clients.CLient_Name            to Gmove.Cur_Name
40758>>>>>                    Move Clients.Client_AFM             to Gmove.Cur_AFM
40759>>>>>                    Move Clients.Client_DOY             to Gmove.Cur_DOY
40760>>>>>                    Move (gsfCode_Mast("DOY",Clients.Client_Doy)) to Gmove.Txt4
40761>>>>>                    Move Clients.HPAL                   to Gmove.Cur_Stoxos1
40762>>>>>                    Move Clients.HPSO                   to Gmove.Cur_Stoxos2
40763>>>>>                    //--
40763>>>>>                    Move (psAud_Old_Pelaths  (Self))    to Gmove.Prev_ID
40764>>>>>                    Move (psAud_Old_PelathsN (Self))    to Gmove.Prev_Name
40765>>>>>                    Move (psAud_Old_AFM      (Self))    to Gmove.Prev_AFM
40766>>>>>                    Move (psAud_Old_DOY      (Self))    to Gmove.Prev_Doy
40767>>>>>                    Move (psAud_Old_DOYN     (Self))    to Gmove.Txt3
40768>>>>>                    Move (piAud_Old_HPAL     (Self))    to Gmove.Prev_Stoxos1
40769>>>>>                    Move (piAud_Old_HPSO     (Self))    to Gmove.Prev_Stoxos2
40770>>>>>                    Move "ƒ æ¨Ÿà©ž œšš¨˜­ãª œ¢á«ž"     to gmove.gmove_aitiol
40771>>>>>                    Move "E"                            to Gmove.Eidos_Metabolhs
40772>>>>>                    saverecord gmove
40773>>>>>                    Set piCreateNew to 0
40774>>>>>                End
40774>>>>>>
40774>>>>>            End
40774>>>>>>
40774>>>>>        End
40774>>>>>>
40774>>>>>
40774>>>>>
40774>>>>>    End_Procedure   // Update
40775>>>>>
40775>>>>>
40775>>>>>    Procedure Creating
40776>>>>>        date ddate iYes
40777>>>>>        Forward Send Creating
40779>>>>>        // Insert Code Here
40779>>>>>
40779>>>>>        Move (Append('',((Trim(SysCurXR.Branch_Site))+;                          (Trim(String(Clients.Client_Rec0))))));                                    to Clients.Client_Recr
40780>>>>>        Move '1'                    to Clients.Client_Active
40781>>>>>        get fsgCode_With_Zeroes Clients.Client_Rec0 Sysfile.Client_Digits SysCurXr.Company_Code SysCurXr.Branch_Code  to Clients.Client_ID
40782>>>>>        sysdate4 ddate
40783>>>>>        move ddate                  to Clients.Client_Hmnia
40784>>>>>        Set piCreateNew to 1
40785>>>>>    End_Procedure   // Creating
40786>>>>>
40786>>>>>    Function Validate_Save  Returns Integer
40787>>>>>        Integer iReturnVal iCheck iYes
40788>>>>>        Forward Get Validate_Save  To iReturnVal
40790>>>>>        If (Not(iReturnVal)) Begin
40792>>>>>
40792>>>>>            If (clients.is_eksoter <> '1') begin
40794>>>>>                If (Clients.Is_Xondr='1') Begin
40796>>>>>                    If (Sysfile.Check_Afm=1) Begin
40798>>>>>                        Move (Check_AFM(Clients.Client_Afm)) to iCheck
40799>>>>>                        If (iCheck) Begin
40801>>>>>                                 If (iCheck=1) Move 4001 to iReturnVal
40804>>>>>                            Else If (iCheck=2) Move 4002 to iReturnVal
40808>>>>>                            Else If (iCheck=3) Move 4003 to iReturnVal
40812>>>>>                        End
40812>>>>>>
40812>>>>>                    End
40812>>>>>>
40812>>>>>                End
40812>>>>>>
40812>>>>>            End
40812>>>>>>
40812>>>>>
40812>>>>>            If (piCheckPlaf(Self)=1) Begin
40814>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Dap)>Clients.Plafon)) Begin
40816>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ˜¤¦ ®«¦ç Š¦š/£¦ç\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4000 Clients' to iYes
40817>>>>>                    If (iYes=MBR_NO) Error 4004 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž' //Move 4004 to iReturnVal
40820>>>>>                End
40820>>>>>>
40820>>>>>                Else If ((PayResp.Plafon<>0) And (PayResp.Plafon<=PayResp.Synolikh_Ofeilh)) Begin
40823>>>>>                    Get YesNo_Box 'Ž ¬§œçŸ¬¤¦ª §¢ž¨à£ãª ›œ¤ â®œ  › ˜Ÿâ© £ž §å©«à©ž\nŒ˜ ©¬¤œ®å©à ©«ž¤ ›ž£ ¦¬¨šå˜ œšš¨˜­ãª §œ¢á«ž;' to iYes
40824>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
40827>>>>>                End
40827>>>>>>
40827>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Clients.Orio_Syn_Ofeilh)) Begin
40830>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4001 Clients' to iYes
40831>>>>>                    If (iYes=MBR_NO) Error 4005 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'  //Move 4005 to iReturnVal
40834>>>>>                End
40834>>>>>>
40834>>>>>                Else If ((Clients.Orio_Syn_Ofeilh>0) And (PayResp.Orio_Syn_Ofeilh>0) And (Clients.Synolikh_Ofeilh>Payresp.Orio_Syn_Ofeilh)) Begin
40837>>>>>                    Get YesNo_Box 'Ž §œ¢á«žª â®œ  ¬§â¨™˜©ž ©¬¤¦¢ ¡ãª ¦­œ ¢ãª\nŒ˜ ©¬¤œ®å©à ;' '„§ ™œ™˜åà©ž 4002 Clients' to iYes
40838>>>>>                    If (iYes=MBR_NO) Error 4006 'DDC100: ƒ ˜¡¦§ã › ˜› ¡˜©å˜ª ˜§¦ «¦¤ ®¨ã©«ž'   //Move 4006 to iReturnVal
40841>>>>>                End
40841>>>>>>
40841>>>>>                If ((Clients.Plafon>0) And ((Clients.Ypoloipo+Clients.Posa_Apo_Parag)>Clients.Plafon)) Begin
40843>>>>>                    Send Info_Box '’˜ §¦©á «à¤ ž£œ¨ž©åà¤ §˜¨˜ššœ¢ é¤\n¬§œ¨™˜å¤¦¬¤ «¦ › ˜Ÿâ© £¦ ¬§æ¢¦ §¦\n™á©ž §¢˜­æ¤ «¦¬ §œ¢á«ž' '¨¦©¦®ã !!!'
40844>>>>>                End
40844>>>>>>
40844>>>>>            End
40844>>>>>>
40844>>>>>            
40844>>>>>            If (iReturnVal) Begin
40846>>>>>                Send Operation_Not_Allowed iReturnVal
40847>>>>>            End
40847>>>>>>
40847>>>>>        End
40847>>>>>>
40847>>>>>        Function_Return iReturnVal
40848>>>>>    End_Function   // Validate_Save
40849>>>>>
40849>>>>>
40849>>>>>    Procedure Operation_Not_Allowed Integer iError_Num
40850>>>>>        String lsError_Message
40851>>>>>
40851>>>>>        Case Begin
40851>>>>>            Case (iError_Num = 4001)
40853>>>>>                Move "DDC 100: Š˜¤Ÿ˜©£â¤¦ €”‹ œ¢á«ž" ;                    to lsError_Message
40854>>>>>              Case Break
40855>>>>>            Case (iError_Num = 4002)
40858>>>>>                Move "DDC 100: ’¦ €”‹ œ¢á«ž ›œ¤ œå¤˜  9 ¯ã­ ¦" ;                    to lsError_Message
40859>>>>>              Case Break
40860>>>>>            Case (iError_Num = 4003)
40863>>>>>                Move "DDC 100: €¡˜«á¢¢ž¢¦ª ®˜¨˜¡«ã¨˜ª ©«¦ €”‹ œ¢á«ž" ;                    to lsError_Message
40864>>>>>              Case Break
40865>>>>>            Case (iError_Num = 4004)
40868>>>>>                Move "DDC 100: ’¦ ©ç¤¦¢¦ (ƒ ˜Ÿâ© £¦ “§æ¢¦ §¦+¦©˜ ˜§¦ ƒ.€)\n¬§œ¨™˜å¤œ  «¦ §¢˜­æ¤ «¦¬ §œ¢á«ž" ;                    to lsError_Message
40869>>>>>              Case Break
40870>>>>>            Case (iError_Num = 4005)
40873>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª" ;                    to lsError_Message
40874>>>>>              Case Break
40875>>>>>            Case (iError_Num = 4006)
40878>>>>>                Move "DDC 100: † ©¬¤¦¢ ¡ã ¦­œ ¢ã ¬§œ¨™˜å¤œ \n«¦ æ¨ ¦ ©¬¤¦¢ ¡ãª ¦­œ ¢ãª «¦¬ “§œ¬Ÿç¤¦¬" ;                    to lsError_Message
40879>>>>>              Case Break
40880>>>>>
40880>>>>>            Case Else
40880>>>>>                Forward Send Operation_Not_Allowed iError_Num
40882>>>>>        Case End
40882>>>>>
40882>>>>>        Error iError_Num lsError_Message
40883>>>>>>
40883>>>>>    End_Procedure // operation_not_allowed
40884>>>>>
40884>>>>>
40884>>>>>    // Define_Fields:
40884>>>>>    // This procedure is used to set up all data-dictionary rules.
40884>>>>>
40884>>>>>    Procedure Define_Fields
40885>>>>>        Forward Send Define_Fields
40887>>>>>        //DDB-Generated-Code-Location
40887>>>>>        //DDB-DefineFieldStart
40887>>>>>
40887>>>>>        Set Main_File            To Clients.File_Number
40888>>>>>        Set Cascade_Delete_State To FALSE
40889>>>>>
40889>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
40890>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
40891>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
40892>>>>>
40892>>>>>        // Child (Client) file structure................
40892>>>>>        Send Add_Client_File  Cmoves.File_Number
40893>>>>>        Send Add_Client_File  Particle.File_Number
40894>>>>>        Send Add_Client_File  Cmovesa.File_Number
40895>>>>>        Send Add_Client_File  Cn.File_Number
40896>>>>>        Send Add_Client_File  Particll.File_Number
40897>>>>>        Send Add_Client_File  Clnbank.File_Number
40898>>>>>        Send Add_Client_File  Tpclient.File_Number
40899>>>>>        Send Add_Client_File  Clorder.File_Number
40900>>>>>        Send Add_Client_File  Clitem.File_Number
40901>>>>>
40901>>>>>        // Parent (Server) file structure...............
40901>>>>>        Send Add_Server_File  Cities.File_Number
40902>>>>>        Send Add_Server_File  Areas.File_Number
40903>>>>>        Send Add_Server_File  Payresp.File_Number
40904>>>>>
40904>>>>>        // External (System) file structure.............
40904>>>>>        Send Add_System_File  Syscurxr.File_Number  DD_LOCK_ON_ALL
40905>>>>>        Send Add_System_File  Sysrecc.File_Number  DD_LOCK_ON_ALL
40906>>>>>        Send Add_System_File  Ptypparl.File_Number  DD_LOCK_ON_ALL
40907>>>>>        Send Add_System_File  Gmove.File_Number  DD_LOCK_ON_ALL
40908>>>>>        Send Add_System_File  Sysrecg.File_Number  DD_LOCK_ON_ALL
40909>>>>>
40909>>>>>        Define_Auto_Increment  Sysrecc.Client_Rec0  To Clients.Client_Rec0
40912>>>>>
40912>>>>>        // Field-based properties.......................
40912>>>>>
40912>>>>>        // Clients.Company_Code
40912>>>>>
40912>>>>>        // Clients.Branch_Code
40912>>>>>
40912>>>>>        // Clients.Year_Year
40912>>>>>
40912>>>>>        // Clients.Custprom_Code
40912>>>>>
40912>>>>>        // Clients.Client_Id
40912>>>>>        Set Field_Options          Field Clients.Client_Id To DD_AUTOFIND    DD_NOPUT      
40913>>>>>        Set Field_Prompt_Object    Field Clients.Client_Id To (sl100(Self))
40914>>>>>        Set Key_Field_State        Field Clients.Client_Id To TRUE
40915>>>>>
40915>>>>>        // Clients.Client_Name
40915>>>>>        Set Field_Prompt_Object    Field Clients.Client_Name To (sl100(Self))
40916>>>>>
40916>>>>>        // Clients.Client_Afm
40916>>>>>        Set Field_Options          Field Clients.Client_Afm To DD_AUTOFIND   
40917>>>>>
40917>>>>>        // Clients.Client_Rec0
40917>>>>>        Set Field_Options          Field Clients.Client_Rec0 To DD_AUTOFIND   
40918>>>>>
40918>>>>>        // Clients.Custprom_Recr
40918>>>>>
40918>>>>>        // Clients.Client_Recr
40918>>>>>        Set Field_Options          Field Clients.Client_Recr To DD_AUTOFIND   
40919>>>>>
40919>>>>>        // Clients.Last_Xreosh
40919>>>>>
40919>>>>>        // Clients.Last_Pistosh
40919>>>>>
40919>>>>>        // Clients.Last_Order
40919>>>>>        Set Field_Class_Name       Field Clients.Last_Order To "dbComboFormSub"
40920>>>>>
40920>>>>>        // Clients.Client_Doy
40920>>>>>        Set Field_Value_Table      Field Clients.Client_Doy To (Clients_Client_Doy_VT(Self))
40921>>>>>
40921>>>>>        // Clients.Client_Address
40921>>>>>
40921>>>>>        // Clients.Client_City_Id
40921>>>>>
40921>>>>>        // Clients.Client_Area
40921>>>>>
40921>>>>>        // Clients.Client_Job
40921>>>>>        Set Field_Value_Table      Field Clients.Client_Job To (Clients_Client_Job_VT(Self))
40922>>>>>
40922>>>>>        // Clients.Client_Respons
40922>>>>>
40922>>>>>        // Clients.Client_Zipcode
40922>>>>>
40922>>>>>        // Clients.Client_Phone
40922>>>>>
40922>>>>>        // Clients.Client_Fax
40922>>>>>
40922>>>>>        // Clients.Client_Mobile
40922>>>>>
40922>>>>>        // Clients.Client_Aoh
40922>>>>>
40922>>>>>        // Clients.Client_Email
40922>>>>>
40922>>>>>        // Clients.Client_Class
40922>>>>>
40922>>>>>        // Clients.Client_Details
40922>>>>>
40922>>>>>        // Clients.Client_Sitew
40922>>>>>
40922>>>>>        // Clients.Client_Codem
40922>>>>>
40922>>>>>        // Clients.Client_Categfpa
40922>>>>>        Set Field_Value_Table      Field Clients.Client_Categfpa To (Clients_Client_Categfpa_VT(Self))
40923>>>>>
40923>>>>>        // Clients.Client_Fpa
40923>>>>>
40923>>>>>        // Clients.Client_Public
40923>>>>>
40923>>>>>        // Clients.Client_Sn
40923>>>>>
40923>>>>>        // Clients.Client_Repm
40923>>>>>
40923>>>>>        // Clients.Client_Active
40923>>>>>
40923>>>>>        // Clients.Client_Reported
40923>>>>>
40923>>>>>        // Clients.Client_Pelprom
40923>>>>>
40923>>>>>        // Clients.Client_Lastupd
40923>>>>>
40923>>>>>        // Clients.Client_Markexp
40923>>>>>
40923>>>>>        // Clients.Client_Catjob
40923>>>>>        Set Field_Value_Table      Field Clients.Client_Catjob To (Clients_Client_Catjob_VT1(Self))
40924>>>>>
40924>>>>>        // Clients.Is_Promhtheyths
40924>>>>>
40924>>>>>        // Clients.Xreosh
40924>>>>>
40924>>>>>        // Clients.Pistosh
40924>>>>>
40924>>>>>        // Clients.Ypoloipo
40924>>>>>
40924>>>>>        // Clients.Plafon
40924>>>>>
40924>>>>>        // Clients.Overhead
40924>>>>>
40924>>>>>        // Clients.Client_Company
40924>>>>>
40924>>>>>        // Clients.Client_Repmatch
40924>>>>>
40924>>>>>        // Clients.Client_Hmnia
40924>>>>>
40924>>>>>        // Clients.Client_Presp
40924>>>>>
40924>>>>>        // Clients.Client_Locked
40924>>>>>
40924>>>>>        // Clients.Synolikh_Ofeilh
40924>>>>>
40924>>>>>        // Clients.Client_Idiot
40924>>>>>        Set Field_Value_Table      Field Clients.Client_Idiot To (Clients_Client_Idiot_VT(Self))
40925>>>>>
40925>>>>>        // Clients.Client_Add_No
40925>>>>>
40925>>>>>        // Clients.Client_Nomos
40925>>>>>
40925>>>>>        // Clients.Client_Xora
40925>>>>>
40925>>>>>        // Clients.Polh_Recr
40925>>>>>        Set Field_Prompt_Object    Field Clients.Polh_Recr To (slPayTerms(Self))
40926>>>>>
40926>>>>>        // Clients.Presp_Id
40926>>>>>
40926>>>>>        // Clients.Sum_Pct_Tpcl
40926>>>>>
40926>>>>>        // Clients.Is_Client
40926>>>>>
40926>>>>>        // Clients.Sysxetish
40926>>>>>
40926>>>>>        // Clients.Poso_Se_Apait
40926>>>>>
40926>>>>>        // Clients.Client_Glcode
40926>>>>>
40926>>>>>        // Clients.Is_Eksoter
40926>>>>>
40926>>>>>        // Clients.Is_Xondr
40926>>>>>
40926>>>>>        // Clients.Orio_Syn_Ofeilh
40926>>>>>
40926>>>>>        // Clients.Posa_Apo_Dap
40926>>>>>
40926>>>>>        // Clients.Client_Doybtm
40926>>>>>
40926>>>>>        // Clients.Posa_Apo_Parag
40926>>>>>
40926>>>>>        // Clients.Client_Ptyppar
40926>>>>>
40926>>>>>        // Clients.Client_Seira
40926>>>>>
40926>>>>>        // Clients.Hpso
40926>>>>>
40926>>>>>        // Clients.Hpal
40926>>>>>
40926>>>>>        // Clients.Feregios
40926>>>>>        Set Field_Value_Table      Field Clients.Feregios To (Clients_Feregios_VT(Self))
40927>>>>>
40927>>>>>        // Clients.Diakin
40927>>>>>
40927>>>>>        // Clients.Status
40927>>>>>
40927>>>>>        // Clients.Anal
40927>>>>>
40927>>>>>        // Clients.Endoomil
40927>>>>>
40927>>>>>        // Clients.Npdd
40927>>>>>
40927>>>>>        // Clients.Sap_Hmnia
40927>>>>>
40927>>>>>        //DDB-DefineFieldEnd
40927>>>>>    End_Procedure    // Define_Fields
40928>>>>>
40928>>>>>    // Field_Defaults:
40928>>>>>    // This procedure is used to establish default field values.
40928>>>>>
40928>>>>>    Procedure Field_Defaults
40929>>>>>        Forward Send Field_Defaults
40931>>>>>        //DDB-Generated-Code-Location
40931>>>>>        //DDB-FieldDefaultStart
40931>>>>>        Set Field_Changed_Value   Field Clients.Client_Doy To "0"
40932>>>>>        //DDB-FieldDefaultEnd
40932>>>>>    End_Procedure    // Field_Defaults
40933>>>>>
40933>>>>>End_Class    // Clients_DataDictionary
40934>>>>>//DDB-Selection-pkg-Start
40934>>>>>
40934>>>>>Use sl100.SL         // sl100
INCLUDING FILE: SL100.SL
40934>>>>>>>//AB/ Project SL100:PELATES
40934>>>>>>>//AB/     Object prj is a Lookup_Project
40934>>>>>>>//AB/         Set ProjectName to "SL100:PELATES"
40934>>>>>>>//AB/         Set ProjectFileName to "SL100.SL"
40934>>>>>>>
40934>>>>>>>// Project Object Structure
40934>>>>>>>//   sl100 is a dbModalPanelSub
40934>>>>>>>//     Clients_DD is a DataDictionary
40934>>>>>>>//     oSelList is a dbListSub
40934>>>>>>>//     oOK_bn is a ButtonSub
40934>>>>>>>//     oCancel_bn is a ButtonSub
40934>>>>>>>//     oSearch_bn is a ButtonSub
40934>>>>>>>
40934>>>>>>>// Register all objects
40934>>>>>>>Register_Object Clients_DD
40934>>>>>>>Register_Object oCancel_bn
40934>>>>>>>Register_Object oOK_bn
40934>>>>>>>Register_Object oSearch_bn
40934>>>>>>>Register_Object oSelList
40934>>>>>>>Register_Object sl100
40934>>>>>>>
40934>>>>>>>
40934>>>>>>>    //AB-IgnoreStart
40934>>>>>>>
40934>>>>>>>    Use DFAllEnt.pkg
40934>>>>>>>    Use dbList.Sub
40934>>>>>>>    Use Button.Sub
40934>>>>>>>
40934>>>>>>>
40934>>>>>>>    Use CLIENTS.DD
40934>>>>>>>    
40934>>>>>>>    //AB-IgnoreEnd
40934>>>>>>>
40934>>>>>>>    Object sl100 is a dbModalPanelSub
40936>>>>>>>
40936>>>>>>>        //AB-StoreTopStart
40936>>>>>>>                
40936>>>>>>>        Property String     FragmaClient        Public ''
40938>>>>>>>        Property String     psIsPromhtheyths    Public ''
40940>>>>>>>        Property Integer    piMustConstrain     Public  0
40942>>>>>>>        Property String     psModule            Public ''
40944>>>>>>>        
40944>>>>>>>        //AB-StoreTopEnd
40944>>>>>>>
40944>>>>>>>        Set Label to "(Xlate(Label(Self)))"
40945>>>>>>>        Set Size to 252 509
40946>>>>>>>        Set Location to 4 5
40947>>>>>>>
40947>>>>>>>        //AB-DDOStart
40947>>>>>>>
40947>>>>>>>        Object Clients_DD is a Clients_DataDictionary
40949>>>>>>>
40949>>>>>>>            //AB-StoreTopStart
40949>>>>>>>                                                        
40949>>>>>>>            //AB-StoreTopEnd
40949>>>>>>>
40949>>>>>>>
40949>>>>>>>            //AB-StoreStart
40949>>>>>>>                                                        
40949>>>>>>>            Begin_Constraints
40951>>>>>>>                     If (psModule(Self)='01') BEGIN
40953>>>>>>>                        Constrain Clients.is_Client        Eq '1'
40955>>>>>>>                     end
40955>>>>>>>>
40955>>>>>>>                     Else If (psModule(Self)='02') begin
40958>>>>>>>                        Constrain Clients.is_Promhtheyths  Eq '1'
40960>>>>>>>                     end
40960>>>>>>>>
40960>>>>>>>            End_Constraints
40963>>>>>>>            
40963>>>>>>>            
40963>>>>>>>            
40963>>>>>>>            
40963>>>>>>>            
40963>>>>>>>            //AB-StoreEnd
40963>>>>>>>
40963>>>>>>>        End_Object    // Clients_DD
40964>>>>>>>
40964>>>>>>>        Set Main_DD to (Clients_DD(self))
40965>>>>>>>        Set Server to (Clients_DD(self))
40966>>>>>>>
40966>>>>>>>        //AB-DDOEnd
40966>>>>>>>
40966>>>>>>>        Object oSelList is a dbListSub
40968>>>>>>>            Set Main_File to Clients.File_Number
40969>>>>>>>            Set Size to 204 496
40970>>>>>>>            Set Location to 7 5
40971>>>>>>>            Set Auto_Index_State to FALSE
40972>>>>>>>
40972>>>>>>>            Begin_Row
40975>>>>>>>                Entry_Item Clients.Client_id
40976>>>>>>>                Entry_Item Clients.Client_name
40977>>>>>>>                Entry_Item Clients.Client_afm
40978>>>>>>>                Entry_Item Clients.Last_xreosh
40979>>>>>>>                Entry_Item Clients.Last_pistosh
40980>>>>>>>                Entry_Item Clients.Client_codem
40981>>>>>>>                Entry_Item Clients.Is_client
40982>>>>>>>                Entry_Item Clients.Is_promhtheyths
40983>>>>>>>            End_Row
40988>>>>>>>
40988>>>>>>>            Set Form_Width    item 0 to 64
40989>>>>>>>            Set Header_Label  item 0 to "‰à› ¡æª"
40990>>>>>>>            
40990>>>>>>>            Set Form_Width    item 1 to 133
40991>>>>>>>            Set Header_Label  item 1 to "„§à¤¬£å˜"
40992>>>>>>>            
40992>>>>>>>            Set Form_Width    item 2 to 62
40993>>>>>>>            Set Header_Label  item 2 to "€”‹"
40994>>>>>>>            
40994>>>>>>>            Set Form_Width    item 3 to 60
40995>>>>>>>            Set Header_Label  item 3 to "’œ¢. •¨âà©ž"
40996>>>>>>>            
40996>>>>>>>            Set Form_Width    item 4 to 60
40997>>>>>>>            Set Header_Label  item 4 to "’œ¢. å©«à©ž"
40998>>>>>>>            
40998>>>>>>>            Set Form_Width    item 5 to 59
40999>>>>>>>            Set Header_Label  item 5 to "‰à›.‘ç¤›œ©žª"
41000>>>>>>>            
41000>>>>>>>            Set Form_Width    item 6 to 26
41001>>>>>>>            Set Header_Label  item 6 to "œ¢"
41002>>>>>>>            Set Column_Checkbox_State  item 6 to True
41003>>>>>>>            
41003>>>>>>>            Set Form_Width    item 7 to 26
41004>>>>>>>            Set Header_Label  item 7 to "¨¦£"
41005>>>>>>>            Set Column_Checkbox_State  item 7 to True
41006>>>>>>>            
41006>>>>>>>
41006>>>>>>>            //AB-StoreStart
41006>>>>>>>                                                                                
41006>>>>>>>            //Property String StoreFragmaClient   Public ''
41006>>>>>>>            //Property String StorePsModule       Public ''
41006>>>>>>>            
41006>>>>>>>            //Procedure Store_Defaults
41006>>>>>>>            //    Forward Send Store_Defaults
41006>>>>>>>            //    Set StoreFragmaClient   to (FragmaClient(Self))
41006>>>>>>>            //    Set StorePsModule       to (psModule    (Self))
41006>>>>>>>            //End_Procedure
41006>>>>>>>            
41006>>>>>>>            //Procedure ReStore_Defaults
41006>>>>>>>            //    Forward Send ReStore_Defaults
41006>>>>>>>            //    Set FragmaClient to (StoreFragmaClient(Self))
41006>>>>>>>            //    Set psModule     to (StorePsModule    (Self))
41006>>>>>>>            //End_Procedure
41006>>>>>>>            
41006>>>>>>>            Set Column_Option Item 6 to NoEnter True
41007>>>>>>>            Set Column_Option Item 7 to NoEnter True
41008>>>>>>>            
41008>>>>>>>            Procedure Activating
41010>>>>>>>                Forward Send Activating
41012>>>>>>>                Set Auto_Index_State to True
41013>>>>>>>            End_Procedure
41014>>>>>>>            
41014>>>>>>>            Procedure Activate
41016>>>>>>>                Send Rebuild_Constraints    to Clients_DD
41017>>>>>>>                If (FragmaClient(Self)<>'') Begin
41019>>>>>>>                    Clear Clients
41020>>>>>>>                    Move (FragmaClient(Self)) to Clients.Client_ID
41021>>>>>>>                    Find Eq Clients By Index.6
41022>>>>>>>>
41022>>>>>>>                    If (Found) Send Request_Find to Clients_DD Eq Clients.File_Number 6
41025>>>>>>>                End
41025>>>>>>>>
41025>>>>>>>                Forward Send Activate
41027>>>>>>>            End_procedure
41028>>>>>>>            
41028>>>>>>>            
41028>>>>>>>            
41028>>>>>>>            
41028>>>>>>>            //AB-StoreEnd
41028>>>>>>>
41028>>>>>>>        End_Object    // oSelList
41029>>>>>>>
41029>>>>>>>        Object oOK_bn is a ButtonSub
41031>>>>>>>            Set Label to "&„§ ¢¦šã"
41032>>>>>>>            Set Location to 218 341
41033>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41034>>>>>>>
41034>>>>>>>            //AB-StoreStart
41034>>>>>>>            Procedure OnClick
41036>>>>>>>                Send OK To (oSelList(current_object))
41037>>>>>>>            End_Procedure
41038>>>>>>>            //AB-StoreEnd
41038>>>>>>>
41038>>>>>>>        End_Object    // oOK_bn
41039>>>>>>>
41039>>>>>>>        Object oCancel_bn is a ButtonSub
41041>>>>>>>            Set Label to "&€¡ç¨à©ž"
41042>>>>>>>            Set Location to 218 396
41043>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41044>>>>>>>
41044>>>>>>>            //AB-StoreStart
41044>>>>>>>            Procedure OnClick
41046>>>>>>>                Send Cancel To (oSelList(current_object))
41047>>>>>>>            End_Procedure
41048>>>>>>>            //AB-StoreEnd
41048>>>>>>>
41048>>>>>>>        End_Object    // oCancel_bn
41049>>>>>>>
41049>>>>>>>        Object oSearch_bn is a ButtonSub
41051>>>>>>>            Set Label to "€&¤˜ã«ž©ž..."
41052>>>>>>>            Set Location to 218 451
41053>>>>>>>            Set Form_TypeFace Item 0 to "MS Sans Serif"
41054>>>>>>>
41054>>>>>>>            //AB-StoreStart
41054>>>>>>>            Procedure OnClick
41056>>>>>>>                Send Search To (oSelList(current_object))
41057>>>>>>>            End_Procedure
41058>>>>>>>            //AB-StoreEnd
41058>>>>>>>
41058>>>>>>>        End_Object    // oSearch_bn
41059>>>>>>>
41059>>>>>>>
41059>>>>>>>        //AB-StoreStart
41059>>>>>>>                
41059>>>>>>>        On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41060>>>>>>>        On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41061>>>>>>>        On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41062>>>>>>>        
41062>>>>>>>        Set Modal_State to True
41063>>>>>>>        Set Locate_Mode to Center_On_Screen
41064>>>>>>>        
41064>>>>>>>        
41064>>>>>>>        Procedure Activating Returns Integer
41066>>>>>>>            Integer rVal
41067>>>>>>>            Forward Get Msg_Activating to rVal
41069>>>>>>>                 if (psmodule(self)='01') set label of sl100 to '‰˜«á¢¦š¦ª œ¢˜«é¤'
41072>>>>>>>            else if (psmodule(self)='02') set label of sl100 to '‰˜«á¢¦š¦ª ¨¦£žŸœ¬«é¤'
41076>>>>>>>            Procedure_Return rVal
41077>>>>>>>        End_procedure
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        
41078>>>>>>>        //AB-StoreEnd
41078>>>>>>>
41078>>>>>>>    End_Object    // sl100
41079>>>>>>>
41079>>>>>>>//AB/     End_Object    // prj
41079>>>>>Use slPayTerms.SL    // slPayTerms
INCLUDING FILE: SLPAYTERMS.SL
41079>>>>>>>//AB/ Project slPayTerms
41079>>>>>>>//AB/ Object prj is a Lookup_Project
41079>>>>>>>//AB/     Set ProjectName to "slPayTerms"
41079>>>>>>>//AB/     Set ProjectFileName to "slPayTerms.SL"
41079>>>>>>>
41079>>>>>>>// Project Object Structure
41079>>>>>>>//   slPayTerms is a dbModalPanelSub
41079>>>>>>>//     PayTerms_DD is a DataDictionary
41079>>>>>>>//     oSelList is a dbListSub
41079>>>>>>>//     oOK_bn is a ButtonSub
41079>>>>>>>//     oCancel_bn is a ButtonSub
41079>>>>>>>//     oSearch_bn is a ButtonSub
41079>>>>>>>
41079>>>>>>>// Register all objects
41079>>>>>>>Register_Object oCancel_bn
41079>>>>>>>Register_Object oOK_bn
41079>>>>>>>Register_Object oSearch_bn
41079>>>>>>>Register_Object oSelList
41079>>>>>>>Register_Object PayTerms_DD
41079>>>>>>>Register_Object slPayTerms
41079>>>>>>>
41079>>>>>>>
41079>>>>>>>//AB-IgnoreStart
41079>>>>>>>
41079>>>>>>>Use DFAllEnt.pkg
41079>>>>>>>Use dbList.Sub
41079>>>>>>>Use Button.Sub
41079>>>>>>>
41079>>>>>>>
41079>>>>>>>Use PAYTERMS.DD
INCLUDING FILE: PAYTERMS.DD
41079>>>>>>>>>//DDB-FileStart
41079>>>>>>>>>//DDB-HeaderStart
41079>>>>>>>>>
41079>>>>>>>>>// File Name : PAYTERMS.DD
41079>>>>>>>>>// Class Name: Payterms_DataDictionary
41079>>>>>>>>>// Revision  : 2
41079>>>>>>>>>// Version   : 2
41079>>>>>>>>>
41079>>>>>>>>>Use  Windows           // Basic Definitions
41079>>>>>>>>>Use  DataDict          // DataDictionary Class Definition
41079>>>>>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41079>>>>>>>>>
41079>>>>>>>>>Open Payterms
INCLUDING FILE: PAYTERMS.FD
41081>>>>>>>>>
41081>>>>>>>>>//DDB-HeaderEnd
41081>>>>>>>>>//DDB-SelectionStart
41081>>>>>>>>>//DDB/ ExternalSelectionList slPayTerms  slPayTerms.SL
41081>>>>>>>>>Register_Object slPayTerms
41081>>>>>>>>>//DDB-SelectionEnd
41081>>>>>>>>>
41081>>>>>>>>>Class Payterms_DataDictionary  is a DataDictionary_sec
41082>>>>>>>>>
41082>>>>>>>>>    // Define_Fields:
41082>>>>>>>>>    // This procedure is used to set up all data-dictionary rules.
41082>>>>>>>>>
41082>>>>>>>>>    Procedure Define_Fields
41083>>>>>>>>>        Forward Send Define_Fields
41085>>>>>>>>>        //DDB-Generated-Code-Location
41085>>>>>>>>>        //DDB-DefineFieldStart
41085>>>>>>>>>
41085>>>>>>>>>        Set Main_File            To Payterms.File_Number
41086>>>>>>>>>
41086>>>>>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41087>>>>>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41088>>>>>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41089>>>>>>>>>
41089>>>>>>>>>        // Field-based properties.......................
41089>>>>>>>>>
41089>>>>>>>>>        // Payterms.Payterms_Code
41089>>>>>>>>>        Set Field_Options          Field Payterms.Payterms_Code To DD_AUTOFIND   
41090>>>>>>>>>        Set Field_Prompt_Object    Field Payterms.Payterms_Code To (slPayTerms(Self))
41091>>>>>>>>>
41091>>>>>>>>>        // Payterms.Payterms_Descr
41091>>>>>>>>>
41091>>>>>>>>>        // Payterms.Old_Description
41091>>>>>>>>>
41091>>>>>>>>>        //DDB-DefineFieldEnd
41091>>>>>>>>>    End_Procedure    // Define_Fields
41092>>>>>>>>>
41092>>>>>>>>>    // Field_Defaults:
41092>>>>>>>>>    // This procedure is used to establish default field values.
41092>>>>>>>>>
41092>>>>>>>>>    Procedure Field_Defaults
41093>>>>>>>>>        Forward Send Field_Defaults
41095>>>>>>>>>        //DDB-Generated-Code-Location
41095>>>>>>>>>        //DDB-FieldDefaultStart
41095>>>>>>>>>        //DDB-FieldDefaultEnd
41095>>>>>>>>>    End_Procedure    // Field_Defaults
41096>>>>>>>>>
41096>>>>>>>>>End_Class    // Payterms_DataDictionary
41097>>>>>>>>>//DDB-Selection-pkg-Start
41097>>>>>>>>>
41097>>>>>>>>>Use slPayTerms.SL    // slPayTerms
41097>>>>>>>>>
41097>>>>>>>>>//DDB-Selection-pkg-End
41097>>>>>>>>>//DDB-FileEnd
41097>>>>>>>
41097>>>>>>>//AB-IgnoreEnd
41097>>>>>>>
41097>>>>>>>Object slPayTerms is a dbModalPanelSub
41099>>>>>>>    Set Label to "î¨¦  ¢ž¨à£ãª"
41100>>>>>>>    Set Size to 223 461
41101>>>>>>>    Set Location to 7 15
41102>>>>>>>
41102>>>>>>>    //AB-DDOStart
41102>>>>>>>
41102>>>>>>>    Object PayTerms_DD is a Payterms_DataDictionary
41104>>>>>>>    End_Object    // PayTerms_DD
41105>>>>>>>
41105>>>>>>>    Set Main_DD to (PayTerms_DD(self))
41106>>>>>>>    Set Server to (PayTerms_DD(self))
41107>>>>>>>
41107>>>>>>>    //AB-DDOEnd
41107>>>>>>>
41107>>>>>>>    Object oSelList is a dbListSub
41109>>>>>>>        Set Main_File to Payterms.File_Number
41110>>>>>>>        Set Size to 181 445
41111>>>>>>>        Set Location to 6 6
41112>>>>>>>        Set Auto_Server_State to TRUE
41113>>>>>>>
41113>>>>>>>        Begin_Row
41116>>>>>>>            Entry_Item Payterms.Payterms_code
41117>>>>>>>            Entry_Item Payterms.Payterms_descr
41118>>>>>>>            Entry_Item Payterms.Old_description
41119>>>>>>>        End_Row
41124>>>>>>>
41124>>>>>>>        Set Form_Width    item 0 to 67
41125>>>>>>>        Set Header_Label  item 0 to "‰à› ¡æª"
41126>>>>>>>        
41126>>>>>>>        Set Form_Width    item 1 to 209
41127>>>>>>>        Set Header_Label  item 1 to "œ¨ š¨˜­ã"
41128>>>>>>>        
41128>>>>>>>        Set Form_Width    item 2 to 163
41129>>>>>>>        Set Header_Label  item 2 to "˜¢˜ á œ¨ š¨˜­ã"
41130>>>>>>>        
41130>>>>>>>    End_Object    // oSelList
41131>>>>>>>
41131>>>>>>>    Object oOK_bn is a ButtonSub
41133>>>>>>>        Set Label to "&„§ ¢¦šã"
41134>>>>>>>        Set Location to 191 293
41135>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41136>>>>>>>
41136>>>>>>>        //AB-StoreStart
41136>>>>>>>        Procedure OnClick
41138>>>>>>>            Send OK To (oSelList(current_object))
41139>>>>>>>        End_Procedure
41140>>>>>>>        //AB-StoreEnd
41140>>>>>>>
41140>>>>>>>    End_Object    // oOK_bn
41141>>>>>>>
41141>>>>>>>    Object oCancel_bn is a ButtonSub
41143>>>>>>>        Set Label to "&€¡ç¨à©ž"
41144>>>>>>>        Set Location to 191 347
41145>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41146>>>>>>>
41146>>>>>>>        //AB-StoreStart
41146>>>>>>>        Procedure OnClick
41148>>>>>>>            Send Cancel To (oSelList(current_object))
41149>>>>>>>        End_Procedure
41150>>>>>>>        //AB-StoreEnd
41150>>>>>>>
41150>>>>>>>    End_Object    // oCancel_bn
41151>>>>>>>
41151>>>>>>>    Object oSearch_bn is a ButtonSub
41153>>>>>>>        Set Label to "€&¤˜ã«ž©ž..."
41154>>>>>>>        Set Location to 191 403
41155>>>>>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41156>>>>>>>
41156>>>>>>>        //AB-StoreStart
41156>>>>>>>        Procedure OnClick
41158>>>>>>>            Send Search To (oSelList(current_object))
41159>>>>>>>        End_Procedure
41160>>>>>>>        //AB-StoreEnd
41160>>>>>>>
41160>>>>>>>    End_Object    // oSearch_bn
41161>>>>>>>
41161>>>>>>>
41161>>>>>>>    //AB-StoreStart
41161>>>>>>>    On_Key Key_Alt+Key_E Send KeyAction To (oOk_bn(current_object))
41162>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction To (oCancel_bn(current_object))
41163>>>>>>>    On_Key Key_Alt+Key_N Send KeyAction To (oSearch_bn(current_object))
41164>>>>>>>    //AB-StoreEnd
41164>>>>>>>
41164>>>>>>>End_Object    // slPayTerms
41165>>>>>>>
41165>>>>>>>//AB/ End_Object    // prj
41165>>>>>
41165>>>>>//DDB-Selection-pkg-End
41165>>>>>//DDB-FileEnd
41165>>>Use TEMPITEL.DD
INCLUDING FILE: TEMPITEL.DD
41165>>>>>//DDB-FileStart
41165>>>>>//DDB-HeaderStart
41165>>>>>
41165>>>>>// File Name : TEMPITEL.DD
41165>>>>>// Class Name: Tempitel_DataDictionary
41165>>>>>// Revision  : 0
41165>>>>>// Version   : 2
41165>>>>>
41165>>>>>Use  Windows           // Basic Definitions
41165>>>>>Use  DataDict          // DataDictionary Class Definition
41165>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41165>>>>>
41165>>>>>Open Tempitel
INCLUDING FILE: TEMPITEL.FD
41167>>>>>
41167>>>>>//DDB-HeaderEnd
41167>>>>>open Tempitem
INCLUDING FILE: TEMPITEM.FD
41169>>>>>
41169>>>>>Set_attribute  DF_FILE_ALIAS of Tempitel.File_number to DF_FILE_IS_ALIAS
41172>>>>>Set_attribute  DF_FILE_ALIAS of Tempitem.File_number  to DF_FILE_IS_MASTER
41175>>>>>
41175>>>>>Class Tempitel_DataDictionary  is a DataDictionary_sec
41176>>>>>
41176>>>>>    // Define_Fields:
41176>>>>>    // This procedure is used to set up all data-dictionary rules.
41176>>>>>
41176>>>>>    Procedure Define_Fields
41177>>>>>        Forward Send Define_Fields
41179>>>>>        //DDB-Generated-Code-Location
41179>>>>>        //DDB-DefineFieldStart
41179>>>>>
41179>>>>>        Set Main_File            To Tempitel.File_Number
41180>>>>>
41180>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41181>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41182>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41183>>>>>
41183>>>>>        // Field-based properties.......................
41183>>>>>
41183>>>>>        // Tempitel.Company_Code
41183>>>>>
41183>>>>>        // Tempitel.Branch_Code
41183>>>>>
41183>>>>>        // Tempitel.Year_Year
41183>>>>>
41183>>>>>        // Tempitel.Item_Code
41183>>>>>
41183>>>>>        // Tempitel.Witemx_Code
41183>>>>>
41183>>>>>        // Tempitel.Wax_Recr
41183>>>>>
41183>>>>>        // Tempitel.Wcmove_Axia
41183>>>>>
41183>>>>>        // Tempitel.Wcmove_Status_E
41183>>>>>
41183>>>>>        // Tempitel.Wcmove_Qty
41183>>>>>
41183>>>>>        // Tempitel.Wcmove_Qty_Exa
41183>>>>>
41183>>>>>        // Tempitel.Wcmove_Qty_Eisa
41183>>>>>
41183>>>>>        // Tempitel.Client_Id
41183>>>>>
41183>>>>>        //DDB-DefineFieldEnd
41183>>>>>    End_Procedure    // Define_Fields
41184>>>>>
41184>>>>>    // Field_Defaults:
41184>>>>>    // This procedure is used to establish default field values.
41184>>>>>
41184>>>>>    Procedure Field_Defaults
41185>>>>>        Forward Send Field_Defaults
41187>>>>>        //DDB-Generated-Code-Location
41187>>>>>        //DDB-FieldDefaultStart
41187>>>>>        //DDB-FieldDefaultEnd
41187>>>>>    End_Procedure    // Field_Defaults
41188>>>>>
41188>>>>>End_Class    // Tempitel_DataDictionary
41189>>>>>//DDB-FileEnd
41189>>>Use Tempitem.DD
INCLUDING FILE: TEMPITEM.DD
41189>>>>>//DDB-FileStart
41189>>>>>//DDB-HeaderStart
41189>>>>>
41189>>>>>// File Name : Tempitem.DD
41189>>>>>// Class Name: Tempitem_DataDictionary
41189>>>>>// Revision  : 0
41189>>>>>// Version   : 2
41189>>>>>
41189>>>>>Use  Windows           // Basic Definitions
41189>>>>>Use  DataDict          // DataDictionary Class Definition
41189>>>>>Use  DDvalTbl          // Validation Table Class Definitions
41189>>>>>
41189>>>>>Open Tempitem
41191>>>>>
41191>>>>>//DDB-HeaderEnd
41191>>>>>
41191>>>>>Class Tempitem_DataDictionary  is a DataDictionary_sec
41192>>>>>
41192>>>>>    // Define_Fields:
41192>>>>>    // This procedure is used to set up all data-dictionary rules.
41192>>>>>
41192>>>>>    Procedure Define_Fields
41193>>>>>        Forward Send Define_Fields
41195>>>>>        //DDB-Generated-Code-Location
41195>>>>>        //DDB-DefineFieldStart
41195>>>>>
41195>>>>>        Set Main_File            To Tempitem.File_Number
41196>>>>>
41196>>>>>        Set Foreign_Field_Options  DD_KEYFIELD   To DD_AUTOFIND    DD_NOPUT       DD_FINDREQ    
41197>>>>>        Set Foreign_Field_Options  DD_INDEXFIELD To DD_NOPUT       DD_FINDREQ    
41198>>>>>        Set Foreign_Field_Options  DD_DEFAULT    To DD_DISPLAYONLY
41199>>>>>
41199>>>>>        // Field-based properties.......................
41199>>>>>
41199>>>>>        // Tempitem.Company_Code
41199>>>>>
41199>>>>>        // Tempitem.Branch_Code
41199>>>>>
41199>>>>>        // Tempitem.Year_Year
41199>>>>>
41199>>>>>        // Tempitem.Item_Code
41199>>>>>
41199>>>>>        // Tempitem.Witemx_Code
41199>>>>>
41199>>>>>        // Tempitem.Wax_Recr
41199>>>>>
41199>>>>>        // Tempitem.Wcmove_Axia
41199>>>>>
41199>>>>>        // Tempitem.Wcmove_Status_E
41199>>>>>
41199>>>>>        // Tempitem.Wcmove_Qty
41199>>>>>
41199>>>>>        // Tempitem.Wcmove_Qty_Exa
41199>>>>>
41199>>>>>        // Tempitem.Wcmove_Qty_Eisa
41199>>>>>
41199>>>>>        // Tempitem.Client_Id
41199>>>>>
41199>>>>>        //DDB-DefineFieldEnd
41199>>>>>    End_Procedure    // Define_Fields
41200>>>>>
41200>>>>>    // Field_Defaults:
41200>>>>>    // This procedure is used to establish default field values.
41200>>>>>
41200>>>>>    Procedure Field_Defaults
41201>>>>>        Forward Send Field_Defaults
41203>>>>>        //DDB-Generated-Code-Location
41203>>>>>        //DDB-FieldDefaultStart
41203>>>>>        //DDB-FieldDefaultEnd
41203>>>>>    End_Procedure    // Field_Defaults
41204>>>>>
41204>>>>>End_Class    // Tempitem_DataDictionary
41205>>>>>//DDB-FileEnd
41205>>>
41205>>>//AB-IgnoreEnd
41205>>>
41205>>>ACTIVATE_VIEW Activate_Vsapdomikh FOR Vsapdomikh
41208>>>
41208>>>Object Vsapdomikh is a dbViewSubs
41210>>>
41210>>>    //AB-StoreTopStart
41210>>>
41210>>>    Property Integer piLathi    Public 0
41212>>>    property integer piepil     public 0
41214>>>    Property Integer piSfalma   Public 0
41216>>>
41216>>>    Register_Object oDirectoryPicker
41216>>>
41216>>>    Function Check_Afm_Local String Afm_Num Returns Integer
41218>>>        Integer iii Num1 Num2
41219>>>
41219>>>        Move (Trim(Afm_Num)) To Afm_Num
41220>>>
41220>>>        For iii From 1 To (Length(Trim(Afm_Num)))
41226>>>>
41226>>>            If Not (Mid(Afm_Num,1,iii)) In  "0123456789" Function_Return 3
41229>>>        Loop
41230>>>>
41230>>>
41230>>>        Move (Right(Afm_Num,1)) to Num2
41231>>>
41231>>>        If (Length(Afm_Num)<>9) Function_Return 2
41234>>>
41234>>>        Move 0 to Num1
41235>>>
41235>>>        For iii From 1 to 8
41241>>>>
41241>>>            Add ((Mid(Afm_Num,1,iii)) * (2 ^ (9 - iii))) to Num1
41242>>>        Loop
41243>>>>
41243>>>
41243>>>        Move (Mod(Num1,11)) to Num1
41244>>>        If (Num1=10) Move 0 to Num1
41247>>>
41247>>>        If (Num1=Num2)  Function_Return 0
41250>>>        Else            Function_Return 1
41252>>>    End_Function
41253>>>
41253>>>    Function Validate_AFM String asAFM String asPel Returns Integer
41255>>>        Integer rVal iCheck
41256>>>        // Elegxos gia sosto AFM
41256>>>        Move (Check_AFM(asAFM)) to iCheck
41257>>>        If (iCheck=1) Begin
41259>>>            Set piLathi to (piLathi(Self)+1)
41260>>>            Write   Channel 7 '’¦ €”‹ «¦¬ '
41262>>>            Write   Channel 7 (Trim(asPel)+' ')
41264>>>            Write   Channel 7 'œå¤˜  ¢˜¤Ÿ˜©£â¤¦'
41266>>>            Writeln Channel 7
41268>>>            Function_Return 0
41269>>>        End
41269>>>>
41269>>>        Else If (iCheck=2) Begin
41272>>>            Set piLathi to (piLathi(Self)+1)
41273>>>            Write   Channel 7 '’¦ €”‹ «¦¬ '
41275>>>            Write   Channel 7 (Trim(asPel)+' ')
41277>>>            Writeln Channel 7 '›œ¤ œå¤˜  9 ¯ã­ ¦'
41280>>>            Function_Return 0
41281>>>        End
41281>>>>
41281>>>        Else If (iCheck=3) Begin
41284>>>            Set piLathi to (piLathi(Self)+1)
41285>>>            Write   Channel 7 '’¦ €”‹ «¦¬ '
41287>>>            Write   Channel 7 (Trim(asPel)+' ')
41289>>>            Writeln Channel 7 '§œ¨ â®œ  £ž ˜§¦›œ¡«¦çª ®˜¨˜¡«ã¨œª'
41292>>>            Function_Return 0
41293>>>        End
41293>>>>
41293>>>        Function_Return 1
41294>>>    End_Function
41295>>>
41295>>>    //AB-StoreTopEnd
41295>>>
41295>>>    Set Label to "„¥˜šàšã €¨®œåà¤ š ˜ šâ­¬¨œª £œ SAP (Dom)"
41296>>>    Set Size to 245 405
41297>>>    Set Location to 2 7
41298>>>
41298>>>    //AB-DDOStart
41298>>>
41298>>>    Object Clients_DD is a Clients_DataDictionary
41300>>>
41300>>>        //AB-StoreStart
41300>>>
41300>>>        //AB-StoreEnd
41300>>>
41300>>>    End_Object    // Clients_DD
41301>>>
41301>>>    Object Tempitel_DD is a Tempitel_DataDictionary
41303>>>    End_Object    // Tempitel_DD
41304>>>
41304>>>    Object Tempitem_DD is a Tempitem_DataDictionary
41306>>>    End_Object    // Tempitem_DD
41307>>>
41307>>>    Set Main_DD to (Clients_DD(self))
41308>>>    Set Server to (Clients_DD(self))
41309>>>
41309>>>    //AB-DDOEnd
41309>>>
41309>>>    Object frmapo is a FormSub
41311>>>        Set Size to 13 61
41312>>>        Set Location to 15 178
41313>>>        Set Label_Col_Offset to 2
41314>>>        Set Form_Datatype Item 0 to Mask_Date_Window
41315>>>        Set Prompt_Button_Mode to pb_PromptOn
41316>>>        Set Form_Mask Item 0 to "dd/MM/yyyy"
41317>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41318>>>
41318>>>        //AB-StoreStart
41318>>>        set prompt_object to (ocalendar(self))
41319>>>
41319>>>        //AB-StoreEnd
41319>>>
41319>>>    End_Object    // frmapo
41320>>>
41320>>>    Object RadioGroupSub1 is a RadioGroupSub
41322>>>        Set Size to 105 367
41323>>>        Set Location to 33 11
41324>>>        Object Radio1 is a RadioSub
41326>>>            Set Label to "„¡«ç§à©ž  €¨®œå¦¬ œ¢˜«é¤"
41327>>>            Set Size to 10 116
41328>>>            Set Location to 10 5
41329>>>            Set TextColor to clRed
41330>>>        End_Object    // Radio1
41331>>>
41331>>>        Object Radio3 is a RadioSub
41333>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ „ ©§¨á¥œà¤ œ¢˜«é¤"
41334>>>            Set Size to 10 152
41335>>>            Set Location to 24 5
41336>>>        End_Object    // Radio3
41337>>>
41337>>>        Object RadioSub1 is a RadioSub
41339>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ à¢ã©œà¤ œ¢˜«é¤"
41340>>>            Set Size to 10 169
41341>>>            Set Location to 38 5
41342>>>            Set Auto_Size_State to FALSE
41343>>>        End_Object    // RadioSub1
41344>>>
41344>>>        Object RadioSub4 is a RadioSub
41346>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ ‰ ¤ã©œà¤ €§¦Ÿã¡žª"
41347>>>            Set Size to 10 169
41348>>>            Set Location to 52 5
41349>>>            Set Auto_Size_State to FALSE
41350>>>
41350>>>            //AB-StoreStart
41350>>>
41350>>>
41350>>>
41350>>>            //AB-StoreEnd
41350>>>
41350>>>        End_Object    // RadioSub4
41351>>>
41351>>>        Object RadioSub5 is a RadioSub
41353>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ ’œ®¤.¨¦› ˜š¨˜­é¤"
41354>>>            Set Size to 10 169
41355>>>            Set Location to 64 5
41356>>>            Set Auto_Size_State to FALSE
41357>>>
41357>>>            //AB-StoreStart
41357>>>
41357>>>
41357>>>
41357>>>            //AB-StoreEnd
41357>>>
41357>>>        End_Object    // RadioSub5
41358>>>
41358>>>        Object RadioSub6 is a RadioSub
41360>>>            Set Label to "„¡«ç§à©ž €¨®œå¦¬ ‰˜«˜¤˜¢é©œà¤"
41361>>>            Set Size to 10 169
41362>>>            Set Location to 78 5
41363>>>            Set Auto_Size_State to FALSE
41364>>>
41364>>>            //AB-StoreStart
41364>>>
41364>>>
41364>>>            //AB-StoreEnd
41364>>>
41364>>>        End_Object    // RadioSub6
41365>>>
41365>>>        Object Radio7 is a RadioSub
41367>>>            Set Label to "„¡«ç§à©ž  œ¢˜«é¤ £œ ŠáŸ¦ª €.”.‹"
41368>>>            Set Size to 12 147
41369>>>            Set Location to 91 5
41370>>>            Set TextColor to clRed
41371>>>        End_Object    // Radio7
41372>>>
41372>>>
41372>>>        //AB-StoreStart
41372>>>
41372>>>        Procedure Notify_Select_State integer inewItem integer ioldItem
41374>>>            local integer licount
41375>>>            Forward Send Notify_Select_State  iNewItem  iOldItem
41377>>>            Set piEpil to (iNewItem+1)
41378>>>        End_Procedure
41379>>>
41379>>>
41379>>>        //AB-StoreEnd
41379>>>
41379>>>    End_Object    // RadioGroupSub1
41380>>>
41380>>>    Object btnMetasx is a ButtonSub
41382>>>
41382>>>        //AB-StoreTopStart
41382>>>
41382>>>        //AB-StoreTopEnd
41382>>>
41382>>>        Set Label to "‹œ«˜©®ž£˜« ©£æª ‘œ ˜¨˜ššœ¢åœª ¨¦£žŸœ¬«é¤"
41383>>>        Set Bitmap to "AGGEL.BMP"
41384>>>        Set Size to 20 22
41385>>>        Set Location to 145 11
41386>>>        Set Focus_Mode to Pointer_Only
41387>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
41388>>>
41388>>>        //AB-StoreStart
41388>>>
41388>>>        Set TooltipValue to "„§œ¥œ¨š˜©å˜ „šš¨˜­é¤"
41389>>>
41389>>>        Procedure Deixe_Ta_Lathi
41391>>>            Integer liLathi
41392>>>            Set piLathi to 0
41393>>>            send Delete_Data to (EditSub1(Keimeno(Self)))
41394>>>            send read to (EditSub1(Keimeno(Self))) 'C:\SapAFM.txt'
41395>>>            Send popup to (Keimeno(Self))
41396>>>        End_Procedure
41397>>>
41397>>>        Procedure OnClick
41399>>>            Set Label Of frmShow to ''
41400>>>            integer libpo05 listatus retval irecnum  ibpoid ierr  iok iYes
41401>>>            string msgstr wrecr edate mdate ename mname scodem srecr sdescr  spar sPassw
41401>>>            date dapod
41401>>>            integer iepil
41401>>>
41401>>>        // -----------------------------------------------------------------------------------------------------
41401>>>        // -----------------------------------------------------------------------------------------------------
41401>>>        // Prosthiki 25/06/2013 Xrhsh tou pediou Company.Company_FAX
41401>>>        // An einai 1 (kai mono 1) tote o elegxos parakamptetai,
41401>>>        // gi' ayto edo eite bazoume passw kai proxoraei eite mplokaroume
41401>>>        // epeidh to flag mporei na exei xexastei 'anoixto'
41401>>>        // -----------------------------------------------------------------------------------------------------
41401>>>            Clear Company
41402>>>            Move SyscurXr.Company_Code to Company.Company_Code
41403>>>            Find Eq Company By Index.1
41404>>>>
41404>>>            If (Trim(Company.Company_FAX)='1') Begin
41406>>>                Set Visible_State Of frmPassw to True
41407>>>                Set Enabled_State Of frmPassw to True
41408>>>                Get Value Of frmPassw Item 0 to sPassw
41409>>>                If (sPassw<>'05091960') Begin
41411>>>                    Send Stop_Box "˜¨˜¡˜¢é œ§ ¡¦ ¤à¤ã©«œ £œ «ž¤ ƒ œçŸ¬¤©ž ¢ž¨¦­¦¨ ¡ãª\n›é©«œ ¡à› ¡æ ¢áŸ¦¬ª - 777 - ©« ª šâ­¬¨œª SAP" "‘­á¢£˜ 777"
41412>>>                    Procedure_Return
41413>>>                End
41413>>>>
41413>>>            End
41413>>>>
41413>>>            Set Value           Of frmPassw Item 0  to ""
41414>>>            Set Visible_State   Of frmPassw         to False
41415>>>            Set Enabled_State   Of frmPassw         to False
41416>>>        // -----------------------------------------------------------------------------------------------------
41416>>>        // -----------------------------------------------------------------------------------------------------
41416>>>
41416>>>
41416>>>            Indicate Err False
41417>>>            Set piLathi to 0
41418>>>
41418>>>            get piepil to iepil
41419>>>            get value of frmapo to dapod
41420>>>            REREAD SYSFILE
41424>>>            unlock
41425>>>>
41425>>>            indicate err false
41426>>>            If (dapod='') Begin
41428>>>                Send Info_Box '† ž£œ¨¦£ž¤å˜ „šš¨˜­é¤ œå¤˜  ¡œ¤ã' '¢ž¨¦­¦¨å˜'
41429>>>                Send Activate to frmApo
41430>>>                Procedure_Return
41431>>>            End
41431>>>>
41431>>>            Clear tmpSap
41432>>>            Move dapod to tmpSap.Date
41433>>>            Find Eq tmpSap By Index.1
41434>>>>
41434>>>            If ((Found) And (tmpSap.Kleidomeno=1)) begin
41436>>>                send info_box '† †£/¤å˜ €¬«ã œå¤˜  ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
41437>>>                procedure_return
41438>>>            end
41438>>>>
41438>>>            Get fiSapOK Of vwSap dapod to iOK
41439>>>            If (iOK<>0) Begin
41441>>>                If (iOK=1)      Send Info_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '¢ž¨¦­¦¨å˜'
41444>>>                Else If (iOK=2) Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜¬«ã œå¤˜  ã›ž ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
41448>>>                Else If (iOK=3) Send Info_Box '¨¦¡ç§«œ  ¡œ¤æ ž£œ¨¦£ž¤ é¤.\n‰á§¦ ˜ §¨¦žš¦ç£œ¤ž ƒ„Œ â«¨œ¥œ' '¢ž¨¦­¦¨å˜'
41452>>>                Else If (iOK=4) Send Info_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜' '¢ž¨¦­¦¨å˜'
41456>>>                procedure_return
41457>>>            end
41457>>>>
41457>>>
41457>>>            Get YesNo_Box '€¨®åœ  ž „§œ¥œ¨š˜©å˜ „šš¨˜­é¤ !!\nŒ˜ ©¬¤œ®å©à ??' to RetVal
41458>>>            If (RetVal =MBR_yes) begin
41460>>>                Zerofile TmpclSap
41461>>>                Zerofile TmpAxio
41462>>>                Zerofile Tmppol
41463>>>                Zerofile Tmpapoth
41464>>>                Zerofile Tmptehn
41465>>>                Zerofile Tmpanal
41466>>>
41466>>>                begin_transaction
41467>>>
41467>>>                    Send enhmerose_axio
41468>>>                    Send Enhmerose_polhseis
41469>>>                    Send enhmerose_apoth
41470>>>                    Send enhmerose_itemtehn
41471>>>                    Send enhmerose_anal
41472>>>
41472>>>                    //----
41472>>>                    // 08/12/2014 Den peirazoume pia tis hmeromhnies aytes
41472>>>                    // Eipe o Thanassis apla na elegxoume ta 3 kyklomata
41472>>>                    // Timologhsh, Axiografa kai Diakinhseis na mhn kataxoreitai
41472>>>                    // tipota me hmnia progenesterh h idia me thn tel hmnia SAP
41472>>>                    //----
41472>>>                    //Send Kleise_Hmeromhnies dapod
41472>>>                    //----
41472>>>
41472>>>                    Set piLathi to 0
41473>>>                    Direct_Output Channel 7 'C:\SapAFM.txt'
41475>>>                    Send Ftiakse_Pelates
41476>>>                    Close_Output Channel 7
41478>>>
41478>>>                    If (piLathi(Self)<>0) Begin
41480>>>                        Send Deixe_Ta_Lathi
41481>>>                        Get YesNo_Box '“§ã¨¥˜¤ ¢˜¤Ÿ˜©£â¤˜ €”‹.\€¤ ©¬¤œ®å©à, «˜ €”‹ ˜¬«á Ÿ˜ §œ¨á©¦¬¤ £œ ‹ž›œ¤ ¡á ©«¦ SAP.\nŒ˜ ©¬¤œ®å©à ?' to iYes
41482>>>                        If (iYes=MBR_NO) Begin
41484>>>                            Move MBR_NO to RetVal
41485>>>                            //Abort_Transaction
41485>>>                        End
41485>>>>
41485>>>                    End
41485>>>>
41485>>>                    If (RetVal=MBR_YES) Begin
41487>>>                    End
41487>>>>
41487>>>                // ’œ©«á¨¦¬£œ «¦ fi2 š ˜ §œ¨ ««âª œšš¨˜­âª «¨æ£§˜ª
41487>>>
41487>>>               end_transaction
41488>>>               Unlock
41489>>>>
41489>>>
41489>>>                Close_Output Channel 7
41491>>>                send check_the_records
41492>>>            end
41492>>>>
41492>>>            If (RetVal=MBR_NO) Begin
41494>>>                send info_box 'ƒ ˜› ¡˜©å˜ €¡¬¨éŸž¡œ ˜§¦ «¦¤ •¨ã©«ž' '¢ž¨¦­¦¨å˜'
41495>>>                Procedure_Return
41496>>>            End
41496>>>>
41496>>>            if ((not(err)) And (RetVal=MBR_YES)) begin
41498>>>                Move "„¤ž£â¨à©ž €¨®œåà¤ ¦¢¦¡¢ž¨éŸž¡œ"  to MsgStr
41499>>>                Send Info_Box MsgStr
41500>>>            end
41500>>>>
41500>>>            else begin
41501>>>                 Move "† › ˜› ¡˜©å˜ ›œ¤ ¦¢¦¡¢ž¨éŸž¡œ ©à©«á" to MsgStr
41502>>>                 Send Info_Box MsgStr
41503>>>            end
41503>>>>
41503>>>        End_Procedure // OnClick
41504>>>
41504>>>
41504>>>        //        Procedure Kleise_Hmeromhnies Date adHmnia
41504>>>        //            String sComp sBranch
41504>>>        //            clear Branch
41504>>>        //            move SysCurXR.Company_Code to Branch.Company_Code
41504>>>        //            Find GE Branch By Index.1
41504>>>        //            While ((Found) And (Branch.Company_Code=SysCurXR.Company_Code))
41504>>>        //                Reread Branch
41504>>>        //                If (Branch.Date_Locked   <=adHmnia) Move adHmnia to Branch.Date_Locked
41504>>>        //                If (Branch.Last_Hmnia_Ekt<=adHmnia) Move adHmnia to Branch.Last_Hmnia_Ekt
41504>>>        //                Saverecord branch
41504>>>        //                Unlock
41504>>>        //                Find GT Branch By Index.1
41504>>>        //            Loop
41504>>>        //        End_Procedure
41504>>>
41504>>>        Procedure Ftiakse_Pelates
41506>>>             string srecr scode sstr stomeas
41507>>>             integer Imet Ikod isok Inum
41507>>>
41507>>>             move Sysfile.Client_Digits to Ikod
41508>>>             add 3 to ikod // gia na paroyme kai to AX ektos tomea
41509>>>             clear Company
41510>>>             move syscurxr.company_code to Company.company_code
41511>>>             find eq company by index.1
41512>>>>
41512>>>             move Company.company_c_code0 to stomeas
41513>>>             clear clients
41514>>>             set piLathi to 0
41515>>>             move 0 to imet
41516>>>             move syscurxr.company_code to clients.company_code
41517>>>             find gt clients by index.11
41518>>>>
41518>>>             while ((found) and (clients.sap_hmnia=''))
41522>>>                IF ((syscurxr.company_code=clients.company_code) and;                                (clients.status <'2')) BEGIN
41524>>>                    IF (clients.client_fpa=1) goto next_clientsd
41527>>>                    clear TmpclSap
41528>>>                    move 'FI1'                              to TmpclSap.onoma
41529>>>                    move '01'                               to TmpclSap.typos
41530>>>                    if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpclsap.etairia
41533>>>                    else move 'idy1'                        to Tmpclsap.etairia
41535>>>                    clear branch
41536>>>                    move syscurxr.company_code to branch.company_code
41537>>>                    move syscurxr.branch_code  to branch.branch_code
41538>>>                    find eq branch by index.1
41539>>>>
41539>>>                    move branch.PERIOXH    to TmpclSap.branch_site
41540>>>             //       move stomeas                            to TmpclSap.branch_site
41540>>>                         if (clients.status='' ) move '0'   to TmpclSap.type
41543>>>                    else if (clients.status='1') move '1'   to TmpclSap.type
41547>>>
41547>>>                    move (trim(clients.client_id))          to Tmpclsap.oldcode
41548>>>                    move (trim(clients.client_id))          to scode
41549>>>                    Move (Right(scode, Ikod))               To scode
41550>>>                    move (replaces('.',scode,'')) to scode
41551>>>                    insert '01' in scode at 1
41553>>>                    if (Sysfile.Client_Digits<6);                        insert '0' in scode at 5
41557>>>                    move (trim(scode))                      to TmpclSap.code
41558>>>                    if (sysrecw.wmoves_rec0=1) move 'MB01'  to TmpclSap.group
ERROR: 54 Invalid symbol in expression SYSRECW.WMOVES_REC0 ON LINE: 532 (41558) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41561>>>                    else move 'MB00'                        to TmpclSap.group
41563>>>                    if (clients.endoomil='1');                         move 'CSTIT'  to Tmpclsap.endoomil
41566>>>                    else;                         move ''       to Tmpclsap.endoomil
41568>>>
41568>>>                    if (clients.is_xondr='1')     move '1'      to Tmpclsap.anal
41571>>>                    else                          move '2'      to Tmpclsap.anal
41573>>>                    If (sysfile.company_name='1') move '1'      to Tmpclsap.anal
41576>>>
41576>>>                         if (clients.npdd         ='1') move 'B4'   to Tmpclsap.category
41579>>>                    else if (clients.custprom_code='1') move 'B3'   to Tmpclsap.category
41583>>>                    else if (clients.is_xondr     ='1') move 'B1'   to Tmpclsap.category
41587>>>                    else                                move 'B2'   to Tmpclsap.category
41589>>>                    move clients.client_afm                         to Tmpclsap.afm
41590>>>                    Get Validate_Afm tmpCLSAP.AFM tmpCLSAP.oldcode  to isOk
41591>>>                    If (isOK=0) Move '000000000'                    to Tmpclsap.afm
41594>>>
41594>>>                    clear Codemast
41595>>>                    move 'DOY' to   codemast.type
41596>>>                    move clients.client_doy to codemast.code
41597>>>                    find eq codemast by index.1
41598>>>>
41598>>>                    move (trim(codemast.description))       to Tmpclsap.doy
41599>>>                    move (trim(clients.client_name))        to Tmpclsap.name
41600>>>                    clear Codemast
41601>>>                    move 'JOB' to codemast.type
41602>>>                    move clients.client_job to codemast.code
41603>>>                    find eq codemast by index.1
41604>>>>
41604>>>                    move (trim(codemast.description))       to Tmpclsap.occup
41605>>>                    clear cities
41606>>>                    move clients.client_city_id to cities.city_id
41607>>>                    find eq cities by index.1
41608>>>>
41608>>>                    move (trim(cities.city_descr))          to Tmpclsap.city
41609>>>                    move (trim(clients.client_address))     to sstr
41610>>>                    move (replaces('  ',sStr,'')) to sStr
41611>>>                    move (trim(sStr)) to Tmpclsap.address
41612>>>                    move (trim(clients.client_add_no))      to Tmpclsap.add_no
41613>>>                    move (trim(clients.client_zipcode))     to Tmpclsap.zipcode
41614>>>
41614>>>                    If (length(trim(tmpclsap.zipcode))<>5) Move '00000' to Tmpclsap.zipcode
41617>>>                    move (trim(clients.client_phone))       to Tmpclsap.telfax
41618>>>                    move 'GR'                               to Tmpclsap.country
41619>>>                    move 'EL'                               TO Tmpclsap.language
41620>>>
41620>>>                    // 02/10/2012 Prosthiki Oron Plhromhs
41620>>>                    Move (Trim(Clients.Polh_Recr))          to Tmpclsap.Tropoi_Plhromhs
41621>>>
41621>>>
41621>>>                    saverecord Tmpclsap
41622>>>                    add 1 to Imet
41623>>>                    Set Label Of frmShow to ('œ¢á«œª' + '-' + String(iMet)+'-'+String(scode))
41624>>>                END
41624>>>>
41624>>>                next_clientsd:
41624>>>                find gt clients by index.11
41625>>>>
41625>>>            Loop
41626>>>>
41626>>>            clear TmpclSap
41627>>>            move 'FI1'                              to TmpclSap.onoma
41628>>>            move 90                                 to TmpclSap.typos
41629>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpclsap.etairia
41632>>>            else move 'idy1'                        to Tmpclsap.etairia
41634>>>            move stomeas                            to TmpclSap.branch_site
41635>>>            move Imet                               to Tmpclsap.afm
41636>>>            move 'GR'                               to Tmpclsap.country
41637>>>            move 'EL'                               to Tmpclsap.language
41638>>>            saverecord Tmpclsap
41639>>>        End_Procedure
41640>>>
41640>>>        Procedure enhmerose_axio
41642>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo stomeas  sarxikos safmarx
41643>>>             integer Imet Ikod ienhsap isChecked
41643>>>             number nmetrhta nepitages nsynal nembasma nposo nHmeras
41643>>>             date dapod ddate dkenhdate
41643>>>             string soroi sclient msgstr sclientid lsTheAppPath
41643>>>             get value of frmapo to dapod
41644>>>             move '01/01/2005' to ddate
41645>>>             move '01/01/1753' to dkenhdate
41646>>>             move Sysfile.Client_Digits to Ikod
41647>>>             add 3 to ikod // gia na paroyme kai to AX ektos yomea
41648>>>
41648>>>             clear Company
41649>>>             move syscurxr.company_code to Company.company_code
41650>>>             find eq company by index.1
41651>>>>
41651>>>             move Company.company_c_code0 to stomeas
41652>>>
41652>>>             clear cmoves
41653>>>             find gt cmoves by 16
41654>>>>
41654>>>             while ((found) and (cmoves.sap_hmnia=''))
41658>>>                move '' to sclientid
41659>>>                move 0 to ienhsap
41660>>>                if  (cmoves.cmoves_hmnia  > dapod);                    goto nextcmovesd
41663>>>                if (cmoves.barticl_recr='');                    goto nextcmovesd
41666>>>                if (syscurxr.company_code<>cmoves.company_code);                    goto nextcmovesd
41669>>>
41669>>>                //gts 03-12-07 ‰ ¤ã©œ ª §¦¬ œå¤˜  locked ¡˜  ž ž£/¤å˜ «žª ¡å¤ž©žª œ ©§¨á¥œà¤ => «žª ž£/¤å˜ª
41669>>>                //¡¢œ ›é£˜«¦ª §¨â§œ  ¤˜ §¨¦©§œ¨¤ ¦ç¤«œ
41669>>>                if (cmoves.barticl_recr<>'') begin
41671>>>                    clear barticl
INCLUDING FILE: BARTICL.FD
41672>>>                    move cmoves.barticl_recr to barticl.barticl_recr
41673>>>                    find eq barticl by index.2
41674>>>>
41674>>>                    if (found) begin
41676>>>                        If (barticl.ekkremes=1) goto nextcmovesd
41679>>>                        relate barticl
41680>>>                        if (btypkin.locked=1) begin
41682>>>                            if (btypkin.locked_date<>'');                                if (cmoves.cmoves_hmnia ge btypkin.locked_date);                                    goto nextcmovesd
41687>>>                        End
41687>>>>
41687>>>                    end
41687>>>>
41687>>>                End
41687>>>>
41687>>>                clear branch
41688>>>                move Cmoves.company_code    to branch.company_code
41689>>>                move cmoves.branch_code     to branch.branch_code
41690>>>                find eq branch by index.1
41691>>>>
41691>>>                move branch.PERIOXH         to sperioxh
41692>>>                move branch.egkatastash     to segkatastash
41693>>>
41693>>>                clear TmpAxio
41694>>>                move 'FI3'                              to Tmpaxio.onoma
41695>>>                move '01'                               to Tmpaxio.typos
41696>>>                if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
41699>>>                else move 'idy1'                        to Tmpaxio.etairia
41701>>>                move sPERIOXH                           to Tmpaxio.perioxh
41702>>>                move segkatastash                       to Tmpaxio.egkatastash
41703>>>                move segkatastash                       to Tmpaxio.tomeas
41704>>>
41704>>>                relate cmoves
41705>>>                if (clients.is_xondr='1');                     move '01' to Tmpaxio.anal
41708>>>                else;                     move '02' to Tmpaxio.anal
41710>>>            //    If (sysfile.company_name='1') move '01'      to Tmpaxio.anal
41710>>>                if ((clients.status='') and (clients.sap_hmnia<=ddate)) begin
41712>>>                    move 1 to ienhsap
41713>>>                    move cmoves.client_id to sclientid
41714>>>                    if (clients.client_ptyppar='') begin
41716>>>                       move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå §˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž = ' to msgstr
41717>>>                       append msgstr clients.client_id
41718>>>                       error 3330 msgstr
41719>>>>
41719>>>                    end
41719>>>>
41719>>>                    if (clients.client_ptyppar='100') begin
41721>>>                            move '' to msgstr
41722>>>                            if (clients.is_xondr<>'1') begin
41724>>>                                move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
41725>>>                                append msgstr clients.client_id
41726>>>                                error 3333 msgstr
41727>>>>
41727>>>                            end
41727>>>>
41727>>>                    end
41727>>>>
41727>>>                    else begin
41728>>>                            if (clients.client_ptyppar<>'113') begin
41730>>>                                move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
41731>>>                                append msgstr clients.client_id
41732>>>                                error 3334 msgstr
41733>>>>
41733>>>                            end
41733>>>>
41733>>>                    end
41733>>>>
41733>>>                end
41733>>>>
41733>>>
41733>>>                move (trim(ctypkin.sub))                to stype
ERROR: 54 Invalid symbol in expression CTYPKIN.SUB ON LINE: 692 (41733) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41734>>>                if (stype='');                    goto nextcmovesd
41737>>>                insert 'B' in stype at 1
41739>>>                move (trim(stype))                      to Tmpaxio.type
41740>>>
41740>>>                clear bmove
41741>>>                move cmoves.custprom_code to bmove.bmove_recr
41742>>>                find eq bmove by index.2
41743>>>>
41743>>>                Relate Bmove
41744>>>                move 'O' to sstr
41745>>>                Move (Append(sstr,(barticl.arith_orist)))  to sstr
41746>>>                move sstr                               to Tmpaxio.arithmos
41747>>>                move cmoves.cmoves_hmnia                to Tmpaxio.hmnia
41748>>>                move '' to sper
41749>>>                clear cflagkin
41750>>>                move cmoves.ctypkin_code to cflagkin.ctypkin_code
41751>>>                find gt cflagkin by index.1
41752>>>>
41752>>>                while ((found) and (cmoves.ctypkin_code=cflagkin.ctypkin_code))
41756>>>                         if (trim(cflagkin.cflagkin_flag)='91') move '1' to sper
41759>>>                    else if (trim(cflagkin.cflagkin_flag)='92') move '2' to sper
41763>>>                    else if (trim(cflagkin.cflagkin_flag)='93') move '3' to sper
41767>>>                    else if (trim(cflagkin.cflagkin_flag)='94') move '4' to sper
41771>>>                    else if (trim(cflagkin.cflagkin_flag)='95') move '5' to sper
41775>>>                    find gt cflagkin by index.1
41776>>>>
41776>>>                Loop
41777>>>>
41777>>>                move (trim(sper))                            to Tmpaxio.perigrafh
41778>>>                     if (sper='1') add cmoves.cmoves_axia    to nmetrhta
41781>>>                else if (sper='2') add cmoves.cmoves_axia    to nepitages
41785>>>                else if (sper='3') add cmoves.cmoves_axia    to nsynal
41789>>>                else if (sper='4') add cmoves.cmoves_axia    to nembasma
41793>>>                else if (sper='5') add cmoves.cmoves_axia    to nHmeras
41797>>>                move cmoves.cmoves_axia                      to Tmpaxio.axia
41798>>>
41798>>>                //gts 13-03-08
41798>>>                // ©ç¤¦¢˜ ˜¤á œš¡˜«á©«˜©ž
41798>>>
41798>>>                move (trim(cmoves.client_id))           to scode
41799>>>                Move (Right(scode, Ikod))               To scode
41800>>>                move (replaces('.',scode,'')) to scode
41801>>>                insert '01' in scode at 1
41803>>>                if (Sysfile.Client_Digits<6);                    insert '0' in scode at 5
41807>>>                move (trim(scode))                      to TmpAxio.code
41808>>>                move (trim(cmoves.client_name))         to TmpAxio.apodekths
41809>>>                move '„¤˜¤«  ¢¦š˜¨ ˜©£¦¬'               to TmpAxio.Aitiol
41810>>>                if (sper='1') begin
41812>>>                    move ''                             to Tmpaxio.lhxh
41813>>>                    move ''                             to Tmpaxio.bank
41814>>>                    move ''                             to Tmpaxio.ekdoths
41815>>>                    move ''                             to Tmpaxio.noepit
41816>>>                    move ''                             to Tmpaxio.xora
41817>>>                    move ''                             to Tmpaxio.idioy
41818>>>                    move ''                             to Tmpaxio.eparxia
41819>>>                end
41819>>>>
41819>>>                else begin
41820>>>
41820>>>                    move Baxio.baxio_hmnial             to Tmpaxio.lhxh
ERROR: 4328 Undefined symbol in argument BAXIO.BAXIO_HMNIAL ON LINE: 749 (41820) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41821>>>
41821>>>
41821>>>                    //--------------------------
41821>>>                    // 12/10/2012 Prosthikh neas trapezas gia to FI3
41821>>>                    // move baxio.baxio_banka to Tmpaxio.bank
41821>>>                    //--------------------------
41821>>>                    String sS1 sS2
41821>>>                    Move "" to sS1
41822>>>                    Move "" to sS2
41823>>>                    Clear Banks
INCLUDING FILE: BANKS.FD
41824>>>                    Move Baxio.Baxio_banka to Banks.Bank_Older_Code
ERROR: 4328 Undefined symbol in argument BAXIO.BAXIO_BANKA ON LINE: 760 (41824) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41825>>>                    Find GE Banks By Index.1
41826>>>>
41826>>>                    If ((Found) And (Baxio.Baxio_banka=Banks.Bank_Older_Code) And (Trim(Banks.Bank_ID)<>"")) Begin
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_BANKA ON LINE: 762 (41826) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41828>>>                        Move (Trim(Banks.Bank_ID))      to sS1
41829>>>                        Move (Trim(Banks.Bank_Name))    to sS2
41830>>>                    End
41830>>>>
41830>>>                    Else If ((Found) And (Baxio.Baxio_banka=Banks.Bank_Older_Code)) Begin
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_BANKA ON LINE: 766 (41830) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41833>>>                        Move (Trim(Baxio.Baxio_banka))      to sS1
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_BANKA ON LINE: 767 (41833) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41834>>>                        Clear Codemast
41835>>>                        Move "BANK"                         to Codemast.Type
41836>>>                        Move Baxio.Baxio_banka              to Codemast.Code
ERROR: 4328 Undefined symbol in argument BAXIO.BAXIO_BANKA ON LINE: 770 (41836) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41837>>>                        Find Eq Codemast By Index.1
41838>>>>
41838>>>                        Move (Trim(Codemast.Description))   to sS2
41839>>>                    End
41839>>>>
41839>>>                    Else Begin
41840>>>                        Move "" to sS1
41841>>>                        Move "" to sS2
41842>>>                    End
41842>>>>
41842>>>                    Move (Trim(sS1)) to Tmpaxio.bank
41843>>>                    Move (Trim(sS2)) to TmpAxio.Nea_Trapeza
41844>>>                    // 12/10/2012 Prosthikh neas trapezas gia to FI3
41844>>>                    //--------------------------
41844>>>
41844>>>                    move (trim(baxio.baxio_ekdothse))   to Tmpaxio.ekdoths
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_EKDOTHSE ON LINE: 783 (41844) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41845>>>                    move (trim(baxio.baxio_no))         to Tmpaxio.noepit
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_NO ON LINE: 784 (41845) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41846>>>                    move 'GR'                           to Tmpaxio.xora
41847>>>                    if (baxio.baxio_from='0') move '1'  to Tmpaxio.idioy
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_FROM ON LINE: 786 (41847) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41850>>>                    else if (baxio.baxio_from='1') move '2' to Tmpaxio.idioy
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_FROM ON LINE: 787 (41850) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41854>>>                    else if (baxio.baxio_from='')  move ''  to Tmpaxio.idioy
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_FROM ON LINE: 788 (41854) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41858>>>
41858>>>                    if (baxio.baxio_topos='0') move '2'  to Tmpaxio.eparxia
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_TOPOS ON LINE: 790 (41858) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41861>>>                    else if (baxio.baxio_topos='1') move '1' to Tmpaxio.eparxia
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_TOPOS ON LINE: 791 (41861) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41865>>>                    else if (baxio.baxio_topos='')  move ''  to Tmpaxio.eparxia
ERROR: 54 Invalid symbol in expression BAXIO.BAXIO_TOPOS ON LINE: 792 (41865) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41869>>>                    IF (tmpaxio.idioy = '2') begin
41871>>>                        move baxio.baxio_ekdothse       to tmpaxio.arxikos
ERROR: 4328 Undefined symbol in argument BAXIO.BAXIO_EKDOTHSE ON LINE: 794 (41871) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41872>>>                        move baxio.baxio_sediatagh      to tmpaxio.afmarx
ERROR: 4328 Undefined symbol in argument BAXIO.BAXIO_SEDIATAGH ON LINE: 795 (41872) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
41873>>>                    end
41873>>>>
41873>>>                end
41873>>>>
41873>>>
41873>>>                move 'EUR'                              To Tmpaxio.nomisma
41874>>>                move barticl.pae_arithm                 to tmpaxio.pae_arithm
41875>>>                move barticl.pae_hmnia                  to tmpaxio.pae_hmnia
41876>>>                If ((tmpaxio.type = 'B200') or (tmpaxio.type = 'B201')) BEGIN
41878>>>                   if (btypkin.gplan_code_apo1 <> '') begin
41880>>>                       clear tmppol
41881>>>                       move 'FI2'                              to TmpPol.onoma
41882>>>                       move '01'                               to TmpPol.typos
41883>>>                       if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmppol.etairia
41886>>>                       else move 'idy1'                        to Tmppol.etairia
41888>>>                       move segkatastash                       to TmpPol.perioxh
41889>>>                       move sPERIOXH                           to TmpPol.egkatastash
41890>>>                       move segkatastash                       to TmpPol.tomeas
41891>>>                       move btypkin.btypkin_descr              to tmppol.descr
41892>>>                       move tmpaxio.type                       to tmppol.type
41893>>>                       move tmpaxio.arithmos                   to Tmppol.arithmos
41894>>>                       move tmpaxio.hmnia                      to Tmppol.hmnia
41895>>>                       MOVE barticl.sxolia1                    to tmppol.sxolia
41896>>>                       move ''                                 to Tmppol.kodikos
41897>>>                       move tmpaxio.axia                       to Tmppol.axia
41898>>>                       if (Tmppol.axia <> 0) begin
41900>>>                           if (cmoves.cmoves_p0 <> 0);                               move '_'                        to Tmppol.kinhsh
41903>>>                           if (cmoves.cmoves_p0 < 0);                               move '-'                        to Tmppol.sign
41906>>>                           if (cmoves.cmoves_x0 <> 0);                               move ''                        to Tmppol.kinhsh
41909>>>                           if (cmoves.cmoves_x0 < 0);                               move '-'                        to Tmppol.sign
41912>>>                        end
41912>>>>
41912>>>
41912>>>                        move (trim(tmpaxio.code))              to Tmppol.code
41913>>>                        move tmpaxio.anal                      to Tmppol.kodikos2
41914>>>                        move tmpaxio.apodekths                 to Tmppol.name
41915>>>                        Clear Tperga
41916>>>                        move barticl.cn_code  to tperga.cn_code
41917>>>                        find gt tperga by index.1
41918>>>>
41918>>>                        while ((found) and (barticl.cn_code=tperga.cn_code))
41922>>>                            if ((tperga.xarhtos_meres<>0) and (tperga.plhroteo_meres<>0)) begin
41924>>>                                move '' to soroi
41925>>>                                move tperga.xarhtos_meres to soroi
41926>>>                                insert tperga.plhroteo_meres in soroi at 3
41928>>>                                move (trim(soroi)) to soroi
41929>>>                            end
41929>>>>
41929>>>                            find gt tperga by index.1
41930>>>>
41930>>>                        loop
41931>>>>
41931>>>                        move soroi                              to Tmppol.Oroi
41932>>>                        move 'EUR'                              To Tmppol.nomisma
41933>>>                        saverecord Tmppol
41934>>>                        move  0 to tmppol.recnum
41935>>>                        if (tmpaxio.type='B200');                            move '00001' to tmppol.kodikos
41938>>>                        else if (tmpaxio.type='B201');                            move '00002' to tmppol.kodikos
41942>>>                        move ''                                 to tmppol.code
41943>>>                        move '03' to tmppol.typos
41944>>>                        saverecord tmppol
41945>>>
41945>>>                   End
41945>>>>
41945>>>                End
41945>>>>
41945>>>                else begin
41946>>>                    saverecord TmpAxio
41947>>>                    add 1 to Imet
41948>>>                end
41948>>>>
41948>>>
41948>>>                NextCmovesd:
41948>>>                Set Label Of frmShow to ('€¥ æš¨˜­˜' + '-' + String(iMet)+'-'+String(cmoves.cmoves_hmnia))
41949>>>                if (ienhsap=1) begin
41951>>>                    move 0 to ienhsap
41952>>>                    clear clients
41953>>>                    move sclientid to clients.client_id
41954>>>                    find eq clients by index.6
41955>>>>
41955>>>                    if (found=1) begin
41957>>>                        move 1 to clients.client_public
41958>>>                        move dkenhdate to clients.sap_hmnia
41959>>>                        saverecord clients
41960>>>                    end
41960>>>>
41960>>>                end
41960>>>>
41960>>>                find gt cmoves by 16
41961>>>>
41961>>>
41961>>>             Loop
41962>>>>
41962>>>
41962>>>            clear TmpAxio
41963>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
41964>>>            move ''                                 to tmpaxio.anal
41965>>>            move 'FI3'                              to Tmpaxio.onoma
41966>>>            move '90'      to Tmpaxio.typos
41967>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
41970>>>            else move 'idy1'                        to Tmpaxio.etairia
41972>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
41973>>>            move '9999'                             to Tmpaxio.type
41974>>>            move '9999999999'                       to Tmpaxio.arithmos
41975>>>            move '1'                                to Tmpaxio.perigrafh
41976>>>            move nmetrhta                           to Tmpaxio.axia
41977>>>            saverecord TmpAxio
41978>>>
41978>>>            clear TmpAxio
41979>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
41980>>>            move 'FI3'                              to Tmpaxio.onoma
41981>>>            move ''                                 to tmpaxio.anal
41982>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
41983>>>            move '91'                               to Tmpaxio.typos
41984>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
41987>>>            else move 'idy1'                        to Tmpaxio.etairia
41989>>>            move '9999'                             to Tmpaxio.type
41990>>>            move '9999999999'                       to Tmpaxio.arithmos
41991>>>            move '2'                                to Tmpaxio.perigrafh
41992>>>            move nepitages                          to Tmpaxio.axia
41993>>>            move 'EUR'                              To Tmpaxio.nomisma
41994>>>            saverecord TmpAxio
41995>>>
41995>>>            clear TmpAxio
41996>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
41997>>>            move 'FI3'                              to Tmpaxio.onoma
41998>>>            move '92'                               to Tmpaxio.typos
41999>>>            move ''                                 to tmpaxio.anal
42000>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
42003>>>            else move 'idy1'                        to Tmpaxio.etairia
42005>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
42006>>>            move '9999'                             to Tmpaxio.type
42007>>>            move '9999999999'                       to Tmpaxio.arithmos
42008>>>            move '3'                                to Tmpaxio.perigrafh
42009>>>            move nsynal                             to Tmpaxio.axia
42010>>>            move 'EUR'                              To Tmpaxio.nomisma
42011>>>            saverecord TmpAxio
42012>>>
42012>>>            clear TmpAxio
42013>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
42014>>>            move 'FI3'                              to Tmpaxio.onoma
42015>>>            move '93'                               to Tmpaxio.typos
42016>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
42019>>>            else move 'idy1'                        to Tmpaxio.etairia
42021>>>            move '9999'                             to Tmpaxio.type
42022>>>            move ''                                 to tmpaxio.anal
42023>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
42024>>>            move '9999999999'                       to Tmpaxio.arithmos
42025>>>            move '4'                                to Tmpaxio.perigrafh
42026>>>            move nembasma                           to Tmpaxio.axia
42027>>>            move 'EUR'                              To Tmpaxio.nomisma
42028>>>            saverecord TmpAxio
42029>>>
42029>>>            clear TmpAxio
42030>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
42031>>>            move 'FI3'                              to Tmpaxio.onoma
42032>>>            move '94'                               to Tmpaxio.typos
42033>>>            move ''                                 to tmpaxio.anal
42034>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
42035>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
42038>>>            else move 'idy1'                        to Tmpaxio.etairia
42040>>>            move '9999'                             to Tmpaxio.type
42041>>>            move '9999999999'                       to Tmpaxio.arithmos
42042>>>            move imet                               to Tmpaxio.axia
42043>>>            saverecord TmpAxio
42044>>>
42044>>>            clear TmpAxio
42045>>>            move segkatastash                       to Tmpaxio.EGKATASTASH
42046>>>            move 'FI3'                              to Tmpaxio.onoma
42047>>>            move ''                                 to tmpaxio.anal
42048>>>            MOVE STOMEAS                            to Tmpaxio.perioxh
42049>>>            move '95'                               to Tmpaxio.typos
42050>>>            if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmpaxio.etairia
42053>>>            else move 'idy1'                        to Tmpaxio.etairia
42055>>>            move '9999'                             to Tmpaxio.type
42056>>>            move '9999999999'                       to Tmpaxio.arithmos
42057>>>            move '5'                                to Tmpaxio.perigrafh
42058>>>            move nHmeras                            to Tmpaxio.axia
42059>>>            move 'EUR'                              To Tmpaxio.nomisma
42060>>>            saverecord TmpAxio
42061>>>
42061>>>        End_Procedure
42062>>>
42062>>>
42062>>>        Procedure enhmerose_polhseis
42064>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo SSIGN sptyp
42065>>>             string stomeas soroi scmoves skod sitem spar sparast skodikos sclientid spmsrecr  spartlrecr
42065>>>             NUMBER npartlfpa npmsfpa
42065>>>             integer Imet Ikod  irecnum  ino ienhsap iarnhtika
42065>>>             number  ntot nfpa nnet nqty nhqty
42065>>>             date dapod ddate dkenhdate
42065>>>             string msgstr
42065>>>             move '01/01/2005' to ddate
42066>>>             move '01/01/1753' to dkenhdate
42067>>>             clear tmppol
42068>>>             find gt tmppol.recnum
42069>>>>
42069>>>             while (found)
42073>>>                if (tmppol.typos='01');                    add tmppol.axia to ntot
42076>>>                find gt tmppol.recnum
42077>>>>
42077>>>             Loop
42078>>>>
42078>>>             get value of frmapo to dapod
42079>>>             move Sysfile.Client_Digits to Ikod
42080>>>             add 3 to ikod // gia na paroyme kai to AX ektos yomea
42081>>>             clear Company
42082>>>             move syscurxr.company_code to Company.company_code
42083>>>             find eq company by index.1
42084>>>>
42084>>>             move Company.company_c_code0 to stomeas
42085>>>
42085>>>
42085>>>             clear Particle
42086>>>             find gt particle by 17
42087>>>>
42087>>>             while ((found) and (particle.sap_hmnia = ''))
42091>>>                move '' to sclientid
42092>>>                move 0 to ienhsap
42093>>>
42093>>>                if  (particle.partl_hmnia  > dapod);                    goto nextpmovesd
42096>>>                if (syscurxr.company_code<>particle.company_code);                    goto nextpmovesd
42099>>>                if (particle.partl_no < 1);                    goto nextpmovesd
42102>>>                clear tempitem
42103>>>                find gt tempitem.recnum
42104>>>>
42104>>>                while (found)
42108>>>                    delete tempitem
42109>>>                    find gt tempitem.recnum
42110>>>>
42110>>>                Loop
42111>>>>
42111>>>
42111>>>                clear tmplg
42112>>>                find gt tmplg.recnum
42113>>>>
42113>>>                while (found)
42117>>>                    delete tmplg
42118>>>                    find gt tmplg.recnum
42119>>>>
42119>>>                Loop
42120>>>>
42120>>>                move 0 to npartlfpa
42121>>>                move 0 to npmsfpa
42122>>>                clear branch
42123>>>                move particle.company_code to branch.company_code
42124>>>                move particle.branch_code  to branch.branch_code
42125>>>                find eq branch by index.1
42126>>>>
42126>>>
42126>>>
42126>>>                move branch.PERIOXH            to sperioxh
42127>>>                move branch.egkatastash        to segkatastash
42128>>>                move particle.partl_recr       to srecr
42129>>>             //   move particle.partl_vatam      to npartlfpa
42129>>>                clear TmpPol
42130>>>                MOVE '' to  ssign
42131>>>                move 'FI2'                              to TmpPol.onoma
42132>>>                move '01'                               to TmpPol.typos
42133>>>                if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmppol.etairia
42136>>>                else move 'idy1'                        to Tmppol.etairia
42138>>>                move segkatastash                       to TmpPol.perioxh
42139>>>                move sPERIOXH                           to TmpPol.egkatastash
42140>>>                move segkatastash                       to TmpPol.tomeas
42141>>>                relate Particle
42142>>>                if (trim(ptyppar.sap)='');                    goto nextpmovesd
ERROR: 54 Invalid symbol in expression PTYPPAR.SAP ON LINE: 1045 (42142) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
42145>>>                IF (clients.client_fpa=1);                    goto nextpmovesd
42148>>>
42148>>>
42148>>>                move (trim(ptyppar.ptyppar_descr))      to Tmppol.descr
ERROR: 54 Invalid symbol in expression PTYPPAR.PTYPPAR_DESCR ON LINE: 1050 (42148) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
42149>>>                move (trim(Ptyppar.ptyppar_code))       to stype
ERROR: 54 Invalid symbol in expression PTYPPAR.PTYPPAR_CODE ON LINE: 1051 (42149) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
42150>>>                move '' to spartlrecr
42151>>>                move '' to sptyp
42152>>>                if (ptyppar.sub='1') insert 'C' in stype at 1
ERROR: 54 Invalid symbol in expression PTYPPAR.SUB ON LINE: 1054 (42152) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
42156>>>                else insert 'B' in stype at 1
42159>>>                if (stype<>'C') begin
42161>>>                    clear psxetika
42162>>>                    move particle.partl_recr to spartlrecr
42163>>>                    move spartlrecr to psxetika.psx_partl_recr
42164>>>                    find gt psxetika by index.3
42165>>>>
42165>>>                    while ((found) and (spartlrecr=psxetika.psx_partl_recr))
42169>>>                        move psxetika.ptyppar_code to sptyp
42170>>>                        clear ptypparl
42171>>>                        move particle.company_code to ptypparl.company_code
42172>>>                        move particle.branch_code  to ptypparl.branch_code
42173>>>                        move sptyp                 to ptypparl.ptyppar_code
42174>>>                        find eq ptypparl by index.1
42175>>>>
42175>>>                        if (found) begin
42177>>>                           if (ptypparl.sub='1') begin
42179>>>                                move '' to stype
42180>>>                                move (trim(Ptyppar.ptyppar_code))       to stype
ERROR: 54 Invalid symbol in expression PTYPPAR.PTYPPAR_CODE ON LINE: 1071 (42180) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
42181>>>                                insert 'C' in stype at 1
42183>>>                           end
42183>>>>
42183>>>                        End
42183>>>>
42183>>>                        find gt psxetika by index.3
42184>>>>
42184>>>                    Loop
42185>>>>
42185>>>
42185>>>                end
42185>>>>
42185>>>
42185>>>                move (trim(stype))                      to Tmppol.type
42186>>>                move '' to spar
42187>>>                // gts 1/10/08 ž«ãŸž¡œ ¤˜ šå¤œ«˜  export ¡˜  ž ©œ ¨á
42187>>>                //move particle.pseira_seira              to tmppol.sxrecr
42187>>>                string S1 S2 s3
42187>>>                Move "" to s1
42188>>>                Move "" to s2
42189>>>                Move "" to s3
42190>>>
42190>>>                clear pseira
42191>>>                move particle.company_code to pseira.company_code
42192>>>                move particle.branch_code  to pseira.branch_code
42193>>>                move particle.ptyppar_code to pseira.ptyppar_code
42194>>>                move particle.pseira_seira to pseira.pseira_seira
42195>>>                find eq pseira by index.1
42196>>>>
42196>>>                if (found) begin
42198>>>        //             SHOWLN PSEIRA.PSEIRA_FORM
42198>>>        //             SHOWLN particle.partl_no
42198>>>
42198>>>                    //----------------------------------------------------------------------------
42198>>>                    // JS 11/02/2011    START
42198>>>                    //----------------------------------------------------------------------------
42198>>>                    // ƒœ¤ ™š˜œ  ¡˜Ÿ¦¢¦¬ «ž¤ ©œ ¨˜  §˜¨˜ £¦¤¦ ˜¤ ¡˜§¦ ¦ª ˜§¦ ¢˜Ÿ¦ª
42198>>>                    // ®¨ž© £¦§¦ ž©œ  ¢˜¤Ÿ˜©£œ¤˜ «ž¤ «œ¢ «©˜ ©«ž¤ ©œ ¨˜ ¦§¦«œ £¦¤¦ «¦«œ §˜¨˜šœ 
42198>>>                    // «ž¤ ©œ ¨˜  š ˜«  «ž¤ §˜ ¨¤œ  ˜§¦ «¦ Form (©¬¤›œ©ž «œ¢œå˜ª £œ )
42198>>>
42198>>>                    //----------------- Move (Trim(pseira.pseira_form)) to s1
42198>>>                         If (Trim(pseira.pseira_form )<>"" ) Move (Trim(pseira.pseira_form )) to s1
42201>>>                    Else If (Trim(pseira.pseira_seira)<>".") Move (Trim(pseira.pseira_seira)) to s1
42205>>>                    Else                                     Move ""                          to s1
42207>>>                    //----------------------------------------------------------------------------
42207>>>                    // JS 11/02/2011    END
42207>>>                    //----------------------------------------------------------------------------
42207>>>
42207>>>
42207>>>                    Move (Trim(String(particle.partl_no))) to s2
42208>>>                    Move (Trim(s1+"."+s2)) to s3
42209>>>                    Move (Trim(s3)) to tmppol.arithmos
42210>>>
42210>>>                end
42210>>>>
42210>>>                //move particle.partl_no                  to Tmppol.arithmos
42210>>>                move Particle.Partl_hmnia               to Tmppol.hmnia
42211>>>                MOVE PARTICLE.AITIOL                    to tmppol.sxolia
42212>>>                move ''                                 to Tmppol.kodikos
42213>>>                move Particle.partl_payam               to Tmppol.axia
42214>>>                add Tmppol.axia                         to ntot
42215>>>                move (trim(Particle.client_id))         to scode
42216>>>                move Particle.partl_totamad             to Tmppol.posonet
42217>>>                move '' to skodikos
42218>>>                if (Tmppol.axia <> 0) begin
42220>>>                    move particle.cmoves_recr           to scmoves
42221>>>                    clear cmoves
42222>>>                    move scmoves to cmoves.cmoves_recr
42223>>>                    find eq cmoves by index.2
42224>>>>
42224>>>                    if (cmoves.cmoves_p0 <> 0);                        move ''                        to Tmppol.kinhsh
42227>>>                    if (cmoves.cmoves_p0 < 0) begin
42229>>>                        move '-'                        to Tmppol.sign
42230>>>                        move '-'                        to ssign
42231>>>                    end
42231>>>>
42231>>>                    if (cmoves.cmoves_x0 <> 0);                        move '•'                        to Tmppol.kinhsh
42234>>>                    if (cmoves.cmoves_x0 < 0) begin
42236>>>                        move '-'                        to Tmppol.sign
42237>>>                        move '-'                        to ssign
42238>>>                    end
42238>>>>
42238>>>                end
42238>>>>
42238>>>                Move (Right(scode, Ikod))               To scode
42239>>>                move (replaces('.',scode,'')) to scode
42240>>>                insert '01' in scode at 1
42242>>>                if (Sysfile.Client_Digits<6);                    insert '0' in scode at 5
42246>>>                move (trim(scode))                      to Tmppol.code
42247>>>                Relate Particle
42248>>>                if (clients.is_xondr='1')     move '1'     to skodikos
42251>>>                else                          move '2'     to skodikos
42253>>>          //      If (sysfile.company_name='1') move '1'     to skodikos
42253>>>                if (clients.is_xondr='1')     move '01'     to Tmppol.kodikos2
42256>>>                else                          move '02'     to Tmppol.kodikos2
42258>>>          //      If (sysfile.company_name='1') move '01'     to Tmppol.kodikos2
42258>>>                if ((particle.ptyppar_code='100') or (particle.ptyppar_code='113')) begin
42260>>>                    if (particle.ptyppar_code<>clients.client_ptyppar) begin
42262>>>                       move '˜¨˜©«˜« ¡æ <> ˜§æ æ«  ¦¨å©«ž¡œ ©«¦¤ œ¢á«ž. ˜¨˜©«˜« ¡æ = ' to msgstr
42263>>>                       append msgstr tmppol.arithmos
42264>>>                       error 5690 msgstr
42265>>>>
42265>>>                    end
42265>>>>
42265>>>                End
42265>>>>
42265>>>                if ((clients.status='') and (clients.sap_hmnia<=ddate)) begin
42267>>>                    move 1 to ienhsap
42268>>>                    move Particle.client_id to sclientid
42269>>>                    if (clients.client_ptyppar='') begin
42271>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå §˜¨˜©«˜« ¡æ ©«¦¤ œ¢á«ž = ' to msgstr
42272>>>                        append msgstr clients.client_id
42273>>>                        error 4330 msgstr
42274>>>>
42274>>>                    end
42274>>>>
42274>>>                    if (clients.client_ptyppar='100') begin
42276>>>                            move '' to msgstr
42277>>>                            if (clients.is_xondr<>'1') begin
42279>>>                                move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
42280>>>                                append msgstr clients.client_id
42281>>>                                error 4333 msgstr
42282>>>>
42282>>>                            end
42282>>>>
42282>>>                    end
42282>>>>
42282>>>                    else begin
42283>>>                        if (clients.client_ptyppar<>'113') begin
42285>>>                            move 'ŠáŸ¦ª ©«¦ §˜¨˜©«˜« ¡æ/Flag ©«¦¤ §œ¢á«ž =' to msgstr
42286>>>                            append msgstr clients.client_id
42287>>>                            error 4334 msgstr
42288>>>>
42288>>>                        end
42288>>>>
42288>>>                    end
42288>>>>
42288>>>                end
42288>>>>
42288>>>                move ''                                 to Tmppol.apoth
42289>>>                move 0                                  to Tmppol.qty
42290>>>                move clients.client_name                to Tmppol.name
42291>>>
42291>>>                Clear Tperga
42292>>>                move Particle.cn_code  to tperga.cn_code
42293>>>                find gt tperga by index.1
42294>>>>
42294>>>                while ((found) and (particle.cn_code=tperga.cn_code))
42298>>>                    if ((tperga.xarhtos_meres<>0) and (tperga.plhroteo_meres<>0)) begin
42300>>>                        move '' to soroi
42301>>>                        move tperga.xarhtos_meres to soroi
42302>>>                        insert tperga.plhroteo_meres in soroi at 3
42304>>>                        move (trim(soroi)) to soroi
42305>>>                    end
42305>>>>
42305>>>                    find gt tperga by index.1
42306>>>>
42306>>>                loop
42307>>>>
42307>>>                move soroi                              to Tmppol.Oroi
42308>>>                move 'EUR'                              To Tmppol.nomisma
42309>>>
42309>>>
42309>>>                //-------------------------------------
42309>>>                // 02/10/2012 Prosthiki Tropon Plhromhs
42309>>>                //-------------------------------------
42309>>>                Integer isFound
42309>>>                String  sTroposPlhr
42309>>>
42309>>>                Move  0 to isFound
42310>>>                Move "" to sTroposPlhr
42311>>>
42311>>>                clear pmoves
42312>>>                move srecr to pmoves.partl_recr
42313>>>                find gt pmoves by index.3
42314>>>>
42314>>>                while ((found) and (srecr=pmoves.partl_recr) And (isFound=0))
42318>>>                    clear btnordd
42319>>>                    move Pmoves.Client_ID   to btnordd.vclient_id
42320>>>                    move Pmoves.CN_Code     to btnordd.vcn_code
42321>>>                    move Pmoves.Item_Code   to btnordd.vitem
42322>>>                    move 0                  to btnordd.vactive
42323>>>                    move Pmoves.Partl_Hmnia to btnordd.arxh_date
42324>>>                    find le btnordd by index.4//client_id+cn_code+item+arxh_date
42325>>>>
42325>>>                    if ((found=1) and (Pmoves.Item_Code=btnordd.vitem) and (Pmoves.Partl_Hmnia ge btnordd.arxh_date) and (Pmoves.Partl_Hmnia le btnordd.deop_date) and (btnordd.vactive=0) and (Pmoves.CN_Code=btnordd.vcn_code)) begin
42327>>>                        Move 1 to isFound
42328>>>                        Clear BtnOrdH
INCLUDING FILE: BTNORDH.FD
42329>>>                        Move BtnOrdD.BtnOrdH_Recr   to BtnOrdH.Recr
42330>>>                        Find Eq BtnOrdH By Index.2
42331>>>>
42331>>>                        Move (Trim(BtnOrdH.Timeout)) to sTroposPlhr
42332>>>                    End
42332>>>>
42332>>>                    find gt pmoves by index.3
42333>>>>
42333>>>                Loop
42334>>>>
42334>>>
42334>>>                If      (Trim(sTroposPlhr      )<>"")   Move (Trim(sTroposPlhr))        to TmpPol.Tropoi_Plhromhs
42337>>>                Else If (Trim(clients.Polh_Recr)<>"")   Move (Trim(clients.Polh_Recr))  to TmpPol.Tropoi_Plhromhs
42341>>>                Else                                    Move (Trim(Tmppol.Oroi))        to TmpPol.Tropoi_Plhromhs
42343>>>                //-------------------------------------
42343>>>                // 02/10/2012 Prosthiki Tropon Plhromhs
42343>>>                //-------------------------------------
42343>>>
42343>>>
42343>>>                saverecord Tmppol
42344>>>                add 1 to ino
42345>>>                add 1 to Imet
42346>>>                move 0 to iarnhtika
42347>>>
42347>>>                if (particle.partl_euro=1) begin
42349>>>                    clear pmoves
42350>>>                    move srecr to pmoves.partl_recr
42351>>>                    find gt pmoves by index.3
42352>>>>
42352>>>                    while ((found) and (srecr=pmoves.partl_recr))
42356>>>                          if (pmoves.wapokat_code='05') begin
42358>>>                                clear tmplg
42359>>>                                relate pmoves
42360>>>                                move item.sap to tmplg.company_code
42361>>>                                find eq tmplg by index.1
42362>>>>
42362>>>                                if (found) begin
42364>>>                                    add  pmoves.pms_qty         to tmplg.gmove_x00
42365>>>                                    add  Pmoves.pms_VATAM       to tmplg.gmove_x0
42366>>>                                    add  pmoves.pms_amaftdisc   to tmplg.gmove_p0
42367>>>                                    saverecord tmplg
42368>>>                                end
42368>>>>
42368>>>                                else begin
42369>>>                                    move  pmoves.pms_qty        to tmplg.gmove_x00
42370>>>                                    move  Pmoves.pms_VATAM      to tmplg.gmove_x0
42371>>>                                    move  pmoves.pms_amaftdisc  to tmplg.gmove_p0
42372>>>                                    saverecord tmplg
42373>>>                                end
42373>>>>
42373>>>                           end
42373>>>>
42373>>>
42373>>>                        find gt pmoves by index.3
42374>>>>
42374>>>                        Loop
42375>>>>
42375>>>                 End
42375>>>>
42375>>>
42375>>>                    clear pmoves
42376>>>                    move srecr to pmoves.partl_recr
42377>>>                    find gt pmoves by index.3
42378>>>>
42378>>>                    while ((found) and (srecr=pmoves.partl_recr))
42382>>>                    clear TmpPol
42383>>>                    move 'FI2'                              to TmpPol.onoma
42384>>>                    move '03'                               to TmpPol.typos
42385>>>                    if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmppol.etairia
42388>>>                    else move 'idy1'                        to Tmppol.etairia
42390>>>                    move segkatastash                       to TmpPol.perioxh
42391>>>                    move sPERIOXH                           to TmpPol.egkatastash
42392>>>                    move segkatastash                       to TmpPol.tomeas
42393>>>                    move (trim(stype))                      to Tmppol.type
42394>>>                    move ssign                              to tmppol.sign
42395>>>                    move (TRIM(S3))                         to Tmppol.arithmos
42396>>>                  //  move pmoves.partl_no                    to Tmppol.arithmos
42396>>>                    move Pmoves.Partl_hmnia                 to Tmppol.hmnia
42397>>>                    move pmoves.pms_unitprice               to tmppol.unitpr
42398>>>                    move iarnhtika                          to tmppol.neo
42399>>>                    Relate Pmoves
42400>>>                    move '' to skod
42401>>>                    move (trim(wapokat.gl))                 to skod
42402>>>                    IF (pmoves.pms_status_e=1);                        move '1'                            to skod
42405>>>                    insert ptyppar.sap in skod at 2
ERROR: 4328 Undefined symbol in argument PTYPPAR.SAP ON LINE: 1306 (42406) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
42407>>>                    move skodikos to sstr
42408>>>                    insert sstr              in skod at 3
42410>>>                    insert Item.link2        in skod at 4
42412>>>                    if (particle.skopos_diakin='9') move '2' to sstr
42415>>>                    else                            move '1' to sstr
42417>>>                    insert sstr              in skod at 5
42419>>>                    if (trim(wapokat.gl)='') begin
42421>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©« ª €§¦Ÿã¡œª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
42422>>>                        append msgstr tmppol.arithmos
42423>>>                        error 4441 msgstr
42424>>>>
42424>>>                    End
42424>>>>
42424>>>                    if (trim(item.link2)='') begin
42426>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª ‘ç¤›œ©žª SAP ©«¦ „å›¦ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
42427>>>                        append msgstr tmppol.arithmos
42428>>>                        error 4443 msgstr
42429>>>>
42429>>>                    End
42429>>>>
42429>>>
42429>>>
42429>>>
42429>>>
42429>>>                    if ((particle.partl_euro=1) and (pmoves.wapokat_code='05')) begin
42431>>>                        clear tmplg
42432>>>                        move item.sap to tmplg.company_code
42433>>>                        find eq tmplg by index.1
42434>>>>
42434>>>                        if (tmplg.gmove_aa = 1) goto prosperasepmoves
42437>>>                        move tmplg.gmove_x00 to tmppol.qty
42438>>>                        move tmplg.gmove_x0  to Tmppol.POSOFPA
42439>>>                        move tmplg.gmove_p0  to Tmppol.axia
42440>>>                        move 1 to tmplg.gmove_aa
42441>>>                        saverecord tmplg
42442>>>                    end
42442>>>>
42442>>>                    else begin
42443>>>                        move Pmoves.pms_amaftdisc               to Tmppol.axia
42444>>>                        move Pmoves.pms_VATAM                   to Tmppol.POSOFPA
42445>>>                        move pmoves.pms_qty                     to Tmppol.qty
42446>>>                    end
42446>>>>
42446>>>
42446>>>                    move skod                               to Tmppol.kodikos
42447>>>               //     move Pmoves.pms_amaftdisc               to Tmppol.axia
42447>>>               //     add  pmoves.pms_vatam                   to npmsfpa
42447>>>               //     move Pmoves.pms_VATAM                   to Tmppol.POSOFPA
42447>>>                    add  Tmppol.axia                        to nnet
42448>>>                    move 'B'                                to sitem
42449>>>                    IF (pmoves.pms_status_e=1);                        move 'G'                            to sstr
42452>>>                    else;                        move wapokat.sap_descr              to sstr
42454>>>                    insert sstr in sitem at 2
42456>>>                    if (trim(wapokat.sap_descr)='') begin
42458>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©«ã¤ ‰˜«žš¦¨å˜ „å›¦¬ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
42459>>>                        append msgstr tmppol.arithmos
42460>>>                        error 4459 msgstr
42461>>>>
42461>>>                    End
42461>>>>
42461>>>                    insert 'O' in sitem at 3
42463>>>                    insert item.sap in sitem at 4
42465>>>                    if (trim(item.sap)='') begin
42467>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP „å›¦¬ª ©«æ „å›¦ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
42468>>>                        append msgstr tmppol.arithmos
42469>>>                        error 4446 msgstr
42470>>>>
42470>>>                    End
42470>>>>
42470>>>        //            if (pmoves.wapokat_code='05') begin
42470>>>        //                clear tmplg
42470>>>        //                move item.sap to tmplg.company_code
42470>>>        //                move  Pmoves.pms_VATAM to tmplg.gmove_x0
42470>>>        //                if (particle.partl_euro=1);
42470>>>        //                    move pmoves.cn_code to tmplg.branch_code
42470>>>        //                saverecord tmplg
42470>>>        //            end
42470>>>                    string spinak
42470>>>                    move '' to spinak
42471>>>                    move sitem                              to tmppol.apoth
42472>>>
42472>>>                    move pmoves.wapokat_code                to tmppol.wapokat_code
42473>>>                    move pmoves.sx_arithmos                 to Tmppol.sxetiko
42474>>>                    move item.item_code                     to Tmppol.item
42475>>>                    move item.item_descr                    to Tmppol.item_descr
42476>>>                    move Units.Units_Descr                  to Tmppol.mm
42477>>>                    if (trim(pmoves.car_id)<>'')  begin
42479>>>                        Clear Cars
42480>>>                        move (trim(pmoves.car_id))  to Cars.car_id
42481>>>                        Find eq Cars by index.2
42482>>>>
42482>>>                        Move (Append(spinak,(cars.car_what+'_'+cars.car_lc+cars.car_ln)))  to spinak
42483>>>                        if ((cars.car_what='') and (cars.car_ln=''));                            move '' to spinak
42486>>>                        MOVE SPINAK to Tmppol.pinakida
42487>>>
42487>>>                        If (trim(cars.ctype_id)='1');                            move '1' to Tmppol.kathgoria
42490>>>                        else if (trim(cars.ctype_id)='2');                            move '2' to Tmppol.kathgoria
42494>>>                        else if (trim(cars.ctype_id)='3');                            move '3' to tmppol.kathgoria
42498>>>                        else;                            move '4' to tmppol.kathgoria
42500>>>                    end
42500>>>>
42500>>>                    if (pmoves.wapokat_code='04') begin
42502>>>                        move '' to tmppol.pinakida
42503>>>                        move '' to tmppol.kathgoria
42504>>>                    end
42504>>>>
42504>>>
42504>>>                    if (pmoves.wapokat_code='05') begin
42506>>>                        move '' to tmppol.kathgoria
42507>>>                        move pmoves.pump_id to pumps.pump_id
42508>>>                        find eq pumps by index.3
42509>>>>
42509>>>                        if (found=1) begin
42511>>>                            MOVE '' to spinak
42512>>>                            Move (Append(spinak,(pumps.pump_what+pumps.pump_lc+pumps.pump_ln))) to spinak
42513>>>                            move spinak to Tmppol.pinakida
42514>>>                         end
42514>>>>
42514>>>                         If (trim(pumps.ctype_id)='1');                            move '1' to Tmppol.antlhsh
42517>>>                         else if (trim(pumps.ctype_id)='2');                            move '2' to Tmppol.antlhsh
42521>>>                         else if (trim(pumps.ctype_id)='4');                            move '3' to Tmppol.antlhsh
42525>>>                         else move '' to tmppol.antlhsh
42527>>>                    END
42527>>>>
42527>>>
42527>>>                    move soroi                              to Tmppol.Oroi
42528>>>                    move (abs(pmoves.pms_vatpct))           to Tmppol.fpa
42529>>>                    move 'EUR'                              To Tmppol.nomisma
42530>>>                    move particle.aitiol                    to tmppol.sxolia
42531>>>                    saverecord Tmppol
42532>>>                    add 1 to imet
42533>>>
42533>>>                    if (pmoves.wapokat_code='05') begin
42535>>>                        clear tempitem
42536>>>                        move '1' to tempitem.wcmove_status_e
42537>>>                        move item.sap to tempitem.witemx_code
42538>>>
42538>>>                        move soroi to tempitem.client_id
42539>>>                        move (abs(pmoves.pms_vatpct))           to Tempitem.company_code
42540>>>                        move Units.Units_Descr                  to tempitem.branch_code
42541>>>
42541>>>
42541>>>
42541>>>                        if (particle.partl_euro=1) begin
42543>>>                            clear tmplg
42544>>>                            move item.sap to tmplg.company_code
42545>>>                            find eq tmplg by index.1
42546>>>>
42546>>>                            if (not(found)) begin
42548>>>                                move pmoves.pms_qty                     to tempitem.wcmove_qty
42549>>>                                move Pmoves.pms_amaftdisc               to tempitem.wcmove_axia
42550>>>                                move Pmoves.pms_VATAM                   to Tempitem.wcmove_qty_exa
42551>>>                                move tmppol.recnum to tempitem.wcmove_qty_eisa
42552>>>                            end
42552>>>>
42552>>>                            else begin
42553>>>                                move tmplg.gmove_x00 to  tempitem.wcmove_qty
42554>>>                                move tmplg.gmove_p0  to  tempitem.wcmove_axia
42555>>>                                move tmplg.gmove_x0  to  Tempitem.wcmove_qty_exa
42556>>>                                move tmppol.recnum to tempitem.wcmove_qty_eisa
42557>>>                            end
42557>>>>
42557>>>                        end
42557>>>>
42557>>>                        else begin
42558>>>                            move pmoves.pms_qty                     to tempitem.wcmove_qty
42559>>>                            move Pmoves.pms_amaftdisc               to tempitem.wcmove_axia
42560>>>                            move Pmoves.pms_VATAM                   to Tempitem.wcmove_qty_exa
42561>>>                            move tmppol.recnum to tempitem.wcmove_qty_eisa
42562>>>
42562>>>                        end
42562>>>>
42562>>>
42562>>>
42562>>>                        Showln "-----------------------------------"
42564>>>                        Showln "Parast          =" (String(Tmppol.arithmos))
42567>>>                        Showln "-----------------------------------"
42569>>>                        Showln "WCMOVE_STATUS_E =" TempItem.Wcmove_Status_E
42572>>>                        Showln "Witemx_Code     =" TempItem.WITEMX_CODE
42575>>>                        Showln "Year_Year       =" TempItem.Year_Year
42578>>>                        Showln "Item_Code       =" TempItem.ITEM_CODE
42581>>>                        Showln "Qty             =" TempItem.Wcmove_Qty
42584>>>                        Showln "Qty Eisa        =" TempItem.Wcmove_Qty_Eisa
42587>>>                        Showln "Qty Exa         =" TempItem.Wcmove_Qty_Exa
42590>>>                        Showln "WCMOVE_Axia     =" TempItem.Wcmove_Axia
42593>>>                        Showln "Client_ID       =" TempItem.Client_ID
42596>>>                        Showln "Wax_Recr        =" TempItem.Wax_Recr
42599>>>
42599>>>
42599>>>
42599>>>
42599>>>
42599>>>                        saverecord tempitem
42600>>>
42600>>>                    end
42600>>>>
42600>>>                    Set Label Of frmShow to ('à¢ã©œ ª' + '-' + String(iMet)+'-'+String(Tmppol.arithmos))
42601>>>                    prosperasepmoves:
42601>>>                    find gt pmoves by index.3
42602>>>>
42602>>>                Loop
42603>>>>
42603>>>
42603>>>                move 0                                  to tmppol.recnum
42604>>>                // 04/05/2011
42604>>>                //move particle.partl_vatam               to Tmppol.axia
42604>>>                move particle.Total_Vat_Poso            to Tmppol.axia
42605>>>
42605>>>                add Tmppol.axia                         to nfpa
42606>>>                move sEGKATASTASH                       to TmpPol.perioxh
42607>>>                move ''                                 to tmppol.code
42608>>>                move ''                                 to tmppol.kodikos2
42609>>>                move ''                                 to tmppol.apoth
42610>>>                move 0                                  to tmppol.qty
42611>>>                move 0                                  to tmppol.unitpr
42612>>>                move ''                                 to tmppol.mm
42613>>>                move ''                                 to tmppol.kathgoria
42614>>>                move ''                                 to tmppol.pinakida
42615>>>                move ''                                 to tmppol.ANTLHSH
42616>>>                move 0                                  to tmppol.posofpa
42617>>>                move ''                                 to tmppol.item
42618>>>                move ''                                 to tmppol.wapokat_code
42619>>>                move ''                                 to tmppol.sxetiko
42620>>>                move '05'                               to TmpPol.typos
42621>>>                move '' to tmppol.kodikos
42622>>>                saverecord Tmppol
42623>>>                add 1 to imet
42624>>>
42624>>>
42624>>>                clear Psxetika
42625>>>                move srecr to Psxetika.partl_recr
42626>>>                Find gt Psxetika by index.4
42627>>>>
42627>>>                while ((found) and (srecr=Psxetika.partl_recr))
42631>>>                        move 0                              to tmppol.recnum
42632>>>                        move '06'                           to TmpPol.typos
42633>>>                        move sEGKATASTASH                   to TmpPol.perioxh
42634>>>                        move 0                              to tmppol.axia
42635>>>                        move ''                             to tmppol.oroi
42636>>>                        move ''                             to tmppol.nomisma
42637>>>                        move 0                              to Tmppol.posofpa
42638>>>                        move 0                              to Tmppol.fpa
42639>>>                        move ''                             to tmppol.item
42640>>>                        move ''                             to tmppol.wapokat_code
42641>>>                        move ''                             to tmppol.sxolia
42642>>>                        move ''                             to tmppol.sxetiko
42643>>>                        move '' to sparast
42644>>>                        move psxetika.sx_pseira_seira       to sparast
42645>>>                        append sparast Psxetika.sx_partl_no
42646>>>                        move sparast                        to Tmppol.deltia
42647>>>                        move psxetika.psx_partl_recr        to Tmppol.sxrecr
42648>>>
42648>>>                        Clear pmovesl
42649>>>                        move tmppol.sxrecr to pmovesl.partl_recr
42650>>>                        find gt pmovesl by index.3
42651>>>>
42651>>>                        while ((found) and (tmppol.sxrecr=pmovesl.partl_recr))
42655>>>                            if (pmovesl.wapokat_code='05') begin
42657>>>
42657>>>                                clear iteml
42658>>>                                move pmovesl.item_code to iteml.item_code
42659>>>                                find EQ iteml by index.5
42660>>>>
42660>>>                                move iteml.sap to Tmppol.item
42661>>>
42661>>>                                clear pumps
42662>>>                                move pmovesl.pump_id to pumps.pump_id
42663>>>                                find eq pumps by index.3
42664>>>>
42664>>>
42664>>>                                if (found=1) begin
42666>>>                                    MOVE '' to spinak
42667>>>                                    Move (Append(spinak,(pumps.pump_what+pumps.pump_lc+pumps.pump_ln))) to spinak
42668>>>                                    move spinak to Tmppol.pinakida
42669>>>                                end
42669>>>>
42669>>>
42669>>>                                If      (trim(pumps.ctype_id)='1') move '1' to Tmppol.antlhsh
42672>>>                                else if (trim(pumps.ctype_id)='2') move '2' to Tmppol.antlhsh
42676>>>                                else if (trim(pumps.ctype_id)='4') move '3' to Tmppol.antlhsh
42680>>>                                else                               move ''  to tmppol.antlhsh
42682>>>
42682>>>                                move '' to tmppol.kathgoria
42683>>>
42683>>>
42683>>>                                clear tempitem
42684>>>                                move '2'                    to tempitem.wcmove_status_e // Hard Coded Kodikos gia Antlies = 2 (?)
42685>>>                                move (trim(iteml.sap))      to tempitem.witemx_code     // Kodikos SAP  p.x.  P0 > P001
42686>>>                                move (trim(spinak))         to tempitem.item_code       // Pinakida + Eidos ktl...
42687>>>                                move (trim(tmppol.antlhsh)) to tempitem.year_year       // Eidos Antlias 1 h 2 h 3 h 0
42688>>>
42688>>>                                Showln "==================================="
42690>>>                                Showln "ANTLIES >> find eq tempitem by index.4"
42692>>>                                Showln "for parast " Pmovesl.Partl_Hmnia "  "  Pmovesl.Partl_No
42697>>>                                Showln "==================================="
42699>>>                                Showln "WCMOVE_STATUS_E =" TempItem.Wcmove_Status_E
42702>>>                                Showln "Witemx_Code     =" TempItem.WITEMX_CODE
42705>>>                                Showln "Year_Year       =" TempItem.Year_Year
42708>>>                                Showln "Item_Code       =" TempItem.ITEM_CODE
42711>>>                                Showln "==================================="
42713>>>
42713>>>                                find eq tempitem by index.4
42714>>>>
42714>>>
42714>>>                                if (found) begin
42716>>>                                    Showln "ANTLIES Record FOUND... Adding Qty"
42718>>>                                    Showln "WCMOVE_STATUS_E =" TempItem.Wcmove_Status_E
42721>>>                                    Showln "Witemx_Code     =" TempItem.WITEMX_CODE
42724>>>                                    Showln "Year_Year       =" TempItem.Year_Year
42727>>>                                    Showln "Item_Code       =" TempItem.ITEM_CODE
42730>>>                                    Showln "Qty             =" TempItem.Wcmove_Qty
42733>>>                                    Showln "Pms adding Qty  =" pmovesl.pms_qty
42736>>>
42736>>>                                    add  pmovesl.pms_qty to tempitem.wcmove_qty
42737>>>                                    saverecord tempitem
42738>>>                                end
42738>>>>
42738>>>                                else begin
42739>>>                                    Showln "ANTLIES Record NOT FOUND... Creating Record"
42741>>>                                    Clear tempitem
42742>>>                                    move '2'                    to tempitem.wcmove_status_e
42743>>>                                    move (trim(iteml.sap))      to tempitem.witemx_code
42744>>>                                    Move (trim(tmppol.antlhsh)) to tempitem.year_year
42745>>>                                    move (trim(spinak))         to tempitem.item_code
42746>>>
42746>>>                                    move pmovesl.pms_qty        to tempitem.wcmove_qty
42747>>>                                    move Pmovesl.pms_amaftdisc  to tempitem.wcmove_axia
42748>>>                                    move Pmovesl.pms_VATAM      to Tempitem.wcmove_qty_exa
42749>>>
42749>>>                                    Showln "WCMOVE_STATUS_E =" TempItem.Wcmove_Status_E "   >>  = 2"
42753>>>                                    Showln "Witemx_Code     =" TempItem.WITEMX_CODE     "   >> Item SAP = " iteml.sap
42758>>>                                    Showln "Year_Year       =" TempItem.Year_Year       "   >> tmppol Antlish = " (trim(tmppol.antlhsh))
42763>>>                                    Showln "Item_Code       =" TempItem.ITEM_CODE       "   >> spinak   = " (trim(spinak))
42768>>>                                    Showln "Qty             =" TempItem.Wcmove_Qty      "   >> pmovesl.pms_qty = " pmovesl.pms_qty
42773>>>                                    Showln "Pms Axia        =" tempitem.wcmove_axia     "   >> Pmovesl.pms_amaftdisc = " Pmovesl.pms_amaftdisc
42778>>>                                    Showln "Pms Qty Exa     =" Tempitem.wcmove_qty_exa  "   >> Pmovesl.pms_VATAM = " Pmovesl.pms_VATAM
42783>>>                                    saverecord tempitem
42784>>>                                end
42784>>>>
42784>>>
42784>>>                            end
42784>>>>
42784>>>                            find gt pmovesl by index.3
42785>>>>
42785>>>                        Loop
42786>>>>
42786>>>                        add 1 to imet
42787>>>                        saverecord Tmppol
42788>>>                    find gt Psxetika by index.4
42789>>>>
42789>>>                Loop
42790>>>>
42790>>>
42790>>>                // œ›à œ®œ  › ˜£¦¨­àŸœå «¦ ˜¨®œ ¦ £œ œšš¨˜­œª 1 ¡˜  2
42790>>>                // 1 ˜¨® ¡ã œšš¨˜­ã ¡˜  2= «˜ ›ç¦ ¦®ã£˜«˜
42790>>>
42790>>>                clear tempitem
42791>>>                move '1' to tempitem.wcmove_status_e
42792>>>                find gt tempitem by index.4
42793>>>>
42793>>>                while ((found) and (tempitem.wcmove_status_e='1'))
42797>>>                    move tempitem.wcmove_qty to nqty
42798>>>                    move tempitem.witemx_code to sitem
42799>>>                    MOVE TEMPITEM.wcmove_qty_eisa to irecnum
42800>>>
42800>>>                    clear tempitel
42801>>>                    move '2' to tempitel.wcmove_status_e
42802>>>                    move sitem to tempitel.witemx_code
42803>>>                    move 0 to nhqty
42804>>>                    find gt tempitel by index.4
42805>>>>
42805>>>                    while ((found) and (tempitel.wcmove_status_e='2') and (sitem=tempitel.witemx_code))
42809>>>                        add tempitel.wcmove_qty to nhqty
42810>>>                        find gt tempitel by index.4
42811>>>>
42811>>>                    Loop
42812>>>>
42812>>>
42812>>>                    if  (nhqty=0) begin
42814>>>                    end
42814>>>>
42814>>>                    else begin
42815>>>                        move 0 to npartlfpa
42816>>>                        integer iTrecnum
42816>>>                        move 0 to itrecnum
42817>>>                        move (nqty-nhqty) to nqty
42818>>>                        clear tempitel
42819>>>                        move '2' to tempitel.wcmove_status_e
42820>>>                        move sitem to tempitel.witemx_code
42821>>>                        move 0 to nhqty
42822>>>                        move 0 to ino
42823>>>                        find gt tempitel by index.4
42824>>>>
42824>>>                        while ((found) and (tempitel.wcmove_status_e='2') and (sitem=tempitel.witemx_code))
42828>>>
42828>>>                            add 1 to ino
42829>>>                            clear tmppol
42830>>>                            move  irecnum to tmppol.recnum
42831>>>                            find eq tmppol.recnum
42832>>>>
42832>>>                            if (found) begin
42834>>>                                move 0 to tmppol.recnum
42835>>>                                if (ino=1) Move (tempitel.wcmove_qty+nqty)  to tmpPol.qty
42838>>>                                else       move tempitel.wcmove_qty         to tmpPol.qty
42840>>>                                Move (ROUnD_number((tmpPol.qty*tmppol.unitpr),2))  to tmppol.axia
42841>>>                                Move (ROUnD_number(((tmppol.axia*tmppol.fpa)/100),2))  to tmppol.posofpa
42842>>>                                move tempitel.item_code to tmppol.pinakida
42843>>>                                move tempitel.year_year to tmppol.antlhsh
42844>>>                                add 1 to imet
42845>>>                                saverecord tmppol
42846>>>                                add tmppol.posofpa to npartlfpa
42847>>>                                move tmppol.recnum to itrecnum
42848>>>                            end
42848>>>>
42848>>>                            find gt tempitel by index.4
42849>>>>
42849>>>
42849>>>                        Loop
42850>>>>
42850>>>                        clear tmplg
42851>>>                        move sitem to tmplg.company_code
42852>>>                        find ge tmplg by index.1
42853>>>>
42853>>>                        while ((found) and (tmplg.company_code=sitem))
42857>>>                            if (tmplg.gmove_x0 <> npartlfpa) begin
42859>>>                                clear tmppol
42860>>>                                move itrecnum to tmppol.recnum
42861>>>                                find eq tmppol.recnum
42862>>>>
42862>>>                                move (tmplg.gmove_x0-npartlfpa) to npartlfpa
42863>>>                                add npartlfpa to tmppol.posofpa
42864>>>                                saverecord tmppol
42865>>>                            end
42865>>>>
42865>>>                            find gt tmplg by index.1
42866>>>>
42866>>>                        Loop
42867>>>>
42867>>>                        clear tmppol
42868>>>                        move irecnum to tmppol.recnum
42869>>>                        find eq tmppol.recnum
42870>>>>
42870>>>                        if (found) begin
42872>>>                            delete tmppol
42873>>>                            sub 1 from imet
42874>>>                        end
42874>>>>
42874>>>                    end
42874>>>>
42874>>>                    find gt tempitem by index.4
42875>>>>
42875>>>                Loop
42876>>>>
42876>>>                nextpmovesd:
42876>>>                Set Label Of frmShow to ('à¢ã©œ ª' + '-' +string(particle.partl_hmnia)+'-'+String(particle.recnum))
42877>>>                if (ienhsap=1) begin
42879>>>                    move 0 to ienhsap
42880>>>                    clear clients
42881>>>                    move sclientid to clients.client_id
42882>>>                    find eq clients by index.6
42883>>>>
42883>>>                    if (found=1) begin
42885>>>                        move 1 to clients.client_public
42886>>>                        move dkenhdate to clients.sap_hmnia
42887>>>                        saverecord clients
42888>>>                        move 0 to ienhsap
42889>>>                    end
42889>>>>
42889>>>                end
42889>>>>
42889>>>                find gt Particle by 17
42890>>>>
42890>>>             Loop
42891>>>>
42891>>>
42891>>>             clear Tmppol
42892>>>             move 'FI2'                              to Tmppol.onoma
42893>>>             move '90'                               to Tmppol.typos
42894>>>             if (company.company_c_cod00<>'') move company.company_c_cod00  to Tmppol.etairia
42897>>>             else move 'idy1'                        to Tmppol.etairia
42899>>>             move '9999'                             to Tmppol.type
42900>>>             move '9999999999'                       to Tmppol.arithmos
42901>>>             move segkatastash                       to Tmppol.EGKATASTASH
42902>>>          //   move sPERIOXH                            to TmpPol.perioxh
42902>>>             move sTOMEAS                            to TmpPol.perioxh
42903>>>             move ntot                               to Tmppol.axia
42904>>>             move 'EUR'                              To Tmppol.nomisma
42905>>>             move dapod                               to Tmppol.hmnia
42906>>>             saverecord Tmppol
42907>>>             move 0                                  to Tmppol.recnum
42908>>>             move '91'                               to Tmppol.typos
42909>>>             move nfpa                               to Tmppol.axia
42910>>>             saverecord Tmppol
42911>>>             move 0                                  to Tmppol.recnum
42912>>>             move '92'                               to Tmppol.typos
42913>>>             move nnet                               to Tmppol.axia
42914>>>             saverecord Tmppol
42915>>>
42915>>>             move 0 to imet
42916>>>             clear tmppol
42917>>>             find gt tmppol.recnum
42918>>>>
42918>>>             while (found)
42922>>>                if ((tmppol.typos='01') or (tmppol.typos='03') or (tmppol.typos='05') or (tmppol.typos='06'));                    add 1 to imet
42925>>>                if (tmppol.typos='92') begin
42927>>>                    move 0                                  to Tmppol.recnum
42928>>>                    move '93'                               to Tmppol.typos
42929>>>                    move imet                               to Tmppol.axia
42930>>>                    move ''                                 to Tmppol.nomisma
42931>>>                    saverecord Tmppol
42932>>>                    goto next_loopd
42933>>>>
42933>>>                end
42933>>>>
42933>>>                IF (tmppol.typos='06') begin
42935>>>                   move tmppol.recnum to irecnum
42936>>>                   if (tmppol.sxrecr<>'') begin
42938>>>                       clear particle
42939>>>                       move tmppol.sxrecr to particle.partl_recr
42940>>>                       find eq particle by index.2
42941>>>>
42941>>>                       if (found) begin
42943>>>                            if (particle.ptyppar_code<>'099') begin
42945>>>                                delete tmppol
42946>>>                                sub 1 from imet
42947>>>                                clear tmppol
42948>>>                                move irecnum to tmppol.recnum
42949>>>                            end
42949>>>>
42949>>>                       end
42949>>>>
42949>>>                    end
42949>>>>
42949>>>                end
42949>>>>
42949>>>                find gt tmppol.recnum
42950>>>>
42950>>>             Loop
42951>>>>
42951>>>             next_loopd:
42951>>>        End_Procedure
42952>>>
42952>>>        Procedure enhmerose_apoth
42954>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo spinak
42955>>>             string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
42955>>>             STRING sLetter sEnglish sGreek sid spar msgstr
42955>>>
42955>>>             integer Imet Ikod Ino iLen iFirst iRecnum IINT ipos isygk
42955>>>             number  ntot nfpa nqty
42955>>>             date dapod ddate dhdate
42955>>>             Move 'ABCDEFGHIJKLMNOPRSTUVWXYZ' to sEnglish
42956>>>             Move '€–ƒ„”‚†ˆ‰Š‹ŒŽ‘’‡—‘•“…' to sGreek
42957>>>             get value of frmapo to dapod
42958>>>             move Sysfile.Client_Digits to Ikod
42959>>>             add 3 to ikod // gia na paroyme kai to AX ektos yomea
42960>>>             clear Company
42961>>>             move syscurxr.company_code to Company.company_code
42962>>>             find eq company by index.1
42963>>>>
42963>>>             move Company.company_c_code0 to stomeas
42964>>>             clear Wcmoves
42965>>>             find gt wcmoves by 16
42966>>>>
42966>>>             while ((found) and (wcmoves.sap_hmnia=''))
42970>>>                if  (wcmoves.wcmove_hmnia  > dapod);                    goto nextwcmovesd
42973>>>                if (syscurxr.company_code<>Wcmoves.company_code);                    goto nextwcmovesd
42976>>>                relate Wcmoves
42977>>>                if (Wcmoves.module_from<>'01');                    goto nextwcmovesd
42980>>>                if (Wapokat.OXIMM1='1') BEGIN
42982>>>                    goto nextwcmovesd
42983>>>>
42983>>>                END
42983>>>>
42983>>>                ELSE BEGIN
42984>>>                    if (Wapokat.enhm_sap<>'1');                        goto nextwcmovesd
42987>>>                end
42987>>>>
42987>>>                if ((Wcmoves.wcmove_qty_eisa=0) and (Wcmoves.wcmove_qty_exa=0));                    goto nextwcmovesd
42990>>>                if (Wtypkin.wtypkin_anti='');                    goto nextwcmovesd
42993>>>                move (trim(Wcmoves.client_id))          to scode
42994>>>                move Wcmoves.Wcmove_recr                to srecr
42995>>>                clear branch
42996>>>                move wcmoves.company_code to branch.company_code
42997>>>                move wcmoves.branch_code  to branch.branch_code
42998>>>                find eq branch by index.1
42999>>>>
42999>>>                move branch.PERIOXH        to segkatastash
43000>>>                clear Tmpapoth
43001>>>                move wtypkin.Wtypkin_anti               to Tmpapoth.type
43002>>>                move 'MM1'                              to Tmpapoth.onoma
43003>>>                move '01'                               to Tmpapoth.typos
43004>>>                move segkatastash                       to Tmpapoth.egkatastash
43005>>>                clear pmoves
43006>>>                move wcmoves.partl_recr to pmoves.pms_recr
43007>>>                find eq pmoves by index.2
43008>>>>
43008>>>                if (not(found)) begin
43010>>>                    move 'ƒœ¤ ™¨å©¡à recr ©ç¤›œ©žª £œ pmoves wcmoves.particle_recr = ' to msgstr
43011>>>                    append msgstr wcmoves.particle_recr
43012>>>                    error 4499 msgstr
43013>>>>
43013>>>                End
43013>>>>
43013>>>                move pmoves.custprom_code to tmpapoth.paralabh
43014>>>                move pmoves.pseira_seira to spar
43015>>>                append spar pmoves.partl_no
43016>>>                move spar                               to Tmpapoth.arithmos
43017>>>                MOVE '' TO SPINAK
43018>>>                Clear Cars
43019>>>                move (trim(pmoves.car_id))  to Cars.car_id
43020>>>                Find eq Cars by index.2
43021>>>>
43021>>>                Move (trim(Cars.Car_license)) to spinak
43022>>>                For iInt From 1 to (Length(spinak))
43028>>>>
43028>>>                    Move (Mid(spinak,1,iInt)) to sLetter
43029>>>                    If (sGREEK Contains sLetter) Begin
43031>>>                         Move (Pos(sLetter,sgreek)) to iPos
43032>>>                         Move (Replaces(sLetter,spinak,(Mid(senglish,1,iPos)))) to spinak
43033>>>                    End
43033>>>>
43033>>>                Loop
43034>>>>
43034>>>
43034>>>                move spinak                             to Tmpapoth.pinakida
43035>>>                move Wcmoves.Wcmove_hmnia               to Tmpapoth.hmnia
43036>>>                move wtypkin.Wtypkin_anti               to Tmpapoth.type
43037>>>
43037>>>                if (Wtypkin.wtypkin_anti='');                    goto nextwcmovesd
43040>>>                relate pmoves
43041>>>                if (particle.skopos_diakin='2');                    move 'Z17'                          to Tmpapoth.type
43044>>>                if (particle.skopos_diakin='3');                    move 'Z15'                          to Tmpapoth.type
43047>>>        //                if (clients.anal='1');
43047>>>        //                    move 1 to isygk
43047>>>        //                else;
43047>>>                move 0 to isygk
43048>>>        //                If (sysfile.company_name='1') move 0     to isygk
43048>>>                Move (Right(scode, Ikod))                To scode
43049>>>                move (replaces('.',scode,'')) to scode
43050>>>                insert '01' in scode at 1
43052>>>                if (Sysfile.Client_Digits<6);                    insert '0' in scode at 5
43056>>>                if (wcmoves.client_id='');                    move '' to scode
43059>>>                if (trim(scode)<>'') begin
43061>>>                    if (isygk=1) begin
43063>>>                        left scode to sid 4
43065>>>>
43065>>>                        append sid '999999'
43066>>>                        move (trim(sid)) to scode
43067>>>                    end
43067>>>>
43067>>>                end
43067>>>>
43067>>>
43067>>>                if ((tmpapoth.type='Z17') or (Tmpapoth.type='Z15'));                    move '' to scode
43070>>>                if ((tmpapoth.type='…17') or (Tmpapoth.type='…15'));                    move '' to scode
43073>>>                move (trim(scode))                      to Tmpapoth.code
43074>>>
43074>>>                move 'B'                                to sitem
43075>>>                if (wcmoves.wcmove_status_e=1);                    move 'G'                            to sti
43078>>>                else;                    move wapokat.sap_descr              to sti
43080>>>                if (trim(wapokat.sap_descr)='') begin
43082>>>                        move 'ƒœ¤ â®œ  ¦¨ ©Ÿœå ¦ ¡à› ¡æª SAP ©«ã¤ ‰˜«žš¦¨å˜ „å›¦¬ª ©«¦ §˜¨˜©«˜« ¡æ = ' to msgstr
43083>>>                        append msgstr tmpapoth.arithmos
43084>>>                        error 4488 msgstr
43085>>>>
43085>>>                End
43085>>>>
43085>>>                insert sti in sitem at 2
43087>>>                insert 'O' in sitem at 3
43089>>>                insert item.sap in sitem at 4
43091>>>                move sitem                              to Tmpapoth.item
43092>>>                if (wcmoves.wcmove_qty_eisa<> 0);                    move (ABS(wcmoves.wcmove_qty_eisa))        to Tmpapoth.qty
43095>>>                else;                    move (ABS(wcmoves.wcmove_qty_exa))         to Tmpapoth.qty
43097>>>                move UNITS.UNITS_DESCR                  to Tmpapoth.monada
43098>>>                saverecord Tmpapoth
43099>>>                add 1 to ino
43100>>>                add 1 to Imet
43101>>>                nextwcmovesd:
43101>>>                move (trim(wcmoves.wcmove_par)) to sno
43102>>>                Set Label Of frmShow to ('‰ ¤ã©œ ª €§¦Ÿã¡žª' + '-' + String(iMet)+'-'+String(sno))
43103>>>                find gt Wcmoves by 16
43104>>>>
43104>>>             Loop
43105>>>>
43105>>>             move 0                                  to Tmpapoth.recnum
43106>>>             move ''                                 to Tmpapoth.hmnia
43107>>>             move '90'                               to Tmpapoth.typos
43108>>>             move '9999999999'                       to Tmpapoth.arithmos
43109>>>             move ''                                 to tmpapoth.type
43110>>>             move imet                               to Tmpapoth.qty
43111>>>             move ''                                 to Tmpapoth.code
43112>>>             move ''                                 to Tmpapoth.item
43113>>>             move ''                                 to Tmpapoth.egkatastash
43114>>>             move ''                                 to Tmpapoth.monada
43115>>>             move ''                                 to Tmpapoth.paralabh
43116>>>             saverecord Tmpapoth
43117>>>             Send StartReport to Rapoth
43118>>>        End_Procedure
43119>>>
43119>>>        Procedure enhmerose_itemtehn
43121>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo
43122>>>             string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
43122>>>             integer Imet Ikod Ino iLen iFirst iRecnum
43122>>>             number  ntot nfpa nqty
43122>>>             date dapod
43122>>>             get value of frmapo to dapod
43123>>>
43123>>>             clear Company
43124>>>             move syscurxr.company_code to Company.company_code
43125>>>             find eq company by index.1
43126>>>>
43126>>>             move Company.company_c_code0 to stomeas
43127>>>
43127>>>             clear itemtehn
43128>>>             find gt itemtehn by index.4
43129>>>>
43129>>>             while ((found) and (itemtehn.sap_hmnia=''))
43133>>>                if  (itemtehn.hmnia  > dapod);                    goto nextitemtehnd
43136>>>                if (syscurxr.company_code<>itemtehn.company);                    goto nextitemtehnd
43139>>>
43139>>>                relate itemtehn
43140>>>
43140>>>                clear branch
43141>>>                move itemtehn.company to branch.company_code
43142>>>                move itemtehn.branch  to branch.branch_code
43143>>>                find eq branch by index.1
43144>>>>
43144>>>                move branch.PERIOXH        to segkatastash
43145>>>
43145>>>                clear Tmptehn
43146>>>                move 'PP1'                              to Tmptehn.onoma
43147>>>                move '09'                               to Tmptehn.typos
43148>>>                move segkatastash                       to Tmptehn.egkatastash
43149>>>                move itemtehn.hmnia                     to Tmptehn.hmnia
43150>>>                move 'B'                                to sitem
43151>>>
43151>>>                clear wapokat
43152>>>                move item.wapokat_code to wapokat.wapokat_code
43153>>>                find eq wapokat by index.1
43154>>>>
43154>>>                move wapokat.sap_descr                  to sti
43155>>>                insert sti in sitem at 2
43157>>>                insert 'O' in sitem at 3
43159>>>                insert itemtehn.item_code in sitem at 4
43161>>>                move sitem                              to Tmptehn.item
43162>>>                move itemtehn.code                      to tmptehn.prodiagrafh
43163>>>                move UNITS.UNITS_DESCR                  to Tmptehn.mm
43164>>>                move '1'                                to tmptehn.type
43165>>>
43165>>>                clear itemd
43166>>>                move itemtehn.recr to srecr
43167>>>                move 0 to Ino
43168>>>                move srecr to itemd.itemtehn_recr
43169>>>                find gt itemd by index.5
43170>>>>
43170>>>                while ((found) and (itemd.itemtehn_recr=srecr))
43174>>>                    add 1 to ifirst
43175>>>                    add 1 to ino
43176>>>                    if (ino>1) begin
43178>>>                        move 0 to tmptehn.recnum
43179>>>                        saverecord tmptehn
43180>>>                    end
43180>>>>
43180>>>                    clear iteml
43181>>>                    move itemd.itemd_code to iteml.item_code
43182>>>                    find eq iteml by index.5
43183>>>>
43183>>>                    clear wapokat
43184>>>                    move iteml.wapokat_code to wapokat.wapokat_code
43185>>>                    find eq wapokat by index.1
43186>>>>
43186>>>                    clear units
43187>>>                    move iteml.units_code to units.units_code
43188>>>                    find eq units by index.1
43189>>>>
43189>>>                    move 'B'                                to sitem
43190>>>                    move wapokat.sap_descr                  to sti
43191>>>                    insert sti in sitem at 2
43193>>>                    insert 'O' in sitem at 3
43195>>>                    insert itemd.itemd_code in sitem at 4
43197>>>                    move sitem                              to Tmptehn.itemd
43198>>>                    move units.units_descr                  to Tmptehn.mmitemd
43199>>>                    move itemd.itemd_qty                    to Tmptehn.qty
43200>>>                    move ino                                to tmptehn.aa
43201>>>                    move itemd.sap_aa                       to sno
43202>>>                    move sno                                to Tmptehn.index
43203>>>                    saverecord Tmptehn
43204>>>                    move (trim(itemd.itemtehn_code)) to sno
43205>>>                    move itemd.recnum to imet
43206>>>                    Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(iMet)+'-'+String(sno))
43207>>>                    find gt itemd by index.5
43208>>>>
43208>>>                Loop
43209>>>>
43209>>>                nextitemtehnd:
43209>>>                move (trim(itemd.itemtehn_code)) to sno
43210>>>                move itemd.recnum to imet
43211>>>                Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(iMet)+'-'+String(sno))
43212>>>                find gt itemtehn by index.4
43213>>>>
43213>>>            Loop
43214>>>>
43214>>>            move 0                                  to Tmptehn.recnum
43215>>>            move '90'                               to Tmptehn.typos
43216>>>            move ifirst                             to Tmptehn.type
43217>>>            move ''                                 to Tmptehn.item
43218>>>            move ''                                 to Tmptehn.prodiagrafh
43219>>>            move ''                                 to Tmptehn.mm
43220>>>            move ''                                 to Tmptehn.egkatastash
43221>>>            move ''                                 to Tmptehn.itemd
43222>>>            move 0                                  to Tmptehn.aa
43223>>>            move ''                                 to Tmptehn.mmitemd
43224>>>            move 0                                  to Tmptehn.index
43225>>>            move 0                                  to Tmptehn.qty
43226>>>            saverecord Tmptehn
43227>>>        End_Procedure
43228>>>
43228>>>        Procedure enhmerose_anal
43230>>>             string srecr scode sstr sperioxh segkatastash stype shmnia sper sposo snext
43231>>>             string stomeas soroi swcmoves sno sitem sti shegkatastash shtype shitem
43231>>>             string seidos
43231>>>             integer Imet Ikod Ino itot iFirst iRecnum Icount ifound
43231>>>             number  ntot nfpa nqty
43231>>>             date dapod ddate
43231>>>             move '27/04/2005' to ddate
43232>>>             string stexnikh  msgstr
43232>>>             get value of frmapo to dapod
43233>>>
43233>>>            Integer isChecked
43233>>>            Get Checked_State Of ChkLog to isChecked
43234>>>
43234>>>            Erasefile "C:\Analoseis.txt"
43235>>>>
43235>>>
43235>>>            If (isChecked) Direct_Output Channel 8 "C:\Analoseis.txt"
43239>>>
43239>>>             clear Company
43240>>>             move syscurxr.company_code to Company.company_code
43241>>>             find eq company by index.1
43242>>>>
43242>>>             move Company.company_c_code0 to stomeas
43243>>>
43243>>>
43243>>>             String sWitemxTR_Recr sWitemxTD_Recr
43243>>>             Date   dWitemxTR_Hmnia
43243>>>
43243>>>             Move "" to sWitemxTR_Recr
43244>>>             Move "" to sWitemxTD_Recr
43245>>>             Move "" to dWitemxTR_Hmnia
43246>>>
43246>>>             clear witemxtr
43247>>>             find gt witemxtr by index.4
43248>>>>
43248>>>             while ((found) and (witemxtr.sap_hmnia=''))
43252>>>
43252>>>                Move WitemxTR.Recr  to sWitemxTR_Recr
43253>>>                Move WitemxTR.Hmnia to dWitemxTR_Hmnia
43254>>>
43254>>>                If (isChecked) Write    Channel 8 "WitemTR Recr="
43258>>>                If (isChecked) Write    Channel 8 (Trim(sWitemxTR_Recr))
43262>>>                If (isChecked) Write    Channel 8 "   WitemTR Hmnia="
43266>>>                If (isChecked) Write    Channel 8 (Trim(dWitemxTR_Hmnia))
43270>>>                If (isChecked) Write    Channel 8 "   WitemTR Code="
43274>>>                If (isChecked) Write    Channel 8 (Trim(WitemxTR.Code))
43278>>>                If (isChecked) Writeln  Channel 8
43282>>>
43282>>>                if  (witemxtr.hmnia  > dapod)                       goto nextanald
43285>>>                if (syscurxr.company_code<>witemxtr.company_code)   goto nextanald
43288>>>
43288>>>                move witemxtr.recr to srecr
43289>>>                move '' to snext
43290>>>                move '' to stexnikh
43291>>>
43291>>>                clear witemxtd
43292>>>                move srecr to witemxtd.witemxtr_recr
43293>>>                find gt witemxtd by index.1
43294>>>>
43294>>>                while ((found) and (witemxtd.witemxtr_recr=srecr))
43298>>>
43298>>>                    clear branch
43299>>>                    move witemxtr.company_code to branch.company_code
43300>>>                    move witemxtr.branch_code  to branch.branch_code
43301>>>                    find eq branch by index.1
43302>>>>
43302>>>                    move branch.PERIOXH                 to segkatastash
43303>>>
43303>>>                    clear Tmpanal
43304>>>                    move 'PP2'                              to Tmpanal.onoma
43305>>>                    move '09'                               to Tmpanal.typos
43306>>>                    move segkatastash                       to Tmpanal.egkatastash
43307>>>                    move witemxtr.hmnia                     to Tmpanal.hmnia
43308>>>                    move 'B'                                to sitem
43309>>>                    move witemxtd.witemx_code               to shitem
43310>>>
43310>>>                    clear iteml
43311>>>                    move shitem to iteml.item_code
43312>>>                    find eq iteml by index.5
43313>>>>
43313>>>
43313>>>                    clear units
43314>>>                    move iteml.units_code to units.units_code
43315>>>                    find eq units by index.1
43316>>>>
43316>>>                    move UNITS.UNITS_DESCR                  to Tmpanal.mm
43317>>>
43317>>>                    clear wapokat
43318>>>                    move iteml.wapokat_code to wapokat.wapokat_code
43319>>>                    find eq wapokat by index.1
43320>>>>
43320>>>                    move wapokat.sap_descr                  to sti
43321>>>
43321>>>                    insert sti in sitem at 2
43323>>>                    insert 'O' in sitem at 3
43325>>>                    insert shitem in sitem at 4
43327>>>                    move 0 to Ino
43328>>>                    move 0 to icount
43329>>>                    move sitem                              to Tmpanal.item
43330>>>        //            move sitem                              to seidos
43330>>>
43330>>>                If (isChecked) Write    Channel 8 "      >>>>    WitemTR Item="
43334>>>                If (isChecked) Write    Channel 8 (Trim(shitem))
43338>>>                If (isChecked) Write    Channel 8 "  " (Trim(sitem))
43343>>>                If (isChecked) Writeln  Channel 8
43347>>>
43347>>>                If (isChecked) Write    Channel 8 "      >>>>    Entolh Recr="
43351>>>                If (isChecked) Write    Channel 8 (Trim(srecr))
43355>>>                If (isChecked) Write    Channel 8 "      >>>>    Eidos="
43359>>>                If (isChecked) Write    Channel 8 (Trim(witemxtd.witemx_code ))
43363>>>                If (isChecked) Write    Channel 8 "      >>>>    Cartp (fpa_from)="
43367>>>                If (isChecked) Write    Channel 8 (Trim(witemxtd.fpa_from ))
43371>>>                If (isChecked) Write    Channel 8 "      >>>>    Texxnikh="
43375>>>                If (isChecked) Write    Channel 8 (Trim(witemxtd.texnikh))
43379>>>                If (isChecked) Writeln  Channel 8
43383>>>
43383>>>                    clear anprod
43384>>>                    move srecr                      to anprod.entolh_recr
43385>>>                    move witemxtd.witemx_code       to anprod.anprod_form
43386>>>                    move witemxtd.fpa_from          to anprod.anprod_cartp
43387>>>                    move witemxtd.texnikh           to anprod.anprod_itemtn
43388>>>
43388>>>                    find gt anprod by index.4
43389>>>>
43389>>>
43389>>>                    while ((found) and ;                          (anprod.entolh_recr   = srecr)                and;                          (witemxtd.witemx_code = anprod.anprod_form)   and;                          (witemxtd.fpa_from    = anprod.anprod_cartp)  and;                          (witemxtd.texnikh     = anprod.anprod_itemtn))
43393>>>
43393>>>                        add 1 to icount
43394>>>
43394>>>                        If (isChecked) Write    Channel 8 "             >>>>    Anprod FOUND"
43398>>>                        If (isChecked) Writeln  Channel 8
43402>>>
43402>>>                        if (sperioxh<>anprod.anprod_itemtn) begin
43404>>>                            move 0 to ino
43405>>>                            move 0 to ikod
43406>>>                            move anprod.anprod_itemtn to sperioxh
43407>>>                            move 0 to tmpanal.recnum
43408>>>                            saverecord tmpanal
43409>>>                        end
43409>>>>
43409>>>                        add 1 to ifirst
43410>>>                        add 1 to ino
43411>>>
43411>>>                        if ((ino>1) and (ikod=0)) begin
43413>>>                            move 0 to tmpanal.recnum
43414>>>                            saverecord tmpanal
43415>>>                        end
43415>>>>
43415>>>
43415>>>                        move anprod.anprod_itemtn to Tmpanal.prodiagrafh
43416>>>                        clear iteml
43417>>>                        move anprod.anprod_item to iteml.item_code
43418>>>                        find eq iteml by index.5
43419>>>>
43419>>>
43419>>>                        // -----------------------------------------------------------------------------------------------------
43419>>>                        // Prosthiki 25/06/2013 Xrhsh tou pediou Company.Company_FAX
43419>>>                        // An einai 1 (kai mono 1) tote o elegxos parakamptetai
43419>>>                        Clear Company
43420>>>                        Move SyscurXr.Company_Code to Company.Company_Code
43421>>>                        Find Eq Company By Index.1
43422>>>>
43422>>>                        If (Trim(Company.Company_FAX)<>'1') Begin
43424>>>                            // -----------------------------------------------------------------------------------------------------
43424>>>                            // -----------------------------------------------------------------------------------------------------
43424>>>                            // Allagh 16/04/2013 + Elegxos an pragmatika exei anoixtei Texnikh prodiagrafh gia to eidos ayto
43424>>>                            //                   + Elegxos an yparxei kai h proth ylh sthn texnikh prodiagrafh kai eidos (syntheto) ayto
43424>>>                            // -----------------------------------------------------------------------------------------------------
43424>>>                            Clear Itemtehn
43425>>>                            Move SysCurXr.Company_Code  to ItemTehn.Company
43426>>>
43426>>>                            // Allagh 31/05/2013, xtypaei sthn Koritho giati h T.P.
43426>>>                            // einai apo allo ypokatasthma kai oxi apo ayto poy mpainoyume
43426>>>                            ////////////// Move SysCurXr.Branch_Code   to ItemTehn.Branch
43426>>>                            String sBr
43426>>>                            Move (Trim(Anprod.Anprod_Site)) to sBr
43427>>>                            Move (Replaces(".",sBr,""))     to sBr
43428>>>                            Move (Trim(sBr))                to ItemTehn.Branch
43429>>>                            Move anprod.anprod_itemtn       to Itemtehn.Code
43430>>>                            Move anprod.anprod_form         to Itemtehn.item_code
43431>>>                            Find Eq Itemtehn By Index.1
43432>>>>
43432>>>                            If (Not(Found)) Begin
43434>>>                                move "ƒœ¤ ¬§á¨®œ  ’œ®¤ ¡ã ¨¦› ˜š¨˜­ã (ã „å›¦ª) " to msgstr
43435>>>                                append msgstr "©«¦ ¬§¦¡˜«á©«ž£˜ '" (Trim(sBR)) "'\n"
43438>>>                                append msgstr "‚ ˜ ’œ®.¨¦›=" (Trim(anprod.anprod_itemtn)) "  & „å›¦ª=" (Trim(anprod.anprod_form))
43442>>>                                error 6660 msgstr
43443>>>>
43443>>>                            End
43443>>>>
43443>>>
43443>>>                            Clear Itemd
43444>>>                            Move SysCurXr.Company_Code  to Itemd.Company
43445>>>                            // Allagh 31/05/2013, xtypaei sthn Koritho giati h T.P.
43445>>>                            // einai apo allo ypokatasthma kai oxi apo ayto poy mpainoyume
43445>>>                            ////////Move SysCurXr.Branch_Code   to Itemd.Branch
43445>>>                            Move (Trim(sBr))            to Itemd.Branch
43446>>>
43446>>>                            Move anprod.anprod_itemtn   to Itemd.ItemTehn_Code
43447>>>                            Move anprod.anprod_form     to Itemd.item_code
43448>>>                            Move anprod.anprod_item     to Itemd.itemd_code
43449>>>                            Find Eq Itemd By Index.1
43450>>>>
43450>>>
43450>>>                            If (Not(Found)) Begin
43452>>>                                move ("ƒœ¤ ¬§á¨®œ  ž §¨é«ž ç¢ž  (Itemd)="+Trim(anprod.anprod_item)+"\n") to msgstr
43453>>>                                append msgstr "©«ž¤ ’œ®.¨¦›=" (Trim(anprod.anprod_itemtn)) "  & „å›¦ª=" (Trim(anprod.anprod_form)) "  “§¦¡=" (Trim(sBr))
43459>>>                                error 6661 msgstr
43460>>>>
43460>>>                            End
43460>>>>
43460>>>                            // -----------------------------------------------------------------------------------------------------
43460>>>                            // -----------------------------------------------------------------------------------------------------
43460>>>                        End // If (Trim(Company.Company_FAX)<>'1') Begin
43460>>>>
43460>>>                        // -----------------------------------------------------------------------------------------------------
43460>>>                        // Prosthiki 25/06/2013 Xrhsh tou pediou Company.Company_FAX
43460>>>                        // An einai 1 (kai mono 1) tote o elegxos parakamptetai
43460>>>                        // -----------------------------------------------------------------------------------------------------
43460>>>                        // -----------------------------------------------------------------------------------------------------
43460>>>                        clear wapokat
43461>>>                        move iteml.wapokat_code to wapokat.wapokat_code
43462>>>                        find eq wapokat by index.1
43463>>>>
43463>>>                        clear units
43464>>>                        move iteml.units_code to units.units_code
43465>>>                        find eq units by index.1
43466>>>>
43466>>>                        move 'B'                                to sitem
43467>>>                        move wapokat.sap_descr                  to sti
43468>>>                        insert sti in sitem at 2
43470>>>                        insert 'O' in sitem at 3
43472>>>                        insert anprod.anprod_item in sitem at 4
43474>>>                        move sitem                              to Tmpanal.itemd
43475>>>                        move units.units_descr                  to Tmpanal.mmitemd
43476>>>
43476>>>                        // -----------------------------------------------------------------------------------------------------
43476>>>                        // Allagh 21/02/2012 -  Emfanisthke mia posothta analoshs me 4 dekadika ta opoia perasan os exoun
43476>>>                        //                      Ayto eixe san apotelesma na perasei posothta 541.699 anti gia 54.1699
43476>>>                        //                      mias kai pername mono 3 dekadika opote perasame ta 3 teleytaia (699) kai
43476>>>                        //                      to akeraio meros ths posothtas egine 541 anti gia 54.
43476>>>                        //move witemxtd.qty_from                  to Tmpanal.qty
43476>>>                        move (Round_Number(witemxtd.qty_from,3))  to Tmpanal.qty
43477>>>                        // -----------------------------------------------------------------------------------------------------
43477>>>
43477>>>                        move anprod.anprod_qty                  to tmpanal.posoths
43478>>>                        move anprod.anprod_cartp                to Tmpanal.trmetaf
43479>>>                        move ino                                to tmpanal.aa
43480>>>
43480>>>        //               integer iok
43480>>>        //               move 0 to iok
43480>>>        //               clear tmpanala
43480>>>        //               move witemxtr.hmnia to tmpanala.hmnia
43480>>>        //
43480>>>        //               move '09' to tmpanala.typos
43480>>>        //               move segkatastash to tmpanala.egkatastash
43480>>>        //               move witemxtd.witemx_code to tmpanala.item
43480>>>        //               move anprod.anprod_cartp   to tmpanala.trmetaf
43480>>>        //               move anprod.anprod_itemtn to Tmpanala.prodiagrafh
43480>>>        //               find gt tmpanala by index.5
43480>>>        //               while ((found) and (tmpanala.hmnia=witemxtr.hmnia)          and;
43480>>>        //                                 (tmpanala.typos='09')                     and;
43480>>>        //                                 (tmpanala.egkatastash=segkatastash)       and;
43480>>>        //                                 (tmpanala.item=seidos)                    and;
43480>>>        //                                 (tmpanala.trmetaf=anprod.anprod_cartp)    and;
43480>>>        //                                 (anprod.anprod_itemtn=Tmpanala.prodiagrafh))
43480>>>        //                   move 1 to iok
43480>>>        //                   if (tmpanala.itemd=sitem) begin
43480>>>        //                       add anprod.anprod_qty to tmpanal.posoths
43480>>>        //                       sub 1 from ino
43480>>>        //                       saverecord tmpanal
43480>>>        //                   end
43480>>>        //                   else begin
43480>>>        //                       move anprod.entolh_recr                 to Tmpanal.product
43480>>>        //                       saverecord Tmpanal
43480>>>        //                   end
43480>>>        //                   find gt tmpanal by index.5
43480>>>        //               Loop
43480>>>        //               if (iok=0) begin
43480>>>        //                  move anprod.entolh_recr to Tmpanal.product
43480>>>        //                  saverecord tmpanal
43480>>>        //               end
43480>>>                        move anprod.entolh_recr to Tmpanal.product
43481>>>                        saverecord tmpanal
43482>>>                        move (trim(anprod.anprod_item)) to sno
43483>>>                        move itemd.recnum to imet
43484>>>                        Set Label Of frmShow to ('†£œ¨ã© œª ‰˜«˜¤˜¢é©œ ª' + '-' + String(iMet)+'-'+String(sno))
43485>>>                        find gt anprod by index.4
43486>>>>
43486>>>                    Loop
43487>>>>
43487>>>
43487>>>                    if (icount=0) begin
43489>>>                        If (isChecked) Begin
43491>>>                            Handle hWnd hInstance
43491>>>                            Close_Output Channel 8
43493>>>                            Get Window_Handle To hWnd
43494>>>                            Move (ShellExecute (hWnd, "open", (Trim ("Analoseis.txt")), '', (Trim("C:\")), 1)) to hInstance
43495>>>                        End
43495>>>>
43495>>>                        move 'ƒœ¤ ™¨âŸž¡˜¤ €¤˜¢é©œ ª ©«¦ „å›¦ª = ' to msgstr
43496>>>                        append msgstr witemxtd.witemx_code
43497>>>                        append msgstr ' ’. = '
43498>>>                        APPEND msgstr witemxtd.texnikh
43499>>>                        append msgstr ' “§¦¡˜« = '
43500>>>                        append msgstr witemxtr.branch_code
43501>>>                        APPEND msgstr "   WitemxTD Recr=" (Trim(witemxtd.Recr)) "   WitemxTR Recr=" (Trim(witemxtr.Recr))
43505>>>                        error 3691 msgstr
43506>>>>
43506>>>                    End
43506>>>>
43506>>>                    find gt witemxtd by index.1
43507>>>>
43507>>>                Loop
43508>>>>
43508>>>                nextanald:
43508>>>                move (trim(anprod.anprod_item)) to sno
43509>>>                move anprod.recnum to imet
43510>>>                Set Label Of frmShow to ('†£œ¨ã© œª ‰˜«˜¤˜¢é©œ ª' + '-' + String(iMet)+'-'+String(sno))
43511>>>                find gt witemxtr by index.4
43512>>>>
43512>>>             Loop
43513>>>>
43513>>>             If (isChecked) Begin
43515>>>                 Close_Output Channel 8
43517>>>                 Erasefile "C:\Analoseis.txt"
43518>>>>
43518>>>             End
43518>>>>
43518>>>             Send StartReport to Ranald
43519>>>             Send StartReport to Ranal90
43520>>>             Send StartReport to Ranal
43521>>>        End_Procedure
43522>>>
43522>>>        procedure check_the_records
43524>>>            number nfpa nfpatot
43525>>>            integer iint
43525>>>            move 0 to iint
43526>>>            clear tmppol
43527>>>            find gt tmppol by index.1
43528>>>>
43528>>>            while (found)
43532>>>               if (tmppol.typos='01');                     move 0 to nfpa
43535>>>               if (tmppol.typos='03');                    add tmppol.posofpa to nfpa
43538>>>               if (tmppol.typos='05') begin
43540>>>                    move (abs(nfpa-tmppol.axia)) to nfpatot
43541>>>                    if (nfpatot > 1) move 1 to iint
43544>>>               end
43544>>>>
43544>>>               Set Label Of frmShow to ('„¢œš®¦ª à¢ã©œà¤' + '-' +String(Tmppol.arithmos))
43545>>>
43545>>>               find gt tmppol by index.1
43546>>>>
43546>>>            Loop
43547>>>>
43547>>>            //if (iint=1) ;
43547>>>            //   send info_box 'Ž‘Ž•† ˆ‡€ŒŽ ‘”€Š‹€ ‘’Ž €•„ˆŽ FI2. „Š„‚’„ ’Ž ”€ ‘’ˆ‘ „‰’“—‘„ˆ‘ —Š†‘„—Œ' 'Š†Ž”Žˆ€'
43547>>>
43547>>>        end_procedure
43548>>>
43548>>>
43548>>>        //AB-StoreEnd
43548>>>
43548>>>    End_Object    // btnMetasx
43549>>>
43549>>>    Object btnekt is a ButtonSub
43551>>>        Set Label to "ButtonSub1"
43552>>>        Set Bitmap to "printer.bmp"
43553>>>        Set Size to 21 24
43554>>>        Set Location to 202 11
43555>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43556>>>
43556>>>        //AB-StoreStart
43556>>>        Set TooltipValue to "„¡«ç§à©ž ¡ ¤ã©œà¤ §¨¦ª „¢œš®¦ ! "
43557>>>        Procedure OnClick
43559>>>            date dapod
43560>>>            get value of frmapo to dapod
43561>>>            set pddate of rclsap to dapod
43562>>>            set piti of rclsap to (piepil(self))
43563>>>
43563>>>            Send runprom1Report to (prom1WQLReport(rclsap(Self)))
43564>>>        End_Procedure // OnClick
43565>>>
43565>>>
43565>>>
43565>>>        //AB-StoreEnd
43565>>>
43565>>>    End_Object    // btnekt
43566>>>
43566>>>    Object frmShow is a ButtonSub
43568>>>        Set Size to 14 207
43569>>>        Set Location to 146 116
43570>>>        Set Border_Style to Border_StaticEdge
43571>>>        Set Focus_Mode to Pointer_Only
43572>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43573>>>
43573>>>        //AB-StoreStart
43573>>>        Procedure OnClick
43575>>>
43575>>>        End_Procedure // OnClick
43576>>>        //AB-StoreEnd
43576>>>
43576>>>    End_Object    // frmShow
43577>>>
43577>>>    Object ButtonSub1 is a ButtonSub
43579>>>
43579>>>        //AB-StoreTopStart
43579>>>
43579>>>        Property String psPath Public ""
43581>>>
43581>>>        //AB-StoreTopEnd
43581>>>
43581>>>        Set Label to "ButtonSub1"
43582>>>        Set Bitmap to "AutoCopen.bmp"
43583>>>        Set Size to 21 24
43584>>>        Set Location to 204 363
43585>>>        Set Focus_Mode to Pointer_Only
43586>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
43587>>>
43587>>>        //AB-StoreStart
43587>>>
43587>>>        Set TooltipValue to '„¥˜šàšã ©«¦ ˜¨®œå¦'
43588>>>
43588>>>        Function Verify_Ascii Integer aiFlag Returns Integer
43590>>>            Number  nPoso
43591>>>            Integer iDecs iLen iInt Imet iNum FileSize rVal iMhnas iEtos iHmera
43591>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas sStr
43591>>>            Date    dapod deosd dhmnia
43591>>>
43591>>>            Move 0 to iNum
43592>>>
43592>>>            Get value of frmapo item 0      to dapod
43593>>>            clear Company
43594>>>            move syscurxr.company_code      to Company.company_code
43595>>>            find eq company by index.1
43596>>>>
43596>>>            move Company.company_c_code0    to stomeas
43597>>>            Move (TheDaySegment  (dapod))   to iHmera
43598>>>            Move (TheMonthSegment(dapod))   to iMhnas
43599>>>            Move (TheYearSegment(dapod))    to ietos
43600>>>            Move iHmera                     to sHmera
43601>>>            Move iMhnas                     to sMhnas
43602>>>            Move iEtos                      to sEtos
43603>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
43607>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
43611>>>
43611>>>            If aiFlag Eq 1 Begin
43613>>>                Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt')   to sFileName
43614>>>
43614>>>
43614>>>                //Showln (String (aiFlag)) "  " (Trim(sFileName))
43614>>>
43614>>>                File_Size tmpclsap          to FileSize
43617>>>
43617>>>                Direct_Input Channel 9 sFileName
43619>>>                Readln Channel 9 sStr
43621>>>                While (Not(Seqeof))
43625>>>                    Add 1 to iNum
43626>>>                    Readln Channel 9 sStr
43628>>>                Loop
43629>>>>
43629>>>                Close_Input Channel 9
43631>>>                Function_Return (iNum=FileSize)
43632>>>
43632>>>            End
43632>>>>
43632>>>            Else If aiFlag Eq 2 Begin
43635>>>                Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
43636>>>
43636>>>                //Showln (String (aiFlag)) "  " (Trim(sFileName))
43636>>>
43636>>>                File_Size TmpPol          to FileSize
43639>>>
43639>>>                Direct_Input Channel 9 sFileName
43641>>>                Readln Channel 9 sStr
43643>>>                While (Not(Seqeof))
43647>>>                    Add 1 to iNum
43648>>>                    Readln Channel 9 sStr
43650>>>                Loop
43651>>>>
43651>>>                Close_Input Channel 9
43653>>>                Function_Return (iNum=FileSize)
43654>>>            End
43654>>>>
43654>>>            Else If aiFlag Eq 3 Begin
43657>>>                Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
43658>>>
43658>>>                //Showln (String (aiFlag)) "  " (Trim(sFileName))
43658>>>
43658>>>                File_Size tmpAxio         to FileSize
43661>>>
43661>>>                Direct_Input Channel 9 sFileName
43663>>>                Readln Channel 9 sStr
43665>>>                While (Not(Seqeof))
43669>>>                    Add 1 to iNum
43670>>>                    Readln Channel 9 sStr
43672>>>                Loop
43673>>>>
43673>>>                Close_Input Channel 9
43675>>>                Function_Return (iNum=FileSize)
43676>>>            End
43676>>>>
43676>>>            Else If aiFlag Eq 4 Begin
43679>>>                Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
43680>>>
43680>>>                //Showln (String (aiFlag)) "  " (Trim(sFileName))
43680>>>
43680>>>                File_Size Tmpapoth        to FileSize
43683>>>
43683>>>                Direct_Input Channel 9 sFileName
43685>>>                Readln Channel 9 sStr
43687>>>                While (Not(Seqeof))
43691>>>                    Add 1 to iNum
43692>>>                    Readln Channel 9 sStr
43694>>>                Loop
43695>>>>
43695>>>                Close_Input Channel 9
43697>>>                Function_Return (iNum=FileSize)
43698>>>            End
43698>>>>
43698>>>            Else If aiFlag Eq 5 Begin
43701>>>                Move (psPath(Self)+Trim(stomeas)+'PP1'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
43702>>>
43702>>>                //Showln (String (aiFlag)) "  " (Trim(sFileName))
43702>>>
43702>>>                File_Size Tmptehn         to FileSize
43705>>>
43705>>>                Direct_Input Channel 9 sFileName
43707>>>                Readln Channel 9 sStr
43709>>>                While (Not(Seqeof))
43713>>>                    Add 1 to iNum
43714>>>                    Readln Channel 9 sStr
43716>>>                Loop
43717>>>>
43717>>>                Close_Input Channel 9
43719>>>                Function_Return (iNum=FileSize)
43720>>>            End
43720>>>>
43720>>>            Else If aiFlag Eq 6 Begin
43723>>>                Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas);                    +Trim(sHmera)+'.txt') to sFileName
43724>>>
43724>>>                //Showln (String (aiFlag)) "  " (Trim(sFileName))
43724>>>
43724>>>                File_Size TmpAnal         to FileSize
43727>>>
43727>>>                Direct_Input Channel 9 sFileName
43729>>>                Readln Channel 9 sStr
43731>>>                While (Not(Seqeof))
43735>>>                    Add 1 to iNum
43736>>>                    Readln Channel 9 sStr
43738>>>                Loop
43739>>>>
43739>>>                Close_Input Channel 9
43741>>>                Function_Return (iNum=FileSize)
43742>>>            End
43742>>>>
43742>>>            Function_Return 1
43743>>>        End_function
43744>>>
43744>>>
43744>>>        // Grapsimo ton records
43744>>>        // na arxeio xexoristo ana hmera
43744>>>        // me onoma xxxxzzzyyyymmhh opou xxxx=Branch.code zzz onoma arxeioy
43744>>>        // yyyymmhh etos-mhnas-mera eggrafon
43744>>>        Procedure Write_Record_Pel
43746>>>            Number  nPoso
43747>>>            Integer iDecs iLen iInt Imet Inum  isChecked
43747>>>            Integer rVal iMhnas iEtos iHmera
43747>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas  lsTheAppPath
43747>>>            String sstr scodem  skeno
43747>>>            Date    dapod deosd dhmnia
43747>>>            Get value of frmapo item 0 to dapod
43748>>>         //   Get value of frmeos item 0 to deosd
43748>>>
43748>>>            Set Label Of frmShow to ''
43749>>>            clear Company
43750>>>            move syscurxr.company_code to Company.company_code
43751>>>            find eq company by index.1
43752>>>>
43752>>>            move Company.company_c_code0 to stomeas
43753>>>
43753>>>        //    move syscurxr.branch_code      to sbranch
43753>>>            Move (TheDaySegment  (dapod))   to iHmera
43754>>>            Move (TheMonthSegment(dapod))   to iMhnas
43755>>>            Move (TheYearSegment (dapod))   to ietos
43756>>>            Move iHmera                     to sHmera
43757>>>            Move iMhnas                     to sMhnas
43758>>>            Move iEtos                      to sEtos
43759>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
43763>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
43767>>>
43767>>>            Move (psPath(Self)+Trim(stomeas)+'FI1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
43768>>>
43768>>>            // Yannis 25/11/2013
43768>>>            //SHowln (Trim(psPath(Self))) " " (Trim(stomeas)) " " ('FI1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') " = "  sFileName
43768>>>
43768>>>            EraseFile sFileName
43769>>>>
43769>>>            Append_Output Channel 9 sFileName
43771>>>
43771>>>            clear tmpclsap
43772>>>            find gt tmpclsap.recnum
43773>>>>
43773>>>            while (found)
43777>>>                Write   Channel 9 (Pad(Trim(tmpclsap.onoma)                ,  3))
43779>>>                move tmpclsap.typos to sposo
43780>>>                Write   Channel 9 (Pad(sposo                               ,  2))
43782>>>                Write   Channel 9 (Pad(tmpclsap.etairia                    ,  4))
43784>>>                Write   Channel 9 (Pad(tmpclsap.branch_site                ,  4))
43786>>>                Write   Channel 9 (Pad(tmpclsap.type                       ,  1))
43788>>>                Write   Channel 9 (Pad(tmpclsap.code                       , 10))
43790>>>                move    tmpclsap.code to sid
43791>>>                move syscurxr.company_code to scomp
43792>>>                insert '.' in scomp at 3
43794>>>                Write   Channel 9 (Pad(sstr                                , 10))
43796>>>                Write   Channel 9 (Pad(tmpclsap.group                      ,  4))
43798>>>                Write   Channel 9 (Pad(tmpclsap.endoomil                    , 6))
43800>>>                Write   Channel 9 (Pad(tmpclsap.anal                        , 1))
43802>>>                Write   Channel 9 (Pad(tmpclsap.category                    , 2))
43804>>>                Write   Channel 9 (Pad(tmpclsap.afm                         ,11))
43806>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.name)                ,40))
43808>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.occup)               ,40))
43810>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.city)                ,40))
43812>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.address)             ,60))
43814>>>                Move (trim(tmpclsap.add_no))            to sPoso
43815>>>                Write   Channel 9 (Pad(ToAnsi(sPoso)                        ,03))
43817>>>                Move (trim(tmpclsap.zipcode))            to sPoso
43818>>>                if ((sposo='') and (tmpclsap.typos='01'));                    move '00000' to sposo
43821>>>                Write   Channel 9 (Pad(sPoso                                ,10))
43823>>>                Write   Channel 9 (Pad(ToAnsi(tmpclsap.doy)                 ,40))
43825>>>                Move (trim(tmpclsap.telfax))            to sPoso
43826>>>                Move (Trim(sPoso))                      to sPoso
43827>>>                Move (Length(sPoso))                    to iLen
43828>>>                For iInt From 1 to (14-iLen)
43834>>>>
43834>>>                    Move (Insert(" ", sPoso,1))         to sPoso
43835>>>                Loop
43836>>>>
43836>>>                Write   Channel 9 (Pad(ToAnsi(sPoso)                        ,14))
43838>>>                Write   Channel 9 (Pad(tmpclsap.country                     , 2))
43840>>>                Write   Channel 9 (Pad(tmpclsap.language                    , 2))
43842>>>
43842>>>                //-------------
43842>>>                // 02/10/2012 Prosthiki Tropou Plhromhs
43842>>>                Write   Channel 9 (Pad(Tmpclsap.Tropoi_Plhromhs             , 4))
43844>>>                //-------------
43844>>>
43844>>>                Move (GetTheAppPath(Self)) to lsTheAppPath
43845>>>                if (sysfile.serial_number='1')begin
43847>>>                    IF (TMPCLSAP.TYPOS='90') BEGIN
43849>>>                        Write   Channel 9 (Pad(skeno      , 10))
43851>>>                    end
43851>>>>
43851>>>                    else begin
43852>>>                        Clear clients
43853>>>                        Move Tmpclsap.oldcode to scodem
43854>>>                        move (trim(scodem)) to scodem
43855>>>                        move scodem to clients.client_id
43856>>>                        find eq clients by index.6
43857>>>>
43857>>>                        if (found);                              Write   Channel 9 (Pad(clients.client_codem      , 10))
43861>>>                        else;                              Write   Channel 9 (Pad(skeno      , 10))
43864>>>                    End
43864>>>>
43864>>>                End
43864>>>>
43864>>>
43864>>>                Writeln Channel 9
43866>>>                add 1 to imet
43867>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpclsap.code))
43868>>>                find gt tmpclsap.recnum
43869>>>>
43869>>>            Loop
43870>>>>
43870>>>            Close_Output Channel 9
43872>>>        End_Procedure
43873>>>
43873>>>
43873>>>        // Grapsimo ton eisprakseon
43873>>>        Procedure Write_Record_Axio
43875>>>            Number  nPoso
43876>>>            Integer iDecs iLen iInt Imet ipos idiafora  isChecked
43876>>>            Integer rVal iMhnas iEtos iHmera
43876>>>            string sperioxh lsTheAppPath
43876>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
43876>>>            Date    dapod
43876>>>            get value of frmapo to dapod
43877>>>            clear Company
43878>>>            move syscurxr.company_code to Company.company_code
43879>>>            find eq company by index.1
43880>>>>
43880>>>            move Company.company_c_code0 to stomeas
43881>>>            Move (TheDaySegment  (dapod))  to iHmera
43882>>>            Move (TheMonthSegment(dapod))  to iMhnas
43883>>>            Move (TheYearSegment(dapod))   to ietos
43884>>>            Move iHmera                     to sHmera
43885>>>            Move iMhnas                     to sMhnas
43886>>>            Move iEtos                      to sEtos
43887>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
43891>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
43895>>>            Move (psPath(Self)+Trim(stomeas)+'FI3'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
43896>>>            EraseFile sFileName
43897>>>>
43897>>>            Append_Output Channel 8 sFileName
43899>>>
43899>>>            clear TmpAxio
43900>>>            find gt TmpAxio.recnum
43901>>>>
43901>>>            while (found)
43905>>>                Write   Channel 8 (Pad(Trim(TmpAxio.onoma)                 ,  3))
43907>>>                Write   Channel 8 (Pad(Trim(TmpAxio.typos)                 ,  2))
43909>>>                Write   Channel 8 (Pad(tmpaxio.etairia                     ,  4))
43911>>>                MOVE tmpaxio.typos to sposo
43912>>>                if ((sposo='90') or (sposo='91') or (sposo='92') or (sposo='93') or (sposo='94')) begin
43914>>>                     move tmpaxio.egkatastash to sposo
43915>>>                   //  move stomeas to sposo
43915>>>                     Write   Channel 8 (Pad(trim(sposo)                    ,  4))
43917>>>                     move '' to sposo
43918>>>                     Write   Channel 8 (Pad(trim(sposo)                    ,  4))
43920>>>                end
43920>>>>
43920>>>                else begin
43921>>>                    move tmpaxio.perioxh to sposo
43922>>>                    Write   Channel 8 (Pad(trim(sposo)                     ,  4))
43924>>>                    move tmpaxio.egkatastash to sposo
43925>>>                    Write   Channel 8 (Pad(trim(sposo)                     ,  4))
43927>>>                end
43927>>>>
43927>>>                Write   Channel 8 (Pad(trim(tmpaxio.type)                  ,  4))
43929>>>
43929>>>                Move TmpAxio.arithmos                 to sPoso
43930>>>                Move (Trim(sPoso))                    to sPoso
43931>>>                Move (Length(sPoso))                  to iLen
43932>>>                For iInt From 1 to (10-iLen)
43938>>>>
43938>>>                    Move (Insert(" ", sPoso,1))       to sPoso
43939>>>                Loop
43940>>>>
43940>>>                Write   Channel 8 (Pad(sposo                               , 10))
43942>>>                Move Tmpaxio.Hmnia         to sHmnia
43943>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
43944>>>                Write   Channel 8 (Pad(sHmnia                               , 8))
43946>>>                Write   Channel 8 (Pad(tmpaxio.perigrafh                    , 1))
43948>>>
43948>>>                Move (ROUnD_number(tmpaxio.axia,2))     to nPoso
43949>>>                move nposo to sposo
43950>>>                Move (Trim(sPoso))                      to sPoso
43951>>>                Move (Pos('.',sPoso))   to iPos
43952>>>                Move (Length(sPoso))    to iLen
43953>>>                Move (iLen-iPos)       to iDiafora
43954>>>                If (Pos('.',sPoso)=0) Append sPoso '.00'
43957>>>                Else Begin
43958>>>                // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
43958>>>                If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
43961>>>                End
43961>>>>
43961>>>            // 24/03/2004 allagh. Ta dekadika einai panta ta 2 teleytaia
43961>>>            // psifia ara h teleia feygei
43961>>>                Move (Replace('.',sPoso,'')) to sPoso
43962>>>                Move (Length(sPoso))                    to iLen
43963>>>                For iInt From 1 to (16-iLen)
43969>>>>
43969>>>                    Move (Insert(" ", sPoso,1))         to sPoso
43970>>>                Loop
43971>>>>
43971>>>
43971>>>
43971>>>                Write   Channel 8 (Pad(sPoso                                ,16))
43973>>>                Write   Channel 8 (Pad(tmpaxio.code                         ,10))
43975>>>                Write   Channel 8 (Pad(ToAnsi(tmpaxio.aitiol)               ,50))
43977>>>                Move Tmpaxio.lhxh     to sHmnia
43978>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
43979>>>                Write   Channel 8 (Pad(sHmnia                               , 8))
43981>>>                Write   Channel 8 (Pad(trim(tmpaxio.bank)                   ,15))
43983>>>                move '' to sid
43984>>>                Write   Channel 8 (Pad(sid                                  ,25))
43986>>>                Write   Channel 8 (Pad(ToAnsi(tmpaxio.apodekths)            ,25))
43988>>>                Write   Channel 8 (Pad(trim(tmpaxio.noepit)                 ,18))
43990>>>                Write   Channel 8 (Pad(tmpaxio.xora                         , 2))
43992>>>                Write   Channel 8 (Pad(tmpaxio.idioy                        , 1))
43994>>>                Write   Channel 8 (Pad(tmpaxio.eparxia                      , 1))
43996>>>                Write   Channel 8 (Pad(trim(tmpaxio.nomisma)                , 3))
43998>>>                Write   Channel 8 (Pad(trim(tmpaxio.anal)                   , 2))
44000>>>
44000>>>                if (sysfile.serial_number='1') begin
44002>>>                    Move TmpAxio.pae_arithm           to sPoso
44003>>>                    Move (Trim(sPoso))                to sPoso
44004>>>                    Move (Length(sPoso))              to iLen
44005>>>                    For iInt From 1 to (10-iLen)
44011>>>>
44011>>>                        Move (Insert(" ", sPoso,1))       to sPoso
44012>>>                    Loop
44013>>>>
44013>>>
44013>>>                    Write   Channel 8 (Pad(sposo                               , 10))
44015>>>                    Move Tmpaxio.pae_hmnia     to sHmnia
44016>>>                    Move (Replaces('/',sHmnia,''))  to sHmnia
44017>>>                    Write   Channel 8 (Pad(sHmnia                               , 8))
44019>>>                    Move TmpAxio.afmarx               to sPoso
44020>>>                    Move (Trim(sPoso))                    to sPoso
44021>>>                    Move (Length(sPoso))                  to iLen
44022>>>                    For iInt From 1 to (10-iLen)
44028>>>>
44028>>>                        Move (Insert(" ", sPoso,1))       to sPoso
44029>>>                    Loop
44030>>>>
44030>>>
44030>>>                    Write   Channel 8 (Pad(ToAnsi(sposo)            ,10))
44032>>>                    Write   Channel 8 (Pad(ToAnsi(tmpaxio.arxikos)  ,20))
44034>>>                End
44034>>>>
44034>>>
44034>>>                // 12/10/2012 PROSTHIKH NEAS TRAPEZAS Sto FI3
44034>>>                Write   Channel 8 (Pad(ToAnsi(tmpaxio.nea_Trapeza)    ,20))
44036>>>
44036>>>                // 12/10/2012 PROSTHIKH NEAS TRAPEZAS Sto FI3
44036>>>
44036>>>                Writeln Channel 8
44038>>>                add 1 to imet
44039>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpaxio.code))
44040>>>                find gt Tmpaxio.recnum
44041>>>>
44041>>>            Loop
44042>>>>
44042>>>            Close_Output Channel 8
44044>>>        End_Procedure
44045>>>
44045>>>        Procedure Write_record_polhseon
44047>>>            Number  nPoso
44048>>>            Integer iDecs iLen iInt Imet ipos idiafora
44048>>>            Integer rVal iMhnas iEtos iHmera
44048>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
44048>>>            string  skeno senter stext sstr  Sdyo
44048>>>            Date    dapod
44048>>>            get value of frmapo to dapod
44049>>>            clear Company
44050>>>            move syscurxr.company_code to Company.company_code
44051>>>            find eq company by index.1
44052>>>>
44052>>>            move Company.company_c_code0 to stomeas
44053>>>            Move (TheDaySegment  (dapod))  to iHmera
44054>>>            Move (TheMonthSegment(dapod))  to iMhnas
44055>>>            Move (TheYearSegment(dapod))   to ietos
44056>>>            Move iHmera                   to sHmera
44057>>>            Move iMhnas                   to sMhnas
44058>>>            Move iEtos                    to sEtos
44059>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
44063>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
44067>>>            Move (psPath(Self)+Trim(stomeas)+'FI2'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
44068>>>            EraseFile sFileName
44069>>>>
44069>>>            Append_Output Channel 7 sFileName
44071>>>
44071>>>            clear TmpPol
44072>>>            find gt Tmppol by index.1
44073>>>>
44073>>>
44073>>>            while (found)
44077>>>                Write   Channel 7 (Pad(Trim(Tmppol.onoma)                 ,  3))
44079>>>                Write   Channel 7 (Pad(Trim(Tmppol.typos)                 ,  2))
44081>>>                Write   Channel 7 (Pad(tmppol.etairia                     ,  4))
44083>>>                Write   Channel 7 (Pad(trim(tmppol.egkatastash)           ,  4))
44085>>>                if (tmppol.type ='9999');                   Write   Channel 7 (Pad(trim(skeno)                     ,  4))
44089>>>                else;                   Write   Channel 7 (Pad(trim(tmppol.perioxh)        ,  4))
44092>>>                Write   Channel 7 (Pad(trim(tmppol.type)                  ,  4))
44094>>>
44094>>>
44094>>>                // Allagh 18-12-2008 H Seira mporei na exei 0, 1 h 2 xarakthres
44094>>>                Integer  iLength0
44094>>>                Move (Length(tmppol.arithmos)) to iLength0
44095>>>
44095>>>                Move (Pos(".",tmppol.arithmos))         to iPos
44096>>>                Move (Left(tmppol.arithmos,iPos))       to sDyo
44097>>>                Move (mid(tmpPol.Arithmos,8,(iPos+1)))  to sPoso
44098>>>                Move (Replace('.',SDYO,'')) to sDYO
44099>>>                Move (Trim  (sDyo ))                    to sDyo
44100>>>                Move (Trim  (sPoso))                    to sPoso
44101>>>                Move (Length(sPoso))                    to iLen
44102>>>
44102>>>                For iInt From 1 to (8-iLen)
44108>>>>
44108>>>                    Move (Insert(" ", sPoso,1))       to sPoso
44109>>>                Loop
44110>>>>
44110>>>                IF (tmppol.type='9999') move '99'      to sdyo
44113>>>                Write   Channel 7 (Pad(ToAnsi(sdyo)                        , 02))
44115>>>                Write   Channel 7 (Pad(ToAnsi(sposo)                       , 08))
44117>>>
44117>>>                Move Tmppol.Hmnia         to sHmnia
44118>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
44119>>>                Write   Channel 7 (Pad(sHmnia                               , 8))
44121>>>                Write   Channel 7 (Pad(trim(tmppol.kodikos)                 , 5))
44123>>>
44123>>>
44123>>>                //**************************************
44123>>>                Move (ROUnD_number(tmppol.axia,2))     to nPoso
44124>>>                move nposo to sposo
44125>>>                Move (Trim(sPoso))                      to sPoso
44126>>>                Move (Pos('.',sPoso))   to iPos
44127>>>                Move (Length(sPoso))    to iLen
44128>>>                Move (iLen-iPos)       to iDiafora
44129>>>                If (Pos('.',sPoso)=0) Append sPoso '.00'
44132>>>                Else Begin
44133>>>                // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
44133>>>                If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
44136>>>                End
44136>>>>
44136>>>            // 24/03/2004 allagh. Ta dekadika einai panta ta 2 teleytaia
44136>>>            // psifia ara h teleia feygei
44136>>>                Move (Replace('.',sPoso,'')) to sPoso
44137>>>                Move (Length(sPoso))                    to iLen
44138>>>                For iInt From 1 to (16-iLen)
44144>>>>
44144>>>                    Move (Insert(" ", sPoso,1))         to sPoso
44145>>>                Loop
44146>>>>
44146>>>                //**************************************
44146>>>                if (tmppol.typos='06') move '' to sposo
44149>>>                Write   Channel 7 (Pad(sPoso                                ,16))
44151>>>                Write   Channel 7 (Pad(tmppol.code                          ,10))
44153>>>                Write   Channel 7 (Pad(tmppol.kodikos2                      , 2))
44155>>>                Write   Channel 7 (Pad(ToAnsi(tmppol.apoth)                 ,18))
44157>>>                Move (Round_Number(tmppol.qty,3))   to nPoso
44158>>>                MOVE nposo  TO SPOSO
44159>>>                Move (Trim(sPoso))                    to sPoso
44160>>>                Move (Pos('.',sPoso))   to iPos
44161>>>                Move (Length(sPoso))    to iLen
44162>>>                Move (iLen-iPos)     to iDiafora
44163>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
44166>>>                Else Begin
44167>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
44167>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
44170>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
44174>>>                End
44174>>>>
44174>>>                Move (Replace('.',sPoso,'')) to sPoso
44175>>>                Move (Length(sPoso))                   to iLen
44176>>>                For iInt From 1 to (13-iLen)
44182>>>>
44182>>>                   Move (Insert(" ", sPoso,1))         to sPoso
44183>>>                Loop
44184>>>>
44184>>>                if (tmppol.typos='06') move '' to sposo
44187>>>                Write   Channel 7 (Pad(sPoso                                ,13))
44189>>>                Write   Channel 7 (Pad(trim(tmppol.mm)                      , 3))
44191>>>                if (tmppol.typos='06') begin
44193>>>                    move '' to tmppol.kathgoria
44194>>>                    move '' to tmppol.antlhsh
44195>>>                    move '' to tmppol.pinakida
44196>>>                    move '' to tmppol.fpa
44197>>>                end
44197>>>>
44197>>>                Write   Channel 7 (Pad(trim(tmppol.kathgoria)               , 1))
44199>>>                Write   Channel 7 (Pad(trim(tmppol.antlhsh)                 , 1))
44201>>>                Write   Channel 7 (Pad(ToAnsi(tmppol.pinakida)              ,12))
44203>>>                Write   Channel 7 (Pad(trim(tmppol.oroi)                    , 4))
44205>>>                Write   Channel 7 (Pad(trim(tmppol.fpa)                     , 2))
44207>>>                Move (ROUnD_number(tmppol.posofpa,2))     to nPoso
44208>>>                move nposo to sposo
44209>>>                Move (Trim(sPoso))                      to sPoso
44210>>>                Move (Pos('.',sPoso))   to iPos
44211>>>                Move (Length(sPoso))    to iLen
44212>>>                Move (iLen-iPos)       to iDiafora
44213>>>                If (Pos('.',sPoso)=0) Append sPoso '.00'
44216>>>                Else Begin
44217>>>                // An exei mono 1 dekadiko prepei na prosthesoume ena '0' sto telos
44217>>>                If (iDiafora=1) Move (Append(sPoso,'0')) to sPoso
44220>>>                End
44220>>>>
44220>>>                Move (Replace('.',sPoso,'')) to sPoso
44221>>>                Move (Length(sPoso))                    to iLen
44222>>>                For iInt From 1 to (16-iLen)
44228>>>>
44228>>>                    Move (Insert(" ", sPoso,1))         to sPoso
44229>>>                Loop
44230>>>>
44230>>>                if ((tmppol.typos='06')or(tmppol.typos='05')or(tmppol.typos='01'));                      move '' to sposo
44233>>>                Write   Channel 7 (Pad(sPoso                                ,16))
44235>>>                Write   Channel 7 (Pad(trim(tmppol.nomisma)                 , 5))
44237>>>                Write   Channel 7 (Pad(toansi(tmppol.deltia)                ,10))
44239>>>                Move '' to sEnter
44240>>>                move tmppol.sxolia to stext
44241>>>                Append sEnter (Character(13)) (Character(10))
44243>>>                Move (Replaces(sEnter,sText,' ')) to sText
44244>>>                Move stext to sStr
44245>>>                Append sStr ' '
44246>>>                move (Length(sStr)) to iLen
44247>>>                For iInt From 1 to iLen
44253>>>>
44253>>>                    If (iInt>50) Break
44256>>>                Loop
44257>>>>
44257>>>
44257>>>                Write   Channel 7 (Pad(ToAnsi(sstr)                        ,50))
44259>>>
44259>>>                // 02/10/2012 Prosthiki Oron Plhromhs
44259>>>                Write   Channel 7 (Pad(trim(TmpPol.Tropoi_Plhromhs)        , 4))
44261>>>                // 02/10/2012 Prosthiki Oron Plhromhs
44261>>>
44261>>>
44261>>>                Writeln Channel 7
44263>>>                add 1 to imet
44264>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmppol.code))
44265>>>                find gt Tmppol by index.1
44266>>>>
44266>>>            Loop
44267>>>>
44267>>>            Close_Output Channel 7
44269>>>
44269>>>        End_Procedure
44270>>>
44270>>>        Procedure Write_Record_Apoth
44272>>>            Number  nPoso
44273>>>            Integer iDecs iLen iInt Imet idiafora ipos
44273>>>            Integer rVal iMhnas iEtos iHmera
44273>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas  sblank
44273>>>            Date    dapod
44273>>>            get value of frmapo to dapod
44274>>>            move '' to sblank
44275>>>            clear Company
44276>>>            move syscurxr.company_code to Company.company_code
44277>>>            find eq company by index.1
44278>>>>
44278>>>            move Company.company_c_code0 to stomeas
44279>>>
44279>>>            Move (TheDaySegment  (dapod))  to iHmera
44280>>>            Move (TheMonthSegment(dapod))  to iMhnas
44281>>>            Move (TheYearSegment(dapod))   to ietos
44282>>>            Move iHmera                     to sHmera
44283>>>            Move iMhnas                     to sMhnas
44284>>>            Move iEtos                      to sEtos
44285>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
44289>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
44293>>>            Move (psPath(Self)+Trim(stomeas)+'MM1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
44294>>>            EraseFile sFileName
44295>>>>
44295>>>            Append_Output Channel 5 sFileName
44297>>>            clear Tmpapoth
44298>>>            find gt TmpApoth.recnum
44299>>>>
44299>>>            while (found)
44303>>>                Write   Channel 5 (Pad(Trim(Tmpapoth.onoma)                ,  3))
44305>>>                Write   Channel 5 (Pad(Trim(Tmpapoth.typos)                ,  2))
44307>>>                if (Tmpapoth.typos='90');                    move stomeas to sposo
44310>>>                else;                    move tmpapoth.egkatastash to sposo
44312>>>                Write   Channel 5 (Pad(trim(sposo)                        ,  4))
44314>>>
44314>>>                Move TmpApoth.arithmos                to sPoso
44315>>>
44315>>>                Write   Channel 5 (Pad(ToAnsi(sposo)                      , 16))
44317>>>                Move Tmpapoth.Hmnia         to sHmnia
44318>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
44319>>>                Write   Channel 5 (Pad(sHmnia                               , 8))
44321>>>                Write   Channel 5 (Pad(trim(tmpapoth.type)                  , 3))
44323>>>                Write   Channel 5 (Pad(tmpapoth.code                        ,10))
44325>>>                Write   Channel 5 (Pad(ToAnsi(tmpapoth.item)                ,18))
44327>>>                Move (Round_Number(tmpapoth.qty,3))   to nPoso
44328>>>                MOVE nposo  TO SPOSO
44329>>>                Move (Trim(sPoso))                    to sPoso
44330>>>                Move (Pos('.',sPoso))   to iPos
44331>>>                Move (Length(sPoso))    to iLen
44332>>>                Move (iLen-iPos)     to iDiafora
44333>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
44336>>>                Else Begin
44337>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
44337>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
44340>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
44344>>>                End
44344>>>>
44344>>>                Move (Replace('.',sPoso,'')) to sPoso
44345>>>                Move (Length(sPoso))                   to iLen
44346>>>                For iInt From 1 to (13-iLen)
44352>>>>
44352>>>                   Move (Insert("0", sPoso,1))         to sPoso
44353>>>                Loop
44354>>>>
44354>>>
44354>>>                Write   Channel 5 (Pad(sPoso                                ,13))
44356>>>                Write   Channel 5 (Pad(trim(tmpapoth.monada)                ,03))
44358>>>                Write   Channel 5 (Pad(trim(sblank)                         ,04))
44360>>>                move tmpapoth.pinakida to sposo
44361>>>                if ((Tmpapoth.typos='90') or (tmpapoth.typos='91'));                    move '' to sposo
44364>>>                Move (Replace(' ',sPoso,'')) to sPoso
44365>>>                Write   Channel 5 (Pad(ToAnsi(sposo)                        ,10))
44367>>>                MOVE (trim(tmpapoth.paralabh)) to tmpapoth.paralabh
44368>>>                Write   Channel 5 (Pad(ToAnsi(tmpapoth.paralabh)            ,03))
44370>>>                Writeln Channel 5
44372>>>                add 1 to imet
44373>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpapoth.code))
44374>>>                find gt Tmpapoth.recnum
44375>>>>
44375>>>            Loop
44376>>>>
44376>>>            Close_Output Channel 5
44378>>>        End_Procedure
44379>>>
44379>>>        // grapsimo arxeioy texn.prodiagrafon
44379>>>        Procedure Write_Record_tehn
44381>>>            Number  nPoso
44382>>>            Integer iDecs iLen iInt Imet idiafora ipos
44382>>>            Integer rVal iMhnas iEtos iHmera
44382>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
44382>>>            Date    dapod
44382>>>            get value of frmapo to dapod
44383>>>            clear Company
44384>>>            move syscurxr.company_code to Company.company_code
44385>>>            find eq company by index.1
44386>>>>
44386>>>            move Company.company_c_code0 to stomeas
44387>>>
44387>>>            Move (TheDaySegment  (dapod))  to iHmera
44388>>>            Move (TheMonthSegment(dapod))  to iMhnas
44389>>>            Move (TheYearSegment(dapod))   to ietos
44390>>>            Move iHmera                     to sHmera
44391>>>            Move iMhnas                     to sMhnas
44392>>>            Move iEtos                      to sEtos
44393>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
44397>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
44401>>>            Move (psPath(Self)+Trim(stomeas)+'PP1'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
44402>>>            EraseFile sFileName
44403>>>>
44403>>>            Append_Output Channel 5 sFileName
44405>>>
44405>>>            clear Tmptehn
44406>>>            find gt Tmptehn by index.3
44407>>>>
44407>>>            while (found)
44411>>>                Write   Channel 5 (Pad(Trim(Tmptehn.onoma)                ,  3))
44413>>>                Write   Channel 5 (Pad(Trim(Tmptehn.typos)                ,  2))
44415>>>                if (tmptehn.typos='90') move stomeas to sposo
44418>>>                else move  tmptehn.egkatastash to sposo
44420>>>                Write   Channel 5 (Pad(trim(sposo)                        ,  4))
44422>>>                Write   Channel 5 (Pad(ToAnsi(tmptehn.item)                ,18))
44424>>>                Write   Channel 5 (Pad(trim(tmptehn.prodiagrafh)           ,12))
44426>>>                Move tmptehn.type   to nPoso
44427>>>                MOVE nposo  TO SPOSO
44428>>>                Move (Trim(sPoso))                    to sPoso
44429>>>                Move (Pos('.',sPoso))   to iPos
44430>>>                Move (Length(sPoso))    to iLen
44431>>>                Move (iLen-iPos)     to iDiafora
44432>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
44435>>>                Else Begin
44436>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
44436>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
44439>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
44443>>>                End
44443>>>>
44443>>>                Move (Replace('.',sPoso,'')) to sPoso
44444>>>                Move (Length(sPoso))                   to iLen
44445>>>                For iInt From 1 to (13-iLen)
44451>>>>
44451>>>                   Move (Insert("0", sPoso,1))         to sPoso
44452>>>                Loop
44453>>>>
44453>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
44455>>>                Write   Channel 5 (Pad(trim(tmptehn.mm)                ,03))
44457>>>
44457>>>                move tmptehn.aa to sposo
44458>>>                Move (Length(sPoso))                   to iLen
44459>>>                For iInt From 1 to (4-iLen)
44465>>>>
44465>>>                   Move (Insert("0", sPoso,1))         to sPoso
44466>>>                Loop
44467>>>>
44467>>>                if (tmptehn.typos='90');                    move '' to sposo
44470>>>                Write   Channel 5 (Pad(sPoso                            ,4))
44472>>>                Write   Channel 5 (Pad(ToAnsi(tmptehn.itemd)            ,18))
44474>>>                move tmptehn.qty to nposo
44475>>>                MOVE nposo  TO SPOSO
44476>>>                Move (Trim(sPoso))                    to sPoso
44477>>>                Move (Pos('.',sPoso))   to iPos
44478>>>                Move (Length(sPoso))    to iLen
44479>>>                Move (iLen-iPos)     to iDiafora
44480>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
44483>>>                Else Begin
44484>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
44487>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
44491>>>                End
44491>>>>
44491>>>                Move (Replace('.',sPoso,'')) to sPoso
44492>>>                Move (Length(sPoso))                   to iLen
44493>>>                For iInt From 1 to (13-iLen)
44499>>>>
44499>>>                   Move (Insert("0", sPoso,1))         to sPoso
44500>>>                Loop
44501>>>>
44501>>>                if (tmptehn.typos='90');                    move '' to sposo
44504>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
44506>>>
44506>>>                Write   Channel 5 (Pad(trim(tmptehn.mmitemd)           ,03))
44508>>>                if (tmptehn.typos='90') begin
44510>>>                    move '' to sposo
44511>>>                    Write   Channel 5 (Pad(sposo                       ,01))
44513>>>                end
44513>>>>
44513>>>                else;                    Write   Channel 5 (Pad(tmptehn.index               ,01))
44516>>>                Writeln Channel 5
44518>>>                add 1 to imet
44519>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmptehn.recnum))
44520>>>                find gt Tmptehn by index.3
44521>>>>
44521>>>            Loop
44522>>>>
44522>>>            Close_Output Channel 5
44524>>>        End_Procedure
44525>>>
44525>>>        Procedure Write_Record_Anal
44527>>>            Number  nPoso
44528>>>            Integer iDecs iLen iInt Imet idiafora ipos
44528>>>            Integer rVal iMhnas iEtos iHmera
44528>>>            string s1 s2
44528>>>            String  sPoso sHmnia sid sMhnas sHmera sBranch sFileName setos scomp stomeas
44528>>>            Date    dapod
44528>>>            get value of frmapo to dapod
44529>>>            clear Company
44530>>>            move syscurxr.company_code to Company.company_code
44531>>>            find eq company by index.1
44532>>>>
44532>>>            move Company.company_c_code0 to stomeas
44533>>>
44533>>>            Move (TheDaySegment  (dapod))  to iHmera
44534>>>            Move (TheMonthSegment(dapod))  to iMhnas
44535>>>            Move (TheYearSegment(dapod))   to ietos
44536>>>            Move iHmera                     to sHmera
44537>>>            Move iMhnas                     to sMhnas
44538>>>            Move iEtos                      to sEtos
44539>>>            If (Length(sHmera)=1) Insert '0' in sHmera at 1
44543>>>            If (Length(sMhnas)=1) Insert '0' in sMhnas at 1
44547>>>            Move (psPath(Self)+Trim(stomeas)+'PP2'+Trim(sEtos)+Trim(sMhnas)+Trim(sHmera)+'.txt') to sFileName
44548>>>            EraseFile sFileName
44549>>>>
44549>>>            Append_Output Channel 5 sFileName
44551>>>            clear TmpAnal
44552>>>            find gt TmpAnal by index.5
44553>>>>
44553>>>            while (found)
44557>>>                Write   Channel 5 (Pad(Trim(TmpAnal.onoma)                ,  3))
44559>>>                Write   Channel 5 (Pad(Trim(TmpAnal.typos)                ,  2))
44561>>>                Move Tmpanal.Hmnia         to sHmnia
44562>>>                Move (Replaces('/',sHmnia,''))  to sHmnia
44563>>>                Write   Channel 5 (Pad(sHmnia                              , 8))
44565>>>                move stomeas to sposo
44566>>>                if (tmpanal.typos='92');                    Write   Channel 5 (Pad(trim(sposo)                    ,  4))
44570>>>                else;                    Write   Channel 5 (Pad(trim(tmpAnal.egkatastash)      ,  4))
44573>>>                Write   Channel 5 (Pad(ToAnsi(tmpANAL.item)                ,18))
44575>>>                Write   Channel 5 (Pad(trim(tmpAnal.trmetaf)              ,  4))
44577>>>                Write   Channel 5 (Pad(trim(tmpanal.prodiagrafh)           ,12))
44579>>>
44579>>>
44579>>>
44579>>>
44579>>>
44579>>>                // -----------------------------------------------------------------------------------------------------
44579>>>                // Allagh 21/02/2012 -  Emfanisthke mia posothta analoshs me 4 dekadika ta opoia perasan os exoun
44579>>>                //                      Ayto eixe san apotelesma na perasei posothta 541.699 anti gia 54.1699
44579>>>                //                      mias kai pername mono 3 dekadika opote perasame ta 3 teleytaia (699) kai
44579>>>                //                      to akeraio meros ths posothtas egine 541 anti gia 54.
44579>>>
44579>>>                Move tmpanal.qty        to nPoso
44580>>>                MOVE nposo              to sPoso
44581>>>                Move (Trim(sPoso))      to sPoso
44582>>>
44582>>>                Move (Pos('.',sPoso))   to iPos
44583>>>                Move (Length(sPoso))    to iLen
44584>>>                Move (iLen-iPos)        to iDiafora
44585>>>
44585>>>                //--
44585>>>                Integer iProblem
44585>>>                Move 0 to iProblem
44586>>>                //--
44586>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
44589>>>                Else Begin
44590>>>                // An exei mono 1 dekadiko prepei na prosthesoume dyo '0' sto telos
44590>>>                         If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
44593>>>                    else If (iDiafora=2) Move (Append(sPoso,'0' )) to sPoso
44597>>>                    //else If (iDiafora=3)   => OK me 3 dekadika
44597>>>                    else If (iDiafora>3) Begin
44600>>>                        // Error handling code ????
44600>>>                    End
44600>>>>
44600>>>
44600>>>                End
44600>>>>
44600>>>
44600>>>
44600>>>                // -----------------------------------------------------------------------------------------------------
44600>>>
44600>>>                Move (Replace('.',sPoso,'')) to sPoso
44601>>>                Move (Length(sPoso))                   to iLen
44602>>>                For iInt From 1 to (13-iLen)
44608>>>>
44608>>>                   Move (Insert("0", sPoso,1))         to sPoso
44609>>>                Loop
44610>>>>
44610>>>                if (tmpanal.typos='91');                    move '' to sposo
44613>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
44615>>>                Write   Channel 5 (Pad(trim(tmpanal.mm)                ,03))
44617>>>                move tmpanal.aa to sposo
44618>>>                Move (Length(sPoso))                   to iLen
44619>>>                For iInt From 1 to (4-iLen)
44625>>>>
44625>>>                   Move (Insert("0", sPoso,1))         to sPoso
44626>>>                Loop
44627>>>>
44627>>>                if ((tmpanal.typos='90') or (tmpanal.typos='91') or (tmpanal.typos='92'));                    move '' to sposo
44630>>>                Write   Channel 5 (Pad(sPoso                            ,4))
44632>>>                Write   Channel 5 (Pad(ToAnsi(tmpanal.itemd)           ,18))
44634>>>                move tmpanal.posoths to nposo
44635>>>                MOVE nposo  TO SPOSO
44636>>>                Move (Trim(sPoso))                    to sPoso
44637>>>                Move (Pos('.',sPoso))   to iPos
44638>>>                Move (Length(sPoso))    to iLen
44639>>>                Move (iLen-iPos)     to iDiafora
44640>>>                If (Pos('.',sPoso)=0) Append sPoso '.000'
44643>>>                Else Begin
44644>>>                    If (iDiafora=1) Move (Append(sPoso,'00')) to sPoso
44647>>>                    else If (iDiafora=2) Move (Append(sPoso,'0')) to sPoso
44651>>>                End
44651>>>>
44651>>>                Move (Replace('.',sPoso,'')) to sPoso
44652>>>                Move (Length(sPoso))                   to iLen
44653>>>                For iInt From 1 to (13-iLen)
44659>>>>
44659>>>                   Move (Insert("0", sPoso,1))         to sPoso
44660>>>                Loop
44661>>>>
44661>>>                if ((tmpanal.typos='90') or (tmpanal.typos='92'));                    move '' to sposo
44664>>>                Write   Channel 5 (Pad(trim(tmpanal.mmitemd)           ,03))
44666>>>                Write   Channel 5 (Pad(trim(sposo)                     ,13))
44668>>>                move  tmpanal.product to sposo
44669>>>                if (sposo<>'');                    insert '' in  sposo at 1
44673>>>                Move (Replace('.',sPoso,'')) to sPoso
44674>>>                left sposo to s1 3
44676>>>>
44676>>>                right sposo to s2 12
44678>>>>
44678>>>                move s1 to sposo
44679>>>                append sposo s2
44680>>>                Write   Channel 5 (Pad(toansi(sposo)                   ,16))
44682>>>                move  tmpanal.product to sposo
44683>>>                if (sposo<>'');                    insert '€' in  sposo at 1
44687>>>                Move (Replace('.',sPoso,'')) to sPoso
44688>>>                left sposo to s1 3
44690>>>>
44690>>>                right sposo to s2 12
44692>>>>
44692>>>                move s1 to sposo
44693>>>                append sposo s2
44694>>>                Write   Channel 5 (Pad(toansi(sposo)                   ,16))
44696>>>                Writeln Channel 5
44698>>>                add 1 to imet
44699>>>                Set Label Of frmShow to (String(iMet)+'-'+String(tmpanal.recnum))
44700>>>                find gt Tmpanal by index.5
44701>>>>
44701>>>            Loop
44702>>>>
44702>>>            Close_Output Channel 5
44704>>>        End_Procedure
44705>>>
44705>>>        Procedure OnClick
44707>>>            String  sFile sBranch sText sBaxiokatRecr sFile2 sStr
44708>>>            String  sCompany sRec sLabel sPlace sPath
44708>>>            Date    dapod deosd
44708>>>            Integer iInt iCount iRec iMet iPos iPlaceCode retval isOK iOk
44708>>>            indicate err false
44709>>>            Get Value Of frmApo Item 0 to dapod
44710>>>
44710>>>            Clear tmpSap
44711>>>            Move dapod to tmpSap.Date
44712>>>            Find Eq tmpSap By Index.1
44713>>>>
44713>>>            If ((Found) And (tmpSap.Kleidomeno=1)) begin
44715>>>                send info_box '† †£/¤å˜ €¬«ã œå¤˜  ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
44716>>>                procedure_return
44717>>>            end
44717>>>>
44717>>>
44717>>>            Move '' to sStr
44718>>>            Get fiSapOK Of vwSap dapod to iOK
44719>>>
44719>>>            If (iOK<>0) Begin
44721>>>                     If (iOK=1) Send Info_Box '“§á¨®œ  §¨¦šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜ ˜¤¦ ®«ã' '¢ž¨¦­¦¨å˜'
44724>>>                Else If (iOK=2) Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜¬«ã œå¤˜  ã›ž ¡¢œ ›à£â¤ž' '¢ž¨¦­¦¨å˜'
44728>>>                Else If (iOK=3) Send Info_Box '¨¦¡ç§«œ  ¡œ¤æ ž£œ¨¦£ž¤ é¤.\n‰á§¦ ˜ §¨¦žš¦ç£œ¤ž ƒ„Œ â«¨œ¥œ' '¢ž¨¦­¦¨å˜'
44732>>>                Else If (iOK=4) Send Info_Box '“§á¨®œ  £œ«˜šœ¤â©«œ¨ž ž£œ¨¦£ž¤å˜' '¢ž¨¦­¦¨å˜'
44736>>>                procedure_return
44737>>>            end
44737>>>>
44737>>>
44737>>>            Get Value Of frmPath Item 0 to sPath
44738>>>            Set psPath to (Trim(sPath)+'\')
44739>>>
44739>>>            Get YesNo_Box '€¨®åœ  ž œ¥˜šàšã „šš¨˜­é¤.\nŒ˜ ©¬¤œ®å©à ?' to RetVal
44740>>>
44740>>>            If (dapod='') Begin
44742>>>                Send Info_Box '† ž£œ¨¦£ž¤å˜ ˜§¦ œå¤˜  ¡œ¤ã ' '¢ž¨¦­¦¨å˜'
44743>>>                Send Activate to frmApo
44744>>>                Procedure_Return
44745>>>            End
44745>>>>
44745>>>
44745>>>            indicate err false
44746>>>
44746>>>            If (RetVal =MBR_yes) begin
44748>>>
44748>>>              //-----------------------------------------------------------------
44748>>>              //--------------------  MAIN TRANSACTION START --------------------
44748>>>              //-----------------------------------------------------------------
44748>>>                Begin_transaction
44749>>>
44749>>>                    Send Write_Record_Pel
44750>>>                    Get Verify_Ascii 1 to isOK
44751>>>                    If (Not(isOK)) Begin
44753>>>                        Error 6001 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
44754>>>>
44754>>>                    End
44754>>>>
44754>>>
44754>>>                    Send Write_record_polhseon
44755>>>                    Get Verify_Ascii 2 to isOK
44756>>>                    If (Not(isOK)) Begin
44758>>>                        Error 6002 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI2. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
44759>>>>
44759>>>                    End
44759>>>>
44759>>>
44759>>>                    Send Write_record_axio
44760>>>                    Get Verify_Ascii 3 to isOK
44761>>>                    If (Not(isOK)) Begin
44763>>>                        Error 6003 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ FI3. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
44764>>>>
44764>>>                    End
44764>>>>
44764>>>
44764>>>                    Send Write_record_apoth
44765>>>                    Get Verify_Ascii 4 to isOK
44766>>>                    If (Not(isOK)) Begin
44768>>>                        Error 6004 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ MM1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
44769>>>>
44769>>>                    End
44769>>>>
44769>>>
44769>>>                    Send Write_record_tehn
44770>>>                    Get Verify_Ascii 5 to isOK
44771>>>                    If (Not(isOK)) Begin
44773>>>                        Error 6005 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ PP1. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
44774>>>>
44774>>>                    End
44774>>>>
44774>>>
44774>>>                    Send Write_record_Anal
44775>>>                    Get Verify_Ascii 6 to isOK
44776>>>                    If (Not(isOK)) Begin
44778>>>                        Error 6006 '€©¬£­à¤å˜ œšš¨˜­é¤ ©«¦ ˜¨®œå¦ PP2. † œ¥˜šàšã › ˜¡æ§«œ«˜ '
44779>>>>
44779>>>                    End
44779>>>>
44779>>>
44779>>>                    move 0 to iint
44780>>>                    clear clients
44781>>>                    find GT  clients by index.11
44782>>>>
44782>>>                    while ((found) and (clients.sap_hmnia =''))
44786>>>                        move clients.recnum to irec
44787>>>                        if (clients.status='') move '2' to clients.status
44790>>>                        else if (clients.status='1') move '3' to clients.status
44794>>>                        move dapod to clients.sap_hmnia
44795>>>                        saverecord clients
44796>>>                        move  '€¢¢˜šã Status œ¢˜«é¤' to sstr
44797>>>                        Set Label Of frmShow to (sstr+'-'+CLIENTS.client_id)
44798>>>                        clear clients
44799>>>                        move irec to clients.recnum
44800>>>                        find gt clients by index.11
44801>>>>
44801>>>                    Loop
44802>>>>
44802>>>
44802>>>                  // INDEX 16 ‹„ SAP-HMNIA
44802>>>                    clear cmoves
44803>>>                    find gt cmoves by 16
44804>>>>
44804>>>                    while ((found) and (cmoves.sap_hmnia =''))
44808>>>                        if  (cmoves.cmoves_hmnia  > dapod) goto nextreadd
44811>>>                       //œš¨¨˜­âª ¡¢œ ›é£˜«¦ª §¨â§œ  ¤˜ §¨¦©§œ¨¤ ¦ç¤«œ
44811>>>                        if (cmoves.barticl_recr<>'') begin
44813>>>                            clear barticl
44814>>>                            move cmoves.barticl_recr to barticl.barticl_recr
44815>>>                            find eq barticl by index.2
44816>>>>
44816>>>                            if (found) begin
44818>>>                                If (barticl.ekkremes=1) goto nextreadd
44821>>>                            end
44821>>>>
44821>>>                        End
44821>>>>
44821>>>
44821>>>                        move cmoves.recnum to irec
44822>>>                        move dapod to cmoves.sap_hmnia
44823>>>                        saverecord cmoves
44824>>>                        move 1 to iint
44825>>>                        nextreadd:
44825>>>                            Set Label Of frmShow to ('€¥ æš¨˜­˜' + '-' + String(cmoves.recnum)+'-'+String(cmoves.cmoves_hmnia))
44826>>>                            if (iint=1) begin
44828>>>                                clear cmoves
44829>>>                                move irec to cmoves.recnum
44830>>>                            end
44830>>>>
44830>>>                            find gt cmoves by 16
44831>>>>
44831>>>                            move 0 to iint
44832>>>                    Loop
44833>>>>
44833>>>
44833>>>
44833>>>                    move 0 to iint
44834>>>                    clear particle
44835>>>                    find gt particle by 17
44836>>>>
44836>>>                    while ((found) and (particle.sap_hmnia =''))
44840>>>                        if (particle.partl_hmnia  > dapod) goto nextpartld
44843>>>                        if (particle.partl_no     < 1    ) goto nextpartld
44846>>>                        move particle.recnum to irec
44847>>>                        move dapod to particle.sap_hmnia
44848>>>                        saverecord particle
44849>>>                        move 1 to iint
44850>>>                        nextpartld:
44850>>>                        Set Label Of frmShow to ('à¢ã©œ ª' + '-' + String(particle.recnum)+'-'+String(particle.partl_hmnia))
44851>>>                        if (iint=1) begin
44853>>>                            clear particle
44854>>>                            move irec to particle.recnum
44855>>>                        end
44855>>>>
44855>>>                        move 0 to iint
44856>>>                        find gt particle by 17
44857>>>>
44857>>>                    Loop
44858>>>>
44858>>>
44858>>>
44858>>>                    move 0 to iint
44859>>>                    clear wcmoves
44860>>>                    find GT wcmoves by 16
44861>>>>
44861>>>                    while ((found) and (wcmoves.sap_hmnia =''))
44865>>>                        if  (wcmoves.wcmove_hmnia  > dapod) goto nextwmovesd
44868>>>                        move wcmoves.recnum to irec
44869>>>                        move dapod to wcmoves.sap_hmnia
44870>>>                        saverecord wcmoves
44871>>>                        move 1 to iint
44872>>>                        nextwmovesd:
44872>>>                            Set Label Of frmShow to ('€§¦Ÿã¡ž' + '-' + String(wcmoves.recnum)+'-'+String(wcmoves.wcmove_hmnia))
44873>>>                            if (iint=1) begin
44875>>>                                clear wcmoves
44876>>>                                move irec to wcmoves.recnum
44877>>>                            end
44877>>>>
44877>>>                            move 0 to iint
44878>>>                            find Gt wcmoves by 16
44879>>>>
44879>>>                    Loop
44880>>>>
44880>>>
44880>>>                    move 0 to iint
44881>>>                    clear itemtehn
44882>>>                    find GT itemtehn by index.4
44883>>>>
44883>>>                    while ((found) and (itemtehn.sap_hmnia =''))
44887>>>                        if  (itemtehn.hmnia  > dapod) goto nextitemd
44890>>>                        move itemtehn.recnum to irec
44891>>>                        move dapod to itemtehn.sap_hmnia
44892>>>                        saverecord itemtehn
44893>>>                        move 1 to iint
44894>>>                        nextitemd:
44894>>>                            Set Label Of frmShow to ('’œ®¤.¨¦› ˜š¨˜­âª' + '-' + String(itemtehn.recnum)+'-'+String(itemtehn.hmnia))
44895>>>                            if (iint=1) begin
44897>>>                                clear itemtehn
44898>>>                                move irec to itemtehn.recnum
44899>>>                            end
44899>>>>
44899>>>                            move 0 to iint
44900>>>                            find Gt itemtehn by index.4
44901>>>>
44901>>>                    Loop
44902>>>>
44902>>>
44902>>>                    move 0 to iint
44903>>>                    clear witemxtr
44904>>>                    find GT witemxtr by index.4
44905>>>>
44905>>>                    while ((found) and (witemxtr.sap_hmnia =''))
44909>>>                        if  (witemxtr.hmnia  > dapod) goto nextwitemd
44912>>>                        move witemxtr.recnum to irec
44913>>>                        move dapod to witemxtr.sap_hmnia
44914>>>                        saverecord witemxtr
44915>>>                        move 1 to iint
44916>>>
44916>>>                        nextwitemd:
44916>>>                            Set Label Of frmShow to ('ƒ ˜¡ ¤ã©œ ª' + '-' + String(witemxtr.recnum)+'-'+String(witemxtr.hmnia))
44917>>>                            if (iint=1) begin
44919>>>                                clear witemxtr
44920>>>                                move irec to witemxtr.recnum
44921>>>                            end
44921>>>>
44921>>>                            move 0 to iint
44922>>>                            find Gt witemxtr by index.4
44923>>>>
44923>>>                    Loop
44924>>>>
44924>>>
44924>>>                    clear tmpsap
44925>>>                    move dapod to tmpsap.date
44926>>>                    move 1 to tmpsap.kleidomeno
44927>>>                    saverecord tmpsap
44928>>>
44928>>>                End_Transaction
44929>>>              //-----------------------------------------------------------------
44929>>>              //--------------------  MAIN TRANSACTION END ----------------------
44929>>>              //-----------------------------------------------------------------
44929>>>                unlock
44930>>>>
44930>>>
44930>>>                if (not(err)) begin
44932>>>
44932>>>                    SEND IGNORE_ERROR TO ERROR_INFO_OBJECT 4358
44933>>>
44933>>>                    Make_Directory "C:\PISBACKUPASCCI"
44934>>>                    Copyfile (PSPATH(SELF)+'*.*') to  "C:\PISBACKUPASCCI"
44935>>>>
44935>>>
44935>>>                    String sNewFolder sHmn sY sM sD
44935>>>                    Integer iY iM iD
44935>>>
44935>>>                    Move (TheYearSegment (dapod)) to iY
44936>>>                    Move (TheMonthSegment(dapod)) to iM
44937>>>                    Move (TheDaySegment  (dapod)) to iD
44938>>>
44938>>>                    Move iY to sY
44939>>>                    Move iM to sM
44940>>>                    Move iD to sD
44941>>>
44941>>>                    If (Length(sM)=1) Insert "0" in sM at 1
44945>>>                    If (Length(sD)=1) Insert "0" in sD at 1
44949>>>
44949>>>                    Move (Trim(psPath(Self))+sY+sM+sD) to sNewFolder
44950>>>                    String sS1
44950>>>
44950>>>                    Move (Trim(sY)+Trim(sM)+Trim(sD)) to sS1
44951>>>
44951>>>                    Runprogram Wait "C:\VDF6\Develop\Empor\Programs\Convert_To_UTF.Exe" (sS1+" "+Trim(psPath(Self)))
44952>>>
44952>>>                    Make_Directory "C:\PISBACKUPUTF"
44953>>>                    Copyfile (PSPATH(SELF)+'*.*') to  "C:\PISBACKUPUTF"
44954>>>>
44954>>>
44954>>>        //            Make_Directory sNewFolder
44954>>>        //            Copyfile (PSPATH(SELF)+'*.*') to sNewFolder
44954>>>        //            Erasefile (PSPATH(SELF)+'*.*')
44954>>>
44954>>>                    SEND TRAP_ERROR TO ERROR_INFO_OBJECT 4358
44955>>>
44955>>>                    String sMess
44955>>>                    Append sMess "† œ¥˜šàšã ©«¦ ®œåà¤ ¦¢¦¡¢ž¨éŸž¡œ,‡˜ ™¨œå«œ «˜ ˜¨®œå˜ ©«¦" "\n" (Trim(psPath(Self))) " ©«¦¤ ­á¡œ¢¦ £œ «ž¤ ˜¤«å©«¦ ®ž ž£œ¨¦£ž¤å˜"
44959>>>                    //Send Info_Box sMess '¢ž¨¦­¦¨å˜'
44959>>>
44959>>>                end
44959>>>>
44959>>>                else  begin
44960>>>                    erasefile (PSPATH(SELF)+'*.txt')
44961>>>>
44961>>>                    Send Info_Box '˜¨¦¬© á©«ž¡œ ¡á§¦ ¦ ¢áŸ¦ª ©«ž¤ „¥˜šàšã' '¢ž¨¦­¦¨å˜'
44962>>>                end
44962>>>>
44962>>>
44962>>>                set pddate of (saprep(self))        to dapod
44963>>>                set pspath of (saprep(self))        to (pspath(self))
44964>>>                Set Modal_State Of (saprep(Self))   to True
44965>>>
44965>>>                send ACTIVATE_saprep
44966>>>
44966>>>                Set Modal_State Of (saprep(Self)) to false
44967>>>
44967>>>                Zerofile TmpclSap
44968>>>                Zerofile TmpAxio
44969>>>                Zerofile Tmppol
44970>>>                Zerofile Tmpapoth
44971>>>                Zerofile Tmptehn
44972>>>                Zerofile Tmpanal
44973>>>            end
44973>>>>
44973>>>        End_Procedure // OnClick
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>
44974>>>        //AB-StoreEnd
44974>>>
44974>>>    End_Object    // ButtonSub1
44975>>>
44975>>>    Object Textbox1 is a Textbox
44977>>>        Set Label to "†£/¤å˜ „šš¨˜­é¤ "
44978>>>        Set Location to 17 84
44979>>>        Set Size to 10 66
44980>>>        Set FontWeight to 800
44981>>>        Set TypeFace to "MS Sans Serif"
44982>>>    End_Object    // Textbox1
44983>>>
44983>>>    Object btnPartl is a ButtonSub
44985>>>
44985>>>        //AB-StoreTopStart
44985>>>
44985>>>        //AB-StoreTopEnd
44985>>>
44985>>>        Set Label to "ButtonSub1"
44986>>>        Set Bitmap to "Filesys3.bmp"
44987>>>        Set Size to 22 25
44988>>>        Set Location to 174 11
44989>>>        Set Focus_Mode to Pointer_Only
44990>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
44991>>>
44991>>>        //AB-StoreStart
44991>>>        Set TooltipValue to "‹œ«˜­¦¨á ©«˜ ˜¨˜šé£œ¤˜ €¨®œå˜"
44992>>>        Procedure OnClick
44994>>>             send activate_vwsap
44995>>>        End_Procedure // OnClick
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>
44996>>>        //AB-StoreEnd
44996>>>
44996>>>    End_Object    // btnPartl
44997>>>
44997>>>    Object frmPath is a FormSub
44999>>>
44999>>>        //AB-StoreTopStart
44999>>>
44999>>>        //AB-StoreTopEnd
44999>>>
44999>>>        Set Size to 13 223
45000>>>        Set Location to 212 95
45001>>>        Set Color to clBtnFace
45002>>>        Set Label_Col_Offset to 2
45003>>>        Set Prompt_Button_Mode to pb_PromptOn
45004>>>        Set Enabled_State to FALSE
45005>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45006>>>        Set Item_Shadow_State Item 0 to TRUE
45007>>>        Set Shadow_State Item 0 to TRUE
45008>>>
45008>>>        //AB-StoreStart
45008>>>
45008>>>        Procedure Prompt
45010>>>            String sStr sStr2
45011>>>            Move (DPDlgShow(oDirectoryPicker(Self)))  to sStr
ERROR: 54 Invalid symbol in expression DPDLGSHOW ON LINE: 3673 (45011) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
45012>>>            GET DPDlgPath Of (oDirectoryPicker(Self)) to sStr2  // Full Path
45013>>>            Move (Trim(sStr2)) to sStr2
45014>>>            Set Value Of frmPath Item 0 to (Uppercase(TOOEM(sStr2)))
45015>>>        End_Procedure
45016>>>
45016>>>
45016>>>
45016>>>
45016>>>        //AB-StoreEnd
45016>>>
45016>>>    End_Object    // frmPath
45017>>>
45017>>>    Object TextBoxSub1 is a TextBoxSub
45019>>>        Set Label to "Path SAP"
45020>>>        Set Location to 213 58
45021>>>        Set Size to 10 32
45022>>>        Set TypeFace to "MS Sans Serif"
45023>>>    End_Object    // TextBoxSub1
45024>>>
45024>>>    Object frmPassw is a FormSub
45026>>>
45026>>>        //AB-StoreTopStart
45026>>>
45026>>>        //AB-StoreTopEnd
45026>>>
45026>>>        Set Size to 13 60
45027>>>        Set Location to 147 44
45028>>>        Set Label_Col_Offset to 2
45029>>>        Set Form_TypeFace Item 0 to "MS Sans Serif"
45030>>>        Set Password_State Item 0 to TRUE
45031>>>
45031>>>        //AB-StoreStart
45031>>>
45031>>>        Set Enabled_State to False
45032>>>        Set Visible_State to False
45033>>>
45033>>>        //AB-StoreEnd
45033>>>
45033>>>    End_Object    // frmPassw
45034>>>
45034>>>    Object chkLog is a CheckBoxSub
45036>>>
45036>>>        //AB-StoreTopStart
45036>>>
45036>>>        //AB-StoreTopEnd
45036>>>
45036>>>        Set Label to "„¤œ¨š¦§¦åž©ž ‰˜«˜š¨˜­ ¡¦ç ‘­˜¢£á«à¤"
45037>>>        Set Size to 10 163
45038>>>        Set Location to 170 116
45039>>>        Set Checked_State to TRUE
45040>>>
45040>>>        //AB-StoreStart
45040>>>
45040>>>        Set Checked_State Of chkLog to True
45041>>>        Set Visible_State Of chkLog to False
45042>>>        Set Enabled_State Of chkLog to False
45043>>>
45043>>>
45043>>>        //AB-StoreEnd
45043>>>
45043>>>    End_Object    // chkLog
45044>>>
45044>>>
45044>>>    //AB-StoreStart
45044>>>
45044>>>    On_Key Key_Alt+Key_L Send Show_Log
45045>>>
45045>>>    Procedure Show_Log
45047>>>        Integer iState
45048>>>        Get Visible_State Of chkLog to iState
45049>>>        If (Visible_State(ChkLog(Self))=1) Set Checked_State Of chkLog to False
45052>>>        Else                               Set Checked_State Of chkLog to True
45054>>>        Set Visible_State Of chkLog to (1-iState)
45055>>>        Set Enabled_State Of chkLog to (1-iState)
45056>>>    End_Procedure
45057>>>
45057>>>    Object oDirectoryPicker is a OLEDPDlg
ERROR: 4345 Type check error U_OLEDPDLG, U_OLEDPDLG, U ON LINE: 3750 (45057) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
ERROR: 4328 Undefined symbol in argument U_OLEDPDLG ON LINE: 3750 (45057) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
45059>>>        Set Size            to 0 0
45060>>>        Set Location        to 0 0
45061>>>        Set Visible_State   to False
45062>>>
45062>>>        Procedure Activate
45064>>>            Forward Send Activate
45066>>>            Set Location    to 1 1
45067>>>            Set Size        to 190 190
45068>>>            SET DPDlgRoot   to 0
45069>>>        End_procedure
45070>>>
45070>>>    End_Object
45071>>>
45071>>>    Procedure Activate_View Returns Integer
45073>>>        Integer rVal
45074>>>        date ddate
45074>>>
45074>>>        Set Value           Of frmPassw Item 0  to ""
45075>>>        Set Enabled_State   Of frmPassw         to False
45076>>>        Set Visible_State   Of frmPassw         to False
45077>>>
45077>>>        CLEAR company
45078>>>        move syscurxr.company_code to company.company_code
45079>>>        find eq company by index.1
45080>>>>
45080>>>        if (found);            set value of frmpath to company.sap_path
45083>>>        else;            set value of frmpath to ''
45085>>>        clear tmpsap
45086>>>        move '31/12/2100' to tmpsap.date
45087>>>        find lt tmpsap by index.1
45088>>>>
45088>>>        if (found) begin
45090>>>           move (tmpsap.date+1) to ddate
45091>>>           set value of frmapo to ddate
45092>>>        End
45092>>>>
45092>>>        Forward Get Msg_Activate_View to rVal
45094>>>        Reread Sysfile
45098>>>        Unlock
45099>>>>
45099>>>        reread sysrecw
INCLUDING FILE: SYSRECW.FD
45103>>>        unlock
45104>>>>
45104>>>        reread sysrecc
45108>>>        unlock
45109>>>>
45109>>>
45109>>>        Send Activate to oDirectoryPicker
45110>>>        Send Activate to (frmapo(vsapdomikh(Self)))
45111>>>    End_Procedure
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>
45112>>>    //AB-StoreEnd
45112>>>
45112>>>End_Object    // Vsapdomikh
45113>>>
45113>>>
45113>>>//AB-StoreStart
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>
45113>>>//AB-StoreEnd
45113>>>
45113>>>//AB/ End_Object    // prj
45113>
45113>
45113>//AB-StoreTopEnd
45113>
45113>
45113>Object Main is a Panelsub
45115>
45115>    //AB-PanelStoreTopStart
45115>    
45115>    
45115>    //AB-PanelStoreTopEnd
45115>
45115>    Set Label To "##QUICK_RUN2"
45116>    Use jsMenu.mn //  Menu package.
INCLUDING FILE: JSMENU.MN
45116>>>
45116>>>
45116>>>
45116>>>DFCreate_Menu Main_Menu      
45119>>>
45119>>>    Property String psMenuModule Public ''
45121>>>
45121>>>    DFCreate_Menu "Ž‚€‹‹€ „ˆƒˆ‰Ž" View1_PopupMenu IS A ViewPopupMenu
45125>>>        On_Item "GEFYRES SAP "   Send Activate_vsapdomikh
45126>>>        //On_Item "Proyp Tzirou   "   Send Activate_ProypTzirou
45126>>>        //On_Item ""                  Send None
45126>>>        //On_Item "VsapDomikh     "   Send Activate_Vsapdomikh
45126>>>        
45126>>>        Procedure OnInitMenu
45128>>>            Forward Send OnInitMenu
45130>>>            Set psMenuModule to '01'
45131>>>        End_Procedure
45132>>>
45132>>>    End_Pull_Down // "Ž‚€‹‹€ „ˆƒˆ‰Ž"  
45134>>>
45134>>>
45134>>>End_Menu // Main_Menu
45136>>>
45136>>>Register_Object Client_Area
45136>>>
45136>>>
45136>    
45136>    Use DFStdBtn.pkg //  Tool-Bar object.
INCLUDING FILE: DFSTDBTN.PKG
45136>>>// 07/23/96 JJT - New Class names
45136>>>// 10/03/97 KCR - removed leading separator
45136>>>
45136>>>Use DFMainBt  // dfMain_ButtonBar
INCLUDING FILE: DFMAINBT.PKG
45136>>>>>//-------------------------------------------------------------------------
45136>>>>>// DFMainBt.pkg - DfMain_ButtonBar class
45136>>>>>//
45136>>>>>//
45136>>>>>// 07/23/96 JJT - New Class names
45136>>>>>//-------------------------------------------------------------------------
45136>>>>>
45136>>>>>Use DfPanel // dfapp_buttonbar
45136>>>>>
45136>>>>>Class ToolBar is a AppToolBar
45137>>>>>
45137>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
45138>>>>>      Local integer rval MainObj#
45139>>>>>      Get Main_Panel_id to MainObj#
45140>>>>>      If (ObjId>Desktop AND MainObj#) ;         Get Is_Function of MainObj# MsgId ObjId DelegateFg to rVal
45143>>>>>      Function_Return rVal
45144>>>>>    End_Function
45145>>>>>
45145>>>>>    Procedure Redirect_Button_Message integer Itm
45146>>>>>         Local integer Msg# Aux# rval Understood
45147>>>>>         If (Shadow_State(Current_Object,itm)) Procedure_Return
45150>>>>>         Get Message   item itm  to Msg#
45151>>>>>         Get Aux_Value item itm  to Aux#
45152>>>>>         If Msg# Begin
45154>>>>>           If Aux# eq 0 Begin
45156>>>>>              Get Focus to Aux#
45157>>>>>              Get Is_Function Get_DEO_Object Aux# TRUE to Understood
45158>>>>>              If Not Understood Move 0 to Aux#
45161>>>>>           End
45161>>>>>>
45161>>>>>           If Aux# Get Msg# of Aux# to rval
45164>>>>>           Procedure_return rval
45165>>>>>         end
45165>>>>>>
45165>>>>>    End_Procedure // Redirect_Message
45166>>>>>
45166>>>>>End_Class
45167>>>>>
45167>>>>>
45167>>>
45167>>>//  Button bar object.
45167>>>//
45167>>>Object Tool_Bar is a ToolBar
45169>>>
45169>>>    Send ImageList_Add 'bgn.bmp'   // 0
45170>>>    Send ImageList_Add 'end.bmp'   // 1
45171>>>    Send ImageList_Add 'next.bmp'  // 2
45172>>>    Send ImageList_Add 'prev.bmp'  // 3
45173>>>    Send ImageList_Add 'clr.bmp'   // 4
45174>>>    Send ImageList_Add 'clra.bmp'  // 5
45175>>>
45175>>>    send Add_button (ico_user+0) msg_beginning_of_data
45176>>>    Send Add_ToolTip "Beginning of file"
45177>>>    Set  Status_Help To 'Find the First record (Ctrl+Home)'
45178>>>
45178>>>    send Add_button (ico_user+3) msg_find_previous
45179>>>    Send Add_ToolTip "Find Previous"
45180>>>    Set  Status_Help To 'Find the Previous record (F7)'
45181>>>
45181>>>    send Add_button (ico_user+2) msg_find_next
45182>>>    Send Add_ToolTip "Find Next"
45183>>>    Set  Status_Help To 'Find the Next record (F8)'
45184>>>
45184>>>    send Add_button (ico_user+1) msg_end_of_data
45185>>>    Send Add_ToolTip "End of File"
45186>>>    Set  Status_Help To 'Find the Last record (Ctrl+End)'
45187>>>
45187>>>    send Add_space
45188>>>
45188>>>    send Add_button ico_std_find msg_prompt
45189>>>    Send Add_ToolTip "Prompt"
45190>>>    Set  Status_Help To 'Show available selections (F4)'
45191>>>
45191>>>    send Add_button (ico_user+4) msg_request_clear
45192>>>    Send Add_ToolTip "Clear"
45193>>>    Set  Status_Help To 'Clear current record / Add a new record (F5)'
45194>>>
45194>>>    send Add_button (ico_user+5) msg_request_clear_all
45195>>>    Send Add_ToolTip "Clear All"
45196>>>    Set  Status_Help To 'Clear all data from view (Ctrl+F5)'
45197>>>
45197>>>    send Add_space
45198>>>
45198>>>    send Add_button ico_std_filesave msg_request_save
45199>>>    Send Add_ToolTip "Save"
45200>>>    Set  Status_Help To 'Save the current record (F2)'
45201>>>
45201>>>    send Add_button ico_std_delete msg_request_delete
45202>>>    Send Add_ToolTip "Delete"
45203>>>    Set  Status_Help To 'Delete the current record (Shift+F2)'
45204>>>
45204>>>    send Add_space
45205>>>
45205>>>    send Add_button ico_std_cut msg_cut
45206>>>    Send Add_ToolTip "Cut"
45207>>>    Set  Status_Help to "Cuts the selection and puts it on the Clipboard"
45208>>>
45208>>>    send Add_button ico_std_copy msg_copy
45209>>>    Send Add_ToolTip "Copy"
45210>>>    Set  Status_Help to "Copies the selection and puts it on the Clipboard"
45211>>>
45211>>>    send Add_button ico_std_paste msg_paste
45212>>>    Send Add_ToolTip "Paste"
45213>>>    Set  Status_Help to "Inserts Clipboard contents"
45214>>>
45214>>>End_Object
45215>>>
45215>    
45215>    Object Client_Area is a AppClientAreasub
45217>
45217>        //AB-ClientStoreTopStart
45217>        //==========================================
45217>        On_Key Key_Ctrl+Key_W Send ChangeMyPassword
45218>        //==========================================
45218>        
45218>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
45218>        String Plhktro_BIP  Plhktro_Esc  Plhktro_N11  Plhktro_N00  Plhktro_FS  Plhktro_AAA  Plhktro_DSI
45218>        String Plhktro_SO   Plhktro_DC4     //expanded for 1 line
45218>        String Plhktro_SI   Plhktro_DC2     //condesed
45218>        String Plhktro_PAV                  //underline
45218>        String Plhktro_EEE  Plhktro_FFF     //emphasized
45218>        String Plhktro_GGG  Plhktro_HHH     //double strike
45218>        String Plhktro_WWW                  //expanded
45218>        string Plhktro_Q Plhktro_160
45218>        Integer giViewID
45218>        String  gsViewName
45218>        // Ž‘Ž•† ‚„Œˆ‰„‘ ‹„’€Š†’„‘ //
45218>        
45218>        Open Sysfile
45220>        Open Sysrec
45222>        
45222>        //Use dbViews.Sub
45222>        //Use dbForms.Sub
45222>        
45222>        //Use GrpPed00.vw
45222>        //Use GrpPedia.vw
45222>        //Use GrpView0.vw
45222>        //Use GrpViews.vw
45222>        //Use GrpOth0.vw
45222>        //Use GrpOth.vw
45222>        //Use Users.vw
45222>        //Use UserGrps.vw
45222>        //Use Departm.vw
45222>        //Use Othon.vw
45222>        //Use Views.vw
45222>        //Use Arxeia.vw
45222>        //Use Pedia.vw
45222>        //Use Viewflds.vw
45222>        
45222>        //Use Cflagkin.vw
45222>        //Use Wflagkin.vw
45222>        
45222>        //Use Listes
45222>        
45222>        //Use bpMakeSx.dg
45222>        
45222>        Use dbViews.Sub
45222>        
45222>        Open Nomisma
45224>        Open Isotimia
INCLUDING FILE: ISOTIMIA.FD
45226>        
45226>        Function fngConvertPoso Global String asNomismaCodeApo Number anPoso ;                                       String asNomismaCodeSe  Date   adHmnia;                                       Number nIsotimia  Returns Number
45227>        
45227>            Number rVal nApo_Euro_Isot nSe_Euro_Isot
45228>            Integer iApo_Einai_Euro_Zone iApo_Einai_DRX iApo_Einai_Euro iDekadika_Apo
45228>            Integer iSe_Einai_Euro_Zone  iSe_Einai_DRX  iSe_Einai_Euro  iDekadika_Se
45228>            String  sCode
45228>        
45228>            If (asNomismaCodeApo=asNomismaCodeSe) Function_Return anPoso
45231>        
45231>            Clear Nomisma
45232>            Move (Trim(asNomismaCodeApo)) to Nomisma.Nomisma_Code
45233>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
45234>            Move Nomisma.Euro_Zone      to iApo_Einai_Euro_Zone
45235>            Move Nomisma.Einai_DRX      to iApo_Einai_DRX
45236>            Move Nomisma.Einai_EURO     to iApo_Einai_Euro
45237>            Move Nomisma.KL_ISOT_EURO   to nApo_Euro_Isot
45238>            Move Nomisma.Dekadika       to iDekadika_Apo
45239>            // 1. An to nomisma APO den einai ths zonhs euro prepei na vrethei h isotimia tou
45239>            If ((NOT(iApo_Einai_Euro_Zone)) And (nApo_Euro_Isot=0))  Begin
45241>                If (adHmnia='') Sysdate            adHmnia
45244>                Move (Trim(asNomismaCodeApo))   to sCode
45245>                Clear Isotimia
45246>                Move sCode                      to Isotimia.Nomisma_Code
45247>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
45248>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
45249>                Move Isotimia.Isotimia_Euro     to nApo_Euro_Isot
45250>            End
45250>        
45250>            Clear Nomisma
45251>            Move (Trim(asNomismaCodeSe)) to Nomisma.Nomisma_Code
45252>            Find eq Nomisma By Index.1 // Nomisma:Index.1:Nomisma_Code
45253>            Move Nomisma.Euro_Zone      to iSe_Einai_Euro_Zone
45254>            Move Nomisma.Einai_DRX      to iSe_Einai_DRX
45255>            Move Nomisma.Einai_EURO     to iSe_Einai_Euro
45256>            Move Nomisma.KL_ISOT_EURO   to nSe_Euro_Isot
45257>            Move Nomisma.Dekadika       to iDekadika_Se
45258>            // 2. An to nomisma SE den einai ths zonhs euro prepei na vrethei h isotimia tou
45258>            If ((NOT(iSe_Einai_Euro_Zone)) And (nSe_Euro_Isot=0)) Begin
45260>                If (adHmnia='') Sysdate            adHmnia
45263>                Move (Trim(asNomismaCodeSe))    to sCode
45264>                Clear Isotimia
45265>                Move sCode                      to Isotimia.Nomisma_Code
45266>                Move (adHmnia+1)                to Isotimia.Isotimia_Hmnia
45267>                Find lt Isotimia by Index.1 // Isotimia:Index.1:Nomisma_Code+Isotimia_Hmnia
45268>                Move Isotimia.Isotimia_Euro     to nSe_Euro_Isot
45269>            End
45269>        
45269>            Calc (anPoso/nApo_Euro_Isot) to rVal
45270>            Move (Round_Number(rVal,6)) to rVal
45271>            Calc (rVal*nSe_Euro_Isot) to rVal
45272>            Move (Round_Number(rVal,iDekadika_Se)) to rVal
45273>        
45273>            Function_Return rVal
45274>        End_Function
45275>        
45275>        
45275>        //AB-ClientStoreTopEnd
45275>
45275>        //  Include all views
45275>
45275>        //AB-ClientStoreStart
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        
45275>        //AB-ClientStoreEnd
45275>
45275>
45275>    End_Object  // Client_Area
45276>    
45276>    Use DFStdSbr.pkg //  Status-Bar object.
INCLUDING FILE: DFSTDSBR.PKG
45276>>>// 07/23/96 JJT - New Class names
45276>>>// Very prototype global status bar
45276>>>//
45276>>>Use dfMainSt.pkg
INCLUDING FILE: DFMAINST.PKG
45276>>>>>// 07/23/96 JJT - New Class names
45276>>>>>Use dfAstbar.pkg
45276>>>>>
45276>>>>>Class StatusBar is a AppStatusBar
45277>>>>>
45277>>>>>    Procedure Construct_Object
45278>>>>>       Forward Send Construct_Object
45280>>>>>       //
45280>>>>>       Send Add_Item 350  ''     // micro-help
45281>>>>>       Send Add_Item  40  'View:'
45282>>>>>       Set Item_Display_Style To sbNORMAL
45283>>>>>       Send Add_Item 200  ''     // view name
45284>>>>>       Send Add_Item   0  ''     // spring 'normal' to end
45285>>>>>       Set Item_Display_Style To sbNORMAL
45286>>>>>    End_Procedure // Construct_Object
45287>>>>>
45287>>>>>    Procedure Show_View_Name String sName
45288>>>>>        Set Value item 2 to sName
45289>>>>>    End_Procedure
45290>>>>>
45290>>>>>End_Class
45291>>>
45291>>>Object Status_Bar is a StatusBar
45293>>>End_Object
45294>
45294>    //AB-PanelStoreStart
45294>    
45294>    
45294>    Use StdAbout.pkg // Standard "About" package.
INCLUDING FILE: STDABOUT.PKG
45294>>>//************************************************************************
45294>>>// Confidential Trade Secret.
45294>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
45294>>>// as an unpublished work.  All rights reserved.
45294>>>// DataFlex is a registered trademark of Data Access Corporation.
45294>>>//
45294>>>//************************************************************************
45294>>>//************************************************************************
45294>>>//
45294>>>// $File name  : StdAbout.pkg
45294>>>// $File title : Standard about object package for VDF
45294>>>// Notice      :
45294>>>// $Author(s)  : John Tuohy
45294>>>//
45294>>>// $Rev History
45294>>>//
45294>>>// JT 06/27/97   File created
45294>>>//************************************************************************
45294>>>
45294>>>// This provides a quick and simple way to create an about package for a program.
45294>>>// You need to create a message inside you client area called Activate_About.
45294>>>// Within this message you should send the message DoAbout passing needed
45294>>>// string information.
45294>>>//
45294>>>//       Procedure Activate_About
45294>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
45294>>>//       End_Procedure
45294>>>//    where: sTitle =     Name of application. If none provided, uses caption
45294>>>//                        bar title
45294>>>//           sVersion   = Version Line. If none provided, will be blank
45294>>>//           sCopyRight = Copyright Line. If none provided, will be blank
45294>>>//           sAuthor    = Author name, blank if none provided
45294>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
45294>>>//                        is used.
45294>>>// It is expected that you will place this in your own object package. For
45294>>>// example an order about package may look like this:
45294>>>//
45294>>>//   // OrderAbout.pkg
45294>>>//   Use StdAbout.pkg
45294>>>//   Procedure Activate_About
45294>>>//      Local String sTitle sCopyright sVersion sAuthor
45294>>>//      Move "My Order Entry System" to sTitle
45294>>>//      Move "Version 2.1" to sVersion
45294>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
45294>>>//      Move "John Smith"  to sAuthor
45294>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
45294>>>//   end_procedure
45294>>>//   // end of file.
45294>>>
45294>>>Use DfAbout.pkg
INCLUDING FILE: DFABOUT.PKG
45294>>>>>//************************************************************************
45294>>>>>// Confidential Trade Secret.
45294>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
45294>>>>>// as an unpublished work.  All rights reserved.
45294>>>>>// DataFlex is a registered trademark of Data Access Corporation.
45294>>>>>//
45294>>>>>//************************************************************************
45294>>>>>//************************************************************************
45294>>>>>//
45294>>>>>// $File name  : DfAbout.pkg
45294>>>>>// $File title : About class support
45294>>>>>// Notice      :
45294>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
45294>>>>>//
45294>>>>>// $Rev History
45294>>>>>//
45294>>>>>// JJT 11/5/98    Added version information
45294>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
45294>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
45294>>>>>//                workspace package.
45294>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
45294>>>>>//                class can create this object.
45294>>>>>//                Cleaned up the interface (used correct classes and messages)
45294>>>>>//                Added workspace reporting support to sys-info.
45294>>>>>//                Turned off wrapping in the sys-info editor.
45294>>>>>// KR  ??/??/96   File created
45294>>>>>//************************************************************************
45294>>>>>Use windows.pkg
45294>>>>>Use DFbitmap.pkg
45294>>>>>
45294>>>>>External_Function32 WNetGetUser "WNetGetUserA" MPR.DLL ;    Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
45295>>>>>
45295>>>>>//****************************************************************************
45295>>>>>// $Module type: FUNCTION
45295>>>>>// $Module name: Network_User_Name
45295>>>>>// $Author     : AK/VOO/KCR
45295>>>>>// Created     : 24-09-96 @ 19:17
45295>>>>>//
45295>>>>>// Description
45295>>>>>//    This function reads the current username of windows and returns that
45295>>>>>//    name or an text unknown user
45295>>>>>//
45295>>>>>// $Rev History
45295>>>>>//    24-09-96  Module header created
45295>>>>>//****************************************************************************
45295>>>>>Function Network_User_Name Returns String
45297>>>>>    Local String sName sLength
45298>>>>>    Local Pointer lpName_Addr lpLength_Addr
45298>>>>>    Local Integer iRetval
45298>>>>>
45298>>>>>    Movestr (Repeat (Character (0), 255)) To sName
45299>>>>>>
45299>>>>>    GetAddress Of sName To lpName_Addr
45300>>>>>    Movestr (DwordToBytes (255)) To sLength
45301>>>>>>
45301>>>>>    GetAddress Of sLength To lpLength_Addr
45302>>>>>
45302>>>>>    Moveint (WNetGetUser (0, lpName_Addr, lpLength_Addr)) To iRetval
45303>>>>>>
45303>>>>>
45303>>>>>    If iRetval Eq 0 Function_Return (CString (sName))
45306>>>>>    Else Function_Return "User Unknown"
45308>>>>>End_Function // Network_User_Name
45309>>>>>
45309>>>>>Type MEMORYSTATUS
45309>>>>>   Field MEMORYSTATUS.dwLength         As Dword // sizeof(MEMORYSTATUS)
45309>>>>>   Field MEMORYSTATUS.dwMemoryLoad     As Dword // percent of memory in use
45309>>>>>   Field MEMORYSTATUS.dwTotalPhys      As Dword // bytes of physical memory
45309>>>>>   Field MEMORYSTATUS.dwAvailPhys      As Dword // free physical memory bytes
45309>>>>>   Field MEMORYSTATUS.dwTotalPageFile  As Dword // bytes of paging file
45309>>>>>   Field MEMORYSTATUS.dwAvailPageFile  As Dword // free bytes of paging file
45309>>>>>   Field MEMORYSTATUS.dwTotalVirtual   As Dword // user bytes of address space
45309>>>>>   Field MEMORYSTATUS.dwAvailVirtual   As Dword // free user bytes
45309>>>>>End_Type // MEMORYSTATUS
45309>>>>>
45309>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
45310>>>>>
45310>>>>>// If a global workspace object exists it will use this variable to store
45310>>>>>// its object id.
45310>>>>>
45310>>>>>Class SysinfoDisplay Is An Edit
45311>>>>>    Procedure Construct_Object
45312>>>>>        forward send construct_object
45314>>>>>
45314>>>>>        Set Location To 6 6
45315>>>>>        Set Size To 110 255
45316>>>>>        Set Read_Only_State To True
45317>>>>>        Set wrap_state to False
45318>>>>>    end_Procedure
45319>>>>>
45319>>>>>    //****************************************************************************
45319>>>>>    // $Module type: PROCEDURE
45319>>>>>    // $Module name: Add_Line
45319>>>>>    // $Author     : VOO
45319>>>>>    // Created     : 06-10-96 @ 15:23
45319>>>>>    //
45319>>>>>    // Description
45319>>>>>    //    This method will add a line to this edit object, it should go simpler
45319>>>>>    //    but it seems to be done this way.
45319>>>>>    //
45319>>>>>    // $Rev History
45319>>>>>    //    06-10-96  Module header created
45319>>>>>    //****************************************************************************
45319>>>>>    Procedure Add_Line String sVal
45320>>>>>        Local Integer iLine
45321>>>>>
45321>>>>>        Moveint (Line_Count (Current_Object)) To iLine
45322>>>>>>
45322>>>>>        If (iLine = 1 And Changed_State (Current_Object) = False) Moveint 0 To iLine
45325>>>>>        Set Value Item iLine To sVal
45326>>>>>    End_Procedure // Add_Line
45327>>>>>
45327>>>>>    //****************************************************************************
45327>>>>>    // $Module type: PROCEDURE
45327>>>>>    // $Module name: Show_Current_Directory
45327>>>>>    // $Author     : VOO
45327>>>>>    // Created     : 06-10-96 @ 15:24
45327>>>>>    //
45327>>>>>    // Description
45327>>>>>    //    This method will show the name of the current directory in the system
45327>>>>>    //    information box
45327>>>>>    //
45327>>>>>    // $Rev History
45327>>>>>    //    06-10-96  Module header created
45327>>>>>    //****************************************************************************
45327>>>>>    Procedure Show_Current_Directory
45328>>>>>        Local String sDir
45329>>>>>
45329>>>>>        Get_Current_Directory To sDir
45330>>>>>        Send Add_Line ("Current Directory: " + sDir)
45331>>>>>    End_Procedure // Show_Current_Directory
45332>>>>>
45332>>>>>    Procedure Show_Windows_Directory
45333>>>>>        Local String sWindir
45334>>>>>
45334>>>>>        Get_Windows_Directory To sWindir
45335>>>>>        Send Add_Line ("Windows Directory: " * sWindir)
45336>>>>>    End_Procedure // Show_Windows_Directory
45337>>>>>
45337>>>>>    Procedure Show_Current_User
45338>>>>>        Send Add_Line ("Network User Name: " * Network_User_Name (Current_Object))
45339>>>>>    End_Procedure // Show_Current_User
45340>>>>>
45340>>>>>    Procedure Show_Number_Format
45341>>>>>        Local Integer iFormat
45342>>>>>
45342>>>>>        Get_Attribute Df_Thousands_Separator To iFormat
45345>>>>>        Send Add_Line ('Thousands Separator: "' - Character (iFormat) - '" (' - String (iFormat) - ')')
45346>>>>>        Get_Number_Format To iFormat
45347>>>>>        Send Add_Line ('Decimal Separator: "' - If (iFormat = 0, '.', ',') - '"')
45348>>>>>    End_Procedure // Show_Number_Format
45349>>>>>
45349>>>>>    Procedure Show_Filelist_Name
45350>>>>>        Local String sFilename
45351>>>>>
45351>>>>>        Get_Attribute Df_Filelist_Name To sFilename
45354>>>>>        Send Add_Line ("Current Filelist: " * sFilename)
45355>>>>>    End_Procedure // Show_Filelist_Name
45356>>>>>
45356>>>>>    Procedure Show_Lock_Delay
45357>>>>>        Local Integer iLockdelay
45358>>>>>
45358>>>>>        Get_Attribute Df_Lock_Delay To iLockdelay
45361>>>>>        Send Add_Line ("Database Locking Delay: " * String (iLockdelay) * "Milliseconds")
45362>>>>>    End_Procedure // Show_Lock_Delay
45363>>>>>
45363>>>>>    Procedure Show_Lock_Timeout
45364>>>>>        Local Integer iLockTimeout
45365>>>>>
45365>>>>>        Get_Attribute Df_Lock_Timeout To iLockTimeout
45368>>>>>        Send Add_Line ("Database Locking Timeout: " * String (iLockTimeout) * "Milliseconds")
45369>>>>>    End_Procedure // Show_Lock_Timeout
45370>>>>>
45370>>>>>    Procedure Show_Screen_Size
45371>>>>>        Local Integer iYscreensize iXscreensize
45372>>>>>
45372>>>>>        Moveint (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
45373>>>>>>
45373>>>>>        Moveint (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
45374>>>>>>
45374>>>>>
45374>>>>>        Send Add_Line ("Video Resolution: " * String (iXscreensize) * "by" * String (iYscreensize))
45375>>>>>    End_Procedure // Show_Screen_Size
45376>>>>>
45376>>>>>    Procedure Show_Page_Size
45377>>>>>        Send Add_Line ("Page End: " * String (Pageend) * "Form Feed: " * String (Pagefeed))
45378>>>>>    End_procedure
45379>>>>>
45379>>>>>    Procedure Show_Date
45380>>>>>        Local Date dToday
45381>>>>>
45381>>>>>        Sysdate4 dToday
45382>>>>>        Send Add_Line ("Current System Date: " * String (dToday))
45383>>>>>    End_procedure // Show_Date
45384>>>>>
45384>>>>>    Procedure Show_Date_Format
45385>>>>>        Local Integer iDateFormat
45386>>>>>        Local String sDateFormat
45386>>>>>
45386>>>>>        Get_Attribute Df_Date_Format To iDateFormat
45389>>>>>        if iDateFormat Eq DF_DATE_USA ;            Movestr "USA" To sDateFormat
45392>>>>>        else if iDateformat Eq DF_DATE_EUROPEAN ;            Movestr "European" To sDateFormat
45396>>>>>        else if iDateformat Eq DF_DATE_MILITARY ;            Movestr "Military" To sDateFormat
45400>>>>>        else ;            Movestr "Unknown Date Type" To sDateFormat
45402>>>>>        Send Add_Line ("Date Format: " * sDateformat)
45403>>>>>    End_Procedure // Show_Date_Format
45404>>>>>
45404>>>>>    Procedure Show_Memavail
45405>>>>>        Local Integer iMem
45406>>>>>
45406>>>>>        Memory iMem
45407>>>>>>
45407>>>>>        Send Add_Line ("Available Memory: " * String (iMem))
45408>>>>>    End_Procedure // Show_Memavail
45409>>>>>
45409>>>>>    Procedure Show_Systemresources
45410>>>>>        Local String sMemoryStatus
45411>>>>>        Local Pointer lpsMemoryStatus
45411>>>>>        Local Integer iVoid
45411>>>>>        Local Dword dwMemoryLoad dwTotalPhys dwAvailPhys dwTotalPageFile dwAvailPageFile dwTotalVirtual dwAvailVirtual
45411>>>>>
45411>>>>>        ZeroType MEMORYSTATUS To sMemoryStatus
45412>>>>>        GetAddress Of sMemoryStatus To lpsMemoryStatus
45413>>>>>
45413>>>>>        Moveint (GlobalMemoryStatus (lpsMemoryStatus)) To iVoid
45414>>>>>>
45414>>>>>
45414>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwMemoryLoad    To dwMemoryLoad
45415>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPhys     To dwTotalPhys
45416>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPhys     To dwAvailPhys
45417>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalPageFile To dwTotalPageFile
45418>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailPageFile To dwAvailPageFile
45419>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwTotalVirtual  To dwTotalVirtual
45420>>>>>        GetBuff From sMemoryStatus At MEMORYSTATUS.dwAvailVirtual  To dwAvailVirtual
45421>>>>>
45421>>>>>        Send Add_Line ("Current memory utilization:" * String (dwMemoryLoad))
45422>>>>>        Send Add_Line ("Percentage available physical memory:" * String (dwAvailPhys / dwTotalPhys * 100.0) - "%")
45423>>>>>        Send Add_Line ("Percentage available pagefile space:" * String (dwAvailPageFile / dwTotalPageFile * 100.0) - "%")
45424>>>>>        Send Add_Line ("Percentage available virtual memory:" * String (dwAvailVirtual / dwTotalVirtual * 100.0) - "%")
45425>>>>>    End_Procedure // Show_Systemresources
45426>>>>>
45426>>>>>    Procedure Show_Registration
45427>>>>>        Local String sRegName
45428>>>>>        Local Integer iSN
45428>>>>>        Registration sRegName iSN
45429>>>>>>
45429>>>>>
45429>>>>>        Send Add_Line ("Serial# : " + (String(iSN)))
45430>>>>>        Send Add_Line ("Reg Name: " + sRegName)
45431>>>>>
45431>>>>>    End_Procedure // Show_Current_Directory
45432>>>>>
45432>>>>>
45432>>>>>
45432>>>>>    //****************************************************************************
45432>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
45432>>>>>    // to the workspace object passing the an object and message to send back
45432>>>>>    // to this object. It is expected that the workspace object will send this
45432>>>>>    // message for every line of information it wants displayed (passing the
45432>>>>>    // information to be displayed
45432>>>>>    //****************************************************************************
45432>>>>>    register_procedure EnumerateWorkspaceData integer hObjId integer hmMessId
45432>>>>>    Procedure Show_WorkspaceInformation
45433>>>>>        If ghoWorkspace ;            Send EnumerateWorkspaceData to ghoWorkspace Current_object Msg_add_Line
45436>>>>>    End_Procedure
45437>>>>>
45437>>>>>    Function VersionStr integer iVer integer iRev integer iBld Returns string
45438>>>>>        Function_Return (string(iVer)-"."-string(iRev)-"."-string(iBld))
45439>>>>>    End_Function
45440>>>>>
45440>>>>>    Procedure Show_Versions
45441>>>>>        local integer iVersion iRevision iBuild
45442>>>>>        Version_information iVersion iRevision iBuild
45444>>>>>        Send Add_Line ("Runtime Version:" * VersionStr(self,iVersion,iRevision,iBuild) )
45445>>>>>        Send Add_Line ("Package Version:" * VersionStr(self,PKG_VERSION, PKG_REVISION, PKG_BUILD) )
45446>>>>>        Send Add_Line ("FMAC Version:"    * VersionStr(self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) )
45447>>>>>    End_Procedure
45448>>>>>
45448>>>>>
45448>>>>>    //***
45448>>>>>    //*** BW
45448>>>>>    //*** Procedure: Show_Drivers
45448>>>>>    //*** Purpose  : Show loaed database drivers
45448>>>>>    //***
45448>>>>>
45448>>>>>    Procedure Show_Drivers
45449>>>>>        Local String  Current_drvr
45450>>>>>        Local String  Loadeddrvrs
45450>>>>>        Local Integer Number_of_drvrs
45450>>>>>        Local Integer Count
45450>>>>>
45450>>>>>        Move "" To Loadeddrvrs
45451>>>>>        Get_attribute DF_NUMBER_DRIVERS To Number_of_drvrs
45454>>>>>        For Count From 1 To Number_of_drvrs
45460>>>>>>
45460>>>>>            Get_attribute DF_DRIVER_NAME Of Count To Current_drvr
45463>>>>>            If (Loadeddrvrs <> "") ;                Move (Append(Loadeddrvrs, ", ")) To Loadeddrvrs
45466>>>>>            Move (Append(Loadeddrvrs, Current_drvr)) To Loadeddrvrs
45467>>>>>        Loop
45468>>>>>>
45468>>>>>        Send Add_Line ("Database driver(s):" * Loadeddrvrs)
45469>>>>>    End_Procedure // Show_Drivers
45470>>>>>
45470>>>>>    //****************************************************************************
45470>>>>>    // $Module type: PROCEDURE
45470>>>>>    // $Module name: Add_Focus
45470>>>>>    // $Author     : VOO
45470>>>>>    // Created     : 24-09-96 @ 19:43
45470>>>>>    //
45470>>>>>    // Description
45470>>>>>    //    During activation we will remove the old information and add the newly
45470>>>>>    //    found systeminformation
45470>>>>>    //
45470>>>>>    // $Rev History
45470>>>>>    //    24-09-96  Module header created
45470>>>>>    //****************************************************************************
45470>>>>>    Procedure Add_Focus Integer hoRoot
45471>>>>>        Forward Send Add_Focus hoRoot
45473>>>>>
45473>>>>>        Send Delete_Data
45474>>>>>        Set Changed_State To False
45475>>>>>        Set Read_Only_State To True
45476>>>>>        Send Show_WorkSpaceInformation // added to show WS info
45477>>>>>        SEnd Show_Drivers
45478>>>>>        Send Show_Current_User
45479>>>>>        Send Show_Windows_Directory
45480>>>>>        Send Show_Current_Directory
45481>>>>>        Send Show_Filelist_Name
45482>>>>>        Send Show_Versions
45483>>>>>        Send Show_Memavail
45484>>>>>        Send Show_Screen_Size
45485>>>>>        Send Show_Page_Size
45486>>>>>        Send Show_Number_Format
45487>>>>>        Send Show_Date_Format
45488>>>>>        Send Show_Lock_Delay
45489>>>>>        Send Show_Lock_Timeout
45490>>>>>        Send Show_Date
45491>>>>>        Send Show_Systemresources
45492>>>>>        Send Show_Registration
45493>>>>>    End_Procedure // Show_All_Info
45494>>>>>
45494>>>>>End_Class // SysinfoDisplay
45495>>>>>
45495>>>>>
45495>>>>>//****************************************************************************
45495>>>>>// $Module type: OBJECT
45495>>>>>// $Module name: Sysinfo_Dialog
45495>>>>>// $Author     : VOO
45495>>>>>// Created     : 24-09-96 @ 18:47
45495>>>>>//
45495>>>>>// Description
45495>>>>>//    This object shows the systeminformation on the screen
45495>>>>>//
45495>>>>>// $Rev History
45495>>>>>//    24-09-96  Module header created
45495>>>>>//****************************************************************************
45495>>>>>Class SysInfoDialog Is A ModalPanel
45496>>>>>    Procedure Construct_Object
45497>>>>>        forward send construct_object
45499>>>>>
45499>>>>>        Set Caption_Bar To True
45500>>>>>        Set Sysmenu_Icon To True
45501>>>>>        Set Label To "System Information"
45502>>>>>        Set Size To 152 270
45503>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
45504>>>>>        Set Minimize_Icon To False
45505>>>>>        Set Maximize_Icon To False
45506>>>>>        Set Border_Style To Border_Dialog
45507>>>>>
45507>>>>>        Object Sysinfo_Display Is A SysInfoDisplay
45509>>>>>        End_Object
45510>>>>>
45510>>>>>        Object Close_Button Is A Button
45512>>>>>            Set Label to "&Close"
45513>>>>>            Set Location To 120 212
45514>>>>>            Set Message item 0 to msg_Close_Panel
45515>>>>>            Set default_action_button to current_object
45516>>>>>        End_Object // Close_Button
45517>>>>>
45517>>>>>        On_Key Kcancel       Send Close_Panel
45518>>>>>        On_Key Key_Alt+Key_C Send Close_Panel
45519>>>>>    End_procedure
45520>>>>>
45520>>>>>End_Class // SysinfoDialog
45521>>>>>
45521>>>>>// Purpose:
45521>>>>>//
45521>>>>>// Ken Ross 12/17/96 5:16PM
45521>>>>>//
45521>>>>>Class AboutDialog Is A ModalPanel
45522>>>>>
45522>>>>>    Procedure construct_object
45523>>>>>        String sVdfRootDir
45524>>>>>        forward send construct_object
45526>>>>>        Set Label to "About..."
45527>>>>>        Set Size to 100 217
45528>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
45529>>>>>
45529>>>>>        Object SysInfo_Dialog is a SysInfoDialog
45531>>>>>        End_Object
45532>>>>>
45532>>>>>        Object oBox is a Container3d
45534>>>>>            Set Border_Style to Border_StaticEdge
45535>>>>>            Set Size to 63 202
45536>>>>>            Set Location to 4 5
45537>>>>>
45537>>>>>            Object AboutGraphic is a BitmapContainer
45539>>>>>                Set Border_Style to Border_None
45540>>>>>                Set Bitmap_Style to Bitmap_Center
45541>>>>>                Set Size to 48 48
45542>>>>>                Set Location to 7 2
45543>>>>>            End_Object    // AboutGraphic
45544>>>>>
45544>>>>>            Object ProductName is a TextBox
45546>>>>>                Set label to "ProductName"
45547>>>>>                Set Size to 10 45
45548>>>>>                Set Location to 8 53
45549>>>>>            End_Object    // ProductName
45550>>>>>
45550>>>>>            Object Version is a TextBox
45552>>>>>                Set label to "Version"
45553>>>>>                Set Size to 10 25
45554>>>>>                Set Location to 21 53
45555>>>>>            End_Object    // Version
45556>>>>>
45556>>>>>            Object Copyright is a TextBox
45558>>>>>                Set label to "Copyright"
45559>>>>>                Set Size to 10 31
45560>>>>>                Set Location to 34 53
45561>>>>>            End_Object    // Copyright
45562>>>>>
45562>>>>>            Object Author is a TextBox
45564>>>>>                Set label to "Author"
45565>>>>>                Set Size to 10 22
45566>>>>>                Set Location to 46 53
45567>>>>>            End_Object    // Author
45568>>>>>
45568>>>>>        End_Object    // oBox
45569>>>>>
45569>>>>>        Object OK_bn is a Button
45571>>>>>            On_Item "&OK" Send Close_Panel
45572>>>>>            Set Size to 14 50
45573>>>>>            Set Location to 71 157
45574>>>>>        End_Object    // OK_bn
45575>>>>>
45575>>>>>        Object SysInfo_bn is a Button
45577>>>>>            On_Item "&System Info" Send Show_Sysinfo
45578>>>>>            Set Size to 14 50
45579>>>>>            Set Location to 71 101
45580>>>>>        End_Object    // SysInfo_bn
45581>>>>>
45581>>>>>        On_Key Kcancel Send KeyAction to (Ok_bn(Current_Object))
45582>>>>>        On_Key Key_Alt+Key_O Send KeyAction to (Ok_bn(Current_Object))
45583>>>>>        On_Key Key_Alt+Key_S Send KeyAction to (SysInfo_bn(Current_Object))
45584>>>>>
45584>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
45587>>>>>        Set logo to (sVdfRootDir +"\Bitmaps\DacAbout.bmp")  // square bitmaps of 42x42 work best
45588>>>>>
45588>>>>>    End_Procedure
45589>>>>>
45589>>>>>    Procedure set productname string sval
45590>>>>>        set label of (productname(oBox(current_object))) to sval
45591>>>>>    End_Procedure
45592>>>>>
45592>>>>>    Procedure set version string sval
45593>>>>>        set label of (version(oBox(current_object))) to sval
45594>>>>>    End_Procedure
45595>>>>>
45595>>>>>    Procedure set copyright string sval
45596>>>>>        set label of (copyright(oBox(current_object))) to sval
45597>>>>>    End_Procedure
45598>>>>>
45598>>>>>    Procedure set author string sval
45599>>>>>        set label of (author(oBox(current_object))) to sval
45600>>>>>    End_Procedure
45601>>>>>
45601>>>>>    // square bitmaps of 42x42 work best
45601>>>>>    //
45601>>>>>    Procedure set logo string sval
45602>>>>>        set bitmap of (aboutgraphic(oBox(current_object))) to sval
45603>>>>>    End_Procedure
45604>>>>>
45604>>>>>    Procedure Show_Sysinfo
45605>>>>>        Send Popup_Modal To (Sysinfo_Dialog(Current_Object))
45606>>>>>    End_Procedure // Show_Sysinfo
45607>>>>>
45607>>>>>End_Class
45608>>>>>
45608>>>>>
45608>>>>>//Object About_Dialog is an AboutDialog
45608>>>>>//    set productname to "Visual DataFlex"
45608>>>>>//    set version to "version 4.0"
45608>>>>>//    set copyright to "Copyright 1997 Data Access Corporation"
45608>>>>>//    set author to ""
45608>>>>>//    set logo to "ablogo.bmp"  // square bitmaps of 42x42 work best
45608>>>>>//End_Object
45608>>>>>
45608>>>>>//Procedure Activate_About
45608>>>>>//   Send Popup_Modal To (About_Dialog (Current_Object))
45608>>>>>//End_Procedure
45608>>>
45608>>>// *************************************************************************
45608>>>//  Public message. This is the default message. It is expected that you will
45608>>>//   create your own message to override this
45608>>>// *************************************************************************
45608>>>
45608>>>Procedure Activate_About
45610>>>   Send DoAbout "" "" "" "" "" ""
45611>>>End_Procedure
45612>>>
45612>>>// *************************************************************************
45612>>>//  Public message. It is expected that you will send this message (most
45612>>>//  likely from Activate_About. This creates an about object, activates it
45612>>>//  and destroys it when done. It is not exepected that you will augment this.
45612>>>// *************************************************************************
45612>>>
45612>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
45614>>>        Local integer hoObj hoMain
45615>>>
45615>>>        // create object
45615>>>        Object About is an AboutDialog
45617>>>            // if no title passed use the label of the main panel
45617>>>            // (if a main panel exists).
45617>>>            if sTitle     eq '' Begin
45619>>>                Get Main_Window to hoMain
45620>>>                if hoMain Get Label of hoMain to sTitle
45623>>>            end
45623>>>>
45623>>>            set productname to sTitle
45624>>>            set version     to sVersion
45625>>>            set copyright   to sCopyRight
45626>>>            set author      to sAuthor
45627>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
45630>>>            Move Current_Object to hoObj // object Id
45631>>>        End_Object
45632>>>        Send Popup to hoObj    // popup the about object
45633>>>        Send Request_Destroy_Object to hoObj // when done, it will be destroyed
45634>>>End_procedure
45635>    
45635>    Use Tooltip.Inc
INCLUDING FILE: TOOLTIP.INC
45635>>>Use Tooltip.pkg
45635>>>
45635>>>object StandardToolTip is a StandardToolTip000
45637>>>    move (current_object) to DefaultTooltipHintID
45638>>>end_object
45639>>>
45639>>>object ToolTipTimer is a ToolTipTimer000
45641>>>    move (current_object) to TooltipControllerID
45642>>>end_object
45643>    
45643>    
45643>    
45643>    
45643>    
45643>    
45643>    //AB-PanelStoreEnd
45643>
45643>
45643>End_Object
45644>
45644>
45644>//AB-StoreStart
45644>
45644>Start_UI
45645>
45645>
45645>
45645>
45645>
45645>//AB-StoreEnd
45645>
45645>
ERROR: 4306 Forward reference not resolved  MSG_CHANGEALLFILEMODES ON LINE: 420 (38524) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VWSAP.VW
ERROR: 4306 Forward reference not resolved  MSG_CHANGEALLFILEMODES ON LINE: 457 (38571) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VWSAP.VW
ERROR: 4306 Forward reference not resolved  MSG_GSVIEWNAME ON LINE: 15 (40381) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4306 Forward reference not resolved  MSG_GIVIEWID ON LINE: 16 (40382) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4306 Forward reference not resolved  MSG_GIVIEWID ON LINE: 26 (40397) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4306 Forward reference not resolved  MSG_GSVIEWNAME ON LINE: 37 (40403) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4306 Forward reference not resolved  MSG_GIVIEWID ON LINE: 38 (40404) OF FILE: C:\VDF6.SUB\SUBCLASS\DBVIEWS.SUB
ERROR: 4306 Forward reference not resolved  GET_DPDLGPATH ON LINE: 3674 (45011) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
ERROR: 4306 Forward reference not resolved  SET_DPDLGROOT ON LINE: 3759 (45067) OF FILE: L:\Vdf6\Develop\Empor\AppSrc\VSAPDOMIKH.VW
Summary
Memory Available: 2147483647
Total Errors   : 52
Total Symbols  : 25278
Total Resources: 0
Total Commands : 45644
Total Windows  : 14
Total Pages    : 5
Static Data    : 326267
Message area   : 216468
Total Blocks   : 14896
52 ERRORS HAVE BEEN FOUND.
